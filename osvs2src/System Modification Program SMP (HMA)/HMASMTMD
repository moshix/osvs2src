         TITLE 'HMASMTMD - ICT MOD SECTION BUILD DRIVER -'              00001000
HMASMTMD CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMTMD  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @08,0                                               0001 00010000
@PSTART  LA    @09,4095(,@08)                                      0001 00011000
         LA    @10,4095(,@09)                                      0001 00012000
         LA    @12,4095(,@10)                                      0001 00013000
         USING @PSTART,@08                                         0001 00014000
         USING @PSTART+4095,@09                                    0001 00015000
         USING @PSTART+8190,@10                                    0001 00016000
         USING @PSTART+12285,@12                                   0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LA    @14,@SA00001                                        0001 00019000
         ST    @14,8(,@13)                                         0001 00020000
         LR    @13,@14                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0245 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* INITIALIZE FOR MOD SECTION BUILD PROCESSING                   */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0245 00029000
*   HIGHTMD=ZERO;                   /* RETURN CODE COLLECTOR         */ 00030000
         SLR   @15,@15                                             0245 00031000
         ST    @15,HIGHTMD                                         0245 00032000
*   TMDFLGS=''B;                    /* CLEAR PROCESSING FLAGS        */ 00033000
         MVI   TMDFLGS,X'00'                                       0246 00034000
*   MSGSMDN8=' ';                   /* BLANK MESSAGE AREA            */ 00035000
         MVI   MSGSMDN8+1,C' '                                     0247 00036000
         MVC   MSGSMDN8+2(6),MSGSMDN8+1                            0247 00037000
         MVI   MSGSMDN8,C' '                                       0247 00038000
*   HMASMMGP=''B;                   /* CLEAR HMASMMSG PARM BLOCK     */ 00039000
         XC    HMASMMGP(28),HMASMMGP                               0248 00040000
*   MPPPARM=''B;                    /* CLEAR HMASMMPD PARM BLOCK     */ 00041000
         XC    MPPPARM(23),MPPPARM                                 0249 00042000
*   HMASMSPL=''B;                   /* CLEAR HMASMSPL PARM BLOCK     */ 00043000
         XC    HMASMSPL(5),HMASMSPL                                0250 00044000
*   HMASMCRP=''B;                   /* CLEAR HMASMCRD PARM BLOCK     */ 00045000
         XC    HMASMCRP(106),HMASMCRP                              0251 00046000
*   BLDM2WRK=OFF;                   /* NO INTERSECTIONS ON THE WRK 0252 00047000
*                                      DATASETS                      */ 00048000
         NI    BLDM2WRK,B'11011111'                                0252 00049000
*   CALL HMASMTCR(TBLXPARM,MSG);    /* INSURE THAT THERE ALL SYSMODS    00050000
*                                      WHOSE REQUISITES ARE NOT    0253 00051000
*                                      SATISFIED ARE MARKED NOGO     */ 00052000
         L     @15,@PC00001                                        0253 00053000
         ST    @15,@AL00001                                        0253 00054000
         LA    @15,@CC00717                                        0253 00055000
         ST    @15,@AL00001+4                                      0253 00056000
         L     @15,@CV01893                                        0253 00057000
         LA    @01,@AL00001                                        0253 00058000
         BALR  @14,@15                                             0253 00059000
*   CALL SKIP(1);                   /* SKIP A LINE ON SMPOUT         */ 00060000
         LA    @01,@AL00254                                        0254 00061000
         BAL   @14,SKIP                                            0254 00062000
*   RESPECIFY                                                      0255 00063000
*     REG15 RSTD;                                                  0255 00064000
*   HIGHTMD=MAX(HIGHTMD,REG15);     /* MAINTAIN RETURN CODE          */ 00065000
         L     @14,HIGHTMD                                         0256 00066000
         CR    @14,REG15                                           0256 00067000
         BNL   *+6                                                      00068000
         LR    @14,REG15                                           0256 00069000
         ST    @14,HIGHTMD                                         0256 00070000
*   RESPECIFY                                                      0257 00071000
*     REG15 UNRSTD;                                                0257 00072000
*   PTRIOP1=CCAIOPTR;               /* USE IOP IN CCA FOR: ..........   00073000
*                                      1. (A)CDS SYSMOD ENTRIES .....   00074000
*                                      2. PTS MCS ENTIRES ...........*/ 00075000
         L     PTRIOP1,CCAIOPTR(,CCAPTR)                           0258 00076000
*   SAVIOPB1=PTRIOP1->IOPBUFAD;     /* SAVE IOPBUFAD POINTER         */ 00077000
         L     SAVIOPB1,IOPBUFAD(,PTRIOP1)                         0259 00078000
*   PTRIOP2=TBLXIOP2;               /* USE IOP IN TBLX FOR: .........   00079000
*                                      1. (A)CDS ELEMENT ENTRIES ....   00080000
*                                      2. WRK DATASET ENTRIES .......*/ 00081000
         L     @07,@PC00001                                        0260 00082000
         L     @04,TBLXIOP2(,@07)                                  0260 00083000
         ST    @04,PTRIOP2                                         0260 00084000
*   SAVIOPB2=PTRIOP2->IOPBUFAD;     /* SAVE IOPBUFAD POINTER         */ 00085000
         L     SAVIOPB2,IOPBUFAD(,@04)                             0261 00086000
*   MCBPTR=TBLXIOP3;                /* USE IOP IN TBLX FOR: .........   00087000
*                                      1. AN MCB ....................*/ 00088000
         L     @07,TBLXIOP3(,@07)                                  0262 00089000
         ST    @07,MCBPTR                                          0262 00090000
*   SAVIOPB3=MCBPTR->IOPBUFAD;      /* SAVE IOPBUFAD POINTER         */ 00091000
         MVC   SAVIOPB3(4),IOPBUFAD(@07)                           0263 00092000
*   RESPECIFY                                                      0264 00093000
*     MCBPTFMP BASED(MCBPTR);       /* SYSMOD HEADER MCB             */ 00094000
*   RESPECIFY                                                      0265 00095000
*     MCBVERMP BASED(MCBPTR);       /* ++VER MCB                     */ 00096000
*   RESPECIFY                                                      0266 00097000
*     MCBIFMP BASED(MCBPTR);        /* ++IF MCB                      */ 00098000
*   RESPECIFY                                                      0267 00099000
*     MCBELEMP BASED(MCBPTR);       /* ++"ELEMENT" MCB               */ 00100000
*   IF HIGHTMD<STOPFUNC THEN                                       0268 00101000
         CH    @14,@CH00036                                        0268 00102000
         BNL   @RF00268                                            0268 00103000
*     DO;                                                          0269 00104000
*                                                                  0269 00105000
*       /*************************************************************/ 00106000
*       /*                                                           */ 00107000
*       /* INITIALIZE HMASMCRD PARMLIST (HMASMCRP)                   */ 00108000
*       /*                                                           */ 00109000
*       /*************************************************************/ 00110000
*                                                                  0270 00111000
*       HMASMCRP=''B;                                              0270 00112000
         XC    HMASMCRP(106),HMASMCRP                              0270 00113000
*       CRPINDS=IOPPTS;             /* INPUT DATASET IS SMPPTS       */ 00114000
*                                                                  0271 00115000
         MVI   CRPINDS,X'06'                                       0271 00116000
*       /*************************************************************/ 00117000
*       /*                                                           */ 00118000
*       /* INITIALIZE HMASMMPD PARMLIST (MPPPARM)                    */ 00119000
*       /*                                                           */ 00120000
*       /*************************************************************/ 00121000
*                                                                  0272 00122000
*       MPPIOPAD=0;                 /* NO IOP TO BE FILLED IN        */ 00123000
         SLR   @04,@04                                             0272 00124000
         ST    @04,MPPIOPAD                                        0272 00125000
*       MPPMCBAD=MCBPTR;            /* MCB TO BE FILLED IN           */ 00126000
         ST    @07,MPPMCBAD                                        0273 00127000
*       MPPCRDAD=ADDR(HMASMCRD);    /* GET ROUTINE                   */ 00128000
         L     @07,@CV01885                                        0274 00129000
         ST    @07,MPPCRDAD                                        0274 00130000
*       MPPCRDPM=ADDR(HMASMCRP);    /* GET ROUTINE PARM LIST         */ 00131000
         LA    @07,HMASMCRP                                        0275 00132000
         ST    @07,MPPCRDPM                                        0275 00133000
*     END;                                                         0276 00134000
*   IF TBLCHECK=ON                  /* APPLY/ACCEPT "CHECK"          */ 00135000
*     THEN                                                         0277 00136000
@RF00268 L     @07,@PC00001                                        0277 00137000
         L     @07,TBLXTBL(,@07)                                   0277 00138000
         TM    TBLCHECK(@07),B'01000000'                           0277 00139000
         BNO   @RF00277                                            0277 00140000
*     TMWOPT=NOWRITE;               /* DO NOT WRITE TO WRK DATASETS  */ 00141000
         MVI   TMWOPT,C'N'                                         0278 00142000
*   ELSE                                                           0279 00143000
*     TMWOPT=WRITE;                 /* WRITE ELEMENTS TO WRK DATASETS*/ 00144000
         B     @RC00277                                            0279 00145000
@RF00277 MVI   TMWOPT,C'W'                                         0279 00146000
*                                                                  0280 00147000
*   /*****************************************************************/ 00148000
*   /*                                                               */ 00149000
*   /* BUILD MOD SECTION ENTRIES FOR DELETED-FROM-(A)CDS SYSMODS     */ 00150000
*   /*                                                               */ 00151000
*   /*****************************************************************/ 00152000
*                                                                  0280 00153000
*   RESPECIFY                                                      0280 00154000
*     ICTPTF BASED(CCAICPTF);                                      0280 00155000
*                                                                  0280 00156000
@RC00277 DS    0H                                                  0281 00157000
*   /*****************************************************************/ 00158000
*   /*                                                               */ 00159000
*   /* GO THRU THE ICT PTF SECTION ENTRIES                           */ 00160000
*   /*                                                               */ 00161000
*   /*****************************************************************/ 00162000
*                                                                  0281 00163000
*   DO I=1 BY 1 WHILE ICTPEND(I)^=ICTENDNT&HIGHTMD<STOPFUNC;       0281 00164000
         LA    I,1                                                 0281 00165000
         B     @DE00281                                            0281 00166000
@DL00281 DS    0H                                                  0282 00167000
*     IF(ICTPDEXP(I)=ON             /* EXPLICITLY DELETED            */ 00168000
*         |ICTPDIMP(I)=ON)          /* IMPLICITLY DELETED            */ 00169000
*         &ICTPNOGO(I)=OFF          /* NOT NOGO                      */ 00170000
*       THEN                                                       0282 00171000
         LR    @07,I                                               0282 00172000
         MH    @07,@CH02382                                        0282 00173000
         L     @04,CCAICPTF(,CCAPTR)                               0282 00174000
         ST    @07,@TF00001                                        0282 00175000
         ALR   @07,@04                                             0282 00176000
         AL    @07,@CF02415                                        0282 00177000
         TM    ICTPDEXP-13(@07),B'00110000'                        0282 00178000
         BZ    @RF00282                                            0282 00179000
         LR    @07,@04                                             0282 00180000
         AL    @07,@TF00001                                        0282 00181000
         AL    @07,@CF02416                                        0282 00182000
         TM    ICTPNOGO-8(@07),B'01000000'                         0282 00183000
         BNZ   @RF00282                                            0282 00184000
*       DO;                                                        0283 00185000
*                                                                  0283 00186000
*         /***********************************************************/ 00187000
*         /*                                                         */ 00188000
*         /* PTF SECT ENTRY IS FOR SYSMOD BEING DELETED              */ 00189000
*         /*                                                         */ 00190000
*         /***********************************************************/ 00191000
*                                                                  0284 00192000
*         CALL CDSDEL(ICTPTF(I));   /* BUILD MOD SECT ENTRIES        */ 00193000
         L     @07,@TF00001                                        0284 00194000
         AL    @04,@CF02417                                        0284 00195000
         LA    @07,ICTPTF(@07,@04)                                 0284 00196000
         ST    @07,@AL00001                                        0284 00197000
         LA    @01,@AL00001                                        0284 00198000
         BAL   @14,CDSDEL                                          0284 00199000
*         ICTPMSL(I)=ON;            /* MOD SECT PROCESSING COMPLETED    00200000
*                                      FOR SYSMOD                    */ 00201000
         LR    @07,I                                               0285 00202000
         MH    @07,@CH02382                                        0285 00203000
         L     @04,CCAICPTF(,CCAPTR)                               0285 00204000
         ALR   @04,@07                                             0285 00205000
         AL    @04,@CF02418                                        0285 00206000
         OI    ICTPMSL-15(@04),B'10000000'                         0285 00207000
*       END;                                                       0286 00208000
*   END;                                                           0287 00209000
*                                                                  0287 00210000
@RF00282 AL    I,@CF00065                                          0287 00211000
@DE00281 LR    @07,I                                               0287 00212000
         MH    @07,@CH02382                                        0287 00213000
         L     @04,CCAICPTF(,CCAPTR)                               0287 00214000
         AL    @04,@CF02417                                        0287 00215000
         L     @07,ICTPEND(@07,@04)                                0287 00216000
         CL    @07,ICTENDNT                                        0287 00217000
         BE    @DC00281                                            0287 00218000
         L     @07,HIGHTMD                                         0287 00219000
         CH    @07,@CH00036                                        0287 00220000
         BL    @DL00281                                            0287 00221000
@DC00281 DS    0H                                                  0288 00222000
*   /*****************************************************************/ 00223000
*   /*                                                               */ 00224000
*   /* BUILD MOD SECTION ENTRIES FOR SYSMODS REMAINING IN THE ICT    */ 00225000
*   /*                                                               */ 00226000
*   /*****************************************************************/ 00227000
*                                                                  0288 00228000
*   CALL BLDICTM;                   /* BUILD ICT MOD SECTION         */ 00229000
         BAL   @14,BLDICTM                                         0288 00230000
*                                                                  0289 00231000
*   /*****************************************************************/ 00232000
*   /*                                                               */ 00233000
*   /* SORT OUT SELECTED MODS AND ASSEMBLY ENTRIES CREATED FOR SOURCE*/ 00234000
*   /* AND MACRO ELEMENTS                                            */ 00235000
*   /*                                                               */ 00236000
*   /*****************************************************************/ 00237000
*                                                                  0289 00238000
*   RESPECIFY                                                      0289 00239000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */ 00240000
*                                                                  0289 00241000
*   /*****************************************************************/ 00242000
*   /*                                                               */ 00243000
*   /* GO THRU ICT MOD SECTION FOR ASSEMBLY ENTRIES                  */ 00244000
*   /*                                                               */ 00245000
*   /*****************************************************************/ 00246000
*                                                                  0290 00247000
*   DO I=1 BY 1 WHILE ICTMEND(I)^=ICTENDNT;                        0290 00248000
         LA    I,1                                                 0290 00249000
         B     @DE00290                                            0290 00250000
@DL00290 DS    0H                                                  0291 00251000
*     IF ICTMMOD(I)=ON              /* MOD ENTRY                     */ 00252000
*         &ICTMASM(I)=ON            /* FOR AN ASSEMBLY               */ 00253000
*         &ICTMISEL(I)=ON           /* SELECTED                      */ 00254000
*       THEN                                                       0291 00255000
         LR    @07,I                                               0291 00256000
         MH    @07,@CH02383                                        0291 00257000
         L     @04,CCAICMOD(,CCAPTR)                               0291 00258000
         ST    @07,@TF00001                                        0291 00259000
         ALR   @07,@04                                             0291 00260000
         AL    @07,@CF02420                                        0291 00261000
         TM    ICTMMOD-9(@07),B'11000000'                          0291 00262000
         BNO   @RF00291                                            0291 00263000
         LR    @07,@04                                             0291 00264000
         AL    @07,@TF00001                                        0291 00265000
         AL    @07,@CF02421                                        0291 00266000
         TM    ICTMISEL-11(@07),B'10000000'                        0291 00267000
         BNO   @RF00291                                            0291 00268000
*       DO;                                                        0292 00269000
*         CALL CHKASSEM(ICTMOD(I),SRCMP1);/* MAKE SURE THERE IS STILL   00270000
*                                      A SELECTED MAC OR SRC WHICH 0293 00271000
*                                      CALLS FOR THE ASSEMBLY        */ 00272000
         L     @07,@TF00001                                        0293 00273000
         AL    @04,@CF02422                                        0293 00274000
         LA    @07,ICTMOD(@07,@04)                                 0293 00275000
         ST    @07,@AL00001                                        0293 00276000
         LA    @07,SRCMP1                                          0293 00277000
         ST    @07,@AL00001+4                                      0293 00278000
         LA    @01,@AL00001                                        0293 00279000
         BAL   @14,CHKASSEM                                        0293 00280000
*         IF SRCMP1^=0              /* THERE IS SRC/MAC CALLING FOR     00281000
*                                      THE ASSEMBLY                  */ 00282000
*           THEN                                                   0294 00283000
         ICM   @07,15,SRCMP1                                       0294 00284000
         BZ    @RF00294                                            0294 00285000
*           CALL SRCHMOD(ICTMNAME(I),SRCMP2);/* LOOK FOR SELECTED  0295 00286000
*                                      MOD-REPL TYPE ENTRY WITH SAME    00287000
*                                      NAME AS THIS ASSEMBLY ELEMENT */ 00288000
         LR    @07,I                                               0295 00289000
         MH    @07,@CH02383                                        0295 00290000
         L     @04,CCAICMOD(,CCAPTR)                               0295 00291000
         AL    @04,@CF02422                                        0295 00292000
         LA    @07,ICTMNAME(@07,@04)                               0295 00293000
         ST    @07,@AL00001                                        0295 00294000
         LA    @07,SRCMP2                                          0295 00295000
         ST    @07,@AL00001+4                                      0295 00296000
         LA    @01,@AL00001                                        0295 00297000
         BAL   @14,SRCHMOD                                         0295 00298000
*         IF SRCMP1=0               /* NO SRC/MAC CALLING FOR ASSEM. */ 00299000
*             |SRCMP2^=0            /* MOD-REPL FOUND                */ 00300000
*           THEN                                                   0296 00301000
@RF00294 SLR   @07,@07                                             0296 00302000
         C     @07,SRCMP1                                          0296 00303000
         BE    @RT00296                                            0296 00304000
         C     @07,SRCMP2                                          0296 00305000
         BE    @RF00296                                            0296 00306000
@RT00296 DS    0H                                                  0297 00307000
*           DO;                                                    0297 00308000
*                                                                  0297 00309000
*             /*******************************************************/ 00310000
*             /*                                                     */ 00311000
*             /* NO MAC/SRC CALLING FOR ASSEM. OR ++MOD REPL FOUND   */ 00312000
*             /* ... THE ASSEMBLY NEED NOT BE DONE                   */ 00313000
*             /*                                                     */ 00314000
*             /*******************************************************/ 00315000
*                                                                  0298 00316000
*             ICTMSELM(I)=ON;       /* ELIMINATE THIS ASSEMBLY ENTRY */ 00317000
*             ICTMISEL(I)=OFF;      /* UN-SELECT THE ASSEMBLY ENTRY  */ 00318000
         LR    @07,I                                               0299 00319000
         MH    @07,@CH02383                                        0299 00320000
         L     @04,CCAICMOD(,CCAPTR)                               0299 00321000
         ALR   @04,@07                                             0299 00322000
         AL    @04,@CF02421                                        0299 00323000
         OI    ICTMSELM-11(@04),B'00100000'                        0299 00324000
         NI    ICTMISEL-11(@04),B'01111111'                        0299 00325000
*           END;                                                   0300 00326000
*         CALL ELIMASM(ICTMOD(I));  /* ELIMINATE ANY OTHER ASSEMBLIES   00327000
*                                      FOR THIS SAME ELEMENT         */ 00328000
@RF00296 LR    @07,I                                               0301 00329000
         MH    @07,@CH02383                                        0301 00330000
         L     @04,CCAICMOD(,CCAPTR)                               0301 00331000
         AL    @04,@CF02422                                        0301 00332000
         LA    @07,ICTMOD(@07,@04)                                 0301 00333000
         ST    @07,@AL00001                                        0301 00334000
         LA    @01,@AL00001                                        0301 00335000
         BAL   @14,ELIMASM                                         0301 00336000
*       END;                                                       0302 00337000
*   END;                                                           0303 00338000
*                                                                  0303 00339000
@RF00291 AL    I,@CF00065                                          0303 00340000
@DE00290 LR    @07,I                                               0303 00341000
         MH    @07,@CH02383                                        0303 00342000
         L     @04,CCAICMOD(,CCAPTR)                               0303 00343000
         AL    @04,@CF02422                                        0303 00344000
         L     @07,ICTMEND(@07,@04)                                0303 00345000
         CL    @07,ICTENDNT                                        0303 00346000
         BNE   @DL00290                                            0303 00347000
*   /*****************************************************************/ 00348000
*   /*                                                               */ 00349000
*   /* AT THIS POINT THERE IS AT MOST, ONE SELECTED MOD-REPLACEMENT  */ 00350000
*   /* TYPE ENTRY (ICTMMOD = ON) AND ONE SELECTED EXPAND-ZAP TYPE    */ 00351000
*   /* ENTRY (ICTMMOD = ON & ICTMXPND = ON) IN THE ICT MOD SECTION   */ 00352000
*   /* FOR ANY ONE ELEMENT.                                          */ 00353000
*   /*                                                               */ 00354000
*   /*****************************************************************/ 00355000
*                                                                  0304 00356000
*                                                                  0304 00357000
*   /*****************************************************************/ 00358000
*   /*                                                               */ 00359000
*   /* CHECK SELECTED ELEMENTS IN ICT MOD SECTION FOR DISTLIB ERRORS */ 00360000
*   /*                                                               */ 00361000
*   /*****************************************************************/ 00362000
*                                                                  0304 00363000
*   RESPECIFY                                                      0304 00364000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */ 00365000
*                                                                  0304 00366000
*   /*****************************************************************/ 00367000
*   /*                                                               */ 00368000
*   /* GO THRU ICT PTF SECTION                                       */ 00369000
*   /*                                                               */ 00370000
*   /*****************************************************************/ 00371000
*                                                                  0305 00372000
*   DO IP=1 BY 1 WHILE ICTPEND(IP)^=ICTENDNT;                      0305 00373000
         LA    IP,1                                                0305 00374000
         B     @DE00305                                            0305 00375000
@DL00305 DS    0H                                                  0306 00376000
*     IF ICTPNOGO(IP)=OFF           /* NON-NOGO SYSMOD               */ 00377000
*       THEN                                                       0306 00378000
         LR    @07,IP                                              0306 00379000
         MH    @07,@CH02382                                        0306 00380000
         L     @03,CCAICPTF(,CCAPTR)                               0306 00381000
         ALR   @03,@07                                             0306 00382000
         AL    @03,@CF02416                                        0306 00383000
         TM    ICTPNOGO-8(@03),B'01000000'                         0306 00384000
         BNZ   @RF00306                                            0306 00385000
*       DO;                                                        0307 00386000
*                                                                  0307 00387000
*         /***********************************************************/ 00388000
*         /*                                                         */ 00389000
*         /* GO THRU ALL ELEMENTS IN SYSMOD                          */ 00390000
*         /*                                                         */ 00391000
*         /***********************************************************/ 00392000
*                                                                  0308 00393000
*         RESPECIFY                                                0308 00394000
*           ICTIXPF BASED(ICTPCHN(IP));/* ADDRESS LIST OF MOD SECTION   00395000
*                                      ENTRIES FOR SYSMOD            */ 00396000
*         DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                   0309 00397000
         LA    I,1                                                 0309 00398000
         B     @DE00309                                            0309 00399000
@DL00309 DS    0H                                                  0310 00400000
*           RESPECIFY                                              0310 00401000
*             ICTMOD BASED(ICTIXP(I));/* ADDRESS MOD SECTION ENTRY 0310 00402000
*                                      FOR SYSMOD                    */ 00403000
*           IF ICTMISEL(1)=ON       /* SELECTED ELEMENT              */ 00404000
*               &ICTMDSTE(1)=ON     /* INVALID DISTLIB               */ 00405000
*             THEN                                                 0311 00406000
         LR    @07,I                                               0311 00407000
         SLA   @07,2                                               0311 00408000
         LR    @15,IP                                              0311 00409000
         MH    @15,@CH02382                                        0311 00410000
         L     @01,CCAICPTF(,CCAPTR)                               0311 00411000
         AL    @01,@CF02423                                        0311 00412000
         L     @01,ICTPCHN-64(@15,@01)                             0311 00413000
         AL    @01,@CF02424                                        0311 00414000
         L     @07,ICTIXP(@07,@01)                                 0311 00415000
         TM    ICTMISEL(@07),B'10000100'                           0311 00416000
         BNO   @RF00311                                            0311 00417000
*             DO;                                                  0312 00418000
*                                                                  0312 00419000
*               /*****************************************************/ 00420000
*               /*                                                   */ 00421000
*               /* ISSUE DISTLIB ERROR MESSAGE AND MARK SYSMOD NOGO  */ 00422000
*               /*                                                   */ 00423000
*               /*****************************************************/ 00424000
*                                                                  0313 00425000
*               CALL ELMTYPE(ICTMOD(1),VPART#1);/* GET PRINTABLE   0313 00426000
*                                      ELEMENT TYPE                  */ 00427000
         ST    @07,@AL00001                                        0313 00428000
         LA    @07,VPART#1                                         0313 00429000
         ST    @07,@AL00001+4                                      0313 00430000
         LA    @01,@AL00001                                        0313 00431000
         BAL   @14,ELMTYPE                                         0313 00432000
*               VPART#2=ICTMNAME(1);/* SET ELEMENT NAME FOR HMA405I  */ 00433000
         LR    @07,I                                               0314 00434000
         SLA   @07,2                                               0314 00435000
         LR    @15,IP                                              0314 00436000
         MH    @15,@CH02382                                        0314 00437000
         L     @14,CCAICPTF(,CCAPTR)                               0314 00438000
         LA    @01,0(@15,@14)                                      0314 00439000
         AL    @01,@CF02423                                        0314 00440000
         L     @01,ICTPCHN-64(,@01)                                0314 00441000
         AL    @01,@CF02424                                        0314 00442000
         L     @07,ICTIXP(@07,@01)                                 0314 00443000
         MVC   VPART#2(8),ICTMNAME(@07)                            0314 00444000
*               VPART#3=ICTPTFS(IP);/* SET SYSMOD-ID FOR HMA405I     */ 00445000
         MVI   VPART#3+7,C' '                                      0315 00446000
         ALR   @14,@15                                             0315 00447000
         AL    @14,@CF02417                                        0315 00448000
         MVC   VPART#3(7),ICTPTFS(@14)                             0315 00449000
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */ 00450000
         MVI   MGPTYPE,X'03'                                       0316 00451000
*               CALL ERRMSG(HMA405I,NOPART);/* ISSUE DISTLIB ERROR 0317 00452000
*                                      MSG                           */ 00453000
         LA    @01,@AL00317                                        0317 00454000
         BAL   @14,ERRMSG                                          0317 00455000
*               ICTPNOGO(IP)=ON;    /* MARK SYSMOD NOGO              */ 00456000
*               ICTPCPL(IP)=ON;     /* MARK SYSMOD AS COMPLETE       */ 00457000
         LR    @07,IP                                              0319 00458000
         MH    @07,@CH02382                                        0319 00459000
         L     @01,CCAICPTF(,CCAPTR)                               0319 00460000
         ALR   @01,@07                                             0319 00461000
         AL    @01,@CF02416                                        0319 00462000
         OI    ICTPNOGO-8(@01),B'01100000'                         0319 00463000
*             END;                                                 0320 00464000
*         END;                      /* END OF LOOP THRU ALL ELEMENTS    00465000
*                                      IN SYSMOD                     */ 00466000
@RF00311 AL    I,@CF00065                                          0321 00467000
@DE00309 LR    @07,I                                               0321 00468000
         SLA   @07,2                                               0321 00469000
         LR    @15,IP                                              0321 00470000
         MH    @15,@CH02382                                        0321 00471000
         L     @14,CCAICPTF(,CCAPTR)                               0321 00472000
         LA    @01,0(@15,@14)                                      0321 00473000
         AL    @01,@CF02423                                        0321 00474000
         L     @01,ICTPCHN-64(,@01)                                0321 00475000
         AL    @01,@CF02424                                        0321 00476000
         L     @07,ICTIXP(@07,@01)                                 0321 00477000
         CL    @07,ICTENDIX                                        0321 00478000
         BNE   @DL00309                                            0321 00479000
*         IF ICTPNOGO(IP)=ON        /* SYSMOD MARKED NOGO            */ 00480000
*           THEN                                                   0322 00481000
         ST    @15,@TF00001                                        0322 00482000
         ALR   @15,@14                                             0322 00483000
         AL    @15,@CF02416                                        0322 00484000
         TM    ICTPNOGO-8(@15),B'01000000'                         0322 00485000
         BNO   @RF00322                                            0322 00486000
*           DO;                                                    0323 00487000
*             MGPTYPE=MGPINFO;      /* INFORMATIONAL                 */ 00488000
         MVI   MGPTYPE,X'01'                                       0324 00489000
*             MSGSMDNM=ICTPTFS(IP); /* SET SYSMOD-ID FOR HMA226I     */ 00490000
         AL    @14,@TF00001                                        0325 00491000
         AL    @14,@CF02417                                        0325 00492000
         MVC   MSGSMDNM(7),ICTPTFS(@14)                            0325 00493000
*             CALL ERRMSG(HMA226I,PART011);/* ISSUE HMA226I MSG      */ 00494000
         LA    @01,@AL00326                                        0326 00495000
         BAL   @14,ERRMSG                                          0326 00496000
*             ICTPMSG(IP)=ON;       /* SET MSG ISSUED FLAG           */ 00497000
         LR    @07,IP                                              0327 00498000
         MH    @07,@CH02382                                        0327 00499000
         L     @03,CCAICPTF(,CCAPTR)                               0327 00500000
         ST    @07,@TF00001                                        0327 00501000
         ALR   @07,@03                                             0327 00502000
         AL    @07,@CF02416                                        0327 00503000
         OI    ICTPMSG-8(@07),B'00010000'                          0327 00504000
*             IF ICTPTYPE(IP)=IOPPFUNC/* FUNCTION SYSMOD FAILED      */ 00505000
*               THEN                                               0328 00506000
         L     @07,@TF00001                                        0328 00507000
         AL    @03,@CF02426                                        0328 00508000
         SLR   @15,@15                                             0328 00509000
         IC    @15,ICTPTYPE-17(@07,@03)                            0328 00510000
         CH    @15,@CH00040                                        0328 00511000
         BNE   @RF00328                                            0328 00512000
*               CALL ERRMSG(HMA370I,NOPART);/* ISSUE HMA370I         */ 00513000
*                                                                  0329 00514000
         LA    @01,@AL00329                                        0329 00515000
         BAL   @14,ERRMSG                                          0329 00516000
*             /*******************************************************/ 00517000
*             /*                                                     */ 00518000
*             /* CLEANUP ICT AND WRK DATASETS                        */ 00519000
*             /*                                                     */ 00520000
*             /*******************************************************/ 00521000
*                                                                  0330 00522000
*             CALL BLDMODSF(ICTPTF(IP),/* FAILING SYSMOD             */ 00523000
*                 HIGHTMD);         /* RETURN CODE COLLECTOR         */ 00524000
@RF00328 LR    @07,IP                                              0330 00525000
         MH    @07,@CH02382                                        0330 00526000
         L     @03,CCAICPTF(,CCAPTR)                               0330 00527000
         AL    @03,@CF02417                                        0330 00528000
         LA    @07,ICTPTF(@07,@03)                                 0330 00529000
         ST    @07,@AL00001                                        0330 00530000
         LA    @07,HIGHTMD                                         0330 00531000
         ST    @07,@AL00001+4                                      0330 00532000
         LA    @01,@AL00001                                        0330 00533000
         BAL   @14,BLDMODSF                                        0330 00534000
*             IF HIGHTMD<STOPFUNC THEN                             0331 00535000
         L     @07,HIGHTMD                                         0331 00536000
         CH    @07,@CH00036                                        0331 00537000
         BNL   @RF00331                                            0331 00538000
*               DO;                                                0332 00539000
*                                                                  0332 00540000
*                 /***************************************************/ 00541000
*                 /*                                                 */ 00542000
*                 /* CHECK FOR SYSMODS WHICH REQUIRE THE FAILED      */ 00543000
*                 /* SYSMOD                                          */ 00544000
*                 /*                                                 */ 00545000
*                 /***************************************************/ 00546000
*                                                                  0333 00547000
*                 CALL HMASMTCR(TBLXPARM,MSG);/* CHECK REQUISITES    */ 00548000
         L     @07,@PC00001                                        0333 00549000
         ST    @07,@AL00001                                        0333 00550000
         LA    @07,@CC00717                                        0333 00551000
         ST    @07,@AL00001+4                                      0333 00552000
         L     @15,@CV01893                                        0333 00553000
         LA    @01,@AL00001                                        0333 00554000
         BALR  @14,@15                                             0333 00555000
*                 RESPECIFY                                        0334 00556000
*                   REG15 RSTD;                                    0334 00557000
*                 HIGHTMD=MAX(HIGHTMD,REG15);/* MAINTAIN RETURN CODE */ 00558000
         L     @14,HIGHTMD                                         0335 00559000
         CR    @14,REG15                                           0335 00560000
         BNL   *+6                                                      00561000
         LR    @14,REG15                                           0335 00562000
         ST    @14,HIGHTMD                                         0335 00563000
*                 RESPECIFY                                        0336 00564000
*                   REG15 UNRSTD;                                  0336 00565000
*               END;                                               0337 00566000
*           END;                                                   0338 00567000
@RF00331 DS    0H                                                  0339 00568000
*       END;                        /* END PROCESSING NON-NOGO SYSMOD*/ 00569000
@RF00322 DS    0H                                                  0340 00570000
*   END;                            /* END OF LOOP THRU ICT PTF    0340 00571000
*                                      SECTION                       */ 00572000
@RF00306 AL    IP,@CF00065                                         0340 00573000
@DE00305 LR    @07,IP                                              0340 00574000
         MH    @07,@CH02382                                        0340 00575000
         L     @03,CCAICPTF(,CCAPTR)                               0340 00576000
         AL    @03,@CF02417                                        0340 00577000
         L     @07,ICTPEND(@07,@03)                                0340 00578000
         CL    @07,ICTENDNT                                        0340 00579000
         BNE   @DL00305                                            0340 00580000
*                                                                  0341 00581000
*   /*****************************************************************/ 00582000
*   /*                                                               */ 00583000
*   /* ANY REMAINING UN-PROCESSED SYSMODS IN THE ICT ARE THOSE WHICH */ 00584000
*   /* SPECIFIED AN INVALID FMID/PREREQ RELATIONSHIP WITH ONE ANOTHER*/ 00585000
*   /*                                                               */ 00586000
*   /*****************************************************************/ 00587000
*                                                                  0341 00588000
*   IF HIGHTMD<STOPFUNC THEN                                       0341 00589000
         L     @07,HIGHTMD                                         0341 00590000
         CH    @07,@CH00036                                        0341 00591000
         BNL   @RF00341                                            0341 00592000
*     CALL INVALID;                 /* HANDLE UN-PROCESSABLE SYSMODS */ 00593000
*                                                                  0342 00594000
         BAL   @14,INVALID                                         0342 00595000
*   /*****************************************************************/ 00596000
*   /*                                                               */ 00597000
*   /* CLEANUP FROM MOD SECTION BUILD PROCESSING CLOSE SMPPTS DATASET*/ 00598000
*   /*                                                               */ 00599000
*   /*****************************************************************/ 00600000
*                                                                  0343 00601000
*   RESPECIFY                                                      0343 00602000
*     HMASMIOP BASED(PTRIOP1);      /* IOP USED TO ACCESS PTS        */ 00603000
@RF00341 DS    0H                                                  0344 00604000
*   HMASMIOP=''B;                   /* CLEAR IOP                     */ 00605000
         XC    HMASMIOP(68,PTRIOP1),HMASMIOP(PTRIOP1)              0344 00606000
*   IOPDSID=IOPPTS;                 /* SMPPTS DATASET                */ 00607000
         MVI   IOPDSID(PTRIOP1),X'06'                              0345 00608000
*   IOPFUNCT=IOPCLOSE;              /* CLOSE DATASET                 */ 00609000
         MVI   IOPFUNCT(PTRIOP1),X'50'                             0346 00610000
*   CALL HMASMIO(HMASMIOP);                                        0347 00611000
*                                                                  0347 00612000
         ST    PTRIOP1,@AL00001                                    0347 00613000
         L     @15,@CV01886                                        0347 00614000
         LA    @01,@AL00001                                        0347 00615000
         BALR  @14,@15                                             0347 00616000
*   /*****************************************************************/ 00617000
*   /*                                                               */ 00618000
*   /* RESTORE IOP BUFFER POINTERS                                   */ 00619000
*   /*                                                               */ 00620000
*   /*****************************************************************/ 00621000
*                                                                  0348 00622000
*   PTRIOP1->IOPBUFAD=SAVIOPB1;     /* CCA IOP BUFFER POINTER        */ 00623000
         ST    SAVIOPB1,IOPBUFAD(,PTRIOP1)                         0348 00624000
*   PTRIOP2->IOPBUFAD=SAVIOPB2;     /* TBLX IOP BUFFER POINTER       */ 00625000
         L     @07,PTRIOP2                                         0349 00626000
         ST    SAVIOPB2,IOPBUFAD(,@07)                             0349 00627000
*   MCBPTR->IOPBUFAD=SAVIOPB3;      /* TBLX IOP BUFFER POINTER       */ 00628000
         L     @01,MCBPTR                                          0350 00629000
         MVC   IOPBUFAD(4,@01),SAVIOPB3                            0350 00630000
*   RETURN CODE(HIGHTMD);                                          0351 00631000
         L     @15,HIGHTMD                                         0351 00632000
         L     @13,4(,@13)                                         0351 00633000
         L     @14,12(,@13)                                        0351 00634000
         LM    @00,@12,20(@13)                                     0351 00635000
         BR    @14                                                 0351 00636000
*                                                                  0352 00637000
*/********************************************************************/ 00638000
*/*                                                                  */ 00639000
*/*    CDSDEL   - BUILD ICT MOD SECTION ENTRIES FOR SYSMODS BEING    */ 00640000
*/*               DELETED FROM THE TARGET SYSTEM.                    */ 00641000
*/*                                                                  */ 00642000
*/*               THIS PROCEDURE ACCESSES THE (A)CDS TO FIND THE     */ 00643000
*/*               PTF ENTRY FOR THE SYSMOD PASSED AND USES THE       */ 00644000
*/*               ELEMENTS FOUND IN THE (A)CDS PTF ENTRY TO          */ 00645000
*/*               DETERMINE THE TARGET-SYSTEM ELEMENTS WHICH ARE     */ 00646000
*/*               CANDIDATES FOR DELETION.                           */ 00647000
*/*                                                                  */ 00648000
*/*               SINCE THE ELEMENTS ON THE TARGET SYSTEM MAY NO     */ 00649000
*/*               LONGER BELONG TO THIS SYSMOD, THE ELEMENT ENTRIES  */ 00650000
*/*               ON THE (A)CDS MUST BE ACCESSED TO DETERMINE THE    */ 00651000
*/*               CURRENT FMID OWNERSHIP ATTRIBUTE OF THE ELEMENT.   */ 00652000
*/*                                                                  */ 00653000
*/*               NOTE THAT MACRO AND SOURCE UPDATE ELEMENTS SUPPLIED*/ 00654000
*/*               IN NON-FUNCTION SYSMODS MUST BE PROCESSED SINCE    */ 00655000
*/*               SERVICE SYSMODS MAY CHANGE THE FMID OWNERSHIP OF   */ 00656000
*/*               A SOURCE OR MACRO ELEMENT BY SUPPLYING A SOURCE OR */ 00657000
*/*               MACRO UPDATE.  ZAP ELEMENTS NEED NOT BE PROCESSED  */ 00658000
*/*               SINCE THEY CANNOT CHANGE THE FMID OWNERSHIP OF AN  */ 00659000
*/*               ELEMENT.                                           */ 00660000
*/*                                                                  */ 00661000
*/*                                                                  */ 00662000
*/*    CONDITIONS UPON ENTRY:                                        */ 00663000
*/*                                                                  */ 00664000
*/*     *                                                            */ 00665000
*/*                                                                  */ 00666000
*/*    CONDITIONS UPON EXIT:                                         */ 00667000
*/*                                                                  */ 00668000
*/*     * HIGHTMD  - SET IF UNABLE TO OBTAIN STORAGE FOR PTF SECT    */ 00669000
*/*                  ENTRY.                                          */ 00670000
*/*                - SET IF I/O ERROR OCCURRED ACCESSING (A)CDS.     */ 00671000
*/*                                                                  */ 00672000
*/********************************************************************/ 00673000
*                                                                  0352 00674000
*CDSDEL:                                                           0352 00675000
*   PROC(DELSYSMD);                                                0352 00676000
CDSDEL   STM   @14,@12,@SA00002                                    0352 00677000
         MVC   @PC00002(4),0(@01)                                  0352 00678000
*   DCL                                                            0353 00679000
*     DELSYSMD CHAR(*);             /* ICT PTF SECT ENTRY FOR A    0353 00680000
*                                      SYSMOD BEING DELETED.         */ 00681000
*   DCL                                                            0354 00682000
*     DELFCTN CHAR(7);              /* FUNCTION BEING DELETED        */ 00683000
*   DCL                                                            0355 00684000
*     J FIXED(31);                  /* LOCAL INDEX                   */ 00685000
*   DCL                                                            0356 00686000
*     PTR0 PTR(31);                 /* PTR TO ICT MOD SECT ENTRY   0356 00687000
*                                      OBTAINED IN THIS PROCEDURE    */ 00688000
*   DCL                                                            0357 00689000
*     TESTIND FIXED(8);             /* LOCAL VARIABLE - IOPIND VALUES*/ 00690000
*   RESPECIFY                                                      0358 00691000
*     ICTPTF BASED(ADDR(DELSYSMD)); /* ADDRESS PTF SECT ENTRY PASSED */ 00692000
*   RESPECIFY                                                      0359 00693000
*     HMASMIOP BASED(PTRIOP1);      /* ADDRESS IOP FOR (A)CDS PTF  0359 00694000
*                                      ENTRY                         */ 00695000
*   ICTPCHN(1)=0;                   /* CLEAR PTR TO LIST OF MOD SECT    00696000
*                                      ENTRIES BUILT FOR THIS SYSMOD */ 00697000
*                                                                  0360 00698000
         L     @03,@PC00002                                        0360 00699000
         SLR   @15,@15                                             0360 00700000
         ST    @15,ICTPCHN(,@03)                                   0360 00701000
*   /*****************************************************************/ 00702000
*   /*                                                               */ 00703000
*   /* DETERMINE FUNCTION BEING DELETED                              */ 00704000
*   /*                                                               */ 00705000
*   /*****************************************************************/ 00706000
*                                                                  0361 00707000
*   IF ICTPTYPE(1)=IOPPFUNC         /* SYSMOD PASSED IS A FUNCTION   */ 00708000
*     THEN                                                         0361 00709000
         CLI   ICTPTYPE(@03),4                                     0361 00710000
         BNE   @RF00361                                            0361 00711000
*     DELFCTN=ICTPTFS(1);           /* ... IT IS THE FUNCTION BEING     00712000
*                                      DELETED                       */ 00713000
         MVC   DELFCTN(7),ICTPTFS(@03)                             0362 00714000
*   ELSE                                                           0363 00715000
*     DELFCTN=ICTPFMID(1);          /* ... THE FUNCTIONAL OWNER OF 0363 00716000
*                                      THE SYSMOD PASSED IS THE    0363 00717000
*                                      FUNCTION BEING DELETED        */ 00718000
*                                                                  0363 00719000
         B     @RC00361                                            0363 00720000
@RF00361 L     @03,@PC00002                                        0363 00721000
         MVC   DELFCTN(7),ICTPFMID(@03)                            0363 00722000
*   /*****************************************************************/ 00723000
*   /*                                                               */ 00724000
*   /* INITILIAZE IOP (PTRIOP1) TO ACCESS (A)CDS PTF ENTRY           */ 00725000
*   /*                                                               */ 00726000
*   /*****************************************************************/ 00727000
*                                                                  0364 00728000
*   IOPDSID=TBLXCDSI;               /* CONTROL DATASET ID            */ 00729000
@RC00361 L     @03,@PC00001                                        0364 00730000
         MVC   IOPDSID(1,PTRIOP1),TBLXCDSI(@03)                    0364 00731000
*   IOPFUNCT=IOPLOC;                /* LOCATE FUNCTION               */ 00732000
         MVI   IOPFUNCT(PTRIOP1),X'03'                             0365 00733000
*   IOPNAME=' ';                                                   0366 00734000
         MVI   IOPNAME+1(PTRIOP1),C' '                             0366 00735000
         MVC   IOPNAME+2(6,PTRIOP1),IOPNAME+1(PTRIOP1)             0366 00736000
         MVI   IOPNAME(PTRIOP1),C' '                               0366 00737000
*   IOPNAM17=ICTPTFS(1);            /* ENTRY NAME CURRENT SYSMOD     */ 00738000
         L     @03,@PC00002                                        0367 00739000
         MVC   IOPNAM17(7,PTRIOP1),ICTPTFS(@03)                    0367 00740000
*   IOPTYPE=IOPSMD;                 /* ENTRY TYPE IS SYSMOD          */ 00741000
         MVI   IOPTYPE(PTRIOP1),X'0B'                              0368 00742000
*   CALL HMASMIO(HMASMIOP);                                        0369 00743000
         ST    PTRIOP1,@AL00001                                    0369 00744000
         L     @15,@CV01886                                        0369 00745000
         LA    @01,@AL00001                                        0369 00746000
         BALR  @14,@15                                             0369 00747000
*   IF IOPRETRN=IOPGOOD             /* SYSMOD ENTRY FOUND ON (A)CDS  */ 00748000
*       &IOPDUMMP=OFF               /* ... NOT DUMMY SUP OR DELETE   */ 00749000
*     THEN                                                         0370 00750000
         CLI   IOPRETRN(PTRIOP1),0                                 0370 00751000
         BNE   @RF00370                                            0370 00752000
         TM    IOPDUMMP(PTRIOP1),B'00000100'                       0370 00753000
         BNZ   @RF00370                                            0370 00754000
*     DO;                                                          0371 00755000
*                                                                  0371 00756000
*       /*************************************************************/ 00757000
*       /*                                                           */ 00758000
*       /* SYSMOD TO BE DELETED LOCATED ON (A)CDS ... BUILD DELETED  */ 00759000
*       /* MOD SECT ENTRIES FOR ALL ELEMENTS ON THE TARGET SYSTEM    */ 00760000
*       /* WHICH STILL BELONG TO THIS SYSMOD                         */ 00761000
*       /*                                                           */ 00762000
*       /*************************************************************/ 00763000
*                                                                  0372 00764000
*                                                                  0372 00765000
*       /*************************************************************/ 00766000
*       /*                                                           */ 00767000
*       /* GO THRU ALL SUBENTRIES IN (A)CDS PTF ENTRY                */ 00768000
*       /*                                                           */ 00769000
*       /*************************************************************/ 00770000
*                                                                  0372 00771000
*       DO J=1 BY 1 WHILE IOPPTFND(J)^=IOPEOLST;                   0372 00772000
         LA    J,1                                                 0372 00773000
         B     @DE00372                                            0372 00774000
@DL00372 DS    0H                                                  0373 00775000
*         IF IOPPIND(J)>=IOPPREG    /* REGRESSED SUB-ENTRY VALUE     */ 00776000
*           THEN                                                   0373 00777000
         LA    @15,80                                              0373 00778000
         LR    @14,J                                               0373 00779000
         MH    @14,@CH00034                                        0373 00780000
         SLR   @07,@07                                             0373 00781000
         IC    @07,IOPPIND-9(@14,PTRIOP1)                          0373 00782000
         CR    @07,@15                                             0373 00783000
         BL    @RF00373                                            0373 00784000
*           TESTIND=IOPPIND(J)-IOPPREG;/* CHANGE REGRESSED VALUE TO     00785000
*                                      CORRESPONDING NON-REGRESSED 0374 00786000
*                                      VALUE                         */ 00787000
         SLR   @07,@15                                             0374 00788000
         STC   @07,TESTIND                                         0374 00789000
*         ELSE                                                     0375 00790000
*           TESTIND=IOPPIND(J);     /* USE IOPPIND VALUE AS IS       */ 00791000
         B     @RC00373                                            0375 00792000
@RF00373 LR    @15,J                                               0375 00793000
         MH    @15,@CH00034                                        0375 00794000
         SLR   @14,@14                                             0375 00795000
         IC    @14,IOPPIND-9(@15,PTRIOP1)                          0375 00796000
         STC   @14,TESTIND                                         0375 00797000
*         IF TESTIND=IOPPASM        /* ASSEMBLY SUB-ENTRY            */ 00798000
*           THEN                                                   0376 00799000
@RC00373 CLI   TESTIND,8                                           0376 00800000
         BNE   @RF00376                                            0376 00801000
*           TESTIND=IOPPMOD;        /* TREAT IT AS IF IT IS A ++MOD  */ 00802000
         MVI   TESTIND,X'01'                                       0377 00803000
*         IF TESTIND=IOPPMOD|       /* ++MOD ELEMENT ?               */ 00804000
*             TESTIND=IOPPMACR|     /* ++MAC ELEMENT ?               */ 00805000
*             TESTIND=IOPPSRCR|     /* ++SRC ELEMENT ?               */ 00806000
*             TESTIND=IOPPMACU|     /* ++MACUPD ELEMENT ?            */ 00807000
*             TESTIND=IOPPSRCU      /* ++SRCUPD ELEMENT ?            */ 00808000
*           THEN                                                   0378 00809000
@RF00376 CLI   TESTIND,1                                           0378 00810000
         BE    @RT00378                                            0378 00811000
         CLI   TESTIND,4                                           0378 00812000
         BE    @RT00378                                            0378 00813000
         CLI   TESTIND,6                                           0378 00814000
         BE    @RT00378                                            0378 00815000
         CLI   TESTIND,5                                           0378 00816000
         BE    @RT00378                                            0378 00817000
         CLI   TESTIND,7                                           0378 00818000
         BNE   @RF00378                                            0378 00819000
@RT00378 DS    0H                                                  0379 00820000
*           DO;                                                    0379 00821000
*                                                                  0379 00822000
*             /*******************************************************/ 00823000
*             /*                                                     */ 00824000
*             /* BUILD ICT MOD ENTRY IF (A)CDS ELEMENT IS FROM THE   */ 00825000
*             /* FUNCTION BEING DELETED                              */ 00826000
*             /*                                                     */ 00827000
*             /*******************************************************/ 00828000
*                                                                  0380 00829000
*             CALL CDSDEL1(IOPPMODS(J),/* ELEMENT NAME               */ 00830000
*                 TESTIND,          /* ELEMENT TYPE                  */ 00831000
*                 DELFCTN,          /* FUNCTION BEING DELETED        */ 00832000
*                 ICTPTFS(1));      /* SYSMOD BEING DELETED          */ 00833000
         LR    @15,J                                               0380 00834000
         MH    @15,@CH00034                                        0380 00835000
         LA    @15,IOPPMODS-9(@15,PTRIOP1)                         0380 00836000
         ST    @15,@AL00001                                        0380 00837000
         LA    @15,TESTIND                                         0380 00838000
         ST    @15,@AL00001+4                                      0380 00839000
         LA    @15,DELFCTN                                         0380 00840000
         ST    @15,@AL00001+8                                      0380 00841000
         L     @15,@PC00002                                        0380 00842000
         ST    @15,@AL00001+12                                     0380 00843000
         LA    @01,@AL00001                                        0380 00844000
         BAL   @14,CDSDEL1                                         0380 00845000
*             IF TESTIND=IOPPSRCR   /* SOURCE ELEMENT BEING DELETED  */ 00846000
*               THEN                                               0381 00847000
         CLI   TESTIND,6                                           0381 00848000
         BNE   @RF00381                                            0381 00849000
*               DO;                                                0382 00850000
*                                                                  0382 00851000
*                 /***************************************************/ 00852000
*                 /*                                                 */ 00853000
*                 /* BUILD ICT MOD ENTRY FOR THE MODULE CORRESPONDING*/ 00854000
*                 /* TO THE ABOVE ++SRC ELEMENT                      */ 00855000
*                 /*                                                 */ 00856000
*                 /***************************************************/ 00857000
*                                                                  0383 00858000
*                 TESTIND=IOPPMOD;  /* ELEMENT TYPE IS NOW ++MOD     */ 00859000
         MVI   TESTIND,X'01'                                       0383 00860000
*                 CALL CDSDEL1(IOPPMODS(J),/* ELEMENT NAME           */ 00861000
*                     TESTIND,      /* ELEMENT TYPE                  */ 00862000
*                     DELFCTN,      /* FUNCTION BEING DELETED        */ 00863000
*                     ICTPTFS(1));  /* SYSMOD BEING DELETED          */ 00864000
         LR    @15,J                                               0384 00865000
         MH    @15,@CH00034                                        0384 00866000
         LA    @15,IOPPMODS-9(@15,PTRIOP1)                         0384 00867000
         ST    @15,@AL00001                                        0384 00868000
         LA    @15,TESTIND                                         0384 00869000
         ST    @15,@AL00001+4                                      0384 00870000
         LA    @15,DELFCTN                                         0384 00871000
         ST    @15,@AL00001+8                                      0384 00872000
         L     @15,@PC00002                                        0384 00873000
         ST    @15,@AL00001+12                                     0384 00874000
         LA    @01,@AL00001                                        0384 00875000
         BAL   @14,CDSDEL1                                         0384 00876000
*               END;                                               0385 00877000
*           END;                    /* END PROCESSING ELEMENT      0386 00878000
*                                      SUBENTRY                      */ 00879000
@RF00381 DS    0H                                                  0387 00880000
*       END;                        /* END LOOP THRU (A)CDS PTF    0387 00881000
*                                      SUBENTRIES                    */ 00882000
@RF00378 AL    J,@CF00065                                          0387 00883000
@DE00372 LR    @15,J                                               0387 00884000
         MH    @15,@CH00034                                        0387 00885000
         SLR   @14,@14                                             0387 00886000
         IC    @14,IOPPTFND-9(@15,PTRIOP1)                         0387 00887000
         CH    @14,@CH00765                                        0387 00888000
         BNE   @DL00372                                            0387 00889000
*     END;                          /* END DELETED SYSMOD FOUND ON 0388 00890000
*                                      (A)CDS                        */ 00891000
*   ELSE                                                           0389 00892000
*     DO;                                                          0389 00893000
*                                                                  0389 00894000
         B     @RC00370                                            0389 00895000
@RF00370 DS    0H                                                  0390 00896000
*       /*************************************************************/ 00897000
*       /*                                                           */ 00898000
*       /* SYSMOD TO BE DELETED NOT LOCATED ON (A)CDS                */ 00899000
*       /*                                                           */ 00900000
*       /*************************************************************/ 00901000
*                                                                  0390 00902000
*       IF IOPRETRN>IOPNOTFD THEN                                  0390 00903000
         CLI   IOPRETRN(PTRIOP1),4                                 0390 00904000
         BNH   @RF00390                                            0390 00905000
*         DO;                                                      0391 00906000
*                                                                  0391 00907000
*           /*********************************************************/ 00908000
*           /*                                                       */ 00909000
*           /* I/O ERROR ACCESSING (A)CDS PTF ENTRY FOR SYSMOD BEING */ 00910000
*           /* DELETED. THIS MUST TERMINATE THE FUNCTION.            */ 00911000
*           /*                                                       */ 00912000
*           /*********************************************************/ 00913000
*                                                                  0392 00914000
*           HIGHTMD=MAX(HIGHTMD,IOPRETRN);/* MAINTAIN HIGHTMD RET  0392 00915000
*                                      CODE                          */ 00916000
         L     @03,HIGHTMD                                         0392 00917000
         SLR   @15,@15                                             0392 00918000
         IC    @15,IOPRETRN(,PTRIOP1)                              0392 00919000
         CR    @03,@15                                             0392 00920000
         BNL   *+6                                                      00921000
         LR    @03,@15                                             0392 00922000
         ST    @03,HIGHTMD                                         0392 00923000
*         END;                                                     0393 00924000
*     END;                                                         0394 00925000
*                                                                  0394 00926000
@RF00390 DS    0H                                                  0395 00927000
*   /*****************************************************************/ 00928000
*   /*                                                               */ 00929000
*   /* MOD SECTION ENTRIES BUILT FOR ELEMENTS WHICH BELONG TO THE    */ 00930000
*   /* SYSMOD BEING DELETED                                          */ 00931000
*   /*                                                               */ 00932000
*   /*****************************************************************/ 00933000
*                                                                  0395 00934000
*   RESPECIFY                                                      0395 00935000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECT       */ 00936000
*                                                                  0395 00937000
@RC00370 DS    0H                                                  0396 00938000
*   /*****************************************************************/ 00939000
*   /*                                                               */ 00940000
*   /* GO THRU THE MOD SECT AND CHAIN ENTRIES JUST ADDED TO THE      */ 00941000
*   /* CURRENT SYSMOD                                                */ 00942000
*   /*                                                               */ 00943000
*   /*****************************************************************/ 00944000
*                                                                  0396 00945000
*   DO J=1 BY 1 WHILE ICTMEND(J)^=ICTENDNT;                        0396 00946000
         LA    J,1                                                 0396 00947000
         B     @DE00396                                            0396 00948000
@DL00396 DS    0H                                                  0397 00949000
*     IF ICTMPASS(J)=ON             /* ADDED THIS PASS               */ 00950000
*       THEN                                                       0397 00951000
         LR    @15,J                                               0397 00952000
         MH    @15,@CH02383                                        0397 00953000
         L     @14,CCAICMOD(,CCAPTR)                               0397 00954000
         ST    @15,@TF00001                                        0397 00955000
         ALR   @15,@14                                             0397 00956000
         AL    @15,@CF02427                                        0397 00957000
         TM    ICTMPASS-12(@15),B'10000000'                        0397 00958000
         BNO   @RF00397                                            0397 00959000
*       DO;                                                        0398 00960000
*                                                                  0398 00961000
*         /***********************************************************/ 00962000
*         /*                                                         */ 00963000
*         /* PUT PTR TO ELEMENT IN PTF ENTRY LIST                    */ 00964000
*         /*                                                         */ 00965000
*         /***********************************************************/ 00966000
*                                                                  0399 00967000
*         PTR0=ADDR(ICTMOD(J));     /* ADDRESS OF MOD ENTRY          */ 00968000
         L     @15,@TF00001                                        0399 00969000
         AL    @14,@CF02422                                        0399 00970000
         LA    @15,ICTMOD(@15,@14)                                 0399 00971000
         ST    @15,PTR0                                            0399 00972000
*         CALL HMASMTAI(TBLXPARM,   /* TBLX PARMS                    */ 00973000
*             ICTPCHN(1),           /* MOD CHAIN                     */ 00974000
*             ADDR(PTR0),           /* VARIABLE CONTAINING @ MOD ENT.*/ 00975000
*             LENGTH(ICTIXP));                                     0400 00976000
         L     @15,@PC00001                                        0400 00977000
         ST    @15,@AL00001                                        0400 00978000
         L     @15,@PC00002                                        0400 00979000
         LA    @15,ICTPCHN(,@15)                                   0400 00980000
         ST    @15,@AL00001+4                                      0400 00981000
         LA    @15,PTR0                                            0400 00982000
         ST    @15,@TF00001                                        0400 00983000
         LA    @15,@TF00001                                        0400 00984000
         ST    @15,@AL00001+8                                      0400 00985000
         LA    @15,@CF00040                                        0400 00986000
         ST    @15,@AL00001+12                                     0400 00987000
         L     @15,@CV01892                                        0400 00988000
         LA    @01,@AL00001                                        0400 00989000
         BALR  @14,@15                                             0400 00990000
*         ICTMPASS(J)=OFF;          /* CLEAR "THIS PASS" FLAG        */ 00991000
         LR    @15,J                                               0401 00992000
         MH    @15,@CH02383                                        0401 00993000
         L     @01,CCAICMOD(,CCAPTR)                               0401 00994000
         ALR   @01,@15                                             0401 00995000
         AL    @01,@CF02427                                        0401 00996000
         NI    ICTMPASS-12(@01),B'01111111'                        0401 00997000
*       END;                                                       0402 00998000
*   END;                                                           0403 00999000
@RF00397 AL    J,@CF00065                                          0403 01000000
@DE00396 LR    @15,J                                               0403 01001000
         MH    @15,@CH02383                                        0403 01002000
         L     @01,CCAICMOD(,CCAPTR)                               0403 01003000
         AL    @01,@CF02422                                        0403 01004000
         L     @15,ICTMEND(@15,@01)                                0403 01005000
         CL    @15,ICTENDNT                                        0403 01006000
         BNE   @DL00396                                            0403 01007000
*   IF ICTPCHN(1)=0                 /* NO ENTRIES BUILT              */ 01008000
*     THEN                                                         0404 01009000
         L     @03,@PC00002                                        0404 01010000
         ICM   @15,15,ICTPCHN(@03)                                 0404 01011000
         BNZ   @RF00404                                            0404 01012000
*     ICTPCHN(1)=TBLXNULL;          /* POINT TO EMPTY LIST           */ 01013000
         L     @15,@PC00001                                        0405 01014000
         MVC   ICTPCHN(4,@03),TBLXNULL(@15)                        0405 01015000
*   RETURN;                                                        0406 01016000
@EL00002 DS    0H                                                  0406 01017000
@EF00002 DS    0H                                                  0406 01018000
@ER00002 LM    @14,@12,@SA00002                                    0406 01019000
         BR    @14                                                 0406 01020000
*                                                                  0407 01021000
*/********************************************************************/ 01022000
*/*                                                                  */ 01023000
*/* CDSDEL1  - BUILD ICT MOD SECTION ENTRY FOR ELEMENT FROM A        */ 01024000
*/*            DELETED SYSMOD                                        */ 01025000
*/*                                                                  */ 01026000
*/********************************************************************/ 01027000
*                                                                  0407 01028000
*CDSDEL1:                                                          0407 01029000
*   PROC(DELMNAME,DELMTYP,DELMFCTN,DELMSMD);                       0407 01030000
CDSDEL1  STM   @14,@12,@SA00003                                    0407 01031000
         MVC   @PC00003(16),0(@01)                                 0407 01032000
*   DCL                                                            0408 01033000
*     DELMNAME CHAR(8);             /* ELEMENT TO BE DELETED         */ 01034000
*   DCL                                                            0409 01035000
*     DELMTYP FIXED(8);             /* ELEMENT TYPE                  */ 01036000
*   DCL                                                            0410 01037000
*     DELMFCTN CHAR(7);             /* FUNCTION BEING DELETED        */ 01038000
*   DCL                                                            0411 01039000
*     DELMSMD CHAR(7);              /* SYSMOD BEING DELETED          */ 01040000
*   CALL RMODICT(DELMNAME,DELMTYP,PTR0);/* CHECK ICT TO SEE IF     0412 01041000
*                                      ELEMENT IS THERE              */ 01042000
         L     @15,@PC00003                                        0412 01043000
         ST    @15,@AL00001                                        0412 01044000
         L     @15,@PC00003+4                                      0412 01045000
         ST    @15,@AL00001+4                                      0412 01046000
         LA    @15,PTR0                                            0412 01047000
         ST    @15,@AL00001+8                                      0412 01048000
         LA    @01,@AL00001                                        0412 01049000
         BAL   @14,RMODICT                                         0412 01050000
*   IF PTR0^=0                      /* ELEMENT FOUND IN ICT          */ 01051000
*     THEN                                                         0413 01052000
         ICM   @15,15,PTR0                                         0413 01053000
         BZ    @RF00413                                            0413 01054000
*     PTRIOP2->IOPRETRN=IOPNOTFD;   /* DO NOT BUILD ANOTHER DELETED     01055000
*                                      ICT MOD SECT ENTRY            */ 01056000
         L     @01,PTRIOP2                                         0414 01057000
         MVI   IOPRETRN(@01),X'04'                                 0414 01058000
*   ELSE                                                           0415 01059000
*     CALL LOCELEM(DELMNAME,DELMTYP);/* LOOK FOR MOD ON (A)CDS       */ 01060000
         B     @RC00413                                            0415 01061000
@RF00413 L     @15,@PC00003                                        0415 01062000
         ST    @15,@AL00001                                        0415 01063000
         L     @15,@PC00003+4                                      0415 01064000
         ST    @15,@AL00001+4                                      0415 01065000
         LA    @01,@AL00001                                        0415 01066000
         BAL   @14,LOCELEM                                         0415 01067000
*   IF PTRIOP2->IOPRETRN=IOPGOOD    /* ELEMENT LOCATED ON (A)CDS     */ 01068000
*       &(PTRIOP2->IOPFMID=DELMFCTN /* ELEMENT-FMID MATCHES FUNCTION    01069000
*                                      BEING DELETED                 */ 01070000
*       |(PTRIOP2->IOPFMID=NULLPTF# /* ELEMENT HAS NO FMID ... AND   */ 01071000
*       &PTRIOP2->IOPRMID=DELMSMD)) /* ELEMENT-RMID MATCHES SYSMOD 0416 01072000
*                                      BEING DELETED                 */ 01073000
*     THEN                                                         0416 01074000
@RC00413 L     @15,PTRIOP2                                         0416 01075000
         CLI   IOPRETRN(@15),0                                     0416 01076000
         BNE   @RF00416                                            0416 01077000
         L     @14,@PC00003+8                                      0416 01078000
         CLC   IOPFMID(7,@15),DELMFCTN(@14)                        0416 01079000
         BE    @RT00416                                            0416 01080000
         CLC   IOPFMID(7,@15),@CC01944                             0416 01081000
         BNE   @RF00416                                            0416 01082000
         L     @14,@PC00003+12                                     0416 01083000
         CLC   IOPRMID(7,@15),DELMSMD(@14)                         0416 01084000
         BNE   @RF00416                                            0416 01085000
@RT00416 DS    0H                                                  0417 01086000
*     DO;                                                          0417 01087000
*                                                                  0417 01088000
*       /*************************************************************/ 01089000
*       /*                                                           */ 01090000
*       /* ELEMENT NOT ALREADY IN ICT AND ELEMENT FOUND ON (A)CDS FOR*/ 01091000
*       /* PROPER FMID ... GET A MOD SECT ENTRY AND INITIALIZE IT    */ 01092000
*       /*                                                           */ 01093000
*       /*************************************************************/ 01094000
*                                                                  0418 01095000
*       PTR0=TBLXTOP;               /* ADDR OF ENTRY TO BE OBTAINED  */ 01096000
         L     @15,@PC00001                                        0418 01097000
         MVC   PTR0(4),TBLXTOP(@15)                                0418 01098000
*       CALL HMASMTAD(TBLXPARM,     /* PARM LIST                     */ 01099000
*           'M',                    /* BUILD MOD SECTION ENTRY       */ 01100000
*           IOPPMODS(J));           /* ENTRY NAME                    */ 01101000
         ST    @15,@AL00001                                        0419 01102000
         LA    @15,@CC00717                                        0419 01103000
         ST    @15,@AL00001+4                                      0419 01104000
         LR    @15,J                                               0419 01105000
         MH    @15,@CH00034                                        0419 01106000
         LA    @15,IOPPMODS-9(@15,PTRIOP1)                         0419 01107000
         ST    @15,@AL00001+8                                      0419 01108000
         L     @15,@CV01891                                        0419 01109000
         LA    @01,@AL00001                                        0419 01110000
         BALR  @14,@15                                             0419 01111000
*       RESPECIFY                                                  0420 01112000
*         REG15 RSTD;                                              0420 01113000
*       IF REG15^=ZERO THEN                                        0421 01114000
         LTR   REG15,REG15                                         0421 01115000
         BZ    @RF00421                                            0421 01116000
*         HIGHTMD=MAX(HIGHTMD,REG15);/* MAINTAIN HIGHTMD RETURN CODE */ 01117000
         L     @14,HIGHTMD                                         0422 01118000
         CR    @14,REG15                                           0422 01119000
         BNL   *+6                                                      01120000
         LR    @14,REG15                                           0422 01121000
         ST    @14,HIGHTMD                                         0422 01122000
*       ELSE                                                       0423 01123000
*         DO;                                                      0423 01124000
         B     @RC00421                                            0423 01125000
@RF00421 DS    0H                                                  0424 01126000
*           RESPECIFY                                              0424 01127000
*             REG15 UNRSTD;                                        0424 01128000
*           RESPECIFY                                              0425 01129000
*             ICTMOD BASED(PTR0);   /* ADDRESS MOD SECTION ENTRY   0425 01130000
*                                      OBTAINED                      */ 01131000
*                                                                  0425 01132000
*           /*********************************************************/ 01133000
*           /*                                                       */ 01134000
*           /* INITIALIZE MOD ENTRY FOR DELETED ELEMENT              */ 01135000
*           /*                                                       */ 01136000
*           /*********************************************************/ 01137000
*                                                                  0426 01138000
*           ICTMFMID(1)=PTRIOP2->IOPFMID;/* ELEMENT-FMID             */ 01139000
         L     @15,PTR0                                            0426 01140000
         L     @14,PTRIOP2                                         0426 01141000
         MVC   ICTMFMID(7,@15),IOPFMID(@14)                        0426 01142000
*           ICTMISEL(1)=ON;         /* SET ELEMENT SELECTED          */ 01143000
*           ICTMTSEL(1)=ON;         /* SET TRANSIENT SELECT FLAG     */ 01144000
*           ICTMIDEL(1)=ON;         /* SET ELEMENT DELETED           */ 01145000
         OI    ICTMISEL(@15),B'11000010'                           0429 01146000
*           IF DELMTYP=IOPPMOD      /* ++MOD                         */ 01147000
*             THEN                                                 0430 01148000
         L     @14,@PC00003+4                                      0430 01149000
         CLI   DELMTYP(@14),1                                      0430 01150000
         BNE   @RF00430                                            0430 01151000
*             ICTMMOD(1)=ON;        /* MODULE REPLACEMENT            */ 01152000
         OI    ICTMMOD(@15),B'10000000'                            0431 01153000
*           IF DELMTYP=IOPPMACR     /* ++MAC                         */ 01154000
*               |DELMTYP=IOPPMACU   /* ++MACUPD                      */ 01155000
*             THEN                                                 0432 01156000
@RF00430 L     @15,@PC00003+4                                      0432 01157000
         CLI   DELMTYP(@15),4                                      0432 01158000
         BE    @RT00432                                            0432 01159000
         CLI   DELMTYP(@15),5                                      0432 01160000
         BNE   @RF00432                                            0432 01161000
@RT00432 DS    0H                                                  0433 01162000
*             ICTMMACR(1)=ON;       /* MACRO REPLACEMENT             */ 01163000
         L     @01,PTR0                                            0433 01164000
         OI    ICTMMACR(@01),B'00001000'                           0433 01165000
*           IF DELMTYP=IOPPSRCR     /* ++SRC                         */ 01166000
*               |DELMTYP=IOPPSRCU   /* ++SRCUPD                      */ 01167000
*             THEN                                                 0434 01168000
@RF00432 L     @15,@PC00003+4                                      0434 01169000
         CLI   DELMTYP(@15),6                                      0434 01170000
         BE    @RT00434                                            0434 01171000
         CLI   DELMTYP(@15),7                                      0434 01172000
         BNE   @RF00434                                            0434 01173000
@RT00434 DS    0H                                                  0435 01174000
*             ICTMSRCR(1)=ON;       /* SOURCE REPLACEMENT            */ 01175000
         L     @01,PTR0                                            0435 01176000
         OI    ICTMSRCR(@01),B'00000010'                           0435 01177000
*           ICTPPTR(1)=ADDR(ICTPTF(1));/* POINT TO PTF SECTION ENTRY */ 01178000
*                                                                  0436 01179000
@RF00434 L     @15,PTR0                                            0436 01180000
         L     @14,@PC00002                                        0436 01181000
         ST    @14,ICTPPTR(,@15)                                   0436 01182000
*           /*********************************************************/ 01183000
*           /*                                                       */ 01184000
*           /* INITIALIZE MOD ENTRY FROM (A)CDS ELEMENT ENTRY IOP    */ 01185000
*           /* (POINTED TO BY PTRIOP2)                               */ 01186000
*           /*                                                       */ 01187000
*           /*********************************************************/ 01188000
*                                                                  0437 01189000
*           CALL INITICTM(PTRIOP2,ICTMOD(1));                      0437 01190000
         LA    @14,PTRIOP2                                         0437 01191000
         ST    @14,@AL00001                                        0437 01192000
         ST    @15,@AL00001+4                                      0437 01193000
         LA    @01,@AL00001                                        0437 01194000
         BAL   @14,INITICTM                                        0437 01195000
*           ICTMPASS(1)=ON;         /* SET "PASS" FLAG IN ENTRY ADDED*/ 01196000
         L     @01,PTR0                                            0438 01197000
         OI    ICTMPASS(@01),B'10000000'                           0438 01198000
*         END;                      /* END MOD ENTRY INITIALIZATION  */ 01199000
*     END;                          /* END MOD ENTRY FOUND ON (A)CDS */ 01200000
*   RETURN;                                                        0441 01201000
@EL00003 DS    0H                                                  0441 01202000
@EF00003 DS    0H                                                  0441 01203000
@ER00003 LM    @14,@12,@SA00003                                    0441 01204000
         BR    @14                                                 0441 01205000
*   END CDSDEL1;                                                   0442 01206000
         B     @EL00003                                            0442 01207000
*   END CDSDEL;                                                    0443 01208000
         B     @EL00002                                            0443 01209000
*                                                                  0444 01210000
*/********************************************************************/ 01211000
*/*                                                                  */ 01212000
*/*    BLDICTM  - BUILD ICT MOD SECTION ENTRIES FOR THE SYSMODS      */ 01213000
*/*               IN THE ICT                                         */ 01214000
*/*                                                                  */ 01215000
*/*    CONDITIONS UPON ENTRY:                                        */ 01216000
*/*                                                                  */ 01217000
*/*     * ICT PTF SECTION BUILT                                      */ 01218000
*/*                                                                  */ 01219000
*/*    CONDITIONS UPON EXIT:                                         */ 01220000
*/*                                                                  */ 01221000
*/*     * ICT MOD SECTION BUILT                                      */ 01222000
*/*                                                                  */ 01223000
*/*     * SELECTED ELEMENTS (SUPPLIED IN-LINE) MOVED TO SMPWRK       */ 01224000
*/*       DATASETS                                                   */ 01225000
*/*                                                                  */ 01226000
*/*     * ICTMIDPS ( (A)CDS MODID LIST PRE/SUP FLAGS) APPROPRIATELY  */ 01227000
*/*       SET FOR SELECTED ELEMENTS FROM NON-TERMINATED SYSMODS      */ 01228000
*/*                                                                  */ 01229000
*/*     * ICTPNOGO (SYSMOD NOGO FLAG) SET IN ICT PTF SECTION ENTRY   */ 01230000
*/*       FOR SYSMODS WHICH WERE TERMINATED DURING ELEMENT SELECTION */ 01231000
*/*                                                                  */ 01232000
*/*     * HIGHTMD  - SET TO THE MAXIMUM RETURN CODE ENCOUNTERED      */ 01233000
*/*                  DURING MOD SECTION BUILD PROCESSING.            */ 01234000
*/*                                                                  */ 01235000
*/********************************************************************/ 01236000
*                                                                  0444 01237000
*BLDICTM:                                                          0444 01238000
*   PROC;                                                          0444 01239000
BLDICTM  STM   @14,@12,@SA00004                                    0444 01240000
*   DCL                                                            0445 01241000
*     BLDICTRC FIXED(31);           /* LOCAL RETURN CODE ...       0445 01242000
*                                      "CURRENT" SYSMOD PROCESSING 0445 01243000
*                                      CODE                          */ 01244000
*   DCL                                                            0446 01245000
*     SI FIXED(31);                 /* ICT PTF SECTION ENTRY INDEX   */ 01246000
*   RESPECIFY                                                      0447 01247000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE PTF SECTION    */ 01248000
*                                                                  0448 01249000
*   /*****************************************************************/ 01250000
*   /*                                                               */ 01251000
*   /* GET SYSMODS FROM THE ICT (IN THEIR SYSMOD PROCESSING ORDER)   */ 01252000
*   /* AND BUILD THE ICT MOD SECTION UNTIL THERE ARE NO PROCESSABLE  */ 01253000
*   /* SYSMODS LEFT IN THE ICT                                       */ 01254000
*   /*                                                               */ 01255000
*   /*****************************************************************/ 01256000
*                                                                  0448 01257000
*   BUILD=CONTINUE;                 /* LOOP CONTROL                  */ 01258000
         OI    BUILD,B'01000000'                                   0448 01259000
*   DO WHILE BUILD=CONTINUE         /* PROCESSABLE SYSMOD LAST PASS  */ 01260000
*         &HIGHTMD<STOPFUNC;        /* NON-TERMINATING ERRORS        */ 01261000
         B     @DE00449                                            0449 01262000
@DL00449 DS    0H                                                  0450 01263000
*     BUILD=STOP;                   /* LOOP CONTROL SET TO STOP      */ 01264000
         NI    BUILD,B'10111111'                                   0450 01265000
*     BLDICTRC=0;                   /* "CURRENT" SYSMOD PROCESSING   */ 01266000
         SLR   @03,@03                                             0451 01267000
         ST    @03,BLDICTRC                                        0451 01268000
*     CALL GETSYSPO(SI);            /* GET NEXT PROCESSABLE SYSMOD   */ 01269000
         LA    @01,@AL00452                                        0452 01270000
         BAL   @14,GETSYSPO                                        0452 01271000
*     IF SI^=0 THEN                                                0453 01272000
         L     @03,SI                                              0453 01273000
         LTR   @03,@03                                             0453 01274000
         BZ    @RF00453                                            0453 01275000
*       DO;                                                        0454 01276000
*                                                                  0454 01277000
*         /***********************************************************/ 01278000
*         /*                                                         */ 01279000
*         /* PROCESSABLE SYSMOD FOUND ... BUILD MOD SECT ENTRIES     */ 01280000
*         /*                                                         */ 01281000
*         /***********************************************************/ 01282000
*                                                                  0455 01283000
*         MSGSMDNM=ICTPTFS(SI);     /* SET UP SYSMOD NAME FOR ERRMSG */ 01284000
         MH    @03,@CH02382                                        0455 01285000
         L     @15,CCAICPTF(,CCAPTR)                               0455 01286000
         ST    @03,@TF00001                                        0455 01287000
         ALR   @03,@15                                             0455 01288000
         AL    @03,@CF02417                                        0455 01289000
         MVC   MSGSMDNM(7),ICTPTFS(@03)                            0455 01290000
*         BUILD=CONTINUE;           /* LOOP CONTROL ... THERE MAY BE    01291000
*                                      MORE PROCESSABLE SYSMODS      */ 01292000
         OI    BUILD,B'01000000'                                   0456 01293000
*         CALL BLDMODS(ICTPTF(SI),  /* "CURRENT" SYSMOD              */ 01294000
*             BLDICTRC);            /* "CURRENT" RETURN CODE         */ 01295000
         L     @03,@TF00001                                        0457 01296000
         AL    @15,@CF02417                                        0457 01297000
         LA    @03,ICTPTF(@03,@15)                                 0457 01298000
         ST    @03,@AL00001                                        0457 01299000
         LA    @03,BLDICTRC                                        0457 01300000
         ST    @03,@AL00001+4                                      0457 01301000
         LA    @01,@AL00001                                        0457 01302000
         BAL   @14,BLDMODS                                         0457 01303000
*         ICTPMSL(SI)=ON;           /* INDICATE THIS SYSMOD PROCESSED*/ 01304000
         L     @03,SI                                              0458 01305000
         MH    @03,@CH02382                                        0458 01306000
         L     @15,CCAICPTF(,CCAPTR)                               0458 01307000
         ST    @03,@TF00001                                        0458 01308000
         ALR   @03,@15                                             0458 01309000
         AL    @03,@CF02418                                        0458 01310000
         OI    ICTPMSL-15(@03),B'10000000'                         0458 01311000
*         CALL MARKSUPS(ICTPTF(SI));/* MARK SUPD SYSMODS AS PROCESSED*/ 01312000
         L     @03,@TF00001                                        0459 01313000
         AL    @15,@CF02417                                        0459 01314000
         LA    @03,ICTPTF(@03,@15)                                 0459 01315000
         ST    @03,@AL00001                                        0459 01316000
         LA    @01,@AL00001                                        0459 01317000
         BAL   @14,MARKSUPS                                        0459 01318000
*         IF BLDICTRC<STOPPTF THEN                                 0460 01319000
         L     @03,BLDICTRC                                        0460 01320000
         CH    @03,@CH00033                                        0460 01321000
         BNL   @RF00460                                            0460 01322000
*           DO;                                                    0461 01323000
*                                                                  0461 01324000
*             /*******************************************************/ 01325000
*             /*                                                     */ 01326000
*             /* MOD SECT ENTRIES BUILT ... SELECT ELEMENTS          */ 01327000
*             /*                                                     */ 01328000
*             /*******************************************************/ 01329000
*                                                                  0462 01330000
*             CALL HMASMTMS(TBLXPARM,/* TBLX PARM LIST               */ 01331000
*                 ADDR(ICTPTF(SI)));/* CURRENT SYSMOD                */ 01332000
         L     @03,@PC00001                                        0462 01333000
         ST    @03,@AL00001                                        0462 01334000
         L     @03,SI                                              0462 01335000
         MH    @03,@CH02382                                        0462 01336000
         L     @01,CCAICPTF(,CCAPTR)                               0462 01337000
         AL    @01,@CF02417                                        0462 01338000
         LA    @03,ICTPTF(@03,@01)                                 0462 01339000
         ST    @03,@TF00001                                        0462 01340000
         LA    @03,@TF00001                                        0462 01341000
         ST    @03,@AL00001+4                                      0462 01342000
         L     @15,@CV01894                                        0462 01343000
         LA    @01,@AL00001                                        0462 01344000
         BALR  @14,@15                                             0462 01345000
*             RESPECIFY                                            0463 01346000
*               REG15 RSTD;                                        0463 01347000
*             BLDICTRC=MAX(BLDICTRC,REG15);/* SAVE TMS RETURN CODE   */ 01348000
         L     @14,BLDICTRC                                        0464 01349000
         CR    @14,REG15                                           0464 01350000
         BNL   *+6                                                      01351000
         LR    @14,REG15                                           0464 01352000
         ST    @14,BLDICTRC                                        0464 01353000
*             RESPECIFY                                            0465 01354000
*               REG15 UNRSTD;                                      0465 01355000
*           END;                                                   0466 01356000
*         IF BLDICTRC<STOPPTF       /* "CURRENT" SYSMOD NOT TERM     */ 01357000
*             &BLDM2WRK=ON          /* ELEMENTS TO BE MOVED TO WRK   */ 01358000
*           THEN                                                   0467 01359000
@RF00460 L     @03,BLDICTRC                                        0467 01360000
         CH    @03,@CH00033                                        0467 01361000
         BNL   @RF00467                                            0467 01362000
         TM    BLDM2WRK,B'00100000'                                0467 01363000
         BNO   @RF00467                                            0467 01364000
*           DO;                                                    0468 01365000
*                                                                  0468 01366000
*             /*******************************************************/ 01367000
*             /*                                                     */ 01368000
*             /* MOVE REMAINING ELEMENTS TO WRK DATASETS             */ 01369000
*             /*                                                     */ 01370000
*             /*******************************************************/ 01371000
*                                                                  0469 01372000
*             CALL BLDMODS2(ICTPTF(SI),/* "CURRENT" SYSMOD           */ 01373000
*                 BLDICTRC);        /* RETURN CODE                   */ 01374000
         L     @03,SI                                              0469 01375000
         MH    @03,@CH02382                                        0469 01376000
         L     @01,CCAICPTF(,CCAPTR)                               0469 01377000
         AL    @01,@CF02417                                        0469 01378000
         LA    @03,ICTPTF(@03,@01)                                 0469 01379000
         ST    @03,@AL00001                                        0469 01380000
         LA    @03,BLDICTRC                                        0469 01381000
         ST    @03,@AL00001+4                                      0469 01382000
         LA    @01,@AL00001                                        0469 01383000
         BAL   @14,BLDMODS2                                        0469 01384000
*           END;                                                   0470 01385000
*         IF BLDICTRC<STOPPTF       /* SYSMOD SUCCESSFUL             */ 01386000
*           THEN                                                   0471 01387000
@RF00467 L     @03,BLDICTRC                                        0471 01388000
         CH    @03,@CH00033                                        0471 01389000
         BNL   @RF00471                                            0471 01390000
*           DO;                                                    0472 01391000
*                                                                  0472 01392000
*             /*******************************************************/ 01393000
*             /*                                                     */ 01394000
*             /* SET ICTMIDPS FLAGS FOR SELECTED ELEMENTS            */ 01395000
*             /*                                                     */ 01396000
*             /*******************************************************/ 01397000
*                                                                  0473 01398000
*             CALL BLDMODS3(ICTPTF(SI),/* "CURRENT" SYSMOD           */ 01399000
*                 BLDICTRC);        /* RETURN CODE                   */ 01400000
         L     @03,SI                                              0473 01401000
         MH    @03,@CH02382                                        0473 01402000
         L     @01,CCAICPTF(,CCAPTR)                               0473 01403000
         AL    @01,@CF02417                                        0473 01404000
         LA    @03,ICTPTF(@03,@01)                                 0473 01405000
         ST    @03,@AL00001                                        0473 01406000
         LA    @03,BLDICTRC                                        0473 01407000
         ST    @03,@AL00001+4                                      0473 01408000
         LA    @01,@AL00001                                        0473 01409000
         BAL   @14,BLDMODS3                                        0473 01410000
*           END;                                                   0474 01411000
*         ELSE                                                     0475 01412000
*           DO;                                                    0475 01413000
*                                                                  0475 01414000
         B     @RC00471                                            0475 01415000
@RF00471 DS    0H                                                  0476 01416000
*             /*******************************************************/ 01417000
*             /*                                                     */ 01418000
*             /* TERMINATE MOD SECT BUILD FOR THIS SYSMOD            */ 01419000
*             /*                                                     */ 01420000
*             /*******************************************************/ 01421000
*                                                                  0476 01422000
*             MGPTYPE=MGPINFO;      /* INFORMATIONAL                 */ 01423000
         MVI   MGPTYPE,X'01'                                       0476 01424000
*             CALL ERRMSG(HMA226I,PART011);/* PROCESSING TERM        */ 01425000
         LA    @01,@AL00477                                        0477 01426000
         BAL   @14,ERRMSG                                          0477 01427000
*             IF ICTPTYPE(SI)=IOPPFUNC/* FUNCTION SYSMOD FAILED      */ 01428000
*               THEN                                               0478 01429000
         L     @03,SI                                              0478 01430000
         MH    @03,@CH02382                                        0478 01431000
         L     @01,CCAICPTF(,CCAPTR)                               0478 01432000
         AL    @01,@CF02426                                        0478 01433000
         SLR   @00,@00                                             0478 01434000
         IC    @00,ICTPTYPE-17(@03,@01)                            0478 01435000
         CH    @00,@CH00040                                        0478 01436000
         BNE   @RF00478                                            0478 01437000
*               CALL ERRMSG(HMA370I);/* ISSUE HMA370I                */ 01438000
*                                                                  0479 01439000
         LA    @01,@AL00479                                        0479 01440000
         BAL   @14,ERRMSG                                          0479 01441000
*             /*******************************************************/ 01442000
*             /*                                                     */ 01443000
*             /* MARK "CURRENT" SYSMOD NOGO AND CHECK ICT PTF SECTION*/ 01444000
*             /* FOR REQUISITES                                      */ 01445000
*             /*                                                     */ 01446000
*             /*******************************************************/ 01447000
*                                                                  0480 01448000
*             ICTPNOGO(SI)=ON;      /* MARK SYSMOD NOGO              */ 01449000
@RF00478 DS    0H                                                  0481 01450000
*             ICTPCPL(SI)=ON;       /* MARK SYSMOD AS COMPLETE       */ 01451000
*             ICTPMSG(SI)=ON;       /* SET MSG ISSUED FLAG           */ 01452000
         L     @03,SI                                              0482 01453000
         MH    @03,@CH02382                                        0482 01454000
         L     @01,CCAICPTF(,CCAPTR)                               0482 01455000
         ALR   @01,@03                                             0482 01456000
         AL    @01,@CF02416                                        0482 01457000
         OI    ICTPNOGO-8(@01),B'01110000'                         0482 01458000
*             IF BLDICTRC<STOPFUNC&HIGHTMD<STOPFUNC THEN           0483 01459000
         LA    @03,12                                              0483 01460000
         C     @03,BLDICTRC                                        0483 01461000
         BNH   @RF00483                                            0483 01462000
         C     @03,HIGHTMD                                         0483 01463000
         BNH   @RF00483                                            0483 01464000
*               DO;                                                0484 01465000
*                 CALL HMASMTCR(TBLXPARM,MSG);/* CHECK REQUISITES    */ 01466000
         L     @03,@PC00001                                        0485 01467000
         ST    @03,@AL00001                                        0485 01468000
         LA    @03,@CC00717                                        0485 01469000
         ST    @03,@AL00001+4                                      0485 01470000
         L     @15,@CV01893                                        0485 01471000
         LA    @01,@AL00001                                        0485 01472000
         BALR  @14,@15                                             0485 01473000
*                 RESPECIFY                                        0486 01474000
*                   REG15 RSTD;                                    0486 01475000
*                 BLDICTRC=MAX(BLDICTRC,REG15);/* MAINTAIN R.C.      */ 01476000
         L     @14,BLDICTRC                                        0487 01477000
         CR    @14,REG15                                           0487 01478000
         BNL   *+6                                                      01479000
         LR    @14,REG15                                           0487 01480000
         ST    @14,BLDICTRC                                        0487 01481000
*                 RESPECIFY                                        0488 01482000
*                   REG15 UNRSTD;                                  0488 01483000
*               END;                                               0489 01484000
*           END;                                                   0490 01485000
@RF00483 DS    0H                                                  0491 01486000
*         IF BLDICTRC>0             /* ERRORS IN PROCESSING          */ 01487000
*           THEN                                                   0491 01488000
@RC00471 ICM   @03,15,BLDICTRC                                     0491 01489000
         BNP   @RF00491                                            0491 01490000
*           CALL SKIP(1);           /* SKIP A LINE ON SMPOUT         */ 01491000
         LA    @01,@AL00492                                        0492 01492000
         BAL   @14,SKIP                                            0492 01493000
*         HIGHTMD=MAX(HIGHTMD,BLDICTRC);/* SET MAX R.C. FROM LAST  0493 01494000
*                                      SYSMOD PROCESSED              */ 01495000
@RF00491 L     @03,HIGHTMD                                         0493 01496000
         L     @15,BLDICTRC                                        0493 01497000
         CR    @03,@15                                             0493 01498000
         BNL   *+6                                                      01499000
         LR    @03,@15                                             0493 01500000
         ST    @03,HIGHTMD                                         0493 01501000
*       END;                        /* END OF PROCESSING 1         0494 01502000
*                                      PROCESSABLE SYSMOD            */ 01503000
*   END;                            /* END OF LOOP WHILE           0495 01504000
*                                      BUILD=CONTINUE                */ 01505000
@RF00453 DS    0H                                                  0495 01506000
@DE00449 TM    BUILD,B'01000000'                                   0495 01507000
         BNO   @DC00449                                            0495 01508000
         L     @03,HIGHTMD                                         0495 01509000
         CH    @03,@CH00036                                        0495 01510000
         BL    @DL00449                                            0495 01511000
@DC00449 DS    0H                                                  0496 01512000
*   RETURN;                                                        0496 01513000
@EL00004 DS    0H                                                  0496 01514000
@EF00004 DS    0H                                                  0496 01515000
@ER00004 LM    @14,@12,@SA00004                                    0496 01516000
         BR    @14                                                 0496 01517000
*   END BLDICTM;                                                   0497 01518000
*                                                                  0498 01519000
*/********************************************************************/ 01520000
*/*                                                                  */ 01521000
*/*    BLDMODS  - BUILD ICT MOD SECTION ENTRIES FOR ALL ELEMENTS     */ 01522000
*/*               SUPPLIED IN THE "CURRENT" SYSMOD.                  */ 01523000
*/*                                                                  */ 01524000
*/*               - ACCESS THE "CURRENT" SYSMOD'S MCS ENTRY ON       */ 01525000
*/*                 THE PTS                                          */ 01526000
*/*                                                                  */ 01527000
*/*               - READ THRU THE MODIFICATION CONTROL STATEMENTS    */ 01528000
*/*                                                                  */ 01529000
*/*               - CALL BLDENTRY FOR EACH ELEMENT MCS ENCOUNTERED   */ 01530000
*/*                                                                  */ 01531000
*/*    CONDITIONS UPON ENTRY:                                        */ 01532000
*/*                                                                  */ 01533000
*/*     * BLDSYSMD - ICT PTF SECTION ENTRY REPRESENTING THE          */ 01534000
*/*                  "CURRENT" SYSMOD                                */ 01535000
*/*                                                                  */ 01536000
*/*    CONDITIONS UPON EXIT:                                         */ 01537000
*/*                                                                  */ 01538000
*/*     * BLDMODRC - PARAMETER RETURNED TO CALLER AS FOLLOWS:        */ 01539000
*/*                                                                  */ 01540000
*/*                  0 - MOD SECT ENTRIES FOR SYSMOD SUCCESSFULLY    */ 01541000
*/*                      BUILT                                       */ 01542000
*/*                                                                  */ 01543000
*/*                  8 - PTS SYSMOD ENTRY NOT FOUND                  */ 01544000
*/*                    - ERROR BUILDING MOD SECTION ENTRIES          */ 01545000
*/*                                                                  */ 01546000
*/*                  8 OR GREATER CODES FROM:                        */ 01547000
*/*                                                                  */ 01548000
*/*                      HMASMTAD - GET CORE FOR ENTRY               */ 01549000
*/*                      HMASMCRD - READ MODIFICATION CNTRL. STMT.   */ 01550000
*/*                      HMASMIO  - ACCESS PTS MCS ENTRY             */ 01551000
*/*                      HMASMMPD - PARSE MODIFICATION CNTRL. STMT.  */ 01552000
*/*                                                                  */ 01553000
*/********************************************************************/ 01554000
*                                                                  0498 01555000
*BLDMODS:                                                          0498 01556000
*   PROC(BLDSYSMD,BLDMODRC);                                       0498 01557000
BLDMODS  STM   @14,@12,@SA00005                                    0498 01558000
         MVC   @PC00005(8),0(@01)                                  0498 01559000
*   DCL                                                            0499 01560000
*     BLDSYSMD CHAR(*);             /* ICT PTF ENTRY REPRESENTING  0499 01561000
*                                      SYSMOD TO BE PROCESSED        */ 01562000
*   DCL                                                            0500 01563000
*     BLDMODRC FIXED(31);           /* MAX RETURN CODE PARAMETER     */ 01564000
*   DCL                                                            0501 01565000
*     BLDMODPC FIXED(31);           /* ELEMENT RETURN CODE VARIABLE  */ 01566000
*   DCL                                                            0502 01567000
*     JM FIXED(15);                 /* INDEX - MOD SECT ENTRIES      */ 01568000
*   DCL                                                            0503 01569000
*     MODADDR PTR(31);              /* ADDR OF ICT MOD SECT ENTRY    */ 01570000
*                                                                  0504 01571000
*   /*****************************************************************/ 01572000
*   /*                                                               */ 01573000
*   /* INITIALIZE FOR BUILDING MOD SECT ENTRIES - "CURRENT" SYSMOD   */ 01574000
*   /*                                                               */ 01575000
*   /*****************************************************************/ 01576000
*                                                                  0504 01577000
*   BLDMODRC=ZERO;                  /* INITIALIZE RETURN CODE        */ 01578000
         SLR   @03,@03                                             0504 01579000
         L     @15,@PC00005+4                                      0504 01580000
         ST    @03,BLDMODRC(,@15)                                  0504 01581000
*   BLDM2WRK=OFF;                   /* CLEAR DEFERRED WRK DATASET  0505 01582000
*                                      PROCESSING FLAG               */ 01583000
         NI    BLDM2WRK,B'11011111'                                0505 01584000
*   RESPECIFY                                                      0506 01585000
*     ICTPTF BASED(ADDR(BLDSYSMD)); /* PTF ENTRY PASSED              */ 01586000
*   RESPECIFY                                                      0507 01587000
*     HMASMIOP BASED(PTRIOP1);      /* IOP USED TO ACCESS PTS        */ 01588000
*   ICTPCHN(1)=0;                   /* CLEAR PTR TO LIST OF MOD SECT    01589000
*                                      ENTRIES BUILT FOR THIS SYSMOD */ 01590000
         L     @14,@PC00005                                        0508 01591000
         ST    @03,ICTPCHN(,@14)                                   0508 01592000
*   ICTPWRKO(1)=OFF;                /* SYSMOD HAS NOT OVERLAID WRK 0509 01593000
*                                      DATASET MEMBERS               */ 01594000
*                                                                  0509 01595000
         NI    ICTPWRKO(@14),B'10111111'                           0509 01596000
*   /*****************************************************************/ 01597000
*   /*                                                               */ 01598000
*   /* LOCATE SYSMOD MCS ENTRY ON THE PTS AND READ FIRST RECORD      */ 01599000
*   /*                                                               */ 01600000
*   /*****************************************************************/ 01601000
*                                                                  0510 01602000
*   CALL LOCMCS(ICTPTFS(1),BLDMODRC);/* LOCATE MCS ENTRY             */ 01603000
         ST    @14,@AL00001                                        0510 01604000
         ST    @15,@AL00001+4                                      0510 01605000
         LA    @01,@AL00001                                        0510 01606000
         BAL   @14,LOCMCS                                          0510 01607000
*   IF BLDMODRC=ZERO THEN                                          0511 01608000
         L     @15,@PC00005+4                                      0511 01609000
         ICM   @14,15,BLDMODRC(@15)                                0511 01610000
         BNZ   @RF00511                                            0511 01611000
*     DO;                                                          0512 01612000
*       CALL HMASMCRD(HMASMCRP);    /* READ FIRST RECORD             */ 01613000
         L     @15,@CV01885                                        0513 01614000
         LA    @01,@AL00513                                        0513 01615000
         BALR  @14,@15                                             0513 01616000
*       IF CRPRETRN=CRPEOF          /* END-OF-FILE ENCOUNTERED       */ 01617000
*         THEN                                                     0514 01618000
         CLI   CRPRETRN,4                                          0514 01619000
         BNE   @RF00514                                            0514 01620000
*         MCSEOF=ON;                /* SET END-OF-FILE FLAG          */ 01621000
         OI    MCSEOF,B'00010000'                                  0515 01622000
*       ELSE                                                       0516 01623000
*         BLDMODRC=CRPRETRN;        /* SAVE RETURN CODE              */ 01624000
         B     @RC00514                                            0516 01625000
@RF00514 L     @15,@PC00005+4                                      0516 01626000
         SLR   @14,@14                                             0516 01627000
         IC    @14,CRPRETRN                                        0516 01628000
         ST    @14,BLDMODRC(,@15)                                  0516 01629000
*     END;                                                         0517 01630000
@RC00514 DS    0H                                                  0518 01631000
*                                                                  0518 01632000
*   /*****************************************************************/ 01633000
*   /*                                                               */ 01634000
*   /* GO THRU ALL RECORDS IN PTS MCS MEMBER FOR THE SYSMOD          */ 01635000
*   /*                                                               */ 01636000
*   /*****************************************************************/ 01637000
*                                                                  0518 01638000
*   DO WHILE BLDMODRC<STOPPTF       /* SYSMOD NOT TERMINATED         */ 01639000
*         &MCSEOF=OFF;              /* NOT AT END OF MCS MEMBER      */ 01640000
*                                                                  0518 01641000
@RF00511 B     @DE00518                                            0518 01642000
@DL00518 DS    0H                                                  0519 01643000
*     /***************************************************************/ 01644000
*     /*                                                             */ 01645000
*     /* PROCESS MODIFICATION CONTROL STATEMENT IN CRPBUFFR          */ 01646000
*     /*                                                             */ 01647000
*     /***************************************************************/ 01648000
*                                                                  0519 01649000
*     BLDMODPC=0;                   /* CLEAR ELEMENT RETURN CODE     */ 01650000
         SLR   @15,@15                                             0519 01651000
         ST    @15,BLDMODPC                                        0519 01652000
*     MPPSMDNM=ICTPTFS(1);          /* PASS SYSMOD NUMBER            */ 01653000
         L     @15,@PC00005                                        0520 01654000
         MVC   MPPSMDNM(7),ICTPTFS(@15)                            0520 01655000
*     CALL HMASMMPD(MPPPARM);       /* PARSE STATEMENT               */ 01656000
         L     @15,@CV01887                                        0521 01657000
         LA    @01,@AL00521                                        0521 01658000
         BALR  @14,@15                                             0521 01659000
*     RESPECIFY                                                    0522 01660000
*       REG15 RSTD;                                                0522 01661000
*     BLDMODPC=MAX(BLDMODPC,REG15); /* SAVE PARSE RETURN CODE        */ 01662000
         L     @14,BLDMODPC                                        0523 01663000
         CR    @14,REG15                                           0523 01664000
         BNL   *+6                                                      01665000
         LR    @14,REG15                                           0523 01666000
         ST    @14,BLDMODPC                                        0523 01667000
*     RESPECIFY                                                    0524 01668000
*       REG15 UNRSTD;                                              0524 01669000
*     IF BLDMODPC>=STOPPTF          /* TERMINATING PARSE ERROR       */ 01670000
*       THEN                                                       0525 01671000
         CH    @14,@CH00033                                        0525 01672000
         BL    @RF00525                                            0525 01673000
*       DO;                                                        0526 01674000
*         MGPTYPE=MGPERR;           /* STOP-SYSMOD ERROR             */ 01675000
         MVI   MGPTYPE,X'03'                                       0527 01676000
*         CALL ERRMSG(HMA355I,NOPART);/* ISSUE HMA355I               */ 01677000
         LA    @01,@AL00528                                        0528 01678000
         BAL   @14,ERRMSG                                          0528 01679000
*       END;                                                       0529 01680000
*     IF BLDMODPC<STOPPTF THEN                                     0530 01681000
@RF00525 L     @15,BLDMODPC                                        0530 01682000
         CH    @15,@CH00033                                        0530 01683000
         BNL   @RF00530                                            0530 01684000
*       DO;                                                        0531 01685000
*                                                                  0531 01686000
*         /***********************************************************/ 01687000
*         /*                                                         */ 01688000
*         /* A MODIFICATION CNTRL STMT HAS BEEN SUCCESSFULLY READ AND*/ 01689000
*         /* PARSED                                                  */ 01690000
*         /*                                                         */ 01691000
*         /***********************************************************/ 01692000
*                                                                  0532 01693000
*         IF MCBTYPE=MCBMODTP       /* ++MOD ELEMENT ?               */ 01694000
*             |MCBTYPE=MCBMCRTP     /* ++MAC ELEMENT ?               */ 01695000
*             |MCBTYPE=MCBSCRTP     /* ++SRC ELEMENT ?               */ 01696000
*             |MCBTYPE=MCBSCUTP     /* ++SRCUPD ELEMENT ?            */ 01697000
*             |MCBTYPE=MCBMCUTP     /* ++MACUPD ELEMENT ?            */ 01698000
*             |MCBTYPE=MCBZAPTP     /* ++ZAP ELEMENT ?               */ 01699000
*           THEN                                                   0532 01700000
         L     @15,MCBPTR                                          0532 01701000
         CLI   MCBTYPE(@15),4                                      0532 01702000
         BE    @RT00532                                            0532 01703000
         CLI   MCBTYPE(@15),5                                      0532 01704000
         BE    @RT00532                                            0532 01705000
         CLI   MCBTYPE(@15),6                                      0532 01706000
         BE    @RT00532                                            0532 01707000
         CLI   MCBTYPE(@15),9                                      0532 01708000
         BE    @RT00532                                            0532 01709000
         CLI   MCBTYPE(@15),8                                      0532 01710000
         BE    @RT00532                                            0532 01711000
         CLI   MCBTYPE(@15),7                                      0532 01712000
         BNE   @RF00532                                            0532 01713000
@RT00532 DS    0H                                                  0533 01714000
*           CALL BLDENTRY(BLDSYSMD,BLDMODPC);/* BUILD ENTRY AND    0533 01715000
*                                      POSITION THE INPUT TO THE NEXT   01716000
*                                      MODIFICATION CONTROL STATEMENT   01717000
*                                      (OR EOF)                      */ 01718000
         L     @15,@PC00005                                        0533 01719000
         ST    @15,@AL00001                                        0533 01720000
         LA    @15,BLDMODPC                                        0533 01721000
         ST    @15,@AL00001+4                                      0533 01722000
         LA    @01,@AL00001                                        0533 01723000
         BAL   @14,BLDENTRY                                        0533 01724000
*         ELSE                                                     0534 01725000
*           CALL SKIPELEM(BLDMODPC);/* SKIP OVER NON-ELEM STMT.      */ 01726000
         B     @RC00532                                            0534 01727000
@RF00532 LA    @01,@AL00534                                        0534 01728000
         BAL   @14,SKIPELEM                                        0534 01729000
*       END;                        /* END OF PROCESSING 1 ELEMENT   */ 01730000
@RC00532 DS    0H                                                  0536 01731000
*     BLDMODRC=MAX(BLDMODRC,BLDMODPC);/* MAINTAIN HIGH RET. CODE     */ 01732000
@RF00530 L     @15,@PC00005+4                                      0536 01733000
         L     @14,BLDMODRC(,@15)                                  0536 01734000
         L     @07,BLDMODPC                                        0536 01735000
         CR    @14,@07                                             0536 01736000
         BNL   *+6                                                      01737000
         LR    @14,@07                                             0536 01738000
         ST    @14,BLDMODRC(,@15)                                  0536 01739000
*   END;                            /* END OF PROCESSING RECORDS IN     01740000
*                                      MCS MEMBER                    */ 01741000
@DE00518 L     @15,@PC00005+4                                      0537 01742000
         L     @15,BLDMODRC(,@15)                                  0537 01743000
         CH    @15,@CH00033                                        0537 01744000
         BNL   @DC00518                                            0537 01745000
         TM    MCSEOF,B'00010000'                                  0537 01746000
         BZ    @DL00518                                            0537 01747000
@DC00518 DS    0H                                                  0538 01748000
*                                                                  0538 01749000
*   /*****************************************************************/ 01750000
*   /*                                                               */ 01751000
*   /* FINISHED PROCESSING PTS MCS MEMBER ... BUILD CHAIN OF ELEMENTS*/ 01752000
*   /* FOR THE "CURRENT" SYSMOD                                      */ 01753000
*   /*                                                               */ 01754000
*   /*****************************************************************/ 01755000
*                                                                  0538 01756000
*   RESPECIFY                                                      0538 01757000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 01758000
*                                                                  0538 01759000
*   /*****************************************************************/ 01760000
*   /*                                                               */ 01761000
*   /* GO THRU ICT MOD SECTION                                       */ 01762000
*   /*                                                               */ 01763000
*   /*****************************************************************/ 01764000
*                                                                  0539 01765000
*   DO JM=1 BY 1 WHILE ICTMEND(JM)^=ICTENDNT/* NOT AT MOD SECT END   */ 01766000
*         &BLDMODRC<STOPFUNC;       /* NOT TERMINATING               */ 01767000
         LA    JM,1                                                0539 01768000
         B     @DE00539                                            0539 01769000
@DL00539 DS    0H                                                  0540 01770000
*     IF ICTPPTR(JM)=ADDR(ICTPTF(1))/* ELEMENT FROM "CURRENT" SYSMOD */ 01771000
*       THEN                                                       0540 01772000
         LR    @03,JM                                              0540 01773000
         MH    @03,@CH02383                                        0540 01774000
         L     @15,CCAICMOD(,CCAPTR)                               0540 01775000
         L     @14,@PC00005                                        0540 01776000
         LA    @01,0(@03,@15)                                      0540 01777000
         AL    @01,@CF02433                                        0540 01778000
         C     @14,ICTPPTR-96(,@01)                                0540 01779000
         BNE   @RF00540                                            0540 01780000
*       DO;                                                        0541 01781000
*                                                                  0541 01782000
*         /***********************************************************/ 01783000
*         /*                                                         */ 01784000
*         /* PUT ADDRESS OF MOD SECT ENTRY INTO PTF SECTION ENTRY    */ 01785000
*         /* LIST (ICTIXP)                                           */ 01786000
*         /*                                                         */ 01787000
*         /***********************************************************/ 01788000
*                                                                  0542 01789000
*         MODADDR=ADDR(ICTMOD(JM)); /* ICT MOD SECT ENTRY ADDRESS    */ 01790000
         AL    @15,@CF02422                                        0542 01791000
         LA    @03,ICTMOD(@03,@15)                                 0542 01792000
         ST    @03,MODADDR                                         0542 01793000
*         CALL HMASMTAI(TBLXPARM,   /*                               */ 01794000
*             ICTPCHN(1),           /* MOD SECT POINTER LIST         */ 01795000
*             ADDR(MODADDR),        /* ADDR OF MOD SECT ENTRY ADDR   */ 01796000
*             LENGTH(ICTIXP));      /* LENGTH OF ENTRY IN LIST       */ 01797000
         L     @03,@PC00001                                        0543 01798000
         ST    @03,@AL00001                                        0543 01799000
         LA    @03,ICTPCHN(,@14)                                   0543 01800000
         ST    @03,@AL00001+4                                      0543 01801000
         LA    @03,MODADDR                                         0543 01802000
         ST    @03,@TF00001                                        0543 01803000
         LA    @03,@TF00001                                        0543 01804000
         ST    @03,@AL00001+8                                      0543 01805000
         LA    @03,@CF00040                                        0543 01806000
         ST    @03,@AL00001+12                                     0543 01807000
         L     @15,@CV01892                                        0543 01808000
         LA    @01,@AL00001                                        0543 01809000
         BALR  @14,@15                                             0543 01810000
*         RESPECIFY                                                0544 01811000
*           REG15 RSTD;                                            0544 01812000
*         BLDMODRC=MAX(BLDMODRC,REG15);/* SAVE RETURN CODE FROM TAI  */ 01813000
         L     @14,@PC00005+4                                      0545 01814000
         L     @03,BLDMODRC(,@14)                                  0545 01815000
         CR    @03,REG15                                           0545 01816000
         BNL   *+6                                                      01817000
         LR    @03,REG15                                           0545 01818000
         ST    @03,BLDMODRC(,@14)                                  0545 01819000
*         RESPECIFY                                                0546 01820000
*           REG15 UNRSTD;                                          0546 01821000
*       END;                                                       0547 01822000
*   END;                                                           0548 01823000
@RF00540 AL    JM,@CF00065                                         0548 01824000
@DE00539 LR    @03,JM                                              0548 01825000
         MH    @03,@CH02383                                        0548 01826000
         L     @01,CCAICMOD(,CCAPTR)                               0548 01827000
         AL    @01,@CF02422                                        0548 01828000
         L     @03,ICTMEND(@03,@01)                                0548 01829000
         CL    @03,ICTENDNT                                        0548 01830000
         BE    @DC00539                                            0548 01831000
         L     @03,@PC00005+4                                      0548 01832000
         L     @03,BLDMODRC(,@03)                                  0548 01833000
         CH    @03,@CH00036                                        0548 01834000
         BL    @DL00539                                            0548 01835000
@DC00539 DS    0H                                                  0549 01836000
*   IF ICTPCHN(1)=0                 /* NO MOD SECT ENTRIES BUILT     */ 01837000
*     THEN                                                         0549 01838000
         L     @15,@PC00005                                        0549 01839000
         ICM   @14,15,ICTPCHN(@15)                                 0549 01840000
         BNZ   @RF00549                                            0549 01841000
*     ICTPCHN(1)=TBLXNULL;          /* POINT TO EMPTY LIST           */ 01842000
         L     @14,@PC00001                                        0550 01843000
         MVC   ICTPCHN(4,@15),TBLXNULL(@14)                        0550 01844000
*   IF BLDMODRC>=STOPPTF THEN                                      0551 01845000
*                                                                  0551 01846000
@RF00549 L     @15,@PC00005+4                                      0551 01847000
         L     @14,BLDMODRC(,@15)                                  0551 01848000
         CH    @14,@CH00033                                        0551 01849000
         BL    @RF00551                                            0551 01850000
*     /***************************************************************/ 01851000
*     /*                                                             */ 01852000
*     /* ERRORS DURING MOD SECTION BUILD ... CLEANUP WRK DATASETS    */ 01853000
*     /*                                                             */ 01854000
*     /***************************************************************/ 01855000
*                                                                  0552 01856000
*     CALL BLDMODSF(BLDSYSMD,BLDMODRC);                            0552 01857000
         L     @14,@PC00005                                        0552 01858000
         ST    @14,@AL00001                                        0552 01859000
         ST    @15,@AL00001+4                                      0552 01860000
         LA    @01,@AL00001                                        0552 01861000
         BAL   @14,BLDMODSF                                        0552 01862000
*   RETURN;                                                        0553 01863000
@EL00005 DS    0H                                                  0553 01864000
@EF00005 DS    0H                                                  0553 01865000
@ER00005 LM    @14,@12,@SA00005                                    0553 01866000
         BR    @14                                                 0553 01867000
*   END BLDMODS;                                                   0554 01868000
         B     @EL00005                                            0554 01869000
*                                                                  0555 01870000
*/********************************************************************/ 01871000
*/*                                                                  */ 01872000
*/*    BLDMODS2 - FINISH UP PROCESSING OF A SYSMOD AFTER ALL         */ 01873000
*/*               ELEMENTS HAVE BEEN SELECTED AND THERE REMAIN       */ 01874000
*/*               IN-LINE ELEMENTS TO BE MOVED TO THE WRK DATASETS   */ 01875000
*/*                                                                  */ 01876000
*/*    CONDITIONS UPON ENTRY:                                        */ 01877000
*/*                                                                  */ 01878000
*/*     *          - ALL ELEMENTS FROM THE "CURRENT" SYSMOD HAVE     */ 01879000
*/*                  BEEN SUCCESSFULLY SELECTED OR EXCLUDED (I.E.,   */ 01880000
*/*                  THE SYSMOD IS NOT NOGO DUE TO ID CHECK ERRORS). */ 01881000
*/*                                                                  */ 01882000
*/*     *          - THERE ARE MOD SECTION ENTRIES IN THE ICT FOR    */ 01883000
*/*                  EVERY ELEMENT IN THE "CURRENT" SYSMOD ... THE   */ 01884000
*/*                  SELECTED ELEMENTS FROM THE "CURRENT" SYSMOD     */ 01885000
*/*                  HAVE "ICTMISEL" SET "ON" IN THEIR RESPECTIVE    */ 01886000
*/*                  MOD SECTION ENTRIES.                            */ 01887000
*/*                                                                  */ 01888000
*/*                                                                  */ 01889000
*/*                                                                  */ 01890000
*/*                                                                  */ 01891000
*/********************************************************************/ 01892000
*                                                                  0555 01893000
*BLDMODS2:                                                         0555 01894000
*   PROC(BLDM2SMD,BLDMD2RC);                                       0555 01895000
BLDMODS2 STM   @14,@12,@SA00006                                    0555 01896000
         MVC   @PC00006(8),0(@01)                                  0555 01897000
*   DCL                                                            0556 01898000
*     BLDM2SMD CHAR(*);             /* ICT PTF ENTRY                 */ 01899000
*   DCL                                                            0557 01900000
*     BLDMD2RC FIXED(31);           /* MAX RETURN CODE COLLECTOR   0557 01901000
*                                      PARAMETER                     */ 01902000
*   DCL                                                            0558 01903000
*     BLDMD2PC FIXED(31);           /* ELEMENT RETURN CODE VARIABLE  */ 01904000
*   DCL                                                            0559 01905000
*     MODSCPTR PTR(31);             /* LOCAL POINTER ... USED TO   0559 01906000
*                                      ADDRESS MOD SECT ENTRIES    0559 01907000
*                                      ASSOCIATED WITH "CURRENT"   0559 01908000
*                                      SYSMOD                        */ 01909000
*   RESPECIFY                                                      0560 01910000
*     ICTPTF BASED(ADDR(BLDM2SMD)); /* PTF SECTION ENTRY PASSED ...     01911000
*                                      "CURRENT" SYSMOD              */ 01912000
*   RESPECIFY                                                      0561 01913000
*     HMASMIOP BASED(PTRIOP1);      /* IOP BEING USED TO ACCESS PTS  */ 01914000
*                                                                  0561 01915000
*   /*****************************************************************/ 01916000
*   /*                                                               */ 01917000
*   /* RE-ACCESS THE PTS MCS MEMBER                                  */ 01918000
*   /*                                                               */ 01919000
*   /*****************************************************************/ 01920000
*                                                                  0562 01921000
*   CALL LOCMCS(ICTPTFS(1),BLDMD2RC);/* RE-LOCATE PTS MCS MEMBER FOR    01922000
*                                      CURRENT SYSMOD                */ 01923000
         L     @03,@PC00006                                        0562 01924000
         ST    @03,@AL00001                                        0562 01925000
         L     @03,@PC00006+4                                      0562 01926000
         ST    @03,@AL00001+4                                      0562 01927000
         LA    @01,@AL00001                                        0562 01928000
         BAL   @14,LOCMCS                                          0562 01929000
*   IF BLDMD2RC<STOPPTF THEN                                       0563 01930000
         L     @15,@PC00006+4                                      0563 01931000
         L     @15,BLDMD2RC(,@15)                                  0563 01932000
         CH    @15,@CH00033                                        0563 01933000
         BNL   @RF00563                                            0563 01934000
*     DO;                                                          0564 01935000
*       CALL HMASMCRD(HMASMCRP);    /* READ FIRST RECORD             */ 01936000
         L     @15,@CV01885                                        0565 01937000
         LA    @01,@AL00565                                        0565 01938000
         BALR  @14,@15                                             0565 01939000
*       IF CRPRETRN=CRPEOF          /* END-OF-FILE ON MCS MEMBER     */ 01940000
*         THEN                                                     0566 01941000
         CLI   CRPRETRN,4                                          0566 01942000
         BNE   @RF00566                                            0566 01943000
*         MCSEOF=ON;                /* SET END-OF-FILE FLAG          */ 01944000
         OI    MCSEOF,B'00010000'                                  0567 01945000
*       ELSE                                                       0568 01946000
*         BLDMD2RC=MAX(BLDMD2RC,CRPRETRN);/* SAVE RETURN CODE        */ 01947000
*                                                                  0568 01948000
         B     @RC00566                                            0568 01949000
@RF00566 L     @15,@PC00006+4                                      0568 01950000
         L     @14,BLDMD2RC(,@15)                                  0568 01951000
         SLR   @07,@07                                             0568 01952000
         IC    @07,CRPRETRN                                        0568 01953000
         CR    @14,@07                                             0568 01954000
         BNL   *+6                                                      01955000
         LR    @14,@07                                             0568 01956000
         ST    @14,BLDMD2RC(,@15)                                  0568 01957000
*       /*************************************************************/ 01958000
*       /*                                                           */ 01959000
*       /* PROCESS ALL RECORDS IN MCS MEMBER                         */ 01960000
*       /*                                                           */ 01961000
*       /*************************************************************/ 01962000
*                                                                  0569 01963000
*       DO WHILE BLDMD2RC<STOPPTF   /* SYSMOD NOT TERMINATED         */ 01964000
*             &MCSEOF=OFF;          /* NOT AT END-OF-FILE ON MCS     */ 01965000
*                                                                  0569 01966000
@RC00566 B     @DE00569                                            0569 01967000
@DL00569 DS    0H                                                  0570 01968000
*         /***********************************************************/ 01969000
*         /*                                                         */ 01970000
*         /* PROCESS MODIFICATION CNTRL STMT IN CRPBUFFR             */ 01971000
*         /*                                                         */ 01972000
*         /***********************************************************/ 01973000
*                                                                  0570 01974000
*         BLDMD2PC=0;               /* CLEAR ELEMENT RETURN CODE     */ 01975000
         SLR   @15,@15                                             0570 01976000
         ST    @15,BLDMD2PC                                        0570 01977000
*         MPPSMDNM=ICTPTFS(1);      /* PASS SYSMOD NUMBER            */ 01978000
         L     @15,@PC00006                                        0571 01979000
         MVC   MPPSMDNM(7),ICTPTFS(@15)                            0571 01980000
*         CALL HMASMMPD(MPPPARM);   /* PARSE STMT                    */ 01981000
         L     @15,@CV01887                                        0572 01982000
         LA    @01,@AL00572                                        0572 01983000
         BALR  @14,@15                                             0572 01984000
*         RESPECIFY                                                0573 01985000
*           REG15 RSTD;                                            0573 01986000
*         BLDMD2PC=MAX(BLDMD2PC,REG15);                            0574 01987000
         L     @14,BLDMD2PC                                        0574 01988000
         CR    @14,REG15                                           0574 01989000
         BNL   *+6                                                      01990000
         LR    @14,REG15                                           0574 01991000
         ST    @14,BLDMD2PC                                        0574 01992000
*         RESPECIFY                                                0575 01993000
*           REG15 UNRSTD;                                          0575 01994000
*         IF BLDMD2PC<STOPPTF THEN                                 0576 01995000
         CH    @14,@CH00033                                        0576 01996000
         BNL   @RF00576                                            0576 01997000
*           DO;                                                    0577 01998000
*                                                                  0577 01999000
*             /*******************************************************/ 02000000
*             /*                                                     */ 02001000
*             /* A MODIFICATION CNTRL STMT READ AND PARSED           */ 02002000
*             /*                                                     */ 02003000
*             /*******************************************************/ 02004000
*                                                                  0578 02005000
*             IF MCBTYPE=MCBMODTP   /* ++MOD ELEMENT ?               */ 02006000
*                 |MCBTYPE=MCBMCRTP /* ++MAC ELEMENT ?               */ 02007000
*                 |MCBTYPE=MCBSCRTP /* ++SRC ELEMENT ?               */ 02008000
*                 |MCBTYPE=MCBZAPTP /* ++ZAP ELEMENT ?               */ 02009000
*                 |MCBTYPE=MCBMCUTP /* ++MACUPD ELEMENT ?            */ 02010000
*                 |MCBTYPE=MCBSCUTP /* ++SRCUPD ELEMENT ?            */ 02011000
*               THEN                                               0578 02012000
         L     @15,MCBPTR                                          0578 02013000
         CLI   MCBTYPE(@15),4                                      0578 02014000
         BE    @RT00578                                            0578 02015000
         CLI   MCBTYPE(@15),5                                      0578 02016000
         BE    @RT00578                                            0578 02017000
         CLI   MCBTYPE(@15),6                                      0578 02018000
         BE    @RT00578                                            0578 02019000
         CLI   MCBTYPE(@15),7                                      0578 02020000
         BE    @RT00578                                            0578 02021000
         CLI   MCBTYPE(@15),8                                      0578 02022000
         BE    @RT00578                                            0578 02023000
         CLI   MCBTYPE(@15),9                                      0578 02024000
         BNE   @RF00578                                            0578 02025000
@RT00578 DS    0H                                                  0579 02026000
*               DO;                                                0579 02027000
*                                                                  0579 02028000
*                 /***************************************************/ 02029000
*                 /*                                                 */ 02030000
*                 /* ELEMENT TYPE MODIFICATION CNTRL STMT ... SEARCH */ 02031000
*                 /* THE ICT FOR THIS ELEMENT FROM THE CURRENT SYSMOD*/ 02032000
*                 /*                                                 */ 02033000
*                 /***************************************************/ 02034000
*                                                                  0580 02035000
*                 CALL SRCHICTM(MCBENAME,/* ELEMENT NAME             */ 02036000
*                     MCBTYPE,      /* ELEMENT TYPE                  */ 02037000
*                     ICTPTFS(1),   /* CURRENT SYSMOD                */ 02038000
*                     MODSCPTR);    /* MOD SECT PTR                  */ 02039000
         L     @15,MCBPTR                                          0580 02040000
         LA    @14,MCBENAME(,@15)                                  0580 02041000
         ST    @14,@AL00001                                        0580 02042000
         ST    @15,@AL00001+4                                      0580 02043000
         L     @15,@PC00006                                        0580 02044000
         ST    @15,@AL00001+8                                      0580 02045000
         LA    @15,MODSCPTR                                        0580 02046000
         ST    @15,@AL00001+12                                     0580 02047000
         LA    @01,@AL00001                                        0580 02048000
         BAL   @14,SRCHICTM                                        0580 02049000
*                 RESPECIFY                                        0581 02050000
*                   ICTMOD BASED(MODSCPTR);/* MOD ENTRY              */ 02051000
*                 IF ICTMISEL(1)=ON /* SELECTED                      */ 02052000
*                     &ICTMIDEL(1)=OFF/* DELETE NOT SPECIFIED        */ 02053000
*                     &ICTMWRK(1)=OFF/* NOT MOVED TO WRK             */ 02054000
*                     &ICTMRELF(1)=OFF/* NOT RELFILE                 */ 02055000
*                     &ICTLIBLK(1)=OFF/* NOT LKLIB                   */ 02056000
*                     &ICTLIBTX(1)=OFF/* NOT TXLIB                   */ 02057000
*                   THEN                                           0582 02058000
         L     @15,MODSCPTR                                        0582 02059000
         TM    ICTMISEL(@15),B'10000000'                           0582 02060000
         BNO   @RF00582                                            0582 02061000
         TM    ICTMIDEL(@15),B'01000000'                           0582 02062000
         BNZ   @RF00582                                            0582 02063000
         TM    ICTMWRK(@15),B'11101000'                            0582 02064000
         BNZ   @RF00582                                            0582 02065000
*                   DO;                                            0583 02066000
*                                                                  0583 02067000
*                     /***********************************************/ 02068000
*                     /*                                             */ 02069000
*                     /* ELEMENT SHOULD BE MOVED TO WRK DATASET      */ 02070000
*                     /*                                             */ 02071000
*                     /***********************************************/ 02072000
*                                                                  0584 02073000
*                     IF MCBTYPE=MCBMCUTP/* ++MACUPD ELEMENT         */ 02074000
*                         |MCBTYPE=MCBSCUTP/* ++SRCUPD ELEMENT       */ 02075000
*                       THEN                                       0584 02076000
         L     @15,MCBPTR                                          0584 02077000
         CLI   MCBTYPE(@15),8                                      0584 02078000
         BE    @RT00584                                            0584 02079000
         CLI   MCBTYPE(@15),9                                      0584 02080000
         BNE   @RF00584                                            0584 02081000
@RT00584 DS    0H                                                  0585 02082000
*                       TMWMODE=MERGE;/* MERGE WITH EXISTING         */ 02083000
         MVI   TMWMODE,C'M'                                        0585 02084000
*                     ELSE                                         0586 02085000
*                       TMWMODE=CREATE;/* CREATE NEW MEMBER          */ 02086000
         B     @RC00584                                            0586 02087000
@RF00584 MVI   TMWMODE,C'C'                                        0586 02088000
*                     ICTMWRK(1)=ON;/* SET MOVED TO WRK FLAG         */ 02089000
@RC00584 L     @01,MODSCPTR                                        0587 02090000
         OI    ICTMWRK(@01),B'00001000'                            0587 02091000
*                     CALL HMASMTMW(TMWOPT,/* WRITE TO WRK           */ 02092000
*                         MODSCPTR, /* PTR ICT MOD                   */ 02093000
*                         HMASMCRP, /* GET PARM LIST                 */ 02094000
*                         TMWMODE); /* CREATE|MERGE                  */ 02095000
         L     @15,@CV01895                                        0588 02096000
         LA    @01,@AL00588                                        0588 02097000
         BALR  @14,@15                                             0588 02098000
*                     RESPECIFY                                    0589 02099000
*                       REG15 RSTD;                                0589 02100000
*                     IF REG15=IOPEOF/* END-OF-FILE ENCOUNTERED      */ 02101000
*                       THEN                                       0590 02102000
         CH    REG15,@CH00040                                      0590 02103000
         BNE   @RF00590                                            0590 02104000
*                       MCSEOF=ON;  /* SET END-OF-FILE FLAG          */ 02105000
         OI    MCSEOF,B'00010000'                                  0591 02106000
*                     ELSE                                         0592 02107000
*                       BLDMD2PC=MAX(BLDMD2PC,REG15);/* MAINTAIN     */ 02108000
         B     @RC00590                                            0592 02109000
@RF00590 L     @14,BLDMD2PC                                        0592 02110000
         CR    @14,REG15                                           0592 02111000
         BNL   *+6                                                      02112000
         LR    @14,REG15                                           0592 02113000
         ST    @14,BLDMD2PC                                        0592 02114000
*                     IF REG15<STOPPTF THEN                        0593 02115000
@RC00590 CH    REG15,@CH00033                                      0593 02116000
         BNL   @RF00593                                            0593 02117000
*                       ICTPWRKO(1)=ON;/* WRK MEMBER OVERLAID        */ 02118000
         L     @14,@PC00006                                        0594 02119000
         OI    ICTPWRKO(@14),B'01000000'                           0594 02120000
*                     RESPECIFY                                    0595 02121000
*                       REG15 UNRSTD;                              0595 02122000
@RF00593 DS    0H                                                  0596 02123000
*                     IF ICTMXPND(1)=ON/* EXPANDS ENCOUNTERED        */ 02124000
*                         &BLDMD2RC<STOPPTF THEN                   0596 02125000
*                                                                  0596 02126000
         L     @01,MODSCPTR                                        0596 02127000
         TM    ICTMXPND(@01),B'00010000'                           0596 02128000
         BNO   @RF00596                                            0596 02129000
         L     @15,@PC00006+4                                      0596 02130000
         L     @15,BLDMD2RC(,@15)                                  0596 02131000
         CH    @15,@CH00033                                        0596 02132000
         BNL   @RF00596                                            0596 02133000
*                       /*********************************************/ 02134000
*                       /*                                           */ 02135000
*                       /* BUILD MOD SECT ENTRY FOR EXPAND           */ 02136000
*                       /*                                           */ 02137000
*                       /*********************************************/ 02138000
*                                                                  0597 02139000
*                       CALL XPNDZAP(MODSCPTR,/* PTR MOD ENTRY       */ 02140000
*                           ADDR(ICTPTF(1)),/* PTF ENT.              */ 02141000
*                           BLDMD2PC);/* RETURN CODE                 */ 02142000
         L     @15,@PC00006                                        0597 02143000
         ST    @15,@AFTEMPS                                        0597 02144000
         LA    @01,@AL00597                                        0597 02145000
         BAL   @14,XPNDZAP                                         0597 02146000
*                   END;            /* END PROCESSING ELEMENT MOVET     02147000
*                                      TO WRKX                       */ 02148000
*                 ELSE                                             0599 02149000
*                                                                  0599 02150000
*                   /*************************************************/ 02151000
*                   /*                                               */ 02152000
*                   /* ELEMENT NEED NOT BE MOVED TO WRK DATASET      */ 02153000
*                   /*                                               */ 02154000
*                   /*************************************************/ 02155000
*                                                                  0599 02156000
*                   CALL SKIPELEM(BLDMD2PC);/* SKIP OVER IT          */ 02157000
         B     @RC00582                                            0599 02158000
@RF00582 LA    @01,@AL00599                                        0599 02159000
         BAL   @14,SKIPELEM                                        0599 02160000
*               END;                /* END PROCESSING ELEMENT MCS  0600 02161000
*                                      STMT                          */ 02162000
*             ELSE                                                 0601 02163000
*                                                                  0601 02164000
*               /*****************************************************/ 02165000
*               /*                                                   */ 02166000
*               /* NON-ELEMENT TYPE MODIFICATION CNTRL STMT          */ 02167000
*               /*                                                   */ 02168000
*               /*****************************************************/ 02169000
*                                                                  0601 02170000
*               CALL SKIPELEM(BLDMD2PC);/* SKIP OVER IT              */ 02171000
         B     @RC00578                                            0601 02172000
@RF00578 LA    @01,@AL00601                                        0601 02173000
         BAL   @14,SKIPELEM                                        0601 02174000
*           END;                    /* END PROCESSING A PARSED MCS 0602 02175000
*                                      STMT.                         */ 02176000
@RC00578 DS    0H                                                  0603 02177000
*         BLDMD2RC=MAX(BLDMD2RC,BLDMD2PC);/* MAINTAIN RET. CODE      */ 02178000
@RF00576 L     @15,@PC00006+4                                      0603 02179000
         L     @14,BLDMD2RC(,@15)                                  0603 02180000
         L     @07,BLDMD2PC                                        0603 02181000
         CR    @14,@07                                             0603 02182000
         BNL   *+6                                                      02183000
         LR    @14,@07                                             0603 02184000
         ST    @14,BLDMD2RC(,@15)                                  0603 02185000
*       END;                        /* END OF MCS PROCESSING LOOP    */ 02186000
@DE00569 L     @15,@PC00006+4                                      0604 02187000
         L     @15,BLDMD2RC(,@15)                                  0604 02188000
         CH    @15,@CH00033                                        0604 02189000
         BNL   @DC00569                                            0604 02190000
         TM    MCSEOF,B'00010000'                                  0604 02191000
         BZ    @DL00569                                            0604 02192000
@DC00569 DS    0H                                                  0605 02193000
*     END;                          /* END OF PROCESSING AFTER     0605 02194000
*                                      SUCCESSFUL LOCATE FOR MCS     */ 02195000
*   IF BLDMD2RC>=STOPPTF            /* SYSMOD TERMINATED             */ 02196000
*     THEN                                                         0606 02197000
@RF00563 L     @15,@PC00006+4                                      0606 02198000
         L     @14,BLDMD2RC(,@15)                                  0606 02199000
         CH    @14,@CH00033                                        0606 02200000
         BL    @RF00606                                            0606 02201000
*     CALL BLDMODSF(ICTPTF(1),      /* "CURRENT" SYSMOD              */ 02202000
*         BLDMD2RC);                /* RETURN CODE COLLECTOR         */ 02203000
         L     @14,@PC00006                                        0607 02204000
         ST    @14,@AL00001                                        0607 02205000
         ST    @15,@AL00001+4                                      0607 02206000
         LA    @01,@AL00001                                        0607 02207000
         BAL   @14,BLDMODSF                                        0607 02208000
*   RETURN;                                                        0608 02209000
@EL00006 DS    0H                                                  0608 02210000
@EF00006 DS    0H                                                  0608 02211000
@ER00006 LM    @14,@12,@SA00006                                    0608 02212000
         BR    @14                                                 0608 02213000
*   END BLDMODS2;                                                  0609 02214000
         B     @EL00006                                            0609 02215000
*                                                                  0610 02216000
*/********************************************************************/ 02217000
*/*                                                                  */ 02218000
*/*    BLDMODS3 - SET THE PRE/SUP FLAGS (ICTMIDPS) IN THE MODID      */ 02219000
*/*               LISTS ASSOCIATED WITH ELEMENTS SELECTED FOR THE    */ 02220000
*/*               "CURRENT" SYSMOD                                   */ 02221000
*/*                                                                  */ 02222000
*/*    CONDITIONS UPON ENTRY:                                        */ 02223000
*/*                                                                  */ 02224000
*/*     *          - ALL ELEMENTS FROM THE "CURRENT" SYSMOD HAVE     */ 02225000
*/*                  BEEN SUCCESSFULLY SELECTED OR EXCLUDED (I.E.,   */ 02226000
*/*                  THE SYSMOD IS NOT NOGO DUE TO ID CHECK ERRORS). */ 02227000
*/*                                                                  */ 02228000
*/*     *          - THERE ARE MOD SECTION ENTRIES IN THE ICT FOR    */ 02229000
*/*                  EVERY ELEMENT IN THE "CURRENT" SYSMOD ... THE   */ 02230000
*/*                  SELECTED ELEMENTS FROM THE "CURRENT" SYSMOD     */ 02231000
*/*                  HAVE "ICTMISEL" SET "ON" IN THEIR RESPECTIVE    */ 02232000
*/*                  MOD SECTION ENTRIES.                            */ 02233000
*/*                                                                  */ 02234000
*/*     *          - ICTMIDPL IS SET IN THE SELECTED ELEMENTS'       */ 02235000
*/*                  MODID LISTS                                     */ 02236000
*/*                                                                  */ 02237000
*/********************************************************************/ 02238000
*                                                                  0610 02239000
*BLDMODS3:                                                         0610 02240000
*   PROC(BLDM3SMD,BLDMD3RC);                                       0610 02241000
BLDMODS3 STM   @14,@12,12(@13)                                     0610 02242000
         MVC   @PC00007(8),0(@01)                                  0610 02243000
*   DCL                                                            0611 02244000
*     BLDM3SMD CHAR(*);             /* ICT PTF ENTRY                 */ 02245000
*   DCL                                                            0612 02246000
*     BLDMD3RC FIXED(31);           /* MAX RETURN CODE COLLECTOR   0612 02247000
*                                      PARAMETER                     */ 02248000
*   DCL                                                            0613 02249000
*     IX FIXED(15);                 /* INDEX - MOD SECT PTR LIST     */ 02250000
*   DCL                                                            0614 02251000
*     IM FIXED(15);                 /* INDEX - MODID LIST            */ 02252000
*   RESPECIFY                                                      0615 02253000
*     ICTPTF BASED(ADDR(BLDM3SMD)); /* PTF SECTION ENTRY PASSED ...     02254000
*                                      "CURRENT" SYSMOD              */ 02255000
*   RESPECIFY                                                      0616 02256000
*     ICTIXPF BASED(ICTPCHN(1));    /* MOD SECT PTR LIST ...       0616 02257000
*                                      "CURRENT" SYSMOD              */ 02258000
*   IF ICTPCHN(1)=0                 /* NO MOD SECTION ENTRIES        */ 02259000
*     THEN                                                         0617 02260000
         L     @15,@PC00007                                        0617 02261000
         ICM   @14,15,ICTPCHN(@15)                                 0617 02262000
         BNZ   @RF00617                                            0617 02263000
*     ICTPCHN(1)=TBLXNULL;          /* POINT TO EMPTY LIST           */ 02264000
*                                                                  0618 02265000
         L     @14,@PC00001                                        0618 02266000
         MVC   ICTPCHN(4,@15),TBLXNULL(@14)                        0618 02267000
*   /*****************************************************************/ 02268000
*   /*                                                               */ 02269000
*   /* GO THRU ELEMENTS IN "CURRENT" SYSMOD                          */ 02270000
*   /*                                                               */ 02271000
*   /*****************************************************************/ 02272000
*                                                                  0619 02273000
*   DO IX=1 BY 1 WHILE ICTIXP(IX)^=ICTENDIX;                       0619 02274000
@RF00617 LA    IX,1                                                0619 02275000
         B     @DE00619                                            0619 02276000
@DL00619 DS    0H                                                  0620 02277000
*     RESPECIFY                                                    0620 02278000
*       ICTMOD BASED(ICTIXP(IX));   /* ADDRESS MOD SECT ENTRY        */ 02279000
*     RESPECIFY                                                    0621 02280000
*       ICTMIDLS BASED(ICTMICHN(1));/* ADDRESS MODID LIST            */ 02281000
*     IF ICTMISEL(1)=ON             /* ELEMENT SELECTED              */ 02282000
*       THEN                                                       0622 02283000
         LR    @03,IX                                              0622 02284000
         SLA   @03,2                                               0622 02285000
         L     @15,@PC00007                                        0622 02286000
         L     @01,ICTPCHN(,@15)                                   0622 02287000
         AL    @01,@CF02424                                        0622 02288000
         L     @03,ICTIXP(@03,@01)                                 0622 02289000
         TM    ICTMISEL(@03),B'10000000'                           0622 02290000
         BNO   @RF00622                                            0622 02291000
*       DO;                                                        0623 02292000
*                                                                  0623 02293000
*         /***********************************************************/ 02294000
*         /*                                                         */ 02295000
*         /* GO THRU MODID LIST FOR SELECTED ELEMENT                 */ 02296000
*         /*                                                         */ 02297000
*         /***********************************************************/ 02298000
*                                                                  0624 02299000
*         DO IM=1 BY 1 WHILE ICTMIDND(IM)^=ICTENDIX;               0624 02300000
*                                                                  0624 02301000
         LA    IM,1                                                0624 02302000
         B     @DE00624                                            0624 02303000
@DL00624 DS    0H                                                  0625 02304000
*           /*********************************************************/ 02305000
*           /*                                                       */ 02306000
*           /* SET PRE/SUP INDICATOR (ICTMIDPS) FROM ICTMIDLS        */ 02307000
*           /*                                                       */ 02308000
*           /*********************************************************/ 02309000
*                                                                  0625 02310000
*           IF ICTMIDPL(IM)=ON      /* PRE/SUP BY "CURRENT" SYSMOD   */ 02311000
*             THEN                                                 0625 02312000
         LR    @15,IM                                              0625 02313000
         SLA   @15,3                                               0625 02314000
         LR    @14,IX                                              0625 02315000
         SLA   @14,2                                               0625 02316000
         L     @07,@PC00007                                        0625 02317000
         L     @01,ICTPCHN(,@07)                                   0625 02318000
         AL    @01,@CF02424                                        0625 02319000
         L     @01,ICTIXP(@14,@01)                                 0625 02320000
         L     @14,ICTMICHN(,@01)                                  0625 02321000
         ST    @15,@TF00001                                        0625 02322000
         ALR   @15,@14                                             0625 02323000
         BCTR  @15,0                                               0625 02324000
         TM    ICTMIDPL-7(@15),B'00100000'                         0625 02325000
         BNO   @RF00625                                            0625 02326000
*             ICTMIDPS(IM)=ON;      /* SET PRE/SUP INDICATOR         */ 02327000
         AL    @14,@TF00001                                        0626 02328000
         BCTR  @14,0                                               0626 02329000
         OI    ICTMIDPS-7(@14),B'01000000'                         0626 02330000
*           ELSE                                                   0627 02331000
*             ICTMIDPS(IM)=OFF;     /* CLEAR PRE/SUP INDICATOR       */ 02332000
         B     @RC00625                                            0627 02333000
@RF00625 LR    @15,IM                                              0627 02334000
         SLA   @15,3                                               0627 02335000
         LR    @14,IX                                              0627 02336000
         SLA   @14,2                                               0627 02337000
         L     @07,@PC00007                                        0627 02338000
         L     @01,ICTPCHN(,@07)                                   0627 02339000
         AL    @01,@CF02424                                        0627 02340000
         L     @01,ICTIXP(@14,@01)                                 0627 02341000
         L     @01,ICTMICHN(,@01)                                  0627 02342000
         ALR   @01,@15                                             0627 02343000
         BCTR  @01,0                                               0627 02344000
         NI    ICTMIDPS-7(@01),B'10111111'                         0627 02345000
*         END;                                                     0628 02346000
@RC00625 AL    IM,@CF00065                                         0628 02347000
@DE00624 LR    @15,IM                                              0628 02348000
         SLA   @15,3                                               0628 02349000
         LR    @14,IX                                              0628 02350000
         SLA   @14,2                                               0628 02351000
         L     @07,@PC00007                                        0628 02352000
         L     @01,ICTPCHN(,@07)                                   0628 02353000
         AL    @01,@CF02424                                        0628 02354000
         L     @01,ICTIXP(@14,@01)                                 0628 02355000
         L     @01,ICTMICHN(,@01)                                  0628 02356000
         AL    @01,@CF02434                                        0628 02357000
         L     @15,ICTMIDND(@15,@01)                               0628 02358000
         CL    @15,ICTENDIX                                        0628 02359000
         BNE   @DL00624                                            0628 02360000
*       END;                                                       0629 02361000
*   END;                                                           0630 02362000
@RF00622 AL    IX,@CF00065                                         0630 02363000
@DE00619 LR    @03,IX                                              0630 02364000
         SLA   @03,2                                               0630 02365000
         L     @15,@PC00007                                        0630 02366000
         L     @01,ICTPCHN(,@15)                                   0630 02367000
         AL    @01,@CF02424                                        0630 02368000
         L     @03,ICTIXP(@03,@01)                                 0630 02369000
         CL    @03,ICTENDIX                                        0630 02370000
         BNE   @DL00619                                            0630 02371000
*   RETURN;                                                        0631 02372000
@EL00007 DS    0H                                                  0631 02373000
@EF00007 DS    0H                                                  0631 02374000
@ER00007 LM    @14,@12,12(@13)                                     0631 02375000
         BR    @14                                                 0631 02376000
*   END BLDMODS3;                                                  0632 02377000
*                                                                  0633 02378000
*/********************************************************************/ 02379000
*/*                                                                  */ 02380000
*/*    BLDENTRY - BUILD ICT MOD SECTION ENTRY FOR AN ELEMENT         */ 02381000
*/*                                                                  */ 02382000
*/*               - CALL HMASMTAD TO GET ENTRY IN ICT ENTRY SECTION. */ 02383000
*/*                                                                  */ 02384000
*/*               - CALL HMASMTM1 FOR ++MOD ELEMENTS.                */ 02385000
*/*                 CALL HMASMTM2 FOR ++MAC AND ++MACUPD ELEMENTS.   */ 02386000
*/*                 CALL HMASMTM3 FOR ++SRC AND ++SRCUPD ELEMENTS.   */ 02387000
*/*                 CALL HMASMTM4 FOR ++ZAP ELEMENTS.                */ 02388000
*/*                                                                  */ 02389000
*/*               - INITIALIZE ELEMENT'S FMID AND RMID.              */ 02390000
*/*                                                                  */ 02391000
*/*               - MOVE IN-LINE TEXT SUPPLIED FOR ELEMENT TO WRK    */ 02392000
*/*                 DATASETS BY CALLING HMASMTMW.                    */ 02393000
*/*                                                                  */ 02394000
*/*                                                                  */ 02395000
*/*    CONDITIONS UPON ENTRY:                                        */ 02396000
*/*                                                                  */ 02397000
*/*     * MCBPTR   - POINTS TO AN MCB INITIALIZED FROM THE           */ 02398000
*/*                  MODIFICATION CNTRL. STMT. FOR THE ELEMENT.      */ 02399000
*/*                                                                  */ 02400000
*/*    CONDITIONS UPON EXIT:                                         */ 02401000
*/*                                                                  */ 02402000
*/*     * CRPBUFFR - IS PRIMED WITH THE NEXT MODIFICATION CONTROL    */ 02403000
*/*                  STATEMENT IF BLDENTRC IS ZERO.                  */ 02404000
*/*                                                                  */ 02405000
*/*     * BLDENTRC - PROCESSING RETURN CODE RETURNED WITH THE        */ 02406000
*/*                  HIGHEST RETURN CODE ENCOUNTERED:                */ 02407000
*/*                                                                  */ 02408000
*/*                  4 - END-OF-FILE ENCOUNTERED ON PTS MCS MEMBER.  */ 02409000
*/*                                                                  */ 02410000
*/*                  8, 12, 16 RETURN CODES FROM:                    */ 02411000
*/*                                                                  */ 02412000
*/*                    HMASMTM1 - PROCEDURE CALLED FOR ++MOD/ZAP     */ 02413000
*/*                    HMASMTM2 - PROCEDURE CALLED FOR ++MAC/MACUPD  */ 02414000
*/*                    HMASMTM3 - PROCEDURE CALLED FOR ++SRC/SRCUPD  */ 02415000
*/*                    HMASMTMW - PROCEDURE CALLED TO MOVE IN-LINE   */ 02416000
*/*                               ELEMENT TEXT TO WRK DATASET        */ 02417000
*/*                    SKIPELEM - PROCEDURE CALLED TO MOVE TO NEXT   */ 02418000
*/*                               MODIFICATION CNTRL. STMT.          */ 02419000
*/*                                                                  */ 02420000
*/********************************************************************/ 02421000
*                                                                  0633 02422000
*BLDENTRY:                                                         0633 02423000
*   PROC(BLDESMD,BLDENTRC);                                        0633 02424000
BLDENTRY STM   @14,@12,@SA00008                                    0633 02425000
         MVC   @PC00008(8),0(@01)                                  0633 02426000
*   DCL                                                            0634 02427000
*     BLDESMD CHAR(*);              /* PTF SECT ENTRY                */ 02428000
*   DCL                                                            0635 02429000
*     BLDENTRC FIXED(31);           /* MAX RETURN CODE COLLECTOR   0635 02430000
*                                      PARAMETER                     */ 02431000
*   DCL                                                            0636 02432000
*     TMXRETRN FIXED(31);           /* RETURN CODE FROM HMASMTM1, 2 3   02433000
*                                      OR 4                          */ 02434000
*   DCL                                                            0637 02435000
*     BLDENT@ PTR(31);              /* POINTS TO MOD SECT ENTRY BEING   02436000
*                                      BUILT                         */ 02437000
*   DCL                                                            0638 02438000
*     WCHKANS CHAR(1);              /* VARIABLE PASSED TO WRKCHK     */ 02439000
*   DCL                                                            0639 02440000
*     ENTTYPE FIXED(8);             /* ELEMENT TYPE (MCBTYPE VALUES) */ 02441000
*   DCL                                                            0640 02442000
*     ENTERMID CHAR(7);             /* ELEMENT RMID FROM MCBERMID    */ 02443000
*   RESPECIFY                                                      0641 02444000
*     ICTPTF BASED(ADDR(BLDESMD));  /* PTF SECT ENTRY PASSED         */ 02445000
*   ENTTYPE=MCBTYPE;                /* SAVE MCB ELEMENT TYPE VALUE   */ 02446000
         L     @15,MCBPTR                                          0642 02447000
         SLR   ENTTYPE,ENTTYPE                                     0642 02448000
         IC    ENTTYPE,MCBTYPE(,@15)                               0642 02449000
*   ENTERMID=MCBERMID;              /* SAVE RMID FROM MCB            */ 02450000
*                                                                  0643 02451000
         MVC   ENTERMID(7),MCBERMID(@15)                           0643 02452000
*   /*****************************************************************/ 02453000
*   /*                                                               */ 02454000
*   /* GET A BASIC MOD SECTION ENTRY                                 */ 02455000
*   /*                                                               */ 02456000
*   /*****************************************************************/ 02457000
*                                                                  0644 02458000
*   BLDENT@=TBLXTOP;                /* ADDR OF ENTRY TO BE OBTAINED  */ 02459000
         L     @03,@PC00001                                        0644 02460000
         MVC   BLDENT@(4),TBLXTOP(@03)                             0644 02461000
*   CALL HMASMTAD(TBLXPARM,         /* PARM LIST                     */ 02462000
*       'M',                        /* BUILD MOD SECTION ENTRY       */ 02463000
*       MCBENAME);                  /* ENTRY NAME                    */ 02464000
         ST    @03,@AL00001                                        0645 02465000
         LA    @03,@CC00717                                        0645 02466000
         ST    @03,@AL00001+4                                      0645 02467000
         LA    @03,MCBENAME(,@15)                                  0645 02468000
         ST    @03,@AL00001+8                                      0645 02469000
         L     @15,@CV01891                                        0645 02470000
         LA    @01,@AL00001                                        0645 02471000
         BALR  @14,@15                                             0645 02472000
*   RESPECIFY                                                      0646 02473000
*     REG15 RSTD;                                                  0646 02474000
*   BLDENTRC=MAX(BLDENTRC,REG15);   /* SAVE RETURN CODE FROM HMASMTAD*/ 02475000
         L     @14,@PC00008+4                                      0647 02476000
         L     @03,BLDENTRC(,@14)                                  0647 02477000
         CR    @03,REG15                                           0647 02478000
         BNL   *+6                                                      02479000
         LR    @03,REG15                                           0647 02480000
         ST    @03,BLDENTRC(,@14)                                  0647 02481000
*   RESPECIFY                                                      0648 02482000
*     REG15 UNRSTD;                                                0648 02483000
*   IF BLDENTRC<STOPPTF THEN                                       0649 02484000
         CH    @03,@CH00033                                        0649 02485000
         BNL   @RF00649                                            0649 02486000
*     DO;                                                          0650 02487000
*                                                                  0650 02488000
*       /*************************************************************/ 02489000
*       /*                                                           */ 02490000
*       /* BASIC MOD SECTION ENTRY OBTAINED ... INITIALIZE IT FROM   */ 02491000
*       /* THE PTF SECT ENTRY PASSED AND THE MCB                     */ 02492000
*       /*                                                           */ 02493000
*       /*************************************************************/ 02494000
*                                                                  0651 02495000
*       RESPECIFY                                                  0651 02496000
*         ICTMOD BASED(BLDENT@);    /* ADDRESSIBILITY TO MOD SECT  0651 02497000
*                                      ENTRY JUST OBTAINED           */ 02498000
*       ICTMNAME(1)=MCBENAME;       /* FILL IN ELEMENT NAME          */ 02499000
*                                                                  0652 02500000
         L     @03,BLDENT@                                         0652 02501000
         L     @01,MCBPTR                                          0652 02502000
         MVC   ICTMNAME(8,@03),MCBENAME(@01)                       0652 02503000
*       /*************************************************************/ 02504000
*       /*                                                           */ 02505000
*       /* CALL THE APPROPRATE PROCESSOR (TM1, TM2, TM3 OR TM4) TO   */ 02506000
*       /* COMPLETE THE ICT FROM DATA IN THE (A)CDS ELEMENT ENTRY.   */ 02507000
*       /*                                                           */ 02508000
*       /*************************************************************/ 02509000
*                                                                  0653 02510000
*       RESPECIFY                                                  0653 02511000
*         REG15 RSTD;                                              0653 02512000
*       IF ENTTYPE=MCBMODTP THEN                                   0654 02513000
         CH    ENTTYPE,@CH00040                                    0654 02514000
         BNE   @RF00654                                            0654 02515000
*         DO;                                                      0655 02516000
*                                                                  0655 02517000
*           /*********************************************************/ 02518000
*           /*                                                       */ 02519000
*           /* MOD TYPE ENTRY                                        */ 02520000
*           /*                                                       */ 02521000
*           /*********************************************************/ 02522000
*                                                                  0656 02523000
*           ICTMMOD(1)=ON;          /* SET ICT MOD SECT INDICATOR    */ 02524000
         OI    ICTMMOD(@03),B'10000000'                            0656 02525000
*           CALL HMASMTM1(TBLXPARM, /* PARM LIST                     */ 02526000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 02527000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 02528000
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */ 02529000
         MVC   @AL00001+4(12),@AL00657                             0657 02530000
         L     @14,@PC00001                                        0657 02531000
         ST    @14,@AL00001                                        0657 02532000
         L     @14,@PC00008                                        0657 02533000
         ST    @14,@TF00001                                        0657 02534000
         L     @15,@CV01896                                        0657 02535000
         LA    @01,@AL00001                                        0657 02536000
         BALR  @14,@15                                             0657 02537000
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */ 02538000
         ST    REG15,TMXRETRN                                      0658 02539000
*           CALL MODSRCA(ICTMOD(1));/* CHAIN MOD TO ASSOC. SRC       */ 02540000
         L     @14,BLDENT@                                         0659 02541000
         ST    @14,@AL00001                                        0659 02542000
         LA    @01,@AL00001                                        0659 02543000
         BAL   @14,MODSRCA                                         0659 02544000
*         END;                                                     0660 02545000
*       IF ENTTYPE=MCBMCRTP THEN                                   0661 02546000
@RF00654 CH    ENTTYPE,@CH00103                                    0661 02547000
         BNE   @RF00661                                            0661 02548000
*         DO;                                                      0662 02549000
*                                                                  0662 02550000
*           /*********************************************************/ 02551000
*           /*                                                       */ 02552000
*           /* MAC TYPE ENTRY                                        */ 02553000
*           /*                                                       */ 02554000
*           /*********************************************************/ 02555000
*                                                                  0663 02556000
*           ICTMMACR(1)=ON;         /* SET ICT MOD SECT INDICATOR    */ 02557000
         L     @14,BLDENT@                                         0663 02558000
         OI    ICTMMACR(@14),B'00001000'                           0663 02559000
*           CALL HMASMTM2(TBLXPARM, /* PARM LIST                     */ 02560000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 02561000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 02562000
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */ 02563000
         MVC   @AL00001+4(12),@AL00664                             0664 02564000
         L     @14,@PC00001                                        0664 02565000
         ST    @14,@AL00001                                        0664 02566000
         L     @14,@PC00008                                        0664 02567000
         ST    @14,@TF00001                                        0664 02568000
         L     @15,@CV01897                                        0664 02569000
         LA    @01,@AL00001                                        0664 02570000
         BALR  @14,@15                                             0664 02571000
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */ 02572000
         ST    REG15,TMXRETRN                                      0665 02573000
*         END;                                                     0666 02574000
*       IF ENTTYPE=MCBMCUTP THEN                                   0667 02575000
@RF00661 CH    ENTTYPE,@CH00033                                    0667 02576000
         BNE   @RF00667                                            0667 02577000
*         DO;                                                      0668 02578000
*                                                                  0668 02579000
*           /*********************************************************/ 02580000
*           /*                                                       */ 02581000
*           /* MACUPD TYPE ENTRY                                     */ 02582000
*           /*                                                       */ 02583000
*           /*********************************************************/ 02584000
*                                                                  0669 02585000
*           ICTMMACU(1)=ON;         /* SET ICT MOD SECT INDICATOR    */ 02586000
         L     @14,BLDENT@                                         0669 02587000
         OI    ICTMMACU(@14),B'00000100'                           0669 02588000
*           CALL HMASMTM2(TBLXPARM, /* PARM LIST                     */ 02589000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 02590000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 02591000
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */ 02592000
         MVC   @AL00001+4(12),@AL00670                             0670 02593000
         L     @14,@PC00001                                        0670 02594000
         ST    @14,@AL00001                                        0670 02595000
         L     @14,@PC00008                                        0670 02596000
         ST    @14,@TF00001                                        0670 02597000
         L     @15,@CV01897                                        0670 02598000
         LA    @01,@AL00001                                        0670 02599000
         BALR  @14,@15                                             0670 02600000
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */ 02601000
         ST    REG15,TMXRETRN                                      0671 02602000
*         END;                                                     0672 02603000
*       IF ENTTYPE=MCBSCRTP THEN                                   0673 02604000
@RF00667 CH    ENTTYPE,@CH00289                                    0673 02605000
         BNE   @RF00673                                            0673 02606000
*         DO;                                                      0674 02607000
*                                                                  0674 02608000
*           /*********************************************************/ 02609000
*           /*                                                       */ 02610000
*           /* SRC TYPE ENTRY                                        */ 02611000
*           /*                                                       */ 02612000
*           /*********************************************************/ 02613000
*                                                                  0675 02614000
*           ICTMSRCR(1)=ON;         /* SET ICT MOD SECT INDICATOR    */ 02615000
         L     @14,BLDENT@                                         0675 02616000
         OI    ICTMSRCR(@14),B'00000010'                           0675 02617000
*           CALL HMASMTM3(TBLXPARM, /* PARM LIST                     */ 02618000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 02619000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 02620000
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */ 02621000
         MVC   @AL00001+4(12),@AL00676                             0676 02622000
         L     @14,@PC00001                                        0676 02623000
         ST    @14,@AL00001                                        0676 02624000
         L     @14,@PC00008                                        0676 02625000
         ST    @14,@TF00001                                        0676 02626000
         L     @15,@CV01898                                        0676 02627000
         LA    @01,@AL00001                                        0676 02628000
         BALR  @14,@15                                             0676 02629000
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */ 02630000
         ST    REG15,TMXRETRN                                      0677 02631000
*           CALL SRCMODA(ICTMOD(1));/* CHAIN SRC TO ASSOC. MOD       */ 02632000
         L     @14,BLDENT@                                         0678 02633000
         ST    @14,@AL00001                                        0678 02634000
         LA    @01,@AL00001                                        0678 02635000
         BAL   @14,SRCMODA                                         0678 02636000
*         END;                                                     0679 02637000
*       IF ENTTYPE=MCBSCUTP THEN                                   0680 02638000
@RF00673 CH    ENTTYPE,@CH00034                                    0680 02639000
         BNE   @RF00680                                            0680 02640000
*         DO;                                                      0681 02641000
*                                                                  0681 02642000
*           /*********************************************************/ 02643000
*           /*                                                       */ 02644000
*           /* SRCUPD TYPE ENTRY                                     */ 02645000
*           /*                                                       */ 02646000
*           /*********************************************************/ 02647000
*                                                                  0682 02648000
*           ICTMSRCU(1)=ON;         /* SET ICT MOD SECT INDICATOR    */ 02649000
         L     @14,BLDENT@                                         0682 02650000
         OI    ICTMSRCU(@14),B'00000001'                           0682 02651000
*           CALL HMASMTM3(TBLXPARM, /* PARM LIST                     */ 02652000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 02653000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 02654000
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */ 02655000
         MVC   @AL00001+4(12),@AL00683                             0683 02656000
         L     @14,@PC00001                                        0683 02657000
         ST    @14,@AL00001                                        0683 02658000
         L     @14,@PC00008                                        0683 02659000
         ST    @14,@TF00001                                        0683 02660000
         L     @15,@CV01898                                        0683 02661000
         LA    @01,@AL00001                                        0683 02662000
         BALR  @14,@15                                             0683 02663000
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */ 02664000
         ST    REG15,TMXRETRN                                      0684 02665000
*           CALL SRCMODA(ICTMOD(1));/* CHAIN SRC TO ASSOC. MOD       */ 02666000
         L     @14,BLDENT@                                         0685 02667000
         ST    @14,@AL00001                                        0685 02668000
         LA    @01,@AL00001                                        0685 02669000
         BAL   @14,SRCMODA                                         0685 02670000
*         END;                                                     0686 02671000
*       IF ENTTYPE=MCBZAPTP THEN                                   0687 02672000
@RF00680 CH    ENTTYPE,@CH00067                                    0687 02673000
         BNE   @RF00687                                            0687 02674000
*         DO;                                                      0688 02675000
*                                                                  0688 02676000
*           /*********************************************************/ 02677000
*           /*                                                       */ 02678000
*           /* ZAP TYPE ENTRY                                        */ 02679000
*           /*                                                       */ 02680000
*           /*********************************************************/ 02681000
*                                                                  0689 02682000
*           ICTMZAP(1)=ON;          /* SET ICT MOD SECT INDICATOR    */ 02683000
         L     @14,BLDENT@                                         0689 02684000
         OI    ICTMZAP(@14),B'00100000'                            0689 02685000
*           CALL HMASMTM1(TBLXPARM, /* PARM LIST                     */ 02686000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 02687000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 02688000
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */ 02689000
         MVC   @AL00001+4(12),@AL00690                             0690 02690000
         L     @14,@PC00001                                        0690 02691000
         ST    @14,@AL00001                                        0690 02692000
         L     @14,@PC00008                                        0690 02693000
         ST    @14,@TF00001                                        0690 02694000
         L     @15,@CV01896                                        0690 02695000
         LA    @01,@AL00001                                        0690 02696000
         BALR  @14,@15                                             0690 02697000
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */ 02698000
         ST    REG15,TMXRETRN                                      0691 02699000
*         END;                                                     0692 02700000
*       BLDENTRC=MAX(BLDENTRC,TMXRETRN);/* SAVE RETURN CODE FROM TM1,   02701000
*                                      TM2 OR TM3                    */ 02702000
@RF00687 L     @14,@PC00008+4                                      0693 02703000
         L     @03,BLDENTRC(,@14)                                  0693 02704000
         L     @07,TMXRETRN                                        0693 02705000
         CR    @03,@07                                             0693 02706000
         BNL   *+6                                                      02707000
         LR    @03,@07                                             0693 02708000
         ST    @03,BLDENTRC(,@14)                                  0693 02709000
*       RESPECIFY                                                  0694 02710000
*         REG15 UNRSTD;                                            0694 02711000
*                                                                  0694 02712000
*       /*************************************************************/ 02713000
*       /*                                                           */ 02714000
*       /* COMPLETE MOD SECT ENTRY INITIALIZATION                    */ 02715000
*       /*                                                           */ 02716000
*       /*************************************************************/ 02717000
*                                                                  0695 02718000
*                                                                  0695 02719000
*       /*************************************************************/ 02720000
*       /*                                                           */ 02721000
*       /* INITIALIZE ELEMENT FMID                                   */ 02722000
*       /*                                                           */ 02723000
*       /*************************************************************/ 02724000
*                                                                  0695 02725000
*       IF ICTPTYPE(1)=IOPPFUNC THEN/* FUNCTION SYSMOD ?             */ 02726000
         L     @03,@PC00008                                        0695 02727000
         CLI   ICTPTYPE(@03),4                                     0695 02728000
         BNE   @RF00695                                            0695 02729000
*         ICTMFMID(1)=ICTPTFS(1);   /* YES - FMID IS SYSMOD'S NAME   */ 02730000
         L     @01,BLDENT@                                         0696 02731000
         MVC   ICTMFMID(7,@01),ICTPTFS(@03)                        0696 02732000
*       ELSE                                                       0697 02733000
*         ICTMFMID(1)=ICTPFMID(1);  /* NO - FMID IS FROM SYSMOD'S  0697 02734000
*                                      FMID                          */ 02735000
*                                                                  0697 02736000
         B     @RC00695                                            0697 02737000
@RF00695 L     @03,BLDENT@                                         0697 02738000
         L     @15,@PC00008                                        0697 02739000
         MVC   ICTMFMID(7,@03),ICTPFMID(@15)                       0697 02740000
*       /*************************************************************/ 02741000
*       /*                                                           */ 02742000
*       /* INITIALIZE ELEMENT RMID                                   */ 02743000
*       /*                                                           */ 02744000
*       /*************************************************************/ 02745000
*                                                                  0698 02746000
*       IF(ENTTYPE=MCBMODTP         /* ++MOD ELEMENT ?               */ 02747000
*           |ENTTYPE=MCBMCRTP       /* ++MAC ELEMENT ?               */ 02748000
*           |ENTTYPE=MCBSCRTP)      /* ++SRC ELEMENT ?               */ 02749000
*         THEN                                                     0698 02750000
@RC00695 CH    ENTTYPE,@CH00040                                    0698 02751000
         BE    @RT00698                                            0698 02752000
         CH    ENTTYPE,@CH00103                                    0698 02753000
         BE    @RT00698                                            0698 02754000
         CH    ENTTYPE,@CH00289                                    0698 02755000
         BNE   @RF00698                                            0698 02756000
@RT00698 DS    0H                                                  0699 02757000
*         DO;                                                      0699 02758000
*                                                                  0699 02759000
*           /*********************************************************/ 02760000
*           /*                                                       */ 02761000
*           /* SET RMID FOR MOD, MAC AND SRC ELEMENTS                */ 02762000
*           /*                                                       */ 02763000
*           /*********************************************************/ 02764000
*                                                                  0700 02765000
*           IF ENTERMID^=NULLPTF#   /* NON-BLANK RMID IN MCB         */ 02766000
*             THEN                                                 0700 02767000
         CLC   ENTERMID(7),@CC01944                                0700 02768000
         BE    @RF00700                                            0700 02769000
*             ICTMRMID(1)=ENTERMID; /* RMID COMES FROM RMID KEYWORD  */ 02770000
         L     @01,BLDENT@                                         0701 02771000
         MVC   ICTMRMID(7,@01),ENTERMID                            0701 02772000
*           ELSE                                                   0702 02773000
*             ICTMRMID(1)=ICTPTFS(1);/* SYSMOD NAME IS RMID          */ 02774000
         B     @RC00700                                            0702 02775000
@RF00700 L     @01,BLDENT@                                         0702 02776000
         L     @15,@PC00008                                        0702 02777000
         MVC   ICTMRMID(7,@01),ICTPTFS(@15)                        0702 02778000
*         END;                                                     0703 02779000
*       ELSE                                                       0704 02780000
*                                                                  0704 02781000
*         /***********************************************************/ 02782000
*         /*                                                         */ 02783000
*         /* SET RMID TO "BLANKS" FOR ZAP, MACUPD, SRCUPD ELEMENTS   */ 02784000
*         /*                                                         */ 02785000
*         /***********************************************************/ 02786000
*                                                                  0704 02787000
*         ICTMRMID(1)=NULLPTF#;     /* RMID FOR UPDATE-TYPE ELEMENTS */ 02788000
         B     @RC00698                                            0704 02789000
@RF00698 L     @01,BLDENT@                                         0704 02790000
         MVC   ICTMRMID(7,@01),@CC01944                            0704 02791000
*     END;                                                         0705 02792000
*                                                                  0705 02793000
@RC00698 DS    0H                                                  0706 02794000
*   /*****************************************************************/ 02795000
*   /*                                                               */ 02796000
*   /* ICT MOD SECTION ENTRY INITIALIZED FOR CURRENT ELEMENT         */ 02797000
*   /*                                                               */ 02798000
*   /*****************************************************************/ 02799000
*                                                                  0706 02800000
*   IF BLDENTRC<STOPPTF THEN                                       0706 02801000
@RF00649 L     @15,@PC00008+4                                      0706 02802000
         L     @15,BLDENTRC(,@15)                                  0706 02803000
         CH    @15,@CH00033                                        0706 02804000
         BNL   @RF00706                                            0706 02805000
*     DO;                                                          0707 02806000
*                                                                  0707 02807000
*       /*************************************************************/ 02808000
*       /*                                                           */ 02809000
*       /* MOD SECTION ENTRY INITIALIZATION SUCCESSFUL FOR THE       */ 02810000
*       /* CURRENT ELEMENT                                           */ 02811000
*       /*                                                           */ 02812000
*       /*************************************************************/ 02813000
*                                                                  0708 02814000
*       IF ICTLIBLK(1)=OFF          /* ELEMENT NOT ON LKLIB          */ 02815000
*           &ICTLIBTX(1)=OFF        /* ELEMENT NOT ON TXLIB          */ 02816000
*           &ICTMRELF(1)=OFF        /* ELEMENT NOT ON RELFILE        */ 02817000
*           &ICTMIDEL(1)=OFF        /* ELEMENT NOT TO BE DELETED     */ 02818000
*         THEN                                                     0708 02819000
         L     @15,BLDENT@                                         0708 02820000
         TM    ICTLIBLK(@15),B'11100000'                           0708 02821000
         BNZ   @RF00708                                            0708 02822000
         TM    ICTMIDEL(@15),B'01000000'                           0708 02823000
         BNZ   @RF00708                                            0708 02824000
*         DO;                                                      0709 02825000
*                                                                  0709 02826000
*           /*********************************************************/ 02827000
*           /*                                                       */ 02828000
*           /* ELEMENT SUPPLIED IN-LINE ... CHECK IF IT CAN BE MOVED */ 02829000
*           /* TO A WRK DATASET NOW.                                 */ 02830000
*           /*                                                       */ 02831000
*           /*********************************************************/ 02832000
*                                                                  0710 02833000
*           CALL WRKCHK(ICTMNAME(1),ICTMFLG1(1),WCHKANS);          0710 02834000
         ST    @15,@AL00001                                        0710 02835000
         LA    @15,ICTMFLG1(,@15)                                  0710 02836000
         ST    @15,@AL00001+4                                      0710 02837000
         LA    @15,WCHKANS                                         0710 02838000
         ST    @15,@AL00001+8                                      0710 02839000
         LA    @01,@AL00001                                        0710 02840000
         BAL   @14,WRKCHK                                          0710 02841000
*           IF WCHKANS=YES THEN                                    0711 02842000
         CLI   WCHKANS,C'Y'                                        0711 02843000
         BNE   @RF00711                                            0711 02844000
*             DO;                                                  0712 02845000
*                                                                  0712 02846000
*               /*****************************************************/ 02847000
*               /*                                                   */ 02848000
*               /* ELEMENT CAN BE MOVED TO WRK DATASET               */ 02849000
*               /*                                                   */ 02850000
*               /*****************************************************/ 02851000
*                                                                  0713 02852000
*               ICTMWRK(1)=ON;      /* INDICATE ELEMENT MOVED        */ 02853000
         L     @01,BLDENT@                                         0713 02854000
         OI    ICTMWRK(@01),B'00001000'                            0713 02855000
*               TMWMODE=CREATE;     /* CREATE NEW WRK DATASET MEMBER */ 02856000
         MVI   TMWMODE,C'C'                                        0714 02857000
*               CALL HMASMTMW(TMWOPT,/* WRITE TO WRK                 */ 02858000
*                   BLDENT@,        /* PTR ICT MOD                   */ 02859000
*                   HMASMCRP,       /* GET PARM LIST                 */ 02860000
*                   TMWMODE);       /* CREATE|MERGE                  */ 02861000
         L     @15,@CV01895                                        0715 02862000
         LA    @01,@AL00715                                        0715 02863000
         BALR  @14,@15                                             0715 02864000
*               RESPECIFY                                          0716 02865000
*                 REG15 RSTD;                                      0716 02866000
*               IF REG15=IOPEOF     /* END-OF-FILE ENCOUNTERED       */ 02867000
*                 THEN                                             0717 02868000
         CH    REG15,@CH00040                                      0717 02869000
         BNE   @RF00717                                            0717 02870000
*                 MCSEOF=ON;        /* SET END-OF-FILE FLAG          */ 02871000
         OI    MCSEOF,B'00010000'                                  0718 02872000
*               ELSE                                               0719 02873000
*                 BLDENTRC=MAX(BLDENTRC,REG15);/* MAINTAIN RET.CODE  */ 02874000
         B     @RC00717                                            0719 02875000
@RF00717 L     @14,@PC00008+4                                      0719 02876000
         L     @07,BLDENTRC(,@14)                                  0719 02877000
         CR    @07,REG15                                           0719 02878000
         BNL   *+6                                                      02879000
         LR    @07,REG15                                           0719 02880000
         ST    @07,BLDENTRC(,@14)                                  0719 02881000
*               RESPECIFY                                          0720 02882000
*                 REG15 UNRSTD;                                    0720 02883000
@RC00717 DS    0H                                                  0721 02884000
*               IF ICTMXPND(1)=ON   /* EXPANDS ENCOUNTERED ?         */ 02885000
*                   &BLDENTRC<STOPPTF THEN                         0721 02886000
*                                                                  0721 02887000
         L     @01,BLDENT@                                         0721 02888000
         TM    ICTMXPND(@01),B'00010000'                           0721 02889000
         BNO   @RF00721                                            0721 02890000
         L     @15,@PC00008+4                                      0721 02891000
         L     @14,BLDENTRC(,@15)                                  0721 02892000
         CH    @14,@CH00033                                        0721 02893000
         BNL   @RF00721                                            0721 02894000
*                 /***************************************************/ 02895000
*                 /*                                                 */ 02896000
*                 /* BUILD MOD SECT ENTRY FOR MOD TO BE EXPANDED     */ 02897000
*                 /*                                                 */ 02898000
*                 /***************************************************/ 02899000
*                                                                  0722 02900000
*                 CALL XPNDZAP(BLDENT@,/* PTR ICT MOD ENTRY          */ 02901000
*                     ADDR(ICTPTF(1)),/* PTR ICT PTF                 */ 02902000
*                     BLDENTRC);    /* RETURN CODE                   */ 02903000
         MVC   @AL00001(8),@AL00722                                0722 02904000
         L     @14,@PC00008                                        0722 02905000
         ST    @14,@AFTEMPS+4                                      0722 02906000
         ST    @15,@AL00001+8                                      0722 02907000
         LA    @01,@AL00001                                        0722 02908000
         BAL   @14,XPNDZAP                                         0722 02909000
*             END;                  /* END PROCESSING SELECTED     0723 02910000
*                                      ELEMENT MOVED TO WRK DATASET  */ 02911000
*           ELSE                                                   0724 02912000
*             DO;                                                  0724 02913000
*                                                                  0724 02914000
         B     @RC00711                                            0724 02915000
@RF00711 DS    0H                                                  0725 02916000
*               /*****************************************************/ 02917000
*               /*                                                   */ 02918000
*               /* ELEMENT COULD NOT BE MOVED TO WRK DATASET         */ 02919000
*               /*                                                   */ 02920000
*               /*****************************************************/ 02921000
*                                                                  0725 02922000
*               BLDM2WRK=ON;        /* WORK TO DO BY BLDMODS2 PROC   */ 02923000
         OI    BLDM2WRK,B'00100000'                                0725 02924000
*               CALL SKIPELEM(BLDENTRC);/* GET NEXT MCS              */ 02925000
         L     @15,@PC00008+4                                      0726 02926000
         ST    @15,@AL00001                                        0726 02927000
         LA    @01,@AL00001                                        0726 02928000
         BAL   @14,SKIPELEM                                        0726 02929000
*             END;                  /* END PROCESSING ELEMENT NOT NOT   02930000
*                                      MOVED TO WRK DATASET          */ 02931000
*         END;                      /* END PROCESSING ELEMENT      0728 02932000
*                                      SUPPLIED IN-LINE              */ 02933000
*       ELSE                                                       0729 02934000
*         CALL SKIPELEM(BLDENTRC);  /* NOT IN LINE ... GET NEXT MCS  */ 02935000
         B     @RC00708                                            0729 02936000
@RF00708 L     @15,@PC00008+4                                      0729 02937000
         ST    @15,@AL00001                                        0729 02938000
         LA    @01,@AL00001                                        0729 02939000
         BAL   @14,SKIPELEM                                        0729 02940000
*     END;                          /* END BLDENTRC<STOPPTF          */ 02941000
*   RETURN;                                                        0731 02942000
@EL00008 DS    0H                                                  0731 02943000
@EF00008 DS    0H                                                  0731 02944000
@ER00008 LM    @14,@12,@SA00008                                    0731 02945000
         BR    @14                                                 0731 02946000
*   END BLDENTRY;                                                  0732 02947000
         B     @EL00008                                            0732 02948000
*                                                                  0733 02949000
*/********************************************************************/ 02950000
*/*                                                                  */ 02951000
*/*    LOCELEM  - LOCATE AN ELEMENT ON THE (A)CDS.                   */ 02952000
*/*                                                                  */ 02953000
*/*               THE RESULTANT ELEMENT ENTRY IS IN THE IOP POINTED  */ 02954000
*/*               TO BY PTRIOP2.                                     */ 02955000
*/*                                                                  */ 02956000
*/*    CONDITIONS UPON ENTRY:                                        */ 02957000
*/*                                                                  */ 02958000
*/*     * PTRIOP2  - PTR TO IOP WHICH MAY BE USED TO LOCATE ELEMENT  */ 02959000
*/*                                                                  */ 02960000
*/*    CONDITIONS UPON EXIT:                                         */ 02961000
*/*                                                                  */ 02962000
*/*     * HIGHTMD  - SET IF I/O ERROR OCCURRED ACCESSING (A)CDS.     */ 02963000
*/*                                                                  */ 02964000
*/********************************************************************/ 02965000
*                                                                  0733 02966000
*LOCELEM:                                                          0733 02967000
*   PROC(ELEMNAME,ELEMTYPE);                                       0733 02968000
LOCELEM  STM   @14,@12,@SA00009                                    0733 02969000
         MVC   @PC00009(8),0(@01)                                  0733 02970000
*   DCL                                                            0734 02971000
*     ELEMNAME CHAR(8);                                            0734 02972000
*   DCL                                                            0735 02973000
*     ELEMTYPE FIXED(8);            /* SAME VALUES AS IOPPIND        */ 02974000
*   DCL                                                            0736 02975000
*     LTSTTYPE FIXED(8);            /* NON-REGRESSED IOPPIND VALUES  */ 02976000
*   RESPECIFY                                                      0737 02977000
*     HMASMIOP BASED(PTRIOP2);      /* IOP TO ACCESS (A)CDS ELEMENT     02978000
*                                      ENTRY                         */ 02979000
*   IF ELEMTYPE>=IOPPREG            /* REGRESSED IOPPIND VALUE PASSED*/ 02980000
*     THEN                                                         0738 02981000
         L     @15,@PC00009+4                                      0738 02982000
         CLI   ELEMTYPE(@15),80                                    0738 02983000
         BL    @RF00738                                            0738 02984000
*     LTSTTYPE=ELEMTYPE-IOPPREG;    /* CONVERT TO NON-REGRESSED VALUE*/ 02985000
         SLR   LTSTTYPE,LTSTTYPE                                   0739 02986000
         IC    LTSTTYPE,ELEMTYPE(,@15)                             0739 02987000
         SH    LTSTTYPE,@CH00469                                   0739 02988000
*   ELSE                                                           0740 02989000
*     LTSTTYPE=ELEMTYPE;            /* USE VALUE PASSED              */ 02990000
         B     @RC00738                                            0740 02991000
@RF00738 L     @15,@PC00009+4                                      0740 02992000
         SLR   LTSTTYPE,LTSTTYPE                                   0740 02993000
         IC    LTSTTYPE,ELEMTYPE(,@15)                             0740 02994000
*   IOPRETRN=IOPGOOD;               /* CLEAR IOP FIELD               */ 02995000
@RC00738 L     @03,PTRIOP2                                         0741 02996000
         MVI   IOPRETRN(@03),X'00'                                 0741 02997000
*   IOPDSID=TBLXCDSI;               /* APPROPRIATE CONTROL DATASET   */ 02998000
*                                                                  0742 02999000
         L     @15,@PC00001                                        0742 03000000
         MVC   IOPDSID(1,@03),TBLXCDSI(@15)                        0742 03001000
*   /*****************************************************************/ 03002000
*   /*                                                               */ 03003000
*   /* SET UP TO LOCATE ELEMENT ENTRY                                */ 03004000
*   /*                                                               */ 03005000
*   /*****************************************************************/ 03006000
*                                                                  0743 03007000
*   IOPFUNCT=IOPLOC;                                               0743 03008000
         MVI   IOPFUNCT(@03),X'03'                                 0743 03009000
*   IOPNAME=ELEMNAME;                                              0744 03010000
         L     @15,@PC00009                                        0744 03011000
         MVC   IOPNAME(8,@03),ELEMNAME(@15)                        0744 03012000
*   IF LTSTTYPE=IOPPMOD             /* ++MOD ELEMENT                 */ 03013000
*       |LTSTTYPE=IOPPZAP           /* ++ZAP ELEMENT                 */ 03014000
*     THEN                                                         0745 03015000
         CH    LTSTTYPE,@CH00065                                   0745 03016000
         BE    @RT00745                                            0745 03017000
         CH    LTSTTYPE,@CH00273                                   0745 03018000
         BNE   @RF00745                                            0745 03019000
@RT00745 DS    0H                                                  0746 03020000
*     IOPTYPE=IOPMOD;               /* ACCESS (A)CDS MOD ENTRY       */ 03021000
         L     @01,PTRIOP2                                         0746 03022000
         MVI   IOPTYPE(@01),X'05'                                  0746 03023000
*   ELSE                                                           0747 03024000
*     IF LTSTTYPE=IOPPMACR          /* ++MAC ELEMENT                 */ 03025000
*         |LTSTTYPE=IOPPMACU        /* ++MACUPD ELEMENT              */ 03026000
*       THEN                                                       0747 03027000
         B     @RC00745                                            0747 03028000
@RF00745 CH    LTSTTYPE,@CH00040                                   0747 03029000
         BE    @RT00747                                            0747 03030000
         CH    LTSTTYPE,@CH00103                                   0747 03031000
         BNE   @RF00747                                            0747 03032000
@RT00747 DS    0H                                                  0748 03033000
*       IOPTYPE=IOPMCR;             /* ACCESS (A)CDS MAC ENTRY       */ 03034000
         L     @01,PTRIOP2                                         0748 03035000
         MVI   IOPTYPE(@01),X'03'                                  0748 03036000
*     ELSE                                                         0749 03037000
*       IF LTSTTYPE=IOPPSRCR        /* ++SRC ELEMENT                 */ 03038000
*           |LTSTTYPE=IOPPSRCR      /* ++SRCUPD ELEMENT              */ 03039000
*         THEN                                                     0749 03040000
         B     @RC00747                                            0749 03041000
@RF00747 LA    @03,6                                               0749 03042000
         CR    LTSTTYPE,@03                                        0749 03043000
         BE    @RT00749                                            0749 03044000
         CR    LTSTTYPE,@03                                        0749 03045000
         BNE   @RF00749                                            0749 03046000
@RT00749 DS    0H                                                  0750 03047000
*         IOPTYPE=IOPSCR;           /* ACCESS (A)CDS SRC ENTRY       */ 03048000
         L     @01,PTRIOP2                                         0750 03049000
         MVI   IOPTYPE(@01),X'08'                                  0750 03050000
*       ELSE                                                       0751 03051000
*         IOPRETRN=IOPNOTFD;        /* RETURN A "NOT FOUND"          */ 03052000
         B     @RC00749                                            0751 03053000
@RF00749 L     @01,PTRIOP2                                         0751 03054000
         MVI   IOPRETRN(@01),X'04'                                 0751 03055000
*   IF IOPRETRN^=IOPNOTFD THEN                                     0752 03056000
@RC00749 DS    0H                                                  0752 03057000
@RC00747 DS    0H                                                  0752 03058000
@RC00745 L     @15,PTRIOP2                                         0752 03059000
         CLI   IOPRETRN(@15),4                                     0752 03060000
         BE    @RF00752                                            0752 03061000
*     DO;                                                          0753 03062000
*                                                                  0753 03063000
*       /*************************************************************/ 03064000
*       /*                                                           */ 03065000
*       /* ACCESS (A)CDS FOR ELEMENT                                 */ 03066000
*       /*                                                           */ 03067000
*       /*************************************************************/ 03068000
*                                                                  0754 03069000
*       CALL HMASMIO(HMASMIOP);                                    0754 03070000
         ST    @15,@AL00001                                        0754 03071000
         L     @15,@CV01886                                        0754 03072000
         LA    @01,@AL00001                                        0754 03073000
         BALR  @14,@15                                             0754 03074000
*       IF IOPRETRN>IOPNOTFD        /* I/O ERROR ?                   */ 03075000
*         THEN                                                     0755 03076000
         L     @15,PTRIOP2                                         0755 03077000
         CLI   IOPRETRN(@15),4                                     0755 03078000
         BNH   @RF00755                                            0755 03079000
*         HIGHTMD=MAX(HIGHTMD,IOPRETRN);/* MAINTAIN HIGHTMD RETURN 0756 03080000
*                                      CODE                          */ 03081000
         L     @14,HIGHTMD                                         0756 03082000
         SLR   @07,@07                                             0756 03083000
         IC    @07,IOPRETRN(,@15)                                  0756 03084000
         CR    @14,@07                                             0756 03085000
         BNL   *+6                                                      03086000
         LR    @14,@07                                             0756 03087000
         ST    @14,HIGHTMD                                         0756 03088000
*     END;                                                         0757 03089000
*   RETURN;                                                        0758 03090000
@EL00009 DS    0H                                                  0758 03091000
@EF00009 DS    0H                                                  0758 03092000
@ER00009 LM    @14,@12,@SA00009                                    0758 03093000
         BR    @14                                                 0758 03094000
*   END LOCELEM;                                                   0759 03095000
         B     @EL00009                                            0759 03096000
*                                                                  0760 03097000
*/********************************************************************/ 03098000
*/*                                                                  */ 03099000
*/*    BLDMODSF - CLEANUP UP THE ICT AND THE WRK DATASETS FOR A      */ 03100000
*/*               SYSMOD WHICH IS TERMINATED DURING MOD SECTION      */ 03101000
*/*               BUILD PROCESSING.                                  */ 03102000
*/*                                                                  */ 03103000
*/*    CONDITIONS UPON ENTRY:                                        */ 03104000
*/*                                                                  */ 03105000
*/*     * ICTPPTR  - ICT MOD SECTION ENTRIES MUST HAVE ICTPPTR SET   */ 03106000
*/*                  TO THE ADDRESS OF THE ICT PTF SECTION ENTRY     */ 03107000
*/*                  REPRESENTING THE SYSMOD TO WHICH THEY BELONG.   */ 03108000
*/*                                                                  */ 03109000
*/*                                                                  */ 03110000
*/********************************************************************/ 03111000
*                                                                  0760 03112000
*BLDMODSF:                                                         0760 03113000
*   PROC(BLDMFSMD,BLDFLSHC);                                       0760 03114000
BLDMODSF STM   @14,@12,@SA00010                                    0760 03115000
         MVC   @PC00010(8),0(@01)                                  0760 03116000
*   DCL                                                            0761 03117000
*     BLDMFSMD CHAR(*);             /* ICT PTF SECTION ENTRY         */ 03118000
*   DCL                                                            0762 03119000
*     BLDFLSHC FIXED(31);           /* RETURN CODE COLLECTOR         */ 03120000
*   DCL                                                            0763 03121000
*     MM FIXED(15);                 /* INDEX - MOD SECTION ENTRIES   */ 03122000
*   RESPECIFY                                                      0764 03123000
*     ICTPTF BASED(ADDR(BLDMFSMD)); /* ADDRESS SYSMOD PASSED         */ 03124000
*   RESPECIFY                                                      0765 03125000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 03126000
*                                                                  0765 03127000
*   /*****************************************************************/ 03128000
*   /*                                                               */ 03129000
*   /* GO THRU ICT MOD SECTION FOR ELEMENTS FROM "CURRENT" SYSMOD    */ 03130000
*   /*                                                               */ 03131000
*   /*****************************************************************/ 03132000
*                                                                  0766 03133000
*   DO MM=1 BY 1 WHILE ICTMEND(MM)^=ICTENDNT;                      0766 03134000
         LA    MM,1                                                0766 03135000
         B     @DE00766                                            0766 03136000
@DL00766 DS    0H                                                  0767 03137000
*     IF ICTPPTR(MM)=ADDR(ICTPTF(1))/* ELEMENT FROM "CURRENT" SYSMOD */ 03138000
*         &ICTMISEL(MM)=ON          /* SELECTED ELEMENT              */ 03139000
*       THEN                                                       0767 03140000
         LR    @03,MM                                              0767 03141000
         MH    @03,@CH02383                                        0767 03142000
         L     @15,CCAICMOD(,CCAPTR)                               0767 03143000
         L     @14,@PC00010                                        0767 03144000
         LA    @01,0(@03,@15)                                      0767 03145000
         AL    @01,@CF02433                                        0767 03146000
         C     @14,ICTPPTR-96(,@01)                                0767 03147000
         BNE   @RF00767                                            0767 03148000
         ST    @03,@TF00001                                        0767 03149000
         ALR   @03,@15                                             0767 03150000
         AL    @03,@CF02421                                        0767 03151000
         TM    ICTMISEL-11(@03),B'10000000'                        0767 03152000
         BNO   @RF00767                                            0767 03153000
*       DO;                                                        0768 03154000
*                                                                  0768 03155000
*         /***********************************************************/ 03156000
*         /*                                                         */ 03157000
*         /* A SELECTED ELEMENT FROM THE CURRENT SYSMOD ... MAKE IT  */ 03158000
*         /* NOGO ... MAKE IT NOT-SELECTED IF THE SYSMOD HAS NOT     */ 03159000
*         /* OVERLAID ANY MEMBERS ON THE WRK DATASETS                */ 03160000
*         /*                                                         */ 03161000
*         /***********************************************************/ 03162000
*                                                                  0769 03163000
*         ICTMNOGO(MM)=ON;          /* MARK ELEMENT NOGO             */ 03164000
         LR    @03,@15                                             0769 03165000
         AL    @03,@TF00001                                        0769 03166000
         AL    @03,@CF02438                                        0769 03167000
         OI    ICTMNOGO-8(@03),B'01000000'                         0769 03168000
*         IF ICTPWRKO(1)=OFF        /* WRK DATASET MEMBERS NOT     0770 03169000
*                                      OVERLAID                      */ 03170000
*           THEN                                                   0770 03171000
         TM    ICTPWRKO(@14),B'01000000'                           0770 03172000
         BNZ   @RF00770                                            0770 03173000
*           ICTMISEL(MM)=OFF;       /* MARK ELEMENT NOT SELECTED     */ 03174000
*                                                                  0771 03175000
         AL    @15,@TF00001                                        0771 03176000
         AL    @15,@CF02421                                        0771 03177000
         NI    ICTMISEL-11(@15),B'01111111'                        0771 03178000
*         /***********************************************************/ 03179000
*         /*                                                         */ 03180000
*         /* SCRATCH WKRX DATASET MEMBER FOR THIS ELEMENT            */ 03181000
*         /*                                                         */ 03182000
*         /***********************************************************/ 03183000
*                                                                  0772 03184000
*         CALL SCRWRKX(ICTMOD(MM));                                0772 03185000
@RF00770 LR    @03,MM                                              0772 03186000
         MH    @03,@CH02383                                        0772 03187000
         L     @01,CCAICMOD(,CCAPTR)                               0772 03188000
         AL    @01,@CF02422                                        0772 03189000
         LA    @03,ICTMOD(@03,@01)                                 0772 03190000
         ST    @03,@AL00001                                        0772 03191000
         LA    @01,@AL00001                                        0772 03192000
         BAL   @14,SCRWRKX                                         0772 03193000
*       END;                                                       0773 03194000
*   END;                                                           0774 03195000
@RF00767 AL    MM,@CF00065                                         0774 03196000
@DE00766 LR    @03,MM                                              0774 03197000
         MH    @03,@CH02383                                        0774 03198000
         L     @01,CCAICMOD(,CCAPTR)                               0774 03199000
         AL    @01,@CF02422                                        0774 03200000
         L     @03,ICTMEND(@03,@01)                                0774 03201000
         CL    @03,ICTENDNT                                        0774 03202000
         BNE   @DL00766                                            0774 03203000
*   RETURN;                                                        0775 03204000
@EL00010 DS    0H                                                  0775 03205000
@EF00010 DS    0H                                                  0775 03206000
@ER00010 LM    @14,@12,@SA00010                                    0775 03207000
         BR    @14                                                 0775 03208000
*   END BLDMODSF;                                                  0776 03209000
*                                                                  0777 03210000
*/********************************************************************/ 03211000
*/*                                                                  */ 03212000
*/*    MARKSUPS - SET THE ICTPMSL INDICATOR IN ALL ICT PTF SECTION   */ 03213000
*/*               ENTRIES WHICH REPRESENT SYSMODS SUPERSEDED BY THE  */ 03214000
*/*               CALLER-PASSED SYSMOD.                              */ 03215000
*/*                                                                  */ 03216000
*/********************************************************************/ 03217000
*                                                                  0777 03218000
*MARKSUPS:                                                         0777 03219000
*   PROC(MSUPSMD);                                                 0777 03220000
MARKSUPS STM   @14,@12,12(@13)                                     0777 03221000
         MVC   @PC00011(4),0(@01)                                  0777 03222000
*   DCL                                                            0778 03223000
*     MSUPSMD CHAR(*);              /* ICT PTF SECTION ENTRY WHOSE 0778 03224000
*                                      SUPS ARE TO BE PROCESSED      */ 03225000
*   DCL                                                            0779 03226000
*     PTRICTP PTR(31);              /* LOCAL PTR ... POINTS TO FIRST    03227000
*                                      ENTRY IN ICT PTF SECTION      */ 03228000
*   DCL                                                            0780 03229000
*     RR FIXED(15);                 /* LOCAL INDEX ... CURRENT     0780 03230000
*                                      SYSMOD'S SUP LIST ENTRIES     */ 03231000
*   DCL                                                            0781 03232000
*     SS FIXED(15);                 /* LOCAL INDEX ... ICT PTF SECT     03233000
*                                      ENTRY                         */ 03234000
*   RESPECIFY                                                      0782 03235000
*     ICTPTF BASED(ADDR(MSUPSMD));  /* PTF SECT ENTRY PASSED         */ 03236000
*   RESPECIFY                                                      0783 03237000
*     ICTSUPLS BASED(ICTPSCHN(1));  /* SUP LIST ASSOCIATED WITH PTF     03238000
*                                      SECT ENTRY PASSED             */ 03239000
*   PTRICTP=CCAICPTF;               /* INITIALIZE TO FIRST ICT PTF 0784 03240000
*                                      SECT ENTRY                    */ 03241000
*                                                                  0784 03242000
         L     PTRICTP,CCAICPTF(,CCAPTR)                           0784 03243000
*   /*****************************************************************/ 03244000
*   /*                                                               */ 03245000
*   /* GO THRU ALL ENTRIES IN ICT PTF SECTION                        */ 03246000
*   /*                                                               */ 03247000
*   /*****************************************************************/ 03248000
*                                                                  0785 03249000
*   DO SS=1 BY 1 WHILE PTRICTP->ICTPEND(SS)^=ICTENDNT;             0785 03250000
*                                                                  0785 03251000
         LA    SS,1                                                0785 03252000
         B     @DE00785                                            0785 03253000
@DL00785 DS    0H                                                  0786 03254000
*     /***************************************************************/ 03255000
*     /*                                                             */ 03256000
*     /* GO THRU ALL ENTRIES IN SYSMOD'S SUP LIST                    */ 03257000
*     /*                                                             */ 03258000
*     /***************************************************************/ 03259000
*                                                                  0786 03260000
*     DO RR=1 BY 1 WHILE ICTSUPND(RR)^=ICTENDIX;                   0786 03261000
         LA    RR,1                                                0786 03262000
         B     @DE00786                                            0786 03263000
@DL00786 DS    0H                                                  0787 03264000
*       IF PTRICTP->ICTPTFS(SS)=ICTSUPNM(RR)/* ICT SYSMOD SUPD ?     */ 03265000
*         THEN                                                     0787 03266000
         LR    @05,SS                                              0787 03267000
         MH    @05,@CH02382                                        0787 03268000
         LR    @15,RR                                              0787 03269000
         SLA   @15,3                                               0787 03270000
         L     @14,@PC00011                                        0787 03271000
         L     @01,ICTPSCHN(,@14)                                  0787 03272000
         ST    @05,@TF00001                                        0787 03273000
         ALR   @05,PTRICTP                                         0787 03274000
         AL    @05,@CF02417                                        0787 03275000
         ALR   @01,@15                                             0787 03276000
         AL    @01,@CF02434                                        0787 03277000
         CLC   ICTPTFS(7,@05),ICTSUPNM(@01)                        0787 03278000
         BNE   @RF00787                                            0787 03279000
*         DO;                                                      0788 03280000
*                                                                  0788 03281000
*           /*********************************************************/ 03282000
*           /*                                                       */ 03283000
*           /* SYSMOD FOUND IN ICT IS SUPERSEDED BY CURRENT SYSMOD   */ 03284000
*           /*                                                       */ 03285000
*           /*********************************************************/ 03286000
*                                                                  0789 03287000
*           PTRICTP->ICTPMSL(SS)=ON;/* INDICATE "PROCESSED" BY     0789 03288000
*                                      ELEMENT SELECTION PROCEDURE   */ 03289000
         LR    @05,PTRICTP                                         0789 03290000
         AL    @05,@TF00001                                        0789 03291000
         AL    @05,@CF02418                                        0789 03292000
         OI    ICTPMSL-15(@05),B'10000000'                         0789 03293000
*         END;                                                     0790 03294000
*     END;                                                         0791 03295000
@RF00787 AL    RR,@CF00065                                         0791 03296000
@DE00786 LR    @05,RR                                              0791 03297000
         SLA   @05,3                                               0791 03298000
         L     @15,@PC00011                                        0791 03299000
         L     @01,ICTPSCHN(,@15)                                  0791 03300000
         AL    @01,@CF02434                                        0791 03301000
         L     @05,ICTSUPND(@05,@01)                               0791 03302000
         CL    @05,ICTENDIX                                        0791 03303000
         BNE   @DL00786                                            0791 03304000
*   END;                                                           0792 03305000
         AL    SS,@CF00065                                         0792 03306000
@DE00785 LR    @15,SS                                              0792 03307000
         MH    @15,@CH02382                                        0792 03308000
         AL    @15,@CF02417                                        0792 03309000
         L     @15,ICTPEND(@15,PTRICTP)                            0792 03310000
         CL    @15,ICTENDNT                                        0792 03311000
         BNE   @DL00785                                            0792 03312000
*   RETURN;                                                        0793 03313000
@EL00011 DS    0H                                                  0793 03314000
@EF00011 DS    0H                                                  0793 03315000
@ER00011 LM    @14,@12,12(@13)                                     0793 03316000
         BR    @14                                                 0793 03317000
*   END MARKSUPS;                                                  0794 03318000
*                                                                  0795 03319000
*/********************************************************************/ 03320000
*/*                                                                  */ 03321000
*/*    SKIPELEM - READ RECORDS FROM THE PTS MCS MEMBER UNTIL EITHER  */ 03322000
*/*               AN END-OF-FILE OR A RECORD WITH '++' (COLS 1-2) IS */ 03323000
*/*               ENCOUNTERED.                                       */ 03324000
*/*                                                                  */ 03325000
*/*               -  IF AN I/O ERROR IS ENCOUNTERED, SET SKIPRC TO   */ 03326000
*/*                  STOPPTF.                                        */ 03327000
*/*                                                                  */ 03328000
*/*               - IF AN END-OF-FILE IS ENCOUNTERED, SET SKIPRC TO  */ 03329000
*/*                 IOPEOF.                                          */ 03330000
*/*                                                                  */ 03331000
*/*               - IF A "++" RECORD  IS ENCOUNTERED, SET SKIPRC TO  */ 03332000
*/*                 IOPGOOD.                                         */ 03333000
*/*                                                                  */ 03334000
*/*    CONDITIONS UPON ENTRY:                                        */ 03335000
*/*                                                                  */ 03336000
*/*     * SKIPRC   - PROCESS CONTROL PARAMETER ... MAY BE NON-ZERO   */ 03337000
*/*                                                                  */ 03338000
*/********************************************************************/ 03339000
*                                                                  0795 03340000
*SKIPELEM:                                                         0795 03341000
*   PROC(SKIPRC);                                                  0795 03342000
SKIPELEM STM   @14,@12,@SA00012                                    0795 03343000
         MVC   @PC00012(4),0(@01)                                  0795 03344000
*   DCL                                                            0796 03345000
*     SKIPRC FIXED(31);             /* RETURN CODE COLLECTOR         */ 03346000
*   DCL                                                            0797 03347000
*     SKIPLOOP CHAR(1);             /* LOOP CONTROL SWITCH           */ 03348000
*                                                                  0797 03349000
*   /*****************************************************************/ 03350000
*   /*                                                               */ 03351000
*   /* READ RECORDS USING HMASMCRP (INTO CRPBUFFR) UNTIL NON-ZERO    */ 03352000
*   /* RETURN CODE OR A ++ IS FOUND IN FIRST TWO COLUMNS.            */ 03353000
*   /*                                                               */ 03354000
*   /*****************************************************************/ 03355000
*                                                                  0798 03356000
*   SKIPLOOP=YES;                   /* SET LOOP CONTROL SWITCH       */ 03357000
         MVI   SKIPLOOP,C'Y'                                       0798 03358000
*   DO WHILE SKIPLOOP=YES;                                         0799 03359000
         B     @DE00799                                            0799 03360000
@DL00799 DS    0H                                                  0800 03361000
*     CRPBFPRM=OFF;                 /* BUFFER NOT PRIMED             */ 03362000
*     CRPSCNCL=OFF;                 /* NOT A CALL FROM HMASMSCN      */ 03363000
         NI    CRPBFPRM,B'01111110'                                0801 03364000
*     CALL HMASMCRD(HMASMCRP);                                     0802 03365000
         L     @15,@CV01885                                        0802 03366000
         LA    @01,@AL00802                                        0802 03367000
         BALR  @14,@15                                             0802 03368000
*     IF CRPRETRN^=CRPGOOD THEN                                    0803 03369000
         CLI   CRPRETRN,0                                          0803 03370000
         BE    @RF00803                                            0803 03371000
*       SKIPLOOP=NO;                /* ERROR OR EOF ... STOP LOOP    */ 03372000
         MVI   SKIPLOOP,C'N'                                       0804 03373000
*     ELSE                                                         0805 03374000
*       IF CRPBUFFR(1:2)='++' THEN                                 0805 03375000
         B     @RC00803                                            0805 03376000
@RF00803 CLC   CRPBUFFR(2),@CC02184                                0805 03377000
         BNE   @RF00805                                            0805 03378000
*         SKIPLOOP=NO;              /* NEXT MCS FOUND ... STOP LOOP  */ 03379000
         MVI   SKIPLOOP,C'N'                                       0806 03380000
*   END;                                                           0807 03381000
@RF00805 DS    0H                                                  0807 03382000
@RC00803 DS    0H                                                  0807 03383000
@DE00799 CLI   SKIPLOOP,C'Y'                                       0807 03384000
         BE    @DL00799                                            0807 03385000
*   IF CRPRETRN=CRPEOF              /* END-OF-FILE ENCOUNTERED       */ 03386000
*     THEN                                                         0808 03387000
         CLI   CRPRETRN,4                                          0808 03388000
         BNE   @RF00808                                            0808 03389000
*     MCSEOF=ON;                    /* SET END-OF-FILE FLAG          */ 03390000
         OI    MCSEOF,B'00010000'                                  0809 03391000
*   ELSE                                                           0810 03392000
*     SKIPRC=MAX(SKIPRC,CRPRETRN);  /* MAINTAIN RETURN CODE          */ 03393000
         B     @RC00808                                            0810 03394000
@RF00808 L     @15,@PC00012                                        0810 03395000
         L     @14,SKIPRC(,@15)                                    0810 03396000
         SLR   @07,@07                                             0810 03397000
         IC    @07,CRPRETRN                                        0810 03398000
         CR    @14,@07                                             0810 03399000
         BNL   *+6                                                      03400000
         LR    @14,@07                                             0810 03401000
         ST    @14,SKIPRC(,@15)                                    0810 03402000
*   RETURN;                                                        0811 03403000
@EL00012 DS    0H                                                  0811 03404000
@EF00012 DS    0H                                                  0811 03405000
@ER00012 LM    @14,@12,@SA00012                                    0811 03406000
         BR    @14                                                 0811 03407000
*   END SKIPELEM;                                                  0812 03408000
         B     @EL00012                                            0812 03409000
*                                                                  0813 03410000
*/********************************************************************/ 03411000
*/*                                                                  */ 03412000
*/*    WRKCHK   - CHECK THE ICT MOD SECTION TO DETERMINE WHETHER THE */ 03413000
*/*               ELEMENT PASSED (ELEMENT_NAME/ELEMENT_TYPE PAIR)    */ 03414000
*/*               CAN BE MOVED TO A WRK DATASET.                     */ 03415000
*/*                                                                  */ 03416000
*/*    CONDITIONS UPON ENTRY:                                        */ 03417000
*/*                                                                  */ 03418000
*/*     *                                                            */ 03419000
*/*                                                                  */ 03420000
*/********************************************************************/ 03421000
*                                                                  0813 03422000
*WRKCHK:                                                           0813 03423000
*   PROC(ELNAME,ELTYPE,ANSWRKC);                                   0813 03424000
WRKCHK   STM   @14,@12,12(@13)                                     0813 03425000
         MVC   @PC00013(12),0(@01)                                 0813 03426000
*   DCL                                                            0814 03427000
*     ELNAME CHAR(8);               /* ELEMENT NAME                  */ 03428000
*   DCL                                                            0815 03429000
*     ELTYPE BIT(8);                /* ELEMENT TYPE (VALUES AS IN  0815 03430000
*                                      ICTMFLG1)                     */ 03431000
*   DCL                                                            0816 03432000
*     ANSWRKC CHAR(1);              /* RETURNS "YES" IF THE ELEMENT     03433000
*                                      CAN BE MOVED ... RETURNS "NO"    03434000
*                                      IF NOT                        */ 03435000
*   DCL                                                            0817 03436000
*     NN FIXED(15);                 /* LOCAL INDEX ... ICT MOD SECT     03437000
*                                      ENTRIES                       */ 03438000
*   RESPECIFY                                                      0818 03439000
*     ICTMOD BASED(CCAICMOD);       /* SET UP ADDRESSIBILITY TO THE     03440000
*                                      ENTIRE ICT MOD SECTION        */ 03441000
*                                                                  0818 03442000
*   /*****************************************************************/ 03443000
*   /*                                                               */ 03444000
*   /* LOOK THRU THE ICT MOD SECTION FOR ANOTHER VERSION OF THE SAME */ 03445000
*   /* ELEMENT_NAME/ELEMENT_TYPE AS ELNAME/ELTYPE                    */ 03446000
*   /*                                                               */ 03447000
*   /*****************************************************************/ 03448000
*                                                                  0819 03449000
*   ANSWRKC=YES;                    /* INITIALLY SET TO "OK TO MOVE     03450000
*                                      THIS ELEMENT"                 */ 03451000
         L     @15,@PC00013+8                                      0819 03452000
         MVI   ANSWRKC(@15),C'Y'                                   0819 03453000
*   DO NN=1 BY 1 WHILE ICTMEND(NN)^=ICTENDNT&ANSWRKC=YES;          0820 03454000
         LA    NN,1                                                0820 03455000
         B     @DE00820                                            0820 03456000
@DL00820 DS    0H                                                  0821 03457000
*     IF ICTMNAME(NN)=ELNAME        /* COMPARE ELEMENT NAME          */ 03458000
*         &ICTMFLG1(NN)=ELTYPE      /* COMPARE ELEMENT TYPE          */ 03459000
*         &ICTMWRK(NN)=ON           /* CHK IF MOVED TO WRK DATASET   */ 03460000
*       THEN                                                       0821 03461000
         LR    @03,NN                                              0821 03462000
         MH    @03,@CH02383                                        0821 03463000
         L     @15,CCAICMOD(,CCAPTR)                               0821 03464000
         L     @14,@PC00013                                        0821 03465000
         ST    @03,@TF00001                                        0821 03466000
         ALR   @03,@15                                             0821 03467000
         AL    @03,@CF02422                                        0821 03468000
         CLC   ICTMNAME(8,@03),ELNAME(@14)                         0821 03469000
         BNE   @RF00821                                            0821 03470000
         L     @03,@PC00013+4                                      0821 03471000
         LR    @14,@15                                             0821 03472000
         AL    @14,@TF00001                                        0821 03473000
         AL    @14,@CF02420                                        0821 03474000
         CLC   ICTMFLG1-9(1,@14),ELTYPE(@03)                       0821 03475000
         BNE   @RF00821                                            0821 03476000
         AL    @15,@TF00001                                        0821 03477000
         AL    @15,@CF02439                                        0821 03478000
         TM    ICTMWRK-10(@15),B'00001000'                         0821 03479000
         BNO   @RF00821                                            0821 03480000
*       DO;                                                        0822 03481000
*                                                                  0822 03482000
*         /***********************************************************/ 03483000
*         /*                                                         */ 03484000
*         /* ANOTHER VERSION OF THIS SAME ELEMENT IS ON A WRK DATASET*/ 03485000
*         /* ... THIS VERSION OF THE ELEMENT CANNOT BE MOVED NOW     */ 03486000
*         /*                                                         */ 03487000
*         /***********************************************************/ 03488000
*                                                                  0823 03489000
*         ANSWRKC=NO;               /* SET RETURN PARM ... "CANNOT BE   03490000
*                                      MOVED"                        */ 03491000
         L     @03,@PC00013+8                                      0823 03492000
         MVI   ANSWRKC(@03),C'N'                                   0823 03493000
*       END;                                                       0824 03494000
*   END;                                                           0825 03495000
@RF00821 AL    NN,@CF00065                                         0825 03496000
@DE00820 LR    @03,NN                                              0825 03497000
         MH    @03,@CH02383                                        0825 03498000
         L     @01,CCAICMOD(,CCAPTR)                               0825 03499000
         AL    @01,@CF02422                                        0825 03500000
         L     @03,ICTMEND(@03,@01)                                0825 03501000
         CL    @03,ICTENDNT                                        0825 03502000
         BE    @DC00820                                            0825 03503000
         L     @03,@PC00013+8                                      0825 03504000
         CLI   ANSWRKC(@03),C'Y'                                   0825 03505000
         BE    @DL00820                                            0825 03506000
@DC00820 DS    0H                                                  0826 03507000
*   RETURN;                                                        0826 03508000
@EL00013 DS    0H                                                  0826 03509000
@EF00013 DS    0H                                                  0826 03510000
@ER00013 LM    @14,@12,12(@13)                                     0826 03511000
         BR    @14                                                 0826 03512000
*   END WRKCHK;                                                    0827 03513000
*                                                                  0828 03514000
*/********************************************************************/ 03515000
*/*                                                                  */ 03516000
*/*    XPNDZAP  - BUILD AN ICT MOD SECTION ENTRY FOR A MODULE        */ 03517000
*/*               WHICH MUST BE LINKEDITED AND EXPANDED FOR A ZAP    */ 03518000
*/*                                                                  */ 03519000
*/*                                                                  */ 03520000
*/*    CONDITIONS UPON ENTRY:                                        */ 03521000
*/*                                                                  */ 03522000
*/*     * XPNDRC   - RETURN CODE PARAMETER PASSED ... MAY BE NON-ZERO*/ 03523000
*/*                                                                  */ 03524000
*/********************************************************************/ 03525000
*                                                                  0828 03526000
*XPNDZAP:                                                          0828 03527000
*   PROC(ZAPMOD@,ZAPPTF@,XPNDRC);                                  0828 03528000
XPNDZAP  STM   @14,@12,@SA00014                                    0828 03529000
         MVC   @PC00014(12),0(@01)                                 0828 03530000
*   DCL                                                            0829 03531000
*     ZAPMOD@ PTR(31);              /* PTR TO ICT MOD SECT ENTRY FOR    03532000
*                                      ZAP ELEMENT                   */ 03533000
*   DCL                                                            0830 03534000
*     ZAPPTF@ PTR(31);              /* PTR TO ICT PTF SECT ENTRY FOR    03535000
*                                      ZAP ELEMENT                   */ 03536000
*   DCL                                                            0831 03537000
*     XPNDRC FIXED(31);             /* MAX RETURN CODE COLLECTOR     */ 03538000
*   DCL                                                            0832 03539000
*     XPNDPTR PTR(31);              /* LOCAL PTR TO ENTRY BUILT      */ 03540000
*   RESPECIFY                                                      0833 03541000
*     ICTMOD BASED(ZAPMOD@);        /* ADDRESS MOD SECT ENTRY        */ 03542000
*   RESPECIFY                                                      0834 03543000
*     ICTPTF BASED(ZAPPTF@);        /* ADDRESS PTF SECT ENTRY        */ 03544000
*                                                                  0834 03545000
*   /*****************************************************************/ 03546000
*   /*                                                               */ 03547000
*   /* OBTAIN ICT MOD SECTION ENTRY FOR EXPAND LINK EDIT             */ 03548000
*   /*                                                               */ 03549000
*   /*****************************************************************/ 03550000
*                                                                  0835 03551000
*   ICTMXPND(1)=OFF;                /* TURN OFF BIT SET BY HMASMTMW  */ 03552000
         L     @15,@PC00014                                        0835 03553000
         L     @15,ZAPMOD@(,@15)                                   0835 03554000
         NI    ICTMXPND(@15),B'11101111'                           0835 03555000
*   XPNDPTR=TBLXTOP;                /* ADDR OF ENTRY TO BE OBTAINED  */ 03556000
         L     @14,@PC00001                                        0836 03557000
         MVC   XPNDPTR(4),TBLXTOP(@14)                             0836 03558000
*   CALL HMASMTAD(TBLXPARM,         /* PARM LIST                     */ 03559000
*       'M',                        /* BUILD MOD SECTION ENTRY       */ 03560000
*       ICTMNAME);                  /* ENTRY NAME                    */ 03561000
         ST    @14,@AL00001                                        0837 03562000
         LA    @14,@CC00717                                        0837 03563000
         ST    @14,@AL00001+4                                      0837 03564000
         ST    @15,@AL00001+8                                      0837 03565000
         L     @15,@CV01891                                        0837 03566000
         LA    @01,@AL00001                                        0837 03567000
         BALR  @14,@15                                             0837 03568000
*   RESPECIFY                                                      0838 03569000
*     REG15 RSTD;                                                  0838 03570000
*   XPNDRC=MAX(XPNDRC,REG15);       /* MAINTAIN RETURN CODE          */ 03571000
         L     @14,@PC00014+8                                      0839 03572000
         L     @07,XPNDRC(,@14)                                    0839 03573000
         CR    @07,REG15                                           0839 03574000
         BNL   *+6                                                      03575000
         LR    @07,REG15                                           0839 03576000
         ST    @07,XPNDRC(,@14)                                    0839 03577000
*   RESPECIFY                                                      0840 03578000
*     REG15 UNRSTD;                                                0840 03579000
*   IF XPNDRC<STOPPTF THEN                                         0841 03580000
         CH    @07,@CH00033                                        0841 03581000
         BNL   @RF00841                                            0841 03582000
*     DO;                                                          0842 03583000
*                                                                  0842 03584000
*       /*************************************************************/ 03585000
*       /*                                                           */ 03586000
*       /* INITIALIZE MOD SECTION ENTRY OBTAINED TO REPRESENT THE    */ 03587000
*       /* LINKEDIT REQUIRED TO EXPAND THE MODULE                    */ 03588000
*       /*                                                           */ 03589000
*       /*************************************************************/ 03590000
*                                                                  0843 03591000
*       RESPECIFY                                                  0843 03592000
*         ICTMOD BASED(XPNDPTR);    /* ADDRESS MOD SECT JUST OBTAINED*/ 03593000
*       CALL HMASMTM1(TBLXPARM,     /* PARM LIST                     */ 03594000
*           XPNDPTR,                /* PTR TO MOD SECT ENTRY         */ 03595000
*           ZAPPTF@,                /* PTR TO PTF SECT ENTRY         */ 03596000
*           MCBPTR);                /* PTR TO INITIALIZED MCB        */ 03597000
         L     @15,@PC00001                                        0844 03598000
         ST    @15,@AL00001                                        0844 03599000
         LA    @15,XPNDPTR                                         0844 03600000
         ST    @15,@AL00001+4                                      0844 03601000
         L     @15,@PC00014+4                                      0844 03602000
         ST    @15,@AL00001+8                                      0844 03603000
         LA    @15,MCBPTR                                          0844 03604000
         ST    @15,@AL00001+12                                     0844 03605000
         L     @15,@CV01896                                        0844 03606000
         LA    @01,@AL00001                                        0844 03607000
         BALR  @14,@15                                             0844 03608000
*       RESPECIFY                                                  0845 03609000
*         REG15 RSTD;                                              0845 03610000
*       XPNDRC=MAX(XPNDRC,REG15);   /* MAINTAIN RETURN CODE          */ 03611000
         L     @14,@PC00014+8                                      0846 03612000
         L     @07,XPNDRC(,@14)                                    0846 03613000
         CR    @07,REG15                                           0846 03614000
         BNL   *+6                                                      03615000
         LR    @07,REG15                                           0846 03616000
         ST    @07,XPNDRC(,@14)                                    0846 03617000
*       RESPECIFY                                                  0847 03618000
*         REG15 UNRSTD;             /*                               */ 03619000
*       ICTMMOD(1)=OFF;             /* CLEAR MOD-REPL INDICATOR      */ 03620000
*       ICTMZAP(1)=OFF;             /* CLEAR MOD-ZAP INDICATOR       */ 03621000
*       ICTMXPND(1)=ON;             /* SET EXPAND ZAP FLAG           */ 03622000
         L     @15,XPNDPTR                                         0850 03623000
         OI    ICTMXPND(@15),B'00010000'                           0850 03624000
         NI    ICTMMOD(@15),B'01011111'                            0850 03625000
*       ICTFMLIB(1)='SMPWRK4 ';     /* SMPWRK4 CONTAINS EXPAND STMTS.*/ 03626000
         MVC   ICTFMLIB(8,@15),@CC02209                            0851 03627000
*       ICTMFMID(1)=ICTPFMID(1);    /* FMID IS SYSMOD'S FMID         */ 03628000
         L     @14,@PC00014+4                                      0852 03629000
         L     @01,ZAPPTF@(,@14)                                   0852 03630000
         MVC   ICTMFMID(7,@15),ICTPFMID(@01)                       0852 03631000
*       ICTMRMID(1)=NULLPTF#;       /* RMID IS NOT APPLICABLE ... AN    03632000
*                                      EXPAND ZAP DOES NOT CHANGE  0853 03633000
*                                      ELEMENT'S RMID                */ 03634000
         MVC   ICTMRMID(7,@15),@CC01944                            0853 03635000
*     END;                                                         0854 03636000
*   RETURN;                                                        0855 03637000
@EL00014 DS    0H                                                  0855 03638000
@EF00014 DS    0H                                                  0855 03639000
@ER00014 LM    @14,@12,@SA00014                                    0855 03640000
         BR    @14                                                 0855 03641000
*   END XPNDZAP;                                                   0856 03642000
         B     @EL00014                                            0856 03643000
*                                                                  0857 03644000
*/********************************************************************/ 03645000
*/*                                                                  */ 03646000
*/*    LOCMCS   - LOCATE PTS MCS MEMBER                              */ 03647000
*/*                                                                  */ 03648000
*/*             - RE-INITIALIZE HMASMCRD AND HMASMMPD PARM LISTS     */ 03649000
*/*                                                                  */ 03650000
*/*    CONDITIONS UPON ENTRY:                                        */ 03651000
*/*                                                                  */ 03652000
*/*     * PTRIOP1  - PTR TO IOP TO BE USED TO ACCESS MCS MEMBER      */ 03653000
*/*                                                                  */ 03654000
*/********************************************************************/ 03655000
*                                                                  0857 03656000
*LOCMCS:                                                           0857 03657000
*   PROC(MEMBR,LOCRC);                                             0857 03658000
LOCMCS   STM   @14,@12,@SA00015                                    0857 03659000
         MVC   @PC00015(8),0(@01)                                  0857 03660000
*   DCL                                                            0858 03661000
*     MEMBR CHAR(7);                /* PTS MCS MEMBER NAME           */ 03662000
*   DCL                                                            0859 03663000
*     LOCRC FIXED(31);              /* RETURN CODE COLLECTOR         */ 03664000
*   RESPECIFY                                                      0860 03665000
*     HMASMIOP BASED(PTRIOP1);      /* IOP USED TO ACCESS PTS        */ 03666000
*   MCSEOF=OFF;                     /* CLEAR MCS MEMBER END-OF-FILE     03667000
*                                      FLAG                          */ 03668000
*                                                                  0861 03669000
         NI    MCSEOF,B'11101111'                                  0861 03670000
*   /*****************************************************************/ 03671000
*   /*                                                               */ 03672000
*   /* CLOSE SMPPTS DATASET                                          */ 03673000
*   /*                                                               */ 03674000
*   /*****************************************************************/ 03675000
*                                                                  0862 03676000
*   HMASMIOP=''B;                   /* CLEAR IOP                     */ 03677000
         XC    HMASMIOP(68,PTRIOP1),HMASMIOP(PTRIOP1)              0862 03678000
*   IOPDSID=IOPPTS;                 /* SMPPTS DATASET                */ 03679000
         MVI   IOPDSID(PTRIOP1),X'06'                              0863 03680000
*   IOPFUNCT=IOPCLOSE;              /* CLOSE DATASET                 */ 03681000
         MVI   IOPFUNCT(PTRIOP1),X'50'                             0864 03682000
*   CALL HMASMIO(HMASMIOP);                                        0865 03683000
*                                                                  0865 03684000
         ST    PTRIOP1,@AL00001                                    0865 03685000
         L     @15,@CV01886                                        0865 03686000
         LA    @01,@AL00001                                        0865 03687000
         BALR  @14,@15                                             0865 03688000
*   /*****************************************************************/ 03689000
*   /*                                                               */ 03690000
*   /* LOCATE SYSMOD MCS ENTRY ON THE PTS DATASET                    */ 03691000
*   /*                                                               */ 03692000
*   /*****************************************************************/ 03693000
*                                                                  0866 03694000
*   IOPDSID=IOPPTS;                 /* SMPPTS DATASET                */ 03695000
         MVI   IOPDSID(PTRIOP1),X'06'                              0866 03696000
*   IOPNAME=' ';                    /* BLANK NAME FIELD              */ 03697000
         MVI   IOPNAME+1(PTRIOP1),C' '                             0867 03698000
         MVC   IOPNAME+2(6,PTRIOP1),IOPNAME+1(PTRIOP1)             0867 03699000
         MVI   IOPNAME(PTRIOP1),C' '                               0867 03700000
*   IOPNAM17=MEMBR;                 /* SYSMOD NAME IS ENTRY TO LOCATE   03701000
*                                      ON PTS                        */ 03702000
         L     @03,@PC00015                                        0868 03703000
         MVC   IOPNAM17(7,PTRIOP1),MEMBR(@03)                      0868 03704000
*   IOPTYPE=IOPMCS;                 /* ENTRY TYPE IS MCS             */ 03705000
         MVI   IOPTYPE(PTRIOP1),X'10'                              0869 03706000
*   IOPFUNCT=IOPBLDL;               /* DO BLDL TO SET UP FOR       0870 03707000
*                                      PROCESSING RECORDS            */ 03708000
         MVI   IOPFUNCT(PTRIOP1),X'04'                             0870 03709000
*   CALL HMASMIO(HMASMIOP);                                        0871 03710000
         ST    PTRIOP1,@AL00001                                    0871 03711000
         L     @15,@CV01886                                        0871 03712000
         LA    @01,@AL00001                                        0871 03713000
         BALR  @14,@15                                             0871 03714000
*   IF IOPRETRN=IOPGOOD THEN                                       0872 03715000
         CLI   IOPRETRN(PTRIOP1),0                                 0872 03716000
         BNE   @RF00872                                            0872 03717000
*     DO;                                                          0873 03718000
*                                                                  0873 03719000
*       /*************************************************************/ 03720000
*       /*                                                           */ 03721000
*       /* PTS MCS ENTRY FOUND FOR SYSMOD                            */ 03722000
*       /*                                                           */ 03723000
*       /*************************************************************/ 03724000
*                                                                  0874 03725000
*       IOPFUNCT=IOPPOSI;           /* POSITION TO MEMBER RECORDS    */ 03726000
         MVI   IOPFUNCT(PTRIOP1),X'02'                             0874 03727000
*       CALL HMASMIO(HMASMIOP);                                    0875 03728000
         ST    PTRIOP1,@AL00001                                    0875 03729000
         L     @15,@CV01886                                        0875 03730000
         LA    @01,@AL00001                                        0875 03731000
         BALR  @14,@15                                             0875 03732000
*       IF IOPRETRN=IOPGOOD THEN                                   0876 03733000
         CLI   IOPRETRN(PTRIOP1),0                                 0876 03734000
         BNE   @RF00876                                            0876 03735000
*         DO;                                                      0877 03736000
*                                                                  0877 03737000
*           /*********************************************************/ 03738000
*           /*                                                       */ 03739000
*           /* SUCCESSFULLY POSITIONED TO RECORDS CONTAINING THE     */ 03740000
*           /* MODIFICATION CONTROL STATEMENTS FOR THE SYSMOD        */ 03741000
*           /*                                                       */ 03742000
*           /*********************************************************/ 03743000
*                                                                  0878 03744000
*                                                                  0878 03745000
*           /*********************************************************/ 03746000
*           /*                                                       */ 03747000
*           /* SET UP HMASMCRD PARM LIST (HMASMCRP) AND HMASMMPD PARM*/ 03748000
*           /* LIST (HMASMMPP)                                       */ 03749000
*           /*                                                       */ 03750000
*           /*********************************************************/ 03751000
*                                                                  0878 03752000
*           HMASMCRP=''B;           /* CLEAR PARM LIST               */ 03753000
         XC    HMASMCRP(106),HMASMCRP                              0878 03754000
*           CRPINDS=IOPPTS;         /* INPUT DATASET IS SMPPTS       */ 03755000
         MVI   CRPINDS,X'06'                                       0879 03756000
*           CRPBFPRM=OFF;           /* BUFFER NOT PRIMED             */ 03757000
*           CRPPTS=OFF;             /* DO NOT WRITE TO PTS           */ 03758000
*           CRPLOG=OFF;             /* DO NOT WRITE TO LOG           */ 03759000
*           CRPPRINT=OFF;           /* DO NOT WRITE TO OUT           */ 03760000
*           CRPOTHER=OFF;           /* DO NOT WRITE TO CRDOUTDS      */ 03761000
         NI    CRPBFPRM,B'01000011'                                0884 03762000
*           CRPUXNUM=0;             /* NO USER EXIT                  */ 03763000
         MVI   CRPUXNUM,X'00'                                      0885 03764000
*           CRPSCNCL=OFF;           /* NOT A CALL FROM HMASMSCN      */ 03765000
         NI    CRPSCNCL,B'11111110'                                0886 03766000
*           CRPSCPAD=0;             /* NO SCP IS PASSED              */ 03767000
         SLR   @15,@15                                             0887 03768000
         ST    @15,CRPSCPAD                                        0887 03769000
*           MPPMCBAD=MCBPTR;        /* POINT TO MCB                  */ 03770000
         MVC   MPPMCBAD(4),MCBPTR                                  0888 03771000
*           MPPCRDAD=ADDR(HMASMCRD);/* GET ROUTINE FOR USE BY MPD    */ 03772000
         L     @15,@CV01885                                        0889 03773000
         ST    @15,MPPCRDAD                                        0889 03774000
*           MPPCRDPM=ADDR(HMASMCRP);/* GET ROUTINE PARM LIST         */ 03775000
         LA    @15,HMASMCRP                                        0890 03776000
         ST    @15,MPPCRDPM                                        0890 03777000
*         END;                                                     0891 03778000
*       ELSE                                                       0892 03779000
*         DO;                                                      0892 03780000
*                                                                  0892 03781000
         B     @RC00876                                            0892 03782000
@RF00876 DS    0H                                                  0893 03783000
*           /*********************************************************/ 03784000
*           /*                                                       */ 03785000
*           /* COULD NOT POSITION TO RECORDS IN PTS MCS MEMBER ...   */ 03786000
*           /* ISSUE: HMA246I/PART011                                */ 03787000
*           /*                                                       */ 03788000
*           /*********************************************************/ 03789000
*                                                                  0893 03790000
*           LOCRC=STOPPTF;          /* SET RETURN CODE               */ 03791000
         L     @03,@PC00015+4                                      0893 03792000
         LA    @15,8                                               0893 03793000
         ST    @15,LOCRC(,@03)                                     0893 03794000
*           LOCRC=MAX(LOCRC,IOPRETRN);/* IN CASE HIGHER              */ 03795000
         SLR   @14,@14                                             0894 03796000
         IC    @14,IOPRETRN(,PTRIOP1)                              0894 03797000
         CR    @15,@14                                             0894 03798000
         BNL   *+6                                                      03799000
         LR    @15,@14                                             0894 03800000
         ST    @15,LOCRC(,@03)                                     0894 03801000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 03802000
         MVI   MGPTYPE,X'03'                                       0895 03803000
*           CALL ERRMSG(HMA246I,PART011);                          0896 03804000
         LA    @01,@AL00896                                        0896 03805000
         BAL   @14,ERRMSG                                          0896 03806000
*         END;                                                     0897 03807000
*     END;                                                         0898 03808000
*   ELSE                                                           0899 03809000
*     DO;                                                          0899 03810000
*                                                                  0899 03811000
         B     @RC00872                                            0899 03812000
@RF00872 DS    0H                                                  0900 03813000
*       /*************************************************************/ 03814000
*       /*                                                           */ 03815000
*       /* COULD NOT DO BLDL TO LOCATE PTS MCS ENTRY (EITHER NOT     */ 03816000
*       /* FOUND OR I/O ERROR) ... ISSUE: HMA246I/PART011            */ 03817000
*       /*                                                           */ 03818000
*       /*************************************************************/ 03819000
*                                                                  0900 03820000
*       LOCRC=STOPPTF;              /* SET RETURN CODE               */ 03821000
         L     @03,@PC00015+4                                      0900 03822000
         LA    @15,8                                               0900 03823000
         ST    @15,LOCRC(,@03)                                     0900 03824000
*       LOCRC=MAX(LOCRC,IOPRETRN);  /* IN CASE HIGHER                */ 03825000
         SLR   @14,@14                                             0901 03826000
         IC    @14,IOPRETRN(,PTRIOP1)                              0901 03827000
         CR    @15,@14                                             0901 03828000
         BNL   *+6                                                      03829000
         LR    @15,@14                                             0901 03830000
         ST    @15,LOCRC(,@03)                                     0901 03831000
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */ 03832000
         MVI   MGPTYPE,X'03'                                       0902 03833000
*       CALL ERRMSG(HMA246I,PART011);                              0903 03834000
         LA    @01,@AL00903                                        0903 03835000
         BAL   @14,ERRMSG                                          0903 03836000
*     END;                                                         0904 03837000
*   RETURN;                                                        0905 03838000
@EL00015 DS    0H                                                  0905 03839000
@EF00015 DS    0H                                                  0905 03840000
@ER00015 LM    @14,@12,@SA00015                                    0905 03841000
         BR    @14                                                 0905 03842000
*   END LOCMCS;                                                    0906 03843000
         B     @EL00015                                            0906 03844000
*                                                                  0907 03845000
*/********************************************************************/ 03846000
*/*                                                                  */ 03847000
*/*    SRCHICTM - SEARCH THE ICT MOD SECTION ENTRIES FOR THE CALLER  */ 03848000
*/*               SPECIFIED ELEMENT_NAME/ELEMENT_TYPE/SYSMOD         */ 03849000
*/*               COMBINATION.                                       */ 03850000
*/*                                                                  */ 03851000
*/*    CONDITIONS UPON ENTRY:                                        */ 03852000
*/*                                                                  */ 03853000
*/*     *                                                            */ 03854000
*/*                                                                  */ 03855000
*/********************************************************************/ 03856000
*                                                                  0907 03857000
*SRCHICTM:                                                         0907 03858000
*   PROC(ELMNAME,ELMCBTY,SMDNAME,RTNPTR);                          0907 03859000
SRCHICTM STM   @14,@12,12(@13)                                     0907 03860000
         MVC   @PC00016(16),0(@01)                                 0907 03861000
*   DCL                                                            0908 03862000
*     ELMNAME CHAR(8);              /* ELEMENT NAME                  */ 03863000
*   DCL                                                            0909 03864000
*     ELMCBTY FIXED(8);             /* ELEMENT TYPE (MCBTYPE VALUES) */ 03865000
*   DCL                                                            0910 03866000
*     SMDNAME CHAR(7);              /* SYSMOD NAME                   */ 03867000
*   DCL                                                            0911 03868000
*     RTNPTR PTR(31);               /* RETURNS PTR TO ICT MOD SECT 0911 03869000
*                                      ENTRY FOUND (OR ZERO)         */ 03870000
*   DCL                                                            0912 03871000
*     QQ FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/ 03872000
*   DCL                                                            0913 03873000
*     SSMDPTR PTR(31);              /* LOCAL PTR TO PTF SECT ENTRY   */ 03874000
*   RESPECIFY                                                      0914 03875000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */ 03876000
*   RTNPTR=0;                       /* CLEAR RETURN POINTER          */ 03877000
*                                                                  0915 03878000
         L     @15,@PC00016+12                                     0915 03879000
         SLR   @14,@14                                             0915 03880000
         ST    @14,RTNPTR(,@15)                                    0915 03881000
*   /*****************************************************************/ 03882000
*   /*                                                               */ 03883000
*   /* GO THRU THE ICT MOD SECTION                                   */ 03884000
*   /*                                                               */ 03885000
*   /*****************************************************************/ 03886000
*                                                                  0916 03887000
*   DO QQ=1 BY 1 WHILE ICTMEND(QQ)^=ICTENDNT&RTNPTR=0;             0916 03888000
         LA    QQ,1                                                0916 03889000
         B     @DE00916                                            0916 03890000
@DL00916 DS    0H                                                  0917 03891000
*     IF ICTMNAME(QQ)=ELMNAME THEN                                 0917 03892000
         LR    @03,QQ                                              0917 03893000
         MH    @03,@CH02383                                        0917 03894000
         L     @15,CCAICMOD(,CCAPTR)                               0917 03895000
         L     @14,@PC00016                                        0917 03896000
         ST    @03,@TF00001                                        0917 03897000
         ALR   @03,@15                                             0917 03898000
         AL    @03,@CF02422                                        0917 03899000
         CLC   ICTMNAME(8,@03),ELMNAME(@14)                        0917 03900000
         BNE   @RF00917                                            0917 03901000
*       DO;                                                        0918 03902000
*         SSMDPTR=0;                /* CLEAR PTR TO PTF SECT ENTRY   */ 03903000
         SLR   SSMDPTR,SSMDPTR                                     0919 03904000
*         IF ELMCBTY=MCBMODTP       /* ++MOD TYPE PASSED             */ 03905000
*             &ICTMMOD(QQ)=ON       /* ++MOD TYPE IN ICT             */ 03906000
*           THEN                                                   0920 03907000
         L     @14,@PC00016+4                                      0920 03908000
         CLI   ELMCBTY(@14),4                                      0920 03909000
         BNE   @RF00920                                            0920 03910000
         LR    @14,@15                                             0920 03911000
         AL    @14,@TF00001                                        0920 03912000
         AL    @14,@CF02420                                        0920 03913000
         TM    ICTMMOD-9(@14),B'10000000'                          0920 03914000
         BNO   @RF00920                                            0920 03915000
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */ 03916000
         L     @14,@TF00001                                        0921 03917000
         AL    @15,@CF02433                                        0921 03918000
         L     SSMDPTR,ICTPPTR-96(@14,@15)                         0921 03919000
*         IF ELMCBTY=MCBZAPTP       /* ++ZAP TYPE PASSED             */ 03920000
*             &ICTMZAP(QQ)=ON       /* ++ZAP TYPE IN ICT             */ 03921000
*           THEN                                                   0922 03922000
@RF00920 L     @15,@PC00016+4                                      0922 03923000
         CLI   ELMCBTY(@15),7                                      0922 03924000
         BNE   @RF00922                                            0922 03925000
         LR    @15,QQ                                              0922 03926000
         MH    @15,@CH02383                                        0922 03927000
         L     @14,CCAICMOD(,CCAPTR)                               0922 03928000
         ST    @15,@TF00001                                        0922 03929000
         ALR   @15,@14                                             0922 03930000
         AL    @15,@CF02420                                        0922 03931000
         TM    ICTMZAP-9(@15),B'00100000'                          0922 03932000
         BNO   @RF00922                                            0922 03933000
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */ 03934000
         L     @15,@TF00001                                        0923 03935000
         AL    @14,@CF02433                                        0923 03936000
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0923 03937000
*         IF ELMCBTY=MCBMCRTP       /* ++MAC TYPE PASSED             */ 03938000
*             &ICTMMACR(QQ)=ON      /* ++MAC TYPE IN ICT             */ 03939000
*           THEN                                                   0924 03940000
@RF00922 L     @15,@PC00016+4                                      0924 03941000
         CLI   ELMCBTY(@15),5                                      0924 03942000
         BNE   @RF00924                                            0924 03943000
         LR    @15,QQ                                              0924 03944000
         MH    @15,@CH02383                                        0924 03945000
         L     @14,CCAICMOD(,CCAPTR)                               0924 03946000
         ST    @15,@TF00001                                        0924 03947000
         ALR   @15,@14                                             0924 03948000
         AL    @15,@CF02420                                        0924 03949000
         TM    ICTMMACR-9(@15),B'00001000'                         0924 03950000
         BNO   @RF00924                                            0924 03951000
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */ 03952000
         L     @15,@TF00001                                        0925 03953000
         AL    @14,@CF02433                                        0925 03954000
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0925 03955000
*         IF ELMCBTY=MCBMCUTP       /* ++MACUPD TYPE PASSED          */ 03956000
*             &ICTMMACU(QQ)=ON      /* ++MACUPD TYPE IN ICT          */ 03957000
*           THEN                                                   0926 03958000
@RF00924 L     @15,@PC00016+4                                      0926 03959000
         CLI   ELMCBTY(@15),8                                      0926 03960000
         BNE   @RF00926                                            0926 03961000
         LR    @15,QQ                                              0926 03962000
         MH    @15,@CH02383                                        0926 03963000
         L     @14,CCAICMOD(,CCAPTR)                               0926 03964000
         ST    @15,@TF00001                                        0926 03965000
         ALR   @15,@14                                             0926 03966000
         AL    @15,@CF02420                                        0926 03967000
         TM    ICTMMACU-9(@15),B'00000100'                         0926 03968000
         BNO   @RF00926                                            0926 03969000
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */ 03970000
         L     @15,@TF00001                                        0927 03971000
         AL    @14,@CF02433                                        0927 03972000
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0927 03973000
*         IF ELMCBTY=MCBSCRTP       /* ++SRC TYPE PASSED             */ 03974000
*             &ICTMSRCR(QQ)=ON      /* ++SRC TYPE IN ICT             */ 03975000
*           THEN                                                   0928 03976000
@RF00926 L     @15,@PC00016+4                                      0928 03977000
         CLI   ELMCBTY(@15),6                                      0928 03978000
         BNE   @RF00928                                            0928 03979000
         LR    @15,QQ                                              0928 03980000
         MH    @15,@CH02383                                        0928 03981000
         L     @14,CCAICMOD(,CCAPTR)                               0928 03982000
         ST    @15,@TF00001                                        0928 03983000
         ALR   @15,@14                                             0928 03984000
         AL    @15,@CF02420                                        0928 03985000
         TM    ICTMSRCR-9(@15),B'00000010'                         0928 03986000
         BNO   @RF00928                                            0928 03987000
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */ 03988000
         L     @15,@TF00001                                        0929 03989000
         AL    @14,@CF02433                                        0929 03990000
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0929 03991000
*         IF ELMCBTY=MCBSCUTP       /* ++SRCUPD TYPE PASSED          */ 03992000
*             &ICTMSRCU(QQ)=ON      /* ++SRCUPD TYPE IN ICT          */ 03993000
*           THEN                                                   0930 03994000
@RF00928 L     @15,@PC00016+4                                      0930 03995000
         CLI   ELMCBTY(@15),9                                      0930 03996000
         BNE   @RF00930                                            0930 03997000
         LR    @15,QQ                                              0930 03998000
         MH    @15,@CH02383                                        0930 03999000
         L     @14,CCAICMOD(,CCAPTR)                               0930 04000000
         ST    @15,@TF00001                                        0930 04001000
         ALR   @15,@14                                             0930 04002000
         AL    @15,@CF02420                                        0930 04003000
         TM    ICTMSRCU-9(@15),B'00000001'                         0930 04004000
         BNO   @RF00930                                            0930 04005000
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */ 04006000
         L     @15,@TF00001                                        0931 04007000
         AL    @14,@CF02433                                        0931 04008000
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0931 04009000
*         IF SSMDPTR^=0 THEN                                       0932 04010000
@RF00930 LTR   SSMDPTR,SSMDPTR                                     0932 04011000
         BZ    @RF00932                                            0932 04012000
*           DO;                                                    0933 04013000
*                                                                  0933 04014000
*             /*******************************************************/ 04015000
*             /*                                                     */ 04016000
*             /* MATCHING ELEMENT_NAME/ELEMENT_TYPES FOUND ... CHECK */ 04017000
*             /* WHETHER THE SYSMOD ASSOCIATED WITH THE ELEMENT IN   */ 04018000
*             /* THE ICT IS THE SAME AS THAT SUPPLIED BY THE CALLER  */ 04019000
*             /*                                                     */ 04020000
*             /*******************************************************/ 04021000
*                                                                  0934 04022000
*             IF SSMDPTR->ICTPTFS(1)=SMDNAME THEN                  0934 04023000
         L     @15,@PC00016+8                                      0934 04024000
         CLC   ICTPTFS(7,SSMDPTR),SMDNAME(@15)                     0934 04025000
         BNE   @RF00934                                            0934 04026000
*               RTNPTR=ADDR(ICTMOD(QQ));/* MATCHING SYSMOD NAME ...     04027000
*                                      SET RTNPTR TO THE CURRENT MOD    04028000
*                                      SECT ENTRY                    */ 04029000
         L     @03,@PC00016+12                                     0935 04030000
         LR    @15,QQ                                              0935 04031000
         MH    @15,@CH02383                                        0935 04032000
         L     @01,CCAICMOD(,CCAPTR)                               0935 04033000
         AL    @01,@CF02422                                        0935 04034000
         LA    @15,ICTMOD(@15,@01)                                 0935 04035000
         ST    @15,RTNPTR(,@03)                                    0935 04036000
*           END;                                                   0936 04037000
@RF00934 DS    0H                                                  0937 04038000
*       END;                                                       0937 04039000
@RF00932 DS    0H                                                  0938 04040000
*   END;                                                           0938 04041000
@RF00917 AL    QQ,@CF00065                                         0938 04042000
@DE00916 LR    @03,QQ                                              0938 04043000
         MH    @03,@CH02383                                        0938 04044000
         L     @01,CCAICMOD(,CCAPTR)                               0938 04045000
         AL    @01,@CF02422                                        0938 04046000
         L     @03,ICTMEND(@03,@01)                                0938 04047000
         CL    @03,ICTENDNT                                        0938 04048000
         BE    @DC00916                                            0938 04049000
         L     @03,@PC00016+12                                     0938 04050000
         ICM   @15,15,RTNPTR(@03)                                  0938 04051000
         BZ    @DL00916                                            0938 04052000
@DC00916 DS    0H                                                  0939 04053000
*   RETURN;                                                        0939 04054000
@EL00016 DS    0H                                                  0939 04055000
@EF00016 DS    0H                                                  0939 04056000
@ER00016 LM    @14,@12,12(@13)                                     0939 04057000
         BR    @14                                                 0939 04058000
*   END SRCHICTM;                                                  0940 04059000
*                                                                  0941 04060000
*/********************************************************************/ 04061000
*/*                                                                  */ 04062000
*/*    SCRWRKX  - SCRATCH ANY EXISTING MEMBERS ON THE WRK DATASETS   */ 04063000
*/*               FOR THE ELEMENT PASSED BY THE CALLER               */ 04064000
*/*                                                                  */ 04065000
*/*    CONDITIONS UPON ENTRY:                                        */ 04066000
*/*                                                                  */ 04067000
*/*     * PTRIOP2  - PTR TO IOP WHICH MAY BE USED TO SCRATCH MEMBERS */ 04068000
*/*                  FROM THE WRK DATASETS                           */ 04069000
*/*                                                                  */ 04070000
*/********************************************************************/ 04071000
*                                                                  0941 04072000
*SCRWRKX:                                                          0941 04073000
*   PROC(SCRMOD);                                                  0941 04074000
SCRWRKX  STM   @14,@12,@SA00017                                    0941 04075000
         MVC   @PC00017(4),0(@01)                                  0941 04076000
*   DCL                                                            0942 04077000
*     SCRMOD CHAR(*);               /* ICT MOD SECT ENTRY FOR AN   0942 04078000
*                                      ELEMENT                       */ 04079000
*   RESPECIFY                                                      0943 04080000
*     ICTMOD BASED(ADDR(SCRMOD));   /* MOD SECT ENTRY PASSED         */ 04081000
*   RESPECIFY                                                      0944 04082000
*     HMASMIOP BASED(PTRIOP2);      /* ADDRESS IOP                   */ 04083000
*   IF ICTMWRK(1)=ON THEN                                          0945 04084000
         L     @15,@PC00017                                        0945 04085000
         TM    ICTMWRK(@15),B'00001000'                            0945 04086000
         BNO   @RF00945                                            0945 04087000
*     DO;                                                          0946 04088000
*                                                                  0946 04089000
*       /*************************************************************/ 04090000
*       /*                                                           */ 04091000
*       /* THE ELEMENT'S TEXT HAS BEEN WRITTEN TO A WRK DATASET      */ 04092000
*       /*                                                           */ 04093000
*       /*************************************************************/ 04094000
*                                                                  0947 04095000
*                                                                  0947 04096000
*       /*************************************************************/ 04097000
*       /*                                                           */ 04098000
*       /* INITIALIZE IOP FOR STOW DELETE FUNCTION TO WRK DATASET    */ 04099000
*       /*                                                           */ 04100000
*       /*************************************************************/ 04101000
*                                                                  0947 04102000
*       IOPFUNCT=IOPSTOWD;          /* STOW DELETE FUNCTION          */ 04103000
         L     @14,PTRIOP2                                         0947 04104000
         MVI   IOPFUNCT(@14),X'53'                                 0947 04105000
*       IOPDSID=IOPWKX;             /* WRKX DATASET ... DETERMINED BY   04106000
*                                      I/O ROUTINES FROM IOPTYPE     */ 04107000
         MVI   IOPDSID(@14),X'28'                                  0948 04108000
*       IOPNAME=ICTMNAME(1);        /* ELEMENT NAME                  */ 04109000
         MVC   IOPNAME(8,@14),ICTMNAME(@15)                        0949 04110000
*       IF ICTMMOD(1)=ON            /* ++MOD ELEMENT                 */ 04111000
*         THEN                                                     0950 04112000
         TM    ICTMMOD(@15),B'10000000'                            0950 04113000
         BNO   @RF00950                                            0950 04114000
*         IOPTYPE=IOPMOD;           /* ... GET RID OF WRKX MOD       */ 04115000
         MVI   IOPTYPE(@14),X'05'                                  0951 04116000
*       IF ICTMXPND(1)=ON           /* EXPAND MOD ENTRY              */ 04117000
*         THEN                                                     0952 04118000
@RF00950 L     @15,@PC00017                                        0952 04119000
         TM    ICTMXPND(@15),B'00010000'                           0952 04120000
         BNO   @RF00952                                            0952 04121000
*         IOPTYPE=IOPXZP;           /* ... GET RID OF WRKX EXPANDS   */ 04122000
         L     @01,PTRIOP2                                         0953 04123000
         MVI   IOPTYPE(@01),X'0D'                                  0953 04124000
*       IF ICTMMACR(1)=ON           /* ++MAC ELEMENT                 */ 04125000
*         THEN                                                     0954 04126000
@RF00952 L     @15,@PC00017                                        0954 04127000
         TM    ICTMMACR(@15),B'00001000'                           0954 04128000
         BNO   @RF00954                                            0954 04129000
*         IOPTYPE=IOPMCR;           /* ... GET RID OF WRKX MAC       */ 04130000
         L     @01,PTRIOP2                                         0955 04131000
         MVI   IOPTYPE(@01),X'03'                                  0955 04132000
*       IF ICTMSRCR(1)=ON           /* ++SRC ELEMENT                 */ 04133000
*         THEN                                                     0956 04134000
@RF00954 L     @15,@PC00017                                        0956 04135000
         TM    ICTMSRCR(@15),B'00000010'                           0956 04136000
         BNO   @RF00956                                            0956 04137000
*         IOPTYPE=IOPSCR;           /* ... GET RID OF WRKX SRC       */ 04138000
         L     @01,PTRIOP2                                         0957 04139000
         MVI   IOPTYPE(@01),X'08'                                  0957 04140000
*       IF ICTMZAP(1)=ON            /* ++ZAP ELEMENT                 */ 04141000
*         THEN                                                     0958 04142000
@RF00956 L     @15,@PC00017                                        0958 04143000
         TM    ICTMZAP(@15),B'00100000'                            0958 04144000
         BNO   @RF00958                                            0958 04145000
*         IOPTYPE=IOPZAP;           /* ... GET RID OF WRKX ZAPS      */ 04146000
         L     @01,PTRIOP2                                         0959 04147000
         MVI   IOPTYPE(@01),X'0C'                                  0959 04148000
*       IF ICTMMACU(1)=ON           /* ++MACUPD ELEMENT              */ 04149000
*         THEN                                                     0960 04150000
@RF00958 L     @15,@PC00017                                        0960 04151000
         TM    ICTMMACU(@15),B'00000100'                           0960 04152000
         BNO   @RF00960                                            0960 04153000
*         IOPTYPE=IOPMCU;           /* ... GET RID OF WRKX MACUPDS   */ 04154000
         L     @01,PTRIOP2                                         0961 04155000
         MVI   IOPTYPE(@01),X'04'                                  0961 04156000
*       IF ICTMSRCU(1)=ON           /* ++SRCUPD ELEMENT              */ 04157000
*         THEN                                                     0962 04158000
@RF00960 L     @15,@PC00017                                        0962 04159000
         TM    ICTMSRCU(@15),B'00000001'                           0962 04160000
         BNO   @RF00962                                            0962 04161000
*         IOPTYPE=IOPSCR;           /* ... GET RID OF WRKX SRCUPDTS  */ 04162000
         L     @01,PTRIOP2                                         0963 04163000
         MVI   IOPTYPE(@01),X'08'                                  0963 04164000
*       CALL HMASMIO(HMASMIOP);     /* DO THE STOW DELETE            */ 04165000
@RF00962 L     @01,PTRIOP2                                         0964 04166000
         ST    @01,@AL00001                                        0964 04167000
         L     @15,@CV01886                                        0964 04168000
         LA    @01,@AL00001                                        0964 04169000
         BALR  @14,@15                                             0964 04170000
*       ICTMWRK(1)=OFF;             /* ELEMENT NO LONGER ON WRKX     */ 04171000
         L     @15,@PC00017                                        0965 04172000
         NI    ICTMWRK(@15),B'11110111'                            0965 04173000
*     END;                                                         0966 04174000
*   RETURN;                                                        0967 04175000
@EL00017 DS    0H                                                  0967 04176000
@EF00017 DS    0H                                                  0967 04177000
@ER00017 LM    @14,@12,@SA00017                                    0967 04178000
         BR    @14                                                 0967 04179000
*   END SCRWRKX;                                                   0968 04180000
         B     @EL00017                                            0968 04181000
*                                                                  0969 04182000
*/********************************************************************/ 04183000
*/*                                                                  */ 04184000
*/*    SRCMODA  - FOR THE ++SRC MOD SECTION ENTRY PASSED, LOOK IN    */ 04185000
*/*               THE ICT FOR AN ASSOCIATED ++MOD MOD SECTION        */ 04186000
*/*               ENTRY                                              */ 04187000
*/*                                                                  */ 04188000
*/*    CONDITIONS UPON ENTRY:                                        */ 04189000
*/*                                                                  */ 04190000
*/*                                                                  */ 04191000
*/*    CONDITIONS UPON EXIT:                                         */ 04192000
*/*                                                                  */ 04193000
*/*     * SET IN ++SRC MOD SECTION ENTRY PASSED:                     */ 04194000
*/*                                                                  */ 04195000
*/*     - ICTMASOC - SET IF ASSOCIATED ++MOD MOD SECTION ENTRY FOUND */ 04196000
*/*                                                                  */ 04197000
*/*     * SET IN ASSOCIATED ++MOD MOD SECT. ENTRY:                   */ 04198000
*/*                                                                  */ 04199000
*/*     - ICTMASOC - ASSOICATED ++SRC ENTRY EXISTS                   */ 04200000
*/*                                                                  */ 04201000
*/********************************************************************/ 04202000
*                                                                  0969 04203000
*SRCMODA:                                                          0969 04204000
*   PROC(SRCENTRY);                                                0969 04205000
SRCMODA  STM   @14,@12,12(@13)                                     0969 04206000
         MVC   @PC00018(4),0(@01)                                  0969 04207000
*   DCL                                                            0970 04208000
*     SRCENTRY CHAR(*);             /* ICT MOD SECT ENTRY FOR ++SRC     04209000
*                                      OR ++SRCUPD ELEMENT           */ 04210000
*   DCL                                                            0971 04211000
*     UU FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/ 04212000
*   DCL                                                            0972 04213000
*     SRCNAME CHAR(8);              /* SOURCE ELEMENT NAME           */ 04214000
*   DCL                                                            0973 04215000
*     SRCSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++SRC*/ 04216000
*   DCL                                                            0974 04217000
*     SRCSPTR PTR(31);              /* PTR TO ++SRC MOD ENTRY PASSED */ 04218000
*   DCL                                                            0975 04219000
*     SRCMPTR PTR(31);              /* PTR TO ASSOC ++MOD ENTRY      */ 04220000
*   RESPECIFY                                                      0976 04221000
*     ICTMOD BASED(ADDR(SRCENTRY)); /* ADDRESS ENTRY PASSED          */ 04222000
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC. MOD FLAG         */ 04223000
         L     @02,@PC00018                                        0977 04224000
         NI    ICTMASOC(@02),B'11101111'                           0977 04225000
*   SRCNAME=ICTMNAME(1);            /* SRC ELEMENT NAME              */ 04226000
         MVC   SRCNAME(8),ICTMNAME(@02)                            0978 04227000
*   SRCSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */ 04228000
         L     SRCSMD@,ICTPPTR(,@02)                               0979 04229000
*   SRCSPTR=ADDR(SRCENTRY);         /* SAVE ADDR OF ++SRC ENTRY      */ 04230000
         LR    SRCSPTR,@02                                         0980 04231000
*   SRCMPTR=0;                      /* CLEAR PTR TO ASSOC ++MOD      */ 04232000
*                                                                  0981 04233000
         SLR   SRCMPTR,SRCMPTR                                     0981 04234000
*   /*****************************************************************/ 04235000
*   /*                                                               */ 04236000
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC MOD SECT ENTRY      */ 04237000
*   /*                                                               */ 04238000
*   /*****************************************************************/ 04239000
*                                                                  0982 04240000
*   RESPECIFY                                                      0982 04241000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 04242000
*   DO UU=1 BY 1 WHILE ICTMEND(UU)^=ICTENDNT&SRCMPTR=0;            0983 04243000
         LA    UU,1                                                0983 04244000
         B     @DE00983                                            0983 04245000
@DL00983 DS    0H                                                  0984 04246000
*     IF ICTMNAME(UU)=SRCNAME       /* ELEMENT NAMES EQUAL           */ 04247000
*         &ICTMMOD(UU)=ON           /* MOD ENTRY                     */ 04248000
*         &ICTMASM(UU)=OFF          /* ... NOT ASSEMBLY ENTRY        */ 04249000
*         &ICTPPTR(UU)=SRCSMD@      /* "CURRENT" SYSMOD              */ 04250000
*       THEN                                                       0984 04251000
         LR    @15,UU                                              0984 04252000
         MH    @15,@CH02383                                        0984 04253000
         L     @14,CCAICMOD(,CCAPTR)                               0984 04254000
         ST    @15,@TF00001                                        0984 04255000
         ALR   @15,@14                                             0984 04256000
         AL    @15,@CF02422                                        0984 04257000
         CLC   ICTMNAME(8,@15),SRCNAME                             0984 04258000
         BNE   @RF00984                                            0984 04259000
         LR    @15,@14                                             0984 04260000
         AL    @15,@TF00001                                        0984 04261000
         AL    @15,@CF02420                                        0984 04262000
         TM    ICTMMOD-9(@15),B'10000000'                          0984 04263000
         BNO   @RF00984                                            0984 04264000
         TM    ICTMASM-9(@15),B'01000000'                          0984 04265000
         BNZ   @RF00984                                            0984 04266000
         L     @15,@TF00001                                        0984 04267000
         AL    @15,@CF02433                                        0984 04268000
         C     SRCSMD@,ICTPPTR-96(@15,@14)                         0984 04269000
         BNE   @RF00984                                            0984 04270000
*       DO;                                                        0985 04271000
*                                                                  0985 04272000
*         /***********************************************************/ 04273000
*         /*                                                         */ 04274000
*         /* ASSOCIATED ++MOD MOD ENTRY FOUND                        */ 04275000
*         /*                                                         */ 04276000
*         /***********************************************************/ 04277000
*                                                                  0986 04278000
*         ICTMASOC(UU)=ON;          /* SET ASSOC ++SRC IN ++MOD ENTRY*/ 04279000
         LR    @15,@14                                             0986 04280000
         AL    @15,@TF00001                                        0986 04281000
         AL    @15,@CF02421                                        0986 04282000
         OI    ICTMASOC-11(@15),B'00010000'                        0986 04283000
*         SRCMPTR=ADDR(ICTMOD(UU)); /* POINT TO ++MOD ENTRY FOUND    */ 04284000
         L     SRCMPTR,@TF00001                                    0987 04285000
         AL    @14,@CF02422                                        0987 04286000
         LA    SRCMPTR,ICTMOD(SRCMPTR,@14)                         0987 04287000
*         SRCSPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++MOD IN ++SRC ENTRY*/ 04288000
         OI    ICTMASOC(SRCSPTR),B'00010000'                       0988 04289000
*       END;                                                       0989 04290000
*   END;                                                           0990 04291000
@RF00984 AL    UU,@CF00065                                         0990 04292000
@DE00983 LR    @15,UU                                              0990 04293000
         MH    @15,@CH02383                                        0990 04294000
         L     @01,CCAICMOD(,CCAPTR)                               0990 04295000
         AL    @01,@CF02422                                        0990 04296000
         L     @15,ICTMEND(@15,@01)                                0990 04297000
         CL    @15,ICTENDNT                                        0990 04298000
         BE    @DC00983                                            0990 04299000
         LTR   SRCMPTR,SRCMPTR                                     0990 04300000
         BZ    @DL00983                                            0990 04301000
@DC00983 DS    0H                                                  0991 04302000
*   RETURN;                                                        0991 04303000
@EL00018 DS    0H                                                  0991 04304000
@EF00018 DS    0H                                                  0991 04305000
@ER00018 LM    @14,@12,12(@13)                                     0991 04306000
         BR    @14                                                 0991 04307000
*   END SRCMODA;                                                   0992 04308000
*                                                                  0993 04309000
*/********************************************************************/ 04310000
*/*                                                                  */ 04311000
*/*    MODSRCA  - FOR THE ++MOD MOD SECTION ENTRY PASSED, LOOK IN    */ 04312000
*/*               THE ICT FOR AN ASSOCIATED ++SRC MOD SECTION        */ 04313000
*/*               ENTRY                                              */ 04314000
*/*                                                                  */ 04315000
*/*    CONDITIONS UPON ENTRY:                                        */ 04316000
*/*                                                                  */ 04317000
*/*                                                                  */ 04318000
*/*    CONDITIONS UPON EXIT:                                         */ 04319000
*/*                                                                  */ 04320000
*/*     * SET IN ++MOD MOD SECTION ENTRY PASSED:                     */ 04321000
*/*                                                                  */ 04322000
*/*     - ICTMASOC - SET IF ASSOICATED ++SRC MOD SECT ENTRY FOUND    */ 04323000
*/*                                                                  */ 04324000
*/*     * SET IN ++SRC MOD SECTION ENTRY ASSOCIATED WITH ++MOD:      */ 04325000
*/*                                                                  */ 04326000
*/*     - ICTMASOC - ASSOCIATED ++MOD MOD SECTION ENTRY EXISTS       */ 04327000
*/*                                                                  */ 04328000
*/********************************************************************/ 04329000
*                                                                  0993 04330000
*MODSRCA:                                                          0993 04331000
*   PROC(MODENTRY);                                                0993 04332000
MODSRCA  STM   @14,@12,12(@13)                                     0993 04333000
         MVC   @PC00019(4),0(@01)                                  0993 04334000
*   DCL                                                            0994 04335000
*     MODENTRY CHAR(*);             /* ICT MOD SECT. ENTRY FOR ++MOD    04336000
*                                      ELEMENT                       */ 04337000
*   DCL                                                            0995 04338000
*     TT FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/ 04339000
*   DCL                                                            0996 04340000
*     MODNAME CHAR(8);              /* ELEMENT NAME                  */ 04341000
*   DCL                                                            0997 04342000
*     MODSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++MOD*/ 04343000
*   DCL                                                            0998 04344000
*     MODMPTR PTR(31);              /* PTR TO ++MOD MOD ENTRY PASSED */ 04345000
*   DCL                                                            0999 04346000
*     MODSPTR PTR(31);              /* PTR TO ++SRC ENTRY FOUND      */ 04347000
*   RESPECIFY                                                      1000 04348000
*     ICTMOD BASED(ADDR(MODENTRY)); /* ADDRESS ENTRY PASSED          */ 04349000
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC ++SRC FLAG        */ 04350000
         L     @02,@PC00019                                        1001 04351000
         NI    ICTMASOC(@02),B'11101111'                           1001 04352000
*   MODNAME=ICTMNAME(1);            /* MOD ELEMENT NAME              */ 04353000
         MVC   MODNAME(8),ICTMNAME(@02)                            1002 04354000
*   MODSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */ 04355000
         L     MODSMD@,ICTPPTR(,@02)                               1003 04356000
*   MODMPTR=ADDR(MODENTRY);         /* PTR TO ++MOD ENTRY PASSED     */ 04357000
         LR    MODMPTR,@02                                         1004 04358000
*   MODSPTR=0;                      /* PTR TO ++SRC ENTRY FOUND      */ 04359000
*                                                                  1005 04360000
         SLR   MODSPTR,MODSPTR                                     1005 04361000
*   /*****************************************************************/ 04362000
*   /*                                                               */ 04363000
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC ++SRC MOD SECT ENTRY*/ 04364000
*   /*                                                               */ 04365000
*   /*****************************************************************/ 04366000
*                                                                  1006 04367000
*   RESPECIFY                                                      1006 04368000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 04369000
*   DO TT=1 BY 1 WHILE ICTMEND(TT)^=ICTENDNT&MODSPTR=0;            1007 04370000
         LA    TT,1                                                1007 04371000
         B     @DE01007                                            1007 04372000
@DL01007 DS    0H                                                  1008 04373000
*     IF ICTMNAME(TT)=MODNAME       /* ELEMENT NAMES EQUAL           */ 04374000
*         &(ICTMSRCR(TT)=ON         /* ++SRC ENTRY                   */ 04375000
*         |ICTMSRCU(TT)=ON)         /* ++SRCUPD ENTRY                */ 04376000
*         &ICTPPTR(TT)=MODSMD@      /* "CURRENT" SYSMOD              */ 04377000
*       THEN                                                       1008 04378000
         LR    @15,TT                                              1008 04379000
         MH    @15,@CH02383                                        1008 04380000
         L     @14,CCAICMOD(,CCAPTR)                               1008 04381000
         ST    @15,@TF00001                                        1008 04382000
         ALR   @15,@14                                             1008 04383000
         AL    @15,@CF02422                                        1008 04384000
         CLC   ICTMNAME(8,@15),MODNAME                             1008 04385000
         BNE   @RF01008                                            1008 04386000
         LR    @15,@14                                             1008 04387000
         AL    @15,@TF00001                                        1008 04388000
         AL    @15,@CF02420                                        1008 04389000
         TM    ICTMSRCR-9(@15),B'00000011'                         1008 04390000
         BZ    @RF01008                                            1008 04391000
         L     @15,@TF00001                                        1008 04392000
         AL    @15,@CF02433                                        1008 04393000
         C     MODSMD@,ICTPPTR-96(@15,@14)                         1008 04394000
         BNE   @RF01008                                            1008 04395000
*       DO;                                                        1009 04396000
*                                                                  1009 04397000
*         /***********************************************************/ 04398000
*         /*                                                         */ 04399000
*         /* ASSOCIATED ++SRC OR ++SRCUPD MOD ENTRY FOUND            */ 04400000
*         /*                                                         */ 04401000
*         /***********************************************************/ 04402000
*                                                                  1010 04403000
*         ICTMASOC(TT)=ON;          /* SET ASSOC ++MOD IN ++SRC ENTRY*/ 04404000
         LR    @15,@14                                             1010 04405000
         AL    @15,@TF00001                                        1010 04406000
         AL    @15,@CF02421                                        1010 04407000
         OI    ICTMASOC-11(@15),B'00010000'                        1010 04408000
*         MODSPTR=ADDR(ICTMOD(TT)); /* POINT ++SRC ENTRY FOUND       */ 04409000
         L     MODSPTR,@TF00001                                    1011 04410000
         AL    @14,@CF02422                                        1011 04411000
         LA    MODSPTR,ICTMOD(MODSPTR,@14)                         1011 04412000
*         MODMPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++SRC IN ++MOD ENTRY*/ 04413000
         OI    ICTMASOC(MODMPTR),B'00010000'                       1012 04414000
*       END;                                                       1013 04415000
*   END;                                                           1014 04416000
@RF01008 AL    TT,@CF00065                                         1014 04417000
@DE01007 LR    @15,TT                                              1014 04418000
         MH    @15,@CH02383                                        1014 04419000
         L     @01,CCAICMOD(,CCAPTR)                               1014 04420000
         AL    @01,@CF02422                                        1014 04421000
         L     @15,ICTMEND(@15,@01)                                1014 04422000
         CL    @15,ICTENDNT                                        1014 04423000
         BE    @DC01007                                            1014 04424000
         LTR   MODSPTR,MODSPTR                                     1014 04425000
         BZ    @DL01007                                            1014 04426000
@DC01007 DS    0H                                                  1015 04427000
*   RETURN;                                                        1015 04428000
@EL00019 DS    0H                                                  1015 04429000
@EF00019 DS    0H                                                  1015 04430000
@ER00019 LM    @14,@12,12(@13)                                     1015 04431000
         BR    @14                                                 1015 04432000
*   END MODSRCA;                                                   1016 04433000
*                                                                  1017 04434000
*/********************************************************************/ 04435000
*/*                                                                  */ 04436000
*/*    GETSYSPO - GET A VALID PROCESSABLE SYSMOD FROM THOSE IN THE   */ 04437000
*/*               ICT PTF SECTION USING THE SYSMOD PROCESSING ORDER  */ 04438000
*/*               (ICTPONUM) DETERMINED BY HMASMTPO.                 */ 04439000
*/*                                                                  */ 04440000
*/*                                                                  */ 04441000
*/*                                                                  */ 04442000
*/*    CONDITIONS UPON ENTRY:                                        */ 04443000
*/*                                                                  */ 04444000
*/*     *                                                            */ 04445000
*/*                                                                  */ 04446000
*/********************************************************************/ 04447000
*                                                                  1017 04448000
*GETSYSPO:                                                         1017 04449000
*   PROC(NXTINDX);                                                 1017 04450000
GETSYSPO STM   @14,@12,12(@13)                                     1017 04451000
         MVC   @PC00020(4),0(@01)                                  1017 04452000
*   DCL                                                            1018 04453000
*     NXTINDX FIXED(31);            /* INDEX TO ICT PTF SECTION ENTRY   04454000
*                                      .... ZERO IF NO PROCESSABLE 1018 04455000
*                                      SYSMOD FOUND IN ICT           */ 04456000
*   DCL                                                            1019 04457000
*     PI FIXED(15);                 /* LOCAL INDEX - PTF SECT ENTRIES*/ 04458000
*   DCL                                                            1020 04459000
*     MINORD# FIXED(16);            /* LOWEST PROCESSING ORDER VALUE    04460000
*                                      FOUND IN SEARCH THRU ICT      */ 04461000
*   RESPECIFY                                                      1021 04462000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */ 04463000
*   NXTINDX=0;                      /* CLEAR INDEX RETURNED TO CALLER*/ 04464000
         L     @02,@PC00020                                        1022 04465000
         SLR   @15,@15                                             1022 04466000
         ST    @15,NXTINDX(,@02)                                   1022 04467000
*   MINORD#=0;                      /* LOWEST PROCESSING ORDER VALUE    04468000
*                                      FOUND IN SEARCH THRU ICT      */ 04469000
*                                                                  1023 04470000
         SLR   MINORD#,MINORD#                                     1023 04471000
*   /*****************************************************************/ 04472000
*   /*                                                               */ 04473000
*   /* GO THRU ICT PTF SECTION ENTRIES                               */ 04474000
*   /*                                                               */ 04475000
*   /*****************************************************************/ 04476000
*                                                                  1024 04477000
*   DO PI=1 BY 1 WHILE ICTPEND(PI)^=ICTENDNT&HIGHTMD<STOPFUNC;     1024 04478000
         LA    PI,1                                                1024 04479000
         B     @DE01024                                            1024 04480000
@DL01024 DS    0H                                                  1025 04481000
*     IF ICTPNOGO(PI)=OFF           /* SYSMOD NOT NOGO               */ 04482000
*         &ICTPSUPN(PI)=0           /* SYSMOD NOT SUPERSEDED         */ 04483000
*         &ICTPMSL(PI)=OFF          /* SYSMOD NOT PROCESSED          */ 04484000
*         &ICTPGELM(PI)=OFF         /* SYSMOD NOT ELIMINATED         */ 04485000
*         &ICTPDEXP(PI)=OFF         /* SYSMOD NOT EXPLICITLY DELETED */ 04486000
*         &ICTPDIMP(PI)=OFF         /* SYSMOD NOT IMPLICITLY DELETED */ 04487000
*       THEN                                                       1025 04488000
         LR    @15,PI                                              1025 04489000
         MH    @15,@CH02382                                        1025 04490000
         L     @14,CCAICPTF(,CCAPTR)                               1025 04491000
         ST    @15,@TF00001                                        1025 04492000
         ALR   @15,@14                                             1025 04493000
         AL    @15,@CF02416                                        1025 04494000
         TM    ICTPNOGO-8(@15),B'01000000'                         1025 04495000
         BNZ   @RF01025                                            1025 04496000
         LR    @15,@14                                             1025 04497000
         AL    @15,@TF00001                                        1025 04498000
         AL    @15,@CF02443                                        1025 04499000
         SLR   @07,@07                                             1025 04500000
         ICM   @07,3,ICTPSUPN-20(@15)                              1025 04501000
         LTR   @07,@07                                             1025 04502000
         BNZ   @RF01025                                            1025 04503000
         LR    @15,@14                                             1025 04504000
         AL    @15,@TF00001                                        1025 04505000
         AL    @15,@CF02418                                        1025 04506000
         TM    ICTPMSL-15(@15),B'10000000'                         1025 04507000
         BNZ   @RF01025                                            1025 04508000
         LR    @15,@14                                             1025 04509000
         AL    @15,@TF00001                                        1025 04510000
         AL    @15,@CF02415                                        1025 04511000
         TM    ICTPGELM-13(@15),B'00111000'                        1025 04512000
         BNZ   @RF01025                                            1025 04513000
*       DO;                                                        1026 04514000
*                                                                  1026 04515000
*         /***********************************************************/ 04516000
*         /*                                                         */ 04517000
*         /* PROCESSABLE SYSMOD FOUND ... CHECK ITS PROCESSING ORDER */ 04518000
*         /* VALUE RELATIVE TO THE LAST ONE FOUND                    */ 04519000
*         /*                                                         */ 04520000
*         /***********************************************************/ 04521000
*                                                                  1027 04522000
*         IF MINORD#=0              /* FIRST PROCESSABLE SYSMOD FND  */ 04523000
*           THEN                                                   1027 04524000
         LTR   MINORD#,MINORD#                                     1027 04525000
         BNZ   @RF01027                                            1027 04526000
*           DO;                                                    1028 04527000
*             MINORD#=ICTPONUM(PI); /* SAVE PROCESSING ORDER VALUE   */ 04528000
         AL    @14,@TF00001                                        1029 04529000
         AL    @14,@CF02444                                        1029 04530000
         SLR   MINORD#,MINORD#                                     1029 04531000
         ICM   MINORD#,3,ICTPONUM-18(@14)                          1029 04532000
*             NXTINDX=PI;           /* SAVE ICT PTF SECT. INDEX      */ 04533000
         L     @15,@PC00020                                        1030 04534000
         ST    PI,NXTINDX(,@15)                                    1030 04535000
*           END;                                                   1031 04536000
*         ELSE                                                     1032 04537000
*           DO;                                                    1032 04538000
         B     @RC01027                                            1032 04539000
@RF01027 DS    0H                                                  1033 04540000
*             IF ICTPONUM(PI)<MINORD#/* COMPARE WITH LOWEST # FOUND  */ 04541000
*               THEN                                               1033 04542000
         LR    @15,PI                                              1033 04543000
         MH    @15,@CH02382                                        1033 04544000
         L     @01,CCAICPTF(,CCAPTR)                               1033 04545000
         ALR   @01,@15                                             1033 04546000
         AL    @01,@CF02444                                        1033 04547000
         SLR   @15,@15                                             1033 04548000
         ICM   @15,3,ICTPONUM-18(@01)                              1033 04549000
         CR    @15,MINORD#                                         1033 04550000
         BNL   @RF01033                                            1033 04551000
*               DO;                                                1034 04552000
*                                                                  1034 04553000
*                 /***************************************************/ 04554000
*                 /*                                                 */ 04555000
*                 /* A NEW LOWEST PROCESSING ORDER # FOUND           */ 04556000
*                 /*                                                 */ 04557000
*                 /***************************************************/ 04558000
*                                                                  1035 04559000
*                 MINORD#=ICTPONUM(PI);/* SAVE PROCESSG. ORDER VALUE */ 04560000
         LR    MINORD#,@15                                         1035 04561000
*                 NXTINDX=PI;       /* SAVE ICT PTF SECT. INDEX      */ 04562000
         L     @15,@PC00020                                        1036 04563000
         ST    PI,NXTINDX(,@15)                                    1036 04564000
*               END;                                               1037 04565000
*           END;                                                   1038 04566000
@RF01033 DS    0H                                                  1039 04567000
*       END;                        /* END PROCESSABLE SYSMOD FOUND  */ 04568000
@RC01027 DS    0H                                                  1040 04569000
*   END;                            /* END LOOP THRU ICT PTF SECTION */ 04570000
@RF01025 AL    PI,@CF00065                                         1040 04571000
@DE01024 LR    @15,PI                                              1040 04572000
         MH    @15,@CH02382                                        1040 04573000
         L     @01,CCAICPTF(,CCAPTR)                               1040 04574000
         AL    @01,@CF02417                                        1040 04575000
         L     @15,ICTPEND(@15,@01)                                1040 04576000
         CL    @15,ICTENDNT                                        1040 04577000
         BE    @DC01024                                            1040 04578000
         L     @15,HIGHTMD                                         1040 04579000
         CH    @15,@CH00036                                        1040 04580000
         BL    @DL01024                                            1040 04581000
@DC01024 DS    0H                                                  1041 04582000
*   RETURN;                                                        1041 04583000
@EL00020 DS    0H                                                  1041 04584000
@EF00020 DS    0H                                                  1041 04585000
@ER00020 LM    @14,@12,12(@13)                                     1041 04586000
         BR    @14                                                 1041 04587000
*   END GETSYSPO;                                                  1042 04588000
*                                                                  1043 04589000
*/********************************************************************/ 04590000
*/*                                                                  */ 04591000
*/*    ERRMSG   - PUT ERROR MESSAGES TO SMPOUT AND SMPLOG            */ 04592000
*/*             - SET HIGHTMD FROM MGPTYPE                           */ 04593000
*/*                                                                  */ 04594000
*/*    CONDITIONS UPON ENTRY:                                        */ 04595000
*/*                                                                  */ 04596000
*/*     * MGPTYPE -  MESSAGE SEVERITY INITIALIZED TO VALID VALUE     */ 04597000
*/*                                                                  */ 04598000
*/*     * MSGSMDNM - "CURRENT" SYSMOD NAME                           */ 04599000
*/*                                                                  */ 04600000
*/*     * VPART#1  - AS NEEDED FOR PARTICULAR MESSAGES               */ 04601000
*/*                                                                  */ 04602000
*/*     * VPART#2  - AS NEEDED FOR PARTICULAR MESSAGES               */ 04603000
*/*                                                                  */ 04604000
*/*     * VPART#3  - AS NEEDED FOR PARTICULAR MESSAGES               */ 04605000
*/*                                                                  */ 04606000
*/********************************************************************/ 04607000
*                                                                  1043 04608000
*ERRMSG:                                                           1043 04609000
*   PROC(MSGCODE1,MSGCODE2);                                       1043 04610000
ERRMSG   STM   @14,@12,@SA00021                                    1043 04611000
         MVC   @PC00021(8),0(@01)                                  1043 04612000
*   DCL                                                            1044 04613000
*     MSGCODE1 FIXED(8);            /* PRIMARY MESSAGE NUMBER        */ 04614000
*   DCL                                                            1045 04615000
*     MSGCODE2 FIXED(8);            /* MESSAGE PART NUMBER           */ 04616000
*                                                                  1046 04617000
*   /*****************************************************************/ 04618000
*   /*                                                               */ 04619000
*   /* SET UP HMASMMSG PARM LIST (MGP)                               */ 04620000
*   /*                                                               */ 04621000
*   /*****************************************************************/ 04622000
*                                                                  1046 04623000
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */ 04624000
         XC    MGPCLEAR(6),MGPCLEAR                                1046 04625000
*   MGPFLAGS=''B;                   /* CLEAR ALL FLAGS               */ 04626000
         XC    MGPFLAGS(2),MGPFLAGS                                1047 04627000
*   MGPMGNO1=MSGCODE1;              /* PRIMARY MESSAGE NUMBER        */ 04628000
         L     @15,@PC00021                                        1048 04629000
         SLR   @14,@14                                             1048 04630000
         IC    @14,MSGCODE1(,@15)                                  1048 04631000
         STH   @14,MGPMGNO1                                        1048 04632000
*   IF MSGCODE2^=NOPART THEN                                       1049 04633000
         L     @15,@PC00021+4                                      1049 04634000
         CLI   MSGCODE2(@15),0                                     1049 04635000
         BE    @RF01049                                            1049 04636000
*     MGPMGNO2=MSGCODE2;            /* MESSAGE PART NUMBER           */ 04637000
         SLR   @14,@14                                             1050 04638000
         IC    @14,MSGCODE2(,@15)                                  1050 04639000
         STH   @14,MGPMGNO2                                        1050 04640000
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */ 04641000
@RF01049 DS    0H                                                  1052 04642000
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */ 04643000
*                                                                  1052 04644000
         OI    MGPPRINT,B'10010000'                                1052 04645000
*   /*****************************************************************/ 04646000
*   /*                                                               */ 04647000
*   /* SET UP VARIABLE PARTS OF CERTAIN MESSAGES                     */ 04648000
*   /*                                                               */ 04649000
*   /*****************************************************************/ 04650000
*                                                                  1053 04651000
*   IF MSGCODE1=HMA226I             /* MESSAGE ID = HMA226I          */ 04652000
*     THEN                                                         1053 04653000
         L     @15,@PC00021                                        1053 04654000
         CLI   MSGCODE1(@15),27                                    1053 04655000
         BNE   @RF01053                                            1053 04656000
*     DO;                                                          1054 04657000
*                                                                  1054 04658000
*       /*************************************************************/ 04659000
*       /*                                                           */ 04660000
*       /* FORMAT HMA226I MESSAGE                                    */ 04661000
*       /*                                                           */ 04662000
*       /*************************************************************/ 04663000
*                                                                  1055 04664000
*       MGPVARPT(1)=ADDR(TBLXFUNC); /* SMP FUNCTION (APPLY OR ACCEPT)*/ 04665000
         L     @15,@PC00001                                        1055 04666000
         LA    @15,TBLXFUNC(,@15)                                  1055 04667000
         ST    @15,MGPVARPT                                        1055 04668000
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */ 04669000
         LA    @15,MSGSMDNM                                        1056 04670000
         ST    @15,MGPVARPT+4                                      1056 04671000
*     END;                                                         1057 04672000
*   IF MSGCODE1=HMA246I             /* MESSAGE ID = HMA246I          */ 04673000
*     THEN                                                         1058 04674000
@RF01053 L     @15,@PC00021                                        1058 04675000
         CLI   MSGCODE1(@15),47                                    1058 04676000
         BNE   @RF01058                                            1058 04677000
*     DO;                                                          1059 04678000
*                                                                  1059 04679000
*       /*************************************************************/ 04680000
*       /*                                                           */ 04681000
*       /* FORMAT HMA246I MESSAGE                                    */ 04682000
*       /*                                                           */ 04683000
*       /*************************************************************/ 04684000
*                                                                  1060 04685000
*       MGPVARPT(1)=ADDR(MSGMCS);   /* SET 'MCS' IN MSG              */ 04686000
         LA    @15,@CC01991                                        1060 04687000
         ST    @15,MGPVARPT                                        1060 04688000
*       MGPVARPT(2)=ADDR(MSGENTRY); /* SET 'ENTRY' IN MSG            */ 04689000
         LA    @15,@CC01995                                        1061 04690000
         ST    @15,MGPVARPT+4                                      1061 04691000
*       MGPVARPT(3)=ADDR(MSGPTS);   /* SET 'SMPPTS' IN MSG           */ 04692000
         LA    @15,@CC01993                                        1062 04693000
         ST    @15,MGPVARPT+8                                      1062 04694000
*       MGPVARPT(4)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */ 04695000
         LA    @15,MSGSMDNM                                        1063 04696000
         ST    @15,MGPVARPT+12                                     1063 04697000
*     END;                                                         1064 04698000
*   IF MSGCODE1=HMA355I             /* MESSAGE ID = HMA355I          */ 04699000
*     THEN                                                         1065 04700000
@RF01058 L     @15,@PC00021                                        1065 04701000
         CLI   MSGCODE1(@15),156                                   1065 04702000
         BNE   @RF01065                                            1065 04703000
*     DO;                                                          1066 04704000
*                                                                  1066 04705000
*       /*************************************************************/ 04706000
*       /*                                                           */ 04707000
*       /* FORMAT HMA355I MESSAGE                                    */ 04708000
*       /*                                                           */ 04709000
*       /*************************************************************/ 04710000
*                                                                  1067 04711000
*       MGPVARPT(1)=ADDR(MSGMCS);   /* SET 'MCS' IN MSG              */ 04712000
         LA    @15,@CC01991                                        1067 04713000
         ST    @15,MGPVARPT                                        1067 04714000
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */ 04715000
         LA    @15,MSGSMDNM                                        1068 04716000
         ST    @15,MGPVARPT+4                                      1068 04717000
*       MGPVARPT(3)=ADDR(MSGPTS);   /* SET 'SMPPTS' IN MSG           */ 04718000
         LA    @15,@CC01993                                        1069 04719000
         ST    @15,MGPVARPT+8                                      1069 04720000
*     END;                                                         1070 04721000
*   IF MSGCODE1=HMA370I             /* MESSAGE ID = HMA370I          */ 04722000
*     THEN                                                         1071 04723000
@RF01065 L     @15,@PC00021                                        1071 04724000
         CLI   MSGCODE1(@15),171                                   1071 04725000
         BNE   @RF01071                                            1071 04726000
*     DO;                                                          1072 04727000
*                                                                  1072 04728000
*       /*************************************************************/ 04729000
*       /*                                                           */ 04730000
*       /* FORMAT HMA370I MESSAGE                                    */ 04731000
*       /*                                                           */ 04732000
*       /*************************************************************/ 04733000
*                                                                  1073 04734000
*       MGPTYPE=MGPSEV;             /* SET TO STOP-FUNCTION ERROR    */ 04735000
         MVI   MGPTYPE,X'04'                                       1073 04736000
*       MGPVARPT(1)=ADDR(TBLXFUNC); /* SMP FUNCTION (APPLY OR ACCEPT)*/ 04737000
         L     @15,@PC00001                                        1074 04738000
         LA    @15,TBLXFUNC(,@15)                                  1074 04739000
         ST    @15,MGPVARPT                                        1074 04740000
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */ 04741000
         LA    @15,MSGSMDNM                                        1075 04742000
         ST    @15,MGPVARPT+4                                      1075 04743000
*     END;                                                         1076 04744000
*   IF MSGCODE1=HMA375I             /* MESSAGE ID = HMA375I          */ 04745000
*     THEN                                                         1077 04746000
@RF01071 L     @15,@PC00021                                        1077 04747000
         CLI   MSGCODE1(@15),176                                   1077 04748000
         BNE   @RF01077                                            1077 04749000
*     DO;                                                          1078 04750000
*                                                                  1078 04751000
*       /*************************************************************/ 04752000
*       /*                                                           */ 04753000
*       /* FORMAT HMA375I MESSAGE                                    */ 04754000
*       /*                                                           */ 04755000
*       /*************************************************************/ 04756000
*                                                                  1079 04757000
*       MGPVARPT(1)=ADDR(VPART#1);  /* SYSMOD-ID                     */ 04758000
         LA    @15,VPART#1                                         1079 04759000
         ST    @15,MGPVARPT                                        1079 04760000
*     END;                                                         1080 04761000
*   IF MSGCODE1=HMA374I             /* MESSAGE ID = HMA374I          */ 04762000
*     THEN                                                         1081 04763000
@RF01077 L     @15,@PC00021                                        1081 04764000
         CLI   MSGCODE1(@15),175                                   1081 04765000
         BNE   @RF01081                                            1081 04766000
*     DO;                                                          1082 04767000
*                                                                  1082 04768000
*       /*************************************************************/ 04769000
*       /*                                                           */ 04770000
*       /* FORMAT HMA374I MESSAGE                                    */ 04771000
*       /*                                                           */ 04772000
*       /*************************************************************/ 04773000
*                                                                  1083 04774000
*       MGPVARPT(1)=ADDR(VPART#1);  /* "FMID" | "PREREQ"             */ 04775000
         LA    @15,VPART#1                                         1083 04776000
         ST    @15,MGPVARPT                                        1083 04777000
*       MGPVARPT(2)=ADDR(VPART#2);  /* FMID OR PREREQ SYSMOD-ID      */ 04778000
         LA    @15,VPART#2                                         1084 04779000
         ST    @15,MGPVARPT+4                                      1084 04780000
*     END;                                                         1085 04781000
*   IF MSGCODE1=HMA405I             /* MESSAGE ID = HMA374I          */ 04782000
*     THEN                                                         1086 04783000
@RF01081 L     @15,@PC00021                                        1086 04784000
         CLI   MSGCODE1(@15),206                                   1086 04785000
         BNE   @RF01086                                            1086 04786000
*     DO;                                                          1087 04787000
*                                                                  1087 04788000
*       /*************************************************************/ 04789000
*       /*                                                           */ 04790000
*       /* FORMAT HMA405I MESSAGE                                    */ 04791000
*       /*                                                           */ 04792000
*       /*************************************************************/ 04793000
*                                                                  1088 04794000
*       MGPVARPT(1)=ADDR(VPART#1);  /* ELEMENT TYPE                  */ 04795000
         LA    @15,VPART#1                                         1088 04796000
         ST    @15,MGPVARPT                                        1088 04797000
*       MGPVARPT(2)=ADDR(VPART#2);  /* ELEMENT NAME                  */ 04798000
         LA    @15,VPART#2                                         1089 04799000
         ST    @15,MGPVARPT+4                                      1089 04800000
*       MGPVARPT(3)=ADDR(VPART#3);  /* SYSMOD-ID                     */ 04801000
         LA    @15,VPART#3                                         1090 04802000
         ST    @15,MGPVARPT+8                                      1090 04803000
*     END;                                                         1091 04804000
*   CALL HMASMMSG(HMASMMGP);                                       1092 04805000
*                                                                  1092 04806000
@RF01086 L     @15,@CV01888                                        1092 04807000
         LA    @01,@AL01092                                        1092 04808000
         BALR  @14,@15                                             1092 04809000
*   /*****************************************************************/ 04810000
*   /*                                                               */ 04811000
*   /* SET HIGHTMD RETURN CODE BASED UPON MGPTYPE                    */ 04812000
*   /*                                                               */ 04813000
*   /*****************************************************************/ 04814000
*                                                                  1093 04815000
*   IF MGPTYPE=MGPWARN THEN                                        1093 04816000
         CLI   MGPTYPE,2                                           1093 04817000
         BNE   @RF01093                                            1093 04818000
*     HIGHTMD=MAX(HIGHTMD,PTFWARN); /* WARNING                       */ 04819000
         L     @15,HIGHTMD                                         1094 04820000
         LA    @14,4                                               1094 04821000
         CR    @15,@14                                             1094 04822000
         BNL   *+6                                                      04823000
         LR    @15,@14                                             1094 04824000
         ST    @15,HIGHTMD                                         1094 04825000
*   ELSE                                                           1095 04826000
*     IF MGPTYPE=MGPERR THEN                                       1095 04827000
         B     @RC01093                                            1095 04828000
@RF01093 CLI   MGPTYPE,3                                           1095 04829000
         BNE   @RF01095                                            1095 04830000
*       HIGHTMD=MAX(HIGHTMD,STOPPTF);/* STOP-SYSMOD                  */ 04831000
         L     @15,HIGHTMD                                         1096 04832000
         LA    @14,8                                               1096 04833000
         CR    @15,@14                                             1096 04834000
         BNL   *+6                                                      04835000
         LR    @15,@14                                             1096 04836000
         ST    @15,HIGHTMD                                         1096 04837000
*     ELSE                                                         1097 04838000
*       IF MGPTYPE=MGPSEV THEN                                     1097 04839000
         B     @RC01095                                            1097 04840000
@RF01095 CLI   MGPTYPE,4                                           1097 04841000
         BNE   @RF01097                                            1097 04842000
*         HIGHTMD=MAX(HIGHTMD,STOPFUNC);/* SEVERE                    */ 04843000
         L     @15,HIGHTMD                                         1098 04844000
         LA    @14,12                                              1098 04845000
         CR    @15,@14                                             1098 04846000
         BNL   *+6                                                      04847000
         LR    @15,@14                                             1098 04848000
         ST    @15,HIGHTMD                                         1098 04849000
*       ELSE                                                       1099 04850000
*         IF MGPTYPE=MGPTERM THEN                                  1099 04851000
         B     @RC01097                                            1099 04852000
@RF01097 CLI   MGPTYPE,5                                           1099 04853000
         BNE   @RF01099                                            1099 04854000
*           HIGHTMD=MAX(HIGHTMD,STOPSMP);/* TERMINATING              */ 04855000
         L     @15,HIGHTMD                                         1100 04856000
         LA    @14,16                                              1100 04857000
         CR    @15,@14                                             1100 04858000
         BNL   *+6                                                      04859000
         LR    @15,@14                                             1100 04860000
         ST    @15,HIGHTMD                                         1100 04861000
*   RETURN;                                                        1101 04862000
@EL00021 DS    0H                                                  1101 04863000
@EF00021 DS    0H                                                  1101 04864000
@ER00021 LM    @14,@12,@SA00021                                    1101 04865000
         BR    @14                                                 1101 04866000
*   END ERRMSG;                                                    1102 04867000
         B     @EL00021                                            1102 04868000
*                                                                  1103 04869000
*/********************************************************************/ 04870000
*/*                                                                  */ 04871000
*/*    INVALID  - FIND AND MARK NOGO ANY SYSMODS REMAINING IN THE    */ 04872000
*/*               ICT WHICH ARE NOT PROCESSED ... BUT SHOULD HAVE    */ 04873000
*/*               BEEN                                               */ 04874000
*/*                                                                  */ 04875000
*/*               THIS PROCEDURE WILL CATCH SYSMOD CONSTRUCTION      */ 04876000
*/*               ERRORS OF THE FORM,                                */ 04877000
*/*                                                                  */ 04878000
*/*                 ++FUNCTION(F000000) .                            */ 04879000
*/*                 ++VER(XXXX) PRE(P000000) .                       */ 04880000
*/*                                                                  */ 04881000
*/*                 ++PTF(P000000) .                                 */ 04882000
*/*                 ++VER(XXXX) FMID(F000000) .                      */ 04883000
*/*                                                                  */ 04884000
*/*               ... A FUNCTION SYSMOD PREREQS ANOTHER SYSMOD       */ 04885000
*/*               WHICH IN TURN NAMES THE FUNCTION AS ITS FMID.      */ 04886000
*/*                                                                  */ 04887000
*/*                                                                  */ 04888000
*/*    CONDITIONS UPON ENTRY:                                        */ 04889000
*/*                                                                  */ 04890000
*/*     *                                                            */ 04891000
*/*                                                                  */ 04892000
*/********************************************************************/ 04893000
*                                                                  1103 04894000
*INVALID:                                                          1103 04895000
*   PROC;                                                          1103 04896000
INVALID  STM   @14,@12,@SA00022                                    1103 04897000
*   DCL                                                            1104 04898000
*     IN FIXED(15);                 /* LOCAL INDEX - PTF SECT ENTRIES*/ 04899000
*   RESPECIFY                                                      1105 04900000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */ 04901000
*                                                                  1105 04902000
*   /*****************************************************************/ 04903000
*   /*                                                               */ 04904000
*   /* GO THRU THE ICT PTF SECTION                                   */ 04905000
*   /*                                                               */ 04906000
*   /*****************************************************************/ 04907000
*                                                                  1106 04908000
*   DO IN=1 BY 1 WHILE ICTPEND(IN)^=ICTENDNT/* NOT AT END            */ 04909000
*         &HIGHTMD<STOPFUNC;        /* NOT TERMINATING               */ 04910000
         LA    IN,1                                                1106 04911000
         B     @DE01106                                            1106 04912000
@DL01106 DS    0H                                                  1107 04913000
*     IF ICTPMSL(IN)=OFF            /* NOT PROCESSED                 */ 04914000
*         &ICTPNOGO(IN)=OFF         /* NOT NOGO                      */ 04915000
*         &ICTPGELM(IN)=OFF         /* NOT ELIMINATED                */ 04916000
*         &ICTPSUPN(IN)<=0          /* NOT SUPERSEDED                */ 04917000
*         &ICTPDEXP(IN)=OFF         /* NOT EXPLICITLY DELETED        */ 04918000
*         &ICTPDIMP(IN)=OFF         /* NOT IMPLICITLY DELETED        */ 04919000
*       THEN                                                       1107 04920000
         LR    @03,IN                                              1107 04921000
         MH    @03,@CH02382                                        1107 04922000
         L     @15,CCAICPTF(,CCAPTR)                               1107 04923000
         ST    @03,@TF00001                                        1107 04924000
         ALR   @03,@15                                             1107 04925000
         AL    @03,@CF02418                                        1107 04926000
         TM    ICTPMSL-15(@03),B'10000000'                         1107 04927000
         BNZ   @RF01107                                            1107 04928000
         LR    @03,@15                                             1107 04929000
         AL    @03,@TF00001                                        1107 04930000
         AL    @03,@CF02416                                        1107 04931000
         TM    ICTPNOGO-8(@03),B'01000000'                         1107 04932000
         BNZ   @RF01107                                            1107 04933000
         LR    @03,@15                                             1107 04934000
         AL    @03,@TF00001                                        1107 04935000
         AL    @03,@CF02415                                        1107 04936000
         TM    ICTPGELM-13(@03),B'00001000'                        1107 04937000
         BNZ   @RF01107                                            1107 04938000
         LR    @03,@15                                             1107 04939000
         AL    @03,@TF00001                                        1107 04940000
         AL    @03,@CF02443                                        1107 04941000
         CLC   ICTPSUPN-20(2,@03),@CH00083                         1107 04942000
         BH    @RF01107                                            1107 04943000
         LR    @03,@15                                             1107 04944000
         AL    @03,@TF00001                                        1107 04945000
         AL    @03,@CF02415                                        1107 04946000
         TM    ICTPDEXP-13(@03),B'00110000'                        1107 04947000
         BNZ   @RF01107                                            1107 04948000
*       DO;                                                        1108 04949000
*                                                                  1108 04950000
*         /***********************************************************/ 04951000
*         /*                                                         */ 04952000
*         /* A VALID SYSMOD FOUND WHICH HAS NOT BEEN PROCESSED ...   */ 04953000
*         /* ISSUE: HMA226I MESSAGE ... MARK SYSMOD NOGO             */ 04954000
*         /*                                                         */ 04955000
*         /***********************************************************/ 04956000
*                                                                  1109 04957000
*         MSGSMDNM=ICTPTFS(IN);     /* SET UP SYSMOD NAME FOR ERRMSG */ 04958000
         AL    @15,@TF00001                                        1109 04959000
         AL    @15,@CF02417                                        1109 04960000
         MVC   MSGSMDNM(7),ICTPTFS(@15)                            1109 04961000
*         MGPTYPE=MGPERR;           /* STOP-SYSMOD ERROR             */ 04962000
         MVI   MGPTYPE,X'03'                                       1110 04963000
*         CALL ERRMSG(HMA226I,PART011);                            1111 04964000
         LA    @01,@AL01111                                        1111 04965000
         BAL   @14,ERRMSG                                          1111 04966000
*         ICTPNOGO(IN)=ON;          /* SYSMOD IS NOGO                */ 04967000
*         ICTPCPL(IN)=ON;           /* SYSMOD IS COMPLETE            */ 04968000
*         ICTPMSG(IN)=ON;           /* NOGO MESSAGE HAS BEEN ISSUED  */ 04969000
*                                                                  1114 04970000
         LR    @03,IN                                              1114 04971000
         MH    @03,@CH02382                                        1114 04972000
         L     @15,CCAICPTF(,CCAPTR)                               1114 04973000
         ST    @03,@TF00001                                        1114 04974000
         ALR   @03,@15                                             1114 04975000
         AL    @03,@CF02416                                        1114 04976000
         OI    ICTPNOGO-8(@03),B'01110000'                         1114 04977000
*         /***********************************************************/ 04978000
*         /*                                                         */ 04979000
*         /* LOOK AT REQUISITES TO SEE WHY SYSMOD WAS NOT PROCESSED  */ 04980000
*         /*                                                         */ 04981000
*         /***********************************************************/ 04982000
*                                                                  1115 04983000
*         CALL INVMSG(ICTPTF(IN));  /* ISSUE MESSAGES CONCERNING   1115 04984000
*                                      UN-PROCESSED REQUISITES       */ 04985000
         L     @03,@TF00001                                        1115 04986000
         AL    @15,@CF02417                                        1115 04987000
         LA    @03,ICTPTF(@03,@15)                                 1115 04988000
         ST    @03,@AL00001                                        1115 04989000
         LA    @01,@AL00001                                        1115 04990000
         BAL   @14,INVMSG                                          1115 04991000
*         IF ICTPTYPE(IN)=IOPPFUNC  /* FUNCTION-TYPE SYSMOD          */ 04992000
*           THEN                                                   1116 04993000
         LR    @03,IN                                              1116 04994000
         MH    @03,@CH02382                                        1116 04995000
         L     @01,CCAICPTF(,CCAPTR)                               1116 04996000
         AL    @01,@CF02426                                        1116 04997000
         SLR   @00,@00                                             1116 04998000
         IC    @00,ICTPTYPE-17(@03,@01)                            1116 04999000
         CH    @00,@CH00040                                        1116 05000000
         BNE   @RF01116                                            1116 05001000
*           CALL ERRMSG(HMA370I,NOPART);/* ISSUE HMA370I             */ 05002000
         LA    @01,@AL01117                                        1117 05003000
         BAL   @14,ERRMSG                                          1117 05004000
*         CALL HMASMTCR(TBLXPARM,MSG);/* CHECK REQUISITES            */ 05005000
@RF01116 L     @03,@PC00001                                        1118 05006000
         ST    @03,@AL00001                                        1118 05007000
         LA    @03,@CC00717                                        1118 05008000
         ST    @03,@AL00001+4                                      1118 05009000
         L     @15,@CV01893                                        1118 05010000
         LA    @01,@AL00001                                        1118 05011000
         BALR  @14,@15                                             1118 05012000
*         RESPECIFY                                                1119 05013000
*           REG15 RSTD;                                            1119 05014000
*         HIGHTMD=MAX(HIGHTMD,REG15);                              1120 05015000
         L     @14,HIGHTMD                                         1120 05016000
         CR    @14,REG15                                           1120 05017000
         BNL   *+6                                                      05018000
         LR    @14,REG15                                           1120 05019000
         ST    @14,HIGHTMD                                         1120 05020000
*         RESPECIFY                                                1121 05021000
*           REG15 UNRSTD;                                          1121 05022000
*       END;                                                       1122 05023000
*   END;                            /* END LOOP THRU ICT PTF SECT    */ 05024000
@RF01107 AL    IN,@CF00065                                         1123 05025000
@DE01106 LR    @03,IN                                              1123 05026000
         MH    @03,@CH02382                                        1123 05027000
         L     @01,CCAICPTF(,CCAPTR)                               1123 05028000
         AL    @01,@CF02417                                        1123 05029000
         L     @03,ICTPEND(@03,@01)                                1123 05030000
         CL    @03,ICTENDNT                                        1123 05031000
         BE    @DC01106                                            1123 05032000
         L     @03,HIGHTMD                                         1123 05033000
         CH    @03,@CH00036                                        1123 05034000
         BL    @DL01106                                            1123 05035000
@DC01106 DS    0H                                                  1124 05036000
*   RETURN;                                                        1124 05037000
@EL00022 DS    0H                                                  1124 05038000
@EF00022 DS    0H                                                  1124 05039000
@ER00022 LM    @14,@12,@SA00022                                    1124 05040000
         BR    @14                                                 1124 05041000
*   END INVALID;                                                   1125 05042000
*                                                                  1126 05043000
*/********************************************************************/ 05044000
*/*                                                                  */ 05045000
*/*    INVMSG   - ISSUE MESSAGE HMA374I NAMING THE FMID AND PREREQS  */ 05046000
*/*               OF A SYSMOD WHICH COULD NOT BE PROCESSED           */ 05047000
*/*                                                                  */ 05048000
*/*    CONDITIONS UPON ENTRY:                                        */ 05049000
*/*                                                                  */ 05050000
*/*     *                                                            */ 05051000
*/*                                                                  */ 05052000
*/********************************************************************/ 05053000
*                                                                  1126 05054000
*INVMSG:                                                           1126 05055000
*   PROC(INVSYSMD);                                                1126 05056000
INVMSG   STM   @14,@12,@SA00023                                    1126 05057000
         MVC   @PC00023(4),0(@01)                                  1126 05058000
*   DCL                                                            1127 05059000
*     INVSYSMD CHAR(*);             /* ICT PTF SECT ENTRY            */ 05060000
*   DCL                                                            1128 05061000
*     INV FIXED(15);                /* INDEX                         */ 05062000
*   DCL                                                            1129 05063000
*     INVMSL CHAR(1);               /* LOCAL VARIABLE                */ 05064000
*   RESPECIFY                                                      1130 05065000
*     ICTPTF BASED(ADDR(INVSYSMD)); /* ADDRESS PTF SECT ENTRY PASSED */ 05066000
*                                                                  1130 05067000
*   /*****************************************************************/ 05068000
*   /*                                                               */ 05069000
*   /* SET UP FOR ERRMSG                                             */ 05070000
*   /*                                                               */ 05071000
*   /*****************************************************************/ 05072000
*                                                                  1131 05073000
*   MGPTYPE=MGPINFO;                /* INFORMATIONAL MESSAGES        */ 05074000
*                                                                  1131 05075000
         MVI   MGPTYPE,X'01'                                       1131 05076000
*   /*****************************************************************/ 05077000
*   /*                                                               */ 05078000
*   /* SEE IF THE FMID IS UN-PROCESSED AND THEREBY PREVENTED THE     */ 05079000
*   /* "CURRENT" SYSMOD FROM BEING PROCESSED                         */ 05080000
*   /*                                                               */ 05081000
*   /*****************************************************************/ 05082000
*                                                                  1132 05083000
*   VPARTS=' ';                     /* BLANK VARIABLE PARTS          */ 05084000
         MVI   VPARTS+1,C' '                                       1132 05085000
         MVC   VPARTS+2(22),VPARTS+1                               1132 05086000
         MVI   VPARTS,C' '                                         1132 05087000
*   VPART#1=MSGFMID;                /* PUT "FMID" IN MESSAGE         */ 05088000
         MVC   VPART#1(8),@CC01999                                 1133 05089000
*   VPART#2=ICTPFMID(1);            /* FILL IN FMID SYSMOD-ID#       */ 05090000
         MVI   VPART#2+7,C' '                                      1134 05091000
         L     @15,@PC00023                                        1134 05092000
         MVC   VPART#2(7),ICTPFMID(@15)                            1134 05093000
*   CALL MSLCHK(ICTPFMID(1),INVMSL);/* IS IT PROCESSED               */ 05094000
         LA    @15,ICTPFMID(,@15)                                  1135 05095000
         ST    @15,@AL00001                                        1135 05096000
         LA    @15,INVMSL                                          1135 05097000
         ST    @15,@AL00001+4                                      1135 05098000
         LA    @01,@AL00001                                        1135 05099000
         BAL   @14,MSLCHK                                          1135 05100000
*   IF INVMSL=UNPROC THEN                                          1136 05101000
         CLI   INVMSL,C'U'                                         1136 05102000
         BNE   @RF01136                                            1136 05103000
*     CALL ERRMSG(HMA374I,NOPART);  /* ISSUE MESSAGE                 */ 05104000
*                                                                  1137 05105000
         LA    @01,@AL01137                                        1137 05106000
         BAL   @14,ERRMSG                                          1137 05107000
*   /*****************************************************************/ 05108000
*   /*                                                               */ 05109000
*   /* SEE IF THERE ARE ANY UN-PROCESSED PREREQS WHICH PREVENTED THE */ 05110000
*   /* "CURRENT" SYSMOD FROM BEING PROCESSED                         */ 05111000
*   /*                                                               */ 05112000
*   /*****************************************************************/ 05113000
*                                                                  1138 05114000
*   RESPECIFY                                                      1138 05115000
*     ICTPRELS BASED(ICTPPCHN(1));  /* ADDRESS PREREQ LIST FOR THIS     05116000
*                                      SYSMOD                        */ 05117000
@RF01136 DS    0H                                                  1139 05118000
*   VPARTS=' ';                     /* BLANK VARIABLE PARTS          */ 05119000
         MVI   VPARTS+1,C' '                                       1139 05120000
         MVC   VPARTS+2(22),VPARTS+1                               1139 05121000
         MVI   VPARTS,C' '                                         1139 05122000
*   VPART#1=MSGPRE;                 /* PUT "PREREQ" IN MESSAGE       */ 05123000
         MVC   VPART#1(8),@CC01997                                 1140 05124000
*   DO INV=1 BY 1 WHILE ICTPREND(INV)^=ICTENDIX;                   1141 05125000
         LA    INV,1                                               1141 05126000
         B     @DE01141                                            1141 05127000
@DL01141 DS    0H                                                  1142 05128000
*     VPART#2=ICTPRENM(1);          /* FILL IN PREREQ SYSMOD-ID#     */ 05129000
         MVI   VPART#2+7,C' '                                      1142 05130000
         L     @03,@PC00023                                        1142 05131000
         L     @03,ICTPPCHN(,@03)                                  1142 05132000
         MVC   VPART#2(7),ICTPRENM(@03)                            1142 05133000
*     CALL MSLCHK(ICTPRENM(1),INVMSL);/* IS IT PROCESSED             */ 05134000
         ST    @03,@AL00001                                        1143 05135000
         LA    @03,INVMSL                                          1143 05136000
         ST    @03,@AL00001+4                                      1143 05137000
         LA    @01,@AL00001                                        1143 05138000
         BAL   @14,MSLCHK                                          1143 05139000
*     IF INVMSL=UNPROC THEN                                        1144 05140000
         CLI   INVMSL,C'U'                                         1144 05141000
         BNE   @RF01144                                            1144 05142000
*       CALL ERRMSG(HMA374I,NOPART);/* ISSUE MESSAGE                 */ 05143000
         LA    @01,@AL01145                                        1145 05144000
         BAL   @14,ERRMSG                                          1145 05145000
*   END;                            /* END OF PREREQ LIST            */ 05146000
@RF01144 AL    INV,@CF00065                                        1146 05147000
@DE01141 LR    @03,INV                                             1146 05148000
         SLA   @03,3                                               1146 05149000
         L     @15,@PC00023                                        1146 05150000
         L     @01,ICTPPCHN(,@15)                                  1146 05151000
         AL    @01,@CF02434                                        1146 05152000
         L     @03,ICTPREND(@03,@01)                               1146 05153000
         CL    @03,ICTENDIX                                        1146 05154000
         BNE   @DL01141                                            1146 05155000
*   RETURN;                                                        1147 05156000
@EL00023 DS    0H                                                  1147 05157000
@EF00023 DS    0H                                                  1147 05158000
@ER00023 LM    @14,@12,@SA00023                                    1147 05159000
         BR    @14                                                 1147 05160000
*   END INVMSG;                                                    1148 05161000
*                                                                  1149 05162000
*/********************************************************************/ 05163000
*/*                                                                  */ 05164000
*/*    MSLCHK   - RETURN AN INDICATION OF THE ELEMENT SELECTION      */ 05165000
*/*               PROCESSING STATUS OF THE SYSMOD PASSED BY THE      */ 05166000
*/*               CALLER.                                            */ 05167000
*/*                                                                  */ 05168000
*/*                                                                  */ 05169000
*/*    RETURN IN PARAMETER "MSL":                                    */ 05170000
*/*                                                                  */ 05171000
*/*               'N' - NOT FOUND IN ICT.                            */ 05172000
*/*                                                                  */ 05173000
*/*               'U' - FOUND IN ICT BUT NOT NOT PROCESSED.          */ 05174000
*/*                                                                  */ 05175000
*/*               'P' - FOUND IN ICT AND PROCESSED.                  */ 05176000
*/*                                                                  */ 05177000
*/*                                                                  */ 05178000
*/*                                                                  */ 05179000
*/********************************************************************/ 05180000
*                                                                  1149 05181000
*MSLCHK:                                                           1149 05182000
*   PROC(MSLSYSMD,MSL);                                            1149 05183000
MSLCHK   STM   @14,@12,12(@13)                                     1149 05184000
         MVC   @PC00024(8),0(@01)                                  1149 05185000
*   DCL                                                            1150 05186000
*     MSLSYSMD CHAR(7);             /* A SYSMOD NAME                 */ 05187000
*   DCL                                                            1151 05188000
*     MSL CHAR(1);                  /* RETURN PARAMETER (SEE ABOVE)  */ 05189000
*   DCL                                                            1152 05190000
*     LL FIXED(15);                 /* LOCAL INDEX ... ICT PTF SECT     05191000
*                                      ENTRIES                       */ 05192000
*   RESPECIFY                                                      1153 05193000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */ 05194000
*                                                                  1153 05195000
*   /*****************************************************************/ 05196000
*   /*                                                               */ 05197000
*   /* GO THRU THE ICT PTF SECTION                                   */ 05198000
*   /*                                                               */ 05199000
*   /*****************************************************************/ 05200000
*                                                                  1154 05201000
*   MSL=NOTFND;                     /* INITIALLY SET RETURN PARM TO     05202000
*                                      "NOT FOUND"                   */ 05203000
         L     @15,@PC00024+4                                      1154 05204000
         MVI   MSL(@15),C'N'                                       1154 05205000
*   DO LL=1 BY 1 WHILE ICTPEND(LL)^=ICTENDNT&MSL=NOTFND;           1155 05206000
         LA    LL,1                                                1155 05207000
         B     @DE01155                                            1155 05208000
@DL01155 DS    0H                                                  1156 05209000
*     IF ICTPTFS(LL)=MSLSYSMD       /* SPECIFIED SYSMOD              */ 05210000
*       THEN                                                       1156 05211000
         LR    @03,LL                                              1156 05212000
         MH    @03,@CH02382                                        1156 05213000
         L     @15,CCAICPTF(,CCAPTR)                               1156 05214000
         L     @14,@PC00024                                        1156 05215000
         ST    @03,@TF00001                                        1156 05216000
         ALR   @03,@15                                             1156 05217000
         AL    @03,@CF02417                                        1156 05218000
         CLC   ICTPTFS(7,@03),MSLSYSMD(@14)                        1156 05219000
         BNE   @RF01156                                            1156 05220000
*       DO;                                                        1157 05221000
*         IF ICTPMSL(LL)=ON         /* SYSMOD PROCESSED              */ 05222000
*           THEN                                                   1158 05223000
         AL    @15,@TF00001                                        1158 05224000
         AL    @15,@CF02418                                        1158 05225000
         TM    ICTPMSL-15(@15),B'10000000'                         1158 05226000
         BNO   @RF01158                                            1158 05227000
*           MSL=PROCESSD;           /* RETURN PARM TO "PROCESSED"    */ 05228000
         L     @03,@PC00024+4                                      1159 05229000
         MVI   MSL(@03),C'P'                                       1159 05230000
*         ELSE                                                     1160 05231000
*           MSL=UNPROC;             /* RETURN PARM TO "UNPROCESSED"  */ 05232000
         B     @RC01158                                            1160 05233000
@RF01158 L     @03,@PC00024+4                                      1160 05234000
         MVI   MSL(@03),C'U'                                       1160 05235000
*       END;                                                       1161 05236000
@RC01158 DS    0H                                                  1162 05237000
*   END;                                                           1162 05238000
@RF01156 AL    LL,@CF00065                                         1162 05239000
@DE01155 LR    @03,LL                                              1162 05240000
         MH    @03,@CH02382                                        1162 05241000
         L     @01,CCAICPTF(,CCAPTR)                               1162 05242000
         AL    @01,@CF02417                                        1162 05243000
         L     @03,ICTPEND(@03,@01)                                1162 05244000
         CL    @03,ICTENDNT                                        1162 05245000
         BE    @DC01155                                            1162 05246000
         L     @03,@PC00024+4                                      1162 05247000
         CLI   MSL(@03),C'N'                                       1162 05248000
         BE    @DL01155                                            1162 05249000
@DC01155 DS    0H                                                  1163 05250000
*   RETURN;                                                        1163 05251000
@EL00024 DS    0H                                                  1163 05252000
@EF00024 DS    0H                                                  1163 05253000
@ER00024 LM    @14,@12,12(@13)                                     1163 05254000
         BR    @14                                                 1163 05255000
*   END MSLCHK;                                                    1164 05256000
*                                                                  1165 05257000
*/********************************************************************/ 05258000
*/*                                                                  */ 05259000
*/*    CHKASSEM - CHECK THE ASSEMBLY ENTRY PASSED TO SEE IF IT       */ 05260000
*/*               SHOULD POTENTIALLY BE SELECTED                     */ 05261000
*/*                                                                  */ 05262000
*/*               AN ASSEMBLY ENTRY WHICH SHOULD POTENTIALLY BE      */ 05263000
*/*               SELECTED IS ONE CREATED FOR A SELECTED ++SRC,      */ 05264000
*/*               ++SRCUPD, ++MAC OR ++MACUPD ELEMENT.  NOTE THAT    */ 05265000
*/*               IT IS POSSIBLE TO HAVE ASSEMBLY ENTRIES IN THE     */ 05266000
*/*               ICT MOD SECTION WHICH WERE CREATED WHEN AN ELEMENT */ 05267000
*/*               WAS PROCESSED BY HMASMTMS BUT WAS LATER MADE       */ 05268000
*/*               INVALID BY A SYSMOD SPECIFYING THE DELETION OF     */ 05269000
*/*               THE PREVIOUSLY PROCESSED ELEMENT.                  */ 05270000
*/*                                                                  */ 05271000
*/*    CONDITIONS UPON ENTRY:                                        */ 05272000
*/*                                                                  */ 05273000
*/*     *                                                            */ 05274000
*/*                                                                  */ 05275000
*/********************************************************************/ 05276000
*                                                                  1165 05277000
*CHKASSEM:                                                         1165 05278000
*   PROC(ASMENTRY,CHKAPTR);                                        1165 05279000
CHKASSEM STM   @14,@12,12(@13)                                     1165 05280000
         MVC   @PC00025(8),0(@01)                                  1165 05281000
*   DCL                                                            1166 05282000
*     ASMENTRY CHAR(*);             /* MOD SECT ASSEMBLY ENTRY       */ 05283000
*   DCL                                                            1167 05284000
*     CHKAPTR PTR(31);              /* PTR RETURNED TO CALLER ......    05285000
*                                      NON-ZERO => ASSEMBLY IS FOR A    05286000
*                                      SELECTED SRC/SRCUPD OR MACRO  */ 05287000
*   DCL                                                            1168 05288000
*     IN3 FIXED(15);                /* INDEX                         */ 05289000
*   DCL                                                            1169 05290000
*     IN4 FIXED(15);                /* INDEX                         */ 05291000
*   RESPECIFY                                                      1170 05292000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */ 05293000
*   CHKAPTR=0;                      /* CLEAR PTR RETURNED TO CALLER  */ 05294000
*                                                                  1171 05295000
         L     @15,@PC00025+4                                      1171 05296000
         SLR   @14,@14                                             1171 05297000
         ST    @14,CHKAPTR(,@15)                                   1171 05298000
*   /*****************************************************************/ 05299000
*   /*                                                               */ 05300000
*   /* GO THRU ICT MOD SECTION AND EXAMINE SRC/SRCUPD AND MACRO      */ 05301000
*   /* ENTRIES TO SEE IF A SELECTED ONE CAUSED THE CREATION OF THIS  */ 05302000
*   /* ASSEMBLY ENTRY                                                */ 05303000
*   /*                                                               */ 05304000
*   /*****************************************************************/ 05305000
*                                                                  1172 05306000
*   DO IN3=1 BY 1 WHILE ICTMEND(IN3)^=ICTENDNT/* NOT AT END          */ 05307000
*         &CHKAPTR=0;               /* NOT YET FOUND                 */ 05308000
         LA    IN3,1                                               1172 05309000
         B     @DE01172                                            1172 05310000
@DL01172 DS    0H                                                  1173 05311000
*     RESPECIFY                                                    1173 05312000
*       ICTASMLS BASED(ICTMACHN(IN3));/* ADDRESS LIST OF ASSEMBLY  1173 05313000
*                                      ENTRY ADDRESSES               */ 05314000
*     IF(ICTMSRCR(IN3)=ON           /* ++SRC - SRC REPLACEMENT       */ 05315000
*         |ICTMSRCU(IN3)=ON         /* ++SRCUPD - SRC UPDATE         */ 05316000
*         |ICTMMACR(IN3)=ON         /* ++MAC - MACRO REPLACEMENT     */ 05317000
*         |ICTMMACU(IN3)=ON)        /* ++MACUPD - MACRO UPDATE       */ 05318000
*         &ICTMISEL(IN3)=ON         /* SELECTED                      */ 05319000
*       THEN                                                       1174 05320000
         LR    @03,IN3                                             1174 05321000
         MH    @03,@CH02383                                        1174 05322000
         L     @15,CCAICMOD(,CCAPTR)                               1174 05323000
         ST    @03,@TF00001                                        1174 05324000
         ALR   @03,@15                                             1174 05325000
         AL    @03,@CF02420                                        1174 05326000
         TM    ICTMSRCR-9(@03),B'00001111'                         1174 05327000
         BZ    @RF01174                                            1174 05328000
         AL    @15,@TF00001                                        1174 05329000
         AL    @15,@CF02421                                        1174 05330000
         TM    ICTMISEL-11(@15),B'10000000'                        1174 05331000
         BNO   @RF01174                                            1174 05332000
*       DO;                                                        1175 05333000
*                                                                  1175 05334000
*         /***********************************************************/ 05335000
*         /*                                                         */ 05336000
*         /* GO THRU THE LIST OF ASSEMBLY ENTRIES CAUSED BY THIS     */ 05337000
*         /* SELECTED SRC/SRCUPD/MACRO ELEMENT                       */ 05338000
*         /*                                                         */ 05339000
*         /***********************************************************/ 05340000
*                                                                  1176 05341000
*         DO IN4=1 BY 1 WHILE ICTASMND(IN4)^=ICTENDIX/* ^END         */ 05342000
*               &CHKAPTR=0;         /* NOT YET FOUND                 */ 05343000
         LA    IN4,1                                               1176 05344000
         B     @DE01176                                            1176 05345000
@DL01176 DS    0H                                                  1177 05346000
*           IF ICTASMAD(IN4)=ADDR(ASMENTRY)/* ASSEMBLY PASSED WAS  1177 05347000
*                                      CAUSED BY THIS ELEMENT        */ 05348000
*             THEN                                                 1177 05349000
         LR    @15,IN4                                             1177 05350000
         SLA   @15,2                                               1177 05351000
         LR    @14,IN3                                             1177 05352000
         MH    @14,@CH02383                                        1177 05353000
         L     @07,CCAICMOD(,CCAPTR)                               1177 05354000
         LA    @01,0(@14,@07)                                      1177 05355000
         AL    @01,@CF02445                                        1177 05356000
         L     @01,ICTMACHN-112(,@01)                              1177 05357000
         L     @00,@PC00025                                        1177 05358000
         LR    @06,@00                                             1177 05359000
         AL    @01,@CF02424                                        1177 05360000
         C     @06,ICTASMAD(@15,@01)                               1177 05361000
         BNE   @RF01177                                            1177 05362000
*             CHKAPTR=ADDR(ICTMOD(IN3));/* SET PTR RETURNED TO CALLER*/ 05363000
         L     @15,@PC00025+4                                      1178 05364000
         AL    @07,@CF02422                                        1178 05365000
         LA    @14,ICTMOD(@14,@07)                                 1178 05366000
         ST    @14,CHKAPTR(,@15)                                   1178 05367000
*         END;                      /* END OF LOOP THRU ASSEMBLY   1179 05368000
*                                      ENTRIES LIST                  */ 05369000
@RF01177 AL    IN4,@CF00065                                        1179 05370000
@DE01176 LR    @15,IN4                                             1179 05371000
         SLA   @15,2                                               1179 05372000
         LR    @14,IN3                                             1179 05373000
         MH    @14,@CH02383                                        1179 05374000
         L     @01,CCAICMOD(,CCAPTR)                               1179 05375000
         AL    @01,@CF02445                                        1179 05376000
         L     @01,ICTMACHN-112(@14,@01)                           1179 05377000
         AL    @01,@CF02424                                        1179 05378000
         L     @15,ICTASMND(@15,@01)                               1179 05379000
         CL    @15,ICTENDIX                                        1179 05380000
         BE    @DC01176                                            1179 05381000
         L     @15,@PC00025+4                                      1179 05382000
         ICM   @14,15,CHKAPTR(@15)                                 1179 05383000
         BZ    @DL01176                                            1179 05384000
@DC01176 DS    0H                                                  1180 05385000
*       END;                        /* END OF LOOP THRU ICT MOD    1180 05386000
*                                      SECTION                       */ 05387000
*   END;                                                           1181 05388000
@RF01174 AL    IN3,@CF00065                                        1181 05389000
@DE01172 LR    @03,IN3                                             1181 05390000
         MH    @03,@CH02383                                        1181 05391000
         L     @01,CCAICMOD(,CCAPTR)                               1181 05392000
         AL    @01,@CF02422                                        1181 05393000
         L     @03,ICTMEND(@03,@01)                                1181 05394000
         CL    @03,ICTENDNT                                        1181 05395000
         BE    @DC01172                                            1181 05396000
         L     @03,@PC00025+4                                      1181 05397000
         ICM   @15,15,CHKAPTR(@03)                                 1181 05398000
         BZ    @DL01172                                            1181 05399000
@DC01172 DS    0H                                                  1182 05400000
*   RETURN;                                                        1182 05401000
@EL00025 DS    0H                                                  1182 05402000
@EF00025 DS    0H                                                  1182 05403000
@ER00025 LM    @14,@12,12(@13)                                     1182 05404000
         BR    @14                                                 1182 05405000
*   END CHKASSEM;                                                  1183 05406000
*                                                                  1184 05407000
*/********************************************************************/ 05408000
*/*                                                                  */ 05409000
*/*    SRCHMOD  - FIND A SELECTED ++MOD REPLACEMENT-TYPE MOD SECT    */ 05410000
*/*               ENTRY FOR THE CALLER-SPECIFIED ELEMENT NAME        */ 05411000
*/*                                                                  */ 05412000
*/*    CONDITIONS UPON ENTRY:                                        */ 05413000
*/*                                                                  */ 05414000
*/*     *                                                            */ 05415000
*/*                                                                  */ 05416000
*/********************************************************************/ 05417000
*                                                                  1184 05418000
*SRCHMOD:                                                          1184 05419000
*   PROC(SRCHMN,SRCHMP);                                           1184 05420000
SRCHMOD  STM   @14,@12,12(@13)                                     1184 05421000
         MVC   @PC00026(8),0(@01)                                  1184 05422000
*   DCL                                                            1185 05423000
*     SRCHMN CHAR(8);               /* ELEMENT NAME                  */ 05424000
*   DCL                                                            1186 05425000
*     SRCHMP PTR(31);               /* PTR RETURNED TO CALLER ......    05426000
*                                      NON-ZERO => POINTS TO SELECTED   05427000
*                                      MOD REPL ENTRY IN ICT         */ 05428000
*   DCL                                                            1187 05429000
*     IN5 FIXED(15);                /* INDEX                         */ 05430000
*   RESPECIFY                                                      1188 05431000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */ 05432000
*   SRCHMP=0;                       /* CLEAR PTR RETURNED TO CALLER  */ 05433000
*                                                                  1189 05434000
         L     @15,@PC00026+4                                      1189 05435000
         SLR   @14,@14                                             1189 05436000
         ST    @14,SRCHMP(,@15)                                    1189 05437000
*   /*****************************************************************/ 05438000
*   /*                                                               */ 05439000
*   /* GO THRU ICT MOD SECTION                                       */ 05440000
*   /*                                                               */ 05441000
*   /*****************************************************************/ 05442000
*                                                                  1190 05443000
*   DO IN5=1 BY 1 WHILE ICTMEND(IN5)^=ICTENDNT/* NOT AT END          */ 05444000
*         &SRCHMP=0;                /* NOT YET FOUND                 */ 05445000
         LA    IN5,1                                               1190 05446000
         B     @DE01190                                            1190 05447000
@DL01190 DS    0H                                                  1191 05448000
*     IF ICTMNAME(IN5)=SRCHMN       /* ELEMENT NAMES THE SAME        */ 05449000
*         &ICTMMOD(IN5)=ON          /* MOD REPLACEMENT ENTRY         */ 05450000
*         &ICTMASM(IN5)=OFF         /* NOT ASSEMBLY ENTRY            */ 05451000
*         &ICTMISEL(IN5)=ON         /* SELECTED                      */ 05452000
*       THEN                                                       1191 05453000
         LR    @03,IN5                                             1191 05454000
         MH    @03,@CH02383                                        1191 05455000
         L     @15,CCAICMOD(,CCAPTR)                               1191 05456000
         L     @14,@PC00026                                        1191 05457000
         ST    @03,@TF00001                                        1191 05458000
         ALR   @03,@15                                             1191 05459000
         AL    @03,@CF02422                                        1191 05460000
         CLC   ICTMNAME(8,@03),SRCHMN(@14)                         1191 05461000
         BNE   @RF01191                                            1191 05462000
         LR    @03,@15                                             1191 05463000
         AL    @03,@TF00001                                        1191 05464000
         AL    @03,@CF02420                                        1191 05465000
         TM    ICTMMOD-9(@03),B'10000000'                          1191 05466000
         BNO   @RF01191                                            1191 05467000
         TM    ICTMASM-9(@03),B'01000000'                          1191 05468000
         BNZ   @RF01191                                            1191 05469000
         LR    @03,@15                                             1191 05470000
         AL    @03,@TF00001                                        1191 05471000
         AL    @03,@CF02421                                        1191 05472000
         TM    ICTMISEL-11(@03),B'10000000'                        1191 05473000
         BNO   @RF01191                                            1191 05474000
*       SRCHMP=ADDR(ICTMOD(IN5));   /* RETURN PTR TO CALLER          */ 05475000
         L     @03,@PC00026+4                                      1192 05476000
         L     @14,@TF00001                                        1192 05477000
         AL    @15,@CF02422                                        1192 05478000
         LA    @15,ICTMOD(@14,@15)                                 1192 05479000
         ST    @15,SRCHMP(,@03)                                    1192 05480000
*   END;                                                           1193 05481000
@RF01191 AL    IN5,@CF00065                                        1193 05482000
@DE01190 LR    @03,IN5                                             1193 05483000
         MH    @03,@CH02383                                        1193 05484000
         L     @01,CCAICMOD(,CCAPTR)                               1193 05485000
         AL    @01,@CF02422                                        1193 05486000
         L     @03,ICTMEND(@03,@01)                                1193 05487000
         CL    @03,ICTENDNT                                        1193 05488000
         BE    @DC01190                                            1193 05489000
         L     @03,@PC00026+4                                      1193 05490000
         ICM   @15,15,SRCHMP(@03)                                  1193 05491000
         BZ    @DL01190                                            1193 05492000
@DC01190 DS    0H                                                  1194 05493000
*   RETURN;                                                        1194 05494000
@EL00026 DS    0H                                                  1194 05495000
@EF00026 DS    0H                                                  1194 05496000
@ER00026 LM    @14,@12,12(@13)                                     1194 05497000
         BR    @14                                                 1194 05498000
*   END SRCHMOD;                                                   1195 05499000
*                                                                  1196 05500000
*/********************************************************************/ 05501000
*/*                                                                  */ 05502000
*/*    ELIMASM  - ELIMINATE ANY SELECTED ASSEMBLY ENTRIES IN THE ICT */ 05503000
*/*               MOD SECTION WHICH CALL FOR THE ASSEMBLY OF THE     */ 05504000
*/*               SAME ELEMENT AS THE ENTRY PASSED.                  */ 05505000
*/*                                                                  */ 05506000
*/*    CONDITIONS UPON ENTRY:                                        */ 05507000
*/*                                                                  */ 05508000
*/*     *                                                            */ 05509000
*/*                                                                  */ 05510000
*/********************************************************************/ 05511000
*                                                                  1196 05512000
*ELIMASM:                                                          1196 05513000
*   PROC(ELIMASME);                                                1196 05514000
ELIMASM  STM   @14,@12,12(@13)                                     1196 05515000
         MVC   @PC00027(4),0(@01)                                  1196 05516000
*   DCL                                                            1197 05517000
*     ELIMASME CHAR(*);             /* ASSEMBLY ENTRY                */ 05518000
*   DCL                                                            1198 05519000
*     ELIMASMN CHAR(8);             /* ASSEMBLY ELEMENT NAME         */ 05520000
*   DCL                                                            1199 05521000
*     IN6 FIXED(15);                /* INDEX                         */ 05522000
*   RESPECIFY                                                      1200 05523000
*     ICTMOD BASED(ADDR(ELIMASME)); /* ADDRESS MOD ENTRY PASSED      */ 05524000
*   ELIMASMN=ICTMNAME(1);           /* SAVE ASSEMBLY ELEMENT NAME    */ 05525000
         L     @15,@PC00027                                        1201 05526000
         MVC   ELIMASMN(8),ICTMNAME(@15)                           1201 05527000
*   RESPECIFY                                                      1202 05528000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */ 05529000
*                                                                  1203 05530000
*   /*****************************************************************/ 05531000
*   /*                                                               */ 05532000
*   /* GO THRU ICT MOD SECTION                                       */ 05533000
*   /*                                                               */ 05534000
*   /*****************************************************************/ 05535000
*                                                                  1203 05536000
*   DO IN6=1 BY 1 WHILE ICTMEND(IN6)^=ICTENDNT;/* NOT AT END         */ 05537000
         LA    IN6,1                                               1203 05538000
         B     @DE01203                                            1203 05539000
@DL01203 DS    0H                                                  1204 05540000
*     IF ICTMNAME(IN6)=ELIMASMN     /* ELEMENT NAMES THE SAME        */ 05541000
*         &ICTMMOD(IN6)=ON          /* MOD REPLACEMENT ENTRY         */ 05542000
*         &ICTMASM(IN6)=ON          /* ASSEMBLY ENTRY                */ 05543000
*         &ICTMISEL(IN6)=ON         /* SELECTED                      */ 05544000
*         &ADDR(ICTMOD(IN6))^=ADDR(ELIMASME)/* NOT ENTRY PASSED      */ 05545000
*       THEN                                                       1204 05546000
         LR    @03,IN6                                             1204 05547000
         MH    @03,@CH02383                                        1204 05548000
         L     @15,CCAICMOD(,CCAPTR)                               1204 05549000
         ST    @03,@TF00001                                        1204 05550000
         ALR   @03,@15                                             1204 05551000
         AL    @03,@CF02422                                        1204 05552000
         CLC   ICTMNAME(8,@03),ELIMASMN                            1204 05553000
         BNE   @RF01204                                            1204 05554000
         LR    @03,@15                                             1204 05555000
         AL    @03,@TF00001                                        1204 05556000
         AL    @03,@CF02420                                        1204 05557000
         TM    ICTMMOD-9(@03),B'11000000'                          1204 05558000
         BNO   @RF01204                                            1204 05559000
         LR    @03,@15                                             1204 05560000
         AL    @03,@TF00001                                        1204 05561000
         AL    @03,@CF02421                                        1204 05562000
         TM    ICTMISEL-11(@03),B'10000000'                        1204 05563000
         BNO   @RF01204                                            1204 05564000
         L     @03,@TF00001                                        1204 05565000
         AL    @03,@CF02422                                        1204 05566000
         LA    @03,ICTMOD(@03,@15)                                 1204 05567000
         L     @14,@PC00027                                        1204 05568000
         CR    @03,@14                                             1204 05569000
         BE    @RF01204                                            1204 05570000
*       DO;                                                        1205 05571000
*         ICTMSELM(IN6)=ON;         /* SET ELIMINATED FLAG           */ 05572000
*         ICTMISEL(IN6)=OFF;        /* CLEAR SELECTED FLAG           */ 05573000
         AL    @15,@TF00001                                        1207 05574000
         AL    @15,@CF02421                                        1207 05575000
         OI    ICTMSELM-11(@15),B'00100000'                        1207 05576000
         NI    ICTMISEL-11(@15),B'01111111'                        1207 05577000
*       END;                                                       1208 05578000
*   END;                                                           1209 05579000
@RF01204 AL    IN6,@CF00065                                        1209 05580000
@DE01203 LR    @03,IN6                                             1209 05581000
         MH    @03,@CH02383                                        1209 05582000
         L     @01,CCAICMOD(,CCAPTR)                               1209 05583000
         AL    @01,@CF02422                                        1209 05584000
         L     @03,ICTMEND(@03,@01)                                1209 05585000
         CL    @03,ICTENDNT                                        1209 05586000
         BNE   @DL01203                                            1209 05587000
*   RETURN;                                                        1210 05588000
@EL00027 DS    0H                                                  1210 05589000
@EF00027 DS    0H                                                  1210 05590000
@ER00027 LM    @14,@12,12(@13)                                     1210 05591000
         BR    @14                                                 1210 05592000
*   END ELIMASM;                                                   1211 05593000
*                                                                  1212 05594000
*/********************************************************************/ 05595000
*/*                                                                  */ 05596000
*/*    RMODICT  - LOOK FOR A REPLACEMENT VERSION OF AN ELEMENT IN    */ 05597000
*/*               THE ICT MOD SECTION                                */ 05598000
*/*                                                                  */ 05599000
*/*             - PASSED ELEMENT-NAME AND IOPPIND-VALUE ELEMENT-TYPE */ 05600000
*/*                                                                  */ 05601000
*/*             - IOPPIND-VALUE     TYPE OF ICT MOD ENTRY RETURNED   */ 05602000
*/*                 PASSED                                           */ 05603000
*/*                                                                  */ 05604000
*/*               --------------    -------------------------------- */ 05605000
*/*                                                                  */ 05606000
*/*                IOPPMOD          MOD REPLACEMENT (ICTMMOD=ON)     */ 05607000
*/*                IOPPMAC          MAC REPLACEMENT (ICTMMACR=ON)    */ 05608000
*/*                IOPPMACU         MAC REPLACEMENT (ICTMMACR=ON)    */ 05609000
*/*                IOPPSRC          SRC REPLACEMENT (ICTMSRCR=ON)    */ 05610000
*/*                IOPPSRCU         SRC REPLACEMENT (ICTMSRCR=ON)    */ 05611000
*/*                                                                  */ 05612000
*/*                                                                  */ 05613000
*/*                                                                  */ 05614000
*/*    CONDITIONS UPON ENTRY:                                        */ 05615000
*/*                                                                  */ 05616000
*/*     *                                                            */ 05617000
*/*                                                                  */ 05618000
*/********************************************************************/ 05619000
*                                                                  1212 05620000
*RMODICT:                                                          1212 05621000
*   PROC(ELMNNAME,ELMNTYPE,ELMNPTR);                               1212 05622000
RMODICT  STM   @14,@12,12(@13)                                     1212 05623000
         MVC   @PC00028(12),0(@01)                                 1212 05624000
*   DCL                                                            1213 05625000
*     ELMNNAME CHAR(8);             /* ELEMENT NAME TO BE FOUND      */ 05626000
*   DCL                                                            1214 05627000
*     ELMNTYPE FIXED(8);            /* ELEMENT TYPE - IOPPIND VALUES */ 05628000
*   DCL                                                            1215 05629000
*     ELMNPTR PTR(31);              /* RETURNS PTR TO ICT MOD SECT 1215 05630000
*                                      ENTRY (IF FOUND) ............    05631000
*                                      RETRUNS 0 IF ENTRY NOT FOUND  */ 05632000
*   DCL                                                            1216 05633000
*     MJ FIXED(15);                 /* INDEX - MOD SECT ENTRIES      */ 05634000
*   DCL                                                            1217 05635000
*     ETSTTYPE FIXED(8);            /* LOCAL VARIABLE - NON-REGRESSED   05636000
*                                      IOPPIND VALUE                 */ 05637000
*   RESPECIFY                                                      1218 05638000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECT       */ 05639000
*   ELMNPTR=0;                      /* CLEAR PTR RETURNED TO CALLER  */ 05640000
         L     @15,@PC00028+8                                      1219 05641000
         SLR   @14,@14                                             1219 05642000
         ST    @14,ELMNPTR(,@15)                                   1219 05643000
*   IF ELMNTYPE>=IOPPREG            /* REGRESSED IOPPIND VALUE       */ 05644000
*     THEN                                                         1220 05645000
         L     @15,@PC00028+4                                      1220 05646000
         CLI   ELMNTYPE(@15),80                                    1220 05647000
         BL    @RF01220                                            1220 05648000
*     ETSTTYPE=ELMNTYPE-IOPPREG;    /* CONVERT TO NON-REGRESSED VALUE*/ 05649000
         SLR   ETSTTYPE,ETSTTYPE                                   1221 05650000
         IC    ETSTTYPE,ELMNTYPE(,@15)                             1221 05651000
         SH    ETSTTYPE,@CH00469                                   1221 05652000
*   ELSE                                                           1222 05653000
*     ETSTTYPE=ELMNTYPE;            /* NO CONVERSION NECESSARY       */ 05654000
         B     @RC01220                                            1222 05655000
@RF01220 L     @15,@PC00028+4                                      1222 05656000
         SLR   ETSTTYPE,ETSTTYPE                                   1222 05657000
         IC    ETSTTYPE,ELMNTYPE(,@15)                             1222 05658000
*                                                                  1223 05659000
*   /*****************************************************************/ 05660000
*   /*                                                               */ 05661000
*   /* GO THRU ICT MOD SECTION                                       */ 05662000
*   /*                                                               */ 05663000
*   /*****************************************************************/ 05664000
*                                                                  1223 05665000
*   DO MJ=1 BY 1 WHILE ICTMEND(MJ)^=ICTENDNT/* NOT AT END            */ 05666000
*         &ELMNPTR=0;               /* NOT YET FOUND                 */ 05667000
@RC01220 LA    MJ,1                                                1223 05668000
         B     @DE01223                                            1223 05669000
@DL01223 DS    0H                                                  1224 05670000
*     IF ICTMNAME(MJ)=ELMNNAME      /* MATCHES ELEMENT NAME PASSED   */ 05671000
*       THEN                                                       1224 05672000
         LR    @15,MJ                                              1224 05673000
         MH    @15,@CH02383                                        1224 05674000
         L     @14,CCAICMOD(,CCAPTR)                               1224 05675000
         L     @07,@PC00028                                        1224 05676000
         ST    @15,@TF00001                                        1224 05677000
         ALR   @15,@14                                             1224 05678000
         AL    @15,@CF02422                                        1224 05679000
         CLC   ICTMNAME(8,@15),ELMNNAME(@07)                       1224 05680000
         BNE   @RF01224                                            1224 05681000
*       DO;                                                        1225 05682000
*         IF ETSTTYPE=IOPPMOD       /* LOOKING FOR ++MOD TYPE        */ 05683000
*             &ICTMMOD(MJ)=ON       /* ICT MOD SECT MOD ENTRY        */ 05684000
*             &ICTMASM(MJ)=OFF      /* NOT ASSEM ENTRY               */ 05685000
*           THEN                                                   1226 05686000
         CH    ETSTTYPE,@CH00065                                   1226 05687000
         BNE   @RF01226                                            1226 05688000
         LR    @15,@14                                             1226 05689000
         AL    @15,@TF00001                                        1226 05690000
         AL    @15,@CF02420                                        1226 05691000
         TM    ICTMMOD-9(@15),B'10000000'                          1226 05692000
         BNO   @RF01226                                            1226 05693000
         TM    ICTMASM-9(@15),B'01000000'                          1226 05694000
         BNZ   @RF01226                                            1226 05695000
*           ELMNPTR=ADDR(ICTMOD(MJ));/* ICT MOD ENTRY FOUND          */ 05696000
         L     @15,@PC00028+8                                      1227 05697000
         L     @01,@TF00001                                        1227 05698000
         AL    @14,@CF02422                                        1227 05699000
         LA    @14,ICTMOD(@01,@14)                                 1227 05700000
         ST    @14,ELMNPTR(,@15)                                   1227 05701000
*         IF(ETSTTYPE=IOPPMACR      /* LOOKING FOR ++MAC TYPE        */ 05702000
*             |ETSTTYPE=IOPPMACU)   /* LOOKING FOR ++MACUPD TYPE     */ 05703000
*             &ICTMMACR(MJ)=ON      /* ICT MOD SECT MAC ENTRY        */ 05704000
*           THEN                                                   1228 05705000
@RF01226 CH    ETSTTYPE,@CH00040                                   1228 05706000
         BE    @GL00078                                            1228 05707000
         CH    ETSTTYPE,@CH00103                                   1228 05708000
         BNE   @RF01228                                            1228 05709000
@GL00078 LR    @15,MJ                                              1228 05710000
         MH    @15,@CH02383                                        1228 05711000
         L     @14,CCAICMOD(,CCAPTR)                               1228 05712000
         ST    @15,@TF00001                                        1228 05713000
         ALR   @15,@14                                             1228 05714000
         AL    @15,@CF02420                                        1228 05715000
         TM    ICTMMACR-9(@15),B'00001000'                         1228 05716000
         BNO   @RF01228                                            1228 05717000
*           ELMNPTR=ADDR(ICTMOD(MJ));/* ICT MOD ENTRY FOUND          */ 05718000
         L     @15,@PC00028+8                                      1229 05719000
         L     @01,@TF00001                                        1229 05720000
         AL    @14,@CF02422                                        1229 05721000
         LA    @14,ICTMOD(@01,@14)                                 1229 05722000
         ST    @14,ELMNPTR(,@15)                                   1229 05723000
*         IF(ETSTTYPE=IOPPSRCR      /* LOOKING FOR ++SRC TYPE        */ 05724000
*             |ETSTTYPE=IOPPSRCU)   /* LOOKING FOR ++SRCUPD TYPE     */ 05725000
*             &ICTMSRCR(MJ)=ON      /* ICT MOD SECT SRC ENTRY        */ 05726000
*           THEN                                                   1230 05727000
@RF01228 CH    ETSTTYPE,@CH00289                                   1230 05728000
         BE    @GL00080                                            1230 05729000
         CH    ETSTTYPE,@CH00067                                   1230 05730000
         BNE   @RF01230                                            1230 05731000
@GL00080 LR    @15,MJ                                              1230 05732000
         MH    @15,@CH02383                                        1230 05733000
         L     @14,CCAICMOD(,CCAPTR)                               1230 05734000
         ST    @15,@TF00001                                        1230 05735000
         ALR   @15,@14                                             1230 05736000
         AL    @15,@CF02420                                        1230 05737000
         TM    ICTMSRCR-9(@15),B'00000010'                         1230 05738000
         BNO   @RF01230                                            1230 05739000
*           ELMNPTR=ADDR(ICTMOD(MJ));/* ICT MOD ENTRY FOUND          */ 05740000
         L     @15,@PC00028+8                                      1231 05741000
         L     @01,@TF00001                                        1231 05742000
         AL    @14,@CF02422                                        1231 05743000
         LA    @14,ICTMOD(@01,@14)                                 1231 05744000
         ST    @14,ELMNPTR(,@15)                                   1231 05745000
*       END;                                                       1232 05746000
@RF01230 DS    0H                                                  1233 05747000
*   END;                                                           1233 05748000
@RF01224 AL    MJ,@CF00065                                         1233 05749000
@DE01223 LR    @15,MJ                                              1233 05750000
         MH    @15,@CH02383                                        1233 05751000
         L     @01,CCAICMOD(,CCAPTR)                               1233 05752000
         AL    @01,@CF02422                                        1233 05753000
         L     @15,ICTMEND(@15,@01)                                1233 05754000
         CL    @15,ICTENDNT                                        1233 05755000
         BE    @DC01223                                            1233 05756000
         L     @15,@PC00028+8                                      1233 05757000
         ICM   @14,15,ELMNPTR(@15)                                 1233 05758000
         BZ    @DL01223                                            1233 05759000
@DC01223 DS    0H                                                  1234 05760000
*   RETURN;                                                        1234 05761000
@EL00028 DS    0H                                                  1234 05762000
@EF00028 DS    0H                                                  1234 05763000
@ER00028 LM    @14,@12,12(@13)                                     1234 05764000
         BR    @14                                                 1234 05765000
*   END RMODICT;                                                   1235 05766000
*                                                                  1236 05767000
*/********************************************************************/ 05768000
*/*                                                                  */ 05769000
*/*    ELMTYPE  - DETERMINE ELEMENT TYPE FROM ICTMFLG1               */ 05770000
*/*                                                                  */ 05771000
*/*               THE CALLER'S PARAMETER IS SET TO A PRINTABLE       */ 05772000
*/*               EBCDIC CHARACTER STRING CORRESPONDING TO THE       */ 05773000
*/*               THE ICT MOD SECTION ENTRY ELEMENT TYPE             */ 05774000
*/*                                                                  */ 05775000
*/********************************************************************/ 05776000
*                                                                  1236 05777000
*ELMTYPE:                                                          1236 05778000
*   PROC(ELMENTRY,ETEBCDIC);                                       1236 05779000
ELMTYPE  STM   @14,@12,12(@13)                                     1236 05780000
         MVC   @PC00029(8),0(@01)                                  1236 05781000
*   DCL                                                            1237 05782000
*     ELMENTRY CHAR(*);             /* ICT MOD SECTION ENTRY         */ 05783000
*   DCL                                                            1238 05784000
*     ETEBCDIC CHAR(8);             /* PRINTABLE EBCDIC ELEMENT TYPE */ 05785000
*   RESPECIFY                                                      1239 05786000
*     ICTMOD BASED(ADDR(ELMENTRY)); /* ADDRESS MOD ENTRY PASSED      */ 05787000
*   ETEBCDIC=' ';                   /* BLANK TYPE RETURNED TO CALLER */ 05788000
         L     @15,@PC00029+4                                      1240 05789000
         MVI   ETEBCDIC+1(@15),C' '                                1240 05790000
         MVC   ETEBCDIC+2(6,@15),ETEBCDIC+1(@15)                   1240 05791000
         MVI   ETEBCDIC(@15),C' '                                  1240 05792000
*   IF ICTMMOD(1)=ON                /* MOD ENTRY                     */ 05793000
*     THEN                                                         1241 05794000
         L     @14,@PC00029                                        1241 05795000
         TM    ICTMMOD(@14),B'10000000'                            1241 05796000
         BNO   @RF01241                                            1241 05797000
*     ETEBCDIC=MSGMOD;              /* ++MOD TYPE ENTRY              */ 05798000
         MVC   ETEBCDIC(8,@15),@CC02001                            1242 05799000
*   IF ICTMMACR(1)=ON               /* MACRO ENTRY                   */ 05800000
*     THEN                                                         1243 05801000
@RF01241 L     @15,@PC00029                                        1243 05802000
         TM    ICTMMACR(@15),B'00001000'                           1243 05803000
         BNO   @RF01243                                            1243 05804000
*     ETEBCDIC=MSGMAC;              /* ++MAC TYPE ENTRY              */ 05805000
         L     @15,@PC00029+4                                      1244 05806000
         MVC   ETEBCDIC(8,@15),@CC02003                            1244 05807000
*   IF ICTMMACU(1)=ON               /* MACRO UPDATE ENTRY            */ 05808000
*     THEN                                                         1245 05809000
@RF01243 L     @15,@PC00029                                        1245 05810000
         TM    ICTMMACU(@15),B'00000100'                           1245 05811000
         BNO   @RF01245                                            1245 05812000
*     ETEBCDIC=MSGMACU;             /* ++MACUPD TYPE ENTRY           */ 05813000
         L     @15,@PC00029+4                                      1246 05814000
         MVC   ETEBCDIC(8,@15),@CC02009                            1246 05815000
*   IF ICTMSRCR(1)=ON               /* SOURCE ENTRY                  */ 05816000
*     THEN                                                         1247 05817000
@RF01245 L     @15,@PC00029                                        1247 05818000
         TM    ICTMSRCR(@15),B'00000010'                           1247 05819000
         BNO   @RF01247                                            1247 05820000
*     ETEBCDIC=MSGSRC;              /* ++SRC TYPE ENTRY              */ 05821000
         L     @15,@PC00029+4                                      1248 05822000
         MVC   ETEBCDIC(8,@15),@CC02005                            1248 05823000
*   IF ICTMSRCU(1)=ON               /* SOURCE UPDATE ENTRY           */ 05824000
*     THEN                                                         1249 05825000
@RF01247 L     @15,@PC00029                                        1249 05826000
         TM    ICTMSRCU(@15),B'00000001'                           1249 05827000
         BNO   @RF01249                                            1249 05828000
*     ETEBCDIC=MSGSRCU;             /* ++SRCUPD TYPE ENTRY           */ 05829000
         L     @15,@PC00029+4                                      1250 05830000
         MVC   ETEBCDIC(8,@15),@CC02011                            1250 05831000
*   RETURN;                                                        1251 05832000
@EL00029 DS    0H                                                  1251 05833000
@EF00029 DS    0H                                                  1251 05834000
@ER00029 LM    @14,@12,12(@13)                                     1251 05835000
         BR    @14                                                 1251 05836000
*   END ELMTYPE;                                                   1252 05837000
         B     @EL00029                                            1252 05838000
*                                                                  1253 05839000
*/********************************************************************/ 05840000
*/*                                                                  */ 05841000
*/*    INITICTM - INITIALIZE ICT MOD SECTION ENTRY FROM DATA IN      */ 05842000
*/*               CDS ENTRY IOP                                      */ 05843000
*/*                                                                  */ 05844000
*/*                                                                  */ 05845000
*/*                                                                  */ 05846000
*/********************************************************************/ 05847000
*                                                                  1253 05848000
*INITICTM:                                                         1253 05849000
*   PROC(IIOPTR,IMODENT);                                          1253 05850000
INITICTM STM   @14,@12,@SA00030                                    1253 05851000
         MVC   @PC00030(8),0(@01)                                  1253 05852000
*   DCL                                                            1254 05853000
*     IIOPTR PTR(31);               /* PTR TO CDS ELEMENT ENTRY IOP  */ 05854000
*   DCL                                                            1255 05855000
*     IMODENT CHAR(*);              /* ICT MOD ENTRY TO INITIALIZE   */ 05856000
*   DCL                                                            1256 05857000
*     INI FIXED(15);                /* INDEX - IOP VARIABLE ARRAY    */ 05858000
*   DCL                                                            1257 05859000
*     INITIRC FIXED(31);            /* LOCAL RETURN CODE             */ 05860000
*   RESPECIFY                                                      1258 05861000
*     HMASMIOP BASED(IIOPTR);       /* ADDRESS IOP PASSED            */ 05862000
*   RESPECIFY                                                      1259 05863000
*     ICTMOD BASED(ADDR(IMODENT));  /* ADDRESS ICT ENTRY PASSD       */ 05864000
*   INITIRC=0;                      /* CLEAR LOCAL RETURN CODE       */ 05865000
         SLR   INITIRC,INITIRC                                     1260 05866000
*   IF IOPTYPE=IOPMOD               /* ++MOD TYPE CDS IOP            */ 05867000
*     THEN                                                         1261 05868000
         L     @02,@PC00030                                        1261 05869000
         L     @02,IIOPTR(,@02)                                    1261 05870000
         CLI   IOPTYPE(@02),5                                      1261 05871000
         BNE   @RF01261                                            1261 05872000
*     DO;                                                          1262 05873000
*                                                                  1262 05874000
*       /*************************************************************/ 05875000
*       /*                                                           */ 05876000
*       /* INITIALIZE ++MOD ICT MOD SECTION ENTRY                    */ 05877000
*       /*                                                           */ 05878000
*       /*************************************************************/ 05879000
*                                                                  1263 05880000
*       ICTMDSTL(1)=IOPDLIB;        /* DLIB                          */ 05881000
         L     @15,@PC00030+4                                      1263 05882000
         MVC   ICTMDSTL(8,@15),IOPDLIB(@02)                        1263 05883000
*       ICTMSYSL(1)='        ';     /* SYSLIB - N/A FOR MODS         */ 05884000
         MVC   ICTMSYSL(8,@15),@CC01946                            1264 05885000
*       ICTMTCHN(1)=0;              /* CLEAR PTR TO ICT ALIAS LIST   */ 05886000
*                                                                  1265 05887000
         SLR   @02,@02                                             1265 05888000
         ST    @02,ICTMTCHN(,@15)                                  1265 05889000
*       /*************************************************************/ 05890000
*       /*                                                           */ 05891000
*       /* GO THRU IOP VARIABLE ARRAY FOR ALIAS ENTRIES              */ 05892000
*       /*                                                           */ 05893000
*       /*************************************************************/ 05894000
*                                                                  1266 05895000
*       DO INI=1 BY 1 WHILE IOPMODND(INI)^=IOPEOLST/* NOT AT END     */ 05896000
*             &INITIRC=0;           /* NO ERRORS                     */ 05897000
         LA    INI,1                                               1266 05898000
         B     @DE01266                                            1266 05899000
@DL01266 DS    0H                                                  1267 05900000
*         IF IOPMDIND(INI)=IOPMDTAL /* TALIAS NAME                   */ 05901000
*             |IOPMDIND(INI)=IOPMDDAL/* DALIAS NAME                  */ 05902000
*           THEN                                                   1267 05903000
         LR    @15,INI                                             1267 05904000
         MH    @15,@CH00034                                        1267 05905000
         L     @14,@PC00030                                        1267 05906000
         L     @01,IIOPTR(,@14)                                    1267 05907000
         SLR   @14,@14                                             1267 05908000
         IC    @14,IOPMDIND-9(@15,@01)                             1267 05909000
         CH    @14,@CH00273                                        1267 05910000
         BE    @RT01267                                            1267 05911000
         CH    @14,@CH00088                                        1267 05912000
         BNE   @RF01267                                            1267 05913000
@RT01267 DS    0H                                                  1268 05914000
*           DO;                                                    1268 05915000
*                                                                  1268 05916000
*             /*******************************************************/ 05917000
*             /*                                                     */ 05918000
*             /* PUT ALIAS INTO ICT ALIAS LIST                       */ 05919000
*             /*                                                     */ 05920000
*             /*******************************************************/ 05921000
*                                                                  1269 05922000
*             CALL HMASMTAI(TBLXPARM,/* TBLX PARMS                   */ 05923000
*                 ICTMTCHN(1),      /* ALIAS LIST CHAIN ANCHOR       */ 05924000
*                 ADDR(IOPLMODS(INI)),/* ALIAS NAME                  */ 05925000
*                 LENGTH(ICTTALNM));/* LENGTH OF ICT INDEX ENTRY     */ 05926000
         L     @15,@PC00001                                        1269 05927000
         ST    @15,@AL00001                                        1269 05928000
         L     @15,@PC00030+4                                      1269 05929000
         LA    @15,ICTMTCHN(,@15)                                  1269 05930000
         ST    @15,@AL00001+4                                      1269 05931000
         LR    @15,INI                                             1269 05932000
         MH    @15,@CH00034                                        1269 05933000
         L     @14,@PC00030                                        1269 05934000
         L     @01,IIOPTR(,@14)                                    1269 05935000
         LA    @15,IOPLMODS-9(@15,@01)                             1269 05936000
         ST    @15,@TF00001                                        1269 05937000
         LA    @15,@TF00001                                        1269 05938000
         ST    @15,@AL00001+8                                      1269 05939000
         LA    @15,@CF00033                                        1269 05940000
         ST    @15,@AL00001+12                                     1269 05941000
         L     @15,@CV01892                                        1269 05942000
         LA    @01,@AL00001                                        1269 05943000
         BALR  @14,@15                                             1269 05944000
*             RESPECIFY                                            1270 05945000
*               REG15 RSTD;                                        1270 05946000
*             INITIRC=MAX(INITIRC,REG15);                          1271 05947000
         CR    INITIRC,REG15                                       1271 05948000
         BNL   *+6                                                      05949000
         LR    INITIRC,REG15                                       1271 05950000
*             RESPECIFY                                            1272 05951000
*               REG15 UNRSTD;                                      1272 05952000
*           END;                                                   1273 05953000
*       END;                                                       1274 05954000
@RF01267 AL    INI,@CF00065                                        1274 05955000
@DE01266 LR    @15,INI                                             1274 05956000
         MH    @15,@CH00034                                        1274 05957000
         L     @14,@PC00030                                        1274 05958000
         L     @01,IIOPTR(,@14)                                    1274 05959000
         SLR   @14,@14                                             1274 05960000
         IC    @14,IOPMODND-9(@15,@01)                             1274 05961000
         CH    @14,@CH00765                                        1274 05962000
         BE    @DC01266                                            1274 05963000
         LTR   INITIRC,INITIRC                                     1274 05964000
         BZ    @DL01266                                            1274 05965000
@DC01266 DS    0H                                                  1275 05966000
*       IF ICTMTCHN(1)=0            /* NO ALIASES PUT IN LIST        */ 05967000
*         THEN                                                     1275 05968000
         L     @02,@PC00030+4                                      1275 05969000
         ICM   @15,15,ICTMTCHN(@02)                                1275 05970000
         BNZ   @RF01275                                            1275 05971000
*         ICTMTCHN(1)=TBLXNULL;     /* POINT TO EMPTY LIST           */ 05972000
         L     @15,@PC00001                                        1276 05973000
         MVC   ICTMTCHN(4,@02),TBLXNULL(@15)                       1276 05974000
*     END;                                                         1277 05975000
@RF01275 DS    0H                                                  1278 05976000
*   IF IOPTYPE=IOPMAC               /* ++MAC TYPE CDS IOP            */ 05977000
*     THEN                                                         1278 05978000
@RF01261 L     @02,@PC00030                                        1278 05979000
         L     @02,IIOPTR(,@02)                                    1278 05980000
         CLI   IOPTYPE(@02),3                                      1278 05981000
         BNE   @RF01278                                            1278 05982000
*     DO;                                                          1279 05983000
*                                                                  1279 05984000
*       /*************************************************************/ 05985000
*       /*                                                           */ 05986000
*       /* INITIALIZE ++MAC ICT MOD SECTION ENTRY                    */ 05987000
*       /*                                                           */ 05988000
*       /*************************************************************/ 05989000
*                                                                  1280 05990000
*       ICTTOLIB(1)=BLANKDDN;       /* BLANK TARGET LIBRARY DDNAME   */ 05991000
         L     @15,@PC00030+4                                      1280 05992000
         MVC   ICTTOLIB(8,@15),@CC01946                            1280 05993000
*       ICTMDSTL(1)=IOPMCDLB;       /* DLIB                          */ 05994000
         MVC   ICTMDSTL(8,@15),IOPMCDLB(@02)                       1281 05995000
*       ICTMSYSL(1)=IOPMCSYS;       /* SYSLIB                        */ 05996000
         MVC   ICTMSYSL(8,@15),IOPMCSYS(@02)                       1282 05997000
*       IF CCAACCPT=ON              /* ACCEPT PROCESSING             */ 05998000
*         THEN                                                     1283 05999000
         TM    CCAACCPT(CCAPTR),B'00100000'                        1283 06000000
         BNO   @RF01283                                            1283 06001000
*         ICTTOLIB(1)=ICTMDSTL(1);  /* TARGET LIBRARY IS DLIB        */ 06002000
         MVC   ICTTOLIB(8,@15),ICTMDSTL(@15)                       1284 06003000
*       ELSE                                                       1285 06004000
*         IF ICTMSYSL(1)=BLANKDDN   /* NO APPLY TARGET LIBRARY       */ 06005000
*           THEN                                                   1285 06006000
         B     @RC01283                                            1285 06007000
@RF01283 L     @02,@PC00030+4                                      1285 06008000
         CLC   ICTMSYSL(8,@02),@CC01946                            1285 06009000
         BNE   @RF01285                                            1285 06010000
*           ICTTOLIB(1)=SMPMTS;     /* TARGET LIBRARY IS "SMPMTS"    */ 06011000
         MVC   ICTTOLIB(8,@02),@CC01969                            1286 06012000
*         ELSE                                                     1287 06013000
*           ICTTOLIB(1)=ICTMSYSL(1);/* TARGET LIBRARY IS SYSLIB      */ 06014000
         B     @RC01285                                            1287 06015000
@RF01285 L     @02,@PC00030+4                                      1287 06016000
         MVC   ICTTOLIB(8,@02),ICTMSYSL(@02)                       1287 06017000
*       ICTMTCHN(1)=0;              /* CLEAR PTR TO ICT ALIAS LIST   */ 06018000
*                                                                  1288 06019000
@RC01285 DS    0H                                                  1288 06020000
@RC01283 L     @02,@PC00030+4                                      1288 06021000
         SLR   @15,@15                                             1288 06022000
         ST    @15,ICTMTCHN(,@02)                                  1288 06023000
*       /*************************************************************/ 06024000
*       /*                                                           */ 06025000
*       /* GO THRU IOP VARIABLE ARRAY FOR ALIAS ENTRIES              */ 06026000
*       /*                                                           */ 06027000
*       /*************************************************************/ 06028000
*                                                                  1289 06029000
*       DO INI=1 BY 1 WHILE IOPMACND(INI)^=IOPEOLST/* NOT AT END     */ 06030000
*             &INITIRC=0;           /* NO ERRORS                     */ 06031000
         LA    INI,1                                               1289 06032000
         B     @DE01289                                            1289 06033000
@DL01289 DS    0H                                                  1290 06034000
*         IF IOPMCIND(INI)=IOPMCMAL /* MALIAS NAME                   */ 06035000
*           THEN                                                   1290 06036000
         LR    @15,INI                                             1290 06037000
         MH    @15,@CH00034                                        1290 06038000
         L     @14,@PC00030                                        1290 06039000
         L     @14,IIOPTR(,@14)                                    1290 06040000
         SLR   @07,@07                                             1290 06041000
         IC    @07,IOPMCIND-9(@15,@14)                             1290 06042000
         CH    @07,@CH00273                                        1290 06043000
         BNE   @RF01290                                            1290 06044000
*           DO;                                                    1291 06045000
*                                                                  1291 06046000
*             /*******************************************************/ 06047000
*             /*                                                     */ 06048000
*             /* PUT ALIAS INTO ICT ALIAS LIST                       */ 06049000
*             /*                                                     */ 06050000
*             /*******************************************************/ 06051000
*                                                                  1292 06052000
*             CALL HMASMTAI(TBLXPARM,/* TBLX PARMS                   */ 06053000
*                 ICTMTCHN(1),      /* ALIAS LIST CHAIN ANCHOR       */ 06054000
*                 ADDR(IOPMCASM(INI)),/* ALIAS NAME                  */ 06055000
*                 LENGTH(ICTTALNM));/* LENGTH OF ICT INDEX ENTRY     */ 06056000
         L     @07,@PC00001                                        1292 06057000
         ST    @07,@AL00001                                        1292 06058000
         L     @07,@PC00030+4                                      1292 06059000
         LA    @07,ICTMTCHN(,@07)                                  1292 06060000
         ST    @07,@AL00001+4                                      1292 06061000
         LA    @15,IOPMCASM-9(@15,@14)                             1292 06062000
         ST    @15,@TF00001                                        1292 06063000
         LA    @15,@TF00001                                        1292 06064000
         ST    @15,@AL00001+8                                      1292 06065000
         LA    @15,@CF00033                                        1292 06066000
         ST    @15,@AL00001+12                                     1292 06067000
         L     @15,@CV01892                                        1292 06068000
         LA    @01,@AL00001                                        1292 06069000
         BALR  @14,@15                                             1292 06070000
*             RESPECIFY                                            1293 06071000
*               REG15 RSTD;                                        1293 06072000
*             INITIRC=MAX(INITIRC,REG15);                          1294 06073000
         CR    INITIRC,REG15                                       1294 06074000
         BNL   *+6                                                      06075000
         LR    INITIRC,REG15                                       1294 06076000
*             RESPECIFY                                            1295 06077000
*               REG15 UNRSTD;                                      1295 06078000
*           END;                                                   1296 06079000
*       END;                                                       1297 06080000
@RF01290 AL    INI,@CF00065                                        1297 06081000
@DE01289 LR    @15,INI                                             1297 06082000
         MH    @15,@CH00034                                        1297 06083000
         L     @14,@PC00030                                        1297 06084000
         L     @01,IIOPTR(,@14)                                    1297 06085000
         SLR   @14,@14                                             1297 06086000
         IC    @14,IOPMACND-9(@15,@01)                             1297 06087000
         CH    @14,@CH00765                                        1297 06088000
         BE    @DC01289                                            1297 06089000
         LTR   INITIRC,INITIRC                                     1297 06090000
         BZ    @DL01289                                            1297 06091000
@DC01289 DS    0H                                                  1298 06092000
*       IF ICTMTCHN(1)=0            /* NO ALIASES PUT IN LIST        */ 06093000
*         THEN                                                     1298 06094000
         L     @15,@PC00030+4                                      1298 06095000
         ICM   @14,15,ICTMTCHN(@15)                                1298 06096000
         BNZ   @RF01298                                            1298 06097000
*         ICTMTCHN(1)=TBLXNULL;     /* POINT TO EMPTY LIST           */ 06098000
         L     @14,@PC00001                                        1299 06099000
         MVC   ICTMTCHN(4,@15),TBLXNULL(@14)                       1299 06100000
*     END;                                                         1300 06101000
@RF01298 DS    0H                                                  1301 06102000
*   IF IOPTYPE=IOPSRC               /* ++SRC TYPE CDS IOP            */ 06103000
*     THEN                                                         1301 06104000
@RF01278 L     @15,@PC00030                                        1301 06105000
         L     @15,IIOPTR(,@15)                                    1301 06106000
         CLI   IOPTYPE(@15),8                                      1301 06107000
         BNE   @RF01301                                            1301 06108000
*     DO;                                                          1302 06109000
*                                                                  1302 06110000
*       /*************************************************************/ 06111000
*       /*                                                           */ 06112000
*       /* INITIALIZE ++SRC ICT MOD SECTION ENTRY                    */ 06113000
*       /*                                                           */ 06114000
*       /*************************************************************/ 06115000
*                                                                  1303 06116000
*       ICTTOLIB(1)=BLANKDDN;       /* BLANK TARGET SYSTEM DDNAME    */ 06117000
         L     @14,@PC00030+4                                      1303 06118000
         MVC   ICTTOLIB(8,@14),@CC01946                            1303 06119000
*       ICTMDSTL(1)=IOPSRDLB;       /* DLIB                          */ 06120000
         MVC   ICTMDSTL(8,@14),IOPSRDLB(@15)                       1304 06121000
*       ICTMSYSL(1)=IOPSRSYS;       /* SYSLIB                        */ 06122000
         MVC   ICTMSYSL(8,@14),IOPSRSYS(@15)                       1305 06123000
*       ICTMTCHN(1)=TBLXNULL;       /* POINT TO EMPTY LIST FOR ALIAS */ 06124000
         L     @15,@PC00001                                        1306 06125000
         MVC   ICTMTCHN(4,@14),TBLXNULL(@15)                       1306 06126000
*       IF CCAACCPT=ON              /* ACCEPT PROCESSING             */ 06127000
*         THEN                                                     1307 06128000
         TM    CCAACCPT(CCAPTR),B'00100000'                        1307 06129000
         BNO   @RF01307                                            1307 06130000
*         ICTTOLIB(1)=ICTMDSTL(1);  /* TARGET LIBRARY IS DLIB        */ 06131000
         MVC   ICTTOLIB(8,@14),ICTMDSTL(@14)                       1308 06132000
*       ELSE                                                       1309 06133000
*         IF ICTMSYSL(1)=BLANKDDN   /* NO APPLY TARGET LIBRARY       */ 06134000
*           THEN                                                   1309 06135000
         B     @RC01307                                            1309 06136000
@RF01307 L     @15,@PC00030+4                                      1309 06137000
         CLC   ICTMSYSL(8,@15),@CC01946                            1309 06138000
         BNE   @RF01309                                            1309 06139000
*           ICTTOLIB(1)=SMPSTS;     /* TARGET LIBRARY IS "SMPSTS"    */ 06140000
         MVC   ICTTOLIB(8,@15),@CC01971                            1310 06141000
*         ELSE                                                     1311 06142000
*           ICTTOLIB(1)=ICTMSYSL(1);/* TARGET LIBRARY IS SYSLIB      */ 06143000
         B     @RC01309                                            1311 06144000
@RF01309 L     @15,@PC00030+4                                      1311 06145000
         MVC   ICTTOLIB(8,@15),ICTMSYSL(@15)                       1311 06146000
*     END;                                                         1312 06147000
*   RETURN;                                                        1313 06148000
@EL00030 DS    0H                                                  1313 06149000
@EF00030 DS    0H                                                  1313 06150000
@ER00030 LM    @14,@12,@SA00030                                    1313 06151000
         BR    @14                                                 1313 06152000
*   END INITICTM;                                                  1314 06153000
         B     @EL00030                                            1314 06154000
*                                                                  1315 06155000
*/********************************************************************/ 06156000
*/*                                                                  */ 06157000
*/*    SKIP     - PUT BLANK LINES TO SMPOUT                          */ 06158000
*/*                                                                  */ 06159000
*/*                                                                  */ 06160000
*/********************************************************************/ 06161000
*                                                                  1315 06162000
*SKIP:                                                             1315 06163000
*   PROC(SKPN);                                                    1315 06164000
SKIP     STM   @14,@12,@SA00031                                    1315 06165000
         MVC   @PC00031(4),0(@01)                                  1315 06166000
*   DCL                                                            1316 06167000
*     SKPN FIXED(31);               /* NUMBER OF LINES TO SKIP       */ 06168000
*   DCL                                                            1317 06169000
*     ISK FIXED(31);                /* LOCAL COUNTER                 */ 06170000
*   DCL                                                            1318 06171000
*     XIOP CHAR(LENGTH(HMASMIOP));  /* LOCAL IOP                     */ 06172000
*   DCL                                                            1319 06173000
*     XPRL CHAR(LENGTH(HMASMPRL));  /* LOCAL PRL (HMASMPRL)          */ 06174000
*   RESPECIFY                                                      1320 06175000
*     HMASMIOP BASED(ADDR(XIOP));   /* ADDRESS LOCAL IOP             */ 06176000
*   IOPRETRN=0;                     /*                               */ 06177000
         LA    @15,XIOP                                            1321 06178000
         MVI   IOPRETRN(@15),X'00'                                 1321 06179000
*   IOPFUNCT=IOPWRITE;              /*                               */ 06180000
         MVI   IOPFUNCT(@15),X'51'                                 1322 06181000
*   IOPDSID=IOPPRINT;               /*                               */ 06182000
         MVI   IOPDSID(@15),X'0B'                                  1323 06183000
*   IOPBUFAD=ADDR(XPRL);            /* POINT TO PRL                  */ 06184000
         LA    @14,XPRL                                            1324 06185000
         ST    @14,IOPBUFAD(,@15)                                  1324 06186000
*   PRLFLGS=''B;                    /* CLEAR PRL FLAGS               */ 06187000
         MVI   PRLFLGS(@14),X'00'                                  1325 06188000
*   PRLBLANK=ON;                    /* BLANK-LINE PRINT              */ 06189000
         OI    PRLBLANK(@14),B'00100000'                           1326 06190000
*   DO ISK=1 TO SKPN WHILE IOPRETRN=IOPGOOD;                       1327 06191000
         LA    ISK,1                                               1327 06192000
         B     @DE01327                                            1327 06193000
@DL01327 LA    @03,XIOP                                            1327 06194000
         CLI   IOPRETRN(@03),0                                     1327 06195000
         BNE   @DC01327                                            1327 06196000
*     CALL HMASMIO(HMASMIOP);                                      1328 06197000
         ST    @03,@AL00001                                        1328 06198000
         L     @15,@CV01886                                        1328 06199000
         LA    @01,@AL00001                                        1328 06200000
         BALR  @14,@15                                             1328 06201000
*   END;                                                           1329 06202000
         AL    ISK,@CF00065                                        1329 06203000
@DE01327 L     @03,@PC00031                                        1329 06204000
         C     ISK,SKPN(,@03)                                      1329 06205000
         BNH   @DL01327                                            1329 06206000
@DC01327 DS    0H                                                  1330 06207000
*   RETURN;                                                        1330 06208000
@EL00031 DS    0H                                                  1330 06209000
@EF00031 DS    0H                                                  1330 06210000
@ER00031 LM    @14,@12,@SA00031                                    1330 06211000
         BR    @14                                                 1330 06212000
*   END SKIP;                                                      1331 06213000
*   END HMASMTMD                                                   1332 06214000
*                                                                  1332 06215000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06216000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 06217000
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */ 06218000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 06219000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 06220000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 06221000
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */ 06222000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 06223000
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */ 06224000
*                                                                  1332 06225000
*       ;                                                          1332 06226000
@DATA    DS    0H                                                       06227000
@CH00083 DC    H'0'                                                     06228000
@CH00273 DC    H'2'                                                     06229000
@CH00088 DC    H'3'                                                     06230000
@CH00103 DC    H'5'                                                     06231000
@CH00289 DC    H'6'                                                     06232000
@CH00067 DC    H'7'                                                     06233000
@CH00034 DC    H'9'                                                     06234000
@CH00580 DC    H'11'                                                    06235000
@CH00036 DC    H'12'                                                    06236000
@CH00609 DC    H'27'                                                    06237000
@CH01977 DC    H'47'                                                    06238000
@CH00469 DC    H'80'                                                    06239000
@CH02382 DC    H'116'                                                   06240000
@CH02383 DC    H'144'                                                   06241000
@CH01979 DC    H'156'                                                   06242000
@CH01981 DC    H'171'                                                   06243000
@CH01983 DC    H'175'                                                   06244000
@CH01987 DC    H'206'                                                   06245000
@CH00765 DC    H'255'                                                   06246000
         DS    0F                                                       06247000
@AL00254 EQU   *                       LIST WITH   1 ARGUMENT(S)        06248000
@AL00492 DC    A(@CF00065)             LIST WITH   1 ARGUMENT(S)        06249000
@AL00317 DC    A(@CH01987+1)           LIST WITH   2 ARGUMENT(S)        06250000
         DC    A(@CH00083+1)                                            06251000
@AL00326 EQU   *                       LIST WITH   2 ARGUMENT(S)        06252000
@AL00477 EQU   *                       LIST WITH   2 ARGUMENT(S)        06253000
@AL01111 DC    A(@CH00609+1)           LIST WITH   2 ARGUMENT(S)        06254000
         DC    A(@CH00580+1)                                            06255000
@AL00329 EQU   *                       LIST WITH   2 ARGUMENT(S)        06256000
@AL01117 EQU   *                       LIST WITH   2 ARGUMENT(S)        06257000
@AL00479 DC    A(@CH01981+1)           LIST WITH   1 ARGUMENT(S)        06258000
         DC    A(@CH00083+1)                                            06259000
@AL00452 DC    A(SI)                   LIST WITH   1 ARGUMENT(S)        06260000
@AL00521 EQU   *                       LIST WITH   1 ARGUMENT(S)        06261000
@AL00572 DC    A(MPPPARM)              LIST WITH   1 ARGUMENT(S)        06262000
@AL00528 DC    A(@CH01979+1)           LIST WITH   2 ARGUMENT(S)        06263000
         DC    A(@CH00083+1)                                            06264000
@AL00534 DC    A(BLDMODPC)             LIST WITH   1 ARGUMENT(S)        06265000
@AL00588 DC    A(TMWOPT)               LIST WITH   4 ARGUMENT(S)        06266000
         DC    A(MODSCPTR)                                              06267000
         DC    A(HMASMCRP)                                              06268000
         DC    A(TMWMODE)                                               06269000
@AL00597 DC    A(MODSCPTR)             LIST WITH   3 ARGUMENT(S)        06270000
         DC    A(@AFTEMPS)                                              06271000
@AL00599 EQU   *                       LIST WITH   1 ARGUMENT(S)        06272000
@AL00601 DC    A(BLDMD2PC)             LIST WITH   1 ARGUMENT(S)        06273000
@AL00657 EQU   *                       LIST WITH   3 ARGUMENT(S)        06274000
@AL00664 EQU   *                       LIST WITH   3 ARGUMENT(S)        06275000
@AL00670 EQU   *                       LIST WITH   3 ARGUMENT(S)        06276000
@AL00676 EQU   *                       LIST WITH   3 ARGUMENT(S)        06277000
@AL00683 EQU   *                       LIST WITH   3 ARGUMENT(S)        06278000
@AL00690 DC    A(BLDENT@)              LIST WITH   3 ARGUMENT(S)        06279000
         DC    A(@TF00001)                                              06280000
         DC    A(MCBPTR)                                                06281000
@AL00715 DC    A(TMWOPT)               LIST WITH   4 ARGUMENT(S)        06282000
         DC    A(BLDENT@)                                               06283000
@AL00513 EQU   *                       LIST WITH   1 ARGUMENT(S)        06284000
@AL00565 EQU   *                       LIST WITH   1 ARGUMENT(S)        06285000
@AL00802 DC    A(HMASMCRP)             LIST WITH   1 ARGUMENT(S)        06286000
         DC    A(TMWMODE)                                               06287000
@AL00722 DC    A(BLDENT@)              LIST WITH   2 ARGUMENT(S)        06288000
         DC    A(@AFTEMPS+4)                                            06289000
@AL00896 EQU   *                       LIST WITH   2 ARGUMENT(S)        06290000
@AL00903 DC    A(@CH01977+1)           LIST WITH   2 ARGUMENT(S)        06291000
         DC    A(@CH00580+1)                                            06292000
@AL01092 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        06293000
@AL01137 EQU   *                       LIST WITH   2 ARGUMENT(S)        06294000
@AL01145 DC    A(@CH01983+1)           LIST WITH   2 ARGUMENT(S)        06295000
         DC    A(@CH00083+1)                                            06296000
         DS    0F                                                       06297000
@SA00001 DS    18F                                                      06298000
@PC00001 DS    1F                                                       06299000
@SA00002 DS    15F                                                      06300000
@PC00002 DS    1F                                                       06301000
@SA00004 DS    15F                                                      06302000
@PC00025 DS    2F                                                       06303000
@PC00026 DS    2F                                                       06304000
@PC00027 DS    1F                                                       06305000
@PC00029 DS    2F                                                       06306000
@SA00010 DS    15F                                                      06307000
@PC00010 DS    2F                                                       06308000
@SA00022 DS    15F                                                      06309000
@SA00003 DS    15F                                                      06310000
@PC00003 DS    4F                                                       06311000
@PC00028 DS    3F                                                       06312000
@PC00020 DS    1F                                                       06313000
@SA00005 DS    15F                                                      06314000
@PC00005 DS    2F                                                       06315000
@PC00011 DS    1F                                                       06316000
@SA00006 DS    15F                                                      06317000
@PC00006 DS    2F                                                       06318000
@PC00007 DS    2F                                                       06319000
@SA00015 DS    15F                                                      06320000
@PC00015 DS    2F                                                       06321000
@SA00008 DS    15F                                                      06322000
@PC00008 DS    2F                                                       06323000
@PC00016 DS    4F                                                       06324000
@PC00019 DS    1F                                                       06325000
@PC00018 DS    1F                                                       06326000
@PC00013 DS    3F                                                       06327000
@SA00023 DS    15F                                                      06328000
@PC00023 DS    1F                                                       06329000
@PC00024 DS    2F                                                       06330000
@SA00017 DS    0F                                                       06331000
@PC00017 EQU   @SA00017+60                                              06332000
@SA00014 DS    0F                                                       06333000
@PC00014 EQU   @SA00014+60                                              06334000
@SA00012 DS    0F                                                       06335000
@PC00012 EQU   @SA00012+60                                              06336000
@SA00030 DS    0F                                                       06337000
@PC00030 EQU   @SA00030+60                                              06338000
@SA00009 DS    0F                                                       06339000
@PC00009 EQU   @SA00009+60                                              06340000
@SA00021 DS    0F                                                       06341000
@PC00021 EQU   @SA00021+60                                              06342000
@SA00031 DS    0F                                                       06343000
@PC00031 EQU   @SA00031+60                                              06344000
         DS    18F                                                      06345000
@AL00001 DS    4A                                                       06346000
@TF00001 DS    F                                                        06347000
@AFTEMPS DS    2F                                                       06348000
         DS    0F                                                       06349000
@CF00065 DC    F'1'                                                     06350000
@CH00065 EQU   @CF00065+2                                               06351000
@CF00040 DC    F'4'                                                     06352000
@CH00040 EQU   @CF00040+2                                               06353000
@CF00033 DC    F'8'                                                     06354000
@CH00033 EQU   @CF00033+2                                               06355000
@CF02422 DC    F'-144'                                                  06356000
@CF02438 DC    F'-136'                                                  06357000
@CF02420 DC    F'-135'                                                  06358000
@CF02439 DC    F'-134'                                                  06359000
@CF02421 DC    F'-133'                                                  06360000
@CF02427 DC    F'-132'                                                  06361000
@CF02417 DC    F'-116'                                                  06362000
@CF02416 DC    F'-108'                                                  06363000
@CF02415 DC    F'-103'                                                  06364000
@CF02418 DC    F'-101'                                                  06365000
@CF02426 DC    F'-99'                                                   06366000
@CF02444 DC    F'-98'                                                   06367000
@CF02443 DC    F'-96'                                                   06368000
@CF02423 DC    F'-52'                                                   06369000
@CF02433 DC    F'-48'                                                   06370000
@CF02445 DC    F'-32'                                                   06371000
@CF02434 DC    F'-8'                                                    06372000
@CF02424 DC    F'-4'                                                    06373000
@CV01885 DC    V(HMASMCRD)                                              06374000
@CV01886 DC    V(HMASMIO)                                               06375000
@CV01887 DC    V(HMASMMPD)                                              06376000
@CV01888 DC    V(HMASMMSG)                                              06377000
@CV01891 DC    V(HMASMTAD)                                              06378000
@CV01892 DC    V(HMASMTAI)                                              06379000
@CV01893 DC    V(HMASMTCR)                                              06380000
@CV01894 DC    V(HMASMTMS)                                              06381000
@CV01895 DC    V(HMASMTMW)                                              06382000
@CV01896 DC    V(HMASMTM1)                                              06383000
@CV01897 DC    V(HMASMTM2)                                              06384000
@CV01898 DC    V(HMASMTM3)                                              06385000
@CV01889 DC    V(HMASMSCN)                                              06386000
@CV01890 DC    V(HMASMSUB)                                              06387000
@CV01899 DC    V(HMASMTM4)                                              06388000
         DS    0D                                                       06389000
IOPPTR   DS    A                                                        06390000
HIGHTMD  DS    F                                                        06391000
PTRIOP2  DS    A                                                        06392000
MCBPTR   DS    A                                                        06393000
SRCMP1   DS    A                                                        06394000
SRCMP2   DS    A                                                        06395000
SAVIOPB3 DS    A                                                        06396000
PTR0     DS    A                                                        06397000
BLDICTRC DS    F                                                        06398000
SI       DS    F                                                        06399000
BLDMODPC DS    F                                                        06400000
MODADDR  DS    A                                                        06401000
BLDMD2PC DS    F                                                        06402000
MODSCPTR DS    A                                                        06403000
TMXRETRN DS    F                                                        06404000
BLDENT@  DS    A                                                        06405000
XPNDPTR  DS    A                                                        06406000
TESTIND  DS    FL1                                                      06407000
@CC01946 DC    C'        '                                              06408000
@CC01969 DC    C'SMPMTS  '                                              06409000
@CC01971 DC    C'SMPSTS  '                                              06410000
@CC01991 DC    C'MCS     '                                              06411000
@CC01993 DC    C'SMPPTS  '                                              06412000
@CC01995 DC    C'ENTRY   '                                              06413000
@CC01997 DC    C'PREREQ  '                                              06414000
@CC01999 DC    C'FMID    '                                              06415000
@CC02001 DC    C'MOD     '                                              06416000
@CC02003 DC    C'MAC     '                                              06417000
@CC02005 DC    C'SRC     '                                              06418000
@CC02009 DC    C'MACUPD  '                                              06419000
@CC02011 DC    C'SRCUPD  '                                              06420000
@CC02209 DC    C'SMPWRK4 '                                              06421000
@CC01944 EQU   @CC01946                                                 06422000
@CC02184 DC    C'++'                                                    06423000
@CC00717 EQU   @CC01991                                                 06424000
         DS    CL1                                                      06425000
HMASMCRP DS    CL106                                                    06426000
         ORG   HMASMCRP                                                 06427000
CRPUXNUM DS    FL1                                                      06428000
@NM00057 DS    CL3                                                      06429000
CRPSCPAD DS    AL4                                                      06430000
CRPINDS  DS    FL1                                                      06431000
CRPOUTDS DS    FL1                                                      06432000
CRPRETRN DS    FL1                                                      06433000
@NM00058 DS    CL3                                                      06434000
CRPFLG1  DS    BL2                                                      06435000
         ORG   CRPFLG1                                                  06436000
CRPBFPRM DS    BL1                                                      06437000
CRPLOGCK EQU   CRPFLG1+0                                                06438000
CRPPTS   EQU   CRPFLG1+0                                                06439000
CRPLOG   EQU   CRPFLG1+0                                                06440000
CRPPRINT EQU   CRPFLG1+0                                                06441000
CRPOTHER EQU   CRPFLG1+0                                                06442000
CRPOFFST EQU   CRPFLG1+0                                                06443000
CRPSCNCL EQU   CRPFLG1+0                                                06444000
CRPEOFEN DS    BL1                                                      06445000
CRPTRMEX EQU   CRPFLG1+1                                                06446000
CRPNOWPP EQU   CRPFLG1+1                                                06447000
CRPLIST  EQU   CRPFLG1+1                                                06448000
CRPRPT   EQU   CRPFLG1+1                                                06449000
@NM00059 EQU   CRPFLG1+1                                                06450000
         ORG   HMASMCRP+16                                              06451000
CRPFLG2  DS    BL2                                                      06452000
         ORG   CRPFLG2                                                  06453000
CRPINSW0 DS    BL1                                                      06454000
         ORG   CRPINSW0                                                 06455000
CRPEOFSW DS    BL1                                                      06456000
         ORG   CRPFLG2+0                                                06457000
CRPINSW1 EQU   CRPFLG2+0                                                06458000
         ORG   CRPINSW1                                                 06459000
CRPEXADD EQU   CRPINSW1+0                                               06460000
         ORG   CRPFLG2+0                                                06461000
CRPINSW2 EQU   CRPFLG2+0                                                06462000
         ORG   CRPINSW2                                                 06463000
CRPWRTLG EQU   CRPINSW2+0                                               06464000
         ORG   CRPFLG2+0                                                06465000
CRPINSW3 EQU   CRPFLG2+0                                                06466000
         ORG   CRPINSW3                                                 06467000
CRPEOF1  EQU   CRPINSW3+0                                               06468000
         ORG   CRPFLG2+0                                                06469000
CRPINSW4 EQU   CRPFLG2+0                                                06470000
CRPINSW5 EQU   CRPFLG2+0                                                06471000
CRPINSW6 EQU   CRPFLG2+0                                                06472000
CRPINSW7 EQU   CRPFLG2+0                                                06473000
         DS    CL1                                                      06474000
CRPINSW8 DS    BL1                                                      06475000
CRPINSW9 EQU   CRPFLG2+1                                                06476000
CRPINSWA EQU   CRPFLG2+1                                                06477000
CRPINSWB EQU   CRPFLG2+1                                                06478000
CRPINSWC EQU   CRPFLG2+1                                                06479000
CRPINSWD EQU   CRPFLG2+1                                                06480000
CRPINSWE EQU   CRPFLG2+1                                                06481000
CRPINSWF EQU   CRPFLG2+1                                                06482000
         ORG   HMASMCRP+18                                              06483000
CRPBUFFR DS    CL80                                                     06484000
         ORG   CRPBUFFR                                                 06485000
CRPBFCTL DS    CL72                                                     06486000
         ORG   CRPBFCTL                                                 06487000
CRPBFDTA DS    CL71                                                     06488000
CRPBFCNT DS    CL1                                                      06489000
         ORG   CRPBUFFR+72                                              06490000
CRPBFSEQ DS    CL8                                                      06491000
         ORG   HMASMCRP+98                                              06492000
CRPDDNAM DS    CL8                                                      06493000
         ORG   HMASMCRP+106                                             06494000
         DS    CL2                                                      06495000
ICTENDCH DC    X'FFFFFFFF'                                              06496000
HMASMMGP DS    CL28                                                     06497000
         ORG   HMASMMGP                                                 06498000
MGPFIXED DS    CL12                                                     06499000
         ORG   MGPFIXED                                                 06500000
MGPCLEAR DS    CL6                                                      06501000
         ORG   MGPCLEAR                                                 06502000
MGPMGNO1 DS    FL2                                                      06503000
MGPMGNO2 DS    FL2                                                      06504000
MGPMGNO3 DS    FL2                                                      06505000
         ORG   MGPFIXED+6                                               06506000
MGPFLAGS DS    BL2                                                      06507000
         ORG   MGPFLAGS                                                 06508000
MGPPRINT DS    BL1                                                      06509000
MGPLIST  EQU   MGPFLAGS+0                                               06510000
MGPRPT   EQU   MGPFLAGS+0                                               06511000
MGPHLDS  EQU   MGPFLAGS+0                                               06512000
MGPWTOR  EQU   MGPFLAGS+0                                               06513000
MGPWTO   EQU   MGPFLAGS+0                                               06514000
MGPWTP   EQU   MGPFLAGS+0                                               06515000
@NM00255 EQU   MGPFLAGS+0                                               06516000
         ORG   MGPFIXED+8                                               06517000
MGPTYPE  DS    FL1                                                      06518000
@NM00256 DS    CL3                                                      06519000
         ORG   HMASMMGP+12                                              06520000
MGPVAR   DS    CL16                                                     06521000
         ORG   MGPVAR                                                   06522000
MGPVARPT DS    4A                                                       06523000
         ORG   HMASMMGP+28                                              06524000
MPPPARM  DS    CL23                                                     06525000
         ORG   MPPPARM                                                  06526000
MPPIOPAD DS    AL4                                                      06527000
MPPMCBAD DS    AL4                                                      06528000
MPPCRDAD DS    AL4                                                      06529000
MPPCRDPM DS    AL4                                                      06530000
MPPSMDNM DS    CL7                                                      06531000
         ORG   MPPPARM+23                                               06532000
         DS    CL1                                                      06533000
HMASMSPL DS    CL5                                                      06534000
         ORG   HMASMSPL                                                 06535000
SPLPMAD  DS    AL4                                                      06536000
SPLFUNCT DS    FL1                                                      06537000
         ORG   HMASMSPL+5                                               06538000
TMDFLGS  DS    BL1                                                      06539000
         ORG   TMDFLGS                                                  06540000
LOOP     DS    BL1                                                      06541000
BUILD    EQU   TMDFLGS+0                                                06542000
BLDM2WRK EQU   TMDFLGS+0                                                06543000
MCSEOF   EQU   TMDFLGS+0                                                06544000
@NM00257 EQU   TMDFLGS+0                                                06545000
         ORG   TMDFLGS+1                                                06546000
TMWMODE  DS    CL1                                                      06547000
TMWOPT   DS    CL1                                                      06548000
MSGSMDN8 DS    CL8                                                      06549000
         ORG   MSGSMDN8                                                 06550000
MSGSMDNM DS    CL7                                                      06551000
@NM00258 DS    CL1                                                      06552000
         ORG   MSGSMDN8+8                                               06553000
VPARTS   DS    CL24                                                     06554000
         ORG   VPARTS                                                   06555000
VPART#1  DS    CL8                                                      06556000
VPART#2  DS    CL8                                                      06557000
VPART#3  DS    CL8                                                      06558000
         ORG   VPARTS+24                                                06559000
PATCHTMD DS    CL80                                                     06560000
         ORG   PATCHTMD                                                 06561000
@NM00259 DC    80X'FF'                                                  06562000
         ORG   PATCHTMD+80                                              06563000
DELFCTN  DS    CL7                                                      06564000
WCHKANS  DS    CL1                                                      06565000
ENTERMID DS    CL7                                                      06566000
SKIPLOOP DS    CL1                                                      06567000
SRCNAME  DS    CL8                                                      06568000
MODNAME  DS    CL8                                                      06569000
INVMSL   DS    CL1                                                      06570000
ELIMASMN DS    CL8                                                      06571000
XIOP     DS    CL68                                                     06572000
XPRL     DS    CL10                                                     06573000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06574000
@01      EQU   01                                                       06575000
@02      EQU   02                                                       06576000
@03      EQU   03                                                       06577000
@04      EQU   04                                                       06578000
@05      EQU   05                                                       06579000
@06      EQU   06                                                       06580000
@07      EQU   07                                                       06581000
@08      EQU   08                                                       06582000
@09      EQU   09                                                       06583000
@10      EQU   10                                                       06584000
@11      EQU   11                                                       06585000
@12      EQU   12                                                       06586000
@13      EQU   13                                                       06587000
@14      EQU   14                                                       06588000
@15      EQU   15                                                       06589000
ISK      EQU   @02                                                      06590000
INITIRC  EQU   @03                                                      06591000
INI      EQU   @02                                                      06592000
ETSTTYPE EQU   @03                                                      06593000
MJ       EQU   @02                                                      06594000
IN6      EQU   @02                                                      06595000
IN5      EQU   @02                                                      06596000
IN4      EQU   @03                                                      06597000
IN3      EQU   @02                                                      06598000
LL       EQU   @02                                                      06599000
INV      EQU   @02                                                      06600000
IN       EQU   @02                                                      06601000
MINORD#  EQU   @03                                                      06602000
PI       EQU   @02                                                      06603000
MODSPTR  EQU   @03                                                      06604000
MODMPTR  EQU   @05                                                      06605000
MODSMD@  EQU   @04                                                      06606000
TT       EQU   @02                                                      06607000
SRCMPTR  EQU   @03                                                      06608000
SRCSPTR  EQU   @05                                                      06609000
SRCSMD@  EQU   @04                                                      06610000
UU       EQU   @02                                                      06611000
SSMDPTR  EQU   @03                                                      06612000
QQ       EQU   @02                                                      06613000
NN       EQU   @02                                                      06614000
SS       EQU   @02                                                      06615000
RR       EQU   @04                                                      06616000
PTRICTP  EQU   @03                                                      06617000
MM       EQU   @02                                                      06618000
LTSTTYPE EQU   @02                                                      06619000
ENTTYPE  EQU   @02                                                      06620000
IM       EQU   @03                                                      06621000
IX       EQU   @02                                                      06622000
JM       EQU   @02                                                      06623000
J        EQU   @03                                                      06624000
SAVIOPB2 EQU   @06                                                      06625000
SAVIOPB1 EQU   @05                                                      06626000
IP       EQU   @04                                                      06627000
I        EQU   @03                                                      06628000
PTRIOP1  EQU   @02                                                      06629000
CCAPTR   EQU   @11                                                      06630000
REG15    EQU   @15                                                      06631000
REG1     EQU   @01                                                      06632000
REG14    EQU   @14                                                      06633000
RTNCODE  EQU   @15                                                      06634000
RTNREG   EQU   @14                                                      06635000
TBLXOPTS EQU   0                                                        06636000
TBLFLAGS EQU   TBLXOPTS+8                                               06637000
TBLFLG1  EQU   TBLFLAGS                                                 06638000
TBLCHECK EQU   TBLFLG1                                                  06639000
TBLFLG2  EQU   TBLFLAGS+2                                               06640000
TBLFLG3  EQU   TBLFLAGS+3                                               06641000
TBLFLG4  EQU   TBLFLAGS+5                                               06642000
TBLFLG5  EQU   TBLFLAGS+7                                               06643000
HMASMCCA EQU   0                                                        06644000
CCAFBUFR EQU   HMASMCCA+4                                               06645000
CCADSAD  EQU   CCAFBUFR+124                                             06646000
CCATPAD  EQU   CCAFBUFR+128                                             06647000
CCAFLAG7 EQU   CCAFBUFR+132                                             06648000
CCAFIOP  EQU   HMASMCCA+140                                             06649000
CCAIOPTR EQU   CCAFIOP                                                  06650000
CCAFSYS  EQU   HMASMCCA+148                                             06651000
CCASREL  EQU   CCAFSYS+12                                               06652000
CCAFLAGA EQU   CCAFSYS+21                                               06653000
CCAFSTA  EQU   HMASMCCA+188                                             06654000
CCAFICT  EQU   HMASMCCA+192                                             06655000
CCAICT   EQU   CCAFICT                                                  06656000
CCAICPTF EQU   CCAFICT+4                                                06657000
CCAICMOD EQU   CCAFICT+8                                                06658000
CCAICLMD EQU   CCAFICT+12                                               06659000
CCAFPGM  EQU   HMASMCCA+208                                             06660000
CCABLDLP EQU   CCAFPGM                                                  06661000
CCADBLDL EQU   CCAFPGM+4                                                06662000
CCAFGTP  EQU   HMASMCCA+224                                             06663000
CCASEGTP EQU   CCAFGTP                                                  06664000
@NM00023 EQU   HMASMCCA+244                                             06665000
CCAFFUNC EQU   HMASMCCA+264                                             06666000
CCAFLAG1 EQU   CCAFFUNC+8                                               06667000
CCAACCPT EQU   CCAFLAG1                                                 06668000
CCAFLAG2 EQU   CCAFFUNC+11                                              06669000
CCAFPROC EQU   HMASMCCA+276                                             06670000
CCAFLAG3 EQU   CCAFPROC                                                 06671000
CCAFDIS  EQU   HMASMCCA+278                                             06672000
CCAFLAG4 EQU   CCAFDIS                                                  06673000
CCAFLAG5 EQU   CCAFDIS+1                                                06674000
CCAFLAG6 EQU   CCAFDIS+2                                                06675000
CCAFCNV  EQU   HMASMCCA+281                                             06676000
CCAFLAG8 EQU   CCAFCNV                                                  06677000
CCAFCTL  EQU   HMASMCCA+282                                             06678000
CCAFLAG9 EQU   CCAFCTL                                                  06679000
CCAFDSNG EQU   HMASMCCA+298                                             06680000
CCAFLAGB EQU   CCAFDSNG                                                 06681000
CCABLDLA EQU   0                                                        06682000
@NM00039 EQU   CCABLDLA                                                 06683000
CCABLDLL EQU   0                                                        06684000
@NM00041 EQU   CCABLDLL                                                 06685000
CCALKDRC EQU   @NM00041+20                                              06686000
@NM00043 EQU   CCABLDLL+124                                             06687000
CCAASMRC EQU   @NM00043+20                                              06688000
@NM00045 EQU   CCABLDLL+248                                             06689000
CCACPYRC EQU   @NM00045+20                                              06690000
@NM00047 EQU   CCABLDLL+372                                             06691000
CCACOMRC EQU   @NM00047+20                                              06692000
@NM00049 EQU   CCABLDLL+496                                             06693000
CCAZAPRC EQU   @NM00049+20                                              06694000
@NM00051 EQU   CCABLDLL+620                                             06695000
CCASUPRC EQU   @NM00051+20                                              06696000
@NM00053 EQU   CCABLDLL+744                                             06697000
CCAUPDRC EQU   @NM00053+20                                              06698000
CCABLDLM EQU   0                                                        06699000
CCABELMT EQU   CCABLDLM+4                                               06700000
CCABMPOS EQU   CCABELMT                                                 06701000
HMASMIOP EQU   0                                                        06702000
IOPDSID  EQU   HMASMIOP                                                 06703000
IOPFUNCT EQU   HMASMIOP+1                                               06704000
IOPRETRN EQU   HMASMIOP+2                                               06705000
IOPTYPE  EQU   HMASMIOP+3                                               06706000
IOPNAME  EQU   HMASMIOP+4                                               06707000
IOPNAM17 EQU   IOPNAME                                                  06708000
@NM00060 EQU   HMASMIOP+12                                              06709000
@NM00061 EQU   @NM00060                                                 06710000
IOPDDNAM EQU   HMASMIOP+24                                              06711000
IOPBUFAD EQU   HMASMIOP+52                                              06712000
IOPDRMAP EQU   HMASMIOP+56                                              06713000
IOPINAME EQU   IOPDRMAP                                                 06714000
IOPINAM  EQU   IOPINAME                                                 06715000
IOPITYP  EQU   IOPINAM                                                  06716000
IOPUSERL EQU   IOPDRMAP+11                                              06717000
IOPEND   EQU   IOPDRMAP+12                                              06718000
IOPLMCTL EQU   0                                                        06719000
IOPQSMIF EQU   0                                                        06720000
@NM00171 EQU   IOPQSMIF                                                 06721000
IOPQSMLS EQU   IOPQSMIF+8                                               06722000
IOPQSMNM EQU   IOPQSMLS                                                 06723000
IOPBS02  EQU   0                                                        06724000
IOPBS04  EQU   0                                                        06725000
IOPBAPF  EQU   IOPBS04                                                  06726000
HMASMPRL EQU   0                                                        06727000
PRLSPAN  EQU   HMASMPRL+2                                               06728000
PRLFLGS  EQU   PRLSPAN                                                  06729000
PRLBLANK EQU   PRLFLGS                                                  06730000
PRLDATE  EQU   HMASMPRL+4                                               06731000
PRLTIME  EQU   HMASMPRL+7                                               06732000
PRLEND   EQU   HMASMPRL+10                                              06733000
HMASMICT EQU   0                                                        06734000
ICTCORE  EQU   HMASMICT                                                 06735000
ICTPSPLN EQU   ICTCORE                                                  06736000
ICTMSPLN EQU   ICTCORE+4                                                06737000
ICTLSPLN EQU   ICTCORE+8                                                06738000
ICTGMSPL EQU   0                                                        06739000
ICTPTF   EQU   0                                                        06740000
ICTPTFS  EQU   ICTPTF                                                   06741000
ICTPEND  EQU   ICTPTFS                                                  06742000
ICTPFLG1 EQU   ICTPTF+7                                                 06743000
ICTPFLG3 EQU   ICTPTF+8                                                 06744000
ICTPPROC EQU   ICTPFLG3                                                 06745000
ICTPNOGO EQU   ICTPFLG3                                                 06746000
ICTPCPL  EQU   ICTPFLG3                                                 06747000
ICTPMSG  EQU   ICTPFLG3                                                 06748000
ICTPFLG5 EQU   ICTPTF+9                                                 06749000
ICTPFLG6 EQU   ICTPTF+11                                                06750000
ICTPFLF  EQU   ICTPFLG6                                                 06751000
ICTPFLG2 EQU   ICTPTF+12                                                06752000
ICTPFLG4 EQU   ICTPTF+13                                                06753000
ICTPDEXP EQU   ICTPFLG4                                                 06754000
ICTPDIMP EQU   ICTPFLG4                                                 06755000
ICTPGELM EQU   ICTPFLG4                                                 06756000
ICTPFLG8 EQU   ICTPTF+14                                                06757000
ICTPFLG9 EQU   ICTPTF+15                                                06758000
ICTPMSL  EQU   ICTPFLG9                                                 06759000
ICTPWRKO EQU   ICTPFLG9                                                 06760000
@NM00200 EQU   ICTPFLG9                                                 06761000
ICTPFLGA EQU   ICTPTF+16                                                06762000
ICTPUSR1 EQU   ICTPFLGA                                                 06763000
ICTPTYPE EQU   ICTPTF+17                                                06764000
ICTPONUM EQU   ICTPTF+18                                                06765000
ICTPSUPN EQU   ICTPTF+20                                                06766000
ICTPFMID EQU   ICTPTF+22                                                06767000
ICTPCHN  EQU   ICTPTF+64                                                06768000
ICTPRCHN EQU   ICTPTF+68                                                06769000
ICTPSCHN EQU   ICTPTF+72                                                06770000
ICTPPCHN EQU   ICTPTF+76                                                06771000
ICTPICHN EQU   ICTPTF+80                                                06772000
ICTPNCHN EQU   ICTPTF+84                                                06773000
ICTPVCHN EQU   ICTPTF+88                                                06774000
ICTPDCHN EQU   ICTPTF+92                                                06775000
ICTPBCHN EQU   ICTPTF+96                                                06776000
ICTIXPF  EQU   0                                                        06777000
ICTIXP   EQU   ICTIXPF                                                  06778000
ICTENTLS EQU   0                                                        06779000
ICTENTNT EQU   ICTENTLS                                                 06780000
ICTENTNM EQU   ICTENTNT                                                 06781000
ICTENTST EQU   ICTENTNT+7                                               06782000
ICTREQLS EQU   0                                                        06783000
ICTREQNT EQU   ICTREQLS                                                 06784000
ICTREQNM EQU   ICTREQNT                                                 06785000
ICTREQST EQU   ICTREQNT+7                                               06786000
ICTSUPLS EQU   0                                                        06787000
ICTSUPNT EQU   ICTSUPLS                                                 06788000
ICTSUPNM EQU   ICTSUPNT                                                 06789000
ICTSUPND EQU   ICTSUPNM                                                 06790000
ICTPRELS EQU   0                                                        06791000
ICTPRENT EQU   ICTPRELS                                                 06792000
ICTPRENM EQU   ICTPRENT                                                 06793000
ICTPREND EQU   ICTPRENM                                                 06794000
ICTPREST EQU   ICTPRENT+7                                               06795000
ICTIRQLS EQU   0                                                        06796000
ICTIRQNT EQU   ICTIRQLS                                                 06797000
ICTIRQNM EQU   ICTIRQNT                                                 06798000
ICTIRQST EQU   ICTIRQNT+7                                               06799000
ICTCSRST EQU   ICTIRQNT+15                                              06800000
ICTNPRLS EQU   0                                                        06801000
ICTNPRNT EQU   ICTNPRLS                                                 06802000
ICTNPRNM EQU   ICTNPRNT                                                 06803000
ICTVRSLS EQU   0                                                        06804000
ICTVRSNT EQU   ICTVRSLS                                                 06805000
ICTVRSNM EQU   ICTVRSNT                                                 06806000
ICTDELLS EQU   0                                                        06807000
ICTDELNT EQU   ICTDELLS                                                 06808000
ICTDELNM EQU   ICTDELNT                                                 06809000
ICTDELST EQU   ICTDELNT+7                                               06810000
ICTSBYLS EQU   0                                                        06811000
ICTSBYNT EQU   ICTSBYLS                                                 06812000
ICTSBYNM EQU   ICTSBYNT                                                 06813000
ICTMOD   EQU   0                                                        06814000
ICTMNAME EQU   ICTMOD                                                   06815000
ICTMEND  EQU   ICTMNAME                                                 06816000
ICTMFLG2 EQU   ICTMOD+8                                                 06817000
ICTMNOGO EQU   ICTMFLG2                                                 06818000
ICTMFLG1 EQU   ICTMOD+9                                                 06819000
ICTMMODR EQU   ICTMFLG1                                                 06820000
ICTMMOD  EQU   ICTMMODR                                                 06821000
ICTMASM  EQU   ICTMMODR                                                 06822000
ICTMZAP  EQU   ICTMFLG1                                                 06823000
ICTMXPND EQU   ICTMFLG1                                                 06824000
ICTMMACR EQU   ICTMFLG1                                                 06825000
ICTMMACU EQU   ICTMFLG1                                                 06826000
ICTMSRCR EQU   ICTMFLG1                                                 06827000
ICTMSRCU EQU   ICTMFLG1                                                 06828000
ICTMFLG3 EQU   ICTMOD+10                                                06829000
ICTLIBLK EQU   ICTMFLG3                                                 06830000
ICTLIBTX EQU   ICTMFLG3                                                 06831000
ICTMRELF EQU   ICTMFLG3                                                 06832000
ICTMWRK  EQU   ICTMFLG3                                                 06833000
ICTMFLG4 EQU   ICTMOD+11                                                06834000
ICTMISEL EQU   ICTMFLG4                                                 06835000
ICTMIDEL EQU   ICTMFLG4                                                 06836000
ICTMSELM EQU   ICTMFLG4                                                 06837000
ICTMASOC EQU   ICTMFLG4                                                 06838000
ICTMDSTE EQU   ICTMFLG4                                                 06839000
ICTMTSEL EQU   ICTMFLG4                                                 06840000
ICTMFLG5 EQU   ICTMOD+12                                                06841000
ICTMPASS EQU   ICTMFLG5                                                 06842000
ICTMODF4 EQU   ICTMOD+13                                                06843000
ICTMLEP1 EQU   ICTMODF4                                                 06844000
ICTMODF5 EQU   ICTMOD+14                                                06845000
ICTMLEP2 EQU   ICTMODF5                                                 06846000
ICTMODF6 EQU   ICTMOD+15                                                06847000
ICTMLEP3 EQU   ICTMODF6                                                 06848000
ICTMODF7 EQU   ICTMOD+16                                                06849000
ICTMLEP4 EQU   ICTMODF7                                                 06850000
ICTMACF4 EQU   ICTMOD+17                                                06851000
ICTFMLIB EQU   ICTMOD+24                                                06852000
ICTTOLIB EQU   ICTMOD+32                                                06853000
ICTMDSTL EQU   ICTMOD+48                                                06854000
ICTMSYSL EQU   ICTMOD+56                                                06855000
ICTMRMID EQU   ICTMOD+80                                                06856000
ICTMFMID EQU   ICTMOD+88                                                06857000
ICTPPTR  EQU   ICTMOD+96                                                06858000
ICTMCHN  EQU   ICTMOD+100                                               06859000
ICTMICHN EQU   ICTMOD+104                                               06860000
ICTMACHN EQU   ICTMOD+112                                               06861000
ICTMTCHN EQU   ICTMOD+116                                               06862000
ICTMVCHN EQU   ICTMOD+120                                               06863000
ICTMUCHN EQU   ICTMOD+124                                               06864000
ICTIXMF  EQU   0                                                        06865000
ICTMIDLS EQU   0                                                        06866000
ICTMID   EQU   ICTMIDLS                                                 06867000
ICTMODID EQU   ICTMID                                                   06868000
ICTMIDND EQU   ICTMODID                                                 06869000
ICTMODST EQU   ICTMID+7                                                 06870000
ICTMIDPS EQU   ICTMODST                                                 06871000
ICTMIDPL EQU   ICTMODST                                                 06872000
ICTASMLS EQU   0                                                        06873000
ICTASMAD EQU   ICTASMLS                                                 06874000
ICTASMND EQU   ICTASMAD                                                 06875000
ICTTALLS EQU   0                                                        06876000
ICTTALNM EQU   ICTTALLS                                                 06877000
ICTMVRLS EQU   0                                                        06878000
ICTMVRNT EQU   ICTMVRLS                                                 06879000
ICTMVRNM EQU   ICTMVRNT                                                 06880000
ICTMUMLS EQU   0                                                        06881000
ICTMUMNT EQU   ICTMUMLS                                                 06882000
ICTMUMNM EQU   ICTMUMNT                                                 06883000
ICTLMOD  EQU   0                                                        06884000
ICTLMNAM EQU   ICTLMOD                                                  06885000
ICTLNAME EQU   ICTLMNAM                                                 06886000
ICTLFLG4 EQU   ICTLMOD+8                                                06887000
ICTLFLG1 EQU   ICTLMOD+9                                                06888000
ICTLFLG5 EQU   ICTLMOD+10                                               06889000
ICTLFLG6 EQU   ICTLMOD+11                                               06890000
ICTLFLG7 EQU   ICTLMOD+12                                               06891000
ICTLFLG2 EQU   ICTLMOD+13                                               06892000
ICTLFLG3 EQU   ICTLMOD+14                                               06893000
ICTLCHN  EQU   ICTLMOD+34                                               06894000
ICTIXLF  EQU   0                                                        06895000
MCBPTFMP EQU   0                                                        06896000
MCBTYPE  EQU   MCBPTFMP                                                 06897000
MCBVERMP EQU   0                                                        06898000
MCBVEND  EQU   MCBVERMP+8                                               06899000
MCBIFMP  EQU   0                                                        06900000
MCBIEND  EQU   MCBIFMP+8                                                06901000
MCBELEMP EQU   0                                                        06902000
MCBENAME EQU   MCBELEMP+1                                               06903000
MCBERMID EQU   MCBELEMP+129                                             06904000
MCBELEPM EQU   MCBELEMP+136                                             06905000
MCBEFLG1 EQU   MCBELEPM                                                 06906000
MCBEFLG2 EQU   MCBELEPM+1                                               06907000
MCBEFLG3 EQU   MCBELEPM+2                                               06908000
MCBEFLG4 EQU   MCBELEPM+3                                               06909000
MCBEFLG5 EQU   MCBELEMP+140                                             06910000
MCBEEND  EQU   MCBELEMP+141                                             06911000
SPLPPACK EQU   0                                                        06912000
SPLPUNPK EQU   0                                                        06913000
SPLPDSN  EQU   0                                                        06914000
SPLODSN  EQU   SPLPDSN                                                  06915000
CCADSIDA EQU   0                                                        06916000
CCATYPEA EQU   0                                                        06917000
IOPBS01  EQU   0                                                        06918000
IOPBS03  EQU   0                                                        06919000
TBLXPARM EQU   0                                                        06920000
TBLXINDX EQU   TBLXPARM+4                                               06921000
TBLXIOP2 EQU   TBLXPARM+16                                              06922000
TBLXTBL  EQU   TBLXPARM+28                                              06923000
TBLXTOP  EQU   TBLXPARM+32                                              06924000
TBLXNULL EQU   TBLXPARM+36                                              06925000
TBLXCDSI EQU   TBLXPARM+60                                              06926000
TBLXFUNC EQU   TBLXPARM+64                                              06927000
TBLXFLG1 EQU   TBLXPARM+80                                              06928000
TBLXRC   EQU   TBLXPARM+92                                              06929000
TBLXIOP3 EQU   TBLXPARM+104                                             06930000
DELSYSMD EQU   0                                                        06931000
DELMNAME EQU   0                                                        06932000
DELMTYP  EQU   0                                                        06933000
DELMFCTN EQU   0                                                        06934000
DELMSMD  EQU   0                                                        06935000
BLDSYSMD EQU   0                                                        06936000
BLDMODRC EQU   0                                                        06937000
BLDM2SMD EQU   0                                                        06938000
BLDMD2RC EQU   0                                                        06939000
BLDM3SMD EQU   0                                                        06940000
BLDMD3RC EQU   0                                                        06941000
BLDESMD  EQU   0                                                        06942000
BLDENTRC EQU   0                                                        06943000
ELEMNAME EQU   0                                                        06944000
ELEMTYPE EQU   0                                                        06945000
BLDMFSMD EQU   0                                                        06946000
BLDFLSHC EQU   0                                                        06947000
MSUPSMD  EQU   0                                                        06948000
SKIPRC   EQU   0                                                        06949000
ELNAME   EQU   0                                                        06950000
ELTYPE   EQU   0                                                        06951000
ANSWRKC  EQU   0                                                        06952000
ZAPMOD@  EQU   0                                                        06953000
ZAPPTF@  EQU   0                                                        06954000
XPNDRC   EQU   0                                                        06955000
MEMBR    EQU   0                                                        06956000
LOCRC    EQU   0                                                        06957000
ELMNAME  EQU   0                                                        06958000
ELMCBTY  EQU   0                                                        06959000
SMDNAME  EQU   0                                                        06960000
RTNPTR   EQU   0                                                        06961000
SCRMOD   EQU   0                                                        06962000
SRCENTRY EQU   0                                                        06963000
MODENTRY EQU   0                                                        06964000
NXTINDX  EQU   0                                                        06965000
MSGCODE1 EQU   0                                                        06966000
MSGCODE2 EQU   0                                                        06967000
INVSYSMD EQU   0                                                        06968000
MSLSYSMD EQU   0                                                        06969000
MSL      EQU   0                                                        06970000
ASMENTRY EQU   0                                                        06971000
CHKAPTR  EQU   0                                                        06972000
SRCHMN   EQU   0                                                        06973000
SRCHMP   EQU   0                                                        06974000
ELIMASME EQU   0                                                        06975000
ELMNNAME EQU   0                                                        06976000
ELMNTYPE EQU   0                                                        06977000
ELMNPTR  EQU   0                                                        06978000
ELMENTRY EQU   0                                                        06979000
ETEBCDIC EQU   0                                                        06980000
IIOPTR   EQU   0                                                        06981000
IMODENT  EQU   0                                                        06982000
SKPN     EQU   0                                                        06983000
IOPUDATA EQU   IOPEND                                                   06984000
IOPINAM3 EQU   IOPINAME                                                 06985000
@NM00067 EQU   IOPINAM3                                                 06986000
IOPSTCMP EQU   IOPUDATA                                                 06987000
IOPDYNDT EQU   IOPUDATA                                                 06988000
IOPSPACE EQU   IOPDYNDT+44                                              06989000
IOPDTYPE EQU   IOPDYNDT+50                                              06990000
IOPNTMAX EQU   IOPDRMAP                                                 06991000
IOPNTMAP EQU   IOPDRMAP                                                 06992000
IOPCDMAP EQU   IOPNTMAP                                                 06993000
IOPPTMAP EQU   IOPCDMAP                                                 06994000
IOPSCMAP EQU   IOPPTMAP                                                 06995000
IOPDIRCT EQU   IOPSCMAP+12                                              06996000
IOPCDMAX EQU   IOPDIRCT                                                 06997000
IOPCQMAP EQU   IOPDRMAP                                                 06998000
@NM00078 EQU   IOPUDATA                                                 06999000
@NM00079 EQU   IOPUDATA                                                 07000000
IOPASMNT EQU   IOPUDATA                                                 07001000
IOPASMDR EQU   IOPASMNT                                                 07002000
IOPABUNT EQU   IOPASMDR+1                                               07003000
IOPLMDNT EQU   IOPUDATA                                                 07004000
IOPLMDDR EQU   IOPLMDNT                                                 07005000
IOPLMLEP EQU   IOPLMDDR+1                                               07006000
IOPLMDF1 EQU   IOPLMLEP                                                 07007000
IOPFLGS2 EQU   IOPLMDF1                                                 07008000
IOPLMDF2 EQU   IOPLMLEP+1                                               07009000
IOPLMDF3 EQU   IOPLMLEP+2                                               07010000
IOPLMDF4 EQU   IOPLMLEP+3                                               07011000
IOPLMDF5 EQU   IOPLMDDR+5                                               07012000
IOPFLGS3 EQU   IOPLMDF5                                                 07013000
IOPLMDFX EQU   IOPLMDNT+24                                              07014000
@NM00088 EQU   IOPLMDFX                                                 07015000
IOPLNTRY EQU   IOPLMDFX+8                                               07016000
IOPLSYS  EQU   IOPLNTRY                                                 07017000
IOPSYSLB EQU   IOPLSYS                                                  07018000
IOPMACNT EQU   IOPUDATA                                                 07019000
IOPMACDR EQU   IOPMACNT                                                 07020000
IOPRMIDE EQU   IOPMACDR+1                                               07021000
IOPRMID  EQU   IOPRMIDE                                                 07022000
IOPRMST  EQU   IOPRMIDE+7                                               07023000
IOPFMIDE EQU   IOPMACDR+9                                               07024000
IOPFMID  EQU   IOPFMIDE                                                 07025000
IOPMACFX EQU   IOPMACNT+24                                              07026000
IOPBUNT  EQU   IOPMACFX                                                 07027000
IOPMCSYS EQU   IOPMACFX+64                                              07028000
IOPMCDLB EQU   IOPMACFX+72                                              07029000
IOPMCEND EQU   IOPMACNT+104                                             07030000
IOPMACVR EQU   IOPMCEND                                                 07031000
IOPMCENT EQU   IOPMACVR                                                 07032000
IOPMCDTA EQU   IOPMCENT                                                 07033000
IOPMCASM EQU   IOPMCDTA                                                 07034000
IOPMACID EQU   IOPMCASM                                                 07035000
IOPMACND EQU   IOPMACID                                                 07036000
IOPMACST EQU   IOPMCASM+7                                               07037000
IOPMCIND EQU   IOPMCENT+8                                               07038000
IOPEOFNT EQU   IOPUDATA                                                 07039000
IOPSRCNT EQU   IOPUDATA                                                 07040000
IOPSRCDR EQU   IOPSRCNT                                                 07041000
@NM00099 EQU   IOPSRCDR+1                                               07042000
@NM00101 EQU   @NM00099+7                                               07043000
@NM00105 EQU   IOPSRCDR+9                                               07044000
IOPSRCFX EQU   IOPSRCNT+24                                              07045000
@NM00109 EQU   IOPSRCFX                                                 07046000
IOPSRSYS EQU   IOPSRCFX+64                                              07047000
IOPSRDLB EQU   IOPSRCFX+72                                              07048000
IOPSREND EQU   IOPSRCNT+104                                             07049000
IOPSRCVR EQU   IOPSREND                                                 07050000
IOPSNTRY EQU   IOPSRCVR                                                 07051000
IOPSRDTA EQU   IOPSNTRY                                                 07052000
IOPSRCID EQU   IOPSRDTA                                                 07053000
IOPSRCST EQU   IOPSRDTA+7                                               07054000
IOPMODNT EQU   IOPUDATA                                                 07055000
IOPMODDR EQU   IOPMODNT                                                 07056000
@NM00115 EQU   IOPMODDR+1                                               07057000
@NM00117 EQU   @NM00115+7                                               07058000
@NM00121 EQU   IOPMODDR+9                                               07059000
IOPMODFX EQU   IOPMODNT+24                                              07060000
@NM00125 EQU   IOPMODFX                                                 07061000
IOPMDLEP EQU   IOPMODFX+8                                               07062000
IOPMODF1 EQU   IOPMDLEP                                                 07063000
IOPMODF2 EQU   IOPMDLEP+1                                               07064000
IOPMODF3 EQU   IOPMDLEP+2                                               07065000
IOPMODF4 EQU   IOPMDLEP+3                                               07066000
IOPDLIB  EQU   IOPMODFX+72                                              07067000
IOPMDEND EQU   IOPMODNT+104                                             07068000
IOPMODVR EQU   IOPMDEND                                                 07069000
IOPMNTRY EQU   IOPMODVR                                                 07070000
IOPMDDTA EQU   IOPMNTRY                                                 07071000
IOPLMODS EQU   IOPMDDTA                                                 07072000
IOPMODID EQU   IOPLMODS                                                 07073000
IOPMODND EQU   IOPMODID                                                 07074000
IOPMODST EQU   IOPLMODS+7                                               07075000
IOPMDIND EQU   IOPMNTRY+8                                               07076000
IOPDLBNT EQU   IOPUDATA                                                 07077000
IOPDLBDR EQU   IOPDLBNT                                                 07078000
IOPDLBFX EQU   IOPDLBNT+24                                              07079000
@NM00136 EQU   IOPDLBFX                                                 07080000
IOPDLEND EQU   IOPDLBNT+104                                             07081000
IOPDLBVR EQU   IOPDLEND                                                 07082000
IOPDNTRY EQU   IOPDLBVR                                                 07083000
IOPDSYS  EQU   IOPDNTRY                                                 07084000
IOPSYSNT EQU   IOPUDATA                                                 07085000
IOPSYSDR EQU   IOPSYSNT                                                 07086000
IOPSYSF1 EQU   IOPSYSDR+4                                               07087000
IOPFLGS7 EQU   IOPSYSF1                                                 07088000
IOPSYSFX EQU   IOPSYSNT+24                                              07089000
@NM00143 EQU   IOPSYSFX                                                 07090000
IOPSYEND EQU   IOPSYSNT+184                                             07091000
IOPSYSVR EQU   IOPSYEND                                                 07092000
IOPSYSTR EQU   IOPSYSVR                                                 07093000
IOPSYNTR EQU   IOPSYSTR                                                 07094000
IOPPTFNT EQU   IOPUDATA                                                 07095000
IOPPTFDR EQU   IOPPTFNT                                                 07096000
IOPPSTAT EQU   IOPPTFDR+2                                               07097000
IOPPTFF1 EQU   IOPPSTAT                                                 07098000
IOPFLGS5 EQU   IOPPTFF1                                                 07099000
IOPDUMMP EQU   IOPFLGS5                                                 07100000
IOPPTFF2 EQU   IOPPSTAT+1                                               07101000
IOPPTFF3 EQU   IOPPSTAT+3                                               07102000
IOPPTFFX EQU   IOPPTFNT+24                                              07103000
@NM00152 EQU   IOPPTFFX                                                 07104000
@NM00153 EQU   @NM00152                                                 07105000
IOPPDTES EQU   IOPPTFFX+41                                              07106000
@NM00156 EQU   IOPPDTES                                                 07107000
IOPPTPFX EQU   IOPPDTES+6                                               07108000
IOPDATES EQU   IOPPTPFX                                                 07109000
IOPPTEND EQU   IOPPTFNT+104                                             07110000
IOPPTFVR EQU   IOPPTEND                                                 07111000
IOPPNTRY EQU   IOPPTFVR                                                 07112000
IOPPMODS EQU   IOPPNTRY                                                 07113000
IOPPTFND EQU   IOPPMODS                                                 07114000
IOPPIND  EQU   IOPPNTRY+8                                               07115000
IOPENTNT EQU   IOPUDATA+104                                             07116000
IOPSRLNT EQU   IOPUDATA+104                                             07117000
IOPPRENT EQU   IOPUDATA+104                                             07118000
IOPNPRNT EQU   IOPUDATA+104                                             07119000
IOPSUPNT EQU   IOPUDATA+104                                             07120000
IOPREQNT EQU   IOPUDATA+104                                             07121000
IOPIRQNT EQU   IOPUDATA+104                                             07122000
IOPFIDNT EQU   IOPUDATA+104                                             07123000
IOPDELNT EQU   IOPUDATA+104                                             07124000
IOPVERNT EQU   IOPUDATA+104                                             07125000
IOPSBYNT EQU   IOPUDATA+104                                             07126000
IOPQSMNT EQU   IOPUDATA                                                 07127000
IOPQSMDR EQU   IOPQSMNT                                                 07128000
IOPQFMNT EQU   IOPUDATA                                                 07129000
IOPQFMDR EQU   IOPQFMNT                                                 07130000
IOPQFEND EQU   IOPQFMNT+2                                               07131000
IOPQFMVR EQU   IOPQFEND                                                 07132000
IOPQFMLS EQU   IOPQFMVR                                                 07133000
IOPQFMNM EQU   IOPQFMLS                                                 07134000
IOPPTSYS EQU   IOPUDATA                                                 07135000
IOPPTSDR EQU   IOPPTSYS                                                 07136000
IOPPTSFX EQU   IOPPTSYS+24                                              07137000
IOPDSSPC EQU   IOPPTSFX                                                 07138000
IOPPTFG1 EQU   IOPPTSFX+34                                              07139000
IOPPSEND EQU   IOPPTSYS+1064                                            07140000
IOPPTSVR EQU   IOPPSEND                                                 07141000
IOPPTNTR EQU   IOPPTSVR                                                 07142000
@NM00181 EQU   IOPPTNTR                                                 07143000
IOPPTFMD EQU   @NM00181                                                 07144000
IOPPTREL EQU   IOPPTFMD                                                 07145000
IOPBPDS  EQU   IOPUDATA                                                 07146000
IOPBLEP1 EQU   IOPBPDS+8                                                07147000
IOPBLEP2 EQU   IOPBPDS+9                                                07148000
@NM00185 EQU   IOPBPDS+18                                               07149000
IOPBFTB0 EQU   @NM00185                                                 07150000
IOPBFTB1 EQU   IOPBFTB0                                                 07151000
ICTENDNT EQU   ICTENDCH                                                 07152000
ICTENDIX EQU   ICTENDCH                                                 07153000
MCBVVLST EQU   MCBVEND                                                  07154000
MCBVNTRY EQU   MCBVVLST                                                 07155000
MCBVNUM  EQU   MCBVNTRY                                                 07156000
MCBIVLST EQU   MCBIEND                                                  07157000
MCBINTRY EQU   MCBIVLST                                                 07158000
MCBINUM  EQU   MCBINTRY                                                 07159000
MCBEVLST EQU   MCBEEND                                                  07160000
MCBENTRY EQU   MCBEVLST                                                 07161000
MCBENUM  EQU   MCBENTRY                                                 07162000
PRLDATA  EQU   PRLEND                                                   07163000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07164000
MCBEIND  EQU   MCBEVLST+8                                               07165000
@NM00254 EQU   MCBENTRY+7                                               07166000
MCBEND   EQU   MCBENUM                                                  07167000
MCBIIND  EQU   MCBIVLST+8                                               07168000
@NM00247 EQU   MCBINTRY+7                                               07169000
MCBIND   EQU   MCBINUM                                                  07170000
MCBVIND  EQU   MCBVVLST+8                                               07171000
@NM00245 EQU   MCBVNTRY+7                                               07172000
MCBVND   EQU   MCBVNUM                                                  07173000
IOPBCEND EQU   IOPBPDS+21                                               07174000
IOPBFTB3 EQU   IOPBFTB0+2                                               07175000
IOPBFTB2 EQU   IOPBFTB0+1                                               07176000
@NM00187 EQU   IOPBFTB1                                                 07177000
IOPBAPFP EQU   IOPBFTB1                                                 07178000
IOPBSSI  EQU   IOPBFTB1                                                 07179000
IOPBPAGA EQU   IOPBFTB1                                                 07180000
@NM00186 EQU   IOPBFTB1                                                 07181000
IOPBAOSL EQU   IOPBFTB1                                                 07182000
IOPBSEPA EQU   IOPBPDS+15                                               07183000
IOPBFTBL EQU   IOPBPDS+13                                               07184000
IOPBSTOR EQU   IOPBPDS+10                                               07185000
IOPBREFR EQU   IOPBLEP2                                                 07186000
IOPBLEF  EQU   IOPBLEP2                                                 07187000
IOPBTEST EQU   IOPBLEP2                                                 07188000
IOPBNE   EQU   IOPBLEP2                                                 07189000
@NM00184 EQU   IOPBLEP2                                                 07190000
IOPBDC   EQU   IOPBLEP2                                                 07191000
@NM00183 EQU   IOPBLEP1                                                 07192000
IOPBSCTR EQU   IOPBLEP1                                                 07193000
IOPBOL   EQU   IOPBLEP1                                                 07194000
@NM00182 EQU   IOPBLEP1                                                 07195000
IOPBOVLY EQU   IOPBLEP1                                                 07196000
IOPBREUS EQU   IOPBLEP1                                                 07197000
IOPBRENT EQU   IOPBLEP1                                                 07198000
IOPBNL   EQU   IOPBPDS+7                                                07199000
IOPBTTRN EQU   IOPBPDS+4                                                07200000
IOPBZERO EQU   IOPBPDS+3                                                07201000
IOPBTTRT EQU   IOPBPDS                                                  07202000
IOPPTIND EQU   IOPPTNTR+8                                               07203000
IOPPTSND EQU   IOPPTREL                                                 07204000
@NM00180 EQU   IOPPTSFX+872                                             07205000
IOPSYZPP EQU   IOPPTSFX+772                                             07206000
IOPSYZPR EQU   IOPPTSFX+771                                             07207000
IOPSYZPS EQU   IOPPTSFX+763                                             07208000
IOPSYZAP EQU   IOPPTSFX+755                                             07209000
IOPSYUPP EQU   IOPPTSFX+655                                             07210000
IOPSYUPR EQU   IOPPTSFX+654                                             07211000
IOPSYUPS EQU   IOPPTSFX+646                                             07212000
IOPSYUPD EQU   IOPPTSFX+638                                             07213000
IOPSYSPP EQU   IOPPTSFX+538                                             07214000
IOPSYSPR EQU   IOPPTSFX+537                                             07215000
IOPSYSPS EQU   IOPPTSFX+529                                             07216000
IOPSYSUP EQU   IOPPTSFX+521                                             07217000
IOPSYLKP EQU   IOPPTSFX+421                                             07218000
IOPSYLKR EQU   IOPPTSFX+420                                             07219000
IOPSYLKS EQU   IOPPTSFX+412                                             07220000
IOPSYLKD EQU   IOPPTSFX+404                                             07221000
IOPSYCPP EQU   IOPPTSFX+304                                             07222000
IOPSYCPR EQU   IOPPTSFX+303                                             07223000
IOPSYCPS EQU   IOPPTSFX+295                                             07224000
IOPSYCPY EQU   IOPPTSFX+287                                             07225000
IOPSYCOP EQU   IOPPTSFX+187                                             07226000
IOPSYCOR EQU   IOPPTSFX+186                                             07227000
IOPSYCOS EQU   IOPPTSFX+178                                             07228000
IOPSYCOM EQU   IOPPTSFX+170                                             07229000
IOPSYASP EQU   IOPPTSFX+70                                              07230000
IOPSYASR EQU   IOPPTSFX+69                                              07231000
IOPSYASS EQU   IOPPTSFX+61                                              07232000
IOPSYASM EQU   IOPPTSFX+53                                              07233000
@NM00179 EQU   IOPPTSFX+35                                              07234000
@NM00178 EQU   IOPPTFG1                                                 07235000
IOPPTSNJ EQU   IOPPTFG1                                                 07236000
IOPPTSNP EQU   IOPPTFG1                                                 07237000
IOPSYPLN EQU   IOPPTSFX+32                                              07238000
IOPDSPFX EQU   IOPPTSFX+6                                               07239000
IOPDSDIR EQU   IOPDSSPC+4                                               07240000
IOPDSSEC EQU   IOPDSSPC+2                                               07241000
IOPDSPRM EQU   IOPDSSPC                                                 07242000
@NM00177 EQU   IOPPTSDR+4                                               07243000
IOPPTPEM EQU   IOPPTSDR+2                                               07244000
IOPPCNVL EQU   IOPPTSDR+1                                               07245000
@NM00176 EQU   IOPPTSDR                                                 07246000
IOPQFMTP EQU   IOPQFMLS+8                                               07247000
@NM00175 EQU   IOPQFMLS+7                                               07248000
IOPQFMND EQU   IOPQFMNM                                                 07249000
@NM00174 EQU   IOPQFMDR                                                 07250000
@NM00170 EQU   IOPQSMDR                                                 07251000
@NM00169 EQU   IOPSBYNT+8                                               07252000
IOPSBYST EQU   IOPSBYNT+7                                               07253000
IOPSBYNM EQU   IOPSBYNT                                                 07254000
@NM00168 EQU   IOPVERNT+8                                               07255000
IOPVERST EQU   IOPVERNT+7                                               07256000
IOPVERNM EQU   IOPVERNT                                                 07257000
@NM00167 EQU   IOPDELNT+8                                               07258000
IOPDELST EQU   IOPDELNT+7                                               07259000
IOPDELNM EQU   IOPDELNT                                                 07260000
@NM00166 EQU   IOPFIDNT+8                                               07261000
IOPFIDST EQU   IOPFIDNT+7                                               07262000
IOPFIDNM EQU   IOPFIDNT                                                 07263000
@NM00165 EQU   IOPIRQNT+8                                               07264000
IOPIRQST EQU   IOPIRQNT+7                                               07265000
IOPIRQNM EQU   IOPIRQNT                                                 07266000
@NM00164 EQU   IOPREQNT+8                                               07267000
IOPREQST EQU   IOPREQNT+7                                               07268000
IOPREQNM EQU   IOPREQNT                                                 07269000
@NM00163 EQU   IOPSUPNT+8                                               07270000
IOPSUPST EQU   IOPSUPNT+7                                               07271000
IOPSUPNM EQU   IOPSUPNT                                                 07272000
@NM00162 EQU   IOPNPRNT+8                                               07273000
IOPNPRST EQU   IOPNPRNT+7                                               07274000
IOPNPRNM EQU   IOPNPRNT                                                 07275000
@NM00161 EQU   IOPPRENT+8                                               07276000
IOPPREST EQU   IOPPRENT+7                                               07277000
IOPPRENM EQU   IOPPRENT                                                 07278000
@NM00160 EQU   IOPSRLNT+8                                               07279000
IOPSRLST EQU   IOPSRLNT+7                                               07280000
@NM00159 EQU   IOPSRLNT+4                                               07281000
IOPSRLNM EQU   IOPSRLNT                                                 07282000
@NM00158 EQU   IOPENTNT+8                                               07283000
IOPENTST EQU   IOPENTNT+7                                               07284000
IOPENTNM EQU   IOPENTNT                                                 07285000
IOPPFMID EQU   IOPPTFFX+73                                              07286000
@NM00157 EQU   IOPPTPFX+24                                              07287000
IOPUCLT  EQU   IOPDATES+21                                              07288000
IOPUCLD  EQU   IOPDATES+18                                              07289000
IOPACCT  EQU   IOPDATES+15                                              07290000
IOPACCD  EQU   IOPDATES+12                                              07291000
IOPRSTT  EQU   IOPDATES+9                                               07292000
IOPRSTD  EQU   IOPDATES+6                                               07293000
IOPAPPT  EQU   IOPDATES+3                                               07294000
IOPAPPD  EQU   IOPDATES                                                 07295000
IOPRECT  EQU   @NM00156+3                                               07296000
IOPRECD  EQU   @NM00156                                                 07297000
@NM00155 EQU   IOPPTFFX+8                                               07298000
@NM00154 EQU   @NM00152+7                                               07299000
IOPPRELN EQU   @NM00153                                                 07300000
@NM00151 EQU   IOPPTFDR+20                                              07301000
IOPSBYNO EQU   IOPPTFDR+13                                              07302000
IOPDBYNO EQU   IOPPTFDR+6                                               07303000
@NM00150 EQU   IOPPTFF3                                                 07304000
IOPFLF   EQU   IOPPTFF3                                                 07305000
IOPDBYP  EQU   IOPPTFF3                                                 07306000
IOPSBYP  EQU   IOPPTFF3                                                 07307000
IOPPMDLP EQU   IOPPTFF2+1                                               07308000
IOPPADDP EQU   IOPPTFF2+1                                               07309000
@NM00149 EQU   IOPPTFF2+1                                               07310000
IOPLRFP  EQU   IOPPTFF2                                                 07311000
IOPJCLP  EQU   IOPPTFF2                                                 07312000
IOPSUPP  EQU   IOPPTFF2                                                 07313000
IOPREQP  EQU   IOPPTFF2                                                 07314000
IOPPREP  EQU   IOPPTFF2                                                 07315000
IOPNPRP  EQU   IOPPTFF2                                                 07316000
IOPIRQP  EQU   IOPPTFF2                                                 07317000
IOPDELP  EQU   IOPPTFF2                                                 07318000
IOPREGEN EQU   IOPFLGS5                                                 07319000
IOPBYP   EQU   IOPFLGS5                                                 07320000
@NM00148 EQU   IOPFLGS5                                                 07321000
IOPERROR EQU   IOPFLGS5                                                 07322000
IOPACC   EQU   IOPFLGS5                                                 07323000
IOPRES   EQU   IOPFLGS5                                                 07324000
IOPAPP   EQU   IOPFLGS5                                                 07325000
IOPPTYPE EQU   IOPPTFDR+1                                               07326000
@NM00147 EQU   IOPPTFDR                                                 07327000
IOPSYSTP EQU   IOPSYSTR+8                                               07328000
IOPSYSND EQU   IOPSYNTR                                                 07329000
@NM00146 EQU   IOPSYSFX+21                                              07330000
IOPSYSID EQU   IOPSYSFX+13                                              07331000
IOPNUCID EQU   IOPSYSFX+12                                              07332000
IOPSREL  EQU   IOPSYSFX+8                                               07333000
@NM00145 EQU   @NM00143+7                                               07334000
@NM00144 EQU   @NM00143                                                 07335000
@NM00142 EQU   IOPSYSDR+5                                               07336000
@NM00141 EQU   IOPFLGS7                                                 07337000
IOPSYNG  EQU   IOPFLGS7                                                 07338000
IOPSYDL  EQU   IOPFLGS7                                                 07339000
IOPSTSNP EQU   IOPFLGS7                                                 07340000
IOPMTSNP EQU   IOPFLGS7                                                 07341000
IOPPEMAX EQU   IOPSYSDR+2                                               07342000
IOPSCNVL EQU   IOPSYSDR+1                                               07343000
@NM00140 EQU   IOPSYSDR                                                 07344000
IOPDLIND EQU   IOPDNTRY+8                                               07345000
IOPDLBND EQU   IOPDSYS                                                  07346000
@NM00139 EQU   IOPDLBFX+8                                               07347000
@NM00138 EQU   @NM00136+7                                               07348000
@NM00137 EQU   @NM00136                                                 07349000
@NM00135 EQU   IOPDLBDR+1                                               07350000
@NM00134 EQU   IOPDLBDR                                                 07351000
@NM00133 EQU   IOPMODST                                                 07352000
@NM00132 EQU   IOPMODFX+12                                              07353000
@NM00131 EQU   IOPMODF4                                                 07354000
@NM00130 EQU   IOPMODF3                                                 07355000
@NM00129 EQU   IOPMODF2                                                 07356000
IOPMPAGA EQU   IOPMODF2                                                 07357000
IOPMNE   EQU   IOPMODF2                                                 07358000
@NM00128 EQU   IOPMODF1                                                 07359000
IOPMDC   EQU   IOPMODF1                                                 07360000
IOPMREFR EQU   IOPMODF1                                                 07361000
IOPMOVLY EQU   IOPMODF1                                                 07362000
IOPMSCTR EQU   IOPMODF1                                                 07363000
IOPMREUS EQU   IOPMODF1                                                 07364000
IOPMRENT EQU   IOPMODF1                                                 07365000
IOPMAPF  EQU   IOPMODF1                                                 07366000
@NM00127 EQU   @NM00125+7                                               07367000
@NM00126 EQU   @NM00125                                                 07368000
@NM00124 EQU   IOPMODDR+17                                              07369000
@NM00123 EQU   @NM00121+7                                               07370000
@NM00122 EQU   @NM00121                                                 07371000
@NM00120 EQU   @NM00117                                                 07372000
@NM00119 EQU   @NM00117                                                 07373000
@NM00118 EQU   @NM00117                                                 07374000
@NM00116 EQU   @NM00115                                                 07375000
@NM00114 EQU   IOPMODDR                                                 07376000
IOPSRIND EQU   IOPSNTRY+8                                               07377000
@NM00113 EQU   IOPSRCST                                                 07378000
IOPSRCND EQU   IOPSRCID                                                 07379000
@NM00112 EQU   IOPSRCFX+8                                               07380000
@NM00111 EQU   @NM00109+7                                               07381000
@NM00110 EQU   @NM00109                                                 07382000
@NM00108 EQU   IOPSRCDR+18                                              07383000
IOPSRLNG EQU   IOPSRCDR+17                                              07384000
@NM00107 EQU   @NM00105+7                                               07385000
@NM00106 EQU   @NM00105                                                 07386000
@NM00104 EQU   @NM00101                                                 07387000
@NM00103 EQU   @NM00101                                                 07388000
@NM00102 EQU   @NM00101                                                 07389000
@NM00100 EQU   @NM00099                                                 07390000
@NM00098 EQU   IOPSRCDR                                                 07391000
IOPEOFND EQU   IOPEOFNT                                                 07392000
IOPMCTYP EQU   IOPMCIND                                                 07393000
@NM00097 EQU   IOPMACST                                                 07394000
@NM00096 EQU   IOPMACFX+8                                               07395000
IOPBUTYP EQU   IOPBUNT+7                                                07396000
IOPBUSMD EQU   IOPBUNT                                                  07397000
@NM00095 EQU   IOPMACDR+18                                              07398000
IOPMCLNG EQU   IOPMACDR+17                                              07399000
IOPFMST  EQU   IOPFMIDE+7                                               07400000
@NM00094 EQU   IOPRMST                                                  07401000
IOPRMASM EQU   IOPRMST                                                  07402000
@NM00093 EQU   IOPRMST                                                  07403000
@NM00092 EQU   IOPMACDR                                                 07404000
IOPLMIND EQU   IOPLNTRY+8                                               07405000
IOPLMDND EQU   IOPSYSLB                                                 07406000
@NM00090 EQU   @NM00088+7                                               07407000
@NM00089 EQU   @NM00088                                                 07408000
@NM00087 EQU   IOPLMDDR+6                                               07409000
@NM00086 EQU   IOPFLGS3                                                 07410000
IOPCHREP EQU   IOPFLGS3                                                 07411000
IOPLINK  EQU   IOPFLGS3                                                 07412000
IOPCOPY  EQU   IOPFLGS3                                                 07413000
@NM00085 EQU   IOPLMDF4                                                 07414000
@NM00084 EQU   IOPLMDF3                                                 07415000
@NM00083 EQU   IOPLMDF2                                                 07416000
IOPPAGA  EQU   IOPLMDF2                                                 07417000
IOPNE    EQU   IOPLMDF2                                                 07418000
@NM00082 EQU   IOPFLGS2                                                 07419000
IOPDC    EQU   IOPFLGS2                                                 07420000
IOPREFR  EQU   IOPFLGS2                                                 07421000
IOPOVLY  EQU   IOPFLGS2                                                 07422000
IOPSCTR  EQU   IOPFLGS2                                                 07423000
IOPREUS  EQU   IOPFLGS2                                                 07424000
IOPRENT  EQU   IOPFLGS2                                                 07425000
IOPAPF   EQU   IOPFLGS2                                                 07426000
@NM00081 EQU   IOPLMDDR                                                 07427000
@NM00080 EQU   IOPASMDR+9                                               07428000
IOPABUTP EQU   IOPABUNT+7                                               07429000
IOPABUPT EQU   IOPABUNT                                                 07430000
IOPNTLVL EQU   IOPASMDR                                                 07431000
IOPALLOC EQU   @NM00079+4                                               07432000
IOPUSED  EQU   @NM00079                                                 07433000
IOPTPSEQ EQU   @NM00078+8                                               07434000
IOPVLSER EQU   @NM00078+2                                               07435000
IOPBLKSI EQU   @NM00078                                                 07436000
IOPCQMAX EQU   IOPCQMAP+12                                              07437000
@NM00077 EQU   IOPCQMAP+11                                              07438000
@NM00076 EQU   IOPCQMAP+8                                               07439000
@NM00075 EQU   IOPCQMAP                                                 07440000
IOPPTMAX EQU   IOPCDMAX                                                 07441000
@NM00074 EQU   IOPSCMAP+11                                              07442000
@NM00073 EQU   IOPSCMAP+8                                               07443000
@NM00072 EQU   IOPSCMAP                                                 07444000
IOPDIRMX EQU   IOPNTMAX+12                                              07445000
@NM00071 EQU   IOPNTMAX+11                                              07446000
@NM00070 EQU   IOPNTMAX+8                                               07447000
@NM00069 EQU   IOPNTMAX                                                 07448000
@NM00068 EQU   IOPDTYPE                                                 07449000
IOPDMOD  EQU   IOPDTYPE                                                 07450000
IOPDJCL  EQU   IOPDTYPE                                                 07451000
IOPDSRC  EQU   IOPDTYPE                                                 07452000
IOPDMAC  EQU   IOPDTYPE                                                 07453000
IOPSDIR  EQU   IOPSPACE+4                                               07454000
IOPSSCND EQU   IOPSPACE+2                                               07455000
IOPSPRIM EQU   IOPSPACE                                                 07456000
IOPDSN   EQU   IOPDYNDT                                                 07457000
IOPNTYPE EQU   IOPSTCMP+17                                              07458000
IOPNNAME EQU   IOPSTCMP+9                                               07459000
IOPOTYPE EQU   IOPSTCMP+8                                               07460000
IOPONAME EQU   IOPSTCMP                                                 07461000
IOPISEQ3 EQU   IOPINAM3+6                                               07462000
IOPITYP3 EQU   @NM00067+5                                               07463000
IOPIPTF3 EQU   @NM00067                                                 07464000
TBLXEND0 EQU   TBLXPARM+124                                             07465000
@NM00007 EQU   TBLXPARM+108                                             07466000
TBLXD2GT EQU   TBLXPARM+100                                             07467000
TBLXDLGT EQU   TBLXPARM+96                                              07468000
@NM00006 EQU   TBLXRC+3                                                 07469000
TBLXIRC  EQU   TBLXRC+2                                                 07470000
TBLXLRC  EQU   TBLXRC+1                                                 07471000
TBLXTRC  EQU   TBLXRC                                                   07472000
TBLXIBGN EQU   TBLXPARM+88                                              07473000
TBLXTSLP EQU   TBLXPARM+84                                              07474000
@NM00005 EQU   TBLXPARM+83                                              07475000
@NM00004 EQU   TBLXPARM+82                                              07476000
@NM00003 EQU   TBLXPARM+81                                              07477000
@NM00002 EQU   TBLXFLG1                                                 07478000
TBLXTCRC EQU   TBLXFLG1                                                 07479000
TBLXFUND EQU   TBLXPARM+72                                              07480000
@NM00001 EQU   TBLXPARM+62                                              07481000
TBLXCRQI EQU   TBLXPARM+61                                              07482000
TBLXLMGT EQU   TBLXPARM+56                                              07483000
TBLXSCGT EQU   TBLXPARM+52                                              07484000
TBLXSREL EQU   TBLXPARM+48                                              07485000
TBLXASGT EQU   TBLXPARM+44                                              07486000
TBLXIFGT EQU   TBLXPARM+40                                              07487000
TBLXSEGT EQU   TBLXPARM+24                                              07488000
TBLXIOPF EQU   TBLXPARM+20                                              07489000
TBLXEND  EQU   TBLXINDX+8                                               07490000
TBLXSTRT EQU   TBLXINDX+4                                               07491000
TBLXCUR  EQU   TBLXINDX                                                 07492000
TBLXHDR  EQU   TBLXPARM                                                 07493000
SPLIFIL  EQU   SPLODSN+33                                               07494000
SPLISMD  EQU   SPLODSN+26                                               07495000
SPLIPFX  EQU   SPLODSN                                                  07496000
SPLIUNPK EQU   SPLPUNPK+8                                               07497000
SPLOUNPK EQU   SPLPUNPK                                                 07498000
SPLOPACK EQU   SPLPPACK+8                                               07499000
SPLIPACK EQU   SPLPPACK                                                 07500000
@NM00253 EQU   MCBEFLG5                                                 07501000
MCBEDEL  EQU   MCBEFLG5                                                 07502000
MCBESTD  EQU   MCBEFLG5                                                 07503000
@NM00252 EQU   MCBEFLG4                                                 07504000
@NM00251 EQU   MCBEFLG3                                                 07505000
@NM00250 EQU   MCBEFLG2                                                 07506000
MCBEPAGA EQU   MCBEFLG2                                                 07507000
MCBENE   EQU   MCBEFLG2                                                 07508000
@NM00249 EQU   MCBEFLG1                                                 07509000
MCBEDC   EQU   MCBEFLG1                                                 07510000
MCBEREFR EQU   MCBEFLG1                                                 07511000
MCBEOVLY EQU   MCBEFLG1                                                 07512000
MCBESCTR EQU   MCBEFLG1                                                 07513000
MCBEREUS EQU   MCBEFLG1                                                 07514000
MCBERENT EQU   MCBEFLG1                                                 07515000
MCBEAPF  EQU   MCBEFLG1                                                 07516000
MCBELLKD EQU   MCBELEMP+128                                             07517000
MCBEJLKD EQU   MCBELEMP+116                                             07518000
MCBELUPI EQU   MCBELEMP+115                                             07519000
MCBEJUPI EQU   MCBELEMP+103                                             07520000
MCBELCPY EQU   MCBELEMP+102                                             07521000
MCBEJCPY EQU   MCBELEMP+90                                              07522000
MCBELASM EQU   MCBELEMP+89                                              07523000
MCBEJASM EQU   MCBELEMP+77                                              07524000
MCBERLF  EQU   MCBELEMP+73                                              07525000
MCBESSI  EQU   MCBELEMP+65                                              07526000
MCBEDALS EQU   MCBELEMP+57                                              07527000
MCBEASLB EQU   MCBELEMP+49                                              07528000
MCBELKLB EQU   MCBELEMP+41                                              07529000
MCBETXLB EQU   MCBELEMP+33                                              07530000
MCBESYS  EQU   MCBELEMP+25                                              07531000
MCBEDOBJ EQU   MCBELEMP+17                                              07532000
MCBEDIST EQU   MCBELEMP+9                                               07533000
@NM00248 EQU   MCBELEMP                                                 07534000
MCBIFENV EQU   MCBIFMP+1                                                07535000
@NM00246 EQU   MCBIFMP                                                  07536000
MCBSFMID EQU   MCBVERMP+1                                               07537000
@NM00244 EQU   MCBVERMP                                                 07538000
MCBPTP   EQU   MCBPTFMP+10                                              07539000
MCBPRELN EQU   MCBPTFMP+8                                               07540000
MCBPNO   EQU   MCBPTFMP+1                                               07541000
ICTIXL   EQU   ICTIXLF                                                  07542000
@NM00243 EQU   ICTLMOD+38                                               07543000
ICTLTTR  EQU   ICTLMOD+31                                               07544000
ICTTG2   EQU   ICTLMOD+23                                               07545000
ICTTG1   EQU   ICTLMOD+15                                               07546000
@NM00242 EQU   ICTLFLG3                                                 07547000
ICTLZAP  EQU   ICTLFLG3                                                 07548000
ICTLLKD  EQU   ICTLFLG3                                                 07549000
ICTLCPY  EQU   ICTLFLG3                                                 07550000
ICTLXPND EQU   ICTLFLG3                                                 07551000
ICTTIND2 EQU   ICTLFLG3                                                 07552000
ICTTIND1 EQU   ICTLFLG3                                                 07553000
@NM00241 EQU   ICTLFLG2                                                 07554000
ICTLDEL  EQU   ICTLFLG2                                                 07555000
@NM00240 EQU   ICTLFLG2                                                 07556000
ICTLTDEL EQU   ICTLFLG2                                                 07557000
ICTLINK  EQU   ICTLFLG2                                                 07558000
ICTCOPY  EQU   ICTLFLG2                                                 07559000
@NM00239 EQU   ICTLFLG7                                                 07560000
@NM00238 EQU   ICTLFLG6                                                 07561000
@NM00237 EQU   ICTLFLG5                                                 07562000
ICTLPAGA EQU   ICTLFLG5                                                 07563000
ICTLNE   EQU   ICTLFLG5                                                 07564000
@NM00236 EQU   ICTLFLG1                                                 07565000
ICTLDC   EQU   ICTLFLG1                                                 07566000
ICTLREFR EQU   ICTLFLG1                                                 07567000
ICTLOVLY EQU   ICTLFLG1                                                 07568000
ICTLSCTR EQU   ICTLFLG1                                                 07569000
ICTLREUS EQU   ICTLFLG1                                                 07570000
ICTLRENT EQU   ICTLFLG1                                                 07571000
ICTLAPF  EQU   ICTLFLG1                                                 07572000
@NM00235 EQU   ICTLFLG4                                                 07573000
ICTLPASS EQU   ICTLFLG4                                                 07574000
ICTLDDCK EQU   ICTLFLG4                                                 07575000
ICTLMSG  EQU   ICTLFLG4                                                 07576000
ICTLCPL  EQU   ICTLFLG4                                                 07577000
ICTLNOGO EQU   ICTLFLG4                                                 07578000
ICTLPROC EQU   ICTLFLG4                                                 07579000
ICTLEND  EQU   ICTLNAME                                                 07580000
@NM00234 EQU   ICTMUMNT+7                                               07581000
ICTMUMND EQU   ICTMUMNM                                                 07582000
@NM00233 EQU   ICTMVRNT+7                                               07583000
ICTMVRND EQU   ICTMVRNM                                                 07584000
ICTTALND EQU   ICTTALNM                                                 07585000
ICTMIDTY EQU   ICTMODST                                                 07586000
ICTMIDAM EQU   ICTMODST                                                 07587000
ICTMIDRG EQU   ICTMODST                                                 07588000
ICTMIDF1 EQU   ICTMODST                                                 07589000
@NM00232 EQU   ICTMODST                                                 07590000
ICTIXM   EQU   ICTIXMF                                                  07591000
@NM00231 EQU   ICTMOD+128                                               07592000
ICTMICHA EQU   ICTMOD+108                                               07593000
@NM00230 EQU   ICTMOD+95                                                07594000
@NM00229 EQU   ICTMOD+87                                                07595000
ICTMSSI  EQU   ICTMOD+72                                                07596000
ICTMDOBJ EQU   ICTMOD+64                                                07597000
ICTMASLB EQU   ICTMOD+40                                                07598000
ICTMRELN EQU   ICTMOD+22                                                07599000
@NM00228 EQU   ICTMOD+21                                                07600000
ICTMLANG EQU   ICTMOD+20                                                07601000
@NM00227 EQU   ICTMOD+19                                                07602000
ICTMACF5 EQU   ICTMOD+18                                                07603000
ICTMZMPR EQU   ICTMACF4                                                 07604000
ICTMZOMZ EQU   ICTMACF4                                                 07605000
ICTMDOAS EQU   ICTMACF4                                                 07606000
ICTMXUPD EQU   ICTMACF4                                                 07607000
ICTMFXC  EQU   ICTMACF4                                                 07608000
ICTMFXBS EQU   ICTMACF4                                                 07609000
ICTMHASM EQU   ICTMACF4                                                 07610000
ICTMACDL EQU   ICTMACF4                                                 07611000
@NM00226 EQU   ICTMLEP4                                                 07612000
@NM00225 EQU   ICTMLEP3                                                 07613000
@NM00224 EQU   ICTMLEP2                                                 07614000
ICTMPAGA EQU   ICTMLEP2                                                 07615000
ICTMNE   EQU   ICTMLEP2                                                 07616000
@NM00223 EQU   ICTMLEP1                                                 07617000
ICTMDC   EQU   ICTMLEP1                                                 07618000
ICTMREFR EQU   ICTMLEP1                                                 07619000
ICTMOVLY EQU   ICTMLEP1                                                 07620000
ICTMSCTR EQU   ICTMLEP1                                                 07621000
ICTMREUS EQU   ICTMLEP1                                                 07622000
ICTMRENT EQU   ICTMLEP1                                                 07623000
ICTMAPF  EQU   ICTMLEP1                                                 07624000
@NM00222 EQU   ICTMFLG5                                                 07625000
ICTMNORL EQU   ICTMFLG5                                                 07626000
ICTMELCK EQU   ICTMFLG5                                                 07627000
ICTMCOPY EQU   ICTMFLG5                                                 07628000
@NM00221 EQU   ICTMFLG4                                                 07629000
ICTMMIDE EQU   ICTMFLG4                                                 07630000
@NM00220 EQU   ICTMFLG3                                                 07631000
ICTMPRMS EQU   ICTMFLG3                                                 07632000
ICTMALIS EQU   ICTMFLG3                                                 07633000
ICTMTRX  EQU   ICTMFLG3                                                 07634000
@NM00219 EQU   ICTMFLG2                                                 07635000
@NM00218 EQU   ICTMFLG2                                                 07636000
ICTMMIDU EQU   ICTMFLG2                                                 07637000
ICTMDEL  EQU   ICTMFLG2                                                 07638000
ICTMMSG  EQU   ICTMFLG2                                                 07639000
ICTMCPL  EQU   ICTMFLG2                                                 07640000
ICTMPROC EQU   ICTMFLG2                                                 07641000
@NM00217 EQU   ICTSBYNT+7                                               07642000
ICTSBYND EQU   ICTSBYNM                                                 07643000
ICTDELEX EQU   ICTDELST                                                 07644000
ICTDELND EQU   ICTDELNM                                                 07645000
@NM00216 EQU   ICTVRSNT+7                                               07646000
ICTVRSND EQU   ICTVRSNM                                                 07647000
@NM00215 EQU   ICTNPRNT+7                                               07648000
ICTNPRND EQU   ICTNPRNM                                                 07649000
@NM00214 EQU   ICTCSRST                                                 07650000
@NM00213 EQU   ICTCSRST                                                 07651000
ICTCSRF  EQU   ICTCSRST                                                 07652000
@NM00212 EQU   ICTCSRST                                                 07653000
ICTCSRNM EQU   ICTIRQNT+8                                               07654000
@NM00211 EQU   ICTIRQST                                                 07655000
ICTIREQT EQU   ICTIRQST                                                 07656000
ICTIREQI EQU   ICTIRQST                                                 07657000
ICTIREQB EQU   ICTIRQST                                                 07658000
ICTIREQS EQU   ICTIRQST                                                 07659000
@NM00210 EQU   ICTIRQST                                                 07660000
ICTIRQND EQU   ICTIRQNM                                                 07661000
@NM00209 EQU   ICTPREST                                                 07662000
ICTPREQT EQU   ICTPREST                                                 07663000
ICTPREQI EQU   ICTPREST                                                 07664000
ICTPREQB EQU   ICTPREST                                                 07665000
ICTPREQS EQU   ICTPREST                                                 07666000
@NM00208 EQU   ICTPREST                                                 07667000
@NM00207 EQU   ICTSUPNT+7                                               07668000
@NM00206 EQU   ICTREQST                                                 07669000
ICTRREQT EQU   ICTREQST                                                 07670000
ICTRREQI EQU   ICTREQST                                                 07671000
ICTRREQB EQU   ICTREQST                                                 07672000
ICTRREQS EQU   ICTREQST                                                 07673000
@NM00205 EQU   ICTREQST                                                 07674000
ICTREQND EQU   ICTREQNM                                                 07675000
@NM00204 EQU   ICTENTST                                                 07676000
ICTEREQT EQU   ICTENTST                                                 07677000
ICTEREQI EQU   ICTENTST                                                 07678000
ICTEREQB EQU   ICTENTST                                                 07679000
ICTEREQS EQU   ICTENTST                                                 07680000
@NM00203 EQU   ICTENTST                                                 07681000
ICTENTND EQU   ICTENTNM                                                 07682000
@NM00202 EQU   ICTPTF+100                                               07683000
ICTPTPFX EQU   ICTPTF+38                                                07684000
ICTPRELN EQU   ICTPTF+36                                                07685000
ICTPRECT EQU   ICTPTF+33                                                07686000
ICTPRECD EQU   ICTPTF+30                                                07687000
ICTPVERN EQU   ICTPTF+29                                                07688000
ICTPUSR8 EQU   ICTPFLGA                                                 07689000
ICTPUSR7 EQU   ICTPFLGA                                                 07690000
ICTPUSR6 EQU   ICTPFLGA                                                 07691000
ICTPUSR5 EQU   ICTPFLGA                                                 07692000
ICTPUSR4 EQU   ICTPFLGA                                                 07693000
ICTPUSR3 EQU   ICTPFLGA                                                 07694000
ICTPUSR2 EQU   ICTPFLGA                                                 07695000
ICTPPASS EQU   ICTPUSR1                                                 07696000
@NM00201 EQU   @NM00200                                                 07697000
ICTPRQBY EQU   @NM00200                                                 07698000
ICTPRQOK EQU   @NM00200                                                 07699000
ICTPRQCK EQU   @NM00200                                                 07700000
@NM00199 EQU   ICTPFLG9                                                 07701000
ICTPPDEL EQU   ICTPFLG9                                                 07702000
@NM00198 EQU   ICTPFLG8                                                 07703000
ICTPDCPL EQU   ICTPFLG8                                                 07704000
ICTPECPL EQU   ICTPFLG8                                                 07705000
ICTPGCPL EQU   ICTPFLG8                                                 07706000
@NM00197 EQU   ICTPFLG4                                                 07707000
@NM00196 EQU   ICTPFLG4                                                 07708000
@NM00195 EQU   ICTPFLG4                                                 07709000
ICTPREDO EQU   ICTPFLG4                                                 07710000
ICTPCDSE EQU   ICTPFLG4                                                 07711000
@NM00194 EQU   ICTPFLG2                                                 07712000
ICTPRCND EQU   ICTPFLG2                                                 07713000
ICTPTPS  EQU   ICTPFLG2                                                 07714000
ICTPTR1  EQU   ICTPFLG2                                                 07715000
ICTPVRSP EQU   ICTPFLG2                                                 07716000
@NM00193 EQU   ICTPFLG6                                                 07717000
ICTFLF   EQU   ICTPFLF                                                  07718000
ICTPDBYP EQU   ICTPFLG6                                                 07719000
ICTPSBYP EQU   ICTPFLG6                                                 07720000
ICTPMDLP EQU   ICTPFLG5+1                                               07721000
ICTPADDP EQU   ICTPFLG5+1                                               07722000
@NM00192 EQU   ICTPFLG5+1                                               07723000
ICTPLRFP EQU   ICTPFLG5                                                 07724000
ICTPJCLP EQU   ICTPFLG5                                                 07725000
ICTPSUPP EQU   ICTPFLG5                                                 07726000
ICTPREQP EQU   ICTPFLG5                                                 07727000
ICTPPREP EQU   ICTPFLG5                                                 07728000
ICTPNPRP EQU   ICTPFLG5                                                 07729000
ICTPIRQP EQU   ICTPFLG5                                                 07730000
ICTPDELP EQU   ICTPFLG5                                                 07731000
@NM00191 EQU   ICTPFLG3                                                 07732000
ICTPSLST EQU   ICTPFLG3                                                 07733000
ICTPNOLB EQU   ICTPFLG3                                                 07734000
ICTPVERJ EQU   ICTPFLG3                                                 07735000
ICTPROCS EQU   ICTPPROC                                                 07736000
ICTREGEN EQU   ICTPFLG1                                                 07737000
ICTBYP   EQU   ICTPFLG1                                                 07738000
ICTDUMMP EQU   ICTPFLG1                                                 07739000
@NM00190 EQU   ICTPFLG1                                                 07740000
ICTERROR EQU   ICTPFLG1                                                 07741000
ICTACC   EQU   ICTPFLG1                                                 07742000
ICTRES   EQU   ICTPFLG1                                                 07743000
ICTAPP   EQU   ICTPFLG1                                                 07744000
ICTLEN   EQU   ICTGMSPL+1                                               07745000
ICTSP    EQU   ICTGMSPL                                                 07746000
ICTLLEN  EQU   ICTLSPLN+1                                               07747000
ICTLSP   EQU   ICTLSPLN                                                 07748000
ICTMLEN  EQU   ICTMSPLN+1                                               07749000
ICTMSP   EQU   ICTMSPLN                                                 07750000
ICTPLEN  EQU   ICTPSPLN+1                                               07751000
ICTPSP   EQU   ICTPSPLN                                                 07752000
PRLCONC  EQU   PRLTIME+2                                                07753000
@NM00189 EQU   PRLTIME                                                  07754000
PRLHDADR EQU   PRLDATE                                                  07755000
@NM00188 EQU   PRLFLGS                                                  07756000
PRLHEADO EQU   PRLFLGS                                                  07757000
PRLHEAD  EQU   PRLFLGS                                                  07758000
PRLRLEN  EQU   HMASMPRL                                                 07759000
IOPBS04E EQU   IOPBS04+2                                                07760000
IOPBAPFC EQU   IOPBAPF+1                                                07761000
IOPBAPFL EQU   IOPBAPF                                                  07762000
IOPBS2NM EQU   IOPBS02+3                                                07763000
IOPBS2EP EQU   IOPBS02                                                  07764000
IOPQSMTP EQU   IOPQSMLS+8                                               07765000
@NM00173 EQU   IOPQSMLS+7                                               07766000
IOPQSMND EQU   IOPQSMNM                                                 07767000
@NM00172 EQU   @NM00171+7                                               07768000
IOPQSMFM EQU   @NM00171                                                 07769000
@NM00091 EQU   IOPLMCTL+17                                              07770000
IOPLMCRD EQU   IOPLMCTL+9                                               07771000
IOPLMCRN EQU   IOPLMCTL+1                                               07772000
IOPLMCC  EQU   IOPLMCTL                                                 07773000
@NM00066 EQU   IOPUSERL                                                 07774000
@NM00065 EQU   IOPUSERL                                                 07775000
IOPALIS  EQU   IOPUSERL                                                 07776000
IOPTTR   EQU   IOPDRMAP+8                                               07777000
IOPINAM2 EQU   IOPINAM+1                                                07778000
IOPITYP2 EQU   IOPITYP                                                  07779000
@NM00064 EQU   HMASMIOP+32                                              07780000
IOPDELDD EQU   IOPDDNAM                                                 07781000
@NM00063 EQU   @NM00060+10                                              07782000
IOPSEQNO EQU   @NM00060+8                                               07783000
@NM00062 EQU   @NM00061+7                                               07784000
IOPPTFNM EQU   @NM00061                                                 07785000
CCABMREC EQU   CCABELMT+10                                              07786000
CCABPOS  EQU   CCABMPOS+8                                               07787000
CCABNAME EQU   CCABMPOS                                                 07788000
@NM00056 EQU   CCABLDLM+2                                               07789000
@NM00055 EQU   CCABLDLM                                                 07790000
CCAUPDPM EQU   @NM00053+24                                              07791000
@NM00054 EQU   @NM00053+21                                              07792000
CCARUPDT EQU   CCAUPDRC                                                 07793000
CCAUPDSP EQU   @NM00053+12                                              07794000
CCAUPDTE EQU   @NM00053+8                                               07795000
CCAUPDNM EQU   @NM00053                                                 07796000
CCASUPPM EQU   @NM00051+24                                              07797000
@NM00052 EQU   @NM00051+21                                              07798000
CCARSUP  EQU   CCASUPRC                                                 07799000
CCASUPSP EQU   @NM00051+12                                              07800000
CCAIOSUP EQU   @NM00051+8                                               07801000
CCASUPNM EQU   @NM00051                                                 07802000
CCAZAPPM EQU   @NM00049+24                                              07803000
@NM00050 EQU   @NM00049+21                                              07804000
CCARZAP  EQU   CCAZAPRC                                                 07805000
CCAZAPSP EQU   @NM00049+12                                              07806000
CCASPZAP EQU   @NM00049+8                                               07807000
CCAZAPNM EQU   @NM00049                                                 07808000
CCACOMPM EQU   @NM00047+24                                              07809000
@NM00048 EQU   @NM00047+21                                              07810000
CCARCOMP EQU   CCACOMRC                                                 07811000
CCACOMSP EQU   @NM00047+12                                              07812000
CCACOMRS EQU   @NM00047+8                                               07813000
CCACOMNM EQU   @NM00047                                                 07814000
CCACPYPM EQU   @NM00045+24                                              07815000
@NM00046 EQU   @NM00045+21                                              07816000
CCARCOPY EQU   CCACPYRC                                                 07817000
CCACPYSP EQU   @NM00045+12                                              07818000
CCACOPY  EQU   @NM00045+8                                               07819000
CCACPYNM EQU   @NM00045                                                 07820000
CCAASMPM EQU   @NM00043+24                                              07821000
@NM00044 EQU   @NM00043+21                                              07822000
CCARASM  EQU   CCAASMRC                                                 07823000
CCAASMSP EQU   @NM00043+12                                              07824000
CCAASM   EQU   @NM00043+8                                               07825000
CCAASMNM EQU   @NM00043                                                 07826000
CCALKDPM EQU   @NM00041+24                                              07827000
@NM00042 EQU   @NM00041+21                                              07828000
CCARLINK EQU   CCALKDRC                                                 07829000
CCALKDSP EQU   @NM00041+12                                              07830000
CCALKED  EQU   @NM00041+8                                               07831000
CCALKDNM EQU   @NM00041                                                 07832000
CCAPGMPM EQU   @NM00039+24                                              07833000
@NM00040 EQU   @NM00039+21                                              07834000
CCABPGRC EQU   @NM00039+20                                              07835000
CCABPGSP EQU   @NM00039+12                                              07836000
CCABPGAD EQU   @NM00039+8                                               07837000
CCABPGNM EQU   @NM00039                                                 07838000
CCAEND   EQU   HMASMCCA+371                                             07839000
@NM00038 EQU   HMASMCCA+309                                             07840000
CCACURDD EQU   CCAFDSNG+3                                               07841000
CCACURDS EQU   CCAFDSNG+2                                               07842000
@NM00037 EQU   CCAFLAGB                                                 07843000
CCAOUTNG EQU   CCAFLAGB                                                 07844000
CCALOGNG EQU   CCAFLAGB                                                 07845000
CCAFMID  EQU   HMASMCCA+291                                             07846000
CCALSTDS EQU   CCAFCTL+8                                                07847000
CCARPTDS EQU   CCAFCTL+7                                                07848000
CCATIME  EQU   CCAFCTL+4                                                07849000
CCADATE  EQU   CCAFCTL+1                                                07850000
@NM00036 EQU   CCAFLAG9                                                 07851000
CCARVCAN EQU   CCAFLAG9                                                 07852000
CCARVEST EQU   CCAFLAG9                                                 07853000
CCAPTSNJ EQU   CCAFLAG9                                                 07854000
CCASTSNP EQU   CCAFLAG9                                                 07855000
CCAMTSNP EQU   CCAFLAG9                                                 07856000
CCAPTSNP EQU   CCAFLAG9                                                 07857000
@NM00035 EQU   CCAFLAG8                                                 07858000
CCAACDSC EQU   CCAFLAG8                                                 07859000
CCACDSC  EQU   CCAFLAG8                                                 07860000
@NM00034 EQU   CCAFLAG6                                                 07861000
CCAACRUP EQU   CCAFLAG6                                                 07862000
CCACRQUP EQU   CCAFLAG6                                                 07863000
CCAACDUP EQU   CCAFLAG6                                                 07864000
CCACDSUP EQU   CCAFLAG6                                                 07865000
@NM00033 EQU   CCAFLAG5                                                 07866000
CCAACROS EQU   CCAFLAG5                                                 07867000
CCACRQOS EQU   CCAFLAG5                                                 07868000
CCAACDOS EQU   CCAFLAG5                                                 07869000
CCACDSOS EQU   CCAFLAG5                                                 07870000
@NM00032 EQU   CCAFLAG4                                                 07871000
CCAACRIS EQU   CCAFLAG4                                                 07872000
CCACRQIS EQU   CCAFLAG4                                                 07873000
CCAACDIS EQU   CCAFLAG4                                                 07874000
CCACDSIS EQU   CCAFLAG4                                                 07875000
@NM00031 EQU   CCAFLAG3+1                                               07876000
CCARGNP  EQU   CCAFLAG3+1                                               07877000
CCADISRQ EQU   CCAFLAG3+1                                               07878000
CCAICTOK EQU   CCAFLAG3                                                 07879000
CCADELP  EQU   CCAFLAG3                                                 07880000
CCACMPRS EQU   CCAFLAG3                                                 07881000
CCAZAPP  EQU   CCAFLAG3                                                 07882000
CCALINKP EQU   CCAFLAG3                                                 07883000
CCACOPYP EQU   CCAFLAG3                                                 07884000
CCAASIP  EQU   CCAFLAG3                                                 07885000
CCAUPDP  EQU   CCAFLAG3                                                 07886000
CCAEOSMP EQU   CCAFLAG2                                                 07887000
CCAEOFNC EQU   CCAFLAG2                                                 07888000
@NM00030 EQU   CCAFLAG2                                                 07889000
CCACHECK EQU   CCAFLAG2                                                 07890000
CCATERM  EQU   CCAFLAG2                                                 07891000
CCASVCLB EQU   CCAFLAG2                                                 07892000
CCANCPTF EQU   CCAFLAG2                                                 07893000
@NM00029 EQU   CCAFLAG1+1                                               07894000
CCAUNL   EQU   CCAFLAG1+1                                               07895000
CCARESET EQU   CCAFLAG1+1                                               07896000
CCALOG   EQU   CCAFLAG1+1                                               07897000
CCACNV   EQU   CCAFLAG1+1                                               07898000
CCALIST  EQU   CCAFLAG1                                                 07899000
CCAUPDU  EQU   CCAFLAG1                                                 07900000
CCAUPDJ  EQU   CCAFLAG1                                                 07901000
CCARES   EQU   CCAFLAG1                                                 07902000
CCAREJ   EQU   CCAFLAG1                                                 07903000
CCAAPPLY EQU   CCAFLAG1                                                 07904000
CCAREC   EQU   CCAFLAG1                                                 07905000
CCAFUNCT EQU   CCAFFUNC                                                 07906000
@NM00028 EQU   @NM00023+18                                              07907000
@NM00027 EQU   @NM00023+16                                              07908000
CCATBLPA EQU   @NM00023+12                                              07909000
@NM00026 EQU   @NM00023+8                                               07910000
@NM00025 EQU   @NM00023+4                                               07911000
@NM00024 EQU   @NM00023                                                 07912000
CCAIFGTP EQU   CCAFGTP+16                                               07913000
CCAGTP3  EQU   CCAFGTP+12                                               07914000
CCAGTP2  EQU   CCAFGTP+8                                                07915000
CCAGTP1  EQU   CCAFGTP+4                                                07916000
CCASETAD EQU   CCASEGTP                                                 07917000
CCACLST  EQU   CCAFPGM+12                                               07918000
CCASPDCB EQU   CCAFPGM+8                                                07919000
CCARVAD  EQU   CCAFSTA                                                  07920000
CCAACDID EQU   CCAFSYS+32                                               07921000
CCACDSID EQU   CCAFSYS+24                                               07922000
CCALNLEN EQU   CCAFSYS+22                                               07923000
@NM00022 EQU   CCAFLAGA                                                 07924000
CCAPSYSF EQU   CCAFLAGA                                                 07925000
CCAASYSF EQU   CCAFLAGA                                                 07926000
CCACSYSF EQU   CCAFLAGA                                                 07927000
CCANUCID EQU   CCAFSYS+20                                               07928000
CCAASREL EQU   CCAFSYS+16                                               07929000
CCACSREL EQU   CCASREL                                                  07930000
CCAPEMAX EQU   CCAFSYS+10                                               07931000
CCAPGLEN EQU   CCAFSYS+8                                                07932000
CCAIOPAS EQU   CCAFSYS+4                                                07933000
CCAIOPCS EQU   CCAFSYS                                                  07934000
CCAPESIZ EQU   CCAFIOP+4                                                07935000
@NM00021 EQU   CCAFLAG7+3                                               07936000
CCALOGP  EQU   CCAFLAG7+2                                               07937000
CCAOUTP  EQU   CCAFLAG7+2                                               07938000
CCASLBP  EQU   CCAFLAG7+2                                               07939000
CCARPTP  EQU   CCAFLAG7+2                                               07940000
CCALISTP EQU   CCAFLAG7+2                                               07941000
CCAJCLP  EQU   CCAFLAG7+2                                               07942000
CCAPTFP  EQU   CCAFLAG7+2                                               07943000
CCATLBP  EQU   CCAFLAG7+2                                               07944000
CCAUT3P  EQU   CCAFLAG7+1                                               07945000
CCAUT2P  EQU   CCAFLAG7+1                                               07946000
CCAUT1P  EQU   CCAFLAG7+1                                               07947000
CCAWK5P  EQU   CCAFLAG7+1                                               07948000
CCAWK4P  EQU   CCAFLAG7+1                                               07949000
CCAWK3P  EQU   CCAFLAG7+1                                               07950000
CCAWK2P  EQU   CCAFLAG7+1                                               07951000
CCAWK1P  EQU   CCAFLAG7+1                                               07952000
CCAACRQP EQU   CCAFLAG7                                                 07953000
CCACRQP  EQU   CCAFLAG7                                                 07954000
CCASTSP  EQU   CCAFLAG7                                                 07955000
CCAMTSP  EQU   CCAFLAG7                                                 07956000
CCAPTSP  EQU   CCAFLAG7                                                 07957000
CCASCDSP EQU   CCAFLAG7                                                 07958000
CCAACDSP EQU   CCAFLAG7                                                 07959000
CCACDSP  EQU   CCAFLAG7                                                 07960000
@NM00020 EQU   CCAFBUFR+122                                             07961000
@NM00019 EQU   CCAFBUFR+120                                             07962000
@NM00018 EQU   CCAFBUFR+118                                             07963000
CCATBFMX EQU   CCAFBUFR+116                                             07964000
CCA4BFMX EQU   CCAFBUFR+114                                             07965000
CCA3BFMX EQU   CCAFBUFR+112                                             07966000
CCA2BFMX EQU   CCAFBUFR+110                                             07967000
CCA1BFMX EQU   CCAFBUFR+108                                             07968000
CCAXBFMX EQU   CCAFBUFR+106                                             07969000
CCAQBFMX EQU   CCAFBUFR+104                                             07970000
CCASBFMX EQU   CCAFBUFR+102                                             07971000
CCAMBFMX EQU   CCAFBUFR+100                                             07972000
CCAPBFMX EQU   CCAFBUFR+98                                              07973000
CCAVBFMX EQU   CCAFBUFR+96                                              07974000
CCAABFMX EQU   CCAFBUFR+94                                              07975000
CCACBFMX EQU   CCAFBUFR+92                                              07976000
@NM00017 EQU   CCAFBUFR+88                                              07977000
@NM00016 EQU   CCAFBUFR+84                                              07978000
CCA4BFSZ EQU   CCAFBUFR+80                                              07979000
CCATBFSZ EQU   CCAFBUFR+76                                              07980000
CCAWBFSZ EQU   CCAFBUFR+72                                              07981000
CCAQBFSZ EQU   CCAFBUFR+68                                              07982000
CCAPBFSZ EQU   CCAFBUFR+64                                              07983000
CCAVBFSZ EQU   CCAFBUFR+60                                              07984000
CCACBFSZ EQU   CCAFBUFR+56                                              07985000
@NM00015 EQU   CCAFBUFR+52                                              07986000
CCA4BFOA EQU   CCAFBUFR+48                                              07987000
CCA4BFIA EQU   CCAFBUFR+44                                              07988000
CCATBFIA EQU   CCAFBUFR+40                                              07989000
CCAWBFOA EQU   CCAFBUFR+36                                              07990000
CCAWBFIA EQU   CCAFBUFR+32                                              07991000
CCAQBFOA EQU   CCAFBUFR+28                                              07992000
CCAQBFIA EQU   CCAFBUFR+24                                              07993000
CCAPBFOA EQU   CCAFBUFR+20                                              07994000
CCAPBFIA EQU   CCAFBUFR+16                                              07995000
CCAVBFOA EQU   CCAFBUFR+12                                              07996000
CCAVBFIA EQU   CCAFBUFR+8                                               07997000
CCACBFOA EQU   CCAFBUFR+4                                               07998000
CCACBFIA EQU   CCAFBUFR                                                 07999000
CCAID    EQU   HMASMCCA                                                 08000000
@NM00014 EQU   TBLFLG5                                                  08001000
TBLICTOK EQU   TBLFLG5                                                  08002000
@NM00013 EQU   TBLFLG4                                                  08003000
TBLBPFM  EQU   TBLFLG4                                                  08004000
@NM00012 EQU   TBLFLG4                                                  08005000
TBLBPIRQ EQU   TBLFLG4                                                  08006000
TBLBPREQ EQU   TBLFLG4                                                  08007000
TBLBPPRE EQU   TBLFLG4                                                  08008000
TBLBPID  EQU   TBLFLG4                                                  08009000
@NM00011 EQU   TBLFLG3+1                                                08010000
TBLSTS   EQU   TBLFLG3                                                  08011000
TBLMTS   EQU   TBLFLG3                                                  08012000
TBLPTS   EQU   TBLFLG3                                                  08013000
TBLACRQ  EQU   TBLFLG3                                                  08014000
TBLCRQ   EQU   TBLFLG3                                                  08015000
TBLSCDS  EQU   TBLFLG3                                                  08016000
TBLACDS  EQU   TBLFLG3                                                  08017000
TBLCDS   EQU   TBLFLG3                                                  08018000
TBLMASS  EQU   TBLFLG2                                                  08019000
@NM00010 EQU   TBLFLG2                                                  08020000
TBLFMID  EQU   TBLFLG2                                                  08021000
TBLGROUP EQU   TBLFLG2                                                  08022000
TBLEXC   EQU   TBLFLG2                                                  08023000
TBLSEL   EQU   TBLFLG2                                                  08024000
@NM00009 EQU   TBLFLG1+1                                                08025000
TBLDISW  EQU   TBLFLG1+1                                                08026000
TBLDISR  EQU   TBLFLG1+1                                                08027000
TBLDISN  EQU   TBLFLG1+1                                                08028000
TBLNOJCL EQU   TBLFLG1                                                  08029000
TBLFLUSH EQU   TBLFLG1                                                  08030000
TBLUSER  EQU   TBLFLG1                                                  08031000
TBLAPAR  EQU   TBLFLG1                                                  08032000
TBLCOMP  EQU   TBLFLG1                                                  08033000
TBLASSEM EQU   TBLFLG1                                                  08034000
TBLNOAPP EQU   TBLFLG1                                                  08035000
@NM00008 EQU   TBLXOPTS+5                                               08036000
TBLNUCID EQU   TBLXOPTS+4                                               08037000
TBLJCLGT EQU   TBLXOPTS                                                 08038000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08039000
@RF00404 EQU   @EL00002                                                 08040000
@RF00416 EQU   @EL00003                                                 08041000
@RC00421 EQU   @EL00003                                                 08042000
@RF00551 EQU   @EL00005                                                 08043000
@RC00582 EQU   @RC00578                                                 08044000
@RF00606 EQU   @EL00006                                                 08045000
@RC00700 EQU   @RC00698                                                 08046000
@RF00706 EQU   @EL00008                                                 08047000
@RC00708 EQU   @EL00008                                                 08048000
@RF00752 EQU   @EL00009                                                 08049000
@RF00755 EQU   @EL00009                                                 08050000
@RC00808 EQU   @EL00012                                                 08051000
@RF00841 EQU   @EL00014                                                 08052000
@RC00872 EQU   @EL00015                                                 08053000
@RF00945 EQU   @EL00017                                                 08054000
@RF01099 EQU   @EL00021                                                 08055000
@RC01097 EQU   @EL00021                                                 08056000
@RC01095 EQU   @EL00021                                                 08057000
@RC01093 EQU   @EL00021                                                 08058000
@RF01249 EQU   @EL00029                                                 08059000
@RF01301 EQU   @EL00030                                                 08060000
@RC01309 EQU   @EL00030                                                 08061000
@RC01307 EQU   @EL00030                                                 08062000
@RF00596 EQU   @RC00582                                                 08063000
@RC00711 EQU   @RC00708                                                 08064000
@RC00876 EQU   @RC00872                                                 08065000
@RF00721 EQU   @RC00711                                                 08066000
@ENDDATA EQU   *                                                        08067000
         END   HMASMTMD,(C'PLS2151',0802,78334)                         08068000
