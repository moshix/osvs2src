         TITLE 'HMASMTMS - ELEMENT SELECTION PROCEDURE'                 00001000
HMASMTMS CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMTMS  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @09,0                                               0001 00010000
@PSTART  LA    @10,4095(,@09)                                      0001 00011000
         LA    @12,4095(,@10)                                      0001 00012000
         USING @PSTART,@09                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
         USING @PSTART+8190,@12                                    0001 00015000
         ST    @13,@SA00001+4                                      0001 00016000
         LA    @14,@SA00001                                        0001 00017000
         ST    @14,8(,@13)                                         0001 00018000
         LR    @13,@14                                             0001 00019000
         MVC   @PC00001(8),0(@01)                                  0001 00020000
*   TMSFLGS=''B;                    /* CLEAR LOCAL PROCESSING FLAGS  */ 00021000
         MVI   TMSFLGS,X'00'                                       0227 00022000
*   HIGHTMS=ZERO;                   /* INITIALIZE RETURN CODE      0228 00023000
*                                      COLLECTOR                     */ 00024000
         SLR   HIGHTMS,HIGHTMS                                     0228 00025000
*   MSGSMDNM=ICTPTFS(1);            /* "CURRENT" SYSMOD-ID #         */ 00026000
         L     @08,@PC00001+4                                      0229 00027000
         L     @08,CPTF(,@08)                                      0229 00028000
         MVC   MSGSMDNM(7),ICTPTFS(@08)                            0229 00029000
*   IF CCAAPPLY=ON                  /* APPLY                         */ 00030000
*     THEN                                                         0230 00031000
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0230 00032000
         BNO   @RF00230                                            0230 00033000
*     MSGXCDS=MSGCDS;               /* SMPCDS DATASET FOR APPLY      */ 00034000
         MVC   MSGXCDS(8),@CC01845                                 0231 00035000
*   ELSE                                                           0232 00036000
*     MSGXCDS=MSGACDS;              /* SMPACDS DATASET FOR ACCEPT    */ 00037000
         B     @RC00230                                            0232 00038000
@RF00230 MVC   MSGXCDS(8),@CC01843                                 0232 00039000
*   IOPPTR=CCAIOPTR;                /* GENERAL-USE IOP FROM CCA      */ 00040000
@RC00230 L     IOPPTR,CCAIOPTR(,CCAPTR)                            0233 00041000
*   HMASMMGP=''B;                   /* CLEAR HMASMMSG PARM BLOCK     */ 00042000
         XC    HMASMMGP(32),HMASMMGP                               0234 00043000
*                                                                  0235 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* PROCESS SRC REPLACEMENT ELEMENTS FROM THE "CURRENT" SYSMOD    */ 00047000
*   /*                                                               */ 00048000
*   /*****************************************************************/ 00049000
*                                                                  0235 00050000
*   RESPECIFY                                                      0235 00051000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */ 00052000
*   RESPECIFY                                                      0236 00053000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN    00054000
*                                      PTR ARRAY FOR "CURRENT" PTF 0236 00055000
*                                      ENTRY                         */ 00056000
*                                                                  0236 00057000
*   /*****************************************************************/ 00058000
*   /*                                                               */ 00059000
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */ 00060000
*   /*                                                               */ 00061000
*   /*****************************************************************/ 00062000
*                                                                  0237 00063000
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0237 00064000
         LA    I,1                                                 0237 00065000
         B     @DE00237                                            0237 00066000
@DL00237 DS    0H                                                  0238 00067000
*     RESPECIFY                                                    0238 00068000
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"   00069000
*                                      SYSMOD                        */ 00070000
*     IF ICTMSRCR(1)=ON             /* SRC REPL ELEMENT              */ 00071000
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */ 00072000
*       THEN                                                       0239 00073000
         LR    @08,I                                               0239 00074000
         SLA   @08,2                                               0239 00075000
         L     @03,@PC00001+4                                      0239 00076000
         L     @03,CPTF(,@03)                                      0239 00077000
         L     @03,ICTPCHN(,@03)                                   0239 00078000
         AL    @03,@CF02030                                        0239 00079000
         L     @08,ICTIXPF(@08,@03)                                0239 00080000
         TM    ICTMSRCR(@08),B'00000010'                           0239 00081000
         BNO   @RF00239                                            0239 00082000
         TM    ICTMSELM(@08),B'00100000'                           0239 00083000
         BNZ   @RF00239                                            0239 00084000
*       DO;                                                        0240 00085000
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */ 00086000
*                                                                  0241 00087000
         XC    SELEXCL(2),SELEXCL                                  0241 00088000
*         /***********************************************************/ 00089000
*         /*                                                         */ 00090000
*         /* PROCESS SRC REPLACEMENT ELEMENT                         */ 00091000
*         /*                                                         */ 00092000
*         /***********************************************************/ 00093000
*                                                                  0242 00094000
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */ 00095000
         ST    @08,CMOD                                            0242 00096000
*         VPART#1=MSGSRC;           /* ELEMENT TYPE FOR ERRMSG       */ 00097000
         MVC   VPART#1(8),@CC01831                                 0243 00098000
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */ 00099000
         MVC   VPART#2(8),ICTMNAME(@08)                            0244 00100000
*         CALL REPELEM;             /* PROCESS REPLACEMENT ELEMENTS  */ 00101000
         BAL   @14,REPELEM                                         0245 00102000
*         IF ICTMISEL(1)=ON         /* ELEMENT SHOULD BE SELECTED  0246 00103000
*                                      WHEN COMPARED WITH TARGET SRC */ 00104000
*           THEN                                                   0246 00105000
         LR    @08,I                                               0246 00106000
         SLA   @08,2                                               0246 00107000
         L     @03,@PC00001+4                                      0246 00108000
         L     @03,CPTF(,@03)                                      0246 00109000
         L     @03,ICTPCHN(,@03)                                   0246 00110000
         AL    @03,@CF02030                                        0246 00111000
         L     @08,ICTIXPF(@08,@03)                                0246 00112000
         TM    ICTMISEL(@08),B'10000000'                           0246 00113000
         BNO   @RF00246                                            0246 00114000
*           CALL ASSEMCHK;          /* CHECK AND SELECT ASSOCIATED 0247 00115000
*                                      ASSEMBLY                      */ 00116000
         BAL   @14,ASSEMCHK                                        0247 00117000
*         IF ICTMISEL(1)=ON         /* STILL SHOULD BE SELECTED      */ 00118000
*           THEN                                                   0248 00119000
@RF00246 LR    @08,I                                               0248 00120000
         SLA   @08,2                                               0248 00121000
         L     @03,@PC00001+4                                      0248 00122000
         L     @03,CPTF(,@03)                                      0248 00123000
         L     @03,ICTPCHN(,@03)                                   0248 00124000
         AL    @03,@CF02030                                        0248 00125000
         L     @08,ICTIXPF(@08,@03)                                0248 00126000
         TM    ICTMISEL(@08),B'10000000'                           0248 00127000
         BNO   @RF00248                                            0248 00128000
*           DO;                                                    0249 00129000
*                                                                  0249 00130000
*             /*******************************************************/ 00131000
*             /*                                                     */ 00132000
*             /* SRC ELEMENT SELECTED ... CHECK WHETHER ASSOCIATED   */ 00133000
*             /* ++MOD SHOULD BE ELIMINATED FROM FURTHER             */ 00134000
*             /* CONSIDERATION                                       */ 00135000
*             /*                                                     */ 00136000
*             /*******************************************************/ 00137000
*                                                                  0250 00138000
*             IF(TBLBPID=ON         /* BYPASS ID IN EFFECT           */ 00139000
*                 |TBLASSEM=ON      /* ASSEM SPECIFIED               */ 00140000
*                 |ASMREQD=ON)      /* ASSEMBLY REQUIRED BY ID CHECK */ 00141000
*                 &ICTMASOC(1)=ON   /* THERE IS AN ASSOCIATED ++MOD  */ 00142000
*               THEN                                               0250 00143000
         L     @08,@PC00001                                        0250 00144000
         L     @08,TBLXTBL(,@08)                                   0250 00145000
         TM    TBLBPID(@08),B'10000000'                            0250 00146000
         BO    @GL00002                                            0250 00147000
         TM    TBLASSEM(@08),B'00100000'                           0250 00148000
         BO    @GL00002                                            0250 00149000
         TM    ASMREQD,B'00010000'                                 0250 00150000
         BNO   @RF00250                                            0250 00151000
@GL00002 LR    @08,I                                               0250 00152000
         SLA   @08,2                                               0250 00153000
         L     @03,@PC00001+4                                      0250 00154000
         L     @03,CPTF(,@03)                                      0250 00155000
         L     @03,ICTPCHN(,@03)                                   0250 00156000
         AL    @03,@CF02030                                        0250 00157000
         L     @08,ICTIXPF(@08,@03)                                0250 00158000
         TM    ICTMASOC(@08),B'00010000'                           0250 00159000
         BNO   @RF00250                                            0250 00160000
*               DO;                                                0251 00161000
*                 CALL ELIMMOD(ICTMNAME(1));/* ELIMINATE ASSOC ++MOD */ 00162000
         ST    @08,@AL00001                                        0252 00163000
         LA    @01,@AL00001                                        0252 00164000
         BAL   @14,ELIMMOD                                         0252 00165000
*                 ICTMASOC(1)=OFF;  /* SET ASSOCIATED ++MOD FLAG OFF */ 00166000
         LR    @08,I                                               0253 00167000
         SLA   @08,2                                               0253 00168000
         L     @03,@PC00001+4                                      0253 00169000
         L     @03,CPTF(,@03)                                      0253 00170000
         L     @03,ICTPCHN(,@03)                                   0253 00171000
         AL    @03,@CF02030                                        0253 00172000
         L     @08,ICTIXPF(@08,@03)                                0253 00173000
         NI    ICTMASOC(@08),B'11101111'                           0253 00174000
*               END;                                               0254 00175000
*           END;                                                   0255 00176000
@RF00250 DS    0H                                                  0256 00177000
*         IF ICTMISEL(1)=OFF        /* ELEMENT NOT SELECTED          */ 00178000
*             &ICTMMIDE(1)=OFF      /* NO ID CHECK ERROR             */ 00179000
*             &ICTMASOC(1)=ON       /* THERE IS ASSOCIATED ++MOD     */ 00180000
*           THEN                                                   0256 00181000
@RF00248 LR    @08,I                                               0256 00182000
         SLA   @08,2                                               0256 00183000
         L     @03,@PC00001+4                                      0256 00184000
         L     @03,CPTF(,@03)                                      0256 00185000
         L     @03,ICTPCHN(,@03)                                   0256 00186000
         AL    @03,@CF02030                                        0256 00187000
         L     @08,ICTIXPF(@08,@03)                                0256 00188000
         TM    ICTMASOC(@08),B'00010000'                           0256 00189000
         BNO   @RF00256                                            0256 00190000
         TM    ICTMISEL(@08),B'10001000'                           0256 00191000
         BNZ   @RF00256                                            0256 00192000
*           DO;                                                    0257 00193000
*                                                                  0257 00194000
*             /*******************************************************/ 00195000
*             /*                                                     */ 00196000
*             /* SRC ELEMENT EXCLUDED ... ELIMINATE ASSOC ++MOD      */ 00197000
*             /*                                                     */ 00198000
*             /*******************************************************/ 00199000
*                                                                  0258 00200000
*             CALL ELIMMOD(ICTMNAME(1));/* ELIMAINATE ASSOC ++MOD    */ 00201000
         ST    @08,@AL00001                                        0258 00202000
         LA    @01,@AL00001                                        0258 00203000
         BAL   @14,ELIMMOD                                         0258 00204000
*             ICTMASOC(1)=OFF;      /* SET ASSOCIATED ++MOD FLAG OFF */ 00205000
         LR    @08,I                                               0259 00206000
         SLA   @08,2                                               0259 00207000
         L     @03,@PC00001+4                                      0259 00208000
         L     @03,CPTF(,@03)                                      0259 00209000
         L     @03,ICTPCHN(,@03)                                   0259 00210000
         AL    @03,@CF02030                                        0259 00211000
         L     @08,ICTIXPF(@08,@03)                                0259 00212000
         NI    ICTMASOC(@08),B'11101111'                           0259 00213000
*           END;                                                   0260 00214000
*         IF ICTMISEL(1)=OFF        /* SRC ELEMENT NOT SELECTED      */ 00215000
*             &ICTMMIDE(1)=ON       /* DUE TO ID CHECK ERROR         */ 00216000
*           THEN                                                   0261 00217000
*                                                                  0261 00218000
@RF00256 LR    @08,I                                               0261 00219000
         SLA   @08,2                                               0261 00220000
         L     @03,@PC00001+4                                      0261 00221000
         L     @03,CPTF(,@03)                                      0261 00222000
         L     @03,ICTPCHN(,@03)                                   0261 00223000
         AL    @03,@CF02030                                        0261 00224000
         L     @08,ICTIXPF(@08,@03)                                0261 00225000
         TM    ICTMMIDE(@08),B'00001000'                           0261 00226000
         BNO   @RF00261                                            0261 00227000
         TM    ICTMISEL(@08),B'10000000'                           0261 00228000
         BNZ   @RF00261                                            0261 00229000
*           /*********************************************************/ 00230000
*           /*                                                       */ 00231000
*           /* SRC ELEMENT ID CHECK ERROR ... MAKE SURE ALL          */ 00232000
*           /* ASSEMBLIES ARE NOT SELECTED                           */ 00233000
*           /*                                                       */ 00234000
*           /*********************************************************/ 00235000
*                                                                  0262 00236000
*           CALL ASSEMSEL(ICTMOD(1),/* "CURRENT" ELEMENT             */ 00237000
*               RESET);             /* CLEAR ICTMISEL IN ASSEM     0262 00238000
*                                      ENTRIES                       */ 00239000
         ST    @08,@AL00001                                        0262 00240000
         LA    @08,@CC01748                                        0262 00241000
         ST    @08,@AL00001+4                                      0262 00242000
         LA    @01,@AL00001                                        0262 00243000
         BAL   @14,ASSEMSEL                                        0262 00244000
*       END;                        /* END SRC REPL ELEMENT          */ 00245000
@RF00261 DS    0H                                                  0264 00246000
*   END;                            /* END ICTIXP LOOP               */ 00247000
@RF00239 AH    I,@CH00067                                          0264 00248000
@DE00237 LR    @08,I                                               0264 00249000
         SLA   @08,2                                               0264 00250000
         L     @03,@PC00001+4                                      0264 00251000
         L     @03,CPTF(,@03)                                      0264 00252000
         L     @03,ICTPCHN(,@03)                                   0264 00253000
         AL    @03,@CF02030                                        0264 00254000
         L     @08,ICTIXP(@08,@03)                                 0264 00255000
         CL    @08,ICTENDIX                                        0264 00256000
         BNE   @DL00237                                            0264 00257000
*                                                                  0265 00258000
*   /*****************************************************************/ 00259000
*   /*                                                               */ 00260000
*   /* PROCESS SRC UPDATE ELEMENTS FROM THE "CURRENT" SYSMOD         */ 00261000
*   /*                                                               */ 00262000
*   /*****************************************************************/ 00263000
*                                                                  0265 00264000
*   RESPECIFY                                                      0265 00265000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */ 00266000
*   RESPECIFY                                                      0266 00267000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN    00268000
*                                      PTR ARRAY FOR "CURRENT" PTF 0266 00269000
*                                      ENTRY                         */ 00270000
*                                                                  0266 00271000
*   /*****************************************************************/ 00272000
*   /*                                                               */ 00273000
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */ 00274000
*   /*                                                               */ 00275000
*   /*****************************************************************/ 00276000
*                                                                  0267 00277000
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0267 00278000
         LA    I,1                                                 0267 00279000
         B     @DE00267                                            0267 00280000
@DL00267 DS    0H                                                  0268 00281000
*     RESPECIFY                                                    0268 00282000
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"   00283000
*                                      SYSMOD                        */ 00284000
*     IF ICTMSRCU(1)=ON             /* SRC UPDATE ELEMENT            */ 00285000
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */ 00286000
*       THEN                                                       0269 00287000
         LR    @08,I                                               0269 00288000
         SLA   @08,2                                               0269 00289000
         L     @03,@PC00001+4                                      0269 00290000
         L     @03,CPTF(,@03)                                      0269 00291000
         L     @03,ICTPCHN(,@03)                                   0269 00292000
         AL    @03,@CF02030                                        0269 00293000
         L     @08,ICTIXPF(@08,@03)                                0269 00294000
         TM    ICTMSRCU(@08),B'00000001'                           0269 00295000
         BNO   @RF00269                                            0269 00296000
         TM    ICTMSELM(@08),B'00100000'                           0269 00297000
         BNZ   @RF00269                                            0269 00298000
*       DO;                                                        0270 00299000
*                                                                  0270 00300000
*         /***********************************************************/ 00301000
*         /*                                                         */ 00302000
*         /* PROCESS SRC UPDATE ELEMENT                              */ 00303000
*         /*                                                         */ 00304000
*         /***********************************************************/ 00305000
*                                                                  0271 00306000
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */ 00307000
         XC    SELEXCL(2),SELEXCL                                  0271 00308000
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */ 00309000
         ST    @08,CMOD                                            0272 00310000
*         VPART#1=MSGSRCU;          /* ELEMENT TYPE FOR ERRMSG       */ 00311000
         MVC   VPART#1(8),@CC01833                                 0273 00312000
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */ 00313000
         MVC   VPART#2(8),ICTMNAME(@08)                            0274 00314000
*         CALL UPDELEM;             /* PROCESS UPDATE ELEMENTS       */ 00315000
         BAL   @14,UPDELEM                                         0275 00316000
*         IF ICTMISEL(1)=ON         /* ELEMENT SHOULD BE SELECTED  0276 00317000
*                                      WHEN COMPARED WITH TARGET SRC */ 00318000
*           THEN                                                   0276 00319000
         LR    @08,I                                               0276 00320000
         SLA   @08,2                                               0276 00321000
         L     @03,@PC00001+4                                      0276 00322000
         L     @03,CPTF(,@03)                                      0276 00323000
         L     @03,ICTPCHN(,@03)                                   0276 00324000
         AL    @03,@CF02030                                        0276 00325000
         L     @08,ICTIXPF(@08,@03)                                0276 00326000
         TM    ICTMISEL(@08),B'10000000'                           0276 00327000
         BNO   @RF00276                                            0276 00328000
*           CALL ASSEMCHK;          /* CHECK AND SELECT ASSOCIATED 0277 00329000
*                                      ASSEMBLIES                    */ 00330000
         BAL   @14,ASSEMCHK                                        0277 00331000
*         IF ICTMISEL(1)=ON         /* STILL SELECTED                */ 00332000
*           THEN                                                   0278 00333000
@RF00276 LR    @08,I                                               0278 00334000
         SLA   @08,2                                               0278 00335000
         L     @03,@PC00001+4                                      0278 00336000
         L     @03,CPTF(,@03)                                      0278 00337000
         L     @03,ICTPCHN(,@03)                                   0278 00338000
         AL    @03,@CF02030                                        0278 00339000
         L     @08,ICTIXPF(@08,@03)                                0278 00340000
         TM    ICTMISEL(@08),B'10000000'                           0278 00341000
         BNO   @RF00278                                            0278 00342000
*           DO;                                                    0279 00343000
*                                                                  0279 00344000
*             /*******************************************************/ 00345000
*             /*                                                     */ 00346000
*             /* SRCUPD ELEMENT SELECTED ... SEE IF ASSOC. ++MOD     */ 00347000
*             /* SHOULD BE ELIMINATED                                */ 00348000
*             /*                                                     */ 00349000
*             /*******************************************************/ 00350000
*                                                                  0280 00351000
*             IF(UMIDERR=ON         /* ALL UPDATES NOT PRE/SUP       */ 00352000
*                 |ASMREQD=ON       /* ... OR ASSM REQD. BY ID CHECK */ 00353000
*                 |TBLBPID=ON       /* ... OR BYPASS ID IN EFFECT    */ 00354000
*                 |TBLASSEM=ON)     /* ... OR ASSEM SPECIFIED        */ 00355000
*                 &ICTMASOC(1)=ON   /* THERE IS ASSOCIATED ++MOD     */ 00356000
*               THEN                                               0280 00357000
         TM    UMIDERR,B'01010000'                                 0280 00358000
         BNZ   @GL00006                                            0280 00359000
         L     @08,@PC00001                                        0280 00360000
         L     @08,TBLXTBL(,@08)                                   0280 00361000
         TM    TBLBPID(@08),B'10000000'                            0280 00362000
         BO    @GL00006                                            0280 00363000
         TM    TBLASSEM(@08),B'00100000'                           0280 00364000
         BNO   @RF00280                                            0280 00365000
@GL00006 LR    @08,I                                               0280 00366000
         SLA   @08,2                                               0280 00367000
         L     @03,@PC00001+4                                      0280 00368000
         L     @03,CPTF(,@03)                                      0280 00369000
         L     @03,ICTPCHN(,@03)                                   0280 00370000
         AL    @03,@CF02030                                        0280 00371000
         L     @08,ICTIXPF(@08,@03)                                0280 00372000
         TM    ICTMASOC(@08),B'00010000'                           0280 00373000
         BNO   @RF00280                                            0280 00374000
*               DO;                                                0281 00375000
*                 CALL ELIMMOD(ICTMNAME(1));/* ELIMINATE ASSOC ++MOD */ 00376000
         ST    @08,@AL00001                                        0282 00377000
         LA    @01,@AL00001                                        0282 00378000
         BAL   @14,ELIMMOD                                         0282 00379000
*                 ICTMASOC(1)=OFF;  /* SET ASSOCIATED ++MOD FLAG OFF */ 00380000
         LR    @08,I                                               0283 00381000
         SLA   @08,2                                               0283 00382000
         L     @03,@PC00001+4                                      0283 00383000
         L     @03,CPTF(,@03)                                      0283 00384000
         L     @03,ICTPCHN(,@03)                                   0283 00385000
         AL    @03,@CF02030                                        0283 00386000
         L     @08,ICTIXPF(@08,@03)                                0283 00387000
         NI    ICTMASOC(@08),B'11101111'                           0283 00388000
*               END;                                               0284 00389000
*           END;                    /* END SELECTED SRC UPDATE ELEM. */ 00390000
@RF00280 DS    0H                                                  0286 00391000
*       END;                        /* END SRC UPDATE ELEMENT        */ 00392000
@RF00278 DS    0H                                                  0287 00393000
*   END;                            /* END ICTIXP LOOP               */ 00394000
@RF00269 AH    I,@CH00067                                          0287 00395000
@DE00267 LR    @08,I                                               0287 00396000
         SLA   @08,2                                               0287 00397000
         L     @03,@PC00001+4                                      0287 00398000
         L     @03,CPTF(,@03)                                      0287 00399000
         L     @03,ICTPCHN(,@03)                                   0287 00400000
         AL    @03,@CF02030                                        0287 00401000
         L     @08,ICTIXP(@08,@03)                                 0287 00402000
         CL    @08,ICTENDIX                                        0287 00403000
         BNE   @DL00267                                            0287 00404000
*                                                                  0288 00405000
*   /*****************************************************************/ 00406000
*   /*                                                               */ 00407000
*   /* PROCESS MACRO REPLACEMENT ELEMENTS FROM "CURRENT" SYSMOD      */ 00408000
*   /*                                                               */ 00409000
*   /*****************************************************************/ 00410000
*                                                                  0288 00411000
*   RESPECIFY                                                      0288 00412000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */ 00413000
*   RESPECIFY                                                      0289 00414000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN    00415000
*                                      PTR ARRAY FOR "CURRENT" PTF 0289 00416000
*                                      ENTRY                         */ 00417000
*                                                                  0289 00418000
*   /*****************************************************************/ 00419000
*   /*                                                               */ 00420000
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */ 00421000
*   /*                                                               */ 00422000
*   /*****************************************************************/ 00423000
*                                                                  0290 00424000
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0290 00425000
         LA    I,1                                                 0290 00426000
         B     @DE00290                                            0290 00427000
@DL00290 DS    0H                                                  0291 00428000
*     RESPECIFY                                                    0291 00429000
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"   00430000
*                                      SYSMOD                        */ 00431000
*     IF ICTMMACR(1)=ON             /* MAC REPLACEMENT ELEMENT       */ 00432000
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */ 00433000
*       THEN                                                       0292 00434000
         LR    @08,I                                               0292 00435000
         SLA   @08,2                                               0292 00436000
         L     @03,@PC00001+4                                      0292 00437000
         L     @03,CPTF(,@03)                                      0292 00438000
         L     @03,ICTPCHN(,@03)                                   0292 00439000
         AL    @03,@CF02030                                        0292 00440000
         L     @08,ICTIXPF(@08,@03)                                0292 00441000
         TM    ICTMMACR(@08),B'00001000'                           0292 00442000
         BNO   @RF00292                                            0292 00443000
         TM    ICTMSELM(@08),B'00100000'                           0292 00444000
         BNZ   @RF00292                                            0292 00445000
*       DO;                                                        0293 00446000
*                                                                  0293 00447000
*         /***********************************************************/ 00448000
*         /*                                                         */ 00449000
*         /* PROCESS MACRO REPLACEMENT ELEMENT                       */ 00450000
*         /*                                                         */ 00451000
*         /***********************************************************/ 00452000
*                                                                  0294 00453000
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */ 00454000
         XC    SELEXCL(2),SELEXCL                                  0294 00455000
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */ 00456000
         ST    @08,CMOD                                            0295 00457000
*         VPART#1=MSGMAC;           /* ELEMENT TYPE FOR ERRMSG       */ 00458000
         MVC   VPART#1(8),@CC01827                                 0296 00459000
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */ 00460000
         MVC   VPART#2(8),ICTMNAME(@08)                            0297 00461000
*         CALL REPELEM;             /* PROCESS REPLACEMENT ELEMENTS  */ 00462000
         BAL   @14,REPELEM                                         0298 00463000
*         IF ICTMISEL(1)=ON         /* SELECTED                      */ 00464000
*           THEN                                                   0299 00465000
         LR    @08,I                                               0299 00466000
         SLA   @08,2                                               0299 00467000
         L     @03,@PC00001+4                                      0299 00468000
         L     @03,CPTF(,@03)                                      0299 00469000
         L     @03,ICTPCHN(,@03)                                   0299 00470000
         AL    @03,@CF02030                                        0299 00471000
         L     @08,ICTIXPF(@08,@03)                                0299 00472000
         TM    ICTMISEL(@08),B'10000000'                           0299 00473000
         BNO   @RF00299                                            0299 00474000
*           DO;                                                    0300 00475000
*                                                                  0300 00476000
*             /*******************************************************/ 00477000
*             /*                                                     */ 00478000
*             /* SELECTED MACRO ELEMENT                              */ 00479000
*             /*                                                     */ 00480000
*             /*******************************************************/ 00481000
*                                                                  0301 00482000
*             CALL ASSEMCHK;        /* CHECK AND SELECT ANY ASSEMBLY    00483000
*                                      ENTRIES CREATED FOR THIS MACRO*/ 00484000
         BAL   @14,ASSEMCHK                                        0301 00485000
*             IF ICTMISEL(1)=ON     /* STILL SELECTED                */ 00486000
*               THEN                                               0302 00487000
         LR    @08,I                                               0302 00488000
         SLA   @08,2                                               0302 00489000
         L     @03,@PC00001+4                                      0302 00490000
         L     @03,CPTF(,@03)                                      0302 00491000
         L     @03,ICTPCHN(,@03)                                   0302 00492000
         AL    @03,@CF02030                                        0302 00493000
         L     @08,ICTIXPF(@08,@03)                                0302 00494000
         TM    ICTMISEL(@08),B'10000000'                           0302 00495000
         BNO   @RF00302                                            0302 00496000
*               DO;                                                0303 00497000
*                                                                  0303 00498000
*                 /***************************************************/ 00499000
*                 /*                                                 */ 00500000
*                 /* MACRO SELECTED ... ELIMINATE ANY ++MOD ICT      */ 00501000
*                 /* ENTRIES FROM THE "CURRENT" SYSMOD FOR THE       */ 00502000
*                 /* SELECTED ASSEMBLIES                             */ 00503000
*                 /*                                                 */ 00504000
*                 /***************************************************/ 00505000
*                                                                  0304 00506000
*                 RESPECIFY                                        0304 00507000
*                   ICTASMLS BASED(ICTMACHN(1));/* ADDRESS LIST OF 0304 00508000
*                                      ASSEM ADDRESSES               */ 00509000
*                                                                  0304 00510000
*                 /***************************************************/ 00511000
*                 /*                                                 */ 00512000
*                 /* GO THRU ALL REQUIRED ASSEMBLIES                 */ 00513000
*                 /*                                                 */ 00514000
*                 /***************************************************/ 00515000
*                                                                  0305 00516000
*                 DO J=1 BY 1 WHILE ICTASMND(J)^=ICTENDIX;         0305 00517000
         LA    J,1                                                 0305 00518000
         B     @DE00305                                            0305 00519000
@DL00305 DS    0H                                                  0306 00520000
*                   IF ICTASMAD(J)->ICTMISEL(1)=ON/* SELECTED ASSEM  */ 00521000
*                     THEN                                         0306 00522000
*                                                                  0306 00523000
         LR    @08,J                                               0306 00524000
         SLA   @08,2                                               0306 00525000
         LR    @15,I                                               0306 00526000
         SLA   @15,2                                               0306 00527000
         L     @14,@PC00001+4                                      0306 00528000
         L     @01,CPTF(,@14)                                      0306 00529000
         L     @01,ICTPCHN(,@01)                                   0306 00530000
         AL    @01,@CF02030                                        0306 00531000
         L     @01,ICTIXPF(@15,@01)                                0306 00532000
         MVC   @TF00001(4),ICTMACHN(@01)                           0306 00533000
         L     @01,@TF00001                                        0306 00534000
         AL    @01,@CF02030                                        0306 00535000
         L     @08,ICTASMAD(@08,@01)                               0306 00536000
         TM    ICTMISEL(@08),B'10000000'                           0306 00537000
         BNO   @RF00306                                            0306 00538000
*                     /***********************************************/ 00539000
*                     /*                                             */ 00540000
*                     /* ELIMINATE ANY ++MOD WITH THE SAME NAME      */ 00541000
*                     /*                                             */ 00542000
*                     /***********************************************/ 00543000
*                                                                  0307 00544000
*                     CALL ELIMMOD(ICTASMAD(J)->ICTMNAME(1));      0307 00545000
         ST    @08,@AL00001                                        0307 00546000
         LA    @01,@AL00001                                        0307 00547000
         BAL   @14,ELIMMOD                                         0307 00548000
*                 END;                                             0308 00549000
@RF00306 AH    J,@CH00067                                          0308 00550000
@DE00305 LR    @08,J                                               0308 00551000
         SLA   @08,2                                               0308 00552000
         LR    @15,I                                               0308 00553000
         SLA   @15,2                                               0308 00554000
         L     @14,@PC00001+4                                      0308 00555000
         L     @01,CPTF(,@14)                                      0308 00556000
         L     @01,ICTPCHN(,@01)                                   0308 00557000
         AL    @01,@CF02030                                        0308 00558000
         L     @01,ICTIXPF(@15,@01)                                0308 00559000
         MVC   @TF00001(4),ICTMACHN(@01)                           0308 00560000
         L     @01,@TF00001                                        0308 00561000
         AL    @01,@CF02030                                        0308 00562000
         L     @08,ICTASMND(@08,@01)                               0308 00563000
         CL    @08,ICTENDIX                                        0308 00564000
         BNE   @DL00305                                            0308 00565000
*               END;                                               0309 00566000
*             IF ICTMISEL(1)=OFF    /* MACRO NOT SELECTED            */ 00567000
*                 &ICTMMIDE(1)=ON   /* DUE TO ID CHECK ERROR         */ 00568000
*               THEN                                               0310 00569000
*                                                                  0310 00570000
@RF00302 LR    @08,I                                               0310 00571000
         SLA   @08,2                                               0310 00572000
         L     @03,@PC00001+4                                      0310 00573000
         L     @03,CPTF(,@03)                                      0310 00574000
         L     @03,ICTPCHN(,@03)                                   0310 00575000
         AL    @03,@CF02030                                        0310 00576000
         L     @08,ICTIXPF(@08,@03)                                0310 00577000
         TM    ICTMMIDE(@08),B'00001000'                           0310 00578000
         BNO   @RF00310                                            0310 00579000
         TM    ICTMISEL(@08),B'10000000'                           0310 00580000
         BNZ   @RF00310                                            0310 00581000
*               /*****************************************************/ 00582000
*               /*                                                   */ 00583000
*               /* MACRO NOT SELECTED DUE TO ID CHECK ERROR ... MAKE */ 00584000
*               /* SURE ALL ASSEMBLIES ARE NOT SELECTED              */ 00585000
*               /*                                                   */ 00586000
*               /*****************************************************/ 00587000
*                                                                  0311 00588000
*               CALL ASSEMSEL(ICTMOD(1),/* "CURRENT" ELEMENT         */ 00589000
*                   RESET);         /* CLEAR ICTMISEL IN ASSEM     0311 00590000
*                                      ENTRIES                       */ 00591000
         ST    @08,@AL00001                                        0311 00592000
         LA    @08,@CC01748                                        0311 00593000
         ST    @08,@AL00001+4                                      0311 00594000
         LA    @01,@AL00001                                        0311 00595000
         BAL   @14,ASSEMSEL                                        0311 00596000
*           END;                                                   0312 00597000
@RF00310 DS    0H                                                  0313 00598000
*       END;                        /* END MACRO REPLACEMENT ELEM.   */ 00599000
@RF00299 DS    0H                                                  0314 00600000
*   END;                            /* END ICTIXP LOOP               */ 00601000
@RF00292 AH    I,@CH00067                                          0314 00602000
@DE00290 LR    @08,I                                               0314 00603000
         SLA   @08,2                                               0314 00604000
         L     @03,@PC00001+4                                      0314 00605000
         L     @03,CPTF(,@03)                                      0314 00606000
         L     @03,ICTPCHN(,@03)                                   0314 00607000
         AL    @03,@CF02030                                        0314 00608000
         L     @08,ICTIXP(@08,@03)                                 0314 00609000
         CL    @08,ICTENDIX                                        0314 00610000
         BNE   @DL00290                                            0314 00611000
*                                                                  0315 00612000
*   /*****************************************************************/ 00613000
*   /*                                                               */ 00614000
*   /* PROCESS MACUPD UPDATE ELEMENTS FROM "CURRENT" SYSMOD          */ 00615000
*   /*                                                               */ 00616000
*   /*****************************************************************/ 00617000
*                                                                  0315 00618000
*   RESPECIFY                                                      0315 00619000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */ 00620000
*   RESPECIFY                                                      0316 00621000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN    00622000
*                                      PTR ARRAY FOR "CURRENT" PTF 0316 00623000
*                                      ENTRY                         */ 00624000
*                                                                  0316 00625000
*   /*****************************************************************/ 00626000
*   /*                                                               */ 00627000
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */ 00628000
*   /*                                                               */ 00629000
*   /*****************************************************************/ 00630000
*                                                                  0317 00631000
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0317 00632000
         LA    I,1                                                 0317 00633000
         B     @DE00317                                            0317 00634000
@DL00317 DS    0H                                                  0318 00635000
*     RESPECIFY                                                    0318 00636000
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"   00637000
*                                      SYSMOD                        */ 00638000
*     IF ICTMMACU(1)=ON             /* MAC UPDATE ELEMENT            */ 00639000
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */ 00640000
*       THEN                                                       0319 00641000
         LR    @08,I                                               0319 00642000
         SLA   @08,2                                               0319 00643000
         L     @03,@PC00001+4                                      0319 00644000
         L     @03,CPTF(,@03)                                      0319 00645000
         L     @03,ICTPCHN(,@03)                                   0319 00646000
         AL    @03,@CF02030                                        0319 00647000
         L     @08,ICTIXPF(@08,@03)                                0319 00648000
         TM    ICTMMACU(@08),B'00000100'                           0319 00649000
         BNO   @RF00319                                            0319 00650000
         TM    ICTMSELM(@08),B'00100000'                           0319 00651000
         BNZ   @RF00319                                            0319 00652000
*       DO;                                                        0320 00653000
*                                                                  0320 00654000
*         /***********************************************************/ 00655000
*         /*                                                         */ 00656000
*         /* PROCESS MACRO UPDATE ELEMENT                            */ 00657000
*         /*                                                         */ 00658000
*         /***********************************************************/ 00659000
*                                                                  0321 00660000
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */ 00661000
         XC    SELEXCL(2),SELEXCL                                  0321 00662000
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */ 00663000
         ST    @08,CMOD                                            0322 00664000
*         VPART#1=MSGMACU;          /* ELEMENT TYPE FOR ERRMSG       */ 00665000
         MVC   VPART#1(8),@CC01829                                 0323 00666000
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */ 00667000
         MVC   VPART#2(8),ICTMNAME(@08)                            0324 00668000
*         CALL UPDELEM;             /* PROCESS UPDATE ELEMENTS       */ 00669000
         BAL   @14,UPDELEM                                         0325 00670000
*         IF ICTMISEL(1)=ON         /* SELECTED                      */ 00671000
*           THEN                                                   0326 00672000
         LR    @08,I                                               0326 00673000
         SLA   @08,2                                               0326 00674000
         L     @03,@PC00001+4                                      0326 00675000
         L     @03,CPTF(,@03)                                      0326 00676000
         L     @03,ICTPCHN(,@03)                                   0326 00677000
         AL    @03,@CF02030                                        0326 00678000
         L     @08,ICTIXPF(@08,@03)                                0326 00679000
         TM    ICTMISEL(@08),B'10000000'                           0326 00680000
         BNO   @RF00326                                            0326 00681000
*           CALL ASSEMCHK;          /* CHECK AND SELECT ASSEMBLY   0327 00682000
*                                      ENTRIES FOR SELECTED MACRO  0327 00683000
*                                      UPDATE                        */ 00684000
         BAL   @14,ASSEMCHK                                        0327 00685000
*         IF ICTMISEL(1)=ON         /* STILL SELECTED                */ 00686000
*           THEN                                                   0328 00687000
@RF00326 LR    @08,I                                               0328 00688000
         SLA   @08,2                                               0328 00689000
         L     @03,@PC00001+4                                      0328 00690000
         L     @03,CPTF(,@03)                                      0328 00691000
         L     @03,ICTPCHN(,@03)                                   0328 00692000
         AL    @03,@CF02030                                        0328 00693000
         L     @08,ICTIXPF(@08,@03)                                0328 00694000
         TM    ICTMISEL(@08),B'10000000'                           0328 00695000
         BNO   @RF00328                                            0328 00696000
*           DO;                                                    0329 00697000
*                                                                  0329 00698000
*             /*******************************************************/ 00699000
*             /*                                                     */ 00700000
*             /* MACRO ELEMENT SELECTED ... ELIMINATE ANY ++MOD ICT  */ 00701000
*             /* ENTRIES FROM THE "CURRENT" SYSMOD FOR THE SELECTED  */ 00702000
*             /* ASSEMBLIES                                          */ 00703000
*             /*                                                     */ 00704000
*             /*******************************************************/ 00705000
*                                                                  0330 00706000
*             RESPECIFY                                            0330 00707000
*               ICTASMLS BASED(ICTMACHN(1));/* ADDRESS LIST OF ASSEM    00708000
*                                      ADDRESSES                     */ 00709000
*                                                                  0330 00710000
*             /*******************************************************/ 00711000
*             /*                                                     */ 00712000
*             /* GO THRU ALL REQUIRED ASSEMBLIES                     */ 00713000
*             /*                                                     */ 00714000
*             /*******************************************************/ 00715000
*                                                                  0331 00716000
*             DO J=1 BY 1 WHILE ICTASMND(J)^=ICTENDIX;             0331 00717000
         LA    J,1                                                 0331 00718000
         B     @DE00331                                            0331 00719000
@DL00331 DS    0H                                                  0332 00720000
*               IF ICTASMAD(J)->ICTMISEL(1)=ON/* SELECTED ASSEM      */ 00721000
*                 THEN                                             0332 00722000
         LR    @08,J                                               0332 00723000
         SLA   @08,2                                               0332 00724000
         LR    @15,I                                               0332 00725000
         SLA   @15,2                                               0332 00726000
         L     @14,@PC00001+4                                      0332 00727000
         L     @01,CPTF(,@14)                                      0332 00728000
         L     @01,ICTPCHN(,@01)                                   0332 00729000
         AL    @01,@CF02030                                        0332 00730000
         L     @01,ICTIXPF(@15,@01)                                0332 00731000
         MVC   @TF00001(4),ICTMACHN(@01)                           0332 00732000
         L     @01,@TF00001                                        0332 00733000
         AL    @01,@CF02030                                        0332 00734000
         L     @08,ICTASMAD(@08,@01)                               0332 00735000
         TM    ICTMISEL(@08),B'10000000'                           0332 00736000
         BNO   @RF00332                                            0332 00737000
*                 CALL ELIMMOD(ICTASMAD(J)->ICTMNAME(1));/* ELIMINATE   00738000
*                                      ANY ASSOC. ++MOD ENTRY        */ 00739000
         ST    @08,@AL00001                                        0333 00740000
         LA    @01,@AL00001                                        0333 00741000
         BAL   @14,ELIMMOD                                         0333 00742000
*             END;                                                 0334 00743000
@RF00332 AH    J,@CH00067                                          0334 00744000
@DE00331 LR    @08,J                                               0334 00745000
         SLA   @08,2                                               0334 00746000
         LR    @15,I                                               0334 00747000
         SLA   @15,2                                               0334 00748000
         L     @14,@PC00001+4                                      0334 00749000
         L     @01,CPTF(,@14)                                      0334 00750000
         L     @01,ICTPCHN(,@01)                                   0334 00751000
         AL    @01,@CF02030                                        0334 00752000
         L     @01,ICTIXPF(@15,@01)                                0334 00753000
         MVC   @TF00001(4),ICTMACHN(@01)                           0334 00754000
         L     @01,@TF00001                                        0334 00755000
         AL    @01,@CF02030                                        0334 00756000
         L     @08,ICTASMND(@08,@01)                               0334 00757000
         CL    @08,ICTENDIX                                        0334 00758000
         BNE   @DL00331                                            0334 00759000
*           END;                                                   0335 00760000
*         IF ICTMISEL(1)=OFF        /* MACRO UPDATE NOT SELECTED     */ 00761000
*             &ICTMMIDE(1)=ON       /* DUE TO ID CHECK ERROR         */ 00762000
*           THEN                                                   0336 00763000
@RF00328 LR    @08,I                                               0336 00764000
         SLA   @08,2                                               0336 00765000
         L     @03,@PC00001+4                                      0336 00766000
         L     @03,CPTF(,@03)                                      0336 00767000
         L     @03,ICTPCHN(,@03)                                   0336 00768000
         AL    @03,@CF02030                                        0336 00769000
         L     @08,ICTIXPF(@08,@03)                                0336 00770000
         TM    ICTMMIDE(@08),B'00001000'                           0336 00771000
         BNO   @RF00336                                            0336 00772000
         TM    ICTMISEL(@08),B'10000000'                           0336 00773000
         BNZ   @RF00336                                            0336 00774000
*           CALL ASSEMSEL(ICTMOD(1),/* "CURRENT" ELEMENT             */ 00775000
*               RESET);             /* CLEAR ICTMISEL IN ASSEM     0337 00776000
*                                      ENTIRES                       */ 00777000
         ST    @08,@AL00001                                        0337 00778000
         LA    @08,@CC01748                                        0337 00779000
         ST    @08,@AL00001+4                                      0337 00780000
         LA    @01,@AL00001                                        0337 00781000
         BAL   @14,ASSEMSEL                                        0337 00782000
*       END;                        /* END MACUPD UPDATE ELEM.       */ 00783000
@RF00336 DS    0H                                                  0339 00784000
*   END;                            /* END ICTIXP LOOP               */ 00785000
@RF00319 AH    I,@CH00067                                          0339 00786000
@DE00317 LR    @08,I                                               0339 00787000
         SLA   @08,2                                               0339 00788000
         L     @03,@PC00001+4                                      0339 00789000
         L     @03,CPTF(,@03)                                      0339 00790000
         L     @03,ICTPCHN(,@03)                                   0339 00791000
         AL    @03,@CF02030                                        0339 00792000
         L     @08,ICTIXP(@08,@03)                                 0339 00793000
         CL    @08,ICTENDIX                                        0339 00794000
         BNE   @DL00317                                            0339 00795000
*                                                                  0340 00796000
*   /*****************************************************************/ 00797000
*   /*                                                               */ 00798000
*   /* PROCESS MOD REPLACEMENT ELEMENTS FROM "CURRENT" SYSMOD        */ 00799000
*   /*                                                               */ 00800000
*   /*****************************************************************/ 00801000
*                                                                  0340 00802000
*   RESPECIFY                                                      0340 00803000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */ 00804000
*   RESPECIFY                                                      0341 00805000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN    00806000
*                                      PTR ARRAY FOR "CURRENT" PTF 0341 00807000
*                                      ENTRY                         */ 00808000
*                                                                  0341 00809000
*   /*****************************************************************/ 00810000
*   /*                                                               */ 00811000
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */ 00812000
*   /*                                                               */ 00813000
*   /*****************************************************************/ 00814000
*                                                                  0342 00815000
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0342 00816000
         LA    I,1                                                 0342 00817000
         B     @DE00342                                            0342 00818000
@DL00342 DS    0H                                                  0343 00819000
*     RESPECIFY                                                    0343 00820000
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"   00821000
*                                      SYSMOD                        */ 00822000
*     IF(ICTMMOD(1)=ON              /* MOD REPLACEMENT ELEMENT       */ 00823000
*         &ICTMASM(1)=OFF)          /* ... NOT ASSEM ENTRY           */ 00824000
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */ 00825000
*       THEN                                                       0344 00826000
         LR    @08,I                                               0344 00827000
         SLA   @08,2                                               0344 00828000
         L     @03,@PC00001+4                                      0344 00829000
         L     @03,CPTF(,@03)                                      0344 00830000
         L     @03,ICTPCHN(,@03)                                   0344 00831000
         AL    @03,@CF02030                                        0344 00832000
         L     @08,ICTIXPF(@08,@03)                                0344 00833000
         TM    ICTMMOD(@08),B'10000000'                            0344 00834000
         BNO   @RF00344                                            0344 00835000
         TM    ICTMASM(@08),B'01000000'                            0344 00836000
         BNZ   @RF00344                                            0344 00837000
         TM    ICTMSELM(@08),B'00100000'                           0344 00838000
         BNZ   @RF00344                                            0344 00839000
*       DO;                                                        0345 00840000
*                                                                  0345 00841000
*         /***********************************************************/ 00842000
*         /*                                                         */ 00843000
*         /* PROCESS MOD REPLACEMENT ELEMENT                         */ 00844000
*         /*                                                         */ 00845000
*         /***********************************************************/ 00846000
*                                                                  0346 00847000
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */ 00848000
         XC    SELEXCL(2),SELEXCL                                  0346 00849000
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */ 00850000
         ST    @08,CMOD                                            0347 00851000
*         VPART#1=MSGMOD;           /* ELEMENT TYPE FOR ERRMSG       */ 00852000
         MVC   VPART#1(8),@CC01823                                 0348 00853000
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */ 00854000
         MVC   VPART#2(8),ICTMNAME(@08)                            0349 00855000
*         CALL REPELEM;             /* PROCESS REPLACEMENT ELEMENTS  */ 00856000
         BAL   @14,REPELEM                                         0350 00857000
*       END;                        /* END MOD/MAC REPLACEMENT ELEM. */ 00858000
*   END;                            /* END ICTIXP LOOP               */ 00859000
@RF00344 AH    I,@CH00067                                          0352 00860000
@DE00342 LR    @08,I                                               0352 00861000
         SLA   @08,2                                               0352 00862000
         L     @03,@PC00001+4                                      0352 00863000
         L     @03,CPTF(,@03)                                      0352 00864000
         L     @03,ICTPCHN(,@03)                                   0352 00865000
         AL    @03,@CF02030                                        0352 00866000
         L     @08,ICTIXP(@08,@03)                                 0352 00867000
         CL    @08,ICTENDIX                                        0352 00868000
         BNE   @DL00342                                            0352 00869000
*                                                                  0353 00870000
*   /*****************************************************************/ 00871000
*   /*                                                               */ 00872000
*   /* PROCESS ZAP UPDATE ELEMENTS FROM "CURRENT" SYSMOD             */ 00873000
*   /*                                                               */ 00874000
*   /*****************************************************************/ 00875000
*                                                                  0353 00876000
*   RESPECIFY                                                      0353 00877000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */ 00878000
*   RESPECIFY                                                      0354 00879000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN    00880000
*                                      PTR ARRAY FOR "CURRENT" PTF 0354 00881000
*                                      ENTRY                         */ 00882000
*                                                                  0354 00883000
*   /*****************************************************************/ 00884000
*   /*                                                               */ 00885000
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */ 00886000
*   /*                                                               */ 00887000
*   /*****************************************************************/ 00888000
*                                                                  0355 00889000
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0355 00890000
         LA    I,1                                                 0355 00891000
         B     @DE00355                                            0355 00892000
@DL00355 DS    0H                                                  0356 00893000
*     RESPECIFY                                                    0356 00894000
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"   00895000
*                                      SYSMOD                        */ 00896000
*     IF ICTMZAP(1)=ON              /* MOD UPDATE ELEMENT            */ 00897000
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */ 00898000
*       THEN                                                       0357 00899000
         LR    @08,I                                               0357 00900000
         SLA   @08,2                                               0357 00901000
         L     @03,@PC00001+4                                      0357 00902000
         L     @03,CPTF(,@03)                                      0357 00903000
         L     @03,ICTPCHN(,@03)                                   0357 00904000
         AL    @03,@CF02030                                        0357 00905000
         L     @08,ICTIXPF(@08,@03)                                0357 00906000
         TM    ICTMZAP(@08),B'00100000'                            0357 00907000
         BNO   @RF00357                                            0357 00908000
         TM    ICTMSELM(@08),B'00100000'                           0357 00909000
         BNZ   @RF00357                                            0357 00910000
*       DO;                                                        0358 00911000
*                                                                  0358 00912000
*         /***********************************************************/ 00913000
*         /*                                                         */ 00914000
*         /* PROCESS ZAP ELEMENT                                     */ 00915000
*         /*                                                         */ 00916000
*         /***********************************************************/ 00917000
*                                                                  0359 00918000
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */ 00919000
         XC    SELEXCL(2),SELEXCL                                  0359 00920000
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */ 00921000
         ST    @08,CMOD                                            0360 00922000
*         VPART#1=MSGZAP;           /* ELEMENT TYPE FOR ERRMSG       */ 00923000
         MVC   VPART#1(8),@CC01825                                 0361 00924000
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */ 00925000
         MVC   VPART#2(8),ICTMNAME(@08)                            0362 00926000
*         CALL ZAPCHK;              /* CHECK FOR ANOTHER ZAP TO THE     00927000
*                                      SAME ELEMENT                  */ 00928000
         BAL   @14,ZAPCHK                                          0363 00929000
*         IF MULTIZAP=OFF           /* NO OTHER SELECTED ZAP         */ 00930000
*           THEN                                                   0364 00931000
         TM    MULTIZAP,B'00000010'                                0364 00932000
         BNZ   @RF00364                                            0364 00933000
*           CALL UPDELEM;           /* PROCESS UPDATE ELEMENTS       */ 00934000
         BAL   @14,UPDELEM                                         0365 00935000
*         IF ICTMISEL(1)=ON         /* ZAP SELECTED                  */ 00936000
*           THEN                                                   0366 00937000
@RF00364 LR    @08,I                                               0366 00938000
         SLA   @08,2                                               0366 00939000
         L     @03,@PC00001+4                                      0366 00940000
         L     @03,CPTF(,@03)                                      0366 00941000
         L     @03,ICTPCHN(,@03)                                   0366 00942000
         AL    @03,@CF02030                                        0366 00943000
         L     @08,ICTIXPF(@08,@03)                                0366 00944000
         TM    ICTMISEL(@08),B'10000000'                           0366 00945000
         BNO   @RF00366                                            0366 00946000
*           CALL XPNDSEL;           /* SELECT ANY ASSOC EXPANDS      */ 00947000
         BAL   @14,XPNDSEL                                         0367 00948000
*       END;                        /* END ZAP ELEMENT               */ 00949000
@RF00366 DS    0H                                                  0369 00950000
*   END;                            /* END ICTIXP LOOP               */ 00951000
@RF00357 AH    I,@CH00067                                          0369 00952000
@DE00355 LR    @08,I                                               0369 00953000
         SLA   @08,2                                               0369 00954000
         L     @03,@PC00001+4                                      0369 00955000
         L     @03,CPTF(,@03)                                      0369 00956000
         L     @03,ICTPCHN(,@03)                                   0369 00957000
         AL    @03,@CF02030                                        0369 00958000
         L     @08,ICTIXP(@08,@03)                                 0369 00959000
         CL    @08,ICTENDIX                                        0369 00960000
         BNE   @DL00355                                            0369 00961000
*                                                                  0370 00962000
*   /*****************************************************************/ 00963000
*   /*                                                               */ 00964000
*   /* ELEMENT SELECTION PROCESSING COMPLETE FOR "CURRENT" SYSMOD    */ 00965000
*   /*                                                               */ 00966000
*   /*****************************************************************/ 00967000
*                                                                  0370 00968000
*   IF HIGHTMS>=STOPPTF THEN                                       0370 00969000
         CH    HIGHTMS,@CH00059                                    0370 00970000
         BL    @RF00370                                            0370 00971000
*     DO;                                                          0371 00972000
*                                                                  0371 00973000
*       /*************************************************************/ 00974000
*       /*                                                           */ 00975000
*       /* "CURRENT" SYSMOD TERMINATED ... CLEANUP ICT MOD SECTION   */ 00976000
*       /*                                                           */ 00977000
*       /*************************************************************/ 00978000
*                                                                  0372 00979000
*       RESPECIFY                                                  0372 00980000
*         ICTPTF BASED(CPTF);       /* ADDRESS "CURRENT" SYSMOD      */ 00981000
*                                                                  0372 00982000
*       /*************************************************************/ 00983000
*       /*                                                           */ 00984000
*       /* GO THRU ALL ELEMENTS IN THE CURRENT SYSMOD                */ 00985000
*       /*                                                           */ 00986000
*       /*************************************************************/ 00987000
*                                                                  0373 00988000
*       DO J=1 BY 1 WHILE ICTIXP(J)^=ICTENDIX;                     0373 00989000
         LA    J,1                                                 0373 00990000
         B     @DE00373                                            0373 00991000
@DL00373 DS    0H                                                  0374 00992000
*         RESPECIFY                                                0374 00993000
*           ICTMOD BASED(ICTIXP(J));/* ADDRESS MOD SECTION ENTRIES 0374 00994000
*                                      ASSOCIATED WITH THE "CURRENT"    00995000
*                                      SYSMOD                        */ 00996000
*         ICTMISEL(1)=OFF;          /* TURN OFF SELECT FLAG          */ 00997000
         LR    @08,J                                               0375 00998000
         SLA   @08,2                                               0375 00999000
         L     @02,@PC00001+4                                      0375 01000000
         L     @02,CPTF(,@02)                                      0375 01001000
         L     @02,ICTPCHN(,@02)                                   0375 01002000
         AL    @02,@CF02030                                        0375 01003000
         L     @08,ICTIXP(@08,@02)                                 0375 01004000
         NI    ICTMISEL(@08),B'01111111'                           0375 01005000
*       END;                                                       0376 01006000
         AH    J,@CH00067                                          0376 01007000
@DE00373 LR    @08,J                                               0376 01008000
         SLA   @08,2                                               0376 01009000
         L     @02,@PC00001+4                                      0376 01010000
         L     @02,CPTF(,@02)                                      0376 01011000
         L     @02,ICTPCHN(,@02)                                   0376 01012000
         AL    @02,@CF02030                                        0376 01013000
         L     @08,ICTIXP(@08,@02)                                 0376 01014000
         CL    @08,ICTENDIX                                        0376 01015000
         BNE   @DL00373                                            0376 01016000
*     END;                                                         0377 01017000
*   IF HIGHTMS<STOPPTF THEN                                        0378 01018000
@RF00370 CH    HIGHTMS,@CH00059                                    0378 01019000
         BNL   @RF00378                                            0378 01020000
*     DO;                                                          0379 01021000
*                                                                  0379 01022000
*       /*************************************************************/ 01023000
*       /*                                                           */ 01024000
*       /* "CURRENT" SYSMOD SUCCESSFUL ... SORT OUT ELEMENTS IN THIS */ 01025000
*       /* AND OTHER SYSMODS                                         */ 01026000
*       /*                                                           */ 01027000
*       /*************************************************************/ 01028000
*                                                                  0380 01029000
*       RESPECIFY                                                  0380 01030000
*         ICTMOD BASED(CCAICMOD);   /* ADDRESS ENTIRE ICT MOD SECT   */ 01031000
*                                                                  0380 01032000
*       /*************************************************************/ 01033000
*       /*                                                           */ 01034000
*       /* GO THRU THE ENTIRE ICT MOD SECTION (INDEX J)              */ 01035000
*       /*                                                           */ 01036000
*       /*************************************************************/ 01037000
*                                                                  0381 01038000
*       DO J=1 BY 1 WHILE ICTMEND(J)^=ICTENDNT;                    0381 01039000
         LA    J,1                                                 0381 01040000
         B     @DE00381                                            0381 01041000
@DL00381 DS    0H                                                  0382 01042000
*         IF ICTMISEL(J)=ON         /* SELECTED ELEMENT              */ 01043000
*             &ICTPPTR(J)=CPTF      /* FROM "CURRENT" SYSMOD         */ 01044000
*           THEN                                                   0382 01045000
         LR    @08,J                                               0382 01046000
         MH    @08,@CH02013                                        0382 01047000
         L     @02,CCAICMOD(,CCAPTR)                               0382 01048000
         ST    @08,@TF00001                                        0382 01049000
         ALR   @08,@02                                             0382 01050000
         AL    @08,@CF02033                                        0382 01051000
         TM    ICTMISEL-11(@08),B'10000000'                        0382 01052000
         BNO   @RF00382                                            0382 01053000
         L     @08,@PC00001+4                                      0382 01054000
         L     @01,@TF00001                                        0382 01055000
         AL    @01,@CF02034                                        0382 01056000
         L     @15,ICTPPTR-96(@01,@02)                             0382 01057000
         C     @15,CPTF(,@08)                                      0382 01058000
         BNE   @RF00382                                            0382 01059000
*           DO;                                                    0383 01060000
*                                                                  0383 01061000
*             /*******************************************************/ 01062000
*             /*                                                     */ 01063000
*             /* INDEX J - SELECTED ELEMENT FROM "CURRENT" SYSMOD    */ 01064000
*             /*                                                     */ 01065000
*             /*******************************************************/ 01066000
*                                                                  0384 01067000
*             ICTMTSEL(J)=ON;       /* SET TRANSIENT SELECT FLAG     */ 01068000
*                                                                  0384 01069000
         AL    @02,@TF00001                                        0384 01070000
         AL    @02,@CF02033                                        0384 01071000
         OI    ICTMTSEL-11(@02),B'00000010'                        0384 01072000
*             /*******************************************************/ 01073000
*             /*                                                     */ 01074000
*             /* GO THRU THE ENTIRE ICT MOD SECTION (INDEX I)        */ 01075000
*             /*                                                     */ 01076000
*             /*******************************************************/ 01077000
*                                                                  0385 01078000
*             DO I=1 BY 1 WHILE ICTMEND(I)^=ICTENDNT;              0385 01079000
         LA    I,1                                                 0385 01080000
         B     @DE00385                                            0385 01081000
@DL00385 DS    0H                                                  0386 01082000
*               IF ICTMNAME(I)=ICTMNAME(J)/* NAMES THE SAME          */ 01083000
*                   &I^=J           /* NOT SELF                      */ 01084000
*                   &ICTPPTR(I)^=CPTF/* NOT FROM "CURRENT" SYSMOD    */ 01085000
*                   &ICTMISEL(I)=ON /* "OTHER" IS SELECTED           */ 01086000
*                 THEN                                             0386 01087000
         LA    @08,144                                             0386 01088000
         LR    @01,I                                               0386 01089000
         MR    @00,@08                                             0386 01090000
         L     @15,CCAICMOD(,CCAPTR)                               0386 01091000
         LR    @07,@08                                             0386 01092000
         MR    @06,J                                               0386 01093000
         ST    @01,@TF00001                                        0386 01094000
         ALR   @01,@15                                             0386 01095000
         AL    @01,@CF02036                                        0386 01096000
         ST    @07,@TF00002                                        0386 01097000
         ALR   @07,@15                                             0386 01098000
         AL    @07,@CF02036                                        0386 01099000
         CLC   ICTMNAME(8,@01),ICTMNAME(@07)                       0386 01100000
         BNE   @RF00386                                            0386 01101000
         CR    I,J                                                 0386 01102000
         BE    @RF00386                                            0386 01103000
         L     @08,@PC00001+4                                      0386 01104000
         L     @14,@TF00001                                        0386 01105000
         AL    @14,@CF02034                                        0386 01106000
         L     @14,ICTPPTR-96(@14,@15)                             0386 01107000
         C     @14,CPTF(,@08)                                      0386 01108000
         BE    @RF00386                                            0386 01109000
         LR    @08,@15                                             0386 01110000
         AL    @08,@TF00001                                        0386 01111000
         AL    @08,@CF02033                                        0386 01112000
         TM    ICTMISEL-11(@08),B'10000000'                        0386 01113000
         BNO   @RF00386                                            0386 01114000
*                 DO;                                              0387 01115000
*                                                                  0387 01116000
*                   /*************************************************/ 01117000
*                   /*                                               */ 01118000
*                   /* INDEX I - PREVIOUSLY SELECTED ELEMENT FROM    */ 01119000
*                   /* ANOTHER SYSMOD                                */ 01120000
*                   /*                                               */ 01121000
*                   /*************************************************/ 01122000
*                                                                  0388 01123000
*                   CALL INTRSECT(ADDR(ICTMOD(J)),/* "CURRENT" ELEM  */ 01124000
*                       ADDR(ICTMOD(I)),/* "OTHER" ELEMENT           */ 01125000
*                       ITYPE);     /* INTERSECTION TYPE             */ 01126000
         L     @08,@TF00002                                        0388 01127000
         AL    @08,@CF02036                                        0388 01128000
         LA    @08,ICTMOD(@08,@15)                                 0388 01129000
         ST    @08,@AFTEMPS+8                                      0388 01130000
         L     @08,@TF00001                                        0388 01131000
         AL    @15,@CF02036                                        0388 01132000
         LA    @08,ICTMOD(@08,@15)                                 0388 01133000
         ST    @08,@AFTEMPS+12                                     0388 01134000
         LA    @01,@AL00388                                        0388 01135000
         BAL   @14,INTRSECT                                        0388 01136000
*                   IF ITYPE=REPREP /* REPLACEMENT TO REPLACEMENT    */ 01137000
*                       |ITYPE=REPUPD/* REPLACEMENT TO UPDATE        */ 01138000
*                       |(ITYPE=SRCMOD/* SRC REPLACEMENT TO MOD      */ 01139000
*                       &ICTMASOC(J)=OFF)/* ... NO ASSOC. ++MOD      */ 01140000
*                       |(ITYPE=SRCUMOD/* SRC UPDATE TO MOD          */ 01141000
*                       &ICTMASOC(J)=OFF)/* ... NO ASSOC. ++MOD      */ 01142000
*                       |(ITYPE=MODSRC/* MOD REPLACEMENT TO SRC      */ 01143000
*                       &ICTMASOC(J)=OFF)/* .. NO ASSOC. ++SRC/SRCUPD*/ 01144000
*                       |(ITYPE=MODSRCU/* MOD REPLACEMENT TO SRCUPD  */ 01145000
*                       &ICTMASOC(J)=OFF)/* .. NO ASSOC. ++SRC/SRCUPD*/ 01146000
*                       |ITYPE=MODXPND/* MOD REPLACEMENT TO EXPAND   */ 01147000
*                     THEN                                         0389 01148000
         CLI   ITYPE,1                                             0389 01149000
         BE    @RT00389                                            0389 01150000
         CLI   ITYPE,2                                             0389 01151000
         BE    @RT00389                                            0389 01152000
         CLI   ITYPE,16                                            0389 01153000
         BNE   @GL00020                                            0389 01154000
         LR    @08,J                                               0389 01155000
         MH    @08,@CH02013                                        0389 01156000
         L     @01,CCAICMOD(,CCAPTR)                               0389 01157000
         ALR   @01,@08                                             0389 01158000
         AL    @01,@CF02033                                        0389 01159000
         TM    ICTMASOC-11(@01),B'00010000'                        0389 01160000
         BZ    @RT00389                                            0389 01161000
@GL00020 CLI   ITYPE,32                                            0389 01162000
         BNE   @GL00019                                            0389 01163000
         LR    @08,J                                               0389 01164000
         MH    @08,@CH02013                                        0389 01165000
         L     @01,CCAICMOD(,CCAPTR)                               0389 01166000
         ALR   @01,@08                                             0389 01167000
         AL    @01,@CF02033                                        0389 01168000
         TM    ICTMASOC-11(@01),B'00010000'                        0389 01169000
         BZ    @RT00389                                            0389 01170000
@GL00019 CLI   ITYPE,64                                            0389 01171000
         BNE   @GL00018                                            0389 01172000
         LR    @08,J                                               0389 01173000
         MH    @08,@CH02013                                        0389 01174000
         L     @01,CCAICMOD(,CCAPTR)                               0389 01175000
         ALR   @01,@08                                             0389 01176000
         AL    @01,@CF02033                                        0389 01177000
         TM    ICTMASOC-11(@01),B'00010000'                        0389 01178000
         BZ    @RT00389                                            0389 01179000
@GL00018 CLI   ITYPE,128                                           0389 01180000
         BNE   @GL00017                                            0389 01181000
         LR    @08,J                                               0389 01182000
         MH    @08,@CH02013                                        0389 01183000
         L     @01,CCAICMOD(,CCAPTR)                               0389 01184000
         ALR   @01,@08                                             0389 01185000
         AL    @01,@CF02033                                        0389 01186000
         TM    ICTMASOC-11(@01),B'00010000'                        0389 01187000
         BZ    @RT00389                                            0389 01188000
@GL00017 CLI   ITYPE,129                                           0389 01189000
         BNE   @RF00389                                            0389 01190000
@RT00389 DS    0H                                                  0390 01191000
*                     DO;                                          0390 01192000
*                                                                  0390 01193000
*                       /*********************************************/ 01194000
*                       /*                                           */ 01195000
*                       /* GET RID OF PREVIOUSLY SELECTED VERSION    */ 01196000
*                       /* (EXCEPT ASSEM ENTRIES) AND WRK DATASET    */ 01197000
*                       /* MEMBER                                    */ 01198000
*                       /*                                           */ 01199000
*                       /*********************************************/ 01200000
*                                                                  0391 01201000
*                       ICTMISEL(I)=OFF;/* CLEAR SELECT FLAG         */ 01202000
         LR    @08,I                                               0391 01203000
         MH    @08,@CH02013                                        0391 01204000
         L     @15,CCAICMOD(,CCAPTR)                               0391 01205000
         ST    @08,@TF00001                                        0391 01206000
         ALR   @08,@15                                             0391 01207000
         AL    @08,@CF02033                                        0391 01208000
         NI    ICTMISEL-11(@08),B'01111111'                        0391 01209000
*                       CALL SCRWRKX(ICTMOD(I));/* SCRATCH PREV.   0392 01210000
*                                      VERSION ON WRK DATASET        */ 01211000
         L     @08,@TF00001                                        0392 01212000
         AL    @15,@CF02036                                        0392 01213000
         LA    @08,ICTMOD(@08,@15)                                 0392 01214000
         ST    @08,@AL00001                                        0392 01215000
         LA    @01,@AL00001                                        0392 01216000
         BAL   @14,SCRWRKX                                         0392 01217000
*                     END;                                         0393 01218000
*                   IF ITYPE=UPDUPD /* UPDATE TO UPDATE              */ 01219000
*                       |ITYPE=UPDREP/* UPDATE TO REPLACEMENT        */ 01220000
*                     THEN                                         0394 01221000
@RF00389 CLI   ITYPE,8                                             0394 01222000
         BE    @RT00394                                            0394 01223000
         CLI   ITYPE,4                                             0394 01224000
         BNE   @RF00394                                            0394 01225000
@RT00394 DS    0H                                                  0395 01226000
*                     ICTMFMID(I)=ICTMFMID(J);/* SET FMID OF PREVIOUS   01227000
*                                      ELEMENT TO FMID OF ELEMENT  0395 01228000
*                                      FROM "CURRENT" SYSMOD         */ 01229000
         LA    @08,144                                             0395 01230000
         LR    @01,I                                               0395 01231000
         MR    @00,@08                                             0395 01232000
         L     @15,CCAICMOD(,CCAPTR)                               0395 01233000
         ALR   @01,@15                                             0395 01234000
         AL    @01,@CF02037                                        0395 01235000
         LR    @07,@08                                             0395 01236000
         MR    @06,J                                               0395 01237000
         ALR   @15,@07                                             0395 01238000
         AL    @15,@CF02037                                        0395 01239000
         MVC   @TS00001(7),ICTMFMID-88(@15)                        0395 01240000
         MVC   ICTMFMID-88(7,@01),@TS00001                         0395 01241000
*                 END;                                             0396 01242000
@RF00394 DS    0H                                                  0397 01243000
*             END;                  /* END OF "GO THRU THE ENTIRE ICT   01244000
*                                      MOD SECTION (INDEX I)"        */ 01245000
@RF00386 AH    I,@CH00067                                          0397 01246000
@DE00385 LR    @08,I                                               0397 01247000
         MH    @08,@CH02013                                        0397 01248000
         L     @01,CCAICMOD(,CCAPTR)                               0397 01249000
         ALR   @01,@08                                             0397 01250000
         AL    @01,@CF02036                                        0397 01251000
         MVC   @TF00001(4),ICTMEND(@01)                            0397 01252000
         L     @08,@TF00001                                        0397 01253000
         CL    @08,ICTENDNT                                        0397 01254000
         BNE   @DL00385                                            0397 01255000
*           END;                    /* END OF "A SELECTED ELEMENT  0398 01256000
*                                      FROM THE CURRENT SYSMOD"      */ 01257000
*       END;                        /* END OF "GO THRU THE ENTIRE ICT   01258000
*                                      MOD SECTION"                  */ 01259000
*                                                                  0399 01260000
@RF00382 AH    J,@CH00067                                          0399 01261000
@DE00381 LR    @08,J                                               0399 01262000
         MH    @08,@CH02013                                        0399 01263000
         L     @02,CCAICMOD(,CCAPTR)                               0399 01264000
         ALR   @02,@08                                             0399 01265000
         AL    @02,@CF02036                                        0399 01266000
         MVC   @TF00001(4),ICTMEND(@02)                            0399 01267000
         L     @08,@TF00001                                        0399 01268000
         CL    @08,ICTENDNT                                        0399 01269000
         BNE   @DL00381                                            0399 01270000
*       /*************************************************************/ 01271000
*       /*                                                           */ 01272000
*       /* THE SELECT AND DELETE FLAGS IN ALL ICT MOD SECTION ENTRIES*/ 01273000
*       /* FOR THE "CURRENT" SYSMOD AND INTERSECTED-WITH SYSMODS HAVE*/ 01274000
*       /* BEEN APPROPRIATELY SET                                    */ 01275000
*       /*                                                           */ 01276000
*       /*************************************************************/ 01277000
*                                                                  0400 01278000
*     END;                          /* END "CURRENT" SYSMOD        0400 01279000
*                                      SUCCESSFUL                    */ 01280000
*                                                                  0401 01281000
*/********************************************************************/ 01282000
*/*                                                                  */ 01283000
*/*  AT THIS POINT,                                                  */ 01284000
*/*                                                                  */ 01285000
*/*    1. THERE WILL BE NO MORE THAN ONE SELECTED ++MOD, ++MAC,      */ 01286000
*/*       ++SRC REPLACEMENT-TYPE ICT MOD SECTION ENTRY FOR ANY       */ 01287000
*/*       ONE ELEMENT.                                               */ 01288000
*/*                                                                  */ 01289000
*/*    2. THERE MAY BE MULTIPLE SELECTED ++MACUPD, ++SRCUPD UPDATE-  */ 01290000
*/*       TYPE ICT MOD SECTION ENTRIES FOR AN ELEMENT.               */ 01291000
*/*                                                                  */ 01292000
*/*    3. THERE MAY BE MULTIPLE SELECTED ASSEMBLY MOD SECTION        */ 01293000
*/*       ENTRIES WHICH REPRESENT ASSEMBLIES FOR AN ELEMENT          */ 01294000
*/*       CAUSED BY SOURCE AND MACRO MODIFICATIONS.  ALL OF THESE    */ 01295000
*/*       ASSEMBLIES WILL BE FOR THE SAME SYSMOD.                    */ 01296000
*/*                                                                  */ 01297000
*/*       - THERE MAY BE A SELECTED ++MOD ICT MOD SECTION ENTRY      */ 01298000
*/*         FOR THIS SAME ELEMENT IF THE SYSMOD SUPPLIED BOTH        */ 01299000
*/*         A ++MOD AND A ++SRC/++SRCUPD FOR THE ELEMENT.            */ 01300000
*/*                                                                  */ 01301000
*/*       - THE RMID (ICTMRMID) OF THESE ASSEMBLY ENTRIES IS THE     */ 01302000
*/*         SYSMOD WHICH WAS PROCESSED.                              */ 01303000
*/*                                                                  */ 01304000
*/*       - SOME OF THESE MAY BE ELIMINATED DURING THE PROCESSING    */ 01305000
*/*         OF SUBSEQUENT SYSMODS.                                   */ 01306000
*/*                                                                  */ 01307000
*/*       - THE FMID OWNERSHIP OF THESE ASSEMBLY ENTRIES (ICTMFMID)  */ 01308000
*/*         HAS BEEN ESTABLISHED (SEE ASSEMCHK PROCEDURE).           */ 01309000
*/*                                                                  */ 01310000
*/*    -----------------------------------------------------------   */ 01311000
*/*                                                                  */ 01312000
*/*  PROCESSING REQUIRED IN HMASMTMD AFTER ALL SYSMODS HAVE BEEN     */ 01313000
*/*  PROCESSED:                                                      */ 01314000
*/*                                                                  */ 01315000
*/*    1. IF THERE IS A SELECTED ++MOD MOD SECTION ENTRY FOR AN      */ 01316000
*/*       ELEMENT, ALL SELECTED ASSEMBLY MOD SECTION ENTRIES FOR     */ 01317000
*/*       THE SAME ELEMENT MAY BE ELIMINATED.                        */ 01318000
*/*                                                                  */ 01319000
*/*    2. IF MORE THAN ONE SELECTED ASSEMBLY MOD SECTION ENTRY       */ 01320000
*/*       EXISTS FOR THE SAME ELEMENT, THEY ALL HAVE BEEN CAUSED     */ 01321000
*/*       BY THE SAME SYSMOD.  ALL BUT ONE OF THESE MAY BE           */ 01322000
*/*       ELIMINATED.                                                */ 01323000
*/*                                                                  */ 01324000
*/*                                                                  */ 01325000
*/********************************************************************/ 01326000
*                                                                  0401 01327000
*   RETURN CODE(HIGHTMS);           /* RETURN TO CALLER              */ 01328000
@RF00378 LR    @15,HIGHTMS                                         0401 01329000
         L     @13,4(,@13)                                         0401 01330000
         L     @14,12(,@13)                                        0401 01331000
         LM    @00,@12,20(@13)                                     0401 01332000
         BR    @14                                                 0401 01333000
*                                                                  0402 01334000
*/********************************************************************/ 01335000
*/*                                                                  */ 01336000
*/*    REPELEM  - PROCESS ++MOD, ++MAC, ++SRC AND ASSEMBLY           */ 01337000
*/*               REPLACEMENT ELEMENTS                               */ 01338000
*/*                                                                  */ 01339000
*/*      - FOR ++MOD, ++MAC AND ++SRC ELEMENTS, DETERMINE WHETHER    */ 01340000
*/*        THE ELEMENT SHOULD BE SELECTED OF EXCLUDED AS FOLLOWS:    */ 01341000
*/*                                                                  */ 01342000
*/*                                                                  */ 01343000
*/*          VERSION    RMID CHECK    UMID CHECK       RESULT        */ 01344000
*/*          --------   ----------    ----------     ------------    */ 01345000
*/*                                                                  */ 01346000
*/*             Y           -             -            SELECT        */ 01347000
*/*             N           Y             Y            SELECT        */ 01348000
*/*             N           N             -            IDERROR *     */ 01349000
*/*             N           -             N            IDERROR *     */ 01350000
*/*                                                                  */ 01351000
*/*         * UNLESS "CURRENT" SYSMOD IS BEING                       */ 01352000
*/*           RE-INSTALLED AND THE TARGET SYSTEM IS FOUND            */ 01353000
*/*           TO BE "UP-LEVEL".  IF THE TARGET SYSTEM IS             */ 01354000
*/*           "UP-LEVEL", EXCLUDE THE ELEMENT.                       */ 01355000
*/*                                                                  */ 01356000
*/*         . CHECK THE BYPASS OPTIONS IF AN ID CHECK ERROR IS       */ 01357000
*/*           DETECTED.  ISSUE HMA319I FOR RMID ID CHECK ERRORS      */ 01358000
*/*           AND CALL UMIDCHK TO ISSUE HMA319I MESSAGES FOR UMID    */ 01359000
*/*           ID CHECK ERRORS.                                       */ 01360000
*/*                                                                  */ 01361000
*/*                                                                  */ 01362000
*/*    CONDITIONS UPON ENTRY:                                        */ 01363000
*/*                                                                  */ 01364000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 01365000
*/*                  (MOD, MAC OR SRC REPLACEMENT)                   */ 01366000
*/*                                                                  */ 01367000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 01368000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 01369000
*/*                                                                  */ 01370000
*/*    CONDITIONS UPON EXIT:                                         */ 01371000
*/*                                                                  */ 01372000
*/*     * ICTMISEL - '1' IF ELEMENT SHOULD BE SELECTED               */ 01373000
*/*                  '0' IF ELEMENT SHOULD NOT BE SELECTED           */ 01374000
*/*                                                                  */ 01375000
*/*     * ICTMMIDE - '1' IF ID CHECK ERROR DETECTED (EVEN IF BYPASSD)*/ 01376000
*/*                  '0' NO ID CHECK ERROR                           */ 01377000
*/*                                                                  */ 01378000
*/*     * ASMREQD  - SET FOR ASSEMBLY ENTRY PASSED IF THE RMID       */ 01379000
*/*                  OF THE LAST-SELECTED MOD ELEMENT IS NOT PRED    */ 01380000
*/*                  OR SUPD AND THE LAST-SELECTED MOD ELEMENT       */ 01381000
*/*                  IS ITSELF THE RESULT OF AN ASSEMBLY             */ 01382000
*/*                                                                  */ 01383000
*/*     * EXCLUDED - SET IF ELEMENT SHOULD BE EXCLUDED               */ 01384000
*/*                                                                  */ 01385000
*/*                                                                  */ 01386000
*/********************************************************************/ 01387000
*                                                                  0402 01388000
*REPELEM:                                                          0402 01389000
*   PROC;                                                          0402 01390000
REPELEM  STM   @14,@04,@SA00002                                    0402 01391000
         STM   @06,@12,@SA00002+28                                 0402 01392000
*   RESPECIFY                                                      0403 01393000
*     ICTMOD BASED(CMOD);           /* ADDRESS "CURRENT" ELEMENT     */ 01394000
*   RESPECIFY                                                      0404 01395000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" SYSMOD      */ 01396000
*   SELEXCL=''B;                    /* CLEAR PROCESSING FLAGS        */ 01397000
         XC    SELEXCL(2),SELEXCL                                  0405 01398000
*   REPFLG=ON;                      /* PROCESSING REPLACEMENT ELEMENT*/ 01399000
*                                                                  0406 01400000
         OI    REPFLG,B'00001000'                                  0406 01401000
*   /*****************************************************************/ 01402000
*   /*                                                               */ 01403000
*   /* DETERMINE THE FMID AND RMID OF THE LAST SELECTED VERSION OF   */ 01404000
*   /* THE "CURRENT" ELEMENT                                         */ 01405000
*   /*                                                               */ 01406000
*   /*****************************************************************/ 01407000
*                                                                  0407 01408000
*   CALL GETMIDS;                   /* GET MODIDS ASSOCIATED WITH THE   01409000
*                                      LAST SELECTED VERSION OF THE     01410000
*                                      "CURRENT" ELEMENT             */ 01411000
         BAL   @14,GETMIDS                                         0407 01412000
*   IF(LASTFMID^=NULLPTF#           /* THERE IS A "LAST" FMID        */ 01413000
*       &ICTMFMID(1)^=LASTFMID)     /* .. AND ELEMENT-FMID'S DIFFER  */ 01414000
*     THEN                                                         0408 01415000
         CLC   LASTFMID(7),@CC01719                                0408 01416000
         BE    @RF00408                                            0408 01417000
         L     @08,CMOD                                            0408 01418000
         CLC   ICTMFMID(7,@08),LASTFMID                            0408 01419000
         BE    @RF00408                                            0408 01420000
*     DO;                                                          0409 01421000
*                                                                  0409 01422000
*       /*************************************************************/ 01423000
*       /*                                                           */ 01424000
*       /* "CURRENT" ELEMENT AND "LAST-REPLACEMENT" HAVE DIFFERENT   */ 01425000
*       /* FMIDS                                                     */ 01426000
*       /*                                                           */ 01427000
*       /*************************************************************/ 01428000
*                                                                  0410 01429000
*       CALL VERSION;               /* SELECT/EXCLUDE PROCESSING     */ 01430000
         BAL   @14,VERSION                                         0410 01431000
*       IF VERSIOND=ON THEN                                        0411 01432000
         TM    VERSIOND,B'00010000'                                0411 01433000
         BNO   @RF00411                                            0411 01434000
*         DO;                                                      0412 01435000
*           ICTMISEL(1)=ON;         /* SELECT "CURRENT" ELEMENT      */ 01436000
         L     @08,CMOD                                            0413 01437000
         OI    ICTMISEL(@08),B'10000000'                           0413 01438000
*           ICTMICHN(1)=TBLXNULL;   /* CLEAR (A)CDS MODID LIST       */ 01439000
         L     @15,@PC00001                                        0414 01440000
         MVC   ICTMICHN(4,@08),TBLXNULL(@15)                       0414 01441000
*         END;                                                     0415 01442000
*       ELSE                                                       0416 01443000
*         EXCLUDED=ON;              /* EXCLUDE "CURRENT" ELEMENT     */ 01444000
         B     @RC00411                                            0416 01445000
@RF00411 OI    EXCLUDED,B'00001000'                                0416 01446000
*       SELDONE=ON;                 /* SELECTION PROCESSING DONE     */ 01447000
@RC00411 OI    SELDONE,B'10000000'                                 0417 01448000
*     END;                                                         0418 01449000
*   IF(LASTFMID=NULLPTF#            /* THERE IS NO "LAST" FMID       */ 01450000
*       &LASTRMID=NULLPTF#)         /* .. AND THERE IS NO "LAST" RMID*/ 01451000
*     THEN                                                         0419 01452000
@RF00408 CLC   LASTFMID(7),@CC01719                                0419 01453000
         BNE   @RF00419                                            0419 01454000
         CLC   LASTRMID(7),@CC01719                                0419 01455000
         BNE   @RF00419                                            0419 01456000
*     DO;                                                          0420 01457000
*                                                                  0420 01458000
*       /*************************************************************/ 01459000
*       /*                                                           */ 01460000
*       /* THERE IS NO PREVIOUSLY SELECTED VERSION OF THIS ELEMENT   */ 01461000
*       /*                                                           */ 01462000
*       /*************************************************************/ 01463000
*                                                                  0421 01464000
*       ICTMISEL(1)=ON;             /* SELECT "CURRENT" ELEMENT      */ 01465000
         L     @08,CMOD                                            0421 01466000
         OI    ICTMISEL(@08),B'10000000'                           0421 01467000
*       ICTMICHN(1)=TBLXNULL;       /* CLEAR (A)CDS MODID LIST       */ 01468000
         L     @15,@PC00001                                        0422 01469000
         MVC   ICTMICHN(4,@08),TBLXNULL(@15)                       0422 01470000
*       SELDONE=ON;                 /* SELECTION PROCESSING DONE     */ 01471000
         OI    SELDONE,B'10000000'                                 0423 01472000
*     END;                                                         0424 01473000
*   IF SELDONE=OFF                  /* SELECTION PROCESSING NOT DONE */ 01474000
*     THEN                                                         0425 01475000
@RF00419 TM    SELDONE,B'10000000'                                 0425 01476000
         BNZ   @RF00425                                            0425 01477000
*     DO;                                                          0426 01478000
*                                                                  0426 01479000
*       /*************************************************************/ 01480000
*       /*                                                           */ 01481000
*       /* "CURRENT" ELEMENT AND "LAST-REPLACEMENT" HAVE SAME FMIDS  */ 01482000
*       /* ... OR THE "LAST-REPLACEMENT" HAS AN RMID WITH NO FMID    */ 01483000
*       /*                                                           */ 01484000
*       /*************************************************************/ 01485000
*                                                                  0427 01486000
*       IF ICTPTYPE(1)=IOPPFUNC     /* FUNCTION-TYPE SYSMOD          */ 01487000
*           &ICTPREDO(1)=ON         /* ... BEING RE-PROCESSED        */ 01488000
*           &ICTMASM(1)=OFF         /* ELEMENT NOT ASSEM ENTRY       */ 01489000
*           &LASTFMID^=NULLPTF#     /* ... VALID "LAST" FMID         */ 01490000
*         THEN                                                     0427 01491000
         L     @08,@PC00001+4                                      0427 01492000
         L     @08,CPTF(,@08)                                      0427 01493000
         CLI   ICTPTYPE(@08),4                                     0427 01494000
         BNE   @RF00427                                            0427 01495000
         TM    ICTPREDO(@08),B'01000000'                           0427 01496000
         BNO   @RF00427                                            0427 01497000
         L     @08,CMOD                                            0427 01498000
         TM    ICTMASM(@08),B'01000000'                            0427 01499000
         BNZ   @RF00427                                            0427 01500000
         CLC   LASTFMID(7),@CC01719                                0427 01501000
         BE    @RF00427                                            0427 01502000
*         DO;                                                      0428 01503000
*                                                                  0428 01504000
*           /*********************************************************/ 01505000
*           /*                                                       */ 01506000
*           /* ELEMENT FROM FUNCTION BEING RE-INSTALLED              */ 01507000
*           /*                                                       */ 01508000
*           /*********************************************************/ 01509000
*                                                                  0429 01510000
*           CALL UPLEVCHK;          /* CHECK TARGET SYSTEM FOR THIS     01511000
*                                      ELEMENT'S RMID/UMID(S)        */ 01512000
         BAL   @14,UPLEVCHK                                        0429 01513000
*           IF UPLEVEL=ON           /* TARGET SYSTEM UPLEVEL         */ 01514000
*             THEN                                                 0430 01515000
         TM    UPLEVEL,B'00000100'                                 0430 01516000
         BNO   @RF00430                                            0430 01517000
*             EXCLUDED=ON;          /* EXCLUDE "CURRENT" ELEM.       */ 01518000
         OI    EXCLUDED,B'00001000'                                0431 01519000
*         END;                      /* END RE-INSTALL PROCESSING     */ 01520000
@RF00430 DS    0H                                                  0433 01521000
*       IF EXCLUDED=OFF             /* ELEMENT NOT EXCLUDED          */ 01522000
*         THEN                                                     0433 01523000
@RF00427 TM    EXCLUDED,B'00001000'                                0433 01524000
         BNZ   @RF00433                                            0433 01525000
*         DO;                                                      0434 01526000
*           IF ICTMRMID(1)^=LASTRMID/* RMIDS DIFFER                  */ 01527000
*               &LASTRMID^=NULLPTF# /* ... VALID LAST RMID           */ 01528000
*             THEN                                                 0435 01529000
         L     @08,CMOD                                            0435 01530000
         CLC   ICTMRMID(7,@08),LASTRMID                            0435 01531000
         BE    @RF00435                                            0435 01532000
         CLC   LASTRMID(7),@CC01719                                0435 01533000
         BE    @RF00435                                            0435 01534000
*             DO;                                                  0436 01535000
*                                                                  0436 01536000
*               /*****************************************************/ 01537000
*               /*                                                   */ 01538000
*               /* ELEMENTS HAVE DIFFERENT RMIDS                     */ 01539000
*               /*                                                   */ 01540000
*               /*****************************************************/ 01541000
*                                                                  0437 01542000
*               IF ICTPFMID(1)^=LASTFMID/* SYSMOD FMID DIFFERS FROM     01543000
*                                      ELEMENT'S FMID                */ 01544000
*                   &ICTMASM(1)=ON  /* FOR AN ELEMENT TO BE ASSEMBLED*/ 01545000
*                 THEN                                             0437 01546000
         L     @04,@PC00001+4                                      0437 01547000
         L     @04,CPTF(,@04)                                      0437 01548000
         CLC   ICTPFMID(7,@04),LASTFMID                            0437 01549000
         BE    @RF00437                                            0437 01550000
         TM    ICTMASM(@08),B'01000000'                            0437 01551000
         BNO   @RF00437                                            0437 01552000
*                 DO;                                              0438 01553000
*                                                                  0438 01554000
*                   /*************************************************/ 01555000
*                   /*                                               */ 01556000
*                   /* SYSMOD FMID DIFFERS FROM THE FMID OF AN       */ 01557000
*                   /* ELEMENT TO BE ASSEMBLED ... THE ASSEMBLY WAS  */ 01558000
*                   /* CAUSED BY A MACRO FROM THE "CURRENT" SYSMOD   */ 01559000
*                   /*                                               */ 01560000
*                   /*************************************************/ 01561000
*                                                                  0439 01562000
*                   ASMREQD=ON;     /* SET ASSEMBLY REQUIRED FLAG    */ 01563000
         OI    ASMREQD,B'00010000'                                 0439 01564000
*                 END;                                             0440 01565000
*               ELSE                                               0441 01566000
*                 DO;                                              0441 01567000
*                                                                  0441 01568000
         B     @RC00437                                            0441 01569000
@RF00437 DS    0H                                                  0442 01570000
*                   /*************************************************/ 01571000
*                   /*                                               */ 01572000
*                   /* THE "CURRENT" SYSMOD MUST BE CHECKED FOR A    */ 01573000
*                   /* PROPER PRE/SUP RELATIONSHIP WITH THE ELEMENT'S*/ 01574000
*                   /* "LAST" RMID                                   */ 01575000
*                   /*                                               */ 01576000
*                   /*************************************************/ 01577000
*                                                                  0442 01578000
*                   CALL HMASMTPS(CPTF,/* "CURRENT" SYSMOD           */ 01579000
*                       LASTRMID,   /* LAST RMID SYSMOD              */ 01580000
*                       TPSRTN);    /* CHECK PRE/SUP                 */ 01581000
         MVC   @AL00001+4(8),@AL00442                              0442 01582000
         L     @08,@PC00001+4                                      0442 01583000
         ST    @08,@AL00001                                        0442 01584000
         L     @15,@CV01714                                        0442 01585000
         LA    @01,@AL00001                                        0442 01586000
         BALR  @14,@15                                             0442 01587000
*                   IF TPSRTN^=PRESUP THEN                         0443 01588000
         CLI   TPSRTN,232                                          0443 01589000
         BE    @RF00443                                            0443 01590000
*                     DO;                                          0444 01591000
*                       IF ICTMASM(1)=ON/* ELEMENT IS AN ASSEMBLY    */ 01592000
*                           &LRMIDASM=ON/* LAST RMID RESULT OF ASSM. */ 01593000
*                         THEN                                     0445 01594000
         L     @08,CMOD                                            0445 01595000
         TM    ICTMASM(@08),B'01000000'                            0445 01596000
         BNO   @RF00445                                            0445 01597000
         TM    LRMIDASM,B'10000000'                                0445 01598000
         BNO   @RF00445                                            0445 01599000
*                         ASMREQD=ON;/* AN ASSEMBLY IS REQUIRED AGAIN*/ 01600000
         OI    ASMREQD,B'00010000'                                 0446 01601000
*                       ELSE                                       0447 01602000
*                         IF ICTPREDO(1)=ON/* SYSMOD RE-INSTALLATION */ 01603000
*                             &ICTPTYPE(1)^=IOPPFUNC/* NON-FCTN.   0447 01604000
*                                      SYSMOD                        */ 01605000
*                           THEN                                   0447 01606000
         B     @RC00445                                            0447 01607000
@RF00445 L     @08,@PC00001+4                                      0447 01608000
         L     @08,CPTF(,@08)                                      0447 01609000
         TM    ICTPREDO(@08),B'01000000'                           0447 01610000
         BNO   @RF00447                                            0447 01611000
         CLI   ICTPTYPE(@08),4                                     0447 01612000
         BE    @RF00447                                            0447 01613000
*                           EXCLUDED=ON;/* EXCLUDE THE ELEMENT       */ 01614000
         OI    EXCLUDED,B'00001000'                                0448 01615000
*                         ELSE                                     0449 01616000
*                           RMIDERR=ON;/* INDICATE RMID CHECK ERROR  */ 01617000
         B     @RC00447                                            0449 01618000
@RF00447 OI    RMIDERR,B'10000000'                                 0449 01619000
*                     END;          /* RMID NOT PRE/SUPD             */ 01620000
@RC00447 DS    0H                                                  0450 01621000
@RC00445 DS    0H                                                  0451 01622000
*                 END;                                             0451 01623000
@RF00443 DS    0H                                                  0452 01624000
*             END;                  /* ELEMENTS HAVE DIFFERENT RMIDS */ 01625000
@RC00437 DS    0H                                                  0453 01626000
*           IF EXCLUDED=OFF         /* ELEMENT NOT YET EXCLUDED      */ 01627000
*             THEN                                                 0453 01628000
@RF00435 TM    EXCLUDED,B'00001000'                                0453 01629000
         BNZ   @RF00453                                            0453 01630000
*             DO;                                                  0454 01631000
*                                                                  0454 01632000
*               /*****************************************************/ 01633000
*               /*                                                   */ 01634000
*               /* CHECK THE "CURRENT" SYSMOD RELATIVE TO ANY UPDATES*/ 01635000
*               /*                                                   */ 01636000
*               /*****************************************************/ 01637000
*                                                                  0455 01638000
*               IF TBLBPID=ON       /* BYPASS ID CHECK ERRORS        */ 01639000
*                 THEN                                             0455 01640000
         L     @08,@PC00001                                        0455 01641000
         L     @08,TBLXTBL(,@08)                                   0455 01642000
         TM    TBLBPID(@08),B'10000000'                            0455 01643000
         BNO   @RF00455                                            0455 01644000
*                 MGPTYPE=MGPWARN;  /* WARNINGS FOR UMID ERRORS      */ 01645000
         MVI   MGPTYPE,X'02'                                       0456 01646000
*               ELSE                                               0457 01647000
*                 MGPTYPE=MGPERR;   /* STOP-SYSMOD FOR UMID ERRORS   */ 01648000
         B     @RC00455                                            0457 01649000
@RF00455 MVI   MGPTYPE,X'03'                                       0457 01650000
*               IF ICTPREDO(1)=ON   /* SYSMOD RE-INSTALL             */ 01651000
*                 THEN                                             0458 01652000
@RC00455 L     @08,@PC00001+4                                      0458 01653000
         L     @08,CPTF(,@08)                                      0458 01654000
         TM    ICTPREDO(@08),B'01000000'                           0458 01655000
         BNO   @RF00458                                            0458 01656000
*                 CALL UMIDCHK(NOMSG);/* CHECK UMIDS (NO MESSAGES)   */ 01657000
         LA    @01,@AL00459                                        0459 01658000
         BAL   @14,UMIDCHK                                         0459 01659000
*               ELSE                                               0460 01660000
*                 CALL UMIDCHK(MSG);/* CHECK UMIDS (ISSUE MESSAGES)  */ 01661000
*                                                                  0460 01662000
         B     @RC00458                                            0460 01663000
@RF00458 LA    @01,@AL00460                                        0460 01664000
         BAL   @14,UMIDCHK                                         0460 01665000
*               /*****************************************************/ 01666000
*               /*                                                   */ 01667000
*               /* DETERMINE SETTING OF ICTMISEL ("SELECT" FLAG)     */ 01668000
*               /*                                                   */ 01669000
*               /*****************************************************/ 01670000
*                                                                  0461 01671000
*               IF RMIDERR=OFF      /* RMID CHECK SUCCESSFUL         */ 01672000
*                   &UMIDERR=OFF    /* UMID CHECK SUCCESSFUL         */ 01673000
*                 THEN                                             0461 01674000
@RC00458 TM    RMIDERR,B'11000000'                                 0461 01675000
         BNZ   @RF00461                                            0461 01676000
*                 ICTMISEL(1)=ON;   /* SELECT ELEMENT - NO ID CHECK  */ 01677000
         L     @08,CMOD                                            0462 01678000
         OI    ICTMISEL(@08),B'10000000'                           0462 01679000
*               ELSE                                               0463 01680000
*                 DO;                                              0463 01681000
         B     @RC00461                                            0463 01682000
@RF00461 DS    0H                                                  0464 01683000
*                   IF RMIDERR=OFF  /* RMID CHECK SUCCESSFUL         */ 01684000
*                       &UMIDERR=ON /* UMID CHECK FAILED             */ 01685000
*                       &ICTPREDO(1)=ON/* SYSMOD BEING RE-INSTALLED  */ 01686000
*                     THEN                                         0464 01687000
         TM    UMIDERR,B'01000000'                                 0464 01688000
         BNO   @RF00464                                            0464 01689000
         TM    RMIDERR,B'10000000'                                 0464 01690000
         BNZ   @RF00464                                            0464 01691000
         L     @08,@PC00001+4                                      0464 01692000
         L     @08,CPTF(,@08)                                      0464 01693000
         TM    ICTPREDO(@08),B'01000000'                           0464 01694000
         BNO   @RF00464                                            0464 01695000
*                     EXCLUDED=ON;  /* EXCLUDE "CURRENT" ELEMENT     */ 01696000
         OI    EXCLUDED,B'00001000'                                0465 01697000
*                   ELSE                                           0466 01698000
*                     IF TBLBPID=ON /* ID CHECK ERRORS BYPASSED      */ 01699000
*                       THEN                                       0466 01700000
         B     @RC00464                                            0466 01701000
@RF00464 L     @08,@PC00001                                        0466 01702000
         L     @08,TBLXTBL(,@08)                                   0466 01703000
         TM    TBLBPID(@08),B'10000000'                            0466 01704000
         BNO   @RF00466                                            0466 01705000
*                       DO;                                        0467 01706000
*                         ICTBYP(1)=ON;/* BYPASS USED FOR SYSMOD     */ 01707000
         L     @08,@PC00001+4                                      0468 01708000
         L     @08,CPTF(,@08)                                      0468 01709000
         OI    ICTBYP(@08),B'00000010'                             0468 01710000
*                         ICTMISEL(1)=ON;/* SELECT ELEMENT - ID CHECK   01711000
*                                      ERROR                         */ 01712000
         L     @08,CMOD                                            0469 01713000
         OI    ICTMISEL(@08),B'10000000'                           0469 01714000
*                       END;                                       0470 01715000
*                 END;                                             0471 01716000
@RF00466 DS    0H                                                  0471 01717000
@RC00464 DS    0H                                                  0472 01718000
*             END;                                                 0472 01719000
@RC00461 DS    0H                                                  0473 01720000
*         END;                                                     0473 01721000
@RF00453 DS    0H                                                  0474 01722000
*     END;                          /* END SAME FMID PROCESSING      */ 01723000
@RF00433 DS    0H                                                  0475 01724000
*   IF EXCLUDED=OFF                 /* NOT EXCLUDED                  */ 01725000
*       &(RMIDERR=ON                /* RMID ID ERROR                 */ 01726000
*       |UMIDERR=ON)                /* UMID ID ERROR                 */ 01727000
*     THEN                                                         0475 01728000
@RF00425 TM    EXCLUDED,B'00001000'                                0475 01729000
         BNZ   @RF00475                                            0475 01730000
         TM    RMIDERR,B'11000000'                                 0475 01731000
         BZ    @RF00475                                            0475 01732000
*     DO;                                                          0476 01733000
*                                                                  0476 01734000
*       /*************************************************************/ 01735000
*       /*                                                           */ 01736000
*       /* RMID OR UMID ID CHECK ERROR                               */ 01737000
*       /*                                                           */ 01738000
*       /*************************************************************/ 01739000
*                                                                  0477 01740000
*       ICTMMIDE(1)=ON;             /* SET ID CHECK FLAG             */ 01741000
         L     @08,CMOD                                            0477 01742000
         OI    ICTMMIDE(@08),B'00001000'                           0477 01743000
*       IF ICTMISEL(1)=ON           /* ELEMENT IS SELECTED           */ 01744000
*         THEN                                                     0478 01745000
         TM    ICTMISEL(@08),B'10000000'                           0478 01746000
         BNO   @RF00478                                            0478 01747000
*         CCARGNP=ON;               /* SET FLAG FOR HMASMARL         */ 01748000
         OI    CCARGNP(CCAPTR),B'01000000'                         0479 01749000
*       IF RMIDERR=ON               /* RMID ID CHECK ERROR           */ 01750000
*         THEN                                                     0480 01751000
@RF00478 TM    RMIDERR,B'10000000'                                 0480 01752000
         BNO   @RF00480                                            0480 01753000
*         DO;                                                      0481 01754000
*                                                                  0481 01755000
*           /*********************************************************/ 01756000
*           /*                                                       */ 01757000
*           /* ISSUE MESSAGE HMA382I AND HMA319I FOR RMID ID CHECK   */ 01758000
*           /* RELATIVE TO LASTRMID (UMIDCHK PROC ISSUED MESSAGES FOR*/ 01759000
*           /* ALL OTHER MODIDS)                                     */ 01760000
*           /*                                                       */ 01761000
*           /*********************************************************/ 01762000
*                                                                  0482 01763000
*           IF MSG382I=OFF THEN                                    0482 01764000
         TM    MSG382I,B'00100000'                                 0482 01765000
         BNZ   @RF00482                                            0482 01766000
*             CALL ERRMSG(HMA382I,NOPART);/* ISSUE MESSAGE           */ 01767000
         LA    @01,@AL00483                                        0483 01768000
         BAL   @14,ERRMSG                                          0483 01769000
*           MSG382I=ON;             /* SET HMA382I MSG ISSUED FLAG   */ 01770000
@RF00482 OI    MSG382I,B'00100000'                                 0484 01771000
*           IF LREPELM@=0           /* LAST REPLACEMENT NOT IN ICT   */ 01772000
*             THEN                                                 0485 01773000
         L     @08,LREPELM@                                        0485 01774000
         LTR   @08,@08                                             0485 01775000
         BNZ   @RF00485                                            0485 01776000
*             VPART#3=MSGXCDS;      /* SET "SMPCDS" OR "SMPACDS"     */ 01777000
         MVC   VPART#3(8),MSGXCDS                                  0486 01778000
*           ELSE                                                   0487 01779000
*             VPART#3=MSGSEL;       /* SET "SELECTED"                */ 01780000
         B     @RC00485                                            0487 01781000
@RF00485 MVC   VPART#3(8),@CC01841                                 0487 01782000
*           VPART#4=MSGRMID;        /* SET "RMID" IN HMA319I MSG     */ 01783000
@RC00485 MVC   VPART#4(8),@CC01837                                 0488 01784000
*           VPART#5=LASTRMID;       /* SET LAST RMID SYSMOD IN MSG   */ 01785000
         MVI   VPART#5+7,C' '                                      0489 01786000
         MVC   VPART#5(7),LASTRMID                                 0489 01787000
*           CALL ERRMSG(HMA319I,NOPART);/* ISSUE MSG FOR RMID        */ 01788000
         LA    @01,@AL00490                                        0490 01789000
         BAL   @14,ERRMSG                                          0490 01790000
*         END;                                                     0491 01791000
*     END;                          /* END ID CHECK ERROR PROCESSING */ 01792000
@RF00480 DS    0H                                                  0493 01793000
*   REPFLG=OFF;                     /* FINISHED PROCESSING REPL. ELEM*/ 01794000
@RF00475 NI    REPFLG,B'11110111'                                  0493 01795000
*   RETURN;                                                        0494 01796000
@EL00002 DS    0H                                                  0494 01797000
@EF00002 DS    0H                                                  0494 01798000
@ER00002 LM    @14,@04,@SA00002                                    0494 01799000
         LM    @06,@12,@SA00002+28                                 0494 01800000
         BR    @14                                                 0494 01801000
*   END REPELEM;                                                   0495 01802000
*                                                                  0496 01803000
*/********************************************************************/ 01804000
*/*                                                                  */ 01805000
*/*    UPDELEM  - PROCESS ++ZAP, ++MACUPD AND ++SRCUPD UPDATE        */ 01806000
*/*               ELEMENTS:                                          */ 01807000
*/*                                                                  */ 01808000
*/*      - DETERMINE WHETHER ELEMENT SHOULD BE SELECTED:             */ 01809000
*/*                                                                  */ 01810000
*/*                                                                  */ 01811000
*/*          VERSION    RMID CHECK    UMID CHECK       RESULT        */ 01812000
*/*          --------   ----------    ----------     ------------    */ 01813000
*/*                                                                  */ 01814000
*/*             Y           -             Y            SELECT        */ 01815000
*/*             Y           -             N            SELECT  *     */ 01816000
*/*             N           Y             Y            SELECT        */ 01817000
*/*             N           Y             N            SELECT  *     */ 01818000
*/*             N           N             -            IDERROR       */ 01819000
*/*                                                                  */ 01820000
*/*                                                                  */ 01821000
*/*         * - FOR ++SRCUPD ELEMENTS, ELIMINATE THE ASSOCIATED      */ 01822000
*/*             ++MOD REPLACEMENT SUPPLIED IN THE "CURRENT" SYSMOD.  */ 01823000
*/*                                                                  */ 01824000
*/*                                                                  */ 01825000
*/*      - CHECK BYPASS OPTIONS IF ID CHECK ERROR FOR RMID           */ 01826000
*/*                                                                  */ 01827000
*/*         - ISSUE HMA319I FOR RMID ID CHECK ERROR.                 */ 01828000
*/*                                                                  */ 01829000
*/*      - CALL UMIDCHK TO LIST ANY UPDATES IN ICT AND/OR (A)CDS     */ 01830000
*/*        WHICH ARE NOT PREREQD OR SUPERSEDED ... UMIDERR WILL      */ 01831000
*/*        BE SET IF SO                                              */ 01832000
*/*                                                                  */ 01833000
*/*                                                                  */ 01834000
*/*    CONDITIONS UPON ENTRY:                                        */ 01835000
*/*                                                                  */ 01836000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 01837000
*/*                  (ZAP, MACUPD OR SRCUPD UPDATE ELEMENT)          */ 01838000
*/*                                                                  */ 01839000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 01840000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 01841000
*/*                                                                  */ 01842000
*/*    CONDITIONS UPON EXIT:                                         */ 01843000
*/*                                                                  */ 01844000
*/*                                                                  */ 01845000
*/*     * ICTMISEL - '1' IF ELEMENT SHOULD BE SELECTED               */ 01846000
*/*                  '0' IF ELEMENT SHOULD NOT BE SELECTED           */ 01847000
*/*                                                                  */ 01848000
*/*     * ICTMMIDE - '1' IF ID CHECK ERROR DETECTED (EVEN IF BYPASSD)*/ 01849000
*/*                  '0' NO ID CHECK ERROR                           */ 01850000
*/*                                                                  */ 01851000
*/*     * UMIDERR -  SET IF "CURRENT" SYSMOD DID NOT PREREQ OR       */ 01852000
*/*                  SUPERSEDE ALL UPDATES IN ICT AND/OR (A)CDS      */ 01853000
*/*                                                                  */ 01854000
*/*     * EXCLUDED - SET IF ELEMENT SHOULD BE EXCLUDED               */ 01855000
*/*                                                                  */ 01856000
*/********************************************************************/ 01857000
*                                                                  0496 01858000
*UPDELEM:                                                          0496 01859000
*   PROC;                                                          0496 01860000
UPDELEM  STM   @14,@04,@SA00003                                    0496 01861000
         STM   @06,@12,@SA00003+28                                 0496 01862000
*   RESPECIFY                                                      0497 01863000
*     ICTMOD BASED(CMOD);           /* ADDRESS "CURRENT" ELEMENT     */ 01864000
*   RESPECIFY                                                      0498 01865000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" SYSMOD      */ 01866000
*   SELEXCL=''B;                    /* CLEAR SELECT/EXCLUDE FLAGS    */ 01867000
         XC    SELEXCL(2),SELEXCL                                  0499 01868000
*   UPDFLG=ON;                      /* PROCESSING UPDATE ELEMENT     */ 01869000
*                                                                  0500 01870000
         OI    UPDFLG,B'00000100'                                  0500 01871000
*   /*****************************************************************/ 01872000
*   /*                                                               */ 01873000
*   /* DETERMINE THE FMID AND RMID OF THE LAST SELECTED VERSION OF   */ 01874000
*   /* THE "CURRENT" ELEMENT                                         */ 01875000
*   /*                                                               */ 01876000
*   /*****************************************************************/ 01877000
*                                                                  0501 01878000
*   CALL GETMIDS;                   /* GET MODIDS ASSOCIATED WITH THE   01879000
*                                      LAST SELECTED VERSION OF THE     01880000
*                                      CURRENT ELEMENT               */ 01881000
         BAL   @14,GETMIDS                                         0501 01882000
*   IF DELETED=ON                   /* ELEMENT FOUND DELETED         */ 01883000
*     THEN                                                         0502 01884000
         TM    DELETED,B'01000000'                                 0502 01885000
         BNO   @RF00502                                            0502 01886000
*     DO;                                                          0503 01887000
*                                                                  0503 01888000
*       /*************************************************************/ 01889000
*       /*                                                           */ 01890000
*       /* UPDATE FOR AN ELEMENT WHICH IS DELETED (HMA381I)          */ 01891000
*       /*                                                           */ 01892000
*       /*************************************************************/ 01893000
*                                                                  0504 01894000
*       UPDERROR=ON;                /* SET UPDATE ERROR FLAG         */ 01895000
         OI    UPDERROR,B'00100000'                                0504 01896000
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */ 01897000
         MVI   MGPTYPE,X'03'                                       0505 01898000
*       CALL ERRMSG(HMA381I,NOPART);/* ISSUE HMA381I                 */ 01899000
         LA    @01,@AL00506                                        0506 01900000
         BAL   @14,ERRMSG                                          0506 01901000
*     END;                                                         0507 01902000
*   IF UPDERROR=OFF                 /* ELEMENT NOT FOUND DELETED     */ 01903000
*     THEN                                                         0508 01904000
@RF00502 TM    UPDERROR,B'00100000'                                0508 01905000
         BNZ   @RF00508                                            0508 01906000
*     DO;                                                          0509 01907000
*       IF LASTRMID=NULLPTF#        /* NO VERSION OF ELEMENT FOUND   */ 01908000
*         THEN                                                     0510 01909000
         CLC   LASTRMID(7),@CC01719                                0510 01910000
         BNE   @RF00510                                            0510 01911000
*         DO;                                                      0511 01912000
*                                                                  0511 01913000
*           /*********************************************************/ 01914000
*           /*                                                       */ 01915000
*           /* UPDATE FOR AN ELEMENT WHICH DOES NOT EXIST (HMA415I)  */ 01916000
*           /*                                                       */ 01917000
*           /*********************************************************/ 01918000
*                                                                  0512 01919000
*           UPDERROR=ON;            /* SET UPDATE ERROR FLAG         */ 01920000
         OI    UPDERROR,B'00100000'                                0512 01921000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 01922000
         MVI   MGPTYPE,X'03'                                       0513 01923000
*           CALL ERRMSG(HMA415I,NOPART);/* ISSUE HMA415I             */ 01924000
         LA    @01,@AL00514                                        0514 01925000
         BAL   @14,ERRMSG                                          0514 01926000
*         END;                                                     0515 01927000
*     END;                                                         0516 01928000
@RF00510 DS    0H                                                  0517 01929000
*   IF UPDERROR=OFF                 /* NO UPDATE ERROR               */ 01930000
*     THEN                                                         0517 01931000
@RF00508 TM    UPDERROR,B'00100000'                                0517 01932000
         BNZ   @RF00517                                            0517 01933000
*     DO;                                                          0518 01934000
*       IF ICTMFMID(1)^=LASTFMID    /* COMPARE ELEMENT-FMID'S        */ 01935000
*         THEN                                                     0519 01936000
         L     @08,CMOD                                            0519 01937000
         CLC   ICTMFMID(7,@08),LASTFMID                            0519 01938000
         BE    @RF00519                                            0519 01939000
*         DO;                                                      0520 01940000
*                                                                  0520 01941000
*           /*********************************************************/ 01942000
*           /*                                                       */ 01943000
*           /* ELEMENTS HAVE DIFFERENT FMIDS                         */ 01944000
*           /*                                                       */ 01945000
*           /*********************************************************/ 01946000
*                                                                  0521 01947000
*           CALL VERSION;           /* SELECT/EXCLUDE PROCESSING     */ 01948000
         BAL   @14,VERSION                                         0521 01949000
*           IF VERSIOND=ON THEN                                    0522 01950000
         TM    VERSIOND,B'00010000'                                0522 01951000
         BNO   @RF00522                                            0522 01952000
*             DO;                                                  0523 01953000
*               ICTMISEL(1)=ON;     /* SELECT "CURRENT" ELEMENT      */ 01954000
         L     @08,CMOD                                            0524 01955000
         OI    ICTMISEL(@08),B'10000000'                           0524 01956000
*               ICTMRMID(1)=ICTPTFS(1);/* "CURRENT" SYSMOD BECOMES 0525 01957000
*                                      RMID                          */ 01958000
         L     @04,@PC00001+4                                      0525 01959000
         L     @04,CPTF(,@04)                                      0525 01960000
         MVC   ICTMRMID(7,@08),ICTPTFS(@04)                        0525 01961000
*             END;                                                 0526 01962000
*           ELSE                                                   0527 01963000
*             EXCLUDED=ON;          /* EXCLUDE "CURRENT" ELEMENT     */ 01964000
         B     @RC00522                                            0527 01965000
@RF00522 OI    EXCLUDED,B'00001000'                                0527 01966000
*         END;                                                     0528 01967000
*       ELSE                                                       0529 01968000
*         DO;                                                      0529 01969000
*                                                                  0529 01970000
         B     @RC00519                                            0529 01971000
@RF00519 DS    0H                                                  0530 01972000
*           /*********************************************************/ 01973000
*           /*                                                       */ 01974000
*           /* ELEMENTS HAVE SAME FMIDS                              */ 01975000
*           /*                                                       */ 01976000
*           /*********************************************************/ 01977000
*                                                                  0530 01978000
*           CALL HMASMTPS(CPTF,     /* "CURRENT" SYSMOD              */ 01979000
*               LASTRMID,           /* LAST RMID                     */ 01980000
*               TPSRTN);            /* PREREQD OR SUPD               */ 01981000
         MVC   @AL00001+4(8),@AL00530                              0530 01982000
         L     @08,@PC00001+4                                      0530 01983000
         ST    @08,@AL00001                                        0530 01984000
         L     @15,@CV01714                                        0530 01985000
         LA    @01,@AL00001                                        0530 01986000
         BALR  @14,@15                                             0530 01987000
*           IF TPSRTN=PRESUP        /* PARM RETURNED BY HMASMTPS     */ 01988000
*             THEN                                                 0531 01989000
         CLI   TPSRTN,232                                          0531 01990000
         BNE   @RF00531                                            0531 01991000
*             ICTMISEL(1)=ON;       /* SELECT "CURRENT" ELEMENT      */ 01992000
         L     @08,CMOD                                            0532 01993000
         OI    ICTMISEL(@08),B'10000000'                           0532 01994000
*           ELSE                                                   0533 01995000
*             IF ICTPREDO(1)=ON     /* SYSMOD RE-INSTALL             */ 01996000
*               THEN                                               0533 01997000
         B     @RC00531                                            0533 01998000
@RF00531 L     @08,@PC00001+4                                      0533 01999000
         L     @08,CPTF(,@08)                                      0533 02000000
         TM    ICTPREDO(@08),B'01000000'                           0533 02001000
         BNO   @RF00533                                            0533 02002000
*               EXCLUDED=ON;        /* EXCLUDE THE ELEMENT           */ 02003000
         OI    EXCLUDED,B'00001000'                                0534 02004000
*             ELSE                                                 0535 02005000
*               RMIDERR=ON;         /* RMID ID CHECK ERROR           */ 02006000
         B     @RC00533                                            0535 02007000
@RF00533 OI    RMIDERR,B'10000000'                                 0535 02008000
*         END;                                                     0536 02009000
@RC00533 DS    0H                                                  0536 02010000
@RC00531 DS    0H                                                  0537 02011000
*     END;                                                         0537 02012000
@RC00519 DS    0H                                                  0538 02013000
*   IF RMIDERR=ON                   /* RMID ID CHECK ERROR           */ 02014000
*       &UPDERROR=OFF               /* NO UPDATE ERROR               */ 02015000
*     THEN                                                         0538 02016000
@RF00517 TM    RMIDERR,B'10000000'                                 0538 02017000
         BNO   @RF00538                                            0538 02018000
         TM    UPDERROR,B'00100000'                                0538 02019000
         BNZ   @RF00538                                            0538 02020000
*     DO;                                                          0539 02021000
*                                                                  0539 02022000
*       /*************************************************************/ 02023000
*       /*                                                           */ 02024000
*       /* RMID ID CHECK ERROR ... CHECK BYPASS OPTIONS              */ 02025000
*       /*                                                           */ 02026000
*       /*************************************************************/ 02027000
*                                                                  0540 02028000
*       ICTMMIDE(1)=ON;             /* SET ID CHECK FAILURE FLAG     */ 02029000
         L     @08,CMOD                                            0540 02030000
         OI    ICTMMIDE(@08),B'00001000'                           0540 02031000
*       IF TBLBPID=ON               /* ID CHECK ERRORS BYPASSEDD     */ 02032000
*         THEN                                                     0541 02033000
         L     @04,@PC00001                                        0541 02034000
         L     @04,TBLXTBL(,@04)                                   0541 02035000
         TM    TBLBPID(@04),B'10000000'                            0541 02036000
         BNO   @RF00541                                            0541 02037000
*         DO;                                                      0542 02038000
*           MGPTYPE=MGPWARN;        /* SET ERROR MSG/RETURN_CODE     */ 02039000
         MVI   MGPTYPE,X'02'                                       0543 02040000
*           ICTMISEL(1)=ON;         /* SELECT "CURRENT" ELEMENT      */ 02041000
         OI    ICTMISEL(@08),B'10000000'                           0544 02042000
*           ICTBYP(1)=ON;           /* BYPASS USED FOR THIS SYSMOD   */ 02043000
         L     @08,@PC00001+4                                      0545 02044000
         L     @08,CPTF(,@08)                                      0545 02045000
         OI    ICTBYP(@08),B'00000010'                             0545 02046000
*         END;                                                     0546 02047000
*       ELSE                                                       0547 02048000
*         MGPTYPE=MGPERR;           /* SET ERROR MSG/RETURN_CODE     */ 02049000
         B     @RC00541                                            0547 02050000
@RF00541 MVI   MGPTYPE,X'03'                                       0547 02051000
*       IF ICTMISEL(1)=ON           /* ELEMENT IS SELECTED           */ 02052000
*         THEN                                                     0548 02053000
@RC00541 L     @08,CMOD                                            0548 02054000
         TM    ICTMISEL(@08),B'10000000'                           0548 02055000
         BNO   @RF00548                                            0548 02056000
*         CCARGNP=ON;               /* SET FLAG FOR HMASMARL         */ 02057000
*                                                                  0549 02058000
         OI    CCARGNP(CCAPTR),B'01000000'                         0549 02059000
*       /*************************************************************/ 02060000
*       /*                                                           */ 02061000
*       /* ISSUE HMA382I FOR RMID ID CHECK FAILURE                   */ 02062000
*       /*                                                           */ 02063000
*       /*************************************************************/ 02064000
*                                                                  0550 02065000
*       IF MSG382I=OFF THEN                                        0550 02066000
@RF00548 TM    MSG382I,B'00100000'                                 0550 02067000
         BNZ   @RF00550                                            0550 02068000
*         CALL ERRMSG(HMA382I,NOPART);/* ISSUE MESSAGE               */ 02069000
         LA    @01,@AL00551                                        0551 02070000
         BAL   @14,ERRMSG                                          0551 02071000
*       MSG382I=ON;                 /* SET HMA382I MSG ISSUED FLAG   */ 02072000
*                                                                  0552 02073000
@RF00550 OI    MSG382I,B'00100000'                                 0552 02074000
*       /*************************************************************/ 02075000
*       /*                                                           */ 02076000
*       /* LIST RMID INVOLVED IN ID CHECK ERROR (HMA319I)            */ 02077000
*       /*                                                           */ 02078000
*       /*************************************************************/ 02079000
*                                                                  0553 02080000
*       IF LREPELM@=0               /* LAST REPLACEMENT NOT IN ICT   */ 02081000
*         THEN                                                     0553 02082000
         L     @08,LREPELM@                                        0553 02083000
         LTR   @08,@08                                             0553 02084000
         BNZ   @RF00553                                            0553 02085000
*         VPART#3=MSGXCDS;          /* SET "SMPCDS" OR "SMPACDS" IN     02086000
*                                      MSG                           */ 02087000
         MVC   VPART#3(8),MSGXCDS                                  0554 02088000
*       ELSE                                                       0555 02089000
*         VPART#3=MSGSEL;           /* SET "SELECTED" IN MSG         */ 02090000
         B     @RC00553                                            0555 02091000
@RF00553 MVC   VPART#3(8),@CC01841                                 0555 02092000
*       VPART#4=MSGRMID;            /* SET "RMID" IN HMA319I MSG     */ 02093000
@RC00553 MVC   VPART#4(8),@CC01837                                 0556 02094000
*       VPART#5=LASTRMID;           /* RMID SYSMOD-ID IN HMA319I MSG */ 02095000
         MVI   VPART#5+7,C' '                                      0557 02096000
         MVC   VPART#5(7),LASTRMID                                 0557 02097000
*       CALL ERRMSG(HMA319I,NOPART);/* ISSUE MSG                     */ 02098000
         LA    @01,@AL00558                                        0558 02099000
         BAL   @14,ERRMSG                                          0558 02100000
*     END;                          /* END ID CHECK ERROR PROCESSING */ 02101000
*   IF ICTMISEL(1)=ON               /* "CURRENT" ELEMENT SELECTED    */ 02102000
*     THEN                                                         0560 02103000
@RF00538 L     @08,CMOD                                            0560 02104000
         TM    ICTMISEL(@08),B'10000000'                           0560 02105000
         BNO   @RF00560                                            0560 02106000
*     DO;                                                          0561 02107000
*                                                                  0561 02108000
*       /*************************************************************/ 02109000
*       /*                                                           */ 02110000
*       /* CHECK UMIDS ASSOCIATED WITH LAST REPLACEMENT VERSION OF   */ 02111000
*       /* THE CURRENT ELEMENT                                       */ 02112000
*       /*                                                           */ 02113000
*       /*************************************************************/ 02114000
*                                                                  0562 02115000
*       MGPTYPE=MGPWARN;            /* SET UP MESSAGE SEVERITY       */ 02116000
         MVI   MGPTYPE,X'02'                                       0562 02117000
*       CALL UMIDCHK(MSG);          /* ISSUE UMID WARNING MESSAGES   */ 02118000
         LA    @01,@AL00563                                        0563 02119000
         BAL   @14,UMIDCHK                                         0563 02120000
*       IF UMIDERR=ON               /* UMID CHECKS                   */ 02121000
*         THEN                                                     0564 02122000
         TM    UMIDERR,B'01000000'                                 0564 02123000
         BNO   @RF00564                                            0564 02124000
*         CCARGNP=ON;               /* SET FLAG FOR HMASMARL         */ 02125000
         OI    CCARGNP(CCAPTR),B'01000000'                         0565 02126000
*     END;                                                         0566 02127000
@RF00564 DS    0H                                                  0567 02128000
*   UPDFLG=OFF;                     /* FINISHED PROCESSING REPL. ELEM*/ 02129000
@RF00560 NI    UPDFLG,B'11111011'                                  0567 02130000
*   RETURN;                                                        0568 02131000
@EL00003 DS    0H                                                  0568 02132000
@EF00003 DS    0H                                                  0568 02133000
@ER00003 LM    @14,@04,@SA00003                                    0568 02134000
         LM    @06,@12,@SA00003+28                                 0568 02135000
         BR    @14                                                 0568 02136000
*   END UPDELEM;                                                   0569 02137000
*                                                                  0570 02138000
*/********************************************************************/ 02139000
*/*                                                                  */ 02140000
*/*    VERSION  - DETERMINE SELECTION/EXCLUSION BASED UPON THE       */ 02141000
*/*               FMID AND VERSION RELATIONSHIP BETWEEN THE          */ 02142000
*/*               "CURRENT" ELEMENT AND THE PREVIOUSLY SELECTED      */ 02143000
*/*               ELEMENT                                            */ 02144000
*/*                                                                  */ 02145000
*/*               THIS PROCEDURE IS CALLED WHEN THE "CURRENT"        */ 02146000
*/*               ELEMENT'S FMID IS NOT THE SAME AS THE FMID         */ 02147000
*/*               OF THE PREVIOUSLY SELECTED VERSION OF THE ELEMENT. */ 02148000
*/*                                                                  */ 02149000
*/*    CONDITIONS UPON ENTRY:                                        */ 02150000
*/*                                                                  */ 02151000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 02152000
*/*                                                                  */ 02153000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 02154000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 02155000
*/*                                                                  */ 02156000
*/*     * LASTFMID - SET TO THE ELEMENT-FMID ASSOCIATED WITH THE     */ 02157000
*/*                  LAST SELECTED VERSION OF THE "CURRENT" ELEMENT. */ 02158000
*/*                                                                  */ 02159000
*/*                - IF LASTFMID='       ' NO PREVIOUSLY SELECTED    */ 02160000
*/*                  VERSION OF THE ELEMENT WAS FOUND.               */ 02161000
*/*                                                                  */ 02162000
*/*    CONDITIONS UPON EXIT:                                         */ 02163000
*/*                                                                  */ 02164000
*/*     * VERSIOND - SET AS FOLLOWS:                                 */ 02165000
*/*                                                                  */ 02166000
*/*                  0  - "CURRENT" ELEMENT SHOULD NOT BE SELECTED   */ 02167000
*/*                  1  - "CURRENT" ELEMENT SHOULD BE SELECTED       */ 02168000
*/*                                                                  */ 02169000
*/********************************************************************/ 02170000
*                                                                  0570 02171000
*VERSION:                                                          0570 02172000
*   PROC;                                                          0570 02173000
VERSION  STM   @14,@12,12(@13)                                     0570 02174000
*   DCL                                                            0571 02175000
*     FF FIXED(15);                 /* LOCAL INDEX - VERSION LIST    */ 02176000
*   RESPECIFY                                                      0572 02177000
*     ICTMOD BASED(CMOD);           /* ADDRESS CURRENT ELEMENT       */ 02178000
*   RESPECIFY                                                      0573 02179000
*     ICTPTF BASED(CPTF);           /* ADDRESS CURRENT SYSMOD        */ 02180000
*   VERSIOND=OFF;                   /* "CURRENT" SYSMOD DOES NOT   0574 02181000
*                                      VERSION (CHANGE FMID) OF LAST    02182000
*                                      SELECTED VERSION OF ELEM.     */ 02183000
         NI    VERSIOND,B'11101111'                                0574 02184000
*   IF LASTFMID=NULLPTF#            /* NO PREVIOUSLY SELECTED VERSION*/ 02185000
*     THEN                                                         0575 02186000
         CLC   LASTFMID(7),@CC01719                                0575 02187000
         BNE   @RF00575                                            0575 02188000
*     VERSIOND=ON;                  /* "CURRENT" ELEMENT SHOULD BE 0576 02189000
*                                      SELECTED                      */ 02190000
         OI    VERSIOND,B'00010000'                                0576 02191000
*   IF CPTF->ICTPFMID(1)=LASTFMID   /* COMPARE FUNCTIONAL OWNERSHIP     02192000
*                                      OF "CURRENT" SYSMOD WITH LAST    02193000
*                                      FUNCTION TO REPLACE THIS    0577 02194000
*                                      ELEMENT                       */ 02195000
*     THEN                                                         0577 02196000
*                                                                  0577 02197000
@RF00575 L     @08,@PC00001+4                                      0577 02198000
         L     @08,CPTF(,@08)                                      0577 02199000
         CLC   ICTPFMID(7,@08),LASTFMID                            0577 02200000
         BNE   @RF00577                                            0577 02201000
*     /***************************************************************/ 02202000
*     /*                                                             */ 02203000
*     /* THE "OWNER" OF THE CURRENT SYSMOD IS THE SYSMOD WHICH       */ 02204000
*     /* SUPPLIED THE PREVIOUSLY SELECTED VERSION OF THE ELEMENT ... */ 02205000
*     /* THE CURRENT SYSMOD IS FUNCTIONALLY HIGHER THAN ITS OWNER    */ 02206000
*     /*                                                             */ 02207000
*     /***************************************************************/ 02208000
*                                                                  0578 02209000
*     VERSIOND=ON;                  /* "CURRENT" ELEMENT SHOULD BE 0578 02210000
*                                      SELECTED                      */ 02211000
         OI    VERSIOND,B'00010000'                                0578 02212000
*   IF VERSIOND=OFF THEN                                           0579 02213000
@RF00577 TM    VERSIOND,B'00010000'                                0579 02214000
         BNZ   @RF00579                                            0579 02215000
*     DO;                                                          0580 02216000
*                                                                  0580 02217000
*       /*************************************************************/ 02218000
*       /*                                                           */ 02219000
*       /* COMPARE THE FUNCTIONAL HIERARCHY INFORMATION (VERSION)    */ 02220000
*       /* FROM THE CURRENT SYSMOD WITH THE FUNCTIONAL OWNERSHIP     */ 02221000
*       /* ATTRIBUTE OF THE PREVIOUSLY SELECTED VERSION OF THE       */ 02222000
*       /* ELEMENT                                                   */ 02223000
*       /*                                                           */ 02224000
*       /*************************************************************/ 02225000
*                                                                  0581 02226000
*       IF ICTMVRND(1)^=ICTENDIX THEN                              0581 02227000
         L     @08,CMOD                                            0581 02228000
         L     @08,ICTMVCHN(,@08)                                  0581 02229000
         CLC   ICTMVRND(4,@08),ICTENDIX                            0581 02230000
         BE    @RF00581                                            0581 02231000
*         DO;                                                      0582 02232000
*                                                                  0582 02233000
*           /*********************************************************/ 02234000
*           /*                                                       */ 02235000
*           /* THE CURRENT ELEMENT HAS A VERSION LIST ... USE IT     */ 02236000
*           /*                                                       */ 02237000
*           /*********************************************************/ 02238000
*                                                                  0583 02239000
*           DO FF=1 BY 1 WHILE VERSIOND=OFF&ICTMVRND(FF)^=ICTENDIX;     02240000
         LA    FF,1                                                0583 02241000
         B     @DE00583                                            0583 02242000
@DL00583 DS    0H                                                  0584 02243000
*             IF ICTMVRNM(FF)=LASTFMID THEN                        0584 02244000
*                                                                  0584 02245000
         LR    @08,FF                                              0584 02246000
         SLA   @08,3                                               0584 02247000
         L     @03,CMOD                                            0584 02248000
         L     @03,ICTMVCHN(,@03)                                  0584 02249000
         ALR   @03,@08                                             0584 02250000
         AL    @03,@CF02046                                        0584 02251000
         CLC   ICTMVRNM(7,@03),LASTFMID                            0584 02252000
         BNE   @RF00584                                            0584 02253000
*               /*****************************************************/ 02254000
*               /*                                                   */ 02255000
*               /* THE CURRENT ELEMENT'S VERSION LIST NAMES THE      */ 02256000
*               /* PREVEVIOUSLY SELECTED ELEMENT'S FMID ... SELECT   */ 02257000
*               /* THE CURRENT ELEMENT                               */ 02258000
*               /*                                                   */ 02259000
*               /*****************************************************/ 02260000
*                                                                  0585 02261000
*               VERSIOND=ON;                                       0585 02262000
         OI    VERSIOND,B'00010000'                                0585 02263000
*           END;                                                   0586 02264000
@RF00584 AH    FF,@CH00067                                         0586 02265000
@DE00583 TM    VERSIOND,B'00010000'                                0586 02266000
         BNZ   @DC00583                                            0586 02267000
         LR    @08,FF                                              0586 02268000
         SLA   @08,3                                               0586 02269000
         L     @03,CMOD                                            0586 02270000
         L     @03,ICTMVCHN(,@03)                                  0586 02271000
         AL    @03,@CF02046                                        0586 02272000
         L     @08,ICTMVRND(@08,@03)                               0586 02273000
         CL    @08,ICTENDIX                                        0586 02274000
         BNE   @DL00583                                            0586 02275000
@DC00583 DS    0H                                                  0587 02276000
*         END;                                                     0587 02277000
*       ELSE                                                       0588 02278000
*         DO;                                                      0588 02279000
*                                                                  0588 02280000
         B     @RC00581                                            0588 02281000
@RF00581 DS    0H                                                  0589 02282000
*           /*********************************************************/ 02283000
*           /*                                                       */ 02284000
*           /* THE CURRENT ELEMENT DOES NOT HAVE A VERSION LIST ...  */ 02285000
*           /* USE THE VERSION LIST FROM THE CURRENT SYSMOD'S ++VER  */ 02286000
*           /*                                                       */ 02287000
*           /*********************************************************/ 02288000
*                                                                  0589 02289000
*           DO FF=1 BY 1 WHILE VERSIOND=OFF&ICTVRSND(FF)^=ICTENDIX;     02290000
         LA    FF,1                                                0589 02291000
         B     @DE00589                                            0589 02292000
@DL00589 DS    0H                                                  0590 02293000
*             IF ICTVRSNM(FF)=LASTFMID THEN                        0590 02294000
*                                                                  0590 02295000
         LR    @08,FF                                              0590 02296000
         SLA   @08,3                                               0590 02297000
         L     @03,@PC00001+4                                      0590 02298000
         L     @03,CPTF(,@03)                                      0590 02299000
         MVC   @TF00001(4),ICTPVCHN(@03)                           0590 02300000
         L     @03,@TF00001                                        0590 02301000
         ALR   @03,@08                                             0590 02302000
         AL    @03,@CF02046                                        0590 02303000
         CLC   ICTVRSNM(7,@03),LASTFMID                            0590 02304000
         BNE   @RF00590                                            0590 02305000
*               /*****************************************************/ 02306000
*               /*                                                   */ 02307000
*               /* THE CURRENT SYSMOD'S VERSION LIST NAMES THE       */ 02308000
*               /* PREVEVIOUSLY SELECTED ELEMENT'S FMID ... SELECT   */ 02309000
*               /* THE CURRENT ELEMENT                               */ 02310000
*               /*                                                   */ 02311000
*               /*****************************************************/ 02312000
*                                                                  0591 02313000
*               VERSIOND=ON;                                       0591 02314000
         OI    VERSIOND,B'00010000'                                0591 02315000
*           END;                                                   0592 02316000
@RF00590 AH    FF,@CH00067                                         0592 02317000
@DE00589 TM    VERSIOND,B'00010000'                                0592 02318000
         BNZ   @DC00589                                            0592 02319000
         LR    @08,FF                                              0592 02320000
         SLA   @08,3                                               0592 02321000
         L     @03,@PC00001+4                                      0592 02322000
         L     @03,CPTF(,@03)                                      0592 02323000
         MVC   @TF00001(4),ICTPVCHN(@03)                           0592 02324000
         L     @03,@TF00001                                        0592 02325000
         AL    @03,@CF02046                                        0592 02326000
         L     @08,ICTVRSND(@08,@03)                               0592 02327000
         CL    @08,ICTENDIX                                        0592 02328000
         BNE   @DL00589                                            0592 02329000
@DC00589 DS    0H                                                  0593 02330000
*         END;                                                     0593 02331000
*     END;                          /* END OF VERSION LIST CHECK     */ 02332000
*   RETURN;                                                        0595 02333000
@EL00004 DS    0H                                                  0595 02334000
@EF00004 DS    0H                                                  0595 02335000
@ER00004 LM    @14,@12,12(@13)                                     0595 02336000
         BR    @14                                                 0595 02337000
*   END VERSION;                                                   0596 02338000
         B     @EL00004                                            0596 02339000
*                                                                  0597 02340000
*/********************************************************************/ 02341000
*/*                                                                  */ 02342000
*/*    UPLEVCHK - DETERMINE WHETHER THE TARGET SYSTEM <(A)CDS> IS    */ 02343000
*/*               AT A HIGHER SERVICE LEVEL THAN THE SYSMOD BEING    */ 02344000
*/*               RE-INSTALLED.                                      */ 02345000
*/*                                                                  */ 02346000
*/*    CONDITIONS UPON ENTRY:                                        */ 02347000
*/*                                                                  */ 02348000
*/*               -  THIS PROCEDURE IS INVOKED ONLY FOR SYSMODS      */ 02349000
*/*                  WHICH ARE BEING RE-INSTALLED.                   */ 02350000
*/*                                                                  */ 02351000
*/*               -  THE TARGET SYSTEM IS CONSIDERED TO BE "UPLEVEL" */ 02352000
*/*                  IF THE RMID OF THE "CURRENT" ELEMENT IS FOUND   */ 02353000
*/*                  INSTALLED ON THE TARGET SYSTEM.                 */ 02354000
*/*                                                                  */ 02355000
*/*                                                                  */ 02356000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 02357000
*/*                                                                  */ 02358000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 02359000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 02360000
*/*                                                                  */ 02361000
*/*     * LASTRMID - SET TO THE ELEMENT-RMID ASSOCIATED WITH THE     */ 02362000
*/*                  LAST SELECTED VERSION OF THE "CURRENT" ELEMENT. */ 02363000
*/*                                                                  */ 02364000
*/*     * LREPELM@ -  0  - LAST RMID REPRESENTS VERSION OF ELEMENT   */ 02365000
*/*                        ON THE TARGET SYSTEM (CDS OR ACDS).       */ 02366000
*/*                                                                  */ 02367000
*/*                  ^0  - LAST REPLACEMENT IS ICT VERSION OF THE    */ 02368000
*/*                         ELEMENT (LREPELM@ POINTS TO ICT MOD      */ 02369000
*/*                         SECT ENTRY REPRESENTING LAST REPLACEMENT)*/ 02370000
*/*                                                                  */ 02371000
*/*     * IOPPTR  -  POINTS TO AN IOP WHICH MAY BE USED TO ACCESS    */ 02372000
*/*                  (A)CDS SYSMOD ENTRIES                           */ 02373000
*/*                                                                  */ 02374000
*/*    CONDITIONS UPON EXIT:                                         */ 02375000
*/*                                                                  */ 02376000
*/*     * UPLEVEL   - SET AS FOLLOWS:                                */ 02377000
*/*                                                                  */ 02378000
*/*                  1   - TARGET SYSTEM IS UPLEVEL                  */ 02379000
*/*                  0   - TARGET SYSTEM IS NOT UPLEVEL              */ 02380000
*/*                                                                  */ 02381000
*/********************************************************************/ 02382000
*                                                                  0597 02383000
*UPLEVCHK:                                                         0597 02384000
*   PROC;                                                          0597 02385000
UPLEVCHK STM   @14,@04,@SA00005                                    0597 02386000
         STM   @06,@12,@SA00005+28                                 0597 02387000
*   RESPECIFY                                                      0598 02388000
*     ICTMOD BASED(CMOD);           /* ADDRESS "CURRENT" ELEMENT'S 0598 02389000
*                                      ICT MOD SECTION ENTRY         */ 02390000
*   UPLEVEL=OFF;                    /* INITIALIZE TO NOT UPLEVEL     */ 02391000
         NI    UPLEVEL,B'11111011'                                 0599 02392000
*   IF LREPELM@=0                   /* LAST REPLACEMENT NOT IN ICT   */ 02393000
*       &ICTMRMID(1)^=LASTRMID      /* SERVICE LEVELS NOT EQUAL      */ 02394000
*     THEN                                                         0600 02395000
         L     @08,LREPELM@                                        0600 02396000
         LTR   @08,@08                                             0600 02397000
         BNZ   @RF00600                                            0600 02398000
         L     @08,CMOD                                            0600 02399000
         CLC   ICTMRMID(7,@08),LASTRMID                            0600 02400000
         BE    @RF00600                                            0600 02401000
*     DO;                                                          0601 02402000
*                                                                  0601 02403000
*       /*************************************************************/ 02404000
*       /*                                                           */ 02405000
*       /* LAST REPLACEMENT FOR THE "CURRENT" ELEMENT IS FOUND ON THE*/ 02406000
*       /* TARGET SYSTEM ... SEE IF THE "CURRENT" ELEMENT'S RMID IS  */ 02407000
*       /* INSTALLED ON THE TARGET SYSTEM ... IF SO, THE TARGET      */ 02408000
*       /* SYSTEM IS "UP-LEVEL"                                      */ 02409000
*       /*                                                           */ 02410000
*       /*************************************************************/ 02411000
*                                                                  0602 02412000
*       RESPECIFY                                                  0602 02413000
*         HMASMIOP BASED(IOPPTR);   /* SET ADDRESSIBILITY TO AN IOP  */ 02414000
*       IF CCAAPPLY=ON THEN                                        0603 02415000
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0603 02416000
         BNO   @RF00603                                            0603 02417000
*         IOPDSID=IOPCDS;           /* APPLY => CDS                  */ 02418000
         MVI   IOPDSID(IOPPTR),X'02'                               0604 02419000
*       ELSE                                                       0605 02420000
*         IOPDSID=IOPACDS;          /* ^APPLY => ACCEPT => ACDS      */ 02421000
         B     @RC00603                                            0605 02422000
@RF00603 MVI   IOPDSID(IOPPTR),X'0C'                               0605 02423000
*       IOPFUNCT=IOPBLDL;           /* BLDL FUNCTION                 */ 02424000
@RC00603 MVI   IOPFUNCT(IOPPTR),X'04'                              0606 02425000
*       IOPTYPE=IOPSMD;             /* SYSMOD ENTRIES                */ 02426000
         MVI   IOPTYPE(IOPPTR),X'0B'                               0607 02427000
*       IOPNAME=' ';                /* BLANK ENTRY NAME FIELD        */ 02428000
         MVI   IOPNAME+1(IOPPTR),C' '                              0608 02429000
         MVC   IOPNAME+2(6,IOPPTR),IOPNAME+1(IOPPTR)               0608 02430000
         MVI   IOPNAME(IOPPTR),C' '                                0608 02431000
*       IOPNAM17=ICTMRMID(1);       /* FILL RMID AS SYSMOD ENTRY TO     02432000
*                                      LOCATE                        */ 02433000
         L     @08,CMOD                                            0609 02434000
         MVC   IOPNAM17(7,IOPPTR),ICTMRMID(@08)                    0609 02435000
*       CALL HMASMIO(HMASMIOP);                                    0610 02436000
         ST    IOPPTR,@AL00001                                     0610 02437000
         L     @15,@CV01712                                        0610 02438000
         LA    @01,@AL00001                                        0610 02439000
         BALR  @14,@15                                             0610 02440000
*       IF IOPRETRN>IOPNOTFD THEN                                  0611 02441000
         CLI   IOPRETRN(IOPPTR),4                                  0611 02442000
         BNH   @RF00611                                            0611 02443000
*         HIGHTMS=MAX(HIGHTMS,IOPRETRN);/* ACCESS ERROR RETURN CODE  */ 02444000
         SLR   @08,@08                                             0612 02445000
         IC    @08,IOPRETRN(,IOPPTR)                               0612 02446000
         CR    HIGHTMS,@08                                         0612 02447000
         BNL   *+6                                                      02448000
         LR    HIGHTMS,@08                                         0612 02449000
*       IF IOPRETRN=IOPGOOD         /* ENTRY FOUND                   */ 02450000
*           &IOPERROR=OFF           /* ENTRY NOT "IN ERROR"          */ 02451000
*         THEN                                                     0613 02452000
@RF00611 CLI   IOPRETRN(IOPPTR),0                                  0613 02453000
         BNE   @RF00613                                            0613 02454000
         TM    IOPERROR(IOPPTR),B'00010000'                        0613 02455000
         BNZ   @RF00613                                            0613 02456000
*         UPLEVEL=ON;               /* CONSIDER THE TARGET SYSTEM  0614 02457000
*                                      UP-LEVEL                      */ 02458000
         OI    UPLEVEL,B'00000100'                                 0614 02459000
*     END;                                                         0615 02460000
*   RETURN;                                                        0616 02461000
@EL00005 DS    0H                                                  0616 02462000
@EF00005 DS    0H                                                  0616 02463000
@ER00005 LM    @14,@04,@SA00005                                    0616 02464000
         LM    @06,@12,@SA00005+28                                 0616 02465000
         BR    @14                                                 0616 02466000
*   END UPLEVCHK;                                                  0617 02467000
         B     @EL00005                                            0617 02468000
*                                                                  0618 02469000
*/********************************************************************/ 02470000
*/*                                                                  */ 02471000
*/*    GETMIDS  - GET FMID AND RMID ASSOCIATED WITH THE LAST SELECTED*/ 02472000
*/*               VERSION OF THE "CURRENT" ELEMENT.                  */ 02473000
*/*                                                                  */ 02474000
*/*    CONDITIONS UPON ENTRY:                                        */ 02475000
*/*                                                                  */ 02476000
*/*               -  (A)CDS MODID LIST IN "CURRENT" ELEMENT'S        */ 02477000
*/*                  MOD SECT ENTRY MUST BE INITIALIZED              */ 02478000
*/*                                                                  */ 02479000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 02480000
*/*                                                                  */ 02481000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 02482000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 02483000
*/*                                                                  */ 02484000
*/*    CONDITIONS UPON EXIT:                                         */ 02485000
*/*                                                                  */ 02486000
*/*     * ICTMICHN - CURRENT ELEMENT'S MODID LIST IS SET TO POINT    */ 02487000
*/*                  TO THE MODID LIST OF LAST SELECTED VERSION      */ 02488000
*/*                  OF THE ELEMENT (IF FOUND IN ICT).               */ 02489000
*/*                                                                  */ 02490000
*/*     * LREPELM@ - SET TO ADDR OF ICT MOD SECTION ENTRY OF LAST    */ 02491000
*/*                  SELECTED REPLACEMENT VERSION OF THE "CURRENT"   */ 02492000
*/*                  ELEMENT (IF REPLACEMENT FOUND IN ICT).          */ 02493000
*/*                                                                  */ 02494000
*/*     * LASTFMID - SET TO THE FMID ASSOCIATED WITH LAST SELECTED   */ 02495000
*/*                  VERSION OF THE "CURRENT" ELEMENT.               */ 02496000
*/*                                                                  */ 02497000
*/*     * LASTRMID - SET TO THE RMID ASSOCIATED WITH LAST SELECTED   */ 02498000
*/*                  VERSION OF THE "CURRENT" ELEMENT.               */ 02499000
*/*                                                                  */ 02500000
*/*     * LRMIDASM - SET IF THE LAST RMID IS THE RESULT OF AN        */ 02501000
*/*                  ASSEMBLY FOUND EITHER IN ICT OR ON (A)CDS.      */ 02502000
*/*                                                                  */ 02503000
*/*     * DELETED  - SET IF THE ENTRY FOUND IN THE ICT IS FOR        */ 02504000
*/*                  A DELETED ELEMENT.                              */ 02505000
*/*                                                                  */ 02506000
*/********************************************************************/ 02507000
*                                                                  0618 02508000
*GETMIDS:                                                          0618 02509000
*   PROC;                                                          0618 02510000
GETMIDS  STM   @14,@12,@SA00006                                    0618 02511000
*   DCL                                                            0619 02512000
*     RR FIXED(15);                 /* LOCAL INDEX - ICT MOD SECT    */ 02513000
*   RESPECIFY                                                      0620 02514000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */ 02515000
*   LREPELM@=0;                     /* CLEAR PTR TO LAST REPL IN ICT */ 02516000
         SLR   @08,@08                                             0621 02517000
         ST    @08,LREPELM@                                        0621 02518000
*   LASTFMID=NULLPTF#;              /* BLANK LAST FMID               */ 02519000
         MVC   LASTFMID(7),@CC01719                                0622 02520000
*   LASTRMID=NULLPTF#;              /* BLANK LAST RMID               */ 02521000
         MVC   LASTRMID(7),@CC01719                                0623 02522000
*   LRMIDASM=OFF;                   /* CLEAR "LAST RMID => ASSEMBLY" */ 02523000
         NI    LRMIDASM,B'01111111'                                0624 02524000
*                                                                  0625 02525000
*   /*****************************************************************/ 02526000
*   /*                                                               */ 02527000
*   /* GO THRU ICT MOD SECTION ... MAKE SURE ASSEMBLY ENTRY IS FOUND */ 02528000
*   /* (IF THERE IS BOTH A MOD AND ASSEM FOR SAME ELEMENT)           */ 02529000
*   /*                                                               */ 02530000
*   /*****************************************************************/ 02531000
*                                                                  0625 02532000
*   DO RR=1 BY 1 WHILE ICTMEND(RR)^=ICTENDNT/* AT END OF MOD SECT    */ 02533000
*         &LRMIDASM=OFF;            /* AN ASSEM ENTRY MATCH NOT FND. */ 02534000
         LA    RR,1                                                0625 02535000
         B     @DE00625                                            0625 02536000
@DL00625 DS    0H                                                  0626 02537000
*     IF ICTMNAME(RR)=CMOD->ICTMNAME(1)/* ELEMENTS WITH SAME NAME    */ 02538000
*         &ICTPPTR(RR)^=CPTF        /* NOT FROM "CURRENT" SYSMOD     */ 02539000
*         &ICTMISEL(RR)=ON          /* OTHER ELEMENT IS SELECTED     */ 02540000
*       THEN                                                       0626 02541000
         LR    @08,RR                                              0626 02542000
         MH    @08,@CH02013                                        0626 02543000
         L     @03,CCAICMOD(,CCAPTR)                               0626 02544000
         ST    @08,@TF00001                                        0626 02545000
         ALR   @08,@03                                             0626 02546000
         AL    @08,@CF02036                                        0626 02547000
         L     @01,CMOD                                            0626 02548000
         CLC   ICTMNAME(8,@08),ICTMNAME(@01)                       0626 02549000
         BNE   @RF00626                                            0626 02550000
         L     @08,@PC00001+4                                      0626 02551000
         L     @01,@TF00001                                        0626 02552000
         AL    @01,@CF02034                                        0626 02553000
         L     @15,ICTPPTR-96(@01,@03)                             0626 02554000
         C     @15,CPTF(,@08)                                      0626 02555000
         BE    @RF00626                                            0626 02556000
         LR    @08,@03                                             0626 02557000
         AL    @08,@TF00001                                        0626 02558000
         AL    @08,@CF02033                                        0626 02559000
         TM    ICTMISEL-11(@08),B'10000000'                        0626 02560000
         BNO   @RF00626                                            0626 02561000
*       DO;                                                        0627 02562000
*         CALL INTRSECT(CMOD,ADDR(ICTMOD(RR)),ITYPE);/* COMPARE TYPES*/ 02563000
         L     @08,@TF00001                                        0628 02564000
         AL    @03,@CF02036                                        0628 02565000
         LA    @08,ICTMOD(@08,@03)                                 0628 02566000
         ST    @08,@AFTEMPS                                        0628 02567000
         LA    @01,@AL00628                                        0628 02568000
         BAL   @14,INTRSECT                                        0628 02569000
*         IF ITYPE=REPREP           /* REPLACEMENT TO REPLACEMENT    */ 02570000
*             |ITYPE=REPUPD         /* REPLACEMENT TO UPDATE         */ 02571000
*             |ITYPE=UPDREP         /* UPDATE TO REPLACEMENT         */ 02572000
*             |ITYPE=UPDUPD         /* UPDATE TO UPDATE              */ 02573000
*           THEN                                                   0629 02574000
         CLI   ITYPE,1                                             0629 02575000
         BE    @RT00629                                            0629 02576000
         CLI   ITYPE,2                                             0629 02577000
         BE    @RT00629                                            0629 02578000
         CLI   ITYPE,4                                             0629 02579000
         BE    @RT00629                                            0629 02580000
         CLI   ITYPE,8                                             0629 02581000
         BNE   @RF00629                                            0629 02582000
@RT00629 DS    0H                                                  0630 02583000
*           DO;                                                    0630 02584000
*                                                                  0630 02585000
*             /*******************************************************/ 02586000
*             /*                                                     */ 02587000
*             /* ANOTHER SELECTED VERSION OF THE ELEMENT FOUND       */ 02588000
*             /*                                                     */ 02589000
*             /*******************************************************/ 02590000
*                                                                  0631 02591000
*             CMOD->ICTMICHN(1)=ICTMICHN(RR);/* MAKE THIS ELEMENT'S     02592000
*                                      MODID LIST THE SAME AS THAT OF   02593000
*                                      THE PREVIOUSLY SELECTED ONE   */ 02594000
         LR    @08,RR                                              0631 02595000
         MH    @08,@CH02013                                        0631 02596000
         L     @03,CCAICMOD(,CCAPTR)                               0631 02597000
         ST    @08,@TF00001                                        0631 02598000
         ALR   @08,@03                                             0631 02599000
         AL    @08,@CF02047                                        0631 02600000
         MVC   @TF00002(4),ICTMICHN-104(@08)                       0631 02601000
         L     @08,@TF00002                                        0631 02602000
         ST    @08,@TF00002                                        0631 02603000
         L     @01,CMOD                                            0631 02604000
         MVC   ICTMICHN(4,@01),@TF00002                            0631 02605000
*             IF ICTMIDEL(RR)=OFF   /* PREV. VERSION NOT DELETED     */ 02606000
*               THEN                                               0632 02607000
         LR    @08,@03                                             0632 02608000
         AL    @08,@TF00001                                        0632 02609000
         AL    @08,@CF02033                                        0632 02610000
         TM    ICTMIDEL-11(@08),B'01000000'                        0632 02611000
         BNZ   @RF00632                                            0632 02612000
*               DO;                                                0633 02613000
*                 LASTFMID=ICTMFMID(RR);/* SAVE FMID FROM ICT ELEM.  */ 02614000
         LR    @08,@03                                             0634 02615000
         AL    @08,@TF00001                                        0634 02616000
         AL    @08,@CF02037                                        0634 02617000
         MVC   LASTFMID(7),ICTMFMID-88(@08)                        0634 02618000
*                 IF ICTMRMID(RR)^=NULLPTF#/* VALID RMID             */ 02619000
*                   THEN                                           0635 02620000
         LR    @08,@03                                             0635 02621000
         AL    @08,@TF00001                                        0635 02622000
         AL    @08,@CF02048                                        0635 02623000
         CLC   ICTMRMID-80(7,@08),@CC01719                         0635 02624000
         BE    @RF00635                                            0635 02625000
*                   DO;                                            0636 02626000
*                     LASTRMID=ICTMRMID(RR);/* SAVE RMID             */ 02627000
         LR    @08,@03                                             0637 02628000
         AL    @08,@TF00001                                        0637 02629000
         AL    @08,@CF02048                                        0637 02630000
         MVC   LASTRMID(7),ICTMRMID-80(@08)                        0637 02631000
*                     LREPELM@=ADDR(ICTMOD(RR));/* POINT TO ICT REPL */ 02632000
         L     @08,@TF00001                                        0638 02633000
         AL    @08,@CF02036                                        0638 02634000
         LA    @08,ICTMOD(@08,@03)                                 0638 02635000
         ST    @08,LREPELM@                                        0638 02636000
*                     IF ICTMASM(RR)=ON/* ASSEM ENTRY                */ 02637000
*                       THEN                                       0639 02638000
         AL    @03,@TF00001                                        0639 02639000
         AL    @03,@CF02049                                        0639 02640000
         TM    ICTMASM-9(@03),B'01000000'                          0639 02641000
         BNO   @RF00639                                            0639 02642000
*                       LRMIDASM=ON;/* LASTRMID IS RESULT OF ASSEM.  */ 02643000
         OI    LRMIDASM,B'10000000'                                0640 02644000
*                   END;                                           0641 02645000
*               END;                                               0642 02646000
*             ELSE                                                 0643 02647000
*               DELETED=ON;         /* PREVIOUS VERSION IS DELETED   */ 02648000
         B     @RC00632                                            0643 02649000
@RF00632 OI    DELETED,B'01000000'                                 0643 02650000
*           END;                                                   0644 02651000
@RC00632 DS    0H                                                  0645 02652000
*       END;                                                       0645 02653000
@RF00629 DS    0H                                                  0646 02654000
*   END;                                                           0646 02655000
@RF00626 AH    RR,@CH00067                                         0646 02656000
@DE00625 LR    @08,RR                                              0646 02657000
         MH    @08,@CH02013                                        0646 02658000
         L     @03,CCAICMOD(,CCAPTR)                               0646 02659000
         ALR   @03,@08                                             0646 02660000
         AL    @03,@CF02036                                        0646 02661000
         MVC   @TF00001(4),ICTMEND(@03)                            0646 02662000
         L     @08,@TF00001                                        0646 02663000
         CL    @08,ICTENDNT                                        0646 02664000
         BE    @DC00625                                            0646 02665000
         TM    LRMIDASM,B'10000000'                                0646 02666000
         BZ    @DL00625                                            0646 02667000
@DC00625 DS    0H                                                  0647 02668000
*   IF DELETED=OFF                  /* NOT DELETED IN ICT            */ 02669000
*       &LREPELM@=0                 /* LAST REPLACEMENT NOT FOUND IN    02670000
*                                      ICT                           */ 02671000
*     THEN                                                         0647 02672000
         TM    DELETED,B'01000000'                                 0647 02673000
         BNZ   @RF00647                                            0647 02674000
         L     @08,LREPELM@                                        0647 02675000
         LTR   @08,@08                                             0647 02676000
         BNZ   @RF00647                                            0647 02677000
*     DO;                                                          0648 02678000
*                                                                  0648 02679000
*       /*************************************************************/ 02680000
*       /*                                                           */ 02681000
*       /* NO REPLACEMENT FOUND IN ICT ... RMID MUST COME FROM (A)CDS*/ 02682000
*       /* MODID LIST                                                */ 02683000
*       /*                                                           */ 02684000
*       /*************************************************************/ 02685000
*                                                                  0649 02686000
*       RESPECIFY                                                  0649 02687000
*         ICTMOD BASED(CMOD);       /* ADDRESS "CURRENT" ELEMENT     */ 02688000
*       RESPECIFY                                                  0650 02689000
*         ICTMIDLS BASED(ICTMICHN(1));/* ADDRESS "CURRENT" ELEMENT'S    02690000
*                                      MODID LIST                    */ 02691000
*                                                                  0650 02692000
*       /*************************************************************/ 02693000
*       /*                                                           */ 02694000
*       /* GO THRU ELEMENT'S (A)CDS MODID LIST                       */ 02695000
*       /*                                                           */ 02696000
*       /*************************************************************/ 02697000
*                                                                  0651 02698000
*       DO RR=1 BY 1 WHILE ICTMIDND(RR)^=ICTENDIX;                 0651 02699000
         LA    RR,1                                                0651 02700000
         B     @DE00651                                            0651 02701000
@DL00651 DS    0H                                                  0652 02702000
*         IF ICTMIDTY(RR)=ICTMIDFM  /* FMID-TYPE MODID ON (A)CDS     */ 02703000
*             &LASTFMID=NULLPTF#    /* FMID MODID NOT FOUND IN ICT   */ 02704000
*           THEN                                                   0652 02705000
         LR    @08,RR                                              0652 02706000
         SLA   @08,3                                               0652 02707000
         L     @03,CMOD                                            0652 02708000
         MVC   @TF00001(4),ICTMICHN(@03)                           0652 02709000
         L     @03,@TF00001                                        0652 02710000
         ST    @08,@TF00001                                        0652 02711000
         ALR   @08,@03                                             0652 02712000
         BCTR  @08,0                                               0652 02713000
         TM    ICTMIDTY-7(@08),B'00000010'                         0652 02714000
         BNO   @RF00652                                            0652 02715000
         TM    ICTMIDTY-7(@08),B'00000001'                         0652 02716000
         BNZ   @RF00652                                            0652 02717000
         CLC   LASTFMID(7),@CC01719                                0652 02718000
         BNE   @RF00652                                            0652 02719000
*           LASTFMID=ICTMODID(RR);  /* LAST FMID SYSMOD-ID           */ 02720000
         AL    @03,@TF00001                                        0653 02721000
         AL    @03,@CF02046                                        0653 02722000
         MVC   LASTFMID(7),ICTMODID(@03)                           0653 02723000
*         IF ICTMIDTY(RR)=ICTMIDRM  /* RMID-TYPE MODID ON (A)CDS     */ 02724000
*           THEN                                                   0654 02725000
@RF00652 LR    @08,RR                                              0654 02726000
         SLA   @08,3                                               0654 02727000
         L     @03,CMOD                                            0654 02728000
         MVC   @TF00001(4),ICTMICHN(@03)                           0654 02729000
         L     @03,@TF00001                                        0654 02730000
         ST    @08,@TF00001                                        0654 02731000
         ALR   @08,@03                                             0654 02732000
         BCTR  @08,0                                               0654 02733000
         TM    ICTMIDTY-7(@08),B'00000001'                         0654 02734000
         BNO   @RF00654                                            0654 02735000
         TM    ICTMIDTY-7(@08),B'00000010'                         0654 02736000
         BNZ   @RF00654                                            0654 02737000
*           DO;                                                    0655 02738000
*             LASTRMID=ICTMODID(RR);/* LAST RMID SYSMOD-ID           */ 02739000
         LR    @08,@03                                             0656 02740000
         AL    @08,@TF00001                                        0656 02741000
         AL    @08,@CF02046                                        0656 02742000
         MVC   LASTRMID(7),ICTMODID(@08)                           0656 02743000
*             IF ICTMIDAM(RR)=ON    /* RMID RESULT OF ASSEMBLY       */ 02744000
*               THEN                                               0657 02745000
         AL    @03,@TF00001                                        0657 02746000
         BCTR  @03,0                                               0657 02747000
         TM    ICTMIDAM-7(@03),B'00000100'                         0657 02748000
         BNO   @RF00657                                            0657 02749000
*               LRMIDASM=ON;        /* SET FLAG                      */ 02750000
         OI    LRMIDASM,B'10000000'                                0658 02751000
*           END;                                                   0659 02752000
@RF00657 DS    0H                                                  0660 02753000
*       END;                                                       0660 02754000
@RF00654 AH    RR,@CH00067                                         0660 02755000
@DE00651 LR    @08,RR                                              0660 02756000
         SLA   @08,3                                               0660 02757000
         L     @03,CMOD                                            0660 02758000
         MVC   @TF00001(4),ICTMICHN(@03)                           0660 02759000
         L     @03,@TF00001                                        0660 02760000
         AL    @03,@CF02046                                        0660 02761000
         L     @08,ICTMIDND(@08,@03)                               0660 02762000
         CL    @08,ICTENDIX                                        0660 02763000
         BNE   @DL00651                                            0660 02764000
*     END;                                                         0661 02765000
*   RETURN;                                                        0662 02766000
@EL00006 DS    0H                                                  0662 02767000
@EF00006 DS    0H                                                  0662 02768000
@ER00006 LM    @14,@12,@SA00006                                    0662 02769000
         BR    @14                                                 0662 02770000
*   END GETMIDS;                                                   0663 02771000
         B     @EL00006                                            0663 02772000
*                                                                  0664 02773000
*/********************************************************************/ 02774000
*/*                                                                  */ 02775000
*/*    UMIDCHK - UMID CHECK FOR REPLACEMENT AND UPDATE-TYPE          */ 02776000
*/*               ELEMENTS:                                          */ 02777000
*/*                                                                  */ 02778000
*/*             - CHECK THAT ALL UPDATES (UMIDS) TO THE LAST SELECTED*/ 02779000
*/*               VERSION OF THE "CURRENT" ELEMENT ARE PREREQD OR    */ 02780000
*/*               SUPERSEDED.  NOTE THAT UPDATES TO AN ELEMENT ARE   */ 02781000
*/*               FOUND IN BOTH THE ICT MOD SECTION AND THE (A)CDS   */ 02782000
*/*               MODID LIST ASSOCIATED WITH THE "CURRENT" ELEMENT.  */ 02783000
*/*                                                                  */ 02784000
*/*               IF THE LAST REPLACEMENT TO AN ELEMENT IS IN THE    */ 02785000
*/*               ICT (LREPELM@^=0), ONLY UPDATES TO THE ELEMENT     */ 02786000
*/*               WHICH ARE IN THE ICT ARE CHECKED.  IF THE LAST     */ 02787000
*/*               REPLACEMENT TO AN ELEMENT IS THE (A)CDS VERSION,   */ 02788000
*/*               UPDATES IN THE ICT AND UPDATES IN THE (A)CDS MODID */ 02789000
*/*               LIST ARE CHECKED.                                  */ 02790000
*/*                                                                  */ 02791000
*/*                                                                  */ 02792000
*/*             - FOR REPLACEMENT ELEMENTS AND UPDATE ELEMENTS FOR   */ 02793000
*/*               WHICH THERE IS NO REPLACEMENT IN THE ICT, THE      */ 02794000
*/*               MODIDS IN THE (A)CDS MODID LIST ARE CHECKED TO     */ 02795000
*/*               DETERMINE WHETHER THEY ARE PREREQ'D OR SUP'D BY    */ 02796000
*/*               THE SYSMOD SUPPLYING THE "CURRENT" ELEMENT.        */ 02797000
*/*                                                                  */ 02798000
*/*               ICTMIDPL IS SET IN THE MODID LIST ENTRY IF THE     */ 02799000
*/*               MODID IS PREREQ'D OR SUP'D BY THE SYSMOD SUPPLYING */ 02800000
*/*               THE "CURRENT" ELEMENT.                             */ 02801000
*/*                                                                  */ 02802000
*/*             - MESSAGE HMA319I IS ISSUED FOR ANY UPDATE-MODID     */ 02803000
*/*               (UMID) IN EITHER THE ICT OR (A)CDS MODID LIST      */ 02804000
*/*               WHICH IS NOT PREREQ'D OR SUP'D AS THE "CURRENT"    */ 02805000
*/*               ELEMENT IS POTENTIALLY DOWN-LEVELING THE INTER-    */ 02806000
*/*               SECTED-WITH ELEMENT.                               */ 02807000
*/*                                                                  */ 02808000
*/*             - SET UMIDERR ON  IF ANY UMIDS  ARE NOT PREREQD/SUPD */ 02809000
*/*                                                                  */ 02810000
*/*    CONDITIONS UPON ENTRY:                                        */ 02811000
*/*                                                                  */ 02812000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 02813000
*/*                                                                  */ 02814000
*/*     * REPFLG  -  '1' IF "CURRENT" ELEMENT IS A REPLACEMENT-TYPE  */ 02815000
*/*     * UPDFLG  -  '1' IF "CURRENT" ELEMENT IS AN UPDATE-TYPE      */ 02816000
*/*                                                                  */ 02817000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 02818000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 02819000
*/*                                                                  */ 02820000
*/*     * LASTRMID - CONTAINS THE NAME OF THE SYSMOD WHICH LAST      */ 02821000
*/*                  REPLACED THE "CURRENT" ELEMENT.                 */ 02822000
*/*                                                                  */ 02823000
*/*     * LREPELM@ -  0  => LAST REPLACEMENT IS (A)CDS VERSION OF    */ 02824000
*/*                         THE ELEMENT ... NO REPLACEMENT IN ICT    */ 02825000
*/*                                                                  */ 02826000
*/*                  ^0  - LAST REPLACEMENT IS ICT VERSION OF THE    */ 02827000
*/*                         ELEMENT (LREPELM@ POINTS TO ICT MOD      */ 02828000
*/*                         SECT ENTRY REPRESENTING LAST REPLACEMENT)*/ 02829000
*/*                                                                  */ 02830000
*/*     * RMIDERR  - '1' => ELEMENT RMID ERROR                       */ 02831000
*/*                  '0' => NO RMID ERROR                            */ 02832000
*/*                                                                  */ 02833000
*/*     * MGPTYPE  - SET TO THE VALUE FOR THE DESIRED MESSAGE        */ 02834000
*/*                  SEVERITY FOR HMA382I                            */ 02835000
*/*                  MGPWARN - ISSUE WARNING MESSAGE  (RC = 4)       */ 02836000
*/*                  MGPERR  - ISSUE ERROR MESSAGE  (RC = 8)         */ 02837000
*/*                                                                  */ 02838000
*/*    CONDITIONS UPON EXIT:                                         */ 02839000
*/*                                                                  */ 02840000
*/*     * UMIDERR -  0 - ALL UMIDS CHECKED "OK"                      */ 02841000
*/*                  1 - SOME UMIDS WERE NOT PREREQD AND/OR SUPD     */ 02842000
*/*                                                                  */ 02843000
*/*     * ICTMIDPL - SET/CLEARED IN (A)CDS MODID LIST                */ 02844000
*/*                  (FOR FMID, RMID AND UMID MODIDS)                */ 02845000
*/*                                                                  */ 02846000
*/*                                                                  */ 02847000
*/*                                                                  */ 02848000
*/********************************************************************/ 02849000
*                                                                  0664 02850000
*UMIDCHK:                                                          0664 02851000
*   PROC(UMIDMSG);                                                 0664 02852000
UMIDCHK  STM   @14,@04,@SA00007                                    0664 02853000
         STM   @06,@12,@SA00007+28                                 0664 02854000
         MVC   @PC00007(4),0(@01)                                  0664 02855000
*   DCL                                                            0665 02856000
*     UMIDMSG CHAR(1);              /* 'Y' - ISSUE MESSAGES .........   02857000
*                                      'N' - DO NOT ISSUE MESSAGES . */ 02858000
*   DCL                                                            0666 02859000
*     KK FIXED(15);                 /* LOCAL INDEX                   */ 02860000
*   DCL                                                            0667 02861000
*     UMIDSMID CHAR(7);             /* UMID SYSMOD-ID                */ 02862000
*   RESPECIFY                                                      0668 02863000
*     ICTPTF BASED(CPTF);           /* "CURRENT" SYSMOD              */ 02864000
*   RESPECIFY                                                      0669 02865000
*     ICTMOD BASED(CCAICMOD);       /* THE ENTIRE ICT MOD SECTION    */ 02866000
*                                                                  0670 02867000
*   /*****************************************************************/ 02868000
*   /*                                                               */ 02869000
*   /* GO THRU ALL ENTRIES IN THE ICT MOD SECTION LOOKING FOR OTHER  */ 02870000
*   /* UPDATES TO THE "CURRENT" ELEMENT                              */ 02871000
*   /*                                                               */ 02872000
*   /*****************************************************************/ 02873000
*                                                                  0670 02874000
*   VPART#3=MSGSEL;                 /* SET "SELECTED" IN HMA319 MSG  */ 02875000
         MVC   VPART#3(8),@CC01841                                 0670 02876000
*   VPART#4=MSGUMID;                /* SET "UMID" IN HMA319 MSG      */ 02877000
         MVC   VPART#4(8),@CC01839                                 0671 02878000
*   DO KK=1 BY 1 WHILE ICTMEND(KK)^=ICTENDNT;                      0672 02879000
         LA    KK,1                                                0672 02880000
         B     @DE00672                                            0672 02881000
@DL00672 DS    0H                                                  0673 02882000
*     IF ICTMISEL(KK)=ON            /* SELECTED ?                    */ 02883000
*         &ICTMNAME(KK)=CMOD->ICTMNAME(1)/* NAME = "CURRENT" ELEMENT */ 02884000
*         &ADDR(ICTMOD(KK))^=CMOD   /* NOT SELF                      */ 02885000
*       THEN                                                       0673 02886000
         LR    @08,KK                                              0673 02887000
         MH    @08,@CH02013                                        0673 02888000
         L     @04,CCAICMOD(,CCAPTR)                               0673 02889000
         ST    @08,@TF00001                                        0673 02890000
         ALR   @08,@04                                             0673 02891000
         AL    @08,@CF02033                                        0673 02892000
         TM    ICTMISEL-11(@08),B'10000000'                        0673 02893000
         BNO   @RF00673                                            0673 02894000
         L     @08,CMOD                                            0673 02895000
         LR    @03,@04                                             0673 02896000
         AL    @03,@TF00001                                        0673 02897000
         AL    @03,@CF02036                                        0673 02898000
         CLC   ICTMNAME(8,@03),ICTMNAME(@08)                       0673 02899000
         BNE   @RF00673                                            0673 02900000
         L     @03,@TF00001                                        0673 02901000
         AL    @04,@CF02036                                        0673 02902000
         LA    @04,ICTMOD(@03,@04)                                 0673 02903000
         CR    @04,@08                                             0673 02904000
         BE    @RF00673                                            0673 02905000
*       DO;                                                        0674 02906000
*         CALL INTRSECT(CMOD,       /* "CURRENT" ELEMENT             */ 02907000
*             ADDR(ICTMOD(KK)),     /* ICT-ELEMENT                   */ 02908000
*             ITYPE);               /* ELEMENT TYPES (RETURNED)      */ 02909000
         ST    @04,@AFTEMPS+4                                      0675 02910000
         LA    @01,@AL00675                                        0675 02911000
         BAL   @14,INTRSECT                                        0675 02912000
*         IF ITYPE=REPUPD           /* REPLACEMENT TO UPDATE         */ 02913000
*             |ITYPE=UPDUPD         /* UPDATE TO UPDATE              */ 02914000
*           THEN                                                   0676 02915000
         CLI   ITYPE,2                                             0676 02916000
         BE    @RT00676                                            0676 02917000
         CLI   ITYPE,8                                             0676 02918000
         BNE   @RF00676                                            0676 02919000
@RT00676 DS    0H                                                  0677 02920000
*           DO;                                                    0677 02921000
*             UMIDSMID=ICTPPTR(KK)->ICTPTFS(1);/* NAME OF SYSMOD   0678 02922000
*                                      WHICH SUPPLIED UPDATE ELEMENT    02923000
*                                      FOUND IN ICT                  */ 02924000
         LR    @08,KK                                              0678 02925000
         MH    @08,@CH02013                                        0678 02926000
         L     @04,CCAICMOD(,CCAPTR)                               0678 02927000
         AL    @04,@CF02034                                        0678 02928000
         L     @08,ICTPPTR-96(@08,@04)                             0678 02929000
         MVC   UMIDSMID(7),ICTPTFS(@08)                            0678 02930000
*             CALL HMASMTPS(CPTF,   /* "CURRENT" SYSMOD              */ 02931000
*                 UMIDSMID,         /* UPDATE FOUND IN ICT           */ 02932000
*                 TPSRTN);          /* CHECK PRE/SUP                 */ 02933000
         MVC   @AL00001+4(8),@AL00679                              0679 02934000
         L     @08,@PC00001+4                                      0679 02935000
         ST    @08,@AL00001                                        0679 02936000
         L     @15,@CV01714                                        0679 02937000
         LA    @01,@AL00001                                        0679 02938000
         BALR  @14,@15                                             0679 02939000
*             IF TPSRTN^=PRESUP     /* PRE/SUP RELATIONSHIP          */ 02940000
*               THEN                                               0680 02941000
         CLI   TPSRTN,232                                          0680 02942000
         BE    @RF00680                                            0680 02943000
*               DO;                                                0681 02944000
*                                                                  0681 02945000
*                 /***************************************************/ 02946000
*                 /*                                                 */ 02947000
*                 /* THE CURRENT ELEMENT DOES NOT PREREQ OR SUP AN   */ 02948000
*                 /* UPDATE FOUND IN THE ICT                         */ 02949000
*                 /*                                                 */ 02950000
*                 /***************************************************/ 02951000
*                                                                  0682 02952000
*                 UMIDERR=ON;       /* SET UMID ERROR FLAG           */ 02953000
         OI    UMIDERR,B'01000000'                                 0682 02954000
*                 IF UMIDMSG=MSG    /* MESSAGES SHOULD BE ISSUED     */ 02955000
*                   THEN                                           0683 02956000
         L     @08,@PC00007                                        0683 02957000
         CLI   UMIDMSG(@08),C'Y'                                   0683 02958000
         BNE   @RF00683                                            0683 02959000
*                   DO;                                            0684 02960000
*                     IF MSG382I=OFF/* HMA382I MSG NOT ISSUED        */ 02961000
*                       THEN                                       0685 02962000
         TM    MSG382I,B'00100000'                                 0685 02963000
         BNZ   @RF00685                                            0685 02964000
*                       DO;                                        0686 02965000
*                         CALL ERRMSG(HMA382I,NOPART);/* ISSUE     0687 02966000
*                                      HMA382I                       */ 02967000
         LA    @01,@AL00687                                        0687 02968000
         BAL   @14,ERRMSG                                          0687 02969000
*                         MSG382I=ON;/* SET HMA382I MSG ISSUED FLAG  */ 02970000
         OI    MSG382I,B'00100000'                                 0688 02971000
*                       END;                                       0689 02972000
*                     VPART#5=UMIDSMID;/* ICT UMID SYSMOD-ID IN MSG  */ 02973000
@RF00685 MVI   VPART#5+7,C' '                                      0690 02974000
         MVC   VPART#5(7),UMIDSMID                                 0690 02975000
*                     CALL ERRMSG(HMA319I,NOPART);/* ISSUE MESSAGE   */ 02976000
         LA    @01,@AL00691                                        0691 02977000
         BAL   @14,ERRMSG                                          0691 02978000
*                   END;                                           0692 02979000
*               END;                                               0693 02980000
@RF00683 DS    0H                                                  0694 02981000
*           END;                                                   0694 02982000
@RF00680 DS    0H                                                  0695 02983000
*       END;                                                       0695 02984000
@RF00676 DS    0H                                                  0696 02985000
*   END;                                                           0696 02986000
@RF00673 AH    KK,@CH00067                                         0696 02987000
@DE00672 LR    @08,KK                                              0696 02988000
         MH    @08,@CH02013                                        0696 02989000
         L     @04,CCAICMOD(,CCAPTR)                               0696 02990000
         ALR   @04,@08                                             0696 02991000
         AL    @04,@CF02036                                        0696 02992000
         MVC   @TF00001(4),ICTMEND(@04)                            0696 02993000
         L     @08,@TF00001                                        0696 02994000
         CL    @08,ICTENDNT                                        0696 02995000
         BNE   @DL00672                                            0696 02996000
*                                                                  0697 02997000
*   /*****************************************************************/ 02998000
*   /*                                                               */ 02999000
*   /* DETERMINE WHETHER THE "CURRENT" SYSMOD PREREQS OR SUPERSEDES  */ 03000000
*   /* THE RMID AND ALL UMIDS FOUND IN THE (A)CDS MODID LIST         */ 03001000
*   /* ASSOCIATED WITH THE "CURRENT" ELEMENT. ISSUE MSG HMA319 FOR   */ 03002000
*   /* UMID CHECKS ONLY ... RMID CHECK MESSAGES HAVE ALREADY BEEN    */ 03003000
*   /* ISSUED AT THIS POINT.                                         */ 03004000
*   /*                                                               */ 03005000
*   /*****************************************************************/ 03006000
*                                                                  0697 03007000
*   VPART#3=MSGXCDS;                /* "SMPCDS" OR "SMPACDS" FOR   0697 03008000
*                                      HMA319I MSG                   */ 03009000
         MVC   VPART#3(8),MSGXCDS                                  0697 03010000
*   VPART#4=MSGUMID;                /* "UMID" FOR HMA319I MSG        */ 03011000
         MVC   VPART#4(8),@CC01839                                 0698 03012000
*   RESPECIFY                                                      0699 03013000
*     ICTMOD BASED(CMOD);           /* "CURRENT" ELEMENT             */ 03014000
*   RESPECIFY                                                      0700 03015000
*     ICTMIDLS BASED(ICTMICHN(1));  /* "CURRENT" ELEMENT'S MODID LIST*/ 03016000
*                                                                  0700 03017000
*   /*****************************************************************/ 03018000
*   /*                                                               */ 03019000
*   /* GO THRU ELEMENT'S MODID LIST                                  */ 03020000
*   /*                                                               */ 03021000
*   /*****************************************************************/ 03022000
*                                                                  0701 03023000
*   DO KK=1 BY 1 WHILE ICTMIDND(KK)^=ICTENDIX;                     0701 03024000
         LA    KK,1                                                0701 03025000
         B     @DE00701                                            0701 03026000
@DL00701 DS    0H                                                  0702 03027000
*     IF ICTMIDTY(KK)=ICTMIDFM      /* FMID MODID                    */ 03028000
*       THEN                                                       0702 03029000
         LR    @08,KK                                              0702 03030000
         SLA   @08,3                                               0702 03031000
         L     @04,CMOD                                            0702 03032000
         MVC   @TF00001(4),ICTMICHN(@04)                           0702 03033000
         L     @04,@TF00001                                        0702 03034000
         ST    @08,@TF00001                                        0702 03035000
         ALR   @08,@04                                             0702 03036000
         BCTR  @08,0                                               0702 03037000
         TM    ICTMIDTY-7(@08),B'00000010'                         0702 03038000
         BNO   @RF00702                                            0702 03039000
         TM    ICTMIDTY-7(@08),B'00000001'                         0702 03040000
         BNZ   @RF00702                                            0702 03041000
*       ICTMIDPL(KK)=ON;            /* FMID IS ALWAYS "OK"           */ 03042000
*                                                                  0703 03043000
         AL    @04,@TF00001                                        0703 03044000
         BCTR  @04,0                                               0703 03045000
         OI    ICTMIDPL-7(@04),B'00100000'                         0703 03046000
*     /***************************************************************/ 03047000
*     /*                                                             */ 03048000
*     /* DETERMINE WHETHER MODID IS PREREQ'D OR SUP'D BY SYSMOD      */ 03049000
*     /*                                                             */ 03050000
*     /***************************************************************/ 03051000
*                                                                  0704 03052000
*     IF ICTMIDTY(KK)=ICTMIDUP      /* UMID MODID                    */ 03053000
*         |ICTMIDTY(KK)=ICTMIDRM    /* RMID MODID                    */ 03054000
*       THEN                                                       0704 03055000
@RF00702 LR    @08,KK                                              0704 03056000
         SLA   @08,3                                               0704 03057000
         L     @04,CMOD                                            0704 03058000
         MVC   @TF00001(4),ICTMICHN(@04)                           0704 03059000
         L     @04,@TF00001                                        0704 03060000
         ST    @08,@TF00001                                        0704 03061000
         ALR   @08,@04                                             0704 03062000
         BCTR  @08,0                                               0704 03063000
         TM    ICTMIDTY-7(@08),B'00000011'                         0704 03064000
         BZ    @RT00704                                            0704 03065000
         AL    @04,@TF00001                                        0704 03066000
         BCTR  @04,0                                               0704 03067000
         TM    ICTMIDTY-7(@04),B'00000001'                         0704 03068000
         BNO   @RF00704                                            0704 03069000
         TM    ICTMIDTY-7(@04),B'00000010'                         0704 03070000
         BNZ   @RF00704                                            0704 03071000
@RT00704 DS    0H                                                  0705 03072000
*       DO;                                                        0705 03073000
*         IF LREPELM@=0             /* NO REPLACEMENT IN ICT         */ 03074000
*             &ICTMIDTY(KK)=ICTMIDRM/* THIS IS (A)CDS RMID           */ 03075000
*           THEN                                                   0706 03076000
         L     @08,LREPELM@                                        0706 03077000
         LTR   @08,@08                                             0706 03078000
         BNZ   @RF00706                                            0706 03079000
         LR    @08,KK                                              0706 03080000
         SLA   @08,3                                               0706 03081000
         L     @04,CMOD                                            0706 03082000
         MVC   @TF00001(4),ICTMICHN(@04)                           0706 03083000
         L     @04,@TF00001                                        0706 03084000
         ALR   @04,@08                                             0706 03085000
         BCTR  @04,0                                               0706 03086000
         TM    ICTMIDTY-7(@04),B'00000001'                         0706 03087000
         BNO   @RF00706                                            0706 03088000
         TM    ICTMIDTY-7(@04),B'00000010'                         0706 03089000
         BNZ   @RF00706                                            0706 03090000
*           DO;                     /* THIS RMID WAS ALREADY CHECKED */ 03091000
*             IF RMIDERR=OFF        /* ELEMENT DID NOT HAVE RMID ERR */ 03092000
*               THEN                                               0708 03093000
         TM    RMIDERR,B'10000000'                                 0708 03094000
         BNZ   @RF00708                                            0708 03095000
*               TPSRTN=PRESUP;      /* INDICATE RMID WAS PRE OR SUPD */ 03096000
         MVI   TPSRTN,X'E8'                                        0709 03097000
*             ELSE                                                 0710 03098000
*               TPSRTN=INVALID;     /* INDICATE RMID NOT PRE OR SUPD */ 03099000
         B     @RC00708                                            0710 03100000
@RF00708 MVI   TPSRTN,X'D5'                                        0710 03101000
*           END;                                                   0711 03102000
*         ELSE                                                     0712 03103000
*           CALL HMASMTPS(CPTF,     /* "CURRENT" SYSMOD              */ 03104000
*               ICTMODID(KK),       /* MODID FROM (A)CDS MODID LIST  */ 03105000
*               TPSRTN);            /* CHECK PRE/SUP OF MODID BY SMD */ 03106000
*                                                                  0712 03107000
         B     @RC00706                                            0712 03108000
@RF00706 L     @08,@PC00001+4                                      0712 03109000
         ST    @08,@AL00001                                        0712 03110000
         LR    @08,KK                                              0712 03111000
         SLA   @08,3                                               0712 03112000
         L     @04,CMOD                                            0712 03113000
         MVC   @TF00001(4),ICTMICHN(@04)                           0712 03114000
         L     @04,@TF00001                                        0712 03115000
         AL    @04,@CF02046                                        0712 03116000
         LA    @08,ICTMODID(@08,@04)                               0712 03117000
         ST    @08,@AL00001+4                                      0712 03118000
         LA    @08,TPSRTN                                          0712 03119000
         ST    @08,@AL00001+8                                      0712 03120000
         L     @15,@CV01714                                        0712 03121000
         LA    @01,@AL00001                                        0712 03122000
         BALR  @14,@15                                             0712 03123000
*         /***********************************************************/ 03124000
*         /*                                                         */ 03125000
*         /* SET OR CLEAR MODID PRE/SUP FLAG IN MODID LIST ENTRY     */ 03126000
*         /*                                                         */ 03127000
*         /***********************************************************/ 03128000
*                                                                  0713 03129000
*         IF REPFLG=ON              /* REPL ELEM. BEING PROCESSED    */ 03130000
*             |(UPDFLG=ON           /* UPDATE ELEM. BEING PROCESSED  */ 03131000
*             &LREPELM@=0)          /* ... WITH NO REPL IN ICT       */ 03132000
*           THEN                                                   0713 03133000
@RC00706 TM    REPFLG,B'00001000'                                  0713 03134000
         BO    @RT00713                                            0713 03135000
         TM    UPDFLG,B'00000100'                                  0713 03136000
         BNO   @RF00713                                            0713 03137000
         L     @08,LREPELM@                                        0713 03138000
         LTR   @08,@08                                             0713 03139000
         BNZ   @RF00713                                            0713 03140000
@RT00713 DS    0H                                                  0714 03141000
*           DO;                                                    0714 03142000
*             IF TPSRTN^=PRESUP     /* DOES NOT PRE/SUP MODID        */ 03143000
*               THEN                                               0715 03144000
         CLI   TPSRTN,232                                          0715 03145000
         BE    @RF00715                                            0715 03146000
*               ICTMIDPL(KK)=OFF;   /* CLEAR MODID PRE/SUP FLAG      */ 03147000
         LR    @08,KK                                              0716 03148000
         SLA   @08,3                                               0716 03149000
         L     @04,CMOD                                            0716 03150000
         MVC   @TF00001(4),ICTMICHN(@04)                           0716 03151000
         L     @04,@TF00001                                        0716 03152000
         ALR   @04,@08                                             0716 03153000
         BCTR  @04,0                                               0716 03154000
         NI    ICTMIDPL-7(@04),B'11011111'                         0716 03155000
*             ELSE                                                 0717 03156000
*               ICTMIDPL(KK)=ON;    /* SET MODID PRE/SUP FLAG        */ 03157000
         B     @RC00715                                            0717 03158000
@RF00715 LR    @08,KK                                              0717 03159000
         SLA   @08,3                                               0717 03160000
         L     @04,CMOD                                            0717 03161000
         MVC   @TF00001(4),ICTMICHN(@04)                           0717 03162000
         L     @04,@TF00001                                        0717 03163000
         ALR   @04,@08                                             0717 03164000
         BCTR  @04,0                                               0717 03165000
         OI    ICTMIDPL-7(@04),B'00100000'                         0717 03166000
*           END;                                                   0718 03167000
*                                                                  0718 03168000
@RC00715 DS    0H                                                  0719 03169000
*         /***********************************************************/ 03170000
*         /*                                                         */ 03171000
*         /* FOR UMIDS (WITH NO REPLACEMENT IN ICT), SET UMIDERR     */ 03172000
*         /* INDICATOR AND ISSUE HMA319I                             */ 03173000
*         /*                                                         */ 03174000
*         /***********************************************************/ 03175000
*                                                                  0719 03176000
*         IF TPSRTN^=PRESUP         /* DOES NOT PRE/SUP MODID        */ 03177000
*             &LREPELM@=0           /* NO REPLACEMENT ELEMENT IN ICT */ 03178000
*             &ICTMIDTY(KK)=ICTMIDUP/* THIS IS A UMID                */ 03179000
*           THEN                                                   0719 03180000
@RF00713 CLI   TPSRTN,232                                          0719 03181000
         BE    @RF00719                                            0719 03182000
         L     @08,LREPELM@                                        0719 03183000
         LTR   @08,@08                                             0719 03184000
         BNZ   @RF00719                                            0719 03185000
         LR    @08,KK                                              0719 03186000
         SLA   @08,3                                               0719 03187000
         L     @04,CMOD                                            0719 03188000
         MVC   @TF00001(4),ICTMICHN(@04)                           0719 03189000
         L     @04,@TF00001                                        0719 03190000
         ALR   @04,@08                                             0719 03191000
         BCTR  @04,0                                               0719 03192000
         TM    ICTMIDTY-7(@04),B'00000011'                         0719 03193000
         BNZ   @RF00719                                            0719 03194000
*           DO;                                                    0720 03195000
*             UMIDERR=ON;           /* SET UMID ERROR FLAG           */ 03196000
         OI    UMIDERR,B'01000000'                                 0721 03197000
*             IF UMIDMSG=MSG        /* MESSAGES SHOULD BE ISSUED     */ 03198000
*               THEN                                               0722 03199000
         L     @08,@PC00007                                        0722 03200000
         CLI   UMIDMSG(@08),C'Y'                                   0722 03201000
         BNE   @RF00722                                            0722 03202000
*               DO;                                                0723 03203000
*                 IF MSG382I=OFF    /* HMA382I MSG NOT ISSUED        */ 03204000
*                   THEN                                           0724 03205000
         TM    MSG382I,B'00100000'                                 0724 03206000
         BNZ   @RF00724                                            0724 03207000
*                   CALL ERRMSG(HMA382I,NOPART);/* ISSUE IT          */ 03208000
         LA    @01,@AL00725                                        0725 03209000
         BAL   @14,ERRMSG                                          0725 03210000
*                 MSG382I=ON;       /* HMA382I MSG ISSUED            */ 03211000
@RF00724 OI    MSG382I,B'00100000'                                 0726 03212000
*                 VPART#5=ICTMODID(KK);/* UMID SYSMOD-ID FOR HMA319I    03213000
*                                      MSG                           */ 03214000
         MVI   VPART#5+7,C' '                                      0727 03215000
         LR    @08,KK                                              0727 03216000
         SLA   @08,3                                               0727 03217000
         L     @04,CMOD                                            0727 03218000
         MVC   @TF00001(4),ICTMICHN(@04)                           0727 03219000
         L     @04,@TF00001                                        0727 03220000
         ALR   @04,@08                                             0727 03221000
         AL    @04,@CF02046                                        0727 03222000
         MVC   VPART#5(7),ICTMODID(@04)                            0727 03223000
*                 CALL ERRMSG(HMA319I,NOPART);/* ISSUE MSG           */ 03224000
         LA    @01,@AL00728                                        0728 03225000
         BAL   @14,ERRMSG                                          0728 03226000
*               END;                                               0729 03227000
*           END;                                                   0730 03228000
@RF00722 DS    0H                                                  0731 03229000
*       END;                                                       0731 03230000
@RF00719 DS    0H                                                  0732 03231000
*   END;                                                           0732 03232000
@RF00704 AH    KK,@CH00067                                         0732 03233000
@DE00701 LR    @08,KK                                              0732 03234000
         SLA   @08,3                                               0732 03235000
         L     @04,CMOD                                            0732 03236000
         MVC   @TF00001(4),ICTMICHN(@04)                           0732 03237000
         L     @04,@TF00001                                        0732 03238000
         AL    @04,@CF02046                                        0732 03239000
         L     @08,ICTMIDND(@08,@04)                               0732 03240000
         CL    @08,ICTENDIX                                        0732 03241000
         BNE   @DL00701                                            0732 03242000
*   RETURN;                                                        0733 03243000
@EL00007 DS    0H                                                  0733 03244000
@EF00007 DS    0H                                                  0733 03245000
@ER00007 LM    @14,@04,@SA00007                                    0733 03246000
         LM    @06,@12,@SA00007+28                                 0733 03247000
         BR    @14                                                 0733 03248000
*   END UMIDCHK;                                                   0734 03249000
*                                                                  0735 03250000
*/********************************************************************/ 03251000
*/*                                                                  */ 03252000
*/*    INTRSECT - WHEN TWO ELEMENTS ARE FOUND IN THE ICT WITH THE    */ 03253000
*/*               SAME NAMES, DETERMINE THE TYPE OF INTERSECTION     */ 03254000
*/*               INVOLVED.                                          */ 03255000
*/*                                                                  */ 03256000
*/*               NONE   - "CURRENT" ELEMENT AND "OTHER" ELEMENT     */ 03257000
*/*                        ARE NOT COMPATIBLE WITH ONE ANOTHER.      */ 03258000
*/*                        (I.E., A ++MOD AND A ++MAC).              */ 03259000
*/*                                                                  */ 03260000
*/*               REPREP - * "CURRENT" ELEMENT IS A REPLACEMENT      */ 03261000
*/*                        * "OTHER" ELEMENT IS A REPLACEMENT        */ 03262000
*/*                                                                  */ 03263000
*/*               REPUPD - * "CURRENT" ELEMENT IS A REPLACEMENT      */ 03264000
*/*                        * "OTHER" ELEMENT IS AN UPDATE            */ 03265000
*/*                                                                  */ 03266000
*/*               UPDREP - * "CURRENT" ELEMENT IS AN UPDATE          */ 03267000
*/*                        * "OTHER" ELEMENT IS A REPLACEMENT        */ 03268000
*/*                                                                  */ 03269000
*/*               UPDUPD - * "CURRENT" ELEMENT IS AN UPDATE          */ 03270000
*/*                        * "OTHER" ELEMENT IS AN UPDATE            */ 03271000
*/*                                                                  */ 03272000
*/*               SRCMOD - * "CURRENT" ELEMENT IS A SRC REPL         */ 03273000
*/*                        * "OTHER" ELEMENT IS A MOD REPL           */ 03274000
*/*                                                                  */ 03275000
*/*               SRCUMOD- * "CURRENT" ELEMENT IS A SRC UPDATE       */ 03276000
*/*                        * "OTHER" ELEMENT IS A MOD REPL           */ 03277000
*/*                                                                  */ 03278000
*/*               MODSRC - * "CURRENT" ELEMENT IS A MOD REPL         */ 03279000
*/*                        * "OTHER" ELEMENT IS A SRC REPL           */ 03280000
*/*                                                                  */ 03281000
*/*               MODSRCU- * "CURRENT" ELEMENT IS A MOD REPL         */ 03282000
*/*                        * "OTHER" ELEMENT IS A SRC UPDATE         */ 03283000
*/*                                                                  */ 03284000
*/*               MODXPND- * "CURRENT" ELEMENT IS A MOD REPL         */ 03285000
*/*                        * "OTHER" ELEMENT IS A LKED FOR EXPAND    */ 03286000
*/*                                                                  */ 03287000
*/*                                                                  */ 03288000
*/*    CONDITIONS UPON ENTRY:                                        */ 03289000
*/*                                                                  */ 03290000
*/*                                                                  */ 03291000
*/********************************************************************/ 03292000
*                                                                  0735 03293000
*INTRSECT:                                                         0735 03294000
*   PROC(PTRC,PTRO,INTRTYPE);                                      0735 03295000
INTRSECT STM   @14,@12,12(@13)                                     0735 03296000
         MVC   @PC00008(12),0(@01)                                 0735 03297000
*   DCL                                                            0736 03298000
*     PTRC PTR(31);                 /* PTR TO "CURRENT" ELEMENT'S ICT   03299000
*                                      MOD SECTION ENTRY             */ 03300000
*   DCL                                                            0737 03301000
*     PTRO PTR(31);                 /* PTR TO "OTHER" ELEMENT'S ICT     03302000
*                                      MOD SECTION ENTRY             */ 03303000
*   DCL                                                            0738 03304000
*     INTRTYPE FIXED(8);            /* RETURNS INTERSECTION TYPE (SEE   03305000
*                                      ABOVE)                        */ 03306000
*   RESPECIFY                                                      0739 03307000
*     ICTMOD BASED(PTRC);           /* ADDRESS "CURRENT" ELEMENT     */ 03308000
*   INTRTYPE=NONE;                  /* INITIALIZE INTERSECTION TYPE     03309000
*                                      TO "NONE"                     */ 03310000
*                                                                  0740 03311000
         L     @08,@PC00008+8                                      0740 03312000
         MVI   INTRTYPE(@08),X'00'                                 0740 03313000
*   /*****************************************************************/ 03314000
*   /*                                                               */ 03315000
*   /* COMPATIBLE INTERSECTIONS                                      */ 03316000
*   /*                                                               */ 03317000
*   /*****************************************************************/ 03318000
*                                                                  0741 03319000
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPL          */ 03320000
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL            */ 03321000
*     THEN                                                         0741 03322000
         L     @15,@PC00008                                        0741 03323000
         L     @01,PTRC(,@15)                                      0741 03324000
         TM    ICTMMOD(@01),B'10000000'                            0741 03325000
         BNO   @RF00741                                            0741 03326000
         L     @15,@PC00008+4                                      0741 03327000
         L     @01,PTRO(,@15)                                      0741 03328000
         TM    ICTMMOD(@01),B'10000000'                            0741 03329000
         BNO   @RF00741                                            0741 03330000
*     INTRTYPE=REPREP;              /* <--- BOTH REPLACEMENTS        */ 03331000
         MVI   INTRTYPE(@08),X'01'                                 0742 03332000
*   IF ICTMMACR(1)=ON               /* "CURRENT" A ++MAC ?           */ 03333000
*       &PTRO->ICTMMACR(1)=ON       /* "OTHER" A ++MAC ?             */ 03334000
*     THEN                                                         0743 03335000
@RF00741 L     @08,@PC00008                                        0743 03336000
         L     @08,PTRC(,@08)                                      0743 03337000
         TM    ICTMMACR(@08),B'00001000'                           0743 03338000
         BNO   @RF00743                                            0743 03339000
         L     @08,@PC00008+4                                      0743 03340000
         L     @08,PTRO(,@08)                                      0743 03341000
         TM    ICTMMACR(@08),B'00001000'                           0743 03342000
         BNO   @RF00743                                            0743 03343000
*     INTRTYPE=REPREP;              /* <--- BOTH REPLACEMENTS        */ 03344000
         L     @08,@PC00008+8                                      0744 03345000
         MVI   INTRTYPE(@08),X'01'                                 0744 03346000
*   IF ICTMSRCR(1)=ON               /* "CURRENT" A ++SRC ?           */ 03347000
*       &PTRO->ICTMSRCR(1)=ON       /* "OTHER" A ++SRC ?             */ 03348000
*     THEN                                                         0745 03349000
@RF00743 L     @08,@PC00008                                        0745 03350000
         L     @08,PTRC(,@08)                                      0745 03351000
         TM    ICTMSRCR(@08),B'00000010'                           0745 03352000
         BNO   @RF00745                                            0745 03353000
         L     @08,@PC00008+4                                      0745 03354000
         L     @08,PTRO(,@08)                                      0745 03355000
         TM    ICTMSRCR(@08),B'00000010'                           0745 03356000
         BNO   @RF00745                                            0745 03357000
*     INTRTYPE=REPREP;              /* <--- BOTH REPLACEMENTS        */ 03358000
         L     @08,@PC00008+8                                      0746 03359000
         MVI   INTRTYPE(@08),X'01'                                 0746 03360000
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPL ?        */ 03361000
*       &PTRO->ICTMZAP(1)=ON        /* "OTHER" A ++ZAP ?             */ 03362000
*     THEN                                                         0747 03363000
@RF00745 L     @08,@PC00008                                        0747 03364000
         L     @08,PTRC(,@08)                                      0747 03365000
         TM    ICTMMOD(@08),B'10000000'                            0747 03366000
         BNO   @RF00747                                            0747 03367000
         L     @08,@PC00008+4                                      0747 03368000
         L     @08,PTRO(,@08)                                      0747 03369000
         TM    ICTMZAP(@08),B'00100000'                            0747 03370000
         BNO   @RF00747                                            0747 03371000
*     INTRTYPE=REPUPD;              /* <--- REPLACEMENT ON UPDATE    */ 03372000
         L     @08,@PC00008+8                                      0748 03373000
         MVI   INTRTYPE(@08),X'02'                                 0748 03374000
*   IF ICTMMACR(1)=ON               /* "CURRENT" A ++MAC ?           */ 03375000
*       &PTRO->ICTMMACU(1)=ON       /* "OTHER" A ++MACUPD ?          */ 03376000
*     THEN                                                         0749 03377000
@RF00747 L     @08,@PC00008                                        0749 03378000
         L     @08,PTRC(,@08)                                      0749 03379000
         TM    ICTMMACR(@08),B'00001000'                           0749 03380000
         BNO   @RF00749                                            0749 03381000
         L     @08,@PC00008+4                                      0749 03382000
         L     @08,PTRO(,@08)                                      0749 03383000
         TM    ICTMMACU(@08),B'00000100'                           0749 03384000
         BNO   @RF00749                                            0749 03385000
*     INTRTYPE=REPUPD;              /* <--- REPLACEMENT ON UPDATE    */ 03386000
         L     @08,@PC00008+8                                      0750 03387000
         MVI   INTRTYPE(@08),X'02'                                 0750 03388000
*   IF ICTMSRCR(1)=ON               /* "CURRENT" A ++SRC ?           */ 03389000
*       &PTRO->ICTMSRCU(1)=ON       /* "OTHER" A ++SRCUPD ?          */ 03390000
*     THEN                                                         0751 03391000
@RF00749 L     @08,@PC00008                                        0751 03392000
         L     @08,PTRC(,@08)                                      0751 03393000
         TM    ICTMSRCR(@08),B'00000010'                           0751 03394000
         BNO   @RF00751                                            0751 03395000
         L     @08,@PC00008+4                                      0751 03396000
         L     @08,PTRO(,@08)                                      0751 03397000
         TM    ICTMSRCU(@08),B'00000001'                           0751 03398000
         BNO   @RF00751                                            0751 03399000
*     INTRTYPE=REPUPD;              /* <--- REPLACEMENT ON UPDATE    */ 03400000
         L     @08,@PC00008+8                                      0752 03401000
         MVI   INTRTYPE(@08),X'02'                                 0752 03402000
*   IF ICTMZAP(1)=ON                /* "CURRENT" A ++ZAP ?           */ 03403000
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL?           */ 03404000
*     THEN                                                         0753 03405000
@RF00751 L     @08,@PC00008                                        0753 03406000
         L     @08,PTRC(,@08)                                      0753 03407000
         TM    ICTMZAP(@08),B'00100000'                            0753 03408000
         BNO   @RF00753                                            0753 03409000
         L     @08,@PC00008+4                                      0753 03410000
         L     @08,PTRO(,@08)                                      0753 03411000
         TM    ICTMMOD(@08),B'10000000'                            0753 03412000
         BNO   @RF00753                                            0753 03413000
*     INTRTYPE=UPDREP;              /* <--- UPDATE ON REPLACEMENT    */ 03414000
         L     @08,@PC00008+8                                      0754 03415000
         MVI   INTRTYPE(@08),X'04'                                 0754 03416000
*   IF ICTMMACU(1)=ON               /* "CURRENT" A ++MACUPD ?        */ 03417000
*       &PTRO->ICTMMACR(1)=ON       /* "OTHER" A ++MAC ?             */ 03418000
*     THEN                                                         0755 03419000
@RF00753 L     @08,@PC00008                                        0755 03420000
         L     @08,PTRC(,@08)                                      0755 03421000
         TM    ICTMMACU(@08),B'00000100'                           0755 03422000
         BNO   @RF00755                                            0755 03423000
         L     @08,@PC00008+4                                      0755 03424000
         L     @08,PTRO(,@08)                                      0755 03425000
         TM    ICTMMACR(@08),B'00001000'                           0755 03426000
         BNO   @RF00755                                            0755 03427000
*     INTRTYPE=UPDREP;              /* <--- UPDATE ON REPLACEMENT    */ 03428000
         L     @08,@PC00008+8                                      0756 03429000
         MVI   INTRTYPE(@08),X'04'                                 0756 03430000
*   IF ICTMSRCU(1)=ON               /* "CURRENT" A ++SRCUPD ?        */ 03431000
*       &PTRO->ICTMSRCR(1)=ON       /* "OTHER" A ++SRC ?             */ 03432000
*     THEN                                                         0757 03433000
@RF00755 L     @08,@PC00008                                        0757 03434000
         L     @08,PTRC(,@08)                                      0757 03435000
         TM    ICTMSRCU(@08),B'00000001'                           0757 03436000
         BNO   @RF00757                                            0757 03437000
         L     @08,@PC00008+4                                      0757 03438000
         L     @08,PTRO(,@08)                                      0757 03439000
         TM    ICTMSRCR(@08),B'00000010'                           0757 03440000
         BNO   @RF00757                                            0757 03441000
*     INTRTYPE=UPDREP;              /* <--- UPDATE ON REPLACEMENT    */ 03442000
         L     @08,@PC00008+8                                      0758 03443000
         MVI   INTRTYPE(@08),X'04'                                 0758 03444000
*   IF ICTMZAP(1)=ON                /* "CURRENT" A ++ZAP ?           */ 03445000
*       &PTRO->ICTMZAP(1)=ON        /* "OTHER" A ++ZAP ?             */ 03446000
*     THEN                                                         0759 03447000
@RF00757 L     @08,@PC00008                                        0759 03448000
         L     @08,PTRC(,@08)                                      0759 03449000
         TM    ICTMZAP(@08),B'00100000'                            0759 03450000
         BNO   @RF00759                                            0759 03451000
         L     @08,@PC00008+4                                      0759 03452000
         L     @08,PTRO(,@08)                                      0759 03453000
         TM    ICTMZAP(@08),B'00100000'                            0759 03454000
         BNO   @RF00759                                            0759 03455000
*     INTRTYPE=UPDUPD;              /* <--- UPDATE ON UPDATE         */ 03456000
         L     @08,@PC00008+8                                      0760 03457000
         MVI   INTRTYPE(@08),X'08'                                 0760 03458000
*   IF ICTMMACU(1)=ON               /* "CURRENT" A ++MACUPD ?        */ 03459000
*       &PTRO->ICTMMACU(1)=ON       /* "OTHER" A ++MACUPD ?          */ 03460000
*     THEN                                                         0761 03461000
@RF00759 L     @08,@PC00008                                        0761 03462000
         L     @08,PTRC(,@08)                                      0761 03463000
         TM    ICTMMACU(@08),B'00000100'                           0761 03464000
         BNO   @RF00761                                            0761 03465000
         L     @08,@PC00008+4                                      0761 03466000
         L     @08,PTRO(,@08)                                      0761 03467000
         TM    ICTMMACU(@08),B'00000100'                           0761 03468000
         BNO   @RF00761                                            0761 03469000
*     INTRTYPE=UPDUPD;              /* <--- UPDATE ON UPDATE         */ 03470000
         L     @08,@PC00008+8                                      0762 03471000
         MVI   INTRTYPE(@08),X'08'                                 0762 03472000
*   IF ICTMSRCU(1)=ON               /* "CURRENT" A ++SRCUPD ?        */ 03473000
*       &PTRO->ICTMSRCU(1)=ON       /* "OTHER" A ++SRCUPD ?          */ 03474000
*     THEN                                                         0763 03475000
@RF00761 L     @08,@PC00008                                        0763 03476000
         L     @08,PTRC(,@08)                                      0763 03477000
         TM    ICTMSRCU(@08),B'00000001'                           0763 03478000
         BNO   @RF00763                                            0763 03479000
         L     @08,@PC00008+4                                      0763 03480000
         L     @08,PTRO(,@08)                                      0763 03481000
         TM    ICTMSRCU(@08),B'00000001'                           0763 03482000
         BNO   @RF00763                                            0763 03483000
*     INTRTYPE=UPDUPD;              /* <--- UPDATE ON UPDATE         */ 03484000
*                                                                  0764 03485000
         L     @08,@PC00008+8                                      0764 03486000
         MVI   INTRTYPE(@08),X'08'                                 0764 03487000
*   /*****************************************************************/ 03488000
*   /*                                                               */ 03489000
*   /* SRC-MOD INTERSECTIONS                                         */ 03490000
*   /*                                                               */ 03491000
*   /*****************************************************************/ 03492000
*                                                                  0765 03493000
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPL          */ 03494000
*       &ICTMASM(1)=OFF             /* ......... NOT AN ASSEMBLY     */ 03495000
*       &PTRO->ICTMSRCR(1)=ON       /* "OTHER" A ++SRC               */ 03496000
*     THEN                                                         0765 03497000
@RF00763 L     @08,@PC00008                                        0765 03498000
         L     @08,PTRC(,@08)                                      0765 03499000
         TM    ICTMMOD(@08),B'10000000'                            0765 03500000
         BNO   @RF00765                                            0765 03501000
         TM    ICTMASM(@08),B'01000000'                            0765 03502000
         BNZ   @RF00765                                            0765 03503000
         L     @08,@PC00008+4                                      0765 03504000
         L     @08,PTRO(,@08)                                      0765 03505000
         TM    ICTMSRCR(@08),B'00000010'                           0765 03506000
         BNO   @RF00765                                            0765 03507000
*     INTRTYPE=MODSRC;              /* <--- MOD REPL TO SRC          */ 03508000
         L     @08,@PC00008+8                                      0766 03509000
         MVI   INTRTYPE(@08),X'40'                                 0766 03510000
*   IF ICTMMOD(1)=ON                /* "CURRENT" A ++MOD             */ 03511000
*       &ICTMASM(1)=OFF             /* ......... NOT AN ASSEMBLY     */ 03512000
*       &PTRO->ICTMSRCU(1)=ON       /* "OTHER" A ++SRCUPD            */ 03513000
*     THEN                                                         0767 03514000
@RF00765 L     @08,@PC00008                                        0767 03515000
         L     @08,PTRC(,@08)                                      0767 03516000
         TM    ICTMMOD(@08),B'10000000'                            0767 03517000
         BNO   @RF00767                                            0767 03518000
         TM    ICTMASM(@08),B'01000000'                            0767 03519000
         BNZ   @RF00767                                            0767 03520000
         L     @08,@PC00008+4                                      0767 03521000
         L     @08,PTRO(,@08)                                      0767 03522000
         TM    ICTMSRCU(@08),B'00000001'                           0767 03523000
         BNO   @RF00767                                            0767 03524000
*     INTRTYPE=MODSRCU;             /* <--- MOD REPL TO SRCUPD       */ 03525000
         L     @08,@PC00008+8                                      0768 03526000
         MVI   INTRTYPE(@08),X'80'                                 0768 03527000
*   IF ICTMSRCR(1)=ON               /* "CURRENT" A ++SRC             */ 03528000
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL            */ 03529000
*       &PTRO->ICTMASM(1)=OFF       /* ....... NOT AN ASSEMBLY       */ 03530000
*     THEN                                                         0769 03531000
@RF00767 L     @08,@PC00008                                        0769 03532000
         L     @08,PTRC(,@08)                                      0769 03533000
         TM    ICTMSRCR(@08),B'00000010'                           0769 03534000
         BNO   @RF00769                                            0769 03535000
         L     @08,@PC00008+4                                      0769 03536000
         L     @08,PTRO(,@08)                                      0769 03537000
         TM    ICTMMOD(@08),B'10000000'                            0769 03538000
         BNO   @RF00769                                            0769 03539000
         TM    ICTMASM(@08),B'01000000'                            0769 03540000
         BNZ   @RF00769                                            0769 03541000
*     INTRTYPE=SRCMOD;              /* <--- SRC REPL TO MOD          */ 03542000
         L     @08,@PC00008+8                                      0770 03543000
         MVI   INTRTYPE(@08),X'10'                                 0770 03544000
*   IF ICTMSRCU(1)=ON               /* "CURRENT" A ++SRCUPD          */ 03545000
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL            */ 03546000
*       &PTRO->ICTMASM(1)=OFF       /* ....... NOT AN ASSEMBLY       */ 03547000
*     THEN                                                         0771 03548000
@RF00769 L     @08,@PC00008                                        0771 03549000
         L     @08,PTRC(,@08)                                      0771 03550000
         TM    ICTMSRCU(@08),B'00000001'                           0771 03551000
         BNO   @RF00771                                            0771 03552000
         L     @08,@PC00008+4                                      0771 03553000
         L     @08,PTRO(,@08)                                      0771 03554000
         TM    ICTMMOD(@08),B'10000000'                            0771 03555000
         BNO   @RF00771                                            0771 03556000
         TM    ICTMASM(@08),B'01000000'                            0771 03557000
         BNZ   @RF00771                                            0771 03558000
*     INTRTYPE=SRCUMOD;             /* <--- SRC UPDATE ON MOD REPL   */ 03559000
*                                                                  0772 03560000
         L     @08,@PC00008+8                                      0772 03561000
         MVI   INTRTYPE(@08),X'20'                                 0772 03562000
*   /*****************************************************************/ 03563000
*   /*                                                               */ 03564000
*   /* MOD-XPND INTERSECTIONS                                        */ 03565000
*   /*                                                               */ 03566000
*   /*****************************************************************/ 03567000
*                                                                  0773 03568000
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPLACMENT    */ 03569000
*       &PTRO->ICTMXPND(1)=ON       /* "OTHER" AN EXPAND             */ 03570000
*     THEN                                                         0773 03571000
@RF00771 L     @08,@PC00008                                        0773 03572000
         L     @08,PTRC(,@08)                                      0773 03573000
         TM    ICTMMOD(@08),B'10000000'                            0773 03574000
         BNO   @RF00773                                            0773 03575000
         L     @08,@PC00008+4                                      0773 03576000
         L     @08,PTRO(,@08)                                      0773 03577000
         TM    ICTMXPND(@08),B'00010000'                           0773 03578000
         BNO   @RF00773                                            0773 03579000
*     INTRTYPE=MODXPND;             /* <--- MOD REPL TO EXPAND       */ 03580000
         L     @08,@PC00008+8                                      0774 03581000
         MVI   INTRTYPE(@08),X'81'                                 0774 03582000
*   RETURN;                                                        0775 03583000
@EL00008 DS    0H                                                  0775 03584000
@EF00008 DS    0H                                                  0775 03585000
@ER00008 LM    @14,@12,12(@13)                                     0775 03586000
         BR    @14                                                 0775 03587000
*   END INTRSECT;                                                  0776 03588000
         B     @EL00008                                            0776 03589000
*                                                                  0777 03590000
*/********************************************************************/ 03591000
*/*                                                                  */ 03592000
*/*    ELIMMOD  - ELIMINATE ++MOD MOD SECTION ENTRY ASSOICATED       */ 03593000
*/*               WITH THE "CURRENT" ELEMENT.   THE ASSOCIATED       */ 03594000
*/*               ++MOD MOD SECT ENTRY IS ONE FROM THE "CURRENT"     */ 03595000
*/*               SYSMOD.                                            */ 03596000
*/*                                                                  */ 03597000
*/*    CONDITIONS UPON ENTRY:                                        */ 03598000
*/*                                                                  */ 03599000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT ... THIS SHOULD     */ 03600000
*/*                  BE A MOD SECT ENTRY FOR A ++SRC/++SRCUPD.       */ 03601000
*/*                                                                  */ 03602000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 03603000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 03604000
*/*                                                                  */ 03605000
*/*                                                                  */ 03606000
*/********************************************************************/ 03607000
*                                                                  0777 03608000
*ELIMMOD:                                                          0777 03609000
*   PROC(EMODNAME);                                                0777 03610000
ELIMMOD  STM   @14,@12,12(@13)                                     0777 03611000
         MVC   @PC00009(4),0(@01)                                  0777 03612000
*   DCL                                                            0778 03613000
*     EMODNAME CHAR(8);             /* ELEMENT NAME                  */ 03614000
*   DCL                                                            0779 03615000
*     TT FIXED(15);                 /* LOCAL INDEX                   */ 03616000
*   RESPECIFY                                                      0780 03617000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 03618000
*                                                                  0780 03619000
*   /*****************************************************************/ 03620000
*   /*                                                               */ 03621000
*   /* GO THRU THE ICT MOD SECTION                                   */ 03622000
*   /*                                                               */ 03623000
*   /*****************************************************************/ 03624000
*                                                                  0781 03625000
*   DO TT=1 BY 1 WHILE ICTMEND(TT)^=ICTENDNT;                      0781 03626000
         LA    TT,1                                                0781 03627000
         B     @DE00781                                            0781 03628000
@DL00781 DS    0H                                                  0782 03629000
*     IF ICTMNAME(TT)=EMODNAME      /* MATCHES NAME TO BE ELIMINATED */ 03630000
*         &ICTPPTR(TT)=CPTF         /* BOTH FROM "CURRENT" SYSMOD    */ 03631000
*         &ICTMMOD(TT)=ON           /* ++MOD REPLACEMENT ENTRY       */ 03632000
*         &ICTMASM(TT)=OFF          /* ... NOT ASSEM ENTRY           */ 03633000
*       THEN                                                       0782 03634000
         LR    @08,TT                                              0782 03635000
         MH    @08,@CH02013                                        0782 03636000
         L     @03,CCAICMOD(,CCAPTR)                               0782 03637000
         L     @15,@PC00009                                        0782 03638000
         ST    @08,@TF00001                                        0782 03639000
         ALR   @08,@03                                             0782 03640000
         AL    @08,@CF02036                                        0782 03641000
         CLC   ICTMNAME(8,@08),EMODNAME(@15)                       0782 03642000
         BNE   @RF00782                                            0782 03643000
         L     @08,@PC00001+4                                      0782 03644000
         L     @01,@TF00001                                        0782 03645000
         AL    @01,@CF02034                                        0782 03646000
         L     @15,ICTPPTR-96(@01,@03)                             0782 03647000
         C     @15,CPTF(,@08)                                      0782 03648000
         BNE   @RF00782                                            0782 03649000
         LR    @08,@03                                             0782 03650000
         AL    @08,@TF00001                                        0782 03651000
         AL    @08,@CF02049                                        0782 03652000
         TM    ICTMMOD-9(@08),B'10000000'                          0782 03653000
         BNO   @RF00782                                            0782 03654000
         TM    ICTMASM-9(@08),B'01000000'                          0782 03655000
         BNZ   @RF00782                                            0782 03656000
*       DO;                                                        0783 03657000
*         ICTMSELM(TT)=ON;          /* ELIMINATE ++MOD REPL ENTRY    */ 03658000
*         ICTMASOC(TT)=OFF;         /* TURN OFF ASSOCATED ++SRC FLAG */ 03659000
*         ICTMISEL(TT)=OFF;         /* MAKE SURE SELECT FLAG IS OFF  */ 03660000
         AL    @03,@TF00001                                        0786 03661000
         AL    @03,@CF02033                                        0786 03662000
         OI    ICTMSELM-11(@03),B'00100000'                        0786 03663000
         NI    ICTMASOC-11(@03),B'01101111'                        0786 03664000
*       END;                                                       0787 03665000
*   END;                            /* END LOOP THRU ICT MOD SECTION */ 03666000
@RF00782 AH    TT,@CH00067                                         0788 03667000
@DE00781 LR    @08,TT                                              0788 03668000
         MH    @08,@CH02013                                        0788 03669000
         L     @03,CCAICMOD(,CCAPTR)                               0788 03670000
         ALR   @03,@08                                             0788 03671000
         AL    @03,@CF02036                                        0788 03672000
         MVC   @TF00001(4),ICTMEND(@03)                            0788 03673000
         L     @08,@TF00001                                        0788 03674000
         CL    @08,ICTENDNT                                        0788 03675000
         BNE   @DL00781                                            0788 03676000
*   RETURN;                                                        0789 03677000
@EL00009 DS    0H                                                  0789 03678000
@EF00009 DS    0H                                                  0789 03679000
@ER00009 LM    @14,@12,12(@13)                                     0789 03680000
         BR    @14                                                 0789 03681000
*   END ELIMMOD;                                                   0790 03682000
*                                                                  0791 03683000
*/********************************************************************/ 03684000
*/*                                                                  */ 03685000
*/*    SCRWRKX  - SCRATCH ANY EXISTING MEMBERS ON THE WRK DATASETS   */ 03686000
*/*               FOR THE ELEMENT PASSED BY THE CALLER               */ 03687000
*/*                                                                  */ 03688000
*/*    CONDITIONS UPON ENTRY:                                        */ 03689000
*/*                                                                  */ 03690000
*/*     * IOPPTR   - PTR TO IOP WHICH MAY BE USED TO SCRATCH MEMBERS */ 03691000
*/*                  FROM THE WRK DATASETS                           */ 03692000
*/*                                                                  */ 03693000
*/********************************************************************/ 03694000
*                                                                  0791 03695000
*SCRWRKX:                                                          0791 03696000
*   PROC(SCRMOD);                                                  0791 03697000
SCRWRKX  STM   @14,@12,@SA00010                                    0791 03698000
         MVC   @PC00010(4),0(@01)                                  0791 03699000
*   DCL                                                            0792 03700000
*     SCRMOD CHAR(*);               /* ICT MOD SECT ENTRY FOR AN   0792 03701000
*                                      ELEMENT                       */ 03702000
*   RESPECIFY                                                      0793 03703000
*     ICTMOD BASED(ADDR(SCRMOD));   /* MOD SECT ENTRY PASSED         */ 03704000
*   RESPECIFY                                                      0794 03705000
*     HMASMIOP BASED(IOPPTR);       /* ADDRESS IOP                   */ 03706000
*   IF ICTMWRK(1)=ON THEN                                          0795 03707000
         L     @08,@PC00010                                        0795 03708000
         TM    ICTMWRK(@08),B'00001000'                            0795 03709000
         BNO   @RF00795                                            0795 03710000
*     DO;                                                          0796 03711000
*                                                                  0796 03712000
*       /*************************************************************/ 03713000
*       /*                                                           */ 03714000
*       /* THE ELEMENT'S TEXT HAS BEEN WRITTEN TO A WRK DATASET      */ 03715000
*       /*                                                           */ 03716000
*       /*************************************************************/ 03717000
*                                                                  0797 03718000
*                                                                  0797 03719000
*       /*************************************************************/ 03720000
*       /*                                                           */ 03721000
*       /* INITIALIZE IOP FOR STOW DELETE FUNCTION TO WRK DATASET    */ 03722000
*       /*                                                           */ 03723000
*       /*************************************************************/ 03724000
*                                                                  0797 03725000
*       IOPFUNCT=IOPSTOWD;          /* STOW DELETE FUNCTION          */ 03726000
         MVI   IOPFUNCT(IOPPTR),X'53'                              0797 03727000
*       IOPDSID=IOPWKX;             /* WRKX DATASET ... DETERMINED BY   03728000
*                                      I/O ROUTINES FROM IOPTYPE     */ 03729000
         MVI   IOPDSID(IOPPTR),X'28'                               0798 03730000
*       IOPNAME=ICTMNAME(1);        /* ELEMENT NAME                  */ 03731000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0799 03732000
*       IF ICTMMOD(1)=ON            /* ++MOD ELEMENT                 */ 03733000
*         THEN                                                     0800 03734000
         TM    ICTMMOD(@08),B'10000000'                            0800 03735000
         BNO   @RF00800                                            0800 03736000
*         IOPTYPE=IOPMOD;           /* ... GET RID OF WRKX MOD       */ 03737000
         MVI   IOPTYPE(IOPPTR),X'05'                               0801 03738000
*       IF ICTMXPND(1)=ON           /* EXPAND MOD ENTRY              */ 03739000
*         THEN                                                     0802 03740000
@RF00800 L     @08,@PC00010                                        0802 03741000
         TM    ICTMXPND(@08),B'00010000'                           0802 03742000
         BNO   @RF00802                                            0802 03743000
*         IOPTYPE=IOPXZP;           /* ... GET RID OF WRKX EXPANDS   */ 03744000
         MVI   IOPTYPE(IOPPTR),X'0D'                               0803 03745000
*       IF ICTMMACR(1)=ON           /* ++MAC ELEMENT                 */ 03746000
*         THEN                                                     0804 03747000
@RF00802 L     @08,@PC00010                                        0804 03748000
         TM    ICTMMACR(@08),B'00001000'                           0804 03749000
         BNO   @RF00804                                            0804 03750000
*         IOPTYPE=IOPMCR;           /* ... GET RID OF WRKX MAC       */ 03751000
         MVI   IOPTYPE(IOPPTR),X'03'                               0805 03752000
*       IF ICTMSRCR(1)=ON           /* ++SRC ELEMENT                 */ 03753000
*         THEN                                                     0806 03754000
@RF00804 L     @08,@PC00010                                        0806 03755000
         TM    ICTMSRCR(@08),B'00000010'                           0806 03756000
         BNO   @RF00806                                            0806 03757000
*         IOPTYPE=IOPSCR;           /* ... GET RID OF WRKX SRC       */ 03758000
         MVI   IOPTYPE(IOPPTR),X'08'                               0807 03759000
*       IF ICTMZAP(1)=ON            /* ++ZAP ELEMENT                 */ 03760000
*         THEN                                                     0808 03761000
@RF00806 L     @08,@PC00010                                        0808 03762000
         TM    ICTMZAP(@08),B'00100000'                            0808 03763000
         BNO   @RF00808                                            0808 03764000
*         IOPTYPE=IOPZAP;           /* ... GET RID OF WRKX ZAPS      */ 03765000
         MVI   IOPTYPE(IOPPTR),X'0C'                               0809 03766000
*       IF ICTMMACU(1)=ON           /* ++MACUPD ELEMENT              */ 03767000
*         THEN                                                     0810 03768000
@RF00808 L     @08,@PC00010                                        0810 03769000
         TM    ICTMMACU(@08),B'00000100'                           0810 03770000
         BNO   @RF00810                                            0810 03771000
*         IOPTYPE=IOPMCU;           /* ... GET RID OF WRKX MACUPDS   */ 03772000
         MVI   IOPTYPE(IOPPTR),X'04'                               0811 03773000
*       IF ICTMSRCU(1)=ON           /* ++SRCUPD ELEMENT              */ 03774000
*         THEN                                                     0812 03775000
@RF00810 L     @08,@PC00010                                        0812 03776000
         TM    ICTMSRCU(@08),B'00000001'                           0812 03777000
         BNO   @RF00812                                            0812 03778000
*         IOPTYPE=IOPSCU;           /* ... GET RID OF WRKX SRCUPDTS  */ 03779000
         MVI   IOPTYPE(IOPPTR),X'09'                               0813 03780000
*       CALL HMASMIO(HMASMIOP);     /* DO THE STOW DELETE            */ 03781000
@RF00812 ST    IOPPTR,@AL00001                                     0814 03782000
         L     @15,@CV01712                                        0814 03783000
         LA    @01,@AL00001                                        0814 03784000
         BALR  @14,@15                                             0814 03785000
*       ICTMWRK(1)=OFF;             /* ELEMENT NO LONGER ON WRKX     */ 03786000
         L     @08,@PC00010                                        0815 03787000
         NI    ICTMWRK(@08),B'11110111'                            0815 03788000
*     END;                                                         0816 03789000
*   RETURN;                                                        0817 03790000
@EL00010 DS    0H                                                  0817 03791000
@EF00010 DS    0H                                                  0817 03792000
@ER00010 LM    @14,@12,@SA00010                                    0817 03793000
         BR    @14                                                 0817 03794000
*   END SCRWRKX;                                                   0818 03795000
         B     @EL00010                                            0818 03796000
*                                                                  0819 03797000
*/********************************************************************/ 03798000
*/*                                                                  */ 03799000
*/*    ERRMSG   - PUT ERROR MESSAGES TO SMPOUT AND SMPLOG            */ 03800000
*/*             - SET HIGHTMS FROM MGPTYPE                           */ 03801000
*/*                                                                  */ 03802000
*/*    CONDITIONS UPON ENTRY:                                        */ 03803000
*/*                                                                  */ 03804000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 03805000
*/*                                                                  */ 03806000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 03807000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 03808000
*/*                                                                  */ 03809000
*/*     * MGPTYPE -  MESSAGE SEVERITY INITIALIZED TO VALID VALUE     */ 03810000
*/*               -  IGNORED FOR HMA319I MESSAGE ... SET TO "INFO"   */ 03811000
*/*                                                                  */ 03812000
*/*     * MSGSMDNM - "CURRENT" SYSMOD-ID                             */ 03813000
*/*                                                                  */ 03814000
*/*     * VPART#1  - "CURRENT" ELEMENT TYPE                          */ 03815000
*/*                                                                  */ 03816000
*/*     * VPART#2  - "CURRENT" ELEMENT NAME                          */ 03817000
*/*                                                                  */ 03818000
*/*     * VPART#3  - HMA319I - 'SMPCDS' | 'SMPACDS' | 'ICT'          */ 03819000
*/*                - HMA410I - SYSMOD-ID                             */ 03820000
*/*                                                                  */ 03821000
*/*     * VPART#4  - HMA319I - 'RMID' | 'UMID'                       */ 03822000
*/*                                                                  */ 03823000
*/*     * VPART#5  - HMA319I - SYSMOD-ID #                           */ 03824000
*/*                                                                  */ 03825000
*/********************************************************************/ 03826000
*                                                                  0819 03827000
*ERRMSG:                                                           0819 03828000
*   PROC(MSGCODE1,MSGCODE2);                                       0819 03829000
ERRMSG   STM   @14,@04,@SA00011                                    0819 03830000
         STM   @06,@12,@SA00011+28                                 0819 03831000
         MVC   @PC00011(8),0(@01)                                  0819 03832000
*   DCL                                                            0820 03833000
*     MSGCODE1 FIXED(8);            /* PRIMARY MESSAGE NUMBER        */ 03834000
*   DCL                                                            0821 03835000
*     MSGCODE2 FIXED(8);            /* MESSAGE PART NUMBER           */ 03836000
*                                                                  0822 03837000
*   /*****************************************************************/ 03838000
*   /*                                                               */ 03839000
*   /* SET UP HMASMMSG PARM LIST (MGP)                               */ 03840000
*   /*                                                               */ 03841000
*   /*****************************************************************/ 03842000
*                                                                  0822 03843000
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */ 03844000
         XC    MGPCLEAR(6),MGPCLEAR                                0822 03845000
*   MGPFLAGS=''B;                   /* CLEAR ALL FLAGS               */ 03846000
         XC    MGPFLAGS(2),MGPFLAGS                                0823 03847000
*   MGPMGNO1=MSGCODE1;              /* PRIMARY MESSAGE NUMBER        */ 03848000
         L     @08,@PC00011                                        0824 03849000
         SLR   @04,@04                                             0824 03850000
         IC    @04,MSGCODE1(,@08)                                  0824 03851000
         STH   @04,MGPMGNO1                                        0824 03852000
*   IF MSGCODE2^=NOPART THEN                                       0825 03853000
         L     @08,@PC00011+4                                      0825 03854000
         CLI   MSGCODE2(@08),0                                     0825 03855000
         BE    @RF00825                                            0825 03856000
*     MGPMGNO2=MSGCODE2;            /* MESSAGE PART NUMBER           */ 03857000
         SLR   @04,@04                                             0826 03858000
         IC    @04,MSGCODE2(,@08)                                  0826 03859000
         STH   @04,MGPMGNO2                                        0826 03860000
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */ 03861000
@RF00825 DS    0H                                                  0828 03862000
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */ 03863000
*   MGPWTOR=OFF;                    /* NOT WTOR                      */ 03864000
*   MGPWTO=OFF;                     /* NOT WTO                       */ 03865000
*                                                                  0830 03866000
         OI    MGPPRINT,B'10010000'                                0830 03867000
         NI    MGPWTOR,B'11110011'                                 0830 03868000
*   /*****************************************************************/ 03869000
*   /*                                                               */ 03870000
*   /* SET UP VARIABLE PARTS OF CERTAIN MESSAGES                     */ 03871000
*   /*                                                               */ 03872000
*   /*****************************************************************/ 03873000
*                                                                  0831 03874000
*   IF MSGCODE1=HMA381I THEN                                       0831 03875000
         L     @08,@PC00011                                        0831 03876000
         CLI   MSGCODE1(@08),182                                   0831 03877000
         BNE   @RF00831                                            0831 03878000
*     DO;                                                          0832 03879000
*                                                                  0832 03880000
*       /*************************************************************/ 03881000
*       /*                                                           */ 03882000
*       /* FORMAT HMA381I MESSAGE                                    */ 03883000
*       /*                                                           */ 03884000
*       /*************************************************************/ 03885000
*                                                                  0833 03886000
*       MGPVARPT(1)=ADDR(VPART#1);  /* "CURRENT" ELEMENT TYPE        */ 03887000
         LA    @08,VPART#1                                         0833 03888000
         ST    @08,MGPVARPT                                        0833 03889000
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID           */ 03890000
         LA    @08,MSGSMDNM                                        0834 03891000
         ST    @08,MGPVARPT+4                                      0834 03892000
*       MGPVARPT(3)=ADDR(VPART#2);  /* "CURRENT" ELEMENT NAME        */ 03893000
         LA    @08,VPART#2                                         0835 03894000
         ST    @08,MGPVARPT+8                                      0835 03895000
*     END;                                                         0836 03896000
*   IF MSGCODE1=HMA382I THEN                                       0837 03897000
@RF00831 L     @08,@PC00011                                        0837 03898000
         CLI   MSGCODE1(@08),183                                   0837 03899000
         BNE   @RF00837                                            0837 03900000
*     DO;                                                          0838 03901000
*                                                                  0838 03902000
*       /*************************************************************/ 03903000
*       /*                                                           */ 03904000
*       /* FORMAT HMA382I MESSAGE                                    */ 03905000
*       /*                                                           */ 03906000
*       /*************************************************************/ 03907000
*                                                                  0839 03908000
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID           */ 03909000
         LA    @08,MSGSMDNM                                        0839 03910000
         ST    @08,MGPVARPT                                        0839 03911000
*       IF ASSEMFLG=OFF             /* NOT PROCESSING ASSEMBLY       */ 03912000
*         THEN                                                     0840 03913000
         TM    ASSEMFLG,B'10000000'                                0840 03914000
         BNZ   @RF00840                                            0840 03915000
*         DO;                                                      0841 03916000
*           MGPVARPT(2)=ADDR(VPART#1);/* "CURRENT" ELEMENT TYPE      */ 03917000
         LA    @08,VPART#1                                         0842 03918000
         ST    @08,MGPVARPT+4                                      0842 03919000
*           MGPVARPT(3)=ADDR(VPART#2);/* "CURRENT" ELEMENT NAME      */ 03920000
         LA    @08,VPART#2                                         0843 03921000
         ST    @08,MGPVARPT+8                                      0843 03922000
*         END;                                                     0844 03923000
*       ELSE                                                       0845 03924000
*         DO;                                                      0845 03925000
         B     @RC00840                                            0845 03926000
@RF00840 DS    0H                                                  0846 03927000
*           MGPMGNO2=PART101;       /* SET UP MESSAGE PART           */ 03928000
         MVC   MGPMGNO2(2),@CH01821                                0846 03929000
*           MGPVARPT(2)=ADDR(VPART#6);/* 'ASSEMBLY'                  */ 03930000
         LA    @08,VPART#6                                         0847 03931000
         ST    @08,MGPVARPT+4                                      0847 03932000
*           MGPVARPT(3)=ADDR(VPART#7);/* ASSEMBLY ELEMENT NAME       */ 03933000
         LA    @08,VPART#7                                         0848 03934000
         ST    @08,MGPVARPT+8                                      0848 03935000
*           MGPVARPT(4)=ADDR(VPART#1);/* "CURRENT" ELEMENT TYPE      */ 03936000
         LA    @08,VPART#1                                         0849 03937000
         ST    @08,MGPVARPT+12                                     0849 03938000
*           MGPVARPT(5)=ADDR(VPART#2);/* "CURRENT" ELEMENT NAME      */ 03939000
         LA    @08,VPART#2                                         0850 03940000
         ST    @08,MGPVARPT+16                                     0850 03941000
*         END;                                                     0851 03942000
*     END;                                                         0852 03943000
@RC00840 DS    0H                                                  0853 03944000
*   IF MSGCODE1=HMA319I THEN                                       0853 03945000
@RF00837 L     @08,@PC00011                                        0853 03946000
         CLI   MSGCODE1(@08),120                                   0853 03947000
         BNE   @RF00853                                            0853 03948000
*     DO;                                                          0854 03949000
*                                                                  0854 03950000
*       /*************************************************************/ 03951000
*       /*                                                           */ 03952000
*       /* FORMAT HMA319I MESSAGE                                    */ 03953000
*       /*                                                           */ 03954000
*       /*************************************************************/ 03955000
*                                                                  0855 03956000
*       MGPTYPE=MGPINFO;            /* HMA319I ALWAYS INFORMATIONAL  */ 03957000
         MVI   MGPTYPE,X'01'                                       0855 03958000
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */ 03959000
         LA    @08,MSGSMDNM                                        0856 03960000
         ST    @08,MGPVARPT                                        0856 03961000
*       MGPVARPT(2)=ADDR(VPART#3);  /* 'SMPCDS'|'SMPACDS'|'ICT'      */ 03962000
         LA    @08,VPART#3                                         0857 03963000
         ST    @08,MGPVARPT+4                                      0857 03964000
*       MGPVARPT(3)=ADDR(VPART#4);  /* 'UMID' | 'RMID'               */ 03965000
         LA    @08,VPART#4                                         0858 03966000
         ST    @08,MGPVARPT+8                                      0858 03967000
*       MGPVARPT(4)=ADDR(VPART#5);  /* SYSMOD-ID #                   */ 03968000
         LA    @08,VPART#5                                         0859 03969000
         ST    @08,MGPVARPT+12                                     0859 03970000
*     END;                                                         0860 03971000
*   IF MSGCODE1=HMA410I THEN                                       0861 03972000
@RF00853 L     @08,@PC00011                                        0861 03973000
         CLI   MSGCODE1(@08),211                                   0861 03974000
         BNE   @RF00861                                            0861 03975000
*     DO;                                                          0862 03976000
*                                                                  0862 03977000
*       /*************************************************************/ 03978000
*       /*                                                           */ 03979000
*       /* FORMAT HMA410I MESSAGE                                    */ 03980000
*       /*                                                           */ 03981000
*       /*************************************************************/ 03982000
*                                                                  0863 03983000
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */ 03984000
         LA    @08,MSGSMDNM                                        0863 03985000
         ST    @08,MGPVARPT                                        0863 03986000
*       MGPVARPT(2)=ADDR(VPART#3);  /* "OTHER" SYSMOD-ID #           */ 03987000
         LA    @08,VPART#3                                         0864 03988000
         ST    @08,MGPVARPT+4                                      0864 03989000
*       MGPVARPT(3)=ADDR(VPART#2);  /* "CURRENT" ELEMENT NAME        */ 03990000
         LA    @08,VPART#2                                         0865 03991000
         ST    @08,MGPVARPT+8                                      0865 03992000
*     END;                                                         0866 03993000
*   IF MSGCODE1=HMA415I THEN                                       0867 03994000
@RF00861 L     @08,@PC00011                                        0867 03995000
         CLI   MSGCODE1(@08),216                                   0867 03996000
         BNE   @RF00867                                            0867 03997000
*     DO;                                                          0868 03998000
*                                                                  0868 03999000
*       /*************************************************************/ 04000000
*       /*                                                           */ 04001000
*       /* FORMAT HMA415I MESSAGE                                    */ 04002000
*       /*                                                           */ 04003000
*       /*************************************************************/ 04004000
*                                                                  0869 04005000
*       MGPVARPT(1)=ADDR(VPART#2);  /* "CURRENT" ELEMENT NAME        */ 04006000
         LA    @08,VPART#2                                         0869 04007000
         ST    @08,MGPVARPT                                        0869 04008000
*       MGPVARPT(2)=ADDR(MSGXCDS);  /* "CDS" OR "ACDS"               */ 04009000
         LA    @08,MSGXCDS                                         0870 04010000
         ST    @08,MGPVARPT+4                                      0870 04011000
*       MGPVARPT(3)=ADDR(VPART#1);  /* "CURRENT" ELEMENT TYPE        */ 04012000
         LA    @08,VPART#1                                         0871 04013000
         ST    @08,MGPVARPT+8                                      0871 04014000
*       MGPVARPT(4)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */ 04015000
         LA    @08,MSGSMDNM                                        0872 04016000
         ST    @08,MGPVARPT+12                                     0872 04017000
*     END;                                                         0873 04018000
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE THE MESSAGE             */ 04019000
*                                                                  0874 04020000
@RF00867 L     @15,@CV01713                                        0874 04021000
         LA    @01,@AL00874                                        0874 04022000
         BALR  @14,@15                                             0874 04023000
*   /*****************************************************************/ 04024000
*   /*                                                               */ 04025000
*   /* SET HIGHTMS RETURN CODE BASED UPON MGPTYPE                    */ 04026000
*   /*                                                               */ 04027000
*   /*****************************************************************/ 04028000
*                                                                  0875 04029000
*   IF MGPTYPE=MGPWARN THEN                                        0875 04030000
         CLI   MGPTYPE,2                                           0875 04031000
         BNE   @RF00875                                            0875 04032000
*     HIGHTMS=MAX(HIGHTMS,PTFWARN); /* WARNING                       */ 04033000
         LA    @08,4                                               0876 04034000
         CR    HIGHTMS,@08                                         0876 04035000
         BNL   *+6                                                      04036000
         LR    HIGHTMS,@08                                         0876 04037000
*   ELSE                                                           0877 04038000
*     IF MGPTYPE=MGPERR THEN                                       0877 04039000
         B     @RC00875                                            0877 04040000
@RF00875 CLI   MGPTYPE,3                                           0877 04041000
         BNE   @RF00877                                            0877 04042000
*       HIGHTMS=MAX(HIGHTMS,STOPPTF);/* STOP-SYSMOD                  */ 04043000
         LA    @08,8                                               0878 04044000
         CR    HIGHTMS,@08                                         0878 04045000
         BNL   *+6                                                      04046000
         LR    HIGHTMS,@08                                         0878 04047000
*     ELSE                                                         0879 04048000
*       IF MGPTYPE=MGPSEV THEN                                     0879 04049000
         B     @RC00877                                            0879 04050000
@RF00877 CLI   MGPTYPE,4                                           0879 04051000
         BNE   @RF00879                                            0879 04052000
*         HIGHTMS=MAX(HIGHTMS,STOPFUNC);/* SEVERE                    */ 04053000
         LA    @08,12                                              0880 04054000
         CR    HIGHTMS,@08                                         0880 04055000
         BNL   *+6                                                      04056000
         LR    HIGHTMS,@08                                         0880 04057000
*       ELSE                                                       0881 04058000
*         IF MGPTYPE=MGPTERM THEN                                  0881 04059000
         B     @RC00879                                            0881 04060000
@RF00879 CLI   MGPTYPE,5                                           0881 04061000
         BNE   @RF00881                                            0881 04062000
*           HIGHTMS=MAX(HIGHTMS,STOPSMP);/* TERMINATING              */ 04063000
         LA    @08,16                                              0882 04064000
         CR    HIGHTMS,@08                                         0882 04065000
         BNL   *+6                                                      04066000
         LR    HIGHTMS,@08                                         0882 04067000
*   RETURN;                                                        0883 04068000
@EL00011 DS    0H                                                  0883 04069000
@EF00011 DS    0H                                                  0883 04070000
@ER00011 LM    @14,@04,@SA00011                                    0883 04071000
         LM    @06,@12,@SA00011+28                                 0883 04072000
         BR    @14                                                 0883 04073000
*   END ERRMSG;                                                    0884 04074000
         B     @EL00011                                            0884 04075000
*                                                                  0885 04076000
*/********************************************************************/ 04077000
*/*                                                                  */ 04078000
*/*    ASSEMCHK - FOR SELECTED ++SRC, ++SRCUPD, ++MAC AND ++MACUPD   */ 04079000
*/*               ELEMENTS WHICH CAUSE ASSEMBLIES, THIS PROCEDURE    */ 04080000
*/*               INSURES THAT THE "CURRENT" SYSMOD PREREQS AND      */ 04081000
*/*               OR SUPERSEDES ALL MODIDS IN THE CORRESPONDING      */ 04082000
*/*               TARGET SYSTEM MOD ENTRY WHICH WILL BE REPLACED     */ 04083000
*/*               WHEN THE ASSEMBLY PERFORMED FOR THE "CURRENT"      */ 04084000
*/*               ELEMENT IS INSTALLED                               */ 04085000
*/*                                                                  */ 04086000
*/*               RULES:                                             */ 04087000
*/*                                                                  */ 04088000
*/*               (1) IF THE LASTRMID IS NOT THE RESULT OF AN        */ 04089000
*/*                   ASSEMBLY, THE LASTRMID MUST BE PREREQD OR      */ 04090000
*/*                   SUPERSEDED BY THE "CURRENT" SYSMOD.            */ 04091000
*/*                                                                  */ 04092000
*/*                   IF THE LASTRMID IS THE RESULT OF AN ASSEMBLY   */ 04093000
*/*                   AND IT IS NOT PREREQD OR SUPERSEDED BY THE     */ 04094000
*/*                   "CURRENT" SYSMOD, "ASMREQD" WILL BE SET TO     */ 04095000
*/*                   FORCE THE ASSEMBLY OF THE ELEMENT ... THE      */ 04096000
*/*                   ASSUMPTION BEING THAT THE CHANGES WHICH        */ 04097000
*/*                   REQUIRED THE LAST ASSEMBLY (I.E. , MACROS AND  */ 04098000
*/*                   SOURCE REPLACEMENTS/UPDATES) WILL BE           */ 04099000
*/*                   INCORPORATED WHEN THE ASSEMBLY IS DONE.        */ 04100000
*/*                                                                  */ 04101000
*/*               (2) IF THE LASTRMID IS ON THE (A)CDS,              */ 04102000
*/*                                                                  */ 04103000
*/*                   * ALL UMIDS IN THESE LISTS REPRESENT ZAPS TO   */ 04104000
*/*                     THE MOD WHICH MUST BE SUPERSEDED BY THE      */ 04105000
*/*                     SYSMOD CAUSING THE ASSEMBLY.  ANY WHICH      */ 04106000
*/*                     ARE NOT WILL BE REPORTED (HMA319I).          */ 04107000
*/*                                                                  */ 04108000
*/*                   * THERE MAY BE A ZAP IN THE ICT FOR THE        */ 04109000
*/*                     ELEMENT.  IT TOO MUST BE PREREQD OR SUPD.    */ 04110000
*/*                                                                  */ 04111000
*/*               (3) IF THE LASTRMID IS IN THE ICT,                 */ 04112000
*/*                                                                  */ 04113000
*/*                   * THE MODID LISTS IN THE ASSEM ENTRIES ARE     */ 04114000
*/*                     NOT USED.  THE REPLACEMENT IN THE ICT IS     */ 04115000
*/*                     ALL THAT NEED BE PREREQD OR SUPD.            */ 04116000
*/*                                                                  */ 04117000
*/*                   * THERE MAY BE A ZAP IN THE ICT FOR THE        */ 04118000
*/*                     ELEMENT.  IT MUST BE PREREQD OR SUPD.        */ 04119000
*/*                                                                  */ 04120000
*/*    CONDITIONS UPON ENTRY:                                        */ 04121000
*/*                                                                  */ 04122000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 04123000
*/*                                                                  */ 04124000
*/*                  ANY ASSEMBLIES REQUIRED BY THIS ELEMENT SHOULD  */ 04125000
*/*                  BE REPRESENTED BY ASSEM MOD SECTION ENTRIES     */ 04126000
*/*                  WHICH ARE POINTED TO BY ICTASMLS.  THE MODID    */ 04127000
*/*                  LISTS IN THESE ASSEM ENTRIES MUST BE INITIALIZED*/ 04128000
*/*                                                                  */ 04129000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 04130000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 04131000
*/*                                                                  */ 04132000
*/*    CONDITIONS UPON EXIT:                                         */ 04133000
*/*                                                                  */ 04134000
*/*    ---> IN ENTRY FOR ELEMENT PASSED <--------------------------- */ 04135000
*/*                                                                  */ 04136000
*/*     * ICTMISEL - '1' IF ELEMENT  SHOULD BE SELECTED              */ 04137000
*/*                  '0' IF ELEMENT  SHOULD NOT BE SELECTED          */ 04138000
*/*                                                                  */ 04139000
*/*     * ICTMMIDE - '1' IF ID CHECK ERROR FOR AN ASSEMBLY CAUSES    */ 04140000
*/*                      ELEMENT TO NOT BE SELECTED                  */ 04141000
*/*                  '0' IF ASSEMBLIES CHECKED OK                    */ 04142000
*/*                                                                  */ 04143000
*/*    ---> IN ASSEMBLY ENTRIES ASSOCIATED WITH ELEMENT PASSED <---  */ 04144000
*/*                                                                  */ 04145000
*/*     * ICTMISEL - '1' IF ASSEMBLY SHOULD BE SELECTED              */ 04146000
*/*                  '0' IF ASSEMBLY SHOULD NOT BE SELECTED          */ 04147000
*/*                                                                  */ 04148000
*/*     * ICTMFMID - INITIALIZED IN ASSEM ENTRIES TO THE FMID OF     */ 04149000
*/*                  THE MOST RECENTLY SELECTED VERSION OF THE       */ 04150000
*/*                  ELEMENT.                                        */ 04151000
*/*                                                                  */ 04152000
*/*     * ICTMRMID - INITIALIZED IN ASSEM ENTRIES TO THE "CURRENT"   */ 04153000
*/*                  SYSMOD.                                         */ 04154000
*/*                                                                  */ 04155000
*/********************************************************************/ 04156000
*                                                                  0885 04157000
*ASSEMCHK:                                                         0885 04158000
*   PROC;                                                          0885 04159000
ASSEMCHK STM   @14,@04,@SA00012                                    0885 04160000
         STM   @06,@12,@SA00012+28                                 0885 04161000
*   DCL                                                            0886 04162000
*     MM FIXED(15);                 /* INDEX - ICT MOD SECT ASSEMBLY    04163000
*                                      ENTRIES FOR "CURRENT" ELEMENT */ 04164000
*   DCL                                                            0887 04165000
*     M1 FIXED(15);                 /* INDEX - ICT MOD SECT ENTRIES  */ 04166000
*   DCL                                                            0888 04167000
*     1 * BIT(8),                   /* LOCAL FLAGS                   */ 04168000
*      2 ASMIDERR BIT(1),           /* AN ASSEMBLY HAD RMID/UMID ERR */ 04169000
*      2 ASMREQ1 BIT(1),            /* ASSEMBLY REQUIRED             */ 04170000
*      2 * BIT(6);                  /* UN-USED                       */ 04171000
*   RESPECIFY                                                      0889 04172000
*     ICTMOD BASED(SAVCMOD);        /* ADDRESS MOD ENTRY PASSED      */ 04173000
*   RESPECIFY                                                      0890 04174000
*     ICTASMLS BASED(ICTMACHN(1));  /* ADDRESS LIST OF ASSEMBLY ENTRY   04175000
*                                      ADDRESSES IN ELEMENT PASSED   */ 04176000
*   SAVCMOD=CMOD;                   /* SAVE "CURRENT" ELEMENT PTR    */ 04177000
         L     SAVCMOD,CMOD                                        0891 04178000
*   SAVLFMID=LASTFMID;              /* SAVE LAST FMID SYSMOD-ID      */ 04179000
         MVC   SAVLFMID(7),LASTFMID                                0892 04180000
*   SAVLRMID=LASTRMID;              /* SAVE LAST RMID SYSMOD-ID      */ 04181000
         MVC   SAVLRMID(7),LASTRMID                                0893 04182000
*   SAVLRLM@=LREPELM@;              /* SAVE PTR TO LAST REPL IN ICT  */ 04183000
         L     SAVLRLM@,LREPELM@                                   0894 04184000
*   SAVSEFLG=SELEXCL;               /* SAVE SELECT/EXCLUDE FLAGS     */ 04185000
         MVC   SAVSEFLG(2),SELEXCL                                 0895 04186000
*   ASSEMFLG=ON;                    /* SET FLAG WHILE PROCESSING   0896 04187000
*                                      ASSEMBLY ENTRIES              */ 04188000
         OI    ASSEMFLG,B'10000000'                                0896 04189000
*   MSG382I=OFF;                    /* CLEAR HMA382 ISSUED FLAG      */ 04190000
         NI    MSG382I,B'11011111'                                 0897 04191000
*   VPART#6=MSGASSEM;               /* FILL IN MSG VARIABLE PART     */ 04192000
         MVC   VPART#6(8),@CC01835                                 0898 04193000
*   ASMIDERR=OFF;                   /* CLEAR LOCAL FLAG              */ 04194000
*   ASMREQ1=OFF;                    /* CLEAR LOCAL FLAG              */ 04195000
         NI    ASMIDERR,B'00111111'                                0900 04196000
*                                                                  0901 04197000
*   /*****************************************************************/ 04198000
*   /*                                                               */ 04199000
*   /* GO THRU ASSEMBLY ENTRIES FOR ELEMENT PASSED                   */ 04200000
*   /*                                                               */ 04201000
*   /*****************************************************************/ 04202000
*                                                                  0901 04203000
*   DO MM=1 BY 1 WHILE ICTASMND(MM)^=ICTENDIX;                     0901 04204000
         LA    MM,1                                                0901 04205000
         B     @DE00901                                            0901 04206000
@DL00901 DS    0H                                                  0902 04207000
*     SELEXCL=''B;                  /* CLEAR SELECT/EXCLUDE FLAGS    */ 04208000
         XC    SELEXCL(2),SELEXCL                                  0902 04209000
*     CMOD=ICTASMAD(MM);            /* POINT TO ASSEMBLY ENTRY       */ 04210000
*                                                                  0903 04211000
         LR    @08,MM                                              0903 04212000
         SLA   @08,2                                               0903 04213000
         MVC   @TF00001(4),ICTMACHN(SAVCMOD)                       0903 04214000
         L     @03,@TF00001                                        0903 04215000
         AL    @03,@CF02030                                        0903 04216000
         L     @08,ICTASMAD(@08,@03)                               0903 04217000
         ST    @08,CMOD                                            0903 04218000
*     /***************************************************************/ 04219000
*     /*                                                             */ 04220000
*     /* INITIALIZE FMID AND RMID FIELDS IN ASSEMBLY ENTRY           */ 04221000
*     /*                                                             */ 04222000
*     /***************************************************************/ 04223000
*                                                                  0904 04224000
*     CMOD->ICTMRMID(1)=CPTF->ICTPTFS(1);/* "CURRENT" SYSMOD BECOMES    04225000
*                                      RMID                          */ 04226000
         L     @03,@PC00001+4                                      0904 04227000
         L     @03,CPTF(,@03)                                      0904 04228000
         MVC   ICTMRMID(7,@08),ICTPTFS(@03)                        0904 04229000
*     CMOD->ICTMFMID(1)=NULLPTF#;   /* BLANK FMID FIELD FOR NOW      */ 04230000
         MVC   ICTMFMID(7,@08),@CC01719                            0905 04231000
*     IF SAVCMOD->ICTMSRCR(1)=ON    /* ASSEM FOR ++SRC               */ 04232000
*         |SAVCMOD->ICTMSRCU(1)=ON  /* ASSEM FOR ++SRCUPD            */ 04233000
*       THEN                                                       0906 04234000
         TM    ICTMSRCR(SAVCMOD),B'00000011'                       0906 04235000
         BZ    @RF00906                                            0906 04236000
*       DO;                                                        0907 04237000
*                                                                  0907 04238000
*         /***********************************************************/ 04239000
*         /*                                                         */ 04240000
*         /* ++SRC OR ++SRCUPD ELEMENT                               */ 04241000
*         /*                                                         */ 04242000
*         /***********************************************************/ 04243000
*                                                                  0908 04244000
*         CMOD->ICTMFMID(1)=SAVCMOD->ICTMFMID(1);/* FMID IS SAME AS     04245000
*                                      SOURCE OR SOURCE UPDATE       */ 04246000
         MVC   ICTMFMID(7,@08),ICTMFMID(SAVCMOD)                   0908 04247000
*         CMOD->ICTMVCHN(1)=SAVCMOD->ICTMVCHN(1);/* VERSION LIST     */ 04248000
         MVC   ICTMVCHN(4,@08),ICTMVCHN(SAVCMOD)                   0909 04249000
*       END;                                                       0910 04250000
*     IF CMOD->ICTMFMID(1)=NULLPTF# /* FMID NOT YET DETERMINED       */ 04251000
*       THEN                                                       0911 04252000
@RF00906 L     @08,CMOD                                            0911 04253000
         CLC   ICTMFMID(7,@08),@CC01719                            0911 04254000
         BNE   @RF00911                                            0911 04255000
*       DO;                                                        0912 04256000
*                                                                  0912 04257000
*         /***********************************************************/ 04258000
*         /*                                                         */ 04259000
*         /* ++MAC OR ++MACUPD ELEMENT ... SEE IF ASSEMBLY CALLED FOR*/ 04260000
*         /* IS A ++SRC/++SRCUPD SUPPLIED IN "CURRENT" (WHICH IS     */ 04261000
*         /* SELECTED)                                               */ 04262000
*         /*                                                         */ 04263000
*         /***********************************************************/ 04264000
*                                                                  0913 04265000
*         DO M1=1 BY 1 WHILE CCAICMOD->ICTMEND(M1)^=ICTENDNT;      0913 04266000
         LA    M1,1                                                0913 04267000
         B     @DE00913                                            0913 04268000
@DL00913 DS    0H                                                  0914 04269000
*           IF CCAICMOD->ICTMNAME(M1)=CMOD->ICTMNAME(1)/* SAME NAME  */ 04270000
*               &CCAICMOD->ICTMISEL(M1)=ON/* SELECTED                */ 04271000
*               &CCAICMOD->ICTPPTR(M1)=CPTF/* FROM "CURRENT" SYSMOD  */ 04272000
*               &(CCAICMOD->ICTMSRCR(M1)=ON/* ICT SRC REPLACEMENT    */ 04273000
*               |CCAICMOD->ICTMSRCU(M1)=ON)/* ICT SRC UPDATE         */ 04274000
*             THEN                                                 0914 04275000
         LR    @08,M1                                              0914 04276000
         MH    @08,@CH02013                                        0914 04277000
         L     @15,CCAICMOD(,CCAPTR)                               0914 04278000
         L     @14,CMOD                                            0914 04279000
         ST    @08,@TF00001                                        0914 04280000
         ALR   @08,@15                                             0914 04281000
         AL    @08,@CF02036                                        0914 04282000
         CLC   ICTMNAME(8,@08),ICTMNAME(@14)                       0914 04283000
         BNE   @RF00914                                            0914 04284000
         LR    @08,@15                                             0914 04285000
         AL    @08,@TF00001                                        0914 04286000
         AL    @08,@CF02033                                        0914 04287000
         TM    ICTMISEL-11(@08),B'10000000'                        0914 04288000
         BNO   @RF00914                                            0914 04289000
         L     @08,@PC00001+4                                      0914 04290000
         L     @01,@TF00001                                        0914 04291000
         AL    @01,@CF02034                                        0914 04292000
         L     @01,ICTPPTR-96(@01,@15)                             0914 04293000
         C     @01,CPTF(,@08)                                      0914 04294000
         BNE   @RF00914                                            0914 04295000
         AL    @15,@TF00001                                        0914 04296000
         AL    @15,@CF02049                                        0914 04297000
         TM    ICTMSRCR-9(@15),B'00000011'                         0914 04298000
         BZ    @RF00914                                            0914 04299000
*             DO;                                                  0915 04300000
*               CMOD->ICTMFMID(1)=SAVCMOD->ICTMFMID(1);/* FMID IS  0916 04301000
*                                      SAME AS CAUSER OF ASSEMBLY    */ 04302000
         MVC   ICTMFMID(7,@14),ICTMFMID(SAVCMOD)                   0916 04303000
*               CMOD->ICTMVCHN(1)=SAVCMOD->ICTMVCHN(1);/* VERSION  0917 04304000
*                                      LIST                          */ 04305000
         MVC   ICTMVCHN(4,@14),ICTMVCHN(SAVCMOD)                   0917 04306000
*             END;                                                 0918 04307000
*         END;                                                     0919 04308000
@RF00914 AH    M1,@CH00067                                         0919 04309000
@DE00913 LR    @08,M1                                              0919 04310000
         MH    @08,@CH02013                                        0919 04311000
         L     @01,CCAICMOD(,CCAPTR)                               0919 04312000
         ALR   @01,@08                                             0919 04313000
         AL    @01,@CF02036                                        0919 04314000
         MVC   @TF00001(4),ICTMEND(@01)                            0919 04315000
         L     @08,@TF00001                                        0919 04316000
         CL    @08,ICTENDNT                                        0919 04317000
         BNE   @DL00913                                            0919 04318000
*       END;                                                       0920 04319000
*     IF CMOD->ICTMFMID(1)=NULLPTF# /* FMID NOT YET DETERMINED       */ 04320000
*       THEN                                                       0921 04321000
@RF00911 L     @08,CMOD                                            0921 04322000
         CLC   ICTMFMID(7,@08),@CC01719                            0921 04323000
         BNE   @RF00921                                            0921 04324000
*       DO;                                                        0922 04325000
*         CALL GETMIDS;             /* GET THE FMID OF THE LAST    0923 04326000
*                                      VERSION OF THIS ELEMENT       */ 04327000
         BAL   @14,GETMIDS                                         0923 04328000
*         IF LASTFMID^=NULLPTF# THEN                               0924 04329000
         CLC   LASTFMID(7),@CC01719                                0924 04330000
         BE    @RF00924                                            0924 04331000
*           CMOD->ICTMFMID(1)=LASTFMID;/* FMID BECOMES THAT OF LAST  */ 04332000
         L     @08,CMOD                                            0925 04333000
         MVC   ICTMFMID(7,@08),LASTFMID                            0925 04334000
*         ELSE                                                     0926 04335000
*           ;                       /* LEAVE ASSEMBLY ELEMENT FMID 0926 04336000
*                                      "BLANK"                       */ 04337000
@RF00924 DS    0H                                                  0927 04338000
*         CMOD->ICTMVCHN(1)=TBLXNULL;/* NO VERSION LIST              */ 04339000
         L     @08,@PC00001                                        0927 04340000
         L     @03,CMOD                                            0927 04341000
         MVC   ICTMVCHN(4,@03),TBLXNULL(@08)                       0927 04342000
*       END;                                                       0928 04343000
*     VPART#7=CMOD->ICTMNAME(1);    /* PUT ASSEMBLY NAME IN MSG PART */ 04344000
*                                                                  0929 04345000
@RF00921 L     @08,CMOD                                            0929 04346000
         MVC   VPART#7(8),ICTMNAME(@08)                            0929 04347000
*     /***************************************************************/ 04348000
*     /*                                                             */ 04349000
*     /* DETERMINE WHETHER ASSEMBLY CAN BE SELECTED                  */ 04350000
*     /*                                                             */ 04351000
*     /***************************************************************/ 04352000
*                                                                  0930 04353000
*     CALL REPELEM;                 /* PROCESS ASSEMBLY AS A       0930 04354000
*                                      REPLACEMENT ELEMENT           */ 04355000
         BAL   @14,REPELEM                                         0930 04356000
*     IF ASMREQD=ON                 /* ASSEMBLY IS REQUIRED          */ 04357000
*       THEN                                                       0931 04358000
         TM    ASMREQD,B'00010000'                                 0931 04359000
         BNO   @RF00931                                            0931 04360000
*       ASMREQ1=ON;                 /* SET LOCAL ASSEM REQUIRED FLAG */ 04361000
         OI    ASMREQ1,B'01000000'                                 0932 04362000
*     IF CMOD->ICTMISEL(1)=OFF      /* ASSEMBLY NOT SELECTED         */ 04363000
*         &CMOD->ICTMMIDE(1)=ON     /* DUE TO ID CHECK ERROR         */ 04364000
*       THEN                                                       0933 04365000
@RF00931 L     @08,CMOD                                            0933 04366000
         TM    ICTMMIDE(@08),B'00001000'                           0933 04367000
         BNO   @RF00933                                            0933 04368000
         TM    ICTMISEL(@08),B'10000000'                           0933 04369000
         BNZ   @RF00933                                            0933 04370000
*       ASMIDERR=ON;                /* SET LOCAL ID CHECK ERR FLAG   */ 04371000
         OI    ASMIDERR,B'10000000'                                0934 04372000
*   END;                            /* END LOOP THRU ALL ASSEMBLIES  */ 04373000
@RF00933 AH    MM,@CH00067                                         0935 04374000
@DE00901 LR    @08,MM                                              0935 04375000
         SLA   @08,2                                               0935 04376000
         MVC   @TF00001(4),ICTMACHN(SAVCMOD)                       0935 04377000
         L     @03,@TF00001                                        0935 04378000
         AL    @03,@CF02030                                        0935 04379000
         L     @08,ICTASMND(@08,@03)                               0935 04380000
         CL    @08,ICTENDIX                                        0935 04381000
         BNE   @DL00901                                            0935 04382000
*                                                                  0936 04383000
*   /*****************************************************************/ 04384000
*   /*                                                               */ 04385000
*   /* ALL ASSEMBLIES REQUIRED FOR THE "CURRENT" ELEMENT HAVE BEEN   */ 04386000
*   /* CHECKED                                                       */ 04387000
*   /*                                                               */ 04388000
*   /*****************************************************************/ 04389000
*                                                                  0936 04390000
*   CMOD=SAVCMOD;                   /* RESTORE PTR TO "CURRENT" ELEM */ 04391000
         ST    SAVCMOD,CMOD                                        0936 04392000
*   LASTFMID=SAVLFMID;              /* RESTORE LASTFMID              */ 04393000
         MVC   LASTFMID(7),SAVLFMID                                0937 04394000
*   LASTRMID=SAVLRMID;              /* RESTORE LASTRMID              */ 04395000
         MVC   LASTRMID(7),SAVLRMID                                0938 04396000
*   LREPELM@=SAVLRLM@;              /* RESTORE LREPELM@              */ 04397000
         ST    SAVLRLM@,LREPELM@                                   0939 04398000
*   SELEXCL=SAVSEFLG;               /* RESTORE SELEXCL FLAGS         */ 04399000
         MVC   SELEXCL(2),SAVSEFLG                                 0940 04400000
*   IF ASMIDERR=ON                  /* AN ASSEM HAD ID CHECK ERROR   */ 04401000
*     THEN                                                         0941 04402000
         TM    ASMIDERR,B'10000000'                                0941 04403000
         BNO   @RF00941                                            0941 04404000
*     DO;                                                          0942 04405000
*       ICTMISEL(1)=OFF;            /* "CURRENT" ELEMENT CANNOT BE 0943 04406000
*                                      SELECTED                      */ 04407000
*       ICTMMIDE(1)=ON;             /* DUE TO ID CHECK ERROR FOR AN     04408000
*                                      ASSEMBLY                      */ 04409000
         OI    ICTMMIDE(SAVCMOD),B'00001000'                       0944 04410000
         NI    ICTMISEL(SAVCMOD),B'01111111'                       0944 04411000
*       ASMREQ1=OFF;                /* CLEAR LOCAL ASSEM REQ'D FLAG  */ 04412000
         NI    ASMREQ1,B'10111111'                                 0945 04413000
*     END;                                                         0946 04414000
*   IF ASMREQ1=ON                   /* ONE OR MORE OF THE ASSEMBLIES    04415000
*                                      WAS REQUIRED BECAUSE IT     0947 04416000
*                                      INTERSECTED WITH AN ASSEMBLED    04417000
*                                      MODULE                        */ 04418000
*     THEN                                                         0947 04419000
@RF00941 TM    ASMREQ1,B'01000000'                                 0947 04420000
         BNO   @RF00947                                            0947 04421000
*     ASMREQD=ON;                   /* SET FLAG FOR CALLER'S USE     */ 04422000
         OI    ASMREQD,B'00010000'                                 0948 04423000
*   ASSEMFLG=OFF;                   /* RESET FLAG SET WHILE        0949 04424000
*                                      PROCESSING ASSEMBLY ENTRIES   */ 04425000
@RF00947 NI    ASSEMFLG,B'01111111'                                0949 04426000
*   RETURN;                                                        0950 04427000
@EL00012 DS    0H                                                  0950 04428000
@EF00012 DS    0H                                                  0950 04429000
@ER00012 LM    @14,@04,@SA00012                                    0950 04430000
         LM    @06,@12,@SA00012+28                                 0950 04431000
         BR    @14                                                 0950 04432000
*   END ASSEMCHK;                                                  0951 04433000
*                                                                  0952 04434000
*/********************************************************************/ 04435000
*/*                                                                  */ 04436000
*/*    ASSEMSEL - SET THE ICTMISEL FLAG IN ASSEMBLY ENTRIES CREATED  */ 04437000
*/*               ON BEHALF OF THE MACRO OR SOURCE ENTRY PASSED      */ 04438000
*/*                                                                  */ 04439000
*/*    CONDITIONS UPON ENTRY:                                        */ 04440000
*/*                                                                  */ 04441000
*/*     * ICTASMLS - INITIALIZED WITH POINTERS TO ASSEMBLY ENTRIES   */ 04442000
*/*                                                                  */ 04443000
*/*                                                                  */ 04444000
*/********************************************************************/ 04445000
*                                                                  0952 04446000
*ASSEMSEL:                                                         0952 04447000
*   PROC(XENTRY,XFLG);                                             0952 04448000
ASSEMSEL STM   @14,@12,12(@13)                                     0952 04449000
         MVC   @PC00013(8),0(@01)                                  0952 04450000
*   DCL                                                            0953 04451000
*     XENTRY CHAR(*);               /* ICT MOD SECT ENTRY            */ 04452000
*   DCL                                                            0954 04453000
*     XFLG CHAR(1);                 /* 'S' SET ICTMISEL FLAG "ON" ...   04454000
*                                      'R' SET ICTMISEL FLAG "OFF"   */ 04455000
*   DCL                                                            0955 04456000
*     NN FIXED(15);                 /* INDEX - ICTASMLS              */ 04457000
*   RESPECIFY                                                      0956 04458000
*     ICTMOD BASED(ADDR(XENTRY));   /* ADDRESS MOD SECT ENTRY PASSED */ 04459000
*   RESPECIFY                                                      0957 04460000
*     ICTASMLS BASED(ICTMACHN(1));  /* ADDRESS LIST OF ASSEM ENTRY 0957 04461000
*                                      ADDRESSES                     */ 04462000
*   IF ICTMACHN(1)^=0               /* THERE IS ASSEM ADDRESS LIST   */ 04463000
*     THEN                                                         0958 04464000
         L     @08,@PC00013                                        0958 04465000
         MVC   @TF00001(4),ICTMACHN(@08)                           0958 04466000
         L     @08,@TF00001                                        0958 04467000
         LTR   @08,@08                                             0958 04468000
         BZ    @RF00958                                            0958 04469000
*     DO;                                                          0959 04470000
*                                                                  0959 04471000
*       /*************************************************************/ 04472000
*       /*                                                           */ 04473000
*       /* GO THRU ASSEM ENTRIES IN ICTASMLS                         */ 04474000
*       /*                                                           */ 04475000
*       /*************************************************************/ 04476000
*                                                                  0960 04477000
*       DO NN=1 BY 1 WHILE ICTASMND(NN)^=ICTENDIX;                 0960 04478000
         LA    NN,1                                                0960 04479000
         B     @DE00960                                            0960 04480000
@DL00960 DS    0H                                                  0961 04481000
*         IF XFLG=SET               /* SET SELECT FLAG               */ 04482000
*           THEN                                                   0961 04483000
         L     @08,@PC00013+4                                      0961 04484000
         CLI   XFLG(@08),C'S'                                      0961 04485000
         BNE   @RF00961                                            0961 04486000
*           ICTASMAD(NN)->ICTMISEL(1)=ON;/* SET ICTMISEL             */ 04487000
         LR    @08,NN                                              0962 04488000
         SLA   @08,2                                               0962 04489000
         L     @03,@PC00013                                        0962 04490000
         MVC   @TF00001(4),ICTMACHN(@03)                           0962 04491000
         L     @03,@TF00001                                        0962 04492000
         AL    @03,@CF02030                                        0962 04493000
         L     @08,ICTASMAD(@08,@03)                               0962 04494000
         OI    ICTMISEL(@08),B'10000000'                           0962 04495000
*         ELSE                                                     0963 04496000
*           ICTASMAD(NN)->ICTMISEL(1)=OFF;/* CLEAR ICTMISEL          */ 04497000
         B     @RC00961                                            0963 04498000
@RF00961 LR    @08,NN                                              0963 04499000
         SLA   @08,2                                               0963 04500000
         L     @03,@PC00013                                        0963 04501000
         MVC   @TF00001(4),ICTMACHN(@03)                           0963 04502000
         L     @03,@TF00001                                        0963 04503000
         AL    @03,@CF02030                                        0963 04504000
         L     @08,ICTASMAD(@08,@03)                               0963 04505000
         NI    ICTMISEL(@08),B'01111111'                           0963 04506000
*       END;                                                       0964 04507000
@RC00961 AH    NN,@CH00067                                         0964 04508000
@DE00960 LR    @08,NN                                              0964 04509000
         SLA   @08,2                                               0964 04510000
         L     @03,@PC00013                                        0964 04511000
         MVC   @TF00001(4),ICTMACHN(@03)                           0964 04512000
         L     @03,@TF00001                                        0964 04513000
         AL    @03,@CF02030                                        0964 04514000
         L     @08,ICTASMND(@08,@03)                               0964 04515000
         CL    @08,ICTENDIX                                        0964 04516000
         BNE   @DL00960                                            0964 04517000
*     END;                                                         0965 04518000
*   RETURN;                                                        0966 04519000
@EL00013 DS    0H                                                  0966 04520000
@EF00013 DS    0H                                                  0966 04521000
@ER00013 LM    @14,@12,12(@13)                                     0966 04522000
         BR    @14                                                 0966 04523000
*   END ASSEMSEL;                                                  0967 04524000
         B     @EL00013                                            0967 04525000
*                                                                  0968 04526000
*/********************************************************************/ 04527000
*/*                                                                  */ 04528000
*/*    ZAPCHK   - CHECK ICT MOD SECTION FOR ANOTHER ZAP ENTRY        */ 04529000
*/*               FOR THE SAME ELEMENT AS THE ONE PASSED             */ 04530000
*/*                                                                  */ 04531000
*/*    CONDITIONS UPON ENTRY:                                        */ 04532000
*/*                                                                  */ 04533000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 04534000
*/*                                                                  */ 04535000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 04536000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 04537000
*/*                                                                  */ 04538000
*/*    CONDITIONS UPON EXIT:                                         */ 04539000
*/*                                                                  */ 04540000
*/*     * MULTIZAP - SET IF ANOTHER ZAP FOUND                        */ 04541000
*/*                                                                  */ 04542000
*/*     * HIGHTMS  - SET TO STOP-SYSMOD IF ANOTHER ZAP FOUND         */ 04543000
*/*                                                                  */ 04544000
*/*                                                                  */ 04545000
*/********************************************************************/ 04546000
*                                                                  0968 04547000
*ZAPCHK:                                                           0968 04548000
*   PROC;                                                          0968 04549000
ZAPCHK   STM   @14,@04,@SA00014                                    0968 04550000
         STM   @06,@12,@SA00014+28                                 0968 04551000
*   DCL                                                            0969 04552000
*     IZ FIXED(15);                 /* INDEX - ICT MOD SECTION       */ 04553000
*   RESPECIFY                                                      0970 04554000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 04555000
*                                                                  0970 04556000
*   /*****************************************************************/ 04557000
*   /*                                                               */ 04558000
*   /* GO THRU ICT MOD SECTION                                       */ 04559000
*   /*                                                               */ 04560000
*   /*****************************************************************/ 04561000
*                                                                  0971 04562000
*   DO IZ=1 BY 1 WHILE ICTMEND(IZ)^=ICTENDNT;                      0971 04563000
         LA    IZ,1                                                0971 04564000
         B     @DE00971                                            0971 04565000
@DL00971 DS    0H                                                  0972 04566000
*     IF ICTMNAME(IZ)=CMOD->ICTMNAME(1)/* ENTRY NAMES THE SAME       */ 04567000
*         &ICTMISEL(IZ)=ON          /* ENTRY SELECTED                */ 04568000
*         &ICTMZAP(IZ)=ON           /* ENTRY IS A ZAP                */ 04569000
*       THEN                                                       0972 04570000
         LR    @08,IZ                                              0972 04571000
         MH    @08,@CH02013                                        0972 04572000
         L     @04,CCAICMOD(,CCAPTR)                               0972 04573000
         ST    @08,@TF00001                                        0972 04574000
         ALR   @08,@04                                             0972 04575000
         AL    @08,@CF02036                                        0972 04576000
         L     @03,CMOD                                            0972 04577000
         CLC   ICTMNAME(8,@08),ICTMNAME(@03)                       0972 04578000
         BNE   @RF00972                                            0972 04579000
         LR    @08,@04                                             0972 04580000
         AL    @08,@TF00001                                        0972 04581000
         AL    @08,@CF02033                                        0972 04582000
         TM    ICTMISEL-11(@08),B'10000000'                        0972 04583000
         BNO   @RF00972                                            0972 04584000
         LR    @08,@04                                             0972 04585000
         AL    @08,@TF00001                                        0972 04586000
         AL    @08,@CF02049                                        0972 04587000
         TM    ICTMZAP-9(@08),B'00100000'                          0972 04588000
         BNO   @RF00972                                            0972 04589000
*       DO;                                                        0973 04590000
*                                                                  0973 04591000
*         /***********************************************************/ 04592000
*         /*                                                         */ 04593000
*         /* ANOTHER ZAP FOUND FOR THIS ELEMENT ... ISSUE HMA410I    */ 04594000
*         /*                                                         */ 04595000
*         /***********************************************************/ 04596000
*                                                                  0974 04597000
*         MGPTYPE=MGPERR;           /* STOP-SYSMOD ERROR             */ 04598000
         MVI   MGPTYPE,X'03'                                       0974 04599000
*         VPART#3=ICTPPTR(IZ)->ICTPTFS(1);/* OTHER SYSMOD WHICH    0975 04600000
*                                      SUPPLIED ZAP FOR THIS ELEMENT */ 04601000
         MVI   VPART#3+7,C' '                                      0975 04602000
         L     @08,@TF00001                                        0975 04603000
         AL    @04,@CF02034                                        0975 04604000
         L     @08,ICTPPTR-96(@08,@04)                             0975 04605000
         MVC   VPART#3(7),ICTPTFS(@08)                             0975 04606000
*         CALL ERRMSG(HMA410I,NOPART);/* ISSUE MESSAGE               */ 04607000
         LA    @01,@AL00976                                        0976 04608000
         BAL   @14,ERRMSG                                          0976 04609000
*         MULTIZAP=ON;              /* MULTIPLE ZAPS TO SAME ELEMENT */ 04610000
         OI    MULTIZAP,B'00000010'                                0977 04611000
*       END;                                                       0978 04612000
*   END;                                                           0979 04613000
@RF00972 AH    IZ,@CH00067                                         0979 04614000
@DE00971 LR    @08,IZ                                              0979 04615000
         MH    @08,@CH02013                                        0979 04616000
         L     @04,CCAICMOD(,CCAPTR)                               0979 04617000
         ALR   @04,@08                                             0979 04618000
         AL    @04,@CF02036                                        0979 04619000
         MVC   @TF00001(4),ICTMEND(@04)                            0979 04620000
         L     @08,@TF00001                                        0979 04621000
         CL    @08,ICTENDNT                                        0979 04622000
         BNE   @DL00971                                            0979 04623000
*   RETURN;                                                        0980 04624000
@EL00014 DS    0H                                                  0980 04625000
@EF00014 DS    0H                                                  0980 04626000
@ER00014 LM    @14,@04,@SA00014                                    0980 04627000
         LM    @06,@12,@SA00014+28                                 0980 04628000
         BR    @14                                                 0980 04629000
*   END ZAPCHK;                                                    0981 04630000
*                                                                  0982 04631000
*/********************************************************************/ 04632000
*/*                                                                  */ 04633000
*/*    XPNDSEL  - SELECT EXPAND ENTRIES IN THE ICT ASSOCIATED WITH   */ 04634000
*/*               A SELECTED ZAP ENTRY                               */ 04635000
*/*                                                                  */ 04636000
*/*    CONDITIONS UPON ENTRY:                                        */ 04637000
*/*                                                                  */ 04638000
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */ 04639000
*/*                  ... A SELECTED ZAP ENTRY                        */ 04640000
*/*                                                                  */ 04641000
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */ 04642000
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */ 04643000
*/*                                                                  */ 04644000
*/*                                                                  */ 04645000
*/********************************************************************/ 04646000
*                                                                  0982 04647000
*XPNDSEL:                                                          0982 04648000
*   PROC;                                                          0982 04649000
XPNDSEL  STM   @14,@12,12(@13)                                     0982 04650000
*   DCL                                                            0983 04651000
*     ZI FIXED(15);                 /* INDEX - CURRENT SYSMOD ELEMS. */ 04652000
*   RESPECIFY                                                      0984 04653000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */ 04654000
*   RESPECIFY                                                      0985 04655000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN    04656000
*                                      PTR ARRAY FOR "CURRENT" PTF 0985 04657000
*                                      ENTRY                         */ 04658000
*                                                                  0985 04659000
*   /*****************************************************************/ 04660000
*   /*                                                               */ 04661000
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */ 04662000
*   /*                                                               */ 04663000
*   /*****************************************************************/ 04664000
*                                                                  0986 04665000
*   DO ZI=1 BY 1 WHILE ICTIXP(ZI)^=ICTENDIX;                       0986 04666000
         LA    ZI,1                                                0986 04667000
         B     @DE00986                                            0986 04668000
@DL00986 DS    0H                                                  0987 04669000
*     RESPECIFY                                                    0987 04670000
*       ICTMOD BASED(ICTIXPF(ZI));  /* ADDRESS ELEMENT FROM "CURRENT"   04671000
*                                      SYSMOD                        */ 04672000
*     IF ICTMXPND(1)=ON             /* EXPAND MOD SECT ENTRY         */ 04673000
*         &ICTMNAME(1)=CMOD->ICTMNAME(1)/* MATCHES SELECTED ZAP      */ 04674000
*       THEN                                                       0988 04675000
         LR    @08,ZI                                              0988 04676000
         SLA   @08,2                                               0988 04677000
         L     @03,@PC00001+4                                      0988 04678000
         L     @03,CPTF(,@03)                                      0988 04679000
         L     @03,ICTPCHN(,@03)                                   0988 04680000
         AL    @03,@CF02030                                        0988 04681000
         L     @08,ICTIXPF(@08,@03)                                0988 04682000
         TM    ICTMXPND(@08),B'00010000'                           0988 04683000
         BNO   @RF00988                                            0988 04684000
         L     @03,CMOD                                            0988 04685000
         CLC   ICTMNAME(8,@08),ICTMNAME(@03)                       0988 04686000
         BNE   @RF00988                                            0988 04687000
*       ICTMISEL(1)=ON;             /* SELECT THE EXPAND             */ 04688000
         OI    ICTMISEL(@08),B'10000000'                           0989 04689000
*   END;                                                           0990 04690000
@RF00988 AH    ZI,@CH00067                                         0990 04691000
@DE00986 LR    @08,ZI                                              0990 04692000
         SLA   @08,2                                               0990 04693000
         L     @03,@PC00001+4                                      0990 04694000
         L     @03,CPTF(,@03)                                      0990 04695000
         L     @03,ICTPCHN(,@03)                                   0990 04696000
         AL    @03,@CF02030                                        0990 04697000
         L     @08,ICTIXP(@08,@03)                                 0990 04698000
         CL    @08,ICTENDIX                                        0990 04699000
         BNE   @DL00986                                            0990 04700000
*   RETURN;                                                        0991 04701000
@EL00015 DS    0H                                                  0991 04702000
@EF00015 DS    0H                                                  0991 04703000
@ER00015 LM    @14,@12,12(@13)                                     0991 04704000
         BR    @14                                                 0991 04705000
*   END XPNDSEL;                                                   0992 04706000
*   END HMASMTMS                                                   0993 04707000
*                                                                  0993 04708000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04709000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 04710000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 04711000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 04712000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 04713000
*                                                                  0993 04714000
*       ;                                                          0993 04715000
@DATA    DS    0H                                                       04716000
@CH00085 DC    H'0'                                                     04717000
@CH00067 DC    H'1'                                                     04718000
@CH00059 DC    H'8'                                                     04719000
@CH01821 DC    H'101'                                                   04720000
@CH01809 DC    H'120'                                                   04721000
@CH02013 DC    H'144'                                                   04722000
@CH01811 DC    H'182'                                                   04723000
@CH01813 DC    H'183'                                                   04724000
@CH01815 DC    H'211'                                                   04725000
@CH01817 DC    H'216'                                                   04726000
         DS    0F                                                       04727000
@AL00388 DC    A(@AFTEMPS+8)           LIST WITH   3 ARGUMENT(S)        04728000
         DC    A(@AFTEMPS+12)                                           04729000
         DC    A(ITYPE)                                                 04730000
@AL00442 EQU   *                       LIST WITH   2 ARGUMENT(S)        04731000
@AL00530 DC    A(LASTRMID)             LIST WITH   2 ARGUMENT(S)        04732000
         DC    A(TPSRTN)                                                04733000
@AL00459 DC    A(@CC01723)             LIST WITH   1 ARGUMENT(S)        04734000
@AL00460 EQU   *                       LIST WITH   1 ARGUMENT(S)        04735000
@AL00563 DC    A(@CC01721)             LIST WITH   1 ARGUMENT(S)        04736000
@AL00483 EQU   *                       LIST WITH   2 ARGUMENT(S)        04737000
@AL00551 EQU   *                       LIST WITH   2 ARGUMENT(S)        04738000
@AL00687 EQU   *                       LIST WITH   2 ARGUMENT(S)        04739000
@AL00725 DC    A(@CH01813+1)           LIST WITH   2 ARGUMENT(S)        04740000
         DC    A(@CH00085+1)                                            04741000
@AL00490 EQU   *                       LIST WITH   2 ARGUMENT(S)        04742000
@AL00558 EQU   *                       LIST WITH   2 ARGUMENT(S)        04743000
@AL00691 EQU   *                       LIST WITH   2 ARGUMENT(S)        04744000
@AL00728 DC    A(@CH01809+1)           LIST WITH   2 ARGUMENT(S)        04745000
         DC    A(@CH00085+1)                                            04746000
@AL00506 DC    A(@CH01811+1)           LIST WITH   2 ARGUMENT(S)        04747000
         DC    A(@CH00085+1)                                            04748000
@AL00514 DC    A(@CH01817+1)           LIST WITH   2 ARGUMENT(S)        04749000
         DC    A(@CH00085+1)                                            04750000
@AL00628 DC    A(CMOD)                 LIST WITH   3 ARGUMENT(S)        04751000
         DC    A(@AFTEMPS)                                              04752000
         DC    A(ITYPE)                                                 04753000
@AL00675 DC    A(CMOD)                 LIST WITH   3 ARGUMENT(S)        04754000
         DC    A(@AFTEMPS+4)                                            04755000
         DC    A(ITYPE)                                                 04756000
@AL00679 DC    A(UMIDSMID)             LIST WITH   2 ARGUMENT(S)        04757000
         DC    A(TPSRTN)                                                04758000
@AL00874 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        04759000
@AL00976 DC    A(@CH01815+1)           LIST WITH   2 ARGUMENT(S)        04760000
         DC    A(@CH00085+1)                                            04761000
         DS    0F                                                       04762000
@SA00001 DS    18F                                                      04763000
@PC00001 DS    2F                                                       04764000
@SA00002 DS    14F                                                      04765000
@SA00012 DS    14F                                                      04766000
@PC00009 DS    1F                                                       04767000
@PC00013 DS    2F                                                       04768000
@SA00003 DS    14F                                                      04769000
@SA00014 DS    14F                                                      04770000
@PC00008 DS    3F                                                       04771000
@SA00006 DS    15F                                                      04772000
@SA00007 DS    14F                                                      04773000
@PC00007 DS    1F                                                       04774000
@SA00011 DS    0F                                                       04775000
@PC00011 EQU   @SA00011+56                                              04776000
@SA00005 DS    0F                                                       04777000
@SA00010 DS    0F                                                       04778000
@PC00010 EQU   @SA00010+60                                              04779000
         DS    16F                                                      04780000
@AL00001 DS    3A                                                       04781000
@TF00001 DS    F                                                        04782000
@TF00002 DS    F                                                        04783000
@AFTEMPS DS    4F                                                       04784000
         DS    0F                                                       04785000
@CF02036 DC    F'-144'                                                  04786000
@CF02049 DC    F'-135'                                                  04787000
@CF02033 DC    F'-133'                                                  04788000
@CF02048 DC    F'-64'                                                   04789000
@CF02037 DC    F'-56'                                                   04790000
@CF02034 DC    F'-48'                                                   04791000
@CF02047 DC    F'-40'                                                   04792000
@CF02046 DC    F'-8'                                                    04793000
@CF02030 DC    F'-4'                                                    04794000
@CV01712 DC    V(HMASMIO)                                               04795000
@CV01713 DC    V(HMASMMSG)                                              04796000
@CV01714 DC    V(HMASMTPS)                                              04797000
         DS    0D                                                       04798000
CMOD     DS    A                                                        04799000
TPSRTN   DS    FL1                                                      04800000
ITYPE    DS    FL1                                                      04801000
@TS00001 DS    CL7                                                      04802000
@CC01823 DC    C'MOD     '                                              04803000
@CC01825 DC    C'ZAP     '                                              04804000
@CC01827 DC    C'MAC     '                                              04805000
@CC01829 DC    C'MACUPD  '                                              04806000
@CC01831 DC    C'SRC     '                                              04807000
@CC01833 DC    C'SRCUPD  '                                              04808000
@CC01835 DC    C'ASSEMBLY'                                              04809000
@CC01837 DC    C'RMID    '                                              04810000
@CC01839 DC    C'UMID    '                                              04811000
@CC01841 DC    C'SELECTED'                                              04812000
@CC01843 DC    C'SMPACDS '                                              04813000
@CC01845 DC    C'SMPCDS  '                                              04814000
@CC01719 DC    C'       '                                               04815000
@CC01721 DC    C'Y'                                                     04816000
@CC01723 DC    C'N'                                                     04817000
@CC01748 EQU   @CC01837                                                 04818000
         DS    CL2                                                      04819000
ICTENDCH DC    X'FFFFFFFF'                                              04820000
HMASMMGP DS    CL32                                                     04821000
         ORG   HMASMMGP                                                 04822000
MGPFIXED DS    CL12                                                     04823000
         ORG   MGPFIXED                                                 04824000
MGPCLEAR DS    CL6                                                      04825000
         ORG   MGPCLEAR                                                 04826000
MGPMGNO1 DS    FL2                                                      04827000
MGPMGNO2 DS    FL2                                                      04828000
MGPMGNO3 DS    FL2                                                      04829000
         ORG   MGPFIXED+6                                               04830000
MGPFLAGS DS    BL2                                                      04831000
         ORG   MGPFLAGS                                                 04832000
MGPPRINT DS    BL1                                                      04833000
MGPLIST  EQU   MGPFLAGS+0                                               04834000
MGPRPT   EQU   MGPFLAGS+0                                               04835000
MGPHLDS  EQU   MGPFLAGS+0                                               04836000
MGPWTOR  EQU   MGPFLAGS+0                                               04837000
MGPWTO   EQU   MGPFLAGS+0                                               04838000
MGPWTP   EQU   MGPFLAGS+0                                               04839000
@NM00239 EQU   MGPFLAGS+0                                               04840000
         ORG   MGPFIXED+8                                               04841000
MGPTYPE  DS    FL1                                                      04842000
@NM00240 DS    CL3                                                      04843000
         ORG   HMASMMGP+12                                              04844000
MGPVAR   DS    CL20                                                     04845000
         ORG   MGPVAR                                                   04846000
MGPVARPT DS    5A                                                       04847000
         ORG   HMASMMGP+32                                              04848000
TMSFLGS  DS    BL1                                                      04849000
         ORG   TMSFLGS                                                  04850000
ASSEMFLG DS    BL1                                                      04851000
@NM00241 EQU   TMSFLGS+0                                                04852000
@NM00242 EQU   TMSFLGS+0                                                04853000
         ORG   TMSFLGS+1                                                04854000
SELEXCL  DS    BL2                                                      04855000
         ORG   SELEXCL                                                  04856000
@NM00243 DS    BL1                                                      04857000
         ORG   @NM00243                                                 04858000
SELDONE  DS    BL1                                                      04859000
DELETED  EQU   @NM00243+0                                               04860000
UPDERROR EQU   @NM00243+0                                               04861000
VERSIOND EQU   @NM00243+0                                               04862000
EXCLUDED EQU   @NM00243+0                                               04863000
UPLEVEL  EQU   @NM00243+0                                               04864000
MULTIZAP EQU   @NM00243+0                                               04865000
@NM00244 EQU   @NM00243+0                                               04866000
         ORG   SELEXCL+1                                                04867000
@NM00245 DS    BL1                                                      04868000
         ORG   @NM00245                                                 04869000
IDERR    DS    BL1                                                      04870000
         ORG   IDERR                                                    04871000
RMIDERR  DS    BL1                                                      04872000
UMIDERR  EQU   IDERR+0                                                  04873000
MSG382I  EQU   IDERR+0                                                  04874000
         ORG   @NM00245+0                                               04875000
ASMREQD  EQU   @NM00245+0                                               04876000
REPFLG   EQU   @NM00245+0                                               04877000
UPDFLG   EQU   @NM00245+0                                               04878000
@NM00246 EQU   @NM00245+0                                               04879000
         ORG   SELEXCL+2                                                04880000
         DS    CL1                                                      04881000
@NM00247 DS    CL19                                                     04882000
         ORG   @NM00247                                                 04883000
LREPELM@ DS    AL4                                                      04884000
@NM00248 DS    BL1                                                      04885000
         ORG   @NM00248                                                 04886000
LRMIDASM DS    BL1                                                      04887000
         ORG   @NM00247+5                                               04888000
LASTIDS  DS    CL14                                                     04889000
         ORG   LASTIDS                                                  04890000
LASTFMID DS    CL7                                                      04891000
LASTRMID DS    CL7                                                      04892000
         ORG   @NM00247+19                                              04893000
SAVLFMID DS    CL7                                                      04894000
SAVLRMID DS    CL7                                                      04895000
SAVSEFLG DS    BL2                                                      04896000
MSGSMDNM DS    CL7                                                      04897000
MSGXCDS  DS    CL8                                                      04898000
         ORG   MSGXCDS                                                  04899000
@NM00249 DS    CL3                                                      04900000
MSGXCDSA DS    CL4                                                      04901000
@NM00250 DS    CL1                                                      04902000
         ORG   MSGXCDS+8                                                04903000
VPARTS   DS    CL56                                                     04904000
         ORG   VPARTS                                                   04905000
VP382I   DS    CL32                                                     04906000
         ORG   VP382I                                                   04907000
VPART#1  DS    CL8                                                      04908000
VPART#2  DS    CL8                                                      04909000
VPART#6  DS    CL8                                                      04910000
VPART#7  DS    CL8                                                      04911000
         ORG   VPARTS+32                                                04912000
VP319I   DS    CL24                                                     04913000
         ORG   VP319I                                                   04914000
VPART#3  DS    CL8                                                      04915000
VPART#4  DS    CL8                                                      04916000
VPART#5  DS    CL8                                                      04917000
         ORG   VPARTS+56                                                04918000
PATCHTMS DS    CL80                                                     04919000
         ORG   PATCHTMS                                                 04920000
@NM00251 DC    80X'FF'                                                  04921000
         ORG   PATCHTMS+80                                              04922000
UMIDSMID DS    CL7                                                      04923000
@NM00252 DS    BL1                                                      04924000
         ORG   @NM00252                                                 04925000
ASMIDERR DS    BL1                                                      04926000
ASMREQ1  EQU   @NM00252+0                                               04927000
@NM00253 EQU   @NM00252+0                                               04928000
         ORG   @NM00252+1                                               04929000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04930000
@01      EQU   01                                                       04931000
@02      EQU   02                                                       04932000
@03      EQU   03                                                       04933000
@04      EQU   04                                                       04934000
@05      EQU   05                                                       04935000
@06      EQU   06                                                       04936000
@07      EQU   07                                                       04937000
@08      EQU   08                                                       04938000
@09      EQU   09                                                       04939000
@10      EQU   10                                                       04940000
@11      EQU   11                                                       04941000
@12      EQU   12                                                       04942000
@13      EQU   13                                                       04943000
@14      EQU   14                                                       04944000
@15      EQU   15                                                       04945000
ZI       EQU   @02                                                      04946000
IZ       EQU   @02                                                      04947000
NN       EQU   @02                                                      04948000
M1       EQU   @03                                                      04949000
MM       EQU   @06                                                      04950000
TT       EQU   @02                                                      04951000
KK       EQU   @02                                                      04952000
RR       EQU   @02                                                      04953000
FF       EQU   @02                                                      04954000
SAVLRLM@ EQU   @07                                                      04955000
SAVCMOD  EQU   @02                                                      04956000
HIGHTMS  EQU   @05                                                      04957000
J        EQU   @03                                                      04958000
I        EQU   @02                                                      04959000
IOPPTR   EQU   @04                                                      04960000
CCAPTR   EQU   @11                                                      04961000
REG1     EQU   @01                                                      04962000
REG14    EQU   @14                                                      04963000
REG15    EQU   @15                                                      04964000
RTNCODE  EQU   @15                                                      04965000
RTNREG   EQU   @14                                                      04966000
TBLXOPTS EQU   0                                                        04967000
TBLFLAGS EQU   TBLXOPTS+8                                               04968000
TBLFLG1  EQU   TBLFLAGS                                                 04969000
TBLASSEM EQU   TBLFLG1                                                  04970000
TBLFLG2  EQU   TBLFLAGS+2                                               04971000
TBLFLG3  EQU   TBLFLAGS+3                                               04972000
TBLFLG4  EQU   TBLFLAGS+5                                               04973000
TBLBPID  EQU   TBLFLG4                                                  04974000
TBLFLG5  EQU   TBLFLAGS+7                                               04975000
HMASMCCA EQU   0                                                        04976000
CCAFBUFR EQU   HMASMCCA+4                                               04977000
CCADSAD  EQU   CCAFBUFR+124                                             04978000
CCATPAD  EQU   CCAFBUFR+128                                             04979000
CCAFLAG7 EQU   CCAFBUFR+132                                             04980000
CCAFIOP  EQU   HMASMCCA+140                                             04981000
CCAIOPTR EQU   CCAFIOP                                                  04982000
CCAFSYS  EQU   HMASMCCA+148                                             04983000
CCASREL  EQU   CCAFSYS+12                                               04984000
CCAFLAGA EQU   CCAFSYS+21                                               04985000
CCAFSTA  EQU   HMASMCCA+188                                             04986000
CCAFICT  EQU   HMASMCCA+192                                             04987000
CCAICT   EQU   CCAFICT                                                  04988000
CCAICPTF EQU   CCAFICT+4                                                04989000
CCAICMOD EQU   CCAFICT+8                                                04990000
CCAICLMD EQU   CCAFICT+12                                               04991000
CCAFPGM  EQU   HMASMCCA+208                                             04992000
CCABLDLP EQU   CCAFPGM                                                  04993000
CCADBLDL EQU   CCAFPGM+4                                                04994000
CCAFGTP  EQU   HMASMCCA+224                                             04995000
CCASEGTP EQU   CCAFGTP                                                  04996000
@NM00023 EQU   HMASMCCA+244                                             04997000
CCAFFUNC EQU   HMASMCCA+264                                             04998000
CCAFLAG1 EQU   CCAFFUNC+8                                               04999000
CCAAPPLY EQU   CCAFLAG1                                                 05000000
CCAFLAG2 EQU   CCAFFUNC+11                                              05001000
CCAFPROC EQU   HMASMCCA+276                                             05002000
CCAFLAG3 EQU   CCAFPROC                                                 05003000
CCARGNP  EQU   CCAFLAG3+1                                               05004000
CCAFDIS  EQU   HMASMCCA+278                                             05005000
CCAFLAG4 EQU   CCAFDIS                                                  05006000
CCAFLAG5 EQU   CCAFDIS+1                                                05007000
CCAFLAG6 EQU   CCAFDIS+2                                                05008000
CCAFCNV  EQU   HMASMCCA+281                                             05009000
CCAFLAG8 EQU   CCAFCNV                                                  05010000
CCAFCTL  EQU   HMASMCCA+282                                             05011000
CCAFLAG9 EQU   CCAFCTL                                                  05012000
CCAFDSNG EQU   HMASMCCA+298                                             05013000
CCAFLAGB EQU   CCAFDSNG                                                 05014000
CCABLDLA EQU   0                                                        05015000
@NM00039 EQU   CCABLDLA                                                 05016000
CCABLDLL EQU   0                                                        05017000
@NM00041 EQU   CCABLDLL                                                 05018000
CCALKDRC EQU   @NM00041+20                                              05019000
@NM00043 EQU   CCABLDLL+124                                             05020000
CCAASMRC EQU   @NM00043+20                                              05021000
@NM00045 EQU   CCABLDLL+248                                             05022000
CCACPYRC EQU   @NM00045+20                                              05023000
@NM00047 EQU   CCABLDLL+372                                             05024000
CCACOMRC EQU   @NM00047+20                                              05025000
@NM00049 EQU   CCABLDLL+496                                             05026000
CCAZAPRC EQU   @NM00049+20                                              05027000
@NM00051 EQU   CCABLDLL+620                                             05028000
CCASUPRC EQU   @NM00051+20                                              05029000
@NM00053 EQU   CCABLDLL+744                                             05030000
CCAUPDRC EQU   @NM00053+20                                              05031000
CCABLDLM EQU   0                                                        05032000
CCABELMT EQU   CCABLDLM+4                                               05033000
CCABMPOS EQU   CCABELMT                                                 05034000
HMASMIOP EQU   0                                                        05035000
IOPDSID  EQU   HMASMIOP                                                 05036000
IOPFUNCT EQU   HMASMIOP+1                                               05037000
IOPRETRN EQU   HMASMIOP+2                                               05038000
IOPTYPE  EQU   HMASMIOP+3                                               05039000
IOPNAME  EQU   HMASMIOP+4                                               05040000
IOPNAM17 EQU   IOPNAME                                                  05041000
@NM00057 EQU   HMASMIOP+12                                              05042000
@NM00058 EQU   @NM00057                                                 05043000
IOPDDNAM EQU   HMASMIOP+24                                              05044000
IOPBUFAD EQU   HMASMIOP+52                                              05045000
IOPDRMAP EQU   HMASMIOP+56                                              05046000
IOPINAME EQU   IOPDRMAP                                                 05047000
IOPINAM  EQU   IOPINAME                                                 05048000
IOPITYP  EQU   IOPINAM                                                  05049000
IOPUSERL EQU   IOPDRMAP+11                                              05050000
IOPEND   EQU   IOPDRMAP+12                                              05051000
IOPLMCTL EQU   0                                                        05052000
IOPQSMIF EQU   0                                                        05053000
@NM00168 EQU   IOPQSMIF                                                 05054000
IOPQSMLS EQU   IOPQSMIF+8                                               05055000
IOPQSMNM EQU   IOPQSMLS                                                 05056000
IOPBS02  EQU   0                                                        05057000
IOPBS04  EQU   0                                                        05058000
IOPBAPF  EQU   IOPBS04                                                  05059000
HMASMICT EQU   0                                                        05060000
ICTCORE  EQU   HMASMICT                                                 05061000
ICTPSPLN EQU   ICTCORE                                                  05062000
ICTMSPLN EQU   ICTCORE+4                                                05063000
ICTLSPLN EQU   ICTCORE+8                                                05064000
ICTGMSPL EQU   0                                                        05065000
ICTPTF   EQU   0                                                        05066000
ICTPTFS  EQU   ICTPTF                                                   05067000
ICTPFLG1 EQU   ICTPTF+7                                                 05068000
ICTBYP   EQU   ICTPFLG1                                                 05069000
ICTPFLG3 EQU   ICTPTF+8                                                 05070000
ICTPPROC EQU   ICTPFLG3                                                 05071000
ICTPFLG5 EQU   ICTPTF+9                                                 05072000
ICTPFLG6 EQU   ICTPTF+11                                                05073000
ICTPFLF  EQU   ICTPFLG6                                                 05074000
ICTPFLG2 EQU   ICTPTF+12                                                05075000
ICTPFLG4 EQU   ICTPTF+13                                                05076000
ICTPREDO EQU   ICTPFLG4                                                 05077000
ICTPFLG8 EQU   ICTPTF+14                                                05078000
ICTPFLG9 EQU   ICTPTF+15                                                05079000
@NM00195 EQU   ICTPFLG9                                                 05080000
ICTPFLGA EQU   ICTPTF+16                                                05081000
ICTPUSR1 EQU   ICTPFLGA                                                 05082000
ICTPTYPE EQU   ICTPTF+17                                                05083000
ICTPFMID EQU   ICTPTF+22                                                05084000
ICTPCHN  EQU   ICTPTF+64                                                05085000
ICTPRCHN EQU   ICTPTF+68                                                05086000
ICTPSCHN EQU   ICTPTF+72                                                05087000
ICTPPCHN EQU   ICTPTF+76                                                05088000
ICTPICHN EQU   ICTPTF+80                                                05089000
ICTPNCHN EQU   ICTPTF+84                                                05090000
ICTPVCHN EQU   ICTPTF+88                                                05091000
ICTPDCHN EQU   ICTPTF+92                                                05092000
ICTPBCHN EQU   ICTPTF+96                                                05093000
ICTIXPF  EQU   0                                                        05094000
ICTIXP   EQU   ICTIXPF                                                  05095000
ICTENTLS EQU   0                                                        05096000
ICTENTNT EQU   ICTENTLS                                                 05097000
ICTENTNM EQU   ICTENTNT                                                 05098000
ICTENTST EQU   ICTENTNT+7                                               05099000
ICTREQLS EQU   0                                                        05100000
ICTREQNT EQU   ICTREQLS                                                 05101000
ICTREQNM EQU   ICTREQNT                                                 05102000
ICTREQST EQU   ICTREQNT+7                                               05103000
ICTSUPLS EQU   0                                                        05104000
ICTSUPNT EQU   ICTSUPLS                                                 05105000
ICTSUPNM EQU   ICTSUPNT                                                 05106000
ICTPRELS EQU   0                                                        05107000
ICTPRENT EQU   ICTPRELS                                                 05108000
ICTPRENM EQU   ICTPRENT                                                 05109000
ICTPREST EQU   ICTPRENT+7                                               05110000
ICTIRQLS EQU   0                                                        05111000
ICTIRQNT EQU   ICTIRQLS                                                 05112000
ICTIRQNM EQU   ICTIRQNT                                                 05113000
ICTIRQST EQU   ICTIRQNT+7                                               05114000
ICTCSRST EQU   ICTIRQNT+15                                              05115000
ICTNPRLS EQU   0                                                        05116000
ICTNPRNT EQU   ICTNPRLS                                                 05117000
ICTNPRNM EQU   ICTNPRNT                                                 05118000
ICTVRSLS EQU   0                                                        05119000
ICTVRSNT EQU   ICTVRSLS                                                 05120000
ICTVRSNM EQU   ICTVRSNT                                                 05121000
ICTVRSND EQU   ICTVRSNM                                                 05122000
ICTDELLS EQU   0                                                        05123000
ICTDELNT EQU   ICTDELLS                                                 05124000
ICTDELNM EQU   ICTDELNT                                                 05125000
ICTDELST EQU   ICTDELNT+7                                               05126000
ICTSBYLS EQU   0                                                        05127000
ICTSBYNT EQU   ICTSBYLS                                                 05128000
ICTSBYNM EQU   ICTSBYNT                                                 05129000
ICTMOD   EQU   0                                                        05130000
ICTMNAME EQU   ICTMOD                                                   05131000
ICTMEND  EQU   ICTMNAME                                                 05132000
ICTMFLG2 EQU   ICTMOD+8                                                 05133000
ICTMFLG1 EQU   ICTMOD+9                                                 05134000
ICTMMODR EQU   ICTMFLG1                                                 05135000
ICTMMOD  EQU   ICTMMODR                                                 05136000
ICTMASM  EQU   ICTMMODR                                                 05137000
ICTMZAP  EQU   ICTMFLG1                                                 05138000
ICTMXPND EQU   ICTMFLG1                                                 05139000
ICTMMACR EQU   ICTMFLG1                                                 05140000
ICTMMACU EQU   ICTMFLG1                                                 05141000
ICTMSRCR EQU   ICTMFLG1                                                 05142000
ICTMSRCU EQU   ICTMFLG1                                                 05143000
ICTMFLG3 EQU   ICTMOD+10                                                05144000
ICTMWRK  EQU   ICTMFLG3                                                 05145000
ICTMFLG4 EQU   ICTMOD+11                                                05146000
ICTMISEL EQU   ICTMFLG4                                                 05147000
ICTMIDEL EQU   ICTMFLG4                                                 05148000
ICTMSELM EQU   ICTMFLG4                                                 05149000
ICTMASOC EQU   ICTMFLG4                                                 05150000
ICTMMIDE EQU   ICTMFLG4                                                 05151000
ICTMTSEL EQU   ICTMFLG4                                                 05152000
ICTMFLG5 EQU   ICTMOD+12                                                05153000
ICTMODF4 EQU   ICTMOD+13                                                05154000
ICTMLEP1 EQU   ICTMODF4                                                 05155000
ICTMODF5 EQU   ICTMOD+14                                                05156000
ICTMLEP2 EQU   ICTMODF5                                                 05157000
ICTMODF6 EQU   ICTMOD+15                                                05158000
ICTMLEP3 EQU   ICTMODF6                                                 05159000
ICTMODF7 EQU   ICTMOD+16                                                05160000
ICTMLEP4 EQU   ICTMODF7                                                 05161000
ICTMACF4 EQU   ICTMOD+17                                                05162000
ICTMRMID EQU   ICTMOD+80                                                05163000
ICTMFMID EQU   ICTMOD+88                                                05164000
ICTPPTR  EQU   ICTMOD+96                                                05165000
ICTMCHN  EQU   ICTMOD+100                                               05166000
ICTMICHN EQU   ICTMOD+104                                               05167000
ICTMACHN EQU   ICTMOD+112                                               05168000
ICTMTCHN EQU   ICTMOD+116                                               05169000
ICTMVCHN EQU   ICTMOD+120                                               05170000
ICTMUCHN EQU   ICTMOD+124                                               05171000
ICTIXMF  EQU   0                                                        05172000
ICTMIDLS EQU   0                                                        05173000
ICTMID   EQU   ICTMIDLS                                                 05174000
ICTMODID EQU   ICTMID                                                   05175000
ICTMIDND EQU   ICTMODID                                                 05176000
ICTMODST EQU   ICTMID+7                                                 05177000
ICTMIDPL EQU   ICTMODST                                                 05178000
ICTMIDAM EQU   ICTMODST                                                 05179000
ICTMIDTY EQU   ICTMODST                                                 05180000
ICTASMLS EQU   0                                                        05181000
ICTASMAD EQU   ICTASMLS                                                 05182000
ICTASMND EQU   ICTASMAD                                                 05183000
ICTTALLS EQU   0                                                        05184000
ICTTALNM EQU   ICTTALLS                                                 05185000
ICTMVRLS EQU   0                                                        05186000
ICTMVRNT EQU   ICTMVRLS                                                 05187000
ICTMVRNM EQU   ICTMVRNT                                                 05188000
ICTMVRND EQU   ICTMVRNM                                                 05189000
ICTMUMLS EQU   0                                                        05190000
ICTMUMNT EQU   ICTMUMLS                                                 05191000
ICTMUMNM EQU   ICTMUMNT                                                 05192000
ICTLMOD  EQU   0                                                        05193000
ICTLMNAM EQU   ICTLMOD                                                  05194000
ICTLNAME EQU   ICTLMNAM                                                 05195000
ICTLFLG4 EQU   ICTLMOD+8                                                05196000
ICTLFLG1 EQU   ICTLMOD+9                                                05197000
ICTLFLG5 EQU   ICTLMOD+10                                               05198000
ICTLFLG6 EQU   ICTLMOD+11                                               05199000
ICTLFLG7 EQU   ICTLMOD+12                                               05200000
ICTLFLG2 EQU   ICTLMOD+13                                               05201000
ICTLFLG3 EQU   ICTLMOD+14                                               05202000
ICTLCHN  EQU   ICTLMOD+34                                               05203000
ICTIXLF  EQU   0                                                        05204000
CCADSIDA EQU   0                                                        05205000
CCATYPEA EQU   0                                                        05206000
IOPBS01  EQU   0                                                        05207000
IOPBS03  EQU   0                                                        05208000
TBLXPARM EQU   0                                                        05209000
TBLXINDX EQU   TBLXPARM+4                                               05210000
TBLXTBL  EQU   TBLXPARM+28                                              05211000
TBLXNULL EQU   TBLXPARM+36                                              05212000
TBLXFLG1 EQU   TBLXPARM+80                                              05213000
TBLXRC   EQU   TBLXPARM+92                                              05214000
CPTF     EQU   0                                                        05215000
UMIDMSG  EQU   0                                                        05216000
PTRC     EQU   0                                                        05217000
PTRO     EQU   0                                                        05218000
INTRTYPE EQU   0                                                        05219000
EMODNAME EQU   0                                                        05220000
SCRMOD   EQU   0                                                        05221000
MSGCODE1 EQU   0                                                        05222000
MSGCODE2 EQU   0                                                        05223000
XENTRY   EQU   0                                                        05224000
XFLG     EQU   0                                                        05225000
IOPUDATA EQU   IOPEND                                                   05226000
IOPINAM3 EQU   IOPINAME                                                 05227000
@NM00064 EQU   IOPINAM3                                                 05228000
IOPSTCMP EQU   IOPUDATA                                                 05229000
IOPDYNDT EQU   IOPUDATA                                                 05230000
IOPSPACE EQU   IOPDYNDT+44                                              05231000
IOPDTYPE EQU   IOPDYNDT+50                                              05232000
IOPNTMAX EQU   IOPDRMAP                                                 05233000
IOPNTMAP EQU   IOPDRMAP                                                 05234000
IOPCDMAP EQU   IOPNTMAP                                                 05235000
IOPPTMAP EQU   IOPCDMAP                                                 05236000
IOPSCMAP EQU   IOPPTMAP                                                 05237000
IOPDIRCT EQU   IOPSCMAP+12                                              05238000
IOPCDMAX EQU   IOPDIRCT                                                 05239000
IOPCQMAP EQU   IOPDRMAP                                                 05240000
@NM00075 EQU   IOPUDATA                                                 05241000
@NM00076 EQU   IOPUDATA                                                 05242000
IOPASMNT EQU   IOPUDATA                                                 05243000
IOPASMDR EQU   IOPASMNT                                                 05244000
IOPABUNT EQU   IOPASMDR+1                                               05245000
IOPLMDNT EQU   IOPUDATA                                                 05246000
IOPLMDDR EQU   IOPLMDNT                                                 05247000
IOPLMLEP EQU   IOPLMDDR+1                                               05248000
IOPLMDF1 EQU   IOPLMLEP                                                 05249000
IOPFLGS2 EQU   IOPLMDF1                                                 05250000
IOPLMDF2 EQU   IOPLMLEP+1                                               05251000
IOPLMDF3 EQU   IOPLMLEP+2                                               05252000
IOPLMDF4 EQU   IOPLMLEP+3                                               05253000
IOPLMDF5 EQU   IOPLMDDR+5                                               05254000
IOPFLGS3 EQU   IOPLMDF5                                                 05255000
IOPLMDFX EQU   IOPLMDNT+24                                              05256000
@NM00085 EQU   IOPLMDFX                                                 05257000
IOPLNTRY EQU   IOPLMDFX+8                                               05258000
IOPLSYS  EQU   IOPLNTRY                                                 05259000
IOPSYSLB EQU   IOPLSYS                                                  05260000
IOPMACNT EQU   IOPUDATA                                                 05261000
IOPMACDR EQU   IOPMACNT                                                 05262000
IOPRMIDE EQU   IOPMACDR+1                                               05263000
IOPRMST  EQU   IOPRMIDE+7                                               05264000
IOPFMIDE EQU   IOPMACDR+9                                               05265000
IOPMACFX EQU   IOPMACNT+24                                              05266000
IOPBUNT  EQU   IOPMACFX                                                 05267000
IOPMCEND EQU   IOPMACNT+104                                             05268000
IOPMACVR EQU   IOPMCEND                                                 05269000
IOPMCENT EQU   IOPMACVR                                                 05270000
IOPMCDTA EQU   IOPMCENT                                                 05271000
IOPMCASM EQU   IOPMCDTA                                                 05272000
IOPMACID EQU   IOPMCASM                                                 05273000
IOPMACST EQU   IOPMCASM+7                                               05274000
IOPMCIND EQU   IOPMCENT+8                                               05275000
IOPEOFNT EQU   IOPUDATA                                                 05276000
IOPSRCNT EQU   IOPUDATA                                                 05277000
IOPSRCDR EQU   IOPSRCNT                                                 05278000
@NM00096 EQU   IOPSRCDR+1                                               05279000
@NM00098 EQU   @NM00096+7                                               05280000
@NM00102 EQU   IOPSRCDR+9                                               05281000
IOPSRCFX EQU   IOPSRCNT+24                                              05282000
@NM00106 EQU   IOPSRCFX                                                 05283000
IOPSREND EQU   IOPSRCNT+104                                             05284000
IOPSRCVR EQU   IOPSREND                                                 05285000
IOPSNTRY EQU   IOPSRCVR                                                 05286000
IOPSRDTA EQU   IOPSNTRY                                                 05287000
IOPSRCID EQU   IOPSRDTA                                                 05288000
IOPSRCST EQU   IOPSRDTA+7                                               05289000
IOPMODNT EQU   IOPUDATA                                                 05290000
IOPMODDR EQU   IOPMODNT                                                 05291000
@NM00112 EQU   IOPMODDR+1                                               05292000
@NM00114 EQU   @NM00112+7                                               05293000
@NM00118 EQU   IOPMODDR+9                                               05294000
IOPMODFX EQU   IOPMODNT+24                                              05295000
@NM00122 EQU   IOPMODFX                                                 05296000
IOPMDLEP EQU   IOPMODFX+8                                               05297000
IOPMODF1 EQU   IOPMDLEP                                                 05298000
IOPMODF2 EQU   IOPMDLEP+1                                               05299000
IOPMODF3 EQU   IOPMDLEP+2                                               05300000
IOPMODF4 EQU   IOPMDLEP+3                                               05301000
IOPMDEND EQU   IOPMODNT+104                                             05302000
IOPMODVR EQU   IOPMDEND                                                 05303000
IOPMNTRY EQU   IOPMODVR                                                 05304000
IOPMDDTA EQU   IOPMNTRY                                                 05305000
IOPLMODS EQU   IOPMDDTA                                                 05306000
IOPMODID EQU   IOPLMODS                                                 05307000
IOPMODST EQU   IOPLMODS+7                                               05308000
IOPDLBNT EQU   IOPUDATA                                                 05309000
IOPDLBDR EQU   IOPDLBNT                                                 05310000
IOPDLBFX EQU   IOPDLBNT+24                                              05311000
@NM00133 EQU   IOPDLBFX                                                 05312000
IOPDLEND EQU   IOPDLBNT+104                                             05313000
IOPDLBVR EQU   IOPDLEND                                                 05314000
IOPDNTRY EQU   IOPDLBVR                                                 05315000
IOPDSYS  EQU   IOPDNTRY                                                 05316000
IOPSYSNT EQU   IOPUDATA                                                 05317000
IOPSYSDR EQU   IOPSYSNT                                                 05318000
IOPSYSF1 EQU   IOPSYSDR+4                                               05319000
IOPFLGS7 EQU   IOPSYSF1                                                 05320000
IOPSYSFX EQU   IOPSYSNT+24                                              05321000
@NM00140 EQU   IOPSYSFX                                                 05322000
IOPSYEND EQU   IOPSYSNT+184                                             05323000
IOPSYSVR EQU   IOPSYEND                                                 05324000
IOPSYSTR EQU   IOPSYSVR                                                 05325000
IOPSYNTR EQU   IOPSYSTR                                                 05326000
IOPPTFNT EQU   IOPUDATA                                                 05327000
IOPPTFDR EQU   IOPPTFNT                                                 05328000
IOPPSTAT EQU   IOPPTFDR+2                                               05329000
IOPPTFF1 EQU   IOPPSTAT                                                 05330000
IOPFLGS5 EQU   IOPPTFF1                                                 05331000
IOPERROR EQU   IOPFLGS5                                                 05332000
IOPPTFF2 EQU   IOPPSTAT+1                                               05333000
IOPPTFF3 EQU   IOPPSTAT+3                                               05334000
IOPPTFFX EQU   IOPPTFNT+24                                              05335000
@NM00149 EQU   IOPPTFFX                                                 05336000
@NM00150 EQU   @NM00149                                                 05337000
IOPPDTES EQU   IOPPTFFX+41                                              05338000
@NM00153 EQU   IOPPDTES                                                 05339000
IOPPTPFX EQU   IOPPDTES+6                                               05340000
IOPDATES EQU   IOPPTPFX                                                 05341000
IOPPTEND EQU   IOPPTFNT+104                                             05342000
IOPPTFVR EQU   IOPPTEND                                                 05343000
IOPPNTRY EQU   IOPPTFVR                                                 05344000
IOPPMODS EQU   IOPPNTRY                                                 05345000
IOPENTNT EQU   IOPUDATA+104                                             05346000
IOPSRLNT EQU   IOPUDATA+104                                             05347000
IOPPRENT EQU   IOPUDATA+104                                             05348000
IOPNPRNT EQU   IOPUDATA+104                                             05349000
IOPSUPNT EQU   IOPUDATA+104                                             05350000
IOPREQNT EQU   IOPUDATA+104                                             05351000
IOPIRQNT EQU   IOPUDATA+104                                             05352000
IOPFIDNT EQU   IOPUDATA+104                                             05353000
IOPDELNT EQU   IOPUDATA+104                                             05354000
IOPVERNT EQU   IOPUDATA+104                                             05355000
IOPSBYNT EQU   IOPUDATA+104                                             05356000
IOPQSMNT EQU   IOPUDATA                                                 05357000
IOPQSMDR EQU   IOPQSMNT                                                 05358000
IOPQFMNT EQU   IOPUDATA                                                 05359000
IOPQFMDR EQU   IOPQFMNT                                                 05360000
IOPQFEND EQU   IOPQFMNT+2                                               05361000
IOPQFMVR EQU   IOPQFEND                                                 05362000
IOPQFMLS EQU   IOPQFMVR                                                 05363000
IOPQFMNM EQU   IOPQFMLS                                                 05364000
IOPPTSYS EQU   IOPUDATA                                                 05365000
IOPPTSDR EQU   IOPPTSYS                                                 05366000
IOPPTSFX EQU   IOPPTSYS+24                                              05367000
IOPDSSPC EQU   IOPPTSFX                                                 05368000
IOPPTFG1 EQU   IOPPTSFX+34                                              05369000
IOPPSEND EQU   IOPPTSYS+1064                                            05370000
IOPPTSVR EQU   IOPPSEND                                                 05371000
IOPPTNTR EQU   IOPPTSVR                                                 05372000
@NM00178 EQU   IOPPTNTR                                                 05373000
IOPPTFMD EQU   @NM00178                                                 05374000
IOPPTREL EQU   IOPPTFMD                                                 05375000
IOPBPDS  EQU   IOPUDATA                                                 05376000
IOPBLEP1 EQU   IOPBPDS+8                                                05377000
IOPBLEP2 EQU   IOPBPDS+9                                                05378000
@NM00182 EQU   IOPBPDS+18                                               05379000
IOPBFTB0 EQU   @NM00182                                                 05380000
IOPBFTB1 EQU   IOPBFTB0                                                 05381000
ICTENDNT EQU   ICTENDCH                                                 05382000
ICTENDIX EQU   ICTENDCH                                                 05383000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05384000
IOPBCEND EQU   IOPBPDS+21                                               05385000
IOPBFTB3 EQU   IOPBFTB0+2                                               05386000
IOPBFTB2 EQU   IOPBFTB0+1                                               05387000
@NM00184 EQU   IOPBFTB1                                                 05388000
IOPBAPFP EQU   IOPBFTB1                                                 05389000
IOPBSSI  EQU   IOPBFTB1                                                 05390000
IOPBPAGA EQU   IOPBFTB1                                                 05391000
@NM00183 EQU   IOPBFTB1                                                 05392000
IOPBAOSL EQU   IOPBFTB1                                                 05393000
IOPBSEPA EQU   IOPBPDS+15                                               05394000
IOPBFTBL EQU   IOPBPDS+13                                               05395000
IOPBSTOR EQU   IOPBPDS+10                                               05396000
IOPBREFR EQU   IOPBLEP2                                                 05397000
IOPBLEF  EQU   IOPBLEP2                                                 05398000
IOPBTEST EQU   IOPBLEP2                                                 05399000
IOPBNE   EQU   IOPBLEP2                                                 05400000
@NM00181 EQU   IOPBLEP2                                                 05401000
IOPBDC   EQU   IOPBLEP2                                                 05402000
@NM00180 EQU   IOPBLEP1                                                 05403000
IOPBSCTR EQU   IOPBLEP1                                                 05404000
IOPBOL   EQU   IOPBLEP1                                                 05405000
@NM00179 EQU   IOPBLEP1                                                 05406000
IOPBOVLY EQU   IOPBLEP1                                                 05407000
IOPBREUS EQU   IOPBLEP1                                                 05408000
IOPBRENT EQU   IOPBLEP1                                                 05409000
IOPBNL   EQU   IOPBPDS+7                                                05410000
IOPBTTRN EQU   IOPBPDS+4                                                05411000
IOPBZERO EQU   IOPBPDS+3                                                05412000
IOPBTTRT EQU   IOPBPDS                                                  05413000
IOPPTIND EQU   IOPPTNTR+8                                               05414000
IOPPTSND EQU   IOPPTREL                                                 05415000
@NM00177 EQU   IOPPTSFX+872                                             05416000
IOPSYZPP EQU   IOPPTSFX+772                                             05417000
IOPSYZPR EQU   IOPPTSFX+771                                             05418000
IOPSYZPS EQU   IOPPTSFX+763                                             05419000
IOPSYZAP EQU   IOPPTSFX+755                                             05420000
IOPSYUPP EQU   IOPPTSFX+655                                             05421000
IOPSYUPR EQU   IOPPTSFX+654                                             05422000
IOPSYUPS EQU   IOPPTSFX+646                                             05423000
IOPSYUPD EQU   IOPPTSFX+638                                             05424000
IOPSYSPP EQU   IOPPTSFX+538                                             05425000
IOPSYSPR EQU   IOPPTSFX+537                                             05426000
IOPSYSPS EQU   IOPPTSFX+529                                             05427000
IOPSYSUP EQU   IOPPTSFX+521                                             05428000
IOPSYLKP EQU   IOPPTSFX+421                                             05429000
IOPSYLKR EQU   IOPPTSFX+420                                             05430000
IOPSYLKS EQU   IOPPTSFX+412                                             05431000
IOPSYLKD EQU   IOPPTSFX+404                                             05432000
IOPSYCPP EQU   IOPPTSFX+304                                             05433000
IOPSYCPR EQU   IOPPTSFX+303                                             05434000
IOPSYCPS EQU   IOPPTSFX+295                                             05435000
IOPSYCPY EQU   IOPPTSFX+287                                             05436000
IOPSYCOP EQU   IOPPTSFX+187                                             05437000
IOPSYCOR EQU   IOPPTSFX+186                                             05438000
IOPSYCOS EQU   IOPPTSFX+178                                             05439000
IOPSYCOM EQU   IOPPTSFX+170                                             05440000
IOPSYASP EQU   IOPPTSFX+70                                              05441000
IOPSYASR EQU   IOPPTSFX+69                                              05442000
IOPSYASS EQU   IOPPTSFX+61                                              05443000
IOPSYASM EQU   IOPPTSFX+53                                              05444000
@NM00176 EQU   IOPPTSFX+35                                              05445000
@NM00175 EQU   IOPPTFG1                                                 05446000
IOPPTSNJ EQU   IOPPTFG1                                                 05447000
IOPPTSNP EQU   IOPPTFG1                                                 05448000
IOPSYPLN EQU   IOPPTSFX+32                                              05449000
IOPDSPFX EQU   IOPPTSFX+6                                               05450000
IOPDSDIR EQU   IOPDSSPC+4                                               05451000
IOPDSSEC EQU   IOPDSSPC+2                                               05452000
IOPDSPRM EQU   IOPDSSPC                                                 05453000
@NM00174 EQU   IOPPTSDR+4                                               05454000
IOPPTPEM EQU   IOPPTSDR+2                                               05455000
IOPPCNVL EQU   IOPPTSDR+1                                               05456000
@NM00173 EQU   IOPPTSDR                                                 05457000
IOPQFMTP EQU   IOPQFMLS+8                                               05458000
@NM00172 EQU   IOPQFMLS+7                                               05459000
IOPQFMND EQU   IOPQFMNM                                                 05460000
@NM00171 EQU   IOPQFMDR                                                 05461000
@NM00167 EQU   IOPQSMDR                                                 05462000
@NM00166 EQU   IOPSBYNT+8                                               05463000
IOPSBYST EQU   IOPSBYNT+7                                               05464000
IOPSBYNM EQU   IOPSBYNT                                                 05465000
@NM00165 EQU   IOPVERNT+8                                               05466000
IOPVERST EQU   IOPVERNT+7                                               05467000
IOPVERNM EQU   IOPVERNT                                                 05468000
@NM00164 EQU   IOPDELNT+8                                               05469000
IOPDELST EQU   IOPDELNT+7                                               05470000
IOPDELNM EQU   IOPDELNT                                                 05471000
@NM00163 EQU   IOPFIDNT+8                                               05472000
IOPFIDST EQU   IOPFIDNT+7                                               05473000
IOPFIDNM EQU   IOPFIDNT                                                 05474000
@NM00162 EQU   IOPIRQNT+8                                               05475000
IOPIRQST EQU   IOPIRQNT+7                                               05476000
IOPIRQNM EQU   IOPIRQNT                                                 05477000
@NM00161 EQU   IOPREQNT+8                                               05478000
IOPREQST EQU   IOPREQNT+7                                               05479000
IOPREQNM EQU   IOPREQNT                                                 05480000
@NM00160 EQU   IOPSUPNT+8                                               05481000
IOPSUPST EQU   IOPSUPNT+7                                               05482000
IOPSUPNM EQU   IOPSUPNT                                                 05483000
@NM00159 EQU   IOPNPRNT+8                                               05484000
IOPNPRST EQU   IOPNPRNT+7                                               05485000
IOPNPRNM EQU   IOPNPRNT                                                 05486000
@NM00158 EQU   IOPPRENT+8                                               05487000
IOPPREST EQU   IOPPRENT+7                                               05488000
IOPPRENM EQU   IOPPRENT                                                 05489000
@NM00157 EQU   IOPSRLNT+8                                               05490000
IOPSRLST EQU   IOPSRLNT+7                                               05491000
@NM00156 EQU   IOPSRLNT+4                                               05492000
IOPSRLNM EQU   IOPSRLNT                                                 05493000
@NM00155 EQU   IOPENTNT+8                                               05494000
IOPENTST EQU   IOPENTNT+7                                               05495000
IOPENTNM EQU   IOPENTNT                                                 05496000
IOPPIND  EQU   IOPPNTRY+8                                               05497000
IOPPTFND EQU   IOPPMODS                                                 05498000
IOPPFMID EQU   IOPPTFFX+73                                              05499000
@NM00154 EQU   IOPPTPFX+24                                              05500000
IOPUCLT  EQU   IOPDATES+21                                              05501000
IOPUCLD  EQU   IOPDATES+18                                              05502000
IOPACCT  EQU   IOPDATES+15                                              05503000
IOPACCD  EQU   IOPDATES+12                                              05504000
IOPRSTT  EQU   IOPDATES+9                                               05505000
IOPRSTD  EQU   IOPDATES+6                                               05506000
IOPAPPT  EQU   IOPDATES+3                                               05507000
IOPAPPD  EQU   IOPDATES                                                 05508000
IOPRECT  EQU   @NM00153+3                                               05509000
IOPRECD  EQU   @NM00153                                                 05510000
@NM00152 EQU   IOPPTFFX+8                                               05511000
@NM00151 EQU   @NM00149+7                                               05512000
IOPPRELN EQU   @NM00150                                                 05513000
@NM00148 EQU   IOPPTFDR+20                                              05514000
IOPSBYNO EQU   IOPPTFDR+13                                              05515000
IOPDBYNO EQU   IOPPTFDR+6                                               05516000
@NM00147 EQU   IOPPTFF3                                                 05517000
IOPFLF   EQU   IOPPTFF3                                                 05518000
IOPDBYP  EQU   IOPPTFF3                                                 05519000
IOPSBYP  EQU   IOPPTFF3                                                 05520000
IOPPMDLP EQU   IOPPTFF2+1                                               05521000
IOPPADDP EQU   IOPPTFF2+1                                               05522000
@NM00146 EQU   IOPPTFF2+1                                               05523000
IOPLRFP  EQU   IOPPTFF2                                                 05524000
IOPJCLP  EQU   IOPPTFF2                                                 05525000
IOPSUPP  EQU   IOPPTFF2                                                 05526000
IOPREQP  EQU   IOPPTFF2                                                 05527000
IOPPREP  EQU   IOPPTFF2                                                 05528000
IOPNPRP  EQU   IOPPTFF2                                                 05529000
IOPIRQP  EQU   IOPPTFF2                                                 05530000
IOPDELP  EQU   IOPPTFF2                                                 05531000
IOPREGEN EQU   IOPFLGS5                                                 05532000
IOPBYP   EQU   IOPFLGS5                                                 05533000
IOPDUMMP EQU   IOPFLGS5                                                 05534000
@NM00145 EQU   IOPFLGS5                                                 05535000
IOPACC   EQU   IOPFLGS5                                                 05536000
IOPRES   EQU   IOPFLGS5                                                 05537000
IOPAPP   EQU   IOPFLGS5                                                 05538000
IOPPTYPE EQU   IOPPTFDR+1                                               05539000
@NM00144 EQU   IOPPTFDR                                                 05540000
IOPSYSTP EQU   IOPSYSTR+8                                               05541000
IOPSYSND EQU   IOPSYNTR                                                 05542000
@NM00143 EQU   IOPSYSFX+21                                              05543000
IOPSYSID EQU   IOPSYSFX+13                                              05544000
IOPNUCID EQU   IOPSYSFX+12                                              05545000
IOPSREL  EQU   IOPSYSFX+8                                               05546000
@NM00142 EQU   @NM00140+7                                               05547000
@NM00141 EQU   @NM00140                                                 05548000
@NM00139 EQU   IOPSYSDR+5                                               05549000
@NM00138 EQU   IOPFLGS7                                                 05550000
IOPSYNG  EQU   IOPFLGS7                                                 05551000
IOPSYDL  EQU   IOPFLGS7                                                 05552000
IOPSTSNP EQU   IOPFLGS7                                                 05553000
IOPMTSNP EQU   IOPFLGS7                                                 05554000
IOPPEMAX EQU   IOPSYSDR+2                                               05555000
IOPSCNVL EQU   IOPSYSDR+1                                               05556000
@NM00137 EQU   IOPSYSDR                                                 05557000
IOPDLIND EQU   IOPDNTRY+8                                               05558000
IOPDLBND EQU   IOPDSYS                                                  05559000
@NM00136 EQU   IOPDLBFX+8                                               05560000
@NM00135 EQU   @NM00133+7                                               05561000
@NM00134 EQU   @NM00133                                                 05562000
@NM00132 EQU   IOPDLBDR+1                                               05563000
@NM00131 EQU   IOPDLBDR                                                 05564000
IOPMDIND EQU   IOPMNTRY+8                                               05565000
@NM00130 EQU   IOPMODST                                                 05566000
IOPMODND EQU   IOPMODID                                                 05567000
IOPDLIB  EQU   IOPMODFX+72                                              05568000
@NM00129 EQU   IOPMODFX+12                                              05569000
@NM00128 EQU   IOPMODF4                                                 05570000
@NM00127 EQU   IOPMODF3                                                 05571000
@NM00126 EQU   IOPMODF2                                                 05572000
IOPMPAGA EQU   IOPMODF2                                                 05573000
IOPMNE   EQU   IOPMODF2                                                 05574000
@NM00125 EQU   IOPMODF1                                                 05575000
IOPMDC   EQU   IOPMODF1                                                 05576000
IOPMREFR EQU   IOPMODF1                                                 05577000
IOPMOVLY EQU   IOPMODF1                                                 05578000
IOPMSCTR EQU   IOPMODF1                                                 05579000
IOPMREUS EQU   IOPMODF1                                                 05580000
IOPMRENT EQU   IOPMODF1                                                 05581000
IOPMAPF  EQU   IOPMODF1                                                 05582000
@NM00124 EQU   @NM00122+7                                               05583000
@NM00123 EQU   @NM00122                                                 05584000
@NM00121 EQU   IOPMODDR+17                                              05585000
@NM00120 EQU   @NM00118+7                                               05586000
@NM00119 EQU   @NM00118                                                 05587000
@NM00117 EQU   @NM00114                                                 05588000
@NM00116 EQU   @NM00114                                                 05589000
@NM00115 EQU   @NM00114                                                 05590000
@NM00113 EQU   @NM00112                                                 05591000
@NM00111 EQU   IOPMODDR                                                 05592000
IOPSRIND EQU   IOPSNTRY+8                                               05593000
@NM00110 EQU   IOPSRCST                                                 05594000
IOPSRCND EQU   IOPSRCID                                                 05595000
IOPSRDLB EQU   IOPSRCFX+72                                              05596000
IOPSRSYS EQU   IOPSRCFX+64                                              05597000
@NM00109 EQU   IOPSRCFX+8                                               05598000
@NM00108 EQU   @NM00106+7                                               05599000
@NM00107 EQU   @NM00106                                                 05600000
@NM00105 EQU   IOPSRCDR+18                                              05601000
IOPSRLNG EQU   IOPSRCDR+17                                              05602000
@NM00104 EQU   @NM00102+7                                               05603000
@NM00103 EQU   @NM00102                                                 05604000
@NM00101 EQU   @NM00098                                                 05605000
@NM00100 EQU   @NM00098                                                 05606000
@NM00099 EQU   @NM00098                                                 05607000
@NM00097 EQU   @NM00096                                                 05608000
@NM00095 EQU   IOPSRCDR                                                 05609000
IOPEOFND EQU   IOPEOFNT                                                 05610000
IOPMCTYP EQU   IOPMCIND                                                 05611000
@NM00094 EQU   IOPMACST                                                 05612000
IOPMACND EQU   IOPMACID                                                 05613000
IOPMCDLB EQU   IOPMACFX+72                                              05614000
IOPMCSYS EQU   IOPMACFX+64                                              05615000
@NM00093 EQU   IOPMACFX+8                                               05616000
IOPBUTYP EQU   IOPBUNT+7                                                05617000
IOPBUSMD EQU   IOPBUNT                                                  05618000
@NM00092 EQU   IOPMACDR+18                                              05619000
IOPMCLNG EQU   IOPMACDR+17                                              05620000
IOPFMST  EQU   IOPFMIDE+7                                               05621000
IOPFMID  EQU   IOPFMIDE                                                 05622000
@NM00091 EQU   IOPRMST                                                  05623000
IOPRMASM EQU   IOPRMST                                                  05624000
@NM00090 EQU   IOPRMST                                                  05625000
IOPRMID  EQU   IOPRMIDE                                                 05626000
@NM00089 EQU   IOPMACDR                                                 05627000
IOPLMIND EQU   IOPLNTRY+8                                               05628000
IOPLMDND EQU   IOPSYSLB                                                 05629000
@NM00087 EQU   @NM00085+7                                               05630000
@NM00086 EQU   @NM00085                                                 05631000
@NM00084 EQU   IOPLMDDR+6                                               05632000
@NM00083 EQU   IOPFLGS3                                                 05633000
IOPCHREP EQU   IOPFLGS3                                                 05634000
IOPLINK  EQU   IOPFLGS3                                                 05635000
IOPCOPY  EQU   IOPFLGS3                                                 05636000
@NM00082 EQU   IOPLMDF4                                                 05637000
@NM00081 EQU   IOPLMDF3                                                 05638000
@NM00080 EQU   IOPLMDF2                                                 05639000
IOPPAGA  EQU   IOPLMDF2                                                 05640000
IOPNE    EQU   IOPLMDF2                                                 05641000
@NM00079 EQU   IOPFLGS2                                                 05642000
IOPDC    EQU   IOPFLGS2                                                 05643000
IOPREFR  EQU   IOPFLGS2                                                 05644000
IOPOVLY  EQU   IOPFLGS2                                                 05645000
IOPSCTR  EQU   IOPFLGS2                                                 05646000
IOPREUS  EQU   IOPFLGS2                                                 05647000
IOPRENT  EQU   IOPFLGS2                                                 05648000
IOPAPF   EQU   IOPFLGS2                                                 05649000
@NM00078 EQU   IOPLMDDR                                                 05650000
@NM00077 EQU   IOPASMDR+9                                               05651000
IOPABUTP EQU   IOPABUNT+7                                               05652000
IOPABUPT EQU   IOPABUNT                                                 05653000
IOPNTLVL EQU   IOPASMDR                                                 05654000
IOPALLOC EQU   @NM00076+4                                               05655000
IOPUSED  EQU   @NM00076                                                 05656000
IOPTPSEQ EQU   @NM00075+8                                               05657000
IOPVLSER EQU   @NM00075+2                                               05658000
IOPBLKSI EQU   @NM00075                                                 05659000
IOPCQMAX EQU   IOPCQMAP+12                                              05660000
@NM00074 EQU   IOPCQMAP+11                                              05661000
@NM00073 EQU   IOPCQMAP+8                                               05662000
@NM00072 EQU   IOPCQMAP                                                 05663000
IOPPTMAX EQU   IOPCDMAX                                                 05664000
@NM00071 EQU   IOPSCMAP+11                                              05665000
@NM00070 EQU   IOPSCMAP+8                                               05666000
@NM00069 EQU   IOPSCMAP                                                 05667000
IOPDIRMX EQU   IOPNTMAX+12                                              05668000
@NM00068 EQU   IOPNTMAX+11                                              05669000
@NM00067 EQU   IOPNTMAX+8                                               05670000
@NM00066 EQU   IOPNTMAX                                                 05671000
@NM00065 EQU   IOPDTYPE                                                 05672000
IOPDMOD  EQU   IOPDTYPE                                                 05673000
IOPDJCL  EQU   IOPDTYPE                                                 05674000
IOPDSRC  EQU   IOPDTYPE                                                 05675000
IOPDMAC  EQU   IOPDTYPE                                                 05676000
IOPSDIR  EQU   IOPSPACE+4                                               05677000
IOPSSCND EQU   IOPSPACE+2                                               05678000
IOPSPRIM EQU   IOPSPACE                                                 05679000
IOPDSN   EQU   IOPDYNDT                                                 05680000
IOPNTYPE EQU   IOPSTCMP+17                                              05681000
IOPNNAME EQU   IOPSTCMP+9                                               05682000
IOPOTYPE EQU   IOPSTCMP+8                                               05683000
IOPONAME EQU   IOPSTCMP                                                 05684000
IOPISEQ3 EQU   IOPINAM3+6                                               05685000
IOPITYP3 EQU   @NM00064+5                                               05686000
IOPIPTF3 EQU   @NM00064                                                 05687000
TBLXEND0 EQU   TBLXPARM+124                                             05688000
@NM00007 EQU   TBLXPARM+108                                             05689000
TBLXIOP3 EQU   TBLXPARM+104                                             05690000
TBLXD2GT EQU   TBLXPARM+100                                             05691000
TBLXDLGT EQU   TBLXPARM+96                                              05692000
@NM00006 EQU   TBLXRC+3                                                 05693000
TBLXIRC  EQU   TBLXRC+2                                                 05694000
TBLXLRC  EQU   TBLXRC+1                                                 05695000
TBLXTRC  EQU   TBLXRC                                                   05696000
TBLXIBGN EQU   TBLXPARM+88                                              05697000
TBLXTSLP EQU   TBLXPARM+84                                              05698000
@NM00005 EQU   TBLXPARM+83                                              05699000
@NM00004 EQU   TBLXPARM+82                                              05700000
@NM00003 EQU   TBLXPARM+81                                              05701000
@NM00002 EQU   TBLXFLG1                                                 05702000
TBLXTCRC EQU   TBLXFLG1                                                 05703000
TBLXFUND EQU   TBLXPARM+72                                              05704000
TBLXFUNC EQU   TBLXPARM+64                                              05705000
@NM00001 EQU   TBLXPARM+62                                              05706000
TBLXCRQI EQU   TBLXPARM+61                                              05707000
TBLXCDSI EQU   TBLXPARM+60                                              05708000
TBLXLMGT EQU   TBLXPARM+56                                              05709000
TBLXSCGT EQU   TBLXPARM+52                                              05710000
TBLXSREL EQU   TBLXPARM+48                                              05711000
TBLXASGT EQU   TBLXPARM+44                                              05712000
TBLXIFGT EQU   TBLXPARM+40                                              05713000
TBLXTOP  EQU   TBLXPARM+32                                              05714000
TBLXSEGT EQU   TBLXPARM+24                                              05715000
TBLXIOPF EQU   TBLXPARM+20                                              05716000
TBLXIOP2 EQU   TBLXPARM+16                                              05717000
TBLXEND  EQU   TBLXINDX+8                                               05718000
TBLXSTRT EQU   TBLXINDX+4                                               05719000
TBLXCUR  EQU   TBLXINDX                                                 05720000
TBLXHDR  EQU   TBLXPARM                                                 05721000
ICTIXL   EQU   ICTIXLF                                                  05722000
@NM00238 EQU   ICTLMOD+38                                               05723000
ICTLTTR  EQU   ICTLMOD+31                                               05724000
ICTTG2   EQU   ICTLMOD+23                                               05725000
ICTTG1   EQU   ICTLMOD+15                                               05726000
@NM00237 EQU   ICTLFLG3                                                 05727000
ICTLZAP  EQU   ICTLFLG3                                                 05728000
ICTLLKD  EQU   ICTLFLG3                                                 05729000
ICTLCPY  EQU   ICTLFLG3                                                 05730000
ICTLXPND EQU   ICTLFLG3                                                 05731000
ICTTIND2 EQU   ICTLFLG3                                                 05732000
ICTTIND1 EQU   ICTLFLG3                                                 05733000
@NM00236 EQU   ICTLFLG2                                                 05734000
ICTLDEL  EQU   ICTLFLG2                                                 05735000
@NM00235 EQU   ICTLFLG2                                                 05736000
ICTLTDEL EQU   ICTLFLG2                                                 05737000
ICTLINK  EQU   ICTLFLG2                                                 05738000
ICTCOPY  EQU   ICTLFLG2                                                 05739000
@NM00234 EQU   ICTLFLG7                                                 05740000
@NM00233 EQU   ICTLFLG6                                                 05741000
@NM00232 EQU   ICTLFLG5                                                 05742000
ICTLPAGA EQU   ICTLFLG5                                                 05743000
ICTLNE   EQU   ICTLFLG5                                                 05744000
@NM00231 EQU   ICTLFLG1                                                 05745000
ICTLDC   EQU   ICTLFLG1                                                 05746000
ICTLREFR EQU   ICTLFLG1                                                 05747000
ICTLOVLY EQU   ICTLFLG1                                                 05748000
ICTLSCTR EQU   ICTLFLG1                                                 05749000
ICTLREUS EQU   ICTLFLG1                                                 05750000
ICTLRENT EQU   ICTLFLG1                                                 05751000
ICTLAPF  EQU   ICTLFLG1                                                 05752000
@NM00230 EQU   ICTLFLG4                                                 05753000
ICTLPASS EQU   ICTLFLG4                                                 05754000
ICTLDDCK EQU   ICTLFLG4                                                 05755000
ICTLMSG  EQU   ICTLFLG4                                                 05756000
ICTLCPL  EQU   ICTLFLG4                                                 05757000
ICTLNOGO EQU   ICTLFLG4                                                 05758000
ICTLPROC EQU   ICTLFLG4                                                 05759000
ICTLEND  EQU   ICTLNAME                                                 05760000
@NM00229 EQU   ICTMUMNT+7                                               05761000
ICTMUMND EQU   ICTMUMNM                                                 05762000
@NM00228 EQU   ICTMVRNT+7                                               05763000
ICTTALND EQU   ICTTALNM                                                 05764000
ICTMIDRG EQU   ICTMODST                                                 05765000
ICTMIDF1 EQU   ICTMODST                                                 05766000
ICTMIDPS EQU   ICTMODST                                                 05767000
@NM00227 EQU   ICTMODST                                                 05768000
ICTIXM   EQU   ICTIXMF                                                  05769000
@NM00226 EQU   ICTMOD+128                                               05770000
ICTMICHA EQU   ICTMOD+108                                               05771000
@NM00225 EQU   ICTMOD+95                                                05772000
@NM00224 EQU   ICTMOD+87                                                05773000
ICTMSSI  EQU   ICTMOD+72                                                05774000
ICTMDOBJ EQU   ICTMOD+64                                                05775000
ICTMSYSL EQU   ICTMOD+56                                                05776000
ICTMDSTL EQU   ICTMOD+48                                                05777000
ICTMASLB EQU   ICTMOD+40                                                05778000
ICTTOLIB EQU   ICTMOD+32                                                05779000
ICTFMLIB EQU   ICTMOD+24                                                05780000
ICTMRELN EQU   ICTMOD+22                                                05781000
@NM00223 EQU   ICTMOD+21                                                05782000
ICTMLANG EQU   ICTMOD+20                                                05783000
@NM00222 EQU   ICTMOD+19                                                05784000
ICTMACF5 EQU   ICTMOD+18                                                05785000
ICTMZMPR EQU   ICTMACF4                                                 05786000
ICTMZOMZ EQU   ICTMACF4                                                 05787000
ICTMDOAS EQU   ICTMACF4                                                 05788000
ICTMXUPD EQU   ICTMACF4                                                 05789000
ICTMFXC  EQU   ICTMACF4                                                 05790000
ICTMFXBS EQU   ICTMACF4                                                 05791000
ICTMHASM EQU   ICTMACF4                                                 05792000
ICTMACDL EQU   ICTMACF4                                                 05793000
@NM00221 EQU   ICTMLEP4                                                 05794000
@NM00220 EQU   ICTMLEP3                                                 05795000
@NM00219 EQU   ICTMLEP2                                                 05796000
ICTMPAGA EQU   ICTMLEP2                                                 05797000
ICTMNE   EQU   ICTMLEP2                                                 05798000
@NM00218 EQU   ICTMLEP1                                                 05799000
ICTMDC   EQU   ICTMLEP1                                                 05800000
ICTMREFR EQU   ICTMLEP1                                                 05801000
ICTMOVLY EQU   ICTMLEP1                                                 05802000
ICTMSCTR EQU   ICTMLEP1                                                 05803000
ICTMREUS EQU   ICTMLEP1                                                 05804000
ICTMRENT EQU   ICTMLEP1                                                 05805000
ICTMAPF  EQU   ICTMLEP1                                                 05806000
@NM00217 EQU   ICTMFLG5                                                 05807000
ICTMNORL EQU   ICTMFLG5                                                 05808000
ICTMELCK EQU   ICTMFLG5                                                 05809000
ICTMCOPY EQU   ICTMFLG5                                                 05810000
ICTMPASS EQU   ICTMFLG5                                                 05811000
@NM00216 EQU   ICTMFLG4                                                 05812000
ICTMDSTE EQU   ICTMFLG4                                                 05813000
@NM00215 EQU   ICTMFLG3                                                 05814000
ICTMPRMS EQU   ICTMFLG3                                                 05815000
ICTMALIS EQU   ICTMFLG3                                                 05816000
ICTMTRX  EQU   ICTMFLG3                                                 05817000
ICTMRELF EQU   ICTMFLG3                                                 05818000
ICTLIBTX EQU   ICTMFLG3                                                 05819000
ICTLIBLK EQU   ICTMFLG3                                                 05820000
@NM00214 EQU   ICTMFLG2                                                 05821000
@NM00213 EQU   ICTMFLG2                                                 05822000
ICTMMIDU EQU   ICTMFLG2                                                 05823000
ICTMDEL  EQU   ICTMFLG2                                                 05824000
ICTMMSG  EQU   ICTMFLG2                                                 05825000
ICTMCPL  EQU   ICTMFLG2                                                 05826000
ICTMNOGO EQU   ICTMFLG2                                                 05827000
ICTMPROC EQU   ICTMFLG2                                                 05828000
@NM00212 EQU   ICTSBYNT+7                                               05829000
ICTSBYND EQU   ICTSBYNM                                                 05830000
ICTDELEX EQU   ICTDELST                                                 05831000
ICTDELND EQU   ICTDELNM                                                 05832000
@NM00211 EQU   ICTVRSNT+7                                               05833000
@NM00210 EQU   ICTNPRNT+7                                               05834000
ICTNPRND EQU   ICTNPRNM                                                 05835000
@NM00209 EQU   ICTCSRST                                                 05836000
@NM00208 EQU   ICTCSRST                                                 05837000
ICTCSRF  EQU   ICTCSRST                                                 05838000
@NM00207 EQU   ICTCSRST                                                 05839000
ICTCSRNM EQU   ICTIRQNT+8                                               05840000
@NM00206 EQU   ICTIRQST                                                 05841000
ICTIREQT EQU   ICTIRQST                                                 05842000
ICTIREQI EQU   ICTIRQST                                                 05843000
ICTIREQB EQU   ICTIRQST                                                 05844000
ICTIREQS EQU   ICTIRQST                                                 05845000
@NM00205 EQU   ICTIRQST                                                 05846000
ICTIRQND EQU   ICTIRQNM                                                 05847000
@NM00204 EQU   ICTPREST                                                 05848000
ICTPREQT EQU   ICTPREST                                                 05849000
ICTPREQI EQU   ICTPREST                                                 05850000
ICTPREQB EQU   ICTPREST                                                 05851000
ICTPREQS EQU   ICTPREST                                                 05852000
@NM00203 EQU   ICTPREST                                                 05853000
ICTPREND EQU   ICTPRENM                                                 05854000
@NM00202 EQU   ICTSUPNT+7                                               05855000
ICTSUPND EQU   ICTSUPNM                                                 05856000
@NM00201 EQU   ICTREQST                                                 05857000
ICTRREQT EQU   ICTREQST                                                 05858000
ICTRREQI EQU   ICTREQST                                                 05859000
ICTRREQB EQU   ICTREQST                                                 05860000
ICTRREQS EQU   ICTREQST                                                 05861000
@NM00200 EQU   ICTREQST                                                 05862000
ICTREQND EQU   ICTREQNM                                                 05863000
@NM00199 EQU   ICTENTST                                                 05864000
ICTEREQT EQU   ICTENTST                                                 05865000
ICTEREQI EQU   ICTENTST                                                 05866000
ICTEREQB EQU   ICTENTST                                                 05867000
ICTEREQS EQU   ICTENTST                                                 05868000
@NM00198 EQU   ICTENTST                                                 05869000
ICTENTND EQU   ICTENTNM                                                 05870000
@NM00197 EQU   ICTPTF+100                                               05871000
ICTPTPFX EQU   ICTPTF+38                                                05872000
ICTPRELN EQU   ICTPTF+36                                                05873000
ICTPRECT EQU   ICTPTF+33                                                05874000
ICTPRECD EQU   ICTPTF+30                                                05875000
ICTPVERN EQU   ICTPTF+29                                                05876000
ICTPSUPN EQU   ICTPTF+20                                                05877000
ICTPONUM EQU   ICTPTF+18                                                05878000
ICTPUSR8 EQU   ICTPFLGA                                                 05879000
ICTPUSR7 EQU   ICTPFLGA                                                 05880000
ICTPUSR6 EQU   ICTPFLGA                                                 05881000
ICTPUSR5 EQU   ICTPFLGA                                                 05882000
ICTPUSR4 EQU   ICTPFLGA                                                 05883000
ICTPUSR3 EQU   ICTPFLGA                                                 05884000
ICTPUSR2 EQU   ICTPFLGA                                                 05885000
ICTPPASS EQU   ICTPUSR1                                                 05886000
@NM00196 EQU   @NM00195                                                 05887000
ICTPRQBY EQU   @NM00195                                                 05888000
ICTPRQOK EQU   @NM00195                                                 05889000
ICTPRQCK EQU   @NM00195                                                 05890000
@NM00194 EQU   ICTPFLG9                                                 05891000
ICTPPDEL EQU   ICTPFLG9                                                 05892000
ICTPWRKO EQU   ICTPFLG9                                                 05893000
ICTPMSL  EQU   ICTPFLG9                                                 05894000
@NM00193 EQU   ICTPFLG8                                                 05895000
ICTPDCPL EQU   ICTPFLG8                                                 05896000
ICTPECPL EQU   ICTPFLG8                                                 05897000
ICTPGCPL EQU   ICTPFLG8                                                 05898000
@NM00192 EQU   ICTPFLG4                                                 05899000
@NM00191 EQU   ICTPFLG4                                                 05900000
@NM00190 EQU   ICTPFLG4                                                 05901000
ICTPGELM EQU   ICTPFLG4                                                 05902000
ICTPDIMP EQU   ICTPFLG4                                                 05903000
ICTPDEXP EQU   ICTPFLG4                                                 05904000
ICTPCDSE EQU   ICTPFLG4                                                 05905000
@NM00189 EQU   ICTPFLG2                                                 05906000
ICTPRCND EQU   ICTPFLG2                                                 05907000
ICTPTPS  EQU   ICTPFLG2                                                 05908000
ICTPTR1  EQU   ICTPFLG2                                                 05909000
ICTPVRSP EQU   ICTPFLG2                                                 05910000
@NM00188 EQU   ICTPFLG6                                                 05911000
ICTFLF   EQU   ICTPFLF                                                  05912000
ICTPDBYP EQU   ICTPFLG6                                                 05913000
ICTPSBYP EQU   ICTPFLG6                                                 05914000
ICTPMDLP EQU   ICTPFLG5+1                                               05915000
ICTPADDP EQU   ICTPFLG5+1                                               05916000
@NM00187 EQU   ICTPFLG5+1                                               05917000
ICTPLRFP EQU   ICTPFLG5                                                 05918000
ICTPJCLP EQU   ICTPFLG5                                                 05919000
ICTPSUPP EQU   ICTPFLG5                                                 05920000
ICTPREQP EQU   ICTPFLG5                                                 05921000
ICTPPREP EQU   ICTPFLG5                                                 05922000
ICTPNPRP EQU   ICTPFLG5                                                 05923000
ICTPIRQP EQU   ICTPFLG5                                                 05924000
ICTPDELP EQU   ICTPFLG5                                                 05925000
@NM00186 EQU   ICTPFLG3                                                 05926000
ICTPSLST EQU   ICTPFLG3                                                 05927000
ICTPNOLB EQU   ICTPFLG3                                                 05928000
ICTPVERJ EQU   ICTPFLG3                                                 05929000
ICTPMSG  EQU   ICTPFLG3                                                 05930000
ICTPCPL  EQU   ICTPFLG3                                                 05931000
ICTPNOGO EQU   ICTPFLG3                                                 05932000
ICTPROCS EQU   ICTPPROC                                                 05933000
ICTREGEN EQU   ICTPFLG1                                                 05934000
ICTDUMMP EQU   ICTPFLG1                                                 05935000
@NM00185 EQU   ICTPFLG1                                                 05936000
ICTERROR EQU   ICTPFLG1                                                 05937000
ICTACC   EQU   ICTPFLG1                                                 05938000
ICTRES   EQU   ICTPFLG1                                                 05939000
ICTAPP   EQU   ICTPFLG1                                                 05940000
ICTPEND  EQU   ICTPTFS                                                  05941000
ICTLEN   EQU   ICTGMSPL+1                                               05942000
ICTSP    EQU   ICTGMSPL                                                 05943000
ICTLLEN  EQU   ICTLSPLN+1                                               05944000
ICTLSP   EQU   ICTLSPLN                                                 05945000
ICTMLEN  EQU   ICTMSPLN+1                                               05946000
ICTMSP   EQU   ICTMSPLN                                                 05947000
ICTPLEN  EQU   ICTPSPLN+1                                               05948000
ICTPSP   EQU   ICTPSPLN                                                 05949000
IOPBS04E EQU   IOPBS04+2                                                05950000
IOPBAPFC EQU   IOPBAPF+1                                                05951000
IOPBAPFL EQU   IOPBAPF                                                  05952000
IOPBS2NM EQU   IOPBS02+3                                                05953000
IOPBS2EP EQU   IOPBS02                                                  05954000
IOPQSMTP EQU   IOPQSMLS+8                                               05955000
@NM00170 EQU   IOPQSMLS+7                                               05956000
IOPQSMND EQU   IOPQSMNM                                                 05957000
@NM00169 EQU   @NM00168+7                                               05958000
IOPQSMFM EQU   @NM00168                                                 05959000
@NM00088 EQU   IOPLMCTL+17                                              05960000
IOPLMCRD EQU   IOPLMCTL+9                                               05961000
IOPLMCRN EQU   IOPLMCTL+1                                               05962000
IOPLMCC  EQU   IOPLMCTL                                                 05963000
@NM00063 EQU   IOPUSERL                                                 05964000
@NM00062 EQU   IOPUSERL                                                 05965000
IOPALIS  EQU   IOPUSERL                                                 05966000
IOPTTR   EQU   IOPDRMAP+8                                               05967000
IOPINAM2 EQU   IOPINAM+1                                                05968000
IOPITYP2 EQU   IOPITYP                                                  05969000
@NM00061 EQU   HMASMIOP+32                                              05970000
IOPDELDD EQU   IOPDDNAM                                                 05971000
@NM00060 EQU   @NM00057+10                                              05972000
IOPSEQNO EQU   @NM00057+8                                               05973000
@NM00059 EQU   @NM00058+7                                               05974000
IOPPTFNM EQU   @NM00058                                                 05975000
CCABMREC EQU   CCABELMT+10                                              05976000
CCABPOS  EQU   CCABMPOS+8                                               05977000
CCABNAME EQU   CCABMPOS                                                 05978000
@NM00056 EQU   CCABLDLM+2                                               05979000
@NM00055 EQU   CCABLDLM                                                 05980000
CCAUPDPM EQU   @NM00053+24                                              05981000
@NM00054 EQU   @NM00053+21                                              05982000
CCARUPDT EQU   CCAUPDRC                                                 05983000
CCAUPDSP EQU   @NM00053+12                                              05984000
CCAUPDTE EQU   @NM00053+8                                               05985000
CCAUPDNM EQU   @NM00053                                                 05986000
CCASUPPM EQU   @NM00051+24                                              05987000
@NM00052 EQU   @NM00051+21                                              05988000
CCARSUP  EQU   CCASUPRC                                                 05989000
CCASUPSP EQU   @NM00051+12                                              05990000
CCAIOSUP EQU   @NM00051+8                                               05991000
CCASUPNM EQU   @NM00051                                                 05992000
CCAZAPPM EQU   @NM00049+24                                              05993000
@NM00050 EQU   @NM00049+21                                              05994000
CCARZAP  EQU   CCAZAPRC                                                 05995000
CCAZAPSP EQU   @NM00049+12                                              05996000
CCASPZAP EQU   @NM00049+8                                               05997000
CCAZAPNM EQU   @NM00049                                                 05998000
CCACOMPM EQU   @NM00047+24                                              05999000
@NM00048 EQU   @NM00047+21                                              06000000
CCARCOMP EQU   CCACOMRC                                                 06001000
CCACOMSP EQU   @NM00047+12                                              06002000
CCACOMRS EQU   @NM00047+8                                               06003000
CCACOMNM EQU   @NM00047                                                 06004000
CCACPYPM EQU   @NM00045+24                                              06005000
@NM00046 EQU   @NM00045+21                                              06006000
CCARCOPY EQU   CCACPYRC                                                 06007000
CCACPYSP EQU   @NM00045+12                                              06008000
CCACOPY  EQU   @NM00045+8                                               06009000
CCACPYNM EQU   @NM00045                                                 06010000
CCAASMPM EQU   @NM00043+24                                              06011000
@NM00044 EQU   @NM00043+21                                              06012000
CCARASM  EQU   CCAASMRC                                                 06013000
CCAASMSP EQU   @NM00043+12                                              06014000
CCAASM   EQU   @NM00043+8                                               06015000
CCAASMNM EQU   @NM00043                                                 06016000
CCALKDPM EQU   @NM00041+24                                              06017000
@NM00042 EQU   @NM00041+21                                              06018000
CCARLINK EQU   CCALKDRC                                                 06019000
CCALKDSP EQU   @NM00041+12                                              06020000
CCALKED  EQU   @NM00041+8                                               06021000
CCALKDNM EQU   @NM00041                                                 06022000
CCAPGMPM EQU   @NM00039+24                                              06023000
@NM00040 EQU   @NM00039+21                                              06024000
CCABPGRC EQU   @NM00039+20                                              06025000
CCABPGSP EQU   @NM00039+12                                              06026000
CCABPGAD EQU   @NM00039+8                                               06027000
CCABPGNM EQU   @NM00039                                                 06028000
CCAEND   EQU   HMASMCCA+371                                             06029000
@NM00038 EQU   HMASMCCA+309                                             06030000
CCACURDD EQU   CCAFDSNG+3                                               06031000
CCACURDS EQU   CCAFDSNG+2                                               06032000
@NM00037 EQU   CCAFLAGB                                                 06033000
CCAOUTNG EQU   CCAFLAGB                                                 06034000
CCALOGNG EQU   CCAFLAGB                                                 06035000
CCAFMID  EQU   HMASMCCA+291                                             06036000
CCALSTDS EQU   CCAFCTL+8                                                06037000
CCARPTDS EQU   CCAFCTL+7                                                06038000
CCATIME  EQU   CCAFCTL+4                                                06039000
CCADATE  EQU   CCAFCTL+1                                                06040000
@NM00036 EQU   CCAFLAG9                                                 06041000
CCARVCAN EQU   CCAFLAG9                                                 06042000
CCARVEST EQU   CCAFLAG9                                                 06043000
CCAPTSNJ EQU   CCAFLAG9                                                 06044000
CCASTSNP EQU   CCAFLAG9                                                 06045000
CCAMTSNP EQU   CCAFLAG9                                                 06046000
CCAPTSNP EQU   CCAFLAG9                                                 06047000
@NM00035 EQU   CCAFLAG8                                                 06048000
CCAACDSC EQU   CCAFLAG8                                                 06049000
CCACDSC  EQU   CCAFLAG8                                                 06050000
@NM00034 EQU   CCAFLAG6                                                 06051000
CCAACRUP EQU   CCAFLAG6                                                 06052000
CCACRQUP EQU   CCAFLAG6                                                 06053000
CCAACDUP EQU   CCAFLAG6                                                 06054000
CCACDSUP EQU   CCAFLAG6                                                 06055000
@NM00033 EQU   CCAFLAG5                                                 06056000
CCAACROS EQU   CCAFLAG5                                                 06057000
CCACRQOS EQU   CCAFLAG5                                                 06058000
CCAACDOS EQU   CCAFLAG5                                                 06059000
CCACDSOS EQU   CCAFLAG5                                                 06060000
@NM00032 EQU   CCAFLAG4                                                 06061000
CCAACRIS EQU   CCAFLAG4                                                 06062000
CCACRQIS EQU   CCAFLAG4                                                 06063000
CCAACDIS EQU   CCAFLAG4                                                 06064000
CCACDSIS EQU   CCAFLAG4                                                 06065000
@NM00031 EQU   CCAFLAG3+1                                               06066000
CCADISRQ EQU   CCAFLAG3+1                                               06067000
CCAICTOK EQU   CCAFLAG3                                                 06068000
CCADELP  EQU   CCAFLAG3                                                 06069000
CCACMPRS EQU   CCAFLAG3                                                 06070000
CCAZAPP  EQU   CCAFLAG3                                                 06071000
CCALINKP EQU   CCAFLAG3                                                 06072000
CCACOPYP EQU   CCAFLAG3                                                 06073000
CCAASIP  EQU   CCAFLAG3                                                 06074000
CCAUPDP  EQU   CCAFLAG3                                                 06075000
CCAEOSMP EQU   CCAFLAG2                                                 06076000
CCAEOFNC EQU   CCAFLAG2                                                 06077000
@NM00030 EQU   CCAFLAG2                                                 06078000
CCACHECK EQU   CCAFLAG2                                                 06079000
CCATERM  EQU   CCAFLAG2                                                 06080000
CCASVCLB EQU   CCAFLAG2                                                 06081000
CCANCPTF EQU   CCAFLAG2                                                 06082000
@NM00029 EQU   CCAFLAG1+1                                               06083000
CCAUNL   EQU   CCAFLAG1+1                                               06084000
CCARESET EQU   CCAFLAG1+1                                               06085000
CCALOG   EQU   CCAFLAG1+1                                               06086000
CCACNV   EQU   CCAFLAG1+1                                               06087000
CCALIST  EQU   CCAFLAG1                                                 06088000
CCAUPDU  EQU   CCAFLAG1                                                 06089000
CCAUPDJ  EQU   CCAFLAG1                                                 06090000
CCARES   EQU   CCAFLAG1                                                 06091000
CCAREJ   EQU   CCAFLAG1                                                 06092000
CCAACCPT EQU   CCAFLAG1                                                 06093000
CCAREC   EQU   CCAFLAG1                                                 06094000
CCAFUNCT EQU   CCAFFUNC                                                 06095000
@NM00028 EQU   @NM00023+18                                              06096000
@NM00027 EQU   @NM00023+16                                              06097000
CCATBLPA EQU   @NM00023+12                                              06098000
@NM00026 EQU   @NM00023+8                                               06099000
@NM00025 EQU   @NM00023+4                                               06100000
@NM00024 EQU   @NM00023                                                 06101000
CCAIFGTP EQU   CCAFGTP+16                                               06102000
CCAGTP3  EQU   CCAFGTP+12                                               06103000
CCAGTP2  EQU   CCAFGTP+8                                                06104000
CCAGTP1  EQU   CCAFGTP+4                                                06105000
CCASETAD EQU   CCASEGTP                                                 06106000
CCACLST  EQU   CCAFPGM+12                                               06107000
CCASPDCB EQU   CCAFPGM+8                                                06108000
CCARVAD  EQU   CCAFSTA                                                  06109000
CCAACDID EQU   CCAFSYS+32                                               06110000
CCACDSID EQU   CCAFSYS+24                                               06111000
CCALNLEN EQU   CCAFSYS+22                                               06112000
@NM00022 EQU   CCAFLAGA                                                 06113000
CCAPSYSF EQU   CCAFLAGA                                                 06114000
CCAASYSF EQU   CCAFLAGA                                                 06115000
CCACSYSF EQU   CCAFLAGA                                                 06116000
CCANUCID EQU   CCAFSYS+20                                               06117000
CCAASREL EQU   CCAFSYS+16                                               06118000
CCACSREL EQU   CCASREL                                                  06119000
CCAPEMAX EQU   CCAFSYS+10                                               06120000
CCAPGLEN EQU   CCAFSYS+8                                                06121000
CCAIOPAS EQU   CCAFSYS+4                                                06122000
CCAIOPCS EQU   CCAFSYS                                                  06123000
CCAPESIZ EQU   CCAFIOP+4                                                06124000
@NM00021 EQU   CCAFLAG7+3                                               06125000
CCALOGP  EQU   CCAFLAG7+2                                               06126000
CCAOUTP  EQU   CCAFLAG7+2                                               06127000
CCASLBP  EQU   CCAFLAG7+2                                               06128000
CCARPTP  EQU   CCAFLAG7+2                                               06129000
CCALISTP EQU   CCAFLAG7+2                                               06130000
CCAJCLP  EQU   CCAFLAG7+2                                               06131000
CCAPTFP  EQU   CCAFLAG7+2                                               06132000
CCATLBP  EQU   CCAFLAG7+2                                               06133000
CCAUT3P  EQU   CCAFLAG7+1                                               06134000
CCAUT2P  EQU   CCAFLAG7+1                                               06135000
CCAUT1P  EQU   CCAFLAG7+1                                               06136000
CCAWK5P  EQU   CCAFLAG7+1                                               06137000
CCAWK4P  EQU   CCAFLAG7+1                                               06138000
CCAWK3P  EQU   CCAFLAG7+1                                               06139000
CCAWK2P  EQU   CCAFLAG7+1                                               06140000
CCAWK1P  EQU   CCAFLAG7+1                                               06141000
CCAACRQP EQU   CCAFLAG7                                                 06142000
CCACRQP  EQU   CCAFLAG7                                                 06143000
CCASTSP  EQU   CCAFLAG7                                                 06144000
CCAMTSP  EQU   CCAFLAG7                                                 06145000
CCAPTSP  EQU   CCAFLAG7                                                 06146000
CCASCDSP EQU   CCAFLAG7                                                 06147000
CCAACDSP EQU   CCAFLAG7                                                 06148000
CCACDSP  EQU   CCAFLAG7                                                 06149000
@NM00020 EQU   CCAFBUFR+122                                             06150000
@NM00019 EQU   CCAFBUFR+120                                             06151000
@NM00018 EQU   CCAFBUFR+118                                             06152000
CCATBFMX EQU   CCAFBUFR+116                                             06153000
CCA4BFMX EQU   CCAFBUFR+114                                             06154000
CCA3BFMX EQU   CCAFBUFR+112                                             06155000
CCA2BFMX EQU   CCAFBUFR+110                                             06156000
CCA1BFMX EQU   CCAFBUFR+108                                             06157000
CCAXBFMX EQU   CCAFBUFR+106                                             06158000
CCAQBFMX EQU   CCAFBUFR+104                                             06159000
CCASBFMX EQU   CCAFBUFR+102                                             06160000
CCAMBFMX EQU   CCAFBUFR+100                                             06161000
CCAPBFMX EQU   CCAFBUFR+98                                              06162000
CCAVBFMX EQU   CCAFBUFR+96                                              06163000
CCAABFMX EQU   CCAFBUFR+94                                              06164000
CCACBFMX EQU   CCAFBUFR+92                                              06165000
@NM00017 EQU   CCAFBUFR+88                                              06166000
@NM00016 EQU   CCAFBUFR+84                                              06167000
CCA4BFSZ EQU   CCAFBUFR+80                                              06168000
CCATBFSZ EQU   CCAFBUFR+76                                              06169000
CCAWBFSZ EQU   CCAFBUFR+72                                              06170000
CCAQBFSZ EQU   CCAFBUFR+68                                              06171000
CCAPBFSZ EQU   CCAFBUFR+64                                              06172000
CCAVBFSZ EQU   CCAFBUFR+60                                              06173000
CCACBFSZ EQU   CCAFBUFR+56                                              06174000
@NM00015 EQU   CCAFBUFR+52                                              06175000
CCA4BFOA EQU   CCAFBUFR+48                                              06176000
CCA4BFIA EQU   CCAFBUFR+44                                              06177000
CCATBFIA EQU   CCAFBUFR+40                                              06178000
CCAWBFOA EQU   CCAFBUFR+36                                              06179000
CCAWBFIA EQU   CCAFBUFR+32                                              06180000
CCAQBFOA EQU   CCAFBUFR+28                                              06181000
CCAQBFIA EQU   CCAFBUFR+24                                              06182000
CCAPBFOA EQU   CCAFBUFR+20                                              06183000
CCAPBFIA EQU   CCAFBUFR+16                                              06184000
CCAVBFOA EQU   CCAFBUFR+12                                              06185000
CCAVBFIA EQU   CCAFBUFR+8                                               06186000
CCACBFOA EQU   CCAFBUFR+4                                               06187000
CCACBFIA EQU   CCAFBUFR                                                 06188000
CCAID    EQU   HMASMCCA                                                 06189000
@NM00014 EQU   TBLFLG5                                                  06190000
TBLICTOK EQU   TBLFLG5                                                  06191000
@NM00013 EQU   TBLFLG4                                                  06192000
TBLBPFM  EQU   TBLFLG4                                                  06193000
@NM00012 EQU   TBLFLG4                                                  06194000
TBLBPIRQ EQU   TBLFLG4                                                  06195000
TBLBPREQ EQU   TBLFLG4                                                  06196000
TBLBPPRE EQU   TBLFLG4                                                  06197000
@NM00011 EQU   TBLFLG3+1                                                06198000
TBLSTS   EQU   TBLFLG3                                                  06199000
TBLMTS   EQU   TBLFLG3                                                  06200000
TBLPTS   EQU   TBLFLG3                                                  06201000
TBLACRQ  EQU   TBLFLG3                                                  06202000
TBLCRQ   EQU   TBLFLG3                                                  06203000
TBLSCDS  EQU   TBLFLG3                                                  06204000
TBLACDS  EQU   TBLFLG3                                                  06205000
TBLCDS   EQU   TBLFLG3                                                  06206000
TBLMASS  EQU   TBLFLG2                                                  06207000
@NM00010 EQU   TBLFLG2                                                  06208000
TBLFMID  EQU   TBLFLG2                                                  06209000
TBLGROUP EQU   TBLFLG2                                                  06210000
TBLEXC   EQU   TBLFLG2                                                  06211000
TBLSEL   EQU   TBLFLG2                                                  06212000
@NM00009 EQU   TBLFLG1+1                                                06213000
TBLDISW  EQU   TBLFLG1+1                                                06214000
TBLDISR  EQU   TBLFLG1+1                                                06215000
TBLDISN  EQU   TBLFLG1+1                                                06216000
TBLNOJCL EQU   TBLFLG1                                                  06217000
TBLFLUSH EQU   TBLFLG1                                                  06218000
TBLUSER  EQU   TBLFLG1                                                  06219000
TBLAPAR  EQU   TBLFLG1                                                  06220000
TBLCOMP  EQU   TBLFLG1                                                  06221000
TBLCHECK EQU   TBLFLG1                                                  06222000
TBLNOAPP EQU   TBLFLG1                                                  06223000
@NM00008 EQU   TBLXOPTS+5                                               06224000
TBLNUCID EQU   TBLXOPTS+4                                               06225000
TBLJCLGT EQU   TBLXOPTS                                                 06226000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      06227000
@RC00522 EQU   @RC00519                                                 06228000
@RF00579 EQU   @EL00004                                                 06229000
@RC00581 EQU   @EL00004                                                 06230000
@RF00600 EQU   @EL00005                                                 06231000
@RF00613 EQU   @EL00005                                                 06232000
@RF00635 EQU   @RC00632                                                 06233000
@RF00639 EQU   @RC00632                                                 06234000
@RF00647 EQU   @EL00006                                                 06235000
@RC00708 EQU   @RC00706                                                 06236000
@RF00773 EQU   @EL00008                                                 06237000
@RF00795 EQU   @EL00010                                                 06238000
@RF00881 EQU   @EL00011                                                 06239000
@RC00879 EQU   @EL00011                                                 06240000
@RC00877 EQU   @EL00011                                                 06241000
@RC00875 EQU   @EL00011                                                 06242000
@RF00958 EQU   @EL00013                                                 06243000
@ENDDATA EQU   *                                                        06244000
         END   HMASMTMS,(C'PLS2152',0802,78334)                         06245000
