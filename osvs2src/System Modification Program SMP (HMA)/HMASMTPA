         TITLE 'HMASMTPA - TABLE SYSMOD SELECTION FOR APPLY AND ACCEPT' 00001000
HMASMTPA CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMTPA  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @09,4095(,@12)                                      0001 00011000
         LA    @10,4095(,@09)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@09                                    0001 00014000
         USING @PSTART+8190,@10                                    0001 00015000
         ST    @13,@SA00001+4                                      0001 00016000
         LA    @14,@SA00001                                        0001 00017000
         ST    @14,8(,@13)                                         0001 00018000
         LR    @13,@14                                             0001 00019000
         MVC   @PC00001(4),0(@01)                                  0001 00020000
*                                                                  0158 00021000
*   /*****************************************************************/ 00022000
*   /*                                                               */ 00023000
*   /* HMASMTPA << SYSMOD SELECTION FOR APPLY AND ACCEPT             */ 00024000
*   /*                                                               */ 00025000
*   /*****************************************************************/ 00026000
*                                                                  0158 00027000
*   TPARC=ZERO;                     /* CLEAR THE RETURN CODE         */ 00028000
         SLR   TPARC,TPARC                                         0158 00029000
*   TPAFLAGS=''B;                   /* CLEAR CONTROL FLAGS           */ 00030000
*                                                                  0159 00031000
         XC    TPAFLAGS(4),TPAFLAGS                                0159 00032000
*   /*****************************************************************/ 00033000
*   /*                                                               */ 00034000
*   /* INITALIZE FOR PROCESSING                                      */ 00035000
*   /*                                                               */ 00036000
*   /*****************************************************************/ 00037000
*                                                                  0160 00038000
*   CALL INITTPA;                   /*                               */ 00039000
         BAL   @14,INITTPA                                         0160 00040000
*   RFY                                                            0161 00041000
*     RTNCODE RSTD;                                                0161 00042000
*   TPARC=MAX(TPARC,RTNCODE);       /* SAVE THE RETURN CODE          */ 00043000
         CR    TPARC,RTNCODE                                       0162 00044000
         BNL   *+6                                                      00045000
         LR    TPARC,RTNCODE                                       0162 00046000
*   RFY                                                            0163 00047000
*     RTNCODE UNRSTD;                                              0163 00048000
*   IF TPARC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00049000
         CH    TPARC,@CH00033                                      0164 00050000
         BNL   @RF00164                                            0164 00051000
*     DO;                           /* YES,                          */ 00052000
*                                                                  0165 00053000
*       /*************************************************************/ 00054000
*       /*                                                           */ 00055000
*       /* BUILD GTA FILE LIST OF POSSIBLE SYSMODS BASED ON SELECTION*/ 00056000
*       /* CRITERIA, FUNCTION AND DATA SET CONTENTS                  */ 00057000
*       /*                                                           */ 00058000
*       /*************************************************************/ 00059000
*                                                                  0166 00060000
*       CALL HMASMTPL(TBLXPARM);    /*                               */ 00061000
         L     @08,@PC00001                                        0166 00062000
         ST    @08,@AL00001                                        0166 00063000
         L     @15,@CV01235                                        0166 00064000
         LA    @01,@AL00001                                        0166 00065000
         BALR  @14,@15                                             0166 00066000
*       RFY                                                        0167 00067000
*         RTNCODE RSTD;                                            0167 00068000
*       TPARC=MAX(TPARC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00069000
         CR    TPARC,RTNCODE                                       0168 00070000
         BNL   *+6                                                      00071000
         LR    TPARC,RTNCODE                                       0168 00072000
*       RFY                                                        0169 00073000
*         RTNCODE UNRSTD;                                          0169 00074000
*     END;                          /*                               */ 00075000
*   ELSE                                                           0171 00076000
*     ;                             /* PREVIOUS ERROR OCCURED        */ 00077000
@RF00164 DS    0H                                                  0172 00078000
*   IF TPARC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00079000
         CH    TPARC,@CH00033                                      0172 00080000
         BNL   @RF00172                                            0172 00081000
*     DO;                           /* YES,                          */ 00082000
*                                                                  0173 00083000
*       /*************************************************************/ 00084000
*       /*                                                           */ 00085000
*       /* DELETE SYSMODS IN THE SELECT/GROUP LIST ARE PROCESSED     */ 00086000
*       /*                                                           */ 00087000
*       /*************************************************************/ 00088000
*                                                                  0174 00089000
*       IF TBLSEL=ON                /* SELECT MODE ...               */ 00090000
*           |TBLGROUP=ON THEN       /* ... OR GROUP MODE             */ 00091000
         L     @08,@PC00001                                        0174 00092000
         L     @08,TBLXTBL(,@08)                                   0174 00093000
         TM    TBLSEL(@08),B'10100000'                             0174 00094000
         BZ    @RF00174                                            0174 00095000
*         DO;                       /*                               */ 00096000
*           CALL DELSMD;            /*                               */ 00097000
         BAL   @14,DELSMD                                          0176 00098000
*           RFY                                                    0177 00099000
*             RTNCODE RSTD;                                        0177 00100000
*           TPARC=MAX(TPARC,RTNCODE);/* SAVE THE RETURN CODE         */ 00101000
         CR    TPARC,RTNCODE                                       0178 00102000
         BNL   *+6                                                      00103000
         LR    TPARC,RTNCODE                                       0178 00104000
*           RFY                                                    0179 00105000
*             RTNCODE UNRSTD;                                      0179 00106000
*         END;                                                     0180 00107000
*       ELSE                                                       0181 00108000
*         ;                         /* SKIP DELETE PROCESSING        */ 00109000
@RF00174 DS    0H                                                  0182 00110000
*     END;                          /*                               */ 00111000
*   ELSE                                                           0183 00112000
*     ;                             /* PREVIOUS ERROR OCCURED        */ 00113000
@RF00172 DS    0H                                                  0184 00114000
*   IF TPARC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00115000
         CH    TPARC,@CH00033                                      0184 00116000
         BNL   @RF00184                                            0184 00117000
*     DO;                           /* YES,                          */ 00118000
*                                                                  0185 00119000
*       /*************************************************************/ 00120000
*       /*                                                           */ 00121000
*       /* 1ST LEVEL FUNCTION ICT PTF ENTRIES ARE BUILT              */ 00122000
*       /*                                                           */ 00123000
*       /*************************************************************/ 00124000
*                                                                  0186 00125000
*       CALL F1BUILD;               /*                               */ 00126000
         BAL   @14,F1BUILD                                         0186 00127000
*       RFY                                                        0187 00128000
*         RTNCODE RSTD;                                            0187 00129000
*       TPARC=MAX(TPARC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00130000
         CR    TPARC,RTNCODE                                       0188 00131000
         BNL   *+6                                                      00132000
         LR    TPARC,RTNCODE                                       0188 00133000
*       RFY                                                        0189 00134000
*         RTNCODE UNRSTD;                                          0189 00135000
*     END;                          /*                               */ 00136000
*   ELSE                                                           0191 00137000
*     ;                             /* PREVIOUS ERROR OCCURED        */ 00138000
@RF00184 DS    0H                                                  0192 00139000
*   IF TPARC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00140000
         CH    TPARC,@CH00033                                      0192 00141000
         BNL   @RF00192                                            0192 00142000
*     DO;                           /* YES,                          */ 00143000
*                                                                  0193 00144000
*       /*************************************************************/ 00145000
*       /*                                                           */ 00146000
*       /* LOWER LEVEL FUNCTION ICT PTF ENTRIES ARE BUILT            */ 00147000
*       /*                                                           */ 00148000
*       /*************************************************************/ 00149000
*                                                                  0194 00150000
*       CALL F2BUILD;               /*                               */ 00151000
         BAL   @14,F2BUILD                                         0194 00152000
*       RFY                                                        0195 00153000
*         RTNCODE RSTD;                                            0195 00154000
*       TPARC=MAX(TPARC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00155000
         CR    TPARC,RTNCODE                                       0196 00156000
         BNL   *+6                                                      00157000
         LR    TPARC,RTNCODE                                       0196 00158000
*       RFY                                                        0197 00159000
*         RTNCODE UNRSTD;                                          0197 00160000
*     END;                          /*                               */ 00161000
*   ELSE                                                           0199 00162000
*     ;                             /* PREVIOUS ERROR OCCURED        */ 00163000
@RF00192 DS    0H                                                  0200 00164000
*   IF TPARC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00165000
         CH    TPARC,@CH00033                                      0200 00166000
         BNL   @RF00200                                            0200 00167000
*     DO;                           /* YES,                          */ 00168000
*                                                                  0201 00169000
*       /*************************************************************/ 00170000
*       /*                                                           */ 00171000
*       /* SERVICE SYSMODS ARE ADDED TO THE ICT PTF SECTION          */ 00172000
*       /*                                                           */ 00173000
*       /*************************************************************/ 00174000
*                                                                  0202 00175000
*       CALL SRVBUILD;              /*                               */ 00176000
         BAL   @14,SRVBUILD                                        0202 00177000
*       RFY                                                        0203 00178000
*         RTNCODE RSTD;                                            0203 00179000
*       TPARC=MAX(TPARC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00180000
         CR    TPARC,RTNCODE                                       0204 00181000
         BNL   *+6                                                      00182000
         LR    TPARC,RTNCODE                                       0204 00183000
*       RFY                                                        0205 00184000
*         RTNCODE UNRSTD;                                          0205 00185000
*     END;                          /*                               */ 00186000
*   ELSE                                                           0207 00187000
*     ;                             /* PREVIOUS ERROR OCCURED        */ 00188000
@RF00200 DS    0H                                                  0208 00189000
*   IF TPARC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00190000
         CH    TPARC,@CH00033                                      0208 00191000
         BNL   @RF00208                                            0208 00192000
*     DO;                           /* YES,                          */ 00193000
*                                                                  0209 00194000
*       /*************************************************************/ 00195000
*       /*                                                           */ 00196000
*       /* ISSUE ERROR MESSAGE FOR ANY SELECTED SYSMODS NOT PROCESSED*/ 00197000
*       /*                                                           */ 00198000
*       /*************************************************************/ 00199000
*                                                                  0210 00200000
*       CALL SELCHK;                /*                               */ 00201000
         BAL   @14,SELCHK                                          0210 00202000
*       RFY                                                        0211 00203000
*         RTNCODE RSTD;                                            0211 00204000
*       TPARC=MAX(TPARC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00205000
         CR    TPARC,RTNCODE                                       0212 00206000
         BNL   *+6                                                      00207000
         LR    TPARC,RTNCODE                                       0212 00208000
*       RFY                                                        0213 00209000
*         RTNCODE UNRSTD;                                          0213 00210000
*     END;                          /*                               */ 00211000
*   ELSE                                                           0215 00212000
*     ;                             /* PREVIOUS ERROR OCCURED        */ 00213000
@RF00208 DS    0H                                                  0216 00214000
*   IF TPARC<STOPFUNC               /* NO ERROR SO FAR?              */ 00215000
*       &CCAACCPT=ON                /* ... AND ACCEPT ...            */ 00216000
*       &TBLNOAPP=OFF THEN          /* NO APPLY ?                    */ 00217000
         CH    TPARC,@CH00033                                      0216 00218000
         BNL   @RF00216                                            0216 00219000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0216 00220000
         BNO   @RF00216                                            0216 00221000
         L     @08,@PC00001                                        0216 00222000
         L     @08,TBLXTBL(,@08)                                   0216 00223000
         TM    TBLNOAPP(@08),B'10000000'                           0216 00224000
         BNZ   @RF00216                                            0216 00225000
*     DO;                           /* YES,                          */ 00226000
*                                                                  0217 00227000
*       /*************************************************************/ 00228000
*       /*                                                           */ 00229000
*       /* BUILD ANY REQUIRED SYSMOD ENTRIES FOR SUPERSEDED SYSMODS  */ 00230000
*       /* THESE ENTRIES WILL BE USED TO REMOVE THE SYSMODS FROM THE */ 00231000
*       /* PTS                                                       */ 00232000
*       /*                                                           */ 00233000
*       /*************************************************************/ 00234000
*                                                                  0218 00235000
*       CALL SUPSMD;                /*                               */ 00236000
         BAL   @14,SUPSMD                                          0218 00237000
*       RFY                                                        0219 00238000
*         RTNCODE RSTD;                                            0219 00239000
*       TPARC=MAX(TPARC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00240000
         CR    TPARC,RTNCODE                                       0220 00241000
         BNL   *+6                                                      00242000
         LR    TPARC,RTNCODE                                       0220 00243000
*       RFY                                                        0221 00244000
*         RTNCODE UNRSTD;                                          0221 00245000
*     END;                          /*                               */ 00246000
*   ELSE                                                           0223 00247000
*     ;                             /* PREVIOUS ERROR OCCURED        */ 00248000
*                                                                  0223 00249000
@RF00216 DS    0H                                                  0224 00250000
*   /*****************************************************************/ 00251000
*   /*                                                               */ 00252000
*   /* CLEANUP PROCESSING FOR HMASMTPA                               */ 00253000
*   /*                                                               */ 00254000
*   /*****************************************************************/ 00255000
*                                                                  0224 00256000
*   CALL TERMTPA;                   /*                               */ 00257000
         BAL   @14,TERMTPA                                         0224 00258000
*   RFY                                                            0225 00259000
*     RTNCODE RSTD;                                                0225 00260000
*   TPARC=MAX(TPARC,RTNCODE);       /* SAVE THE RETURN CODE          */ 00261000
         CR    TPARC,RTNCODE                                       0226 00262000
         BNL   *+6                                                      00263000
         LR    TPARC,RTNCODE                                       0226 00264000
*   RFY                                                            0227 00265000
*     RTNCODE UNRSTD;                                              0227 00266000
*   RETURN CODE(TPARC);             /*                               */ 00267000
         LR    @15,TPARC                                           0228 00268000
         L     @13,4(,@13)                                         0228 00269000
         L     @14,12(,@13)                                        0228 00270000
         LM    @00,@12,20(@13)                                     0228 00271000
         BR    @14                                                 0228 00272000
*                                                                  0229 00273000
*   /*****************************************************************/ 00274000
*   /*                                                               */ 00275000
*   /* INITTPA -                                                     */ 00276000
*   /*                                                               */ 00277000
*   /*****************************************************************/ 00278000
*                                                                  0229 00279000
*INITTPA:                                                          0229 00280000
*   PROC;                                                          0229 00281000
INITTPA  STM   @14,@12,12(@13)                                     0229 00282000
*   DCL                                                            0230 00283000
*     INITRC FIXED(15);             /*                               */ 00284000
*   INITRC=ZERO;                    /* CLEAR THE RETURN CODE         */ 00285000
         SLR   INITRC,INITRC                                       0231 00286000
*   KEYSCLGN=''B;                   /* CLEAR GET NEXT SCL SAVED KEY  */ 00287000
         XC    KEYSCLGN(15),KEYSCLGN                               0232 00288000
*   RETURN CODE(INITRC);            /* RETURN WITH THE RETURN CODE   */ 00289000
         LR    @15,INITRC                                          0233 00290000
         L     @14,12(,@13)                                        0233 00291000
         LM    @00,@12,20(@13)                                     0233 00292000
         BR    @14                                                 0233 00293000
*   END INITTPA;                    /*                               */ 00294000
*                                                                  0235 00295000
*   /*****************************************************************/ 00296000
*   /*                                                               */ 00297000
*   /* DELSMD - BUILD ICT ENTRIES FOR DELETING SYSMODS               */ 00298000
*   /*                                                               */ 00299000
*   /*****************************************************************/ 00300000
*                                                                  0235 00301000
*DELSMD:                                                           0235 00302000
*   PROC;                                                          0235 00303000
DELSMD   STM   @14,@12,@SA00003                                    0235 00304000
*   DCL                                                            0236 00305000
*     DELRC FIXED(15);              /*                               */ 00306000
*   DCL                                                            0237 00307000
*     1 DELFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */ 00308000
*      2 ENDFUNC BIT(1),            /* END OF IN L1 AND L2 ENTRIES IN   00309000
*                                      SCL                           */ 00310000
*      2 DELSKIP BIT(1),            /* SKIP THIS SYSMOD              */ 00311000
*      2 * BIT(1),                  /*                               */ 00312000
*      2 DELGET BIT(1),             /* GET NEXT GTA RECORD           */ 00313000
*      2 * BIT(4);                  /*                               */ 00314000
*   DCL                                                            0238 00315000
*     DELICTP PTR(31);              /* ICT ENTRY POINTER RETURNED BY    00316000
*                                      VERBLD                        */ 00317000
*   DCL                                                            0239 00318000
*     DELSCL CHAR(LENGTH(SCLMAP));  /* AREA FOR GET NEXT SCL TO SAVE    00319000
*                                      KEY                           */ 00320000
*   RFY                                                            0240 00321000
*     HMASMIOP BASED(CCAIOPTR);     /*                               */ 00322000
*   RFY                                                            0241 00323000
*     HMASMGTP BASED(TBLXSCGT);     /*                               */ 00324000
*   RFY                                                            0242 00325000
*     SCLMAP BASED(GTPBUFAD);       /*                               */ 00326000
*   RFY                                                            0243 00327000
*     TSLPARMS BASED(TBLXTSLP);     /*                               */ 00328000
*   DELRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 00329000
         SLR   DELRC,DELRC                                         0244 00330000
*   DELFLAGS=''B;                   /* CLEAR LOCAL FLAGS             */ 00331000
         MVI   DELFLAGS,X'00'                                      0245 00332000
*   GTPFUNCT=GTPOPENN;              /* POSITION TO THE BEGINNING OF     00333000
*                                      FILE                          */ 00334000
         L     @08,@PC00001                                        0246 00335000
         L     @08,TBLXSCGT(,@08)                                  0246 00336000
         MVI   GTPFUNCT(@08),X'01'                                 0246 00337000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 00338000
         ST    @08,@AL00001                                        0247 00339000
         L     @15,@CV01231                                        0247 00340000
         LA    @01,@AL00001                                        0247 00341000
         BALR  @14,@15                                             0247 00342000
*   ENDFUNC=OFF;                    /* END OF FUNCTIONS NOT FOUND IN    00343000
*                                      GTA                           */ 00344000
*                                                                  0248 00345000
*   /*****************************************************************/ 00346000
*   /*                                                               */ 00347000
*   /* LOOP THRU THE RECORDS IN THE SCL GTA FILE. FOR EACH RECORD    */ 00348000
*   /* THAT HAS A DELETE, DETERMINE IF IT IS APPLICABELE. IF SO,     */ 00349000
*   /* DETERMINE IF ANY OF THE SYSMODS NAMED IN THE DELETE LIST ARE  */ 00350000
*   /* IN THE 'CURRENT DELETE ENVIRONMENT'. IF SO THE HIS IS A DELETE*/ 00351000
*   /* SYSMOD AND WILL BE PROCESSED IN THIS ROUTINE.                 */ 00352000
*   /*                                                               */ 00353000
*   /*****************************************************************/ 00354000
*                                                                  0249 00355000
*   DELGET=ON;                      /* GET FIRST RECORD              */ 00356000
         OI    DELGET,B'00010000'                                  0249 00357000
         NI    ENDFUNC,B'01111111'                                 0249 00358000
*   IOPNAM17=''B;                   /* CLEAR IOP NAME FOR IO CHECK   */ 00359000
         L     @08,CCAIOPTR(,CCAPTR)                               0250 00360000
         XC    IOPNAM17(7,@08),IOPNAM17(@08)                       0250 00361000
*   DO WHILE(ENDFUNC=OFF            /* PROCESS ALL FUNCTIONS         */ 00362000
*         &DELRC<STOPSMD);          /*                               */ 00363000
         B     @DE00251                                            0251 00364000
@DL00251 DS    0H                                                  0252 00365000
*     DELSKIP=OFF;                  /* CLEAR SKIP FLAG               */ 00366000
         NI    DELSKIP,B'10111111'                                 0252 00367000
*     IF DELGET=ON THEN             /* NEED TO GET A RECORD?         */ 00368000
         TM    DELGET,B'00010000'                                  0253 00369000
         BNO   @RF00253                                            0253 00370000
*       DO;                         /*                               */ 00371000
*         GTPFUNCT=GTPGETN;         /* GET NEXT SYSMOD               */ 00372000
         L     @08,@PC00001                                        0255 00373000
         L     @08,TBLXSCGT(,@08)                                  0255 00374000
         MVI   GTPFUNCT(@08),X'08'                                 0255 00375000
*         CALL HMASMGTA(HMASMGTP);  /* ...                           */ 00376000
         ST    @08,@AL00001                                        0256 00377000
         L     @15,@CV01231                                        0256 00378000
         LA    @01,@AL00001                                        0256 00379000
         BALR  @14,@15                                             0256 00380000
*       END;                        /*                               */ 00381000
*     ELSE                                                         0258 00382000
*       ;                           /* POSITIONED AT NEXT RECORD BY     00383000
*                                      AMBIGCK                       */ 00384000
@RF00253 DS    0H                                                  0259 00385000
*     DELGET=ON;                    /* GET NEXT SCL RECORD           */ 00386000
         OI    DELGET,B'00010000'                                  0259 00387000
*     IF GTPRETRN=GTPEOF THEN       /* END OF FILE?                  */ 00388000
         L     @08,@PC00001                                        0260 00389000
         L     @08,TBLXSCGT(,@08)                                  0260 00390000
         CLI   GTPRETRN(@08),4                                     0260 00391000
         BNE   @RF00260                                            0260 00392000
*       DO;                         /* YES,                          */ 00393000
*         ENDFUNC=ON;               /* ALL FUNCTIONS PROCESSED       */ 00394000
         OI    ENDFUNC,B'10000000'                                 0262 00395000
*       END;                                                       0263 00396000
*     ELSE                          /* NOT END OF FILE               */ 00397000
*       DO;                                                        0264 00398000
         B     @RC00260                                            0264 00399000
@RF00260 DS    0H                                                  0265 00400000
*         IF SCLISTNO^=SCLL1        /* PROCESSING A FUNCTION RECORD? */ 00401000
*             &SCLISTNO^=SCLL2 THEN /* ...                           */ 00402000
         L     @08,@PC00001                                        0265 00403000
         L     @08,TBLXSCGT(,@08)                                  0265 00404000
         L     @08,GTPBUFAD(,@08)                                  0265 00405000
         CLI   SCLISTNO(@08),C'1'                                  0265 00406000
         BE    @RF00265                                            0265 00407000
         CLI   SCLISTNO(@08),C'2'                                  0265 00408000
         BE    @RF00265                                            0265 00409000
*           DO;                     /* NO,                           */ 00410000
*             ENDFUNC=ON;           /* ALL FUNCTION DONE             */ 00411000
         OI    ENDFUNC,B'10000000'                                 0267 00412000
*           END;                    /*                               */ 00413000
*         ELSE                                                     0269 00414000
*           ;                       /*                               */ 00415000
@RF00265 DS    0H                                                  0270 00416000
*       END;                                                       0270 00417000
*     DELSCL=SCLMAP;                /* SAVE SCL RECORD SINCE GTP   0271 00418000
*                                      BUFFER MAY BE OVERLAID BY   0271 00419000
*                                      AMBIGCHK PROCESSING           */ 00420000
@RC00260 L     @08,@PC00001                                        0271 00421000
         L     @08,TBLXSCGT(,@08)                                  0271 00422000
         L     @08,GTPBUFAD(,@08)                                  0271 00423000
         MVC   DELSCL(17),SCLMAP(@08)                              0271 00424000
*     IF ENDFUNC=OFF                /* NOT THRU ...                  */ 00425000
*         &DELRC<STOPSMD            /* ... AND NO ERROR ...          */ 00426000
*         &SCLDELP=ON               /* DELETE ON THIS CANDIDATE ++VER*/ 00427000
*         &SCLCAND=ON               /* ...                           */ 00428000
*         &SCLSELST=ON THEN         /* AND IN SELECT/GROUP LIST?     */ 00429000
         TM    ENDFUNC,B'10000000'                                 0272 00430000
         BNZ   @RF00272                                            0272 00431000
         CH    DELRC,@CH00056                                      0272 00432000
         BNL   @RF00272                                            0272 00433000
         TM    SCLDELP(@08),B'11100000'                            0272 00434000
         BNO   @RF00272                                            0272 00435000
*       DO;                         /* YES,                          */ 00436000
*         IF IOPNAM17^=SCLSMD THEN  /* DIFFERENT THAN PREVIOUS     0274 00437000
*                                      SYSMOD?                       */ 00438000
         L     @02,CCAIOPTR(,CCAPTR)                               0274 00439000
         CLC   IOPNAM17(7,@02),SCLSMD(@08)                         0274 00440000
         BE    @RF00274                                            0274 00441000
*           DO;                                                    0275 00442000
*             IOPDSID=IOPPTS;       /* GET PTS EXTENDED ENTRY FOR  0276 00443000
*                                      FUNCTION                      */ 00444000
         MVI   IOPDSID(@02),X'06'                                  0276 00445000
*             IOPTYPE=IOPSMD;       /* ...                           */ 00446000
         MVI   IOPTYPE(@02),X'0B'                                  0277 00447000
*             IOPFUNCT=IOPLOC;      /* ...                           */ 00448000
         MVI   IOPFUNCT(@02),X'03'                                 0278 00449000
*             IOPNAM17=SCLSMD;      /* ...                           */ 00450000
         MVC   IOPNAM17(7,@02),SCLSMD(@08)                         0279 00451000
*             CALL HMASMIO(HMASMIOP);/* ...                          */ 00452000
         ST    @02,@AL00001                                        0280 00453000
         L     @15,@CV01229                                        0280 00454000
         LA    @01,@AL00001                                        0280 00455000
         BALR  @14,@15                                             0280 00456000
*             DELRC=MAX(DELRC,IOPRETRN);/* RC IS IO RC               */ 00457000
         L     @08,CCAIOPTR(,CCAPTR)                               0281 00458000
         SLR   @02,@02                                             0281 00459000
         IC    @02,IOPRETRN(,@08)                                  0281 00460000
         CR    DELRC,@02                                           0281 00461000
         BNL   *+6                                                      00462000
         LR    DELRC,@02                                           0281 00463000
*           END;                                                   0282 00464000
*         ELSE                                                     0283 00465000
*           ;                       /* NO NEED TO DO IO              */ 00466000
@RF00274 DS    0H                                                  0284 00467000
*         IF DELRC<STOPSMD THEN     /* ALL IS WELL                   */ 00468000
         CH    DELRC,@CH00056                                      0284 00469000
         BNL   @RF00284                                            0284 00470000
*           DO;                     /* YES,                          */ 00471000
*                                                                  0285 00472000
*             /*******************************************************/ 00473000
*             /*                                                     */ 00474000
*             /* DETERMINE IF THIS ++VER IS APPLICABLE TO THE 'DELETE*/ 00475000
*             /* ENVIRONMENT'                                        */ 00476000
*             /*                                                     */ 00477000
*             /*******************************************************/ 00478000
*                                                                  0286 00479000
*             CALL VERDELCK(HMASMIOP,SCLMAP);/* DETERMINE IF THIS  0286 00480000
*                                      ++VER IS APPLICABLE           */ 00481000
         L     @08,CCAIOPTR(,CCAPTR)                               0286 00482000
         ST    @08,@AL00001                                        0286 00483000
         L     @08,@PC00001                                        0286 00484000
         L     @08,TBLXSCGT(,@08)                                  0286 00485000
         L     @08,GTPBUFAD(,@08)                                  0286 00486000
         ST    @08,@AL00001+4                                      0286 00487000
         LA    @01,@AL00001                                        0286 00488000
         BAL   @14,VERDELCK                                        0286 00489000
*             RFY                                                  0287 00490000
*               RTNCODE RSTD;                                      0287 00491000
*             IF RTNCODE=TSLNTFND THEN/* APPLICABLE VER NOT FOUND?   */ 00492000
         CH    RTNCODE,@CH00038                                    0288 00493000
         BNE   @RF00288                                            0288 00494000
*               DO;                 /*                               */ 00495000
*                 DELSKIP=ON;       /* SKIP CURRENT ++VER RECORD     */ 00496000
         OI    DELSKIP,B'01000000'                                 0290 00497000
*               END;                /*                               */ 00498000
*             ELSE                  /* OTHER THAN NOT FOUND          */ 00499000
*               DO;                                                0292 00500000
         B     @RC00288                                            0292 00501000
@RF00288 DS    0H                                                  0293 00502000
*                 DELRC=MAX(DELRC,RTNCODE);/* SAVE RETURN CODE       */ 00503000
         CR    DELRC,RTNCODE                                       0293 00504000
         BNL   *+6                                                      00505000
         LR    DELRC,RTNCODE                                       0293 00506000
*                 RFY                                              0294 00507000
*                   RTNCODE UNRSTD;                                0294 00508000
*               END;                                               0295 00509000
*           END;                                                   0296 00510000
@RC00288 DS    0H                                                  0297 00511000
*         IF DELRC<STOPSMD          /*                               */ 00512000
*             &DELSKIP=OFF THEN     /* STILL GO?                     */ 00513000
@RF00284 CH    DELRC,@CH00056                                      0297 00514000
         BNL   @RF00297                                            0297 00515000
         TM    DELSKIP,B'01000000'                                 0297 00516000
         BNZ   @RF00297                                            0297 00517000
*           DO;                     /*                               */ 00518000
*             IF SCLISTNO^=SCLL1 THEN/* OTHER THAN L1, I.E. L2?      */ 00519000
         L     @08,@PC00001                                        0299 00520000
         L     @08,TBLXSCGT(,@08)                                  0299 00521000
         L     @08,GTPBUFAD(,@08)                                  0299 00522000
         CLI   SCLISTNO(@08),C'1'                                  0299 00523000
         BE    @RF00299                                            0299 00524000
*               DO;                 /* YES,                          */ 00525000
*                 CALL SELFND(SCLSMD);/* MARK SELECT LIST ENTRY SO 0301 00526000
*                                      THAT SELECTED SYSMOD NOT    0301 00527000
*                                      PROCESSED MESSAGE NOT ISSUED  */ 00528000
*                                                                  0301 00529000
         LA    @08,SCLSMD(,@08)                                    0301 00530000
         ST    @08,@AL00001                                        0301 00531000
         LA    @01,@AL00001                                        0301 00532000
         BAL   @14,SELFND                                          0301 00533000
*                 /***************************************************/ 00534000
*                 /*                                                 */ 00535000
*                 /* DETERMINE IF THIS ++VER IS AMBIGUOUS            */ 00536000
*                 /*                                                 */ 00537000
*                 /***************************************************/ 00538000
*                                                                  0302 00539000
*                 CALL AMBIGCK(SCLMAP);/* CHECK FOR AMBIGUOUS ++VER     00540000
*                                      SITUATION                     */ 00541000
         L     @08,@PC00001                                        0302 00542000
         L     @08,TBLXSCGT(,@08)                                  0302 00543000
         L     @08,GTPBUFAD(,@08)                                  0302 00544000
         ST    @08,@AL00001                                        0302 00545000
         LA    @01,@AL00001                                        0302 00546000
         BAL   @14,AMBIGCK                                         0302 00547000
*                 RFY                                              0303 00548000
*                   RTNCODE RSTD;                                  0303 00549000
*                 DELGET=OFF;       /* DO NOT GET NEXT RECORD SINCE     00550000
*                                      AMBIGCK DID                   */ 00551000
         NI    DELGET,B'11101111'                                  0304 00552000
*                 DELRC=MAX(DELRC,RTNCODE);/*                        */ 00553000
         CR    DELRC,RTNCODE                                       0305 00554000
         BNL   *+6                                                      00555000
         LR    DELRC,RTNCODE                                       0305 00556000
*                 RFY                                              0306 00557000
*                   RTNCODE UNRSTD;                                0306 00558000
*               END;                                               0307 00559000
*             ELSE                                                 0308 00560000
*               ;                   /* 1ST LEVEL FUNCTION            */ 00561000
@RF00299 DS    0H                                                  0309 00562000
*             RFY                                                  0309 00563000
*               SCLMAP BASED(ADDR(DELSCL));                        0309 00564000
*             IF DELRC<STOPSMD      /* STILL PROCESSING SYSMOD?      */ 00565000
*                 &DELSKIP=OFF THEN /*                               */ 00566000
         CH    DELRC,@CH00056                                      0310 00567000
         BNL   @RF00310                                            0310 00568000
         TM    DELSKIP,B'01000000'                                 0310 00569000
         BNZ   @RF00310                                            0310 00570000
*               DO;                                                0311 00571000
*                                                                  0311 00572000
*                 /***************************************************/ 00573000
*                 /*                                                 */ 00574000
*                 /* CHECK TO SEE IF SYSMOD IS SUP'ED BY A SYSMOD    */ 00575000
*                 /* THAT IS ALREADY IN THE ICT AND TO MARK SUP'ED   */ 00576000
*                 /* SYSMODS IN THE ICT                              */ 00577000
*                 /*                                                 */ 00578000
*                 /***************************************************/ 00579000
*                                                                  0312 00580000
*                 CALL SUPCK(DELETE,SCLMAP,HMASMIOP,DELSUPN);      0312 00581000
         LA    @08,@CC01285                                        0312 00582000
         ST    @08,@AL00001                                        0312 00583000
         LA    @08,DELSCL                                          0312 00584000
         ST    @08,@AL00001+4                                      0312 00585000
         L     @08,CCAIOPTR(,CCAPTR)                               0312 00586000
         ST    @08,@AL00001+8                                      0312 00587000
         LA    @08,DELSUPN                                         0312 00588000
         ST    @08,@AL00001+12                                     0312 00589000
         LA    @01,@AL00001                                        0312 00590000
         BAL   @14,SUPCK                                           0312 00591000
*                 RFY                                              0313 00592000
*                   RTNCODE RSTD;                                  0313 00593000
*                 IF RTNCODE^=ZERO THEN/* SUP'OR OR SUP'EE FND?      */ 00594000
         LTR   RTNCODE,RTNCODE                                     0314 00595000
         BZ    @RF00314                                            0314 00596000
*                   DO;             /* YES,                          */ 00597000
*                     DELRC=STOPSMD;/* STOP THE SYSMOD               */ 00598000
         LA    DELRC,8                                             0316 00599000
*                     RFY                                          0317 00600000
*                       RTNCODE UNRSTD;                            0317 00601000
*                   END;                                           0318 00602000
*               END;                                               0319 00603000
@RF00314 DS    0H                                                  0320 00604000
*             IF DELRC<STOPSMD      /* STILL PROCESSING SYSMOD?      */ 00605000
*                 &DELSKIP=OFF THEN /*                               */ 00606000
@RF00310 CH    DELRC,@CH00056                                      0320 00607000
         BNL   @RF00320                                            0320 00608000
         TM    DELSKIP,B'01000000'                                 0320 00609000
         BNZ   @RF00320                                            0320 00610000
*               DO;                                                0321 00611000
*                                                                  0321 00612000
*                 /***************************************************/ 00613000
*                 /*                                                 */ 00614000
*                 /* DO NPRE AND DELETE CHECKING AND BUILD ICT ENTRY */ 00615000
*                 /*                                                 */ 00616000
*                 /***************************************************/ 00617000
*                                                                  0322 00618000
*                 CALL VERBLD(DELETE,HMASMIOP,SCLMAP,DELICTP);/*     */ 00619000
         LA    @08,@CC01285                                        0322 00620000
         ST    @08,@AL00001                                        0322 00621000
         L     @08,CCAIOPTR(,CCAPTR)                               0322 00622000
         ST    @08,@AL00001+4                                      0322 00623000
         LA    @08,DELSCL                                          0322 00624000
         ST    @08,@AL00001+8                                      0322 00625000
         LA    @08,DELICTP                                         0322 00626000
         ST    @08,@AL00001+12                                     0322 00627000
         LA    @01,@AL00001                                        0322 00628000
         BAL   @14,VERBLD                                          0322 00629000
*                 RFY                                              0323 00630000
*                   RTNCODE RSTD;                                  0323 00631000
*                 IF RTNCODE>=STOPSMD THEN/* ++VER OK AND ENTRY    0324 00632000
*                                      BUILT?                        */ 00633000
         LA    @14,8                                               0324 00634000
         CR    RTNCODE,@14                                         0324 00635000
         BL    @RF00324                                            0324 00636000
*                   DO;             /* NO,                           */ 00637000
*                     DELSKIP=ON;   /* SKIP THIS ++VER               */ 00638000
         OI    DELSKIP,B'01000000'                                 0326 00639000
*                     IF RTNCODE>STOPSMD THEN/*                      */ 00640000
         CR    RTNCODE,@14                                         0327 00641000
         BNH   @RF00327                                            0327 00642000
*                       DO;         /*                               */ 00643000
*                         DELRC=MAX(DELRC,RTNCODE);/*                */ 00644000
         CR    DELRC,RTNCODE                                       0329 00645000
         BNL   *+6                                                      00646000
         LR    DELRC,RTNCODE                                       0329 00647000
*                       END;        /*                               */ 00648000
*                     RFY                                          0331 00649000
*                       RTNCODE UNRSTD;                            0331 00650000
@RF00327 DS    0H                                                  0332 00651000
*                   END;                                           0332 00652000
*               END;                                               0333 00653000
@RF00324 DS    0H                                                  0334 00654000
*             IF DELSKIP=OFF        /* NOT SKIPPING OR ERROR         */ 00655000
*                 &DELRC<STOPFUNC THEN/*                             */ 00656000
@RF00320 TM    DELSKIP,B'01000000'                                 0334 00657000
         BNZ   @RF00334                                            0334 00658000
         CH    DELRC,@CH00033                                      0334 00659000
         BNL   @RF00334                                            0334 00660000
*               DO;                 /*                               */ 00661000
*                                                                  0335 00662000
*                 /***************************************************/ 00663000
*                 /*                                                 */ 00664000
*                 /* SEARCH SELECT LIST FOR DELETEES                 */ 00665000
*                 /*                                                 */ 00666000
*                 /***************************************************/ 00667000
*                                                                  0336 00668000
*                 CALL DELSELCK(SCLVERNO,/*                          */ 00669000
*                     HMASMIOP);    /*                               */ 00670000
         LA    @08,DELSCL                                          0336 00671000
         LA    @08,SCLVERNO(,@08)                                  0336 00672000
         ST    @08,@AL00001                                        0336 00673000
         L     @08,CCAIOPTR(,CCAPTR)                               0336 00674000
         ST    @08,@AL00001+4                                      0336 00675000
         LA    @01,@AL00001                                        0336 00676000
         BAL   @14,DELSELCK                                        0336 00677000
*                 RFY                                              0337 00678000
*                   RTNCODE RSTD;                                  0337 00679000
*                 DELRC=MAX(DELRC,RTNCODE);/* SAVE RETURN CODE       */ 00680000
         CR    DELRC,RTNCODE                                       0338 00681000
         BNL   *+6                                                      00682000
         LR    DELRC,RTNCODE                                       0338 00683000
*                 RFY                                              0339 00684000
*                   RTNCODE UNRSTD;                                0339 00685000
*               END;                /*                               */ 00686000
*             IF DELSKIP=OFF        /* NOT SKIPPING OR ERROR         */ 00687000
*                 &DELRC<STOPFUNC THEN/*                             */ 00688000
@RF00334 TM    DELSKIP,B'01000000'                                 0341 00689000
         BNZ   @RF00341                                            0341 00690000
         CH    DELRC,@CH00033                                      0341 00691000
         BNL   @RF00341                                            0341 00692000
*               DO;                 /*                               */ 00693000
*                                                                  0342 00694000
*                 /***************************************************/ 00695000
*                 /*                                                 */ 00696000
*                 /* PROCESS DELETE SYSMODS                          */ 00697000
*                 /*                                                 */ 00698000
*                 /***************************************************/ 00699000
*                                                                  0343 00700000
*                 CALL HMASMTD1(TBLXPARM,DELICTP);                 0343 00701000
         L     @08,@PC00001                                        0343 00702000
         ST    @08,@AL00001                                        0343 00703000
         LA    @08,DELICTP                                         0343 00704000
         ST    @08,@AL00001+4                                      0343 00705000
         L     @15,@CV01234                                        0343 00706000
         LA    @01,@AL00001                                        0343 00707000
         BALR  @14,@15                                             0343 00708000
*                 RFY                                              0344 00709000
*                   RTNCODE RSTD;                                  0344 00710000
*                 DELRC=MAX(DELRC,RTNCODE);/*                        */ 00711000
         CR    DELRC,RTNCODE                                       0345 00712000
         BNL   *+6                                                      00713000
         LR    DELRC,RTNCODE                                       0345 00714000
*                 RFY                                              0346 00715000
*                   RTNCODE UNRSTD;                                0346 00716000
*               END;                /*                               */ 00717000
*           END;                    /*                               */ 00718000
*         ELSE                                                     0349 00719000
*           ;                       /* NO DELETE WITH THIS ++VER     */ 00720000
@RF00297 DS    0H                                                  0350 00721000
*       END;                                                       0350 00722000
*     ELSE                                                         0351 00723000
*       ;                           /* END OF LISTS, ERROR, OR NOT A    00724000
*                                      DELETE CANDIDATE              */ 00725000
@RF00272 DS    0H                                                  0352 00726000
*     IF DELRC>=STOPSMD THEN        /* SYSMOD FAILED?                */ 00727000
@RC00272 CH    DELRC,@CH00056                                      0352 00728000
         BL    @RF00352                                            0352 00729000
*       DO;                         /* YES,                          */ 00730000
*         DELRC=STOPFUNC;           /* HALT PROCESSING               */ 00731000
         LA    DELRC,12                                            0354 00732000
*         CALL FUNCFM(SCLSMD);      /* ISSUE MESSAGE                 */ 00733000
         LA    @08,DELSCL                                          0355 00734000
         LA    @08,SCLSMD(,@08)                                    0355 00735000
         ST    @08,@AL00001                                        0355 00736000
         LA    @01,@AL00001                                        0355 00737000
         BAL   @14,FUNCFM                                          0355 00738000
*       END;                        /*                               */ 00739000
*     ELSE                                                         0357 00740000
*       ;                           /* SYSMOD IS OTHER THAN A      0357 00741000
*                                      FUNCTION                      */ 00742000
@RF00352 DS    0H                                                  0358 00743000
*   END;                            /* END OF DELETE PROCESS LOOP    */ 00744000
@DE00251 TM    ENDFUNC,B'10000000'                                 0358 00745000
         BNZ   @DC00251                                            0358 00746000
         CH    DELRC,@CH00056                                      0358 00747000
         BL    @DL00251                                            0358 00748000
@DC00251 DS    0H                                                  0359 00749000
*   IF DELRC<STOPFUNC THEN          /* ALL IS WELL?                  */ 00750000
         CH    DELRC,@CH00033                                      0359 00751000
         BNL   @RF00359                                            0359 00752000
*     DO;                                                          0360 00753000
*                                                                  0360 00754000
*       /*************************************************************/ 00755000
*       /*                                                           */ 00756000
*       /* ADD IF REQ INDEX LISTS TO ALL ICT PTF ENTRIES JUST CREATED*/ 00757000
*       /*                                                           */ 00758000
*       /*************************************************************/ 00759000
*                                                                  0361 00760000
*       CALL ADDIFS;                /*                               */ 00761000
         BAL   @14,ADDIFS                                          0361 00762000
*       RFY                                                        0362 00763000
*         RTNCODE RSTD;                                            0362 00764000
*       DELRC=MAX(DELRC,RTNCODE);                                  0363 00765000
         CR    DELRC,RTNCODE                                       0363 00766000
         BNL   *+6                                                      00767000
         LR    DELRC,RTNCODE                                       0363 00768000
*       RFY                                                        0364 00769000
*         RTNCODE UNRSTD;                                          0364 00770000
*                                                                  0364 00771000
*       /*************************************************************/ 00772000
*       /*                                                           */ 00773000
*       /* IF GROUP, ADD CANDIDATES                                  */ 00774000
*       /*                                                           */ 00775000
*       /*************************************************************/ 00776000
*                                                                  0365 00777000
*       IF DELRC<STOPFUNC THEN      /* ALL IS WELL?                  */ 00778000
         CH    DELRC,@CH00033                                      0365 00779000
         BNL   @RF00365                                            0365 00780000
*         DO;                                                      0366 00781000
*           CALL GROUPADD;                                         0367 00782000
         BAL   @14,GROUPADD                                        0367 00783000
*           RFY                                                    0368 00784000
*             RTNCODE RSTD;                                        0368 00785000
*           DELRC=MAX(DELRC,RTNCODE);/* SAVE THE RETURN CODE         */ 00786000
         CR    DELRC,RTNCODE                                       0369 00787000
         BNL   *+6                                                      00788000
         LR    DELRC,RTNCODE                                       0369 00789000
*           RFY                                                    0370 00790000
*             RTNCODE UNRSTD;                                      0370 00791000
*         END;                                                     0371 00792000
*       IF DELRC<STOPFUNC THEN      /* ALL IS WELL?                  */ 00793000
@RF00365 CH    DELRC,@CH00033                                      0372 00794000
         BNL   @RF00372                                            0372 00795000
*         DO;                                                      0373 00796000
*           TSLFUNCT=TSLFCLRP;      /* CLEAR PASS FLAGS IN THE ICT   */ 00797000
         L     @08,@PC00001                                        0374 00798000
         L     @08,TBLXTSLP(,@08)                                  0374 00799000
         MVI   TSLFUNCT(@08),X'05'                                 0374 00800000
*           CALL HMASMTSB(TSLPARMS);/* CLEAR THE FLAGS               */ 00801000
         ST    @08,@AL00001                                        0375 00802000
         L     @15,@CV01237                                        0375 00803000
         LA    @01,@AL00001                                        0375 00804000
         BALR  @14,@15                                             0375 00805000
*         END;                                                     0376 00806000
*     END;                                                         0377 00807000
@RF00372 DS    0H                                                  0378 00808000
*   RETURN CODE(DELRC);             /* RETURN WITH THE RETURN CODE   */ 00809000
@RF00359 LR    @15,DELRC                                           0378 00810000
         L     @14,@SA00003                                        0378 00811000
         LM    @00,@12,@SA00003+8                                  0378 00812000
         BR    @14                                                 0378 00813000
*   RFY                                                            0379 00814000
*     HMASMIOP BASED;                                              0379 00815000
*   RFY                                                            0380 00816000
*     HMASMGTP BASED;                                              0380 00817000
*   RFY                                                            0381 00818000
*     SCLMAP BASED;                                                0381 00819000
*                                                                  0382 00820000
*   /*****************************************************************/ 00821000
*   /*                                                               */ 00822000
*   /* DELSELCK - CHECK FOR DELETE ERRORS                            */ 00823000
*   /*                                                               */ 00824000
*   /*****************************************************************/ 00825000
*                                                                  0382 00826000
*DELSELCK:                                                         0382 00827000
*   PROC(DSCVER#,                   /* VER NUMBER                    */ 00828000
*       DSCIOP);                    /* IOP FOR THE CURRENT SYSMOD    */ 00829000
DELSELCK STM   @14,@12,@SA00004                                    0382 00830000
         MVC   @PC00004(8),0(@01)                                  0382 00831000
*   DCL                                                            0383 00832000
*     DSCIOP CHAR(*);               /* IOP                           */ 00833000
*   DCL                                                            0384 00834000
*     DSCVER# FIXED(8);             /* ++VER NUMBER                  */ 00835000
*   DCL                                                            0385 00836000
*     DSCRC FIXED(15);              /*                               */ 00837000
*   DCL                                                            0386 00838000
*     1 DSCFLAGS,                   /*                               */ 00839000
*      2 DSCEOLST BIT(1),           /* END OF SUB-ENTRIES FOUND IN 0386 00840000
*                                      DELETE SEARCH                 */ 00841000
*      2 * BIT(6);                  /*                               */ 00842000
*   RFY                                                            0387 00843000
*     HMASMIOP BASED(ADDR(DSCIOP));                                0387 00844000
*   RFY                                                            0388 00845000
*     HMASMGTP BASED(TBLXSEGT);                                    0388 00846000
*   RFY                                                            0389 00847000
*     HMASMSET BASED(GTPBUFAD);                                    0389 00848000
*   RFY                                                            0390 00849000
*     TSLPARMS BASED(TBLXTSLP);                                    0390 00850000
*   DSCRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 00851000
         SLR   DSCRC,DSCRC                                         0391 00852000
*   DSCFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 00853000
*                                                                  0392 00854000
         MVI   DSCFLAGS,X'00'                                      0392 00855000
*   /*****************************************************************/ 00856000
*   /*                                                               */ 00857000
*   /* CHECK THAT CURRENT SYSMOD DOES NOT DELETE SYSMOD IN THE SELECT*/ 00858000
*   /* LIST                                                          */ 00859000
*   /*                                                               */ 00860000
*   /*****************************************************************/ 00861000
*                                                                  0393 00862000
*   TSLENTSR=''B;                   /* CLEAR TSB PARMLIST            */ 00863000
         L     @08,@PC00001                                        0393 00864000
         L     @08,TBLXTSLP(,@08)                                  0393 00865000
         L     @03,TSLPMLAD(,@08)                                  0393 00866000
         XC    TSLENTSR(16,@03),TSLENTSR(@03)                      0393 00867000
*   TSLEBGNP=ADDR(IOPPTFVR);        /* BEGINNING OF SEARCH PTR       */ 00868000
         L     @15,@PC00004+4                                      0394 00869000
         LA    @15,IOPPTFVR(,@15)                                  0394 00870000
         ST    @15,TSLEBGNP(,@03)                                  0394 00871000
*   TSLFUNCT=TSLFENSR;              /* FUNCTION IS SEARCH IOP      0395 00872000
*                                      SUB-ENTRY                     */ 00873000
         MVI   TSLFUNCT(@08),X'06'                                 0395 00874000
*   TSLETYPE=IOPPDEL;               /* TYPE IS DELETE ENTRY          */ 00875000
         MVI   TSLETYPE(@03),X'A8'                                 0396 00876000
*   TSLEVER#=DSCVER#;               /* ++VER NUMBER                  */ 00877000
*                                                                  0397 00878000
         L     @08,@PC00004                                        0397 00879000
         MVC   TSLEVER#(1,@03),DSCVER#(@08)                        0397 00880000
*   /*****************************************************************/ 00881000
*   /*                                                               */ 00882000
*   /* PROCESS ALL RECORDS IN L1 AND L2 LOOKING FOR DEL SYSMODS      */ 00883000
*   /*                                                               */ 00884000
*   /*****************************************************************/ 00885000
*                                                                  0398 00886000
*   DO WHILE DSCRC=ZERO             /* PROCESS ENTIRE SELECT LIST    */ 00887000
*         &DSCEOLST=OFF;            /*                               */ 00888000
         B     @DE00398                                            0398 00889000
@DL00398 DS    0H                                                  0399 00890000
*     CALL HMASMTSB(TSLPARMS);      /* SEARCH FOR DEL TYPE           */ 00891000
         L     @08,@PC00001                                        0399 00892000
         L     @08,TBLXTSLP(,@08)                                  0399 00893000
         ST    @08,@AL00001                                        0399 00894000
         L     @15,@CV01237                                        0399 00895000
         LA    @01,@AL00001                                        0399 00896000
         BALR  @14,@15                                             0399 00897000
*     TSLEONXT=ON;                  /* SET TO GET NEXT DELETE ENTRY  */ 00898000
         L     @08,@PC00001                                        0400 00899000
         L     @08,TBLXTSLP(,@08)                                  0400 00900000
         L     @03,TSLPMLAD(,@08)                                  0400 00901000
         OI    TSLEONXT(@03),B'10000000'                           0400 00902000
*     IF TSLRETRN=TSLNTFND THEN     /* NOT FOUND ?                   */ 00903000
         CLI   TSLRETRN(@08),4                                     0401 00904000
         BNE   @RF00401                                            0401 00905000
*       DO;                         /* YES,                          */ 00906000
*         DSCEOLST=ON;              /* STOP THE SEARCH               */ 00907000
         OI    DSCEOLST,B'10000000'                                0403 00908000
*       END;                        /*                               */ 00909000
*     ELSE                          /* NOT FOUND                     */ 00910000
*       DO;                         /*                               */ 00911000
         B     @RC00401                                            0405 00912000
@RF00401 DS    0H                                                  0406 00913000
*         SELSTFLG=''B;             /* CLEAR FLAGS                   */ 00914000
         L     @08,@PC00001                                        0406 00915000
         L     @03,TBLXSEGT(,@08)                                  0406 00916000
         L     @15,GTPBUFAD(,@03)                                  0406 00917000
         XC    SELSTFLG(2,@15),SELSTFLG(@15)                       0406 00918000
*         SESMD=ON;                 /* TYPE IS SYSMOD                */ 00919000
         OI    SESMD(@15),B'00000001'                              0407 00920000
*         SENAME=TSLEFNDP->BASEDSMD;/* NAME IS FMID NAME             */ 00921000
         MVI   SENAME+7(@15),C' '                                  0408 00922000
         L     @08,TBLXTSLP(,@08)                                  0408 00923000
         L     @08,TSLPMLAD(,@08)                                  0408 00924000
         L     @08,TSLEFNDP(,@08)                                  0408 00925000
         MVC   SENAME(7,@15),BASEDSMD(@08)                         0408 00926000
*         GTPFUNCT=GTPLOC;          /* DO THE LOCATE                 */ 00927000
         MVI   GTPFUNCT(@03),X'03'                                 0409 00928000
*         CALL HMASMGTA(HMASMGTP);                                 0410 00929000
         ST    @03,@AL00001                                        0410 00930000
         L     @15,@CV01231                                        0410 00931000
         LA    @01,@AL00001                                        0410 00932000
         BALR  @14,@15                                             0410 00933000
*         IF GTPRETRN=GTPGOOD THEN  /* WAS THE FUNCTION FOUND?       */ 00934000
         L     @08,@PC00001                                        0411 00935000
         L     @03,TBLXSEGT(,@08)                                  0411 00936000
         CLI   GTPRETRN(@03),0                                     0411 00937000
         BNE   @RF00411                                            0411 00938000
*           DO;                                                    0412 00939000
*             DSCRC=STOPSMD;        /* WE HAVE A LIVE DELETOR        */ 00940000
*                                                                  0413 00941000
         LA    DSCRC,8                                             0413 00942000
*             /*******************************************************/ 00943000
*             /*                                                     */ 00944000
*             /* ISSUE MESSAGE HMA364I DELETE ERROR - SYSMOD XXXXXXX */ 00945000
*             /* DELETES XXXXXXX BOTH OF WHICH ARE BEING XXXXXXXX    */ 00946000
*             /*                                                     */ 00947000
*             /*******************************************************/ 00948000
*                                                                  0414 00949000
*             DO;                   /* HMASMPMG M1(HMA364I)TYPE(ERR)V   00950000
*                                      AR(IOPNAM17,SENAME,TBLXFUND)TA   00951000
*                                      RGET(SYSOUT,LOG)              */ 00952000
*               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS    */ 00953000
         XC    HMASMMGP(28),HMASMMGP                               0415 00954000
*               MGPMGNO1=HMA364I;   /* SET UP MSG 1 CODE             */ 00955000
         MVC   MGPMGNO1(2),@CH00791                                0416 00956000
*               MGPTYPE=MGPERR;     /* SET MESSAGE TYPE              */ 00957000
         MVI   MGPTYPE,X'03'                                       0417 00958000
*               MGPPRINT='1'B;      /* SET TARGET FLAG               */ 00959000
*               MGPHLDS='1'B;       /* SET TARGET FLAG               */ 00960000
         OI    MGPPRINT,B'10010000'                                0419 00961000
*               MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR       */ 00962000
         L     @15,@PC00004+4                                      0420 00963000
         LA    @15,IOPNAM17(,@15)                                  0420 00964000
         ST    @15,MGPVARPT                                        0420 00965000
*               MGPVARPT(2)=ADDR(SENAME);/* SET VARIABLE PTR         */ 00966000
         L     @03,GTPBUFAD(,@03)                                  0421 00967000
         LA    @03,SENAME(,@03)                                    0421 00968000
         ST    @03,MGPVARPT+4                                      0421 00969000
*               MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR       */ 00970000
         LA    @08,TBLXFUND(,@08)                                  0422 00971000
         ST    @08,MGPVARPT+8                                      0422 00972000
*               CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED       */ 00973000
         L     @15,@CV01230                                        0423 00974000
         LA    @01,@AL00423                                        0423 00975000
         BALR  @14,@15                                             0423 00976000
*             END;                  /*                               */ 00977000
*           END;                                                   0425 00978000
*         ELSE                                                     0426 00979000
*           ;                       /* NOT IN SELECT LIST, CONTINUE     00980000
*                                      SEARCH WITH NEXT DELETED    0426 00981000
*                                      SYSMOD                        */ 00982000
@RF00411 DS    0H                                                  0427 00983000
*       END;                                                       0427 00984000
*   END;                            /* END OF IOP DELETE SEARCH LOOP */ 00985000
@RC00401 DS    0H                                                  0428 00986000
@DE00398 LTR   DSCRC,DSCRC                                         0428 00987000
         BNZ   @DC00398                                            0428 00988000
         TM    DSCEOLST,B'10000000'                                0428 00989000
         BZ    @DL00398                                            0428 00990000
@DC00398 DS    0H                                                  0429 00991000
*   RETURN CODE(DSCRC);             /* RETURN WITH THE RETURN CODE   */ 00992000
         LR    @15,DSCRC                                           0429 00993000
         L     @14,@SA00004                                        0429 00994000
         LM    @00,@12,@SA00004+8                                  0429 00995000
         BR    @14                                                 0429 00996000
*   RFY                                                            0430 00997000
*     HMASMGTP BASED;                                              0430 00998000
*   RFY                                                            0431 00999000
*     HMASMSET BASED;                                              0431 01000000
*   RFY                                                            0432 01001000
*     TSLPARMS BASED;                                              0432 01002000
*   RFY                                                            0433 01003000
*     TSLPARMS BASED;                                              0433 01004000
*   END DELSELCK;                                                  0434 01005000
*   END DELSMD;                                                    0435 01006000
*                                                                  0436 01007000
*   /*****************************************************************/ 01008000
*   /*                                                               */ 01009000
*   /* F1BUILD - BUILD 1ST LEVEL FUNCTION ICT ENTRIES                */ 01010000
*   /*                                                               */ 01011000
*   /*****************************************************************/ 01012000
*                                                                  0436 01013000
*F1BUILD:                                                          0436 01014000
*   PROC;                                                          0436 01015000
F1BUILD  STM   @14,@12,@SA00005                                    0436 01016000
*   DCL                                                            0437 01017000
*     1 F1BFLAGS BIT(8),            /*                               */ 01018000
*      2 F1BCMP BIT(1),             /* L1 BUILD COMPLETE (I.E. NO NEW   01019000
*                                      FUNCTIONS ADDED TO THE TABLE     01020000
*                                      IN THE LAST PASS THRU L1)     */ 01021000
*      2 F1BL1END BIT(1),           /* END OF L1 ENCOUNTERRED IN SCL */ 01022000
*      2 F1BSKIP BIT(1),            /* SKIP THIS SYSMOD              */ 01023000
*      2 * BIT(5);                  /* UNUSED                        */ 01024000
*   DCL                                                            0438 01025000
*     F1BRC FIXED(15);              /*                               */ 01026000
*   DCL                                                            0439 01027000
*     F1BCKEY@ PTR(31);             /* PTR TO SCL KEY FOR CURRENT  0439 01028000
*                                      ENTRY                         */ 01029000
*   DCL                                                            0440 01030000
*     F1BENTP PTR(31);              /* PTR TO ICT ENTRY FOR THE    0440 01031000
*                                      FUNCTION                      */ 01032000
*   RFY                                                            0441 01033000
*     HMASMIOP BASED(CCAIOPTR);     /* EXTENDED IOP                  */ 01034000
*   RFY                                                            0442 01035000
*     HMASMGTP BASED(TBLXSCGT);     /* GTP FOR SCL                   */ 01036000
*   RFY                                                            0443 01037000
*     SCLMAP BASED(GTPBUFAD);       /* SCL IS IN GTP BUFFER          */ 01038000
*   RFY                                                            0444 01039000
*     TSLPARMS BASED(TBLXTSLP);                                    0444 01040000
*   F1BRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 01041000
         SLR   F1BRC,F1BRC                                         0445 01042000
*   F1BFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 01043000
         MVI   F1BFLAGS,X'00'                                      0446 01044000
*                                                                  0447 01045000
*/* NOTE THAT CANDIDATES IN L1 HAVE 1 AND ONLY 1 APPLICABLE ++VER    */ 01046000
*                                                                  0447 01047000
*   /*****************************************************************/ 01048000
*   /*                                                               */ 01049000
*   /* PROCESS ALL RECORDS IN THE SYSMOD CANDIDATE LIST UNTIL ALL    */ 01050000
*   /* POSSIBLE CANDIDETES HAVE BEEN ADDED TO THE ICT. IF GROUP,     */ 01051000
*   /* PROCESSING WILL CONTINUE UNTIL ALL POSSIBLE REQS HAVE BEEN    */ 01052000
*   /* ADDED TO THE ICT                                              */ 01053000
*   /*                                                               */ 01054000
*   /*****************************************************************/ 01055000
*                                                                  0447 01056000
*   DO WHILE(F1BRC=ZERO             /* PROCESS UNTIL NO MORE       0447 01057000
*                                      FUNCTIONS ADDED               */ 01058000
*         &F1BCMP=OFF);             /*                               */ 01059000
         B     @DE00447                                            0447 01060000
@DL00447 DS    0H                                                  0448 01061000
*     F1BCMP=ON;                    /* ASSUME COMPLETION OF 1ST LEVEL   01062000
*                                      FUNC BUILD                    */ 01063000
         OI    F1BCMP,B'10000000'                                  0448 01064000
*     F1BCKEY@=ZERO;                /* CURRENT SCL LIST PTR          */ 01065000
*                                                                  0449 01066000
         SLR   @08,@08                                             0449 01067000
         ST    @08,F1BCKEY@                                        0449 01068000
*     /***************************************************************/ 01069000
*     /*                                                             */ 01070000
*     /* LOOP THRU LIST ONCE ADDING ALL POSSIBLE CANDIDATES          */ 01071000
*     /*                                                             */ 01072000
*     /***************************************************************/ 01073000
*                                                                  0450 01074000
*     F1BL1END=OFF;                 /* CLEAR END OF LIST FLAG        */ 01075000
         NI    F1BL1END,B'10111111'                                0450 01076000
*     DO UNTIL(F1BL1END=ON          /* PASS THRU L1 LIST ONCE        */ 01077000
*           |F1BRC>STOPFUNC);       /*                               */ 01078000
@DL00451 DS    0H                                                  0452 01079000
*       F1BSKIP=OFF;                /* ASSUME SYSMOD NOT TO BE     0452 01080000
*                                      SKIPPED                       */ 01081000
         NI    F1BSKIP,B'11011111'                                 0452 01082000
*       CALL LOCNXT(HMASMIOP,SCLL1,F1BCKEY@);/*                      */ 01083000
         MVC   @AL00001+4(8),@AL00453                              0453 01084000
         L     @08,CCAIOPTR(,CCAPTR)                               0453 01085000
         ST    @08,@AL00001                                        0453 01086000
         LA    @01,@AL00001                                        0453 01087000
         BAL   @14,LOCNXT                                          0453 01088000
*       RFY                                                        0454 01089000
*         RTNCODE RSTD;             /*                               */ 01090000
*       IF RTNCODE=GTPEOF THEN      /* END OF FILE?                  */ 01091000
         CH    RTNCODE,@CH00038                                    0455 01092000
         BNE   @RF00455                                            0455 01093000
*         DO;                       /* YES,                          */ 01094000
*           F1BL1END=ON;            /* END OF L1 LIST                */ 01095000
         OI    F1BL1END,B'01000000'                                0457 01096000
*         END;                      /*                               */ 01097000
*       ELSE                        /* OTHER THAN NOT FOUND          */ 01098000
*         DO;                                                      0459 01099000
         B     @RC00455                                            0459 01100000
@RF00455 DS    0H                                                  0460 01101000
*           F1BRC=MAX(F1BRC,RTNCODE);/* SAVE RC                      */ 01102000
         CR    F1BRC,RTNCODE                                       0460 01103000
         BNL   *+6                                                      01104000
         LR    F1BRC,RTNCODE                                       0460 01105000
*           RFY                                                    0461 01106000
*             RTNCODE UNRSTD;                                      0461 01107000
*         END;                                                     0462 01108000
*                                                                  0462 01109000
*       /*************************************************************/ 01110000
*       /*                                                           */ 01111000
*       /* CHECK TO INSURE THAT CAN BE PUT ON                        */ 01112000
*       /*                                                           */ 01113000
*       /*************************************************************/ 01114000
*                                                                  0463 01115000
*       IF SCLCAND=ON               /* SYSMOD IS CANDIDATE           */ 01116000
*           &F1BL1END=OFF           /* AND NOT END OF LIST           */ 01117000
*           &F1BRC<STOPFUNC THEN    /* ++VER IS STILL GO?            */ 01118000
@RC00455 L     @08,@PC00001                                        0463 01119000
         L     @02,TBLXSCGT(,@08)                                  0463 01120000
         L     @02,GTPBUFAD(,@02)                                  0463 01121000
         TM    SCLCAND(@02),B'00100000'                            0463 01122000
         BNO   @RF00463                                            0463 01123000
         TM    F1BL1END,B'01000000'                                0463 01124000
         BNZ   @RF00463                                            0463 01125000
         CH    F1BRC,@CH00033                                      0463 01126000
         BNL   @RF00463                                            0463 01127000
*         DO;                       /* YES,                          */ 01128000
*           TSLICTSR=''B;           /* CLEAR PARMLIST                */ 01129000
         L     @08,TBLXTSLP(,@08)                                  0465 01130000
         L     @15,TSLPMLAD(,@08)                                  0465 01131000
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      0465 01132000
*           TSLFUNCT=TSLFISRH;      /* SEARCH TO SEE IF SYSMOD ...   */ 01133000
         MVI   TSLFUNCT(@08),X'01'                                 0466 01134000
*           TSLISMD=SCLSMD;         /* ... ALREADY IN THE ICT        */ 01135000
         MVC   TSLISMD(7,@15),SCLSMD(@02)                          0467 01136000
*           CALL HMASMTSB(TSLPARMS);                               0468 01137000
         ST    @08,@AL00001                                        0468 01138000
         L     @15,@CV01237                                        0468 01139000
         LA    @01,@AL00001                                        0468 01140000
         BALR  @14,@15                                             0468 01141000
*           IF TSLIOK=ON            /* FOUND OK                      */ 01142000
*               |TSLISUP=ON         /* ... OR SUP'ED?                */ 01143000
*             THEN                                                 0469 01144000
         L     @08,@PC00001                                        0469 01145000
         L     @08,TBLXTSLP(,@08)                                  0469 01146000
         L     @08,TSLPMLAD(,@08)                                  0469 01147000
         TM    TSLIOK(@08),B'01100000'                             0469 01148000
         BZ    @RF00469                                            0469 01149000
*             DO;                                                  0470 01150000
*               F1BSKIP=ON;         /* SKIP THE SYSMOD               */ 01151000
         OI    F1BSKIP,B'00100000'                                 0471 01152000
*             END;                                                 0472 01153000
*           IF F1BRC<STOPSMD        /* ALL IS WELL ...               */ 01154000
*               &F1BSKIP=OFF THEN   /* ... AND NOT SKIPPING          */ 01155000
@RF00469 LA    @08,8                                               0473 01156000
         CR    F1BRC,@08                                           0473 01157000
         BNL   @RF00473                                            0473 01158000
         TM    F1BSKIP,B'00100000'                                 0473 01159000
         BNZ   @RF00473                                            0473 01160000
*             DO;                                                  0474 01161000
*               IF F1BRC<STOPSMD    /* STILL PROCESSING SYSMOD?      */ 01162000
*                   &F1BSKIP=OFF THEN/*                              */ 01163000
         CR    F1BRC,@08                                           0475 01164000
         BNL   @RF00475                                            0475 01165000
         TM    F1BSKIP,B'00100000'                                 0475 01166000
         BNZ   @RF00475                                            0475 01167000
*                 DO;                                              0476 01168000
*                                                                  0476 01169000
*                   /*************************************************/ 01170000
*                   /*                                               */ 01171000
*                   /* CHECK FOR FUNCTION BEING SUPERCEEDED          */ 01172000
*                   /*                                               */ 01173000
*                   /*************************************************/ 01174000
*                                                                  0477 01175000
*                   CALL SUPCK(LEVEL1,SCLMAP,HMASMIOP,F1SUPN);     0477 01176000
         LA    @08,@CC01106                                        0477 01177000
         ST    @08,@AL00001                                        0477 01178000
         L     @08,@PC00001                                        0477 01179000
         L     @08,TBLXSCGT(,@08)                                  0477 01180000
         L     @08,GTPBUFAD(,@08)                                  0477 01181000
         ST    @08,@AL00001+4                                      0477 01182000
         L     @08,CCAIOPTR(,CCAPTR)                               0477 01183000
         ST    @08,@AL00001+8                                      0477 01184000
         LA    @08,F1SUPN                                          0477 01185000
         ST    @08,@AL00001+12                                     0477 01186000
         LA    @01,@AL00001                                        0477 01187000
         BAL   @14,SUPCK                                           0477 01188000
*                   RFY                                            0478 01189000
*                     RTNCODE RSTD;                                0478 01190000
*                   IF RTNCODE=STOPSMD THEN/* SUPED BY ICT SYSMOD?   */ 01191000
         CH    RTNCODE,@CH00056                                    0479 01192000
         BNE   @RF00479                                            0479 01193000
*                     DO;           /* YES,                          */ 01194000
*                       F1BSKIP=ON; /* THEN SKIP SYSMOD              */ 01195000
         OI    F1BSKIP,B'00100000'                                 0481 01196000
*                       RFY                                        0482 01197000
*                         RTNCODE UNRSTD;                          0482 01198000
*                     END;                                         0483 01199000
*                 END;                                             0484 01200000
*                                                                  0484 01201000
@RF00479 DS    0H                                                  0485 01202000
*               /*****************************************************/ 01203000
*               /*                                                   */ 01204000
*               /* NOW HAVE AN APPLICABLE 1ST LEVEL FUNCTION. IF IT  */ 01205000
*               /* FAILS AFTER THIS POINT, THE SMP FUNCTION WILL BE  */ 01206000
*               /* FAILED                                            */ 01207000
*               /*                                                   */ 01208000
*               /*****************************************************/ 01209000
*                                                                  0485 01210000
*               IF F1BRC<STOPSMD    /* STILL PROCESSING SYSMOD?      */ 01211000
*                   &F1BSKIP=OFF THEN/*                              */ 01212000
@RF00475 CH    F1BRC,@CH00056                                      0485 01213000
         BNL   @RF00485                                            0485 01214000
         TM    F1BSKIP,B'00100000'                                 0485 01215000
         BNZ   @RF00485                                            0485 01216000
*                 DO;                                              0486 01217000
*                   CALL SELFND(SCLSMD);/* MARK SELECT LIST ENTRY SO    01218000
*                                      THAT SELECTED SYSMOD NOT    0487 01219000
*                                      PROCESSED MESSAGE NOT ISSUED  */ 01220000
         L     @08,@PC00001                                        0487 01221000
         L     @08,TBLXSCGT(,@08)                                  0487 01222000
         L     @08,GTPBUFAD(,@08)                                  0487 01223000
         LA    @08,SCLSMD(,@08)                                    0487 01224000
         ST    @08,@AL00001                                        0487 01225000
         LA    @01,@AL00001                                        0487 01226000
         BAL   @14,SELFND                                          0487 01227000
*                   CALL VERBLD(LEVEL1,HMASMIOP,SCLMAP,F1BENTP);/*   */ 01228000
         LA    @08,@CC01106                                        0488 01229000
         ST    @08,@AL00001                                        0488 01230000
         L     @08,CCAIOPTR(,CCAPTR)                               0488 01231000
         ST    @08,@AL00001+4                                      0488 01232000
         L     @08,@PC00001                                        0488 01233000
         L     @08,TBLXSCGT(,@08)                                  0488 01234000
         L     @08,GTPBUFAD(,@08)                                  0488 01235000
         ST    @08,@AL00001+8                                      0488 01236000
         LA    @08,F1BENTP                                         0488 01237000
         ST    @08,@AL00001+12                                     0488 01238000
         LA    @01,@AL00001                                        0488 01239000
         BAL   @14,VERBLD                                          0488 01240000
*                   RFY                                            0489 01241000
*                     RTNCODE RSTD;                                0489 01242000
*                   F1BRC=MAX(F1BRC,RTNCODE);/* SAVE RC              */ 01243000
         CR    F1BRC,RTNCODE                                       0490 01244000
         BNL   *+6                                                      01245000
         LR    F1BRC,RTNCODE                                       0490 01246000
*                   IF RTNCODE=ZERO THEN/* ALL IS WELL?              */ 01247000
         LTR   RTNCODE,RTNCODE                                     0491 01248000
         BNZ   @RF00491                                            0491 01249000
*                     DO;           /* YES,                          */ 01250000
*                       F1BCMP=OFF;                                0493 01251000
         NI    F1BCMP,B'01111111'                                  0493 01252000
*                       F1BENTP->ICTPSUPN(1)=F1SUPN;/* SUP COUNT     */ 01253000
         L     @14,F1BENTP                                         0494 01254000
         MVC   ICTPSUPN(2,@14),F1SUPN                              0494 01255000
*                     END;                                         0495 01256000
*                   RFY                                            0496 01257000
*                     RTNCODE UNRSTD;                              0496 01258000
@RF00491 DS    0H                                                  0497 01259000
*                 END;              /*                               */ 01260000
*             END;                  /*                               */ 01261000
*         END;                      /*                               */ 01262000
*       ELSE                                                       0500 01263000
*         ;                         /*                               */ 01264000
@RF00463 DS    0H                                                  0501 01265000
*       IF F1BRC=STOPSMD THEN       /* FUNCTION FAILED?              */ 01266000
@RC00463 CH    F1BRC,@CH00056                                      0501 01267000
         BNE   @RF00501                                            0501 01268000
*         DO;                       /* YES,                          */ 01269000
*           F1BRC=STOPFUNC;         /* STOP THE FUNCTION             */ 01270000
         LA    F1BRC,12                                            0503 01271000
*           CALL FUNCFM(SCLSMD);    /* ISSUE SMP FUNCTION FAILED MSG */ 01272000
         L     @08,@PC00001                                        0504 01273000
         L     @08,TBLXSCGT(,@08)                                  0504 01274000
         L     @08,GTPBUFAD(,@08)                                  0504 01275000
         LA    @08,SCLSMD(,@08)                                    0504 01276000
         ST    @08,@AL00001                                        0504 01277000
         LA    @01,@AL00001                                        0504 01278000
         BAL   @14,FUNCFM                                          0504 01279000
*         END;                      /*                               */ 01280000
*       ELSE                                                       0506 01281000
*         ;                         /* NOT A STOP FUNCTION           */ 01282000
@RF00501 DS    0H                                                  0507 01283000
*     END;                          /* END OF PASS THRU L1 LIST      */ 01284000
@DE00451 TM    F1BL1END,B'01000000'                                0507 01285000
         BO    @DC00451                                            0507 01286000
         CH    F1BRC,@CH00033                                      0507 01287000
         BNH   @DL00451                                            0507 01288000
@DC00451 DS    0H                                                  0508 01289000
*     IF F1BRC<STOPFUNC THEN        /* ALL IS WELL?                  */ 01290000
         CH    F1BRC,@CH00033                                      0508 01291000
         BNL   @RF00508                                            0508 01292000
*       DO;                                                        0509 01293000
*                                                                  0509 01294000
*         /***********************************************************/ 01295000
*         /*                                                         */ 01296000
*         /* ADD IF REQ INDEX LISTS TO ALL ICT PTF ENTRIES JUST      */ 01297000
*         /* CREATED                                                 */ 01298000
*         /*                                                         */ 01299000
*         /***********************************************************/ 01300000
*                                                                  0510 01301000
*         CALL ADDIFS;              /*                               */ 01302000
         BAL   @14,ADDIFS                                          0510 01303000
*         RFY                                                      0511 01304000
*           RTNCODE RSTD;                                          0511 01305000
*         F1BRC=MAX(F1BRC,RTNCODE);                                0512 01306000
         CR    F1BRC,RTNCODE                                       0512 01307000
         BNL   *+6                                                      01308000
         LR    F1BRC,RTNCODE                                       0512 01309000
*         RFY                                                      0513 01310000
*           RTNCODE UNRSTD;                                        0513 01311000
*                                                                  0513 01312000
*         /***********************************************************/ 01313000
*         /*                                                         */ 01314000
*         /* IF GROUP, ... CLEAR THIS PASS FLAGS                     */ 01315000
*         /*                                                         */ 01316000
*         /***********************************************************/ 01317000
*                                                                  0514 01318000
*         IF F1BRC<STOPFUNC THEN    /* ALL IS WELL?                  */ 01319000
         CH    F1BRC,@CH00033                                      0514 01320000
         BNL   @RF00514                                            0514 01321000
*           DO;                                                    0515 01322000
*             CALL GROUPADD;                                       0516 01323000
         BAL   @14,GROUPADD                                        0516 01324000
*           END;                                                   0517 01325000
*         IF F1BRC<STOPFUNC THEN    /* ALL IS WELL?                  */ 01326000
@RF00514 CH    F1BRC,@CH00033                                      0518 01327000
         BNL   @RF00518                                            0518 01328000
*           DO;                                                    0519 01329000
*             TSLFUNCT=TSLFCLRP;    /* CLEAR PASS FLAGS IN THE ICT   */ 01330000
         L     @08,@PC00001                                        0520 01331000
         L     @08,TBLXTSLP(,@08)                                  0520 01332000
         MVI   TSLFUNCT(@08),X'05'                                 0520 01333000
*             CALL HMASMTSB(TSLPARMS);                             0521 01334000
         ST    @08,@AL00001                                        0521 01335000
         L     @15,@CV01237                                        0521 01336000
         LA    @01,@AL00001                                        0521 01337000
         BALR  @14,@15                                             0521 01338000
*           END;                                                   0522 01339000
*       END;                                                       0523 01340000
@RF00518 DS    0H                                                  0524 01341000
*   END;                            /* END OF 1ST LEVEL FUNCTION   0524 01342000
*                                      BUILD LOOP                    */ 01343000
@RF00508 DS    0H                                                  0524 01344000
@DE00447 LTR   F1BRC,F1BRC                                         0524 01345000
         BNZ   @DC00447                                            0524 01346000
         TM    F1BCMP,B'10000000'                                  0524 01347000
         BZ    @DL00447                                            0524 01348000
@DC00447 DS    0H                                                  0525 01349000
*   RETURN CODE(F1BRC);             /* RETURN WITH THE RETURN CODE   */ 01350000
         LR    @15,F1BRC                                           0525 01351000
         L     @14,@SA00005                                        0525 01352000
         LM    @00,@12,@SA00005+8                                  0525 01353000
         BR    @14                                                 0525 01354000
*   RFY                                                            0526 01355000
*     HMASMIOP BASED;                                              0526 01356000
*   RFY                                                            0527 01357000
*     HMASMGTP BASED;                                              0527 01358000
*   RFY                                                            0528 01359000
*     SCLMAP BASED;                                                0528 01360000
*   RFY                                                            0529 01361000
*     TSLPARMS BASED;                                              0529 01362000
*   END F1BUILD;                    /*                               */ 01363000
*                                                                  0531 01364000
*   /*****************************************************************/ 01365000
*   /*                                                               */ 01366000
*   /* F2BUILD - BUILD ICT FOR SECOND LEVEL FUNCTIONS                */ 01367000
*   /*                                                               */ 01368000
*   /*****************************************************************/ 01369000
*                                                                  0531 01370000
*F2BUILD:                                                          0531 01371000
*   PROC;                                                          0531 01372000
F2BUILD  STM   @14,@12,@SA00006                                    0531 01373000
*   DCL                                                            0532 01374000
*     1 F2BFLAGS BIT(8),            /*                               */ 01375000
*      2 F2BCMP BIT(1),             /* L2 BUILD COMPLETE (I.E. NO NEW   01376000
*                                      FUNCTIONS ADDED TO THE TABLE     01377000
*                                      IN THE LAST PASS THRU L2)     */ 01378000
*      2 F2BL2END BIT(1),           /* END OF L2 ENCOUNTERRED IN SCL */ 01379000
*      2 F2BSKIP BIT(1),            /* SKIP THIS SYSMOD              */ 01380000
*      2 F2BGET BIT(1),             /* GET NEXT RECORD FROM SCL GTA     01381000
*                                      FILE                          */ 01382000
*      2 * BIT(4);                  /* UNUSED                        */ 01383000
*   DCL                                                            0533 01384000
*     F2BRC FIXED(15);              /*                               */ 01385000
*   DCL                                                            0534 01386000
*     F2BCKEY@ PTR(31);             /* PTR TO SCL KEY FOR CURRENT  0534 01387000
*                                      ENTRY                         */ 01388000
*   DCL                                                            0535 01389000
*     F2BENTP PTR(31);              /* PTR TO ICT ENTRY CREATED THE     01390000
*                                      CURRENT SYSMOD BEING PROCESSED*/ 01391000
*   DCL                                                            0536 01392000
*     F2BSCL CHAR(LENGTH(SCLMAP));  /* SCL RECORD GOTTEN BY GETNLSMD */ 01393000
*   RFY                                                            0537 01394000
*     HMASMIOP BASED(CCAIOPTR);     /* EXTENDED IOP                  */ 01395000
*   RFY                                                            0538 01396000
*     HMASMGTP BASED(TBLXSCGT);     /* GTP FOR SCL                   */ 01397000
*   RFY                                                            0539 01398000
*     SCLMAP BASED(GTPBUFAD);       /* SCL IS IN GTP BUFFER          */ 01399000
*   RFY                                                            0540 01400000
*     TSLPARMS BASED(TBLXTSLP);                                    0540 01401000
*   F2BRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 01402000
         SLR   F2BRC,F2BRC                                         0541 01403000
*   F2BFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 01404000
         MVI   F2BFLAGS,X'00'                                      0542 01405000
*   DO WHILE(F2BRC<STOPFUNC         /* PROCESS UNTIL NO MORE       0543 01406000
*                                      FUNCTIONS ADDED               */ 01407000
*         &F2BCMP=OFF);             /*                               */ 01408000
         B     @DE00543                                            0543 01409000
@DL00543 DS    0H                                                  0544 01410000
*     F2BCMP=ON;                    /* ASSUME COMPLETION OF 1ST LEVEL   01411000
*                                      FUNC BUILD                    */ 01412000
         OI    F2BCMP,B'10000000'                                  0544 01413000
*     F2BCKEY@=ZERO;                /* CURRENT SCL LIST PTR          */ 01414000
         SLR   @08,@08                                             0545 01415000
         ST    @08,F2BCKEY@                                        0545 01416000
*     F2BGET=ON;                    /* GET NEXT SCL RECORD           */ 01417000
*     F2BL2END=OFF;                 /* CLEAR END OF L2 LIST FLAG     */ 01418000
         OI    F2BGET,B'00010000'                                  0547 01419000
         NI    F2BL2END,B'10111111'                                0547 01420000
*     DO UNTIL(F2BL2END=ON          /* PASS THRU L2 LIST ONCE        */ 01421000
*           |F2BRC=>STOPFUNC);      /*                               */ 01422000
@DL00548 DS    0H                                                  0549 01423000
*       F2BSKIP=OFF;                /* SKIP THE SYSMOD               */ 01424000
         NI    F2BSKIP,B'11011111'                                 0549 01425000
*       IF F2BGET=ON THEN           /* GET NEXT RECORD?              */ 01426000
         TM    F2BGET,B'00010000'                                  0550 01427000
         BNO   @RF00550                                            0550 01428000
*         DO;                                                      0551 01429000
*           CALL GETNLSMD(SCLL2,F2BCKEY@,F2BSCL);/* GET NEXT RECORD     01430000
*                                      FROM SCL FOR L2               */ 01431000
         LA    @01,@AL00552                                        0552 01432000
         BAL   @14,GETNLSMD                                        0552 01433000
*           RFY                                                    0553 01434000
*             RTNCODE RSTD;         /*                               */ 01435000
*         END;                                                     0554 01436000
*       ELSE                        /* NO NEED TO GET NEXT SCL RECORD*/ 01437000
*         DO;                                                      0555 01438000
         B     @RC00550                                            0555 01439000
@RF00550 DS    0H                                                  0556 01440000
*           RTNCODE=GTPRETRN;       /* USE RETURN CODE FORM PREVIOUS    01441000
*                                      GETN                          */ 01442000
         L     @08,@PC00001                                        0556 01443000
         L     @08,TBLXSCGT(,@08)                                  0556 01444000
         SLR   RTNCODE,RTNCODE                                     0556 01445000
         IC    RTNCODE,GTPRETRN(,@08)                              0556 01446000
*           F2BSCL=SCLMAP;          /* SET RECORD TO PREVIOUSLY    0557 01447000
*                                      GOTTEN ONE                    */ 01448000
         L     @14,GTPBUFAD(,@08)                                  0557 01449000
         MVC   F2BSCL(17),SCLMAP(@14)                              0557 01450000
*         END;                                                     0558 01451000
*       IF RTNCODE=GTPEOF THEN      /* END OF FILE?                  */ 01452000
@RC00550 CH    RTNCODE,@CH00038                                    0559 01453000
         BNE   @RF00559                                            0559 01454000
*         DO;                       /* YES,                          */ 01455000
*           RFY                                                    0561 01456000
*             RTNCODE UNRSTD;                                      0561 01457000
*           F2BL2END=ON;            /* END OF L2 LIST                */ 01458000
*           F2BSKIP=ON;             /* SKIP THE ++VER                */ 01459000
         OI    F2BL2END,B'01100000'                                0563 01460000
*         END;                      /*                               */ 01461000
*       F2BGET=ON;                  /* RESET GET NEXT RECORD FLAG    */ 01462000
*                                                                  0565 01463000
@RF00559 OI    F2BGET,B'00010000'                                  0565 01464000
*       /*************************************************************/ 01465000
*       /*                                                           */ 01466000
*       /* CHECK TO SEE IF THE SYSMOD IS ALREADY IN THE ICT. IF SO,  */ 01467000
*       /* SKIP PROCESSING IT.                                       */ 01468000
*       /*                                                           */ 01469000
*       /*************************************************************/ 01470000
*                                                                  0566 01471000
*       IF SCLCAND=ON               /* SYSMOD IS CANDIDATE           */ 01472000
*           &F2BSKIP=OFF            /* AND NOT TO BE SKIPED          */ 01473000
*           &F2BRC<STOPSMD THEN     /* ++VER IS STILL GO?            */ 01474000
         L     @08,@PC00001                                        0566 01475000
         L     @02,TBLXSCGT(,@08)                                  0566 01476000
         L     @02,GTPBUFAD(,@02)                                  0566 01477000
         TM    SCLCAND(@02),B'00100000'                            0566 01478000
         BNO   @RF00566                                            0566 01479000
         TM    F2BSKIP,B'00100000'                                 0566 01480000
         BNZ   @RF00566                                            0566 01481000
         CH    F2BRC,@CH00056                                      0566 01482000
         BNL   @RF00566                                            0566 01483000
*         DO;                       /* YES,                          */ 01484000
*           TSLICTSR=''B;           /* CLEAR PARMLIST                */ 01485000
         L     @08,TBLXTSLP(,@08)                                  0568 01486000
         L     @15,TSLPMLAD(,@08)                                  0568 01487000
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      0568 01488000
*           TSLFUNCT=TSLFISRH;      /* SEARCH TO SEE IF SYSMOD ...   */ 01489000
         MVI   TSLFUNCT(@08),X'01'                                 0569 01490000
*           TSLISMD=SCLSMD;         /* ... ALREADY IN THE ICT        */ 01491000
         MVC   TSLISMD(7,@15),SCLSMD(@02)                          0570 01492000
*           CALL HMASMTSB(TSLPARMS);                               0571 01493000
         ST    @08,@AL00001                                        0571 01494000
         L     @15,@CV01237                                        0571 01495000
         LA    @01,@AL00001                                        0571 01496000
         BALR  @14,@15                                             0571 01497000
*           IF TSLIOK=ON            /* FOUND OK                      */ 01498000
*               |TSLISUP=ON         /* ... OR SUP'ED?                */ 01499000
*             THEN                                                 0572 01500000
         L     @08,@PC00001                                        0572 01501000
         L     @08,TBLXTSLP(,@08)                                  0572 01502000
         L     @08,TSLPMLAD(,@08)                                  0572 01503000
         TM    TSLIOK(@08),B'01100000'                             0572 01504000
         BZ    @RF00572                                            0572 01505000
*             DO;                                                  0573 01506000
*               F2BSKIP=ON;         /* SKIP THE SYSMOD               */ 01507000
         OI    F2BSKIP,B'00100000'                                 0574 01508000
*             END;                                                 0575 01509000
*         END;                                                     0576 01510000
*       ELSE                        /* NOT A CANDIDATE OR ERROR      */ 01511000
*         DO;                                                      0577 01512000
         B     @RC00566                                            0577 01513000
@RF00566 DS    0H                                                  0578 01514000
*           F2BSKIP=ON;             /* SKIP THE VER                  */ 01515000
         OI    F2BSKIP,B'00100000'                                 0578 01516000
*         END;                                                     0579 01517000
*       IF F2BRC<STOPSMD            /* ALL IS WELL?                  */ 01518000
*           &F2BSKIP=OFF THEN       /* AND ^ SKIP ?                  */ 01519000
@RC00566 CH    F2BRC,@CH00056                                      0580 01520000
         BNL   @RF00580                                            0580 01521000
         TM    F2BSKIP,B'00100000'                                 0580 01522000
         BNZ   @RF00580                                            0580 01523000
*         DO;                       /* YES,                          */ 01524000
*                                                                  0581 01525000
*           /*********************************************************/ 01526000
*           /*                                                       */ 01527000
*           /* DETERMINE APPLICABILITY OF ++VER, I.E. THE SYSMOD IS  */ 01528000
*           /* FMID'ED SYMOD ON THE SYSTEM OR ICT                    */ 01529000
*           /*                                                       */ 01530000
*           /*********************************************************/ 01531000
*                                                                  0582 01532000
*           CALL APPLVER(SCLMAP);   /* DETERMINE APPLICABLILITY OF 0582 01533000
*                                      THIS ++VER                    */ 01534000
         L     @08,@PC00001                                        0582 01535000
         L     @08,TBLXSCGT(,@08)                                  0582 01536000
         L     @08,GTPBUFAD(,@08)                                  0582 01537000
         ST    @08,@AL00001                                        0582 01538000
         LA    @01,@AL00001                                        0582 01539000
         BAL   @14,APPLVER                                         0582 01540000
*           RFY                                                    0583 01541000
*             RTNCODE RSTD;                                        0583 01542000
*           IF RTNCODE^=ZERO THEN   /* IS THIS VER APPLICABLE?       */ 01543000
         LTR   RTNCODE,RTNCODE                                     0584 01544000
         BZ    @RF00584                                            0584 01545000
*             DO;                                                  0585 01546000
*               F2BSKIP=ON;         /* SKIP THIS ++VER               */ 01547000
         OI    F2BSKIP,B'00100000'                                 0586 01548000
*               IF RTNCODE>TSLNTFND THEN/* ERROR?                    */ 01549000
         CH    RTNCODE,@CH00038                                    0587 01550000
         BNH   @RF00587                                            0587 01551000
*                 DO;               /* YES,                          */ 01552000
*                   F2BRC=MAX(F2BRC,RTNCODE);/* SAVE THE RETURN CODE */ 01553000
         CR    F2BRC,RTNCODE                                       0589 01554000
         BNL   *+6                                                      01555000
         LR    F2BRC,RTNCODE                                       0589 01556000
*                 END;                                             0590 01557000
*               RFY                                                0591 01558000
*                 RTNCODE UNRSTD;                                  0591 01559000
@RF00587 DS    0H                                                  0592 01560000
*             END;                                                 0592 01561000
*           ELSE                                                   0593 01562000
*             DO;                                                  0593 01563000
         B     @RC00584                                            0593 01564000
@RF00584 DS    0H                                                  0594 01565000
*               CALL SELFND(SCLSMD);/* MARK SELECT LIST ENTRY SO THAT   01566000
*                                      SELECTED SYSMOD NOT PROCESSED    01567000
*                                      MESSAGE NOT ISSUED            */ 01568000
*                                                                  0594 01569000
         L     @08,@PC00001                                        0594 01570000
         L     @08,TBLXSCGT(,@08)                                  0594 01571000
         L     @08,GTPBUFAD(,@08)                                  0594 01572000
         LA    @08,SCLSMD(,@08)                                    0594 01573000
         ST    @08,@AL00001                                        0594 01574000
         LA    @01,@AL00001                                        0594 01575000
         BAL   @14,SELFND                                          0594 01576000
*               /*****************************************************/ 01577000
*               /*                                                   */ 01578000
*               /* CHECK FOR AMBIGUOUS VER                           */ 01579000
*               /*                                                   */ 01580000
*               /*****************************************************/ 01581000
*                                                                  0595 01582000
*               CALL AMBIGCK(SCLMAP);                              0595 01583000
         L     @08,@PC00001                                        0595 01584000
         L     @08,TBLXSCGT(,@08)                                  0595 01585000
         L     @08,GTPBUFAD(,@08)                                  0595 01586000
         ST    @08,@AL00001                                        0595 01587000
         LA    @01,@AL00001                                        0595 01588000
         BAL   @14,AMBIGCK                                         0595 01589000
*               RFY                                                0596 01590000
*                 RTNCODE RSTD;                                    0596 01591000
*               F2BGET=OFF;         /* DO NOT GET NEXT SCL RECORD  0597 01592000
*                                      SINCE AMBIGCK ALREADY GOT IT  */ 01593000
         NI    F2BGET,B'11101111'                                  0597 01594000
*               F2BRC=MAX(F2BRC,RTNCODE);/* SAVE RETURN CODE         */ 01595000
         CR    F2BRC,RTNCODE                                       0598 01596000
         BNL   *+6                                                      01597000
         LR    F2BRC,RTNCODE                                       0598 01598000
*               RFY                                                0599 01599000
*                 RTNCODE UNRSTD;                                  0599 01600000
*             END;                                                 0600 01601000
*         END;                                                     0601 01602000
@RC00584 DS    0H                                                  0602 01603000
*       RFY                                                        0602 01604000
*         SCLMAP BASED(ADDR(F2BSCL));                              0602 01605000
@RF00580 DS    0H                                                  0603 01606000
*       IF F2BRC<STOPSMD            /* SYSMOD IS GO?                 */ 01607000
*           &F2BSKIP=OFF THEN       /* ...                           */ 01608000
         CH    F2BRC,@CH00056                                      0603 01609000
         BNL   @RF00603                                            0603 01610000
         TM    F2BSKIP,B'00100000'                                 0603 01611000
         BNZ   @RF00603                                            0603 01612000
*         DO;                                                      0604 01613000
*                                                                  0604 01614000
*           /*********************************************************/ 01615000
*           /*                                                       */ 01616000
*           /* GET PTS EXTENDED ENTRY                                */ 01617000
*           /*                                                       */ 01618000
*           /*********************************************************/ 01619000
*                                                                  0605 01620000
*           CALL GETSMD(HMASMIOP,SCLSMD);                          0605 01621000
         L     @08,CCAIOPTR(,CCAPTR)                               0605 01622000
         ST    @08,@AL00001                                        0605 01623000
         LA    @08,F2BSCL                                          0605 01624000
         LA    @08,SCLSMD(,@08)                                    0605 01625000
         ST    @08,@AL00001+4                                      0605 01626000
         LA    @01,@AL00001                                        0605 01627000
         BAL   @14,GETSMD                                          0605 01628000
*           RFY                                                    0606 01629000
*             RTNCODE RSTD;                                        0606 01630000
*           F2BRC=MAX(F2BRC,RTNCODE);/* SAVE BUILD RETURN CODE       */ 01631000
         CR    F2BRC,RTNCODE                                       0607 01632000
         BNL   *+6                                                      01633000
         LR    F2BRC,RTNCODE                                       0607 01634000
*           RFY                                                    0608 01635000
*             RTNCODE UNRSTD;                                      0608 01636000
*           IF F2BRC<STOPSMD        /* STILL PROCESSING SYSMOD?      */ 01637000
*               &F2BSKIP=OFF THEN   /*                               */ 01638000
         CH    F2BRC,@CH00056                                      0609 01639000
         BNL   @RF00609                                            0609 01640000
         TM    F2BSKIP,B'00100000'                                 0609 01641000
         BNZ   @RF00609                                            0609 01642000
*             DO;                                                  0610 01643000
*                                                                  0610 01644000
*               /*****************************************************/ 01645000
*               /*                                                   */ 01646000
*               /* CHECK FOR SUP ERROR                               */ 01647000
*               /*                                                   */ 01648000
*               /*****************************************************/ 01649000
*                                                                  0611 01650000
*               CALL SUPCK(LEVEL2,SCLMAP,HMASMIOP,F2SUPN);         0611 01651000
         LA    @08,@CC01108                                        0611 01652000
         ST    @08,@AL00001                                        0611 01653000
         LA    @08,F2BSCL                                          0611 01654000
         ST    @08,@AL00001+4                                      0611 01655000
         L     @08,CCAIOPTR(,CCAPTR)                               0611 01656000
         ST    @08,@AL00001+8                                      0611 01657000
         LA    @08,F2SUPN                                          0611 01658000
         ST    @08,@AL00001+12                                     0611 01659000
         LA    @01,@AL00001                                        0611 01660000
         BAL   @14,SUPCK                                           0611 01661000
*               RFY                                                0612 01662000
*                 RTNCODE RSTD;                                    0612 01663000
*               F2BRC=MAX(F2BRC,RTNCODE);/* SAVE RETURN CODE         */ 01664000
         CR    F2BRC,RTNCODE                                       0613 01665000
         BNL   *+6                                                      01666000
         LR    F2BRC,RTNCODE                                       0613 01667000
*               IF RTNCODE=STOPSMD THEN/* SUPED BY ICT SYSMOD?       */ 01668000
         CH    RTNCODE,@CH00056                                    0614 01669000
         BNE   @RF00614                                            0614 01670000
*                 DO;               /* YES,                          */ 01671000
*                   F2BSKIP=ON;     /* THEN SKIP SYSMOD              */ 01672000
         OI    F2BSKIP,B'00100000'                                 0616 01673000
*                   RFY                                            0617 01674000
*                     RTNCODE UNRSTD;                              0617 01675000
*                 END;                                             0618 01676000
*             END;                                                 0619 01677000
@RF00614 DS    0H                                                  0620 01678000
*           IF F2BRC<STOPSMD        /* STILL PROCESSING SYSMOD?      */ 01679000
*               &F2BSKIP=OFF THEN   /*                               */ 01680000
@RF00609 CH    F2BRC,@CH00056                                      0620 01681000
         BNL   @RF00620                                            0620 01682000
         TM    F2BSKIP,B'00100000'                                 0620 01683000
         BNZ   @RF00620                                            0620 01684000
*             DO;                                                  0621 01685000
*                                                                  0621 01686000
*               /*****************************************************/ 01687000
*               /*                                                   */ 01688000
*               /* DO DELETE, NPRE CHECKING AND BUILD ICT PTR ENTRY  */ 01689000
*               /*                                                   */ 01690000
*               /*****************************************************/ 01691000
*                                                                  0622 01692000
*               CALL VERBLD(LEVEL2,HMASMIOP,SCLMAP,F2BENTP);/*       */ 01693000
         LA    @08,@CC01108                                        0622 01694000
         ST    @08,@AL00001                                        0622 01695000
         L     @08,CCAIOPTR(,CCAPTR)                               0622 01696000
         ST    @08,@AL00001+4                                      0622 01697000
         LA    @08,F2BSCL                                          0622 01698000
         ST    @08,@AL00001+8                                      0622 01699000
         LA    @08,F2BENTP                                         0622 01700000
         ST    @08,@AL00001+12                                     0622 01701000
         LA    @01,@AL00001                                        0622 01702000
         BAL   @14,VERBLD                                          0622 01703000
*               RFY                                                0623 01704000
*                 RTNCODE RSTD;                                    0623 01705000
*               F2BRC=MAX(F2BRC,RTNCODE);/* SAVE BUILD RETURN CODE   */ 01706000
         CR    F2BRC,RTNCODE                                       0624 01707000
         BNL   *+6                                                      01708000
         LR    F2BRC,RTNCODE                                       0624 01709000
*               IF RTNCODE=ZERO THEN/* ALL IS WELL?                  */ 01710000
         LTR   RTNCODE,RTNCODE                                     0625 01711000
         BNZ   @RF00625                                            0625 01712000
*                 DO;               /* YES,                          */ 01713000
*                   RFY                                            0627 01714000
*                     RTNCODE UNRSTD;                              0627 01715000
*                   F2BCMP=OFF;                                    0628 01716000
         NI    F2BCMP,B'01111111'                                  0628 01717000
*                   F2BENTP->ICTPSUPN(1)=F2SUPN;/* SUP COUNT         */ 01718000
         L     @08,F2BENTP                                         0629 01719000
         MVC   ICTPSUPN(2,@08),F2SUPN                              0629 01720000
*                 END;                                             0630 01721000
*             END;                                                 0631 01722000
*         END;                                                     0632 01723000
*       ELSE                                                       0633 01724000
*         ;                         /* SYSMOD FAILED OR ++VER IS   0633 01725000
*                                      SKIPPED                       */ 01726000
@RF00603 DS    0H                                                  0634 01727000
*       IF F2BRC=STOPSMD THEN       /* FUNCTION FAILED?              */ 01728000
@RC00603 CH    F2BRC,@CH00056                                      0634 01729000
         BNE   @RF00634                                            0634 01730000
*         DO;                       /* YES,                          */ 01731000
*           F2BRC=STOPFUNC;         /* STOP THE FUNCTION             */ 01732000
         LA    F2BRC,12                                            0636 01733000
*           CALL FUNCFM(SCLSMD);    /* ISSUE SMP FUNCTION FAIL     0637 01734000
*                                      MESSAGE                       */ 01735000
         LA    @08,F2BSCL                                          0637 01736000
         LA    @08,SCLSMD(,@08)                                    0637 01737000
         ST    @08,@AL00001                                        0637 01738000
         LA    @01,@AL00001                                        0637 01739000
         BAL   @14,FUNCFM                                          0637 01740000
*         END;                      /*                               */ 01741000
*       ELSE                                                       0639 01742000
*         ;                         /* NOT A STOP FUNCTION           */ 01743000
@RF00634 DS    0H                                                  0640 01744000
*     END;                          /* END OF PASS THRU L2 LIST      */ 01745000
@DE00548 TM    F2BL2END,B'01000000'                                0640 01746000
         BO    @DC00548                                            0640 01747000
         CH    F2BRC,@CH00033                                      0640 01748000
         BL    @DL00548                                            0640 01749000
@DC00548 DS    0H                                                  0641 01750000
*     IF F2BRC<STOPFUNC THEN        /* ALL IS WELL?                  */ 01751000
         CH    F2BRC,@CH00033                                      0641 01752000
         BNL   @RF00641                                            0641 01753000
*       DO;                                                        0642 01754000
*                                                                  0642 01755000
*         /***********************************************************/ 01756000
*         /*                                                         */ 01757000
*         /* ADD IF REQ INDEX LISTS TO ALL ICT PTF ENTRIES JUST      */ 01758000
*         /* CREATED                                                 */ 01759000
*         /*                                                         */ 01760000
*         /***********************************************************/ 01761000
*                                                                  0643 01762000
*         CALL ADDIFS;              /*                               */ 01763000
         BAL   @14,ADDIFS                                          0643 01764000
*         RFY                                                      0644 01765000
*           RTNCODE RSTD;                                          0644 01766000
*         F2BRC=MAX(F2BRC,RTNCODE);                                0645 01767000
         CR    F2BRC,RTNCODE                                       0645 01768000
         BNL   *+6                                                      01769000
         LR    F2BRC,RTNCODE                                       0645 01770000
*         RFY                                                      0646 01771000
*           RTNCODE UNRSTD;                                        0646 01772000
*                                                                  0646 01773000
*         /***********************************************************/ 01774000
*         /*                                                         */ 01775000
*         /* IF GROUP, ADD CANDIDATES AND CLEAR PASS FILAGS          */ 01776000
*         /*                                                         */ 01777000
*         /***********************************************************/ 01778000
*                                                                  0647 01779000
*         IF F2BRC<STOPFUNC THEN    /* ALL IS WELL?                  */ 01780000
         CH    F2BRC,@CH00033                                      0647 01781000
         BNL   @RF00647                                            0647 01782000
*           DO;                                                    0648 01783000
*             CALL GROUPADD;                                       0649 01784000
         BAL   @14,GROUPADD                                        0649 01785000
*           END;                                                   0650 01786000
*         IF F2BRC<STOPFUNC THEN    /* ALL IS WELL?                  */ 01787000
@RF00647 CH    F2BRC,@CH00033                                      0651 01788000
         BNL   @RF00651                                            0651 01789000
*           DO;                                                    0652 01790000
*             TSLFUNCT=TSLFCLRP;    /* CLEAR PASS FLAGS IN THE ICT   */ 01791000
         L     @08,@PC00001                                        0653 01792000
         L     @08,TBLXTSLP(,@08)                                  0653 01793000
         MVI   TSLFUNCT(@08),X'05'                                 0653 01794000
*             CALL HMASMTSB(TSLPARMS);                             0654 01795000
         ST    @08,@AL00001                                        0654 01796000
         L     @15,@CV01237                                        0654 01797000
         LA    @01,@AL00001                                        0654 01798000
         BALR  @14,@15                                             0654 01799000
*           END;                                                   0655 01800000
*       END;                                                       0656 01801000
@RF00651 DS    0H                                                  0657 01802000
*   END;                            /* END OF 1ST LEVEL FUNCTION   0657 01803000
*                                      BUILD LOOP                    */ 01804000
@RF00641 DS    0H                                                  0657 01805000
@DE00543 CH    F2BRC,@CH00033                                      0657 01806000
         BNL   @DC00543                                            0657 01807000
         TM    F2BCMP,B'10000000'                                  0657 01808000
         BZ    @DL00543                                            0657 01809000
@DC00543 DS    0H                                                  0658 01810000
*   RETURN CODE(F2BRC);             /* RETURN WITH THE RETURN CODE   */ 01811000
         LR    @15,F2BRC                                           0658 01812000
         L     @14,@SA00006                                        0658 01813000
         LM    @00,@12,@SA00006+8                                  0658 01814000
         BR    @14                                                 0658 01815000
*   RFY                                                            0659 01816000
*     HMASMIOP BASED;                                              0659 01817000
*   RFY                                                            0660 01818000
*     HMASMGTP BASED;                                              0660 01819000
*   RFY                                                            0661 01820000
*     SCLMAP BASED;                                                0661 01821000
*   RFY                                                            0662 01822000
*     TSLPARMS BASED;                                              0662 01823000
*   END F2BUILD;                    /*                               */ 01824000
*                                                                  0664 01825000
*   /*****************************************************************/ 01826000
*   /*                                                               */ 01827000
*   /* SRVBUILD - BUILD ICT ENTRIES FOR PTFS APARS AND USERMODS      */ 01828000
*   /*                                                               */ 01829000
*   /*****************************************************************/ 01830000
*                                                                  0664 01831000
*SRVBUILD:                                                         0664 01832000
*   PROC;                                                          0664 01833000
SRVBUILD STM   @14,@12,@SA00007                                    0664 01834000
*   DCL                                                            0665 01835000
*     1 SRVFLAGS BIT(8),            /*                               */ 01836000
*      2 SRVCMP BIT(1),             /* BUILD COMPLETE (I.E. NO NEW 0665 01837000
*                                      SERVICE ADDED TO THE TABLE IN    01838000
*                                      THE LAST PASS THRU L3,L4,L5)  */ 01839000
*      2 SRVEND BIT(1),             /* END OF SERVICE ENCOUNTERRED IN   01840000
*                                      SCL                           */ 01841000
*      2 SRVSKIP BIT(1),            /* SKIP THIS SYSMOD              */ 01842000
*      2 SRVGET BIT(1),             /* GET NEXT RECORD FROM SCL GTA     01843000
*                                      FILE                          */ 01844000
*      2 SRVREC BIT(1),             /* RECORD FOUND IN SCL GTA FILE     01845000
*                                      FOR A SERVICE SYSMOD          */ 01846000
*      2 * BIT(3);                  /* UNUSED                        */ 01847000
*   DCL                                                            0666 01848000
*     SRVRC FIXED(15);              /*                               */ 01849000
*   DCL                                                            0667 01850000
*     SRVCKEY@ PTR(31);             /* PTR TO SCL KEY FOR CURRENT  0667 01851000
*                                      ENTRY                         */ 01852000
*   DCL                                                            0668 01853000
*     SRVENTP PTR(31);              /* PTR TO ICT ENTRY CREATED THE     01854000
*                                      CURRENT SYSMOD BEING PROCESSED*/ 01855000
*   DCL                                                            0669 01856000
*     SRVSCL CHAR(LENGTH(SCLMAP));  /* SCL RECORD GOTTEN BY GETNLSMD */ 01857000
*   DCL                                                            0670 01858000
*     SRVLISTX FIXED(15);           /* INDEX OF CURRENT SERVICE LIST */ 01859000
*   RFY                                                            0671 01860000
*     HMASMIOP BASED(CCAIOPTR);     /* EXTENDED IOP                  */ 01861000
*   RFY                                                            0672 01862000
*     HMASMGTP BASED(TBLXSCGT);     /* GTP FOR SCL                   */ 01863000
*   RFY                                                            0673 01864000
*     SCLMAP BASED(GTPBUFAD);       /* SCL IS IN GTP BUFFER          */ 01865000
*   RFY                                                            0674 01866000
*     TSLPARMS BASED(TBLXTSLP);                                    0674 01867000
*   SRVRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 01868000
         SLR   SRVRC,SRVRC                                         0675 01869000
*   SRVFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 01870000
         MVI   SRVFLAGS,X'00'                                      0676 01871000
*   DO WHILE(SRVRC<STOPFUNC         /* PROCESS UNTIL NO MORE SERVICE    01872000
*                                      SYSMODS ADDED                 */ 01873000
*         &SRVCMP=OFF);             /*                               */ 01874000
         B     @DE00677                                            0677 01875000
@DL00677 DS    0H                                                  0678 01876000
*     SRVCMP=ON;                    /* ASSUME COMPLETION OF 1ST LEVEL   01877000
*                                      FUNC BUILD                    */ 01878000
         OI    SRVCMP,B'10000000'                                  0678 01879000
*     SRVCKEY@=ZERO;                /* CURRENT SCL LIST PTR          */ 01880000
         SLR   @08,@08                                             0679 01881000
         ST    @08,SRVCKEY@                                        0679 01882000
*     SRVGET=ON;                    /* GET NEXT SCL RECORD           */ 01883000
*     SRVEND=OFF;                   /* CLEAR END OF SERVICE LISTS  0681 01884000
*                                      FLAG                          */ 01885000
         OI    SRVGET,B'00010000'                                  0681 01886000
         NI    SRVEND,B'10111111'                                  0681 01887000
*     SRVLISTX=3;                   /*                               */ 01888000
         LA    SRVLISTX,3                                          0682 01889000
*     DO UNTIL(SRVEND=ON            /* PASS THRU L3, L4, AND L5 ONCE */ 01890000
*           |SRVRC=>STOPFUNC);      /*                               */ 01891000
@DL00683 DS    0H                                                  0684 01892000
*       SRVSKIP=OFF;                /* SKIP THE SYSMOD               */ 01893000
*       SRVREC=OFF;                 /*                               */ 01894000
         NI    SRVSKIP,B'11010111'                                 0685 01895000
*       DO WHILE(SRVREC=OFF&        /*                               */ 01896000
*             SRVEND=OFF);          /*                               */ 01897000
         B     @DE00686                                            0686 01898000
@DL00686 DS    0H                                                  0687 01899000
*         IF SRVGET=ON THEN         /* GET NEXT RECORD?              */ 01900000
         TM    SRVGET,B'00010000'                                  0687 01901000
         BNO   @RF00687                                            0687 01902000
*           DO;                                                    0688 01903000
*             CALL GETNLSMD(LISTNMS(SRVLISTX),/*                     */ 01904000
*                 SRVCKEY@,SRVSCL); /* GET NEXT RECORD FROM SCL FOR     01905000
*                                      SERVICE                       */ 01906000
         MVC   @AL00001+4(8),@AL00689                              0689 01907000
         LA    @08,LISTNMS-1(SRVLISTX)                             0689 01908000
         ST    @08,@AL00001                                        0689 01909000
         LA    @01,@AL00001                                        0689 01910000
         BAL   @14,GETNLSMD                                        0689 01911000
*             RFY                                                  0690 01912000
*               RTNCODE RSTD;       /*                               */ 01913000
*           END;                                                   0691 01914000
*         ELSE                      /* NO NEED TO GET NEXT SCL RECORD*/ 01915000
*           DO;                                                    0692 01916000
         B     @RC00687                                            0692 01917000
@RF00687 DS    0H                                                  0693 01918000
*             RTNCODE=GTPRETRN;     /* USE RETURN CODE FROM PREVIOUS    01919000
*                                      GETN                          */ 01920000
         L     @08,@PC00001                                        0693 01921000
         L     @08,TBLXSCGT(,@08)                                  0693 01922000
         SLR   RTNCODE,RTNCODE                                     0693 01923000
         IC    RTNCODE,GTPRETRN(,@08)                              0693 01924000
*             SRVSCL=SCLMAP;        /* USE PREVIOUSLY GOTTEN RECORD  */ 01925000
         L     @14,GTPBUFAD(,@08)                                  0694 01926000
         MVC   SRVSCL(17),SCLMAP(@14)                              0694 01927000
*           END;                                                   0695 01928000
*         IF RTNCODE=GTPEOF THEN    /* END OF FILE?                  */ 01929000
@RC00687 CH    RTNCODE,@CH00038                                    0696 01930000
         BNE   @RF00696                                            0696 01931000
*           DO;                     /* YES,                          */ 01932000
*             RFY                                                  0698 01933000
*               RTNCODE UNRSTD;                                    0698 01934000
*             SRVCKEY@=ZERO;        /* CURRENT SCL LIST PTR          */ 01935000
         SLR   @08,@08                                             0699 01936000
         ST    @08,SRVCKEY@                                        0699 01937000
*             SRVLISTX=SRVLISTX+1;  /* ADVANCE TO NEXT SERVICE LIST  */ 01938000
         AH    SRVLISTX,@CH00064                                   0700 01939000
*             IF SRVLISTX>DIM(LISTNMS) THEN/* THRU WILL SERVICE LISTS   01940000
*                                      ?                             */ 01941000
         CH    SRVLISTX,@CH00102                                   0701 01942000
         BNH   @RF00701                                            0701 01943000
*               DO;                 /*                               */ 01944000
*                 SRVEND=ON;        /* END OF SERVICE LISTS          */ 01945000
*                 SRVSKIP=ON;       /* SKIP PROCESSING FOR ++VER     */ 01946000
         OI    SRVEND,B'01100000'                                  0704 01947000
*               END;                                               0705 01948000
*             ELSE                                                 0706 01949000
*               ;                   /* NOT THE END OF THE LISTS      */ 01950000
@RF00701 DS    0H                                                  0707 01951000
*           END;                                                   0707 01952000
*         ELSE                      /* NOT THE END OF A LIST         */ 01953000
*           DO;                     /*                               */ 01954000
         B     @RC00696                                            0708 01955000
@RF00696 DS    0H                                                  0709 01956000
*             SRVREC=ON;            /* RECORD WAS GOTTEN             */ 01957000
         OI    SRVREC,B'00001000'                                  0709 01958000
*           END;                    /*                               */ 01959000
*       END;                                                       0711 01960000
@RC00696 DS    0H                                                  0711 01961000
@DE00686 TM    SRVREC,B'01001000'                                  0711 01962000
         BZ    @DL00686                                            0711 01963000
*       SRVGET=ON;                  /* GET NEXT SCL RECORD           */ 01964000
*                                                                  0712 01965000
         OI    SRVGET,B'00010000'                                  0712 01966000
*       /*************************************************************/ 01967000
*       /*                                                           */ 01968000
*       /* CHECK TO SEE IF THE SYSMOD IS ALREADY IN THE ICT. IF SO,  */ 01969000
*       /* SKIP PROCESSING IT.                                       */ 01970000
*       /*                                                           */ 01971000
*       /*************************************************************/ 01972000
*                                                                  0713 01973000
*       IF SCLCAND=ON               /* SYSMOD IS CANDIDATE           */ 01974000
*           &SRVEND=OFF             /* AND NOT END OF LIST           */ 01975000
*           &SRVRC<STOPFUNC THEN    /* ++VER IS STILL GO?            */ 01976000
         L     @08,@PC00001                                        0713 01977000
         L     @05,TBLXSCGT(,@08)                                  0713 01978000
         L     @05,GTPBUFAD(,@05)                                  0713 01979000
         TM    SCLCAND(@05),B'00100000'                            0713 01980000
         BNO   @RF00713                                            0713 01981000
         TM    SRVEND,B'01000000'                                  0713 01982000
         BNZ   @RF00713                                            0713 01983000
         CH    SRVRC,@CH00033                                      0713 01984000
         BNL   @RF00713                                            0713 01985000
*         DO;                       /* YES,                          */ 01986000
*           TSLICTSR=''B;           /* CLEAR PARMLIST                */ 01987000
         L     @08,TBLXTSLP(,@08)                                  0715 01988000
         L     @02,TSLPMLAD(,@08)                                  0715 01989000
         XC    TSLICTSR(14,@02),TSLICTSR(@02)                      0715 01990000
*           TSLFUNCT=TSLFISRH;      /* SEARCH TO SEE IF SYSMOD ...   */ 01991000
         MVI   TSLFUNCT(@08),X'01'                                 0716 01992000
*           TSLISMD=SCLSMD;         /* ... ALREADY IN THE ICT        */ 01993000
         MVC   TSLISMD(7,@02),SCLSMD(@05)                          0717 01994000
*           CALL HMASMTSB(TSLPARMS);                               0718 01995000
         ST    @08,@AL00001                                        0718 01996000
         L     @15,@CV01237                                        0718 01997000
         LA    @01,@AL00001                                        0718 01998000
         BALR  @14,@15                                             0718 01999000
*           IF TSLIOK=ON            /* FOUND OK                      */ 02000000
*               |TSLISUP=ON         /* ... OR SUP'ED?                */ 02001000
*             THEN                                                 0719 02002000
         L     @08,@PC00001                                        0719 02003000
         L     @08,TBLXTSLP(,@08)                                  0719 02004000
         L     @08,TSLPMLAD(,@08)                                  0719 02005000
         TM    TSLIOK(@08),B'01100000'                             0719 02006000
         BZ    @RF00719                                            0719 02007000
*             DO;                                                  0720 02008000
*               SRVGET=ON;          /* GET THE NEXT SCL RECORD       */ 02009000
*               SRVSKIP=ON;         /* SKIP THE SYSMOD               */ 02010000
         OI    SRVGET,B'00110000'                                  0722 02011000
*             END;                                                 0723 02012000
*         END;                                                     0724 02013000
*       ELSE                        /* NOT A CANDIDATE OR ERROR      */ 02014000
*         DO;                                                      0725 02015000
         B     @RC00713                                            0725 02016000
@RF00713 DS    0H                                                  0726 02017000
*           SRVSKIP=ON;             /* SKIP THE VER                  */ 02018000
         OI    SRVSKIP,B'00100000'                                 0726 02019000
*         END;                                                     0727 02020000
*       IF SRVRC<STOPFUNC           /* ALL IS WELL?                  */ 02021000
*           &SRVSKIP=OFF THEN       /* AND ^ SKIP ?                  */ 02022000
@RC00713 CH    SRVRC,@CH00033                                      0728 02023000
         BNL   @RF00728                                            0728 02024000
         TM    SRVSKIP,B'00100000'                                 0728 02025000
         BNZ   @RF00728                                            0728 02026000
*         DO;                       /* YES,                          */ 02027000
*                                                                  0729 02028000
*           /*********************************************************/ 02029000
*           /*                                                       */ 02030000
*           /* DETERMINE APPLICABILITY OF ++VER, I.E. THE SYSMOD IS  */ 02031000
*           /* FMID'ED SYMOD ON THE SYSTEM OR ICT                    */ 02032000
*           /*                                                       */ 02033000
*           /*********************************************************/ 02034000
*                                                                  0730 02035000
*           CALL APPLVER(SCLMAP);   /* DETERMINE APPLICABLILITY OF 0730 02036000
*                                      THIS ++VER                    */ 02037000
         L     @08,@PC00001                                        0730 02038000
         L     @08,TBLXSCGT(,@08)                                  0730 02039000
         L     @08,GTPBUFAD(,@08)                                  0730 02040000
         ST    @08,@AL00001                                        0730 02041000
         LA    @01,@AL00001                                        0730 02042000
         BAL   @14,APPLVER                                         0730 02043000
*           RFY                                                    0731 02044000
*             RTNCODE RSTD;                                        0731 02045000
*           IF RTNCODE^=ZERO THEN   /* IS THIS VER APPLICABLE?       */ 02046000
         LTR   RTNCODE,RTNCODE                                     0732 02047000
         BZ    @RF00732                                            0732 02048000
*             DO;                                                  0733 02049000
*               SRVGET=ON;          /* GET NEXT SCL RECORD           */ 02050000
*               SRVSKIP=ON;         /* SKIP THIS ++VER               */ 02051000
         OI    SRVGET,B'00110000'                                  0735 02052000
*               IF RTNCODE>TSLNTFND THEN/* ERROR?                    */ 02053000
         CH    RTNCODE,@CH00038                                    0736 02054000
         BNH   @RF00736                                            0736 02055000
*                 DO;               /* YES,                          */ 02056000
*                   SRVRC=MAX(SRVRC,RTNCODE);/* SAVE THE RETURN CODE */ 02057000
         CR    SRVRC,RTNCODE                                       0738 02058000
         BNL   *+6                                                      02059000
         LR    SRVRC,RTNCODE                                       0738 02060000
*                 END;                                             0739 02061000
*               RFY                                                0740 02062000
*                 RTNCODE UNRSTD;                                  0740 02063000
@RF00736 DS    0H                                                  0741 02064000
*             END;                                                 0741 02065000
*           ELSE                                                   0742 02066000
*             DO;                                                  0742 02067000
         B     @RC00732                                            0742 02068000
@RF00732 DS    0H                                                  0743 02069000
*               CALL SELFND(SCLSMD);/* MARK SELECT LIST ENTRY SO THAT   02070000
*                                      SELECTED SYSMOD NOT PROCESSED    02071000
*                                      MESSAGE NOT ISSUED            */ 02072000
*                                                                  0743 02073000
         L     @08,@PC00001                                        0743 02074000
         L     @08,TBLXSCGT(,@08)                                  0743 02075000
         L     @08,GTPBUFAD(,@08)                                  0743 02076000
         LA    @08,SCLSMD(,@08)                                    0743 02077000
         ST    @08,@AL00001                                        0743 02078000
         LA    @01,@AL00001                                        0743 02079000
         BAL   @14,SELFND                                          0743 02080000
*               /*****************************************************/ 02081000
*               /*                                                   */ 02082000
*               /* CHECK FOR AMBIGUOUS VER                           */ 02083000
*               /*                                                   */ 02084000
*               /*****************************************************/ 02085000
*                                                                  0744 02086000
*               CALL AMBIGCK(SCLMAP);/* NOT THAT THIS WILL GET ALL 0744 02087000
*                                      SCL RECORDS UPTO AND INCLUDING   02088000
*                                      THE 1ST RECORD FOR THE NEXT 0744 02089000
*                                      SYSMOD                        */ 02090000
         L     @08,@PC00001                                        0744 02091000
         L     @08,TBLXSCGT(,@08)                                  0744 02092000
         L     @08,GTPBUFAD(,@08)                                  0744 02093000
         ST    @08,@AL00001                                        0744 02094000
         LA    @01,@AL00001                                        0744 02095000
         BAL   @14,AMBIGCK                                         0744 02096000
*               RFY                                                0745 02097000
*                 RTNCODE RSTD;                                    0745 02098000
*               SRVGET=OFF;         /* CLEAR GET NEXT SCL RECORD FLAG*/ 02099000
         NI    SRVGET,B'11101111'                                  0746 02100000
*               SRVRC=MAX(SRVRC,RTNCODE);/* SAVE RETURN CODE         */ 02101000
         CR    SRVRC,RTNCODE                                       0747 02102000
         BNL   *+6                                                      02103000
         LR    SRVRC,RTNCODE                                       0747 02104000
*               RFY                                                0748 02105000
*                 RTNCODE UNRSTD;                                  0748 02106000
*             END;                                                 0749 02107000
*         END;                                                     0750 02108000
@RC00732 DS    0H                                                  0751 02109000
*       RFY                                                        0751 02110000
*         SCLMAP BASED(ADDR(SRVSCL));                              0751 02111000
@RF00728 DS    0H                                                  0752 02112000
*       IF SRVRC<STOPFUNC           /* SYSMOD IS GO?                 */ 02113000
*           &SRVSKIP=OFF THEN       /* ...                           */ 02114000
         CH    SRVRC,@CH00033                                      0752 02115000
         BNL   @RF00752                                            0752 02116000
         TM    SRVSKIP,B'00100000'                                 0752 02117000
         BNZ   @RF00752                                            0752 02118000
*         DO;                                                      0753 02119000
*                                                                  0753 02120000
*           /*********************************************************/ 02121000
*           /*                                                       */ 02122000
*           /* GET PTS EXTENDED ENTRY                                */ 02123000
*           /*                                                       */ 02124000
*           /*********************************************************/ 02125000
*                                                                  0754 02126000
*           CALL GETSMD(HMASMIOP,SCLSMD);                          0754 02127000
         L     @08,CCAIOPTR(,CCAPTR)                               0754 02128000
         ST    @08,@AL00001                                        0754 02129000
         LA    @08,SRVSCL                                          0754 02130000
         LA    @08,SCLSMD(,@08)                                    0754 02131000
         ST    @08,@AL00001+4                                      0754 02132000
         LA    @01,@AL00001                                        0754 02133000
         BAL   @14,GETSMD                                          0754 02134000
*           RFY                                                    0755 02135000
*             RTNCODE RSTD;                                        0755 02136000
*           SRVRC=MAX(SRVRC,RTNCODE);/* SAVE BUILD RETURN CODE       */ 02137000
         CR    SRVRC,RTNCODE                                       0756 02138000
         BNL   *+6                                                      02139000
         LR    SRVRC,RTNCODE                                       0756 02140000
*           RFY                                                    0757 02141000
*             RTNCODE UNRSTD;                                      0757 02142000
*           IF SRVRC<STOPFUNC       /* STILL PROCESSING SYSMOD?      */ 02143000
*               &SRVSKIP=OFF THEN   /*                               */ 02144000
         CH    SRVRC,@CH00033                                      0758 02145000
         BNL   @RF00758                                            0758 02146000
         TM    SRVSKIP,B'00100000'                                 0758 02147000
         BNZ   @RF00758                                            0758 02148000
*             DO;                                                  0759 02149000
*                                                                  0759 02150000
*               /*****************************************************/ 02151000
*               /*                                                   */ 02152000
*               /* CHECK FOR SUP ERROR                               */ 02153000
*               /*                                                   */ 02154000
*               /*****************************************************/ 02155000
*                                                                  0760 02156000
*               CALL SUPCK(SERVICE,SCLMAP,HMASMIOP,SRVSUPN);       0760 02157000
         LA    @08,@CC01268                                        0760 02158000
         ST    @08,@AL00001                                        0760 02159000
         LA    @08,SRVSCL                                          0760 02160000
         ST    @08,@AL00001+4                                      0760 02161000
         L     @08,CCAIOPTR(,CCAPTR)                               0760 02162000
         ST    @08,@AL00001+8                                      0760 02163000
         LA    @08,SRVSUPN                                         0760 02164000
         ST    @08,@AL00001+12                                     0760 02165000
         LA    @01,@AL00001                                        0760 02166000
         BAL   @14,SUPCK                                           0760 02167000
*               RFY                                                0761 02168000
*                 RTNCODE RSTD;                                    0761 02169000
*               SRVRC=MAX(SRVRC,RTNCODE);/* SAVE RETURN CODE         */ 02170000
         CR    SRVRC,RTNCODE                                       0762 02171000
         BNL   *+6                                                      02172000
         LR    SRVRC,RTNCODE                                       0762 02173000
*               IF RTNCODE=STOPSMD THEN/* SUPED BY ICT SYSMOD?       */ 02174000
         CH    RTNCODE,@CH00056                                    0763 02175000
         BNE   @RF00763                                            0763 02176000
*                 DO;               /* YES,                          */ 02177000
*                   SRVSKIP=ON;     /* THEN SKIP SYSMOD              */ 02178000
         OI    SRVSKIP,B'00100000'                                 0765 02179000
*                   RFY                                            0766 02180000
*                     RTNCODE UNRSTD;                              0766 02181000
*                 END;                                             0767 02182000
*             END;                                                 0768 02183000
@RF00763 DS    0H                                                  0769 02184000
*           IF SRVRC<STOPFUNC       /* STILL PROCESSING SYSMOD?      */ 02185000
*               &SRVSKIP=OFF THEN   /*                               */ 02186000
@RF00758 CH    SRVRC,@CH00033                                      0769 02187000
         BNL   @RF00769                                            0769 02188000
         TM    SRVSKIP,B'00100000'                                 0769 02189000
         BNZ   @RF00769                                            0769 02190000
*             DO;                                                  0770 02191000
*                                                                  0770 02192000
*               /*****************************************************/ 02193000
*               /*                                                   */ 02194000
*               /* BUILD ICT PTR ENTRY                               */ 02195000
*               /*                                                   */ 02196000
*               /*****************************************************/ 02197000
*                                                                  0771 02198000
*               CALL SMDICT(HMASMIOP,SCLMAP,SRVENTP);/*              */ 02199000
         L     @08,CCAIOPTR(,CCAPTR)                               0771 02200000
         ST    @08,@AL00001                                        0771 02201000
         LA    @08,SRVSCL                                          0771 02202000
         ST    @08,@AL00001+4                                      0771 02203000
         LA    @08,SRVENTP                                         0771 02204000
         ST    @08,@AL00001+8                                      0771 02205000
         LA    @01,@AL00001                                        0771 02206000
         BAL   @14,SMDICT                                          0771 02207000
*               RFY                                                0772 02208000
*                 RTNCODE RSTD;                                    0772 02209000
*               SRVRC=MAX(SRVRC,RTNCODE);/* SAVE BUILD RETURN CODE   */ 02210000
         CR    SRVRC,RTNCODE                                       0773 02211000
         BNL   *+6                                                      02212000
         LR    SRVRC,RTNCODE                                       0773 02213000
*               IF RTNCODE=ZERO THEN/* ALL IS WELL?                  */ 02214000
         LTR   RTNCODE,RTNCODE                                     0774 02215000
         BNZ   @RF00774                                            0774 02216000
*                 DO;               /* YES,                          */ 02217000
*                   RFY                                            0776 02218000
*                     RTNCODE UNRSTD;                              0776 02219000
*                   SRVCMP=OFF;                                    0777 02220000
         NI    SRVCMP,B'01111111'                                  0777 02221000
*                   SRVENTP->ICTPSUPN(1)=SRVSUPN;/* SUP COUNT        */ 02222000
         L     @08,SRVENTP                                         0778 02223000
         MVC   ICTPSUPN(2,@08),SRVSUPN                             0778 02224000
*                 END;                                             0779 02225000
*             END;                                                 0780 02226000
*         END;                                                     0781 02227000
*       ELSE                                                       0782 02228000
*         ;                         /* SYSMOD FAILED OR ++VER IS   0782 02229000
*                                      SKIPPED                       */ 02230000
@RF00752 DS    0H                                                  0783 02231000
*     END;                          /* END OF PASS THRU L2 LIST      */ 02232000
@RC00752 DS    0H                                                  0783 02233000
@DE00683 TM    SRVEND,B'01000000'                                  0783 02234000
         BO    @DC00683                                            0783 02235000
         CH    SRVRC,@CH00033                                      0783 02236000
         BL    @DL00683                                            0783 02237000
@DC00683 DS    0H                                                  0784 02238000
*     IF SRVRC<STOPFUNC THEN        /* ALL IS WELL?                  */ 02239000
         CH    SRVRC,@CH00033                                      0784 02240000
         BNL   @RF00784                                            0784 02241000
*       DO;                                                        0785 02242000
*                                                                  0785 02243000
*         /***********************************************************/ 02244000
*         /*                                                         */ 02245000
*         /* ADD IF REQ INDEX LISTS TO ALL ICT PTF ENTRIES JUST      */ 02246000
*         /* CREATED                                                 */ 02247000
*         /*                                                         */ 02248000
*         /***********************************************************/ 02249000
*                                                                  0786 02250000
*         CALL ADDIFS;              /*                               */ 02251000
         BAL   @14,ADDIFS                                          0786 02252000
*         RFY                                                      0787 02253000
*           RTNCODE RSTD;                                          0787 02254000
*         SRVRC=MAX(SRVRC,RTNCODE);                                0788 02255000
         CR    SRVRC,RTNCODE                                       0788 02256000
         BNL   *+6                                                      02257000
         LR    SRVRC,RTNCODE                                       0788 02258000
*         RFY                                                      0789 02259000
*           RTNCODE UNRSTD;                                        0789 02260000
*                                                                  0789 02261000
*         /***********************************************************/ 02262000
*         /*                                                         */ 02263000
*         /* IF GROUP, ADD CANDIDATES AND CLEAR PASS FILAGS          */ 02264000
*         /*                                                         */ 02265000
*         /***********************************************************/ 02266000
*                                                                  0790 02267000
*         IF SRVRC<STOPFUNC THEN    /* ALL IS WELL?                  */ 02268000
         CH    SRVRC,@CH00033                                      0790 02269000
         BNL   @RF00790                                            0790 02270000
*           DO;                                                    0791 02271000
*             CALL GROUPADD;                                       0792 02272000
         BAL   @14,GROUPADD                                        0792 02273000
*           END;                                                   0793 02274000
*         IF SRVRC<STOPFUNC THEN    /* ALL IS WELL?                  */ 02275000
@RF00790 CH    SRVRC,@CH00033                                      0794 02276000
         BNL   @RF00794                                            0794 02277000
*           DO;                                                    0795 02278000
*             TSLFUNCT=TSLFCLRP;    /* CLEAR PASS FLAGS IN THE ICT   */ 02279000
         L     @08,@PC00001                                        0796 02280000
         L     @08,TBLXTSLP(,@08)                                  0796 02281000
         MVI   TSLFUNCT(@08),X'05'                                 0796 02282000
*             CALL HMASMTSB(TSLPARMS);                             0797 02283000
         ST    @08,@AL00001                                        0797 02284000
         L     @15,@CV01237                                        0797 02285000
         LA    @01,@AL00001                                        0797 02286000
         BALR  @14,@15                                             0797 02287000
*           END;                                                   0798 02288000
*       END;                                                       0799 02289000
@RF00794 DS    0H                                                  0800 02290000
*   END;                            /* END OF 1ST LEVEL FUNCTION   0800 02291000
*                                      BUILD LOOP                    */ 02292000
@RF00784 DS    0H                                                  0800 02293000
@DE00677 CH    SRVRC,@CH00033                                      0800 02294000
         BNL   @DC00677                                            0800 02295000
         TM    SRVCMP,B'10000000'                                  0800 02296000
         BZ    @DL00677                                            0800 02297000
@DC00677 DS    0H                                                  0801 02298000
*   RETURN CODE(SRVRC);             /* RETURN WITH THE RETURN CODE   */ 02299000
         LR    @15,SRVRC                                           0801 02300000
         L     @14,@SA00007                                        0801 02301000
         LM    @00,@12,@SA00007+8                                  0801 02302000
         BR    @14                                                 0801 02303000
*   RFY                                                            0802 02304000
*     HMASMIOP BASED;                                              0802 02305000
*   RFY                                                            0803 02306000
*     HMASMGTP BASED;                                              0803 02307000
*   RFY                                                            0804 02308000
*     SCLMAP BASED;                                                0804 02309000
*   RFY                                                            0805 02310000
*     TSLPARMS BASED;                                              0805 02311000
*   END SRVBUILD;                   /*                               */ 02312000
*                                                                  0807 02313000
*/********************************************************************/ 02314000
*/*                                                                  */ 02315000
*/* SELFND                                                           */ 02316000
*/*                                                                  */ 02317000
*/* INPUT  - SYSMOD TO BE LOCATED IN THE SELECT/GROUP GTA FILE       */ 02318000
*/*                                                                  */ 02319000
*/* OUTPUT - "SYSMOD FOUND" FLAG IN THE SELECT/GROUP GTA RECORD      */ 02320000
*/*          FOR THE INPUT SYSMOD IF FOUND                           */ 02321000
*/*        - RETURN CODE:                                            */ 02322000
*/*           0 - FOUND IN THE GTA FILE                              */ 02323000
*/*           4 - NOT FOUND IN THE GTA FILE                          */ 02324000
*/*                                                                  */ 02325000
*/********************************************************************/ 02326000
*                                                                  0807 02327000
*SELFND:                                                           0807 02328000
*   PROC(SELFNAME);                 /* SYSMOD TO FIND                */ 02329000
SELFND   STM   @14,@12,@SA00008                                    0807 02330000
         MVC   @PC00008(4),0(@01)                                  0807 02331000
*   DCL                                                            0808 02332000
*     SELFNAME CHAR(LENGTH(IOPNAM17));/* SYSMOD NAME TO SEARCH FOR   */ 02333000
*   DCL                                                            0809 02334000
*     SELFNDRC FIXED(15);           /* RETURN CODE                   */ 02335000
*   RFY                                                            0810 02336000
*     HMASMGTP BASED(TBLXSEGT);                                    0810 02337000
*   RFY                                                            0811 02338000
*     HMASMSET BASED(GTPBUFAD);                                    0811 02339000
*   SELFNDRC=ZERO;                  /* CLEAR RETURN CODE             */ 02340000
         SLR   SELFNDRC,SELFNDRC                                   0812 02341000
*   IF TBLSEL=ON                    /* SELECT ...                    */ 02342000
*       |TBLGROUP=ON THEN           /* ... OR GROUP?                 */ 02343000
         L     @08,@PC00001                                        0813 02344000
         L     @03,TBLXTBL(,@08)                                   0813 02345000
         TM    TBLSEL(@03),B'10100000'                             0813 02346000
         BZ    @RF00813                                            0813 02347000
*     DO;                           /* YES,                          */ 02348000
*                                                                  0814 02349000
*       /*************************************************************/ 02350000
*       /*                                                           */ 02351000
*       /* INTIALIZE FOR SEARCH OF SELECT/GROUP LIST                 */ 02352000
*       /*                                                           */ 02353000
*       /*************************************************************/ 02354000
*                                                                  0815 02355000
*       HMASMSET=''B;               /* CLEAR BUFFER                  */ 02356000
         L     @08,TBLXSEGT(,@08)                                  0815 02357000
         L     @03,GTPBUFAD(,@08)                                  0815 02358000
         XC    HMASMSET(12,@03),HMASMSET(@03)                      0815 02359000
*       SESMD=ON;                   /* SELECT LIST TYPE IS SYSMOD    */ 02360000
         OI    SESMD(@03),B'00000001'                              0816 02361000
*       SENAME=' ';                 /* BLANK SELECT NAME             */ 02362000
         MVI   SENAME+1(@03),C' '                                  0817 02363000
         MVC   SENAME+2(6,@03),SENAME+1(@03)                       0817 02364000
         MVI   SENAME(@03),C' '                                    0817 02365000
*       GTPFUNCT=GTPLOC;            /* GTP FUNCTION IS LOCATE        */ 02366000
         MVI   GTPFUNCT(@08),X'03'                                 0818 02367000
*       SESMDNO=SELFNAME;           /* SEARCH FOR GIVEN SYSMOD       */ 02368000
         L     @15,@PC00008                                        0819 02369000
         MVC   SESMDNO(7,@03),SELFNAME(@15)                        0819 02370000
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */ 02371000
         ST    @08,@AL00001                                        0820 02372000
         L     @15,@CV01231                                        0820 02373000
         LA    @01,@AL00001                                        0820 02374000
         BALR  @14,@15                                             0820 02375000
*       IF GTPRETRN^=GTPGOOD THEN   /* NOT FOUND?                    */ 02376000
         L     @08,@PC00001                                        0821 02377000
         L     @08,TBLXSEGT(,@08)                                  0821 02378000
         CLI   GTPRETRN(@08),0                                     0821 02379000
         BE    @RF00821                                            0821 02380000
*         DO;                       /* YES,                          */ 02381000
*           SELFNDRC=GTPNTFND;      /* NOT FOUND RETURN CODED        */ 02382000
         LA    SELFNDRC,4                                          0823 02383000
*         END;                                                     0824 02384000
*       ELSE                        /* FOUND                         */ 02385000
*         DO;                                                      0825 02386000
         B     @RC00821                                            0825 02387000
@RF00821 DS    0H                                                  0826 02388000
*           SEFLAG2A=ON;            /* MARK SELECT ENTRY AS FOUND ON    02389000
*                                      CDS                           */ 02390000
         L     @08,@PC00001                                        0826 02391000
         L     @08,TBLXSEGT(,@08)                                  0826 02392000
         L     @03,GTPBUFAD(,@08)                                  0826 02393000
         OI    SEFLAG2A(@03),B'10000000'                           0826 02394000
*           GTPFUNCT=GTPADD;        /* ADD ENTRY BACK WITH FLAG SET  */ 02395000
         MVI   GTPFUNCT(@08),X'04'                                 0827 02396000
*           CALL HMASMGTA(HMASMGTP);/* ...                           */ 02397000
*                                                                  0828 02398000
         ST    @08,@AL00001                                        0828 02399000
         L     @15,@CV01231                                        0828 02400000
         LA    @01,@AL00001                                        0828 02401000
         BALR  @14,@15                                             0828 02402000
*           /*********************************************************/ 02403000
*           /*                                                       */ 02404000
*           /* RETURN CODE ????????                                  */ 02405000
*           /*                                                       */ 02406000
*           /*********************************************************/ 02407000
*                                                                  0829 02408000
*         END;                                                     0829 02409000
*     END;                                                         0830 02410000
*   ELSE                                                           0831 02411000
*     ;                             /* NOT SELECT OR GROUP, SKIP ALL    02412000
*                                      PROCESSING                    */ 02413000
@RF00813 DS    0H                                                  0832 02414000
*   RETURN CODE(SELFNDRC);          /* RETURN W/ RC                  */ 02415000
@RC00813 LR    @15,SELFNDRC                                        0832 02416000
         L     @14,@SA00008                                        0832 02417000
         LM    @00,@12,@SA00008+8                                  0832 02418000
         BR    @14                                                 0832 02419000
*   RFY                                                            0833 02420000
*     HMASMGTP BASED;                                              0833 02421000
*   RFY                                                            0834 02422000
*     HMASMSET BASED;                                              0834 02423000
*   END SELFND;                                                    0835 02424000
*                                                                  0836 02425000
*/********************************************************************/ 02426000
*/*                                                                  */ 02427000
*/* SELCHK                                                           */ 02428000
*/*                                                                  */ 02429000
*/* INPUT - 1) SELECT/GROUP GTA FILE                                 */ 02430000
*/*         2) PTF SECTION OF THE ICT                                */ 02431000
*/*                                                                  */ 02432000
*/* OUTPUT - 1) ERROR MESSAGE FOR EACH SYSMOD IN THE SELECT LIST AND */ 02433000
*/*             NOT IN THE ICT FOR WHICH AN ERROR MESSAGE HAS NOT    */ 02434000
*/*             ALREADY BEEN ISSUED                                  */ 02435000
*/*          2) THE SELECT LIST AND THE RESTORE CANDIDATE FLAGS      */ 02436000
*/*             WILL BE SET FOR EACH SYSMOD IN BOTH THE GTA FILE     */ 02437000
*/*             AND THE ICT.                                         */ 02438000
*/*                                                                  */ 02439000
*/********************************************************************/ 02440000
*                                                                  0836 02441000
*SELCHK:                                                           0836 02442000
*   PROC;                                                          0836 02443000
SELCHK   STM   @14,@12,@SA00009                                    0836 02444000
*   DCL                                                            0837 02445000
*     SELCHKRC FIXED(15);           /* RETURN CODE                   */ 02446000
*   DCL                                                            0838 02447000
*     1 SELCFLGS,                   /* LOCAL CONTROL FLAGS           */ 02448000
*      2 SELCEOF BIT(1),            /* END OF FILE ON SELEGCT/GROUP     02449000
*                                      GTA FILE                      */ 02450000
*      2 * BIT(7);                  /* UNUSED                        */ 02451000
*   RFY                                                            0839 02452000
*     HMASMGTP BASED(TBLXSEGT);                                    0839 02453000
*   RFY                                                            0840 02454000
*     HMASMSET BASED(GTPBUFAD);                                    0840 02455000
*   RFY                                                            0841 02456000
*     TSLPARMS BASED(TBLXTSLP);                                    0841 02457000
*   SELCHKRC=ZERO;                  /* CLEAR RETURN CODE             */ 02458000
         SLR   SELCHKRC,SELCHKRC                                   0842 02459000
*   SELCFLGS=''B;                   /* CLEAR LOCAL FLAGS             */ 02460000
         MVI   SELCFLGS,X'00'                                      0843 02461000
*   IF TBLSEL=ON                    /* SELECT ...                    */ 02462000
*       |TBLGROUP=ON THEN           /* ... OR GROUP?                 */ 02463000
         L     @08,@PC00001                                        0844 02464000
         L     @03,TBLXTBL(,@08)                                   0844 02465000
         TM    TBLSEL(@03),B'10100000'                             0844 02466000
         BZ    @RF00844                                            0844 02467000
*     DO;                           /* YES,                          */ 02468000
*       GTPFUNCT=GTPOPENN;          /* POSITION TO THE BEGINNING OF     02469000
*                                      THE SELECT/GROUP GTA FILE     */ 02470000
         L     @08,TBLXSEGT(,@08)                                  0846 02471000
         MVI   GTPFUNCT(@08),X'01'                                 0846 02472000
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */ 02473000
         ST    @08,@AL00001                                        0847 02474000
         L     @15,@CV01231                                        0847 02475000
         LA    @01,@AL00001                                        0847 02476000
         BALR  @14,@15                                             0847 02477000
*       SELCEOF=OFF;                /* CLEAR END OF FILE             */ 02478000
         NI    SELCEOF,B'01111111'                                 0848 02479000
*       GTPFUNCT=GTPGETN;           /* FUNCTION IS GET NEXT          */ 02480000
         L     @08,@PC00001                                        0849 02481000
         L     @08,TBLXSEGT(,@08)                                  0849 02482000
         MVI   GTPFUNCT(@08),X'08'                                 0849 02483000
*       DO WHILE(SELCEOF=OFF        /*                               */ 02484000
*             &SELCHKRC<STOPFUNC);  /*                               */ 02485000
         B     @DE00850                                            0850 02486000
@DL00850 DS    0H                                                  0851 02487000
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT LIST ENTRY           */ 02488000
         L     @08,@PC00001                                        0851 02489000
         L     @08,TBLXSEGT(,@08)                                  0851 02490000
         ST    @08,@AL00001                                        0851 02491000
         L     @15,@CV01231                                        0851 02492000
         LA    @01,@AL00001                                        0851 02493000
         BALR  @14,@15                                             0851 02494000
*         IF GTPRETRN=GTPEOF THEN   /* END OF FILE?                  */ 02495000
         L     @08,@PC00001                                        0852 02496000
         L     @08,TBLXSEGT(,@08)                                  0852 02497000
         CLI   GTPRETRN(@08),4                                     0852 02498000
         BNE   @RF00852                                            0852 02499000
*           DO;                     /* YES,                          */ 02500000
*             SELCEOF=ON;           /* END OF FILE                   */ 02501000
         OI    SELCEOF,B'10000000'                                 0854 02502000
*           END;                                                   0855 02503000
*         ELSE                      /* NOT END OF FILE               */ 02504000
*           DO;                                                    0856 02505000
*                                                                  0856 02506000
         B     @RC00852                                            0856 02507000
@RF00852 DS    0H                                                  0857 02508000
*             /*******************************************************/ 02509000
*             /*                                                     */ 02510000
*             /* SEARCH FOR THE SELECTED SYSMOD IN THE ICT           */ 02511000
*             /*                                                     */ 02512000
*             /*******************************************************/ 02513000
*                                                                  0857 02514000
*             TSLICTSR=''B;         /* CLEAR THE PARMLIST            */ 02515000
         L     @08,@PC00001                                        0857 02516000
         L     @03,TBLXTSLP(,@08)                                  0857 02517000
         L     @15,TSLPMLAD(,@03)                                  0857 02518000
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      0857 02519000
*             TSLFUNCT=TSLFISRH;    /* SEARCH THE ICT                */ 02520000
         MVI   TSLFUNCT(@03),X'01'                                 0858 02521000
*             TSLISMD=SESMDNO;      /* SEARCH FOR SELECT/GROUP LIST     02522000
*                                      SYSMOD                        */ 02523000
         L     @08,TBLXSEGT(,@08)                                  0859 02524000
         L     @08,GTPBUFAD(,@08)                                  0859 02525000
         MVC   TSLISMD(7,@15),SESMDNO(@08)                         0859 02526000
*             CALL HMASMTSB(TSLPARMS);/* ...                         */ 02527000
         ST    @03,@AL00001                                        0860 02528000
         L     @15,@CV01237                                        0860 02529000
         LA    @01,@AL00001                                        0860 02530000
         BALR  @14,@15                                             0860 02531000
*             IF TSLIFND=ON THEN    /* FOUND IN THE ICT?             */ 02532000
         L     @08,@PC00001                                        0861 02533000
         L     @08,TBLXTSLP(,@08)                                  0861 02534000
         L     @08,TSLPMLAD(,@08)                                  0861 02535000
         TM    TSLIFND(@08),B'10000000'                            0861 02536000
         BNO   @RF00861                                            0861 02537000
*               DO;                 /* YES,                          */ 02538000
*               END;                                               0863 02539000
*             ELSE                  /* NOT FOUND IN ICT THEN THERE IS   02540000
*                                      AN ERROR                      */ 02541000
*               DO;                                                0864 02542000
         B     @RC00861                                            0864 02543000
@RF00861 DS    0H                                                  0865 02544000
*                 IF SEFLAG2A=OFF THEN/* ERROR MESSAGE NOT ISSUED?   */ 02545000
         L     @08,@PC00001                                        0865 02546000
         L     @03,TBLXSEGT(,@08)                                  0865 02547000
         L     @03,GTPBUFAD(,@03)                                  0865 02548000
         TM    SEFLAG2A(@03),B'10000000'                           0865 02549000
         BNZ   @RF00865                                            0865 02550000
*                   DO;             /* YES,                          */ 02551000
*                     SELCHKRC=STOPSMD;                            0867 02552000
*                                                                  0867 02553000
         LA    SELCHKRC,8                                          0867 02554000
*                     /***********************************************/ 02555000
*                     /*                                             */ 02556000
*                     /* ISSUE MESSAGE 'HMA379I SYSMOD XXXXXXX       */ 02557000
*                     /* SELECTED SELECTED FOR XXXXXXXX ... HAS NO   */ 02558000
*                     /* APPLICABLE VER                              */ 02559000
*                     /*                                             */ 02560000
*                     /***********************************************/ 02561000
*                                                                  0868 02562000
*                     DO;           /* HMASMPMG M1(HMA379I)M2(PART119   02563000
*                                      )TYPE(ERR)VAR(SESMDNO,TBLXFUNC   02564000
*                                      ,CCADSIDA(IOPCDS))TARGET(SYSOU   02565000
*                                      T,LOG)                        */ 02566000
*                       HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO     02567000
*                                      ZEROS                         */ 02568000
         XC    HMASMMGP(28),HMASMMGP                               0869 02569000
*                       MGPMGNO1=HMA379I;/* SET UP MSG 1 CODE        */ 02570000
         MVC   MGPMGNO1(2),@CH01249                                0870 02571000
*                       MGPMGNO2=PART119;/* SET UP MSG 2 CODE        */ 02572000
         MVC   MGPMGNO2(2),@CH01258                                0871 02573000
*                       MGPTYPE=MGPERR;/* SET MESSAGE TYPE           */ 02574000
         MVI   MGPTYPE,X'03'                                       0872 02575000
*                       MGPPRINT='1'B;/* SET TARGET FLAG             */ 02576000
*                       MGPHLDS='1'B;/* SET TARGET FLAG              */ 02577000
         OI    MGPPRINT,B'10010000'                                0874 02578000
*                       MGPVARPT(1)=ADDR(SESMDNO);/* SET VARIABLE PTR*/ 02579000
         LA    @03,SESMDNO(,@03)                                   0875 02580000
         ST    @03,MGPVARPT                                        0875 02581000
*                       MGPVARPT(2)=ADDR(TBLXFUNC);/* SET VARIABLE 0876 02582000
*                                      PTR                           */ 02583000
         LA    @08,TBLXFUNC(,@08)                                  0876 02584000
         ST    @08,MGPVARPT+4                                      0876 02585000
*                       MGPVARPT(3)=ADDR(CCADSIDA(IOPCDS));/* SET  0877 02586000
*                                      VARIABLE PTR                  */ 02587000
         L     @08,CCADSAD(,CCAPTR)                                0877 02588000
         LA    @08,CCADSIDA+8(,@08)                                0877 02589000
         ST    @08,MGPVARPT+8                                      0877 02590000
*                       CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE    0878 02591000
*                                      ISSUED                        */ 02592000
         L     @15,@CV01230                                        0878 02593000
         LA    @01,@AL00878                                        0878 02594000
         BALR  @14,@15                                             0878 02595000
*                     END;          /*                               */ 02596000
*                   END;                                           0880 02597000
*                 ELSE                                             0881 02598000
*                   ;               /* ERROR MESSAGE ALREADY ISSUED  */ 02599000
@RF00865 DS    0H                                                  0882 02600000
*               END;                                               0882 02601000
*           END;                                                   0883 02602000
@RC00861 DS    0H                                                  0884 02603000
*       END;                        /* END OF SELECT LIST PROCESSING */ 02604000
@RC00852 DS    0H                                                  0884 02605000
@DE00850 TM    SELCEOF,B'10000000'                                 0884 02606000
         BNZ   @DC00850                                            0884 02607000
         CH    SELCHKRC,@CH00033                                   0884 02608000
         BL    @DL00850                                            0884 02609000
@DC00850 DS    0H                                                  0885 02610000
*     END;                                                         0885 02611000
*   ELSE                                                           0886 02612000
*     ;                             /* NOT SELECT OR GROUP, SKIP ALL    02613000
*                                      PROCESSING                    */ 02614000
@RF00844 DS    0H                                                  0887 02615000
*   RETURN CODE(SELCHKRC);          /* RETURN W/ RC                  */ 02616000
         LR    @15,SELCHKRC                                        0887 02617000
         L     @14,@SA00009                                        0887 02618000
         LM    @00,@12,@SA00009+8                                  0887 02619000
         BR    @14                                                 0887 02620000
*   RFY                                                            0888 02621000
*     HMASMGTP BASED;                                              0888 02622000
*   RFY                                                            0889 02623000
*     HMASMSET BASED;                                              0889 02624000
*   RFY                                                            0890 02625000
*     TSLPARMS BASED;                                              0890 02626000
*   END SELCHK;                                                    0891 02627000
*                                                                  0892 02628000
*/********************************************************************/ 02629000
*/*                                                                  */ 02630000
*/* SUPSMD                                                           */ 02631000
*/*                                                                  */ 02632000
*/* INPUT - 1) PTF SECTION OF THE ICT                                */ 02633000
*/*                                                                  */ 02634000
*/* OUTPUT - 1) ICT SYSMOD ENTRIES FOR ANY SUPERSEDED SYSMODS THAT   */ 02635000
*/*             ARE ON THE CDS AND PTS.  THESE ENTRIES WILL BE USED  */ 02636000
*/*             TO DRIVE ACCEPT REJECT PROCESSING                    */ 02637000
*/*                                                                  */ 02638000
*/********************************************************************/ 02639000
*                                                                  0892 02640000
*SUPSMD:                                                           0892 02641000
*   PROC;                                                          0892 02642000
SUPSMD   STM   @14,@12,@SA00010                                    0892 02643000
*   DCL                                                            0893 02644000
*     SUPSRC FIXED(15);             /* RETURN CODE                   */ 02645000
*   DCL                                                            0894 02646000
*     1 SUPSFLGS,                   /* LOCAL CONTROL FLAGS           */ 02647000
*      2 * BIT(8);                  /* UNUSED                        */ 02648000
*   DCL                                                            0895 02649000
*     SUPSX1 FIXED(31);             /* LOOP INDEX FOR ICT SYSMOD LOOP*/ 02650000
*   DCL                                                            0896 02651000
*     SUPSX2 FIXED(31);             /* LOOP INDEX FOR SYSMOD SUP   0896 02652000
*                                      INDEX LIST                    */ 02653000
*   DCL                                                            0897 02654000
*     SUPSICTP PTR(31);             /* ICT SYSMOD PTR FOR SUP'ED   0897 02655000
*                                      ENTRY                         */ 02656000
*   RFY                                                            0898 02657000
*     HMASMIOP BASED(CCAIOPTR);                                    0898 02658000
*   RFY                                                            0899 02659000
*     ICTPTF BASED(CCAICPTF);                                      0899 02660000
*   RFY                                                            0900 02661000
*     TSLPARMS BASED(TBLXTSLP);                                    0900 02662000
*   RFY                                                            0901 02663000
*     ICTSUPLS BASED(ICTPSCHN(SUPSX1));                            0901 02664000
*   SUPSRC=ZERO;                    /* CLEAR RETURN CODE             */ 02665000
         SLR   SUPSRC,SUPSRC                                       0902 02666000
*   SUPSFLGS=''B;                   /* CLEAR LOCAL FLAGS             */ 02667000
         MVI   SUPSFLGS,X'00'                                      0903 02668000
*   DO SUPSX1=1 BY 1                /* CHECK ALL ICT SYSMOD ENTRIES  */ 02669000
*         WHILE(ICTPEND(SUPSX1)^=ICTENDNT/*                          */ 02670000
*         &SUPSRC<STOPFUNC);        /*                               */ 02671000
         LA    SUPSX1,1                                            0904 02672000
         B     @DE00904                                            0904 02673000
@DL00904 DS    0H                                                  0905 02674000
*     IF ICTPNOGO(SUPSX1)=OFF       /* NOT NOGO,                     */ 02675000
*         &ICTPSUPN(SUPSX1)=ZERO    /* AND NOT SUPED                 */ 02676000
*         &ICTPDEXP(SUPSX1)=OFF     /* AND NOT DELETED               */ 02677000
*         &ICTPDIMP(SUPSX1)=OFF     /* ...                           */ 02678000
*       THEN                        /*                               */ 02679000
         LR    @08,SUPSX1                                          0905 02680000
         MH    @08,@CH01757                                        0905 02681000
         L     @05,CCAICPTF(,CCAPTR)                               0905 02682000
         ST    @08,@TF00001                                        0905 02683000
         ALR   @08,@05                                             0905 02684000
         AL    @08,@CF01785                                        0905 02685000
         TM    ICTPNOGO-8(@08),B'01000000'                         0905 02686000
         BNZ   @RF00905                                            0905 02687000
         LR    @08,@05                                             0905 02688000
         AL    @08,@TF00001                                        0905 02689000
         AL    @08,@CF01786                                        0905 02690000
         SLR   @02,@02                                             0905 02691000
         ICM   @02,3,ICTPSUPN-20(@08)                              0905 02692000
         LTR   @02,@02                                             0905 02693000
         BNZ   @RF00905                                            0905 02694000
         AL    @05,@TF00001                                        0905 02695000
         AL    @05,@CF01787                                        0905 02696000
         TM    ICTPDEXP-13(@05),B'00110000'                        0905 02697000
         BNZ   @RF00905                                            0905 02698000
*       DO SUPSX2=1 BY 1            /*                               */ 02699000
*             WHILE(ICTSUPND(SUPSX2)^=ICTENDIX/*                     */ 02700000
*             &SUPSRC<STOPFUNC);    /*                               */ 02701000
         LA    SUPSX2,1                                            0906 02702000
         B     @DE00906                                            0906 02703000
@DL00906 DS    0H                                                  0907 02704000
*         TSLICTSR=''B;             /* CLEAR THE PARMLIST            */ 02705000
         L     @08,@PC00001                                        0907 02706000
         L     @08,TBLXTSLP(,@08)                                  0907 02707000
         L     @02,TSLPMLAD(,@08)                                  0907 02708000
         XC    TSLICTSR(14,@02),TSLICTSR(@02)                      0907 02709000
*         TSLFUNCT=TSLFISRH;        /* SEARCH THE ICT                */ 02710000
         MVI   TSLFUNCT(@08),X'01'                                 0908 02711000
*         TSLISMD=ICTSUPNM(SUPSX2); /* SEARCH FOR SUP'ED SYSMOD      */ 02712000
         LR    @15,SUPSX2                                          0909 02713000
         SLA   @15,3                                               0909 02714000
         LR    @14,SUPSX1                                          0909 02715000
         MH    @14,@CH01757                                        0909 02716000
         L     @01,CCAICPTF(,CCAPTR)                               0909 02717000
         AL    @01,@CF01788                                        0909 02718000
         L     @01,ICTPSCHN-72(@14,@01)                            0909 02719000
         ALR   @01,@15                                             0909 02720000
         AL    @01,@CF01789                                        0909 02721000
         MVC   TSLISMD(7,@02),ICTSUPNM(@01)                        0909 02722000
*         CALL HMASMTSB(TSLPARMS);  /* ...                           */ 02723000
         ST    @08,@AL00001                                        0910 02724000
         L     @15,@CV01237                                        0910 02725000
         LA    @01,@AL00001                                        0910 02726000
         BALR  @14,@15                                             0910 02727000
*         IF TSLIFND^=ON THEN       /* NOT FOUND IN ICT?             */ 02728000
         L     @08,@PC00001                                        0911 02729000
         L     @08,TBLXTSLP(,@08)                                  0911 02730000
         L     @08,TSLPMLAD(,@08)                                  0911 02731000
         TM    TSLIFND(@08),B'10000000'                            0911 02732000
         BO    @RF00911                                            0911 02733000
*           DO;                     /* YES,                          */ 02734000
*                                                                  0912 02735000
*             /*******************************************************/ 02736000
*             /*                                                     */ 02737000
*             /* LOCATE ON THE PTS AND CDS, IF FOUND BUILD SYSMOD    */ 02738000
*             /* ENTRY                                               */ 02739000
*             /*                                                     */ 02740000
*             /*******************************************************/ 02741000
*                                                                  0913 02742000
*             IOPDSID=IOPPTS;       /* ... IN PTS                    */ 02743000
         L     @08,CCAIOPTR(,CCAPTR)                               0913 02744000
         MVI   IOPDSID(@08),X'06'                                  0913 02745000
*             IOPFUNCT=IOPBLDL;     /* ... BLDL                      */ 02746000
         MVI   IOPFUNCT(@08),X'04'                                 0914 02747000
*             IOPTYPE=IOPSMD;       /* ....SYMOD ENTRY               */ 02748000
         MVI   IOPTYPE(@08),X'0B'                                  0915 02749000
*             IOPNAME=ICTSUPNM(SUPSX2);/* ... FOR SUPED SYSMOD       */ 02750000
         MVI   IOPNAME+7(@08),C' '                                 0916 02751000
         LR    @02,SUPSX2                                          0916 02752000
         SLA   @02,3                                               0916 02753000
         LR    @15,SUPSX1                                          0916 02754000
         MH    @15,@CH01757                                        0916 02755000
         L     @01,CCAICPTF(,CCAPTR)                               0916 02756000
         AL    @01,@CF01788                                        0916 02757000
         L     @01,ICTPSCHN-72(@15,@01)                            0916 02758000
         ALR   @01,@02                                             0916 02759000
         AL    @01,@CF01789                                        0916 02760000
         MVC   IOPNAME(7,@08),ICTSUPNM(@01)                        0916 02761000
*             CALL HMASMIO(HMASMIOP);/* ...                          */ 02762000
         ST    @08,@AL00001                                        0917 02763000
         L     @15,@CV01229                                        0917 02764000
         LA    @01,@AL00001                                        0917 02765000
         BALR  @14,@15                                             0917 02766000
*             IF IOPRETRN^=ZERO THEN/* NON-ZERO RETURN?              */ 02767000
         L     @08,CCAIOPTR(,CCAPTR)                               0918 02768000
         CLI   IOPRETRN(@08),0                                     0918 02769000
         BE    @RF00918                                            0918 02770000
*               DO;                 /* YES,                          */ 02771000
*                 IF IOPRETRN>STOPSMD THEN/* IO ERROR?               */ 02772000
         CLI   IOPRETRN(@08),8                                     0920 02773000
         BNH   @RF00920                                            0920 02774000
*                   DO;             /*                               */ 02775000
*                     SUPSRC=MAX(SUPSRC,IOPRETRN);/* SAVE RC         */ 02776000
         SLR   @02,@02                                             0922 02777000
         IC    @02,IOPRETRN(,@08)                                  0922 02778000
         CR    SUPSRC,@02                                          0922 02779000
         BNL   *+6                                                      02780000
         LR    SUPSRC,@02                                          0922 02781000
*                   END;            /*                               */ 02782000
*               END;                                               0924 02783000
*             ELSE                  /* FOUND ON THE PTS              */ 02784000
*               DO;                 /*                               */ 02785000
         B     @RC00918                                            0925 02786000
@RF00918 DS    0H                                                  0926 02787000
*                 RFY                                              0926 02788000
*                   HMASMIOP BASED(TBLXIOP2);/* USE ANOTHER IOP FOR     02789000
*                                      CDS BLDL                      */ 02790000
*                 IOPDSID=IOPCDS;   /* CDS                           */ 02791000
         L     @08,@PC00001                                        0927 02792000
         L     @08,TBLXIOP2(,@08)                                  0927 02793000
         MVI   IOPDSID(@08),X'02'                                  0927 02794000
*                 IOPFUNCT=IOPBLDL; /* ... BLDL                      */ 02795000
         MVI   IOPFUNCT(@08),X'04'                                 0928 02796000
*                 IOPTYPE=IOPSMD;   /* ... SYMOD ENTRY               */ 02797000
         MVI   IOPTYPE(@08),X'0B'                                  0929 02798000
*                 IOPNAME=ICTSUPNM(SUPSX2);/* ... FOR SUPED SYSMOD   */ 02799000
         MVI   IOPNAME+7(@08),C' '                                 0930 02800000
         LR    @02,SUPSX2                                          0930 02801000
         SLA   @02,3                                               0930 02802000
         LR    @15,SUPSX1                                          0930 02803000
         MH    @15,@CH01757                                        0930 02804000
         L     @01,CCAICPTF(,CCAPTR)                               0930 02805000
         AL    @01,@CF01788                                        0930 02806000
         L     @01,ICTPSCHN-72(@15,@01)                            0930 02807000
         ALR   @01,@02                                             0930 02808000
         AL    @01,@CF01789                                        0930 02809000
         MVC   IOPNAME(7,@08),ICTSUPNM(@01)                        0930 02810000
*                 CALL HMASMIO(HMASMIOP);/* ...                      */ 02811000
         ST    @08,@AL00001                                        0931 02812000
         L     @15,@CV01229                                        0931 02813000
         LA    @01,@AL00001                                        0931 02814000
         BALR  @14,@15                                             0931 02815000
*                 IF IOPRETRN^=ZERO THEN/* NON-ZERO RETURN?          */ 02816000
         L     @08,@PC00001                                        0932 02817000
         L     @08,TBLXIOP2(,@08)                                  0932 02818000
         CLI   IOPRETRN(@08),0                                     0932 02819000
         BE    @RF00932                                            0932 02820000
*                   DO;             /* YES,                          */ 02821000
*                     IF IOPRETRN>STOPSMD THEN/* IO ERROR?           */ 02822000
         CLI   IOPRETRN(@08),8                                     0934 02823000
         BNH   @RF00934                                            0934 02824000
*                       DO;         /*                               */ 02825000
*                         SUPSRC=MAX(SUPSRC,IOPRETRN);/* SAVE RC     */ 02826000
         SLR   @02,@02                                             0936 02827000
         IC    @02,IOPRETRN(,@08)                                  0936 02828000
         CR    SUPSRC,@02                                          0936 02829000
         BNL   *+6                                                      02830000
         LR    SUPSRC,@02                                          0936 02831000
*                       END;        /*                               */ 02832000
*                   END;                                           0938 02833000
*                 ELSE              /* FOUND ON THE CDS              */ 02834000
*                   DO;             /*                               */ 02835000
         B     @RC00932                                            0939 02836000
@RF00932 DS    0H                                                  0940 02837000
*                     IF IOPSBYP=ON THEN/* CDS ENTRY IS SUPERSEDED?  */ 02838000
         L     @08,@PC00001                                        0940 02839000
         L     @08,TBLXIOP2(,@08)                                  0940 02840000
         TM    IOPSBYP(@08),B'10000000'                            0940 02841000
         BNO   @RF00940                                            0940 02842000
*                       DO;         /* YES,                          */ 02843000
*                         RFY                                      0942 02844000
*                           HMASMIOP BASED(CCAIOPTR);              0942 02845000
*                         IOPFUNCT=IOPXTND;/* EXTEND THE CDS IOP     */ 02846000
         L     @08,CCAIOPTR(,CCAPTR)                               0943 02847000
         MVI   IOPFUNCT(@08),X'07'                                 0943 02848000
*                         CALL HMASMIO(HMASMIOP);/* ...              */ 02849000
         ST    @08,@AL00001                                        0944 02850000
         L     @15,@CV01229                                        0944 02851000
         LA    @01,@AL00001                                        0944 02852000
         BALR  @14,@15                                             0944 02853000
*                         IF IOPRETRN^=ZERO THEN/* IO ERROR?         */ 02854000
         L     @08,CCAIOPTR(,CCAPTR)                               0945 02855000
         CLI   IOPRETRN(@08),0                                     0945 02856000
         BE    @RF00945                                            0945 02857000
*                           DO;     /*                               */ 02858000
*                             IF IOPRETRN>STOPSMD THEN/* IO ERROR?   */ 02859000
         CLI   IOPRETRN(@08),8                                     0947 02860000
         BNH   @RF00947                                            0947 02861000
*                               DO; /*                               */ 02862000
*                                 SUPSRC=MAX(SUPSRC,IOPRETRN);/* SAVE   02863000
*                                      RC                            */ 02864000
         SLR   @02,@02                                             0949 02865000
         IC    @02,IOPRETRN(,@08)                                  0949 02866000
         CR    SUPSRC,@02                                          0949 02867000
         BNL   *+6                                                      02868000
         LR    SUPSRC,@02                                          0949 02869000
*                               END;/*                               */ 02870000
*                           END;                                   0951 02871000
*                         ELSE      /* IO SUCCESSFUL                 */ 02872000
*                           DO;     /*                               */ 02873000
         B     @RC00945                                            0952 02874000
@RF00945 DS    0H                                                  0953 02875000
*                             SUPSICTP=TBLXTOP;/* SAVE ICT ENTRY PTR */ 02876000
         L     @08,@PC00001                                        0953 02877000
         MVC   SUPSICTP(4),TBLXTOP(@08)                            0953 02878000
*                             CALL HMASMTAD(/* GET AND INIT ICT    0954 02879000
*                                      SYSMOD ENTRY                  */ 02880000
*                                 TBLXPARM,/* TBLX                   */ 02881000
*                                 'S',/* ICT SYSMOD TO INIT          */ 02882000
*                                 IOPNAME);/* ENTRY NAME             */ 02883000
         ST    @08,@AL00001                                        0954 02884000
         LA    @08,@CC01268                                        0954 02885000
         ST    @08,@AL00001+4                                      0954 02886000
         L     @08,CCAIOPTR(,CCAPTR)                               0954 02887000
         LA    @08,IOPNAME(,@08)                                   0954 02888000
         ST    @08,@AL00001+8                                      0954 02889000
         L     @15,@CV01232                                        0954 02890000
         LA    @01,@AL00001                                        0954 02891000
         BALR  @14,@15                                             0954 02892000
*                             RFY                                  0955 02893000
*                               RTNCODE RSTD;                      0955 02894000
*                             SUPSRC=MAX(SUPSRC,RTNCODE);/*          */ 02895000
         CR    SUPSRC,RTNCODE                                      0956 02896000
         BNL   *+6                                                      02897000
         LR    SUPSRC,RTNCODE                                      0956 02898000
*                             RFY                                  0957 02899000
*                               RTNCODE UNRSTD;                    0957 02900000
*                             IF SUPSRC<STOPSMD THEN/* NO ERROR?     */ 02901000
         CH    SUPSRC,@CH00056                                     0958 02902000
         BNL   @RF00958                                            0958 02903000
*                               DO; /* YES,                          */ 02904000
*                                 CALL HMASMTEC(TBLXPARM,/* TBLX     */ 02905000
*                                     SUPSICTP,/* ICT SYSMOD ENTRY 0960 02906000
*                                      PTR                           */ 02907000
*                                     HMASMIOP,/* EXTENDED IOP       */ 02908000
*                                     ZERO);/* NO ++VER NUMBER TO BE    02909000
*                                      USED                          */ 02910000
         L     @08,@PC00001                                        0960 02911000
         ST    @08,@AL00001                                        0960 02912000
         LA    @08,SUPSICTP                                        0960 02913000
         ST    @08,@AL00001+4                                      0960 02914000
         L     @08,CCAIOPTR(,CCAPTR)                               0960 02915000
         ST    @08,@AL00001+8                                      0960 02916000
         LA    @08,@CF00082                                        0960 02917000
         ST    @08,@AL00001+12                                     0960 02918000
         L     @15,@CV01233                                        0960 02919000
         LA    @01,@AL00001                                        0960 02920000
         BALR  @14,@15                                             0960 02921000
*                                 RFY                              0961 02922000
*                                   RTNCODE RSTD;                  0961 02923000
*                                 SUPSRC=MAX(SUPSRC,RTNCODE);/*      */ 02924000
         CR    SUPSRC,RTNCODE                                      0962 02925000
         BNL   *+6                                                      02926000
         LR    SUPSRC,RTNCODE                                      0962 02927000
*                                 RFY                              0963 02928000
*                                   RTNCODE UNRSTD;                0963 02929000
*                                 SUPSICTP->ICTPSUPN(1)=1;/* SET SUP    02930000
*                                      COUNTER                       */ 02931000
         L     @08,SUPSICTP                                        0964 02932000
         MVC   ICTPSUPN(2,@08),@CH00064                            0964 02933000
*                               END;                               0965 02934000
*                             ELSE                                 0966 02935000
*                               ;   /* ERROR GETTING ICT ENTRY       */ 02936000
@RF00958 DS    0H                                                  0967 02937000
*                           END;                                   0967 02938000
*                       END;                                       0968 02939000
*                   END;            /*                               */ 02940000
*               END;                                               0970 02941000
*           END;                                                   0971 02942000
*         ELSE                                                     0972 02943000
*           ;                       /* FOUND IN THE ICT, CONTINUE  0972 02944000
*                                      SEARCH                        */ 02945000
@RF00911 DS    0H                                                  0973 02946000
*       END;                        /* END OF ONE SYSMOD SUP LIST  0973 02947000
*                                      SEARCH                        */ 02948000
@RC00911 AH    SUPSX2,@CH00064                                     0973 02949000
@DE00906 LR    @08,SUPSX2                                          0973 02950000
         SLA   @08,3                                               0973 02951000
         LR    @02,SUPSX1                                          0973 02952000
         MH    @02,@CH01757                                        0973 02953000
         L     @01,CCAICPTF(,CCAPTR)                               0973 02954000
         AL    @01,@CF01788                                        0973 02955000
         L     @02,ICTPSCHN-72(@02,@01)                            0973 02956000
         AL    @02,@CF01789                                        0973 02957000
         L     @08,ICTSUPND(@08,@02)                               0973 02958000
         CL    @08,ICTENDIX                                        0973 02959000
         BE    @DC00906                                            0973 02960000
         CH    SUPSRC,@CH00033                                     0973 02961000
         BL    @DL00906                                            0973 02962000
@DC00906 DS    0H                                                  0974 02963000
*   END;                            /* END SYSMOD PROCESS LOOP       */ 02964000
@RF00905 AH    SUPSX1,@CH00064                                     0974 02965000
@DE00904 LR    @08,SUPSX1                                          0974 02966000
         MH    @08,@CH01757                                        0974 02967000
         L     @05,CCAICPTF(,CCAPTR)                               0974 02968000
         AL    @05,@CF01790                                        0974 02969000
         L     @08,ICTPEND(@08,@05)                                0974 02970000
         CL    @08,ICTENDNT                                        0974 02971000
         BE    @DC00904                                            0974 02972000
         CH    SUPSRC,@CH00033                                     0974 02973000
         BL    @DL00904                                            0974 02974000
@DC00904 DS    0H                                                  0975 02975000
*   RETURN CODE(SUPSRC);            /* RETURN W/ RC                  */ 02976000
         LR    @15,SUPSRC                                          0975 02977000
         L     @14,@SA00010                                        0975 02978000
         LM    @00,@12,@SA00010+8                                  0975 02979000
         BR    @14                                                 0975 02980000
*   END SUPSMD;                                                    0976 02981000
*   RFY                                                            0977 02982000
*     HMASMIOP BASED;                                              0977 02983000
*   RFY                                                            0978 02984000
*     ICTPTF BASED;                                                0978 02985000
*   RFY                                                            0979 02986000
*     TSLPARMS BASED;                                              0979 02987000
*   RFY                                                            0980 02988000
*     ICTSUPLS BASED;                                              0980 02989000
*                                                                  0981 02990000
*   /*****************************************************************/ 02991000
*   /*                                                               */ 02992000
*   /* TERMTPA - CLEAN UP PROCESSING                                 */ 02993000
*   /*                                                               */ 02994000
*   /*****************************************************************/ 02995000
*                                                                  0981 02996000
*TERMTPA:                                                          0981 02997000
*   PROC;                                                          0981 02998000
TERMTPA  STM   @14,@12,12(@13)                                     0981 02999000
*   TERMRC=ZERO;                    /* CLEAR THE RETURN CODE         */ 03000000
         SLR   TERMRC,TERMRC                                       0982 03001000
*   DCL                                                            0983 03002000
*     TERMRC FIXED(15);             /*                               */ 03003000
*   RETURN CODE(TERMRC);            /* RETURN WITH THE RETURN CODE   */ 03004000
         LR    @15,TERMRC                                          0984 03005000
         L     @14,12(,@13)                                        0984 03006000
         LM    @00,@12,20(@13)                                     0984 03007000
         BR    @14                                                 0984 03008000
*   END TERMTPA;                    /*                               */ 03009000
*                                                                  0986 03010000
*   /*****************************************************************/ 03011000
*   /*                                                               */ 03012000
*   /* GETNLSMD - GET NEXT/FIRST RECORD FROM SCL LIST                */ 03013000
*   /*                                                               */ 03014000
*   /*****************************************************************/ 03015000
*                                                                  0986 03016000
*GETNLSMD:                                                         0986 03017000
*   PROC(                           /*                               */ 03018000
*       GNLLIST#,                   /* (CHAR 1) LIST NUMBER FOR NEXT    03019000
*                                      RECORD                        */ 03020000
*       GNLPREV@,                   /* (INPUT/OUTPUT) PTR TO PREVIOUS   03021000
*                                      KEY OBTAINED BY THIS ROUTINE     03022000
*                                      OR ZERO IF THIS ROUTINE IS TO    03023000
*                                      POSITION TO THE FIRST RECORD     03024000
*                                      FOR GIVEN LIST. THIS PTR WILL    03025000
*                                      BE RESET ON EXIT TO ADDR OF 0986 03026000
*                                      GNLSCL                        */ 03027000
*       GNLSCL);                    /* (OUTPUT) RECORD GOTTEN BY THIS   03028000
*                                      ROUTINE                       */ 03029000
GETNLSMD STM   @14,@12,@SA00012                                    0986 03030000
         MVC   @PC00012(12),0(@01)                                 0986 03031000
*   DCL                                                            0987 03032000
*     GNLLIST# CHAR(1);             /* INPUT LIST NAME               */ 03033000
*   DCL                                                            0988 03034000
*     GNLPREV@ PTR(31);             /* PTR TO PREV KEY OR ZERO       */ 03035000
*   DCL                                                            0989 03036000
*     GNLSCL CHAR(LENGTH(SCLMAP));  /* RETURN RECORD                 */ 03037000
*   DCL                                                            0990 03038000
*     1 GNLFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */ 03039000
*      2 GNLPOSIT BIT(1),           /* POSITION IN THE GTA FILE    0990 03040000
*                                      REQUIRED                      */ 03041000
*      2 GNLSKIP1 BIT(1),           /* SKIP OF 1 RECORD REQUIRED TO     03042000
*                                      POSITION                      */ 03043000
*      2 * BIT(6);                  /* UNUSED                        */ 03044000
*   DCL                                                            0991 03045000
*     GNLRC FIXED(15);              /*                               */ 03046000
*   RFY                                                            0992 03047000
*     HMASMGTP BASED(TBLXSCGT);                                    0992 03048000
*   RFY                                                            0993 03049000
*     SCLMAP BASED(GTPBUFAD);                                      0993 03050000
*   GNLRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 03051000
         SLR   GNLRC,GNLRC                                         0994 03052000
*   GNLFLAGS=''B;                   /* CLEAR ALL CONTROL FLAGS       */ 03053000
         MVI   GNLFLAGS,X'00'                                      0995 03054000
*   IF GNLPREV@=ZERO THEN           /* POSITION WITHIN THE SCL?      */ 03055000
         L     @08,@PC00012+4                                      0996 03056000
         ICM   @03,15,GNLPREV@(@08)                                0996 03057000
         BNZ   @RF00996                                            0996 03058000
*     DO;                           /* YES,                          */ 03059000
*       GNLPOSIT=ON;                /* INDICATE POSITIONING REQUIRED */ 03060000
         OI    GNLPOSIT,B'10000000'                                0998 03061000
*       SCLKEY=''B;                 /* CLEAR THE KEY                 */ 03062000
         L     @08,@PC00001                                        0999 03063000
         L     @08,TBLXSCGT(,@08)                                  0999 03064000
         L     @08,GTPBUFAD(,@08)                                  0999 03065000
         XC    SCLKEY(15,@08),SCLKEY(@08)                          0999 03066000
*       SCLISTNO=GNLLIST#;          /* SET THE LIST NAME             */ 03067000
         L     @03,@PC00012                                        1000 03068000
         MVC   SCLISTNO(1,@08),GNLLIST#(@03)                       1000 03069000
*     END;                          /*                               */ 03070000
*   ELSE                            /* POSITIONING NOT REQUESTED BY     03071000
*                                      CALLER                        */ 03072000
*     DO;                           /*                               */ 03073000
         B     @RC00996                                            1002 03074000
@RF00996 DS    0H                                                  1003 03075000
*       IF GNLPREV@->SCLKEY^=       /* PREVIOUS KEY SAME AS LAST GETN   03076000
*                                      KEY ?                         */ 03077000
*           KEYSCLGN THEN                                          1003 03078000
         L     @08,@PC00012+4                                      1003 03079000
         L     @08,GNLPREV@(,@08)                                  1003 03080000
         CLC   SCLKEY(15,@08),KEYSCLGN                             1003 03081000
         BE    @RF01003                                            1003 03082000
*         DO;                       /* NO,                           */ 03083000
*           SCLKEY=GNLPREV@->SCLKEY;/* KEY IS PREVIOUS KEY           */ 03084000
         L     @03,@PC00001                                        1005 03085000
         L     @03,TBLXSCGT(,@03)                                  1005 03086000
         L     @03,GTPBUFAD(,@03)                                  1005 03087000
         MVC   SCLKEY(15,@03),SCLKEY(@08)                          1005 03088000
*           GNLPOSIT=ON;            /* POSITIONING IS REQUIRED       */ 03089000
*           GNLSKIP1=ON;            /* SKIP THIS RECORD AFTER      1007 03090000
*                                      POSITIONING                   */ 03091000
         OI    GNLPOSIT,B'11000000'                                1007 03092000
*         END;                      /*                               */ 03093000
*       ELSE                                                       1009 03094000
*         ;                         /* ONLY A GET NEXT IS REQUIRED   */ 03095000
@RF01003 DS    0H                                                  1010 03096000
*     END;                          /*                               */ 03097000
*                                                                  1010 03098000
*   /*****************************************************************/ 03099000
*   /*                                                               */ 03100000
*   /* POSITION                                                      */ 03101000
*   /*                                                               */ 03102000
*   /*****************************************************************/ 03103000
*                                                                  1011 03104000
*   IF GNLPOSIT=ON THEN             /* IS POSITIONING REQUIRED?      */ 03105000
@RC00996 TM    GNLPOSIT,B'10000000'                                1011 03106000
         BNO   @RF01011                                            1011 03107000
*     DO;                           /* YES,                          */ 03108000
*       GTPFUNCT=GTPLOC;            /* LOCATE RECORD                 */ 03109000
         L     @08,@PC00001                                        1013 03110000
         L     @08,TBLXSCGT(,@08)                                  1013 03111000
         MVI   GTPFUNCT(@08),X'03'                                 1013 03112000
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */ 03113000
         ST    @08,@AL00001                                        1014 03114000
         L     @15,@CV01231                                        1014 03115000
         LA    @01,@AL00001                                        1014 03116000
         BALR  @14,@15                                             1014 03117000
*       GTPFUNCT=GTPSTRTN;          /* POSITION FOR GETN             */ 03118000
         L     @08,@PC00001                                        1015 03119000
         L     @08,TBLXSCGT(,@08)                                  1015 03120000
         MVI   GTPFUNCT(@08),X'06'                                 1015 03121000
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */ 03122000
         ST    @08,@AL00001                                        1016 03123000
         L     @15,@CV01231                                        1016 03124000
         LA    @01,@AL00001                                        1016 03125000
         BALR  @14,@15                                             1016 03126000
*       IF GNLSKIP1=ON THEN         /* POSITIONED TO PREVIOUS RECORD?*/ 03127000
         TM    GNLSKIP1,B'01000000'                                1017 03128000
         BNO   @RF01017                                            1017 03129000
*         DO;                       /* YES,                          */ 03130000
*           GTPFUNCT=GTPGETN;       /* GETN NEXT SCL RECORD          */ 03131000
         L     @08,@PC00001                                        1019 03132000
         L     @08,TBLXSCGT(,@08)                                  1019 03133000
         MVI   GTPFUNCT(@08),X'08'                                 1019 03134000
*           CALL HMASMGTA(HMASMGTP);/* ...                           */ 03135000
         ST    @08,@AL00001                                        1020 03136000
         L     @15,@CV01231                                        1020 03137000
         LA    @01,@AL00001                                        1020 03138000
         BALR  @14,@15                                             1020 03139000
*           GNLRC=MAX(GNLRC,GTPRETRN);                             1021 03140000
         L     @08,@PC00001                                        1021 03141000
         L     @08,TBLXSCGT(,@08)                                  1021 03142000
         SLR   @03,@03                                             1021 03143000
         IC    @03,GTPRETRN(,@08)                                  1021 03144000
         CR    GNLRC,@03                                           1021 03145000
         BNL   *+6                                                      03146000
         LR    GNLRC,@03                                           1021 03147000
*         END;                      /*                               */ 03148000
*       ELSE                                                       1023 03149000
*         ;                         /* NO RECORD SKIPPING            */ 03150000
@RF01017 DS    0H                                                  1024 03151000
*     END;                          /*                               */ 03152000
*   ELSE                                                           1025 03153000
*     ;                             /* NO POSITIONING IS REQUIRED    */ 03154000
*                                                                  1025 03155000
@RF01011 DS    0H                                                  1026 03156000
*   /*****************************************************************/ 03157000
*   /*                                                               */ 03158000
*   /* GET THE NEXT SCL RECORD                                       */ 03159000
*   /*                                                               */ 03160000
*   /*****************************************************************/ 03161000
*                                                                  1026 03162000
*   IF GNLRC=ZERO THEN              /* ALL IS WELL?                  */ 03163000
         LTR   GNLRC,GNLRC                                         1026 03164000
         BNZ   @RF01026                                            1026 03165000
*     DO;                           /* YES,                          */ 03166000
*       GTPFUNCT=GTPGETN;           /* GETN NEXT SCL RECORD          */ 03167000
         L     @08,@PC00001                                        1028 03168000
         L     @08,TBLXSCGT(,@08)                                  1028 03169000
         MVI   GTPFUNCT(@08),X'08'                                 1028 03170000
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */ 03171000
         ST    @08,@AL00001                                        1029 03172000
         L     @15,@CV01231                                        1029 03173000
         LA    @01,@AL00001                                        1029 03174000
         BALR  @14,@15                                             1029 03175000
*       GNLRC=MAX(GNLRC,GTPRETRN);  /* SET RETURN CODE               */ 03176000
         L     @08,@PC00001                                        1030 03177000
         L     @08,TBLXSCGT(,@08)                                  1030 03178000
         SLR   @03,@03                                             1030 03179000
         IC    @03,GTPRETRN(,@08)                                  1030 03180000
         CR    GNLRC,@03                                           1030 03181000
         BNL   *+6                                                      03182000
         LR    GNLRC,@03                                           1030 03183000
*       IF GTPRETRN=GTPGOOD THEN    /* END OF FILE                   */ 03184000
         CLI   GTPRETRN(@08),0                                     1031 03185000
         BNE   @RF01031                                            1031 03186000
*         DO;                       /* YES,                          */ 03187000
*           GNLSCL=SCLMAP;          /* SAVE RECORD                   */ 03188000
         L     @03,@PC00012+8                                      1033 03189000
         L     @08,GTPBUFAD(,@08)                                  1033 03190000
         MVC   GNLSCL(17,@03),SCLMAP(@08)                          1033 03191000
*           KEYSCLGN=SCLKEY;        /* SAVE KEY                      */ 03192000
         MVC   KEYSCLGN(15),SCLKEY(@08)                            1034 03193000
*           GNLPREV@=ADDR(GNLSCL);  /* RETURN PTR TO SAVED KEY       */ 03194000
         L     @15,@PC00012+4                                      1035 03195000
         ST    @03,GNLPREV@(,@15)                                  1035 03196000
*           IF SCLISTNO^=GNLLIST# THEN/* NEXT LIST IN SCL          1036 03197000
*                                      ENCOUNTERRED?                 */ 03198000
         L     @03,@PC00012                                        1036 03199000
         CLC   SCLISTNO(1,@08),GNLLIST#(@03)                       1036 03200000
         BE    @RF01036                                            1036 03201000
*             DO;                   /* YES,                          */ 03202000
*               GNLRC=MAX(GNLRC,GTPEOF);/* RETURN EOF RC             */ 03203000
         LA    @08,4                                               1038 03204000
         CR    GNLRC,@08                                           1038 03205000
         BNL   *+6                                                      03206000
         LR    GNLRC,@08                                           1038 03207000
*             END;                                                 1039 03208000
*           ELSE                                                   1040 03209000
*             ;                     /* SCL RECORD WITHIN SPECIFIED 1040 03210000
*                                      LIST                          */ 03211000
@RF01036 DS    0H                                                  1041 03212000
*         END;                      /*                               */ 03213000
*       ELSE                                                       1042 03214000
*         ;                         /* GTA ERROR                     */ 03215000
@RF01031 DS    0H                                                  1043 03216000
*     END;                          /*                               */ 03217000
*   ELSE                                                           1044 03218000
*     DO;                           /* PREVIOUS ERROR                */ 03219000
         B     @RC01026                                            1044 03220000
@RF01026 DS    0H                                                  1045 03221000
*       GNLRC=MAX(GNLRC,GTPRETRN);                                 1045 03222000
         L     @08,@PC00001                                        1045 03223000
         L     @08,TBLXSCGT(,@08)                                  1045 03224000
         SLR   @03,@03                                             1045 03225000
         IC    @03,GTPRETRN(,@08)                                  1045 03226000
         CR    GNLRC,@03                                           1045 03227000
         BNL   *+6                                                      03228000
         LR    GNLRC,@03                                           1045 03229000
*     END;                          /*                               */ 03230000
*   RETURN CODE(GNLRC);             /* RETURN WITH THE RETURN CODE   */ 03231000
@RC01026 LR    @15,GNLRC                                           1047 03232000
         L     @14,@SA00012                                        1047 03233000
         LM    @00,@12,@SA00012+8                                  1047 03234000
         BR    @14                                                 1047 03235000
*   RFY                                                            1048 03236000
*     HMASMGTP BASED;                                              1048 03237000
*   RFY                                                            1049 03238000
*     SCLMAP BASED;                                                1049 03239000
*   END GETNLSMD;                   /*                               */ 03240000
*                                                                  1051 03241000
*   /*****************************************************************/ 03242000
*   /*                                                               */ 03243000
*   /* NPRECK - CHECK FOR NPRE ERRORS                                */ 03244000
*   /*                                                               */ 03245000
*   /*****************************************************************/ 03246000
*                                                                  1051 03247000
*NPRECK:                                                           1051 03248000
*   PROC(NPCIOP,                    /* EXTENDED IOP FOR CURRENT    1051 03249000
*                                      SYSMOD'S SYSMOD ENTRY         */ 03250000
*       NPCVER#);                   /* ++VER NUMBER FOR WHICH      1051 03251000
*                                      CHECKING IS TO BE DONE        */ 03252000
NPRECK   STM   @14,@12,@SA00013                                    1051 03253000
         MVC   @PC00013(8),0(@01)                                  1051 03254000
*   DCL                                                            1052 03255000
*     NPCIOP CHAR(*);               /* EXTENDED IOP INPUT            */ 03256000
*   DCL                                                            1053 03257000
*     NPCVER# FIXED(8);             /* ++VER NUMBER                  */ 03258000
*   DCL                                                            1054 03259000
*     NPCLSOFF FIXED(31);           /* OFFSET OF NPRE LIST IN PTF ENT*/ 03260000
*   DCL                                                            1055 03261000
*     NPCRC FIXED(15);              /*                               */ 03262000
*   DCL                                                            1056 03263000
*     NPCICTP PTR(31);              /* PTR TO ICT PTF FOR NPREING  1056 03264000
*                                      SYSMOD                        */ 03265000
*   DCL                                                            1057 03266000
*     1 NPCFLAGS,                   /*                               */ 03267000
*      2 NPCFOUND BIT(1),           /* NPRE MATCH FOUND              */ 03268000
*      2 NPCEOLST BIT(1),           /* END OF SUB-ENTRIES FOUND IN 1057 03269000
*                                      NPRE SEARCH                   */ 03270000
*      2 * BIT(6);                  /*                               */ 03271000
*   DCL                                                            1058 03272000
*     NPCRTN@ PTR(31);              /* NPRE ENTRY PTR IN THE IOP     */ 03273000
*   RFY                                                            1059 03274000
*     HMASMIOP BASED(ADDR(NPCIOP));                                1059 03275000
*   RFY                                                            1060 03276000
*     TSLPARMS BASED(TBLXTSLP);                                    1060 03277000
*   NPCRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 03278000
         SLR   NPCRC,NPCRC                                         1061 03279000
*   NPCFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 03280000
*                                                                  1062 03281000
         MVI   NPCFLAGS,X'00'                                      1062 03282000
*   /*****************************************************************/ 03283000
*   /*                                                               */ 03284000
*   /* CHECK TO SEE IF NPRED BY SYSMOD IN ICT                        */ 03285000
*   /*                                                               */ 03286000
*   /*****************************************************************/ 03287000
*                                                                  1063 03288000
*   RFY                                                            1063 03289000
*     ICTPTF BASED(CCAICPTF);                                      1063 03290000
*   NPCLSOFF=ADDR(ICTPNCHN(1))      /* OFFSET OF NPRE CHAIN PTR      */ 03291000
*       -ADDR(ICTPTF(1));           /*                               */ 03292000
         L     @08,CCAICPTF(,CCAPTR)                               1064 03293000
         LA    NPCLSOFF,ICTPNCHN(,@08)                             1064 03294000
         SLR   NPCLSOFF,@08                                        1064 03295000
*   RFY                                                            1065 03296000
*     ICTPTF BASED;                                                1065 03297000
*   TSLLSTSR=''B;                   /* CLEAR PARMLIST                */ 03298000
         L     @08,@PC00001                                        1066 03299000
         L     @08,TBLXTSLP(,@08)                                  1066 03300000
         L     @05,TSLPMLAD(,@08)                                  1066 03301000
         XC    TSLLSTSR(16,@05),TSLLSTSR(@05)                      1066 03302000
*   TSLFUNCT=TSLFLSRH;              /* SEARCH NPRE LIST FOR SYSMOD   */ 03303000
         MVI   TSLFUNCT(@08),X'02'                                 1067 03304000
*   TSLLSMD=IOPNAM17;               /* SYSMOD NAME                   */ 03305000
         L     @15,@PC00013                                        1068 03306000
         MVC   TSLLSMD(7,@05),IOPNAM17(@15)                        1068 03307000
*   TSLLOFST=NPCLSOFF;              /* OFFSET OF THE NPRE LIST       */ 03308000
         ST    NPCLSOFF,TSLLOFST(,@05)                             1069 03309000
*   CALL HMASMTSB(TSLPARMS);                                       1070 03310000
         ST    @08,@AL00001                                        1070 03311000
         L     @15,@CV01237                                        1070 03312000
         LA    @01,@AL00001                                        1070 03313000
         BALR  @14,@15                                             1070 03314000
*   NPCICTP=TSLLRTNP;               /* ICT ENTRY PTR                 */ 03315000
         L     @08,@PC00001                                        1071 03316000
         L     @02,TBLXTSLP(,@08)                                  1071 03317000
         L     @02,TSLPMLAD(,@02)                                  1071 03318000
         L     NPCICTP,TSLLRTNP(,@02)                              1071 03319000
*   RFY                                                            1072 03320000
*     RTNCODE RSTD;                                                1072 03321000
*   IF RTNCODE=TSLFOUND THEN        /* NPREING SYSMOD FOUND?         */ 03322000
         LTR   RTNCODE,RTNCODE                                     1073 03323000
         BNZ   @RF01073                                            1073 03324000
*     DO;                           /* YES,                          */ 03325000
*       RFY                                                        1075 03326000
*         RTNCODE UNRSTD;                                          1075 03327000
*       NPCRC=STOPSMD;              /* NPRE ERROR - STOP SYSMOD      */ 03328000
*                                                                  1076 03329000
         LA    NPCRC,8                                             1076 03330000
*       /*************************************************************/ 03331000
*       /*                                                           */ 03332000
*       /* ISSUE MESSAGE HMA372 NPRE ERROR - SYSMOD XXXXXXX NPRES    */ 03333000
*       /* XXXXXXX BOTH OF WHICH ARE BEING XXXXXXXX                  */ 03334000
*       /*                                                           */ 03335000
*       /*************************************************************/ 03336000
*                                                                  1077 03337000
*       DO;                         /* HMASMPMG M1(HMA372I)TYPE(ERR)V   03338000
*                                      AR((NPCICTP),IOPNAM17,TBLXFUND   03339000
*                                      )TARGET(SYSOUT,LOG)           */ 03340000
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */ 03341000
         XC    HMASMMGP(28),HMASMMGP                               1078 03342000
*         MGPMGNO1=HMA372I;         /* SET UP MSG 1 CODE             */ 03343000
         MVC   MGPMGNO1(2),@CH01245                                1079 03344000
*         MGPTYPE=MGPERR;           /* SET MESSAGE TYPE              */ 03345000
         MVI   MGPTYPE,X'03'                                       1080 03346000
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */ 03347000
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */ 03348000
         OI    MGPPRINT,B'10010000'                                1082 03349000
*         MGPVARPT(1)=(NPCICTP);    /* SET VARIABLE PTR              */ 03350000
         ST    NPCICTP,MGPVARPT                                    1083 03351000
*         MGPVARPT(2)=ADDR(IOPNAM17);/* SET VARIABLE PTR             */ 03352000
         L     @02,@PC00013                                        1084 03353000
         LA    @02,IOPNAM17(,@02)                                  1084 03354000
         ST    @02,MGPVARPT+4                                      1084 03355000
*         MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR             */ 03356000
         LA    @08,TBLXFUND(,@08)                                  1085 03357000
         ST    @08,MGPVARPT+8                                      1085 03358000
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */ 03359000
         L     @15,@CV01230                                        1086 03360000
         LA    @01,@AL01086                                        1086 03361000
         BALR  @14,@15                                             1086 03362000
*       END;                        /*                               */ 03363000
*     END;                          /*                               */ 03364000
*   ELSE                                                           1089 03365000
*     ;                             /* NPREOR NOT FOUND IN ICT       */ 03366000
*                                                                  1089 03367000
@RF01073 DS    0H                                                  1090 03368000
*   /*****************************************************************/ 03369000
*   /*                                                               */ 03370000
*   /* CHECK THAT CURRENT SYSMOD DOES NOT NPRE SYSMOD IN THE ICT     */ 03371000
*   /*                                                               */ 03372000
*   /*****************************************************************/ 03373000
*                                                                  1090 03374000
*   NPCFOUND=OFF;                   /* ASSUME NOT FOUND              */ 03375000
         NI    NPCFOUND,B'01111111'                                1090 03376000
*   TSLENTSR=''B;                   /* CLEAR TSB PARMLIST            */ 03377000
         L     @08,@PC00001                                        1091 03378000
         L     @08,TBLXTSLP(,@08)                                  1091 03379000
         L     @02,TSLPMLAD(,@08)                                  1091 03380000
         XC    TSLENTSR(16,@02),TSLENTSR(@02)                      1091 03381000
*   TSLEBGNP=ADDR(IOPPTFVR);        /* BEGINNING OF SEARCH PTR       */ 03382000
         L     @15,@PC00013                                        1092 03383000
         LA    @15,IOPPTFVR(,@15)                                  1092 03384000
         ST    @15,TSLEBGNP(,@02)                                  1092 03385000
*   TSLFUNCT=TSLFENSR;              /* FUNCTION IS SEARCH IOP      1093 03386000
*                                      SUB-ENTRY                     */ 03387000
         MVI   TSLFUNCT(@08),X'06'                                 1093 03388000
*   TSLETYPE=IOPPNPR;               /* TYPE IS NPRE ENTRY            */ 03389000
         MVI   TSLETYPE(@02),X'A3'                                 1094 03390000
*   TSLEVER#=NPCVER#;               /* ++VER NUMBER                  */ 03391000
         L     @08,@PC00013+4                                      1095 03392000
         MVC   TSLEVER#(1,@02),NPCVER#(@08)                        1095 03393000
*   DO WHILE NPCRC=ZERO             /* PROCESS ALL NPRE'S IN THE IOP */ 03394000
*         &NPCFOUND=OFF             /*                               */ 03395000
*         &NPCEOLST=OFF;            /*                               */ 03396000
         B     @DE01096                                            1096 03397000
@DL01096 DS    0H                                                  1097 03398000
*     CALL HMASMTSB(TSLPARMS);      /* SEARCH FOR NPRE TYPE          */ 03399000
         L     @08,@PC00001                                        1097 03400000
         L     @08,TBLXTSLP(,@08)                                  1097 03401000
         ST    @08,@AL00001                                        1097 03402000
         L     @15,@CV01237                                        1097 03403000
         LA    @01,@AL00001                                        1097 03404000
         BALR  @14,@15                                             1097 03405000
*     TSLEONXT=ON;                  /* SET TO GET NEXT NPRE          */ 03406000
         L     @08,@PC00001                                        1098 03407000
         L     @08,TBLXTSLP(,@08)                                  1098 03408000
         L     @08,TSLPMLAD(,@08)                                  1098 03409000
         OI    TSLEONXT(@08),B'10000000'                           1098 03410000
*     NPCRTN@=TSLEFNDP;             /*                               */ 03411000
         L     NPCRTN@,TSLEFNDP(,@08)                              1099 03412000
*     RFY                                                          1100 03413000
*       RTNCODE RSTD;                                              1100 03414000
*     IF RTNCODE^=ZERO THEN         /* NOT FOUND ?                   */ 03415000
         LTR   RTNCODE,RTNCODE                                     1101 03416000
         BZ    @RF01101                                            1101 03417000
*       DO;                         /* YES,                          */ 03418000
*         NPCEOLST=ON;              /* STOP THE SEARCH               */ 03419000
         OI    NPCEOLST,B'01000000'                                1103 03420000
*       END;                        /*                               */ 03421000
*     ELSE                          /* NOT FOUND                     */ 03422000
*       DO;                         /*                               */ 03423000
         B     @RC01101                                            1105 03424000
@RF01101 DS    0H                                                  1106 03425000
*         RFY                                                      1106 03426000
*           TSLPARMS BASED(ADDR(TPATSL2));                         1106 03427000
*         TSLSICDS=''B;             /* CLEAR PARMLIST                */ 03428000
         LA    @14,TPATSL2                                         1107 03429000
         L     @08,TSLPMLAD(,@14)                                  1107 03430000
         XC    TSLSICDS(20,@08),TSLSICDS(@08)                      1107 03431000
*         TSLSOICT=ON;              /* SEARCH THE ICT ...            */ 03432000
*         TSLSOCDS=ON;              /* ... AND (A)CDS                */ 03433000
         OI    TSLSOICT(@08),B'11000000'                           1109 03434000
*         TSLFUNCT=TSLFICSR;        /* SEARCH ICT AND (A)CDS FOR NPRE   03435000
*                                      LIST SYSMOD                   */ 03436000
         MVI   TSLFUNCT(@14),X'04'                                 1110 03437000
*         TSLSSMD=NPCRTN@->BASEDSMD;/* NPRE SYSMOD NAME              */ 03438000
         MVC   TSLSSMD(7,@08),BASEDSMD(NPCRTN@)                    1111 03439000
*         CALL HMASMTSB(TSLPARMS);                                 1112 03440000
         ST    @14,@AL00001                                        1112 03441000
         L     @15,@CV01237                                        1112 03442000
         LA    @01,@AL00001                                        1112 03443000
         BALR  @14,@15                                             1112 03444000
*         NPCICTP=TSLICTP;          /* ICT PTR                       */ 03445000
         LA    @14,TPATSL2                                         1113 03446000
         L     @14,TSLPMLAD(,@14)                                  1113 03447000
         L     NPCICTP,TSLICTP(,@14)                               1113 03448000
*         RFY                                                      1114 03449000
*           RTNCODE RSTD;           /*                               */ 03450000
*         IF TSLIOK=ON              /* ENTRY IS IN THE ICT ...       */ 03451000
*             |TSLISUP=ON THEN      /* ... OR SUP'ED                 */ 03452000
         TM    TSLIOK(@14),B'01100000'                             1115 03453000
         BZ    @RF01115                                            1115 03454000
*           DO;                     /* YES,                          */ 03455000
*             RFY                                                  1117 03456000
*               RTNCODE UNRSTD;     /*                               */ 03457000
*             NPCRC=STOPSMD;        /* STOP THE PTF                  */ 03458000
*                                                                  1118 03459000
         LA    NPCRC,8                                             1118 03460000
*             /*******************************************************/ 03461000
*             /*                                                     */ 03462000
*             /* ISSUE MESSAGE HMA372 NPRE ERROR - SYSMOD XXXXXXX    */ 03463000
*             /* NPRES XXXXXXX BOTH OF WHICH ARE BEING XXXXXXXX      */ 03464000
*             /*                                                     */ 03465000
*             /*******************************************************/ 03466000
*                                                                  1119 03467000
*             DO;                   /* HMASMPMG M1(HMA372I)TYPE(ERR)V   03468000
*                                      AR(IOPNAM17,(NPCICTP),TBLXFUND   03469000
*                                      )TARGET(SYSOUT,LOG)           */ 03470000
*               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS    */ 03471000
         XC    HMASMMGP(28),HMASMMGP                               1120 03472000
*               MGPMGNO1=HMA372I;   /* SET UP MSG 1 CODE             */ 03473000
         MVC   MGPMGNO1(2),@CH01245                                1121 03474000
*               MGPTYPE=MGPERR;     /* SET MESSAGE TYPE              */ 03475000
         MVI   MGPTYPE,X'03'                                       1122 03476000
*               MGPPRINT='1'B;      /* SET TARGET FLAG               */ 03477000
*               MGPHLDS='1'B;       /* SET TARGET FLAG               */ 03478000
         OI    MGPPRINT,B'10010000'                                1124 03479000
*               MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR       */ 03480000
         L     @08,@PC00013                                        1125 03481000
         LA    @08,IOPNAM17(,@08)                                  1125 03482000
         ST    @08,MGPVARPT                                        1125 03483000
*               MGPVARPT(2)=(NPCICTP);/* SET VARIABLE PTR            */ 03484000
         ST    NPCICTP,MGPVARPT+4                                  1126 03485000
*               MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR       */ 03486000
         L     @08,@PC00001                                        1127 03487000
         LA    @08,TBLXFUND(,@08)                                  1127 03488000
         ST    @08,MGPVARPT+8                                      1127 03489000
*               CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED       */ 03490000
         L     @15,@CV01230                                        1128 03491000
         LA    @01,@AL01128                                        1128 03492000
         BALR  @14,@15                                             1128 03493000
*             END;                  /*                               */ 03494000
*           END;                    /*                               */ 03495000
*         ELSE                      /* NOT FOUND IN THE ICT          */ 03496000
*           DO;                     /* YES,                          */ 03497000
         B     @RC01115                                            1131 03498000
@RF01115 DS    0H                                                  1132 03499000
*             IF TSLSCFND=ON        /* FOUND ON THE (A)CDS ...       */ 03500000
*                 &TSLSCDEL=OFF THEN/* ... AND NOT DELETED?          */ 03501000
         LA    @08,TPATSL2                                         1132 03502000
         L     @08,TSLPMLAD(,@08)                                  1132 03503000
         TM    TSLSCFND(@08),B'10000000'                           1132 03504000
         BNO   @RF01132                                            1132 03505000
         TM    TSLSCDEL(@08),B'00010000'                           1132 03506000
         BNZ   @RF01132                                            1132 03507000
*               DO;                 /* YES,                          */ 03508000
*                 RFY                                              1134 03509000
*                   TSLPARMS BASED;                                1134 03510000
*                 NPCRC=STOPSMD;    /* STOP THE PTF                  */ 03511000
*                                                                  1135 03512000
         LA    NPCRC,8                                             1135 03513000
*                 /***************************************************/ 03514000
*                 /*                                                 */ 03515000
*                 /* ISSUE MESSAGE HMA427 NPRE ERROR - SYSMOD XXXXXXX*/ 03516000
*                 /* NPRES XXXXXXX WHICH IS ALREADY XXXXXXXX         */ 03517000
*                 /*                                                 */ 03518000
*                 /***************************************************/ 03519000
*                                                                  1136 03520000
*                 DO;               /* HMASMPMG M1(HMA427I)TYPE(ERR)V   03521000
*                                      AR(IOPNAM17,(NPCRTN@),TBLXFUND   03522000
*                                      )TARGET(SYSOUT,LOG)           */ 03523000
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/ 03524000
         XC    HMASMMGP(28),HMASMMGP                               1137 03525000
*                   MGPMGNO1=HMA427I;/* SET UP MSG 1 CODE            */ 03526000
         MVC   MGPMGNO1(2),@CH01253                                1138 03527000
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */ 03528000
         MVI   MGPTYPE,X'03'                                       1139 03529000
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */ 03530000
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */ 03531000
         OI    MGPPRINT,B'10010000'                                1141 03532000
*                   MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR   */ 03533000
         L     @08,@PC00013                                        1142 03534000
         LA    @08,IOPNAM17(,@08)                                  1142 03535000
         ST    @08,MGPVARPT                                        1142 03536000
*                   MGPVARPT(2)=(NPCRTN@);/* SET VARIABLE PTR        */ 03537000
         ST    NPCRTN@,MGPVARPT+4                                  1143 03538000
*                   MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR   */ 03539000
         L     @08,@PC00001                                        1144 03540000
         LA    @08,TBLXFUND(,@08)                                  1144 03541000
         ST    @08,MGPVARPT+8                                      1144 03542000
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */ 03543000
         L     @15,@CV01230                                        1145 03544000
         LA    @01,@AL01145                                        1145 03545000
         BALR  @14,@15                                             1145 03546000
*                 END;              /*                               */ 03547000
*               END;                                               1147 03548000
*             ELSE                                                 1148 03549000
*               ;                   /* NOT ON THE (A)CDS OR DELETED  */ 03550000
@RF01132 DS    0H                                                  1149 03551000
*           END;                    /*                               */ 03552000
*       END;                        /*                               */ 03553000
@RC01115 DS    0H                                                  1151 03554000
*   END;                            /* END OF IOP NPRE SEARCH LOOP   */ 03555000
@RC01101 DS    0H                                                  1151 03556000
@DE01096 LTR   NPCRC,NPCRC                                         1151 03557000
         BNZ   @DC01096                                            1151 03558000
         TM    NPCFOUND,B'11000000'                                1151 03559000
         BZ    @DL01096                                            1151 03560000
@DC01096 DS    0H                                                  1152 03561000
*   RETURN CODE(NPCRC);             /* RETURN WITH THE RETURN CODE   */ 03562000
         LR    @15,NPCRC                                           1152 03563000
         L     @14,@SA00013                                        1152 03564000
         LM    @00,@12,@SA00013+8                                  1152 03565000
         BR    @14                                                 1152 03566000
*   RFY                                                            1153 03567000
*     HMASMIOP BASED;                                              1153 03568000
*   RFY                                                            1154 03569000
*     TSLPARMS BASED;                                              1154 03570000
*   END NPRECK;                     /*                               */ 03571000
*                                                                  1156 03572000
*   /*****************************************************************/ 03573000
*   /*                                                               */ 03574000
*   /* DELCK - CHECK FOR DELETE ERRORS                               */ 03575000
*   /*                                                               */ 03576000
*   /*****************************************************************/ 03577000
*                                                                  1156 03578000
*DELCK:                                                            1156 03579000
*   PROC(DLCIOP,                    /* EXTENDED IOP FOR CURRENT    1156 03580000
*                                      SYSMOD'S SYSMOD ENTRY         */ 03581000
*       DLCVER#);                   /* ++VER NUMBER FOR WHICH      1156 03582000
*                                      CHECKING IS TO BE DONE        */ 03583000
DELCK    STM   @14,@12,@SA00014                                    1156 03584000
         MVC   @PC00014(8),0(@01)                                  1156 03585000
*   DCL                                                            1157 03586000
*     DLCIOP CHAR(*);               /* EXTENDED IOP INPUT            */ 03587000
*   DCL                                                            1158 03588000
*     DLCVER# FIXED(8);             /* ++VER NUMBER                  */ 03589000
*   DCL                                                            1159 03590000
*     DLCLSOFF FIXED(31);           /* OFFSET OF DEL LIST IN PTF ENT */ 03591000
*   DCL                                                            1160 03592000
*     DLCRC FIXED(15);              /*                               */ 03593000
*   DCL                                                            1161 03594000
*     DLCICTP PTR(31);              /* PTR TO ICT PTF FOR DELETEING     03595000
*                                      SYSMOD                        */ 03596000
*   DCL                                                            1162 03597000
*     1 DLCFLAGS,                   /*                               */ 03598000
*      2 DLCFOUND BIT(1),           /* DELETE MATCH FOUND            */ 03599000
*      2 DLCEOLST BIT(1),           /* END OF SUB-ENTRIES FOUND IN 1162 03600000
*                                      DELETE SEARCH                 */ 03601000
*      2 * BIT(6);                  /*                               */ 03602000
*   DCL                                                            1163 03603000
*     DLCRTN@ PTR(31);              /* ICT ENTRY PTR RETURNED BY TSB */ 03604000
*   RFY                                                            1164 03605000
*     HMASMIOP BASED(ADDR(DLCIOP));                                1164 03606000
*   RFY                                                            1165 03607000
*     TSLPARMS BASED(TBLXTSLP);                                    1165 03608000
*   DLCRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 03609000
         SLR   DLCRC,DLCRC                                         1166 03610000
*   DLCFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 03611000
*                                                                  1167 03612000
         MVI   DLCFLAGS,X'00'                                      1167 03613000
*   /*****************************************************************/ 03614000
*   /*                                                               */ 03615000
*   /* CHECK TO SEE IF DELETED BY SYSMOD IN ICT                      */ 03616000
*   /*                                                               */ 03617000
*   /*****************************************************************/ 03618000
*                                                                  1168 03619000
*   RFY                                                            1168 03620000
*     ICTPTF BASED(CCAICPTF);                                      1168 03621000
*   DLCLSOFF=ADDR(ICTPDCHN(1))      /* OFFSET OF DELETE CHAIN PTR    */ 03622000
*       -ADDR(ICTPTF(1));           /*                               */ 03623000
         L     @08,CCAICPTF(,CCAPTR)                               1169 03624000
         LA    DLCLSOFF,ICTPDCHN(,@08)                             1169 03625000
         SLR   DLCLSOFF,@08                                        1169 03626000
*   RFY                                                            1170 03627000
*     ICTPTF BASED;                                                1170 03628000
*   TSLLSTSR=''B;                   /* CLEAR PARMLIST                */ 03629000
         L     @08,@PC00001                                        1171 03630000
         L     @08,TBLXTSLP(,@08)                                  1171 03631000
         L     @04,TSLPMLAD(,@08)                                  1171 03632000
         XC    TSLLSTSR(16,@04),TSLLSTSR(@04)                      1171 03633000
*   TSLFUNCT=TSLFLSRH;              /* SEARCH DELETE LIST FOR SYSMOD */ 03634000
         MVI   TSLFUNCT(@08),X'02'                                 1172 03635000
*   TSLLSMD=IOPNAM17;               /* SYSMOD NAME                   */ 03636000
         L     @15,@PC00014                                        1173 03637000
         MVC   TSLLSMD(7,@04),IOPNAM17(@15)                        1173 03638000
*   TSLLOFST=DLCLSOFF;              /* OFFSET OF THE DELETE LIST     */ 03639000
         ST    DLCLSOFF,TSLLOFST(,@04)                             1174 03640000
*   CALL HMASMTSB(TSLPARMS);                                       1175 03641000
         ST    @08,@AL00001                                        1175 03642000
         L     @15,@CV01237                                        1175 03643000
         LA    @01,@AL00001                                        1175 03644000
         BALR  @14,@15                                             1175 03645000
*   DLCICTP=TSLLRTNP;               /* ICT ENTRY PTR                 */ 03646000
         L     @08,@PC00001                                        1176 03647000
         L     @02,TBLXTSLP(,@08)                                  1176 03648000
         L     @02,TSLPMLAD(,@02)                                  1176 03649000
         L     DLCICTP,TSLLRTNP(,@02)                              1176 03650000
*   RFY                                                            1177 03651000
*     RTNCODE RSTD;                                                1177 03652000
*   IF RTNCODE=TSLFOUND THEN        /* DELETING SYSMOD FOUND?        */ 03653000
         LTR   RTNCODE,RTNCODE                                     1178 03654000
         BNZ   @RF01178                                            1178 03655000
*     DO;                           /* YES,                          */ 03656000
*       RFY                                                        1180 03657000
*         RTNCODE UNRSTD;                                          1180 03658000
*       DLCRC=STOPSMD;              /* DELETE ERROR - STOP SYSMOD    */ 03659000
*                                                                  1181 03660000
         LA    DLCRC,8                                             1181 03661000
*       /*************************************************************/ 03662000
*       /*                                                           */ 03663000
*       /* ISSUE MESSAGE HMA364 DELETE ERROR - SYSMOD XXXXXXX DELETES*/ 03664000
*       /* XXXXXXX BOTH OF WHICH ARE BEING XXXXXXXX                  */ 03665000
*       /*                                                           */ 03666000
*       /*************************************************************/ 03667000
*                                                                  1182 03668000
*       DO;                         /* HMASMPMG M1(HMA364I)TYPE(ERR)V   03669000
*                                      AR((DLCICTP),IOPNAM17,TBLXFUND   03670000
*                                      )TARGET(SYSOUT,LOG)           */ 03671000
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */ 03672000
         XC    HMASMMGP(28),HMASMMGP                               1183 03673000
*         MGPMGNO1=HMA364I;         /* SET UP MSG 1 CODE             */ 03674000
         MVC   MGPMGNO1(2),@CH00791                                1184 03675000
*         MGPTYPE=MGPERR;           /* SET MESSAGE TYPE              */ 03676000
         MVI   MGPTYPE,X'03'                                       1185 03677000
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */ 03678000
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */ 03679000
         OI    MGPPRINT,B'10010000'                                1187 03680000
*         MGPVARPT(1)=(DLCICTP);    /* SET VARIABLE PTR              */ 03681000
         ST    DLCICTP,MGPVARPT                                    1188 03682000
*         MGPVARPT(2)=ADDR(IOPNAM17);/* SET VARIABLE PTR             */ 03683000
         L     @02,@PC00014                                        1189 03684000
         LA    @02,IOPNAM17(,@02)                                  1189 03685000
         ST    @02,MGPVARPT+4                                      1189 03686000
*         MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR             */ 03687000
         LA    @08,TBLXFUND(,@08)                                  1190 03688000
         ST    @08,MGPVARPT+8                                      1190 03689000
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */ 03690000
         L     @15,@CV01230                                        1191 03691000
         LA    @01,@AL01191                                        1191 03692000
         BALR  @14,@15                                             1191 03693000
*       END;                        /*                               */ 03694000
*     END;                          /*                               */ 03695000
*   ELSE                                                           1194 03696000
*     ;                             /* DELETOR NOT FOUND IN ICT      */ 03697000
*                                                                  1194 03698000
@RF01178 DS    0H                                                  1195 03699000
*   /*****************************************************************/ 03700000
*   /*                                                               */ 03701000
*   /* CHECK THAT CURRENT SYSMOD DOES NOT DELETE SYSMOD IN THE ICT   */ 03702000
*   /*                                                               */ 03703000
*   /*****************************************************************/ 03704000
*                                                                  1195 03705000
*   DLCFOUND=OFF;                   /* ASSUME NOT FOUND              */ 03706000
         NI    DLCFOUND,B'01111111'                                1195 03707000
*   TSLENTSR=''B;                   /* CLEAR TSB PARMLIST            */ 03708000
         L     @08,@PC00001                                        1196 03709000
         L     @08,TBLXTSLP(,@08)                                  1196 03710000
         L     @02,TSLPMLAD(,@08)                                  1196 03711000
         XC    TSLENTSR(16,@02),TSLENTSR(@02)                      1196 03712000
*   TSLEBGNP=ADDR(IOPPTFVR);        /* BEGINNING OF SEARCH PTR       */ 03713000
         L     @15,@PC00014                                        1197 03714000
         LA    @15,IOPPTFVR(,@15)                                  1197 03715000
         ST    @15,TSLEBGNP(,@02)                                  1197 03716000
*   TSLFUNCT=TSLFENSR;              /* FUNCTION IS SEARCH IOP      1198 03717000
*                                      SUB-ENTRY                     */ 03718000
         MVI   TSLFUNCT(@08),X'06'                                 1198 03719000
*   TSLETYPE=IOPPDEL;               /* TYPE IS DELETE ENTRY          */ 03720000
         MVI   TSLETYPE(@02),X'A8'                                 1199 03721000
*   TSLEVER#=DLCVER#;               /* ++VER NUMBER                  */ 03722000
         L     @08,@PC00014+4                                      1200 03723000
         MVC   TSLEVER#(1,@02),DLCVER#(@08)                        1200 03724000
*   DO WHILE DLCRC=ZERO             /*                               */ 03725000
*         &DLCFOUND=OFF             /*                               */ 03726000
*         &DLCEOLST=OFF;            /*                               */ 03727000
         B     @DE01201                                            1201 03728000
@DL01201 DS    0H                                                  1202 03729000
*     CALL HMASMTSB(TSLPARMS);      /* SEARCH FOR DEL TYPE           */ 03730000
         L     @08,@PC00001                                        1202 03731000
         L     @08,TBLXTSLP(,@08)                                  1202 03732000
         ST    @08,@AL00001                                        1202 03733000
         L     @15,@CV01237                                        1202 03734000
         LA    @01,@AL00001                                        1202 03735000
         BALR  @14,@15                                             1202 03736000
*     RFY                                                          1203 03737000
*       RTNCODE RSTD;                                              1203 03738000
*     TSLEONXT=ON;                  /* SET TO GET NEXT DELETE        */ 03739000
         L     @14,@PC00001                                        1204 03740000
         L     @14,TBLXTSLP(,@14)                                  1204 03741000
         L     @14,TSLPMLAD(,@14)                                  1204 03742000
         OI    TSLEONXT(@14),B'10000000'                           1204 03743000
*     DLCRTN@=TSLEFNDP;             /* SAVE PTF TO FOUND ENTRY       */ 03744000
         L     DLCRTN@,TSLEFNDP(,@14)                              1205 03745000
*     IF RTNCODE^=ZERO THEN         /* NOT FOUND ?                   */ 03746000
         LTR   RTNCODE,RTNCODE                                     1206 03747000
         BZ    @RF01206                                            1206 03748000
*       DO;                         /* YES,                          */ 03749000
*         DLCEOLST=ON;              /* STOP THE SEARCH               */ 03750000
         OI    DLCEOLST,B'01000000'                                1208 03751000
*       END;                        /*                               */ 03752000
*     ELSE                          /* NOT FOUND                     */ 03753000
*       DO;                         /*                               */ 03754000
         B     @RC01206                                            1210 03755000
@RF01206 DS    0H                                                  1211 03756000
*         RFY                                                      1211 03757000
*           TSLPARMS BASED(ADDR(TPATSL2));                         1211 03758000
*         TSLSICDS=''B;             /* CLEAR PARMLIST                */ 03759000
         LA    @14,TPATSL2                                         1212 03760000
         L     @08,TSLPMLAD(,@14)                                  1212 03761000
         XC    TSLSICDS(20,@08),TSLSICDS(@08)                      1212 03762000
*         TSLSOICT=ON;              /* SEARCH THE ICT ...            */ 03763000
*         TSLSOCDS=ON;              /* ... AND (A)CDS                */ 03764000
         OI    TSLSOICT(@08),B'11000000'                           1214 03765000
*         TSLFUNCT=TSLFICSR;        /* SEARCH ICT AND (A)CDS FOR   1215 03766000
*                                      DELETE LIST SYSMOD            */ 03767000
         MVI   TSLFUNCT(@14),X'04'                                 1215 03768000
*         TSLSSMD=DLCRTN@->BASEDSMD;/* DELETE SYSMOD NAME            */ 03769000
         MVC   TSLSSMD(7,@08),BASEDSMD(DLCRTN@)                    1216 03770000
*         CALL HMASMTSB(TSLPARMS);                                 1217 03771000
         ST    @14,@AL00001                                        1217 03772000
         L     @15,@CV01237                                        1217 03773000
         LA    @01,@AL00001                                        1217 03774000
         BALR  @14,@15                                             1217 03775000
*         DLCICTP=TSLICTP;          /* ICT PTR                       */ 03776000
         LA    @14,TPATSL2                                         1218 03777000
         L     @14,TSLPMLAD(,@14)                                  1218 03778000
         L     DLCICTP,TSLICTP(,@14)                               1218 03779000
*         RFY                                                      1219 03780000
*           RTNCODE RSTD;           /*                               */ 03781000
*         IF TSLIOK=ON              /* ENTRY IS IN THE ICT ...       */ 03782000
*             |TSLISUP=ON THEN      /* ... OR SUP'ED                 */ 03783000
         TM    TSLIOK(@14),B'01100000'                             1220 03784000
         BZ    @RF01220                                            1220 03785000
*           DO;                     /* YES,                          */ 03786000
*             RFY                                                  1222 03787000
*               RTNCODE UNRSTD;     /*                               */ 03788000
*             DLCRC=STOPSMD;        /* STOP THE PTF                  */ 03789000
*                                                                  1223 03790000
         LA    DLCRC,8                                             1223 03791000
*             /*******************************************************/ 03792000
*             /*                                                     */ 03793000
*             /* ISSUE MESSAGE HMA364 DELETE ERROR - SYSMOD XXXXXXX  */ 03794000
*             /* DELETES XXXXXXX BOTH OF WHICH ARE BEING XXXXXXXX    */ 03795000
*             /*                                                     */ 03796000
*             /*******************************************************/ 03797000
*                                                                  1224 03798000
*             DO;                   /* HMASMPMG M1(HMA364I)TYPE(ERR)V   03799000
*                                      AR(IOPNAM17,(DLCRTN@),TBLXFUND   03800000
*                                      )TARGET(SYSOUT,LOG)           */ 03801000
*               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS    */ 03802000
         XC    HMASMMGP(28),HMASMMGP                               1225 03803000
*               MGPMGNO1=HMA364I;   /* SET UP MSG 1 CODE             */ 03804000
         MVC   MGPMGNO1(2),@CH00791                                1226 03805000
*               MGPTYPE=MGPERR;     /* SET MESSAGE TYPE              */ 03806000
         MVI   MGPTYPE,X'03'                                       1227 03807000
*               MGPPRINT='1'B;      /* SET TARGET FLAG               */ 03808000
*               MGPHLDS='1'B;       /* SET TARGET FLAG               */ 03809000
         OI    MGPPRINT,B'10010000'                                1229 03810000
*               MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR       */ 03811000
         L     @08,@PC00014                                        1230 03812000
         LA    @08,IOPNAM17(,@08)                                  1230 03813000
         ST    @08,MGPVARPT                                        1230 03814000
*               MGPVARPT(2)=(DLCRTN@);/* SET VARIABLE PTR            */ 03815000
         ST    DLCRTN@,MGPVARPT+4                                  1231 03816000
*               MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR       */ 03817000
         L     @08,@PC00001                                        1232 03818000
         LA    @08,TBLXFUND(,@08)                                  1232 03819000
         ST    @08,MGPVARPT+8                                      1232 03820000
*               CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED       */ 03821000
         L     @15,@CV01230                                        1233 03822000
         LA    @01,@AL01233                                        1233 03823000
         BALR  @14,@15                                             1233 03824000
*             END;                  /*                               */ 03825000
*           END;                    /*                               */ 03826000
*         ELSE                      /* NOT FOUND IN THE ICT          */ 03827000
*           DO;                     /* YES,                          */ 03828000
         B     @RC01220                                            1236 03829000
@RF01220 DS    0H                                                  1237 03830000
*             IF TSLSCFND=ON        /* FOUND ON THE (A)CDS ...       */ 03831000
*                 &TSLSCDEL=OFF THEN/* ... AND NOT DELETED?          */ 03832000
         LA    @08,TPATSL2                                         1237 03833000
         L     @08,TSLPMLAD(,@08)                                  1237 03834000
         TM    TSLSCFND(@08),B'10000000'                           1237 03835000
         BNO   @RF01237                                            1237 03836000
         TM    TSLSCDEL(@08),B'00010000'                           1237 03837000
         BNZ   @RF01237                                            1237 03838000
*               DO;                 /* YES,                          */ 03839000
*                 RFY                                              1239 03840000
*                   TSLPARMS BASED(TBLXTSLP);                      1239 03841000
*                 DLCRC=STOPSMD;    /* STOP THE PTF                  */ 03842000
*                                                                  1240 03843000
         LA    DLCRC,8                                             1240 03844000
*                 /***************************************************/ 03845000
*                 /*                                                 */ 03846000
*                 /* ISSUE MESSAGE HMA426 DELETE ERROR - SYSMOD      */ 03847000
*                 /* XXXXXXX DELETES XXXXXXX WHICH IS ALREADY        */ 03848000
*                 /* XXXXXXXX                                        */ 03849000
*                 /*                                                 */ 03850000
*                 /***************************************************/ 03851000
*                                                                  1241 03852000
*                 DO;               /* HMASMPMG M1(HMA426I)TYPE(ERR)V   03853000
*                                      AR(IOPNAM17,(DLCRTN@),TBLXFUND   03854000
*                                      )TARGET(SYSOUT,LOG)           */ 03855000
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/ 03856000
         XC    HMASMMGP(28),HMASMMGP                               1242 03857000
*                   MGPMGNO1=HMA426I;/* SET UP MSG 1 CODE            */ 03858000
         MVC   MGPMGNO1(2),@CH01255                                1243 03859000
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */ 03860000
         MVI   MGPTYPE,X'03'                                       1244 03861000
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */ 03862000
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */ 03863000
         OI    MGPPRINT,B'10010000'                                1246 03864000
*                   MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR   */ 03865000
         L     @08,@PC00014                                        1247 03866000
         LA    @08,IOPNAM17(,@08)                                  1247 03867000
         ST    @08,MGPVARPT                                        1247 03868000
*                   MGPVARPT(2)=(DLCRTN@);/* SET VARIABLE PTR        */ 03869000
         ST    DLCRTN@,MGPVARPT+4                                  1248 03870000
*                   MGPVARPT(3)=ADDR(TBLXFUND);/* SET VARIABLE PTR   */ 03871000
         L     @08,@PC00001                                        1249 03872000
         LA    @08,TBLXFUND(,@08)                                  1249 03873000
         ST    @08,MGPVARPT+8                                      1249 03874000
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */ 03875000
         L     @15,@CV01230                                        1250 03876000
         LA    @01,@AL01250                                        1250 03877000
         BALR  @14,@15                                             1250 03878000
*                 END;              /*                               */ 03879000
*               END;                                               1252 03880000
*             ELSE                                                 1253 03881000
*               ;                   /* NOT ON THE (A)CDS OR DELETED  */ 03882000
@RF01237 DS    0H                                                  1254 03883000
*           END;                    /*                               */ 03884000
*       END;                        /*                               */ 03885000
@RC01220 DS    0H                                                  1256 03886000
*   END;                            /* END OF IOP DELETE SEARCH LOOP */ 03887000
@RC01206 DS    0H                                                  1256 03888000
@DE01201 LTR   DLCRC,DLCRC                                         1256 03889000
         BNZ   @DC01201                                            1256 03890000
         TM    DLCFOUND,B'11000000'                                1256 03891000
         BZ    @DL01201                                            1256 03892000
@DC01201 DS    0H                                                  1257 03893000
*   RETURN CODE(DLCRC);             /* RETURN WITH THE RETURN CODE   */ 03894000
         LR    @15,DLCRC                                           1257 03895000
         L     @14,@SA00014                                        1257 03896000
         LM    @00,@12,@SA00014+8                                  1257 03897000
         BR    @14                                                 1257 03898000
*   RFY                                                            1258 03899000
*     HMASMIOP BASED;                                              1258 03900000
*   RFY                                                            1259 03901000
*     TSLPARMS BASED;                                              1259 03902000
*   END DELCK;                      /*                               */ 03903000
*                                                                  1261 03904000
*   /*****************************************************************/ 03905000
*   /*                                                               */ 03906000
*   /* GROUPADD -                                                    */ 03907000
*   /*                                                               */ 03908000
*   /*****************************************************************/ 03909000
*                                                                  1261 03910000
*GROUPADD:                                                         1261 03911000
*   PROC;                                                          1261 03912000
GROUPADD STM   @14,@12,@SA00015                                    1261 03913000
*   DCL                                                            1262 03914000
*     GRARC FIXED(15);              /* RETURN CODE                   */ 03915000
*   DCL                                                            1263 03916000
*     GRASTAT BIT(8);               /*                               */ 03917000
*   DCL                                                            1264 03918000
*     GRAPTFX FIXED(15);            /* PTF SEARCH INDEX              */ 03919000
*   DCL                                                            1265 03920000
*     GRAPREX FIXED(15);            /* PRE SEARCH INDEX              */ 03921000
*   DCL                                                            1266 03922000
*     GRAREQX FIXED(15);            /* REQ SEARCH INDEX              */ 03923000
*   DCL                                                            1267 03924000
*     GRAIRQX FIXED(15);            /* IRQ SEARCH INDEX              */ 03925000
*   DCL                                                            1268 03926000
*     GRAPTR PTR(31);               /* STATUS BYTE OFFSET PTR        */ 03927000
*   DCL                                                            1269 03928000
*     GRASOFFS FIXED(31);           /* OFFSET OF SCLSTAT WITHIN    1269 03929000
*                                      SCLMAP                        */ 03930000
*   DCL                                                            1270 03931000
*     GRAIFOPT CHAR(1);             /* ++IF PROCESSING OPTION TO BE     03932000
*                                      USED                          */ 03933000
*   RFY                                                            1271 03934000
*     ICTPTF BASED(CCAICPTF);                                      1271 03935000
*   RFY                                                            1272 03936000
*     ICTPRELS BASED(ICTPPCHN(GRAPTFX));                           1272 03937000
*   RFY                                                            1273 03938000
*     ICTREQLS BASED(ICTPRCHN(GRAPTFX));                           1273 03939000
*   RFY                                                            1274 03940000
*     ICTIRQLS BASED(ICTPICHN(GRAPTFX));                           1274 03941000
*   RFY                                                            1275 03942000
*     HMASMGTP BASED(TBLXSCGT);                                    1275 03943000
*   RFY                                                            1276 03944000
*     SCLMAP BASED(GTPBUFAD);                                      1276 03945000
*   GRARC=ZERO;                     /* CLEAR THE RETURN CODE         */ 03946000
         SLR   GRARC,GRARC                                         1277 03947000
*   IF TBLGROUP=ON THEN             /* GROUP ?                       */ 03948000
         L     @08,@PC00001                                        1278 03949000
         L     @08,TBLXTBL(,@08)                                   1278 03950000
         TM    TBLGROUP(@08),B'00100000'                           1278 03951000
         BNO   @RF01278                                            1278 03952000
*     DO;                           /* YES,                          */ 03953000
*                                                                  1279 03954000
*       /*************************************************************/ 03955000
*       /*                                                           */ 03956000
*       /* CREATE MASK TO OR INTO SCL STATUS FLAGS                   */ 03957000
*       /*                                                           */ 03958000
*       /*************************************************************/ 03959000
*                                                                  1280 03960000
*       GRASOFFS=ADDR(SCLSTAT)-ADDR(SCLMAP);/* OFFSET OF STATUS BYTE    03961000
*                                      IN SCL                        */ 03962000
         LA    GRASOFFS,15                                         1280 03963000
*       GRASTAT=''B;                /* CLEAR STATUS BYTE             */ 03964000
         MVI   GRASTAT,X'00'                                       1281 03965000
*       GRAPTR=                     /*                               */ 03966000
*           (ADDR(GRASTAT)-GRASOFFS);/* SET GRASTAT CANDIDATE FLAG AS   03967000
*                                      ...                           */ 03968000
         LA    GRAPTR,GRASTAT                                      1282 03969000
         SLR   GRAPTR,GRASOFFS                                     1282 03970000
*       GRAPTR->                    /*                               */ 03971000
*           SCLCAND=ON;             /* ... MAPPED IN THE SCLSTAT BYTE*/ 03972000
         OI    SCLCAND(GRAPTR),B'00100000'                         1283 03973000
*       DO GRAPTFX=1 BY 1           /* SEARCH ENTIRE ICT PTF SECTION */ 03974000
*             WHILE(ICTPEND(GRAPTFX)^=ICTENDNT/*                     */ 03975000
*             &GRARC<STOPFUNC);     /*                               */ 03976000
         LA    GRAPTFX,1                                           1284 03977000
         B     @DE01284                                            1284 03978000
@DL01284 DS    0H                                                  1285 03979000
*         IF ICTPPASS(GRAPTFX)=ON THEN/* ADDED IN THIS PASS?         */ 03980000
         LR    @08,GRAPTFX                                         1285 03981000
         MH    @08,@CH01757                                        1285 03982000
         L     @05,CCAICPTF(,CCAPTR)                               1285 03983000
         ST    @08,@TF00001                                        1285 03984000
         ALR   @08,@05                                             1285 03985000
         AL    @08,@CF01791                                        1285 03986000
         TM    ICTPPASS-16(@08),B'10000000'                        1285 03987000
         BNO   @RF01285                                            1285 03988000
*           DO;                     /* YES, PROCESS IT               */ 03989000
*             IF ICTPNOGO(GRAPTFX)=OFF/* NOT NOGO ...                */ 03990000
*                 &ICTPDEXP(GRAPTFX)=OFF/* ... AND NOT DELETED       */ 03991000
*                 &ICTPDIMP(GRAPTFX)=OFF/* ...                       */ 03992000
*                 &ICTPSUPN(GRAPTFX)=ZERO THEN/* ... AND NOT SUP'ED  */ 03993000
         LR    @08,@05                                             1287 03994000
         AL    @08,@TF00001                                        1287 03995000
         AL    @08,@CF01785                                        1287 03996000
         TM    ICTPNOGO-8(@08),B'01000000'                         1287 03997000
         BNZ   @RF01287                                            1287 03998000
         LR    @08,@05                                             1287 03999000
         AL    @08,@TF00001                                        1287 04000000
         AL    @08,@CF01787                                        1287 04001000
         TM    ICTPDEXP-13(@08),B'00110000'                        1287 04002000
         BNZ   @RF01287                                            1287 04003000
         AL    @05,@TF00001                                        1287 04004000
         AL    @05,@CF01786                                        1287 04005000
         SLR   @08,@08                                             1287 04006000
         ICM   @08,3,ICTPSUPN-20(@05)                              1287 04007000
         LTR   @08,@08                                             1287 04008000
         BNZ   @RF01287                                            1287 04009000
*               DO;                 /*                               */ 04010000
*                                                                  1288 04011000
*                 /***************************************************/ 04012000
*                 /*                                                 */ 04013000
*                 /* MARK PRE'S AS CANDIDATES                        */ 04014000
*                 /*                                                 */ 04015000
*                 /***************************************************/ 04016000
*                                                                  1289 04017000
*                 ;                 /*                               */ 04018000
*                 DO GRAPREX=1 BY 1 /* PROCESS ALL PRE'S IN PTF INDEX   04019000
*                                      LIST                          */ 04020000
*                       WHILE(ADDR(ICTPRELS)^=ZERO/* IF CHAIN PTR    */ 04021000
*                       &ICTPREND(GRAPREX)^=ICTENDIX);/*             */ 04022000
         LA    GRAPREX,1                                           1290 04023000
         B     @DE01290                                            1290 04024000
@DL01290 DS    0H                                                  1291 04025000
*                   CALL SCLSET(ICTPRENM(GRAPREX),/* SYSMOD NAME     */ 04026000
*                       GRASTAT,    /* FLAGS TO BE OR'ED INTO RECORD */ 04027000
*                       ZERO);      /* NO REDO PREOCEESING           */ 04028000
         MVC   @AL00001+4(8),@AL01291                              1291 04029000
         LR    @08,GRAPREX                                         1291 04030000
         SLA   @08,3                                               1291 04031000
         LR    @05,GRAPTFX                                         1291 04032000
         MH    @05,@CH01757                                        1291 04033000
         L     @01,CCAICPTF(,CCAPTR)                               1291 04034000
         AL    @01,@CF01792                                        1291 04035000
         L     @05,ICTPPCHN-76(@05,@01)                            1291 04036000
         AL    @05,@CF01789                                        1291 04037000
         LA    @08,ICTPRENM(@08,@05)                               1291 04038000
         ST    @08,@AL00001                                        1291 04039000
         LA    @01,@AL00001                                        1291 04040000
         BAL   @14,SCLSET                                          1291 04041000
*                 END;                                             1292 04042000
*                                                                  1292 04043000
         AH    GRAPREX,@CH00064                                    1292 04044000
@DE01290 LR    @08,GRAPTFX                                         1292 04045000
         MH    @08,@CH01757                                        1292 04046000
         L     @05,CCAICPTF(,CCAPTR)                               1292 04047000
         AL    @05,@CF01792                                        1292 04048000
         L     @08,ICTPPCHN-76(@08,@05)                            1292 04049000
         LTR   @08,@08                                             1292 04050000
         BZ    @DC01290                                            1292 04051000
         LR    @05,GRAPREX                                         1292 04052000
         SLA   @05,3                                               1292 04053000
         AL    @08,@CF01789                                        1292 04054000
         L     @08,ICTPREND(@05,@08)                               1292 04055000
         CL    @08,ICTENDIX                                        1292 04056000
         BNE   @DL01290                                            1292 04057000
@DC01290 DS    0H                                                  1293 04058000
*                 /***************************************************/ 04059000
*                 /*                                                 */ 04060000
*                 /* MARK REQ'S AS CANDIDATES                        */ 04061000
*                 /*                                                 */ 04062000
*                 /***************************************************/ 04063000
*                                                                  1293 04064000
*                 DO GRAREQX=1 BY 1 /* PROCESS ALL REQ'S IN PTF INDEX   04065000
*                                      LIST                          */ 04066000
*                       WHILE(ADDR(ICTREQLS)^=ZERO/* IF CHAIN PTR    */ 04067000
*                       &ICTREQND(GRAREQX)^=ICTENDIX);/*             */ 04068000
         LA    GRAREQX,1                                           1293 04069000
         B     @DE01293                                            1293 04070000
@DL01293 DS    0H                                                  1294 04071000
*                   CALL SCLSET(ICTREQNM(GRAREQX),/* SYSMOD NAME     */ 04072000
*                       GRASTAT,    /* FLAGS TO BE OR'ED INTO RECORD */ 04073000
*                       ZERO);      /* NO REDO PREOCEESING           */ 04074000
         MVC   @AL00001+4(8),@AL01294                              1294 04075000
         LR    @08,GRAREQX                                         1294 04076000
         SLA   @08,3                                               1294 04077000
         LR    @05,GRAPTFX                                         1294 04078000
         MH    @05,@CH01757                                        1294 04079000
         L     @01,CCAICPTF(,CCAPTR)                               1294 04080000
         AL    @01,@CF01793                                        1294 04081000
         L     @05,ICTPRCHN-68(@05,@01)                            1294 04082000
         AL    @05,@CF01789                                        1294 04083000
         LA    @08,ICTREQNM(@08,@05)                               1294 04084000
         ST    @08,@AL00001                                        1294 04085000
         LA    @01,@AL00001                                        1294 04086000
         BAL   @14,SCLSET                                          1294 04087000
*                 END;              /*                               */ 04088000
         AH    GRAREQX,@CH00064                                    1295 04089000
@DE01293 LR    @08,GRAPTFX                                         1295 04090000
         MH    @08,@CH01757                                        1295 04091000
         L     @05,CCAICPTF(,CCAPTR)                               1295 04092000
         AL    @05,@CF01793                                        1295 04093000
         L     @08,ICTPRCHN-68(@08,@05)                            1295 04094000
         LTR   @08,@08                                             1295 04095000
         BZ    @DC01293                                            1295 04096000
         LR    @05,GRAREQX                                         1295 04097000
         SLA   @05,3                                               1295 04098000
         AL    @08,@CF01789                                        1295 04099000
         L     @08,ICTREQND(@05,@08)                               1295 04100000
         CL    @08,ICTENDIX                                        1295 04101000
         BNE   @DL01293                                            1295 04102000
@DC01293 DS    0H                                                  1296 04103000
*                 ;                 /*                               */ 04104000
*                                                                  1296 04105000
*                 /***************************************************/ 04106000
*                 /*                                                 */ 04107000
*                 /* MARK ++IF REQ'S AS CANDIDATES                   */ 04108000
*                 /*                                                 */ 04109000
*                 /***************************************************/ 04110000
*                                                                  1297 04111000
*                 DO GRAIRQX=1 BY 1 /* PROCESS ALL IRQ'S IN PTF INDEX   04112000
*                                      LIST                          */ 04113000
*                       WHILE(ADDR(ICTIRQLS)^=ZERO/* IF CHAIN PTR    */ 04114000
*                       &ICTIRQND(GRAIRQX)^=ICTENDIX);/* AND NOT END */ 04115000
         LA    GRAIRQX,1                                           1297 04116000
         B     @DE01297                                            1297 04117000
@DL01297 DS    0H                                                  1298 04118000
*                   GRAIFOPT=ZERO;  /* ASSUME ++IF PROCESSED ONLY IF    04119000
*                                      IT IS NOT ON THE (A)CDS       */ 04120000
         MVI   GRAIFOPT,X'00'                                      1298 04121000
*                   IF ICTIREQI(GRAIRQX)=ON THEN/* ++IF REQ TO BE  1299 04122000
*                                      PROCESSED EVEN IF ALREADY   1299 04123000
*                                      PRESENT?                      */ 04124000
         LR    @08,GRAIRQX                                         1299 04125000
         SLA   @08,4                                               1299 04126000
         LR    @05,GRAPTFX                                         1299 04127000
         MH    @05,@CH01757                                        1299 04128000
         L     @01,CCAICPTF(,CCAPTR)                               1299 04129000
         AL    @01,@CF01794                                        1299 04130000
         L     @05,ICTPICHN-80(@05,@01)                            1299 04131000
         ALR   @05,@08                                             1299 04132000
         AL    @05,@CF01795                                        1299 04133000
         TM    ICTIREQI-7(@05),B'00000100'                         1299 04134000
         BNO   @RF01299                                            1299 04135000
*                     DO;           /* YES,                          */ 04136000
*                       GRAIFOPT=REDO;/* REPROCESS ++IF REQ          */ 04137000
         MVI   GRAIFOPT,C'R'                                       1301 04138000
*                     END;                                         1302 04139000
*                   ELSE                                           1303 04140000
*                     ;             /* NO SPECIAL PROCESSING FOR ++IF   04141000
*                                      REQ                           */ 04142000
@RF01299 DS    0H                                                  1304 04143000
*                   CALL SCLSET(ICTIRQNM(GRAIRQX),/* SYSMOD NAME     */ 04144000
*                       GRASTAT,    /* FLAGS TO BE OR'ED INTO RECORD */ 04145000
*                       GRAIFOPT);  /* REDO PREOCEESING FOR IF REQS  */ 04146000
         MVC   @AL00001+4(8),@AL01304                              1304 04147000
         LR    @08,GRAIRQX                                         1304 04148000
         SLA   @08,4                                               1304 04149000
         LR    @05,GRAPTFX                                         1304 04150000
         MH    @05,@CH01757                                        1304 04151000
         L     @01,CCAICPTF(,CCAPTR)                               1304 04152000
         AL    @01,@CF01794                                        1304 04153000
         L     @05,ICTPICHN-80(@05,@01)                            1304 04154000
         AL    @05,@CF01796                                        1304 04155000
         LA    @08,ICTIRQNM(@08,@05)                               1304 04156000
         ST    @08,@AL00001                                        1304 04157000
         LA    @01,@AL00001                                        1304 04158000
         BAL   @14,SCLSET                                          1304 04159000
*                 END;              /*                               */ 04160000
         AH    GRAIRQX,@CH00064                                    1305 04161000
@DE01297 LR    @08,GRAPTFX                                         1305 04162000
         MH    @08,@CH01757                                        1305 04163000
         L     @05,CCAICPTF(,CCAPTR)                               1305 04164000
         AL    @05,@CF01794                                        1305 04165000
         L     @08,ICTPICHN-80(@08,@05)                            1305 04166000
         LTR   @08,@08                                             1305 04167000
         BZ    @DC01297                                            1305 04168000
         LR    @05,GRAIRQX                                         1305 04169000
         SLA   @05,4                                               1305 04170000
         AL    @08,@CF01796                                        1305 04171000
         L     @08,ICTIRQND(@05,@08)                               1305 04172000
         CL    @08,ICTENDIX                                        1305 04173000
         BNE   @DL01297                                            1305 04174000
@DC01297 DS    0H                                                  1306 04175000
*               END;                /*                               */ 04176000
*             ELSE                                                 1307 04177000
*               ;                   /* SKIP THIS ENTRY               */ 04178000
@RF01287 DS    0H                                                  1308 04179000
*           END;                    /*                               */ 04180000
*         ELSE                                                     1309 04181000
*           ;                       /* IGNORE ENTRY SINCE NOT FOR  1309 04182000
*                                      THIS PASS                     */ 04183000
@RF01285 DS    0H                                                  1310 04184000
*       END;                        /* END OF ICT PTF SECTION LOOP   */ 04185000
         AH    GRAPTFX,@CH00064                                    1310 04186000
@DE01284 LR    @08,GRAPTFX                                         1310 04187000
         MH    @08,@CH01757                                        1310 04188000
         L     @05,CCAICPTF(,CCAPTR)                               1310 04189000
         AL    @05,@CF01790                                        1310 04190000
         L     @08,ICTPEND(@08,@05)                                1310 04191000
         CL    @08,ICTENDNT                                        1310 04192000
         BE    @DC01284                                            1310 04193000
         CH    GRARC,@CH00033                                      1310 04194000
         BL    @DL01284                                            1310 04195000
@DC01284 DS    0H                                                  1311 04196000
*     END;                                                         1311 04197000
*   ELSE                                                           1312 04198000
*     ;                             /* GROUP NOT SPECIFIED           */ 04199000
@RF01278 DS    0H                                                  1313 04200000
*   RETURN CODE(GRARC);             /* RETURN WITH THE RETURN CODE   */ 04201000
         LR    @15,GRARC                                           1313 04202000
         L     @14,@SA00015                                        1313 04203000
         LM    @00,@12,@SA00015+8                                  1313 04204000
         BR    @14                                                 1313 04205000
*   RFY                                                            1314 04206000
*     ICTPTF BASED;                                                1314 04207000
*   RFY                                                            1315 04208000
*     ICTPRELS BASED;                                              1315 04209000
*   RFY                                                            1316 04210000
*     ICTPRELS BASED;                                              1316 04211000
*   RFY                                                            1317 04212000
*     ICTPRELS BASED;                                              1317 04213000
*   RFY                                                            1318 04214000
*     HMASMGTP BASED;                                              1318 04215000
*   RFY                                                            1319 04216000
*     SCLMAP BASED;                                                1319 04217000
*   END GROUPADD;                   /*                               */ 04218000
*                                                                  1321 04219000
*   /*****************************************************************/ 04220000
*   /*                                                               */ 04221000
*   /* SCLSET -                                                      */ 04222000
*   /*                                                               */ 04223000
*   /*****************************************************************/ 04224000
*                                                                  1321 04225000
*SCLSET:                                                           1321 04226000
*   PROC(SSTSMD,                    /* NAME OF THE SYSMOD FOR WHICH     04227000
*                                      STATUS IS TO BE SET           */ 04228000
*       SSTSTAT,                    /* STATUS TO BE OR'ED INTO     1321 04229000
*                                      SCLSTAT FIELD (BIT(8))        */ 04230000
*       SSTREDO);                   /* REDO PROCESSING TO BE DONE  1321 04231000
*                                      (CHAR(1))                     */ 04232000
SCLSET   STM   @14,@12,@SA00016                                    1321 04233000
         MVC   @PC00016(12),0(@01)                                 1321 04234000
*   DCL                                                            1322 04235000
*     SSTSMD CHAR(LENGTH(IOPNAM17));/* SYSMOD NAME                   */ 04236000
*   DCL                                                            1323 04237000
*     SSTSTAT BIT(8);               /* STATUS TO BE OR'ED IN         */ 04238000
*   DCL                                                            1324 04239000
*     SSTREDO CHAR(1);              /* REDO PROCESSING PARM          */ 04240000
*   DCL                                                            1325 04241000
*     1 SSTFLAGS,                   /* LOCAL CONTROL FLAGS           */ 04242000
*      2 SSTEOF BIT(1),             /* END OF FILE ON SCL DURING   1325 04243000
*                                      STATUS UPDATE                 */ 04244000
*      2 SSTFOUND BIT(1),           /* SYSMOD FOUND IN ONE OF THE  1325 04245000
*                                      LISTS                         */ 04246000
*      2 SSTOK BIT(1),              /* SYSMOD IS OK TO BE A CANDIDATE*/ 04247000
*      2 * BIT(5);                  /* UNUSED                        */ 04248000
*   DCL                                                            1326 04249000
*     SSTSVKLN FIXED(15);           /* KEY BEFORE THIS ROUTINE     1326 04250000
*                                      CHANGED IT                    */ 04251000
*   DCL                                                            1327 04252000
*     SSTNDX FIXED(15);             /* LIST NAME INDEX               */ 04253000
*   DCL                                                            1328 04254000
*     SSTNTFRC FIXED(15) CONSTANT(4);/* NOT FOUND RC VALUE           */ 04255000
*   DCL                                                            1329 04256000
*     SSTRC FIXED(15);              /* RETURN CODE                   */ 04257000
*   RFY                                                            1330 04258000
*     HMASMGTP BASED(TBLXSCGT);                                    1330 04259000
*   RFY                                                            1331 04260000
*     SCLMAP BASED(GTPBUFAD);                                      1331 04261000
*   RFY                                                            1332 04262000
*     TSLPARMS BASED(TBLXTSLP);                                    1332 04263000
*   SSTRC=SSTNTFRC;                 /* ASSUME NOT FOUND RETURN CODE  */ 04264000
         LA    SSTRC,4                                             1333 04265000
*   SSTFLAGS=''B;                   /* CLEAR CONTROL FLAGS           */ 04266000
         MVI   SSTFLAGS,X'00'                                      1334 04267000
*                                                                  1335 04268000
*   /*****************************************************************/ 04269000
*   /*                                                               */ 04270000
*   /* FIND SYSMOD BY DOING A LOCATE ON EACH OF THE POSSIBLE LIST    */ 04271000
*   /* NAMES                                                         */ 04272000
*   /*                                                               */ 04273000
*   /*****************************************************************/ 04274000
*                                                                  1335 04275000
*   SSTSVKLN=GTPKEYLN;              /* SAVE KEY LENGTH               */ 04276000
         L     @08,@PC00001                                        1335 04277000
         L     @08,TBLXSCGT(,@08)                                  1335 04278000
         LH    SSTSVKLN,GTPKEYLN(,@08)                             1335 04279000
*   GTPKEYLN=LENGTH(SCLISTNO)+LENGTH(SCLSMD);/* KEY WILL BE LIST # 1336 04280000
*                                      PLUS SYSMOD NAME              */ 04281000
         MVC   GTPKEYLN(2,@08),@CH00056                            1336 04282000
*   GTPFUNCT=GTPLOC;                /* FUNCTION IS LOCATE            */ 04283000
         MVI   GTPFUNCT(@08),X'03'                                 1337 04284000
*   SCLSMD=SSTSMD;                  /* SYSMOD TO BE LOCATED          */ 04285000
         L     @08,GTPBUFAD(,@08)                                  1338 04286000
         L     @05,@PC00016                                        1338 04287000
         MVC   SCLSMD(7,@08),SSTSMD(@05)                           1338 04288000
*   SSTFOUND=OFF;                   /* SYSMOD NOT YET FOUND          */ 04289000
         NI    SSTFOUND,B'10111111'                                1339 04290000
*   DO SSTNDX=1 TO DIM(LISTNMS)     /*                               */ 04291000
*         WHILE(SSTFOUND=OFF);      /*                               */ 04292000
         LA    SSTNDX,1                                            1340 04293000
@DL01340 TM    SSTFOUND,B'01000000'                                1340 04294000
         BNZ   @DC01340                                            1340 04295000
*     SCLISTNO=LISTNMS(SSTNDX);     /*                               */ 04296000
         L     @08,@PC00001                                        1341 04297000
         L     @08,TBLXSCGT(,@08)                                  1341 04298000
         L     @05,GTPBUFAD(,@08)                                  1341 04299000
         LA    @01,LISTNMS-1(SSTNDX)                               1341 04300000
         MVC   SCLISTNO(1,@05),0(@01)                              1341 04301000
*     CALL HMASMGTA(HMASMGTP);      /* DO LOCATE                     */ 04302000
         ST    @08,@AL00001                                        1342 04303000
         L     @15,@CV01231                                        1342 04304000
         LA    @01,@AL00001                                        1342 04305000
         BALR  @14,@15                                             1342 04306000
*     IF GTPRETRN=GTPGOOD THEN      /* SYSMOD FOUND IN SCL?          */ 04307000
         L     @08,@PC00001                                        1343 04308000
         L     @08,TBLXSCGT(,@08)                                  1343 04309000
         CLI   GTPRETRN(@08),0                                     1343 04310000
         BNE   @RF01343                                            1343 04311000
*       DO;                         /* YES,                          */ 04312000
*         SSTRC=ZERO;               /* FOUND SYSMOD RETURN CODE      */ 04313000
         SLR   SSTRC,SSTRC                                         1345 04314000
*         SSTFOUND=ON;              /* FOUND, STOP SEARCH            */ 04315000
*         SSTOK=ON;                 /* OK TO MAKE SYSMOD A CANDIDATE */ 04316000
         OI    SSTFOUND,B'01100000'                                1347 04317000
*       END;                                                       1348 04318000
*     ELSE                                                         1349 04319000
*       ;                           /* NOT FOUND, TRY NEXT LIST      */ 04320000
@RF01343 DS    0H                                                  1350 04321000
*   END;                            /*                               */ 04322000
         AH    SSTNDX,@CH00064                                     1350 04323000
         CH    SSTNDX,@CH00102                                     1350 04324000
         BNH   @DL01340                                            1350 04325000
@DC01340 DS    0H                                                  1351 04326000
*   GTPKEYLN=SSTSVKLN;              /* RESTORE THE KEY LENGTH        */ 04327000
         L     @08,@PC00001                                        1351 04328000
         L     @08,TBLXSCGT(,@08)                                  1351 04329000
         STH   SSTSVKLN,GTPKEYLN(,@08)                             1351 04330000
*   IF SSTFOUND=ON                  /* FOUND AND ...                 */ 04331000
*       &SCLREDO=ON                 /* ... A REDO LIST ENTRY         */ 04332000
*       &SCLCAND=OFF THEN           /* ... THATS NOT A CANDIDATE     */ 04333000
         TM    SSTFOUND,B'01000000'                                1352 04334000
         BNO   @RF01352                                            1352 04335000
         L     @08,GTPBUFAD(,@08)                                  1352 04336000
         TM    SCLREDO(@08),B'00010000'                            1352 04337000
         BNO   @RF01352                                            1352 04338000
         TM    SCLCAND(@08),B'00100000'                            1352 04339000
         BNZ   @RF01352                                            1352 04340000
*     DO;                           /* YES,                          */ 04341000
*                                                                  1353 04342000
*       /*************************************************************/ 04343000
*       /*                                                           */ 04344000
*       /*                                                           */ 04345000
*       /*************************************************************/ 04346000
*                                                                  1354 04347000
*       IF SSTREDO=REDO THEN        /* ... AND REDO SPECIFIED BY   1354 04348000
*                                      CALLER?                       */ 04349000
         L     @08,@PC00016+8                                      1354 04350000
         CLI   SSTREDO(@08),C'R'                                   1354 04351000
         BNE   @RF01354                                            1354 04352000
*         DO;                       /* YES,                          */ 04353000
*           SSTOK=ON;               /* ADD SYSMOD AS CANDIDATE       */ 04354000
         OI    SSTOK,B'00100000'                                   1356 04355000
*         END;                                                     1357 04356000
*       ELSE                        /*                               */ 04357000
*         DO;                       /* NO,                           */ 04358000
         B     @RC01354                                            1358 04359000
@RF01354 DS    0H                                                  1359 04360000
*           SSTOK=OFF;              /* SKIP THE SYSMOD               */ 04361000
         NI    SSTOK,B'11011111'                                   1359 04362000
*         END;                                                     1360 04363000
*     END;                                                         1361 04364000
@RC01354 DS    0H                                                  1362 04365000
*   IF SSTFOUND=ON                  /*                               */ 04366000
*       &SSTOK=ON THEN              /*                               */ 04367000
@RF01352 TM    SSTFOUND,B'01100000'                                1362 04368000
         BNO   @RF01362                                            1362 04369000
*     DO;                           /*                               */ 04370000
*                                                                  1363 04371000
*       /*************************************************************/ 04372000
*       /*                                                           */ 04373000
*       /* SET STATUS IN THIS RECORD AND ALL SUBSEQUENT RECORDS THAT */ 04374000
*       /* HAVE THE SAME SYSMOD NAME                                 */ 04375000
*       /*                                                           */ 04376000
*       /*************************************************************/ 04377000
*                                                                  1364 04378000
*       GTPFUNCT=GTPSTRTN;          /* FUNCTION IS START NEXT        */ 04379000
         L     @08,@PC00001                                        1364 04380000
         L     @08,TBLXSCGT(,@08)                                  1364 04381000
         MVI   GTPFUNCT(@08),X'06'                                 1364 04382000
*       CALL HMASMGTA(HMASMGTP);    /* POSITION FOR GET NEXT         */ 04383000
         ST    @08,@AL00001                                        1365 04384000
         L     @15,@CV01231                                        1365 04385000
         LA    @01,@AL00001                                        1365 04386000
         BALR  @14,@15                                             1365 04387000
*       DO UNTIL(SSTEOF=ON);        /* SET STATUS UNTIL EOF OR END OF   04388000
*                                      CURRENT SYSMOD                */ 04389000
@DL01366 DS    0H                                                  1367 04390000
*         GTPFUNCT=GTPGETN;         /* GET NEXT RECORD               */ 04391000
         L     @08,@PC00001                                        1367 04392000
         L     @08,TBLXSCGT(,@08)                                  1367 04393000
         MVI   GTPFUNCT(@08),X'08'                                 1367 04394000
*         CALL HMASMGTA(HMASMGTP);  /* ...                           */ 04395000
         ST    @08,@AL00001                                        1368 04396000
         L     @15,@CV01231                                        1368 04397000
         LA    @01,@AL00001                                        1368 04398000
         BALR  @14,@15                                             1368 04399000
*         IF GTPRETRN=GTPEOF THEN   /* END OF FILE?                  */ 04400000
         L     @08,@PC00001                                        1369 04401000
         L     @08,TBLXSCGT(,@08)                                  1369 04402000
         CLI   GTPRETRN(@08),4                                     1369 04403000
         BNE   @RF01369                                            1369 04404000
*           DO;                     /* YES,                          */ 04405000
*             SSTEOF=ON;            /* INDICATE END OF FILE          */ 04406000
         OI    SSTEOF,B'10000000'                                  1371 04407000
*           END;                                                   1372 04408000
*         ELSE                      /* NOT END OF FILE               */ 04409000
*           DO;                     /*                               */ 04410000
         B     @RC01369                                            1373 04411000
@RF01369 DS    0H                                                  1374 04412000
*             IF SCLSMD^=SSTSMD THEN/* RECORD NOT FOR CURRENT SYSMOD?*/ 04413000
         L     @08,@PC00001                                        1374 04414000
         L     @08,TBLXSCGT(,@08)                                  1374 04415000
         L     @08,GTPBUFAD(,@08)                                  1374 04416000
         L     @02,@PC00016                                        1374 04417000
         CLC   SCLSMD(7,@08),SSTSMD(@02)                           1374 04418000
         BE    @RF01374                                            1374 04419000
*               DO;                 /*                               */ 04420000
*                 SSTEOF=ON;        /* LOGICAL EOF SINCE NO MORE   1376 04421000
*                                      RECORDS OR SMD                */ 04422000
         OI    SSTEOF,B'10000000'                                  1376 04423000
*               END;                /*                               */ 04424000
*             ELSE                  /* RECORD FOR THE CURRENT SYSMOD */ 04425000
*               DO;                 /*                               */ 04426000
         B     @RC01374                                            1378 04427000
@RF01374 DS    0H                                                  1379 04428000
*                 SCLSTAT=SCLSTAT|SSTSTAT;/* OR IN STATUS FLAGS      */ 04429000
         L     @08,@PC00001                                        1379 04430000
         L     @08,TBLXSCGT(,@08)                                  1379 04431000
         L     @02,GTPBUFAD(,@08)                                  1379 04432000
         L     @15,@PC00016+4                                      1379 04433000
         OC    SCLSTAT(1,@02),SSTSTAT(@15)                         1379 04434000
*                 GTPFUNCT=GTPADD;  /* ADD RECORD BACK TO THE GTA  1380 04435000
*                                      FILE                          */ 04436000
         MVI   GTPFUNCT(@08),X'04'                                 1380 04437000
*                 CALL HMASMGTA(HMASMGTP);/* ...                     */ 04438000
         ST    @08,@AL00001                                        1381 04439000
         L     @15,@CV01231                                        1381 04440000
         LA    @01,@AL00001                                        1381 04441000
         BALR  @14,@15                                             1381 04442000
*               END;                /*                               */ 04443000
*           END;                    /*                               */ 04444000
@RC01374 DS    0H                                                  1384 04445000
*       END;                        /* END OF PROCESSING ALL ++VERS     04446000
*                                      FOR THE SYSMOD                */ 04447000
@RC01369 DS    0H                                                  1384 04448000
@DE01366 TM    SSTEOF,B'10000000'                                  1384 04449000
         BNO   @DL01366                                            1384 04450000
*     END;                          /*                               */ 04451000
*   ELSE                                                           1386 04452000
*     ;                             /* SYSMOD NOT FOUND IN ANY SCL 1386 04453000
*                                      LIST                          */ 04454000
@RF01362 DS    0H                                                  1387 04455000
*   RETURN CODE(SSTRC);             /* RETURN WITH THE RETURN CODE   */ 04456000
         LR    @15,SSTRC                                           1387 04457000
         L     @14,@SA00016                                        1387 04458000
         LM    @00,@12,@SA00016+8                                  1387 04459000
         BR    @14                                                 1387 04460000
*   RFY                                                            1388 04461000
*     HMASMGTP BASED;                                              1388 04462000
*   RFY                                                            1389 04463000
*     SCLMAP BASED;                                                1389 04464000
*   RFY                                                            1390 04465000
*     TSLPARMS BASED;                                              1390 04466000
*   END SCLSET;                     /*                               */ 04467000
*                                                                  1392 04468000
*   /*****************************************************************/ 04469000
*   /*                                                               */ 04470000
*   /* GETSMDXX -                                                    */ 04471000
*   /*                                                               */ 04472000
*   /*****************************************************************/ 04473000
*                                                                  1392 04474000
*GETSMD:                                                           1392 04475000
*   PROC(GETSIOP,GETSSMD);                                         1392 04476000
GETSMD   STM   @14,@12,@SA00017                                    1392 04477000
         MVC   @PC00017(8),0(@01)                                  1392 04478000
*   DCL                                                            1393 04479000
*     GETSIOP CHAR(*);              /* EXTENDED IOP                  */ 04480000
*   DCL                                                            1394 04481000
*     GETSSMD CHAR(7);              /* SYSMOD NAME                   */ 04482000
*   DCL                                                            1395 04483000
*     GETSMDRC FIXED(15);           /* RETURN CODE                   */ 04484000
*   RFY                                                            1396 04485000
*     HMASMIOP BASED(ADDR(GETSIOP));                               1396 04486000
*   GETSMDRC=ZERO;                  /* CLEAR THE RETURN CODE         */ 04487000
         SLR   GETSMDRC,GETSMDRC                                   1397 04488000
*   IOPDSID=IOPPTS;                 /* DATA SET IS PTS               */ 04489000
         L     @08,@PC00017                                        1398 04490000
         MVI   IOPDSID(@08),X'06'                                  1398 04491000
*   IOPFUNCT=IOPLOC;                /* GET EXTENDED ENTRY ...        */ 04492000
         MVI   IOPFUNCT(@08),X'03'                                 1399 04493000
*   IOPTYPE=IOPSMD;                 /* ... FOR THE SELECTED ...      */ 04494000
         MVI   IOPTYPE(@08),X'0B'                                  1400 04495000
*   IOPNAM17=GETSSMD;               /* ... SYSMOD                    */ 04496000
         L     @03,@PC00017+4                                      1401 04497000
         MVC   IOPNAM17(7,@08),GETSSMD(@03)                        1401 04498000
*   CALL HMASMIO(HMASMIOP);         /* ...                           */ 04499000
         ST    @08,@AL00001                                        1402 04500000
         L     @15,@CV01229                                        1402 04501000
         LA    @01,@AL00001                                        1402 04502000
         BALR  @14,@15                                             1402 04503000
*   GETSMDRC=MAX(GETSMDRC,IOPRETRN);/* SET RETURN CODE               */ 04504000
         L     @08,@PC00017                                        1403 04505000
         SLR   @03,@03                                             1403 04506000
         IC    @03,IOPRETRN(,@08)                                  1403 04507000
         CR    GETSMDRC,@03                                        1403 04508000
         BNL   *+6                                                      04509000
         LR    GETSMDRC,@03                                        1403 04510000
*   RETURN CODE(GETSMDRC);          /* RETURN WITH THE RETURN CODE   */ 04511000
         LR    @15,GETSMDRC                                        1404 04512000
         L     @14,@SA00017                                        1404 04513000
         LM    @00,@12,@SA00017+8                                  1404 04514000
         BR    @14                                                 1404 04515000
*   RFY                                                            1405 04516000
*     HMASMIOP BASED;                                              1405 04517000
*   END GETSMD;                     /*                               */ 04518000
*                                                                  1407 04519000
*   /*****************************************************************/ 04520000
*   /*                                                               */ 04521000
*   /* ADDIFSXX -                                                    */ 04522000
*   /*                                                               */ 04523000
*   /*****************************************************************/ 04524000
*                                                                  1407 04525000
*ADDIFS:                                                           1407 04526000
*   PROC;                                                          1407 04527000
ADDIFS   STM   @14,@12,@SA00018                                    1407 04528000
*   DCL                                                            1408 04529000
*     ADDIRC FIXED(15);             /* RETURN CODE                   */ 04530000
*   DCL                                                            1409 04531000
*     ADDIPTFX FIXED(15);           /* ICT PTF SECTION INDEX         */ 04532000
*   RFY                                                            1410 04533000
*     ICTPTF BASED(CCAICPTF);                                      1410 04534000
*   ADDIRC=ZERO;                    /* CLEAR THE RETURN CODE         */ 04535000
         SLR   ADDIRC,ADDIRC                                       1411 04536000
*   DO ADDIPTFX=1 BY 1              /*                               */ 04537000
*         WHILE(ICTPEND(ADDIPTFX)^=ICTENDNT/*                        */ 04538000
*         &ADDIRC<STOPFUNC);                                       1412 04539000
         LA    ADDIPTFX,1                                          1412 04540000
         B     @DE01412                                            1412 04541000
@DL01412 DS    0H                                                  1413 04542000
*     IF ICTPPASS(ADDIPTFX)=ON THEN /* ICT ENTRY ADDED IN THIS PASS  */ 04543000
         LR    @08,ADDIPTFX                                        1413 04544000
         MH    @08,@CH01757                                        1413 04545000
         L     @05,CCAICPTF(,CCAPTR)                               1413 04546000
         ST    @08,@TF00001                                        1413 04547000
         ALR   @08,@05                                             1413 04548000
         AL    @08,@CF01791                                        1413 04549000
         TM    ICTPPASS-16(@08),B'10000000'                        1413 04550000
         BNO   @RF01413                                            1413 04551000
*       DO;                                                        1414 04552000
*         CALL HMASMTP2(TBLXPARM,   /*                               */ 04553000
*             ADDR(ICTPTF(ADDIPTFX)),/*                              */ 04554000
*             TBLXIOP2->HMASMIOP);                                 1415 04555000
         L     @08,@PC00001                                        1415 04556000
         ST    @08,@AL00001                                        1415 04557000
         L     @02,@TF00001                                        1415 04558000
         AL    @05,@CF01790                                        1415 04559000
         LA    @05,ICTPTF(@02,@05)                                 1415 04560000
         ST    @05,@TF00001                                        1415 04561000
         LA    @05,@TF00001                                        1415 04562000
         ST    @05,@AL00001+4                                      1415 04563000
         L     @08,TBLXIOP2(,@08)                                  1415 04564000
         ST    @08,@AL00001+8                                      1415 04565000
         L     @15,@CV01236                                        1415 04566000
         LA    @01,@AL00001                                        1415 04567000
         BALR  @14,@15                                             1415 04568000
*         RFY                                                      1416 04569000
*           RTNCODE RSTD;                                          1416 04570000
*         IF RTNCODE^=ZERO THEN     /* ERROR OCCURRED?               */ 04571000
         LTR   RTNCODE,RTNCODE                                     1417 04572000
         BZ    @RF01417                                            1417 04573000
*           DO;                                                    1418 04574000
*             ADDIRC=MAX(ADDIRC,RTNCODE);                          1419 04575000
         CR    ADDIRC,RTNCODE                                      1419 04576000
         BNL   *+6                                                      04577000
         LR    ADDIRC,RTNCODE                                      1419 04578000
*             RFY                                                  1420 04579000
*               RTNCODE UNRSTD;                                    1420 04580000
*           END;                                                   1421 04581000
*         ELSE                                                     1422 04582000
*           ;                       /* ++IF DATA ADDED TO INDEX W/O     04583000
*                                      ERROR                         */ 04584000
@RF01417 DS    0H                                                  1423 04585000
*       END;                                                       1423 04586000
*     ELSE                                                         1424 04587000
*       ;                           /* NOT IN THIS PASS              */ 04588000
@RF01413 DS    0H                                                  1425 04589000
*   END;                                                           1425 04590000
         AH    ADDIPTFX,@CH00064                                   1425 04591000
@DE01412 LR    @08,ADDIPTFX                                        1425 04592000
         MH    @08,@CH01757                                        1425 04593000
         L     @05,CCAICPTF(,CCAPTR)                               1425 04594000
         AL    @05,@CF01790                                        1425 04595000
         L     @08,ICTPEND(@08,@05)                                1425 04596000
         CL    @08,ICTENDNT                                        1425 04597000
         BE    @DC01412                                            1425 04598000
         CH    ADDIRC,@CH00033                                     1425 04599000
         BL    @DL01412                                            1425 04600000
@DC01412 DS    0H                                                  1426 04601000
*   RETURN CODE(ADDIRC);            /* RETURN WITH THE RETURN CODE   */ 04602000
         LR    @15,ADDIRC                                          1426 04603000
         L     @14,@SA00018                                        1426 04604000
         LM    @00,@12,@SA00018+8                                  1426 04605000
         BR    @14                                                 1426 04606000
*   RFY                                                            1427 04607000
*     ICTPTF BASED;                                                1427 04608000
*   END ADDIFS;                     /*                               */ 04609000
*                                                                  1429 04610000
*   /*****************************************************************/ 04611000
*   /*                                                               */ 04612000
*   /* VERBLD -                                                      */ 04613000
*   /*                                                               */ 04614000
*   /*****************************************************************/ 04615000
*                                                                  1429 04616000
*VERBLD:                                                           1429 04617000
*   PROC(VRBTYPE,                   /* TYPE OF PROCESSSING           */ 04618000
*       VRBIOP,                     /* EXTENDED IOP                  */ 04619000
*       VRBSCL,                     /* SYSMOD CANDIDATE RECORD       */ 04620000
*       VRBICTP);                   /* ICT PTR TO BE RETURNED        */ 04621000
VERBLD   STM   @14,@12,@SA00019                                    1429 04622000
         MVC   @PC00019(16),0(@01)                                 1429 04623000
*   DCL                                                            1430 04624000
*     VRBTYPE CHAR(1);                                             1430 04625000
*   DCL                                                            1431 04626000
*     VRBIOP CHAR(*);                                              1431 04627000
*   DCL                                                            1432 04628000
*     VRBSCL CHAR(LENGTH(SCLMAP));                                 1432 04629000
*   DCL                                                            1433 04630000
*     VRBICTP PTR(31);                                             1433 04631000
*   DCL                                                            1434 04632000
*     VRBRC FIXED(15);              /* RETURN CODE                   */ 04633000
*   RFY                                                            1435 04634000
*     HMASMIOP BASED(ADDR(VRBIOP));                                1435 04635000
*   RFY                                                            1436 04636000
*     SCLMAP BASED(ADDR(VRBSCL));                                  1436 04637000
*   RFY                                                            1437 04638000
*     ICTPTF BASED(VRBICTP);                                       1437 04639000
*   VRBRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 04640000
         SLR   VRBRC,VRBRC                                         1438 04641000
*                                                                  1439 04642000
*   /*****************************************************************/ 04643000
*   /*                                                               */ 04644000
*   /* CHECK FOR NPRE ERROR CONDITION                                */ 04645000
*   /*                                                               */ 04646000
*   /*****************************************************************/ 04647000
*                                                                  1439 04648000
*   CALL NPRECK(HMASMIOP,SCLVERNO); /* CHECK FOR NPRE ERRORS         */ 04649000
         L     @08,@PC00019+4                                      1439 04650000
         ST    @08,@AL00001                                        1439 04651000
         L     @08,@PC00019+8                                      1439 04652000
         LA    @08,SCLVERNO(,@08)                                  1439 04653000
         ST    @08,@AL00001+4                                      1439 04654000
         LA    @01,@AL00001                                        1439 04655000
         BAL   @14,NPRECK                                          1439 04656000
*   RFY                                                            1440 04657000
*     RTNCODE RSTD;                                                1440 04658000
*   VRBRC=MAX(VRBRC,RTNCODE);       /* SAVE BUILD RETURN CODE        */ 04659000
         CR    VRBRC,RTNCODE                                       1441 04660000
         BNL   *+6                                                      04661000
         LR    VRBRC,RTNCODE                                       1441 04662000
*   RFY                                                            1442 04663000
*     RTNCODE UNRSTD;                                              1442 04664000
*   IF VRBRC=ZERO                   /* ALL IS WELL?                  */ 04665000
*       &VRBTYPE^=DELETE THEN       /* AND NOT DELETE        @Z67SP00*/ 04666000
         LTR   VRBRC,VRBRC                                         1443 04667000
         BNZ   @RF01443                                            1443 04668000
         L     @08,@PC00019                                        1443 04669000
         CLI   VRBTYPE(@08),C'D'                                   1443 04670000
         BE    @RF01443                                            1443 04671000
*     DO;                           /* YES,                          */ 04672000
*                                                                  1444 04673000
*       /*************************************************************/ 04674000
*       /*                                                           */ 04675000
*       /* CHECK FOR DELETE ERROR CONDITION                          */ 04676000
*       /*                                                           */ 04677000
*       /*************************************************************/ 04678000
*                                                                  1445 04679000
*       CALL DELCK(HMASMIOP,SCLVERNO);/* CHECK FOR DEL ERRORS        */ 04680000
         L     @08,@PC00019+4                                      1445 04681000
         ST    @08,@AL00001                                        1445 04682000
         L     @08,@PC00019+8                                      1445 04683000
         LA    @08,SCLVERNO(,@08)                                  1445 04684000
         ST    @08,@AL00001+4                                      1445 04685000
         LA    @01,@AL00001                                        1445 04686000
         BAL   @14,DELCK                                           1445 04687000
*       RFY                                                        1446 04688000
*         RTNCODE RSTD;                                            1446 04689000
*       VRBRC=MAX(VRBRC,RTNCODE);   /* SAVE BUILD RETURN CODE        */ 04690000
         CR    VRBRC,RTNCODE                                       1447 04691000
         BNL   *+6                                                      04692000
         LR    VRBRC,RTNCODE                                       1447 04693000
*       RFY                                                        1448 04694000
*         RTNCODE UNRSTD;                                          1448 04695000
*     END;                                                         1449 04696000
*   IF VRBRC<STOPSMD THEN           /* SYSMOD STILL GO?              */ 04697000
@RF01443 CH    VRBRC,@CH00056                                      1450 04698000
         BNL   @RF01450                                            1450 04699000
*     DO;                           /*                               */ 04700000
*                                                                  1451 04701000
*       /*************************************************************/ 04702000
*       /*                                                           */ 04703000
*       /* BUILD ICT PTF ENTRY FOR SYSMOD                            */ 04704000
*       /*                                                           */ 04705000
*       /*************************************************************/ 04706000
*                                                                  1452 04707000
*       CALL SMDICT(HMASMIOP,SCLMAP,VRBICTP);/*                      */ 04708000
         L     @08,@PC00019+4                                      1452 04709000
         ST    @08,@AL00001                                        1452 04710000
         L     @08,@PC00019+8                                      1452 04711000
         ST    @08,@AL00001+4                                      1452 04712000
         L     @08,@PC00019+12                                     1452 04713000
         ST    @08,@AL00001+8                                      1452 04714000
         LA    @01,@AL00001                                        1452 04715000
         BAL   @14,SMDICT                                          1452 04716000
*       RFY                                                        1453 04717000
*         RTNCODE RSTD;                                            1453 04718000
*       VRBRC=MAX(VRBRC,RTNCODE);   /* SAVE BUILD RETURN CODE        */ 04719000
         CR    VRBRC,RTNCODE                                       1454 04720000
         BNL   *+6                                                      04721000
         LR    VRBRC,RTNCODE                                       1454 04722000
*       RFY                                                        1455 04723000
*         RTNCODE UNRSTD;                                          1455 04724000
*     END;                                                         1456 04725000
*   ELSE                                                           1457 04726000
*     ;                             /* SYSMOD ERROR                  */ 04727000
@RF01450 DS    0H                                                  1458 04728000
*   RETURN CODE(VRBRC);             /* RETURN WITH THE RETURN CODE   */ 04729000
         LR    @15,VRBRC                                           1458 04730000
         L     @14,@SA00019                                        1458 04731000
         LM    @00,@12,@SA00019+8                                  1458 04732000
         BR    @14                                                 1458 04733000
*   RFY                                                            1459 04734000
*     HMASMIOP BASED;                                              1459 04735000
*   RFY                                                            1460 04736000
*     SCLMAP BASED;                                                1460 04737000
*   RFY                                                            1461 04738000
*     ICTPTF BASED;                                                1461 04739000
*   END VERBLD;                     /*                               */ 04740000
*                                                                  1463 04741000
*   /*****************************************************************/ 04742000
*   /*                                                               */ 04743000
*   /* VERDELCK -                                                    */ 04744000
*   /*                                                               */ 04745000
*   /*****************************************************************/ 04746000
*                                                                  1463 04747000
*VERDELCK:                                                         1463 04748000
*   PROC(VDCIOP,                    /* EXTENDED IOP                  */ 04749000
*       VDCSCL);                    /* SYSMOD CANDIDATE RECORD       */ 04750000
VERDELCK STM   @14,@12,@SA00020                                    1463 04751000
         MVC   @PC00020(8),0(@01)                                  1463 04752000
*   DCL                                                            1464 04753000
*     VDCIOP CHAR(*);                                              1464 04754000
*   DCL                                                            1465 04755000
*     VDCSCL CHAR(LENGTH(SCLMAP));                                 1465 04756000
*   DCL                                                            1466 04757000
*     VDCFMID@ PTR(31);             /* PTR TO ++VER FMID OPERAND   1466 04758000
*                                      VALUE                         */ 04759000
*   DCL                                                            1467 04760000
*     VDCRC FIXED(15);              /* RETURN CODE                   */ 04761000
*   DCL                                                            1468 04762000
*     GOCODE FIXED(15) CONSTANT(0); /* DELETE OK RETURN CODE VALUE   */ 04763000
*   DCL                                                            1469 04764000
*     SKIPCODE FIXED(15) CONSTANT(4);/* SKIP THIS ++VER BECAUSE IT 1469 04765000
*                                      DOES NOT MATCH THE DELETE   1469 04766000
*                                      ENVIRONMENT                   */ 04767000
*   RFY                                                            1470 04768000
*     HMASMIOP BASED(ADDR(VDCIOP));                                1470 04769000
*   RFY                                                            1471 04770000
*     HMASMGTP BASED(TBLXSEGT);                                    1471 04771000
*   RFY                                                            1472 04772000
*     HMASMSET BASED(GTPBUFAD);                                    1472 04773000
*   RFY                                                            1473 04774000
*     TSLPARMS BASED(TBLXTSLP);                                    1473 04775000
*   RFY                                                            1474 04776000
*     SCLMAP BASED(ADDR(VDCSCL));                                  1474 04777000
*   VDCRC=SKIPCODE;                 /* ASSUME SYSMOD NOT TO BE     1475 04778000
*                                      PROCESSED                     */ 04779000
*                                                                  1475 04780000
         LA    VDCRC,4                                             1475 04781000
*   /*****************************************************************/ 04782000
*   /*                                                               */ 04783000
*   /* CHECK TO SEE IF THE FMID, IF ANY, ON THE ++VER IS IN THE      */ 04784000
*   /* 'CURRENT DELETE EVIRONMENT', I.E. IN THE SELECT LIST OR IN THE*/ 04785000
*   /* (A)CDS                                                        */ 04786000
*   /*                                                               */ 04787000
*   /*****************************************************************/ 04788000
*                                                                  1476 04789000
*   IF IOPFLF^=ON THEN              /* NOT A 1ST LEVEL FUNCTION?     */ 04790000
         L     @08,@PC00020                                        1476 04791000
         TM    IOPFLF(@08),B'00100000'                             1476 04792000
         BO    @RF01476                                            1476 04793000
*     DO;                                                          1477 04794000
*       TSLENTSR=''B;               /* CLEAR TSB PARMLIST            */ 04795000
         L     @05,@PC00001                                        1478 04796000
         L     @05,TBLXTSLP(,@05)                                  1478 04797000
         L     @02,TSLPMLAD(,@05)                                  1478 04798000
         XC    TSLENTSR(16,@02),TSLENTSR(@02)                      1478 04799000
*       TSLEBGNP=ADDR(IOPPTFVR);    /* BEGINNING OF SEARCH PTR       */ 04800000
         LA    @08,IOPPTFVR(,@08)                                  1479 04801000
         ST    @08,TSLEBGNP(,@02)                                  1479 04802000
*       TSLFUNCT=TSLFENSR;          /* FUNCTION IS SEARCH IOP      1480 04803000
*                                      SUB-ENTRY                     */ 04804000
         MVI   TSLFUNCT(@05),X'06'                                 1480 04805000
*       TSLETYPE=IOPPFID;           /* TYPE IS DELETE ENTRY          */ 04806000
         MVI   TSLETYPE(@02),X'A7'                                 1481 04807000
*       TSLEVER#=SCLVERNO;          /* ++VER NUMBER                  */ 04808000
         L     @08,@PC00020+4                                      1482 04809000
         MVC   TSLEVER#(1,@02),SCLVERNO(@08)                       1482 04810000
*       CALL HMASMTSB(TSLPARMS);    /* FIND THE FMID FOR INPUTED VER    04811000
*                                      #                             */ 04812000
         ST    @05,@AL00001                                        1483 04813000
         L     @15,@CV01237                                        1483 04814000
         LA    @01,@AL00001                                        1483 04815000
         BALR  @14,@15                                             1483 04816000
*       RFY                                                        1484 04817000
*         RTNCODE RSTD;                                            1484 04818000
*       VDCFMID@=TSLEFNDP;          /* PTR TO FMID FOUND             */ 04819000
         L     @14,@PC00001                                        1485 04820000
         L     @08,TBLXTSLP(,@14)                                  1485 04821000
         L     @08,TSLPMLAD(,@08)                                  1485 04822000
         L     VDCFMID@,TSLEFNDP(,@08)                             1485 04823000
*       IF RTNCODE=ZERO THEN        /* FMID FOUND?                   */ 04824000
         LTR   RTNCODE,RTNCODE                                     1486 04825000
         BNZ   @RF01486                                            1486 04826000
*         DO;                                                      1487 04827000
*                                                                  1487 04828000
*           /*********************************************************/ 04829000
*           /*                                                       */ 04830000
*           /* LOCATE THE FMID SYSMOD IN THE SET AND SEE IF IT IS IN */ 04831000
*           /* THE SELECT LIST                                       */ 04832000
*           /*                                                       */ 04833000
*           /*********************************************************/ 04834000
*                                                                  1488 04835000
*           SESMD=ON;               /* TYPE IS SYSMOD                */ 04836000
         L     @14,TBLXSEGT(,@14)                                  1488 04837000
         L     @08,GTPBUFAD(,@14)                                  1488 04838000
         OI    SESMD(@08),B'00000001'                              1488 04839000
*           SENAME=VDCFMID@->BASEDSMD;/* NAME IS FMID NAME           */ 04840000
         MVI   SENAME+7(@08),C' '                                  1489 04841000
         MVC   SENAME(7,@08),BASEDSMD(VDCFMID@)                    1489 04842000
*           GTPFUNCT=GTPLOC;        /* DO THE LOCATE                 */ 04843000
         MVI   GTPFUNCT(@14),X'03'                                 1490 04844000
*           CALL HMASMGTA(HMASMGTP);                               1491 04845000
         ST    @14,@AL00001                                        1491 04846000
         L     @15,@CV01231                                        1491 04847000
         LA    @01,@AL00001                                        1491 04848000
         BALR  @14,@15                                             1491 04849000
*           IF GTPRETRN=GTPGOOD THEN/* WAS THE FUNCTION FOUND?       */ 04850000
         L     @14,@PC00001                                        1492 04851000
         L     @14,TBLXSEGT(,@14)                                  1492 04852000
         CLI   GTPRETRN(@14),0                                     1492 04853000
         BNE   @RF01492                                            1492 04854000
*             DO;                                                  1493 04855000
*               VDCRC=GOCODE;       /* WE HAVE A LIVE DELETOR        */ 04856000
         SLR   VDCRC,VDCRC                                         1494 04857000
*             END;                                                 1495 04858000
*           ELSE                    /* NOT IN SELECT LIST, CHECK   1496 04859000
*                                      (A)CDS                        */ 04860000
*             DO;                                                  1496 04861000
         B     @RC01492                                            1496 04862000
@RF01492 DS    0H                                                  1497 04863000
*               TSLSICDS=''B;       /* CLEAR PARM LIST               */ 04864000
         L     @14,@PC00001                                        1497 04865000
         L     @08,TBLXTSLP(,@14)                                  1497 04866000
         L     @02,TSLPMLAD(,@08)                                  1497 04867000
         XC    TSLSICDS(20,@02),TSLSICDS(@02)                      1497 04868000
*               TSLFUNCT=TSLFICSR;  /* SEARCH FOR SYSMOD ON THE CDS  */ 04869000
         MVI   TSLFUNCT(@08),X'04'                                 1498 04870000
*               TSLSOCDS=ON;        /* SEARCH THE (A)CDS             */ 04871000
         OI    TSLSOCDS(@02),B'01000000'                           1499 04872000
*               TSLSIOPP=ADDR(TBLXIOPF);                           1500 04873000
         LA    @14,TBLXIOPF(,@14)                                  1500 04874000
         ST    @14,TSLSIOPP(,@02)                                  1500 04875000
*               CALL HMASMTSB(TSLPARMS);                           1501 04876000
         ST    @08,@AL00001                                        1501 04877000
         L     @15,@CV01237                                        1501 04878000
         LA    @01,@AL00001                                        1501 04879000
         BALR  @14,@15                                             1501 04880000
*               IF TSLRETRN^=TSLFOUND THEN                         1502 04881000
         L     @14,@PC00001                                        1502 04882000
         L     @14,TBLXTSLP(,@14)                                  1502 04883000
         CLI   TSLRETRN(@14),0                                     1502 04884000
         BE    @RF01502                                            1502 04885000
*                 DO;                                              1503 04886000
*                   VDCRC=MAX(VDCRC,TSLRETRN);/* SAVE RETURN CODE    */ 04887000
         SLR   @08,@08                                             1504 04888000
         IC    @08,TSLRETRN(,@14)                                  1504 04889000
         CR    VDCRC,@08                                           1504 04890000
         BNL   *+6                                                      04891000
         LR    VDCRC,@08                                           1504 04892000
*                 END;                                             1505 04893000
*               ELSE                /* FMID WAS FOUND ON CDS         */ 04894000
*                 DO;                                              1506 04895000
         B     @RC01502                                            1506 04896000
@RF01502 DS    0H                                                  1507 04897000
*                   IF TSLSCOK=ON   /* FMID OK ...                   */ 04898000
*                       |TSLSCSUP=ON THEN/* OR SUP'ED                */ 04899000
         L     @14,@PC00001                                        1507 04900000
         L     @14,TBLXTSLP(,@14)                                  1507 04901000
         L     @14,TSLPMLAD(,@14)                                  1507 04902000
         TM    TSLSCOK(@14),B'01100000'                            1507 04903000
         BZ    @RF01507                                            1507 04904000
*                     DO;                                          1508 04905000
*                                                                  1508 04906000
*                       /*********************************************/ 04907000
*                       /*                                           */ 04908000
*                       /* ???? SUP'ED ????                          */ 04909000
*                       /*                                           */ 04910000
*                       /*********************************************/ 04911000
*                                                                  1509 04912000
*                       VDCRC=GOCODE;/* WE HAVE A LIVE DELETOR       */ 04913000
         SLR   VDCRC,VDCRC                                         1509 04914000
*                     END;                                         1510 04915000
*                   ELSE            /* NOT IN AN APPROPRIATE STATE   */ 04916000
*                     DO;                                          1511 04917000
         B     @RC01507                                            1511 04918000
@RF01507 DS    0H                                                  1512 04919000
*                     END;                                         1512 04920000
*                 END;                                             1513 04921000
*             END;                                                 1514 04922000
*         END;                                                     1515 04923000
*       ELSE                                                       1516 04924000
*         ;                         /* FMID NOT FOUND                */ 04925000
@RF01486 DS    0H                                                  1517 04926000
*     END;                                                         1517 04927000
*   ELSE                            /* 1ST LEVEL FUNCTION            */ 04928000
*     DO;                                                          1518 04929000
         B     @RC01476                                            1518 04930000
@RF01476 DS    0H                                                  1519 04931000
*       VDCRC=GOCODE;               /* PROCESS THE SYSMOD RC         */ 04932000
         SLR   VDCRC,VDCRC                                         1519 04933000
*     END;                                                         1520 04934000
*   RETURN CODE(VDCRC);             /* RETURN WITH THE RETURN CODE   */ 04935000
@RC01476 LR    @15,VDCRC                                           1521 04936000
         L     @14,@SA00020                                        1521 04937000
         LM    @00,@12,@SA00020+8                                  1521 04938000
         BR    @14                                                 1521 04939000
*   RFY                                                            1522 04940000
*     HMASMIOP BASED;                                              1522 04941000
*   RFY                                                            1523 04942000
*     HMASMGTP BASED;                                              1523 04943000
*   RFY                                                            1524 04944000
*     HMASMSET BASED;                                              1524 04945000
*   RFY                                                            1525 04946000
*     TSLPARMS BASED;                                              1525 04947000
*   RFY                                                            1526 04948000
*     SCLMAP BASED;                                                1526 04949000
*   END VERDELCK;                   /*                               */ 04950000
*                                                                  1528 04951000
*   /*****************************************************************/ 04952000
*   /*                                                               */ 04953000
*   /* LOCNXT -                                                      */ 04954000
*   /*                                                               */ 04955000
*   /*****************************************************************/ 04956000
*                                                                  1528 04957000
*LOCNXT:                                                           1528 04958000
*   PROC(LNXIOP,                    /* EXTENDED IOP TO CONTAIN THE 1528 04959000
*                                      PTS SYSMOD ENTRY              */ 04960000
*       LNXLST,                     /* SCL LIST NAME TO PROCESS    1528 04961000
*                                      (CHAR(1))                     */ 04962000
*       LNXCKEY@);                  /* ADDRESS OF KEY                */ 04963000
LOCNXT   STM   @14,@12,@SA00021                                    1528 04964000
         MVC   @PC00021(12),0(@01)                                 1528 04965000
*   DCL                                                            1529 04966000
*     LNXIOP CHAR(*);               /* EXTENDED IOP                  */ 04967000
*   DCL                                                            1530 04968000
*     LNXLST CHAR(1);               /* LIST NAME                     */ 04969000
*   DCL                                                            1531 04970000
*     LNXCKEY@ PTR(31);             /* ADDRESS OF KEY                */ 04971000
*   DCL                                                            1532 04972000
*     LNXCSCL CHAR(LENGTH(SCLMAP)); /* SCL GOTTEN BY GETNLSMD        */ 04973000
*   DCL                                                            1533 04974000
*     LNXRC FIXED(15);              /* RETURN CODE                   */ 04975000
*   RFY                                                            1534 04976000
*     HMASMIOP BASED(ADDR(LNXIOP));                                1534 04977000
*   RFY                                                            1535 04978000
*     SCLMAP BASED(TBLXSCGT->GTPBUFAD);                            1535 04979000
*   LNXRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 04980000
         SLR   LNXRC,LNXRC                                         1536 04981000
*   CALL GETNLSMD(LNXLST,           /* GET NEXT FROM LIST            */ 04982000
*       LNXCKEY@,                   /* PREV/NEXT KEY PTR             */ 04983000
*       LNXCSCL);                   /* ...                           */ 04984000
         L     @14,@PC00021+4                                      1537 04985000
         ST    @14,@AL00001                                        1537 04986000
         L     @14,@PC00021+8                                      1537 04987000
         ST    @14,@AL00001+4                                      1537 04988000
         LA    @14,LNXCSCL                                         1537 04989000
         ST    @14,@AL00001+8                                      1537 04990000
         LA    @01,@AL00001                                        1537 04991000
         BAL   @14,GETNLSMD                                        1537 04992000
*   RFY                                                            1538 04993000
*     RTNCODE RSTD;                                                1538 04994000
*   IF RTNCODE=PTFWARN THEN         /* END OF FILE/LIST ?            */ 04995000
         LA    @14,4                                               1539 04996000
         CR    RTNCODE,@14                                         1539 04997000
         BNE   @RF01539                                            1539 04998000
*     DO;                           /*                               */ 04999000
*       RFY                                                        1541 05000000
*         RTNCODE UNRSTD;                                          1541 05001000
*       LNXRC=GTPEOF;               /* END OF LIST RETURN CODE       */ 05002000
         LR    LNXRC,@14                                           1542 05003000
*     END;                          /*                               */ 05004000
*   ELSE                            /* L1 LIST ENTRY GOTTEN          */ 05005000
*     DO;                           /*                               */ 05006000
         B     @RC01539                                            1544 05007000
@RF01539 DS    0H                                                  1545 05008000
*       IF SCLCAND=ON THEN          /* IS LIST ENTRY A CANDIDATE?    */ 05009000
         L     @08,@PC00001                                        1545 05010000
         L     @08,TBLXSCGT(,@08)                                  1545 05011000
         L     @08,GTPBUFAD(,@08)                                  1545 05012000
         TM    SCLCAND(@08),B'00100000'                            1545 05013000
         BNO   @RF01545                                            1545 05014000
*         DO;                       /* YES,                          */ 05015000
*                                                                  1546 05016000
*           /*********************************************************/ 05017000
*           /*                                                       */ 05018000
*           /* GET SYSMOD ENTRY FROM THE PTS                         */ 05019000
*           /*                                                       */ 05020000
*           /*********************************************************/ 05021000
*                                                                  1547 05022000
*           CALL GETSMD(HMASMIOP,SCLSMD);                          1547 05023000
         L     @02,@PC00021                                        1547 05024000
         ST    @02,@AL00001                                        1547 05025000
         LA    @08,SCLSMD(,@08)                                    1547 05026000
         ST    @08,@AL00001+4                                      1547 05027000
         LA    @01,@AL00001                                        1547 05028000
         BAL   @14,GETSMD                                          1547 05029000
*           RFY                                                    1548 05030000
*             RTNCODE RSTD;                                        1548 05031000
*           LNXRC=MAX(LNXRC,RTNCODE);                              1549 05032000
         CR    LNXRC,RTNCODE                                       1549 05033000
         BNL   *+6                                                      05034000
         LR    LNXRC,RTNCODE                                       1549 05035000
*           RFY                                                    1550 05036000
*             RTNCODE UNRSTD;                                      1550 05037000
*         END;                      /*                               */ 05038000
*       ELSE                                                       1552 05039000
*         ;                         /* SKIP THIS ENTRY               */ 05040000
@RF01545 DS    0H                                                  1553 05041000
*     END;                          /*                               */ 05042000
*   RETURN CODE(LNXRC);             /* RETURN WITH THE RETURN CODE   */ 05043000
@RC01539 LR    @15,LNXRC                                           1554 05044000
         L     @14,@SA00021                                        1554 05045000
         LM    @00,@12,@SA00021+8                                  1554 05046000
         BR    @14                                                 1554 05047000
*   RFY                                                            1555 05048000
*     HMASMIOP BASED;                                              1555 05049000
*   RFY                                                            1556 05050000
*     SCLMAP BASED;                                                1556 05051000
*   END LOCNXT;                     /*                               */ 05052000
*                                                                  1558 05053000
*   /*****************************************************************/ 05054000
*   /*                                                               */ 05055000
*   /* SMDICT -                                                      */ 05056000
*   /*                                                               */ 05057000
*   /*****************************************************************/ 05058000
*                                                                  1558 05059000
*SMDICT:                            /*                               */ 05060000
*   PROC(SMIIOP,                    /* PTS EXTENDED IOP              */ 05061000
*       SMISCL,                     /* SCL RECORD                    */ 05062000
*       SMIICTP);                   /* (OUTPUT) PTR TO ICT ENTRY   1558 05063000
*                                      CREATED                       */ 05064000
SMDICT   STM   @14,@12,@SA00022                                    1558 05065000
         MVC   @PC00022(12),0(@01)                                 1558 05066000
*   DCL                                                            1559 05067000
*     SMIIOP CHAR(*);               /* PTS EXTENDED IOP              */ 05068000
*   DCL                                                            1560 05069000
*     SMISCL CHAR(LENGTH(SCLMAP));  /* SCL RECORD                    */ 05070000
*   DCL                                                            1561 05071000
*     SMIICTP PTR(31);              /* (OUTPUT) PTR TO ICT ENTRY   1561 05072000
*                                      CREATED                       */ 05073000
*   DCL                                                            1562 05074000
*     SMIRC FIXED(15);              /* LOCAL RETURN CODE             */ 05075000
*   RFY                                                            1563 05076000
*     HMASMIOP BASED(ADDR(SMIIOP));                                1563 05077000
*   RFY                                                            1564 05078000
*     SCLMAP BASED(ADDR(SMISCL));                                  1564 05079000
*   RFY                                                            1565 05080000
*     ICTPTF BASED(SMIICTP);                                       1565 05081000
*   SMIRC=ZERO;                     /*                               */ 05082000
         SLR   SMIRC,SMIRC                                         1566 05083000
*   SMIICTP=TBLXTOP;                /* ADDRESS OF PTF ENTRY          */ 05084000
         L     @08,@PC00022+8                                      1567 05085000
         L     @02,@PC00001                                        1567 05086000
         MVC   SMIICTP(4,@08),TBLXTOP(@02)                         1567 05087000
*   CALL HMASMTPC(TBLXPARM,         /* TBLX                          */ 05088000
*       HMASMIOP,                   /* SYSMOD PTS ENTRY              */ 05089000
*       SCLVERNO,                   /* ++VER INDEX                   */ 05090000
*       ZERO,                       /* CREATE ICT ENTRY              */ 05091000
*       TBLXIOP2->HMASMIOP);        /* IOP FOR MCB                   */ 05092000
         ST    @02,@AL00001                                        1568 05093000
         L     @08,@PC00022                                        1568 05094000
         ST    @08,@AL00001+4                                      1568 05095000
         L     @08,@PC00022+4                                      1568 05096000
         LA    @08,SCLVERNO(,@08)                                  1568 05097000
         ST    @08,@AL00001+8                                      1568 05098000
         LA    @08,@CF00082                                        1568 05099000
         ST    @08,@AL00001+12                                     1568 05100000
         L     @08,TBLXIOP2(,@02)                                  1568 05101000
         ST    @08,@AL00001+16                                     1568 05102000
         L     @15,@CV01238                                        1568 05103000
         LA    @01,@AL00001                                        1568 05104000
         BALR  @14,@15                                             1568 05105000
*   RFY                                                            1569 05106000
*     RTNCODE RSTD;                                                1569 05107000
*   SMIRC=MAX(SMIRC,RTNCODE);       /*                               */ 05108000
         CR    SMIRC,RTNCODE                                       1570 05109000
         BNL   *+6                                                      05110000
         LR    SMIRC,RTNCODE                                       1570 05111000
*   RFY                                                            1571 05112000
*     RTNCODE UNRSTD;                                              1571 05113000
*   IF SMIRC<STOPSMD THEN           /* SYSMOD STILL GO?              */ 05114000
         CH    SMIRC,@CH00056                                      1572 05115000
         BNL   @RF01572                                            1572 05116000
*     DO;                           /* YES,                          */ 05117000
*       IF IOPFLF(1)=ON THEN        /* THIS IS A 1ST LEVEL FUNCTION  */ 05118000
         L     @08,@PC00022                                        1574 05119000
         TM    IOPFLF(@08),B'00100000'                             1574 05120000
         BNO   @RF01574                                            1574 05121000
*         ICTFLF(1)=ON;             /* ...                           */ 05122000
         L     @08,@PC00022+8                                      1575 05123000
         L     @08,SMIICTP(,@08)                                   1575 05124000
         OI    ICTFLF(@08),B'00100000'                             1575 05125000
*       IF SCLSELST=ON THEN         /* COPY IN SELECT ...            */ 05126000
@RF01574 L     @08,@PC00022+4                                      1576 05127000
         TM    SCLSELST(@08),B'01000000'                           1576 05128000
         BNO   @RF01576                                            1576 05129000
*         ICTPSLST(1)=ON;           /* ... LIST FLAG TO ICT          */ 05130000
         L     @08,@PC00022+8                                      1577 05131000
         L     @08,SMIICTP(,@08)                                   1577 05132000
         OI    ICTPSLST(@08),B'00000010'                           1577 05133000
*       IF SCLREDO=ON THEN          /* COPY REAPPLY FLAG ....        */ 05134000
@RF01576 L     @08,@PC00022+4                                      1578 05135000
         TM    SCLREDO(@08),B'00010000'                            1578 05136000
         BNO   @RF01578                                            1578 05137000
*         ICTPREDO(1)=ON;           /* RE APPLICATION                */ 05138000
         L     @08,@PC00022+8                                      1579 05139000
         L     @08,SMIICTP(,@08)                                   1579 05140000
         OI    ICTPREDO(@08),B'01000000'                           1579 05141000
*       SMIICTP->ICTPPASS(1)=ON;    /* SYSMOD ADDED IN THIS PASS     */ 05142000
@RF01578 L     @08,@PC00022+8                                      1580 05143000
         L     @08,SMIICTP(,@08)                                   1580 05144000
         OI    ICTPPASS(@08),B'10000000'                           1580 05145000
*     END;                                                         1581 05146000
*   ELSE                                                           1582 05147000
*     ;                             /* ERROR                         */ 05148000
@RF01572 DS    0H                                                  1583 05149000
*   RETURN CODE(SMIRC);             /*                               */ 05150000
         LR    @15,SMIRC                                           1583 05151000
         L     @14,@SA00022                                        1583 05152000
         LM    @00,@12,@SA00022+8                                  1583 05153000
         BR    @14                                                 1583 05154000
*   RFY                                                            1584 05155000
*     HMASMIOP BASED;                                              1584 05156000
*   RFY                                                            1585 05157000
*     SCLMAP BASED;                                                1585 05158000
*   RFY                                                            1586 05159000
*     ICTPTF BASED;                                                1586 05160000
*   END SMDICT;                     /*                               */ 05161000
*                                                                  1588 05162000
*   /*****************************************************************/ 05163000
*   /*                                                               */ 05164000
*   /* FUNCFM - ISSUE SMP FUNCTION HALTED BECAUSE APPLICABLE FUNCTION*/ 05165000
*   /* SYSMOD FAILED                                                 */ 05166000
*   /*                                                               */ 05167000
*   /*****************************************************************/ 05168000
*                                                                  1588 05169000
*FUNCFM:                                                           1588 05170000
*   PROC(FFMSMD);                                                  1588 05171000
FUNCFM   STM   @14,@12,@SA00023                                    1588 05172000
         MVC   @PC00023(4),0(@01)                                  1588 05173000
*   DCL                                                            1589 05174000
*     FFMSMD CHAR(7);               /* FUNCTION NAME THAT FAILED     */ 05175000
*                                                                  1589 05176000
*   /*****************************************************************/ 05177000
*   /*                                                               */ 05178000
*   /* ISSUE MESSAGE 'HMA370I XXXXXXXX PROCESSING TERMINATED BECAUSE */ 05179000
*   /* FUNCTION SYSMOD XXXXXXX FAILED'                               */ 05180000
*   /*                                                               */ 05181000
*   /*****************************************************************/ 05182000
*                                                                  1590 05183000
*   DO;                             /* HMASMPMG M1(HMA370I)TYPE(SEV)V   05184000
*                                      AR(TBLXFUNC,FFMSMD)TARGET(SYSO   05185000
*                                      UT,LOG)                       */ 05186000
*     HMASMMGP=HMASMMGP&&HMASMMGP;  /* SET PARMS TO ZEROS            */ 05187000
         XC    HMASMMGP(28),HMASMMGP                               1591 05188000
*     MGPMGNO1=HMA370I;             /* SET UP MSG 1 CODE             */ 05189000
         MVC   MGPMGNO1(2),@CH01243                                1592 05190000
*     MGPTYPE=MGPSEV;               /* SET MESSAGE TYPE              */ 05191000
         MVI   MGPTYPE,X'04'                                       1593 05192000
*     MGPPRINT='1'B;                /* SET TARGET FLAG               */ 05193000
*     MGPHLDS='1'B;                 /* SET TARGET FLAG               */ 05194000
         OI    MGPPRINT,B'10010000'                                1595 05195000
*     MGPVARPT(1)=ADDR(TBLXFUNC);   /* SET VARIABLE PTR              */ 05196000
         L     @08,@PC00001                                        1596 05197000
         LA    @08,TBLXFUNC(,@08)                                  1596 05198000
         ST    @08,MGPVARPT                                        1596 05199000
*     MGPVARPT(2)=ADDR(FFMSMD);     /* SET VARIABLE PTR              */ 05200000
         L     @08,@PC00023                                        1597 05201000
         ST    @08,MGPVARPT+4                                      1597 05202000
*     CALL HMASMMSG(HMASMMGP);      /* HAVE MESSAGE ISSUED           */ 05203000
         L     @15,@CV01230                                        1598 05204000
         LA    @01,@AL01598                                        1598 05205000
         BALR  @14,@15                                             1598 05206000
*   END;                            /*                               */ 05207000
*   RETURN CODE(ZERO);                                             1600 05208000
         SLR   @15,@15                                             1600 05209000
         L     @14,@SA00023                                        1600 05210000
         LM    @00,@12,@SA00023+8                                  1600 05211000
         BR    @14                                                 1600 05212000
*   END FUNCFM;                                                    1601 05213000
*                                                                  1602 05214000
*   /*****************************************************************/ 05215000
*   /*                                                               */ 05216000
*   /* APPLVER - CHECK TO SEE IF THE FMID IN THE SCL RECORD PASSED IS*/ 05217000
*   /* IS IN THE 'CURRENT ENVIRONMENT'                               */ 05218000
*   /*                                                               */ 05219000
*   /*****************************************************************/ 05220000
*                                                                  1602 05221000
*APPLVER:                                                          1602 05222000
*   PROC(APVSCL);                                                  1602 05223000
APPLVER  STM   @14,@12,@SA00024                                    1602 05224000
         MVC   @PC00024(4),0(@01)                                  1602 05225000
*   DCL                                                            1603 05226000
*     APVSCL CHAR(*);               /* SCL FOR THE SYSMOD            */ 05227000
*   DCL                                                            1604 05228000
*     NOAPPLCD FIXED(15) CONSTANT(4);/* NOT APPLICABLE RC            */ 05229000
*   DCL                                                            1605 05230000
*     APVRC FIXED(15);                                             1605 05231000
*   RFY                                                            1606 05232000
*     SCLMAP BASED(ADDR(APVSCL));                                  1606 05233000
*   RFY                                                            1607 05234000
*     TSLPARMS BASED(TBLXTSLP);                                    1607 05235000
*   APVRC=ZERO;                     /* CLEAR RETURN CODE             */ 05236000
         SLR   APVRC,APVRC                                         1608 05237000
*   TSLSICDS=''B;                   /* CLEAR PARMLIST                */ 05238000
         L     @08,@PC00001                                        1609 05239000
         L     @08,TBLXTSLP(,@08)                                  1609 05240000
         L     @03,TSLPMLAD(,@08)                                  1609 05241000
         XC    TSLSICDS(20,@03),TSLSICDS(@03)                      1609 05242000
*   TSLFUNCT=TSLFICSR;              /* SEARCH ICT AND CDS            */ 05243000
         MVI   TSLFUNCT(@08),X'04'                                 1610 05244000
*   TSLSSMD=SCLFMID;                /* ... FOR THE FMID ON THE SYSMOD   05245000
*                                      ...                           */ 05246000
         L     @15,@PC00024                                        1611 05247000
         MVC   TSLSSMD(7,@03),SCLFMID(@15)                         1611 05248000
*   TSLSOPTF=''B;                   /* ...                           */ 05249000
         MVI   TSLSOPTF(@03),X'00'                                 1612 05250000
*   TSLSOICT=ON;                    /* ...                           */ 05251000
*   TSLSOCDS=ON;                    /* ...                           */ 05252000
         OI    TSLSOICT(@03),B'11000000'                           1614 05253000
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */ 05254000
         ST    @08,@AL00001                                        1615 05255000
         L     @15,@CV01237                                        1615 05256000
         LA    @01,@AL00001                                        1615 05257000
         BALR  @14,@15                                             1615 05258000
*   IF TSLRETRN>TSLNTFND THEN                                      1616 05259000
         L     @08,@PC00001                                        1616 05260000
         L     @08,TBLXTSLP(,@08)                                  1616 05261000
         CLI   TSLRETRN(@08),4                                     1616 05262000
         BNH   @RF01616                                            1616 05263000
*     DO;                                                          1617 05264000
*       APVRC=MAX(APVRC,TSLRETRN);                                 1618 05265000
         SLR   @03,@03                                             1618 05266000
         IC    @03,TSLRETRN(,@08)                                  1618 05267000
         CR    APVRC,@03                                           1618 05268000
         BNL   *+6                                                      05269000
         LR    APVRC,@03                                           1618 05270000
*     END;                                                         1619 05271000
*   ELSE                            /* NO ERROR                      */ 05272000
*     DO;                                                          1620 05273000
         B     @RC01616                                            1620 05274000
@RF01616 DS    0H                                                  1621 05275000
*       IF TSLRETRN=TSLNTFND THEN                                  1621 05276000
         L     @08,@PC00001                                        1621 05277000
         L     @08,TBLXTSLP(,@08)                                  1621 05278000
         CLI   TSLRETRN(@08),4                                     1621 05279000
         BNE   @RF01621                                            1621 05280000
*         DO;                                                      1622 05281000
*           APVRC=NOAPPLCD;                                        1623 05282000
         LA    APVRC,4                                             1623 05283000
*         END;                                                     1624 05284000
*       ELSE                        /* FMID FOUND IN THE ICT OR    1625 05285000
*                                      (A)CDS                        */ 05286000
*         DO;                                                      1625 05287000
         B     @RC01621                                            1625 05288000
@RF01621 DS    0H                                                  1626 05289000
*           IF TSLSIOK=ON           /* EITHER IN ICT OK ...          */ 05290000
*               |TSLSISUP=ON        /* ... OR SUP'ED ...             */ 05291000
*               |TSLSCOK=ON         /* OR ON CDS OK ...              */ 05292000
*               |TSLSCSUP=ON        /* ... OR SUP'ED ?               */ 05293000
*             THEN                                                 1626 05294000
         L     @08,@PC00001                                        1626 05295000
         L     @08,TBLXTSLP(,@08)                                  1626 05296000
         L     @08,TSLPMLAD(,@08)                                  1626 05297000
         TM    TSLSIOK(@08),B'01100000'                            1626 05298000
         BNZ   @RT01626                                            1626 05299000
         TM    TSLSCOK(@08),B'01100000'                            1626 05300000
         BZ    @RF01626                                            1626 05301000
@RT01626 DS    0H                                                  1627 05302000
*             DO;                                                  1627 05303000
*               APVRC=ZERO;         /* THIS ++VER FOR SYSMOD IS    1628 05304000
*                                      APPLICABLE TO THE CURRENT   1628 05305000
*                                      ENVIRONMENT                   */ 05306000
         SLR   APVRC,APVRC                                         1628 05307000
*             END;                                                 1629 05308000
*           ELSE                    /* FOUND IN WRONG STATE          */ 05309000
*             DO;                                                  1630 05310000
         B     @RC01626                                            1630 05311000
@RF01626 DS    0H                                                  1631 05312000
*               APVRC=NOAPPLCD;                                    1631 05313000
         LA    APVRC,4                                             1631 05314000
*             END;                                                 1632 05315000
*         END;                                                     1633 05316000
@RC01626 DS    0H                                                  1634 05317000
*     END;                                                         1634 05318000
@RC01621 DS    0H                                                  1635 05319000
*   RETURN CODE(APVRC);                                            1635 05320000
@RC01616 LR    @15,APVRC                                           1635 05321000
         L     @14,@SA00024                                        1635 05322000
         LM    @00,@12,@SA00024+8                                  1635 05323000
         BR    @14                                                 1635 05324000
*   RFY                                                            1636 05325000
*     SCLMAP BASED;                                                1636 05326000
*   RFY                                                            1637 05327000
*     TSLPARMS BASED;                                              1637 05328000
*   END APPLVER;                                                   1638 05329000
*                                                                  1639 05330000
*   /*****************************************************************/ 05331000
*   /*                                                               */ 05332000
*   /* AMBIGCK -                                                     */ 05333000
*   /*                                                               */ 05334000
*   /*****************************************************************/ 05335000
*                                                                  1639 05336000
*AMBIGCK:                                                          1639 05337000
*   PROC(AMBSCL);                                                  1639 05338000
AMBIGCK  STM   @14,@12,@SA00025                                    1639 05339000
         MVC   @PC00025(4),0(@01)                                  1639 05340000
*   DCL                                                            1640 05341000
*     AMBSCL CHAR(LENGTH(SCLMAP));  /* SCL RECORD                    */ 05342000
*   DCL                                                            1641 05343000
*     AMBNAME CHAR(7);              /* NAME OF THE CURRENT SYSMOD    */ 05344000
*   DCL                                                            1642 05345000
*     AMBSCL2 CHAR(LENGTH(SCLMAP)); /* SCL RECORD                    */ 05346000
*   DCL                                                            1643 05347000
*     AMBPREV@ PTR(31);             /* PREVIOUS SCL RECORD ADDR      */ 05348000
*   DCL                                                            1644 05349000
*     1 AMBFLAGS,                   /* LOCAL CONTROL FLAGS           */ 05350000
*      2 AMBEND BIT(1),             /* END OF SCL RECORDS FOR CURRENT   05351000
*                                      SYSMOD                        */ 05352000
*      2 * BIT(6);                                                 1644 05353000
*   DCL                                                            1645 05354000
*     AMBRC FIXED(15);                                             1645 05355000
*   RFY                                                            1646 05356000
*     SCLMAP BASED(ADDR(AMBSCL));                                  1646 05357000
*   AMBRC=ZERO;                                                    1647 05358000
         SLR   AMBRC,AMBRC                                         1647 05359000
*   AMBPREV@=ADDR(SCLMAP);                                         1648 05360000
         L     @08,@PC00025                                        1648 05361000
         ST    @08,AMBPREV@                                        1648 05362000
*   AMBNAME=SCLSMD;                 /* SAVE THE NAME OF THE CURRENT     05363000
*                                      SYSMOD                        */ 05364000
         MVC   AMBNAME(7),SCLSMD(@08)                              1649 05365000
*   AMBFLAGS=''B;                   /* CLEAR CONTROL FLAGS           */ 05366000
         MVI   AMBFLAGS,X'00'                                      1650 05367000
*   DO WHILE(AMBRC<STOPSMD          /* SEARCH UNTIL ERROR OR       1651 05368000
*                                      AMBIGUITY FOUND               */ 05369000
*         &AMBEND=OFF);                                            1651 05370000
         B     @DE01651                                            1651 05371000
@DL01651 DS    0H                                                  1652 05372000
*     CALL GETNLSMD(SCLISTNO,       /*                               */ 05373000
*         AMBPREV@,                 /*                               */ 05374000
*         AMBSCL2);                                                1652 05375000
         MVC   @AL00001+4(8),@AL01652                              1652 05376000
         L     @08,@PC00025                                        1652 05377000
         ST    @08,@AL00001                                        1652 05378000
         LA    @01,@AL00001                                        1652 05379000
         BAL   @14,GETNLSMD                                        1652 05380000
*     RFY                                                          1653 05381000
*       RTNCODE RSTD;                                              1653 05382000
*     IF RTNCODE=GTPEOF THEN        /* END OF FILE OR LIST IN GTA  1654 05383000
*                                      FILE?                         */ 05384000
         CH    RTNCODE,@CH00038                                    1654 05385000
         BNE   @RF01654                                            1654 05386000
*       DO;                         /* YES,                          */ 05387000
*         RFY                                                      1656 05388000
*           RTNCODE UNRSTD;                                        1656 05389000
*         AMBEND=ON;                /* END OF SEARCH                 */ 05390000
         OI    AMBEND,B'10000000'                                  1657 05391000
*       END;                                                       1658 05392000
*     ELSE                          /* NOT END OF LIST               */ 05393000
*       DO;                                                        1659 05394000
         B     @RC01654                                            1659 05395000
@RF01654 DS    0H                                                  1660 05396000
*         IF SCLSMD=AMBNAME THEN    /* GOTTEN RECORD FOR CURRENT   1660 05397000
*                                      SYSMOD?                       */ 05398000
         L     @08,@PC00025                                        1660 05399000
         CLC   SCLSMD(7,@08),AMBNAME                               1660 05400000
         BNE   @RF01660                                            1660 05401000
*           DO;                                                    1661 05402000
*             CALL APPLVER(SCLMAP); /* SEE IF IT IS APPLICABLE       */ 05403000
         ST    @08,@AL00001                                        1662 05404000
         LA    @01,@AL00001                                        1662 05405000
         BAL   @14,APPLVER                                         1662 05406000
*             RFY                                                  1663 05407000
*               RTNCODE RSTD;                                      1663 05408000
*             IF RTNCODE=ZERO THEN  /* THE ++VER IS APPLICABLE       */ 05409000
         LTR   RTNCODE,RTNCODE                                     1664 05410000
         BNZ   @RF01664                                            1664 05411000
*               DO;                                                1665 05412000
*                 RFY                                              1666 05413000
*                   RTNCODE UNRSTD;                                1666 05414000
*                 AMBRC=STOPSMD;    /* STOP THE PTF                  */ 05415000
*                                                                  1667 05416000
         LA    AMBRC,8                                             1667 05417000
*                 /***************************************************/ 05418000
*                 /*                                                 */ 05419000
*                 /* ISSUE ERROR MESSAGE HMA373I SYSMOD XXXXXXX HAS  */ 05420000
*                 /* MORE THAT ONE APPLICABLE VER STATEMENT          */ 05421000
*                 /*                                                 */ 05422000
*                 /***************************************************/ 05423000
*                                                                  1668 05424000
*                 DO;               /* HMASMPMG M1(HMA373I)TYPE(ERR)V   05425000
*                                      AR(AMBNAME)TARGET(SYSOUT,LOG) */ 05426000
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/ 05427000
         XC    HMASMMGP(28),HMASMMGP                               1669 05428000
*                   MGPMGNO1=HMA373I;/* SET UP MSG 1 CODE            */ 05429000
         MVC   MGPMGNO1(2),@CH01247                                1670 05430000
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */ 05431000
         MVI   MGPTYPE,X'03'                                       1671 05432000
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */ 05433000
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */ 05434000
         OI    MGPPRINT,B'10010000'                                1673 05435000
*                   MGPVARPT(1)=ADDR(AMBNAME);/* SET VARIABLE PTR    */ 05436000
         LA    @08,AMBNAME                                         1674 05437000
         ST    @08,MGPVARPT                                        1674 05438000
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */ 05439000
         L     @15,@CV01230                                        1675 05440000
         LA    @01,@AL01675                                        1675 05441000
         BALR  @14,@15                                             1675 05442000
*                 END;              /*                               */ 05443000
*               END;                                               1677 05444000
*             ELSE                                                 1678 05445000
*               ;                   /* CONTINUE SEARCH WITH NEXT     */ 05446000
@RF01664 DS    0H                                                  1679 05447000
*           END;                                                   1679 05448000
*         ELSE                      /* SCL RECORD FOR THE NEXT SYSMOD*/ 05449000
*           DO;                                                    1680 05450000
         B     @RC01660                                            1680 05451000
@RF01660 DS    0H                                                  1681 05452000
*             AMBEND=ON;            /* END OF SEARCH                 */ 05453000
         OI    AMBEND,B'10000000'                                  1681 05454000
*           END;                                                   1682 05455000
*       END;                                                       1683 05456000
@RC01660 DS    0H                                                  1684 05457000
*   END;                                                           1684 05458000
@RC01654 DS    0H                                                  1684 05459000
@DE01651 CH    AMBRC,@CH00056                                      1684 05460000
         BNL   @DC01651                                            1684 05461000
         TM    AMBEND,B'10000000'                                  1684 05462000
         BZ    @DL01651                                            1684 05463000
@DC01651 DS    0H                                                  1685 05464000
*   RETURN CODE(AMBRC);                                            1685 05465000
         LR    @15,AMBRC                                           1685 05466000
         L     @14,@SA00025                                        1685 05467000
         LM    @00,@12,@SA00025+8                                  1685 05468000
         BR    @14                                                 1685 05469000
*   RFY                                                            1686 05470000
*     SCLMAP BASED;                                                1686 05471000
*   END AMBIGCK;                                                   1687 05472000
*                                                                  1688 05473000
*   /*****************************************************************/ 05474000
*   /*                                                               */ 05475000
*   /* SUPCK - CHECK SUP'S                                           */ 05476000
*   /*                                                               */ 05477000
*   /*****************************************************************/ 05478000
*                                                                  1688 05479000
*SUPCK:                                                            1688 05480000
*   PROC(SUPTYPE,                   /* TYPE OF PROCESSING            */ 05481000
*       SUPSCL,                     /* SYSMOD CANDIDATE LIST RECORD  */ 05482000
*       SUPIOP,                     /* EXTENDED IOP                  */ 05483000
*       SUPSUPN);                   /* SUPERCEDE COUNT               */ 05484000
SUPCK    STM   @14,@12,@SA00026                                    1688 05485000
         MVC   @PC00026(16),0(@01)                                 1688 05486000
*   DCL                                                            1689 05487000
*     SUPTYPE CHAR(1);              /* TYPE                          */ 05488000
*   DCL                                                            1690 05489000
*     SUPSCL CHAR(LENGTH(SCLMAP));  /* SCL RECORD                    */ 05490000
*   DCL                                                            1691 05491000
*     SUPIOP CHAR(*);               /* IOP                           */ 05492000
*   DCL                                                            1692 05493000
*     SUPSUPN FIXED(16);            /* SUPERCEDE COUNT FIELD         */ 05494000
*   DCL                                                            1693 05495000
*     SUPRC FIXED(15);                                             1693 05496000
*   DCL                                                            1694 05497000
*     1 SUPFLAGS,                   /* LOCAL CONTROL FLAGS           */ 05498000
*      2 SUPEOLST BIT(1),           /* END OF IOP LIST SEARCH        */ 05499000
*      2 SUPICEND BIT(1),           /* END OF ICT SEARCH             */ 05500000
*      2 * BIT(6);                  /* UNUSED                        */ 05501000
*   RFY                                                            1695 05502000
*     HMASMIOP BASED(ADDR(SUPIOP));                                1695 05503000
*   RFY                                                            1696 05504000
*     SCLMAP BASED(ADDR(SUPSCL));                                  1696 05505000
*   RFY                                                            1697 05506000
*     TSLPARMS BASED(TBLXTSLP);                                    1697 05507000
*   SUPRC=ZERO;                                                    1698 05508000
         SLR   SUPRC,SUPRC                                         1698 05509000
*   SUPSUPN=ZERO;                   /* INIT SUPERCEDE COUNT          */ 05510000
         L     @08,@PC00026+12                                     1699 05511000
         SLR   @02,@02                                             1699 05512000
         STH   @02,SUPSUPN(,@08)                                   1699 05513000
*   SUPFLAGS=''B;                   /* CLEAR LOCAL FLAGS             */ 05514000
         MVI   SUPFLAGS,X'00'                                      1700 05515000
*   TSLLSTSR=''B;                   /* CLEAR TSB PARM LIST           */ 05516000
*                                                                  1701 05517000
         L     @08,@PC00001                                        1701 05518000
         L     @08,TBLXTSLP(,@08)                                  1701 05519000
         L     @02,TSLPMLAD(,@08)                                  1701 05520000
         XC    TSLLSTSR(16,@02),TSLLSTSR(@02)                      1701 05521000
*   /*****************************************************************/ 05522000
*   /*                                                               */ 05523000
*   /* SEE IF SYSMOD IN SUP LIST OF ANY ICT SYSMOD                   */ 05524000
*   /*                                                               */ 05525000
*   /*****************************************************************/ 05526000
*                                                                  1702 05527000
*   TSLLSMD=IOPNAM17;                                              1702 05528000
         L     @15,@PC00026+8                                      1702 05529000
         MVC   TSLLSMD(7,@02),IOPNAM17(@15)                        1702 05530000
*   TSLFUNCT=TSLFLSRH;                                             1703 05531000
         MVI   TSLFUNCT(@08),X'02'                                 1703 05532000
*   RFY                                                            1704 05533000
*     ICTPTF BASED(CCAICPTF);                                      1704 05534000
*   TSLLOFST=ADDR(ICTPSCHN(1))-ADDR(ICTPTF(1));/* SUP LIST OFFSET    */ 05535000
         L     @08,CCAICPTF(,CCAPTR)                               1705 05536000
         LA    @15,ICTPSCHN(,@08)                                  1705 05537000
         SLR   @15,@08                                             1705 05538000
         ST    @15,TSLLOFST(,@02)                                  1705 05539000
*   RFY                                                            1706 05540000
*     ICTPTF BASED;                                                1706 05541000
*   DO WHILE(SUPICEND=OFF           /* SEARCH ENTIRE LIST            */ 05542000
*         &SUPRC<STOPSMD);                                         1707 05543000
         B     @DE01707                                            1707 05544000
@DL01707 DS    0H                                                  1708 05545000
*     CALL HMASMTSB(TSLPARMS);                                     1708 05546000
         L     @08,@PC00001                                        1708 05547000
         L     @08,TBLXTSLP(,@08)                                  1708 05548000
         ST    @08,@AL00001                                        1708 05549000
         L     @15,@CV01237                                        1708 05550000
         LA    @01,@AL00001                                        1708 05551000
         BALR  @14,@15                                             1708 05552000
*     TSLLONXT=ON;                  /*                               */ 05553000
         L     @08,@PC00001                                        1709 05554000
         L     @08,TBLXTSLP(,@08)                                  1709 05555000
         L     @08,TSLPMLAD(,@08)                                  1709 05556000
         OI    TSLLONXT(@08),B'10000000'                           1709 05557000
*     RFY                                                          1710 05558000
*       RTNCODE RSTD;                                              1710 05559000
*     IF RTNCODE=TSLFOUND THEN      /* FOUND SUP'ED?                 */ 05560000
         LTR   RTNCODE,RTNCODE                                     1711 05561000
         BNZ   @RF01711                                            1711 05562000
*       DO;                                                        1712 05563000
*         RFY                                                      1713 05564000
*           RTNCODE UNRSTD;                                        1713 05565000
*         SUPSUPN=SUPSUPN+1;        /* INCREMENT SUPERCEDE FOUND CTR */ 05566000
         L     @02,@PC00026+12                                     1714 05567000
         LA    @15,1                                               1714 05568000
         SLR   @14,@14                                             1714 05569000
         ICM   @14,3,SUPSUPN(@02)                                  1714 05570000
         ALR   @15,@14                                             1714 05571000
         STH   @15,SUPSUPN(,@02)                                   1714 05572000
*         IF SUPTYPE=DELETE THEN    /* DELETE PROCESSING?            */ 05573000
         L     @02,@PC00026                                        1715 05574000
         CLI   SUPTYPE(@02),C'D'                                   1715 05575000
         BNE   @RF01715                                            1715 05576000
*           DO;                     /* YES,                          */ 05577000
*             SUPRC=STOPSMD;        /* STOP THE SYSMOD               */ 05578000
*                                                                  1717 05579000
         LA    SUPRC,8                                             1717 05580000
*             /*******************************************************/ 05581000
*             /*                                                     */ 05582000
*             /* ISSUE MESSAGE HMA384I DELETE FUNCTION XXXXXXX IS    */ 05583000
*             /* SUPERCEEDED BY FUNCTION XXXXXXX                     */ 05584000
*             /*                                                     */ 05585000
*             /*******************************************************/ 05586000
*                                                                  1718 05587000
*             DO;                   /* HMASMPMG M1(HMA384I)TYPE(ERR)V   05588000
*                                      AR(SCLSMD,TSLLRTNP->ICTPTFS(1)   05589000
*                                      )TARGET(SYSOUT,LOG)           */ 05590000
*               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS    */ 05591000
         XC    HMASMMGP(28),HMASMMGP                               1719 05592000
*               MGPMGNO1=HMA384I;   /* SET UP MSG 1 CODE             */ 05593000
         MVC   MGPMGNO1(2),@CH01253                                1720 05594000
*               MGPTYPE=MGPERR;     /* SET MESSAGE TYPE              */ 05595000
         MVI   MGPTYPE,X'03'                                       1721 05596000
*               MGPPRINT='1'B;      /* SET TARGET FLAG               */ 05597000
*               MGPHLDS='1'B;       /* SET TARGET FLAG               */ 05598000
         OI    MGPPRINT,B'10010000'                                1723 05599000
*               MGPVARPT(1)=ADDR(SCLSMD);/* SET VARIABLE PTR         */ 05600000
         L     @02,@PC00026+4                                      1724 05601000
         LA    @02,SCLSMD(,@02)                                    1724 05602000
         ST    @02,MGPVARPT                                        1724 05603000
*               MGPVARPT(2)=ADDR(TSLLRTNP->ICTPTFS(1));/* SET      1725 05604000
*                                      VARIABLE PTR                  */ 05605000
         L     @08,TSLLRTNP(,@08)                                  1725 05606000
         ST    @08,MGPVARPT+4                                      1725 05607000
*               CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED       */ 05608000
         L     @15,@CV01230                                        1726 05609000
         LA    @01,@AL01726                                        1726 05610000
         BALR  @14,@15                                             1726 05611000
*             END;                  /*                               */ 05612000
*           END;                                                   1728 05613000
*         ELSE                                                     1729 05614000
*           ;                                                      1729 05615000
@RF01715 DS    0H                                                  1730 05616000
*         IF SUPTYPE=LEVEL2 THEN    /* PROCESSING A LOWER LEVEL    1730 05617000
*                                      FUNCTION?                     */ 05618000
         L     @08,@PC00026                                        1730 05619000
         CLI   SUPTYPE(@08),C'2'                                   1730 05620000
         BNE   @RF01730                                            1730 05621000
*           DO;                                                    1731 05622000
*                                                                  1731 05623000
*             /*******************************************************/ 05624000
*             /*                                                     */ 05625000
*             /* CHECK FMID MATCH                                    */ 05626000
*             /*                                                     */ 05627000
*             /*******************************************************/ 05628000
*                                                                  1732 05629000
*             IF SCLFMID^=TSLLRTNP->ICTPFMID(1) THEN/* DIFFERENT   1732 05630000
*                                      FMID'S                        */ 05631000
         L     @08,@PC00026+4                                      1732 05632000
         L     @02,@PC00001                                        1732 05633000
         L     @02,TBLXTSLP(,@02)                                  1732 05634000
         L     @02,TSLPMLAD(,@02)                                  1732 05635000
         L     @01,TSLLRTNP(,@02)                                  1732 05636000
         CLC   SCLFMID(7,@08),ICTPFMID(@01)                        1732 05637000
         BE    @RF01732                                            1732 05638000
*               DO;                                                1733 05639000
*                                                                  1733 05640000
*                 /***************************************************/ 05641000
*                 /*                                                 */ 05642000
*                 /* ISSUE MESSAGE HMA383I FUNCTION XXXXXXX (FMID    */ 05643000
*                 /* XXXXXXX) SUPERCEEDS FUNCTION XXXXXXX (FMID      */ 05644000
*                 /* XXXXXXX) BUT THE FMIDS ARE NOT EQUAL            */ 05645000
*                 /*                                                 */ 05646000
*                 /***************************************************/ 05647000
*                                                                  1734 05648000
*                 DO;               /* HMASMPMG M1(HMA383I)TYPE(ERR)V   05649000
*                                      AR(TSLICTP->ICTPTFS(1),TSLICTP   05650000
*                                      ->ICTPFMID(1),SCLSMD,SCLFMID)T   05651000
*                                      ARGET(SYSOUT,LOG)             */ 05652000
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/ 05653000
         XC    HMASMMGP(28),HMASMMGP                               1735 05654000
*                   MGPMGNO1=HMA383I;/* SET UP MSG 1 CODE            */ 05655000
         MVC   MGPMGNO1(2),@CH01251                                1736 05656000
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */ 05657000
         MVI   MGPTYPE,X'03'                                       1737 05658000
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */ 05659000
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */ 05660000
         OI    MGPPRINT,B'10010000'                                1739 05661000
*                   MGPVARPT(1)=ADDR(TSLICTP->ICTPTFS(1));/* SET   1740 05662000
*                                      VARIABLE PTR                  */ 05663000
         L     @02,TSLICTP(,@02)                                   1740 05664000
         ST    @02,MGPVARPT                                        1740 05665000
*                   MGPVARPT(2)=ADDR(TSLICTP->ICTPFMID(1));/* SET  1741 05666000
*                                      VARIABLE PTR                  */ 05667000
         LA    @02,ICTPFMID(,@02)                                  1741 05668000
         ST    @02,MGPVARPT+4                                      1741 05669000
*                   MGPVARPT(3)=ADDR(SCLSMD);/* SET VARIABLE PTR     */ 05670000
         LA    @02,SCLSMD(,@08)                                    1742 05671000
         ST    @02,MGPVARPT+8                                      1742 05672000
*                   MGPVARPT(4)=ADDR(SCLFMID);/* SET VARIABLE PTR    */ 05673000
         LA    @08,SCLFMID(,@08)                                   1743 05674000
         ST    @08,MGPVARPT+12                                     1743 05675000
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */ 05676000
         L     @15,@CV01230                                        1744 05677000
         LA    @01,@AL01744                                        1744 05678000
         BALR  @14,@15                                             1744 05679000
*                 END;              /*                               */ 05680000
*               END;                                               1746 05681000
*             ELSE                  /* MATCHING FMID'S               */ 05682000
*               DO;                                                1747 05683000
         B     @RC01732                                            1747 05684000
@RF01732 DS    0H                                                  1748 05685000
*               END;                                               1748 05686000
*           END;                                                   1749 05687000
*       END;                                                       1750 05688000
*     ELSE                          /* NOT FOUND SUP'ED              */ 05689000
*       DO;                                                        1751 05690000
         B     @RC01711                                            1751 05691000
@RF01711 DS    0H                                                  1752 05692000
*         SUPICEND=ON;                                             1752 05693000
         OI    SUPICEND,B'01000000'                                1752 05694000
*       END;                                                       1753 05695000
*   END;                            /* END SEARCH FOR LIST ENTRY     */ 05696000
@RC01711 DS    0H                                                  1754 05697000
@DE01707 TM    SUPICEND,B'01000000'                                1754 05698000
         BNZ   @DC01707                                            1754 05699000
         CH    SUPRC,@CH00056                                      1754 05700000
         BL    @DL01707                                            1754 05701000
@DC01707 DS    0H                                                  1755 05702000
*   IF SUPRC<STOPSMD THEN           /* NO ERROR SO FAR?              */ 05703000
         CH    SUPRC,@CH00056                                      1755 05704000
         BNL   @RF01755                                            1755 05705000
*     DO;                           /* YES,                          */ 05706000
*       TSLENTSR=''B;               /* CLEAR PARM LIST FOR SUB-ENTRY    05707000
*                                      SEARCH                        */ 05708000
         L     @08,@PC00001                                        1757 05709000
         L     @02,TBLXTSLP(,@08)                                  1757 05710000
         L     @15,TSLPMLAD(,@02)                                  1757 05711000
         XC    TSLENTSR(16,@15),TSLENTSR(@15)                      1757 05712000
*       TSLETYPE=IOPPSUPV;          /* SEARCH TYPE IS SUP            */ 05713000
         MVI   TSLETYPE(@15),X'A4'                                 1758 05714000
*       TSLFUNCT=TSLFENSR;          /* SEARCH IOP SUB-ENTRIES        */ 05715000
         MVI   TSLFUNCT(@02),X'06'                                 1759 05716000
*       TSLEBGNP=ADDR(IOPPTFVR);    /* BEGIN AT BEGINNING            */ 05717000
         L     @02,@PC00026+8                                      1760 05718000
         LA    @02,IOPPTFVR(,@02)                                  1760 05719000
         ST    @02,TSLEBGNP(,@15)                                  1760 05720000
*       TSLEVER#=SCLVERNO;          /* ++VER NUMBER                  */ 05721000
         L     @02,@PC00026+4                                      1761 05722000
         MVC   TSLEVER#(1,@15),SCLVERNO(@02)                       1761 05723000
*       RFY                                                        1762 05724000
*         TSLPARMS BASED(ADDR(TPATSL2));                           1762 05725000
*       TSLPMLAD=ADDR(TPATSS2);     /* SETUP SECOND TSB PARM LIST    */ 05726000
         LA    @02,TPATSL2                                         1763 05727000
         LA    @15,TPATSS2                                         1763 05728000
         ST    @15,TSLPMLAD(,@02)                                  1763 05729000
*       TSLTBLXP=ADDR(TBLXPARM);    /* POINT TO TBLX                 */ 05730000
         ST    @08,TSLTBLXP(,@02)                                  1764 05731000
*       TSLICTSR=''B;               /* CLEAR SECONDARY PARM LIST     */ 05732000
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      1765 05733000
*       TSLFUNCT=TSLFISRH;          /* SEARCH ICT                    */ 05734000
         MVI   TSLFUNCT(@02),X'01'                                 1766 05735000
*       RFY                                                        1767 05736000
*         TSLPARMS BASED(TBLXTSLP);                                1767 05737000
*                                                                  1767 05738000
*       /*************************************************************/ 05739000
*       /*                                                           */ 05740000
*       /* DETERMINE SYSMODS IN THE ICT THAT ARE SUP'ED BY THE       */ 05741000
*       /* CURRENT SYSMOD                                            */ 05742000
*       /*                                                           */ 05743000
*       /*************************************************************/ 05744000
*                                                                  1768 05745000
*       DO WHILE(SUPRC<STOPSMD      /* SEARCH UNTIL END OF LIST      */ 05746000
*             &SUPEOLST=OFF);                                      1768 05747000
         B     @DE01768                                            1768 05748000
@DL01768 DS    0H                                                  1769 05749000
*         CALL HMASMTSB(TSLPARMS);  /* FIND SUP IN THE IOP           */ 05750000
         L     @08,@PC00001                                        1769 05751000
         L     @08,TBLXTSLP(,@08)                                  1769 05752000
         ST    @08,@AL00001                                        1769 05753000
         L     @15,@CV01237                                        1769 05754000
         LA    @01,@AL00001                                        1769 05755000
         BALR  @14,@15                                             1769 05756000
*         IF TSLRETRN=TSLNTFND THEN /* NOT FOUND?                    */ 05757000
         L     @08,@PC00001                                        1770 05758000
         L     @08,TBLXTSLP(,@08)                                  1770 05759000
         CLI   TSLRETRN(@08),4                                     1770 05760000
         BNE   @RF01770                                            1770 05761000
*           DO;                                                    1771 05762000
*             SUPEOLST=ON;          /* END OF SUP SUB-ENTRY SEARCH   */ 05763000
         OI    SUPEOLST,B'10000000'                                1772 05764000
*           END;                                                   1773 05765000
*         ELSE                      /* SUP SUB-ENTRY FOUND IN IOP    */ 05766000
*           DO;                                                    1774 05767000
*                                                                  1774 05768000
         B     @RC01770                                            1774 05769000
@RF01770 DS    0H                                                  1775 05770000
*             /*******************************************************/ 05771000
*             /*                                                     */ 05772000
*             /* SEE IF SUP'ED SYSMOD IS IN THE ICT                  */ 05773000
*             /*                                                     */ 05774000
*             /*******************************************************/ 05775000
*                                                                  1775 05776000
*             TSLEONXT=ON;          /* GET NXT SUP FROM IOP          */ 05777000
         L     @08,@PC00001                                        1775 05778000
         L     @08,TBLXTSLP(,@08)                                  1775 05779000
         L     @08,TSLPMLAD(,@08)                                  1775 05780000
         OI    TSLEONXT(@08),B'10000000'                           1775 05781000
*             ADDR(TPATSS2)->TSLISMD=/* SYSMOD NAME                  */ 05782000
*                 TSLEFNDP->BASEDSMD;                              1776 05783000
         LA    @02,TPATSS2                                         1776 05784000
         L     @08,TSLEFNDP(,@08)                                  1776 05785000
         MVC   TSLISMD(7,@02),BASEDSMD(@08)                        1776 05786000
*             CALL HMASMTSB(TPATSL2);                              1777 05787000
         L     @15,@CV01237                                        1777 05788000
         LA    @01,@AL01777                                        1777 05789000
         BALR  @14,@15                                             1777 05790000
*             IF ADDR(TPATSL2)->TSLRETRN=TSLFOUND THEN/* FOUND IN  1778 05791000
*                                      ICT?                          */ 05792000
         LA    @08,TPATSL2                                         1778 05793000
         CLI   TSLRETRN(@08),0                                     1778 05794000
         BNE   @RF01778                                            1778 05795000
*               DO;                                                1779 05796000
*                 ADDR(TPATSS2)->   /* INCREMENT THE SUP COUNT       */ 05797000
*                     TSLICTP->ICTPSUPN(1)=/*                        */ 05798000
*                     ADDR(TPATSS2)->/*                              */ 05799000
*                     TSLICTP->ICTPSUPN(1)+1;                      1780 05800000
*                                                                  1780 05801000
         LA    @08,TPATSS2                                         1780 05802000
         L     @08,TSLICTP(,@08)                                   1780 05803000
         LA    @02,1                                               1780 05804000
         SLR   @15,@15                                             1780 05805000
         ICM   @15,3,ICTPSUPN(@08)                                 1780 05806000
         ALR   @02,@15                                             1780 05807000
         STH   @02,ICTPSUPN(,@08)                                  1780 05808000
*                 /***************************************************/ 05809000
*                 /*                                                 */ 05810000
*                 /* CHECK FMID IF FUNCTION                          */ 05811000
*                 /*                                                 */ 05812000
*                 /***************************************************/ 05813000
*                                                                  1781 05814000
*                 IF SUPTYPE=DELETE THEN/* DELETE PROCESSING?        */ 05815000
         L     @08,@PC00026                                        1781 05816000
         CLI   SUPTYPE(@08),C'D'                                   1781 05817000
         BNE   @RF01781                                            1781 05818000
*                   DO;             /* YES,                          */ 05819000
*                     SUPRC=STOPSMD;/* STOP THE SYSMOD               */ 05820000
*                                                                  1783 05821000
         LA    SUPRC,8                                             1783 05822000
*                     /***********************************************/ 05823000
*                     /*                                             */ 05824000
*                     /* ISSUE MESSAGE HMA384I DELETE FUNCTION       */ 05825000
*                     /* XXXXXXX IS SUPERCEEDED BY FUNCTION XXXXXXX  */ 05826000
*                     /*                                             */ 05827000
*                     /***********************************************/ 05828000
*                                                                  1784 05829000
*                     DO;           /* HMASMPMG M1(HMA384I)TYPE(ERR)V   05830000
*                                      AR(TSLEFNDP->BASEDSMD,SCLSMD)T   05831000
*                                      ARGET(SYSOUT,LOG)             */ 05832000
*                       HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO     05833000
*                                      ZEROS                         */ 05834000
         XC    HMASMMGP(28),HMASMMGP                               1785 05835000
*                       MGPMGNO1=HMA384I;/* SET UP MSG 1 CODE        */ 05836000
         MVC   MGPMGNO1(2),@CH01253                                1786 05837000
*                       MGPTYPE=MGPERR;/* SET MESSAGE TYPE           */ 05838000
         MVI   MGPTYPE,X'03'                                       1787 05839000
*                       MGPPRINT='1'B;/* SET TARGET FLAG             */ 05840000
*                       MGPHLDS='1'B;/* SET TARGET FLAG              */ 05841000
         OI    MGPPRINT,B'10010000'                                1789 05842000
*                       MGPVARPT(1)=ADDR(TSLEFNDP->BASEDSMD);/* SET     05843000
*                                      VARIABLE PTR                  */ 05844000
         L     @08,@PC00001                                        1790 05845000
         L     @08,TBLXTSLP(,@08)                                  1790 05846000
         L     @08,TSLPMLAD(,@08)                                  1790 05847000
         MVC   MGPVARPT(4),TSLEFNDP(@08)                           1790 05848000
*                       MGPVARPT(2)=ADDR(SCLSMD);/* SET VARIABLE PTR */ 05849000
         L     @08,@PC00026+4                                      1791 05850000
         LA    @08,SCLSMD(,@08)                                    1791 05851000
         ST    @08,MGPVARPT+4                                      1791 05852000
*                       CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE    1792 05853000
*                                      ISSUED                        */ 05854000
         L     @15,@CV01230                                        1792 05855000
         LA    @01,@AL01792                                        1792 05856000
         BALR  @14,@15                                             1792 05857000
*                     END;          /*                               */ 05858000
*                   END;                                           1794 05859000
*                 ELSE                                             1795 05860000
*                   ;                                              1795 05861000
@RF01781 DS    0H                                                  1796 05862000
*                 IF SUPTYPE=LEVEL2 THEN/* PROCESSING A LOWER LEVEL     05863000
*                                      FUNCTION?                     */ 05864000
         L     @08,@PC00026                                        1796 05865000
         CLI   SUPTYPE(@08),C'2'                                   1796 05866000
         BNE   @RF01796                                            1796 05867000
*                   DO;                                            1797 05868000
*                                                                  1797 05869000
*                     /***********************************************/ 05870000
*                     /*                                             */ 05871000
*                     /* CHECK FMID MATCH                            */ 05872000
*                     /*                                             */ 05873000
*                     /***********************************************/ 05874000
*                                                                  1798 05875000
*                     IF SCLFMID^=  /* DIFFERENT FMIDS?              */ 05876000
*                         ADDR(TPATSS2)->TSLICTP->ICTPFMID(1) THEN 1798 05877000
         L     @08,@PC00026+4                                      1798 05878000
         LA    @02,TPATSS2                                         1798 05879000
         L     @02,TSLICTP(,@02)                                   1798 05880000
         CLC   SCLFMID(7,@08),ICTPFMID(@02)                        1798 05881000
         BE    @RF01798                                            1798 05882000
*                       DO;                                        1799 05883000
*                                                                  1799 05884000
*                         /*******************************************/ 05885000
*                         /*                                         */ 05886000
*                         /* ISSUE MESSAGE HMA383I FUNCTION XXXXXXX  */ 05887000
*                         /* (FMID XXXXXXX) SUPERCEEDS FUNCTION      */ 05888000
*                         /* XXXXXXX (FMID XXXXXXX) BUT THE FMIDS ARE*/ 05889000
*                         /* NOT EQUAL                               */ 05890000
*                         /*                                         */ 05891000
*                         /*******************************************/ 05892000
*                                                                  1800 05893000
*                         DO;       /* HMASMPMG M1(HMA383I)TYPE(ERR)V   05894000
*                                      AR(SCLSMD,SCLFMID,ADDR(TPATSS2   05895000
*                                      )->TSLICTP->ICTPTFS(1),ADDR(TP   05896000
*                                      ATSS2)->TSLICTP->ICTPFMID(1))T   05897000
*                                      ARGET(SYSOUT,LOG)             */ 05898000
*                           HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS    05899000
*                                      TO ZEROS                      */ 05900000
         XC    HMASMMGP(28),HMASMMGP                               1801 05901000
*                           MGPMGNO1=HMA383I;/* SET UP MSG 1 CODE    */ 05902000
         MVC   MGPMGNO1(2),@CH01251                                1802 05903000
*                           MGPTYPE=MGPERR;/* SET MESSAGE TYPE       */ 05904000
         MVI   MGPTYPE,X'03'                                       1803 05905000
*                           MGPPRINT='1'B;/* SET TARGET FLAG         */ 05906000
*                           MGPHLDS='1'B;/* SET TARGET FLAG          */ 05907000
         OI    MGPPRINT,B'10010000'                                1805 05908000
*                           MGPVARPT(1)=ADDR(SCLSMD);/* SET VARIABLE    05909000
*                                      PTR                           */ 05910000
         LA    @15,SCLSMD(,@08)                                    1806 05911000
         ST    @15,MGPVARPT                                        1806 05912000
*                           MGPVARPT(2)=ADDR(SCLFMID);/* SET VARIABLE   05913000
*                                      PTR                           */ 05914000
         LA    @08,SCLFMID(,@08)                                   1807 05915000
         ST    @08,MGPVARPT+4                                      1807 05916000
*                           MGPVARPT(3)=ADDR(ADDR(TPATSS2)->TSLICTP->   05917000
*                               ICTPTFS(1));/* SET VARIABLE PTR      */ 05918000
         ST    @02,MGPVARPT+8                                      1808 05919000
*                           MGPVARPT(4)=ADDR(ADDR(TPATSS2)->TSLICTP->   05920000
*                               ICTPFMID(1));/* SET VARIABLE PTR     */ 05921000
         LA    @08,ICTPFMID(,@02)                                  1809 05922000
         ST    @08,MGPVARPT+12                                     1809 05923000
*                           CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE     05924000
*                                      ISSUED                        */ 05925000
         L     @15,@CV01230                                        1810 05926000
         LA    @01,@AL01810                                        1810 05927000
         BALR  @14,@15                                             1810 05928000
*                         END;      /*                               */ 05929000
*                       END;                                       1812 05930000
*                     ELSE          /* MATCHING FMID'S               */ 05931000
*                       DO;                                        1813 05932000
         B     @RC01798                                            1813 05933000
@RF01798 DS    0H                                                  1814 05934000
*                       END;                                       1814 05935000
*                   END;                                           1815 05936000
*               END;                                               1816 05937000
*             ELSE                                                 1817 05938000
*               ;                   /* SUP IS NOT IN ICT             */ 05939000
@RF01778 DS    0H                                                  1818 05940000
*           END;                                                   1818 05941000
@RC01778 DS    0H                                                  1819 05942000
*       END;                        /* END OF SEARCH LOOP            */ 05943000
@RC01770 DS    0H                                                  1819 05944000
@DE01768 CH    SUPRC,@CH00056                                      1819 05945000
         BNL   @DC01768                                            1819 05946000
         TM    SUPEOLST,B'10000000'                                1819 05947000
         BZ    @DL01768                                            1819 05948000
@DC01768 DS    0H                                                  1820 05949000
*     END;                                                         1820 05950000
*   RETURN CODE(SUPRC);                                            1821 05951000
@RF01755 LR    @15,SUPRC                                           1821 05952000
         L     @14,@SA00026                                        1821 05953000
         LM    @00,@12,@SA00026+8                                  1821 05954000
         BR    @14                                                 1821 05955000
*   RFY                                                            1822 05956000
*     HMASMIOP BASED;                                              1822 05957000
*   RFY                                                            1823 05958000
*     TSLPARMS BASED;                                              1823 05959000
*   RFY                                                            1824 05960000
*     SCLMAP BASED;                                                1824 05961000
*   END SUPCK;                                                     1825 05962000
*   END HMASMTPA                    /*                               */ 05963000
*                                                                  1826 05964000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05965000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 05966000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 05967000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 05968000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 05969000
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */ 05970000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 05971000
*                                                                  1826 05972000
*       ;                                                          1826 05973000
@DATA    DS    0H                                                       05974000
@CH00064 DC    H'1'                                                     05975000
@CH00038 DC    H'4'                                                     05976000
@CH00102 DC    H'5'                                                     05977000
@CH00056 DC    H'8'                                                     05978000
@CH00033 DC    H'12'                                                    05979000
@CH01757 DC    H'116'                                                   05980000
@CH01258 DC    H'119'                                                   05981000
@CH00791 DC    H'165'                                                   05982000
@CH01243 DC    H'171'                                                   05983000
@CH01245 DC    H'173'                                                   05984000
@CH01247 DC    H'174'                                                   05985000
@CH01249 DC    H'180'                                                   05986000
@CH01251 DC    H'184'                                                   05987000
@CH01253 DC    H'185'                                                   05988000
@CH01255 DC    H'227'                                                   05989000
         DS    0F                                                       05990000
@AL00423 EQU   *                       LIST WITH   1 ARGUMENT(S)        05991000
@AL00878 EQU   *                       LIST WITH   1 ARGUMENT(S)        05992000
@AL01086 EQU   *                       LIST WITH   1 ARGUMENT(S)        05993000
@AL01128 EQU   *                       LIST WITH   1 ARGUMENT(S)        05994000
@AL01145 EQU   *                       LIST WITH   1 ARGUMENT(S)        05995000
@AL01191 EQU   *                       LIST WITH   1 ARGUMENT(S)        05996000
@AL01233 EQU   *                       LIST WITH   1 ARGUMENT(S)        05997000
@AL01250 EQU   *                       LIST WITH   1 ARGUMENT(S)        05998000
@AL01598 EQU   *                       LIST WITH   1 ARGUMENT(S)        05999000
@AL01675 EQU   *                       LIST WITH   1 ARGUMENT(S)        06000000
@AL01726 EQU   *                       LIST WITH   1 ARGUMENT(S)        06001000
@AL01744 EQU   *                       LIST WITH   1 ARGUMENT(S)        06002000
@AL01792 EQU   *                       LIST WITH   1 ARGUMENT(S)        06003000
@AL01810 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        06004000
@AL00453 DC    A(@CC01106)             LIST WITH   2 ARGUMENT(S)        06005000
         DC    A(F1BCKEY@)                                              06006000
@AL00552 DC    A(@CC01108)             LIST WITH   3 ARGUMENT(S)        06007000
         DC    A(F2BCKEY@)                                              06008000
         DC    A(F2BSCL)                                                06009000
@AL00689 DC    A(SRVCKEY@)             LIST WITH   2 ARGUMENT(S)        06010000
         DC    A(SRVSCL)                                                06011000
@AL01291 EQU   *                       LIST WITH   2 ARGUMENT(S)        06012000
@AL01294 DC    A(GRASTAT)              LIST WITH   2 ARGUMENT(S)        06013000
         DC    A(@CF00082)                                              06014000
@AL01304 DC    A(GRASTAT)              LIST WITH   2 ARGUMENT(S)        06015000
         DC    A(GRAIFOPT)                                              06016000
@AL01652 DC    A(AMBPREV@)             LIST WITH   2 ARGUMENT(S)        06017000
         DC    A(AMBSCL2)                                               06018000
@AL01777 DC    A(TPATSL2)              LIST WITH   1 ARGUMENT(S)        06019000
         DS    0F                                                       06020000
@SA00001 DS    18F                                                      06021000
@PC00001 DS    1F                                                       06022000
@SA00003 DS    15F                                                      06023000
@SA00005 DS    15F                                                      06024000
@SA00006 DS    15F                                                      06025000
@SA00007 DS    15F                                                      06026000
@SA00025 DS    15F                                                      06027000
@PC00025 DS    1F                                                       06028000
@SA00019 DS    15F                                                      06029000
@PC00019 DS    4F                                                       06030000
@SA00015 DS    15F                                                      06031000
@SA00021 DS    15F                                                      06032000
@PC00021 DS    3F                                                       06033000
@SA00016 DS    0F                                                       06034000
@PC00016 EQU   @SA00016+60                                              06035000
@SA00014 DS    0F                                                       06036000
@PC00014 EQU   @SA00014+60                                              06037000
@SA00013 DS    0F                                                       06038000
@PC00013 EQU   @SA00013+60                                              06039000
@SA00022 DS    0F                                                       06040000
@PC00022 EQU   @SA00022+60                                              06041000
@SA00017 DS    0F                                                       06042000
@PC00017 EQU   @SA00017+60                                              06043000
@SA00024 DS    0F                                                       06044000
@PC00024 EQU   @SA00024+60                                              06045000
@SA00012 DS    0F                                                       06046000
@PC00012 EQU   @SA00012+60                                              06047000
@SA00018 DS    0F                                                       06048000
@SA00023 DS    0F                                                       06049000
@PC00023 EQU   @SA00023+60                                              06050000
@SA00004 DS    0F                                                       06051000
@PC00004 EQU   @SA00004+60                                              06052000
@SA00026 DS    0F                                                       06053000
@PC00026 EQU   @SA00026+60                                              06054000
@SA00008 DS    0F                                                       06055000
@PC00008 EQU   @SA00008+60                                              06056000
@SA00020 DS    0F                                                       06057000
@PC00020 EQU   @SA00020+60                                              06058000
@SA00010 DS    0F                                                       06059000
@SA00009 DS    0F                                                       06060000
         DS    19F                                                      06061000
@AL00001 DS    5A                                                       06062000
@TF00001 DS    F                                                        06063000
         DS    0F                                                       06064000
@CF00082 DC    F'0'                                                     06065000
@CF01790 DC    F'-116'                                                  06066000
@CF01785 DC    F'-108'                                                  06067000
@CF01787 DC    F'-103'                                                  06068000
@CF01791 DC    F'-100'                                                  06069000
@CF01786 DC    F'-96'                                                   06070000
@CF01793 DC    F'-48'                                                   06071000
@CF01788 DC    F'-44'                                                   06072000
@CF01792 DC    F'-40'                                                   06073000
@CF01794 DC    F'-36'                                                   06074000
@CF01796 DC    F'-16'                                                   06075000
@CF01795 DC    F'-9'                                                    06076000
@CF01789 DC    F'-8'                                                    06077000
@CV01229 DC    V(HMASMIO)                                               06078000
@CV01230 DC    V(HMASMMSG)                                              06079000
@CV01231 DC    V(HMASMGTA)                                              06080000
@CV01232 DC    V(HMASMTAD)                                              06081000
@CV01233 DC    V(HMASMTEC)                                              06082000
@CV01234 DC    V(HMASMTD1)                                              06083000
@CV01235 DC    V(HMASMTPL)                                              06084000
@CV01236 DC    V(HMASMTP2)                                              06085000
@CV01237 DC    V(HMASMTSB)                                              06086000
@CV01238 DC    V(HMASMTPC)                                              06087000
         DS    0D                                                       06088000
IOPPTR   DS    A                                                        06089000
DELICTP  DS    A                                                        06090000
F1BCKEY@ DS    A                                                        06091000
F1BENTP  DS    A                                                        06092000
F2BCKEY@ DS    A                                                        06093000
F2BENTP  DS    A                                                        06094000
SRVCKEY@ DS    A                                                        06095000
SRVENTP  DS    A                                                        06096000
SUPSICTP DS    A                                                        06097000
AMBPREV@ DS    A                                                        06098000
DELSUPN  DS    H                                                        06099000
F1SUPN   DS    H                                                        06100000
F2SUPN   DS    H                                                        06101000
SRVSUPN  DS    H                                                        06102000
@CC01106 DC    C'1'                                                     06103000
@CC01108 DC    C'2'                                                     06104000
@CC01268 DC    C'S'                                                     06105000
@CC01285 DC    C'D'                                                     06106000
ICTENDCH DC    X'FFFFFFFF'                                              06107000
HMASMMGP DS    CL28                                                     06108000
         ORG   HMASMMGP                                                 06109000
MGPFIXED DS    CL12                                                     06110000
         ORG   MGPFIXED                                                 06111000
MGPCLEAR DS    CL6                                                      06112000
         ORG   MGPCLEAR                                                 06113000
MGPMGNO1 DS    FL2                                                      06114000
MGPMGNO2 DS    FL2                                                      06115000
MGPMGNO3 DS    FL2                                                      06116000
         ORG   MGPFIXED+6                                               06117000
MGPFLAGS DS    BL2                                                      06118000
         ORG   MGPFLAGS                                                 06119000
MGPPRINT DS    BL1                                                      06120000
MGPLIST  EQU   MGPFLAGS+0                                               06121000
MGPRPT   EQU   MGPFLAGS+0                                               06122000
MGPHLDS  EQU   MGPFLAGS+0                                               06123000
MGPWTOR  EQU   MGPFLAGS+0                                               06124000
MGPWTO   EQU   MGPFLAGS+0                                               06125000
MGPWTP   EQU   MGPFLAGS+0                                               06126000
@NM00118 EQU   MGPFLAGS+0                                               06127000
         ORG   MGPFIXED+8                                               06128000
MGPTYPE  DS    FL1                                                      06129000
@NM00119 DS    CL3                                                      06130000
         ORG   HMASMMGP+12                                              06131000
MGPVAR   DS    CL16                                                     06132000
         ORG   MGPVAR                                                   06133000
MGPVARPT DS    4A                                                       06134000
         ORG   HMASMMGP+28                                              06135000
PATCHTPA DS    CL80                                                     06136000
         ORG   PATCHTPA                                                 06137000
@NM00142 DC    80X'FF'                                                  06138000
         ORG   PATCHTPA+80                                              06139000
TPAFLAGS DS    BL4                                                      06140000
         ORG   TPAFLAGS                                                 06141000
@NM00143 DS    BL1                                                      06142000
@NM00144 DS    BL1                                                      06143000
@NM00145 DS    BL1                                                      06144000
@NM00146 DS    BL1                                                      06145000
         ORG   TPAFLAGS+4                                               06146000
KEYSCLGN DS    CL15                                                     06147000
TPATSL2  DS    CL10                                                     06148000
TPATSS2  DS    CL256                                                    06149000
DELFLAGS DS    BL1                                                      06150000
         ORG   DELFLAGS                                                 06151000
ENDFUNC  DS    BL1                                                      06152000
DELSKIP  EQU   DELFLAGS+0                                               06153000
@NM00147 EQU   DELFLAGS+0                                               06154000
DELGET   EQU   DELFLAGS+0                                               06155000
@NM00148 EQU   DELFLAGS+0                                               06156000
         ORG   DELFLAGS+1                                               06157000
DELSCL   DS    CL17                                                     06158000
DSCFLAGS DS    CL1                                                      06159000
         ORG   DSCFLAGS                                                 06160000
DSCEOLST DS    BL1                                                      06161000
@NM00149 EQU   DSCFLAGS+0                                               06162000
         ORG   DSCFLAGS+1                                               06163000
F1BFLAGS DS    BL1                                                      06164000
         ORG   F1BFLAGS                                                 06165000
F1BCMP   DS    BL1                                                      06166000
F1BL1END EQU   F1BFLAGS+0                                               06167000
F1BSKIP  EQU   F1BFLAGS+0                                               06168000
@NM00150 EQU   F1BFLAGS+0                                               06169000
         ORG   F1BFLAGS+1                                               06170000
F2BFLAGS DS    BL1                                                      06171000
         ORG   F2BFLAGS                                                 06172000
F2BCMP   DS    BL1                                                      06173000
F2BL2END EQU   F2BFLAGS+0                                               06174000
F2BSKIP  EQU   F2BFLAGS+0                                               06175000
F2BGET   EQU   F2BFLAGS+0                                               06176000
@NM00151 EQU   F2BFLAGS+0                                               06177000
         ORG   F2BFLAGS+1                                               06178000
F2BSCL   DS    CL17                                                     06179000
SRVFLAGS DS    BL1                                                      06180000
         ORG   SRVFLAGS                                                 06181000
SRVCMP   DS    BL1                                                      06182000
SRVEND   EQU   SRVFLAGS+0                                               06183000
SRVSKIP  EQU   SRVFLAGS+0                                               06184000
SRVGET   EQU   SRVFLAGS+0                                               06185000
SRVREC   EQU   SRVFLAGS+0                                               06186000
@NM00152 EQU   SRVFLAGS+0                                               06187000
         ORG   SRVFLAGS+1                                               06188000
SRVSCL   DS    CL17                                                     06189000
SELCFLGS DS    CL1                                                      06190000
         ORG   SELCFLGS                                                 06191000
SELCEOF  DS    BL1                                                      06192000
@NM00153 EQU   SELCFLGS+0                                               06193000
         ORG   SELCFLGS+1                                               06194000
SUPSFLGS DS    CL1                                                      06195000
         ORG   SUPSFLGS                                                 06196000
@NM00154 DS    BL1                                                      06197000
         ORG   SUPSFLGS+1                                               06198000
GNLFLAGS DS    BL1                                                      06199000
         ORG   GNLFLAGS                                                 06200000
GNLPOSIT DS    BL1                                                      06201000
GNLSKIP1 EQU   GNLFLAGS+0                                               06202000
@NM00155 EQU   GNLFLAGS+0                                               06203000
         ORG   GNLFLAGS+1                                               06204000
NPCFLAGS DS    CL1                                                      06205000
         ORG   NPCFLAGS                                                 06206000
NPCFOUND DS    BL1                                                      06207000
NPCEOLST EQU   NPCFLAGS+0                                               06208000
@NM00156 EQU   NPCFLAGS+0                                               06209000
         ORG   NPCFLAGS+1                                               06210000
DLCFLAGS DS    CL1                                                      06211000
         ORG   DLCFLAGS                                                 06212000
DLCFOUND DS    BL1                                                      06213000
DLCEOLST EQU   DLCFLAGS+0                                               06214000
@NM00157 EQU   DLCFLAGS+0                                               06215000
         ORG   DLCFLAGS+1                                               06216000
GRASTAT  DS    BL1                                                      06217000
GRAIFOPT DS    CL1                                                      06218000
SSTFLAGS DS    CL1                                                      06219000
         ORG   SSTFLAGS                                                 06220000
SSTEOF   DS    BL1                                                      06221000
SSTFOUND EQU   SSTFLAGS+0                                               06222000
SSTOK    EQU   SSTFLAGS+0                                               06223000
@NM00158 EQU   SSTFLAGS+0                                               06224000
         ORG   SSTFLAGS+1                                               06225000
LNXCSCL  DS    CL17                                                     06226000
AMBNAME  DS    CL7                                                      06227000
AMBSCL2  DS    CL17                                                     06228000
AMBFLAGS DS    CL1                                                      06229000
         ORG   AMBFLAGS                                                 06230000
AMBEND   DS    BL1                                                      06231000
@NM00159 EQU   AMBFLAGS+0                                               06232000
         ORG   AMBFLAGS+1                                               06233000
SUPFLAGS DS    CL1                                                      06234000
         ORG   SUPFLAGS                                                 06235000
SUPEOLST DS    BL1                                                      06236000
SUPICEND EQU   SUPFLAGS+0                                               06237000
@NM00160 EQU   SUPFLAGS+0                                               06238000
         ORG   SUPFLAGS+1                                               06239000
LISTNMS  DC    CL1'1'                                                   06240000
         DC    CL1'2'                                                   06241000
         DC    CL1'3'                                                   06242000
         DC    CL1'4'                                                   06243000
         DC    CL1'5'                                                   06244000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06245000
@01      EQU   01                                                       06246000
@02      EQU   02                                                       06247000
@03      EQU   03                                                       06248000
@04      EQU   04                                                       06249000
@05      EQU   05                                                       06250000
@06      EQU   06                                                       06251000
@07      EQU   07                                                       06252000
@08      EQU   08                                                       06253000
@09      EQU   09                                                       06254000
@10      EQU   10                                                       06255000
@11      EQU   11                                                       06256000
@12      EQU   12                                                       06257000
@13      EQU   13                                                       06258000
@14      EQU   14                                                       06259000
@15      EQU   15                                                       06260000
SUPRC    EQU   @03                                                      06261000
AMBRC    EQU   @03                                                      06262000
APVRC    EQU   @02                                                      06263000
SMIRC    EQU   @03                                                      06264000
LNXRC    EQU   @03                                                      06265000
VDCRC    EQU   @03                                                      06266000
VDCFMID@ EQU   @04                                                      06267000
VRBRC    EQU   @03                                                      06268000
ADDIPTFX EQU   @04                                                      06269000
ADDIRC   EQU   @03                                                      06270000
GETSMDRC EQU   @02                                                      06271000
SSTRC    EQU   @03                                                      06272000
SSTNDX   EQU   @02                                                      06273000
SSTSVKLN EQU   @04                                                      06274000
GRASOFFS EQU   @02                                                      06275000
GRAPTR   EQU   @03                                                      06276000
GRAIRQX  EQU   @03                                                      06277000
GRAREQX  EQU   @03                                                      06278000
GRAPREX  EQU   @03                                                      06279000
GRAPTFX  EQU   @02                                                      06280000
GRARC    EQU   @04                                                      06281000
DLCRTN@  EQU   @04                                                      06282000
DLCICTP  EQU   @05                                                      06283000
DLCRC    EQU   @03                                                      06284000
DLCLSOFF EQU   @02                                                      06285000
NPCRTN@  EQU   @05                                                      06286000
NPCICTP  EQU   @04                                                      06287000
NPCRC    EQU   @03                                                      06288000
NPCLSOFF EQU   @02                                                      06289000
GNLRC    EQU   @02                                                      06290000
TERMRC   EQU   @02                                                      06291000
SUPSX2   EQU   @05                                                      06292000
SUPSX1   EQU   @04                                                      06293000
SUPSRC   EQU   @03                                                      06294000
SELCHKRC EQU   @02                                                      06295000
SELFNDRC EQU   @02                                                      06296000
SRVLISTX EQU   @04                                                      06297000
SRVRC    EQU   @03                                                      06298000
F2BRC    EQU   @03                                                      06299000
F1BRC    EQU   @03                                                      06300000
DSCRC    EQU   @02                                                      06301000
DELRC    EQU   @03                                                      06302000
INITRC   EQU   @02                                                      06303000
TPARC    EQU   @03                                                      06304000
CCAPTR   EQU   @11                                                      06305000
RTNCODE  EQU   @15                                                      06306000
RTNREG   EQU   @14                                                      06307000
TBLXOPTS EQU   0                                                        06308000
TBLFLAGS EQU   TBLXOPTS+8                                               06309000
TBLFLG1  EQU   TBLFLAGS                                                 06310000
TBLNOAPP EQU   TBLFLG1                                                  06311000
TBLFLG2  EQU   TBLFLAGS+2                                               06312000
TBLSEL   EQU   TBLFLG2                                                  06313000
TBLGROUP EQU   TBLFLG2                                                  06314000
TBLFLG3  EQU   TBLFLAGS+3                                               06315000
TBLFLG4  EQU   TBLFLAGS+5                                               06316000
TBLFLG5  EQU   TBLFLAGS+7                                               06317000
HMASMCCA EQU   0                                                        06318000
CCAFBUFR EQU   HMASMCCA+4                                               06319000
CCADSAD  EQU   CCAFBUFR+124                                             06320000
CCATPAD  EQU   CCAFBUFR+128                                             06321000
CCAFLAG7 EQU   CCAFBUFR+132                                             06322000
CCAFIOP  EQU   HMASMCCA+140                                             06323000
CCAIOPTR EQU   CCAFIOP                                                  06324000
CCAFSYS  EQU   HMASMCCA+148                                             06325000
CCASREL  EQU   CCAFSYS+12                                               06326000
CCAFLAGA EQU   CCAFSYS+21                                               06327000
CCAFSTA  EQU   HMASMCCA+188                                             06328000
CCAFICT  EQU   HMASMCCA+192                                             06329000
CCAICPTF EQU   CCAFICT+4                                                06330000
CCAFPGM  EQU   HMASMCCA+208                                             06331000
CCABLDLP EQU   CCAFPGM                                                  06332000
CCADBLDL EQU   CCAFPGM+4                                                06333000
CCAFGTP  EQU   HMASMCCA+224                                             06334000
CCASEGTP EQU   CCAFGTP                                                  06335000
@NM00023 EQU   HMASMCCA+244                                             06336000
CCAFFUNC EQU   HMASMCCA+264                                             06337000
CCAFLAG1 EQU   CCAFFUNC+8                                               06338000
CCAACCPT EQU   CCAFLAG1                                                 06339000
CCAFLAG2 EQU   CCAFFUNC+11                                              06340000
CCAFPROC EQU   HMASMCCA+276                                             06341000
CCAFLAG3 EQU   CCAFPROC                                                 06342000
CCAFDIS  EQU   HMASMCCA+278                                             06343000
CCAFLAG4 EQU   CCAFDIS                                                  06344000
CCAFLAG5 EQU   CCAFDIS+1                                                06345000
CCAFLAG6 EQU   CCAFDIS+2                                                06346000
CCAFCNV  EQU   HMASMCCA+281                                             06347000
CCAFLAG8 EQU   CCAFCNV                                                  06348000
CCAFCTL  EQU   HMASMCCA+282                                             06349000
CCAFLAG9 EQU   CCAFCTL                                                  06350000
CCAFDSNG EQU   HMASMCCA+298                                             06351000
CCAFLAGB EQU   CCAFDSNG                                                 06352000
CCADSIDA EQU   0                                                        06353000
CCABLDLA EQU   0                                                        06354000
@NM00039 EQU   CCABLDLA                                                 06355000
CCABLDLL EQU   0                                                        06356000
@NM00041 EQU   CCABLDLL                                                 06357000
CCALKDRC EQU   @NM00041+20                                              06358000
@NM00043 EQU   CCABLDLL+124                                             06359000
CCAASMRC EQU   @NM00043+20                                              06360000
@NM00045 EQU   CCABLDLL+248                                             06361000
CCACPYRC EQU   @NM00045+20                                              06362000
@NM00047 EQU   CCABLDLL+372                                             06363000
CCACOMRC EQU   @NM00047+20                                              06364000
@NM00049 EQU   CCABLDLL+496                                             06365000
CCAZAPRC EQU   @NM00049+20                                              06366000
@NM00051 EQU   CCABLDLL+620                                             06367000
CCASUPRC EQU   @NM00051+20                                              06368000
@NM00053 EQU   CCABLDLL+744                                             06369000
CCAUPDRC EQU   @NM00053+20                                              06370000
CCABLDLM EQU   0                                                        06371000
CCABELMT EQU   CCABLDLM+4                                               06372000
CCABMPOS EQU   CCABELMT                                                 06373000
HMASMIOP EQU   0                                                        06374000
IOPDSID  EQU   HMASMIOP                                                 06375000
IOPFUNCT EQU   HMASMIOP+1                                               06376000
IOPRETRN EQU   HMASMIOP+2                                               06377000
IOPTYPE  EQU   HMASMIOP+3                                               06378000
IOPNAME  EQU   HMASMIOP+4                                               06379000
IOPNAM17 EQU   IOPNAME                                                  06380000
@NM00057 EQU   HMASMIOP+12                                              06381000
@NM00058 EQU   @NM00057                                                 06382000
IOPDDNAM EQU   HMASMIOP+24                                              06383000
IOPDRMAP EQU   HMASMIOP+56                                              06384000
IOPINAME EQU   IOPDRMAP                                                 06385000
IOPINAM  EQU   IOPINAME                                                 06386000
IOPITYP  EQU   IOPINAM                                                  06387000
IOPUSERL EQU   IOPDRMAP+11                                              06388000
IOPEND   EQU   IOPDRMAP+12                                              06389000
ICTPTF   EQU   0                                                        06390000
ICTPTFS  EQU   ICTPTF                                                   06391000
ICTPEND  EQU   ICTPTFS                                                  06392000
ICTPFLG1 EQU   ICTPTF+7                                                 06393000
ICTPFLG3 EQU   ICTPTF+8                                                 06394000
ICTPPROC EQU   ICTPFLG3                                                 06395000
ICTPNOGO EQU   ICTPFLG3                                                 06396000
ICTPSLST EQU   ICTPFLG3                                                 06397000
ICTPFLG5 EQU   ICTPTF+9                                                 06398000
ICTPFLG6 EQU   ICTPTF+11                                                06399000
ICTPFLF  EQU   ICTPFLG6                                                 06400000
ICTFLF   EQU   ICTPFLF                                                  06401000
ICTPFLG2 EQU   ICTPTF+12                                                06402000
ICTPFLG4 EQU   ICTPTF+13                                                06403000
ICTPREDO EQU   ICTPFLG4                                                 06404000
ICTPDEXP EQU   ICTPFLG4                                                 06405000
ICTPDIMP EQU   ICTPFLG4                                                 06406000
ICTPFLG8 EQU   ICTPTF+14                                                06407000
ICTPFLG9 EQU   ICTPTF+15                                                06408000
@NM00100 EQU   ICTPFLG9                                                 06409000
ICTPFLGA EQU   ICTPTF+16                                                06410000
ICTPUSR1 EQU   ICTPFLGA                                                 06411000
ICTPPASS EQU   ICTPUSR1                                                 06412000
ICTPSUPN EQU   ICTPTF+20                                                06413000
ICTPFMID EQU   ICTPTF+22                                                06414000
ICTPCHN  EQU   ICTPTF+64                                                06415000
ICTPRCHN EQU   ICTPTF+68                                                06416000
ICTPSCHN EQU   ICTPTF+72                                                06417000
ICTPPCHN EQU   ICTPTF+76                                                06418000
ICTPICHN EQU   ICTPTF+80                                                06419000
ICTPNCHN EQU   ICTPTF+84                                                06420000
ICTPVCHN EQU   ICTPTF+88                                                06421000
ICTPDCHN EQU   ICTPTF+92                                                06422000
ICTPBCHN EQU   ICTPTF+96                                                06423000
ICTIXPF  EQU   0                                                        06424000
ICTENTLS EQU   0                                                        06425000
ICTENTNT EQU   ICTENTLS                                                 06426000
ICTENTNM EQU   ICTENTNT                                                 06427000
ICTENTST EQU   ICTENTNT+7                                               06428000
ICTREQLS EQU   0                                                        06429000
ICTREQNT EQU   ICTREQLS                                                 06430000
ICTREQNM EQU   ICTREQNT                                                 06431000
ICTREQND EQU   ICTREQNM                                                 06432000
ICTREQST EQU   ICTREQNT+7                                               06433000
ICTSUPLS EQU   0                                                        06434000
ICTSUPNT EQU   ICTSUPLS                                                 06435000
ICTSUPNM EQU   ICTSUPNT                                                 06436000
ICTSUPND EQU   ICTSUPNM                                                 06437000
ICTPRELS EQU   0                                                        06438000
ICTPRENT EQU   ICTPRELS                                                 06439000
ICTPRENM EQU   ICTPRENT                                                 06440000
ICTPREND EQU   ICTPRENM                                                 06441000
ICTPREST EQU   ICTPRENT+7                                               06442000
ICTIRQLS EQU   0                                                        06443000
ICTIRQNT EQU   ICTIRQLS                                                 06444000
ICTIRQNM EQU   ICTIRQNT                                                 06445000
ICTIRQND EQU   ICTIRQNM                                                 06446000
ICTIRQST EQU   ICTIRQNT+7                                               06447000
ICTIREQI EQU   ICTIRQST                                                 06448000
ICTCSRST EQU   ICTIRQNT+15                                              06449000
ICTNPRLS EQU   0                                                        06450000
ICTNPRNT EQU   ICTNPRLS                                                 06451000
ICTNPRNM EQU   ICTNPRNT                                                 06452000
ICTVRSLS EQU   0                                                        06453000
ICTVRSNT EQU   ICTVRSLS                                                 06454000
ICTVRSNM EQU   ICTVRSNT                                                 06455000
ICTDELLS EQU   0                                                        06456000
ICTDELNT EQU   ICTDELLS                                                 06457000
ICTDELNM EQU   ICTDELNT                                                 06458000
ICTDELST EQU   ICTDELNT+7                                               06459000
ICTSBYLS EQU   0                                                        06460000
ICTSBYNT EQU   ICTSBYLS                                                 06461000
ICTSBYNM EQU   ICTSBYNT                                                 06462000
HMASMSET EQU   0                                                        06463000
SELSTENT EQU   HMASMSET                                                 06464000
SELSTFLG EQU   SELSTENT                                                 06465000
SESMD    EQU   SELSTFLG                                                 06466000
SENAME   EQU   SELSTENT+2                                               06467000
SESMDNO  EQU   SENAME                                                   06468000
SEFLAGS  EQU   HMASMSET+10                                              06469000
SEFLAG2  EQU   HMASMSET+11                                              06470000
SEFLAG2A EQU   SEFLAG2                                                  06471000
HMASMGTP EQU   0                                                        06472000
GTPFUNCT EQU   HMASMGTP                                                 06473000
GTPRETRN EQU   HMASMGTP+1                                               06474000
GTPKEYLN EQU   HMASMGTP+6                                               06475000
GTPBUFAD EQU   HMASMGTP+12                                              06476000
GTPRESTR EQU   HMASMGTP+16                                              06477000
GTPFLGS1 EQU   HMASMGTP+26                                              06478000
SCLMAP   EQU   0                                                        06479000
SCLKEY   EQU   SCLMAP                                                   06480000
SCLISTNO EQU   SCLKEY                                                   06481000
SCLSMD   EQU   SCLKEY+1                                                 06482000
SCLFMID  EQU   SCLKEY+8                                                 06483000
SCLDATA  EQU   SCLMAP+15                                                06484000
SCLSTAT  EQU   SCLDATA                                                  06485000
SCLDELP  EQU   SCLSTAT                                                  06486000
SCLSELST EQU   SCLSTAT                                                  06487000
SCLCAND  EQU   SCLSTAT                                                  06488000
SCLREDO  EQU   SCLSTAT                                                  06489000
SCLVERNO EQU   SCLDATA+1                                                06490000
TSLPARMS EQU   0                                                        06491000
TSLTBLXP EQU   TSLPARMS                                                 06492000
TSLPMLAD EQU   TSLPARMS+4                                               06493000
TSLFUNCT EQU   TSLPARMS+8                                               06494000
TSLRETRN EQU   TSLPARMS+9                                               06495000
TSLICTSR EQU   0                                                        06496000
TSLISMD  EQU   TSLICTSR                                                 06497000
TSLIOPTF EQU   TSLICTSR+7                                               06498000
TSLICTP  EQU   TSLICTSR+8                                               06499000
TSLICTF  EQU   TSLICTSR+12                                              06500000
TSLIFND  EQU   TSLICTF                                                  06501000
TSLIOK   EQU   TSLICTF                                                  06502000
TSLISUP  EQU   TSLICTF                                                  06503000
TSLLSTSR EQU   0                                                        06504000
TSLLSMD  EQU   TSLLSTSR                                                 06505000
TSLLOPTF EQU   TSLLSTSR+7                                               06506000
TSLLONXT EQU   TSLLOPTF                                                 06507000
TSLLOFST EQU   TSLLSTSR+8                                               06508000
TSLLRTNP EQU   TSLLSTSR+12                                              06509000
TSLGET   EQU   0                                                        06510000
TSLGOPTF EQU   TSLGET+7                                                 06511000
TSLSICDS EQU   0                                                        06512000
TSLSSMD  EQU   TSLSICDS                                                 06513000
TSLSOPTF EQU   TSLSICDS+7                                               06514000
TSLSOICT EQU   TSLSOPTF                                                 06515000
TSLSOCDS EQU   TSLSOPTF                                                 06516000
TSLSIOPP EQU   TSLSICDS+12                                              06517000
TSLSICTF EQU   TSLSICDS+16                                              06518000
TSLSIOK  EQU   TSLSICTF                                                 06519000
TSLSISUP EQU   TSLSICTF                                                 06520000
TSLSCDSF EQU   TSLSICDS+18                                              06521000
TSLSCFND EQU   TSLSCDSF                                                 06522000
TSLSCOK  EQU   TSLSCDSF                                                 06523000
TSLSCSUP EQU   TSLSCDSF                                                 06524000
TSLSCDEL EQU   TSLSCDSF                                                 06525000
TSLENTSR EQU   0                                                        06526000
TSLETYPE EQU   TSLENTSR                                                 06527000
TSLEVER# EQU   TSLENTSR+1                                               06528000
TSLEOPTF EQU   TSLENTSR+2                                               06529000
TSLEONXT EQU   TSLEOPTF                                                 06530000
TSLEBGNP EQU   TSLENTSR+8                                               06531000
TSLEFNDP EQU   TSLENTSR+12                                              06532000
TSLMFUNC EQU   0                                                        06533000
TSLRELM  EQU   0                                                        06534000
BASEDSMD EQU   0                                                        06535000
CCATYPEA EQU   0                                                        06536000
TBLXPARM EQU   0                                                        06537000
TBLXINDX EQU   TBLXPARM+4                                               06538000
TBLXIOP2 EQU   TBLXPARM+16                                              06539000
TBLXIOPF EQU   TBLXPARM+20                                              06540000
TBLXSEGT EQU   TBLXPARM+24                                              06541000
TBLXTBL  EQU   TBLXPARM+28                                              06542000
TBLXTOP  EQU   TBLXPARM+32                                              06543000
TBLXSCGT EQU   TBLXPARM+52                                              06544000
TBLXFUNC EQU   TBLXPARM+64                                              06545000
TBLXFUND EQU   TBLXPARM+72                                              06546000
TBLXFLG1 EQU   TBLXPARM+80                                              06547000
TBLXTSLP EQU   TBLXPARM+84                                              06548000
TBLXRC   EQU   TBLXPARM+92                                              06549000
DSCVER#  EQU   0                                                        06550000
DSCIOP   EQU   0                                                        06551000
SELFNAME EQU   0                                                        06552000
GNLLIST# EQU   0                                                        06553000
GNLPREV@ EQU   0                                                        06554000
GNLSCL   EQU   0                                                        06555000
NPCIOP   EQU   0                                                        06556000
NPCVER#  EQU   0                                                        06557000
DLCIOP   EQU   0                                                        06558000
DLCVER#  EQU   0                                                        06559000
SSTSMD   EQU   0                                                        06560000
SSTSTAT  EQU   0                                                        06561000
SSTREDO  EQU   0                                                        06562000
GETSIOP  EQU   0                                                        06563000
GETSSMD  EQU   0                                                        06564000
VRBTYPE  EQU   0                                                        06565000
VRBIOP   EQU   0                                                        06566000
VRBSCL   EQU   0                                                        06567000
VRBICTP  EQU   0                                                        06568000
VDCIOP   EQU   0                                                        06569000
VDCSCL   EQU   0                                                        06570000
LNXIOP   EQU   0                                                        06571000
LNXLST   EQU   0                                                        06572000
LNXCKEY@ EQU   0                                                        06573000
SMIIOP   EQU   0                                                        06574000
SMISCL   EQU   0                                                        06575000
SMIICTP  EQU   0                                                        06576000
FFMSMD   EQU   0                                                        06577000
APVSCL   EQU   0                                                        06578000
AMBSCL   EQU   0                                                        06579000
SUPTYPE  EQU   0                                                        06580000
SUPSCL   EQU   0                                                        06581000
SUPIOP   EQU   0                                                        06582000
SUPSUPN  EQU   0                                                        06583000
IOPUDATA EQU   IOPEND                                                   06584000
IOPNTMAP EQU   IOPDRMAP                                                 06585000
IOPCDMAP EQU   IOPNTMAP                                                 06586000
IOPPTMAP EQU   IOPCDMAP                                                 06587000
IOPSCMAP EQU   IOPPTMAP                                                 06588000
IOPDIRCT EQU   IOPSCMAP+12                                              06589000
IOPCDMAX EQU   IOPDIRCT                                                 06590000
IOPPTFNT EQU   IOPUDATA                                                 06591000
IOPPTFDR EQU   IOPPTFNT                                                 06592000
IOPPSTAT EQU   IOPPTFDR+2                                               06593000
IOPPTFF1 EQU   IOPPSTAT                                                 06594000
IOPFLGS5 EQU   IOPPTFF1                                                 06595000
IOPPTFF2 EQU   IOPPSTAT+1                                               06596000
IOPPTFF3 EQU   IOPPSTAT+3                                               06597000
IOPSBYP  EQU   IOPPTFF3                                                 06598000
IOPFLF   EQU   IOPPTFF3                                                 06599000
IOPPTFFX EQU   IOPPTFNT+24                                              06600000
@NM00072 EQU   IOPPTFFX                                                 06601000
@NM00073 EQU   @NM00072                                                 06602000
IOPPDTES EQU   IOPPTFFX+41                                              06603000
@NM00076 EQU   IOPPDTES                                                 06604000
IOPPTPFX EQU   IOPPDTES+6                                               06605000
IOPDATES EQU   IOPPTPFX                                                 06606000
IOPPTEND EQU   IOPPTFNT+104                                             06607000
IOPPTFVR EQU   IOPPTEND                                                 06608000
IOPPNTRY EQU   IOPPTFVR                                                 06609000
IOPPMODS EQU   IOPPNTRY                                                 06610000
IOPENTNT EQU   IOPUDATA+104                                             06611000
IOPSRLNT EQU   IOPUDATA+104                                             06612000
IOPPRENT EQU   IOPUDATA+104                                             06613000
IOPNPRNT EQU   IOPUDATA+104                                             06614000
IOPSUPNT EQU   IOPUDATA+104                                             06615000
IOPREQNT EQU   IOPUDATA+104                                             06616000
IOPIRQNT EQU   IOPUDATA+104                                             06617000
IOPFIDNT EQU   IOPUDATA+104                                             06618000
IOPDELNT EQU   IOPUDATA+104                                             06619000
IOPVERNT EQU   IOPUDATA+104                                             06620000
IOPSBYNT EQU   IOPUDATA+104                                             06621000
ICTENDNT EQU   ICTENDCH                                                 06622000
ICTENDIX EQU   ICTENDCH                                                 06623000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06624000
@NM00089 EQU   IOPSBYNT+8                                               06625000
IOPSBYST EQU   IOPSBYNT+7                                               06626000
IOPSBYNM EQU   IOPSBYNT                                                 06627000
@NM00088 EQU   IOPVERNT+8                                               06628000
IOPVERST EQU   IOPVERNT+7                                               06629000
IOPVERNM EQU   IOPVERNT                                                 06630000
@NM00087 EQU   IOPDELNT+8                                               06631000
IOPDELST EQU   IOPDELNT+7                                               06632000
IOPDELNM EQU   IOPDELNT                                                 06633000
@NM00086 EQU   IOPFIDNT+8                                               06634000
IOPFIDST EQU   IOPFIDNT+7                                               06635000
IOPFIDNM EQU   IOPFIDNT                                                 06636000
@NM00085 EQU   IOPIRQNT+8                                               06637000
IOPIRQST EQU   IOPIRQNT+7                                               06638000
IOPIRQNM EQU   IOPIRQNT                                                 06639000
@NM00084 EQU   IOPREQNT+8                                               06640000
IOPREQST EQU   IOPREQNT+7                                               06641000
IOPREQNM EQU   IOPREQNT                                                 06642000
@NM00083 EQU   IOPSUPNT+8                                               06643000
IOPSUPST EQU   IOPSUPNT+7                                               06644000
IOPSUPNM EQU   IOPSUPNT                                                 06645000
@NM00082 EQU   IOPNPRNT+8                                               06646000
IOPNPRST EQU   IOPNPRNT+7                                               06647000
IOPNPRNM EQU   IOPNPRNT                                                 06648000
@NM00081 EQU   IOPPRENT+8                                               06649000
IOPPREST EQU   IOPPRENT+7                                               06650000
IOPPRENM EQU   IOPPRENT                                                 06651000
@NM00080 EQU   IOPSRLNT+8                                               06652000
IOPSRLST EQU   IOPSRLNT+7                                               06653000
@NM00079 EQU   IOPSRLNT+4                                               06654000
IOPSRLNM EQU   IOPSRLNT                                                 06655000
@NM00078 EQU   IOPENTNT+8                                               06656000
IOPENTST EQU   IOPENTNT+7                                               06657000
IOPENTNM EQU   IOPENTNT                                                 06658000
IOPPIND  EQU   IOPPNTRY+8                                               06659000
IOPPTFND EQU   IOPPMODS                                                 06660000
IOPPFMID EQU   IOPPTFFX+73                                              06661000
@NM00077 EQU   IOPPTPFX+24                                              06662000
IOPUCLT  EQU   IOPDATES+21                                              06663000
IOPUCLD  EQU   IOPDATES+18                                              06664000
IOPACCT  EQU   IOPDATES+15                                              06665000
IOPACCD  EQU   IOPDATES+12                                              06666000
IOPRSTT  EQU   IOPDATES+9                                               06667000
IOPRSTD  EQU   IOPDATES+6                                               06668000
IOPAPPT  EQU   IOPDATES+3                                               06669000
IOPAPPD  EQU   IOPDATES                                                 06670000
IOPRECT  EQU   @NM00076+3                                               06671000
IOPRECD  EQU   @NM00076                                                 06672000
@NM00075 EQU   IOPPTFFX+8                                               06673000
@NM00074 EQU   @NM00072+7                                               06674000
IOPPRELN EQU   @NM00073                                                 06675000
@NM00071 EQU   IOPPTFDR+20                                              06676000
IOPSBYNO EQU   IOPPTFDR+13                                              06677000
IOPDBYNO EQU   IOPPTFDR+6                                               06678000
@NM00070 EQU   IOPPTFF3                                                 06679000
IOPDBYP  EQU   IOPPTFF3                                                 06680000
IOPPMDLP EQU   IOPPTFF2+1                                               06681000
IOPPADDP EQU   IOPPTFF2+1                                               06682000
@NM00069 EQU   IOPPTFF2+1                                               06683000
IOPLRFP  EQU   IOPPTFF2                                                 06684000
IOPJCLP  EQU   IOPPTFF2                                                 06685000
IOPSUPP  EQU   IOPPTFF2                                                 06686000
IOPREQP  EQU   IOPPTFF2                                                 06687000
IOPPREP  EQU   IOPPTFF2                                                 06688000
IOPNPRP  EQU   IOPPTFF2                                                 06689000
IOPIRQP  EQU   IOPPTFF2                                                 06690000
IOPDELP  EQU   IOPPTFF2                                                 06691000
IOPREGEN EQU   IOPFLGS5                                                 06692000
IOPBYP   EQU   IOPFLGS5                                                 06693000
IOPDUMMP EQU   IOPFLGS5                                                 06694000
@NM00068 EQU   IOPFLGS5                                                 06695000
IOPERROR EQU   IOPFLGS5                                                 06696000
IOPACC   EQU   IOPFLGS5                                                 06697000
IOPRES   EQU   IOPFLGS5                                                 06698000
IOPAPP   EQU   IOPFLGS5                                                 06699000
IOPPTYPE EQU   IOPPTFDR+1                                               06700000
@NM00067 EQU   IOPPTFDR                                                 06701000
IOPPTMAX EQU   IOPCDMAX                                                 06702000
@NM00066 EQU   IOPSCMAP+11                                              06703000
@NM00065 EQU   IOPSCMAP+8                                               06704000
@NM00064 EQU   IOPSCMAP                                                 06705000
TBLXEND0 EQU   TBLXPARM+124                                             06706000
@NM00007 EQU   TBLXPARM+108                                             06707000
TBLXIOP3 EQU   TBLXPARM+104                                             06708000
TBLXD2GT EQU   TBLXPARM+100                                             06709000
TBLXDLGT EQU   TBLXPARM+96                                              06710000
@NM00006 EQU   TBLXRC+3                                                 06711000
TBLXIRC  EQU   TBLXRC+2                                                 06712000
TBLXLRC  EQU   TBLXRC+1                                                 06713000
TBLXTRC  EQU   TBLXRC                                                   06714000
TBLXIBGN EQU   TBLXPARM+88                                              06715000
@NM00005 EQU   TBLXPARM+83                                              06716000
@NM00004 EQU   TBLXPARM+82                                              06717000
@NM00003 EQU   TBLXPARM+81                                              06718000
@NM00002 EQU   TBLXFLG1                                                 06719000
TBLXTCRC EQU   TBLXFLG1                                                 06720000
@NM00001 EQU   TBLXPARM+62                                              06721000
TBLXCRQI EQU   TBLXPARM+61                                              06722000
TBLXCDSI EQU   TBLXPARM+60                                              06723000
TBLXLMGT EQU   TBLXPARM+56                                              06724000
TBLXSREL EQU   TBLXPARM+48                                              06725000
TBLXASGT EQU   TBLXPARM+44                                              06726000
TBLXIFGT EQU   TBLXPARM+40                                              06727000
TBLXNULL EQU   TBLXPARM+36                                              06728000
TBLXEND  EQU   TBLXINDX+8                                               06729000
TBLXSTRT EQU   TBLXINDX+4                                               06730000
TBLXCUR  EQU   TBLXINDX                                                 06731000
TBLXHDR  EQU   TBLXPARM                                                 06732000
TSLRRTNP EQU   TSLRELM+12                                               06733000
TSLRAPTR EQU   TSLRELM+8                                                06734000
@NM00141 EQU   TSLRELM+7                                                06735000
TSLRSMD  EQU   TSLRELM                                                  06736000
TSLMSMD  EQU   TSLMFUNC+1                                               06737000
TSLMTYPE EQU   TSLMFUNC                                                 06738000
TSLENMEP EQU   TSLENTSR+4                                               06739000
@NM00140 EQU   TSLENTSR+3                                               06740000
@NM00139 EQU   TSLEOPTF                                                 06741000
@NM00138 EQU   TSLSICDS+19                                              06742000
TSLSDUM  EQU   TSLSCDSF                                                 06743000
TSLSCERR EQU   TSLSCDSF                                                 06744000
@NM00137 EQU   TSLSCDSF                                                 06745000
@NM00136 EQU   TSLSCDSF                                                 06746000
@NM00135 EQU   TSLSICDS+17                                              06747000
TSLSISLS EQU   TSLSICTF                                                 06748000
TSLSINOG EQU   TSLSICTF                                                 06749000
TSLSIDLI EQU   TSLSICTF                                                 06750000
TSLSIDLE EQU   TSLSICTF                                                 06751000
TSLSIDEL EQU   TSLSICTF                                                 06752000
TSLSIFND EQU   TSLSICTF                                                 06753000
TSLSICTP EQU   TSLSICDS+8                                               06754000
@NM00134 EQU   TSLSOPTF                                                 06755000
TSLSOXTD EQU   TSLSOPTF                                                 06756000
TSLSOMSG EQU   TSLSOPTF                                                 06757000
TSLSOALL EQU   TSLSOPTF                                                 06758000
TSLGDSID EQU   TSLGET+12                                                06759000
TSLGIOPP EQU   TSLGET+8                                                 06760000
@NM00133 EQU   TSLGOPTF                                                 06761000
TSLGOXTD EQU   TSLGOPTF                                                 06762000
TSLGOMSG EQU   TSLGOPTF                                                 06763000
@NM00132 EQU   TSLGOPTF                                                 06764000
@NM00131 EQU   TSLGOPTF                                                 06765000
@NM00130 EQU   TSLGOPTF                                                 06766000
TSLGSMD  EQU   TSLGET                                                   06767000
@NM00129 EQU   TSLLOPTF                                                 06768000
@NM00128 EQU   TSLICTSR+13                                              06769000
@NM00127 EQU   TSLICTF                                                  06770000
TSLINOG  EQU   TSLICTF                                                  06771000
TSLIDLI  EQU   TSLICTF                                                  06772000
TSLIDLE  EQU   TSLICTF                                                  06773000
TSLIDEL  EQU   TSLICTF                                                  06774000
@NM00126 EQU   TSLIOPTF                                                 06775000
TSLIONXT EQU   TSLIOPTF                                                 06776000
SCLEND   EQU   SCLDATA+2                                                06777000
@NM00125 EQU   HMASMGTP+27                                              06778000
GTPPSIZE EQU   GTPFLGS1                                                 06779000
@NM00124 EQU   GTPFLGS1                                                 06780000
GTPRCDNF EQU   GTPFLGS1                                                 06781000
GTPNOSPM EQU   GTPFLGS1                                                 06782000
GTPPOS   EQU   GTPRESTR+8                                               06783000
GTPRCD   EQU   GTPRESTR+4                                               06784000
GTPPAG   EQU   GTPRESTR                                                 06785000
GTPWKAD  EQU   HMASMGTP+8                                               06786000
GTPRCDLN EQU   HMASMGTP+4                                               06787000
@NM00123 EQU   HMASMGTP+2                                               06788000
SEFLAG2H EQU   SEFLAG2                                                  06789000
SEFLAG2G EQU   SEFLAG2                                                  06790000
SEFLAG2F EQU   SEFLAG2                                                  06791000
SEFLAG2E EQU   SEFLAG2                                                  06792000
SEFLAG2D EQU   SEFLAG2                                                  06793000
SEFLAG2C EQU   SEFLAG2                                                  06794000
SEFLAG2B EQU   SEFLAG2                                                  06795000
SEFOUND  EQU   SEFLAGS                                                  06796000
@NM00122 EQU   SEFLAGS                                                  06797000
SEFMID   EQU   SEFLAGS                                                  06798000
SENOJCL  EQU   SEFLAGS                                                  06799000
SEEXCLUD EQU   SEFLAGS                                                  06800000
SESELECT EQU   SEFLAGS                                                  06801000
SEGROUP  EQU   SEFLAGS                                                  06802000
@NM00121 EQU   SENAME+7                                                 06803000
SEPTFNO  EQU   SESMDNO                                                  06804000
SESYS    EQU   SELSTFLG+1                                               06805000
SEFMD    EQU   SELSTFLG+1                                               06806000
SEASM    EQU   SELSTFLG+1                                               06807000
SELMD    EQU   SELSTFLG+1                                               06808000
SEMAC    EQU   SELSTFLG+1                                               06809000
SEMOD    EQU   SELSTFLG+1                                               06810000
SEDLB    EQU   SELSTFLG+1                                               06811000
SESRC    EQU   SELSTFLG+1                                               06812000
SEMCS    EQU   SELSTFLG                                                 06813000
@NM00120 EQU   SELSTFLG                                                 06814000
@NM00117 EQU   ICTSBYNT+7                                               06815000
ICTSBYND EQU   ICTSBYNM                                                 06816000
ICTDELEX EQU   ICTDELST                                                 06817000
ICTDELND EQU   ICTDELNM                                                 06818000
@NM00116 EQU   ICTVRSNT+7                                               06819000
ICTVRSND EQU   ICTVRSNM                                                 06820000
@NM00115 EQU   ICTNPRNT+7                                               06821000
ICTNPRND EQU   ICTNPRNM                                                 06822000
@NM00114 EQU   ICTCSRST                                                 06823000
@NM00113 EQU   ICTCSRST                                                 06824000
ICTCSRF  EQU   ICTCSRST                                                 06825000
@NM00112 EQU   ICTCSRST                                                 06826000
ICTCSRNM EQU   ICTIRQNT+8                                               06827000
@NM00111 EQU   ICTIRQST                                                 06828000
ICTIREQT EQU   ICTIRQST                                                 06829000
ICTIREQB EQU   ICTIRQST                                                 06830000
ICTIREQS EQU   ICTIRQST                                                 06831000
@NM00110 EQU   ICTIRQST                                                 06832000
@NM00109 EQU   ICTPREST                                                 06833000
ICTPREQT EQU   ICTPREST                                                 06834000
ICTPREQI EQU   ICTPREST                                                 06835000
ICTPREQB EQU   ICTPREST                                                 06836000
ICTPREQS EQU   ICTPREST                                                 06837000
@NM00108 EQU   ICTPREST                                                 06838000
@NM00107 EQU   ICTSUPNT+7                                               06839000
@NM00106 EQU   ICTREQST                                                 06840000
ICTRREQT EQU   ICTREQST                                                 06841000
ICTRREQI EQU   ICTREQST                                                 06842000
ICTRREQB EQU   ICTREQST                                                 06843000
ICTRREQS EQU   ICTREQST                                                 06844000
@NM00105 EQU   ICTREQST                                                 06845000
@NM00104 EQU   ICTENTST                                                 06846000
ICTEREQT EQU   ICTENTST                                                 06847000
ICTEREQI EQU   ICTENTST                                                 06848000
ICTEREQB EQU   ICTENTST                                                 06849000
ICTEREQS EQU   ICTENTST                                                 06850000
@NM00103 EQU   ICTENTST                                                 06851000
ICTENTND EQU   ICTENTNM                                                 06852000
ICTIXP   EQU   ICTIXPF                                                  06853000
@NM00102 EQU   ICTPTF+100                                               06854000
ICTPTPFX EQU   ICTPTF+38                                                06855000
ICTPRELN EQU   ICTPTF+36                                                06856000
ICTPRECT EQU   ICTPTF+33                                                06857000
ICTPRECD EQU   ICTPTF+30                                                06858000
ICTPVERN EQU   ICTPTF+29                                                06859000
ICTPONUM EQU   ICTPTF+18                                                06860000
ICTPTYPE EQU   ICTPTF+17                                                06861000
ICTPUSR8 EQU   ICTPFLGA                                                 06862000
ICTPUSR7 EQU   ICTPFLGA                                                 06863000
ICTPUSR6 EQU   ICTPFLGA                                                 06864000
ICTPUSR5 EQU   ICTPFLGA                                                 06865000
ICTPUSR4 EQU   ICTPFLGA                                                 06866000
ICTPUSR3 EQU   ICTPFLGA                                                 06867000
ICTPUSR2 EQU   ICTPFLGA                                                 06868000
@NM00101 EQU   @NM00100                                                 06869000
ICTPRQBY EQU   @NM00100                                                 06870000
ICTPRQOK EQU   @NM00100                                                 06871000
ICTPRQCK EQU   @NM00100                                                 06872000
@NM00099 EQU   ICTPFLG9                                                 06873000
ICTPPDEL EQU   ICTPFLG9                                                 06874000
ICTPWRKO EQU   ICTPFLG9                                                 06875000
ICTPMSL  EQU   ICTPFLG9                                                 06876000
@NM00098 EQU   ICTPFLG8                                                 06877000
ICTPDCPL EQU   ICTPFLG8                                                 06878000
ICTPECPL EQU   ICTPFLG8                                                 06879000
ICTPGCPL EQU   ICTPFLG8                                                 06880000
@NM00097 EQU   ICTPFLG4                                                 06881000
@NM00096 EQU   ICTPFLG4                                                 06882000
@NM00095 EQU   ICTPFLG4                                                 06883000
ICTPGELM EQU   ICTPFLG4                                                 06884000
ICTPCDSE EQU   ICTPFLG4                                                 06885000
@NM00094 EQU   ICTPFLG2                                                 06886000
ICTPRCND EQU   ICTPFLG2                                                 06887000
ICTPTPS  EQU   ICTPFLG2                                                 06888000
ICTPTR1  EQU   ICTPFLG2                                                 06889000
ICTPVRSP EQU   ICTPFLG2                                                 06890000
@NM00093 EQU   ICTPFLG6                                                 06891000
ICTPDBYP EQU   ICTPFLG6                                                 06892000
ICTPSBYP EQU   ICTPFLG6                                                 06893000
ICTPMDLP EQU   ICTPFLG5+1                                               06894000
ICTPADDP EQU   ICTPFLG5+1                                               06895000
@NM00092 EQU   ICTPFLG5+1                                               06896000
ICTPLRFP EQU   ICTPFLG5                                                 06897000
ICTPJCLP EQU   ICTPFLG5                                                 06898000
ICTPSUPP EQU   ICTPFLG5                                                 06899000
ICTPREQP EQU   ICTPFLG5                                                 06900000
ICTPPREP EQU   ICTPFLG5                                                 06901000
ICTPNPRP EQU   ICTPFLG5                                                 06902000
ICTPIRQP EQU   ICTPFLG5                                                 06903000
ICTPDELP EQU   ICTPFLG5                                                 06904000
@NM00091 EQU   ICTPFLG3                                                 06905000
ICTPNOLB EQU   ICTPFLG3                                                 06906000
ICTPVERJ EQU   ICTPFLG3                                                 06907000
ICTPMSG  EQU   ICTPFLG3                                                 06908000
ICTPCPL  EQU   ICTPFLG3                                                 06909000
ICTPROCS EQU   ICTPPROC                                                 06910000
ICTREGEN EQU   ICTPFLG1                                                 06911000
ICTBYP   EQU   ICTPFLG1                                                 06912000
ICTDUMMP EQU   ICTPFLG1                                                 06913000
@NM00090 EQU   ICTPFLG1                                                 06914000
ICTERROR EQU   ICTPFLG1                                                 06915000
ICTACC   EQU   ICTPFLG1                                                 06916000
ICTRES   EQU   ICTPFLG1                                                 06917000
ICTAPP   EQU   ICTPFLG1                                                 06918000
@NM00063 EQU   IOPUSERL                                                 06919000
@NM00062 EQU   IOPUSERL                                                 06920000
IOPALIS  EQU   IOPUSERL                                                 06921000
IOPTTR   EQU   IOPDRMAP+8                                               06922000
IOPINAM2 EQU   IOPINAM+1                                                06923000
IOPITYP2 EQU   IOPITYP                                                  06924000
IOPBUFAD EQU   HMASMIOP+52                                              06925000
@NM00061 EQU   HMASMIOP+32                                              06926000
IOPDELDD EQU   IOPDDNAM                                                 06927000
@NM00060 EQU   @NM00057+10                                              06928000
IOPSEQNO EQU   @NM00057+8                                               06929000
@NM00059 EQU   @NM00058+7                                               06930000
IOPPTFNM EQU   @NM00058                                                 06931000
CCABMREC EQU   CCABELMT+10                                              06932000
CCABPOS  EQU   CCABMPOS+8                                               06933000
CCABNAME EQU   CCABMPOS                                                 06934000
@NM00056 EQU   CCABLDLM+2                                               06935000
@NM00055 EQU   CCABLDLM                                                 06936000
CCAUPDPM EQU   @NM00053+24                                              06937000
@NM00054 EQU   @NM00053+21                                              06938000
CCARUPDT EQU   CCAUPDRC                                                 06939000
CCAUPDSP EQU   @NM00053+12                                              06940000
CCAUPDTE EQU   @NM00053+8                                               06941000
CCAUPDNM EQU   @NM00053                                                 06942000
CCASUPPM EQU   @NM00051+24                                              06943000
@NM00052 EQU   @NM00051+21                                              06944000
CCARSUP  EQU   CCASUPRC                                                 06945000
CCASUPSP EQU   @NM00051+12                                              06946000
CCAIOSUP EQU   @NM00051+8                                               06947000
CCASUPNM EQU   @NM00051                                                 06948000
CCAZAPPM EQU   @NM00049+24                                              06949000
@NM00050 EQU   @NM00049+21                                              06950000
CCARZAP  EQU   CCAZAPRC                                                 06951000
CCAZAPSP EQU   @NM00049+12                                              06952000
CCASPZAP EQU   @NM00049+8                                               06953000
CCAZAPNM EQU   @NM00049                                                 06954000
CCACOMPM EQU   @NM00047+24                                              06955000
@NM00048 EQU   @NM00047+21                                              06956000
CCARCOMP EQU   CCACOMRC                                                 06957000
CCACOMSP EQU   @NM00047+12                                              06958000
CCACOMRS EQU   @NM00047+8                                               06959000
CCACOMNM EQU   @NM00047                                                 06960000
CCACPYPM EQU   @NM00045+24                                              06961000
@NM00046 EQU   @NM00045+21                                              06962000
CCARCOPY EQU   CCACPYRC                                                 06963000
CCACPYSP EQU   @NM00045+12                                              06964000
CCACOPY  EQU   @NM00045+8                                               06965000
CCACPYNM EQU   @NM00045                                                 06966000
CCAASMPM EQU   @NM00043+24                                              06967000
@NM00044 EQU   @NM00043+21                                              06968000
CCARASM  EQU   CCAASMRC                                                 06969000
CCAASMSP EQU   @NM00043+12                                              06970000
CCAASM   EQU   @NM00043+8                                               06971000
CCAASMNM EQU   @NM00043                                                 06972000
CCALKDPM EQU   @NM00041+24                                              06973000
@NM00042 EQU   @NM00041+21                                              06974000
CCARLINK EQU   CCALKDRC                                                 06975000
CCALKDSP EQU   @NM00041+12                                              06976000
CCALKED  EQU   @NM00041+8                                               06977000
CCALKDNM EQU   @NM00041                                                 06978000
CCAPGMPM EQU   @NM00039+24                                              06979000
@NM00040 EQU   @NM00039+21                                              06980000
CCABPGRC EQU   @NM00039+20                                              06981000
CCABPGSP EQU   @NM00039+12                                              06982000
CCABPGAD EQU   @NM00039+8                                               06983000
CCABPGNM EQU   @NM00039                                                 06984000
CCAEND   EQU   HMASMCCA+371                                             06985000
@NM00038 EQU   HMASMCCA+309                                             06986000
CCACURDD EQU   CCAFDSNG+3                                               06987000
CCACURDS EQU   CCAFDSNG+2                                               06988000
@NM00037 EQU   CCAFLAGB                                                 06989000
CCAOUTNG EQU   CCAFLAGB                                                 06990000
CCALOGNG EQU   CCAFLAGB                                                 06991000
CCAFMID  EQU   HMASMCCA+291                                             06992000
CCALSTDS EQU   CCAFCTL+8                                                06993000
CCARPTDS EQU   CCAFCTL+7                                                06994000
CCATIME  EQU   CCAFCTL+4                                                06995000
CCADATE  EQU   CCAFCTL+1                                                06996000
@NM00036 EQU   CCAFLAG9                                                 06997000
CCARVCAN EQU   CCAFLAG9                                                 06998000
CCARVEST EQU   CCAFLAG9                                                 06999000
CCAPTSNJ EQU   CCAFLAG9                                                 07000000
CCASTSNP EQU   CCAFLAG9                                                 07001000
CCAMTSNP EQU   CCAFLAG9                                                 07002000
CCAPTSNP EQU   CCAFLAG9                                                 07003000
@NM00035 EQU   CCAFLAG8                                                 07004000
CCAACDSC EQU   CCAFLAG8                                                 07005000
CCACDSC  EQU   CCAFLAG8                                                 07006000
@NM00034 EQU   CCAFLAG6                                                 07007000
CCAACRUP EQU   CCAFLAG6                                                 07008000
CCACRQUP EQU   CCAFLAG6                                                 07009000
CCAACDUP EQU   CCAFLAG6                                                 07010000
CCACDSUP EQU   CCAFLAG6                                                 07011000
@NM00033 EQU   CCAFLAG5                                                 07012000
CCAACROS EQU   CCAFLAG5                                                 07013000
CCACRQOS EQU   CCAFLAG5                                                 07014000
CCAACDOS EQU   CCAFLAG5                                                 07015000
CCACDSOS EQU   CCAFLAG5                                                 07016000
@NM00032 EQU   CCAFLAG4                                                 07017000
CCAACRIS EQU   CCAFLAG4                                                 07018000
CCACRQIS EQU   CCAFLAG4                                                 07019000
CCAACDIS EQU   CCAFLAG4                                                 07020000
CCACDSIS EQU   CCAFLAG4                                                 07021000
@NM00031 EQU   CCAFLAG3+1                                               07022000
CCARGNP  EQU   CCAFLAG3+1                                               07023000
CCADISRQ EQU   CCAFLAG3+1                                               07024000
CCAICTOK EQU   CCAFLAG3                                                 07025000
CCADELP  EQU   CCAFLAG3                                                 07026000
CCACMPRS EQU   CCAFLAG3                                                 07027000
CCAZAPP  EQU   CCAFLAG3                                                 07028000
CCALINKP EQU   CCAFLAG3                                                 07029000
CCACOPYP EQU   CCAFLAG3                                                 07030000
CCAASIP  EQU   CCAFLAG3                                                 07031000
CCAUPDP  EQU   CCAFLAG3                                                 07032000
CCAEOSMP EQU   CCAFLAG2                                                 07033000
CCAEOFNC EQU   CCAFLAG2                                                 07034000
@NM00030 EQU   CCAFLAG2                                                 07035000
CCACHECK EQU   CCAFLAG2                                                 07036000
CCATERM  EQU   CCAFLAG2                                                 07037000
CCASVCLB EQU   CCAFLAG2                                                 07038000
CCANCPTF EQU   CCAFLAG2                                                 07039000
@NM00029 EQU   CCAFLAG1+1                                               07040000
CCAUNL   EQU   CCAFLAG1+1                                               07041000
CCARESET EQU   CCAFLAG1+1                                               07042000
CCALOG   EQU   CCAFLAG1+1                                               07043000
CCACNV   EQU   CCAFLAG1+1                                               07044000
CCALIST  EQU   CCAFLAG1                                                 07045000
CCAUPDU  EQU   CCAFLAG1                                                 07046000
CCAUPDJ  EQU   CCAFLAG1                                                 07047000
CCARES   EQU   CCAFLAG1                                                 07048000
CCAREJ   EQU   CCAFLAG1                                                 07049000
CCAAPPLY EQU   CCAFLAG1                                                 07050000
CCAREC   EQU   CCAFLAG1                                                 07051000
CCAFUNCT EQU   CCAFFUNC                                                 07052000
@NM00028 EQU   @NM00023+18                                              07053000
@NM00027 EQU   @NM00023+16                                              07054000
CCATBLPA EQU   @NM00023+12                                              07055000
@NM00026 EQU   @NM00023+8                                               07056000
@NM00025 EQU   @NM00023+4                                               07057000
@NM00024 EQU   @NM00023                                                 07058000
CCAIFGTP EQU   CCAFGTP+16                                               07059000
CCAGTP3  EQU   CCAFGTP+12                                               07060000
CCAGTP2  EQU   CCAFGTP+8                                                07061000
CCAGTP1  EQU   CCAFGTP+4                                                07062000
CCASETAD EQU   CCASEGTP                                                 07063000
CCACLST  EQU   CCAFPGM+12                                               07064000
CCASPDCB EQU   CCAFPGM+8                                                07065000
CCAICLMD EQU   CCAFICT+12                                               07066000
CCAICMOD EQU   CCAFICT+8                                                07067000
CCAICT   EQU   CCAFICT                                                  07068000
CCARVAD  EQU   CCAFSTA                                                  07069000
CCAACDID EQU   CCAFSYS+32                                               07070000
CCACDSID EQU   CCAFSYS+24                                               07071000
CCALNLEN EQU   CCAFSYS+22                                               07072000
@NM00022 EQU   CCAFLAGA                                                 07073000
CCAPSYSF EQU   CCAFLAGA                                                 07074000
CCAASYSF EQU   CCAFLAGA                                                 07075000
CCACSYSF EQU   CCAFLAGA                                                 07076000
CCANUCID EQU   CCAFSYS+20                                               07077000
CCAASREL EQU   CCAFSYS+16                                               07078000
CCACSREL EQU   CCASREL                                                  07079000
CCAPEMAX EQU   CCAFSYS+10                                               07080000
CCAPGLEN EQU   CCAFSYS+8                                                07081000
CCAIOPAS EQU   CCAFSYS+4                                                07082000
CCAIOPCS EQU   CCAFSYS                                                  07083000
CCAPESIZ EQU   CCAFIOP+4                                                07084000
@NM00021 EQU   CCAFLAG7+3                                               07085000
CCALOGP  EQU   CCAFLAG7+2                                               07086000
CCAOUTP  EQU   CCAFLAG7+2                                               07087000
CCASLBP  EQU   CCAFLAG7+2                                               07088000
CCARPTP  EQU   CCAFLAG7+2                                               07089000
CCALISTP EQU   CCAFLAG7+2                                               07090000
CCAJCLP  EQU   CCAFLAG7+2                                               07091000
CCAPTFP  EQU   CCAFLAG7+2                                               07092000
CCATLBP  EQU   CCAFLAG7+2                                               07093000
CCAUT3P  EQU   CCAFLAG7+1                                               07094000
CCAUT2P  EQU   CCAFLAG7+1                                               07095000
CCAUT1P  EQU   CCAFLAG7+1                                               07096000
CCAWK5P  EQU   CCAFLAG7+1                                               07097000
CCAWK4P  EQU   CCAFLAG7+1                                               07098000
CCAWK3P  EQU   CCAFLAG7+1                                               07099000
CCAWK2P  EQU   CCAFLAG7+1                                               07100000
CCAWK1P  EQU   CCAFLAG7+1                                               07101000
CCAACRQP EQU   CCAFLAG7                                                 07102000
CCACRQP  EQU   CCAFLAG7                                                 07103000
CCASTSP  EQU   CCAFLAG7                                                 07104000
CCAMTSP  EQU   CCAFLAG7                                                 07105000
CCAPTSP  EQU   CCAFLAG7                                                 07106000
CCASCDSP EQU   CCAFLAG7                                                 07107000
CCAACDSP EQU   CCAFLAG7                                                 07108000
CCACDSP  EQU   CCAFLAG7                                                 07109000
@NM00020 EQU   CCAFBUFR+122                                             07110000
@NM00019 EQU   CCAFBUFR+120                                             07111000
@NM00018 EQU   CCAFBUFR+118                                             07112000
CCATBFMX EQU   CCAFBUFR+116                                             07113000
CCA4BFMX EQU   CCAFBUFR+114                                             07114000
CCA3BFMX EQU   CCAFBUFR+112                                             07115000
CCA2BFMX EQU   CCAFBUFR+110                                             07116000
CCA1BFMX EQU   CCAFBUFR+108                                             07117000
CCAXBFMX EQU   CCAFBUFR+106                                             07118000
CCAQBFMX EQU   CCAFBUFR+104                                             07119000
CCASBFMX EQU   CCAFBUFR+102                                             07120000
CCAMBFMX EQU   CCAFBUFR+100                                             07121000
CCAPBFMX EQU   CCAFBUFR+98                                              07122000
CCAVBFMX EQU   CCAFBUFR+96                                              07123000
CCAABFMX EQU   CCAFBUFR+94                                              07124000
CCACBFMX EQU   CCAFBUFR+92                                              07125000
@NM00017 EQU   CCAFBUFR+88                                              07126000
@NM00016 EQU   CCAFBUFR+84                                              07127000
CCA4BFSZ EQU   CCAFBUFR+80                                              07128000
CCATBFSZ EQU   CCAFBUFR+76                                              07129000
CCAWBFSZ EQU   CCAFBUFR+72                                              07130000
CCAQBFSZ EQU   CCAFBUFR+68                                              07131000
CCAPBFSZ EQU   CCAFBUFR+64                                              07132000
CCAVBFSZ EQU   CCAFBUFR+60                                              07133000
CCACBFSZ EQU   CCAFBUFR+56                                              07134000
@NM00015 EQU   CCAFBUFR+52                                              07135000
CCA4BFOA EQU   CCAFBUFR+48                                              07136000
CCA4BFIA EQU   CCAFBUFR+44                                              07137000
CCATBFIA EQU   CCAFBUFR+40                                              07138000
CCAWBFOA EQU   CCAFBUFR+36                                              07139000
CCAWBFIA EQU   CCAFBUFR+32                                              07140000
CCAQBFOA EQU   CCAFBUFR+28                                              07141000
CCAQBFIA EQU   CCAFBUFR+24                                              07142000
CCAPBFOA EQU   CCAFBUFR+20                                              07143000
CCAPBFIA EQU   CCAFBUFR+16                                              07144000
CCAVBFOA EQU   CCAFBUFR+12                                              07145000
CCAVBFIA EQU   CCAFBUFR+8                                               07146000
CCACBFOA EQU   CCAFBUFR+4                                               07147000
CCACBFIA EQU   CCAFBUFR                                                 07148000
CCAID    EQU   HMASMCCA                                                 07149000
@NM00014 EQU   TBLFLG5                                                  07150000
TBLICTOK EQU   TBLFLG5                                                  07151000
@NM00013 EQU   TBLFLG4                                                  07152000
TBLBPFM  EQU   TBLFLG4                                                  07153000
@NM00012 EQU   TBLFLG4                                                  07154000
TBLBPIRQ EQU   TBLFLG4                                                  07155000
TBLBPREQ EQU   TBLFLG4                                                  07156000
TBLBPPRE EQU   TBLFLG4                                                  07157000
TBLBPID  EQU   TBLFLG4                                                  07158000
@NM00011 EQU   TBLFLG3+1                                                07159000
TBLSTS   EQU   TBLFLG3                                                  07160000
TBLMTS   EQU   TBLFLG3                                                  07161000
TBLPTS   EQU   TBLFLG3                                                  07162000
TBLACRQ  EQU   TBLFLG3                                                  07163000
TBLCRQ   EQU   TBLFLG3                                                  07164000
TBLSCDS  EQU   TBLFLG3                                                  07165000
TBLACDS  EQU   TBLFLG3                                                  07166000
TBLCDS   EQU   TBLFLG3                                                  07167000
TBLMASS  EQU   TBLFLG2                                                  07168000
@NM00010 EQU   TBLFLG2                                                  07169000
TBLFMID  EQU   TBLFLG2                                                  07170000
TBLEXC   EQU   TBLFLG2                                                  07171000
@NM00009 EQU   TBLFLG1+1                                                07172000
TBLDISW  EQU   TBLFLG1+1                                                07173000
TBLDISR  EQU   TBLFLG1+1                                                07174000
TBLDISN  EQU   TBLFLG1+1                                                07175000
TBLNOJCL EQU   TBLFLG1                                                  07176000
TBLFLUSH EQU   TBLFLG1                                                  07177000
TBLUSER  EQU   TBLFLG1                                                  07178000
TBLAPAR  EQU   TBLFLG1                                                  07179000
TBLCOMP  EQU   TBLFLG1                                                  07180000
TBLASSEM EQU   TBLFLG1                                                  07181000
TBLCHECK EQU   TBLFLG1                                                  07182000
@NM00008 EQU   TBLXOPTS+5                                               07183000
TBLNUCID EQU   TBLXOPTS+4                                               07184000
TBLJCLGT EQU   TBLXOPTS                                                 07185000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      07186000
@RC00297 EQU   @RC00272                                                 07187000
@RF00473 EQU   @RC00463                                                 07188000
@RF00485 EQU   @RC00463                                                 07189000
@RF00572 EQU   @RC00566                                                 07190000
@RF00620 EQU   @RC00603                                                 07191000
@RF00625 EQU   @RC00603                                                 07192000
@RF00719 EQU   @RC00713                                                 07193000
@RF00769 EQU   @RC00752                                                 07194000
@RF00774 EQU   @RC00752                                                 07195000
@RC00821 EQU   @RC00813                                                 07196000
@RC00918 EQU   @RC00911                                                 07197000
@RC00932 EQU   @RC00911                                                 07198000
@RF00940 EQU   @RC00911                                                 07199000
@RC00945 EQU   @RC00911                                                 07200000
@RC01486 EQU   @RC01476                                                 07201000
@RF01730 EQU   @RC01711                                                 07202000
@RC01732 EQU   @RC01711                                                 07203000
@RF01796 EQU   @RC01778                                                 07204000
@RC01798 EQU   @RC01778                                                 07205000
@RF00341 EQU   @RC00297                                                 07206000
@RF00920 EQU   @RC00918                                                 07207000
@RF00934 EQU   @RC00932                                                 07208000
@RF00947 EQU   @RC00945                                                 07209000
@RC01492 EQU   @RC01486                                                 07210000
@RC01502 EQU   @RC01486                                                 07211000
@RC01507 EQU   @RC01486                                                 07212000
@ENDDATA EQU   *                                                        07213000
         END   HMASMTPA,(C'PLS2205',0802,78334)                         07214000
