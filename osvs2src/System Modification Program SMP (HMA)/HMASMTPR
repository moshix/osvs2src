         TITLE 'HMASMTPR - TABLE SELECT SYSMODS FOR RESTORE'            00001000
HMASMTPR CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMTPR  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @09,4095(,@12)                                      0001 00011000
         USING @PSTART,@12                                         0001 00012000
         USING @PSTART+4095,@09                                    0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         MVC   @PC00001(4),0(@01)                                  0001 00018000
*                                                                  0144 00019000
*   /*****************************************************************/ 00020000
*   /*                                                               */ 00021000
*   /* HMASMTPR << MAINLINE                                          */ 00022000
*   /*                                                               */ 00023000
*   /*****************************************************************/ 00024000
*                                                                  0144 00025000
*   TPRRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 00026000
         SLR   TPRRC,TPRRC                                         0144 00027000
*   TPRFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 00028000
*                                                                  0145 00029000
         MVI   TPRFLAGS,X'00'                                      0145 00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* INITIALIZE FOR PROCESSING                                     */ 00033000
*   /*                                                               */ 00034000
*   /*****************************************************************/ 00035000
*                                                                  0146 00036000
*   CALL TPRINIT;                                                  0146 00037000
         BAL   @14,TPRINIT                                         0146 00038000
*   RFY                                                            0147 00039000
*     RTNCODE RSTD;                                                0147 00040000
*   TPRRC=MAX(TPRRC,RTNCODE);       /* SAVE THE RETURN CODE          */ 00041000
         CR    TPRRC,RTNCODE                                       0148 00042000
         BNL   *+6                                                      00043000
         LR    TPRRC,RTNCODE                                       0148 00044000
*   RFY                                                            0149 00045000
*     RTNCODE UNRSTD;                                              0149 00046000
*                                                                  0149 00047000
*   /*****************************************************************/ 00048000
*   /*                                                               */ 00049000
*   /* BUILD DELTA1 AND DELTA2 LISTS DELTA1 CONSISTS OF ALL SYSMODS  */ 00050000
*   /* THAT CAN BE RESTORED AND DELTA2 CONSISTS OF ALL SYSMODS ON THE*/ 00051000
*   /* ACDS THAT CANNOT BE REFERENCED BY ELEMENTS IN THE RESTORE     */ 00052000
*   /*                                                               */ 00053000
*   /*****************************************************************/ 00054000
*                                                                  0150 00055000
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00056000
         CH    TPRRC,@CH00033                                      0150 00057000
         BNL   @RF00150                                            0150 00058000
*     DO;                           /* YES,                          */ 00059000
*       CALL LSTBLD;                                               0152 00060000
         BAL   @14,LSTBLD                                          0152 00061000
*       RFY                                                        0153 00062000
*         RTNCODE RSTD;                                            0153 00063000
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00064000
         CR    TPRRC,RTNCODE                                       0154 00065000
         BNL   *+6                                                      00066000
         LR    TPRRC,RTNCODE                                       0154 00067000
*       RFY                                                        0155 00068000
*         RTNCODE UNRSTD;                                          0155 00069000
*     END;                                                         0156 00070000
*   ELSE                                                           0157 00071000
*     ;                             /* PREVIOUS ERROR                */ 00072000
*                                                                  0157 00073000
@RF00150 DS    0H                                                  0158 00074000
*   /*****************************************************************/ 00075000
*   /*                                                               */ 00076000
*   /* CHECK SELECT LIST AGAINST THE ICT. ISSUE ERROR MESSAGES FOR   */ 00077000
*   /* SYSMODS IN SELECT ARE NOT IN ICT OR HAD A MESSAGE ISSUED      */ 00078000
*   /*                                                               */ 00079000
*   /*****************************************************************/ 00080000
*                                                                  0158 00081000
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00082000
         CH    TPRRC,@CH00033                                      0158 00083000
         BNL   @RF00158                                            0158 00084000
*     DO;                           /* YES,                          */ 00085000
*       CALL SELCHK;                                               0160 00086000
         BAL   @14,SELCHK                                          0160 00087000
*       RFY                                                        0161 00088000
*         RTNCODE RSTD;                                            0161 00089000
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00090000
         CR    TPRRC,RTNCODE                                       0162 00091000
         BNL   *+6                                                      00092000
         LR    TPRRC,RTNCODE                                       0162 00093000
*       RFY                                                        0163 00094000
*         RTNCODE UNRSTD;                                          0163 00095000
*     END;                                                         0164 00096000
*   ELSE                                                           0165 00097000
*     ;                             /* PREVIOUS ERROR                */ 00098000
*                                                                  0165 00099000
@RF00158 DS    0H                                                  0166 00100000
*   /*****************************************************************/ 00101000
*   /*                                                               */ 00102000
*   /* MARK GROUP'ED SYSMODS AS CANDIDTATES                          */ 00103000
*   /*                                                               */ 00104000
*   /*****************************************************************/ 00105000
*                                                                  0166 00106000
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00107000
         CH    TPRRC,@CH00033                                      0166 00108000
         BNL   @RF00166                                            0166 00109000
*     DO;                           /* YES,                          */ 00110000
*       IF TBLGROUP=ON THEN         /* WAS GROUP SPECIFIED?          */ 00111000
         L     @10,@PC00001                                        0168 00112000
         L     @10,TBLXTBL(,@10)                                   0168 00113000
         TM    TBLGROUP(@10),B'00100000'                           0168 00114000
         BNO   @RF00168                                            0168 00115000
*         DO;                       /* YES,                          */ 00116000
*           CALL GROUP;                                            0170 00117000
         BAL   @14,GROUP                                           0170 00118000
*           RFY                                                    0171 00119000
*             RTNCODE RSTD;                                        0171 00120000
*           TPRRC=MAX(TPRRC,RTNCODE);/* SAVE THE RETURN CODE         */ 00121000
         CR    TPRRC,RTNCODE                                       0172 00122000
         BNL   *+6                                                      00123000
         LR    TPRRC,RTNCODE                                       0172 00124000
*           RFY                                                    0173 00125000
*             RTNCODE UNRSTD;                                      0173 00126000
*         END;                                                     0174 00127000
*       ELSE                                                       0175 00128000
*         ;                         /* GROUP WAS NOT SPECIFIED       */ 00129000
@RF00168 DS    0H                                                  0176 00130000
*     END;                                                         0176 00131000
*   ELSE                                                           0177 00132000
*     ;                             /* PREVIOUS ERROR                */ 00133000
*                                                                  0177 00134000
@RF00166 DS    0H                                                  0178 00135000
*   /*****************************************************************/ 00136000
*   /*                                                               */ 00137000
*   /* CHECK THAT ALL MEMBERS OF THE "RESTORE GROUP" ARE OK          */ 00138000
*   /*                                                               */ 00139000
*   /*****************************************************************/ 00140000
*                                                                  0178 00141000
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00142000
         CH    TPRRC,@CH00033                                      0178 00143000
         BNL   @RF00178                                            0178 00144000
*     DO;                           /* YES,                          */ 00145000
*       CALL REQCHK;                                               0180 00146000
         BAL   @14,REQCHK                                          0180 00147000
*       RFY                                                        0181 00148000
*         RTNCODE RSTD;                                            0181 00149000
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00150000
         CR    TPRRC,RTNCODE                                       0182 00151000
         BNL   *+6                                                      00152000
         LR    TPRRC,RTNCODE                                       0182 00153000
*       RFY                                                        0183 00154000
*         RTNCODE UNRSTD;                                          0183 00155000
*     END;                                                         0184 00156000
*   ELSE                                                           0185 00157000
*     ;                             /*                               */ 00158000
@RF00178 DS    0H                                                  0186 00159000
*   IF TPRRC<STOPFUNC THEN          /* NO ERROR SO FAR?              */ 00160000
         CH    TPRRC,@CH00033                                      0186 00161000
         BNL   @RF00186                                            0186 00162000
*     DO;                           /* YES,                          */ 00163000
*                                                                  0187 00164000
*       /*************************************************************/ 00165000
*       /*                                                           */ 00166000
*       /* ELIMINATE UNUSED PTF ENTRIES                              */ 00167000
*       /*                                                           */ 00168000
*       /*************************************************************/ 00169000
*                                                                  0188 00170000
*       CALL COMPRESS;                                             0188 00171000
         BAL   @14,COMPRESS                                        0188 00172000
*       RFY                                                        0189 00173000
*         RTNCODE RSTD;                                            0189 00174000
*       TPRRC=MAX(TPRRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 00175000
         CR    TPRRC,RTNCODE                                       0190 00176000
         BNL   *+6                                                      00177000
         LR    TPRRC,RTNCODE                                       0190 00178000
*       RFY                                                        0191 00179000
*         RTNCODE UNRSTD;                                          0191 00180000
*     END;                                                         0192 00181000
*   ELSE                                                           0193 00182000
*     ;                             /*                               */ 00183000
*                                                                  0193 00184000
@RF00186 DS    0H                                                  0194 00185000
*   /*****************************************************************/ 00186000
*   /*                                                               */ 00187000
*   /* CLEANUP                                                       */ 00188000
*   /*                                                               */ 00189000
*   /*****************************************************************/ 00190000
*                                                                  0194 00191000
*   CALL TPRCLEAN;                                                 0194 00192000
         BAL   @14,TPRCLEAN                                        0194 00193000
*   RFY                                                            0195 00194000
*     RTNCODE RSTD;                                                0195 00195000
*   TPRRC=MAX(TPRRC,RTNCODE);       /* SAVE THE RETURN CODE          */ 00196000
         CR    TPRRC,RTNCODE                                       0196 00197000
         BNL   *+6                                                      00198000
         LR    TPRRC,RTNCODE                                       0196 00199000
*   RFY                                                            0197 00200000
*     RTNCODE UNRSTD;                                              0197 00201000
*   RETURN CODE(TPRRC);             /*                               */ 00202000
         LR    @15,TPRRC                                           0198 00203000
         L     @13,4(,@13)                                         0198 00204000
         L     @14,12(,@13)                                        0198 00205000
         LM    @00,@12,20(@13)                                     0198 00206000
         BR    @14                                                 0198 00207000
*                                                                  0199 00208000
*   /*****************************************************************/ 00209000
*   /*                                                               */ 00210000
*   /* INITIALIZATION ROUTINE                                        */ 00211000
*   /*                                                               */ 00212000
*   /*****************************************************************/ 00213000
*                                                                  0199 00214000
*TPRINIT:                                                          0199 00215000
*   PROC;                                                          0199 00216000
TPRINIT  STM   @14,@12,12(@13)                                     0199 00217000
*   DCL                                                            0200 00218000
*     TPRINTRC FIXED(15);           /* LOCAL RETURN CODE             */ 00219000
*   TPRINTRC=ZERO;                  /* CLEAR RETURN CODE             */ 00220000
         SLR   TPRINTRC,TPRINTRC                                   0201 00221000
*   RETURN CODE(TPRINTRC);          /* RETURN W/ RC                  */ 00222000
         LR    @15,TPRINTRC                                        0202 00223000
         L     @14,12(,@13)                                        0202 00224000
         LM    @00,@12,20(@13)                                     0202 00225000
         BR    @14                                                 0202 00226000
*   END TPRINIT;                                                   0203 00227000
*                                                                  0204 00228000
*   /*****************************************************************/ 00229000
*   /*                                                               */ 00230000
*   /* BUILD DELTA1 AND DELTA2 LIST                                  */ 00231000
*   /*                                                               */ 00232000
*   /*****************************************************************/ 00233000
*                                                                  0204 00234000
*/********************************************************************/ 00235000
*/*              | SELECT  | NOT IN |                                */ 00236000
*/*              | LIST    | SELECT |                                */ 00237000
*/*              |         | LIST   |                                */ 00238000
*/*--------------|---------|--------|                                */ 00239000
*/*  ON CDS      |         |        |                                */ 00240000
*/*    - OK      |    C    |   C    |                                */ 00241000
*/*    - IN ERROR|    C    |   C    |  ^C IN SPEC ????               */ 00242000
*/*    - SUPED   |    ?    |   C    |                                */ 00243000
*/*    - SUP ONLY|   ^C    |   C    |                                */ 00244000
*/*    - DELETED |   ^C    |  ^C    |                                */ 00245000
*/*    - DELETES |   ^C    |  ^C    |  ^ IN CODE YET ????            */ 00246000
*/*  ^ON CDS     |   ^C    |  ^C    |                                */ 00247000
*/*--------------|---------|--------|                                */ 00248000
*/*                                                                  */ 00249000
*/* SYSMOD IN ERROR BUT ONLY JCLIN PROCESSING DONE SEEMS OK ????     */ 00250000
*/* IF A CANDIDATE ACCORDING TO THE ABOVE TABLE THEN:                */ 00251000
*/*                                                                  */ 00252000
*/*--------------|---------|                                         */ 00253000
*/*  ^ON ACDS    |    C    |                                         */ 00254000
*/*  ON ACDS     |         |                                         */ 00255000
*/*    - OK      |   ^C    |                                         */ 00256000
*/*    - IN ERROR|   ^C  2 |                                         */ 00257000
*/*    - SUPED   |   ^C  2 |                                         */ 00258000
*/*    - SUP ONLY|   ^C  2 |                                         */ 00259000
*/*    - DELETED |   ^C  2 |                                         */ 00260000
*/*--------------|---------|                                         */ 00261000
*/* 2 - WILL BE IN "DELTA 2" LIST                                    */ 00262000
*/*                                                                  */ 00263000
*/********************************************************************/ 00264000
*                                                                  0204 00265000
*LSTBLD:                                                           0204 00266000
*   PROC(LSTIOP);                                                  0204 00267000
LSTBLD   STM   @14,@02,@SA00003                                    0204 00268000
         STM   @04,@12,@SA00003+20                                 0204 00269000
         MVC   @PC00003(4),0(@01)                                  0204 00270000
*   DCL                                                            0205 00271000
*     LSTBLDRC FIXED(15);           /* LOCAL RETURN CODE             */ 00272000
*   DCL                                                            0206 00273000
*     LSTIOP CHAR(*);               /* EXTENDED IOP TO BE USED TO GET   00274000
*                                      SYSMOD ENTRY                  */ 00275000
*   DCL                                                            0207 00276000
*     1 LSTFLAGS,                   /* LOCAL CONTROL FLAGS           */ 00277000
*      2 LST1SMD BIT(1),            /* 1ST SYSMOD DIRECTORY ENTRY  0207 00278000
*                                      FOUND ON CDS                  */ 00279000
*      2 LST2SMD BIT(1),            /* 1ST SYSMOD DIRECTORY ENTRY  0207 00280000
*                                      FOUND ON ACDS                 */ 00281000
*      2 CDSEOF BIT(1),             /* EOF OR NEXT AFTER SYSMOD    0207 00282000
*                                      ENCOUNTERED                   */ 00283000
*      2 ACDSEOF BIT(1),                                           0207 00284000
*      2 GETCDS BIT(1),             /* GET NEXT DIR ENTRY FROM CDS   */ 00285000
*      2 ACDSGET BIT(1),            /* GET NEXT DIR ENTRY FROM ACDS  */ 00286000
*      2 LSTENT1 BIT(1),            /* BUILD ENTRY FOR CDS SYSMOD    */ 00287000
*      2 LSTENT2 BIT(1),            /* BUILD ENTRY FOR ACDS SYSMOD 0207 00288000
*                                      (NOT USED)                    */ 00289000
*      2 * BIT(8);                  /* UNUSED                        */ 00290000
*   DCL                                                            0208 00291000
*     LST1IOP@ PTR(31);             /* PTR TO IOP FOR CDS            */ 00292000
*   DCL                                                            0209 00293000
*     LST2IOP@ PTR(31);             /* PTR TO IOP FOR ACDS           */ 00294000
*   DCL                                                            0210 00295000
*     LSTSMD1 CHAR(LENGTH(IOPNAM17))/*                               */ 00296000
*         BASED(ADDR(LST1IOP@->IOPNAM17));/* CDS DIRECTORY ENTRY   0210 00297000
*                                      SYSMOD NAME                   */ 00298000
*   DCL                                                            0211 00299000
*     LSTSMD2 CHAR(LENGTH(IOPNAM17))/*                               */ 00300000
*         BASED(ADDR(LST2IOP@->IOPNAM17));/* ACDS DIRECTORY ENTRY  0211 00301000
*                                      SYSMOD NAME                   */ 00302000
*   LSTFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 00303000
         XC    LSTFLAGS(2),LSTFLAGS                                0212 00304000
*   LSTBLDRC=ZERO;                  /* CLEAR RETURN CODE             */ 00305000
         SLR   LSTBLDRC,LSTBLDRC                                   0213 00306000
*   LST1IOP@=CCAIOPTR;              /* IOP FOR DIRECTORY READ OF CDS */ 00307000
         L     LST1IOP@,CCAIOPTR(,CCAPTR)                          0214 00308000
*   LST2IOP@=TBLXIOPF;              /* IOP FOR DIRECTORY READ OF ACDS*/ 00309000
         L     @10,@PC00001                                        0215 00310000
         L     LST2IOP@,TBLXIOPF(,@10)                             0215 00311000
*   LST1IOP@->IOPDSID=IOPCDS;       /* DSID OF CDS                   */ 00312000
         MVI   IOPDSID(LST1IOP@),X'02'                             0216 00313000
*   LST2IOP@->IOPDSID=IOPACDS;      /* DSID OF ACDS                  */ 00314000
         MVI   IOPDSID(LST2IOP@),X'0C'                             0217 00315000
*   LST1IOP@->IOPFUNCT=IOPOPENN;    /* RESET TO THE BEGINNING OF CDS */ 00316000
         MVI   IOPFUNCT(LST1IOP@),X'0C'                            0218 00317000
*   CALL HMASMIO(LST1IOP@->HMASMIOP);/* ...                          */ 00318000
         ST    LST1IOP@,@AL00001                                   0219 00319000
         L     @15,@CV01228                                        0219 00320000
         LA    @01,@AL00001                                        0219 00321000
         BALR  @14,@15                                             0219 00322000
*   LST2IOP@->IOPFUNCT=IOPOPENN;    /* RESET TO THE BEGINNING OF ACDS*/ 00323000
         MVI   IOPFUNCT(LST2IOP@),X'0C'                            0220 00324000
*   CALL HMASMIO(LST2IOP@->HMASMIOP);/* ...                          */ 00325000
*                                                                  0221 00326000
         ST    LST2IOP@,@AL00001                                   0221 00327000
         L     @15,@CV01228                                        0221 00328000
         LA    @01,@AL00001                                        0221 00329000
         BALR  @14,@15                                             0221 00330000
*   /*****************************************************************/ 00331000
*   /*                                                               */ 00332000
*   /* PROCESS ALL SYSMOD ENTRIES ON BOTH CDS AND ACDS               */ 00333000
*   /*                                                               */ 00334000
*   /*****************************************************************/ 00335000
*                                                                  0222 00336000
*   DO WHILE(LSTBLDRC<STOPFUNC&(CDSEOF=OFF|ACDSEOF=OFF));          0222 00337000
         B     @DE00222                                            0222 00338000
@DL00222 DS    0H                                                  0223 00339000
*     LSTENT1=OFF;                  /* CLEAR BUILD ENTRY FLAG        */ 00340000
*     LSTENT2=OFF;                  /* CLEAR BUILD ENTRY FLAG        */ 00341000
         NI    LSTENT1,B'11111100'                                 0224 00342000
*     CALL CDSREAD;                 /*                               */ 00343000
         BAL   @14,CDSREAD                                         0225 00344000
*     RFY                                                          0226 00345000
*       RTNCODE RSTD;                                              0226 00346000
*     LSTBLDRC=MAX(LSTBLDRC,RTNCODE);/* SET RETURN CODE              */ 00347000
         CR    LSTBLDRC,RTNCODE                                    0227 00348000
         BNL   *+6                                                      00349000
         LR    LSTBLDRC,RTNCODE                                    0227 00350000
*     RFY                                                          0228 00351000
*       RTNCODE UNRSTD;                                            0228 00352000
*     CALL ACDSREAD;                /*                               */ 00353000
         BAL   @14,ACDSREAD                                        0229 00354000
*     RFY                                                          0230 00355000
*       RTNCODE RSTD;                                              0230 00356000
*     LSTBLDRC=MAX(LSTBLDRC,RTNCODE);/* SET RETURN CODE              */ 00357000
         CR    LSTBLDRC,RTNCODE                                    0231 00358000
         BNL   *+6                                                      00359000
         LR    LSTBLDRC,RTNCODE                                    0231 00360000
*     RFY                                                          0232 00361000
*       RTNCODE UNRSTD;                                            0232 00362000
*     GETCDS=OFF;                   /* CLEAR READ FLAGS              */ 00363000
*     ACDSGET=OFF;                  /* ...                           */ 00364000
         NI    GETCDS,B'11110011'                                  0234 00365000
*     IF(CDSEOF=OFF                 /* ENTRY FROM ACDS               */ 00366000
*         |ACDSEOF=OFF)             /* NOT AT END OF BOTH CDS AND    */ 00367000
*         &LSTBLDRC<STOPFUNC THEN   /* ACDS?                         */ 00368000
         TM    CDSEOF,B'00110000'                                  0235 00369000
         BO    @RF00235                                            0235 00370000
         CH    LSTBLDRC,@CH00033                                   0235 00371000
         BNL   @RF00235                                            0235 00372000
*       DO;                                                        0236 00373000
*         IF LST1SMD=ON             /* WITHIN SYSMOD ENTRIES ON      */ 00374000
*             &CDSEOF=OFF THEN      /* CDS?                          */ 00375000
         TM    LST1SMD,B'10000000'                                 0237 00376000
         BNO   @RF00237                                            0237 00377000
         TM    CDSEOF,B'00100000'                                  0237 00378000
         BNZ   @RF00237                                            0237 00379000
*           DO;                     /* YES,                          */ 00380000
*             IF LST2SMD=OFF        /* NO ACDS SYSMOD?               */ 00381000
*                 |ACDSEOF=ON THEN                                 0239 00382000
         TM    ACDSEOF,B'00010000'                                 0239 00383000
         BNZ   @RT00239                                            0239 00384000
         TM    LST2SMD,B'01000000'                                 0239 00385000
         BO    @RF00239                                            0239 00386000
@RT00239 DS    0H                                                  0240 00387000
*               DO;                 /* YES,                          */ 00388000
*                 LSTENT1=ON;       /* BUILD ICT ENTRY IF POSSIBLE   */ 00389000
*                 GETCDS=ON;        /* GET NEXT ENTRY FROM CDS       */ 00390000
         OI    LSTENT1,B'00001010'                                 0242 00391000
*               END;                                               0243 00392000
*             ELSE                  /* ALSO WITHIN SYSMOD ENTRIES    */ 00393000
*               DO;                 /* ON ACDS                       */ 00394000
         B     @RC00239                                            0244 00395000
@RF00239 DS    0H                                                  0245 00396000
*                 IF LSTSMD1=LSTSMD2 THEN/* CDS/ACDS SYSMODS EQUAL?  */ 00397000
         LA    @10,4                                               0245 00398000
         LR    @08,LST1IOP@                                        0245 00399000
         ALR   @08,@10                                             0245 00400000
         ALR   @10,LST2IOP@                                        0245 00401000
         CLC   LSTSMD1(7,@08),LSTSMD2(@10)                         0245 00402000
         BNE   @RF00245                                            0245 00403000
*                   DO;             /* YES,                          */ 00404000
*                     GETCDS=ON;    /* SKIP BY GETTING RECORDS       */ 00405000
*                     ACDSGET=ON;   /* FROM BOTH 1 AND 2             */ 00406000
         OI    GETCDS,B'00001100'                                  0248 00407000
*                     CALL LSTCHK;  /* CHECK WHEN BOTH ON CDS AND  0249 00408000
*                                      ACDS                          */ 00409000
         BAL   @14,LSTCHK                                          0249 00410000
*                     RFY                                          0250 00411000
*                       RTNCODE RSTD;                              0250 00412000
*                     TPRRC=MAX(LSTBLDRC,RTNCODE);/* SAVE THE RETURN    00413000
*                                      CODE                          */ 00414000
         LR    TPRRC,RTNCODE                                       0251 00415000
         CR    TPRRC,LSTBLDRC                                      0251 00416000
         BNL   *+6                                                      00417000
         LR    TPRRC,LSTBLDRC                                      0251 00418000
*                     RFY                                          0252 00419000
*                       RTNCODE UNRSTD;                            0252 00420000
*                   END;                                           0253 00421000
*                 ELSE                                             0254 00422000
*                   ;               /* NOT EQUAL?                    */ 00423000
@RF00245 DS    0H                                                  0255 00424000
*                 IF LSTSMD1<LSTSMD2 THEN/* SYSMOD CDS NOT ON ACDS?  */ 00425000
         LA    @10,4                                               0255 00426000
         LR    @08,LST1IOP@                                        0255 00427000
         ALR   @08,@10                                             0255 00428000
         ALR   @10,LST2IOP@                                        0255 00429000
         CLC   LSTSMD1(7,@08),LSTSMD2(@10)                         0255 00430000
         BNL   @RF00255                                            0255 00431000
*                   DO;             /* YES,                          */ 00432000
*                     LSTENT1=ON;   /* BUILD SCL ENTRY               */ 00433000
*                     GETCDS=ON;    /* GET NEXT CDS ENTRY            */ 00434000
         OI    LSTENT1,B'00001010'                                 0258 00435000
*                   END;                                           0259 00436000
*                 ELSE                                             0260 00437000
*                   ;                                              0260 00438000
@RF00255 DS    0H                                                  0261 00439000
*                 IF LSTSMD1>LSTSMD2 THEN/* ACDS SYSMOD NOT IN       */ 00440000
         LA    @10,4                                               0261 00441000
         LR    @08,LST1IOP@                                        0261 00442000
         ALR   @08,@10                                             0261 00443000
         ALR   @10,LST2IOP@                                        0261 00444000
         CLC   LSTSMD1(7,@08),LSTSMD2(@10)                         0261 00445000
         BNH   @RF00261                                            0261 00446000
*                   DO;             /* CDS                           */ 00447000
*                     ACDSGET=ON;   /* GET NEXT ACDS DIR. ENTRY      */ 00448000
*                     LSTENT2=ON;   /* ADD TO DELTA 2 LIST           */ 00449000
         OI    ACDSGET,B'00000101'                                 0264 00450000
*                   END;                                           0265 00451000
*                 ELSE                                             0266 00452000
*                   ;                                              0266 00453000
@RF00261 DS    0H                                                  0267 00454000
*               END;                                               0267 00455000
*           END;                                                   0268 00456000
*         ELSE                      /* NOT WITHIN SYSMODS ON SYSMOD  */ 00457000
*           DO;                     /* ENTRIES ON CDS                */ 00458000
         B     @RC00237                                            0269 00459000
@RF00237 DS    0H                                                  0270 00460000
*             IF ACDSEOF=OFF THEN   /* WITHIN SYSMODS ON ACDS?       */ 00461000
         TM    ACDSEOF,B'00010000'                                 0270 00462000
         BNZ   @RF00270                                            0270 00463000
*               DO;                 /* YES,                          */ 00464000
*                 ACDSGET=ON;       /* CONTINUE GETTING UNTIL EOF    */ 00465000
         OI    ACDSGET,B'00000100'                                 0272 00466000
*                 IF LST2SMD=ON THEN/* GOTTEN FIRST SYSMOD?          */ 00467000
         TM    LST2SMD,B'01000000'                                 0273 00468000
         BNO   @RF00273                                            0273 00469000
*                   DO;             /* YES,                          */ 00470000
*                     LSTENT2=ON;   /* BUILD ENTRY FROM ACDS         */ 00471000
         OI    LSTENT2,B'00000001'                                 0275 00472000
*                   END;            /*                               */ 00473000
*                 ELSE                                             0277 00474000
*                   ;               /* FIRST SYSMOD NOT FOUND        */ 00475000
@RF00273 DS    0H                                                  0278 00476000
*               END;                                               0278 00477000
*             ELSE                                                 0279 00478000
*               ;                   /* EOF ON ACDS                   */ 00479000
@RF00270 DS    0H                                                  0280 00480000
*           END;                                                   0280 00481000
*       END;                                                       0281 00482000
*     ELSE                                                         0282 00483000
*       ;                           /* EOF ON BOTH CDS AND ACDS      */ 00484000
*                                                                  0282 00485000
@RF00235 DS    0H                                                  0283 00486000
*     /***************************************************************/ 00487000
*     /*                                                             */ 00488000
*     /* BUILD ICT ENTRY FOR SYSMOD                                  */ 00489000
*     /*                                                             */ 00490000
*     /***************************************************************/ 00491000
*                                                                  0283 00492000
*     IF LSTENT1=ON THEN            /* BUILD ICT ENTRIES             */ 00493000
@RC00235 TM    LSTENT1,B'00000010'                                 0283 00494000
         BNO   @RF00283                                            0283 00495000
*       DO;                         /* YES,                          */ 00496000
*         CALL SMDICT(LST1IOP@->HMASMIOP);/* ADD SYSMOD TO ICT       */ 00497000
         ST    LST1IOP@,@AL00001                                   0285 00498000
         LA    @01,@AL00001                                        0285 00499000
         BAL   @14,SMDICT                                          0285 00500000
*         RFY                                                      0286 00501000
*           RTNCODE RSTD;                                          0286 00502000
*         TPRRC=MAX(LSTBLDRC,RTNCODE);/* SAVE THE RETURN CODE        */ 00503000
         LR    TPRRC,RTNCODE                                       0287 00504000
         CR    TPRRC,LSTBLDRC                                      0287 00505000
         BNL   *+6                                                      00506000
         LR    TPRRC,LSTBLDRC                                      0287 00507000
*         RFY                                                      0288 00508000
*           RTNCODE UNRSTD;                                        0288 00509000
*       END;                                                       0289 00510000
*     ELSE                                                         0290 00511000
*       ;                                                          0290 00512000
*                                                                  0290 00513000
@RF00283 DS    0H                                                  0291 00514000
*     /***************************************************************/ 00515000
*     /*                                                             */ 00516000
*     /* ADD ENTRY TO DELTA 2 LIST                                   */ 00517000
*     /*                                                             */ 00518000
*     /***************************************************************/ 00519000
*                                                                  0291 00520000
*     IF LSTENT2=ON THEN            /* BUILD DELTA 2 LIST            */ 00521000
         TM    LSTENT2,B'00000001'                                 0291 00522000
         BNO   @RF00291                                            0291 00523000
*       DO;                         /* YES,                          */ 00524000
*         CALL DELTA2BL(LST2IOP@->HMASMIOP);/* BUILD DELTA 2 ENTRY 0293 00525000
*                                      FOR SYSMOD                    */ 00526000
         ST    LST2IOP@,@AL00001                                   0293 00527000
         LA    @01,@AL00001                                        0293 00528000
         BAL   @14,DELTA2BL                                        0293 00529000
*         RFY                                                      0294 00530000
*           RTNCODE RSTD;                                          0294 00531000
*         TPRRC=MAX(LSTBLDRC,RTNCODE);/* SAVE THE RETURN CODE        */ 00532000
         LR    TPRRC,RTNCODE                                       0295 00533000
         CR    TPRRC,LSTBLDRC                                      0295 00534000
         BNL   *+6                                                      00535000
         LR    TPRRC,LSTBLDRC                                      0295 00536000
*         RFY                                                      0296 00537000
*           RTNCODE UNRSTD;                                        0296 00538000
*       END;                                                       0297 00539000
*     ELSE                                                         0298 00540000
*       ;                                                          0298 00541000
@RF00291 DS    0H                                                  0299 00542000
*   END;                            /* END OF PROCESS DIR. ENTRIES   */ 00543000
@DE00222 CH    LSTBLDRC,@CH00033                                   0299 00544000
         BNL   @DC00222                                            0299 00545000
         TM    CDSEOF,B'00110000'                                  0299 00546000
         BNO   @DL00222                                            0299 00547000
@DC00222 DS    0H                                                  0300 00548000
*   RETURN CODE(LSTBLDRC);          /*                               */ 00549000
         LR    @15,LSTBLDRC                                        0300 00550000
         L     @14,@SA00003                                        0300 00551000
         LM    @00,@02,@SA00003+8                                  0300 00552000
         LM    @04,@12,@SA00003+20                                 0300 00553000
         BR    @14                                                 0300 00554000
*   RFY                                                            0301 00555000
*     HMASMIOP BASED;                                              0301 00556000
*                                                                  0302 00557000
*   /*****************************************************************/ 00558000
*   /*                                                               */ 00559000
*   /* LSTGET -                                                      */ 00560000
*   /*                                                               */ 00561000
*   /*****************************************************************/ 00562000
*                                                                  0302 00563000
*LSTGET:                                                           0302 00564000
*   PROC(GLMGIOP);                                                 0302 00565000
LSTGET   STM   @14,@12,@SA00004                                    0302 00566000
         MVC   @PC00004(4),0(@01)                                  0302 00567000
*   DCL                                                            0303 00568000
*     GLMGIOP CHAR(*);              /* FIXED IOP FOR GET NEXT        */ 00569000
*   DCL                                                            0304 00570000
*     LSTGETRC FIXED(15);           /* RETURN CODE                   */ 00571000
*   RFY                                                            0305 00572000
*     HMASMIOP BASED(ADDR(GLMGIOP));                               0305 00573000
*   LSTGETRC=ZERO;                  /* CLEAR THE RETURN CODE         */ 00574000
         SLR   LSTGETRC,LSTGETRC                                   0306 00575000
*   IOPFUNCT=IOPGETN;                                              0307 00576000
         L     @10,@PC00004                                        0307 00577000
         MVI   IOPFUNCT(@10),X'0A'                                 0307 00578000
*   IOPTYPE=IOPSMD;                                                0308 00579000
         MVI   IOPTYPE(@10),X'0B'                                  0308 00580000
*   CALL HMASMIO(HMASMIOP);                                        0309 00581000
         ST    @10,@AL00001                                        0309 00582000
         L     @15,@CV01228                                        0309 00583000
         LA    @01,@AL00001                                        0309 00584000
         BALR  @14,@15                                             0309 00585000
*   LSTGETRC=IOPRETRN;              /*                               */ 00586000
         L     @10,@PC00004                                        0310 00587000
         SLR   LSTGETRC,LSTGETRC                                   0310 00588000
         IC    LSTGETRC,IOPRETRN(,@10)                             0310 00589000
*   RETURN CODE(LSTGETRC);          /* RETURN WITH THE RETURN CODE   */ 00590000
         LR    @15,LSTGETRC                                        0311 00591000
         L     @14,@SA00004                                        0311 00592000
         LM    @00,@12,@SA00004+8                                  0311 00593000
         BR    @14                                                 0311 00594000
*   RFY                                                            0312 00595000
*     HMASMIOP BASED;                                              0312 00596000
*   END LSTGET;                     /*                               */ 00597000
*                                                                  0314 00598000
*   /*****************************************************************/ 00599000
*   /*                                                               */ 00600000
*   /* CDSREAD - READ FROM DATA SET 1 TO GET A 'VALID' SYSMOD ENTRY  */ 00601000
*   /* TO COMPARE WITH THE CONTENTS OF ACDS                          */ 00602000
*   /*                                                               */ 00603000
*   /*****************************************************************/ 00604000
*                                                                  0314 00605000
*CDSREAD:                                                          0314 00606000
*   PROC;                           /*                               */ 00607000
CDSREAD  STM   @14,@12,@SA00005                                    0314 00608000
*   DCL                                                            0315 00609000
*     CDSRC FIXED(15);              /*                               */ 00610000
*   DCL                                                            0316 00611000
*     1 CDSFLAGS,                   /* LOCAL CONTROL FLAGS           */ 00612000
*      2 CDSVALID BIT(1),           /* SYSMOD IS VALID FOR PROCESSING*/ 00613000
*      2 * BIT(7);                  /* UNUSED                        */ 00614000
*   RFY                                                            0317 00615000
*     HMASMIOP BASED(LST1IOP@);                                    0317 00616000
*   RFY                                                            0318 00617000
*     TSLPARMS BASED(TBLXTSLP);                                    0318 00618000
*                                                                  0319 00619000
*   /*****************************************************************/ 00620000
*   /*                                                               */ 00621000
*   /* BYPASS ??????                                                 */ 00622000
*   /*                                                               */ 00623000
*   /*****************************************************************/ 00624000
*                                                                  0319 00625000
*   CDSRC=ZERO;                     /*                               */ 00626000
         SLR   CDSRC,CDSRC                                         0319 00627000
*   CDSFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 00628000
         MVI   CDSFLAGS,X'00'                                      0320 00629000
*   IF(LST1SMD=OFF                  /* SHOULD A RECORD BE GOTTEN     */ 00630000
*       |GETCDS=ON) THEN            /* FROM CDS?                     */ 00631000
         TM    GETCDS,B'00001000'                                  0321 00632000
         BNZ   @RT00321                                            0321 00633000
         TM    LST1SMD,B'10000000'                                 0321 00634000
         BO    @RF00321                                            0321 00635000
@RT00321 DS    0H                                                  0322 00636000
*     DO;                           /*                               */ 00637000
*       DO WHILE CDSVALID=OFF       /*                               */ 00638000
*             &CDSEOF=OFF           /*                               */ 00639000
*             &CDSRC<STOPFUNC;                                     0323 00640000
         B     @DE00323                                            0323 00641000
@DL00323 DS    0H                                                  0324 00642000
*         CALL LSTGET(HMASMIOP);    /* GET NEXT DIRECTORY ENTRY      */ 00643000
         ST    LST1IOP@,@AL00001                                   0324 00644000
         LA    @01,@AL00001                                        0324 00645000
         BAL   @14,LSTGET                                          0324 00646000
*         RFY                                                      0325 00647000
*           RTNCODE RSTD;           /* FROM CDS                      */ 00648000
*         IF RTNCODE>IOPEOF THEN    /* IO ERROR?                     */ 00649000
         CH    RTNCODE,@CH00037                                    0326 00650000
         BNH   @RF00326                                            0326 00651000
*           DO;                                                    0327 00652000
*             CDSRC=MAX(CDSRC,RTNCODE);/* SET RETURN CODE            */ 00653000
         CR    CDSRC,RTNCODE                                       0328 00654000
         BNL   *+6                                                      00655000
         LR    CDSRC,RTNCODE                                       0328 00656000
*           END;                    /*                               */ 00657000
*         IF RTNCODE=IOPEOF THEN    /* END OF FILE?                  */ 00658000
@RF00326 CH    RTNCODE,@CH00037                                    0330 00659000
         BNE   @RF00330                                            0330 00660000
*           DO;                                                    0331 00661000
*             CDSEOF=ON;            /* EOF FLAGGED                   */ 00662000
         OI    CDSEOF,B'00100000'                                  0332 00663000
*           END;                                                   0333 00664000
*         IF RTNCODE=ZERO THEN      /* ALL IS WELL?                  */ 00665000
@RF00330 LTR   RTNCODE,RTNCODE                                     0334 00666000
         BNZ   @RF00334                                            0334 00667000
*           DO;                     /* YES,                          */ 00668000
*             RFY                                                  0336 00669000
*               RTNCODE UNRSTD;                                    0336 00670000
*             IF LST1SMD=OFF THEN   /* 1ST SYSMOD NOT FOUND ON CDS?  */ 00671000
         TM    LST1SMD,B'10000000'                                 0337 00672000
         BNZ   @RF00337                                            0337 00673000
*               DO;                                                0338 00674000
*                 IF LST1IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?*/ 00675000
         CLI   IOPTYPE(LST1IOP@),11                                0339 00676000
         BNE   @RF00339                                            0339 00677000
*                   DO;                                            0340 00678000
*                     LST1SMD=ON;   /* 1ST CDS SYSMOD FOUND          */ 00679000
         OI    LST1SMD,B'10000000'                                 0341 00680000
*                   END;                                           0342 00681000
*               END;                                               0343 00682000
*             ELSE                  /* 1ST SYSMOD ALREADY FOUND      */ 00683000
*               DO;                                                0344 00684000
         B     @RC00337                                            0344 00685000
@RF00337 DS    0H                                                  0345 00686000
*                 IF LST1IOP@->IOPTYPE^=IOPSMD THEN/* NOT A SYSMOD?  */ 00687000
         CLI   IOPTYPE(LST1IOP@),11                                0345 00688000
         BE    @RF00345                                            0345 00689000
*                   DO;                                            0346 00690000
*                     CDSEOF=ON;    /* END OF SYSMODS                */ 00691000
         OI    CDSEOF,B'00100000'                                  0347 00692000
*                   END;                                           0348 00693000
*               END;                                               0349 00694000
@RF00345 DS    0H                                                  0350 00695000
*             IF LST1IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?    */ 00696000
@RC00337 CLI   IOPTYPE(LST1IOP@),11                                0350 00697000
         BNE   @RF00350                                            0350 00698000
*               DO;                                                0351 00699000
*                 IF IOPSBYP^=ON    /* NOT SUP'ED ...                */ 00700000
*                     &IOPDBYP^=ON THEN/* ... AND NOT DELETED?       */ 00701000
         TM    IOPSBYP(LST1IOP@),B'11000000'                       0352 00702000
         BNZ   @RF00352                                            0352 00703000
*                   DO;                                            0353 00704000
*                     CDSVALID=ON;  /* VALID CDS SYSMOD FOUND        */ 00705000
         OI    CDSVALID,B'10000000'                                0354 00706000
*                     IF IOPDELP=ON THEN/* DOES SYSMOD DELETE OTHER     00707000
*                                      SYSMODS?                      */ 00708000
         TM    IOPDELP(LST1IOP@),B'10000000'                       0355 00709000
         BNO   @RF00355                                            0355 00710000
*                       DO;         /* YES,                          */ 00711000
*                         CALL SELFND(IOPNAM17);/* FIND IN SELECT  0357 00712000
*                                      LIST                          */ 00713000
         LA    @10,IOPNAM17(,LST1IOP@)                             0357 00714000
         ST    @10,@AL00001                                        0357 00715000
         LA    @01,@AL00001                                        0357 00716000
         BAL   @14,SELFND                                          0357 00717000
*                         RFY                                      0358 00718000
*                           RTNCODE RSTD;                          0358 00719000
*                         IF RTNCODE=ZERO THEN/* FOUND?              */ 00720000
         LTR   RTNCODE,RTNCODE                                     0359 00721000
         BNZ   @RF00359                                            0359 00722000
*                           DO;     /* YES,                          */ 00723000
*                             CDSVALID=OFF;/* VALID CDS SYSMOD NOT 0361 00724000
*                                      FOUND                         */ 00725000
         NI    CDSVALID,B'01111111'                                0361 00726000
*                             RFY                                  0362 00727000
*                               RTNCODE UNRSTD;                    0362 00728000
*                                                                  0362 00729000
*                             /***************************************/ 00730000
*                             /*                                     */ 00731000
*                             /* HMA245I SYSMOD XXXXXXX SELECTED FOR */ 00732000
*                             /* RESTORE ... DELETES SYSMODS         */ 00733000
*                             /*                                     */ 00734000
*                             /***************************************/ 00735000
*                                                                  0363 00736000
*                             CDSRC=STOPSMD;/* FAIL THE SYSMOD       */ 00737000
         LA    CDSRC,8                                             0363 00738000
*                             DO;   /* HMASMPMG M1(HMA245I)M2(PART120   00739000
*                                      )TYPE(ERR)VAR(IOPNAM17)TARGET(   00740000
*                                      SYSOUT,LOG)                   */ 00741000
*                               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET 0365 00742000
*                                      PARMS TO ZEROS                */ 00743000
         XC    HMASMMGP(28),HMASMMGP                               0365 00744000
*                               MGPMGNO1=HMA245I;/* SET UP MSG 1 CODE*/ 00745000
         MVC   MGPMGNO1(2),@CH01237                                0366 00746000
*                               MGPMGNO2=PART120;/* SET UP MSG 2 CODE*/ 00747000
         MVC   MGPMGNO2(2),@CH01248                                0367 00748000
*                               MGPTYPE=MGPERR;/* SET MESSAGE TYPE   */ 00749000
         MVI   MGPTYPE,X'03'                                       0368 00750000
*                               MGPPRINT='1'B;/* SET TARGET FLAG     */ 00751000
*                               MGPHLDS='1'B;/* SET TARGET FLAG      */ 00752000
         OI    MGPPRINT,B'10010000'                                0370 00753000
*                               MGPVARPT(1)=ADDR(IOPNAM17);/* SET  0371 00754000
*                                      VARIABLE PTR                  */ 00755000
         LA    @10,IOPNAM17(,LST1IOP@)                             0371 00756000
         ST    @10,MGPVARPT                                        0371 00757000
*                               CALL HMASMMSG(HMASMMGP);/* HAVE    0372 00758000
*                                      MESSAGE ISSUED                */ 00759000
         L     @15,@CV01229                                        0372 00760000
         LA    @01,@AL00372                                        0372 00761000
         BALR  @14,@15                                             0372 00762000
*                             END;  /*                               */ 00763000
*                             TSLFUNCT=TSLFFUNC;/* CHECK FOR FUNCTION   00764000
*                                      FAILURE                       */ 00765000
         L     @10,@PC00001                                        0374 00766000
         L     @10,TBLXTSLP(,@10)                                  0374 00767000
         MVI   TSLFUNCT(@10),X'07'                                 0374 00768000
*                             TSLMTYPE=IOPPTYPE;/* TYPE ...          */ 00769000
         L     @08,TSLPMLAD(,@10)                                  0375 00770000
         MVC   TSLMTYPE(1,@08),IOPPTYPE(LST1IOP@)                  0375 00771000
*                             TSLMSMD=IOPNAM17;/* ... AND NAME       */ 00772000
         MVC   TSLMSMD(7,@08),IOPNAM17(LST1IOP@)                   0376 00773000
*                             CALL HMASMTSB(TSLPARMS);/* ...         */ 00774000
         ST    @10,@AL00001                                        0377 00775000
         L     @15,@CV01232                                        0377 00776000
         LA    @01,@AL00001                                        0377 00777000
         BALR  @14,@15                                             0377 00778000
*                             CDSRC=MAX(CDSRC,TSLRETRN);/* SET RETURN   00779000
*                                      CODE                          */ 00780000
         L     @10,@PC00001                                        0378 00781000
         L     @10,TBLXTSLP(,@10)                                  0378 00782000
         SLR   @08,@08                                             0378 00783000
         IC    @08,TSLRETRN(,@10)                                  0378 00784000
         CR    CDSRC,@08                                           0378 00785000
         BNL   *+6                                                      00786000
         LR    CDSRC,@08                                           0378 00787000
*                           END;                                   0379 00788000
*                         ELSE                                     0380 00789000
*                           ;       /* CONTINUE, SYSMOD IS ADDED TO     00790000
*                                      ICT BUT WILL BE MARKED NOGO 0380 00791000
*                                      LATER                         */ 00792000
@RF00359 DS    0H                                                  0381 00793000
*                       END;                                       0381 00794000
*                     ELSE                                         0382 00795000
*                       ;           /* DOES NOT CAUSE DELETES        */ 00796000
@RF00355 DS    0H                                                  0383 00797000
*                   END;                                           0383 00798000
*                 ELSE              /* SYSMOD OTHER THAN OK ON CDS   */ 00799000
*                   DO;                                            0384 00800000
         B     @RC00352                                            0384 00801000
@RF00352 DS    0H                                                  0385 00802000
*                     CALL CDSRCHK(HMASMIOP);/* CHECK THE STATUS OF     00803000
*                                      SYSMOD                        */ 00804000
         ST    LST1IOP@,@AL00001                                   0385 00805000
         LA    @01,@AL00001                                        0385 00806000
         BAL   @14,CDSRCHK                                         0385 00807000
*                     RFY                                          0386 00808000
*                       RTNCODE RSTD;/*                              */ 00809000
*                     CDSRC=MAX(CDSRC,RTNCODE);/* SET RC             */ 00810000
         CR    CDSRC,RTNCODE                                       0387 00811000
         BNL   *+6                                                      00812000
         LR    CDSRC,RTNCODE                                       0387 00813000
*                     RFY                                          0388 00814000
*                       RTNCODE UNRSTD;/*                            */ 00815000
*                   END;                                           0389 00816000
*               END;                                               0390 00817000
@RC00352 DS    0H                                                  0391 00818000
*           END;                                                   0391 00819000
@RF00350 DS    0H                                                  0392 00820000
*       END;                                                       0392 00821000
@RF00334 DS    0H                                                  0392 00822000
@DE00323 TM    CDSVALID,B'10000000'                                0392 00823000
         BNZ   @DC00323                                            0392 00824000
         TM    CDSEOF,B'00100000'                                  0392 00825000
         BNZ   @DC00323                                            0392 00826000
         CH    CDSRC,@CH00033                                      0392 00827000
         BL    @DL00323                                            0392 00828000
@DC00323 DS    0H                                                  0393 00829000
*     END;                          /*                               */ 00830000
*   ELSE                                                           0394 00831000
*     ;                             /* DONT GET DIR. ENTRY FROM CDS  */ 00832000
@RF00321 DS    0H                                                  0395 00833000
*   RETURN CODE(CDSRC);             /*                               */ 00834000
         LR    @15,CDSRC                                           0395 00835000
         L     @14,@SA00005                                        0395 00836000
         LM    @00,@12,@SA00005+8                                  0395 00837000
         BR    @14                                                 0395 00838000
*   RFY                                                            0396 00839000
*     HMASMIOP BASED;                                              0396 00840000
*CDSRCHK:                           /*                               */ 00841000
*   PROC(CDSRCIOP);                                                0397 00842000
CDSRCHK  STM   @14,@12,@SA00006                                    0397 00843000
         MVC   @PC00006(4),0(@01)                                  0397 00844000
*   DCL                                                            0398 00845000
*     CDSRCIOP CHAR(*);             /* IOP                           */ 00846000
*   DCL                                                            0399 00847000
*     CDSRRC FIXED(15);             /* LOCAL RETURN CODE             */ 00848000
*   RFY                                                            0400 00849000
*     HMASMIOP BASED(ADDR(CDSRCIOP));                              0400 00850000
*   CDSRRC=''B;                     /* CLEAR RETURN CODE             */ 00851000
         SLR   CDSRRC,CDSRRC                                       0401 00852000
*                                                                  0402 00853000
*   /*****************************************************************/ 00854000
*   /*                                                               */ 00855000
*   /* LOCATE SYSMOD IN SELECT/GROUP LIST                            */ 00856000
*   /*                                                               */ 00857000
*   /*****************************************************************/ 00858000
*                                                                  0402 00859000
*   CALL SELFND(IOPNAM17);                                         0402 00860000
         L     @10,@PC00006                                        0402 00861000
         LA    @10,IOPNAM17(,@10)                                  0402 00862000
         ST    @10,@AL00001                                        0402 00863000
         LA    @01,@AL00001                                        0402 00864000
         BAL   @14,SELFND                                          0402 00865000
*   RFY                                                            0403 00866000
*     RTNCODE RSTD;                                                0403 00867000
*   IF RTNCODE>=STOPSMD THEN        /* ERROR RETURN?                 */ 00868000
         CH    RTNCODE,@CH00055                                    0404 00869000
         BL    @RF00404                                            0404 00870000
*     DO;                           /* YES,                          */ 00871000
*       CDSRRC=MAX(CDSRRC,RTNCODE); /* SAVE RETURN CODE              */ 00872000
         CR    CDSRRC,RTNCODE                                      0406 00873000
         BNL   *+6                                                      00874000
         LR    CDSRRC,RTNCODE                                      0406 00875000
*     END;                          /*                               */ 00876000
*   IF RTNCODE=ZERO THEN            /* FOUND IN THE SELECT LIST?     */ 00877000
@RF00404 LTR   RTNCODE,RTNCODE                                     0408 00878000
         BNZ   @RF00408                                            0408 00879000
*     DO;                           /* YES,                          */ 00880000
*       RFY                                                        0410 00881000
*         RTNCODE UNRSTD;                                          0410 00882000
*       IF IOPDUMMP=ON THEN         /* DUMMY ONLY ?                  */ 00883000
         L     @10,@PC00006                                        0411 00884000
         TM    IOPDUMMP(@10),B'00000100'                           0411 00885000
         BNO   @RF00411                                            0411 00886000
*         DO;                       /* YES,                          */ 00887000
*           IF IOPSBYP=ON THEN      /* SUP ONLY ENTRY?               */ 00888000
         TM    IOPSBYP(@10),B'10000000'                            0413 00889000
         BNO   @RF00413                                            0413 00890000
*             DO;                   /* YES,                          */ 00891000
*               CDSRRC=MAX(CDSRRC,STOPSMD);/* SET THEN RETURN CODE   */ 00892000
*                                                                  0415 00893000
         LA    @08,8                                               0415 00894000
         CR    CDSRRC,@08                                          0415 00895000
         BNL   *+6                                                      00896000
         LR    CDSRRC,@08                                          0415 00897000
*               /*****************************************************/ 00898000
*               /*                                                   */ 00899000
*               /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED FOR*/ 00900000
*               /* RESTORE ... IS SUPERCEEDED                        */ 00901000
*               /*                                                   */ 00902000
*               /*****************************************************/ 00903000
*                                                                  0416 00904000
*               DO;                 /* HMASMPMG M1(HMA245I)M2(PART100   00905000
*                                      )TYPE(ERR)VAR(IOPNAM17)TARGET(   00906000
*                                      SYSOUT,LOG)                   */ 00907000
*                 HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS  */ 00908000
         XC    HMASMMGP(28),HMASMMGP                               0417 00909000
*                 MGPMGNO1=HMA245I; /* SET UP MSG 1 CODE             */ 00910000
         MVC   MGPMGNO1(2),@CH01237                                0418 00911000
*                 MGPMGNO2=PART100; /* SET UP MSG 2 CODE             */ 00912000
         MVC   MGPMGNO2(2),@CH00349                                0419 00913000
*                 MGPTYPE=MGPERR;   /* SET MESSAGE TYPE              */ 00914000
         MVI   MGPTYPE,X'03'                                       0420 00915000
*                 MGPPRINT='1'B;    /* SET TARGET FLAG               */ 00916000
*                 MGPHLDS='1'B;     /* SET TARGET FLAG               */ 00917000
         OI    MGPPRINT,B'10010000'                                0422 00918000
*                 MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR     */ 00919000
         LA    @10,IOPNAM17(,@10)                                  0423 00920000
         ST    @10,MGPVARPT                                        0423 00921000
*                 CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED     */ 00922000
         L     @15,@CV01229                                        0424 00923000
         LA    @01,@AL00424                                        0424 00924000
         BALR  @14,@15                                             0424 00925000
*               END;                /*                               */ 00926000
*               TSLFUNCT=TSLFFUNC;  /* CHECK FOR FUNCTION FAILURE    */ 00927000
         L     @10,@PC00001                                        0426 00928000
         L     @10,TBLXTSLP(,@10)                                  0426 00929000
         MVI   TSLFUNCT(@10),X'07'                                 0426 00930000
*               TSLMTYPE=IOPPTYPE;  /* TYPE ...                      */ 00931000
         L     @08,TSLPMLAD(,@10)                                  0427 00932000
         L     @02,@PC00006                                        0427 00933000
         MVC   TSLMTYPE(1,@08),IOPPTYPE(@02)                       0427 00934000
*               TSLMSMD=IOPNAM17;   /* ... AND NAME                  */ 00935000
         MVC   TSLMSMD(7,@08),IOPNAM17(@02)                        0428 00936000
*               CALL HMASMTSB(TSLPARMS);/* ...                       */ 00937000
         ST    @10,@AL00001                                        0429 00938000
         L     @15,@CV01232                                        0429 00939000
         LA    @01,@AL00001                                        0429 00940000
         BALR  @14,@15                                             0429 00941000
*               CDSRRC=MAX(CDSRRC,TSLRETRN);/* SET THE RETURN CODE   */ 00942000
         L     @10,@PC00001                                        0430 00943000
         L     @10,TBLXTSLP(,@10)                                  0430 00944000
         SLR   @08,@08                                             0430 00945000
         IC    @08,TSLRETRN(,@10)                                  0430 00946000
         CR    CDSRRC,@08                                          0430 00947000
         BNL   *+6                                                      00948000
         LR    CDSRRC,@08                                          0430 00949000
*             END;                                                 0431 00950000
*           ELSE                    /* NOT SUP                       */ 00951000
*             DO;                                                  0432 00952000
         B     @RC00413                                            0432 00953000
@RF00413 DS    0H                                                  0433 00954000
*               IF IOPDBYP=ON THEN  /* DELETE ENTRY                  */ 00955000
         L     @10,@PC00006                                        0433 00956000
         TM    IOPDBYP(@10),B'01000000'                            0433 00957000
         BNO   @RF00433                                            0433 00958000
*                 DO;               /* YES                           */ 00959000
*                   CDSRRC=MAX(CDSRRC,STOPSMD);/* SET THE RETURN CODE*/ 00960000
*                                                                  0435 00961000
         LA    @08,8                                               0435 00962000
         CR    CDSRRC,@08                                          0435 00963000
         BNL   *+6                                                      00964000
         LR    CDSRRC,@08                                          0435 00965000
*                   /*************************************************/ 00966000
*                   /*                                               */ 00967000
*                   /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED*/ 00968000
*                   /* FOR RESTORE ... IS DELETED                    */ 00969000
*                   /*                                               */ 00970000
*                   /*************************************************/ 00971000
*                                                                  0436 00972000
*                   DO;             /* HMASMPMG M1(HMA245I)M2(PART099   00973000
*                                      )TYPE(ERR)VAR(IOPNAM17)TARGET(   00974000
*                                      SYSOUT,LOG)                   */ 00975000
*                     HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO  0437 00976000
*                                      ZEROS                         */ 00977000
         XC    HMASMMGP(28),HMASMMGP                               0437 00978000
*                     MGPMGNO1=HMA245I;/* SET UP MSG 1 CODE          */ 00979000
         MVC   MGPMGNO1(2),@CH01237                                0438 00980000
*                     MGPMGNO2=PART099;/* SET UP MSG 2 CODE          */ 00981000
         MVC   MGPMGNO2(2),@CH01245                                0439 00982000
*                     MGPTYPE=MGPERR;/* SET MESSAGE TYPE             */ 00983000
         MVI   MGPTYPE,X'03'                                       0440 00984000
*                     MGPPRINT='1'B;/* SET TARGET FLAG               */ 00985000
*                     MGPHLDS='1'B; /* SET TARGET FLAG               */ 00986000
         OI    MGPPRINT,B'10010000'                                0442 00987000
*                     MGPVARPT(1)=ADDR(IOPNAM17);/* SET VARIABLE PTR */ 00988000
         LA    @10,IOPNAM17(,@10)                                  0443 00989000
         ST    @10,MGPVARPT                                        0443 00990000
*                     CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED */ 00991000
         L     @15,@CV01229                                        0444 00992000
         LA    @01,@AL00444                                        0444 00993000
         BALR  @14,@15                                             0444 00994000
*                   END;            /*                               */ 00995000
*                   TSLFUNCT=TSLFFUNC;/* CHECK FOR FUNCTION FAILURE  */ 00996000
         L     @10,@PC00001                                        0446 00997000
         L     @10,TBLXTSLP(,@10)                                  0446 00998000
         MVI   TSLFUNCT(@10),X'07'                                 0446 00999000
*                   TSLMTYPE=IOPPTYPE;/* TYPE ...                    */ 01000000
         L     @08,TSLPMLAD(,@10)                                  0447 01001000
         L     @02,@PC00006                                        0447 01002000
         MVC   TSLMTYPE(1,@08),IOPPTYPE(@02)                       0447 01003000
*                   TSLMSMD=IOPNAM17;/* ... AND NAME                 */ 01004000
         MVC   TSLMSMD(7,@08),IOPNAM17(@02)                        0448 01005000
*                   CALL HMASMTSB(TSLPARMS);/* ...                   */ 01006000
         ST    @10,@AL00001                                        0449 01007000
         L     @15,@CV01232                                        0449 01008000
         LA    @01,@AL00001                                        0449 01009000
         BALR  @14,@15                                             0449 01010000
*                   CDSRRC=MAX(CDSRRC,TSLRETRN);/* SET THE RETURN  0450 01011000
*                                      CODE                          */ 01012000
         L     @10,@PC00001                                        0450 01013000
         L     @10,TBLXTSLP(,@10)                                  0450 01014000
         SLR   @08,@08                                             0450 01015000
         IC    @08,TSLRETRN(,@10)                                  0450 01016000
         CR    CDSRRC,@08                                          0450 01017000
         BNL   *+6                                                      01018000
         LR    CDSRRC,@08                                          0450 01019000
*                 END;                                             0451 01020000
*             END;                                                 0452 01021000
*         END;                                                     0453 01022000
*       ELSE                        /* SUP BUT NOT A SUP ONLY        */ 01023000
*         DO;                                                      0454 01024000
         B     @RC00411                                            0454 01025000
@RF00411 DS    0H                                                  0455 01026000
*           CDSVALID=ON;            /* VALID SYSMOD FOR RESTORE      */ 01027000
         OI    CDSVALID,B'10000000'                                0455 01028000
*         END;                                                     0456 01029000
*     END;                                                         0457 01030000
*   ELSE                            /* NOT IN THE SELECT LIST OR ERR */ 01031000
*     DO;                                                          0458 01032000
*                                                                  0458 01033000
         B     @RC00408                                            0458 01034000
@RF00408 DS    0H                                                  0459 01035000
*       /*************************************************************/ 01036000
*       /*                                                           */ 01037000
*       /* IF DELETE THEN NOT VALID, IF SUP OK                       */ 01038000
*       /*                                                           */ 01039000
*       /*************************************************************/ 01040000
*                                                                  0459 01041000
*       IF IOPSBYP=ON THEN          /* SUP'ED SYSMOD?                */ 01042000
         L     @10,@PC00006                                        0459 01043000
         TM    IOPSBYP(@10),B'10000000'                            0459 01044000
         BNO   @RF00459                                            0459 01045000
*         DO;                       /* YES,                          */ 01046000
*           CDSVALID=ON;            /* VALID SYSMOD FOR RESTORE      */ 01047000
         OI    CDSVALID,B'10000000'                                0461 01048000
*         END;                                                     0462 01049000
*       ELSE                                                       0463 01050000
*         ;                         /* NOT SUP, MUST BE DELETE, SO 0463 01051000
*                                      SKIP IT                       */ 01052000
@RF00459 DS    0H                                                  0464 01053000
*     END;                                                         0464 01054000
*   RETURN CODE(CDSRRC);            /* RETURN W/ RC                  */ 01055000
@RC00408 LR    @15,CDSRRC                                          0465 01056000
         L     @14,@SA00006                                        0465 01057000
         LM    @00,@12,@SA00006+8                                  0465 01058000
         BR    @14                                                 0465 01059000
*   RFY                                                            0466 01060000
*     HMASMIOP BASED;                                              0466 01061000
*   RFY                                                            0467 01062000
*     TSLPARMS BASED;                                              0467 01063000
*   END CDSRCHK;                    /*                               */ 01064000
*   END CDSREAD;                    /*                               */ 01065000
*                                                                  0470 01066000
*   /*****************************************************************/ 01067000
*   /*                                                               */ 01068000
*   /* ACDSREAD - GET NEXT DIRECTORY ENTRY FROM ACDS                 */ 01069000
*   /*                                                               */ 01070000
*   /*****************************************************************/ 01071000
*                                                                  0470 01072000
*ACDSREAD:                                                         0470 01073000
*   PROC;                           /*                               */ 01074000
ACDSREAD STM   @14,@12,@SA00007                                    0470 01075000
*   DCL                                                            0471 01076000
*     ACDSRC FIXED(15);                                            0471 01077000
*   DCL                                                            0472 01078000
*     1 ACDSFLGS,                   /* LOCAL CONTROL FLAGS           */ 01079000
*      2 ACDSVALD BIT(1),           /* ACDS ENTRY IS VALID TO BE   0472 01080000
*                                      PROCESSED                     */ 01081000
*      2 * BIT(7);                  /* UNUSED                        */ 01082000
*   RFY                                                            0473 01083000
*     HMASMIOP BASED(LST2IOP@);                                    0473 01084000
*   ACDSRC=ZERO;                    /*                               */ 01085000
         SLR   ACDSRC,ACDSRC                                       0474 01086000
*   ACDSFLGS=''B;                   /* CLEAR CONTROL FLAGS           */ 01087000
         MVI   ACDSFLGS,X'00'                                      0475 01088000
*   IF(LST2SMD=OFF                  /* SHOULD A RECORD BE GOTTEN     */ 01089000
*       |ACDSGET=ON) THEN           /* FROM ACDS?                    */ 01090000
         TM    ACDSGET,B'00000100'                                 0476 01091000
         BNZ   @RT00476                                            0476 01092000
         TM    LST2SMD,B'01000000'                                 0476 01093000
         BO    @RF00476                                            0476 01094000
@RT00476 DS    0H                                                  0477 01095000
*     DO;                                                          0477 01096000
*       DO WHILE ACDSVALD=OFF       /*                               */ 01097000
*             &ACDSEOF=OFF          /*                               */ 01098000
*             &ACDSRC<STOPFUNC;     /*                               */ 01099000
         B     @DE00478                                            0478 01100000
@DL00478 DS    0H                                                  0479 01101000
*         CALL LSTGET(HMASMIOP);    /* GET DIR. ENTRY FROM CDS       */ 01102000
         ST    LST2IOP@,@AL00001                                   0479 01103000
         LA    @01,@AL00001                                        0479 01104000
         BAL   @14,LSTGET                                          0479 01105000
*         RFY                                                      0480 01106000
*           RTNCODE RSTD;                                          0480 01107000
*         IF RTNCODE>IOPEOF THEN    /* IO ERROR?                     */ 01108000
         CH    RTNCODE,@CH00037                                    0481 01109000
         BNH   @RF00481                                            0481 01110000
*           DO;                                                    0482 01111000
*             ACDSRC=MAX(ACDSRC,RTNCODE);/* SET RETURN CODE          */ 01112000
         CR    ACDSRC,RTNCODE                                      0483 01113000
         BNL   *+6                                                      01114000
         LR    ACDSRC,RTNCODE                                      0483 01115000
*           END;                    /*                               */ 01116000
*         IF RTNCODE=IOPEOF THEN    /* END OF FILE?                  */ 01117000
@RF00481 CH    RTNCODE,@CH00037                                    0485 01118000
         BNE   @RF00485                                            0485 01119000
*           DO;                                                    0486 01120000
*             ACDSEOF=ON;           /* END OF FILE FOUND             */ 01121000
         OI    ACDSEOF,B'00010000'                                 0487 01122000
*           END;                                                   0488 01123000
*         IF RTNCODE=ZERO THEN      /* ALL IS WELL?                  */ 01124000
@RF00485 LTR   RTNCODE,RTNCODE                                     0489 01125000
         BNZ   @RF00489                                            0489 01126000
*           DO;                     /* YES,                          */ 01127000
*             RFY                                                  0491 01128000
*               RTNCODE UNRSTD;                                    0491 01129000
*             IF LST2SMD=OFF THEN   /* 1ST SYSMOD NOT FOUND ON ACDS? */ 01130000
         TM    LST2SMD,B'01000000'                                 0492 01131000
         BNZ   @RF00492                                            0492 01132000
*               DO;                                                0493 01133000
*                 IF LST2IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?*/ 01134000
         CLI   IOPTYPE(LST2IOP@),11                                0494 01135000
         BNE   @RF00494                                            0494 01136000
*                   DO;                                            0495 01137000
*                     LST2SMD=ON;   /* 1ST ACDS SYSMOD FOUND         */ 01138000
         OI    LST2SMD,B'01000000'                                 0496 01139000
*                   END;                                           0497 01140000
*                 ELSE                                             0498 01141000
*                   ;               /* NOT A SYSMOD TYPE             */ 01142000
@RF00494 DS    0H                                                  0499 01143000
*               END;                                               0499 01144000
*             ELSE                  /* 1ST SYSMOD ALREADY FOUND      */ 01145000
*               DO;                                                0500 01146000
         B     @RC00492                                            0500 01147000
@RF00492 DS    0H                                                  0501 01148000
*                 IF LST2IOP@->IOPTYPE^=IOPSMD THEN/* NOT A SYSMOD?  */ 01149000
         CLI   IOPTYPE(LST2IOP@),11                                0501 01150000
         BE    @RF00501                                            0501 01151000
*                   DO;                                            0502 01152000
*                     ACDSEOF=ON;   /* END OF SYSMODS                */ 01153000
         OI    ACDSEOF,B'00010000'                                 0503 01154000
*                   END;                                           0504 01155000
*               END;                                               0505 01156000
@RF00501 DS    0H                                                  0506 01157000
*             IF LST2IOP@->IOPTYPE=IOPSMD THEN/* ENTRY IS SYSMOD?    */ 01158000
@RC00492 CLI   IOPTYPE(LST2IOP@),11                                0506 01159000
         BNE   @RF00506                                            0506 01160000
*               DO;                                                0507 01161000
*                 ACDSVALD=ON;      /* VALID ENTRY FOUND             */ 01162000
         OI    ACDSVALD,B'10000000'                                0508 01163000
*               END;                                               0509 01164000
*           END;                                                   0510 01165000
@RF00506 DS    0H                                                  0511 01166000
*       END;                                                       0511 01167000
@RF00489 DS    0H                                                  0511 01168000
@DE00478 TM    ACDSVALD,B'10000000'                                0511 01169000
         BNZ   @DC00478                                            0511 01170000
         TM    ACDSEOF,B'00010000'                                 0511 01171000
         BNZ   @DC00478                                            0511 01172000
         CH    ACDSRC,@CH00033                                     0511 01173000
         BL    @DL00478                                            0511 01174000
@DC00478 DS    0H                                                  0512 01175000
*     END;                                                         0512 01176000
*   RETURN CODE(ACDSRC);            /*                               */ 01177000
@RF00476 LR    @15,ACDSRC                                          0513 01178000
         L     @14,@SA00007                                        0513 01179000
         LM    @00,@12,@SA00007+8                                  0513 01180000
         BR    @14                                                 0513 01181000
*   RFY                                                            0514 01182000
*     HMASMIOP BASED;                                              0514 01183000
*   END ACDSREAD;                   /*                               */ 01184000
*LSTCHK:                                                           0516 01185000
*   PROC;                                                          0516 01186000
LSTCHK   STM   @14,@12,@SA00008                                    0516 01187000
*   DCL                                                            0517 01188000
*     LSTCRC FIXED(15);             /* LOCAL RETURN CODE             */ 01189000
*   RFY                                                            0518 01190000
*     TSLPARMS BASED(TBLXTSLP);                                    0518 01191000
*   LSTCRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 01192000
         SLR   LSTCRC,LSTCRC                                       0519 01193000
*                                                                  0520 01194000
*   /*****************************************************************/ 01195000
*   /*                                                               */ 01196000
*   /* DETERMINE IF DELTA 2 ENTRY IS NEEDED                          */ 01197000
*   /*                                                               */ 01198000
*   /*****************************************************************/ 01199000
*                                                                  0520 01200000
*   RFY                                                            0520 01201000
*     HMASMIOP BASED(LST2IOP@);     /* ACDS IOP                      */ 01202000
*   IF IOPERROR=ON                  /* IN ERROR ...                  */ 01203000
*       |IOPDBYP=ON THEN            /* ... OR IS DELETED?            */ 01204000
         TM    IOPERROR(LST2IOP@),B'00010000'                      0521 01205000
         BO    @RT00521                                            0521 01206000
         TM    IOPDBYP(LST2IOP@),B'01000000'                       0521 01207000
         BNO   @RF00521                                            0521 01208000
@RT00521 DS    0H                                                  0522 01209000
*     DO;                           /* YES,                          */ 01210000
*       LSTENT2=ON;                 /* ADD SYSMOD TO DELTA 2 LIST    */ 01211000
         OI    LSTENT2,B'00000001'                                 0523 01212000
*     END;                                                         0524 01213000
*   CALL SELFND(LSTSMD1);           /* DETERMINE IF THE SYSMOD IS IN    01214000
*                                      THE SELECT LIST               */ 01215000
@RF00521 LA    @10,LSTSMD1+4(,LST1IOP@)                            0525 01216000
         ST    @10,@AL00001                                        0525 01217000
         LA    @01,@AL00001                                        0525 01218000
         BAL   @14,SELFND                                          0525 01219000
*   RFY                                                            0526 01220000
*     RTNCODE RSTD;                                                0526 01221000
*   IF RTNCODE^=ZERO THEN           /* IN THE SELECT LIST?           */ 01222000
         LTR   RTNCODE,RTNCODE                                     0527 01223000
         BZ    @RF00527                                            0527 01224000
*     DO;                           /* NO,                           */ 01225000
*       IF RTNCODE>GTPNTFND THEN    /* RC OTHER THAN NOT FOUND?      */ 01226000
         CH    RTNCODE,@CH00037                                    0529 01227000
         BNH   @RF00529                                            0529 01228000
*         DO;                       /* YES,                          */ 01229000
*           LSTCRC=MAX(LSTCRC,RTNCODE);/*                            */ 01230000
         CR    LSTCRC,RTNCODE                                      0531 01231000
         BNL   *+6                                                      01232000
         LR    LSTCRC,RTNCODE                                      0531 01233000
*         END;                                                     0532 01234000
*       ELSE                                                       0533 01235000
*         ;                         /* NOT FOUND IN SELECT LIST      */ 01236000
@RF00529 DS    0H                                                  0534 01237000
*     END;                                                         0534 01238000
*   ELSE                            /* NOT FOUND                     */ 01239000
*     DO;                                                          0535 01240000
         B     @RC00527                                            0535 01241000
@RF00527 DS    0H                                                  0536 01242000
*       RFY                                                        0536 01243000
*         RTNCODE UNRSTD;                                          0536 01244000
*                                                                  0536 01245000
*       /*************************************************************/ 01246000
*       /*                                                           */ 01247000
*       /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED FOR RESTORE*/ 01248000
*       /* HAS BEEN ACCEPTED                                         */ 01249000
*       /*                                                           */ 01250000
*       /*************************************************************/ 01251000
*                                                                  0537 01252000
*       DO;                         /* HMASMPMG M1(HMA245I)M2(PART008   01253000
*                                      )TYPE(ERR)VAR(LSTSMD1)TARGET(S   01254000
*                                      YSOUT,LOG)                    */ 01255000
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */ 01256000
         XC    HMASMMGP(28),HMASMMGP                               0538 01257000
*         MGPMGNO1=HMA245I;         /* SET UP MSG 1 CODE             */ 01258000
         MVC   MGPMGNO1(2),@CH01237                                0539 01259000
*         MGPMGNO2=PART008;         /* SET UP MSG 2 CODE             */ 01260000
         MVC   MGPMGNO2(2),@CH00055                                0540 01261000
*         MGPTYPE=MGPERR;           /* SET MESSAGE TYPE              */ 01262000
         MVI   MGPTYPE,X'03'                                       0541 01263000
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */ 01264000
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */ 01265000
         OI    MGPPRINT,B'10010000'                                0543 01266000
*         MGPVARPT(1)=ADDR(LSTSMD1);/* SET VARIABLE PTR              */ 01267000
         LA    @10,4                                               0544 01268000
         ALR   @10,LST1IOP@                                        0544 01269000
         ST    @10,MGPVARPT                                        0544 01270000
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */ 01271000
         L     @15,@CV01229                                        0545 01272000
         LA    @01,@AL00545                                        0545 01273000
         BALR  @14,@15                                             0545 01274000
*       END;                        /*                               */ 01275000
*       TSLFUNCT=TSLFFUNC;          /* CHECK FOR FUNCTION FAILURE    */ 01276000
         L     @10,@PC00001                                        0547 01277000
         L     @10,TBLXTSLP(,@10)                                  0547 01278000
         MVI   TSLFUNCT(@10),X'07'                                 0547 01279000
*       TSLMTYPE=IOPPTYPE;          /* TYPE ...                      */ 01280000
         L     @08,TSLPMLAD(,@10)                                  0548 01281000
         MVC   TSLMTYPE(1,@08),IOPPTYPE(LST2IOP@)                  0548 01282000
*       TSLMSMD=IOPNAM17;           /* ... AND NAME                  */ 01283000
         MVC   TSLMSMD(7,@08),IOPNAM17(LST2IOP@)                   0549 01284000
*       CALL HMASMTSB(TSLPARMS);    /* ...                           */ 01285000
         ST    @10,@AL00001                                        0550 01286000
         L     @15,@CV01232                                        0550 01287000
         LA    @01,@AL00001                                        0550 01288000
         BALR  @14,@15                                             0550 01289000
*       LSTCRC=MAX(LSTCRC,TSLRETRN);/* SET THE RETURN CODE           */ 01290000
         L     @10,@PC00001                                        0551 01291000
         L     @10,TBLXTSLP(,@10)                                  0551 01292000
         SLR   @08,@08                                             0551 01293000
         IC    @08,TSLRETRN(,@10)                                  0551 01294000
         CR    LSTCRC,@08                                          0551 01295000
         BNL   *+6                                                      01296000
         LR    LSTCRC,@08                                          0551 01297000
*     END;                                                         0552 01298000
*   RETURN CODE(LSTCRC);            /* RETURN W/ RC                  */ 01299000
@RC00527 LR    @15,LSTCRC                                          0553 01300000
         L     @14,@SA00008                                        0553 01301000
         LM    @00,@12,@SA00008+8                                  0553 01302000
         BR    @14                                                 0553 01303000
*   RFY                                                            0554 01304000
*     HMASMIOP BASED;                                              0554 01305000
*   RFY                                                            0555 01306000
*     TSLPARMS BASED;                                              0555 01307000
*   END LSTCHK;                                                    0556 01308000
*   END LSTBLD;                                                    0557 01309000
*                                                                  0558 01310000
*/********************************************************************/ 01311000
*/*                                                                  */ 01312000
*/* SELCHK                                                           */ 01313000
*/*                                                                  */ 01314000
*/* INPUT - 1) SELECT/GROUP GTA FILE                                 */ 01315000
*/*         2) PTF SECTION OF THE ICT                                */ 01316000
*/*                                                                  */ 01317000
*/* OUTPUT - 1) ERROR MESSAGE FOR EACH SYSMOD IN THE SELECT LIST AND */ 01318000
*/*             NOT IN THE ICT FOR WHICH AN ERROR MESSAGE HAS NOT    */ 01319000
*/*             ALREADY BEEN ISSUED                                  */ 01320000
*/*          2) THE SELECT LIST AND THE RESTORE CANDIDATE FLAGS      */ 01321000
*/*             WILL BE SET FOR EACH SYSMOD IN BOTH THE GTA FILE     */ 01322000
*/*             AND THE ICT.                                         */ 01323000
*/*                                                                  */ 01324000
*/********************************************************************/ 01325000
*                                                                  0558 01326000
*SELCHK:                                                           0558 01327000
*   PROC;                                                          0558 01328000
SELCHK   STM   @14,@12,@SA00009                                    0558 01329000
*   DCL                                                            0559 01330000
*     SELCHKRC FIXED(15);           /* RETURN CODE                   */ 01331000
*   DCL                                                            0560 01332000
*     1 SELCFLGS,                   /* LOCAL CONTROL FLAGS           */ 01333000
*      2 SELCEOF BIT(1),            /* END OF FILE ON SELEGCT/GROUP     01334000
*                                      GTA FILE                      */ 01335000
*      2 * BIT(7);                  /* UNUSED                        */ 01336000
*   RFY                                                            0561 01337000
*     HMASMGTP BASED(TBLXSEGT);                                    0561 01338000
*   RFY                                                            0562 01339000
*     HMASMSET BASED(GTPBUFAD);                                    0562 01340000
*   RFY                                                            0563 01341000
*     TSLPARMS BASED(TBLXTSLP);                                    0563 01342000
*   SELCHKRC=ZERO;                  /* CLEAR RETURN CODE             */ 01343000
         SLR   SELCHKRC,SELCHKRC                                   0564 01344000
*   SELCFLGS=''B;                   /* CLEAR LOCAL FLAGS             */ 01345000
         MVI   SELCFLGS,X'00'                                      0565 01346000
*   GTPFUNCT=GTPOPENN;              /* POSITION TO THE BEGINNING OF     01347000
*                                      THE SELECT/GROUP GTA FILE     */ 01348000
         L     @10,@PC00001                                        0566 01349000
         L     @10,TBLXSEGT(,@10)                                  0566 01350000
         MVI   GTPFUNCT(@10),X'01'                                 0566 01351000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 01352000
         ST    @10,@AL00001                                        0567 01353000
         L     @15,@CV01233                                        0567 01354000
         LA    @01,@AL00001                                        0567 01355000
         BALR  @14,@15                                             0567 01356000
*   SELCEOF=OFF;                    /* CLEAR END OF FILE             */ 01357000
         NI    SELCEOF,B'01111111'                                 0568 01358000
*   GTPFUNCT=GTPGETN;               /* FUNCTION IS GET NEXT          */ 01359000
         L     @10,@PC00001                                        0569 01360000
         L     @10,TBLXSEGT(,@10)                                  0569 01361000
         MVI   GTPFUNCT(@10),X'08'                                 0569 01362000
*   DO WHILE(SELCEOF=OFF            /*                               */ 01363000
*         &SELCHKRC<STOPFUNC);      /*                               */ 01364000
         B     @DE00570                                            0570 01365000
@DL00570 DS    0H                                                  0571 01366000
*     CALL HMASMGTA(HMASMGTP);      /* GET NEXT LIST ENTRY           */ 01367000
         L     @10,@PC00001                                        0571 01368000
         L     @10,TBLXSEGT(,@10)                                  0571 01369000
         ST    @10,@AL00001                                        0571 01370000
         L     @15,@CV01233                                        0571 01371000
         LA    @01,@AL00001                                        0571 01372000
         BALR  @14,@15                                             0571 01373000
*     IF GTPRETRN=GTPEOF THEN       /* END OF FILE?                  */ 01374000
         L     @10,@PC00001                                        0572 01375000
         L     @10,TBLXSEGT(,@10)                                  0572 01376000
         CLI   GTPRETRN(@10),4                                     0572 01377000
         BNE   @RF00572                                            0572 01378000
*       DO;                         /* YES,                          */ 01379000
*         SELCEOF=ON;               /* END OF FILE                   */ 01380000
         OI    SELCEOF,B'10000000'                                 0574 01381000
*       END;                                                       0575 01382000
*     ELSE                          /* NOT END OF FILE               */ 01383000
*       DO;                                                        0576 01384000
*                                                                  0576 01385000
         B     @RC00572                                            0576 01386000
@RF00572 DS    0H                                                  0577 01387000
*         /***********************************************************/ 01388000
*         /*                                                         */ 01389000
*         /* SEARCH FOR THE SELECTED SYSMOD IN THE ICT               */ 01390000
*         /*                                                         */ 01391000
*         /***********************************************************/ 01392000
*                                                                  0577 01393000
*         TSLICTSR=''B;             /* CLEAR THE PARMLIST            */ 01394000
         L     @10,@PC00001                                        0577 01395000
         L     @08,TBLXTSLP(,@10)                                  0577 01396000
         L     @03,TSLPMLAD(,@08)                                  0577 01397000
         XC    TSLICTSR(14,@03),TSLICTSR(@03)                      0577 01398000
*         TSLFUNCT=TSLFISRH;        /* SEARCH THE ICT                */ 01399000
         MVI   TSLFUNCT(@08),X'01'                                 0578 01400000
*         TSLISMD=SESMDNO;          /* SEARCH FOR SELECT/GROUP LIST     01401000
*                                      SYSMOD                        */ 01402000
         L     @10,TBLXSEGT(,@10)                                  0579 01403000
         L     @10,GTPBUFAD(,@10)                                  0579 01404000
         MVC   TSLISMD(7,@03),SESMDNO(@10)                         0579 01405000
*         CALL HMASMTSB(TSLPARMS);  /* ...                           */ 01406000
         ST    @08,@AL00001                                        0580 01407000
         L     @15,@CV01232                                        0580 01408000
         LA    @01,@AL00001                                        0580 01409000
         BALR  @14,@15                                             0580 01410000
*         IF TSLIFND=ON THEN        /* FOUND IN THE ICT?             */ 01411000
         L     @10,@PC00001                                        0581 01412000
         L     @10,TBLXTSLP(,@10)                                  0581 01413000
         L     @10,TSLPMLAD(,@10)                                  0581 01414000
         TM    TSLIFND(@10),B'10000000'                            0581 01415000
         BNO   @RF00581                                            0581 01416000
*           DO;                     /* YES,                          */ 01417000
*             RFY                                                  0583 01418000
*               ICTPTF BASED(TSLICTP);                             0583 01419000
*             ICTPSLST(1)=ON;       /* SYSMOD IN SELECT/GROUP LIST   */ 01420000
         L     @10,TSLICTP(,@10)                                   0584 01421000
         OI    ICTPSLST(@10),B'00000010'                           0584 01422000
*             ICTPRCND(1)=ON;       /* SYSMOD IS CANDIDATE           */ 01423000
         OI    ICTPRCND(@10),B'00010000'                           0585 01424000
*             RFY                                                  0586 01425000
*               ICTPTF BASED;                                      0586 01426000
*           END;                                                   0587 01427000
*         ELSE                      /* NOT FOUND IN ICT THEN THERE IS   01428000
*                                      AN ERROR                      */ 01429000
*           DO;                                                    0588 01430000
         B     @RC00581                                            0588 01431000
@RF00581 DS    0H                                                  0589 01432000
*             IF SEFLAG2A=OFF THEN  /* ERROR MESSAGE NOT ISSUED?     */ 01433000
         L     @10,@PC00001                                        0589 01434000
         L     @08,TBLXSEGT(,@10)                                  0589 01435000
         L     @08,GTPBUFAD(,@08)                                  0589 01436000
         TM    SEFLAG2A(@08),B'10000000'                           0589 01437000
         BNZ   @RF00589                                            0589 01438000
*               DO;                 /* YES,                          */ 01439000
*                                                                  0590 01440000
*                 /***************************************************/ 01441000
*                 /*                                                 */ 01442000
*                 /* ISSUE MESSAGE 'HMA245I SYSMOD XXXXXXX SELECTED  */ 01443000
*                 /* FOR RESTORE IS NOT APPLIED                      */ 01444000
*                 /*                                                 */ 01445000
*                 /***************************************************/ 01446000
*                                                                  0591 01447000
*                 DO;               /* HMASMPMG M1(HMA245I)M2(PART007   01448000
*                                      )TYPE(ERR)VAR(SESMDNO,TBLXFUNC   01449000
*                                      ,CCADSIDA(IOPCDS))TARGET(SYSOU   01450000
*                                      T,LOG)                        */ 01451000
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/ 01452000
         XC    HMASMMGP(28),HMASMMGP                               0592 01453000
*                   MGPMGNO1=HMA245I;/* SET UP MSG 1 CODE            */ 01454000
         MVC   MGPMGNO1(2),@CH01237                                0593 01455000
*                   MGPMGNO2=PART007;/* SET UP MSG 2 CODE            */ 01456000
         MVC   MGPMGNO2(2),@CH00065                                0594 01457000
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */ 01458000
         MVI   MGPTYPE,X'03'                                       0595 01459000
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */ 01460000
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */ 01461000
         OI    MGPPRINT,B'10010000'                                0597 01462000
*                   MGPVARPT(1)=ADDR(SESMDNO);/* SET VARIABLE PTR    */ 01463000
         LA    @08,SESMDNO(,@08)                                   0598 01464000
         ST    @08,MGPVARPT                                        0598 01465000
*                   MGPVARPT(2)=ADDR(TBLXFUNC);/* SET VARIABLE PTR   */ 01466000
         LA    @10,TBLXFUNC(,@10)                                  0599 01467000
         ST    @10,MGPVARPT+4                                      0599 01468000
*                   MGPVARPT(3)=ADDR(CCADSIDA(IOPCDS));/* SET      0600 01469000
*                                      VARIABLE PTR                  */ 01470000
         L     @10,CCADSAD(,CCAPTR)                                0600 01471000
         LA    @10,CCADSIDA+8(,@10)                                0600 01472000
         ST    @10,MGPVARPT+8                                      0600 01473000
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */ 01474000
         L     @15,@CV01229                                        0601 01475000
         LA    @01,@AL00601                                        0601 01476000
         BALR  @14,@15                                             0601 01477000
*                 END;              /*                               */ 01478000
*                 SELCHKRC=STOPSMD; /* SET THE RETURN CODE           */ 01479000
         LA    SELCHKRC,8                                          0603 01480000
*               END;                                               0604 01481000
*             ELSE                                                 0605 01482000
*               ;                   /* ERROR MESSAGE ALREADY ISSUED  */ 01483000
@RF00589 DS    0H                                                  0606 01484000
*           END;                                                   0606 01485000
*       END;                                                       0607 01486000
@RC00581 DS    0H                                                  0608 01487000
*   END;                            /* END OF SELECT LIST PROCESSING */ 01488000
@RC00572 DS    0H                                                  0608 01489000
@DE00570 TM    SELCEOF,B'10000000'                                 0608 01490000
         BNZ   @DC00570                                            0608 01491000
         CH    SELCHKRC,@CH00033                                   0608 01492000
         BL    @DL00570                                            0608 01493000
@DC00570 DS    0H                                                  0609 01494000
*   RETURN CODE(SELCHKRC);          /* RETURN W/ RC                  */ 01495000
         LR    @15,SELCHKRC                                        0609 01496000
         L     @14,@SA00009                                        0609 01497000
         LM    @00,@12,@SA00009+8                                  0609 01498000
         BR    @14                                                 0609 01499000
*   RFY                                                            0610 01500000
*     HMASMGTP BASED;                                              0610 01501000
*   RFY                                                            0611 01502000
*     HMASMSET BASED;                                              0611 01503000
*   RFY                                                            0612 01504000
*     TSLPARMS BASED;                                              0612 01505000
*   END SELCHK;                                                    0613 01506000
*                                                                  0614 01507000
*   /*****************************************************************/ 01508000
*   /*                                                               */ 01509000
*   /* SMDICT                                                        */ 01510000
*   /*                                                               */ 01511000
*   /*****************************************************************/ 01512000
*                                                                  0614 01513000
*SMDICT:                                                           0614 01514000
*   PROC(SMDIIOP);                                                 0614 01515000
SMDICT   STM   @14,@12,@SA00010                                    0614 01516000
         MVC   @PC00010(4),0(@01)                                  0614 01517000
*   DCL                                                            0615 01518000
*     SMDIIOP CHAR(*);              /* EXTENDED IOP WITH DIR. ENTRY     01519000
*                                      FOR SYSMOD                    */ 01520000
*   DCL                                                            0616 01521000
*     SMDICTRC FIXED(15);           /* RETURN CODE                   */ 01522000
*   DCL                                                            0617 01523000
*     SMDICT@ PTR(31);              /* ADDRESS OF THE CURRENT ICT  0617 01524000
*                                      ENTRY                         */ 01525000
*   DCL                                                            0618 01526000
*     1 SMDIFLGS,                   /* LOCAL FLAGS                   */ 01527000
*      2 SRELFND BIT(1),            /* SREL IOP SUB-ENTRY FOUND      */ 01528000
*      2 * BIT(7);                  /* UNUSED                        */ 01529000
*   DCL                                                            0619 01530000
*     SMDTYPE CHAR(1) CONSTANT('P');/* ICT ENTRY TYPE IS SYSMOD      */ 01531000
*   RFY                                                            0620 01532000
*     HMASMIOP BASED(ADDR(SMDIIOP));/* EXTENDED IOP                  */ 01533000
*   SMDICTRC=ZERO;                  /* CLEAR RETURN CODE             */ 01534000
*                                                                  0621 01535000
         SLR   SMDICTRC,SMDICTRC                                   0621 01536000
*   /*****************************************************************/ 01537000
*   /*                                                               */ 01538000
*   /* INITIALIZE AN ICT ENTRY                                       */ 01539000
*   /*                                                               */ 01540000
*   /*****************************************************************/ 01541000
*                                                                  0622 01542000
*   SMDICT@=TBLXTOP;                /* PTR TO SYSMOD ENTRY TO BE   0622 01543000
*                                      CREATED                       */ 01544000
         L     @10,@PC00001                                        0622 01545000
         MVC   SMDICT@(4),TBLXTOP(@10)                             0622 01546000
*   CALL HMASMTAD(TBLXPARM,SMDTYPE,IOPNAM17);                      0623 01547000
         ST    @10,@AL00001                                        0623 01548000
         LA    @10,@CC01388                                        0623 01549000
         ST    @10,@AL00001+4                                      0623 01550000
         L     @10,@PC00010                                        0623 01551000
         LA    @10,IOPNAM17(,@10)                                  0623 01552000
         ST    @10,@AL00001+8                                      0623 01553000
         L     @15,@CV01230                                        0623 01554000
         LA    @01,@AL00001                                        0623 01555000
         BALR  @14,@15                                             0623 01556000
*   ;                                                              0624 01557000
*                                                                  0624 01558000
*   /*****************************************************************/ 01559000
*   /*                                                               */ 01560000
*   /* GET THE EXTENDED IOP ENTRY FROM THE CDS                       */ 01561000
*   /*                                                               */ 01562000
*   /*****************************************************************/ 01563000
*                                                                  0625 01564000
*   IOPFUNCT=IOPXTND;               /* GET EXTENDED PORTION OF SYSMOD*/ 01565000
         L     @10,@PC00010                                        0625 01566000
         MVI   IOPFUNCT(@10),X'07'                                 0625 01567000
*   CALL HMASMIO(HMASMIOP);                                        0626 01568000
         ST    @10,@AL00001                                        0626 01569000
         L     @15,@CV01228                                        0626 01570000
         LA    @01,@AL00001                                        0626 01571000
         BALR  @14,@15                                             0626 01572000
*   IF IOPRETRN>ZERO THEN           /* ALL IS WELL?                  */ 01573000
         L     @10,@PC00010                                        0627 01574000
         CLI   IOPRETRN(@10),0                                     0627 01575000
         BNH   @RF00627                                            0627 01576000
*     DO;                           /* NO,                           */ 01577000
*       SMDICTRC=MAX(SMDICTRC,IOPRETRN);/* SET RETURN CODE           */ 01578000
         SLR   @08,@08                                             0629 01579000
         IC    @08,IOPRETRN(,@10)                                  0629 01580000
         CR    SMDICTRC,@08                                        0629 01581000
         BNL   *+6                                                      01582000
         LR    SMDICTRC,@08                                        0629 01583000
*     END;                                                         0630 01584000
*   ELSE                            /* IO WAS SUCCESSFUL             */ 01585000
*     DO;                           /*                               */ 01586000
         B     @RC00627                                            0631 01587000
@RF00627 DS    0H                                                  0632 01588000
*       IF SMDICTRC=ZERO THEN       /* NO ERROR?                     */ 01589000
         LTR   SMDICTRC,SMDICTRC                                   0632 01590000
         BNZ   @RF00632                                            0632 01591000
*         DO;                       /* YES,                          */ 01592000
*                                                                  0633 01593000
*           /*********************************************************/ 01594000
*           /*                                                       */ 01595000
*           /* BUILD THE SYMOD ENTRY BY CALLING HMASMTEC             */ 01596000
*           /*                                                       */ 01597000
*           /*********************************************************/ 01598000
*                                                                  0634 01599000
*           CALL HMASMTEC(TBLXPARM,SMDICT@,HMASMIOP,/*               */ 01600000
*               ZERO);              /* NO ++VER NUMBER BEING SUPPLIED*/ 01601000
         L     @10,@PC00001                                        0634 01602000
         ST    @10,@AL00001                                        0634 01603000
         LA    @10,SMDICT@                                         0634 01604000
         ST    @10,@AL00001+4                                      0634 01605000
         L     @10,@PC00010                                        0634 01606000
         ST    @10,@AL00001+8                                      0634 01607000
         LA    @10,@CF00081                                        0634 01608000
         ST    @10,@AL00001+12                                     0634 01609000
         L     @15,@CV01231                                        0634 01610000
         LA    @01,@AL00001                                        0634 01611000
         BALR  @14,@15                                             0634 01612000
*           RFY                                                    0635 01613000
*             RTNCODE RSTD;                                        0635 01614000
*           SMDICTRC=MAX(SMDICTRC,RTNCODE);/* SAVE BUILD RETURN CODE */ 01615000
         CR    SMDICTRC,RTNCODE                                    0636 01616000
         BNL   *+6                                                      01617000
         LR    SMDICTRC,RTNCODE                                    0636 01618000
*           RFY                                                    0637 01619000
*             RTNCODE UNRSTD;                                      0637 01620000
*         END;                                                     0638 01621000
*     END;                                                         0639 01622000
@RF00632 DS    0H                                                  0640 01623000
*   RETURN CODE(SMDICTRC);                                         0640 01624000
@RC00627 LR    @15,SMDICTRC                                        0640 01625000
         L     @14,@SA00010                                        0640 01626000
         LM    @00,@12,@SA00010+8                                  0640 01627000
         BR    @14                                                 0640 01628000
*   RFY                                                            0641 01629000
*     HMASMIOP BASED;                                              0641 01630000
*   END SMDICT;                                                    0642 01631000
*                                                                  0643 01632000
*/********************************************************************/ 01633000
*/*                                                                  */ 01634000
*/* A SYSMOD WILL APPEAR IN THE DELTA 2 LIST IF                      */ 01635000
*/*   - THE SYSMOD APEARS IN THE ACDS BUT NOT THE CDS                */ 01636000
*/*   - THE SYSMOD APEARS IN THE ACDS AND IN THE CDS AS DELETE ????  */ 01637000
*/*   - THE SYSMOD APEARS IN THE ACDS AND IN THE CDS AS IN ERROR ????*/ 01638000
*/*                                                                  */ 01639000
*/* NOTE: IT IS ASSUMED THAT THE D2 GTP IS SETUP EXTERNALLY (HMASMTBL)  01640000
*                                                                    */ 01641000
*/********************************************************************/ 01642000
*                                                                  0643 01643000
*DELTA2BL:                                                         0643 01644000
*   PROC(DT2IOP);                   /* IOP CONTAINING ACDS DIRECTORY    01645000
*                                      ENTRY FOR SYSMOND             */ 01646000
DELTA2BL STM   @14,@12,@SA00011                                    0643 01647000
         MVC   @PC00011(4),0(@01)                                  0643 01648000
*   DCL                                                            0644 01649000
*     DT2IOP CHAR(*);               /* FIXED IOP W/ ACDS SYSMOD    0644 01650000
*                                      DIRIRECTORY ENTRY             */ 01651000
*   DCL                                                            0645 01652000
*     DT2RC FIXED(15);              /* RETURN CODE                   */ 01653000
*   RFY                                                            0646 01654000
*     HMASMIOP BASED(ADDR(DT2IOP));                                0646 01655000
*   RFY                                                            0647 01656000
*     HMASMGTP BASED(TBLXD2GT);                                    0647 01657000
*   RFY                                                            0648 01658000
*     D2RCRD BASED(GTPBUFAD);                                      0648 01659000
*   DT2RC=ZERO;                     /* CLEAR RETURN CODE             */ 01660000
         SLR   DT2RC,DT2RC                                         0649 01661000
*   D2RCRD=''B;                     /* CLEAR THE RECORD              */ 01662000
         L     @10,@PC00001                                        0650 01663000
         L     @10,TBLXD2GT(,@10)                                  0650 01664000
         L     @10,GTPBUFAD(,@10)                                  0650 01665000
         XC    D2RCRD(8,@10),D2RCRD(@10)                           0650 01666000
*   D2RSMD=IOPNAM17;                /* SYSMOD NAME                   */ 01667000
         L     @08,@PC00011                                        0651 01668000
         MVC   D2RSMD(7,@10),IOPNAM17(@08)                         0651 01669000
*   IF IOPERROR=ON THEN             /* SYSMOD IN ERROR?              */ 01670000
         TM    IOPERROR(@08),B'00010000'                           0652 01671000
         BNO   @RF00652                                            0652 01672000
*     DO;                           /* YES,                          */ 01673000
*       D2RFERR=ON;                 /* SET ERROR FLAG IN DELTA 2   0654 01674000
*                                      RECORD                        */ 01675000
         OI    D2RFERR(@10),B'01000000'                            0654 01676000
*     END;                                                         0655 01677000
*   ELSE                            /* NOT IN ERROR                  */ 01678000
*     DO;                                                          0656 01679000
         B     @RC00652                                            0656 01680000
@RF00652 DS    0H                                                  0657 01681000
*       IF IOPDBYP=ON THEN          /* SYSMOD DELETED                */ 01682000
         L     @10,@PC00011                                        0657 01683000
         TM    IOPDBYP(@10),B'01000000'                            0657 01684000
         BNO   @RF00657                                            0657 01685000
*         DO;                       /* YES,                          */ 01686000
*           D2RFDEL=ON;             /* SET DELETE FLAG IN DELTA 2  0659 01687000
*                                      RECORD                        */ 01688000
         L     @10,@PC00001                                        0659 01689000
         L     @10,TBLXD2GT(,@10)                                  0659 01690000
         L     @10,GTPBUFAD(,@10)                                  0659 01691000
         OI    D2RFDEL(@10),B'00100000'                            0659 01692000
*         END;                                                     0660 01693000
*       ELSE                        /* NOT DELETED                   */ 01694000
*         DO;                                                      0661 01695000
         B     @RC00657                                            0661 01696000
@RF00657 DS    0H                                                  0662 01697000
*           D2RFOK=ON;              /* SET OK FLAG IN DELTA 2 RECORD */ 01698000
         L     @10,@PC00001                                        0662 01699000
         L     @10,TBLXD2GT(,@10)                                  0662 01700000
         L     @10,GTPBUFAD(,@10)                                  0662 01701000
         OI    D2RFOK(@10),B'10000000'                             0662 01702000
*         END;                                                     0663 01703000
*     END;                          /*                               */ 01704000
@RC00657 DS    0H                                                  0665 01705000
*   GTPFUNCT=GTPADD;                /* ADD THE RECORD                */ 01706000
@RC00652 L     @10,@PC00001                                        0665 01707000
         L     @10,TBLXD2GT(,@10)                                  0665 01708000
         MVI   GTPFUNCT(@10),X'04'                                 0665 01709000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 01710000
         ST    @10,@AL00001                                        0666 01711000
         L     @15,@CV01233                                        0666 01712000
         LA    @01,@AL00001                                        0666 01713000
         BALR  @14,@15                                             0666 01714000
*   DT2RC=MAX(DT2RC,GTPRETRN);      /* SAVE THE RETURN CODE          */ 01715000
         L     @10,@PC00001                                        0667 01716000
         L     @10,TBLXD2GT(,@10)                                  0667 01717000
         SLR   @08,@08                                             0667 01718000
         IC    @08,GTPRETRN(,@10)                                  0667 01719000
         CR    DT2RC,@08                                           0667 01720000
         BNL   *+6                                                      01721000
         LR    DT2RC,@08                                           0667 01722000
*   RETURN CODE(DT2RC);                                            0668 01723000
         LR    @15,DT2RC                                           0668 01724000
         L     @14,@SA00011                                        0668 01725000
         LM    @00,@12,@SA00011+8                                  0668 01726000
         BR    @14                                                 0668 01727000
*   RFY                                                            0669 01728000
*     HMASMIOP BASED;                                              0669 01729000
*   RFY                                                            0670 01730000
*     HMASMGTP BASED;                                              0670 01731000
*   RFY                                                            0671 01732000
*     D2RCRD BASED;                                                0671 01733000
*   END DELTA2BL;                                                  0672 01734000
*                                                                  0673 01735000
*/********************************************************************/ 01736000
*/*                                                                  */ 01737000
*/* GROUP - ADD CANDIDATES TO ICT FOR GROUP PROCESSING               */ 01738000
*/*                                                                  */ 01739000
*/* INPUT:                                                           */ 01740000
*/*         - ICT PTF SECTION CONTAINING ALL SYSMODS THAT MAY BE     */ 01741000
*/*           RESTORED.  IN ADDITION, SYSMODS IN THE CANDIDATE LIST  */ 01742000
*/*           WILL BE MARKED AS CANDIDATES                           */ 01743000
*/* OUTPUT:                                                          */ 01744000
*/*         - ICT PTF SECTION SYSMOD CANDIDATE FLAG.  THE CANDIDATE  */ 01745000
*/*           WILL BE SET FOR ANY SYSMOD THAT MEETS ONE OF THE       */ 01746000
*/*           FOLLOWING:                                             */ 01747000
*/*             1) FMID'S A CANDIDATE                                */ 01748000
*/*             2) REQ'S                                             */ 01749000
*/*                - IS A REQ OF A CANDIDATE SYSMOD                  */ 01750000
*/*                - REQ'S A CANDIDATE SYSMOD                        */ 01751000
*/*             3) IFREQ'S                                           */ 01752000
*/*                - IS AN IFREQ OF A CANDIDATE SYSMOD               */ 01753000
*/*                - IFREQ'S A CANDIDATE SYSMOD                      */ 01754000
*/*             4) PRE'S A CANDIDATE SYSMOD                          */ 01755000
*/*             5) SUP'S A CANDIDATE SYSMOD                          */ 01756000
*/*                                                                  */ 01757000
*/********************************************************************/ 01758000
*                                                                  0673 01759000
*GROUP:                                                            0673 01760000
*   PROC;                                                          0673 01761000
GROUP    STM   @14,@12,@SA00012                                    0673 01762000
*   DCL                                                            0674 01763000
*     GRPRC FIXED(15);              /* LOCAL RETURN CODE             */ 01764000
*   DCL                                                            0675 01765000
*     GRPPTFX FIXED(31);            /* ICT PTF ENTRY INDEX COUNTER   */ 01766000
*   DCL                                                            0676 01767000
*     GRPX2 FIXED(31);              /* 2ND ICT PTF ENTRY INDEX     0676 01768000
*                                      COUNTER                       */ 01769000
*   DCL                                                            0677 01770000
*     1 GRPFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */ 01771000
*       3 GRPADD BIT(1),            /* ONE OR MORE CANDIDATES WAS  0677 01772000
*                                      ADDED TO THE ICT              */ 01773000
*       3 * BIT(7);                 /* UNUSED                        */ 01774000
*   RFY                                                            0678 01775000
*     ICTPTF BASED(CCAICPTF);                                      0678 01776000
*   GRPRC=ZERO;                     /* CLEAR RETURN CODE             */ 01777000
         SLR   GRPRC,GRPRC                                         0679 01778000
*   GRPFLAGS=''B;                   /* CLEAR LOCAL FLAGS             */ 01779000
         MVI   GRPFLAGS,X'00'                                      0680 01780000
*                                                                  0681 01781000
*   /*****************************************************************/ 01782000
*   /*                                                               */ 01783000
*   /* ADD REQUISITS AS CANDIDATES ALL ENTRIES IN ICT ARE REPROCESSED*/ 01784000
*   /* UNTIL NO CHANGE OCCURS                                        */ 01785000
*   /*                                                               */ 01786000
*   /*****************************************************************/ 01787000
*                                                                  0681 01788000
*   GRPADD=ON;                      /* INIT SO THAT ATLEAS ONE PASS     01789000
*                                      IS MADE THRU ICT              */ 01790000
         OI    GRPADD,B'10000000'                                  0681 01791000
*   DO WHILE(GRPADD=ON&             /* PROCESS UNTIL NO NEW ENTRY IS    01792000
*                                      ADDED                         */ 01793000
*         GRPRC<STOPFUNC);                                         0682 01794000
         B     @DE00682                                            0682 01795000
@DL00682 DS    0H                                                  0683 01796000
*     GRPADD=OFF;                   /* ASSUME NONE ADDED             */ 01797000
*                                                                  0683 01798000
         NI    GRPADD,B'01111111'                                  0683 01799000
*     /***************************************************************/ 01800000
*     /*                                                             */ 01801000
*     /* MARK SYSMODS WHICH FMID A SYSMOD IN THE SELECT LIST AS A    */ 01802000
*     /* CANDIDATE                                                   */ 01803000
*     /*                                                             */ 01804000
*     /***************************************************************/ 01805000
*                                                                  0684 01806000
*     DO GRPPTFX=1 BY 1             /*                               */ 01807000
*           WHILE(ICTPEND(GRPPTFX)^=ICTENDNT/*                       */ 01808000
*           &GRPRC<STOPFUNC);                                      0684 01809000
         LA    GRPPTFX,1                                           0684 01810000
         B     @DE00684                                            0684 01811000
@DL00684 DS    0H                                                  0685 01812000
*       IF ICTPTYPE(GRPPTFX)=IOPPFUNC/* FUNCTION SYSMOD ...          */ 01813000
*           &ICTPRCND(GRPPTFX)=ON THEN/* ... AND A CANDIDATE?        */ 01814000
         LR    @10,GRPPTFX                                         0685 01815000
         MH    @10,@CH01508                                        0685 01816000
         L     @08,CCAICPTF(,CCAPTR)                               0685 01817000
         LA    @05,0(@10,@08)                                      0685 01818000
         AL    @05,@CF01531                                        0685 01819000
         SLR   @02,@02                                             0685 01820000
         IC    @02,ICTPTYPE-17(,@05)                               0685 01821000
         CH    @02,@CH00037                                        0685 01822000
         BNE   @RF00685                                            0685 01823000
         ALR   @08,@10                                             0685 01824000
         AL    @08,@CF01532                                        0685 01825000
         TM    ICTPRCND-12(@08),B'00010000'                        0685 01826000
         BNO   @RF00685                                            0685 01827000
*         DO;                       /* YES,                          */ 01828000
*           DO GRPX2=1 BY 1         /* CHECK ALL SYSMODS IN THE ICT  */ 01829000
*                 WHILE(ICTPEND(GRPX2)^=ICTENDNT/*                   */ 01830000
*                 &GRPRC<STOPFUNC);                                0687 01831000
         LA    GRPX2,1                                             0687 01832000
         B     @DE00687                                            0687 01833000
@DL00687 DS    0H                                                  0688 01834000
*             IF ICTPFMID(GRPX2)=ICTPTFS(GRPPTFX)/* FMID'S CURRENT 0688 01835000
*                                      FUNC                          */ 01836000
*                 &GRPX2^=GRPPTFX THEN/* ... AND NOT SAME SYSMOD?    */ 01837000
         LA    @10,116                                             0688 01838000
         LR    @01,GRPX2                                           0688 01839000
         MR    @00,@10                                             0688 01840000
         L     @08,CCAICPTF(,CCAPTR)                               0688 01841000
         LR    @07,@10                                             0688 01842000
         MR    @06,GRPPTFX                                         0688 01843000
         ST    @01,@TF00001                                        0688 01844000
         ALR   @01,@08                                             0688 01845000
         AL    @01,@CF01533                                        0688 01846000
         ALR   @07,@08                                             0688 01847000
         AL    @07,@CF01534                                        0688 01848000
         CLC   ICTPFMID-22(7,@01),ICTPTFS(@07)                     0688 01849000
         BNE   @RF00688                                            0688 01850000
         CR    GRPX2,GRPPTFX                                       0688 01851000
         BE    @RF00688                                            0688 01852000
*               DO;                 /* YES,                          */ 01853000
*                 IF ICTPRCND(GRPX2)^=ON THEN/* NOT CANDIDATE?       */ 01854000
         LR    @10,@08                                             0690 01855000
         AL    @10,@TF00001                                        0690 01856000
         AL    @10,@CF01532                                        0690 01857000
         TM    ICTPRCND-12(@10),B'00010000'                        0690 01858000
         BO    @RF00690                                            0690 01859000
*                   DO;             /* YES,                          */ 01860000
*                     ICTPRCND(GRPX2)=ON;/* MARK AS CANDIDATE        */ 01861000
         AL    @08,@TF00001                                        0692 01862000
         AL    @08,@CF01532                                        0692 01863000
         OI    ICTPRCND-12(@08),B'00010000'                        0692 01864000
*                     GRPADD=ON;    /* SYSMOD GROUP MEMBER ADDED     */ 01865000
         OI    GRPADD,B'10000000'                                  0693 01866000
*                   END;                                           0694 01867000
*                 ELSE                                             0695 01868000
*                   ;               /* ALREADY A CANDIDATE           */ 01869000
@RF00690 DS    0H                                                  0696 01870000
*               END;                                               0696 01871000
*           END;                                                   0697 01872000
@RF00688 AH    GRPX2,@CH00063                                      0697 01873000
@DE00687 LR    @10,GRPX2                                           0697 01874000
         MH    @10,@CH01508                                        0697 01875000
         L     @08,CCAICPTF(,CCAPTR)                               0697 01876000
         AL    @08,@CF01534                                        0697 01877000
         L     @10,ICTPEND(@10,@08)                                0697 01878000
         CL    @10,ICTENDNT                                        0697 01879000
         BE    @DC00687                                            0697 01880000
         CH    GRPRC,@CH00033                                      0697 01881000
         BL    @DL00687                                            0697 01882000
@DC00687 DS    0H                                                  0698 01883000
*         END;                                                     0698 01884000
*       ELSE                                                       0699 01885000
*         ;                         /* NOT A CANDIDATE FUNCTION    0699 01886000
*                                      SYSMOD                        */ 01887000
@RF00685 DS    0H                                                  0700 01888000
*     END;                                                         0700 01889000
         AH    GRPPTFX,@CH00063                                    0700 01890000
@DE00684 LR    @10,GRPPTFX                                         0700 01891000
         MH    @10,@CH01508                                        0700 01892000
         L     @08,CCAICPTF(,CCAPTR)                               0700 01893000
         AL    @08,@CF01534                                        0700 01894000
         L     @10,ICTPEND(@10,@08)                                0700 01895000
         CL    @10,ICTENDNT                                        0700 01896000
         BE    @DC00684                                            0700 01897000
         CH    GRPRC,@CH00033                                      0700 01898000
         BL    @DL00684                                            0700 01899000
@DC00684 DS    0H                                                  0701 01900000
*     DO GRPPTFX=1 BY 1 WHILE(ICTPEND(GRPPTFX)^=ICTENDNT/*           */ 01901000
*           &GRPRC<STOPFUNC);                                      0701 01902000
         LA    GRPPTFX,1                                           0701 01903000
         B     @DE00701                                            0701 01904000
@DL00701 DS    0H                                                  0702 01905000
*       IF ICTPRCND(GRPPTFX)=ON THEN/* ... AND A CANDIDATE?          */ 01906000
         LR    @10,GRPPTFX                                         0702 01907000
         MH    @10,@CH01508                                        0702 01908000
         L     @08,CCAICPTF(,CCAPTR)                               0702 01909000
         ST    @10,@TF00001                                        0702 01910000
         ALR   @10,@08                                             0702 01911000
         AL    @10,@CF01532                                        0702 01912000
         TM    ICTPRCND-12(@10),B'00010000'                        0702 01913000
         BNO   @RF00702                                            0702 01914000
*         DO;                       /* YES,                          */ 01915000
*                                                                  0703 01916000
*           /*********************************************************/ 01917000
*           /*                                                       */ 01918000
*           /* MARK REQ'ED SYSMODS AS CANDIDATES                     */ 01919000
*           /*                                                       */ 01920000
*           /*********************************************************/ 01921000
*                                                                  0704 01922000
*           CALL SETCAND(ICTPRCHN(GRPPTFX),TPRREQI);               0704 01923000
         L     @10,@TF00001                                        0704 01924000
         AL    @08,@CF01535                                        0704 01925000
         LA    @10,ICTPRCHN-68(@10,@08)                            0704 01926000
         ST    @10,@AL00001                                        0704 01927000
         LA    @10,@CF00063                                        0704 01928000
         ST    @10,@AL00001+4                                      0704 01929000
         LA    @01,@AL00001                                        0704 01930000
         BAL   @14,SETCAND                                         0704 01931000
*           RFY                                                    0705 01932000
*             RTNCODE RSTD;                                        0705 01933000
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */ 01934000
         LTR   RTNCODE,RTNCODE                                     0706 01935000
         BNZ   @RF00706                                            0706 01936000
*             DO;                   /* YES,                          */ 01937000
*               RFY                                                0708 01938000
*                 RTNCODE UNRSTD;                                  0708 01939000
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */ 01940000
         OI    GRPADD,B'10000000'                                  0709 01941000
*             END;                                                 0710 01942000
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */ 01943000
*               ADDR(ICTPRCHN(1))-ADDR(ICTPTF(1)));                0711 01944000
@RF00706 LR    @10,GRPPTFX                                         0711 01945000
         MH    @10,@CH01508                                        0711 01946000
         L     @08,CCAICPTF(,CCAPTR)                               0711 01947000
         AL    @10,@CF01534                                        0711 01948000
         LA    @10,ICTPTF(@10,@08)                                 0711 01949000
         ST    @10,@AL00001                                        0711 01950000
         LA    @10,ICTPRCHN(,@08)                                  0711 01951000
         SLR   @10,@08                                             0711 01952000
         ST    @10,@AFTEMPS                                        0711 01953000
         LA    @10,@AFTEMPS                                        0711 01954000
         ST    @10,@AL00001+4                                      0711 01955000
         LA    @01,@AL00001                                        0711 01956000
         BAL   @14,SETCAND2                                        0711 01957000
*           RFY                                                    0712 01958000
*             RTNCODE RSTD;                                        0712 01959000
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */ 01960000
         LTR   RTNCODE,RTNCODE                                     0713 01961000
         BNZ   @RF00713                                            0713 01962000
*             DO;                   /* YES,                          */ 01963000
*               RFY                                                0715 01964000
*                 RTNCODE UNRSTD;                                  0715 01965000
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */ 01966000
         OI    GRPADD,B'10000000'                                  0716 01967000
*             END;                                                 0717 01968000
*                                                                  0717 01969000
*           /*********************************************************/ 01970000
*           /*                                                       */ 01971000
*           /* MARK IF REQ'ED SYSMODS AS CANDIDATES                  */ 01972000
*           /*                                                       */ 01973000
*           /*********************************************************/ 01974000
*                                                                  0718 01975000
*           CALL SETCAND(ICTPICHN(GRPPTFX),TPRIRQI);               0718 01976000
@RF00713 LR    @10,GRPPTFX                                         0718 01977000
         MH    @10,@CH01508                                        0718 01978000
         L     @08,CCAICPTF(,CCAPTR)                               0718 01979000
         AL    @08,@CF01536                                        0718 01980000
         LA    @10,ICTPICHN-80(@10,@08)                            0718 01981000
         ST    @10,@AL00001                                        0718 01982000
         LA    @10,@CF00273                                        0718 01983000
         ST    @10,@AL00001+4                                      0718 01984000
         LA    @01,@AL00001                                        0718 01985000
         BAL   @14,SETCAND                                         0718 01986000
*           RFY                                                    0719 01987000
*             RTNCODE RSTD;                                        0719 01988000
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */ 01989000
         LTR   RTNCODE,RTNCODE                                     0720 01990000
         BNZ   @RF00720                                            0720 01991000
*             DO;                   /* YES,                          */ 01992000
*               RFY                                                0722 01993000
*                 RTNCODE UNRSTD;                                  0722 01994000
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */ 01995000
         OI    GRPADD,B'10000000'                                  0723 01996000
*             END;                                                 0724 01997000
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */ 01998000
*               ADDR(ICTPICHN(1))-ADDR(ICTPTF(1)));                0725 01999000
@RF00720 LR    @10,GRPPTFX                                         0725 02000000
         MH    @10,@CH01508                                        0725 02001000
         L     @08,CCAICPTF(,CCAPTR)                               0725 02002000
         AL    @10,@CF01534                                        0725 02003000
         LA    @10,ICTPTF(@10,@08)                                 0725 02004000
         ST    @10,@AL00001                                        0725 02005000
         LA    @10,ICTPICHN(,@08)                                  0725 02006000
         SLR   @10,@08                                             0725 02007000
         ST    @10,@AFTEMPS                                        0725 02008000
         LA    @10,@AFTEMPS                                        0725 02009000
         ST    @10,@AL00001+4                                      0725 02010000
         LA    @01,@AL00001                                        0725 02011000
         BAL   @14,SETCAND2                                        0725 02012000
*           RFY                                                    0726 02013000
*             RTNCODE RSTD;                                        0726 02014000
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */ 02015000
         LTR   RTNCODE,RTNCODE                                     0727 02016000
         BNZ   @RF00727                                            0727 02017000
*             DO;                   /* YES,                          */ 02018000
*               RFY                                                0729 02019000
*                 RTNCODE UNRSTD;                                  0729 02020000
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */ 02021000
         OI    GRPADD,B'10000000'                                  0730 02022000
*             END;                                                 0731 02023000
*                                                                  0731 02024000
*           /*********************************************************/ 02025000
*           /*                                                       */ 02026000
*           /* MARK PREBY SYSMODS AS CANDIDATES                      */ 02027000
*           /*                                                       */ 02028000
*           /*********************************************************/ 02029000
*                                                                  0732 02030000
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */ 02031000
*               ADDR(ICTPPCHN(1))-ADDR(ICTPTF(1)));                0732 02032000
@RF00727 LR    @10,GRPPTFX                                         0732 02033000
         MH    @10,@CH01508                                        0732 02034000
         L     @08,CCAICPTF(,CCAPTR)                               0732 02035000
         AL    @10,@CF01534                                        0732 02036000
         LA    @10,ICTPTF(@10,@08)                                 0732 02037000
         ST    @10,@AL00001                                        0732 02038000
         LA    @10,ICTPPCHN(,@08)                                  0732 02039000
         SLR   @10,@08                                             0732 02040000
         ST    @10,@AFTEMPS                                        0732 02041000
         LA    @10,@AFTEMPS                                        0732 02042000
         ST    @10,@AL00001+4                                      0732 02043000
         LA    @01,@AL00001                                        0732 02044000
         BAL   @14,SETCAND2                                        0732 02045000
*           RFY                                                    0733 02046000
*             RTNCODE RSTD;                                        0733 02047000
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */ 02048000
         LTR   RTNCODE,RTNCODE                                     0734 02049000
         BNZ   @RF00734                                            0734 02050000
*             DO;                   /* YES,                          */ 02051000
*               RFY                                                0736 02052000
*                 RTNCODE UNRSTD;                                  0736 02053000
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */ 02054000
         OI    GRPADD,B'10000000'                                  0737 02055000
*             END;                                                 0738 02056000
*                                                                  0738 02057000
*           /*********************************************************/ 02058000
*           /*                                                       */ 02059000
*           /* MARK SUP'ING SYSMODS AS CANDIDATES                    */ 02060000
*           /*                                                       */ 02061000
*           /*********************************************************/ 02062000
*                                                                  0739 02063000
*           CALL SETCAND2(ICTPTF(GRPPTFX),/*                         */ 02064000
*               ADDR(ICTPSCHN(1))-ADDR(ICTPTF(1)));                0739 02065000
@RF00734 LR    @10,GRPPTFX                                         0739 02066000
         MH    @10,@CH01508                                        0739 02067000
         L     @08,CCAICPTF(,CCAPTR)                               0739 02068000
         AL    @10,@CF01534                                        0739 02069000
         LA    @10,ICTPTF(@10,@08)                                 0739 02070000
         ST    @10,@AL00001                                        0739 02071000
         LA    @10,ICTPSCHN(,@08)                                  0739 02072000
         SLR   @10,@08                                             0739 02073000
         ST    @10,@AFTEMPS                                        0739 02074000
         LA    @10,@AFTEMPS                                        0739 02075000
         ST    @10,@AL00001+4                                      0739 02076000
         LA    @01,@AL00001                                        0739 02077000
         BAL   @14,SETCAND2                                        0739 02078000
*           RFY                                                    0740 02079000
*             RTNCODE RSTD;                                        0740 02080000
*           IF RTNCODE=ZERO THEN    /* CANDIDATE ADDED?              */ 02081000
         LTR   RTNCODE,RTNCODE                                     0741 02082000
         BNZ   @RF00741                                            0741 02083000
*             DO;                   /* YES,                          */ 02084000
*               RFY                                                0743 02085000
*                 RTNCODE UNRSTD;                                  0743 02086000
*               GRPADD=ON;          /* SYSMOD GROUP MEMBER ADDED     */ 02087000
         OI    GRPADD,B'10000000'                                  0744 02088000
*             END;                                                 0745 02089000
*         END;                                                     0746 02090000
*       ELSE                                                       0747 02091000
*         ;                         /* SYSMOD IS NOT A CANDIDATE,  0747 02092000
*                                      CONTINUE                      */ 02093000
@RF00702 DS    0H                                                  0748 02094000
*     END;                          /* END OF PROCESS ALL SYSMODS  0748 02095000
*                                      LOOP                          */ 02096000
@RC00702 AL    GRPPTFX,@CF00063                                    0748 02097000
@DE00701 LR    @10,GRPPTFX                                         0748 02098000
         MH    @10,@CH01508                                        0748 02099000
         L     @08,CCAICPTF(,CCAPTR)                               0748 02100000
         AL    @08,@CF01534                                        0748 02101000
         L     @10,ICTPEND(@10,@08)                                0748 02102000
         CL    @10,ICTENDNT                                        0748 02103000
         BE    @DC00701                                            0748 02104000
         CH    GRPRC,@CH00033                                      0748 02105000
         BL    @DL00701                                            0748 02106000
@DC00701 DS    0H                                                  0749 02107000
*   END;                            /* END OF ALL CHANGES            */ 02108000
@DE00682 TM    GRPADD,B'10000000'                                  0749 02109000
         BNO   @DC00682                                            0749 02110000
         CH    GRPRC,@CH00033                                      0749 02111000
         BL    @DL00682                                            0749 02112000
@DC00682 DS    0H                                                  0750 02113000
*   RETURN CODE(GRPRC);             /* RETURN W/ RC                  */ 02114000
         LR    @15,GRPRC                                           0750 02115000
         L     @14,@SA00012                                        0750 02116000
         LM    @00,@12,@SA00012+8                                  0750 02117000
         BR    @14                                                 0750 02118000
*   RFY                                                            0751 02119000
*     ICTPTF BASED(CCAICPTF);                                      0751 02120000
*                                                                  0752 02121000
*/********************************************************************/ 02122000
*/* SETCAND - MARK SYSMODS IN AN INDEX LIST AS CANDIDATES            */ 02123000
*/*                                                                  */ 02124000
*/* INPUT - INDEX LIST POINTER                                       */ 02125000
*/*                                                                  */ 02126000
*/* OUTPUT - EACH SYSMOD IN THE INDEX LIST WILL BE MARKED AS RESTORE */ 02127000
*/*       CANDIDATE IF IT IS FOUND IN THE ICT (ICTPRCND).            */ 02128000
*/*                                                                  */ 02129000
*/*       RC = 0 ONE OR MORE SYSMODS IN THE INDEX LIST WAS FOUND AND */ 02130000
*/*              WAS NOT ALREADY A CANDIDATE                         */ 02131000
*/*       RC = 4 NO SYSMOD IN THE INDEX LIST, OR                     */ 02132000
*/*              NO SYSMOD WAS FOUND IN THE ICT THAT WAS NOT ALREADY */ 02133000
*/*              A CANDIDATE                                         */ 02134000
*/*                                                                  */ 02135000
*/********************************************************************/ 02136000
*                                                                  0752 02137000
*SETCAND:                                                          0752 02138000
*   PROC(SETNDX@,                   /* PTR TO INDEX LIST TO BE     0752 02139000
*                                      PROCESSED                     */ 02140000
*       SETINCR);                   /* GROUP INCREAMENT              */ 02141000
SETCAND  STM   @14,@12,@SA00013                                    0752 02142000
         MVC   @PC00013(8),0(@01)                                  0752 02143000
*   DCL                                                            0753 02144000
*     SETNDX@ PTR(31);              /* CHAIN PTR FOR INDEX           */ 02145000
*   DCL                                                            0754 02146000
*     SETINCR FIXED(31);            /* INCREAMENT FOR SEARCH COUNTER    02147000
*                                      - USED SO THAT 8 AND 16 BYTE     02148000
*                                      ENTRIES CAN BE PROCESSED      */ 02149000
*   DCL                                                            0755 02150000
*     SETX FIXED(31);               /* ICT INDEX ENTRY INDEX         */ 02151000
*   DCL                                                            0756 02152000
*     SETRC FIXED(15);              /* LOCAL RETURN CODE             */ 02153000
*   DCL                                                            0757 02154000
*     SETNFND CONSTANT(4);          /* NOT ADDED RETURN CODE         */ 02155000
*   RFY                                                            0758 02156000
*     ICTENTLS BASED(SETNDX@);                                     0758 02157000
*   RFY                                                            0759 02158000
*     TSLPARMS BASED(TBLXTSLP);                                    0759 02159000
*   SETRC=SETNFND;                  /* ASSUME NO CANDIDATE ADDED     */ 02160000
         LA    SETRC,4                                             0760 02161000
*   DO SETX=1 BY SETINCR            /* PROCESS ALL INDEX LIST ENTRIES*/ 02162000
*         WHILE(ICTENTND(SETX)^=ICTENDIX/*                           */ 02163000
*         &SETRC<STOPFUNC);                                        0761 02164000
         LA    SETX,1                                              0761 02165000
         B     @DE00761                                            0761 02166000
@DL00761 DS    0H                                                  0762 02167000
*     TSLICTSR=''B;                 /* CLEAR TSB PARM LIST           */ 02168000
         L     @10,@PC00001                                        0762 02169000
         L     @10,TBLXTSLP(,@10)                                  0762 02170000
         L     @08,TSLPMLAD(,@10)                                  0762 02171000
         XC    TSLICTSR(14,@08),TSLICTSR(@08)                      0762 02172000
*     TSLFUNCT=TSLFISRH;            /* SEARCH ICT FOR SYSMOD NAMED IN   02173000
*                                      INDEX LIST OF CURRENT SYSMOD  */ 02174000
         MVI   TSLFUNCT(@10),X'01'                                 0763 02175000
*     TSLISMD=ICTENTNT(SETX);       /* ...                           */ 02176000
         LR    @15,SETX                                            0764 02177000
         SLA   @15,3                                               0764 02178000
         L     @14,@PC00013                                        0764 02179000
         L     @01,SETNDX@(,@14)                                   0764 02180000
         ALR   @01,@15                                             0764 02181000
         AL    @01,@CF01537                                        0764 02182000
         MVC   TSLISMD(7,@08),ICTENTNT(@01)                        0764 02183000
*     CALL HMASMTSB(TSLPARMS);      /* ...                           */ 02184000
         ST    @10,@AL00001                                        0765 02185000
         L     @15,@CV01232                                        0765 02186000
         LA    @01,@AL00001                                        0765 02187000
         BALR  @14,@15                                             0765 02188000
*     IF TSLRETRN=TSLGOOD THEN      /* SYSMOD FOUND?                 */ 02189000
         L     @10,@PC00001                                        0766 02190000
         L     @10,TBLXTSLP(,@10)                                  0766 02191000
         CLI   TSLRETRN(@10),0                                     0766 02192000
         BNE   @RF00766                                            0766 02193000
*       DO;                         /* YES,                          */ 02194000
*         IF TSLICTP->ICTPRCND(1)=ON THEN/* CANDIDATE ALREADY?       */ 02195000
         L     @10,TSLPMLAD(,@10)                                  0768 02196000
         L     @10,TSLICTP(,@10)                                   0768 02197000
         TM    ICTPRCND(@10),B'00010000'                           0768 02198000
         BNO   @RF00768                                            0768 02199000
*           DO;                     /* YES,                          */ 02200000
*             SETRC=MIN(SETRC,SETNFND);/*                            */ 02201000
         LA    @10,4                                               0770 02202000
         CR    SETRC,@10                                           0770 02203000
         BNH   *+6                                                      02204000
         LR    SETRC,@10                                           0770 02205000
*           END;                                                   0771 02206000
*         ELSE                      /* NOT A CANDIDATE YET           */ 02207000
*           DO;                     /*                               */ 02208000
         B     @RC00768                                            0772 02209000
@RF00768 DS    0H                                                  0773 02210000
*             TSLICTP->ICTPRCND(1)=ON;/* MARK AS CANDIDATE           */ 02211000
         L     @10,@PC00001                                        0773 02212000
         L     @10,TBLXTSLP(,@10)                                  0773 02213000
         L     @10,TSLPMLAD(,@10)                                  0773 02214000
         L     @10,TSLICTP(,@10)                                   0773 02215000
         OI    ICTPRCND(@10),B'00010000'                           0773 02216000
*             SETRC=ZERO;           /* CANDIDATE ADDED RC            */ 02217000
         SLR   SETRC,SETRC                                         0774 02218000
*           END;                                                   0775 02219000
*       END;                                                       0776 02220000
*     ELSE                          /* ENTRY NOT FOUND               */ 02221000
*       DO;                         /*                               */ 02222000
         B     @RC00766                                            0777 02223000
@RF00766 DS    0H                                                  0778 02224000
*         SETRC=MIN(SETRC,TSLRETRN);/* RC = 4 IF NO ENTRY EVER FOUND    02225000
*                                      OR 0 IF ONE OR MORE IS FOUND     02226000
*                                      IN ICT                        */ 02227000
         L     @10,@PC00001                                        0778 02228000
         L     @10,TBLXTSLP(,@10)                                  0778 02229000
         SLR   @08,@08                                             0778 02230000
         IC    @08,TSLRETRN(,@10)                                  0778 02231000
         CR    SETRC,@08                                           0778 02232000
         BNH   *+6                                                      02233000
         LR    SETRC,@08                                           0778 02234000
*       END;                                                       0779 02235000
*   END;                                                           0780 02236000
@RC00766 L     @10,@PC00013+4                                      0780 02237000
         AL    SETX,SETINCR(,@10)                                  0780 02238000
@DE00761 LR    @10,SETX                                            0780 02239000
         SLA   @10,3                                               0780 02240000
         L     @08,@PC00013                                        0780 02241000
         L     @08,SETNDX@(,@08)                                   0780 02242000
         AL    @08,@CF01537                                        0780 02243000
         L     @10,ICTENTND(@10,@08)                               0780 02244000
         CL    @10,ICTENDIX                                        0780 02245000
         BE    @DC00761                                            0780 02246000
         CH    SETRC,@CH00033                                      0780 02247000
         BL    @DL00761                                            0780 02248000
@DC00761 DS    0H                                                  0781 02249000
*   RETURN CODE(SETRC);             /* RETURN W/RC                   */ 02250000
         LR    @15,SETRC                                           0781 02251000
         L     @14,@SA00013                                        0781 02252000
         LM    @00,@12,@SA00013+8                                  0781 02253000
         BR    @14                                                 0781 02254000
*   RFY                                                            0782 02255000
*     ICTENTLS BASED;                                              0782 02256000
*   RFY                                                            0783 02257000
*     TSLPARMS BASED;                                              0783 02258000
*   END SETCAND;                                                   0784 02259000
*                                                                  0785 02260000
*/********************************************************************/ 02261000
*/* SETCAND2 - MARK SYSMOD THAT REFERENCE THE CURRENT SYSMOD IN THE  */ 02262000
*/*            SPECIFIED INDEX LIST AS A CANDIDATE                   */ 02263000
*/*                                                                  */ 02264000
*/* INPUT - CURRENT SYSMOD ICT ENTRY                                 */ 02265000
*/*       - INDEX LIST OFFSET                                        */ 02266000
*/*                                                                  */ 02267000
*/* OUTPUT - EACH SYSMOD IN THE INDEX LIST WILL BE MARKED AS RESTORE */ 02268000
*/*       CANDIDATE IF IT IS FOUND IN THE ICT (ICTPRCND).            */ 02269000
*/*                                                                  */ 02270000
*/*       RC = 0 ONE OR MORE SYSMODS IN THE INDEX LIST WAS FOUND AND */ 02271000
*/*              WAS NOT ALREADY A CANDIDATE                         */ 02272000
*/*       RC = 4 NO SYSMOD IN THE INDEX LIST, OR                     */ 02273000
*/*              NO SYSMOD WAS FOUND IN THE ICT THAT WAS NOT ALREADY */ 02274000
*/*              A CANDIDATE                                         */ 02275000
*/*                                                                  */ 02276000
*/********************************************************************/ 02277000
*                                                                  0785 02278000
*SETCAND2:                                                         0785 02279000
*   PROC(SET2ENT,                   /* ICT PTF ENTRY FOR CURRENT   0785 02280000
*                                      SYSMOD                        */ 02281000
*       SET2OFST);                  /* OFFSET OF PTF ENTRY INDEX LIST   02282000
*                                      TO BE SEARCHED                */ 02283000
SETCAND2 STM   @14,@12,@SA00014                                    0785 02284000
         MVC   @PC00014(8),0(@01)                                  0785 02285000
*   DCL                                                            0786 02286000
*     SET2ENT CHAR(*);              /* ICT PTF ENTRY                 */ 02287000
*   DCL                                                            0787 02288000
*     SET2OFST FIXED(31);           /* OFFSET OF THE LIST            */ 02289000
*   DCL                                                            0788 02290000
*     SET2RC FIXED(15);             /* LOCAL RETURN CODE             */ 02291000
*   DCL                                                            0789 02292000
*     SET2NFND CONSTANT(4);         /* NOT ADDED RETURN CODE         */ 02293000
*   DCL                                                            0790 02294000
*     1 SET2FLGS,                   /* LOCAL CONTROL FLAGS           */ 02295000
*      2 SET2END BIT(1),            /* END OF ICT SEARCH             */ 02296000
*      2 * BIT(7);                  /* UNUSED                        */ 02297000
*   RFY                                                            0791 02298000
*     ICTPTF BASED(ADDR(SET2ENT));                                 0791 02299000
*   RFY                                                            0792 02300000
*     TSLPARMS BASED(TBLXTSLP);                                    0792 02301000
*   SET2RC=SET2NFND;                /* ASSUME NO CANDIDATE ADDED     */ 02302000
         LA    SET2RC,4                                            0793 02303000
*   TSLLSTSR=''B;                   /* CLEAR TSB PARM LIST           */ 02304000
         L     @10,@PC00001                                        0794 02305000
         L     @10,TBLXTSLP(,@10)                                  0794 02306000
         L     @08,TSLPMLAD(,@10)                                  0794 02307000
         XC    TSLLSTSR(16,@08),TSLLSTSR(@08)                      0794 02308000
*   TSLLSMD=ICTPTFS(1);             /* SEARCH FOR SYSMOD IN INDEX  0795 02309000
*                                      LIST                          */ 02310000
         L     @03,@PC00014                                        0795 02311000
         MVC   TSLLSMD(7,@08),ICTPTFS(@03)                         0795 02312000
*   TSLFUNCT=TSLFLSRH;              /* SEARCH ICT LIST FOR REFERENCES   02313000
*                                      TO THE CURRENT SYSMOD         */ 02314000
         MVI   TSLFUNCT(@10),X'02'                                 0796 02315000
*   TSLLOFST=SET2OFST;              /* OFFSET OF THE LIST TO BE    0797 02316000
*                                      SEARCHED                      */ 02317000
         L     @10,@PC00014+4                                      0797 02318000
         MVC   TSLLOFST(4,@08),SET2OFST(@10)                       0797 02319000
*   SET2END=OFF;                    /* CLEAR END OF SEARCH FLAG      */ 02320000
         NI    SET2END,B'01111111'                                 0798 02321000
*   DO WHILE(SET2END=OFF            /* PROCESS ALL ENTRIES           */ 02322000
*         &SET2RC<STOPSMD);                                        0799 02323000
         B     @DE00799                                            0799 02324000
@DL00799 DS    0H                                                  0800 02325000
*     CALL HMASMTSB(TSLPARMS);                                     0800 02326000
         L     @10,@PC00001                                        0800 02327000
         L     @10,TBLXTSLP(,@10)                                  0800 02328000
         ST    @10,@AL00001                                        0800 02329000
         L     @15,@CV01232                                        0800 02330000
         LA    @01,@AL00001                                        0800 02331000
         BALR  @14,@15                                             0800 02332000
*     TSLLONXT=ON;                  /* SEARCH FOR NEXT OCCURRENCE    */ 02333000
         L     @10,@PC00001                                        0801 02334000
         L     @10,TBLXTSLP(,@10)                                  0801 02335000
         L     @08,TSLPMLAD(,@10)                                  0801 02336000
         OI    TSLLONXT(@08),B'10000000'                           0801 02337000
*     IF TSLRETRN=TSLFOUND THEN     /* SYSMOD FOUND?                 */ 02338000
         CLI   TSLRETRN(@10),0                                     0802 02339000
         BNE   @RF00802                                            0802 02340000
*       DO;                         /* YES,                          */ 02341000
*         IF TSLLRTNP->ICTPRCND(1)=ON THEN/* CANDIDATE ALREADY?      */ 02342000
         L     @10,TSLLRTNP(,@08)                                  0804 02343000
         TM    ICTPRCND(@10),B'00010000'                           0804 02344000
         BNO   @RF00804                                            0804 02345000
*           DO;                     /* YES,                          */ 02346000
*             SET2RC=MIN(SET2RC,SET2NFND);/*                         */ 02347000
         LA    @10,4                                               0806 02348000
         CR    SET2RC,@10                                          0806 02349000
         BNH   *+6                                                      02350000
         LR    SET2RC,@10                                          0806 02351000
*           END;                                                   0807 02352000
*         ELSE                      /* NOT A CANDIDATE YET           */ 02353000
*           DO;                     /*                               */ 02354000
         B     @RC00804                                            0808 02355000
@RF00804 DS    0H                                                  0809 02356000
*             TSLLRTNP->ICTPRCND(1)=ON;/* MARK AS CANDIDATE          */ 02357000
         L     @10,@PC00001                                        0809 02358000
         L     @10,TBLXTSLP(,@10)                                  0809 02359000
         L     @10,TSLPMLAD(,@10)                                  0809 02360000
         L     @10,TSLLRTNP(,@10)                                  0809 02361000
         OI    ICTPRCND(@10),B'00010000'                           0809 02362000
*             SET2RC=ZERO;          /* CANDIDATE ADDED RC            */ 02363000
         SLR   SET2RC,SET2RC                                       0810 02364000
*           END;                                                   0811 02365000
*       END;                                                       0812 02366000
*     ELSE                          /* ENTRY NOT FOUND               */ 02367000
*       DO;                         /*                               */ 02368000
         B     @RC00802                                            0813 02369000
@RF00802 DS    0H                                                  0814 02370000
*         SET2RC=MIN(SET2RC,TSLRETRN);/* RC = 4 IF NO ENTRY EVER   0814 02371000
*                                      FOUND OR 0 IF ONE OR MORE IS     02372000
*                                      FOUND IN ICT                  */ 02373000
         L     @10,@PC00001                                        0814 02374000
         L     @10,TBLXTSLP(,@10)                                  0814 02375000
         SLR   @08,@08                                             0814 02376000
         IC    @08,TSLRETRN(,@10)                                  0814 02377000
         CR    SET2RC,@08                                          0814 02378000
         BNH   *+6                                                      02379000
         LR    SET2RC,@08                                          0814 02380000
*         SET2END=ON;               /* STOP THE SEARCH               */ 02381000
         OI    SET2END,B'10000000'                                 0815 02382000
*       END;                                                       0816 02383000
*   END;                            /* END OF PROCESS LOOP           */ 02384000
@RC00802 DS    0H                                                  0817 02385000
@DE00799 TM    SET2END,B'10000000'                                 0817 02386000
         BNZ   @DC00799                                            0817 02387000
         CH    SET2RC,@CH00055                                     0817 02388000
         BL    @DL00799                                            0817 02389000
@DC00799 DS    0H                                                  0818 02390000
*   RETURN CODE(SET2RC);            /* RETURN W/RC                   */ 02391000
         LR    @15,SET2RC                                          0818 02392000
         L     @14,@SA00014                                        0818 02393000
         LM    @00,@12,@SA00014+8                                  0818 02394000
         BR    @14                                                 0818 02395000
*   RFY                                                            0819 02396000
*     ICTPTF BASED;                                                0819 02397000
*   RFY                                                            0820 02398000
*     TSLPARMS BASED;                                              0820 02399000
*   END SETCAND2;                                                  0821 02400000
*   END GROUP;                                                     0822 02401000
*                                                                  0823 02402000
*/********************************************************************/ 02403000
*/*                                                                  */ 02404000
*/* ASSUMTION: IF SYSMOD IS PREREQ'ED BY OTHER SYSMODS THEY WILL ALL */ 02405000
*/*     BE IN THE ICT.                                               */ 02406000
*/*                                                                  */ 02407000
*/*                                                                  */ 02408000
*/*                                                                  */ 02409000
*/*                                                                  */ 02410000
*/* SUP'ED SYSMODS:                                                  */ 02411000
*/*     - ALL SYSMODS IN THE SUPBY LIST MUST BE IN THE ICT AND OK    */ 02412000
*/*       (TPR)                                                      */ 02413000
*/*     - IF ANY SUP'ING SYSMOD FAILS, FAIL ALL OTHER SYSMODS THAT   */ 02414000
*/*       ALSO SUP SYSMODS IN THE FAILING SYSMOD'S SUP LIST.         */ 02415000
*/*       ALSO FAIL THE SUP'ED SYSMOD                                */ 02416000
*/*       (TCR,CPL)                                                  */ 02417000
*/*                                                                  */ 02418000
*/* PRE'ING SYSMODS:                                                 */ 02419000
*/*     - IF A PRE'ED SYSMOD FAILS, ALL PRE'ING SYSMODS ARE FAILED   */ 02420000
*/*       (TCR,CPL)                                                  */ 02421000
*/*                                                                  */ 02422000
*/* REQ SYSMODS:                                                     */ 02423000
*/*     - ALL REQ'S OF A FAILING SYSMOD ARE FAILED.                  */ 02424000
*/*     - ALL SYSMODS THAT REQ A FAILED SYSMOD ARE FAILED.           */ 02425000
*/*       (TCR,CPL)                                                  */ 02426000
*/*                                                                  */ 02427000
*/* IF REQ SYSMODS:                                                  */ 02428000
*/*     - ALL IREQ'S OF A FAILING SYSMOD ARE FAILED.                 */ 02429000
*/*     - ALL SYSMODS THAT IREQ A FAILED SYSMOD ARE FAILED.          */ 02430000
*/*       (TCR,CPL)                                                  */ 02431000
*/*                                                                  */ 02432000
*/* FMID SYSMODS:                                                    */ 02433000
*/*     - ANY SYSMOD THAT FMID'S A SYSMOD THAT FAILS IS FAILED       */ 02434000
*/*       (TCR,CPL)                                                  */ 02435000
*/*                                                                  */ 02436000
*/*                                                                  */ 02437000
*/* NOTE: THERE SEEMS TO BE NO REASON TO RESTORE A SYSMOD IF THE     */ 02438000
*/*       IREQ IS NOT IN THE ICT BUT IS ACCEPTED.  LIKEWISE, IF A    */ 02439000
*/*       ONE WAY REQ IS BEING RESTORED BUT THE REQ'ED SYSMOD        */ 02440000
*/*       IS ACCEPTED.  HOWEVER, THIS IS NOT DONE TO CONFORM TO THE  */ 02441000
*/*       FPFS                                                       */ 02442000
*/*                                                                  */ 02443000
*/********************************************************************/ 02444000
*                                                                  0823 02445000
*REQCHK:                                                           0823 02446000
*   PROC;                                                          0823 02447000
REQCHK   STM   @14,@12,@SA00015                                    0823 02448000
*   DCL                                                            0824 02449000
*     REQCHKRC FIXED(15);           /* LOCAL RETURN CODE             */ 02450000
*   DCL                                                            0825 02451000
*     REQCSMDX FIXED(31);           /* PTF ENTRY INDEX COUNTER       */ 02452000
*   RFY                                                            0826 02453000
*     ICTPTF BASED(CCAICPTF);                                      0826 02454000
*   RFY                                                            0827 02455000
*     TSLPARMS BASED(TBLXTSLP);                                    0827 02456000
*   REQCHKRC=ZERO;                  /* CLEAR RETURN CODE             */ 02457000
         SLR   REQCHKRC,REQCHKRC                                   0828 02458000
*                                                                  0829 02459000
*   /*****************************************************************/ 02460000
*   /*                                                               */ 02461000
*   /* INSURE THAT ALL SYSMODS IN THE SUPBY LIST OF EACH SYSMOD IS IN*/ 02462000
*   /* THE ICT. IF NOT ISSUE AN ERROR MESSAGE.                       */ 02463000
*   /*                                                               */ 02464000
*   /*****************************************************************/ 02465000
*                                                                  0829 02466000
*   CALL SUPCHK;                                                   0829 02467000
         BAL   @14,SUPCHK                                          0829 02468000
*   RFY                                                            0830 02469000
*     RTNCODE RSTD;                 /*                               */ 02470000
*   REQCHKRC=MAX(REQCHKRC,RTNCODE); /* SAVE RETURN CODE              */ 02471000
         CR    REQCHKRC,RTNCODE                                    0831 02472000
         BNL   *+6                                                      02473000
         LR    REQCHKRC,RTNCODE                                    0831 02474000
*   RFY                                                            0832 02475000
*     RTNCODE UNRSTD;               /*                               */ 02476000
*                                                                  0832 02477000
*   /*****************************************************************/ 02478000
*   /*                                                               */ 02479000
*   /* MARK ALL SYSMODS THAT ARE NOT CANDIDATES AS NOGO. ALSO MARK   */ 02480000
*   /* DELETING SYSMODS AS NOGO                                      */ 02481000
*   /*                                                               */ 02482000
*   /*****************************************************************/ 02483000
*                                                                  0833 02484000
*   DO REQCSMDX=1 BY 1              /* PROCESS ALL SYSMODS IN THE ICT*/ 02485000
*         WHILE(ICTPEND(REQCSMDX)^=ICTENDNT);                      0833 02486000
         LA    REQCSMDX,1                                          0833 02487000
         B     @DE00833                                            0833 02488000
@DL00833 DS    0H                                                  0834 02489000
*     IF ICTPRCND(REQCSMDX)^=ON THEN/* SYSMOD IS RESTORE CANDIDATE?  */ 02490000
         LR    @10,REQCSMDX                                        0834 02491000
         MH    @10,@CH01508                                        0834 02492000
         L     @08,CCAICPTF(,CCAPTR)                               0834 02493000
         ST    @10,@TF00001                                        0834 02494000
         ALR   @10,@08                                             0834 02495000
         AL    @10,@CF01532                                        0834 02496000
         TM    ICTPRCND-12(@10),B'00010000'                        0834 02497000
         BO    @RF00834                                            0834 02498000
*       DO;                         /* YES,                          */ 02499000
*         ICTPNOGO(REQCSMDX)=ON;    /* MARK AS NOGO                  */ 02500000
         AL    @08,@TF00001                                        0836 02501000
         AL    @08,@CF01538                                        0836 02502000
         OI    ICTPNOGO-8(@08),B'01000000'                         0836 02503000
*       END;                                                       0837 02504000
*     ELSE                          /* IS A RESTORE CANDIDATE        */ 02505000
*       DO;                                                        0838 02506000
         B     @RC00834                                            0838 02507000
@RF00834 DS    0H                                                  0839 02508000
*         IF ICTPDELP(REQCSMDX)=ON THEN/* GROUPED IN DELETING SYSMOD?*/ 02509000
         LR    @10,REQCSMDX                                        0839 02510000
         MH    @10,@CH01508                                        0839 02511000
         L     @08,CCAICPTF(,CCAPTR)                               0839 02512000
         ST    @10,@TF00001                                        0839 02513000
         ALR   @10,@08                                             0839 02514000
         AL    @10,@CF01539                                        0839 02515000
         TM    ICTPDELP-9(@10),B'10000000'                         0839 02516000
         BNO   @RF00839                                            0839 02517000
*           DO;                     /* YES,                          */ 02518000
*             ICTPNOGO(REQCSMDX)=ON;/* MARK IT NOGO                  */ 02519000
*                                                                  0841 02520000
         LR    @10,@08                                             0841 02521000
         AL    @10,@TF00001                                        0841 02522000
         AL    @10,@CF01538                                        0841 02523000
         OI    ICTPNOGO-8(@10),B'01000000'                         0841 02524000
*             /*******************************************************/ 02525000
*             /*                                                     */ 02526000
*             /* HMA428I RESTORE CANDIDATE XXXXXXX TERMINATED BECAUSE*/ 02527000
*             /* IT ... DELETES SYSMODS                              */ 02528000
*             /*                                                     */ 02529000
*             /*******************************************************/ 02530000
*                                                                  0842 02531000
*             DO;                   /* HMASMPMG M1(HMA428I)M2(PART120   02532000
*                                      )TYPE(ERR)VAR(ICTPTFS(REQCSMDX   02533000
*                                      ))TARGET(SYSOUT,LOG)          */ 02534000
*               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS    */ 02535000
         XC    HMASMMGP(28),HMASMMGP                               0843 02536000
*               MGPMGNO1=HMA428I;   /* SET UP MSG 1 CODE             */ 02537000
         MVC   MGPMGNO1(2),@CH01239                                0844 02538000
*               MGPMGNO2=PART120;   /* SET UP MSG 2 CODE             */ 02539000
         MVC   MGPMGNO2(2),@CH01248                                0845 02540000
*               MGPTYPE=MGPERR;     /* SET MESSAGE TYPE              */ 02541000
         MVI   MGPTYPE,X'03'                                       0846 02542000
*               MGPPRINT='1'B;      /* SET TARGET FLAG               */ 02543000
*               MGPHLDS='1'B;       /* SET TARGET FLAG               */ 02544000
         OI    MGPPRINT,B'10010000'                                0848 02545000
*               MGPVARPT(1)=ADDR(ICTPTFS(REQCSMDX));/* SET VARIABLE     02546000
*                                      PTR                           */ 02547000
         L     @10,@TF00001                                        0849 02548000
         AL    @08,@CF01534                                        0849 02549000
         LA    @10,ICTPTFS(@10,@08)                                0849 02550000
         ST    @10,MGPVARPT                                        0849 02551000
*               CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED       */ 02552000
         L     @15,@CV01229                                        0850 02553000
         LA    @01,@AL00850                                        0850 02554000
         BALR  @14,@15                                             0850 02555000
*             END;                  /*                               */ 02556000
*             ICTPNOGO(REQCSMDX)=ON;/* MARK SYSMOD NOGO              */ 02557000
*             ICTPCPL(REQCSMDX)=ON; /* ... COMPLETE                  */ 02558000
*             ICTPMSG(REQCSMDX)=ON; /* ... AND MESSAGE ISSUE         */ 02559000
         LR    @10,REQCSMDX                                        0854 02560000
         MH    @10,@CH01508                                        0854 02561000
         L     @08,CCAICPTF(,CCAPTR)                               0854 02562000
         ST    @10,@TF00001                                        0854 02563000
         ALR   @10,@08                                             0854 02564000
         AL    @10,@CF01538                                        0854 02565000
         OI    ICTPNOGO-8(@10),B'01110000'                         0854 02566000
*             TSLFUNCT=TSLFFUNC;    /* CHECK FOR FUNCTION FAILURE    */ 02567000
         L     @10,@PC00001                                        0855 02568000
         L     @10,TBLXTSLP(,@10)                                  0855 02569000
         MVI   TSLFUNCT(@10),X'07'                                 0855 02570000
*             TSLMTYPE=ICTPTYPE(REQCSMDX);/* TYPE ...                */ 02571000
         L     @15,TSLPMLAD(,@10)                                  0856 02572000
         L     @14,@TF00001                                        0856 02573000
         AL    @14,@CF01531                                        0856 02574000
         SLR   @07,@07                                             0856 02575000
         IC    @07,ICTPTYPE-17(@14,@08)                            0856 02576000
         STC   @07,TSLMTYPE(,@15)                                  0856 02577000
*             TSLMSMD=ICTPTFS(REQCSMDX);/* ... AND NAME              */ 02578000
         AL    @08,@TF00001                                        0857 02579000
         AL    @08,@CF01534                                        0857 02580000
         MVC   TSLMSMD(7,@15),ICTPTFS(@08)                         0857 02581000
*             CALL HMASMTSB(TSLPARMS);/* ...                         */ 02582000
         ST    @10,@AL00001                                        0858 02583000
         L     @15,@CV01232                                        0858 02584000
         LA    @01,@AL00001                                        0858 02585000
         BALR  @14,@15                                             0858 02586000
*             REQCHKRC=TSLRETRN;    /* SET THE RETURN CODE           */ 02587000
         L     @10,@PC00001                                        0859 02588000
         L     @10,TBLXTSLP(,@10)                                  0859 02589000
         SLR   REQCHKRC,REQCHKRC                                   0859 02590000
         IC    REQCHKRC,TSLRETRN(,@10)                             0859 02591000
*           END;                                                   0860 02592000
*         ELSE                                                     0861 02593000
*           ;                       /* NOT A DELETOR SO SKIP IT      */ 02594000
@RF00839 DS    0H                                                  0862 02595000
*       END;                                                       0862 02596000
*   END;                            /* END ALL SYSMOD LOOP           */ 02597000
*                                                                  0863 02598000
@RC00834 AL    REQCSMDX,@CF00063                                   0863 02599000
@DE00833 LR    @10,REQCSMDX                                        0863 02600000
         MH    @10,@CH01508                                        0863 02601000
         L     @08,CCAICPTF(,CCAPTR)                               0863 02602000
         AL    @08,@CF01534                                        0863 02603000
         L     @10,ICTPEND(@10,@08)                                0863 02604000
         CL    @10,ICTENDNT                                        0863 02605000
         BNE   @DL00833                                            0863 02606000
*   /*****************************************************************/ 02607000
*   /*                                                               */ 02608000
*   /* CALL TCR TO ELIMINATE NOTE: IT IS ASSUMED THAT TSB DOES NOT   */ 02609000
*   /* USE PTF USR FLAGS                                             */ 02610000
*   /*                                                               */ 02611000
*   /*****************************************************************/ 02612000
*                                                                  0864 02613000
*   TSLFUNCT=TSLFRCKR;              /* CHECK FOR RESTORE REQ'S       */ 02614000
         L     @10,@PC00001                                        0864 02615000
         L     @10,TBLXTSLP(,@10)                                  0864 02616000
         MVI   TSLFUNCT(@10),X'08'                                 0864 02617000
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */ 02618000
         ST    @10,@AL00001                                        0865 02619000
         L     @15,@CV01232                                        0865 02620000
         LA    @01,@AL00001                                        0865 02621000
         BALR  @14,@15                                             0865 02622000
*   REQCHKRC=MAX(REQCHKRC,TSLRETRN);/* SET RETURN CODE               */ 02623000
*                                                                  0866 02624000
         L     @10,@PC00001                                        0866 02625000
         L     @10,TBLXTSLP(,@10)                                  0866 02626000
         SLR   @08,@08                                             0866 02627000
         IC    @08,TSLRETRN(,@10)                                  0866 02628000
         CR    REQCHKRC,@08                                        0866 02629000
         BNL   *+6                                                      02630000
         LR    REQCHKRC,@08                                        0866 02631000
*   /*****************************************************************/ 02632000
*   /*                                                               */ 02633000
*   /* SET PRE/REQ/IRQ STATUS FLAGS IN INDEX LIST ENTRIES            */ 02634000
*   /*                                                               */ 02635000
*   /*****************************************************************/ 02636000
*                                                                  0867 02637000
*   DO REQCSMDX=1 BY 1              /* PROCESS EACH SYSMOD ENTRY     */ 02638000
*         WHILE(ICTPEND(REQCSMDX)^=ICTENDIX);/*                      */ 02639000
         LA    REQCSMDX,1                                          0867 02640000
         B     @DE00867                                            0867 02641000
@DL00867 DS    0H                                                  0868 02642000
*     CALL REQSTAT(ICTPRCHN(REQCSMDX),/* SET REQ STATUS FLAGS        */ 02643000
*         TPRREQI);                 /*                               */ 02644000
         LR    @10,REQCSMDX                                        0868 02645000
         MH    @10,@CH01508                                        0868 02646000
         L     @08,CCAICPTF(,CCAPTR)                               0868 02647000
         AL    @08,@CF01535                                        0868 02648000
         LA    @10,ICTPRCHN-68(@10,@08)                            0868 02649000
         ST    @10,@AL00001                                        0868 02650000
         LA    @10,@CF00063                                        0868 02651000
         ST    @10,@AL00001+4                                      0868 02652000
         LA    @01,@AL00001                                        0868 02653000
         BAL   @14,REQSTAT                                         0868 02654000
*     CALL REQSTAT(ICTPPCHN(REQCSMDX),/* SET PRE STATUS FLAGS        */ 02655000
*         TPRPREI);                 /*                               */ 02656000
         LR    @10,REQCSMDX                                        0869 02657000
         MH    @10,@CH01508                                        0869 02658000
         L     @08,CCAICPTF(,CCAPTR)                               0869 02659000
         AL    @08,@CF01540                                        0869 02660000
         LA    @10,ICTPPCHN-76(@10,@08)                            0869 02661000
         ST    @10,@AL00001                                        0869 02662000
         LA    @10,@CF00063                                        0869 02663000
         ST    @10,@AL00001+4                                      0869 02664000
         LA    @01,@AL00001                                        0869 02665000
         BAL   @14,REQSTAT                                         0869 02666000
*     CALL REQSTAT(ICTPICHN(REQCSMDX),/* SET IRQ STATUS FLAGS        */ 02667000
*         TPRIRQI);                 /*                               */ 02668000
         LR    @10,REQCSMDX                                        0870 02669000
         MH    @10,@CH01508                                        0870 02670000
         L     @08,CCAICPTF(,CCAPTR)                               0870 02671000
         AL    @08,@CF01536                                        0870 02672000
         LA    @10,ICTPICHN-80(@10,@08)                            0870 02673000
         ST    @10,@AL00001                                        0870 02674000
         LA    @10,@CF00273                                        0870 02675000
         ST    @10,@AL00001+4                                      0870 02676000
         LA    @01,@AL00001                                        0870 02677000
         BAL   @14,REQSTAT                                         0870 02678000
*   END;                            /*                               */ 02679000
         AL    REQCSMDX,@CF00063                                   0871 02680000
@DE00867 LR    @10,REQCSMDX                                        0871 02681000
         MH    @10,@CH01508                                        0871 02682000
         L     @08,CCAICPTF(,CCAPTR)                               0871 02683000
         AL    @08,@CF01534                                        0871 02684000
         L     @10,ICTPEND(@10,@08)                                0871 02685000
         CL    @10,ICTENDIX                                        0871 02686000
         BNE   @DL00867                                            0871 02687000
*   RETURN CODE(REQCHKRC);          /* RETURN W/ RC                  */ 02688000
         LR    @15,REQCHKRC                                        0872 02689000
         L     @14,@SA00015                                        0872 02690000
         LM    @00,@12,@SA00015+8                                  0872 02691000
         BR    @14                                                 0872 02692000
*   RFY                                                            0873 02693000
*     ICTPTF BASED;                                                0873 02694000
*   RFY                                                            0874 02695000
*     TSLPARMS BASED;                                              0874 02696000
*SUPCHK:                                                           0875 02697000
*   PROC;                                                          0875 02698000
SUPCHK   STM   @14,@12,@SA00016                                    0875 02699000
*   DCL                                                            0876 02700000
*     SUPCHKRC FIXED(15);           /* LOCAL RETURN CODE             */ 02701000
*   DCL                                                            0877 02702000
*     SUPCSMDX FIXED(31);           /* PTF ENTRY INDEX COUNTER       */ 02703000
*   DCL                                                            0878 02704000
*     SUPCSUPX FIXED(31);           /* SUP INDEX LIST INDEX COUNTER  */ 02705000
*   RFY                                                            0879 02706000
*     ICTPTF BASED(CCAICPTF);                                      0879 02707000
*   RFY                                                            0880 02708000
*     ICTSBYLS BASED(ICTPBCHN(SUPCSMDX));                          0880 02709000
*   RFY                                                            0881 02710000
*     TSLPARMS BASED(TBLXTSLP);                                    0881 02711000
*   SUPCHKRC=ZERO;                  /* CLEAR RETURN CODE             */ 02712000
         SLR   SUPCHKRC,SUPCHKRC                                   0882 02713000
*   TSLICTSR=''B;                   /* CLEAR TSB PARM LIST           */ 02714000
         L     @10,@PC00001                                        0883 02715000
         L     @10,TBLXTSLP(,@10)                                  0883 02716000
         L     @08,TSLPMLAD(,@10)                                  0883 02717000
         XC    TSLICTSR(14,@08),TSLICTSR(@08)                      0883 02718000
*   TSLFUNCT=TSLFISRH;              /* TSB FUNCTION IS SEARCH ICT FOR   02719000
*                                      PTF ENTRY                     */ 02720000
         MVI   TSLFUNCT(@10),X'01'                                 0884 02721000
*   DO SUPCSMDX=1 BY 1              /* PROCESS ALL SYSMODS IN THE ICT*/ 02722000
*         WHILE(ICTPEND(SUPCSMDX)^=ICTENDNT);                      0885 02723000
         LA    SUPCSMDX,1                                          0885 02724000
         B     @DE00885                                            0885 02725000
@DL00885 DS    0H                                                  0886 02726000
*     IF ICTPRCND(SUPCSMDX)=ON THEN /* SYSMOD IS RESTORE CANDIDATE?  */ 02727000
         LR    @10,SUPCSMDX                                        0886 02728000
         MH    @10,@CH01508                                        0886 02729000
         L     @08,CCAICPTF(,CCAPTR)                               0886 02730000
         ALR   @08,@10                                             0886 02731000
         AL    @08,@CF01532                                        0886 02732000
         TM    ICTPRCND-12(@08),B'00010000'                        0886 02733000
         BNO   @RF00886                                            0886 02734000
*       DO;                         /* YES,                          */ 02735000
*         DO SUPCSUPX=1 BY 1        /* PROCESS EACH SUP LIST SYSMOD     02736000
*                                      ENTRY                         */ 02737000
*               WHILE(ICTSBYND(SUPCSUPX)^=ICTENDIX);               0888 02738000
         LA    SUPCSUPX,1                                          0888 02739000
         B     @DE00888                                            0888 02740000
@DL00888 DS    0H                                                  0889 02741000
*           TSLISMD=ICTSBYNM(SUPCSUPX);/* SEARCH ICT FOR SUP'ED SMD  */ 02742000
         L     @10,@PC00001                                        0889 02743000
         L     @10,TBLXTSLP(,@10)                                  0889 02744000
         L     @08,TSLPMLAD(,@10)                                  0889 02745000
         LR    @05,SUPCSUPX                                        0889 02746000
         SLA   @05,3                                               0889 02747000
         LR    @15,SUPCSMDX                                        0889 02748000
         MH    @15,@CH01508                                        0889 02749000
         L     @01,CCAICPTF(,CCAPTR)                               0889 02750000
         AL    @01,@CF01541                                        0889 02751000
         L     @01,ICTPBCHN-96(@15,@01)                            0889 02752000
         ALR   @01,@05                                             0889 02753000
         AL    @01,@CF01537                                        0889 02754000
         MVC   TSLISMD(7,@08),ICTSBYNM(@01)                        0889 02755000
*           CALL HMASMTSB(TSLPARMS);/* ...                           */ 02756000
         ST    @10,@AL00001                                        0890 02757000
         L     @15,@CV01232                                        0890 02758000
         LA    @01,@AL00001                                        0890 02759000
         BALR  @14,@15                                             0890 02760000
*           IF TSLRETRN=TSLNTFND THEN/* NOT FOUND IN ICT?            */ 02761000
         L     @10,@PC00001                                        0891 02762000
         L     @10,TBLXTSLP(,@10)                                  0891 02763000
         CLI   TSLRETRN(@10),4                                     0891 02764000
         BNE   @RF00891                                            0891 02765000
*             DO;                   /* YES,                          */ 02766000
*               ICTPNOGO(SUPCSMDX)=ON;/* MARK SYSMOD NOGO            */ 02767000
*               ICTPCPL(SUPCSMDX)=ON;/* ... COMPLETE                 */ 02768000
*               ICTPMSG(SUPCSMDX)=ON;/* ... AND MESSAGE ISSUE        */ 02769000
*                                                                  0895 02770000
         LR    @10,SUPCSMDX                                        0895 02771000
         MH    @10,@CH01508                                        0895 02772000
         L     @08,CCAICPTF(,CCAPTR)                               0895 02773000
         ST    @10,@TF00001                                        0895 02774000
         ALR   @10,@08                                             0895 02775000
         AL    @10,@CF01538                                        0895 02776000
         OI    ICTPNOGO-8(@10),B'01110000'                         0895 02777000
*               /*****************************************************/ 02778000
*               /*                                                   */ 02779000
*               /* ISSUE MESSAGE 'HMASM433 SYSMOD XXXXXXX IS         */ 02780000
*               /* SUPERSEDED BY XXXXXXX, WHICH IS NOT BEING         */ 02781000
*               /* RESTORED'                                         */ 02782000
*               /*                                                   */ 02783000
*               /*****************************************************/ 02784000
*                                                                  0896 02785000
*               DO;                 /* HMASMPMG M1(HMA433I)TYPE(ERR)V   02786000
*                                      AR(ICTPTFS(SUPCSMDX),ICTSBYNM(   02787000
*                                      SUPCSUPX))TARGET(SYSOUT,LOG)  */ 02788000
*                 HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS  */ 02789000
         XC    HMASMMGP(28),HMASMMGP                               0897 02790000
*                 MGPMGNO1=HMA433I; /* SET UP MSG 1 CODE             */ 02791000
         MVC   MGPMGNO1(2),@CH01241                                0898 02792000
*                 MGPTYPE=MGPERR;   /* SET MESSAGE TYPE              */ 02793000
         MVI   MGPTYPE,X'03'                                       0899 02794000
*                 MGPPRINT='1'B;    /* SET TARGET FLAG               */ 02795000
*                 MGPHLDS='1'B;     /* SET TARGET FLAG               */ 02796000
         OI    MGPPRINT,B'10010000'                                0901 02797000
*                 MGPVARPT(1)=ADDR(ICTPTFS(SUPCSMDX));/* SET VARIABLE   02798000
*                                      PTR                           */ 02799000
         L     @10,@TF00001                                        0902 02800000
         AL    @10,@CF01534                                        0902 02801000
         LA    @10,ICTPTFS(@10,@08)                                0902 02802000
         ST    @10,MGPVARPT                                        0902 02803000
*                 MGPVARPT(2)=ADDR(ICTSBYNM(SUPCSUPX));/* SET      0903 02804000
*                                      VARIABLE PTR                  */ 02805000
         LR    @10,SUPCSUPX                                        0903 02806000
         SLA   @10,3                                               0903 02807000
         L     @05,@TF00001                                        0903 02808000
         AL    @08,@CF01541                                        0903 02809000
         L     @08,ICTPBCHN-96(@05,@08)                            0903 02810000
         AL    @08,@CF01537                                        0903 02811000
         LA    @10,ICTSBYNM(@10,@08)                               0903 02812000
         ST    @10,MGPVARPT+4                                      0903 02813000
*                 CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED     */ 02814000
         L     @15,@CV01229                                        0904 02815000
         LA    @01,@AL00904                                        0904 02816000
         BALR  @14,@15                                             0904 02817000
*               END;                /*                               */ 02818000
*               TSLFUNCT=TSLFFUNC;  /* FUNCTION IS ISSUE FUNCTION  0906 02819000
*                                      FAIL MESSAGE IF REQUIRED      */ 02820000
         L     @10,@PC00001                                        0906 02821000
         L     @10,TBLXTSLP(,@10)                                  0906 02822000
         MVI   TSLFUNCT(@10),X'07'                                 0906 02823000
*               TSLMTYPE=ICTPTYPE(SUPCSMDX);/* TYPE ...              */ 02824000
         L     @08,TSLPMLAD(,@10)                                  0907 02825000
         LR    @05,SUPCSMDX                                        0907 02826000
         MH    @05,@CH01508                                        0907 02827000
         L     @15,CCAICPTF(,CCAPTR)                               0907 02828000
         LA    @01,0(@05,@15)                                      0907 02829000
         AL    @01,@CF01531                                        0907 02830000
         SLR   @00,@00                                             0907 02831000
         IC    @00,ICTPTYPE-17(,@01)                               0907 02832000
         STC   @00,TSLMTYPE(,@08)                                  0907 02833000
*               TSLMSMD=ICTPTFS(SUPCSMDX);/* ... AND NAME            */ 02834000
         ALR   @15,@05                                             0908 02835000
         AL    @15,@CF01534                                        0908 02836000
         MVC   TSLMSMD(7,@08),ICTPTFS(@15)                         0908 02837000
*               CALL HMASMTSB(TSLPARMS);/* ...                       */ 02838000
         ST    @10,@AL00001                                        0909 02839000
         L     @15,@CV01232                                        0909 02840000
         LA    @01,@AL00001                                        0909 02841000
         BALR  @14,@15                                             0909 02842000
*               SUPCHKRC=TSLRETRN;  /* SET THE RETURN CODE           */ 02843000
         L     @10,@PC00001                                        0910 02844000
         L     @10,TBLXTSLP(,@10)                                  0910 02845000
         SLR   SUPCHKRC,SUPCHKRC                                   0910 02846000
         IC    SUPCHKRC,TSLRETRN(,@10)                             0910 02847000
*             END;                                                 0911 02848000
*           ELSE                                                   0912 02849000
*             ;                     /* SUP'ED ENTRY IN ICT, ANY ERROR   02850000
*                                      WILL BE FOUND BY TCR          */ 02851000
@RF00891 DS    0H                                                  0913 02852000
*         END;                                                     0913 02853000
         AL    SUPCSUPX,@CF00063                                   0913 02854000
@DE00888 LR    @10,SUPCSUPX                                        0913 02855000
         SLA   @10,3                                               0913 02856000
         LR    @08,SUPCSMDX                                        0913 02857000
         MH    @08,@CH01508                                        0913 02858000
         L     @05,CCAICPTF(,CCAPTR)                               0913 02859000
         AL    @05,@CF01541                                        0913 02860000
         L     @08,ICTPBCHN-96(@08,@05)                            0913 02861000
         AL    @08,@CF01537                                        0913 02862000
         L     @10,ICTSBYND(@10,@08)                               0913 02863000
         CL    @10,ICTENDIX                                        0913 02864000
         BNE   @DL00888                                            0913 02865000
*       END;                                                       0914 02866000
*     ELSE                                                         0915 02867000
*       ;                           /* NOT A RESTORE CANDIDATE, SO 0915 02868000
*                                      SKIP IT                       */ 02869000
@RF00886 DS    0H                                                  0916 02870000
*   END;                            /* END ALL SYSMOD LOOP           */ 02871000
         AL    SUPCSMDX,@CF00063                                   0916 02872000
@DE00885 LR    @10,SUPCSMDX                                        0916 02873000
         MH    @10,@CH01508                                        0916 02874000
         L     @08,CCAICPTF(,CCAPTR)                               0916 02875000
         AL    @08,@CF01534                                        0916 02876000
         L     @10,ICTPEND(@10,@08)                                0916 02877000
         CL    @10,ICTENDNT                                        0916 02878000
         BNE   @DL00885                                            0916 02879000
*   RETURN CODE(SUPCHKRC);          /* RETURN W/ RC                  */ 02880000
         LR    @15,SUPCHKRC                                        0917 02881000
         L     @14,@SA00016                                        0917 02882000
         LM    @00,@12,@SA00016+8                                  0917 02883000
         BR    @14                                                 0917 02884000
*   RFY                                                            0918 02885000
*     ICTPTF BASED;                                                0918 02886000
*   RFY                                                            0919 02887000
*     ICTSUPLS BASED;                                              0919 02888000
*   RFY                                                            0920 02889000
*     TSLPARMS BASED;                                              0920 02890000
*   END SUPCHK;                                                    0921 02891000
*                                                                  0922 02892000
*   /*****************************************************************/ 02893000
*   /*                                                               */ 02894000
*   /* REQSTAT - SET STATUS FLAGS IN SPECIFIED INDEX ENTRIES         */ 02895000
*   /*                                                               */ 02896000
*   /*****************************************************************/ 02897000
*                                                                  0922 02898000
*REQSTAT:                                                          0922 02899000
*   PROC(REQSLST@,                  /* LIST ENTRY PTR                */ 02900000
*       REQSINCR);                  /* LIST ENTRY SIZE IN DOUBLE   0922 02901000
*                                      WORDS                         */ 02902000
REQSTAT  STM   @14,@12,@SA00017                                    0922 02903000
         MVC   @PC00017(8),0(@01)                                  0922 02904000
*   DCL                                                            0923 02905000
*     REQSLST@ PTR(31);             /*                               */ 02906000
*   DCL                                                            0924 02907000
*     REQSINCR FIXED(31);           /*                               */ 02908000
*   DCL                                                            0925 02909000
*     REQSRC FIXED(15);             /* LOCAL RETURN CODE             */ 02910000
*   DCL                                                            0926 02911000
*     REQSX1 FIXED(31);             /* INDEX FOR INDEX LIST SEARCH   */ 02912000
*   RFY                                                            0927 02913000
*     ICTENTLS BASED(REQSLST@);     /*                               */ 02914000
*   RFY                                                            0928 02915000
*     TSLPARMS BASED(TBLXTSLP);     /*                               */ 02916000
*   REQSRC=''B;                     /* CLEAR RETURN CODE             */ 02917000
         SLR   REQSRC,REQSRC                                       0929 02918000
*   DO REQSX1=1 BY REQSINCR         /*                               */ 02919000
*         WHILE(ICTENTND(REQSX1)^=ICTENDIX/*                         */ 02920000
*         &REQSRC<STOPSMD);         /*                               */ 02921000
         LA    REQSX1,1                                            0930 02922000
         B     @DE00930                                            0930 02923000
@DL00930 DS    0H                                                  0931 02924000
*     ICTEREQS(REQSX1)=ON;          /* SET EACH REQ AS SATISFIED TO     02925000
*                                      AVOID 'REQ NOT SATISIFIED' IN    02926000
*                                      THE SYSMOD REPORTS            */ 02927000
         LR    @10,REQSX1                                          0931 02928000
         SLA   @10,3                                               0931 02929000
         L     @08,@PC00017                                        0931 02930000
         L     @08,REQSLST@(,@08)                                  0931 02931000
         ST    @10,@TF00001                                        0931 02932000
         ALR   @10,@08                                             0931 02933000
         BCTR  @10,0                                               0931 02934000
         OI    ICTEREQS-7(@10),B'00010000'                         0931 02935000
*     TSLICTSR=''B;                 /* CLEAR ICT SEARCH FLAG         */ 02936000
         L     @10,@PC00001                                        0932 02937000
         L     @10,TBLXTSLP(,@10)                                  0932 02938000
         L     @15,TSLPMLAD(,@10)                                  0932 02939000
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      0932 02940000
*     TSLFUNCT=TSLFISRH;            /* TSB FUNCTION IS SEARCH ICT FOR   02941000
*                                      SMD ENTRY                     */ 02942000
         MVI   TSLFUNCT(@10),X'01'                                 0933 02943000
*     TSLISMD=ICTENTNM(REQSX1);     /* SEARCH FOR REQ IN THE ICT     */ 02944000
         AL    @08,@TF00001                                        0934 02945000
         AL    @08,@CF01537                                        0934 02946000
         MVC   TSLISMD(7,@15),ICTENTNM(@08)                        0934 02947000
*     CALL HMASMTSB(TSLPARMS);      /* ...                           */ 02948000
         ST    @10,@AL00001                                        0935 02949000
         L     @15,@CV01232                                        0935 02950000
         LA    @01,@AL00001                                        0935 02951000
         BALR  @14,@15                                             0935 02952000
*     IF TSLRETRN=TSLNTFND THEN     /* NOT IN THE ICT?               */ 02953000
         L     @10,@PC00001                                        0936 02954000
         L     @10,TBLXTSLP(,@10)                                  0936 02955000
         CLI   TSLRETRN(@10),4                                     0936 02956000
         BNE   @RF00936                                            0936 02957000
*       DO;                         /* YES,                          */ 02958000
*         ICTEREQT(REQSX1)=ON;      /* MARK REQ AS SATIFIED ON THE 0938 02959000
*                                      TARGET SYSTEM SO THAT HMASMCPL   02960000
*                                      WILL NOT WAIT FOR THE REQ TO     02961000
*                                      COMPLETE                      */ 02962000
         LR    @10,REQSX1                                          0938 02963000
         SLA   @10,3                                               0938 02964000
         L     @08,@PC00017                                        0938 02965000
         L     @08,REQSLST@(,@08)                                  0938 02966000
         ALR   @08,@10                                             0938 02967000
         BCTR  @08,0                                               0938 02968000
         OI    ICTEREQT-7(@08),B'00000010'                         0938 02969000
*       END;                        /*                               */ 02970000
*     ELSE                                                         0940 02971000
*       ;                           /* REQ SYSMOD IS IN THE ICT      */ 02972000
@RF00936 DS    0H                                                  0941 02973000
*   END;                                                           0941 02974000
         L     @10,@PC00017+4                                      0941 02975000
         AL    REQSX1,REQSINCR(,@10)                               0941 02976000
@DE00930 LR    @10,REQSX1                                          0941 02977000
         SLA   @10,3                                               0941 02978000
         L     @08,@PC00017                                        0941 02979000
         L     @08,REQSLST@(,@08)                                  0941 02980000
         AL    @08,@CF01537                                        0941 02981000
         L     @10,ICTENTND(@10,@08)                               0941 02982000
         CL    @10,ICTENDIX                                        0941 02983000
         BE    @DC00930                                            0941 02984000
         CH    REQSRC,@CH00055                                     0941 02985000
         BL    @DL00930                                            0941 02986000
@DC00930 DS    0H                                                  0942 02987000
*   RETURN CODE(REQSRC);            /* RETURN W/RETURN CODE          */ 02988000
         LR    @15,REQSRC                                          0942 02989000
         L     @14,@SA00017                                        0942 02990000
         LM    @00,@12,@SA00017+8                                  0942 02991000
         BR    @14                                                 0942 02992000
*   RFY                                                            0943 02993000
*     ICTENTLS BASED;                                              0943 02994000
*   RFY                                                            0944 02995000
*     TSLPARMS BASED;               /*                               */ 02996000
*   END REQSTAT;                                                   0945 02997000
*   END REQCHK;                                                    0946 02998000
*                                                                  0947 02999000
*   /*****************************************************************/ 03000000
*   /*                                                               */ 03001000
*   /* ELIMINATE UNPROCESSED SYSMODS                                 */ 03002000
*   /*                                                               */ 03003000
*   /*****************************************************************/ 03004000
*                                                                  0947 03005000
*COMPRESS:                                                         0947 03006000
*   PROC;                                                          0947 03007000
COMPRESS STM   @14,@12,12(@13)                                     0947 03008000
*   DCL                                                            0948 03009000
*     COMPRSRC FIXED(15);           /* LOCAL RETURN CODE             */ 03010000
*   DCL                                                            0949 03011000
*     CURPTR PTR(31);               /* CURRENT ICT PTF ENTRY         */ 03012000
*   DCL                                                            0950 03013000
*     NEWEND PTR(31);               /* NEW END OF ICT PTF SECTION    */ 03014000
*   RFY                                                            0951 03015000
*     ICTPTF BASED;                 /* NO BASE IS USED : EXPLICIT PTR   03016000
*                                      NOTATION IS                   */ 03017000
*   COMPRSRC=ZERO;                  /* CLEAR RETURN CODE             */ 03018000
         SLR   COMPRSRC,COMPRSRC                                   0952 03019000
*   NEWEND=CCAICPTF;                /* INITIALIZE THE 'MOVE TO' PTR  */ 03020000
         L     @10,CCAICPTF(,CCAPTR)                               0953 03021000
         LR    NEWEND,@10                                          0953 03022000
*   CURPTR=CCAICPTF;                /* INITIALIZE CURRENT SYSMOD   0954 03023000
*                                      ENTRY PTR                     */ 03024000
         LR    CURPTR,@10                                          0954 03025000
*   DO WHILE(CURPTR->ICTPEND(1)^=ICTENDNT);/* PROCESS ALL SYSMOD   0955 03026000
*                                      ENTRIES                       */ 03027000
         B     @DE00955                                            0955 03028000
@DL00955 DS    0H                                                  0956 03029000
*     IF CURPTR->ICTPRCND(1)=ON THEN/* IS SYSMOD A CANDIDATE?        */ 03030000
         TM    ICTPRCND(CURPTR),B'00010000'                        0956 03031000
         BNO   @RF00956                                            0956 03032000
*       DO;                         /* YES,                          */ 03033000
*         IF NEWEND^=CURPTR THEN    /* IS DATA MOVEMENT REQUIRED?    */ 03034000
         CR    NEWEND,CURPTR                                       0958 03035000
         BE    @RF00958                                            0958 03036000
*           DO;                     /* YES,                          */ 03037000
*             NEWEND->ICTPTF(1)=CURPTR->ICTPTF(1);/* MOVE ENTRY      */ 03038000
         MVC   ICTPTF(116,NEWEND),ICTPTF(CURPTR)                   0960 03039000
*           END;                                                   0961 03040000
*         ELSE                                                     0962 03041000
*           ;                       /* NO ENTRIES TO MOVE SINCE NONE    03042000
*                                      DELETED                       */ 03043000
@RF00958 DS    0H                                                  0963 03044000
*         NEWEND=NEWEND+LENGTH(ICTPTF(1));/* ADVANCE END POINTER     */ 03045000
         AH    NEWEND,@CH01508                                     0963 03046000
*       END;                                                       0964 03047000
*     ELSE                                                         0965 03048000
*       ;                           /* IS NOT A CANDIDATE            */ 03049000
@RF00956 DS    0H                                                  0966 03050000
*     CURPTR=CURPTR+LENGTH(ICTPTF(1));/* ADVANCE TO THE NEXT         */ 03051000
         AH    CURPTR,@CH01508                                     0966 03052000
*   END;                            /* END OF SYSMOD LOOP            */ 03053000
@DE00955 L     @10,ICTENDNT                                        0967 03054000
         CL    @10,ICTPEND(,CURPTR)                                0967 03055000
         BNE   @DL00955                                            0967 03056000
*   TBLXTOP=NEWEND;                 /* SET TOP OF FIXED PORTION      */ 03057000
         L     @08,@PC00001                                        0968 03058000
         ST    NEWEND,TBLXTOP(,@08)                                0968 03059000
*   TBLXTOP->ICTPEND(1)=ICTENDNT;   /* SET END OF SECTION INDICATOR  */ 03060000
         L     @08,@PC00001                                        0969 03061000
         L     @08,TBLXTOP(,@08)                                   0969 03062000
         ST    @10,ICTPEND(,@08)                                   0969 03063000
*   RETURN CODE(COMPRSRC);          /*                               */ 03064000
         LR    @15,COMPRSRC                                        0970 03065000
         L     @14,12(,@13)                                        0970 03066000
         LM    @00,@12,20(@13)                                     0970 03067000
         BR    @14                                                 0970 03068000
*   END COMPRESS;                                                  0971 03069000
*                                                                  0972 03070000
*   /*****************************************************************/ 03071000
*   /*                                                               */ 03072000
*   /* TPRCLEAN - TERMINATION CLEANUP                                */ 03073000
*   /*                                                               */ 03074000
*   /*****************************************************************/ 03075000
*                                                                  0972 03076000
*TPRCLEAN:                                                         0972 03077000
*   PROC;                                                          0972 03078000
TPRCLEAN STM   @14,@12,12(@13)                                     0972 03079000
*   DCL                                                            0973 03080000
*     CLEANRC FIXED(15);            /* LOCAL RETURN CODE             */ 03081000
*   CLEANRC=ZERO;                   /* CLEAR RETURN CODE             */ 03082000
         SLR   CLEANRC,CLEANRC                                     0974 03083000
*   RETURN CODE(CLEANRC);           /* RETURN W/ RC                  */ 03084000
         LR    @15,CLEANRC                                         0975 03085000
         L     @14,12(,@13)                                        0975 03086000
         LM    @00,@12,20(@13)                                     0975 03087000
         BR    @14                                                 0975 03088000
*   END TPRCLEAN;                                                  0976 03089000
*                                                                  0977 03090000
*/********************************************************************/ 03091000
*/*                                                                  */ 03092000
*/* SELFND                                                           */ 03093000
*/*                                                                  */ 03094000
*/* INPUT  - SYSMOD TO BE LOCATED IN THE SELECT/GROUP GTA FILE       */ 03095000
*/*                                                                  */ 03096000
*/* OUTPUT - "SYSMOD FOUND" FLAG IN THE SELECT/GROUP GTA RECORD      */ 03097000
*/*          FOR THE INPUT SYSMOD IF FOUND                           */ 03098000
*/*        - RETURN CODE:                                            */ 03099000
*/*           0 - FOUND IN THE GTA FILE                              */ 03100000
*/*           4 - NOT FOUND IN THE GTA FILE                          */ 03101000
*/*                                                                  */ 03102000
*/********************************************************************/ 03103000
*                                                                  0977 03104000
*SELFND:                                                           0977 03105000
*   PROC(SELFNAME);                 /* SYSMOD TO FIND                */ 03106000
SELFND   STM   @14,@12,@SA00020                                    0977 03107000
         MVC   @PC00020(4),0(@01)                                  0977 03108000
*   DCL                                                            0978 03109000
*     SELFNAME CHAR(LENGTH(IOPNAM17));/* SYSMOD NAME TO SEARCH FOR   */ 03110000
*   DCL                                                            0979 03111000
*     SELFNDRC FIXED(15);           /* RETURN CODE                   */ 03112000
*   RFY                                                            0980 03113000
*     HMASMGTP BASED(TBLXSEGT);                                    0980 03114000
*   RFY                                                            0981 03115000
*     HMASMSET BASED(GTPBUFAD);                                    0981 03116000
*   SELFNDRC=ZERO;                  /* CLEAR RETURN CODE             */ 03117000
         SLR   SELFNDRC,SELFNDRC                                   0982 03118000
*                                                                  0983 03119000
*   /*****************************************************************/ 03120000
*   /*                                                               */ 03121000
*   /* INTIALIZE FOR SEARCH OF SELECT/GROUP LIST                     */ 03122000
*   /*                                                               */ 03123000
*   /*****************************************************************/ 03124000
*                                                                  0983 03125000
*   HMASMSET=''B;                   /* CLEAR BUFFER                  */ 03126000
         L     @10,@PC00001                                        0983 03127000
         L     @10,TBLXSEGT(,@10)                                  0983 03128000
         L     @08,GTPBUFAD(,@10)                                  0983 03129000
         XC    HMASMSET(12,@08),HMASMSET(@08)                      0983 03130000
*   SESMD=ON;                       /* SELECT LIST TYPE IS SYSMOD    */ 03131000
         OI    SESMD(@08),B'00000001'                              0984 03132000
*   SENAME=' ';                     /* BLANK SELECT NAME             */ 03133000
         MVI   SENAME+1(@08),C' '                                  0985 03134000
         MVC   SENAME+2(6,@08),SENAME+1(@08)                       0985 03135000
         MVI   SENAME(@08),C' '                                    0985 03136000
*   GTPFUNCT=GTPLOC;                /* GTP FUNCTION IS LOCATE        */ 03137000
         MVI   GTPFUNCT(@10),X'03'                                 0986 03138000
*   SESMDNO=SELFNAME;               /* SEARCH FOR GIVEN SYSMOD       */ 03139000
         L     @03,@PC00020                                        0987 03140000
         MVC   SESMDNO(7,@08),SELFNAME(@03)                        0987 03141000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 03142000
         ST    @10,@AL00001                                        0988 03143000
         L     @15,@CV01233                                        0988 03144000
         LA    @01,@AL00001                                        0988 03145000
         BALR  @14,@15                                             0988 03146000
*   IF GTPRETRN^=GTPGOOD THEN       /* NOT FOUND?                    */ 03147000
         L     @10,@PC00001                                        0989 03148000
         L     @10,TBLXSEGT(,@10)                                  0989 03149000
         CLI   GTPRETRN(@10),0                                     0989 03150000
         BE    @RF00989                                            0989 03151000
*     DO;                           /* YES,                          */ 03152000
*       SELFNDRC=GTPNTFND;          /* NOT FOUND RETURN CODED        */ 03153000
         LA    SELFNDRC,4                                          0991 03154000
*     END;                                                         0992 03155000
*   ELSE                            /* FOUND                         */ 03156000
*     DO;                                                          0993 03157000
         B     @RC00989                                            0993 03158000
@RF00989 DS    0H                                                  0994 03159000
*       SEFLAG2A=ON;                /* MARK SELECT ENTRY AS FOUND ON    03160000
*                                      CDS                           */ 03161000
         L     @10,@PC00001                                        0994 03162000
         L     @10,TBLXSEGT(,@10)                                  0994 03163000
         L     @08,GTPBUFAD(,@10)                                  0994 03164000
         OI    SEFLAG2A(@08),B'10000000'                           0994 03165000
*       GTPFUNCT=GTPADD;            /* ADD ENTRY BACK WITH FLAG SET  */ 03166000
         MVI   GTPFUNCT(@10),X'04'                                 0995 03167000
*       CALL HMASMGTA(HMASMGTP);    /* ...                           */ 03168000
         ST    @10,@AL00001                                        0996 03169000
         L     @15,@CV01233                                        0996 03170000
         LA    @01,@AL00001                                        0996 03171000
         BALR  @14,@15                                             0996 03172000
*       SELFNDRC=MAX(SELFNDRC,GTPRETRN);/* SAVE THE RETURN CODE      */ 03173000
         L     @10,@PC00001                                        0997 03174000
         L     @10,TBLXSEGT(,@10)                                  0997 03175000
         SLR   @08,@08                                             0997 03176000
         IC    @08,GTPRETRN(,@10)                                  0997 03177000
         CR    SELFNDRC,@08                                        0997 03178000
         BNL   *+6                                                      03179000
         LR    SELFNDRC,@08                                        0997 03180000
*     END;                                                         0998 03181000
*   RETURN CODE(SELFNDRC);          /* RETURN W/ RC                  */ 03182000
@RC00989 LR    @15,SELFNDRC                                        0999 03183000
         L     @14,@SA00020                                        0999 03184000
         LM    @00,@12,@SA00020+8                                  0999 03185000
         BR    @14                                                 0999 03186000
*   RFY                                                            1000 03187000
*     HMASMGTP BASED;                                              1000 03188000
*   RFY                                                            1001 03189000
*     HMASMSET BASED;                                              1001 03190000
*   END SELFND;                                                    1002 03191000
*   END HMASMTPR                    /*                               */ 03192000
*                                                                  1003 03193000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03194000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 03195000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 03196000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 03197000
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */ 03198000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 03199000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 03200000
*                                                                  1003 03201000
*       ;                                                          1003 03202000
@DATA    DS    0H                                                       03203000
@CH00037 DC    H'4'                                                     03204000
@CH00065 DC    H'7'                                                     03205000
@CH00055 DC    H'8'                                                     03206000
@CH00033 DC    H'12'                                                    03207000
@CH01237 DC    H'46'                                                    03208000
@CH01245 DC    H'99'                                                    03209000
@CH00349 DC    H'100'                                                   03210000
@CH01508 DC    H'116'                                                   03211000
@CH01248 DC    H'120'                                                   03212000
@CH01239 DC    H'229'                                                   03213000
@CH01241 DC    H'234'                                                   03214000
         DS    0F                                                       03215000
@AL00372 EQU   *                       LIST WITH   1 ARGUMENT(S)        03216000
@AL00424 EQU   *                       LIST WITH   1 ARGUMENT(S)        03217000
@AL00444 EQU   *                       LIST WITH   1 ARGUMENT(S)        03218000
@AL00545 EQU   *                       LIST WITH   1 ARGUMENT(S)        03219000
@AL00601 EQU   *                       LIST WITH   1 ARGUMENT(S)        03220000
@AL00850 EQU   *                       LIST WITH   1 ARGUMENT(S)        03221000
@AL00904 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        03222000
         DS    0F                                                       03223000
@SA00001 DS    18F                                                      03224000
@PC00001 DS    1F                                                       03225000
@SA00003 DS    14F                                                      03226000
@PC00003 DS    1F                                                       03227000
@SA00012 DS    15F                                                      03228000
@SA00015 DS    15F                                                      03229000
@SA00005 DS    15F                                                      03230000
@SA00007 DS    15F                                                      03231000
@SA00008 DS    15F                                                      03232000
@SA00006 DS    15F                                                      03233000
@PC00006 DS    1F                                                       03234000
@SA00017 DS    0F                                                       03235000
@PC00017 EQU   @SA00017+60                                              03236000
@SA00016 DS    0F                                                       03237000
@SA00014 DS    0F                                                       03238000
@PC00014 EQU   @SA00014+60                                              03239000
@SA00013 DS    0F                                                       03240000
@PC00013 EQU   @SA00013+60                                              03241000
@SA00020 DS    0F                                                       03242000
@PC00020 EQU   @SA00020+60                                              03243000
@SA00004 DS    0F                                                       03244000
@PC00004 EQU   @SA00004+60                                              03245000
@SA00011 DS    0F                                                       03246000
@PC00011 EQU   @SA00011+60                                              03247000
@SA00010 DS    0F                                                       03248000
@PC00010 EQU   @SA00010+60                                              03249000
@SA00009 DS    0F                                                       03250000
         DS    17F                                                      03251000
@AL00001 DS    4A                                                       03252000
@TF00001 DS    F                                                        03253000
@AFTEMPS DS    1F                                                       03254000
         DS    0F                                                       03255000
@CF00081 DC    F'0'                                                     03256000
@CF00063 DC    F'1'                                                     03257000
@CH00063 EQU   @CF00063+2                                               03258000
@CF00273 DC    F'2'                                                     03259000
@CF01534 DC    F'-116'                                                  03260000
@CF01538 DC    F'-108'                                                  03261000
@CF01539 DC    F'-107'                                                  03262000
@CF01532 DC    F'-104'                                                  03263000
@CF01531 DC    F'-99'                                                   03264000
@CF01533 DC    F'-94'                                                   03265000
@CF01535 DC    F'-48'                                                   03266000
@CF01540 DC    F'-40'                                                   03267000
@CF01536 DC    F'-36'                                                   03268000
@CF01541 DC    F'-20'                                                   03269000
@CF01537 DC    F'-8'                                                    03270000
@CV01228 DC    V(HMASMIO)                                               03271000
@CV01229 DC    V(HMASMMSG)                                              03272000
@CV01230 DC    V(HMASMTAD)                                              03273000
@CV01231 DC    V(HMASMTEC)                                              03274000
@CV01232 DC    V(HMASMTSB)                                              03275000
@CV01233 DC    V(HMASMGTA)                                              03276000
         DS    0D                                                       03277000
SMDICT@  DS    A                                                        03278000
@CC01388 DC    C'P'                                                     03279000
         DS    CL3                                                      03280000
ICTENDCH DC    X'FFFFFFFF'                                              03281000
HMASMMGP DS    CL28                                                     03282000
         ORG   HMASMMGP                                                 03283000
MGPFIXED DS    CL12                                                     03284000
         ORG   MGPFIXED                                                 03285000
MGPCLEAR DS    CL6                                                      03286000
         ORG   MGPCLEAR                                                 03287000
MGPMGNO1 DS    FL2                                                      03288000
MGPMGNO2 DS    FL2                                                      03289000
MGPMGNO3 DS    FL2                                                      03290000
         ORG   MGPFIXED+6                                               03291000
MGPFLAGS DS    BL2                                                      03292000
         ORG   MGPFLAGS                                                 03293000
MGPPRINT DS    BL1                                                      03294000
MGPLIST  EQU   MGPFLAGS+0                                               03295000
MGPRPT   EQU   MGPFLAGS+0                                               03296000
MGPHLDS  EQU   MGPFLAGS+0                                               03297000
MGPWTOR  EQU   MGPFLAGS+0                                               03298000
MGPWTO   EQU   MGPFLAGS+0                                               03299000
MGPWTP   EQU   MGPFLAGS+0                                               03300000
@NM00140 EQU   MGPFLAGS+0                                               03301000
         ORG   MGPFIXED+8                                               03302000
MGPTYPE  DS    FL1                                                      03303000
@NM00141 DS    CL3                                                      03304000
         ORG   HMASMMGP+12                                              03305000
MGPVAR   DS    CL16                                                     03306000
         ORG   MGPVAR                                                   03307000
MGPVARPT DS    4A                                                       03308000
         ORG   HMASMMGP+28                                              03309000
PATCHTPR DS    CL80                                                     03310000
         ORG   PATCHTPR                                                 03311000
@NM00142 DC    80X'FF'                                                  03312000
         ORG   PATCHTPR+80                                              03313000
TPRFLAGS DS    CL1                                                      03314000
         ORG   TPRFLAGS                                                 03315000
@NM00143 DS    BL1                                                      03316000
         ORG   TPRFLAGS+1                                               03317000
LSTFLAGS DS    CL2                                                      03318000
         ORG   LSTFLAGS                                                 03319000
LST1SMD  DS    BL1                                                      03320000
LST2SMD  EQU   LSTFLAGS+0                                               03321000
CDSEOF   EQU   LSTFLAGS+0                                               03322000
ACDSEOF  EQU   LSTFLAGS+0                                               03323000
GETCDS   EQU   LSTFLAGS+0                                               03324000
ACDSGET  EQU   LSTFLAGS+0                                               03325000
LSTENT1  EQU   LSTFLAGS+0                                               03326000
LSTENT2  EQU   LSTFLAGS+0                                               03327000
@NM00145 DS    BL1                                                      03328000
         ORG   LSTFLAGS+2                                               03329000
CDSFLAGS DS    CL1                                                      03330000
         ORG   CDSFLAGS                                                 03331000
CDSVALID DS    BL1                                                      03332000
@NM00146 EQU   CDSFLAGS+0                                               03333000
         ORG   CDSFLAGS+1                                               03334000
ACDSFLGS DS    CL1                                                      03335000
         ORG   ACDSFLGS                                                 03336000
ACDSVALD DS    BL1                                                      03337000
@NM00147 EQU   ACDSFLGS+0                                               03338000
         ORG   ACDSFLGS+1                                               03339000
SELCFLGS DS    CL1                                                      03340000
         ORG   SELCFLGS                                                 03341000
SELCEOF  DS    BL1                                                      03342000
@NM00148 EQU   SELCFLGS+0                                               03343000
         ORG   SELCFLGS+1                                               03344000
SMDIFLGS DS    CL1                                                      03345000
         ORG   SMDIFLGS                                                 03346000
SRELFND  DS    BL1                                                      03347000
@NM00149 EQU   SMDIFLGS+0                                               03348000
         ORG   SMDIFLGS+1                                               03349000
GRPFLAGS DS    BL1                                                      03350000
         ORG   GRPFLAGS                                                 03351000
GRPADD   DS    BL1                                                      03352000
@NM00150 EQU   GRPFLAGS+0                                               03353000
         ORG   GRPFLAGS+1                                               03354000
SET2FLGS DS    CL1                                                      03355000
         ORG   SET2FLGS                                                 03356000
SET2END  DS    BL1                                                      03357000
@NM00151 EQU   SET2FLGS+0                                               03358000
         ORG   SET2FLGS+1                                               03359000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03360000
@01      EQU   01                                                       03361000
@02      EQU   02                                                       03362000
@03      EQU   03                                                       03363000
@04      EQU   04                                                       03364000
@05      EQU   05                                                       03365000
@06      EQU   06                                                       03366000
@07      EQU   07                                                       03367000
@08      EQU   08                                                       03368000
@09      EQU   09                                                       03369000
@10      EQU   10                                                       03370000
@11      EQU   11                                                       03371000
@12      EQU   12                                                       03372000
@13      EQU   13                                                       03373000
@14      EQU   14                                                       03374000
@15      EQU   15                                                       03375000
SELFNDRC EQU   @02                                                      03376000
CLEANRC  EQU   @02                                                      03377000
NEWEND   EQU   @03                                                      03378000
CURPTR   EQU   @02                                                      03379000
COMPRSRC EQU   @04                                                      03380000
REQSX1   EQU   @02                                                      03381000
REQSRC   EQU   @03                                                      03382000
SUPCSUPX EQU   @03                                                      03383000
SUPCSMDX EQU   @02                                                      03384000
SUPCHKRC EQU   @04                                                      03385000
REQCSMDX EQU   @02                                                      03386000
REQCHKRC EQU   @03                                                      03387000
SET2RC   EQU   @02                                                      03388000
SETRC    EQU   @02                                                      03389000
SETX     EQU   @03                                                      03390000
GRPX2    EQU   @02                                                      03391000
GRPPTFX  EQU   @03                                                      03392000
GRPRC    EQU   @04                                                      03393000
DT2RC    EQU   @02                                                      03394000
SMDICTRC EQU   @03                                                      03395000
SELCHKRC EQU   @02                                                      03396000
LSTCRC   EQU   @03                                                      03397000
ACDSRC   EQU   @03                                                      03398000
CDSRRC   EQU   @03                                                      03399000
CDSRC    EQU   @03                                                      03400000
LSTGETRC EQU   @02                                                      03401000
LST2IOP@ EQU   @05                                                      03402000
LST1IOP@ EQU   @04                                                      03403000
LSTBLDRC EQU   @06                                                      03404000
TPRINTRC EQU   @02                                                      03405000
TPRRC    EQU   @03                                                      03406000
CCAPTR   EQU   @11                                                      03407000
RTNCODE  EQU   @15                                                      03408000
RTNREG   EQU   @14                                                      03409000
TBLXOPTS EQU   0                                                        03410000
TBLFLAGS EQU   TBLXOPTS+8                                               03411000
TBLFLG1  EQU   TBLFLAGS                                                 03412000
TBLFLG2  EQU   TBLFLAGS+2                                               03413000
TBLGROUP EQU   TBLFLG2                                                  03414000
TBLFLG3  EQU   TBLFLAGS+3                                               03415000
TBLFLG4  EQU   TBLFLAGS+5                                               03416000
TBLFLG5  EQU   TBLFLAGS+7                                               03417000
HMASMCCA EQU   0                                                        03418000
CCAFBUFR EQU   HMASMCCA+4                                               03419000
CCADSAD  EQU   CCAFBUFR+124                                             03420000
CCATPAD  EQU   CCAFBUFR+128                                             03421000
CCAFLAG7 EQU   CCAFBUFR+132                                             03422000
CCAFIOP  EQU   HMASMCCA+140                                             03423000
CCAIOPTR EQU   CCAFIOP                                                  03424000
CCAFSYS  EQU   HMASMCCA+148                                             03425000
CCASREL  EQU   CCAFSYS+12                                               03426000
CCAFLAGA EQU   CCAFSYS+21                                               03427000
CCAFSTA  EQU   HMASMCCA+188                                             03428000
CCAFICT  EQU   HMASMCCA+192                                             03429000
CCAICPTF EQU   CCAFICT+4                                                03430000
CCAFPGM  EQU   HMASMCCA+208                                             03431000
CCABLDLP EQU   CCAFPGM                                                  03432000
CCADBLDL EQU   CCAFPGM+4                                                03433000
CCAFGTP  EQU   HMASMCCA+224                                             03434000
CCASEGTP EQU   CCAFGTP                                                  03435000
@NM00023 EQU   HMASMCCA+244                                             03436000
CCAFFUNC EQU   HMASMCCA+264                                             03437000
CCAFLAG1 EQU   CCAFFUNC+8                                               03438000
CCAFLAG2 EQU   CCAFFUNC+11                                              03439000
CCAFPROC EQU   HMASMCCA+276                                             03440000
CCAFLAG3 EQU   CCAFPROC                                                 03441000
CCAFDIS  EQU   HMASMCCA+278                                             03442000
CCAFLAG4 EQU   CCAFDIS                                                  03443000
CCAFLAG5 EQU   CCAFDIS+1                                                03444000
CCAFLAG6 EQU   CCAFDIS+2                                                03445000
CCAFCNV  EQU   HMASMCCA+281                                             03446000
CCAFLAG8 EQU   CCAFCNV                                                  03447000
CCAFCTL  EQU   HMASMCCA+282                                             03448000
CCAFLAG9 EQU   CCAFCTL                                                  03449000
CCAFDSNG EQU   HMASMCCA+298                                             03450000
CCAFLAGB EQU   CCAFDSNG                                                 03451000
CCADSIDA EQU   0                                                        03452000
CCABLDLA EQU   0                                                        03453000
@NM00039 EQU   CCABLDLA                                                 03454000
CCABLDLL EQU   0                                                        03455000
@NM00041 EQU   CCABLDLL                                                 03456000
CCALKDRC EQU   @NM00041+20                                              03457000
@NM00043 EQU   CCABLDLL+124                                             03458000
CCAASMRC EQU   @NM00043+20                                              03459000
@NM00045 EQU   CCABLDLL+248                                             03460000
CCACPYRC EQU   @NM00045+20                                              03461000
@NM00047 EQU   CCABLDLL+372                                             03462000
CCACOMRC EQU   @NM00047+20                                              03463000
@NM00049 EQU   CCABLDLL+496                                             03464000
CCAZAPRC EQU   @NM00049+20                                              03465000
@NM00051 EQU   CCABLDLL+620                                             03466000
CCASUPRC EQU   @NM00051+20                                              03467000
@NM00053 EQU   CCABLDLL+744                                             03468000
CCAUPDRC EQU   @NM00053+20                                              03469000
CCABLDLM EQU   0                                                        03470000
CCABELMT EQU   CCABLDLM+4                                               03471000
CCABMPOS EQU   CCABELMT                                                 03472000
HMASMIOP EQU   0                                                        03473000
IOPDSID  EQU   HMASMIOP                                                 03474000
IOPFUNCT EQU   HMASMIOP+1                                               03475000
IOPRETRN EQU   HMASMIOP+2                                               03476000
IOPTYPE  EQU   HMASMIOP+3                                               03477000
IOPNAME  EQU   HMASMIOP+4                                               03478000
IOPNAM17 EQU   IOPNAME                                                  03479000
@NM00057 EQU   HMASMIOP+12                                              03480000
@NM00058 EQU   @NM00057                                                 03481000
IOPDDNAM EQU   HMASMIOP+24                                              03482000
IOPDRMAP EQU   HMASMIOP+56                                              03483000
IOPINAME EQU   IOPDRMAP                                                 03484000
IOPINAM  EQU   IOPINAME                                                 03485000
IOPITYP  EQU   IOPINAM                                                  03486000
IOPUSERL EQU   IOPDRMAP+11                                              03487000
IOPEND   EQU   IOPDRMAP+12                                              03488000
ICTPTF   EQU   0                                                        03489000
ICTPTFS  EQU   ICTPTF                                                   03490000
ICTPEND  EQU   ICTPTFS                                                  03491000
ICTPFLG1 EQU   ICTPTF+7                                                 03492000
ICTPFLG3 EQU   ICTPTF+8                                                 03493000
ICTPPROC EQU   ICTPFLG3                                                 03494000
ICTPNOGO EQU   ICTPFLG3                                                 03495000
ICTPCPL  EQU   ICTPFLG3                                                 03496000
ICTPMSG  EQU   ICTPFLG3                                                 03497000
ICTPSLST EQU   ICTPFLG3                                                 03498000
ICTPFLG5 EQU   ICTPTF+9                                                 03499000
ICTPDELP EQU   ICTPFLG5                                                 03500000
ICTPFLG6 EQU   ICTPTF+11                                                03501000
ICTPFLF  EQU   ICTPFLG6                                                 03502000
ICTPFLG2 EQU   ICTPTF+12                                                03503000
ICTPRCND EQU   ICTPFLG2                                                 03504000
ICTPFLG4 EQU   ICTPTF+13                                                03505000
ICTPFLG8 EQU   ICTPTF+14                                                03506000
ICTPFLG9 EQU   ICTPTF+15                                                03507000
@NM00100 EQU   ICTPFLG9                                                 03508000
ICTPFLGA EQU   ICTPTF+16                                                03509000
ICTPUSR1 EQU   ICTPFLGA                                                 03510000
ICTPTYPE EQU   ICTPTF+17                                                03511000
ICTPFMID EQU   ICTPTF+22                                                03512000
ICTPCHN  EQU   ICTPTF+64                                                03513000
ICTPRCHN EQU   ICTPTF+68                                                03514000
ICTPSCHN EQU   ICTPTF+72                                                03515000
ICTPPCHN EQU   ICTPTF+76                                                03516000
ICTPICHN EQU   ICTPTF+80                                                03517000
ICTPNCHN EQU   ICTPTF+84                                                03518000
ICTPVCHN EQU   ICTPTF+88                                                03519000
ICTPDCHN EQU   ICTPTF+92                                                03520000
ICTPBCHN EQU   ICTPTF+96                                                03521000
ICTIXPF  EQU   0                                                        03522000
ICTENTLS EQU   0                                                        03523000
ICTENTNT EQU   ICTENTLS                                                 03524000
ICTENTNM EQU   ICTENTNT                                                 03525000
ICTENTND EQU   ICTENTNM                                                 03526000
ICTENTST EQU   ICTENTNT+7                                               03527000
ICTEREQS EQU   ICTENTST                                                 03528000
ICTEREQT EQU   ICTENTST                                                 03529000
ICTREQLS EQU   0                                                        03530000
ICTREQNT EQU   ICTREQLS                                                 03531000
ICTREQNM EQU   ICTREQNT                                                 03532000
ICTREQST EQU   ICTREQNT+7                                               03533000
ICTSUPLS EQU   0                                                        03534000
ICTSUPNT EQU   ICTSUPLS                                                 03535000
ICTSUPNM EQU   ICTSUPNT                                                 03536000
ICTPRELS EQU   0                                                        03537000
ICTPRENT EQU   ICTPRELS                                                 03538000
ICTPRENM EQU   ICTPRENT                                                 03539000
ICTPREST EQU   ICTPRENT+7                                               03540000
ICTIRQLS EQU   0                                                        03541000
ICTIRQNT EQU   ICTIRQLS                                                 03542000
ICTIRQNM EQU   ICTIRQNT                                                 03543000
ICTIRQST EQU   ICTIRQNT+7                                               03544000
ICTCSRST EQU   ICTIRQNT+15                                              03545000
ICTNPRLS EQU   0                                                        03546000
ICTNPRNT EQU   ICTNPRLS                                                 03547000
ICTNPRNM EQU   ICTNPRNT                                                 03548000
ICTVRSLS EQU   0                                                        03549000
ICTVRSNT EQU   ICTVRSLS                                                 03550000
ICTVRSNM EQU   ICTVRSNT                                                 03551000
ICTDELLS EQU   0                                                        03552000
ICTDELNT EQU   ICTDELLS                                                 03553000
ICTDELNM EQU   ICTDELNT                                                 03554000
ICTDELST EQU   ICTDELNT+7                                               03555000
ICTSBYLS EQU   0                                                        03556000
ICTSBYNT EQU   ICTSBYLS                                                 03557000
ICTSBYNM EQU   ICTSBYNT                                                 03558000
ICTSBYND EQU   ICTSBYNM                                                 03559000
HMASMSET EQU   0                                                        03560000
SELSTENT EQU   HMASMSET                                                 03561000
SELSTFLG EQU   SELSTENT                                                 03562000
SESMD    EQU   SELSTFLG                                                 03563000
SENAME   EQU   SELSTENT+2                                               03564000
SESMDNO  EQU   SENAME                                                   03565000
SEFLAGS  EQU   HMASMSET+10                                              03566000
SEFLAG2  EQU   HMASMSET+11                                              03567000
SEFLAG2A EQU   SEFLAG2                                                  03568000
HMASMGTP EQU   0                                                        03569000
GTPFUNCT EQU   HMASMGTP                                                 03570000
GTPRETRN EQU   HMASMGTP+1                                               03571000
GTPBUFAD EQU   HMASMGTP+12                                              03572000
GTPRESTR EQU   HMASMGTP+16                                              03573000
GTPFLGS1 EQU   HMASMGTP+26                                              03574000
SCLMAP   EQU   0                                                        03575000
SCLKEY   EQU   SCLMAP                                                   03576000
SCLDATA  EQU   SCLMAP+15                                                03577000
SCLSTAT  EQU   SCLDATA                                                  03578000
TSLPARMS EQU   0                                                        03579000
TSLPMLAD EQU   TSLPARMS+4                                               03580000
TSLFUNCT EQU   TSLPARMS+8                                               03581000
TSLRETRN EQU   TSLPARMS+9                                               03582000
TSLICTSR EQU   0                                                        03583000
TSLISMD  EQU   TSLICTSR                                                 03584000
TSLIOPTF EQU   TSLICTSR+7                                               03585000
TSLICTP  EQU   TSLICTSR+8                                               03586000
TSLICTF  EQU   TSLICTSR+12                                              03587000
TSLIFND  EQU   TSLICTF                                                  03588000
TSLLSTSR EQU   0                                                        03589000
TSLLSMD  EQU   TSLLSTSR                                                 03590000
TSLLOPTF EQU   TSLLSTSR+7                                               03591000
TSLLONXT EQU   TSLLOPTF                                                 03592000
TSLLOFST EQU   TSLLSTSR+8                                               03593000
TSLLRTNP EQU   TSLLSTSR+12                                              03594000
TSLGET   EQU   0                                                        03595000
TSLGOPTF EQU   TSLGET+7                                                 03596000
TSLSICDS EQU   0                                                        03597000
TSLSOPTF EQU   TSLSICDS+7                                               03598000
TSLSICTF EQU   TSLSICDS+16                                              03599000
TSLSCDSF EQU   TSLSICDS+18                                              03600000
TSLENTSR EQU   0                                                        03601000
TSLEOPTF EQU   TSLENTSR+2                                               03602000
TSLMFUNC EQU   0                                                        03603000
TSLMTYPE EQU   TSLMFUNC                                                 03604000
TSLMSMD  EQU   TSLMFUNC+1                                               03605000
TSLRELM  EQU   0                                                        03606000
D2RCRD   EQU   0                                                        03607000
D2RKEY   EQU   D2RCRD                                                   03608000
D2RSMD   EQU   D2RKEY                                                   03609000
D2RDATA  EQU   D2RCRD+7                                                 03610000
D2RFLAGS EQU   D2RDATA                                                  03611000
D2RFOK   EQU   D2RFLAGS                                                 03612000
D2RFERR  EQU   D2RFLAGS                                                 03613000
D2RFDEL  EQU   D2RFLAGS                                                 03614000
LSTSMD1  EQU   0                                                        03615000
LSTSMD2  EQU   0                                                        03616000
CCATYPEA EQU   0                                                        03617000
TBLXPARM EQU   0                                                        03618000
TBLXINDX EQU   TBLXPARM+4                                               03619000
TBLXIOPF EQU   TBLXPARM+20                                              03620000
TBLXSEGT EQU   TBLXPARM+24                                              03621000
TBLXTBL  EQU   TBLXPARM+28                                              03622000
TBLXTOP  EQU   TBLXPARM+32                                              03623000
TBLXFUNC EQU   TBLXPARM+64                                              03624000
TBLXFLG1 EQU   TBLXPARM+80                                              03625000
TBLXTSLP EQU   TBLXPARM+84                                              03626000
TBLXRC   EQU   TBLXPARM+92                                              03627000
TBLXD2GT EQU   TBLXPARM+100                                             03628000
LSTIOP   EQU   0                                                        03629000
GLMGIOP  EQU   0                                                        03630000
CDSRCIOP EQU   0                                                        03631000
SMDIIOP  EQU   0                                                        03632000
DT2IOP   EQU   0                                                        03633000
SETNDX@  EQU   0                                                        03634000
SETINCR  EQU   0                                                        03635000
SET2ENT  EQU   0                                                        03636000
SET2OFST EQU   0                                                        03637000
REQSLST@ EQU   0                                                        03638000
REQSINCR EQU   0                                                        03639000
SELFNAME EQU   0                                                        03640000
IOPUDATA EQU   IOPEND                                                   03641000
IOPNTMAP EQU   IOPDRMAP                                                 03642000
IOPCDMAP EQU   IOPNTMAP                                                 03643000
IOPPTMAP EQU   IOPCDMAP                                                 03644000
IOPSCMAP EQU   IOPPTMAP                                                 03645000
IOPDIRCT EQU   IOPSCMAP+12                                              03646000
IOPCDMAX EQU   IOPDIRCT                                                 03647000
IOPPTFNT EQU   IOPUDATA                                                 03648000
IOPPTFDR EQU   IOPPTFNT                                                 03649000
IOPPTYPE EQU   IOPPTFDR+1                                               03650000
IOPPSTAT EQU   IOPPTFDR+2                                               03651000
IOPPTFF1 EQU   IOPPSTAT                                                 03652000
IOPFLGS5 EQU   IOPPTFF1                                                 03653000
IOPERROR EQU   IOPFLGS5                                                 03654000
IOPDUMMP EQU   IOPFLGS5                                                 03655000
IOPPTFF2 EQU   IOPPSTAT+1                                               03656000
IOPDELP  EQU   IOPPTFF2                                                 03657000
IOPPTFF3 EQU   IOPPSTAT+3                                               03658000
IOPSBYP  EQU   IOPPTFF3                                                 03659000
IOPDBYP  EQU   IOPPTFF3                                                 03660000
IOPPTFFX EQU   IOPPTFNT+24                                              03661000
@NM00072 EQU   IOPPTFFX                                                 03662000
@NM00073 EQU   @NM00072                                                 03663000
IOPPDTES EQU   IOPPTFFX+41                                              03664000
@NM00076 EQU   IOPPDTES                                                 03665000
IOPPTPFX EQU   IOPPDTES+6                                               03666000
IOPDATES EQU   IOPPTPFX                                                 03667000
IOPPTEND EQU   IOPPTFNT+104                                             03668000
IOPPTFVR EQU   IOPPTEND                                                 03669000
IOPPNTRY EQU   IOPPTFVR                                                 03670000
IOPPMODS EQU   IOPPNTRY                                                 03671000
IOPENTNT EQU   IOPUDATA+104                                             03672000
IOPSRLNT EQU   IOPUDATA+104                                             03673000
IOPPRENT EQU   IOPUDATA+104                                             03674000
IOPNPRNT EQU   IOPUDATA+104                                             03675000
IOPSUPNT EQU   IOPUDATA+104                                             03676000
IOPREQNT EQU   IOPUDATA+104                                             03677000
IOPIRQNT EQU   IOPUDATA+104                                             03678000
IOPFIDNT EQU   IOPUDATA+104                                             03679000
IOPDELNT EQU   IOPUDATA+104                                             03680000
IOPVERNT EQU   IOPUDATA+104                                             03681000
IOPSBYNT EQU   IOPUDATA+104                                             03682000
ICTENDNT EQU   ICTENDCH                                                 03683000
ICTENDIX EQU   ICTENDCH                                                 03684000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03685000
@NM00089 EQU   IOPSBYNT+8                                               03686000
IOPSBYST EQU   IOPSBYNT+7                                               03687000
IOPSBYNM EQU   IOPSBYNT                                                 03688000
@NM00088 EQU   IOPVERNT+8                                               03689000
IOPVERST EQU   IOPVERNT+7                                               03690000
IOPVERNM EQU   IOPVERNT                                                 03691000
@NM00087 EQU   IOPDELNT+8                                               03692000
IOPDELST EQU   IOPDELNT+7                                               03693000
IOPDELNM EQU   IOPDELNT                                                 03694000
@NM00086 EQU   IOPFIDNT+8                                               03695000
IOPFIDST EQU   IOPFIDNT+7                                               03696000
IOPFIDNM EQU   IOPFIDNT                                                 03697000
@NM00085 EQU   IOPIRQNT+8                                               03698000
IOPIRQST EQU   IOPIRQNT+7                                               03699000
IOPIRQNM EQU   IOPIRQNT                                                 03700000
@NM00084 EQU   IOPREQNT+8                                               03701000
IOPREQST EQU   IOPREQNT+7                                               03702000
IOPREQNM EQU   IOPREQNT                                                 03703000
@NM00083 EQU   IOPSUPNT+8                                               03704000
IOPSUPST EQU   IOPSUPNT+7                                               03705000
IOPSUPNM EQU   IOPSUPNT                                                 03706000
@NM00082 EQU   IOPNPRNT+8                                               03707000
IOPNPRST EQU   IOPNPRNT+7                                               03708000
IOPNPRNM EQU   IOPNPRNT                                                 03709000
@NM00081 EQU   IOPPRENT+8                                               03710000
IOPPREST EQU   IOPPRENT+7                                               03711000
IOPPRENM EQU   IOPPRENT                                                 03712000
@NM00080 EQU   IOPSRLNT+8                                               03713000
IOPSRLST EQU   IOPSRLNT+7                                               03714000
@NM00079 EQU   IOPSRLNT+4                                               03715000
IOPSRLNM EQU   IOPSRLNT                                                 03716000
@NM00078 EQU   IOPENTNT+8                                               03717000
IOPENTST EQU   IOPENTNT+7                                               03718000
IOPENTNM EQU   IOPENTNT                                                 03719000
IOPPIND  EQU   IOPPNTRY+8                                               03720000
IOPPTFND EQU   IOPPMODS                                                 03721000
IOPPFMID EQU   IOPPTFFX+73                                              03722000
@NM00077 EQU   IOPPTPFX+24                                              03723000
IOPUCLT  EQU   IOPDATES+21                                              03724000
IOPUCLD  EQU   IOPDATES+18                                              03725000
IOPACCT  EQU   IOPDATES+15                                              03726000
IOPACCD  EQU   IOPDATES+12                                              03727000
IOPRSTT  EQU   IOPDATES+9                                               03728000
IOPRSTD  EQU   IOPDATES+6                                               03729000
IOPAPPT  EQU   IOPDATES+3                                               03730000
IOPAPPD  EQU   IOPDATES                                                 03731000
IOPRECT  EQU   @NM00076+3                                               03732000
IOPRECD  EQU   @NM00076                                                 03733000
@NM00075 EQU   IOPPTFFX+8                                               03734000
@NM00074 EQU   @NM00072+7                                               03735000
IOPPRELN EQU   @NM00073                                                 03736000
@NM00071 EQU   IOPPTFDR+20                                              03737000
IOPSBYNO EQU   IOPPTFDR+13                                              03738000
IOPDBYNO EQU   IOPPTFDR+6                                               03739000
@NM00070 EQU   IOPPTFF3                                                 03740000
IOPFLF   EQU   IOPPTFF3                                                 03741000
IOPPMDLP EQU   IOPPTFF2+1                                               03742000
IOPPADDP EQU   IOPPTFF2+1                                               03743000
@NM00069 EQU   IOPPTFF2+1                                               03744000
IOPLRFP  EQU   IOPPTFF2                                                 03745000
IOPJCLP  EQU   IOPPTFF2                                                 03746000
IOPSUPP  EQU   IOPPTFF2                                                 03747000
IOPREQP  EQU   IOPPTFF2                                                 03748000
IOPPREP  EQU   IOPPTFF2                                                 03749000
IOPNPRP  EQU   IOPPTFF2                                                 03750000
IOPIRQP  EQU   IOPPTFF2                                                 03751000
IOPREGEN EQU   IOPFLGS5                                                 03752000
IOPBYP   EQU   IOPFLGS5                                                 03753000
@NM00068 EQU   IOPFLGS5                                                 03754000
IOPACC   EQU   IOPFLGS5                                                 03755000
IOPRES   EQU   IOPFLGS5                                                 03756000
IOPAPP   EQU   IOPFLGS5                                                 03757000
@NM00067 EQU   IOPPTFDR                                                 03758000
IOPPTMAX EQU   IOPCDMAX                                                 03759000
@NM00066 EQU   IOPSCMAP+11                                              03760000
@NM00065 EQU   IOPSCMAP+8                                               03761000
@NM00064 EQU   IOPSCMAP                                                 03762000
TBLXEND0 EQU   TBLXPARM+124                                             03763000
@NM00007 EQU   TBLXPARM+108                                             03764000
TBLXIOP3 EQU   TBLXPARM+104                                             03765000
TBLXDLGT EQU   TBLXPARM+96                                              03766000
@NM00006 EQU   TBLXRC+3                                                 03767000
TBLXIRC  EQU   TBLXRC+2                                                 03768000
TBLXLRC  EQU   TBLXRC+1                                                 03769000
TBLXTRC  EQU   TBLXRC                                                   03770000
TBLXIBGN EQU   TBLXPARM+88                                              03771000
@NM00005 EQU   TBLXPARM+83                                              03772000
@NM00004 EQU   TBLXPARM+82                                              03773000
@NM00003 EQU   TBLXPARM+81                                              03774000
@NM00002 EQU   TBLXFLG1                                                 03775000
TBLXTCRC EQU   TBLXFLG1                                                 03776000
TBLXFUND EQU   TBLXPARM+72                                              03777000
@NM00001 EQU   TBLXPARM+62                                              03778000
TBLXCRQI EQU   TBLXPARM+61                                              03779000
TBLXCDSI EQU   TBLXPARM+60                                              03780000
TBLXLMGT EQU   TBLXPARM+56                                              03781000
TBLXSCGT EQU   TBLXPARM+52                                              03782000
TBLXSREL EQU   TBLXPARM+48                                              03783000
TBLXASGT EQU   TBLXPARM+44                                              03784000
TBLXIFGT EQU   TBLXPARM+40                                              03785000
TBLXNULL EQU   TBLXPARM+36                                              03786000
TBLXIOP2 EQU   TBLXPARM+16                                              03787000
TBLXEND  EQU   TBLXINDX+8                                               03788000
TBLXSTRT EQU   TBLXINDX+4                                               03789000
TBLXCUR  EQU   TBLXINDX                                                 03790000
TBLXHDR  EQU   TBLXPARM                                                 03791000
@NM00144 EQU   D2RFLAGS                                                 03792000
TSLRRTNP EQU   TSLRELM+12                                               03793000
TSLRAPTR EQU   TSLRELM+8                                                03794000
@NM00139 EQU   TSLRELM+7                                                03795000
TSLRSMD  EQU   TSLRELM                                                  03796000
TSLEFNDP EQU   TSLENTSR+12                                              03797000
TSLEBGNP EQU   TSLENTSR+8                                               03798000
TSLENMEP EQU   TSLENTSR+4                                               03799000
@NM00138 EQU   TSLENTSR+3                                               03800000
@NM00137 EQU   TSLEOPTF                                                 03801000
TSLEONXT EQU   TSLEOPTF                                                 03802000
TSLEVER# EQU   TSLENTSR+1                                               03803000
TSLETYPE EQU   TSLENTSR                                                 03804000
@NM00136 EQU   TSLSICDS+19                                              03805000
TSLSDUM  EQU   TSLSCDSF                                                 03806000
TSLSCERR EQU   TSLSCDSF                                                 03807000
@NM00135 EQU   TSLSCDSF                                                 03808000
@NM00134 EQU   TSLSCDSF                                                 03809000
TSLSCDEL EQU   TSLSCDSF                                                 03810000
TSLSCSUP EQU   TSLSCDSF                                                 03811000
TSLSCOK  EQU   TSLSCDSF                                                 03812000
TSLSCFND EQU   TSLSCDSF                                                 03813000
@NM00133 EQU   TSLSICDS+17                                              03814000
TSLSISLS EQU   TSLSICTF                                                 03815000
TSLSINOG EQU   TSLSICTF                                                 03816000
TSLSIDLI EQU   TSLSICTF                                                 03817000
TSLSIDLE EQU   TSLSICTF                                                 03818000
TSLSIDEL EQU   TSLSICTF                                                 03819000
TSLSISUP EQU   TSLSICTF                                                 03820000
TSLSIOK  EQU   TSLSICTF                                                 03821000
TSLSIFND EQU   TSLSICTF                                                 03822000
TSLSIOPP EQU   TSLSICDS+12                                              03823000
TSLSICTP EQU   TSLSICDS+8                                               03824000
@NM00132 EQU   TSLSOPTF                                                 03825000
TSLSOXTD EQU   TSLSOPTF                                                 03826000
TSLSOMSG EQU   TSLSOPTF                                                 03827000
TSLSOALL EQU   TSLSOPTF                                                 03828000
TSLSOCDS EQU   TSLSOPTF                                                 03829000
TSLSOICT EQU   TSLSOPTF                                                 03830000
TSLSSMD  EQU   TSLSICDS                                                 03831000
TSLGDSID EQU   TSLGET+12                                                03832000
TSLGIOPP EQU   TSLGET+8                                                 03833000
@NM00131 EQU   TSLGOPTF                                                 03834000
TSLGOXTD EQU   TSLGOPTF                                                 03835000
TSLGOMSG EQU   TSLGOPTF                                                 03836000
@NM00130 EQU   TSLGOPTF                                                 03837000
@NM00129 EQU   TSLGOPTF                                                 03838000
@NM00128 EQU   TSLGOPTF                                                 03839000
TSLGSMD  EQU   TSLGET                                                   03840000
@NM00127 EQU   TSLLOPTF                                                 03841000
@NM00126 EQU   TSLICTSR+13                                              03842000
@NM00125 EQU   TSLICTF                                                  03843000
TSLINOG  EQU   TSLICTF                                                  03844000
TSLIDLI  EQU   TSLICTF                                                  03845000
TSLIDLE  EQU   TSLICTF                                                  03846000
TSLIDEL  EQU   TSLICTF                                                  03847000
TSLISUP  EQU   TSLICTF                                                  03848000
TSLIOK   EQU   TSLICTF                                                  03849000
@NM00124 EQU   TSLIOPTF                                                 03850000
TSLIONXT EQU   TSLIOPTF                                                 03851000
TSLTBLXP EQU   TSLPARMS                                                 03852000
SCLEND   EQU   SCLDATA+2                                                03853000
SCLVERNO EQU   SCLDATA+1                                                03854000
SCLREDO  EQU   SCLSTAT                                                  03855000
SCLCAND  EQU   SCLSTAT                                                  03856000
SCLSELST EQU   SCLSTAT                                                  03857000
SCLDELP  EQU   SCLSTAT                                                  03858000
SCLFMID  EQU   SCLKEY+8                                                 03859000
SCLSMD   EQU   SCLKEY+1                                                 03860000
SCLISTNO EQU   SCLKEY                                                   03861000
@NM00123 EQU   HMASMGTP+27                                              03862000
GTPPSIZE EQU   GTPFLGS1                                                 03863000
@NM00122 EQU   GTPFLGS1                                                 03864000
GTPRCDNF EQU   GTPFLGS1                                                 03865000
GTPNOSPM EQU   GTPFLGS1                                                 03866000
GTPPOS   EQU   GTPRESTR+8                                               03867000
GTPRCD   EQU   GTPRESTR+4                                               03868000
GTPPAG   EQU   GTPRESTR                                                 03869000
GTPWKAD  EQU   HMASMGTP+8                                               03870000
GTPKEYLN EQU   HMASMGTP+6                                               03871000
GTPRCDLN EQU   HMASMGTP+4                                               03872000
@NM00121 EQU   HMASMGTP+2                                               03873000
SEFLAG2H EQU   SEFLAG2                                                  03874000
SEFLAG2G EQU   SEFLAG2                                                  03875000
SEFLAG2F EQU   SEFLAG2                                                  03876000
SEFLAG2E EQU   SEFLAG2                                                  03877000
SEFLAG2D EQU   SEFLAG2                                                  03878000
SEFLAG2C EQU   SEFLAG2                                                  03879000
SEFLAG2B EQU   SEFLAG2                                                  03880000
SEFOUND  EQU   SEFLAGS                                                  03881000
@NM00120 EQU   SEFLAGS                                                  03882000
SEFMID   EQU   SEFLAGS                                                  03883000
SENOJCL  EQU   SEFLAGS                                                  03884000
SEEXCLUD EQU   SEFLAGS                                                  03885000
SESELECT EQU   SEFLAGS                                                  03886000
SEGROUP  EQU   SEFLAGS                                                  03887000
@NM00119 EQU   SENAME+7                                                 03888000
SEPTFNO  EQU   SESMDNO                                                  03889000
SESYS    EQU   SELSTFLG+1                                               03890000
SEFMD    EQU   SELSTFLG+1                                               03891000
SEASM    EQU   SELSTFLG+1                                               03892000
SELMD    EQU   SELSTFLG+1                                               03893000
SEMAC    EQU   SELSTFLG+1                                               03894000
SEMOD    EQU   SELSTFLG+1                                               03895000
SEDLB    EQU   SELSTFLG+1                                               03896000
SESRC    EQU   SELSTFLG+1                                               03897000
SEMCS    EQU   SELSTFLG                                                 03898000
@NM00118 EQU   SELSTFLG                                                 03899000
@NM00117 EQU   ICTSBYNT+7                                               03900000
ICTDELEX EQU   ICTDELST                                                 03901000
ICTDELND EQU   ICTDELNM                                                 03902000
@NM00116 EQU   ICTVRSNT+7                                               03903000
ICTVRSND EQU   ICTVRSNM                                                 03904000
@NM00115 EQU   ICTNPRNT+7                                               03905000
ICTNPRND EQU   ICTNPRNM                                                 03906000
@NM00114 EQU   ICTCSRST                                                 03907000
@NM00113 EQU   ICTCSRST                                                 03908000
ICTCSRF  EQU   ICTCSRST                                                 03909000
@NM00112 EQU   ICTCSRST                                                 03910000
ICTCSRNM EQU   ICTIRQNT+8                                               03911000
@NM00111 EQU   ICTIRQST                                                 03912000
ICTIREQT EQU   ICTIRQST                                                 03913000
ICTIREQI EQU   ICTIRQST                                                 03914000
ICTIREQB EQU   ICTIRQST                                                 03915000
ICTIREQS EQU   ICTIRQST                                                 03916000
@NM00110 EQU   ICTIRQST                                                 03917000
ICTIRQND EQU   ICTIRQNM                                                 03918000
@NM00109 EQU   ICTPREST                                                 03919000
ICTPREQT EQU   ICTPREST                                                 03920000
ICTPREQI EQU   ICTPREST                                                 03921000
ICTPREQB EQU   ICTPREST                                                 03922000
ICTPREQS EQU   ICTPREST                                                 03923000
@NM00108 EQU   ICTPREST                                                 03924000
ICTPREND EQU   ICTPRENM                                                 03925000
@NM00107 EQU   ICTSUPNT+7                                               03926000
ICTSUPND EQU   ICTSUPNM                                                 03927000
@NM00106 EQU   ICTREQST                                                 03928000
ICTRREQT EQU   ICTREQST                                                 03929000
ICTRREQI EQU   ICTREQST                                                 03930000
ICTRREQB EQU   ICTREQST                                                 03931000
ICTRREQS EQU   ICTREQST                                                 03932000
@NM00105 EQU   ICTREQST                                                 03933000
ICTREQND EQU   ICTREQNM                                                 03934000
@NM00104 EQU   ICTENTST                                                 03935000
ICTEREQI EQU   ICTENTST                                                 03936000
ICTEREQB EQU   ICTENTST                                                 03937000
@NM00103 EQU   ICTENTST                                                 03938000
ICTIXP   EQU   ICTIXPF                                                  03939000
@NM00102 EQU   ICTPTF+100                                               03940000
ICTPTPFX EQU   ICTPTF+38                                                03941000
ICTPRELN EQU   ICTPTF+36                                                03942000
ICTPRECT EQU   ICTPTF+33                                                03943000
ICTPRECD EQU   ICTPTF+30                                                03944000
ICTPVERN EQU   ICTPTF+29                                                03945000
ICTPSUPN EQU   ICTPTF+20                                                03946000
ICTPONUM EQU   ICTPTF+18                                                03947000
ICTPUSR8 EQU   ICTPFLGA                                                 03948000
ICTPUSR7 EQU   ICTPFLGA                                                 03949000
ICTPUSR6 EQU   ICTPFLGA                                                 03950000
ICTPUSR5 EQU   ICTPFLGA                                                 03951000
ICTPUSR4 EQU   ICTPFLGA                                                 03952000
ICTPUSR3 EQU   ICTPFLGA                                                 03953000
ICTPUSR2 EQU   ICTPFLGA                                                 03954000
ICTPPASS EQU   ICTPUSR1                                                 03955000
@NM00101 EQU   @NM00100                                                 03956000
ICTPRQBY EQU   @NM00100                                                 03957000
ICTPRQOK EQU   @NM00100                                                 03958000
ICTPRQCK EQU   @NM00100                                                 03959000
@NM00099 EQU   ICTPFLG9                                                 03960000
ICTPPDEL EQU   ICTPFLG9                                                 03961000
ICTPWRKO EQU   ICTPFLG9                                                 03962000
ICTPMSL  EQU   ICTPFLG9                                                 03963000
@NM00098 EQU   ICTPFLG8                                                 03964000
ICTPDCPL EQU   ICTPFLG8                                                 03965000
ICTPECPL EQU   ICTPFLG8                                                 03966000
ICTPGCPL EQU   ICTPFLG8                                                 03967000
@NM00097 EQU   ICTPFLG4                                                 03968000
@NM00096 EQU   ICTPFLG4                                                 03969000
@NM00095 EQU   ICTPFLG4                                                 03970000
ICTPGELM EQU   ICTPFLG4                                                 03971000
ICTPDIMP EQU   ICTPFLG4                                                 03972000
ICTPDEXP EQU   ICTPFLG4                                                 03973000
ICTPREDO EQU   ICTPFLG4                                                 03974000
ICTPCDSE EQU   ICTPFLG4                                                 03975000
@NM00094 EQU   ICTPFLG2                                                 03976000
ICTPTPS  EQU   ICTPFLG2                                                 03977000
ICTPTR1  EQU   ICTPFLG2                                                 03978000
ICTPVRSP EQU   ICTPFLG2                                                 03979000
@NM00093 EQU   ICTPFLG6                                                 03980000
ICTFLF   EQU   ICTPFLF                                                  03981000
ICTPDBYP EQU   ICTPFLG6                                                 03982000
ICTPSBYP EQU   ICTPFLG6                                                 03983000
ICTPMDLP EQU   ICTPFLG5+1                                               03984000
ICTPADDP EQU   ICTPFLG5+1                                               03985000
@NM00092 EQU   ICTPFLG5+1                                               03986000
ICTPLRFP EQU   ICTPFLG5                                                 03987000
ICTPJCLP EQU   ICTPFLG5                                                 03988000
ICTPSUPP EQU   ICTPFLG5                                                 03989000
ICTPREQP EQU   ICTPFLG5                                                 03990000
ICTPPREP EQU   ICTPFLG5                                                 03991000
ICTPNPRP EQU   ICTPFLG5                                                 03992000
ICTPIRQP EQU   ICTPFLG5                                                 03993000
@NM00091 EQU   ICTPFLG3                                                 03994000
ICTPNOLB EQU   ICTPFLG3                                                 03995000
ICTPVERJ EQU   ICTPFLG3                                                 03996000
ICTPROCS EQU   ICTPPROC                                                 03997000
ICTREGEN EQU   ICTPFLG1                                                 03998000
ICTBYP   EQU   ICTPFLG1                                                 03999000
ICTDUMMP EQU   ICTPFLG1                                                 04000000
@NM00090 EQU   ICTPFLG1                                                 04001000
ICTERROR EQU   ICTPFLG1                                                 04002000
ICTACC   EQU   ICTPFLG1                                                 04003000
ICTRES   EQU   ICTPFLG1                                                 04004000
ICTAPP   EQU   ICTPFLG1                                                 04005000
@NM00063 EQU   IOPUSERL                                                 04006000
@NM00062 EQU   IOPUSERL                                                 04007000
IOPALIS  EQU   IOPUSERL                                                 04008000
IOPTTR   EQU   IOPDRMAP+8                                               04009000
IOPINAM2 EQU   IOPINAM+1                                                04010000
IOPITYP2 EQU   IOPITYP                                                  04011000
IOPBUFAD EQU   HMASMIOP+52                                              04012000
@NM00061 EQU   HMASMIOP+32                                              04013000
IOPDELDD EQU   IOPDDNAM                                                 04014000
@NM00060 EQU   @NM00057+10                                              04015000
IOPSEQNO EQU   @NM00057+8                                               04016000
@NM00059 EQU   @NM00058+7                                               04017000
IOPPTFNM EQU   @NM00058                                                 04018000
CCABMREC EQU   CCABELMT+10                                              04019000
CCABPOS  EQU   CCABMPOS+8                                               04020000
CCABNAME EQU   CCABMPOS                                                 04021000
@NM00056 EQU   CCABLDLM+2                                               04022000
@NM00055 EQU   CCABLDLM                                                 04023000
CCAUPDPM EQU   @NM00053+24                                              04024000
@NM00054 EQU   @NM00053+21                                              04025000
CCARUPDT EQU   CCAUPDRC                                                 04026000
CCAUPDSP EQU   @NM00053+12                                              04027000
CCAUPDTE EQU   @NM00053+8                                               04028000
CCAUPDNM EQU   @NM00053                                                 04029000
CCASUPPM EQU   @NM00051+24                                              04030000
@NM00052 EQU   @NM00051+21                                              04031000
CCARSUP  EQU   CCASUPRC                                                 04032000
CCASUPSP EQU   @NM00051+12                                              04033000
CCAIOSUP EQU   @NM00051+8                                               04034000
CCASUPNM EQU   @NM00051                                                 04035000
CCAZAPPM EQU   @NM00049+24                                              04036000
@NM00050 EQU   @NM00049+21                                              04037000
CCARZAP  EQU   CCAZAPRC                                                 04038000
CCAZAPSP EQU   @NM00049+12                                              04039000
CCASPZAP EQU   @NM00049+8                                               04040000
CCAZAPNM EQU   @NM00049                                                 04041000
CCACOMPM EQU   @NM00047+24                                              04042000
@NM00048 EQU   @NM00047+21                                              04043000
CCARCOMP EQU   CCACOMRC                                                 04044000
CCACOMSP EQU   @NM00047+12                                              04045000
CCACOMRS EQU   @NM00047+8                                               04046000
CCACOMNM EQU   @NM00047                                                 04047000
CCACPYPM EQU   @NM00045+24                                              04048000
@NM00046 EQU   @NM00045+21                                              04049000
CCARCOPY EQU   CCACPYRC                                                 04050000
CCACPYSP EQU   @NM00045+12                                              04051000
CCACOPY  EQU   @NM00045+8                                               04052000
CCACPYNM EQU   @NM00045                                                 04053000
CCAASMPM EQU   @NM00043+24                                              04054000
@NM00044 EQU   @NM00043+21                                              04055000
CCARASM  EQU   CCAASMRC                                                 04056000
CCAASMSP EQU   @NM00043+12                                              04057000
CCAASM   EQU   @NM00043+8                                               04058000
CCAASMNM EQU   @NM00043                                                 04059000
CCALKDPM EQU   @NM00041+24                                              04060000
@NM00042 EQU   @NM00041+21                                              04061000
CCARLINK EQU   CCALKDRC                                                 04062000
CCALKDSP EQU   @NM00041+12                                              04063000
CCALKED  EQU   @NM00041+8                                               04064000
CCALKDNM EQU   @NM00041                                                 04065000
CCAPGMPM EQU   @NM00039+24                                              04066000
@NM00040 EQU   @NM00039+21                                              04067000
CCABPGRC EQU   @NM00039+20                                              04068000
CCABPGSP EQU   @NM00039+12                                              04069000
CCABPGAD EQU   @NM00039+8                                               04070000
CCABPGNM EQU   @NM00039                                                 04071000
CCAEND   EQU   HMASMCCA+371                                             04072000
@NM00038 EQU   HMASMCCA+309                                             04073000
CCACURDD EQU   CCAFDSNG+3                                               04074000
CCACURDS EQU   CCAFDSNG+2                                               04075000
@NM00037 EQU   CCAFLAGB                                                 04076000
CCAOUTNG EQU   CCAFLAGB                                                 04077000
CCALOGNG EQU   CCAFLAGB                                                 04078000
CCAFMID  EQU   HMASMCCA+291                                             04079000
CCALSTDS EQU   CCAFCTL+8                                                04080000
CCARPTDS EQU   CCAFCTL+7                                                04081000
CCATIME  EQU   CCAFCTL+4                                                04082000
CCADATE  EQU   CCAFCTL+1                                                04083000
@NM00036 EQU   CCAFLAG9                                                 04084000
CCARVCAN EQU   CCAFLAG9                                                 04085000
CCARVEST EQU   CCAFLAG9                                                 04086000
CCAPTSNJ EQU   CCAFLAG9                                                 04087000
CCASTSNP EQU   CCAFLAG9                                                 04088000
CCAMTSNP EQU   CCAFLAG9                                                 04089000
CCAPTSNP EQU   CCAFLAG9                                                 04090000
@NM00035 EQU   CCAFLAG8                                                 04091000
CCAACDSC EQU   CCAFLAG8                                                 04092000
CCACDSC  EQU   CCAFLAG8                                                 04093000
@NM00034 EQU   CCAFLAG6                                                 04094000
CCAACRUP EQU   CCAFLAG6                                                 04095000
CCACRQUP EQU   CCAFLAG6                                                 04096000
CCAACDUP EQU   CCAFLAG6                                                 04097000
CCACDSUP EQU   CCAFLAG6                                                 04098000
@NM00033 EQU   CCAFLAG5                                                 04099000
CCAACROS EQU   CCAFLAG5                                                 04100000
CCACRQOS EQU   CCAFLAG5                                                 04101000
CCAACDOS EQU   CCAFLAG5                                                 04102000
CCACDSOS EQU   CCAFLAG5                                                 04103000
@NM00032 EQU   CCAFLAG4                                                 04104000
CCAACRIS EQU   CCAFLAG4                                                 04105000
CCACRQIS EQU   CCAFLAG4                                                 04106000
CCAACDIS EQU   CCAFLAG4                                                 04107000
CCACDSIS EQU   CCAFLAG4                                                 04108000
@NM00031 EQU   CCAFLAG3+1                                               04109000
CCARGNP  EQU   CCAFLAG3+1                                               04110000
CCADISRQ EQU   CCAFLAG3+1                                               04111000
CCAICTOK EQU   CCAFLAG3                                                 04112000
CCADELP  EQU   CCAFLAG3                                                 04113000
CCACMPRS EQU   CCAFLAG3                                                 04114000
CCAZAPP  EQU   CCAFLAG3                                                 04115000
CCALINKP EQU   CCAFLAG3                                                 04116000
CCACOPYP EQU   CCAFLAG3                                                 04117000
CCAASIP  EQU   CCAFLAG3                                                 04118000
CCAUPDP  EQU   CCAFLAG3                                                 04119000
CCAEOSMP EQU   CCAFLAG2                                                 04120000
CCAEOFNC EQU   CCAFLAG2                                                 04121000
@NM00030 EQU   CCAFLAG2                                                 04122000
CCACHECK EQU   CCAFLAG2                                                 04123000
CCATERM  EQU   CCAFLAG2                                                 04124000
CCASVCLB EQU   CCAFLAG2                                                 04125000
CCANCPTF EQU   CCAFLAG2                                                 04126000
@NM00029 EQU   CCAFLAG1+1                                               04127000
CCAUNL   EQU   CCAFLAG1+1                                               04128000
CCARESET EQU   CCAFLAG1+1                                               04129000
CCALOG   EQU   CCAFLAG1+1                                               04130000
CCACNV   EQU   CCAFLAG1+1                                               04131000
CCALIST  EQU   CCAFLAG1                                                 04132000
CCAUPDU  EQU   CCAFLAG1                                                 04133000
CCAUPDJ  EQU   CCAFLAG1                                                 04134000
CCARES   EQU   CCAFLAG1                                                 04135000
CCAREJ   EQU   CCAFLAG1                                                 04136000
CCAACCPT EQU   CCAFLAG1                                                 04137000
CCAAPPLY EQU   CCAFLAG1                                                 04138000
CCAREC   EQU   CCAFLAG1                                                 04139000
CCAFUNCT EQU   CCAFFUNC                                                 04140000
@NM00028 EQU   @NM00023+18                                              04141000
@NM00027 EQU   @NM00023+16                                              04142000
CCATBLPA EQU   @NM00023+12                                              04143000
@NM00026 EQU   @NM00023+8                                               04144000
@NM00025 EQU   @NM00023+4                                               04145000
@NM00024 EQU   @NM00023                                                 04146000
CCAIFGTP EQU   CCAFGTP+16                                               04147000
CCAGTP3  EQU   CCAFGTP+12                                               04148000
CCAGTP2  EQU   CCAFGTP+8                                                04149000
CCAGTP1  EQU   CCAFGTP+4                                                04150000
CCASETAD EQU   CCASEGTP                                                 04151000
CCACLST  EQU   CCAFPGM+12                                               04152000
CCASPDCB EQU   CCAFPGM+8                                                04153000
CCAICLMD EQU   CCAFICT+12                                               04154000
CCAICMOD EQU   CCAFICT+8                                                04155000
CCAICT   EQU   CCAFICT                                                  04156000
CCARVAD  EQU   CCAFSTA                                                  04157000
CCAACDID EQU   CCAFSYS+32                                               04158000
CCACDSID EQU   CCAFSYS+24                                               04159000
CCALNLEN EQU   CCAFSYS+22                                               04160000
@NM00022 EQU   CCAFLAGA                                                 04161000
CCAPSYSF EQU   CCAFLAGA                                                 04162000
CCAASYSF EQU   CCAFLAGA                                                 04163000
CCACSYSF EQU   CCAFLAGA                                                 04164000
CCANUCID EQU   CCAFSYS+20                                               04165000
CCAASREL EQU   CCAFSYS+16                                               04166000
CCACSREL EQU   CCASREL                                                  04167000
CCAPEMAX EQU   CCAFSYS+10                                               04168000
CCAPGLEN EQU   CCAFSYS+8                                                04169000
CCAIOPAS EQU   CCAFSYS+4                                                04170000
CCAIOPCS EQU   CCAFSYS                                                  04171000
CCAPESIZ EQU   CCAFIOP+4                                                04172000
@NM00021 EQU   CCAFLAG7+3                                               04173000
CCALOGP  EQU   CCAFLAG7+2                                               04174000
CCAOUTP  EQU   CCAFLAG7+2                                               04175000
CCASLBP  EQU   CCAFLAG7+2                                               04176000
CCARPTP  EQU   CCAFLAG7+2                                               04177000
CCALISTP EQU   CCAFLAG7+2                                               04178000
CCAJCLP  EQU   CCAFLAG7+2                                               04179000
CCAPTFP  EQU   CCAFLAG7+2                                               04180000
CCATLBP  EQU   CCAFLAG7+2                                               04181000
CCAUT3P  EQU   CCAFLAG7+1                                               04182000
CCAUT2P  EQU   CCAFLAG7+1                                               04183000
CCAUT1P  EQU   CCAFLAG7+1                                               04184000
CCAWK5P  EQU   CCAFLAG7+1                                               04185000
CCAWK4P  EQU   CCAFLAG7+1                                               04186000
CCAWK3P  EQU   CCAFLAG7+1                                               04187000
CCAWK2P  EQU   CCAFLAG7+1                                               04188000
CCAWK1P  EQU   CCAFLAG7+1                                               04189000
CCAACRQP EQU   CCAFLAG7                                                 04190000
CCACRQP  EQU   CCAFLAG7                                                 04191000
CCASTSP  EQU   CCAFLAG7                                                 04192000
CCAMTSP  EQU   CCAFLAG7                                                 04193000
CCAPTSP  EQU   CCAFLAG7                                                 04194000
CCASCDSP EQU   CCAFLAG7                                                 04195000
CCAACDSP EQU   CCAFLAG7                                                 04196000
CCACDSP  EQU   CCAFLAG7                                                 04197000
@NM00020 EQU   CCAFBUFR+122                                             04198000
@NM00019 EQU   CCAFBUFR+120                                             04199000
@NM00018 EQU   CCAFBUFR+118                                             04200000
CCATBFMX EQU   CCAFBUFR+116                                             04201000
CCA4BFMX EQU   CCAFBUFR+114                                             04202000
CCA3BFMX EQU   CCAFBUFR+112                                             04203000
CCA2BFMX EQU   CCAFBUFR+110                                             04204000
CCA1BFMX EQU   CCAFBUFR+108                                             04205000
CCAXBFMX EQU   CCAFBUFR+106                                             04206000
CCAQBFMX EQU   CCAFBUFR+104                                             04207000
CCASBFMX EQU   CCAFBUFR+102                                             04208000
CCAMBFMX EQU   CCAFBUFR+100                                             04209000
CCAPBFMX EQU   CCAFBUFR+98                                              04210000
CCAVBFMX EQU   CCAFBUFR+96                                              04211000
CCAABFMX EQU   CCAFBUFR+94                                              04212000
CCACBFMX EQU   CCAFBUFR+92                                              04213000
@NM00017 EQU   CCAFBUFR+88                                              04214000
@NM00016 EQU   CCAFBUFR+84                                              04215000
CCA4BFSZ EQU   CCAFBUFR+80                                              04216000
CCATBFSZ EQU   CCAFBUFR+76                                              04217000
CCAWBFSZ EQU   CCAFBUFR+72                                              04218000
CCAQBFSZ EQU   CCAFBUFR+68                                              04219000
CCAPBFSZ EQU   CCAFBUFR+64                                              04220000
CCAVBFSZ EQU   CCAFBUFR+60                                              04221000
CCACBFSZ EQU   CCAFBUFR+56                                              04222000
@NM00015 EQU   CCAFBUFR+52                                              04223000
CCA4BFOA EQU   CCAFBUFR+48                                              04224000
CCA4BFIA EQU   CCAFBUFR+44                                              04225000
CCATBFIA EQU   CCAFBUFR+40                                              04226000
CCAWBFOA EQU   CCAFBUFR+36                                              04227000
CCAWBFIA EQU   CCAFBUFR+32                                              04228000
CCAQBFOA EQU   CCAFBUFR+28                                              04229000
CCAQBFIA EQU   CCAFBUFR+24                                              04230000
CCAPBFOA EQU   CCAFBUFR+20                                              04231000
CCAPBFIA EQU   CCAFBUFR+16                                              04232000
CCAVBFOA EQU   CCAFBUFR+12                                              04233000
CCAVBFIA EQU   CCAFBUFR+8                                               04234000
CCACBFOA EQU   CCAFBUFR+4                                               04235000
CCACBFIA EQU   CCAFBUFR                                                 04236000
CCAID    EQU   HMASMCCA                                                 04237000
@NM00014 EQU   TBLFLG5                                                  04238000
TBLICTOK EQU   TBLFLG5                                                  04239000
@NM00013 EQU   TBLFLG4                                                  04240000
TBLBPFM  EQU   TBLFLG4                                                  04241000
@NM00012 EQU   TBLFLG4                                                  04242000
TBLBPIRQ EQU   TBLFLG4                                                  04243000
TBLBPREQ EQU   TBLFLG4                                                  04244000
TBLBPPRE EQU   TBLFLG4                                                  04245000
TBLBPID  EQU   TBLFLG4                                                  04246000
@NM00011 EQU   TBLFLG3+1                                                04247000
TBLSTS   EQU   TBLFLG3                                                  04248000
TBLMTS   EQU   TBLFLG3                                                  04249000
TBLPTS   EQU   TBLFLG3                                                  04250000
TBLACRQ  EQU   TBLFLG3                                                  04251000
TBLCRQ   EQU   TBLFLG3                                                  04252000
TBLSCDS  EQU   TBLFLG3                                                  04253000
TBLACDS  EQU   TBLFLG3                                                  04254000
TBLCDS   EQU   TBLFLG3                                                  04255000
TBLMASS  EQU   TBLFLG2                                                  04256000
@NM00010 EQU   TBLFLG2                                                  04257000
TBLFMID  EQU   TBLFLG2                                                  04258000
TBLEXC   EQU   TBLFLG2                                                  04259000
TBLSEL   EQU   TBLFLG2                                                  04260000
@NM00009 EQU   TBLFLG1+1                                                04261000
TBLDISW  EQU   TBLFLG1+1                                                04262000
TBLDISR  EQU   TBLFLG1+1                                                04263000
TBLDISN  EQU   TBLFLG1+1                                                04264000
TBLNOJCL EQU   TBLFLG1                                                  04265000
TBLFLUSH EQU   TBLFLG1                                                  04266000
TBLUSER  EQU   TBLFLG1                                                  04267000
TBLAPAR  EQU   TBLFLG1                                                  04268000
TBLCOMP  EQU   TBLFLG1                                                  04269000
TBLASSEM EQU   TBLFLG1                                                  04270000
TBLCHECK EQU   TBLFLG1                                                  04271000
TBLNOAPP EQU   TBLFLG1                                                  04272000
@NM00008 EQU   TBLXOPTS+5                                               04273000
TBLNUCID EQU   TBLXOPTS+4                                               04274000
TBLJCLGT EQU   TBLXOPTS                                                 04275000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04276000
@RC00237 EQU   @RC00235                                                 04277000
@RF00339 EQU   @RC00337                                                 04278000
@RC00411 EQU   @RC00408                                                 04279000
@RF00741 EQU   @RC00702                                                 04280000
@RC00768 EQU   @RC00766                                                 04281000
@RC00804 EQU   @RC00802                                                 04282000
@RC00239 EQU   @RC00237                                                 04283000
@RC00413 EQU   @RC00411                                                 04284000
@RF00433 EQU   @RC00411                                                 04285000
@ENDDATA EQU   *                                                        04286000
         END   HMASMTPR,(C'PLS2209',0802,78334)                         04287000
