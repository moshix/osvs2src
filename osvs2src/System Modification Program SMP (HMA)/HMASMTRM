         TITLE 'HMASMTRM - RESTORE ELEMENT SELECTION'                   00001000
HMASMTRM CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMTRM  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @08,4095(,@12)                                      0001 00011000
         LA    @09,4095(,@08)                                      0001 00012000
         LA    @10,4095(,@09)                                      0001 00013000
         USING @PSTART,@12                                         0001 00014000
         USING @PSTART+4095,@08                                    0001 00015000
         USING @PSTART+8190,@09                                    0001 00016000
         USING @PSTART+12285,@10                                   0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LA    @14,@SA00001                                        0001 00019000
         ST    @14,8(,@13)                                         0001 00020000
         LR    @13,@14                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
         EJECT                                                          00023000
*                                                                  0231 00024000
*   /*****************************************************************/ 00025000
*   /*                                                               */ 00026000
*   /* HMASMTRM << MAINLINE                                          */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                                  0231 00030000
*   TRMRC=ZERO;                     /* CLEAR THE RETURN CODE         */ 00031000
*                                                                  0231 00032000
         SLR   TRMRC,TRMRC                                         0231 00033000
*   /*****************************************************************/ 00034000
*   /*                                                               */ 00035000
*   /* INITIALIZE PROCESSING                                         */ 00036000
*   /*                                                               */ 00037000
*   /*****************************************************************/ 00038000
*                                                                  0232 00039000
*   CALL TRMINIT;                                                  0232 00040000
*                                                                  0232 00041000
         BAL   @14,TRMINIT                                         0232 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* BUILD ICT ENTRY FOR EACH ELEMENT IN EACH SYSMOD               */ 00045000
*   /*                                                               */ 00046000
*   /*****************************************************************/ 00047000
*                                                                  0233 00048000
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */ 00049000
         CH    TRMRC,@CH00033                                      0233 00050000
         BNL   @RF00233                                            0233 00051000
*     DO;                           /* YES                           */ 00052000
*       CALL GETMOD;                                               0235 00053000
         BAL   @14,GETMOD                                          0235 00054000
*       RFY                                                        0236 00055000
*         RTNCODE RSTD;                                            0236 00056000
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */ 00057000
         CR    TRMRC,RTNCODE                                       0237 00058000
         BNL   *+6                                                      00059000
         LR    TRMRC,RTNCODE                                       0237 00060000
*       RFY                                                        0238 00061000
*         RTNCODE UNRSTD;                                          0238 00062000
*     END;                                                         0239 00063000
*                                                                  0239 00064000
*   /*****************************************************************/ 00065000
*   /*                                                               */ 00066000
*   /* SELECT THE ELEMENT VERSION                                    */ 00067000
*   /*                                                               */ 00068000
*   /*****************************************************************/ 00069000
*                                                                  0240 00070000
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */ 00071000
@RF00233 CH    TRMRC,@CH00033                                      0240 00072000
         BNL   @RF00240                                            0240 00073000
*     DO;                           /* YES                           */ 00074000
*       CALL SELMOD;                                               0242 00075000
         BAL   @14,SELMOD                                          0242 00076000
*       RFY                                                        0243 00077000
*         RTNCODE RSTD;                                            0243 00078000
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */ 00079000
         CR    TRMRC,RTNCODE                                       0244 00080000
         BNL   *+6                                                      00081000
         LR    TRMRC,RTNCODE                                       0244 00082000
*       RFY                                                        0245 00083000
*         RTNCODE UNRSTD;                                          0245 00084000
*     END;                                                         0246 00085000
*                                                                  0246 00086000
*   /*****************************************************************/ 00087000
*   /*                                                               */ 00088000
*   /* DETERMINE ALL SYSMODS THAT REFERENCE EACH ELEMENT             */ 00089000
*   /*                                                               */ 00090000
*   /*****************************************************************/ 00091000
*                                                                  0247 00092000
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */ 00093000
@RF00240 CH    TRMRC,@CH00033                                      0247 00094000
         BNL   @RF00247                                            0247 00095000
*     DO;                           /* YES                           */ 00096000
*       CALL XRFSETUP;                                             0249 00097000
         BAL   @14,XRFSETUP                                        0249 00098000
*       RFY                                                        0250 00099000
*         RTNCODE RSTD;                                            0250 00100000
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */ 00101000
         CR    TRMRC,RTNCODE                                       0251 00102000
         BNL   *+6                                                      00103000
         LR    TRMRC,RTNCODE                                       0251 00104000
*       RFY                                                        0252 00105000
*         RTNCODE UNRSTD;                                          0252 00106000
*       IF TRMRC<STOPFUNC THEN      /* ERROR OCCURRED?               */ 00107000
         CH    TRMRC,@CH00033                                      0253 00108000
         BNL   @RF00253                                            0253 00109000
*         DO;                       /* YES,                          */ 00110000
*           CALL HMASMXRF(LISTPARM, /* LIST PARM LIST                */ 00111000
*               MXOUTGTP,           /* (OUTPUT) ELEMENT TO SYSMOD  0255 00112000
*                                      XREF GTP                      */ 00113000
*               MSELGTP);           /* (INPUT) ELEMENT SELECTED GTP  */ 00114000
         L     @15,@CV02019                                        0255 00115000
         LA    @01,@AL00255                                        0255 00116000
         BALR  @14,@15                                             0255 00117000
*           RFY                                                    0256 00118000
*             RTNCODE RSTD;                                        0256 00119000
*           TRMRC=MAX(RTNCODE,TRMRC);/* SET THE RETURN CODE          */ 00120000
         CR    TRMRC,RTNCODE                                       0257 00121000
         BNL   *+6                                                      00122000
         LR    TRMRC,RTNCODE                                       0257 00123000
*           RFY                                                    0258 00124000
*             RTNCODE UNRSTD;                                      0258 00125000
*         END;                                                     0259 00126000
*     END;                                                         0260 00127000
*                                                                  0260 00128000
@RF00253 DS    0H                                                  0261 00129000
*   /*****************************************************************/ 00130000
*   /*                                                               */ 00131000
*   /* CHECK EACH SYSMOD THAT REFERENCES AN ELEMENT                  */ 00132000
*   /*                                                               */ 00133000
*   /*****************************************************************/ 00134000
*                                                                  0261 00135000
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */ 00136000
@RF00247 CH    TRMRC,@CH00033                                      0261 00137000
         BNL   @RF00261                                            0261 00138000
*     DO;                           /* YES                           */ 00139000
*       CALL CHKXRF;                                               0263 00140000
         BAL   @14,CHKXRF                                          0263 00141000
*       RFY                                                        0264 00142000
*         RTNCODE RSTD;                                            0264 00143000
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */ 00144000
         CR    TRMRC,RTNCODE                                       0265 00145000
         BNL   *+6                                                      00146000
         LR    TRMRC,RTNCODE                                       0265 00147000
*       RFY                                                        0266 00148000
*         RTNCODE UNRSTD;                                          0266 00149000
*     END;                                                         0267 00150000
*                                                                  0267 00151000
*   /*****************************************************************/ 00152000
*   /*                                                               */ 00153000
*   /* CHECK STATUS OF EACH ELEMENT AND ITS MOD ID'S                 */ 00154000
*   /*                                                               */ 00155000
*   /*****************************************************************/ 00156000
*                                                                  0268 00157000
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */ 00158000
@RF00261 CH    TRMRC,@CH00033                                      0268 00159000
         BNL   @RF00268                                            0268 00160000
*     DO;                           /* YES                           */ 00161000
*       CALL MODIDCHK;                                             0270 00162000
         BAL   @14,MODIDCHK                                        0270 00163000
*       RFY                                                        0271 00164000
*         RTNCODE RSTD;                                            0271 00165000
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */ 00166000
         CR    TRMRC,RTNCODE                                       0272 00167000
         BNL   *+6                                                      00168000
         LR    TRMRC,RTNCODE                                       0272 00169000
*       RFY                                                        0273 00170000
*         RTNCODE UNRSTD;                                          0273 00171000
*     END;                                                         0274 00172000
*                                                                  0274 00173000
*   /*****************************************************************/ 00174000
*   /*                                                               */ 00175000
*   /* CLEANUP                                                       */ 00176000
*   /*                                                               */ 00177000
*   /*****************************************************************/ 00178000
*                                                                  0275 00179000
*   CALL TRMCLEAN;                                                 0275 00180000
@RF00268 BAL   @14,TRMCLEAN                                        0275 00181000
*   RFY                                                            0276 00182000
*     RTNCODE RSTD;                                                0276 00183000
*   TRMRC=MAX(RTNCODE,TRMRC);       /* SET THE RETURN CODE           */ 00184000
         CR    TRMRC,RTNCODE                                       0277 00185000
         BNL   *+6                                                      00186000
         LR    TRMRC,RTNCODE                                       0277 00187000
*   RFY                                                            0278 00188000
*     RTNCODE UNRSTD;                                              0278 00189000
*   RETURN CODE(TRMRC);             /*                               */ 00190000
         LR    @15,TRMRC                                           0279 00191000
         L     @13,4(,@13)                                         0279 00192000
         L     @14,12(,@13)                                        0279 00193000
         LM    @00,@12,20(@13)                                     0279 00194000
         BR    @14                                                 0279 00195000
         EJECT                                                          00196000
*                                                                  0280 00197000
*   /*****************************************************************/ 00198000
*   /*                                                               */ 00199000
*   /* TRMINIT -                                                     */ 00200000
*   /*                                                               */ 00201000
*   /*****************************************************************/ 00202000
*                                                                  0280 00203000
*TRMINIT:                                                          0280 00204000
*   PROC;                                                          0280 00205000
TRMINIT  STM   @14,@12,12(@13)                                     0280 00206000
*   DCL                                                            0281 00207000
*     INITRC FIXED(15);             /* LOCAL RETURN CODE             */ 00208000
*   INITRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 00209000
         SLR   INITRC,INITRC                                       0282 00210000
*   TRMFLAGS=''B;                   /* CLEAR CONTROL FLAGS           */ 00211000
         MVI   TRMFLAGS,X'00'                                      0283 00212000
*                                                                  0284 00213000
*   /*****************************************************************/ 00214000
*   /*                                                               */ 00215000
*   /* INITIALIZE LIST PARAMETER LIST. THIS WILL BE USED TO CREATE A */ 00216000
*   /* SYSMOD TO ELEMENT GTA FILE BY CALLING HMASMXRF                */ 00217000
*   /*                                                               */ 00218000
*   /*****************************************************************/ 00219000
*                                                                  0284 00220000
*   LISTPARM=''B;                   /*                               */ 00221000
         XC    LISTPARM(19),LISTPARM                               0284 00222000
*   LISTCDS=ON;                     /* LIST CDS                      */ 00223000
         OI    LISTCDS,B'01000000'                                 0285 00224000
*   LISTASM=ON;                     /* RETURN ALL ELEMENT TYPE     0286 00225000
*                                      RECORDS                       */ 00226000
*   LISTMAC=ON;                     /* ...                           */ 00227000
*   LISTMOD=ON;                     /* ...                           */ 00228000
*   LISTSRC=ON;                     /* ...                           */ 00229000
         OI    LISTASM,B'01011100'                                 0289 00230000
*   LISTSEL=ON;                     /* PROCESS SELECTED ENTRIES, NOT    00231000
*                                      ALL                           */ 00232000
*   LISTXREF=ON;                    /* PRODUCE CROSS REFERENCE       */ 00233000
*                                                                  0291 00234000
         OI    LISTSEL,B'11000000'                                 0291 00235000
*   /*****************************************************************/ 00236000
*   /*                                                               */ 00237000
*   /* CLEAR INTERNAL GTP'S                                          */ 00238000
*   /*                                                               */ 00239000
*   /*****************************************************************/ 00240000
*                                                                  0292 00241000
*   MXOUTGTP=''B;                   /* CLEAR THE ELEMENT TO SYSMOD 0292 00242000
*                                      GTP                           */ 00243000
         XC    MXOUTGTP(28),MXOUTGTP                               0292 00244000
*   MSELGTP=''B;                    /* CLEAR XREF MODULE SELECT GTP  */ 00245000
*                                                                  0293 00246000
         XC    MSELGTP(28),MSELGTP                                 0293 00247000
*   /*****************************************************************/ 00248000
*   /*                                                               */ 00249000
*   /* INIT GTP IN TRMINIT                                           */ 00250000
*   /*                                                               */ 00251000
*   /*****************************************************************/ 00252000
*                                                                  0294 00253000
*   RFY                                                            0294 00254000
*     HMASMGTP BASED(ADDR(ASMGTP));                                0294 00255000
*   HMASMGTP=''B;                   /* CLEAR THE GTP                 */ 00256000
         LA    @03,ASMGTP                                          0295 00257000
         XC    HMASMGTP(28,@03),HMASMGTP(@03)                      0295 00258000
*   GTPRCDLN=LENGTH(TM4RCD);        /* INITIALIZE RECORD LENGTH      */ 00259000
         MVC   GTPRCDLN(2,@03),@CH00033                            0296 00260000
*   GTPKEYLN=LENGTH(TM4NAME);       /* KEY LENGTH                    */ 00261000
         MVC   GTPKEYLN(2,@03),@CH00034                            0297 00262000
*   GTPBUFAD=ADDR(TM4RCD);          /* INPUT/OUTPUT BUFFER           */ 00263000
         LA    @15,TM4RCD                                          0298 00264000
         ST    @15,GTPBUFAD(,@03)                                  0298 00265000
*   GTPPSIZE=GTP512B;               /* PAGE SIZE                     */ 00266000
         NI    GTPPSIZE(@03),B'11111001'                           0299 00267000
         OI    GTPPSIZE(@03),B'00000001'                           0299 00268000
*   RFY                                                            0300 00269000
*     HMASMGTP BASED;                                              0300 00270000
*   RETURN CODE(INITRC);            /* RETURN W/RC SET               */ 00271000
         LR    @15,INITRC                                          0301 00272000
         L     @14,12(,@13)                                        0301 00273000
         LM    @00,@12,20(@13)                                     0301 00274000
         BR    @14                                                 0301 00275000
*   END TRMINIT;                                                   0302 00276000
         EJECT                                                          00277000
*                                                                  0303 00278000
*/****************************************************************   */ 00279000
*/*                                                                  */ 00280000
*/* GETMOD -                                                         */ 00281000
*/*                                                                  */ 00282000
*/* INPUT  - ICT PTF SECTION                                         */ 00283000
*/*                                                                  */ 00284000
*/* OUTPUT - ICT MOD SECTION                                         */ 00285000
*/*        - RETURN CODES                                            */ 00286000
*/*          0 -                                                     */ 00287000
*/*          12- IO ERROR OR NOT ENOUGH SPACE                        */ 00288000
*/*          16- IO ERROR                                            */ 00289000
*/****************************************************************   */ 00290000
*                                                                  0303 00291000
*GETMOD:                                                           0303 00292000
*   PROC;                                                          0303 00293000
GETMOD   STM   @14,@12,@SA00003                                    0303 00294000
*   DCL                                                            0304 00295000
*     GETMRC FIXED(15);             /* LOCAL RETURN CODE             */ 00296000
*   DCL                                                            0305 00297000
*     GETM1PRC FIXED(15);           /* RETURN CODE FOR 1 SYSMOD      */ 00298000
*   DCL                                                            0306 00299000
*     GETMPTFX FIXED(31);           /* ICT PTF ENTRY INDEX           */ 00300000
*   DCL                                                            0307 00301000
*     GETMSUBX FIXED(31);           /* IOP SUB-ENTRY INDEX           */ 00302000
*   DCL                                                            0308 00303000
*     GETICTYP CHAR(1);             /* ICT MOD ENTRY TYPE            */ 00304000
*   RFY                                                            0309 00305000
*     ICTPTF BASED(CCAICPTF);                                      0309 00306000
*   RFY                                                            0310 00307000
*     HMASMIOP BASED(TBLXIOP3);     /* EXTENDED IOP                  */ 00308000
*   GETMRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 00309000
         SLR   GETMRC,GETMRC                                       0311 00310000
*                                                                  0312 00311000
*   /*****************************************************************/ 00312000
*   /*                                                               */ 00313000
*   /* INITIALIZE IOP FOR GETTING SYSMOD EXTENDED CDS ENTRY          */ 00314000
*   /*                                                               */ 00315000
*   /*****************************************************************/ 00316000
*                                                                  0312 00317000
*   IOPDSID=IOPCDS;                 /* GET CDS ...                   */ 00318000
         L     @02,@PC00001                                        0312 00319000
         L     @02,TBLXIOP3(,@02)                                  0312 00320000
         MVI   IOPDSID(@02),X'02'                                  0312 00321000
*   IOPTYPE=IOPSMD;                 /* ... SYSMOD ...                */ 00322000
         MVI   IOPTYPE(@02),X'0B'                                  0313 00323000
*   IOPFUNCT=IOPLOC;                /* ... EXTENDED ENTRY            */ 00324000
*                                                                  0314 00325000
         MVI   IOPFUNCT(@02),X'03'                                 0314 00326000
*   /*****************************************************************/ 00327000
*   /*                                                               */ 00328000
*   /* PROCESS ALL SYSMODS                                           */ 00329000
*   /*                                                               */ 00330000
*   /*****************************************************************/ 00331000
*                                                                  0315 00332000
*   DO GETMPTFX=1 BY 1              /* PROCESS ALL ICT SYSMODS       */ 00333000
*         WHILE(ICTPEND(GETMPTFX)^=ICTENDNT/* ...                    */ 00334000
*         &GETMRC<STOPFUNC);        /* ...                           */ 00335000
         LA    GETMPTFX,1                                          0315 00336000
         B     @DE00315                                            0315 00337000
@DL00315 DS    0H                                                  0316 00338000
*     GETM1PRC=ZERO;                /* ALL IS WELL FOR CURRENT SYSMOD*/ 00339000
         SLR   GETM1PRC,GETM1PRC                                   0316 00340000
*     IF ICTPNOGO(GETMPTFX)=OFF     /* SYSMOD NOT FAILED ...         */ 00341000
*         &ICTPSUPN(GETMPTFX)=ZERO THEN/* ... AND NOT SUPED?         */ 00342000
         LR    @02,GETMPTFX                                        0317 00343000
         MH    @02,@CH02662                                        0317 00344000
         L     @15,CCAICPTF(,CCAPTR)                               0317 00345000
         ST    @02,@TF00001                                        0317 00346000
         ALR   @02,@15                                             0317 00347000
         AL    @02,@CF02692                                        0317 00348000
         TM    ICTPNOGO-8(@02),B'01000000'                         0317 00349000
         BNZ   @RF00317                                            0317 00350000
         LR    @02,@15                                             0317 00351000
         AL    @02,@TF00001                                        0317 00352000
         AL    @02,@CF02693                                        0317 00353000
         SLR   @14,@14                                             0317 00354000
         ICM   @14,3,ICTPSUPN-20(@02)                              0317 00355000
         LTR   @14,@14                                             0317 00356000
         BNZ   @RF00317                                            0317 00357000
*       DO;                         /* YES,                          */ 00358000
*         IOPNAM17=ICTPTFS(GETMPTFX);/* GET CURRENT SYSMOD           */ 00359000
         L     @02,@PC00001                                        0319 00360000
         L     @02,TBLXIOP3(,@02)                                  0319 00361000
         AL    @15,@TF00001                                        0319 00362000
         AL    @15,@CF02694                                        0319 00363000
         MVC   IOPNAM17(7,@02),ICTPTFS(@15)                        0319 00364000
*         CALL HMASMIO(HMASMIOP);   /* ...                           */ 00365000
         ST    @02,@AL00001                                        0320 00366000
         L     @15,@CV02017                                        0320 00367000
         LA    @01,@AL00001                                        0320 00368000
         BALR  @14,@15                                             0320 00369000
*         IF IOPRETRN^=IOPGOOD THEN /* ERROR FROM IO?                */ 00370000
         L     @02,@PC00001                                        0321 00371000
         L     @02,TBLXIOP3(,@02)                                  0321 00372000
         CLI   IOPRETRN(@02),0                                     0321 00373000
         BE    @RF00321                                            0321 00374000
*           DO;                     /* YES,                          */ 00375000
*             GETMRC=MAX(GETMRC,IOPRETRN);/* SAVE RC                 */ 00376000
         SLR   @05,@05                                             0323 00377000
         IC    @05,IOPRETRN(,@02)                                  0323 00378000
         CR    GETMRC,@05                                          0323 00379000
         BNL   *+6                                                      00380000
         LR    GETMRC,@05                                          0323 00381000
*             IF IOPRETRN=IOPNTFND THEN/* RC WAS NOT FOUND?          */ 00382000
         CLI   IOPRETRN(@02),4                                     0324 00383000
         BNE   @RF00324                                            0324 00384000
*               DO;                 /* YES,                          */ 00385000
*                 GETMRC=MAX(GETMRC,STOPSMD);/* SET TO STOP SYSMOD 0326 00386000
*                                      ATLEAST                       */ 00387000
*                                                                  0326 00388000
         LA    @05,8                                               0326 00389000
         CR    GETMRC,@05                                          0326 00390000
         BNL   *+6                                                      00391000
         LR    GETMRC,@05                                          0326 00392000
*                 /***************************************************/ 00393000
*                 /*                                                 */ 00394000
*                 /* ISSUE MESSAGE HMA246I XXXXXXXX XXXXXXXX NOT     */ 00395000
*                 /* FOUND ON XXXXXXXX                               */ 00396000
*                 /*                                                 */ 00397000
*                 /***************************************************/ 00398000
*                                                                  0327 00399000
*                 DO;               /* HMASMPMG M1(HMA246I)VAR(CCATYP   00400000
*                                      EA(IOPTYPE),IOPNAM17,CCADSIDA(   00401000
*                                      IOPDSID))TYPE(ERR)TARGET(SYSOU   00402000
*                                      T,LOG)                        */ 00403000
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/ 00404000
         XC    HMASMMGP(32),HMASMMGP                               0328 00405000
*                   MGPMGNO1=HMA246I;/* SET UP MSG 1 CODE            */ 00406000
         MVC   MGPMGNO1(2),@CH01892                                0329 00407000
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */ 00408000
         MVI   MGPTYPE,X'03'                                       0330 00409000
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */ 00410000
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */ 00411000
         OI    MGPPRINT,B'10010000'                                0332 00412000
*                   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* SET     0333 00413000
*                                      VARIABLE PTR                  */ 00414000
         SLR   @05,@05                                             0333 00415000
         IC    @05,IOPTYPE(,@02)                                   0333 00416000
         SLA   @05,3                                               0333 00417000
         L     @01,CCATPAD(,CCAPTR)                                0333 00418000
         AL    @01,@CF02695                                        0333 00419000
         LA    @05,CCATYPEA(@05,@01)                               0333 00420000
         ST    @05,MGPVARPT                                        0333 00421000
*                   MGPVARPT(2)=ADDR(IOPNAM17);/* SET VARIABLE PTR   */ 00422000
         LA    @05,IOPNAM17(,@02)                                  0334 00423000
         ST    @05,MGPVARPT+4                                      0334 00424000
*                   MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* SET     0335 00425000
*                                      VARIABLE PTR                  */ 00426000
         SLR   @05,@05                                             0335 00427000
         IC    @05,IOPDSID(,@02)                                   0335 00428000
         SLA   @05,3                                               0335 00429000
         L     @02,CCADSAD(,CCAPTR)                                0335 00430000
         AL    @02,@CF02695                                        0335 00431000
         LA    @05,CCADSIDA(@05,@02)                               0335 00432000
         ST    @05,MGPVARPT+8                                      0335 00433000
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */ 00434000
         L     @15,@CV02018                                        0336 00435000
         LA    @01,@AL00336                                        0336 00436000
         BALR  @14,@15                                             0336 00437000
*                 END;                                             0337 00438000
*                 GETMRC=STOPSMD;   /* FAIL THE SYSMOD RC            */ 00439000
         LA    GETMRC,8                                            0338 00440000
*                 CALL FAILSMD(ICTPTF(GETMPTFX));/*                  */ 00441000
         LR    @05,GETMPTFX                                        0339 00442000
         MH    @05,@CH02662                                        0339 00443000
         L     @02,CCAICPTF(,CCAPTR)                               0339 00444000
         AL    @02,@CF02694                                        0339 00445000
         LA    @05,ICTPTF(@05,@02)                                 0339 00446000
         ST    @05,@AL00001                                        0339 00447000
         LA    @01,@AL00001                                        0339 00448000
         BAL   @14,FAILSMD                                         0339 00449000
*                 RFY                                              0340 00450000
*                   RTNCODE RSTD;                                  0340 00451000
*                 GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RC              */ 00452000
         CR    GETMRC,RTNCODE                                      0341 00453000
         BNL   *+6                                                      00454000
         LR    GETMRC,RTNCODE                                      0341 00455000
*                 RFY                                              0342 00456000
*                   RTNCODE UNRSTD;                                0342 00457000
*               END;                                               0343 00458000
*           END;                                                   0344 00459000
*         ELSE                      /* IO SUCCESSFUL                 */ 00460000
*           DO;                                                    0345 00461000
*                                                                  0345 00462000
         B     @RC00321                                            0345 00463000
@RF00321 DS    0H                                                  0346 00464000
*             /*******************************************************/ 00465000
*             /*                                                     */ 00466000
*             /* BUILD ASSEM GTA FILE WITH ONE RECORD FOR EACH ASSEM */ 00467000
*             /* SUB-ENTRY IN THE SYSMOD IOP                         */ 00468000
*             /*                                                     */ 00469000
*             /*******************************************************/ 00470000
*                                                                  0346 00471000
*             CALL ASMGTA(HMASMIOP);/* BUILD GTA FILE                */ 00472000
         L     @02,@PC00001                                        0346 00473000
         L     @02,TBLXIOP3(,@02)                                  0346 00474000
         ST    @02,@AL00001                                        0346 00475000
         LA    @01,@AL00001                                        0346 00476000
         BAL   @14,ASMGTA                                          0346 00477000
*             RFY                                                  0347 00478000
*               RTNCODE RSTD;                                      0347 00479000
*             GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RC                  */ 00480000
         CR    GETMRC,RTNCODE                                      0348 00481000
         BNL   *+6                                                      00482000
         LR    GETMRC,RTNCODE                                      0348 00483000
*             RFY                                                  0349 00484000
*               RTNCODE UNRSTD;                                    0349 00485000
*                                                                  0349 00486000
*             /*******************************************************/ 00487000
*             /*                                                     */ 00488000
*             /* PROCESS ALL IOP SUB-ENTRIES FOR A SYSMOD            */ 00489000
*             /*                                                     */ 00490000
*             /*******************************************************/ 00491000
*                                                                  0350 00492000
*             ASMBLDF=OFF;          /* ASSUME NO ASSEMBLIES NEEDED   */ 00493000
         NI    ASMBLDF,B'01111111'                                 0350 00494000
*             DO GETMSUBX=1 BY 1    /* PROCESS ALL IOP SUBENTRIES    */ 00495000
*                   WHILE(IOPPTFND(GETMSUBX)^=IOPEOLST/* ...         */ 00496000
*                   &GETMRC<STOPFUNC);/*                             */ 00497000
         LA    GETMSUBX,1                                          0351 00498000
         B     @DE00351                                            0351 00499000
@DL00351 DS    0H                                                  0352 00500000
*               CALL CNVTYP3(IOPPIND(GETMSUBX),/* CONVERT IOPPIND  0352 00501000
*                                      TYPE TO ICT MOD TYPE          */ 00502000
*                   GETICTYP);      /*                               */ 00503000
         LR    @07,GETMSUBX                                        0352 00504000
         MH    @07,@CH00035                                        0352 00505000
         L     @02,@PC00001                                        0352 00506000
         L     @02,TBLXIOP3(,@02)                                  0352 00507000
         LA    @07,IOPPIND-9(@07,@02)                              0352 00508000
         ST    @07,@AL00001                                        0352 00509000
         LA    @07,GETICTYP                                        0352 00510000
         ST    @07,@AL00001+4                                      0352 00511000
         LA    @01,@AL00001                                        0352 00512000
         BAL   @14,CNVTYP3                                         0352 00513000
*               IF GETICTYP^=ZERO THEN/* ELEMENT SUB-ENTRY TYPE?     */ 00514000
         CLI   GETICTYP,0                                          0353 00515000
         BE    @RF00353                                            0353 00516000
*                 DO;               /* YES,                          */ 00517000
*                                                                  0354 00518000
*                   /*************************************************/ 00519000
*                   /*                                               */ 00520000
*                   /* BUILD AN ICT MOD ENTRY(S) FOR ONE ELEMENT     */ 00521000
*                   /* SUB-ENTRY                                     */ 00522000
*                   /*                                               */ 00523000
*                   /*************************************************/ 00524000
*                                                                  0355 00525000
*                   CALL BLDENTRY(ICTPTF(GETMPTFX),/* ICT PTF ENTRY  */ 00526000
*                       IOPPNTRY(GETMSUBX),/* IOP SUBENTRY           */ 00527000
*                       GETICTYP);  /* ICT MOD TYPE                  */ 00528000
         LR    @07,GETMPTFX                                        0355 00529000
         MH    @07,@CH02662                                        0355 00530000
         L     @02,CCAICPTF(,CCAPTR)                               0355 00531000
         AL    @02,@CF02694                                        0355 00532000
         LA    @07,ICTPTF(@07,@02)                                 0355 00533000
         ST    @07,@AL00001                                        0355 00534000
         LR    @07,GETMSUBX                                        0355 00535000
         MH    @07,@CH00035                                        0355 00536000
         L     @02,@PC00001                                        0355 00537000
         L     @02,TBLXIOP3(,@02)                                  0355 00538000
         LA    @07,IOPPNTRY-9(@07,@02)                             0355 00539000
         ST    @07,@AL00001+4                                      0355 00540000
         LA    @07,GETICTYP                                        0355 00541000
         ST    @07,@AL00001+8                                      0355 00542000
         LA    @01,@AL00001                                        0355 00543000
         BAL   @14,BLDENTRY                                        0355 00544000
*                   RFY                                            0356 00545000
*                     RTNCODE RSTD;                                0356 00546000
*                   GETM1PRC=MAX(GETM1PRC,RTNCODE);/* SAVE RETURN  0357 00547000
*                                      CODE                          */ 00548000
         CR    GETM1PRC,RTNCODE                                    0357 00549000
         BNL   *+6                                                      00550000
         LR    GETM1PRC,RTNCODE                                    0357 00551000
*                   RFY                                            0358 00552000
*                     RTNCODE UNRSTD;                              0358 00553000
*                   GETMRC=MAX(GETMRC,GETM1PRC);/* SAVE RETURN CODE  */ 00554000
         CR    GETMRC,GETM1PRC                                     0359 00555000
         BNL   *+6                                                      00556000
         LR    GETMRC,GETM1PRC                                     0359 00557000
*                 END;                                             0360 00558000
*               ELSE                                               0361 00559000
*                 ;                 /* NOT AN ELEMENT TYPE SUBENTRY  */ 00560000
@RF00353 DS    0H                                                  0362 00561000
*             END;                  /* END OF PROCESS ONE SYSMOD LOOP*/ 00562000
         AH    GETMSUBX,@CH00064                                   0362 00563000
@DE00351 LR    @07,GETMSUBX                                        0362 00564000
         MH    @07,@CH00035                                        0362 00565000
         L     @02,@PC00001                                        0362 00566000
         L     @02,TBLXIOP3(,@02)                                  0362 00567000
         SLR   @15,@15                                             0362 00568000
         IC    @15,IOPPTFND-9(@07,@02)                             0362 00569000
         CH    @15,@CH00707                                        0362 00570000
         BE    @DC00351                                            0362 00571000
         CH    GETMRC,@CH00033                                     0362 00572000
         BL    @DL00351                                            0362 00573000
@DC00351 DS    0H                                                  0363 00574000
*             IF GETMRC<STOPFUNC    /* NO SERIOUS ERROR?             */ 00575000
*                 &ASMBLDF=ON THEN  /* AND ASSEMBLY ENTRIES EXIST?   */ 00576000
         CH    GETMRC,@CH00033                                     0363 00577000
         BNL   @RF00363                                            0363 00578000
         TM    ASMBLDF,B'10000000'                                 0363 00579000
         BNO   @RF00363                                            0363 00580000
*               DO;                 /* YES,                          */ 00581000
*                 CALL HMASMTM4(TBLXPARM,/* PARM LIST                */ 00582000
*                     ZERO,         /* NO ICT MOD ENTRY CAUSING ASSEM*/ 00583000
*                     ADDR(ICTPTF(GETMPTFX)),/* PTR TO PTF SECT ENTRY*/ 00584000
*                     ZERO,         /* NULL MCB PTR                  */ 00585000
*                     ADDR(ASMGTP));/* ASSEM GTP FOR TM4             */ 00586000
         MVC   @AL00001+4(16),@AL00365                             0365 00587000
         L     @02,@PC00001                                        0365 00588000
         ST    @02,@AL00001                                        0365 00589000
         LR    @02,GETMPTFX                                        0365 00590000
         MH    @02,@CH02662                                        0365 00591000
         L     @01,CCAICPTF(,CCAPTR)                               0365 00592000
         AL    @01,@CF02694                                        0365 00593000
         LA    @02,ICTPTF(@02,@01)                                 0365 00594000
         ST    @02,@TF00001                                        0365 00595000
         LA    @02,ASMGTP                                          0365 00596000
         ST    @02,@TF00002                                        0365 00597000
         L     @15,@CV02028                                        0365 00598000
         LA    @01,@AL00001                                        0365 00599000
         BALR  @14,@15                                             0365 00600000
*                 RFY                                              0366 00601000
*                   RTNCODE RSTD;                                  0366 00602000
*                 GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RETURN CODE     */ 00603000
         CR    GETMRC,RTNCODE                                      0367 00604000
         BNL   *+6                                                      00605000
         LR    GETMRC,RTNCODE                                      0367 00606000
*                 RFY                                              0368 00607000
*                   RTNCODE UNRSTD;                                0368 00608000
*               END;                                               0369 00609000
*             IF GETMRC<STOPFUNC THEN/* NO SERIOUS ERROR?            */ 00610000
@RF00363 CH    GETMRC,@CH00033                                     0370 00611000
         BNL   @RF00370                                            0370 00612000
*               DO;                 /* YES,                          */ 00613000
*                 CALL MODCHAIN(ICTPTF(GETMPTFX));/* BUILD PTF TO MOD   00614000
*                                      CHAIN                         */ 00615000
         LR    @02,GETMPTFX                                        0372 00616000
         MH    @02,@CH02662                                        0372 00617000
         L     @01,CCAICPTF(,CCAPTR)                               0372 00618000
         AL    @01,@CF02694                                        0372 00619000
         LA    @02,ICTPTF(@02,@01)                                 0372 00620000
         ST    @02,@AL00001                                        0372 00621000
         LA    @01,@AL00001                                        0372 00622000
         BAL   @14,MODCHAIN                                        0372 00623000
*                 RFY                                              0373 00624000
*                   RTNCODE RSTD;                                  0373 00625000
*                 GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RETURN CODE     */ 00626000
         CR    GETMRC,RTNCODE                                      0374 00627000
         BNL   *+6                                                      00628000
         LR    GETMRC,RTNCODE                                      0374 00629000
*                 RFY                                              0375 00630000
*                   RTNCODE UNRSTD;                                0375 00631000
*                 IF GETM1PRC=STOPSMD THEN/* FAIL THE SYSMOD?        */ 00632000
         CH    GETM1PRC,@CH00034                                   0376 00633000
         BNE   @RF00376                                            0376 00634000
*                   DO;             /* YES,                          */ 00635000
*                     CALL FAILSMD(ICTPTF(GETMPTFX));/* FAIL SYSMOD  */ 00636000
         LR    @05,GETMPTFX                                        0378 00637000
         MH    @05,@CH02662                                        0378 00638000
         L     @02,CCAICPTF(,CCAPTR)                               0378 00639000
         AL    @02,@CF02694                                        0378 00640000
         LA    @05,ICTPTF(@05,@02)                                 0378 00641000
         ST    @05,@AL00001                                        0378 00642000
         LA    @01,@AL00001                                        0378 00643000
         BAL   @14,FAILSMD                                         0378 00644000
*                     RFY                                          0379 00645000
*                       RTNCODE RSTD;                              0379 00646000
*                     GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RETURN CODE */ 00647000
         CR    GETMRC,RTNCODE                                      0380 00648000
         BNL   *+6                                                      00649000
         LR    GETMRC,RTNCODE                                      0380 00650000
*                     RFY                                          0381 00651000
*                       RTNCODE UNRSTD;                            0381 00652000
*                   END;                                           0382 00653000
*                 ELSE                                             0383 00654000
*                   ;               /* DO NOT FAIL SYSMOD            */ 00655000
@RF00376 DS    0H                                                  0384 00656000
*               END;                                               0384 00657000
*             ELSE                                                 0385 00658000
*               ;                   /* SERIOUS ERROR                 */ 00659000
@RF00370 DS    0H                                                  0386 00660000
*           END;                                                   0386 00661000
*       END;                                                       0387 00662000
*     ELSE                                                         0388 00663000
*       ;                           /* THE SYSMOD IS NOGO            */ 00664000
@RF00317 DS    0H                                                  0389 00665000
*   END;                            /* END OF ICT SYSMOD LOOP        */ 00666000
@RC00317 AH    GETMPTFX,@CH00064                                   0389 00667000
@DE00315 LR    @05,GETMPTFX                                        0389 00668000
         MH    @05,@CH02662                                        0389 00669000
         L     @02,CCAICPTF(,CCAPTR)                               0389 00670000
         AL    @02,@CF02694                                        0389 00671000
         L     @05,ICTPEND(@05,@02)                                0389 00672000
         CL    @05,ICTENDNT                                        0389 00673000
         BE    @DC00315                                            0389 00674000
         CH    GETMRC,@CH00033                                     0389 00675000
         BL    @DL00315                                            0389 00676000
@DC00315 DS    0H                                                  0390 00677000
*   RETURN CODE(GETMRC);            /* RETURN W/RC SET               */ 00678000
         LR    @15,GETMRC                                          0390 00679000
         L     @14,@SA00003                                        0390 00680000
         LM    @00,@12,@SA00003+8                                  0390 00681000
         BR    @14                                                 0390 00682000
*   RFY                                                            0391 00683000
*     ICTPTF BASED;                                                0391 00684000
*   RFY                                                            0392 00685000
*     HMASMIOP BASED;                                              0392 00686000
         EJECT                                                          00687000
*                                                                  0393 00688000
*/********************************************************************/ 00689000
*/*                                                                  */ 00690000
*/* BLDENTRY - BUILD AN ICT MOD ENTRY                                */ 00691000
*/*                                                                  */ 00692000
*/* INPUT  - ICT PTF ENTRY FOR THE "CURRENT" SYSMOD                  */ 00693000
*/*        - IOP SUB-ENTRY FOR THE MOD FOR WHICH AN ICT MOD ENTRY    */ 00694000
*/*          IS TO BE CREATED                                        */ 00695000
*/*                                                                  */ 00696000
*/* OUTPUT - ICT MOD ENTRY AS DESCRIBED IN THE FOLLOWING TABLE:      */ 00697000
*/*                                                                  */ 00698000
*/*                                                                  */ 00699000
*/*  CDS      | ICT    | ACTION                                      */ 00700000
*/*  SYSMOD   | ENTRY  |                                             */ 00701000
*/*  SUBENTRY | TYPE   |                                             */ 00702000
*/*  TYPE     |        |                                             */ 00703000
*/* ----------|--------|---------------------------------------------*/ 00704000
*/*  MOD      | MOD    | LINK/COPY DLIB VERION TO TARGET LIBRARIES   */ 00705000
*/*  ZAP      | MOD    | LINK/COPY DLIB VERION TO TARGET LIBRARIES   */ 00706000
*/*  XPD      | MOD    | LINK/COPY DLIB VERION TO TARGET LIBRARIES   */ 00707000
*/*  MACR     | MACR   | COPY DLIB VERSION TO TARGET LIBRARIES       */ 00708000
*/*  MACU     | MACR   | COPY DLIB VERSION TO TARGET LIBRARIES       */ 00709000
*/*  SRCR     | SRCR   | COPY DLIB VERSION TO TARGET LIBRARIES       */ 00710000
*/*           | MASM   | ASSEMBLE AND LINKEDIT ELEMENT               */ 00711000
*/*  SRCU     | SRCR   | COPY DLIB VERSION TO TARGET LIBRARIES       */ 00712000
*/*           | MASM   | ASSEMBLE AND LINKEDIT ELEMENT               */ 00713000
*/*  ASM      | ----   | POSTPONE PROCESSING                         */ 00714000
*/* ----------|--------|---------------------------------------------*/ 00715000
*/*                                                                  */ 00716000
*/*  FOR SOURCE AND MACRO TYPES, ASSEMBLIES AND LINKEDITS MAY ALSO   */ 00717000
*/*  BE REQUIRED FOR ASSOCIATED ELEMENTS.                            */ 00718000
*/*                                                                  */ 00719000
*/*  FOR ALL SUBENTRY TYPES, IF THE ELEMENT EXISTS ON THE CDS BUT NOT*/ 00720000
*/*  THE ACDS, THEN IT WAS ADDED BY THIS SYSMOD AN SHOULD THEREFORE  */ 00721000
*/*  BE DELETED                                                      */ 00722000
*/*                                                                  */ 00723000
*/*         - RC                                                     */ 00724000
*/*            -  0 ALL IS WELL                                      */ 00725000
*/*            -  4 TMX DID NOT FIND ENTRY                           */ 00726000
*/*            -  8 SYSMOD IS FAILED BY TMX                          */ 00727000
*/*            - 12 I/O ERROR                                        */ 00728000
*/*            - 16 I/O ERROR                                        */ 00729000
*/*                                                                  */ 00730000
*/********************************************************************/ 00731000
*                                                                  0393 00732000
*BLDENTRY:                                                         0393 00733000
*   PROC(BLDESMD,                   /* ICT PTF ENTRY FOR WHICH THE 0393 00734000
*                                      ELEMENT IS TO BE BUILT        */ 00735000
*       BLDESUBE,                   /* SYSMOD IOP SUBENTRY FOR THE 0393 00736000
*                                      ELEMENT TO BE BUILT           */ 00737000
*       BLDICTYP);                  /* ICT MOD ENTRY TYPE TO BE BUILT*/ 00738000
BLDENTRY STM   @14,@12,@SA00004                                    0393 00739000
         MVC   @PC00004(12),0(@01)                                 0393 00740000
*   DCL                                                            0394 00741000
*     BLDESMD CHAR(LENGTH(ICTPTF)); /* PTF SECT ENTRY                */ 00742000
*   DCL                                                            0395 00743000
*     BLDESUBE CHAR(LENGTH(IOPPNTRY));/* SYSMOD IOP SUBENTRY         */ 00744000
*   DCL                                                            0396 00745000
*     BLDENTRC FIXED(31);           /* LOCAL RETURN CODE             */ 00746000
*   DCL                                                            0397 00747000
*     TMXRETRN FIXED(31);           /* RETURN CODE FROM HMASMTM1, 2 3   00748000
*                                      OR 4                          */ 00749000
*   DCL                                                            0398 00750000
*     BLDENT@ PTR(31);              /* POINTS TO MOD SECT ENTRY BEING   00751000
*                                      BUILT                         */ 00752000
*   DCL                                                            0399 00753000
*     ENTTYPE FIXED(8);             /* ELEMENT TYPE (IOPPIND VALUES) */ 00754000
*   DCL                                                            0400 00755000
*     ENTNAME CHAR(8);              /* ELEMENT NAME                  */ 00756000
*   DCL                                                            0401 00757000
*     BLDICTYP CHAR(1);             /* ICT TYPE ENTRY                */ 00758000
*   RESPECIFY                                                      0402 00759000
*     ICTPTF BASED(ADDR(BLDESMD));  /* PTF SECT ENTRY PASSED         */ 00760000
*   BLDENTRC=ZERO;                  /* CLEAR RETURN CODE             */ 00761000
         SLR   BLDENTRC,BLDENTRC                                   0403 00762000
*   TMXRETRN=ZERO;                  /* ASSUME ALL IS WELL            */ 00763000
         SLR   TMXRETRN,TMXRETRN                                   0404 00764000
*   RFY                                                            0405 00765000
*     HMASMIOP BASED(ADDR(BLDESUBE)-IOPPTFLN/*                       */ 00766000
*         -LENGTH(HMASMIOP)+1);     /* ADDRESSABILITY TO THE ELEMENT    00767000
*                                      SUB-ENTRY                     */ 00768000
*   ENTTYPE=IOPPIND(1);             /* SAVE IOP ELEMENT TYPE VALUE   */ 00769000
         L     @05,@PC00004+4                                      0406 00770000
         AH    @05,@CH02664                                        0406 00771000
         SLR   ENTTYPE,ENTTYPE                                     0406 00772000
         IC    ENTTYPE,IOPPIND(,@05)                               0406 00773000
*   ENTNAME=IOPPMODS(1);            /* SAVE IOP ELEMENT NAME         */ 00774000
         MVC   ENTNAME(8),IOPPMODS(@05)                            0407 00775000
*   RFY                                                            0408 00776000
*     HMASMIOP BASED;                                              0408 00777000
*                                                                  0408 00778000
*   /*****************************************************************/ 00779000
*   /*                                                               */ 00780000
*   /* GET AND INITIALIZE ICT MOD ENTRY                              */ 00781000
*   /*                                                               */ 00782000
*   /*****************************************************************/ 00783000
*                                                                  0409 00784000
*   BLDENT@=TBLXTOP;                /* ADDR OF ENTRY TO BE OBTAINED  */ 00785000
         L     @05,@PC00001                                        0409 00786000
         MVC   BLDENT@(4),TBLXTOP(@05)                             0409 00787000
*   CALL HMASMTAD(TBLXPARM,         /* PARM LIST                     */ 00788000
*       'M',                        /* BUILD MOD SECTION ENTRY       */ 00789000
*       ENTNAME);                   /* ENTRY NAME                    */ 00790000
         MVC   @AL00001+4(8),@AL00410                              0410 00791000
         ST    @05,@AL00001                                        0410 00792000
         L     @15,@CV02021                                        0410 00793000
         LA    @01,@AL00001                                        0410 00794000
         BALR  @14,@15                                             0410 00795000
*   RESPECIFY                                                      0411 00796000
*     RTNCODE RSTD;                                                0411 00797000
*   BLDENTRC=RTNCODE;               /* SAVE RETURN CODE FROM HMASMTAD*/ 00798000
         LR    BLDENTRC,RTNCODE                                    0412 00799000
*   RESPECIFY                                                      0413 00800000
*     RTNCODE UNRSTD;                                              0413 00801000
*   IF BLDENTRC<STOPPTF THEN                                       0414 00802000
         CH    BLDENTRC,@CH00034                                   0414 00803000
         BNL   @RF00414                                            0414 00804000
*     DO;                                                          0415 00805000
*       RESPECIFY                                                  0416 00806000
*         ICTMOD BASED(BLDENT@);    /* ADDRESSIBILITY TO MOD SECT  0416 00807000
*                                      ENTRY JUST OBTAINED           */ 00808000
*                                                                  0416 00809000
*       /*************************************************************/ 00810000
*       /*                                                           */ 00811000
*       /* CALL THE APPROPRATE PROCESSOR (TM1, TM2, OR TM3 ) TO      */ 00812000
*       /* COMPLETE THE ICT FROM DATA IN THE (A)CDS ELEMENT ENTRY.   */ 00813000
*       /*                                                           */ 00814000
*       /*************************************************************/ 00815000
*                                                                  0417 00816000
*       ICTMFLG1(1)=BLDICTYP;       /* SET ICT MOD ENTRY TYPE AS   0417 00817000
*                                      PASSED                        */ 00818000
         L     @05,BLDENT@                                         0417 00819000
         L     @02,@PC00004+8                                      0417 00820000
         MVC   ICTMFLG1(1,@05),BLDICTYP(@02)                       0417 00821000
*       RESPECIFY                                                  0418 00822000
*         RTNCODE RSTD;                                            0418 00823000
*       IF ICTMMOD(1)=ON&ICTMASM(1)^=ON THEN                       0419 00824000
         TM    ICTMMOD(@05),B'10000000'                            0419 00825000
         BNO   @RF00419                                            0419 00826000
         TM    ICTMASM(@05),B'01000000'                            0419 00827000
         BNZ   @RF00419                                            0419 00828000
*         DO;                                                      0420 00829000
*                                                                  0420 00830000
*           /*********************************************************/ 00831000
*           /*                                                       */ 00832000
*           /* MOD TYPE ENTRY                                        */ 00833000
*           /*                                                       */ 00834000
*           /*********************************************************/ 00835000
*                                                                  0421 00836000
*           CALL HMASMTM1(TBLXPARM, /* PARM LIST                     */ 00837000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 00838000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 00839000
*               ZERO);              /* NULL MCB PTR                  */ 00840000
         MVC   @AL00001+4(12),@AL00421                             0421 00841000
         L     @14,@PC00001                                        0421 00842000
         ST    @14,@AL00001                                        0421 00843000
         L     @14,@PC00004                                        0421 00844000
         ST    @14,@TF00001                                        0421 00845000
         L     @15,@CV02025                                        0421 00846000
         LA    @01,@AL00001                                        0421 00847000
         BALR  @14,@15                                             0421 00848000
*           TMXRETRN=RTNCODE;       /* SAVE RETURN CODE              */ 00849000
         LR    TMXRETRN,RTNCODE                                    0422 00850000
*           CALL MODSRCA(ICTMOD(1));/* CHAIN MOD TO ASSOC. SRC       */ 00851000
         L     @14,BLDENT@                                         0423 00852000
         ST    @14,@AL00001                                        0423 00853000
         LA    @01,@AL00001                                        0423 00854000
         BAL   @14,MODSRCA                                         0423 00855000
*         END;                                                     0424 00856000
*       IF ICTMMACR(1)=ON THEN                                     0425 00857000
@RF00419 L     @14,BLDENT@                                         0425 00858000
         TM    ICTMMACR(@14),B'00001000'                           0425 00859000
         BNO   @RF00425                                            0425 00860000
*         DO;                                                      0426 00861000
*                                                                  0426 00862000
*           /*********************************************************/ 00863000
*           /*                                                       */ 00864000
*           /* MAC TYPE ENTRY                                        */ 00865000
*           /*                                                       */ 00866000
*           /*********************************************************/ 00867000
*                                                                  0427 00868000
*           CALL HMASMTM2(TBLXPARM, /* PARM LIST                     */ 00869000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 00870000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 00871000
*               ZERO);              /* NULL MCB PTR                  */ 00872000
         MVC   @AL00001+4(12),@AL00427                             0427 00873000
         L     @14,@PC00001                                        0427 00874000
         ST    @14,@AL00001                                        0427 00875000
         L     @14,@PC00004                                        0427 00876000
         ST    @14,@TF00001                                        0427 00877000
         L     @15,@CV02026                                        0427 00878000
         LA    @01,@AL00001                                        0427 00879000
         BALR  @14,@15                                             0427 00880000
*           TMXRETRN=RTNCODE;       /* SAVE RETURN CODE              */ 00881000
         LR    TMXRETRN,RTNCODE                                    0428 00882000
*         END;                                                     0429 00883000
*       IF ICTMSRCR(1)=ON THEN                                     0430 00884000
@RF00425 L     @14,BLDENT@                                         0430 00885000
         TM    ICTMSRCR(@14),B'00000010'                           0430 00886000
         BNO   @RF00430                                            0430 00887000
*         DO;                                                      0431 00888000
*                                                                  0431 00889000
*           /*********************************************************/ 00890000
*           /*                                                       */ 00891000
*           /* SRC TYPE ENTRY                                        */ 00892000
*           /*                                                       */ 00893000
*           /*********************************************************/ 00894000
*                                                                  0432 00895000
*           CALL HMASMTM3(TBLXPARM, /* PARM LIST                     */ 00896000
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */ 00897000
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */ 00898000
*               ZERO);              /* NULL MCB PTR                  */ 00899000
         MVC   @AL00001+4(12),@AL00432                             0432 00900000
         L     @14,@PC00001                                        0432 00901000
         ST    @14,@AL00001                                        0432 00902000
         L     @14,@PC00004                                        0432 00903000
         ST    @14,@TF00001                                        0432 00904000
         L     @15,@CV02027                                        0432 00905000
         LA    @01,@AL00001                                        0432 00906000
         BALR  @14,@15                                             0432 00907000
*           TMXRETRN=RTNCODE;       /* SAVE RETURN CODE              */ 00908000
         LR    TMXRETRN,RTNCODE                                    0433 00909000
*           CALL SRCMODA(ICTMOD(1));/* CHAIN SRC TO ASSOC. MOD       */ 00910000
         L     @14,BLDENT@                                         0434 00911000
         ST    @14,@AL00001                                        0434 00912000
         LA    @01,@AL00001                                        0434 00913000
         BAL   @14,SRCMODA                                         0434 00914000
*         END;                                                     0435 00915000
*       IF ICTMASM(1)=ON THEN       /* IS TYPE ASSEMBLY?             */ 00916000
@RF00430 L     @14,BLDENT@                                         0436 00917000
         TM    ICTMASM(@14),B'01000000'                            0436 00918000
         BNO   @RF00436                                            0436 00919000
*         DO;                       /* YES,                          */ 00920000
*                                                                  0437 00921000
*           /*********************************************************/ 00922000
*           /*                                                       */ 00923000
*           /* ASSEMBLY TYPE ENTRY                                   */ 00924000
*           /*                                                       */ 00925000
*           /*********************************************************/ 00926000
*                                                                  0438 00927000
*           ASMBLDF=ON;             /* INDICATE ASSEMBLY SUB ENTRY 0438 00928000
*                                      EXISTS                        */ 00929000
         OI    ASMBLDF,B'10000000'                                 0438 00930000
*           TBLXTOP=TBLXTOP-LENGTH(ICTMOD(1));/* BACK UP ICT ...     */ 00931000
         L     @14,@PC00001                                        0439 00932000
         L     @05,TBLXTOP(,@14)                                   0439 00933000
         SH    @05,@CH02665                                        0439 00934000
         ST    @05,TBLXTOP(,@14)                                   0439 00935000
*           TBLXTOP->ICTMEND(1)=ICTENDNT;/* ... MOD SECTION BY ONE   */ 00936000
         MVC   ICTMEND(4,@05),ICTENDNT                             0440 00937000
*         END;                                                     0441 00938000
*       BLDENTRC=MAX(BLDENTRC,TMXRETRN);/* SET RC                    */ 00939000
@RF00436 CR    BLDENTRC,TMXRETRN                                   0442 00940000
         BNL   *+6                                                      00941000
         LR    BLDENTRC,TMXRETRN                                   0442 00942000
*       RESPECIFY                                                  0443 00943000
*         RTNCODE UNRSTD;                                          0443 00944000
*     END;                                                         0444 00945000
*   ELSE                                                           0445 00946000
*     ;                             /* ERROR CREATING ICT MOD SECTION   00947000
*                                      ENTRY                         */ 00948000
@RF00414 DS    0H                                                  0446 00949000
*   IF BLDENTRC<STOPSMD             /* ALL IS WELL?                  */ 00950000
*       &ICTMASM(1)=OFF THEN        /* AND NOT AN ASSEMBLY?          */ 00951000
         CH    BLDENTRC,@CH00034                                   0446 00952000
         BNL   @RF00446                                            0446 00953000
         L     @02,BLDENT@                                         0446 00954000
         TM    ICTMASM(@02),B'01000000'                            0446 00955000
         BNZ   @RF00446                                            0446 00956000
*     DO;                           /* YES,                          */ 00957000
*                                                                  0447 00958000
*       /*************************************************************/ 00959000
*       /*                                                           */ 00960000
*       /* BUILD ACDS MOD ID LIST AND PROCESS DELETE ELEMENTS        */ 00961000
*       /*                                                           */ 00962000
*       /*************************************************************/ 00963000
*                                                                  0448 00964000
*       CALL BLDAMID(ICTMOD(1),     /* BUILD ACDS MOD ID LIST        */ 00965000
*           CCAIOPTR->HMASMIOP);                                   0448 00966000
         ST    @02,@AL00001                                        0448 00967000
         L     @02,CCAIOPTR(,CCAPTR)                               0448 00968000
         ST    @02,@AL00001+4                                      0448 00969000
         LA    @01,@AL00001                                        0448 00970000
         BAL   @14,BLDAMID                                         0448 00971000
*       RESPECIFY                                                  0449 00972000
*         RTNCODE RSTD;                                            0449 00973000
*       BLDENTRC=MAX(BLDENTRC,RTNCODE);/* SET RC                     */ 00974000
         CR    BLDENTRC,RTNCODE                                    0450 00975000
         BNL   *+6                                                      00976000
         LR    BLDENTRC,RTNCODE                                    0450 00977000
*       RESPECIFY                                                  0451 00978000
*         RTNCODE UNRSTD;                                          0451 00979000
*     END;                                                         0452 00980000
*   RETURN CODE(BLDENTRC);          /* RETURN W/ RC                  */ 00981000
@RF00446 LR    @15,BLDENTRC                                        0453 00982000
         L     @14,@SA00004                                        0453 00983000
         LM    @00,@12,@SA00004+8                                  0453 00984000
         BR    @14                                                 0453 00985000
*   RFY                                                            0454 00986000
*     ICTPTF BASED;                                                0454 00987000
*   RFY                                                            0455 00988000
*     ICTMOD BASED;                                                0455 00989000
*   RFY                                                            0456 00990000
*     HMASMIOP BASED;                                              0456 00991000
*   END BLDENTRY;                                                  0457 00992000
         EJECT                                                          00993000
*                                                                  0458 00994000
*   /*****************************************************************/ 00995000
*   /*                                                               */ 00996000
*   /* ASMGTA - BUILD GTA FILE RECORD FOR EACH ASSEM ENTRY IN THE    */ 00997000
*   /* SYSMOD                                                        */ 00998000
*   /*                                                               */ 00999000
*   /*****************************************************************/ 01000000
*                                                                  0458 01001000
*ASMGTA:                                                           0458 01002000
*   PROC(ASMGIOP);                  /*                               */ 01003000
ASMGTA   STM   @14,@12,@SA00005                                    0458 01004000
         MVC   @PC00005(4),0(@01)                                  0458 01005000
*   DCL                                                            0459 01006000
*     ASMGIOP CHAR(*);              /* SYSMOD IOP FOR WHICH TO BUILD    01007000
*                                      GTA FILE                      */ 01008000
*   DCL                                                            0460 01009000
*     ASMGRC FIXED(15);             /* LOCAL RETURN CODE             */ 01010000
*   DCL                                                            0461 01011000
*     ASMGX1 FIXED(31);             /* IOP SUB-ENTRY LOOP COUNTER    */ 01012000
*   RFY                                                            0462 01013000
*     HMASMIOP BASED(ADDR(ASMGIOP));                               0462 01014000
*   RFY                                                            0463 01015000
*     HMASMGTP BASED(ADDR(ASMGTP));                                0463 01016000
*   ASMGRC=''B;                     /* CLEAR LOCAL RETURN CODE       */ 01017000
         SLR   ASMGRC,ASMGRC                                       0464 01018000
*   TM4RCD=''B;                     /* CLEAR THE RECORD              */ 01019000
*                                                                  0465 01020000
         XC    TM4RCD(12),TM4RCD                                   0465 01021000
*   /*****************************************************************/ 01022000
*   /*                                                               */ 01023000
*   /* INITIALIZE THE GTA FILE                                       */ 01024000
*   /*                                                               */ 01025000
*   /*****************************************************************/ 01026000
*                                                                  0466 01027000
*   GTPFUNCT=GTPFREE;               /* FREE THE FILE                 */ 01028000
         LA    @03,ASMGTP                                          0466 01029000
         MVI   GTPFUNCT(@03),X'0A'                                 0466 01030000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 01031000
         ST    @03,@AL00001                                        0467 01032000
         L     @15,@CV02020                                        0467 01033000
         LA    @01,@AL00001                                        0467 01034000
         BALR  @14,@15                                             0467 01035000
*   GTPFUNCT=GTPADD;                /* FUNCTION WILL BE ADD          */ 01036000
         LA    @03,ASMGTP                                          0468 01037000
         MVI   GTPFUNCT(@03),X'04'                                 0468 01038000
*   DO ASMGX1=1 BY 1                /* PROCESS ALL IOP SUBENTRIES    */ 01039000
*         WHILE(IOPPTFND(ASMGX1)^=IOPEOLST/* ...                     */ 01040000
*         &ASMGRC<STOPFUNC);        /*                               */ 01041000
         LA    ASMGX1,1                                            0469 01042000
         B     @DE00469                                            0469 01043000
@DL00469 DS    0H                                                  0470 01044000
*     IF IOPPIND(ASMGX1)=IOPPASM THEN/* SUB-ENTRY IS ASSEM TYPE?     */ 01045000
         LR    @15,ASMGX1                                          0470 01046000
         MH    @15,@CH00035                                        0470 01047000
         L     @14,@PC00005                                        0470 01048000
         SLR   @07,@07                                             0470 01049000
         IC    @07,IOPPIND-9(@15,@14)                              0470 01050000
         CH    @07,@CH00034                                        0470 01051000
         BNE   @RF00470                                            0470 01052000
*       DO;                         /* YES,                          */ 01053000
*         TM4NAME=IOPPMODS(ASMGX1); /* SET ELEMENT NAME IN GTA RECORD*/ 01054000
         ALR   @14,@15                                             0472 01055000
         MVC   TM4NAME(8),IOPPMODS-9(@14)                          0472 01056000
*         CALL HMASMGTA(HMASMGTP);  /* ADD TO FILE                   */ 01057000
         LA    @15,ASMGTP                                          0473 01058000
         ST    @15,@AL00001                                        0473 01059000
         L     @15,@CV02020                                        0473 01060000
         LA    @01,@AL00001                                        0473 01061000
         BALR  @14,@15                                             0473 01062000
*         ASMGRC=MAX(ASMGRC,GTPRETRN);/* SAVE RETURN CODE            */ 01063000
         LA    @15,ASMGTP                                          0474 01064000
         SLR   @14,@14                                             0474 01065000
         IC    @14,GTPRETRN(,@15)                                  0474 01066000
         CR    ASMGRC,@14                                          0474 01067000
         BNL   *+6                                                      01068000
         LR    ASMGRC,@14                                          0474 01069000
*       END;                        /*                               */ 01070000
*     ELSE                                                         0476 01071000
*       ;                           /* NOT AN ASSEM ENTRY            */ 01072000
@RF00470 DS    0H                                                  0477 01073000
*   END;                            /* END OF LOOP THRU IOP          */ 01074000
         AH    ASMGX1,@CH00064                                     0477 01075000
@DE00469 LR    @15,ASMGX1                                          0477 01076000
         MH    @15,@CH00035                                        0477 01077000
         L     @14,@PC00005                                        0477 01078000
         SLR   @07,@07                                             0477 01079000
         IC    @07,IOPPTFND-9(@15,@14)                             0477 01080000
         CH    @07,@CH00707                                        0477 01081000
         BE    @DC00469                                            0477 01082000
         CH    ASMGRC,@CH00033                                     0477 01083000
         BL    @DL00469                                            0477 01084000
@DC00469 DS    0H                                                  0478 01085000
*   RETURN CODE(ASMGRC);            /*                               */ 01086000
         LR    @15,ASMGRC                                          0478 01087000
         L     @14,@SA00005                                        0478 01088000
         LM    @00,@12,@SA00005+8                                  0478 01089000
         BR    @14                                                 0478 01090000
*   END ASMGTA;                     /*                               */ 01091000
         EJECT                                                          01092000
*                                                                  0480 01093000
*/********************************************************************/ 01094000
*/*                                                                  */ 01095000
*/*    SRCMODA  - FOR THE ++SRC MOD SECTION ENTRY PASSED, LOOK IN    */ 01096000
*/*               THE ICT FOR AN ASSOCIATED ++MOD MOD SECTION        */ 01097000
*/*               ENTRY                                              */ 01098000
*/*                                                                  */ 01099000
*/*    CONDITIONS UPON ENTRY:                                        */ 01100000
*/*                                                                  */ 01101000
*/*                                                                  */ 01102000
*/*    CONDITIONS UPON EXIT:                                         */ 01103000
*/*                                                                  */ 01104000
*/*     * SET IN ++SRC MOD SECTION ENTRY PASSED:                     */ 01105000
*/*                                                                  */ 01106000
*/*     - ICTMASOC - SET IF ASSOCIATED ++MOD MOD SECTION ENTRY FOUND */ 01107000
*/*                                                                  */ 01108000
*/*     * SET IN ASSOCIATED ++MOD MOD SECT. ENTRY:                   */ 01109000
*/*                                                                  */ 01110000
*/*     - ICTMASOC - ASSOICATED ++SRC ENTRY EXISTS                   */ 01111000
*/*                                                                  */ 01112000
*/********************************************************************/ 01113000
*                                                                  0480 01114000
*SRCMODA:                                                          0480 01115000
*   PROC(SRCENTRY);                                                0480 01116000
SRCMODA  STM   @14,@12,12(@13)                                     0480 01117000
         MVC   @PC00006(4),0(@01)                                  0480 01118000
*   DCL                                                            0481 01119000
*     SRCENTRY CHAR(*);             /* ICT MOD SECT ENTRY FOR ++SRC     01120000
*                                      OR ++SRCUPD ELEMENT           */ 01121000
*   DCL                                                            0482 01122000
*     UU FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/ 01123000
*   DCL                                                            0483 01124000
*     SRCNAME CHAR(8);              /* SOURCE ELEMENT NAME           */ 01125000
*   DCL                                                            0484 01126000
*     SRCSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++SRC*/ 01127000
*   DCL                                                            0485 01128000
*     SRCSPTR PTR(31);              /* PTR TO ++SRC MOD ENTRY PASSED */ 01129000
*   DCL                                                            0486 01130000
*     SRCMPTR PTR(31);              /* PTR TO ASSOC ++MOD ENTRY      */ 01131000
*   RESPECIFY                                                      0487 01132000
*     ICTMOD BASED(ADDR(SRCENTRY)); /* ADDRESS ENTRY PASSED          */ 01133000
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC. MOD FLAG         */ 01134000
         L     @02,@PC00006                                        0488 01135000
         NI    ICTMASOC(@02),B'11101111'                           0488 01136000
*   SRCNAME=ICTMNAME(1);            /* SRC ELEMENT NAME              */ 01137000
         MVC   SRCNAME(8),ICTMNAME(@02)                            0489 01138000
*   SRCSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */ 01139000
         L     SRCSMD@,ICTPPTR(,@02)                               0490 01140000
*   SRCSPTR=ADDR(SRCENTRY);         /* SAVE ADDR OF ++SRC ENTRY      */ 01141000
         LR    SRCSPTR,@02                                         0491 01142000
*   SRCMPTR=0;                      /* CLEAR PTR TO ASSOC ++MOD      */ 01143000
*                                                                  0492 01144000
         SLR   SRCMPTR,SRCMPTR                                     0492 01145000
*   /*****************************************************************/ 01146000
*   /*                                                               */ 01147000
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC MOD SECT ENTRY      */ 01148000
*   /*                                                               */ 01149000
*   /*****************************************************************/ 01150000
*                                                                  0493 01151000
*   RESPECIFY                                                      0493 01152000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 01153000
*   DO UU=1 BY 1 WHILE ICTMEND(UU)^=ICTENDNT&SRCMPTR=0;            0494 01154000
         LA    UU,1                                                0494 01155000
         B     @DE00494                                            0494 01156000
@DL00494 DS    0H                                                  0495 01157000
*     IF ICTMNAME(UU)=SRCNAME       /* ELEMENT NAMES EQUAL           */ 01158000
*         &ICTMMOD(UU)=ON           /* MOD ENTRY                     */ 01159000
*         &ICTMASM(UU)=OFF          /* ... NOT ASSEMBLY ENTRY        */ 01160000
*         &ICTPPTR(UU)=SRCSMD@      /* "CURRENT" SYSMOD              */ 01161000
*       THEN                                                       0495 01162000
         LR    @15,UU                                              0495 01163000
         MH    @15,@CH02665                                        0495 01164000
         L     @14,CCAICMOD(,CCAPTR)                               0495 01165000
         ST    @15,@TF00001                                        0495 01166000
         ALR   @15,@14                                             0495 01167000
         AL    @15,@CF02699                                        0495 01168000
         CLC   ICTMNAME(8,@15),SRCNAME                             0495 01169000
         BNE   @RF00495                                            0495 01170000
         LR    @15,@14                                             0495 01171000
         AL    @15,@TF00001                                        0495 01172000
         AL    @15,@CF02700                                        0495 01173000
         TM    ICTMMOD-9(@15),B'10000000'                          0495 01174000
         BNO   @RF00495                                            0495 01175000
         TM    ICTMASM-9(@15),B'01000000'                          0495 01176000
         BNZ   @RF00495                                            0495 01177000
         L     @15,@TF00001                                        0495 01178000
         AL    @15,@CF02701                                        0495 01179000
         C     SRCSMD@,ICTPPTR-96(@15,@14)                         0495 01180000
         BNE   @RF00495                                            0495 01181000
*       DO;                                                        0496 01182000
*                                                                  0496 01183000
*         /***********************************************************/ 01184000
*         /*                                                         */ 01185000
*         /* ASSOCIATED ++MOD MOD ENTRY FOUND                        */ 01186000
*         /*                                                         */ 01187000
*         /***********************************************************/ 01188000
*                                                                  0497 01189000
*         ICTMASOC(UU)=ON;          /* SET ASSOC ++SRC IN ++MOD ENTRY*/ 01190000
         LR    @15,@14                                             0497 01191000
         AL    @15,@TF00001                                        0497 01192000
         AL    @15,@CF02702                                        0497 01193000
         OI    ICTMASOC-11(@15),B'00010000'                        0497 01194000
*         SRCMPTR=ADDR(ICTMOD(UU)); /* POINT TO ++MOD ENTRY FOUND    */ 01195000
         L     SRCMPTR,@TF00001                                    0498 01196000
         AL    @14,@CF02699                                        0498 01197000
         LA    SRCMPTR,ICTMOD(SRCMPTR,@14)                         0498 01198000
*         SRCSPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++MOD IN ++SRC ENTRY*/ 01199000
         OI    ICTMASOC(SRCSPTR),B'00010000'                       0499 01200000
*       END;                                                       0500 01201000
*   END;                                                           0501 01202000
@RF00495 AH    UU,@CH00064                                         0501 01203000
@DE00494 LR    @15,UU                                              0501 01204000
         MH    @15,@CH02665                                        0501 01205000
         L     @01,CCAICMOD(,CCAPTR)                               0501 01206000
         AL    @01,@CF02699                                        0501 01207000
         L     @15,ICTMEND(@15,@01)                                0501 01208000
         CL    @15,ICTENDNT                                        0501 01209000
         BE    @DC00494                                            0501 01210000
         LTR   SRCMPTR,SRCMPTR                                     0501 01211000
         BZ    @DL00494                                            0501 01212000
@DC00494 DS    0H                                                  0502 01213000
*   RETURN;                                                        0502 01214000
@EL00006 DS    0H                                                  0502 01215000
@EF00006 DS    0H                                                  0502 01216000
@ER00006 LM    @14,@12,12(@13)                                     0502 01217000
         BR    @14                                                 0502 01218000
*   RFY                                                            0503 01219000
*     ICTMOD BASED;                                                0503 01220000
*   END SRCMODA;                                                   0504 01221000
         EJECT                                                          01222000
*                                                                  0505 01223000
*/********************************************************************/ 01224000
*/*                                                                  */ 01225000
*/*    MODSRCA  - FOR THE ++MOD MOD SECTION ENTRY PASSED, LOOK IN    */ 01226000
*/*               THE ICT FOR AN ASSOCIATED ++SRC MOD SECTION        */ 01227000
*/*               ENTRY                                              */ 01228000
*/*                                                                  */ 01229000
*/*    CONDITIONS UPON ENTRY:                                        */ 01230000
*/*                                                                  */ 01231000
*/*                                                                  */ 01232000
*/*    CONDITIONS UPON EXIT:                                         */ 01233000
*/*                                                                  */ 01234000
*/*     * SET IN ++MOD MOD SECTION ENTRY PASSED:                     */ 01235000
*/*                                                                  */ 01236000
*/*     - ICTMASOC - SET IF ASSOICATED ++SRC MOD SECT ENTRY FOUND    */ 01237000
*/*                                                                  */ 01238000
*/*     * SET IN ++SRC MOD SECTION ENTRY ASSOCIATED WITH ++MOD:      */ 01239000
*/*                                                                  */ 01240000
*/*     - ICTMASOC - ASSOCIATED ++MOD MOD SECTION ENTRY EXISTS       */ 01241000
*/*                                                                  */ 01242000
*/********************************************************************/ 01243000
*                                                                  0505 01244000
*MODSRCA:                                                          0505 01245000
*   PROC(MODENTRY);                                                0505 01246000
MODSRCA  STM   @14,@12,12(@13)                                     0505 01247000
         MVC   @PC00007(4),0(@01)                                  0505 01248000
*   DCL                                                            0506 01249000
*     MODENTRY CHAR(*);             /* ICT MOD SECT. ENTRY FOR ++MOD    01250000
*                                      ELEMENT                       */ 01251000
*   DCL                                                            0507 01252000
*     TT FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/ 01253000
*   DCL                                                            0508 01254000
*     MODNAME CHAR(8);              /* ELEMENT NAME                  */ 01255000
*   DCL                                                            0509 01256000
*     MODSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++MOD*/ 01257000
*   DCL                                                            0510 01258000
*     MODMPTR PTR(31);              /* PTR TO ++MOD MOD ENTRY PASSED */ 01259000
*   DCL                                                            0511 01260000
*     MODSPTR PTR(31);              /* PTR TO ++SRC ENTRY FOUND      */ 01261000
*   RESPECIFY                                                      0512 01262000
*     ICTMOD BASED(ADDR(MODENTRY)); /* ADDRESS ENTRY PASSED          */ 01263000
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC ++SRC FLAG        */ 01264000
         L     @02,@PC00007                                        0513 01265000
         NI    ICTMASOC(@02),B'11101111'                           0513 01266000
*   MODNAME=ICTMNAME(1);            /* MOD ELEMENT NAME              */ 01267000
         MVC   MODNAME(8),ICTMNAME(@02)                            0514 01268000
*   MODSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */ 01269000
         L     MODSMD@,ICTPPTR(,@02)                               0515 01270000
*   MODMPTR=ADDR(MODENTRY);         /* PTR TO ++MOD ENTRY PASSED     */ 01271000
         LR    MODMPTR,@02                                         0516 01272000
*   MODSPTR=0;                      /* PTR TO ++SRC ENTRY FOUND      */ 01273000
*                                                                  0517 01274000
         SLR   MODSPTR,MODSPTR                                     0517 01275000
*   /*****************************************************************/ 01276000
*   /*                                                               */ 01277000
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC ++SRC MOD SECT ENTRY*/ 01278000
*   /*                                                               */ 01279000
*   /*****************************************************************/ 01280000
*                                                                  0518 01281000
*   RESPECIFY                                                      0518 01282000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */ 01283000
*   DO TT=1 BY 1 WHILE ICTMEND(TT)^=ICTENDNT&MODSPTR=0;            0519 01284000
         LA    TT,1                                                0519 01285000
         B     @DE00519                                            0519 01286000
@DL00519 DS    0H                                                  0520 01287000
*     IF ICTMNAME(TT)=MODNAME       /* ELEMENT NAMES EQUAL           */ 01288000
*         &(ICTMSRCR(TT)=ON         /* ++SRC ENTRY                   */ 01289000
*         |ICTMSRCU(TT)=ON)         /* ++SRCUPD ENTRY                */ 01290000
*         &ICTPPTR(TT)=MODSMD@      /* "CURRENT" SYSMOD              */ 01291000
*       THEN                                                       0520 01292000
         LR    @15,TT                                              0520 01293000
         MH    @15,@CH02665                                        0520 01294000
         L     @14,CCAICMOD(,CCAPTR)                               0520 01295000
         ST    @15,@TF00001                                        0520 01296000
         ALR   @15,@14                                             0520 01297000
         AL    @15,@CF02699                                        0520 01298000
         CLC   ICTMNAME(8,@15),MODNAME                             0520 01299000
         BNE   @RF00520                                            0520 01300000
         LR    @15,@14                                             0520 01301000
         AL    @15,@TF00001                                        0520 01302000
         AL    @15,@CF02700                                        0520 01303000
         TM    ICTMSRCR-9(@15),B'00000011'                         0520 01304000
         BZ    @RF00520                                            0520 01305000
         L     @15,@TF00001                                        0520 01306000
         AL    @15,@CF02701                                        0520 01307000
         C     MODSMD@,ICTPPTR-96(@15,@14)                         0520 01308000
         BNE   @RF00520                                            0520 01309000
*       DO;                                                        0521 01310000
*                                                                  0521 01311000
*         /***********************************************************/ 01312000
*         /*                                                         */ 01313000
*         /* ASSOCIATED ++SRC OR ++SRCUPD MOD ENTRY FOUND            */ 01314000
*         /*                                                         */ 01315000
*         /***********************************************************/ 01316000
*                                                                  0522 01317000
*         ICTMASOC(TT)=ON;          /* SET ASSOC ++MOD IN ++SRC ENTRY*/ 01318000
         LR    @15,@14                                             0522 01319000
         AL    @15,@TF00001                                        0522 01320000
         AL    @15,@CF02702                                        0522 01321000
         OI    ICTMASOC-11(@15),B'00010000'                        0522 01322000
*         MODSPTR=ADDR(ICTMOD(TT)); /* POINT ++SRC ENTRY FOUND       */ 01323000
         L     MODSPTR,@TF00001                                    0523 01324000
         AL    @14,@CF02699                                        0523 01325000
         LA    MODSPTR,ICTMOD(MODSPTR,@14)                         0523 01326000
*         MODMPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++SRC IN ++MOD ENTRY*/ 01327000
         OI    ICTMASOC(MODMPTR),B'00010000'                       0524 01328000
*       END;                                                       0525 01329000
*   END;                                                           0526 01330000
@RF00520 AH    TT,@CH00064                                         0526 01331000
@DE00519 LR    @15,TT                                              0526 01332000
         MH    @15,@CH02665                                        0526 01333000
         L     @01,CCAICMOD(,CCAPTR)                               0526 01334000
         AL    @01,@CF02699                                        0526 01335000
         L     @15,ICTMEND(@15,@01)                                0526 01336000
         CL    @15,ICTENDNT                                        0526 01337000
         BE    @DC00519                                            0526 01338000
         LTR   MODSPTR,MODSPTR                                     0526 01339000
         BZ    @DL00519                                            0526 01340000
@DC00519 DS    0H                                                  0527 01341000
*   RETURN;                                                        0527 01342000
@EL00007 DS    0H                                                  0527 01343000
@EF00007 DS    0H                                                  0527 01344000
@ER00007 LM    @14,@12,12(@13)                                     0527 01345000
         BR    @14                                                 0527 01346000
*   RFY                                                            0528 01347000
*     ICTMOD BASED;                                                0528 01348000
*   END MODSRCA;                                                   0529 01349000
         EJECT                                                          01350000
*                                                                  0530 01351000
*/********************************************************************/ 01352000
*/*                                                                  */ 01353000
*/* BLDAMID - BUILD ACDS MOD ID LIST FOR AN ELEMENT                  */ 01354000
*/*                                                                  */ 01355000
*/* INPUT  - ICT MOD ENTRY PASSED AS A PARAMETER                     */ 01356000
*/*        - IOP TO BE USED FOR EXTENDED LOCATE OF ACDS MOD ENTRY    */ 01357000
*/*                                                                  */ 01358000
*/* OUTPUT - ACDS MOD ID LIST IN THE ICT INDEX AREA                  */ 01359000
*/*                                                                  */ 01360000
*/*        - RC                                                      */ 01361000
*/*           0  - SUCCESSFUL                                        */ 01362000
*/*           12 - I/O ERROR OR NOT ENOUGH STORAGE FOR INDEX LIST    */ 01363000
*/*           16 - I/O ERROR                                         */ 01364000
*/*                                                                  */ 01365000
*/********************************************************************/ 01366000
*                                                                  0530 01367000
*BLDAMID:                                                          0530 01368000
*   PROC(BLDAENT,                   /* ICT MOD ENTRY                 */ 01369000
*       BLDAIOP);                   /* EXTENDED IOP TO BE USED       */ 01370000
BLDAMID  STM   @14,@12,@SA00008                                    0530 01371000
         MVC   @PC00008(8),0(@01)                                  0530 01372000
*   DCL                                                            0531 01373000
*     BLDAENT CHAR(*);              /* ICT MOD ENTRY FOR WHICH ID  0531 01374000
*                                      LIST TO BE BUILT              */ 01375000
*   DCL                                                            0532 01376000
*     BLDAIOP CHAR(*);              /* IOP FOR THE EXTENDED ELEMENT     01377000
*                                      ENTRY                         */ 01378000
*   DCL                                                            0533 01379000
*     BLDARC FIXED(15);             /* LOCAL RETURN CODE             */ 01380000
*   DCL                                                            0534 01381000
*     BLDAIOPT FIXED(8);            /* IOPTYPE CORRESPONDING TO ICT     01382000
*                                      ENTRY TYPE                    */ 01383000
*   DCL                                                            0535 01384000
*     BLDADUMM FIXED(8);            /* DUMMY PARM FOR CALL TO CNVTYP1*/ 01385000
*   DCL                                                            0536 01386000
*     BLDAX1 FIXED(31);             /* IOP SUB-ENTRY INDEX COUNTER   */ 01387000
*   DCL                                                            0537 01388000
*     BLDAX2 FIXED(31);             /* ICT MOD ENTRY INDEX COUNTER   */ 01389000
*   RFY                                                            0538 01390000
*     HMASMIOP BASED(ADDR(BLDAIOP));                               0538 01391000
*   RFY                                                            0539 01392000
*     ICTMOD BASED(ADDR(BLDAENT));                                 0539 01393000
*   RFY                                                            0540 01394000
*     HMASMGTP BASED(ADDR(ASMGTP));                                0540 01395000
*   BLDARC=ZERO;                    /* CLEAR THE LOCAL RETURN CODE   */ 01396000
         SLR   BLDARC,BLDARC                                       0541 01397000
*   CALL CNVTYP1(ICTMOD(1),         /* CONVERT CURRENT MOD ENTRY TYPE   01398000
*                                      TO ...                        */ 01399000
*       BLDAIOPT,                   /* ... THE CORRESPONDING IOPTYPE */ 01400000
*       BLDADUMM);                  /* ...                           */ 01401000
         MVC   @AL00001+4(8),@AL00542                              0542 01402000
         L     @02,@PC00008                                        0542 01403000
         ST    @02,@AL00001                                        0542 01404000
         LA    @01,@AL00001                                        0542 01405000
         BAL   @14,CNVTYP1                                         0542 01406000
*                                                                  0543 01407000
*   /*****************************************************************/ 01408000
*   /*                                                               */ 01409000
*   /* LOCATE THE ELEMENT ON THE ACDS                                */ 01410000
*   /*                                                               */ 01411000
*   /*****************************************************************/ 01412000
*                                                                  0543 01413000
*   IOPDSID=IOPACDS;                /* GET EXTENDED ACDS ...         */ 01414000
         L     @02,@PC00008+4                                      0543 01415000
         MVI   IOPDSID(@02),X'0C'                                  0543 01416000
*   IOPFUNCT=IOPLOC;                /* ...                           */ 01417000
         MVI   IOPFUNCT(@02),X'03'                                 0544 01418000
*   IOPTYPE=BLDAIOPT;               /* ... ELEMENT ENTRY ...         */ 01419000
         MVC   IOPTYPE(1,@02),BLDAIOPT                             0545 01420000
*   IOPNAME=ICTMNAME(1);            /* ... FOR THE ICT ENTRY ...     */ 01421000
         L     @15,@PC00008                                        0546 01422000
         MVC   IOPNAME(8,@02),ICTMNAME(@15)                        0546 01423000
*   CALL HMASMIO(HMASMIOP);         /* ...                           */ 01424000
         ST    @02,@AL00001                                        0547 01425000
         L     @15,@CV02017                                        0547 01426000
         LA    @01,@AL00001                                        0547 01427000
         BALR  @14,@15                                             0547 01428000
*   IF IOPRETRN>IOPNTFND THEN       /* IO ERROR?                     */ 01429000
         L     @02,@PC00008+4                                      0548 01430000
         CLI   IOPRETRN(@02),4                                     0548 01431000
         BNH   @RF00548                                            0548 01432000
*     DO;                           /* YES,                          */ 01433000
*       BLDARC=MAX(BLDARC,IOPRETRN);/* SET THE RETURN CODE           */ 01434000
         SLR   @15,@15                                             0550 01435000
         IC    @15,IOPRETRN(,@02)                                  0550 01436000
         CR    BLDARC,@15                                          0550 01437000
         BNL   *+6                                                      01438000
         LR    BLDARC,@15                                          0550 01439000
*     END;                                                         0551 01440000
*   IF IOPRETRN=IOPNTFND THEN       /* ELEMENT NOT FOUND ON ACDS?    */ 01441000
@RF00548 L     @02,@PC00008+4                                      0552 01442000
         CLI   IOPRETRN(@02),4                                     0552 01443000
         BNE   @RF00552                                            0552 01444000
*     DO;                           /* YES,                          */ 01445000
*                                                                  0553 01446000
*       /*************************************************************/ 01447000
*       /*                                                           */ 01448000
*       /* THE ELEMENT EXISTS ON THE CDS BUT NOT THE ACDS: IT MUST   */ 01449000
*       /* HAVE BEEN ADDED TO THE TARGET SYSTEM BY ONE OF THE SYSMODS*/ 01450000
*       /* BEING RESTORED.                                           */ 01451000
*       /*                                                           */ 01452000
*       /*************************************************************/ 01453000
*                                                                  0554 01454000
*       IF ICTMASM(1)^=ON THEN      /* NOT AN ASSEM ELEMENT?         */ 01455000
         L     @02,@PC00008                                        0554 01456000
         TM    ICTMASM(@02),B'01000000'                            0554 01457000
         BO    @RF00554                                            0554 01458000
*         DO;                       /* YES,                          */ 01459000
*           ICTMIDEL(1)=ON;         /* DELETE THE ELEMENT            */ 01460000
         OI    ICTMIDEL(@02),B'01000000'                           0556 01461000
*           ICTFMLIB(1)=BLANKS;     /* CLEAR FROM LIB DD NAME        */ 01462000
         MVC   ICTFMLIB(8,@02),@CC02075                            0557 01463000
*         END;                      /*                               */ 01464000
*       ELSE                                                       0559 01465000
*         ;                         /* ELEMENT IS AN ASSEMBLY        */ 01466000
@RF00554 DS    0H                                                  0560 01467000
*     END;                                                         0560 01468000
*   IF BLDARC=ZERO                  /* ALL IS WELL?                  */ 01469000
*       &IOPRETRN^=IOPNTFND THEN                                   0561 01470000
@RF00552 LTR   BLDARC,BLDARC                                       0561 01471000
         BNZ   @RF00561                                            0561 01472000
         L     @02,@PC00008+4                                      0561 01473000
         CLI   IOPRETRN(@02),4                                     0561 01474000
         BE    @RF00561                                            0561 01475000
*     DO;                           /* YES,                          */ 01476000
*                                                                  0562 01477000
*       /*************************************************************/ 01478000
*       /*                                                           */ 01479000
*       /* CALL HMASMTID TO BUILD THE MOD ID LIST                    */ 01480000
*       /*                                                           */ 01481000
*       /*************************************************************/ 01482000
*                                                                  0563 01483000
*       CALL HMASMTID(TBLXPARM,     /* TBLX PARM                     */ 01484000
*           ADDR(ICTMOD(1)),        /* PTR TO ICT MOD ENTRY          */ 01485000
*           ICTMICHA(1),            /* PTR TO ACDS MOD ID LIST       */ 01486000
*           HMASMIOP);              /* IOP W/ EXTENDED ACDS IOP ENTRY*/ 01487000
         L     @15,@PC00001                                        0563 01488000
         ST    @15,@AL00001                                        0563 01489000
         L     @15,@PC00008                                        0563 01490000
         ST    @15,@TF00001                                        0563 01491000
         LA    @14,@TF00001                                        0563 01492000
         ST    @14,@AL00001+4                                      0563 01493000
         LA    @15,ICTMICHA(,@15)                                  0563 01494000
         ST    @15,@AL00001+8                                      0563 01495000
         ST    @02,@AL00001+12                                     0563 01496000
         L     @15,@CV02023                                        0563 01497000
         LA    @01,@AL00001                                        0563 01498000
         BALR  @14,@15                                             0563 01499000
*       RFY                                                        0564 01500000
*         RTNCODE RSTD;                                            0564 01501000
*       BLDARC=MAX(BLDARC,RTNCODE); /* SAVE RETURN CODE              */ 01502000
         CR    BLDARC,RTNCODE                                      0565 01503000
         BNL   *+6                                                      01504000
         LR    BLDARC,RTNCODE                                      0565 01505000
*       RFY                                                        0566 01506000
*         RTNCODE UNRSTD;                                          0566 01507000
*       ICTMFMID(1)=IOPFMID;        /* FMID IS ACDS FMID             */ 01508000
         L     @02,@PC00008                                        0567 01509000
         L     @15,@PC00008+4                                      0567 01510000
         MVC   ICTMFMID(7,@02),IOPFMID(@15)                        0567 01511000
*       ICTMRMID(1)=IOPRMID;        /* RMID IS ACDS RMID             */ 01512000
         MVC   ICTMRMID(7,@02),IOPRMID(@15)                        0568 01513000
*       ICTMDSTL(1)=IOPMCDLB;       /* DISTLIB FROM THE ACDS         */ 01514000
         MVC   ICTMDSTL(8,@02),IOPMCDLB(@15)                       0569 01515000
*       ICTFMLIB(1)=IOPMCDLB;       /* FROM LIB IS DISTLIB           */ 01516000
         MVC   ICTFMLIB(8,@02),IOPMCDLB(@15)                       0570 01517000
*       ICTMTCHN(1)=TBLXNULL;       /* DISREGARD CDS ALIAS LIST      */ 01518000
         L     @15,@PC00001                                        0571 01519000
         MVC   ICTMTCHN(4,@02),TBLXNULL(@15)                       0571 01520000
*       DO BLDAX1=1 BY 1            /* SEARCH ALL SUB-ENTRIES FOR  0572 01521000
*                                      ALIASES                       */ 01522000
*             WHILE(IOPMACND(BLDAX1)^=IOPEOLST);                   0572 01523000
         LA    BLDAX1,1                                            0572 01524000
         B     @DE00572                                            0572 01525000
@DL00572 DS    0H                                                  0573 01526000
*         IF IOPMCTYP(BLDAX1)=IOPMCMAL THEN/* ALIAS ENTRY?           */ 01527000
         LR    @05,BLDAX1                                          0573 01528000
         MH    @05,@CH00035                                        0573 01529000
         L     @02,@PC00008+4                                      0573 01530000
         SLR   @15,@15                                             0573 01531000
         IC    @15,IOPMCTYP-9(@05,@02)                             0573 01532000
         CH    @15,@CH00273                                        0573 01533000
         BNE   @RF00573                                            0573 01534000
*           DO;                     /* YES,                          */ 01535000
*             CALL HMASMTAI(TBLXPARM,/* ADD ALIAS TO INDEX LIST      */ 01536000
*                 ICTMTCHN(1),      /* ...                           */ 01537000
*                 ADDR(IOPMCDTA(BLDAX1)),/* ...                      */ 01538000
*                 LENGTH(ICTTALLS));/* ...                           */ 01539000
         L     @15,@PC00001                                        0575 01540000
         ST    @15,@AL00001                                        0575 01541000
         L     @15,@PC00008                                        0575 01542000
         LA    @15,ICTMTCHN(,@15)                                  0575 01543000
         ST    @15,@AL00001+4                                      0575 01544000
         LA    @05,IOPMCDTA-9(@05,@02)                             0575 01545000
         ST    @05,@TF00001                                        0575 01546000
         LA    @05,@TF00001                                        0575 01547000
         ST    @05,@AL00001+8                                      0575 01548000
         LA    @05,@CF00034                                        0575 01549000
         ST    @05,@AL00001+12                                     0575 01550000
         L     @15,@CV02022                                        0575 01551000
         LA    @01,@AL00001                                        0575 01552000
         BALR  @14,@15                                             0575 01553000
*             RESPECIFY                                            0576 01554000
*               RTNCODE RSTD;                                      0576 01555000
*             BLDARC=MAX(BLDARC,RTNCODE);/* SAVE RETURN CODE FROM TAI*/ 01556000
         CR    BLDARC,RTNCODE                                      0577 01557000
         BNL   *+6                                                      01558000
         LR    BLDARC,RTNCODE                                      0577 01559000
*             RESPECIFY                                            0578 01560000
*               RTNCODE UNRSTD;                                    0578 01561000
*           END;                                                   0579 01562000
*         ELSE                                                     0580 01563000
*           ;                       /* NOT AN ALIAS, SO SKIP IT      */ 01564000
@RF00573 DS    0H                                                  0581 01565000
*       END;                        /*                               */ 01566000
         AH    BLDAX1,@CH00064                                     0581 01567000
@DE00572 LR    @05,BLDAX1                                          0581 01568000
         MH    @05,@CH00035                                        0581 01569000
         L     @02,@PC00008+4                                      0581 01570000
         SLR   @15,@15                                             0581 01571000
         IC    @15,IOPMACND-9(@05,@02)                             0581 01572000
         CH    @15,@CH00707                                        0581 01573000
         BNE   @DL00572                                            0581 01574000
*     END;                                                         0582 01575000
*                                                                  0582 01576000
*   /*****************************************************************/ 01577000
*   /*                                                               */ 01578000
*   /* PROCESS ANY ASSEM ENTRIES ADDED AS A RESULT OF A MACRO OR SRC */ 01579000
*   /* THIS CONSISTS OF DELETING ASSEM NAMES FROM GTA FILE THAT WILL */ 01580000
*   /* BE PASSED TO TM4 TO COMPLETE PROCESSING OF EACH SYSMOD        */ 01581000
*   /*                                                               */ 01582000
*   /*****************************************************************/ 01583000
*                                                                  0583 01584000
*   DO BLDAX2=2 BY 1                /* PROCESS ALL MOD ENTRIES ...   */ 01585000
*         WHILE(ICTMEND(BLDAX2)^=ICTENDNT/* CREATED FOR THIS         */ 01586000
*         &BLDARC<STOPSMD);         /* ELEMENT                       */ 01587000
@RF00561 LA    BLDAX2,2                                            0583 01588000
         B     @DE00583                                            0583 01589000
@DL00583 DS    0H                                                  0584 01590000
*     IF ICTMASM(BLDAX2)=ON THEN    /* ASSEM ENTRY?                  */ 01591000
         LR    @05,BLDAX2                                          0584 01592000
         MH    @05,@CH02665                                        0584 01593000
         L     @02,@PC00008                                        0584 01594000
         ST    @05,@TF00001                                        0584 01595000
         ALR   @05,@02                                             0584 01596000
         AL    @05,@CF02700                                        0584 01597000
         TM    ICTMASM-9(@05),B'01000000'                          0584 01598000
         BNO   @RF00584                                            0584 01599000
*       DO;                         /*                               */ 01600000
*         IF ICTMIDEL(1)=ON         /* IS SOURCE BEING DELETED?      */ 01601000
*             &ICTMSRCR(1)=ON THEN  /* ...                           */ 01602000
         TM    ICTMIDEL(@02),B'01000000'                           0586 01603000
         BNO   @RF00586                                            0586 01604000
         TM    ICTMSRCR(@02),B'00000010'                           0586 01605000
         BNO   @RF00586                                            0586 01606000
*           DO;                     /* YES,                          */ 01607000
*             ICTMIDEL(BLDAX2)=ON;  /* THE DELETE MODULE             */ 01608000
         AL    @02,@TF00001                                        0588 01609000
         AL    @02,@CF02702                                        0588 01610000
         OI    ICTMIDEL-11(@02),B'01000000'                        0588 01611000
*           END;                                                   0589 01612000
*         TM4NAME=ICTMNAME(BLDAX2); /* DELETE CORRESPONDING ...      */ 01613000
@RF00586 LR    @05,BLDAX2                                          0590 01614000
         MH    @05,@CH02665                                        0590 01615000
         L     @02,@PC00008                                        0590 01616000
         ALR   @02,@05                                             0590 01617000
         AL    @02,@CF02699                                        0590 01618000
         MVC   TM4NAME(8),ICTMNAME(@02)                            0590 01619000
*         GTPFUNCT=GTPDEL;          /* ... ASSEM GTA RECORD SO THAT     01620000
*                                      IT ...                        */ 01621000
         LA    @05,ASMGTP                                          0591 01622000
         MVI   GTPFUNCT(@05),X'05'                                 0591 01623000
*         CALL HMASMGTA(HMASMGTP);  /* ... IS NOT PROCESSED          */ 01624000
         ST    @05,@AL00001                                        0592 01625000
         L     @15,@CV02020                                        0592 01626000
         LA    @01,@AL00001                                        0592 01627000
         BALR  @14,@15                                             0592 01628000
*         RESPECIFY                                                0593 01629000
*           RTNCODE RSTD;                                          0593 01630000
*         BLDARC=MAX(BLDARC,RTNCODE);/* SAVE RETURN CODE FROM GTA    */ 01631000
         CR    BLDARC,RTNCODE                                      0594 01632000
         BNL   *+6                                                      01633000
         LR    BLDARC,RTNCODE                                      0594 01634000
*         RESPECIFY                                                0595 01635000
*           RTNCODE UNRSTD;                                        0595 01636000
*       END;                                                       0596 01637000
*     ELSE                                                         0597 01638000
*       ;                           /* NOT AN ASSEM ENTRY            */ 01639000
@RF00584 DS    0H                                                  0598 01640000
*   END;                            /*                               */ 01641000
         AH    BLDAX2,@CH00064                                     0598 01642000
@DE00583 LR    @05,BLDAX2                                          0598 01643000
         MH    @05,@CH02665                                        0598 01644000
         L     @02,@PC00008                                        0598 01645000
         AL    @02,@CF02699                                        0598 01646000
         L     @05,ICTMEND(@05,@02)                                0598 01647000
         CL    @05,ICTENDNT                                        0598 01648000
         BE    @DC00583                                            0598 01649000
         CH    BLDARC,@CH00034                                     0598 01650000
         BL    @DL00583                                            0598 01651000
@DC00583 DS    0H                                                  0599 01652000
*   RETURN CODE(BLDARC);            /* RETURN W/ RC                  */ 01653000
         LR    @15,BLDARC                                          0599 01654000
         L     @14,@SA00008                                        0599 01655000
         LM    @00,@12,@SA00008+8                                  0599 01656000
         BR    @14                                                 0599 01657000
*   RFY                                                            0600 01658000
*     HMASMIOP BASED;                                              0600 01659000
*   RFY                                                            0601 01660000
*     ICTMOD BASED;                                                0601 01661000
*   RFY                                                            0602 01662000
*     HMASMGTP BASED;                                              0602 01663000
*   END BLDAMID;                                                   0603 01664000
         EJECT                                                          01665000
*                                                                  0604 01666000
*/********************************************************************/ 01667000
*/*                                                                  */ 01668000
*/* MODCHAIN - BUILD PTF TO MOD CHAIN                                */ 01669000
*/*                                                                  */ 01670000
*/* INPUT  - ICT PTF ENTRY PASSED AS A PARAMETER                     */ 01671000
*/*        - ICT MOD SECTION AS POINTED TO BY THE CCA                */ 01672000
*/*                                                                  */ 01673000
*/* OUTPUT - PTF TO MOD CHAIN BUILT FOR THE SPECIFIED ICT PTF ENTRY  */ 01674000
*/*                                                                  */ 01675000
*/********************************************************************/ 01676000
*                                                                  0604 01677000
*MODCHAIN:                                                         0604 01678000
*   PROC(MODCSMD);                                                 0604 01679000
MODCHAIN STM   @14,@12,@SA00009                                    0604 01680000
         MVC   @PC00009(4),0(@01)                                  0604 01681000
*   DCL                                                            0605 01682000
*     MODCSMD CHAR(*);              /* ICT PTF ENTRY REPRESENTING  0605 01683000
*                                      SYSMOD TO BE PROCESSED        */ 01684000
*   DCL                                                            0606 01685000
*     MODCRC FIXED(31);             /* MAX RETURN CODE PARAMETER     */ 01686000
*   DCL                                                            0607 01687000
*     JM FIXED(15);                 /* INDEX - MOD SECT ENTRIES      */ 01688000
*   DCL                                                            0608 01689000
*     MODADDR PTR(31);              /* ADDR OF ICT MOD SECT ENTRY    */ 01690000
*   MODCRC=ZERO;                    /* INITIALIZE RETURN CODE        */ 01691000
         SLR   MODCRC,MODCRC                                       0609 01692000
*   RESPECIFY                                                      0610 01693000
*     ICTPTF BASED(ADDR(MODCSMD));  /* PTF ENTRY PASSED              */ 01694000
*   RESPECIFY                                                      0611 01695000
*     ICTMOD BASED(CCAICMOD);                                      0611 01696000
*                                                                  0611 01697000
*   /*****************************************************************/ 01698000
*   /*                                                               */ 01699000
*   /* GO THRU ICT MOD SECTION                                       */ 01700000
*   /*                                                               */ 01701000
*   /*****************************************************************/ 01702000
*                                                                  0612 01703000
*   DO JM=1 BY 1 WHILE ICTMEND(JM)^=ICTENDNT/* NOT AT MOD SECT END   */ 01704000
*         &MODCRC<STOPFUNC;         /* NOT TERMINATING               */ 01705000
         LA    JM,1                                                0612 01706000
         B     @DE00612                                            0612 01707000
@DL00612 DS    0H                                                  0613 01708000
*     IF ICTPPTR(JM)=ADDR(ICTPTF(1))/* ELEMENT FROM "CURRENT" SYSMOD */ 01709000
*       THEN                                                       0613 01710000
         LR    @05,JM                                              0613 01711000
         MH    @05,@CH02665                                        0613 01712000
         L     @02,CCAICMOD(,CCAPTR)                               0613 01713000
         L     @15,@PC00009                                        0613 01714000
         LA    @01,0(@05,@02)                                      0613 01715000
         AL    @01,@CF02701                                        0613 01716000
         C     @15,ICTPPTR-96(,@01)                                0613 01717000
         BNE   @RF00613                                            0613 01718000
*       DO;                                                        0614 01719000
*                                                                  0614 01720000
*         /***********************************************************/ 01721000
*         /*                                                         */ 01722000
*         /* PUT ADDRESS OF MOD SECT ENTRY INTO PTF SECTION ENTRY    */ 01723000
*         /* LIST (ICTIXP)                                           */ 01724000
*         /*                                                         */ 01725000
*         /***********************************************************/ 01726000
*                                                                  0615 01727000
*         MODADDR=ADDR(ICTMOD(JM)); /* ICT MOD SECT ENTRY ADDRESS    */ 01728000
         AL    @02,@CF02699                                        0615 01729000
         LA    @05,ICTMOD(@05,@02)                                 0615 01730000
         ST    @05,MODADDR                                         0615 01731000
*         CALL HMASMTAI(TBLXPARM,   /*                               */ 01732000
*             ICTPCHN(1),           /* MOD SECT POINTER LIST         */ 01733000
*             ADDR(MODADDR),        /* ADDR OF MOD SECT ENTRY ADDR   */ 01734000
*             LENGTH(ICTIXP));      /* LENGTH OF ENTRY IN LIST       */ 01735000
         L     @05,@PC00001                                        0616 01736000
         ST    @05,@AL00001                                        0616 01737000
         LA    @05,ICTPCHN(,@15)                                   0616 01738000
         ST    @05,@AL00001+4                                      0616 01739000
         LA    @05,MODADDR                                         0616 01740000
         ST    @05,@TF00001                                        0616 01741000
         LA    @05,@TF00001                                        0616 01742000
         ST    @05,@AL00001+8                                      0616 01743000
         LA    @05,@CF00039                                        0616 01744000
         ST    @05,@AL00001+12                                     0616 01745000
         L     @15,@CV02022                                        0616 01746000
         LA    @01,@AL00001                                        0616 01747000
         BALR  @14,@15                                             0616 01748000
*         RESPECIFY                                                0617 01749000
*           RTNCODE RSTD;                                          0617 01750000
*         MODCRC=MAX(MODCRC,RTNCODE);/* SAVE RETURN CODE FROM TAI    */ 01751000
         CR    MODCRC,RTNCODE                                      0618 01752000
         BNL   *+6                                                      01753000
         LR    MODCRC,RTNCODE                                      0618 01754000
*         RESPECIFY                                                0619 01755000
*           RTNCODE UNRSTD;                                        0619 01756000
*       END;                                                       0620 01757000
*   END;                                                           0621 01758000
@RF00613 AH    JM,@CH00064                                         0621 01759000
@DE00612 LR    @05,JM                                              0621 01760000
         MH    @05,@CH02665                                        0621 01761000
         L     @02,CCAICMOD(,CCAPTR)                               0621 01762000
         AL    @02,@CF02699                                        0621 01763000
         L     @05,ICTMEND(@05,@02)                                0621 01764000
         CL    @05,ICTENDNT                                        0621 01765000
         BE    @DC00612                                            0621 01766000
         CH    MODCRC,@CH00033                                     0621 01767000
         BL    @DL00612                                            0621 01768000
@DC00612 DS    0H                                                  0622 01769000
*   RETURN CODE(MODCRC);            /* RETURN W/ RC                  */ 01770000
         LR    @15,MODCRC                                          0622 01771000
         L     @14,@SA00009                                        0622 01772000
         LM    @00,@12,@SA00009+8                                  0622 01773000
         BR    @14                                                 0622 01774000
*   RESPECIFY                                                      0623 01775000
*     ICTPTF BASED;                                                0623 01776000
*   RESPECIFY                                                      0624 01777000
*     ICTMOD BASED;                                                0624 01778000
*   END MODCHAIN;                                                  0625 01779000
*   END GETMOD;                                                    0626 01780000
         EJECT                                                          01781000
*                                                                  0627 01782000
*/********************************************************************/ 01783000
*/*                                                                  */ 01784000
*/* XRFSETUP - CREATE SELECT GTA FILE TO BE USED AS INPUT TO HMASMXRF*/ 01785000
*/*                                                                  */ 01786000
*/* INPUT  - MOD SECTION OF THE ICT                                  */ 01787000
*/*                                                                  */ 01788000
*/* OUTPUT - SELECT GTA FILE TO BE USED AS INPUT TO HMASMXRF         */ 01789000
*/*        - RETURN CODES                                            */ 01790000
*/*          0 - OK                                                  */ 01791000
*/*          12- GTA RETURN FOR NO STORAGE                           */ 01792000
*/*          16- GTA RETURN CODE                                     */ 01793000
*/*                                                                  */ 01794000
*/****************************************************************   */ 01795000
*                                                                  0627 01796000
*XRFSETUP:                                                         0627 01797000
*   PROC;                                                          0627 01798000
XRFSETUP STM   @14,@12,@SA00010                                    0627 01799000
*   DCL                                                            0628 01800000
*     XRFSRC FIXED(15);             /* LOCAL RETURN CODE             */ 01801000
*   DCL                                                            0629 01802000
*     XRFSMODX FIXED(31);           /* ICT PTF ENTRY INDEX           */ 01803000
*   RFY                                                            0630 01804000
*     ICTMOD BASED(CCAICMOD);                                      0630 01805000
*   RFY                                                            0631 01806000
*     ICTPTF BASED(ICTPPTR(XRFSMODX));                             0631 01807000
*   RFY                                                            0632 01808000
*     HMASMGTP BASED(ADDR(MSELGTP));                               0632 01809000
*   RFY                                                            0633 01810000
*     HMASMSET BASED(ADDR(MSELBUF));                               0633 01811000
         EJECT                                                          01812000
*   XRFSRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 01813000
         SLR   XRFSRC,XRFSRC                                       0634 01814000
*   GTPBUFAD=ADDR(MSELBUF);         /* ELEMENT SELECT LIST BUFFER    */ 01815000
         LA    @02,MSELGTP                                         0635 01816000
         LA    @15,MSELBUF                                         0635 01817000
         ST    @15,GTPBUFAD(,@02)                                  0635 01818000
*   GTPFUNCT=GTPADD;                /* INITIALIZE SELECT GTP         */ 01819000
         MVI   GTPFUNCT(@02),X'04'                                 0636 01820000
*   GTPRCDLN=LENGTH(HMASMSET);      /* ...                           */ 01821000
         MVC   GTPRCDLN(2,@02),@CH00033                            0637 01822000
*   GTPKEYLN=LENGTH(SELSTENT);      /* ...                           */ 01823000
         MVC   GTPKEYLN(2,@02),@CH00036                            0638 01824000
*   GTPBUFAD=ADDR(HMASMSET);        /* ...                           */ 01825000
         ST    @15,GTPBUFAD(,@02)                                  0639 01826000
*   DO XRFSMODX=1 BY 1              /* ADD ALL MOD ENTRIES TO THE GTA   01827000
*                                      FILE                          */ 01828000
*         WHILE(ICTMEND(XRFSMODX)^=ICTENDNT/*                        */ 01829000
*         &XRFSRC<STOPFUNC);                                       0640 01830000
         LA    XRFSMODX,1                                          0640 01831000
         B     @DE00640                                            0640 01832000
@DL00640 DS    0H                                                  0641 01833000
*     IF ICTMNOGO(XRFSMODX)=OFF     /* NOT NOGO?                     */ 01834000
*         &ICTPNOGO(1)=OFF THEN     /* NOT NOGO?                     */ 01835000
         LR    @15,XRFSMODX                                        0641 01836000
         MH    @15,@CH02665                                        0641 01837000
         L     @14,CCAICMOD(,CCAPTR)                               0641 01838000
         ST    @15,@TF00001                                        0641 01839000
         ALR   @15,@14                                             0641 01840000
         AL    @15,@CF02704                                        0641 01841000
         TM    ICTMNOGO-8(@15),B'01000000'                         0641 01842000
         BNZ   @RF00641                                            0641 01843000
         L     @15,@TF00001                                        0641 01844000
         AL    @15,@CF02701                                        0641 01845000
         L     @01,ICTPPTR-96(@15,@14)                             0641 01846000
         TM    ICTPNOGO(@01),B'01000000'                           0641 01847000
         BNZ   @RF00641                                            0641 01848000
*       DO;                         /* YES,                          */ 01849000
*         HMASMSET=''B;             /* CLEAR SELECT LIST RECORD      */ 01850000
         LA    @15,MSELBUF                                         0643 01851000
         XC    HMASMSET(12,@15),HMASMSET(@15)                      0643 01852000
*         SESELECT=ON;              /* SET SELECT FLAG               */ 01853000
         OI    SESELECT(@15),B'01000000'                           0644 01854000
*         SENAME=ICTMNAME(XRFSMODX);/* SET ELEMENT NAME              */ 01855000
         LR    @01,@14                                             0645 01856000
         AL    @01,@TF00001                                        0645 01857000
         AL    @01,@CF02699                                        0645 01858000
         MVC   SENAME(8,@15),ICTMNAME(@01)                         0645 01859000
*         CALL CNVTYP2(ICTMOD(XRFSMODX),/* CONVERT ICT MOD TYPE ...  */ 01860000
*             SELSTFLG);            /* ... SELECT LIST TYPE          */ 01861000
         L     @01,@TF00001                                        0646 01862000
         AL    @14,@CF02699                                        0646 01863000
         LA    @14,ICTMOD(@01,@14)                                 0646 01864000
         ST    @14,@AL00001                                        0646 01865000
         ST    @15,@AL00001+4                                      0646 01866000
         LA    @01,@AL00001                                        0646 01867000
         BAL   @14,CNVTYP2                                         0646 01868000
*         CALL HMASMGTA(HMASMGTP);  /* ADD ELEMENT TO SELECT LIST    */ 01869000
         LA    @15,MSELGTP                                         0647 01870000
         ST    @15,@AL00001                                        0647 01871000
         L     @15,@CV02020                                        0647 01872000
         LA    @01,@AL00001                                        0647 01873000
         BALR  @14,@15                                             0647 01874000
*         XRFSRC=MAX(XRFSRC,GTPRETRN);/* SET RC                      */ 01875000
         LA    @15,MSELGTP                                         0648 01876000
         SLR   @14,@14                                             0648 01877000
         IC    @14,GTPRETRN(,@15)                                  0648 01878000
         CR    XRFSRC,@14                                          0648 01879000
         BNL   *+6                                                      01880000
         LR    XRFSRC,@14                                          0648 01881000
*       END;                                                       0649 01882000
*     ELSE                                                         0650 01883000
*       ;                           /* MOD ENTRY IS NOGO             */ 01884000
@RF00641 DS    0H                                                  0651 01885000
*   END;                            /* END OF PROCESSING ALL MOD   0651 01886000
*                                      ENTRIES                       */ 01887000
         AH    XRFSMODX,@CH00064                                   0651 01888000
@DE00640 LR    @15,XRFSMODX                                        0651 01889000
         MH    @15,@CH02665                                        0651 01890000
         L     @01,CCAICMOD(,CCAPTR)                               0651 01891000
         AL    @01,@CF02699                                        0651 01892000
         L     @15,ICTMEND(@15,@01)                                0651 01893000
         CL    @15,ICTENDNT                                        0651 01894000
         BE    @DC00640                                            0651 01895000
         CH    XRFSRC,@CH00033                                     0651 01896000
         BL    @DL00640                                            0651 01897000
@DC00640 DS    0H                                                  0652 01898000
*   RETURN CODE(XRFSRC);            /* RETURN W/RC SET               */ 01899000
         LR    @15,XRFSRC                                          0652 01900000
         L     @14,@SA00010                                        0652 01901000
         LM    @00,@12,@SA00010+8                                  0652 01902000
         BR    @14                                                 0652 01903000
*   RFY                                                            0653 01904000
*     ICTMOD BASED;                                                0653 01905000
*   RFY                                                            0654 01906000
*     ICTPTF BASED;                                                0654 01907000
*   RFY                                                            0655 01908000
*     HMASMGTP BASED;                                              0655 01909000
*   RFY                                                            0656 01910000
*     HMASMSET BASED;                                              0656 01911000
*   END XRFSETUP;                                                  0657 01912000
         EJECT                                                          01913000
*                                                                  0658 01914000
*/****************************************************************   */ 01915000
*/*                                                                  */ 01916000
*/* CHKXRF -                                                         */ 01917000
*/*                                                                  */ 01918000
*/* INPUT  - XRF OUTPUT GTA FILE                                     */ 01919000
*/*        - ICT MOD SECTION                                         */ 01920000
*/*                                                                  */ 01921000
*/* OUTPUT - MESSAGE IF AN ERROR IS DETECTED.                        */ 01922000
*/*                                                                  */ 01923000
*/*                                                                  */ 01924000
*/*                                                                  */ 01925000
*/****************************************************************   */ 01926000
*                                                                  0658 01927000
*CHKXRF:                                                           0658 01928000
*   PROC;                                                          0658 01929000
CHKXRF   STM   @14,@12,@SA00011                                    0658 01930000
*   DCL                                                            0659 01931000
*     CHKXRC FIXED(15);             /* LOCAL RETURN CODE             */ 01932000
*   DCL                                                            0660 01933000
*     CHKXMODX FIXED(31);           /* MOD SECTION INDEX COUNTER     */ 01934000
*   DCL                                                            0661 01935000
*     TYPEIOP CHAR(1);              /* ENTRY TYPE IN IOPTYPE FORMAT  */ 01936000
*   DCL                                                            0662 01937000
*     TYPEXRF CHAR(1);              /* ENTRY TYPE IN XRF FORMAT      */ 01938000
*   DCL                                                            0663 01939000
*     1 CHKXFLGS,                   /* LOCAL CONTROL FLAGS           */ 01940000
*      2 ENDMOD BIT(1),             /* END OF MOD RECORDS IN THE GTA    01941000
*                                      FILE                          */ 01942000
*      2 * BIT(7);                  /* UNUSED                        */ 01943000
*   RFY                                                            0664 01944000
*     ICTMOD BASED(CCAICMOD);                                      0664 01945000
*   RFY                                                            0665 01946000
*     HMASMGTP BASED(ADDR(MXOUTGTP));                              0665 01947000
*   CHKXRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 01948000
         SLR   CHKXRC,CHKXRC                                       0666 01949000
*   CHKXFLGS=''B;                   /* CLEAR LOCAL FLAGS             */ 01950000
         MVI   CHKXFLGS,X'00'                                      0667 01951000
*   GTPBUFAD=ADDR(XRFRCD);          /* INITIALIZE XRF GTP            */ 01952000
         LA    @05,MXOUTGTP                                        0668 01953000
         LA    @15,XRFRCD                                          0668 01954000
         ST    @15,GTPBUFAD(,@05)                                  0668 01955000
*   GTPKEYLN=LENGTH(XRFETYPE)       /* ...                           */ 01956000
*       +LENGTH(XRFENAME)+LENGTH(XRFRTYPE);/*                        */ 01957000
*                                                                  0669 01958000
         MVC   GTPKEYLN(2,@05),@CH00036                            0669 01959000
*   /*****************************************************************/ 01960000
*   /*                                                               */ 01961000
*   /* PROCESS EACH ICT MOD ENTRY BY PROCESSING ALL XRF RECORDS FOR  */ 01962000
*   /* THE ENTRY IN THE GTA FILE                                     */ 01963000
*   /*                                                               */ 01964000
*   /*****************************************************************/ 01965000
*                                                                  0670 01966000
*   DO CHKXMODX=1 BY 1              /* PROCESS ALL MOD ENTRIES       */ 01967000
*         WHILE(ICTMEND(CHKXMODX)^=ICTENDNT/*                        */ 01968000
*         &CHKXRC<STOPFUNC);                                       0670 01969000
*                                                                  0670 01970000
         LA    CHKXMODX,1                                          0670 01971000
         B     @DE00670                                            0670 01972000
@DL00670 DS    0H                                                  0671 01973000
*     /***************************************************************/ 01974000
*     /*                                                             */ 01975000
*     /* INITIALIZE AND POSITION TO 1ST XRF RECORD FOR CURRENT MOD   */ 01976000
*     /*                                                             */ 01977000
*     /***************************************************************/ 01978000
*                                                                  0671 01979000
*     CALL CNVTYP1(ICTMOD(CHKXMODX),/* CONVERT ICT TYPE TO IOPTYPE   */ 01980000
*         TYPEIOP,TYPEXRF);                                        0671 01981000
         MVC   @AL00001+4(8),@AL00671                              0671 01982000
         LR    @05,CHKXMODX                                        0671 01983000
         MH    @05,@CH02665                                        0671 01984000
         L     @02,CCAICMOD(,CCAPTR)                               0671 01985000
         AL    @02,@CF02699                                        0671 01986000
         LA    @05,ICTMOD(@05,@02)                                 0671 01987000
         ST    @05,@AL00001                                        0671 01988000
         LA    @01,@AL00001                                        0671 01989000
         BAL   @14,CNVTYP1                                         0671 01990000
*     XRFRCD=''B;                   /* CLEAR RECORD                  */ 01991000
         XC    XRFRCD(30),XRFRCD                                   0672 01992000
*     XRFETYPE=TYPEIOP;             /* SET TYPE ...                  */ 01993000
         MVC   XRFETYPE(1),TYPEIOP                                 0673 01994000
*     XRFENAME=ICTMNAME(CHKXMODX);  /* ... AND NAME                  */ 01995000
         LR    @05,CHKXMODX                                        0674 01996000
         MH    @05,@CH02665                                        0674 01997000
         L     @02,CCAICMOD(,CCAPTR)                               0674 01998000
         ALR   @02,@05                                             0674 01999000
         AL    @02,@CF02699                                        0674 02000000
         MVC   XRFENAME(8),ICTMNAME(@02)                           0674 02001000
*     XRFRTYPE=TYPEXRF;             /* XRF PTF BY TYPE               */ 02002000
         MVC   XRFRTYPE(1),TYPEXRF                                 0675 02003000
*     GTPFUNCT=GTPLOC;              /* LOCATE ...                    */ 02004000
         LA    @05,MXOUTGTP                                        0676 02005000
         MVI   GTPFUNCT(@05),X'03'                                 0676 02006000
*     CALL HMASMGTA(HMASMGTP);      /* ... FIRST RECORD FOR MOD      */ 02007000
         ST    @05,@AL00001                                        0677 02008000
         L     @15,@CV02020                                        0677 02009000
         LA    @01,@AL00001                                        0677 02010000
         BALR  @14,@15                                             0677 02011000
*     GTPFUNCT=GTPSTRTN;            /* POSITION ...                  */ 02012000
         LA    @05,MXOUTGTP                                        0678 02013000
         MVI   GTPFUNCT(@05),X'06'                                 0678 02014000
*     CALL HMASMGTA(HMASMGTP);      /* ... FOR GET NEXT              */ 02015000
         ST    @05,@AL00001                                        0679 02016000
         L     @15,@CV02020                                        0679 02017000
         LA    @01,@AL00001                                        0679 02018000
         BALR  @14,@15                                             0679 02019000
*     GTPFUNCT=GTPGETN;             /* SET FUNCTION FOR GET NEXT     */ 02020000
         LA    @05,MXOUTGTP                                        0680 02021000
         MVI   GTPFUNCT(@05),X'08'                                 0680 02022000
*     ENDMOD=OFF;                   /* CLEAR END OF MOD FLAG         */ 02023000
*                                                                  0681 02024000
         NI    ENDMOD,B'01111111'                                  0681 02025000
*     /***************************************************************/ 02026000
*     /*                                                             */ 02027000
*     /* PROCESS ALL XRF RECORDS FOR THE CURRENT MOD                 */ 02028000
*     /*                                                             */ 02029000
*     /***************************************************************/ 02030000
*                                                                  0682 02031000
*     DO WHILE(ENDMOD=OFF);         /* PROCESS ALL RECORDS FOR A MOD    02032000
*                                      ENTRY                         */ 02033000
         B     @DE00682                                            0682 02034000
@DL00682 DS    0H                                                  0683 02035000
*       CALL HMASMGTA(HMASMGTP);    /* GET THE NEXT RECORD           */ 02036000
         LA    @05,MXOUTGTP                                        0683 02037000
         ST    @05,@AL00001                                        0683 02038000
         L     @15,@CV02020                                        0683 02039000
         LA    @01,@AL00001                                        0683 02040000
         BALR  @14,@15                                             0683 02041000
*       IF GTPRETRN=GTPEOF THEN     /* END OF FILE ON GTA?           */ 02042000
         LA    @05,MXOUTGTP                                        0684 02043000
         CLI   GTPRETRN(@05),4                                     0684 02044000
         BNE   @RF00684                                            0684 02045000
*         DO;                       /* YES,                          */ 02046000
*           ENDMOD=ON;              /* END OF CURRENT MOD RECORDS IN    02047000
*                                      GTA                           */ 02048000
         OI    ENDMOD,B'10000000'                                  0686 02049000
*         END;                                                     0687 02050000
*       ELSE                        /* NOT EOF                       */ 02051000
*         DO;                                                      0688 02052000
         B     @RC00684                                            0688 02053000
@RF00684 DS    0H                                                  0689 02054000
*           IF XRFETYPE^=TYPEIOP    /* RECORD NOT FOR CURRENT MOD  0689 02055000
*                                      ENTRY?                        */ 02056000
*               |XRFENAME^=ICTMNAME(CHKXMODX)/* ...                  */ 02057000
*               |XRFRTYPE^=TYPEXRF THEN/* ...                        */ 02058000
         CLC   XRFETYPE(1),TYPEIOP                                 0689 02059000
         BNE   @RT00689                                            0689 02060000
         LR    @05,CHKXMODX                                        0689 02061000
         MH    @05,@CH02665                                        0689 02062000
         L     @02,CCAICMOD(,CCAPTR)                               0689 02063000
         ALR   @02,@05                                             0689 02064000
         AL    @02,@CF02699                                        0689 02065000
         CLC   XRFENAME(8),ICTMNAME(@02)                           0689 02066000
         BNE   @RT00689                                            0689 02067000
         CLC   XRFRTYPE(1),TYPEXRF                                 0689 02068000
         BE    @RF00689                                            0689 02069000
@RT00689 DS    0H                                                  0690 02070000
*             DO;                   /* YES,                          */ 02071000
*               ENDMOD=ON;          /* END OF CURRENT MOD RECORDS IN    02072000
*                                      GTA                           */ 02073000
         OI    ENDMOD,B'10000000'                                  0691 02074000
*             END;                                                 0692 02075000
*           ELSE                    /* NOT END OF RECORDS FOR      0693 02076000
*                                      CURRRENT MOD                  */ 02077000
*             DO;                                                  0693 02078000
*                                                                  0693 02079000
         B     @RC00689                                            0693 02080000
@RF00689 DS    0H                                                  0694 02081000
*               /*****************************************************/ 02082000
*               /*                                                   */ 02083000
*               /* CHECK TO INSURE THAT THE REFERENCED SYSMOD IS IN  */ 02084000
*               /* ICT AND OK OR ON THE ACDS                         */ 02085000
*               /*                                                   */ 02086000
*               /*****************************************************/ 02087000
*                                                                  0694 02088000
*               CALL CHK1XRCD(TBLXIOPF->HMASMIOP);/*                 */ 02089000
         L     @05,@PC00001                                        0694 02090000
         L     @05,TBLXIOPF(,@05)                                  0694 02091000
         ST    @05,@AL00001                                        0694 02092000
         LA    @01,@AL00001                                        0694 02093000
         BAL   @14,CHK1XRCD                                        0694 02094000
*               RFY                                                0695 02095000
*                 RTNCODE RSTD;                                    0695 02096000
*               CHKXRC=MAX(CHKXRC,RTNCODE);                        0696 02097000
         CR    CHKXRC,RTNCODE                                      0696 02098000
         BNL   *+6                                                      02099000
         LR    CHKXRC,RTNCODE                                      0696 02100000
*               RFY                                                0697 02101000
*                 RTNCODE UNRSTD;                                  0697 02102000
*             END;                                                 0698 02103000
*         END;                                                     0699 02104000
@RC00689 DS    0H                                                  0700 02105000
*     END;                          /* END OF PROCESSING GTA RECORDS    02106000
*                                      FOR A MOD ENTRY               */ 02107000
@RC00684 DS    0H                                                  0700 02108000
@DE00682 TM    ENDMOD,B'10000000'                                  0700 02109000
         BZ    @DL00682                                            0700 02110000
*   END;                            /* END PROCESS ALL MOD ENTRIES 0701 02111000
*                                      LOOP                          */ 02112000
         AH    CHKXMODX,@CH00064                                   0701 02113000
@DE00670 LR    @05,CHKXMODX                                        0701 02114000
         MH    @05,@CH02665                                        0701 02115000
         L     @02,CCAICMOD(,CCAPTR)                               0701 02116000
         AL    @02,@CF02699                                        0701 02117000
         L     @05,ICTMEND(@05,@02)                                0701 02118000
         CL    @05,ICTENDNT                                        0701 02119000
         BE    @DC00670                                            0701 02120000
         CH    CHKXRC,@CH00033                                     0701 02121000
         BL    @DL00670                                            0701 02122000
@DC00670 DS    0H                                                  0702 02123000
*   RETURN CODE(CHKXRC);            /* RETURN W/RC SET               */ 02124000
         LR    @15,CHKXRC                                          0702 02125000
         L     @14,@SA00011                                        0702 02126000
         LM    @00,@12,@SA00011+8                                  0702 02127000
         BR    @14                                                 0702 02128000
*   RFY                                                            0703 02129000
*     ICTMOD BASED;                                                0703 02130000
*   RFY                                                            0704 02131000
*     HMASMGTP BASED;                                              0704 02132000
         EJECT                                                          02133000
*                                                                  0705 02134000
*/********************************************************************/ 02135000
*/*                                                                  */ 02136000
*/* CHK1XRCD - CHECK SYSMOD THAT REFERENCES AN ELEMENT IN THE ICT    */ 02137000
*/*       IF THE SYSMOD IS IN THE ICT OR IN THE ELEMENT MODID LIST   */ 02138000
*/*       WE ASSUME ALL IS WELL.  ANY ERROR WILL BE DIAGNOSED BY     */ 02139000
*/*       SUBSEQUENT PROCESSING.                                     */ 02140000
*/*                                                                  */ 02141000
*/* INPUT   - FIXED LENGTH IOP                                       */ 02142000
*/*         - XRF RECORD FOR AN ELEMENT, SYSMOD RELATIONSHIP         */ 02143000
*/*                                                                  */ 02144000
*/* OUTPUT                                                           */ 02145000
*/*                                                                  */ 02146000
*/*                                                                  */ 02147000
*/********************************************************************/ 02148000
*                                                                  0705 02149000
*CHK1XRCD:                                                         0705 02150000
*   PROC(CK1IOP);                   /* FIXED LENGTH IOP TO BE USED   */ 02151000
CHK1XRCD STM   @14,@12,@SA00012                                    0705 02152000
         MVC   @PC00012(4),0(@01)                                  0705 02153000
*   DCL                                                            0706 02154000
*     CK1IOP CHAR(*);               /* FIXED IOP                     */ 02155000
*   DCL                                                            0707 02156000
*     CK1XRC FIXED(15);             /* LOCAL RETURN CODE             */ 02157000
*   DCL                                                            0708 02158000
*     1 CK1XFLGS,                   /* LOCAL CONTROL FLAGS           */ 02159000
*      2 CK1XOK BIT(1),             /* SET WHEN IT IS DETERMINED THAT   02160000
*                                      THE REFERENCING SYSMOD IS IN A   02161000
*                                      STATE THAT WILL NOT CAUSE   0708 02162000
*                                      TERMINATION OF THE ELEMENT    */ 02163000
*      2 CK1XERR BIT(1),            /* SYSMOD IS IN ERROR ON THE CDS */ 02164000
*      2 CK1XIFND BIT(1),           /* SYSMOD FOUND IN MOD ID LIST   */ 02165000
*      2 CK1XRERR BIT(1),           /* SYSMOD IN ERROR AND RESTORE   */ 02166000
*      2 CK1XAERR BIT(1),           /* SYSMOD IN ERROR AND APPLY     */ 02167000
*      2 * BIT(3);                  /* UNUSED                        */ 02168000
*   DCL                                                            0709 02169000
*     CK1XITYP FIXED(8);            /* MOD ENTRY SEARCH INDEX COUNTER*/ 02170000
*   DCL                                                            0710 02171000
*     CK1XX1 FIXED(31);             /* MOD ENTRY SEARCH INDEX COUNTER*/ 02172000
*   DCL                                                            0711 02173000
*     CK1XX2 FIXED(31);             /* MOD ID LIST SEARCH INDEX    0711 02174000
*                                      COUNTER                       */ 02175000
*   DCL                                                            0712 02176000
*     CK1XIOPT FIXED(8);            /* IOPTYPE RETURNED BY CONVERSION   02177000
*                                      ROUTINE                       */ 02178000
*   DCL                                                            0713 02179000
*     CK1XDUMM FIXED(8);            /* DUMMY PARM FOR COVERSION    0713 02180000
*                                      ROUTINE                       */ 02181000
*   RFY                                                            0714 02182000
*     HMASMIOP BASED(ADDR(CK1IOP));                                0714 02183000
*   RFY                                                            0715 02184000
*     ICTMOD BASED(CCAICMOD);                                      0715 02185000
*   RFY                                                            0716 02186000
*     ICTMIDLS BASED(ICTMICHN(CK1XX1));                            0716 02187000
*   RFY                                                            0717 02188000
*     TSLPARMS BASED(TBLXTSLP);                                    0717 02189000
         EJECT                                                          02190000
*   CK1XRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 02191000
         SLR   CK1XRC,CK1XRC                                       0718 02192000
*   CK1XFLGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 02193000
         MVI   CK1XFLGS,X'00'                                      0719 02194000
*   IOPPTFF1=XRF3STAT;              /* PUT XRF RECORD STATUS DATA IN    02195000
*                                      THE IOP SO THAT THE FLAGS CAN    02196000
*                                      BE REFERENCED AS MAPPED IN THE   02197000
*                                      IOP                           */ 02198000
*                                                                  0720 02199000
         L     @02,@PC00012                                        0720 02200000
         MVC   IOPPTFF1(1,@02),XRF3STAT                            0720 02201000
*   /*****************************************************************/ 02202000
*   /*                                                               */ 02203000
*   /* SET FLAGS BASED ON ERROR STATUS                               */ 02204000
*   /*                                                               */ 02205000
*   /*****************************************************************/ 02206000
*                                                                  0721 02207000
*   IF IOPERROR=ON THEN             /* IS REFERENCING SYSMOD 'IN   0721 02208000
*                                      ERROR' ON CDS?                */ 02209000
         TM    IOPERROR(@02),B'00010000'                           0721 02210000
         BNO   @RF00721                                            0721 02211000
*     DO;                           /* YES,                          */ 02212000
*       IF IOPRES=ON THEN           /* RESTORE ERROR SYSMOD?         */ 02213000
         TM    IOPRES(@02),B'01000000'                             0723 02214000
         BNO   @RF00723                                            0723 02215000
*         DO;                       /* YES,                          */ 02216000
*           CK1XRERR=ON;            /* RESTORE ERROR, SYSMOD MUST BE    02217000
*                                      IN ICT OR THIS IS AN ERROR    */ 02218000
         OI    CK1XRERR,B'00010000'                                0725 02219000
*         END;                                                     0726 02220000
*       ELSE                        /* NOT A RESTORE ERROR, THEN   0727 02221000
*                                      APPLY ERROR                   */ 02222000
*         DO;                                                      0727 02223000
         B     @RC00723                                            0727 02224000
@RF00723 DS    0H                                                  0728 02225000
*           CK1XAERR=ON;            /* INDICATE SYSMOD IS IN ERROR 0728 02226000
*                                      THE SYSMOD CAN BE IGNORED IF     02227000
*                                      IT IS NOT ON THE ACDS EVEN IF    02228000
*                                      IT APPEARS IN THE MODID LIST  */ 02229000
         OI    CK1XAERR,B'00001000'                                0728 02230000
*         END;                                                     0729 02231000
*     END;                                                         0730 02232000
*   ELSE                                                           0731 02233000
*     ;                             /* NOT IN ERROR                  */ 02234000
@RF00721 DS    0H                                                  0732 02235000
*                                                                  0732 02236000
*   /*****************************************************************/ 02237000
*   /*                                                               */ 02238000
*   /* SEARCH FOR SYSMOD IN THE ICT (I.E. BEING RESTORED). IF SO, ALL*/ 02239000
*   /* IS WELL                                                       */ 02240000
*   /*                                                               */ 02241000
*   /*****************************************************************/ 02242000
*                                                                  0732 02243000
*   TSLICTSR=''B;                   /* CLEAR TSB PARM LIST           */ 02244000
@RC00721 L     @02,@PC00001                                        0732 02245000
         L     @02,TBLXTSLP(,@02)                                  0732 02246000
         L     @15,TSLPMLAD(,@02)                                  0732 02247000
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      0732 02248000
*   TSLFUNCT=TSLFISRH;              /* SEARCH THE ICT PTF SECTION ...*/ 02249000
         MVI   TSLFUNCT(@02),X'01'                                 0733 02250000
*   TSLISMD=XRF3PTF;                /* ... FOR SYSMOD THAT REFERENCES   02251000
*                                      THE MOD                       */ 02252000
         MVC   TSLISMD(7,@15),XRF3PTF                              0734 02253000
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */ 02254000
         ST    @02,@AL00001                                        0735 02255000
         L     @15,@CV02024                                        0735 02256000
         LA    @01,@AL00001                                        0735 02257000
         BALR  @14,@15                                             0735 02258000
*   IF TSLRETRN=TSLGOOD THEN        /* IN THE ICT PTF SECTION?       */ 02259000
         L     @02,@PC00001                                        0736 02260000
         L     @02,TBLXTSLP(,@02)                                  0736 02261000
         CLI   TSLRETRN(@02),0                                     0736 02262000
         BNE   @RF00736                                            0736 02263000
*     DO;                           /* YES,                          */ 02264000
*       CK1XOK=ON;                  /* THE SYSMOD IS OK BECAUSE ANY     02265000
*                                      CHECKING/ERROR PROCESSING WILL   02266000
*                                      BE DONE BECAUSE THE SYSMOD  0738 02267000
*                                      ENTRY HAS A MOD ENTRY       0738 02268000
*                                      CORRESPONDING TO THE XRFED ONE*/ 02269000
         OI    CK1XOK,B'10000000'                                  0738 02270000
*     END;                                                         0739 02271000
*   ELSE                            /* REFERENCED SYSMOD IS NOT IN 0740 02272000
*                                      THE ICT                       */ 02273000
*     DO;                                                          0740 02274000
*                                                                  0740 02275000
         B     @RC00736                                            0740 02276000
@RF00736 DS    0H                                                  0741 02277000
*       /*************************************************************/ 02278000
*       /*                                                           */ 02279000
*       /* IF SYSMOD IS IN THE MODID LIST THEN IT CAN SAFELY BE      */ 02280000
*       /* IGNORED SINCE MODID CHECKING WILL CATCH ANY ERRORS        */ 02281000
*       /*                                                           */ 02282000
*       /*************************************************************/ 02283000
*                                                                  0741 02284000
*       CALL CNVTYP3(XRF3PIND,      /* IOPPIND ELEMENT TYPE FROM   0741 02285000
*                                      SYSMOD                        */ 02286000
*           CK1XITYP);              /* ICTMFLG1 ICT MOD TYPE         */ 02287000
*                                                                  0741 02288000
         LA    @01,@AL00741                                        0741 02289000
         BAL   @14,CNVTYP3                                         0741 02290000
*       /*************************************************************/ 02291000
*       /*                                                           */ 02292000
*       /* SEARCH ICT MOD SECTION FOR MATCHING ENTRY                 */ 02293000
*       /*                                                           */ 02294000
*       /*************************************************************/ 02295000
*                                                                  0742 02296000
*       DO CK1XX1=1 BY 1            /* SEARCH ALL MOD ENTRIES IN THE    02297000
*                                      ICT                           */ 02298000
*             WHILE(ICTMEND(CK1XX1)^=ICTENDNT/* ...                  */ 02299000
*             &CK1XRC<STOPFUNC      /* ... AND NO SERIOUS ERROR ...  */ 02300000
*             &CK1XIFND=OFF);       /* ... UNTIL A MATCH IS FOUND    */ 02301000
         LA    CK1XX1,1                                            0742 02302000
         B     @DE00742                                            0742 02303000
@DL00742 DS    0H                                                  0743 02304000
*         IF ICTMFLG1(CK1XX1)=CK1XITYP/* MATCH ELEMENT?              */ 02305000
*             &ICTMNAME(CK1XX1)=XRF3MOD/* ...                        */ 02306000
*             &ICTMISEL(CK1XX1)=ON THEN/* AND IS SELECTED ?          */ 02307000
         LR    @15,CK1XX1                                          0743 02308000
         MH    @15,@CH02665                                        0743 02309000
         L     @14,CCAICMOD(,CCAPTR)                               0743 02310000
         LA    @01,0(@15,@14)                                      0743 02311000
         AL    @01,@CF02700                                        0743 02312000
         SLR   @00,@00                                             0743 02313000
         IC    @00,ICTMFLG1-9(,@01)                                0743 02314000
         SLR   @01,@01                                             0743 02315000
         IC    @01,CK1XITYP                                        0743 02316000
         CR    @00,@01                                             0743 02317000
         BNE   @RF00743                                            0743 02318000
         ST    @15,@TF00001                                        0743 02319000
         ALR   @15,@14                                             0743 02320000
         AL    @15,@CF02699                                        0743 02321000
         CLC   ICTMNAME(8,@15),XRF3MOD                             0743 02322000
         BNE   @RF00743                                            0743 02323000
         LR    @15,@14                                             0743 02324000
         AL    @15,@TF00001                                        0743 02325000
         AL    @15,@CF02702                                        0743 02326000
         TM    ICTMISEL-11(@15),B'10000000'                        0743 02327000
         BNO   @RF00743                                            0743 02328000
*           DO;                     /* YES,                          */ 02329000
*                                                                  0744 02330000
*             /*******************************************************/ 02331000
*             /*                                                     */ 02332000
*             /* CONVERT ICT ELEMENT TYPE TO IOP TYPE INCASE A       */ 02333000
*             /* MESSAGE IS NEEDED                                   */ 02334000
*             /*                                                     */ 02335000
*             /*******************************************************/ 02336000
*                                                                  0745 02337000
*             CALL CNVTYP1(ICTMOD(CK1XX1),/* ICT TYPE FLAGS          */ 02338000
*                 CK1XIOPT,         /* IOP CDS ENTRY TYPE            */ 02339000
*                 CK1XDUMM);        /* NOT USED                      */ 02340000
         MVC   @AL00001+4(8),@AL00745                              0745 02341000
         L     @15,@TF00001                                        0745 02342000
         AL    @14,@CF02699                                        0745 02343000
         LA    @15,ICTMOD(@15,@14)                                 0745 02344000
         ST    @15,@AL00001                                        0745 02345000
         LA    @01,@AL00001                                        0745 02346000
         BAL   @14,CNVTYP1                                         0745 02347000
*             CK1XIFND=ON;          /* SIGNAL END OF SEARCH          */ 02348000
*                                                                  0746 02349000
         OI    CK1XIFND,B'00100000'                                0746 02350000
*             /*******************************************************/ 02351000
*             /*                                                     */ 02352000
*             /* SEARCH FOR SYSMOD IN MODID LIST                     */ 02353000
*             /*                                                     */ 02354000
*             /*******************************************************/ 02355000
*                                                                  0747 02356000
*             DO CK1XX2=1 BY 1      /* SEARCH THE CDS MODID LIST FOR    02357000
*                                      A MATCH                       */ 02358000
*                   WHILE(ICTMIDND(CK1XX2)^=ICTENDIX/* ...           */ 02359000
*                   &CK1XOK=OFF);   /* ...                           */ 02360000
         LA    CK1XX2,1                                            0747 02361000
         B     @DE00747                                            0747 02362000
@DL00747 DS    0H                                                  0748 02363000
*               IF ICTMODID(CK1XX2)=XRF3PTF THEN/* SYSMOD IN ID LIST?*/ 02364000
         LR    @05,CK1XX2                                          0748 02365000
         SLA   @05,3                                               0748 02366000
         LR    @15,CK1XX1                                          0748 02367000
         MH    @15,@CH02665                                        0748 02368000
         L     @01,CCAICMOD(,CCAPTR)                               0748 02369000
         AL    @01,@CF02707                                        0748 02370000
         L     @01,ICTMICHN-104(@15,@01)                           0748 02371000
         ALR   @01,@05                                             0748 02372000
         AL    @01,@CF02695                                        0748 02373000
         CLC   ICTMODID(7,@01),XRF3PTF                             0748 02374000
         BNE   @RF00748                                            0748 02375000
*                 DO;               /* YES,                          */ 02376000
*                   CK1XOK=ON;      /* THE SYSMOD REFERENCE IS OK AT    02377000
*                                      THIS POINT IN PROCESSING SINCE   02378000
*                                      ANY ERRORS WILL BE FOUND BY 0750 02379000
*                                      MOD ID CHECKING LATTER ON     */ 02380000
         OI    CK1XOK,B'10000000'                                  0750 02381000
*                 END;                                             0751 02382000
*             END;                  /* END MODID LIST SEARCH         */ 02383000
@RF00748 AH    CK1XX2,@CH00064                                     0752 02384000
@DE00747 LR    @05,CK1XX2                                          0752 02385000
         SLA   @05,3                                               0752 02386000
         LR    @15,CK1XX1                                          0752 02387000
         MH    @15,@CH02665                                        0752 02388000
         L     @01,CCAICMOD(,CCAPTR)                               0752 02389000
         AL    @01,@CF02707                                        0752 02390000
         L     @01,ICTMICHN-104(@15,@01)                           0752 02391000
         AL    @01,@CF02695                                        0752 02392000
         L     @05,ICTMIDND(@05,@01)                               0752 02393000
         CL    @05,ICTENDIX                                        0752 02394000
         BE    @DC00747                                            0752 02395000
         TM    CK1XOK,B'10000000'                                  0752 02396000
         BZ    @DL00747                                            0752 02397000
@DC00747 DS    0H                                                  0753 02398000
*             IF CK1XOK=OFF THEN    /* SYSMOD REFERENCE TO ELEMENT 0753 02399000
*                                      NOT YET VALIDATED?            */ 02400000
         TM    CK1XOK,B'10000000'                                  0753 02401000
         BNZ   @RF00753                                            0753 02402000
*               DO;                 /* YES,                          */ 02403000
*                 IOPDSID=IOPCDS;   /* BLDL FOR SYSMOD ON CDS        */ 02404000
         L     @15,@PC00012                                        0755 02405000
         MVI   IOPDSID(@15),X'02'                                  0755 02406000
*                 IOPNAM17=XRF3PTF; /* ...                           */ 02407000
         MVC   IOPNAM17(7,@15),XRF3PTF                             0756 02408000
*                 IOPTYPE=IOPSMD;   /* ...                           */ 02409000
         MVI   IOPTYPE(@15),X'0B'                                  0757 02410000
*                 IOPFUNCT=IOPBLDL; /* ...                           */ 02411000
         MVI   IOPFUNCT(@15),X'04'                                 0758 02412000
*                 CALL HMASMIO(HMASMIOP);/* ...                      */ 02413000
         ST    @15,@AL00001                                        0759 02414000
         L     @15,@CV02017                                        0759 02415000
         LA    @01,@AL00001                                        0759 02416000
         BALR  @14,@15                                             0759 02417000
*                 IF IOPRETRN=IOPGOOD THEN/* SYSMOD FOUND?           */ 02418000
         L     @15,@PC00012                                        0760 02419000
         CLI   IOPRETRN(@15),0                                     0760 02420000
         BNE   @RF00760                                            0760 02421000
*                   DO;             /* YES,                          */ 02422000
*                     IF IOPSBYP=ON THEN/* IS SYSMOD SUP'ED?         */ 02423000
         TM    IOPSBYP(@15),B'10000000'                            0762 02424000
         BNO   @RF00762                                            0762 02425000
*                       DO;         /* YES,                          */ 02426000
*                         CK1XOK=ON;/* MARK AS CHECKING COMPLETED SO    02427000
*                                      THAT CHECKING IS BYPASSED FOR    02428000
*                                      SUP'ED SYSMODS                */ 02429000
         OI    CK1XOK,B'10000000'                                  0764 02430000
*                       END;        /*                               */ 02431000
*                     ELSE                                         0766 02432000
*                       ;           /* NOT SUP'ED, SO CONTINUE CHECKS*/ 02433000
@RF00762 DS    0H                                                  0767 02434000
*                   END;            /*                               */ 02435000
*                 ELSE              /* NOT FOUND OR ERROR            */ 02436000
*                   DO;                                            0768 02437000
         B     @RC00760                                            0768 02438000
@RF00760 DS    0H                                                  0769 02439000
*                     IF IOPRETRN>IOPNTFND THEN/* ERROR?             */ 02440000
         L     @15,@PC00012                                        0769 02441000
         CLI   IOPRETRN(@15),4                                     0769 02442000
         BNH   @RF00769                                            0769 02443000
*                       DO;         /*                               */ 02444000
*                         CK1XRC=MAX(CK1XRC,IOPRETRN);/* SET RC      */ 02445000
         SLR   @14,@14                                             0771 02446000
         IC    @14,IOPRETRN(,@15)                                  0771 02447000
         CR    CK1XRC,@14                                          0771 02448000
         BNL   *+6                                                      02449000
         LR    CK1XRC,@14                                          0771 02450000
*                       END;                                       0772 02451000
*                     ELSE                                         0773 02452000
*                       ;           /* NOT AN ERROR I.E. NOT FOUND   */ 02453000
@RF00769 DS    0H                                                  0774 02454000
*                   END;                                           0774 02455000
*               END;                /*                               */ 02456000
*                                                                  0775 02457000
@RC00760 DS    0H                                                  0776 02458000
*             /*******************************************************/ 02459000
*             /*                                                     */ 02460000
*             /* ACDS MODID LIST IF NOT FOUND, CHECK ACDS - MUST BE  */ 02461000
*             /* NOT PRESSENT IF CK1XERR OR ACCEPTED IF OK           */ 02462000
*             /*                                                     */ 02463000
*             /*******************************************************/ 02464000
*                                                                  0776 02465000
*             IF CK1XOK=OFF THEN    /* SYSMOD REFERENCE TO ELEMENT 0776 02466000
*                                      NOT YET VALIDATED?            */ 02467000
@RF00753 TM    CK1XOK,B'10000000'                                  0776 02468000
         BNZ   @RF00776                                            0776 02469000
*               DO;                 /* YES,                          */ 02470000
*                 IOPDSID=IOPACDS;  /* BLDL FOR SYSMOD ON ACDS       */ 02471000
         L     @15,@PC00012                                        0778 02472000
         MVI   IOPDSID(@15),X'0C'                                  0778 02473000
*                 IOPNAM17=XRF3PTF; /* ...                           */ 02474000
         MVC   IOPNAM17(7,@15),XRF3PTF                             0779 02475000
*                 IOPTYPE=IOPSMD;   /* ...                           */ 02476000
         MVI   IOPTYPE(@15),X'0B'                                  0780 02477000
*                 IOPFUNCT=IOPBLDL; /* ...                           */ 02478000
         MVI   IOPFUNCT(@15),X'04'                                 0781 02479000
*                 CALL HMASMIO(HMASMIOP);/* ...                      */ 02480000
         ST    @15,@AL00001                                        0782 02481000
         L     @15,@CV02017                                        0782 02482000
         LA    @01,@AL00001                                        0782 02483000
         BALR  @14,@15                                             0782 02484000
*                 IF IOPRETRN=IOPGOOD THEN/* SYSMOD FOUND?           */ 02485000
         L     @15,@PC00012                                        0783 02486000
         CLI   IOPRETRN(@15),0                                     0783 02487000
         BNE   @RF00783                                            0783 02488000
*                   DO;             /* YES,                          */ 02489000
*                     IF IOPERROR=OFF/* SYSMOD NOT IN ERROR ...      */ 02490000
*                         &IOPDBYP=OFF/* ... AND NOT DELETED         */ 02491000
*                       THEN                                       0785 02492000
         TM    IOPERROR(@15),B'00010000'                           0785 02493000
         BNZ   @RF00785                                            0785 02494000
         TM    IOPDBYP(@15),B'01000000'                            0785 02495000
         BNZ   @RF00785                                            0785 02496000
*                       DO;         /* YES,                          */ 02497000
*                         CK1XOK=ON;/*                               */ 02498000
         OI    CK1XOK,B'10000000'                                  0787 02499000
*                       END;                                       0788 02500000
*                     ELSE          /* IN ERROR OR DELETED           */ 02501000
*                       DO;                                        0789 02502000
         B     @RC00785                                            0789 02503000
@RF00785 DS    0H                                                  0790 02504000
*                         IF IOPERROR=ON THEN/*                      */ 02505000
         L     @15,@PC00012                                        0790 02506000
         TM    IOPERROR(@15),B'00010000'                           0790 02507000
         BNO   @RF00790                                            0790 02508000
*                           DO;     /* YES,                          */ 02509000
*                                                                  0791 02510000
*                             /***************************************/ 02511000
*                             /*                                     */ 02512000
*                             /* HMA429I XXXXXXXX XXXXXXXX FOR SYSMOD*/ 02513000
*                             /* XXXXXXX IS ALSO IN SYSMOD XXXXXXX   */ 02514000
*                             /* WHICH IS ... IN ERROR AND NOT BEING */ 02515000
*                             /* RESTORED                            */ 02516000
*                             /*                                     */ 02517000
*                             /***************************************/ 02518000
*                                                                  0792 02519000
*                             DO;   /* HMASMPMG M1(HMA429I)M2(PART123   02520000
*                                      )VAR(CCATYPEA(CK1XIOPT),ICTMNA   02521000
*                                      ME(CK1XX1),ICTPPTR(CK1XX1)->IC   02522000
*                                      TPTFS(1),XRF3PTF)TYPE(ERR)TARG   02523000
*                                      ET(SYSOUT,LOG)                */ 02524000
*                               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET 0793 02525000
*                                      PARMS TO ZEROS                */ 02526000
         XC    HMASMMGP(32),HMASMMGP                               0793 02527000
*                               MGPMGNO1=HMA429I;/* SET UP MSG 1 CODE*/ 02528000
         MVC   MGPMGNO1(2),@CH02037                                0794 02529000
*                               MGPMGNO2=PART123;/* SET UP MSG 2 CODE*/ 02530000
         MVC   MGPMGNO2(2),@CH02047                                0795 02531000
*                               MGPTYPE=MGPERR;/* SET MESSAGE TYPE   */ 02532000
         MVI   MGPTYPE,X'03'                                       0796 02533000
*                               MGPPRINT='1'B;/* SET TARGET FLAG     */ 02534000
*                               MGPHLDS='1'B;/* SET TARGET FLAG      */ 02535000
         OI    MGPPRINT,B'10010000'                                0798 02536000
*                               MGPVARPT(1)=ADDR(CCATYPEA(CK1XIOPT));   02537000
         SLR   @15,@15                                             0799 02538000
         IC    @15,CK1XIOPT                                        0799 02539000
         SLA   @15,3                                               0799 02540000
         L     @01,CCATPAD(,CCAPTR)                                0799 02541000
         AL    @01,@CF02695                                        0799 02542000
         LA    @15,CCATYPEA(@15,@01)                               0799 02543000
         ST    @15,MGPVARPT                                        0799 02544000
*                                   /* SET VARIABLE PTR              */ 02545000
*                               MGPVARPT(2)=ADDR(ICTMNAME(CK1XX1));/*   02546000
*                                      SET VARIABLE PTR              */ 02547000
         LR    @15,CK1XX1                                          0800 02548000
         MH    @15,@CH02665                                        0800 02549000
         L     @14,CCAICMOD(,CCAPTR)                               0800 02550000
         LA    @01,0(@15,@14)                                      0800 02551000
         AL    @01,@CF02699                                        0800 02552000
         ST    @01,MGPVARPT+4                                      0800 02553000
*                               MGPVARPT(3)=ADDR(ICTPPTR(CK1XX1)-> 0801 02554000
*                                   ICTPTFS(1));/* SET VARIABLE PTR  */ 02555000
         AL    @14,@CF02701                                        0801 02556000
         L     @01,ICTPPTR-96(@15,@14)                             0801 02557000
         ST    @01,MGPVARPT+8                                      0801 02558000
*                               MGPVARPT(4)=ADDR(XRF3PTF);/* SET   0802 02559000
*                                      VARIABLE PTR                  */ 02560000
         LA    @15,XRF3PTF                                         0802 02561000
         ST    @15,MGPVARPT+12                                     0802 02562000
*                               CALL HMASMMSG(HMASMMGP);/* HAVE    0803 02563000
*                                      MESSAGE ISSUED                */ 02564000
         L     @15,@CV02018                                        0803 02565000
         LA    @01,@AL00803                                        0803 02566000
         BALR  @14,@15                                             0803 02567000
*                             END;                                 0804 02568000
*                             ICTPPTR(CK1XX1)->ICTPNOGO(1)=ON;/* MARK   02569000
*                                      THE SYSMOD NOGO               */ 02570000
         LR    @15,CK1XX1                                          0805 02571000
         MH    @15,@CH02665                                        0805 02572000
         L     @01,CCAICMOD(,CCAPTR)                               0805 02573000
         AL    @01,@CF02701                                        0805 02574000
         L     @01,ICTPPTR-96(@15,@01)                             0805 02575000
         OI    ICTPNOGO(@01),B'01000000'                           0805 02576000
*                           END;                                   0806 02577000
*                         ELSE      /* NOT ERROR                     */ 02578000
*                           DO;                                    0807 02579000
         B     @RC00790                                            0807 02580000
@RF00790 DS    0H                                                  0808 02581000
*                           END;                                   0808 02582000
*                       END;                                       0809 02583000
*                   END;                                           0810 02584000
*                 ELSE              /* NOT FOUND OR ERROR            */ 02585000
*                   DO;                                            0811 02586000
         B     @RC00783                                            0811 02587000
@RF00783 DS    0H                                                  0812 02588000
*                     IF IOPRETRN>IOPNTFND THEN/* OTHER THAN NOT   0812 02589000
*                                      FOUND                         */ 02590000
         L     @15,@PC00012                                        0812 02591000
         CLI   IOPRETRN(@15),4                                     0812 02592000
         BNH   @RF00812                                            0812 02593000
*                       DO;         /* YES,                          */ 02594000
*                         CK1XRC=MAX(CK1XRC,IOPRETRN);/* SAVE RC     */ 02595000
         SLR   @14,@14                                             0814 02596000
         IC    @14,IOPRETRN(,@15)                                  0814 02597000
         CR    CK1XRC,@14                                          0814 02598000
         BNL   *+6                                                      02599000
         LR    CK1XRC,@14                                          0814 02600000
*                       END;                                       0815 02601000
*                     ELSE          /* NOT FOUND                     */ 02602000
*                       DO;                                        0816 02603000
*                                                                  0816 02604000
         B     @RC00812                                            0816 02605000
@RF00812 DS    0H                                                  0817 02606000
*                         /*******************************************/ 02607000
*                         /*                                         */ 02608000
*                         /* HMA429I XXXXXXXX XXXXXXXX FOR SYSMOD    */ 02609000
*                         /* XXXXXXX IS ALSO IN SYSMOD XXXXXXX WHICH */ 02610000
*                         /* IS ... APPLIED BUT NOT ACCEPTED         */ 02611000
*                         /*                                         */ 02612000
*                         /*******************************************/ 02613000
*                                                                  0817 02614000
*                         DO;       /* HMASMPMG M1(HMA429I)M2(PART124   02615000
*                                      )VAR(CCATYPEA(CK1XIOPT),ICTMNA   02616000
*                                      ME(CK1XX1),ICTPPTR(CK1XX1)->IC   02617000
*                                      TPTFS(1),XRF3PTF)TYPE(ERR)TARG   02618000
*                                      ET(SYSOUT,LOG)                */ 02619000
*                           HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS    02620000
*                                      TO ZEROS                      */ 02621000
         XC    HMASMMGP(32),HMASMMGP                               0818 02622000
*                           MGPMGNO1=HMA429I;/* SET UP MSG 1 CODE    */ 02623000
         MVC   MGPMGNO1(2),@CH02037                                0819 02624000
*                           MGPMGNO2=PART124;/* SET UP MSG 2 CODE    */ 02625000
         MVC   MGPMGNO2(2),@CH02049                                0820 02626000
*                           MGPTYPE=MGPERR;/* SET MESSAGE TYPE       */ 02627000
         MVI   MGPTYPE,X'03'                                       0821 02628000
*                           MGPPRINT='1'B;/* SET TARGET FLAG         */ 02629000
*                           MGPHLDS='1'B;/* SET TARGET FLAG          */ 02630000
         OI    MGPPRINT,B'10010000'                                0823 02631000
*                           MGPVARPT(1)=ADDR(CCATYPEA(CK1XIOPT));/*     02632000
*                                      SET VARIABLE PTR              */ 02633000
         SLR   @15,@15                                             0824 02634000
         IC    @15,CK1XIOPT                                        0824 02635000
         SLA   @15,3                                               0824 02636000
         L     @01,CCATPAD(,CCAPTR)                                0824 02637000
         AL    @01,@CF02695                                        0824 02638000
         LA    @15,CCATYPEA(@15,@01)                               0824 02639000
         ST    @15,MGPVARPT                                        0824 02640000
*                           MGPVARPT(2)=ADDR(ICTMNAME(CK1XX1));/* SET   02641000
*                                      VARIABLE PTR                  */ 02642000
         LR    @15,CK1XX1                                          0825 02643000
         MH    @15,@CH02665                                        0825 02644000
         L     @14,CCAICMOD(,CCAPTR)                               0825 02645000
         LA    @01,0(@15,@14)                                      0825 02646000
         AL    @01,@CF02699                                        0825 02647000
         ST    @01,MGPVARPT+4                                      0825 02648000
*                           MGPVARPT(3)=ADDR(ICTPPTR(CK1XX1)->ICTPTFS(1 02649000
*                               )); /* SET VARIABLE PTR              */ 02650000
         AL    @14,@CF02701                                        0826 02651000
         L     @01,ICTPPTR-96(@15,@14)                             0826 02652000
         ST    @01,MGPVARPT+8                                      0826 02653000
*                           MGPVARPT(4)=ADDR(XRF3PTF);/* SET VARIABLE   02654000
*                                      PTR                           */ 02655000
         LA    @15,XRF3PTF                                         0827 02656000
         ST    @15,MGPVARPT+12                                     0827 02657000
*                           CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE     02658000
*                                      ISSUED                        */ 02659000
         L     @15,@CV02018                                        0828 02660000
         LA    @01,@AL00828                                        0828 02661000
         BALR  @14,@15                                             0828 02662000
*                         END;                                     0829 02663000
*                         ICTPPTR(CK1XX1)->ICTPNOGO(1)=ON;/* MARK THE   02664000
*                                      SYSMOD NOGO                   */ 02665000
         LR    @15,CK1XX1                                          0830 02666000
         MH    @15,@CH02665                                        0830 02667000
         L     @01,CCAICMOD(,CCAPTR)                               0830 02668000
         AL    @01,@CF02701                                        0830 02669000
         L     @01,ICTPPTR-96(@15,@01)                             0830 02670000
         OI    ICTPNOGO(@01),B'01000000'                           0830 02671000
*                       END;                                       0831 02672000
*                   END;                                           0832 02673000
*               END;                                               0833 02674000
*                                                                  0833 02675000
*             /*******************************************************/ 02676000
*             /*                                                     */ 02677000
*             /* COULD ALSO CHECK DELTA 2 LIST BUT ...               */ 02678000
*             /*                                                     */ 02679000
*             /*******************************************************/ 02680000
*                                                                  0834 02681000
*           END;                                                   0834 02682000
*         ELSE                                                     0835 02683000
*           ;                       /* NOT A MATCH, SO SKIP TO NEXT  */ 02684000
@RF00743 DS    0H                                                  0836 02685000
*       END;                        /* END OF MOD ENTRY SEARCH       */ 02686000
@RC00743 AH    CK1XX1,@CH00064                                     0836 02687000
@DE00742 LR    @15,CK1XX1                                          0836 02688000
         MH    @15,@CH02665                                        0836 02689000
         L     @01,CCAICMOD(,CCAPTR)                               0836 02690000
         AL    @01,@CF02699                                        0836 02691000
         L     @15,ICTMEND(@15,@01)                                0836 02692000
         CL    @15,ICTENDNT                                        0836 02693000
         BE    @DC00742                                            0836 02694000
         CH    CK1XRC,@CH00033                                     0836 02695000
         BNL   @DC00742                                            0836 02696000
         TM    CK1XIFND,B'00100000'                                0836 02697000
         BZ    @DL00742                                            0836 02698000
@DC00742 DS    0H                                                  0837 02699000
*     END;                          /* END SYSMOD ^ IN ICT PROCESSING*/ 02700000
*   RETURN CODE(CK1XRC);            /* RETURN W/RC SET               */ 02701000
@RC00736 LR    @15,CK1XRC                                          0838 02702000
         L     @14,@SA00012                                        0838 02703000
         LM    @00,@12,@SA00012+8                                  0838 02704000
         BR    @14                                                 0838 02705000
*   END CHK1XRCD;                                                  0839 02706000
*   RFY                                                            0840 02707000
*     HMASMIOP BASED;                                              0840 02708000
*   RFY                                                            0841 02709000
*     ICTMOD BASED;                                                0841 02710000
*   RFY                                                            0842 02711000
*     ICTMIDLS BASED;                                              0842 02712000
*   RFY                                                            0843 02713000
*     TSLPARMS BASED;                                              0843 02714000
*   END CHKXRF;                                                    0844 02715000
         EJECT                                                          02716000
*                                                                  0845 02717000
*/****************************************************************   */ 02718000
*/*                                                                  */ 02719000
*/* SELMOD -                                                         */ 02720000
*/*                                                                  */ 02721000
*/* INPUT  - ICT MOD SECTION                                         */ 02722000
*/*                                                                  */ 02723000
*/* OUTPUT - ICTMSELM SET FOR SELECTED ELEMENTS                      */ 02724000
*/*                                                                  */ 02725000
*/*                                                                  */ 02726000
*/*                                                                  */ 02727000
*/*                                                                  */ 02728000
*/****************************************************************   */ 02729000
*                                                                  0845 02730000
*SELMOD:                                                           0845 02731000
*   PROC;                                                          0845 02732000
*                                                                  0845 02733000
SELMOD   STM   @14,@12,@SA00013                                    0845 02734000
*   /*****************************************************************/ 02735000
*   /*                                                               */ 02736000
*   /* THE SLECTED ELEMENT WILL BE THE ELEMENT FROM THE SYSMOD IN THE*/ 02737000
*   /* CDS MODID LIST THAT HAS THE HIGHEXT ORDER NUMBER (ICTPONUM).  */ 02738000
*   /*                                                               */ 02739000
*   /*****************************************************************/ 02740000
*                                                                  0846 02741000
*   DCL                                                            0846 02742000
*     SELMRC FIXED(15);             /* LOCAL RETURN CODE             */ 02743000
*   DCL                                                            0847 02744000
*     SELMNAME CHAR(LENGTH(ICTMNAME))/* NAME OF CURRENT ELEMENT FOR     02745000
*                                      WHICH SELECTION IS BEING    0847 02746000
*                                      PERFORMED                     */ 02747000
*         BASED(ADDR(ICTMNAME(SELMX1)));                           0847 02748000
*   DCL                                                            0848 02749000
*     SELMTYPE BIT(8)               /* TYPE OF CURRENT ELEMENT FOR 0848 02750000
*                                      WHICH SELECTION IS BEING    0848 02751000
*                                      PERFORMED                     */ 02752000
*         BASED(ADDR(ICTMFLG1(SELMX1)));                           0848 02753000
*   DCL                                                            0849 02754000
*     SELMONUM FIXED(16);           /* ORDER NUMBER FOR SELECTED   0849 02755000
*                                      ELEMENT                       */ 02756000
*   DCL                                                            0850 02757000
*     SELMO#2 FIXED(16);            /* HIGHEST ORDER NUMBER FOR AN 0850 02758000
*                                      ELEMENT                       */ 02759000
*   DCL                                                            0851 02760000
*     SELMPTR1 PTR(31);             /* ADDR OF SELECTED ELEMENT      */ 02761000
*   DCL                                                            0852 02762000
*     SELMPTR2 PTR(31);             /* ADDR OF ELEMENT W/ HIGHEST  0852 02763000
*                                      ORDER NUMBER                  */ 02764000
*   DCL                                                            0853 02765000
*     SELMX1 FIXED(31);             /* CURRENT ELEMENT TO BE SELECTED   02766000
*                                      INDEX                         */ 02767000
*   DCL                                                            0854 02768000
*     SELMX2 FIXED(31);             /* MOD ENTRY SEARCH INDEX FOR  0854 02769000
*                                      SELECTION                     */ 02770000
*   DCL                                                            0855 02771000
*     SELMX3 FIXED(31);             /* MODID LIST SEARCH INDEX       */ 02772000
*   DCL                                                            0856 02773000
*     1 SELMFLGS,                   /* LOCAL CONTROL FLAGS           */ 02774000
*      2 SELMMFND BIT(1),           /* MOD FOUND FOR SOURCE FLAG     */ 02775000
*      2 SELMDEL BIT(1),            /* DELETE ASSEM ENTRY FOUND      */ 02776000
*      2 * BIT(6);                  /* UNUSED                        */ 02777000
*   RFY                                                            0857 02778000
*     ICTMOD BASED(CCAICMOD);                                      0857 02779000
*   RFY                                                            0858 02780000
*     ICTPTF BASED(ICTPPTR(SELMX2));                               0858 02781000
*   RFY                                                            0859 02782000
*     ICTMIDLS BASED(ICTMICHN(SELMX2));                            0859 02783000
*   RFY                                                            0860 02784000
*     TSLPARMS BASED(TBLXTSLP);                                    0860 02785000
*   SELMRC=ZERO;                    /* CLEAR RETURN CODE             */ 02786000
         SLR   SELMRC,SELMRC                                       0861 02787000
*   SELMFLGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 02788000
         MVI   SELMFLGS,X'00'                                      0862 02789000
*   TSLFUNCT=TSLFCLRP;              /* CLEAR THE TEMORARY USER FLAGS    02790000
*                                      IN THE ICT                    */ 02791000
         L     @02,@PC00001                                        0863 02792000
         L     @02,TBLXTSLP(,@02)                                  0863 02793000
         MVI   TSLFUNCT(@02),X'05'                                 0863 02794000
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */ 02795000
         ST    @02,@AL00001                                        0864 02796000
         L     @15,@CV02024                                        0864 02797000
         LA    @01,@AL00001                                        0864 02798000
         BALR  @14,@15                                             0864 02799000
*                                                                  0865 02800000
*   /*****************************************************************/ 02801000
*   /*                                                               */ 02802000
*   /* LOOP THRU ICT MOD SECTION ONCE AND FOR EACH AS YET NOT        */ 02803000
*   /* PROCESSED ELEMENT, DETERMINE WHICH ENTRY IS SELECTED          */ 02804000
*   /*                                                               */ 02805000
*   /*****************************************************************/ 02806000
*                                                                  0865 02807000
*   DO SELMX1=1 BY 1                /* PROCESS ALL ELEMENT ENTRIES IN   02808000
*                                      THE ICT                       */ 02809000
*         WHILE(ICTMEND(SELMX1)^=ICTENDNT/* ...                      */ 02810000
*         &SELMRC<STOPFUNC);                                       0865 02811000
         LA    SELMX1,1                                            0865 02812000
         B     @DE00865                                            0865 02813000
@DL00865 DS    0H                                                  0866 02814000
*     IF ICTMPASS(SELMX1)^=ON THEN  /* SELECTION NOT DONE FOR THIS 0866 02815000
*                                      MOD?                          */ 02816000
         LR    @05,SELMX1                                          0866 02817000
         MH    @05,@CH02665                                        0866 02818000
         L     @02,CCAICMOD(,CCAPTR)                               0866 02819000
         ALR   @02,@05                                             0866 02820000
         AL    @02,@CF02708                                        0866 02821000
         TM    ICTMPASS-12(@02),B'10000000'                        0866 02822000
         BO    @RF00866                                            0866 02823000
*       DO;                         /* YES,                          */ 02824000
*         SELMONUM=ZERO;            /* CLEAR SELECTED ELEMENT ORDER     02825000
*                                      NUMBER                        */ 02826000
         SLR   @02,@02                                             0868 02827000
         STH   @02,SELMONUM                                        0868 02828000
*         SELMO#2=ZERO;             /* CLEAR SELECTED ELEMENT ORDER     02829000
*                                      NUMBER 2                      */ 02830000
         SLR   SELMO#2,SELMO#2                                     0869 02831000
*         SELMPTR1=ZERO;            /* CLEAR SELECTED ENTRY PTR      */ 02832000
         SLR   SELMPTR1,SELMPTR1                                   0870 02833000
*         SELMPTR2=ZERO;            /* CLEAR 2ND SELECTED ENTRY PTR  */ 02834000
         SLR   SELMPTR2,SELMPTR2                                   0871 02835000
*         SELMDEL=OFF;              /* DELETE NOT FOUND              */ 02836000
         NI    SELMDEL,B'10111111'                                 0872 02837000
*         DO SELMX2=1 BY 1          /* SEARCH ALL MOD ENTRIES IN THE    02838000
*                                      ICT                           */ 02839000
*               WHILE(ICTMEND(SELMX2)^=ICTENDNT/*                    */ 02840000
*               &SELMRC<STOPFUNC);                                 0873 02841000
         LA    SELMX2,1                                            0873 02842000
         B     @DE00873                                            0873 02843000
@DL00873 DS    0H                                                  0874 02844000
*           IF SELMNAME=ICTMNAME(SELMX2)/* SAME ELEMENT NAME         */ 02845000
*               &ICTMFLG1(SELMX2)=SELMTYPE/* ... AND TYPE            */ 02846000
*               &ICTMNOGO(SELMX2)=OFF/* ... AND MOD NOT NOGO         */ 02847000
*               &ICTPNOGO(1)=OFF THEN/* ... AND SYSMOD NOT NOGO      */ 02848000
         LA    @15,144                                             0874 02849000
         LR    @01,SELMX1                                          0874 02850000
         MR    @00,@15                                             0874 02851000
         L     @14,CCAICMOD(,CCAPTR)                               0874 02852000
         LA    @15,0(@01,@14)                                      0874 02853000
         AL    @15,@CF02699                                        0874 02854000
         LA    @00,144                                             0874 02855000
         ST    @15,@TF00001                                        0874 02856000
         LR    @15,@00                                             0874 02857000
         MR    @14,SELMX2                                          0874 02858000
         L     @14,CCAICMOD(,CCAPTR)                               0874 02859000
         ST    @01,@TF00002                                        0874 02860000
         L     @01,@TF00001                                        0874 02861000
         ST    @15,@TF00001                                        0874 02862000
         ALR   @15,@14                                             0874 02863000
         AL    @15,@CF02699                                        0874 02864000
         CLC   SELMNAME(8,@01),ICTMNAME(@15)                       0874 02865000
         BNE   @RF00874                                            0874 02866000
         L     @15,@TF00002                                        0874 02867000
         AL    @15,@CF02700                                        0874 02868000
         LA    @15,ICTMFLG1-9(@15,@14)                             0874 02869000
         LR    @01,@14                                             0874 02870000
         AL    @01,@TF00001                                        0874 02871000
         AL    @01,@CF02700                                        0874 02872000
         CLC   ICTMFLG1-9(1,@01),SELMTYPE(@15)                     0874 02873000
         BNE   @RF00874                                            0874 02874000
         LR    @15,@14                                             0874 02875000
         AL    @15,@TF00001                                        0874 02876000
         AL    @15,@CF02704                                        0874 02877000
         TM    ICTMNOGO-8(@15),B'01000000'                         0874 02878000
         BNZ   @RF00874                                            0874 02879000
         L     @15,@TF00001                                        0874 02880000
         AL    @15,@CF02701                                        0874 02881000
         L     @01,ICTPPTR-96(@15,@14)                             0874 02882000
         TM    ICTPNOGO(@01),B'01000000'                           0874 02883000
         BNZ   @RF00874                                            0874 02884000
*             DO;                   /* YES,                          */ 02885000
*               ICTMPASS(SELMX2)=ON;/* MARK AS PROCESSED BY SELECTION*/ 02886000
         LR    @15,@14                                             0876 02887000
         AL    @15,@TF00001                                        0876 02888000
         AL    @15,@CF02708                                        0876 02889000
         OI    ICTMPASS-12(@15),B'10000000'                        0876 02890000
*               IF ICTMASM(SELMX2)=OFF THEN/* NOT AN ASSEMBLY?       */ 02891000
         LR    @15,@14                                             0877 02892000
         AL    @15,@TF00001                                        0877 02893000
         AL    @15,@CF02700                                        0877 02894000
         TM    ICTMASM-9(@15),B'01000000'                          0877 02895000
         BNZ   @RF00877                                            0877 02896000
*                 DO;               /* YES,                          */ 02897000
*                   IF SELMO#2<ICTPONUM(1) THEN/* IS ORDER NUMBER FOR   02898000
*                                      THIS ELEMENT'S SYSMOD HIGHEST */ 02899000
         L     @15,@TF00001                                        0879 02900000
         AL    @15,@CF02701                                        0879 02901000
         L     @01,ICTPPTR-96(@15,@14)                             0879 02902000
         SLR   @15,@15                                             0879 02903000
         ICM   @15,3,ICTPONUM(@01)                                 0879 02904000
         CLR   SELMO#2,@15                                         0879 02905000
         BNL   @RF00879                                            0879 02906000
*                     DO;           /* YES,                          */ 02907000
*                       SELMO#2=ICTPONUM(1);/* RESET HIGHEST ORDER # */ 02908000
         LR    SELMO#2,@15                                         0881 02909000
*                       SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND SLECTED    02910000
*                                      PTR                           */ 02911000
         L     SELMPTR2,@TF00001                                   0882 02912000
         AL    @14,@CF02699                                        0882 02913000
         LA    SELMPTR2,ICTMOD(SELMPTR2,@14)                       0882 02914000
*                     END;                                         0883 02915000
*                 END;                                             0884 02916000
*               ELSE                /* ELEMENT IS AN ASSEMBLY        */ 02917000
*                 DO;                                              0885 02918000
         B     @RC00877                                            0885 02919000
@RF00877 DS    0H                                                  0886 02920000
*                   IF SELMDEL=OFF THEN/* DELETE NOT ALREADY FOUND?  */ 02921000
         TM    SELMDEL,B'01000000'                                 0886 02922000
         BNZ   @RF00886                                            0886 02923000
*                     DO;           /*                               */ 02924000
*                       IF ICTMIDEL(SELMX2)=ON THEN/* DELETE ENTRY?  */ 02925000
         LR    @15,SELMX2                                          0888 02926000
         MH    @15,@CH02665                                        0888 02927000
         L     @14,CCAICMOD(,CCAPTR)                               0888 02928000
         ST    @15,@TF00001                                        0888 02929000
         ALR   @15,@14                                             0888 02930000
         AL    @15,@CF02702                                        0888 02931000
         TM    ICTMIDEL-11(@15),B'01000000'                        0888 02932000
         BNO   @RF00888                                            0888 02933000
*                         DO;       /* YES,                          */ 02934000
*                           SELMO#2=ICTPONUM(1);/* DELETE IS HIGNEST */ 02935000
         L     @15,@TF00001                                        0890 02936000
         AL    @15,@CF02701                                        0890 02937000
         L     @01,ICTPPTR-96(@15,@14)                             0890 02938000
         SLR   SELMO#2,SELMO#2                                     0890 02939000
         ICM   SELMO#2,3,ICTPONUM(@01)                             0890 02940000
*                           SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND   0891 02941000
*                                      SLECTED PTR                   */ 02942000
         L     SELMPTR2,@TF00001                                   0891 02943000
         AL    @14,@CF02699                                        0891 02944000
         LA    SELMPTR2,ICTMOD(SELMPTR2,@14)                       0891 02945000
*                           SELMDEL=ON;/* DELETE FOUND               */ 02946000
         OI    SELMDEL,B'01000000'                                 0892 02947000
*                         END;                                     0893 02948000
*                       ELSE        /* PREVIOUS DELETE ENTRY         */ 02949000
*                         DO;                                      0894 02950000
         B     @RC00888                                            0894 02951000
@RF00888 DS    0H                                                  0895 02952000
*                           IF SELMO#2<ICTPONUM(1) THEN/* IS ORDER 0895 02953000
*                                      NUMBER FOR THIS ELEMENT'S   0895 02954000
*                                      SYSMOD HIGHEST                */ 02955000
         LR    @15,SELMX2                                          0895 02956000
         MH    @15,@CH02665                                        0895 02957000
         L     @14,CCAICMOD(,CCAPTR)                               0895 02958000
         LA    @01,0(@15,@14)                                      0895 02959000
         AL    @01,@CF02701                                        0895 02960000
         L     @01,ICTPPTR-96(,@01)                                0895 02961000
         SLR   @00,@00                                             0895 02962000
         ICM   @00,3,ICTPONUM(@01)                                 0895 02963000
         CLR   SELMO#2,@00                                         0895 02964000
         BNL   @RF00895                                            0895 02965000
*                             DO;   /* YES,                          */ 02966000
*                               SELMO#2=ICTPONUM(1);/* RESET HIGHEST    02967000
*                                      ORDER #                       */ 02968000
         LR    SELMO#2,@00                                         0897 02969000
*                               SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND    02970000
*                                      SLECTED PTR                   */ 02971000
         AL    @14,@CF02699                                        0898 02972000
         LA    SELMPTR2,ICTMOD(@15,@14)                            0898 02973000
*                             END;                                 0899 02974000
*                         END;                                     0900 02975000
*                     END;                                         0901 02976000
*                   ELSE            /* ONE DELETE ENTRY ALREADY FOUND*/ 02977000
*                     DO;           /*                               */ 02978000
         B     @RC00886                                            0902 02979000
@RF00886 DS    0H                                                  0903 02980000
*                       IF ICTMIDEL(SELMX2)=ON/* DELETE ENTRY?       */ 02981000
*                           &SELMO#2<ICTPONUM(1) THEN/* IS ORDER   0903 02982000
*                                      NUMBER FOR THIS ELEMENT'S   0903 02983000
*                                      SYSMOD HIGHEST                */ 02984000
         LR    @15,SELMX2                                          0903 02985000
         MH    @15,@CH02665                                        0903 02986000
         L     @14,CCAICMOD(,CCAPTR)                               0903 02987000
         ST    @15,@TF00001                                        0903 02988000
         ALR   @15,@14                                             0903 02989000
         AL    @15,@CF02702                                        0903 02990000
         TM    ICTMIDEL-11(@15),B'01000000'                        0903 02991000
         BNO   @RF00903                                            0903 02992000
         L     @15,@TF00001                                        0903 02993000
         AL    @15,@CF02701                                        0903 02994000
         L     @01,ICTPPTR-96(@15,@14)                             0903 02995000
         SLR   @15,@15                                             0903 02996000
         ICM   @15,3,ICTPONUM(@01)                                 0903 02997000
         CLR   SELMO#2,@15                                         0903 02998000
         BNL   @RF00903                                            0903 02999000
*                         DO;       /* YES,                          */ 03000000
*                           SELMO#2=ICTPONUM(1);/* RESET HIGHEST   0905 03001000
*                                      ORDER #                       */ 03002000
         LR    SELMO#2,@15                                         0905 03003000
*                           SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND   0906 03004000
*                                      SLECTED PTR                   */ 03005000
         L     SELMPTR2,@TF00001                                   0906 03006000
         AL    @14,@CF02699                                        0906 03007000
         LA    SELMPTR2,ICTMOD(SELMPTR2,@14)                       0906 03008000
*                         END;                                     0907 03009000
*                     END;          /*                               */ 03010000
@RF00903 DS    0H                                                  0909 03011000
*                 END;                                             0909 03012000
@RC00886 DS    0H                                                  0910 03013000
*               IF SELMONUM<ICTPONUM(1) THEN/* IS ORDER NUMBER FOR 0910 03014000
*                                      THIS ELEMENT'S SYSMOD HIGHER     03015000
*                                      THAN PREVIOUSLY SELECTED    0910 03016000
*                                      ELEMENT?                      */ 03017000
@RC00877 LR    @15,SELMX2                                          0910 03018000
         MH    @15,@CH02665                                        0910 03019000
         L     @01,CCAICMOD(,CCAPTR)                               0910 03020000
         AL    @01,@CF02701                                        0910 03021000
         L     @01,ICTPPTR-96(@15,@01)                             0910 03022000
         CLC   SELMONUM(2),ICTPONUM(@01)                           0910 03023000
         BNL   @RF00910                                            0910 03024000
*                 DO;               /* YES,                          */ 03025000
*                                                                  0911 03026000
*                   /*************************************************/ 03027000
*                   /*                                               */ 03028000
*                   /* SEARCH THE MOD ID LIST TO SEE SYSMOD IS IN    */ 03029000
*                   /* MODID IF SO, THEN RESET SO THAT THIS IS THE   */ 03030000
*                   /* SELECTED ELEMENT VERSION.                     */ 03031000
*                   /*                                               */ 03032000
*                   /*************************************************/ 03033000
*                                                                  0912 03034000
*                   DO SELMX3=1 BY 1/* PROCESS THE CDS MOD ID LIST   */ 03035000
*                         WHILE(ICTMIDND(SELMX3)^=ICTENDNT/*         */ 03036000
*                         &SELMRC<STOPFUNC);                       0912 03037000
         LA    @15,1                                               0912 03038000
         ST    @15,SELMX3                                          0912 03039000
         B     @DE00912                                            0912 03040000
@DL00912 DS    0H                                                  0913 03041000
*                     IF ICTMODID(SELMX3)=ICTPTFS(1) THEN/* THIS MOD    03042000
*                                      ID?                           */ 03043000
         L     @15,SELMX3                                          0913 03044000
         SLA   @15,3                                               0913 03045000
         LR    @14,SELMX2                                          0913 03046000
         MH    @14,@CH02665                                        0913 03047000
         L     @01,CCAICMOD(,CCAPTR)                               0913 03048000
         LA    @01,0(@14,@01)                                      0913 03049000
         AL    @01,@CF02707                                        0913 03050000
         L     @01,ICTMICHN-104(,@01)                              0913 03051000
         L     @00,CCAICMOD(,CCAPTR)                               0913 03052000
         ST    @01,@TF00001                                        0913 03053000
         LR    @01,@00                                             0913 03054000
         AL    @01,@CF02701                                        0913 03055000
         L     @01,ICTPPTR-96(@14,@01)                             0913 03056000
         ST    @14,@TF00002                                        0913 03057000
         L     @14,@TF00001                                        0913 03058000
         ALR   @14,@15                                             0913 03059000
         AL    @14,@CF02695                                        0913 03060000
         CLC   ICTMODID(7,@14),ICTPTFS(@01)                        0913 03061000
         BNE   @RF00913                                            0913 03062000
*                       DO;         /* YES,                          */ 03063000
*                         SELMONUM=ICTPONUM(1);/* RESET SELECTED   0915 03064000
*                                      ORDER #                       */ 03065000
         MVC   SELMONUM(2),ICTPONUM(@01)                           0915 03066000
*                         SELMPTR1=ADDR(ICTMOD(SELMX2));/* AND     0916 03067000
*                                      SLECTED PTR                   */ 03068000
         LR    SELMPTR1,@00                                        0916 03069000
         L     @01,@TF00002                                        0916 03070000
         AL    SELMPTR1,@CF02699                                   0916 03071000
         LA    SELMPTR1,ICTMOD(@01,SELMPTR1)                       0916 03072000
*                       END;                                       0917 03073000
*                     ELSE                                         0918 03074000
*                       ;           /* NOT THIS MOD ID ENTRY         */ 03075000
@RF00913 DS    0H                                                  0919 03076000
*                   END;            /* END OF MODID LIST SEARCH      */ 03077000
         LA    @15,1                                               0919 03078000
         AL    @15,SELMX3                                          0919 03079000
         ST    @15,SELMX3                                          0919 03080000
@DE00912 L     @15,SELMX3                                          0919 03081000
         SLA   @15,3                                               0919 03082000
         LR    @14,SELMX2                                          0919 03083000
         MH    @14,@CH02665                                        0919 03084000
         L     @01,CCAICMOD(,CCAPTR)                               0919 03085000
         AL    @01,@CF02707                                        0919 03086000
         L     @01,ICTMICHN-104(@14,@01)                           0919 03087000
         AL    @01,@CF02695                                        0919 03088000
         L     @15,ICTMIDND(@15,@01)                               0919 03089000
         CL    @15,ICTENDNT                                        0919 03090000
         BE    @DC00912                                            0919 03091000
         CH    SELMRC,@CH00033                                     0919 03092000
         BL    @DL00912                                            0919 03093000
@DC00912 DS    0H                                                  0920 03094000
*                 END;                                             0920 03095000
*               ELSE                                               0921 03096000
*                 ;                 /* ORDER NUMBER NOT GREATER      */ 03097000
@RF00910 DS    0H                                                  0922 03098000
*             END;                                                 0922 03099000
*           ELSE                                                   0923 03100000
*             ;                     /* NOT SAME ELEMENT              */ 03101000
@RF00874 DS    0H                                                  0924 03102000
*         END;                                                     0924 03103000
         AH    SELMX2,@CH00064                                     0924 03104000
@DE00873 LR    @15,SELMX2                                          0924 03105000
         MH    @15,@CH02665                                        0924 03106000
         L     @01,CCAICMOD(,CCAPTR)                               0924 03107000
         AL    @01,@CF02699                                        0924 03108000
         L     @15,ICTMEND(@15,@01)                                0924 03109000
         CL    @15,ICTENDNT                                        0924 03110000
         BE    @DC00873                                            0924 03111000
         CH    SELMRC,@CH00033                                     0924 03112000
         BL    @DL00873                                            0924 03113000
@DC00873 DS    0H                                                  0925 03114000
*         IF SELMPTR1^=ZERO         /* HIGHEST ELEMENT FOUND?        */ 03115000
*             &SELMDEL=OFF THEN     /* ... AND NOT DELETE CASE?      */ 03116000
         LTR   SELMPTR1,SELMPTR1                                   0925 03117000
         BZ    @RF00925                                            0925 03118000
         TM    SELMDEL,B'01000000'                                 0925 03119000
         BNZ   @RF00925                                            0925 03120000
*           DO;                     /* YES,                          */ 03121000
*             SELMPTR1->ICTMISEL(1)=ON;/* ELEMENT SELECTED           */ 03122000
         OI    ICTMISEL(SELMPTR1),B'10000000'                      0927 03123000
*           END;                                                   0928 03124000
*         ELSE                      /* ELEMENT FOR SYSMOD THAT IS IN    03125000
*                                      THE MOD ID LIST NOT FOUND     */ 03126000
*           DO;                                                    0929 03127000
         B     @RC00925                                            0929 03128000
@RF00925 DS    0H                                                  0930 03129000
*             IF SELMPTR2^=ZERO THEN/* HIGHEST ELEMENT FOUND?        */ 03130000
         LTR   SELMPTR2,SELMPTR2                                   0930 03131000
         BZ    @RF00930                                            0930 03132000
*               DO;                 /* YES,                          */ 03133000
*                 SELMPTR2->ICTMISEL(1)=ON;/* NONE IS IN THE MOD ID     03134000
*                                      LIST SO ASSUME THAT IT WAS A     03135000
*                                      MOD DELETE AND SET HIGHEST  0932 03136000
*                                      ORDER NUMBER ENTRY AS SELECTED*/ 03137000
         OI    ICTMISEL(SELMPTR2),B'10000000'                      0932 03138000
*               END;                                               0933 03139000
*           END;                                                   0934 03140000
*       END;                                                       0935 03141000
*     ELSE                                                         0936 03142000
*       ;                           /* ELEMENT ALREADY PROCESSED,  0936 03143000
*                                      SKIP IT                       */ 03144000
@RF00866 DS    0H                                                  0937 03145000
*   END;                            /* END OF PROCESS ALL ELEMENTS 0937 03146000
*                                      LOOP                          */ 03147000
*                                                                  0937 03148000
@RC00866 AH    SELMX1,@CH00064                                     0937 03149000
@DE00865 LR    @05,SELMX1                                          0937 03150000
         MH    @05,@CH02665                                        0937 03151000
         L     @02,CCAICMOD(,CCAPTR)                               0937 03152000
         AL    @02,@CF02699                                        0937 03153000
         L     @05,ICTMEND(@05,@02)                                0937 03154000
         CL    @05,ICTENDNT                                        0937 03155000
         BE    @DC00865                                            0937 03156000
         CH    SELMRC,@CH00033                                     0937 03157000
         BL    @DL00865                                            0937 03158000
@DC00865 DS    0H                                                  0938 03159000
*   /*****************************************************************/ 03160000
*   /*                                                               */ 03161000
*   /* DETERMINE THE ASSEMBLIES THAT HAVE TO BE DONE                 */ 03162000
*   /*                                                               */ 03163000
*   /*****************************************************************/ 03164000
*                                                                  0938 03165000
*   DO SELMX1=1 BY 1                /* PROCESS ALL ELEMENT ENTRIES IN   03166000
*                                      THE ICT                       */ 03167000
*         WHILE(ICTMEND(SELMX1)^=ICTENDNT/* ...                      */ 03168000
*         &SELMRC<STOPFUNC);                                       0938 03169000
*                                                                  0938 03170000
         LA    SELMX1,1                                            0938 03171000
         B     @DE00938                                            0938 03172000
@DL00938 DS    0H                                                  0939 03173000
*     /***************************************************************/ 03174000
*     /*                                                             */ 03175000
*     /* SEE IF MATCHING MOD FOR THE SOURCE ASSEMBLY                 */ 03176000
*     /*                                                             */ 03177000
*     /***************************************************************/ 03178000
*                                                                  0939 03179000
*     IF ICTMISEL(SELMX1)=ON        /* SELECTED                      */ 03180000
*         &ICTMSRCR(SELMX1)=ON THEN /* ... AND A SOURCE ENTRY?       */ 03181000
         LR    @05,SELMX1                                          0939 03182000
         MH    @05,@CH02665                                        0939 03183000
         L     @02,CCAICMOD(,CCAPTR)                               0939 03184000
         ST    @05,@TF00001                                        0939 03185000
         ALR   @05,@02                                             0939 03186000
         AL    @05,@CF02702                                        0939 03187000
         TM    ICTMISEL-11(@05),B'10000000'                        0939 03188000
         BNO   @RF00939                                            0939 03189000
         AL    @02,@TF00001                                        0939 03190000
         AL    @02,@CF02700                                        0939 03191000
         TM    ICTMSRCR-9(@02),B'00000010'                         0939 03192000
         BNO   @RF00939                                            0939 03193000
*       DO;                         /* YES,                          */ 03194000
*         SELMMFND=OFF;             /* MATCHING MOD NOT YET FOUND    */ 03195000
         NI    SELMMFND,B'01111111'                                0941 03196000
*         DO SELMX2=1 BY 1          /* SEARCH ALL ELEMENTS FOR MOD 0942 03197000
*                                      ENTRY FOR SOURCE ENTRY        */ 03198000
*               WHILE(ICTMEND(SELMX2)^=ICTENDNT/* ...                */ 03199000
*               &SELMMFND=OFF       /*                               */ 03200000
*               &SELMRC<STOPFUNC);                                 0942 03201000
         LA    SELMX2,1                                            0942 03202000
         B     @DE00942                                            0942 03203000
@DL00942 DS    0H                                                  0943 03204000
*           IF(ICTMMOD(SELMX2)=ON   /* MOD ENTRY                     */ 03205000
*               &ICTMASM(SELMX2)=OFF)/* ...                          */ 03206000
*               &ICTMISEL(SELMX2)=ON/* ... AND SELECTED              */ 03207000
*               &ICTMNAME(SELMX2)=ICTMNAME(SELMX1) THEN/* AND MATCHES   03208000
*                                      SOURCE?                       */ 03209000
         LA    @05,144                                             0943 03210000
         LR    @01,SELMX2                                          0943 03211000
         MR    @00,@05                                             0943 03212000
         L     @15,CCAICMOD(,CCAPTR)                               0943 03213000
         ST    @01,@TF00001                                        0943 03214000
         ALR   @01,@15                                             0943 03215000
         AL    @01,@CF02700                                        0943 03216000
         TM    ICTMMOD-9(@01),B'10000000'                          0943 03217000
         BNO   @RF00943                                            0943 03218000
         TM    ICTMASM-9(@01),B'01000000'                          0943 03219000
         BNZ   @RF00943                                            0943 03220000
         LR    @14,@15                                             0943 03221000
         AL    @14,@TF00001                                        0943 03222000
         AL    @14,@CF02702                                        0943 03223000
         TM    ICTMISEL-11(@14),B'10000000'                        0943 03224000
         BNO   @RF00943                                            0943 03225000
         LR    @01,@05                                             0943 03226000
         MR    @00,SELMX1                                          0943 03227000
         LR    @05,@15                                             0943 03228000
         AL    @05,@TF00001                                        0943 03229000
         AL    @05,@CF02699                                        0943 03230000
         ALR   @15,@01                                             0943 03231000
         AL    @15,@CF02699                                        0943 03232000
         CLC   ICTMNAME(8,@05),ICTMNAME(@15)                       0943 03233000
         BNE   @RF00943                                            0943 03234000
*             DO;                   /* YES,                          */ 03235000
*               SELMMFND=ON;        /* MOD FOR SOURCE FOUND          */ 03236000
         OI    SELMMFND,B'10000000'                                0945 03237000
*             END;                                                 0946 03238000
*           ELSE                                                   0947 03239000
*             ;                     /* SKIP IT SINCE NOT SELECTED MOD   03240000
*                                      FOR SOURCE                    */ 03241000
@RF00943 DS    0H                                                  0948 03242000
*         END;                      /* END MATCHING MOD ENTRY SEARCH */ 03243000
         AH    SELMX2,@CH00064                                     0948 03244000
@DE00942 LR    @05,SELMX2                                          0948 03245000
         MH    @05,@CH02665                                        0948 03246000
         L     @01,CCAICMOD(,CCAPTR)                               0948 03247000
         AL    @01,@CF02699                                        0948 03248000
         L     @05,ICTMEND(@05,@01)                                0948 03249000
         CL    @05,ICTENDNT                                        0948 03250000
         BE    @DC00942                                            0948 03251000
         TM    SELMMFND,B'10000000'                                0948 03252000
         BNZ   @DC00942                                            0948 03253000
         CH    SELMRC,@CH00033                                     0948 03254000
         BL    @DL00942                                            0948 03255000
@DC00942 DS    0H                                                  0949 03256000
*         IF SELMMFND=ON THEN       /* MATCH FOUND?                  */ 03257000
         TM    SELMMFND,B'10000000'                                0949 03258000
         BNO   @RF00949                                            0949 03259000
*           DO;                     /* YES,                          */ 03260000
*                                                                  0950 03261000
*             /*******************************************************/ 03262000
*             /*                                                     */ 03263000
*             /* AT THIS POINT, A SELECTED SOURCE ELEMENT HAS A      */ 03264000
*             /* MATCHING SELECTED MOD SO THAT NO ASSEMBLY SHOULD BE */ 03265000
*             /* DONE                                                */ 03266000
*             /*                                                     */ 03267000
*             /*******************************************************/ 03268000
*                                                                  0951 03269000
*             DO SELMX2=1 BY 1      /* SEARCH ALL ELEMENTS FOR ASSEM    03270000
*                                      ENTRY FOR SOURCE ENTRY        */ 03271000
*                   WHILE(ICTMEND(SELMX2)^=ICTENDNT/* ...            */ 03272000
*                   &SELMRC<STOPFUNC);                             0951 03273000
         LA    SELMX2,1                                            0951 03274000
         B     @DE00951                                            0951 03275000
@DL00951 DS    0H                                                  0952 03276000
*               IF(ICTMASM(SELMX2)=ON/* ASSEM ENTRY                  */ 03277000
*                   &ICTMASM(SELMX2)=ON)/* ...                       */ 03278000
*                   &ICTMISEL(SELMX2)=ON/* ... AND SELECTED          */ 03279000
*                   &ICTMNAME(SELMX2)=ICTMNAME(SELMX1) THEN/* AND  0952 03280000
*                                      MATCHES SOURCE?               */ 03281000
         LA    @05,144                                             0952 03282000
         LR    @01,SELMX2                                          0952 03283000
         MR    @00,@05                                             0952 03284000
         L     @15,CCAICMOD(,CCAPTR)                               0952 03285000
         ST    @01,@TF00001                                        0952 03286000
         ALR   @01,@15                                             0952 03287000
         AL    @01,@CF02700                                        0952 03288000
         TM    ICTMASM-9(@01),B'01000000'                          0952 03289000
         BNO   @RF00952                                            0952 03290000
         LR    @14,@15                                             0952 03291000
         AL    @14,@TF00001                                        0952 03292000
         AL    @14,@CF02702                                        0952 03293000
         TM    ICTMISEL-11(@14),B'10000000'                        0952 03294000
         BNO   @RF00952                                            0952 03295000
         LR    @01,@05                                             0952 03296000
         MR    @00,SELMX1                                          0952 03297000
         LR    @05,@15                                             0952 03298000
         AL    @05,@TF00001                                        0952 03299000
         AL    @05,@CF02699                                        0952 03300000
         ALR   @01,@15                                             0952 03301000
         AL    @01,@CF02699                                        0952 03302000
         CLC   ICTMNAME(8,@05),ICTMNAME(@01)                       0952 03303000
         BNE   @RF00952                                            0952 03304000
*                 DO;               /* YES,                          */ 03305000
*                   ICTMISEL(SELMX2)=OFF;/* UN-SELECT THE ASSEMBLY SO   03306000
*                                      THAT MOD WILL BE USED AND NO     03307000
*                                      ASSEMBLY                      */ 03308000
         AL    @15,@TF00001                                        0954 03309000
         AL    @15,@CF02702                                        0954 03310000
         NI    ICTMISEL-11(@15),B'01111111'                        0954 03311000
*                 END;                                             0955 03312000
*               ELSE                                               0956 03313000
*                 ;                 /* SKIP IT SINCE NOT SELECTED MOD   03314000
*                                      FOR SOURCE                    */ 03315000
@RF00952 DS    0H                                                  0957 03316000
*             END;                  /* END MATCHING MOD ENTRY SEARCH */ 03317000
         AH    SELMX2,@CH00064                                     0957 03318000
@DE00951 LR    @05,SELMX2                                          0957 03319000
         MH    @05,@CH02665                                        0957 03320000
         L     @01,CCAICMOD(,CCAPTR)                               0957 03321000
         AL    @01,@CF02699                                        0957 03322000
         L     @05,ICTMEND(@05,@01)                                0957 03323000
         CL    @05,ICTENDNT                                        0957 03324000
         BE    @DC00951                                            0957 03325000
         CH    SELMRC,@CH00033                                     0957 03326000
         BL    @DL00951                                            0957 03327000
@DC00951 DS    0H                                                  0958 03328000
*           END;                                                   0958 03329000
*       END;                                                       0959 03330000
*     ELSE                                                         0960 03331000
*       ;                           /* NOT A SELECTED SOURCE ENTRY SO   03332000
*                                      SKIP IT                       */ 03333000
@RF00939 DS    0H                                                  0961 03334000
*   END;                            /* END OF PROCESS ALL ELEMENTS 0961 03335000
*                                      LOOP                          */ 03336000
@RC00939 AH    SELMX1,@CH00064                                     0961 03337000
@DE00938 LR    @05,SELMX1                                          0961 03338000
         MH    @05,@CH02665                                        0961 03339000
         L     @02,CCAICMOD(,CCAPTR)                               0961 03340000
         AL    @02,@CF02699                                        0961 03341000
         L     @05,ICTMEND(@05,@02)                                0961 03342000
         CL    @05,ICTENDNT                                        0961 03343000
         BE    @DC00938                                            0961 03344000
         CH    SELMRC,@CH00033                                     0961 03345000
         BL    @DL00938                                            0961 03346000
@DC00938 DS    0H                                                  0962 03347000
*   RETURN CODE(SELMRC);            /* RETURN W/ RETURN CODE         */ 03348000
         LR    @15,SELMRC                                          0962 03349000
         L     @14,@SA00013                                        0962 03350000
         LM    @00,@12,@SA00013+8                                  0962 03351000
         BR    @14                                                 0962 03352000
*   RFY                                                            0963 03353000
*     ICTMOD BASED;                                                0963 03354000
*   RFY                                                            0964 03355000
*     ICTPTF BASED;                                                0964 03356000
*   RFY                                                            0965 03357000
*     ICTMIDLS BASED;                                              0965 03358000
*   RFY                                                            0966 03359000
*     TSLPARMS BASED;                                              0966 03360000
*   END SELMOD;                                                    0967 03361000
         EJECT                                                          03362000
*                                                                  0968 03363000
*/********************************************************************/ 03364000
*/*                                                                  */ 03365000
*/* MODIDCHK -                                                       */ 03366000
*/*                                                                  */ 03367000
*/********************************************************************/ 03368000
*/*                                                                  */ 03369000
*/*  SYSMOD NAME PRESENT IN CDS AND ACDS MOD ID LISTS:               */ 03370000
*/*                                                                  */ 03371000
*/*               | ACDS                                             */ 03372000
*/*               | ^P | P  |                                        */ 03373000
*/* ______________|____|____|                                        */ 03374000
*/*    C  ^PRESENT| 1  | 2  |                                        */ 03375000
*/*    D  ________|____|____|                                        */ 03376000
*/*    S  PRESENT | 3  | 4  |                                        */ 03377000
*/*       ________|____|____|                                        */ 03378000
*/*                                                                  */ 03379000
*/*  CASE 1 - WILL NOT OCCUR                                         */ 03380000
*/*                                                                  */ 03381000
*/*  CASE 2 - ELEMENT IS NOGO SINCE MOD ID IS ON THE ACDS BUT NOT    */ 03382000
*/*           THE CDS                                                */ 03383000
*/*                                                                  */ 03384000
*/*  CASE 3 - THE SYSMOD IN THE ID LIST MUST BE A CADIDATE FOR       */ 03385000
*/*           RESTORE OR THE ELEMENT IS NOGO                         */ 03386000
*/*                                                                  */ 03387000
*/*  CASE 4                                                          */ 03388000
*/*                                                                  */ 03389000
*/*               | ACDS STATUS                                      */ 03390000
*/*               |    |    |    |    |    |    |    |               */ 03391000
*/*               |    |    |    | S  |    |    |    |               */ 03392000
*/*               |    |    |    | U  |    |    |    |               */ 03393000
*/*               |    |    |    | P  | D  |    |    |               */ 03394000
*/*               |    | E  |    |    | E  |    |    |               */ 03395000
*/*               |    | R  |    | O  | L  |    |    |               */ 03396000
*/*               |    | R  | S  | N  | E  |    |    |               */ 03397000
*/*               | O  | O  | U  | L  | T  |    |    |               */ 03398000
*/*               | K  | R  | P  | Y  | E  |    |    |               */ 03399000
*/*_______________|____|____|____|____|____|____|____|               */ 03400000
*/*   C        OK | OK | E  | ?  | ?  | E  |    |    |               */ 03401000
*/*   D  _________|____|____|____|____|____|____|____|               */ 03402000
*/*   S     ERROR | E  | E  | E  | E  | E  |    |    |               */ 03403000
*/*      _________|____|____|____|____|____|____|____|               */ 03404000
*/*   S       SUP | OK | E  | OK | ?  | E  |    |    |               */ 03405000
*/*   T  _________|____|____|____|____|____|____|____|               */ 03406000
*/*   A  SUP ONLY | E  | E  | E  | E  | E  |    |    |               */ 03407000
*/*   T  _________|____|____|____|____|____|____|____|               */ 03408000
*/*   U    DELETE | E  | E  | E  | E  | E  |    |    |               */ 03409000
*/*   S  _________|____|____|____|____|____|____|____|               */ 03410000
*/*               |    |    |    |    |    |    |    |               */ 03411000
*/*       ________|____|____|____|____|____|____|____|               */ 03412000
*/*               |    |    |    |    |    |    |    |               */ 03413000
*/*       ________|____|____|____|____|____|____|____|               */ 03414000
*/*                                                                  */ 03415000
*/*                                                                  */ 03416000
*/*                                                                  */ 03417000
*/********************************************************************/ 03418000
*                                                                  0968 03419000
*MODIDCHK:                                                         0968 03420000
*   PROC;                                                          0968 03421000
MODIDCHK STM   @14,@12,@SA00014                                    0968 03422000
*   DCL                                                            0969 03423000
*     MODIRC FIXED(15);             /* LOCAL RETURN CODE             */ 03424000
*   DCL                                                            0970 03425000
*     MODI1PRC FIXED(15);           /* RETURN CODE FOR PASS THRU ONE    03426000
*                                      SYSMOD                        */ 03427000
*   DCL                                                            0971 03428000
*     MODIX1 FIXED(31);             /* ICT MOD ENTRY INDEX COUNTER   */ 03429000
*   DCL                                                            0972 03430000
*     MODIX2 FIXED(31);             /* CDS MOD ID INDEX LIST INDEX 0972 03431000
*                                      COUNTER                       */ 03432000
*   RFY                                                            0973 03433000
*     ICTPTF BASED(CCAICPTF);                                      0973 03434000
*   RFY                                                            0974 03435000
*     ICTIXPF BASED(ICTPCHN(MODIX1));                              0974 03436000
*   RFY                                                            0975 03437000
*     ICTMOD BASED(ICTIXP(MODIX2));                                0975 03438000
*   RFY                                                            0976 03439000
*     TSLPARMS BASED(TBLXTSLP);                                    0976 03440000
*   RFY                                                            0977 03441000
*     ICTMIDLS BASED(ICTMICHN(MODIX1));/* CDS MODID CHAIN            */ 03442000
*   MODIRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 03443000
         SLR   MODIRC,MODIRC                                       0978 03444000
*   DO MODIX1=1 BY 1                /* PROCESS ALL SYSMOD ENTRIES IN    03445000
*                                      THE ICT                       */ 03446000
*         WHILE(ICTPEND(MODIX1)^=ICTENDNT/*                          */ 03447000
*         &MODIRC<STOPFUNC);                                       0979 03448000
         LA    MODIX1,1                                            0979 03449000
         B     @DE00979                                            0979 03450000
@DL00979 DS    0H                                                  0980 03451000
*     MODI1PRC=ZERO;                /* CLEAR ONE PASS RC             */ 03452000
         SLR   MODI1PRC,MODI1PRC                                   0980 03453000
*     IF ICTPNOGO(MODIX1)=OFF THEN  /* NOT NOGO?                     */ 03454000
         LR    @07,MODIX1                                          0981 03455000
         MH    @07,@CH02662                                        0981 03456000
         L     @04,CCAICPTF(,CCAPTR)                               0981 03457000
         ALR   @04,@07                                             0981 03458000
         AL    @04,@CF02692                                        0981 03459000
         TM    ICTPNOGO-8(@04),B'01000000'                         0981 03460000
         BNZ   @RF00981                                            0981 03461000
*       DO;                         /* YES,                          */ 03462000
*                                                                  0982 03463000
*         /***********************************************************/ 03464000
*         /*                                                         */ 03465000
*         /* PROCESS ALL CDS MODID'S FOR AN ELEMENT                  */ 03466000
*         /*                                                         */ 03467000
*         /***********************************************************/ 03468000
*                                                                  0983 03469000
*         DO MODIX2=1 BY 1          /* PROCESS ALL MODS FOR A SYSMOD */ 03470000
*               WHILE(ICTIXP(MODIX2)^=ICTENDNT/*                     */ 03471000
*               &MODIRC<STOPFUNC);                                 0983 03472000
         LA    MODIX2,1                                            0983 03473000
         B     @DE00983                                            0983 03474000
@DL00983 DS    0H                                                  0984 03475000
*           IF ICTMISEL(1)=ON       /* SELECTED ELEMENT ...          */ 03476000
*               &ICTMNOGO(1)=OFF    /* ... STILL GO?                 */ 03477000
*             THEN                                                 0984 03478000
         LR    @07,MODIX2                                          0984 03479000
         SLA   @07,2                                               0984 03480000
         LR    @02,MODIX1                                          0984 03481000
         MH    @02,@CH02662                                        0984 03482000
         L     @01,CCAICPTF(,CCAPTR)                               0984 03483000
         AL    @01,@CF02710                                        0984 03484000
         L     @02,ICTPCHN-64(@02,@01)                             0984 03485000
         AL    @02,@CF02711                                        0984 03486000
         L     @07,ICTIXP(@07,@02)                                 0984 03487000
         TM    ICTMISEL(@07),B'10000000'                           0984 03488000
         BNO   @RF00984                                            0984 03489000
         TM    ICTMNOGO(@07),B'01000000'                           0984 03490000
         BNZ   @RF00984                                            0984 03491000
*             DO;                   /* YES,                          */ 03492000
*                                                                  0985 03493000
*               /*****************************************************/ 03494000
*               /*                                                   */ 03495000
*               /* PERFORM MODID CHECKING FOR ONE ELEMENT            */ 03496000
*               /*                                                   */ 03497000
*               /*****************************************************/ 03498000
*                                                                  0986 03499000
*               CALL MODID1CK(ICTMOD(1));                          0986 03500000
         ST    @07,@AL00001                                        0986 03501000
         LA    @01,@AL00001                                        0986 03502000
         BAL   @14,MODID1CK                                        0986 03503000
*               RFY                                                0987 03504000
*                 RTNCODE RSTD;                                    0987 03505000
*               MODI1PRC=MAX(MODI1PRC,RTNCODE);/* SAVE RC            */ 03506000
         CR    MODI1PRC,RTNCODE                                    0988 03507000
         BNL   *+6                                                      03508000
         LR    MODI1PRC,RTNCODE                                    0988 03509000
*               IF RTNCODE>=STOPSMD THEN/* MOD FAILED?               */ 03510000
         CH    RTNCODE,@CH00034                                    0989 03511000
         BL    @RF00989                                            0989 03512000
*                 DO;               /* YES,                          */ 03513000
*                   ICTMNOGO(1)=ON; /* MOD IS NOGO, ...              */ 03514000
*                   ICTMMSG(1)=ON;  /* ... MESSAGE ISSUED ...        */ 03515000
*                   ICTMCPL(1)=ON;  /* ... AND COMPLETE              */ 03516000
         LR    @14,MODIX2                                          0993 03517000
         SLA   @14,2                                               0993 03518000
         LR    @07,MODIX1                                          0993 03519000
         MH    @07,@CH02662                                        0993 03520000
         L     @02,CCAICPTF(,CCAPTR)                               0993 03521000
         AL    @02,@CF02710                                        0993 03522000
         L     @07,ICTPCHN-64(@07,@02)                             0993 03523000
         AL    @07,@CF02711                                        0993 03524000
         L     @14,ICTIXP(@14,@07)                                 0993 03525000
         OI    ICTMNOGO(@14),B'01110000'                           0993 03526000
*                 END;              /*                               */ 03527000
*               RFY                                                0995 03528000
*                 RTNCODE UNRSTD;                                  0995 03529000
@RF00989 DS    0H                                                  0996 03530000
*             END;                                                 0996 03531000
*           ELSE                                                   0997 03532000
*             ;                     /* SKIP THIS MOD ENTRY           */ 03533000
@RF00984 DS    0H                                                  0998 03534000
*         END;                      /* END OF PROCESSING ALL MODS FOR   03535000
*                                      A SYSMOD                      */ 03536000
         AH    MODIX2,@CH00064                                     0998 03537000
@DE00983 LR    @07,MODIX2                                          0998 03538000
         SLA   @07,2                                               0998 03539000
         LR    @02,MODIX1                                          0998 03540000
         MH    @02,@CH02662                                        0998 03541000
         L     @01,CCAICPTF(,CCAPTR)                               0998 03542000
         AL    @01,@CF02710                                        0998 03543000
         L     @02,ICTPCHN-64(@02,@01)                             0998 03544000
         AL    @02,@CF02711                                        0998 03545000
         L     @07,ICTIXP(@07,@02)                                 0998 03546000
         CL    @07,ICTENDNT                                        0998 03547000
         BE    @DC00983                                            0998 03548000
         CH    MODIRC,@CH00033                                     0998 03549000
         BL    @DL00983                                            0998 03550000
@DC00983 DS    0H                                                  0999 03551000
*         IF MODI1PRC=STOPSMD THEN  /* SYSMOD FAILED?                */ 03552000
         CH    MODI1PRC,@CH00034                                   0999 03553000
         BNE   @RF00999                                            0999 03554000
*           DO;                     /* YES,                          */ 03555000
*                                                                  1000 03556000
*             /*******************************************************/ 03557000
*             /*                                                     */ 03558000
*             /* ISSUE MESSAGE(S) FOR FAILING SYSMOD                 */ 03559000
*             /*                                                     */ 03560000
*             /*******************************************************/ 03561000
*                                                                  1001 03562000
*             CALL FAILSMD(ICTPTF(MODIX1));                        1001 03563000
         LR    @07,MODIX1                                          1001 03564000
         MH    @07,@CH02662                                        1001 03565000
         L     @04,CCAICPTF(,CCAPTR)                               1001 03566000
         AL    @04,@CF02694                                        1001 03567000
         LA    @07,ICTPTF(@07,@04)                                 1001 03568000
         ST    @07,@AL00001                                        1001 03569000
         LA    @01,@AL00001                                        1001 03570000
         BAL   @14,FAILSMD                                         1001 03571000
*             RFY                                                  1002 03572000
*               RTNCODE RSTD;                                      1002 03573000
*             MODI1PRC=MAX(MODI1PRC,RTNCODE);/* SAVE RC              */ 03574000
         CR    MODI1PRC,RTNCODE                                    1003 03575000
         BNL   *+6                                                      03576000
         LR    MODI1PRC,RTNCODE                                    1003 03577000
*             RFY                                                  1004 03578000
*               RTNCODE UNRSTD;                                    1004 03579000
*           END;                                                   1005 03580000
*         ELSE                                                     1006 03581000
*           ;                       /* SYSMOD DID NOT FAIL           */ 03582000
@RF00999 DS    0H                                                  1007 03583000
*         MODIRC=MAX(MODIRC,MODI1PRC);/* SAVE RC                     */ 03584000
         CR    MODIRC,MODI1PRC                                     1007 03585000
         BNL   *+6                                                      03586000
         LR    MODIRC,MODI1PRC                                     1007 03587000
*       END;                                                       1008 03588000
*     ELSE                                                         1009 03589000
*       ;                           /* SYSMOD IS NOGO                */ 03590000
@RF00981 DS    0H                                                  1010 03591000
*   END;                            /* END OF PROCESSING ALL SYSMOD     03592000
*                                      ENTRIES                       */ 03593000
         AH    MODIX1,@CH00064                                     1010 03594000
@DE00979 LR    @04,MODIX1                                          1010 03595000
         MH    @04,@CH02662                                        1010 03596000
         L     @02,CCAICPTF(,CCAPTR)                               1010 03597000
         AL    @02,@CF02694                                        1010 03598000
         L     @04,ICTPEND(@04,@02)                                1010 03599000
         CL    @04,ICTENDNT                                        1010 03600000
         BE    @DC00979                                            1010 03601000
         CH    MODIRC,@CH00033                                     1010 03602000
         BL    @DL00979                                            1010 03603000
@DC00979 DS    0H                                                  1011 03604000
*   RETURN CODE(MODIRC);            /* RETURN W/RC SET               */ 03605000
         LR    @15,MODIRC                                          1011 03606000
         L     @14,@SA00014                                        1011 03607000
         LM    @00,@12,@SA00014+8                                  1011 03608000
         BR    @14                                                 1011 03609000
*   RFY                                                            1012 03610000
*     ICTIXPF BASED;                                               1012 03611000
*   RFY                                                            1013 03612000
*     ICTPTF BASED;                                                1013 03613000
*   RFY                                                            1014 03614000
*     ICTMOD BASED;                                                1014 03615000
*   RFY                                                            1015 03616000
*     TSLPARMS BASED;                                              1015 03617000
*   RFY                                                            1016 03618000
*     ICTMIDLS BASED;                                              1016 03619000
         EJECT                                                          03620000
*                                                                  1017 03621000
*/********************************************************************/ 03622000
*/*                                                                  */ 03623000
*/* MODID1CK - CHECK MODID'S FOR ON ELEMENT ENTRY                    */ 03624000
*/* ASSUMPTIONS:                                                     */ 03625000
*/*                                                                  */ 03626000
*/*    1. IF AN FMID IS PRESENT, AN RMID IS ALSO PRESENT.            */ 03627000
*/*                                                                  */ 03628000
*/*    2. IF AN RMID IS PRESENT THEN AN FMID IS PRESENT UNLESS THE   */ 03629000
*/*       RMID IS THE RESULT OF AN ASSEMBLY.                         */ 03630000
*/*                                                                  */ 03631000
*/*    3. IF A UMID IS PRESENT THEN BOTH AN FMID AND AN RMID IS      */ 03632000
*/*       PRESENT.                                                   */ 03633000
*/*                                                                  */ 03634000
*/*    4. THAT A SYSMOD THAT APPEARS IN THE UMID LIST IS NOT ALSO    */ 03635000
*/*       THE FMID OR RMID.                                          */ 03636000
*/*                                                                  */ 03637000
*/********************************************************************/ 03638000
*                                                                  1017 03639000
*MODID1CK:                                                         1017 03640000
*   PROC(MOD1ENT);                  /* ICT MOD ENTRY TO BE CHECKED   */ 03641000
MODID1CK STM   @14,@12,@SA00015                                    1017 03642000
         MVC   @PC00015(4),0(@01)                                  1017 03643000
*   DCL                                                            1018 03644000
*     MOD1ENT CHAR(*);              /* (INPUT/OUTPUT) ICT MOD ENTRY  */ 03645000
*   DCL                                                            1019 03646000
*     MOD1RC FIXED(15);             /* LOCAL RETURN CODE             */ 03647000
*   DCL                                                            1020 03648000
*     1 MOD1FLGS,                   /* LOCAL CONTROL FLAGS           */ 03649000
*      2 * BIT(8),                                                 1020 03650000
*       3 MOD1DONE BIT(1),          /* ALL MODID CHECKING COMPLETED  */ 03651000
*       3 MOD1ERR BIT(1),           /* ONE OR MORE MODID ERRORS FOUND   03652000
*                                      FOR THIS ELEMENT              */ 03653000
*       3 M1HEADER BIT(1),          /* ELEMENT HEADER MESSAGE ISSUED */ 03654000
*       3 * BIT(1),                 /* UNUSED                        */ 03655000
*       3 MOD1FNDA BIT(1),          /* CDS MODID ALSO IN ACDS MODID     03656000
*                                      LIST                          */ 03657000
*       3 MOD1BOTH BIT(1),          /* SYSMOD IN BOTH CDS AND ACDS 1020 03658000
*                                      MODID LISTS                   */ 03659000
*       3 MOD1DEL BIT(1),           /* ELEMENT IS BEING DELETED      */ 03660000
*       3 * BIT(1),                 /* UNUSED                        */ 03661000
*      2 * BIT(8),                                                 1020 03662000
*       3 M1FMIDCK BIT(1),          /* FMID CHECKING TO BE DONE      */ 03663000
*       3 M1RMIDCK BIT(1),          /* RMID CHECKING TO BE DONE      */ 03664000
*       3 M1UMIDCK BIT(1),          /* UMID CHECKING TO BE DONE      */ 03665000
*       3 * BIT(1),                 /* UNUSED                        */ 03666000
*       3 M1CRMRST BIT(1),          /* CDS RMID BE BE RESTORED       */ 03667000
*       3 M1CUMRST BIT(1),          /* CDS UMID BE BE RESTORED       */ 03668000
*       3 * BIT(1),                 /* UNUSED                        */ 03669000
*       3 * BIT(1),                 /* UNUSED                        */ 03670000
*      2 * BIT(8),                                                 1020 03671000
*       3 M1CFMFND BIT(1),          /* CDS FMID FOUND IN LIST        */ 03672000
*       3 M1AFMFND BIT(1),          /* ACDS FMID FOUND IN LIST       */ 03673000
*       3 M1FMIDEQ BIT(1),          /* CDS AND ACDS HAVE SAME FMID   */ 03674000
*       3 * BIT(1),                 /* UNUSED                        */ 03675000
*       3 M1CFMERM BIT(1),          /* CDS FMID AND RMID EQUAL       */ 03676000
*       3 M1AFMERM BIT(1),          /* ACDS FMID AND RMID EQUAL      */ 03677000
*       3 * BIT(1),                 /* UNUSED                        */ 03678000
*       3 * BIT(1),                 /* UNUSED                        */ 03679000
*      2 * BIT(8),                                                 1020 03680000
*       3 M1CRMFND BIT(1),          /* RMID FOUND IN CDS MODID LIST  */ 03681000
*       3 M1ARMFND BIT(1),          /* RMID FOUND IN ACDS MODID LIST */ 03682000
*       3 M1RMIDEQ BIT(1),          /* CDS AND ACDS HAVE SAME RMID   */ 03683000
*       3 * BIT(1),                 /* UNUSED                        */ 03684000
*       3 M1CRMRGR BIT(1),          /* CDS RMID IS REGRESSED         */ 03685000
*       3 M1ARMRGR BIT(1),          /* ACDS RMID IS REGRESSED        */ 03686000
*       3 M1CRMASM BIT(1),          /* CDS RMID IS RESULT OF ASSEMBLY*/ 03687000
*       3 M1ARMASM BIT(1),          /* ACDS RMID IS RESULT OF      1020 03688000
*                                      ASSEMBLY                      */ 03689000
*      2 * BIT(8),                                                 1020 03690000
*       3 M1CUMFND BIT(1),          /* ONE OR MORE UMID'S IN THE CDS    03691000
*                                      MODID LIST                    */ 03692000
*       3 M1AUMFND BIT(1),          /* ONE OR MORE UMID'S IN THE ACDS   03693000
*                                      MODID LIST                    */ 03694000
*       3 M1CUMID BIT(1),           /* ATLEAST ONE CDS UMID EXITS    */ 03695000
*       3 M1AUMID BIT(1),           /* ATLEAST ONE ACDS UMID EXITS   */ 03696000
*       3 * BIT(1),                 /* UNUSED                        */ 03697000
*       3 * BIT(1),                 /* UNUSED                        */ 03698000
*       3 * BIT(1),                 /* UNUSED                        */ 03699000
*       3 * BIT(1),                 /* UNUSED                        */ 03700000
*      2 * BIT(8),                                                 1020 03701000
*       3 * BIT(8);                 /* UNUSED                        */ 03702000
*   DCL                                                            1021 03703000
*     M1CFMID CHAR(LENGTH(ICTMODID))/* CDS ELEMENT FUNCTION OWNER    */ 03704000
*         BASED(MOD1CDF@);                                         1021 03705000
*   DCL                                                            1022 03706000
*     M1AFMID CHAR(LENGTH(ICTMODID))/* ACDS ELEMENT FUNCTION OWNER   */ 03707000
*         BASED(MOD1ACF@);                                         1022 03708000
*   DCL                                                            1023 03709000
*     M1CRMID CHAR(LENGTH(ICTMODID))/* CDS ELEMENT RPLACEMENT OWNER  */ 03710000
*         BASED(MOD1CDR@);                                         1023 03711000
*   DCL                                                            1024 03712000
*     M1ARMID CHAR(LENGTH(ICTMODID))/* ACDS ELEMENT RPLACEMENT OWNER */ 03713000
*         BASED(MOD1ACR@);                                         1024 03714000
*   DCL                                                            1025 03715000
*     MOD1CDF@ PTR(31);                                            1025 03716000
*   ;                               /* FMID FROM CDS MODID LIST      */ 03717000
*   DCL                                                            1027 03718000
*     MOD1ACF@ PTR(31);             /* FMID FROM ACDS MODID LIST     */ 03719000
*   DCL                                                            1028 03720000
*     MOD1CDR@ PTR(31);             /* RMID FROM CDS MODID LIST      */ 03721000
*   DCL                                                            1029 03722000
*     MOD1ACR@ PTR(31);             /* RMID FROM ACDS MODID LIST     */ 03723000
*   DCL                                                            1030 03724000
*     M1TPSANS CHAR(1);             /* ANSWER FROM HMASMTPS AS TO  1030 03725000
*                                      PRE/SUP RELATIONSHIP          */ 03726000
*   RFY                                                            1031 03727000
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1031 03728000
*   RFY                                                            1032 03729000
*     TSLPARMS BASED(TBLXTSLP);                                    1032 03730000
*   RFY                                                            1033 03731000
*     ICTMIDLS BASED(ICTMICHN(1));  /* CDS MODID CHAIN               */ 03732000
         EJECT                                                          03733000
*   MOD1RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 03734000
         SLR   MOD1RC,MOD1RC                                       1034 03735000
*   MOD1FLGS=''B;                   /* CLEAR LOCAL FLAGS             */ 03736000
         XC    MOD1FLGS(6),MOD1FLGS                                1035 03737000
*   MOD1DONE=OFF;                   /* MODID CHECKING NOT YET      1036 03738000
*                                      COMPLETE                      */ 03739000
         NI    MOD1DONE,B'01111111'                                1036 03740000
*                                                                  1037 03741000
*   /*****************************************************************/ 03742000
*   /*                                                               */ 03743000
*   /* SAVE CDS AND ACDS FMID AND RMID                               */ 03744000
*   /*                                                               */ 03745000
*   /*****************************************************************/ 03746000
*                                                                  1037 03747000
*   CALL M1INIT;                    /* INITIALIZATION PROCESSING FOR    03748000
*                                      MODID CHECKING                */ 03749000
*                                                                  1037 03750000
         BAL   @14,M1INIT                                          1037 03751000
*   /*****************************************************************/ 03752000
*   /*                                                               */ 03753000
*   /* PROCESS FMID'S                                                */ 03754000
*   /*                                                               */ 03755000
*   /*****************************************************************/ 03756000
*                                                                  1038 03757000
*   CALL M1FMID;                                                   1038 03758000
         BAL   @14,M1FMID                                          1038 03759000
*   RFY                                                            1039 03760000
*     RTNCODE RSTD;                                                1039 03761000
*   MOD1RC=MAX(MOD1RC,RTNCODE);     /* SAVE RC                       */ 03762000
         CR    MOD1RC,RTNCODE                                      1040 03763000
         BNL   *+6                                                      03764000
         LR    MOD1RC,RTNCODE                                      1040 03765000
*   RFY                                                            1041 03766000
*     RTNCODE UNRSTD;                                              1041 03767000
*                                                                  1041 03768000
*   /*****************************************************************/ 03769000
*   /*                                                               */ 03770000
*   /* PROCESS RMID'S IF REQUIRED                                    */ 03771000
*   /*                                                               */ 03772000
*   /*****************************************************************/ 03773000
*                                                                  1042 03774000
*   IF MOD1DONE=OFF                 /* NOT DONE ...                  */ 03775000
*       &MOD1ERR=OFF THEN           /* AND NO PREVIOUS MODID ERROR?  */ 03776000
         TM    MOD1DONE,B'11000000'                                1042 03777000
         BNZ   @RF01042                                            1042 03778000
*     DO;                           /* YES,                          */ 03779000
*       CALL M1RMID;                /*                               */ 03780000
         BAL   @14,M1RMID                                          1044 03781000
*       RFY                                                        1045 03782000
*         RTNCODE RSTD;                                            1045 03783000
*       MOD1RC=MAX(MOD1RC,RTNCODE); /* SAVE RC                       */ 03784000
         CR    MOD1RC,RTNCODE                                      1046 03785000
         BNL   *+6                                                      03786000
         LR    MOD1RC,RTNCODE                                      1046 03787000
*       RFY                                                        1047 03788000
*         RTNCODE UNRSTD;                                          1047 03789000
*     END;                                                         1048 03790000
*                                                                  1048 03791000
*   /*****************************************************************/ 03792000
*   /*                                                               */ 03793000
*   /* PROCESS UMID'S IF REQUIRED                                    */ 03794000
*   /*                                                               */ 03795000
*   /*****************************************************************/ 03796000
*                                                                  1049 03797000
*   IF MOD1DONE=OFF                 /* NOT DONE ...                  */ 03798000
*       &MOD1ERR=OFF THEN           /* AND NO PREVIOUS MODID ERROR?  */ 03799000
@RF01042 TM    MOD1DONE,B'11000000'                                1049 03800000
         BNZ   @RF01049                                            1049 03801000
*     DO;                           /* YES,                          */ 03802000
*       CALL M1UMID;                /*                               */ 03803000
         BAL   @14,M1UMID                                          1051 03804000
*       RFY                                                        1052 03805000
*         RTNCODE RSTD;                                            1052 03806000
*       MOD1RC=MAX(MOD1RC,RTNCODE); /* SAVE RC                       */ 03807000
         CR    MOD1RC,RTNCODE                                      1053 03808000
         BNL   *+6                                                      03809000
         LR    MOD1RC,RTNCODE                                      1053 03810000
*       RFY                                                        1054 03811000
*         RTNCODE UNRSTD;                                          1054 03812000
*     END;                                                         1055 03813000
*   RETURN CODE(MOD1RC);            /* RETURN W/RC SET               */ 03814000
@RF01049 LR    @15,MOD1RC                                          1056 03815000
         L     @14,@SA00015                                        1056 03816000
         LM    @00,@12,@SA00015+8                                  1056 03817000
         BR    @14                                                 1056 03818000
*   RFY                                                            1057 03819000
*     ICTMOD BASED;                                                1057 03820000
*   RFY                                                            1058 03821000
*     TSLPARMS BASED;                                              1058 03822000
*   RFY                                                            1059 03823000
*     ICTMIDLS BASED;                                              1059 03824000
         EJECT                                                          03825000
*                                                                  1060 03826000
*   /*****************************************************************/ 03827000
*   /*                                                               */ 03828000
*   /* M1INIT -                                                      */ 03829000
*   /*                                                               */ 03830000
*   /*****************************************************************/ 03831000
*                                                                  1060 03832000
*M1INIT:                                                           1060 03833000
*   PROC;                                                          1060 03834000
M1INIT   STM   @14,@12,12(@13)                                     1060 03835000
*   DCL                                                            1061 03836000
*     M1IRC FIXED(15);              /* LOCAL RETURN CODE             */ 03837000
*   DCL                                                            1062 03838000
*     M1IX1 FIXED(31);              /* CDS MOD ID INDEX LIST INDEX 1062 03839000
*                                      COUNTER                       */ 03840000
*   DCL                                                            1063 03841000
*     M1IX2 FIXED(31);              /* ACDS MOD ID INDEX LIST INDEX     03842000
*                                      COUNTER                       */ 03843000
*   DCL                                                            1064 03844000
*     M1ICMID CHAR(LENGTH(ICTMODID))/* CDS MOD ID SYSMOD NAME        */ 03845000
*         BASED(ADDR(ICTMODID(M1IX1)));                            1064 03846000
*   DCL                                                            1065 03847000
*     M1IAMID CHAR(LENGTH(ICTMODID))/* ACDS MOD ID SYSMOD NAME       */ 03848000
*         BASED(ADDR(ICTMODID(M1IX2)));                            1065 03849000
*   RFY                                                            1066 03850000
*     ICTMOD BASED(ADDR(MOD1ENT));  /* CDS MODID CHAIN               */ 03851000
*   RFY                                                            1067 03852000
*     ICTMIDLS BASED(ICTMICHN(1));  /* CDS MODID CHAIN               */ 03853000
*   M1IRC=ZERO;                     /* CLEAR RETURN CODE             */ 03854000
         SLR   M1IRC,M1IRC                                         1068 03855000
*   MOD1FLGS=''B;                   /* CLEAR FLAGS                   */ 03856000
         XC    MOD1FLGS(6),MOD1FLGS                                1069 03857000
*   M1FMIDCK=ON;                    /* ASSUME FMID CHECK REQUIRED    */ 03858000
*   M1RMIDCK=ON;                    /* ASSUME RMID CHECK REQUIRED    */ 03859000
*   M1UMIDCK=ON;                    /* ASSUME UMID CHECK REQUIRED    */ 03860000
         OI    M1FMIDCK,B'11100000'                                1072 03861000
*   IF ICTMIDEL(1)=ON THEN          /* IS THE ELEMENT BEING DELETED? */ 03862000
         L     @05,@PC00015                                        1073 03863000
         TM    ICTMIDEL(@05),B'01000000'                           1073 03864000
         BNO   @RF01073                                            1073 03865000
*     DO;                           /* YES,                          */ 03866000
*       MOD1DEL=ON;                 /* ELEMENT IS BEING DELETED FLAG */ 03867000
         OI    MOD1DEL,B'00000010'                                 1075 03868000
*     END;                          /*                               */ 03869000
*   ELSE                                                           1077 03870000
*     ;                             /* NOT BEING DELETED             */ 03871000
*                                                                  1077 03872000
@RF01073 DS    0H                                                  1078 03873000
*   /*****************************************************************/ 03874000
*   /*                                                               */ 03875000
*   /* FIND THE CDS FMID AND RMID, IF ANY                            */ 03876000
*   /*                                                               */ 03877000
*   /*****************************************************************/ 03878000
*                                                                  1078 03879000
*   DO M1IX1=1 BY 1                 /* SEARCH CDS MODID FOR        1078 03880000
*                                      DIFFERNENT MODID TYPES        */ 03881000
*         WHILE(ICTMIDND(M1IX1)^=ICTENDIX/*                          */ 03882000
*         &MOD1RC<STOPFUNC);                                       1078 03883000
         LA    M1IX1,1                                             1078 03884000
         B     @DE01078                                            1078 03885000
@DL01078 DS    0H                                                  1079 03886000
*     IF ICTMIDTY(M1IX1)=ICTMIDFM THEN/* IS THE TYPE FMID?           */ 03887000
         LR    @05,M1IX1                                           1079 03888000
         SLA   @05,3                                               1079 03889000
         L     @15,@PC00015                                        1079 03890000
         L     @15,ICTMICHN(,@15)                                  1079 03891000
         ST    @05,@TF00001                                        1079 03892000
         ALR   @05,@15                                             1079 03893000
         BCTR  @05,0                                               1079 03894000
         TM    ICTMIDTY-7(@05),B'00000010'                         1079 03895000
         BNO   @RF01079                                            1079 03896000
         TM    ICTMIDTY-7(@05),B'00000001'                         1079 03897000
         BNZ   @RF01079                                            1079 03898000
*       DO;                         /* YES,                          */ 03899000
*         MOD1CDF@=ADDR(M1ICMID);   /* SAVE CDS FMID VALUE           */ 03900000
         L     @05,@TF00001                                        1081 03901000
         AL    @15,@CF02695                                        1081 03902000
         LA    @05,ICTMODID(@05,@15)                               1081 03903000
         ST    @05,MOD1CDF@                                        1081 03904000
*         M1CFMFND=ON;              /* CDS FMID FOUND                */ 03905000
         OI    M1CFMFND,B'10000000'                                1082 03906000
*       END;                                                       1083 03907000
*     ELSE                          /*                               */ 03908000
*       DO;                                                        1084 03909000
         B     @RC01079                                            1084 03910000
@RF01079 DS    0H                                                  1085 03911000
*         IF ICTMIDTY(M1IX1)=ICTMIDRM THEN/* IS THE TYPE RMID?       */ 03912000
         LR    @05,M1IX1                                           1085 03913000
         SLA   @05,3                                               1085 03914000
         L     @15,@PC00015                                        1085 03915000
         L     @15,ICTMICHN(,@15)                                  1085 03916000
         ST    @05,@TF00001                                        1085 03917000
         ALR   @05,@15                                             1085 03918000
         BCTR  @05,0                                               1085 03919000
         TM    ICTMIDTY-7(@05),B'00000001'                         1085 03920000
         BNO   @RF01085                                            1085 03921000
         TM    ICTMIDTY-7(@05),B'00000010'                         1085 03922000
         BNZ   @RF01085                                            1085 03923000
*           DO;                     /* YES,                          */ 03924000
*             MOD1CDR@=ADDR(M1ICMID);/* SAVE CDS RMID VALUE          */ 03925000
         L     @05,@TF00001                                        1087 03926000
         AL    @05,@CF02695                                        1087 03927000
         LA    @05,ICTMODID(@05,@15)                               1087 03928000
         ST    @05,MOD1CDR@                                        1087 03929000
*             M1CRMFND=ON;          /* CDS RMID FOUND                */ 03930000
         OI    M1CRMFND,B'10000000'                                1088 03931000
*             IF ICTMIDAM(M1IX1)=ON THEN/* RMID RESULT OF ASSEMBLY?  */ 03932000
         AL    @15,@TF00001                                        1089 03933000
         BCTR  @15,0                                               1089 03934000
         TM    ICTMIDAM-7(@15),B'00000100'                         1089 03935000
         BNO   @RF01089                                            1089 03936000
*               DO;                 /* YES                           */ 03937000
*                 M1CRMASM=ON;      /* SET INTERNAL CDS RMID ASSEM 1091 03938000
*                                      FLAG                          */ 03939000
         OI    M1CRMASM,B'00000010'                                1091 03940000
*               END;                /*                               */ 03941000
*             IF ICTMIDRG(M1IX1)=ON THEN/* RMID REGRESSED?           */ 03942000
@RF01089 LR    @05,M1IX1                                           1093 03943000
         SLA   @05,3                                               1093 03944000
         L     @15,@PC00015                                        1093 03945000
         L     @01,ICTMICHN(,@15)                                  1093 03946000
         ALR   @01,@05                                             1093 03947000
         BCTR  @01,0                                               1093 03948000
         TM    ICTMIDRG-7(@01),B'00001000'                         1093 03949000
         BNO   @RF01093                                            1093 03950000
*               DO;                 /* YES                           */ 03951000
*                 M1CRMASM=ON;      /* SET INTERNAL CDS RMID       1095 03952000
*                                      REGRESSION FLG                */ 03953000
         OI    M1CRMASM,B'00000010'                                1095 03954000
*               END;                /*                               */ 03955000
*           END;                                                   1097 03956000
*         ELSE                      /* UMID                          */ 03957000
*           DO;                                                    1098 03958000
         B     @RC01085                                            1098 03959000
@RF01085 DS    0H                                                  1099 03960000
*             M1CUMID=ON;           /* ATLEAST ONE CDS UMID EXISTS   */ 03961000
         OI    M1CUMID,B'00100000'                                 1099 03962000
*           END;                                                   1100 03963000
*       END;                                                       1101 03964000
@RC01085 DS    0H                                                  1102 03965000
*   END;                                                           1102 03966000
*                                                                  1102 03967000
@RC01079 AH    M1IX1,@CH00064                                      1102 03968000
@DE01078 LR    @05,M1IX1                                           1102 03969000
         SLA   @05,3                                               1102 03970000
         L     @15,@PC00015                                        1102 03971000
         L     @01,ICTMICHN(,@15)                                  1102 03972000
         AL    @01,@CF02695                                        1102 03973000
         L     @05,ICTMIDND(@05,@01)                               1102 03974000
         CL    @05,ICTENDIX                                        1102 03975000
         BE    @DC01078                                            1102 03976000
         CH    MOD1RC,@CH00033                                     1102 03977000
         BL    @DL01078                                            1102 03978000
@DC01078 DS    0H                                                  1103 03979000
*   /*****************************************************************/ 03980000
*   /*                                                               */ 03981000
*   /* FIND THE ACDS FMID AND RMID, IF ANY                           */ 03982000
*   /*                                                               */ 03983000
*   /*****************************************************************/ 03984000
*                                                                  1103 03985000
*   RFY                                                            1103 03986000
*     ICTMIDLS BASED(ICTMICHA(1));  /* ACDS MODID CHAIN              */ 03987000
*   DO M1IX2=1 BY 1                 /* SEARCH ACDS MODID LIST FOR CDS   03988000
*                                      MODID                         */ 03989000
*         WHILE(ICTMIDND(M1IX2)^=ICTENDIX/*                          */ 03990000
*         &MOD1RC<STOPFUNC);                                       1104 03991000
         LA    M1IX2,1                                             1104 03992000
         B     @DE01104                                            1104 03993000
@DL01104 DS    0H                                                  1105 03994000
*     IF ICTMIDTY(M1IX2)=ICTMIDFM THEN/* IS THE TYPE FMID?           */ 03995000
         LR    @05,M1IX2                                           1105 03996000
         SLA   @05,3                                               1105 03997000
         L     @15,@PC00015                                        1105 03998000
         L     @15,ICTMICHA(,@15)                                  1105 03999000
         ST    @05,@TF00001                                        1105 04000000
         ALR   @05,@15                                             1105 04001000
         BCTR  @05,0                                               1105 04002000
         TM    ICTMIDTY-7(@05),B'00000010'                         1105 04003000
         BNO   @RF01105                                            1105 04004000
         TM    ICTMIDTY-7(@05),B'00000001'                         1105 04005000
         BNZ   @RF01105                                            1105 04006000
*       DO;                         /* YES,                          */ 04007000
*         MOD1ACF@=ADDR(M1IAMID);   /* SAVE ACDS FMID VALUE          */ 04008000
         L     @05,@TF00001                                        1107 04009000
         AL    @15,@CF02695                                        1107 04010000
         LA    @05,ICTMODID(@05,@15)                               1107 04011000
         ST    @05,MOD1ACF@                                        1107 04012000
*         M1AFMFND=ON;              /* ACDS FMID FOUND               */ 04013000
         OI    M1AFMFND,B'01000000'                                1108 04014000
*       END;                                                       1109 04015000
*     ELSE                          /*                               */ 04016000
*       DO;                                                        1110 04017000
         B     @RC01105                                            1110 04018000
@RF01105 DS    0H                                                  1111 04019000
*         IF ICTMIDTY(M1IX2)=ICTMIDRM THEN/* IS THE TYPE RMID?       */ 04020000
         LR    @05,M1IX2                                           1111 04021000
         SLA   @05,3                                               1111 04022000
         L     @15,@PC00015                                        1111 04023000
         L     @15,ICTMICHA(,@15)                                  1111 04024000
         ST    @05,@TF00001                                        1111 04025000
         ALR   @05,@15                                             1111 04026000
         BCTR  @05,0                                               1111 04027000
         TM    ICTMIDTY-7(@05),B'00000001'                         1111 04028000
         BNO   @RF01111                                            1111 04029000
         TM    ICTMIDTY-7(@05),B'00000010'                         1111 04030000
         BNZ   @RF01111                                            1111 04031000
*           DO;                     /* YES,                          */ 04032000
*             MOD1ACR@=ADDR(M1IAMID);/* SAVE ACDS RMID VALUE         */ 04033000
         L     @05,@TF00001                                        1113 04034000
         AL    @05,@CF02695                                        1113 04035000
         LA    @05,ICTMODID(@05,@15)                               1113 04036000
         ST    @05,MOD1ACR@                                        1113 04037000
*             M1ARMFND=ON;          /* ACDS RMID FOUND               */ 04038000
         OI    M1ARMFND,B'01000000'                                1114 04039000
*             IF ICTMIDAM(M1IX2)=ON THEN/* RMID RESULT OF ASSEMBLY?  */ 04040000
         AL    @15,@TF00001                                        1115 04041000
         BCTR  @15,0                                               1115 04042000
         TM    ICTMIDAM-7(@15),B'00000100'                         1115 04043000
         BNO   @RF01115                                            1115 04044000
*               DO;                 /* YES                           */ 04045000
*                 M1ARMASM=ON;      /* SET INTERNAL ACDS RMID ASSEM     04046000
*                                      FLAG                          */ 04047000
         OI    M1ARMASM,B'00000001'                                1117 04048000
*               END;                /*                               */ 04049000
*             IF ICTMIDRG(M1IX2)=ON THEN/* RMID REGRESSED?           */ 04050000
@RF01115 LR    @05,M1IX2                                           1119 04051000
         SLA   @05,3                                               1119 04052000
         L     @15,@PC00015                                        1119 04053000
         L     @01,ICTMICHA(,@15)                                  1119 04054000
         ALR   @01,@05                                             1119 04055000
         BCTR  @01,0                                               1119 04056000
         TM    ICTMIDRG-7(@01),B'00001000'                         1119 04057000
         BNO   @RF01119                                            1119 04058000
*               DO;                 /* YES                           */ 04059000
*                 M1ARMASM=ON;      /* SET INTERNAL ACDS RMID      1121 04060000
*                                      REGRESSION FLG                */ 04061000
         OI    M1ARMASM,B'00000001'                                1121 04062000
*               END;                /*                               */ 04063000
*           END;                                                   1123 04064000
*         ELSE                      /* UMID                          */ 04065000
*           DO;                                                    1124 04066000
         B     @RC01111                                            1124 04067000
@RF01111 DS    0H                                                  1125 04068000
*             M1AUMID=ON;           /* ATLEAST ONE ACDS UMID EXISTS  */ 04069000
         OI    M1AUMID,B'00010000'                                 1125 04070000
*           END;                                                   1126 04071000
*       END;                                                       1127 04072000
@RC01111 DS    0H                                                  1128 04073000
*   END;                                                           1128 04074000
@RC01105 AH    M1IX2,@CH00064                                      1128 04075000
@DE01104 LR    @05,M1IX2                                           1128 04076000
         SLA   @05,3                                               1128 04077000
         L     @15,@PC00015                                        1128 04078000
         L     @01,ICTMICHA(,@15)                                  1128 04079000
         AL    @01,@CF02695                                        1128 04080000
         L     @05,ICTMIDND(@05,@01)                               1128 04081000
         CL    @05,ICTENDIX                                        1128 04082000
         BE    @DC01104                                            1128 04083000
         CH    MOD1RC,@CH00033                                     1128 04084000
         BL    @DL01104                                            1128 04085000
@DC01104 DS    0H                                                  1129 04086000
*   IF M1CFMFND=ON                  /* BOTH CDS AND ACDS FMID FOUND? */ 04087000
*       &M1AFMFND=ON THEN           /*                               */ 04088000
         TM    M1CFMFND,B'11000000'                                1129 04089000
         BNO   @RF01129                                            1129 04090000
*     DO;                           /* YES,                          */ 04091000
*       IF M1CFMID=M1AFMID THEN     /* SAME FMID ON CDS AND ACDS?    */ 04092000
         L     @05,MOD1CDF@                                        1131 04093000
         L     @02,MOD1ACF@                                        1131 04094000
         CLC   M1CFMID(7,@05),M1AFMID(@02)                         1131 04095000
         BNE   @RF01131                                            1131 04096000
*         DO;                       /* YES,                          */ 04097000
*           M1FMIDEQ=ON;            /* CDS AND ACDS HAVE SAME FMID   */ 04098000
         OI    M1FMIDEQ,B'00100000'                                1133 04099000
*         END;                      /*                               */ 04100000
*       ELSE                                                       1135 04101000
*         ;                         /*                               */ 04102000
@RF01131 DS    0H                                                  1136 04103000
*     END;                          /*                               */ 04104000
*   ELSE                            /* EITHER CDS OR ACDS OR BOTH ARE   04105000
*                                      NOT PRESENT                   */ 04106000
*     DO;                                                          1137 04107000
         B     @RC01129                                            1137 04108000
@RF01129 DS    0H                                                  1138 04109000
*       IF M1CFMFND=OFF             /* NIETHER FMID?                 */ 04110000
*           &M1AFMFND=OFF THEN      /*                               */ 04111000
         TM    M1CFMFND,B'11000000'                                1138 04112000
         BNZ   @RF01138                                            1138 04113000
*         DO;                       /* YES,                          */ 04114000
*           M1FMIDCK=OFF;           /* NO FMID CHECKING IS NEEDED    */ 04115000
         NI    M1FMIDCK,B'01111111'                                1140 04116000
*           M1FMIDEQ=ON;            /* TREAT NULLS AS EQUAL          */ 04117000
         OI    M1FMIDEQ,B'00100000'                                1141 04118000
*         END;                                                     1142 04119000
*     END;                                                         1143 04120000
@RF01138 DS    0H                                                  1144 04121000
*   IF M1CRMFND=ON                  /* BOTH CDS AND ACDS RMID FOUND? */ 04122000
*       &M1ARMFND=ON THEN           /*                               */ 04123000
@RC01129 TM    M1CRMFND,B'11000000'                                1144 04124000
         BNO   @RF01144                                            1144 04125000
*     DO;                           /* YES,                          */ 04126000
*       IF M1CRMID=M1ARMID THEN     /* SAME RMID ON CDS AND ACDS?    */ 04127000
         L     @05,MOD1CDR@                                        1146 04128000
         L     @02,MOD1ACR@                                        1146 04129000
         CLC   M1CRMID(7,@05),M1ARMID(@02)                         1146 04130000
         BNE   @RF01146                                            1146 04131000
*         DO;                       /* YES,                          */ 04132000
*           M1RMIDEQ=ON;            /* CDS AND ACDS HAVE SAME RMID   */ 04133000
         OI    M1RMIDEQ,B'00100000'                                1148 04134000
*         END;                      /*                               */ 04135000
*       ELSE                                                       1150 04136000
*         ;                         /*                               */ 04137000
@RF01146 DS    0H                                                  1151 04138000
*     END;                          /*                               */ 04139000
*   ELSE                            /* EITHER CDS OR ACDS OR BOTH ARE   04140000
*                                      NOT PRESENT                   */ 04141000
*     DO;                                                          1152 04142000
         B     @RC01144                                            1152 04143000
@RF01144 DS    0H                                                  1153 04144000
*       IF M1CRMFND=OFF             /* NIETHER RMID?                 */ 04145000
*           &M1ARMFND=OFF THEN      /*                               */ 04146000
         TM    M1CRMFND,B'11000000'                                1153 04147000
         BNZ   @RF01153                                            1153 04148000
*         DO;                       /* YES,                          */ 04149000
*           M1RMIDEQ=ON;            /* TREAT NULLS AS EQUAL          */ 04150000
         OI    M1RMIDEQ,B'00100000'                                1155 04151000
*         END;                                                     1156 04152000
*     END;                                                         1157 04153000
@RF01153 DS    0H                                                  1158 04154000
*   IF M1CFMFND=ON                  /* BOTH CDS FMID AND RMID FOUND? */ 04155000
*       &M1CRMFND=ON THEN           /*                               */ 04156000
@RC01144 TM    M1CFMFND,B'10000000'                                1158 04157000
         BNO   @RF01158                                            1158 04158000
         TM    M1CRMFND,B'10000000'                                1158 04159000
         BNO   @RF01158                                            1158 04160000
*     DO;                           /* YES,                          */ 04161000
*       IF M1CFMID=M1CRMID THEN     /* CDS FMID EQUAL RMID?          */ 04162000
         L     @05,MOD1CDF@                                        1160 04163000
         L     @02,MOD1CDR@                                        1160 04164000
         CLC   M1CFMID(7,@05),M1CRMID(@02)                         1160 04165000
         BNE   @RF01160                                            1160 04166000
*         DO;                       /* YES,                          */ 04167000
*           M1CFMERM=ON;            /* CDS FMID EQUAL RMID           */ 04168000
         OI    M1CFMERM,B'00001000'                                1162 04169000
*         END;                                                     1163 04170000
*     END;                          /*                               */ 04171000
*   ELSE                                                           1165 04172000
*     ;                             /*                               */ 04173000
@RF01158 DS    0H                                                  1166 04174000
*   IF M1AFMFND=ON                  /* BOTH ACDS FMID AND RMID FOUND?*/ 04175000
*       &M1ARMFND=ON THEN           /*                               */ 04176000
@RC01158 TM    M1AFMFND,B'01000000'                                1166 04177000
         BNO   @RF01166                                            1166 04178000
         TM    M1ARMFND,B'01000000'                                1166 04179000
         BNO   @RF01166                                            1166 04180000
*     DO;                           /* YES,                          */ 04181000
*       IF M1AFMID=M1ARMID THEN     /* ACDS FMID EQUAL RMID?         */ 04182000
         L     @05,MOD1ACF@                                        1168 04183000
         L     @02,MOD1ACR@                                        1168 04184000
         CLC   M1AFMID(7,@05),M1ARMID(@02)                         1168 04185000
         BNE   @RF01168                                            1168 04186000
*         DO;                       /* YES,                          */ 04187000
*           M1AFMERM=ON;            /* ACDS FMID EQUAL RMID          */ 04188000
         OI    M1AFMERM,B'00000100'                                1170 04189000
*         END;                                                     1171 04190000
*     END;                          /*                               */ 04191000
*   ELSE                                                           1173 04192000
*     ;                             /*                               */ 04193000
@RF01166 DS    0H                                                  1174 04194000
*   RFY                                                            1174 04195000
*     ICTMIDLS BASED;                                              1174 04196000
@RC01166 DS    0H                                                  1175 04197000
*   RETURN CODE(M1IRC);                                            1175 04198000
         LR    @15,M1IRC                                           1175 04199000
         L     @14,12(,@13)                                        1175 04200000
         LM    @00,@12,20(@13)                                     1175 04201000
         BR    @14                                                 1175 04202000
*   END M1INIT;                     /*                               */ 04203000
         EJECT                                                          04204000
*                                                                  1177 04205000
*   /*****************************************************************/ 04206000
*   /*                                                               */ 04207000
*   /* M1FMID -                                                      */ 04208000
*   /*                                                               */ 04209000
*   /*****************************************************************/ 04210000
*                                                                  1177 04211000
*M1FMID:                                                           1177 04212000
*   PROC;                                                          1177 04213000
M1FMID   STM   @14,@12,@SA00017                                    1177 04214000
*   DCL                                                            1178 04215000
*     M1FRC FIXED(15);              /* LOCAL RETURN CODE             */ 04216000
*   DCL                                                            1179 04217000
*     M1FAANS CHAR(1);              /* ANSWER FOR ACDS MODID LIST  1179 04218000
*                                      ENTRY                         */ 04219000
*   DCL                                                            1180 04220000
*     M1FAPART FIXED(31);           /* MESSAGE PART FOR ACDS MODID 1180 04221000
*                                      LIST ENTRY                    */ 04222000
*   DCL                                                            1181 04223000
*     M1FCANS CHAR(1);              /* ANSWER FOR CDS MODID LIST   1181 04224000
*                                      ENTRY                         */ 04225000
*   DCL                                                            1182 04226000
*     M1FCPART FIXED(31);           /* MESSAGE PART FOR CDS MODID  1182 04227000
*                                      LIST ENTRY                    */ 04228000
*   DCL                                                            1183 04229000
*     M1FCICT@ PTR(31);             /* CDS FMID ICT SYSMOD ENTRY PTR    04230000
*                                      IF BEING RESTORED             */ 04231000
*   M1FRC=ZERO;                     /* CLEAR RETURN CODE             */ 04232000
         SLR   M1FRC,M1FRC                                         1184 04233000
*                                                                  1185 04234000
*   /*****************************************************************/ 04235000
*   /*                                                               */ 04236000
*   /* DETERMINE STATUS OF CDS FMID                                  */ 04237000
*   /*                                                               */ 04238000
*   /*****************************************************************/ 04239000
*                                                                  1185 04240000
*   IF M1CFMFND=ON THEN             /* CDS FMID                      */ 04241000
         TM    M1CFMFND,B'10000000'                                1185 04242000
         BNO   @RF01185                                            1185 04243000
*     DO;                           /* YES,                          */ 04244000
*       CALL M1CDS(M1CFMID,         /* FMID NAME                     */ 04245000
*           M1FCANS,M1FCPART,       /* ANSWER                        */ 04246000
*           M1FCICT@);              /* ICT SYSMOD PTR IF BEING     1187 04247000
*                                      RESOTRED                      */ 04248000
         MVC   @AL00001+4(12),@AL01187                             1187 04249000
         L     @02,MOD1CDF@                                        1187 04250000
         ST    @02,@AL00001                                        1187 04251000
         LA    @01,@AL00001                                        1187 04252000
         BAL   @14,M1CDS                                           1187 04253000
*       RFY                                                        1188 04254000
*         RTNCODE RSTD;                                            1188 04255000
*       M1FRC=MAX(M1FRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 04256000
         CR    M1FRC,RTNCODE                                       1189 04257000
         BNL   *+6                                                      04258000
         LR    M1FRC,RTNCODE                                       1189 04259000
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */ 04260000
*           &M1FCANS=NO THEN        /* AND FMID IS BAD?              */ 04261000
         LTR   RTNCODE,RTNCODE                                     1190 04262000
         BNZ   @RF01190                                            1190 04263000
         CLI   M1FCANS,C'N'                                        1190 04264000
         BNE   @RF01190                                            1190 04265000
*         DO;                                                      1191 04266000
*           RFY                                                    1192 04267000
*             RTNCODE UNRSTD;                                      1192 04268000
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR    04269000
*                                      ELEMENT                       */ 04270000
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */ 04271000
         OI    MOD1DONE,B'11000000'                                1194 04272000
*           CALL M1MSG(TXTFMID,     /* 'FMID'                        */ 04273000
*               M1FCPART,           /* PART NUMBER                   */ 04274000
*               M1CFMID,            /* FMID NAME                     */ 04275000
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */ 04276000
         LA    @02,@CC02060                                        1195 04277000
         ST    @02,@AL00001                                        1195 04278000
         LA    @02,M1FCPART                                        1195 04279000
         ST    @02,@AL00001+4                                      1195 04280000
         L     @02,MOD1CDF@                                        1195 04281000
         ST    @02,@AL00001+8                                      1195 04282000
         L     @02,CCADSAD(,CCAPTR)                                1195 04283000
         LA    @02,CCADSIDA+8(,@02)                                1195 04284000
         ST    @02,@AL00001+12                                     1195 04285000
         LA    @01,@AL00001                                        1195 04286000
         BAL   @14,M1MSG                                           1195 04287000
*           RFY                                                    1196 04288000
*             RTNCODE RSTD;                                        1196 04289000
*           M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC                  */ 04290000
         CR    M1FRC,RTNCODE                                       1197 04291000
         BNL   *+6                                                      04292000
         LR    M1FRC,RTNCODE                                       1197 04293000
*           RFY                                                    1198 04294000
*             RTNCODE UNRSTD;                                      1198 04295000
*         END;                                                     1199 04296000
*     END;                                                         1200 04297000
*                                                                  1200 04298000
@RF01190 DS    0H                                                  1201 04299000
*   /*****************************************************************/ 04300000
*   /*                                                               */ 04301000
*   /* DETERMINE STATUS OF ACDS FMID                                 */ 04302000
*   /*                                                               */ 04303000
*   /*****************************************************************/ 04304000
*                                                                  1201 04305000
*   IF M1AFMFND=ON THEN             /* AND ACDS FMID?                */ 04306000
@RF01185 TM    M1AFMFND,B'01000000'                                1201 04307000
         BNO   @RF01201                                            1201 04308000
*     DO;                           /* YES,                          */ 04309000
*       CALL M1ACDS(M1AFMID,        /* FMID NAME                     */ 04310000
*           M1FAANS,M1FAPART);      /* ANSWER                        */ 04311000
         MVC   @AL00001+4(8),@AL01203                              1203 04312000
         L     @02,MOD1ACF@                                        1203 04313000
         ST    @02,@AL00001                                        1203 04314000
         LA    @01,@AL00001                                        1203 04315000
         BAL   @14,M1ACDS                                          1203 04316000
*       RFY                                                        1204 04317000
*         RTNCODE RSTD;                                            1204 04318000
*       M1FRC=MAX(M1FRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 04319000
         CR    M1FRC,RTNCODE                                       1205 04320000
         BNL   *+6                                                      04321000
         LR    M1FRC,RTNCODE                                       1205 04322000
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */ 04323000
*           &M1FAANS=NO THEN        /* AND FMID IS BAD?              */ 04324000
         LTR   RTNCODE,RTNCODE                                     1206 04325000
         BNZ   @RF01206                                            1206 04326000
         CLI   M1FAANS,C'N'                                        1206 04327000
         BNE   @RF01206                                            1206 04328000
*         DO;                                                      1207 04329000
*           RFY                                                    1208 04330000
*             RTNCODE UNRSTD;                                      1208 04331000
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR    04332000
*                                      ELEMENT                       */ 04333000
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */ 04334000
         OI    MOD1DONE,B'11000000'                                1210 04335000
*           CALL M1MSG(TXTFMID,     /* 'FMID'                        */ 04336000
*               M1FAPART,           /* PART NUMBER                   */ 04337000
*               M1AFMID,            /* FMID NAME                     */ 04338000
*               CCADSIDA(IOPACDS)); /* 'SMPACDS'                     */ 04339000
         LA    @02,@CC02060                                        1211 04340000
         ST    @02,@AL00001                                        1211 04341000
         LA    @02,M1FAPART                                        1211 04342000
         ST    @02,@AL00001+4                                      1211 04343000
         L     @02,MOD1ACF@                                        1211 04344000
         ST    @02,@AL00001+8                                      1211 04345000
         L     @02,CCADSAD(,CCAPTR)                                1211 04346000
         LA    @02,CCADSIDA+88(,@02)                               1211 04347000
         ST    @02,@AL00001+12                                     1211 04348000
         LA    @01,@AL00001                                        1211 04349000
         BAL   @14,M1MSG                                           1211 04350000
*           RFY                                                    1212 04351000
*             RTNCODE RSTD;                                        1212 04352000
*           M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC                  */ 04353000
         CR    M1FRC,RTNCODE                                       1213 04354000
         BNL   *+6                                                      04355000
         LR    M1FRC,RTNCODE                                       1213 04356000
*           RFY                                                    1214 04357000
*             RTNCODE UNRSTD;                                      1214 04358000
*         END;                                                     1215 04359000
*     END;                                                         1216 04360000
@RF01206 DS    0H                                                  1217 04361000
*   IF M1FRC<STOPSMD                /* RC OK ...                     */ 04362000
*       &MOD1DONE=OFF THEN          /* AND NOT DONE?                 */ 04363000
@RF01201 CH    M1FRC,@CH00034                                      1217 04364000
         BNL   @RF01217                                            1217 04365000
         TM    MOD1DONE,B'10000000'                                1217 04366000
         BNZ   @RF01217                                            1217 04367000
*     DO;                           /* YES,                          */ 04368000
*                                                                  1218 04369000
*       /*************************************************************/ 04370000
*       /*                                                           */ 04371000
*       /* NEITHER CDS NOR ACDS FMID IS PRESENT                      */ 04372000
*       /*                                                           */ 04373000
*       /*************************************************************/ 04374000
*                                                                  1219 04375000
*       IF(M1CFMFND=OFF             /* NEITHER ACDS NOR CDS FMID?    */ 04376000
*           &M1AFMFND=OFF) THEN     /* ...                           */ 04377000
         TM    M1CFMFND,B'11000000'                                1219 04378000
         BNZ   @RF01219                                            1219 04379000
*         DO;                       /* YES, ASSUME THAT FMID'S ARE 1220 04380000
*                                      EQUAL AND OK BUT THAT RMID AND   04381000
*                                      UMID CHECKING IS STILL      1220 04382000
*                                      REQUIRED                      */ 04383000
*           MOD1DONE=OFF;           /* CONTINUE CHECKING             */ 04384000
         NI    MOD1DONE,B'01111111'                                1221 04385000
*         END;                                                     1222 04386000
*                                                                  1222 04387000
*       /*************************************************************/ 04388000
*       /*                                                           */ 04389000
*       /* CDS AND ACDS FMID ARE PRESENT                             */ 04390000
*       /*                                                           */ 04391000
*       /*************************************************************/ 04392000
*                                                                  1223 04393000
*       IF(M1CFMFND=ON              /* CDS FMID                      */ 04394000
*           &M1AFMFND=ON) THEN      /* AND ACDS FMID?                */ 04395000
@RF01219 TM    M1CFMFND,B'11000000'                                1223 04396000
         BNO   @RF01223                                            1223 04397000
*         DO;                       /* YES,                          */ 04398000
*           IF M1CFMID^=            /* ARE THE FMID'S DIFFERENT?     */ 04399000
*               M1AFMID THEN                                       1225 04400000
         L     @02,MOD1CDF@                                        1225 04401000
         L     @01,MOD1ACF@                                        1225 04402000
         CLC   M1CFMID(7,@02),M1AFMID(@01)                         1225 04403000
         BE    @RF01225                                            1225 04404000
*             DO;                   /* YES,                          */ 04405000
*               IF M1FCANS=RESTORE THEN/* CDS FMID BEING RESTORED?   */ 04406000
         CLI   M1FCANS,C'R'                                        1227 04407000
         BNE   @RF01227                                            1227 04408000
*                 DO;               /* YES,                          */ 04409000
*                   M1CRMRST=ON;    /* MUST ALSO BE RESTORING RMID   */ 04410000
*                   M1CUMRST=ON;    /* ... AND UMID'S                */ 04411000
         OI    M1CRMRST,B'00001100'                                1230 04412000
*                 END;                                             1231 04413000
*               ELSE                /* CDS FMID NOT BEING RESTORE AND   04414000
*                                      NOT EQUAL ACDS FMID           */ 04415000
*                 DO;                                              1232 04416000
         B     @RC01227                                            1232 04417000
@RF01227 DS    0H                                                  1233 04418000
*                   CALL VRSCHECK(M1CFMID,ICTMOD(1),M1FCANS);      1233 04419000
         L     @02,MOD1CDF@                                        1233 04420000
         ST    @02,@AL00001                                        1233 04421000
         L     @02,@PC00015                                        1233 04422000
         ST    @02,@AL00001+4                                      1233 04423000
         LA    @02,M1FCANS                                         1233 04424000
         ST    @02,@AL00001+8                                      1233 04425000
         LA    @01,@AL00001                                        1233 04426000
         BAL   @14,VRSCHECK                                        1233 04427000
*                   IF M1FCANS=NO THEN/* NOT THE RESULT OF         1234 04428000
*                                      VERSIONING?                   */ 04429000
         CLI   M1FCANS,C'N'                                        1234 04430000
         BNE   @RF01234                                            1234 04431000
*                     DO;           /* YES, ISSUE ERROR MESSAGE      */ 04432000
*                       CALL M1MSG(TXTFMID,/* 'FMID'                 */ 04433000
*                           PART127,/* PART NUMBER                   */ 04434000
*                           M1CFMID,/* FMID NAME                     */ 04435000
*                           CCADSIDA(IOPCDS));/* 'SMPCDS'            */ 04436000
         LA    @02,@CC02060                                        1236 04437000
         ST    @02,@AL00001                                        1236 04438000
         LA    @02,@CF02054                                        1236 04439000
         ST    @02,@AL00001+4                                      1236 04440000
         L     @02,MOD1CDF@                                        1236 04441000
         ST    @02,@AL00001+8                                      1236 04442000
         L     @02,CCADSAD(,CCAPTR)                                1236 04443000
         LA    @02,CCADSIDA+8(,@02)                                1236 04444000
         ST    @02,@AL00001+12                                     1236 04445000
         LA    @01,@AL00001                                        1236 04446000
         BAL   @14,M1MSG                                           1236 04447000
*                       RFY                                        1237 04448000
*                         RTNCODE RSTD;                            1237 04449000
*                       M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC      */ 04450000
         CR    M1FRC,RTNCODE                                       1238 04451000
         BNL   *+6                                                      04452000
         LR    M1FRC,RTNCODE                                       1238 04453000
*                       RFY                                        1239 04454000
*                         RTNCODE UNRSTD;                          1239 04455000
*                     END;          /*                               */ 04456000
*                   ELSE                                           1241 04457000
*                     ;             /* MODID NOT FOUND BECAUSE OF  1241 04458000
*                                      VERSIONING                    */ 04459000
@RF01234 DS    0H                                                  1242 04460000
*                 END;              /*                               */ 04461000
*             END;                                                 1243 04462000
*           ELSE                    /* FMID FOR CDS EQUALS THAT FOR     04463000
*                                      ACDS                          */ 04464000
*             DO;                                                  1244 04465000
         B     @RC01225                                            1244 04466000
@RF01225 DS    0H                                                  1245 04467000
*               MOD1DONE=OFF;       /* MODID CHECKING IS NOT DONE  1245 04468000
*                                      SINCE BOTH CDS AND ACDS     1245 04469000
*                                      REPRESENT THE SAME SERVICE  1245 04470000
*                                      CHAIN                         */ 04471000
         NI    MOD1DONE,B'01111111'                                1245 04472000
*             END;                                                 1246 04473000
*         END;                                                     1247 04474000
*                                                                  1247 04475000
@RC01225 DS    0H                                                  1248 04476000
*       /*************************************************************/ 04477000
*       /*                                                           */ 04478000
*       /* ACDS FMID, BUT NOT CDS FMID, IS PRESENT. THIS IS AN ERROR */ 04479000
*       /* AND A MESSAGE IS ISSUED                                   */ 04480000
*       /*                                                           */ 04481000
*       /*************************************************************/ 04482000
*                                                                  1248 04483000
*       IF(M1CFMFND=OFF             /* CDS FMID NOT PRESENT          */ 04484000
*           &M1AFMFND=ON) THEN      /* AND ACDS FMID PRESENT?        */ 04485000
@RF01223 TM    M1AFMFND,B'01000000'                                1248 04486000
         BNO   @RF01248                                            1248 04487000
         TM    M1CFMFND,B'10000000'                                1248 04488000
         BNZ   @RF01248                                            1248 04489000
*         DO;                       /* YES,                          */ 04490000
*           MOD1ERR=ON;             /* MODID ERROR SINCE FMID IS   1250 04491000
*                                      ACCEPTED BUT NOT APPLIED      */ 04492000
*           MOD1DONE=ON;            /* NO FURTHER CHECKING SINCE   1251 04493000
*                                      FMID'S CAUSING ERROR REPRESENT   04494000
*                                      DIFFERENT SERVICE CHAINS      */ 04495000
         OI    MOD1ERR,B'11000000'                                 1251 04496000
*           CALL M1MSG(TXTFMID,     /* 'FMID'                        */ 04497000
*               PART129,            /* PART NUMBER                   */ 04498000
*               M1AFMID,            /* FMID NAME                     */ 04499000
*               CCADSIDA(IOPACDS)); /* 'SMPACDS'                     */ 04500000
         LA    @02,@CC02060                                        1252 04501000
         ST    @02,@AL00001                                        1252 04502000
         LA    @02,@CF02058                                        1252 04503000
         ST    @02,@AL00001+4                                      1252 04504000
         L     @02,MOD1ACF@                                        1252 04505000
         ST    @02,@AL00001+8                                      1252 04506000
         L     @02,CCADSAD(,CCAPTR)                                1252 04507000
         LA    @02,CCADSIDA+88(,@02)                               1252 04508000
         ST    @02,@AL00001+12                                     1252 04509000
         LA    @01,@AL00001                                        1252 04510000
         BAL   @14,M1MSG                                           1252 04511000
*           RFY                                                    1253 04512000
*             RTNCODE RSTD;                                        1253 04513000
*           M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC                  */ 04514000
         CR    M1FRC,RTNCODE                                       1254 04515000
         BNL   *+6                                                      04516000
         LR    M1FRC,RTNCODE                                       1254 04517000
*           RFY                                                    1255 04518000
*             RTNCODE UNRSTD;                                      1255 04519000
*         END;                                                     1256 04520000
*                                                                  1256 04521000
*       /*************************************************************/ 04522000
*       /*                                                           */ 04523000
*       /* CDS FMID, BUT NOT ACDS FMID, IS PRESENT                   */ 04524000
*       /*                                                           */ 04525000
*       /*************************************************************/ 04526000
*                                                                  1257 04527000
*       IF(M1CFMFND=ON              /* CDS FMID PRESENT              */ 04528000
*           &M1AFMFND=OFF) THEN     /* AND ACDS FMID NOT PRESENT?    */ 04529000
@RF01248 TM    M1CFMFND,B'10000000'                                1257 04530000
         BNO   @RF01257                                            1257 04531000
         TM    M1AFMFND,B'01000000'                                1257 04532000
         BNZ   @RF01257                                            1257 04533000
*         DO;                       /* YES,                          */ 04534000
*           M1CRMRST=ON;            /* MUST BE RESTORING RMID AND ...*/ 04535000
*           M1CUMRST=ON;            /* ... AND UMID'S                */ 04536000
         OI    M1CRMRST,B'00001100'                                1260 04537000
*           IF M1FCANS^=RESTORE     /* CDS FMID NOT BEING RESTORED...*/ 04538000
*               &M1CRMASM=OFF THEN  /* ... AND NOT THE RESULT OF AN     04539000
*                                      ASSEM?                        */ 04540000
         CLI   M1FCANS,C'R'                                        1261 04541000
         BE    @RF01261                                            1261 04542000
         TM    M1CRMASM,B'00000010'                                1261 04543000
         BNZ   @RF01261                                            1261 04544000
*             DO;                   /* YES,                          */ 04545000
*               MOD1ERR=ON;         /* ERROR SINCE CDS FMID IS NOT 1263 04546000
*                                      BEING RESTORED                */ 04547000
         OI    MOD1ERR,B'01000000'                                 1263 04548000
*               IF MOD1DEL=ON THEN  /* IS MOD BEING DELETED?         */ 04549000
         TM    MOD1DEL,B'00000010'                                 1264 04550000
         BNO   @RF01264                                            1264 04551000
*                 DO;               /*                               */ 04552000
*                   CALL VRSCHECK(M1CFMID,ICTMOD(1),M1FCANS);      1266 04553000
         L     @02,MOD1CDF@                                        1266 04554000
         ST    @02,@AL00001                                        1266 04555000
         L     @02,@PC00015                                        1266 04556000
         ST    @02,@AL00001+4                                      1266 04557000
         LA    @02,M1FCANS                                         1266 04558000
         ST    @02,@AL00001+8                                      1266 04559000
         LA    @01,@AL00001                                        1266 04560000
         BAL   @14,VRSCHECK                                        1266 04561000
*                   IF M1FCANS=YES THEN/* THE RESULT OF VERSIONING?  */ 04562000
         CLI   M1FCANS,C'Y'                                        1267 04563000
         BNE   @RF01267                                            1267 04564000
*                     DO;           /* YES,                          */ 04565000
*                       MOD1ERR=OFF;/* NOT AN ERROR                  */ 04566000
         NI    MOD1ERR,B'10111111'                                 1269 04567000
*                     END;                                         1270 04568000
*                 END;                                             1271 04569000
@RF01267 DS    0H                                                  1272 04570000
*               IF MOD1ERR=ON THEN  /* ERROR?                        */ 04571000
@RF01264 TM    MOD1ERR,B'01000000'                                 1272 04572000
         BNO   @RF01272                                            1272 04573000
*                 DO;               /*                               */ 04574000
*                   MOD1DONE=ON;    /* NO FURTHER CHECKING           */ 04575000
         OI    MOD1DONE,B'10000000'                                1274 04576000
*                   CALL M1MSG(TXTFMID,/* 'FMID'                     */ 04577000
*                       PART127,    /* PART NUMBER                   */ 04578000
*                       M1CFMID,    /* FMID NAME                     */ 04579000
*                       CCADSIDA(IOPCDS));/* 'SMPCDS'                */ 04580000
         LA    @02,@CC02060                                        1275 04581000
         ST    @02,@AL00001                                        1275 04582000
         LA    @02,@CF02054                                        1275 04583000
         ST    @02,@AL00001+4                                      1275 04584000
         L     @02,MOD1CDF@                                        1275 04585000
         ST    @02,@AL00001+8                                      1275 04586000
         L     @02,CCADSAD(,CCAPTR)                                1275 04587000
         LA    @02,CCADSIDA+8(,@02)                                1275 04588000
         ST    @02,@AL00001+12                                     1275 04589000
         LA    @01,@AL00001                                        1275 04590000
         BAL   @14,M1MSG                                           1275 04591000
*                   RFY                                            1276 04592000
*                     RTNCODE RSTD;                                1276 04593000
*                   M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC          */ 04594000
         CR    M1FRC,RTNCODE                                       1277 04595000
         BNL   *+6                                                      04596000
         LR    M1FRC,RTNCODE                                       1277 04597000
*                   RFY                                            1278 04598000
*                     RTNCODE UNRSTD;                              1278 04599000
*                 END;                                             1279 04600000
*             END;                                                 1280 04601000
*           ELSE                                                   1281 04602000
*             ;                     /* SYSMOD IS BEING RESTORED      */ 04603000
@RF01261 DS    0H                                                  1282 04604000
*         END;                                                     1282 04605000
@RC01261 DS    0H                                                  1283 04606000
*     END;                                                         1283 04607000
@RF01257 DS    0H                                                  1284 04608000
*   IF M1FRC<STOPSMD                /* NO FAILING ERROR ...          */ 04609000
*       &M1CFMFND=ON THEN           /* ... AND THERE IS A CDS FMID?  */ 04610000
@RF01217 CH    M1FRC,@CH00034                                      1284 04611000
         BNL   @RF01284                                            1284 04612000
         TM    M1CFMFND,B'10000000'                                1284 04613000
         BNO   @RF01284                                            1284 04614000
*     DO;                           /* YES,                          */ 04615000
*       RFY                                                        1286 04616000
*         ICTMOD BASED(ADDR(MOD1ENT));                             1286 04617000
*       CALL M1PRECK(M1FCICT@,      /* CALL PRE CHECK TO SET ACDS ID    04618000
*                                      IS RELATED FLAG               */ 04619000
*           ICTMICHA(1),            /*                               */ 04620000
*           M1FCANS,                /*                               */ 04621000
*           M1FCPART);              /*                               */ 04622000
         MVC   @AL00001(16),@AL01287                               1287 04623000
         L     @02,@PC00015                                        1287 04624000
         LA    @02,ICTMICHA(,@02)                                  1287 04625000
         ST    @02,@AL00001+4                                      1287 04626000
         LA    @01,@AL00001                                        1287 04627000
         BAL   @14,M1PRECK                                         1287 04628000
*       RFY                                                        1288 04629000
*         RTNCODE RSTD;                                            1288 04630000
*       M1FRC=MAX(M1FRC,RTNCODE);   /* SAVE MAX RC                   */ 04631000
         CR    M1FRC,RTNCODE                                       1289 04632000
         BNL   *+6                                                      04633000
         LR    M1FRC,RTNCODE                                       1289 04634000
*       RFY                                                        1290 04635000
*         RTNCODE UNRSTD;                                          1290 04636000
*       RFY                                                        1291 04637000
*         ICTMOD BASED;                                            1291 04638000
*     END;                          /*                               */ 04639000
*   RETURN CODE(M1FRC);             /* RETURN W/ RETURN CODE         */ 04640000
@RF01284 LR    @15,M1FRC                                           1293 04641000
         L     @14,@SA00017                                        1293 04642000
         LM    @00,@12,@SA00017+8                                  1293 04643000
         BR    @14                                                 1293 04644000
*   END M1FMID;                                                    1294 04645000
         EJECT                                                          04646000
*                                                                  1295 04647000
*   /*****************************************************************/ 04648000
*   /*                                                               */ 04649000
*   /* M1RMID -                                                      */ 04650000
*   /*                                                               */ 04651000
*   /*****************************************************************/ 04652000
*                                                                  1295 04653000
*M1RMID:                                                           1295 04654000
*   PROC;                                                          1295 04655000
M1RMID   STM   @14,@12,@SA00018                                    1295 04656000
*   DCL                                                            1296 04657000
*     M1RRC FIXED(15);              /* LOCAL RETURN CODE             */ 04658000
*   DCL                                                            1297 04659000
*     M1RAANS CHAR(1);              /* ANSWER FOR ACDS MODID LIST  1297 04660000
*                                      ENTRY                         */ 04661000
*   DCL                                                            1298 04662000
*     M1RAPART FIXED(31);           /* MESSAGE PART FOR ACDS MODID 1298 04663000
*                                      LIST ENTRY                    */ 04664000
*   DCL                                                            1299 04665000
*     M1RCANS CHAR(1);              /* ANSWER FOR CDS MODID LIST   1299 04666000
*                                      ENTRY                         */ 04667000
*   DCL                                                            1300 04668000
*     M1RCPART FIXED(31);           /* MESSAGE PART FOR CDS MODID  1300 04669000
*                                      LIST ENTRY                    */ 04670000
*   DCL                                                            1301 04671000
*     M1RCICT@ PTR(31);             /* ADDRESS OF ICT SYSMOD ENTRY IF   04672000
*                                      CDS RMID IS BEING RESTORED    */ 04673000
*   RFY                                                            1302 04674000
*     TSLPARMS BASED(TBLXTSLP);                                    1302 04675000
*   RFY                                                            1303 04676000
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1303 04677000
*   M1RRC=ZERO;                     /* CLEAR RETURN CODE             */ 04678000
         SLR   M1RRC,M1RRC                                         1304 04679000
*                                                                  1305 04680000
*   /*****************************************************************/ 04681000
*   /*                                                               */ 04682000
*   /* CHECK THE STATUS OF THE CDS RMID                              */ 04683000
*   /*                                                               */ 04684000
*   /*****************************************************************/ 04685000
*                                                                  1305 04686000
*   IF M1CRMFND=ON THEN             /* CDS RMID?                     */ 04687000
         TM    M1CRMFND,B'10000000'                                1305 04688000
         BNO   @RF01305                                            1305 04689000
*     DO;                           /* YES,                          */ 04690000
*       CALL M1CDS(M1CRMID,         /* RMID NAME                     */ 04691000
*           M1RCANS,M1RCPART,       /* ANSWER                        */ 04692000
*           M1RCICT@);              /* ADDRESS OF SYSMOD IF RETORING */ 04693000
         MVC   @AL00001+4(12),@AL01307                             1307 04694000
         L     @02,MOD1CDR@                                        1307 04695000
         ST    @02,@AL00001                                        1307 04696000
         LA    @01,@AL00001                                        1307 04697000
         BAL   @14,M1CDS                                           1307 04698000
*       RFY                                                        1308 04699000
*         RTNCODE RSTD;                                            1308 04700000
*       M1RRC=MAX(M1RRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 04701000
         CR    M1RRC,RTNCODE                                       1309 04702000
         BNL   *+6                                                      04703000
         LR    M1RRC,RTNCODE                                       1309 04704000
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */ 04705000
*           &M1RCANS=NO THEN        /* AND RMID IS BAD?              */ 04706000
         LTR   RTNCODE,RTNCODE                                     1310 04707000
         BNZ   @RF01310                                            1310 04708000
         CLI   M1RCANS,C'N'                                        1310 04709000
         BNE   @RF01310                                            1310 04710000
*         DO;                                                      1311 04711000
*           RFY                                                    1312 04712000
*             RTNCODE UNRSTD;                                      1312 04713000
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR    04714000
*                                      ELEMENT                       */ 04715000
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */ 04716000
         OI    MOD1DONE,B'11000000'                                1314 04717000
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */ 04718000
*               M1RCPART,           /* PART NUMBER                   */ 04719000
*               M1CRMID,            /* RMID NAME                     */ 04720000
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */ 04721000
         LA    @02,@CC02062                                        1315 04722000
         ST    @02,@AL00001                                        1315 04723000
         LA    @02,M1RCPART                                        1315 04724000
         ST    @02,@AL00001+4                                      1315 04725000
         L     @02,MOD1CDR@                                        1315 04726000
         ST    @02,@AL00001+8                                      1315 04727000
         L     @02,CCADSAD(,CCAPTR)                                1315 04728000
         LA    @02,CCADSIDA+8(,@02)                                1315 04729000
         ST    @02,@AL00001+12                                     1315 04730000
         LA    @01,@AL00001                                        1315 04731000
         BAL   @14,M1MSG                                           1315 04732000
*           RFY                                                    1316 04733000
*             RTNCODE RSTD;                                        1316 04734000
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */ 04735000
         CR    M1RRC,RTNCODE                                       1317 04736000
         BNL   *+6                                                      04737000
         LR    M1RRC,RTNCODE                                       1317 04738000
*           RFY                                                    1318 04739000
*             RTNCODE UNRSTD;                                      1318 04740000
*         END;                                                     1319 04741000
*       IF M1RRC=ZERO               /* ALL IS WELL?                  */ 04742000
*           &M1RCANS=YES            /* AND RMID IS OK AND ^RESTORE   */ 04743000
*           &M1CRMRST=ON            /* ... AND RMID SHOULD BE      1320 04744000
*                                      RESTORED                      */ 04745000
*           &M1CRMASM=OFF THEN      /* ... AND NOT RESULT OF ASSEMBLY*/ 04746000
@RF01310 LTR   M1RRC,M1RRC                                         1320 04747000
         BNZ   @RF01320                                            1320 04748000
         CLI   M1RCANS,C'Y'                                        1320 04749000
         BNE   @RF01320                                            1320 04750000
         TM    M1CRMRST,B'00001000'                                1320 04751000
         BNO   @RF01320                                            1320 04752000
         TM    M1CRMASM,B'00000010'                                1320 04753000
         BNZ   @RF01320                                            1320 04754000
*         DO;                       /* YES,                          */ 04755000
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR    04756000
*                                      ELEMENT                       */ 04757000
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */ 04758000
         OI    MOD1DONE,B'11000000'                                1323 04759000
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */ 04760000
*               PART127,            /* PART NUMBER                   */ 04761000
*               M1CRMID,            /* RMID NAME                     */ 04762000
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */ 04763000
         LA    @02,@CC02062                                        1324 04764000
         ST    @02,@AL00001                                        1324 04765000
         LA    @02,@CF02054                                        1324 04766000
         ST    @02,@AL00001+4                                      1324 04767000
         L     @02,MOD1CDR@                                        1324 04768000
         ST    @02,@AL00001+8                                      1324 04769000
         L     @02,CCADSAD(,CCAPTR)                                1324 04770000
         LA    @02,CCADSIDA+8(,@02)                                1324 04771000
         ST    @02,@AL00001+12                                     1324 04772000
         LA    @01,@AL00001                                        1324 04773000
         BAL   @14,M1MSG                                           1324 04774000
*           RFY                                                    1325 04775000
*             RTNCODE RSTD;                                        1325 04776000
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */ 04777000
         CR    M1RRC,RTNCODE                                       1326 04778000
         BNL   *+6                                                      04779000
         LR    M1RRC,RTNCODE                                       1326 04780000
*           RFY                                                    1327 04781000
*             RTNCODE UNRSTD;                                      1327 04782000
*         END;                                                     1328 04783000
*     END;                                                         1329 04784000
*                                                                  1329 04785000
@RF01320 DS    0H                                                  1330 04786000
*   /*****************************************************************/ 04787000
*   /*                                                               */ 04788000
*   /* CHECK THE STATUS OF THE ACDS RMID                             */ 04789000
*   /*                                                               */ 04790000
*   /*****************************************************************/ 04791000
*                                                                  1330 04792000
*   IF M1ARMFND=ON THEN             /* AND ACDS RMID?                */ 04793000
@RF01305 TM    M1ARMFND,B'01000000'                                1330 04794000
         BNO   @RF01330                                            1330 04795000
*     DO;                           /* YES,                          */ 04796000
*       CALL M1ACDS(M1ARMID,        /* RMID NAME                     */ 04797000
*           M1RAANS,M1RAPART);      /* ANSWER                        */ 04798000
         MVC   @AL00001+4(8),@AL01332                              1332 04799000
         L     @02,MOD1ACR@                                        1332 04800000
         ST    @02,@AL00001                                        1332 04801000
         LA    @01,@AL00001                                        1332 04802000
         BAL   @14,M1ACDS                                          1332 04803000
*       RFY                                                        1333 04804000
*         RTNCODE RSTD;                                            1333 04805000
*       M1RRC=MAX(M1RRC,RTNCODE);   /* SAVE THE RETURN CODE          */ 04806000
         CR    M1RRC,RTNCODE                                       1334 04807000
         BNL   *+6                                                      04808000
         LR    M1RRC,RTNCODE                                       1334 04809000
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */ 04810000
*           &M1RAANS=NO THEN        /* AND RMID IS BAD?              */ 04811000
         LTR   RTNCODE,RTNCODE                                     1335 04812000
         BNZ   @RF01335                                            1335 04813000
         CLI   M1RAANS,C'N'                                        1335 04814000
         BNE   @RF01335                                            1335 04815000
*         DO;                                                      1336 04816000
*           RFY                                                    1337 04817000
*             RTNCODE UNRSTD;                                      1337 04818000
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR    04819000
*                                      ELEMENT                       */ 04820000
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */ 04821000
         OI    MOD1DONE,B'11000000'                                1339 04822000
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */ 04823000
*               M1RAPART,           /* PART NUMBER                   */ 04824000
*               M1ARMID,            /* RMID NAME                     */ 04825000
*               CCADSIDA(IOPACDS)); /* 'SMPACDS'                     */ 04826000
         LA    @02,@CC02062                                        1340 04827000
         ST    @02,@AL00001                                        1340 04828000
         LA    @02,M1RAPART                                        1340 04829000
         ST    @02,@AL00001+4                                      1340 04830000
         L     @02,MOD1ACR@                                        1340 04831000
         ST    @02,@AL00001+8                                      1340 04832000
         L     @02,CCADSAD(,CCAPTR)                                1340 04833000
         LA    @02,CCADSIDA+88(,@02)                               1340 04834000
         ST    @02,@AL00001+12                                     1340 04835000
         LA    @01,@AL00001                                        1340 04836000
         BAL   @14,M1MSG                                           1340 04837000
*           RFY                                                    1341 04838000
*             RTNCODE RSTD;                                        1341 04839000
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */ 04840000
         CR    M1RRC,RTNCODE                                       1342 04841000
         BNL   *+6                                                      04842000
         LR    M1RRC,RTNCODE                                       1342 04843000
*           RFY                                                    1343 04844000
*             RTNCODE UNRSTD;                                      1343 04845000
*         END;                                                     1344 04846000
*     END;                                                         1345 04847000
@RF01335 DS    0H                                                  1346 04848000
*   IF(M1CRMFND=OFF                 /* NEITHER ACDS NOR CDS RMID?    */ 04849000
*       &M1ARMFND=OFF) THEN         /* ...                           */ 04850000
@RF01330 TM    M1CRMFND,B'11000000'                                1346 04851000
         BNZ   @RF01346                                            1346 04852000
*     DO;                           /* YES,                          */ 04853000
*       MOD1DONE=ON;                /* HALT FURTHER PROCESSING SINCE    04854000
*                                      THERE SHOULD BE NO UMID'S     */ 04855000
         OI    MOD1DONE,B'10000000'                                1348 04856000
*     END;                                                         1349 04857000
*   IF M1RRC<STOPSMD                /* RC OK ...                     */ 04858000
*       &MOD1DONE=OFF THEN          /* AND NOT DONE?                 */ 04859000
@RF01346 CH    M1RRC,@CH00034                                      1350 04860000
         BNL   @RF01350                                            1350 04861000
         TM    MOD1DONE,B'10000000'                                1350 04862000
         BNZ   @RF01350                                            1350 04863000
*     DO;                           /* YES,                          */ 04864000
*       IF(M1CRMFND=ON              /* BOTH ACDS AND CDS RMID FOUND? */ 04865000
*           &M1ARMFND=ON) THEN      /* ...                           */ 04866000
         TM    M1CRMFND,B'11000000'                                1352 04867000
         BNO   @RF01352                                            1352 04868000
*         DO;                       /* YES,                          */ 04869000
*           IF M1RMIDEQ^=ON THEN    /* CDS AND ACDS RMID UNEQUAL?    */ 04870000
         TM    M1RMIDEQ,B'00100000'                                1354 04871000
         BO    @RF01354                                            1354 04872000
*             DO;                   /* YES,                          */ 04873000
*               MOD1DONE=OFF;       /* CONTINUE CHEKING              */ 04874000
*                                                                  1356 04875000
         NI    MOD1DONE,B'01111111'                                1356 04876000
*               /*****************************************************/ 04877000
*               /*                                                   */ 04878000
*               /* CHECK FOR PRE/SUP RELATIONSHIP                    */ 04879000
*               /*                                                   */ 04880000
*               /*****************************************************/ 04881000
*                                                                  1357 04882000
*               IF M1CRMASM=OFF     /* CDS ...                       */ 04883000
*                   &M1ARMASM=OFF THEN/* ... AND ACDS RMID NOT ASSEM?*/ 04884000
         TM    M1CRMASM,B'00000011'                                1357 04885000
         BNZ   @RF01357                                            1357 04886000
*                 DO;               /* YES,                          */ 04887000
*                   IF M1RCANS=RESTORE THEN/* CDS RMID BEING       1359 04888000
*                                      RESTORED?                     */ 04889000
         CLI   M1RCANS,C'R'                                        1359 04890000
         BNE   @RF01359                                            1359 04891000
*                     DO;           /* YES,                          */ 04892000
*                       IF M1FMIDEQ=ON THEN/* SHOULD PRE/SUP       1361 04893000
*                                      RELATIONSHIPS BE CHECKED?     */ 04894000
         TM    M1FMIDEQ,B'00100000'                                1361 04895000
         BNO   @RF01361                                            1361 04896000
*                         DO;       /* YES,                          */ 04897000
*                           CALL HMASMTPS(M1RCICT@,/* CDS RMID ICT 1363 04898000
*                                      SMD ENTRY PTR                 */ 04899000
*                               M1ARMID,/* ACDS RMID                 */ 04900000
*                               M1TPSANS);/* ANSWER                  */ 04901000
         MVC   @AL00001(12),@AL01363                               1363 04902000
         L     @02,MOD1ACR@                                        1363 04903000
         ST    @02,@AL00001+4                                      1363 04904000
         L     @15,@CV02029                                        1363 04905000
         LA    @01,@AL00001                                        1363 04906000
         BALR  @14,@15                                             1363 04907000
*                           IF M1TPSANS=YES THEN/* FOUND?            */ 04908000
         CLI   M1TPSANS,C'Y'                                       1364 04909000
         BNE   @RF01364                                            1364 04910000
*                             DO;   /* YES,                          */ 04911000
*                               MOD1DONE=OFF;/* MODID CHECKING     1366 04912000
*                                      CONTINUES                     */ 04913000
         NI    MOD1DONE,B'01111111'                                1366 04914000
*                             END;                                 1367 04915000
*                           ELSE    /* PRE/SUP RELATIONSHIP NOT FOUND*/ 04916000
*                             DO;                                  1368 04917000
         B     @RC01364                                            1368 04918000
@RF01364 DS    0H                                                  1369 04919000
*                               CALL REGRCHK(CCAIOPTR->HMASMIOP,/*   */ 04920000
*                                   M1ARMID,ICTMOD(1));            1369 04921000
         L     @02,CCAIOPTR(,CCAPTR)                               1369 04922000
         ST    @02,@AL00001                                        1369 04923000
         L     @02,MOD1ACR@                                        1369 04924000
         ST    @02,@AL00001+4                                      1369 04925000
         L     @02,@PC00015                                        1369 04926000
         ST    @02,@AL00001+8                                      1369 04927000
         LA    @01,@AL00001                                        1369 04928000
         BAL   @14,REGRCHK                                         1369 04929000
*                               RFY                                1370 04930000
*                                 RTNCODE RSTD;                    1370 04931000
*                               IF RTNCODE^=ZERO THEN/* NOT A      1371 04932000
*                                      REGRESSED ELEMENT             */ 04933000
         LTR   RTNCODE,RTNCODE                                     1371 04934000
         BZ    @RF01371                                            1371 04935000
*                                 DO;/* YES, ISSUE ERROR MESSAGE     */ 04936000
*                                   RFY                            1373 04937000
*                                     RTNCODE UNRSTD;              1373 04938000
*                                   CALL M1MSG(TXTRMID,/* 'RMID'     */ 04939000
*                                       PART128,/* 'DOES NOT PRE/SUP    04940000
*                                      SMPACDS MODID'                */ 04941000
*                                       M1CRMID,/* RMID NAME         */ 04942000
*                                       CCADSIDA(IOPCDS));/* 'SMPCDS'*/ 04943000
         LA    @02,@CC02062                                        1374 04944000
         ST    @02,@AL00001                                        1374 04945000
         LA    @02,@CF02056                                        1374 04946000
         ST    @02,@AL00001+4                                      1374 04947000
         L     @02,MOD1CDR@                                        1374 04948000
         ST    @02,@AL00001+8                                      1374 04949000
         L     @02,CCADSAD(,CCAPTR)                                1374 04950000
         LA    @02,CCADSIDA+8(,@02)                                1374 04951000
         ST    @02,@AL00001+12                                     1374 04952000
         LA    @01,@AL00001                                        1374 04953000
         BAL   @14,M1MSG                                           1374 04954000
*                                   RFY                            1375 04955000
*                                     RTNCODE RSTD;                1375 04956000
*                                   M1RRC=MAX(M1RRC,RTNCODE);/* SAVE    04957000
*                                      MAX RC                        */ 04958000
         CR    M1RRC,RTNCODE                                       1376 04959000
         BNL   *+6                                                      04960000
         LR    M1RRC,RTNCODE                                       1376 04961000
*                                   RFY                            1377 04962000
*                                     RTNCODE UNRSTD;              1377 04963000
*                                   MOD1DONE=ON;/* MODID CHECKING  1378 04964000
*                                      FINISHED ...                  */ 04965000
*                                   MOD1ERR=ON;/* ... WITH AN ERROR  */ 04966000
         OI    MOD1DONE,B'11000000'                                1379 04967000
*                                 END;                             1380 04968000
*                             END;                                 1381 04969000
*                         END;      /*                               */ 04970000
*                       ELSE                                       1383 04971000
*                         ;         /* FMIDS NOT EQUAL               */ 04972000
@RF01361 DS    0H                                                  1384 04973000
*                     END;          /*                               */ 04974000
*                   ELSE            /* NOT BEING RESTORED            */ 04975000
*                     DO;           /*                               */ 04976000
         B     @RC01359                                            1385 04977000
@RF01359 DS    0H                                                  1386 04978000
*                       CALL M1MSG(TXTRMID,/* 'RMID'                 */ 04979000
*                           PART127,/* 'IS NOT BEING RESTORED'       */ 04980000
*                           M1CRMID,/* RMID NAME                     */ 04981000
*                           CCADSIDA(IOPCDS));/* 'SMPCDS'            */ 04982000
         LA    @02,@CC02062                                        1386 04983000
         ST    @02,@AL00001                                        1386 04984000
         LA    @02,@CF02054                                        1386 04985000
         ST    @02,@AL00001+4                                      1386 04986000
         L     @02,MOD1CDR@                                        1386 04987000
         ST    @02,@AL00001+8                                      1386 04988000
         L     @02,CCADSAD(,CCAPTR)                                1386 04989000
         LA    @02,CCADSIDA+8(,@02)                                1386 04990000
         ST    @02,@AL00001+12                                     1386 04991000
         LA    @01,@AL00001                                        1386 04992000
         BAL   @14,M1MSG                                           1386 04993000
*                       RFY                                        1387 04994000
*                         RTNCODE RSTD;                            1387 04995000
*                       M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC      */ 04996000
         CR    M1RRC,RTNCODE                                       1388 04997000
         BNL   *+6                                                      04998000
         LR    M1RRC,RTNCODE                                       1388 04999000
*                       RFY                                        1389 05000000
*                         RTNCODE UNRSTD;                          1389 05001000
*                       MOD1DONE=ON;/* MODID CHECKING FINISHED ...   */ 05002000
*                       MOD1ERR=ON; /* ... WITH AN ERROR             */ 05003000
         OI    MOD1DONE,B'11000000'                                1391 05004000
*                     END;          /*                               */ 05005000
*                 END;                                             1393 05006000
*               ELSE                                               1394 05007000
*                 ;                 /* CDS OR ACDS RMID RESULT OF  1394 05008000
*                                      ASSEMBLY                      */ 05009000
@RF01357 DS    0H                                                  1395 05010000
*             END;                                                 1395 05011000
*           ELSE                    /* RMID FOR CDS EQUAL THAT FOR 1396 05012000
*                                      ACDS                          */ 05013000
*             DO;                                                  1396 05014000
         B     @RC01354                                            1396 05015000
@RF01354 DS    0H                                                  1397 05016000
*               MOD1DONE=OFF;       /* MODID CHECKING IS TOBE DONE 1397 05017000
*                                      SINCE BOTH CDS AND ACDS     1397 05018000
*                                      REPRESENT THE SAME SERVICE  1397 05019000
*                                      CHAIN                         */ 05020000
         NI    MOD1DONE,B'01111111'                                1397 05021000
*             END;                                                 1398 05022000
*         END;                                                     1399 05023000
*                                                                  1399 05024000
@RC01354 DS    0H                                                  1400 05025000
*       /*************************************************************/ 05026000
*       /*                                                           */ 05027000
*       /* ACDS RMID, BUT NOT CDS RMID PRESENT, IS AN ERROR. ISSUE AN*/ 05028000
*       /* ERROR MESSAGE                                             */ 05029000
*       /*                                                           */ 05030000
*       /*************************************************************/ 05031000
*                                                                  1400 05032000
*       IF(M1CRMFND=OFF             /* CDS RMID NOT PRESENT          */ 05033000
*           &M1ARMFND=ON            /* AND ACDS RMID PRESENT ...     */ 05034000
*           &M1ARMASM^=ON) THEN     /* ... ANS ACDS RMID ^ ASSEM TYPE*/ 05035000
@RF01352 TM    M1ARMFND,B'01000000'                                1400 05036000
         BNO   @RF01400                                            1400 05037000
         TM    M1CRMFND,B'10000001'                                1400 05038000
         BNZ   @RF01400                                            1400 05039000
*         DO;                       /* YES,                          */ 05040000
*           MOD1DONE=ON;            /* NO FURTHER CHECKING SINCE   1402 05041000
*                                      MODID'S REPRESENT DIFFERENT 1402 05042000
*                                      SERVICE CHAINS                */ 05043000
*           MOD1ERR=ON;             /* MODID ERROR SINCE RMID IS   1403 05044000
*                                      ACCEPTED BUT NOT APPLIED      */ 05045000
*                                                                  1403 05046000
         OI    MOD1DONE,B'11000000'                                1403 05047000
*           /*********************************************************/ 05048000
*           /*                                                       */ 05049000
*           /* ISSUE ERROR MESSAGE, ACDS RMID IS NOT APPLIED         */ 05050000
*           /*                                                       */ 05051000
*           /*********************************************************/ 05052000
*                                                                  1404 05053000
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */ 05054000
*               PART126,            /* 'APPLIED BUT NOT ACCEPTED'    */ 05055000
*               M1ARMID,            /* RMID NAME                     */ 05056000
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */ 05057000
         LA    @02,@CC02062                                        1404 05058000
         ST    @02,@AL00001                                        1404 05059000
         LA    @02,@CF02052                                        1404 05060000
         ST    @02,@AL00001+4                                      1404 05061000
         L     @02,MOD1ACR@                                        1404 05062000
         ST    @02,@AL00001+8                                      1404 05063000
         L     @02,CCADSAD(,CCAPTR)                                1404 05064000
         LA    @02,CCADSIDA+8(,@02)                                1404 05065000
         ST    @02,@AL00001+12                                     1404 05066000
         LA    @01,@AL00001                                        1404 05067000
         BAL   @14,M1MSG                                           1404 05068000
*           RFY                                                    1405 05069000
*             RTNCODE RSTD;                                        1405 05070000
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */ 05071000
         CR    M1RRC,RTNCODE                                       1406 05072000
         BNL   *+6                                                      05073000
         LR    M1RRC,RTNCODE                                       1406 05074000
*           RFY                                                    1407 05075000
*             RTNCODE UNRSTD;                                      1407 05076000
*         END;                                                     1408 05077000
*                                                                  1408 05078000
*       /*************************************************************/ 05079000
*       /*                                                           */ 05080000
*       /* CDS RMID PRESENT BUT ACDS RMID IS NOT                     */ 05081000
*       /*                                                           */ 05082000
*       /*************************************************************/ 05083000
*                                                                  1409 05084000
*       IF(M1CRMFND=ON              /* CDS RMID PRESENT              */ 05085000
*           &M1ARMFND=OFF           /* AND ACDS RMID NOT PRESENT?    */ 05086000
*           &M1CRMASM=OFF) THEN     /* AND CDS RMID NOT ASSEM TYPE   */ 05087000
@RF01400 TM    M1CRMFND,B'10000000'                                1409 05088000
         BNO   @RF01409                                            1409 05089000
         TM    M1ARMFND,B'01000010'                                1409 05090000
         BNZ   @RF01409                                            1409 05091000
*         DO;                       /* YES,                          */ 05092000
*           MOD1DONE=OFF;           /* MODID CHECKING IS DONE SINCE     05093000
*                                      THE RMID AND UMID'S REPRESENT    05094000
*                                      DIFFERENT SERVICE CHAINS      */ 05095000
         NI    MOD1DONE,B'01111111'                                1411 05096000
*           IF M1RCANS^=RESTORE THEN/* CDS RMID NOT BEING RESTORED?  */ 05097000
         CLI   M1RCANS,C'R'                                        1412 05098000
         BE    @RF01412                                            1412 05099000
*             DO;                   /* YES,                          */ 05100000
*               MOD1ERR=ON;         /* ERROR SINCE CDS FMID IS NOT 1414 05101000
*                                      BEING RESTORED                */ 05102000
*               MOD1DONE=ON;        /* NO FURTHER CHECKING           */ 05103000
         OI    MOD1ERR,B'11000000'                                 1415 05104000
*               CALL M1MSG(TXTRMID, /* 'RMID'                        */ 05105000
*                   PART127,        /* PART NUMBER                   */ 05106000
*                   M1CRMID,        /* RMID NAME                     */ 05107000
*                   CCADSIDA(IOPCDS));/* 'SMPCDS'                    */ 05108000
         LA    @02,@CC02062                                        1416 05109000
         ST    @02,@AL00001                                        1416 05110000
         LA    @02,@CF02054                                        1416 05111000
         ST    @02,@AL00001+4                                      1416 05112000
         L     @02,MOD1CDR@                                        1416 05113000
         ST    @02,@AL00001+8                                      1416 05114000
         L     @02,CCADSAD(,CCAPTR)                                1416 05115000
         LA    @02,CCADSIDA+8(,@02)                                1416 05116000
         ST    @02,@AL00001+12                                     1416 05117000
         LA    @01,@AL00001                                        1416 05118000
         BAL   @14,M1MSG                                           1416 05119000
*               RFY                                                1417 05120000
*                 RTNCODE RSTD;                                    1417 05121000
*               M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC              */ 05122000
         CR    M1RRC,RTNCODE                                       1418 05123000
         BNL   *+6                                                      05124000
         LR    M1RRC,RTNCODE                                       1418 05125000
*               RFY                                                1419 05126000
*                 RTNCODE UNRSTD;                                  1419 05127000
*             END;                                                 1420 05128000
*           ELSE                                                   1421 05129000
*             ;                     /* SYSMOD IS BEING RESTORED      */ 05130000
@RF01412 DS    0H                                                  1422 05131000
*         END;                                                     1422 05132000
*     END;                                                         1423 05133000
@RF01409 DS    0H                                                  1424 05134000
*   IF M1RRC<STOPSMD                /* NO FAILING ERROR ...          */ 05135000
*       &M1CRMFND=ON THEN           /* ... AND THERE IS A CDS RMID?  */ 05136000
@RF01350 CH    M1RRC,@CH00034                                      1424 05137000
         BNL   @RF01424                                            1424 05138000
         TM    M1CRMFND,B'10000000'                                1424 05139000
         BNO   @RF01424                                            1424 05140000
*     DO;                           /* YES,                          */ 05141000
*       CALL M1PRECK(M1RCICT@,      /* CALL PRE CHECK TO SET ACDS ID    05142000
*                                      IS RELATED FLAG               */ 05143000
*           ICTMICHA(1),            /*                               */ 05144000
*           M1RCANS,                /*                               */ 05145000
*           M1RCPART);              /*                               */ 05146000
         MVC   @AL00001(16),@AL01426                               1426 05147000
         L     @02,@PC00015                                        1426 05148000
         LA    @02,ICTMICHA(,@02)                                  1426 05149000
         ST    @02,@AL00001+4                                      1426 05150000
         LA    @01,@AL00001                                        1426 05151000
         BAL   @14,M1PRECK                                         1426 05152000
*       RFY                                                        1427 05153000
*         RTNCODE RSTD;                                            1427 05154000
*       M1RRC=MAX(M1RRC,RTNCODE);   /* SAVE MAX RC                   */ 05155000
         CR    M1RRC,RTNCODE                                       1428 05156000
         BNL   *+6                                                      05157000
         LR    M1RRC,RTNCODE                                       1428 05158000
*       RFY                                                        1429 05159000
*         RTNCODE UNRSTD;                                          1429 05160000
*     END;                          /*                               */ 05161000
*   RETURN CODE(M1RRC);             /* RETURN W/ RETURN CODE         */ 05162000
@RF01424 LR    @15,M1RRC                                           1431 05163000
         L     @14,@SA00018                                        1431 05164000
         LM    @00,@12,@SA00018+8                                  1431 05165000
         BR    @14                                                 1431 05166000
*   RFY                                                            1432 05167000
*     TSLPARMS BASED;                                              1432 05168000
*   RFY                                                            1433 05169000
*     ICTMOD BASED;                                                1433 05170000
*   END M1RMID;                                                    1434 05171000
         EJECT                                                          05172000
*                                                                  1435 05173000
*   /*****************************************************************/ 05174000
*   /*                                                               */ 05175000
*   /* M1UMID -                                                      */ 05176000
*   /*                                                               */ 05177000
*   /*****************************************************************/ 05178000
*                                                                  1435 05179000
*M1UMID:                                                           1435 05180000
*   PROC;                                                          1435 05181000
M1UMID   STM   @14,@12,@SA00019                                    1435 05182000
*   DCL                                                            1436 05183000
*     M1URC FIXED(15);              /* LOCAL RETURN CODE             */ 05184000
*   DCL                                                            1437 05185000
*     1 M1UFLAGS,                   /* LOCAL CONTROL FLAGS           */ 05186000
*       3 M1UBOTH BIT(1),           /* UMID IN BOTH CDS AND ACDS   1437 05187000
*                                      LISTS                         */ 05188000
*       3 * BIT(7);                 /* UNUSED                        */ 05189000
*   DCL                                                            1438 05190000
*     M1UAANS CHAR(1);              /* ANSWER FOR ACDS MODID LIST  1438 05191000
*                                      ENTRY                         */ 05192000
*   DCL                                                            1439 05193000
*     M1UAPART FIXED(31);           /* MESSAGE PART FOR ACDS MODID 1439 05194000
*                                      LIST ENTRY                    */ 05195000
*   DCL                                                            1440 05196000
*     M1UCANS CHAR(1);              /* ANSWER FOR CDS MODID LIST   1440 05197000
*                                      ENTRY                         */ 05198000
*   DCL                                                            1441 05199000
*     M1UCPART FIXED(31);           /* MESSAGE PART FOR CDS MODID  1441 05200000
*                                      LIST ENTRY                    */ 05201000
*   DCL                                                            1442 05202000
*     M1UCICT@ PTR(31);             /* ICT SYSMOD ENTRY PTR IF BEING    05203000
*                                      RESTORED                      */ 05204000
*   DCL                                                            1443 05205000
*     M1UX1 FIXED(31);              /* INDEX COUNTER FOR THE CDS   1443 05206000
*                                      MODID LIST                    */ 05207000
*   DCL                                                            1444 05208000
*     M1UX2 FIXED(31);              /* INDEX COUNTER FOR THE ACDS  1444 05209000
*                                      MODID LIST                    */ 05210000
*   RFY                                                            1445 05211000
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1445 05212000
*   RFY                                                            1446 05213000
*     ICTMIDLS BASED(ICTMICHN(1));  /* CDS MODID CHAIN               */ 05214000
*   RFY                                                            1447 05215000
*     TSLPARMS BASED(TBLXTSLP);                                    1447 05216000
*   M1URC=ZERO;                     /* CLEAR RETURN CODE             */ 05217000
         SLR   M1URC,M1URC                                         1448 05218000
*   M1UFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */ 05219000
         MVI   M1UFLAGS,X'00'                                      1449 05220000
*                                                                  1450 05221000
*   /*****************************************************************/ 05222000
*   /*                                                               */ 05223000
*   /* PROCESS ALL CDS UMID'S                                        */ 05224000
*   /*                                                               */ 05225000
*   /*****************************************************************/ 05226000
*                                                                  1450 05227000
*   DO M1UX1=1 BY 1                 /*                               */ 05228000
*         WHILE(ICTMIDND(M1UX1)^=ICTENDIX/*                          */ 05229000
*         &M1URC<STOPFUNC);                                        1450 05230000
         LA    M1UX1,1                                             1450 05231000
         B     @DE01450                                            1450 05232000
@DL01450 DS    0H                                                  1451 05233000
*     IF ICTMIDTY(M1UX1)=ICTMIDUP THEN/* UMID TYPE ENTRY?            */ 05234000
         LR    @04,M1UX1                                           1451 05235000
         SLA   @04,3                                               1451 05236000
         L     @02,@PC00015                                        1451 05237000
         L     @02,ICTMICHN(,@02)                                  1451 05238000
         ST    @04,@TF00001                                        1451 05239000
         ALR   @04,@02                                             1451 05240000
         BCTR  @04,0                                               1451 05241000
         TM    ICTMIDTY-7(@04),B'00000011'                         1451 05242000
         BNZ   @RF01451                                            1451 05243000
*       DO;                         /* YES,                          */ 05244000
*         CALL M1CDS(ICTMODID(M1UX1),/* UMID NAME                    */ 05245000
*             M1UCANS,              /* ANSWER                        */ 05246000
*             M1UCPART,             /* PART NUMBER                   */ 05247000
*             M1UCICT@);            /* SYSMOD ENTRY IF BEING RESTORED*/ 05248000
         MVC   @AL00001+4(12),@AL01453                             1453 05249000
         L     @04,@TF00001                                        1453 05250000
         AL    @02,@CF02695                                        1453 05251000
         LA    @04,ICTMODID(@04,@02)                               1453 05252000
         ST    @04,@AL00001                                        1453 05253000
         LA    @01,@AL00001                                        1453 05254000
         BAL   @14,M1CDS                                           1453 05255000
*         RFY                                                      1454 05256000
*           RTNCODE RSTD;                                          1454 05257000
*         M1URC=MAX(M1URC,RTNCODE); /* SAVE THE RETURN CODE          */ 05258000
         CR    M1URC,RTNCODE                                       1455 05259000
         BNL   *+6                                                      05260000
         LR    M1URC,RTNCODE                                       1455 05261000
*         IF RTNCODE<STOPFUNC THEN  /* NO SERIOUS ERROR?             */ 05262000
         CH    RTNCODE,@CH00033                                    1456 05263000
         BNL   @RF01456                                            1456 05264000
*           DO;                     /* YES,                          */ 05265000
*             RFY                                                  1458 05266000
*               RTNCODE UNRSTD;                                    1458 05267000
*             IF M1UCANS=NO THEN    /* UMID IS IN WRONG STATUS?      */ 05268000
         CLI   M1UCANS,C'N'                                        1459 05269000
         BNE   @RF01459                                            1459 05270000
*               DO;                 /* YES,                          */ 05271000
*                                                                  1460 05272000
*                 /***************************************************/ 05273000
*                 /*                                                 */ 05274000
*                 /* MESSAGE                                         */ 05275000
*                 /*                                                 */ 05276000
*                 /***************************************************/ 05277000
*                                                                  1461 05278000
*                 CALL M1MSG(TXTUMID,/* 'UMID'                       */ 05279000
*                     M1UCPART,     /* PART NUMBER                   */ 05280000
*                     ICTMODID(M1UX1),/* URMID NAME                  */ 05281000
*                     CCADSIDA(IOPCDS));/* 'SMPCDS'                  */ 05282000
         LA    @04,@CC02064                                        1461 05283000
         ST    @04,@AL00001                                        1461 05284000
         LA    @04,M1UCPART                                        1461 05285000
         ST    @04,@AL00001+4                                      1461 05286000
         LR    @04,M1UX1                                           1461 05287000
         SLA   @04,3                                               1461 05288000
         L     @02,@PC00015                                        1461 05289000
         L     @02,ICTMICHN(,@02)                                  1461 05290000
         AL    @02,@CF02695                                        1461 05291000
         LA    @04,ICTMODID(@04,@02)                               1461 05292000
         ST    @04,@AL00001+8                                      1461 05293000
         L     @04,CCADSAD(,CCAPTR)                                1461 05294000
         LA    @04,CCADSIDA+8(,@04)                                1461 05295000
         ST    @04,@AL00001+12                                     1461 05296000
         LA    @01,@AL00001                                        1461 05297000
         BAL   @14,M1MSG                                           1461 05298000
*                 RFY                                              1462 05299000
*                   RTNCODE RSTD;                                  1462 05300000
*                 M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC            */ 05301000
         CR    M1URC,RTNCODE                                       1463 05302000
         BNL   *+6                                                      05303000
         LR    M1URC,RTNCODE                                       1463 05304000
*                 RFY                                              1464 05305000
*                   RTNCODE UNRSTD;                                1464 05306000
*               END;                                               1465 05307000
*             ELSE                  /* UMID IS APPLIED OR BEING    1466 05308000
*                                      RESTORED                      */ 05309000
*               DO;                                                1466 05310000
*                                                                  1466 05311000
         B     @RC01459                                            1466 05312000
@RF01459 DS    0H                                                  1467 05313000
*                 /***************************************************/ 05314000
*                 /*                                                 */ 05315000
*                 /* DETERMINE IF THE CDS UMID IS ALSO IN THE ACDS   */ 05316000
*                 /* UMID LIST                                       */ 05317000
*                 /*                                                 */ 05318000
*                 /***************************************************/ 05319000
*                                                                  1467 05320000
*                 M1UBOTH=OFF;      /* NOT IN BOTH CDS AND ACDS MODID   05321000
*                                      LISTS                         */ 05322000
         NI    M1UBOTH,B'01111111'                                 1467 05323000
*                 DO M1UX2=1 BY 1   /* SEARCH ACDS MODID LIST FOR THE   05324000
*                                      UMID                          */ 05325000
*                       WHILE(ICTMICHA(1)->ICTMIDND(M1UX2)^=ICTENDIX    05326000
*                                   /*                               */ 05327000
*                       &M1URC<STOPFUNC);                          1468 05328000
         LA    M1UX2,1                                             1468 05329000
         B     @DE01468                                            1468 05330000
@DL01468 DS    0H                                                  1469 05331000
*                   IF ICTMODID(M1UX1)=/* MATCH?                     */ 05332000
*                       ICTMICHA(1)->ICTMODID(M1UX2) THEN/*          */ 05333000
         LR    @02,M1UX1                                           1469 05334000
         SLA   @02,3                                               1469 05335000
         L     @15,@PC00015                                        1469 05336000
         L     @01,ICTMICHN(,@15)                                  1469 05337000
         LR    @14,M1UX2                                           1469 05338000
         SLA   @14,3                                               1469 05339000
         L     @15,ICTMICHA(,@15)                                  1469 05340000
         ALR   @01,@02                                             1469 05341000
         AL    @01,@CF02695                                        1469 05342000
         ALR   @15,@14                                             1469 05343000
         AL    @15,@CF02695                                        1469 05344000
         CLC   ICTMODID(7,@01),ICTMODID(@15)                       1469 05345000
         BNE   @RF01469                                            1469 05346000
*                     DO;           /* YES,                          */ 05347000
*                       M1UBOTH=ON; /* MATCHING ACDS ENTRY FOUND     */ 05348000
         OI    M1UBOTH,B'10000000'                                 1471 05349000
*                     END;                                         1472 05350000
*                   ELSE                                           1473 05351000
*                     ;             /* NOT A MATCHING ENTRY          */ 05352000
@RF01469 DS    0H                                                  1474 05353000
*                 END;              /* END OF ACDS MODID SEARCH LOOP */ 05354000
         AH    M1UX2,@CH00064                                      1474 05355000
@DE01468 LR    @02,M1UX2                                           1474 05356000
         SLA   @02,3                                               1474 05357000
         L     @15,@PC00015                                        1474 05358000
         L     @01,ICTMICHA(,@15)                                  1474 05359000
         AL    @01,@CF02695                                        1474 05360000
         L     @02,ICTMIDND(@02,@01)                               1474 05361000
         CL    @02,ICTENDIX                                        1474 05362000
         BE    @DC01468                                            1474 05363000
         CH    M1URC,@CH00033                                      1474 05364000
         BL    @DL01468                                            1474 05365000
@DC01468 DS    0H                                                  1475 05366000
*                 IF M1UBOTH=ON THEN/* UMID IN BOTH LISTS?           */ 05367000
         TM    M1UBOTH,B'10000000'                                 1475 05368000
         BNO   @RF01475                                            1475 05369000
*                   DO;             /* YES,                          */ 05370000
*                     CALL M1ACDS(ICTMODID(M1UX1),/* UMID NAME       */ 05371000
*                         M1UAANS,  /* ANSWER                        */ 05372000
*                         M1UAPART);/* PART NUMBER                   */ 05373000
         MVC   @AL00001+4(8),@AL01477                              1477 05374000
         LR    @02,M1UX1                                           1477 05375000
         SLA   @02,3                                               1477 05376000
         L     @15,@PC00015                                        1477 05377000
         L     @01,ICTMICHN(,@15)                                  1477 05378000
         AL    @01,@CF02695                                        1477 05379000
         LA    @02,ICTMODID(@02,@01)                               1477 05380000
         ST    @02,@AL00001                                        1477 05381000
         LA    @01,@AL00001                                        1477 05382000
         BAL   @14,M1ACDS                                          1477 05383000
*                     RFY                                          1478 05384000
*                       RTNCODE RSTD;                              1478 05385000
*                     M1URC=MAX(M1URC,RTNCODE);/* SAVE THE RETURN  1479 05386000
*                                      CODE                          */ 05387000
         CR    M1URC,RTNCODE                                       1479 05388000
         BNL   *+6                                                      05389000
         LR    M1URC,RTNCODE                                       1479 05390000
*                     IF RTNCODE<STOPFUNC THEN/* NO SERIOUS ERROR?   */ 05391000
         CH    RTNCODE,@CH00033                                    1480 05392000
         BNL   @RF01480                                            1480 05393000
*                       DO;         /* YES,                          */ 05394000
*                         ICTMIDPS(M1UX2)=ON;/* NO FURTHER PROCESSING   05395000
*                                      OF ACDS UMID REQUIRED         */ 05396000
         LR    @14,M1UX2                                           1482 05397000
         SLA   @14,3                                               1482 05398000
         L     @02,@PC00015                                        1482 05399000
         L     @02,ICTMICHN(,@02)                                  1482 05400000
         ALR   @14,@02                                             1482 05401000
         BCTR  @14,0                                               1482 05402000
         OI    ICTMIDPS-7(@14),B'01000000'                         1482 05403000
*                         RFY                                      1483 05404000
*                           RTNCODE UNRSTD;                        1483 05405000
*                         IF M1UAANS=NO THEN/* BAD STATUS ON THE   1484 05406000
*                                      ACDS?                         */ 05407000
         CLI   M1UAANS,C'N'                                        1484 05408000
         BNE   @RF01484                                            1484 05409000
*                           DO;     /* YES,                          */ 05410000
*                                                                  1485 05411000
*                             /***************************************/ 05412000
*                             /*                                     */ 05413000
*                             /* ISSUE MESSAGE                       */ 05414000
*                             /*                                     */ 05415000
*                             /***************************************/ 05416000
*                                                                  1486 05417000
*                             CALL M1MSG(TXTUMID,/* 'UMID'           */ 05418000
*                                 M1UCPART,/* PART NUMBER            */ 05419000
*                                 ICTMODID(M1UX1),/* URMID NAME      */ 05420000
*                                 CCADSIDA(IOPCDS));/* 'SMPCDS'      */ 05421000
         LA    @04,@CC02064                                        1486 05422000
         ST    @04,@AL00001                                        1486 05423000
         LA    @04,M1UCPART                                        1486 05424000
         ST    @04,@AL00001+4                                      1486 05425000
         LR    @04,M1UX1                                           1486 05426000
         SLA   @04,3                                               1486 05427000
         AL    @02,@CF02695                                        1486 05428000
         LA    @04,ICTMODID(@04,@02)                               1486 05429000
         ST    @04,@AL00001+8                                      1486 05430000
         L     @04,CCADSAD(,CCAPTR)                                1486 05431000
         LA    @04,CCADSIDA+8(,@04)                                1486 05432000
         ST    @04,@AL00001+12                                     1486 05433000
         LA    @01,@AL00001                                        1486 05434000
         BAL   @14,M1MSG                                           1486 05435000
*                             RFY                                  1487 05436000
*                               RTNCODE RSTD;                      1487 05437000
*                             M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC*/ 05438000
         CR    M1URC,RTNCODE                                       1488 05439000
         BNL   *+6                                                      05440000
         LR    M1URC,RTNCODE                                       1488 05441000
*                             RFY                                  1489 05442000
*                               RTNCODE UNRSTD;                    1489 05443000
*                           END;                                   1490 05444000
*                         ELSE                                     1491 05445000
*                           ;       /* UMID IS OK                    */ 05446000
@RF01484 DS    0H                                                  1492 05447000
*                       END;                                       1492 05448000
*                     ELSE                                         1493 05449000
*                       ;           /* SERIOUS ERROR                 */ 05450000
@RF01480 DS    0H                                                  1494 05451000
*                   END;                                           1494 05452000
*                 ELSE              /* NOT IN THE ACDS LIST          */ 05453000
*                   DO;                                            1495 05454000
         B     @RC01475                                            1495 05455000
@RF01475 DS    0H                                                  1496 05456000
*                     IF M1UCANS=RESTORE THEN/* IS UMID BEING      1496 05457000
*                                      RESTORED?                     */ 05458000
         CLI   M1UCANS,C'R'                                        1496 05459000
         BNE   @RF01496                                            1496 05460000
*                       DO;         /* YES                           */ 05461000
*                                                                  1497 05462000
*                         /*******************************************/ 05463000
*                         /*                                         */ 05464000
*                         /* CHECK FOR PRE/SUP RELATIONSHIP W/ ACDS  */ 05465000
*                         /* LIST                                    */ 05466000
*                         /*                                         */ 05467000
*                         /*******************************************/ 05468000
*                                                                  1498 05469000
*                         CALL M1PRECK(M1UCICT@,/* CALL PRE CHECK TO    05470000
*                                      SET ACDS ID IS RELATED FLAG   */ 05471000
*                             ICTMICHA(1),/*                         */ 05472000
*                             M1UCANS,/*                             */ 05473000
*                             M1UCPART);/*                           */ 05474000
         MVC   @AL00001(16),@AL01498                               1498 05475000
         L     @04,@PC00015                                        1498 05476000
         LA    @04,ICTMICHA(,@04)                                  1498 05477000
         ST    @04,@AL00001+4                                      1498 05478000
         LA    @01,@AL00001                                        1498 05479000
         BAL   @14,M1PRECK                                         1498 05480000
*                         RFY                                      1499 05481000
*                           RTNCODE RSTD;                          1499 05482000
*                         M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC    */ 05483000
         CR    M1URC,RTNCODE                                       1500 05484000
         BNL   *+6                                                      05485000
         LR    M1URC,RTNCODE                                       1500 05486000
*                         RFY                                      1501 05487000
*                           RTNCODE UNRSTD;                        1501 05488000
*                       END;                                       1502 05489000
*                     ELSE          /* IS ON THE CDS, ^RESTORE AND 1503 05490000
*                                      NOT IN THE ACDS MODID LIST    */ 05491000
*                       DO;                                        1503 05492000
*                                                                  1503 05493000
         B     @RC01496                                            1503 05494000
@RF01496 DS    0H                                                  1504 05495000
*                         /*******************************************/ 05496000
*                         /*                                         */ 05497000
*                         /* ISSUE ERROR MESSAGE                     */ 05498000
*                         /*                                         */ 05499000
*                         /*******************************************/ 05500000
*                                                                  1504 05501000
*                         CALL M1MSG(TXTUMID,/* 'UMID'               */ 05502000
*                             PART124,/* 'IS APPLIED BUT NOT       1504 05503000
*                                      ACCEPTED'                     */ 05504000
*                             MOD1CDR@->ICTMODID(M1UX1),/* UMID NAME */ 05505000
*                             CCADSIDA(IOPCDS));/* 'SMPCDS'          */ 05506000
         LA    @04,@CC02064                                        1504 05507000
         ST    @04,@AL00001                                        1504 05508000
         LA    @04,@CF02049                                        1504 05509000
         ST    @04,@AL00001+4                                      1504 05510000
         LR    @04,M1UX1                                           1504 05511000
         SLA   @04,3                                               1504 05512000
         L     @02,MOD1CDR@                                        1504 05513000
         AL    @02,@CF02695                                        1504 05514000
         LA    @04,ICTMODID(@04,@02)                               1504 05515000
         ST    @04,@AL00001+8                                      1504 05516000
         L     @04,CCADSAD(,CCAPTR)                                1504 05517000
         LA    @04,CCADSIDA+8(,@04)                                1504 05518000
         ST    @04,@AL00001+12                                     1504 05519000
         LA    @01,@AL00001                                        1504 05520000
         BAL   @14,M1MSG                                           1504 05521000
*                         RFY                                      1505 05522000
*                           RTNCODE RSTD;                          1505 05523000
*                         M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC    */ 05524000
         CR    M1URC,RTNCODE                                       1506 05525000
         BNL   *+6                                                      05526000
         LR    M1URC,RTNCODE                                       1506 05527000
*                         RFY                                      1507 05528000
*                           RTNCODE UNRSTD;                        1507 05529000
*                       END;                                       1508 05530000
*                   END;                                           1509 05531000
*               END;                                               1510 05532000
*           END;                                                   1511 05533000
*         ELSE                                                     1512 05534000
*           ;                       /* ERROR OCCURRED                */ 05535000
@RF01456 DS    0H                                                  1513 05536000
*       END;                                                       1513 05537000
*     ELSE                                                         1514 05538000
*       ;                           /* NOT A UMID, SKIP IT           */ 05539000
@RF01451 DS    0H                                                  1515 05540000
*   END;                            /* END OF PROCESSING ALL CDS   1515 05541000
*                                      MODID'S                       */ 05542000
@RC01451 AH    M1UX1,@CH00064                                      1515 05543000
@DE01450 LR    @04,M1UX1                                           1515 05544000
         SLA   @04,3                                               1515 05545000
         L     @02,@PC00015                                        1515 05546000
         L     @02,ICTMICHN(,@02)                                  1515 05547000
         AL    @02,@CF02695                                        1515 05548000
         L     @04,ICTMIDND(@04,@02)                               1515 05549000
         CL    @04,ICTENDIX                                        1515 05550000
         BE    @DC01450                                            1515 05551000
         CH    M1URC,@CH00033                                      1515 05552000
         BL    @DL01450                                            1515 05553000
@DC01450 DS    0H                                                  1516 05554000
*   RFY                                                            1516 05555000
*     ICTMIDLS BASED;                                              1516 05556000
*                                                                  1516 05557000
*   /*****************************************************************/ 05558000
*   /*                                                               */ 05559000
*   /* PROCESS ALL ACDS UMID'S NOT ALREADY PROCESSING WHILE CHECKING */ 05560000
*   /* THE CDS UMID'S                                                */ 05561000
*   /*                                                               */ 05562000
*   /*****************************************************************/ 05563000
*                                                                  1517 05564000
*   RFY                                                            1517 05565000
*     ICTMIDLS BASED(ICTMICHA(1));  /* USE THE ACDS MODID LIST       */ 05566000
*   DO M1UX2=1 BY 1                 /*                               */ 05567000
*         WHILE(ICTMIDND(M1UX2)^=ICTENDIX/*                          */ 05568000
*         &M1URC<STOPFUNC);         /*                               */ 05569000
         LA    M1UX2,1                                             1518 05570000
         B     @DE01518                                            1518 05571000
@DL01518 DS    0H                                                  1519 05572000
*     IF ICTMIDPS(M1UX2)=OFF        /* NOT ALREADY PROCESSED ...     */ 05573000
*         &ICTMIDTY(M1UX2)=ICTMIDUP THEN/* AND A UMID?               */ 05574000
         LR    @05,M1UX2                                           1519 05575000
         SLA   @05,3                                               1519 05576000
         L     @02,@PC00015                                        1519 05577000
         L     @15,ICTMICHA(,@02)                                  1519 05578000
         ST    @05,@TF00001                                        1519 05579000
         ALR   @05,@15                                             1519 05580000
         BCTR  @05,0                                               1519 05581000
         TM    ICTMIDPS-7(@05),B'01000000'                         1519 05582000
         BNZ   @RF01519                                            1519 05583000
         LR    @05,@15                                             1519 05584000
         AL    @05,@TF00001                                        1519 05585000
         BCTR  @05,0                                               1519 05586000
         TM    ICTMIDTY-7(@05),B'00000011'                         1519 05587000
         BNZ   @RF01519                                            1519 05588000
*       DO;                         /* YES,                          */ 05589000
*         CALL REGRCHK(CCAIOPTR->HMASMIOP,/*                         */ 05590000
*             ICTMODID(M1UX2),ICTMOD(1));                          1521 05591000
         L     @05,CCAIOPTR(,CCAPTR)                               1521 05592000
         ST    @05,@AL00001                                        1521 05593000
         L     @05,@TF00001                                        1521 05594000
         AL    @15,@CF02695                                        1521 05595000
         LA    @05,ICTMODID(@05,@15)                               1521 05596000
         ST    @05,@AL00001+4                                      1521 05597000
         ST    @02,@AL00001+8                                      1521 05598000
         LA    @01,@AL00001                                        1521 05599000
         BAL   @14,REGRCHK                                         1521 05600000
*         RFY                                                      1522 05601000
*           RTNCODE RSTD;                                          1522 05602000
*         IF RTNCODE^=ZERO THEN     /* NOT A REGRESSED ELEMENT       */ 05603000
         LTR   RTNCODE,RTNCODE                                     1523 05604000
         BZ    @RF01523                                            1523 05605000
*           DO;                     /* YES, ISSUE ERROR MESSAGE      */ 05606000
*             RFY                                                  1525 05607000
*               RTNCODE UNRSTD;                                    1525 05608000
*                                                                  1525 05609000
*             /*******************************************************/ 05610000
*             /*                                                     */ 05611000
*             /* ERROR OCCURRED ISSUE MESSAGE, SMPACDS UMID XXXXXXX  */ 05612000
*             /* IS NOT RELATED TO SMPCDS MODID LIST                 */ 05613000
*             /*                                                     */ 05614000
*             /*******************************************************/ 05615000
*                                                                  1526 05616000
*             CALL M1MSG(TXTUMID,   /* 'UMID'                        */ 05617000
*                 PART126,          /* 'IS ACCEPTED BUT NOT APPLIED' */ 05618000
*                 ICTMODID(M1UX2),  /* UMID NAME                     */ 05619000
*                 CCADSIDA(IOPACDS));/* 'SMPACDS'                    */ 05620000
         LA    @05,@CC02064                                        1526 05621000
         ST    @05,@AL00001                                        1526 05622000
         LA    @05,@CF02052                                        1526 05623000
         ST    @05,@AL00001+4                                      1526 05624000
         LR    @05,M1UX2                                           1526 05625000
         SLA   @05,3                                               1526 05626000
         L     @02,@PC00015                                        1526 05627000
         L     @02,ICTMICHA(,@02)                                  1526 05628000
         AL    @02,@CF02695                                        1526 05629000
         LA    @05,ICTMODID(@05,@02)                               1526 05630000
         ST    @05,@AL00001+8                                      1526 05631000
         L     @05,CCADSAD(,CCAPTR)                                1526 05632000
         LA    @05,CCADSIDA+88(,@05)                               1526 05633000
         ST    @05,@AL00001+12                                     1526 05634000
         LA    @01,@AL00001                                        1526 05635000
         BAL   @14,M1MSG                                           1526 05636000
*             RFY                                                  1527 05637000
*               RTNCODE RSTD;                                      1527 05638000
*             M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC                */ 05639000
         CR    M1URC,RTNCODE                                       1528 05640000
         BNL   *+6                                                      05641000
         LR    M1URC,RTNCODE                                       1528 05642000
*             RFY                                                  1529 05643000
*               RTNCODE UNRSTD;                                    1529 05644000
*           END;                                                   1530 05645000
*       END;                                                       1531 05646000
*     ELSE                                                         1532 05647000
*       ;                           /* CONTINUE WITH NEXT ENTRY      */ 05648000
@RF01519 DS    0H                                                  1533 05649000
*   END;                            /* END OF ACDS MODID PROCESS LOOP*/ 05650000
@RC01519 AH    M1UX2,@CH00064                                      1533 05651000
@DE01518 LR    @05,M1UX2                                           1533 05652000
         SLA   @05,3                                               1533 05653000
         L     @02,@PC00015                                        1533 05654000
         L     @02,ICTMICHA(,@02)                                  1533 05655000
         AL    @02,@CF02695                                        1533 05656000
         L     @05,ICTMIDND(@05,@02)                               1533 05657000
         CL    @05,ICTENDIX                                        1533 05658000
         BE    @DC01518                                            1533 05659000
         CH    M1URC,@CH00033                                      1533 05660000
         BL    @DL01518                                            1533 05661000
@DC01518 DS    0H                                                  1534 05662000
*   RETURN CODE(M1URC);             /* RETURN W/ RETURN CODE         */ 05663000
         LR    @15,M1URC                                           1534 05664000
         L     @14,@SA00019                                        1534 05665000
         LM    @00,@12,@SA00019+8                                  1534 05666000
         BR    @14                                                 1534 05667000
*   END M1UMID;                                                    1535 05668000
*   RFY                                                            1536 05669000
*     ICTMOD BASED;                                                1536 05670000
*   RFY                                                            1537 05671000
*     ICTMIDLS BASED;                                              1537 05672000
*   RFY                                                            1538 05673000
*     TSLPARMS BASED;                                              1538 05674000
         EJECT                                                          05675000
*                                                                  1539 05676000
*   /*****************************************************************/ 05677000
*   /*                                                               */ 05678000
*   /* M1PRECK -                                                     */ 05679000
*   /*                                                               */ 05680000
*   /*****************************************************************/ 05681000
*                                                                  1539 05682000
*M1PRECK:                                                          1539 05683000
*   PROC(M1PCICT@,                  /* ADDRESS OF ICT ENTRY FOR CDS     05684000
*                                      MODID                         */ 05685000
*       M1PLST@,                    /* PTR TO ACDS MODID LIST        */ 05686000
*       M1PAANS,                    /* ANSWER FOR ACDS CHECK         */ 05687000
*       M1PAPART);                  /* ACDS PART                     */ 05688000
M1PRECK  STM   @14,@12,@SA00020                                    1539 05689000
         MVC   @PC00020(16),0(@01)                                 1539 05690000
*   DCL                                                            1540 05691000
*     M1PCICT@ FIXED(31);           /* ADDRESS OF ICT ENTRY FOR CDS     05692000
*                                      MODID                         */ 05693000
*   DCL                                                            1541 05694000
*     M1PLST@ PTR(31);              /* PTR TO LIST OF MODID'S TO   1541 05695000
*                                      CHECK AGAINST                 */ 05696000
*   DCL                                                            1542 05697000
*     M1PAANS CHAR(1);              /* ANSWER FOR ACDS CHECK         */ 05698000
*   DCL                                                            1543 05699000
*     M1PAPART FIXED(31);           /* ACDS PART                     */ 05700000
*   DCL                                                            1544 05701000
*     M1PRC FIXED(15);              /* LOCAL RETURN CODE             */ 05702000
*   DCL                                                            1545 05703000
*     M1PANS CHAR(1);               /* ANSWER FROM TPS               */ 05704000
*   DCL                                                            1546 05705000
*     M1PX1 FIXED(31);              /* MODID SEARCH LOOP INDEX       */ 05706000
*   RFY                                                            1547 05707000
*     ICTMIDLS BASED(M1PLST@);                                     1547 05708000
*   M1PRC=ZERO;                     /* CLEAR RETURN CODE             */ 05709000
         SLR   M1PRC,M1PRC                                         1548 05710000
*   M1PANS=NO;                      /*                               */ 05711000
         MVI   M1PANS,C'N'                                         1549 05712000
*   DO M1PX1=1 BY 1                 /* PROCESS ALL MODIDS            */ 05713000
*         WHILE(M1PCICT@^=ZERO      /* IF ICT PTR ^ZERO              */ 05714000
*         &ICTMIDND(M1PX1)^=ICTENDIX);                             1550 05715000
         LA    M1PX1,1                                             1550 05716000
         B     @DE01550                                            1550 05717000
@DL01550 DS    0H                                                  1551 05718000
*     IF ICTMIDTY(M1PX1)=ICTMIDRM   /* IS MODID RMID OR UMID?        */ 05719000
*         |ICTMIDTY(M1PX1)=ICTMIDUP THEN/*                           */ 05720000
         LR    @05,M1PX1                                           1551 05721000
         SLA   @05,3                                               1551 05722000
         L     @02,@PC00020+4                                      1551 05723000
         L     @02,M1PLST@(,@02)                                   1551 05724000
         ALR   @02,@05                                             1551 05725000
         BCTR  @02,0                                               1551 05726000
         TM    ICTMIDTY-7(@02),B'00000001'                         1551 05727000
         BNO   @GL00068                                            1551 05728000
         TM    ICTMIDTY-7(@02),B'00000010'                         1551 05729000
         BZ    @RT01551                                            1551 05730000
@GL00068 LR    @05,M1PX1                                           1551 05731000
         SLA   @05,3                                               1551 05732000
         L     @02,@PC00020+4                                      1551 05733000
         L     @02,M1PLST@(,@02)                                   1551 05734000
         ALR   @02,@05                                             1551 05735000
         BCTR  @02,0                                               1551 05736000
         TM    ICTMIDTY-7(@02),B'00000011'                         1551 05737000
         BNZ   @RF01551                                            1551 05738000
@RT01551 DS    0H                                                  1552 05739000
*       DO;                         /* YES                           */ 05740000
*         CALL HMASMTPS(M1PCICT@,   /* CDS MID ENTRY PTR             */ 05741000
*             ICTMODID(M1PX1),      /* ACDS MID                      */ 05742000
*             M1PANS);              /* ANSWER                        */ 05743000
         L     @05,@PC00020                                        1553 05744000
         ST    @05,@AL00001                                        1553 05745000
         LR    @05,M1PX1                                           1553 05746000
         SLA   @05,3                                               1553 05747000
         L     @02,@PC00020+4                                      1553 05748000
         L     @02,M1PLST@(,@02)                                   1553 05749000
         AL    @02,@CF02695                                        1553 05750000
         LA    @05,ICTMODID(@05,@02)                               1553 05751000
         ST    @05,@AL00001+4                                      1553 05752000
         LA    @05,M1PANS                                          1553 05753000
         ST    @05,@AL00001+8                                      1553 05754000
         L     @15,@CV02029                                        1553 05755000
         LA    @01,@AL00001                                        1553 05756000
         BALR  @14,@15                                             1553 05757000
*         IF M1PANS=YES THEN        /* FOUND?                        */ 05758000
         CLI   M1PANS,C'Y'                                         1554 05759000
         BNE   @RF01554                                            1554 05760000
*           DO;                     /* YES,                          */ 05761000
*             CALL M1ACDS(ICTMODID(M1PX1),/*                         */ 05762000
*                 M1PAANS,          /* ANSWER                        */ 05763000
*                 M1PAPART);        /* PART                          */ 05764000
         LR    @05,M1PX1                                           1556 05765000
         SLA   @05,3                                               1556 05766000
         L     @02,@PC00020+4                                      1556 05767000
         L     @02,M1PLST@(,@02)                                   1556 05768000
         AL    @02,@CF02695                                        1556 05769000
         LA    @05,ICTMODID(@05,@02)                               1556 05770000
         ST    @05,@AL00001                                        1556 05771000
         L     @05,@PC00020+8                                      1556 05772000
         ST    @05,@AL00001+4                                      1556 05773000
         L     @05,@PC00020+12                                     1556 05774000
         ST    @05,@AL00001+8                                      1556 05775000
         LA    @01,@AL00001                                        1556 05776000
         BAL   @14,M1ACDS                                          1556 05777000
*             IF M1PAANS^=YES THEN  /* NOT OK?                       */ 05778000
         L     @05,@PC00020+8                                      1557 05779000
         CLI   M1PAANS(@05),C'Y'                                   1557 05780000
         BE    @RF01557                                            1557 05781000
*               DO;                 /* YES,                          */ 05782000
*                                                                  1558 05783000
*                 /***************************************************/ 05784000
*                 /*                                                 */ 05785000
*                 /* ISSUE MESSAGE                                   */ 05786000
*                 /*                                                 */ 05787000
*                 /***************************************************/ 05788000
*                                                                  1559 05789000
*                 CALL M1MSG(TXTUMID,/* 'MID'                        */ 05790000
*                     M1PAPART,     /* PART NUMBER                   */ 05791000
*                     ICTMODID(M1PX1),/* ACDS MOD ID NAME            */ 05792000
*                     CCADSIDA(IOPACDS));/* 'SMPCDS'                 */ 05793000
         LA    @05,@CC02064                                        1559 05794000
         ST    @05,@AL00001                                        1559 05795000
         L     @05,@PC00020+12                                     1559 05796000
         ST    @05,@AL00001+4                                      1559 05797000
         LR    @05,M1PX1                                           1559 05798000
         SLA   @05,3                                               1559 05799000
         L     @02,@PC00020+4                                      1559 05800000
         L     @02,M1PLST@(,@02)                                   1559 05801000
         AL    @02,@CF02695                                        1559 05802000
         LA    @05,ICTMODID(@05,@02)                               1559 05803000
         ST    @05,@AL00001+8                                      1559 05804000
         L     @05,CCADSAD(,CCAPTR)                                1559 05805000
         LA    @05,CCADSIDA+88(,@05)                               1559 05806000
         ST    @05,@AL00001+12                                     1559 05807000
         LA    @01,@AL00001                                        1559 05808000
         BAL   @14,M1MSG                                           1559 05809000
*                 RFY                                              1560 05810000
*                   RTNCODE RSTD;                                  1560 05811000
*                 M1PRC=MAX(M1PRC,RTNCODE);/* SAVE MAX RC            */ 05812000
         CR    M1PRC,RTNCODE                                       1561 05813000
         BNL   *+6                                                      05814000
         LR    M1PRC,RTNCODE                                       1561 05815000
*                 RFY                                              1562 05816000
*                   RTNCODE UNRSTD;                                1562 05817000
*                 MOD1ERR=ON;       /* ... WITH AN ERROR             */ 05818000
         OI    MOD1ERR,B'01000000'                                 1563 05819000
*               END;                                               1564 05820000
*             ELSE                  /* ALL IS WELL                   */ 05821000
*               DO;                                                1565 05822000
         B     @RC01557                                            1565 05823000
@RF01557 DS    0H                                                  1566 05824000
*                 ICTMIDPS(M1PX1)=ON;/* MID SATISFIED                */ 05825000
         LR    @05,M1PX1                                           1566 05826000
         SLA   @05,3                                               1566 05827000
         L     @02,@PC00020+4                                      1566 05828000
         L     @02,M1PLST@(,@02)                                   1566 05829000
         ALR   @02,@05                                             1566 05830000
         BCTR  @02,0                                               1566 05831000
         OI    ICTMIDPS-7(@02),B'01000000'                         1566 05832000
*               END;                                               1567 05833000
*           END;                                                   1568 05834000
*         ELSE                                                     1569 05835000
*           ;                       /* PRE/SUP RELATIONSHIP NOT FOUND*/ 05836000
@RF01554 DS    0H                                                  1570 05837000
*       END;                        /*                               */ 05838000
*     ELSE                                                         1571 05839000
*       ;                           /* SKIP THE FMID                 */ 05840000
@RF01551 DS    0H                                                  1572 05841000
*   END;                            /* END OF SEARCH LOOP            */ 05842000
@RC01551 AH    M1PX1,@CH00064                                      1572 05843000
@DE01550 L     @05,@PC00020                                        1572 05844000
         ICM   @02,15,M1PCICT@(@05)                                1572 05845000
         BZ    @DC01550                                            1572 05846000
         LR    @05,M1PX1                                           1572 05847000
         SLA   @05,3                                               1572 05848000
         L     @02,@PC00020+4                                      1572 05849000
         L     @02,M1PLST@(,@02)                                   1572 05850000
         AL    @02,@CF02695                                        1572 05851000
         L     @05,ICTMIDND(@05,@02)                               1572 05852000
         CL    @05,ICTENDIX                                        1572 05853000
         BNE   @DL01550                                            1572 05854000
@DC01550 DS    0H                                                  1573 05855000
*   RETURN CODE(M1PRC);             /* RETURN W/ RETURN CODE         */ 05856000
         LR    @15,M1PRC                                           1573 05857000
         L     @14,@SA00020                                        1573 05858000
         LM    @00,@12,@SA00020+8                                  1573 05859000
         BR    @14                                                 1573 05860000
*   END M1PRECK;                                                   1574 05861000
         EJECT                                                          05862000
*                                                                  1575 05863000
*   /*****************************************************************/ 05864000
*   /*                                                               */ 05865000
*   /* M1MSG -                                                       */ 05866000
*   /*                                                               */ 05867000
*   /*****************************************************************/ 05868000
*                                                                  1575 05869000
*M1MSG:                                                            1575 05870000
*   PROC(M1MTXT1,                   /* MODID TYPE TEXT               */ 05871000
*       M1MPART,                    /* PART NUMBER                   */ 05872000
*       M1MSMD,                     /* MODID SYSMOD NAME             */ 05873000
*       M1MDDN);                    /* 'SMPACDS' OR 'SMPCDS'         */ 05874000
M1MSG    STM   @14,@12,@SA00021                                    1575 05875000
         MVC   @PC00021(16),0(@01)                                 1575 05876000
*   DCL                                                            1576 05877000
*     M1MRC FIXED(15);              /* LOCAL RETURN CODE             */ 05878000
*   DCL                                                            1577 05879000
*     M1MTXT1 CHAR(8);              /* MODID TYPE TEXT:            1577 05880000
*                                      'FMID'|'RMID'|'UMID'          */ 05881000
*   DCL                                                            1578 05882000
*     M1MPART FIXED(31);            /* MESSAGE PART NUMBER           */ 05883000
*   DCL                                                            1579 05884000
*     M1MSMD CHAR(7);               /* MODID SYSMOD NAME THAT CAUSED    05885000
*                                      FAILURE                       */ 05886000
*   DCL                                                            1580 05887000
*     M1MDDN CHAR(8);               /* DDNAME OF LIST DS:          1580 05888000
*                                      'SMPCDS'|'SMPACDS'            */ 05889000
*   DCL                                                            1581 05890000
*     M1MIOPT FIXED(8);             /* IOPTYPE FOR ELEMENT           */ 05891000
*   DCL                                                            1582 05892000
*     M1MDUMMY FIXED(8);            /* DUMMY PARM FOR CNVTYP1 CALL   */ 05893000
*   RFY                                                            1583 05894000
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1583 05895000
*   RFY                                                            1584 05896000
*     ICTPTF BASED(ICTPPTR(1));                                    1584 05897000
*   M1MRC=ZERO;                     /* CLEAR RETURN CODE             */ 05898000
         SLR   M1MRC,M1MRC                                         1585 05899000
*   IF M1HEADER=OFF THEN            /* HEADER MESSAGE ISSUED?        */ 05900000
         TM    M1HEADER,B'00100000'                                1586 05901000
         BNZ   @RF01586                                            1586 05902000
*     DO;                           /* NO,                           */ 05903000
*                                                                  1587 05904000
*       /*************************************************************/ 05905000
*       /*                                                           */ 05906000
*       /* HMA382I ID CHECK ERROR PROCESSING SYSMOD SYSMOD XXXXXXX   */ 05907000
*       /* XXXXXXXX XXXXXXXX                                         */ 05908000
*       /*                                                           */ 05909000
*       /*************************************************************/ 05910000
*                                                                  1588 05911000
*       M1HEADER=ON;                /* HEADER ISSUED                 */ 05912000
         OI    M1HEADER,B'00100000'                                1588 05913000
*       HMASMMGP=HMASMMGP&&HMASMMGP;/* CLEAR PARM LIST               */ 05914000
         XC    HMASMMGP(32),HMASMMGP                               1589 05915000
*       MGPPRINT=ON;                /* ROUTE TO SMPOUT               */ 05916000
*       MGPHLDS=ON;                 /* ROUTE TO SMPLOG               */ 05917000
         OI    MGPPRINT,B'10010000'                                1591 05918000
*       MGPMGNO1=HMA382I;           /*                               */ 05919000
         MVC   MGPMGNO1(2),@CH02033                                1592 05920000
*       IF TBLBPID=ON THEN          /* BYPASS?                       */ 05921000
         L     @15,@PC00001                                        1593 05922000
         L     @01,TBLXTBL(,@15)                                   1593 05923000
         TM    TBLBPID(@01),B'10000000'                            1593 05924000
         BNO   @RF01593                                            1593 05925000
*         DO;                       /* YES,                          */ 05926000
*           MGPTYPE=MGPWARN;        /* SEVERITY IS WARNING           */ 05927000
         MVI   MGPTYPE,X'02'                                       1595 05928000
*           M1MRC=PTFWARN;          /* RC=4                          */ 05929000
         LA    M1MRC,4                                             1596 05930000
*           ICTBYP(1)=ON;           /* SYSMOD REQUIRED BYPASS TO BE     05931000
*                                      RESTORED                      */ 05932000
         L     @03,@PC00015                                        1597 05933000
         L     @03,ICTPPTR(,@03)                                   1597 05934000
         OI    ICTBYP(@03),B'00000010'                             1597 05935000
*         END;                                                     1598 05936000
*       ELSE                        /* NOT BYPASSED                  */ 05937000
*         DO;                       /* YES,                          */ 05938000
         B     @RC01593                                            1599 05939000
@RF01593 DS    0H                                                  1600 05940000
*           MGPTYPE=MGPERR;         /* SEVERITY IS ERROR             */ 05941000
         MVI   MGPTYPE,X'03'                                       1600 05942000
*           M1MRC=STOPSMD;          /* RC=8                          */ 05943000
         LA    M1MRC,8                                             1601 05944000
*         END;                                                     1602 05945000
*       MGPVARPT(1)=ADDR(ICTPTFS(1));/* SYSMOD NAME                  */ 05946000
@RC01593 L     @03,@PC00015                                        1603 05947000
         L     @01,ICTPPTR(,@03)                                   1603 05948000
         ST    @01,MGPVARPT                                        1603 05949000
*       CALL CNVTYP1(ICTMOD(1),     /* CONVERT MOD TYPE TO IOP       */ 05950000
*           M1MIOPT,                /* CDS ENTRY TYPE                */ 05951000
*           M1MDUMMY);              /*                               */ 05952000
*                                                                  1604 05953000
         MVC   @AL00001+4(8),@AL01604                              1604 05954000
         ST    @03,@AL00001                                        1604 05955000
         LA    @01,@AL00001                                        1604 05956000
         BAL   @14,CNVTYP1                                         1604 05957000
*       /*************************************************************/ 05958000
*       /*                                                           */ 05959000
*       /*                                                           */ 05960000
*       /*************************************************************/ 05961000
*                                                                  1605 05962000
*       MGPVARPT(2)=ADDR(CCATYPEA(M1MIOPT));/* ELEMENT TYPE TEXT     */ 05963000
         SLR   @03,@03                                             1605 05964000
         IC    @03,M1MIOPT                                         1605 05965000
         SLA   @03,3                                               1605 05966000
         L     @01,CCATPAD(,CCAPTR)                                1605 05967000
         AL    @01,@CF02695                                        1605 05968000
         LA    @03,CCATYPEA(@03,@01)                               1605 05969000
         ST    @03,MGPVARPT+4                                      1605 05970000
*       MGPVARPT(3)=ADDR(ICTMNAME(1));/* ELEMENT NAME                */ 05971000
         L     @03,@PC00015                                        1606 05972000
         ST    @03,MGPVARPT+8                                      1606 05973000
*       CALL HMASMMSG(HMASMMGP);                                   1607 05974000
         L     @15,@CV02018                                        1607 05975000
         LA    @01,@AL01607                                        1607 05976000
         BALR  @14,@15                                             1607 05977000
*     END;                                                         1608 05978000
*   ELSE                                                           1609 05979000
*     ;                             /* HEADER ALREADY ISSUED         */ 05980000
*                                                                  1609 05981000
@RF01586 DS    0H                                                  1610 05982000
*   /*****************************************************************/ 05983000
*   /*                                                               */ 05984000
*   /* HMA430I XXXXXXXX XXXXXXXX XXXXXXX ...                         */ 05985000
*   /*                                                               */ 05986000
*   /*****************************************************************/ 05987000
*                                                                  1610 05988000
*   HMASMMGP=HMASMMGP&&HMASMMGP;    /* CLEAR PARM LIST               */ 05989000
         XC    HMASMMGP(32),HMASMMGP                               1610 05990000
*   MGPPRINT=ON;                    /* ROUTE TO SMPOUT               */ 05991000
*   MGPHLDS=ON;                     /* ROUTE TO SMPLOG               */ 05992000
         OI    MGPPRINT,B'10010000'                                1612 05993000
*   MGPMGNO1=HMA430I;               /*                               */ 05994000
         MVC   MGPMGNO1(2),@CH02035                                1613 05995000
*   MGPMGNO2=M1MPART;               /* PART DESCRIBING THE THE ERROR */ 05996000
         L     @03,@PC00021+4                                      1614 05997000
         MVC   MGPMGNO2(2),M1MPART+2(@03)                          1614 05998000
*   MGPTYPE=MGPINFO;                /* SEVERITY IS INFO              */ 05999000
         MVI   MGPTYPE,X'01'                                       1615 06000000
*   MGPVARPT(1)=ADDR(M1MDDN);       /* DS SMPCDS|SMPACDS             */ 06001000
         L     @03,@PC00021+12                                     1616 06002000
         ST    @03,MGPVARPT                                        1616 06003000
*   MGPVARPT(2)=ADDR(M1MTXT1);      /* MODID TYPE FMID|RMID|UMID     */ 06004000
         L     @03,@PC00021                                        1617 06005000
         ST    @03,MGPVARPT+4                                      1617 06006000
*   MGPVARPT(3)=ADDR(M1MSMD);       /* SYSMOD NAME                   */ 06007000
         L     @03,@PC00021+8                                      1618 06008000
         ST    @03,MGPVARPT+8                                      1618 06009000
*   CALL HMASMMSG(HMASMMGP);                                       1619 06010000
         L     @15,@CV02018                                        1619 06011000
         LA    @01,@AL01619                                        1619 06012000
         BALR  @14,@15                                             1619 06013000
*   RETURN CODE(M1MRC);             /* RETURN W/ RETURN CODE         */ 06014000
         LR    @15,M1MRC                                           1620 06015000
         L     @14,@SA00021                                        1620 06016000
         LM    @00,@12,@SA00021+8                                  1620 06017000
         BR    @14                                                 1620 06018000
*   END M1MSG;                                                     1621 06019000
         EJECT                                                          06020000
*                                                                  1622 06021000
*/****************************************************************   */ 06022000
*/*                                                                  */ 06023000
*/* M1CDS -                                                          */ 06024000
*/* OUTPUT - ANSWER                                                  */ 06025000
*/*           - Y FOUND ON CDS AND OK - N NOT FOUND                  */ 06026000
*/*           - N NOT FOUND OR FOUND AND NOT OK                      */ 06027000
*/*           - R FOUND IN THE ICT I.E. TO BE RESTORED               */ 06028000
*/*        - PART                                                    */ 06029000
*/*          IF N                                                    */ 06030000
*/*           - PART099 - 'IS DELETED'                               */ 06031000
*/*           - PART100 - 'IS SUPERCEEDED'                           */ 06032000
*/*           - PART129 - 'IS NOT APPLIED'                           */ 06033000
*/*                                                                  */ 06034000
*/*          IF Y                                                    */ 06035000
*/*           - PART121 - 'IS APPLIED'                               */ 06036000
*/*          IF R                                                    */ 06037000
*/*           - PART122 - 'IS BEING RESTORED'                        */ 06038000
*/*                                                                  */ 06039000
*/****************************************************************   */ 06040000
*                                                                  1622 06041000
*M1CDS:                                                            1622 06042000
*   PROC(M1CSMD,                    /* CDS SYSMOD NAME               */ 06043000
*       M1CANS,                     /* (OUTPUT) ANSWER: Y, N, OR R   */ 06044000
*       M1CPART,                    /* MESSAGE PART CORRESPONDING TO    06045000
*                                      ANSWER                        */ 06046000
*       M1CICT@);                   /* (OUTPUT) ICT SYSMOD PTR       */ 06047000
M1CDS    STM   @14,@12,@SA00022                                    1622 06048000
         MVC   @PC00022(16),0(@01)                                 1622 06049000
*   DCL                                                            1623 06050000
*     M1CSMD CHAR(7);               /* SYSMOD NAME TO BE CHECKED     */ 06051000
*   DCL                                                            1624 06052000
*     M1CANS CHAR(1);               /* (OUTPUT) RESULT OF THE CHECK  */ 06053000
*   DCL                                                            1625 06054000
*     M1CPART FIXED(31);            /* (OUTPUT) MSG PART NUMBER      */ 06055000
*   DCL                                                            1626 06056000
*     M1CICT@ PTR(31);              /* (OUTPUT) ICT SMD ENTRY ADDR   */ 06057000
*   DCL                                                            1627 06058000
*     M1CRC FIXED(15);              /* LOCAL RETURN CODE             */ 06059000
*   RFY                                                            1628 06060000
*     TSLPARMS BASED(TBLXTSLP);                                    1628 06061000
*   RFY                                                            1629 06062000
*     HMASMIOP BASED(TBLXIOPF);     /* FIXED IOP                     */ 06063000
*   M1CRC=ZERO;                     /* CLEAR RETURN CODE             */ 06064000
         SLR   M1CRC,M1CRC                                         1630 06065000
*   M1CANS=YES;                     /* ASSUME ALL IS WELL            */ 06066000
         L     @03,@PC00022+4                                      1631 06067000
         MVI   M1CANS(@03),C'Y'                                    1631 06068000
*   M1CICT@=ZERO;                   /* CLEAR PTR TO ZERO             */ 06069000
         L     @03,@PC00022+12                                     1632 06070000
         SLR   @15,@15                                             1632 06071000
         ST    @15,M1CICT@(,@03)                                   1632 06072000
*   TSLSICDS=''B;                   /* CLEAR TSL                     */ 06073000
         L     @03,@PC00001                                        1633 06074000
         L     @03,TBLXTSLP(,@03)                                  1633 06075000
         L     @15,TSLPMLAD(,@03)                                  1633 06076000
         XC    TSLSICDS(20,@15),TSLSICDS(@15)                      1633 06077000
*   TSLFUNCT=TSLFICSR;              /* SEARCH ICT AND CDS ...        */ 06078000
         MVI   TSLFUNCT(@03),X'04'                                 1634 06079000
*   TSLSSMD=M1CSMD;                 /* ... THE CDS MODID SYSMOD      */ 06080000
         L     @14,@PC00022                                        1635 06081000
         MVC   TSLSSMD(7,@15),M1CSMD(@14)                          1635 06082000
*   TSLSOICT=ON;                    /* ...                           */ 06083000
*   TSLSOCDS=ON;                    /* ...                           */ 06084000
         OI    TSLSOICT(@15),B'11000000'                           1637 06085000
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */ 06086000
         ST    @03,@AL00001                                        1638 06087000
         L     @15,@CV02024                                        1638 06088000
         LA    @01,@AL00001                                        1638 06089000
         BALR  @14,@15                                             1638 06090000
*   IF TSLRETRN>ZERO THEN           /* OTHER THAN FOUND?             */ 06091000
         L     @03,@PC00001                                        1639 06092000
         L     @03,TBLXTSLP(,@03)                                  1639 06093000
         CLI   TSLRETRN(@03),0                                     1639 06094000
         BNH   @RF01639                                            1639 06095000
*     DO;                           /* YES,                          */ 06096000
*       IF TSLRETRN=TSLNTFND THEN   /* NOT FOUND?                    */ 06097000
         CLI   TSLRETRN(@03),4                                     1641 06098000
         BNE   @RF01641                                            1641 06099000
*         DO;                       /* YES,                          */ 06100000
*           M1CANS=NO;              /* MOD ID SYSMOD IS NOT FOUND IN    06101000
*                                      THE ICT OR CDS                */ 06102000
         L     @03,@PC00022+4                                      1643 06103000
         MVI   M1CANS(@03),C'N'                                    1643 06104000
*           M1CPART=PART129;        /* 'IS NOT APPLIED'              */ 06105000
         L     @03,@PC00022+8                                      1644 06106000
         MVC   M1CPART(4,@03),@CF02058                             1644 06107000
*         END;                                                     1645 06108000
*       ELSE                        /* ERROR                         */ 06109000
*         DO;                                                      1646 06110000
         B     @RC01641                                            1646 06111000
@RF01641 DS    0H                                                  1647 06112000
*           M1CRC=MAX(M1CRC,TSLRETRN);/* SET RETURN CODE             */ 06113000
         L     @03,@PC00001                                        1647 06114000
         L     @03,TBLXTSLP(,@03)                                  1647 06115000
         SLR   @15,@15                                             1647 06116000
         IC    @15,TSLRETRN(,@03)                                  1647 06117000
         CR    M1CRC,@15                                           1647 06118000
         BNL   *+6                                                      06119000
         LR    M1CRC,@15                                           1647 06120000
*         END;                                                     1648 06121000
*     END;                                                         1649 06122000
*   ELSE                            /* MODID SYSMOD FOUND IN THE ICT    06123000
*                                      OR CDS                        */ 06124000
*     DO;                                                          1650 06125000
         B     @RC01639                                            1650 06126000
@RF01639 DS    0H                                                  1651 06127000
*       IF TSLSIFND=ON THEN         /* FOUND IN THE ICT?             */ 06128000
         L     @03,@PC00001                                        1651 06129000
         L     @03,TBLXTSLP(,@03)                                  1651 06130000
         L     @03,TSLPMLAD(,@03)                                  1651 06131000
         TM    TSLSIFND(@03),B'10000000'                           1651 06132000
         BNO   @RF01651                                            1651 06133000
*         DO;                       /* YES                           */ 06134000
*           M1CPART=PART122;        /* 'IS BEING RESTORED'           */ 06135000
         L     @15,@PC00022+8                                      1653 06136000
         MVC   M1CPART(4,@15),@CF02045                             1653 06137000
*           M1CANS=RESTORE;         /* THE MODID SYSMOD IS BEING   1654 06138000
*                                      RESTORED                      */ 06139000
         L     @15,@PC00022+4                                      1654 06140000
         MVI   M1CANS(@15),C'R'                                    1654 06141000
*           M1CICT@=TSLSICTP;       /* RETURN ICT SMD ENTRY PTR      */ 06142000
         L     @15,@PC00022+12                                     1655 06143000
         MVC   M1CICT@(4,@15),TSLSICTP(@03)                        1655 06144000
*         END;                                                     1656 06145000
*       ELSE                        /* FOUND ON THE CDS              */ 06146000
*         DO;                                                      1657 06147000
         B     @RC01651                                            1657 06148000
@RF01651 DS    0H                                                  1658 06149000
*           IF TSLSCOK=ON           /* OK ON THE CDS                 */ 06150000
*               |TSLSCERR=ON THEN   /* OR IN ERROR                   */ 06151000
         L     @03,@PC00001                                        1658 06152000
         L     @03,TBLXTSLP(,@03)                                  1658 06153000
         L     @03,TSLPMLAD(,@03)                                  1658 06154000
         TM    TSLSCOK(@03),B'01000010'                            1658 06155000
         BZ    @RF01658                                            1658 06156000
*             DO;                   /* YES,                          */ 06157000
*               M1CANS=YES;         /*                               */ 06158000
         L     @03,@PC00022+4                                      1660 06159000
         MVI   M1CANS(@03),C'Y'                                    1660 06160000
*               M1CPART=PART121;    /* 'IS APPLIED'                  */ 06161000
         L     @03,@PC00022+8                                      1661 06162000
         MVC   M1CPART(4,@03),@CF02043                             1661 06163000
*             END;                                                 1662 06164000
*           ELSE                    /* ON CDS BUT NOT OK             */ 06165000
*             DO;                                                  1663 06166000
         B     @RC01658                                            1663 06167000
@RF01658 DS    0H                                                  1664 06168000
*               IF TSLSISUP=ON THEN /* IS IT SUP'ED                  */ 06169000
         L     @03,@PC00001                                        1664 06170000
         L     @03,TBLXTSLP(,@03)                                  1664 06171000
         L     @03,TSLPMLAD(,@03)                                  1664 06172000
         TM    TSLSISUP(@03),B'00100000'                           1664 06173000
         BNO   @RF01664                                            1664 06174000
*                 DO;               /* YES,                          */ 06175000
*                   M1CANS=NO;      /*                               */ 06176000
         L     @03,@PC00022+4                                      1666 06177000
         MVI   M1CANS(@03),C'N'                                    1666 06178000
*                   M1CPART=PART100;/* 'IS SUPERCEDED'               */ 06179000
         L     @03,@PC00022+8                                      1667 06180000
         MVC   M1CPART(4,@03),@CF00349                             1667 06181000
*                 END;                                             1668 06182000
*               ELSE                /*                               */ 06183000
*                 DO;                                              1669 06184000
         B     @RC01664                                            1669 06185000
@RF01664 DS    0H                                                  1670 06186000
*                   M1CANS=NO;      /*                               */ 06187000
         L     @03,@PC00022+4                                      1670 06188000
         MVI   M1CANS(@03),C'N'                                    1670 06189000
*                   M1CPART=PART099;/* 'IS DELETED'                  */ 06190000
         L     @03,@PC00022+8                                      1671 06191000
         MVC   M1CPART(4,@03),@CF02040                             1671 06192000
*                 END;                                             1672 06193000
*             END;                                                 1673 06194000
@RC01664 DS    0H                                                  1674 06195000
*         END;                                                     1674 06196000
@RC01658 DS    0H                                                  1675 06197000
*     END;                                                         1675 06198000
@RC01651 DS    0H                                                  1676 06199000
*   RETURN CODE(M1CRC);             /* RETURN W/ RETURN CODE         */ 06200000
@RC01639 LR    @15,M1CRC                                           1676 06201000
         L     @14,@SA00022                                        1676 06202000
         LM    @00,@12,@SA00022+8                                  1676 06203000
         BR    @14                                                 1676 06204000
*   RFY                                                            1677 06205000
*     TSLPARMS BASED;                                              1677 06206000
*   RFY                                                            1678 06207000
*     HMASMIOP BASED;                                              1678 06208000
*   END M1CDS;                                                     1679 06209000
         EJECT                                                          06210000
*                                                                  1680 06211000
*/****************************************************************   */ 06212000
*/*                                                                  */ 06213000
*/* M1ACDS -                                                         */ 06214000
*/* OUTPUT - ANSWER                                                  */ 06215000
*/*           - Y FOUND ON CDS AND OK - N NOT FOUND                  */ 06216000
*/*           - N NOT FOUND OR FOUND AND NOT OK                      */ 06217000
*/*           - R FOUND IN THE ICT I.E. TO BE RESTORED               */ 06218000
*/*        - PART                                                    */ 06219000
*/*          IF N                                                    */ 06220000
*/*           - PART099 - 'IS DELETED'                               */ 06221000
*/*           - PART100 - 'IS SUPERCEEDED'                           */ 06222000
*/*           - PART129 - 'IS NOT APPLIED'                           */ 06223000
*/*           - PART125 - 'IS ACCEPTED IN ERROR'                     */ 06224000
*/*           - PART126 - 'IS ACCEPTED BUT NOT APPLIED'              */ 06225000
*/*                                                                  */ 06226000
*/*          IF Y                                                    */ 06227000
*/*           - PART121 - 'IS APPLIED'                               */ 06228000
*/*                                                                  */ 06229000
*/****************************************************************   */ 06230000
*                                                                  1680 06231000
*M1ACDS:                                                           1680 06232000
*   PROC(M1ASMD,                    /*                               */ 06233000
*       M1AANS,                     /*                               */ 06234000
*       M1APART);                                                  1680 06235000
M1ACDS   STM   @14,@12,@SA00023                                    1680 06236000
         MVC   @PC00023(12),0(@01)                                 1680 06237000
*   DCL                                                            1681 06238000
*     M1ASMD CHAR(7);               /* SYSMOD TO CHECK               */ 06239000
*   DCL                                                            1682 06240000
*     M1AANS CHAR(1);               /* (OUTPUT) ANSWER               */ 06241000
*   DCL                                                            1683 06242000
*     M1APART FIXED(31);            /* (OUTPUT) PART NUMBER          */ 06243000
*   DCL                                                            1684 06244000
*     M1ARC FIXED(15);              /* LOCAL RETURN CODE             */ 06245000
*   DCL                                                            1685 06246000
*     1 D2RCRD BASED,               /* DELTA 2 RECORD                */ 06247000
*      2 D2RKEY,                    /* RECORD KEY                    */ 06248000
*       3 D2RSMD CHAR(7),           /* SYSMOD NAME                   */ 06249000
*      2 D2RDATA,                   /* DATA                          */ 06250000
*       3 D2RFLAGS,                 /* STATUS FLAGS                  */ 06251000
*         5 D2RFOK BIT(1),          /* NOT IN THE CDS BUT OK         */ 06252000
*         5 D2RFERR BIT(1),         /* IN ERROR                      */ 06253000
*         5 D2RFDEL BIT(1),         /* DELETED                       */ 06254000
*         5 * BIT(5);               /* UNUSED                        */ 06255000
*   RFY                                                            1686 06256000
*     HMASMGTP BASED(TBLXD2GT);                                    1686 06257000
*   RFY                                                            1687 06258000
*     D2RCRD BASED(GTPBUFAD);                                      1687 06259000
*   M1ARC=ZERO;                     /* CLEAR RETURN CODE             */ 06260000
         SLR   M1ARC,M1ARC                                         1688 06261000
*                                                                  1689 06262000
*   /*****************************************************************/ 06263000
*   /*                                                               */ 06264000
*   /* SEARCH THE DELTA 2 LIST                                       */ 06265000
*   /*                                                               */ 06266000
*   /*****************************************************************/ 06267000
*                                                                  1689 06268000
*   GTPFUNCT=GTPLOC;                /* LOCATE THE SYSMOD IN THE D2 1689 06269000
*                                      GTA FILE                      */ 06270000
         L     @03,@PC00001                                        1689 06271000
         L     @03,TBLXD2GT(,@03)                                  1689 06272000
         MVI   GTPFUNCT(@03),X'03'                                 1689 06273000
*   D2RSMD=M1ASMD;                  /* ...                           */ 06274000
         L     @01,GTPBUFAD(,@03)                                  1690 06275000
         L     @15,@PC00023                                        1690 06276000
         MVC   D2RSMD(7,@01),M1ASMD(@15)                           1690 06277000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 06278000
         ST    @03,@AL00001                                        1691 06279000
         L     @15,@CV02020                                        1691 06280000
         LA    @01,@AL00001                                        1691 06281000
         BALR  @14,@15                                             1691 06282000
*   IF GTPRETRN=GTPGOOD THEN        /* FOUND IN DELTA 2              */ 06283000
         L     @03,@PC00001                                        1692 06284000
         L     @03,TBLXD2GT(,@03)                                  1692 06285000
         CLI   GTPRETRN(@03),0                                     1692 06286000
         BNE   @RF01692                                            1692 06287000
*     DO;                           /* YES,                          */ 06288000
*       M1AANS=NO;                  /* ERROR                         */ 06289000
         L     @15,@PC00023+4                                      1694 06290000
         MVI   M1AANS(@15),C'N'                                    1694 06291000
*       IF D2RFOK=ON THEN           /* OK IN THE DELTA 2 LIST        */ 06292000
         L     @03,GTPBUFAD(,@03)                                  1695 06293000
         TM    D2RFOK(@03),B'10000000'                             1695 06294000
         BNO   @RF01695                                            1695 06295000
*         DO;                       /* YES,                          */ 06296000
*           M1APART=PART126;        /* 'IS ACCEPTED BUT NOT APPLIED' */ 06297000
         L     @03,@PC00023+8                                      1697 06298000
         MVC   M1APART(4,@03),@CF02052                             1697 06299000
*         END;                                                     1698 06300000
*       ELSE                        /* NOT OK ON THE ACDS            */ 06301000
*         DO;                       /* YES,                          */ 06302000
         B     @RC01695                                            1699 06303000
@RF01695 DS    0H                                                  1700 06304000
*           IF D2RFERR=ON THEN      /* IN ERROR ON THE ACDS          */ 06305000
         L     @03,@PC00001                                        1700 06306000
         L     @03,TBLXD2GT(,@03)                                  1700 06307000
         L     @03,GTPBUFAD(,@03)                                  1700 06308000
         TM    D2RFERR(@03),B'01000000'                            1700 06309000
         BNO   @RF01700                                            1700 06310000
*             DO;                   /* YES,                          */ 06311000
*               M1APART=PART125;    /* 'IS ACCEPTED IN ERROR'        */ 06312000
         L     @03,@PC00023+8                                      1702 06313000
         MVC   M1APART(4,@03),@CF01904                             1702 06314000
*             END;                                                 1703 06315000
*           ELSE                    /* NOT IN ERROR                  */ 06316000
*             DO;                   /* YES,                          */ 06317000
         B     @RC01700                                            1704 06318000
@RF01700 DS    0H                                                  1705 06319000
*               M1APART=PART099;    /* 'IS DELETED'                  */ 06320000
         L     @03,@PC00023+8                                      1705 06321000
         MVC   M1APART(4,@03),@CF02040                             1705 06322000
*             END;                                                 1706 06323000
*         END;                                                     1707 06324000
*     END;                                                         1708 06325000
*   ELSE                                                           1709 06326000
*     DO;                                                          1709 06327000
         B     @RC01692                                            1709 06328000
@RF01692 DS    0H                                                  1710 06329000
*       M1AANS=YES;                 /* OK ON THE ACDS                */ 06330000
         L     @03,@PC00023+4                                      1710 06331000
         MVI   M1AANS(@03),C'Y'                                    1710 06332000
*       M1APART=PART121;            /* 'IS APPLIED'                  */ 06333000
         L     @03,@PC00023+8                                      1711 06334000
         MVC   M1APART(4,@03),@CF02043                             1711 06335000
*     END;                                                         1712 06336000
*                                                                  1712 06337000
*   /*****************************************************************/ 06338000
*   /*                                                               */ 06339000
*   /*                                                               */ 06340000
*   /*****************************************************************/ 06341000
*                                                                  1713 06342000
*   RETURN CODE(M1ARC);             /* RETURN W/ RETURN CODE         */ 06343000
@RC01692 LR    @15,M1ARC                                           1713 06344000
         L     @14,@SA00023                                        1713 06345000
         LM    @00,@12,@SA00023+8                                  1713 06346000
         BR    @14                                                 1713 06347000
*   RFY                                                            1714 06348000
*     HMASMGTP BASED;                                              1714 06349000
*   RFY                                                            1715 06350000
*     D2RCRD BASED;                                                1715 06351000
*   END M1ACDS;                                                    1716 06352000
         EJECT                                                          06353000
*                                                                  1717 06354000
*/****************************************************************   */ 06355000
*/*                                                                  */ 06356000
*/* VRSCHECK - CHECK CDS FMID FOR VERSIONING                         */ 06357000
*/*                                                                  */ 06358000
*/* OUTPUT - ANSWER                                                  */ 06359000
*/*           - Y VERSIONING OCCURRED AND THEREFORE NO FMID ERROR    */ 06360000
*/*           - N VERSIONING DID NOT OCCURER                         */ 06361000
*/*                                                                  */ 06362000
*/****************************************************************   */ 06363000
*                                                                  1717 06364000
*VRSCHECK:                                                         1717 06365000
*   PROC(VRSCSMD,                   /*                               */ 06366000
*       VRSCELM,                    /*                               */ 06367000
*       VRSCANS);                                                  1717 06368000
VRSCHECK STM   @14,@12,@SA00024                                    1717 06369000
         MVC   @PC00024(12),0(@01)                                 1717 06370000
*   DCL                                                            1718 06371000
*     VRSCSMD CHAR(7);              /* SYSMOD TO CHECK               */ 06372000
*   DCL                                                            1719 06373000
*     VRSCELM CHAR(*);              /* ICT MOD ENTRY FOR ELEMENT     */ 06374000
*   DCL                                                            1720 06375000
*     VRSCANS CHAR(1);              /* (OUTPUT) ANSWER               */ 06376000
*   DCL                                                            1721 06377000
*     VRSCRC FIXED(15);             /* LOCAL RETURN CODE             */ 06378000
*   DCL                                                            1722 06379000
*     VRSDUMMY CHAR(1);             /* DUMMY PARM FOR CALL TO      1722 06380000
*                                      SUBROUTINE                    */ 06381000
*   RFY                                                            1723 06382000
*     ICTMOD BASED(ADDR(VRSCELM));                                 1723 06383000
*   VRSCRC=ZERO;                    /* CLEAR RETURN CODE             */ 06384000
         SLR   VRSCRC,VRSCRC                                       1724 06385000
*   VRSCANS=NO;                     /* ASSUME NOT VERSIONED ANSWER   */ 06386000
         L     @02,@PC00024+8                                      1725 06387000
         MVI   VRSCANS(@02),C'N'                                   1725 06388000
*   CALL SRHXRF(VRSCSMD,            /*                               */ 06389000
*       VRSCELM,                    /*                               */ 06390000
*       VRSDUMMY);                  /*                               */ 06391000
         L     @02,@PC00024                                        1726 06392000
         ST    @02,@AL00001                                        1726 06393000
         L     @02,@PC00024+4                                      1726 06394000
         ST    @02,@AL00001+4                                      1726 06395000
         LA    @02,VRSDUMMY                                        1726 06396000
         ST    @02,@AL00001+8                                      1726 06397000
         LA    @01,@AL00001                                        1726 06398000
         BAL   @14,SRHXRF                                          1726 06399000
*   RFY                                                            1727 06400000
*     RTNCODE RSTD;                                                1727 06401000
*   IF RTNCODE=IOPNTFND THEN        /* NOT FOUND?                    */ 06402000
         CH    RTNCODE,@CH00039                                    1728 06403000
         BNE   @RF01728                                            1728 06404000
*     DO;                           /* YES,                          */ 06405000
*       RFY                                                        1730 06406000
*         RTNCODE UNRSTD;                                          1730 06407000
*       VRSCANS=YES;                /* ELEMENT WAS VERSIONED         */ 06408000
         L     @02,@PC00024+8                                      1731 06409000
         MVI   VRSCANS(@02),C'Y'                                   1731 06410000
*     END;                          /*                               */ 06411000
*   ELSE                                                           1733 06412000
*     ;                             /*                               */ 06413000
@RF01728 DS    0H                                                  1734 06414000
*   RETURN CODE(VRSCRC);            /* RETURN W/ RETURN CODE         */ 06415000
         LR    @15,VRSCRC                                          1734 06416000
         L     @14,@SA00024                                        1734 06417000
         LM    @00,@12,@SA00024+8                                  1734 06418000
         BR    @14                                                 1734 06419000
*   RFY                                                            1735 06420000
*     ICTMOD BASED;                                                1735 06421000
*   END VRSCHECK;                                                  1736 06422000
         EJECT                                                          06423000
*                                                                  1737 06424000
*/****************************************************************   */ 06425000
*/*                                                                  */ 06426000
*/* REGRCHK - SEARCH XRF GTA FILE FOR ELEMENT FOR THAT SYSMOD        */ 06427000
*/*                                                                  */ 06428000
*/* OUTPUT - RETURN CODE                                             */ 06429000
*/*              0  - IS A REGRESSED ELEMENT IN THE SYSMOD           */ 06430000
*/*              4  - NOT A REGRESSED ELEMENT IN THE SYSMOD          */ 06431000
*/*                                                                  */ 06432000
*/****************************************************************   */ 06433000
*                                                                  1737 06434000
*REGRCHK:                                                          1737 06435000
*   PROC(REGRIOP,                   /*                               */ 06436000
*       REGRSMD,                    /*                               */ 06437000
*       REGRELM);                   /*                               */ 06438000
REGRCHK  STM   @14,@12,@SA00025                                    1737 06439000
         MVC   @PC00025(12),0(@01)                                 1737 06440000
*   DCL                                                            1738 06441000
*     REGRIOP CHAR(*);              /* EXTENDED IOP                  */ 06442000
*   DCL                                                            1739 06443000
*     REGRSMD CHAR(7);              /* SYSMOD TO CHECK               */ 06444000
*   DCL                                                            1740 06445000
*     REGRELM CHAR(*);              /* ICT MOD ENTRY FOR ELEMENT     */ 06446000
*   DCL                                                            1741 06447000
*     REGRRC FIXED(15);             /* LOCAL RETURN CODE             */ 06448000
*   DCL                                                            1742 06449000
*     REGRPIND FIXED(8);            /* IOPPIND VALUE FOR ELEMENT     */ 06450000
*   DCL                                                            1743 06451000
*     REGRX1 FIXED(31);             /* INDEX FOR IOP SUB-ENTRY SEARCH*/ 06452000
*   RFY                                                            1744 06453000
*     HMASMIOP BASED(ADDR(REGRIOP));                               1744 06454000
*   RFY                                                            1745 06455000
*     ICTMOD BASED(ADDR(REGRELM));                                 1745 06456000
*   REGRRC=IOPNTFND;                /* RC SET TO ASSUME NO REGRESS   */ 06457000
         LA    REGRRC,4                                            1746 06458000
*   CALL SRHXRF(REGRSMD,            /*                               */ 06459000
*       REGRELM,                    /*                               */ 06460000
*       REGRPIND);                  /*                               */ 06461000
         L     @03,@PC00025+4                                      1747 06462000
         ST    @03,@AL00001                                        1747 06463000
         L     @03,@PC00025+8                                      1747 06464000
         ST    @03,@AL00001+4                                      1747 06465000
         LA    @03,REGRPIND                                        1747 06466000
         ST    @03,@AL00001+8                                      1747 06467000
         LA    @01,@AL00001                                        1747 06468000
         BAL   @14,SRHXRF                                          1747 06469000
*   IF REGRPIND>IOPPREG THEN        /* A REGRESSED ENTRY?            */ 06470000
         CLI   REGRPIND,80                                         1748 06471000
         BNH   @RF01748                                            1748 06472000
*     DO;                           /* YES,                          */ 06473000
*       REGRRC=ZERO;                /* ELEMENT IS REGRESSED RC       */ 06474000
         SLR   REGRRC,REGRRC                                       1750 06475000
*     END;                                                         1751 06476000
*   ELSE                            /* NOT A REGRESSED ENTRY         */ 06477000
*     DO;                                                          1752 06478000
         B     @RC01748                                            1752 06479000
@RF01748 DS    0H                                                  1753 06480000
*       IF REGRPIND=IOPPASM         /* IS THE ENTRY TYPE ASSEMBLY ...*/ 06481000
*           &ICTMMOD(1)=ON          /* ... AND A MOD REPLACEMENT     */ 06482000
*           &ICTMASM(1)=OFF THEN    /* ...                           */ 06483000
         CLI   REGRPIND,8                                          1753 06484000
         BNE   @RF01753                                            1753 06485000
         L     @03,@PC00025+8                                      1753 06486000
         TM    ICTMMOD(@03),B'10000000'                            1753 06487000
         BNO   @RF01753                                            1753 06488000
         TM    ICTMASM(@03),B'01000000'                            1753 06489000
         BNZ   @RF01753                                            1753 06490000
*         DO;                       /* YES, THEN THERE MAY OR MAY NOT   06491000
*                                      BE A MOD ELEMENT IN THE SYSMOD   06492000
*                                      ENTRY                         */ 06493000
*           IOPDSID=IOPCDS;         /* LOCATE ...                    */ 06494000
         L     @03,@PC00025                                        1755 06495000
         MVI   IOPDSID(@03),X'02'                                  1755 06496000
*           IOPTYPE=IOPSMD;         /* ... SYSMOD ...                */ 06497000
         MVI   IOPTYPE(@03),X'0B'                                  1756 06498000
*           IOPNAME=REGRSMD;        /* ... SPECIFIED BY CALLER       */ 06499000
         MVI   IOPNAME+7(@03),C' '                                 1757 06500000
         L     @15,@PC00025+4                                      1757 06501000
         MVC   IOPNAME(7,@03),REGRSMD(@15)                         1757 06502000
*           CALL HMASMIO(HMASMIOP); /* ...                           */ 06503000
         ST    @03,@AL00001                                        1758 06504000
         L     @15,@CV02017                                        1758 06505000
         LA    @01,@AL00001                                        1758 06506000
         BALR  @14,@15                                             1758 06507000
*           IF IOPRETRN^=ZERO THEN  /* ERROR OCCURRED?               */ 06508000
         L     @03,@PC00025                                        1759 06509000
         CLI   IOPRETRN(@03),0                                     1759 06510000
         BE    @RF01759                                            1759 06511000
*             DO;                   /* YES,                          */ 06512000
*               REGRRC=MAX(REGRRC,IOPRETRN);/* SAVE RETURN CODE      */ 06513000
         SLR   @15,@15                                             1761 06514000
         IC    @15,IOPRETRN(,@03)                                  1761 06515000
         CR    REGRRC,@15                                          1761 06516000
         BNL   *+6                                                      06517000
         LR    REGRRC,@15                                          1761 06518000
*             END;                  /*                               */ 06519000
*           ELSE                    /*                               */ 06520000
*             DO;                                                  1763 06521000
         B     @RC01759                                            1763 06522000
@RF01759 DS    0H                                                  1764 06523000
*               DO REGRX1=1 BY 1    /* LOOP THRU ALL SYSMOD        1764 06524000
*                                      SUB-ENTRIES                   */ 06525000
*                     WHILE(IOPPTFND(REGRX1)^=IOPEOLST);           1764 06526000
         LA    REGRX1,1                                            1764 06527000
         B     @DE01764                                            1764 06528000
@DL01764 DS    0H                                                  1765 06529000
*                 IF IOPPIND(REGRX1)=IOPPRMOD/* REGRESSED MOD ...    */ 06530000
*                     &IOPPMODS(REGRX1)=ICTMNAME(1) THEN/* ... AND 1765 06531000
*                                      MATCH?                        */ 06532000
         LR    @15,REGRX1                                          1765 06533000
         MH    @15,@CH00035                                        1765 06534000
         L     @14,@PC00025                                        1765 06535000
         SLR   @07,@07                                             1765 06536000
         IC    @07,IOPPIND-9(@15,@14)                              1765 06537000
         CH    @07,@CH00599                                        1765 06538000
         BNE   @RF01765                                            1765 06539000
         L     @07,@PC00025+8                                      1765 06540000
         ALR   @14,@15                                             1765 06541000
         CLC   IOPPMODS-9(8,@14),ICTMNAME(@07)                     1765 06542000
         BNE   @RF01765                                            1765 06543000
*                   DO;             /* YES,                          */ 06544000
*                     REGRRC=ZERO;  /* INDICATE REGRESSION FOUND     */ 06545000
         SLR   REGRRC,REGRRC                                       1767 06546000
*                   END;            /*                               */ 06547000
*                 ELSE                                             1769 06548000
*                   ;               /* CONTINUE SEARCH               */ 06549000
@RF01765 DS    0H                                                  1770 06550000
*               END;                                               1770 06551000
         AH    REGRX1,@CH00064                                     1770 06552000
@DE01764 LR    @15,REGRX1                                          1770 06553000
         MH    @15,@CH00035                                        1770 06554000
         L     @14,@PC00025                                        1770 06555000
         SLR   @07,@07                                             1770 06556000
         IC    @07,IOPPTFND-9(@15,@14)                             1770 06557000
         CH    @07,@CH00707                                        1770 06558000
         BNE   @DL01764                                            1770 06559000
*             END;                                                 1771 06560000
*         END;                      /*                               */ 06561000
@RC01759 DS    0H                                                  1773 06562000
*     END;                                                         1773 06563000
@RF01753 DS    0H                                                  1774 06564000
*   RETURN CODE(REGRRC);            /* RETURN W/ RETURN CODE         */ 06565000
@RC01748 LR    @15,REGRRC                                          1774 06566000
         L     @14,@SA00025                                        1774 06567000
         LM    @00,@12,@SA00025+8                                  1774 06568000
         BR    @14                                                 1774 06569000
*   RFY                                                            1775 06570000
*     HMASMIOP BASED;                                              1775 06571000
*   RFY                                                            1776 06572000
*     ICTMOD BASED;                                                1776 06573000
*   END REGRCHK;                                                   1777 06574000
         EJECT                                                          06575000
*                                                                  1778 06576000
*/****************************************************************   */ 06577000
*/*                                                                  */ 06578000
*/* SRHXRF - SEARCH XRF GTA FILE FOR ELEMENT FOR THAT SYSMOD         */ 06579000
*/*                                                                  */ 06580000
*/* OUTPUT                                                           */ 06581000
*/*     RETURN CODES                                                 */ 06582000
*/*         0  - ELEMENT FOUND                                       */ 06583000
*/*         4  - ELEMENT NOT FOUND                                   */ 06584000
*/*     REGRESSION INDICATOR                                         */ 06585000
*/*         'R' - ELEMENT IS FOUND AND REGRESSED                     */ 06586000
*/*         ' ' - IS NOT REGRESSED                                   */ 06587000
*/*                                                                  */ 06588000
*/****************************************************************   */ 06589000
*                                                                  1778 06590000
*SRHXRF:                                                           1778 06591000
*   PROC(SRHXSMD,                   /*                               */ 06592000
*       SRHXELM,                    /*                               */ 06593000
*       SRHXPIND);                  /* OUTPUT IOPPIND VALUE FROM XRF    06594000
*                                      RECORD                        */ 06595000
SRHXRF   STM   @14,@12,@SA00026                                    1778 06596000
         MVC   @PC00026(12),0(@01)                                 1778 06597000
*   DCL                                                            1779 06598000
*     SRHXSMD CHAR(7);              /* SYSMOD TO CHECK               */ 06599000
*   DCL                                                            1780 06600000
*     SRHXELM CHAR(*);              /* ICT MOD ENTRY FOR ELEMENT     */ 06601000
*   DCL                                                            1781 06602000
*     SRHXPIND FIXED(8);            /* IOPPIND VALUE (OUTPUT)        */ 06603000
*   DCL                                                            1782 06604000
*     SRHXRC FIXED(15);             /* LOCAL RETURN CODE             */ 06605000
*   DCL                                                            1783 06606000
*     SRHXRFT FIXED(8);             /* XRF TYPE VALUE                */ 06607000
*   DCL                                                            1784 06608000
*     SRHXIOP CHAR(1);              /* IOPTYPE VALUE RETURNED BY   1784 06609000
*                                      CONVERT RTN                   */ 06610000
*   DCL                                                            1785 06611000
*     1 SRHXFLGS,                   /*                               */ 06612000
*       3 SRHXENDM BIT(1),          /* END OF ELEMENT IN THE GTA FLAG*/ 06613000
*       3 * BIT(7);                 /*                               */ 06614000
*   RFY                                                            1786 06615000
*     ICTMOD BASED(ADDR(SRHXELM));                                 1786 06616000
*   RFY                                                            1787 06617000
*     HMASMGTP BASED(ADDR(MXOUTGTP));                              1787 06618000
*   SRHXRC=IOPNTFND;                /* ASSUME ELEMENT NOT FOUND      */ 06619000
         LA    SRHXRC,4                                            1788 06620000
*   SRHXPIND=''B;                   /* ASSUME NO REGRESSION ELEMENT  */ 06621000
         L     @03,@PC00026+8                                      1789 06622000
         SLR   @15,@15                                             1789 06623000
         STC   @15,SRHXPIND(,@03)                                  1789 06624000
*   SRHXFLGS=''B;                   /* CLEAR LOCAL FLAGS             */ 06625000
         MVI   SRHXFLGS,X'00'                                      1790 06626000
*   GTPBUFAD=ADDR(XRFRCD);          /* INITIALIZE XRF GTP            */ 06627000
         LA    @03,MXOUTGTP                                        1791 06628000
         LA    @15,XRFRCD                                          1791 06629000
         ST    @15,GTPBUFAD(,@03)                                  1791 06630000
*   GTPKEYLN=LENGTH(XRFETYPE)       /* ...                           */ 06631000
*       +LENGTH(XRFENAME)+LENGTH(XRFRTYPE);/*                        */ 06632000
*                                                                  1792 06633000
         MVC   GTPKEYLN(2,@03),@CH00036                            1792 06634000
*   /*****************************************************************/ 06635000
*   /*                                                               */ 06636000
*   /* INITIALIZE AND POSITION TO 1ST XRF RECORD FOR CURRENT MOD     */ 06637000
*   /*                                                               */ 06638000
*   /*****************************************************************/ 06639000
*                                                                  1793 06640000
*   CALL CNVTYP1(ICTMOD(1),         /* CONVERT ICT TYPE TO IOPTYPE   */ 06641000
*       SRHXIOP,SRHXRFT);                                          1793 06642000
         MVC   @AL00001+4(8),@AL01793                              1793 06643000
         L     @03,@PC00026+4                                      1793 06644000
         ST    @03,@AL00001                                        1793 06645000
         LA    @01,@AL00001                                        1793 06646000
         BAL   @14,CNVTYP1                                         1793 06647000
*   XRFRCD=''B;                     /* CLEAR RECORD                  */ 06648000
         XC    XRFRCD(30),XRFRCD                                   1794 06649000
*   XRFETYPE=SRHXIOP;               /* SET TYPE ...                  */ 06650000
         MVC   XRFETYPE(1),SRHXIOP                                 1795 06651000
*   XRFENAME=ICTMNAME(1);           /* ... AND NAME                  */ 06652000
         L     @03,@PC00026+4                                      1796 06653000
         MVC   XRFENAME(8),ICTMNAME(@03)                           1796 06654000
*   XRFRTYPE=SRHXRFT;               /* XRF PTF BY TYPE               */ 06655000
         MVC   XRFRTYPE(1),SRHXRFT                                 1797 06656000
*   GTPFUNCT=GTPLOC;                /* LOCATE ...                    */ 06657000
         LA    @03,MXOUTGTP                                        1798 06658000
         MVI   GTPFUNCT(@03),X'03'                                 1798 06659000
*   CALL HMASMGTA(HMASMGTP);        /* ... FIRST RECORD FOR MOD      */ 06660000
         ST    @03,@AL00001                                        1799 06661000
         L     @15,@CV02020                                        1799 06662000
         LA    @01,@AL00001                                        1799 06663000
         BALR  @14,@15                                             1799 06664000
*   GTPFUNCT=GTPSTRTN;              /* POSITION ...                  */ 06665000
         LA    @03,MXOUTGTP                                        1800 06666000
         MVI   GTPFUNCT(@03),X'06'                                 1800 06667000
*   CALL HMASMGTA(HMASMGTP);        /* ... FOR GET NEXT              */ 06668000
         ST    @03,@AL00001                                        1801 06669000
         L     @15,@CV02020                                        1801 06670000
         LA    @01,@AL00001                                        1801 06671000
         BALR  @14,@15                                             1801 06672000
*   SRHXENDM=OFF;                   /* CLEAR END OF MOD FLAG         */ 06673000
         NI    SRHXENDM,B'01111111'                                1802 06674000
*   GTPFUNCT=GTPGETN;               /* SET FUNCTION FOR GET NEXT     */ 06675000
*                                                                  1803 06676000
         LA    @03,MXOUTGTP                                        1803 06677000
         MVI   GTPFUNCT(@03),X'08'                                 1803 06678000
*   /*****************************************************************/ 06679000
*   /*                                                               */ 06680000
*   /* LOOP THRU ALL RECORDS IN THE GTA WITH SAME NAME AND TYPE AS   */ 06681000
*   /* SPECIFIED IN THE INPUT. THE LOOP SEARCHES FOR A RECORD FOR THE*/ 06682000
*   /* SYSMOD NAME SPECIFIED BY THE CALLER.                          */ 06683000
*   /*                                                               */ 06684000
*   /*****************************************************************/ 06685000
*                                                                  1804 06686000
*   DO WHILE(SRHXENDM=OFF           /*                               */ 06687000
*         &SRHXRC<STOPSMD);         /*                               */ 06688000
         B     @DE01804                                            1804 06689000
@DL01804 DS    0H                                                  1805 06690000
*     CALL HMASMGTA(HMASMGTP);      /* ... FOR GET NEXT              */ 06691000
         LA    @03,MXOUTGTP                                        1805 06692000
         ST    @03,@AL00001                                        1805 06693000
         L     @15,@CV02020                                        1805 06694000
         LA    @01,@AL00001                                        1805 06695000
         BALR  @14,@15                                             1805 06696000
*     IF GTPRETRN^=ZERO THEN        /* NON-ZERO RETURN CODE?         */ 06697000
         LA    @03,MXOUTGTP                                        1806 06698000
         CLI   GTPRETRN(@03),0                                     1806 06699000
         BE    @RF01806                                            1806 06700000
*       DO;                         /* YES,                          */ 06701000
*         SRHXENDM=ON;              /* END OF MOD                    */ 06702000
         OI    SRHXENDM,B'10000000'                                1808 06703000
*         IF GTPRETRN^=GTPEOF THEN  /* RC IS OTHER THAN EOF?         */ 06704000
         CLI   GTPRETRN(@03),4                                     1809 06705000
         BE    @RF01809                                            1809 06706000
*           DO;                     /*                               */ 06707000
*             SRHXRC=MAX(SRHXRC,GTPRETRN);/* SET RETURN CODE         */ 06708000
         SLR   @15,@15                                             1811 06709000
         IC    @15,GTPRETRN(,@03)                                  1811 06710000
         CR    SRHXRC,@15                                          1811 06711000
         BNL   *+6                                                      06712000
         LR    SRHXRC,@15                                          1811 06713000
*           END;                                                   1812 06714000
*       END;                                                       1813 06715000
*     ELSE                          /* RECORD FOUND IN THE GTA       */ 06716000
*       DO;                                                        1814 06717000
         B     @RC01806                                            1814 06718000
@RF01806 DS    0H                                                  1815 06719000
*         IF XRFETYPE^=SRHXIOP      /* DIFFERENT TYPE ...            */ 06720000
*             |XRFENAME^=ICTMNAME(1) THEN/* ... OR ELEMENT?          */ 06721000
         CLC   XRFETYPE(1),SRHXIOP                                 1815 06722000
         BNE   @RT01815                                            1815 06723000
         L     @03,@PC00026+4                                      1815 06724000
         CLC   XRFENAME(8),ICTMNAME(@03)                           1815 06725000
         BE    @RF01815                                            1815 06726000
@RT01815 DS    0H                                                  1816 06727000
*           DO;                     /*                               */ 06728000
*             SRHXENDM=ON;          /* SIGNAL END OF ELEMENTS IN THE    06729000
*                                      GTP                           */ 06730000
         OI    SRHXENDM,B'10000000'                                1817 06731000
*           END;                    /*                               */ 06732000
*         ELSE                      /* RECORD FOR CURRENT ELEMENT    */ 06733000
*           DO;                                                    1819 06734000
         B     @RC01815                                            1819 06735000
@RF01815 DS    0H                                                  1820 06736000
*             IF XRF3PTF=SRHXSMD THEN/* IS RECORD FOR CORRECT SYSMOD */ 06737000
         L     @03,@PC00026                                        1820 06738000
         CLC   XRF3PTF(7),SRHXSMD(@03)                             1820 06739000
         BNE   @RF01820                                            1820 06740000
*               DO;                 /* YES,                          */ 06741000
*                 SRHXRC=ZERO;      /* INDICATE MATCHING ENTRY FOUND */ 06742000
         SLR   SRHXRC,SRHXRC                                       1822 06743000
*                 SRHXPIND=XRF3PIND;/* RETURN THE IOPPIND TO CALLER  */ 06744000
         L     @03,@PC00026+8                                      1823 06745000
         MVC   SRHXPIND(1,@03),XRF3PIND                            1823 06746000
*               END;                /*                               */ 06747000
*             ELSE                                                 1825 06748000
*               ;                   /* MATCHING ELEMENT BUT DIFFERNT    06749000
*                                      SYSMOD                        */ 06750000
@RF01820 DS    0H                                                  1826 06751000
*           END;                                                   1826 06752000
*       END;                                                       1827 06753000
@RC01815 DS    0H                                                  1828 06754000
*   END;                            /*                               */ 06755000
@RC01806 DS    0H                                                  1828 06756000
@DE01804 TM    SRHXENDM,B'10000000'                                1828 06757000
         BNZ   @DC01804                                            1828 06758000
         CH    SRHXRC,@CH00034                                     1828 06759000
         BL    @DL01804                                            1828 06760000
@DC01804 DS    0H                                                  1829 06761000
*   RETURN CODE(SRHXRC);            /* RETURN W/ RETURN CODE         */ 06762000
         LR    @15,SRHXRC                                          1829 06763000
         L     @14,@SA00026                                        1829 06764000
         LM    @00,@12,@SA00026+8                                  1829 06765000
         BR    @14                                                 1829 06766000
*   RFY                                                            1830 06767000
*     ICTMOD BASED;                                                1830 06768000
*   END SRHXRF;                                                    1831 06769000
*   END MODID1CK;                                                  1832 06770000
*   END MODIDCHK;                                                  1833 06771000
         EJECT                                                          06772000
*                                                                  1834 06773000
*   /*****************************************************************/ 06774000
*   /*                                                               */ 06775000
*   /* TRMCLEAN -                                                    */ 06776000
*   /*                                                               */ 06777000
*   /*****************************************************************/ 06778000
*                                                                  1834 06779000
*TRMCLEAN:                                                         1834 06780000
*   PROC;                                                          1834 06781000
TRMCLEAN STM   @14,@12,@SA00027                                    1834 06782000
*   DCL                                                            1835 06783000
*     TRMCRC FIXED(15);             /* LOCAL RETURN CODE             */ 06784000
*   TRMCRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 06785000
         SLR   TRMCRC,TRMCRC                                       1836 06786000
*                                                                  1837 06787000
*   /*****************************************************************/ 06788000
*   /*                                                               */ 06789000
*   /* FREE LOCAL GTA FILES - XRF SELECT FILE AND XRF OUTPUT FILE    */ 06790000
*   /*                                                               */ 06791000
*   /*****************************************************************/ 06792000
*                                                                  1837 06793000
*   RFY                                                            1837 06794000
*     HMASMGTP BASED(ADDR(MXOUTGTP));                              1837 06795000
*   GTPFUNCT=GTPFREE;               /* FREE THE GTA FILE             */ 06796000
         LA    @03,MXOUTGTP                                        1838 06797000
         MVI   GTPFUNCT(@03),X'0A'                                 1838 06798000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 06799000
         ST    @03,@AL00001                                        1839 06800000
         L     @15,@CV02020                                        1839 06801000
         LA    @01,@AL00001                                        1839 06802000
         BALR  @14,@15                                             1839 06803000
*   RFY                                                            1840 06804000
*     HMASMGTP BASED(ADDR(MSELGTP));                               1840 06805000
*   GTPFUNCT=GTPFREE;               /* FREE THE GTA FILE             */ 06806000
         LA    @03,MSELGTP                                         1841 06807000
         MVI   GTPFUNCT(@03),X'0A'                                 1841 06808000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 06809000
         ST    @03,@AL00001                                        1842 06810000
         L     @15,@CV02020                                        1842 06811000
         LA    @01,@AL00001                                        1842 06812000
         BALR  @14,@15                                             1842 06813000
*   RFY                                                            1843 06814000
*     HMASMGTP BASED;                                              1843 06815000
*   RFY                                                            1844 06816000
*     HMASMGTP BASED(ADDR(ASMGTP));                                1844 06817000
*   GTPFUNCT=GTPFREE;               /* FREE THE GTA FILE             */ 06818000
         LA    @03,ASMGTP                                          1845 06819000
         MVI   GTPFUNCT(@03),X'0A'                                 1845 06820000
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */ 06821000
         ST    @03,@AL00001                                        1846 06822000
         L     @15,@CV02020                                        1846 06823000
         LA    @01,@AL00001                                        1846 06824000
         BALR  @14,@15                                             1846 06825000
*   RFY                                                            1847 06826000
*     HMASMGTP BASED;                                              1847 06827000
*   RETURN CODE(TRMCRC);            /* RETURN W/RC SET               */ 06828000
         LR    @15,TRMCRC                                          1848 06829000
         L     @14,@SA00027                                        1848 06830000
         LM    @00,@12,@SA00027+8                                  1848 06831000
         BR    @14                                                 1848 06832000
*   END TRMCLEAN;                                                  1849 06833000
         EJECT                                                          06834000
*                                                                  1850 06835000
*/********************************************************************/ 06836000
*/*                                                                  */ 06837000
*/* CNVTYP1 -                                                        */ 06838000
*/*                                                                  */ 06839000
*/* INPUT:                                                           */ 06840000
*/*   ICT MOD ENTRY TYPE FLAGS                                       */ 06841000
*/*                                                                  */ 06842000
*/* OUTPUT                                                           */ 06843000
*/*   - IOP CDS ENTRY TYPE INDICATOR                                 */ 06844000
*/*   - XRF ENTRY TYPE                                               */ 06845000
*/*                                                                  */ 06846000
*/*                                                                  */ 06847000
*/********************************************************************/ 06848000
*                                                                  1850 06849000
*CNVTYP1:                                                          1850 06850000
*   PROC(CNV1ENT,                   /* ICT MOD ENTRY FOR WHICH     1850 06851000
*                                      CONVERTED TYPES WILL BE     1850 06852000
*                                      RETURNED                      */ 06853000
*       CNV1IOPT,                   /* (OUTPUT) FIXED(8) IOP TYPE FOR   06854000
*                                      ICT ENTRY                     */ 06855000
*       CNV1XRFT);                  /* (OUTPUT) FIXED(8) XRF TYPE FOR   06856000
*                                      ICT ENTRY                     */ 06857000
CNVTYP1  STM   @14,@12,12(@13)                                     1850 06858000
         MVC   @PC00028(12),0(@01)                                 1850 06859000
*   DCL                                                            1851 06860000
*     CNV1ENT CHAR(*);              /* ICT MOD ENTRY TO PROCESS      */ 06861000
*   DCL                                                            1852 06862000
*     CNV1IOPT FIXED(8);            /* IOPTYPE ENTRY TYPE            */ 06863000
*   DCL                                                            1853 06864000
*     CNV1XRFT FIXED(8);            /* XRFRTYPE ENTRY TYPE           */ 06865000
*   DCL                                                            1854 06866000
*     CNV1RC FIXED(15);             /* LOCAL RETURN CODE             */ 06867000
*   CNV1IOPT=ZERO;                  /*                               */ 06868000
         L     @03,@PC00028+4                                      1855 06869000
         MVI   CNV1IOPT(@03),X'00'                                 1855 06870000
*   CNV1XRFT=ZERO;                  /*                               */ 06871000
         L     @15,@PC00028+8                                      1856 06872000
         MVI   CNV1XRFT(@15),X'00'                                 1856 06873000
*   RFY                                                            1857 06874000
*     ICTMOD BASED(ADDR(CNV1ENT));                                 1857 06875000
*   CNV1RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 06876000
         SLR   CNV1RC,CNV1RC                                       1858 06877000
*   IF ICTMMOD(1)=ON THEN           /* ICT MOD TYPE?                 */ 06878000
         L     @14,@PC00028                                        1859 06879000
         TM    ICTMMOD(@14),B'10000000'                            1859 06880000
         BNO   @RF01859                                            1859 06881000
*     DO;                           /* YES,                          */ 06882000
*       CNV1XRFT=XRFPBYMD;          /* XRF TYPE IS PTF HISTORY FOR 1861 06883000
*                                      MOD                           */ 06884000
         MVI   CNV1XRFT(@15),X'2F'                                 1861 06885000
*       IF ICTMASM(1)=ON THEN       /* ICT MOD TO BE ASSEMBLED       */ 06886000
         TM    ICTMASM(@14),B'01000000'                            1862 06887000
         BNO   @RF01862                                            1862 06888000
*         DO;                       /* YES,                          */ 06889000
*           CNV1IOPT=IOPMOD;        /* IOP TYPE IS MOD               */ 06890000
         MVI   CNV1IOPT(@03),X'05'                                 1864 06891000
*         END;                                                     1865 06892000
*       ELSE                        /* IS A MOD                      */ 06893000
*         DO;                                                      1866 06894000
         B     @RC01862                                            1866 06895000
@RF01862 DS    0H                                                  1867 06896000
*           CNV1IOPT=IOPMOD;        /* IOP TYPE IS MOD               */ 06897000
         L     @03,@PC00028+4                                      1867 06898000
         MVI   CNV1IOPT(@03),X'05'                                 1867 06899000
*         END;                                                     1868 06900000
*     END;                                                         1869 06901000
*   ELSE                                                           1870 06902000
*     IF ICTMMACR(1)=ON THEN        /* ICT MAC TYPE?                 */ 06903000
         B     @RC01859                                            1870 06904000
@RF01859 L     @03,@PC00028                                        1870 06905000
         TM    ICTMMACR(@03),B'00001000'                           1870 06906000
         BNO   @RF01870                                            1870 06907000
*       DO;                         /* YES,                          */ 06908000
*         CNV1IOPT=IOPMAC;          /* IOP TYPE IS MACRO             */ 06909000
         L     @03,@PC00028+4                                      1872 06910000
         MVI   CNV1IOPT(@03),X'03'                                 1872 06911000
*         CNV1XRFT=XRFPBYMC;        /* XRF TYPE IS PTF HISTORY FOR 1873 06912000
*                                      MACRO                         */ 06913000
         L     @03,@PC00028+8                                      1873 06914000
         MVI   CNV1XRFT(@03),X'25'                                 1873 06915000
*       END;                                                       1874 06916000
*     ELSE                                                         1875 06917000
*       IF ICTMSRCR(1)=ON THEN      /* ICT SRC TYPE?                 */ 06918000
         B     @RC01870                                            1875 06919000
@RF01870 L     @03,@PC00028                                        1875 06920000
         TM    ICTMSRCR(@03),B'00000010'                           1875 06921000
         BNO   @RF01875                                            1875 06922000
*         DO;                       /* YES,                          */ 06923000
*           CNV1IOPT=IOPSRC;        /* IOP TYPE IS SOURCE            */ 06924000
         L     @03,@PC00028+4                                      1877 06925000
         MVI   CNV1IOPT(@03),X'08'                                 1877 06926000
*           CNV1XRFT=XRFPBYSC;      /* XRF TYPE IS PTF HISTORY FOR 1878 06927000
*                                      SOURCE                        */ 06928000
         L     @03,@PC00028+8                                      1878 06929000
         MVI   CNV1XRFT(@03),X'39'                                 1878 06930000
*         END;                                                     1879 06931000
*       ELSE                                                       1880 06932000
*         ;                                                        1880 06933000
@RF01875 DS    0H                                                  1881 06934000
*   RETURN CODE(CNV1RC);            /* RETURN W/RC SET               */ 06935000
@RC01870 DS    0H                                                  1881 06936000
@RC01859 LR    @15,CNV1RC                                          1881 06937000
         L     @14,12(,@13)                                        1881 06938000
         LM    @00,@12,20(@13)                                     1881 06939000
         BR    @14                                                 1881 06940000
*   END CNVTYP1;                                                   1882 06941000
         EJECT                                                          06942000
*                                                                  1883 06943000
*/********************************************************************/ 06944000
*/*                                                                  */ 06945000
*/* CNVTYP2 -                                                        */ 06946000
*/*                                                                  */ 06947000
*/* INPUT:                                                           */ 06948000
*/*   ICT MOD ENTRY TYPE FLAGS                                       */ 06949000
*/*                                                                  */ 06950000
*/* OUTPUT                                                           */ 06951000
*/*   - SELECT LIST ENTRY TYPE FOR XRF CALL                          */ 06952000
*/*                                                                  */ 06953000
*/*                                                                  */ 06954000
*/********************************************************************/ 06955000
*                                                                  1883 06956000
*CNVTYP2:                                                          1883 06957000
*   PROC(CNV2ENT,                   /* ICT MOD ENTRY FOR WHICH     1883 06958000
*                                      CONVERTED TYPES WILL BE     1883 06959000
*                                      RETURNED                      */ 06960000
*       CNV2SELT);                  /* (OUTPUT) FIXED(8) XRF SELECT     06961000
*                                      LIST TYPE FOR ICT ENTRY       */ 06962000
CNVTYP2  STM   @14,@12,12(@13)                                     1883 06963000
         MVC   @PC00029(8),0(@01)                                  1883 06964000
*   DCL                                                            1884 06965000
*     CNV2ENT CHAR(*);              /* ICT MOD ENTRY TO PROCESS      */ 06966000
*   DCL                                                            1885 06967000
*     CNV2SELT FIXED(16);           /* XRF SELECT LIST TYPE          */ 06968000
*   DCL                                                            1886 06969000
*     CNV2RC FIXED(15);             /* LOCAL RETURN CODE             */ 06970000
*   CNV2SELT=ZERO;                  /*                               */ 06971000
         L     @03,@PC00029+4                                      1887 06972000
         SLR   @15,@15                                             1887 06973000
         STH   @15,CNV2SELT(,@03)                                  1887 06974000
*   RFY                                                            1888 06975000
*     ICTMOD BASED(ADDR(CNV2ENT));                                 1888 06976000
*   RFY                                                            1889 06977000
*     HMASMSET BASED(ADDR(CNV2SELT));                              1889 06978000
*   CNV2RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 06979000
         SLR   CNV2RC,CNV2RC                                       1890 06980000
*   IF ICTMMOD(1)=ON THEN           /* ICT MOD TYPE?                 */ 06981000
         L     @15,@PC00029                                        1891 06982000
         TM    ICTMMOD(@15),B'10000000'                            1891 06983000
         BNO   @RF01891                                            1891 06984000
*     DO;                           /* YES,                          */ 06985000
*       IF ICTMASM(1)=ON THEN       /* ICT ASM TYPE?                 */ 06986000
         TM    ICTMASM(@15),B'01000000'                            1893 06987000
         BNO   @RF01893                                            1893 06988000
*         DO;                       /* YES,                          */ 06989000
*           SEASM=ON;               /* SELECT LIST TYPE FOR XRF IS 1895 06990000
*                                      ASSEMBLY                      */ 06991000
         OI    SEASM(@03),B'00000100'                              1895 06992000
*         END;                                                     1896 06993000
*       ELSE                        /* NOT ASSEM, IS MOD             */ 06994000
*         DO;                       /* YES,                          */ 06995000
         B     @RC01893                                            1897 06996000
@RF01893 DS    0H                                                  1898 06997000
*           SEMOD=ON;               /* SELECT LIST TYPE FOR XRF IS 1898 06998000
*                                      MOD                           */ 06999000
         L     @03,@PC00029+4                                      1898 07000000
         OI    SEMOD(@03),B'00100000'                              1898 07001000
*         END;                      /*                               */ 07002000
*     END;                                                         1900 07003000
*   ELSE                                                           1901 07004000
*     IF ICTMMACR(1)=ON THEN        /* ICT MAC TYPE?                 */ 07005000
         B     @RC01891                                            1901 07006000
@RF01891 L     @03,@PC00029                                        1901 07007000
         TM    ICTMMACR(@03),B'00001000'                           1901 07008000
         BNO   @RF01901                                            1901 07009000
*       DO;                         /* YES,                          */ 07010000
*         SEMAC=ON;                 /* SELECT LIST TYPE FOR XRF IS 1903 07011000
*                                      MACRO                         */ 07012000
         L     @03,@PC00029+4                                      1903 07013000
         OI    SEMAC(@03),B'00010000'                              1903 07014000
*       END;                                                       1904 07015000
*     ELSE                                                         1905 07016000
*       IF ICTMSRCR(1)=ON THEN      /* ICT SRC TYPE?                 */ 07017000
         B     @RC01901                                            1905 07018000
@RF01901 L     @03,@PC00029                                        1905 07019000
         TM    ICTMSRCR(@03),B'00000010'                           1905 07020000
         BNO   @RF01905                                            1905 07021000
*         DO;                       /* YES,                          */ 07022000
*           SESRC=ON;               /* SLECT LIST TYPE FOR XRF IS  1907 07023000
*                                      SOURCE                        */ 07024000
         L     @03,@PC00029+4                                      1907 07025000
         OI    SESRC(@03),B'10000000'                              1907 07026000
*         END;                                                     1908 07027000
*       ELSE                                                       1909 07028000
*         ;                                                        1909 07029000
@RF01905 DS    0H                                                  1910 07030000
*   RETURN CODE(CNV2RC);            /* RETURN W/RC SET               */ 07031000
@RC01901 DS    0H                                                  1910 07032000
@RC01891 LR    @15,CNV2RC                                          1910 07033000
         L     @14,12(,@13)                                        1910 07034000
         LM    @00,@12,20(@13)                                     1910 07035000
         BR    @14                                                 1910 07036000
*   END CNVTYP2;                                                   1911 07037000
         EJECT                                                          07038000
*                                                                  1912 07039000
*/********************************************************************/ 07040000
*/*                                                                  */ 07041000
*/* CNVTYP3 -                                                        */ 07042000
*/*                                                                  */ 07043000
*/* INPUT:                                                           */ 07044000
*/*   - IOPPIND TYPE FLAG                                            */ 07045000
*/*                                                                  */ 07046000
*/* OUTPUT                                                           */ 07047000
*/*   - ICT MOD ENTRY TYPE IN ICTMFLG1 FORMAT OR ZERO IF NOT AN      */ 07048000
*/*     ELEMENT TYPE                                                 */ 07049000
*/*                                                                  */ 07050000
*/********************************************************************/ 07051000
*                                                                  1912 07052000
*CNVTYP3:                                                          1912 07053000
*   PROC(CNV3IND,                   /* SYSMOD IOPPIND ENTRY TYPE   1912 07054000
*                                      RETURNED (FIXED(8))           */ 07055000
*       CNV3ITYP);                  /* (OUTPUT) FIXED(8) ICT MOD TYPE   07056000
*                                      IN ICTMFLG1 FORMAT            */ 07057000
CNVTYP3  STM   @14,@12,12(@13)                                     1912 07058000
         MVC   @PC00030(8),0(@01)                                  1912 07059000
*   DCL                                                            1913 07060000
*     CNV3IND FIXED(8);             /* IOPPIND ENTRY TYPE            */ 07061000
*   DCL                                                            1914 07062000
*     CNV3ITYP FIXED(8);            /* ICT TYPE                      */ 07063000
*   DCL                                                            1915 07064000
*     CNV3RC FIXED(15);             /* LOCAL RETURN CODE             */ 07065000
*   DCL                                                            1916 07066000
*     FLG1OFFS FIXED(15);           /* OFFSET OF ICTMFLG1 IN ICTMOD     07067000
*                                      ENTRY                         */ 07068000
*   DCL                                                            1917 07069000
*     CNV3TYP FIXED(8);             /* IOPPIND ENTRY AFTER CORRECTION   07070000
*                                      FOR REGRESSION TYPES          */ 07071000
*   RFY                                                            1918 07072000
*     ICTMOD BASED(CCAICMOD);                                      1918 07073000
*   FLG1OFFS=ADDR(ICTMFLG1(1))-ADDR(ICTMOD(1));                    1919 07074000
         L     @05,CCAICMOD(,CCAPTR)                               1919 07075000
         LA    FLG1OFFS,ICTMFLG1(,@05)                             1919 07076000
         SLR   FLG1OFFS,@05                                        1919 07077000
*   RFY                                                            1920 07078000
*     ICTMOD BASED(ADDR(CNV3ITYP)-FLG1OFFS);                       1920 07079000
*   CNV3RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */ 07080000
         SLR   CNV3RC,CNV3RC                                       1921 07081000
*   CNV3ITYP=ZERO;                  /* CLEAR ICT MOD TYPE OUTPUT   1922 07082000
*                                      FIELD                         */ 07083000
         L     @05,@PC00030+4                                      1922 07084000
         MVI   CNV3ITYP(@05),X'00'                                 1922 07085000
*   CNV3TYP=CNV3IND;                /* ASUME IOPPIND IS NOT REGRSSION*/ 07086000
         L     @05,@PC00030                                        1923 07087000
         SLR   CNV3TYP,CNV3TYP                                     1923 07088000
         IC    CNV3TYP,CNV3IND(,@05)                               1923 07089000
*   IF CNV3TYP>IOPPREG THEN         /* IS TYPE POSSIBLY A REGRESSION    07090000
*                                      TYPE ELEMENT ENTRY?           */ 07091000
         LA    @05,80                                              1924 07092000
         CR    CNV3TYP,@05                                         1924 07093000
         BNH   @RF01924                                            1924 07094000
*     DO;                           /* YES,                          */ 07095000
*       CNV3TYP=CNV3TYP-IOPPREG;    /* CLEAR REGRESSION INDICATOR    */ 07096000
         SLR   CNV3TYP,@05                                         1926 07097000
*     END;                          /*                               */ 07098000
*   ELSE                                                           1928 07099000
*     ;                             /* ELEMENT TYPE IS UNCHANGED     */ 07100000
@RF01924 DS    0H                                                  1929 07101000
*   IF CNV3TYP=IOPPMOD THEN                                        1929 07102000
         CH    CNV3TYP,@CH00064                                    1929 07103000
         BNE   @RF01929                                            1929 07104000
*     DO;                                                          1930 07105000
*                                                                  1930 07106000
*       /*************************************************************/ 07107000
*       /*                                                           */ 07108000
*       /* MOD TYPE ENTRY                                            */ 07109000
*       /*                                                           */ 07110000
*       /*************************************************************/ 07111000
*                                                                  1931 07112000
*       ICTMMOD(1)=ON;              /* SET ICT MOD SECT INDICATOR    */ 07113000
         L     @05,@PC00030+4                                      1931 07114000
         SLR   @05,FLG1OFFS                                        1931 07115000
         OI    ICTMMOD(@05),B'10000000'                            1931 07116000
*     END;                                                         1932 07117000
*   IF CNV3TYP=IOPPMACR THEN                                       1933 07118000
@RF01929 CH    CNV3TYP,@CH00039                                    1933 07119000
         BNE   @RF01933                                            1933 07120000
*     DO;                                                          1934 07121000
*                                                                  1934 07122000
*       /*************************************************************/ 07123000
*       /*                                                           */ 07124000
*       /* MAC TYPE ENTRY                                            */ 07125000
*       /*                                                           */ 07126000
*       /*************************************************************/ 07127000
*                                                                  1935 07128000
*       ICTMMACR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */ 07129000
         L     @05,@PC00030+4                                      1935 07130000
         SLR   @05,FLG1OFFS                                        1935 07131000
         OI    ICTMMACR(@05),B'00001000'                           1935 07132000
*     END;                                                         1936 07133000
*   IF CNV3TYP=IOPPMACU THEN                                       1937 07134000
@RF01933 CH    CNV3TYP,@CH00102                                    1937 07135000
         BNE   @RF01937                                            1937 07136000
*     DO;                                                          1938 07137000
*                                                                  1938 07138000
*       /*************************************************************/ 07139000
*       /*                                                           */ 07140000
*       /* MACUPD TYPE ENTRY                                         */ 07141000
*       /*                                                           */ 07142000
*       /*************************************************************/ 07143000
*                                                                  1939 07144000
*       ICTMMACR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */ 07145000
         L     @05,@PC00030+4                                      1939 07146000
         SLR   @05,FLG1OFFS                                        1939 07147000
         OI    ICTMMACR(@05),B'00001000'                           1939 07148000
*     END;                                                         1940 07149000
*   IF CNV3TYP=IOPPSRCR THEN                                       1941 07150000
@RF01937 CH    CNV3TYP,@CH00289                                    1941 07151000
         BNE   @RF01941                                            1941 07152000
*     DO;                                                          1942 07153000
*                                                                  1942 07154000
*       /*************************************************************/ 07155000
*       /*                                                           */ 07156000
*       /* SRC TYPE ENTRY                                            */ 07157000
*       /*                                                           */ 07158000
*       /*************************************************************/ 07159000
*                                                                  1943 07160000
*       ICTMSRCR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */ 07161000
         L     @05,@PC00030+4                                      1943 07162000
         SLR   @05,FLG1OFFS                                        1943 07163000
         OI    ICTMSRCR(@05),B'00000010'                           1943 07164000
*     END;                                                         1944 07165000
*   IF CNV3TYP=IOPPSRCU THEN                                       1945 07166000
@RF01941 CH    CNV3TYP,@CH00066                                    1945 07167000
         BNE   @RF01945                                            1945 07168000
*     DO;                                                          1946 07169000
*                                                                  1946 07170000
*       /*************************************************************/ 07171000
*       /*                                                           */ 07172000
*       /* SRCUPD TYPE ENTRY                                         */ 07173000
*       /*                                                           */ 07174000
*       /*************************************************************/ 07175000
*                                                                  1947 07176000
*       ICTMSRCR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */ 07177000
         L     @05,@PC00030+4                                      1947 07178000
         SLR   @05,FLG1OFFS                                        1947 07179000
         OI    ICTMSRCR(@05),B'00000010'                           1947 07180000
*     END;                                                         1948 07181000
*   IF CNV3TYP=IOPPZAP              /* IS TYPE A ZAP ...             */ 07182000
*       |CNV3TYP=IOPPXPD THEN       /* ... OR AN EXPAND ZAP?         */ 07183000
@RF01945 CH    CNV3TYP,@CH00273                                    1949 07184000
         BE    @RT01949                                            1949 07185000
         CH    CNV3TYP,@CH00087                                    1949 07186000
         BNE   @RF01949                                            1949 07187000
@RT01949 DS    0H                                                  1950 07188000
*     DO;                           /* YES,                          */ 07189000
*                                                                  1950 07190000
*       /*************************************************************/ 07191000
*       /*                                                           */ 07192000
*       /* ZAP TYPE ENTRY                                            */ 07193000
*       /*                                                           */ 07194000
*       /*************************************************************/ 07195000
*                                                                  1951 07196000
*       ICTMMOD(1)=ON;              /* SET ICT MOD ENTRY INDICATOR   */ 07197000
         L     @05,@PC00030+4                                      1951 07198000
         SLR   @05,FLG1OFFS                                        1951 07199000
         OI    ICTMMOD(@05),B'10000000'                            1951 07200000
*     END;                                                         1952 07201000
*   IF CNV3TYP=IOPPASM THEN         /* ASSEMBLY CAUSED BY MACRO      */ 07202000
@RF01949 CH    CNV3TYP,@CH00034                                    1953 07203000
         BNE   @RF01953                                            1953 07204000
*     DO;                           /* YES,                          */ 07205000
*                                                                  1954 07206000
*       /*************************************************************/ 07207000
*       /*                                                           */ 07208000
*       /* ASM TYPE ENTRY                                            */ 07209000
*       /*                                                           */ 07210000
*       /*************************************************************/ 07211000
*                                                                  1955 07212000
*       ICTMMOD(1)=ON;              /* SET ICT MOD ENTRY INDICATOR   */ 07213000
*       ICTMASM(1)=ON;              /* SET ICT ASM ENTRY INDICATOR   */ 07214000
         L     @05,@PC00030+4                                      1956 07215000
         SLR   @05,FLG1OFFS                                        1956 07216000
         OI    ICTMMOD(@05),B'11000000'                            1956 07217000
*     END;                                                         1957 07218000
*   RETURN CODE(CNV3RC);            /* RETURN W/RC SET               */ 07219000
@RF01953 LR    @15,CNV3RC                                          1958 07220000
         L     @14,12(,@13)                                        1958 07221000
         LM    @00,@12,20(@13)                                     1958 07222000
         BR    @14                                                 1958 07223000
*   END CNVTYP3;                                                   1959 07224000
         EJECT                                                          07225000
*                                                                  1960 07226000
*   /*****************************************************************/ 07227000
*   /*                                                               */ 07228000
*   /* FAILSMD -                                                     */ 07229000
*   /*                                                               */ 07230000
*   /*****************************************************************/ 07231000
*                                                                  1960 07232000
*FAILSMD:                                                          1960 07233000
*   PROC(FSMDENT);                  /* ICT PTF ENTRY FOR SYSMOD TO BE   07234000
*                                      FAILED                        */ 07235000
FAILSMD  STM   @14,@12,@SA00031                                    1960 07236000
         MVC   @PC00031(4),0(@01)                                  1960 07237000
*   DCL                                                            1961 07238000
*     FSMDENT CHAR(*);              /* ICT PTF ENTRY                 */ 07239000
*   DCL                                                            1962 07240000
*     FSMDRC FIXED(15);             /* LOCAL RETURN CODE             */ 07241000
*   RFY                                                            1963 07242000
*     ICTPTF BASED(ADDR(FSMDENT));                                 1963 07243000
*   RFY                                                            1964 07244000
*     TSLPARMS BASED(TBLXTSLP);                                    1964 07245000
*   FSMDRC=ZERO;                    /* CLEAR RETURN CODE             */ 07246000
         SLR   FSMDRC,FSMDRC                                       1965 07247000
*                                                                  1966 07248000
*   /*****************************************************************/ 07249000
*   /*                                                               */ 07250000
*   /* HMA226I XXXXXXXX PROCESSING TERMINATED ... FOR SYSMOD XXXXXXX */ 07251000
*   /*                                                               */ 07252000
*   /*****************************************************************/ 07253000
*                                                                  1966 07254000
*   DO;                             /* HMASMPMG M1(HMA226I)M2(PART011   07255000
*                                      )VAR(TBLXFUNC,ICTPTFS(1))TYPE(   07256000
*                                      INFO)TARGET(SYSOUT,LOG)       */ 07257000
*     HMASMMGP=HMASMMGP&&HMASMMGP;  /* SET PARMS TO ZEROS            */ 07258000
         XC    HMASMMGP(32),HMASMMGP                               1967 07259000
*     MGPMGNO1=HMA226I;             /* SET UP MSG 1 CODE             */ 07260000
         MVC   MGPMGNO1(2),@CH00550                                1968 07261000
*     MGPMGNO2=PART011;             /* SET UP MSG 2 CODE             */ 07262000
         MVC   MGPMGNO2(2),@CH00521                                1969 07263000
*     MGPTYPE=MGPINFO;              /* SET MESSAGE TYPE              */ 07264000
         MVI   MGPTYPE,X'01'                                       1970 07265000
*     MGPPRINT='1'B;                /* SET TARGET FLAG               */ 07266000
*     MGPHLDS='1'B;                 /* SET TARGET FLAG               */ 07267000
         OI    MGPPRINT,B'10010000'                                1972 07268000
*     MGPVARPT(1)=ADDR(TBLXFUNC);   /* SET VARIABLE PTR              */ 07269000
         L     @03,@PC00001                                        1973 07270000
         LA    @03,TBLXFUNC(,@03)                                  1973 07271000
         ST    @03,MGPVARPT                                        1973 07272000
*     MGPVARPT(2)=ADDR(ICTPTFS(1)); /* SET VARIABLE PTR              */ 07273000
         L     @03,@PC00031                                        1974 07274000
         ST    @03,MGPVARPT+4                                      1974 07275000
*     CALL HMASMMSG(HMASMMGP);      /* HAVE MESSAGE ISSUED           */ 07276000
         L     @15,@CV02018                                        1975 07277000
         LA    @01,@AL01975                                        1975 07278000
         BALR  @14,@15                                             1975 07279000
*   END;                                                           1976 07280000
*   ICTPNOGO(1)=ON;                 /* SYSMOD IS NOGO                */ 07281000
*   ICTPMSG(1)=ON;                  /* MESSAGE ISSUED FOR SYSMOD     */ 07282000
*   ICTPCPL(1)=ON;                  /* SYSMOD IS COMPLETE            */ 07283000
         L     @03,@PC00031                                        1979 07284000
         OI    ICTPNOGO(@03),B'01110000'                           1979 07285000
*   TSLFUNCT=TSLFFUNC;              /* CHECK FOR FAILING FUNCTION ...*/ 07286000
         L     @15,@PC00001                                        1980 07287000
         L     @15,TBLXTSLP(,@15)                                  1980 07288000
         MVI   TSLFUNCT(@15),X'07'                                 1980 07289000
*   TSLMFUNC=''B;                   /* CLEAR TSB PARM LIST           */ 07290000
         L     @14,TSLPMLAD(,@15)                                  1981 07291000
         XC    TSLMFUNC(8,@14),TSLMFUNC(@14)                       1981 07292000
*   TSLMSMD=ICTPTFS(1);             /* ... AND ISSUE MSG IF NEEDED   */ 07293000
         MVC   TSLMSMD(7,@14),ICTPTFS(@03)                         1982 07294000
*   TSLMTYPE=ICTPTYPE(1);           /* ...                           */ 07295000
         MVC   TSLMTYPE(1,@14),ICTPTYPE(@03)                       1983 07296000
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */ 07297000
         ST    @15,@AL00001                                        1984 07298000
         L     @15,@CV02024                                        1984 07299000
         LA    @01,@AL00001                                        1984 07300000
         BALR  @14,@15                                             1984 07301000
*   FSMDRC=MAX(FSMDRC,TSLRETRN);    /* SAVE RC                       */ 07302000
         L     @03,@PC00001                                        1985 07303000
         L     @03,TBLXTSLP(,@03)                                  1985 07304000
         SLR   @15,@15                                             1985 07305000
         IC    @15,TSLRETRN(,@03)                                  1985 07306000
         CR    FSMDRC,@15                                          1985 07307000
         BNL   *+6                                                      07308000
         LR    FSMDRC,@15                                          1985 07309000
*   IF FSMDRC<STOPFUNC THEN         /* NOT A SERIOUS ERROR?          */ 07310000
         CH    FSMDRC,@CH00033                                     1986 07311000
         BNL   @RF01986                                            1986 07312000
*     DO;                           /* YES,                          */ 07313000
*       TSLFUNCT=TSLFRCKR;          /* RESTORE REQ CHECKING          */ 07314000
         MVI   TSLFUNCT(@03),X'08'                                 1988 07315000
*       CALL HMASMTSB(TSLPARMS);    /* ...                           */ 07316000
         ST    @03,@AL00001                                        1989 07317000
         L     @15,@CV02024                                        1989 07318000
         LA    @01,@AL00001                                        1989 07319000
         BALR  @14,@15                                             1989 07320000
*       FSMDRC=MAX(FSMDRC,TSLRETRN);/* SAVE RC                       */ 07321000
         L     @03,@PC00001                                        1990 07322000
         L     @03,TBLXTSLP(,@03)                                  1990 07323000
         SLR   @15,@15                                             1990 07324000
         IC    @15,TSLRETRN(,@03)                                  1990 07325000
         CR    FSMDRC,@15                                          1990 07326000
         BNL   *+6                                                      07327000
         LR    FSMDRC,@15                                          1990 07328000
*     END;                          /*                               */ 07329000
*   RETURN CODE(FSMDRC);            /* RETURN W/ RETURN CODE         */ 07330000
@RF01986 LR    @15,FSMDRC                                          1992 07331000
         L     @14,@SA00031                                        1992 07332000
         LM    @00,@12,@SA00031+8                                  1992 07333000
         BR    @14                                                 1992 07334000
*   END FAILSMD;                                                   1993 07335000
*   END HMASMTRM                    /*                               */ 07336000
*                                                                  1994 07337000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07338000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 07339000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 07340000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 07341000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 07342000
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */ 07343000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 07344000
*                                                                  1994 07345000
*       ;                                                          1994 07346000
@DATA    DS    0H                                                       07347000
@CH00064 DC    H'1'                                                     07348000
@CH00273 DC    H'2'                                                     07349000
@CH00087 DC    H'3'                                                     07350000
@CH00102 DC    H'5'                                                     07351000
@CH00289 DC    H'6'                                                     07352000
@CH00066 DC    H'7'                                                     07353000
@CH00035 DC    H'9'                                                     07354000
@CH00036 DC    H'10'                                                    07355000
@CH00521 DC    H'11'                                                    07356000
@CH00033 DC    H'12'                                                    07357000
@CH00550 DC    H'27'                                                    07358000
@CH01892 DC    H'47'                                                    07359000
@CH00599 DC    H'81'                                                    07360000
@CH02662 DC    H'116'                                                   07361000
@CH02047 DC    H'123'                                                   07362000
@CH02665 DC    H'144'                                                   07363000
@CH02033 DC    H'183'                                                   07364000
@CH02037 DC    H'230'                                                   07365000
@CH02035 DC    H'231'                                                   07366000
@CH00707 DC    H'255'                                                   07367000
@CH02664 DC    H'-172'                                                  07368000
         DS    0F                                                       07369000
@AL00255 DC    A(LISTPARM)             LIST WITH   3 ARGUMENT(S)        07370000
         DC    A(MXOUTGTP)                                              07371000
         DC    A(MSELGTP)                                               07372000
@AL00365 DC    A(@CF00082)             LIST WITH   4 ARGUMENT(S)        07373000
         DC    A(@TF00001)                                              07374000
         DC    A(@CF00082)                                              07375000
         DC    A(@TF00002)                                              07376000
@AL00410 DC    A(@CC00659)             LIST WITH   2 ARGUMENT(S)        07377000
         DC    A(ENTNAME)                                               07378000
@AL00421 EQU   *                       LIST WITH   3 ARGUMENT(S)        07379000
@AL00427 EQU   *                       LIST WITH   3 ARGUMENT(S)        07380000
@AL00432 DC    A(BLDENT@)              LIST WITH   3 ARGUMENT(S)        07381000
         DC    A(@TF00001)                                              07382000
         DC    A(@CF00082)                                              07383000
@AL00542 DC    A(BLDAIOPT)             LIST WITH   2 ARGUMENT(S)        07384000
         DC    A(BLDADUMM)                                              07385000
@AL00671 DC    A(TYPEIOP)              LIST WITH   2 ARGUMENT(S)        07386000
         DC    A(TYPEXRF)                                               07387000
@AL00741 DC    A(XRF3PIND)             LIST WITH   2 ARGUMENT(S)        07388000
         DC    A(CK1XITYP)                                              07389000
@AL00745 DC    A(CK1XIOPT)             LIST WITH   2 ARGUMENT(S)        07390000
         DC    A(CK1XDUMM)                                              07391000
@AL01187 DC    A(M1FCANS)              LIST WITH   3 ARGUMENT(S)        07392000
         DC    A(M1FCPART)                                              07393000
         DC    A(M1FCICT@)                                              07394000
@AL01203 DC    A(M1FAANS)              LIST WITH   2 ARGUMENT(S)        07395000
         DC    A(M1FAPART)                                              07396000
@AL01287 DC    A(M1FCICT@)             LIST WITH   4 ARGUMENT(S)        07397000
         DC    A(HMASMMGP)                                              07398000
         DC    A(M1FCANS)                                               07399000
         DC    A(M1FCPART)                                              07400000
@AL01307 DC    A(M1RCANS)              LIST WITH   3 ARGUMENT(S)        07401000
         DC    A(M1RCPART)                                              07402000
         DC    A(M1RCICT@)                                              07403000
@AL01332 DC    A(M1RAANS)              LIST WITH   2 ARGUMENT(S)        07404000
         DC    A(M1RAPART)                                              07405000
@AL01363 DC    A(M1RCICT@)             LIST WITH   3 ARGUMENT(S)        07406000
         DC    A(HMASMMGP)                                              07407000
         DC    A(M1TPSANS)                                              07408000
@AL01426 DC    A(M1RCICT@)             LIST WITH   4 ARGUMENT(S)        07409000
         DC    A(HMASMMGP)                                              07410000
         DC    A(M1RCANS)                                               07411000
         DC    A(M1RCPART)                                              07412000
@AL01453 DC    A(M1UCANS)              LIST WITH   3 ARGUMENT(S)        07413000
         DC    A(M1UCPART)                                              07414000
         DC    A(M1UCICT@)                                              07415000
@AL01477 DC    A(M1UAANS)              LIST WITH   2 ARGUMENT(S)        07416000
         DC    A(M1UAPART)                                              07417000
@AL01498 DC    A(M1UCICT@)             LIST WITH   4 ARGUMENT(S)        07418000
@AL00336 EQU   *                       LIST WITH   1 ARGUMENT(S)        07419000
@AL00803 EQU   *                       LIST WITH   1 ARGUMENT(S)        07420000
@AL00828 EQU   *                       LIST WITH   1 ARGUMENT(S)        07421000
@AL01607 EQU   *                       LIST WITH   1 ARGUMENT(S)        07422000
@AL01619 EQU   *                       LIST WITH   1 ARGUMENT(S)        07423000
@AL01975 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        07424000
         DC    A(M1UCANS)                                               07425000
         DC    A(M1UCPART)                                              07426000
@AL01604 DC    A(M1MIOPT)              LIST WITH   2 ARGUMENT(S)        07427000
         DC    A(M1MDUMMY)                                              07428000
@AL01793 DC    A(SRHXIOP)              LIST WITH   2 ARGUMENT(S)        07429000
         DC    A(SRHXRFT)                                               07430000
         DS    0F                                                       07431000
@SA00001 DS    18F                                                      07432000
@PC00001 DS    1F                                                       07433000
@SA00003 DS    15F                                                      07434000
@SA00010 DS    15F                                                      07435000
@SA00011 DS    15F                                                      07436000
@SA00014 DS    15F                                                      07437000
@PC00030 DS    2F                                                       07438000
@SA00004 DS    15F                                                      07439000
@PC00004 DS    3F                                                       07440000
@PC00007 DS    1F                                                       07441000
@PC00006 DS    1F                                                       07442000
@SA00008 DS    15F                                                      07443000
@PC00008 DS    2F                                                       07444000
@PC00028 DS    3F                                                       07445000
@PC00029 DS    2F                                                       07446000
@SA00012 DS    15F                                                      07447000
@PC00012 DS    1F                                                       07448000
@SA00015 DS    15F                                                      07449000
@PC00015 DS    1F                                                       07450000
@SA00017 DS    15F                                                      07451000
@SA00018 DS    15F                                                      07452000
@SA00019 DS    15F                                                      07453000
@SA00021 DS    15F                                                      07454000
@PC00021 DS    4F                                                       07455000
@SA00024 DS    15F                                                      07456000
@PC00024 DS    3F                                                       07457000
@SA00020 DS    15F                                                      07458000
@PC00020 DS    4F                                                       07459000
@SA00025 DS    15F                                                      07460000
@PC00025 DS    3F                                                       07461000
@SA00026 DS    15F                                                      07462000
@PC00026 DS    3F                                                       07463000
@SA00023 DS    0F                                                       07464000
@PC00023 EQU   @SA00023+60                                              07465000
@SA00022 DS    0F                                                       07466000
@PC00022 EQU   @SA00022+60                                              07467000
@SA00009 DS    0F                                                       07468000
@PC00009 EQU   @SA00009+60                                              07469000
@SA00005 DS    0F                                                       07470000
@PC00005 EQU   @SA00005+60                                              07471000
@SA00031 DS    0F                                                       07472000
@PC00031 EQU   @SA00031+60                                              07473000
@SA00027 DS    0F                                                       07474000
@SA00013 DS    0F                                                       07475000
         DS    19F                                                      07476000
@AL00001 DS    5A                                                       07477000
@TF00001 DS    F                                                        07478000
@TF00002 DS    F                                                        07479000
         DS    0F                                                       07480000
@CF00082 DC    F'0'                                                     07481000
@CF00039 DC    F'4'                                                     07482000
@CH00039 EQU   @CF00039+2                                               07483000
@CF00034 DC    F'8'                                                     07484000
@CH00034 EQU   @CF00034+2                                               07485000
@CF02040 DC    F'99'                                                    07486000
@CF00349 DC    F'100'                                                   07487000
@CF02043 DC    F'121'                                                   07488000
@CF02045 DC    F'122'                                                   07489000
@CF02049 DC    F'124'                                                   07490000
@CH02049 EQU   @CF02049+2                                               07491000
@CF01904 DC    F'125'                                                   07492000
@CF02052 DC    F'126'                                                   07493000
@CF02054 DC    F'127'                                                   07494000
@CF02056 DC    F'128'                                                   07495000
@CF02058 DC    F'129'                                                   07496000
@CF02699 DC    F'-144'                                                  07497000
@CF02704 DC    F'-136'                                                  07498000
@CF02700 DC    F'-135'                                                  07499000
@CF02702 DC    F'-133'                                                  07500000
@CF02708 DC    F'-132'                                                  07501000
@CF02694 DC    F'-116'                                                  07502000
@CF02692 DC    F'-108'                                                  07503000
@CF02693 DC    F'-96'                                                   07504000
@CF02710 DC    F'-52'                                                   07505000
@CF02701 DC    F'-48'                                                   07506000
@CF02707 DC    F'-40'                                                   07507000
@CF02695 DC    F'-8'                                                    07508000
@CF02711 DC    F'-4'                                                    07509000
@CV02017 DC    V(HMASMIO)                                               07510000
@CV02018 DC    V(HMASMMSG)                                              07511000
@CV02019 DC    V(HMASMXRF)                                              07512000
@CV02020 DC    V(HMASMGTA)                                              07513000
@CV02021 DC    V(HMASMTAD)                                              07514000
@CV02022 DC    V(HMASMTAI)                                              07515000
@CV02023 DC    V(HMASMTID)                                              07516000
@CV02024 DC    V(HMASMTSB)                                              07517000
@CV02025 DC    V(HMASMTM1)                                              07518000
@CV02026 DC    V(HMASMTM2)                                              07519000
@CV02027 DC    V(HMASMTM3)                                              07520000
@CV02028 DC    V(HMASMTM4)                                              07521000
@CV02029 DC    V(HMASMTPS)                                              07522000
         DS    0D                                                       07523000
BLDENT@  DS    A                                                        07524000
MODADDR  DS    A                                                        07525000
SELMX3   DS    F                                                        07526000
MOD1CDF@ DS    A                                                        07527000
MOD1ACF@ DS    A                                                        07528000
MOD1CDR@ DS    A                                                        07529000
MOD1ACR@ DS    A                                                        07530000
M1FAPART DS    F                                                        07531000
M1FCPART DS    F                                                        07532000
M1FCICT@ DS    A                                                        07533000
M1RAPART DS    F                                                        07534000
M1RCPART DS    F                                                        07535000
M1RCICT@ DS    A                                                        07536000
M1UAPART DS    F                                                        07537000
M1UCPART DS    F                                                        07538000
M1UCICT@ DS    A                                                        07539000
SELMONUM DS    H                                                        07540000
BLDAIOPT DS    FL1                                                      07541000
BLDADUMM DS    FL1                                                      07542000
CK1XITYP DS    FL1                                                      07543000
CK1XIOPT DS    FL1                                                      07544000
CK1XDUMM DS    FL1                                                      07545000
M1MIOPT  DS    FL1                                                      07546000
M1MDUMMY DS    FL1                                                      07547000
REGRPIND DS    FL1                                                      07548000
SRHXRFT  DS    FL1                                                      07549000
@CC02060 DC    C'FMID    '                                              07550000
@CC02062 DC    C'RMID    '                                              07551000
@CC02064 DC    C'UMID    '                                              07552000
@CC02075 DC    C'        '                                              07553000
@CC00659 DC    C'M'                                                     07554000
ICTENDCH DC    X'FFFFFFFF'                                              07555000
HMASMMGP DS    CL32                                                     07556000
         ORG   HMASMMGP                                                 07557000
MGPFIXED DS    CL12                                                     07558000
         ORG   MGPFIXED                                                 07559000
MGPCLEAR DS    CL6                                                      07560000
         ORG   MGPCLEAR                                                 07561000
MGPMGNO1 DS    FL2                                                      07562000
MGPMGNO2 DS    FL2                                                      07563000
MGPMGNO3 DS    FL2                                                      07564000
         ORG   MGPFIXED+6                                               07565000
MGPFLAGS DS    BL2                                                      07566000
         ORG   MGPFLAGS                                                 07567000
MGPPRINT DS    BL1                                                      07568000
MGPLIST  EQU   MGPFLAGS+0                                               07569000
MGPRPT   EQU   MGPFLAGS+0                                               07570000
MGPHLDS  EQU   MGPFLAGS+0                                               07571000
MGPWTOR  EQU   MGPFLAGS+0                                               07572000
MGPWTO   EQU   MGPFLAGS+0                                               07573000
MGPWTP   EQU   MGPFLAGS+0                                               07574000
@NM00239 EQU   MGPFLAGS+0                                               07575000
         ORG   MGPFIXED+8                                               07576000
MGPTYPE  DS    FL1                                                      07577000
@NM00240 DS    CL3                                                      07578000
         ORG   HMASMMGP+12                                              07579000
MGPVAR   DS    CL20                                                     07580000
         ORG   MGPVAR                                                   07581000
MGPVARPT DS    5A                                                       07582000
         ORG   HMASMMGP+32                                              07583000
XRFRCD   DS    CL30                                                     07584000
         ORG   XRFRCD                                                   07585000
XRFKEY1  DS    CL29                                                     07586000
         ORG   XRFKEY1                                                  07587000
XRFETYPE DS    FL1                                                      07588000
XRFENAME DS    CL8                                                      07589000
XRFRTYPE DS    FL1                                                      07590000
XRFUKEY1 DS    FL1                                                      07591000
@NM00263 DS    CL18                                                     07592000
         ORG   XRFRCD+29                                                07593000
XRFNKEY1 DS    CL1                                                      07594000
         ORG   XRFNKEY1                                                 07595000
XRFFLAG1 DS    BL1                                                      07596000
         ORG   XRFFLAG1                                                 07597000
XRFFLGA  DS    BL1                                                      07598000
XRFFLGB  EQU   XRFFLAG1+0                                               07599000
XRFFLGC  EQU   XRFFLAG1+0                                               07600000
XRFFLGD  EQU   XRFFLAG1+0                                               07601000
XRFFLGE  EQU   XRFFLAG1+0                                               07602000
XRFFLGF  EQU   XRFFLAG1+0                                               07603000
XRFFLGG  EQU   XRFFLAG1+0                                               07604000
XRFFLGH  EQU   XRFFLAG1+0                                               07605000
         ORG   XRFRCD+30                                                07606000
LISTPARM DS    CL19                                                     07607000
         ORG   LISTPARM                                                 07608000
LISTPRM1 DS    BL2                                                      07609000
         ORG   LISTPRM1                                                 07610000
LISTALL1 DS    BL1                                                      07611000
LISTCDS  EQU   LISTPRM1+0                                               07612000
LISTACDS EQU   LISTPRM1+0                                               07613000
LISTSCDS EQU   LISTPRM1+0                                               07614000
LISTCRQ  EQU   LISTPRM1+0                                               07615000
LISTACRQ EQU   LISTPRM1+0                                               07616000
LISTPTS  EQU   LISTPRM1+0                                               07617000
@NM00284 EQU   LISTPRM1+0                                               07618000
LISTLOG  EQU   LISTPRM1+1                                               07619000
@NM00285 EQU   LISTPRM1+1                                               07620000
         ORG   LISTPARM+2                                               07621000
LISTPRM2 DS    BL2                                                      07622000
         ORG   LISTPRM2                                                 07623000
LISTALL2 DS    BL1                                                      07624000
LISTASM  EQU   LISTPRM2+0                                               07625000
LISTLMD  EQU   LISTPRM2+0                                               07626000
LISTMAC  EQU   LISTPRM2+0                                               07627000
LISTMOD  EQU   LISTPRM2+0                                               07628000
LISTSRC  EQU   LISTPRM2+0                                               07629000
LISTDLB  EQU   LISTPRM2+0                                               07630000
LISTSYS  EQU   LISTPRM2+0                                               07631000
LISTSMD  DS    BL1                                                      07632000
LISTFMD  EQU   LISTPRM2+1                                               07633000
LISTMCS  EQU   LISTPRM2+1                                               07634000
@NM00286 EQU   LISTPRM2+1                                               07635000
         ORG   LISTPARM+4                                               07636000
LISTPRM3 DS    BL2                                                      07637000
         ORG   LISTPRM3                                                 07638000
LISTALL3 DS    BL1                                                      07639000
LISTNOAP EQU   LISTPRM3+0                                               07640000
LISTNOAC EQU   LISTPRM3+0                                               07641000
LISTRES  EQU   LISTPRM3+0                                               07642000
LISTFUNC EQU   LISTPRM3+0                                               07643000
LISTPTF  EQU   LISTPRM3+0                                               07644000
LISTAPAR EQU   LISTPRM3+0                                               07645000
LISTUSER EQU   LISTPRM3+0                                               07646000
LISTSUP  DS    BL1                                                      07647000
LISTNSUP EQU   LISTPRM3+1                                               07648000
LISTDEL  EQU   LISTPRM3+1                                               07649000
LISTBYP  EQU   LISTPRM3+1                                               07650000
LISTERR  EQU   LISTPRM3+1                                               07651000
@NM00287 EQU   LISTPRM3+1                                               07652000
         ORG   LISTPARM+6                                               07653000
LISTPRM4 DS    BL1                                                      07654000
         ORG   LISTPRM4                                                 07655000
LISTSEL  DS    BL1                                                      07656000
LISTXREF EQU   LISTPRM4+0                                               07657000
@NM00288 EQU   LISTPRM4+0                                               07658000
         ORG   LISTPARM+7                                               07659000
LISTDATE DS    CL12                                                     07660000
         ORG   LISTDATE                                                 07661000
LISTBDAT DS    CL6                                                      07662000
         ORG   LISTBDAT                                                 07663000
LISTBMM  DS    CL2                                                      07664000
LISTBDD  DS    CL2                                                      07665000
LISTBYY  DS    CL2                                                      07666000
         ORG   LISTDATE+6                                               07667000
LISTEDAT DS    CL6                                                      07668000
         ORG   LISTEDAT                                                 07669000
LISTEMM  DS    CL2                                                      07670000
LISTEDD  DS    CL2                                                      07671000
LISTEYY  DS    CL2                                                      07672000
         ORG   LISTPARM+19                                              07673000
         DS    CL1                                                      07674000
PATCHTRM DS    CL80                                                     07675000
         ORG   PATCHTRM                                                 07676000
@NM00289 DC    80X'FF'                                                  07677000
         ORG   PATCHTRM+80                                              07678000
TRMFLAGS DS    CL1                                                      07679000
         ORG   TRMFLAGS                                                 07680000
ASMBLDF  DS    BL1                                                      07681000
@NM00290 EQU   TRMFLAGS+0                                               07682000
         ORG   TRMFLAGS+1                                               07683000
         DS    CL1                                                      07684000
MXOUTGTP DS    CL28                                                     07685000
MSELGTP  DS    CL28                                                     07686000
MSELBUF  DS    CL12                                                     07687000
ASMGTP   DS    CL28                                                     07688000
TM4RCD   DS    CL12                                                     07689000
         ORG   TM4RCD                                                   07690000
TM4NAME  DS    CL8                                                      07691000
TM4PTR   DS    AL4                                                      07692000
         ORG   TM4RCD+12                                                07693000
GETICTYP DS    CL1                                                      07694000
ENTNAME  DS    CL8                                                      07695000
SRCNAME  DS    CL8                                                      07696000
MODNAME  DS    CL8                                                      07697000
TYPEIOP  DS    CL1                                                      07698000
TYPEXRF  DS    CL1                                                      07699000
CHKXFLGS DS    CL1                                                      07700000
         ORG   CHKXFLGS                                                 07701000
ENDMOD   DS    BL1                                                      07702000
@NM00291 EQU   CHKXFLGS+0                                               07703000
         ORG   CHKXFLGS+1                                               07704000
CK1XFLGS DS    CL1                                                      07705000
         ORG   CK1XFLGS                                                 07706000
CK1XOK   DS    BL1                                                      07707000
CK1XERR  EQU   CK1XFLGS+0                                               07708000
CK1XIFND EQU   CK1XFLGS+0                                               07709000
CK1XRERR EQU   CK1XFLGS+0                                               07710000
CK1XAERR EQU   CK1XFLGS+0                                               07711000
@NM00292 EQU   CK1XFLGS+0                                               07712000
         ORG   CK1XFLGS+1                                               07713000
SELMFLGS DS    CL1                                                      07714000
         ORG   SELMFLGS                                                 07715000
SELMMFND DS    BL1                                                      07716000
SELMDEL  EQU   SELMFLGS+0                                               07717000
@NM00293 EQU   SELMFLGS+0                                               07718000
         ORG   SELMFLGS+1                                               07719000
MOD1FLGS DS    CL6                                                      07720000
         ORG   MOD1FLGS                                                 07721000
@NM00294 DS    BL1                                                      07722000
         ORG   @NM00294                                                 07723000
MOD1DONE DS    BL1                                                      07724000
MOD1ERR  EQU   @NM00294+0                                               07725000
M1HEADER EQU   @NM00294+0                                               07726000
@NM00295 EQU   @NM00294+0                                               07727000
MOD1FNDA EQU   @NM00294+0                                               07728000
MOD1BOTH EQU   @NM00294+0                                               07729000
MOD1DEL  EQU   @NM00294+0                                               07730000
@NM00296 EQU   @NM00294+0                                               07731000
         ORG   MOD1FLGS+1                                               07732000
@NM00297 DS    BL1                                                      07733000
         ORG   @NM00297                                                 07734000
M1FMIDCK DS    BL1                                                      07735000
M1RMIDCK EQU   @NM00297+0                                               07736000
M1UMIDCK EQU   @NM00297+0                                               07737000
@NM00298 EQU   @NM00297+0                                               07738000
M1CRMRST EQU   @NM00297+0                                               07739000
M1CUMRST EQU   @NM00297+0                                               07740000
@NM00299 EQU   @NM00297+0                                               07741000
@NM00300 EQU   @NM00297+0                                               07742000
         ORG   MOD1FLGS+2                                               07743000
@NM00301 DS    BL1                                                      07744000
         ORG   @NM00301                                                 07745000
M1CFMFND DS    BL1                                                      07746000
M1AFMFND EQU   @NM00301+0                                               07747000
M1FMIDEQ EQU   @NM00301+0                                               07748000
@NM00302 EQU   @NM00301+0                                               07749000
M1CFMERM EQU   @NM00301+0                                               07750000
M1AFMERM EQU   @NM00301+0                                               07751000
@NM00303 EQU   @NM00301+0                                               07752000
@NM00304 EQU   @NM00301+0                                               07753000
         ORG   MOD1FLGS+3                                               07754000
@NM00305 DS    BL1                                                      07755000
         ORG   @NM00305                                                 07756000
M1CRMFND DS    BL1                                                      07757000
M1ARMFND EQU   @NM00305+0                                               07758000
M1RMIDEQ EQU   @NM00305+0                                               07759000
@NM00306 EQU   @NM00305+0                                               07760000
M1CRMRGR EQU   @NM00305+0                                               07761000
M1ARMRGR EQU   @NM00305+0                                               07762000
M1CRMASM EQU   @NM00305+0                                               07763000
M1ARMASM EQU   @NM00305+0                                               07764000
         ORG   MOD1FLGS+4                                               07765000
@NM00307 DS    BL1                                                      07766000
         ORG   @NM00307                                                 07767000
M1CUMFND DS    BL1                                                      07768000
M1AUMFND EQU   @NM00307+0                                               07769000
M1CUMID  EQU   @NM00307+0                                               07770000
M1AUMID  EQU   @NM00307+0                                               07771000
@NM00308 EQU   @NM00307+0                                               07772000
@NM00309 EQU   @NM00307+0                                               07773000
@NM00310 EQU   @NM00307+0                                               07774000
@NM00311 EQU   @NM00307+0                                               07775000
         ORG   MOD1FLGS+5                                               07776000
@NM00312 DS    BL1                                                      07777000
         ORG   @NM00312                                                 07778000
@NM00313 DS    BL1                                                      07779000
         ORG   MOD1FLGS+6                                               07780000
M1TPSANS DS    CL1                                                      07781000
M1FAANS  DS    CL1                                                      07782000
M1FCANS  DS    CL1                                                      07783000
M1RAANS  DS    CL1                                                      07784000
M1RCANS  DS    CL1                                                      07785000
M1UFLAGS DS    CL1                                                      07786000
         ORG   M1UFLAGS                                                 07787000
M1UBOTH  DS    BL1                                                      07788000
@NM00314 EQU   M1UFLAGS+0                                               07789000
         ORG   M1UFLAGS+1                                               07790000
M1UAANS  DS    CL1                                                      07791000
M1UCANS  DS    CL1                                                      07792000
M1PANS   DS    CL1                                                      07793000
VRSDUMMY DS    CL1                                                      07794000
SRHXIOP  DS    CL1                                                      07795000
SRHXFLGS DS    CL1                                                      07796000
         ORG   SRHXFLGS                                                 07797000
SRHXENDM DS    BL1                                                      07798000
@NM00316 EQU   SRHXFLGS+0                                               07799000
         ORG   SRHXFLGS+1                                               07800000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07801000
@01      EQU   01                                                       07802000
@02      EQU   02                                                       07803000
@03      EQU   03                                                       07804000
@04      EQU   04                                                       07805000
@05      EQU   05                                                       07806000
@06      EQU   06                                                       07807000
@07      EQU   07                                                       07808000
@08      EQU   08                                                       07809000
@09      EQU   09                                                       07810000
@10      EQU   10                                                       07811000
@11      EQU   11                                                       07812000
@12      EQU   12                                                       07813000
@13      EQU   13                                                       07814000
@14      EQU   14                                                       07815000
@15      EQU   15                                                       07816000
FSMDRC   EQU   @02                                                      07817000
CNV3TYP  EQU   @02                                                      07818000
FLG1OFFS EQU   @03                                                      07819000
CNV3RC   EQU   @04                                                      07820000
CNV2RC   EQU   @02                                                      07821000
CNV1RC   EQU   @02                                                      07822000
TRMCRC   EQU   @02                                                      07823000
SRHXRC   EQU   @02                                                      07824000
REGRX1   EQU   @03                                                      07825000
REGRRC   EQU   @02                                                      07826000
VRSCRC   EQU   @03                                                      07827000
M1ARC    EQU   @02                                                      07828000
M1CRC    EQU   @02                                                      07829000
M1MRC    EQU   @02                                                      07830000
M1PX1    EQU   @03                                                      07831000
M1PRC    EQU   @04                                                      07832000
M1UX2    EQU   @04                                                      07833000
M1UX1    EQU   @05                                                      07834000
M1URC    EQU   @03                                                      07835000
M1RRC    EQU   @03                                                      07836000
M1FRC    EQU   @03                                                      07837000
M1IX2    EQU   @02                                                      07838000
M1IX1    EQU   @02                                                      07839000
M1IRC    EQU   @04                                                      07840000
MOD1RC   EQU   @03                                                      07841000
MODIX2   EQU   @04                                                      07842000
MODIX1   EQU   @03                                                      07843000
MODI1PRC EQU   @06                                                      07844000
MODIRC   EQU   @05                                                      07845000
SELMX2   EQU   @02                                                      07846000
SELMPTR2 EQU   @06                                                      07847000
SELMPTR1 EQU   @07                                                      07848000
SELMO#2  EQU   @05                                                      07849000
SELMX1   EQU   @04                                                      07850000
SELMRC   EQU   @03                                                      07851000
CK1XX2   EQU   @04                                                      07852000
CK1XX1   EQU   @02                                                      07853000
CK1XRC   EQU   @03                                                      07854000
CHKXMODX EQU   @03                                                      07855000
CHKXRC   EQU   @04                                                      07856000
XRFSMODX EQU   @02                                                      07857000
XRFSRC   EQU   @03                                                      07858000
JM       EQU   @04                                                      07859000
MODCRC   EQU   @03                                                      07860000
BLDAX2   EQU   @04                                                      07861000
BLDAX1   EQU   @04                                                      07862000
BLDARC   EQU   @03                                                      07863000
MODSPTR  EQU   @03                                                      07864000
MODMPTR  EQU   @05                                                      07865000
MODSMD@  EQU   @04                                                      07866000
TT       EQU   @02                                                      07867000
SRCMPTR  EQU   @03                                                      07868000
SRCSPTR  EQU   @05                                                      07869000
SRCSMD@  EQU   @04                                                      07870000
UU       EQU   @02                                                      07871000
ASMGX1   EQU   @03                                                      07872000
ASMGRC   EQU   @02                                                      07873000
ENTTYPE  EQU   @02                                                      07874000
TMXRETRN EQU   @04                                                      07875000
BLDENTRC EQU   @03                                                      07876000
GETMSUBX EQU   @06                                                      07877000
GETMPTFX EQU   @04                                                      07878000
GETM1PRC EQU   @05                                                      07879000
GETMRC   EQU   @03                                                      07880000
INITRC   EQU   @02                                                      07881000
TRMRC    EQU   @03                                                      07882000
CCAPTR   EQU   @11                                                      07883000
RTNCODE  EQU   @15                                                      07884000
RTNREG   EQU   @14                                                      07885000
TBLXOPTS EQU   0                                                        07886000
TBLFLAGS EQU   TBLXOPTS+8                                               07887000
TBLFLG1  EQU   TBLFLAGS                                                 07888000
TBLFLG2  EQU   TBLFLAGS+2                                               07889000
TBLFLG3  EQU   TBLFLAGS+3                                               07890000
TBLFLG4  EQU   TBLFLAGS+5                                               07891000
TBLBPID  EQU   TBLFLG4                                                  07892000
TBLFLG5  EQU   TBLFLAGS+7                                               07893000
HMASMCCA EQU   0                                                        07894000
CCAFBUFR EQU   HMASMCCA+4                                               07895000
CCADSAD  EQU   CCAFBUFR+124                                             07896000
CCATPAD  EQU   CCAFBUFR+128                                             07897000
CCAFLAG7 EQU   CCAFBUFR+132                                             07898000
CCAFIOP  EQU   HMASMCCA+140                                             07899000
CCAIOPTR EQU   CCAFIOP                                                  07900000
CCAFSYS  EQU   HMASMCCA+148                                             07901000
CCASREL  EQU   CCAFSYS+12                                               07902000
CCAFLAGA EQU   CCAFSYS+21                                               07903000
CCAFSTA  EQU   HMASMCCA+188                                             07904000
CCAFICT  EQU   HMASMCCA+192                                             07905000
CCAICT   EQU   CCAFICT                                                  07906000
CCAICPTF EQU   CCAFICT+4                                                07907000
CCAICMOD EQU   CCAFICT+8                                                07908000
CCAICLMD EQU   CCAFICT+12                                               07909000
CCAFPGM  EQU   HMASMCCA+208                                             07910000
CCABLDLP EQU   CCAFPGM                                                  07911000
CCADBLDL EQU   CCAFPGM+4                                                07912000
CCAFGTP  EQU   HMASMCCA+224                                             07913000
CCASEGTP EQU   CCAFGTP                                                  07914000
@NM00023 EQU   HMASMCCA+244                                             07915000
CCAFFUNC EQU   HMASMCCA+264                                             07916000
CCAFLAG1 EQU   CCAFFUNC+8                                               07917000
CCAFLAG2 EQU   CCAFFUNC+11                                              07918000
CCAFPROC EQU   HMASMCCA+276                                             07919000
CCAFLAG3 EQU   CCAFPROC                                                 07920000
CCAFDIS  EQU   HMASMCCA+278                                             07921000
CCAFLAG4 EQU   CCAFDIS                                                  07922000
CCAFLAG5 EQU   CCAFDIS+1                                                07923000
CCAFLAG6 EQU   CCAFDIS+2                                                07924000
CCAFCNV  EQU   HMASMCCA+281                                             07925000
CCAFLAG8 EQU   CCAFCNV                                                  07926000
CCAFCTL  EQU   HMASMCCA+282                                             07927000
CCAFLAG9 EQU   CCAFCTL                                                  07928000
CCAFDSNG EQU   HMASMCCA+298                                             07929000
CCAFLAGB EQU   CCAFDSNG                                                 07930000
CCADSIDA EQU   0                                                        07931000
CCATYPEA EQU   0                                                        07932000
CCABLDLA EQU   0                                                        07933000
@NM00039 EQU   CCABLDLA                                                 07934000
CCABLDLL EQU   0                                                        07935000
@NM00041 EQU   CCABLDLL                                                 07936000
CCALKDRC EQU   @NM00041+20                                              07937000
@NM00043 EQU   CCABLDLL+124                                             07938000
CCAASMRC EQU   @NM00043+20                                              07939000
@NM00045 EQU   CCABLDLL+248                                             07940000
CCACPYRC EQU   @NM00045+20                                              07941000
@NM00047 EQU   CCABLDLL+372                                             07942000
CCACOMRC EQU   @NM00047+20                                              07943000
@NM00049 EQU   CCABLDLL+496                                             07944000
CCAZAPRC EQU   @NM00049+20                                              07945000
@NM00051 EQU   CCABLDLL+620                                             07946000
CCASUPRC EQU   @NM00051+20                                              07947000
@NM00053 EQU   CCABLDLL+744                                             07948000
CCAUPDRC EQU   @NM00053+20                                              07949000
CCABLDLM EQU   0                                                        07950000
CCABELMT EQU   CCABLDLM+4                                               07951000
CCABMPOS EQU   CCABELMT                                                 07952000
HMASMIOP EQU   0                                                        07953000
IOPDSID  EQU   HMASMIOP                                                 07954000
IOPFUNCT EQU   HMASMIOP+1                                               07955000
IOPRETRN EQU   HMASMIOP+2                                               07956000
IOPTYPE  EQU   HMASMIOP+3                                               07957000
IOPNAME  EQU   HMASMIOP+4                                               07958000
IOPNAM17 EQU   IOPNAME                                                  07959000
@NM00057 EQU   HMASMIOP+12                                              07960000
@NM00058 EQU   @NM00057                                                 07961000
IOPDDNAM EQU   HMASMIOP+24                                              07962000
IOPBUFAD EQU   HMASMIOP+52                                              07963000
IOPDRMAP EQU   HMASMIOP+56                                              07964000
IOPINAME EQU   IOPDRMAP                                                 07965000
IOPINAM  EQU   IOPINAME                                                 07966000
IOPITYP  EQU   IOPINAM                                                  07967000
IOPUSERL EQU   IOPDRMAP+11                                              07968000
IOPEND   EQU   IOPDRMAP+12                                              07969000
IOPLMCTL EQU   0                                                        07970000
IOPQSMIF EQU   0                                                        07971000
@NM00168 EQU   IOPQSMIF                                                 07972000
IOPQSMLS EQU   IOPQSMIF+8                                               07973000
IOPQSMNM EQU   IOPQSMLS                                                 07974000
IOPBS02  EQU   0                                                        07975000
IOPBS04  EQU   0                                                        07976000
IOPBAPF  EQU   IOPBS04                                                  07977000
HMASMICT EQU   0                                                        07978000
ICTCORE  EQU   HMASMICT                                                 07979000
ICTPSPLN EQU   ICTCORE                                                  07980000
ICTMSPLN EQU   ICTCORE+4                                                07981000
ICTLSPLN EQU   ICTCORE+8                                                07982000
ICTGMSPL EQU   0                                                        07983000
ICTPTF   EQU   0                                                        07984000
ICTPTFS  EQU   ICTPTF                                                   07985000
ICTPEND  EQU   ICTPTFS                                                  07986000
ICTPFLG1 EQU   ICTPTF+7                                                 07987000
ICTBYP   EQU   ICTPFLG1                                                 07988000
ICTPFLG3 EQU   ICTPTF+8                                                 07989000
ICTPPROC EQU   ICTPFLG3                                                 07990000
ICTPNOGO EQU   ICTPFLG3                                                 07991000
ICTPCPL  EQU   ICTPFLG3                                                 07992000
ICTPMSG  EQU   ICTPFLG3                                                 07993000
ICTPFLG5 EQU   ICTPTF+9                                                 07994000
ICTPFLG6 EQU   ICTPTF+11                                                07995000
ICTPFLF  EQU   ICTPFLG6                                                 07996000
ICTPFLG2 EQU   ICTPTF+12                                                07997000
ICTPFLG4 EQU   ICTPTF+13                                                07998000
ICTPFLG8 EQU   ICTPTF+14                                                07999000
ICTPFLG9 EQU   ICTPTF+15                                                08000000
@NM00195 EQU   ICTPFLG9                                                 08001000
ICTPFLGA EQU   ICTPTF+16                                                08002000
ICTPUSR1 EQU   ICTPFLGA                                                 08003000
ICTPTYPE EQU   ICTPTF+17                                                08004000
ICTPONUM EQU   ICTPTF+18                                                08005000
ICTPSUPN EQU   ICTPTF+20                                                08006000
ICTPCHN  EQU   ICTPTF+64                                                08007000
ICTPRCHN EQU   ICTPTF+68                                                08008000
ICTPSCHN EQU   ICTPTF+72                                                08009000
ICTPPCHN EQU   ICTPTF+76                                                08010000
ICTPICHN EQU   ICTPTF+80                                                08011000
ICTPNCHN EQU   ICTPTF+84                                                08012000
ICTPVCHN EQU   ICTPTF+88                                                08013000
ICTPDCHN EQU   ICTPTF+92                                                08014000
ICTPBCHN EQU   ICTPTF+96                                                08015000
ICTIXPF  EQU   0                                                        08016000
ICTIXP   EQU   ICTIXPF                                                  08017000
ICTENTLS EQU   0                                                        08018000
ICTENTNT EQU   ICTENTLS                                                 08019000
ICTENTNM EQU   ICTENTNT                                                 08020000
ICTENTST EQU   ICTENTNT+7                                               08021000
ICTREQLS EQU   0                                                        08022000
ICTREQNT EQU   ICTREQLS                                                 08023000
ICTREQNM EQU   ICTREQNT                                                 08024000
ICTREQST EQU   ICTREQNT+7                                               08025000
ICTSUPLS EQU   0                                                        08026000
ICTSUPNT EQU   ICTSUPLS                                                 08027000
ICTSUPNM EQU   ICTSUPNT                                                 08028000
ICTPRELS EQU   0                                                        08029000
ICTPRENT EQU   ICTPRELS                                                 08030000
ICTPRENM EQU   ICTPRENT                                                 08031000
ICTPREST EQU   ICTPRENT+7                                               08032000
ICTIRQLS EQU   0                                                        08033000
ICTIRQNT EQU   ICTIRQLS                                                 08034000
ICTIRQNM EQU   ICTIRQNT                                                 08035000
ICTIRQST EQU   ICTIRQNT+7                                               08036000
ICTCSRST EQU   ICTIRQNT+15                                              08037000
ICTNPRLS EQU   0                                                        08038000
ICTNPRNT EQU   ICTNPRLS                                                 08039000
ICTNPRNM EQU   ICTNPRNT                                                 08040000
ICTVRSLS EQU   0                                                        08041000
ICTVRSNT EQU   ICTVRSLS                                                 08042000
ICTVRSNM EQU   ICTVRSNT                                                 08043000
ICTDELLS EQU   0                                                        08044000
ICTDELNT EQU   ICTDELLS                                                 08045000
ICTDELNM EQU   ICTDELNT                                                 08046000
ICTDELST EQU   ICTDELNT+7                                               08047000
ICTSBYLS EQU   0                                                        08048000
ICTSBYNT EQU   ICTSBYLS                                                 08049000
ICTSBYNM EQU   ICTSBYNT                                                 08050000
ICTMOD   EQU   0                                                        08051000
ICTMNAME EQU   ICTMOD                                                   08052000
ICTMEND  EQU   ICTMNAME                                                 08053000
ICTMFLG2 EQU   ICTMOD+8                                                 08054000
ICTMNOGO EQU   ICTMFLG2                                                 08055000
ICTMCPL  EQU   ICTMFLG2                                                 08056000
ICTMMSG  EQU   ICTMFLG2                                                 08057000
ICTMFLG1 EQU   ICTMOD+9                                                 08058000
ICTMMODR EQU   ICTMFLG1                                                 08059000
ICTMMOD  EQU   ICTMMODR                                                 08060000
ICTMASM  EQU   ICTMMODR                                                 08061000
ICTMMACR EQU   ICTMFLG1                                                 08062000
ICTMSRCR EQU   ICTMFLG1                                                 08063000
ICTMSRCU EQU   ICTMFLG1                                                 08064000
ICTMFLG3 EQU   ICTMOD+10                                                08065000
ICTMFLG4 EQU   ICTMOD+11                                                08066000
ICTMISEL EQU   ICTMFLG4                                                 08067000
ICTMIDEL EQU   ICTMFLG4                                                 08068000
ICTMASOC EQU   ICTMFLG4                                                 08069000
ICTMFLG5 EQU   ICTMOD+12                                                08070000
ICTMPASS EQU   ICTMFLG5                                                 08071000
ICTMODF4 EQU   ICTMOD+13                                                08072000
ICTMLEP1 EQU   ICTMODF4                                                 08073000
ICTMODF5 EQU   ICTMOD+14                                                08074000
ICTMLEP2 EQU   ICTMODF5                                                 08075000
ICTMODF6 EQU   ICTMOD+15                                                08076000
ICTMLEP3 EQU   ICTMODF6                                                 08077000
ICTMODF7 EQU   ICTMOD+16                                                08078000
ICTMLEP4 EQU   ICTMODF7                                                 08079000
ICTMACF4 EQU   ICTMOD+17                                                08080000
ICTFMLIB EQU   ICTMOD+24                                                08081000
ICTMDSTL EQU   ICTMOD+48                                                08082000
ICTMRMID EQU   ICTMOD+80                                                08083000
ICTMFMID EQU   ICTMOD+88                                                08084000
ICTPPTR  EQU   ICTMOD+96                                                08085000
ICTMCHN  EQU   ICTMOD+100                                               08086000
ICTMICHN EQU   ICTMOD+104                                               08087000
ICTMICHA EQU   ICTMOD+108                                               08088000
ICTMACHN EQU   ICTMOD+112                                               08089000
ICTMTCHN EQU   ICTMOD+116                                               08090000
ICTMVCHN EQU   ICTMOD+120                                               08091000
ICTMUCHN EQU   ICTMOD+124                                               08092000
ICTIXMF  EQU   0                                                        08093000
ICTMIDLS EQU   0                                                        08094000
ICTMID   EQU   ICTMIDLS                                                 08095000
ICTMODID EQU   ICTMID                                                   08096000
ICTMIDND EQU   ICTMODID                                                 08097000
ICTMODST EQU   ICTMID+7                                                 08098000
ICTMIDPS EQU   ICTMODST                                                 08099000
ICTMIDRG EQU   ICTMODST                                                 08100000
ICTMIDAM EQU   ICTMODST                                                 08101000
ICTMIDTY EQU   ICTMODST                                                 08102000
ICTASMLS EQU   0                                                        08103000
ICTASMAD EQU   ICTASMLS                                                 08104000
ICTTALLS EQU   0                                                        08105000
ICTTALNM EQU   ICTTALLS                                                 08106000
ICTMVRLS EQU   0                                                        08107000
ICTMVRNT EQU   ICTMVRLS                                                 08108000
ICTMVRNM EQU   ICTMVRNT                                                 08109000
ICTMUMLS EQU   0                                                        08110000
ICTMUMNT EQU   ICTMUMLS                                                 08111000
ICTMUMNM EQU   ICTMUMNT                                                 08112000
ICTLMOD  EQU   0                                                        08113000
ICTLMNAM EQU   ICTLMOD                                                  08114000
ICTLNAME EQU   ICTLMNAM                                                 08115000
ICTLFLG4 EQU   ICTLMOD+8                                                08116000
ICTLFLG1 EQU   ICTLMOD+9                                                08117000
ICTLFLG5 EQU   ICTLMOD+10                                               08118000
ICTLFLG6 EQU   ICTLMOD+11                                               08119000
ICTLFLG7 EQU   ICTLMOD+12                                               08120000
ICTLFLG2 EQU   ICTLMOD+13                                               08121000
ICTLFLG3 EQU   ICTLMOD+14                                               08122000
ICTLCHN  EQU   ICTLMOD+34                                               08123000
ICTIXLF  EQU   0                                                        08124000
HMASMSET EQU   0                                                        08125000
SELSTENT EQU   HMASMSET                                                 08126000
SELSTFLG EQU   SELSTENT                                                 08127000
SESRC    EQU   SELSTFLG+1                                               08128000
SEMOD    EQU   SELSTFLG+1                                               08129000
SEMAC    EQU   SELSTFLG+1                                               08130000
SEASM    EQU   SELSTFLG+1                                               08131000
SENAME   EQU   SELSTENT+2                                               08132000
SESMDNO  EQU   SENAME                                                   08133000
SEFLAGS  EQU   HMASMSET+10                                              08134000
SESELECT EQU   SEFLAGS                                                  08135000
SEFLAG2  EQU   HMASMSET+11                                              08136000
HMASMGTP EQU   0                                                        08137000
GTPFUNCT EQU   HMASMGTP                                                 08138000
GTPRETRN EQU   HMASMGTP+1                                               08139000
GTPRCDLN EQU   HMASMGTP+4                                               08140000
GTPKEYLN EQU   HMASMGTP+6                                               08141000
GTPBUFAD EQU   HMASMGTP+12                                              08142000
GTPRESTR EQU   HMASMGTP+16                                              08143000
GTPFLGS1 EQU   HMASMGTP+26                                              08144000
GTPPSIZE EQU   GTPFLGS1                                                 08145000
TSLPARMS EQU   0                                                        08146000
TSLPMLAD EQU   TSLPARMS+4                                               08147000
TSLFUNCT EQU   TSLPARMS+8                                               08148000
TSLRETRN EQU   TSLPARMS+9                                               08149000
TSLICTSR EQU   0                                                        08150000
TSLISMD  EQU   TSLICTSR                                                 08151000
TSLIOPTF EQU   TSLICTSR+7                                               08152000
TSLICTF  EQU   TSLICTSR+12                                              08153000
TSLLSTSR EQU   0                                                        08154000
TSLLOPTF EQU   TSLLSTSR+7                                               08155000
TSLGET   EQU   0                                                        08156000
TSLGOPTF EQU   TSLGET+7                                                 08157000
TSLSICDS EQU   0                                                        08158000
TSLSSMD  EQU   TSLSICDS                                                 08159000
TSLSOPTF EQU   TSLSICDS+7                                               08160000
TSLSOICT EQU   TSLSOPTF                                                 08161000
TSLSOCDS EQU   TSLSOPTF                                                 08162000
TSLSICTP EQU   TSLSICDS+8                                               08163000
TSLSICTF EQU   TSLSICDS+16                                              08164000
TSLSIFND EQU   TSLSICTF                                                 08165000
TSLSISUP EQU   TSLSICTF                                                 08166000
TSLSCDSF EQU   TSLSICDS+18                                              08167000
TSLSCOK  EQU   TSLSCDSF                                                 08168000
TSLSCERR EQU   TSLSCDSF                                                 08169000
TSLENTSR EQU   0                                                        08170000
TSLEOPTF EQU   TSLENTSR+2                                               08171000
TSLMFUNC EQU   0                                                        08172000
TSLMTYPE EQU   TSLMFUNC                                                 08173000
TSLMSMD  EQU   TSLMFUNC+1                                               08174000
TSLRELM  EQU   0                                                        08175000
SELMNAME EQU   0                                                        08176000
SELMTYPE EQU   0                                                        08177000
M1CFMID  EQU   0                                                        08178000
M1AFMID  EQU   0                                                        08179000
M1CRMID  EQU   0                                                        08180000
M1ARMID  EQU   0                                                        08181000
M1ICMID  EQU   0                                                        08182000
M1IAMID  EQU   0                                                        08183000
D2RCRD   EQU   0                                                        08184000
D2RKEY   EQU   D2RCRD                                                   08185000
D2RSMD   EQU   D2RKEY                                                   08186000
D2RDATA  EQU   D2RCRD+7                                                 08187000
D2RFLAGS EQU   D2RDATA                                                  08188000
D2RFOK   EQU   D2RFLAGS                                                 08189000
D2RFERR  EQU   D2RFLAGS                                                 08190000
IOPBS01  EQU   0                                                        08191000
IOPBS03  EQU   0                                                        08192000
TBLXPARM EQU   0                                                        08193000
TBLXINDX EQU   TBLXPARM+4                                               08194000
TBLXIOPF EQU   TBLXPARM+20                                              08195000
TBLXTBL  EQU   TBLXPARM+28                                              08196000
TBLXTOP  EQU   TBLXPARM+32                                              08197000
TBLXNULL EQU   TBLXPARM+36                                              08198000
TBLXFUNC EQU   TBLXPARM+64                                              08199000
TBLXFLG1 EQU   TBLXPARM+80                                              08200000
TBLXTSLP EQU   TBLXPARM+84                                              08201000
TBLXRC   EQU   TBLXPARM+92                                              08202000
TBLXD2GT EQU   TBLXPARM+100                                             08203000
TBLXIOP3 EQU   TBLXPARM+104                                             08204000
BLDESMD  EQU   0                                                        08205000
BLDESUBE EQU   0                                                        08206000
BLDICTYP EQU   0                                                        08207000
ASMGIOP  EQU   0                                                        08208000
SRCENTRY EQU   0                                                        08209000
MODENTRY EQU   0                                                        08210000
BLDAENT  EQU   0                                                        08211000
BLDAIOP  EQU   0                                                        08212000
MODCSMD  EQU   0                                                        08213000
CK1IOP   EQU   0                                                        08214000
MOD1ENT  EQU   0                                                        08215000
M1PCICT@ EQU   0                                                        08216000
M1PLST@  EQU   0                                                        08217000
M1PAANS  EQU   0                                                        08218000
M1PAPART EQU   0                                                        08219000
M1MTXT1  EQU   0                                                        08220000
M1MPART  EQU   0                                                        08221000
M1MSMD   EQU   0                                                        08222000
M1MDDN   EQU   0                                                        08223000
M1CSMD   EQU   0                                                        08224000
M1CANS   EQU   0                                                        08225000
M1CPART  EQU   0                                                        08226000
M1CICT@  EQU   0                                                        08227000
M1ASMD   EQU   0                                                        08228000
M1AANS   EQU   0                                                        08229000
M1APART  EQU   0                                                        08230000
VRSCSMD  EQU   0                                                        08231000
VRSCELM  EQU   0                                                        08232000
VRSCANS  EQU   0                                                        08233000
REGRIOP  EQU   0                                                        08234000
REGRSMD  EQU   0                                                        08235000
REGRELM  EQU   0                                                        08236000
SRHXSMD  EQU   0                                                        08237000
SRHXELM  EQU   0                                                        08238000
SRHXPIND EQU   0                                                        08239000
CNV1ENT  EQU   0                                                        08240000
CNV1IOPT EQU   0                                                        08241000
CNV1XRFT EQU   0                                                        08242000
CNV2ENT  EQU   0                                                        08243000
CNV2SELT EQU   0                                                        08244000
CNV3IND  EQU   0                                                        08245000
CNV3ITYP EQU   0                                                        08246000
FSMDENT  EQU   0                                                        08247000
IOPUDATA EQU   IOPEND                                                   08248000
IOPINAM3 EQU   IOPINAME                                                 08249000
@NM00064 EQU   IOPINAM3                                                 08250000
IOPSTCMP EQU   IOPUDATA                                                 08251000
IOPDYNDT EQU   IOPUDATA                                                 08252000
IOPSPACE EQU   IOPDYNDT+44                                              08253000
IOPDTYPE EQU   IOPDYNDT+50                                              08254000
IOPNTMAX EQU   IOPDRMAP                                                 08255000
IOPNTMAP EQU   IOPDRMAP                                                 08256000
IOPCDMAP EQU   IOPNTMAP                                                 08257000
IOPPTMAP EQU   IOPCDMAP                                                 08258000
IOPSCMAP EQU   IOPPTMAP                                                 08259000
IOPDIRCT EQU   IOPSCMAP+12                                              08260000
IOPCDMAX EQU   IOPDIRCT                                                 08261000
IOPCQMAP EQU   IOPDRMAP                                                 08262000
@NM00075 EQU   IOPUDATA                                                 08263000
@NM00076 EQU   IOPUDATA                                                 08264000
IOPASMNT EQU   IOPUDATA                                                 08265000
IOPASMDR EQU   IOPASMNT                                                 08266000
IOPABUNT EQU   IOPASMDR+1                                               08267000
IOPLMDNT EQU   IOPUDATA                                                 08268000
IOPLMDDR EQU   IOPLMDNT                                                 08269000
IOPLMLEP EQU   IOPLMDDR+1                                               08270000
IOPLMDF1 EQU   IOPLMLEP                                                 08271000
IOPFLGS2 EQU   IOPLMDF1                                                 08272000
IOPLMDF2 EQU   IOPLMLEP+1                                               08273000
IOPLMDF3 EQU   IOPLMLEP+2                                               08274000
IOPLMDF4 EQU   IOPLMLEP+3                                               08275000
IOPLMDF5 EQU   IOPLMDDR+5                                               08276000
IOPFLGS3 EQU   IOPLMDF5                                                 08277000
IOPLMDFX EQU   IOPLMDNT+24                                              08278000
@NM00085 EQU   IOPLMDFX                                                 08279000
IOPLNTRY EQU   IOPLMDFX+8                                               08280000
IOPLSYS  EQU   IOPLNTRY                                                 08281000
IOPSYSLB EQU   IOPLSYS                                                  08282000
IOPMACNT EQU   IOPUDATA                                                 08283000
IOPMACDR EQU   IOPMACNT                                                 08284000
IOPRMIDE EQU   IOPMACDR+1                                               08285000
IOPRMID  EQU   IOPRMIDE                                                 08286000
IOPRMST  EQU   IOPRMIDE+7                                               08287000
IOPFMIDE EQU   IOPMACDR+9                                               08288000
IOPFMID  EQU   IOPFMIDE                                                 08289000
IOPMACFX EQU   IOPMACNT+24                                              08290000
IOPBUNT  EQU   IOPMACFX                                                 08291000
IOPMCDLB EQU   IOPMACFX+72                                              08292000
IOPMCEND EQU   IOPMACNT+104                                             08293000
IOPMACVR EQU   IOPMCEND                                                 08294000
IOPMCENT EQU   IOPMACVR                                                 08295000
IOPMCDTA EQU   IOPMCENT                                                 08296000
IOPMCASM EQU   IOPMCDTA                                                 08297000
IOPMACID EQU   IOPMCASM                                                 08298000
IOPMACND EQU   IOPMACID                                                 08299000
IOPMACST EQU   IOPMCASM+7                                               08300000
IOPMCIND EQU   IOPMCENT+8                                               08301000
IOPMCTYP EQU   IOPMCIND                                                 08302000
IOPEOFNT EQU   IOPUDATA                                                 08303000
IOPSRCNT EQU   IOPUDATA                                                 08304000
IOPSRCDR EQU   IOPSRCNT                                                 08305000
@NM00096 EQU   IOPSRCDR+1                                               08306000
@NM00098 EQU   @NM00096+7                                               08307000
@NM00102 EQU   IOPSRCDR+9                                               08308000
IOPSRCFX EQU   IOPSRCNT+24                                              08309000
@NM00106 EQU   IOPSRCFX                                                 08310000
IOPSREND EQU   IOPSRCNT+104                                             08311000
IOPSRCVR EQU   IOPSREND                                                 08312000
IOPSNTRY EQU   IOPSRCVR                                                 08313000
IOPSRDTA EQU   IOPSNTRY                                                 08314000
IOPSRCID EQU   IOPSRDTA                                                 08315000
IOPSRCST EQU   IOPSRDTA+7                                               08316000
IOPMODNT EQU   IOPUDATA                                                 08317000
IOPMODDR EQU   IOPMODNT                                                 08318000
@NM00112 EQU   IOPMODDR+1                                               08319000
@NM00114 EQU   @NM00112+7                                               08320000
@NM00118 EQU   IOPMODDR+9                                               08321000
IOPMODFX EQU   IOPMODNT+24                                              08322000
@NM00122 EQU   IOPMODFX                                                 08323000
IOPMDLEP EQU   IOPMODFX+8                                               08324000
IOPMODF1 EQU   IOPMDLEP                                                 08325000
IOPMODF2 EQU   IOPMDLEP+1                                               08326000
IOPMODF3 EQU   IOPMDLEP+2                                               08327000
IOPMODF4 EQU   IOPMDLEP+3                                               08328000
IOPMDEND EQU   IOPMODNT+104                                             08329000
IOPMODVR EQU   IOPMDEND                                                 08330000
IOPMNTRY EQU   IOPMODVR                                                 08331000
IOPMDDTA EQU   IOPMNTRY                                                 08332000
IOPLMODS EQU   IOPMDDTA                                                 08333000
IOPMODID EQU   IOPLMODS                                                 08334000
IOPMODST EQU   IOPLMODS+7                                               08335000
IOPDLBNT EQU   IOPUDATA                                                 08336000
IOPDLBDR EQU   IOPDLBNT                                                 08337000
IOPDLBFX EQU   IOPDLBNT+24                                              08338000
@NM00133 EQU   IOPDLBFX                                                 08339000
IOPDLEND EQU   IOPDLBNT+104                                             08340000
IOPDLBVR EQU   IOPDLEND                                                 08341000
IOPDNTRY EQU   IOPDLBVR                                                 08342000
IOPDSYS  EQU   IOPDNTRY                                                 08343000
IOPSYSNT EQU   IOPUDATA                                                 08344000
IOPSYSDR EQU   IOPSYSNT                                                 08345000
IOPSYSF1 EQU   IOPSYSDR+4                                               08346000
IOPFLGS7 EQU   IOPSYSF1                                                 08347000
IOPSYSFX EQU   IOPSYSNT+24                                              08348000
@NM00140 EQU   IOPSYSFX                                                 08349000
IOPSYEND EQU   IOPSYSNT+184                                             08350000
IOPSYSVR EQU   IOPSYEND                                                 08351000
IOPSYSTR EQU   IOPSYSVR                                                 08352000
IOPSYNTR EQU   IOPSYSTR                                                 08353000
IOPPTFNT EQU   IOPUDATA                                                 08354000
IOPPTFDR EQU   IOPPTFNT                                                 08355000
IOPPSTAT EQU   IOPPTFDR+2                                               08356000
IOPPTFF1 EQU   IOPPSTAT                                                 08357000
IOPFLGS5 EQU   IOPPTFF1                                                 08358000
IOPRES   EQU   IOPFLGS5                                                 08359000
IOPERROR EQU   IOPFLGS5                                                 08360000
IOPPTFF2 EQU   IOPPSTAT+1                                               08361000
IOPPTFF3 EQU   IOPPSTAT+3                                               08362000
IOPSBYP  EQU   IOPPTFF3                                                 08363000
IOPDBYP  EQU   IOPPTFF3                                                 08364000
IOPPTFFX EQU   IOPPTFNT+24                                              08365000
@NM00149 EQU   IOPPTFFX                                                 08366000
@NM00150 EQU   @NM00149                                                 08367000
IOPPDTES EQU   IOPPTFFX+41                                              08368000
@NM00153 EQU   IOPPDTES                                                 08369000
IOPPTPFX EQU   IOPPDTES+6                                               08370000
IOPDATES EQU   IOPPTPFX                                                 08371000
IOPPTEND EQU   IOPPTFNT+104                                             08372000
IOPPTFVR EQU   IOPPTEND                                                 08373000
IOPPNTRY EQU   IOPPTFVR                                                 08374000
IOPPMODS EQU   IOPPNTRY                                                 08375000
IOPPTFND EQU   IOPPMODS                                                 08376000
IOPPIND  EQU   IOPPNTRY+8                                               08377000
IOPENTNT EQU   IOPUDATA+104                                             08378000
IOPSRLNT EQU   IOPUDATA+104                                             08379000
IOPPRENT EQU   IOPUDATA+104                                             08380000
IOPNPRNT EQU   IOPUDATA+104                                             08381000
IOPSUPNT EQU   IOPUDATA+104                                             08382000
IOPREQNT EQU   IOPUDATA+104                                             08383000
IOPIRQNT EQU   IOPUDATA+104                                             08384000
IOPFIDNT EQU   IOPUDATA+104                                             08385000
IOPDELNT EQU   IOPUDATA+104                                             08386000
IOPVERNT EQU   IOPUDATA+104                                             08387000
IOPSBYNT EQU   IOPUDATA+104                                             08388000
IOPQSMNT EQU   IOPUDATA                                                 08389000
IOPQSMDR EQU   IOPQSMNT                                                 08390000
IOPQFMNT EQU   IOPUDATA                                                 08391000
IOPQFMDR EQU   IOPQFMNT                                                 08392000
IOPQFEND EQU   IOPQFMNT+2                                               08393000
IOPQFMVR EQU   IOPQFEND                                                 08394000
IOPQFMLS EQU   IOPQFMVR                                                 08395000
IOPQFMNM EQU   IOPQFMLS                                                 08396000
IOPPTSYS EQU   IOPUDATA                                                 08397000
IOPPTSDR EQU   IOPPTSYS                                                 08398000
IOPPTSFX EQU   IOPPTSYS+24                                              08399000
IOPDSSPC EQU   IOPPTSFX                                                 08400000
IOPPTFG1 EQU   IOPPTSFX+34                                              08401000
IOPPSEND EQU   IOPPTSYS+1064                                            08402000
IOPPTSVR EQU   IOPPSEND                                                 08403000
IOPPTNTR EQU   IOPPTSVR                                                 08404000
@NM00178 EQU   IOPPTNTR                                                 08405000
IOPPTFMD EQU   @NM00178                                                 08406000
IOPPTREL EQU   IOPPTFMD                                                 08407000
IOPBPDS  EQU   IOPUDATA                                                 08408000
IOPBLEP1 EQU   IOPBPDS+8                                                08409000
IOPBLEP2 EQU   IOPBPDS+9                                                08410000
@NM00182 EQU   IOPBPDS+18                                               08411000
IOPBFTB0 EQU   @NM00182                                                 08412000
IOPBFTB1 EQU   IOPBFTB0                                                 08413000
ICTENDNT EQU   ICTENDCH                                                 08414000
ICTENDIX EQU   ICTENDCH                                                 08415000
XRFRCD1  EQU   XRFRCD                                                   08416000
XRFRCD2  EQU   XRFRCD                                                   08417000
XRFRCD3  EQU   XRFRCD                                                   08418000
XRF3MAC  EQU   XRFRCD3+1                                                08419000
XRF3MOD  EQU   XRF3MAC                                                  08420000
XRF3PTF  EQU   XRFRCD3+17                                               08421000
XRF3PF1  EQU   XRFRCD3+24                                               08422000
XRF3STAT EQU   XRF3PF1                                                  08423000
XRF3PIND EQU   XRFRCD3+26                                               08424000
XRFRCD4  EQU   XRFRCD                                                   08425000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08426000
@NM00283 EQU   XRFRCD4+28                                               08427000
@NM00282 EQU   XRFRCD4+18                                               08428000
XRFX4PTF EQU   XRFRCD4+11                                               08429000
@NM00281 EQU   XRFRCD4+10                                               08430000
@NM00280 EQU   XRFRCD4+9                                                08431000
XRF4PTF  EQU   XRFRCD4+1                                                08432000
@NM00279 EQU   XRFRCD4                                                  08433000
@NM00278 EQU   XRFRCD3+29                                               08434000
@NM00277 EQU   XRFRCD3+28                                               08435000
XRF3PF3  EQU   XRFRCD3+27                                               08436000
XRF3PTYP EQU   XRFRCD3+25                                               08437000
XRF3TIM  EQU   XRFRCD3+14                                               08438000
XRF3DAT  EQU   XRFRCD3+11                                               08439000
@NM00276 EQU   XRFRCD3+10                                               08440000
@NM00275 EQU   XRFRCD3+9                                                08441000
XRF3SRC  EQU   XRF3MOD                                                  08442000
@NM00274 EQU   XRFRCD3                                                  08443000
@NM00273 EQU   XRFRCD2+29                                               08444000
@NM00272 EQU   XRFRCD2+19                                               08445000
XRF2MOD  EQU   XRFRCD2+11                                               08446000
@NM00271 EQU   XRFRCD2+10                                               08447000
@NM00270 EQU   XRFRCD2+9                                                08448000
XRF2LMD  EQU   XRFRCD2+1                                                08449000
@NM00269 EQU   XRFRCD2                                                  08450000
@NM00268 EQU   XRFRCD1+29                                               08451000
@NM00267 EQU   XRFRCD1+19                                               08452000
XRF1MAC  EQU   XRFRCD1+11                                               08453000
@NM00266 EQU   XRFRCD1+10                                               08454000
@NM00265 EQU   XRFRCD1+9                                                08455000
XRF1ASM  EQU   XRFRCD1+1                                                08456000
@NM00264 EQU   XRFRCD1                                                  08457000
IOPBCEND EQU   IOPBPDS+21                                               08458000
IOPBFTB3 EQU   IOPBFTB0+2                                               08459000
IOPBFTB2 EQU   IOPBFTB0+1                                               08460000
@NM00184 EQU   IOPBFTB1                                                 08461000
IOPBAPFP EQU   IOPBFTB1                                                 08462000
IOPBSSI  EQU   IOPBFTB1                                                 08463000
IOPBPAGA EQU   IOPBFTB1                                                 08464000
@NM00183 EQU   IOPBFTB1                                                 08465000
IOPBAOSL EQU   IOPBFTB1                                                 08466000
IOPBSEPA EQU   IOPBPDS+15                                               08467000
IOPBFTBL EQU   IOPBPDS+13                                               08468000
IOPBSTOR EQU   IOPBPDS+10                                               08469000
IOPBREFR EQU   IOPBLEP2                                                 08470000
IOPBLEF  EQU   IOPBLEP2                                                 08471000
IOPBTEST EQU   IOPBLEP2                                                 08472000
IOPBNE   EQU   IOPBLEP2                                                 08473000
@NM00181 EQU   IOPBLEP2                                                 08474000
IOPBDC   EQU   IOPBLEP2                                                 08475000
@NM00180 EQU   IOPBLEP1                                                 08476000
IOPBSCTR EQU   IOPBLEP1                                                 08477000
IOPBOL   EQU   IOPBLEP1                                                 08478000
@NM00179 EQU   IOPBLEP1                                                 08479000
IOPBOVLY EQU   IOPBLEP1                                                 08480000
IOPBREUS EQU   IOPBLEP1                                                 08481000
IOPBRENT EQU   IOPBLEP1                                                 08482000
IOPBNL   EQU   IOPBPDS+7                                                08483000
IOPBTTRN EQU   IOPBPDS+4                                                08484000
IOPBZERO EQU   IOPBPDS+3                                                08485000
IOPBTTRT EQU   IOPBPDS                                                  08486000
IOPPTIND EQU   IOPPTNTR+8                                               08487000
IOPPTSND EQU   IOPPTREL                                                 08488000
@NM00177 EQU   IOPPTSFX+872                                             08489000
IOPSYZPP EQU   IOPPTSFX+772                                             08490000
IOPSYZPR EQU   IOPPTSFX+771                                             08491000
IOPSYZPS EQU   IOPPTSFX+763                                             08492000
IOPSYZAP EQU   IOPPTSFX+755                                             08493000
IOPSYUPP EQU   IOPPTSFX+655                                             08494000
IOPSYUPR EQU   IOPPTSFX+654                                             08495000
IOPSYUPS EQU   IOPPTSFX+646                                             08496000
IOPSYUPD EQU   IOPPTSFX+638                                             08497000
IOPSYSPP EQU   IOPPTSFX+538                                             08498000
IOPSYSPR EQU   IOPPTSFX+537                                             08499000
IOPSYSPS EQU   IOPPTSFX+529                                             08500000
IOPSYSUP EQU   IOPPTSFX+521                                             08501000
IOPSYLKP EQU   IOPPTSFX+421                                             08502000
IOPSYLKR EQU   IOPPTSFX+420                                             08503000
IOPSYLKS EQU   IOPPTSFX+412                                             08504000
IOPSYLKD EQU   IOPPTSFX+404                                             08505000
IOPSYCPP EQU   IOPPTSFX+304                                             08506000
IOPSYCPR EQU   IOPPTSFX+303                                             08507000
IOPSYCPS EQU   IOPPTSFX+295                                             08508000
IOPSYCPY EQU   IOPPTSFX+287                                             08509000
IOPSYCOP EQU   IOPPTSFX+187                                             08510000
IOPSYCOR EQU   IOPPTSFX+186                                             08511000
IOPSYCOS EQU   IOPPTSFX+178                                             08512000
IOPSYCOM EQU   IOPPTSFX+170                                             08513000
IOPSYASP EQU   IOPPTSFX+70                                              08514000
IOPSYASR EQU   IOPPTSFX+69                                              08515000
IOPSYASS EQU   IOPPTSFX+61                                              08516000
IOPSYASM EQU   IOPPTSFX+53                                              08517000
@NM00176 EQU   IOPPTSFX+35                                              08518000
@NM00175 EQU   IOPPTFG1                                                 08519000
IOPPTSNJ EQU   IOPPTFG1                                                 08520000
IOPPTSNP EQU   IOPPTFG1                                                 08521000
IOPSYPLN EQU   IOPPTSFX+32                                              08522000
IOPDSPFX EQU   IOPPTSFX+6                                               08523000
IOPDSDIR EQU   IOPDSSPC+4                                               08524000
IOPDSSEC EQU   IOPDSSPC+2                                               08525000
IOPDSPRM EQU   IOPDSSPC                                                 08526000
@NM00174 EQU   IOPPTSDR+4                                               08527000
IOPPTPEM EQU   IOPPTSDR+2                                               08528000
IOPPCNVL EQU   IOPPTSDR+1                                               08529000
@NM00173 EQU   IOPPTSDR                                                 08530000
IOPQFMTP EQU   IOPQFMLS+8                                               08531000
@NM00172 EQU   IOPQFMLS+7                                               08532000
IOPQFMND EQU   IOPQFMNM                                                 08533000
@NM00171 EQU   IOPQFMDR                                                 08534000
@NM00167 EQU   IOPQSMDR                                                 08535000
@NM00166 EQU   IOPSBYNT+8                                               08536000
IOPSBYST EQU   IOPSBYNT+7                                               08537000
IOPSBYNM EQU   IOPSBYNT                                                 08538000
@NM00165 EQU   IOPVERNT+8                                               08539000
IOPVERST EQU   IOPVERNT+7                                               08540000
IOPVERNM EQU   IOPVERNT                                                 08541000
@NM00164 EQU   IOPDELNT+8                                               08542000
IOPDELST EQU   IOPDELNT+7                                               08543000
IOPDELNM EQU   IOPDELNT                                                 08544000
@NM00163 EQU   IOPFIDNT+8                                               08545000
IOPFIDST EQU   IOPFIDNT+7                                               08546000
IOPFIDNM EQU   IOPFIDNT                                                 08547000
@NM00162 EQU   IOPIRQNT+8                                               08548000
IOPIRQST EQU   IOPIRQNT+7                                               08549000
IOPIRQNM EQU   IOPIRQNT                                                 08550000
@NM00161 EQU   IOPREQNT+8                                               08551000
IOPREQST EQU   IOPREQNT+7                                               08552000
IOPREQNM EQU   IOPREQNT                                                 08553000
@NM00160 EQU   IOPSUPNT+8                                               08554000
IOPSUPST EQU   IOPSUPNT+7                                               08555000
IOPSUPNM EQU   IOPSUPNT                                                 08556000
@NM00159 EQU   IOPNPRNT+8                                               08557000
IOPNPRST EQU   IOPNPRNT+7                                               08558000
IOPNPRNM EQU   IOPNPRNT                                                 08559000
@NM00158 EQU   IOPPRENT+8                                               08560000
IOPPREST EQU   IOPPRENT+7                                               08561000
IOPPRENM EQU   IOPPRENT                                                 08562000
@NM00157 EQU   IOPSRLNT+8                                               08563000
IOPSRLST EQU   IOPSRLNT+7                                               08564000
@NM00156 EQU   IOPSRLNT+4                                               08565000
IOPSRLNM EQU   IOPSRLNT                                                 08566000
@NM00155 EQU   IOPENTNT+8                                               08567000
IOPENTST EQU   IOPENTNT+7                                               08568000
IOPENTNM EQU   IOPENTNT                                                 08569000
IOPPFMID EQU   IOPPTFFX+73                                              08570000
@NM00154 EQU   IOPPTPFX+24                                              08571000
IOPUCLT  EQU   IOPDATES+21                                              08572000
IOPUCLD  EQU   IOPDATES+18                                              08573000
IOPACCT  EQU   IOPDATES+15                                              08574000
IOPACCD  EQU   IOPDATES+12                                              08575000
IOPRSTT  EQU   IOPDATES+9                                               08576000
IOPRSTD  EQU   IOPDATES+6                                               08577000
IOPAPPT  EQU   IOPDATES+3                                               08578000
IOPAPPD  EQU   IOPDATES                                                 08579000
IOPRECT  EQU   @NM00153+3                                               08580000
IOPRECD  EQU   @NM00153                                                 08581000
@NM00152 EQU   IOPPTFFX+8                                               08582000
@NM00151 EQU   @NM00149+7                                               08583000
IOPPRELN EQU   @NM00150                                                 08584000
@NM00148 EQU   IOPPTFDR+20                                              08585000
IOPSBYNO EQU   IOPPTFDR+13                                              08586000
IOPDBYNO EQU   IOPPTFDR+6                                               08587000
@NM00147 EQU   IOPPTFF3                                                 08588000
IOPFLF   EQU   IOPPTFF3                                                 08589000
IOPPMDLP EQU   IOPPTFF2+1                                               08590000
IOPPADDP EQU   IOPPTFF2+1                                               08591000
@NM00146 EQU   IOPPTFF2+1                                               08592000
IOPLRFP  EQU   IOPPTFF2                                                 08593000
IOPJCLP  EQU   IOPPTFF2                                                 08594000
IOPSUPP  EQU   IOPPTFF2                                                 08595000
IOPREQP  EQU   IOPPTFF2                                                 08596000
IOPPREP  EQU   IOPPTFF2                                                 08597000
IOPNPRP  EQU   IOPPTFF2                                                 08598000
IOPIRQP  EQU   IOPPTFF2                                                 08599000
IOPDELP  EQU   IOPPTFF2                                                 08600000
IOPREGEN EQU   IOPFLGS5                                                 08601000
IOPBYP   EQU   IOPFLGS5                                                 08602000
IOPDUMMP EQU   IOPFLGS5                                                 08603000
@NM00145 EQU   IOPFLGS5                                                 08604000
IOPACC   EQU   IOPFLGS5                                                 08605000
IOPAPP   EQU   IOPFLGS5                                                 08606000
IOPPTYPE EQU   IOPPTFDR+1                                               08607000
@NM00144 EQU   IOPPTFDR                                                 08608000
IOPSYSTP EQU   IOPSYSTR+8                                               08609000
IOPSYSND EQU   IOPSYNTR                                                 08610000
@NM00143 EQU   IOPSYSFX+21                                              08611000
IOPSYSID EQU   IOPSYSFX+13                                              08612000
IOPNUCID EQU   IOPSYSFX+12                                              08613000
IOPSREL  EQU   IOPSYSFX+8                                               08614000
@NM00142 EQU   @NM00140+7                                               08615000
@NM00141 EQU   @NM00140                                                 08616000
@NM00139 EQU   IOPSYSDR+5                                               08617000
@NM00138 EQU   IOPFLGS7                                                 08618000
IOPSYNG  EQU   IOPFLGS7                                                 08619000
IOPSYDL  EQU   IOPFLGS7                                                 08620000
IOPSTSNP EQU   IOPFLGS7                                                 08621000
IOPMTSNP EQU   IOPFLGS7                                                 08622000
IOPPEMAX EQU   IOPSYSDR+2                                               08623000
IOPSCNVL EQU   IOPSYSDR+1                                               08624000
@NM00137 EQU   IOPSYSDR                                                 08625000
IOPDLIND EQU   IOPDNTRY+8                                               08626000
IOPDLBND EQU   IOPDSYS                                                  08627000
@NM00136 EQU   IOPDLBFX+8                                               08628000
@NM00135 EQU   @NM00133+7                                               08629000
@NM00134 EQU   @NM00133                                                 08630000
@NM00132 EQU   IOPDLBDR+1                                               08631000
@NM00131 EQU   IOPDLBDR                                                 08632000
IOPMDIND EQU   IOPMNTRY+8                                               08633000
@NM00130 EQU   IOPMODST                                                 08634000
IOPMODND EQU   IOPMODID                                                 08635000
IOPDLIB  EQU   IOPMODFX+72                                              08636000
@NM00129 EQU   IOPMODFX+12                                              08637000
@NM00128 EQU   IOPMODF4                                                 08638000
@NM00127 EQU   IOPMODF3                                                 08639000
@NM00126 EQU   IOPMODF2                                                 08640000
IOPMPAGA EQU   IOPMODF2                                                 08641000
IOPMNE   EQU   IOPMODF2                                                 08642000
@NM00125 EQU   IOPMODF1                                                 08643000
IOPMDC   EQU   IOPMODF1                                                 08644000
IOPMREFR EQU   IOPMODF1                                                 08645000
IOPMOVLY EQU   IOPMODF1                                                 08646000
IOPMSCTR EQU   IOPMODF1                                                 08647000
IOPMREUS EQU   IOPMODF1                                                 08648000
IOPMRENT EQU   IOPMODF1                                                 08649000
IOPMAPF  EQU   IOPMODF1                                                 08650000
@NM00124 EQU   @NM00122+7                                               08651000
@NM00123 EQU   @NM00122                                                 08652000
@NM00121 EQU   IOPMODDR+17                                              08653000
@NM00120 EQU   @NM00118+7                                               08654000
@NM00119 EQU   @NM00118                                                 08655000
@NM00117 EQU   @NM00114                                                 08656000
@NM00116 EQU   @NM00114                                                 08657000
@NM00115 EQU   @NM00114                                                 08658000
@NM00113 EQU   @NM00112                                                 08659000
@NM00111 EQU   IOPMODDR                                                 08660000
IOPSRIND EQU   IOPSNTRY+8                                               08661000
@NM00110 EQU   IOPSRCST                                                 08662000
IOPSRCND EQU   IOPSRCID                                                 08663000
IOPSRDLB EQU   IOPSRCFX+72                                              08664000
IOPSRSYS EQU   IOPSRCFX+64                                              08665000
@NM00109 EQU   IOPSRCFX+8                                               08666000
@NM00108 EQU   @NM00106+7                                               08667000
@NM00107 EQU   @NM00106                                                 08668000
@NM00105 EQU   IOPSRCDR+18                                              08669000
IOPSRLNG EQU   IOPSRCDR+17                                              08670000
@NM00104 EQU   @NM00102+7                                               08671000
@NM00103 EQU   @NM00102                                                 08672000
@NM00101 EQU   @NM00098                                                 08673000
@NM00100 EQU   @NM00098                                                 08674000
@NM00099 EQU   @NM00098                                                 08675000
@NM00097 EQU   @NM00096                                                 08676000
@NM00095 EQU   IOPSRCDR                                                 08677000
IOPEOFND EQU   IOPEOFNT                                                 08678000
@NM00094 EQU   IOPMACST                                                 08679000
IOPMCSYS EQU   IOPMACFX+64                                              08680000
@NM00093 EQU   IOPMACFX+8                                               08681000
IOPBUTYP EQU   IOPBUNT+7                                                08682000
IOPBUSMD EQU   IOPBUNT                                                  08683000
@NM00092 EQU   IOPMACDR+18                                              08684000
IOPMCLNG EQU   IOPMACDR+17                                              08685000
IOPFMST  EQU   IOPFMIDE+7                                               08686000
@NM00091 EQU   IOPRMST                                                  08687000
IOPRMASM EQU   IOPRMST                                                  08688000
@NM00090 EQU   IOPRMST                                                  08689000
@NM00089 EQU   IOPMACDR                                                 08690000
IOPLMIND EQU   IOPLNTRY+8                                               08691000
IOPLMDND EQU   IOPSYSLB                                                 08692000
@NM00087 EQU   @NM00085+7                                               08693000
@NM00086 EQU   @NM00085                                                 08694000
@NM00084 EQU   IOPLMDDR+6                                               08695000
@NM00083 EQU   IOPFLGS3                                                 08696000
IOPCHREP EQU   IOPFLGS3                                                 08697000
IOPLINK  EQU   IOPFLGS3                                                 08698000
IOPCOPY  EQU   IOPFLGS3                                                 08699000
@NM00082 EQU   IOPLMDF4                                                 08700000
@NM00081 EQU   IOPLMDF3                                                 08701000
@NM00080 EQU   IOPLMDF2                                                 08702000
IOPPAGA  EQU   IOPLMDF2                                                 08703000
IOPNE    EQU   IOPLMDF2                                                 08704000
@NM00079 EQU   IOPFLGS2                                                 08705000
IOPDC    EQU   IOPFLGS2                                                 08706000
IOPREFR  EQU   IOPFLGS2                                                 08707000
IOPOVLY  EQU   IOPFLGS2                                                 08708000
IOPSCTR  EQU   IOPFLGS2                                                 08709000
IOPREUS  EQU   IOPFLGS2                                                 08710000
IOPRENT  EQU   IOPFLGS2                                                 08711000
IOPAPF   EQU   IOPFLGS2                                                 08712000
@NM00078 EQU   IOPLMDDR                                                 08713000
@NM00077 EQU   IOPASMDR+9                                               08714000
IOPABUTP EQU   IOPABUNT+7                                               08715000
IOPABUPT EQU   IOPABUNT                                                 08716000
IOPNTLVL EQU   IOPASMDR                                                 08717000
IOPALLOC EQU   @NM00076+4                                               08718000
IOPUSED  EQU   @NM00076                                                 08719000
IOPTPSEQ EQU   @NM00075+8                                               08720000
IOPVLSER EQU   @NM00075+2                                               08721000
IOPBLKSI EQU   @NM00075                                                 08722000
IOPCQMAX EQU   IOPCQMAP+12                                              08723000
@NM00074 EQU   IOPCQMAP+11                                              08724000
@NM00073 EQU   IOPCQMAP+8                                               08725000
@NM00072 EQU   IOPCQMAP                                                 08726000
IOPPTMAX EQU   IOPCDMAX                                                 08727000
@NM00071 EQU   IOPSCMAP+11                                              08728000
@NM00070 EQU   IOPSCMAP+8                                               08729000
@NM00069 EQU   IOPSCMAP                                                 08730000
IOPDIRMX EQU   IOPNTMAX+12                                              08731000
@NM00068 EQU   IOPNTMAX+11                                              08732000
@NM00067 EQU   IOPNTMAX+8                                               08733000
@NM00066 EQU   IOPNTMAX                                                 08734000
@NM00065 EQU   IOPDTYPE                                                 08735000
IOPDMOD  EQU   IOPDTYPE                                                 08736000
IOPDJCL  EQU   IOPDTYPE                                                 08737000
IOPDSRC  EQU   IOPDTYPE                                                 08738000
IOPDMAC  EQU   IOPDTYPE                                                 08739000
IOPSDIR  EQU   IOPSPACE+4                                               08740000
IOPSSCND EQU   IOPSPACE+2                                               08741000
IOPSPRIM EQU   IOPSPACE                                                 08742000
IOPDSN   EQU   IOPDYNDT                                                 08743000
IOPNTYPE EQU   IOPSTCMP+17                                              08744000
IOPNNAME EQU   IOPSTCMP+9                                               08745000
IOPOTYPE EQU   IOPSTCMP+8                                               08746000
IOPONAME EQU   IOPSTCMP                                                 08747000
IOPISEQ3 EQU   IOPINAM3+6                                               08748000
IOPITYP3 EQU   @NM00064+5                                               08749000
IOPIPTF3 EQU   @NM00064                                                 08750000
TBLXEND0 EQU   TBLXPARM+124                                             08751000
@NM00007 EQU   TBLXPARM+108                                             08752000
TBLXDLGT EQU   TBLXPARM+96                                              08753000
@NM00006 EQU   TBLXRC+3                                                 08754000
TBLXIRC  EQU   TBLXRC+2                                                 08755000
TBLXLRC  EQU   TBLXRC+1                                                 08756000
TBLXTRC  EQU   TBLXRC                                                   08757000
TBLXIBGN EQU   TBLXPARM+88                                              08758000
@NM00005 EQU   TBLXPARM+83                                              08759000
@NM00004 EQU   TBLXPARM+82                                              08760000
@NM00003 EQU   TBLXPARM+81                                              08761000
@NM00002 EQU   TBLXFLG1                                                 08762000
TBLXTCRC EQU   TBLXFLG1                                                 08763000
TBLXFUND EQU   TBLXPARM+72                                              08764000
@NM00001 EQU   TBLXPARM+62                                              08765000
TBLXCRQI EQU   TBLXPARM+61                                              08766000
TBLXCDSI EQU   TBLXPARM+60                                              08767000
TBLXLMGT EQU   TBLXPARM+56                                              08768000
TBLXSCGT EQU   TBLXPARM+52                                              08769000
TBLXSREL EQU   TBLXPARM+48                                              08770000
TBLXASGT EQU   TBLXPARM+44                                              08771000
TBLXIFGT EQU   TBLXPARM+40                                              08772000
TBLXSEGT EQU   TBLXPARM+24                                              08773000
TBLXIOP2 EQU   TBLXPARM+16                                              08774000
TBLXEND  EQU   TBLXINDX+8                                               08775000
TBLXSTRT EQU   TBLXINDX+4                                               08776000
TBLXCUR  EQU   TBLXINDX                                                 08777000
TBLXHDR  EQU   TBLXPARM                                                 08778000
@NM00315 EQU   D2RFLAGS                                                 08779000
D2RFDEL  EQU   D2RFLAGS                                                 08780000
TSLRRTNP EQU   TSLRELM+12                                               08781000
TSLRAPTR EQU   TSLRELM+8                                                08782000
@NM00262 EQU   TSLRELM+7                                                08783000
TSLRSMD  EQU   TSLRELM                                                  08784000
TSLEFNDP EQU   TSLENTSR+12                                              08785000
TSLEBGNP EQU   TSLENTSR+8                                               08786000
TSLENMEP EQU   TSLENTSR+4                                               08787000
@NM00261 EQU   TSLENTSR+3                                               08788000
@NM00260 EQU   TSLEOPTF                                                 08789000
TSLEONXT EQU   TSLEOPTF                                                 08790000
TSLEVER# EQU   TSLENTSR+1                                               08791000
TSLETYPE EQU   TSLENTSR                                                 08792000
@NM00259 EQU   TSLSICDS+19                                              08793000
TSLSDUM  EQU   TSLSCDSF                                                 08794000
@NM00258 EQU   TSLSCDSF                                                 08795000
@NM00257 EQU   TSLSCDSF                                                 08796000
TSLSCDEL EQU   TSLSCDSF                                                 08797000
TSLSCSUP EQU   TSLSCDSF                                                 08798000
TSLSCFND EQU   TSLSCDSF                                                 08799000
@NM00256 EQU   TSLSICDS+17                                              08800000
TSLSISLS EQU   TSLSICTF                                                 08801000
TSLSINOG EQU   TSLSICTF                                                 08802000
TSLSIDLI EQU   TSLSICTF                                                 08803000
TSLSIDLE EQU   TSLSICTF                                                 08804000
TSLSIDEL EQU   TSLSICTF                                                 08805000
TSLSIOK  EQU   TSLSICTF                                                 08806000
TSLSIOPP EQU   TSLSICDS+12                                              08807000
@NM00255 EQU   TSLSOPTF                                                 08808000
TSLSOXTD EQU   TSLSOPTF                                                 08809000
TSLSOMSG EQU   TSLSOPTF                                                 08810000
TSLSOALL EQU   TSLSOPTF                                                 08811000
TSLGDSID EQU   TSLGET+12                                                08812000
TSLGIOPP EQU   TSLGET+8                                                 08813000
@NM00254 EQU   TSLGOPTF                                                 08814000
TSLGOXTD EQU   TSLGOPTF                                                 08815000
TSLGOMSG EQU   TSLGOPTF                                                 08816000
@NM00253 EQU   TSLGOPTF                                                 08817000
@NM00252 EQU   TSLGOPTF                                                 08818000
@NM00251 EQU   TSLGOPTF                                                 08819000
TSLGSMD  EQU   TSLGET                                                   08820000
TSLLRTNP EQU   TSLLSTSR+12                                              08821000
TSLLOFST EQU   TSLLSTSR+8                                               08822000
@NM00250 EQU   TSLLOPTF                                                 08823000
TSLLONXT EQU   TSLLOPTF                                                 08824000
TSLLSMD  EQU   TSLLSTSR                                                 08825000
@NM00249 EQU   TSLICTSR+13                                              08826000
@NM00248 EQU   TSLICTF                                                  08827000
TSLINOG  EQU   TSLICTF                                                  08828000
TSLIDLI  EQU   TSLICTF                                                  08829000
TSLIDLE  EQU   TSLICTF                                                  08830000
TSLIDEL  EQU   TSLICTF                                                  08831000
TSLISUP  EQU   TSLICTF                                                  08832000
TSLIOK   EQU   TSLICTF                                                  08833000
TSLIFND  EQU   TSLICTF                                                  08834000
TSLICTP  EQU   TSLICTSR+8                                               08835000
@NM00247 EQU   TSLIOPTF                                                 08836000
TSLIONXT EQU   TSLIOPTF                                                 08837000
TSLTBLXP EQU   TSLPARMS                                                 08838000
@NM00246 EQU   HMASMGTP+27                                              08839000
@NM00245 EQU   GTPFLGS1                                                 08840000
GTPRCDNF EQU   GTPFLGS1                                                 08841000
GTPNOSPM EQU   GTPFLGS1                                                 08842000
GTPPOS   EQU   GTPRESTR+8                                               08843000
GTPRCD   EQU   GTPRESTR+4                                               08844000
GTPPAG   EQU   GTPRESTR                                                 08845000
GTPWKAD  EQU   HMASMGTP+8                                               08846000
@NM00244 EQU   HMASMGTP+2                                               08847000
SEFLAG2H EQU   SEFLAG2                                                  08848000
SEFLAG2G EQU   SEFLAG2                                                  08849000
SEFLAG2F EQU   SEFLAG2                                                  08850000
SEFLAG2E EQU   SEFLAG2                                                  08851000
SEFLAG2D EQU   SEFLAG2                                                  08852000
SEFLAG2C EQU   SEFLAG2                                                  08853000
SEFLAG2B EQU   SEFLAG2                                                  08854000
SEFLAG2A EQU   SEFLAG2                                                  08855000
SEFOUND  EQU   SEFLAGS                                                  08856000
@NM00243 EQU   SEFLAGS                                                  08857000
SEFMID   EQU   SEFLAGS                                                  08858000
SENOJCL  EQU   SEFLAGS                                                  08859000
SEEXCLUD EQU   SEFLAGS                                                  08860000
SEGROUP  EQU   SEFLAGS                                                  08861000
@NM00242 EQU   SENAME+7                                                 08862000
SEPTFNO  EQU   SESMDNO                                                  08863000
SESYS    EQU   SELSTFLG+1                                               08864000
SEFMD    EQU   SELSTFLG+1                                               08865000
SELMD    EQU   SELSTFLG+1                                               08866000
SEDLB    EQU   SELSTFLG+1                                               08867000
SESMD    EQU   SELSTFLG                                                 08868000
SEMCS    EQU   SELSTFLG                                                 08869000
@NM00241 EQU   SELSTFLG                                                 08870000
ICTIXL   EQU   ICTIXLF                                                  08871000
@NM00238 EQU   ICTLMOD+38                                               08872000
ICTLTTR  EQU   ICTLMOD+31                                               08873000
ICTTG2   EQU   ICTLMOD+23                                               08874000
ICTTG1   EQU   ICTLMOD+15                                               08875000
@NM00237 EQU   ICTLFLG3                                                 08876000
ICTLZAP  EQU   ICTLFLG3                                                 08877000
ICTLLKD  EQU   ICTLFLG3                                                 08878000
ICTLCPY  EQU   ICTLFLG3                                                 08879000
ICTLXPND EQU   ICTLFLG3                                                 08880000
ICTTIND2 EQU   ICTLFLG3                                                 08881000
ICTTIND1 EQU   ICTLFLG3                                                 08882000
@NM00236 EQU   ICTLFLG2                                                 08883000
ICTLDEL  EQU   ICTLFLG2                                                 08884000
@NM00235 EQU   ICTLFLG2                                                 08885000
ICTLTDEL EQU   ICTLFLG2                                                 08886000
ICTLINK  EQU   ICTLFLG2                                                 08887000
ICTCOPY  EQU   ICTLFLG2                                                 08888000
@NM00234 EQU   ICTLFLG7                                                 08889000
@NM00233 EQU   ICTLFLG6                                                 08890000
@NM00232 EQU   ICTLFLG5                                                 08891000
ICTLPAGA EQU   ICTLFLG5                                                 08892000
ICTLNE   EQU   ICTLFLG5                                                 08893000
@NM00231 EQU   ICTLFLG1                                                 08894000
ICTLDC   EQU   ICTLFLG1                                                 08895000
ICTLREFR EQU   ICTLFLG1                                                 08896000
ICTLOVLY EQU   ICTLFLG1                                                 08897000
ICTLSCTR EQU   ICTLFLG1                                                 08898000
ICTLREUS EQU   ICTLFLG1                                                 08899000
ICTLRENT EQU   ICTLFLG1                                                 08900000
ICTLAPF  EQU   ICTLFLG1                                                 08901000
@NM00230 EQU   ICTLFLG4                                                 08902000
ICTLPASS EQU   ICTLFLG4                                                 08903000
ICTLDDCK EQU   ICTLFLG4                                                 08904000
ICTLMSG  EQU   ICTLFLG4                                                 08905000
ICTLCPL  EQU   ICTLFLG4                                                 08906000
ICTLNOGO EQU   ICTLFLG4                                                 08907000
ICTLPROC EQU   ICTLFLG4                                                 08908000
ICTLEND  EQU   ICTLNAME                                                 08909000
@NM00229 EQU   ICTMUMNT+7                                               08910000
ICTMUMND EQU   ICTMUMNM                                                 08911000
@NM00228 EQU   ICTMVRNT+7                                               08912000
ICTMVRND EQU   ICTMVRNM                                                 08913000
ICTTALND EQU   ICTTALNM                                                 08914000
ICTASMND EQU   ICTASMAD                                                 08915000
ICTMIDF1 EQU   ICTMODST                                                 08916000
ICTMIDPL EQU   ICTMODST                                                 08917000
@NM00227 EQU   ICTMODST                                                 08918000
ICTIXM   EQU   ICTIXMF                                                  08919000
@NM00226 EQU   ICTMOD+128                                               08920000
@NM00225 EQU   ICTMOD+95                                                08921000
@NM00224 EQU   ICTMOD+87                                                08922000
ICTMSSI  EQU   ICTMOD+72                                                08923000
ICTMDOBJ EQU   ICTMOD+64                                                08924000
ICTMSYSL EQU   ICTMOD+56                                                08925000
ICTMASLB EQU   ICTMOD+40                                                08926000
ICTTOLIB EQU   ICTMOD+32                                                08927000
ICTMRELN EQU   ICTMOD+22                                                08928000
@NM00223 EQU   ICTMOD+21                                                08929000
ICTMLANG EQU   ICTMOD+20                                                08930000
@NM00222 EQU   ICTMOD+19                                                08931000
ICTMACF5 EQU   ICTMOD+18                                                08932000
ICTMZMPR EQU   ICTMACF4                                                 08933000
ICTMZOMZ EQU   ICTMACF4                                                 08934000
ICTMDOAS EQU   ICTMACF4                                                 08935000
ICTMXUPD EQU   ICTMACF4                                                 08936000
ICTMFXC  EQU   ICTMACF4                                                 08937000
ICTMFXBS EQU   ICTMACF4                                                 08938000
ICTMHASM EQU   ICTMACF4                                                 08939000
ICTMACDL EQU   ICTMACF4                                                 08940000
@NM00221 EQU   ICTMLEP4                                                 08941000
@NM00220 EQU   ICTMLEP3                                                 08942000
@NM00219 EQU   ICTMLEP2                                                 08943000
ICTMPAGA EQU   ICTMLEP2                                                 08944000
ICTMNE   EQU   ICTMLEP2                                                 08945000
@NM00218 EQU   ICTMLEP1                                                 08946000
ICTMDC   EQU   ICTMLEP1                                                 08947000
ICTMREFR EQU   ICTMLEP1                                                 08948000
ICTMOVLY EQU   ICTMLEP1                                                 08949000
ICTMSCTR EQU   ICTMLEP1                                                 08950000
ICTMREUS EQU   ICTMLEP1                                                 08951000
ICTMRENT EQU   ICTMLEP1                                                 08952000
ICTMAPF  EQU   ICTMLEP1                                                 08953000
@NM00217 EQU   ICTMFLG5                                                 08954000
ICTMNORL EQU   ICTMFLG5                                                 08955000
ICTMELCK EQU   ICTMFLG5                                                 08956000
ICTMCOPY EQU   ICTMFLG5                                                 08957000
@NM00216 EQU   ICTMFLG4                                                 08958000
ICTMTSEL EQU   ICTMFLG4                                                 08959000
ICTMDSTE EQU   ICTMFLG4                                                 08960000
ICTMMIDE EQU   ICTMFLG4                                                 08961000
ICTMSELM EQU   ICTMFLG4                                                 08962000
@NM00215 EQU   ICTMFLG3                                                 08963000
ICTMPRMS EQU   ICTMFLG3                                                 08964000
ICTMALIS EQU   ICTMFLG3                                                 08965000
ICTMWRK  EQU   ICTMFLG3                                                 08966000
ICTMTRX  EQU   ICTMFLG3                                                 08967000
ICTMRELF EQU   ICTMFLG3                                                 08968000
ICTLIBTX EQU   ICTMFLG3                                                 08969000
ICTLIBLK EQU   ICTMFLG3                                                 08970000
ICTMMACU EQU   ICTMFLG1                                                 08971000
ICTMXPND EQU   ICTMFLG1                                                 08972000
ICTMZAP  EQU   ICTMFLG1                                                 08973000
@NM00214 EQU   ICTMFLG2                                                 08974000
@NM00213 EQU   ICTMFLG2                                                 08975000
ICTMMIDU EQU   ICTMFLG2                                                 08976000
ICTMDEL  EQU   ICTMFLG2                                                 08977000
ICTMPROC EQU   ICTMFLG2                                                 08978000
@NM00212 EQU   ICTSBYNT+7                                               08979000
ICTSBYND EQU   ICTSBYNM                                                 08980000
ICTDELEX EQU   ICTDELST                                                 08981000
ICTDELND EQU   ICTDELNM                                                 08982000
@NM00211 EQU   ICTVRSNT+7                                               08983000
ICTVRSND EQU   ICTVRSNM                                                 08984000
@NM00210 EQU   ICTNPRNT+7                                               08985000
ICTNPRND EQU   ICTNPRNM                                                 08986000
@NM00209 EQU   ICTCSRST                                                 08987000
@NM00208 EQU   ICTCSRST                                                 08988000
ICTCSRF  EQU   ICTCSRST                                                 08989000
@NM00207 EQU   ICTCSRST                                                 08990000
ICTCSRNM EQU   ICTIRQNT+8                                               08991000
@NM00206 EQU   ICTIRQST                                                 08992000
ICTIREQT EQU   ICTIRQST                                                 08993000
ICTIREQI EQU   ICTIRQST                                                 08994000
ICTIREQB EQU   ICTIRQST                                                 08995000
ICTIREQS EQU   ICTIRQST                                                 08996000
@NM00205 EQU   ICTIRQST                                                 08997000
ICTIRQND EQU   ICTIRQNM                                                 08998000
@NM00204 EQU   ICTPREST                                                 08999000
ICTPREQT EQU   ICTPREST                                                 09000000
ICTPREQI EQU   ICTPREST                                                 09001000
ICTPREQB EQU   ICTPREST                                                 09002000
ICTPREQS EQU   ICTPREST                                                 09003000
@NM00203 EQU   ICTPREST                                                 09004000
ICTPREND EQU   ICTPRENM                                                 09005000
@NM00202 EQU   ICTSUPNT+7                                               09006000
ICTSUPND EQU   ICTSUPNM                                                 09007000
@NM00201 EQU   ICTREQST                                                 09008000
ICTRREQT EQU   ICTREQST                                                 09009000
ICTRREQI EQU   ICTREQST                                                 09010000
ICTRREQB EQU   ICTREQST                                                 09011000
ICTRREQS EQU   ICTREQST                                                 09012000
@NM00200 EQU   ICTREQST                                                 09013000
ICTREQND EQU   ICTREQNM                                                 09014000
@NM00199 EQU   ICTENTST                                                 09015000
ICTEREQT EQU   ICTENTST                                                 09016000
ICTEREQI EQU   ICTENTST                                                 09017000
ICTEREQB EQU   ICTENTST                                                 09018000
ICTEREQS EQU   ICTENTST                                                 09019000
@NM00198 EQU   ICTENTST                                                 09020000
ICTENTND EQU   ICTENTNM                                                 09021000
@NM00197 EQU   ICTPTF+100                                               09022000
ICTPTPFX EQU   ICTPTF+38                                                09023000
ICTPRELN EQU   ICTPTF+36                                                09024000
ICTPRECT EQU   ICTPTF+33                                                09025000
ICTPRECD EQU   ICTPTF+30                                                09026000
ICTPVERN EQU   ICTPTF+29                                                09027000
ICTPFMID EQU   ICTPTF+22                                                09028000
ICTPUSR8 EQU   ICTPFLGA                                                 09029000
ICTPUSR7 EQU   ICTPFLGA                                                 09030000
ICTPUSR6 EQU   ICTPFLGA                                                 09031000
ICTPUSR5 EQU   ICTPFLGA                                                 09032000
ICTPUSR4 EQU   ICTPFLGA                                                 09033000
ICTPUSR3 EQU   ICTPFLGA                                                 09034000
ICTPUSR2 EQU   ICTPFLGA                                                 09035000
ICTPPASS EQU   ICTPUSR1                                                 09036000
@NM00196 EQU   @NM00195                                                 09037000
ICTPRQBY EQU   @NM00195                                                 09038000
ICTPRQOK EQU   @NM00195                                                 09039000
ICTPRQCK EQU   @NM00195                                                 09040000
@NM00194 EQU   ICTPFLG9                                                 09041000
ICTPPDEL EQU   ICTPFLG9                                                 09042000
ICTPWRKO EQU   ICTPFLG9                                                 09043000
ICTPMSL  EQU   ICTPFLG9                                                 09044000
@NM00193 EQU   ICTPFLG8                                                 09045000
ICTPDCPL EQU   ICTPFLG8                                                 09046000
ICTPECPL EQU   ICTPFLG8                                                 09047000
ICTPGCPL EQU   ICTPFLG8                                                 09048000
@NM00192 EQU   ICTPFLG4                                                 09049000
@NM00191 EQU   ICTPFLG4                                                 09050000
@NM00190 EQU   ICTPFLG4                                                 09051000
ICTPGELM EQU   ICTPFLG4                                                 09052000
ICTPDIMP EQU   ICTPFLG4                                                 09053000
ICTPDEXP EQU   ICTPFLG4                                                 09054000
ICTPREDO EQU   ICTPFLG4                                                 09055000
ICTPCDSE EQU   ICTPFLG4                                                 09056000
@NM00189 EQU   ICTPFLG2                                                 09057000
ICTPRCND EQU   ICTPFLG2                                                 09058000
ICTPTPS  EQU   ICTPFLG2                                                 09059000
ICTPTR1  EQU   ICTPFLG2                                                 09060000
ICTPVRSP EQU   ICTPFLG2                                                 09061000
@NM00188 EQU   ICTPFLG6                                                 09062000
ICTFLF   EQU   ICTPFLF                                                  09063000
ICTPDBYP EQU   ICTPFLG6                                                 09064000
ICTPSBYP EQU   ICTPFLG6                                                 09065000
ICTPMDLP EQU   ICTPFLG5+1                                               09066000
ICTPADDP EQU   ICTPFLG5+1                                               09067000
@NM00187 EQU   ICTPFLG5+1                                               09068000
ICTPLRFP EQU   ICTPFLG5                                                 09069000
ICTPJCLP EQU   ICTPFLG5                                                 09070000
ICTPSUPP EQU   ICTPFLG5                                                 09071000
ICTPREQP EQU   ICTPFLG5                                                 09072000
ICTPPREP EQU   ICTPFLG5                                                 09073000
ICTPNPRP EQU   ICTPFLG5                                                 09074000
ICTPIRQP EQU   ICTPFLG5                                                 09075000
ICTPDELP EQU   ICTPFLG5                                                 09076000
@NM00186 EQU   ICTPFLG3                                                 09077000
ICTPSLST EQU   ICTPFLG3                                                 09078000
ICTPNOLB EQU   ICTPFLG3                                                 09079000
ICTPVERJ EQU   ICTPFLG3                                                 09080000
ICTPROCS EQU   ICTPPROC                                                 09081000
ICTREGEN EQU   ICTPFLG1                                                 09082000
ICTDUMMP EQU   ICTPFLG1                                                 09083000
@NM00185 EQU   ICTPFLG1                                                 09084000
ICTERROR EQU   ICTPFLG1                                                 09085000
ICTACC   EQU   ICTPFLG1                                                 09086000
ICTRES   EQU   ICTPFLG1                                                 09087000
ICTAPP   EQU   ICTPFLG1                                                 09088000
ICTLEN   EQU   ICTGMSPL+1                                               09089000
ICTSP    EQU   ICTGMSPL                                                 09090000
ICTLLEN  EQU   ICTLSPLN+1                                               09091000
ICTLSP   EQU   ICTLSPLN                                                 09092000
ICTMLEN  EQU   ICTMSPLN+1                                               09093000
ICTMSP   EQU   ICTMSPLN                                                 09094000
ICTPLEN  EQU   ICTPSPLN+1                                               09095000
ICTPSP   EQU   ICTPSPLN                                                 09096000
IOPBS04E EQU   IOPBS04+2                                                09097000
IOPBAPFC EQU   IOPBAPF+1                                                09098000
IOPBAPFL EQU   IOPBAPF                                                  09099000
IOPBS2NM EQU   IOPBS02+3                                                09100000
IOPBS2EP EQU   IOPBS02                                                  09101000
IOPQSMTP EQU   IOPQSMLS+8                                               09102000
@NM00170 EQU   IOPQSMLS+7                                               09103000
IOPQSMND EQU   IOPQSMNM                                                 09104000
@NM00169 EQU   @NM00168+7                                               09105000
IOPQSMFM EQU   @NM00168                                                 09106000
@NM00088 EQU   IOPLMCTL+17                                              09107000
IOPLMCRD EQU   IOPLMCTL+9                                               09108000
IOPLMCRN EQU   IOPLMCTL+1                                               09109000
IOPLMCC  EQU   IOPLMCTL                                                 09110000
@NM00063 EQU   IOPUSERL                                                 09111000
@NM00062 EQU   IOPUSERL                                                 09112000
IOPALIS  EQU   IOPUSERL                                                 09113000
IOPTTR   EQU   IOPDRMAP+8                                               09114000
IOPINAM2 EQU   IOPINAM+1                                                09115000
IOPITYP2 EQU   IOPITYP                                                  09116000
@NM00061 EQU   HMASMIOP+32                                              09117000
IOPDELDD EQU   IOPDDNAM                                                 09118000
@NM00060 EQU   @NM00057+10                                              09119000
IOPSEQNO EQU   @NM00057+8                                               09120000
@NM00059 EQU   @NM00058+7                                               09121000
IOPPTFNM EQU   @NM00058                                                 09122000
CCABMREC EQU   CCABELMT+10                                              09123000
CCABPOS  EQU   CCABMPOS+8                                               09124000
CCABNAME EQU   CCABMPOS                                                 09125000
@NM00056 EQU   CCABLDLM+2                                               09126000
@NM00055 EQU   CCABLDLM                                                 09127000
CCAUPDPM EQU   @NM00053+24                                              09128000
@NM00054 EQU   @NM00053+21                                              09129000
CCARUPDT EQU   CCAUPDRC                                                 09130000
CCAUPDSP EQU   @NM00053+12                                              09131000
CCAUPDTE EQU   @NM00053+8                                               09132000
CCAUPDNM EQU   @NM00053                                                 09133000
CCASUPPM EQU   @NM00051+24                                              09134000
@NM00052 EQU   @NM00051+21                                              09135000
CCARSUP  EQU   CCASUPRC                                                 09136000
CCASUPSP EQU   @NM00051+12                                              09137000
CCAIOSUP EQU   @NM00051+8                                               09138000
CCASUPNM EQU   @NM00051                                                 09139000
CCAZAPPM EQU   @NM00049+24                                              09140000
@NM00050 EQU   @NM00049+21                                              09141000
CCARZAP  EQU   CCAZAPRC                                                 09142000
CCAZAPSP EQU   @NM00049+12                                              09143000
CCASPZAP EQU   @NM00049+8                                               09144000
CCAZAPNM EQU   @NM00049                                                 09145000
CCACOMPM EQU   @NM00047+24                                              09146000
@NM00048 EQU   @NM00047+21                                              09147000
CCARCOMP EQU   CCACOMRC                                                 09148000
CCACOMSP EQU   @NM00047+12                                              09149000
CCACOMRS EQU   @NM00047+8                                               09150000
CCACOMNM EQU   @NM00047                                                 09151000
CCACPYPM EQU   @NM00045+24                                              09152000
@NM00046 EQU   @NM00045+21                                              09153000
CCARCOPY EQU   CCACPYRC                                                 09154000
CCACPYSP EQU   @NM00045+12                                              09155000
CCACOPY  EQU   @NM00045+8                                               09156000
CCACPYNM EQU   @NM00045                                                 09157000
CCAASMPM EQU   @NM00043+24                                              09158000
@NM00044 EQU   @NM00043+21                                              09159000
CCARASM  EQU   CCAASMRC                                                 09160000
CCAASMSP EQU   @NM00043+12                                              09161000
CCAASM   EQU   @NM00043+8                                               09162000
CCAASMNM EQU   @NM00043                                                 09163000
CCALKDPM EQU   @NM00041+24                                              09164000
@NM00042 EQU   @NM00041+21                                              09165000
CCARLINK EQU   CCALKDRC                                                 09166000
CCALKDSP EQU   @NM00041+12                                              09167000
CCALKED  EQU   @NM00041+8                                               09168000
CCALKDNM EQU   @NM00041                                                 09169000
CCAPGMPM EQU   @NM00039+24                                              09170000
@NM00040 EQU   @NM00039+21                                              09171000
CCABPGRC EQU   @NM00039+20                                              09172000
CCABPGSP EQU   @NM00039+12                                              09173000
CCABPGAD EQU   @NM00039+8                                               09174000
CCABPGNM EQU   @NM00039                                                 09175000
CCAEND   EQU   HMASMCCA+371                                             09176000
@NM00038 EQU   HMASMCCA+309                                             09177000
CCACURDD EQU   CCAFDSNG+3                                               09178000
CCACURDS EQU   CCAFDSNG+2                                               09179000
@NM00037 EQU   CCAFLAGB                                                 09180000
CCAOUTNG EQU   CCAFLAGB                                                 09181000
CCALOGNG EQU   CCAFLAGB                                                 09182000
CCAFMID  EQU   HMASMCCA+291                                             09183000
CCALSTDS EQU   CCAFCTL+8                                                09184000
CCARPTDS EQU   CCAFCTL+7                                                09185000
CCATIME  EQU   CCAFCTL+4                                                09186000
CCADATE  EQU   CCAFCTL+1                                                09187000
@NM00036 EQU   CCAFLAG9                                                 09188000
CCARVCAN EQU   CCAFLAG9                                                 09189000
CCARVEST EQU   CCAFLAG9                                                 09190000
CCAPTSNJ EQU   CCAFLAG9                                                 09191000
CCASTSNP EQU   CCAFLAG9                                                 09192000
CCAMTSNP EQU   CCAFLAG9                                                 09193000
CCAPTSNP EQU   CCAFLAG9                                                 09194000
@NM00035 EQU   CCAFLAG8                                                 09195000
CCAACDSC EQU   CCAFLAG8                                                 09196000
CCACDSC  EQU   CCAFLAG8                                                 09197000
@NM00034 EQU   CCAFLAG6                                                 09198000
CCAACRUP EQU   CCAFLAG6                                                 09199000
CCACRQUP EQU   CCAFLAG6                                                 09200000
CCAACDUP EQU   CCAFLAG6                                                 09201000
CCACDSUP EQU   CCAFLAG6                                                 09202000
@NM00033 EQU   CCAFLAG5                                                 09203000
CCAACROS EQU   CCAFLAG5                                                 09204000
CCACRQOS EQU   CCAFLAG5                                                 09205000
CCAACDOS EQU   CCAFLAG5                                                 09206000
CCACDSOS EQU   CCAFLAG5                                                 09207000
@NM00032 EQU   CCAFLAG4                                                 09208000
CCAACRIS EQU   CCAFLAG4                                                 09209000
CCACRQIS EQU   CCAFLAG4                                                 09210000
CCAACDIS EQU   CCAFLAG4                                                 09211000
CCACDSIS EQU   CCAFLAG4                                                 09212000
@NM00031 EQU   CCAFLAG3+1                                               09213000
CCARGNP  EQU   CCAFLAG3+1                                               09214000
CCADISRQ EQU   CCAFLAG3+1                                               09215000
CCAICTOK EQU   CCAFLAG3                                                 09216000
CCADELP  EQU   CCAFLAG3                                                 09217000
CCACMPRS EQU   CCAFLAG3                                                 09218000
CCAZAPP  EQU   CCAFLAG3                                                 09219000
CCALINKP EQU   CCAFLAG3                                                 09220000
CCACOPYP EQU   CCAFLAG3                                                 09221000
CCAASIP  EQU   CCAFLAG3                                                 09222000
CCAUPDP  EQU   CCAFLAG3                                                 09223000
CCAEOSMP EQU   CCAFLAG2                                                 09224000
CCAEOFNC EQU   CCAFLAG2                                                 09225000
@NM00030 EQU   CCAFLAG2                                                 09226000
CCACHECK EQU   CCAFLAG2                                                 09227000
CCATERM  EQU   CCAFLAG2                                                 09228000
CCASVCLB EQU   CCAFLAG2                                                 09229000
CCANCPTF EQU   CCAFLAG2                                                 09230000
@NM00029 EQU   CCAFLAG1+1                                               09231000
CCAUNL   EQU   CCAFLAG1+1                                               09232000
CCARESET EQU   CCAFLAG1+1                                               09233000
CCALOG   EQU   CCAFLAG1+1                                               09234000
CCACNV   EQU   CCAFLAG1+1                                               09235000
CCALIST  EQU   CCAFLAG1                                                 09236000
CCAUPDU  EQU   CCAFLAG1                                                 09237000
CCAUPDJ  EQU   CCAFLAG1                                                 09238000
CCARES   EQU   CCAFLAG1                                                 09239000
CCAREJ   EQU   CCAFLAG1                                                 09240000
CCAACCPT EQU   CCAFLAG1                                                 09241000
CCAAPPLY EQU   CCAFLAG1                                                 09242000
CCAREC   EQU   CCAFLAG1                                                 09243000
CCAFUNCT EQU   CCAFFUNC                                                 09244000
@NM00028 EQU   @NM00023+18                                              09245000
@NM00027 EQU   @NM00023+16                                              09246000
CCATBLPA EQU   @NM00023+12                                              09247000
@NM00026 EQU   @NM00023+8                                               09248000
@NM00025 EQU   @NM00023+4                                               09249000
@NM00024 EQU   @NM00023                                                 09250000
CCAIFGTP EQU   CCAFGTP+16                                               09251000
CCAGTP3  EQU   CCAFGTP+12                                               09252000
CCAGTP2  EQU   CCAFGTP+8                                                09253000
CCAGTP1  EQU   CCAFGTP+4                                                09254000
CCASETAD EQU   CCASEGTP                                                 09255000
CCACLST  EQU   CCAFPGM+12                                               09256000
CCASPDCB EQU   CCAFPGM+8                                                09257000
CCARVAD  EQU   CCAFSTA                                                  09258000
CCAACDID EQU   CCAFSYS+32                                               09259000
CCACDSID EQU   CCAFSYS+24                                               09260000
CCALNLEN EQU   CCAFSYS+22                                               09261000
@NM00022 EQU   CCAFLAGA                                                 09262000
CCAPSYSF EQU   CCAFLAGA                                                 09263000
CCAASYSF EQU   CCAFLAGA                                                 09264000
CCACSYSF EQU   CCAFLAGA                                                 09265000
CCANUCID EQU   CCAFSYS+20                                               09266000
CCAASREL EQU   CCAFSYS+16                                               09267000
CCACSREL EQU   CCASREL                                                  09268000
CCAPEMAX EQU   CCAFSYS+10                                               09269000
CCAPGLEN EQU   CCAFSYS+8                                                09270000
CCAIOPAS EQU   CCAFSYS+4                                                09271000
CCAIOPCS EQU   CCAFSYS                                                  09272000
CCAPESIZ EQU   CCAFIOP+4                                                09273000
@NM00021 EQU   CCAFLAG7+3                                               09274000
CCALOGP  EQU   CCAFLAG7+2                                               09275000
CCAOUTP  EQU   CCAFLAG7+2                                               09276000
CCASLBP  EQU   CCAFLAG7+2                                               09277000
CCARPTP  EQU   CCAFLAG7+2                                               09278000
CCALISTP EQU   CCAFLAG7+2                                               09279000
CCAJCLP  EQU   CCAFLAG7+2                                               09280000
CCAPTFP  EQU   CCAFLAG7+2                                               09281000
CCATLBP  EQU   CCAFLAG7+2                                               09282000
CCAUT3P  EQU   CCAFLAG7+1                                               09283000
CCAUT2P  EQU   CCAFLAG7+1                                               09284000
CCAUT1P  EQU   CCAFLAG7+1                                               09285000
CCAWK5P  EQU   CCAFLAG7+1                                               09286000
CCAWK4P  EQU   CCAFLAG7+1                                               09287000
CCAWK3P  EQU   CCAFLAG7+1                                               09288000
CCAWK2P  EQU   CCAFLAG7+1                                               09289000
CCAWK1P  EQU   CCAFLAG7+1                                               09290000
CCAACRQP EQU   CCAFLAG7                                                 09291000
CCACRQP  EQU   CCAFLAG7                                                 09292000
CCASTSP  EQU   CCAFLAG7                                                 09293000
CCAMTSP  EQU   CCAFLAG7                                                 09294000
CCAPTSP  EQU   CCAFLAG7                                                 09295000
CCASCDSP EQU   CCAFLAG7                                                 09296000
CCAACDSP EQU   CCAFLAG7                                                 09297000
CCACDSP  EQU   CCAFLAG7                                                 09298000
@NM00020 EQU   CCAFBUFR+122                                             09299000
@NM00019 EQU   CCAFBUFR+120                                             09300000
@NM00018 EQU   CCAFBUFR+118                                             09301000
CCATBFMX EQU   CCAFBUFR+116                                             09302000
CCA4BFMX EQU   CCAFBUFR+114                                             09303000
CCA3BFMX EQU   CCAFBUFR+112                                             09304000
CCA2BFMX EQU   CCAFBUFR+110                                             09305000
CCA1BFMX EQU   CCAFBUFR+108                                             09306000
CCAXBFMX EQU   CCAFBUFR+106                                             09307000
CCAQBFMX EQU   CCAFBUFR+104                                             09308000
CCASBFMX EQU   CCAFBUFR+102                                             09309000
CCAMBFMX EQU   CCAFBUFR+100                                             09310000
CCAPBFMX EQU   CCAFBUFR+98                                              09311000
CCAVBFMX EQU   CCAFBUFR+96                                              09312000
CCAABFMX EQU   CCAFBUFR+94                                              09313000
CCACBFMX EQU   CCAFBUFR+92                                              09314000
@NM00017 EQU   CCAFBUFR+88                                              09315000
@NM00016 EQU   CCAFBUFR+84                                              09316000
CCA4BFSZ EQU   CCAFBUFR+80                                              09317000
CCATBFSZ EQU   CCAFBUFR+76                                              09318000
CCAWBFSZ EQU   CCAFBUFR+72                                              09319000
CCAQBFSZ EQU   CCAFBUFR+68                                              09320000
CCAPBFSZ EQU   CCAFBUFR+64                                              09321000
CCAVBFSZ EQU   CCAFBUFR+60                                              09322000
CCACBFSZ EQU   CCAFBUFR+56                                              09323000
@NM00015 EQU   CCAFBUFR+52                                              09324000
CCA4BFOA EQU   CCAFBUFR+48                                              09325000
CCA4BFIA EQU   CCAFBUFR+44                                              09326000
CCATBFIA EQU   CCAFBUFR+40                                              09327000
CCAWBFOA EQU   CCAFBUFR+36                                              09328000
CCAWBFIA EQU   CCAFBUFR+32                                              09329000
CCAQBFOA EQU   CCAFBUFR+28                                              09330000
CCAQBFIA EQU   CCAFBUFR+24                                              09331000
CCAPBFOA EQU   CCAFBUFR+20                                              09332000
CCAPBFIA EQU   CCAFBUFR+16                                              09333000
CCAVBFOA EQU   CCAFBUFR+12                                              09334000
CCAVBFIA EQU   CCAFBUFR+8                                               09335000
CCACBFOA EQU   CCAFBUFR+4                                               09336000
CCACBFIA EQU   CCAFBUFR                                                 09337000
CCAID    EQU   HMASMCCA                                                 09338000
@NM00014 EQU   TBLFLG5                                                  09339000
TBLICTOK EQU   TBLFLG5                                                  09340000
@NM00013 EQU   TBLFLG4                                                  09341000
TBLBPFM  EQU   TBLFLG4                                                  09342000
@NM00012 EQU   TBLFLG4                                                  09343000
TBLBPIRQ EQU   TBLFLG4                                                  09344000
TBLBPREQ EQU   TBLFLG4                                                  09345000
TBLBPPRE EQU   TBLFLG4                                                  09346000
@NM00011 EQU   TBLFLG3+1                                                09347000
TBLSTS   EQU   TBLFLG3                                                  09348000
TBLMTS   EQU   TBLFLG3                                                  09349000
TBLPTS   EQU   TBLFLG3                                                  09350000
TBLACRQ  EQU   TBLFLG3                                                  09351000
TBLCRQ   EQU   TBLFLG3                                                  09352000
TBLSCDS  EQU   TBLFLG3                                                  09353000
TBLACDS  EQU   TBLFLG3                                                  09354000
TBLCDS   EQU   TBLFLG3                                                  09355000
TBLMASS  EQU   TBLFLG2                                                  09356000
@NM00010 EQU   TBLFLG2                                                  09357000
TBLFMID  EQU   TBLFLG2                                                  09358000
TBLGROUP EQU   TBLFLG2                                                  09359000
TBLEXC   EQU   TBLFLG2                                                  09360000
TBLSEL   EQU   TBLFLG2                                                  09361000
@NM00009 EQU   TBLFLG1+1                                                09362000
TBLDISW  EQU   TBLFLG1+1                                                09363000
TBLDISR  EQU   TBLFLG1+1                                                09364000
TBLDISN  EQU   TBLFLG1+1                                                09365000
TBLNOJCL EQU   TBLFLG1                                                  09366000
TBLFLUSH EQU   TBLFLG1                                                  09367000
TBLUSER  EQU   TBLFLG1                                                  09368000
TBLAPAR  EQU   TBLFLG1                                                  09369000
TBLCOMP  EQU   TBLFLG1                                                  09370000
TBLASSEM EQU   TBLFLG1                                                  09371000
TBLCHECK EQU   TBLFLG1                                                  09372000
TBLNOAPP EQU   TBLFLG1                                                  09373000
@NM00008 EQU   TBLXOPTS+5                                               09374000
TBLNUCID EQU   TBLXOPTS+4                                               09375000
TBLJCLGT EQU   TBLXOPTS                                                 09376000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09377000
@RC00321 EQU   @RC00317                                                 09378000
@RC00723 EQU   @RC00721                                                 09379000
@RF00776 EQU   @RC00743                                                 09380000
@RC00783 EQU   @RC00743                                                 09381000
@RC00812 EQU   @RC00743                                                 09382000
@RF00879 EQU   @RC00877                                                 09383000
@RC00888 EQU   @RC00886                                                 09384000
@RF00895 EQU   @RC00886                                                 09385000
@RC00925 EQU   @RC00866                                                 09386000
@RF00930 EQU   @RC00866                                                 09387000
@RF00949 EQU   @RC00939                                                 09388000
@RF01093 EQU   @RC01085                                                 09389000
@RF01119 EQU   @RC01111                                                 09390000
@RF01160 EQU   @RC01158                                                 09391000
@RF01168 EQU   @RC01166                                                 09392000
@RC01227 EQU   @RC01225                                                 09393000
@RF01272 EQU   @RC01261                                                 09394000
@RC01357 EQU   @RC01354                                                 09395000
@RC01456 EQU   @RC01451                                                 09396000
@RF01523 EQU   @RC01519                                                 09397000
@RC01554 EQU   @RC01551                                                 09398000
@RC01641 EQU   @RC01639                                                 09399000
@RC01695 EQU   @RC01692                                                 09400000
@RC01700 EQU   @RC01692                                                 09401000
@RF01809 EQU   @RC01806                                                 09402000
@RC01862 EQU   @RC01859                                                 09403000
@RC01893 EQU   @RC01891                                                 09404000
@RF00324 EQU   @RC00321                                                 09405000
@RC00785 EQU   @RC00783                                                 09406000
@RC00790 EQU   @RC00783                                                 09407000
@RC01359 EQU   @RC01357                                                 09408000
@RC01459 EQU   @RC01456                                                 09409000
@RC01475 EQU   @RC01456                                                 09410000
@RC01496 EQU   @RC01456                                                 09411000
@RC01557 EQU   @RC01554                                                 09412000
@RC01361 EQU   @RC01359                                                 09413000
@RC01364 EQU   @RC01361                                                 09414000
@RF01371 EQU   @RC01361                                                 09415000
@ENDDATA EQU   *                                                        09416000
         END   HMASMTRM,(C'PLS2215',0802,78334)                         09417000
