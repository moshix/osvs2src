         TITLE 'HMASMUC1 - SMP CDS/ACDS UCLIN PROCESSOR'                00001000
HMASMUC1 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMUC1  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @10,4095(,@12)                                      0001 00011000
         LA    @08,4095(,@10)                                      0001 00012000
         LA    @07,4095(,@08)                                      0001 00013000
         USING @PSTART,@12                                         0001 00014000
         USING @PSTART+4095,@10                                    0001 00015000
         USING @PSTART+8190,@08                                    0001 00016000
         USING @PSTART+12285,@07                                   0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LA    @14,@SA00001                                        0001 00019000
         ST    @14,8(,@13)                                         0001 00020000
         LR    @13,@14                                             0001 00021000
         MVC   @PC00001(8),0(@01)                                  0001 00022000
*                                                                  0205 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* HMASMUC1 - SMP UPDATE CONTROL LANGUAGE HANDLER.               */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0205 00029000
*   IOPPTR=CCAIOPTR;                /* SET ADDRESSABILITY FOR I/O  0205 00030000
*                                      RTNE                  @Z63SP00*/ 00031000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0205 00032000
*   SAVBUFAD=IOPBUFAD;              /* SAVE BUFFER ADDR              */ 00033000
         MVC   SAVBUFAD(4),IOPBUFAD(IOPPTR)                        0206 00034000
*   SCPPTR=CRPSCPAD;                /* PICK UP SCP ADDR              */ 00035000
         L     @06,@PC00001+4                                      0207 00036000
         MVC   SCPPTR(4),CRPSCPAD(@06)                             0207 00037000
*   UCLRTNCD=ZERO;                  /* INIT RETURN CODE              */ 00038000
         MVI   UCLRTNCD,X'00'                                      0208 00039000
*   UCLSWTBL=''B;                   /* CLEAR CNTL SW                 */ 00040000
*                                                                  0209 00041000
         XC    UCLSWTBL(5),UCLSWTBL                                0209 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* SET MGP FOR ALL MSG TO GO TO PRINTER AND LOG                  */ 00045000
*   /*                                                               */ 00046000
*   /*****************************************************************/ 00047000
*                                                                  0210 00048000
*   HMASMMGP=HMASMMGP&&HMASMMGP;    /* CLEAR MGP FIRST       @Z40SP00*/ 00049000
         XC    HMASMMGP(32),HMASMMGP                               0210 00050000
*   MGPPRINT=ON;                    /* MSG TO PRINTER        @Z40SP00*/ 00051000
*   MGPHLDS=ON;                     /* MSG TO LOG            @Z40SP00*/ 00052000
*                                                                  0212 00053000
         OI    MGPPRINT,B'10010000'                                0212 00054000
*   /*****************************************************************/ 00055000
*   /*                                                               */ 00056000
*   /* INIT HMASMVLU PARMATER                                        */ 00057000
*   /*                                                               */ 00058000
*   /*****************************************************************/ 00059000
*                                                                  0213 00060000
*   HMASMVLP=''B;                   /*                               */ 00061000
         XC    HMASMVLP(52),HMASMVLP                               0213 00062000
*   VLPFMSG=ON;                     /* ISSUE ERROR MESSAGES          */ 00063000
*                                                                  0214 00064000
         OI    VLPFMSG,B'10000000'                                 0214 00065000
*   /*****************************************************************/ 00066000
*   /*                                                               */ 00067000
*   /* SET VALUE FOR IOPDSID BASED ON INPUT PARM                     */ 00068000
*   /*                                                               */ 00069000
*   /*****************************************************************/ 00070000
*                                                                  0215 00071000
*   IF UCLCDS=ON                    /*                               */ 00072000
*     THEN                          /*                               */ 00073000
         L     @06,@PC00001                                        0215 00074000
         TM    UCLCDS(@06),B'10000000'                             0215 00075000
         BNO   @RF00215                                            0215 00076000
*     UC1DSID=IOPCDS;               /*                               */ 00077000
         MVI   UC1DSID,X'02'                                       0216 00078000
*   ELSE                            /*                               */ 00079000
*     UC1DSID=IOPACDS;              /*                               */ 00080000
         B     @RC00215                                            0217 00081000
@RF00215 MVI   UC1DSID,X'0C'                                       0217 00082000
*                                                                  0218 00083000
*   /*****************************************************************/ 00084000
*   /*                                                               */ 00085000
*   /* PROGRAM INITIALIZATION - CLEAR CONTROL SWITCHES AND SET DATA  */ 00086000
*   /* AREAS TO BLANK CHARACTERS                                     */ 00087000
*   /*                                                               */ 00088000
*   /*****************************************************************/ 00089000
*                                                                  0218 00090000
*   DO WHILE(                       /* CONTINUE LOOP WHILE           */ 00091000
*         UCLRTNCD<STOPSMP          /* NO CRITICAL ERRS              */ 00092000
*         &UCLTERM=OFF              /* NO TERMINAL ERRS              */ 00093000
*         &CRPEOFEN=OFF             /* AND NOT END OF FILE           */ 00094000
*         );                        /*                               */ 00095000
@RC00215 B     @DE00218                                            0218 00096000
@DL00218 DS    0H                                                  0219 00097000
*     IF UCLRTNCD=STOPFUNC          /* STOP UCLIN PROCESSING @Z40SP00*/ 00098000
*         |UCLFLUSH=ON              /* OR IN FLUSH MODE              */ 00099000
*       THEN                        /* YES                   @Z40SP00*/ 00100000
         CLI   UCLRTNCD,12                                         0219 00101000
         BE    @RT00219                                            0219 00102000
         L     @06,@PC00001                                        0219 00103000
         TM    UCLFLUSH(@06),B'00000010'                           0219 00104000
         BNO   @RF00219                                            0219 00105000
@RT00219 DS    0H                                                  0220 00106000
*       DO;                         /*                               */ 00107000
*         SCPNORT=ON;               /* DONT CALL ROUTS               */ 00108000
         L     @06,SCPPTR                                          0221 00109000
         OI    SCPNORT(@06),B'00000100'                            0221 00110000
*         UCLFLUSH=ON;              /* SET FLUSH BIT         @Z40SP00*/ 00111000
         L     @06,@PC00001                                        0222 00112000
         OI    UCLFLUSH(@06),B'00000010'                           0222 00113000
*       END;                        /*                               */ 00114000
*     ELSE                          /*                               */ 00115000
*       SCPNORT=OFF;                /* CALL ROUTS                    */ 00116000
         B     @RC00219                                            0224 00117000
@RF00219 L     @06,SCPPTR                                          0224 00118000
         NI    SCPNORT(@06),B'11111011'                            0224 00119000
*     UCLSWTBL=''B;                 /* CLEAR THE CONTROL SWITCHES    */ 00120000
@RC00219 XC    UCLSWTBL(5),UCLSWTBL                                0225 00121000
*     DO LOOPINDX=1 TO CCAPESIZ;    /* CLEAR IOP TO ZERO     @Z40SP00*/ 00122000
         LA    @06,1                                               0226 00123000
         B     @DE00226                                            0226 00124000
@DL00226 DS    0H                                                  0227 00125000
*       IOPUDATA(LOOPINDX)=ZERO;    /* RESET THE IOP         @Z40SP00*/ 00126000
         SLR   @15,@15                                             0227 00127000
         STC   @15,IOPUDATA-1(@06,IOPPTR)                          0227 00128000
*     END;                          /* END CLEAR IOP GROUP   @Z40SP00*/ 00129000
         AH    @06,@CH00043                                        0228 00130000
@DE00226 ST    @06,LOOPINDX                                        0228 00131000
         C     @06,CCAPESIZ(,CCAPTR)                               0228 00132000
         BNH   @DL00226                                            0228 00133000
*     IOPNAME=BLANK8;               /*                               */ 00134000
*                                                                  0229 00135000
         MVC   IOPNAME(8,IOPPTR),BLANK8                            0229 00136000
*     /***************************************************************/ 00137000
*     /*                                                             */ 00138000
*     /* READ A CONTROL STATEMENT FROM THE INPUT DATA SET    @Z63SP00*/ 00139000
*     /*                                                             */ 00140000
*     /***************************************************************/ 00141000
*                                                                  0230 00142000
*     CALL HMASMCRD(HMASMCRP);      /* READ/PRINT CC                 */ 00143000
         L     @06,@PC00001+4                                      0230 00144000
         ST    @06,@AL00001                                        0230 00145000
         L     @15,@CV01407                                        0230 00146000
         LA    @01,@AL00001                                        0230 00147000
         BALR  @14,@15                                             0230 00148000
*     IF CRPRETRN>CRPEOF            /* IF RC GREATER THAN            */ 00149000
*       THEN                        /* EOF THEN                      */ 00150000
         L     @06,@PC00001+4                                      0231 00151000
         CLI   CRPRETRN(@06),4                                     0231 00152000
         BNH   @RF00231                                            0231 00153000
*       UCLRTNCD=MAX(UCLRTNCD,CRPRETRN);/* SAVE RC                   */ 00154000
*                                                                  0232 00155000
         SLR   @15,@15                                             0232 00156000
         IC    @15,UCLRTNCD                                        0232 00157000
         SLR   @14,@14                                             0232 00158000
         IC    @14,CRPRETRN(,@06)                                  0232 00159000
         CR    @15,@14                                             0232 00160000
         BNL   *+6                                                      00161000
         LR    @15,@14                                             0232 00162000
         STC   @15,UCLRTNCD                                        0232 00163000
*     /***************************************************************/ 00164000
*     /*                                                             */ 00165000
*     /* IF A RECORD WAS SUCCESSFULLY READ THEN SCAN IT      @Z63SP00*/ 00166000
*     /*                                                             */ 00167000
*     /***************************************************************/ 00168000
*                                                                  0233 00169000
*     IF CRPRETRN=CRPGOOD           /* IF RECORD READ OK             */ 00170000
*       THEN                        /*                               */ 00171000
@RF00231 L     @06,@PC00001+4                                      0233 00172000
         CLI   CRPRETRN(@06),0                                     0233 00173000
         BNE   @RF00233                                            0233 00174000
*       DO;                         /*                               */ 00175000
*         SCPSRCH=ADSCNTBL;         /* PLACE THE START OF THE SCAN 0235 00176000
*                                      TABLES INTO THE SCAN PARM LIST*/ 00177000
         L     @06,SCPPTR                                          0235 00178000
         MVC   SCPSRCH(4,@06),ADSCNTBL                             0235 00179000
*         CALL HMASMSCN(HMASMSCP);  /* CALL THE SCAN ROUTINE TO SCAN    00180000
*                                      THE CARD WE JUST READ IN      */ 00181000
         ST    @06,@AL00001                                        0236 00182000
         L     @15,@CV01410                                        0236 00183000
         LA    @01,@AL00001                                        0236 00184000
         BALR  @14,@15                                             0236 00185000
*                                                                  0237 00186000
*/********************************************************************/ 00187000
*/*                                                                  */ 00188000
*/*    SCAN RETURN CODES - SYNTAX ERROR & STATUS INDICATORS -@Z63SP00*/ 00189000
*/*                                                          @Z63SP00*/ 00190000
*/*    ERRAFTPR -  INDICATES A SYNTAX ERROR WAS DETECTED DURING      */ 00191000
*/*                A SCAN EXIT ROUTINE                       @Z63SP00*/ 00192000
*/*    SCPRET   -  THE RETURN CODE FROM THE SCAN ROUTINE - IF NON-   */ 00193000
*/*                ZERO, THE SCAN ROUTINE HAS DETECTED A SYNTAX      */ 00194000
*/*                ERROR                                     @Z63SP00*/ 00195000
*/*    INVLOP   - INVALID OPERATION REQUESTED                        */ 00196000
*/*                                                                  */ 00197000
*/********************************************************************/ 00198000
*                                                                  0237 00199000
*         IF CRPEOFEN=ON            /* EOF ON INPUT?         @SA72402*/ 00200000
*           THEN                    /* YES                           */ 00201000
         L     @06,@PC00001+4                                      0237 00202000
         TM    CRPEOFEN(@06),B'10000000'                           0237 00203000
         BNO   @RF00237                                            0237 00204000
*           CALL UCL252I;           /* WRITE MSG                     */ 00205000
         BAL   @14,UCL252I                                         0238 00206000
*         ELSE                      /*                               */ 00207000
*           DO;                     /*                               */ 00208000
         B     @RC00237                                            0239 00209000
@RF00237 DS    0H                                                  0240 00210000
*             IF SCPRETRN>STOPPTF   /* IF I/O TYPE ERR               */ 00211000
*               THEN                                               0240 00212000
         L     @06,SCPPTR                                          0240 00213000
         CLI   SCPRETRN(@06),8                                     0240 00214000
         BNH   @RF00240                                            0240 00215000
*               UCLRTNCD=MAX(UCLRTNCD,SCPRETRN);/* PASS ALONG RC     */ 00216000
         SLR   @15,@15                                             0241 00217000
         IC    @15,UCLRTNCD                                        0241 00218000
         SLR   @14,@14                                             0241 00219000
         IC    @14,SCPRETRN(,@06)                                  0241 00220000
         CR    @15,@14                                             0241 00221000
         BNL   *+6                                                      00222000
         LR    @15,@14                                             0241 00223000
         STC   @15,UCLRTNCD                                        0241 00224000
*             IF SCPRETRN^=SCPGOOD  /* IF SCAN NOT OK                */ 00225000
*               THEN                /*                               */ 00226000
@RF00240 L     @06,SCPPTR                                          0242 00227000
         CLI   SCPRETRN(@06),0                                     0242 00228000
         BE    @RF00242                                            0242 00229000
*               CALL UCL203I;       /* PUT OUT SYNTAX ERR            */ 00230000
         BAL   @14,UCL203I                                         0243 00231000
*             IF(SCPRETRN^=SCPGOOD  /* IF SYNTAX ERROR               */ 00232000
*                 |DELERR=ON        /* OR INVALID DELETE             */ 00233000
*                 |INVLOP=ON)       /* OR INVALID OPERATION          */ 00234000
*                 &ERRAFTPR=OFF     /* BUT NOT ERR AFTER PERIOD      */ 00235000
*               THEN                /* YES                   @YA07506*/ 00236000
@RF00242 L     @06,SCPPTR                                          0244 00237000
         CLI   SCPRETRN(@06),0                                     0244 00238000
         BNE   @GL00002                                            0244 00239000
         TM    DELERR,B'00000110'                                  0244 00240000
         BZ    @RF00244                                            0244 00241000
@GL00002 TM    ERRAFTPR,B'00010000'                                0244 00242000
         BNZ   @RF00244                                            0244 00243000
*               CALL FLUSH;         /* FLUSH REST OF CARD            */ 00244000
         BAL   @14,FLUSH                                           0245 00245000
*             IF INVLOP=ON          /* IF INVALID OPERATION          */ 00246000
*               THEN                /*                               */ 00247000
@RF00244 TM    INVLOP,B'00000100'                                  0246 00248000
         BNO   @RF00246                                            0246 00249000
*               CALL UCL276I;       /* WRITE MSG                     */ 00250000
         BAL   @14,UCL276I                                         0247 00251000
*             IF DELERR=ON          /*                               */ 00252000
*               THEN                /*                               */ 00253000
@RF00246 TM    DELERR,B'00000010'                                  0248 00254000
         BNO   @RF00248                                            0248 00255000
*               CALL UCL253I;       /*                               */ 00256000
         BAL   @14,UCL253I                                         0249 00257000
*           END;                    /*                               */ 00258000
@RF00248 DS    0H                                                  0251 00259000
*                                                                  0251 00260000
*         /***********************************************************/ 00261000
*         /*                                                         */ 00262000
*         /* IF THE OPERATION WAS NOT A TOTAL DELETE CHECK EACH TYPE */ 00263000
*         /* ENTRY TO INSURE SUFFICIENT INFORMATION HAS EITHER BEEN  */ 00264000
*         /* SPECIFIED OR WAS THERE AND NOT DELETED                  */ 00265000
*         /*                                                         */ 00266000
*         /***********************************************************/ 00267000
*                                                                  0251 00268000
*         IF UCLTERM=OFF            /* IF ENDUCL NOT FOUND           */ 00269000
*             &UCLFLUSH=OFF         /* AND NOT IN FLUSH MODE         */ 00270000
*           THEN                    /*                               */ 00271000
@RC00237 TM    UCLTERM,B'00001000'                                 0251 00272000
         BNZ   @RF00251                                            0251 00273000
         L     @06,@PC00001                                        0251 00274000
         TM    UCLFLUSH(@06),B'00000010'                           0251 00275000
         BNZ   @RF00251                                            0251 00276000
*           DO;                     /*                               */ 00277000
*             IF ERR1SW=OFF         /* IF NO PREV ERR                */ 00278000
*                 &TOTALDEL=OFF     /* AND NOT TOTAL DEL             */ 00279000
*               THEN                /* CHECK FOR SUFFICIENT          */ 00280000
         TM    ERR1SW,B'10000000'                                  0253 00281000
         BNZ   @RF00253                                            0253 00282000
         TM    TOTALDEL,B'00001000'                                0253 00283000
         BNZ   @RF00253                                            0253 00284000
*               CALL CPLTCHK;       /* DATA IN ENTRY                 */ 00285000
         BAL   @14,CPLTCHK                                         0254 00286000
*             IF ERR2SW=ON          /*                               */ 00287000
*               THEN                /*                               */ 00288000
@RF00253 TM    ERR2SW,B'01000000'                                  0255 00289000
         BNO   @RF00255                                            0255 00290000
*               ERR1SW=ON;          /*                               */ 00291000
         OI    ERR1SW,B'10000000'                                  0256 00292000
*             IF ERR1SW=ON          /*                               */ 00293000
*               THEN                /*                               */ 00294000
@RF00255 TM    ERR1SW,B'10000000'                                  0257 00295000
         BNO   @RF00257                                            0257 00296000
*               UCLRTNCD=MAX(UCLRTNCD,STOPPTF);/*                    */ 00297000
*                                                                  0258 00298000
         SLR   @06,@06                                             0258 00299000
         IC    @06,UCLRTNCD                                        0258 00300000
         LA    @15,8                                               0258 00301000
         CR    @06,@15                                             0258 00302000
         BNL   *+6                                                      00303000
         LR    @06,@15                                             0258 00304000
         STC   @06,UCLRTNCD                                        0258 00305000
*             /*******************************************************/ 00306000
*             /*                                                     */ 00307000
*             /* WRITE OUT THE UPDATED ENTRY TO SPECIFIED DATA SET   */ 00308000
*             /*                                                     */ 00309000
*             /*******************************************************/ 00310000
*                                                                  0259 00311000
*             IF ERR1SW=OFF         /* IF NO ERRORS                  */ 00312000
*               THEN                /*                               */ 00313000
@RF00257 TM    ERR1SW,B'10000000'                                  0259 00314000
         BNZ   @RF00259                                            0259 00315000
*               DO;                 /*                               */ 00316000
*                 CALL UCLSTOW;     /* STOW CHANGED ENTRY            */ 00317000
         BAL   @14,UCLSTOW                                         0261 00318000
*                 RFY                                              0262 00319000
*                   RTNCODE RSTD;   /*                               */ 00320000
*                 UCLRTNCD=MAX(UCLRTNCD,RTNCODE);/* SAVE RC          */ 00321000
         SLR   @14,@14                                             0263 00322000
         IC    @14,UCLRTNCD                                        0263 00323000
         CR    @14,RTNCODE                                         0263 00324000
         BNL   *+6                                                      00325000
         LR    @14,RTNCODE                                         0263 00326000
         STC   @14,UCLRTNCD                                        0263 00327000
*                 IF RTNCODE^=ZERO  /* IF STOW ERROR                 */ 00328000
*                   THEN            /*                               */ 00329000
         LTR   RTNCODE,RTNCODE                                     0264 00330000
         BZ    @RF00264                                            0264 00331000
*                   ERR1SW=ON;      /* SET ERROR INDICATOR           */ 00332000
         OI    ERR1SW,B'10000000'                                  0265 00333000
*                 ELSE              /*                               */ 00334000
*                   DO;             /*                               */ 00335000
         B     @RC00264                                            0266 00336000
@RF00264 DS    0H                                                  0267 00337000
*                     IF SYS=ON     /*                               */ 00338000
*                       THEN        /*                               */ 00339000
         TM    SYS,B'00000100'                                     0267 00340000
         BNO   @RF00267                                            0267 00341000
*                       DO;         /*                               */ 00342000
*                         SAVNAME=IOPNAME;/* SAVE NAME               */ 00343000
         MVC   SAVNAME(8),IOPNAME(IOPPTR)                          0269 00344000
*                         CALL HMASMDS1(HMASMIOP,'Y');/*             */ 00345000
         ST    IOPPTR,@AL00001                                     0270 00346000
         LA    @14,@CC01596                                        0270 00347000
         ST    @14,@AL00001+4                                      0270 00348000
         L     @15,@CV01408                                        0270 00349000
         LA    @01,@AL00001                                        0270 00350000
         BALR  @14,@15                                             0270 00351000
*                         UCLRTNCD=MAX(UCLRTNCD,RTNCODE);/*          */ 00352000
         SLR   @14,@14                                             0271 00353000
         IC    @14,UCLRTNCD                                        0271 00354000
         CR    @14,RTNCODE                                         0271 00355000
         BNL   *+6                                                      00356000
         LR    @14,RTNCODE                                         0271 00357000
         STC   @14,UCLRTNCD                                        0271 00358000
*                         IF RTNCODE=ZERO/* IF PROCESS OK            */ 00359000
*                           THEN    /*                               */ 00360000
         LTR   RTNCODE,RTNCODE                                     0272 00361000
         BNZ   @RF00272                                            0272 00362000
*                           DO;     /*                               */ 00363000
*                             IOPPTR=CCAIOPTR;/* RESET PTR IN CASE   */ 00364000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0274 00365000
*                             IOPBUFAD=SAVBUFAD;/* ANOTHER IOP       */ 00366000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0275 00367000
*                           END;    /* WAS GETMAINED                 */ 00368000
*                         ELSE      /* IF GETMAIN FAILED THEN USE    */ 00369000
*                           IOPPTR=CCAIOPCS;/* SYSIOP FOR REST       */ 00370000
         B     @RC00272                                            0277 00371000
@RF00272 L     IOPPTR,CCAIOPCS(,CCAPTR)                            0277 00372000
*                         IOPNAME=SAVNAME;/* RESET NAME              */ 00373000
@RC00272 MVC   IOPNAME(8,IOPPTR),SAVNAME                           0278 00374000
*                       END;        /*                               */ 00375000
*                   END;            /*                               */ 00376000
@RF00267 DS    0H                                                  0281 00377000
*                 RFY                                              0281 00378000
*                   RTNCODE UNRSTD; /*                               */ 00379000
@RC00264 DS    0H                                                  0282 00380000
*               END;                /* END NO ERROR                  */ 00381000
*                                                                  0282 00382000
*             /*******************************************************/ 00383000
*             /*                                                     */ 00384000
*             /* UPDATE COMPLETE - ISSUE MESSAGE TELLING USER THE CDS*/ 00385000
*             /* ENTRY WAS UPDATED SUCCESSFULLY THEN CONTINUE        */ 00386000
*             /*                                                     */ 00387000
*             /*******************************************************/ 00388000
*                                                                  0283 00389000
*             IF ERR1SW=OFF         /* IF ENTRY UPDATED              */ 00390000
*               THEN                /* ISSUE SUCCESS                 */ 00391000
@RF00259 TM    ERR1SW,B'10000000'                                  0283 00392000
         BNZ   @RF00283                                            0283 00393000
*               CALL UCL255I;       /* MSG                           */ 00394000
         BAL   @14,UCL255I                                         0284 00395000
*             ELSE                  /* ELSE ISSUE TERMINATE          */ 00396000
*               CALL UCL256I;       /* MSG                           */ 00397000
         B     @RC00283                                            0285 00398000
@RF00283 BAL   @14,UCL256I                                         0285 00399000
*           END;                    /*                               */ 00400000
@RC00283 DS    0H                                                  0287 00401000
*         PRLFLGS=ZERO;             /*                               */ 00402000
@RF00251 L     @06,IOPBUFAD(,IOPPTR)                               0287 00403000
         MVI   PRLFLGS(@06),X'00'                                  0287 00404000
*         PRLBLANK=ON;              /*                               */ 00405000
         OI    PRLBLANK(@06),B'00100000'                           0288 00406000
*         IOPDSID=IOPPRINT;         /*                               */ 00407000
         MVI   IOPDSID(IOPPTR),X'0B'                               0289 00408000
*         IOPFUNCT=IOPWRITE;        /*                               */ 00409000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0290 00410000
*         CALL HMASMIO(HMASMIOP);   /* WRITE BLANK LINE              */ 00411000
         ST    IOPPTR,@AL00001                                     0291 00412000
         L     @15,@CV01409                                        0291 00413000
         LA    @01,@AL00001                                        0291 00414000
         BALR  @14,@15                                             0291 00415000
*         IF IOPRETRN=IOPGOOD       /*                               */ 00416000
*           THEN                    /*                               */ 00417000
         CLI   IOPRETRN(IOPPTR),0                                  0292 00418000
         BNE   @RF00292                                            0292 00419000
*           CALL HMASMIO(HMASMIOP); /* TWO LINES                     */ 00420000
         ST    IOPPTR,@AL00001                                     0293 00421000
         L     @15,@CV01409                                        0293 00422000
         LA    @01,@AL00001                                        0293 00423000
         BALR  @14,@15                                             0293 00424000
*         UCLRTNCD=MAX(UCLRTNCD,IOPRETRN);/*                         */ 00425000
@RF00292 SLR   @06,@06                                             0294 00426000
         IC    @06,UCLRTNCD                                        0294 00427000
         SLR   @15,@15                                             0294 00428000
         IC    @15,IOPRETRN(,IOPPTR)                               0294 00429000
         CR    @06,@15                                             0294 00430000
         BNL   *+6                                                      00431000
         LR    @06,@15                                             0294 00432000
         STC   @06,UCLRTNCD                                        0294 00433000
*       END;                        /* END RC RCD AND SCANND         */ 00434000
*   END;                            /* END READ/SCAN LOOP            */ 00435000
@RF00233 DS    0H                                                  0296 00436000
@DE00218 CLI   UCLRTNCD,16                                         0296 00437000
         BNL   @DC00218                                            0296 00438000
         TM    UCLTERM,B'00001000'                                 0296 00439000
         BNZ   @DC00218                                            0296 00440000
         L     @06,@PC00001+4                                      0296 00441000
         TM    CRPEOFEN(@06),B'10000000'                           0296 00442000
         BZ    @DL00218                                            0296 00443000
@DC00218 DS    0H                                                  0297 00444000
*                                                                  0297 00445000
*   /*****************************************************************/ 00446000
*   /*                                                               */ 00447000
*   /* IF LOOP ENDED DUE TO I/O ERROR FROM READ ROUTINE THEN ISSUE   */ 00448000
*   /* MESSAGE NOW                                           @Z63SP00*/ 00449000
*   /*                                                               */ 00450000
*   /*****************************************************************/ 00451000
*                                                                  0297 00452000
*   IF CRPRETRN=CRPEOF              /* IF END OF FILE                */ 00453000
*       &UCLTERM=OFF                /* BEFORE ENDUCL                 */ 00454000
*     THEN                          /*                               */ 00455000
         L     @06,@PC00001+4                                      0297 00456000
         CLI   CRPRETRN(@06),4                                     0297 00457000
         BNE   @RF00297                                            0297 00458000
         TM    UCLTERM,B'00001000'                                 0297 00459000
         BNZ   @RF00297                                            0297 00460000
*     CALL UCL258I;                 /*                               */ 00461000
         BAL   @14,UCL258I                                         0298 00462000
*   ELSE                            /*                               */ 00463000
*     IF CRPRETRN>CRPEOF            /* IF GREATER THEN EOF           */ 00464000
*       THEN                        /*                               */ 00465000
         B     @RC00297                                            0299 00466000
@RF00297 L     @06,@PC00001+4                                      0299 00467000
         CLI   CRPRETRN(@06),4                                     0299 00468000
         BNH   @RF00299                                            0299 00469000
*       CALL UCL256I;               /*                               */ 00470000
*                                                                  0300 00471000
         BAL   @14,UCL256I                                         0300 00472000
*   /*****************************************************************/ 00473000
*   /*                                                               */ 00474000
*   /* UCL UPDATE COMPLETED SUCCESSFULLY RETURN TO THE CALLER@Z63SP00*/ 00475000
*   /*                                                               */ 00476000
*   /*****************************************************************/ 00477000
*                                                                  0301 00478000
*   RETURN CODE(UCLRTNCD);          /* RETURN TO CALLER WITH HIGHEST    00479000
*                                      RETURN CODE ENCOUNTERED       */ 00480000
@RF00299 DS    0H                                                  0301 00481000
@RC00297 SLR   @15,@15                                             0301 00482000
         IC    @15,UCLRTNCD                                        0301 00483000
         L     @13,4(,@13)                                         0301 00484000
         L     @14,12(,@13)                                        0301 00485000
         LM    @00,@12,20(@13)                                     0301 00486000
         BR    @14                                                 0301 00487000
         EJECT                                                          00488000
*                                                                  0302 00489000
*   /*****************************************************************/ 00490000
*   /*                                                               */ 00491000
*   /* THESE ROUTINE ARE CALLED WHEN THE FUNCTION KEYWORD IS         */ 00492000
*   /* ENCOUNTERED. THEY SAVE AN INDICATOR AS TO THE TYPE FUNCTION   */ 00493000
*   /* REQUESTED                                             @Z63SP00*/ 00494000
*   /*                                                               */ 00495000
*   /*****************************************************************/ 00496000
*                                                                  0302 00497000
*RXXXFNC:                           /*                               */ 00498000
*   PROCEDURE;                      /*                               */ 00499000
RXXXFNC  STM   @14,@12,12(@13)                                     0302 00500000
*RREP00:                            /* REPLACE VERB SCAN EXIT@Z63SP00*/ 00501000
*   ENTRY;                          /*                               */ 00502000
         B     @EC00303                                            0303 00503000
RREP00   STM   @14,@12,12(@13)                                     0303 00504000
@EC00303 DS    0H                                                  0304 00505000
*   REP=ON;                         /* SET SWITCH IN TABLE   @Z63SP00*/ 00506000
         OI    REP,B'10000000'                                     0304 00507000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 00508000
@EL00002 DS    0H                                                  0305 00509000
@EF00002 DS    0H                                                  0305 00510000
@ER00002 LM    @14,@12,12(@13)                                     0305 00511000
         BR    @14                                                 0305 00512000
*RDEL00:                            /* DELETE VERB SCAN EXIT @Z63SP00*/ 00513000
*   ENTRY;                          /*                               */ 00514000
RDEL00   STM   @14,@12,12(@13)                                     0306 00515000
*   DEL=ON;                         /* INDICATE DELETE       @Z63SP00*/ 00516000
         OI    DEL,B'01000000'                                     0307 00517000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 00518000
         B     @EL00002                                            0308 00519000
*RADD00:                            /* ADD VERB SCAN EXIT    @Z63SP00*/ 00520000
*   ENTRY;                          /*                               */ 00521000
RADD00   STM   @14,@12,12(@13)                                     0309 00522000
*   ADD=ON;                         /* INDICATE ADD IN SWITCH TABLE  */ 00523000
         OI    ADD,B'00100000'                                     0310 00524000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 00525000
         B     @EL00002                                            0311 00526000
*   END RXXXFNC;                    /* END FUNCTION ROUTS            */ 00527000
         EJECT                                                          00528000
*                                                                  0313 00529000
*   /*****************************************************************/ 00530000
*   /*                                                               */ 00531000
*   /* THESE ROUTINES ARE ENTERED WHEN THE ENTRY TYPE KEYWORD IS     */ 00532000
*   /* ENCOUNTERED ON THE UCLIN STATEMENT. THEY SET UP THE IOP SO    */ 00533000
*   /* THAT IF THE ENTRY IS NOT LOCATED THEN THE IOP WILL BE         */ 00534000
*   /* INITIALIZED TO NULL VALUES.                                   */ 00535000
*   /*                                                               */ 00536000
*   /*****************************************************************/ 00537000
*                                                                  0313 00538000
*RXXX00:                            /*                               */ 00539000
*   PROCEDURE;                      /*                               */ 00540000
RXXX00   STM   @14,@12,@SA00003                                    0313 00541000
*RSMD00:                            /* PTF TYPE SCAN EXIT    @Z63SP00*/ 00542000
*   ENTRY;                          /*                               */ 00543000
         B     @EC00314                                            0314 00544000
RSMD00   STM   @14,@12,@SA00003                                    0314 00545000
@EC00314 DS    0H                                                  0315 00546000
*   PTF=ON;                         /* INDICATE THAT IN THE TABLE    */ 00547000
         OI    PTF,B'10000000'                                     0315 00548000
*   IOPTYPE=IOPSMD;                 /* INDICATE SYSMOD ENTRY         */ 00549000
         MVI   IOPTYPE(IOPPTR),X'0B'                               0316 00550000
*   IOPNTLVL=IOPPTFLC;              /* CURRENT LEVEL         @Z67SP00*/ 00551000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0317 00552000
*   IOPDBYNO=BLANK7;                /* NO DEL BY             @Z67SP00*/ 00553000
         MVC   IOPDBYNO(7,IOPPTR),@CC01416                         0318 00554000
*   IOPSBYNO=BLANK7;                /* NO SUP BY             @Z67SP00*/ 00555000
         MVC   IOPSBYNO(7,IOPPTR),@CC01416                         0319 00556000
*   IOPPFMID=BLANK7;                /* NO FMID               @Z67SP00*/ 00557000
         MVC   IOPPFMID(7,IOPPTR),@CC01416                         0320 00558000
*   IOPPTFND(1)=IOPEOLST;           /* SET END OF PTF LIST   @ZD00004*/ 00559000
         MVI   IOPPTFND(IOPPTR),X'FF'                              0321 00560000
*   RETURN;                         /* RETURN TO SCAN                */ 00561000
*                                                                  0322 00562000
@EL00003 DS    0H                                                  0322 00563000
@EF00003 DS    0H                                                  0322 00564000
@ER00003 LM    @14,@12,@SA00003                                    0322 00565000
         BR    @14                                                 0322 00566000
*   /*****************************************************************/ 00567000
*   /*                                                               */ 00568000
*   /* SCAN EXIT FOR MODULE TYPE UCL UPDATE                  @Z63SP00*/ 00569000
*   /*                                                               */ 00570000
*   /*****************************************************************/ 00571000
*                                                                  0323 00572000
*RMOD00:                            /* CSECT TYPE SCAN EXIT  @Z63SP00*/ 00573000
*   ENTRY;                          /*                               */ 00574000
RMOD00   STM   @14,@12,@SA00003                                    0323 00575000
*   CSECT=ON;                       /* INDICATE CSECT IN UCL TABLE   */ 00576000
         OI    CSECT,B'01000000'                                   0324 00577000
*   IOPTYPE=IOPMOD;                 /* SET TYPE ENTRY        @ZD00008*/ 00578000
         MVI   IOPTYPE(IOPPTR),X'05'                               0325 00579000
*   IOPNTLVL=IOPMODLC;              /* CURRENT LEVEL                 */ 00580000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0326 00581000
*   IOPRMID=BLANK7;                 /* NO RMID                       */ 00582000
         MVC   IOPRMID(7,IOPPTR),@CC01416                          0327 00583000
*   IOPFMID=BLANK7;                 /* NO FMID                       */ 00584000
         MVC   IOPFMID(7,IOPPTR),@CC01416                          0328 00585000
*   IOPDLIB=BLANK8;                 /* INIT DLIB                     */ 00586000
         MVC   IOPDLIB(8,IOPPTR),BLANK8                            0329 00587000
*   IOPMODND(1)=IOPEOLST;           /* SET END OF MOD ENTRY  @ZD00004*/ 00588000
         MVI   IOPMODND(IOPPTR),X'FF'                              0330 00589000
*   RETURN;                         /* RETURN TO SCAN                */ 00590000
*                                                                  0331 00591000
         B     @EL00003                                            0331 00592000
*   /*****************************************************************/ 00593000
*   /*                                                               */ 00594000
*   /* SCAN EXIT FOR LOAD MODULE TYPE UCL UPDATE                     */ 00595000
*   /*                                                               */ 00596000
*   /*****************************************************************/ 00597000
*                                                                  0332 00598000
*RLMD00:                            /* LOAD MODULE TYPE SCAN EXIT    */ 00599000
*   ENTRY;                          /*                               */ 00600000
RLMD00   STM   @14,@12,@SA00003                                    0332 00601000
*   LMOD=ON;                        /* INDICATE LDMOM TO UCL TABLE   */ 00602000
         OI    LMOD,B'00100000'                                    0333 00603000
*   IF UCLACDS=ON                   /* ASSEM INVALID FR ACDS         */ 00604000
*     THEN                          /* YES                   @Z40SP00*/ 00605000
         L     @06,@PC00001                                        0334 00606000
         TM    UCLACDS(@06),B'01000000'                            0334 00607000
         BNO   @RF00334                                            0334 00608000
*     DO;                           /*                               */ 00609000
*       INVLOP=ON;                  /* INVALID OPERATION             */ 00610000
         OI    INVLOP,B'00000100'                                  0336 00611000
*       SCPRETRN=SCPNDSCN;          /* SYNTAX ERR                    */ 00612000
         L     @06,SCPPTR                                          0337 00613000
         MVI   SCPRETRN(@06),X'04'                                 0337 00614000
*       RETURN;                     /*                               */ 00615000
         B     @EL00003                                            0338 00616000
*     END;                          /*                               */ 00617000
*   IOPTYPE=IOPLMD;                 /* INDICATE LOAD MOD     @ZD00008*/ 00618000
@RF00334 MVI   IOPTYPE(IOPPTR),X'02'                               0340 00619000
*   IOPNTLVL=IOPLMDLC;              /* CURRENT LEVEL                 */ 00620000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0341 00621000
*   IOPLMDND(1)=IOPEOLST;           /* SET END OF LMOD ENTRY @ZD00004*/ 00622000
         MVI   IOPLMDND(IOPPTR),X'FF'                              0342 00623000
*   RETURN;                         /* RETURN TO SCAN                */ 00624000
*                                                                  0343 00625000
         B     @EL00003                                            0343 00626000
*   /*****************************************************************/ 00627000
*   /*                                                               */ 00628000
*   /* SCAN EXIT FOR MACRO TYPE UCL UPDATE                           */ 00629000
*   /*                                                               */ 00630000
*   /*****************************************************************/ 00631000
*                                                                  0344 00632000
*RMAC00:                            /* MACRO TYPE SCAN EXIT  @Z63SP00*/ 00633000
*   ENTRY;                          /*                               */ 00634000
RMAC00   STM   @14,@12,@SA00003                                    0344 00635000
*   MACRO=ON;                       /* SET MACRO SWITCH IN UCL TABLE */ 00636000
         OI    MACRO,B'00010000'                                   0345 00637000
*   IOPTYPE=IOPMAC;                 /* SET MAC CDS TYPE      @ZD00008*/ 00638000
         MVI   IOPTYPE(IOPPTR),X'03'                               0346 00639000
*   IOPNTLVL=IOPMACLC;              /* CURRENT LEVEL                 */ 00640000
         MVI   IOPNTLVL(IOPPTR),X'03'                              0347 00641000
*   IOPRMID=BLANK7;                 /* NO RMID                       */ 00642000
         MVC   IOPRMID(7,IOPPTR),@CC01416                          0348 00643000
*   IOPFMID=BLANK7;                 /* NO FMID                       */ 00644000
         MVC   IOPFMID(7,IOPPTR),@CC01416                          0349 00645000
*   IOPMCLNG=IOPMCASI;              /* ASSEMBLER MACRO               */ 00646000
         MVI   IOPMCLNG(IOPPTR),X'00'                              0350 00647000
*   IOPMCSYS=BLANK8;                /*                               */ 00648000
         MVC   IOPMCSYS(8,IOPPTR),BLANK8                           0351 00649000
*   IOPMCDLB=BLANK8;                /*                               */ 00650000
         MVC   IOPMCDLB(8,IOPPTR),BLANK8                           0352 00651000
*   IOPMACND(1)=IOPEOLST;           /* END OF MACRO ENTRY    @ZD00004*/ 00652000
         MVI   IOPMACND(IOPPTR),X'FF'                              0353 00653000
*   RETURN;                         /* RETURN TO SCAN                */ 00654000
*                                                                  0354 00655000
         B     @EL00003                                            0354 00656000
*   /*****************************************************************/ 00657000
*   /*                                                               */ 00658000
*   /* SCAN EXIT FOR SOURCE TYPE UCL UPDATE                          */ 00659000
*   /*                                                               */ 00660000
*   /*****************************************************************/ 00661000
*                                                                  0355 00662000
*RSRC00:                            /* SOURCE DSCAN EXIT     @ZA17712*/ 00663000
*   ENTRY;                          /*                               */ 00664000
RSRC00   STM   @14,@12,@SA00003                                    0355 00665000
*   SRC=ON;                         /* SET SOURCE TYPE BIT   @Z40SP00*/ 00666000
         OI    SRC,B'00000010'                                     0356 00667000
*   IOPTYPE=IOPSRC;                 /* IOP AND SET TYPE      @Z40SP00*/ 00668000
         MVI   IOPTYPE(IOPPTR),X'08'                               0357 00669000
*   IOPNTLVL=IOPSRCLC;              /* CURRENT LEVEL                 */ 00670000
         MVI   IOPNTLVL(IOPPTR),X'03'                              0358 00671000
*   IOPRMID=BLANK7;                 /* NO RMID                       */ 00672000
         MVC   IOPRMID(7,IOPPTR),@CC01416                          0359 00673000
*   IOPFMID=BLANK7;                 /* NO FMID                       */ 00674000
         MVC   IOPFMID(7,IOPPTR),@CC01416                          0360 00675000
*   IOPMCLNG=IOPMCASI;              /* ASSEMBLER MACRO               */ 00676000
         MVI   IOPMCLNG(IOPPTR),X'00'                              0361 00677000
*   IOPSRSYS=BLANK8;                /*                               */ 00678000
         MVC   IOPSRSYS(8,IOPPTR),BLANK8                           0362 00679000
*   IOPSRDLB=BLANK8;                /*                               */ 00680000
         MVC   IOPSRDLB(8,IOPPTR),BLANK8                           0363 00681000
*   IOPSRCND(1)=IOPEOLST;           /* END OF SOURCE ENTRY   @ZD00004*/ 00682000
         MVI   IOPSRCND(IOPPTR),X'FF'                              0364 00683000
*   RETURN;                         /* RETURN TO SCAN                */ 00684000
*                                                                  0365 00685000
         B     @EL00003                                            0365 00686000
*   /*****************************************************************/ 00687000
*   /*                                                               */ 00688000
*   /* SCAN EXIT FOR DLIB TYPE UCL UPDATE                            */ 00689000
*   /*                                                               */ 00690000
*   /*****************************************************************/ 00691000
*                                                                  0366 00692000
*RDLB00:                            /* DLIB TYPE SCAN EXIT   @ZA17712*/ 00693000
*   ENTRY;                          /*                               */ 00694000
RDLB00   STM   @14,@12,@SA00003                                    0366 00695000
*   DLIB=ON;                        /* SET DLIB SWITCH IN UCL TABLE  */ 00696000
         OI    DLIB,B'00001000'                                    0367 00697000
*   IF UCLACDS=ON                   /* ASSEM INVALID FR ACDS         */ 00698000
*     THEN                          /* YES                   @Z40SP00*/ 00699000
         L     @06,@PC00001                                        0368 00700000
         TM    UCLACDS(@06),B'01000000'                            0368 00701000
         BNO   @RF00368                                            0368 00702000
*     DO;                           /*                               */ 00703000
*       INVLOP=ON;                  /* INVALID OPERATION             */ 00704000
         OI    INVLOP,B'00000100'                                  0370 00705000
*       SCPRETRN=SCPNDSCN;          /* SYNTAX ERR                    */ 00706000
         L     @06,SCPPTR                                          0371 00707000
         MVI   SCPRETRN(@06),X'04'                                 0371 00708000
*       RETURN;                     /*                               */ 00709000
         B     @EL00003                                            0372 00710000
*     END;                          /*                               */ 00711000
*   IOPTYPE=IOPDLB;                 /* INDICATE DLIB TYPE    @ZD00008*/ 00712000
@RF00368 MVI   IOPTYPE(IOPPTR),X'06'                               0374 00713000
*   IOPNTLVL=IOPDLBLC;              /*                               */ 00714000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0375 00715000
*   IOPDLBND(1)=IOPEOLST;           /* SET END OF DLIB ENTRY @ZD00004*/ 00716000
         MVI   IOPDLBND(IOPPTR),X'FF'                              0376 00717000
*   RETURN;                         /* RETURN TO SCAN                */ 00718000
*                                                                  0377 00719000
         B     @EL00003                                            0377 00720000
*   /*****************************************************************/ 00721000
*   /*                                                               */ 00722000
*   /* SCAN EXIT FOR ASSEM TO CHECK THAT REQUEST WAS DELETE          */ 00723000
*   /*                                                               */ 00724000
*   /*****************************************************************/ 00725000
*                                                                  0378 00726000
*RASM00:                            /*                       @Z40SP00*/ 00727000
*   ENTRY;                          /*                               */ 00728000
RASM00   STM   @14,@12,@SA00003                                    0378 00729000
*   ASSEM=ON;                       /* SET TYPE              @Z40SP00*/ 00730000
         OI    ASSEM,B'00000001'                                   0379 00731000
*   IF UCLACDS=ON                   /* ASSEM INVALID FR ACDS         */ 00732000
*       |DEL=OFF                    /* ALL BUT DEL INVALID   @Z40SP00*/ 00733000
*     THEN                          /* YES                   @Z40SP00*/ 00734000
         L     @06,@PC00001                                        0380 00735000
         TM    UCLACDS(@06),B'01000000'                            0380 00736000
         BO    @RT00380                                            0380 00737000
         TM    DEL,B'01000000'                                     0380 00738000
         BNZ   @RF00380                                            0380 00739000
@RT00380 DS    0H                                                  0381 00740000
*     DO;                           /*                               */ 00741000
*       INVLOP=ON;                  /* INVALID OPERATION             */ 00742000
         OI    INVLOP,B'00000100'                                  0382 00743000
*       SCPRETRN=SCPNDSCN;          /* STOP SCAN                     */ 00744000
         L     @06,SCPPTR                                          0383 00745000
         MVI   SCPRETRN(@06),X'04'                                 0383 00746000
*       RETURN;                     /*                               */ 00747000
         B     @EL00003                                            0384 00748000
*     END;                          /*                               */ 00749000
*   IOPTYPE=IOPASM;                 /* SET TYPE              @Z40SP00*/ 00750000
@RF00380 MVI   IOPTYPE(IOPPTR),X'01'                               0386 00751000
*   IOPNTLVL=IOPASMLC;              /*                               */ 00752000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0387 00753000
*   RETURN;                         /* RETURN TO SCAN                */ 00754000
*                                                                  0388 00755000
         B     @EL00003                                            0388 00756000
*   /*****************************************************************/ 00757000
*   /*                                                               */ 00758000
*   /* SCAN EXIT FOR SYSTEM TYPE UCL UPDATE                          */ 00759000
*   /*                                                               */ 00760000
*   /*****************************************************************/ 00761000
*                                                                  0389 00762000
*RSYS00:                            /* SYSTEM TYPE SCAN EXIT @Z63SP00*/ 00763000
*   ENTRY;                          /*                               */ 00764000
RSYS00   STM   @14,@12,@SA00003                                    0389 00765000
*   SYS=ON;                         /* SET SYS SWITCH IN UCL TABLE   */ 00766000
         OI    SYS,B'00000100'                                     0390 00767000
*   IOPTYPE=IOPSYS;                 /* INDICATE SYSTEM TYPE  @Z63SP00*/ 00768000
         MVI   IOPTYPE(IOPPTR),X'07'                               0391 00769000
*   IOPNTLVL=IOPSYSLC;              /*                               */ 00770000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0392 00771000
*   IOPSCNVL=IOPSCNVC;              /*                               */ 00772000
         MVI   IOPSCNVL(IOPPTR),X'02'                              0393 00773000
*   IOPSREL=BLANK4;                 /*                               */ 00774000
         MVC   IOPSREL(4,IOPPTR),@CC01418                          0394 00775000
*   IOPNUCID=BLANK;                 /*                               */ 00776000
         MVI   IOPNUCID(IOPPTR),C' '                               0395 00777000
*   IOPSYSID=BLANK8;                /*                               */ 00778000
         MVC   IOPSYSID(8,IOPPTR),BLANK8                           0396 00779000
*   IOPSYSND(1)=IOPEOLST;           /*                               */ 00780000
         MVI   IOPSYSND(IOPPTR),X'FF'                              0397 00781000
*   IF SCPNORT=OFF                  /* IF ROUTS TO BE CALLED         */ 00782000
*     THEN                          /*                               */ 00783000
         L     @06,SCPPTR                                          0398 00784000
         TM    SCPNORT(@06),B'00000100'                            0398 00785000
         BZ    @RT00398                                            0398 00786000
*     GO TO RXXXLOC;                /* LOCAT ENTRY                   */ 00787000
*   RETURN;                         /* RETURN TO SCAN IF NO ROUT CALL*/ 00788000
         B     @EL00003                                            0400 00789000
*                                                                  0401 00790000
*   /*****************************************************************/ 00791000
*   /*                                                               */ 00792000
*   /* PERFORM A LOCATE ON THE CDS ENTRY NOW THAT WE KNOW THE FULL   */ 00793000
*   /* NAME. IF THE OPERATION IS ADD, THE LOCATE MUST FAIL OR THERE  */ 00794000
*   /* IS AN ERROR. FOR ALL OTHER OPERATIONS THE LOCATE MUST FIND THE*/ 00795000
*   /* ENTRY OR THERE IS AN ERROR. THE LOCATE OPERATION ALSO READS IN*/ 00796000
*   /* THE EXTENDED DIRECTORY WHICH WILL BE USED FOR THE UPDATE      */ 00797000
*   /*                                                               */ 00798000
*   /*****************************************************************/ 00799000
*                                                                  0401 00800000
*RXXXNAM:                                                          0401 00801000
*   ENTRY;                          /*                               */ 00802000
RXXXNAM  STM   @14,@12,@SA00003                                    0401 00803000
*   IOPNAME=SCPSTRNG(1:SCPPMLN);    /*                               */ 00804000
         MVI   IOPNAME+1(IOPPTR),C' '                              0402 00805000
         MVC   IOPNAME+2(6,IOPPTR),IOPNAME+1(IOPPTR)               0402 00806000
         L     @06,SCPPTR                                          0402 00807000
         LH    @15,SCPPMLN(,@06)                                   0402 00808000
         BCTR  @15,0                                               0402 00809000
         L     @06,SCPCHAR(,@06)                                   0402 00810000
         EX    @15,@SM02279                                        0402 00811000
*RXXXLOC:                                                          0403 00812000
*   IOPDSID=UC1DSID;                /* SET DSID                      */ 00813000
RXXXLOC  MVC   IOPDSID(1,IOPPTR),UC1DSID                           0403 00814000
*   IOPFUNCT=IOPLOC;                /* PREPARE FOR LOCATE OPERATION  */ 00815000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0404 00816000
*   CALL HMASMIO(HMASMIOP);         /* PERFORM THE LOCATE    @Z63SP00*/ 00817000
*                                                                  0405 00818000
         ST    IOPPTR,@AL00001                                     0405 00819000
         L     @15,@CV01409                                        0405 00820000
         LA    @01,@AL00001                                        0405 00821000
         BALR  @14,@15                                             0405 00822000
*   /*****************************************************************/ 00823000
*   /*                                                               */ 00824000
*   /* THE LOCATE WAS COMPLETED WITHOUT AN I/O ERROR - NOW CHECK FOR */ 00825000
*   /* THE CORRECT COMBINATION OF OPERATION (ADD/REP/DEL) AND LOCATE */ 00826000
*   /* RETURN CODE (ENTRY PRESENT OR NOT PRESENT)            @Z63SP00*/ 00827000
*   /*                                                               */ 00828000
*   /*****************************************************************/ 00829000
*                                                                  0406 00830000
*   IF(ADD=ON|REP=ON)               /* ADD/REP NEW ENTRY             */ 00831000
*       &IOPRETRN=IOPNTFND          /* AND NTRY NOT FOUND            */ 00832000
*     THEN                                                         0406 00833000
         TM    ADD,B'10100000'                                     0406 00834000
         BZ    @RF00406                                            0406 00835000
         CLI   IOPRETRN(IOPPTR),4                                  0406 00836000
         BNE   @RF00406                                            0406 00837000
*     TOTAL=ON;                     /* YES INDICATE THIS IN TABLE    */ 00838000
         OI    TOTAL,B'00010000'                                   0407 00839000
*                                                                  0408 00840000
*   /*****************************************************************/ 00841000
*   /*                                                               */ 00842000
*   /* CHECK AT THIS POINT FOR TOTAL ADD OF LMOD ENTRIES..   @Z63SP00*/ 00843000
*   /*                                                               */ 00844000
*   /*****************************************************************/ 00845000
*                                                                  0408 00846000
*   IF LMOD=ON                      /* CANNOT ADD LMOD CDS ENTRIES   */ 00847000
*       &IOPRETRN<=IOPNTFND         /* NO SERIOS ERR ON LOCATE       */ 00848000
*     THEN                          /*                               */ 00849000
@RF00406 TM    LMOD,B'00100000'                                    0408 00850000
         BNO   @RF00408                                            0408 00851000
         CLI   IOPRETRN(IOPPTR),4                                  0408 00852000
         BH    @RF00408                                            0408 00853000
*     IF TOTAL=ON                   /*                               */ 00854000
*       THEN                        /*                               */ 00855000
         TM    TOTAL,B'00010000'                                   0409 00856000
         BNO   @RF00409                                            0409 00857000
*       DO;                                                        0410 00858000
*         INVLOP=ON;                /* SET SW                        */ 00859000
         OI    INVLOP,B'00000100'                                  0411 00860000
*         SCPNORT=ON;               /* DONT CALL ROUTS               */ 00861000
         L     @06,SCPPTR                                          0412 00862000
         OI    SCPNORT(@06),B'00000100'                            0412 00863000
*       END;                                                       0413 00864000
*     ELSE                          /* IF LMOD FOUND                 */ 00865000
*       ;                           /*                               */ 00866000
@RF00409 DS    0H                                                  0415 00867000
*   ELSE                            /*                               */ 00868000
*     IF DEL=ON                     /* IF DEL                        */ 00869000
*         &IOPRETRN=IOPNTFND        /* AND NOT FOUND         @YA07506*/ 00870000
*       THEN                        /* THE CHECK IS MADE FOR THE   0415 00871000
*                                      ERROR CONDITION       @Z63SP00*/ 00872000
         B     @RC00408                                            0415 00873000
@RF00408 TM    DEL,B'01000000'                                     0415 00874000
         BNO   @RF00415                                            0415 00875000
         CLI   IOPRETRN(IOPPTR),4                                  0415 00876000
         BNE   @RF00415                                            0415 00877000
*       DO;                         /* WRONG COMBINATION WAS FOUND   */ 00878000
*         DELERR=ON;                /* SET SW                        */ 00879000
         OI    DELERR,B'00000010'                                  0417 00880000
*         SCPNORT=ON;               /* DONT CALL ROUTS               */ 00881000
         L     @06,SCPPTR                                          0418 00882000
         OI    SCPNORT(@06),B'00000100'                            0418 00883000
*       END;                                                       0419 00884000
*     ELSE                          /*                               */ 00885000
*       IF REP=ON                   /*                               */ 00886000
*           &IOPRETRN=IOPNTFND      /*                               */ 00887000
*         THEN                      /*                               */ 00888000
         B     @RC00415                                            0420 00889000
@RF00415 TM    REP,B'10000000'                                     0420 00890000
         BNO   @RF00420                                            0420 00891000
         CLI   IOPRETRN(IOPPTR),4                                  0420 00892000
         BNE   @RF00420                                            0420 00893000
*         CALL UCL277I;             /*                               */ 00894000
         BAL   @14,UCL277I                                         0421 00895000
*       ELSE                        /*                               */ 00896000
*         IF IOPRETRN>IOPNTFND      /* IF SERIOU ERROR IN LOX        */ 00897000
*           THEN                    /* YES - ERR             @YA05690*/ 00898000
         B     @RC00420                                            0422 00899000
@RF00420 CLI   IOPRETRN(IOPPTR),4                                  0422 00900000
         BNH   @RF00422                                            0422 00901000
*           DO;                     /*                       @YA07506*/ 00902000
*             SCPRET=MAX(SCPRET,IOPRETRN);/*                         */ 00903000
         L     @06,SCPPTR                                          0424 00904000
         SLR   @15,@15                                             0424 00905000
         IC    @15,SCPRET(,@06)                                    0424 00906000
         SLR   @14,@14                                             0424 00907000
         IC    @14,IOPRETRN(,IOPPTR)                               0424 00908000
         CR    @15,@14                                             0424 00909000
         BNL   *+6                                                      00910000
         LR    @15,@14                                             0424 00911000
         STC   @15,SCPRET(,@06)                                    0424 00912000
*             IF IOPRETRN=IOPIOERR  /* CHECK FOR AN I/O ERROR ON THE    00913000
*                                      LOCATE OPERATION      @Z40SP00*/ 00914000
*               THEN                /* YES - THERE WAS AN ERROR      */ 00915000
         CLI   IOPRETRN(IOPPTR),16                                 0425 00916000
         BNE   @RF00425                                            0425 00917000
*               CALL UCL256I;       /* ISSUE THE MESSAGE             */ 00918000
         BAL   @14,UCL256I                                         0426 00919000
*           END;                    /*                               */ 00920000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 00921000
         B     @EL00003                                            0428 00922000
*                                                                  0429 00923000
*   /*****************************************************************/ 00924000
*   /*                                                               */ 00925000
*   /* THIS ROUTINE IS ENTERED WHEN A PERIOD IS FOUND IMMEDIATELY    */ 00926000
*   /* AFTER THE DEL AND NAME OF THE UCL STATEMENT. SET A SWITCH TO  */ 00927000
*   /* INDICATE DELETE ONLY OPERATION AFTER RETURN FROM SCAN         */ 00928000
*   /*                                                               */ 00929000
*   /*****************************************************************/ 00930000
*                                                                  0429 00931000
*RXXXTD:                                                           0429 00932000
*   ENTRY;                          /*                               */ 00933000
RXXXTD   STM   @14,@12,@SA00003                                    0429 00934000
*   IF DEL=ON&UCLFLUSH=OFF          /* DEL VERB AND NOT TERMINATE? 0430 00935000
*                                                            @YA07506*/ 00936000
*     THEN                                                         0430 00937000
         TM    DEL,B'01000000'                                     0430 00938000
         BNO   @RF00430                                            0430 00939000
         L     @06,@PC00001                                        0430 00940000
         TM    UCLFLUSH(@06),B'00000010'                           0430 00941000
         BNZ   @RF00430                                            0430 00942000
*     TOTALDEL=ON;                  /* INDICATE TOTAL DELETE @Z40SP00*/ 00943000
         OI    TOTALDEL,B'00001000'                                0431 00944000
*   RETURN;                         /* RETURN TO HMSMSCN             */ 00945000
         B     @EL00003                                            0432 00946000
*   END RXXX00;                     /*                               */ 00947000
         B     @EL00003                                            0433 00948000
         EJECT                                                          00949000
*                                                                  0434 00950000
*   /*****************************************************************/ 00951000
*   /*                                                               */ 00952000
*   /* SCAN EXITS FOR SYSMOD ENTRY KEYWORDS AND OPTIONS      @Z63SP00*/ 00953000
*   /*                                                               */ 00954000
*   /*****************************************************************/ 00955000
*                                                                  0434 00956000
*RSMDXXX:                           /*                               */ 00957000
*   PROCEDURE;                      /*                               */ 00958000
*                                                                  0434 00959000
RSMDXXX  STM   @14,@12,@SA00004                                    0434 00960000
*   /*****************************************************************/ 00961000
*   /*                                                               */ 00962000
*   /* PTF APPLIED STATUS SCAN EXIT                          @Z63SP00*/ 00963000
*   /*                                                               */ 00964000
*   /*****************************************************************/ 00965000
*                                                                  0435 00966000
*RSMDAPP:                                                          0435 00967000
*   ENTRY;                          /*                               */ 00968000
         B     @EC00435                                            0435 00969000
RSMDAPP  STM   @14,@12,@SA00004                                    0435 00970000
@EC00435 DS    0H                                                  0436 00971000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 00972000
         MVI   MSGPARTS,C' '                                       0436 00973000
         MVC   MSGPARTS+1(131),MSGPARTS                            0436 00974000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 00975000
         L     @06,SCPPTR                                          0437 00976000
         LH    @15,SCPPMLN(,@06)                                   0437 00977000
         BCTR  @15,0                                               0437 00978000
         L     @06,SCPCHAR(,@06)                                   0437 00979000
         EX    @15,@SM02281                                        0437 00980000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 00981000
*     THEN                          /* THEN CHECK PRENSENCE          */ 00982000
         TM    DEL,B'01000000'                                     0438 00983000
         BNO   @RF00438                                            0438 00984000
*     DO;                           /*                               */ 00985000
*       IF IOPAPP=ON                /* IF OPTION PRESENT             */ 00986000
*         THEN                      /*                               */ 00987000
         TM    IOPAPP(IOPPTR),B'10000000'                          0440 00988000
         BNO   @RF00440                                            0440 00989000
*         IOPAPP=OFF;               /* DELETE IT                     */ 00990000
         NI    IOPAPP(IOPPTR),B'01111111'                          0441 00991000
*       ELSE                        /*                               */ 00992000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 00993000
         B     @RC00440                                            0442 00994000
@RF00440 BAL   @14,UCL357I                                         0442 00995000
*     END;                          /* END DELETE REQUEST            */ 00996000
*   ELSE                            /* IF NOT DELETE                 */ 00997000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 00998000
*       THEN                        /* CHECK TO SEE IF THERE         */ 00999000
         B     @RC00438                                            0444 01000000
@RF00438 TM    ADD,B'00100000'                                     0444 01001000
         BNO   @RF00444                                            0444 01002000
*       DO;                         /*                               */ 01003000
*         IF IOPAPP=OFF             /* IF NOT PRESENT                */ 01004000
*           THEN                    /*                               */ 01005000
         TM    IOPAPP(IOPPTR),B'10000000'                          0446 01006000
         BNZ   @RF00446                                            0446 01007000
*           IOPAPP=ON;              /* ADD IT                        */ 01008000
         OI    IOPAPP(IOPPTR),B'10000000'                          0447 01009000
*         ELSE                      /*                               */ 01010000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 01011000
         B     @RC00446                                            0448 01012000
@RF00446 BAL   @14,UCL356I                                         0448 01013000
*       END;                        /* END ADD                       */ 01014000
*     ELSE                          /* MUST BE REPLACE SO            */ 01015000
*       IOPAPP=ON;                  /* ALWAYS ADD OPTION             */ 01016000
         B     @RC00444                                            0450 01017000
@RF00444 OI    IOPAPP(IOPPTR),B'10000000'                          0450 01018000
*   RETURN;                         /* RETURN TO SCAN                */ 01019000
@EL00004 DS    0H                                                  0451 01020000
@EF00004 DS    0H                                                  0451 01021000
@ER00004 LM    @14,@12,@SA00004                                    0451 01022000
         BR    @14                                                 0451 01023000
*                                                                  0452 01024000
*   /*****************************************************************/ 01025000
*   /*                                                               */ 01026000
*   /* PTF ACCEPTED STATUS SCAN EXIT                         @Z63SP00*/ 01027000
*   /*                                                               */ 01028000
*   /*****************************************************************/ 01029000
*                                                                  0452 01030000
*RSMDACC:                                                          0452 01031000
*   ENTRY;                          /*                               */ 01032000
RSMDACC  STM   @14,@12,@SA00004                                    0452 01033000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 01034000
         MVI   MSGPARTS,C' '                                       0453 01035000
         MVC   MSGPARTS+1(131),MSGPARTS                            0453 01036000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 01037000
         L     @06,SCPPTR                                          0454 01038000
         LH    @15,SCPPMLN(,@06)                                   0454 01039000
         BCTR  @15,0                                               0454 01040000
         L     @06,SCPCHAR(,@06)                                   0454 01041000
         EX    @15,@SM02281                                        0454 01042000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 01043000
*     THEN                          /* THEN CHECK PRENSENCE          */ 01044000
         TM    DEL,B'01000000'                                     0455 01045000
         BNO   @RF00455                                            0455 01046000
*     DO;                           /*                               */ 01047000
*       IF IOPACC=ON                /* IF OPTION PRESENT             */ 01048000
*         THEN                      /*                               */ 01049000
         TM    IOPACC(IOPPTR),B'00100000'                          0457 01050000
         BNO   @RF00457                                            0457 01051000
*         IOPACC=OFF;               /* DELETE IT                     */ 01052000
         NI    IOPACC(IOPPTR),B'11011111'                          0458 01053000
*       ELSE                        /*                               */ 01054000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 01055000
         B     @RC00457                                            0459 01056000
@RF00457 BAL   @14,UCL357I                                         0459 01057000
*     END;                          /* END DELETE REQUEST            */ 01058000
*   ELSE                            /* IF NOT DELETE                 */ 01059000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 01060000
*       THEN                        /* CHECK TO SEE IF THERE         */ 01061000
         B     @RC00455                                            0461 01062000
@RF00455 TM    ADD,B'00100000'                                     0461 01063000
         BNO   @RF00461                                            0461 01064000
*       DO;                         /*                               */ 01065000
*         IF IOPACC=OFF             /* IF NOT PRESENT                */ 01066000
*           THEN                    /*                               */ 01067000
         TM    IOPACC(IOPPTR),B'00100000'                          0463 01068000
         BNZ   @RF00463                                            0463 01069000
*           IOPACC=ON;              /* ADD IT                        */ 01070000
         OI    IOPACC(IOPPTR),B'00100000'                          0464 01071000
*         ELSE                      /*                               */ 01072000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 01073000
         B     @RC00463                                            0465 01074000
@RF00463 BAL   @14,UCL356I                                         0465 01075000
*       END;                        /* END ADD                       */ 01076000
*     ELSE                          /* MUST BE REPLACE SO            */ 01077000
*       IOPACC=ON;                  /* ALWAYS ADD OPTION             */ 01078000
         B     @RC00461                                            0467 01079000
@RF00461 OI    IOPACC(IOPPTR),B'00100000'                          0467 01080000
*   RETURN;                         /* RETURN TO SCAN                */ 01081000
         B     @EL00004                                            0468 01082000
*                                                                  0469 01083000
*   /*****************************************************************/ 01084000
*   /*                                                               */ 01085000
*   /* PTF FORCED STATUS SCAN EXIT                           @Z63SP00*/ 01086000
*   /*                                                               */ 01087000
*   /*****************************************************************/ 01088000
*                                                                  0469 01089000
*RSMDBYP:                                                          0469 01090000
*   ENTRY;                          /*                               */ 01091000
RSMDBYP  STM   @14,@12,@SA00004                                    0469 01092000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 01093000
         MVI   MSGPARTS,C' '                                       0470 01094000
         MVC   MSGPARTS+1(131),MSGPARTS                            0470 01095000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 01096000
         L     @06,SCPPTR                                          0471 01097000
         LH    @15,SCPPMLN(,@06)                                   0471 01098000
         BCTR  @15,0                                               0471 01099000
         L     @06,SCPCHAR(,@06)                                   0471 01100000
         EX    @15,@SM02281                                        0471 01101000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 01102000
*     THEN                          /* THEN CHECK PRENSENCE          */ 01103000
         TM    DEL,B'01000000'                                     0472 01104000
         BNO   @RF00472                                            0472 01105000
*     DO;                           /*                               */ 01106000
*       IF IOPBYP=ON                /* IF OPTION PRESENT             */ 01107000
*         THEN                      /*                               */ 01108000
         TM    IOPBYP(IOPPTR),B'00000010'                          0474 01109000
         BNO   @RF00474                                            0474 01110000
*         IOPBYP=OFF;               /* DELETE IT                     */ 01111000
         NI    IOPBYP(IOPPTR),B'11111101'                          0475 01112000
*       ELSE                        /*                               */ 01113000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 01114000
         B     @RC00474                                            0476 01115000
@RF00474 BAL   @14,UCL357I                                         0476 01116000
*     END;                          /* END DELETE REQUEST            */ 01117000
*   ELSE                            /* IF NOT DELETE                 */ 01118000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 01119000
*       THEN                        /* CHECK TO SEE IF THERE         */ 01120000
         B     @RC00472                                            0478 01121000
@RF00472 TM    ADD,B'00100000'                                     0478 01122000
         BNO   @RF00478                                            0478 01123000
*       DO;                         /*                               */ 01124000
*         IF IOPBYP=OFF             /* IF NOT PRESENT                */ 01125000
*           THEN                    /*                               */ 01126000
         TM    IOPBYP(IOPPTR),B'00000010'                          0480 01127000
         BNZ   @RF00480                                            0480 01128000
*           IOPBYP=ON;              /* ADD IT                        */ 01129000
         OI    IOPBYP(IOPPTR),B'00000010'                          0481 01130000
*         ELSE                      /*                               */ 01131000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 01132000
         B     @RC00480                                            0482 01133000
@RF00480 BAL   @14,UCL356I                                         0482 01134000
*       END;                        /* END ADD                       */ 01135000
*     ELSE                          /* MUST BE REPLACE SO            */ 01136000
*       IOPBYP=ON;                  /* ALWAYS ADD OPTION             */ 01137000
         B     @RC00478                                            0484 01138000
@RF00478 OI    IOPBYP(IOPPTR),B'00000010'                          0484 01139000
*   RETURN;                         /* RETURN TO SCAN                */ 01140000
         B     @EL00004                                            0485 01141000
*                                                                  0486 01142000
*   /*****************************************************************/ 01143000
*   /*                                                               */ 01144000
*   /* PTF COPIED FROM ACDS TO CDS AT SYSTEM REGEN TIME SCAN EXIT    */ 01145000
*   /*                                                               */ 01146000
*   /*****************************************************************/ 01147000
*                                                                  0486 01148000
*RSMDRGN:                           /* PTF REGEN SCAN EXIT   @VS05296*/ 01149000
*   ENTRY;                          /*                               */ 01150000
RSMDRGN  STM   @14,@12,@SA00004                                    0486 01151000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 01152000
         MVI   MSGPARTS,C' '                                       0487 01153000
         MVC   MSGPARTS+1(131),MSGPARTS                            0487 01154000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 01155000
         L     @06,SCPPTR                                          0488 01156000
         LH    @15,SCPPMLN(,@06)                                   0488 01157000
         BCTR  @15,0                                               0488 01158000
         L     @06,SCPCHAR(,@06)                                   0488 01159000
         EX    @15,@SM02281                                        0488 01160000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 01161000
*     THEN                          /* THEN CHECK PRENSENCE          */ 01162000
         TM    DEL,B'01000000'                                     0489 01163000
         BNO   @RF00489                                            0489 01164000
*     DO;                           /*                               */ 01165000
*       IF IOPREGEN=ON              /* IF OPTION PRESENT             */ 01166000
*         THEN                      /*                               */ 01167000
         TM    IOPREGEN(IOPPTR),B'00000001'                        0491 01168000
         BNO   @RF00491                                            0491 01169000
*         IOPREGEN=OFF;             /* DELETE IT                     */ 01170000
         NI    IOPREGEN(IOPPTR),B'11111110'                        0492 01171000
*       ELSE                        /*                               */ 01172000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 01173000
         B     @RC00491                                            0493 01174000
@RF00491 BAL   @14,UCL357I                                         0493 01175000
*     END;                          /* END DELETE REQUEST            */ 01176000
*   ELSE                            /* IF NOT DELETE                 */ 01177000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 01178000
*       THEN                        /* CHECK TO SEE IF THERE         */ 01179000
         B     @RC00489                                            0495 01180000
@RF00489 TM    ADD,B'00100000'                                     0495 01181000
         BNO   @RF00495                                            0495 01182000
*       DO;                         /*                               */ 01183000
*         IF IOPREGEN=OFF           /* IF NOT PRESENT                */ 01184000
*           THEN                    /*                               */ 01185000
         TM    IOPREGEN(IOPPTR),B'00000001'                        0497 01186000
         BNZ   @RF00497                                            0497 01187000
*           IOPREGEN=ON;            /* ADD IT                        */ 01188000
         OI    IOPREGEN(IOPPTR),B'00000001'                        0498 01189000
*         ELSE                      /*                               */ 01190000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 01191000
         B     @RC00497                                            0499 01192000
@RF00497 BAL   @14,UCL356I                                         0499 01193000
*       END;                        /* END ADD                       */ 01194000
*     ELSE                          /* MUST BE REPLACE SO            */ 01195000
*       IOPREGEN=ON;                /* ADD IT                        */ 01196000
         B     @RC00495                                            0501 01197000
@RF00495 OI    IOPREGEN(IOPPTR),B'00000001'                        0501 01198000
*   RETURN;                         /* RETURN TO SCAN                */ 01199000
         B     @EL00004                                            0502 01200000
*                                                                  0503 01201000
*   /*****************************************************************/ 01202000
*   /*                                                               */ 01203000
*   /* PTF IN ERROR SCAN EXIT                                @Z40SP00*/ 01204000
*   /*                                                               */ 01205000
*   /*****************************************************************/ 01206000
*                                                                  0503 01207000
*RSMDERR:                           /* PTF IN ERROR EXIT     @Z40SP00*/ 01208000
*   ENTRY;                          /*                               */ 01209000
RSMDERR  STM   @14,@12,@SA00004                                    0503 01210000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 01211000
         MVI   MSGPARTS,C' '                                       0504 01212000
         MVC   MSGPARTS+1(131),MSGPARTS                            0504 01213000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 01214000
         L     @06,SCPPTR                                          0505 01215000
         LH    @15,SCPPMLN(,@06)                                   0505 01216000
         BCTR  @15,0                                               0505 01217000
         L     @06,SCPCHAR(,@06)                                   0505 01218000
         EX    @15,@SM02281                                        0505 01219000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 01220000
*     THEN                          /* THEN CHECK PRENSENCE          */ 01221000
         TM    DEL,B'01000000'                                     0506 01222000
         BNO   @RF00506                                            0506 01223000
*     DO;                           /*                               */ 01224000
*       IF IOPERROR=ON              /* IF OPTION PRESENT             */ 01225000
*         THEN                      /*                               */ 01226000
         TM    IOPERROR(IOPPTR),B'00010000'                        0508 01227000
         BNO   @RF00508                                            0508 01228000
*         IOPERROR=OFF;             /* DELETE IT                     */ 01229000
         NI    IOPERROR(IOPPTR),B'11101111'                        0509 01230000
*       ELSE                        /*                               */ 01231000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 01232000
         B     @RC00508                                            0510 01233000
@RF00508 BAL   @14,UCL357I                                         0510 01234000
*     END;                          /* END DELETE REQUEST            */ 01235000
*   ELSE                            /* IF NOT DELETE                 */ 01236000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 01237000
*       THEN                        /* CHECK TO SEE IF THERE         */ 01238000
         B     @RC00506                                            0512 01239000
@RF00506 TM    ADD,B'00100000'                                     0512 01240000
         BNO   @RF00512                                            0512 01241000
*       DO;                         /*                               */ 01242000
*         IF IOPERROR=OFF           /* IF NOT PRESENT                */ 01243000
*           THEN                    /*                               */ 01244000
         TM    IOPERROR(IOPPTR),B'00010000'                        0514 01245000
         BNZ   @RF00514                                            0514 01246000
*           IOPERROR=ON;            /* ADD IT                        */ 01247000
         OI    IOPERROR(IOPPTR),B'00010000'                        0515 01248000
*         ELSE                      /*                               */ 01249000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 01250000
         B     @RC00514                                            0516 01251000
@RF00514 BAL   @14,UCL356I                                         0516 01252000
*       END;                        /* END ADD                       */ 01253000
*     ELSE                          /* MUST BE REPLACE SO            */ 01254000
*       IOPERROR=ON;                /* ALWAYS ADD OPTION             */ 01255000
         B     @RC00512                                            0518 01256000
@RF00512 OI    IOPERROR(IOPPTR),B'00010000'                        0518 01257000
*   RETURN;                         /* RETURN TO SCAN                */ 01258000
         B     @EL00004                                            0519 01259000
*                                                                  0520 01260000
*   /*****************************************************************/ 01261000
*   /*                                                               */ 01262000
*   /* PTF RESTORED STATUS SCAN EXIT                         @Z40SP00*/ 01263000
*   /*                                                               */ 01264000
*   /*****************************************************************/ 01265000
*                                                                  0520 01266000
*RSMDRES:                           /*                       @Z40SP00*/ 01267000
*   ENTRY;                          /*                               */ 01268000
RSMDRES  STM   @14,@12,@SA00004                                    0520 01269000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 01270000
         MVI   MSGPARTS,C' '                                       0521 01271000
         MVC   MSGPARTS+1(131),MSGPARTS                            0521 01272000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 01273000
         L     @06,SCPPTR                                          0522 01274000
         LH    @15,SCPPMLN(,@06)                                   0522 01275000
         BCTR  @15,0                                               0522 01276000
         L     @06,SCPCHAR(,@06)                                   0522 01277000
         EX    @15,@SM02281                                        0522 01278000
*   IF UCLCDS=ON                    /* RESTORE ONLY FOR CDS          */ 01279000
*     THEN                          /*                               */ 01280000
         L     @06,@PC00001                                        0523 01281000
         TM    UCLCDS(@06),B'10000000'                             0523 01282000
         BNO   @RF00523                                            0523 01283000
*     DO;                           /*                               */ 01284000
*       IF DEL=ON                   /* IF OPTION TO BE DEL           */ 01285000
*         THEN                      /* THEN CHECK PRENSENCE          */ 01286000
         TM    DEL,B'01000000'                                     0525 01287000
         BNO   @RF00525                                            0525 01288000
*         DO;                       /*                               */ 01289000
*           IF IOPRES=ON            /* IF OPTION PRESENT             */ 01290000
*             THEN                  /*                               */ 01291000
         TM    IOPRES(IOPPTR),B'01000000'                          0527 01292000
         BNO   @RF00527                                            0527 01293000
*             IOPRES=OFF;           /* DELETE IT                     */ 01294000
         NI    IOPRES(IOPPTR),B'10111111'                          0528 01295000
*           ELSE                    /*                               */ 01296000
*             CALL UCL357I;         /* OPTION NOT PRESENT            */ 01297000
         B     @RC00527                                            0529 01298000
@RF00527 BAL   @14,UCL357I                                         0529 01299000
*         END;                      /* END DELETE REQUEST            */ 01300000
*       ELSE                        /* IF NOT DELETE                 */ 01301000
*         IF ADD=ON                 /* IF ADD REQUEST                */ 01302000
*           THEN                    /* CHECK TO SEE IF THERE         */ 01303000
         B     @RC00525                                            0531 01304000
@RF00525 TM    ADD,B'00100000'                                     0531 01305000
         BNO   @RF00531                                            0531 01306000
*           DO;                     /*                               */ 01307000
*             IF IOPRES=OFF         /* IF NOT PRESENT                */ 01308000
*               THEN                /*                               */ 01309000
         TM    IOPRES(IOPPTR),B'01000000'                          0533 01310000
         BNZ   @RF00533                                            0533 01311000
*               IOPRES=ON;          /* ADD IT                        */ 01312000
         OI    IOPRES(IOPPTR),B'01000000'                          0534 01313000
*             ELSE                  /*                               */ 01314000
*               CALL UCL356I;       /* OPTION ALREADY THERE          */ 01315000
         B     @RC00533                                            0535 01316000
@RF00533 BAL   @14,UCL356I                                         0535 01317000
*           END;                    /* END ADD                       */ 01318000
*         ELSE                      /* MUST BE REPLACE SO            */ 01319000
*           IOPRES=ON;              /* ADD IT                        */ 01320000
         B     @RC00531                                            0537 01321000
@RF00531 OI    IOPRES(IOPPTR),B'01000000'                          0537 01322000
*     END;                          /* END CDS DATASET               */ 01323000
*   ELSE                            /* SYNTAX ERR IF ACDS            */ 01324000
*     SCPRETRN=SCPSTOP;             /*                               */ 01325000
         B     @RC00523                                            0539 01326000
@RF00523 L     @06,SCPPTR                                          0539 01327000
         MVI   SCPRETRN(@06),X'08'                                 0539 01328000
*   RETURN;                         /* RETURN TO SCAN                */ 01329000
         B     @EL00004                                            0540 01330000
*                                                                  0541 01331000
*   /*****************************************************************/ 01332000
*   /*                                                               */ 01333000
*   /* ROUT TO HANDLE FUNCTION KEYWORD                       @Z63SP00*/ 01334000
*   /*                                                               */ 01335000
*   /*****************************************************************/ 01336000
*                                                                  0541 01337000
*RSMDFNC:                           /*                               */ 01338000
*   ENTRY;                          /*                               */ 01339000
RSMDFNC  STM   @14,@12,@SA00004                                    0541 01340000
*   STYPE=IOPPFUNC;                 /* SET SYSMOD TYPE               */ 01341000
         MVI   STYPE,X'04'                                         0542 01342000
*   GO TO RTYPUPD;                  /* GO UPDATE IT                  */ 01343000
*                                                                  0543 01344000
         B     RTYPUPD                                             0543 01345000
*   /*****************************************************************/ 01346000
*   /*                                                               */ 01347000
*   /* ROUT TO HANDLE PTF KEYWORD                            @Z63SP00*/ 01348000
*   /*                                                               */ 01349000
*   /*****************************************************************/ 01350000
*                                                                  0544 01351000
*RSMDPTF:                           /*                               */ 01352000
*   ENTRY;                          /*                               */ 01353000
RSMDPTF  STM   @14,@12,@SA00004                                    0544 01354000
*   STYPE=IOPPPTF;                  /* SET SYSMOD TYPE               */ 01355000
         MVI   STYPE,X'03'                                         0545 01356000
*   GO TO RTYPUPD;                  /* GO UPDATE IT                  */ 01357000
*                                                                  0546 01358000
         B     RTYPUPD                                             0546 01359000
*   /*****************************************************************/ 01360000
*   /*                                                               */ 01361000
*   /* ROUT TO HANDLE APAR KEYWORD                           @Z63SP00*/ 01362000
*   /*                                                               */ 01363000
*   /*****************************************************************/ 01364000
*                                                                  0547 01365000
*RSMDAPR:                           /*                               */ 01366000
*   ENTRY;                          /*                               */ 01367000
RSMDAPR  STM   @14,@12,@SA00004                                    0547 01368000
*   STYPE=IOPPAPAR;                 /* SET SYSMOD TYPE               */ 01369000
         MVI   STYPE,X'02'                                         0548 01370000
*   GO TO RTYPUPD;                  /* GO UPDATE IT                  */ 01371000
*                                                                  0549 01372000
         B     RTYPUPD                                             0549 01373000
*   /*****************************************************************/ 01374000
*   /*                                                               */ 01375000
*   /* ROUT TO HANLDE USERMOD KEYWORD                        @Z63SP00*/ 01376000
*   /*                                                               */ 01377000
*   /*****************************************************************/ 01378000
*                                                                  0550 01379000
*RSMDUSR:                           /*                               */ 01380000
*   ENTRY;                          /*                               */ 01381000
RSMDUSR  STM   @14,@12,@SA00004                                    0550 01382000
*   STYPE=IOPPUSER;                 /* SET SYSMOD TYPE               */ 01383000
         MVI   STYPE,X'01'                                         0551 01384000
*   GO TO RTYPUPD;                  /* GO UPDATE IT                  */ 01385000
*                                                                  0552 01386000
         B     RTYPUPD                                             0552 01387000
*   /*****************************************************************/ 01388000
*   /*                                                               */ 01389000
*   /* COMMON SYSMOD TYPE UPDATE CODE                        @Z63SP00*/ 01390000
*   /*                                                               */ 01391000
*   /*****************************************************************/ 01392000
*                                                                  0553 01393000
*RTYPUPD:                           /*                               */ 01394000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 01395000
RTYPUPD  MVI   MSGPARTS,C' '                                       0553 01396000
         MVC   MSGPARTS+1(131),MSGPARTS                            0553 01397000
*   MSGPART1(1:LENGTH(TXTSMDTP))=TXTSMDTP;/* SMD-TYP FOR MSG         */ 01398000
         MVC   MSGPART1(8),@CC01518                                0554 01399000
*   MSGPART2(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SYSMOD TYPE           */ 01400000
         L     @06,SCPPTR                                          0555 01401000
         LH    @15,SCPPMLN(,@06)                                   0555 01402000
         BCTR  @15,0                                               0555 01403000
         L     @06,SCPCHAR(,@06)                                   0555 01404000
         EX    @15,@SM02289                                        0555 01405000
*   IF REP=ON                       /*                               */ 01406000
*     THEN                          /*                               */ 01407000
         TM    REP,B'10000000'                                     0556 01408000
         BNO   @RF00556                                            0556 01409000
*     DO;                           /*                               */ 01410000
*       IF IOPPTYPE=ZERO&TOTAL=OFF  /*                               */ 01411000
*         THEN                      /*                               */ 01412000
         CLI   IOPPTYPE(IOPPTR),0                                  0558 01413000
         BNE   @RF00558                                            0558 01414000
         TM    TOTAL,B'00010000'                                   0558 01415000
         BNZ   @RF00558                                            0558 01416000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 01417000
         BAL   @14,UCL358I                                         0559 01418000
*       IOPPTYPE=STYPE;             /* MOVE TYPE OVER                */ 01419000
@RF00558 MVC   IOPPTYPE(1,IOPPTR),STYPE                            0560 01420000
*     END;                          /*                               */ 01421000
*   ELSE                            /*                               */ 01422000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 01423000
*       THEN                        /*                               */ 01424000
         B     @RC00556                                            0562 01425000
@RF00556 TM    ADD,B'00100000'                                     0562 01426000
         BNO   @RF00562                                            0562 01427000
*       DO;                         /*                               */ 01428000
*         IF IOPPTYPE=ZERO          /* ADD ONLY IF NOTHING           */ 01429000
*           THEN                    /* THERE                         */ 01430000
         CLI   IOPPTYPE(IOPPTR),0                                  0564 01431000
         BNE   @RF00564                                            0564 01432000
*           IOPPTYPE=STYPE;         /* ALREADY                       */ 01433000
         MVC   IOPPTYPE(1,IOPPTR),STYPE                            0565 01434000
*         ELSE                      /*                               */ 01435000
*           CALL UCL356I;           /* ERROR                         */ 01436000
         B     @RC00564                                            0566 01437000
@RF00564 BAL   @14,UCL356I                                         0566 01438000
*       END;                        /*                               */ 01439000
*     ELSE                          /*                               */ 01440000
*       DO;                         /*                               */ 01441000
         B     @RC00562                                            0568 01442000
@RF00562 DS    0H                                                  0569 01443000
*         IF IOPPTYPE=STYPE         /* IF SAME TPE IN RCD            */ 01444000
*           THEN                    /* THEN                          */ 01445000
         CLC   IOPPTYPE(1,IOPPTR),STYPE                            0569 01446000
         BNE   @RF00569                                            0569 01447000
*           IOPPTYPE=ZERO;          /* DELETE IT                     */ 01448000
         MVI   IOPPTYPE(IOPPTR),X'00'                              0570 01449000
*         ELSE                      /*                               */ 01450000
*           IF IOPPTYPE=ZERO        /*                               */ 01451000
*             THEN                  /*                               */ 01452000
         B     @RC00569                                            0571 01453000
@RF00569 CLI   IOPPTYPE(IOPPTR),0                                  0571 01454000
         BNE   @RF00571                                            0571 01455000
*             CALL UCL357I;         /* DEL ITEM NOT PRESENT          */ 01456000
         BAL   @14,UCL357I                                         0572 01457000
*           ELSE                    /*                               */ 01458000
*             DO;                   /*                               */ 01459000
         B     @RC00571                                            0573 01460000
@RF00571 DS    0H                                                  0574 01461000
*               IF IOPPTYPE=IOPPPTF /* SET CURRENT TYPE FOR MSG      */ 01462000
*                 THEN              /*                               */ 01463000
         CLI   IOPPTYPE(IOPPTR),3                                  0574 01464000
         BNE   @RF00574                                            0574 01465000
*                 MSGPART3(1:LENGTH(TXTPTF))=TXTPTF;/*               */ 01466000
         MVC   MSGPART3(8),@CC01520                                0575 01467000
*               ELSE                /*                               */ 01468000
*                 IF IOPPTYPE=IOPPFUNC/*                             */ 01469000
*                   THEN            /*                               */ 01470000
         B     @RC00574                                            0576 01471000
@RF00574 CLI   IOPPTYPE(IOPPTR),4                                  0576 01472000
         BNE   @RF00576                                            0576 01473000
*                   MSGPART3(1:LENGTH(TXTFUNC))=TXTFUNC;/*           */ 01474000
         MVC   MSGPART3(8),@CC01522                                0577 01475000
*                 ELSE              /*                               */ 01476000
*                   IF IOPPTYPE=IOPPAPAR/*                           */ 01477000
*                     THEN          /*                               */ 01478000
         B     @RC00576                                            0578 01479000
@RF00576 CLI   IOPPTYPE(IOPPTR),2                                  0578 01480000
         BNE   @RF00578                                            0578 01481000
*                     MSGPART3(1:LENGTH(TXTAPAR))=TXTAPAR;/*         */ 01482000
         MVC   MSGPART3(8),@CC01524                                0579 01483000
*                   ELSE            /*                               */ 01484000
*                     IF IOPPTYPE=IOPPUSER/*                         */ 01485000
*                       THEN        /*                               */ 01486000
         B     @RC00578                                            0580 01487000
@RF00578 CLI   IOPPTYPE(IOPPTR),1                                  0580 01488000
         BNE   @RF00580                                            0580 01489000
*                       MSGPART3(1:LENGTH(TXTUSER))=TXTUSER;/*       */ 01490000
         MVC   MSGPART3(8),@CC01526                                0581 01491000
*               CALL UCL261I;       /* DEL NOT MATCH                 */ 01492000
@RF00580 DS    0H                                                  0582 01493000
@RC00578 DS    0H                                                  0582 01494000
@RC00576 DS    0H                                                  0582 01495000
@RC00574 BAL   @14,UCL261I                                         0582 01496000
*             END;                  /*                               */ 01497000
*       END;                        /*                               */ 01498000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 01499000
         B     @EL00004                                            0585 01500000
*                                                                  0586 01501000
*   /*****************************************************************/ 01502000
*   /*                                                               */ 01503000
*   /* SCAN ROUTINE TO PROCESS THE DATE OPTIONS              @Z63SP00*/ 01504000
*   /*                                                               */ 01505000
*   /*****************************************************************/ 01506000
*                                                                  0586 01507000
*RSMDRECD:                          /*                               */ 01508000
*   ENTRY;                          /*                               */ 01509000
RSMDRECD STM   @14,@12,@SA00004                                    0586 01510000
*   DATEPTR=ADDR(IOPRECD);          /* PTR TO PROPER DATE            */ 01511000
         LA    @06,IOPRECD(,IOPPTR)                                0587 01512000
         ST    @06,DATEPTR                                         0587 01513000
*   GO TO RSMDDT;                   /*                               */ 01514000
         B     RSMDDT                                              0588 01515000
*RSMDAPPD:                          /*                               */ 01516000
*   ENTRY;                          /*                               */ 01517000
RSMDAPPD STM   @14,@12,@SA00004                                    0589 01518000
*   DATEPTR=ADDR(IOPAPPD);          /* PTR TO PROPER DATE            */ 01519000
         LA    @06,IOPAPPD(,IOPPTR)                                0590 01520000
         ST    @06,DATEPTR                                         0590 01521000
*   GO TO RSMDDT;                   /*                               */ 01522000
         B     RSMDDT                                              0591 01523000
*RSMDRESD:                          /*                               */ 01524000
*   ENTRY;                          /*                               */ 01525000
RSMDRESD STM   @14,@12,@SA00004                                    0592 01526000
*   DATEPTR=ADDR(IOPRSTD);          /* PTR TO PROPER DATE            */ 01527000
         LA    @06,IOPRSTD(,IOPPTR)                                0593 01528000
         ST    @06,DATEPTR                                         0593 01529000
*   GO TO RSMDDT;                   /*                               */ 01530000
         B     RSMDDT                                              0594 01531000
*RSMDACCD:                          /*                               */ 01532000
*   ENTRY;                          /*                               */ 01533000
RSMDACCD STM   @14,@12,@SA00004                                    0595 01534000
*   DATEPTR=ADDR(IOPACCD);          /* PTR TO PROPER DATE            */ 01535000
         LA    @06,IOPACCD(,IOPPTR)                                0596 01536000
         ST    @06,DATEPTR                                         0596 01537000
*   GO TO RSMDDT;                   /*                               */ 01538000
         B     RSMDDT                                              0597 01539000
*RSMDDATE:                          /*                               */ 01540000
*   ENTRY;                          /*                               */ 01541000
RSMDDATE STM   @14,@12,@SA00004                                    0598 01542000
*   DATEPTR=ADDR(SAVDATE);          /* TEMP AREA FOR DATE            */ 01543000
         LA    @06,SAVDATE                                         0599 01544000
         ST    @06,DATEPTR                                         0599 01545000
*   SAVDATE=''B;                    /* INIT AREA                     */ 01546000
         XC    SAVDATE(6),SAVDATE                                  0600 01547000
*   DATEENT=ON;                     /* REMEMBER DATE ENTERED         */ 01548000
         OI    DATEENT,B'00100000'                                 0601 01549000
*   GO TO RSMDDT;                   /*                               */ 01550000
         B     RSMDDT                                              0602 01551000
*RSMDDT:                            /*                               */ 01552000
*   MSGPARTS='';                    /* INIT MSG PARM                 */ 01553000
RSMDDT   MVI   MSGPARTS,C' '                                       0603 01554000
         MVC   MSGPARTS+1(131),MSGPARTS                            0603 01555000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE KEYWORD          */ 01556000
         L     @06,SCPPTR                                          0604 01557000
         LH    @15,SCPPMLN(,@06)                                   0604 01558000
         BCTR  @15,0                                               0604 01559000
         L     @06,SCPCHAR(,@06)                                   0604 01560000
         EX    @15,@SM02281                                        0604 01561000
*   RETURN;                         /*                               */ 01562000
         B     @EL00004                                            0605 01563000
*RSMDDTV:                                                          0606 01564000
*   ENTRY;                          /*                               */ 01565000
RSMDDTV  STM   @14,@12,@SA00004                                    0606 01566000
*   DECLARE                         /*                               */ 01567000
*     1 DATEPARM BASED(DATEPTR),    /* MAPPING OF IOP                */ 01568000
*       3 MIOPD CHAR(3),            /* DATE AND                      */ 01569000
*       3 MIOPT CHAR(3);            /* TIME                          */ 01570000
*   UNPK(CNVDATE(1:5),MIOPD(1:3));  /* UNPACK EXISTING DATE          */ 01571000
         L     @06,DATEPTR                                         0608 01572000
         UNPK  CNVDATE(5),MIOPD(3,@06)                             0608 01573000
*   DAY(3)=DAY(3)|HEX0;             /*                               */ 01574000
         OI    DAY+2,X'F0'                                         0609 01575000
*   MSGPART3(1:5)=CNVDATE;          /* MOVE EXISTING DATE FOR MSG    */ 01576000
         MVC   MSGPART3(5),CNVDATE                                 0610 01577000
*   PACK(TEMPDATE,SCPSTRNG(1:5));   /* PACK DATE                     */ 01578000
         L     @01,SCPPTR                                          0611 01579000
         L     @01,SCPCHAR(,@01)                                   0611 01580000
         PACK  TEMPDATE(3),SCPSTRNG(5,@01)                         0611 01581000
*   IF REP=ON                       /*                               */ 01582000
*     THEN                          /*                               */ 01583000
         TM    REP,B'10000000'                                     0612 01584000
         BNO   @RF00612                                            0612 01585000
*     DO;                           /*                               */ 01586000
*       IF MIOPD=ZERO&TOTAL=OFF     /* IF NOT FIRST ADD              */ 01587000
*         THEN                      /*                               */ 01588000
         ICM   @15,7,MIOPD(@06)                                    0614 01589000
         BNZ   @RF00614                                            0614 01590000
         TM    TOTAL,B'00010000'                                   0614 01591000
         BNZ   @RF00614                                            0614 01592000
*         CALL UCL358I;             /*                               */ 01593000
         BAL   @14,UCL358I                                         0615 01594000
*       MIOPD=TEMPDATE;             /*                               */ 01595000
@RF00614 L     @06,DATEPTR                                         0616 01596000
         MVC   MIOPD(3,@06),TEMPDATE                               0616 01597000
*       MIOPT=''B;                  /*                               */ 01598000
         XC    MIOPT(3,@06),MIOPT(@06)                             0617 01599000
*     END;                          /*                               */ 01600000
*   ELSE                            /* IF ADD OR REP                 */ 01601000
*     IF ADD=ON                     /*                               */ 01602000
*       THEN                        /*                               */ 01603000
         B     @RC00612                                            0619 01604000
@RF00612 TM    ADD,B'00100000'                                     0619 01605000
         BNO   @RF00619                                            0619 01606000
*       DO;                         /*                               */ 01607000
*         IF MIOPD=ZERO             /* IF NO DATE THEN CAN           */ 01608000
*           THEN                    /* ADD ONE                       */ 01609000
         L     @06,DATEPTR                                         0621 01610000
         ICM   @15,7,MIOPD(@06)                                    0621 01611000
         BNZ   @RF00621                                            0621 01612000
*           DO;                     /*                               */ 01613000
*             MIOPD=TEMPDATE;       /*                               */ 01614000
         MVC   MIOPD(3,@06),TEMPDATE                               0623 01615000
*             MIOPT=''B;            /*                               */ 01616000
         XC    MIOPT(3,@06),MIOPT(@06)                             0624 01617000
*           END;                    /*                               */ 01618000
*         ELSE                      /* IF ONE PRESENT THEN           */ 01619000
*           CALL UCL356I;           /* ERROR                         */ 01620000
         B     @RC00621                                            0626 01621000
@RF00621 BAL   @14,UCL356I                                         0626 01622000
*       END;                        /*                               */ 01623000
*     ELSE                          /* MUST BE DELETE                */ 01624000
*       DO;                         /*                               */ 01625000
         B     @RC00619                                            0628 01626000
@RF00619 DS    0H                                                  0629 01627000
*         IF TEMPDATE=MIOPD         /* IF EQUAL L                    */ 01628000
*           THEN                    /*                               */ 01629000
         L     @06,DATEPTR                                         0629 01630000
         CLC   TEMPDATE(3),MIOPD(@06)                              0629 01631000
         BNE   @RF00629                                            0629 01632000
*           DO;                     /*                               */ 01633000
*RSMDDTD:                           /* UNCONDITIONAL DEL             */ 01634000
*             ENTRY;                /*                               */ 01635000
         B     @EC00631                                            0631 01636000
RSMDDTD  STM   @14,@12,@SA00004                                    0631 01637000
@EC00631 DS    0H                                                  0632 01638000
*             MIOPD=''B;            /* DELETE DATE                   */ 01639000
         L     @06,DATEPTR                                         0632 01640000
         XC    MIOPD(3,@06),MIOPD(@06)                             0632 01641000
*             MIOPT=''B;            /*                               */ 01642000
         XC    MIOPT(3,@06),MIOPT(@06)                             0633 01643000
*           END;                    /*                               */ 01644000
*         ELSE                      /*                               */ 01645000
*           IF MIOPD=ZERO           /* IF NO DATE                    */ 01646000
*             THEN                  /*                               */ 01647000
         B     @RC00629                                            0635 01648000
@RF00629 L     @06,DATEPTR                                         0635 01649000
         ICM   @15,7,MIOPD(@06)                                    0635 01650000
         BNZ   @RF00635                                            0635 01651000
*             CALL UCL357I;         /*                               */ 01652000
         BAL   @14,UCL357I                                         0636 01653000
*           ELSE                    /*                               */ 01654000
*             CALL UCL261I;         /* WRITE MSG                     */ 01655000
         B     @RC00635                                            0637 01656000
@RF00635 BAL   @14,UCL261I                                         0637 01657000
*       END;                        /* END DELETE                    */ 01658000
*   RETURN;                         /*                               */ 01659000
         B     @EL00004                                            0639 01660000
*                                                                  0640 01661000
*   /*****************************************************************/ 01662000
*   /*                                                               */ 01663000
*   /* SCAN EXITS TO EXTRACT THE PTF MODULE, MACRO, AND SUPER ZAP    */ 01664000
*   /* MODULE NAMES, AND PTF REQ NUMBERS. IF THE OPERATION IS AN ADD */ 01665000
*   /* OR REPLACE THE NAMES ARE ADDED AT THE END OF THE USER DATA IN */ 01666000
*   /* THE IOP. IF THE OPERATION IS CHANGE/ADD THE USER DATA IS FIRST*/ 01667000
*   /* SCANNED TO ENSURE THAT THE NAME IS NOT PRESENT THEN THE NAME  */ 01668000
*   /* IS ADDED AT THE END OF USER DATA. IF THE OPERATION IS @Z63SP00*/ 01669000
*   /* CHANGE/DELETE THE USER DATA IS CHECKED TO ENSURE THAT THE NAME*/ 01670000
*   /* DOES EXIST                                            @Z63SP00*/ 01671000
*   /*                                                               */ 01672000
*   /*****************************************************************/ 01673000
*                                                                  0640 01674000
*RSMDMOD:                           /*                               */ 01675000
*   ENTRY;                          /*                               */ 01676000
RSMDMOD  STM   @14,@12,@SA00004                                    0640 01677000
*   MSGPARTS='';                    /*                               */ 01678000
         MVI   MSGPARTS,C' '                                       0641 01679000
         MVC   MSGPARTS+1(131),MSGPARTS                            0641 01680000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01681000
         L     @06,SCPPTR                                          0642 01682000
         LH    @15,SCPPMLN(,@06)                                   0642 01683000
         BCTR  @15,0                                               0642 01684000
         L     @06,SCPCHAR(,@06)                                   0642 01685000
         EX    @15,@SM02281                                        0642 01686000
*   VLPTYPE=IOPPMODU;               /* SET SUBENTRY TYPE CODE        */ 01687000
         MVI   VLPTYPE,X'01'                                       0643 01688000
*   GO TO SMDADDLP;                 /*                               */ 01689000
         B     SMDADDLP                                            0644 01690000
*RSMDMCU:                           /*                               */ 01691000
*   ENTRY;                          /*                               */ 01692000
RSMDMCU  STM   @14,@12,@SA00004                                    0645 01693000
*   MSGPARTS='';                    /*                               */ 01694000
         MVI   MSGPARTS,C' '                                       0646 01695000
         MVC   MSGPARTS+1(131),MSGPARTS                            0646 01696000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01697000
         L     @06,SCPPTR                                          0647 01698000
         LH    @15,SCPPMLN(,@06)                                   0647 01699000
         BCTR  @15,0                                               0647 01700000
         L     @06,SCPCHAR(,@06)                                   0647 01701000
         EX    @15,@SM02281                                        0647 01702000
*   VLPTYPE=IOPPMACU;               /* SET SUBENTRY TYPE CODE        */ 01703000
         MVI   VLPTYPE,X'05'                                       0648 01704000
*   GO TO SMDADDLP;                 /*                               */ 01705000
         B     SMDADDLP                                            0649 01706000
*RSMDMCR:                           /*                               */ 01707000
*   ENTRY;                          /*                               */ 01708000
RSMDMCR  STM   @14,@12,@SA00004                                    0650 01709000
*   MSGPARTS='';                    /*                               */ 01710000
         MVI   MSGPARTS,C' '                                       0651 01711000
         MVC   MSGPARTS+1(131),MSGPARTS                            0651 01712000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01713000
         L     @06,SCPPTR                                          0652 01714000
         LH    @15,SCPPMLN(,@06)                                   0652 01715000
         BCTR  @15,0                                               0652 01716000
         L     @06,SCPCHAR(,@06)                                   0652 01717000
         EX    @15,@SM02281                                        0652 01718000
*   VLPTYPE=IOPPMACR;               /* SET SUBENTRY TYPE CODE        */ 01719000
         MVI   VLPTYPE,X'04'                                       0653 01720000
*   GO TO SMDADDLP;                 /*                               */ 01721000
         B     SMDADDLP                                            0654 01722000
*RSMDSCU:                           /*                               */ 01723000
*   ENTRY;                          /*                               */ 01724000
RSMDSCU  STM   @14,@12,@SA00004                                    0655 01725000
*   MSGPARTS='';                    /*                               */ 01726000
         MVI   MSGPARTS,C' '                                       0656 01727000
         MVC   MSGPARTS+1(131),MSGPARTS                            0656 01728000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01729000
         L     @06,SCPPTR                                          0657 01730000
         LH    @15,SCPPMLN(,@06)                                   0657 01731000
         BCTR  @15,0                                               0657 01732000
         L     @06,SCPCHAR(,@06)                                   0657 01733000
         EX    @15,@SM02281                                        0657 01734000
*   VLPTYPE=IOPPSRCU;               /* SET SUBENTRY TYPE CODE        */ 01735000
         MVI   VLPTYPE,X'07'                                       0658 01736000
*   GO TO SMDADDLP;                 /*                               */ 01737000
         B     SMDADDLP                                            0659 01738000
*RSMDSCR:                           /*                               */ 01739000
*   ENTRY;                          /*                               */ 01740000
RSMDSCR  STM   @14,@12,@SA00004                                    0660 01741000
*   MSGPARTS='';                    /*                               */ 01742000
         MVI   MSGPARTS,C' '                                       0661 01743000
         MVC   MSGPARTS+1(131),MSGPARTS                            0661 01744000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01745000
         L     @06,SCPPTR                                          0662 01746000
         LH    @15,SCPPMLN(,@06)                                   0662 01747000
         BCTR  @15,0                                               0662 01748000
         L     @06,SCPCHAR(,@06)                                   0662 01749000
         EX    @15,@SM02281                                        0662 01750000
*   VLPTYPE=IOPPSRCR;               /* SET SUBENTRY TYPE CODE        */ 01751000
         MVI   VLPTYPE,X'06'                                       0663 01752000
*   GO TO SMDADDLP;                 /*                               */ 01753000
         B     SMDADDLP                                            0664 01754000
*RSMDSZP:                           /*                               */ 01755000
*   ENTRY;                          /*                               */ 01756000
RSMDSZP  STM   @14,@12,@SA00004                                    0665 01757000
*   MSGPARTS='';                    /*                               */ 01758000
         MVI   MSGPARTS,C' '                                       0666 01759000
         MVC   MSGPARTS+1(131),MSGPARTS                            0666 01760000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01761000
         L     @06,SCPPTR                                          0667 01762000
         LH    @15,SCPPMLN(,@06)                                   0667 01763000
         BCTR  @15,0                                               0667 01764000
         L     @06,SCPCHAR(,@06)                                   0667 01765000
         EX    @15,@SM02281                                        0667 01766000
*   VLPTYPE=IOPPZAP;                /* SET SUBENTRY TYPE CODE        */ 01767000
         MVI   VLPTYPE,X'02'                                       0668 01768000
*   GO TO SMDADDLP;                 /*                               */ 01769000
         B     SMDADDLP                                            0669 01770000
*RSMDXZP:                           /*                               */ 01771000
*   ENTRY;                          /*                               */ 01772000
RSMDXZP  STM   @14,@12,@SA00004                                    0670 01773000
*   MSGPARTS='';                    /*                               */ 01774000
         MVI   MSGPARTS,C' '                                       0671 01775000
         MVC   MSGPARTS+1(131),MSGPARTS                            0671 01776000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01777000
         L     @06,SCPPTR                                          0672 01778000
         LH    @15,SCPPMLN(,@06)                                   0672 01779000
         BCTR  @15,0                                               0672 01780000
         L     @06,SCPCHAR(,@06)                                   0672 01781000
         EX    @15,@SM02281                                        0672 01782000
*   VLPTYPE=IOPPXPD;                /* SET SUBENTRY TYPE CODE        */ 01783000
         MVI   VLPTYPE,X'03'                                       0673 01784000
*   GO TO SMDADDLP;                 /*                               */ 01785000
         B     SMDADDLP                                            0674 01786000
*RSMDASM:                           /*                               */ 01787000
*   ENTRY;                          /*                               */ 01788000
RSMDASM  STM   @14,@12,@SA00004                                    0675 01789000
*   MSGPARTS='';                    /*                               */ 01790000
         MVI   MSGPARTS,C' '                                       0676 01791000
         MVC   MSGPARTS+1(131),MSGPARTS                            0676 01792000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01793000
         L     @06,SCPPTR                                          0677 01794000
         LH    @15,SCPPMLN(,@06)                                   0677 01795000
         BCTR  @15,0                                               0677 01796000
         L     @06,SCPCHAR(,@06)                                   0677 01797000
         EX    @15,@SM02281                                        0677 01798000
*   VLPTYPE=IOPPASM;                /* SET SUBENTRY TYPE CODE        */ 01799000
         MVI   VLPTYPE,X'08'                                       0678 01800000
*   GO TO SMDADDLP;                 /*                               */ 01801000
         B     SMDADDLP                                            0679 01802000
*RSMDRMOD:                          /*                               */ 01803000
*   ENTRY;                          /*                               */ 01804000
RSMDRMOD STM   @14,@12,@SA00004                                    0680 01805000
*   MSGPARTS='';                    /*                               */ 01806000
         MVI   MSGPARTS,C' '                                       0681 01807000
         MVC   MSGPARTS+1(131),MSGPARTS                            0681 01808000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01809000
         L     @06,SCPPTR                                          0682 01810000
         LH    @15,SCPPMLN(,@06)                                   0682 01811000
         BCTR  @15,0                                               0682 01812000
         L     @06,SCPCHAR(,@06)                                   0682 01813000
         EX    @15,@SM02281                                        0682 01814000
*   VLPTYPE=IOPPRMOD;               /* SET SUBENTRY TYPE CODE        */ 01815000
         MVI   VLPTYPE,X'51'                                       0683 01816000
*   GO TO SMDADDLP;                 /*                               */ 01817000
         B     SMDADDLP                                            0684 01818000
*RSMDRMCU:                          /*                               */ 01819000
*   ENTRY;                          /*                               */ 01820000
RSMDRMCU STM   @14,@12,@SA00004                                    0685 01821000
*   MSGPARTS='';                    /*                               */ 01822000
         MVI   MSGPARTS,C' '                                       0686 01823000
         MVC   MSGPARTS+1(131),MSGPARTS                            0686 01824000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01825000
         L     @06,SCPPTR                                          0687 01826000
         LH    @15,SCPPMLN(,@06)                                   0687 01827000
         BCTR  @15,0                                               0687 01828000
         L     @06,SCPCHAR(,@06)                                   0687 01829000
         EX    @15,@SM02281                                        0687 01830000
*   VLPTYPE=IOPPRMCU;               /* SET SUBENTRY TYPE CODE        */ 01831000
         MVI   VLPTYPE,X'55'                                       0688 01832000
*   GO TO SMDADDLP;                 /*                               */ 01833000
         B     SMDADDLP                                            0689 01834000
*RSMDRMCR:                          /*                               */ 01835000
*   ENTRY;                          /*                               */ 01836000
RSMDRMCR STM   @14,@12,@SA00004                                    0690 01837000
*   MSGPARTS='';                    /*                               */ 01838000
         MVI   MSGPARTS,C' '                                       0691 01839000
         MVC   MSGPARTS+1(131),MSGPARTS                            0691 01840000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01841000
         L     @06,SCPPTR                                          0692 01842000
         LH    @15,SCPPMLN(,@06)                                   0692 01843000
         BCTR  @15,0                                               0692 01844000
         L     @06,SCPCHAR(,@06)                                   0692 01845000
         EX    @15,@SM02281                                        0692 01846000
*   VLPTYPE=IOPPRMCR;               /* SET SUBENTRY TYPE CODE        */ 01847000
         MVI   VLPTYPE,X'54'                                       0693 01848000
*   GO TO SMDADDLP;                 /*                               */ 01849000
         B     SMDADDLP                                            0694 01850000
*RSMDRSCU:                          /*                               */ 01851000
*   ENTRY;                          /*                               */ 01852000
RSMDRSCU STM   @14,@12,@SA00004                                    0695 01853000
*   MSGPARTS='';                    /*                               */ 01854000
         MVI   MSGPARTS,C' '                                       0696 01855000
         MVC   MSGPARTS+1(131),MSGPARTS                            0696 01856000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01857000
         L     @06,SCPPTR                                          0697 01858000
         LH    @15,SCPPMLN(,@06)                                   0697 01859000
         BCTR  @15,0                                               0697 01860000
         L     @06,SCPCHAR(,@06)                                   0697 01861000
         EX    @15,@SM02281                                        0697 01862000
*   VLPTYPE=IOPPRSCU;               /* SET SUBENTRY TYPE CODE        */ 01863000
         MVI   VLPTYPE,X'57'                                       0698 01864000
*   GO TO SMDADDLP;                 /*                               */ 01865000
         B     SMDADDLP                                            0699 01866000
*RSMDRSCR:                          /*                               */ 01867000
*   ENTRY;                          /*                               */ 01868000
RSMDRSCR STM   @14,@12,@SA00004                                    0700 01869000
*   MSGPARTS='';                    /*                               */ 01870000
         MVI   MSGPARTS,C' '                                       0701 01871000
         MVC   MSGPARTS+1(131),MSGPARTS                            0701 01872000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01873000
         L     @06,SCPPTR                                          0702 01874000
         LH    @15,SCPPMLN(,@06)                                   0702 01875000
         BCTR  @15,0                                               0702 01876000
         L     @06,SCPCHAR(,@06)                                   0702 01877000
         EX    @15,@SM02281                                        0702 01878000
*   VLPTYPE=IOPPRSCR;               /* SET SUBENTRY TYPE CODE        */ 01879000
         MVI   VLPTYPE,X'56'                                       0703 01880000
*   GO TO SMDADDLP;                 /*                               */ 01881000
         B     SMDADDLP                                            0704 01882000
*RSMDRSZP:                          /*                               */ 01883000
*   ENTRY;                          /*                               */ 01884000
RSMDRSZP STM   @14,@12,@SA00004                                    0705 01885000
*   MSGPARTS='';                    /*                               */ 01886000
         MVI   MSGPARTS,C' '                                       0706 01887000
         MVC   MSGPARTS+1(131),MSGPARTS                            0706 01888000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01889000
         L     @06,SCPPTR                                          0707 01890000
         LH    @15,SCPPMLN(,@06)                                   0707 01891000
         BCTR  @15,0                                               0707 01892000
         L     @06,SCPCHAR(,@06)                                   0707 01893000
         EX    @15,@SM02281                                        0707 01894000
*   VLPTYPE=IOPPRZAP;               /* SET SUBENTRY TYPE CODE        */ 01895000
         MVI   VLPTYPE,X'52'                                       0708 01896000
*   GO TO SMDADDLP;                 /*                               */ 01897000
         B     SMDADDLP                                            0709 01898000
*RSMDRXZP:                          /*                               */ 01899000
*   ENTRY;                          /*                               */ 01900000
RSMDRXZP STM   @14,@12,@SA00004                                    0710 01901000
*   MSGPARTS='';                    /*                               */ 01902000
         MVI   MSGPARTS,C' '                                       0711 01903000
         MVC   MSGPARTS+1(131),MSGPARTS                            0711 01904000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01905000
         L     @06,SCPPTR                                          0712 01906000
         LH    @15,SCPPMLN(,@06)                                   0712 01907000
         BCTR  @15,0                                               0712 01908000
         L     @06,SCPCHAR(,@06)                                   0712 01909000
         EX    @15,@SM02281                                        0712 01910000
*   VLPTYPE=IOPPRXPD;               /* SET SUBENTRY TYPE CODE        */ 01911000
         MVI   VLPTYPE,X'53'                                       0713 01912000
*   GO TO SMDADDLP;                 /*                               */ 01913000
         B     SMDADDLP                                            0714 01914000
*SMDADDLP:                          /* SET UP TO POINT TO FIRST PTF     01915000
*                                      SUBENTRY FOR ADD RTN  @Z40SP00*/ 01916000
*   VLPLPTR=ADDR(IOPPMODS(1));      /* SET PTR TO FIRST PTF SUB-   0715 01917000
*                                      ENTRY                 @Z40SP00*/ 01918000
SMDADDLP LA    @06,IOPPMODS(,IOPPTR)                               0715 01919000
         ST    @06,VLPLPTR                                         0715 01920000
*   VLPDLEN=LENGTH(IOPPMODS(1));    /* SET LEN OF ENT        @ZA14010*/ 01921000
         MVI   VLPDLEN,X'08'                                       0716 01922000
*   RETURN;                         /* RETURN TO SCAN                */ 01923000
         B     @EL00004                                            0717 01924000
*                                                                  0718 01925000
*   /*****************************************************************/ 01926000
*   /*                                                               */ 01927000
*   /* ROUTS TO HANDLE THE VARIOUS PTF NUMBER PTF SUB-ENTRY  @ZD00006*/ 01928000
*   /*                                                               */ 01929000
*   /*****************************************************************/ 01930000
*                                                                  0718 01931000
*RSMDPRE:                           /*                               */ 01932000
*   ENTRY;                          /*                               */ 01933000
RSMDPRE  STM   @14,@12,@SA00004                                    0718 01934000
*   MSGPARTS='';                    /*                               */ 01935000
         MVI   MSGPARTS,C' '                                       0719 01936000
         MVC   MSGPARTS+1(131),MSGPARTS                            0719 01937000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01938000
         L     @06,SCPPTR                                          0720 01939000
         LH    @15,SCPPMLN(,@06)                                   0720 01940000
         BCTR  @15,0                                               0720 01941000
         L     @06,SCPCHAR(,@06)                                   0720 01942000
         EX    @15,@SM02281                                        0720 01943000
*   VLPTYPE=IOPPPRE;                /* SET SUBENTRY TYPE CODE        */ 01944000
         MVI   VLPTYPE,X'A2'                                       0721 01945000
*   GO TO SMDADD2;                  /*                               */ 01946000
         B     SMDADD2                                             0722 01947000
*RSMDREQ:                           /*                               */ 01948000
*   ENTRY;                          /*                               */ 01949000
RSMDREQ  STM   @14,@12,@SA00004                                    0723 01950000
*   MSGPARTS='';                    /*                               */ 01951000
         MVI   MSGPARTS,C' '                                       0724 01952000
         MVC   MSGPARTS+1(131),MSGPARTS                            0724 01953000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01954000
         L     @06,SCPPTR                                          0725 01955000
         LH    @15,SCPPMLN(,@06)                                   0725 01956000
         BCTR  @15,0                                               0725 01957000
         L     @06,SCPCHAR(,@06)                                   0725 01958000
         EX    @15,@SM02281                                        0725 01959000
*   VLPTYPE=IOPPREQ;                /* SET SUBENTRY TYPE CODE        */ 01960000
         MVI   VLPTYPE,X'A5'                                       0726 01961000
*   GO TO SMDADD2;                  /*                               */ 01962000
         B     SMDADD2                                             0727 01963000
*RSMDNPR:                           /*                               */ 01964000
*   ENTRY;                          /*                               */ 01965000
RSMDNPR  STM   @14,@12,@SA00004                                    0728 01966000
*   MSGPARTS='';                    /*                               */ 01967000
         MVI   MSGPARTS,C' '                                       0729 01968000
         MVC   MSGPARTS+1(131),MSGPARTS                            0729 01969000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01970000
         L     @06,SCPPTR                                          0730 01971000
         LH    @15,SCPPMLN(,@06)                                   0730 01972000
         BCTR  @15,0                                               0730 01973000
         L     @06,SCPCHAR(,@06)                                   0730 01974000
         EX    @15,@SM02281                                        0730 01975000
*   VLPTYPE=IOPPNPR;                /* SET SUBENTRY TYPE CODE        */ 01976000
         MVI   VLPTYPE,X'A3'                                       0731 01977000
*   GO TO SMDADD2;                  /*                               */ 01978000
         B     SMDADD2                                             0732 01979000
*RSMDISUP:                          /*                               */ 01980000
*   ENTRY;                          /*                               */ 01981000
RSMDISUP STM   @14,@12,@SA00004                                    0733 01982000
*   MSGPARTS='';                    /*                               */ 01983000
         MVI   MSGPARTS,C' '                                       0734 01984000
         MVC   MSGPARTS+1(131),MSGPARTS                            0734 01985000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 01986000
         L     @06,SCPPTR                                          0735 01987000
         LH    @15,SCPPMLN(,@06)                                   0735 01988000
         BCTR  @15,0                                               0735 01989000
         L     @06,SCPCHAR(,@06)                                   0735 01990000
         EX    @15,@SM02281                                        0735 01991000
*   VLPTYPE=IOPPSUPV;               /* SET SUBENTRY TYPE CODE        */ 01992000
         MVI   VLPTYPE,X'A4'                                       0736 01993000
*   GO TO SMDADD2;                  /*                               */ 01994000
         B     SMDADD2                                             0737 01995000
*RSMDVERS:                          /*                               */ 01996000
*   ENTRY;                          /*                               */ 01997000
RSMDVERS STM   @14,@12,@SA00004                                    0738 01998000
*   MSGPARTS='';                    /*                               */ 01999000
         MVI   MSGPARTS,C' '                                       0739 02000000
         MVC   MSGPARTS+1(131),MSGPARTS                            0739 02001000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 02002000
         L     @06,SCPPTR                                          0740 02003000
         LH    @15,SCPPMLN(,@06)                                   0740 02004000
         BCTR  @15,0                                               0740 02005000
         L     @06,SCPCHAR(,@06)                                   0740 02006000
         EX    @15,@SM02281                                        0740 02007000
*   VLPTYPE=IOPPVER;                /* SET SUBENTRY TYPE CODE        */ 02008000
         MVI   VLPTYPE,X'A9'                                       0741 02009000
*   GO TO SMDADD2;                  /*                               */ 02010000
         B     SMDADD2                                             0742 02011000
*RSMDSBY:                           /*                               */ 02012000
*   ENTRY;                          /*                               */ 02013000
RSMDSBY  STM   @14,@12,@SA00004                                    0743 02014000
*   MSGPARTS='';                    /*                               */ 02015000
         MVI   MSGPARTS,C' '                                       0744 02016000
         MVC   MSGPARTS+1(131),MSGPARTS                            0744 02017000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 02018000
         L     @06,SCPPTR                                          0745 02019000
         LH    @15,SCPPMLN(,@06)                                   0745 02020000
         BCTR  @15,0                                               0745 02021000
         L     @06,SCPCHAR(,@06)                                   0745 02022000
         EX    @15,@SM02281                                        0745 02023000
*   VLPTYPE=IOPPSBY;                /* SET SUBENTRY TYPE CODE        */ 02024000
         MVI   VLPTYPE,X'AA'                                       0746 02025000
*   GO TO SMDADD2;                  /*                               */ 02026000
         B     SMDADD2                                             0747 02027000
*RSMDDEL:                           /*                               */ 02028000
*   ENTRY;                          /*                               */ 02029000
RSMDDEL  STM   @14,@12,@SA00004                                    0748 02030000
*   MSGPARTS='';                    /*                               */ 02031000
         MVI   MSGPARTS,C' '                                       0749 02032000
         MVC   MSGPARTS+1(131),MSGPARTS                            0749 02033000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 02034000
         L     @06,SCPPTR                                          0750 02035000
         LH    @15,SCPPMLN(,@06)                                   0750 02036000
         BCTR  @15,0                                               0750 02037000
         L     @06,SCPCHAR(,@06)                                   0750 02038000
         EX    @15,@SM02281                                        0750 02039000
*   VLPTYPE=IOPPDEL;                /* SET SUBENTRY TYPE CODE        */ 02040000
         MVI   VLPTYPE,X'A8'                                       0751 02041000
*   GO TO SMDADD2;                  /*                               */ 02042000
         B     SMDADD2                                             0752 02043000
*SMDADD2:                           /*                               */ 02044000
*   VLPLPTR=ADDR(IOPPMODS(1));      /* SET START OF LIST     @ZA14010*/ 02045000
SMDADD2  LA    @06,IOPPMODS(,IOPPTR)                               0753 02046000
         ST    @06,VLPLPTR                                         0753 02047000
*   VLPDLEN=LENGTH(IOPENTNM(1));    /* SET LENGTH OF ENT IN PTF FOR     02048000
*                                      COMPARE LOOP. LENGTH OF REQ 0754 02049000
*                                      PTF NUMBER IS EQUAL TO LENGTH    02050000
*                                      OF PTF NUMBER FOR OTHER TYPES    02051000
*                                      OF ENTRIES            @ZD00002*/ 02052000
         MVI   VLPDLEN,X'07'                                       0754 02053000
*   RETURN;                         /*                               */ 02054000
         B     @EL00004                                            0755 02055000
*                                                                  0756 02056000
*   /*****************************************************************/ 02057000
*   /*                                                               */ 02058000
*   /* SCAN ROUTINES TO PROCESS THE FMID KEYWORD                     */ 02059000
*   /*                                                               */ 02060000
*   /*****************************************************************/ 02061000
*                                                                  0756 02062000
*RSMDFMDV:                                                         0756 02063000
*   ENTRY;                          /*                               */ 02064000
RSMDFMDV STM   @14,@12,@SA00004                                    0756 02065000
*   SAVDATA(1:LENGTH(IOPPFMID))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA     */ 02066000
         MVI   SAVDATA+1,C' '                                      0757 02067000
         MVC   SAVDATA+2(5),SAVDATA+1                              0757 02068000
         L     @06,SCPPTR                                          0757 02069000
         LH    @15,SCPPMLN(,@06)                                   0757 02070000
         BCTR  @15,0                                               0757 02071000
         L     @06,SCPCHAR(,@06)                                   0757 02072000
         EX    @15,@SM02291                                        0757 02073000
*   MSGPARTS='';                    /*                               */ 02074000
         MVI   MSGPARTS,C' '                                       0758 02075000
         MVC   MSGPARTS+1(131),MSGPARTS                            0758 02076000
*   MSGPART1=TXTFMID;               /*                               */ 02077000
         MVI   MSGPART1+8,C' '                                     0759 02078000
         MVC   MSGPART1+9(7),MSGPART1+8                            0759 02079000
         MVC   MSGPART1(8),@CC01545                                0759 02080000
*   MSGPART3(1:LENGTH(IOPPFMID))=IOPPFMID;/* OLD DATA FOR MSG        */ 02081000
         MVC   MSGPART3(7),IOPPFMID(IOPPTR)                        0760 02082000
*   IF REP=ON                       /*                               */ 02083000
*     THEN                          /*                               */ 02084000
         TM    REP,B'10000000'                                     0761 02085000
         BNO   @RF00761                                            0761 02086000
*     DO;                           /*                               */ 02087000
*       IF IOPPFMID=BLANK7&TOTAL=OFF/* IF NOT THERE AND NOT TOTAL    */ 02088000
*         THEN                      /*                               */ 02089000
         CLC   IOPPFMID(7,IOPPTR),@CC01416                         0763 02090000
         BNE   @RF00763                                            0763 02091000
         TM    TOTAL,B'00010000'                                   0763 02092000
         BNZ   @RF00763                                            0763 02093000
*         CALL UCL358I;             /*                               */ 02094000
         BAL   @14,UCL358I                                         0764 02095000
*       IOPPFMID=SAVDATA(1:LENGTH(IOPPFMID));/* MOVE OVER DATA       */ 02096000
@RF00763 MVC   IOPPFMID(7,IOPPTR),SAVDATA                          0765 02097000
*     END;                          /*                               */ 02098000
*   ELSE                            /*                               */ 02099000
*     IF ADD=ON                     /* IF ADD                        */ 02100000
*       THEN                        /*                               */ 02101000
         B     @RC00761                                            0767 02102000
@RF00761 TM    ADD,B'00100000'                                     0767 02103000
         BNO   @RF00767                                            0767 02104000
*       DO;                         /*                               */ 02105000
*         IF IOPPFMID=BLANK7        /* IF NOT ALREDY THERE           */ 02106000
*           THEN                    /*                               */ 02107000
         CLC   IOPPFMID(7,IOPPTR),@CC01416                         0769 02108000
         BNE   @RF00769                                            0769 02109000
*           IOPPFMID=SAVDATA(1:LENGTH(IOPPFMID));/* ADD DATA         */ 02110000
         MVC   IOPPFMID(7,IOPPTR),SAVDATA                          0770 02111000
*         ELSE                      /*                               */ 02112000
*           CALL UCL356I;           /* ALREADY PRESENT               */ 02113000
         B     @RC00769                                            0771 02114000
@RF00769 BAL   @14,UCL356I                                         0771 02115000
*       END;                        /*                               */ 02116000
*     ELSE                          /* MUST BE DELETE                */ 02117000
*       DO;                         /*                               */ 02118000
         B     @RC00767                                            0773 02119000
@RF00767 DS    0H                                                  0774 02120000
*         IF IOPPFMID=SAVDATA(1:LENGTH(IOPPFMID))/* IF EQUAL         */ 02121000
*           THEN                    /*                               */ 02122000
         CLC   IOPPFMID(7,IOPPTR),SAVDATA                          0774 02123000
         BNE   @RF00774                                            0774 02124000
*           DO;                     /*                               */ 02125000
*RSMDFMDD:                          /*                               */ 02126000
*             ENTRY;                /*                               */ 02127000
         B     @EC00776                                            0776 02128000
RSMDFMDD STM   @14,@12,@SA00004                                    0776 02129000
@EC00776 DS    0H                                                  0777 02130000
*             IOPPFMID=BLANK7;      /* ZERO FMID                     */ 02131000
         MVC   IOPPFMID(7,IOPPTR),@CC01416                         0777 02132000
*           END;                    /*                               */ 02133000
*         ELSE                      /*                               */ 02134000
*           IF IOPPFMID=BLANK7      /* IF NO DATA                    */ 02135000
*             THEN                  /*                               */ 02136000
         B     @RC00774                                            0779 02137000
@RF00774 CLC   IOPPFMID(7,IOPPTR),@CC01416                         0779 02138000
         BNE   @RF00779                                            0779 02139000
*             CALL UCL357I;         /* DOES NOT EXIST                */ 02140000
         BAL   @14,UCL357I                                         0780 02141000
*           ELSE                    /*                               */ 02142000
*             CALL UCL261I;         /* DOES NOT MATCH                */ 02143000
         B     @RC00779                                            0781 02144000
@RF00779 BAL   @14,UCL261I                                         0781 02145000
*       END;                        /*                               */ 02146000
*   RETURN;                         /*                               */ 02147000
         B     @EL00004                                            0783 02148000
*                                                                  0784 02149000
*   /*****************************************************************/ 02150000
*   /*                                                               */ 02151000
*   /* SCAN ROUTINES TO PROCESS THE LASTSUP KEYWORD                  */ 02152000
*   /*                                                               */ 02153000
*   /*****************************************************************/ 02154000
*                                                                  0784 02155000
*RSMDLSV:                                                          0784 02156000
*   ENTRY;                          /*                               */ 02157000
RSMDLSV  STM   @14,@12,@SA00004                                    0784 02158000
*   SAVDATA(1:LENGTH(IOPSBYNO))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA     */ 02159000
         MVI   SAVDATA+1,C' '                                      0785 02160000
         MVC   SAVDATA+2(5),SAVDATA+1                              0785 02161000
         L     @06,SCPPTR                                          0785 02162000
         LH    @15,SCPPMLN(,@06)                                   0785 02163000
         BCTR  @15,0                                               0785 02164000
         L     @06,SCPCHAR(,@06)                                   0785 02165000
         EX    @15,@SM02291                                        0785 02166000
*   MSGPARTS='';                    /*                               */ 02167000
         MVI   MSGPARTS,C' '                                       0786 02168000
         MVC   MSGPARTS+1(131),MSGPARTS                            0786 02169000
*   MSGPART1=TXTLSUP;               /*                               */ 02170000
         MVI   MSGPART1+8,C' '                                     0787 02171000
         MVC   MSGPART1+9(7),MSGPART1+8                            0787 02172000
         MVC   MSGPART1(8),@CC01512                                0787 02173000
*   MSGPART3(1:LENGTH(IOPSBYNO))=IOPSBYNO;/* OLD DATA FOR MSG        */ 02174000
         MVC   MSGPART3(7),IOPSBYNO(IOPPTR)                        0788 02175000
*   IF REP=ON                       /*                               */ 02176000
*     THEN                          /*                               */ 02177000
         TM    REP,B'10000000'                                     0789 02178000
         BNO   @RF00789                                            0789 02179000
*     DO;                           /*                               */ 02180000
*       IF IOPSBYNO=BLANK7&TOTAL=OFF/* IF NOT THERE                  */ 02181000
*         THEN                      /*                               */ 02182000
         CLC   IOPSBYNO(7,IOPPTR),@CC01416                         0791 02183000
         BNE   @RF00791                                            0791 02184000
         TM    TOTAL,B'00010000'                                   0791 02185000
         BNZ   @RF00791                                            0791 02186000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 02187000
         BAL   @14,UCL358I                                         0792 02188000
*       IOPSBYNO=SAVDATA(1:LENGTH(IOPSBYNO));/* REP DATA             */ 02189000
@RF00791 MVC   IOPSBYNO(7,IOPPTR),SAVDATA                          0793 02190000
*     END;                          /*                               */ 02191000
*   ELSE                            /*                               */ 02192000
*     IF ADD=ON                     /* IF ADD                        */ 02193000
*       THEN                        /*                               */ 02194000
         B     @RC00789                                            0795 02195000
@RF00789 TM    ADD,B'00100000'                                     0795 02196000
         BNO   @RF00795                                            0795 02197000
*       DO;                         /*                               */ 02198000
*         IF IOPSBYNO=BLANK7        /* IF NOT ALREDY THERE           */ 02199000
*           THEN                    /*                               */ 02200000
         CLC   IOPSBYNO(7,IOPPTR),@CC01416                         0797 02201000
         BNE   @RF00797                                            0797 02202000
*           IOPSBYNO=SAVDATA(1:LENGTH(IOPSBYNO));/* ADD DATA         */ 02203000
         MVC   IOPSBYNO(7,IOPPTR),SAVDATA                          0798 02204000
*         ELSE                      /*                               */ 02205000
*           CALL UCL356I;           /* ALREADY PRESENT               */ 02206000
         B     @RC00797                                            0799 02207000
@RF00797 BAL   @14,UCL356I                                         0799 02208000
*       END;                        /*                               */ 02209000
*     ELSE                          /* MUST BE DELETE                */ 02210000
*       DO;                         /*                               */ 02211000
         B     @RC00795                                            0801 02212000
@RF00795 DS    0H                                                  0802 02213000
*         IF IOPSBYNO=SAVDATA(1:LENGTH(IOPSBYNO))/* IF EQUAL         */ 02214000
*           THEN                    /*                               */ 02215000
         CLC   IOPSBYNO(7,IOPPTR),SAVDATA                          0802 02216000
         BNE   @RF00802                                            0802 02217000
*           DO;                     /*                               */ 02218000
*RSMDLSTD:                          /*                               */ 02219000
*             ENTRY;                /*                               */ 02220000
         B     @EC00804                                            0804 02221000
RSMDLSTD STM   @14,@12,@SA00004                                    0804 02222000
@EC00804 DS    0H                                                  0805 02223000
*             IOPSBYNO=BLANK7;      /* ZERO SUPBUNO                  */ 02224000
         MVC   IOPSBYNO(7,IOPPTR),@CC01416                         0805 02225000
*           END;                    /*                               */ 02226000
*         ELSE                      /*                               */ 02227000
*           IF IOPSBYNO=BLANK7      /* IF NO DATA                    */ 02228000
*             THEN                  /*                               */ 02229000
         B     @RC00802                                            0807 02230000
@RF00802 CLC   IOPSBYNO(7,IOPPTR),@CC01416                         0807 02231000
         BNE   @RF00807                                            0807 02232000
*             CALL UCL357I;         /* DOES NOT EXIST                */ 02233000
         BAL   @14,UCL357I                                         0808 02234000
*           ELSE                    /*                               */ 02235000
*             CALL UCL261I;         /* DOES NOT MATCH                */ 02236000
         B     @RC00807                                            0809 02237000
@RF00807 BAL   @14,UCL261I                                         0809 02238000
*       END;                        /*                               */ 02239000
*   RETURN;                         /*                               */ 02240000
         B     @EL00004                                            0811 02241000
*                                                                  0812 02242000
*   /*****************************************************************/ 02243000
*   /*                                                               */ 02244000
*   /* SCAN ROUTINES TO PROCESS THE DELBY KEYWORD                    */ 02245000
*   /*                                                               */ 02246000
*   /*****************************************************************/ 02247000
*                                                                  0812 02248000
*RSMDDBYV:                                                         0812 02249000
*   ENTRY;                          /*                               */ 02250000
RSMDDBYV STM   @14,@12,@SA00004                                    0812 02251000
*   SAVDATA(1:LENGTH(IOPDBYNO))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA     */ 02252000
         MVI   SAVDATA+1,C' '                                      0813 02253000
         MVC   SAVDATA+2(5),SAVDATA+1                              0813 02254000
         L     @06,SCPPTR                                          0813 02255000
         LH    @15,SCPPMLN(,@06)                                   0813 02256000
         BCTR  @15,0                                               0813 02257000
         L     @06,SCPCHAR(,@06)                                   0813 02258000
         EX    @15,@SM02291                                        0813 02259000
*   MSGPARTS='';                    /*                               */ 02260000
         MVI   MSGPARTS,C' '                                       0814 02261000
         MVC   MSGPARTS+1(131),MSGPARTS                            0814 02262000
*   MSGPART1=TXTDELBY;              /*                               */ 02263000
         MVI   MSGPART1+8,C' '                                     0815 02264000
         MVC   MSGPART1+9(7),MSGPART1+8                            0815 02265000
         MVC   MSGPART1(8),@CC01514                                0815 02266000
*   MSGPART3(1:LENGTH(IOPDBYNO))=IOPDBYNO;/* OLD DATA FOR MSG        */ 02267000
         MVC   MSGPART3(7),IOPDBYNO(IOPPTR)                        0816 02268000
*   IF REP=ON                       /*                               */ 02269000
*     THEN                          /*                               */ 02270000
         TM    REP,B'10000000'                                     0817 02271000
         BNO   @RF00817                                            0817 02272000
*     DO;                           /*                               */ 02273000
*       IF IOPDBYNO=BLANK7&TOTAL=OFF/* IF NOT THERE                  */ 02274000
*         THEN                      /*                               */ 02275000
         CLC   IOPDBYNO(7,IOPPTR),@CC01416                         0819 02276000
         BNE   @RF00819                                            0819 02277000
         TM    TOTAL,B'00010000'                                   0819 02278000
         BNZ   @RF00819                                            0819 02279000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 02280000
         BAL   @14,UCL358I                                         0820 02281000
*       IOPDBYNO=SAVDATA(1:LENGTH(IOPDBYNO));/* REPLACE DATA         */ 02282000
@RF00819 MVC   IOPDBYNO(7,IOPPTR),SAVDATA                          0821 02283000
*     END;                          /*                               */ 02284000
*   ELSE                            /*                               */ 02285000
*     IF ADD=ON                     /* IF ADD                        */ 02286000
*       THEN                        /*                               */ 02287000
         B     @RC00817                                            0823 02288000
@RF00817 TM    ADD,B'00100000'                                     0823 02289000
         BNO   @RF00823                                            0823 02290000
*       DO;                         /*                               */ 02291000
*         IF IOPDBYNO=BLANK7        /* IF NOT ALREDY THERE           */ 02292000
*           THEN                    /*                               */ 02293000
         CLC   IOPDBYNO(7,IOPPTR),@CC01416                         0825 02294000
         BNE   @RF00825                                            0825 02295000
*           IOPDBYNO=SAVDATA(1:LENGTH(IOPDBYNO));/* ADD DATA         */ 02296000
         MVC   IOPDBYNO(7,IOPPTR),SAVDATA                          0826 02297000
*         ELSE                      /*                               */ 02298000
*           CALL UCL356I;           /* ALREADY PRESENT               */ 02299000
         B     @RC00825                                            0827 02300000
@RF00825 BAL   @14,UCL356I                                         0827 02301000
*       END;                        /*                               */ 02302000
*     ELSE                          /* MUST BE DELETE                */ 02303000
*       DO;                         /*                               */ 02304000
         B     @RC00823                                            0829 02305000
@RF00823 DS    0H                                                  0830 02306000
*         IF IOPDBYNO=SAVDATA(1:LENGTH(IOPDBYNO))/* IF EQUAL         */ 02307000
*           THEN                    /*                               */ 02308000
         CLC   IOPDBYNO(7,IOPPTR),SAVDATA                          0830 02309000
         BNE   @RF00830                                            0830 02310000
*           DO;                     /*                               */ 02311000
*RSMDDBTD:                          /*                               */ 02312000
*             ENTRY;                /*                               */ 02313000
         B     @EC00832                                            0832 02314000
RSMDDBTD STM   @14,@12,@SA00004                                    0832 02315000
@EC00832 DS    0H                                                  0833 02316000
*             IOPDBYNO=BLANK7;      /* ZERO FMID                     */ 02317000
         MVC   IOPDBYNO(7,IOPPTR),@CC01416                         0833 02318000
*           END;                    /*                               */ 02319000
*         ELSE                      /*                               */ 02320000
*           IF IOPDBYNO=BLANK7      /* IF NO DATA                    */ 02321000
*             THEN                  /*                               */ 02322000
         B     @RC00830                                            0835 02323000
@RF00830 CLC   IOPDBYNO(7,IOPPTR),@CC01416                         0835 02324000
         BNE   @RF00835                                            0835 02325000
*             CALL UCL357I;         /* DOES NOT EXIST                */ 02326000
         BAL   @14,UCL357I                                         0836 02327000
*           ELSE                    /*                               */ 02328000
*             CALL UCL261I;         /* DOES NOT MATCH                */ 02329000
         B     @RC00835                                            0837 02330000
@RF00835 BAL   @14,UCL261I                                         0837 02331000
*       END;                        /*                               */ 02332000
*   RETURN;                         /*                               */ 02333000
         B     @EL00004                                            0839 02334000
*   END RSMDXXX;                    /*                               */ 02335000
         B     @EL00004                                            0840 02336000
         EJECT                                                          02337000
*                                                                  0841 02338000
*   /*****************************************************************/ 02339000
*   /*                                                               */ 02340000
*   /* ROUTINE TO PROCESS KEYWORDS ASSOCIATED WITH MAC AND SRC       */ 02341000
*   /*                                                               */ 02342000
*   /*****************************************************************/ 02343000
*                                                                  0841 02344000
*RMACXXX:                           /*                               */ 02345000
*   PROCEDURE;                      /*                               */ 02346000
*                                                                  0841 02347000
RMACXXX  STM   @14,@12,@SA00005                                    0841 02348000
*   /*****************************************************************/ 02349000
*   /*                                                               */ 02350000
*   /* ROUT TO PROCESS DISTLIB KEYWORD                               */ 02351000
*   /*                                                               */ 02352000
*   /*****************************************************************/ 02353000
*                                                                  0842 02354000
*RMACDLBV:                          /*                               */ 02355000
*   ENTRY;                          /*                               */ 02356000
         B     @EC00842                                            0842 02357000
RMACDLBV STM   @14,@12,@SA00005                                    0842 02358000
@EC00842 DS    0H                                                  0843 02359000
*   SAVDATA(1:LENGTH(IOPMCDLB))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA     */ 02360000
         MVI   SAVDATA+1,C' '                                      0843 02361000
         MVC   SAVDATA+2(6),SAVDATA+1                              0843 02362000
         L     @06,SCPPTR                                          0843 02363000
         LH    @15,SCPPMLN(,@06)                                   0843 02364000
         BCTR  @15,0                                               0843 02365000
         L     @06,SCPCHAR(,@06)                                   0843 02366000
         EX    @15,@SM02291                                        0843 02367000
*   MSGPARTS='';                    /* CLEAR MSG PART                */ 02368000
         MVI   MSGPARTS,C' '                                       0844 02369000
         MVC   MSGPARTS+1(131),MSGPARTS                            0844 02370000
*   MSGPART1(1:LENGTH(TXTDIST))=TXTDIST;/* SET TYPE                  */ 02371000
         MVC   MSGPART1(8),@CC01539                                0845 02372000
*   MSGPART3(1:LENGTH(IOPMCDLB))=IOPMCDLB;/* SAVE OLD VALUE          */ 02373000
         MVC   MSGPART3(8),IOPMCDLB(IOPPTR)                        0846 02374000
*   IF REP=ON                       /*                               */ 02375000
*     THEN                          /*                               */ 02376000
         TM    REP,B'10000000'                                     0847 02377000
         BNO   @RF00847                                            0847 02378000
*     DO;                           /*                               */ 02379000
*       IF IOPMCDLB=BLANK8&TOTAL=OFF/*                               */ 02380000
*         THEN                      /*                               */ 02381000
         CLC   IOPMCDLB(8,IOPPTR),BLANK8                           0849 02382000
         BNE   @RF00849                                            0849 02383000
         TM    TOTAL,B'00010000'                                   0849 02384000
         BNZ   @RF00849                                            0849 02385000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 02386000
         BAL   @14,UCL358I                                         0850 02387000
*       IOPMCDLB=SAVDATA(1:LENGTH(IOPMCDLB));/* REP OLD DATA         */ 02388000
@RF00849 MVC   IOPMCDLB(8,IOPPTR),SAVDATA                          0851 02389000
*     END;                          /*                               */ 02390000
*   ELSE                            /*                               */ 02391000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 02392000
*       THEN                        /*                               */ 02393000
         B     @RC00847                                            0853 02394000
@RF00847 TM    ADD,B'00100000'                                     0853 02395000
         BNO   @RF00853                                            0853 02396000
*       DO;                         /*                               */ 02397000
*         IF IOPMCDLB=BLANK8        /* IF NO DATA THERE              */ 02398000
*           THEN                    /*                               */ 02399000
         CLC   IOPMCDLB(8,IOPPTR),BLANK8                           0855 02400000
         BNE   @RF00855                                            0855 02401000
*           IOPMCDLB=SAVDATA(1:LENGTH(IOPMCDLB));/* ADD NEW DATA     */ 02402000
         MVC   IOPMCDLB(8,IOPPTR),SAVDATA                          0856 02403000
*         ELSE                      /*                               */ 02404000
*           CALL UCL356I;           /* ALREADY THERE MSG             */ 02405000
         B     @RC00855                                            0857 02406000
@RF00855 BAL   @14,UCL356I                                         0857 02407000
*       END;                        /*                               */ 02408000
*     ELSE                          /* MUST BE DELETE                */ 02409000
*       DO;                         /*                               */ 02410000
         B     @RC00853                                            0859 02411000
@RF00853 DS    0H                                                  0860 02412000
*         IF IOPMCDLB=SAVDATA(1:LENGTH(IOPMCDLB))/* IF EQUAL         */ 02413000
*           THEN                    /*                               */ 02414000
         CLC   IOPMCDLB(8,IOPPTR),SAVDATA                          0860 02415000
         BNE   @RF00860                                            0860 02416000
*           DO;                     /*                               */ 02417000
*RMACDLBD:                          /*                               */ 02418000
*             ENTRY;                /*                               */ 02419000
         B     @EC00862                                            0862 02420000
RMACDLBD STM   @14,@12,@SA00005                                    0862 02421000
@EC00862 DS    0H                                                  0863 02422000
*             IOPMCDLB=BLANK8;      /* DELETE IT                     */ 02423000
         MVC   IOPMCDLB(8,IOPPTR),BLANK8                           0863 02424000
*           END;                    /*                               */ 02425000
*         ELSE                      /*                               */ 02426000
*           IF IOPMCDLB=BLANK8      /* IF NO DLIB PRESENT            */ 02427000
*             THEN                  /*                               */ 02428000
         B     @RC00860                                            0865 02429000
@RF00860 CLC   IOPMCDLB(8,IOPPTR),BLANK8                           0865 02430000
         BNE   @RF00865                                            0865 02431000
*             CALL UCL357I;         /* DATA NOT PRESENT              */ 02432000
         BAL   @14,UCL357I                                         0866 02433000
*           ELSE                    /*                               */ 02434000
*             CALL UCL261I;         /* DATA DOES NOT MATCH           */ 02435000
         B     @RC00865                                            0867 02436000
@RF00865 BAL   @14,UCL261I                                         0867 02437000
*       END;                        /*                               */ 02438000
*   RETURN;                         /*                               */ 02439000
@EL00005 DS    0H                                                  0869 02440000
@EF00005 DS    0H                                                  0869 02441000
@ER00005 LM    @14,@12,@SA00005                                    0869 02442000
         BR    @14                                                 0869 02443000
*                                                                  0870 02444000
*   /*****************************************************************/ 02445000
*   /*                                                               */ 02446000
*   /* ROUT TO PROCESS SYSLIB KEYWORD                                */ 02447000
*   /*                                                               */ 02448000
*   /*****************************************************************/ 02449000
*                                                                  0870 02450000
*RMACSYV:                           /*                               */ 02451000
*   ENTRY;                          /*                               */ 02452000
RMACSYV  STM   @14,@12,@SA00005                                    0870 02453000
*   SAVDATA(1:LENGTH(IOPMCSYS))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA     */ 02454000
         MVI   SAVDATA+1,C' '                                      0871 02455000
         MVC   SAVDATA+2(6),SAVDATA+1                              0871 02456000
         L     @06,SCPPTR                                          0871 02457000
         LH    @15,SCPPMLN(,@06)                                   0871 02458000
         BCTR  @15,0                                               0871 02459000
         L     @06,SCPCHAR(,@06)                                   0871 02460000
         EX    @15,@SM02291                                        0871 02461000
*   MSGPARTS='';                    /* CLEAR MSG PART                */ 02462000
         MVI   MSGPARTS,C' '                                       0872 02463000
         MVC   MSGPARTS+1(131),MSGPARTS                            0872 02464000
*   MSGPART1(1:LENGTH(TXTDIST))=TXTSYSLB;/* SET TYPE                 */ 02465000
         MVC   MSGPART1(8),@CC01547                                0873 02466000
*   MSGPART3(1:LENGTH(IOPMCSYS))=IOPMCSYS;/* SAVE OLD VALUE          */ 02467000
         MVC   MSGPART3(8),IOPMCSYS(IOPPTR)                        0874 02468000
*   IF REP=ON                       /*                               */ 02469000
*     THEN                          /*                               */ 02470000
         TM    REP,B'10000000'                                     0875 02471000
         BNO   @RF00875                                            0875 02472000
*     DO;                           /*                               */ 02473000
*       IF IOPMCSYS=BLANK8&TOTAL=OFF/*                               */ 02474000
*         THEN                      /*                               */ 02475000
         CLC   IOPMCSYS(8,IOPPTR),BLANK8                           0877 02476000
         BNE   @RF00877                                            0877 02477000
         TM    TOTAL,B'00010000'                                   0877 02478000
         BNZ   @RF00877                                            0877 02479000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 02480000
         BAL   @14,UCL358I                                         0878 02481000
*       IOPMCSYS=SAVDATA(1:LENGTH(IOPMCSYS));/* REP OLD DATA         */ 02482000
@RF00877 MVC   IOPMCSYS(8,IOPPTR),SAVDATA                          0879 02483000
*     END;                          /*                               */ 02484000
*   ELSE                            /*                               */ 02485000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 02486000
*       THEN                        /*                               */ 02487000
         B     @RC00875                                            0881 02488000
@RF00875 TM    ADD,B'00100000'                                     0881 02489000
         BNO   @RF00881                                            0881 02490000
*       DO;                         /*                               */ 02491000
*         IF IOPMCSYS=BLANK8        /* IF NO DATA THERE              */ 02492000
*           THEN                    /*                               */ 02493000
         CLC   IOPMCSYS(8,IOPPTR),BLANK8                           0883 02494000
         BNE   @RF00883                                            0883 02495000
*           IOPMCSYS=SAVDATA(1:LENGTH(IOPMCSYS));/* ADD NEW DATA     */ 02496000
         MVC   IOPMCSYS(8,IOPPTR),SAVDATA                          0884 02497000
*         ELSE                      /*                               */ 02498000
*           CALL UCL356I;           /* ALREADY THERE MSG             */ 02499000
         B     @RC00883                                            0885 02500000
@RF00883 BAL   @14,UCL356I                                         0885 02501000
*       END;                        /*                               */ 02502000
*     ELSE                          /* MUST BE DELETE                */ 02503000
*       DO;                         /*                               */ 02504000
         B     @RC00881                                            0887 02505000
@RF00881 DS    0H                                                  0888 02506000
*         IF IOPMCSYS=SAVDATA(1:LENGTH(IOPMCSYS))/* IF EQUAL         */ 02507000
*           THEN                    /*                               */ 02508000
         CLC   IOPMCSYS(8,IOPPTR),SAVDATA                          0888 02509000
         BNE   @RF00888                                            0888 02510000
*           DO;                     /*                               */ 02511000
*RMACSYD:                           /*                               */ 02512000
*             ENTRY;                /*                               */ 02513000
         B     @EC00890                                            0890 02514000
RMACSYD  STM   @14,@12,@SA00005                                    0890 02515000
@EC00890 DS    0H                                                  0891 02516000
*             IOPMCSYS=BLANK8;      /* DELETE IT                     */ 02517000
         MVC   IOPMCSYS(8,IOPPTR),BLANK8                           0891 02518000
*           END;                    /*                               */ 02519000
*         ELSE                      /*                               */ 02520000
*           IF IOPMCSYS=BLANK8      /* IF NO SYSLIB PRESENT          */ 02521000
*             THEN                  /*                               */ 02522000
         B     @RC00888                                            0893 02523000
@RF00888 CLC   IOPMCSYS(8,IOPPTR),BLANK8                           0893 02524000
         BNE   @RF00893                                            0893 02525000
*             CALL UCL357I;         /* DATA NOT PRESENT              */ 02526000
         BAL   @14,UCL357I                                         0894 02527000
*           ELSE                    /*                               */ 02528000
*             CALL UCL261I;         /* DATA DOES NOT MATCH           */ 02529000
         B     @RC00893                                            0895 02530000
@RF00893 BAL   @14,UCL261I                                         0895 02531000
*       END;                        /*                               */ 02532000
*   RETURN;                         /*                               */ 02533000
         B     @EL00005                                            0897 02534000
*                                                                  0898 02535000
*   /*****************************************************************/ 02536000
*   /*                                                               */ 02537000
*   /* ROUT TO PROCESS VARIABLE ENTRIES IN MAC                       */ 02538000
*   /*                                                               */ 02539000
*   /*****************************************************************/ 02540000
*                                                                  0898 02541000
*RMACUMID:                          /*                               */ 02542000
*   ENTRY;                          /*                               */ 02543000
RMACUMID STM   @14,@12,@SA00005                                    0898 02544000
*   MSGPARTS='';                    /*                               */ 02545000
         MVI   MSGPARTS,C' '                                       0899 02546000
         MVC   MSGPARTS+1(131),MSGPARTS                            0899 02547000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/*                       */ 02548000
         L     @06,SCPPTR                                          0900 02549000
         LH    @15,SCPPMLN(,@06)                                   0900 02550000
         BCTR  @15,0                                               0900 02551000
         L     @06,SCPCHAR(,@06)                                   0900 02552000
         EX    @15,@SM02281                                        0900 02553000
*   VLPTYPE=IOPUMID;                /*                               */ 02554000
         MVI   VLPTYPE,X'32'                                       0901 02555000
*   VLPDLEN=LENGTH(IOPMACID(1));    /*                               */ 02556000
         MVI   VLPDLEN,X'07'                                       0902 02557000
*   GO TO RMACADD1;                 /*                               */ 02558000
         B     RMACADD1                                            0903 02559000
*RMACGASM:                          /*                               */ 02560000
*   ENTRY;                          /*                               */ 02561000
RMACGASM STM   @14,@12,@SA00005                                    0904 02562000
*   MSGPARTS='';                    /*                               */ 02563000
         MVI   MSGPARTS,C' '                                       0905 02564000
         MVC   MSGPARTS+1(131),MSGPARTS                            0905 02565000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/*                       */ 02566000
         L     @06,SCPPTR                                          0906 02567000
         LH    @15,SCPPMLN(,@06)                                   0906 02568000
         BCTR  @15,0                                               0906 02569000
         L     @06,SCPCHAR(,@06)                                   0906 02570000
         EX    @15,@SM02281                                        0906 02571000
*   IF IOPTYPE=IOPMAC               /* IF MAC                        */ 02572000
*     THEN                          /*                               */ 02573000
         CLI   IOPTYPE(IOPPTR),3                                   0907 02574000
         BNE   @RF00907                                            0907 02575000
*     DO;                           /*                               */ 02576000
*       VLPTYPE=IOPMASMS;           /* OK                            */ 02577000
         MVI   VLPTYPE,X'01'                                       0909 02578000
*       VLPDLEN=LENGTH(IOPMCASM);   /*                               */ 02579000
         MVI   VLPDLEN,X'08'                                       0910 02580000
*     END;                          /*                               */ 02581000
*   ELSE                            /* IF SRC                        */ 02582000
*     SCPRETRN=SCPSTOP;             /* SYNTAX                        */ 02583000
         B     @RC00907                                            0912 02584000
@RF00907 L     @06,SCPPTR                                          0912 02585000
         MVI   SCPRETRN(@06),X'08'                                 0912 02586000
*   GO TO RMACADD1;                 /*                               */ 02587000
         B     RMACADD1                                            0913 02588000
*RMACMAL:                           /*                               */ 02589000
*   ENTRY;                          /*                               */ 02590000
RMACMAL  STM   @14,@12,@SA00005                                    0914 02591000
*   MSGPARTS='';                    /*                               */ 02592000
         MVI   MSGPARTS,C' '                                       0915 02593000
         MVC   MSGPARTS+1(131),MSGPARTS                            0915 02594000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/*                       */ 02595000
         L     @06,SCPPTR                                          0916 02596000
         LH    @15,SCPPMLN(,@06)                                   0916 02597000
         BCTR  @15,0                                               0916 02598000
         L     @06,SCPCHAR(,@06)                                   0916 02599000
         EX    @15,@SM02281                                        0916 02600000
*   IF IOPTYPE=IOPMAC               /* IF MAC                        */ 02601000
*     THEN                          /*                               */ 02602000
         CLI   IOPTYPE(IOPPTR),3                                   0917 02603000
         BNE   @RF00917                                            0917 02604000
*     DO;                           /*                               */ 02605000
*       VLPTYPE=IOPMCMAL;           /*                               */ 02606000
         MVI   VLPTYPE,X'02'                                       0919 02607000
*       VLPDLEN=LENGTH(IOPMCASM);   /*                               */ 02608000
         MVI   VLPDLEN,X'08'                                       0920 02609000
*     END;                          /*                               */ 02610000
*   ELSE                            /* IF SRC                        */ 02611000
*     SCPRETRN=SCPSTOP;             /* SYNTAX                        */ 02612000
         B     @RC00917                                            0922 02613000
@RF00917 L     @06,SCPPTR                                          0922 02614000
         MVI   SCPRETRN(@06),X'08'                                 0922 02615000
*   GO TO RMACADD1;                 /*                               */ 02616000
         B     RMACADD1                                            0923 02617000
*RMACADD1:                          /*                               */ 02618000
*   VLPLPTR=ADDR(IOPMCENT(1));      /*                               */ 02619000
RMACADD1 LA    @06,IOPMCENT(,IOPPTR)                               0924 02620000
         ST    @06,VLPLPTR                                         0924 02621000
*   RETURN;                         /*                               */ 02622000
         B     @EL00005                                            0925 02623000
*                                                                  0926 02624000
*   /*****************************************************************/ 02625000
*   /*                                                               */ 02626000
*   /* ROUTS TO CHECK FOR R3 KEYWORD                                 */ 02627000
*   /*                                                               */ 02628000
*   /*****************************************************************/ 02629000
*                                                                  0926 02630000
*RMACASSM:                          /*                               */ 02631000
*RMACASML:                          /*                               */ 02632000
*   ENTRY;                          /*                               */ 02633000
RMACASSM DS    0H                                                  0926 02634000
RMACASML STM   @14,@12,@SA00005                                    0926 02635000
*   IF IOPTYPE^=IOPMAC              /* IF NOT MAC (SRC)              */ 02636000
*     THEN                          /* THEN ERR                      */ 02637000
         CLI   IOPTYPE(IOPPTR),3                                   0927 02638000
         BE    @RF00927                                            0927 02639000
*     SCPRETRN=SCPSTOP;             /*                               */ 02640000
         L     @06,SCPPTR                                          0928 02641000
         MVI   SCPRETRN(@06),X'08'                                 0928 02642000
*   RETURN;                         /*                               */ 02643000
         B     @EL00005                                            0929 02644000
*   END RMACXXX;                    /*                               */ 02645000
         B     @EL00005                                            0930 02646000
         EJECT                                                          02647000
*                                                                  0931 02648000
*   /*****************************************************************/ 02649000
*   /*                                                               */ 02650000
*   /* ROUTS TO PROCESS KEYWORDS ASSOCIATED WITH MOD ENTRIES         */ 02651000
*   /*                                                               */ 02652000
*   /*****************************************************************/ 02653000
*                                                                  0931 02654000
*RMODXXX:                           /*                               */ 02655000
*   PROCEDURE;                      /*                               */ 02656000
RMODXXX  STM   @14,@12,@SA00006                                    0931 02657000
*RMODRMDV:                          /*                               */ 02658000
*RMACRMDV:                          /*                               */ 02659000
*   ENTRY;                          /*                               */ 02660000
         B     @EC00932                                            0932 02661000
RMODRMDV DS    0H                                                  0932 02662000
RMACRMDV STM   @14,@12,@SA00006                                    0932 02663000
@EC00932 DS    0H                                                  0933 02664000
*   SAVDATA(1:LENGTH(IOPRMID))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA      */ 02665000
         MVI   SAVDATA+1,C' '                                      0933 02666000
         MVC   SAVDATA+2(5),SAVDATA+1                              0933 02667000
         L     @06,SCPPTR                                          0933 02668000
         LH    @15,SCPPMLN(,@06)                                   0933 02669000
         BCTR  @15,0                                               0933 02670000
         L     @06,SCPCHAR(,@06)                                   0933 02671000
         EX    @15,@SM02291                                        0933 02672000
*   MSGPARTS='';                    /* CLEAR MSG PART                */ 02673000
         MVI   MSGPARTS,C' '                                       0934 02674000
         MVC   MSGPARTS+1(131),MSGPARTS                            0934 02675000
*   MSGPART1(1:LENGTH(TXTRMID))=TXTRMID;/* SET TYPE                  */ 02676000
         MVC   MSGPART1(4),@CC01541                                0935 02677000
*   MSGPART3(1:LENGTH(IOPRMID))=IOPRMID;/* SAVE OLD VALUE            */ 02678000
         MVC   MSGPART3(7),IOPRMID(IOPPTR)                         0936 02679000
*   IF REP=ON                       /*                               */ 02680000
*     THEN                          /*                               */ 02681000
         TM    REP,B'10000000'                                     0937 02682000
         BNO   @RF00937                                            0937 02683000
*     DO;                           /*                               */ 02684000
*       IF IOPRMID=BLANK7&TOTAL=OFF /*                               */ 02685000
*         THEN                      /*                               */ 02686000
         CLC   IOPRMID(7,IOPPTR),@CC01416                          0939 02687000
         BNE   @RF00939                                            0939 02688000
         TM    TOTAL,B'00010000'                                   0939 02689000
         BNZ   @RF00939                                            0939 02690000
*         CALL UCL358I;             /*                               */ 02691000
         BAL   @14,UCL358I                                         0940 02692000
*       IOPRMID=SAVDATA(1:LENGTH(IOPRMID));/* REP OLD RMID           */ 02693000
@RF00939 MVC   IOPRMID(7,IOPPTR),SAVDATA                           0941 02694000
*       IOPRMST=''B;                /* ZERO STATUS                   */ 02695000
         MVI   IOPRMST(IOPPTR),X'00'                               0942 02696000
*     END;                          /*                               */ 02697000
*   ELSE                            /*                               */ 02698000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 02699000
*       THEN                        /*                               */ 02700000
         B     @RC00937                                            0944 02701000
@RF00937 TM    ADD,B'00100000'                                     0944 02702000
         BNO   @RF00944                                            0944 02703000
*       DO;                         /*                               */ 02704000
*         IF IOPRMID=BLANK7         /* IF NO DATA THERE              */ 02705000
*           THEN                    /*                               */ 02706000
         CLC   IOPRMID(7,IOPPTR),@CC01416                          0946 02707000
         BNE   @RF00946                                            0946 02708000
*           IOPRMID=SAVDATA(1:LENGTH(IOPRMID));/*                    */ 02709000
         MVC   IOPRMID(7,IOPPTR),SAVDATA                           0947 02710000
*         ELSE                      /*                               */ 02711000
*           CALL UCL356I;           /* ALREADY THERE MSG             */ 02712000
         B     @RC00946                                            0948 02713000
@RF00946 BAL   @14,UCL356I                                         0948 02714000
*       END;                        /*                               */ 02715000
*     ELSE                          /* MUST BE DELETE                */ 02716000
*       DO;                         /*                               */ 02717000
         B     @RC00944                                            0950 02718000
@RF00944 DS    0H                                                  0951 02719000
*         IF IOPRMID=SAVDATA(1:LENGTH(IOPRMID))/* IF EQUAL           */ 02720000
*           THEN                    /*                               */ 02721000
         CLC   IOPRMID(7,IOPPTR),SAVDATA                           0951 02722000
         BNE   @RF00951                                            0951 02723000
*           DO;                     /*                               */ 02724000
*RMODRMDD:                          /*                               */ 02725000
*RMACRMDD:                          /*                               */ 02726000
*             ENTRY;                /*                               */ 02727000
         B     @EC00953                                            0953 02728000
RMODRMDD DS    0H                                                  0953 02729000
RMACRMDD STM   @14,@12,@SA00006                                    0953 02730000
@EC00953 DS    0H                                                  0954 02731000
*             IOPRMID=BLANK7;       /* DELETE IT                     */ 02732000
         MVC   IOPRMID(7,IOPPTR),@CC01416                          0954 02733000
*             IOPRMST=''B;          /* ZERO STATUS BITS              */ 02734000
         MVI   IOPRMST(IOPPTR),X'00'                               0955 02735000
*           END;                    /*                               */ 02736000
*         ELSE                      /*                               */ 02737000
*           IF IOPRMID=BLANK7       /* IF NO RMID PRESENT            */ 02738000
*             THEN                  /*                               */ 02739000
         B     @RC00951                                            0957 02740000
@RF00951 CLC   IOPRMID(7,IOPPTR),@CC01416                          0957 02741000
         BNE   @RF00957                                            0957 02742000
*             CALL UCL357I;         /* DATA NOT PRESENT              */ 02743000
         BAL   @14,UCL357I                                         0958 02744000
*           ELSE                    /*                               */ 02745000
*             CALL UCL261I;         /* DATA DOES NOT MATCH           */ 02746000
         B     @RC00957                                            0959 02747000
@RF00957 BAL   @14,UCL261I                                         0959 02748000
*       END;                        /*                               */ 02749000
*   RETURN;                         /*                               */ 02750000
@EL00006 DS    0H                                                  0961 02751000
@EF00006 DS    0H                                                  0961 02752000
@ER00006 LM    @14,@12,@SA00006                                    0961 02753000
         BR    @14                                                 0961 02754000
*                                                                  0962 02755000
*   /*****************************************************************/ 02756000
*   /*                                                               */ 02757000
*   /* ROUT TO PROCESS DISTLIB KEYWORD                               */ 02758000
*   /*                                                               */ 02759000
*   /*****************************************************************/ 02760000
*                                                                  0962 02761000
*RMODDLBV:                          /*                               */ 02762000
*   ENTRY;                          /*                               */ 02763000
RMODDLBV STM   @14,@12,@SA00006                                    0962 02764000
*   SAVDATA(1:LENGTH(IOPDLIB))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA      */ 02765000
         MVI   SAVDATA+1,C' '                                      0963 02766000
         MVC   SAVDATA+2(6),SAVDATA+1                              0963 02767000
         L     @06,SCPPTR                                          0963 02768000
         LH    @15,SCPPMLN(,@06)                                   0963 02769000
         BCTR  @15,0                                               0963 02770000
         L     @06,SCPCHAR(,@06)                                   0963 02771000
         EX    @15,@SM02291                                        0963 02772000
*   MSGPARTS='';                    /* CLEAR MSG PART                */ 02773000
         MVI   MSGPARTS,C' '                                       0964 02774000
         MVC   MSGPARTS+1(131),MSGPARTS                            0964 02775000
*   MSGPART1(1:LENGTH(TXTDIST))=TXTDIST;/* SET TYPE                  */ 02776000
         MVC   MSGPART1(8),@CC01539                                0965 02777000
*   MSGPART3(1:LENGTH(IOPDLIB))=IOPDLIB;/* SAVE OLD VALUE            */ 02778000
         MVC   MSGPART3(8),IOPDLIB(IOPPTR)                         0966 02779000
*   IF REP=ON                       /*                               */ 02780000
*     THEN                          /*                               */ 02781000
         TM    REP,B'10000000'                                     0967 02782000
         BNO   @RF00967                                            0967 02783000
*     DO;                           /*                               */ 02784000
*       IF IOPDLIB=BLANK8&TOTAL=OFF /*                               */ 02785000
*         THEN                      /*                               */ 02786000
         CLC   IOPDLIB(8,IOPPTR),BLANK8                            0969 02787000
         BNE   @RF00969                                            0969 02788000
         TM    TOTAL,B'00010000'                                   0969 02789000
         BNZ   @RF00969                                            0969 02790000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 02791000
         BAL   @14,UCL358I                                         0970 02792000
*       IOPDLIB=SAVDATA(1:LENGTH(IOPDLIB));/* REP OLD DATA           */ 02793000
@RF00969 MVC   IOPDLIB(8,IOPPTR),SAVDATA                           0971 02794000
*     END;                          /*                               */ 02795000
*   ELSE                            /*                               */ 02796000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 02797000
*       THEN                        /*                               */ 02798000
         B     @RC00967                                            0973 02799000
@RF00967 TM    ADD,B'00100000'                                     0973 02800000
         BNO   @RF00973                                            0973 02801000
*       DO;                         /*                               */ 02802000
*         IF IOPDLIB=BLANK8         /* IF NO DATA THERE              */ 02803000
*           THEN                    /*                               */ 02804000
         CLC   IOPDLIB(8,IOPPTR),BLANK8                            0975 02805000
         BNE   @RF00975                                            0975 02806000
*           IOPDLIB=SAVDATA(1:LENGTH(IOPDLIB));/* ADD NEW DATA       */ 02807000
         MVC   IOPDLIB(8,IOPPTR),SAVDATA                           0976 02808000
*         ELSE                      /*                               */ 02809000
*           CALL UCL356I;           /* ALREADY THERE MSG             */ 02810000
         B     @RC00975                                            0977 02811000
@RF00975 BAL   @14,UCL356I                                         0977 02812000
*       END;                        /*                               */ 02813000
*     ELSE                          /* MUST BE DELETE                */ 02814000
*       DO;                         /*                               */ 02815000
         B     @RC00973                                            0979 02816000
@RF00973 DS    0H                                                  0980 02817000
*         IF IOPDLIB=SAVDATA(1:LENGTH(IOPDLIB))/* IF EQUAL           */ 02818000
*           THEN                    /*                               */ 02819000
         CLC   IOPDLIB(8,IOPPTR),SAVDATA                           0980 02820000
         BNE   @RF00980                                            0980 02821000
*           DO;                     /*                               */ 02822000
*RMODDLBD:                          /*                               */ 02823000
*             ENTRY;                /*                               */ 02824000
         B     @EC00982                                            0982 02825000
RMODDLBD STM   @14,@12,@SA00006                                    0982 02826000
@EC00982 DS    0H                                                  0983 02827000
*             IOPDLIB=BLANK8;       /* DELETE IT                     */ 02828000
         MVC   IOPDLIB(8,IOPPTR),BLANK8                            0983 02829000
*           END;                    /*                               */ 02830000
*         ELSE                      /*                               */ 02831000
*           IF IOPDLIB=BLANK8       /* IF NO DLIB PRESENT            */ 02832000
*             THEN                  /*                               */ 02833000
         B     @RC00980                                            0985 02834000
@RF00980 CLC   IOPDLIB(8,IOPPTR),BLANK8                            0985 02835000
         BNE   @RF00985                                            0985 02836000
*             CALL UCL357I;         /* DATA NOT PRESENT              */ 02837000
         BAL   @14,UCL357I                                         0986 02838000
*           ELSE                    /*                               */ 02839000
*             CALL UCL261I;         /* DATA DOES NOT MATCH           */ 02840000
         B     @RC00985                                            0987 02841000
@RF00985 BAL   @14,UCL261I                                         0987 02842000
*       END;                        /*                               */ 02843000
*   RETURN;                         /*                               */ 02844000
         B     @EL00006                                            0989 02845000
*                                                                  0990 02846000
*   /*****************************************************************/ 02847000
*   /*                                                               */ 02848000
*   /* ROUT TO PROCESS FMID KEYWORD                                  */ 02849000
*   /*                                                               */ 02850000
*   /*****************************************************************/ 02851000
*                                                                  0990 02852000
*RMODFMDV:                          /*                               */ 02853000
*RMACFMDV:                          /*                               */ 02854000
*   ENTRY;                          /*                               */ 02855000
RMODFMDV DS    0H                                                  0990 02856000
RMACFMDV STM   @14,@12,@SA00006                                    0990 02857000
*   SAVDATA(1:LENGTH(IOPFMID))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA      */ 02858000
         MVI   SAVDATA+1,C' '                                      0991 02859000
         MVC   SAVDATA+2(5),SAVDATA+1                              0991 02860000
         L     @06,SCPPTR                                          0991 02861000
         LH    @15,SCPPMLN(,@06)                                   0991 02862000
         BCTR  @15,0                                               0991 02863000
         L     @06,SCPCHAR(,@06)                                   0991 02864000
         EX    @15,@SM02291                                        0991 02865000
*   MSGPARTS='';                    /* CLEAR MSG PART                */ 02866000
         MVI   MSGPARTS,C' '                                       0992 02867000
         MVC   MSGPARTS+1(131),MSGPARTS                            0992 02868000
*   MSGPART1(1:LENGTH(TXTFMID))=TXTFMID;/* SET TYPE                  */ 02869000
         MVC   MSGPART1(8),@CC01545                                0993 02870000
*   MSGPART3(1:LENGTH(IOPFMID))=IOPFMID;/* SAVE OLD VALUE            */ 02871000
         MVC   MSGPART3(7),IOPFMID(IOPPTR)                         0994 02872000
*   IF REP=ON                       /*                               */ 02873000
*     THEN                          /*                               */ 02874000
         TM    REP,B'10000000'                                     0995 02875000
         BNO   @RF00995                                            0995 02876000
*     DO;                           /*                               */ 02877000
*       IF IOPFMID=BLANK7&TOTAL=OFF /*                               */ 02878000
*         THEN                      /*                               */ 02879000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          0997 02880000
         BNE   @RF00997                                            0997 02881000
         TM    TOTAL,B'00010000'                                   0997 02882000
         BNZ   @RF00997                                            0997 02883000
*         CALL UCL358I;             /*                               */ 02884000
         BAL   @14,UCL358I                                         0998 02885000
*       IOPFMID=SAVDATA(1:LENGTH(IOPFMID));/* REP OLD DATA           */ 02886000
@RF00997 MVC   IOPFMID(7,IOPPTR),SAVDATA                           0999 02887000
*       IOPFMST=''B;                /* ZERO STATUS                   */ 02888000
         MVI   IOPFMST(IOPPTR),X'00'                               1000 02889000
*     END;                          /*                               */ 02890000
*   ELSE                            /*                               */ 02891000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 02892000
*       THEN                        /*                               */ 02893000
         B     @RC00995                                            1002 02894000
@RF00995 TM    ADD,B'00100000'                                     1002 02895000
         BNO   @RF01002                                            1002 02896000
*       DO;                         /*                               */ 02897000
*         IF IOPFMID=BLANK7         /* IF NO DATA THERE              */ 02898000
*           THEN                    /*                               */ 02899000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          1004 02900000
         BNE   @RF01004                                            1004 02901000
*           IOPFMID=SAVDATA(1:LENGTH(IOPFMID));/* ADD NEW DATA       */ 02902000
         MVC   IOPFMID(7,IOPPTR),SAVDATA                           1005 02903000
*         ELSE                      /*                               */ 02904000
*           CALL UCL356I;           /* ALREADY THERE MSG             */ 02905000
         B     @RC01004                                            1006 02906000
@RF01004 BAL   @14,UCL356I                                         1006 02907000
*       END;                        /*                               */ 02908000
*     ELSE                          /* MUST BE DELETE                */ 02909000
*       DO;                         /*                               */ 02910000
         B     @RC01002                                            1008 02911000
@RF01002 DS    0H                                                  1009 02912000
*         IF IOPFMID=SAVDATA(1:LENGTH(IOPFMID))/* IF EQUAL           */ 02913000
*           THEN                    /*                               */ 02914000
         CLC   IOPFMID(7,IOPPTR),SAVDATA                           1009 02915000
         BNE   @RF01009                                            1009 02916000
*           DO;                     /*                               */ 02917000
*RMODFMDD:                          /*                               */ 02918000
*RMACFMDD:                          /*                               */ 02919000
*             ENTRY;                /*                               */ 02920000
         B     @EC01011                                            1011 02921000
RMODFMDD DS    0H                                                  1011 02922000
RMACFMDD STM   @14,@12,@SA00006                                    1011 02923000
@EC01011 DS    0H                                                  1012 02924000
*             IOPFMID=BLANK7;       /* DELETE IT                     */ 02925000
         MVC   IOPFMID(7,IOPPTR),@CC01416                          1012 02926000
*             IOPFMST=''B;          /* ZERO STATUS BITS              */ 02927000
         MVI   IOPFMST(IOPPTR),X'00'                               1013 02928000
*           END;                    /*                               */ 02929000
*         ELSE                      /*                               */ 02930000
*           IF IOPFMID=BLANK7       /* IF NO FMID PRESENT            */ 02931000
*             THEN                  /*                               */ 02932000
         B     @RC01009                                            1015 02933000
@RF01009 CLC   IOPFMID(7,IOPPTR),@CC01416                          1015 02934000
         BNE   @RF01015                                            1015 02935000
*             CALL UCL357I;         /* DATA NOT PRESENT              */ 02936000
         BAL   @14,UCL357I                                         1016 02937000
*           ELSE                    /*                               */ 02938000
*             CALL UCL261I;         /* DATA DOES NOT MATCH           */ 02939000
         B     @RC01015                                            1017 02940000
@RF01015 BAL   @14,UCL261I                                         1017 02941000
*       END;                        /*                               */ 02942000
*   RETURN;                         /*                               */ 02943000
         B     @EL00006                                            1019 02944000
*                                                                  1020 02945000
*   /*****************************************************************/ 02946000
*   /*                                                               */ 02947000
*   /* ROUT TO HANDLE MOD SUBENTRIES                                 */ 02948000
*   /*                                                               */ 02949000
*   /*****************************************************************/ 02950000
*                                                                  1020 02951000
*RMODUMID:                          /*                               */ 02952000
*   ENTRY;                          /*                               */ 02953000
RMODUMID STM   @14,@12,@SA00006                                    1020 02954000
*   MSGPARTS='';                    /*                               */ 02955000
         MVI   MSGPARTS,C' '                                       1021 02956000
         MVC   MSGPARTS+1(131),MSGPARTS                            1021 02957000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 02958000
         L     @06,SCPPTR                                          1022 02959000
         LH    @15,SCPPMLN(,@06)                                   1022 02960000
         BCTR  @15,0                                               1022 02961000
         L     @06,SCPCHAR(,@06)                                   1022 02962000
         EX    @15,@SM02281                                        1022 02963000
*   VLPTYPE=IOPUMID;                /*                               */ 02964000
         MVI   VLPTYPE,X'32'                                       1023 02965000
*   GO TO MODADDLP;                 /*                               */ 02966000
         B     MODADDLP                                            1024 02967000
*RMODLMOD:                          /*                               */ 02968000
*   ENTRY;                          /*                               */ 02969000
RMODLMOD STM   @14,@12,@SA00006                                    1025 02970000
*   MSGPARTS='';                    /*                               */ 02971000
         MVI   MSGPARTS,C' '                                       1026 02972000
         MVC   MSGPARTS+1(131),MSGPARTS                            1026 02973000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 02974000
         L     @06,SCPPTR                                          1027 02975000
         LH    @15,SCPPMLN(,@06)                                   1027 02976000
         BCTR  @15,0                                               1027 02977000
         L     @06,SCPCHAR(,@06)                                   1027 02978000
         EX    @15,@SM02281                                        1027 02979000
*   VLPTYPE=IOPMDLMD;               /*                               */ 02980000
         MVI   VLPTYPE,X'01'                                       1028 02981000
*   GO TO MODADDLP;                 /*                               */ 02982000
         B     MODADDLP                                            1029 02983000
*RMODTAL:                           /*                               */ 02984000
*   ENTRY;                          /*                               */ 02985000
RMODTAL  STM   @14,@12,@SA00006                                    1030 02986000
*   MSGPARTS='';                    /*                               */ 02987000
         MVI   MSGPARTS,C' '                                       1031 02988000
         MVC   MSGPARTS+1(131),MSGPARTS                            1031 02989000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 02990000
         L     @06,SCPPTR                                          1032 02991000
         LH    @15,SCPPMLN(,@06)                                   1032 02992000
         BCTR  @15,0                                               1032 02993000
         L     @06,SCPCHAR(,@06)                                   1032 02994000
         EX    @15,@SM02281                                        1032 02995000
*   VLPTYPE=IOPMDTAL;               /*                               */ 02996000
         MVI   VLPTYPE,X'02'                                       1033 02997000
*   GO TO MODADDLP;                 /*                               */ 02998000
         B     MODADDLP                                            1034 02999000
*RMODDAL:                           /*                               */ 03000000
*   ENTRY;                          /*                               */ 03001000
RMODDAL  STM   @14,@12,@SA00006                                    1035 03002000
*   MSGPARTS='';                    /*                               */ 03003000
         MVI   MSGPARTS,C' '                                       1036 03004000
         MVC   MSGPARTS+1(131),MSGPARTS                            1036 03005000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION NAME      */ 03006000
         L     @06,SCPPTR                                          1037 03007000
         LH    @15,SCPPMLN(,@06)                                   1037 03008000
         BCTR  @15,0                                               1037 03009000
         L     @06,SCPCHAR(,@06)                                   1037 03010000
         EX    @15,@SM02281                                        1037 03011000
*   VLPTYPE=IOPMDDAL;               /*                               */ 03012000
         MVI   VLPTYPE,X'03'                                       1038 03013000
*   GO TO MODADDLP;                 /*                               */ 03014000
         B     MODADDLP                                            1039 03015000
*MODADDLP:                          /*                               */ 03016000
*   VLPLPTR=ADDR(IOPMNTRY(1));      /* START OF LIST                 */ 03017000
MODADDLP LA    @06,IOPMNTRY(,IOPPTR)                               1040 03018000
         ST    @06,VLPLPTR                                         1040 03019000
*   VLPDLEN=LENGTH(IOPLMODS(1));    /* LENGTH OF ENTRY               */ 03020000
         MVI   VLPDLEN,X'08'                                       1041 03021000
*   RETURN;                         /*                               */ 03022000
         B     @EL00006                                            1042 03023000
*   END RMODXXX;                    /*                               */ 03024000
         B     @EL00006                                            1043 03025000
         EJECT                                                          03026000
*                                                                  1044 03027000
*   /*****************************************************************/ 03028000
*   /*                                                               */ 03029000
*   /* ROUTINES TO HANDLE LMOD OPTIONS                               */ 03030000
*   /*                                                               */ 03031000
*   /*****************************************************************/ 03032000
*                                                                  1044 03033000
*RLMDXXX:                           /*                               */ 03034000
*   PROCEDURE;                      /*                               */ 03035000
*                                                                  1044 03036000
RLMDXXX  STM   @14,@12,@SA00007                                    1044 03037000
*   /*****************************************************************/ 03038000
*   /*                                                               */ 03039000
*   /* LOAD MODULE RE-ENTRANT LKED ATTRIBUTE SCAN EXIT - RECORDS THE */ 03040000
*   /* RENT ATTRIBUTE IN THE IOP OR DELETES THE ATTRIBUTE IF A       */ 03041000
*   /* CHANGE/DELETE OPERATION                               @Z63SP00*/ 03042000
*   /*                                                               */ 03043000
*   /*****************************************************************/ 03044000
*                                                                  1045 03045000
*RLMDRENT:                                                         1045 03046000
*   ENTRY;                          /*                               */ 03047000
         B     @EC01045                                            1045 03048000
RLMDRENT STM   @14,@12,@SA00007                                    1045 03049000
@EC01045 DS    0H                                                  1046 03050000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03051000
         MVI   MSGPARTS,C' '                                       1046 03052000
         MVC   MSGPARTS+1(131),MSGPARTS                            1046 03053000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03054000
         L     @06,SCPPTR                                          1047 03055000
         LH    @15,SCPPMLN(,@06)                                   1047 03056000
         BCTR  @15,0                                               1047 03057000
         L     @06,SCPCHAR(,@06)                                   1047 03058000
         EX    @15,@SM02281                                        1047 03059000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03060000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03061000
         TM    DEL,B'01000000'                                     1048 03062000
         BNO   @RF01048                                            1048 03063000
*     DO;                           /*                               */ 03064000
*       IF IOPRENT=ON               /* IF OPTION PRESENT             */ 03065000
*         THEN                      /*                               */ 03066000
         TM    IOPRENT(IOPPTR),B'01000000'                         1050 03067000
         BNO   @RF01050                                            1050 03068000
*         IOPRENT=OFF;              /* DELETE IT                     */ 03069000
         NI    IOPRENT(IOPPTR),B'10111111'                         1051 03070000
*       ELSE                        /*                               */ 03071000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03072000
         B     @RC01050                                            1052 03073000
@RF01050 BAL   @14,UCL357I                                         1052 03074000
*     END;                          /* END DELETE REQUEST            */ 03075000
*   ELSE                            /* IF NOT DELETE                 */ 03076000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03077000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03078000
         B     @RC01048                                            1054 03079000
@RF01048 TM    ADD,B'00100000'                                     1054 03080000
         BNO   @RF01054                                            1054 03081000
*       DO;                         /*                               */ 03082000
*         IF IOPRENT=OFF            /* IF NOT PRESENT                */ 03083000
*           THEN                    /*                               */ 03084000
         TM    IOPRENT(IOPPTR),B'01000000'                         1056 03085000
         BNZ   @RF01056                                            1056 03086000
*           IOPRENT=ON;             /* ADD IT                        */ 03087000
         OI    IOPRENT(IOPPTR),B'01000000'                         1057 03088000
*         ELSE                      /*                               */ 03089000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03090000
         B     @RC01056                                            1058 03091000
@RF01056 BAL   @14,UCL356I                                         1058 03092000
*       END;                        /* END ADD                       */ 03093000
*     ELSE                          /* MUST BE REPLACE SO            */ 03094000
*       IOPRENT=ON;                 /* ALWAYS ADD OPTION             */ 03095000
         B     @RC01054                                            1060 03096000
@RF01054 OI    IOPRENT(IOPPTR),B'01000000'                         1060 03097000
*   RETURN;                         /* RETURN TO SCAN                */ 03098000
@EL00007 DS    0H                                                  1061 03099000
@EF00007 DS    0H                                                  1061 03100000
@ER00007 LM    @14,@12,@SA00007                                    1061 03101000
         BR    @14                                                 1061 03102000
*                                                                  1062 03103000
*   /*****************************************************************/ 03104000
*   /*                                                               */ 03105000
*   /* LOAD MODULE TYPE REUSABLE LKED ATTRIBUTE SCAN EXIT - RECORDS  */ 03106000
*   /* THE REUS ATTRIBUTE IN THE IOP OR DELETES THE ATTRIBUTE IF A   */ 03107000
*   /* CHANGE/DELETE OPERATION                               @Z63SP00*/ 03108000
*   /*                                                               */ 03109000
*   /*****************************************************************/ 03110000
*                                                                  1062 03111000
*RLMDREUS:                                                         1062 03112000
*   ENTRY;                          /*                               */ 03113000
RLMDREUS STM   @14,@12,@SA00007                                    1062 03114000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03115000
         MVI   MSGPARTS,C' '                                       1063 03116000
         MVC   MSGPARTS+1(131),MSGPARTS                            1063 03117000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03118000
         L     @06,SCPPTR                                          1064 03119000
         LH    @15,SCPPMLN(,@06)                                   1064 03120000
         BCTR  @15,0                                               1064 03121000
         L     @06,SCPCHAR(,@06)                                   1064 03122000
         EX    @15,@SM02281                                        1064 03123000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03124000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03125000
         TM    DEL,B'01000000'                                     1065 03126000
         BNO   @RF01065                                            1065 03127000
*     DO;                           /*                               */ 03128000
*       IF IOPREUS=ON               /* IF OPTION PRESENT             */ 03129000
*         THEN                      /*                               */ 03130000
         TM    IOPREUS(IOPPTR),B'00100000'                         1067 03131000
         BNO   @RF01067                                            1067 03132000
*         IOPREUS=OFF;              /* DELETE IT                     */ 03133000
         NI    IOPREUS(IOPPTR),B'11011111'                         1068 03134000
*       ELSE                        /*                               */ 03135000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03136000
         B     @RC01067                                            1069 03137000
@RF01067 BAL   @14,UCL357I                                         1069 03138000
*     END;                          /* END DELETE REQUEST            */ 03139000
*   ELSE                            /* IF NOT DELETE                 */ 03140000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03141000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03142000
         B     @RC01065                                            1071 03143000
@RF01065 TM    ADD,B'00100000'                                     1071 03144000
         BNO   @RF01071                                            1071 03145000
*       DO;                         /*                               */ 03146000
*         IF IOPREUS=OFF            /* IF NOT PRESENT                */ 03147000
*           THEN                    /*                               */ 03148000
         TM    IOPREUS(IOPPTR),B'00100000'                         1073 03149000
         BNZ   @RF01073                                            1073 03150000
*           IOPREUS=ON;             /* ADD IT                        */ 03151000
         OI    IOPREUS(IOPPTR),B'00100000'                         1074 03152000
*         ELSE                      /*                               */ 03153000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03154000
         B     @RC01073                                            1075 03155000
@RF01073 BAL   @14,UCL356I                                         1075 03156000
*       END;                        /* END ADD                       */ 03157000
*     ELSE                          /* MUST BE REPLACE SO            */ 03158000
*       IOPREUS=ON;                 /* ALWAYS ADD OPTION             */ 03159000
         B     @RC01071                                            1077 03160000
@RF01071 OI    IOPREUS(IOPPTR),B'00100000'                         1077 03161000
*   RETURN;                         /* RETURN TO SCAN                */ 03162000
         B     @EL00007                                            1078 03163000
*                                                                  1079 03164000
*   /*****************************************************************/ 03165000
*   /*                                                               */ 03166000
*   /* LOAD MODULE TYPE SCATTER-LOAD LKED ATTRIBUTE SCAN EXIT -      */ 03167000
*   /* RECORDS THE SCTR ATTRIBUTE IN THE IOP OR DELETES THE ATTRIBUTE*/ 03168000
*   /* IF A CHANGE/DELETE OPERATION                          @Z63SP00*/ 03169000
*   /*                                                               */ 03170000
*   /*****************************************************************/ 03171000
*                                                                  1079 03172000
*RLMDSCTR:                                                         1079 03173000
*   ENTRY;                          /*                               */ 03174000
RLMDSCTR STM   @14,@12,@SA00007                                    1079 03175000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03176000
         MVI   MSGPARTS,C' '                                       1080 03177000
         MVC   MSGPARTS+1(131),MSGPARTS                            1080 03178000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03179000
         L     @06,SCPPTR                                          1081 03180000
         LH    @15,SCPPMLN(,@06)                                   1081 03181000
         BCTR  @15,0                                               1081 03182000
         L     @06,SCPCHAR(,@06)                                   1081 03183000
         EX    @15,@SM02281                                        1081 03184000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03185000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03186000
         TM    DEL,B'01000000'                                     1082 03187000
         BNO   @RF01082                                            1082 03188000
*     DO;                           /*                               */ 03189000
*       IF IOPSCTR=ON               /* IF OPTION PRESENT             */ 03190000
*         THEN                      /*                               */ 03191000
         TM    IOPSCTR(IOPPTR),B'00010000'                         1084 03192000
         BNO   @RF01084                                            1084 03193000
*         IOPSCTR=OFF;              /* DELETE IT                     */ 03194000
         NI    IOPSCTR(IOPPTR),B'11101111'                         1085 03195000
*       ELSE                        /*                               */ 03196000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03197000
         B     @RC01084                                            1086 03198000
@RF01084 BAL   @14,UCL357I                                         1086 03199000
*     END;                          /* END DELETE REQUEST            */ 03200000
*   ELSE                            /* IF NOT DELETE                 */ 03201000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03202000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03203000
         B     @RC01082                                            1088 03204000
@RF01082 TM    ADD,B'00100000'                                     1088 03205000
         BNO   @RF01088                                            1088 03206000
*       DO;                         /*                               */ 03207000
*         IF IOPSCTR=OFF            /* IF NOT PRESENT                */ 03208000
*           THEN                    /*                               */ 03209000
         TM    IOPSCTR(IOPPTR),B'00010000'                         1090 03210000
         BNZ   @RF01090                                            1090 03211000
*           IOPSCTR=ON;             /* ADD IT                        */ 03212000
         OI    IOPSCTR(IOPPTR),B'00010000'                         1091 03213000
*         ELSE                      /*                               */ 03214000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03215000
         B     @RC01090                                            1092 03216000
@RF01090 BAL   @14,UCL356I                                         1092 03217000
*       END;                        /* END ADD                       */ 03218000
*     ELSE                          /* MUST BE REPLACE SO            */ 03219000
*       IOPSCTR=ON;                 /* ALWAYS ADD OPTION             */ 03220000
         B     @RC01088                                            1094 03221000
@RF01088 OI    IOPSCTR(IOPPTR),B'00010000'                         1094 03222000
*   RETURN;                         /* RETURN TO SCAN                */ 03223000
         B     @EL00007                                            1095 03224000
*                                                                  1096 03225000
*   /*****************************************************************/ 03226000
*   /*                                                               */ 03227000
*   /* LOAD MODULE TYPE OVERLAY LKED ATTRIBUTE SCAN EXIT - RECORDS   */ 03228000
*   /* THE OVLY ATTRIBUTE IN THE IOP OR DELETES THE ATTRIBUTE IF A   */ 03229000
*   /* CHANGE/DELETE OPERATION                               @Z63SP00*/ 03230000
*   /*                                                               */ 03231000
*   /*****************************************************************/ 03232000
*                                                                  1096 03233000
*RLMDOVLY:                                                         1096 03234000
*   ENTRY;                          /*                               */ 03235000
RLMDOVLY STM   @14,@12,@SA00007                                    1096 03236000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03237000
         MVI   MSGPARTS,C' '                                       1097 03238000
         MVC   MSGPARTS+1(131),MSGPARTS                            1097 03239000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03240000
         L     @06,SCPPTR                                          1098 03241000
         LH    @15,SCPPMLN(,@06)                                   1098 03242000
         BCTR  @15,0                                               1098 03243000
         L     @06,SCPCHAR(,@06)                                   1098 03244000
         EX    @15,@SM02281                                        1098 03245000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03246000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03247000
         TM    DEL,B'01000000'                                     1099 03248000
         BNO   @RF01099                                            1099 03249000
*     DO;                           /*                               */ 03250000
*       IF IOPOVLY=ON               /* IF OPTION PRESENT             */ 03251000
*         THEN                      /*                               */ 03252000
         TM    IOPOVLY(IOPPTR),B'00001000'                         1101 03253000
         BNO   @RF01101                                            1101 03254000
*         IOPOVLY=OFF;              /* DELETE IT                     */ 03255000
         NI    IOPOVLY(IOPPTR),B'11110111'                         1102 03256000
*       ELSE                        /*                               */ 03257000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03258000
         B     @RC01101                                            1103 03259000
@RF01101 BAL   @14,UCL357I                                         1103 03260000
*     END;                          /* END DELETE REQUEST            */ 03261000
*   ELSE                            /* IF NOT DELETE                 */ 03262000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03263000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03264000
         B     @RC01099                                            1105 03265000
@RF01099 TM    ADD,B'00100000'                                     1105 03266000
         BNO   @RF01105                                            1105 03267000
*       DO;                         /*                               */ 03268000
*         IF IOPOVLY=OFF            /* IF NOT PRESENT                */ 03269000
*           THEN                    /*                               */ 03270000
         TM    IOPOVLY(IOPPTR),B'00001000'                         1107 03271000
         BNZ   @RF01107                                            1107 03272000
*           IOPOVLY=ON;             /* ADD IT                        */ 03273000
         OI    IOPOVLY(IOPPTR),B'00001000'                         1108 03274000
*         ELSE                      /*                               */ 03275000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03276000
         B     @RC01107                                            1109 03277000
@RF01107 BAL   @14,UCL356I                                         1109 03278000
*       END;                        /* END ADD                       */ 03279000
*     ELSE                          /* MUST BE REPLACE SO            */ 03280000
*       IOPOVLY=ON;                 /* ALWAYS ADD OPTION             */ 03281000
         B     @RC01105                                            1111 03282000
@RF01105 OI    IOPOVLY(IOPPTR),B'00001000'                         1111 03283000
*   RETURN;                         /* RETURN TO SCAN                */ 03284000
         B     @EL00007                                            1112 03285000
*                                                                  1113 03286000
*   /*****************************************************************/ 03287000
*   /*                                                               */ 03288000
*   /* LOAD MODULE TYPE REFRESHABLE LKED ATTRIBUTE SCAN EXIT -       */ 03289000
*   /* RECORDS THE ATTRIBUTE IN THE THE IOP OR DELETES THE ATTRIBUTE */ 03290000
*   /* IF A CHANGE/DELETE OPERATION                          @Z63SP00*/ 03291000
*   /*                                                               */ 03292000
*   /*****************************************************************/ 03293000
*                                                                  1113 03294000
*RLMDREFR:                                                         1113 03295000
*   ENTRY;                          /*                               */ 03296000
RLMDREFR STM   @14,@12,@SA00007                                    1113 03297000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03298000
         MVI   MSGPARTS,C' '                                       1114 03299000
         MVC   MSGPARTS+1(131),MSGPARTS                            1114 03300000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03301000
         L     @06,SCPPTR                                          1115 03302000
         LH    @15,SCPPMLN(,@06)                                   1115 03303000
         BCTR  @15,0                                               1115 03304000
         L     @06,SCPCHAR(,@06)                                   1115 03305000
         EX    @15,@SM02281                                        1115 03306000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03307000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03308000
         TM    DEL,B'01000000'                                     1116 03309000
         BNO   @RF01116                                            1116 03310000
*     DO;                           /*                               */ 03311000
*       IF IOPREFR=ON               /* IF OPTION PRESENT             */ 03312000
*         THEN                      /*                               */ 03313000
         TM    IOPREFR(IOPPTR),B'00000100'                         1118 03314000
         BNO   @RF01118                                            1118 03315000
*         IOPREFR=OFF;              /* DELETE IT                     */ 03316000
         NI    IOPREFR(IOPPTR),B'11111011'                         1119 03317000
*       ELSE                        /*                               */ 03318000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03319000
         B     @RC01118                                            1120 03320000
@RF01118 BAL   @14,UCL357I                                         1120 03321000
*     END;                          /* END DELETE REQUEST            */ 03322000
*   ELSE                            /* IF NOT DELETE                 */ 03323000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03324000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03325000
         B     @RC01116                                            1122 03326000
@RF01116 TM    ADD,B'00100000'                                     1122 03327000
         BNO   @RF01122                                            1122 03328000
*       DO;                         /*                               */ 03329000
*         IF IOPREFR=OFF            /* IF NOT PRESENT                */ 03330000
*           THEN                    /*                               */ 03331000
         TM    IOPREFR(IOPPTR),B'00000100'                         1124 03332000
         BNZ   @RF01124                                            1124 03333000
*           IOPREFR=ON;             /* ADD IT                        */ 03334000
         OI    IOPREFR(IOPPTR),B'00000100'                         1125 03335000
*         ELSE                      /*                               */ 03336000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03337000
         B     @RC01124                                            1126 03338000
@RF01124 BAL   @14,UCL356I                                         1126 03339000
*       END;                        /* END ADD                       */ 03340000
*     ELSE                          /* MUST BE REPLACE SO            */ 03341000
*       IOPREFR=ON;                 /* ALWAYS ADD OPTION             */ 03342000
         B     @RC01122                                            1128 03343000
@RF01122 OI    IOPREFR(IOPPTR),B'00000100'                         1128 03344000
*   RETURN;                         /* RETURN TO SCAN                */ 03345000
         B     @EL00007                                            1129 03346000
*                                                                  1130 03347000
*   /*****************************************************************/ 03348000
*   /*                                                               */ 03349000
*   /* LOAD MODULE TYPE DOWNWARD-COMPATIBLE LKED ATTRIBUTE SCAN EXIT */ 03350000
*   /* - RECORDS THE ATTRIBUTE IN THE IOP OR DELETE THE ATTRIBUTE IF */ 03351000
*   /* A CHANGE/DELETE OP                                    @Z63SP00*/ 03352000
*   /*                                                               */ 03353000
*   /*****************************************************************/ 03354000
*                                                                  1130 03355000
*RLMDDC:                                                           1130 03356000
*   ENTRY;                          /*                               */ 03357000
RLMDDC   STM   @14,@12,@SA00007                                    1130 03358000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03359000
         MVI   MSGPARTS,C' '                                       1131 03360000
         MVC   MSGPARTS+1(131),MSGPARTS                            1131 03361000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03362000
         L     @06,SCPPTR                                          1132 03363000
         LH    @15,SCPPMLN(,@06)                                   1132 03364000
         BCTR  @15,0                                               1132 03365000
         L     @06,SCPCHAR(,@06)                                   1132 03366000
         EX    @15,@SM02281                                        1132 03367000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03368000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03369000
         TM    DEL,B'01000000'                                     1133 03370000
         BNO   @RF01133                                            1133 03371000
*     DO;                           /*                               */ 03372000
*       IF IOPDC=ON                 /* IF OPTION PRESENT             */ 03373000
*         THEN                      /*                               */ 03374000
         TM    IOPDC(IOPPTR),B'00000010'                           1135 03375000
         BNO   @RF01135                                            1135 03376000
*         IOPDC=OFF;                /* DELETE IT                     */ 03377000
         NI    IOPDC(IOPPTR),B'11111101'                           1136 03378000
*       ELSE                        /*                               */ 03379000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03380000
         B     @RC01135                                            1137 03381000
@RF01135 BAL   @14,UCL357I                                         1137 03382000
*     END;                          /* END DELETE REQUEST            */ 03383000
*   ELSE                            /* IF NOT DELETE                 */ 03384000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03385000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03386000
         B     @RC01133                                            1139 03387000
@RF01133 TM    ADD,B'00100000'                                     1139 03388000
         BNO   @RF01139                                            1139 03389000
*       DO;                         /*                               */ 03390000
*         IF IOPDC=OFF              /* IF NOT PRESENT                */ 03391000
*           THEN                    /*                               */ 03392000
         TM    IOPDC(IOPPTR),B'00000010'                           1141 03393000
         BNZ   @RF01141                                            1141 03394000
*           IOPDC=ON;               /* ADD IT                        */ 03395000
         OI    IOPDC(IOPPTR),B'00000010'                           1142 03396000
*         ELSE                      /*                               */ 03397000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03398000
         B     @RC01141                                            1143 03399000
@RF01141 BAL   @14,UCL356I                                         1143 03400000
*       END;                        /* END ADD                       */ 03401000
*     ELSE                          /* MUST BE REPLACE SO            */ 03402000
*       IOPDC=ON;                   /* ALWAYS ADD OPTION             */ 03403000
         B     @RC01139                                            1145 03404000
@RF01139 OI    IOPDC(IOPPTR),B'00000010'                           1145 03405000
*   RETURN;                         /* RETURN TO SCAN                */ 03406000
         B     @EL00007                                            1146 03407000
*                                                                  1147 03408000
*   /*****************************************************************/ 03409000
*   /*                                                               */ 03410000
*   /* LOAD MODULE TYPE NOT-EDITABLE LKED ATTRIBUTE SCAN EXIT -      */ 03411000
*   /* RECORDS THE ATTRIBUTE IN THE IOP OR DELETES THE ATTRIBUTE IF A*/ 03412000
*   /* CHANGE/DELETE OPERATION                               @Z63SP00*/ 03413000
*   /*                                                               */ 03414000
*   /*****************************************************************/ 03415000
*                                                                  1147 03416000
*RLMDNE:                                                           1147 03417000
*   ENTRY;                          /*                               */ 03418000
RLMDNE   STM   @14,@12,@SA00007                                    1147 03419000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03420000
         MVI   MSGPARTS,C' '                                       1148 03421000
         MVC   MSGPARTS+1(131),MSGPARTS                            1148 03422000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03423000
         L     @06,SCPPTR                                          1149 03424000
         LH    @15,SCPPMLN(,@06)                                   1149 03425000
         BCTR  @15,0                                               1149 03426000
         L     @06,SCPCHAR(,@06)                                   1149 03427000
         EX    @15,@SM02281                                        1149 03428000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03429000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03430000
         TM    DEL,B'01000000'                                     1150 03431000
         BNO   @RF01150                                            1150 03432000
*     DO;                           /*                               */ 03433000
*       IF IOPNE=ON                 /* IF OPTION PRESENT             */ 03434000
*         THEN                      /*                               */ 03435000
         TM    IOPNE(IOPPTR),B'10000000'                           1152 03436000
         BNO   @RF01152                                            1152 03437000
*         IOPNE=OFF;                /* DELETE IT                     */ 03438000
         NI    IOPNE(IOPPTR),B'01111111'                           1153 03439000
*       ELSE                        /*                               */ 03440000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03441000
         B     @RC01152                                            1154 03442000
@RF01152 BAL   @14,UCL357I                                         1154 03443000
*     END;                          /* END DELETE REQUEST            */ 03444000
*   ELSE                            /* IF NOT DELETE                 */ 03445000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03446000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03447000
         B     @RC01150                                            1156 03448000
@RF01150 TM    ADD,B'00100000'                                     1156 03449000
         BNO   @RF01156                                            1156 03450000
*       DO;                         /*                               */ 03451000
*         IF IOPNE=OFF              /* IF NOT PRESENT                */ 03452000
*           THEN                    /*                               */ 03453000
         TM    IOPNE(IOPPTR),B'10000000'                           1158 03454000
         BNZ   @RF01158                                            1158 03455000
*           IOPNE=ON;               /* ADD IT                        */ 03456000
         OI    IOPNE(IOPPTR),B'10000000'                           1159 03457000
*         ELSE                      /*                               */ 03458000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03459000
         B     @RC01158                                            1160 03460000
@RF01158 BAL   @14,UCL356I                                         1160 03461000
*       END;                        /* END ADD                       */ 03462000
*     ELSE                          /* MUST BE REPLACE SO            */ 03463000
*       IOPNE=ON;                   /* ALWAYS ADD OPTION             */ 03464000
         B     @RC01156                                            1162 03465000
@RF01156 OI    IOPNE(IOPPTR),B'10000000'                           1162 03466000
*   RETURN;                         /* RETURN TO SCAN                */ 03467000
         B     @EL00007                                            1163 03468000
*                                                                  1164 03469000
*   /*****************************************************************/ 03470000
*   /*                                                               */ 03471000
*   /* LOAD MODULE TYPE APF (AC=1) LKED ATTRIBUTE SCAN EXIT RECORDS  */ 03472000
*   /* THE APF ATTRIBUTE IN THE IOP OR DELETES THE ATTRIBUTE IF A    */ 03473000
*   /* CHANGE/ DELETE OPERATION                              @VS08700*/ 03474000
*   /*                                                               */ 03475000
*   /*****************************************************************/ 03476000
*                                                                  1164 03477000
*RLMDAPF:                           /*                       @VS08700*/ 03478000
*   ENTRY;                          /*                               */ 03479000
RLMDAPF  STM   @14,@12,@SA00007                                    1164 03480000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03481000
         MVI   MSGPARTS,C' '                                       1165 03482000
         MVC   MSGPARTS+1(131),MSGPARTS                            1165 03483000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03484000
         L     @06,SCPPTR                                          1166 03485000
         LH    @15,SCPPMLN(,@06)                                   1166 03486000
         BCTR  @15,0                                               1166 03487000
         L     @06,SCPCHAR(,@06)                                   1166 03488000
         EX    @15,@SM02281                                        1166 03489000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03490000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03491000
         TM    DEL,B'01000000'                                     1167 03492000
         BNO   @RF01167                                            1167 03493000
*     DO;                           /*                               */ 03494000
*       IF IOPAPF=ON                /* IF OPTION PRESENT             */ 03495000
*         THEN                      /*                               */ 03496000
         TM    IOPAPF(IOPPTR),B'10000000'                          1169 03497000
         BNO   @RF01169                                            1169 03498000
*         IOPAPF=OFF;               /* DELETE IT                     */ 03499000
         NI    IOPAPF(IOPPTR),B'01111111'                          1170 03500000
*       ELSE                        /*                               */ 03501000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03502000
         B     @RC01169                                            1171 03503000
@RF01169 BAL   @14,UCL357I                                         1171 03504000
*     END;                          /* END DELETE REQUEST            */ 03505000
*   ELSE                            /* IF NOT DELETE                 */ 03506000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03507000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03508000
         B     @RC01167                                            1173 03509000
@RF01167 TM    ADD,B'00100000'                                     1173 03510000
         BNO   @RF01173                                            1173 03511000
*       DO;                         /*                               */ 03512000
*         IF IOPAPF=OFF             /* IF NOT PRESENT                */ 03513000
*           THEN                    /*                               */ 03514000
         TM    IOPAPF(IOPPTR),B'10000000'                          1175 03515000
         BNZ   @RF01175                                            1175 03516000
*           IOPAPF=ON;              /* ADD IT                        */ 03517000
         OI    IOPAPF(IOPPTR),B'10000000'                          1176 03518000
*         ELSE                      /*                               */ 03519000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03520000
         B     @RC01175                                            1177 03521000
@RF01175 BAL   @14,UCL356I                                         1177 03522000
*       END;                        /* END ADD                       */ 03523000
*     ELSE                          /* MUST BE REPLACE SO            */ 03524000
*       IOPAPF=ON;                  /* ALWAYS ADD OPTION             */ 03525000
         B     @RC01173                                            1179 03526000
@RF01173 OI    IOPAPF(IOPPTR),B'10000000'                          1179 03527000
*   RETURN;                         /* RETURN TO SCAN                */ 03528000
         B     @EL00007                                            1180 03529000
*                                                                  1181 03530000
*   /*****************************************************************/ 03531000
*   /*                                                               */ 03532000
*   /* LOAD MODULE TYPE ALIGN2 LKED ATTRIBUTE SCAN EXIT - RECORDS THE*/ 03533000
*   /* ATTRIBUTE IN THE IOP OR DELETES THE ATTRIBUTE IF A CHANGE/    */ 03534000
*   /* DELETE OPERATION.                                     @XA05949*/ 03535000
*   /*                                                               */ 03536000
*   /*****************************************************************/ 03537000
*                                                                  1181 03538000
*RLMDALN2:                                                         1181 03539000
*   ENTRY;                          /*                               */ 03540000
RLMDALN2 STM   @14,@12,@SA00007                                    1181 03541000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03542000
         MVI   MSGPARTS,C' '                                       1182 03543000
         MVC   MSGPARTS+1(131),MSGPARTS                            1182 03544000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03545000
         L     @06,SCPPTR                                          1183 03546000
         LH    @15,SCPPMLN(,@06)                                   1183 03547000
         BCTR  @15,0                                               1183 03548000
         L     @06,SCPCHAR(,@06)                                   1183 03549000
         EX    @15,@SM02281                                        1183 03550000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03551000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03552000
         TM    DEL,B'01000000'                                     1184 03553000
         BNO   @RF01184                                            1184 03554000
*     DO;                           /*                               */ 03555000
*       IF IOPPAGA=ON               /* IF OPTION PRESENT             */ 03556000
*         THEN                      /*                               */ 03557000
         TM    IOPPAGA(IOPPTR),B'01000000'                         1186 03558000
         BNO   @RF01186                                            1186 03559000
*         IOPPAGA=OFF;              /* DELETE IT                     */ 03560000
         NI    IOPPAGA(IOPPTR),B'10111111'                         1187 03561000
*       ELSE                        /*                               */ 03562000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03563000
         B     @RC01186                                            1188 03564000
@RF01186 BAL   @14,UCL357I                                         1188 03565000
*     END;                          /* END DELETE REQUEST            */ 03566000
*   ELSE                            /* IF NOT DELETE                 */ 03567000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03568000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03569000
         B     @RC01184                                            1190 03570000
@RF01184 TM    ADD,B'00100000'                                     1190 03571000
         BNO   @RF01190                                            1190 03572000
*       DO;                         /*                               */ 03573000
*         IF IOPPAGA=OFF            /* IF NOT PRESENT                */ 03574000
*           THEN                    /*                               */ 03575000
         TM    IOPPAGA(IOPPTR),B'01000000'                         1192 03576000
         BNZ   @RF01192                                            1192 03577000
*           IOPPAGA=ON;             /* ADD IT                        */ 03578000
         OI    IOPPAGA(IOPPTR),B'01000000'                         1193 03579000
*         ELSE                      /*                               */ 03580000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03581000
         B     @RC01192                                            1194 03582000
@RF01192 BAL   @14,UCL356I                                         1194 03583000
*       END;                        /* END ADD                       */ 03584000
*     ELSE                          /* MUST BE REPLACE SO            */ 03585000
*       IOPPAGA=ON;                 /* ALWAYS ADD OPTION             */ 03586000
         B     @RC01190                                            1196 03587000
@RF01190 OI    IOPPAGA(IOPPTR),B'01000000'                         1196 03588000
*   RETURN;                         /* RETURN TO SCAN                */ 03589000
         B     @EL00007                                            1197 03590000
*                                                                  1198 03591000
*   /*****************************************************************/ 03592000
*   /*                                                               */ 03593000
*   /* UPDATE LOAD MODULE ENTRY TO SET 'STANDARD' LKED PARMS OR CLEAR*/ 03594000
*   /* STANDARD INDICATOR                                    @Z63SP00*/ 03595000
*   /*                                                               */ 03596000
*   /*****************************************************************/ 03597000
*                                                                  1198 03598000
*RLMDSTD:                                                          1198 03599000
*   ENTRY;                          /*                               */ 03600000
RLMDSTD  STM   @14,@12,@SA00007                                    1198 03601000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03602000
         MVI   MSGPARTS,C' '                                       1199 03603000
         MVC   MSGPARTS+1(131),MSGPARTS                            1199 03604000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03605000
         L     @06,SCPPTR                                          1200 03606000
         LH    @15,SCPPMLN(,@06)                                   1200 03607000
         BCTR  @15,0                                               1200 03608000
         L     @06,SCPCHAR(,@06)                                   1200 03609000
         EX    @15,@SM02281                                        1200 03610000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03611000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03612000
         TM    DEL,B'01000000'                                     1201 03613000
         BNO   @RF01201                                            1201 03614000
*     DO;                           /*                               */ 03615000
*       IF IOPLINK=ON               /* IF OPTION PRESENT             */ 03616000
*         THEN                      /*                               */ 03617000
         TM    IOPLINK(IOPPTR),B'01000000'                         1203 03618000
         BNO   @RF01203                                            1203 03619000
*         IOPLINK=OFF;              /* DELETE IT                     */ 03620000
         NI    IOPLINK(IOPPTR),B'10111111'                         1204 03621000
*       ELSE                        /*                               */ 03622000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03623000
         B     @RC01203                                            1205 03624000
@RF01203 BAL   @14,UCL357I                                         1205 03625000
*     END;                          /* END DELETE REQUEST            */ 03626000
*   ELSE                            /* IF NOT DELETE                 */ 03627000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03628000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03629000
         B     @RC01201                                            1207 03630000
@RF01201 TM    ADD,B'00100000'                                     1207 03631000
         BNO   @RF01207                                            1207 03632000
*       DO;                         /*                               */ 03633000
*         IF IOPLINK=OFF            /* IF NOT PRESENT                */ 03634000
*           THEN                    /*                               */ 03635000
         TM    IOPLINK(IOPPTR),B'01000000'                         1209 03636000
         BNZ   @RF01209                                            1209 03637000
*           IOPLINK=ON;             /* ADD IT                        */ 03638000
         OI    IOPLINK(IOPPTR),B'01000000'                         1210 03639000
*         ELSE                      /*                               */ 03640000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03641000
         B     @RC01209                                            1211 03642000
@RF01209 BAL   @14,UCL356I                                         1211 03643000
*       END;                        /* END ADD                       */ 03644000
*     ELSE                          /* MUST BE REPLACE SO            */ 03645000
*       IOPLINK=ON;                 /* ALWAYS ADD OPTION             */ 03646000
         B     @RC01207                                            1213 03647000
@RF01207 OI    IOPLINK(IOPPTR),B'01000000'                         1213 03648000
*   RETURN;                         /* RETURN TO SCAN                */ 03649000
         B     @EL00007                                            1214 03650000
*                                                                  1215 03651000
*   /*****************************************************************/ 03652000
*   /*                                                               */ 03653000
*   /* LOAD MODULE TYPE 'COPY' STATUS CDS INDICATOR - THIS SCAN EXIT */ 03654000
*   /* RECORDS THE COPY STATUS (MODULE COPIED AT SYS GEN - NOT LINK  */ 03655000
*   /* EDITED) INTO THE IOP OR WILL DELETE THE STATUS IF A   @Z63SP00*/ 03656000
*   /* CHANGE/DELETE OPERATION                               @Z63SP00*/ 03657000
*   /*                                                               */ 03658000
*   /*****************************************************************/ 03659000
*                                                                  1215 03660000
*RLMDCOPY:                                                         1215 03661000
*   ENTRY;                          /*                               */ 03662000
RLMDCOPY STM   @14,@12,@SA00007                                    1215 03663000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03664000
         MVI   MSGPARTS,C' '                                       1216 03665000
         MVC   MSGPARTS+1(131),MSGPARTS                            1216 03666000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 03667000
         L     @06,SCPPTR                                          1217 03668000
         LH    @15,SCPPMLN(,@06)                                   1217 03669000
         BCTR  @15,0                                               1217 03670000
         L     @06,SCPCHAR(,@06)                                   1217 03671000
         EX    @15,@SM02281                                        1217 03672000
*   IF DEL=ON                       /* IF OPTION TO BE DEL           */ 03673000
*     THEN                          /* THEN CHECK PRENSENCE          */ 03674000
         TM    DEL,B'01000000'                                     1218 03675000
         BNO   @RF01218                                            1218 03676000
*     DO;                           /*                               */ 03677000
*       IF IOPCOPY=ON               /* IF OPTION PRESENT             */ 03678000
*         THEN                      /*                               */ 03679000
         TM    IOPCOPY(IOPPTR),B'10000000'                         1220 03680000
         BNO   @RF01220                                            1220 03681000
*         IOPCOPY=OFF;              /* DELETE IT                     */ 03682000
         NI    IOPCOPY(IOPPTR),B'01111111'                         1221 03683000
*       ELSE                        /*                               */ 03684000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 03685000
         B     @RC01220                                            1222 03686000
@RF01220 BAL   @14,UCL357I                                         1222 03687000
*     END;                          /* END DELETE REQUEST            */ 03688000
*   ELSE                            /* IF NOT DELETE                 */ 03689000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 03690000
*       THEN                        /* CHECK TO SEE IF THERE         */ 03691000
         B     @RC01218                                            1224 03692000
@RF01218 TM    ADD,B'00100000'                                     1224 03693000
         BNO   @RF01224                                            1224 03694000
*       DO;                         /*                               */ 03695000
*         IF IOPCOPY=OFF            /* IF NOT PRESENT                */ 03696000
*           THEN                    /*                               */ 03697000
         TM    IOPCOPY(IOPPTR),B'10000000'                         1226 03698000
         BNZ   @RF01226                                            1226 03699000
*           IOPCOPY=ON;             /* ADD IT                        */ 03700000
         OI    IOPCOPY(IOPPTR),B'10000000'                         1227 03701000
*         ELSE                      /*                               */ 03702000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 03703000
         B     @RC01226                                            1228 03704000
@RF01226 BAL   @14,UCL356I                                         1228 03705000
*       END;                        /* END ADD                       */ 03706000
*     ELSE                          /* MUST BE REPLACE SO            */ 03707000
*       IOPCOPY=ON;                 /* ALWAYS ADD OPTION             */ 03708000
         B     @RC01224                                            1230 03709000
@RF01224 OI    IOPCOPY(IOPPTR),B'10000000'                         1230 03710000
*   RETURN;                         /* RETURN TO SCAN                */ 03711000
         B     @EL00007                                            1231 03712000
*                                                                  1232 03713000
*   /*****************************************************************/ 03714000
*   /*                                                               */ 03715000
*   /* ROUT TO PROCESS THE SYSLIB KEYWORD FOR LMODS                  */ 03716000
*   /*                                                               */ 03717000
*   /*****************************************************************/ 03718000
*                                                                  1232 03719000
*RLMDSYLB:                          /*                               */ 03720000
*   ENTRY;                          /*                               */ 03721000
RLMDSYLB STM   @14,@12,@SA00007                                    1232 03722000
*   MSGPARTS='';                    /* INIT MESSAGE                  */ 03723000
         MVI   MSGPARTS,C' '                                       1233 03724000
         MVC   MSGPARTS+1(131),MSGPARTS                            1233 03725000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION ID        */ 03726000
         L     @06,SCPPTR                                          1234 03727000
         LH    @15,SCPPMLN(,@06)                                   1234 03728000
         BCTR  @15,0                                               1234 03729000
         L     @06,SCPCHAR(,@06)                                   1234 03730000
         EX    @15,@SM02281                                        1234 03731000
*   VLPTYPE=IOPLMSYS;               /* SUB ENTRY TYPE CODE           */ 03732000
         MVI   VLPTYPE,X'01'                                       1235 03733000
*   VLPLPTR=ADDR(IOPLNTRY(1));      /*                               */ 03734000
         LA    @06,IOPLNTRY(,IOPPTR)                               1236 03735000
         ST    @06,VLPLPTR                                         1236 03736000
*   VLPDLEN=LENGTH(IOPLSYS);        /* ENTRY LENGTH                  */ 03737000
         MVI   VLPDLEN,X'08'                                       1237 03738000
*   RETURN;                         /*                               */ 03739000
         B     @EL00007                                            1238 03740000
*   END RLMDXXX;                    /*                               */ 03741000
         B     @EL00007                                            1239 03742000
         EJECT                                                          03743000
*                                                                  1240 03744000
*   /*****************************************************************/ 03745000
*   /*                                                               */ 03746000
*   /* ROUT TO PROCESS THE DLIB KEYWORDS                             */ 03747000
*   /*                                                               */ 03748000
*   /*****************************************************************/ 03749000
*                                                                  1240 03750000
*RDLBXXX:                           /*                               */ 03751000
*   PROCEDURE;                      /*                               */ 03752000
*                                                                  1240 03753000
RDLBXXX  STM   @14,@12,12(@13)                                     1240 03754000
*   /*****************************************************************/ 03755000
*   /*                                                               */ 03756000
*   /* ROUT TO PROCESS DLIB SYSLIB KEYWORD                           */ 03757000
*   /*                                                               */ 03758000
*   /*****************************************************************/ 03759000
*                                                                  1241 03760000
*RDLBSYLB:                          /*                               */ 03761000
*   ENTRY;                          /*                               */ 03762000
         B     @EC01241                                            1241 03763000
RDLBSYLB STM   @14,@12,12(@13)                                     1241 03764000
@EC01241 DS    0H                                                  1242 03765000
*   MSGPARTS='';                    /* INIT MESSAGE                  */ 03766000
         MVI   MSGPARTS,C' '                                       1242 03767000
         MVC   MSGPARTS+1(131),MSGPARTS                            1242 03768000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPTION ID        */ 03769000
         L     @06,SCPPTR                                          1243 03770000
         LH    @15,SCPPMLN(,@06)                                   1243 03771000
         BCTR  @15,0                                               1243 03772000
         L     @06,SCPCHAR(,@06)                                   1243 03773000
         EX    @15,@SM02281                                        1243 03774000
*   VLPTYPE=IOPDLSYS;               /* SUB ENTRY TYPE CODE           */ 03775000
         MVI   VLPTYPE,X'01'                                       1244 03776000
*   VLPLPTR=ADDR(IOPDNTRY(1));      /*                               */ 03777000
         LA    @06,IOPDNTRY(,IOPPTR)                               1245 03778000
         ST    @06,VLPLPTR                                         1245 03779000
*   VLPDLEN=LENGTH(IOPDSYS);        /* ENTRY LENGTH                  */ 03780000
         MVI   VLPDLEN,X'08'                                       1246 03781000
*   RETURN;                         /*                               */ 03782000
@EL00008 DS    0H                                                  1247 03783000
@EF00008 DS    0H                                                  1247 03784000
@ER00008 LM    @14,@12,12(@13)                                     1247 03785000
         BR    @14                                                 1247 03786000
*   END RDLBXXX;                    /*                               */ 03787000
         EJECT                                                          03788000
*                                                                  1249 03789000
*   /*****************************************************************/ 03790000
*   /*                                                               */ 03791000
*   /* ROUTINES TO PROCESS OPTIONS FOR THE SYSTEM ENTRY      @Z63SP00*/ 03792000
*   /*                                                               */ 03793000
*   /*****************************************************************/ 03794000
*                                                                  1249 03795000
*RSYSXXX:                           /*                               */ 03796000
*   PROCEDURE;                      /*                               */ 03797000
*                                                                  1249 03798000
RSYSXXX  STM   @14,@12,@SA00009                                    1249 03799000
*   /*****************************************************************/ 03800000
*   /*                                                               */ 03801000
*   /* EXIT FOR SYSTEM SREL VALUE                            @Z63SP00*/ 03802000
*   /*                                                               */ 03803000
*   /*****************************************************************/ 03804000
*                                                                  1250 03805000
*RSYSSRLV:                                                         1250 03806000
*   ENTRY;                          /*                       @Z63SP00*/ 03807000
         B     @EC01250                                            1250 03808000
RSYSSRLV STM   @14,@12,@SA00009                                    1250 03809000
@EC01250 DS    0H                                                  1251 03810000
*   SAVDATA(1:LENGTH(IOPSREL))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA      */ 03811000
         MVI   SAVDATA+1,C' '                                      1251 03812000
         MVC   SAVDATA+2(2),SAVDATA+1                              1251 03813000
         L     @06,SCPPTR                                          1251 03814000
         LH    @15,SCPPMLN(,@06)                                   1251 03815000
         BCTR  @15,0                                               1251 03816000
         L     @06,SCPCHAR(,@06)                                   1251 03817000
         EX    @15,@SM02291                                        1251 03818000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03819000
         MVI   MSGPARTS,C' '                                       1252 03820000
         MVC   MSGPARTS+1(131),MSGPARTS                            1252 03821000
*   MSGPART1(1:LENGTH(TXTSREL))=TXTSREL;/* TYPE ENTRY                */ 03822000
         MVC   MSGPART1(8),@CC01492                                1253 03823000
*   MSGPART3(1:LENGTH(IOPSREL))=IOPSREL;/* CURRENT VALUE             */ 03824000
         MVC   MSGPART3(4),IOPSREL(IOPPTR)                         1254 03825000
*   IF REP=ON                       /* IF REPLACE THEN               */ 03826000
*     THEN                          /*                               */ 03827000
         TM    REP,B'10000000'                                     1255 03828000
         BNO   @RF01255                                            1255 03829000
*     DO;                           /*                               */ 03830000
*       IF IOPSREL=BLANK4&TOTAL=OFF /* IF NOT TOTAL REP              */ 03831000
*         THEN                      /*                               */ 03832000
         CLC   IOPSREL(4,IOPPTR),@CC01418                          1257 03833000
         BNE   @RF01257                                            1257 03834000
         TM    TOTAL,B'00010000'                                   1257 03835000
         BNZ   @RF01257                                            1257 03836000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 03837000
         BAL   @14,UCL358I                                         1258 03838000
*       IOPSREL=SAVDATA(1:LENGTH(IOPSREL));/* REP OLD DATA           */ 03839000
@RF01257 MVC   IOPSREL(4,IOPPTR),SAVDATA                           1259 03840000
*     END;                          /*                               */ 03841000
*   ELSE                            /* OTHERWISE - DELETE    @Z63SP00*/ 03842000
*     IF ADD=ON                     /* IS IT ADD OPERATION   @Z63SP00*/ 03843000
*       THEN                        /* EXIT BADLY TO SCAN    @Z63SP00*/ 03844000
         B     @RC01255                                            1261 03845000
@RF01255 TM    ADD,B'00100000'                                     1261 03846000
         BNO   @RF01261                                            1261 03847000
*       DO;                         /*                               */ 03848000
*         IF IOPSREL=BLANK4         /* IF NO SREL                    */ 03849000
*           THEN                    /* THEN ADD ONE                  */ 03850000
         CLC   IOPSREL(4,IOPPTR),@CC01418                          1263 03851000
         BNE   @RF01263                                            1263 03852000
*           IOPSREL=SAVDATA(1:LENGTH(IOPSREL));/* ADD NEW DATA       */ 03853000
         MVC   IOPSREL(4,IOPPTR),SAVDATA                           1264 03854000
*         ELSE                      /* IF ONE THERE THEN ERR         */ 03855000
*           CALL UCL356I;           /*                               */ 03856000
         B     @RC01263                                            1265 03857000
@RF01263 BAL   @14,UCL356I                                         1265 03858000
*       END;                        /*                               */ 03859000
*     ELSE                          /*                               */ 03860000
*       DO;                         /*                               */ 03861000
         B     @RC01261                                            1267 03862000
@RF01261 DS    0H                                                  1268 03863000
*         IF IOPSREL=SAVDATA(1:LENGTH(IOPSREL))/* IF MATCH           */ 03864000
*           THEN                    /*                               */ 03865000
         CLC   IOPSREL(4,IOPPTR),SAVDATA                           1268 03866000
         BNE   @RF01268                                            1268 03867000
*           DO;                     /*                               */ 03868000
*RSYSSRLD:                          /*                               */ 03869000
*             ENTRY;                /*                               */ 03870000
         B     @EC01270                                            1270 03871000
RSYSSRLD STM   @14,@12,@SA00009                                    1270 03872000
@EC01270 DS    0H                                                  1271 03873000
*             IOPSREL=BLANK4;       /* BLANK OUT SREL                */ 03874000
         MVC   IOPSREL(4,IOPPTR),@CC01418                          1271 03875000
*           END;                    /*                               */ 03876000
*         ELSE                      /* VALUES DONT MATCH             */ 03877000
*           IF IOPSREL=BLANK4       /*                               */ 03878000
*             THEN                  /*                               */ 03879000
         B     @RC01268                                            1273 03880000
@RF01268 CLC   IOPSREL(4,IOPPTR),@CC01418                          1273 03881000
         BNE   @RF01273                                            1273 03882000
*             CALL UCL357I;         /* ENT DOES NOT EXIST            */ 03883000
         BAL   @14,UCL357I                                         1274 03884000
*           ELSE                    /*                               */ 03885000
*             CALL UCL261I;         /* DATA DOES NOT MATCH           */ 03886000
         B     @RC01273                                            1275 03887000
@RF01273 BAL   @14,UCL261I                                         1275 03888000
*       END;                        /*                               */ 03889000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 03890000
@EL00009 DS    0H                                                  1277 03891000
@EF00009 DS    0H                                                  1277 03892000
@ER00009 LM    @14,@12,@SA00009                                    1277 03893000
         BR    @14                                                 1277 03894000
*                                                                  1278 03895000
*   /*****************************************************************/ 03896000
*   /*                                                               */ 03897000
*   /* SCAN EXIT FOR NUCID KEYWORD                                   */ 03898000
*   /*                                                               */ 03899000
*   /*****************************************************************/ 03900000
*                                                                  1278 03901000
*RSYSNCV:                                                          1278 03902000
*   ENTRY;                          /*                               */ 03903000
RSYSNCV  STM   @14,@12,@SA00009                                    1278 03904000
*   SAVDATA(1:LENGTH(IOPNUCID))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA     */ 03905000
         L     @06,SCPPTR                                          1279 03906000
         L     @06,SCPCHAR(,@06)                                   1279 03907000
         MVC   SAVDATA(1),SCPSTRNG(@06)                            1279 03908000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03909000
         MVI   MSGPARTS,C' '                                       1280 03910000
         MVC   MSGPARTS+1(131),MSGPARTS                            1280 03911000
*   MSGPART1(1:LENGTH(TXTNUCID))=TXTNUCID;/* SET KEYWORD             */ 03912000
         MVC   MSGPART1(8),@CC01494                                1281 03913000
*   MSGPART3(1:LENGTH(IOPNUCID))=IOPNUCID;/* SET CURR MSG            */ 03914000
         MVC   MSGPART3(1),IOPNUCID(IOPPTR)                        1282 03915000
*   IF REP=ON                       /* IS REPLACE                    */ 03916000
*     THEN                          /*                               */ 03917000
         TM    REP,B'10000000'                                     1283 03918000
         BNO   @RF01283                                            1283 03919000
*     DO;                           /*                               */ 03920000
*       IF IOPNUCID=BLANK&TOTAL=OFF /* IF NOT TOTAL REP              */ 03921000
*         THEN                      /*                               */ 03922000
         CLI   IOPNUCID(IOPPTR),C' '                               1285 03923000
         BNE   @RF01285                                            1285 03924000
         TM    TOTAL,B'00010000'                                   1285 03925000
         BNZ   @RF01285                                            1285 03926000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 03927000
         BAL   @14,UCL358I                                         1286 03928000
*       IOPNUCID=SAVDATA(1:LENGTH(IOPNUCID));/* REP OLD DATA         */ 03929000
@RF01285 MVC   IOPNUCID(1,IOPPTR),SAVDATA                          1287 03930000
*     END;                          /*                               */ 03931000
*   ELSE                            /* OTHERWISE - DELETE NUCID      */ 03932000
*     IF ADD=ON                     /* IS IT ADD OPERATION   @Z63SP00*/ 03933000
*       THEN                        /* EXIT BADLY TO SCAN    @Z63SP00*/ 03934000
         B     @RC01283                                            1289 03935000
@RF01283 TM    ADD,B'00100000'                                     1289 03936000
         BNO   @RF01289                                            1289 03937000
*       DO;                         /*                               */ 03938000
*         IF IOPNUCID=BLANK         /* IF NO NUCID                   */ 03939000
*           THEN                    /*                               */ 03940000
         CLI   IOPNUCID(IOPPTR),C' '                               1291 03941000
         BNE   @RF01291                                            1291 03942000
*           IOPNUCID=SAVDATA(1:LENGTH(IOPNUCID));/* ADD NEW DATA     */ 03943000
         MVC   IOPNUCID(1,IOPPTR),SAVDATA                          1292 03944000
*         ELSE                      /*                               */ 03945000
*           CALL UCL356I;           /*                               */ 03946000
         B     @RC01291                                            1293 03947000
@RF01291 BAL   @14,UCL356I                                         1293 03948000
*       END;                        /*                               */ 03949000
*     ELSE                          /* MUST BE DELETE                */ 03950000
*       DO;                         /*                               */ 03951000
         B     @RC01289                                            1295 03952000
@RF01289 DS    0H                                                  1296 03953000
*         IF IOPNUCID=SAVDATA(1:LENGTH(IOPNUCID))/* IF EQUAL         */ 03954000
*           THEN                    /*                               */ 03955000
         CLC   IOPNUCID(1,IOPPTR),SAVDATA                          1296 03956000
         BNE   @RF01296                                            1296 03957000
*           DO;                     /*                               */ 03958000
*RSYSNCD:                           /*                               */ 03959000
*             ENTRY;                /*                               */ 03960000
         B     @EC01298                                            1298 03961000
RSYSNCD  STM   @14,@12,@SA00009                                    1298 03962000
@EC01298 DS    0H                                                  1299 03963000
*             IOPNUCID=BLANK;       /* BLANK NUCID                   */ 03964000
         MVI   IOPNUCID(IOPPTR),C' '                               1299 03965000
*           END;                    /*                               */ 03966000
*         ELSE                      /*                               */ 03967000
*           IF IOPNUCID=BLANK       /* IF NOT PRESENT                */ 03968000
*             THEN                  /*                               */ 03969000
         B     @RC01296                                            1301 03970000
@RF01296 CLI   IOPNUCID(IOPPTR),C' '                               1301 03971000
         BNE   @RF01301                                            1301 03972000
*             CALL UCL357I;         /* DATA DOES NOT EXIST           */ 03973000
         BAL   @14,UCL357I                                         1302 03974000
*           ELSE                    /*                               */ 03975000
*             CALL UCL261I;         /* DEL NOT MATCH MSG             */ 03976000
         B     @RC01301                                            1303 03977000
@RF01301 BAL   @14,UCL261I                                         1303 03978000
*       END;                        /*                               */ 03979000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 03980000
         B     @EL00009                                            1305 03981000
*                                                                  1306 03982000
*   /*****************************************************************/ 03983000
*   /*                                                               */ 03984000
*   /* SCAN EXIT FOR PEMAX KEYWORD                                   */ 03985000
*   /*                                                               */ 03986000
*   /*****************************************************************/ 03987000
*                                                                  1306 03988000
*RSYSPMV:                                                          1306 03989000
*   ENTRY;                          /*                               */ 03990000
RSYSPMV  STM   @14,@12,@SA00009                                    1306 03991000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 03992000
         MVI   MSGPARTS,C' '                                       1307 03993000
         MVC   MSGPARTS+1(131),MSGPARTS                            1307 03994000
*   MSGPART1(1:LENGTH(TXTPEMAX))=TXTPEMAX;/* KEYWORD FOR MSG         */ 03995000
*                                                                  1308 03996000
         MVC   MSGPART1(8),@CC01496                                1308 03997000
*   /*****************************************************************/ 03998000
*   /*                                                               */ 03999000
*   /* CONVERT PASSED VALUE INTO NEWPEMAX                            */ 04000000
*   /*                                                               */ 04001000
*   /*****************************************************************/ 04002000
*                                                                  1309 04003000
*   CHAR8=EBCZEROS;                 /*                               */ 04004000
         MVC   CHAR8(8),@CC01428                                   1309 04005000
*   CHAR8(9-SCPPMLN:8)=SCPSTRNG(1:SCPPMLN);/*                        */ 04006000
         L     @06,SCPPTR                                          1310 04007000
         LA    @15,9                                               1310 04008000
         SH    @15,SCPPMLN(,@06)                                   1310 04009000
         LA    @14,CHAR8-1(@15)                                    1310 04010000
         LCR   @15,@15                                             1310 04011000
         AH    @15,@CH00036                                        1310 04012000
         L     @06,SCPCHAR(,@06)                                   1310 04013000
         EX    @15,@SM02294                                        1310 04014000
*   PACK(PACK8,CHAR8);              /*                               */ 04015000
         PACK  PACK8(8),CHAR8(8)                                   1311 04016000
*   CVB(CVB15,PACK8);               /*                               */ 04017000
         CVB   @06,PACK8                                           1312 04018000
         STH   @06,CVB15                                           1312 04019000
*   NEWPEMAX=CVB15;                 /*                               */ 04020000
*                                                                  1313 04021000
         STH   @06,NEWPEMAX                                        1313 04022000
*   /*****************************************************************/ 04023000
*   /*                                                               */ 04024000
*   /* CONVERT OLD PEMAX FOR POSSIBLE MESSAGES                       */ 04025000
*   /*                                                               */ 04026000
*   /*****************************************************************/ 04027000
*                                                                  1314 04028000
*   CVD(IOPPEMAX,PACK8);            /* CONVERT CURRENT VALUE         */ 04029000
         LH    @06,IOPPEMAX(,IOPPTR)                               1314 04030000
         CVD   @06,PACK8                                           1314 04031000
*   UNPK(CHAR12,PACK8);             /*                               */ 04032000
         UNPK  CHAR12(12),PACK8(8)                                 1315 04033000
*   CHAR12(12)=CHAR12(12)|HEX0;     /*                               */ 04034000
         OI    CHAR12+11,X'F0'                                     1316 04035000
*   MSGPART3(1:4)=CHAR12(9:12);     /* SAVE EXISTING VALUE           */ 04036000
         MVC   MSGPART3(4),CHAR12+8                                1317 04037000
*   IF REP=ON                       /* IF REPLACE                    */ 04038000
*     THEN                          /*                               */ 04039000
         TM    REP,B'10000000'                                     1318 04040000
         BNO   @RF01318                                            1318 04041000
*     DO;                           /*                               */ 04042000
*       IF IOPPEMAX=ZERO&TOTAL=OFF  /* IF NOT TOTAL REP              */ 04043000
*         THEN                      /*                               */ 04044000
         LTR   @06,@06                                             1320 04045000
         BNZ   @RF01320                                            1320 04046000
         TM    TOTAL,B'00010000'                                   1320 04047000
         BNZ   @RF01320                                            1320 04048000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 04049000
         BAL   @14,UCL358I                                         1321 04050000
*       IOPPEMAX=NEWPEMAX;          /* MOVE                  @Z63SP00*/ 04051000
@RF01320 MVC   IOPPEMAX(2,IOPPTR),NEWPEMAX                         1322 04052000
*     END;                          /*                               */ 04053000
*   ELSE                            /*                               */ 04054000
*     IF ADD=ON                     /* IS IT ADD OPERATION   @Z63SP00*/ 04055000
*       THEN                        /* EXIT BADLY TO SCAN    @Z63SP00*/ 04056000
         B     @RC01318                                            1324 04057000
@RF01318 TM    ADD,B'00100000'                                     1324 04058000
         BNO   @RF01324                                            1324 04059000
*       DO;                         /*                               */ 04060000
*         IF IOPPEMAX=ZERO          /* IF NO VALUE PRESENT           */ 04061000
*           THEN                    /*                               */ 04062000
         ICM   @06,3,IOPPEMAX(IOPPTR)                              1326 04063000
         BNZ   @RF01326                                            1326 04064000
*           IOPPEMAX=NEWPEMAX;      /* MOVE NEW VALUE                */ 04065000
         MVC   IOPPEMAX(2,IOPPTR),NEWPEMAX                         1327 04066000
*         ELSE                      /*                               */ 04067000
*           CALL UCL356I;           /* PEMAX ALREADY EXISTS          */ 04068000
         B     @RC01326                                            1328 04069000
@RF01326 BAL   @14,UCL356I                                         1328 04070000
*       END;                        /*                               */ 04071000
*     ELSE                          /* MUST BE DELETE                */ 04072000
*       DO;                         /*                               */ 04073000
         B     @RC01324                                            1330 04074000
@RF01324 DS    0H                                                  1331 04075000
*         IF IOPPEMAX=NEWPEMAX      /* IF VALUES EQUAL               */ 04076000
*           THEN                    /*                               */ 04077000
         CLC   IOPPEMAX(2,IOPPTR),NEWPEMAX                         1331 04078000
         BNE   @RF01331                                            1331 04079000
*           DO;                     /*                               */ 04080000
*RSYSPMD:                           /*                               */ 04081000
*             ENTRY;                /*                               */ 04082000
         B     @EC01333                                            1333 04083000
RSYSPMD  STM   @14,@12,@SA00009                                    1333 04084000
@EC01333 DS    0H                                                  1334 04085000
*             IOPPEMAX=''B;         /* ZERO PEMAX                    */ 04086000
         SLR   @06,@06                                             1334 04087000
         STH   @06,IOPPEMAX(,IOPPTR)                               1334 04088000
*           END;                    /*                               */ 04089000
*         ELSE                      /*                               */ 04090000
*           IF IOPPEMAX=ZERO        /* IF NO ENTRY                   */ 04091000
*             THEN                  /*                               */ 04092000
         B     @RC01331                                            1336 04093000
@RF01331 ICM   @06,3,IOPPEMAX(IOPPTR)                              1336 04094000
         BNZ   @RF01336                                            1336 04095000
*             CALL UCL357I;         /* ENTRY DOES NOT EXIST          */ 04096000
         BAL   @14,UCL357I                                         1337 04097000
*           ELSE                    /*                               */ 04098000
*             CALL UCL261I;         /* DATA DOES NOT MATCH           */ 04099000
         B     @RC01336                                            1338 04100000
@RF01336 BAL   @14,UCL261I                                         1338 04101000
*       END;                        /*                               */ 04102000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 04103000
         B     @EL00009                                            1340 04104000
*                                                                  1341 04105000
*   /*****************************************************************/ 04106000
*   /*                                                               */ 04107000
*   /* ENTRY TO PROCESS SAVEMTS KEYWORD                      @Z63SP00*/ 04108000
*   /*                                                               */ 04109000
*   /*****************************************************************/ 04110000
*                                                                  1341 04111000
*RSYSSMTS:                          /*                               */ 04112000
*   ENTRY;                          /*                               */ 04113000
RSYSSMTS STM   @14,@12,@SA00009                                    1341 04114000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 04115000
         MVI   MSGPARTS,C' '                                       1342 04116000
         MVC   MSGPARTS+1(131),MSGPARTS                            1342 04117000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 04118000
         L     @06,SCPPTR                                          1343 04119000
         LH    @15,SCPPMLN(,@06)                                   1343 04120000
         BCTR  @15,0                                               1343 04121000
         L     @06,SCPCHAR(,@06)                                   1343 04122000
         EX    @15,@SM02281                                        1343 04123000
*   IF DEL=ON                       /* IF DELETE                     */ 04124000
*     THEN                          /* THEN CHECK PRENSENCE          */ 04125000
         TM    DEL,B'01000000'                                     1344 04126000
         BNO   @RF01344                                            1344 04127000
*     DO;                           /*                               */ 04128000
*       IF IOPMTSNP=ON              /* IF OPTION PRESENT             */ 04129000
*         THEN                      /*                               */ 04130000
         TM    IOPMTSNP(IOPPTR),B'10000000'                        1346 04131000
         BNO   @RF01346                                            1346 04132000
*         IOPMTSNP=OFF;             /* DELETE IT                     */ 04133000
         NI    IOPMTSNP(IOPPTR),B'01111111'                        1347 04134000
*       ELSE                        /*                               */ 04135000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 04136000
         B     @RC01346                                            1348 04137000
@RF01346 BAL   @14,UCL357I                                         1348 04138000
*     END;                          /* END DELETE REQUEST            */ 04139000
*   ELSE                            /* IF NOT DELETE                 */ 04140000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 04141000
*       THEN                        /* CHECK TO SEE IF THERE         */ 04142000
         B     @RC01344                                            1350 04143000
@RF01344 TM    ADD,B'00100000'                                     1350 04144000
         BNO   @RF01350                                            1350 04145000
*       DO;                         /*                               */ 04146000
*         IF IOPMTSNP=OFF           /* IF NOT PRESENT                */ 04147000
*           THEN                    /*                               */ 04148000
         TM    IOPMTSNP(IOPPTR),B'10000000'                        1352 04149000
         BNZ   @RF01352                                            1352 04150000
*           IOPMTSNP=ON;            /* ADD IT                        */ 04151000
         OI    IOPMTSNP(IOPPTR),B'10000000'                        1353 04152000
*         ELSE                      /*                               */ 04153000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 04154000
         B     @RC01352                                            1354 04155000
@RF01352 BAL   @14,UCL356I                                         1354 04156000
*       END;                        /* END ADD                       */ 04157000
*     ELSE                          /* MUST BE REPLACE SO            */ 04158000
*       IOPMTSNP=ON;                /* ALWAYS ADD OPTION             */ 04159000
         B     @RC01350                                            1356 04160000
@RF01350 OI    IOPMTSNP(IOPPTR),B'10000000'                        1356 04161000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 04162000
         B     @EL00009                                            1357 04163000
*                                                                  1358 04164000
*   /*****************************************************************/ 04165000
*   /*                                                               */ 04166000
*   /* ENTRY TO PROCESS SAVESTS KEYWORD                      @Z63SP00*/ 04167000
*   /*                                                               */ 04168000
*   /*****************************************************************/ 04169000
*                                                                  1358 04170000
*RSYSSSTS:                          /*                               */ 04171000
*   ENTRY;                          /*                               */ 04172000
RSYSSSTS STM   @14,@12,@SA00009                                    1358 04173000
*   MSGPARTS='';                    /* BLANK OUT MSG PART            */ 04174000
         MVI   MSGPARTS,C' '                                       1359 04175000
         MVC   MSGPARTS+1(131),MSGPARTS                            1359 04176000
*   MSGPART1(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* MOVE TYPE             */ 04177000
         L     @06,SCPPTR                                          1360 04178000
         LH    @15,SCPPMLN(,@06)                                   1360 04179000
         BCTR  @15,0                                               1360 04180000
         L     @06,SCPCHAR(,@06)                                   1360 04181000
         EX    @15,@SM02281                                        1360 04182000
*   IF DEL=ON                       /* IF DELETE                     */ 04183000
*     THEN                          /* THEN CHECK PRENSENCE          */ 04184000
         TM    DEL,B'01000000'                                     1361 04185000
         BNO   @RF01361                                            1361 04186000
*     DO;                           /*                               */ 04187000
*       IF IOPSTSNP=ON              /* IF OPTION PRESENT             */ 04188000
*         THEN                      /*                               */ 04189000
         TM    IOPSTSNP(IOPPTR),B'01000000'                        1363 04190000
         BNO   @RF01363                                            1363 04191000
*         IOPSTSNP=OFF;             /* DELETE IT                     */ 04192000
         NI    IOPSTSNP(IOPPTR),B'10111111'                        1364 04193000
*       ELSE                        /*                               */ 04194000
*         CALL UCL357I;             /* OPTION NOT PRESENT            */ 04195000
         B     @RC01363                                            1365 04196000
@RF01363 BAL   @14,UCL357I                                         1365 04197000
*     END;                          /* END DELETE REQUEST            */ 04198000
*   ELSE                            /* IF NOT DELETE                 */ 04199000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 04200000
*       THEN                        /* CHECK TO SEE IF THERE         */ 04201000
         B     @RC01361                                            1367 04202000
@RF01361 TM    ADD,B'00100000'                                     1367 04203000
         BNO   @RF01367                                            1367 04204000
*       DO;                         /*                               */ 04205000
*         IF IOPSTSNP=OFF           /* IF NOT PRESENT                */ 04206000
*           THEN                    /*                               */ 04207000
         TM    IOPSTSNP(IOPPTR),B'01000000'                        1369 04208000
         BNZ   @RF01369                                            1369 04209000
*           IOPSTSNP=ON;            /* ADD IT                        */ 04210000
         OI    IOPSTSNP(IOPPTR),B'01000000'                        1370 04211000
*         ELSE                      /*                               */ 04212000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 04213000
         B     @RC01369                                            1371 04214000
@RF01369 BAL   @14,UCL356I                                         1371 04215000
*       END;                        /* END ADD                       */ 04216000
*     ELSE                          /* MUST BE REPLACE SO            */ 04217000
*       IOPSTSNP=ON;                /* ALWAYS ADD OPTION             */ 04218000
         B     @RC01367                                            1373 04219000
@RF01367 OI    IOPSTSNP(IOPPTR),B'01000000'                        1373 04220000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 04221000
         B     @EL00009                                            1374 04222000
*                                                                  1375 04223000
*   /*****************************************************************/ 04224000
*   /*                                                               */ 04225000
*   /* ENTRY TO PROCESS CDSID KEYWORD                        @Z63SP00*/ 04226000
*   /*                                                               */ 04227000
*   /*****************************************************************/ 04228000
*                                                                  1375 04229000
*RSYSCDV:                           /*                               */ 04230000
*   ENTRY;                          /*                               */ 04231000
RSYSCDV  STM   @14,@12,@SA00009                                    1375 04232000
*   SAVDATA(1:LENGTH(IOPSYSID))=SCPSTRNG(1:SCPPMLN);/* SAVE DATA     */ 04233000
         MVI   SAVDATA+1,C' '                                      1376 04234000
         MVC   SAVDATA+2(6),SAVDATA+1                              1376 04235000
         L     @06,SCPPTR                                          1376 04236000
         LH    @15,SCPPMLN(,@06)                                   1376 04237000
         BCTR  @15,0                                               1376 04238000
         L     @06,SCPCHAR(,@06)                                   1376 04239000
         EX    @15,@SM02291                                        1376 04240000
*   MSGPARTS='';                    /*                               */ 04241000
         MVI   MSGPARTS,C' '                                       1377 04242000
         MVC   MSGPARTS+1(131),MSGPARTS                            1377 04243000
*   MSGPART1(1:LENGTH(TXTCDSID))=TXTCDSID;/*                         */ 04244000
         MVC   MSGPART1(8),@CC01498                                1378 04245000
*   MSGPART3(1:LENGTH(IOPSYSID))=IOPSYSID;/* SAVE OLD DATA           */ 04246000
         MVC   MSGPART3(8),IOPSYSID(IOPPTR)                        1379 04247000
*   IF REP=ON                       /* IF REPLACE                    */ 04248000
*     THEN                          /* THEN CHECK PRENSENCE          */ 04249000
         TM    REP,B'10000000'                                     1380 04250000
         BNO   @RF01380                                            1380 04251000
*     DO;                           /*                               */ 04252000
*       IF IOPSYSID=BLANK8&TOTAL=OFF/* IF NOT TOTAL REP              */ 04253000
*         THEN                      /*                               */ 04254000
         CLC   IOPSYSID(8,IOPPTR),BLANK8                           1382 04255000
         BNE   @RF01382                                            1382 04256000
         TM    TOTAL,B'00010000'                                   1382 04257000
         BNZ   @RF01382                                            1382 04258000
*         CALL UCL358I;             /* ADD ASSUMED                   */ 04259000
         BAL   @14,UCL358I                                         1383 04260000
*       IOPSYSID=SAVDATA(1:LENGTH(IOPSYSID));/* REP OLD DATA         */ 04261000
@RF01382 MVC   IOPSYSID(8,IOPPTR),SAVDATA                          1384 04262000
*     END;                          /*                               */ 04263000
*   ELSE                            /* IF DELETE                     */ 04264000
*     IF ADD=ON                     /* IF ADD REQUEST                */ 04265000
*       THEN                        /* CHECK TO SEE IF THERE         */ 04266000
         B     @RC01380                                            1386 04267000
@RF01380 TM    ADD,B'00100000'                                     1386 04268000
         BNO   @RF01386                                            1386 04269000
*       DO;                         /*                               */ 04270000
*         IF IOPSYSID=BLANK8        /* IF NO DATA THERE              */ 04271000
*           THEN                    /*                               */ 04272000
         CLC   IOPSYSID(8,IOPPTR),BLANK8                           1388 04273000
         BNE   @RF01388                                            1388 04274000
*           IOPSYSID=SAVDATA(1:LENGTH(IOPSYSID));/* ADD NEW DATA     */ 04275000
         MVC   IOPSYSID(8,IOPPTR),SAVDATA                          1389 04276000
*         ELSE                      /*                               */ 04277000
*           CALL UCL356I;           /* OPTION ALREADY THERE          */ 04278000
         B     @RC01388                                            1390 04279000
@RF01388 BAL   @14,UCL356I                                         1390 04280000
*       END;                        /*                               */ 04281000
*     ELSE                          /* MUST BE DELETE                */ 04282000
*       DO;                         /*                               */ 04283000
         B     @RC01386                                            1392 04284000
@RF01386 DS    0H                                                  1393 04285000
*         IF IOPSYSID=SAVDATA(1:LENGTH(IOPSYSID))/* IF MATCH         */ 04286000
*           THEN                    /*                               */ 04287000
         CLC   IOPSYSID(8,IOPPTR),SAVDATA                          1393 04288000
         BNE   @RF01393                                            1393 04289000
*           DO;                     /*                               */ 04290000
*RSYSCDD:                           /*                               */ 04291000
*             ENTRY;                /*                               */ 04292000
         B     @EC01395                                            1395 04293000
RSYSCDD  STM   @14,@12,@SA00009                                    1395 04294000
@EC01395 DS    0H                                                  1396 04295000
*             IOPSYSID=BLANK8;      /* DELETE IT                     */ 04296000
         MVC   IOPSYSID(8,IOPPTR),BLANK8                           1396 04297000
*           END;                    /*                               */ 04298000
*         ELSE                      /* IF NOT EQUAL                  */ 04299000
*           IF IOPSYSID=BLANK8      /* IF NO CDSID                   */ 04300000
*             THEN                  /*                               */ 04301000
         B     @RC01393                                            1398 04302000
@RF01393 CLC   IOPSYSID(8,IOPPTR),BLANK8                           1398 04303000
         BNE   @RF01398                                            1398 04304000
*             CALL UCL357I;         /* DOES NOT EXIST                */ 04305000
         BAL   @14,UCL357I                                         1399 04306000
*           ELSE                    /*                               */ 04307000
*             CALL UCL261I;         /* DOES NOT MATCH                */ 04308000
         B     @RC01398                                            1400 04309000
@RF01398 BAL   @14,UCL261I                                         1400 04310000
*       END;                        /*                               */ 04311000
*   RETURN;                         /* RETURN TO HMASMSCN            */ 04312000
         B     @EL00009                                            1402 04313000
*   END RSYSXXX;                    /* END SYSTEM OPTIONS            */ 04314000
         B     @EL00009                                            1403 04315000
*                                                                  1404 04316000
*   /*****************************************************************/ 04317000
*   /*                                                               */ 04318000
*   /* THIS ROUTINE IS USED TO RESET THE FIRST TIME REPL SWITCH WHEN */ 04319000
*   /* ANOTHER KEYWORD IS HIT SO THAT THE REPL COMPRESS/DELETE CODE  */ 04320000
*   /* WILL BE EXECUTED                                      @Z40SP00*/ 04321000
*   /*                                                               */ 04322000
*   /*****************************************************************/ 04323000
*                                                                  1404 04324000
*RESETRPL:                          /*                       @Z40SP00*/ 04325000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                          */ 04326000
RESETRPL DS    0H                                                  1405 04327000
*   FRSTREPL=OFF;                   /* RESET SWITCH          @Z40SP00*/ 04328000
*   UNCDEL=OFF;                     /* NOT UNC DEL                   */ 04329000
         NI    FRSTREPL,B'11111001'                                1406 04330000
*   END RESETRPL;                   /* RETURN TO SCAN        @Z40SP00*/ 04331000
@EL00010 DS    0H                                                  1407 04332000
@EF00010 DS    0H                                                  1407 04333000
@ER00010 BR    @14                                                 1407 04334000
         EJECT                                                          04335000
*                                                                  1408 04336000
*   /*****************************************************************/ 04337000
*   /*                                                               */ 04338000
*   /* THIS ROUTINE ADDS THE NEW NAME TAKEN FROM THE SCAN ROUTINE TO */ 04339000
*   /* THE IOP USER DATA NAME LIST IF THE OPERATION TOTAL NEW OR     */ 04340000
*   /* REPLACE                                                       */ 04341000
*   /*                                                               */ 04342000
*   /*****************************************************************/ 04343000
*                                                                  1408 04344000
*ELEMSCAN:                          /*                       @ZD00004*/ 04345000
*                                                                  1408 04346000
*   /*****************************************************************/ 04347000
*   /*                                                               */ 04348000
*   /* THESE ENTRY POINTS ARE CALLED OUT OF SCAN FOR ADD, DEL, AND   */ 04349000
*   /* REP REQUESTS FOR ONE DATA ITEM                                */ 04350000
*   /*                                                               */ 04351000
*   /*****************************************************************/ 04352000
*                                                                  1408 04353000
*RSMDXNAM:                          /* SYSMOD SUBENTRIES             */ 04354000
*RSMDYNAM:                          /* SYSMOD PTF SUBENTRIES         */ 04355000
*RMACXV:                            /* MACRO SUBENTRIES              */ 04356000
*RMODXNAM:                          /* MOD SUBENTRIES                */ 04357000
*RLMDSYV:                           /* LMOD SUBENTRIES               */ 04358000
*RDLBSYV:                           /* DLIB SUBENTRIES               */ 04359000
*   PROCEDURE;                      /*                               */ 04360000
ELEMSCAN DS    0H                                                  1408 04361000
RSMDXNAM DS    0H                                                  1408 04362000
RSMDYNAM DS    0H                                                  1408 04363000
RMACXV   DS    0H                                                  1408 04364000
RMODXNAM DS    0H                                                  1408 04365000
RLMDSYV  DS    0H                                                  1408 04366000
RDLBSYV  STM   @14,@12,@SA00011                                    1408 04367000
*   MSGPART2(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE SUBENTRY NAME    */ 04368000
         L     @06,SCPPTR                                          1409 04369000
         LH    @15,SCPPMLN(,@06)                                   1409 04370000
         BCTR  @15,0                                               1409 04371000
         L     @06,SCPCHAR(,@06)                                   1409 04372000
         EX    @15,@SM02289                                        1409 04373000
*   VLPDATA=''B;                    /*                               */ 04374000
         XC    VLPDATA(8),VLPDATA                                  1410 04375000
*   VLPDATA(1:VLPDLEN)=BLANK8(1:VLPDLEN);/*                          */ 04376000
         SLR   @14,@14                                             1411 04377000
         IC    @14,VLPDLEN                                         1411 04378000
         BCTR  @14,0                                               1411 04379000
         EX    @14,@SM02296                                        1411 04380000
*   VLPDATA(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/*                        */ 04381000
         EX    @15,@SM02298                                        1412 04382000
*   GO TO ELEMCALL;                 /* TO ADD IT             @ZD00006*/ 04383000
*                                                                  1413 04384000
         B     ELEMCALL                                            1413 04385000
*   /*****************************************************************/ 04386000
*   /*                                                               */ 04387000
*   /* THESE ENTRY POINTS ARE CALLED FOR UNCONDITIONAL DELETES FOR A */ 04388000
*   /* LIST OF ITEMS                                                 */ 04389000
*   /*                                                               */ 04390000
*   /*****************************************************************/ 04391000
*                                                                  1414 04392000
*RSMDWDEL:                          /* SYSMOD SUBENTRIES             */ 04393000
*RSMDXDEL:                          /* SYSMOD SUBENTRIES             */ 04394000
*RSMDYDEL:                          /* SYSMOD SUBENTRIES             */ 04395000
*RSMDZDEL:                          /* SYSMOD SUBENTRIES             */ 04396000
*RMACXD:                            /* MACRO SUBENTRIES              */ 04397000
*RMODUMDD:                          /* MODULE UMIDS                  */ 04398000
*RMODLMDD:                          /* MODULE LMODS                  */ 04399000
*RMODTALD:                          /* MODULE TALIAS                 */ 04400000
*RMODDALD:                          /* MODULE DALIAS                 */ 04401000
*RLMDSYD:                           /* LMOD SYSLIBS                  */ 04402000
*RDLBSYD:                           /* DLIB SYSLIBS                  */ 04403000
*   ENTRY;                          /*                               */ 04404000
RSMDWDEL DS    0H                                                  1414 04405000
RSMDXDEL DS    0H                                                  1414 04406000
RSMDYDEL DS    0H                                                  1414 04407000
RSMDZDEL DS    0H                                                  1414 04408000
RMACXD   DS    0H                                                  1414 04409000
RMODUMDD DS    0H                                                  1414 04410000
RMODLMDD DS    0H                                                  1414 04411000
RMODTALD DS    0H                                                  1414 04412000
RMODDALD DS    0H                                                  1414 04413000
RLMDSYD  DS    0H                                                  1414 04414000
RDLBSYD  STM   @14,@12,@SA00011                                    1414 04415000
*   UNCDEL=ON;                      /* SET SW                        */ 04416000
         OI    UNCDEL,B'00000100'                                  1415 04417000
*   GO TO ELEMCALL;                 /* TO ADD IT             @ZD00006*/ 04418000
*                                                                  1416 04419000
         B     ELEMCALL                                            1416 04420000
*   /*****************************************************************/ 04421000
*   /*                                                               */ 04422000
*   /* SET VLU FUNCTION BASED ON TYPE REQUEST                        */ 04423000
*   /*                                                               */ 04424000
*   /*****************************************************************/ 04425000
*                                                                  1417 04426000
*ELEMCALL:                          /* COMMON ADD/DEL/REP LOGIC      */ 04427000
*   IF ADD=ON                       /* IF ADD REQUEST                */ 04428000
*       |TOTAL=ON                   /* OR TOTAL REP                  */ 04429000
*     THEN                          /*                               */ 04430000
ELEMCALL TM    ADD,B'00110000'                                     1417 04431000
         BZ    @RF01417                                            1417 04432000
*     VLPFUNCT=VLPADD;              /* SET VLU FUNCTION TO ADD       */ 04433000
         MVI   VLPFUNCT,X'01'                                      1418 04434000
*   ELSE                            /* NOT ADD REQUEST               */ 04435000
*     IF REP=ON                     /* IF REPLACE REQUEST            */ 04436000
*       THEN                        /* THEN                          */ 04437000
         B     @RC01417                                            1419 04438000
@RF01417 TM    REP,B'10000000'                                     1419 04439000
         BNO   @RF01419                                            1419 04440000
*       DO;                                                        1420 04441000
*         IF FRSTREPL=OFF           /* IF FIRST TIME FOR THIS TYPE   */ 04442000
*           THEN                    /* THEN SET                      */ 04443000
         TM    FRSTREPL,B'00000010'                                1421 04444000
         BNZ   @RF01421                                            1421 04445000
*           DO;                     /*                               */ 04446000
*             VLPFUNCT=VLPREP;      /* VLU FUNCTION TO REPLACE       */ 04447000
         MVI   VLPFUNCT,X'03'                                      1423 04448000
*             FRSTREPL=ON;          /* RESET SW                      */ 04449000
         OI    FRSTREPL,B'00000010'                                1424 04450000
*           END;                    /*                               */ 04451000
*         ELSE                      /* IF SUBSEQUENT REP PASS        */ 04452000
*           VLPFUNCT=VLPADD;        /* THEN FUNCTION IS ADD          */ 04453000
         B     @RC01421                                            1426 04454000
@RF01421 MVI   VLPFUNCT,X'01'                                      1426 04455000
*       END;                                                       1427 04456000
*     ELSE                          /* NOT REP OR ADD - MUST BE DEL  */ 04457000
*       IF UNCDEL=ON                /* IF DEL ALL OF THIS TYPE       */ 04458000
*         THEN                      /*                               */ 04459000
         B     @RC01419                                            1428 04460000
@RF01419 TM    UNCDEL,B'00000100'                                  1428 04461000
         BNO   @RF01428                                            1428 04462000
*         VLPFUNCT=VLPCLR;          /* SET VLU FUNCTION TO CLEAR     */ 04463000
         MVI   VLPFUNCT,X'04'                                      1429 04464000
*       ELSE                        /*                               */ 04465000
*         VLPFUNCT=VLPDEL;          /* SET TO DEL ONE ENTRY          */ 04466000
*                                                                  1430 04467000
         B     @RC01428                                            1430 04468000
@RF01428 MVI   VLPFUNCT,X'02'                                      1430 04469000
*   /*****************************************************************/ 04470000
*   /*                                                               */ 04471000
*   /* SET TYPES FOR POSSIBLE MESSAGES FROM VLU                      */ 04472000
*   /*                                                               */ 04473000
*   /*****************************************************************/ 04474000
*                                                                  1431 04475000
*   VLPMTYPE=CCATYPEA(IOPTYPE);     /*                               */ 04476000
@RC01428 DS    0H                                                  1431 04477000
@RC01419 DS    0H                                                  1431 04478000
@RC01417 SLR   @06,@06                                             1431 04479000
         IC    @06,IOPTYPE(,IOPPTR)                                1431 04480000
         SLA   @06,3                                               1431 04481000
         L     @01,CCATPAD(,CCAPTR)                                1431 04482000
         ALR   @01,@06                                             1431 04483000
         AL    @01,@CF02300                                        1431 04484000
         MVC   VLPMTYPE(8),CCATYPEA(@01)                           1431 04485000
*   VLPMNAME=IOPNAME;               /*                               */ 04486000
         MVC   VLPMNAME(8),IOPNAME(IOPPTR)                         1432 04487000
*   VLPSTYPE=MSGPART1;              /*                               */ 04488000
*                                                                  1433 04489000
         MVC   VLPSTYPE(16),MSGPART1                               1433 04490000
*   /*****************************************************************/ 04491000
*   /*                                                               */ 04492000
*   /* CALL HMASMVLU AND PROCESS RETURN CODE                         */ 04493000
*   /*                                                               */ 04494000
*   /*****************************************************************/ 04495000
*                                                                  1434 04496000
*   CALL HMASMVLU(HMASMVLP);        /*                               */ 04497000
         L     @15,@CV01412                                        1434 04498000
         LA    @01,@AL01434                                        1434 04499000
         BALR  @14,@15                                             1434 04500000
*   UCLRTNCD=MAX(UCLRTNCD,VLPRETRN);/*                               */ 04501000
         SLR   @06,@06                                             1435 04502000
         IC    @06,UCLRTNCD                                        1435 04503000
         SLR   @15,@15                                             1435 04504000
         IC    @15,VLPRETRN                                        1435 04505000
         CR    @06,@15                                             1435 04506000
         BNL   *+6                                                      04507000
         LR    @06,@15                                             1435 04508000
         STC   @06,UCLRTNCD                                        1435 04509000
*   IF VLPRETRN>VLPWARN             /* IF BAD RC                     */ 04510000
*     THEN                          /*                               */ 04511000
         CLI   VLPRETRN,4                                          1436 04512000
         BNH   @RF01436                                            1436 04513000
*     ERR2SW=ON;                    /* SET ERR SW                    */ 04514000
         OI    ERR2SW,B'01000000'                                  1437 04515000
*   RETURN;                         /* RETURN TO THE SCAN ROUTINE    */ 04516000
@EL00011 DS    0H                                                  1438 04517000
@EF00011 DS    0H                                                  1438 04518000
@ER00011 LM    @14,@12,@SA00011                                    1438 04519000
         BR    @14                                                 1438 04520000
*   END ELEMSCAN;                   /*                               */ 04521000
         B     @EL00011                                            1439 04522000
*                                                                  1440 04523000
*   /*****************************************************************/ 04524000
*   /*                                                               */ 04525000
*   /* A SYNTAX ERROR WAS DETECTED BY A SCAN EXIT ROUTINE - INDICATE */ 04526000
*   /* THE ERROR TO THE UCL CONTROL TABLE AND STOP THE SCAN          */ 04527000
*   /*                                                               */ 04528000
*   /*****************************************************************/ 04529000
*                                                                  1440 04530000
*RXTRADTA:                                                         1440 04531000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                          */ 04532000
RXTRADTA DS    0H                                                  1441 04533000
*   ERRAFTPR=ON;                    /* SET ERROR CONTROL SWITCH      */ 04534000
         OI    ERRAFTPR,B'00010000'                                1441 04535000
*   SCPRETRN=SCPSTOP;               /*                               */ 04536000
         L     @06,SCPPTR                                          1442 04537000
         MVI   SCPRETRN(@06),X'08'                                 1442 04538000
*   RETURN;                         /* RETURN BUT STOP THE SCAN      */ 04539000
@EL00012 DS    0H                                                  1443 04540000
@EF00012 DS    0H                                                  1443 04541000
@ER00012 BR    @14                                                 1443 04542000
*   END RXTRADTA;                   /*                               */ 04543000
*                                                                  1445 04544000
*   /*****************************************************************/ 04545000
*   /*                                                               */ 04546000
*   /* THE TERMINATING UCL CONTROL STATEMENT WAS FOUND BY THE SCAN   */ 04547000
*   /* ROUTINE. THE CONTROL SWITCH INDICATING SUCCESSFUL COMPLETION  */ 04548000
*   /* OF THE UPDATE IS SET AND CONTROL IS RETURNED TO THE SCAN      */ 04549000
*   /* ROUTINE TO ALLOW IT TO FINISH                                 */ 04550000
*   /*                                                               */ 04551000
*   /*****************************************************************/ 04552000
*                                                                  1445 04553000
*RENDUCL:                                                          1445 04554000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                          */ 04555000
RENDUCL  DS    0H                                                  1446 04556000
*   UCLTERM=ON;                     /* SET ALL OK INDICATOR  @Z63SP00*/ 04557000
         OI    UCLTERM,B'00001000'                                 1446 04558000
*   RETURN;                         /* SKIP PAST REG LOAD    @Z63SP00*/ 04559000
@EL00013 DS    0H                                                  1447 04560000
@EF00013 DS    0H                                                  1447 04561000
@ER00013 BR    @14                                                 1447 04562000
*   END RENDUCL;                    /*                               */ 04563000
*                                                                  1449 04564000
*   /*****************************************************************/ 04565000
*   /*                                                               */ 04566000
*   /* SCAN THE CONTROL STATEMENT LOOKING FOR A PERIOD (.)   @Z63SP00*/ 04567000
*   /*                                                               */ 04568000
*   /*****************************************************************/ 04569000
*                                                                  1449 04570000
*FLUSH:                                                            1449 04571000
*   PROCEDURE;                      /*                               */ 04572000
FLUSH    STM   @14,@12,@SA00014                                    1449 04573000
*   SCPSRCH=ADFLSHTB;               /* POINT AT THE FLUSH TABLE      */ 04574000
         L     @06,SCPPTR                                          1450 04575000
         MVC   SCPSRCH(4,@06),ADFLSHTB                             1450 04576000
*   SCPCHAR=ADDR(CRPBUFFR);         /* POINT TO SAVED RCD    @Z40SP00*/ 04577000
         L     @15,@PC00001+4                                      1451 04578000
         LA    @15,CRPBUFFR(,@15)                                  1451 04579000
         ST    @15,SCPCHAR(,@06)                                   1451 04580000
*   CALL HMASMSCN(HMASMSCP);        /* SCAN FOR ENDING .     @Z40SP00*/ 04581000
         ST    @06,@AL00001                                        1452 04582000
         L     @15,@CV01410                                        1452 04583000
         LA    @01,@AL00001                                        1452 04584000
         BALR  @14,@15                                             1452 04585000
*   ERR1SW=ON;                      /*                               */ 04586000
         OI    ERR1SW,B'10000000'                                  1453 04587000
*   RETURN CODE(0);                 /* RETURN                        */ 04588000
         SLR   @15,@15                                             1454 04589000
         L     @14,@SA00014                                        1454 04590000
         LM    @00,@12,@SA00014+8                                  1454 04591000
         BR    @14                                                 1454 04592000
*   END FLUSH;                      /*                               */ 04593000
*                                                                  1455 04594000
*   /*****************************************************************/ 04595000
*   /*                                                               */ 04596000
*   /* SCAN EXIT FOR THE FLUSH ROUTINE                       @Z63SP00*/ 04597000
*   /*                                                               */ 04598000
*   /*****************************************************************/ 04599000
*                                                                  1456 04600000
*RFLUSHCH:                                                         1456 04601000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                          */ 04602000
RFLUSHCH DS    0H                                                  1457 04603000
*   IF SCPPMLN=ZERO                 /* TEST FOR ZERO PASS BACK       */ 04604000
*     THEN                                                         1457 04605000
         L     @06,SCPPTR                                          1457 04606000
         ICM   @15,3,SCPPMLN(@06)                                  1457 04607000
         BNZ   @RF01457                                            1457 04608000
*     SCPPMLN=1;                    /* IF ZERO, SET TO ONE   @Z40SP00*/ 04609000
         MVC   SCPPMLN(2,@06),@CH00043                             1458 04610000
*   RETURN;                         /* RETURN TO THE SCAN ROUTINE    */ 04611000
@EL00015 DS    0H                                                  1459 04612000
@EF00015 DS    0H                                                  1459 04613000
@ER00015 BR    @14                                                 1459 04614000
*   END RFLUSHCH;                   /*                               */ 04615000
         B     @EL00015                                            1460 04616000
*                                                                  1461 04617000
*   /*****************************************************************/ 04618000
*   /*                                                               */ 04619000
*   /* ROUTINE CALLED TO CHECK MODIFIED ENTRY TO INSURE SUFFICIENT   */ 04620000
*   /* INFO IN ENTRY                                                 */ 04621000
*   /*                                                               */ 04622000
*   /*****************************************************************/ 04623000
*                                                                  1461 04624000
*CPLTCHK:                           /*                               */ 04625000
*   PROCEDURE;                      /*                               */ 04626000
CPLTCHK  STM   @14,@12,@SA00016                                    1461 04627000
*   DECLARE                         /*                               */ 04628000
*     ENTCNT FIXED(31);             /*                               */ 04629000
*/********************************************************************/ 04630000
*/*                                                                  */ 04631000
*/* SYSMOD TYPE CDS UPDATES - THE ENTRY MUST CONTAIN                 */ 04632000
*/*   1.RECDATE IF NOT DUMMY                                         */ 04633000
*/*   2.APPDATE IF CDS                                               */ 04634000
*/*   3.ACCDATE IF ACDS                                              */ 04635000
*/*   4.AT LEAST ONE SUBENTRY IF NOT DUMMY                           */ 04636000
*/*                                                                  */ 04637000
*/********************************************************************/ 04638000
*                                                                  1463 04639000
*   IF PTF=ON                       /* TEST FOR A PTF TYPE UPDATE    */ 04640000
*     THEN                          /* YES                   @VS05270*/ 04641000
         TM    PTF,B'10000000'                                     1463 04642000
         BNO   @RF01463                                            1463 04643000
*     DO;                           /*                       @OY04178*/ 04644000
*                                                                  1464 04645000
*       /*************************************************************/ 04646000
*       /*                                                           */ 04647000
*       /* RESET TYPE ENTRY INDICATORS                               */ 04648000
*       /*                                                           */ 04649000
*       /*************************************************************/ 04650000
*                                                                  1465 04651000
*       IOPDELP=OFF;                /* RESET ALL BYTES       @ZD00004*/ 04652000
*       IOPIRQP=OFF;                /*                               */ 04653000
*       IOPNPRP=OFF;                /*                               */ 04654000
*       IOPPREP=OFF;                /*                               */ 04655000
*       IOPREQP=OFF;                /*                               */ 04656000
*       IOPSUPP=OFF;                /*                               */ 04657000
         NI    IOPDELP(IOPPTR),B'00000011'                         1470 04658000
*       IOPSBYP=OFF;                /*                               */ 04659000
*       IOPDBYP=OFF;                /*                               */ 04660000
         NI    IOPSBYP(IOPPTR),B'00111111'                         1472 04661000
*       IF IOPSBYNO^=BLANK7         /* IF NO SUPBY NUMBER            */ 04662000
*         THEN                      /*                       @ZD00008*/ 04663000
         CLC   IOPSBYNO(7,IOPPTR),@CC01416                         1473 04664000
         BE    @RF01473                                            1473 04665000
*         IOPSBYP=ON;               /* SUPBY PRESENT         @ZD00008*/ 04666000
         OI    IOPSBYP(IOPPTR),B'10000000'                         1474 04667000
*       IF IOPDBYNO^=BLANK7         /* IF NO DELBY NUMBER            */ 04668000
*         THEN                      /*                               */ 04669000
@RF01473 CLC   IOPDBYNO(7,IOPPTR),@CC01416                         1475 04670000
         BE    @RF01475                                            1475 04671000
*         IOPDBYP=ON;               /* DELBY PRESENT                 */ 04672000
*                                                                  1476 04673000
         OI    IOPDBYP(IOPPTR),B'01000000'                         1476 04674000
*       /*************************************************************/ 04675000
*       /*                                                           */ 04676000
*       /* NOW CHECK AND SET DEFAULT SYSMOD TYPE FIELD               */ 04677000
*       /*                                                           */ 04678000
*       /*************************************************************/ 04679000
*                                                                  1477 04680000
*       IF IOPPTYPE=ZERO            /* IF NO TYPE                    */ 04681000
*         THEN                      /* THEN                          */ 04682000
@RF01475 CLI   IOPPTYPE(IOPPTR),0                                  1477 04683000
         BNE   @RF01477                                            1477 04684000
*         IF IOPDBYP=ON             /* IF SYSMOD DELETED THEN TYPE   */ 04685000
*           THEN                    /*                               */ 04686000
         TM    IOPDBYP(IOPPTR),B'01000000'                         1478 04687000
         BNO   @RF01478                                            1478 04688000
*           IOPPTYPE=IOPPFUNC;      /* IS FUNCTION                   */ 04689000
         MVI   IOPPTYPE(IOPPTR),X'04'                              1479 04690000
*         ELSE                      /*                               */ 04691000
*           IOPPTYPE=IOPPPTF;       /* DEFAULT IS PTF                */ 04692000
*                                                                  1480 04693000
         B     @RC01478                                            1480 04694000
@RF01478 MVI   IOPPTYPE(IOPPTR),X'03'                              1480 04695000
*       /*************************************************************/ 04696000
*       /*                                                           */ 04697000
*       /* IF SUPED ENTRY ONLY THEN ALL OK                           */ 04698000
*       /*                                                           */ 04699000
*       /*************************************************************/ 04700000
*                                                                  1481 04701000
*       SUPONLY=OFF;                /*                               */ 04702000
@RC01478 DS    0H                                                  1481 04703000
@RF01477 NI    SUPONLY,B'11111110'                                 1481 04704000
*       IF IOPSBYP=ON               /* IF SUPBY                      */ 04705000
*           &IOPPTFND(1)=IOPEOLST   /* AND HAS NO MODS       @ZD00004*/ 04706000
*         THEN                      /* THEN DUMMY SUP ONLY   @ZA14010*/ 04707000
         TM    IOPSBYP(IOPPTR),B'10000000'                         1482 04708000
         BNO   @RF01482                                            1482 04709000
         CLI   IOPPTFND(IOPPTR),255                                1482 04710000
         BNE   @RF01482                                            1482 04711000
*         DO;                       /*                               */ 04712000
*           IOPDUMMP=ON;            /* PTF IS SUPBY ONLY             */ 04713000
         OI    IOPDUMMP(IOPPTR),B'00000100'                        1484 04714000
*           SUPONLY=ON;             /*                               */ 04715000
         OI    SUPONLY,B'00000001'                                 1485 04716000
*         END;                      /*                               */ 04717000
*       IF IOPDBYP=ON               /* DELETED ARE ALSO DUMMYS       */ 04718000
*           &IOPPTFND(1)=IOPEOLST   /*                               */ 04719000
*         THEN                      /*                               */ 04720000
@RF01482 TM    IOPDBYP(IOPPTR),B'01000000'                         1487 04721000
         BNO   @RF01487                                            1487 04722000
         CLI   IOPPTFND(IOPPTR),255                                1487 04723000
         BNE   @RF01487                                            1487 04724000
*         IOPDUMMP=ON;              /*                               */ 04725000
*                                                                  1488 04726000
         OI    IOPDUMMP(IOPPTR),B'00000100'                        1488 04727000
*       /*************************************************************/ 04728000
*       /*                                                           */ 04729000
*       /* IF NOT SUPED ONLY RESET TYPE ENTRY PRESENT SW AND CHECK TO*/ 04730000
*       /* INSURE AT LEAST ONE MOD/MAC/SRC ENTRY PRESENT             */ 04731000
*       /*                                                           */ 04732000
*       /*************************************************************/ 04733000
*                                                                  1489 04734000
*       ELSE                        /*                               */ 04735000
*         DO;                       /*                               */ 04736000
         B     @RC01487                                            1489 04737000
@RF01487 DS    0H                                                  1490 04738000
*           DO PTFX=1 BY 1 WHILE    /* LOOP THRU PTF ENTRY   @ZA14010*/ 04739000
*                 IOPPTFND(PTFX)^=IOPEOLST;/* TILL END       @ZD00004*/ 04740000
         LA    @06,1                                               1490 04741000
         ST    @06,PTFX                                            1490 04742000
         B     @DE01490                                            1490 04743000
@DL01490 DS    0H                                                  1491 04744000
*             IF IOPPIND(PTFX)=IOPPREQ/* IF PTF HAS REQS     @ZA14010*/ 04745000
*               THEN                /*                       @ZA14010*/ 04746000
         L     @06,PTFX                                            1491 04747000
         MH    @06,@CH00538                                        1491 04748000
         SLR   @15,@15                                             1491 04749000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1491 04750000
         CH    @15,@CH01158                                        1491 04751000
         BNE   @RF01491                                            1491 04752000
*               IOPREQP=ON;         /* SET BIT IN STATUS     @ZD00004*/ 04753000
         OI    IOPREQP(IOPPTR),B'00001000'                         1492 04754000
*             ELSE                  /*                               */ 04755000
*               IF IOPPIND(PTFX)=IOPPPRE/* IF PTF HAS PRES   @ZD00004*/ 04756000
*                 THEN              /*                       @ZD00004*/ 04757000
         B     @RC01491                                            1493 04758000
@RF01491 L     @06,PTFX                                            1493 04759000
         MH    @06,@CH00538                                        1493 04760000
         SLR   @15,@15                                             1493 04761000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1493 04762000
         CH    @15,@CH01152                                        1493 04763000
         BNE   @RF01493                                            1493 04764000
*                 IOPPREP=ON;       /* SET BIT IN STATUS     @ZD00004*/ 04765000
         OI    IOPPREP(IOPPTR),B'00010000'                         1494 04766000
*               ELSE                /*                               */ 04767000
*                 IF IOPPIND(PTFX)=IOPPNPR/* IF PTF HAS NPRES      1495 04768000
*                                                            @ZD00004*/ 04769000
*                   THEN            /*                       @ZD00004*/ 04770000
         B     @RC01493                                            1495 04771000
@RF01493 L     @06,PTFX                                            1495 04772000
         MH    @06,@CH00538                                        1495 04773000
         SLR   @15,@15                                             1495 04774000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1495 04775000
         CH    @15,@CH01154                                        1495 04776000
         BNE   @RF01495                                            1495 04777000
*                   IOPNPRP=ON;     /* SET BIT IN STATUS     @ZD00004*/ 04778000
         OI    IOPNPRP(IOPPTR),B'00100000'                         1496 04779000
*                 ELSE              /*                               */ 04780000
*                   IF IOPPIND(PTFX)=IOPPSUPV/* IF PTF HAS SUPS    1497 04781000
*                                                            @ZD00004*/ 04782000
*                     THEN          /*                       @ZD00004*/ 04783000
         B     @RC01495                                            1497 04784000
@RF01495 L     @06,PTFX                                            1497 04785000
         MH    @06,@CH00538                                        1497 04786000
         SLR   @15,@15                                             1497 04787000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1497 04788000
         CH    @15,@CH01156                                        1497 04789000
         BNE   @RF01497                                            1497 04790000
*                     IOPSUPP=ON;   /* SET BIT IN STATUS     @ZD00004*/ 04791000
         OI    IOPSUPP(IOPPTR),B'00000100'                         1498 04792000
*                   ELSE            /*                               */ 04793000
*                     IF IOPPIND(PTFX)=IOPPIRQ/* IF PTF HAS IFREQ  1499 04794000
*                                                            @ZD00004*/ 04795000
*                       THEN        /*                       @ZD00004*/ 04796000
         B     @RC01497                                            1499 04797000
@RF01497 L     @06,PTFX                                            1499 04798000
         MH    @06,@CH00538                                        1499 04799000
         SLR   @15,@15                                             1499 04800000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1499 04801000
         CH    @15,@CH01160                                        1499 04802000
         BNE   @RF01499                                            1499 04803000
*                       IOPIRQP=ON; /* SET BIT IN STATUS     @ZD00004*/ 04804000
         OI    IOPIRQP(IOPPTR),B'01000000'                         1500 04805000
*                     ELSE          /*                               */ 04806000
*                       IF IOPPIND(PTFX)=IOPPDEL/* IF PTF HAS DELS 1501 04807000
*                                                            @ZD00004*/ 04808000
*                         THEN      /*                       @ZD00004*/ 04809000
         B     @RC01499                                            1501 04810000
@RF01499 L     @06,PTFX                                            1501 04811000
         MH    @06,@CH00538                                        1501 04812000
         SLR   @15,@15                                             1501 04813000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1501 04814000
         CH    @15,@CH01164                                        1501 04815000
         BNE   @RF01501                                            1501 04816000
*                         IOPDELP=ON;/* SET BIT IN STATUS    @ZD00004*/ 04817000
         OI    IOPDELP(IOPPTR),B'10000000'                         1502 04818000
*                       ELSE        /*                               */ 04819000
*                         IF IOPPIND(PTFX)=IOPPSBY/* IF SUPBY        */ 04820000
*                           THEN    /*                               */ 04821000
         B     @RC01501                                            1503 04822000
@RF01501 L     @06,PTFX                                            1503 04823000
         MH    @06,@CH00538                                        1503 04824000
         SLR   @15,@15                                             1503 04825000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1503 04826000
         CH    @15,@CH01168                                        1503 04827000
         BNE   @RF01503                                            1503 04828000
*                           IOPSBYP=ON;/* SET SBY PRESENT            */ 04829000
         OI    IOPSBYP(IOPPTR),B'10000000'                         1504 04830000
*           END;                    /*                       @ZA14010*/ 04831000
@RF01503 DS    0H                                                  1505 04832000
@RC01501 DS    0H                                                  1505 04833000
@RC01499 DS    0H                                                  1505 04834000
@RC01497 DS    0H                                                  1505 04835000
@RC01495 DS    0H                                                  1505 04836000
@RC01493 DS    0H                                                  1505 04837000
@RC01491 LA    @06,1                                               1505 04838000
         AL    @06,PTFX                                            1505 04839000
         ST    @06,PTFX                                            1505 04840000
@DE01490 L     @06,PTFX                                            1505 04841000
         MH    @06,@CH00538                                        1505 04842000
         SLR   @15,@15                                             1505 04843000
         IC    @15,IOPPTFND-9(@06,IOPPTR)                          1505 04844000
         CH    @15,@CH00726                                        1505 04845000
         BNE   @DL01490                                            1505 04846000
*           STOP=OFF;               /* SET TO CONTINUE LOOP          */ 04847000
         NI    STOP,B'11011111'                                    1506 04848000
*           DO PTFX=1 BY 1 WHILE(   /* LOOP THRU PTF ENTRY   @ZD00004*/ 04849000
*                 IOPPTFND(PTFX)^=IOPEOLST/* UNTIL END       @ZD00004*/ 04850000
*                 &STOP=OFF);       /* AND VALID NTRY NT FND         */ 04851000
         LA    @06,1                                               1507 04852000
         ST    @06,PTFX                                            1507 04853000
         B     @DE01507                                            1507 04854000
@DL01507 DS    0H                                                  1508 04855000
*             IF IOPPIND(PTFX)=IOPPMOD/* IF MOD                      */ 04856000
*                 |IOPPIND(PTFX)=IOPPZAP/* OR ZAP                    */ 04857000
*                 |IOPPIND(PTFX)=IOPPXPD/* OR EXPAND ZAP             */ 04858000
*                 |IOPPIND(PTFX)=IOPPMCR/* OR MAC                    */ 04859000
*                 |IOPPIND(PTFX)=IOPPMCU/* OR MACUPD                 */ 04860000
*                 |IOPPIND(PTFX)=IOPPSCR/* OR SRC                    */ 04861000
*                 |IOPPIND(PTFX)=IOPPSCU/* OR SRCUPD                 */ 04862000
*                 |IOPPIND(PTFX)=IOPPASM/* OR ASSEM                  */ 04863000
*                 |IOPPIND(PTFX)=IOPPRMOD/* OR REGRESSED MOD         */ 04864000
*                 |IOPPIND(PTFX)=IOPPRZAP/* OR REGRESSED ZAP         */ 04865000
*                 |IOPPIND(PTFX)=IOPPRXPD/* OR REGRESSED EXPAND ZAP  */ 04866000
*                 |IOPPIND(PTFX)=IOPPRMCR/* OR REGRESSED MAC         */ 04867000
*                 |IOPPIND(PTFX)=IOPPRMCU/* OR REGRESSED MACUPD      */ 04868000
*                 |IOPPIND(PTFX)=IOPPRSCR/* OR REGRESSED SRC         */ 04869000
*                 |IOPPIND(PTFX)=IOPPRSCU/* OR REGRESSED SRCUPD      */ 04870000
*               THEN                /* THEN IT IS VALID      @ZD00002*/ 04871000
         L     @06,PTFX                                            1508 04872000
         MH    @06,@CH00538                                        1508 04873000
         SLR   @15,@15                                             1508 04874000
         IC    @15,IOPPIND-9(@06,IOPPTR)                           1508 04875000
         CH    @15,@CH00043                                        1508 04876000
         BE    @RT01508                                            1508 04877000
         CH    @15,@CH00291                                        1508 04878000
         BE    @RT01508                                            1508 04879000
         CH    @15,@CH00045                                        1508 04880000
         BE    @RT01508                                            1508 04881000
         CH    @15,@CH00145                                        1508 04882000
         BE    @RT01508                                            1508 04883000
         CH    @15,@CH00061                                        1508 04884000
         BE    @RT01508                                            1508 04885000
         CH    @15,@CH00307                                        1508 04886000
         BE    @RT01508                                            1508 04887000
         CH    @15,@CH00037                                        1508 04888000
         BE    @RT01508                                            1508 04889000
         CH    @15,@CH00036                                        1508 04890000
         BE    @RT01508                                            1508 04891000
         CH    @15,@CH00618                                        1508 04892000
         BE    @RT01508                                            1508 04893000
         CH    @15,@CH00620                                        1508 04894000
         BE    @RT01508                                            1508 04895000
         CH    @15,@CH00622                                        1508 04896000
         BE    @RT01508                                            1508 04897000
         CH    @15,@CH00624                                        1508 04898000
         BE    @RT01508                                            1508 04899000
         CH    @15,@CH00626                                        1508 04900000
         BE    @RT01508                                            1508 04901000
         CH    @15,@CH00628                                        1508 04902000
         BE    @RT01508                                            1508 04903000
         CH    @15,@CH00630                                        1508 04904000
         BNE   @RF01508                                            1508 04905000
@RT01508 DS    0H                                                  1509 04906000
*               STOP=ON;            /* STOP LOOP                     */ 04907000
         OI    STOP,B'00100000'                                    1509 04908000
*           END;                    /*                               */ 04909000
@RF01508 LA    @06,1                                               1510 04910000
         AL    @06,PTFX                                            1510 04911000
         ST    @06,PTFX                                            1510 04912000
@DE01507 L     @06,PTFX                                            1510 04913000
         MH    @06,@CH00538                                        1510 04914000
         SLR   @15,@15                                             1510 04915000
         IC    @15,IOPPTFND-9(@06,IOPPTR)                          1510 04916000
         CH    @15,@CH00726                                        1510 04917000
         BE    @DC01507                                            1510 04918000
         TM    STOP,B'00100000'                                    1510 04919000
         BZ    @DL01507                                            1510 04920000
@DC01507 DS    0H                                                  1511 04921000
*           IF IOPSBYP=ON           /* IF SYSMOD HAS SUPS            */ 04922000
*               &STOP=OFF           /* AND NO ELEMENTS               */ 04923000
*               &IOPREQP=OFF        /* AND NO REQS                   */ 04924000
*               &IOPPREP=OFF        /* AND NO PRES                   */ 04925000
*               &IOPNPRP=OFF        /* AND NO NPRES                  */ 04926000
*               &IOPSUPP=OFF        /* AND NO SUPS                   */ 04927000
*               &IOPIRQP=OFF        /* AND NO IFREQS                 */ 04928000
*               &IOPDELP=OFF        /* AND NO DELETES                */ 04929000
*             THEN                  /* THEN PTF REQUIRES NO OTHER    */ 04930000
         TM    IOPSBYP(IOPPTR),B'10000000'                         1511 04931000
         BNO   @RF01511                                            1511 04932000
         TM    STOP,B'00100000'                                    1511 04933000
         BNZ   @RF01511                                            1511 04934000
         TM    IOPREQP(IOPPTR),B'11111100'                         1511 04935000
         BNZ   @RF01511                                            1511 04936000
*             SUPONLY=ON;           /* DATA                          */ 04937000
         OI    SUPONLY,B'00000001'                                 1512 04938000
*           ELSE                    /*                               */ 04939000
*             IF STOP=OFF           /* IF NO VALID ENTRY FND         */ 04940000
*               THEN                /*                               */ 04941000
         B     @RC01511                                            1513 04942000
@RF01511 TM    STOP,B'00100000'                                    1513 04943000
         BNZ   @RF01513                                            1513 04944000
*               CALL UCL257I(TXTSUBNT);/* SUBNTRY REQUIRED           */ 04945000
         LA    @01,@AL01514                                        1514 04946000
         BAL   @14,UCL257I                                         1514 04947000
*         END;                      /* END DATE AND MOD OK   @ZA14010*/ 04948000
*                                                                  1515 04949000
@RF01513 DS    0H                                                  1515 04950000
@RC01511 DS    0H                                                  1516 04951000
*       /*************************************************************/ 04952000
*       /*                                                           */ 04953000
*       /* SET TYPE SYSMOD FOR POSSIBLE MESSAGES                     */ 04954000
*       /*                                                           */ 04955000
*       /*************************************************************/ 04956000
*                                                                  1516 04957000
*       IF IOPPTYPE=IOPPPTF         /*                               */ 04958000
*         THEN                      /*                               */ 04959000
@RC01487 CLI   IOPPTYPE(IOPPTR),3                                  1516 04960000
         BNE   @RF01516                                            1516 04961000
*         TXTTYPE=TXTPTF;           /*                               */ 04962000
         MVC   TXTTYPE(8),@CC01520                                 1517 04963000
*       ELSE                        /*                               */ 04964000
*         IF IOPPTYPE=IOPPFUNC      /*                               */ 04965000
*           THEN                    /*                               */ 04966000
         B     @RC01516                                            1518 04967000
@RF01516 CLI   IOPPTYPE(IOPPTR),4                                  1518 04968000
         BNE   @RF01518                                            1518 04969000
*           TXTTYPE=TXTFUNC;        /*                               */ 04970000
         MVC   TXTTYPE(8),@CC01522                                 1519 04971000
*         ELSE                      /*                               */ 04972000
*           IF IOPPTYPE=IOPPAPAR    /*                               */ 04973000
*             THEN                  /*                               */ 04974000
         B     @RC01518                                            1520 04975000
@RF01518 CLI   IOPPTYPE(IOPPTR),2                                  1520 04976000
         BNE   @RF01520                                            1520 04977000
*             TXTTYPE=TXTAPAR;      /*                               */ 04978000
         MVC   TXTTYPE(8),@CC01524                                 1521 04979000
*           ELSE                    /*                               */ 04980000
*             TXTTYPE=TXTUSER;      /*                               */ 04981000
*                                                                  1522 04982000
         B     @RC01520                                            1522 04983000
@RF01520 MVC   TXTTYPE(8),@CC01526                                 1522 04984000
*       /*************************************************************/ 04985000
*       /*                                                           */ 04986000
*       /* IF SUPERCEDED ONLY OR DELETED THEN CHECK TO INSURE THAT NO*/ 04987000
*       /* EXTRA DATA WAS SPECIFIED                                  */ 04988000
*       /*                                                           */ 04989000
*       /*************************************************************/ 04990000
*                                                                  1523 04991000
*       IF SUPONLY=ON               /* IF SUPED ONLY                 */ 04992000
*           |IOPDBYP=ON             /* OR DELETED THEN               */ 04993000
*         THEN                      /* NO TYPE ASSOCIATED            */ 04994000
@RC01520 DS    0H                                                  1523 04995000
@RC01518 DS    0H                                                  1523 04996000
@RC01516 TM    SUPONLY,B'00000001'                                 1523 04997000
         BO    @RT01523                                            1523 04998000
         TM    IOPDBYP(IOPPTR),B'01000000'                         1523 04999000
         BNO   @RF01523                                            1523 05000000
@RT01523 DS    0H                                                  1524 05001000
*         DO;                       /*                               */ 05002000
*           IF IOPDBYP=ON           /* SET TYPE FOR MSG              */ 05003000
*             THEN                  /*                               */ 05004000
         TM    IOPDBYP(IOPPTR),B'01000000'                         1525 05005000
         BNO   @RF01525                                            1525 05006000
*             MSGPART1=TXTDELTD;    /*                               */ 05007000
         MVC   MSGPART1(16),@CC01531                               1526 05008000
*           ELSE                    /*                               */ 05009000
*             MSGPART1=TXTSUPED;    /*                               */ 05010000
         B     @RC01525                                            1527 05011000
@RF01525 MVC   MSGPART1(16),@CC01534                               1527 05012000
*           IF IOPDBYP=ON           /* IF DELETED SYSMOD             */ 05013000
*             THEN                  /*                               */ 05014000
@RC01525 TM    IOPDBYP(IOPPTR),B'01000000'                         1528 05015000
         BNO   @RF01528                                            1528 05016000
*             DO;                   /*                               */ 05017000
*               IF IOPSBYP=ON&IOPSBYNO(1)^=BLANK/* AND ALSO SUPED    */ 05018000
*                 THEN              /* WITH LAST SUP FILLED IN       */ 05019000
         TM    IOPSBYP(IOPPTR),B'10000000'                         1530 05020000
         BNO   @RF01530                                            1530 05021000
         CLI   IOPSBYNO(IOPPTR),C' '                               1530 05022000
         BE    @RF01530                                            1530 05023000
*                 CALL UCL341I(TXTDELBY,TXTLSUP);/* MUTUALLY EXC     */ 05024000
         LA    @01,@AL01531                                        1531 05025000
         BAL   @14,UCL341I                                         1531 05026000
*               IF IOPPTYPE^=IOPPFUNC/* IF NOT FUNCTION SYSMOD       */ 05027000
*                 THEN              /*                               */ 05028000
@RF01530 CLI   IOPPTYPE(IOPPTR),4                                  1532 05029000
         BE    @RF01532                                            1532 05030000
*                 CALL UCL341I(TXTDELBY,TXTTYPE);/*                  */ 05031000
         LA    @01,@AL01533                                        1533 05032000
         BAL   @14,UCL341I                                         1533 05033000
*               IF IOPPTFND(1)^=IOPEOLST/* IF ANY SUBENTRIES         */ 05034000
*                 THEN              /*                               */ 05035000
@RF01532 CLI   IOPPTFND(IOPPTR),255                                1534 05036000
         BE    @RF01534                                            1534 05037000
*                 CALL UCL402I(TXTSUBNT,MSGPART1);/*                 */ 05038000
         LA    @01,@AL01535                                        1535 05039000
         BAL   @14,UCL402I                                         1535 05040000
*             END;                  /*                               */ 05041000
@RF01534 DS    0H                                                  1537 05042000
*           IF IOPPFMID^=BLANK7     /* IF FMID SPECIFIED             */ 05043000
*             THEN                  /*                               */ 05044000
@RF01528 CLC   IOPPFMID(7,IOPPTR),@CC01416                         1537 05045000
         BE    @RF01537                                            1537 05046000
*             CALL UCL402I(TXTFMID,MSGPART1);/* INVALID              */ 05047000
         LA    @01,@AL01538                                        1538 05048000
         BAL   @14,UCL402I                                         1538 05049000
*           IF IOPRECD^=ZERO        /*                               */ 05050000
*             THEN                  /*                               */ 05051000
@RF01537 ICM   @06,7,IOPRECD(IOPPTR)                               1539 05052000
         BZ    @RF01539                                            1539 05053000
*             CALL UCL402I(TXTRECDT,MSGPART1);/*                     */ 05054000
         LA    @01,@AL01540                                        1540 05055000
         BAL   @14,UCL402I                                         1540 05056000
*           IF IOPAPPD^=ZERO        /*                               */ 05057000
*             THEN                  /*                               */ 05058000
@RF01539 ICM   @06,7,IOPAPPD(IOPPTR)                               1541 05059000
         BZ    @RF01541                                            1541 05060000
*             CALL UCL402I(TXTAPPDT,MSGPART1);/*                     */ 05061000
         LA    @01,@AL01542                                        1542 05062000
         BAL   @14,UCL402I                                         1542 05063000
*           IF IOPRSTD^=ZERO        /*                               */ 05064000
*             THEN                  /*                               */ 05065000
@RF01541 ICM   @06,7,IOPRSTD(IOPPTR)                               1543 05066000
         BZ    @RF01543                                            1543 05067000
*             CALL UCL402I(TXTRESDT,MSGPART1);/*                     */ 05068000
         LA    @01,@AL01544                                        1544 05069000
         BAL   @14,UCL402I                                         1544 05070000
*           IF IOPACCD^=ZERO        /*                               */ 05071000
*             THEN                  /*                               */ 05072000
@RF01543 ICM   @06,7,IOPACCD(IOPPTR)                               1545 05073000
         BZ    @RF01545                                            1545 05074000
*             CALL UCL402I(TXTACCDT,MSGPART1);/*                     */ 05075000
         LA    @01,@AL01546                                        1546 05076000
         BAL   @14,UCL402I                                         1546 05077000
*           IF IOPAPP=ON            /*                               */ 05078000
*               |IOPRES=ON          /*                               */ 05079000
*               |IOPACC=ON          /*                               */ 05080000
*               |IOPERROR=ON        /*                               */ 05081000
*               |IOPBYP=ON          /*                               */ 05082000
*               |IOPREGEN=ON        /*                               */ 05083000
*             THEN                  /*                               */ 05084000
@RF01545 TM    IOPAPP(IOPPTR),B'11110011'                          1547 05085000
         BZ    @RF01547                                            1547 05086000
*             CALL UCL402I(TXTSTAT,MSGPART1);/*                      */ 05087000
         LA    @01,@AL01548                                        1548 05088000
         BAL   @14,UCL402I                                         1548 05089000
*         END;                      /*                               */ 05090000
*                                                                  1549 05091000
*       /*************************************************************/ 05092000
*       /*                                                           */ 05093000
*       /* IF NOR SUPERCEDDED ONLY TYPE ENTRY THEN CHECK TO INSURE   */ 05094000
*       /* THAT ALL REQUIRED FIELDS ARE PRESENT                      */ 05095000
*       /*                                                           */ 05096000
*       /*************************************************************/ 05097000
*                                                                  1550 05098000
*       ELSE                        /*                               */ 05099000
*         DO;                       /* NOT SUPED ONLY                */ 05100000
         B     @RC01523                                            1550 05101000
@RF01523 DS    0H                                                  1551 05102000
*           IF IOPPFMID=BLANK7      /*                               */ 05103000
*             THEN                  /*                               */ 05104000
         CLC   IOPPFMID(7,IOPPTR),@CC01416                         1551 05105000
         BNE   @RF01551                                            1551 05106000
*             IF IOPPTYPE=IOPPFUNC  /* IF FUNCTION TYPE SYSMOD       */ 05107000
*               THEN                /* THEN FMID EQUALS              */ 05108000
         CLI   IOPPTYPE(IOPPTR),4                                  1552 05109000
         BNE   @RF01552                                            1552 05110000
*               IOPPFMID=IOPNAM17;  /* FUNCTION ID                   */ 05111000
         MVC   IOPPFMID(7,IOPPTR),IOPNAM17(IOPPTR)                 1553 05112000
*             ELSE                  /* FMID REQUIRED FOR ALL OTHER   */ 05113000
*               IF(ADD=ON|REP=ON)   /* IF ADD OR REP REQUEST         */ 05114000
*                   &CCAFMID^=BLANK7/* AND FMID SPECIFIED ON EXEC    */ 05115000
*                 THEN              /*                               */ 05116000
         B     @RC01552                                            1554 05117000
@RF01552 TM    ADD,B'10100000'                                     1554 05118000
         BZ    @RF01554                                            1554 05119000
         CLC   CCAFMID(7,CCAPTR),@CC01416                          1554 05120000
         BE    @RF01554                                            1554 05121000
*                 IOPPFMID=CCAFMID; /* USE THAT ONE                  */ 05122000
         MVC   IOPPFMID(7,IOPPTR),CCAFMID(CCAPTR)                  1555 05123000
*               ELSE                /*                               */ 05124000
*                 CALL UCL257I(TXTFMID);/* ELSE ERROR                */ 05125000
         B     @RC01554                                            1556 05126000
@RF01554 LA    @01,@AL01556                                        1556 05127000
         BAL   @14,UCL257I                                         1556 05128000
*           IF IOPACC=ON            /* IF ACCEPT INDICATOR           */ 05129000
*               &(IOPDSID=IOPACDS   /* FOR ACDS              @Z67SP00*/ 05130000
*               |IOPAPP=OFF)        /* OFR CDS NO APPLY      @Z67SP00*/ 05131000
*             THEN                  /* THEN MUST                     */ 05132000
@RC01554 DS    0H                                                  1557 05133000
@RC01552 DS    0H                                                  1557 05134000
@RF01551 TM    IOPACC(IOPPTR),B'00100000'                          1557 05135000
         BNO   @RF01557                                            1557 05136000
         CLI   IOPDSID(IOPPTR),12                                  1557 05137000
         BE    @RT01557                                            1557 05138000
         TM    IOPAPP(IOPPTR),B'10000000'                          1557 05139000
         BNZ   @RF01557                                            1557 05140000
@RT01557 DS    0H                                                  1558 05141000
*             IOPREGEN=ON;          /* ALSO SET REGEN                */ 05142000
         OI    IOPREGEN(IOPPTR),B'00000001'                        1558 05143000
*           IF IOPREGEN=ON          /* IF REGEN SPECIFIED            */ 05144000
*             THEN                  /* MUST ALSO SET                 */ 05145000
@RF01557 TM    IOPREGEN(IOPPTR),B'00000001'                        1559 05146000
         BNO   @RF01559                                            1559 05147000
*             IOPACC=ON;            /* ACCEPT                        */ 05148000
         OI    IOPACC(IOPPTR),B'00100000'                          1560 05149000
*           IF IOPRES=ON            /* IF RESTORE                    */ 05150000
*             THEN                  /* THEN MUST                     */ 05151000
@RF01559 TM    IOPRES(IOPPTR),B'01000000'                          1561 05152000
         BNO   @RF01561                                            1561 05153000
*             DO;                   /*                               */ 05154000
*               IOPERROR=ON;        /* SET ERROR                     */ 05155000
*               IOPAPP=ON;          /* ALSO SET APPLY                */ 05156000
         OI    IOPERROR(IOPPTR),B'10010000'                        1564 05157000
*             END;                  /*                               */ 05158000
*                                                                  1565 05159000
*           /*********************************************************/ 05160000
*           /*                                                       */ 05161000
*           /* IF DATE KEYWORD WAS ENTERED AND THE FMID EXEC PARM WAS*/ 05162000
*           /* ENTERED THEN CHECK THE TYPES OF DATES THAT SHOULD BE  */ 05163000
*           /* SET BASED ON STATUS INDICATORS                        */ 05164000
*           /*                                                       */ 05165000
*           /*********************************************************/ 05166000
*                                                                  1566 05167000
*           IF DATEENT=ON&CCAFMID(1)^=BLANK/* IF DATE AND FMID       */ 05168000
*             THEN                  /*                               */ 05169000
@RF01561 TM    DATEENT,B'00100000'                                 1566 05170000
         BNO   @RF01566                                            1566 05171000
         CLI   CCAFMID(CCAPTR),C' '                                1566 05172000
         BE    @RF01566                                            1566 05173000
*             DO;                   /*                               */ 05174000
*               IF IOPRECD(1)=ZERO  /* IF NO RECEIVED DATE           */ 05175000
*                 THEN              /*                               */ 05176000
         CLI   IOPRECD(IOPPTR),0                                   1568 05177000
         BNE   @RF01568                                            1568 05178000
*                 IOPRECD=SAVDATE;  /* PUT IN DATE VALUE             */ 05179000
         MVC   IOPRECD(3,IOPPTR),SAVDATE                           1569 05180000
*               IF IOPAPP=ON|UCLCDS=ON/* IF APPLY STATUS OR CDS      */ 05181000
*                   &IOPAPPD(1)=ZERO/* BUT NO APPLY DATE             */ 05182000
*                 THEN              /*                               */ 05183000
@RF01568 TM    IOPAPP(IOPPTR),B'10000000'                          1570 05184000
         BO    @RT01570                                            1570 05185000
         L     @06,@PC00001                                        1570 05186000
         TM    UCLCDS(@06),B'10000000'                             1570 05187000
         BNO   @RF01570                                            1570 05188000
         CLI   IOPAPPD(IOPPTR),0                                   1570 05189000
         BNE   @RF01570                                            1570 05190000
@RT01570 DS    0H                                                  1571 05191000
*                 DO;               /*                               */ 05192000
*                   IOPAPP=ON;      /*                               */ 05193000
         OI    IOPAPP(IOPPTR),B'10000000'                          1572 05194000
*                   IOPAPPD=SAVDATE;/*                               */ 05195000
         MVC   IOPAPPD(3,IOPPTR),SAVDATE                           1573 05196000
*                 END;              /*                               */ 05197000
*               IF IOPACC=ON|UCLACDS=ON/* IF ACCEPT STAUS OR ACDS    */ 05198000
*                   &IOPACCD(1)=ZERO/* BUT NO ACCEPT DATE            */ 05199000
*                 THEN              /*                               */ 05200000
@RF01570 TM    IOPACC(IOPPTR),B'00100000'                          1575 05201000
         BO    @RT01575                                            1575 05202000
         L     @06,@PC00001                                        1575 05203000
         TM    UCLACDS(@06),B'01000000'                            1575 05204000
         BNO   @RF01575                                            1575 05205000
         CLI   IOPACCD(IOPPTR),0                                   1575 05206000
         BNE   @RF01575                                            1575 05207000
@RT01575 DS    0H                                                  1576 05208000
*                 DO;               /*                               */ 05209000
*                   IOPACC=ON;      /*                               */ 05210000
         OI    IOPACC(IOPPTR),B'00100000'                          1577 05211000
*                   IOPACCD=SAVDATE;/*                               */ 05212000
         MVC   IOPACCD(3,IOPPTR),SAVDATE                           1578 05213000
*                 END;              /*                               */ 05214000
*               IF IOPRES=ON&IOPRSTD(1)=ZERO/* RES NOT DATE          */ 05215000
*                 THEN              /*                               */ 05216000
@RF01575 TM    IOPRES(IOPPTR),B'01000000'                          1580 05217000
         BNO   @RF01580                                            1580 05218000
         CLI   IOPRSTD(IOPPTR),0                                   1580 05219000
         BNE   @RF01580                                            1580 05220000
*                 IOPRSTD=SAVDATE;  /*                               */ 05221000
         MVC   IOPRSTD(3,IOPPTR),SAVDATE                           1581 05222000
*             END;                  /*                               */ 05223000
*                                                                  1582 05224000
@RF01580 DS    0H                                                  1583 05225000
*           /*********************************************************/ 05226000
*           /*                                                       */ 05227000
*           /* NOW CHECK FOR MISSING DATE FIELDS BASED ON STATUS     */ 05228000
*           /* INDICATORS ON CDS SYSMOD ENTRY                        */ 05229000
*           /*                                                       */ 05230000
*           /*********************************************************/ 05231000
*                                                                  1583 05232000
*           IF IOPRECD(1)=ZERO      /* IF NO DATE                    */ 05233000
*             THEN                  /* SOME THERE            @VS05270*/ 05234000
@RF01566 CLI   IOPRECD(IOPPTR),0                                   1583 05235000
         BNE   @RF01583                                            1583 05236000
*             CALL UCL257I(TXTRECDT);/* DATE REQUIRED                */ 05237000
         LA    @01,@AL01584                                        1584 05238000
         BAL   @14,UCL257I                                         1584 05239000
*           IF IOPACCD=ZERO         /* IF NO ACCEPT DATE             */ 05240000
*             THEN                  /*                               */ 05241000
@RF01583 ICM   @06,7,IOPACCD(IOPPTR)                               1585 05242000
         BNZ   @RF01585                                            1585 05243000
*             DO;                   /*                               */ 05244000
*               IF UCLACDS=ON|IOPACC=ON/* IF ACDS OR ACCEPT STATUS   */ 05245000
*                 THEN              /*                               */ 05246000
         L     @06,@PC00001                                        1587 05247000
         TM    UCLACDS(@06),B'01000000'                            1587 05248000
         BO    @RT01587                                            1587 05249000
         TM    IOPACC(IOPPTR),B'00100000'                          1587 05250000
         BNO   @RF01587                                            1587 05251000
@RT01587 DS    0H                                                  1588 05252000
*                 CALL UCL257I(TXTACCDT);/*                          */ 05253000
         LA    @01,@AL01588                                        1588 05254000
         BAL   @14,UCL257I                                         1588 05255000
*             END;                  /*                               */ 05256000
*           ELSE                    /* IF ACCDATE SPECIFIED THEN     */ 05257000
*             IOPACC=ON;            /* ASSUME ACC STATUS ALSO        */ 05258000
         B     @RC01585                                            1590 05259000
@RF01585 OI    IOPACC(IOPPTR),B'00100000'                          1590 05260000
*           IF IOPRSTD=ZERO         /* IF NO RESTORE DATE BUT HAVE   */ 05261000
*             THEN                  /*                               */ 05262000
@RC01585 ICM   @06,7,IOPRSTD(IOPPTR)                               1591 05263000
         BNZ   @RF01591                                            1591 05264000
*             DO;                   /*                               */ 05265000
*               IF IOPRES=ON        /*                               */ 05266000
*                 THEN              /*                               */ 05267000
         TM    IOPRES(IOPPTR),B'01000000'                          1593 05268000
         BNO   @RF01593                                            1593 05269000
*                 CALL UCL257I(TXTRESDT);/* NEED RESTORE DATE        */ 05270000
         LA    @01,@AL01594                                        1594 05271000
         BAL   @14,UCL257I                                         1594 05272000
*             END;                  /*                               */ 05273000
*           ELSE                    /*                               */ 05274000
*             DO;                   /*                               */ 05275000
         B     @RC01591                                            1596 05276000
@RF01591 DS    0H                                                  1597 05277000
*               IOPRES=ON;          /*                               */ 05278000
*               IOPAPP=ON;          /*                               */ 05279000
*               IOPERROR=ON;        /*                               */ 05280000
         OI    IOPRES(IOPPTR),B'11010000'                          1599 05281000
*             END;                  /*                               */ 05282000
*           IF IOPAPPD=ZERO         /* IF NO APPLY DATE              */ 05283000
*             THEN                  /*                               */ 05284000
@RC01591 ICM   @06,7,IOPAPPD(IOPPTR)                               1601 05285000
         BNZ   @RF01601                                            1601 05286000
*             DO;                   /*                               */ 05287000
*               IF UCLCDS=ON|IOPAPP=ON/* IF CDS OF APPLY SPECIFIED   */ 05288000
*                 THEN              /*                               */ 05289000
         L     @06,@PC00001                                        1603 05290000
         TM    UCLCDS(@06),B'10000000'                             1603 05291000
         BO    @RT01603                                            1603 05292000
         TM    IOPAPP(IOPPTR),B'10000000'                          1603 05293000
         BNO   @RF01603                                            1603 05294000
@RT01603 DS    0H                                                  1604 05295000
*                 CALL UCL257I(TXTAPPDT);/*                          */ 05296000
         LA    @01,@AL01604                                        1604 05297000
         BAL   @14,UCL257I                                         1604 05298000
*             END;                  /*                               */ 05299000
*           ELSE                    /* IF APPDATE SPECIFIED          */ 05300000
*             IOPAPP=ON;            /* THEN ASSUME APPLY STATUS ALSO */ 05301000
         B     @RC01601                                            1606 05302000
@RF01601 OI    IOPAPP(IOPPTR),B'10000000'                          1606 05303000
*           IF IOPAPPD^=ZERO        /* IF APPLY DATE                 */ 05304000
*               &IOPAPP=OFF         /* BUT NOT APPLY STATUS          */ 05305000
*             THEN                  /*                               */ 05306000
@RC01601 ICM   @06,7,IOPAPPD(IOPPTR)                               1607 05307000
         BZ    @RF01607                                            1607 05308000
         TM    IOPAPP(IOPPTR),B'10000000'                          1607 05309000
         BNZ   @RF01607                                            1607 05310000
*             CALL UCL257I(TXTAPPST);/* NEED APPLY STATUS            */ 05311000
         LA    @01,@AL01608                                        1608 05312000
         BAL   @14,UCL257I                                         1608 05313000
*           IF IOPACCD^=ZERO        /* IF ACCEPT DATE                */ 05314000
*               &IOPACC=OFF         /* BUT NOT ACCEPT STATUS         */ 05315000
*             THEN                  /*                               */ 05316000
@RF01607 ICM   @06,7,IOPACCD(IOPPTR)                               1609 05317000
         BZ    @RF01609                                            1609 05318000
         TM    IOPACC(IOPPTR),B'00100000'                          1609 05319000
         BNZ   @RF01609                                            1609 05320000
*             CALL UCL257I(TXTACCST);/* NEED ACCEPT STATUS           */ 05321000
         LA    @01,@AL01610                                        1610 05322000
         BAL   @14,UCL257I                                         1610 05323000
*         END;                      /*                               */ 05324000
*                                                                  1611 05325000
@RF01609 DS    0H                                                  1612 05326000
*       /*************************************************************/ 05327000
*       /*                                                           */ 05328000
*       /* CHECK FOR INVALID COMBINATIONS OK KEYWORD                 */ 05329000
*       /*                                                           */ 05330000
*       /*************************************************************/ 05331000
*                                                                  1612 05332000
*       IF IOPNPRP=ON               /* IF NPRES                      */ 05333000
*           &IOPPTYPE^=IOPPFUNC     /* NOT FOR FUNCTION              */ 05334000
*         THEN                      /*                               */ 05335000
@RC01523 TM    IOPNPRP(IOPPTR),B'00100000'                         1612 05336000
         BNO   @RF01612                                            1612 05337000
         CLI   IOPPTYPE(IOPPTR),4                                  1612 05338000
         BE    @RF01612                                            1612 05339000
*         CALL UCL341I(TXTNPRE,TXTTYPE);/* MUTUALLY EXCLUSIVE        */ 05340000
         LA    @01,@AL01613                                        1613 05341000
         BAL   @14,UCL341I                                         1613 05342000
*       IF IOPDELP=ON               /* IF NPRES                      */ 05343000
*           &IOPPTYPE^=IOPPFUNC     /* NOT FOR FUNCTION              */ 05344000
*         THEN                      /*                               */ 05345000
@RF01612 TM    IOPDELP(IOPPTR),B'10000000'                         1614 05346000
         BNO   @RF01614                                            1614 05347000
         CLI   IOPPTYPE(IOPPTR),4                                  1614 05348000
         BE    @RF01614                                            1614 05349000
*         CALL UCL341I(TXTDELBY,TXTTYPE);/* MUTUALLY EXCLUSIVE       */ 05350000
         LA    @01,@AL01615                                        1615 05351000
         BAL   @14,UCL341I                                         1615 05352000
*       IOPUCLD=CCADATE;            /* SET UCL DATE AND TIME         */ 05353000
@RF01614 MVC   IOPUCLD(3,IOPPTR),CCADATE(CCAPTR)                   1616 05354000
*       IOPUCLT=CCATIME;            /*                               */ 05355000
         MVC   IOPUCLT(3,IOPPTR),CCATIME(CCAPTR)                   1617 05356000
*     END;                          /* END PTF SECTION       @OY04178*/ 05357000
*                                                                  1619 05358000
*/********************************************************************/ 05359000
*/*                                                                  */ 05360000
*/*    MODULE TYPE UPDATE - THE ENTRY MUST CONTAIN AT LEAST  @Z63SP00*/ 05361000
*/*         1. DISTRIBUTION LIBRARY                          @Z63SP00*/ 05362000
*/*                                                                  */ 05363000
*/********************************************************************/ 05364000
*                                                                  1619 05365000
*   IF CSECT=ON                     /* TEST FOR A MODULE TYPE UPDATE */ 05366000
*     THEN                          /* YES - MODULE UPDATE   @Z63SP00*/ 05367000
@RF01463 TM    CSECT,B'01000000'                                   1619 05368000
         BNO   @RF01619                                            1619 05369000
*     DO;                                                          1620 05370000
*       IF IOPFMID=BLANK7           /* IF NO FMID IN ENTRY           */ 05371000
*           &(ADD=ON|REP=ON)        /* AND ADD OR REP                */ 05372000
*           &CCAFMID^=BLANK7        /* AND FMID SPECIFIED ON EXEC    */ 05373000
*         THEN                      /* THEN USE                      */ 05374000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          1621 05375000
         BNE   @RF01621                                            1621 05376000
         TM    ADD,B'10100000'                                     1621 05377000
         BZ    @RF01621                                            1621 05378000
         CLC   CCAFMID(7,CCAPTR),@CC01416                          1621 05379000
         BE    @RF01621                                            1621 05380000
*         IOPFMID=CCAFMID;          /* IT IN ENTRY                   */ 05381000
         MVC   IOPFMID(7,IOPPTR),CCAFMID(CCAPTR)                   1622 05382000
*       IF IOPFMID=BLANK7           /* IF NO FMID VALUE              */ 05383000
*           &(UCLACDS=ON            /* FOR ACDS                      */ 05384000
*           |(UCLCDS=ON&TOTAL=ON))  /* IF ADDING NEW CDS ENTRY       */ 05385000
*         THEN                      /* THEN                          */ 05386000
@RF01621 CLC   IOPFMID(7,IOPPTR),@CC01416                          1623 05387000
         BNE   @RF01623                                            1623 05388000
         L     @06,@PC00001                                        1623 05389000
         TM    UCLACDS(@06),B'01000000'                            1623 05390000
         BO    @RT01623                                            1623 05391000
         TM    UCLCDS(@06),B'10000000'                             1623 05392000
         BNO   @RF01623                                            1623 05393000
         TM    TOTAL,B'00010000'                                   1623 05394000
         BNO   @RF01623                                            1623 05395000
@RT01623 DS    0H                                                  1624 05396000
*         CALL UCL257I(TXTFMID);    /* ISSUE ERROR MSG               */ 05397000
         LA    @01,@AL01624                                        1624 05398000
         BAL   @14,UCL257I                                         1624 05399000
*       IF IOPRMID=BLANK7           /* IF NO RMID                    */ 05400000
*           &IOPFMID^=BLANK7        /* AND FMID SPECIFIED            */ 05401000
*         THEN                      /*                               */ 05402000
@RF01623 CLC   IOPRMID(7,IOPPTR),@CC01416                          1625 05403000
         BNE   @RF01625                                            1625 05404000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          1625 05405000
         BE    @RF01625                                            1625 05406000
*         IOPRMID=IOPFMID;          /* FMID ALSO RMID                */ 05407000
         MVC   IOPRMID(7,IOPPTR),IOPFMID(IOPPTR)                   1626 05408000
*       IF IOPDLIB=BLANK8           /* IF NO DLIB PRESENT            */ 05409000
*         THEN                                                     1627 05410000
@RF01625 CLC   IOPDLIB(8,IOPPTR),BLANK8                            1627 05411000
         BNE   @RF01627                                            1627 05412000
*         CALL UCL257I(TXTDIST);    /* DISTLIB REQUIRED              */ 05413000
         LA    @01,@AL01628                                        1628 05414000
         BAL   @14,UCL257I                                         1628 05415000
*     END;                                                         1629 05416000
@RF01627 DS    0H                                                  1630 05417000
*                                                                  1630 05418000
*/********************************************************************/ 05419000
*/*                                                                  */ 05420000
*/*    LOAD MODULE TYPE CDS UPDATES -- THE ENTRY MUST CONTAIN AT     */ 05421000
*/*    LEAST                                                 @Z63SP00*/ 05422000
*/*         1. ONE SYSTEM LIBRARY NAME                       @Z63SP00*/ 05423000
*/*                                                                  */ 05424000
*/********************************************************************/ 05425000
*                                                                  1630 05426000
*   IF LMOD=ON                      /* LOAD MODULE TYPE UPDATE ?     */ 05427000
*     THEN                          /* YES - CHECK THE DATA GIVEN    */ 05428000
@RF01619 TM    LMOD,B'00100000'                                    1630 05429000
         BNO   @RF01630                                            1630 05430000
*     DO;                           /*                       @ZD00004*/ 05431000
*       IF IOPLMDND(1)=IOPEOLST     /* IF NO SYSLIBS                 */ 05432000
*         THEN                                                     1632 05433000
         CLI   IOPLMDND(IOPPTR),255                                1632 05434000
         BNE   @RF01632                                            1632 05435000
*         CALL UCL257I(TXTSYSLB);   /* SYSLIB REQUIRED               */ 05436000
         LA    @01,@AL01633                                        1633 05437000
         BAL   @14,UCL257I                                         1633 05438000
*       ENTCNT=ZERO;                /*                               */ 05439000
@RF01632 SLR   @06,@06                                             1634 05440000
         ST    @06,ENTCNT                                          1634 05441000
*       DO LOOPINDX=1 BY 1 WHILE(   /* LOOP THRU SUBENTRIES          */ 05442000
*             IOPLMDND(LOOPINDX)^=IOPEOLST);/*                       */ 05443000
         LA    @06,1                                               1635 05444000
         ST    @06,LOOPINDX                                        1635 05445000
         B     @DE01635                                            1635 05446000
@DL01635 DS    0H                                                  1636 05447000
*         IF IOPLMIND(LOOPINDX)=IOPLMSYS/* IF SYSLIB                 */ 05448000
*           THEN                    /*                               */ 05449000
         LA    @06,1                                               1636 05450000
         L     @15,LOOPINDX                                        1636 05451000
         MH    @15,@CH00538                                        1636 05452000
         SLR   @14,@14                                             1636 05453000
         IC    @14,IOPLMIND-9(@15,IOPPTR)                          1636 05454000
         CR    @06,@14                                             1636 05455000
         BNE   @RF01636                                            1636 05456000
*           DO;                     /*                               */ 05457000
*             ENTCNT=ENTCNT+1;      /* BUMP COUNTER                  */ 05458000
         AL    @06,ENTCNT                                          1638 05459000
         ST    @06,ENTCNT                                          1638 05460000
*             IF ENTCNT>IOPLSMAX    /* IF GREATER THAN MAX SYSLIBS   */ 05461000
*               THEN                /*                               */ 05462000
         CH    @06,@CH00291                                        1639 05463000
         BNH   @RF01639                                            1639 05464000
*               DO;                 /*                               */ 05465000
*                 MSGPART1=TXTSYSLB;/*                               */ 05466000
         MVI   MSGPART1+8,C' '                                     1641 05467000
         MVC   MSGPART1+9(7),MSGPART1+8                            1641 05468000
         MVC   MSGPART1(8),@CC01547                                1641 05469000
*                 MSGPART2=IOPSYSLB(LOOPINDX);/*                     */ 05470000
         MVI   MSGPART2+8,C' '                                     1642 05471000
         MVC   MSGPART2+9(7),MSGPART2+8                            1642 05472000
         ALR   @15,IOPPTR                                          1642 05473000
         MVC   MSGPART2(8),IOPSYSLB-9(@15)                         1642 05474000
*                 CALL UCL259I;     /*                               */ 05475000
         BAL   @14,UCL259I                                         1643 05476000
*               END;                /*                               */ 05477000
*           END;                    /*                               */ 05478000
@RF01639 DS    0H                                                  1646 05479000
*       END;                        /*                               */ 05480000
@RF01636 LA    @06,1                                               1646 05481000
         AL    @06,LOOPINDX                                        1646 05482000
         ST    @06,LOOPINDX                                        1646 05483000
@DE01635 L     @06,LOOPINDX                                        1646 05484000
         MH    @06,@CH00538                                        1646 05485000
         SLR   @15,@15                                             1646 05486000
         IC    @15,IOPLMDND-9(@06,IOPPTR)                          1646 05487000
         CH    @15,@CH00726                                        1646 05488000
         BNE   @DL01635                                            1646 05489000
*       IF IOPAPF=ON                /* IF ANY LINEK EDIT             */ 05490000
*           |IOPRENT=ON             /* IS ON THEN                    */ 05491000
*           |IOPREUS=ON             /*                               */ 05492000
*           |IOPSCTR=ON             /*                               */ 05493000
*           |IOPOVLY=ON             /*                               */ 05494000
*           |IOPREFR=ON             /*                               */ 05495000
*           |IOPDC=ON               /*                               */ 05496000
*           |IOPNE=ON               /*                               */ 05497000
*           |IOPPAGA=ON             /*                               */ 05498000
*         THEN                      /*                               */ 05499000
         TM    IOPAPF(IOPPTR),B'11111110'                          1647 05500000
         BNZ   @RT01647                                            1647 05501000
         TM    IOPNE(IOPPTR),B'11000000'                           1647 05502000
         BZ    @RF01647                                            1647 05503000
@RT01647 DS    0H                                                  1648 05504000
*         IOPLINK=ON;               /* SET LINK OBTAINED             */ 05505000
         OI    IOPLINK(IOPPTR),B'01000000'                         1648 05506000
*     END;                          /*                       @ZD00004*/ 05507000
@RF01647 DS    0H                                                  1650 05508000
*                                                                  1650 05509000
*/********************************************************************/ 05510000
*/*                                                                  */ 05511000
*/*  MACRO TYPE CDS UPDATES HAVE NO REQUIRED FIELDS                  */ 05512000
*/*      1. BUT MUST CHECK FOR MISSING FMID AND USE EXEC ONE         */ 05513000
*/*                                                                  */ 05514000
*/********************************************************************/ 05515000
*                                                                  1650 05516000
*   IF MACRO=ON                     /* MAC TYPE UPDATE ?             */ 05517000
*     THEN                                                         1650 05518000
@RF01630 TM    MACRO,B'00010000'                                   1650 05519000
         BNO   @RF01650                                            1650 05520000
*     DO;                                                          1651 05521000
*       IF IOPFMID=BLANK7           /* IF NO FMID IN ENTRY           */ 05522000
*           &(ADD=ON|REP=ON)        /* AND ADD OR REP                */ 05523000
*           &CCAFMID^=BLANK7        /* AND FMID SPECIFIED ON EXEC    */ 05524000
*         THEN                      /* THEN USE                      */ 05525000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          1652 05526000
         BNE   @RF01652                                            1652 05527000
         TM    ADD,B'10100000'                                     1652 05528000
         BZ    @RF01652                                            1652 05529000
         CLC   CCAFMID(7,CCAPTR),@CC01416                          1652 05530000
         BE    @RF01652                                            1652 05531000
*         IOPFMID=CCAFMID;          /* IT IN ENTRY                   */ 05532000
         MVC   IOPFMID(7,IOPPTR),CCAFMID(CCAPTR)                   1653 05533000
*       IF IOPFMID=BLANK7           /* IF NO FMID VALUE              */ 05534000
*           &(UCLACDS=ON            /* FOR ACDS                      */ 05535000
*           |(UCLCDS=ON&TOTAL=ON))  /* IF ADDING NEW CDS ENTRY       */ 05536000
*         THEN                      /* THEN                          */ 05537000
@RF01652 CLC   IOPFMID(7,IOPPTR),@CC01416                          1654 05538000
         BNE   @RF01654                                            1654 05539000
         L     @06,@PC00001                                        1654 05540000
         TM    UCLACDS(@06),B'01000000'                            1654 05541000
         BO    @RT01654                                            1654 05542000
         TM    UCLCDS(@06),B'10000000'                             1654 05543000
         BNO   @RF01654                                            1654 05544000
         TM    TOTAL,B'00010000'                                   1654 05545000
         BNO   @RF01654                                            1654 05546000
@RT01654 DS    0H                                                  1655 05547000
*         CALL UCL257I(TXTFMID);    /* ISSUE ERROR MSG               */ 05548000
         LA    @01,@AL01655                                        1655 05549000
         BAL   @14,UCL257I                                         1655 05550000
*       IF IOPRMID=BLANK7           /* IF NO RMID                    */ 05551000
*           &IOPFMID^=BLANK7        /* AND FMID SPECIFIED            */ 05552000
*         THEN                      /*                               */ 05553000
@RF01654 CLC   IOPRMID(7,IOPPTR),@CC01416                          1656 05554000
         BNE   @RF01656                                            1656 05555000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          1656 05556000
         BE    @RF01656                                            1656 05557000
*         IOPRMID=IOPFMID;          /* FMID ALSO RMID                */ 05558000
         MVC   IOPRMID(7,IOPPTR),IOPFMID(IOPPTR)                   1657 05559000
*       IF IOPDLIB=BLANK8           /* IF DLIB NOT IN ENTRY          */ 05560000
*           &UCLACDS=ON             /* FOR ACDS                      */ 05561000
*         THEN                      /*                               */ 05562000
@RF01656 CLC   IOPDLIB(8,IOPPTR),BLANK8                            1658 05563000
         BNE   @RF01658                                            1658 05564000
         L     @06,@PC00001                                        1658 05565000
         TM    UCLACDS(@06),B'01000000'                            1658 05566000
         BNO   @RF01658                                            1658 05567000
*         CALL UCL257I(TXTDIST);    /*                               */ 05568000
         LA    @01,@AL01659                                        1659 05569000
         BAL   @14,UCL257I                                         1659 05570000
*     END;                                                         1660 05571000
*                                                                  1660 05572000
@RF01658 DS    0H                                                  1661 05573000
*/********************************************************************/ 05574000
*/*                                                                  */ 05575000
*/*  SOURCE TYPE CDS UPDATES - THE ENTRY MUST CONTAIN                */ 05576000
*/*     1. - DISTLIB DATA SET DD NAME                                */ 05577000
*/*                                                                  */ 05578000
*/********************************************************************/ 05579000
*                                                                  1661 05580000
*   IF SRC=ON                       /* SRC TYPE UPDATE ?             */ 05581000
*     THEN                                                         1661 05582000
@RF01650 TM    SRC,B'00000010'                                     1661 05583000
         BNO   @RF01661                                            1661 05584000
*     DO;                                                          1662 05585000
*       IF IOPFMID=BLANK7           /* IF NO FMID IN ENTRY           */ 05586000
*           &(ADD=ON|REP=ON)        /* AND ADD OR REP                */ 05587000
*           &CCAFMID^=BLANK7        /* AND FMID SPECIFIED ON EXEC    */ 05588000
*         THEN                      /* THEN USE                      */ 05589000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          1663 05590000
         BNE   @RF01663                                            1663 05591000
         TM    ADD,B'10100000'                                     1663 05592000
         BZ    @RF01663                                            1663 05593000
         CLC   CCAFMID(7,CCAPTR),@CC01416                          1663 05594000
         BE    @RF01663                                            1663 05595000
*         IOPFMID=CCAFMID;          /* IT IN ENTRY                   */ 05596000
         MVC   IOPFMID(7,IOPPTR),CCAFMID(CCAPTR)                   1664 05597000
*       IF IOPFMID=BLANK7           /* IF NO FMID VALUE              */ 05598000
*           &(UCLACDS=ON            /* FOR ACDS                      */ 05599000
*           |(UCLCDS=ON&TOTAL=ON))  /* IF ADDING NEW CDS ENTRY       */ 05600000
*         THEN                      /* THEN                          */ 05601000
@RF01663 CLC   IOPFMID(7,IOPPTR),@CC01416                          1665 05602000
         BNE   @RF01665                                            1665 05603000
         L     @06,@PC00001                                        1665 05604000
         TM    UCLACDS(@06),B'01000000'                            1665 05605000
         BO    @RT01665                                            1665 05606000
         TM    UCLCDS(@06),B'10000000'                             1665 05607000
         BNO   @RF01665                                            1665 05608000
         TM    TOTAL,B'00010000'                                   1665 05609000
         BNO   @RF01665                                            1665 05610000
@RT01665 DS    0H                                                  1666 05611000
*         CALL UCL257I(TXTFMID);    /* ISSUE ERROR MSG               */ 05612000
         LA    @01,@AL01666                                        1666 05613000
         BAL   @14,UCL257I                                         1666 05614000
*       IF IOPRMID=BLANK7           /* IF NO RMID                    */ 05615000
*           &IOPFMID^=BLANK7        /* AND FMID SPECIFIED            */ 05616000
*         THEN                      /*                               */ 05617000
@RF01665 CLC   IOPRMID(7,IOPPTR),@CC01416                          1667 05618000
         BNE   @RF01667                                            1667 05619000
         CLC   IOPFMID(7,IOPPTR),@CC01416                          1667 05620000
         BE    @RF01667                                            1667 05621000
*         IOPRMID=IOPFMID;          /* FMID ALSO RMID                */ 05622000
         MVC   IOPRMID(7,IOPPTR),IOPFMID(IOPPTR)                   1668 05623000
*       IF IOPDLIB=BLANK8           /* IF DLIB NOT IN ENTRY          */ 05624000
*         THEN                      /*                               */ 05625000
@RF01667 CLC   IOPDLIB(8,IOPPTR),BLANK8                            1669 05626000
         BNE   @RF01669                                            1669 05627000
*         CALL UCL257I(TXTDIST);    /*                               */ 05628000
         LA    @01,@AL01670                                        1670 05629000
         BAL   @14,UCL257I                                         1670 05630000
*     END;                                                         1671 05631000
@RF01669 DS    0H                                                  1672 05632000
*                                                                  1672 05633000
*/********************************************************************/ 05634000
*/*                                                                  */ 05635000
*/* DLIB TYPE CDS UPDATE - THE ENTRY MUST CONTAIN            @Z63SP00*/ 05636000
*/*    1. AT LEAST ONE SYSTEM LIBRARY                        @Z63SP00*/ 05637000
*/*                                                                  */ 05638000
*/********************************************************************/ 05639000
*                                                                  1672 05640000
*   IF DLIB=ON                      /* DLIB TYPE OPERATION ? @Z63SP00*/ 05641000
*     THEN                                                         1672 05642000
@RF01661 TM    DLIB,B'00001000'                                    1672 05643000
         BNO   @RF01672                                            1672 05644000
*     DO;                           /*                       @ZD00004*/ 05645000
*       IOPNTLVL=IOPDLBLC;          /* SET ENTRY LEVEL       @ZD00004*/ 05646000
         MVI   IOPNTLVL(IOPPTR),X'02'                              1674 05647000
*       IF IOPDLBND(1)=IOPEOLST     /* IF NO SYSLIBS                 */ 05648000
*         THEN                      /*                               */ 05649000
         CLI   IOPDLBND(IOPPTR),255                                1675 05650000
         BNE   @RF01675                                            1675 05651000
*         CALL UCL257I(TXTSYSLB);   /*                               */ 05652000
         LA    @01,@AL01676                                        1676 05653000
         BAL   @14,UCL257I                                         1676 05654000
*       ENTCNT=ZERO;                /*                               */ 05655000
@RF01675 SLR   @06,@06                                             1677 05656000
         ST    @06,ENTCNT                                          1677 05657000
*       DO LOOPINDX=1 BY 1 WHILE(   /* LOOP THRU SUBENTRIES          */ 05658000
*             IOPDLBND(LOOPINDX)^=IOPEOLST);/*                       */ 05659000
         LA    @06,1                                               1678 05660000
         ST    @06,LOOPINDX                                        1678 05661000
         B     @DE01678                                            1678 05662000
@DL01678 DS    0H                                                  1679 05663000
*         IF IOPDLIND(LOOPINDX)=IOPDLSYS/* IF SYSLIB                 */ 05664000
*           THEN                    /*                               */ 05665000
         LA    @06,1                                               1679 05666000
         L     @15,LOOPINDX                                        1679 05667000
         MH    @15,@CH00538                                        1679 05668000
         SLR   @14,@14                                             1679 05669000
         IC    @14,IOPDLIND-9(@15,IOPPTR)                          1679 05670000
         CR    @06,@14                                             1679 05671000
         BNE   @RF01679                                            1679 05672000
*           DO;                     /*                               */ 05673000
*             ENTCNT=ENTCNT+1;      /* BUMP COUNTER                  */ 05674000
         AL    @06,ENTCNT                                          1681 05675000
         ST    @06,ENTCNT                                          1681 05676000
*             IF ENTCNT>IOPDSMAX    /* IF GREATER THAN MAX SYSLIBS   */ 05677000
*               THEN                /*                               */ 05678000
         CH    @06,@CH00291                                        1682 05679000
         BNH   @RF01682                                            1682 05680000
*               DO;                 /*                               */ 05681000
*                 MSGPART1=TXTSYSLB;/*                               */ 05682000
         MVI   MSGPART1+8,C' '                                     1684 05683000
         MVC   MSGPART1+9(7),MSGPART1+8                            1684 05684000
         MVC   MSGPART1(8),@CC01547                                1684 05685000
*                 MSGPART2=IOPDSYS(LOOPINDX);/*                      */ 05686000
         MVI   MSGPART2+8,C' '                                     1685 05687000
         MVC   MSGPART2+9(7),MSGPART2+8                            1685 05688000
         ALR   @15,IOPPTR                                          1685 05689000
         MVC   MSGPART2(8),IOPDSYS-9(@15)                          1685 05690000
*                 CALL UCL259I;     /*                               */ 05691000
         BAL   @14,UCL259I                                         1686 05692000
*               END;                /*                               */ 05693000
*           END;                    /*                               */ 05694000
@RF01682 DS    0H                                                  1689 05695000
*       END;                        /*                               */ 05696000
@RF01679 LA    @06,1                                               1689 05697000
         AL    @06,LOOPINDX                                        1689 05698000
         ST    @06,LOOPINDX                                        1689 05699000
@DE01678 L     @06,LOOPINDX                                        1689 05700000
         MH    @06,@CH00538                                        1689 05701000
         SLR   @15,@15                                             1689 05702000
         IC    @15,IOPDLBND-9(@06,IOPPTR)                          1689 05703000
         CH    @15,@CH00726                                        1689 05704000
         BNE   @DL01678                                            1689 05705000
*     END;                          /*                       @ZD00004*/ 05706000
*                                                                  1691 05707000
*   /*****************************************************************/ 05708000
*   /*                                                               */ 05709000
*   /* CDS SYSTEM ENTRY UPDATE - CHECK FOR BOTH SREL AND NUCID       */ 05710000
*   /*                                                               */ 05711000
*   /*****************************************************************/ 05712000
*                                                                  1691 05713000
*   IF SYS=ON                       /* SYSTEM UPDATE ?       @Z63SP00*/ 05714000
*     THEN                                                         1691 05715000
@RF01672 TM    SYS,B'00000100'                                     1691 05716000
         BNO   @RF01691                                            1691 05717000
*     DO;                           /*                               */ 05718000
*       IOPNTLVL=IOPSYSLC;          /* SET ENTRY LEVEL       @ZD00004*/ 05719000
         MVI   IOPNTLVL(IOPPTR),X'02'                              1693 05720000
*       IOPSCNVL=IOPSCNVC;          /* SET CONVERSION LEVEL  @ZD00004*/ 05721000
         MVI   IOPSCNVL(IOPPTR),X'02'                              1694 05722000
*       IF IOPSREL=BLANK4           /* IF NO SREL                    */ 05723000
*         THEN                                                     1695 05724000
         CLC   IOPSREL(4,IOPPTR),@CC01418                          1695 05725000
         BNE   @RF01695                                            1695 05726000
*         CALL UCL257I(TXTSREL);    /* SREL REQUIRED                 */ 05727000
         LA    @01,@AL01696                                        1696 05728000
         BAL   @14,UCL257I                                         1696 05729000
*       IF IOPNUCID=BLANK           /* IF NO NUCID                   */ 05730000
*         THEN                                                     1697 05731000
@RF01695 CLI   IOPNUCID(IOPPTR),C' '                               1697 05732000
         BNE   @RF01697                                            1697 05733000
*         CALL UCL257I(TXTNUCID);   /* NUCID REQUIED                 */ 05734000
         LA    @01,@AL01698                                        1698 05735000
         BAL   @14,UCL257I                                         1698 05736000
*       IF IOPSYSID=BLANK8          /* IF NO SYSTEM ID               */ 05737000
*         THEN                      /*                               */ 05738000
@RF01697 CLC   IOPSYSID(8,IOPPTR),BLANK8                           1699 05739000
         BNE   @RF01699                                            1699 05740000
*         CALL UCL257I(TXTCDSID);   /* SYS ID                        */ 05741000
         LA    @01,@AL01700                                        1700 05742000
         BAL   @14,UCL257I                                         1700 05743000
*     END;                          /*                               */ 05744000
@RF01699 DS    0H                                                  1702 05745000
*   RETURN CODE(ZERO);              /*                               */ 05746000
@RF01691 SLR   @15,@15                                             1702 05747000
         L     @14,@SA00016                                        1702 05748000
         LM    @00,@12,@SA00016+8                                  1702 05749000
         BR    @14                                                 1702 05750000
*   END CPLTCHK;                    /*                               */ 05751000
*                                                                  1704 05752000
*   /*****************************************************************/ 05753000
*   /*                                                               */ 05754000
*   /* PROCEDURE CALLED TO RESTOW THE UPDATED ENTRY BACK TO THE      */ 05755000
*   /* SPECIFIED DATA SET                                    @Z63SP00*/ 05756000
*   /*                                                               */ 05757000
*   /*****************************************************************/ 05758000
*                                                                  1704 05759000
*UCLSTOW:                           /*                               */ 05760000
*   PROCEDURE;                      /*                               */ 05761000
UCLSTOW  STM   @14,@12,@SA00017                                    1704 05762000
*   IOPDSID=UC1DSID;                /* SET DSID                      */ 05763000
         MVC   IOPDSID(1,IOPPTR),UC1DSID                           1705 05764000
*   IOPRETRN=IOPGOOD;               /* INIT RC                       */ 05765000
         MVI   IOPRETRN(IOPPTR),X'00'                              1706 05766000
*   IF TOTALDEL=ON                  /* IF DELETE OPERATION   @Z40SP00*/ 05767000
*     THEN                          /*                       @Z40SP00*/ 05768000
         TM    TOTALDEL,B'00001000'                                1707 05769000
         BNO   @RF01707                                            1707 05770000
*     IOPFUNCT=IOPSTOWD;            /* SET TO DELETE         @Z40SP00*/ 05771000
         MVI   IOPFUNCT(IOPPTR),X'53'                              1708 05772000
*   ELSE                            /* ELSE SET TO CHANGE    @Z40SP00*/ 05773000
*     DO;                           /*                               */ 05774000
         B     @RC01707                                            1709 05775000
@RF01707 DS    0H                                                  1710 05776000
*       IOPBUSMD=TXTUCLIN;          /* LAST UPDATE = UCLIN           */ 05777000
         MVC   IOPBUSMD(7,IOPPTR),@CC01490                         1710 05778000
*       IF TOTAL=ON                 /*                               */ 05779000
*         THEN                      /*                               */ 05780000
         TM    TOTAL,B'00010000'                                   1711 05781000
         BNO   @RF01711                                            1711 05782000
*         IOPBUTYP=IOPBUADD;        /* ADD                           */ 05783000
         MVI   IOPBUTYP(IOPPTR),X'01'                              1712 05784000
*       ELSE                        /*                               */ 05785000
*         IOPBUTYP=IOPBUMOD;        /* MOD EXISTING RCD              */ 05786000
         B     @RC01711                                            1713 05787000
@RF01711 MVI   IOPBUTYP(IOPPTR),X'03'                              1713 05788000
*       IF LMOD=ON                  /* IF LMOD THEN USE              */ 05789000
*         THEN                      /*                               */ 05790000
@RC01711 TM    LMOD,B'00100000'                                    1714 05791000
         BNO   @RF01714                                            1714 05792000
*         DO;                       /*                               */ 05793000
*           IOPBUFAD=ADDR(IOPLMDFX);/*                               */ 05794000
         LA    @06,IOPLMDFX(,IOPPTR)                               1716 05795000
         ST    @06,IOPBUFAD(,IOPPTR)                               1716 05796000
*           DO UNTIL IOPRETRN^=IOPGOOD;/*                            */ 05797000
@DL01717 DS    0H                                                  1718 05798000
*             IOPFUNCT=IOPWRITE;    /*                               */ 05799000
         MVI   IOPFUNCT(IOPPTR),X'51'                              1718 05800000
*             CALL HMASMIO(HMASMIOP);/* WRITE CONTRO RECORD          */ 05801000
         ST    IOPPTR,@AL00001                                     1719 05802000
         L     @15,@CV01409                                        1719 05803000
         LA    @01,@AL00001                                        1719 05804000
         BALR  @14,@15                                             1719 05805000
*             IOPBUFAD=SAVBUFAD;    /* RESET BUFFER ADDR             */ 05806000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         1720 05807000
*             IF IOPRETRN=IOPGOOD   /*                               */ 05808000
*               THEN                /*                               */ 05809000
         CLI   IOPRETRN(IOPPTR),0                                  1721 05810000
         BNE   @RF01721                                            1721 05811000
*               DO;                 /*                               */ 05812000
*                 IOPFUNCT=IOPREAD; /*                               */ 05813000
         MVI   IOPFUNCT(IOPPTR),X'01'                              1723 05814000
*                 CALL HMASMIO(HMASMIOP);/* READ NEXT RECORD         */ 05815000
         ST    IOPPTR,@AL00001                                     1724 05816000
         L     @15,@CV01409                                        1724 05817000
         LA    @01,@AL00001                                        1724 05818000
         BALR  @14,@15                                             1724 05819000
*               END;                /*                               */ 05820000
*           END;                    /*                               */ 05821000
@RF01721 DS    0H                                                  1726 05822000
@DE01717 CLI   IOPRETRN(IOPPTR),0                                  1726 05823000
         BE    @DL01717                                            1726 05824000
*           IF IOPRETRN=IOPEOF      /* IF STOP DUE TO EOF            */ 05825000
*             THEN                  /*                               */ 05826000
         CLI   IOPRETRN(IOPPTR),4                                  1727 05827000
         BNE   @RF01727                                            1727 05828000
*             IOPRETRN=IOPGOOD;     /* RESET RC                      */ 05829000
         MVI   IOPRETRN(IOPPTR),X'00'                              1728 05830000
*         END;                      /*                               */ 05831000
@RF01727 DS    0H                                                  1730 05832000
*       IOPFUNCT=IOPSTOWR;          /* INDICATE OPERATION TO PERFORM */ 05833000
@RF01714 MVI   IOPFUNCT(IOPPTR),X'54'                              1730 05834000
*     END;                          /*                               */ 05835000
*   IF IOPRETRN=IOPGOOD             /* IF PREV PROCESS OK            */ 05836000
*     THEN                          /*                               */ 05837000
@RC01707 CLI   IOPRETRN(IOPPTR),0                                  1732 05838000
         BNE   @RF01732                                            1732 05839000
*     CALL HMASMIO(HMASMIOP);       /* DO REPLACE OR DELETE  @Z40SP00*/ 05840000
         ST    IOPPTR,@AL00001                                     1733 05841000
         L     @15,@CV01409                                        1733 05842000
         LA    @01,@AL00001                                        1733 05843000
         BALR  @14,@15                                             1733 05844000
*   RETURN CODE(IOPRETRN);          /*                               */ 05845000
@RF01732 SLR   @15,@15                                             1734 05846000
         IC    @15,IOPRETRN(,IOPPTR)                               1734 05847000
         L     @14,@SA00017                                        1734 05848000
         LM    @00,@12,@SA00017+8                                  1734 05849000
         BR    @14                                                 1734 05850000
*   END UCLSTOW;                    /*                               */ 05851000
*                                                                  1736 05852000
*   /*****************************************************************/ 05853000
*   /*                                                               */ 05854000
*   /* PROCEDURE CALLED TO WRITE ALL UCL MSGS                @Z63SP00*/ 05855000
*   /*                                                               */ 05856000
*   /*****************************************************************/ 05857000
*                                                                  1736 05858000
*UCLMSGS:                           /*                               */ 05859000
*   PROCEDURE;                      /*                               */ 05860000
*                                                                  1736 05861000
UCLMSGS  STM   @14,@12,@SA00018                                    1736 05862000
*   /*****************************************************************/ 05863000
*   /*                                                               */ 05864000
*   /* PROCEDURE CALLED TO WRITE MSG HMA203I                 @Z63SP00*/ 05865000
*   /*                                                               */ 05866000
*   /*****************************************************************/ 05867000
*                                                                  1737 05868000
*UCL203I:                           /*                               */ 05869000
*   ENTRY;                          /*                               */ 05870000
         B     @EC01737                                            1737 05871000
UCL203I  STM   @14,@12,@SA00018                                    1737 05872000
@EC01737 DS    0H                                                  1738 05873000
*   MGPMGNO1=HMA203I;               /* SYNTAX ERROR IN       @Z63SP00*/ 05874000
         MVC   MGPMGNO1(2),@CH00145                                1738 05875000
*   MGPMGNO2=PART022;               /* UCL STATEMENT         @Z63SP00*/ 05876000
         MVC   MGPMGNO2(2),@CH00560                                1739 05877000
*   MGPMGNO3=PART026;               /* AT COL XX             @Z63SP00*/ 05878000
         MVC   MGPMGNO3(2),@CH00568                                1740 05879000
*   CVB15=(SCPCHAR-ADDR(CRPBUFFR))+1;/* DISPLACEMENT TO SYNTAX ERR   */ 05880000
         L     @06,@PC00001+4                                      1741 05881000
         LA    @06,CRPBUFFR(,@06)                                  1741 05882000
         LCR   @06,@06                                             1741 05883000
         L     @01,SCPPTR                                          1741 05884000
         AL    @06,SCPCHAR(,@01)                                   1741 05885000
         AH    @06,@CH00043                                        1741 05886000
         STH   @06,CVB15                                           1741 05887000
*   CVD(CVB15,PACK8);               /* CONVERT TO DECIMAL            */ 05888000
         CVD   @06,PACK8                                           1742 05889000
*   UNPK(CHAR12,PACK8);             /* UNPACK IT                     */ 05890000
         UNPK  CHAR12(12),PACK8(8)                                 1743 05891000
*   CHAR12(12)=CHAR12(12)|HEX0;     /*                               */ 05892000
         OI    CHAR12+11,X'F0'                                     1744 05893000
*   MGPVARPT(1)=ADDR(CHAR12(11));   /* PLACE ADDR OF DATA IN LIST    */ 05894000
         LA    @06,CHAR12+10                                       1745 05895000
         ST    @06,MGPVARPT                                        1745 05896000
*   MGPTYPE=MGPERR;                 /* SET MESSAGE SEVERITY  @ZD00002*/ 05897000
         MVI   MGPTYPE,X'03'                                       1746 05898000
*   CALL HMASMMSG(HMASMMGP);        /* WRITE THE MESSAGE     @Z63SP00*/ 05899000
         L     @15,@CV01411                                        1747 05900000
         LA    @01,@AL01747                                        1747 05901000
         BALR  @14,@15                                             1747 05902000
*   UCLRTNCD=MAX(UCLRTNCD,STOPPTF); /* SET RC FOR SYNTAX     @YA07506*/ 05903000
         SLR   @06,@06                                             1748 05904000
         IC    @06,UCLRTNCD                                        1748 05905000
         LA    @15,8                                               1748 05906000
         CR    @06,@15                                             1748 05907000
         BNL   *+6                                                      05908000
         LR    @06,@15                                             1748 05909000
         STC   @06,UCLRTNCD                                        1748 05910000
*   RETURN CODE(0);                 /*                               */ 05911000
*                                                                  1749 05912000
         SLR   @15,@15                                             1749 05913000
         L     @14,@SA00018                                        1749 05914000
         LM    @00,@12,@SA00018+8                                  1749 05915000
         BR    @14                                                 1749 05916000
*   /*****************************************************************/ 05917000
*   /*                                                               */ 05918000
*   /* ROUTINE TO WRITE MSG HMA252I - INCOMPLETE STMT                */ 05919000
*   /*                                                               */ 05920000
*   /*****************************************************************/ 05921000
*                                                                  1750 05922000
*UCL252I:                           /*                               */ 05923000
*   ENTRY;                          /*                               */ 05924000
UCL252I  STM   @14,@12,@SA00018                                    1750 05925000
*   MGPCLEAR=''B;                   /*                               */ 05926000
         XC    MGPCLEAR(6),MGPCLEAR                                1751 05927000
*   MGPMGNO1=HMA252I;               /* INCOMPLETE HMASMP CONTROL   1752 05928000
*                                      STATEMENT                     */ 05929000
         MVC   MGPMGNO1(2),@CH01462                                1752 05930000
*   MGPTYPE=MGPERR;                 /*                               */ 05931000
         MVI   MGPTYPE,X'03'                                       1753 05932000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 05933000
         L     @15,@CV01411                                        1754 05934000
         LA    @01,@AL01754                                        1754 05935000
         BALR  @14,@15                                             1754 05936000
*   UCLRTNCD=MAX(UCLRTNCD,STOPPTF); /*                               */ 05937000
         SLR   @06,@06                                             1755 05938000
         IC    @06,UCLRTNCD                                        1755 05939000
         LA    @15,8                                               1755 05940000
         CR    @06,@15                                             1755 05941000
         BNL   *+6                                                      05942000
         LR    @06,@15                                             1755 05943000
         STC   @06,UCLRTNCD                                        1755 05944000
*   ERR1SW=ON;                      /*                               */ 05945000
         OI    ERR1SW,B'10000000'                                  1756 05946000
*   RETURN CODE(0);                 /*                               */ 05947000
*                                                                  1757 05948000
         SLR   @15,@15                                             1757 05949000
         L     @14,@SA00018                                        1757 05950000
         LM    @00,@12,@SA00018+8                                  1757 05951000
         BR    @14                                                 1757 05952000
*   /*****************************************************************/ 05953000
*   /*                                                               */ 05954000
*   /* ROUTINE TO WRITE MSG HMA253I - MSG FOR TOTAL ENTRY NOT FOUND  */ 05955000
*   /*                                                               */ 05956000
*   /*****************************************************************/ 05957000
*                                                                  1758 05958000
*UCL253I:                           /*                               */ 05959000
*   ENTRY;                          /*                               */ 05960000
UCL253I  STM   @14,@12,@SA00018                                    1758 05961000
*   MGPCLEAR=''B;                   /* ZERO MSG PARM                 */ 05962000
         XC    MGPCLEAR(6),MGPCLEAR                                1759 05963000
*   MGPMGNO1=HMA253I;               /* XXXXXXXX ENTRY XXXXXXXX TO BE    05964000
*                                      DELETED DOES NOT EXIST        */ 05965000
         MVC   MGPMGNO1(2),@CH01110                                1760 05966000
*   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE                      */ 05967000
         SLR   @06,@06                                             1761 05968000
         IC    @06,IOPTYPE(,IOPPTR)                                1761 05969000
         SLA   @06,3                                               1761 05970000
         L     @01,CCATPAD(,CCAPTR)                                1761 05971000
         AL    @01,@CF02300                                        1761 05972000
         LA    @06,CCATYPEA(@06,@01)                               1761 05973000
         ST    @06,MGPVARPT                                        1761 05974000
*   MGPVARPT(2)=ADDR(IOPNAME);      /* ENTRY NAME                    */ 05975000
         LA    @06,IOPNAME(,IOPPTR)                                1762 05976000
         ST    @06,MGPVARPT+4                                      1762 05977000
*   MGPTYPE=MGPERR;                 /*                               */ 05978000
         MVI   MGPTYPE,X'03'                                       1763 05979000
*   ERR1SW=ON;                      /* SET ERR SW                    */ 05980000
         OI    ERR1SW,B'10000000'                                  1764 05981000
*   CALL HMASMMSG(HMASMMGP);        /* WRITE OUT THE ERROR MESSAGE   */ 05982000
         L     @15,@CV01411                                        1765 05983000
         LA    @01,@AL01765                                        1765 05984000
         BALR  @14,@15                                             1765 05985000
*   RETURN CODE(ZERO);              /*                               */ 05986000
         SLR   @15,@15                                             1766 05987000
         L     @14,@SA00018                                        1766 05988000
         LM    @00,@12,@SA00018+8                                  1766 05989000
         BR    @14                                                 1766 05990000
*                                                                  1767 05991000
*   /*****************************************************************/ 05992000
*   /*                                                               */ 05993000
*   /* UCL COMPLETED OK MSG                                  @Z63SP00*/ 05994000
*   /*                                                               */ 05995000
*   /*****************************************************************/ 05996000
*                                                                  1767 05997000
*UCL255I:                           /*                               */ 05998000
*   ENTRY;                          /*                               */ 05999000
UCL255I  STM   @14,@12,@SA00018                                    1767 06000000
*   MGPCLEAR=''B;                   /*                               */ 06001000
         XC    MGPCLEAR(6),MGPCLEAR                                1768 06002000
*   MGPMGNO1=HMA255I;               /* UPDATE COMPLETE       @Z63SP00*/ 06003000
         MVC   MGPMGNO1(2),@CH00809                                1769 06004000
*   MGPMGNO2=PART018;               /* FOR XXXXXXXX          @Z63SP00*/ 06005000
         MVC   MGPMGNO2(2),@CH00553                                1770 06006000
*   MGPVARPT(1)=ADDR(IOPNAME);      /* INSERT ENTRY NAME ADDRESS     */ 06007000
         LA    @06,IOPNAME(,IOPPTR)                                1771 06008000
         ST    @06,MGPVARPT                                        1771 06009000
*   MGPTYPE=MGPINFO;                /* SET MESSAGE SEVERITY  @ZD00002*/ 06010000
         MVI   MGPTYPE,X'01'                                       1772 06011000
*   CALL HMASMMSG(HMASMMGP);        /* WRITE THE MESSAGE     @Z63SP00*/ 06012000
         L     @15,@CV01411                                        1773 06013000
         LA    @01,@AL01773                                        1773 06014000
         BALR  @14,@15                                             1773 06015000
*   RETURN CODE(ZERO);              /*                               */ 06016000
*                                                                  1774 06017000
         SLR   @15,@15                                             1774 06018000
         L     @14,@SA00018                                        1774 06019000
         LM    @00,@12,@SA00018+8                                  1774 06020000
         BR    @14                                                 1774 06021000
*   /*****************************************************************/ 06022000
*   /*                                                               */ 06023000
*   /* END OF FILE OR AN I/O ERROR HAS OCCURRED ON THE INPUT DATA    */ 06024000
*   /* SET. SET THE SERIOUS ERROR CONDITION, WRITE ERROR MESSAGE     */ 06025000
*   /*                                                               */ 06026000
*   /*****************************************************************/ 06027000
*                                                                  1775 06028000
*UCL256I:                                                          1775 06029000
*   ENTRY;                                                         1775 06030000
UCL256I  STM   @14,@12,@SA00018                                    1775 06031000
*   MGPCLEAR=''B;                   /* ZERO ALL MGP          @Z40SP00*/ 06032000
         XC    MGPCLEAR(6),MGPCLEAR                                1776 06033000
*   MGPMGNO1=HMA256I;               /* UPDATE PROCESSING TERMINATED -   06034000
*                                      UPDATE NOT COMPLETE           */ 06035000
         MVC   MGPMGNO1(2),@CH01115                                1777 06036000
*   MGPTYPE=MGPINFO;                /* SET MESSAGE SEVERITY  @ZD00002*/ 06037000
         MVI   MGPTYPE,X'01'                                       1778 06038000
*   CALL HMASMMSG(HMASMMGP);        /* WRITE THE MESSAGE     @Z63SP00*/ 06039000
         L     @15,@CV01411                                        1779 06040000
         LA    @01,@AL01779                                        1779 06041000
         BALR  @14,@15                                             1779 06042000
*   RETURN CODE(0);                 /*                               */ 06043000
*                                                                  1780 06044000
         SLR   @15,@15                                             1780 06045000
         L     @14,@SA00018                                        1780 06046000
         LM    @00,@12,@SA00018+8                                  1780 06047000
         BR    @14                                                 1780 06048000
*   /*****************************************************************/ 06049000
*   /*                                                               */ 06050000
*   /* ROUTINE CALLED TO WRITE MSG HMA257I                   @Z63SP00*/ 06051000
*   /*                                                               */ 06052000
*   /*****************************************************************/ 06053000
*                                                                  1781 06054000
*UCL257I:                           /*                               */ 06055000
*   ENTRY(TXT257);                  /*                               */ 06056000
UCL257I  STM   @14,@12,@SA00018                                    1781 06057000
         MVC   @PC00018(4),0(@01)                                  1781 06058000
*   DECLARE                         /*                               */ 06059000
*     TXT257 CHAR(8);               /*                               */ 06060000
*   MGPCLEAR=''B;                   /*                               */ 06061000
         XC    MGPCLEAR(6),MGPCLEAR                                1783 06062000
*   MGPMGNO1=HMA257I;               /* SPEFIFIED UPDATE RESULTS IN 1784 06063000
*                                      INSUFFICIENT DATA - XXXXXXXX     06064000
*                                      REQUIRED                      */ 06065000
         MVC   MGPMGNO1(2),@CH01117                                1784 06066000
*   MGPVARPT(1)=ADDR(TXT257);       /*                               */ 06067000
         L     @06,@PC00018                                        1785 06068000
         ST    @06,MGPVARPT                                        1785 06069000
*   MGPTYPE=MGPERR;                 /*                               */ 06070000
         MVI   MGPTYPE,X'03'                                       1786 06071000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06072000
         L     @15,@CV01411                                        1787 06073000
         LA    @01,@AL01787                                        1787 06074000
         BALR  @14,@15                                             1787 06075000
*   UCLRTNCD=MAX(UCLRTNCD,STOPPTF); /*                               */ 06076000
         SLR   @06,@06                                             1788 06077000
         IC    @06,UCLRTNCD                                        1788 06078000
         LA    @15,8                                               1788 06079000
         CR    @06,@15                                             1788 06080000
         BNL   *+6                                                      06081000
         LR    @06,@15                                             1788 06082000
         STC   @06,UCLRTNCD                                        1788 06083000
*   ERR2SW=ON;                      /* SET ERR SW                    */ 06084000
         OI    ERR2SW,B'01000000'                                  1789 06085000
*   RETURN CODE(0);                 /*                               */ 06086000
         SLR   @15,@15                                             1790 06087000
         L     @14,@SA00018                                        1790 06088000
         LM    @00,@12,@SA00018+8                                  1790 06089000
         BR    @14                                                 1790 06090000
*                                                                  1791 06091000
*   /*****************************************************************/ 06092000
*   /*                                                               */ 06093000
*   /* ROUTINE CALLED TO WRITE MSG HMA258I                   @Z63SP00*/ 06094000
*   /*                                                               */ 06095000
*   /*****************************************************************/ 06096000
*                                                                  1791 06097000
*UCL258I:                           /*                               */ 06098000
*   ENTRY;                          /*                               */ 06099000
UCL258I  STM   @14,@12,@SA00018                                    1791 06100000
*   MGPCLEAR=''B;                   /*                               */ 06101000
         XC    MGPCLEAR(6),MGPCLEAR                                1792 06102000
*   MGPMGNO1=HMA258I;               /* END OF FILE ON UCL INPUT    1793 06103000
*                                      STREAM - PROCESSING TERMINATED*/ 06104000
         MVC   MGPMGNO1(2),@CH01119                                1793 06105000
*   MGPTYPE=MGPERR;                 /*                               */ 06106000
         MVI   MGPTYPE,X'03'                                       1794 06107000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06108000
         L     @15,@CV01411                                        1795 06109000
         LA    @01,@AL01795                                        1795 06110000
         BALR  @14,@15                                             1795 06111000
*   UCLRTNCD=MAX(UCLRTNCD,STOPPTF); /*                               */ 06112000
         SLR   @06,@06                                             1796 06113000
         IC    @06,UCLRTNCD                                        1796 06114000
         LA    @15,8                                               1796 06115000
         CR    @06,@15                                             1796 06116000
         BNL   *+6                                                      06117000
         LR    @06,@15                                             1796 06118000
         STC   @06,UCLRTNCD                                        1796 06119000
*   ERR1SW=ON;                      /* SET ERR SW                    */ 06120000
         OI    ERR1SW,B'10000000'                                  1797 06121000
*   RETURN CODE(0);                 /*                               */ 06122000
*                                                                  1798 06123000
         SLR   @15,@15                                             1798 06124000
         L     @14,@SA00018                                        1798 06125000
         LM    @00,@12,@SA00018+8                                  1798 06126000
         BR    @14                                                 1798 06127000
*   /*****************************************************************/ 06128000
*   /*                                                               */ 06129000
*   /* ROUTINE TO WRITE MSG 259I                                     */ 06130000
*   /*                                                               */ 06131000
*   /*****************************************************************/ 06132000
*                                                                  1799 06133000
*UCL259I:                           /*                               */ 06134000
*   ENTRY;                          /*                               */ 06135000
UCL259I  STM   @14,@12,@SA00018                                    1799 06136000
*   MGPCLEAR=''B;                   /* ZERO MSG PARM                 */ 06137000
         XC    MGPCLEAR(6),MGPCLEAR                                1800 06138000
*   MGPMGNO1=HMA259I;               /* XXXXXXXX XXXXXXXX ELEMENT   1801 06139000
*                                      PEMAX EXCEEDED ATTEMPTING TO     06140000
*                                      ADD X16X X8X                  */ 06141000
         MVC   MGPMGNO1(2),@CH00909                                1801 06142000
*   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE                      */ 06143000
         SLR   @06,@06                                             1802 06144000
         IC    @06,IOPTYPE(,IOPPTR)                                1802 06145000
         SLA   @06,3                                               1802 06146000
         L     @01,CCATPAD(,CCAPTR)                                1802 06147000
         AL    @01,@CF02300                                        1802 06148000
         LA    @06,CCATYPEA(@06,@01)                               1802 06149000
         ST    @06,MGPVARPT                                        1802 06150000
*   MGPVARPT(2)=ADDR(IOPNAME);      /* NAME                          */ 06151000
         LA    @06,IOPNAME(,IOPPTR)                                1803 06152000
         ST    @06,MGPVARPT+4                                      1803 06153000
*   MGPVARPT(3)=ADDR(MSGPART1);     /* TYPE SUB-ENTRY                */ 06154000
         LA    @06,MSGPART1                                        1804 06155000
         ST    @06,MGPVARPT+8                                      1804 06156000
*   MGPVARPT(4)=ADDR(MSGPART2);     /* DATA VALUE                    */ 06157000
         LA    @06,MSGPART2                                        1805 06158000
         ST    @06,MGPVARPT+12                                     1805 06159000
*   MGPTYPE=MGPERR;                 /* SET MESSAGE SEVERITY  @ZD00002*/ 06160000
         MVI   MGPTYPE,X'03'                                       1806 06161000
*   CALL HMASMMSG(HMASMMGP);        /* WRITE THE MESSAGE     @Z63SP00*/ 06162000
         L     @15,@CV01411                                        1807 06163000
         LA    @01,@AL01807                                        1807 06164000
         BALR  @14,@15                                             1807 06165000
*   ERR2SW=ON;                      /* INDICATE THE ERROR    @Z63SP00*/ 06166000
         OI    ERR2SW,B'01000000'                                  1808 06167000
*   RETURN CODE(ZERO);              /* RETURN                        */ 06168000
         SLR   @15,@15                                             1809 06169000
         L     @14,@SA00018                                        1809 06170000
         LM    @00,@12,@SA00018+8                                  1809 06171000
         BR    @14                                                 1809 06172000
*                                                                  1810 06173000
*   /*****************************************************************/ 06174000
*   /*                                                               */ 06175000
*   /* ROUTINE CALLED TO WRITE MSG HMA261I                           */ 06176000
*   /*                                                               */ 06177000
*   /*****************************************************************/ 06178000
*                                                                  1810 06179000
*UCL261I:                           /*                               */ 06180000
*   ENTRY;                          /*                               */ 06181000
UCL261I  STM   @14,@12,@SA00018                                    1810 06182000
*   MGPCLEAR=''B;                   /*                               */ 06183000
         XC    MGPCLEAR(6),MGPCLEAR                                1811 06184000
*   MGPMGNO1=HMA261I;               /* XXXXXXXX ENTERED IS NOT EQUAL    06185000
*                                      XXXXXXXX X100X IN ENTRY       */ 06186000
         MVC   MGPMGNO1(2),@CH00355                                1812 06187000
*   MGPVARPT(1)=ADDR(MSGPART1);     /*                               */ 06188000
         LA    @06,MSGPART1                                        1813 06189000
         ST    @06,MGPVARPT                                        1813 06190000
*   MGPVARPT(2)=ADDR(MSGPART1);     /*                               */ 06191000
         ST    @06,MGPVARPT+4                                      1814 06192000
*   MGPVARPT(3)=ADDR(MSGPART3);     /*                               */ 06193000
         LA    @06,MSGPART3                                        1815 06194000
         ST    @06,MGPVARPT+8                                      1815 06195000
*   MGPTYPE=MGPERR;                 /*                               */ 06196000
         MVI   MGPTYPE,X'03'                                       1816 06197000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06198000
         L     @15,@CV01411                                        1817 06199000
         LA    @01,@AL01817                                        1817 06200000
         BALR  @14,@15                                             1817 06201000
*   ERR2SW=ON;                      /*                               */ 06202000
         OI    ERR2SW,B'01000000'                                  1818 06203000
*   RETURN CODE(0);                 /*                               */ 06204000
*                                                                  1819 06205000
         SLR   @15,@15                                             1819 06206000
         L     @14,@SA00018                                        1819 06207000
         LM    @00,@12,@SA00018+8                                  1819 06208000
         BR    @14                                                 1819 06209000
*   /*****************************************************************/ 06210000
*   /*                                                               */ 06211000
*   /* ROUTINE CALLED TO WRITE MSG HMA276I                   @Z63SP00*/ 06212000
*   /*                                                               */ 06213000
*   /*****************************************************************/ 06214000
*                                                                  1820 06215000
*UCL276I:                           /*                               */ 06216000
*   ENTRY;                          /*                               */ 06217000
UCL276I  STM   @14,@12,@SA00018                                    1820 06218000
*   MGPCLEAR=''B;                   /*                               */ 06219000
         XC    MGPCLEAR(6),MGPCLEAR                                1821 06220000
*   MGPMGNO1=HMA276I;               /* ILLEGAL UPDATE REQUEST        */ 06221000
         MVC   MGPMGNO1(2),@CH01471                                1822 06222000
*   MGPMGNO2=PART016;               /* ON XXXXXXXX                   */ 06223000
         MVC   MGPMGNO2(2),@CH00048                                1823 06224000
*   MGPVARPT(1)=ADDR(CCADSIDA(UC1DSID));/* DATASET                   */ 06225000
         SLR   @06,@06                                             1824 06226000
         IC    @06,UC1DSID                                         1824 06227000
         SLA   @06,3                                               1824 06228000
         L     @01,CCADSAD(,CCAPTR)                                1824 06229000
         AL    @01,@CF02300                                        1824 06230000
         LA    @06,CCADSIDA(@06,@01)                               1824 06231000
         ST    @06,MGPVARPT                                        1824 06232000
*   MGPTYPE=MGPERR;                 /*                               */ 06233000
         MVI   MGPTYPE,X'03'                                       1825 06234000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06235000
         L     @15,@CV01411                                        1826 06236000
         LA    @01,@AL01826                                        1826 06237000
         BALR  @14,@15                                             1826 06238000
*   ERR1SW=ON;                      /*                               */ 06239000
         OI    ERR1SW,B'10000000'                                  1827 06240000
*   RETURN CODE(0);                 /*                               */ 06241000
*                                                                  1828 06242000
         SLR   @15,@15                                             1828 06243000
         L     @14,@SA00018                                        1828 06244000
         LM    @00,@12,@SA00018+8                                  1828 06245000
         BR    @14                                                 1828 06246000
*   /*****************************************************************/ 06247000
*   /*                                                               */ 06248000
*   /* ROUTINE CALLED TO WRITE MSG HMA277I                   @Z63SP00*/ 06249000
*   /*                                                               */ 06250000
*   /*****************************************************************/ 06251000
*                                                                  1829 06252000
*UCL277I:                           /*                               */ 06253000
*   ENTRY;                          /*                               */ 06254000
UCL277I  STM   @14,@12,@SA00018                                    1829 06255000
*   MGPCLEAR=''B;                   /*                               */ 06256000
         XC    MGPCLEAR(6),MGPCLEAR                                1830 06257000
*   MGPMGNO1=HMA277I;               /* XXXXXXXX XXXXXXXX TO BE     1831 06258000
*                                      REPLACED DOES NOT EXIST - ADD    06259000
*                                      ASSUMED                       */ 06260000
         MVC   MGPMGNO1(2),@CH01473                                1831 06261000
*   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE                      */ 06262000
         SLR   @06,@06                                             1832 06263000
         IC    @06,IOPTYPE(,IOPPTR)                                1832 06264000
         SLA   @06,3                                               1832 06265000
         L     @01,CCATPAD(,CCAPTR)                                1832 06266000
         AL    @01,@CF02300                                        1832 06267000
         LA    @06,CCATYPEA(@06,@01)                               1832 06268000
         ST    @06,MGPVARPT                                        1832 06269000
*   MGPVARPT(2)=ADDR(IOPNAME);      /*                               */ 06270000
         LA    @06,IOPNAME(,IOPPTR)                                1833 06271000
         ST    @06,MGPVARPT+4                                      1833 06272000
*   MGPTYPE=MGPWARN;                /*                               */ 06273000
         MVI   MGPTYPE,X'02'                                       1834 06274000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06275000
         L     @15,@CV01411                                        1835 06276000
         LA    @01,@AL01835                                        1835 06277000
         BALR  @14,@15                                             1835 06278000
*   UCLRTNCD=MAX(UCLRTNCD,PTFWARN); /*                               */ 06279000
         SLR   @06,@06                                             1836 06280000
         IC    @06,UCLRTNCD                                        1836 06281000
         LA    @15,4                                               1836 06282000
         CR    @06,@15                                             1836 06283000
         BNL   *+6                                                      06284000
         LR    @06,@15                                             1836 06285000
         STC   @06,UCLRTNCD                                        1836 06286000
*   RETURN CODE(0);                 /*                               */ 06287000
         SLR   @15,@15                                             1837 06288000
         L     @14,@SA00018                                        1837 06289000
         LM    @00,@12,@SA00018+8                                  1837 06290000
         BR    @14                                                 1837 06291000
*                                                                  1838 06292000
*   /*****************************************************************/ 06293000
*   /*                                                               */ 06294000
*   /* PROCEDURE CALLED TO WRITE MSG HMA341                          */ 06295000
*   /*                                                               */ 06296000
*   /*****************************************************************/ 06297000
*                                                                  1838 06298000
*UCL341I:                           /*                               */ 06299000
*   ENTRY(TXT3411,TXT3412);         /*                               */ 06300000
UCL341I  STM   @14,@12,@SA00018                                    1838 06301000
         MVC   @PC00018+4(8),0(@01)                                1838 06302000
*   DECLARE                         /*                               */ 06303000
*     TXT3411 CHAR(8),              /*                               */ 06304000
*     TXT3412 CHAR(8);              /*                               */ 06305000
*   MGPCLEAR=''B;                   /*                               */ 06306000
         XC    MGPCLEAR(6),MGPCLEAR                                1840 06307000
*   MGPMGNO1=HMA341I;               /* KEYWORDS XXXXXXXX AND XXXXXXXX   06308000
*                                      ARE MUTUALLY EXCLUSIVE        */ 06309000
         MVC   MGPMGNO1(2),@CH01475                                1841 06310000
*   MGPVARPT(1)=ADDR(TXT3411);      /*                               */ 06311000
         L     @06,@PC00018+4                                      1842 06312000
         ST    @06,MGPVARPT                                        1842 06313000
*   MGPVARPT(2)=ADDR(TXT3412);      /*                               */ 06314000
         L     @06,@PC00018+8                                      1843 06315000
         ST    @06,MGPVARPT+4                                      1843 06316000
*   MGPTYPE=MGPERR;                 /*                               */ 06317000
         MVI   MGPTYPE,X'03'                                       1844 06318000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06319000
         L     @15,@CV01411                                        1845 06320000
         LA    @01,@AL01845                                        1845 06321000
         BALR  @14,@15                                             1845 06322000
*   ERR1SW=ON;                      /*                               */ 06323000
         OI    ERR1SW,B'10000000'                                  1846 06324000
*   RETURN CODE(0);                 /*                               */ 06325000
         SLR   @15,@15                                             1847 06326000
         L     @14,@SA00018                                        1847 06327000
         LM    @00,@12,@SA00018+8                                  1847 06328000
         BR    @14                                                 1847 06329000
*                                                                  1848 06330000
*   /*****************************************************************/ 06331000
*   /*                                                               */ 06332000
*   /* PROCEDURE CALLED TO WRITE MSG HMA356                  @Z63SP00*/ 06333000
*   /*                                                               */ 06334000
*   /*****************************************************************/ 06335000
*                                                                  1848 06336000
*UCL356I:                           /*                               */ 06337000
*   ENTRY;                          /*                               */ 06338000
UCL356I  STM   @14,@12,@SA00018                                    1848 06339000
*   MGPCLEAR=''B;                   /* ZERO MSG PARM                 */ 06340000
         XC    MGPCLEAR(6),MGPCLEAR                                1849 06341000
*   MGPMGNO1=HMA356I;               /* XXXXXXXX XXXXXXXX TO BE ADDED    06342000
*                                      TO ENTRY ALREADY EXISTS       */ 06343000
         MVC   MGPMGNO1(2),@CH01477                                1850 06344000
*   MGPVARPT(1)=ADDR(MSGPART1);     /* ENTRY TYPE                    */ 06345000
         LA    @06,MSGPART1                                        1851 06346000
         ST    @06,MGPVARPT                                        1851 06347000
*   MGPVARPT(2)=ADDR(MSGPART2);     /* DATA                          */ 06348000
         LA    @06,MSGPART2                                        1852 06349000
         ST    @06,MGPVARPT+4                                      1852 06350000
*   IF MSGPART3(1)^=BLANK           /* IF THIRD PART                 */ 06351000
*     THEN                          /*                               */ 06352000
         CLI   MSGPART3,C' '                                       1853 06353000
         BE    @RF01853                                            1853 06354000
*     DO;                           /*                               */ 06355000
*       MGPMGNO2=PART003;           /* AS X100X                      */ 06356000
         MVC   MGPMGNO2(2),@CH00045                                1855 06357000
*       MGPVARPT(3)=ADDR(MSGPART3); /* CURRENT VALUE                 */ 06358000
         LA    @06,MSGPART3                                        1856 06359000
         ST    @06,MGPVARPT+8                                      1856 06360000
*     END;                          /*                               */ 06361000
*   MGPTYPE=MGPERR;                 /*                               */ 06362000
@RF01853 MVI   MGPTYPE,X'03'                                       1858 06363000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06364000
         L     @15,@CV01411                                        1859 06365000
         LA    @01,@AL01859                                        1859 06366000
         BALR  @14,@15                                             1859 06367000
*   ERR2SW=ON;                      /*                               */ 06368000
         OI    ERR2SW,B'01000000'                                  1860 06369000
*   RETURN CODE(ZERO);              /*                               */ 06370000
*                                                                  1861 06371000
         SLR   @15,@15                                             1861 06372000
         L     @14,@SA00018                                        1861 06373000
         LM    @00,@12,@SA00018+8                                  1861 06374000
         BR    @14                                                 1861 06375000
*   /*****************************************************************/ 06376000
*   /*                                                               */ 06377000
*   /* PROCEDURE CALLED TO WRITE MSG HMA357I                 @Z63SP00*/ 06378000
*   /*                                                               */ 06379000
*   /*****************************************************************/ 06380000
*                                                                  1862 06381000
*UCL357I:                           /*                               */ 06382000
*   ENTRY;                          /*                               */ 06383000
UCL357I  STM   @14,@12,@SA00018                                    1862 06384000
*   MGPCLEAR=''B;                   /* ZERO MSG PARM                 */ 06385000
         XC    MGPCLEAR(6),MGPCLEAR                                1863 06386000
*   MGPMGNO1=HMA357I;               /* XXXXXXXX XXXXXXXX TO BE     1864 06387000
*                                      DELETED FROM ENTRY DOES NOT 1864 06388000
*                                      EXIST                         */ 06389000
         MVC   MGPMGNO1(2),@CH01479                                1864 06390000
*   MGPVARPT(1)=ADDR(MSGPART1);     /* ENTRY TYPE                    */ 06391000
         LA    @06,MSGPART1                                        1865 06392000
         ST    @06,MGPVARPT                                        1865 06393000
*   MGPVARPT(2)=ADDR(MSGPART2);     /* DATA                          */ 06394000
         LA    @06,MSGPART2                                        1866 06395000
         ST    @06,MGPVARPT+4                                      1866 06396000
*   MGPTYPE=MGPERR;                 /*                               */ 06397000
         MVI   MGPTYPE,X'03'                                       1867 06398000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06399000
         L     @15,@CV01411                                        1868 06400000
         LA    @01,@AL01868                                        1868 06401000
         BALR  @14,@15                                             1868 06402000
*   ERR2SW=ON;                      /*                               */ 06403000
         OI    ERR2SW,B'01000000'                                  1869 06404000
*   RETURN CODE(ZERO);              /*                               */ 06405000
         SLR   @15,@15                                             1870 06406000
         L     @14,@SA00018                                        1870 06407000
         LM    @00,@12,@SA00018+8                                  1870 06408000
         BR    @14                                                 1870 06409000
*                                                                  1871 06410000
*   /*****************************************************************/ 06411000
*   /*                                                               */ 06412000
*   /* PROCEDURE CALLED TO WRITE MSG HMA358I                 @Z63SP00*/ 06413000
*   /*                                                               */ 06414000
*   /*****************************************************************/ 06415000
*                                                                  1871 06416000
*UCL358I:                           /*                               */ 06417000
*   ENTRY;                          /*                               */ 06418000
UCL358I  STM   @14,@12,@SA00018                                    1871 06419000
*   MGPCLEAR=''B;                   /* ZERO MSG PARM                 */ 06420000
         XC    MGPCLEAR(6),MGPCLEAR                                1872 06421000
*   MGPMGNO1=HMA358I;               /* XXXXXXXX XXXXXXXX TO REPLACED    06422000
*                                      IN ENTRY DOES NOT EXIST - ADD    06423000
*                                      ASSUMED                       */ 06424000
         MVC   MGPMGNO1(2),@CH01481                                1873 06425000
*   MGPVARPT(1)=ADDR(MSGPART1);     /* ENTRY TYPE                    */ 06426000
         LA    @06,MSGPART1                                        1874 06427000
         ST    @06,MGPVARPT                                        1874 06428000
*   MGPVARPT(2)=ADDR(MSGPART2);     /* DATA                          */ 06429000
         LA    @06,MSGPART2                                        1875 06430000
         ST    @06,MGPVARPT+4                                      1875 06431000
*   MGPTYPE=MGPWARN;                /*                               */ 06432000
         MVI   MGPTYPE,X'02'                                       1876 06433000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06434000
         L     @15,@CV01411                                        1877 06435000
         LA    @01,@AL01877                                        1877 06436000
         BALR  @14,@15                                             1877 06437000
*   UCLRTNCD=MAX(UCLRTNCD,PTFWARN); /* SET WARNING RC                */ 06438000
         SLR   @06,@06                                             1878 06439000
         IC    @06,UCLRTNCD                                        1878 06440000
         LA    @15,4                                               1878 06441000
         CR    @06,@15                                             1878 06442000
         BNL   *+6                                                      06443000
         LR    @06,@15                                             1878 06444000
         STC   @06,UCLRTNCD                                        1878 06445000
*   RETURN CODE(ZERO);              /*                               */ 06446000
*                                                                  1879 06447000
         SLR   @15,@15                                             1879 06448000
         L     @14,@SA00018                                        1879 06449000
         LM    @00,@12,@SA00018+8                                  1879 06450000
         BR    @14                                                 1879 06451000
*   /*****************************************************************/ 06452000
*   /*                                                               */ 06453000
*   /* PROCEDURE CALLED TO WRITE MSG HMA402I                 @Z63SP00*/ 06454000
*   /*                                                               */ 06455000
*   /*****************************************************************/ 06456000
*                                                                  1880 06457000
*UCL402I:                           /*                               */ 06458000
*   ENTRY(TXT4021,TXT4022);         /*                               */ 06459000
UCL402I  STM   @14,@12,@SA00018                                    1880 06460000
         MVC   @PC00018+12(8),0(@01)                               1880 06461000
*   DECLARE                         /*                               */ 06462000
*     TXT4021 CHAR(8),              /*                               */ 06463000
*     TXT4022 CHAR(16);             /*                               */ 06464000
*   MGPCLEAR=''B;                   /* ZERO MSG PARM                 */ 06465000
         XC    MGPCLEAR(6),MGPCLEAR                                1882 06466000
*   MGPMGNO1=HMA402I;               /* XXXXXXXX IS INVALID FOR     1883 06467000
*                                      XXXXXXXXXXXXXXXX SYSMOD       */ 06468000
         MVC   MGPMGNO1(2),@CH01483                                1883 06469000
*   MGPVARPT(1)=ADDR(TXT4021);      /* FIELD NAME                    */ 06470000
         L     @06,@PC00018+12                                     1884 06471000
         ST    @06,MGPVARPT                                        1884 06472000
*   MGPVARPT(2)=ADDR(TXT4022);      /* SYSMOD TYPE                   */ 06473000
         L     @06,@PC00018+16                                     1885 06474000
         ST    @06,MGPVARPT+4                                      1885 06475000
*   MGPTYPE=MGPERR;                 /*                               */ 06476000
         MVI   MGPTYPE,X'03'                                       1886 06477000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 06478000
         L     @15,@CV01411                                        1887 06479000
         LA    @01,@AL01887                                        1887 06480000
         BALR  @14,@15                                             1887 06481000
*   ERR1SW=ON;                      /*                               */ 06482000
         OI    ERR1SW,B'10000000'                                  1888 06483000
*   RETURN CODE(ZERO);              /*                               */ 06484000
         SLR   @15,@15                                             1889 06485000
         L     @14,@SA00018                                        1889 06486000
         LM    @00,@12,@SA00018+8                                  1889 06487000
         BR    @14                                                 1889 06488000
*   END UCLMSGS;                    /*                               */ 06489000
*   END HMASMUC1                                                   1891 06490000
*                                                                  1891 06491000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06492000
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */ 06493000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 06494000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 06495000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 06496000
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */ 06497000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 06498000
*/*%INCLUDE SYSLIB  (HMASMVLP)                                       */ 06499000
*                                                                  1891 06500000
*       ;                                                          1891 06501000
@DATA    DS    0H                                                       06502000
@CH00043 DC    H'1'                                                     06503000
@CH00291 DC    H'2'                                                     06504000
@CH00045 DC    H'3'                                                     06505000
@CH00145 DC    H'4'                                                     06506000
@CH00061 DC    H'5'                                                     06507000
@CH00307 DC    H'6'                                                     06508000
@CH00037 DC    H'7'                                                     06509000
@CH00036 DC    H'8'                                                     06510000
@CH00538 DC    H'9'                                                     06511000
@CH00048 DC    H'16'                                                    06512000
@CH00553 DC    H'18'                                                    06513000
@CH00560 DC    H'22'                                                    06514000
@CH00568 DC    H'26'                                                    06515000
@CH01462 DC    H'53'                                                    06516000
@CH01110 DC    H'54'                                                    06517000
@CH00809 DC    H'56'                                                    06518000
@CH01115 DC    H'57'                                                    06519000
@CH01117 DC    H'58'                                                    06520000
@CH01119 DC    H'59'                                                    06521000
@CH00909 DC    H'60'                                                    06522000
@CH00355 DC    H'62'                                                    06523000
@CH01471 DC    H'77'                                                    06524000
@CH01473 DC    H'78'                                                    06525000
@CH00618 DC    H'81'                                                    06526000
@CH00620 DC    H'82'                                                    06527000
@CH00622 DC    H'83'                                                    06528000
@CH00624 DC    H'84'                                                    06529000
@CH00626 DC    H'85'                                                    06530000
@CH00628 DC    H'86'                                                    06531000
@CH00630 DC    H'87'                                                    06532000
@CH01475 DC    H'142'                                                   06533000
@CH01477 DC    H'157'                                                   06534000
@CH01479 DC    H'158'                                                   06535000
@CH01481 DC    H'159'                                                   06536000
@CH01152 DC    H'162'                                                   06537000
@CH01154 DC    H'163'                                                   06538000
@CH01156 DC    H'164'                                                   06539000
@CH01158 DC    H'165'                                                   06540000
@CH01160 DC    H'166'                                                   06541000
@CH01164 DC    H'168'                                                   06542000
@CH01168 DC    H'170'                                                   06543000
@CH01483 DC    H'203'                                                   06544000
@CH00726 DC    H'255'                                                   06545000
@SM02279 MVC   IOPNAME(0,IOPPTR),SCPSTRNG(@06)                          06546000
@SM02281 MVC   MSGPART1(0),SCPSTRNG(@06)                                06547000
@SM02289 MVC   MSGPART2(0),SCPSTRNG(@06)                                06548000
@SM02291 MVC   SAVDATA(0),SCPSTRNG(@06)                                 06549000
@SM02294 MVC   0(0,@14),SCPSTRNG(@06)                                   06550000
@SM02296 MVC   VLPDATA(0),BLANK8                                        06551000
@SM02298 MVC   VLPDATA(0),SCPSTRNG(@06)                                 06552000
         DS    0F                                                       06553000
@AL01434 DC    A(HMASMVLP)             LIST WITH   1 ARGUMENT(S)        06554000
@AL01531 DC    A(@CC01514)             LIST WITH   2 ARGUMENT(S)        06555000
         DC    A(@CC01512)                                              06556000
@AL01533 EQU   *                       LIST WITH   2 ARGUMENT(S)        06557000
@AL01615 DC    A(@CC01514)             LIST WITH   2 ARGUMENT(S)        06558000
         DC    A(TXTTYPE)                                               06559000
@AL01535 EQU   *                       LIST WITH   2 ARGUMENT(S)        06560000
@AL01514 DC    A(@CC01516)             LIST WITH   1 ARGUMENT(S)        06561000
         DC    A(MSGPART1)                                              06562000
@AL01538 EQU   *                       LIST WITH   2 ARGUMENT(S)        06563000
@AL01556 EQU   *                       LIST WITH   1 ARGUMENT(S)        06564000
@AL01624 EQU   *                       LIST WITH   1 ARGUMENT(S)        06565000
@AL01655 EQU   *                       LIST WITH   1 ARGUMENT(S)        06566000
@AL01666 DC    A(@CC01545)             LIST WITH   1 ARGUMENT(S)        06567000
         DC    A(MSGPART1)                                              06568000
@AL01540 EQU   *                       LIST WITH   2 ARGUMENT(S)        06569000
@AL01584 DC    A(@CC01508)             LIST WITH   1 ARGUMENT(S)        06570000
         DC    A(MSGPART1)                                              06571000
@AL01542 EQU   *                       LIST WITH   2 ARGUMENT(S)        06572000
@AL01604 DC    A(@CC01506)             LIST WITH   1 ARGUMENT(S)        06573000
         DC    A(MSGPART1)                                              06574000
@AL01544 EQU   *                       LIST WITH   2 ARGUMENT(S)        06575000
@AL01594 DC    A(@CC01504)             LIST WITH   1 ARGUMENT(S)        06576000
         DC    A(MSGPART1)                                              06577000
@AL01546 EQU   *                       LIST WITH   2 ARGUMENT(S)        06578000
@AL01588 DC    A(@CC01510)             LIST WITH   1 ARGUMENT(S)        06579000
         DC    A(MSGPART1)                                              06580000
@AL01548 DC    A(@CC01537)             LIST WITH   2 ARGUMENT(S)        06581000
         DC    A(MSGPART1)                                              06582000
@AL01608 DC    A(@CC01500)             LIST WITH   1 ARGUMENT(S)        06583000
@AL01610 DC    A(@CC01502)             LIST WITH   1 ARGUMENT(S)        06584000
@AL01613 DC    A(@CC01529)             LIST WITH   2 ARGUMENT(S)        06585000
         DC    A(TXTTYPE)                                               06586000
@AL01628 EQU   *                       LIST WITH   1 ARGUMENT(S)        06587000
@AL01659 EQU   *                       LIST WITH   1 ARGUMENT(S)        06588000
@AL01670 DC    A(@CC01539)             LIST WITH   1 ARGUMENT(S)        06589000
@AL01633 EQU   *                       LIST WITH   1 ARGUMENT(S)        06590000
@AL01676 DC    A(@CC01547)             LIST WITH   1 ARGUMENT(S)        06591000
@AL01696 DC    A(@CC01492)             LIST WITH   1 ARGUMENT(S)        06592000
@AL01698 DC    A(@CC01494)             LIST WITH   1 ARGUMENT(S)        06593000
@AL01700 DC    A(@CC01498)             LIST WITH   1 ARGUMENT(S)        06594000
@AL01747 EQU   *                       LIST WITH   1 ARGUMENT(S)        06595000
@AL01754 EQU   *                       LIST WITH   1 ARGUMENT(S)        06596000
@AL01765 EQU   *                       LIST WITH   1 ARGUMENT(S)        06597000
@AL01773 EQU   *                       LIST WITH   1 ARGUMENT(S)        06598000
@AL01779 EQU   *                       LIST WITH   1 ARGUMENT(S)        06599000
@AL01787 EQU   *                       LIST WITH   1 ARGUMENT(S)        06600000
@AL01795 EQU   *                       LIST WITH   1 ARGUMENT(S)        06601000
@AL01807 EQU   *                       LIST WITH   1 ARGUMENT(S)        06602000
@AL01817 EQU   *                       LIST WITH   1 ARGUMENT(S)        06603000
@AL01826 EQU   *                       LIST WITH   1 ARGUMENT(S)        06604000
@AL01835 EQU   *                       LIST WITH   1 ARGUMENT(S)        06605000
@AL01845 EQU   *                       LIST WITH   1 ARGUMENT(S)        06606000
@AL01859 EQU   *                       LIST WITH   1 ARGUMENT(S)        06607000
@AL01868 EQU   *                       LIST WITH   1 ARGUMENT(S)        06608000
@AL01877 EQU   *                       LIST WITH   1 ARGUMENT(S)        06609000
@AL01887 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        06610000
         DS    0F                                                       06611000
@SA00001 DS    18F                                                      06612000
@PC00001 DS    2F                                                       06613000
@SA00016 DS    15F                                                      06614000
@SA00003 DS    15F                                                      06615000
@SA00004 DS    15F                                                      06616000
@SA00005 DS    15F                                                      06617000
@SA00006 DS    15F                                                      06618000
@SA00007 DS    15F                                                      06619000
@SA00009 DS    15F                                                      06620000
@SA00018 DS    0F                                                       06621000
@PC00018 EQU   @SA00018+60                                              06622000
@SA00011 DS    0F                                                       06623000
@SA00017 DS    0F                                                       06624000
@SA00014 DS    0F                                                       06625000
         DS    20F                                                      06626000
@AL00001 DS    2A                                                       06627000
         DS    0F                                                       06628000
@CF02300 DC    F'-8'                                                    06629000
@CV01407 DC    V(HMASMCRD)                                              06630000
@CV01408 DC    V(HMASMDS1)                                              06631000
@CV01409 DC    V(HMASMIO)                                               06632000
@CV01410 DC    V(HMASMSCN)                                              06633000
@CV01411 DC    V(HMASMMSG)                                              06634000
@CV01412 DC    V(HMASMVLU)                                              06635000
         DS    0D                                                       06636000
SCPPTR   DS    A                                                        06637000
SAVBUFAD DS    A                                                        06638000
DATEPTR  DS    A                                                        06639000
LOOPINDX DS    A                                                        06640000
PTFX     DS    F                                                        06641000
ADFLSHTB DC    AL4(KFLUSH)                                              06642000
ADSCNTBL DC    AL4(KENDUCL)                                             06643000
ENTCNT   DS    F                                                        06644000
CVB15    DS    H                                                        06645000
NEWPEMAX DS    H                                                        06646000
STYPE    DC    AL1(0)                                                   06647000
UCLRTNCD DS    FL1                                                      06648000
UC1DSID  DS    FL1                                                      06649000
@CC01531 DC    C'DELETED         '                                      06650000
@CC01534 DC    C'SUPERSEDED ONLY '                                      06651000
@CC01428 DC    C'00000000'                                              06652000
@CC01492 DC    C'SREL    '                                              06653000
@CC01494 DC    C'NUCID   '                                              06654000
@CC01496 DC    C'PEMAX   '                                              06655000
@CC01498 DC    C'CDSID   '                                              06656000
@CC01500 DC    C'APPLY   '                                              06657000
@CC01502 DC    C'ACCEPT  '                                              06658000
@CC01504 DC    C'RESDATE '                                              06659000
@CC01506 DC    C'APPDATE '                                              06660000
@CC01508 DC    C'RECDATE '                                              06661000
@CC01510 DC    C'ACCDATE '                                              06662000
@CC01512 DC    C'LASTSUP '                                              06663000
@CC01514 DC    C'DELBY   '                                              06664000
@CC01516 DC    C'SUBENTRY'                                              06665000
@CC01518 DC    C'SMD-TYP '                                              06666000
@CC01520 DC    C'PTF     '                                              06667000
@CC01522 DC    C'FUNCTION'                                              06668000
@CC01524 DC    C'APAR    '                                              06669000
@CC01526 DC    C'USERMOD '                                              06670000
@CC01529 DC    C'NPRE    '                                              06671000
@CC01537 DC    C'STATUS  '                                              06672000
@CC01539 DC    C'DISTLIB '                                              06673000
@CC01545 DC    C'FMID    '                                              06674000
@CC01547 DC    C'SYSLIB  '                                              06675000
@CC01416 DC    C'       '                                               06676000
@CC01490 DC    C'UCLIN  '                                               06677000
@CC01418 EQU   @CC01416                                                 06678000
@CC01541 DC    C'RMID'                                                  06679000
@CC01596 DC    C'Y'                                                     06680000
         DS    CL2                                                      06681000
HMASMMGP DS    CL32                                                     06682000
         ORG   HMASMMGP                                                 06683000
MGPFIXED DS    CL12                                                     06684000
         ORG   MGPFIXED                                                 06685000
MGPCLEAR DS    CL6                                                      06686000
         ORG   MGPCLEAR                                                 06687000
MGPMGNO1 DS    FL2                                                      06688000
MGPMGNO2 DS    FL2                                                      06689000
MGPMGNO3 DS    FL2                                                      06690000
         ORG   MGPFIXED+6                                               06691000
MGPFLAGS DS    BL2                                                      06692000
         ORG   MGPFLAGS                                                 06693000
MGPPRINT DS    BL1                                                      06694000
MGPLIST  EQU   MGPFLAGS+0                                               06695000
MGPRPT   EQU   MGPFLAGS+0                                               06696000
MGPHLDS  EQU   MGPFLAGS+0                                               06697000
MGPWTOR  EQU   MGPFLAGS+0                                               06698000
MGPWTO   EQU   MGPFLAGS+0                                               06699000
MGPWTP   EQU   MGPFLAGS+0                                               06700000
@NM00184 EQU   MGPFLAGS+0                                               06701000
         ORG   MGPFIXED+8                                               06702000
MGPTYPE  DS    FL1                                                      06703000
@NM00185 DS    CL3                                                      06704000
         ORG   HMASMMGP+12                                              06705000
MGPVAR   DS    CL20                                                     06706000
         ORG   MGPVAR                                                   06707000
MGPVARPT DS    5A                                                       06708000
         ORG   HMASMMGP+32                                              06709000
HMASMVLP DS    CL52                                                     06710000
         ORG   HMASMVLP                                                 06711000
VLPFUNCT DS    FL1                                                      06712000
VLPRETRN DS    FL1                                                      06713000
VLPFLAG  DS    BL1                                                      06714000
         ORG   VLPFLAG                                                  06715000
VLPFMSG  DS    BL1                                                      06716000
VLPFRSV  EQU   VLPFLAG+0                                                06717000
         ORG   HMASMVLP+3                                               06718000
VLPDLEN  DS    FL1                                                      06719000
VLPSNTRY DS    CL9                                                      06720000
         ORG   VLPSNTRY                                                 06721000
VLPDATA  DS    CL8                                                      06722000
VLPTYPE  DS    FL1                                                      06723000
         ORG   HMASMVLP+13                                              06724000
@NM00186 DS    CL3                                                      06725000
VLPLPTR  DS    AL4                                                      06726000
VLPMTYPE DS    CL8                                                      06727000
VLPMNAME DS    CL8                                                      06728000
VLPSTYPE DS    CL16                                                     06729000
         ORG   HMASMVLP+52                                              06730000
BLANK8   DC    CL8'        '                                            06731000
PACK8    DS    CL8                                                      06732000
CHAR8    DS    CL8                                                      06733000
CHAR12   DS    CL12                                                     06734000
CNVDATE  DS    CL5                                                      06735000
         ORG   CNVDATE                                                  06736000
@NM00187 DS    CL2                                                      06737000
DAY      DS    CL3                                                      06738000
         ORG   CNVDATE+5                                                06739000
SAVNAME  DS    CL8                                                      06740000
TEMPDATE DS    CL3                                                      06741000
SAVDATA  DS    CL8                                                      06742000
SAVDATE  DS    CL6                                                      06743000
         ORG   SAVDATE                                                  06744000
@NM00190 DS    CL3                                                      06745000
@NM00191 DS    CL3                                                      06746000
         ORG   SAVDATE+6                                                06747000
PATCHUC1 DS    CL80                                                     06748000
         ORG   PATCHUC1                                                 06749000
@NM00192 DC    80X'FF'                                                  06750000
         ORG   PATCHUC1+80                                              06751000
TXTTYPE  DC    CL8'        '                                            06752000
MSGPARTS DS    CL132                                                    06753000
         ORG   MSGPARTS                                                 06754000
MSGPART1 DS    CL16                                                     06755000
MSGPART2 DS    CL16                                                     06756000
MSGPART3 DS    CL100                                                    06757000
         ORG   MSGPARTS+132                                             06758000
         DS    CL2                                                      06759000
UCLSWTBL DS    CL5                                                      06760000
         ORG   UCLSWTBL                                                 06761000
UCLVERB  DS    BL1                                                      06762000
         ORG   UCLVERB                                                  06763000
REP      DS    BL1                                                      06764000
DEL      EQU   UCLVERB+0                                                06765000
ADD      EQU   UCLVERB+0                                                06766000
TOTAL    EQU   UCLVERB+0                                                06767000
TOTALDEL EQU   UCLVERB+0                                                06768000
UNCDEL   EQU   UCLVERB+0                                                06769000
FRSTREPL EQU   UCLVERB+0                                                06770000
@NM00193 EQU   UCLVERB+0                                                06771000
         ORG   UCLSWTBL+1                                               06772000
UCLTYPE  DS    BL2                                                      06773000
         ORG   UCLTYPE                                                  06774000
PTF      DS    BL1                                                      06775000
CSECT    EQU   UCLTYPE+0                                                06776000
LMOD     EQU   UCLTYPE+0                                                06777000
MACRO    EQU   UCLTYPE+0                                                06778000
DLIB     EQU   UCLTYPE+0                                                06779000
SYS      EQU   UCLTYPE+0                                                06780000
SRC      EQU   UCLTYPE+0                                                06781000
ASSEM    EQU   UCLTYPE+0                                                06782000
ZAP      DS    BL1                                                      06783000
@NM00194 EQU   UCLTYPE+1                                                06784000
         ORG   UCLSWTBL+3                                               06785000
SYSTYPE  DS    BL1                                                      06786000
         ORG   SYSTYPE                                                  06787000
PEMAX    DS    BL1                                                      06788000
PECHNG   EQU   SYSTYPE+0                                                06789000
DATEENT  EQU   SYSTYPE+0                                                06790000
@NM00195 EQU   SYSTYPE+0                                                06791000
         ORG   UCLSWTBL+4                                               06792000
UCLERRSW DS    BL1                                                      06793000
         ORG   UCLERRSW                                                 06794000
ERR1SW   DS    BL1                                                      06795000
ERR2SW   EQU   UCLERRSW+0                                               06796000
STOP     EQU   UCLERRSW+0                                               06797000
ERRAFTPR EQU   UCLERRSW+0                                               06798000
UCLTERM  EQU   UCLERRSW+0                                               06799000
INVLOP   EQU   UCLERRSW+0                                               06800000
DELERR   EQU   UCLERRSW+0                                               06801000
SUPONLY  EQU   UCLERRSW+0                                               06802000
         ORG   UCLSWTBL+5                                               06803000
HMASMUC1 CSECT                                                          06804000
**********************************************************************  06805000
*                                                                    *  06806000
*    UCL SCAN TABLES - THESE TABLES ARE USED BY THE SMP              *  06807000
*   SCAN ROUTINE. THEY CONTAIN THE KEYWORDS TO SEARCH FOR AND ALSO   *  06808000
*   THE LOGICAL ORDER OF THE SEARCH ( AS DETERMINED BY THE ALT       *  06809000
*      AND SUCCESSOR)                                                *  06810000
*                                                                    *  06811000
**********************************************************************  06812000
*                                                                    *  06813000
*                      VERB SCAN TABLE                               *  06814000
*                                                                    *  06815000
**********************************************************************  06816000
KENDUCL  DSCAN KEY='ENDUCL',ALT=KREP00,SUCC=KENDPER,ROUT=RENDUCL,      X06817000
               CALLRT=YES                                               06818000
KREP00   DSCAN KEY='REP ',ALT=KDEL00,SUCC=KSMD00,ROUT=RREP00,          X06819000
               CALLRT=YES                                               06820000
KDEL00   DSCAN KEY='DEL ',ALT=KADD00,SUCC=KSMD00,ROUT=RDEL00,          X06821000
               CALLRT=YES                                               06822000
KADD00   DSCAN KEY='ADD ',SUCC=KSMD00,ROUT=RADD00,                     X06823000
               CALLRT=YES                                               06824000
HMASMUC1 CSECT                                                          06825000
**********************************************************************  06826000
*                                                                    *  06827000
*             SCAN TABLE FOR ENDING PERIOD PLUS CONTINUED COMMENTS   *  06828000
*                                                                    *  06829000
**********************************************************************  06830000
KENDPER  DSCAN KEY='.',SUCC=KXTRADTA                                    06831000
KXTRADTA DSCAN MINLEN=0,IO=NO,ROUT=RXTRADTA,CALLRT=YES                  06832000
HMASMUC1 CSECT                                                          06833000
**********************************************************************  06834000
*                                                                    *  06835000
*             SCAN TABLE FOR DETERMINATION OF ENTRY TYPE             *  06836000
*                                                                    *  06837000
**********************************************************************  06838000
KSMD00   DSCAN KEY='SYSMOD',ALT=KSMD01,SUCC=KSMDLP01,ROUT=RSMD00,      X06839000
               CALLRT=YES                                               06840000
KSMD01   DSCAN KEY='PTF',ALT=KMOD00,SUCC=KSMDLP01,ROUT=RSMD00,         X06841000
               CALLRT=YES                                               06842000
KMOD00   DSCAN KEY='MOD',ALT=KLMD00,SUCC=KMODLP01,ROUT=RMOD00,         X06843000
               CALLRT=YES                                               06844000
KLMD00   DSCAN KEY='LMOD',ALT=KMAC00,SUCC=KLMDLP01,ROUT=RLMD00,        X06845000
               CALLRT=YES                                               06846000
KMAC00   DSCAN KEY='MAC',ALT=KSRC00,SUCC=KMACLP01,ROUT=RMAC00,         X06847000
               CALLRT=YES                                               06848000
KSRC00   DSCAN KEY='SRC',ALT=KDLB00,SUCC=KSRCLP01,ROUT=RSRC00,         X06849000
               CALLRT=YES                                               06850000
KDLB00   DSCAN KEY='DLIB',ALT=KASM00,SUCC=KDLBLP01,ROUT=RDLB00,        X06851000
               CALLRT=YES                                               06852000
KASM00   DSCAN KEY='ASSEM',ALT=KSYS00,SUCC=KASMLP01,ROUT=RASM00,       X06853000
               CALLRT=YES                                               06854000
KSYS00   DSCAN KEY='SYS',SUCC=KSYSTD,ROUT=RSYS00,                      X06855000
               CALLRT=YES                                               06856000
HMASMUC1 CSECT                                                          06857000
**********************************************************************  06858000
*                                                                    *  06859000
*     SYSMOD OPTIONS SCAN TABLE                                      *  06860000
*                                                                    *  06861000
**********************************************************************  06862000
KSMDLP01 DSCAN KEY='(',SUCC=KSMDNAM                                     06863000
KSMDNAM  DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDRP01,ROUT=RXXXNAM     06864000
KSMDRP01 DSCAN KEY=')',SUCC=KSMDTD                                      06865000
KSMDTD   DSCAN KEY='.',ALT=KSMDRECD,SUCC=KXTRADTA,ROUT=RXXXTD           06866000
*****                                                                   06867000
*****    DSCAN FOR PTF DATE KEYWORD                                     06868000
*****                                                                   06869000
KSMDRECD DSCAN KEY='RECDATE',ALT=KSMDAPPD,SUCC=KSMDDTLP,ROUT=RSMDRECD   06870000
KSMDAPPD DSCAN KEY='APPDATE',ALT=KSMDRESD,SUCC=KSMDDTLP,ROUT=RSMDAPPD   06871000
KSMDRESD DSCAN KEY='RESDATE',ALT=KSMDACCD,SUCC=KSMDDTLP,ROUT=RSMDRESD   06872000
KSMDACCD DSCAN KEY='ACCDATE',ALT=KSMDDATE,SUCC=KSMDDTLP,ROUT=RSMDACCD   06873000
KSMDDATE DSCAN KEY='DATE',ALT=KSMDAPP1,SUCC=KSMDDTLP,ROUT=RSMDDATE      06874000
KSMDDTLP DSCAN KEY='(',SUCC=KSMDDTD                                     06875000
KSMDDTD  DSCAN KEY=')',ALT=KSMDDTV,SUCC=KSMDRECD,ROUT=RSMDDTD           06876000
KSMDDTV  DSCAN MINLEN=5,MAXLEN=5,TYPE=N,SUCC=KSMDDTRP,ROUT=RSMDDTV      06877000
KSMDDTRP DSCAN KEY=')',SUCC=KSMDRECD                                    06878000
*****                                                                   06879000
*****    DSCAN TO HANDLE THE PTF STATUS KEYWORDS                        06880000
*****                                                                   06881000
KSMDAPP1 DSCAN KEY='APPLY',ALT=KSMDAPP2,SUCC=KSMDRECD,ROUT=RSMDAPP      06882000
KSMDAPP2 DSCAN KEY='APPL',ALT=KSMDAPP3,SUCC=KSMDRECD,ROUT=RSMDAPP       06883000
KSMDAPP3 DSCAN KEY='APP',ALT=KSMDACC1,SUCC=KSMDRECD,ROUT=RSMDAPP        06884000
KSMDACC1 DSCAN KEY='ACCEPT',ALT=KSMDACC2,SUCC=KSMDRECD,ROUT=RSMDACC     06885000
KSMDACC2 DSCAN KEY='ACPT',ALT=KSMDACC3,SUCC=KSMDRECD,ROUT=RSMDACC       06886000
KSMDACC3 DSCAN KEY='ACC',ALT=KSMDBYP1,SUCC=KSMDRECD,ROUT=RSMDACC        06887000
KSMDBYP1 DSCAN KEY='BYPASS',ALT=KSMDBYP2,SUCC=KSMDRECD,ROUT=RSMDBYP     06888000
KSMDBYP2 DSCAN KEY='BYP',ALT=KSMDRGN1,SUCC=KSMDRECD,ROUT=RSMDBYP        06889000
KSMDRGN1 DSCAN KEY='REGEN',ALT=KSMDRGN2,SUCC=KSMDRECD,ROUT=RSMDRGN      06890000
KSMDRGN2 DSCAN KEY='RGN',ALT=KSMDERR1,SUCC=KSMDRECD,ROUT=RSMDRGN        06891000
KSMDERR1 DSCAN KEY='ERROR',ALT=KSMDERR2,SUCC=KSMDRECD,ROUT=RSMDERR      06892000
KSMDERR2 DSCAN KEY='ERR',ALT=KSMDRES1,SUCC=KSMDRECD,ROUT=RSMDERR        06893000
KSMDRES1 DSCAN KEY='RESTORE',ALT=KSMDRES2,SUCC=KSMDRECD,ROUT=RSMDRES    06894000
KSMDRES2 DSCAN KEY='REST',ALT=KSMDRES3,SUCC=KSMDRECD,ROUT=RSMDRES       06895000
KSMDRES3 DSCAN KEY='RES',ALT=KSMDFNC1,SUCC=KSMDRECD,ROUT=RSMDRES        06896000
*****                                                                   06897000
*****    DSCAN FOR TYPE SYSMOD OPTIONS                                  06898000
*****                                                                   06899000
KSMDFNC1 DSCAN KEY='FUNCTION',ALT=KSMDPTF1,SUCC=KSMDRECD,ROUT=RSMDFNC   06900000
KSMDPTF1 DSCAN KEY='PTF',ALT=KSMDAPR1,SUCC=KSMDRECD,ROUT=RSMDPTF        06901000
KSMDAPR1 DSCAN KEY='APAR',ALT=KSMDUSR1,SUCC=KSMDRECD,ROUT=RSMDAPR       06902000
KSMDUSR1 DSCAN KEY='USERMOD',ALT=KSMDMOD,SUCC=KSMDRECD,ROUT=RSMDUSR     06903000
*****                                                                   06904000
*****    DSCAN FOR VARIOUS TYPEELEMENT SUB-ENTRIES                      06905000
*****                                                                   06906000
KSMDMOD  DSCAN KEY='MOD',ALT=KSMDMCU1,SUCC=KSMDXLP,ROUT=RSMDMOD         06907000
KSMDMCU1 DSCAN KEY='MACUPD',ALT=KSMDMCU2,SUCC=KSMDXLP,ROUT=RSMDMCU      06908000
KSMDMCU2 DSCAN KEY='UPDTE',ALT=KSMDMCR,SUCC=KSMDXLP,ROUT=RSMDMCU        06909000
KSMDMCR  DSCAN KEY='MAC',ALT=KSMDSCU,SUCC=KSMDXLP,ROUT=RSMDMCR          06910000
KSMDSCU  DSCAN KEY='SRCUPD',ALT=KSMDSCR,SUCC=KSMDXLP,ROUT=RSMDSCU       06911000
KSMDSCR  DSCAN KEY='SRC',ALT=KSMDSZP,SUCC=KSMDXLP,ROUT=RSMDSCR          06912000
KSMDSZP  DSCAN KEY='SZAP',ALT=KSMDXZP,SUCC=KSMDXLP,ROUT=RSMDSZP         06913000
KSMDXZP  DSCAN KEY='XZAP',ALT=KSMDASM,SUCC=KSMDXLP,ROUT=RSMDXZP         06914000
KSMDASM  DSCAN KEY='ASSEM',ALT=KSMDRMDR,SUCC=KSMDXLP,ROUT=RSMDASM       06915000
KSMDRMDR DSCAN KEY='RMOD',ALT=KSMDRMCU,SUCC=KSMDXLP,ROUT=RSMDRMOD       06916000
KSMDRMCU DSCAN KEY='RMUPD',ALT=KSMDRMCR,SUCC=KSMDXLP,ROUT=RSMDRMCU      06917000
KSMDRMCR DSCAN KEY='RMAC',ALT=KSMDRSCU,SUCC=KSMDXLP,ROUT=RSMDRMCR       06918000
KSMDRSCU DSCAN KEY='RSUPD',ALT=KSMDRSCR,SUCC=KSMDXLP,ROUT=RSMDRSCU      06919000
KSMDRSCR DSCAN KEY='RSRC',ALT=KSMDRSZP,SUCC=KSMDXLP,ROUT=RSMDRSCR       06920000
KSMDRSZP DSCAN KEY='RSZAP',ALT=KSMDRXZP,SUCC=KSMDXLP,ROUT=RSMDRSZP      06921000
KSMDRXZP DSCAN KEY='RXZAP',ALT=KSMDPRE,SUCC=KSMDXLP,ROUT=RSMDRXZP       06922000
KSMDXLP  DSCAN KEY='(',SUCC=KSMDXDEL,ROUT=RESETRPL                      06923000
KSMDXDEL DSCAN KEY=')',ALT=KSMDXNAM,SUCC=KSMDRECD,ROUT=RSMDXDEL         06924000
KSMDXNAM DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KSMDXRP,ROUT=RSMDXNAM     06925000
KSMDXRP  DSCAN KEY=')',ALT=KSMDXNAM,SUCC=KSMDRECD,COMMA=NO              06926000
*****                                                                   06927000
*****    DSCANS TO HANDLE THE PTF NUMBER SUB-ENTRIES                    06928000
*****                                                                   06929000
KSMDPRE  DSCAN KEY='PRE',ALT=KSMDREQ,SUCC=KSMDYLP,ROUT=RSMDPRE          06930000
KSMDREQ  DSCAN KEY='REQ',ALT=KSMDNPR,SUCC=KSMDYLP,ROUT=RSMDREQ          06931000
KSMDNPR  DSCAN KEY='NPRE',ALT=KSMDISUP,SUCC=KSMDYLP,ROUT=RSMDNPR        06932000
KSMDISUP DSCAN KEY='SUPING',ALT=KSMDVERS,SUCC=KSMDYLP,ROUT=RSMDISUP     06933000
KSMDVERS DSCAN KEY='VERSION',ALT=KSMDSBY1,SUCC=KSMDYLP,ROUT=RSMDVERS    06934000
KSMDSBY1 DSCAN KEY='SUPBY',ALT=KSMDSBY2,SUCC=KSMDYLP,ROUT=RSMDSBY       06935000
KSMDSBY2 DSCAN KEY='SUP',ALT=KSMDDEL,SUCC=KSMDYLP,ROUT=RSMDSBY          06936000
KSMDDEL  DSCAN KEY='DELETE',ALT=KSMDLSUP,SUCC=KSMDYLP,ROUT=RSMDDEL      06937000
KSMDYLP  DSCAN KEY='(',SUCC=KSMDYDEL,ROUT=RESETRPL                      06938000
KSMDYDEL DSCAN KEY=')',ALT=KSMDYNAM,SUCC=KSMDRECD,ROUT=RSMDYDEL         06939000
KSMDYNAM DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDYRP,ROUT=RSMDYNAM     06940000
KSMDYRP  DSCAN KEY=')',ALT=KSMDYNAM,SUCC=KSMDRECD,COMMA=NO              06941000
*****                                                                   06942000
*****    DSCANS TO HANDLE THE LAST SUP KEYWORD                          06943000
*****                                                                   06944000
KSMDLSUP DSCAN KEY='LASTSUP',ALT=KSMDDBY,SUCC=KSMDLSLP                  06945000
KSMDLSLP DSCAN KEY='(',SUCC=KSMDLSTD                                    06946000
KSMDLSTD DSCAN KEY=')',ALT=KSMDLSV,SUCC=KSMDRECD,ROUT=RSMDLSTD          06947000
KSMDLSV  DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDLSRP,ROUT=RSMDLSV     06948000
KSMDLSRP DSCAN KEY=')',SUCC=KSMDRECD                                    06949000
*****                                                                   06950000
*****    DSCANS TO HANDLE THE DELBY KEYWORD                             06951000
*****                                                                   06952000
KSMDDBY  DSCAN KEY='DELBY',ALT=KSMDFMD,SUCC=KSMDDBLP                    06953000
KSMDDBLP DSCAN KEY='(',SUCC=KSMDDBTD                                    06954000
KSMDDBTD DSCAN KEY=')',ALT=KSMDDBYV,SUCC=KSMDRECD,ROUT=RSMDDBTD         06955000
KSMDDBYV DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDDBRP,ROUT=RSMDDBYV    06956000
KSMDDBRP DSCAN KEY=')',SUCC=KSMDRECD                                    06957000
*****                                                                   06958000
*****    DSCANS TO HANDLE THE FMID KEYWORD                              06959000
*****                                                                   06960000
KSMDFMD  DSCAN KEY='FMID',ALT=KENDPER,SUCC=KSMDFMLP                     06961000
KSMDFMLP DSCAN KEY='(',SUCC=KSMDFMDD                                    06962000
KSMDFMDD DSCAN KEY=')',ALT=KSMDFMDV,SUCC=KSMDRECD,ROUT=RSMDFMDD         06963000
KSMDFMDV DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDFMRP,ROUT=RSMDFMDV    06964000
KSMDFMRP DSCAN KEY=')',SUCC=KSMDRECD                                    06965000
HMASMUC1 CSECT                                                          06966000
**********************************************************************  06967000
*                                                                    *  06968000
*                     MODULE TYPE SCAN TABLE                         *  06969000
*                                                                    *  06970000
**********************************************************************  06971000
KMODLP01 DSCAN KEY='(',SUCC=KMODNAM                                     06972000
KMODNAM  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMODRP01,ROUT=RXXXNAM     06973000
KMODRP01 DSCAN KEY=')',SUCC=KMODTD                                      06974000
KMODTD   DSCAN KEY='.',ALT=KMODRMID,SUCC=KXTRADTA,ROUT=RXXXTD           06975000
KMODRMID DSCAN KEY='RMID',ALT=KMODUMID,SUCC=KMODRMLP                    06976000
KMODRMLP DSCAN KEY='(',SUCC=KMODRMDD                                    06977000
KMODRMDD DSCAN KEY=')',ALT=KMODRMDV,SUCC=KMODRMID,ROUT=RMODRMDD         06978000
KMODRMDV DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KMODRMRP,ROUT=RMODRMDV    06979000
KMODRMRP DSCAN KEY=')',SUCC=KMODRMID                                    06980000
KMODUMID DSCAN KEY='UMID',ALT=KMODDLB1,SUCC=KMODUMLP,ROUT=RMODUMID      06981000
KMODUMLP DSCAN KEY='(',SUCC=KMODUMD,ROUT=RESETRPL                       06982000
KMODUMD  DSCAN KEY=')',ALT=KMODUMV,SUCC=KMODRMID,ROUT=RMODUMDD          06983000
KMODUMV  DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KMODUMRP,ROUT=RMODXNAM    06984000
KMODUMRP DSCAN KEY=')',ALT=KMODUMV,SUCC=KMODRMID,COMMA=NO               06985000
KMODDLB1 DSCAN KEY='DLIB',ALT=KMODDLB2,SUCC=KMODDLLP                    06986000
KMODDLB2 DSCAN KEY='DISTLIB',ALT=KMODLMOD,SUCC=KMODDLLP                 06987000
KMODDLLP DSCAN KEY='(',SUCC=KMODDLBD                                    06988000
KMODDLBD DSCAN KEY=')',ALT=KMODDLBV,SUCC=KMODRMID,ROUT=RMODDLBD         06989000
KMODDLBV DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMODDLRP,ROUT=RMODDLBV    06990000
KMODDLRP DSCAN KEY=')',SUCC=KMODRMID                                    06991000
KMODLMOD DSCAN KEY='LMOD',ALT=KMODFMID,SUCC=KMODLMLP,ROUT=RMODLMOD      06992000
KMODLMLP DSCAN KEY='(',SUCC=KMODLMDD,ROUT=RESETRPL                      06993000
KMODLMDD DSCAN KEY=')',ALT=KMODLMDV,SUCC=KMODRMID,ROUT=RMODLMDD         06994000
KMODLMDV DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMODLMRP,ROUT=RMODXNAM    06995000
KMODLMRP DSCAN KEY=')',ALT=KMODLMDV,SUCC=KMODRMID,COMMA=NO              06996000
KMODFMID DSCAN KEY='FMID',ALT=KMODTAL,SUCC=KMODFMLP                     06997000
KMODFMLP DSCAN KEY='(',SUCC=KMODFMDD                                    06998000
KMODFMDD DSCAN KEY=')',ALT=KMODFMDV,SUCC=KMODRMID,ROUT=RMODFMDD         06999000
KMODFMDV DSCAN MINLEN=1,MAXLEN=7,TYPE=AN,SUCC=KMODFMRP,ROUT=RMODFMDV    07000000
KMODFMRP DSCAN KEY=')',SUCC=KMODRMID                                    07001000
KMODTAL  DSCAN KEY='TALIAS',ALT=KMODDAL,SUCC=KMODTALP,ROUT=RMODTAL      07002000
KMODTALP DSCAN KEY='(',SUCC=KMODTALD,ROUT=RESETRPL                      07003000
KMODTALD DSCAN KEY=')',ALT=KMODTALV,SUCC=KMODRMID,ROUT=RMODTALD         07004000
KMODTALV DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMODTARP,ROUT=RMODXNAM    07005000
KMODTARP DSCAN KEY=')',ALT=KMODTALV,SUCC=KMODRMID,COMMA=NO              07006000
KMODDAL  DSCAN KEY='DALIAS',ALT=KENDPER,SUCC=KMODDALP,ROUT=RMODDAL      07007000
KMODDALP DSCAN KEY='(',SUCC=KMODDALD,ROUT=RESETRPL                      07008000
KMODDALD DSCAN KEY=')',ALT=KMODDALV,SUCC=KMODRMID,ROUT=RMODDALD         07009000
KMODDALV DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMODDARP,ROUT=RMODXNAM    07010000
KMODDARP DSCAN KEY=')',SUCC=KMODRMID                                    07011000
HMASMUC1 CSECT                                                          07012000
**********************************************************************  07013000
*                                                                    *  07014000
*                    LOAD MODULE TYPE SCAN TABLE                     *  07015000
*                                                                    *  07016000
**********************************************************************  07017000
KLMDLP01 DSCAN KEY='(',SUCC=KLMDNAM                                     07018000
KLMDNAM  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KLMDRP01,ROUT=RXXXNAM     07019000
KLMDRP01 DSCAN KEY=')',SUCC=KLMDTD                                      07020000
KLMDTD   DSCAN KEY='.',ALT=KLMDRENT,SUCC=KXTRADTA,ROUT=RXXXTD           07021000
KLMDRENT DSCAN KEY='RENT',ALT=KLMDREUS,SUCC=KLMDRENT,ROUT=RLMDRENT      07022000
KLMDREUS DSCAN KEY='REUS',ALT=KLMDSCTR,SUCC=KLMDRENT,ROUT=RLMDREUS      07023000
KLMDSCTR DSCAN KEY='SCTR',ALT=KLMDOVLY,SUCC=KLMDRENT,ROUT=RLMDSCTR      07024000
KLMDOVLY DSCAN KEY='OVLY',ALT=KLMDREFR,SUCC=KLMDRENT,ROUT=RLMDOVLY      07025000
KLMDREFR DSCAN KEY='REFR',ALT=KLMDDC,SUCC=KLMDRENT,ROUT=RLMDREFR        07026000
KLMDDC   DSCAN KEY='DC',ALT=KLMDNE,SUCC=KLMDRENT,ROUT=RLMDDC            07027000
KLMDNE   DSCAN KEY='NE',ALT=KLMDAPF,SUCC=KLMDRENT,ROUT=RLMDNE           07028000
KLMDAPF  DSCAN KEY='AC=1',ALT=KLMDALN2,SUCC=KLMDRENT,ROUT=RLMDAPF       07029000
KLMDALN2 DSCAN KEY='ALN2',ALT=KLMDAL2B,SUCC=KLMDRENT,ROUT=RLMDALN2      07030000
KLMDAL2B DSCAN KEY='ALIGN2',ALT=KLMDSTD,SUCC=KLMDRENT,ROUT=RLMDALN2     07031000
KLMDSTD  DSCAN KEY='STD',ALT=KLMDCOPY,SUCC=KLMDRENT,ROUT=RLMDSTD        07032000
KLMDCOPY DSCAN KEY='COPY',ALT=KLMDSYLB,SUCC=KLMDRENT,ROUT=RLMDCOPY      07033000
KLMDSYLB DSCAN KEY='SYSLIB',ALT=KENDPER,SUCC=KLMDSYLP,ROUT=RLMDSYLB     07034000
KLMDSYLP DSCAN KEY='(',SUCC=KLMDSYD,ROUT=RESETRPL                       07035000
KLMDSYD  DSCAN KEY=')',ALT=KLMDSYV,SUCC=KLMDRENT,ROUT=RLMDSYD           07036000
KLMDSYV  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KLMDSYRP,ROUT=RLMDSYV     07037000
KLMDSYRP DSCAN KEY=')',ALT=KLMDSYV,SUCC=KLMDRENT,COMMA=NO               07038000
HMASMUC1 CSECT                                                          07039000
**********************************************************************  07040000
*                                                                    *  07041000
*                      MACRO TYPE SCAN TABLE                         *  07042000
*                                                                    *  07043000
**********************************************************************  07044000
KMACLP01 DSCAN KEY='(',SUCC=KMACNAM                                     07045000
KMACNAM  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMACRP01,ROUT=RXXXNAM     07046000
KMACRP01 DSCAN KEY=')',SUCC=KMACTD                                      07047000
KMACTD   DSCAN KEY='.',ALT=KMACDLIB,SUCC=KXTRADTA,ROUT=RXXXTD           07048000
KMACDLIB DSCAN KEY='DISTLIB',ALT=KMACDLB2,SUCC=KMACDLLP                 07049000
KMACDLB2 DSCAN KEY='DLIB',ALT=KMACSYLB,SUCC=KMACDLLP                    07050000
KMACDLLP DSCAN KEY='(',SUCC=KMACDLBD                                    07051000
KMACDLBD DSCAN KEY=')',ALT=KMACDLBV,SUCC=KMACDLIB,ROUT=RMACDLBD         07052000
KMACDLBV DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMACDLRP,ROUT=RMACDLBV    07053000
KMACDLRP DSCAN KEY=')',SUCC=KMACDLIB                                    07054000
KMACSYLB DSCAN KEY='SYSLIB',ALT=KMACFMID,SUCC=KMACSYLP                  07055000
KMACSYLP DSCAN KEY='(',SUCC=KMACSYD                                     07056000
KMACSYD  DSCAN KEY=')',ALT=KMACSYV,SUCC=KMACDLIB,ROUT=RMACSYD           07057000
KMACSYV  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMACSYRP,ROUT=RMACSYV     07058000
KMACSYRP DSCAN KEY=')',SUCC=KMACDLIB                                    07059000
KMACFMID DSCAN KEY='FMID',ALT=KMACRMID,SUCC=KMACFMLP                    07060000
KMACFMLP DSCAN KEY='(',SUCC=KMACFMDD                                    07061000
KMACFMDD DSCAN KEY=')',ALT=KMACFMDV,SUCC=KMACDLIB,ROUT=RMACFMDD         07062000
KMACFMDV DSCAN MINLEN=1,MAXLEN=7,TYPE=AN,SUCC=KMACFMRP,ROUT=RMACFMDV    07063000
KMACFMRP DSCAN KEY=')',SUCC=KMACDLIB                                    07064000
KMACRMID DSCAN KEY='RMID',ALT=KMACUMID,SUCC=KMACRMLP                    07065000
KMACRMLP DSCAN KEY='(',SUCC=KMACRMDD                                    07066000
KMACRMDD DSCAN KEY=')',ALT=KMACRMDV,SUCC=KMACDLIB,ROUT=RMACRMDD         07067000
KMACRMDV DSCAN MINLEN=1,MAXLEN=7,TYPE=AN,SUCC=KMACRMRP,ROUT=RMACRMDV    07068000
KMACRMRP DSCAN KEY=')',SUCC=KMACDLIB                                    07069000
KMACUMID DSCAN KEY='UMID',ALT=KMACGASM,SUCC=KMACXLP,ROUT=RMACUMID       07070000
KMACXLP  DSCAN KEY='(',SUCC=KMACXD,ROUT=RESETRPL                        07071000
KMACXD   DSCAN KEY=')',ALT=KMACXV,SUCC=KMACDLIB,ROUT=RMACXD             07072000
KMACXV   DSCAN MINLEN=1,MAXLEN=7,TYPE=AN,SUCC=KMACXRP,ROUT=RMACXV       07073000
KMACXRP  DSCAN KEY=')',ALT=KMACXV,SUCC=KMACDLIB,COMMA=NO                07074000
KMACGASM DSCAN KEY='GENASM',ALT=KMACMAL,SUCC=KMACYLP,ROUT=RMACGASM,    X07075000
               CALLRT=YES                                               07076000
KMACMAL  DSCAN KEY='MALIAS',ALT=KMACASSM,SUCC=KMACYLP,ROUT=RMACMAL,    X07077000
               CALLRT=YES                                               07078000
KMACYLP  DSCAN KEY='(',SUCC=KMACYD,ROUT=RESETRPL                        07079000
KMACYD   DSCAN KEY=')',ALT=KMACYV,SUCC=KMACDLIB,ROUT=RMACXD             07080000
KMACYV   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMACYRP,ROUT=RMACXV       07081000
KMACYRP  DSCAN KEY=')',ALT=KMACYV,SUCC=KMACDLIB,COMMA=NO                07082000
KMACASSM DSCAN KEY='ASSEM',ALT=KMACASML,SUCC=KMACZLP,ROUT=RMACASSM,    X07083000
               CALLRT=YES                                               07084000
KMACZLP  DSCAN KEY='(',SUCC=KMACZD                                      07085000
KMACZD   DSCAN KEY=')',ALT=KMACZV,SUCC=KMACDLIB                         07086000
KMACZV   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMACZRP                   07087000
KMACZRP  DSCAN KEY=')',ALT=KMACZV,SUCC=KMACDLIB,COMMA=NO                07088000
KMACASML DSCAN KEY='ASMLIB',ALT=KMACBASE,SUCC=KMACALLP,ROUT=RMACASML,  X07089000
               CALLRT=YES                                               07090000
KMACALLP DSCAN KEY='(',SUCC=KMACALD                                     07091000
KMACALD  DSCAN KEY=')',ALT=KMACALV,SUCC=KMACDLIB                        07092000
KMACALV  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KMACALRP                  07093000
KMACALRP DSCAN KEY=')',SUCC=KMACDLIB                                    07094000
KMACBASE DSCAN KEY='BASE',ALT=KENDPER,SUCC=KMACBSLP                     07095000
KMACBSLP DSCAN KEY='(',SUCC=KMACBSFX                                    07096000
KMACBSFX DSCAN KEY='FIXED',SUCC=KMACBSRP                                07097000
KMACBSRP DSCAN KEY=')',SUCC=KMACDLIB                                    07098000
HMASMUC1 CSECT                                                          07099000
**********************************************************************  07100000
*                                                                    *  07101000
*                           DLIB TYPE SCAN TABLE                     *  07102000
*                                                                    *  07103000
**********************************************************************  07104000
KDLBLP01 DSCAN KEY='(',SUCC=KDLBNAM                                     07105000
KDLBNAM  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KDLBRP01,ROUT=RXXXNAM     07106000
KDLBRP01 DSCAN KEY=')',SUCC=KDLBTD                                      07107000
KDLBTD   DSCAN KEY='.',ALT=KDLBSYLB,SUCC=KXTRADTA,ROUT=RXXXTD           07108000
KDLBSYLB DSCAN KEY='SYSLIB',ALT=KENDPER,SUCC=KDLBSYLP,ROUT=RDLBSYLB     07109000
KDLBSYLP DSCAN KEY='(',SUCC=KDLBSYD,ROUT=RESETRPL                       07110000
KDLBSYD  DSCAN KEY=')',SUCC=KDLBSYLB,ALT=KDLBSYV,ROUT=RDLBSYD           07111000
KDLBSYV  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KDLBSYRP,ROUT=RDLBSYV     07112000
KDLBSYRP DSCAN KEY=')',ALT=KDLBSYV,SUCC=KDLBSYLB,COMMA=NO               07113000
HMASMUC1 CSECT                                                          07114000
**********************************************************************  07115000
*                                                                    *  07116000
*                      SRC TYPE DSCAN TABLE                          *  07117000
*                                                                    *  07118000
**********************************************************************  07119000
KSRCLP01 DSCAN KEY='(',SUCC=KSRCNAM                                     07120000
KSRCNAM  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KSRCRP01,ROUT=RXXXNAM     07121000
KSRCRP01 DSCAN KEY=')',SUCC=KMACTD                                      07122000
HMASMUC1 CSECT                                                          07123000
**********************************************************************  07124000
*                                                                    *  07125000
*                      ASSEM TYPE SCAN TABLE                         *  07126000
*                                                                    *  07127000
**********************************************************************  07128000
KASMLP01 DSCAN KEY='(',SUCC=KASMNAM                          @Z40SP00   07129000
KASMNAM  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KASMRP,ROUT=RXXXNAM       07130000
KASMRP   DSCAN KEY=')',SUCC=KASMD                                       07131000
KASMD    DSCAN KEY='.',SUCC=KXTRADTA,ROUT=RXXXTD                        07132000
HMASMUC1 CSECT                                                          07133000
**********************************************************************  07134000
*                                                                    *  07135000
*                      SYSTEM TYPE SCAN TABLE                        *  07136000
*                                                                    *  07137000
**********************************************************************  07138000
KSYSTD   DSCAN KEY='.',ALT=KSYSSREL,SUCC=KXTRADTA,ROUT=RXXXTD           07139000
KSYSSREL DSCAN KEY='SREL',ALT=KSYSNCID,SUCC=KSYSSRLP                    07140000
KSYSSRLP DSCAN KEY='(',SUCC=KSYSSRLD                                    07141000
KSYSSRLD DSCAN KEY=')',ALT=KSYSSRLV,SUCC=KSYSSREL,ROUT=RSYSSRLD         07142000
KSYSSRLV DSCAN MINLEN=4,MAXLEN=4,TYPE=AN,SUCC=KSYSSRRP,ROUT=RSYSSRLV    07143000
KSYSSRRP DSCAN KEY=')',SUCC=KSYSSREL                                    07144000
KSYSNCID DSCAN KEY='NUCID',ALT=KSYSPEMX,SUCC=KSYSNCLP                   07145000
KSYSNCLP DSCAN KEY='(',SUCC=KSYSNCD                                     07146000
KSYSNCD  DSCAN KEY=')',ALT=KSYSNCV,SUCC=KSYSSREL,ROUT=RSYSNCD           07147000
KSYSNCV  DSCAN MINLEN=1,MAXLEN=1,TYPE=N,SUCC=KSYSNCRP,ROUT=RSYSNCV      07148000
KSYSNCRP DSCAN KEY=')',SUCC=KSYSSREL                                    07149000
KSYSPEMX DSCAN KEY='PEMAX',ALT=KSYSSMTS,SUCC=KSYSPMLP                   07150000
KSYSPMLP DSCAN KEY='(',SUCC=KSYSPMD                                     07151000
KSYSPMD  DSCAN KEY=')',ALT=KSYSPMV,SUCC=KSYSSREL,ROUT=RSYSPMD           07152000
KSYSPMV  DSCAN MINLEN=1,MAXLEN=4,TYPE=N,SUCC=KSYSPMRP,ROUT=RSYSPMV      07153000
KSYSPMRP DSCAN KEY=')',SUCC=KSYSSREL                                    07154000
KSYSSMTS DSCAN KEY='SAVEMTS',ALT=KSYSSSTS,SUCC=KSYSSREL,ROUT=RSYSSMTS   07155000
KSYSSSTS DSCAN KEY='SAVESTS',ALT=KSYSCDID,SUCC=KSYSSREL,ROUT=RSYSSSTS   07156000
KSYSCDID DSCAN KEY='CDSID',ALT=KENDPER,SUCC=KSYSCDLP                    07157000
KSYSCDLP DSCAN KEY='(',SUCC=KSYSCDD                                     07158000
KSYSCDD  DSCAN KEY=')',ALT=KSYSCDV,SUCC=KSYSSREL,ROUT=RSYSCDD           07159000
KSYSCDV  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KSYSCDRP,ROUT=RSYSCDV     07160000
KSYSCDRP DSCAN KEY=')',SUCC=KSYSSREL                                    07161000
HMASMUC1 CSECT                                                          07162000
**********************************************************************  07163000
*                                                                    *  07164000
*                      FLUSH MODE SCAN TABLE                         *  07165000
*                                                                    *  07166000
**********************************************************************  07167000
KFLUSH   DSCAN KEY='ENDUCL',ALT=KFLUSHPR,SUCC=KENDPER,ROUT=RENDUCL      07168000
KFLUSHPR DSCAN KEY='.',ALT=KFLUSHCH,SUCC=KXTRADTA           @Z40SP00    07169000
KFLUSHCH DSCAN MINLEN=0,MAXLEN=255,TYPE=AN,SUCC=KFLUSH,ROUT=RFLUSHCH,  X07170000
               CALLRT=YES                                               07171000
HMASMUC1 CSECT                                                          07172000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07173000
@01      EQU   01                                                       07174000
@02      EQU   02                                                       07175000
@03      EQU   03                                                       07176000
@04      EQU   04                                                       07177000
@05      EQU   05                                                       07178000
@06      EQU   06                                                       07179000
@07      EQU   07                                                       07180000
@08      EQU   08                                                       07181000
@09      EQU   09                                                       07182000
@10      EQU   10                                                       07183000
@11      EQU   11                                                       07184000
@12      EQU   12                                                       07185000
@13      EQU   13                                                       07186000
@14      EQU   14                                                       07187000
@15      EQU   15                                                       07188000
CCAPTR   EQU   @11                                                      07189000
IOPPTR   EQU   @09                                                      07190000
RTNCODE  EQU   @15                                                      07191000
RTNREG   EQU   @14                                                      07192000
HMASMCCA EQU   0                                                        07193000
CCAFBUFR EQU   HMASMCCA+4                                               07194000
CCADSAD  EQU   CCAFBUFR+124                                             07195000
CCATPAD  EQU   CCAFBUFR+128                                             07196000
CCAFLAG7 EQU   CCAFBUFR+132                                             07197000
CCAFIOP  EQU   HMASMCCA+140                                             07198000
CCAIOPTR EQU   CCAFIOP                                                  07199000
CCAPESIZ EQU   CCAFIOP+4                                                07200000
CCAFSYS  EQU   HMASMCCA+148                                             07201000
CCAIOPCS EQU   CCAFSYS                                                  07202000
CCASREL  EQU   CCAFSYS+12                                               07203000
CCAFLAGA EQU   CCAFSYS+21                                               07204000
CCAFSTA  EQU   HMASMCCA+188                                             07205000
CCAFICT  EQU   HMASMCCA+192                                             07206000
CCAFPGM  EQU   HMASMCCA+208                                             07207000
CCABLDLP EQU   CCAFPGM                                                  07208000
CCADBLDL EQU   CCAFPGM+4                                                07209000
CCAFGTP  EQU   HMASMCCA+224                                             07210000
CCASEGTP EQU   CCAFGTP                                                  07211000
@NM00019 EQU   HMASMCCA+244                                             07212000
CCAFFUNC EQU   HMASMCCA+264                                             07213000
CCAFLAG1 EQU   CCAFFUNC+8                                               07214000
CCAFLAG2 EQU   CCAFFUNC+11                                              07215000
CCAFPROC EQU   HMASMCCA+276                                             07216000
CCAFLAG3 EQU   CCAFPROC                                                 07217000
CCAFDIS  EQU   HMASMCCA+278                                             07218000
CCAFLAG4 EQU   CCAFDIS                                                  07219000
CCAFLAG5 EQU   CCAFDIS+1                                                07220000
CCAFLAG6 EQU   CCAFDIS+2                                                07221000
CCAFCNV  EQU   HMASMCCA+281                                             07222000
CCAFLAG8 EQU   CCAFCNV                                                  07223000
CCAFCTL  EQU   HMASMCCA+282                                             07224000
CCAFLAG9 EQU   CCAFCTL                                                  07225000
CCADATE  EQU   CCAFCTL+1                                                07226000
CCATIME  EQU   CCAFCTL+4                                                07227000
CCAFMID  EQU   HMASMCCA+291                                             07228000
CCAFDSNG EQU   HMASMCCA+298                                             07229000
CCAFLAGB EQU   CCAFDSNG                                                 07230000
CCADSIDA EQU   0                                                        07231000
CCATYPEA EQU   0                                                        07232000
CCABLDLA EQU   0                                                        07233000
@NM00035 EQU   CCABLDLA                                                 07234000
CCABLDLL EQU   0                                                        07235000
@NM00037 EQU   CCABLDLL                                                 07236000
CCALKDRC EQU   @NM00037+20                                              07237000
@NM00039 EQU   CCABLDLL+124                                             07238000
CCAASMRC EQU   @NM00039+20                                              07239000
@NM00041 EQU   CCABLDLL+248                                             07240000
CCACPYRC EQU   @NM00041+20                                              07241000
@NM00043 EQU   CCABLDLL+372                                             07242000
CCACOMRC EQU   @NM00043+20                                              07243000
@NM00045 EQU   CCABLDLL+496                                             07244000
CCAZAPRC EQU   @NM00045+20                                              07245000
@NM00047 EQU   CCABLDLL+620                                             07246000
CCASUPRC EQU   @NM00047+20                                              07247000
@NM00049 EQU   CCABLDLL+744                                             07248000
CCAUPDRC EQU   @NM00049+20                                              07249000
CCABLDLM EQU   0                                                        07250000
CCABELMT EQU   CCABLDLM+4                                               07251000
CCABMPOS EQU   CCABELMT                                                 07252000
HMASMIOP EQU   0                                                        07253000
IOPDSID  EQU   HMASMIOP                                                 07254000
IOPFUNCT EQU   HMASMIOP+1                                               07255000
IOPRETRN EQU   HMASMIOP+2                                               07256000
IOPTYPE  EQU   HMASMIOP+3                                               07257000
IOPNAME  EQU   HMASMIOP+4                                               07258000
IOPNAM17 EQU   IOPNAME                                                  07259000
@NM00053 EQU   HMASMIOP+12                                              07260000
@NM00054 EQU   @NM00053                                                 07261000
IOPDDNAM EQU   HMASMIOP+24                                              07262000
IOPBUFAD EQU   HMASMIOP+52                                              07263000
IOPDRMAP EQU   HMASMIOP+56                                              07264000
IOPINAME EQU   IOPDRMAP                                                 07265000
IOPINAM  EQU   IOPINAME                                                 07266000
IOPITYP  EQU   IOPINAM                                                  07267000
IOPUSERL EQU   IOPDRMAP+11                                              07268000
IOPEND   EQU   IOPDRMAP+12                                              07269000
IOPLMCTL EQU   0                                                        07270000
IOPQSMIF EQU   0                                                        07271000
@NM00164 EQU   IOPQSMIF                                                 07272000
IOPQSMLS EQU   IOPQSMIF+8                                               07273000
IOPQSMNM EQU   IOPQSMLS                                                 07274000
IOPBS02  EQU   0                                                        07275000
IOPBS04  EQU   0                                                        07276000
IOPBAPF  EQU   IOPBS04                                                  07277000
HMASMPRL EQU   0                                                        07278000
PRLSPAN  EQU   HMASMPRL+2                                               07279000
PRLFLGS  EQU   PRLSPAN                                                  07280000
PRLBLANK EQU   PRLFLGS                                                  07281000
PRLDATE  EQU   HMASMPRL+4                                               07282000
PRLTIME  EQU   HMASMPRL+7                                               07283000
PRLEND   EQU   HMASMPRL+10                                              07284000
HMASMSCP EQU   0                                                        07285000
SCPCHAR  EQU   HMASMSCP                                                 07286000
SCPSRCH  EQU   HMASMSCP+4                                               07287000
SCPIOPAD EQU   HMASMSCP+16                                              07288000
SCPPMLN  EQU   HMASMSCP+22                                              07289000
SCPEOR   EQU   HMASMSCP+24                                              07290000
SCPNORT  EQU   SCPEOR                                                   07291000
SCPRETRN EQU   HMASMSCP+25                                              07292000
SCPRET   EQU   SCPRETRN                                                 07293000
SCPSTRNG EQU   0                                                        07294000
PECHAR   EQU   0                                                        07295000
PECHAR4  EQU   PECHAR                                                   07296000
PECHAR3  EQU   PECHAR4                                                  07297000
DATEPARM EQU   0                                                        07298000
MIOPD    EQU   DATEPARM                                                 07299000
MIOPT    EQU   DATEPARM+3                                               07300000
IOPBS01  EQU   0                                                        07301000
IOPBS03  EQU   0                                                        07302000
SCPIOPRM EQU   0                                                        07303000
UCLPARM  EQU   0                                                        07304000
UCLFLAGS EQU   UCLPARM+8                                                07305000
UCLFLG1  EQU   UCLFLAGS                                                 07306000
UCLFLUSH EQU   UCLFLG1                                                  07307000
UCLFLG2  EQU   UCLFLAGS+2                                               07308000
UCLFLG3  EQU   UCLFLAGS+3                                               07309000
UCLCDS   EQU   UCLFLG3                                                  07310000
UCLACDS  EQU   UCLFLG3                                                  07311000
UCLFLG4  EQU   UCLFLAGS+5                                               07312000
UCLFLG5  EQU   UCLFLAGS+7                                               07313000
HMASMCRP EQU   0                                                        07314000
CRPSCPAD EQU   HMASMCRP+4                                               07315000
CRPRETRN EQU   HMASMCRP+10                                              07316000
CRPFLG1  EQU   HMASMCRP+14                                              07317000
CRPEOFEN EQU   CRPFLG1+1                                                07318000
CRPFLG2  EQU   HMASMCRP+16                                              07319000
CRPINSW0 EQU   CRPFLG2                                                  07320000
CRPINSW1 EQU   CRPFLG2                                                  07321000
CRPINSW2 EQU   CRPFLG2                                                  07322000
CRPINSW3 EQU   CRPFLG2                                                  07323000
CRPBUFFR EQU   HMASMCRP+18                                              07324000
CRPBFCTL EQU   CRPBUFFR                                                 07325000
TXT257   EQU   0                                                        07326000
TXT3411  EQU   0                                                        07327000
TXT3412  EQU   0                                                        07328000
TXT4021  EQU   0                                                        07329000
TXT4022  EQU   0                                                        07330000
IOPUDATA EQU   IOPEND                                                   07331000
IOPINAM3 EQU   IOPINAME                                                 07332000
@NM00060 EQU   IOPINAM3                                                 07333000
IOPSTCMP EQU   IOPUDATA                                                 07334000
IOPDYNDT EQU   IOPUDATA                                                 07335000
IOPSPACE EQU   IOPDYNDT+44                                              07336000
IOPDTYPE EQU   IOPDYNDT+50                                              07337000
IOPNTMAX EQU   IOPDRMAP                                                 07338000
IOPNTMAP EQU   IOPDRMAP                                                 07339000
IOPCDMAP EQU   IOPNTMAP                                                 07340000
IOPPTMAP EQU   IOPCDMAP                                                 07341000
IOPSCMAP EQU   IOPPTMAP                                                 07342000
IOPDIRCT EQU   IOPSCMAP+12                                              07343000
IOPCDMAX EQU   IOPDIRCT                                                 07344000
IOPCQMAP EQU   IOPDRMAP                                                 07345000
@NM00071 EQU   IOPUDATA                                                 07346000
@NM00072 EQU   IOPUDATA                                                 07347000
IOPASMNT EQU   IOPUDATA                                                 07348000
IOPASMDR EQU   IOPASMNT                                                 07349000
IOPNTLVL EQU   IOPASMDR                                                 07350000
IOPABUNT EQU   IOPASMDR+1                                               07351000
IOPLMDNT EQU   IOPUDATA                                                 07352000
IOPLMDDR EQU   IOPLMDNT                                                 07353000
IOPLMLEP EQU   IOPLMDDR+1                                               07354000
IOPLMDF1 EQU   IOPLMLEP                                                 07355000
IOPFLGS2 EQU   IOPLMDF1                                                 07356000
IOPAPF   EQU   IOPFLGS2                                                 07357000
IOPRENT  EQU   IOPFLGS2                                                 07358000
IOPREUS  EQU   IOPFLGS2                                                 07359000
IOPSCTR  EQU   IOPFLGS2                                                 07360000
IOPOVLY  EQU   IOPFLGS2                                                 07361000
IOPREFR  EQU   IOPFLGS2                                                 07362000
IOPDC    EQU   IOPFLGS2                                                 07363000
IOPLMDF2 EQU   IOPLMLEP+1                                               07364000
IOPNE    EQU   IOPLMDF2                                                 07365000
IOPPAGA  EQU   IOPLMDF2                                                 07366000
IOPLMDF3 EQU   IOPLMLEP+2                                               07367000
IOPLMDF4 EQU   IOPLMLEP+3                                               07368000
IOPLMDF5 EQU   IOPLMDDR+5                                               07369000
IOPFLGS3 EQU   IOPLMDF5                                                 07370000
IOPCOPY  EQU   IOPFLGS3                                                 07371000
IOPLINK  EQU   IOPFLGS3                                                 07372000
IOPLMDFX EQU   IOPLMDNT+24                                              07373000
@NM00081 EQU   IOPLMDFX                                                 07374000
IOPLNTRY EQU   IOPLMDFX+8                                               07375000
IOPLSYS  EQU   IOPLNTRY                                                 07376000
IOPSYSLB EQU   IOPLSYS                                                  07377000
IOPLMDND EQU   IOPSYSLB                                                 07378000
IOPLMIND EQU   IOPLNTRY+8                                               07379000
IOPMACNT EQU   IOPUDATA                                                 07380000
IOPMACDR EQU   IOPMACNT                                                 07381000
IOPRMIDE EQU   IOPMACDR+1                                               07382000
IOPRMID  EQU   IOPRMIDE                                                 07383000
IOPRMST  EQU   IOPRMIDE+7                                               07384000
IOPFMIDE EQU   IOPMACDR+9                                               07385000
IOPFMID  EQU   IOPFMIDE                                                 07386000
IOPFMST  EQU   IOPFMIDE+7                                               07387000
IOPMCLNG EQU   IOPMACDR+17                                              07388000
IOPMACFX EQU   IOPMACNT+24                                              07389000
IOPBUNT  EQU   IOPMACFX                                                 07390000
IOPBUSMD EQU   IOPBUNT                                                  07391000
IOPBUTYP EQU   IOPBUNT+7                                                07392000
IOPMCSYS EQU   IOPMACFX+64                                              07393000
IOPMCDLB EQU   IOPMACFX+72                                              07394000
IOPMCEND EQU   IOPMACNT+104                                             07395000
IOPMACVR EQU   IOPMCEND                                                 07396000
IOPMCENT EQU   IOPMACVR                                                 07397000
IOPMCDTA EQU   IOPMCENT                                                 07398000
IOPMCASM EQU   IOPMCDTA                                                 07399000
IOPMACID EQU   IOPMCASM                                                 07400000
IOPMACND EQU   IOPMACID                                                 07401000
IOPMACST EQU   IOPMCASM+7                                               07402000
IOPMCIND EQU   IOPMCENT+8                                               07403000
IOPEOFNT EQU   IOPUDATA                                                 07404000
IOPSRCNT EQU   IOPUDATA                                                 07405000
IOPSRCDR EQU   IOPSRCNT                                                 07406000
@NM00092 EQU   IOPSRCDR+1                                               07407000
@NM00094 EQU   @NM00092+7                                               07408000
@NM00098 EQU   IOPSRCDR+9                                               07409000
IOPSRCFX EQU   IOPSRCNT+24                                              07410000
@NM00102 EQU   IOPSRCFX                                                 07411000
IOPSRSYS EQU   IOPSRCFX+64                                              07412000
IOPSRDLB EQU   IOPSRCFX+72                                              07413000
IOPSREND EQU   IOPSRCNT+104                                             07414000
IOPSRCVR EQU   IOPSREND                                                 07415000
IOPSNTRY EQU   IOPSRCVR                                                 07416000
IOPSRDTA EQU   IOPSNTRY                                                 07417000
IOPSRCID EQU   IOPSRDTA                                                 07418000
IOPSRCND EQU   IOPSRCID                                                 07419000
IOPSRCST EQU   IOPSRDTA+7                                               07420000
IOPMODNT EQU   IOPUDATA                                                 07421000
IOPMODDR EQU   IOPMODNT                                                 07422000
@NM00108 EQU   IOPMODDR+1                                               07423000
@NM00110 EQU   @NM00108+7                                               07424000
@NM00114 EQU   IOPMODDR+9                                               07425000
IOPMODFX EQU   IOPMODNT+24                                              07426000
@NM00118 EQU   IOPMODFX                                                 07427000
IOPMDLEP EQU   IOPMODFX+8                                               07428000
IOPMODF1 EQU   IOPMDLEP                                                 07429000
IOPMODF2 EQU   IOPMDLEP+1                                               07430000
IOPMODF3 EQU   IOPMDLEP+2                                               07431000
IOPMODF4 EQU   IOPMDLEP+3                                               07432000
IOPDLIB  EQU   IOPMODFX+72                                              07433000
IOPMDEND EQU   IOPMODNT+104                                             07434000
IOPMODVR EQU   IOPMDEND                                                 07435000
IOPMNTRY EQU   IOPMODVR                                                 07436000
IOPMDDTA EQU   IOPMNTRY                                                 07437000
IOPLMODS EQU   IOPMDDTA                                                 07438000
IOPMODID EQU   IOPLMODS                                                 07439000
IOPMODND EQU   IOPMODID                                                 07440000
IOPMODST EQU   IOPLMODS+7                                               07441000
IOPDLBNT EQU   IOPUDATA                                                 07442000
IOPDLBDR EQU   IOPDLBNT                                                 07443000
IOPDLBFX EQU   IOPDLBNT+24                                              07444000
@NM00129 EQU   IOPDLBFX                                                 07445000
IOPDLEND EQU   IOPDLBNT+104                                             07446000
IOPDLBVR EQU   IOPDLEND                                                 07447000
IOPDNTRY EQU   IOPDLBVR                                                 07448000
IOPDSYS  EQU   IOPDNTRY                                                 07449000
IOPDLBND EQU   IOPDSYS                                                  07450000
IOPDLIND EQU   IOPDNTRY+8                                               07451000
IOPSYSNT EQU   IOPUDATA                                                 07452000
IOPSYSDR EQU   IOPSYSNT                                                 07453000
IOPSCNVL EQU   IOPSYSDR+1                                               07454000
IOPPEMAX EQU   IOPSYSDR+2                                               07455000
IOPSYSF1 EQU   IOPSYSDR+4                                               07456000
IOPFLGS7 EQU   IOPSYSF1                                                 07457000
IOPMTSNP EQU   IOPFLGS7                                                 07458000
IOPSTSNP EQU   IOPFLGS7                                                 07459000
IOPSYSFX EQU   IOPSYSNT+24                                              07460000
@NM00136 EQU   IOPSYSFX                                                 07461000
IOPSREL  EQU   IOPSYSFX+8                                               07462000
IOPNUCID EQU   IOPSYSFX+12                                              07463000
IOPSYSID EQU   IOPSYSFX+13                                              07464000
IOPSYEND EQU   IOPSYSNT+184                                             07465000
IOPSYSVR EQU   IOPSYEND                                                 07466000
IOPSYSTR EQU   IOPSYSVR                                                 07467000
IOPSYNTR EQU   IOPSYSTR                                                 07468000
IOPSYSND EQU   IOPSYNTR                                                 07469000
IOPPTFNT EQU   IOPUDATA                                                 07470000
IOPPTFDR EQU   IOPPTFNT                                                 07471000
IOPPTYPE EQU   IOPPTFDR+1                                               07472000
IOPPSTAT EQU   IOPPTFDR+2                                               07473000
IOPPTFF1 EQU   IOPPSTAT                                                 07474000
IOPFLGS5 EQU   IOPPTFF1                                                 07475000
IOPAPP   EQU   IOPFLGS5                                                 07476000
IOPRES   EQU   IOPFLGS5                                                 07477000
IOPACC   EQU   IOPFLGS5                                                 07478000
IOPERROR EQU   IOPFLGS5                                                 07479000
IOPDUMMP EQU   IOPFLGS5                                                 07480000
IOPBYP   EQU   IOPFLGS5                                                 07481000
IOPREGEN EQU   IOPFLGS5                                                 07482000
IOPPTFF2 EQU   IOPPSTAT+1                                               07483000
IOPDELP  EQU   IOPPTFF2                                                 07484000
IOPIRQP  EQU   IOPPTFF2                                                 07485000
IOPNPRP  EQU   IOPPTFF2                                                 07486000
IOPPREP  EQU   IOPPTFF2                                                 07487000
IOPREQP  EQU   IOPPTFF2                                                 07488000
IOPSUPP  EQU   IOPPTFF2                                                 07489000
IOPPTFF3 EQU   IOPPSTAT+3                                               07490000
IOPSBYP  EQU   IOPPTFF3                                                 07491000
IOPDBYP  EQU   IOPPTFF3                                                 07492000
IOPDBYNO EQU   IOPPTFDR+6                                               07493000
IOPSBYNO EQU   IOPPTFDR+13                                              07494000
IOPPTFFX EQU   IOPPTFNT+24                                              07495000
@NM00145 EQU   IOPPTFFX                                                 07496000
@NM00146 EQU   @NM00145                                                 07497000
IOPPDTES EQU   IOPPTFFX+41                                              07498000
@NM00149 EQU   IOPPDTES                                                 07499000
IOPRECD  EQU   @NM00149                                                 07500000
IOPPTPFX EQU   IOPPDTES+6                                               07501000
IOPDATES EQU   IOPPTPFX                                                 07502000
IOPAPPD  EQU   IOPDATES                                                 07503000
IOPRSTD  EQU   IOPDATES+6                                               07504000
IOPACCD  EQU   IOPDATES+12                                              07505000
IOPUCLD  EQU   IOPDATES+18                                              07506000
IOPUCLT  EQU   IOPDATES+21                                              07507000
IOPPFMID EQU   IOPPTFFX+73                                              07508000
IOPPTEND EQU   IOPPTFNT+104                                             07509000
IOPPTFVR EQU   IOPPTEND                                                 07510000
IOPPNTRY EQU   IOPPTFVR                                                 07511000
IOPPMODS EQU   IOPPNTRY                                                 07512000
IOPPTFND EQU   IOPPMODS                                                 07513000
IOPPIND  EQU   IOPPNTRY+8                                               07514000
IOPENTNT EQU   IOPUDATA+104                                             07515000
IOPENTNM EQU   IOPENTNT                                                 07516000
IOPSRLNT EQU   IOPUDATA+104                                             07517000
IOPPRENT EQU   IOPUDATA+104                                             07518000
IOPNPRNT EQU   IOPUDATA+104                                             07519000
IOPSUPNT EQU   IOPUDATA+104                                             07520000
IOPREQNT EQU   IOPUDATA+104                                             07521000
IOPIRQNT EQU   IOPUDATA+104                                             07522000
IOPFIDNT EQU   IOPUDATA+104                                             07523000
IOPDELNT EQU   IOPUDATA+104                                             07524000
IOPVERNT EQU   IOPUDATA+104                                             07525000
IOPSBYNT EQU   IOPUDATA+104                                             07526000
IOPQSMNT EQU   IOPUDATA                                                 07527000
IOPQSMDR EQU   IOPQSMNT                                                 07528000
IOPQFMNT EQU   IOPUDATA                                                 07529000
IOPQFMDR EQU   IOPQFMNT                                                 07530000
IOPQFEND EQU   IOPQFMNT+2                                               07531000
IOPQFMVR EQU   IOPQFEND                                                 07532000
IOPQFMLS EQU   IOPQFMVR                                                 07533000
IOPQFMNM EQU   IOPQFMLS                                                 07534000
IOPPTSYS EQU   IOPUDATA                                                 07535000
IOPPTSDR EQU   IOPPTSYS                                                 07536000
IOPPTSFX EQU   IOPPTSYS+24                                              07537000
IOPDSSPC EQU   IOPPTSFX                                                 07538000
IOPPTFG1 EQU   IOPPTSFX+34                                              07539000
IOPPSEND EQU   IOPPTSYS+1064                                            07540000
IOPPTSVR EQU   IOPPSEND                                                 07541000
IOPPTNTR EQU   IOPPTSVR                                                 07542000
@NM00174 EQU   IOPPTNTR                                                 07543000
IOPPTFMD EQU   @NM00174                                                 07544000
IOPPTREL EQU   IOPPTFMD                                                 07545000
IOPBPDS  EQU   IOPUDATA                                                 07546000
IOPBLEP1 EQU   IOPBPDS+8                                                07547000
IOPBLEP2 EQU   IOPBPDS+9                                                07548000
@NM00178 EQU   IOPBPDS+18                                               07549000
IOPBFTB0 EQU   @NM00178                                                 07550000
IOPBFTB1 EQU   IOPBFTB0                                                 07551000
PRLDATA  EQU   PRLEND                                                   07552000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07553000
IOPBCEND EQU   IOPBPDS+21                                               07554000
IOPBFTB3 EQU   IOPBFTB0+2                                               07555000
IOPBFTB2 EQU   IOPBFTB0+1                                               07556000
@NM00180 EQU   IOPBFTB1                                                 07557000
IOPBAPFP EQU   IOPBFTB1                                                 07558000
IOPBSSI  EQU   IOPBFTB1                                                 07559000
IOPBPAGA EQU   IOPBFTB1                                                 07560000
@NM00179 EQU   IOPBFTB1                                                 07561000
IOPBAOSL EQU   IOPBFTB1                                                 07562000
IOPBSEPA EQU   IOPBPDS+15                                               07563000
IOPBFTBL EQU   IOPBPDS+13                                               07564000
IOPBSTOR EQU   IOPBPDS+10                                               07565000
IOPBREFR EQU   IOPBLEP2                                                 07566000
IOPBLEF  EQU   IOPBLEP2                                                 07567000
IOPBTEST EQU   IOPBLEP2                                                 07568000
IOPBNE   EQU   IOPBLEP2                                                 07569000
@NM00177 EQU   IOPBLEP2                                                 07570000
IOPBDC   EQU   IOPBLEP2                                                 07571000
@NM00176 EQU   IOPBLEP1                                                 07572000
IOPBSCTR EQU   IOPBLEP1                                                 07573000
IOPBOL   EQU   IOPBLEP1                                                 07574000
@NM00175 EQU   IOPBLEP1                                                 07575000
IOPBOVLY EQU   IOPBLEP1                                                 07576000
IOPBREUS EQU   IOPBLEP1                                                 07577000
IOPBRENT EQU   IOPBLEP1                                                 07578000
IOPBNL   EQU   IOPBPDS+7                                                07579000
IOPBTTRN EQU   IOPBPDS+4                                                07580000
IOPBZERO EQU   IOPBPDS+3                                                07581000
IOPBTTRT EQU   IOPBPDS                                                  07582000
IOPPTIND EQU   IOPPTNTR+8                                               07583000
IOPPTSND EQU   IOPPTREL                                                 07584000
@NM00173 EQU   IOPPTSFX+872                                             07585000
IOPSYZPP EQU   IOPPTSFX+772                                             07586000
IOPSYZPR EQU   IOPPTSFX+771                                             07587000
IOPSYZPS EQU   IOPPTSFX+763                                             07588000
IOPSYZAP EQU   IOPPTSFX+755                                             07589000
IOPSYUPP EQU   IOPPTSFX+655                                             07590000
IOPSYUPR EQU   IOPPTSFX+654                                             07591000
IOPSYUPS EQU   IOPPTSFX+646                                             07592000
IOPSYUPD EQU   IOPPTSFX+638                                             07593000
IOPSYSPP EQU   IOPPTSFX+538                                             07594000
IOPSYSPR EQU   IOPPTSFX+537                                             07595000
IOPSYSPS EQU   IOPPTSFX+529                                             07596000
IOPSYSUP EQU   IOPPTSFX+521                                             07597000
IOPSYLKP EQU   IOPPTSFX+421                                             07598000
IOPSYLKR EQU   IOPPTSFX+420                                             07599000
IOPSYLKS EQU   IOPPTSFX+412                                             07600000
IOPSYLKD EQU   IOPPTSFX+404                                             07601000
IOPSYCPP EQU   IOPPTSFX+304                                             07602000
IOPSYCPR EQU   IOPPTSFX+303                                             07603000
IOPSYCPS EQU   IOPPTSFX+295                                             07604000
IOPSYCPY EQU   IOPPTSFX+287                                             07605000
IOPSYCOP EQU   IOPPTSFX+187                                             07606000
IOPSYCOR EQU   IOPPTSFX+186                                             07607000
IOPSYCOS EQU   IOPPTSFX+178                                             07608000
IOPSYCOM EQU   IOPPTSFX+170                                             07609000
IOPSYASP EQU   IOPPTSFX+70                                              07610000
IOPSYASR EQU   IOPPTSFX+69                                              07611000
IOPSYASS EQU   IOPPTSFX+61                                              07612000
IOPSYASM EQU   IOPPTSFX+53                                              07613000
@NM00172 EQU   IOPPTSFX+35                                              07614000
@NM00171 EQU   IOPPTFG1                                                 07615000
IOPPTSNJ EQU   IOPPTFG1                                                 07616000
IOPPTSNP EQU   IOPPTFG1                                                 07617000
IOPSYPLN EQU   IOPPTSFX+32                                              07618000
IOPDSPFX EQU   IOPPTSFX+6                                               07619000
IOPDSDIR EQU   IOPDSSPC+4                                               07620000
IOPDSSEC EQU   IOPDSSPC+2                                               07621000
IOPDSPRM EQU   IOPDSSPC                                                 07622000
@NM00170 EQU   IOPPTSDR+4                                               07623000
IOPPTPEM EQU   IOPPTSDR+2                                               07624000
IOPPCNVL EQU   IOPPTSDR+1                                               07625000
@NM00169 EQU   IOPPTSDR                                                 07626000
IOPQFMTP EQU   IOPQFMLS+8                                               07627000
@NM00168 EQU   IOPQFMLS+7                                               07628000
IOPQFMND EQU   IOPQFMNM                                                 07629000
@NM00167 EQU   IOPQFMDR                                                 07630000
@NM00163 EQU   IOPQSMDR                                                 07631000
@NM00162 EQU   IOPSBYNT+8                                               07632000
IOPSBYST EQU   IOPSBYNT+7                                               07633000
IOPSBYNM EQU   IOPSBYNT                                                 07634000
@NM00161 EQU   IOPVERNT+8                                               07635000
IOPVERST EQU   IOPVERNT+7                                               07636000
IOPVERNM EQU   IOPVERNT                                                 07637000
@NM00160 EQU   IOPDELNT+8                                               07638000
IOPDELST EQU   IOPDELNT+7                                               07639000
IOPDELNM EQU   IOPDELNT                                                 07640000
@NM00159 EQU   IOPFIDNT+8                                               07641000
IOPFIDST EQU   IOPFIDNT+7                                               07642000
IOPFIDNM EQU   IOPFIDNT                                                 07643000
@NM00158 EQU   IOPIRQNT+8                                               07644000
IOPIRQST EQU   IOPIRQNT+7                                               07645000
IOPIRQNM EQU   IOPIRQNT                                                 07646000
@NM00157 EQU   IOPREQNT+8                                               07647000
IOPREQST EQU   IOPREQNT+7                                               07648000
IOPREQNM EQU   IOPREQNT                                                 07649000
@NM00156 EQU   IOPSUPNT+8                                               07650000
IOPSUPST EQU   IOPSUPNT+7                                               07651000
IOPSUPNM EQU   IOPSUPNT                                                 07652000
@NM00155 EQU   IOPNPRNT+8                                               07653000
IOPNPRST EQU   IOPNPRNT+7                                               07654000
IOPNPRNM EQU   IOPNPRNT                                                 07655000
@NM00154 EQU   IOPPRENT+8                                               07656000
IOPPREST EQU   IOPPRENT+7                                               07657000
IOPPRENM EQU   IOPPRENT                                                 07658000
@NM00153 EQU   IOPSRLNT+8                                               07659000
IOPSRLST EQU   IOPSRLNT+7                                               07660000
@NM00152 EQU   IOPSRLNT+4                                               07661000
IOPSRLNM EQU   IOPSRLNT                                                 07662000
@NM00151 EQU   IOPENTNT+8                                               07663000
IOPENTST EQU   IOPENTNT+7                                               07664000
@NM00150 EQU   IOPPTPFX+24                                              07665000
IOPACCT  EQU   IOPDATES+15                                              07666000
IOPRSTT  EQU   IOPDATES+9                                               07667000
IOPAPPT  EQU   IOPDATES+3                                               07668000
IOPRECT  EQU   @NM00149+3                                               07669000
@NM00148 EQU   IOPPTFFX+8                                               07670000
@NM00147 EQU   @NM00145+7                                               07671000
IOPPRELN EQU   @NM00146                                                 07672000
@NM00144 EQU   IOPPTFDR+20                                              07673000
@NM00143 EQU   IOPPTFF3                                                 07674000
IOPFLF   EQU   IOPPTFF3                                                 07675000
IOPPMDLP EQU   IOPPTFF2+1                                               07676000
IOPPADDP EQU   IOPPTFF2+1                                               07677000
@NM00142 EQU   IOPPTFF2+1                                               07678000
IOPLRFP  EQU   IOPPTFF2                                                 07679000
IOPJCLP  EQU   IOPPTFF2                                                 07680000
@NM00141 EQU   IOPFLGS5                                                 07681000
@NM00140 EQU   IOPPTFDR                                                 07682000
IOPSYSTP EQU   IOPSYSTR+8                                               07683000
@NM00139 EQU   IOPSYSFX+21                                              07684000
@NM00138 EQU   @NM00136+7                                               07685000
@NM00137 EQU   @NM00136                                                 07686000
@NM00135 EQU   IOPSYSDR+5                                               07687000
@NM00134 EQU   IOPFLGS7                                                 07688000
IOPSYNG  EQU   IOPFLGS7                                                 07689000
IOPSYDL  EQU   IOPFLGS7                                                 07690000
@NM00133 EQU   IOPSYSDR                                                 07691000
@NM00132 EQU   IOPDLBFX+8                                               07692000
@NM00131 EQU   @NM00129+7                                               07693000
@NM00130 EQU   @NM00129                                                 07694000
@NM00128 EQU   IOPDLBDR+1                                               07695000
@NM00127 EQU   IOPDLBDR                                                 07696000
IOPMDIND EQU   IOPMNTRY+8                                               07697000
@NM00126 EQU   IOPMODST                                                 07698000
@NM00125 EQU   IOPMODFX+12                                              07699000
@NM00124 EQU   IOPMODF4                                                 07700000
@NM00123 EQU   IOPMODF3                                                 07701000
@NM00122 EQU   IOPMODF2                                                 07702000
IOPMPAGA EQU   IOPMODF2                                                 07703000
IOPMNE   EQU   IOPMODF2                                                 07704000
@NM00121 EQU   IOPMODF1                                                 07705000
IOPMDC   EQU   IOPMODF1                                                 07706000
IOPMREFR EQU   IOPMODF1                                                 07707000
IOPMOVLY EQU   IOPMODF1                                                 07708000
IOPMSCTR EQU   IOPMODF1                                                 07709000
IOPMREUS EQU   IOPMODF1                                                 07710000
IOPMRENT EQU   IOPMODF1                                                 07711000
IOPMAPF  EQU   IOPMODF1                                                 07712000
@NM00120 EQU   @NM00118+7                                               07713000
@NM00119 EQU   @NM00118                                                 07714000
@NM00117 EQU   IOPMODDR+17                                              07715000
@NM00116 EQU   @NM00114+7                                               07716000
@NM00115 EQU   @NM00114                                                 07717000
@NM00113 EQU   @NM00110                                                 07718000
@NM00112 EQU   @NM00110                                                 07719000
@NM00111 EQU   @NM00110                                                 07720000
@NM00109 EQU   @NM00108                                                 07721000
@NM00107 EQU   IOPMODDR                                                 07722000
IOPSRIND EQU   IOPSNTRY+8                                               07723000
@NM00106 EQU   IOPSRCST                                                 07724000
@NM00105 EQU   IOPSRCFX+8                                               07725000
@NM00104 EQU   @NM00102+7                                               07726000
@NM00103 EQU   @NM00102                                                 07727000
@NM00101 EQU   IOPSRCDR+18                                              07728000
IOPSRLNG EQU   IOPSRCDR+17                                              07729000
@NM00100 EQU   @NM00098+7                                               07730000
@NM00099 EQU   @NM00098                                                 07731000
@NM00097 EQU   @NM00094                                                 07732000
@NM00096 EQU   @NM00094                                                 07733000
@NM00095 EQU   @NM00094                                                 07734000
@NM00093 EQU   @NM00092                                                 07735000
@NM00091 EQU   IOPSRCDR                                                 07736000
IOPEOFND EQU   IOPEOFNT                                                 07737000
IOPMCTYP EQU   IOPMCIND                                                 07738000
@NM00090 EQU   IOPMACST                                                 07739000
@NM00089 EQU   IOPMACFX+8                                               07740000
@NM00088 EQU   IOPMACDR+18                                              07741000
@NM00087 EQU   IOPRMST                                                  07742000
IOPRMASM EQU   IOPRMST                                                  07743000
@NM00086 EQU   IOPRMST                                                  07744000
@NM00085 EQU   IOPMACDR                                                 07745000
@NM00083 EQU   @NM00081+7                                               07746000
@NM00082 EQU   @NM00081                                                 07747000
@NM00080 EQU   IOPLMDDR+6                                               07748000
@NM00079 EQU   IOPFLGS3                                                 07749000
IOPCHREP EQU   IOPFLGS3                                                 07750000
@NM00078 EQU   IOPLMDF4                                                 07751000
@NM00077 EQU   IOPLMDF3                                                 07752000
@NM00076 EQU   IOPLMDF2                                                 07753000
@NM00075 EQU   IOPFLGS2                                                 07754000
@NM00074 EQU   IOPLMDDR                                                 07755000
@NM00073 EQU   IOPASMDR+9                                               07756000
IOPABUTP EQU   IOPABUNT+7                                               07757000
IOPABUPT EQU   IOPABUNT                                                 07758000
IOPALLOC EQU   @NM00072+4                                               07759000
IOPUSED  EQU   @NM00072                                                 07760000
IOPTPSEQ EQU   @NM00071+8                                               07761000
IOPVLSER EQU   @NM00071+2                                               07762000
IOPBLKSI EQU   @NM00071                                                 07763000
IOPCQMAX EQU   IOPCQMAP+12                                              07764000
@NM00070 EQU   IOPCQMAP+11                                              07765000
@NM00069 EQU   IOPCQMAP+8                                               07766000
@NM00068 EQU   IOPCQMAP                                                 07767000
IOPPTMAX EQU   IOPCDMAX                                                 07768000
@NM00067 EQU   IOPSCMAP+11                                              07769000
@NM00066 EQU   IOPSCMAP+8                                               07770000
@NM00065 EQU   IOPSCMAP                                                 07771000
IOPDIRMX EQU   IOPNTMAX+12                                              07772000
@NM00064 EQU   IOPNTMAX+11                                              07773000
@NM00063 EQU   IOPNTMAX+8                                               07774000
@NM00062 EQU   IOPNTMAX                                                 07775000
@NM00061 EQU   IOPDTYPE                                                 07776000
IOPDMOD  EQU   IOPDTYPE                                                 07777000
IOPDJCL  EQU   IOPDTYPE                                                 07778000
IOPDSRC  EQU   IOPDTYPE                                                 07779000
IOPDMAC  EQU   IOPDTYPE                                                 07780000
IOPSDIR  EQU   IOPSPACE+4                                               07781000
IOPSSCND EQU   IOPSPACE+2                                               07782000
IOPSPRIM EQU   IOPSPACE                                                 07783000
IOPDSN   EQU   IOPDYNDT                                                 07784000
IOPNTYPE EQU   IOPSTCMP+17                                              07785000
IOPNNAME EQU   IOPSTCMP+9                                               07786000
IOPOTYPE EQU   IOPSTCMP+8                                               07787000
IOPONAME EQU   IOPSTCMP                                                 07788000
IOPISEQ3 EQU   IOPINAM3+6                                               07789000
IOPITYP3 EQU   @NM00060+5                                               07790000
IOPIPTF3 EQU   @NM00060                                                 07791000
CRPDDNAM EQU   HMASMCRP+98                                              07792000
CRPBFSEQ EQU   CRPBUFFR+72                                              07793000
CRPBFCNT EQU   CRPBFCTL+71                                              07794000
CRPBFDTA EQU   CRPBFCTL                                                 07795000
CRPINSWF EQU   CRPFLG2+1                                                07796000
CRPINSWE EQU   CRPFLG2+1                                                07797000
CRPINSWD EQU   CRPFLG2+1                                                07798000
CRPINSWC EQU   CRPFLG2+1                                                07799000
CRPINSWB EQU   CRPFLG2+1                                                07800000
CRPINSWA EQU   CRPFLG2+1                                                07801000
CRPINSW9 EQU   CRPFLG2+1                                                07802000
CRPINSW8 EQU   CRPFLG2+1                                                07803000
CRPINSW7 EQU   CRPFLG2                                                  07804000
CRPINSW6 EQU   CRPFLG2                                                  07805000
CRPINSW5 EQU   CRPFLG2                                                  07806000
CRPINSW4 EQU   CRPFLG2                                                  07807000
CRPEOF1  EQU   CRPINSW3                                                 07808000
CRPWRTLG EQU   CRPINSW2                                                 07809000
CRPEXADD EQU   CRPINSW1                                                 07810000
CRPEOFSW EQU   CRPINSW0                                                 07811000
@NM00010 EQU   CRPFLG1+1                                                07812000
CRPRPT   EQU   CRPFLG1+1                                                07813000
CRPLIST  EQU   CRPFLG1+1                                                07814000
CRPNOWPP EQU   CRPFLG1+1                                                07815000
CRPTRMEX EQU   CRPFLG1+1                                                07816000
CRPSCNCL EQU   CRPFLG1                                                  07817000
CRPOFFST EQU   CRPFLG1                                                  07818000
CRPOTHER EQU   CRPFLG1                                                  07819000
CRPPRINT EQU   CRPFLG1                                                  07820000
CRPLOG   EQU   CRPFLG1                                                  07821000
CRPPTS   EQU   CRPFLG1                                                  07822000
CRPLOGCK EQU   CRPFLG1                                                  07823000
CRPBFPRM EQU   CRPFLG1                                                  07824000
@NM00009 EQU   HMASMCRP+11                                              07825000
CRPOUTDS EQU   HMASMCRP+9                                               07826000
CRPINDS  EQU   HMASMCRP+8                                               07827000
@NM00008 EQU   HMASMCRP+1                                               07828000
CRPUXNUM EQU   HMASMCRP                                                 07829000
@NM00007 EQU   UCLFLG5                                                  07830000
UCLICTOK EQU   UCLFLG5                                                  07831000
@NM00006 EQU   UCLFLG4                                                  07832000
UCLBPFM  EQU   UCLFLG4                                                  07833000
@NM00005 EQU   UCLFLG4                                                  07834000
UCLBPIRQ EQU   UCLFLG4                                                  07835000
UCLBPREQ EQU   UCLFLG4                                                  07836000
UCLBPPRE EQU   UCLFLG4                                                  07837000
UCLBPID  EQU   UCLFLG4                                                  07838000
@NM00004 EQU   UCLFLG3+1                                                07839000
UCLSTS   EQU   UCLFLG3                                                  07840000
UCLMTS   EQU   UCLFLG3                                                  07841000
UCLPTS   EQU   UCLFLG3                                                  07842000
UCLACRQ  EQU   UCLFLG3                                                  07843000
UCLCRQ   EQU   UCLFLG3                                                  07844000
UCLSCDS  EQU   UCLFLG3                                                  07845000
UCLMASS  EQU   UCLFLG2                                                  07846000
@NM00003 EQU   UCLFLG2                                                  07847000
UCLFMID  EQU   UCLFLG2                                                  07848000
UCLGROUP EQU   UCLFLG2                                                  07849000
UCLEXC   EQU   UCLFLG2                                                  07850000
UCLSEL   EQU   UCLFLG2                                                  07851000
@NM00002 EQU   UCLFLG1+1                                                07852000
UCLDISW  EQU   UCLFLG1+1                                                07853000
UCLDISR  EQU   UCLFLG1+1                                                07854000
UCLDISN  EQU   UCLFLG1+1                                                07855000
UCLNOJCL EQU   UCLFLG1                                                  07856000
UCLUSER  EQU   UCLFLG1                                                  07857000
UCLAPAR  EQU   UCLFLG1                                                  07858000
UCLCOMP  EQU   UCLFLG1                                                  07859000
UCLASSEM EQU   UCLFLG1                                                  07860000
UCLCHECK EQU   UCLFLG1                                                  07861000
UCLNOAPP EQU   UCLFLG1                                                  07862000
@NM00001 EQU   UCLPARM+5                                                07863000
UCLNUCID EQU   UCLPARM+4                                                07864000
UCLJCLGT EQU   UCLPARM                                                  07865000
@NM00189 EQU   PECHAR4+3                                                07866000
@NM00188 EQU   PECHAR3+2                                                07867000
PECHAR2  EQU   PECHAR3                                                  07868000
@NM00183 EQU   SCPEOR                                                   07869000
SCPNOSUC EQU   SCPEOR                                                   07870000
SCPRTERR EQU   SCPEOR                                                   07871000
SCPCOMNT EQU   SCPEOR                                                   07872000
SCPNOCT  EQU   SCPEOR                                                   07873000
SCPCONT  EQU   SCPEOR                                                   07874000
SCPINLN  EQU   HMASMSCP+20                                              07875000
SCPIORTN EQU   HMASMSCP+12                                              07876000
SCPWKAR  EQU   HMASMSCP+8                                               07877000
PRLCONC  EQU   PRLTIME+2                                                07878000
@NM00182 EQU   PRLTIME                                                  07879000
PRLHDADR EQU   PRLDATE                                                  07880000
@NM00181 EQU   PRLFLGS                                                  07881000
PRLHEADO EQU   PRLFLGS                                                  07882000
PRLHEAD  EQU   PRLFLGS                                                  07883000
PRLRLEN  EQU   HMASMPRL                                                 07884000
IOPBS04E EQU   IOPBS04+2                                                07885000
IOPBAPFC EQU   IOPBAPF+1                                                07886000
IOPBAPFL EQU   IOPBAPF                                                  07887000
IOPBS2NM EQU   IOPBS02+3                                                07888000
IOPBS2EP EQU   IOPBS02                                                  07889000
IOPQSMTP EQU   IOPQSMLS+8                                               07890000
@NM00166 EQU   IOPQSMLS+7                                               07891000
IOPQSMND EQU   IOPQSMNM                                                 07892000
@NM00165 EQU   @NM00164+7                                               07893000
IOPQSMFM EQU   @NM00164                                                 07894000
@NM00084 EQU   IOPLMCTL+17                                              07895000
IOPLMCRD EQU   IOPLMCTL+9                                               07896000
IOPLMCRN EQU   IOPLMCTL+1                                               07897000
IOPLMCC  EQU   IOPLMCTL                                                 07898000
@NM00059 EQU   IOPUSERL                                                 07899000
@NM00058 EQU   IOPUSERL                                                 07900000
IOPALIS  EQU   IOPUSERL                                                 07901000
IOPTTR   EQU   IOPDRMAP+8                                               07902000
IOPINAM2 EQU   IOPINAM+1                                                07903000
IOPITYP2 EQU   IOPITYP                                                  07904000
@NM00057 EQU   HMASMIOP+32                                              07905000
IOPDELDD EQU   IOPDDNAM                                                 07906000
@NM00056 EQU   @NM00053+10                                              07907000
IOPSEQNO EQU   @NM00053+8                                               07908000
@NM00055 EQU   @NM00054+7                                               07909000
IOPPTFNM EQU   @NM00054                                                 07910000
CCABMREC EQU   CCABELMT+10                                              07911000
CCABPOS  EQU   CCABMPOS+8                                               07912000
CCABNAME EQU   CCABMPOS                                                 07913000
@NM00052 EQU   CCABLDLM+2                                               07914000
@NM00051 EQU   CCABLDLM                                                 07915000
CCAUPDPM EQU   @NM00049+24                                              07916000
@NM00050 EQU   @NM00049+21                                              07917000
CCARUPDT EQU   CCAUPDRC                                                 07918000
CCAUPDSP EQU   @NM00049+12                                              07919000
CCAUPDTE EQU   @NM00049+8                                               07920000
CCAUPDNM EQU   @NM00049                                                 07921000
CCASUPPM EQU   @NM00047+24                                              07922000
@NM00048 EQU   @NM00047+21                                              07923000
CCARSUP  EQU   CCASUPRC                                                 07924000
CCASUPSP EQU   @NM00047+12                                              07925000
CCAIOSUP EQU   @NM00047+8                                               07926000
CCASUPNM EQU   @NM00047                                                 07927000
CCAZAPPM EQU   @NM00045+24                                              07928000
@NM00046 EQU   @NM00045+21                                              07929000
CCARZAP  EQU   CCAZAPRC                                                 07930000
CCAZAPSP EQU   @NM00045+12                                              07931000
CCASPZAP EQU   @NM00045+8                                               07932000
CCAZAPNM EQU   @NM00045                                                 07933000
CCACOMPM EQU   @NM00043+24                                              07934000
@NM00044 EQU   @NM00043+21                                              07935000
CCARCOMP EQU   CCACOMRC                                                 07936000
CCACOMSP EQU   @NM00043+12                                              07937000
CCACOMRS EQU   @NM00043+8                                               07938000
CCACOMNM EQU   @NM00043                                                 07939000
CCACPYPM EQU   @NM00041+24                                              07940000
@NM00042 EQU   @NM00041+21                                              07941000
CCARCOPY EQU   CCACPYRC                                                 07942000
CCACPYSP EQU   @NM00041+12                                              07943000
CCACOPY  EQU   @NM00041+8                                               07944000
CCACPYNM EQU   @NM00041                                                 07945000
CCAASMPM EQU   @NM00039+24                                              07946000
@NM00040 EQU   @NM00039+21                                              07947000
CCARASM  EQU   CCAASMRC                                                 07948000
CCAASMSP EQU   @NM00039+12                                              07949000
CCAASM   EQU   @NM00039+8                                               07950000
CCAASMNM EQU   @NM00039                                                 07951000
CCALKDPM EQU   @NM00037+24                                              07952000
@NM00038 EQU   @NM00037+21                                              07953000
CCARLINK EQU   CCALKDRC                                                 07954000
CCALKDSP EQU   @NM00037+12                                              07955000
CCALKED  EQU   @NM00037+8                                               07956000
CCALKDNM EQU   @NM00037                                                 07957000
CCAPGMPM EQU   @NM00035+24                                              07958000
@NM00036 EQU   @NM00035+21                                              07959000
CCABPGRC EQU   @NM00035+20                                              07960000
CCABPGSP EQU   @NM00035+12                                              07961000
CCABPGAD EQU   @NM00035+8                                               07962000
CCABPGNM EQU   @NM00035                                                 07963000
CCAEND   EQU   HMASMCCA+371                                             07964000
@NM00034 EQU   HMASMCCA+309                                             07965000
CCACURDD EQU   CCAFDSNG+3                                               07966000
CCACURDS EQU   CCAFDSNG+2                                               07967000
@NM00033 EQU   CCAFLAGB                                                 07968000
CCAOUTNG EQU   CCAFLAGB                                                 07969000
CCALOGNG EQU   CCAFLAGB                                                 07970000
CCALSTDS EQU   CCAFCTL+8                                                07971000
CCARPTDS EQU   CCAFCTL+7                                                07972000
@NM00032 EQU   CCAFLAG9                                                 07973000
CCARVCAN EQU   CCAFLAG9                                                 07974000
CCARVEST EQU   CCAFLAG9                                                 07975000
CCAPTSNJ EQU   CCAFLAG9                                                 07976000
CCASTSNP EQU   CCAFLAG9                                                 07977000
CCAMTSNP EQU   CCAFLAG9                                                 07978000
CCAPTSNP EQU   CCAFLAG9                                                 07979000
@NM00031 EQU   CCAFLAG8                                                 07980000
CCAACDSC EQU   CCAFLAG8                                                 07981000
CCACDSC  EQU   CCAFLAG8                                                 07982000
@NM00030 EQU   CCAFLAG6                                                 07983000
CCAACRUP EQU   CCAFLAG6                                                 07984000
CCACRQUP EQU   CCAFLAG6                                                 07985000
CCAACDUP EQU   CCAFLAG6                                                 07986000
CCACDSUP EQU   CCAFLAG6                                                 07987000
@NM00029 EQU   CCAFLAG5                                                 07988000
CCAACROS EQU   CCAFLAG5                                                 07989000
CCACRQOS EQU   CCAFLAG5                                                 07990000
CCAACDOS EQU   CCAFLAG5                                                 07991000
CCACDSOS EQU   CCAFLAG5                                                 07992000
@NM00028 EQU   CCAFLAG4                                                 07993000
CCAACRIS EQU   CCAFLAG4                                                 07994000
CCACRQIS EQU   CCAFLAG4                                                 07995000
CCAACDIS EQU   CCAFLAG4                                                 07996000
CCACDSIS EQU   CCAFLAG4                                                 07997000
@NM00027 EQU   CCAFLAG3+1                                               07998000
CCARGNP  EQU   CCAFLAG3+1                                               07999000
CCADISRQ EQU   CCAFLAG3+1                                               08000000
CCAICTOK EQU   CCAFLAG3                                                 08001000
CCADELP  EQU   CCAFLAG3                                                 08002000
CCACMPRS EQU   CCAFLAG3                                                 08003000
CCAZAPP  EQU   CCAFLAG3                                                 08004000
CCALINKP EQU   CCAFLAG3                                                 08005000
CCACOPYP EQU   CCAFLAG3                                                 08006000
CCAASIP  EQU   CCAFLAG3                                                 08007000
CCAUPDP  EQU   CCAFLAG3                                                 08008000
CCAEOSMP EQU   CCAFLAG2                                                 08009000
CCAEOFNC EQU   CCAFLAG2                                                 08010000
@NM00026 EQU   CCAFLAG2                                                 08011000
CCACHECK EQU   CCAFLAG2                                                 08012000
CCATERM  EQU   CCAFLAG2                                                 08013000
CCASVCLB EQU   CCAFLAG2                                                 08014000
CCANCPTF EQU   CCAFLAG2                                                 08015000
@NM00025 EQU   CCAFLAG1+1                                               08016000
CCAUNL   EQU   CCAFLAG1+1                                               08017000
CCARESET EQU   CCAFLAG1+1                                               08018000
CCALOG   EQU   CCAFLAG1+1                                               08019000
CCACNV   EQU   CCAFLAG1+1                                               08020000
CCALIST  EQU   CCAFLAG1                                                 08021000
CCAUPDU  EQU   CCAFLAG1                                                 08022000
CCAUPDJ  EQU   CCAFLAG1                                                 08023000
CCARES   EQU   CCAFLAG1                                                 08024000
CCAREJ   EQU   CCAFLAG1                                                 08025000
CCAACCPT EQU   CCAFLAG1                                                 08026000
CCAAPPLY EQU   CCAFLAG1                                                 08027000
CCAREC   EQU   CCAFLAG1                                                 08028000
CCAFUNCT EQU   CCAFFUNC                                                 08029000
@NM00024 EQU   @NM00019+18                                              08030000
@NM00023 EQU   @NM00019+16                                              08031000
CCATBLPA EQU   @NM00019+12                                              08032000
@NM00022 EQU   @NM00019+8                                               08033000
@NM00021 EQU   @NM00019+4                                               08034000
@NM00020 EQU   @NM00019                                                 08035000
CCAIFGTP EQU   CCAFGTP+16                                               08036000
CCAGTP3  EQU   CCAFGTP+12                                               08037000
CCAGTP2  EQU   CCAFGTP+8                                                08038000
CCAGTP1  EQU   CCAFGTP+4                                                08039000
CCASETAD EQU   CCASEGTP                                                 08040000
CCACLST  EQU   CCAFPGM+12                                               08041000
CCASPDCB EQU   CCAFPGM+8                                                08042000
CCAICLMD EQU   CCAFICT+12                                               08043000
CCAICMOD EQU   CCAFICT+8                                                08044000
CCAICPTF EQU   CCAFICT+4                                                08045000
CCAICT   EQU   CCAFICT                                                  08046000
CCARVAD  EQU   CCAFSTA                                                  08047000
CCAACDID EQU   CCAFSYS+32                                               08048000
CCACDSID EQU   CCAFSYS+24                                               08049000
CCALNLEN EQU   CCAFSYS+22                                               08050000
@NM00018 EQU   CCAFLAGA                                                 08051000
CCAPSYSF EQU   CCAFLAGA                                                 08052000
CCAASYSF EQU   CCAFLAGA                                                 08053000
CCACSYSF EQU   CCAFLAGA                                                 08054000
CCANUCID EQU   CCAFSYS+20                                               08055000
CCAASREL EQU   CCAFSYS+16                                               08056000
CCACSREL EQU   CCASREL                                                  08057000
CCAPEMAX EQU   CCAFSYS+10                                               08058000
CCAPGLEN EQU   CCAFSYS+8                                                08059000
CCAIOPAS EQU   CCAFSYS+4                                                08060000
@NM00017 EQU   CCAFLAG7+3                                               08061000
CCALOGP  EQU   CCAFLAG7+2                                               08062000
CCAOUTP  EQU   CCAFLAG7+2                                               08063000
CCASLBP  EQU   CCAFLAG7+2                                               08064000
CCARPTP  EQU   CCAFLAG7+2                                               08065000
CCALISTP EQU   CCAFLAG7+2                                               08066000
CCAJCLP  EQU   CCAFLAG7+2                                               08067000
CCAPTFP  EQU   CCAFLAG7+2                                               08068000
CCATLBP  EQU   CCAFLAG7+2                                               08069000
CCAUT3P  EQU   CCAFLAG7+1                                               08070000
CCAUT2P  EQU   CCAFLAG7+1                                               08071000
CCAUT1P  EQU   CCAFLAG7+1                                               08072000
CCAWK5P  EQU   CCAFLAG7+1                                               08073000
CCAWK4P  EQU   CCAFLAG7+1                                               08074000
CCAWK3P  EQU   CCAFLAG7+1                                               08075000
CCAWK2P  EQU   CCAFLAG7+1                                               08076000
CCAWK1P  EQU   CCAFLAG7+1                                               08077000
CCAACRQP EQU   CCAFLAG7                                                 08078000
CCACRQP  EQU   CCAFLAG7                                                 08079000
CCASTSP  EQU   CCAFLAG7                                                 08080000
CCAMTSP  EQU   CCAFLAG7                                                 08081000
CCAPTSP  EQU   CCAFLAG7                                                 08082000
CCASCDSP EQU   CCAFLAG7                                                 08083000
CCAACDSP EQU   CCAFLAG7                                                 08084000
CCACDSP  EQU   CCAFLAG7                                                 08085000
@NM00016 EQU   CCAFBUFR+122                                             08086000
@NM00015 EQU   CCAFBUFR+120                                             08087000
@NM00014 EQU   CCAFBUFR+118                                             08088000
CCATBFMX EQU   CCAFBUFR+116                                             08089000
CCA4BFMX EQU   CCAFBUFR+114                                             08090000
CCA3BFMX EQU   CCAFBUFR+112                                             08091000
CCA2BFMX EQU   CCAFBUFR+110                                             08092000
CCA1BFMX EQU   CCAFBUFR+108                                             08093000
CCAXBFMX EQU   CCAFBUFR+106                                             08094000
CCAQBFMX EQU   CCAFBUFR+104                                             08095000
CCASBFMX EQU   CCAFBUFR+102                                             08096000
CCAMBFMX EQU   CCAFBUFR+100                                             08097000
CCAPBFMX EQU   CCAFBUFR+98                                              08098000
CCAVBFMX EQU   CCAFBUFR+96                                              08099000
CCAABFMX EQU   CCAFBUFR+94                                              08100000
CCACBFMX EQU   CCAFBUFR+92                                              08101000
@NM00013 EQU   CCAFBUFR+88                                              08102000
@NM00012 EQU   CCAFBUFR+84                                              08103000
CCA4BFSZ EQU   CCAFBUFR+80                                              08104000
CCATBFSZ EQU   CCAFBUFR+76                                              08105000
CCAWBFSZ EQU   CCAFBUFR+72                                              08106000
CCAQBFSZ EQU   CCAFBUFR+68                                              08107000
CCAPBFSZ EQU   CCAFBUFR+64                                              08108000
CCAVBFSZ EQU   CCAFBUFR+60                                              08109000
CCACBFSZ EQU   CCAFBUFR+56                                              08110000
@NM00011 EQU   CCAFBUFR+52                                              08111000
CCA4BFOA EQU   CCAFBUFR+48                                              08112000
CCA4BFIA EQU   CCAFBUFR+44                                              08113000
CCATBFIA EQU   CCAFBUFR+40                                              08114000
CCAWBFOA EQU   CCAFBUFR+36                                              08115000
CCAWBFIA EQU   CCAFBUFR+32                                              08116000
CCAQBFOA EQU   CCAFBUFR+28                                              08117000
CCAQBFIA EQU   CCAFBUFR+24                                              08118000
CCAPBFOA EQU   CCAFBUFR+20                                              08119000
CCAPBFIA EQU   CCAFBUFR+16                                              08120000
CCAVBFOA EQU   CCAFBUFR+12                                              08121000
CCAVBFIA EQU   CCAFBUFR+8                                               08122000
CCACBFOA EQU   CCAFBUFR+4                                               08123000
CCACBFIA EQU   CCAFBUFR                                                 08124000
CCAID    EQU   HMASMCCA                                                 08125000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08126000
@RT00398 EQU   RXXXLOC                                                  08127000
@RF00422 EQU   @EL00003                                                 08128000
@RC00420 EQU   @EL00003                                                 08129000
@RC00415 EQU   @EL00003                                                 08130000
@RC00408 EQU   @EL00003                                                 08131000
@RF00425 EQU   @EL00003                                                 08132000
@RF00430 EQU   @EL00003                                                 08133000
@RC00444 EQU   @EL00004                                                 08134000
@RC00438 EQU   @EL00004                                                 08135000
@RC00461 EQU   @EL00004                                                 08136000
@RC00455 EQU   @EL00004                                                 08137000
@RC00478 EQU   @EL00004                                                 08138000
@RC00472 EQU   @EL00004                                                 08139000
@RC00495 EQU   @EL00004                                                 08140000
@RC00489 EQU   @EL00004                                                 08141000
@RC00512 EQU   @EL00004                                                 08142000
@RC00506 EQU   @EL00004                                                 08143000
@RC00523 EQU   @EL00004                                                 08144000
@RC00562 EQU   @EL00004                                                 08145000
@RC00556 EQU   @EL00004                                                 08146000
@RC00571 EQU   @EL00004                                                 08147000
@RC00569 EQU   @EL00004                                                 08148000
@RC00619 EQU   @EL00004                                                 08149000
@RC00612 EQU   @EL00004                                                 08150000
@RC00635 EQU   @EL00004                                                 08151000
@RC00629 EQU   @EL00004                                                 08152000
@RC00767 EQU   @EL00004                                                 08153000
@RC00761 EQU   @EL00004                                                 08154000
@RC00779 EQU   @EL00004                                                 08155000
@RC00774 EQU   @EL00004                                                 08156000
@RC00795 EQU   @EL00004                                                 08157000
@RC00789 EQU   @EL00004                                                 08158000
@RC00807 EQU   @EL00004                                                 08159000
@RC00802 EQU   @EL00004                                                 08160000
@RC00823 EQU   @EL00004                                                 08161000
@RC00817 EQU   @EL00004                                                 08162000
@RC00835 EQU   @EL00004                                                 08163000
@RC00830 EQU   @EL00004                                                 08164000
@RC00853 EQU   @EL00005                                                 08165000
@RC00847 EQU   @EL00005                                                 08166000
@RC00865 EQU   @EL00005                                                 08167000
@RC00860 EQU   @EL00005                                                 08168000
@RC00881 EQU   @EL00005                                                 08169000
@RC00875 EQU   @EL00005                                                 08170000
@RC00893 EQU   @EL00005                                                 08171000
@RC00888 EQU   @EL00005                                                 08172000
@RC00907 EQU   RMACADD1                                                 08173000
@RC00917 EQU   RMACADD1                                                 08174000
@RF00927 EQU   @EL00005                                                 08175000
@RC00944 EQU   @EL00006                                                 08176000
@RC00937 EQU   @EL00006                                                 08177000
@RC00957 EQU   @EL00006                                                 08178000
@RC00951 EQU   @EL00006                                                 08179000
@RC00973 EQU   @EL00006                                                 08180000
@RC00967 EQU   @EL00006                                                 08181000
@RC00985 EQU   @EL00006                                                 08182000
@RC00980 EQU   @EL00006                                                 08183000
@RC01002 EQU   @EL00006                                                 08184000
@RC00995 EQU   @EL00006                                                 08185000
@RC01015 EQU   @EL00006                                                 08186000
@RC01009 EQU   @EL00006                                                 08187000
@RC01054 EQU   @EL00007                                                 08188000
@RC01048 EQU   @EL00007                                                 08189000
@RC01071 EQU   @EL00007                                                 08190000
@RC01065 EQU   @EL00007                                                 08191000
@RC01088 EQU   @EL00007                                                 08192000
@RC01082 EQU   @EL00007                                                 08193000
@RC01105 EQU   @EL00007                                                 08194000
@RC01099 EQU   @EL00007                                                 08195000
@RC01122 EQU   @EL00007                                                 08196000
@RC01116 EQU   @EL00007                                                 08197000
@RC01139 EQU   @EL00007                                                 08198000
@RC01133 EQU   @EL00007                                                 08199000
@RC01156 EQU   @EL00007                                                 08200000
@RC01150 EQU   @EL00007                                                 08201000
@RC01173 EQU   @EL00007                                                 08202000
@RC01167 EQU   @EL00007                                                 08203000
@RC01190 EQU   @EL00007                                                 08204000
@RC01184 EQU   @EL00007                                                 08205000
@RC01207 EQU   @EL00007                                                 08206000
@RC01201 EQU   @EL00007                                                 08207000
@RC01224 EQU   @EL00007                                                 08208000
@RC01218 EQU   @EL00007                                                 08209000
@RC01261 EQU   @EL00009                                                 08210000
@RC01255 EQU   @EL00009                                                 08211000
@RC01273 EQU   @EL00009                                                 08212000
@RC01268 EQU   @EL00009                                                 08213000
@RC01289 EQU   @EL00009                                                 08214000
@RC01283 EQU   @EL00009                                                 08215000
@RC01301 EQU   @EL00009                                                 08216000
@RC01296 EQU   @EL00009                                                 08217000
@RC01324 EQU   @EL00009                                                 08218000
@RC01318 EQU   @EL00009                                                 08219000
@RC01336 EQU   @EL00009                                                 08220000
@RC01331 EQU   @EL00009                                                 08221000
@RC01350 EQU   @EL00009                                                 08222000
@RC01344 EQU   @EL00009                                                 08223000
@RC01367 EQU   @EL00009                                                 08224000
@RC01361 EQU   @EL00009                                                 08225000
@RC01386 EQU   @EL00009                                                 08226000
@RC01380 EQU   @EL00009                                                 08227000
@RC01398 EQU   @EL00009                                                 08228000
@RC01393 EQU   @EL00009                                                 08229000
@RC01421 EQU   @RC01419                                                 08230000
@RF01436 EQU   @EL00011                                                 08231000
@RF01457 EQU   @EL00015                                                 08232000
@RF01547 EQU   @RC01523                                                 08233000
@RF01587 EQU   @RC01585                                                 08234000
@RF01593 EQU   @RC01591                                                 08235000
@RF01603 EQU   @RC01601                                                 08236000
@RC00440 EQU   @RC00438                                                 08237000
@RC00446 EQU   @RC00444                                                 08238000
@RC00457 EQU   @RC00455                                                 08239000
@RC00463 EQU   @RC00461                                                 08240000
@RC00474 EQU   @RC00472                                                 08241000
@RC00480 EQU   @RC00478                                                 08242000
@RC00491 EQU   @RC00489                                                 08243000
@RC00497 EQU   @RC00495                                                 08244000
@RC00508 EQU   @RC00506                                                 08245000
@RC00514 EQU   @RC00512                                                 08246000
@RC00531 EQU   @RC00523                                                 08247000
@RC00525 EQU   @RC00523                                                 08248000
@RC00564 EQU   @RC00562                                                 08249000
@RC00621 EQU   @RC00619                                                 08250000
@RC00769 EQU   @RC00767                                                 08251000
@RC00797 EQU   @RC00795                                                 08252000
@RC00825 EQU   @RC00823                                                 08253000
@RC00855 EQU   @RC00853                                                 08254000
@RC00883 EQU   @RC00881                                                 08255000
@RC00946 EQU   @RC00944                                                 08256000
@RC00975 EQU   @RC00973                                                 08257000
@RC01004 EQU   @RC01002                                                 08258000
@RC01050 EQU   @RC01048                                                 08259000
@RC01056 EQU   @RC01054                                                 08260000
@RC01067 EQU   @RC01065                                                 08261000
@RC01073 EQU   @RC01071                                                 08262000
@RC01084 EQU   @RC01082                                                 08263000
@RC01090 EQU   @RC01088                                                 08264000
@RC01101 EQU   @RC01099                                                 08265000
@RC01107 EQU   @RC01105                                                 08266000
@RC01118 EQU   @RC01116                                                 08267000
@RC01124 EQU   @RC01122                                                 08268000
@RC01135 EQU   @RC01133                                                 08269000
@RC01141 EQU   @RC01139                                                 08270000
@RC01152 EQU   @RC01150                                                 08271000
@RC01158 EQU   @RC01156                                                 08272000
@RC01169 EQU   @RC01167                                                 08273000
@RC01175 EQU   @RC01173                                                 08274000
@RC01186 EQU   @RC01184                                                 08275000
@RC01192 EQU   @RC01190                                                 08276000
@RC01203 EQU   @RC01201                                                 08277000
@RC01209 EQU   @RC01207                                                 08278000
@RC01220 EQU   @RC01218                                                 08279000
@RC01226 EQU   @RC01224                                                 08280000
@RC01263 EQU   @RC01261                                                 08281000
@RC01291 EQU   @RC01289                                                 08282000
@RC01326 EQU   @RC01324                                                 08283000
@RC01346 EQU   @RC01344                                                 08284000
@RC01352 EQU   @RC01350                                                 08285000
@RC01363 EQU   @RC01361                                                 08286000
@RC01369 EQU   @RC01367                                                 08287000
@RC01388 EQU   @RC01386                                                 08288000
@RC00527 EQU   @RC00525                                                 08289000
@RC00533 EQU   @RC00531                                                 08290000
@ENDDATA EQU   *                                                        08291000
         END   HMASMUC1,(C'PLS2226',0802,78334)                         08292000
