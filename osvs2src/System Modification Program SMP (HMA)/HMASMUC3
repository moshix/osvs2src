         TITLE 'HMASMUC3 - HMASMP UCLIN TO SMPCRQ/SMPACRQ'              00001000
HMASMUC3 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMUC3  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
         ST    @13,@SA00001+4                                      0001 00013000
         LA    @14,@SA00001                                        0001 00014000
         ST    @14,8(,@13)                                         0001 00015000
         LR    @13,@14                                             0001 00016000
         MVC   @PC00001(8),0(@01)                                  0001 00017000
         EJECT                                                          00018000
*                                                                  0196 00019000
*   /*****************************************************************/ 00020000
*   /*                                                               */ 00021000
*   /* INITIALIZE PTRS AND LOCAL VARIABLES                           */ 00022000
*   /*                                                               */ 00023000
*   /*****************************************************************/ 00024000
*                                                                  0196 00025000
*   IOPPTR=CCAIOPTR;                /* COMMON IOP                    */ 00026000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0196 00027000
*   IOPPTR2=ADDR(UC3IOP);           /* IOP FOR SYSMODS               */ 00028000
         LA    @10,UC3IOP                                          0197 00029000
         ST    @10,IOPPTR2                                         0197 00030000
*   SAVBUFAD=IOPBUFAD;              /* SAVE BUFFER ADDRESS           */ 00031000
         MVC   SAVBUFAD(4),IOPBUFAD(IOPPTR)                        0198 00032000
*   SCPPTR=CRPSCPAD;                /* PICK UP SCP FROM CRP          */ 00033000
         L     @10,@PC00001+4                                      0199 00034000
         MVC   SCPPTR(4),CRPSCPAD(@10)                             0199 00035000
*   HMASMMGP=''B;                   /* ZERO MSG PARM                 */ 00036000
         XC    HMASMMGP(24),HMASMMGP                               0200 00037000
*   MGPPRINT=ON;                    /* ALL MSG TO SMPOUT AND SMPLOG  */ 00038000
*   MGPHLDS=ON;                     /*                               */ 00039000
         OI    MGPPRINT,B'10010000'                                0202 00040000
*   UC3RTNCD=ZERO;                  /* INIT RETURN CODE              */ 00041000
         MVI   UC3RTNCD,X'00'                                      0203 00042000
*   UCLSWTBL=''B;                   /* ZERO INTERNAL SW              */ 00043000
*                                                                  0204 00044000
         XC    UCLSWTBL(5),UCLSWTBL                                0204 00045000
*   /*****************************************************************/ 00046000
*   /*                                                               */ 00047000
*   /* LOOP READING INPUT CARDS AND SCANNING THEM UNTIL EITHER END OF*/ 00048000
*   /* FILE OR END OF UCLIN STATEMENTS OR SEVERE ERROR ENCOUNTERED   */ 00049000
*   /* DURING PROCESSING                                             */ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0205 00053000
*   DO WHILE(                       /* CONTINUE PROCESSING WHILE     */ 00054000
*         UC3RTNCD<STOPSMP          /* NO ERRORS                     */ 00055000
*         &ENDUCL=OFF               /* AND ENDUCL NOT FOUND          */ 00056000
*         &CRPEOFEN=OFF             /* AND NOT END OF FILE ON INPUT  */ 00057000
*         );                        /*                               */ 00058000
         B     @DE00205                                            0205 00059000
@DL00205 DS    0H                                                  0206 00060000
*     TMPRTNCD=ZERO;                /* INIT THIS STMT RTN CD         */ 00061000
         MVI   TMPRTNCD,X'00'                                      0206 00062000
*     UCLSWTBL=''B;                 /* INIT SW                       */ 00063000
         XC    UCLSWTBL(5),UCLSWTBL                                0207 00064000
*     IF UC3RTNCD=STOPFUNC          /* IF PREV ERR TO STOP UCL       */ 00065000
*         |UCLFLUSH=ON              /* OR IN FLUSH MODE              */ 00066000
*       THEN                        /* THEN SET                      */ 00067000
         CLI   UC3RTNCD,12                                         0208 00068000
         BE    @RT00208                                            0208 00069000
         L     @10,@PC00001                                        0208 00070000
         TM    UCLFLUSH(@10),B'00000010'                           0208 00071000
         BNO   @RF00208                                            0208 00072000
@RT00208 DS    0H                                                  0209 00073000
*       DO;                         /* UP SO THAT STATEMENT WILL     */ 00074000
*         UCLFLUSH=ON;              /* BE FLUSHED                    */ 00075000
         L     @10,@PC00001                                        0210 00076000
         OI    UCLFLUSH(@10),B'00000010'                           0210 00077000
*         SCPNORT=ON;               /*                               */ 00078000
         L     @10,SCPPTR                                          0211 00079000
         OI    SCPNORT(@10),B'00000100'                            0211 00080000
*       END;                        /*                               */ 00081000
*     IOPNAME=BLANK8;               /* BLANK OUT IOPNAME             */ 00082000
*                                                                  0213 00083000
@RF00208 MVC   IOPNAME(8,IOPPTR),@CC01471                          0213 00084000
*     /***************************************************************/ 00085000
*     /*                                                             */ 00086000
*     /* READ IN NEXT CONTROL CARD                                   */ 00087000
*     /*                                                             */ 00088000
*     /***************************************************************/ 00089000
*                                                                  0214 00090000
*     CALL HMASMCRD(HMASMCRP);      /* READ NEXT RECORD              */ 00091000
         L     @10,@PC00001+4                                      0214 00092000
         ST    @10,@AL00001                                        0214 00093000
         L     @15,@CV01449                                        0214 00094000
         LA    @01,@AL00001                                        0214 00095000
         BALR  @14,@15                                             0214 00096000
*     IF CRPRETRN>CRPEOF            /* IF ERR IN READ                */ 00097000
*       THEN                        /*                               */ 00098000
         L     @10,@PC00001+4                                      0215 00099000
         CLI   CRPRETRN(@10),4                                     0215 00100000
         BNH   @RF00215                                            0215 00101000
*       TMPRTNCD=MAX(TMPRTNCD,CRPRETRN);/* SAVE RC                   */ 00102000
*                                                                  0216 00103000
         SLR   @08,@08                                             0216 00104000
         IC    @08,TMPRTNCD                                        0216 00105000
         SLR   @15,@15                                             0216 00106000
         IC    @15,CRPRETRN(,@10)                                  0216 00107000
         CR    @08,@15                                             0216 00108000
         BNL   *+6                                                      00109000
         LR    @08,@15                                             0216 00110000
         STC   @08,TMPRTNCD                                        0216 00111000
*     /***************************************************************/ 00112000
*     /*                                                             */ 00113000
*     /* IF CARD READ OK THEN SCAN IT                                */ 00114000
*     /*                                                             */ 00115000
*     /***************************************************************/ 00116000
*                                                                  0217 00117000
*     IF CRPRETRN=ZERO              /* IF CARD READ OK               */ 00118000
*       THEN                        /*                               */ 00119000
@RF00215 L     @10,@PC00001+4                                      0217 00120000
         CLI   CRPRETRN(@10),0                                     0217 00121000
         BNE   @RF00217                                            0217 00122000
*       DO;                         /*                               */ 00123000
*         SCPSRCH=ADSCNTBL;         /* PTR TO FIRST DSCAN            */ 00124000
         L     @10,SCPPTR                                          0219 00125000
         MVC   SCPSRCH(4,@10),ADSCNTBL                             0219 00126000
*         CALL HMASMSCN(HMASMSCP);  /*                               */ 00127000
         ST    @10,@AL00001                                        0220 00128000
         L     @15,@CV01452                                        0220 00129000
         LA    @01,@AL00001                                        0220 00130000
         BALR  @14,@15                                             0220 00131000
*         RFY                                                      0221 00132000
*           RTNCODE RSTD;           /*                               */ 00133000
*         IF UCLFLUSH=OFF           /* IF NOT IN FLUSH MODE          */ 00134000
*             &ENDUCL=OFF           /* AND NOT ENDUCL CARD           */ 00135000
*           THEN                    /*                               */ 00136000
         L     @14,@PC00001                                        0222 00137000
         TM    UCLFLUSH(@14),B'00000010'                           0222 00138000
         BNZ   @RF00222                                            0222 00139000
         TM    ENDUCL,B'10000000'                                  0222 00140000
         BNZ   @RF00222                                            0222 00141000
*           DO;                     /*                               */ 00142000
*             CALL UC3ERRCK;        /*                               */ 00143000
         BAL   @14,UC3ERRCK                                        0224 00144000
*             TMPRTNCD=MAX(TMPRTNCD,RTNCODE);/*                      */ 00145000
         SLR   @14,@14                                             0225 00146000
         IC    @14,TMPRTNCD                                        0225 00147000
         CR    @14,RTNCODE                                         0225 00148000
         BNL   *+6                                                      00149000
         LR    @14,RTNCODE                                         0225 00150000
         STC   @14,TMPRTNCD                                        0225 00151000
*             IF RTNCODE<STOPPTF    /*                               */ 00152000
*               THEN                /*                               */ 00153000
         CH    RTNCODE,@CH00059                                    0226 00154000
         BNL   @RF00226                                            0226 00155000
*               DO;                 /*                               */ 00156000
*                 CALL UC3STOW;     /*                               */ 00157000
         BAL   @14,UC3STOW                                         0228 00158000
*                 TMPRTNCD=MAX(TMPRTNCD,RTNCODE);/*                  */ 00159000
         SLR   @14,@14                                             0229 00160000
         IC    @14,TMPRTNCD                                        0229 00161000
         CR    @14,RTNCODE                                         0229 00162000
         BNL   *+6                                                      00163000
         LR    @14,RTNCODE                                         0229 00164000
         STC   @14,TMPRTNCD                                        0229 00165000
*               END;                /*                               */ 00166000
*                                                                  0230 00167000
*             /*******************************************************/ 00168000
*             /*                                                     */ 00169000
*             /* NOW ISSUE ERROR OR SUCCESS MESSAGE                  */ 00170000
*             /*                                                     */ 00171000
*             /*******************************************************/ 00172000
*                                                                  0231 00173000
*             MGPCLEAR=''B;         /*                               */ 00174000
@RF00226 XC    MGPCLEAR(6),MGPCLEAR                                0231 00175000
*             IF TMPRTNCD<STOPPTF   /*                               */ 00176000
*               THEN                /*                               */ 00177000
         CLI   TMPRTNCD,8                                          0232 00178000
         BNL   @RF00232                                            0232 00179000
*               DO;                 /*                               */ 00180000
*                 MGPMGNO1=HMA255I; /* UPDATE COMPLETE               */ 00181000
         MVC   MGPMGNO1(2),@CH00809                                0234 00182000
*                 MGPMGNO2=PART018; /* FOR XXXXXXXX                  */ 00183000
         MVC   MGPMGNO2(2),@CH00553                                0235 00184000
*                 MGPVARPT(1)=ADDR(IOPNAME);/*                       */ 00185000
         LA    @14,IOPNAME(,IOPPTR)                                0236 00186000
         ST    @14,MGPVARPT                                        0236 00187000
*                 MGPTYPE=MGPINFO;  /*                               */ 00188000
         MVI   MGPTYPE,X'01'                                       0237 00189000
*               END;                /*                               */ 00190000
*             ELSE                  /*                               */ 00191000
*               DO;                 /*                               */ 00192000
         B     @RC00232                                            0239 00193000
@RF00232 DS    0H                                                  0240 00194000
*                 MGPMGNO1=HMA256I; /* UPDATE PROCESSING TERMINATED -   00195000
*                                      UPDATE NOT COMPLETE           */ 00196000
         MVC   MGPMGNO1(2),@CH01115                                0240 00197000
*                 MGPTYPE=MGPERR;   /*                               */ 00198000
         MVI   MGPTYPE,X'03'                                       0241 00199000
*               END;                /*                               */ 00200000
*             CALL HMASMMSG(HMASMMGP);/*                             */ 00201000
@RC00232 L     @15,@CV01451                                        0243 00202000
         LA    @01,@AL00243                                        0243 00203000
         BALR  @14,@15                                             0243 00204000
*           END;                    /*                               */ 00205000
*         RFY                                                      0245 00206000
*           RTNCODE UNRSTD;         /*                               */ 00207000
*                                                                  0245 00208000
@RF00222 DS    0H                                                  0246 00209000
*         /***********************************************************/ 00210000
*         /*                                                         */ 00211000
*         /* WRITE BLANK LINE TO SEPERATE UCLIN STATEMENTS           */ 00212000
*         /*                                                         */ 00213000
*         /***********************************************************/ 00214000
*                                                                  0246 00215000
*         PRLFLGS=ZERO;             /*                               */ 00216000
         L     @10,IOPBUFAD(,IOPPTR)                               0246 00217000
         MVI   PRLFLGS(@10),X'00'                                  0246 00218000
*         PRLBLANK=ON;              /*                               */ 00219000
         OI    PRLBLANK(@10),B'00100000'                           0247 00220000
*         IOPDSID=IOPPRINT;         /*                               */ 00221000
         MVI   IOPDSID(IOPPTR),X'0B'                               0248 00222000
*         IOPFUNCT=IOPWRITE;        /*                               */ 00223000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0249 00224000
*         CALL HMASMIO(HMASMIOP);   /*                               */ 00225000
         ST    IOPPTR,@AL00001                                     0250 00226000
         L     @15,@CV01450                                        0250 00227000
         LA    @01,@AL00001                                        0250 00228000
         BALR  @14,@15                                             0250 00229000
*         IF IOPRETRN=IOPGOOD       /*                               */ 00230000
*           THEN                    /*                               */ 00231000
         CLI   IOPRETRN(IOPPTR),0                                  0251 00232000
         BNE   @RF00251                                            0251 00233000
*           CALL HMASMIO(HMASMIOP); /*                               */ 00234000
         ST    IOPPTR,@AL00001                                     0252 00235000
         L     @15,@CV01450                                        0252 00236000
         LA    @01,@AL00001                                        0252 00237000
         BALR  @14,@15                                             0252 00238000
*         TMPRTNCD=MAX(TMPRTNCD,IOPRETRN);/*                         */ 00239000
@RF00251 SLR   @10,@10                                             0253 00240000
         IC    @10,TMPRTNCD                                        0253 00241000
         SLR   @08,@08                                             0253 00242000
         IC    @08,IOPRETRN(,IOPPTR)                               0253 00243000
         CR    @10,@08                                             0253 00244000
         BNL   *+6                                                      00245000
         LR    @10,@08                                             0253 00246000
         STC   @10,TMPRTNCD                                        0253 00247000
*       END;                        /*                               */ 00248000
*     UC3RTNCD=MAX(UC3RTNCD,TMPRTNCD);/*                             */ 00249000
@RF00217 SLR   @10,@10                                             0255 00250000
         IC    @10,UC3RTNCD                                        0255 00251000
         SLR   @08,@08                                             0255 00252000
         IC    @08,TMPRTNCD                                        0255 00253000
         CR    @10,@08                                             0255 00254000
         BNL   *+6                                                      00255000
         LR    @10,@08                                             0255 00256000
         STC   @10,UC3RTNCD                                        0255 00257000
*   END;                            /*                               */ 00258000
@DE00205 CLI   UC3RTNCD,16                                         0256 00259000
         BNL   @DC00205                                            0256 00260000
         TM    ENDUCL,B'10000000'                                  0256 00261000
         BNZ   @DC00205                                            0256 00262000
         L     @10,@PC00001+4                                      0256 00263000
         TM    CRPEOFEN(@10),B'10000000'                           0256 00264000
         BZ    @DL00205                                            0256 00265000
@DC00205 DS    0H                                                  0257 00266000
*   RETURN CODE(UC3RTNCD);          /*                               */ 00267000
         SLR   @15,@15                                             0257 00268000
         IC    @15,UC3RTNCD                                        0257 00269000
         L     @13,4(,@13)                                         0257 00270000
         L     @14,12(,@13)                                        0257 00271000
         LM    @00,@12,20(@13)                                     0257 00272000
         BR    @14                                                 0257 00273000
         EJECT                                                          00274000
*                                                                  0258 00275000
*   /*****************************************************************/ 00276000
*   /*                                                               */ 00277000
*   /* ROUTS CALLED WHEN UCL FUNCTION TYPE HIT                       */ 00278000
*   /*                                                               */ 00279000
*   /*****************************************************************/ 00280000
*                                                                  0258 00281000
*RXXXFNC:                           /*                               */ 00282000
*   PROCEDURE;                      /*                               */ 00283000
RXXXFNC  STM   @14,@12,12(@13)                                     0258 00284000
*RENDUCL:                           /*                               */ 00285000
*   ENTRY;                          /*                               */ 00286000
         B     @EC00259                                            0259 00287000
RENDUCL  STM   @14,@12,12(@13)                                     0259 00288000
@EC00259 DS    0H                                                  0260 00289000
*   ENDUCL=ON;                      /* ENDUCL FOUND                  */ 00290000
         OI    ENDUCL,B'10000000'                                  0260 00291000
*   RETURN;                         /*                               */ 00292000
@EL00002 DS    0H                                                  0261 00293000
@EF00002 DS    0H                                                  0261 00294000
@ER00002 LM    @14,@12,12(@13)                                     0261 00295000
         BR    @14                                                 0261 00296000
*RREP00:                            /*                               */ 00297000
*   ENTRY;                          /*                               */ 00298000
RREP00   STM   @14,@12,12(@13)                                     0262 00299000
*   REP=ON;                         /*                               */ 00300000
         OI    REP,B'10000000'                                     0263 00301000
*   RETURN;                         /*                               */ 00302000
         B     @EL00002                                            0264 00303000
*RDEL00:                            /*                               */ 00304000
*   ENTRY;                          /*                               */ 00305000
RDEL00   STM   @14,@12,12(@13)                                     0265 00306000
*   DEL=ON;                         /*                               */ 00307000
         OI    DEL,B'00100000'                                     0266 00308000
*   RETURN;                         /*                               */ 00309000
         B     @EL00002                                            0267 00310000
*RADD00:                            /*                               */ 00311000
*   ENTRY;                          /*                               */ 00312000
RADD00   STM   @14,@12,12(@13)                                     0268 00313000
*   ADD=ON;                         /*                               */ 00314000
         OI    ADD,B'01000000'                                     0269 00315000
*   RETURN;                         /*                               */ 00316000
*                                                                  0270 00317000
         B     @EL00002                                            0270 00318000
*   /*****************************************************************/ 00319000
*   /*                                                               */ 00320000
*   /* ROUT TO HANDLE TOTAL DELETE OF ENTRY                          */ 00321000
*   /*                                                               */ 00322000
*   /*****************************************************************/ 00323000
*                                                                  0271 00324000
*RXXXTD:                            /*                               */ 00325000
*   ENTRY;                          /*                               */ 00326000
RXXXTD   STM   @14,@12,12(@13)                                     0271 00327000
*   IF DEL=ON&UCLFLUSH=OFF          /*                               */ 00328000
*     THEN                          /*                               */ 00329000
         TM    DEL,B'00100000'                                     0272 00330000
         BNO   @RF00272                                            0272 00331000
         L     @10,@PC00001                                        0272 00332000
         TM    UCLFLUSH(@10),B'00000010'                           0272 00333000
         BNZ   @RF00272                                            0272 00334000
*     TOTALDEL=ON;                  /*                               */ 00335000
         OI    TOTALDEL,B'00001000'                                0273 00336000
*   RETURN;                         /*                               */ 00337000
*                                                                  0274 00338000
         B     @EL00002                                            0274 00339000
*   /*****************************************************************/ 00340000
*   /*                                                               */ 00341000
*   /* ROUT ENTERED WHEN DATA FOUND AFTER PERIOD                     */ 00342000
*   /*                                                               */ 00343000
*   /*****************************************************************/ 00344000
*                                                                  0275 00345000
*RXTRADTA:                          /*                               */ 00346000
*   ENTRY;                          /*                               */ 00347000
RXTRADTA STM   @14,@12,12(@13)                                     0275 00348000
*   SCPRETRN=SCPSTOP;               /* SYNTAX ERROR                  */ 00349000
         L     @10,SCPPTR                                          0276 00350000
         MVI   SCPRETRN(@10),X'08'                                 0276 00351000
*   RETURN;                         /*                               */ 00352000
         B     @EL00002                                            0277 00353000
*   END RXXXFNC;                    /*                               */ 00354000
         B     @EL00002                                            0278 00355000
         EJECT                                                          00356000
*                                                                  0279 00357000
*   /*****************************************************************/ 00358000
*   /*                                                               */ 00359000
*   /* ROUTS CALLED WHEN ENTRY TYPE FOUND                            */ 00360000
*   /*                                                               */ 00361000
*   /*****************************************************************/ 00362000
*                                                                  0279 00363000
*RXXX00:                            /*                               */ 00364000
*   PROCEDURE;                      /*                               */ 00365000
RXXX00   STM   @14,@12,@SA00003                                    0279 00366000
*   RFY                                                            0280 00367000
*     HMASMIOP BASED(IOPPTR);       /*                               */ 00368000
*RSMD00:                            /*                               */ 00369000
*   ENTRY;                          /*                               */ 00370000
         B     @EC00281                                            0281 00371000
RSMD00   STM   @14,@12,@SA00003                                    0281 00372000
@EC00281 DS    0H                                                  0282 00373000
*   IOPTYPE=IOPCSR;                 /*                               */ 00374000
         MVI   IOPTYPE(IOPPTR),X'0F'                               0282 00375000
*   IOPQSMNT=''B;                   /* INIT ENTRY                    */ 00376000
         XC    IOPQSMNT(2,IOPPTR),IOPQSMNT(IOPPTR)                 0283 00377000
*   RETURN;                         /*                               */ 00378000
@EL00003 DS    0H                                                  0284 00379000
@EF00003 DS    0H                                                  0284 00380000
@ER00003 LM    @14,@12,@SA00003                                    0284 00381000
         BR    @14                                                 0284 00382000
*RFMD00:                            /*                               */ 00383000
*   ENTRY;                          /*                               */ 00384000
RFMD00   STM   @14,@12,@SA00003                                    0285 00385000
*   IOPTYPE=IOPFMD;                 /*                               */ 00386000
         MVI   IOPTYPE(IOPPTR),X'0E'                               0286 00387000
*   IOPQFMNT=''B;                   /* INIT ENTRY                    */ 00388000
         XC    IOPQFMNT(2,IOPPTR),IOPQFMNT(IOPPTR)                 0287 00389000
*   IOPQFMND(1)=IOPEOLST;           /* INIT END OF ENTRY             */ 00390000
         MVI   IOPQFMND(IOPPTR),X'FF'                              0288 00391000
*   RETURN;                         /*                               */ 00392000
*                                                                  0289 00393000
         B     @EL00003                                            0289 00394000
*   /*****************************************************************/ 00395000
*   /*                                                               */ 00396000
*   /* ROUT TO LOCATE ENTRY WHEN NAME FOUND                          */ 00397000
*   /*                                                               */ 00398000
*   /*****************************************************************/ 00399000
*                                                                  0290 00400000
*RXXXNAM:                           /*                               */ 00401000
*   ENTRY;                          /*                               */ 00402000
RXXXNAM  STM   @14,@12,@SA00003                                    0290 00403000
*   IOPNAME=SCPSTRNG(1:SCPPMLN);    /* MOVE NAME TO IOP              */ 00404000
         MVI   IOPNAME+1(IOPPTR),C' '                              0291 00405000
         MVC   IOPNAME+2(6,IOPPTR),IOPNAME+1(IOPPTR)               0291 00406000
         L     @10,SCPPTR                                          0291 00407000
         LH    @08,SCPPMLN(,@10)                                   0291 00408000
         BCTR  @08,0                                               0291 00409000
         L     @10,SCPCHAR(,@10)                                   0291 00410000
         EX    @08,@SM01672                                        0291 00411000
*   IF UCLCRQ=ON                    /*                               */ 00412000
*     THEN                          /*                               */ 00413000
         L     @10,@PC00001                                        0292 00414000
         TM    UCLCRQ(@10),B'00010000'                             0292 00415000
         BNO   @RF00292                                            0292 00416000
*     IOPDSID=IOPCRQ;               /*                               */ 00417000
         MVI   IOPDSID(IOPPTR),X'1C'                               0293 00418000
*   ELSE                            /*                               */ 00419000
*     IOPDSID=IOPACRQ;              /*                               */ 00420000
         B     @RC00292                                            0294 00421000
@RF00292 MVI   IOPDSID(IOPPTR),X'1E'                               0294 00422000
*   IOPFUNCT=IOPLOC;                /* LOCATE ENTRY ON DATASET       */ 00423000
@RC00292 MVI   IOPFUNCT(IOPPTR),X'03'                              0295 00424000
*   CALL HMASMIO(HMASMIOP);         /*                               */ 00425000
*                                                                  0296 00426000
         ST    IOPPTR,@AL00001                                     0296 00427000
         L     @15,@CV01450                                        0296 00428000
         LA    @01,@AL00001                                        0296 00429000
         BALR  @14,@15                                             0296 00430000
*   /*****************************************************************/ 00431000
*   /*                                                               */ 00432000
*   /* CHECK POSSIBLE CONDITIONS FROM LOCATE                         */ 00433000
*   /*                                                               */ 00434000
*   /*****************************************************************/ 00435000
*                                                                  0297 00436000
*   IF IOPRETRN=IOPNTFND            /* IF NOT FOUND                  */ 00437000
*     THEN                          /*                               */ 00438000
         CLI   IOPRETRN(IOPPTR),4                                  0297 00439000
         BNE   @RF00297                                            0297 00440000
*     DO;                           /*                               */ 00441000
*       TOTAL=ON;                   /* IS TOTAL ADD                  */ 00442000
         OI    TOTAL,B'00010000'                                   0299 00443000
*       IF REP=ON                   /* IF REP                        */ 00444000
*         THEN                      /* THEN ISSUE MSG                */ 00445000
         TM    REP,B'10000000'                                     0300 00446000
         BNO   @RF00300                                            0300 00447000
*         DO;                       /*                               */ 00448000
*           MGPCLEAR=''B;           /*                               */ 00449000
         XC    MGPCLEAR(6),MGPCLEAR                                0302 00450000
*           MGPMGNO1=HMA277I;       /* XXXXXXXX XXXXXXXX TO BE     0303 00451000
*                                      REPLACED DOES NOT EXIST - ADD    00452000
*                                      ASSUMED                       */ 00453000
         MVC   MGPMGNO1(2),@CH01460                                0303 00454000
*           MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE ENTRY        */ 00455000
         SLR   @10,@10                                             0304 00456000
         IC    @10,IOPTYPE(,IOPPTR)                                0304 00457000
         SLA   @10,3                                               0304 00458000
         L     @08,CCATPAD(,CCAPTR)                                0304 00459000
         AL    @08,@CF01675                                        0304 00460000
         LA    @10,CCATYPEA(@10,@08)                               0304 00461000
         ST    @10,MGPVARPT                                        0304 00462000
*           MGPVARPT(2)=ADDR(IOPNAME);/* MEMBER NAME                 */ 00463000
         LA    @10,IOPNAME(,IOPPTR)                                0305 00464000
         ST    @10,MGPVARPT+4                                      0305 00465000
*           MGPTYPE=MGPWARN;        /*                               */ 00466000
         MVI   MGPTYPE,X'02'                                       0306 00467000
*           CALL HMASMMSG(HMASMMGP);/*                               */ 00468000
         L     @15,@CV01451                                        0307 00469000
         LA    @01,@AL00307                                        0307 00470000
         BALR  @14,@15                                             0307 00471000
*           WARNSW=ON;              /*                               */ 00472000
         OI    WARNSW,B'00001000'                                  0308 00473000
*         END;                      /*                               */ 00474000
*       ELSE                        /* IF NOT REP                    */ 00475000
*         IF DEL=ON                 /* THEN IF DEL                   */ 00476000
*           THEN                    /* THEN                          */ 00477000
         B     @RC00300                                            0310 00478000
@RF00300 TM    DEL,B'00100000'                                     0310 00479000
         BNO   @RF00310                                            0310 00480000
*           DO;                     /*                               */ 00481000
*             SCPRETRN=SCPNDSCN;    /*                               */ 00482000
         L     @10,SCPPTR                                          0312 00483000
         MVI   SCPRETRN(@10),X'04'                                 0312 00484000
*             MGPCLEAR=''B;         /*                               */ 00485000
         XC    MGPCLEAR(6),MGPCLEAR                                0313 00486000
*             MGPMGNO1=HMA253I;     /* XXXXXXXX ENTRY XXXXXXXX TO BE    00487000
*                                      DELETED DOES NOT EXIST        */ 00488000
         MVC   MGPMGNO1(2),@CH01110                                0314 00489000
*             MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE ENTRY      */ 00490000
         SLR   @10,@10                                             0315 00491000
         IC    @10,IOPTYPE(,IOPPTR)                                0315 00492000
         SLA   @10,3                                               0315 00493000
         L     @08,CCATPAD(,CCAPTR)                                0315 00494000
         AL    @08,@CF01675                                        0315 00495000
         LA    @10,CCATYPEA(@10,@08)                               0315 00496000
         ST    @10,MGPVARPT                                        0315 00497000
*             MGPVARPT(2)=ADDR(IOPNAME);/* MEMBER NAME               */ 00498000
         LA    @10,IOPNAME(,IOPPTR)                                0316 00499000
         ST    @10,MGPVARPT+4                                      0316 00500000
*             MGPTYPE=MGPERR;       /*                               */ 00501000
         MVI   MGPTYPE,X'03'                                       0317 00502000
*             CALL HMASMMSG(HMASMMGP);/*                             */ 00503000
         L     @15,@CV01451                                        0318 00504000
         LA    @01,@AL00318                                        0318 00505000
         BALR  @14,@15                                             0318 00506000
*             ERRSW=ON;             /* INDICATE ERROR FOUND          */ 00507000
         OI    ERRSW,B'00010000'                                   0319 00508000
*           END;                    /*                               */ 00509000
*     END;                          /*                               */ 00510000
*   ELSE                            /*                               */ 00511000
*     IF IOPRETRN>IOPNTFND          /*                               */ 00512000
*       THEN                        /*                               */ 00513000
         B     @RC00297                                            0322 00514000
@RF00297 CLI   IOPRETRN(IOPPTR),4                                  0322 00515000
         BNH   @RF00322                                            0322 00516000
*       DO;                         /*                               */ 00517000
*         SCPRETRN=IOPRETRN;        /*                               */ 00518000
         L     @10,SCPPTR                                          0324 00519000
         MVC   SCPRETRN(1,@10),IOPRETRN(IOPPTR)                    0324 00520000
*         MGPCLEAR=''B;             /*                               */ 00521000
         XC    MGPCLEAR(6),MGPCLEAR                                0325 00522000
*         MGPMGNO1=HMA256I;         /* UPDATE PROCESSING TERMINATED -   00523000
*                                      UPDATE NOT COMPLETE           */ 00524000
         MVC   MGPMGNO1(2),@CH01115                                0326 00525000
*         MGPTYPE=MGPERR;           /*                               */ 00526000
         MVI   MGPTYPE,X'03'                                       0327 00527000
*         CALL HMASMMSG(HMASMMGP);  /*                               */ 00528000
         L     @15,@CV01451                                        0328 00529000
         LA    @01,@AL00328                                        0328 00530000
         BALR  @14,@15                                             0328 00531000
*       END;                        /*                               */ 00532000
*   RETURN;                         /*                               */ 00533000
         B     @EL00003                                            0330 00534000
*   END RXXX00;                     /*                               */ 00535000
         B     @EL00003                                            0331 00536000
         EJECT                                                          00537000
*                                                                  0332 00538000
*   /*****************************************************************/ 00539000
*   /*                                                               */ 00540000
*   /* ROUTS TO HANDLE KEYWORD FOR SYSMOD TYPE ENTRIES               */ 00541000
*   /*                                                               */ 00542000
*   /*****************************************************************/ 00543000
*                                                                  0332 00544000
*RSMDXXX:                           /*                               */ 00545000
*   PROCEDURE;                      /*                               */ 00546000
RSMDXXX  STM   @14,@12,@SA00004                                    0332 00547000
*   RFY                                                            0333 00548000
*     HMASMIOP BASED(IOPPTR2);      /* IOP FOR SMD ENTRY             */ 00549000
*                                                                  0333 00550000
*   /*****************************************************************/ 00551000
*   /*                                                               */ 00552000
*   /* ROUT CALLED WHEN CLOSING PAREN AFTER SYSMOD NAME IS FOUND.    */ 00553000
*   /* THIS ROUTINE BUILDS A GTA FILE CONTAINING THE FMID/REQ PAIRS  */ 00554000
*   /* IN THE EXISTING SYSMOD ENTRY                                  */ 00555000
*   /*                                                               */ 00556000
*   /*****************************************************************/ 00557000
*                                                                  0334 00558000
*RSMDRP01:                          /*                               */ 00559000
*   ENTRY;                          /*                               */ 00560000
         B     @EC00334                                            0334 00561000
RSMDRP01 STM   @14,@12,@SA00004                                    0334 00562000
@EC00334 DS    0H                                                  0335 00563000
*   HMASMIOP=IOPPTR->HMASMIOP;      /* MOVE IOP WITH SMD ENTRY       */ 00564000
         L     @10,IOPPTR2                                         0335 00565000
         MVC   HMASMIOP(68,@10),HMASMIOP(IOPPTR)                   0335 00566000
*   IOPCQMAX=IOPPTR->IOPCQMAX;      /* TO SMD IOP                    */ 00567000
         MVC   IOPCQMAX(2,@10),IOPCQMAX(IOPPTR)                    0336 00568000
*   HMASMGTP=''B;                   /* SET UP GTP FOR FMID/REQ PAIRS */ 00569000
         XC    HMASMGTP(28),HMASMGTP                               0337 00570000
*   GTPRCDLN=LENGTH(SMDRCD);        /*                               */ 00571000
         MVC   GTPRCDLN(2),@CH00580                                0338 00572000
*   GTPKEYLN=LENGTH(SMDKEY);        /* KEY LENGTH                    */ 00573000
         MVC   GTPKEYLN(2),@CH00196                                0339 00574000
*   GTPBUFAD=ADDR(SMDRCD);          /*                               */ 00575000
         LA    @08,SMDRCD                                          0340 00576000
         ST    @08,GTPBUFAD                                        0340 00577000
*   GTPPSIZE=GTP1K;                 /*                               */ 00578000
         NI    GTPPSIZE,B'11111010'                                0341 00579000
         OI    GTPPSIZE,B'00000010'                                0341 00580000
*   SMDKEY='';                      /* INIT RCD TO BLANK             */ 00581000
         MVI   SMDKEY,C' '                                         0342 00582000
         MVC   SMDKEY+1(31),SMDKEY                                 0342 00583000
*   IF TOTAL=OFF                    /* IF NOT TOTAL ADD/REP          */ 00584000
*     THEN                          /*                               */ 00585000
         TM    TOTAL,B'00010000'                                   0343 00586000
         BNZ   @RF00343                                            0343 00587000
*     DO;                           /*                               */ 00588000
*       GTPFUNCT=GTPADD;            /* SET TO ADD RCD TO FILE        */ 00589000
         MVI   GTPFUNCT,X'04'                                      0345 00590000
*       IOPFUNCT=IOPPOSI;           /* POSITION TO READ DATA RCDS    */ 00591000
         MVI   IOPFUNCT(@10),X'02'                                 0346 00592000
*       CALL HMASMIO(HMASMIOP);     /*                               */ 00593000
         ST    @10,@AL00001                                        0347 00594000
         L     @15,@CV01450                                        0347 00595000
         LA    @01,@AL00001                                        0347 00596000
         BALR  @14,@15                                             0347 00597000
*       IOPFUNCT=IOPREAD;           /*                               */ 00598000
         L     @10,IOPPTR2                                         0348 00599000
         MVI   IOPFUNCT(@10),X'01'                                 0348 00600000
*       DO WHILE(                   /* LOOP                          */ 00601000
*             IOPRETRN=IOPGOOD      /* TILL READ ERR OR EOF          */ 00602000
*             &GTPRETRN=GTPGOOD);   /* AND NO GTP ERROR              */ 00603000
         B     @DE00349                                            0349 00604000
@DL00349 DS    0H                                                  0350 00605000
*         CALL HMASMIO(HMASMIOP);   /* READ DATA RECORD              */ 00606000
         L     @10,IOPPTR2                                         0350 00607000
         ST    @10,@AL00001                                        0350 00608000
         L     @15,@CV01450                                        0350 00609000
         LA    @01,@AL00001                                        0350 00610000
         BALR  @14,@15                                             0350 00611000
*         IF IOPRETRN=IOPGOOD       /* IF RECORD READ OK             */ 00612000
*           THEN                    /*                               */ 00613000
         L     @10,IOPPTR2                                         0351 00614000
         CLI   IOPRETRN(@10),0                                     0351 00615000
         BNE   @RF00351                                            0351 00616000
*           DO;                     /*                               */ 00617000
*             SMDFMID=IOPQSMFM;     /* MOVE FMID                     */ 00618000
         L     @10,IOPBUFAD(,@10)                                  0353 00619000
         MVC   SMDFMID(7),IOPQSMFM(@10)                            0353 00620000
*             SMDCODE=SMDEXIST;     /* EXISTING FMID/REQ PAIR        */ 00621000
         MVI   SMDCODE,X'00'                                       0354 00622000
*             DO I=1 TO DIM(IOPQSMLS)/* LOOP THRU ALL REQ LIST       */ 00623000
*                   WHILE(          /* LOOP WHILE                    */ 00624000
*                   IOPQSMND(I)^=IOPEOLST/* TILL END OF LIST         */ 00625000
*                   &GTPRETRN=GTPGOOD/* AND GTA ADD OK               */ 00626000
*                   );              /*                               */ 00627000
         LA    @10,1                                               0355 00628000
         ST    @10,I                                               0355 00629000
@DL00355 MH    @10,@CH00538                                        0355 00630000
         L     @08,IOPPTR2                                         0355 00631000
         L     @08,IOPBUFAD(,@08)                                  0355 00632000
         LA    @01,0(@10,@08)                                      0355 00633000
         BCTR  @01,0                                               0355 00634000
         SLR   @00,@00                                             0355 00635000
         IC    @00,IOPQSMND-8(,@01)                                0355 00636000
         CH    @00,@CH00726                                        0355 00637000
         BE    @DC00355                                            0355 00638000
         CLI   GTPRETRN,0                                          0355 00639000
         BNE   @DC00355                                            0355 00640000
*               SMDREQ=IOPQSMNM(I); /* MOVE REQ NUMBER               */ 00641000
         ALR   @08,@10                                             0356 00642000
         BCTR  @08,0                                               0356 00643000
         MVC   SMDREQ(7),IOPQSMNM-8(@08)                           0356 00644000
*               CALL HMASMGTA(HMASMGTP);/* ADD RCD TO FILE           */ 00645000
         L     @15,@CV01453                                        0357 00646000
         LA    @01,@AL00357                                        0357 00647000
         BALR  @14,@15                                             0357 00648000
*             END;                  /* END ONE DATA RCD LOOP         */ 00649000
         LA    @10,1                                               0358 00650000
         AL    @10,I                                               0358 00651000
         ST    @10,I                                               0358 00652000
         CH    @10,@CH00059                                        0358 00653000
         BNH   @DL00355                                            0358 00654000
@DC00355 DS    0H                                                  0359 00655000
*           END;                    /* END DATA RCD READ OK          */ 00656000
*       END;                        /* END READ OF ALL DATA RCDS     */ 00657000
@RF00351 DS    0H                                                  0360 00658000
@DE00349 L     @10,IOPPTR2                                         0360 00659000
         CLI   IOPRETRN(@10),0                                     0360 00660000
         BNE   @DC00349                                            0360 00661000
         CLI   GTPRETRN,0                                          0360 00662000
         BE    @DL00349                                            0360 00663000
@DC00349 DS    0H                                                  0361 00664000
*       IF IOPRETRN=IOPEOF          /* IF END DUE TO EOF             */ 00665000
*         THEN                      /*                               */ 00666000
         L     @10,IOPPTR2                                         0361 00667000
         CLI   IOPRETRN(@10),4                                     0361 00668000
         BNE   @RF00361                                            0361 00669000
*         SCPRETRN=GTPRETRN;        /* RC IS LAST RC FROM GTA        */ 00670000
         L     @10,SCPPTR                                          0362 00671000
         MVC   SCPRETRN(1,@10),GTPRETRN                            0362 00672000
*       ELSE                        /*                               */ 00673000
*         SCPRETRN=MAX(IOPRETRN,GTPRETRN);/* ELSE MAX OF LAST RC FROM   00674000
*                                      IO OR GTA                     */ 00675000
         B     @RC00361                                            0363 00676000
@RF00361 L     @10,IOPPTR2                                         0363 00677000
         SLR   @08,@08                                             0363 00678000
         IC    @08,IOPRETRN(,@10)                                  0363 00679000
         SLR   @10,@10                                             0363 00680000
         IC    @10,GTPRETRN                                        0363 00681000
         CR    @08,@10                                             0363 00682000
         BNL   *+6                                                      00683000
         LR    @08,@10                                             0363 00684000
         L     @10,SCPPTR                                          0363 00685000
         STC   @08,SCPRETRN(,@10)                                  0363 00686000
*     END;                          /* END NOT TOTAL NEW RCD         */ 00687000
*   RETURN;                         /*                               */ 00688000
*                                                                  0365 00689000
@EL00004 DS    0H                                                  0365 00690000
@EF00004 DS    0H                                                  0365 00691000
@ER00004 LM    @14,@12,@SA00004                                    0365 00692000
         BR    @14                                                 0365 00693000
*   /*****************************************************************/ 00694000
*   /*                                                               */ 00695000
*   /* ROUT CALLED WHEN FMID VALUE FOUND                             */ 00696000
*   /*                                                               */ 00697000
*   /*****************************************************************/ 00698000
*                                                                  0366 00699000
*RSMDFMDV:                          /*                               */ 00700000
*   ENTRY;                          /*                               */ 00701000
RSMDFMDV STM   @14,@12,@SA00004                                    0366 00702000
*   FMIDFND=ON;                     /* SET FMID FOUND                */ 00703000
         OI    FMIDFND,B'10000000'                                 0367 00704000
*   SAVEFMID=SCPSTRNG(1:LENGTH(IOPQSMFM));/* SAVE FMID               */ 00705000
         MVI   SAVEFMID+7,C' '                                     0368 00706000
         MVC   SAVEFMID+8(8),SAVEFMID+7                            0368 00707000
         L     @10,SCPPTR                                          0368 00708000
         L     @10,SCPCHAR(,@10)                                   0368 00709000
         MVC   SAVEFMID(7),SCPSTRNG(@10)                           0368 00710000
*   GTPFUNCT=GTPLOC;                /* SEE IF ANY FMID/REQ RECORD    */ 00711000
         MVI   GTPFUNCT,X'03'                                      0369 00712000
*   SMDFMID=SAVEFMID;               /* EXISTS FOR THE FMID TO BE     */ 00713000
         MVC   SMDFMID(7),SAVEFMID                                 0370 00714000
*   GTPKEYLN=LENGTH(SMDFMID);       /* REPLACED                      */ 00715000
         MVC   GTPKEYLN(2),@CH00088                                0371 00716000
*   CALL HMASMGTA(HMASMGTP);        /*                               */ 00717000
         L     @15,@CV01453                                        0372 00718000
         LA    @01,@AL00372                                        0372 00719000
         BALR  @14,@15                                             0372 00720000
*   IF GTPRETRN=GTPNTFND            /* IF NONE FOUND                 */ 00721000
*     THEN                          /*                               */ 00722000
         CLI   GTPRETRN,4                                          0373 00723000
         BNE   @RF00373                                            0373 00724000
*     DO;                           /*                               */ 00725000
*       IF REP=ON&TOTAL=OFF         /* IF REP EXISTING RCD           */ 00726000
*         THEN                      /*                               */ 00727000
         TM    REP,B'10000000'                                     0375 00728000
         BNO   @RF00375                                            0375 00729000
         TM    TOTAL,B'00010000'                                   0375 00730000
         BNZ   @RF00375                                            0375 00731000
*         DO;                       /*                               */ 00732000
*           MGPCLEAR=''B;           /* ZERO MSG PARM                 */ 00733000
         XC    MGPCLEAR(6),MGPCLEAR                                0377 00734000
*           MGPMGNO1=HMA358I;       /* XXXXXXXX XXXXXXXX TO BE     0378 00735000
*                                      REPLACED IN ENTRY DOES NOT  0378 00736000
*                                      EXIST - ADD ASSUMED           */ 00737000
         MVC   MGPMGNO1(2),@CH01466                                0378 00738000
*           MGPVARPT(1)=ADDR(TXTFMID);/*                             */ 00739000
         LA    @10,@CC01478                                        0379 00740000
         ST    @10,MGPVARPT                                        0379 00741000
*           MGPVARPT(2)=ADDR(SAVEFMID);/*                            */ 00742000
         LA    @10,SAVEFMID                                        0380 00743000
         ST    @10,MGPVARPT+4                                      0380 00744000
*           MGPTYPE=MGPWARN;        /*                               */ 00745000
         MVI   MGPTYPE,X'02'                                       0381 00746000
*           CALL HMASMMSG(HMASMMGP);/*                               */ 00747000
         L     @15,@CV01451                                        0382 00748000
         LA    @01,@AL00382                                        0382 00749000
         BALR  @14,@15                                             0382 00750000
*           WARNSW=ON;              /*                               */ 00751000
         OI    WARNSW,B'00001000'                                  0383 00752000
*         END;                      /*                               */ 00753000
*       IF DEL=ON                   /* IF DELETE                     */ 00754000
*         THEN                      /*                               */ 00755000
@RF00375 TM    DEL,B'00100000'                                     0385 00756000
         BNO   @RF00385                                            0385 00757000
*         DO;                       /*                               */ 00758000
*           MGPCLEAR=''B;           /* ZERO MSG PARM                 */ 00759000
         XC    MGPCLEAR(6),MGPCLEAR                                0387 00760000
*           MGPMGNO1=HMA357I;       /* XXXXXXXX XXXXXXXX TO BE     0388 00761000
*                                      DELETED FROM ENTRY DOES NOT 0388 00762000
*                                      EXIST                         */ 00763000
         MVC   MGPMGNO1(2),@CH01464                                0388 00764000
*           MGPVARPT(1)=ADDR(TXTFMID);/*                             */ 00765000
         LA    @10,@CC01478                                        0389 00766000
         ST    @10,MGPVARPT                                        0389 00767000
*           MGPVARPT(2)=ADDR(SAVEFMID);/*                            */ 00768000
         LA    @10,SAVEFMID                                        0390 00769000
         ST    @10,MGPVARPT+4                                      0390 00770000
*           MGPTYPE=MGPERR;         /*                               */ 00771000
         MVI   MGPTYPE,X'03'                                       0391 00772000
*           CALL HMASMMSG(HMASMMGP);/*                               */ 00773000
         L     @15,@CV01451                                        0392 00774000
         LA    @01,@AL00392                                        0392 00775000
         BALR  @14,@15                                             0392 00776000
*           SCPRETRN=SCPNDSCN;      /*                               */ 00777000
         L     @10,SCPPTR                                          0393 00778000
         MVI   SCPRETRN(@10),X'04'                                 0393 00779000
*           ERRSW=ON;               /* ERROR FOUND                   */ 00780000
         OI    ERRSW,B'00010000'                                   0394 00781000
*         END;                      /*                               */ 00782000
*     END;                          /*                               */ 00783000
@RF00385 DS    0H                                                  0397 00784000
*   GTPKEYLN=LENGTH(SMDKEY);        /* RESET KEY LENGTH              */ 00785000
@RF00373 MVC   GTPKEYLN(2),@CH00196                                0397 00786000
*   RETURN;                         /*                               */ 00787000
         B     @EL00004                                            0398 00788000
*                                                                  0399 00789000
*   /*****************************************************************/ 00790000
*   /*                                                               */ 00791000
*   /* ROUT CALLED WHEN THE REQ KEYWORD IS FOUND AFTER FMID.         */ 00792000
*   /*                                                               */ 00793000
*   /*****************************************************************/ 00794000
*                                                                  0399 00795000
*RSMDREQ:                           /*                               */ 00796000
*   ENTRY;                          /*                               */ 00797000
RSMDREQ  STM   @14,@12,@SA00004                                    0399 00798000
*   REQFND=ON;                      /* REQ KEYWORD FOUND             */ 00799000
         OI    REQFND,B'01000000'                                  0400 00800000
*   RETURN;                         /* END LOGIC TO BUILF GTA FILE   */ 00801000
*                                                                  0401 00802000
         B     @EL00004                                            0401 00803000
*   /*****************************************************************/ 00804000
*   /*                                                               */ 00805000
*   /* ROUT CALLED IF DELETE OF ALL REQS FOR AN FMID                 */ 00806000
*   /*                                                               */ 00807000
*   /*****************************************************************/ 00808000
*                                                                  0402 00809000
*RSMDREQD:                          /*                               */ 00810000
*   ENTRY;                          /*                               */ 00811000
RSMDREQD STM   @14,@12,@SA00004                                    0402 00812000
*   GTPFUNCT=GTPOPENN;              /*                               */ 00813000
         MVI   GTPFUNCT,X'01'                                      0403 00814000
*   CALL HMASMGTA(HMASMGTP);        /*                               */ 00815000
         L     @15,@CV01453                                        0404 00816000
         LA    @01,@AL00404                                        0404 00817000
         BALR  @14,@15                                             0404 00818000
*   DO WHILE(                       /* READ THRU GTA FILE            */ 00819000
*         GTPRETRN=GTPGOOD);        /* TILL NO ERROS                 */ 00820000
         B     @DE00405                                            0405 00821000
@DL00405 DS    0H                                                  0406 00822000
*     GTPFUNCT=GTPGETN;             /*                               */ 00823000
         MVI   GTPFUNCT,X'08'                                      0406 00824000
*     CALL HMASMGTA(HMASMGTP);      /* GET NEXT RCD FROM FILE        */ 00825000
         L     @15,@CV01453                                        0407 00826000
         LA    @01,@AL00407                                        0407 00827000
         BALR  @14,@15                                             0407 00828000
*     IF GTPRETRN=GTPGOOD           /* IF RCD READ                   */ 00829000
*         &SMDFMID=SAVEFMID(1:LENGTH(SMDFMID))/* AND SYSMOD EQUAL    */ 00830000
*       THEN                        /*                               */ 00831000
         CLI   GTPRETRN,0                                          0408 00832000
         BNE   @RF00408                                            0408 00833000
         CLC   SMDFMID(7),SAVEFMID                                 0408 00834000
         BNE   @RF00408                                            0408 00835000
*       DO;                         /*                               */ 00836000
*         SMDCODE=SMDDEL;           /* MARK RCD DELETED              */ 00837000
         MVI   SMDCODE,X'02'                                       0410 00838000
*         GTPFUNCT=GTPADD;          /*                               */ 00839000
         MVI   GTPFUNCT,X'04'                                      0411 00840000
*         CALL HMASMGTA(HMASMGTP);  /*                               */ 00841000
         L     @15,@CV01453                                        0412 00842000
         LA    @01,@AL00412                                        0412 00843000
         BALR  @14,@15                                             0412 00844000
*       END;                        /*                               */ 00845000
*   END;                            /*                               */ 00846000
@RF00408 DS    0H                                                  0414 00847000
@DE00405 CLI   GTPRETRN,0                                          0414 00848000
         BE    @DL00405                                            0414 00849000
*   RETURN;                         /*                               */ 00850000
         B     @EL00004                                            0415 00851000
*                                                                  0416 00852000
*   /*****************************************************************/ 00853000
*   /*                                                               */ 00854000
*   /* ROUT ENTERED WHEN REQ KEYWORD VALUE FOUND                     */ 00855000
*   /*                                                               */ 00856000
*   /*****************************************************************/ 00857000
*                                                                  0416 00858000
*RSMDREQV:                          /*                               */ 00859000
*   ENTRY;                          /*                               */ 00860000
RSMDREQV STM   @14,@12,@SA00004                                    0416 00861000
*   IF FRSTREPL=ON                  /* IF FIRST VALUE FOR REP        */ 00862000
*     THEN                          /*                               */ 00863000
         TM    FRSTREPL,B'00000010'                                0417 00864000
         BNO   @RF00417                                            0417 00865000
*     DO;                           /*                               */ 00866000
*       FRSTREPL=OFF;               /*                               */ 00867000
         NI    FRSTREPL,B'11111101'                                0419 00868000
*       GTPFUNCT=GTPOPENN;          /*                               */ 00869000
         MVI   GTPFUNCT,X'01'                                      0420 00870000
*       CALL HMASMGTA(HMASMGTP);    /*                               */ 00871000
         L     @15,@CV01453                                        0421 00872000
         LA    @01,@AL00421                                        0421 00873000
         BALR  @14,@15                                             0421 00874000
*       DO WHILE GTPRETRN=GTPGOOD;  /* MARK ALL EXISTING RCDS AS DEL */ 00875000
         B     @DE00422                                            0422 00876000
@DL00422 DS    0H                                                  0423 00877000
*         GTPFUNCT=GTPGETN;         /*                               */ 00878000
         MVI   GTPFUNCT,X'08'                                      0423 00879000
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT RCD                  */ 00880000
         L     @15,@CV01453                                        0424 00881000
         LA    @01,@AL00424                                        0424 00882000
         BALR  @14,@15                                             0424 00883000
*         IF SMDFMID=SAVEFMID(1:LENGTH(SMDFMID))/* IF FMID TO REP    */ 00884000
*             &GTPRETRN=GTPGOOD     /* AND NOT EOF                   */ 00885000
*           THEN                    /*                               */ 00886000
         CLC   SMDFMID(7),SAVEFMID                                 0425 00887000
         BNE   @RF00425                                            0425 00888000
         CLI   GTPRETRN,0                                          0425 00889000
         BNE   @RF00425                                            0425 00890000
*           DO;                     /*                               */ 00891000
*             SMDCODE=SMDDEL;       /* MARK AS DELETED               */ 00892000
         MVI   SMDCODE,X'02'                                       0427 00893000
*             GTPFUNCT=GTPADD;      /*                               */ 00894000
         MVI   GTPFUNCT,X'04'                                      0428 00895000
*             CALL HMASMGTA(HMASMGTP);/*                             */ 00896000
         L     @15,@CV01453                                        0429 00897000
         LA    @01,@AL00429                                        0429 00898000
         BALR  @14,@15                                             0429 00899000
*           END;                    /*                               */ 00900000
*       END;                        /*                               */ 00901000
@RF00425 DS    0H                                                  0431 00902000
@DE00422 CLI   GTPRETRN,0                                          0431 00903000
         BE    @DL00422                                            0431 00904000
*     END;                          /*                               */ 00905000
*   SMDFMID=SAVEFMID;               /* SET FMID VALUE IN GTA RCD     */ 00906000
@RF00417 MVC   SMDFMID(7),SAVEFMID                                 0433 00907000
*   SMDREQ=SCPSTRNG(1:LENGTH(SMDREQ));/* MOVE REQ NUMBER             */ 00908000
         L     @10,SCPPTR                                          0434 00909000
         L     @10,SCPCHAR(,@10)                                   0434 00910000
         MVC   SMDREQ(7),SCPSTRNG(@10)                             0434 00911000
*   GTPFUNCT=GTPLOC;                /*                               */ 00912000
         MVI   GTPFUNCT,X'03'                                      0435 00913000
*   CALL HMASMGTA(HMASMGTP);        /* LOCATE RCD                    */ 00914000
         L     @15,@CV01453                                        0436 00915000
         LA    @01,@AL00436                                        0436 00916000
         BALR  @14,@15                                             0436 00917000
*   IF GTPRETRN=GTPGOOD             /* IF FOUND                      */ 00918000
*     THEN                          /*                               */ 00919000
         CLI   GTPRETRN,0                                          0437 00920000
         BNE   @RF00437                                            0437 00921000
*     DO;                           /*                               */ 00922000
*       IF ADD=ON                   /*                               */ 00923000
*         THEN                      /*                               */ 00924000
         TM    ADD,B'01000000'                                     0439 00925000
         BNO   @RF00439                                            0439 00926000
*         DO;                       /*                               */ 00927000
*           MGPCLEAR=''B;           /* ZERO MSG PARM                 */ 00928000
         XC    MGPCLEAR(6),MGPCLEAR                                0441 00929000
*           MGPMGNO1=HMA356I;       /* XXXXXXXX XXXXXXXX TO BE ADDED    00930000
*                                      TO ENTRY ALREADY EXISTS       */ 00931000
         MVC   MGPMGNO1(2),@CH01462                                0442 00932000
*           MGPVARPT(1)=ADDR(TXTREQ);/*                              */ 00933000
         LA    @10,@CC01481                                        0443 00934000
         ST    @10,MGPVARPT                                        0443 00935000
*           MGPVARPT(2)=ADDR(SMDREQ);/* REQ NUMBER                   */ 00936000
         LA    @10,SMDREQ                                          0444 00937000
         ST    @10,MGPVARPT+4                                      0444 00938000
*           MGPTYPE=MGPERR;         /*                               */ 00939000
         MVI   MGPTYPE,X'03'                                       0445 00940000
*           CALL HMASMMSG(HMASMMGP);/*                               */ 00941000
         L     @15,@CV01451                                        0446 00942000
         LA    @01,@AL00446                                        0446 00943000
         BALR  @14,@15                                             0446 00944000
*           ERRSW=ON;               /* ERROR FOUND                   */ 00945000
         OI    ERRSW,B'00010000'                                   0447 00946000
*         END;                      /*                               */ 00947000
*       ELSE                        /*                               */ 00948000
*         DO;                       /*                               */ 00949000
         B     @RC00439                                            0449 00950000
@RF00439 DS    0H                                                  0450 00951000
*           IF REP=ON               /* IF REP AND REQ WAS FOUND IN   */ 00952000
*             THEN                  /* GTA FILE THEN IF MARKED DEL   */ 00953000
         TM    REP,B'10000000'                                     0450 00954000
         BNO   @RF00450                                            0450 00955000
*             IF SMDCODE=SMDDEL     /* THEN IT MUST HAVE EXISTED IN  */ 00956000
*               THEN                /* THE ORIGINAL LIST AND HAVE    */ 00957000
         CLI   SMDCODE,2                                           0451 00958000
         BNE   @RF00451                                            0451 00959000
*               SMDCODE=SMDEXIST;   /* BEEN MARKED FOR DELETION IN 0452 00960000
*                                      FIRST REP PROCESSING          */ 00961000
         MVI   SMDCODE,X'00'                                       0452 00962000
*             ELSE                  /* ELSE MUST HAVE ALREADY BEEN   */ 00963000
*               ;                   /* ADDED IN THIS REP SO DO NOT 0453 00964000
*                                      CHANGE TYPE CODE              */ 00965000
@RF00451 DS    0H                                                  0454 00966000
*           ELSE                    /* IF DEL MARK RCD AS            */ 00967000
*             SMDCODE=SMDDEL;       /* DELETED                       */ 00968000
         B     @RC00450                                            0454 00969000
@RF00450 MVI   SMDCODE,X'02'                                       0454 00970000
*           GTPFUNCT=GTPADD;        /*                               */ 00971000
@RC00450 MVI   GTPFUNCT,X'04'                                      0455 00972000
*           CALL HMASMGTA(HMASMGTP);/*                               */ 00973000
         L     @15,@CV01453                                        0456 00974000
         LA    @01,@AL00456                                        0456 00975000
         BALR  @14,@15                                             0456 00976000
*           SCPRETRN=GTPRETRN;      /*                               */ 00977000
         L     @10,SCPPTR                                          0457 00978000
         MVC   SCPRETRN(1,@10),GTPRETRN                            0457 00979000
*         END;                      /*                               */ 00980000
*     END;                          /*                               */ 00981000
*   ELSE                            /*                               */ 00982000
*     DO;                           /*                               */ 00983000
         B     @RC00437                                            0460 00984000
@RF00437 DS    0H                                                  0461 00985000
*       IF ADD=ON|REP=ON            /*                               */ 00986000
*         THEN                      /*                               */ 00987000
         TM    ADD,B'11000000'                                     0461 00988000
         BZ    @RF00461                                            0461 00989000
*         DO;                       /*                               */ 00990000
*           SMDCODE=SMDADD;         /*                               */ 00991000
         MVI   SMDCODE,X'01'                                       0463 00992000
*           GTPFUNCT=GTPADD;        /*                               */ 00993000
         MVI   GTPFUNCT,X'04'                                      0464 00994000
*           CALL HMASMGTA(HMASMGTP);/*                               */ 00995000
         L     @15,@CV01453                                        0465 00996000
         LA    @01,@AL00465                                        0465 00997000
         BALR  @14,@15                                             0465 00998000
*           SCPRETRN=GTPRETRN;      /*                               */ 00999000
         L     @10,SCPPTR                                          0466 01000000
         MVC   SCPRETRN(1,@10),GTPRETRN                            0466 01001000
*         END;                      /*                               */ 01002000
*       ELSE                        /*                               */ 01003000
*         DO;                       /*                               */ 01004000
         B     @RC00461                                            0468 01005000
@RF00461 DS    0H                                                  0469 01006000
*           MGPCLEAR=''B;           /* ZERO MSG PARM                 */ 01007000
         XC    MGPCLEAR(6),MGPCLEAR                                0469 01008000
*           MGPMGNO1=HMA357I;       /* XXXXXXXX XXXXXXXX TO BE     0470 01009000
*                                      DELETED FROM ENTRY DOES NOT 0470 01010000
*                                      EXIST                         */ 01011000
         MVC   MGPMGNO1(2),@CH01464                                0470 01012000
*           MGPVARPT(1)=ADDR(TXTREQ);/*                              */ 01013000
         LA    @10,@CC01481                                        0471 01014000
         ST    @10,MGPVARPT                                        0471 01015000
*           MGPVARPT(2)=ADDR(SMDREQ);/*                              */ 01016000
         LA    @10,SMDREQ                                          0472 01017000
         ST    @10,MGPVARPT+4                                      0472 01018000
*           MGPTYPE=MGPERR;         /*                               */ 01019000
         MVI   MGPTYPE,X'03'                                       0473 01020000
*           CALL HMASMMSG(HMASMMGP);/*                               */ 01021000
         L     @15,@CV01451                                        0474 01022000
         LA    @01,@AL00474                                        0474 01023000
         BALR  @14,@15                                             0474 01024000
*           ERRSW=ON;               /* ERROR FOUND                   */ 01025000
         OI    ERRSW,B'00010000'                                   0475 01026000
*         END;                      /*                               */ 01027000
*     END;                          /*                               */ 01028000
*   RETURN;                         /*                               */ 01029000
         B     @EL00004                                            0478 01030000
*                                                                  0479 01031000
*   /*****************************************************************/ 01032000
*   /*                                                               */ 01033000
*   /* ROUT ENTERED WHEN PERIOD FOUND IN SYSMOD UCLIN STATEMENT      */ 01034000
*   /*                                                               */ 01035000
*   /*****************************************************************/ 01036000
*                                                                  0479 01037000
*RSMDPER:                           /*                               */ 01038000
*   ENTRY;                          /*                               */ 01039000
RSMDPER  STM   @14,@12,@SA00004                                    0479 01040000
*   IF FMIDFND=OFF                  /* IF NO FMID KEYWORD            */ 01041000
*     THEN                          /*                               */ 01042000
         TM    FMIDFND,B'10000000'                                 0480 01043000
         BNZ   @RF00480                                            0480 01044000
*     IF DEL=ON                     /* THEN IF DELETE                */ 01045000
*       THEN                        /*                               */ 01046000
         TM    DEL,B'00100000'                                     0481 01047000
         BNO   @RF00481                                            0481 01048000
*       TOTALDEL=ON;                /* DELETE SYSMOD ENTRY           */ 01049000
         OI    TOTALDEL,B'00001000'                                0482 01050000
*     ELSE                          /* IF ADD/REP                    */ 01051000
*       SCPRETRN=SCPSTOP;           /* SYNTAX ERROR                  */ 01052000
         B     @RC00481                                            0483 01053000
@RF00481 L     @10,SCPPTR                                          0483 01054000
         MVI   SCPRETRN(@10),X'08'                                 0483 01055000
*   RETURN;                         /*                               */ 01056000
         B     @EL00004                                            0484 01057000
*   END RSMDXXX;                    /*                               */ 01058000
         B     @EL00004                                            0485 01059000
         EJECT                                                          01060000
*                                                                  0486 01061000
*   /*****************************************************************/ 01062000
*   /*                                                               */ 01063000
*   /* ROUTS TO HANDLE KEYWORD FOR FMID TYPE ENTRIES                 */ 01064000
*   /*                                                               */ 01065000
*   /*****************************************************************/ 01066000
*                                                                  0486 01067000
*RFMDXXX:                           /*                               */ 01068000
*   PROCEDURE;                      /*                               */ 01069000
RFMDXXX  STM   @14,@12,@SA00005                                    0486 01070000
*RFMDSMDV:                          /*                               */ 01071000
*   ENTRY;                          /*                               */ 01072000
         B     @EC00487                                            0487 01073000
RFMDSMDV STM   @14,@12,@SA00005                                    0487 01074000
@EC00487 DS    0H                                                  0488 01075000
*   RFY                             /*                               */ 01076000
*     HMASMIOP BASED(IOPPTR);       /* IOP WITH FMID ENTRY           */ 01077000
*   HMASMVLP=''B;                   /*                               */ 01078000
         XC    HMASMVLP(52),HMASMVLP                               0489 01079000
*   IF ADD=ON                       /* SET FUNCTION                  */ 01080000
*       |(REP=ON&FRSTREPL=OFF)      /*                               */ 01081000
*     THEN                          /*                               */ 01082000
         TM    ADD,B'01000000'                                     0490 01083000
         BO    @RT00490                                            0490 01084000
         TM    REP,B'10000000'                                     0490 01085000
         BNO   @RF00490                                            0490 01086000
         TM    FRSTREPL,B'00000010'                                0490 01087000
         BNZ   @RF00490                                            0490 01088000
@RT00490 DS    0H                                                  0491 01089000
*     VLPFUNCT=VLPADD;              /*                               */ 01090000
         MVI   VLPFUNCT,X'01'                                      0491 01091000
*   ELSE                            /*                               */ 01092000
*     IF DEL=ON                     /*                               */ 01093000
*       THEN                        /*                               */ 01094000
         B     @RC00490                                            0492 01095000
@RF00490 TM    DEL,B'00100000'                                     0492 01096000
         BNO   @RF00492                                            0492 01097000
*       VLPFUNCT=VLPDEL;            /*                               */ 01098000
         MVI   VLPFUNCT,X'02'                                      0493 01099000
*     ELSE                          /*                               */ 01100000
*       VLPFUNCT=VLPREP;            /*                               */ 01101000
         B     @RC00492                                            0494 01102000
@RF00492 MVI   VLPFUNCT,X'03'                                      0494 01103000
*   FRSTREPL=OFF;                   /*                               */ 01104000
@RC00492 DS    0H                                                  0495 01105000
@RC00490 NI    FRSTREPL,B'11111101'                                0495 01106000
*   IF TOTAL=OFF                    /* IF NOT TOTAL ADD OR REP       */ 01107000
*     THEN                          /*                               */ 01108000
         TM    TOTAL,B'00010000'                                   0496 01109000
         BNZ   @RF00496                                            0496 01110000
*     VLPFMSG=ON;                   /* WRITE MSG IF ERR              */ 01111000
         OI    VLPFMSG,B'10000000'                                 0497 01112000
*   VLPDATA=SCPSTRNG(1:SCPPMLN);    /* DAT TO ADD                    */ 01113000
@RF00496 MVI   VLPDATA+1,C' '                                      0498 01114000
         MVC   VLPDATA+2(6),VLPDATA+1                              0498 01115000
         L     @10,SCPPTR                                          0498 01116000
         LH    @08,SCPPMLN(,@10)                                   0498 01117000
         BCTR  @08,0                                               0498 01118000
         L     @10,SCPCHAR(,@10)                                   0498 01119000
         EX    @08,@SM01678                                        0498 01120000
*   VLPDATA(8)=''B;                 /*                               */ 01121000
         MVI   VLPDATA+7,X'00'                                     0499 01122000
*   VLPTYPE=IOPQFMSM;               /* TYPE CODE                     */ 01123000
         MVI   VLPTYPE,X'01'                                       0500 01124000
*   VLPDLEN=LENGTH(IOPQFMNM);       /* LENGTH OF KEY IN VLPDATA      */ 01125000
         MVI   VLPDLEN,X'07'                                       0501 01126000
*   VLPLPTR=ADDR(IOPQFMLS(1));      /* START OF LIST                 */ 01127000
         LA    @10,IOPQFMLS(,IOPPTR)                               0502 01128000
         ST    @10,VLPLPTR                                         0502 01129000
*   VLPMTYPE=CCATYPEA(IOPFMD);      /* FMID TYPE ENTRY               */ 01130000
         L     @10,CCATPAD(,CCAPTR)                                0503 01131000
         MVC   VLPMTYPE(8),CCATYPEA+104(@10)                       0503 01132000
*   VLPMNAME=IOPNAME;               /* FMID VALUE                    */ 01133000
         MVC   VLPMNAME(8),IOPNAME(IOPPTR)                         0504 01134000
*   VLPSTYPE=TXTSMD;                /* SYSMOD TYPE SUBENTRY          */ 01135000
         MVC   VLPSTYPE(16),@CC01475                               0505 01136000
*   CALL HMASMVLU(HMASMVLP);        /*                               */ 01137000
         L     @15,@CV01454                                        0506 01138000
         LA    @01,@AL00506                                        0506 01139000
         BALR  @14,@15                                             0506 01140000
*   IF VLPRETRN=VLPWARN             /* IF WARNING ISSUED             */ 01141000
*     THEN                          /*                               */ 01142000
         CLI   VLPRETRN,4                                          0507 01143000
         BNE   @RF00507                                            0507 01144000
*     WARNSW=ON;                    /* SET SW                        */ 01145000
         OI    WARNSW,B'00001000'                                  0508 01146000
*   ELSE                            /*                               */ 01147000
*     IF VLPRETRN=VLPERR            /* IF ERR THEN                   */ 01148000
*       THEN                        /*                               */ 01149000
         B     @RC00507                                            0509 01150000
@RF00507 CLI   VLPRETRN,8                                          0509 01151000
         BNE   @RF00509                                            0509 01152000
*       ERRSW=ON;                   /* SET ERR SW                    */ 01153000
         OI    ERRSW,B'00010000'                                   0510 01154000
*   RETURN;                         /*                               */ 01155000
@EL00005 DS    0H                                                  0511 01156000
@EF00005 DS    0H                                                  0511 01157000
@ER00005 LM    @14,@12,@SA00005                                    0511 01158000
         BR    @14                                                 0511 01159000
*                                                                  0512 01160000
*   /*****************************************************************/ 01161000
*   /*                                                               */ 01162000
*   /* ROUT CALLED TO DELETE ALL SYSMOD ENTRIES FROM FMID ENTRY      */ 01163000
*   /*                                                               */ 01164000
*   /*****************************************************************/ 01165000
*                                                                  0512 01166000
*RFMDSMDD:                          /*                               */ 01167000
*   ENTRY;                          /*                               */ 01168000
RFMDSMDD STM   @14,@12,@SA00005                                    0512 01169000
*   IF DEL=ON                       /*                               */ 01170000
*     THEN                          /*                               */ 01171000
         TM    DEL,B'00100000'                                     0513 01172000
         BNO   @RF00513                                            0513 01173000
*     TOTALDEL=ON;                  /*                               */ 01174000
         OI    TOTALDEL,B'00001000'                                0514 01175000
*   ELSE                            /* IF ADD/REP                    */ 01176000
*     SCPRETRN=SCPSTOP;             /* SYNTAX ERROR                  */ 01177000
         B     @RC00513                                            0515 01178000
@RF00513 L     @10,SCPPTR                                          0515 01179000
         MVI   SCPRETRN(@10),X'08'                                 0515 01180000
*   RETURN;                         /*                               */ 01181000
         B     @EL00005                                            0516 01182000
*   END RFMDXXX;                    /*                               */ 01183000
         B     @EL00005                                            0517 01184000
         EJECT                                                          01185000
*                                                                  0518 01186000
*   /*****************************************************************/ 01187000
*   /*                                                               */ 01188000
*   /* ROUT ENTERED WHEN ( BEFORE VARIABLE LIST ENCOUNTERED          */ 01189000
*   /*                                                               */ 01190000
*   /*****************************************************************/ 01191000
*                                                                  0518 01192000
*RESETRPL:                          /*                               */ 01193000
*   PROCEDURE;                      /*                               */ 01194000
RESETRPL STM   @14,@12,12(@13)                                     0518 01195000
*   FRSTREPL=ON;                    /* FIRST TIME FOR KEYWORD        */ 01196000
         OI    FRSTREPL,B'00000010'                                0519 01197000
*   RETURN;                         /*                               */ 01198000
@EL00006 DS    0H                                                  0520 01199000
@EF00006 DS    0H                                                  0520 01200000
@ER00006 LM    @14,@12,12(@13)                                     0520 01201000
         BR    @14                                                 0520 01202000
*   END RESETRPL;                   /*                               */ 01203000
*                                                                  0521 01204000
*   /*****************************************************************/ 01205000
*   /*                                                               */ 01206000
*   /* ROUT ENTERED WHEN SCANNING FOR PERIOD AFTER SYNTAX ERROR      */ 01207000
*   /*                                                               */ 01208000
*   /*****************************************************************/ 01209000
*                                                                  0522 01210000
*RFLSHCHR:                          /*                               */ 01211000
*   PROCEDURE;                      /*                               */ 01212000
RFLSHCHR STM   @14,@12,12(@13)                                     0522 01213000
*   IF SCPPMLN=ZERO                 /* SKIP OVER SPECIAL CHAR        */ 01214000
*     THEN                          /*                               */ 01215000
         L     @10,SCPPTR                                          0523 01216000
         ICM   @08,3,SCPPMLN(@10)                                  0523 01217000
         BNZ   @RF00523                                            0523 01218000
*     SCPPMLN=1;                    /*                               */ 01219000
         MVC   SCPPMLN(2,@10),@CH00039                             0524 01220000
*   RETURN;                         /*                               */ 01221000
@EL00007 DS    0H                                                  0525 01222000
@EF00007 DS    0H                                                  0525 01223000
@ER00007 LM    @14,@12,12(@13)                                     0525 01224000
         BR    @14                                                 0525 01225000
*   END RFLSHCHR;                   /*                               */ 01226000
         B     @EL00007                                            0526 01227000
         EJECT                                                          01228000
*                                                                  0527 01229000
*   /*****************************************************************/ 01230000
*   /*                                                               */ 01231000
*   /* ROUTINE CALLED TO CHECK FOR ANY ERRORS DURING SCAN OF UCLIN   */ 01232000
*   /*                                                               */ 01233000
*   /*****************************************************************/ 01234000
*                                                                  0527 01235000
*UC3ERRCK:                          /*                               */ 01236000
*   PROCEDURE;                      /*                               */ 01237000
UC3ERRCK STM   @14,@12,@SA00008                                    0527 01238000
*   DECLARE                         /*                               */ 01239000
*     ERRRC FIXED(8);               /*                               */ 01240000
*   ERRRC=ZERO;                     /* INIT RC                       */ 01241000
         MVI   ERRRC,X'00'                                         0529 01242000
*   IF SCPRETRN=SCPBAD              /* IF SYNTAX ERROR               */ 01243000
*     THEN                          /*                               */ 01244000
         L     @10,SCPPTR                                          0530 01245000
         CLI   SCPRETRN(@10),4                                     0530 01246000
         BNE   @RF00530                                            0530 01247000
*     DO;                           /*                               */ 01248000
*       MGPCLEAR=''B;               /*                               */ 01249000
         XC    MGPCLEAR(6),MGPCLEAR                                0532 01250000
*       MGPMGNO1=HMA203I;           /* SYNTAX ERROR IN               */ 01251000
         MVC   MGPMGNO1(2),@CH00144                                0533 01252000
*       MGPMGNO2=PART022;           /* UCL STATEMENT                 */ 01253000
         MVC   MGPMGNO2(2),@CH00560                                0534 01254000
*       MGPMGNO3=PART026;           /* AT COL XX                     */ 01255000
         MVC   MGPMGNO3(2),@CH00568                                0535 01256000
*       HEXCOL=SCPCHAR-ADDR(CRPBUFFR);/* CALC COL                    */ 01257000
         L     @08,@PC00001+4                                      0536 01258000
         LA    @08,CRPBUFFR(,@08)                                  0536 01259000
         LCR   @08,@08                                             0536 01260000
         AL    @08,SCPCHAR(,@10)                                   0536 01261000
         ST    @08,HEXCOL                                          0536 01262000
*       HEXCOL=HEXCOL+1;            /*                               */ 01263000
         AH    @08,@CH00039                                        0537 01264000
         ST    @08,HEXCOL                                          0537 01265000
*       CVD(HEXCOL,DECCOL1);        /* CONVERT TO PRINTABLE          */ 01266000
         CVD   @08,DECCOL1                                         0538 01267000
*       UNPK(COLUMN1,DECCOL(7:9));  /*                               */ 01268000
         UNPK  COLUMN1(5),DECCOL+6(3)                              0539 01269000
*       MGPVARPT(1)=ADDR(COLUMN2);  /*                               */ 01270000
         LA    @10,COLUMN2                                         0540 01271000
         ST    @10,MGPVARPT                                        0540 01272000
*       MGPTYPE=MGPERR;             /*                               */ 01273000
         MVI   MGPTYPE,X'03'                                       0541 01274000
*       CALL HMASMMSG(HMASMMGP);    /*                               */ 01275000
         L     @15,@CV01451                                        0542 01276000
         LA    @01,@AL00542                                        0542 01277000
         BALR  @14,@15                                             0542 01278000
*       ERRRC=STOPPTF;              /*                               */ 01279000
         MVI   ERRRC,X'08'                                         0543 01280000
*       ERRSW=ON;                   /*                               */ 01281000
         OI    ERRSW,B'00010000'                                   0544 01282000
*     END;                          /*                               */ 01283000
*                                                                  0545 01284000
*   /*****************************************************************/ 01285000
*   /*                                                               */ 01286000
*   /* IF ANY ERRORS SCAN REST OF CARD FOR ENDING PERIOD             */ 01287000
*   /*                                                               */ 01288000
*   /*****************************************************************/ 01289000
*                                                                  0546 01290000
*   IF ERRSW=ON                     /*                               */ 01291000
*     THEN                          /*                               */ 01292000
@RF00530 TM    ERRSW,B'00010000'                                   0546 01293000
         BNO   @RF00546                                            0546 01294000
*     DO;                           /*                               */ 01295000
*       SCPSRCH=ADFLSHTB;           /*                               */ 01296000
         L     @10,SCPPTR                                          0548 01297000
         MVC   SCPSRCH(4,@10),ADFLSHTB                             0548 01298000
*       SCPCHAR=ADDR(CRPBUFFR);     /*                               */ 01299000
         L     @08,@PC00001+4                                      0549 01300000
         LA    @08,CRPBUFFR(,@08)                                  0549 01301000
         ST    @08,SCPCHAR(,@10)                                   0549 01302000
*       CALL HMASMSCN(HMASMSCP);    /*                               */ 01303000
         ST    @10,@AL00001                                        0550 01304000
         L     @15,@CV01452                                        0550 01305000
         LA    @01,@AL00001                                        0550 01306000
         BALR  @14,@15                                             0550 01307000
*       ERRRC=STOPPTF;              /*                               */ 01308000
         MVI   ERRRC,X'08'                                         0551 01309000
*     END;                          /*                               */ 01310000
*   ELSE                            /* IF NO ERRORS                  */ 01311000
*     IF WARNSW=ON                  /* CHECK FOR WARNING CONDITION   */ 01312000
*       THEN                        /*                               */ 01313000
         B     @RC00546                                            0553 01314000
@RF00546 TM    WARNSW,B'00001000'                                  0553 01315000
         BNO   @RF00553                                            0553 01316000
*       ERRRC=PTFWARN;              /*                               */ 01317000
         MVI   ERRRC,X'04'                                         0554 01318000
*   RETURN CODE(ERRRC);             /*                               */ 01319000
@RF00553 DS    0H                                                  0555 01320000
@RC00546 SLR   @15,@15                                             0555 01321000
         IC    @15,ERRRC                                           0555 01322000
         L     @14,@SA00008                                        0555 01323000
         LM    @00,@12,@SA00008+8                                  0555 01324000
         BR    @14                                                 0555 01325000
*   END UC3ERRCK;                   /*                               */ 01326000
         EJECT                                                          01327000
*                                                                  0557 01328000
*   /*****************************************************************/ 01329000
*   /*                                                               */ 01330000
*   /* ROUTINE CALLED AFTER UCLIN CARD SCANNED AND ALL CHECKING DONE */ 01331000
*   /* THIS ROUTINE STOWS OUT THE ENTRY THAT WAS UPDATED PLUS ANY    */ 01332000
*   /* ASSOCIATED ENTRIES                                            */ 01333000
*   /*                                                               */ 01334000
*   /*****************************************************************/ 01335000
*                                                                  0557 01336000
*UC3STOW:                           /*                               */ 01337000
*   PROCEDURE;                      /*                               */ 01338000
UC3STOW  STM   @14,@12,@SA00009                                    0557 01339000
*   RFY                                                            0558 01340000
*     HMASMIOP BASED(IOPPTR);       /* IOP WITH SYSMOD/FMID          */ 01341000
*   DECLARE                         /*                               */ 01342000
*     TMPFMID CHAR(7);              /*                               */ 01343000
*                                                                  0559 01344000
*   /*****************************************************************/ 01345000
*   /*                                                               */ 01346000
*   /* IF SYSMOD TYPE RECORD WAS UPDATED THEN NOW MUST UPDATE ANY    */ 01347000
*   /* ASSOCIATED FMID TYPE ENTRIES                                  */ 01348000
*   /*                                                               */ 01349000
*   /*****************************************************************/ 01350000
*                                                                  0560 01351000
*   IOPRETRN=IOPGOOD;               /* INIT IO RC FOR LATER CHECK    */ 01352000
         MVI   IOPRETRN(IOPPTR),X'00'                              0560 01353000
*   IOPPTR2->IOPRETRN=IOPGOOD;      /*                               */ 01354000
         L     @10,IOPPTR2                                         0561 01355000
         MVI   IOPRETRN(@10),X'00'                                 0561 01356000
*   IF IOPTYPE=IOPCSR               /* IF SYSMOD THEN MUST UPDATE    */ 01357000
*     THEN                          /* ASSOCIATED FMID ENTRIES       */ 01358000
         CLI   IOPTYPE(IOPPTR),15                                  0562 01359000
         BNE   @RF00562                                            0562 01360000
*     DO;                           /*                               */ 01361000
*       GTPFUNCT=GTPOPENN;          /* RESET FOR GETN PROCESS        */ 01362000
         MVI   GTPFUNCT,X'01'                                      0564 01363000
*       CALL HMASMGTA(HMASMGTP);    /*                               */ 01364000
         L     @15,@CV01453                                        0565 01365000
         LA    @01,@AL00565                                        0565 01366000
         BALR  @14,@15                                             0565 01367000
*       IOPRETRN=IOPGOOD;           /* INIT IO RC                    */ 01368000
         MVI   IOPRETRN(IOPPTR),X'00'                              0566 01369000
*       GTPFUNCT=GTPGETN;           /*                               */ 01370000
         MVI   GTPFUNCT,X'08'                                      0567 01371000
*       TMPFMID=BLANK7;             /* INIT FMID HOLD AREA           */ 01372000
         MVC   TMPFMID(7),@CC01473                                 0568 01373000
*       CALL HMASMGTA(HMASMGTP);    /* GET NEXT FMID/REQ PAIR        */ 01374000
         L     @15,@CV01453                                        0569 01375000
         LA    @01,@AL00569                                        0569 01376000
         BALR  @14,@15                                             0569 01377000
*       DO WHILE(                   /* LOOP UPDATING FMID ENTRIES    */ 01378000
*             IOPRETRN<=IOPNTFND    /* WHILE NO I/O ERRORS           */ 01379000
*             &GTPRETRN=GTPGOOD);   /* OR EOF ON GTA FILE            */ 01380000
         B     @DE00570                                            0570 01381000
@DL00570 DS    0H                                                  0571 01382000
*         TMPFMID=SMDFMID;          /* SAVE FMID                     */ 01383000
         MVC   TMPFMID(7),SMDFMID                                  0571 01384000
*         UCLSMDSW=''B;             /*                               */ 01385000
         MVI   UCLSMDSW,X'00'                                      0572 01386000
*         DO WHILE(                 /* LOOP WHILE                    */ 01387000
*               GTPRETRN=GTPGOOD    /* RECORDS FOUND                 */ 01388000
*               &SMDFMID=TMPFMID);  /* FOR SAME FMID AS FIRST READ   */ 01389000
         B     @DE00573                                            0573 01390000
@DL00573 DS    0H                                                  0574 01391000
*           IF SMDCODE=SMDEXIST     /* IF FMID/REQ PAIR NOT CHANGED  */ 01392000
*               &TOTALDEL=OFF       /* BUT NOT TOTAL DELETE          */ 01393000
*             THEN                  /*                               */ 01394000
         CLI   SMDCODE,0                                           0574 01395000
         BNE   @RF00574                                            0574 01396000
         TM    TOTALDEL,B'00001000'                                0574 01397000
         BNZ   @RF00574                                            0574 01398000
*             EXISTSMD=ON;          /* SET SW THAT PAIR SET          */ 01399000
         OI    EXISTSMD,B'00100000'                                0575 01400000
*           ELSE                    /*                               */ 01401000
*             IF SMDCODE=SMDADD     /*                               */ 01402000
*                 &TOTALDEL=OFF     /* BUT NOT TOTAL DELETE          */ 01403000
*               THEN                /*                               */ 01404000
         B     @RC00574                                            0576 01405000
@RF00574 CLI   SMDCODE,1                                           0576 01406000
         BNE   @RF00576                                            0576 01407000
         TM    TOTALDEL,B'00001000'                                0576 01408000
         BNZ   @RF00576                                            0576 01409000
*               ADDSMD=ON;          /*                               */ 01410000
         OI    ADDSMD,B'10000000'                                  0577 01411000
*             ELSE                  /*                               */ 01412000
*               DELSMD=ON;          /*                               */ 01413000
         B     @RC00576                                            0578 01414000
@RF00576 OI    DELSMD,B'01000000'                                  0578 01415000
*           CALL HMASMGTA(HMASMGTP);/*                               */ 01416000
@RC00576 DS    0H                                                  0579 01417000
@RC00574 L     @15,@CV01453                                        0579 01418000
         LA    @01,@AL00579                                        0579 01419000
         BALR  @14,@15                                             0579 01420000
*         END;                      /*                               */ 01421000
@DE00573 CLI   GTPRETRN,0                                          0580 01422000
         BNE   @DC00573                                            0580 01423000
         CLC   SMDFMID(7),TMPFMID                                  0580 01424000
         BE    @DL00573                                            0580 01425000
@DC00573 DS    0H                                                  0581 01426000
*         IF((ADDSMD=ON&DELSMD=OFF) /* IF SYSMOD ADDED AND NONE    0581 01427000
*                                      DELETED                       */ 01428000
*             |(ADDSMD=OFF&DELSMD=ON))/* OR SYSMOD DELETED AND NONE     01429000
*                                      ADDED OF REPLACED             */ 01430000
*             &EXISTSMD=OFF         /* EXIST BEFORE                  */ 01431000
*           THEN                    /*                               */ 01432000
         TM    ADDSMD,B'10000000'                                  0581 01433000
         BNO   @GL00015                                            0581 01434000
         TM    DELSMD,B'01000000'                                  0581 01435000
         BZ    @GL00014                                            0581 01436000
@GL00015 TM    DELSMD,B'01000000'                                  0581 01437000
         BNO   @RF00581                                            0581 01438000
         TM    ADDSMD,B'10000000'                                  0581 01439000
         BNZ   @RF00581                                            0581 01440000
@GL00014 TM    EXISTSMD,B'00100000'                                0581 01441000
         BNZ   @RF00581                                            0581 01442000
*           DO;                     /*                               */ 01443000
*             IOPFUNCT=IOPLOC;      /* LOCATE                        */ 01444000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0583 01445000
*             IOPTYPE=IOPFMD;       /* FMID                          */ 01446000
         MVI   IOPTYPE(IOPPTR),X'0E'                               0584 01447000
*             IOPNAME=SMDFMID;      /* THAT FMID                     */ 01448000
         MVI   IOPNAME+7(IOPPTR),C' '                              0585 01449000
         MVC   IOPNAME(7,IOPPTR),SMDFMID                           0585 01450000
*             IOPDSID=IOPPTR2->IOPDSID;/* ON CORRECT DATASET         */ 01451000
         L     @10,IOPPTR2                                         0586 01452000
         MVC   IOPDSID(1,IOPPTR),IOPDSID(@10)                      0586 01453000
*             CALL HMASMIO(HMASMIOP);/*                              */ 01454000
         ST    IOPPTR,@AL00001                                     0587 01455000
         L     @15,@CV01450                                        0587 01456000
         LA    @01,@AL00001                                        0587 01457000
         BALR  @14,@15                                             0587 01458000
*             IF IOPRETRN=IOPNTFND  /* IF NOT FOUND                  */ 01459000
*               THEN                /*                               */ 01460000
         CLI   IOPRETRN(IOPPTR),4                                  0588 01461000
         BNE   @RF00588                                            0588 01462000
*               DO;                 /*                               */ 01463000
*                 IOPQFMNT=''B;     /*                               */ 01464000
         XC    IOPQFMNT(2,IOPPTR),IOPQFMNT(IOPPTR)                 0590 01465000
*                 IOPQFMND(1)=IOPEOLST;/* INIT IOP ENTRY             */ 01466000
         MVI   IOPQFMND(IOPPTR),X'FF'                              0591 01467000
*               END;                /*                               */ 01468000
*             IF IOPRETRN<=IOPNTFND /* IF NO ERR IN LOCATE           */ 01469000
*               THEN                /*                               */ 01470000
@RF00588 CLI   IOPRETRN(IOPPTR),4                                  0593 01471000
         BH    @RF00593                                            0593 01472000
*               DO;                 /*                               */ 01473000
*                 HMASMVLP=''B;     /*                               */ 01474000
         XC    HMASMVLP(52),HMASMVLP                               0595 01475000
*                 VLPDATA(1:LENGTH(IOPQFMNM))=IOPPTR2->IOPNAM17;/*   */ 01476000
         L     @10,IOPPTR2                                         0596 01477000
         MVC   VLPDATA(7),IOPNAM17(@10)                            0596 01478000
*                 VLPTYPE=IOPQFMSM; /*                               */ 01479000
         MVI   VLPTYPE,X'01'                                       0597 01480000
*                 VLPDLEN=LENGTH(IOPQFMNM);/* LENGTH OF KEY IN DATA  */ 01481000
         MVI   VLPDLEN,X'07'                                       0598 01482000
*                 VLPLPTR=ADDR(IOPQFMLS(1));/*                       */ 01483000
         LA    @10,IOPQFMLS(,IOPPTR)                               0599 01484000
         ST    @10,VLPLPTR                                         0599 01485000
*                 IF DELSMD=ON      /* IF DELETE                     */ 01486000
*                   THEN            /*                               */ 01487000
         TM    DELSMD,B'01000000'                                  0600 01488000
         BNO   @RF00600                                            0600 01489000
*                   VLPFUNCT=VLPDEL;/*                               */ 01490000
         MVI   VLPFUNCT,X'02'                                      0601 01491000
*                 ELSE              /*                               */ 01492000
*                   VLPFUNCT=VLPADD;/* SET TO ADD NEW SYSMOD         */ 01493000
         B     @RC00600                                            0602 01494000
@RF00600 MVI   VLPFUNCT,X'01'                                      0602 01495000
*                 VLPMTYPE=CCATYPEA(IOPFMD);/* FMID TYPE ENTRY       */ 01496000
@RC00600 L     @10,CCATPAD(,CCAPTR)                                0603 01497000
         MVC   VLPMTYPE(8),CCATYPEA+104(@10)                       0603 01498000
*                 VLPMNAME=IOPNAME; /* FMID VALUE                    */ 01499000
         MVC   VLPMNAME(8),IOPNAME(IOPPTR)                         0604 01500000
*                 VLPSTYPE=TXTSMD;  /* SYSMOD TYPE SUBENTRY          */ 01501000
         MVC   VLPSTYPE(16),@CC01475                               0605 01502000
*                 CALL HMASMVLU(HMASMVLP);/* DEL SYSMOD FROM FMID    */ 01503000
         L     @15,@CV01454                                        0606 01504000
         LA    @01,@AL00606                                        0606 01505000
         BALR  @14,@15                                             0606 01506000
*                 IOPFUNCT=IOPSTOWR;/*                               */ 01507000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0607 01508000
*                 CALL HMASMIO(HMASMIOP);/* UPDATE FMID ENTRY        */ 01509000
         ST    IOPPTR,@AL00001                                     0608 01510000
         L     @15,@CV01450                                        0608 01511000
         LA    @01,@AL00001                                        0608 01512000
         BALR  @14,@15                                             0608 01513000
*               END;                /*                               */ 01514000
*           END;                    /* END FMID MUST BE UPDATED      */ 01515000
@RF00593 DS    0H                                                  0611 01516000
*       END;                        /* END GTA READ LOOP FOR 1 FMID  */ 01517000
@RF00581 DS    0H                                                  0611 01518000
@DE00570 CLI   IOPRETRN(IOPPTR),4                                  0611 01519000
         BH    @DC00570                                            0611 01520000
         CLI   GTPRETRN,0                                          0611 01521000
         BE    @DL00570                                            0611 01522000
@DC00570 DS    0H                                                  0612 01523000
*       HMASMIOP=IOPPTR2->HMASMIOP; /* MOVE SYSMOD ENTRY BACK        */ 01524000
         L     @10,IOPPTR2                                         0612 01525000
         MVC   HMASMIOP(68,IOPPTR),HMASMIOP(@10)                   0612 01526000
*       IOPCQMAX=IOPPTR2->IOPCQMAX; /*                               */ 01527000
         MVC   IOPCQMAX(2,IOPPTR),IOPCQMAX(@10)                    0613 01528000
*     END;                          /* END SYSMOD TYPE UPDATE        */ 01529000
*                                                                  0614 01530000
*   /*****************************************************************/ 01531000
*   /*                                                               */ 01532000
*   /* IF NO PREVIOUS ERRORS AND SYSMOD TYPE RECORD REBUILD THE      */ 01533000
*   /* SYSMOD DATA RECORD                                            */ 01534000
*   /*                                                               */ 01535000
*   /*****************************************************************/ 01536000
*                                                                  0615 01537000
*   IF IOPRETRN=IOPGOOD             /*                               */ 01538000
*       &IOPTYPE=IOPCSR             /*                               */ 01539000
*       &TOTALDEL=OFF               /* DONT REBUILD IF TOTAL DELETE  */ 01540000
*     THEN                          /*                               */ 01541000
@RF00562 CLI   IOPRETRN(IOPPTR),0                                  0615 01542000
         BNE   @RF00615                                            0615 01543000
         CLI   IOPTYPE(IOPPTR),15                                  0615 01544000
         BNE   @RF00615                                            0615 01545000
         TM    TOTALDEL,B'00001000'                                0615 01546000
         BNZ   @RF00615                                            0615 01547000
*     DO;                           /*                               */ 01548000
*       GTPKEYLN=LENGTH(SMDKEY);    /*                               */ 01549000
         MVC   GTPKEYLN(2),@CH00196                                0617 01550000
*       GTPFUNCT=GTPOPENN;          /*                               */ 01551000
         MVI   GTPFUNCT,X'01'                                      0618 01552000
*       CALL HMASMGTA(HMASMGTP);    /*                               */ 01553000
         L     @15,@CV01453                                        0619 01554000
         LA    @01,@AL00619                                        0619 01555000
         BALR  @14,@15                                             0619 01556000
*       GTPFUNCT=GTPGETN;           /*                               */ 01557000
         MVI   GTPFUNCT,X'08'                                      0620 01558000
*       CALL HMASMGTA(HMASMGTP);    /*                               */ 01559000
         L     @15,@CV01453                                        0621 01560000
         LA    @01,@AL00621                                        0621 01561000
         BALR  @14,@15                                             0621 01562000
*       DO WHILE(                   /* LOOP RECREATING RECORDS       */ 01563000
*             GTPRETRN=GTPGOOD      /*                               */ 01564000
*             &IOPRETRN=IOPGOOD);   /*                               */ 01565000
         B     @DE00622                                            0622 01566000
@DL00622 DS    0H                                                  0623 01567000
*         TMPFMID=SMDFMID;          /* SAVE FMID NUMBER              */ 01568000
         MVC   TMPFMID(7),SMDFMID                                  0623 01569000
*         IOPQSMFM=SMDFMID;         /* MOVE FMID TO RCD              */ 01570000
         L     @10,IOPBUFAD(,IOPPTR)                               0624 01571000
         MVC   IOPQSMFM(7,@10),SMDFMID                             0624 01572000
*         I=0;                      /* INIT INDEX TO OUTPUT AREA     */ 01573000
         SLR   @10,@10                                             0625 01574000
         ST    @10,I                                               0625 01575000
*         DO WHILE(                 /* LOOP READING GTA FILE         */ 01576000
*               GTPRETRN=GTPGOOD    /* TILL EOF                      */ 01577000
*               &IOPRETRN=IOPGOOD   /* AND NOT WRITE ERR             */ 01578000
*               &TMPFMID=SMDFMID);  /* AND SAME FMID                 */ 01579000
         B     @DE00626                                            0626 01580000
@DL00626 DS    0H                                                  0627 01581000
*           IF SMDCODE=SMDADD|SMDCODE=SMDEXIST/* IF NOT DELETED      */ 01582000
*             THEN                  /*                               */ 01583000
         CLI   SMDCODE,1                                           0627 01584000
         BE    @RT00627                                            0627 01585000
         CLI   SMDCODE,0                                           0627 01586000
         BNE   @RF00627                                            0627 01587000
@RT00627 DS    0H                                                  0628 01588000
*             DO;                   /*                               */ 01589000
*               I=I+1;              /* INCR INDEX TO OUTPUT          */ 01590000
         LA    @10,1                                               0629 01591000
         AL    @10,I                                               0629 01592000
         ST    @10,I                                               0629 01593000
*               IF I>DIM(IOPQSMLS)  /* IF BUFFER FULL                */ 01594000
*                 THEN              /*                               */ 01595000
         CH    @10,@CH00059                                        0630 01596000
         BNH   @RF00630                                            0630 01597000
*                 DO;               /*                               */ 01598000
*                   IOPFUNCT=IOPWRITE;/* SET TO WRITE                */ 01599000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0632 01600000
*                   CALL HMASMIO(HMASMIOP);/* WRITE SYSMOD REQ RCD   */ 01601000
         ST    IOPPTR,@AL00001                                     0633 01602000
         L     @15,@CV01450                                        0633 01603000
         LA    @01,@AL00001                                        0633 01604000
         BALR  @14,@15                                             0633 01605000
*                   I=1;            /* RESET INDEX                   */ 01606000
         MVC   I(4),@CF00039                                       0634 01607000
*                 END;              /*                               */ 01608000
*               IOPQSMLS(I)=''B;    /* ZERO ENTRY                    */ 01609000
@RF00630 L     @10,I                                               0636 01610000
         MH    @10,@CH00538                                        0636 01611000
         L     @08,IOPBUFAD(,IOPPTR)                               0636 01612000
         ST    @10,@TF00001                                        0636 01613000
         ALR   @10,@08                                             0636 01614000
         BCTR  @10,0                                               0636 01615000
         XC    IOPQSMLS-8(9,@10),IOPQSMLS-8(@10)                   0636 01616000
*               IOPQSMNM(I)=SMDREQ; /*                               */ 01617000
         LR    @10,@08                                             0637 01618000
         AL    @10,@TF00001                                        0637 01619000
         BCTR  @10,0                                               0637 01620000
         MVC   IOPQSMNM-8(7,@10),SMDREQ                            0637 01621000
*               IOPQSMTP(I)=IOPQSMRQ;/* TYPE SUBENTRY                */ 01622000
         LA    @10,1                                               0638 01623000
         L     @01,@TF00001                                        0638 01624000
         STC   @10,IOPQSMTP-9(@01,@08)                             0638 01625000
*               IOPQSMND(I+1)=IOPEOLST;/* SET END OF LIST MARKER     */ 01626000
         LA    @10,255                                             0639 01627000
         L     @01,@TF00001                                        0639 01628000
         STC   @10,IOPQSMND(@01,@08)                               0639 01629000
*             END;                  /* END REQ NOT DELETED           */ 01630000
*           CALL HMASMGTA(HMASMGTP);/* GET NEXT RCD                  */ 01631000
@RF00627 L     @15,@CV01453                                        0641 01632000
         LA    @01,@AL00641                                        0641 01633000
         BALR  @14,@15                                             0641 01634000
*         END;                      /* END GTA READ LOOP FOR 1 FMID  */ 01635000
@DE00626 CLI   GTPRETRN,0                                          0642 01636000
         BNE   @DC00626                                            0642 01637000
         CLI   IOPRETRN(IOPPTR),0                                  0642 01638000
         BNE   @DC00626                                            0642 01639000
         CLC   TMPFMID(7),SMDFMID                                  0642 01640000
         BE    @DL00626                                            0642 01641000
@DC00626 DS    0H                                                  0643 01642000
*         IF I>0                    /* IF REQ RCD PARTIALLY BUILT    */ 01643000
*             &IOPRETRN=IOPGOOD     /* AND PREV WRITES OK            */ 01644000
*           THEN                    /*                               */ 01645000
         ICM   @10,15,I                                            0643 01646000
         BNP   @RF00643                                            0643 01647000
         CLI   IOPRETRN(IOPPTR),0                                  0643 01648000
         BNE   @RF00643                                            0643 01649000
*           DO;                     /*                               */ 01650000
*             IOPFUNCT=IOPWRITE;    /*                               */ 01651000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0645 01652000
*             CALL HMASMIO(HMASMIOP);/* WRITE SYSMOD REQ RCD         */ 01653000
         ST    IOPPTR,@AL00001                                     0646 01654000
         L     @15,@CV01450                                        0646 01655000
         LA    @01,@AL00001                                        0646 01656000
         BALR  @14,@15                                             0646 01657000
*           END;                    /*                               */ 01658000
*       END;                        /* END GTA READ LOOP             */ 01659000
@RF00643 DS    0H                                                  0648 01660000
@DE00622 CLI   GTPRETRN,0                                          0648 01661000
         BNE   @DC00622                                            0648 01662000
         CLI   IOPRETRN(IOPPTR),0                                  0648 01663000
         BE    @DL00622                                            0648 01664000
@DC00622 DS    0H                                                  0649 01665000
*     END;                          /* END PREV FUNCT OK AND SMD     */ 01666000
*                                                                  0649 01667000
*   /*****************************************************************/ 01668000
*   /*                                                               */ 01669000
*   /* NOW STOW OUT UPDATED MEMBER                                   */ 01670000
*   /*                                                               */ 01671000
*   /*****************************************************************/ 01672000
*                                                                  0650 01673000
*   IF IOPRETRN=IOPGOOD             /* IF NO ERRORS SO FAR           */ 01674000
*     THEN                          /*                               */ 01675000
@RF00615 CLI   IOPRETRN(IOPPTR),0                                  0650 01676000
         BNE   @RF00650                                            0650 01677000
*     DO;                           /*                               */ 01678000
*       IF TOTALDEL=ON              /* IF TOTAL DELET                */ 01679000
*           |(IOPTYPE=IOPFMD&IOPQFMND(1)=IOPEOLST)/* OR FMID ENTRY 0652 01680000
*                                      WITH NO SUBENTRIES            */ 01681000
*         THEN                      /*                               */ 01682000
         TM    TOTALDEL,B'00001000'                                0652 01683000
         BO    @RT00652                                            0652 01684000
         CLI   IOPTYPE(IOPPTR),14                                  0652 01685000
         BNE   @RF00652                                            0652 01686000
         CLI   IOPQFMND(IOPPTR),255                                0652 01687000
         BNE   @RF00652                                            0652 01688000
@RT00652 DS    0H                                                  0653 01689000
*         IOPFUNCT=IOPSTOWD;        /* DELETE ENTRY                  */ 01690000
         MVI   IOPFUNCT(IOPPTR),X'53'                              0653 01691000
*       ELSE                        /* ELSE                          */ 01692000
*         IOPFUNCT=IOPSTOWR;        /* REPLACE ENTRY                 */ 01693000
         B     @RC00652                                            0654 01694000
@RF00652 MVI   IOPFUNCT(IOPPTR),X'54'                              0654 01695000
*       CALL HMASMIO(HMASMIOP);     /*                               */ 01696000
@RC00652 ST    IOPPTR,@AL00001                                     0655 01697000
         L     @15,@CV01450                                        0655 01698000
         LA    @01,@AL00001                                        0655 01699000
         BALR  @14,@15                                             0655 01700000
*     END;                          /*                               */ 01701000
*   RETURN CODE(IOPRETRN);          /*                               */ 01702000
@RF00650 SLR   @15,@15                                             0657 01703000
         IC    @15,IOPRETRN(,IOPPTR)                               0657 01704000
         L     @14,@SA00009                                        0657 01705000
         LM    @00,@12,@SA00009+8                                  0657 01706000
         BR    @14                                                 0657 01707000
*   END UC3STOW;                    /*                               */ 01708000
*   END HMASMUC3                    /*                               */ 01709000
*                                                                  0659 01710000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01711000
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */ 01712000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 01713000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 01714000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 01715000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 01716000
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */ 01717000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 01718000
*/*%INCLUDE SYSLIB  (HMASMVLP)                                       */ 01719000
*                                                                  0659 01720000
*       ;                                                          0659 01721000
@DATA    DS    0H                                                       01722000
@CH00144 DC    H'4'                                                     01723000
@CH00088 DC    H'7'                                                     01724000
@CH00059 DC    H'8'                                                     01725000
@CH00538 DC    H'9'                                                     01726000
@CH00553 DC    H'18'                                                    01727000
@CH00560 DC    H'22'                                                    01728000
@CH00568 DC    H'26'                                                    01729000
@CH00196 DC    H'32'                                                    01730000
@CH00580 DC    H'33'                                                    01731000
@CH01110 DC    H'54'                                                    01732000
@CH00809 DC    H'56'                                                    01733000
@CH01115 DC    H'57'                                                    01734000
@CH01460 DC    H'78'                                                    01735000
@CH01462 DC    H'157'                                                   01736000
@CH01464 DC    H'158'                                                   01737000
@CH01466 DC    H'159'                                                   01738000
@CH00726 DC    H'255'                                                   01739000
@SM01672 MVC   IOPNAME(0,IOPPTR),SCPSTRNG(@10)                          01740000
@SM01678 MVC   VLPDATA(0),SCPSTRNG(@10)                                 01741000
         DS    0F                                                       01742000
@AL00243 EQU   *                       LIST WITH   1 ARGUMENT(S)        01743000
@AL00307 EQU   *                       LIST WITH   1 ARGUMENT(S)        01744000
@AL00318 EQU   *                       LIST WITH   1 ARGUMENT(S)        01745000
@AL00328 EQU   *                       LIST WITH   1 ARGUMENT(S)        01746000
@AL00382 EQU   *                       LIST WITH   1 ARGUMENT(S)        01747000
@AL00392 EQU   *                       LIST WITH   1 ARGUMENT(S)        01748000
@AL00446 EQU   *                       LIST WITH   1 ARGUMENT(S)        01749000
@AL00474 EQU   *                       LIST WITH   1 ARGUMENT(S)        01750000
@AL00542 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        01751000
@AL00357 EQU   *                       LIST WITH   1 ARGUMENT(S)        01752000
@AL00372 EQU   *                       LIST WITH   1 ARGUMENT(S)        01753000
@AL00404 EQU   *                       LIST WITH   1 ARGUMENT(S)        01754000
@AL00407 EQU   *                       LIST WITH   1 ARGUMENT(S)        01755000
@AL00412 EQU   *                       LIST WITH   1 ARGUMENT(S)        01756000
@AL00421 EQU   *                       LIST WITH   1 ARGUMENT(S)        01757000
@AL00424 EQU   *                       LIST WITH   1 ARGUMENT(S)        01758000
@AL00429 EQU   *                       LIST WITH   1 ARGUMENT(S)        01759000
@AL00436 EQU   *                       LIST WITH   1 ARGUMENT(S)        01760000
@AL00456 EQU   *                       LIST WITH   1 ARGUMENT(S)        01761000
@AL00465 EQU   *                       LIST WITH   1 ARGUMENT(S)        01762000
@AL00565 EQU   *                       LIST WITH   1 ARGUMENT(S)        01763000
@AL00569 EQU   *                       LIST WITH   1 ARGUMENT(S)        01764000
@AL00579 EQU   *                       LIST WITH   1 ARGUMENT(S)        01765000
@AL00619 EQU   *                       LIST WITH   1 ARGUMENT(S)        01766000
@AL00621 EQU   *                       LIST WITH   1 ARGUMENT(S)        01767000
@AL00641 DC    A(HMASMGTP)             LIST WITH   1 ARGUMENT(S)        01768000
@AL00506 EQU   *                       LIST WITH   1 ARGUMENT(S)        01769000
@AL00606 DC    A(HMASMVLP)             LIST WITH   1 ARGUMENT(S)        01770000
         DS    0F                                                       01771000
@SA00001 DS    18F                                                      01772000
@PC00001 DS    2F                                                       01773000
@SA00005 DS    0F                                                       01774000
@SA00004 DS    0F                                                       01775000
@SA00003 DS    0F                                                       01776000
@SA00009 DS    0F                                                       01777000
@SA00008 DS    0F                                                       01778000
         DS    15F                                                      01779000
@AL00001 DS    1A                                                       01780000
@TF00001 DS    F                                                        01781000
         DS    0F                                                       01782000
@CF00039 DC    F'1'                                                     01783000
@CH00039 EQU   @CF00039+2                                               01784000
@CF01675 DC    F'-8'                                                    01785000
@CV01449 DC    V(HMASMCRD)                                              01786000
@CV01450 DC    V(HMASMIO)                                               01787000
@CV01451 DC    V(HMASMMSG)                                              01788000
@CV01452 DC    V(HMASMSCN)                                              01789000
@CV01453 DC    V(HMASMGTA)                                              01790000
@CV01454 DC    V(HMASMVLU)                                              01791000
         DS    0D                                                       01792000
SCPPTR   DS    A                                                        01793000
IOPPTR2  DS    A                                                        01794000
SAVBUFAD DS    A                                                        01795000
I        DS    F                                                        01796000
HEXCOL   DS    F                                                        01797000
ADSCNTBL DC    AL4(KENDUCL)                                             01798000
ADFLSHTB DC    AL4(KFLUSH)                                              01799000
UC3RTNCD DS    FL1                                                      01800000
TMPRTNCD DS    FL1                                                      01801000
ERRRC    DS    FL1                                                      01802000
@CC01475 DC    C'SYSMOD          '                                      01803000
@CC01478 DC    C'FMID            '                                      01804000
@CC01481 DC    C'REQ             '                                      01805000
@CC01471 DC    C'        '                                              01806000
@CC01473 EQU   @CC01471                                                 01807000
         DS    CL1                                                      01808000
HMASMMGP DS    CL24                                                     01809000
         ORG   HMASMMGP                                                 01810000
MGPFIXED DS    CL12                                                     01811000
         ORG   MGPFIXED                                                 01812000
MGPCLEAR DS    CL6                                                      01813000
         ORG   MGPCLEAR                                                 01814000
MGPMGNO1 DS    FL2                                                      01815000
MGPMGNO2 DS    FL2                                                      01816000
MGPMGNO3 DS    FL2                                                      01817000
         ORG   MGPFIXED+6                                               01818000
MGPFLAGS DS    BL2                                                      01819000
         ORG   MGPFLAGS                                                 01820000
MGPPRINT DS    BL1                                                      01821000
MGPLIST  EQU   MGPFLAGS+0                                               01822000
MGPRPT   EQU   MGPFLAGS+0                                               01823000
MGPHLDS  EQU   MGPFLAGS+0                                               01824000
MGPWTOR  EQU   MGPFLAGS+0                                               01825000
MGPWTO   EQU   MGPFLAGS+0                                               01826000
MGPWTP   EQU   MGPFLAGS+0                                               01827000
@NM00183 EQU   MGPFLAGS+0                                               01828000
         ORG   MGPFIXED+8                                               01829000
MGPTYPE  DS    FL1                                                      01830000
@NM00184 DS    CL3                                                      01831000
         ORG   HMASMMGP+12                                              01832000
MGPVAR   DS    CL12                                                     01833000
         ORG   MGPVAR                                                   01834000
MGPVARPT DS    3A                                                       01835000
         ORG   HMASMMGP+24                                              01836000
HMASMGTP DS    CL28                                                     01837000
         ORG   HMASMGTP                                                 01838000
GTPFUNCT DS    FL1                                                      01839000
GTPRETRN DS    FL1                                                      01840000
@NM00186 DS    CL2                                                      01841000
GTPRCDLN DS    FL2                                                      01842000
GTPKEYLN DS    FL2                                                      01843000
GTPWKAD  DS    AL4                                                      01844000
GTPBUFAD DS    AL4                                                      01845000
GTPRESTR DS    CL10                                                     01846000
         ORG   GTPRESTR                                                 01847000
GTPPAG   DS    AL4                                                      01848000
GTPRCD   DS    AL4                                                      01849000
GTPPOS   DS    FL2                                                      01850000
         ORG   HMASMGTP+26                                              01851000
GTPFLGS1 DS    BL1                                                      01852000
         ORG   GTPFLGS1                                                 01853000
GTPNOSPM DS    BL1                                                      01854000
GTPRCDNF EQU   GTPFLGS1+0                                               01855000
@NM00187 EQU   GTPFLGS1+0                                               01856000
GTPPSIZE EQU   GTPFLGS1+0                                               01857000
         ORG   HMASMGTP+27                                              01858000
@NM00188 DS    FL1                                                      01859000
         ORG   HMASMGTP+28                                              01860000
HMASMVLP DS    CL52                                                     01861000
         ORG   HMASMVLP                                                 01862000
VLPFUNCT DS    FL1                                                      01863000
VLPRETRN DS    FL1                                                      01864000
VLPFLAG  DS    BL1                                                      01865000
         ORG   VLPFLAG                                                  01866000
VLPFMSG  DS    BL1                                                      01867000
VLPFRSV  EQU   VLPFLAG+0                                                01868000
         ORG   HMASMVLP+3                                               01869000
VLPDLEN  DS    FL1                                                      01870000
VLPSNTRY DS    CL9                                                      01871000
         ORG   VLPSNTRY                                                 01872000
VLPDATA  DS    CL8                                                      01873000
VLPTYPE  DS    FL1                                                      01874000
         ORG   HMASMVLP+13                                              01875000
@NM00189 DS    CL3                                                      01876000
VLPLPTR  DS    AL4                                                      01877000
VLPMTYPE DS    CL8                                                      01878000
VLPMNAME DS    CL8                                                      01879000
VLPSTYPE DS    CL16                                                     01880000
         ORG   HMASMVLP+52                                              01881000
UC3IOP   DS    CL71                                                     01882000
UCLSWTBL DS    CL5                                                      01883000
         ORG   UCLSWTBL                                                 01884000
UCLVERB  DS    BL1                                                      01885000
         ORG   UCLVERB                                                  01886000
REP      DS    BL1                                                      01887000
ADD      EQU   UCLVERB+0                                                01888000
DEL      EQU   UCLVERB+0                                                01889000
TOTAL    EQU   UCLVERB+0                                                01890000
TOTALDEL EQU   UCLVERB+0                                                01891000
UNCDEL   EQU   UCLVERB+0                                                01892000
FRSTREPL EQU   UCLVERB+0                                                01893000
@NM00190 EQU   UCLVERB+0                                                01894000
         ORG   UCLSWTBL+1                                               01895000
UCLTYPE  DS    BL1                                                      01896000
         ORG   UCLTYPE                                                  01897000
SMD      DS    BL1                                                      01898000
FMD      EQU   UCLTYPE+0                                                01899000
@NM00191 EQU   UCLTYPE+0                                                01900000
         ORG   UCLSWTBL+2                                               01901000
UCLERRSW DS    BL1                                                      01902000
         ORG   UCLERRSW                                                 01903000
ENDUCL   DS    BL1                                                      01904000
INVLOP   EQU   UCLERRSW+0                                               01905000
DELERR   EQU   UCLERRSW+0                                               01906000
ERRSW    EQU   UCLERRSW+0                                               01907000
WARNSW   EQU   UCLERRSW+0                                               01908000
@NM00192 EQU   UCLERRSW+0                                               01909000
         ORG   UCLSWTBL+3                                               01910000
UCLCTL   DS    BL1                                                      01911000
         ORG   UCLCTL                                                   01912000
FMIDFND  DS    BL1                                                      01913000
REQFND   EQU   UCLCTL+0                                                 01914000
@NM00193 EQU   UCLCTL+0                                                 01915000
         ORG   UCLSWTBL+4                                               01916000
UCLSMDSW DS    BL1                                                      01917000
         ORG   UCLSMDSW                                                 01918000
ADDSMD   DS    BL1                                                      01919000
DELSMD   EQU   UCLSMDSW+0                                               01920000
EXISTSMD EQU   UCLSMDSW+0                                               01921000
@NM00194 EQU   UCLSMDSW+0                                               01922000
         ORG   UCLSWTBL+5                                               01923000
SAVEFMID DS    CL16                                                     01924000
DECCOL   DS    CL9                                                      01925000
         ORG   DECCOL                                                   01926000
DECCOL1  DC    CL8' '                                                   01927000
DECPAD   DC    CL1' '                                                   01928000
         ORG   DECCOL+9                                                 01929000
         DS    CL3                                                      01930000
COLUMN   DS    CL5                                                      01931000
         ORG   COLUMN                                                   01932000
COLUMN1  DC    CL5' '                                                   01933000
         ORG   COLUMN1                                                  01934000
@NM00195 DS    CL1                                                      01935000
COLUMN2  DS    CL2                                                      01936000
@NM00196 DS    CL2                                                      01937000
         ORG   COLUMN+5                                                 01938000
         DS    CL1                                                      01939000
PATCHUC3 DS    CL80                                                     01940000
         ORG   PATCHUC3                                                 01941000
@NM00197 DC    80X'FF'                                                  01942000
         ORG   PATCHUC3+80                                              01943000
SMDRCD   DS    CL33                                                     01944000
         ORG   SMDRCD                                                   01945000
SMDKEY   DS    CL32                                                     01946000
         ORG   SMDKEY                                                   01947000
SMDFMID  DS    CL7                                                      01948000
@NM00198 DS    CL9                                                      01949000
SMDREQ   DS    CL7                                                      01950000
@NM00199 DS    CL9                                                      01951000
         ORG   SMDRCD+32                                                01952000
SMDCODE  DS    FL1                                                      01953000
         ORG   SMDRCD+33                                                01954000
TMPFMID  DS    CL7                                                      01955000
HMASMUC3 CSECT                                                          01956000
*********************************************************************** 01957000
*                                                                     * 01958000
*   UCLIN SCAN TABLES TO CONTROL SCANNING OF INPUT STATEMENTS.        * 01959000
*                                                                     * 01960000
*********************************************************************** 01961000
*                                                                     * 01962000
*   THIS SET OF DSCAN CONTROL THE FUNCTION TYPE VALUES                * 01963000
*                                                                     * 01964000
*********************************************************************** 01965000
KENDUCL  DSCAN KEY='ENDUCL',ALT=KREP00,SUCC=KENDPER,ROUT=RENDUCL,      X01966000
               CALLRT=YES                                               01967000
KREP00   DSCAN KEY='REP',ALT=KADD00,SUCC=KSMD00,ROUT=RREP00             01968000
KADD00   DSCAN KEY='ADD',ALT=KDEL00,SUCC=KSMD00,ROUT=RADD00             01969000
KDEL00   DSCAN KEY='DEL',SUCC=KSMD00,ROUT=RDEL00                        01970000
HMASMUC3 CSECT                                                          01971000
*********************************************************************** 01972000
*                                                                     * 01973000
*   THIS SET OF DSCANS CHECKS FOR THE ENDING PERIOD OF EACH STATEMENT * 01974000
*   AND THE POSSIBLE COMMENT AFTER THE PERIOD                         * 01975000
*                                                                     * 01976000
*********************************************************************** 01977000
KENDPER  DSCAN KEY='.',SUCC=KXTRADTA                                    01978000
KXTRADTA DSCAN MINLEN=0,IO=NO,ROUT=RXTRADTA                             01979000
HMASMUC3 CSECT                                                          01980000
*********************************************************************** 01981000
*                                                                     * 01982000
*   THIS SET OF DSCANS FLUSHES THRU TO END OF CARD AFTER ANY ERRORS   * 01983000
*                                                                     * 01984000
*********************************************************************** 01985000
KFLUSH   DSCAN KEY='ENDUCL',ALT=KFLSHPR,SUCC=KENDPER,ROUT=RENDUCL       01986000
KFLSHPR  DSCAN KEY='.',ALT=KFLSHCHR,SUCC=KXTRADTA                       01987000
KFLSHCHR DSCAN MINLEN=0,MAXLEN=255,TYPE=AN,SUCC=KFLUSH,ROUT=RFLSHCHR    01988000
HMASMUC3 CSECT                                                          01989000
*********************************************************************** 01990000
*                                                                     * 01991000
*   THIS SET OF DSCANS CHECK FOR VALID ENTRY TYPES FOR THE CRQ/ACRQ   * 01992000
*                                                                     * 01993000
*********************************************************************** 01994000
KSMD00   DSCAN KEY='SYSMOD',ALT=KFMD00,SUCC=KSMDLP01,ROUT=RSMD00        01995000
KFMD00   DSCAN KEY='FMID',SUCC=KFMDLP01,ROUT=RFMD00                     01996000
HMASMUC3 CSECT                                                          01997000
*********************************************************************** 01998000
*                                                                     * 01999000
*   THIS SET OF DSCANS CHECK FOR VALID KEYWORDS FOR SYSMOD ENTRIES    * 02000000
*                                                                     * 02001000
*********************************************************************** 02002000
KSMDLP01 DSCAN KEY='(',SUCC=KSMDNAM                                     02003000
KSMDNAM  DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDRP01,ROUT=RXXXNAM     02004000
KSMDRP01 DSCAN KEY=')',SUCC=KSMDFMID,ROUT=RSMDRP01                      02005000
KSMDFMID DSCAN KEY='FMID',ALT=KSMDPER,SUCC=KSMDFMLP                     02006000
KSMDFMLP DSCAN KEY='(',SUCC=KSMDFMDD                                    02007000
KSMDFMDD DSCAN KEY=')',ALT=KSMDFMDV,SUCC=KSMDPER                        02008000
KSMDFMDV DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDFMRP,ROUT=RSMDFMDV    02009000
KSMDFMRP DSCAN KEY=')',SUCC=KSMDREQ                                     02010000
KSMDREQ  DSCAN KEY='REQ',ALT=KSMDPER,SUCC=KSMDRQLP,ROUT=RSMDREQ         02011000
KSMDRQLP DSCAN KEY='(',SUCC=KSMDREQD,ROUT=RESETRPL                      02012000
KSMDREQD DSCAN KEY=')',ALT=KSMDREQV,SUCC=KSMDPER,ROUT=RSMDREQD          02013000
KSMDREQV DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KSMDRQRP,ROUT=RSMDREQV    02014000
KSMDRQRP DSCAN KEY=')',ALT=KSMDREQV,SUCC=KSMDPER,COMMA=NO               02015000
KSMDPER  DSCAN KEY='.',SUCC=KXTRADTA,ROUT=RSMDPER                       02016000
HMASMUC3 CSECT                                                          02017000
*********************************************************************** 02018000
*                                                                     * 02019000
*   THIS SET OF DSCANS CHECK FOR VALID KEYWORDS FOR FMID   ENTRIES    * 02020000
*                                                                     * 02021000
*********************************************************************** 02022000
KFMDLP01 DSCAN KEY='(',SUCC=KFMDNAM                                     02023000
KFMDNAM  DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KFMDRP01,ROUT=RXXXNAM     02024000
KFMDRP01 DSCAN KEY=')',SUCC=KFMDD                                       02025000
KFMDD    DSCAN KEY='.',ALT=KFMDSMD,SUCC=KXTRADTA,ROUT=RXXXTD            02026000
KFMDSMD  DSCAN KEY='SYSMOD',SUCC=KFMDSMLP                               02027000
KFMDSMLP DSCAN KEY='(',SUCC=KFMDSMDD,ROUT=RESETRPL                      02028000
KFMDSMDD DSCAN KEY=')',ALT=KFMDSMDV,ROUT=RFMDSMDD                       02029000
KFMDSMDV DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KFMDSMRP,ROUT=RFMDSMDV    02030000
KFMDSMRP DSCAN KEY=')',ALT=KFMDSMDV,SUCC=KFMDPER,COMMA=NO               02031000
KFMDPER  DSCAN KEY='.',SUCC=KXTRADTA                                    02032000
HMASMUC3 CSECT                                                          02033000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02034000
@01      EQU   01                                                       02035000
@02      EQU   02                                                       02036000
@03      EQU   03                                                       02037000
@04      EQU   04                                                       02038000
@05      EQU   05                                                       02039000
@06      EQU   06                                                       02040000
@07      EQU   07                                                       02041000
@08      EQU   08                                                       02042000
@09      EQU   09                                                       02043000
@10      EQU   10                                                       02044000
@11      EQU   11                                                       02045000
@12      EQU   12                                                       02046000
@13      EQU   13                                                       02047000
@14      EQU   14                                                       02048000
@15      EQU   15                                                       02049000
CCAPTR   EQU   @11                                                      02050000
IOPPTR   EQU   @09                                                      02051000
RTNCODE  EQU   @15                                                      02052000
RTNREG   EQU   @14                                                      02053000
HMASMCCA EQU   0                                                        02054000
CCAFBUFR EQU   HMASMCCA+4                                               02055000
CCADSAD  EQU   CCAFBUFR+124                                             02056000
CCATPAD  EQU   CCAFBUFR+128                                             02057000
CCAFLAG7 EQU   CCAFBUFR+132                                             02058000
CCAFIOP  EQU   HMASMCCA+140                                             02059000
CCAIOPTR EQU   CCAFIOP                                                  02060000
CCAFSYS  EQU   HMASMCCA+148                                             02061000
CCASREL  EQU   CCAFSYS+12                                               02062000
CCAFLAGA EQU   CCAFSYS+21                                               02063000
CCAFSTA  EQU   HMASMCCA+188                                             02064000
CCAFICT  EQU   HMASMCCA+192                                             02065000
CCAFPGM  EQU   HMASMCCA+208                                             02066000
CCABLDLP EQU   CCAFPGM                                                  02067000
CCADBLDL EQU   CCAFPGM+4                                                02068000
CCAFGTP  EQU   HMASMCCA+224                                             02069000
CCASEGTP EQU   CCAFGTP                                                  02070000
@NM00019 EQU   HMASMCCA+244                                             02071000
CCAFFUNC EQU   HMASMCCA+264                                             02072000
CCAFLAG1 EQU   CCAFFUNC+8                                               02073000
CCAFLAG2 EQU   CCAFFUNC+11                                              02074000
CCAFPROC EQU   HMASMCCA+276                                             02075000
CCAFLAG3 EQU   CCAFPROC                                                 02076000
CCAFDIS  EQU   HMASMCCA+278                                             02077000
CCAFLAG4 EQU   CCAFDIS                                                  02078000
CCAFLAG5 EQU   CCAFDIS+1                                                02079000
CCAFLAG6 EQU   CCAFDIS+2                                                02080000
CCAFCNV  EQU   HMASMCCA+281                                             02081000
CCAFLAG8 EQU   CCAFCNV                                                  02082000
CCAFCTL  EQU   HMASMCCA+282                                             02083000
CCAFLAG9 EQU   CCAFCTL                                                  02084000
CCAFDSNG EQU   HMASMCCA+298                                             02085000
CCAFLAGB EQU   CCAFDSNG                                                 02086000
CCATYPEA EQU   0                                                        02087000
CCABLDLA EQU   0                                                        02088000
@NM00035 EQU   CCABLDLA                                                 02089000
CCABLDLL EQU   0                                                        02090000
@NM00037 EQU   CCABLDLL                                                 02091000
CCALKDRC EQU   @NM00037+20                                              02092000
@NM00039 EQU   CCABLDLL+124                                             02093000
CCAASMRC EQU   @NM00039+20                                              02094000
@NM00041 EQU   CCABLDLL+248                                             02095000
CCACPYRC EQU   @NM00041+20                                              02096000
@NM00043 EQU   CCABLDLL+372                                             02097000
CCACOMRC EQU   @NM00043+20                                              02098000
@NM00045 EQU   CCABLDLL+496                                             02099000
CCAZAPRC EQU   @NM00045+20                                              02100000
@NM00047 EQU   CCABLDLL+620                                             02101000
CCASUPRC EQU   @NM00047+20                                              02102000
@NM00049 EQU   CCABLDLL+744                                             02103000
CCAUPDRC EQU   @NM00049+20                                              02104000
CCABLDLM EQU   0                                                        02105000
CCABELMT EQU   CCABLDLM+4                                               02106000
CCABMPOS EQU   CCABELMT                                                 02107000
HMASMIOP EQU   0                                                        02108000
IOPDSID  EQU   HMASMIOP                                                 02109000
IOPFUNCT EQU   HMASMIOP+1                                               02110000
IOPRETRN EQU   HMASMIOP+2                                               02111000
IOPTYPE  EQU   HMASMIOP+3                                               02112000
IOPNAME  EQU   HMASMIOP+4                                               02113000
IOPNAM17 EQU   IOPNAME                                                  02114000
@NM00053 EQU   HMASMIOP+12                                              02115000
@NM00054 EQU   @NM00053                                                 02116000
IOPDDNAM EQU   HMASMIOP+24                                              02117000
IOPBUFAD EQU   HMASMIOP+52                                              02118000
IOPDRMAP EQU   HMASMIOP+56                                              02119000
IOPINAME EQU   IOPDRMAP                                                 02120000
IOPINAM  EQU   IOPINAME                                                 02121000
IOPITYP  EQU   IOPINAM                                                  02122000
IOPUSERL EQU   IOPDRMAP+11                                              02123000
IOPEND   EQU   IOPDRMAP+12                                              02124000
IOPLMCTL EQU   0                                                        02125000
IOPQSMIF EQU   0                                                        02126000
@NM00164 EQU   IOPQSMIF                                                 02127000
IOPQSMFM EQU   @NM00164                                                 02128000
IOPQSMLS EQU   IOPQSMIF+8                                               02129000
IOPQSMNM EQU   IOPQSMLS                                                 02130000
IOPQSMND EQU   IOPQSMNM                                                 02131000
IOPQSMTP EQU   IOPQSMLS+8                                               02132000
IOPBS02  EQU   0                                                        02133000
IOPBS04  EQU   0                                                        02134000
IOPBAPF  EQU   IOPBS04                                                  02135000
HMASMPRL EQU   0                                                        02136000
PRLSPAN  EQU   HMASMPRL+2                                               02137000
PRLFLGS  EQU   PRLSPAN                                                  02138000
PRLBLANK EQU   PRLFLGS                                                  02139000
PRLDATE  EQU   HMASMPRL+4                                               02140000
PRLTIME  EQU   HMASMPRL+7                                               02141000
PRLEND   EQU   HMASMPRL+10                                              02142000
HMASMSCP EQU   0                                                        02143000
SCPCHAR  EQU   HMASMSCP                                                 02144000
SCPSRCH  EQU   HMASMSCP+4                                               02145000
SCPIOPAD EQU   HMASMSCP+16                                              02146000
SCPPMLN  EQU   HMASMSCP+22                                              02147000
SCPEOR   EQU   HMASMSCP+24                                              02148000
SCPNORT  EQU   SCPEOR                                                   02149000
SCPRETRN EQU   HMASMSCP+25                                              02150000
SCPSTRNG EQU   0                                                        02151000
CCADSIDA EQU   0                                                        02152000
IOPBS01  EQU   0                                                        02153000
IOPBS03  EQU   0                                                        02154000
SCPIOPRM EQU   0                                                        02155000
UCLPARM  EQU   0                                                        02156000
UCLFLAGS EQU   UCLPARM+8                                                02157000
UCLFLG1  EQU   UCLFLAGS                                                 02158000
UCLFLUSH EQU   UCLFLG1                                                  02159000
UCLFLG2  EQU   UCLFLAGS+2                                               02160000
UCLFLG3  EQU   UCLFLAGS+3                                               02161000
UCLCRQ   EQU   UCLFLG3                                                  02162000
UCLFLG4  EQU   UCLFLAGS+5                                               02163000
UCLFLG5  EQU   UCLFLAGS+7                                               02164000
HMASMCRP EQU   0                                                        02165000
CRPSCPAD EQU   HMASMCRP+4                                               02166000
CRPRETRN EQU   HMASMCRP+10                                              02167000
CRPFLG1  EQU   HMASMCRP+14                                              02168000
CRPEOFEN EQU   CRPFLG1+1                                                02169000
CRPFLG2  EQU   HMASMCRP+16                                              02170000
CRPINSW0 EQU   CRPFLG2                                                  02171000
CRPINSW1 EQU   CRPFLG2                                                  02172000
CRPINSW2 EQU   CRPFLG2                                                  02173000
CRPINSW3 EQU   CRPFLG2                                                  02174000
CRPBUFFR EQU   HMASMCRP+18                                              02175000
CRPBFCTL EQU   CRPBUFFR                                                 02176000
IOPUDATA EQU   IOPEND                                                   02177000
IOPINAM3 EQU   IOPINAME                                                 02178000
@NM00060 EQU   IOPINAM3                                                 02179000
IOPSTCMP EQU   IOPUDATA                                                 02180000
IOPDYNDT EQU   IOPUDATA                                                 02181000
IOPSPACE EQU   IOPDYNDT+44                                              02182000
IOPDTYPE EQU   IOPDYNDT+50                                              02183000
IOPNTMAX EQU   IOPDRMAP                                                 02184000
IOPNTMAP EQU   IOPDRMAP                                                 02185000
IOPCDMAP EQU   IOPNTMAP                                                 02186000
IOPPTMAP EQU   IOPCDMAP                                                 02187000
IOPSCMAP EQU   IOPPTMAP                                                 02188000
IOPDIRCT EQU   IOPSCMAP+12                                              02189000
IOPCDMAX EQU   IOPDIRCT                                                 02190000
IOPCQMAP EQU   IOPDRMAP                                                 02191000
IOPCQMAX EQU   IOPCQMAP+12                                              02192000
@NM00071 EQU   IOPUDATA                                                 02193000
@NM00072 EQU   IOPUDATA                                                 02194000
IOPASMNT EQU   IOPUDATA                                                 02195000
IOPASMDR EQU   IOPASMNT                                                 02196000
IOPABUNT EQU   IOPASMDR+1                                               02197000
IOPLMDNT EQU   IOPUDATA                                                 02198000
IOPLMDDR EQU   IOPLMDNT                                                 02199000
IOPLMLEP EQU   IOPLMDDR+1                                               02200000
IOPLMDF1 EQU   IOPLMLEP                                                 02201000
IOPFLGS2 EQU   IOPLMDF1                                                 02202000
IOPLMDF2 EQU   IOPLMLEP+1                                               02203000
IOPLMDF3 EQU   IOPLMLEP+2                                               02204000
IOPLMDF4 EQU   IOPLMLEP+3                                               02205000
IOPLMDF5 EQU   IOPLMDDR+5                                               02206000
IOPFLGS3 EQU   IOPLMDF5                                                 02207000
IOPLMDFX EQU   IOPLMDNT+24                                              02208000
@NM00081 EQU   IOPLMDFX                                                 02209000
IOPLNTRY EQU   IOPLMDFX+8                                               02210000
IOPLSYS  EQU   IOPLNTRY                                                 02211000
IOPSYSLB EQU   IOPLSYS                                                  02212000
IOPMACNT EQU   IOPUDATA                                                 02213000
IOPMACDR EQU   IOPMACNT                                                 02214000
IOPRMIDE EQU   IOPMACDR+1                                               02215000
IOPRMST  EQU   IOPRMIDE+7                                               02216000
IOPFMIDE EQU   IOPMACDR+9                                               02217000
IOPMACFX EQU   IOPMACNT+24                                              02218000
IOPBUNT  EQU   IOPMACFX                                                 02219000
IOPMCEND EQU   IOPMACNT+104                                             02220000
IOPMACVR EQU   IOPMCEND                                                 02221000
IOPMCENT EQU   IOPMACVR                                                 02222000
IOPMCDTA EQU   IOPMCENT                                                 02223000
IOPMCASM EQU   IOPMCDTA                                                 02224000
IOPMACID EQU   IOPMCASM                                                 02225000
IOPMACST EQU   IOPMCASM+7                                               02226000
IOPMCIND EQU   IOPMCENT+8                                               02227000
IOPEOFNT EQU   IOPUDATA                                                 02228000
IOPSRCNT EQU   IOPUDATA                                                 02229000
IOPSRCDR EQU   IOPSRCNT                                                 02230000
@NM00092 EQU   IOPSRCDR+1                                               02231000
@NM00094 EQU   @NM00092+7                                               02232000
@NM00098 EQU   IOPSRCDR+9                                               02233000
IOPSRCFX EQU   IOPSRCNT+24                                              02234000
@NM00102 EQU   IOPSRCFX                                                 02235000
IOPSREND EQU   IOPSRCNT+104                                             02236000
IOPSRCVR EQU   IOPSREND                                                 02237000
IOPSNTRY EQU   IOPSRCVR                                                 02238000
IOPSRDTA EQU   IOPSNTRY                                                 02239000
IOPSRCID EQU   IOPSRDTA                                                 02240000
IOPSRCST EQU   IOPSRDTA+7                                               02241000
IOPMODNT EQU   IOPUDATA                                                 02242000
IOPMODDR EQU   IOPMODNT                                                 02243000
@NM00108 EQU   IOPMODDR+1                                               02244000
@NM00110 EQU   @NM00108+7                                               02245000
@NM00114 EQU   IOPMODDR+9                                               02246000
IOPMODFX EQU   IOPMODNT+24                                              02247000
@NM00118 EQU   IOPMODFX                                                 02248000
IOPMDLEP EQU   IOPMODFX+8                                               02249000
IOPMODF1 EQU   IOPMDLEP                                                 02250000
IOPMODF2 EQU   IOPMDLEP+1                                               02251000
IOPMODF3 EQU   IOPMDLEP+2                                               02252000
IOPMODF4 EQU   IOPMDLEP+3                                               02253000
IOPMDEND EQU   IOPMODNT+104                                             02254000
IOPMODVR EQU   IOPMDEND                                                 02255000
IOPMNTRY EQU   IOPMODVR                                                 02256000
IOPMDDTA EQU   IOPMNTRY                                                 02257000
IOPLMODS EQU   IOPMDDTA                                                 02258000
IOPMODID EQU   IOPLMODS                                                 02259000
IOPMODST EQU   IOPLMODS+7                                               02260000
IOPDLBNT EQU   IOPUDATA                                                 02261000
IOPDLBDR EQU   IOPDLBNT                                                 02262000
IOPDLBFX EQU   IOPDLBNT+24                                              02263000
@NM00129 EQU   IOPDLBFX                                                 02264000
IOPDLEND EQU   IOPDLBNT+104                                             02265000
IOPDLBVR EQU   IOPDLEND                                                 02266000
IOPDNTRY EQU   IOPDLBVR                                                 02267000
IOPDSYS  EQU   IOPDNTRY                                                 02268000
IOPSYSNT EQU   IOPUDATA                                                 02269000
IOPSYSDR EQU   IOPSYSNT                                                 02270000
IOPSYSF1 EQU   IOPSYSDR+4                                               02271000
IOPFLGS7 EQU   IOPSYSF1                                                 02272000
IOPSYSFX EQU   IOPSYSNT+24                                              02273000
@NM00136 EQU   IOPSYSFX                                                 02274000
IOPSYEND EQU   IOPSYSNT+184                                             02275000
IOPSYSVR EQU   IOPSYEND                                                 02276000
IOPSYSTR EQU   IOPSYSVR                                                 02277000
IOPSYNTR EQU   IOPSYSTR                                                 02278000
IOPPTFNT EQU   IOPUDATA                                                 02279000
IOPPTFDR EQU   IOPPTFNT                                                 02280000
IOPPSTAT EQU   IOPPTFDR+2                                               02281000
IOPPTFF1 EQU   IOPPSTAT                                                 02282000
IOPFLGS5 EQU   IOPPTFF1                                                 02283000
IOPPTFF2 EQU   IOPPSTAT+1                                               02284000
IOPPTFF3 EQU   IOPPSTAT+3                                               02285000
IOPPTFFX EQU   IOPPTFNT+24                                              02286000
@NM00145 EQU   IOPPTFFX                                                 02287000
@NM00146 EQU   @NM00145                                                 02288000
IOPPDTES EQU   IOPPTFFX+41                                              02289000
@NM00149 EQU   IOPPDTES                                                 02290000
IOPPTPFX EQU   IOPPDTES+6                                               02291000
IOPDATES EQU   IOPPTPFX                                                 02292000
IOPPTEND EQU   IOPPTFNT+104                                             02293000
IOPPTFVR EQU   IOPPTEND                                                 02294000
IOPPNTRY EQU   IOPPTFVR                                                 02295000
IOPPMODS EQU   IOPPNTRY                                                 02296000
IOPENTNT EQU   IOPUDATA+104                                             02297000
IOPSRLNT EQU   IOPUDATA+104                                             02298000
IOPPRENT EQU   IOPUDATA+104                                             02299000
IOPNPRNT EQU   IOPUDATA+104                                             02300000
IOPSUPNT EQU   IOPUDATA+104                                             02301000
IOPREQNT EQU   IOPUDATA+104                                             02302000
IOPIRQNT EQU   IOPUDATA+104                                             02303000
IOPFIDNT EQU   IOPUDATA+104                                             02304000
IOPDELNT EQU   IOPUDATA+104                                             02305000
IOPVERNT EQU   IOPUDATA+104                                             02306000
IOPSBYNT EQU   IOPUDATA+104                                             02307000
IOPQSMNT EQU   IOPUDATA                                                 02308000
IOPQSMDR EQU   IOPQSMNT                                                 02309000
IOPQFMNT EQU   IOPUDATA                                                 02310000
IOPQFMDR EQU   IOPQFMNT                                                 02311000
IOPQFEND EQU   IOPQFMNT+2                                               02312000
IOPQFMVR EQU   IOPQFEND                                                 02313000
IOPQFMLS EQU   IOPQFMVR                                                 02314000
IOPQFMNM EQU   IOPQFMLS                                                 02315000
IOPQFMND EQU   IOPQFMNM                                                 02316000
IOPPTSYS EQU   IOPUDATA                                                 02317000
IOPPTSDR EQU   IOPPTSYS                                                 02318000
IOPPTSFX EQU   IOPPTSYS+24                                              02319000
IOPDSSPC EQU   IOPPTSFX                                                 02320000
IOPPTFG1 EQU   IOPPTSFX+34                                              02321000
IOPPSEND EQU   IOPPTSYS+1064                                            02322000
IOPPTSVR EQU   IOPPSEND                                                 02323000
IOPPTNTR EQU   IOPPTSVR                                                 02324000
@NM00174 EQU   IOPPTNTR                                                 02325000
IOPPTFMD EQU   @NM00174                                                 02326000
IOPPTREL EQU   IOPPTFMD                                                 02327000
IOPBPDS  EQU   IOPUDATA                                                 02328000
IOPBLEP1 EQU   IOPBPDS+8                                                02329000
IOPBLEP2 EQU   IOPBPDS+9                                                02330000
@NM00178 EQU   IOPBPDS+18                                               02331000
IOPBFTB0 EQU   @NM00178                                                 02332000
IOPBFTB1 EQU   IOPBFTB0                                                 02333000
PRLDATA  EQU   PRLEND                                                   02334000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02335000
IOPBCEND EQU   IOPBPDS+21                                               02336000
IOPBFTB3 EQU   IOPBFTB0+2                                               02337000
IOPBFTB2 EQU   IOPBFTB0+1                                               02338000
@NM00180 EQU   IOPBFTB1                                                 02339000
IOPBAPFP EQU   IOPBFTB1                                                 02340000
IOPBSSI  EQU   IOPBFTB1                                                 02341000
IOPBPAGA EQU   IOPBFTB1                                                 02342000
@NM00179 EQU   IOPBFTB1                                                 02343000
IOPBAOSL EQU   IOPBFTB1                                                 02344000
IOPBSEPA EQU   IOPBPDS+15                                               02345000
IOPBFTBL EQU   IOPBPDS+13                                               02346000
IOPBSTOR EQU   IOPBPDS+10                                               02347000
IOPBREFR EQU   IOPBLEP2                                                 02348000
IOPBLEF  EQU   IOPBLEP2                                                 02349000
IOPBTEST EQU   IOPBLEP2                                                 02350000
IOPBNE   EQU   IOPBLEP2                                                 02351000
@NM00177 EQU   IOPBLEP2                                                 02352000
IOPBDC   EQU   IOPBLEP2                                                 02353000
@NM00176 EQU   IOPBLEP1                                                 02354000
IOPBSCTR EQU   IOPBLEP1                                                 02355000
IOPBOL   EQU   IOPBLEP1                                                 02356000
@NM00175 EQU   IOPBLEP1                                                 02357000
IOPBOVLY EQU   IOPBLEP1                                                 02358000
IOPBREUS EQU   IOPBLEP1                                                 02359000
IOPBRENT EQU   IOPBLEP1                                                 02360000
IOPBNL   EQU   IOPBPDS+7                                                02361000
IOPBTTRN EQU   IOPBPDS+4                                                02362000
IOPBZERO EQU   IOPBPDS+3                                                02363000
IOPBTTRT EQU   IOPBPDS                                                  02364000
IOPPTIND EQU   IOPPTNTR+8                                               02365000
IOPPTSND EQU   IOPPTREL                                                 02366000
@NM00173 EQU   IOPPTSFX+872                                             02367000
IOPSYZPP EQU   IOPPTSFX+772                                             02368000
IOPSYZPR EQU   IOPPTSFX+771                                             02369000
IOPSYZPS EQU   IOPPTSFX+763                                             02370000
IOPSYZAP EQU   IOPPTSFX+755                                             02371000
IOPSYUPP EQU   IOPPTSFX+655                                             02372000
IOPSYUPR EQU   IOPPTSFX+654                                             02373000
IOPSYUPS EQU   IOPPTSFX+646                                             02374000
IOPSYUPD EQU   IOPPTSFX+638                                             02375000
IOPSYSPP EQU   IOPPTSFX+538                                             02376000
IOPSYSPR EQU   IOPPTSFX+537                                             02377000
IOPSYSPS EQU   IOPPTSFX+529                                             02378000
IOPSYSUP EQU   IOPPTSFX+521                                             02379000
IOPSYLKP EQU   IOPPTSFX+421                                             02380000
IOPSYLKR EQU   IOPPTSFX+420                                             02381000
IOPSYLKS EQU   IOPPTSFX+412                                             02382000
IOPSYLKD EQU   IOPPTSFX+404                                             02383000
IOPSYCPP EQU   IOPPTSFX+304                                             02384000
IOPSYCPR EQU   IOPPTSFX+303                                             02385000
IOPSYCPS EQU   IOPPTSFX+295                                             02386000
IOPSYCPY EQU   IOPPTSFX+287                                             02387000
IOPSYCOP EQU   IOPPTSFX+187                                             02388000
IOPSYCOR EQU   IOPPTSFX+186                                             02389000
IOPSYCOS EQU   IOPPTSFX+178                                             02390000
IOPSYCOM EQU   IOPPTSFX+170                                             02391000
IOPSYASP EQU   IOPPTSFX+70                                              02392000
IOPSYASR EQU   IOPPTSFX+69                                              02393000
IOPSYASS EQU   IOPPTSFX+61                                              02394000
IOPSYASM EQU   IOPPTSFX+53                                              02395000
@NM00172 EQU   IOPPTSFX+35                                              02396000
@NM00171 EQU   IOPPTFG1                                                 02397000
IOPPTSNJ EQU   IOPPTFG1                                                 02398000
IOPPTSNP EQU   IOPPTFG1                                                 02399000
IOPSYPLN EQU   IOPPTSFX+32                                              02400000
IOPDSPFX EQU   IOPPTSFX+6                                               02401000
IOPDSDIR EQU   IOPDSSPC+4                                               02402000
IOPDSSEC EQU   IOPDSSPC+2                                               02403000
IOPDSPRM EQU   IOPDSSPC                                                 02404000
@NM00170 EQU   IOPPTSDR+4                                               02405000
IOPPTPEM EQU   IOPPTSDR+2                                               02406000
IOPPCNVL EQU   IOPPTSDR+1                                               02407000
@NM00169 EQU   IOPPTSDR                                                 02408000
IOPQFMTP EQU   IOPQFMLS+8                                               02409000
@NM00168 EQU   IOPQFMLS+7                                               02410000
@NM00167 EQU   IOPQFMDR                                                 02411000
@NM00163 EQU   IOPQSMDR                                                 02412000
@NM00162 EQU   IOPSBYNT+8                                               02413000
IOPSBYST EQU   IOPSBYNT+7                                               02414000
IOPSBYNM EQU   IOPSBYNT                                                 02415000
@NM00161 EQU   IOPVERNT+8                                               02416000
IOPVERST EQU   IOPVERNT+7                                               02417000
IOPVERNM EQU   IOPVERNT                                                 02418000
@NM00160 EQU   IOPDELNT+8                                               02419000
IOPDELST EQU   IOPDELNT+7                                               02420000
IOPDELNM EQU   IOPDELNT                                                 02421000
@NM00159 EQU   IOPFIDNT+8                                               02422000
IOPFIDST EQU   IOPFIDNT+7                                               02423000
IOPFIDNM EQU   IOPFIDNT                                                 02424000
@NM00158 EQU   IOPIRQNT+8                                               02425000
IOPIRQST EQU   IOPIRQNT+7                                               02426000
IOPIRQNM EQU   IOPIRQNT                                                 02427000
@NM00157 EQU   IOPREQNT+8                                               02428000
IOPREQST EQU   IOPREQNT+7                                               02429000
IOPREQNM EQU   IOPREQNT                                                 02430000
@NM00156 EQU   IOPSUPNT+8                                               02431000
IOPSUPST EQU   IOPSUPNT+7                                               02432000
IOPSUPNM EQU   IOPSUPNT                                                 02433000
@NM00155 EQU   IOPNPRNT+8                                               02434000
IOPNPRST EQU   IOPNPRNT+7                                               02435000
IOPNPRNM EQU   IOPNPRNT                                                 02436000
@NM00154 EQU   IOPPRENT+8                                               02437000
IOPPREST EQU   IOPPRENT+7                                               02438000
IOPPRENM EQU   IOPPRENT                                                 02439000
@NM00153 EQU   IOPSRLNT+8                                               02440000
IOPSRLST EQU   IOPSRLNT+7                                               02441000
@NM00152 EQU   IOPSRLNT+4                                               02442000
IOPSRLNM EQU   IOPSRLNT                                                 02443000
@NM00151 EQU   IOPENTNT+8                                               02444000
IOPENTST EQU   IOPENTNT+7                                               02445000
IOPENTNM EQU   IOPENTNT                                                 02446000
IOPPIND  EQU   IOPPNTRY+8                                               02447000
IOPPTFND EQU   IOPPMODS                                                 02448000
IOPPFMID EQU   IOPPTFFX+73                                              02449000
@NM00150 EQU   IOPPTPFX+24                                              02450000
IOPUCLT  EQU   IOPDATES+21                                              02451000
IOPUCLD  EQU   IOPDATES+18                                              02452000
IOPACCT  EQU   IOPDATES+15                                              02453000
IOPACCD  EQU   IOPDATES+12                                              02454000
IOPRSTT  EQU   IOPDATES+9                                               02455000
IOPRSTD  EQU   IOPDATES+6                                               02456000
IOPAPPT  EQU   IOPDATES+3                                               02457000
IOPAPPD  EQU   IOPDATES                                                 02458000
IOPRECT  EQU   @NM00149+3                                               02459000
IOPRECD  EQU   @NM00149                                                 02460000
@NM00148 EQU   IOPPTFFX+8                                               02461000
@NM00147 EQU   @NM00145+7                                               02462000
IOPPRELN EQU   @NM00146                                                 02463000
@NM00144 EQU   IOPPTFDR+20                                              02464000
IOPSBYNO EQU   IOPPTFDR+13                                              02465000
IOPDBYNO EQU   IOPPTFDR+6                                               02466000
@NM00143 EQU   IOPPTFF3                                                 02467000
IOPFLF   EQU   IOPPTFF3                                                 02468000
IOPDBYP  EQU   IOPPTFF3                                                 02469000
IOPSBYP  EQU   IOPPTFF3                                                 02470000
IOPPMDLP EQU   IOPPTFF2+1                                               02471000
IOPPADDP EQU   IOPPTFF2+1                                               02472000
@NM00142 EQU   IOPPTFF2+1                                               02473000
IOPLRFP  EQU   IOPPTFF2                                                 02474000
IOPJCLP  EQU   IOPPTFF2                                                 02475000
IOPSUPP  EQU   IOPPTFF2                                                 02476000
IOPREQP  EQU   IOPPTFF2                                                 02477000
IOPPREP  EQU   IOPPTFF2                                                 02478000
IOPNPRP  EQU   IOPPTFF2                                                 02479000
IOPIRQP  EQU   IOPPTFF2                                                 02480000
IOPDELP  EQU   IOPPTFF2                                                 02481000
IOPREGEN EQU   IOPFLGS5                                                 02482000
IOPBYP   EQU   IOPFLGS5                                                 02483000
IOPDUMMP EQU   IOPFLGS5                                                 02484000
@NM00141 EQU   IOPFLGS5                                                 02485000
IOPERROR EQU   IOPFLGS5                                                 02486000
IOPACC   EQU   IOPFLGS5                                                 02487000
IOPRES   EQU   IOPFLGS5                                                 02488000
IOPAPP   EQU   IOPFLGS5                                                 02489000
IOPPTYPE EQU   IOPPTFDR+1                                               02490000
@NM00140 EQU   IOPPTFDR                                                 02491000
IOPSYSTP EQU   IOPSYSTR+8                                               02492000
IOPSYSND EQU   IOPSYNTR                                                 02493000
@NM00139 EQU   IOPSYSFX+21                                              02494000
IOPSYSID EQU   IOPSYSFX+13                                              02495000
IOPNUCID EQU   IOPSYSFX+12                                              02496000
IOPSREL  EQU   IOPSYSFX+8                                               02497000
@NM00138 EQU   @NM00136+7                                               02498000
@NM00137 EQU   @NM00136                                                 02499000
@NM00135 EQU   IOPSYSDR+5                                               02500000
@NM00134 EQU   IOPFLGS7                                                 02501000
IOPSYNG  EQU   IOPFLGS7                                                 02502000
IOPSYDL  EQU   IOPFLGS7                                                 02503000
IOPSTSNP EQU   IOPFLGS7                                                 02504000
IOPMTSNP EQU   IOPFLGS7                                                 02505000
IOPPEMAX EQU   IOPSYSDR+2                                               02506000
IOPSCNVL EQU   IOPSYSDR+1                                               02507000
@NM00133 EQU   IOPSYSDR                                                 02508000
IOPDLIND EQU   IOPDNTRY+8                                               02509000
IOPDLBND EQU   IOPDSYS                                                  02510000
@NM00132 EQU   IOPDLBFX+8                                               02511000
@NM00131 EQU   @NM00129+7                                               02512000
@NM00130 EQU   @NM00129                                                 02513000
@NM00128 EQU   IOPDLBDR+1                                               02514000
@NM00127 EQU   IOPDLBDR                                                 02515000
IOPMDIND EQU   IOPMNTRY+8                                               02516000
@NM00126 EQU   IOPMODST                                                 02517000
IOPMODND EQU   IOPMODID                                                 02518000
IOPDLIB  EQU   IOPMODFX+72                                              02519000
@NM00125 EQU   IOPMODFX+12                                              02520000
@NM00124 EQU   IOPMODF4                                                 02521000
@NM00123 EQU   IOPMODF3                                                 02522000
@NM00122 EQU   IOPMODF2                                                 02523000
IOPMPAGA EQU   IOPMODF2                                                 02524000
IOPMNE   EQU   IOPMODF2                                                 02525000
@NM00121 EQU   IOPMODF1                                                 02526000
IOPMDC   EQU   IOPMODF1                                                 02527000
IOPMREFR EQU   IOPMODF1                                                 02528000
IOPMOVLY EQU   IOPMODF1                                                 02529000
IOPMSCTR EQU   IOPMODF1                                                 02530000
IOPMREUS EQU   IOPMODF1                                                 02531000
IOPMRENT EQU   IOPMODF1                                                 02532000
IOPMAPF  EQU   IOPMODF1                                                 02533000
@NM00120 EQU   @NM00118+7                                               02534000
@NM00119 EQU   @NM00118                                                 02535000
@NM00117 EQU   IOPMODDR+17                                              02536000
@NM00116 EQU   @NM00114+7                                               02537000
@NM00115 EQU   @NM00114                                                 02538000
@NM00113 EQU   @NM00110                                                 02539000
@NM00112 EQU   @NM00110                                                 02540000
@NM00111 EQU   @NM00110                                                 02541000
@NM00109 EQU   @NM00108                                                 02542000
@NM00107 EQU   IOPMODDR                                                 02543000
IOPSRIND EQU   IOPSNTRY+8                                               02544000
@NM00106 EQU   IOPSRCST                                                 02545000
IOPSRCND EQU   IOPSRCID                                                 02546000
IOPSRDLB EQU   IOPSRCFX+72                                              02547000
IOPSRSYS EQU   IOPSRCFX+64                                              02548000
@NM00105 EQU   IOPSRCFX+8                                               02549000
@NM00104 EQU   @NM00102+7                                               02550000
@NM00103 EQU   @NM00102                                                 02551000
@NM00101 EQU   IOPSRCDR+18                                              02552000
IOPSRLNG EQU   IOPSRCDR+17                                              02553000
@NM00100 EQU   @NM00098+7                                               02554000
@NM00099 EQU   @NM00098                                                 02555000
@NM00097 EQU   @NM00094                                                 02556000
@NM00096 EQU   @NM00094                                                 02557000
@NM00095 EQU   @NM00094                                                 02558000
@NM00093 EQU   @NM00092                                                 02559000
@NM00091 EQU   IOPSRCDR                                                 02560000
IOPEOFND EQU   IOPEOFNT                                                 02561000
IOPMCTYP EQU   IOPMCIND                                                 02562000
@NM00090 EQU   IOPMACST                                                 02563000
IOPMACND EQU   IOPMACID                                                 02564000
IOPMCDLB EQU   IOPMACFX+72                                              02565000
IOPMCSYS EQU   IOPMACFX+64                                              02566000
@NM00089 EQU   IOPMACFX+8                                               02567000
IOPBUTYP EQU   IOPBUNT+7                                                02568000
IOPBUSMD EQU   IOPBUNT                                                  02569000
@NM00088 EQU   IOPMACDR+18                                              02570000
IOPMCLNG EQU   IOPMACDR+17                                              02571000
IOPFMST  EQU   IOPFMIDE+7                                               02572000
IOPFMID  EQU   IOPFMIDE                                                 02573000
@NM00087 EQU   IOPRMST                                                  02574000
IOPRMASM EQU   IOPRMST                                                  02575000
@NM00086 EQU   IOPRMST                                                  02576000
IOPRMID  EQU   IOPRMIDE                                                 02577000
@NM00085 EQU   IOPMACDR                                                 02578000
IOPLMIND EQU   IOPLNTRY+8                                               02579000
IOPLMDND EQU   IOPSYSLB                                                 02580000
@NM00083 EQU   @NM00081+7                                               02581000
@NM00082 EQU   @NM00081                                                 02582000
@NM00080 EQU   IOPLMDDR+6                                               02583000
@NM00079 EQU   IOPFLGS3                                                 02584000
IOPCHREP EQU   IOPFLGS3                                                 02585000
IOPLINK  EQU   IOPFLGS3                                                 02586000
IOPCOPY  EQU   IOPFLGS3                                                 02587000
@NM00078 EQU   IOPLMDF4                                                 02588000
@NM00077 EQU   IOPLMDF3                                                 02589000
@NM00076 EQU   IOPLMDF2                                                 02590000
IOPPAGA  EQU   IOPLMDF2                                                 02591000
IOPNE    EQU   IOPLMDF2                                                 02592000
@NM00075 EQU   IOPFLGS2                                                 02593000
IOPDC    EQU   IOPFLGS2                                                 02594000
IOPREFR  EQU   IOPFLGS2                                                 02595000
IOPOVLY  EQU   IOPFLGS2                                                 02596000
IOPSCTR  EQU   IOPFLGS2                                                 02597000
IOPREUS  EQU   IOPFLGS2                                                 02598000
IOPRENT  EQU   IOPFLGS2                                                 02599000
IOPAPF   EQU   IOPFLGS2                                                 02600000
@NM00074 EQU   IOPLMDDR                                                 02601000
@NM00073 EQU   IOPASMDR+9                                               02602000
IOPABUTP EQU   IOPABUNT+7                                               02603000
IOPABUPT EQU   IOPABUNT                                                 02604000
IOPNTLVL EQU   IOPASMDR                                                 02605000
IOPALLOC EQU   @NM00072+4                                               02606000
IOPUSED  EQU   @NM00072                                                 02607000
IOPTPSEQ EQU   @NM00071+8                                               02608000
IOPVLSER EQU   @NM00071+2                                               02609000
IOPBLKSI EQU   @NM00071                                                 02610000
@NM00070 EQU   IOPCQMAP+11                                              02611000
@NM00069 EQU   IOPCQMAP+8                                               02612000
@NM00068 EQU   IOPCQMAP                                                 02613000
IOPPTMAX EQU   IOPCDMAX                                                 02614000
@NM00067 EQU   IOPSCMAP+11                                              02615000
@NM00066 EQU   IOPSCMAP+8                                               02616000
@NM00065 EQU   IOPSCMAP                                                 02617000
IOPDIRMX EQU   IOPNTMAX+12                                              02618000
@NM00064 EQU   IOPNTMAX+11                                              02619000
@NM00063 EQU   IOPNTMAX+8                                               02620000
@NM00062 EQU   IOPNTMAX                                                 02621000
@NM00061 EQU   IOPDTYPE                                                 02622000
IOPDMOD  EQU   IOPDTYPE                                                 02623000
IOPDJCL  EQU   IOPDTYPE                                                 02624000
IOPDSRC  EQU   IOPDTYPE                                                 02625000
IOPDMAC  EQU   IOPDTYPE                                                 02626000
IOPSDIR  EQU   IOPSPACE+4                                               02627000
IOPSSCND EQU   IOPSPACE+2                                               02628000
IOPSPRIM EQU   IOPSPACE                                                 02629000
IOPDSN   EQU   IOPDYNDT                                                 02630000
IOPNTYPE EQU   IOPSTCMP+17                                              02631000
IOPNNAME EQU   IOPSTCMP+9                                               02632000
IOPOTYPE EQU   IOPSTCMP+8                                               02633000
IOPONAME EQU   IOPSTCMP                                                 02634000
IOPISEQ3 EQU   IOPINAM3+6                                               02635000
IOPITYP3 EQU   @NM00060+5                                               02636000
IOPIPTF3 EQU   @NM00060                                                 02637000
CRPDDNAM EQU   HMASMCRP+98                                              02638000
CRPBFSEQ EQU   CRPBUFFR+72                                              02639000
CRPBFCNT EQU   CRPBFCTL+71                                              02640000
CRPBFDTA EQU   CRPBFCTL                                                 02641000
CRPINSWF EQU   CRPFLG2+1                                                02642000
CRPINSWE EQU   CRPFLG2+1                                                02643000
CRPINSWD EQU   CRPFLG2+1                                                02644000
CRPINSWC EQU   CRPFLG2+1                                                02645000
CRPINSWB EQU   CRPFLG2+1                                                02646000
CRPINSWA EQU   CRPFLG2+1                                                02647000
CRPINSW9 EQU   CRPFLG2+1                                                02648000
CRPINSW8 EQU   CRPFLG2+1                                                02649000
CRPINSW7 EQU   CRPFLG2                                                  02650000
CRPINSW6 EQU   CRPFLG2                                                  02651000
CRPINSW5 EQU   CRPFLG2                                                  02652000
CRPINSW4 EQU   CRPFLG2                                                  02653000
CRPEOF1  EQU   CRPINSW3                                                 02654000
CRPWRTLG EQU   CRPINSW2                                                 02655000
CRPEXADD EQU   CRPINSW1                                                 02656000
CRPEOFSW EQU   CRPINSW0                                                 02657000
@NM00010 EQU   CRPFLG1+1                                                02658000
CRPRPT   EQU   CRPFLG1+1                                                02659000
CRPLIST  EQU   CRPFLG1+1                                                02660000
CRPNOWPP EQU   CRPFLG1+1                                                02661000
CRPTRMEX EQU   CRPFLG1+1                                                02662000
CRPSCNCL EQU   CRPFLG1                                                  02663000
CRPOFFST EQU   CRPFLG1                                                  02664000
CRPOTHER EQU   CRPFLG1                                                  02665000
CRPPRINT EQU   CRPFLG1                                                  02666000
CRPLOG   EQU   CRPFLG1                                                  02667000
CRPPTS   EQU   CRPFLG1                                                  02668000
CRPLOGCK EQU   CRPFLG1                                                  02669000
CRPBFPRM EQU   CRPFLG1                                                  02670000
@NM00009 EQU   HMASMCRP+11                                              02671000
CRPOUTDS EQU   HMASMCRP+9                                               02672000
CRPINDS  EQU   HMASMCRP+8                                               02673000
@NM00008 EQU   HMASMCRP+1                                               02674000
CRPUXNUM EQU   HMASMCRP                                                 02675000
@NM00007 EQU   UCLFLG5                                                  02676000
UCLICTOK EQU   UCLFLG5                                                  02677000
@NM00006 EQU   UCLFLG4                                                  02678000
UCLBPFM  EQU   UCLFLG4                                                  02679000
@NM00005 EQU   UCLFLG4                                                  02680000
UCLBPIRQ EQU   UCLFLG4                                                  02681000
UCLBPREQ EQU   UCLFLG4                                                  02682000
UCLBPPRE EQU   UCLFLG4                                                  02683000
UCLBPID  EQU   UCLFLG4                                                  02684000
@NM00004 EQU   UCLFLG3+1                                                02685000
UCLSTS   EQU   UCLFLG3                                                  02686000
UCLMTS   EQU   UCLFLG3                                                  02687000
UCLPTS   EQU   UCLFLG3                                                  02688000
UCLACRQ  EQU   UCLFLG3                                                  02689000
UCLSCDS  EQU   UCLFLG3                                                  02690000
UCLACDS  EQU   UCLFLG3                                                  02691000
UCLCDS   EQU   UCLFLG3                                                  02692000
UCLMASS  EQU   UCLFLG2                                                  02693000
@NM00003 EQU   UCLFLG2                                                  02694000
UCLFMID  EQU   UCLFLG2                                                  02695000
UCLGROUP EQU   UCLFLG2                                                  02696000
UCLEXC   EQU   UCLFLG2                                                  02697000
UCLSEL   EQU   UCLFLG2                                                  02698000
@NM00002 EQU   UCLFLG1+1                                                02699000
UCLDISW  EQU   UCLFLG1+1                                                02700000
UCLDISR  EQU   UCLFLG1+1                                                02701000
UCLDISN  EQU   UCLFLG1+1                                                02702000
UCLNOJCL EQU   UCLFLG1                                                  02703000
UCLUSER  EQU   UCLFLG1                                                  02704000
UCLAPAR  EQU   UCLFLG1                                                  02705000
UCLCOMP  EQU   UCLFLG1                                                  02706000
UCLASSEM EQU   UCLFLG1                                                  02707000
UCLCHECK EQU   UCLFLG1                                                  02708000
UCLNOAPP EQU   UCLFLG1                                                  02709000
@NM00001 EQU   UCLPARM+5                                                02710000
UCLNUCID EQU   UCLPARM+4                                                02711000
UCLJCLGT EQU   UCLPARM                                                  02712000
SCPRET   EQU   SCPRETRN                                                 02713000
@NM00185 EQU   SCPEOR                                                   02714000
SCPNOSUC EQU   SCPEOR                                                   02715000
SCPRTERR EQU   SCPEOR                                                   02716000
SCPCOMNT EQU   SCPEOR                                                   02717000
SCPNOCT  EQU   SCPEOR                                                   02718000
SCPCONT  EQU   SCPEOR                                                   02719000
SCPINLN  EQU   HMASMSCP+20                                              02720000
SCPIORTN EQU   HMASMSCP+12                                              02721000
SCPWKAR  EQU   HMASMSCP+8                                               02722000
PRLCONC  EQU   PRLTIME+2                                                02723000
@NM00182 EQU   PRLTIME                                                  02724000
PRLHDADR EQU   PRLDATE                                                  02725000
@NM00181 EQU   PRLFLGS                                                  02726000
PRLHEADO EQU   PRLFLGS                                                  02727000
PRLHEAD  EQU   PRLFLGS                                                  02728000
PRLRLEN  EQU   HMASMPRL                                                 02729000
IOPBS04E EQU   IOPBS04+2                                                02730000
IOPBAPFC EQU   IOPBAPF+1                                                02731000
IOPBAPFL EQU   IOPBAPF                                                  02732000
IOPBS2NM EQU   IOPBS02+3                                                02733000
IOPBS2EP EQU   IOPBS02                                                  02734000
@NM00166 EQU   IOPQSMLS+7                                               02735000
@NM00165 EQU   @NM00164+7                                               02736000
@NM00084 EQU   IOPLMCTL+17                                              02737000
IOPLMCRD EQU   IOPLMCTL+9                                               02738000
IOPLMCRN EQU   IOPLMCTL+1                                               02739000
IOPLMCC  EQU   IOPLMCTL                                                 02740000
@NM00059 EQU   IOPUSERL                                                 02741000
@NM00058 EQU   IOPUSERL                                                 02742000
IOPALIS  EQU   IOPUSERL                                                 02743000
IOPTTR   EQU   IOPDRMAP+8                                               02744000
IOPINAM2 EQU   IOPINAM+1                                                02745000
IOPITYP2 EQU   IOPITYP                                                  02746000
@NM00057 EQU   HMASMIOP+32                                              02747000
IOPDELDD EQU   IOPDDNAM                                                 02748000
@NM00056 EQU   @NM00053+10                                              02749000
IOPSEQNO EQU   @NM00053+8                                               02750000
@NM00055 EQU   @NM00054+7                                               02751000
IOPPTFNM EQU   @NM00054                                                 02752000
CCABMREC EQU   CCABELMT+10                                              02753000
CCABPOS  EQU   CCABMPOS+8                                               02754000
CCABNAME EQU   CCABMPOS                                                 02755000
@NM00052 EQU   CCABLDLM+2                                               02756000
@NM00051 EQU   CCABLDLM                                                 02757000
CCAUPDPM EQU   @NM00049+24                                              02758000
@NM00050 EQU   @NM00049+21                                              02759000
CCARUPDT EQU   CCAUPDRC                                                 02760000
CCAUPDSP EQU   @NM00049+12                                              02761000
CCAUPDTE EQU   @NM00049+8                                               02762000
CCAUPDNM EQU   @NM00049                                                 02763000
CCASUPPM EQU   @NM00047+24                                              02764000
@NM00048 EQU   @NM00047+21                                              02765000
CCARSUP  EQU   CCASUPRC                                                 02766000
CCASUPSP EQU   @NM00047+12                                              02767000
CCAIOSUP EQU   @NM00047+8                                               02768000
CCASUPNM EQU   @NM00047                                                 02769000
CCAZAPPM EQU   @NM00045+24                                              02770000
@NM00046 EQU   @NM00045+21                                              02771000
CCARZAP  EQU   CCAZAPRC                                                 02772000
CCAZAPSP EQU   @NM00045+12                                              02773000
CCASPZAP EQU   @NM00045+8                                               02774000
CCAZAPNM EQU   @NM00045                                                 02775000
CCACOMPM EQU   @NM00043+24                                              02776000
@NM00044 EQU   @NM00043+21                                              02777000
CCARCOMP EQU   CCACOMRC                                                 02778000
CCACOMSP EQU   @NM00043+12                                              02779000
CCACOMRS EQU   @NM00043+8                                               02780000
CCACOMNM EQU   @NM00043                                                 02781000
CCACPYPM EQU   @NM00041+24                                              02782000
@NM00042 EQU   @NM00041+21                                              02783000
CCARCOPY EQU   CCACPYRC                                                 02784000
CCACPYSP EQU   @NM00041+12                                              02785000
CCACOPY  EQU   @NM00041+8                                               02786000
CCACPYNM EQU   @NM00041                                                 02787000
CCAASMPM EQU   @NM00039+24                                              02788000
@NM00040 EQU   @NM00039+21                                              02789000
CCARASM  EQU   CCAASMRC                                                 02790000
CCAASMSP EQU   @NM00039+12                                              02791000
CCAASM   EQU   @NM00039+8                                               02792000
CCAASMNM EQU   @NM00039                                                 02793000
CCALKDPM EQU   @NM00037+24                                              02794000
@NM00038 EQU   @NM00037+21                                              02795000
CCARLINK EQU   CCALKDRC                                                 02796000
CCALKDSP EQU   @NM00037+12                                              02797000
CCALKED  EQU   @NM00037+8                                               02798000
CCALKDNM EQU   @NM00037                                                 02799000
CCAPGMPM EQU   @NM00035+24                                              02800000
@NM00036 EQU   @NM00035+21                                              02801000
CCABPGRC EQU   @NM00035+20                                              02802000
CCABPGSP EQU   @NM00035+12                                              02803000
CCABPGAD EQU   @NM00035+8                                               02804000
CCABPGNM EQU   @NM00035                                                 02805000
CCAEND   EQU   HMASMCCA+371                                             02806000
@NM00034 EQU   HMASMCCA+309                                             02807000
CCACURDD EQU   CCAFDSNG+3                                               02808000
CCACURDS EQU   CCAFDSNG+2                                               02809000
@NM00033 EQU   CCAFLAGB                                                 02810000
CCAOUTNG EQU   CCAFLAGB                                                 02811000
CCALOGNG EQU   CCAFLAGB                                                 02812000
CCAFMID  EQU   HMASMCCA+291                                             02813000
CCALSTDS EQU   CCAFCTL+8                                                02814000
CCARPTDS EQU   CCAFCTL+7                                                02815000
CCATIME  EQU   CCAFCTL+4                                                02816000
CCADATE  EQU   CCAFCTL+1                                                02817000
@NM00032 EQU   CCAFLAG9                                                 02818000
CCARVCAN EQU   CCAFLAG9                                                 02819000
CCARVEST EQU   CCAFLAG9                                                 02820000
CCAPTSNJ EQU   CCAFLAG9                                                 02821000
CCASTSNP EQU   CCAFLAG9                                                 02822000
CCAMTSNP EQU   CCAFLAG9                                                 02823000
CCAPTSNP EQU   CCAFLAG9                                                 02824000
@NM00031 EQU   CCAFLAG8                                                 02825000
CCAACDSC EQU   CCAFLAG8                                                 02826000
CCACDSC  EQU   CCAFLAG8                                                 02827000
@NM00030 EQU   CCAFLAG6                                                 02828000
CCAACRUP EQU   CCAFLAG6                                                 02829000
CCACRQUP EQU   CCAFLAG6                                                 02830000
CCAACDUP EQU   CCAFLAG6                                                 02831000
CCACDSUP EQU   CCAFLAG6                                                 02832000
@NM00029 EQU   CCAFLAG5                                                 02833000
CCAACROS EQU   CCAFLAG5                                                 02834000
CCACRQOS EQU   CCAFLAG5                                                 02835000
CCAACDOS EQU   CCAFLAG5                                                 02836000
CCACDSOS EQU   CCAFLAG5                                                 02837000
@NM00028 EQU   CCAFLAG4                                                 02838000
CCAACRIS EQU   CCAFLAG4                                                 02839000
CCACRQIS EQU   CCAFLAG4                                                 02840000
CCAACDIS EQU   CCAFLAG4                                                 02841000
CCACDSIS EQU   CCAFLAG4                                                 02842000
@NM00027 EQU   CCAFLAG3+1                                               02843000
CCARGNP  EQU   CCAFLAG3+1                                               02844000
CCADISRQ EQU   CCAFLAG3+1                                               02845000
CCAICTOK EQU   CCAFLAG3                                                 02846000
CCADELP  EQU   CCAFLAG3                                                 02847000
CCACMPRS EQU   CCAFLAG3                                                 02848000
CCAZAPP  EQU   CCAFLAG3                                                 02849000
CCALINKP EQU   CCAFLAG3                                                 02850000
CCACOPYP EQU   CCAFLAG3                                                 02851000
CCAASIP  EQU   CCAFLAG3                                                 02852000
CCAUPDP  EQU   CCAFLAG3                                                 02853000
CCAEOSMP EQU   CCAFLAG2                                                 02854000
CCAEOFNC EQU   CCAFLAG2                                                 02855000
@NM00026 EQU   CCAFLAG2                                                 02856000
CCACHECK EQU   CCAFLAG2                                                 02857000
CCATERM  EQU   CCAFLAG2                                                 02858000
CCASVCLB EQU   CCAFLAG2                                                 02859000
CCANCPTF EQU   CCAFLAG2                                                 02860000
@NM00025 EQU   CCAFLAG1+1                                               02861000
CCAUNL   EQU   CCAFLAG1+1                                               02862000
CCARESET EQU   CCAFLAG1+1                                               02863000
CCALOG   EQU   CCAFLAG1+1                                               02864000
CCACNV   EQU   CCAFLAG1+1                                               02865000
CCALIST  EQU   CCAFLAG1                                                 02866000
CCAUPDU  EQU   CCAFLAG1                                                 02867000
CCAUPDJ  EQU   CCAFLAG1                                                 02868000
CCARES   EQU   CCAFLAG1                                                 02869000
CCAREJ   EQU   CCAFLAG1                                                 02870000
CCAACCPT EQU   CCAFLAG1                                                 02871000
CCAAPPLY EQU   CCAFLAG1                                                 02872000
CCAREC   EQU   CCAFLAG1                                                 02873000
CCAFUNCT EQU   CCAFFUNC                                                 02874000
@NM00024 EQU   @NM00019+18                                              02875000
@NM00023 EQU   @NM00019+16                                              02876000
CCATBLPA EQU   @NM00019+12                                              02877000
@NM00022 EQU   @NM00019+8                                               02878000
@NM00021 EQU   @NM00019+4                                               02879000
@NM00020 EQU   @NM00019                                                 02880000
CCAIFGTP EQU   CCAFGTP+16                                               02881000
CCAGTP3  EQU   CCAFGTP+12                                               02882000
CCAGTP2  EQU   CCAFGTP+8                                                02883000
CCAGTP1  EQU   CCAFGTP+4                                                02884000
CCASETAD EQU   CCASEGTP                                                 02885000
CCACLST  EQU   CCAFPGM+12                                               02886000
CCASPDCB EQU   CCAFPGM+8                                                02887000
CCAICLMD EQU   CCAFICT+12                                               02888000
CCAICMOD EQU   CCAFICT+8                                                02889000
CCAICPTF EQU   CCAFICT+4                                                02890000
CCAICT   EQU   CCAFICT                                                  02891000
CCARVAD  EQU   CCAFSTA                                                  02892000
CCAACDID EQU   CCAFSYS+32                                               02893000
CCACDSID EQU   CCAFSYS+24                                               02894000
CCALNLEN EQU   CCAFSYS+22                                               02895000
@NM00018 EQU   CCAFLAGA                                                 02896000
CCAPSYSF EQU   CCAFLAGA                                                 02897000
CCAASYSF EQU   CCAFLAGA                                                 02898000
CCACSYSF EQU   CCAFLAGA                                                 02899000
CCANUCID EQU   CCAFSYS+20                                               02900000
CCAASREL EQU   CCAFSYS+16                                               02901000
CCACSREL EQU   CCASREL                                                  02902000
CCAPEMAX EQU   CCAFSYS+10                                               02903000
CCAPGLEN EQU   CCAFSYS+8                                                02904000
CCAIOPAS EQU   CCAFSYS+4                                                02905000
CCAIOPCS EQU   CCAFSYS                                                  02906000
CCAPESIZ EQU   CCAFIOP+4                                                02907000
@NM00017 EQU   CCAFLAG7+3                                               02908000
CCALOGP  EQU   CCAFLAG7+2                                               02909000
CCAOUTP  EQU   CCAFLAG7+2                                               02910000
CCASLBP  EQU   CCAFLAG7+2                                               02911000
CCARPTP  EQU   CCAFLAG7+2                                               02912000
CCALISTP EQU   CCAFLAG7+2                                               02913000
CCAJCLP  EQU   CCAFLAG7+2                                               02914000
CCAPTFP  EQU   CCAFLAG7+2                                               02915000
CCATLBP  EQU   CCAFLAG7+2                                               02916000
CCAUT3P  EQU   CCAFLAG7+1                                               02917000
CCAUT2P  EQU   CCAFLAG7+1                                               02918000
CCAUT1P  EQU   CCAFLAG7+1                                               02919000
CCAWK5P  EQU   CCAFLAG7+1                                               02920000
CCAWK4P  EQU   CCAFLAG7+1                                               02921000
CCAWK3P  EQU   CCAFLAG7+1                                               02922000
CCAWK2P  EQU   CCAFLAG7+1                                               02923000
CCAWK1P  EQU   CCAFLAG7+1                                               02924000
CCAACRQP EQU   CCAFLAG7                                                 02925000
CCACRQP  EQU   CCAFLAG7                                                 02926000
CCASTSP  EQU   CCAFLAG7                                                 02927000
CCAMTSP  EQU   CCAFLAG7                                                 02928000
CCAPTSP  EQU   CCAFLAG7                                                 02929000
CCASCDSP EQU   CCAFLAG7                                                 02930000
CCAACDSP EQU   CCAFLAG7                                                 02931000
CCACDSP  EQU   CCAFLAG7                                                 02932000
@NM00016 EQU   CCAFBUFR+122                                             02933000
@NM00015 EQU   CCAFBUFR+120                                             02934000
@NM00014 EQU   CCAFBUFR+118                                             02935000
CCATBFMX EQU   CCAFBUFR+116                                             02936000
CCA4BFMX EQU   CCAFBUFR+114                                             02937000
CCA3BFMX EQU   CCAFBUFR+112                                             02938000
CCA2BFMX EQU   CCAFBUFR+110                                             02939000
CCA1BFMX EQU   CCAFBUFR+108                                             02940000
CCAXBFMX EQU   CCAFBUFR+106                                             02941000
CCAQBFMX EQU   CCAFBUFR+104                                             02942000
CCASBFMX EQU   CCAFBUFR+102                                             02943000
CCAMBFMX EQU   CCAFBUFR+100                                             02944000
CCAPBFMX EQU   CCAFBUFR+98                                              02945000
CCAVBFMX EQU   CCAFBUFR+96                                              02946000
CCAABFMX EQU   CCAFBUFR+94                                              02947000
CCACBFMX EQU   CCAFBUFR+92                                              02948000
@NM00013 EQU   CCAFBUFR+88                                              02949000
@NM00012 EQU   CCAFBUFR+84                                              02950000
CCA4BFSZ EQU   CCAFBUFR+80                                              02951000
CCATBFSZ EQU   CCAFBUFR+76                                              02952000
CCAWBFSZ EQU   CCAFBUFR+72                                              02953000
CCAQBFSZ EQU   CCAFBUFR+68                                              02954000
CCAPBFSZ EQU   CCAFBUFR+64                                              02955000
CCAVBFSZ EQU   CCAFBUFR+60                                              02956000
CCACBFSZ EQU   CCAFBUFR+56                                              02957000
@NM00011 EQU   CCAFBUFR+52                                              02958000
CCA4BFOA EQU   CCAFBUFR+48                                              02959000
CCA4BFIA EQU   CCAFBUFR+44                                              02960000
CCATBFIA EQU   CCAFBUFR+40                                              02961000
CCAWBFOA EQU   CCAFBUFR+36                                              02962000
CCAWBFIA EQU   CCAFBUFR+32                                              02963000
CCAQBFOA EQU   CCAFBUFR+28                                              02964000
CCAQBFIA EQU   CCAFBUFR+24                                              02965000
CCAPBFOA EQU   CCAFBUFR+20                                              02966000
CCAPBFIA EQU   CCAFBUFR+16                                              02967000
CCAVBFOA EQU   CCAFBUFR+12                                              02968000
CCAVBFIA EQU   CCAFBUFR+8                                               02969000
CCACBFOA EQU   CCAFBUFR+4                                               02970000
CCACBFIA EQU   CCAFBUFR                                                 02971000
CCAID    EQU   HMASMCCA                                                 02972000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02973000
@RF00272 EQU   @EL00002                                                 02974000
@RF00322 EQU   @EL00003                                                 02975000
@RC00297 EQU   @EL00003                                                 02976000
@RF00343 EQU   @EL00004                                                 02977000
@RC00361 EQU   @EL00004                                                 02978000
@RC00437 EQU   @EL00004                                                 02979000
@RC00461 EQU   @EL00004                                                 02980000
@RC00481 EQU   @EL00004                                                 02981000
@RF00480 EQU   @EL00004                                                 02982000
@RF00509 EQU   @EL00005                                                 02983000
@RC00507 EQU   @EL00005                                                 02984000
@RC00513 EQU   @EL00005                                                 02985000
@RF00523 EQU   @EL00007                                                 02986000
@RF00310 EQU   @RC00297                                                 02987000
@RC00300 EQU   @RC00297                                                 02988000
@RC00439 EQU   @RC00437                                                 02989000
@ENDDATA EQU   *                                                        02990000
         END   HMASMUC3,(C'PLS2226',0802,78334)                         02991000
