         TITLE 'IRARMEVT - SYSTEM RESOURCES MANAGER SYSEVENT PROCESSORS*00001000
               S        '                                               00002000
IRARMEVT CSECT ,                                                   0001 00003000
@MAINENT BALR  @15,0                                               0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT-2)                                 00007000
IRARMXVT BALR  @15,0                                               0001 00008000
         USING *,@15                                               0001 00009000
         B     @PROLOG                                             0001 00010000
         DC    AL2(@EP00168-IRARMXVT-2)                                 00011000
         ENTRY IRARMXVT                                                 00012000
         DROP  @15                                                      00013000
@PROLOG  BALR  @08,0                                               0001 00014000
@PSTART  LA    @09,4095(,@08)                                      0001 00015000
         USING @PSTART,@08                                         0001 00016000
         USING @PSTART+4095,@09                                    0001 00017000
         AH    @15,4(,@15)                                         0001 00018000
         BR    @15                                                 0001 00019000
@EP00001 DS    0H                                                  0002 00020000
*                                                                  0164 00021000
*/*                                                                  */ 00022000
*/*   SYSEVENT ROUTER TO PASS CONTROL TO THE APPROPRIATE             */ 00023000
*/*   SYSEVENT PROCESSOR.                                            */ 00024000
*/*                                                                  */ 00025000
*                                                                  0164 00026000
*IRARMRVT:                          /* ENTRY POINT FOR SYSEVENT RETRY*/ 00027000
*   SVEREG=RMCTRMSA;                /* SRM SAVE AREA START ADDRESS   */ 00028000
IRARMRVT L     SVEREG,RMCTRMSA(,RMCTPTR)                           0164 00029000
*   RRPAEPA=ADDR(RMEPBEVT);         /* ADDRESS OF ENTRY POINT BLOCK     00030000
*                                      FOR THIS MODULE FOR RECOVERY  */ 00031000
         LA    @12,RMEPBEVT(,RMCTPTR)                              0165 00032000
         ST    @12,RRPAEPA(,RRPAPTR)                               0165 00033000
*   GOTO PROCESSR;                  /* PROCESS CURRENT SYSEVENT      */ 00034000
         SLR   @12,@12                                             0166 00035000
         IC    @12,RRPACOD(,RRPAPTR)                               0166 00036000
         SLA   @12,2                                               0166 00037000
         L     @12,IRAPRCSR-4(@12)                                 0166 00038000
         BR    @12                                                 0166 00039000
*   RESPECIFY                                                      0167 00040000
*     OUXBPTR UNRSTD;                                              0167 00041000
*                                                                  0168 00042000
*/*                                                                  */ 00043000
*/* SETUP THE ENVIRONMENT REQUIRED TO RETRY THE SYSEVENT THAT WAS    */ 00044000
*/* BEING PROCESSED WHEN A SYSTEM ERROR OCCURRED.                    */ 00045000
*/*                                                                  */ 00046000
*                                                                  0168 00047000
*IRARMXVT:                                                         0168 00048000
*   ENTRY;                                                         0168 00049000
@EP00168 DS    0H                                                  0169 00050000
*   IF RRPAASD^=ZERO&               /* IF ASID DEFINED               */ 00051000
*       RRPAASD<=ASVTMAXU&          /* WITHIN THE ASVT AND           */ 00052000
*       ASVTENTY(RRPAASD)>ZERO THEN /* ASCB ADDRESS VALID,           */ 00053000
         LH    @12,RRPAASD(,RRPAPTR)                               0169 00054000
         N     @12,@CF02678                                        0169 00055000
         LTR   @12,@12                                             0169 00056000
         BZ    @RF00169                                            0169 00057000
         L     @11,CVTPTR                                          0169 00058000
         L     @11,ASVTPTR(,@11)                                   0169 00059000
         C     @12,ASVTMAXU(,@11)                                  0169 00060000
         BH    @RF00169                                            0169 00061000
         SLA   @12,2                                               0169 00062000
         L     @12,ASVTENTY-4(@12,@11)                             0169 00063000
         LTR   @12,@12                                             0169 00064000
         BNP   @RF00169                                            0169 00065000
*     ASCBPTR=ASVTENTY(RRPAASD);    /* ADDRESSABILITY TO ASCB        */ 00066000
         LR    ASCBPTR,@12                                         0170 00067000
*   ELSE                            /* ASID INVALID                  */ 00068000
*     DO;                           /* TERMINATE USER                */ 00069000
         B     @RC00169                                            0171 00070000
@RF00169 DS    0H                                                  0172 00071000
*       RESNCODE=CON4;              /* ABEND REASON CODE             */ 00072000
*                                                                  0172 00073000
         LA    RESNCODE,4                                          0172 00074000
*       /*************************************************************/ 00075000
*       /*                                                           */ 00076000
*       /* ? IRACTLCL EPN(I10)                                       */ 00077000
*       /*                                                           */ 00078000
*       /*************************************************************/ 00079000
*                                                                  0173 00080000
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */ 00081000
         L     @15,RMSBI10(,RMCTPTR)                               0173 00082000
         BALR  @14,@15                                             0173 00083000
*     END;                                                         0174 00084000
*   OUCBPTR=ASCBOUCB;               /* ADDRESSABILITY TO OUCB        */ 00085000
@RC00169 L     OUCBPTR,ASCBOUCB(,ASCBPTR)                          0175 00086000
*   GOTO IRARMRVT;                  /* GO RETRY SYSEVENT             */ 00087000
         B     IRARMRVT                                            0176 00088000
*                                                                  0177 00089000
*/* **************************************************************** */ 00090000
*/*                                                                  */ 00091000
*/* ENTRY POINT NAME = IRARMDEL                                      */ 00092000
*/*                                                                  */ 00093000
*/* DESCRIPTIVE NAME = SYSTEM RESOURCES MANAGER FREE OUCB AND OUXB   */ 00094000
*/*                    STORAGE ROUTINE                               */ 00095000
*/*                                                                  */ 00096000
*/* FUNCTION = TO RELEASE THE STORAGE FOR THE OUCB AND OUXB WHEN A   */ 00097000
*/*            MEMORY IS BEING TERMINATED, AND TO NOTIFY THE ISSUER  */ 00098000
*/*            OF SYSEVENT 7(MEMDEL) TO CONTINUE MEMORY TERMINATION. */ 00099000
*/*            NOTE: IRARMDEL IS AN 'ACTION' ROUTINE THAT IS         */ 00100000
*/*                  EXECUTED UNDER THE SRM LOCK             @Z40BPJE*/ 00101000
*/* LINKAGE = REG  1 - RMEP BLOCK ADDRESS OF IRARMDEL FOR RECOVERY   */ 00102000
*/*           REG  2 - RMCT ADDRESS                                  */ 00103000
*/*           REG  3 - RRPA ADDRESS                                  */ 00104000
*/*           REG 14 - RETURN POINT ADDRESS                          */ 00105000
*/*           REG 15 - ENTRY POINT ADDRESS                           */ 00106000
*/*                                                                  */ 00107000
*/* INPUT = REG  4 - OUCB ADDRESS OF MEMORY THAT IS BEING TERMINATED */ 00108000
*/*                                                                  */ 00109000
*/* OUTPUT = NONE                                                    */ 00110000
*/*                                                                  */ 00111000
*/*                                                                  */ 00112000
*/* EXIT-NORMAL = RETURN VIA REG 14                                  */ 00113000
*/*                                                                  */ 00114000
*/* **************************************************************** */ 00115000
*                                                                  0177 00116000
*   /*****************************************************************/ 00117000
*   /*                                                               */ 00118000
*   /* ? IRACTLEP EPN(DEL)CODEREG(8)SAVE(0,14)                       */ 00119000
*   /*                                                               */ 00120000
*   /*****************************************************************/ 00121000
*                                                                  0177 00122000
*   DCL                                                            0177 00123000
*     IRARMDEL ENTRY INT;                                          0177 00124000
*   GEN CODE REFS(RMCTRMSA,RRPAEPA) DEFS(IRARMDEL) NOEXIT SEQFLOW; 0178 00125000
*                                  /*                                   00126000
         ENTRY IRARMDEL                                                 00127000
IRARMDEL DS    0H                                                       00128000
         L     @15,RMCTRMSA(,RMCTPTR)  SRM SAVE AREA START ADDRESS      00129000
         STM   @00,@14,064+000(@15)    SAVE INVOKING RTNE REGS          00130000
         MVC   064+060(4,@15),RRPAEPA(RRPAPTR) SAVE PREV RMEP           00131000
         ST    @01,RRPAEPA(,RRPAPTR)   INDICATE NEW CURRENT RMEP        00132000
         LR    @13,@15                 ROUTINE SAVE AREA ADDRESS        00133000
         BALR  @15,0                   SETUP ENTRY ADDRESSABILITY       00134000
         LA    @08,*-@PSTART           DISPLACEMENT TO MODULE BASE      00135000
         LCR   @08,@08                 NEGATIVE FOR SUBTRACT            00136000
         ALR   @08,@15                 SETUP MODULE ADDRESSABILITY      00137000
*   OUCBFWD->OUCBBCK=OUCBBCK;       /* UPDATE BACK CHAIN PTR         */ 00138000
         L     @12,OUCBFWD(,OUCBPTR)                               0179 00139000
         L     @11,OUCBBCK(,OUCBPTR)                               0179 00140000
         ST    @11,OUCBBCK(,@12)                                   0179 00141000
*   OUCBBCK->OUCBFWD=OUCBFWD;       /* UPDATE FORWARD CHAIN PTR      */ 00142000
         ST    @12,OUCBFWD(,@11)                                   0180 00143000
*   IF OUCBOUT='0'B THEN            /* IF USER NOT ALREADY OUT       */ 00144000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0181 00145000
         BNZ   @RF00181                                            0181 00146000
*     RMCAINUS=RMCAINUS-ONE;        /* DECREMENT NO. OF MEMORIES IN     00147000
*                                      STORAGE                       */ 00148000
         LH    @12,RMCAINUS(,RMCTPTR)                              0182 00149000
         BCTR  @12,0                                               0182 00150000
         STH   @12,RMCAINUS(,RMCTPTR)                              0182 00151000
*   IF OUCBGOI='1'B THEN            /* IF MEMORY ON WAY INTO CORE  0183 00152000
*                                                            @Z40BPJE*/ 00153000
@RF00181 TM    OUCBGOI(OUCBPTR),B'01000000'                        0183 00154000
         BNO   @RF00183                                            0183 00155000
*     RMCACIUS=RMCACIUS-ONE;        /* DECREMENT COUNT OF USERS THAT    00156000
*                                      ARE COMING INTO CORE. @Z40BPJE*/ 00157000
         LH    @12,RMCACIUS(,RMCTPTR)                              0184 00158000
         BCTR  @12,0                                               0184 00159000
         STH   @12,RMCACIUS(,RMCTPTR)                              0184 00160000
*   ASCBPTR=OUCBASCB;               /* ADDRESSABILITY TO ASCB        */ 00161000
@RF00183 L     ASCBPTR,OUCBASCB(,OUCBPTR)                          0185 00162000
*   ASCBOUCB=ZERO;                                                 0186 00163000
         SLR   @12,@12                                             0186 00164000
         ST    @12,ASCBOUCB(,ASCBPTR)                              0186 00165000
*   OUCBINV='1'B;                   /* OUCB INVALID          @Z40BPCH*/ 00166000
         OI    OUCBINV(OUCBPTR),B'00010000'                        0187 00167000
*   OUCBASCB=ZERO;                                                 0188 00168000
         ST    @12,OUCBASCB(,OUCBPTR)                              0188 00169000
*   R0=LENGTH(OUCB);                /* SIZE OF STORAGE TO FREE       */ 00170000
         LA    R0,136                                              0189 00171000
*   R1=OUCBPTR;                     /* ADDRESS OF STORAGE TO FREE    */ 00172000
*                                                                  0190 00173000
         LR    R1,OUCBPTR                                          0190 00174000
*   /*****************************************************************/ 00175000
*   /*                                                               */ 00176000
*   /* ? IRACTLCL EPN(I04)                                           */ 00177000
*   /*                                                               */ 00178000
*   /*****************************************************************/ 00179000
*                                                                  0191 00180000
*   CALL RMSBI04->IRARMRTN;         /* INVOKE I04 SUBRTN             */ 00181000
*                                                                  0191 00182000
         L     @15,RMSBI04(,RMCTPTR)                               0191 00183000
         BALR  @14,@15                                             0191 00184000
*   /*****************************************************************/ 00185000
*   /*                                                               */ 00186000
*   /* FREE STORAGE                                                  */ 00187000
*   /*                                                               */ 00188000
*   /*****************************************************************/ 00189000
*                                                                  0192 00190000
*   R0=LENGTH(OUXB);                /* SIZE OF STORAGE TO FREE       */ 00191000
         LA    R0,144                                              0192 00192000
*   R1=ASCBOUXB;                    /* ADDRESS OF STORAGE TO FREE    */ 00193000
         L     R1,ASCBOUXB(,ASCBPTR)                               0193 00194000
*   ASCBOUXB=ZERO;                  /* OUXB INVALID                  */ 00195000
*                                                                  0194 00196000
         SLR   @12,@12                                             0194 00197000
         ST    @12,ASCBOUXB(,ASCBPTR)                              0194 00198000
*   /*****************************************************************/ 00199000
*   /*                                                               */ 00200000
*   /* ? IRACTLCL EPN(I04)                                           */ 00201000
*   /*                                                               */ 00202000
*   /*****************************************************************/ 00203000
*                                                                  0195 00204000
*   CALL RMSBI04->IRARMRTN;         /* INVOKE I04 SUBRTN             */ 00205000
*                                                                  0195 00206000
         L     @15,RMSBI04(,RMCTPTR)                               0195 00207000
         BALR  @14,@15                                             0195 00208000
*   /*****************************************************************/ 00209000
*   /*                                                               */ 00210000
*   /* FREE STORAGE                                                  */ 00211000
*   /*                                                               */ 00212000
*   /*****************************************************************/ 00213000
*                                                                  0196 00214000
*   R0=ZERO;                        /* SET POST CODE         @ZA16877*/ 00215000
         SLR   R0,R0                                               0196 00216000
*   R1=ADDR(ASCBMECB);              /* ECB ADDRESS TO XMPOST         */ 00217000
         LA    R1,ASCBMECB(,ASCBPTR)                               0197 00218000
*   ASCBPTR=RMCAMAS;                /* WILL POST MASTER SCHEDULER    */ 00219000
*                                                                  0198 00220000
         L     ASCBPTR,RMCAMAS(,RMCTPTR)                           0198 00221000
*   /*****************************************************************/ 00222000
*   /*                                                               */ 00223000
*   /* ? IRACTLCL EPN(I06)                                           */ 00224000
*   /*                                                               */ 00225000
*   /*****************************************************************/ 00226000
*                                                                  0199 00227000
*   CALL RMSBI06->IRARMRTN;         /* INVOKE I06 SUBRTN             */ 00228000
*                                                                  0199 00229000
         L     @15,RMSBI06(,RMCTPTR)                               0199 00230000
         BALR  @14,@15                                             0199 00231000
*   /*****************************************************************/ 00232000
*   /*                                                               */ 00233000
*   /* ISSUE XMPOST                                                  */ 00234000
*   /*                                                               */ 00235000
*   /*****************************************************************/ 00236000
*                                                                  0200 00237000
*   IF RRPASVC='1'B&                /* SRM INVOKED VIA TYPE-1 SVC    */ 00238000
*       RRPACOD^=SYSEVT48 THEN      /* AND NOT INVOKED BY SRM SRB,   */ 00239000
         TM    RRPASVC(RRPAPTR),B'00100000'                        0200 00240000
         BNO   @RF00200                                            0200 00241000
         CLI   RRPACOD(RRPAPTR),48                                 0200 00242000
         BE    @RF00200                                            0200 00243000
*     RRPARTN=CVTEXP1;              /* FORCE EXIT THRU DISPATCHER    */ 00244000
*                                                                  0201 00245000
         L     @12,CVTPTR                                          0201 00246000
         L     @12,CVTEXP1(,@12)                                   0201 00247000
         ST    @12,RRPARTN(,RRPAPTR)                               0201 00248000
*   /*****************************************************************/ 00249000
*   /*                                                               */ 00250000
*   /* ? IRACTLEP ENN(DEL)                                           */ 00251000
*   /*                                                               */ 00252000
*   /*****************************************************************/ 00253000
*                                                                  0202 00254000
*   GEN CODE EXIT NOSEQFLOW;                                       0202 00255000
@RF00200 DS    0H                                                  0202 00256000
*                                  /*                                   00257000
         MVC   RRPAEPA(4,RRPAPTR),064+060(@13) RESTORE PREV RMEP        00258000
         LM    @00,@14,064+000(@13)    RELOAD INVOKING RTNE REGS        00259000
         BR    RTNREG                  RETURN TO INVOKER                00260000
*                                                                  0203 00261000
*/* **************************************************************** */ 00262000
*/*                                                                  */ 00263000
*/* ENTRY POINT NAME = IRARMIPS                                      */ 00264000
*/*                                                                  */ 00265000
*/* DESCRIPTIVE NAME = SYSTEM RESOURCES MANAGER SWITCH TO NEW        */ 00266000
*/*                    INTERNAL PERFORMANCE SPECIFICATION(IPS)       */ 00267000
*/*                    RESIDENT SUBROUTINE                           */ 00268000
*/*                                                                  */ 00269000
*/* FUNCTION = TO INVOKE THE NON-RESIDENT PORTION OF THE SWITCH TO   */ 00270000
*/*            NEW IPS SUBROUTINE.                                   */ 00271000
*/*            NOTE:  IRARMIPS IS AN 'ACTION' ROUTINE THAT IS        */ 00272000
*/*                   EXECUTED UNDER THE SRM LOCK            @Z40BPJE*/ 00273000
*/*                                                                  */ 00274000
*/* LINKAGE = REG  1 - RMEP BLOCK ADDRESS OF IRARMIPS FOR RECOVERY   */ 00275000
*/*           REG  2 - RMCT ADDRESS                                  */ 00276000
*/*           REG  3 - RRPA ADDRESS                                  */ 00277000
*/*           REG 14 - RETURN POINT ADDRESS                          */ 00278000
*/*           REG 15 - ENTRY POINT ADDRESS                           */ 00279000
*/*                                                                  */ 00280000
*/* INPUT = WMSTNWST - ADDRESS OF THE NEW IPS                        */ 00281000
*/*                                                                  */ 00282000
*/* OUTPUT = NONE                                                    */ 00283000
*/*                                                                  */ 00284000
*/* EXIT-NORMAL = RETURN VIA REG 14                                  */ 00285000
*/*                                                                  */ 00286000
*/* **************************************************************** */ 00287000
*                                                                  0203 00288000
*IRARMXPS:                          /* ENTRY POINT IF SET TO NEW IPS    00289000
*                                      PROCESSING HAS FAILED         */ 00290000
*                                                                  0203 00291000
*   /*****************************************************************/ 00292000
*   /*                                                               */ 00293000
*   /* ? IRACTLEP EPN(IPS)CODEREG(8)SAVE(0,14)                       */ 00294000
*   /*                                                               */ 00295000
*   /*****************************************************************/ 00296000
*                                                                  0203 00297000
*   DCL                                                            0203 00298000
*     IRARMIPS ENTRY INT;                                          0203 00299000
IRARMXPS DS    0H                                                  0204 00300000
*   GEN CODE REFS(RMCTRMSA,RRPAEPA) DEFS(IRARMIPS) NOEXIT SEQFLOW; 0204 00301000
*                                  /*                                   00302000
         ENTRY IRARMIPS                                                 00303000
IRARMIPS DS    0H                                                       00304000
         L     @15,RMCTRMSA(,RMCTPTR)  SRM SAVE AREA START ADDRESS      00305000
         STM   @00,@14,064+000(@15)    SAVE INVOKING RTNE REGS          00306000
         MVC   064+060(4,@15),RRPAEPA(RRPAPTR) SAVE PREV RMEP           00307000
         ST    @01,RRPAEPA(,RRPAPTR)   INDICATE NEW CURRENT RMEP        00308000
         LR    @13,@15                 ROUTINE SAVE AREA ADDRESS        00309000
         BALR  @15,0                   SETUP ENTRY ADDRESSABILITY       00310000
         LA    @08,*-@PSTART           DISPLACEMENT TO MODULE BASE      00311000
         LCR   @08,@08                 NEGATIVE FOR SUBTRACT            00312000
         ALR   @08,@15                 SETUP MODULE ADDRESSABILITY      00313000
*   RRPAIPS='1'B;                   /* IRARMSET ROUTINE IN CONTROL   */ 00314000
         OI    RRPAIPS(RRPAPTR),B'00100000'                        0205 00315000
*/*                                                                  */ 00316000
*/*   INVOKE IRARMSET TO SWITCH TO THE NEW IPS.                      */ 00317000
*/*                                                                  */ 00318000
*                                                                  0206 00319000
*   /*****************************************************************/ 00320000
*   /*                                                               */ 00321000
*   /* ? IRACTLCL EPN(SET)                                           */ 00322000
*   /*                                                               */ 00323000
*   /*****************************************************************/ 00324000
*                                                                  0206 00325000
*   CALL RMSBSET->IRARMRTN;         /* INVOKE SET SUBRTN             */ 00326000
         L     @15,RMSBSET(,RMCTPTR)                               0206 00327000
         BALR  @14,@15                                             0206 00328000
*   RRPAIPS='0'B;                   /* IRARMSET NO LONGER IN CONTROL */ 00329000
         NI    RRPAIPS(RRPAPTR),B'11011111'                        0207 00330000
*   RMSBSET=RMSBNOP;                /* RESET ROUTINE ADDRESS         */ 00331000
*                                                                  0208 00332000
         L     @12,RMSBNOP(,RMCTPTR)                               0208 00333000
         ST    @12,RMSBSET(,RMCTPTR)                               0208 00334000
*   /*****************************************************************/ 00335000
*   /*                                                               */ 00336000
*   /* ? IRACTLEP ENN(IPS)                                           */ 00337000
*   /*                                                               */ 00338000
*   /*****************************************************************/ 00339000
*                                                                  0209 00340000
*   GEN CODE EXIT NOSEQFLOW;                                       0209 00341000
*                                  /*                                   00342000
         MVC   RRPAEPA(4,RRPAPTR),064+060(@13) RESTORE PREV RMEP        00343000
         LM    @00,@14,064+000(@13)    RELOAD INVOKING RTNE REGS        00344000
         BR    RTNREG                  RETURN TO INVOKER                00345000
*                                                                  0210 00346000
*/* **************************************************************** */ 00347000
*/*                                                                  */ 00348000
*/* ENTRY POINT NAME = IRARMUXB                                      */ 00349000
*/*                                                                  */ 00350000
*/* DESCRIPTIVE NAME = SYSTEM RESOURCES MANAGER FREE OUXB            */ 00351000
*/*                    STORAGE ROUTINE                               */ 00352000
*/*                                                                  */ 00353000
*/* FUNCTION = TO RELEASE THE STORAGE FOR THE OUXB(SQA) DURING THE   */ 00354000
*/*            INTERVAL THE MEMORY IS OUT OF STORAGE, TO NOTIFY THE  */ 00355000
*/*            ISSUER OF SYSEVENT 43(REQSWAP) THAT THE SWAPOUT-SWAPIN*/ 00356000
*/*            IS COMPLETE, AND TO MAKE A MEMORY IN LONG WAIT        */ 00357000
*/*            ELIGIBLE TO BE SWAPPED IN IF A SYSEVENT 4(USERRDY)    */ 00358000
*/*            HAS BEEN RECEIVED.                                    */ 00359000
*/*            NOTE:  IRARMUXB IS AN 'ACTION' ROUTINE THAT IS        */ 00360000
*/*                   EXECUTED UNDER THE SRM LOCK            @Z40BPJE*/ 00361000
*/*                                                                  */ 00362000
*/* LINKAGE = REG  1 - RMEP BLOCK ADDRESS OF IRARMUXB FOR RECOVERY   */ 00363000
*/*           REG  2 - RMCT ADDRESS                                  */ 00364000
*/*           REG  3 - RRPA ADDRESS                                  */ 00365000
*/*           REG 14 - RETURN POINT ADDRESS                          */ 00366000
*/*           REG 15 - ENTRY POINT ADDRESS                           */ 00367000
*/*                                                                  */ 00368000
*/* INPUT = REG  4 - OUCB ADDRESS OF MEMORY THAT WAS SWAPPED OUT     */ 00369000
*/*                                                                  */ 00370000
*/* OUTPUT = NONE                                                    */ 00371000
*/*                                                                  */ 00372000
*/* EXIT-NORMAL = RETURN VIA REG 14                                  */ 00373000
*/*                                                                  */ 00374000
*/* **************************************************************** */ 00375000
*                                                                  0210 00376000
*   /*****************************************************************/ 00377000
*   /*                                                               */ 00378000
*   /* ? IRACTLEP EPN(UXB)CODEREG(8)SAVE(0,14)                       */ 00379000
*   /*                                                               */ 00380000
*   /*****************************************************************/ 00381000
*                                                                  0210 00382000
*   DCL                                                            0210 00383000
*     IRARMUXB ENTRY INT;                                          0210 00384000
*   GEN CODE REFS(RMCTRMSA,RRPAEPA) DEFS(IRARMUXB) NOEXIT SEQFLOW; 0211 00385000
*                                  /*                                   00386000
         ENTRY IRARMUXB                                                 00387000
IRARMUXB DS    0H                                                       00388000
         L     @15,RMCTRMSA(,RMCTPTR)  SRM SAVE AREA START ADDRESS      00389000
         STM   @00,@14,064+000(@15)    SAVE INVOKING RTNE REGS          00390000
         MVC   064+060(4,@15),RRPAEPA(RRPAPTR) SAVE PREV RMEP           00391000
         ST    @01,RRPAEPA(,RRPAPTR)   INDICATE NEW CURRENT RMEP        00392000
         LR    @13,@15                 ROUTINE SAVE AREA ADDRESS        00393000
         BALR  @15,0                   SETUP ENTRY ADDRESSABILITY       00394000
         LA    @08,*-@PSTART           DISPLACEMENT TO MODULE BASE      00395000
         LCR   @08,@08                 NEGATIVE FOR SUBTRACT            00396000
         ALR   @08,@15                 SETUP MODULE ADDRESSABILITY      00397000
*   RESPECIFY                                                      0212 00398000
*    (BASE1,                                                       0212 00399000
*     BASE2) RESTRICTED;            /*                       @YM05628*/ 00400000
*   BASE2=BASE1+CON4095;            /* INITIALIZE BASE REG2  @YM05628*/ 00401000
         LA    BASE2,4095                                          0213 00402000
         ALR   BASE2,BASE1                                         0213 00403000
*   RESPECIFY                                                      0214 00404000
*    (BASE1,                                                       0214 00405000
*     BASE2) UNRESTRICTED;          /*                       @YM05628*/ 00406000
*   RFY                                                            0215 00407000
*     OUXBPTR RSTD;                                                0215 00408000
*   ASCBPTR=OUCBASCB;               /* ADDRESSABILITY TO ASCB        */ 00409000
         L     ASCBPTR,OUCBASCB(,OUCBPTR)                          0216 00410000
*   IF ASCBOUXB^=RMCTOUXB           /* CANNOT FREE PRE-DEFINED OUXB  */ 00411000
*       &OUCBOUT='1'B               /* OR OUXB OF USER IN OR ON THE  */ 00412000
*       &OUCBGOI='0'B THEN          /* WAY INTO MAIN STORAGE         */ 00413000
         L     @12,ASCBOUXB(,ASCBPTR)                              0217 00414000
         C     @12,RMCTOUXB(,RMCTPTR)                              0217 00415000
         BE    @RF00217                                            0217 00416000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0217 00417000
         BNO   @RF00217                                            0217 00418000
         TM    OUCBGOI(OUCBPTR),B'01000000'                        0217 00419000
         BNZ   @RF00217                                            0217 00420000
*     DO;                                                          0218 00421000
*       OUXBPTR=ASCBOUXB;           /* ADDRESSABILITY TO OUXB        */ 00422000
*                                                                  0219 00423000
         LR    OUXBPTR,@12                                         0219 00424000
*       /*************************************************************/ 00425000
*       /*                                                           */ 00426000
*       /* FINISH TRANSWAP                                   @ZA16887*/ 00427000
*       /*                                                           */ 00428000
*       /*************************************************************/ 00429000
*                                                                  0220 00430000
*       IF OUCBTSWP='1'B THEN       /* TRANSWAP IN PROGRESS? @ZA16887*/ 00431000
         TM    OUCBTSWP(OUCBPTR),B'00010000'                       0220 00432000
         BNO   @RF00220                                            0220 00433000
*         DO;                       /* FINISH IT             @ZA16887*/ 00434000
*           OUCBNSW='1'B;           /* SET A.S. NONSWAPPABLE @ZA16887*/ 00435000
         OI    OUCBNSW(OUCBPTR),B'10000000'                        0222 00436000
*           OUCBNDS=OUCBNDS+OUCBNTSP+ONE;/* INCREMENT COUNT BY NUMBER   00437000
*                                      OF TRANSWAPS PENDING  @ZA16887*/ 00438000
         LH    @12,OUCBNDS(,OUCBPTR)                               0223 00439000
         AH    @12,OUCBNTSP(,OUCBPTR)                              0223 00440000
         AL    @12,@CF00078                                        0223 00441000
         STH   @12,OUCBNDS(,OUCBPTR)                               0223 00442000
*           IF OUCBNDS<ZERO THEN    /* COUNT EXCEEDS MAX?    @ZA20975*/ 00443000
         LH    @12,OUCBNDS(,OUCBPTR)                               0224 00444000
         LTR   @12,@12                                             0224 00445000
         BNM   @RF00224                                            0224 00446000
*             OUCBNDS=CON32767;     /* SET TO MAX VALUE      @ZA16887*/ 00447000
         MVC   OUCBNDS(2,OUCBPTR),@CH02502                         0225 00448000
*           IF OUCBNDS=ONE THEN     /* SWAP STATUS CHNGD?    @ZA16887*/ 00449000
*                                                                  0226 00450000
@RF00224 CLC   OUCBNDS(2,OUCBPTR),@CH00078                         0226 00451000
         BNE   @RF00226                                            0226 00452000
*             /*******************************************************/ 00453000
*             /*                                                     */ 00454000
*             /* ? IRACTLCL EPN(WMK)                                 */ 00455000
*             /*                                                     */ 00456000
*             /*******************************************************/ 00457000
*                                                                  0227 00458000
*             CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN            */ 00459000
*                                                                  0227 00460000
         L     @15,RMSBWMK(,RMCTPTR)                               0227 00461000
         BALR  @14,@15                                             0227 00462000
*           /*********************************************************/ 00463000
*           /*                                                       */ 00464000
*           /* LET WLM KNOW                                  @ZA16887*/ 00465000
*           /*                                                       */ 00466000
*           /*********************************************************/ 00467000
*                                                                  0228 00468000
*           OUCBTSWC='1'B;          /* INDICATE TRANSWAP COMPL     0228 00469000
*                                                            @ZA16887*/ 00470000
@RF00226 OI    OUCBTSWC(OUCBPTR),B'00001000'                       0228 00471000
*         END;                      /* END TRANSWAP CASE     @ZA20975*/ 00472000
*                                                                  0229 00473000
*       /*************************************************************/ 00474000
*       /*                                                           */ 00475000
*       /* POST ALL ISSUERS OF REQSWAP OR TRANSWAP, IF NEEDED.       */ 00476000
*       /*                                                   @ZA20975*/ 00477000
*       /*                                                           */ 00478000
*       /*************************************************************/ 00479000
*                                                                  0230 00480000
*       IF OUCBRSWP='1'B|OUCBTSWP='1'B THEN/* POSTING NEEDED?      0230 00481000
*                                                            @ZA20975*/ 00482000
@RF00220 TM    OUCBRSWP(OUCBPTR),B'00110000'                       0230 00483000
         BZ    @RF00230                                            0230 00484000
*         DO;                       /* POSSIBLY...           @ZA20975*/ 00485000
*           R0=ZERO;                /* I06 WILL POST WITH 0  @ZA20975*/ 00486000
         SLR   R0,R0                                               0232 00487000
*           CALL EVTENDSW;          /* SUBROUTINE DOES POST  @ZA20975*/ 00488000
         BAL   @14,EVTENDSW                                        0233 00489000
*         END;                      /* DONE POSTING.         @ZA20975*/ 00490000
*       R0=LENGTH(OUXB);            /* LENGTH OF STORAGE AREA        */ 00491000
@RF00230 LA    R0,144                                              0235 00492000
*       R1=OUXBPTR;                 /* ADDRESS OF STORAGE AREA       */ 00493000
*                                                                  0236 00494000
         LR    R1,OUXBPTR                                          0236 00495000
*       /*************************************************************/ 00496000
*       /*                                                           */ 00497000
*       /* ? IRACTLCL EPN(I04)                                       */ 00498000
*       /*                                                           */ 00499000
*       /*************************************************************/ 00500000
*                                                                  0237 00501000
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */ 00502000
*                                                                  0237 00503000
         L     @15,RMSBI04(,RMCTPTR)                               0237 00504000
         BALR  @14,@15                                             0237 00505000
*       /*************************************************************/ 00506000
*       /*                                                           */ 00507000
*       /* FREE STORAGE PROVIDE DUMMY AREA FOR OUXB WHILE MEMORY IS  */ 00508000
*       /* SWAPPED OUT TO PREVENT THE DESTRUCTION OF VALID           */ 00509000
*       /* INFORMATION IF AN ATTEMPT TO REFERENCE THE OUXB OCCURS    */ 00510000
*       /* WHILE THE MEMORY IS OUT OF MAIN STORAGE.                  */ 00511000
*       /*                                                           */ 00512000
*       /*************************************************************/ 00513000
*                                                                  0238 00514000
*       ASCBOUXB=RMCTOUXB;                                         0238 00515000
         L     @12,RMCTOUXB(,RMCTPTR)                              0238 00516000
         ST    @12,ASCBOUXB(,ASCBPTR)                              0238 00517000
*     END;                                                         0239 00518000
*                                                                  0239 00519000
*   /*****************************************************************/ 00520000
*   /*                                                               */ 00521000
*   /* CHAP USERS TO SWAP IN PRIORITY FOR NEW TSO TRANSACTIONS IN THE*/ 00522000
*   /* APG, THAT IS THE PRIORITY OF THE FIRST PERFORMANCE GROUP      */ 00523000
*   /* PERIOD. FOR OTHER USERS IN THE MTW, THE SWAP IN PRIORITY IS   */ 00524000
*   /* THE TOP OF THE MTW.                                   @ZA19283*/ 00525000
*   /*                                                               */ 00526000
*   /*****************************************************************/ 00527000
*                                                                  0240 00528000
*   IF OUCBAPG='1'B THEN            /* USER IN APG           @YM05632*/ 00529000
@RF00217 TM    OUCBAPG(OUCBPTR),B'01000000'                        0240 00530000
         BNO   @RF00240                                            0240 00531000
*     IF OUCBINC='1'B               /* THIS IS A NEW TSO     @YM05632*/ 00532000
*         &OUCBATR='0'B             /* TRANSACTION           @YM05632*/ 00533000
*       THEN                                                       0241 00534000
         TM    OUCBINC(OUCBPTR),B'00000001'                        0241 00535000
         BNO   @RF00241                                            0241 00536000
         TM    OUCBATR(OUCBPTR),B'10000000'                        0241 00537000
         BNZ   @RF00241                                            0241 00538000
*       OUCBNDP=OUCBRDP;            /* USE INITIAL PRIORITY  @Z40BPJE*/ 00539000
         IC    @12,OUCBRDP(,OUCBPTR)                               0242 00540000
         STC   @12,OUCBNDP(,OUCBPTR)                               0242 00541000
*     ELSE                                                         0243 00542000
*       IF OUCBNDP<CCCAPGDP         /* IN MEAN TIME TO WAIT  @ZA19283*/ 00543000
*         THEN                                                     0243 00544000
         B     @RC00241                                            0243 00545000
@RF00241 LH    @12,CCCAPGDP(,RMCTPTR)                              0243 00546000
         SLR   @07,@07                                             0243 00547000
         IC    @07,OUCBNDP(,OUCBPTR)                               0243 00548000
         CR    @12,@07                                             0243 00549000
         BNH   @RF00243                                            0243 00550000
*         OUCBNDP=CCCAPGDP;         /* PUT AT TOP            @ZA19283*/ 00551000
         STC   @12,OUCBNDP(,OUCBPTR)                               0244 00552000
*   CALL EVTCHAP;                   /* CHAP USER FOR SWAPIN  @YM05632*/ 00553000
@RF00243 DS    0H                                                  0245 00554000
@RC00241 DS    0H                                                  0245 00555000
@RF00240 BAL   @14,EVTCHAP                                         0245 00556000
*   OUCBGOO='0'B;                   /* MEMORY OUT OF MAIN STORAGE    */ 00557000
         NI    OUCBGOO(OUCBPTR),B'01111111'                        0246 00558000
*   IF OUCBOFF='1'B&                /* MEMORY IS ON LONG WAIT QUEUE  */ 00559000
*       OUCBRDY='1'B THEN           /* USERRDY RECEIVED FOR MEMORY   */ 00560000
*                                                                  0247 00561000
         TM    OUCBOFF(OUCBPTR),B'00001000'                        0247 00562000
         BNO   @RF00247                                            0247 00563000
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0247 00564000
         BNO   @RF00247                                            0247 00565000
*     /***************************************************************/ 00566000
*     /*                                                             */ 00567000
*     /* ? IRACTLCL EPN(HIT)                                         */ 00568000
*     /*                                                             */ 00569000
*     /***************************************************************/ 00570000
*                                                                  0248 00571000
*     DO;                                                          0248 00572000
*       R1=ADDR(RMEPBHIT);          /* HIT REQUEST IS PARAM          */ 00573000
         LA    R1,RMEPBHIT(,RMCTPTR)                               0249 00574000
*       CALL RMSBCRN->IRARMRTN;     /* ACTION INVK FUNCT             */ 00575000
         L     @15,RMSBCRN(,RMCTPTR)                               0250 00576000
         BALR  @14,@15                                             0250 00577000
*     END;                          /* MAKE THE MEMORY ELIGIBLE FOR     00578000
*                                      SWAP IN               @Z40BPJE*/ 00579000
*   RFY                                                            0252 00580000
*     OUXBPTR UNRSTD;                                              0252 00581000
*                                                                  0252 00582000
@RF00247 DS    0H                                                  0253 00583000
*/*   ? IRACTLEP ENN(UXB)                                            */ 00584000
*                                                                  0253 00585000
*   GEN CODE EXIT NOSEQFLOW;                                       0253 00586000
*                                  /*                                   00587000
         MVC   RRPAEPA(4,RRPAPTR),064+060(@13) RESTORE PREV RMEP        00588000
         LM    @00,@14,064+000(@13)    RELOAD INVOKING RTNE REGS        00589000
         BR    RTNREG                  RETURN TO INVOKER                00590000
*                                                                  0254 00591000
*/***********************************************************@YM05632*/ 00592000
*/*                                                          @YM05632*/ 00593000
*/* EVTCHAP - IRARMEVT INTERNAL SUBROUTINE                   @YM05632*/ 00594000
*/*                                                          @YM05632*/ 00595000
*/* FUNCTION - BUILD CHAP PARAMETER LIST AND INVOKE ASCBCHAP @YM05632*/ 00596000
*/*                                                          @YM05632*/ 00597000
*/* INPUT -                                                  @YM05632*/ 00598000
*/*   ASCBPTR - ADDRESS OF ASCB TO BE CHAPPED                @YM05632*/ 00599000
*/*   OUCBNDP - NEW DISPATCHING PRIORITY                     @YM05632*/ 00600000
*/*                                                          @YM05632*/ 00601000
*/***********************************************************@YM05632*/ 00602000
*                                                                  0254 00603000
*EVTCHAP:                                                          0254 00604000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @YM05632*/ 00605000
EVTCHAP  DS    0H                                                  0255 00606000
*   RESPECIFY                                                      0255 00607000
*     WRKREG2 RSTD;                 /*                       @YM05632*/ 00608000
*   IF ASCBDP^=OUCBNDP THEN         /* TEST IF NEED CHAP     @Z30WIMG*/ 00609000
*                                                                  0256 00610000
         CLC   ASCBDP(1,ASCBPTR),OUCBNDP(OUCBPTR)                  0256 00611000
         BE    @RF00256                                            0256 00612000
*     /***************************************************************/ 00613000
*     /*                                                             */ 00614000
*     /* REPOSITION ADDRESS SPACE ON DISPATCHER READY QUEUE  @Z30WIMG*/ 00615000
*     /*                                                             */ 00616000
*     /***************************************************************/ 00617000
*                                                                  0257 00618000
*     DO;                           /*                       @Z30WIMG*/ 00619000
*       WRKREG2=RTNREG;             /* SAVE RETURN REGISTER  @YM05632*/ 00620000
         LR    WRKREG2,RTNREG                                      0258 00621000
*       CHAPASCB=ASCBPTR;           /* BUILD PARAMETER       @YM05632*/ 00622000
         ST    ASCBPTR,CHAPASCB                                    0259 00623000
*       CHAPDP=OUCBNDP;             /* LIST                  @YM05632*/ 00624000
         IC    @12,OUCBNDP(,OUCBPTR)                               0260 00625000
         STC   @12,CHAPDP                                          0260 00626000
*       R1=ADDR(CHAPLIST);          /* POINT TO PARM LIST    @YM05632   00627000
*                                      INVOKE ASCBCHAP       @YM05632*/ 00628000
*                                                                  0261 00629000
         LA    R1,CHAPLIST                                         0261 00630000
*       /*************************************************************/ 00631000
*       /*                                                           */ 00632000
*       /* ? IRACTLCL EPN(I02)                                       */ 00633000
*       /*                                                           */ 00634000
*       /*************************************************************/ 00635000
*                                                                  0262 00636000
*       CALL RMSBI02->IRARMRTN;     /* INVOKE I02 SUBRTN             */ 00637000
*                                                                  0262 00638000
         L     @15,RMSBI02(,RMCTPTR)                               0262 00639000
         BALR  @14,@15                                             0262 00640000
*       /*************************************************************/ 00641000
*       /*                                                           */ 00642000
*       /*                                                   @YM05632*/ 00643000
*       /*                                                           */ 00644000
*       /*************************************************************/ 00645000
*                                                                  0263 00646000
*       RTNREG=WRKREG2;             /* RESTORE RETURN REG    @YM05632*/ 00647000
         LR    RTNREG,WRKREG2                                      0263 00648000
*     END;                          /*                       @Z30WIMG*/ 00649000
*   RESPECIFY                                                      0265 00650000
*     WRKREG2 UNRSTD;               /*                       @YM05632*/ 00651000
*   END;                            /*                       @YM05632*/ 00652000
@EL00002 DS    0H                                                  0266 00653000
@EF00002 DS    0H                                                  0266 00654000
@ER00002 BR    @14                                                 0266 00655000
*                                                                  0267 00656000
*/***********************************************************@ZA16887*/ 00657000
*/*                                                          @ZA16887*/ 00658000
*/* EVTABEND -    SUBROUTINE  USED TO ABEND THE ISSUER OF A  @ZA16887*/ 00659000
*/*            SYSEVENT THAT ENCOUNTERED AN ERROR CONDITION. @ZA16887*/ 00660000
*/*            USE THIS FOR ABENDS OTHER THAN '15F' (USE I10 @ZA16887*/ 00661000
*/*            FOR '15F').                                   @ZA16887*/ 00662000
*/*   INPUT  - REG15=REASON CODE,  REG1=COMPLETION CODE      @ZA16887*/ 00663000
*/*                                                          @ZA16887*/ 00664000
*/***********************************************************@ZA16887*/ 00665000
*                                                                  0267 00666000
*EVTABEND:                          /*                       @ZA16687*/ 00667000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA16887*/ 00668000
EVTABEND DS    0H                                                  0268 00669000
*   GENERATE CODE(ABEND (1),DUMP,,SYSTEM);/*                 @ZA16887*/ 00670000
         ABEND (1),DUMP,,SYSTEM                                         00671000
*   END;                            /*                       @ZA16887*/ 00672000
@EL00003 DS    0H                                                  0269 00673000
@EF00003 DS    0H                                                  0269 00674000
@ER00003 BR    @14                                                 0269 00675000
*                                                                  0270 00676000
*/***********************************************************@ZA20975*/ 00677000
*/*                                                          @ZA20975*/ 00678000
*/* EVTSTACK - IRARMEVT ECB STACK SUBROUTINE                 @ZA20975*/ 00679000
*/*                                                          @ZA20975*/ 00680000
*/* FUNCTION - ADD AN ECB TO A STACK FOR CONCURRENT          @ZA20975*/ 00681000
*/*            TRANSWAPS OR REQSWAPS.  IF A STACK DOES NOT   @ZA20975*/ 00682000
*/*            YET EXIST, GET AN AREA FOR ONE.               @ZA20975*/ 00683000
*/*                                                          @ZA20975*/ 00684000
*/* CALLERS  - SYSEVENT TRANSWAP                             @ZA20975*/ 00685000
*/*            SYSEVENT REQSWAP                              @ZA20975*/ 00686000
*/*                                                          @ZA20975*/ 00687000
*/* INPUT    - REG1:                                         @ZA20975*/ 00688000
*/*             FOR TRANSWAP, ADDRESS OF OUXBTSW             @ZA20975*/ 00689000
*/*             FOR REQSWAP, ADDRESS OF OUXBRSW              @ZA20975*/ 00690000
*/*             (IF THE OUXB FIELD HAS THE HIGH ORDER BIT    @ZA20975*/ 00691000
*/*              ON, IT POINTS TO A STACK OF ECB ADDRESSES.  @ZA20975*/ 00692000
*/*              OTHERWISE IT POINTS TO SINGLE ECB.)         @ZA20975*/ 00693000
*/*            REG3: ADDRESS OF RRPA                         @ZA20975*/ 00694000
*/*                                                          @ZA20975*/ 00695000
*/* OUTPUT   - IF A STACK MUST BE CREATED, ITS               @ZA20975*/ 00696000
*/*            ADDRESS IS PUT IN THE OUXB FIELD AND THE      @ZA20975*/ 00697000
*/*            HIGH ORDER BIT TURNED ON.  IF A STACK ALREADY @ZA20975*/ 00698000
*/*            EXISTS, ANOTHER ECB ADDRESS IS ADDED TO IT.   @ZA20975*/ 00699000
*/*                                                          @ZA20975*/ 00700000
*/***********************************************************@ZA20975*/ 00701000
*                                                                  0270 00702000
*EVTSTACK:                                                         0270 00703000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA20975*/ 00704000
EVTSTACK DS    0H                                                  0271 00705000
*/* USE GLOBAL SAVEAREA 3                                    @ZA20975*/ 00706000
*                                                                  0271 00707000
*   GEN CODE REFS(RMCTRMSA) NOEXIT SEQFLOW;                        0271 00708000
*                                                       /*  @ZA20975*/  00709000
  L    @15,RMCTRMSA(,RMCTPTR)                                           00710000
  STM  @00,@14,128+000(@15)                                             00711000
  LR   @13,@15                                                          00712000
*   RFY                                                            0272 00713000
*     I RSTD;                       /* WORK REG FOR LOOP     @ZA20975*/ 00714000
*   ECBPARM=R1;                     /* STORE INPUT VALUE     @ZA20975*/ 00715000
         LR    ECBPARM,R1                                          0273 00716000
*   IF RRPAINP^=ZERO THEN           /* THIS SWAP HAS ECB?    @ZA20975*/ 00717000
         SLR   @10,@10                                             0274 00718000
         C     @10,RRPAINP(,RRPAPTR)                               0274 00719000
         BE    @RF00274                                            0274 00720000
*     IF SWAPECB^=ZERO THEN         /* ALREADY ONE WITH ECB? @ZA20975*/ 00721000
         C     @10,SWAPECB(,ECBPARM)                               0275 00722000
         BE    @RF00275                                            0275 00723000
*       DO;                         /*                       @ZA20975*/ 00724000
*         IF ECBLISTB='1'B THEN     /* ALREADY A STACK?      @ZA20975*/ 00725000
         TM    ECBLISTB(ECBPARM),B'10000000'                       0277 00726000
         BNO   @RF00277                                            0277 00727000
*           DO;                     /* FIND END OF STACK     @ZA20975*/ 00728000
*             DO I=ONE TO LENGTH(OUXB)/FOUR WHILE ECBLIST(I)^=ZERO;/*   00729000
*                                      STACK IS SIZE OF OUXB @ZA20975*/ 00730000
         LA    I,1                                                 0279 00731000
@DL00279 LR    @10,I                                               0279 00732000
         SLA   @10,2                                               0279 00733000
         L     @07,SWAPECB(,ECBPARM)                               0279 00734000
         AL    @07,@CF02685                                        0279 00735000
         L     @10,ECBLIST(@10,@07)                                0279 00736000
         LTR   @10,@10                                             0279 00737000
         BZ    @DC00279                                            0279 00738000
*             END;                  /* FIND AN UNUSED ENTRY  @ZA20975*/ 00739000
         AL    I,@CF00078                                          0280 00740000
         C     I,@CF02432                                          0280 00741000
         BNH   @DL00279                                            0280 00742000
@DC00279 DS    0H                                                  0281 00743000
*             IF I<=LENGTH(OUXB)/FOUR THEN/* ROOM FOR 1 MORE?      0281 00744000
*                                                            @ZA20975*/ 00745000
         C     I,@CF02432                                          0281 00746000
         BH    @RF00281                                            0281 00747000
*               ECBLIST(I)=RRPAINP; /* STORE IT              @ZA20975*/ 00748000
         LR    @10,I                                               0282 00749000
         SLA   @10,2                                               0282 00750000
         L     @07,SWAPECB(,ECBPARM)                               0282 00751000
         L     @06,RRPAINP(,RRPAPTR)                               0282 00752000
         AL    @07,@CF02685                                        0282 00753000
         ST    @06,ECBLIST(@10,@07)                                0282 00754000
*             ELSE                  /* NO MORE ROOM...       @ZA20975*/ 00755000
*               DO;                 /* SHOULD NEVER HAPPEN,  @ZA20975*/ 00756000
         B     @RC00281                                            0283 00757000
@RF00281 DS    0H                                                  0284 00758000
*                 RESNCODE=CON28;   /* BUT JUST IN CASE,     @ZA20975*/ 00759000
*                                                                  0284 00760000
         LA    RESNCODE,28                                         0284 00761000
*                 /***************************************************/ 00762000
*                 /*                                                 */ 00763000
*                 /* ? IRACTLCL EPN(I10)                             */ 00764000
*                 /*                                                 */ 00765000
*                 /***************************************************/ 00766000
*                                                                  0285 00767000
*                 CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT        */ 00768000
         L     @15,RMSBI10(,RMCTPTR)                               0285 00769000
         BALR  @14,@15                                             0285 00770000
*               END;                /* ABEND 15F RC=28       @ZA20975*/ 00771000
*           END;                    /* END STACK CASE        @ZA20975*/ 00772000
*         ELSE                      /* NO-STACK CASE         @ZA20975*/ 00773000
*           DO;                     /* NEED TO CREATE STACK  @ZA20975*/ 00774000
         B     @RC00277                                            0288 00775000
@RF00277 DS    0H                                                  0289 00776000
*             R0=LENGTH(OUXB);      /* GET SOME STORAGE --   @ZA20975*/ 00777000
         LA    R0,144                                              0289 00778000
*             R1=ZERO;              /* SIZE OF OUXB WILL DO  @ZA20975*/ 00779000
*                                                                  0290 00780000
         SLR   R1,R1                                               0290 00781000
*             /*******************************************************/ 00782000
*             /*                                                     */ 00783000
*             /* ? IRACTLCL EPN(I04)                                 */ 00784000
*             /*                                                     */ 00785000
*             /*******************************************************/ 00786000
*                                                                  0291 00787000
*             CALL RMSBI04->IRARMRTN;/* INVOKE I04 SUBRTN            */ 00788000
*                                                                  0291 00789000
         L     @15,RMSBI04(,RMCTPTR)                               0291 00790000
         BALR  @14,@15                                             0291 00791000
*             /*******************************************************/ 00792000
*             /*                                                     */ 00793000
*             /* INVOKE GETCELL ROUTINE                      @ZA20975*/ 00794000
*             /*                                                     */ 00795000
*             /*******************************************************/ 00796000
*                                                                  0292 00797000
*             NEWCELL(ONE:LENGTH(OUXB))=''B;/* CLEAR NEW CELL      0292 00798000
*                                                            @ZA20975*/ 00799000
         XC    NEWCELL(144,R1),NEWCELL(R1)                         0292 00800000
*             RFY                                                  0293 00801000
*               ECBLIST BASED(R1);  /* USE NEW CELL          @ZA20975*/ 00802000
*             ECBLIST(ONE)=SWAPECB; /* ORIGINAL ECB          @ZA20975*/ 00803000
         L     @10,SWAPECB(,ECBPARM)                               0294 00804000
         ST    @10,ECBLIST(,R1)                                    0294 00805000
*             ECBLIST(TWO)=RRPAINP; /* THIS ONE              @ZA20975*/ 00806000
         L     @10,RRPAINP(,RRPAPTR)                               0295 00807000
         ST    @10,ECBLIST+4(,R1)                                  0295 00808000
*             SWAPECB=R1;           /* PUT CELL ADDR IN OUXB @ZA20975*/ 00809000
         ST    R1,SWAPECB(,ECBPARM)                                0296 00810000
*             ECBLISTB='1'B;        /* INDICATE STACK EXISTS @ZA20975*/ 00811000
         OI    ECBLISTB(ECBPARM),B'10000000'                       0297 00812000
*             RFY                                                  0298 00813000
*               ECBLIST BASED(SWAPECB);/* NORMAL BASING      @ZA20975*/ 00814000
*           END;                    /* END NO-STACK CASE     @ZA20975*/ 00815000
*       END;                        /* END PREVIOUS ECB CASE @ZA20975*/ 00816000
*     ELSE                          /* NO PREVIOUS ECB CASE  @ZA20975*/ 00817000
*       SWAPECB=RRPAINP;            /* OK TO STORE THIS ECB  @ZA20975*/ 00818000
         B     @RC00275                                            0301 00819000
@RF00275 L     @10,RRPAINP(,RRPAPTR)                               0301 00820000
         ST    @10,SWAPECB(,ECBPARM)                               0301 00821000
*   RFY                                                            0302 00822000
*     I UNRSTD;                     /* FREE UP WORK REGISTER @ZA20975*/ 00823000
@RC00275 DS    0H                                                  0302 00824000
@RF00274 DS    0H                                                  0303 00825000
*   GEN CODE NOEXIT SEQFLOW;                                       0303 00826000
*                                  /* RESTORE REGS FROM SA3 @ZA20975*/  00827000
   LM   @00,@14,128+000(@13)                                            00828000
*   END EVTSTACK;                   /* DONE                  @ZA20975*/ 00829000
@EL00004 DS    0H                                                  0304 00830000
@EF00004 DS    0H                                                  0304 00831000
@ER00004 BR    @14                                                 0304 00832000
*                                                                  0305 00833000
*/***********************************************************@ZA20975*/ 00834000
*/*                                                          @ZA20975*/ 00835000
*/* EVTENDSW - IRARMEVT END-REQSWAP-OR-TRANSWAP SUBROUTINE   @ZA20975*/ 00836000
*/*                                                          @ZA20975*/ 00837000
*/* CALLERS  - SYSEVENT QSCEST                               @ZA20975*/ 00838000
*/*            SYSEVENT QSCECMP                              @ZA20975*/ 00839000
*/*            SYSEVENT SWOUTCMP (VIA UXB ROUTINE)           @ZA20975*/ 00840000
*/*                                                          @ZA20975*/ 00841000
*/* FUNCTION - TURN OFF SWAP PENDING BITS, POST REQSWAP OR   @ZA20975*/ 00842000
*/*            TRANSWAP ISSUER IF NECESSARY, CLEAR ECB ADDR  @ZA20975*/ 00843000
*/*                                                          @ZA20975*/ 00844000
*/* INPUT    - OUCBRSWP, OUXBRSW, OUCBTSWP, OUXBTSW          @ZA20975*/ 00845000
*/*            REG 0: POST CODE (SET BY CALLER OF EVTENDSW,  @ZA20975*/ 00846000
*/*                   USED BY I06 ROUTINE WHICH IS INVOKED   @ZA20975*/ 00847000
*/*                   BY EVTPOST)                            @ZA20975*/ 00848000
*/*            REG 4: ADDRESS OF OUCB                        @ZA20975*/ 00849000
*/*            REG 6: ADDRESS OF OUXB                        @ZA20975*/ 00850000
*/*                                                          @ZA20975*/ 00851000
*/***********************************************************@ZA20975*/ 00852000
*                                                                  0305 00853000
*EVTENDSW:                                                         0305 00854000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA20975*/ 00855000
EVTENDSW DS    0H                                                  0306 00856000
*/* USE GLOBAL SAVEAREA 3                                    @ZA20975*/ 00857000
*                                                                  0306 00858000
*   GEN CODE REFS(RMCTRMSA) NOEXIT SEQFLOW;                        0306 00859000
*                                                       /*  @ZA20975*/  00860000
   L    @15,RMCTRMSA(,RMCTPTR)                                          00861000
   STM  @00,@14,128+000(@15)                                            00862000
   LR   @13,@15                                                         00863000
*   RFY                                                            0307 00864000
*     OUXBPTR RSTD;                 /*                       @ZA20975*/ 00865000
*   IF OUCBRSWP='1'B THEN           /* REQSWAP PENDING?      @ZA20975*/ 00866000
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       0308 00867000
         BNO   @RF00308                                            0308 00868000
*     DO;                           /* END IT...             @ZA20975*/ 00869000
*       IF OUXBRSW^=ZERO THEN       /* ECB(S) TO BE POSTED?  @ZA20975*/ 00870000
         L     @12,OUXBRSW(,OUXBPTR)                               0310 00871000
         LTR   @12,@12                                             0310 00872000
         BZ    @RF00310                                            0310 00873000
*         DO;                       /* YES,                  @ZA20975*/ 00874000
*           R1=ADDR(OUXBRSW);       /* PASS ADDRESS          @ZA20975*/ 00875000
         LA    R1,OUXBRSW(,OUXBPTR)                                0312 00876000
*           CALL EVTPOST;           /* INVOKE POST SUBROUTINE      0313 00877000
*                                                            @ZA20975*/ 00878000
         BAL   @14,EVTPOST                                         0313 00879000
*         END;                      /* END REQSWAP POST      @ZA20975*/ 00880000
*       OUCBRSWP='0'B;              /* RESET PENDING BIT     @ZA20975*/ 00881000
@RF00310 NI    OUCBRSWP(OUCBPTR),B'11011111'                       0315 00882000
*     END;                          /* END REQSWAP CASE      @ZA20975*/ 00883000
*   IF OUCBTSWP='1'B THEN           /* TRANSWAP PENDING?     @ZA20975*/ 00884000
@RF00308 TM    OUCBTSWP(OUCBPTR),B'00010000'                       0317 00885000
         BNO   @RF00317                                            0317 00886000
*     DO;                           /* END IT...             @ZA20975*/ 00887000
*       IF OUXBTSW^=ZERO THEN       /* ECB(S) TO BE POSTED?  @ZA20975*/ 00888000
         L     @12,OUXBTSW(,OUXBPTR)                               0319 00889000
         LTR   @12,@12                                             0319 00890000
         BZ    @RF00319                                            0319 00891000
*         DO;                       /* YES,                  @ZA20975*/ 00892000
*           R1=ADDR(OUXBTSW);       /* PASS ADDRESS          @ZA20975*/ 00893000
         LA    R1,OUXBTSW(,OUXBPTR)                                0321 00894000
*           CALL EVTPOST;           /* INVOKE POST SUBROUTINE      0322 00895000
*                                                            @ZA20975*/ 00896000
         BAL   @14,EVTPOST                                         0322 00897000
*         END;                      /* END TRANSWAP POST     @ZA20975*/ 00898000
*       OUCBTSWP='0'B;              /* RESET PENDING BIT     @ZA20975*/ 00899000
@RF00319 NI    OUCBTSWP(OUCBPTR),B'11101111'                       0324 00900000
*       OUCBNTSP=ZERO;              /* RESET PENDING COUNT   @ZA20975*/ 00901000
         SLR   @12,@12                                             0325 00902000
         STH   @12,OUCBNTSP(,OUCBPTR)                              0325 00903000
*     END;                          /* END TRANSWAP CASE     @ZA20975*/ 00904000
*   RFY                                                            0327 00905000
*     OUXBPTR UNRSTD;               /*                       @ZA20975*/ 00906000
@RF00317 DS    0H                                                  0328 00907000
*   GEN CODE NOEXIT SEQFLOW;                                       0328 00908000
*                                  /* RESTORE REGS FROM SA3 @ZA20975*/  00909000
   LM   @00,@14,128+000(@13)                                            00910000
*   END EVTENDSW;                   /* DONE                  @ZA20975*/ 00911000
@EL00005 DS    0H                                                  0329 00912000
@EF00005 DS    0H                                                  0329 00913000
@ER00005 BR    @14                                                 0329 00914000
*                                                                  0330 00915000
*/***********************************************************@ZA20975*/ 00916000
*/*                                                          @ZA20975*/ 00917000
*/* EVTPOST  - IRARMEVT POST SUBROUTINE FOR REQSWAP AND      @ZA20975*/ 00918000
*/*            TRANSWAP                                      @ZA20975*/ 00919000
*/*                                                          @ZA20975*/ 00920000
*/* CALLER   - EVTENDSW SUBROUTINE                           @ZA20975*/ 00921000
*/*                                                          @ZA20975*/ 00922000
*/* FUNCTION - POST AN ECB OR A STACK OF ECBS FOR THE        @ZA20975*/ 00923000
*/*            ISSUER(S) OF SYSEVENT REQSWAP OR TRANSWAP,    @ZA20975*/ 00924000
*/*            CLEAR THE OUXB FIELD THAT WAS PASSED IN.      @ZA20975*/ 00925000
*/*                                                          @ZA20975*/ 00926000
*/* INPUT    - R0= POST CODE (SET BY CALLER OF EVTENDSW,     @ZA20975*/ 00927000
*/*                USED BY I06 ROUTINE)                      @ZA20975*/ 00928000
*/*            R1= FOR TRANSWAP, ADDRESS OF OUXBTSW          @ZA20975*/ 00929000
*/*                FOR REQSWAP, ADDRESS OF OUXBRSW           @ZA20975*/ 00930000
*/*                (IF HIGH ORDER BIT OF OUXB FIELD IS ON,   @ZA20975*/ 00931000
*/*                 IT POINTS TO A STACK. OTHERWISE, IT      @ZA20975*/ 00932000
*/*                 POINTS TO A SINGLE ECB.)                 @ZA20975*/ 00933000
*/*                                                          @ZA20975*/ 00934000
*/***********************************************************@ZA20975*/ 00935000
*                                                                  0330 00936000
*EVTPOST:                                                          0330 00937000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA20975*/ 00938000
EVTPOST  DS    0H                                                  0331 00939000
*   RFY                                                            0331 00940000
*    (OUXBPTR,                                                     0331 00941000
*     WRKREG2,                                                     0331 00942000
*     I) RSTD;                      /*                       @ZA20975*/ 00943000
*   RFY                                                            0332 00944000
*    (NTRREG,                                                      0332 00945000
*     RETNCODE) UNRSTD;             /*                       @ZA20975*/ 00946000
*   WRKREG2=RTNREG;                 /* SAVE RETURN ADDRESS   @ZA20975*/ 00947000
         LR    WRKREG2,RTNREG                                      0333 00948000
*   ECBPARM=R1;                     /* STORE INPUT VALUE     @ZA20975*/ 00949000
         LR    ECBPARM,R1                                          0334 00950000
*   IF ECBLISTB='1'B THEN           /* THERE'S A STACK       @ZA20975*/ 00951000
         TM    ECBLISTB(ECBPARM),B'10000000'                       0335 00952000
         BNO   @RF00335                                            0335 00953000
*     DO;                           /* POST THEM ALL         @ZA20975*/ 00954000
*       DO I=ONE TO LENGTH(OUXB)/FOUR WHILE ECBLIST(I)^=ZERO;/* STACK   00955000
*                                      IS SIZE OF OUXB       @ZA20975*/ 00956000
         LA    I,1                                                 0337 00957000
@DL00337 LR    @15,I                                               0337 00958000
         SLA   @15,2                                               0337 00959000
         L     @07,SWAPECB(,ECBPARM)                               0337 00960000
         AL    @07,@CF02685                                        0337 00961000
         L     @15,ECBLIST(@15,@07)                                0337 00962000
         LTR   @15,@15                                             0337 00963000
         BZ    @DC00337                                            0337 00964000
*         R1=ECBLIST(I);            /* PASS ECB ADDRESS      @ZA20975*/ 00965000
*                                                                  0338 00966000
         LR    R1,@15                                              0338 00967000
*         /***********************************************************/ 00968000
*         /*                                                         */ 00969000
*         /* ? IRACTLCL EPN(I06)                                     */ 00970000
*         /*                                                         */ 00971000
*         /***********************************************************/ 00972000
*                                                                  0339 00973000
*         CALL RMSBI06->IRARMRTN;   /* INVOKE I06 SUBRTN             */ 00974000
*                                                                  0339 00975000
         L     @15,RMSBI06(,RMCTPTR)                               0339 00976000
         BALR  @14,@15                                             0339 00977000
*         /***********************************************************/ 00978000
*         /*                                                         */ 00979000
*         /* TO POST ROUTINE                                 @ZA20975*/ 00980000
*         /*                                                         */ 00981000
*         /***********************************************************/ 00982000
*                                                                  0340 00983000
*       END;                        /* DONE WITH STACK       @ZA20975*/ 00984000
         AL    I,@CF00078                                          0340 00985000
         C     I,@CF02432                                          0340 00986000
         BNH   @DL00337                                            0340 00987000
@DC00337 DS    0H                                                  0341 00988000
*       RFY                                                        0341 00989000
*         PCSAVE RSTD;              /* HOLD WORK REGISTER    @ZA20975*/ 00990000
*       PCSAVE=R0;                  /* SAVE POST CODE IN CASE      0342 00991000
*                                      EVTENDSW MUST DO MORE POSTING    00992000
*                                                            @ZA20975*/ 00993000
         LR    PCSAVE,R0                                           0342 00994000
*       R0=LENGTH(OUXB);            /* NOW FREE UP STACK     @ZA20975*/ 00995000
         LA    R0,144                                              0343 00996000
*       R1=SWAPECB;                 /* ADDRESS OF STACK      @ZA20975*/ 00997000
*                                                                  0344 00998000
         L     R1,SWAPECB(,ECBPARM)                                0344 00999000
*       /*************************************************************/ 01000000
*       /*                                                           */ 01001000
*       /* ? IRACTLCL EPN(I04)                                       */ 01002000
*       /*                                                           */ 01003000
*       /*************************************************************/ 01004000
*                                                                  0345 01005000
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */ 01006000
*                                                                  0345 01007000
         L     @15,RMSBI04(,RMCTPTR)                               0345 01008000
         BALR  @14,@15                                             0345 01009000
*       /*************************************************************/ 01010000
*       /*                                                           */ 01011000
*       /* FREECELL SUBROUTINE                               @ZA20975*/ 01012000
*       /*                                                           */ 01013000
*       /*************************************************************/ 01014000
*                                                                  0346 01015000
*       R0=PCSAVE;                  /* RESTORE POST CODE     @ZA20975*/ 01016000
         LR    R0,PCSAVE                                           0346 01017000
*       RFY                                                        0347 01018000
*         PCSAVE UNRSTD;            /* FREE UP REGISTER      @ZA20975*/ 01019000
*     END;                          /* END ECB-STACK CASE    @ZA20975*/ 01020000
*   ELSE                            /* ONLY ONE ECB          @ZA20975*/ 01021000
*     DO;                           /* SO,                   @ZA20975*/ 01022000
         B     @RC00335                                            0349 01023000
@RF00335 DS    0H                                                  0350 01024000
*       R1=SWAPECB;                 /* PASS ECB ADDRESS      @ZA20975*/ 01025000
*                                                                  0350 01026000
         L     R1,SWAPECB(,ECBPARM)                                0350 01027000
*       /*************************************************************/ 01028000
*       /*                                                           */ 01029000
*       /* ? IRACTLCL EPN(I06)                                       */ 01030000
*       /*                                                           */ 01031000
*       /*************************************************************/ 01032000
*                                                                  0351 01033000
*       CALL RMSBI06->IRARMRTN;     /* INVOKE I06 SUBRTN             */ 01034000
*                                                                  0351 01035000
         L     @15,RMSBI06(,RMCTPTR)                               0351 01036000
         BALR  @14,@15                                             0351 01037000
*       /*************************************************************/ 01038000
*       /*                                                           */ 01039000
*       /* POST IT                                           @ZA20975*/ 01040000
*       /*                                                           */ 01041000
*       /*************************************************************/ 01042000
*                                                                  0352 01043000
*     END;                          /* END SINGLE ECB CASE   @ZA20975*/ 01044000
*   ECBFIELD=ZERO;                  /* CLEAR OUXB FIELD      @ZA20975*/ 01045000
@RC00335 SLR   @15,@15                                             0353 01046000
         ST    @15,ECBFIELD(,ECBPARM)                              0353 01047000
*   RTNREG=WRKREG2;                 /* RESTORE RETURN ADDR   @ZA20975*/ 01048000
         LR    RTNREG,WRKREG2                                      0354 01049000
*   RFY                                                            0355 01050000
*    (OUXBPTR,                                                     0355 01051000
*     WRKREG2,                                                     0355 01052000
*     I) UNRSTD;                    /*                       @ZA20975*/ 01053000
*   RFY                                                            0356 01054000
*    (NTRREG,                                                      0356 01055000
*     RETNCODE) RSTD;               /*                       @ZA20975*/ 01056000
*   END EVTPOST;                    /* DONE                  @ZA20975*/ 01057000
@EL00006 DS    0H                                                  0357 01058000
@EF00006 DS    0H                                                  0357 01059000
@ER00006 BR    @14                                                 0357 01060000
*                                                                  0358 01061000
*/* + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +*/ 01062000
*/* | EVTCSOD:      SWAP OUT DRIVER FOR BOTH INITDET AND OKSWAP     |*/ 01063000
*/* |               SYSEVENTS.                                      |*/ 01064000
*/* |                                                               |*/ 01065000
*/* | FUNCTION:     CALL IRARMCRY TO INITIATE SWAPOUT OF THE        |*/ 01066000
*/* |               CURRENT ADDRESS SPACE.                          |*/ 01067000
*/* |                                                               |*/ 01068000
*/* | CALLERS:      SYSEVENT - OKSWAP                               |*/ 01069000
*/* |               SYSEVENT - INITDET                              |*/ 01070000
*/* |                                                               |*/ 01071000
*/* | INPUT:        REG 3 - RRPA ADDRESS                            |*/ 01072000
*/* |               REG 4 - OUCB ADDRESS                            |*/ 01073000
*/* + - - - - - - - - - - - - - - - - - - - - - - - - - - - -@ZA31733*/ 01074000
*                                                                  0358 01075000
*EVTCSOD:                                                          0358 01076000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/*                       @ZA31733*/ 01077000
EVTCSOD  DS    0H                                                  0359 01078000
*   RFY                                                            0359 01079000
*    (WRKREG2,                                                     0359 01080000
*     OUXBPTR) RSTD;                /* RETURN ADDR SAVEAREA  @ZA31733*/ 01081000
*   WRKREG2=RTNREG;                 /* SAVE RETURN ADDR      @ZA31733*/ 01082000
*                                                                  0360 01083000
         LR    WRKREG2,RTNREG                                      0360 01084000
*   /*****************************************************************/ 01085000
*   /*                                                               */ 01086000
*   /* CALL CSO TO INITIATE ADDRESS SPACE SWAP OUT           @ZA31733*/ 01087000
*   /* ? IRACTLCL EPN(CSO)                                           */ 01088000
*   /*                                                               */ 01089000
*   /*****************************************************************/ 01090000
*                                                                  0361 01091000
*   DO;                                                            0361 01092000
*     R1=ADDR(RMEPBCSO);            /* CSO REQUEST IS PARAM          */ 01093000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0362 01094000
*     CALL RMSBCRY->IRARMRTN;       /* ACTION INVK FUNCT             */ 01095000
         L     @15,RMSBCRY(,RMCTPTR)                               0363 01096000
         BALR  @14,@15                                             0363 01097000
*   END;                                                           0364 01098000
*   IF RETNCODE=ZERO                /* SWAP STARTED?         @ZA31733*/ 01099000
*     THEN                          /* YES. BEGIN SWAP STARTED CASE  */ 01100000
         LTR   RETNCODE,RETNCODE                                   0365 01101000
         BNZ   @RF00365                                            0365 01102000
*     DO;                           /*                       @ZA31733*/ 01103000
*       OUCBLWT='0'B;               /* RESET LONGWAIT STATUS @ZA31733*/ 01104000
*       OUCBMWT='0'B;               /* RESET MSO DETECTED WAIT STATUS   01105000
*                                                            @ZA31733*/ 01106000
*       OUCBTRM='0'B;               /* RESET TERMINAL WAIT STATUS  0369 01107000
*                                                            @ZA31733*/ 01108000
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0369 01109000
*       OUCBSRC=SRCDRQSC;           /* SWAP REASON IS REQSWAP      0370 01110000
*                                                            @ZA31733*/ 01111000
         MVI   OUCBSRC(OUCBPTR),X'07'                              0370 01112000
*     END;                          /* END SWAP STARTED CASE @ZA31733*/ 01113000
*   IF RRPASVC='1'B                 /* Q. SVC ENTRY TO SRM?  @ZA31733*/ 01114000
*     THEN                                                         0372 01115000
@RF00365 TM    RRPASVC(RRPAPTR),B'00100000'                        0372 01116000
         BNO   @RF00372                                            0372 01117000
*     RRPARTN=CVTEXP1;              /* YES. FORCE RETURN THROUGH   0373 01118000
*                                      DISPATCHER            @ZA31733*/ 01119000
         L     @12,CVTPTR                                          0373 01120000
         L     @12,CVTEXP1(,@12)                                   0373 01121000
         ST    @12,RRPARTN(,RRPAPTR)                               0373 01122000
*   RTNREG=WRKREG2;                 /* RESTORE RETURN ADDR   @ZA31733*/ 01123000
@RF00372 LR    RTNREG,WRKREG2                                      0374 01124000
*   RFY                                                            0375 01125000
*    (WRKREG2,                                                     0375 01126000
*     OUXBPTR) UNRSTD;              /* FREE WORK REGISTERS   @ZA31733*/ 01127000
*   END EVTCSOD;                    /* END EVTCSOD SUBRT     @ZA31733*/ 01128000
@EL00007 DS    0H                                                  0376 01129000
@EF00007 DS    0H                                                  0376 01130000
@ER00007 BR    @14                                                 0376 01131000
*IRARME01:                          /* SYSEVENT 1 - TIMEREXP         */ 01132000
*   IF RRPATODO=OKCLOCK THEN        /* TOD CLOCK HAS BEEN INITIALIZED*/ 01133000
IRARME01 CLI   RRPATODO(RRPAPTR),X'01'                             0377 01134000
         BNE   @RF00377                                            0377 01135000
*     DO;                           /*                       @ZA31158*/ 01136000
*                                                                  0378 01137000
*       /*************************************************************/ 01138000
*       /*                                                           */ 01139000
*       /* ? IRACTLCL EPN(WMY)                                       */ 01140000
*       /*                                                           */ 01141000
*       /*************************************************************/ 01142000
*                                                                  0379 01143000
*       CALL RMSBWMY->IRARMRTN;     /* INVOKE WMY SUBRTN             */ 01144000
*                                                                  0379 01145000
         L     @15,RMSBWMY(,RMCTPTR)                               0379 01146000
         BALR  @14,@15                                             0379 01147000
*       /*************************************************************/ 01148000
*       /*                                                           */ 01149000
*       /* INIT SRM TIMED ENTRY QUEUES                               */ 01150000
*       /*                                                           */ 01151000
*       /*************************************************************/ 01152000
*                                                                  0380 01153000
*       CVTRV609=ADDR(IRARMEPS);    /* FILL IN ADDRESS OF SYSEVENT 0380 01154000
*                                      ENTRY POINT TABLE     @ZA31158*/ 01155000
         L     @12,@CV02508                                        0380 01156000
         L     @11,CVTPTR                                          0380 01157000
         ST    @12,CVTRV609(,@11)                                  0380 01158000
*     END;                          /* END OKCLOCK CASE      @ZA31158*/ 01159000
*/*                                                                  */ 01160000
*/*   PROHIBIT ENTRY TO SRM CONTROL ROUTINE FROM THIS SYSEVENT       */ 01161000
*/*   UNTIL THE SRM TIMED ENTRY QUEUES HAVE BEEN INITIALIZED.        */ 01162000
*/*                                                                  */ 01163000
*                                                                  0382 01164000
*   IF RMCTTBS=ZERO THEN            /* TOD CLOCK NOT INITIALIZED     */ 01165000
*                                                                  0382 01166000
@RF00377 L     @12,RMCTTBS(,RMCTPTR)                               0382 01167000
         LTR   @12,@12                                             0382 01168000
         BNZ   @RF00382                                            0382 01169000
*     /***************************************************************/ 01170000
*     /*                                                             */ 01171000
*     /* ? IRACTLCL EPN(I01)                                         */ 01172000
*     /*                                                             */ 01173000
*     /***************************************************************/ 01174000
*                                                                  0383 01175000
*     GOTO RMEXI01->IRARMNTR;       /* EXIT TO I01 FUNCT             */ 01176000
*                                                                  0383 01177000
         L     @12,RMEXI01(,RMCTPTR)                               0383 01178000
         BR    @12                                                 0383 01179000
*   /*****************************************************************/ 01180000
*   /*                                                               */ 01181000
*   /* RETURN TO INVOKER                                             */ 01182000
*   /*                                                               */ 01183000
*   /*****************************************************************/ 01184000
*                                                                  0384 01185000
*   ELSE                            /* TOD CLOCK HAS BEEN INITIALIZED*/ 01186000
*                                                                  0384 01187000
*     /***************************************************************/ 01188000
*     /*                                                             */ 01189000
*     /* ? IRACTLCL EPN(CET)                                         */ 01190000
*     /*                                                             */ 01191000
*     /***************************************************************/ 01192000
*                                                                  0384 01193000
*     GOTO RMEXCET->IRARMNTR;       /* EXIT TO CET FUNCT             */ 01194000
*                                                                  0384 01195000
@RF00382 L     @12,RMEXCET(,RMCTPTR)                               0384 01196000
         BR    @12                                                 0384 01197000
*   /*****************************************************************/ 01198000
*   /*                                                               */ 01199000
*   /* SRM TIMER EXPIRED ROUTINE                                     */ 01200000
*   /*                                                               */ 01201000
*   /*****************************************************************/ 01202000
*                                                                  0385 01203000
*IRARME02:                          /* SYSEVENT 2 - TERMWAIT         */ 01204000
*   OUCBTRM='1'B;                   /* MEMORY ENTERED TERMINAL WAIT  */ 01205000
IRARME02 OI    OUCBTRM(OUCBPTR),B'01000000'                        0385 01206000
*   IF RRPAWTYP=OUTWAIT THEN        /* IF MEM IN OUTPUT TERMINAL WAIT*/ 01207000
         CLI   RRPAWTYP(RRPAPTR),X'80'                             0386 01208000
         BNE   @RF00386                                            0386 01209000
*     OUCBOWT='1'B;                 /* INDICATE MEMORY IN OUTPUT WAIT*/ 01210000
         OI    OUCBOWT(OUCBPTR),B'00100000'                        0387 01211000
*   ELSE                            /* INDICATE MEMORY NOT   @ZA30458*/ 01212000
*     OUCBOWT='0'B;                 /* IN OUTPUT WAIT        @ZA30458*/ 01213000
*                                                                  0388 01214000
         B     @RC00386                                            0388 01215000
@RF00386 NI    OUCBOWT(OUCBPTR),B'11011111'                        0388 01216000
*   /*****************************************************************/ 01217000
*   /*                                                               */ 01218000
*   /* ? IRACTLCL EPN(CSO)                                           */ 01219000
*   /*                                                               */ 01220000
*   /*****************************************************************/ 01221000
*                                                                  0389 01222000
*   DO;                                                            0389 01223000
@RC00386 DS    0H                                                  0390 01224000
*     R1=ADDR(RMEPBCSO);            /* CSO REQUEST IS PARAM          */ 01225000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0390 01226000
*     CALL RMSBCRY->IRARMRTN;       /* ACTION INVK FUNCT             */ 01227000
         L     @15,RMSBCRY(,RMCTPTR)                               0391 01228000
         BALR  @14,@15                                             0391 01229000
*   END;                            /* SWAP-OUT THIS MEMORY          */ 01230000
*   IF RTNCOD=ZERO THEN             /* SWAP-OUT REQUEST SUCCESSFUL   */ 01231000
         LTR   RTNCOD,RTNCOD                                       0393 01232000
         BNZ   @RF00393                                            0393 01233000
*     DO;                                                          0394 01234000
*       OUCBLWT='1'B;               /* MEMORY MAY BE IN LONG WAIT    */ 01235000
         OI    OUCBLWT(OUCBPTR),B'10000000'                        0395 01236000
*       IF OUCBOWT='1'B             /* SWAP DUE TO OUTPUT    @Z40BPEB*/ 01237000
*         THEN                                                     0396 01238000
         TM    OUCBOWT(OUCBPTR),B'00100000'                        0396 01239000
         BNO   @RF00396                                            0396 01240000
*         OUCBSRC=SRCDTOSC;         /* TERM OUTPUT WT CODE   @Z40BPEB*/ 01241000
         MVI   OUCBSRC(OUCBPTR),X'01'                              0397 01242000
*       ELSE                                                       0398 01243000
*         OUCBSRC=SRCDTISC;         /* INPUT TERM WAIT CODE  @Z40BPEB*/ 01244000
         B     @RC00396                                            0398 01245000
@RF00396 MVI   OUCBSRC(OUCBPTR),X'02'                              0398 01246000
*     END;                          /* SWAPOUT WAS SUCCESSFUL      0399 01247000
*                                                            @Z40BPEB*/ 01248000
*                                                                  0399 01249000
@RC00396 DS    0H                                                  0400 01250000
*   /*****************************************************************/ 01251000
*   /*                                                               */ 01252000
*   /* ? IRACTLCL EPN(CTL)                                           */ 01253000
*   /*                                                               */ 01254000
*   /*****************************************************************/ 01255000
*                                                                  0400 01256000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 01257000
*                                                                  0400 01258000
@RF00393 L     @12,RMEXCTL(,RMCTPTR)                               0400 01259000
         BR    @12                                                 0400 01260000
*   /*****************************************************************/ 01261000
*   /*                                                               */ 01262000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 01263000
*   /*                                                               */ 01264000
*   /*****************************************************************/ 01265000
*                                                                  0401 01266000
*IRARME03:                          /* SYSEVENT 3 - NIOWAIT  @Z30WIMG*/ 01267000
*                                                                  0401 01268000
*   /*****************************************************************/ 01269000
*   /*                                                               */ 01270000
*   /* ? IRACTLCL EPN(CSO)                                           */ 01271000
*   /*                                                               */ 01272000
*   /*****************************************************************/ 01273000
*                                                                  0401 01274000
*   DO;                                                            0401 01275000
IRARME03 DS    0H                                                  0402 01276000
*     R1=ADDR(RMEPBCSO);            /* CSO REQUEST IS PARAM          */ 01277000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0402 01278000
*     CALL RMSBCRY->IRARMRTN;       /* ACTION INVK FUNCT             */ 01279000
         L     @15,RMSBCRY(,RMCTPTR)                               0403 01280000
         BALR  @14,@15                                             0403 01281000
*   END;                            /* TRY SWAP THIS MEMORY  @Z40BPEB*/ 01282000
*   IF RTNCOD=ZERO THEN             /* SWAP OUT REQUEST OK   @Z40BPEB*/ 01283000
         LTR   RTNCOD,RTNCOD                                       0405 01284000
         BNZ   @RF00405                                            0405 01285000
*     DO;                           /*                       @Z40BPEB*/ 01286000
*       OUCBLWT='1'B;               /* MEMRY IN LONG WAIT    @Z40BPEB*/ 01287000
         OI    OUCBLWT(OUCBPTR),B'10000000'                        0407 01288000
*       OUCBSRC=SRCDLWSC;           /* LONG WAIT SWAP REASON @Z40BPEB*/ 01289000
         MVI   OUCBSRC(OUCBPTR),X'03'                              0408 01290000
*     END;                          /*                       @Z40BPEB*/ 01291000
*                                                                  0409 01292000
*   /*****************************************************************/ 01293000
*   /*                                                               */ 01294000
*   /* ? IRACTLCL EPN(CTL)                                           */ 01295000
*   /*                                                               */ 01296000
*   /*****************************************************************/ 01297000
*                                                                  0410 01298000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 01299000
*                                                                  0410 01300000
@RF00405 L     @12,RMEXCTL(,RMCTPTR)                               0410 01301000
         BR    @12                                                 0410 01302000
*   /*****************************************************************/ 01303000
*   /*                                                               */ 01304000
*   /* ENTER SRM CONTROL RTN                                 @Z40BPEB*/ 01305000
*   /*                                                               */ 01306000
*   /*****************************************************************/ 01307000
*                                                                  0411 01308000
*IRARME04:                          /* SYSEVENT 4 - USERRDY          */ 01309000
*   OUCBRDYB='1'B;                  /* USER READY SYSEVENT RECEIVED  */ 01310000
IRARME04 L     @12,OUCBRDYB-2(,OUCBPTR)                            0411 01311000
@GL00006 LR    @11,@12                                             0411 01312000
         O     @11,@CF02688                                        0411 01313000
         CS    @12,@11,OUCBRDYB-2(OUCBPTR)                         0411 01314000
         BNE   @GL00006                                            0411 01315000
*   ASCBOUTB='0'B;                  /* PREVENT FURTHER USER READY  0412 01316000
*                                      SYSEVENTS FROM BEING RECEIVED */ 01317000
*   ASCBTLWT='0'B;                  /* PREVENT MEMORY FROM BEING   0413 01318000
*                                      TERMINATED FOR EXCEEDING WAIT    01319000
*                                      TIME LIMIT                    */ 01320000
         L     @12,ASCBTLWT-2(,ASCBPTR)                            0413 01321000
@GL00007 LR    @11,@12                                             0413 01322000
         N     @11,@CF02691                                        0413 01323000
         CS    @12,@11,ASCBTLWT-2(ASCBPTR)                         0413 01324000
         BNE   @GL00007                                            0413 01325000
*/*  TEST IF THE SYSEVENT CAN BE IGNORED BECAUSE THE USER    @Z40BPEB*/ 01326000
*/*  WILL BE DETECTED BY ANOTHER ROUTINE.                    @Z40BPEB*/ 01327000
*                                                                  0414 01328000
*   IF OUCBOUT='1'B&OUCBAXS='0'B&OUCBFXS='0'B&/* NOT A HEAVY FIXER 0414 01329000
*                                                            @Z40BPEB*/ 01330000
*       OUCBJSAS='0'B&OUCBJSFS='0'B&/* NOT A JOBSELECT SWAP  @ZM43072*/ 01331000
*       OUCBGOO='0'B&OUCBGOI='0'B THEN/* DONT IGNORE.        @Z40BPJE*/ 01332000
*                                                                  0414 01333000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0414 01334000
         BNO   @RF00414                                            0414 01335000
         TM    OUCBAXS(OUCBPTR),B'00000101'                        0414 01336000
         BNZ   @RF00414                                            0414 01337000
         TM    OUCBJSAS(OUCBPTR),B'11000000'                       0414 01338000
         BNZ   @RF00414                                            0414 01339000
         TM    OUCBGOO(OUCBPTR),B'11000000'                        0414 01340000
         BNZ   @RF00414                                            0414 01341000
*     /***************************************************************/ 01342000
*     /*                                                             */ 01343000
*     /* ? IRACTLCL EPN(HIT)                                         */ 01344000
*     /*                                                             */ 01345000
*     /***************************************************************/ 01346000
*                                                                  0415 01347000
*     DO;                                                          0415 01348000
*       R1=ADDR(RMEPBHIT);          /* HIT REQUEST IS PARAM          */ 01349000
         LA    R1,RMEPBHIT(,RMCTPTR)                               0416 01350000
*       CALL RMSBCRN->IRARMRTN;     /* ACTION INVK FUNCT             */ 01351000
         L     @15,RMSBCRN(,RMCTPTR)                               0417 01352000
         BALR  @14,@15                                             0417 01353000
*     END;                          /*                       @Z40BPJE*/ 01354000
*                                                                  0418 01355000
*   /*****************************************************************/ 01356000
*   /*                                                               */ 01357000
*   /* ? IRACTLCL EPN(I01)                                           */ 01358000
*   /*                                                               */ 01359000
*   /*****************************************************************/ 01360000
*                                                                  0419 01361000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 01362000
*                                                                  0419 01363000
@RF00414 L     @12,RMEXI01(,RMCTPTR)                               0419 01364000
         BR    @12                                                 0419 01365000
*   /*****************************************************************/ 01366000
*   /*                                                               */ 01367000
*   /* RETURN TO INVOKER                                             */ 01368000
*   /*                                                               */ 01369000
*   /*****************************************************************/ 01370000
*                                                                  0420 01371000
*IRARME06:                          /* SYSEVENT 6 - MEMCREAT         */ 01372000
*/*                                                                  */ 01373000
*/*   VERIFY THE INPUT CODE IDENTIFYING THE COMMAND FROM WHICH THE   */ 01374000
*/*   MEMORY IS BEING CREATED.  VALID CODES ARE:                     */ 01375000
*/*                                                                  */ 01376000
*/*         1 - START COMMAND                                        */ 01377000
*/*         2 - LOGON COMMAND                                        */ 01378000
*/*         3 - MOUNT COMMAND                                        */ 01379000
*/*                                                                  */ 01380000
*                                                                  0420 01381000
*   IF RRPAMEMO>ZERO&               /* IF INPUT IDENTIFYING          */ 01382000
*       RRPAMEMO<FOUR THEN          /* THE COMMAND IS VALID,         */ 01383000
IRARME06 CLI   RRPAMEMO(RRPAPTR),0                                 0420 01384000
         BNH   @RF00420                                            0420 01385000
         CLI   RRPAMEMO(RRPAPTR),4                                 0420 01386000
         BNL   @RF00420                                            0420 01387000
*     DO;                           /* CONTINUE SRM MEMORY CREATE    */ 01388000
*                                                                  0421 01389000
*       /*************************************************************/ 01390000
*       /*                                                           */ 01391000
*       /* IF ANY RESOURCE SHORTAGES EXIST, PROHIBIT THE CREATION OF */ 01392000
*       /* THE MEMORY.                                               */ 01393000
*       /*                                                           */ 01394000
*       /*************************************************************/ 01395000
*                                                                  0422 01396000
*       IF MCTSQA1='1'B|            /* SQA SHORTAGE FIRST LEVEL FLAG */ 01397000
*           MCTFAVQ='1'B|           /* EXCESS OF FIXED PGS   @Z40BPEB*/ 01398000
*           MCTASM1='1'B THEN       /* AUX SHORTAGE FIRST LEVEL FLAG */ 01399000
         TM    MCTSQA1(RMCTPTR),B'10010000'                        0422 01400000
         BNZ   @RT00422                                            0422 01401000
         TM    MCTASM1(RMCTPTR),B'10000000'                        0422 01402000
         BNO   @RF00422                                            0422 01403000
@RT00422 DS    0H                                                  0423 01404000
*         RRPARI0=NOGO;             /* PROHIBIT CREATION OF MEMORY   */ 01405000
         MVI   RRPARI0(RRPAPTR),X'80'                              0423 01406000
*       ELSE                        /* NO RESOURCE SHORTAGE EXISTS   */ 01407000
*         DO;                                                      0424 01408000
*                                                                  0424 01409000
         B     @RC00422                                            0424 01410000
@RF00422 DS    0H                                                  0425 01411000
*           /*********************************************************/ 01412000
*           /*                                                       */ 01413000
*           /* OBTAIN AND INITIALIZE STORAGE FOR AN OUCB.            */ 01414000
*           /*                                                       */ 01415000
*           /*********************************************************/ 01416000
*                                                                  0425 01417000
*           R0=LENGTH(OUCB);        /* LENGTH OF STORAGE REQUIRED    */ 01418000
         LA    R0,136                                              0425 01419000
*           R1=ZERO;                /* CLEAR FOR GET REQUEST         */ 01420000
*                                                                  0426 01421000
         SLR   R1,R1                                               0426 01422000
*           /*********************************************************/ 01423000
*           /*                                                       */ 01424000
*           /* ? IRACTLCL EPN(I04)                                   */ 01425000
*           /*                                                       */ 01426000
*           /*********************************************************/ 01427000
*                                                                  0427 01428000
*           CALL RMSBI04->IRARMRTN; /* INVOKE I04 SUBRTN             */ 01429000
*                                                                  0427 01430000
         L     @15,RMSBI04(,RMCTPTR)                               0427 01431000
         BALR  @14,@15                                             0427 01432000
*           /*********************************************************/ 01433000
*           /*                                                       */ 01434000
*           /* GET STORAGE FOR OUCB                                  */ 01435000
*           /*                                                       */ 01436000
*           /*********************************************************/ 01437000
*                                                                  0428 01438000
*           IF RTNCOD=ZERO THEN     /* IF STORAGE OBTAINED,          */ 01439000
         LTR   RTNCOD,RTNCOD                                       0428 01440000
         BNZ   @RF00428                                            0428 01441000
*             DO;                   /* INITIALIZE STORAGE            */ 01442000
*               OUCBPTR=R1;         /* ADDRESSABILITY TO OUCB        */ 01443000
         LR    OUCBPTR,R1                                          0430 01444000
*               ASCBOUCB=R1;        /* POINTER TO OUCB IN ASCB       */ 01445000
         ST    R1,ASCBOUCB(,ASCBPTR)                               0431 01446000
*               OUCB=RMCTOUCB->     /* INITIALIZE OUCB FROM PRE-     */ 01447000
*                   OUCB;           /* DEFINED COPY                  */ 01448000
         L     @12,RMCTOUCB(,RMCTPTR)                              0432 01449000
         MVC   OUCB(136,OUCBPTR),OUCB(@12)                         0432 01450000
*               OUCBASCB=ASCBPTR;   /* POINTER TO ASCB IN OUCB       */ 01451000
*                                                                  0433 01452000
         ST    ASCBPTR,OUCBASCB(,OUCBPTR)                          0433 01453000
*               /*****************************************************/ 01454000
*               /*                                                   */ 01455000
*               /* INDICATE THE COMMAND FROM WHICH THE MEMORY        */ 01456000
*               /* ORIGINATED.                                       */ 01457000
*               /*                                                   */ 01458000
*               /*****************************************************/ 01459000
*                                                                  0434 01460000
*               IF RRPAMEMO=LOGONCOM/* IF MEMORY BEING CREATED IN    */ 01461000
*                 THEN              /* RESPONSE TO A LOGON COMMAND   */ 01462000
         CLI   RRPAMEMO(RRPAPTR),2                                 0434 01463000
         BNE   @RF00434                                            0434 01464000
*                 OUCBLOG='1'B;                                    0435 01465000
         OI    OUCBLOG(OUCBPTR),B'00100000'                        0435 01466000
*               ELSE                /* START OR MOUNT COMMAND        */ 01467000
*                 IF RRPAMEMO=      /* IF MEMORY BEING CREATED IN    */ 01468000
*                     BATCHCOM THEN /* RESPONSE TO A START COMMAND   */ 01469000
         B     @RC00434                                            0436 01470000
@RF00434 CLI   RRPAMEMO(RRPAPTR),1                                 0436 01471000
         BNE   @RF00436                                            0436 01472000
*                   OUCBSTT='1'B;                                  0437 01473000
         OI    OUCBSTT(OUCBPTR),B'01000000'                        0437 01474000
*                 ELSE              /* MOUNT COMMAND                 */ 01475000
*                   OUCBMNT='1'B;                                  0438 01476000
*                                                                  0438 01477000
         B     @RC00436                                            0438 01478000
@RF00436 OI    OUCBMNT(OUCBPTR),B'00010000'                        0438 01479000
*               /*****************************************************/ 01480000
*               /*                                                   */ 01481000
*               /* OBTAIN STORAGE FOR OUXB                           */ 01482000
*               /*                                                   */ 01483000
*               /*****************************************************/ 01484000
*                                                                  0439 01485000
*               R0=LENGTH(OUXB);    /* LENGTH OF STORAGE REQUIRED    */ 01486000
@RC00436 DS    0H                                                  0439 01487000
@RC00434 LA    R0,144                                              0439 01488000
*               R1=ZERO;            /* CLEAR FOR GET REQUEST         */ 01489000
*                                                                  0440 01490000
         SLR   R1,R1                                               0440 01491000
*               /*****************************************************/ 01492000
*               /*                                                   */ 01493000
*               /* ? IRACTLCL EPN(I04)                               */ 01494000
*               /*                                                   */ 01495000
*               /*****************************************************/ 01496000
*                                                                  0441 01497000
*               CALL RMSBI04->IRARMRTN;/* INVOKE I04 SUBRTN          */ 01498000
         L     @15,RMSBI04(,RMCTPTR)                               0441 01499000
         BALR  @14,@15                                             0441 01500000
*               IF RTNCOD=ZERO THEN /* IF OUXB STORAGE OBTAINED,     */ 01501000
         LTR   RTNCOD,RTNCOD                                       0442 01502000
         BNZ   @RF00442                                            0442 01503000
*                 DO;               /* COMPLETE SRM MEMORY CREATION  */ 01504000
*                   RESPECIFY                                      0444 01505000
*                    (OUXBPTR) RSTD;/* BASE PTR TO OUXB              */ 01506000
*                   OUXBPTR=R1;     /* ADDRESSABILITY TO OUXB        */ 01507000
         LR    OUXBPTR,R1                                          0445 01508000
*                   ASCBOUXB=R1;    /* POINTER TO OUXB IN ASCB       */ 01509000
         ST    R1,ASCBOUXB(,ASCBPTR)                               0446 01510000
*                   OUXB=''B;       /* INITIALIZE OUXB               */ 01511000
         XC    OUXB(144,OUXBPTR),OUXB(OUXBPTR)                     0447 01512000
*                   OUXBNAME='OUXB';/* ACRONYM IN EBCDIC             */ 01513000
*                                                                  0448 01514000
         MVC   OUXBNAME(4,OUXBPTR),@CC02562                        0448 01515000
*                   /*************************************************/ 01516000
*                   /*                                               */ 01517000
*                   /* REQUEST THAT THE MEMORY BE PLACED ON THE      */ 01518000
*                   /* IN-CORE OUCB CHAIN. THE REQUEST IS PERFORMED  */ 01519000
*                   /* INDIRECTLY THROUGH THE USER ACTION REQUEST    */ 01520000
*                   /* ROUTINE TO INSURE SYSTEM RESOURCE MANAGER     */ 01521000
*                   /* CONTROL BLOCK INTEGRITY. THE ENTRY POINT BLOCK*/ 01522000
*                   /* DESCRIBING THE MEMORY ENQUEUE ROUTINE IS      */ 01523000
*                   /* PASSED TO THE USER ACTION ROUTINE AS INPUT.   */ 01524000
*                   /*                                               */ 01525000
*                   /*************************************************/ 01526000
*                                                                  0449 01527000
*                   OUCBINV='0'B;   /* OUCB VALID            @Z40BPCH*/ 01528000
*                                                                  0449 01529000
         NI    OUCBINV(OUCBPTR),B'11101111'                        0449 01530000
*                   /*************************************************/ 01531000
*                   /*                                               */ 01532000
*                   /* ? IRACTLCL EPN(RPS)                           */ 01533000
*                   /*                                               */ 01534000
*                   /*************************************************/ 01535000
*                                                                  0450 01536000
*                   DO;                                            0450 01537000
*                     R1=ADDR(RMEPBRPS);/* RPS REQUEST IS PARAM      */ 01538000
         LA    R1,RMEPBRPS(,RMCTPTR)                               0451 01539000
*                     CALL RMSBCRN->IRARMRTN;/* ACTION INVK FUNCT    */ 01540000
         L     @15,RMSBCRN(,RMCTPTR)                               0452 01541000
         BALR  @14,@15                                             0452 01542000
*                   END;            /* MEMORY ENQUEUE ACTION ROUT    */ 01543000
*                   RMCAINUS=RMCAINUS/* INCREMENT NUMBER OF MEMORIES */ 01544000
*                       +ONE;       /* IN STORAGE                    */ 01545000
         LA    @12,1                                               0454 01546000
         AH    @12,RMCAINUS(,RMCTPTR)                              0454 01547000
         STH   @12,RMCAINUS(,RMCTPTR)                              0454 01548000
*                   RRPARI0=OK;     /* MEMORY CAN BE CREATED         */ 01549000
         MVI   RRPARI0(RRPAPTR),X'00'                              0455 01550000
*                 END;                                             0456 01551000
*               ELSE                /* OUXB STORAGE NOT OBTAINED     */ 01552000
*                 DO;               /* FREE OUCB STORAGE             */ 01553000
         B     @RC00442                                            0457 01554000
@RF00442 DS    0H                                                  0458 01555000
*                   R0=LENGTH(OUCB);/* LENGTH OF STORAGE TO FREE     */ 01556000
         LA    R0,136                                              0458 01557000
*                   R1=OUCBPTR;     /* ADDRESS OF STORAGE TO FREE    */ 01558000
         LR    R1,OUCBPTR                                          0459 01559000
*                   ASCBOUCB=ZERO;  /* RESET POINTER TO OUCB         */ 01560000
*                                                                  0460 01561000
         SLR   @12,@12                                             0460 01562000
         ST    @12,ASCBOUCB(,ASCBPTR)                              0460 01563000
*                   /*************************************************/ 01564000
*                   /*                                               */ 01565000
*                   /* ? IRACTLCL EPN(I04)                           */ 01566000
*                   /*                                               */ 01567000
*                   /*************************************************/ 01568000
*                                                                  0461 01569000
*                   CALL RMSBI04->IRARMRTN;/* INVOKE I04 SUBRTN      */ 01570000
         L     @15,RMSBI04(,RMCTPTR)                               0461 01571000
         BALR  @14,@15                                             0461 01572000
*                   RRPARI0=NOGO;   /* PROHIBIT CREATION OF MEMORY   */ 01573000
         MVI   RRPARI0(RRPAPTR),X'80'                              0462 01574000
*                 END;                                             0463 01575000
*             END;                                                 0464 01576000
*           ELSE                    /* OUCB STORAGE NOT OBTAINED     */ 01577000
*             RRPARI0=NOGO;         /* PROHIBIT CREATION OF MEMORY   */ 01578000
         B     @RC00428                                            0465 01579000
@RF00428 MVI   RRPARI0(RRPAPTR),X'80'                              0465 01580000
*         END;                                                     0466 01581000
*     END;                                                         0467 01582000
*   ELSE                            /* INVALID INPUT CODE,           */ 01583000
*     DO;                           /* TERMINATE INVOKER             */ 01584000
         B     @RC00420                                            0468 01585000
@RF00420 DS    0H                                                  0469 01586000
*       RESNCODE=CON4;              /* ABEND REASON CODE             */ 01587000
*                                                                  0469 01588000
         LA    RESNCODE,4                                          0469 01589000
*       /*************************************************************/ 01590000
*       /*                                                           */ 01591000
*       /* ? IRACTLCL EPN(I10)                                       */ 01592000
*       /*                                                           */ 01593000
*       /*************************************************************/ 01594000
*                                                                  0470 01595000
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */ 01596000
         L     @15,RMSBI10(,RMCTPTR)                               0470 01597000
         BALR  @14,@15                                             0470 01598000
*     END;                          /*                               */ 01599000
*                                                                  0471 01600000
*   /*****************************************************************/ 01601000
*   /*                                                               */ 01602000
*   /* ? IRACTLCL EPN(CTL)                                           */ 01603000
*   /*                                                               */ 01604000
*   /*****************************************************************/ 01605000
*                                                                  0472 01606000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 01607000
*                                                                  0472 01608000
@RC00420 L     @12,RMEXCTL(,RMCTPTR)                               0472 01609000
         BR    @12                                                 0472 01610000
*   /*****************************************************************/ 01611000
*   /*                                                               */ 01612000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 01613000
*   /*                                                               */ 01614000
*   /*****************************************************************/ 01615000
*                                                                  0473 01616000
*   RESPECIFY                                                      0473 01617000
*    (OUXBPTR) UNRSTD;                                             0473 01618000
*IRARME07:                          /* SYSEVENT 7 - MEMDEL           */ 01619000
*/*                                                                  */ 01620000
*/*   RELEASE THE STORAGE FOR THE OUCB AND OUXB THAT WAS OBTAINED    */ 01621000
*/*   DURING THE MEMORY CREATE SYSEVENT.  THE REQUEST IS PERFORMED   */ 01622000
*/*   INDIRECTLY THROUGH THE USER ACTION REQUEST ROUTINE(IRARMCRN).  */ 01623000
*/*   THE ENTRY POINT BLOCK DESCRIBING THE ACTION TO BE PERFORMED IS */ 01624000
*/*   PASSED TO IRARMCRN.  IRARMCRN WILL SYSNCHRONIZE THE DELETION   */ 01625000
*/*   OF THE SRM CONTROL BLOCKS AND THE ASCB WITH ALL ASYNCHRONOUS   */ 01626000
*/*   SRM PROCESSING THAT COULD REFERENCE THESE BLOCKS.              */ 01627000
*/*                                                                  */ 01628000
*/*   A SPECIAL SYSEVENT MEMDEL (TYPE=NOSWIN) IS ISSUED OUT OF THE   */ 01629000
*/*   RSM MODULE IEAVTERM.  THIS SYSEVENT PREVENTS ANY FURTHER       */ 01630000
*/*   SWAP INS FROM BEING ATTEMPTED UNTIL THE NORMAL SYSEVENT MEMDEL */ 01631000
*/*   WHEN THE OUCB IS REMOVED FROM THE QUEUES AND FREED.    @ZA29015*/ 01632000
*/*                                                                  */ 01633000
*                                                                  0474 01634000
*   IF RRPANSWI='1'B THEN           /* MEMDEL, PHASE 1?      @ZA29015*/ 01635000
IRARME07 TM    RRPANSWI(RRPAPTR),B'10000000'                       0474 01636000
         BNO   @RF00474                                            0474 01637000
*     OUCBNSWI='1'B;                /* STOP SWAPINS          @ZA29015*/ 01638000
         OI    OUCBNSWI(OUCBPTR),B'00001000'                       0475 01639000
*   ELSE                            /* THIS IS NORMAL MEMDEL @ZA29015*/ 01640000
*     DO;                           /*                       @ZA29015*/ 01641000
*                                                                  0476 01642000
         B     @RC00474                                            0476 01643000
@RF00474 DS    0H                                                  0477 01644000
*       /*************************************************************/ 01645000
*       /*                                                           */ 01646000
*       /* ? IRACTLCL EPN(DEL)                                       */ 01647000
*       /*                                                           */ 01648000
*       /*************************************************************/ 01649000
*                                                                  0477 01650000
*       DO;                                                        0477 01651000
*         R1=ADDR(RMEPBDEL);        /* DEL REQUEST IS PARAM          */ 01652000
         LA    R1,RMEPBDEL(,RMCTPTR)                               0478 01653000
*         CALL RMSBCRN->IRARMRTN;   /* ACTION INVK FUNCT             */ 01654000
         L     @15,RMSBCRN(,RMCTPTR)                               0479 01655000
         BALR  @14,@15                                             0479 01656000
*       END;                                                       0480 01657000
*       RRPARI3=WAIT;               /* MEMORY DELETE PROCESSING WILL    01658000
*                                      ISSUE A WAIT THAT WILL BE   0481 01659000
*                                      XMPOSTED AS THE SRM DELETE  0481 01660000
*                                      ACTION IS PERFORMED           */ 01661000
         MVI   RRPARI3(RRPAPTR),X'04'                              0481 01662000
*     END;                          /* END NORMAL MEMDEL     @ZA29015*/ 01663000
*                                                                  0482 01664000
*   /*****************************************************************/ 01665000
*   /*                                                               */ 01666000
*   /* ? IRACTLCL EPN(CTL)                                           */ 01667000
*   /*                                                               */ 01668000
*   /*****************************************************************/ 01669000
*                                                                  0483 01670000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 01671000
*                                                                  0483 01672000
@RC00474 L     @12,RMEXCTL(,RMCTPTR)                               0483 01673000
         BR    @12                                                 0483 01674000
*   /*****************************************************************/ 01675000
*   /*                                                               */ 01676000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 01677000
*   /*                                                               */ 01678000
*   /*****************************************************************/ 01679000
*                                                                  0484 01680000
*IRARME08:                          /* SYSEVENT 8 - JOBSELCT         */ 01681000
*   IF OUCBATR='1'B THEN            /* USER UNDER WLM CONTROL        */ 01682000
*                                                                  0484 01683000
IRARME08 TM    OUCBATR(OUCBPTR),B'10000000'                        0484 01684000
         BNO   @RF00484                                            0484 01685000
*     /***************************************************************/ 01686000
*     /*                                                             */ 01687000
*     /* TERMINATE ONGOING SESSION TRANSACTION ACTIVITY RECORDKEEPING*/ 01688000
*     /*                                                             */ 01689000
*     /***************************************************************/ 01690000
*                                                                  0485 01691000
*     DO;                                                          0485 01692000
*       OUCBSTR='1'B;               /* FORCE TRANSACTION END         */ 01693000
*                                                                  0486 01694000
         OI    OUCBSTR(OUCBPTR),B'01000000'                        0486 01695000
*       /*************************************************************/ 01696000
*       /*                                                           */ 01697000
*       /* ? IRACTLCL EPN(WMO)                                       */ 01698000
*       /*                                                           */ 01699000
*       /*************************************************************/ 01700000
*                                                                  0487 01701000
*       CALL RMSBWMO->IRARMRTN;     /* INVOKE WMO SUBRTN             */ 01702000
*                                                                  0487 01703000
         L     @15,RMSBWMO(,RMCTPTR)                               0487 01704000
         BALR  @14,@15                                             0487 01705000
*       /*************************************************************/ 01706000
*       /*                                                           */ 01707000
*       /* END ANY CURRENT TRANSACTION                               */ 01708000
*       /*                                                           */ 01709000
*       /*************************************************************/ 01710000
*                                                                  0488 01711000
*     END;                                                         0488 01712000
*                                                                  0488 01713000
*/*     IF THIS IS NOT THE FIRST JOB SELECT FOR THIS ASID,   @Z40BPEB*/ 01714000
*/*   PICK UP THE PERFORMANCE GROUP NUMBER(PGN) UNDER        @Z40BPJE*/ 01715000
*/*   WHICH THE NEW JOB WILL BEGIN TO EXECUTE.               @Z40BPJE*/ 01716000
*/*     IF IT IS THE FIRST JOB SELECT, LEAVE THE OUCB        @Z40BPEB*/ 01717000
*/*   MARKED AS PRIVILEDGED AND IN DOMAIN ZERO.  THIS IS     @Z40BPEB*/ 01718000
*/*   TO ALLOW STC AND LOGONS SPECIAL TREATMENT.             @Z40BPEB*/ 01719000
*                                                                  0489 01720000
*   IF OUCBJSR='1'B THEN            /* JOB SELECT RECEIVED   @Z40BPEB*/ 01721000
@RF00484 TM    OUCBJSR(OUCBPTR),B'00001000'                        0489 01722000
         BNO   @RF00489                                            0489 01723000
*     DO;                           /* BEFORE THIS ONE?      @Z40BPEB*/ 01724000
*       OUCBPVL='0'B;               /* MEMORY NO LONGER PRIVILEGED 0491 01725000
*                                                            @Z40BPJE*/ 01726000
         NI    OUCBPVL(OUCBPTR),B'11111011'                        0491 01727000
*       OUCBNPG=RRPAVPGN;           /* NEW PGN INPUT WITH SYSEVENT 0492 01728000
*                                                            @Z40BPJE*/ 01729000
         SLR   @12,@12                                             0492 01730000
         IC    @12,RRPAVPGN(,RRPAPTR)                              0492 01731000
         STC   @12,OUCBNPG(,OUCBPTR)                               0492 01732000
*       OUCBSPG=RRPAVPGN;           /* SAVE INPUT PGN        @Z40WPEB*/ 01733000
         IC    @11,RRPAVPGN(,RRPAPTR)                              0493 01734000
         STC   @11,OUCBSPG(,OUCBPTR)                               0493 01735000
*/*                                                          @Z40BPJE*/ 01736000
*/*   THE NEW PGN IS VALIDATED BY USING IT AS AN INDEX INTO  @Z40BPJE*/ 01737000
*/*   THE WORKLOAD MANAGER PERFORMANCE GROUP VECTOR TABLE    @Z40BPJE*/ 01738000
*/*   (WPGVT), AN ARRAY OF 2 BYTE ELEMENTS.  EACH ELEMENT    @Z40BPJE*/ 01739000
*/*   REPRESENTS AN OFFSET TO ONE OF THE PERFORMANCE GROUPS  @Z40BPJE*/ 01740000
*/*   THAT CAN BE DEFINED WITH-IN AN IPS. THOSE PERFORMANCE  @Z40BPJE*/ 01741000
*/*   GROUPS THAT ARE INVALID HAVE A ZERO OFFSET.  IF THE    @Z40BPJE*/ 01742000
*/*   INDEXED ELEMENT IS NON-ZERO, THEN THE PGN IS VALID.    @Z40BPJE*/ 01743000
*/*   OTHERWISE DETERMINE THE DEFAULT PGN TO BE USED BASED   @Z40BPJE*/ 01744000
*/*   ON THE COMMAND FROM WHICH THE MEMORY ORIGINATED.       @Z40BPJE*/ 01745000
*                                                                  0494 01746000
*       IF(OUCBNPG>WMSTPGHI|        /* IF THE NEW PGN IS UNDEFINED 0494 01747000
*                                                            @Z40BPJE*/ 01748000
*           WPGVTENT=ZERO) THEN     /* IN THE CURRENT IPS,   @Z40BPJE*/ 01749000
*                                                                  0494 01750000
         L     @11,WMSTPTR(,RMCTPTR)                               0494 01751000
         CH    @12,WMSTPGHI(,@11)                                  0494 01752000
         BH    @RT00494                                            0494 01753000
         ALR   @12,@12                                             0494 01754000
         AL    @12,WMSTPGVT(,@11)                                  0494 01755000
         LH    @12,WPGVTENT(,@12)                                  0494 01756000
         LTR   @12,@12                                             0494 01757000
         BNZ   @RF00494                                            0494 01758000
@RT00494 DS    0H                                                  0495 01759000
*         /***********************************************************/ 01760000
*         /*                                                         */ 01761000
*         /*                                                 @Z40BPJE*/ 01762000
*         /* DETERMINE THE DEFAULT PGN FOR THIS USER BASED   @Z40BPJE*/ 01763000
*         /* ON THE COMMAND FROM WHICH THE MEMORY ORIGINATED.        */ 01764000
*         /*                                                 @Z40BPJE*/ 01765000
*         /*                                                 @Z40BPJE*/ 01766000
*         /*                                                         */ 01767000
*         /***********************************************************/ 01768000
*                                                                  0495 01769000
*         DO;                       /*                       @Z40BPJE*/ 01770000
*           IF OUCBLOG='1'B THEN    /* MEMORY ORIGINATED VIA LOGON 0496 01771000
*                                                            @Z40BPJE*/ 01772000
         TM    OUCBLOG(OUCBPTR),B'00100000'                        0496 01773000
         BNO   @RF00496                                            0496 01774000
*             OUCBNPG=RMCALGPG;     /* DEFAULT PGN FOR LOGON USER  0497 01775000
*                                                            @Z40BPJE*/ 01776000
         IC    @12,RMCALGPG(,RMCTPTR)                              0497 01777000
         STC   @12,OUCBNPG(,OUCBPTR)                               0497 01778000
*           ELSE                    /* MEMORY ORIGINATED VIA START OR   01779000
*                                      MOUNT                 @Z40BPJE*/ 01780000
*             OUCBNPG=RMCABCPG;     /* DEFAULT PGN FOR ALL OTHER   0498 01781000
*                                      USERS                 @Z40BPJE*/ 01782000
         B     @RC00496                                            0498 01783000
@RF00496 IC    @12,RMCABCPG(,RMCTPTR)                              0498 01784000
         STC   @12,OUCBNPG(,OUCBPTR)                               0498 01785000
*         END;                      /*                       @Z40BPJE*/ 01786000
*                                                                  0499 01787000
@RC00496 DS    0H                                                  0500 01788000
*       /*************************************************************/ 01789000
*       /*                                                           */ 01790000
*       /*                                                   @Z40BPJE*/ 01791000
*       /* PLACE DOMAIN # & OFFSET IN OUCB                   @Z40BPJE*/ 01792000
*       /*                                                   @Z40BPJE*/ 01793000
*       /*                                                           */ 01794000
*       /*************************************************************/ 01795000
*                                                                  0500 01796000
*       WPGPPTR=WMSTPGDT+WPGVTENT   /* RESOLVE ADDRESSING    @Z40BPJE*/ 01797000
*           +OUCBPGP;               /* TO CORRECT PGP AND    @Z40BPJE*/ 01798000
@RF00494 L     @12,WMSTPTR(,RMCTPTR)                               0500 01799000
         SLR   @10,@10                                             0500 01800000
         IC    @10,OUCBNPG(,OUCBPTR)                               0500 01801000
         ALR   @10,@10                                             0500 01802000
         AL    @10,WMSTPGVT(,@12)                                  0500 01803000
         LH    WPGPPTR,WPGVTENT(,@10)                              0500 01804000
         AL    WPGPPTR,WMSTPGDT(,@12)                              0500 01805000
         SLR   @10,@10                                             0500 01806000
         IC    @10,OUCBPGP(,OUCBPTR)                               0500 01807000
         ALR   WPGPPTR,@10                                         0500 01808000
*       OUCBDMN=WPGPDMN;            /* INITIALIZE THE DOMAIN NUMBER     01809000
*                                                            @Z40BPJE*/ 01810000
         SLR   @10,@10                                             0501 01811000
         IC    @10,WPGPDMN(,WPGPPTR)                               0501 01812000
         STC   @10,OUCBDMN(,OUCBPTR)                               0501 01813000
*       OUCBDMO=WDMVTENT;           /* AND DOMAIN OFFSET     @Z40BPJE*/ 01814000
         ALR   @10,@10                                             0502 01815000
         AL    @10,WMSTDMVT(,@12)                                  0502 01816000
         LH    @12,WDMVTENT(,@10)                                  0502 01817000
         STH   @12,OUCBDMO(,OUCBPTR)                               0502 01818000
*       RFY                                                        0503 01819000
*         DMDTPTR2 RSTD;            /*                       @ZA11854*/ 01820000
*       RFY                                                        0504 01821000
*         DMDT BASED(DMDTPTR2);     /*                       @ZA11854*/ 01822000
*       DMDTPTR2=RMCTDMDT+OUCBDMO;  /* PTR TO DMDT ENTRY     @ZA11854*/ 01823000
         AL    @12,RMCTDMDT(,RMCTPTR)                              0505 01824000
         LR    DMDTPTR2,@12                                        0505 01825000
*       DO WHILE(DMDTHI=ZERO&       /* MAX MPL = 0 ??        @ZA11854*/ 01826000
*             WPGPFIN^='1'B);       /* AND NOT LAST PERIOD   @ZA11854*/ 01827000
         B     @DE00506                                            0506 01828000
@DL00506 DS    0H                                                  0507 01829000
*         OUCBPGP=OUCBPGP+LENGTH(WPGP);/* GO TO NEXT PERIOD  @ZA11854*/ 01830000
         LA    @12,8                                               0507 01831000
         SLR   @07,@07                                             0507 01832000
         IC    @07,OUCBPGP(,OUCBPTR)                               0507 01833000
         ALR   @12,@07                                             0507 01834000
         STC   @12,OUCBPGP(,OUCBPTR)                               0507 01835000
*         WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* PTR TO PERIOD @ZA11854*/ 01836000
         L     @07,WMSTPTR(,RMCTPTR)                               0508 01837000
         SLR   @06,@06                                             0508 01838000
         IC    @06,OUCBNPG(,OUCBPTR)                               0508 01839000
         ALR   @06,@06                                             0508 01840000
         AL    @06,WMSTPGVT(,@07)                                  0508 01841000
         LH    WPGPPTR,WPGVTENT(,@06)                              0508 01842000
         AL    WPGPPTR,WMSTPGDT(,@07)                              0508 01843000
         ALR   WPGPPTR,@12                                         0508 01844000
*         OUCBDMN=WPGPDMN;          /* UPDATE DMN NUMBER     @ZA11854*/ 01845000
         SLR   @12,@12                                             0509 01846000
         IC    @12,WPGPDMN(,WPGPPTR)                               0509 01847000
         STC   @12,OUCBDMN(,OUCBPTR)                               0509 01848000
*         OUCBDMO=WDMVTENT;         /* AND DMN OFFSET        @ZA11854*/ 01849000
         ALR   @12,@12                                             0510 01850000
         AL    @12,WMSTDMVT(,@07)                                  0510 01851000
         LH    @12,WDMVTENT(,@12)                                  0510 01852000
         STH   @12,OUCBDMO(,OUCBPTR)                               0510 01853000
*         DMDTPTR2=RMCTDMDT+OUCBDMO;/* PTR TO NEW DMDT ENTRY @ZA11854*/ 01854000
         AL    @12,RMCTDMDT(,RMCTPTR)                              0511 01855000
         LR    DMDTPTR2,@12                                        0511 01856000
*       END;                        /*                       @ZA11854*/ 01857000
@DE00506 CLI   DMDTHI(DMDTPTR2),0                                  0512 01858000
         BNE   @DC00506                                            0512 01859000
         TM    WPGPFIN(WPGPPTR),B'10000000'                        0512 01860000
         BNO   @DL00506                                            0512 01861000
@DC00506 DS    0H                                                  0513 01862000
*       RFY                                                        0513 01863000
*         DMDT BASED(DMDTPTR);      /*                       @ZA11854*/ 01864000
*       RFY                                                        0514 01865000
*         DMDTPTR2 UNRSTD;          /* FREE UP FOR USE...    @ZA11854*/ 01866000
*     END;                          /* END JSR=1 CASE        @ZA10831*/ 01867000
*/*                                                                  */ 01868000
*/*   IF AUX PAGE SHORTAGE FIRST LEVEL HAS BEEN PASSED,  OR FIXED    */ 01869000
*/*   PAGES COUNT HAS EXCEEDED THE FIRST THRESHOLD, AND THE COM-     */ 01870000
*/*   MAND FROM WHICH THE MEMORY ORIGINATED WAS A START COMMAND,     */ 01871000
*/*   SWAP-OUT THIS MEMORY BEFORE ANOTHER USER CAN BE INITIATED.     */ 01872000
*/*                                                                  */ 01873000
*                                                                  0516 01874000
*   IF(MCTASM1='1'B|                /* AUX SHORTAGE FLAG     @ZM43072*/ 01875000
*       MCTFAVQ='1'B)&              /* FIXED OVER THRESHHOLD @Z40BPEB*/ 01876000
*       OUCBSTT='1'B THEN           /* MEMORY ORIGIN WAS START CMD   */ 01877000
@RF00489 TM    MCTASM1(RMCTPTR),B'10000000'                        0516 01878000
         BO    @GL00015                                            0516 01879000
         TM    MCTFAVQ(RMCTPTR),B'00010000'                        0516 01880000
         BNO   @RF00516                                            0516 01881000
@GL00015 TM    OUCBSTT(OUCBPTR),B'01000000'                        0516 01882000
         BNO   @RF00516                                            0516 01883000
*     DO;                                                          0517 01884000
*                                                                  0517 01885000
*       /*************************************************************/ 01886000
*       /*                                                           */ 01887000
*       /* ? IRACTLCL EPN(CSO)                                       */ 01888000
*       /*                                                           */ 01889000
*       /*************************************************************/ 01890000
*                                                                  0518 01891000
*       DO;                                                        0518 01892000
*         R1=ADDR(RMEPBCSO);        /* CSO REQUEST IS PARAM          */ 01893000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0519 01894000
*         CALL RMSBCRY->IRARMRTN;   /* ACTION INVK FUNCT             */ 01895000
         L     @15,RMSBCRY(,RMCTPTR)                               0520 01896000
         BALR  @14,@15                                             0520 01897000
*       END;                        /* SWAP-OUT THIS MEMORY          */ 01898000
*       IF RTNCOD=ZERO THEN         /* SWAP-OUT REQUEST SUCCESSFUL   */ 01899000
         LTR   RTNCOD,RTNCOD                                       0522 01900000
         BNZ   @RF00522                                            0522 01901000
*         DO;                                                      0523 01902000
*           IF MCTASM1='1'B THEN    /* AUX SHORTAGE CAUSED SWAP    0524 01903000
*                                                            @ZM43072*/ 01904000
         TM    MCTASM1(RMCTPTR),B'10000000'                        0524 01905000
         BNO   @RF00524                                            0524 01906000
*             DO;                                                  0525 01907000
*               OUCBJSAS='1'B;      /* JOBSELECT AUX SHORTAGE      0526 01908000
*                                                            @ZM43072*/ 01909000
         OI    OUCBJSAS(OUCBPTR),B'01000000'                       0526 01910000
*               OUCBSRC=SRCDXSSC;   /* SWAP REASON           @Z40BPEB*/ 01911000
         MVI   OUCBSRC(OUCBPTR),X'04'                              0527 01912000
*             END;                  /*                       @Z40BPEB*/ 01913000
*           ELSE                    /* SWAP DUE TO FIXED EXCESS    0529 01914000
*                                                            @Z40BPEB*/ 01915000
*             DO;                   /*                       @Z40BPEB*/ 01916000
         B     @RC00524                                            0529 01917000
@RF00524 DS    0H                                                  0530 01918000
*               OUCBJSFS='1'B;      /* JOBSELECT FIX SWAP    @ZM43072*/ 01919000
         OI    OUCBJSFS(OUCBPTR),B'10000000'                       0530 01920000
*               OUCBSRC=SRCDRSSC;   /* REASON FOR SWAP       @Z40BPEB*/ 01921000
         MVI   OUCBSRC(OUCBPTR),X'05'                              0531 01922000
*             END;                  /*                       @Z40BPEB*/ 01923000
*         END;                      /*                       @Z40BPEB*/ 01924000
@RC00524 DS    0H                                                  0534 01925000
*     END;                                                         0534 01926000
*                                                                  0534 01927000
@RF00522 DS    0H                                                  0535 01928000
*/*                                                                  */ 01929000
*/*   RE-INITIALIZE PAGE COUNTS IN OUSB AND OUXB FOR NEXT USER.      */ 01930000
*/*                                                                  */ 01931000
*                                                                  0535 01932000
*   ASXBOUSB->PGEFLDS=''B;          /* INITIALIZE PAGE COUNTS IN OUSB*/ 01933000
@RF00516 L     @12,ASXBPTR(,ASCBPTR)                               0535 01934000
         L     @12,ASXBOUSB(,@12)                                  0535 01935000
         XC    PGEFLDS(48,@12),PGEFLDS(@12)                        0535 01936000
*   ASCBOUXB->PGEFLDX=''B;          /* INITIALIZE PAGE COUNTS IN OUXB*/ 01937000
         L     @12,ASCBOUXB(,ASCBPTR)                              0536 01938000
         XC    PGEFLDX(36,@12),PGEFLDX(@12)                        0536 01939000
*   ASCBOUXB->ACCNTFLD=''B;         /* CLEAR OUXB ACCOUNTING FIELDS  */ 01940000
         XC    ACCNTFLD(28,@12),ACCNTFLD(@12)                      0537 01941000
*   OUCBLWT='0'B;                                                  0538 01942000
*   OUCBMWT='0'B;                                                  0539 01943000
*   OUCBCIM='0'B;                                                  0540 01944000
*   OUCBOWT='0'B;                                                  0541 01945000
*   OUCBTRM='0'B;                                                  0542 01946000
         NI    OUCBLWT(OUCBPTR),B'00001110'                        0542 01947000
*   OUCBINP='1'B;                   /* SHOW INITIATOR ATTACH PENDING */ 01948000
*   OUCBSTR='1'B;                   /* SHOW BEGN TRANSACTION PENDING */ 01949000
         OI    OUCBINP(OUCBPTR),B'01000010'                        0544 01950000
*   OUCBJSR='1'B;                   /* SHOW JOBSELECT RECEIVED FOR 0545 01951000
*                                      THIS ASID.            @Z40BPEB*/ 01952000
*                                                                  0545 01953000
         OI    OUCBJSR(OUCBPTR),B'00001000'                        0545 01954000
*   /*****************************************************************/ 01955000
*   /*                                                               */ 01956000
*   /* ? IRACTLCL EPN(CTL)                                           */ 01957000
*   /*                                                               */ 01958000
*   /*****************************************************************/ 01959000
*                                                                  0546 01960000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 01961000
*                                                                  0546 01962000
         L     @12,RMEXCTL(,RMCTPTR)                               0546 01963000
         BR    @12                                                 0546 01964000
*   /*****************************************************************/ 01965000
*   /*                                                               */ 01966000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 01967000
*   /*                                                               */ 01968000
*   /*****************************************************************/ 01969000
*                                                                  0547 01970000
*IRARMAPG:                          /* CHECK APG STATUS OF MEMORY AND   01971000
*                                      MOVE IT TO CORRECT POSITION ON   01972000
*                                      THE ASCB QUEUE                */ 01973000
*   RESPECIFY                                                      0547 01974000
*    (OUXBPTR) RSTD;                /* PTR TO OUXB                   */ 01975000
IRARMAPG DS    0H                                                  0548 01976000
*/*                                                                  */ 01977000
*/*   IF THE INPUT DISPATCHING PRIORITY PLACES THE MEMORY WITHIN THE */ 01978000
*/*   APG, THEN INITIALIZE BASE VALUES FOR THE APG MONITORING        */ 01979000
*/*   ALGORITHM. FOR ALL MEMORIES, MOVE THE ASCB TO ITS CORRECT POSI-*/ 01980000
*/*   TION ON THE ASCB QUEUE BASED ON THE INPUT DISPATCHING PRIORITY.*/ 01981000
*/*                                                                  */ 01982000
*                                                                  0548 01983000
*   OUCBAPG='0'B;                                                  0548 01984000
*   OUCBCPL='0'B;                   /* RESET CPL BIT                 */ 01985000
         NI    OUCBAPG(OUCBPTR),B'10101111'                        0549 01986000
*   IF RRPANDP>=CCCAPMDP&           /* IF THE DISPATCHING PRIORITY   */ 01987000
*       RRPANDP<=CCCAPBDP THEN      /* PLACES THE MEMORY IN THE APG, */ 01988000
         SLR   @12,@12                                             0550 01989000
         IC    @12,RRPANDP(,RRPAPTR)                               0550 01990000
         LH    @07,CCCAPMDP(,RMCTPTR)                              0550 01991000
         CR    @12,@07                                             0550 01992000
         BL    @RF00550                                            0550 01993000
         CH    @12,CCCAPBDP(,RMCTPTR)                              0550 01994000
         BH    @RF00550                                            0550 01995000
*     DO;                           /* THEN                  @Z40BPJE*/ 01996000
*       OUCBAPG='1'B;               /* TURN APG FLAG ON              */ 01997000
         OI    OUCBAPG(OUCBPTR),B'01000000'                        0552 01998000
*       WPGPPTR=WMSTPGDT+WPGVTENT+  /* GAIN ADDRESSABILTY    @Z40BPEB*/ 01999000
*           OUCBPGP;                /* TO PERIOD INFO        @Z40BPEB*/ 02000000
         L     @12,WMSTPTR(,RMCTPTR)                               0553 02001000
         SLR   @10,@10                                             0553 02002000
         IC    @10,OUCBNPG(,OUCBPTR)                               0553 02003000
         ALR   @10,@10                                             0553 02004000
         AL    @10,WMSTPGVT(,@12)                                  0553 02005000
         LH    WPGPPTR,WPGVTENT(,@10)                              0553 02006000
         AL    WPGPPTR,WMSTPGDT(,@12)                              0553 02007000
         SLR   @12,@12                                             0553 02008000
         IC    @12,OUCBPGP(,OUCBPTR)                               0553 02009000
         ALR   WPGPPTR,@12                                         0553 02010000
*       IF WPGPAPG='1'B             /* IPS PERIOD HAS APG    @Z40BPEB*/ 02011000
*         THEN                                                     0554 02012000
         TM    WPGPAPG(WPGPPTR),B'00100000'                        0554 02013000
         BNO   @RF00554                                            0554 02014000
*         OUCBNDP=CCCAPMDP+WPGPAPGV;/* DP AS REQUESTED       @Z40BPEB*/ 02015000
         SLR   @12,@12                                             0555 02016000
         IC    @12,WPGPAPGV(,WPGPPTR)                              0555 02017000
         ALR   @07,@12                                             0555 02018000
         STC   @07,OUCBNDP(,OUCBPTR)                               0555 02019000
*       ELSE                        /* IPS HAS NO APG        @Z40BPEB*/ 02020000
*         OUCBNDP=CCCAPGDP;         /* GIVE DEFAULT          @Z40BPEB*/ 02021000
         B     @RC00554                                            0556 02022000
@RF00554 LH    @12,CCCAPGDP(,RMCTPTR)                              0556 02023000
         STC   @12,OUCBNDP(,OUCBPTR)                               0556 02024000
*     END;                          /* DISPATCHING PRIORITY  @Z40BPJE*/ 02025000
*   ELSE                                                           0558 02026000
*     OUCBNDP=RRPANDP;              /* NON-APG DP            @Z40BPJE*/ 02027000
         B     @RC00550                                            0558 02028000
@RF00550 IC    @12,RRPANDP(,RRPAPTR)                               0558 02029000
         STC   @12,OUCBNDP(,OUCBPTR)                               0558 02030000
*   OUCBRDP=OUCBNDP;                /* SAVE USER DP          @Z40BPEB*/ 02031000
@RC00550 IC    @12,OUCBNDP(,OUCBPTR)                               0559 02032000
         STC   @12,OUCBRDP(,OUCBPTR)                               0559 02033000
*   OUXBWCT=ASCBSWCT;               /* BASE SHORT WAIT COUNT         */ 02034000
         LH    @12,ASCBSWCT(,ASCBPTR)                              0560 02035000
         STH   @12,OUXBWCT(,OUXBPTR)                               0560 02036000
*   OUXBAET=ZERO;                   /* ASCBEJST RESET AT INIT ATT/DET*/ 02037000
         SLR   @12,@12                                             0561 02038000
         ST    @12,OUXBAET(,OUXBPTR)                               0561 02039000
*   OUXBCPS=''B;                    /* ALSO RESET WLM BASE CPU TIME  */ 02040000
         XC    OUXBCPS(8,OUXBPTR),OUXBCPS(OUXBPTR)                 0562 02041000
*   CALL EVTCHAP;                   /* CHAP USER             @YM05632*/ 02042000
*                                                                  0563 02043000
         BAL   @14,EVTCHAP                                         0563 02044000
*   /*****************************************************************/ 02045000
*   /*                                                               */ 02046000
*   /* ? IRACTLCL EPN(CTL)                                           */ 02047000
*   /*                                                               */ 02048000
*   /*****************************************************************/ 02049000
*                                                                  0564 02050000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 02051000
*                                                                  0564 02052000
         L     @12,RMEXCTL(,RMCTPTR)                               0564 02053000
         BR    @12                                                 0564 02054000
*   /*****************************************************************/ 02055000
*   /*                                                               */ 02056000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 02057000
*   /*                                                               */ 02058000
*   /*****************************************************************/ 02059000
*                                                                  0565 02060000
*   RESPECIFY                                                      0565 02061000
*    (OUXBPTR) UNRSTD;              /* PTR TO OUXB NOT NEEDED        */ 02062000
*IRARME09:                          /* SYSEVENT 9 - JOBTERM          */ 02063000
*   IF OUCBATR='1'B THEN            /* USER UNDER WLM CONTROL        */ 02064000
*                                                                  0566 02065000
IRARME09 TM    OUCBATR(OUCBPTR),B'10000000'                        0566 02066000
         BNO   @RF00566                                            0566 02067000
*     /***************************************************************/ 02068000
*     /*                                                             */ 02069000
*     /* TERMINATE ONGOING SESSION TRANSACTION ACTIVITY RECORDKEEPING*/ 02070000
*     /*                                                             */ 02071000
*     /***************************************************************/ 02072000
*                                                                  0567 02073000
*     DO;                                                          0567 02074000
*       OUCBSTR='1'B;               /* FORCE TRANSACTION END         */ 02075000
*                                                                  0568 02076000
         OI    OUCBSTR(OUCBPTR),B'01000000'                        0568 02077000
*       /*************************************************************/ 02078000
*       /*                                                           */ 02079000
*       /* ? IRACTLCL EPN(WMO)                                       */ 02080000
*       /*                                                           */ 02081000
*       /*************************************************************/ 02082000
*                                                                  0569 02083000
*       CALL RMSBWMO->IRARMRTN;     /* INVOKE WMO SUBRTN             */ 02084000
*                                                                  0569 02085000
         L     @15,RMSBWMO(,RMCTPTR)                               0569 02086000
         BALR  @14,@15                                             0569 02087000
*       /*************************************************************/ 02088000
*       /*                                                           */ 02089000
*       /* END ANY CURRENT TRANSACTION                               */ 02090000
*       /*                                                           */ 02091000
*       /*************************************************************/ 02092000
*                                                                  0570 02093000
*     END;                                                         0570 02094000
*   ASCBOUXB->ACCNTFLD=''B;         /* CLEAR OUXB ACCOUNTING FIELDS  */ 02095000
@RF00566 L     @12,ASCBOUXB(,ASCBPTR)                              0571 02096000
         XC    ACCNTFLD(28,@12),ACCNTFLD(@12)                      0571 02097000
*   OUCBLWT='0'B;                                                  0572 02098000
         NI    OUCBLWT(OUCBPTR),B'01111111'                        0572 02099000
*   OUCBRPG=ZERO;                   /* CLEAR RESET PGN SO INIT DOES     02100000
*                                      NOT KEEP THIS ONE     @Z40BPEB*/ 02101000
         MVI   OUCBRPG(OUCBPTR),X'00'                              0573 02102000
*   OUCBMWT='0'B;                                                  0574 02103000
*   OUCBCIM='0'B;                                                  0575 02104000
*   OUCBOWT='0'B;                                                  0576 02105000
*   OUCBTRM='0'B;                                                  0577 02106000
         NI    OUCBMWT(OUCBPTR),B'10001110'                        0577 02107000
*   OUCBINP='0'B;                   /* SHOW INITIATOR ATTACH IGNORED */ 02108000
*   OUCBINC='0'B;                   /* RESET INITIATOR ATTACH STATUS */ 02109000
*   OUCBSTR='0'B;                   /* RESET TRANSACTION BEGN STATUS */ 02110000
         NI    OUCBINP(OUCBPTR),B'10111100'                        0580 02111000
*   OUCBBIB='0'B;                   /* RESET BRINGIN BIT     @Z40BPEB*/ 02112000
*   OUCBPVL='1'B;                   /* IGNORE USER, WLM..    @Z40BPEB*/ 02113000
         OI    OUCBPVL(OUCBPTR),B'00000100'                        0582 02114000
         NI    OUCBBIB(OUCBPTR),B'11011111'                        0582 02115000
*   OUCBDMN=ZERO;                   /* ALLOW ROTATION OF INITS     0583 02116000
*                                                            @Z40BPEB*/ 02117000
         MVI   OUCBDMN(OUCBPTR),X'00'                              0583 02118000
*   OUCBDMO=ZERO;                   /* BY FORCING TO DMN0    @Z40BPEB*/ 02119000
*                                                                  0584 02120000
         SLR   @12,@12                                             0584 02121000
         STH   @12,OUCBDMO(,OUCBPTR)                               0584 02122000
*   /*****************************************************************/ 02123000
*   /*                                                               */ 02124000
*   /* ? IRACTLCL EPN(CTL)                                           */ 02125000
*   /*                                                               */ 02126000
*   /*****************************************************************/ 02127000
*                                                                  0585 02128000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 02129000
*                                                                  0585 02130000
         L     @12,RMEXCTL(,RMCTPTR)                               0585 02131000
         BR    @12                                                 0585 02132000
*   /*****************************************************************/ 02133000
*   /*                                                               */ 02134000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 02135000
*   /*                                                               */ 02136000
*   /*****************************************************************/ 02137000
*                                                                  0586 02138000
*IRARME10:                          /* SYSEVENT 10 - INITATT         */ 02139000
*/*                                                                  */ 02140000
*/*   RESET WAIT BITS.                                               */ 02141000
*/*                                                                  */ 02142000
*                                                                  0586 02143000
*   OUCBLWT='0'B;                                                  0586 02144000
IRARME10 DS    0H                                                  0587 02145000
*   OUCBMWT='0'B;                                                  0587 02146000
*   OUCBCIM='0'B;                                                  0588 02147000
*   OUCBOWT='0'B;                                                  0589 02148000
*   OUCBTRM='0'B;                                                  0590 02149000
         NI    OUCBLWT(OUCBPTR),B'00001110'                        0590 02150000
*   OUCBBIB='0'B;                   /* MAKE SURE USER IS SWAPPABLE 0591 02151000
*                                                            @ZM43093*/ 02152000
         NI    OUCBBIB(OUCBPTR),B'11011111'                        0591 02153000
*   ASCBIOSM=ZERO;                  /* RESET I/O COUNT       @ZA10808*/ 02154000
         SLR   @12,@12                                             0592 02155000
         STH   @12,ASCBIOSM(,ASCBPTR)                              0592 02156000
*   OUCBIOSM=ZERO;                  /* RESET I/O COUNT       @ZA10808*/ 02157000
         ST    @12,OUCBIOSM(,OUCBPTR)                              0593 02158000
*   OUCBPS2=ZERO;                   /* CLEAR PAGE SECONDS    @Z40BPEB*/ 02159000
         ST    @12,OUCBPS2(,OUCBPTR)                               0594 02160000
*   OUCBPS1=ZERO;                   /* CLEAR PAGE SECONDS    @Z40BPEB*/ 02161000
         ST    @12,OUCBPS1(,OUCBPTR)                               0595 02162000
*   OUCBPST=ZERO;                   /* AND STEP TIME.        @Z40BPEB*/ 02163000
         ST    @12,OUCBPST(,OUCBPTR)                               0596 02164000
*   OUCBINC='0'B;                   /* RESET INITIATOR ATTACH STATUS */ 02165000
         NI    OUCBINC(OUCBPTR),B'11111110'                        0597 02166000
*   IF OUCBINP='1'B THEN            /* JOB SELECT SYSEVENT PROCESSED */ 02167000
         TM    OUCBINP(OUCBPTR),B'00000010'                        0598 02168000
         BNO   @RF00598                                            0598 02169000
*     OUCBINC='1'B;                 /* SHOW INITIATOR ATTACH CURRENT */ 02170000
         OI    OUCBINC(OUCBPTR),B'00000001'                        0599 02171000
*   IF OUCBTSWC='0'B THEN           /* INITIATOR DIDN'T      @ZA16887*/ 02172000
@RF00598 TM    OUCBTSWC(OUCBPTR),B'00001000'                       0600 02173000
         BNZ   @RF00600                                            0600 02174000
*     DO;                           /* ISSUE TRANSWAP        @ZA16887*/ 02175000
*       OUCBNSW='0'B;               /* RESET NOSWAP FLAG     @ZA16887*/ 02176000
         NI    OUCBNSW(OUCBPTR),B'01111111'                        0602 02177000
*       OUCBNDS=ZERO;               /* RESET NOSWAP COUNT    @ZA16887*/ 02178000
         SLR   @12,@12                                             0603 02179000
         STH   @12,OUCBNDS(,OUCBPTR)                               0603 02180000
*     END;                          /*                       @ZA16887*/ 02181000
*   OUCBASW='0'B;                   /* RESET AUTH FLAG       @ZA16887*/ 02182000
@RF00600 NI    OUCBASW(OUCBPTR),B'11111110'                        0605 02183000
*   IF RRPAASW='1'B THEN            /* A.S. IS AUTHORIZED TO ISSUE 0606 02184000
*                                      DONTSWAP/OKSWAP       @ZA16887*/ 02185000
         TM    RRPAASW(RRPAPTR),B'00000010'                        0606 02186000
         BNO   @RF00606                                            0606 02187000
*     DO;                                                          0607 02188000
*       IF ASCBPTR=RMCAMAS THEN     /* IF MASTER SCHEDULER   @Z30WIMG*/ 02189000
         C     ASCBPTR,RMCAMAS(,RMCTPTR)                           0608 02190000
         BNE   @RF00608                                            0608 02191000
*         RRPANPG=ZERO;             /* INSURE PGN IS ZERO    @Z30WIMG*/ 02192000
         MVI   RRPANPG(RRPAPTR),X'00'                              0609 02193000
*       OUCBASW='1'B;               /* PERMIT MEMORY TO ISSUE SYS- 0610 02194000
*                                      EVENTS 41 AND 42 IN ORDER TO     02195000
*                                      CHANGE ITS SWAPPABLE STATUS   */ 02196000
@RF00608 OI    OUCBASW(OUCBPTR),B'00000001'                        0610 02197000
*     END;                                                         0611 02198000
*                                                                  0611 02199000
*/*                                                                  */ 02200000
*/*   DETERMINE THE PERFORMANCE GROUP NUMBER(PGN) UNDER WHICH THE NEW*/ 02201000
*/*   STEP WILL EXECUTE.  IF THE NEW PGN IS ZERO(0), THEN THE USER   */ 02202000
*/*   WILL EXECUTE IN PRIVILEGED STATUS. A MEMORY IN THIS STATE WILL */ 02203000
*/*   BE IN DOM 0.  A PGN INPUT VIA A RESET COMMAND SUPERCEDES ALL   */ 02204000
*/*   NON-ZERO PGNS FOR THIS USER.  NON-ZERO PGNS WILL BE VALIDATED  */ 02205000
*/*   AND A DEFAULT PGN SUPPLIED BASED ON THE MEMORY ORIGIN.         */ 02206000
*/*                                                                  */ 02207000
*                                                                  0612 02208000
*   OUCBSPG=RRPANPG;                /* SAVE INPUT PGN        @ZA17805*/ 02209000
@RF00606 IC    @12,RRPANPG(,RRPAPTR)                               0612 02210000
         STC   @12,OUCBSPG(,OUCBPTR)                               0612 02211000
*   IF RRPANPG=ZERO THEN            /* IF NEW PGN IS ZERO,           */ 02212000
         CLI   RRPANPG(RRPAPTR),0                                  0613 02213000
         BNE   @RF00613                                            0613 02214000
*     DO;                           /* MEMORY WILL EXECUTE PRIVILEGED*/ 02215000
*       OUCBNPG=ZERO;               /* SAVE NEW PGN                  */ 02216000
         MVI   OUCBNPG(OUCBPTR),X'00'                              0615 02217000
*       OUCBDMN=ZERO;               /* PRIV....DOMAIN ZERO   @Z40BPEB*/ 02218000
         MVI   OUCBDMN(OUCBPTR),X'00'                              0616 02219000
*       OUCBDMO=ZERO;               /* PRIV....DOMAIN ZERO   @Z40BPEB*/ 02220000
         SLR   @12,@12                                             0617 02221000
         STH   @12,OUCBDMO(,OUCBPTR)                               0617 02222000
*       OUCBPVL='1'B;               /* INDICATE PRIVILEGED MEMORY    */ 02223000
         OI    OUCBPVL(OUCBPTR),B'00000100'                        0618 02224000
*     END;                                                         0619 02225000
*   ELSE                            /* NEW PGN IS NON-ZERO           */ 02226000
*     DO;                                                          0620 02227000
         B     @RC00613                                            0620 02228000
@RF00613 DS    0H                                                  0621 02229000
*       OUCBPVL='0'B;               /* MEMORY NO LONGER PRIVILEGED   */ 02230000
         NI    OUCBPVL(OUCBPTR),B'11111011'                        0621 02231000
*       IF OUCBRPG=ZERO THEN        /* IF RESET COMMAND NOT PROCESSED*/ 02232000
         CLI   OUCBRPG(OUCBPTR),0                                  0622 02233000
         BNE   @RF00622                                            0622 02234000
*         OUCBNPG=RRPANPG;          /* NEW PGN INPUT WITH SYSEVENT   */ 02235000
         IC    @12,RRPANPG(,RRPAPTR)                               0623 02236000
         STC   @12,OUCBNPG(,OUCBPTR)                               0623 02237000
*       ELSE                        /* RESET COMMAND PROCESSED       */ 02238000
*         OUCBNPG=OUCBRPG;          /* RESET COMMAND PGN REPLACES ANY   02239000
*                                      INPUT WITH THE SYSEVENT       */ 02240000
*                                                                  0624 02241000
         B     @RC00622                                            0624 02242000
@RF00622 IC    @12,OUCBRPG(,OUCBPTR)                               0624 02243000
         STC   @12,OUCBNPG(,OUCBPTR)                               0624 02244000
*       /*************************************************************/ 02245000
*       /*                                                           */ 02246000
*       /* THE NEW PGN IS VALIDATED BY USING IT AS AN INDEX INTO THE */ 02247000
*       /* WORKLOAD MANAGER PERFORMANCE GROUP VECTOR TABLE(WPGVT), AN*/ 02248000
*       /* ARRAY OF 2 BYTE ELEMENTS. EACH ELEMENT REPRESENTS AN      */ 02249000
*       /* OFFSET TO ONE OF THE PERFORMANCE GROUPS THAT CAN BE       */ 02250000
*       /* DEFINED WITH- IN AN IPS. THOSE PERFORMANCE GROUPS THAT ARE*/ 02251000
*       /* INVALID HAVE A ZERO OFFSET. IF THE INDEXED ELEMENT IS     */ 02252000
*       /* NON-ZERO, THEN THE PGN IS VALID. OTHERWISE DETERMINE THE  */ 02253000
*       /* DEFAULT PGN TO BE USED BASED ON THE COMMAND FROM WHICH THE*/ 02254000
*       /* MEMORY ORIGINATED.                                        */ 02255000
*       /*                                                           */ 02256000
*       /*************************************************************/ 02257000
*                                                                  0625 02258000
*       IF(OUCBNPG>WMSTPGHI|        /* IF THE NEW PGN IS UNDEFINED   */ 02259000
*           WPGVTENT=ZERO) THEN     /* IN THE CURRENT IPS,           */ 02260000
*                                                                  0625 02261000
@RC00622 SLR   @12,@12                                             0625 02262000
         IC    @12,OUCBNPG(,OUCBPTR)                               0625 02263000
         L     @11,WMSTPTR(,RMCTPTR)                               0625 02264000
         CH    @12,WMSTPGHI(,@11)                                  0625 02265000
         BH    @RT00625                                            0625 02266000
         ALR   @12,@12                                             0625 02267000
         AL    @12,WMSTPGVT(,@11)                                  0625 02268000
         LH    @12,WPGVTENT(,@12)                                  0625 02269000
         LTR   @12,@12                                             0625 02270000
         BNZ   @RF00625                                            0625 02271000
@RT00625 DS    0H                                                  0626 02272000
*         /***********************************************************/ 02273000
*         /*                                                         */ 02274000
*         /* DETERMINE THE DEFAULT PGN FOR THIS USER BASED ON THE    */ 02275000
*         /* COMMAND FROM WHICH THE MEMORY ORIGINATED.               */ 02276000
*         /*                                                         */ 02277000
*         /***********************************************************/ 02278000
*                                                                  0626 02279000
*         DO;                                                      0626 02280000
*           IF OUCBLOG='1'B THEN    /* MEMORY ORIGINATED VIA LOGON   */ 02281000
         TM    OUCBLOG(OUCBPTR),B'00100000'                        0627 02282000
         BNO   @RF00627                                            0627 02283000
*             OUCBNPG=RMCALGPG;     /* DEFAULT PGN FOR LOGON @Z40BPJE*/ 02284000
         IC    @12,RMCALGPG(,RMCTPTR)                              0628 02285000
         STC   @12,OUCBNPG(,OUCBPTR)                               0628 02286000
*           ELSE                    /* MEMORY ORIGINATED VIA START OR   02287000
*                                      MOUNT                         */ 02288000
*             OUCBNPG=RMCABCPG;     /* DEFAULT PGN FOR ALL OTHER   0629 02289000
*                                      USERS                 @Z40BPJE*/ 02290000
         B     @RC00627                                            0629 02291000
@RF00627 IC    @12,RMCABCPG(,RMCTPTR)                              0629 02292000
         STC   @12,OUCBNPG(,OUCBPTR)                               0629 02293000
*         END;                                                     0630 02294000
@RC00627 DS    0H                                                  0631 02295000
*     END;                                                         0631 02296000
*                                                                  0631 02297000
@RF00625 DS    0H                                                  0632 02298000
*   /*****************************************************************/ 02299000
*   /*                                                               */ 02300000
*   /*                                                       @Z40BPJE*/ 02301000
*   /* PLACE DOMAIN # & OFFSET IN OUCB                       @Z40BPJE*/ 02302000
*   /*                                                       @Z40BPJE*/ 02303000
*   /*                                                               */ 02304000
*   /*****************************************************************/ 02305000
*                                                                  0632 02306000
*   IF OUCBINC='1'B THEN            /* IF USER UNDER WLM CONTROL     */ 02307000
@RC00613 TM    OUCBINC(OUCBPTR),B'00000001'                        0632 02308000
         BNO   @RF00632                                            0632 02309000
*/*                                                                  */ 02310000
*/*   DETERMINE THE TRANSACTION STATUS WITHIN THIS MEMORY.  A TRANS- */ 02311000
*/*   ACTION FOR A USER WHOSE MEMORY ORIGIN WAS A START COMMAND CAN  */ 02312000
*/*   EXTEND ACROSS JOB STEPS.  IF THE PGN FOR THE NEW STEP IS THE   */ 02313000
*/*   SAME AS THAT OF THE PREVIOUS STEP, THEN AN EXISTING TRANSACTION*/ 02314000
*/*   THAT WAS SUSPENDED AT THE PREVIOUS INITDET SYSEVENT SHOULD BE  */ 02315000
*/*   RESUMED.  OTHERWISE A NEW TRANSACTION SHOULD BE STARTED.       */ 02316000
*/*                                                                  */ 02317000
*                                                                  0633 02318000
*     DO;                                                          0633 02319000
*       IF OUCBSTT='1'B&            /* IF THE ORIGIN OF THE          */ 02320000
*           OUCBNPG=(ADDR(WPGD)+    /* MEMORY IS A START COMMAND AND */ 02321000
*           OUCBWMG)->              /* THE NEW PGN IS THE SAME AS    */ 02322000
*           WPGDPGN THEN            /* THE PREVIOUS ONE,             */ 02323000
*                                                                  0634 02324000
         TM    OUCBSTT(OUCBPTR),B'01000000'                        0634 02325000
         BNO   @RF00634                                            0634 02326000
         L     @12,WMSTPTR(,RMCTPTR)                               0634 02327000
         LH    @11,OUCBWMG(,OUCBPTR)                               0634 02328000
         AL    @11,WPGDPTR(,@12)                                   0634 02329000
         CLC   OUCBNPG(1,OUCBPTR),WPGDPGN(@11)                     0634 02330000
         BNE   @RF00634                                            0634 02331000
*         /***********************************************************/ 02332000
*         /*                                                         */ 02333000
*         /* ? IRACTLCL EPN(WMR)                                     */ 02334000
*         /*                                                         */ 02335000
*         /***********************************************************/ 02336000
*                                                                  0635 02337000
*         CALL RMSBWMR->IRARMRTN;   /* INVOKE WMR SUBRTN             */ 02338000
*                                                                  0635 02339000
         L     @15,RMSBWMR(,RMCTPTR)                               0635 02340000
         BALR  @14,@15                                             0635 02341000
*       /*************************************************************/ 02342000
*       /*                                                           */ 02343000
*       /* RESUME OLD TRANSACTION                                    */ 02344000
*       /*                                                           */ 02345000
*       /*************************************************************/ 02346000
*                                                                  0636 02347000
*       ELSE                                                       0636 02348000
*         DO;                                                      0636 02349000
         B     @RC00634                                            0636 02350000
@RF00634 DS    0H                                                  0637 02351000
*           OUCBPGP=WPGPOFST;       /* FIRST PERIOD OFFSET   @Z40BPEB*/ 02352000
         LA    @12,12                                              0637 02353000
         STC   @12,OUCBPGP(,OUCBPTR)                               0637 02354000
*           WPGPPTR=WMSTPGDT+WPGVTENT+/* RESOLVE ADDRESSING TO     0638 02355000
*                                                            @Z40BPJE*/ 02356000
*               OUCBPGP;            /* THE CORRECT PGP       @Z40BPJE*/ 02357000
         L     @10,WMSTPTR(,RMCTPTR)                               0638 02358000
         SLR   @07,@07                                             0638 02359000
         IC    @07,OUCBNPG(,OUCBPTR)                               0638 02360000
         ALR   @07,@07                                             0638 02361000
         AL    @07,WMSTPGVT(,@10)                                  0638 02362000
         LH    WPGPPTR,WPGVTENT(,@07)                              0638 02363000
         AL    WPGPPTR,WMSTPGDT(,@10)                              0638 02364000
         ALR   WPGPPTR,@12                                         0638 02365000
*           OUCBDMN=WPGPDMN;        /* INITIALIZE THE DOMAIN NUMBER     02366000
*                                                            @Z40BPJE*/ 02367000
         SLR   @12,@12                                             0639 02368000
         IC    @12,WPGPDMN(,WPGPPTR)                               0639 02369000
         STC   @12,OUCBDMN(,OUCBPTR)                               0639 02370000
*           OUCBDMO=WDMVTENT;       /* AND DOMAIN OFFSET     @Z40BPJE*/ 02371000
*                                                                  0640 02372000
         ALR   @12,@12                                             0640 02373000
         AL    @12,WMSTDMVT(,@10)                                  0640 02374000
         LH    @12,WDMVTENT(,@12)                                  0640 02375000
         STH   @12,OUCBDMO(,OUCBPTR)                               0640 02376000
*           /*********************************************************/ 02377000
*           /*                                                       */ 02378000
*           /* ? IRACTLCL EPN(WMN)                                   */ 02379000
*           /*                                                       */ 02380000
*           /*********************************************************/ 02381000
*                                                                  0641 02382000
*           CALL RMSBWMN->IRARMRTN; /* INVOKE WMN SUBRTN             */ 02383000
*                                                                  0641 02384000
         L     @15,RMSBWMN(,RMCTPTR)                               0641 02385000
         BALR  @14,@15                                             0641 02386000
*           /*********************************************************/ 02387000
*           /*                                                       */ 02388000
*           /* START A NEW TRANSACTION                               */ 02389000
*           /*                                                       */ 02390000
*           /*********************************************************/ 02391000
*                                                                  0642 02392000
*         END;                                                     0642 02393000
*     END;                                                         0643 02394000
*   ELSE                                                           0644 02395000
*     DO;                           /* NOT UNDER WLM CONTROL @Z40BPEB*/ 02396000
         B     @RC00632                                            0644 02397000
@RF00632 DS    0H                                                  0645 02398000
*       OUCBPGP=WPGPOFST;           /* FIRST PERIOD OFFSET   @Z40BPEB*/ 02399000
         LA    @12,12                                              0645 02400000
         STC   @12,OUCBPGP(,OUCBPTR)                               0645 02401000
*       WPGPPTR=WMSTPGDT+WPGVTENT+  /* RESOLVE ADDRESSING TO @Z40BPJE*/ 02402000
*           OUCBPGP;                /* THE CORRECT PGP       @Z40BPJE*/ 02403000
         L     @10,WMSTPTR(,RMCTPTR)                               0646 02404000
         SLR   @07,@07                                             0646 02405000
         IC    @07,OUCBNPG(,OUCBPTR)                               0646 02406000
         ALR   @07,@07                                             0646 02407000
         AL    @07,WMSTPGVT(,@10)                                  0646 02408000
         LH    WPGPPTR,WPGVTENT(,@07)                              0646 02409000
         AL    WPGPPTR,WMSTPGDT(,@10)                              0646 02410000
         ALR   WPGPPTR,@12                                         0646 02411000
*       OUCBDMN=WPGPDMN;            /* INITIALIZE THE DOMAIN NUMBER     02412000
*                                                            @Z40BPJE*/ 02413000
         SLR   @12,@12                                             0647 02414000
         IC    @12,WPGPDMN(,WPGPPTR)                               0647 02415000
         STC   @12,OUCBDMN(,OUCBPTR)                               0647 02416000
*       OUCBDMO=WDMVTENT;           /* AND DOMAIN OFFSET     @Z40BPJE*/ 02417000
         ALR   @12,@12                                             0648 02418000
         AL    @12,WMSTDMVT(,@10)                                  0648 02419000
         LH    @12,WDMVTENT(,@12)                                  0648 02420000
         STH   @12,OUCBDMO(,OUCBPTR)                               0648 02421000
*     END;                          /*                       @Z40BPEB*/ 02422000
*   RESPECIFY                                                      0650 02423000
*    (OUXBPTR) RSTD;                                               0650 02424000
@RC00632 DS    0H                                                  0651 02425000
*   OUXBPTR=ASCBOUXB;               /* EST ADDRESSABILITY TO THE OUXB*/ 02426000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0651 02427000
*/*                                                                  */ 02428000
*/*   ESTABLISH BASE I/O USAGE VALUE AND BASE TIME FOR THE I/O LOAD  */ 02429000
*/*   BALANCING ALGORITHM.                                           */ 02430000
*/*                                                                  */ 02431000
*                                                                  0652 02432000
*   OUXBILS=ZERO;                   /* BASE I/O USAGE MEASUREMENT  0652 02433000
*                                                            @ZA10808*/ 02434000
         SLR   @12,@12                                             0652 02435000
         ST    @12,OUXBILS(,OUXBPTR)                               0652 02436000
*   OUXBITD=RMCTTOD;                /* BASE TIME OF DAY              */ 02437000
         L     @07,RMCTTOD(,RMCTPTR)                               0653 02438000
         ST    @07,OUXBITD(,OUXBPTR)                               0653 02439000
*   OUCBIOR=ZERO;                   /* RESET I/O USAGE PROFILE       */ 02440000
         STH   @12,OUCBIOR(,OUCBPTR)                               0654 02441000
*/*                                                                  */ 02442000
*/*   ESTABLISH BASE VAM AND NON-VAM DATA SET AUXILIARY STORAGE      */ 02443000
*/*   ALLOCATED SLOT COUNT VALUES AND BASE TIME FOR THE AUX SLOT     */ 02444000
*/*   SHORTAGE MONITORING ALGORITHM.                                 */ 02445000
*/*                                                                  */ 02446000
*                                                                  0655 02447000
*   OUXBVSC=ASCBVSC;                /* BASE VAM SLOT COUNT           */ 02448000
         LH    @11,ASCBVSC(,ASCBPTR)                               0655 02449000
         STH   @11,OUXBVSC(,OUXBPTR)                               0655 02450000
*   OUXBNVC=ASCBNVSC;               /* BASE NON-VAM SLOT COUNT       */ 02451000
         LH    @11,ASCBNVSC(,ASCBPTR)                              0656 02452000
         STH   @11,OUXBNVC(,OUXBPTR)                               0656 02453000
*   OUXBSTD=RMCTTOD;                /* BASE TIME OF DAY OF SLOT COUNT*/ 02454000
         ST    @07,OUXBSTD(,OUXBPTR)                               0657 02455000
*   OUXBPET=ZERO;                   /* RESET PAGE STEAL CPU INTERVAL */ 02456000
         ST    @12,OUXBPET(,OUXBPTR)                               0658 02457000
*/*                                                                  */ 02458000
*/*   SET UP NEW APG STATUS FOR THIS MEMORY AND HAVE THE MEMORY MOVED*/ 02459000
*/*   TO THE CORRECT POSITION ON THE ASCB QUEUE.                     */ 02460000
*/*                                                                  */ 02461000
*                                                                  0659 02462000
*   GOTO IRARMAPG;                                                 0659 02463000
         B     IRARMAPG                                            0659 02464000
*   RESPECIFY                                                      0660 02465000
*    (OUXBPTR) UNRSTD;              /* ADDRESSABILITY TO OUXB NO   0660 02466000
*                                      LONGER REQUIRED.              */ 02467000
*IRARME11:                          /* SYSEVENT 11 - INITDET         */ 02468000
*/*                                                                  */ 02469000
*/*   RESET WAIT BITS.                                               */ 02470000
*/*                                                                  */ 02471000
*                                                                  0661 02472000
*   OUCBLWT='0'B;                                                  0661 02473000
IRARME11 DS    0H                                                  0662 02474000
*   OUCBMWT='0'B;                                                  0662 02475000
*   OUCBCIM='0'B;                                                  0663 02476000
*   OUCBOWT='0'B;                                                  0664 02477000
*   OUCBTRM='0'B;                                                  0665 02478000
         NI    OUCBLWT(OUCBPTR),B'00001110'                        0665 02479000
*   OUCBNDS=ZERO;                   /* CLEAR COUNT OF OUTSTANDING  0666 02480000
*                                      DONTSWAP SYSEVENTS WHICH ARE     02481000
*                                      NOT VALID ACROSS JOB STEPS    */ 02482000
         SLR   @12,@12                                             0666 02483000
         STH   @12,OUCBNDS(,OUCBPTR)                               0666 02484000
*   OUCBNSW='0'B;                   /* CURRENT STATUS OF MEMORY IS 0667 02485000
*                                      SWAPPABLE                     */ 02486000
*   OUCBPVL='0'B;                   /* MARK MEMORY AS NON- PRIVILEGED   02487000
*                                      STATUS                @Z40BPJE*/ 02488000
         NI    OUCBNSW(OUCBPTR),B'01111011'                        0668 02489000
*   OUCBASW='0'B;                   /* RESCIND AUTHORIZATION OF    0669 02490000
*                                      MEMORY TO ISSUE SYSEVENTS 41     02491000
*                                      AND 42                        */ 02492000
         NI    OUCBASW(OUCBPTR),B'11111110'                        0669 02493000
*   OUCBPST=ZERO;                   /* RESET STEP TIME       @Z40BPEB*/ 02494000
         SLR   @12,@12                                             0670 02495000
         ST    @12,OUCBPST(,OUCBPTR)                               0670 02496000
*   OUCBINC='0'B;                   /* RESET INITIATOR ATTACH STATUS    02497000
*                                      THIS STOPS DELAY IF BETWEEN 0671 02498000
*                                      JOBSTEPS              @ZA11855*/ 02499000
*                                                                  0671 02500000
         NI    OUCBINC(OUCBPTR),B'11111110'                        0671 02501000
*   /*****************************************************************/ 02502000
*   /*                                                               */ 02503000
*   /* RESET TRANSWAP AND REQSWAP FIELDS. FREE ANY STORAGE CELLS USED*/ 02504000
*   /* FOR ECB LISTS.                                        @ZA20975*/ 02505000
*   /*                                                               */ 02506000
*   /*****************************************************************/ 02507000
*                                                                  0672 02508000
*   IF PVTAPREF='0'B THEN           /* IF ALLOWED            @ZA16887*/ 02509000
         L     @12,CVTPTR                                          0672 02510000
         L     @12,PVTPTR(,@12)                                    0672 02511000
         TM    PVTAPREF(@12),B'00001000'                           0672 02512000
         BNZ   @RF00672                                            0672 02513000
*     DO;                           /* RESET PREFERRED STORAGE     0673 02514000
*                                                            @ZA16887*/ 02515000
*       ASCB1LPU='0'B;              /* INDICATORS - 1ST LEVEL,     0674 02516000
*                                                            @ZA16887*/ 02517000
*       ASCB2LPU='0'B;              /* 2ND LEVEL, AND        @ZA16887*/ 02518000
*       ASCBN2LP='0'B;              /* NEVER 2ND LEVEL       @ZA16887*/ 02519000
         L     @12,ASCBN2LP(,ASCBPTR)                              0676 02520000
@GL00020 LR    @11,@12                                             0676 02521000
         N     @11,@CF02698                                        0676 02522000
         CS    @12,@11,ASCBN2LP(ASCBPTR)                           0676 02523000
         BNE   @GL00020                                            0676 02524000
*     END;                          /*                       @ZA16887*/ 02525000
*   RFY                                                            0678 02526000
*     OUXBPTR RSTD;                 /* PTR TO OUXB           @ZA16887*/ 02527000
@RF00672 DS    0H                                                  0679 02528000
*   OUXBPTR=ASCBOUXB;               /* ADDRESSABILITY TO OUXB      0679 02529000
*                                                            @ZA16887*/ 02530000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0679 02531000
*   RFY                                                            0680 02532000
*     ECBFIELD BASED(ADDR(OUXBRSW));/* FIRST, REQSWAP...     @ZA20975*/ 02533000
*   IF ECBLISTB='1'B THEN           /* DOES ECB LIST EXIST?  @ZA20975*/ 02534000
         LA    @12,12                                              0681 02535000
         ALR   @12,OUXBPTR                                         0681 02536000
         TM    ECBLISTB(@12),B'10000000'                           0681 02537000
         BNO   @RF00681                                            0681 02538000
*     DO;                           /* YES, FREE ITS CELL:   @ZA20975*/ 02539000
*       R0=LENGTH(OUXB);            /* IN CASE I04 INVOKED   @ZA20975*/ 02540000
         LA    R0,144                                              0683 02541000
*       R1=SWAPECB;                 /* PASS ADDRESS OF CELL  @ZA20975*/ 02542000
*                                                                  0684 02543000
         L     R1,SWAPECB(,@12)                                    0684 02544000
*       /*************************************************************/ 02545000
*       /*                                                           */ 02546000
*       /* ? IRACTLCL EPN(I04)                                       */ 02547000
*       /*                                                           */ 02548000
*       /*************************************************************/ 02549000
*                                                                  0685 02550000
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */ 02551000
*                                                                  0685 02552000
         L     @15,RMSBI04(,RMCTPTR)                               0685 02553000
         BALR  @14,@15                                             0685 02554000
*       /*************************************************************/ 02555000
*       /*                                                           */ 02556000
*       /* INVOKE FREECELL RTN                               @ZA20975*/ 02557000
*       /*                                                           */ 02558000
*       /*************************************************************/ 02559000
*                                                                  0686 02560000
*     END;                          /* END REQSWAP FREECELL  @ZA20975*/ 02561000
*   ECBFIELD=ZERO;                  /* CLEAR OUXBRSW FIELD   @ZA20975*/ 02562000
@RF00681 SLR   @12,@12                                             0687 02563000
         ST    @12,ECBFIELD+12(,OUXBPTR)                           0687 02564000
*   RFY                                                            0688 02565000
*     ECBFIELD BASED(ADDR(OUXBTSW));/* NOW, TRANSWAP...      @ZA20975*/ 02566000
*   IF ECBLISTB='1'B THEN           /* DOES ECB LIST EXIST?  @ZA20975*/ 02567000
         LA    @12,140                                             0689 02568000
         ALR   @12,OUXBPTR                                         0689 02569000
         TM    ECBLISTB(@12),B'10000000'                           0689 02570000
         BNO   @RF00689                                            0689 02571000
*     DO;                           /* YES, FREE ITS CELL:   @ZA20975*/ 02572000
*       R0=LENGTH(OUXB);            /* IN CASE I04 INVOKED   @ZA20975*/ 02573000
         LA    R0,144                                              0691 02574000
*       R1=SWAPECB;                 /* PASS ADDRESS OF CELL  @ZA20975*/ 02575000
*                                                                  0692 02576000
         L     R1,SWAPECB(,@12)                                    0692 02577000
*       /*************************************************************/ 02578000
*       /*                                                           */ 02579000
*       /* ? IRACTLCL EPN(I04)                                       */ 02580000
*       /*                                                           */ 02581000
*       /*************************************************************/ 02582000
*                                                                  0693 02583000
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */ 02584000
*                                                                  0693 02585000
         L     @15,RMSBI04(,RMCTPTR)                               0693 02586000
         BALR  @14,@15                                             0693 02587000
*       /*************************************************************/ 02588000
*       /*                                                           */ 02589000
*       /* INVOKE FREECELL RTN                               @ZA20975*/ 02590000
*       /*                                                           */ 02591000
*       /*************************************************************/ 02592000
*                                                                  0694 02593000
*     END;                          /* END TRANSWAP FREECELL @ZA20975*/ 02594000
*   ECBFIELD=ZERO;                  /* CLEAR OUXBTSW FIELD   @ZA20975*/ 02595000
@RF00689 SLR   @12,@12                                             0695 02596000
         ST    @12,ECBFIELD+140(,OUXBPTR)                          0695 02597000
*   RFY                                                            0696 02598000
*     ECBFIELD BASED(ECBPARM);      /* NORMAL BASING         @ZA20975*/ 02599000
*   OUCBTSWP='0'B;                  /* RESET TRANSWAP PENDING      0697 02600000
*                                                            @ZA16887*/ 02601000
*   OUCBTSWC='0'B;                  /* RESET TRANSWAP COMPLETE     0698 02602000
*                                                            @ZA16887*/ 02603000
         NI    OUCBTSWP(OUCBPTR),B'11100111'                       0698 02604000
*   OUCBNTSP=ZERO;                  /* RESET PENDING COUNT   @ZA20975*/ 02605000
         STH   @12,OUCBNTSP(,OUCBPTR)                              0699 02606000
*   IF OUCBRSWP='1'B                /* REQSWAP PENDING?      @ZA31733*/ 02607000
*     THEN                                                         0700 02608000
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       0700 02609000
         BNO   @RF00700                                            0700 02610000
*     CALL EVTCSOD;                 /* YES. ATTEMPT SWAP OUT @ZA31733*/ 02611000
*                                                                  0701 02612000
         BAL   @14,EVTCSOD                                         0701 02613000
*   /*****************************************************************/ 02614000
*   /*                                                               */ 02615000
*   /* ? IRACTLCL EPN(WMO)                                           */ 02616000
*   /*                                                               */ 02617000
*   /*****************************************************************/ 02618000
*                                                                  0702 02619000
*   CALL RMSBWMO->IRARMRTN;         /* INVOKE WMO SUBRTN             */ 02620000
*                                                                  0702 02621000
@RF00700 L     @15,RMSBWMO(,RMCTPTR)                               0702 02622000
         BALR  @14,@15                                             0702 02623000
*   /*****************************************************************/ 02624000
*   /*                                                               */ 02625000
*   /* TERMINATE OR SUSPEND THE CURRENT TRANSACTION                  */ 02626000
*   /*                                                               */ 02627000
*   /*****************************************************************/ 02628000
*                                                                  0703 02629000
*/*                                                                  */ 02630000
*/*   IF I/O ACTIVITY FOR THIS MEMORY WAS BEING MONITORED BY THE I/O */ 02631000
*/*   LOAD BALANCING ALGORITHM, REQUEST THAT THE HISTORY OF I/O      */ 02632000
*/*   ACTIVITY BE RESET SINCE I/O ACTIVITY MAY NOT BE CONSISTENT     */ 02633000
*/*   ACROSS JOB STEPS. THE REQUEST IS PERFORMED INDIRECTLY THROUGH  */ 02634000
*/*   THE USER ACTION REQUEST ROUTINE WHICH PROVIDES THE NECESSARY   */ 02635000
*/*   SYNCHRONIZATION WITH OTHER SRM FUNCTIONS. IF REQUIRED, THE USER*/ 02636000
*/*   ACTION REQUEST ROUTINE WILL QUEUE THE ACTION UNTIL ALL ASYN-   */ 02637000
*/*   SYNCHRONOUS PROCESSING HAS COMPLETED.                          */ 02638000
*/*                                                                  */ 02639000
*                                                                  0703 02640000
*   IF OUCBIMCB^=ZERO THEN          /* IF I/O ACTIVITY WAS MONITORED,*/ 02641000
         L     @12,OUCBIMCB(,OUCBPTR)                              0703 02642000
         LTR   @12,@12                                             0703 02643000
         BZ    @RF00703                                            0703 02644000
*     DO;                           /* REQUEST I/O HISTORY BE RESET  */ 02645000
*                                                                  0704 02646000
*       /*************************************************************/ 02647000
*       /*                                                           */ 02648000
*       /* ? IRACTLCL EPN(IL4)                                       */ 02649000
*       /*                                                           */ 02650000
*       /*************************************************************/ 02651000
*                                                                  0705 02652000
*       DO;                                                        0705 02653000
*         R1=ADDR(RMEPBIL4);        /* IL4 REQUEST IS PARAM          */ 02654000
         LA    R1,RMEPBIL4(,RMCTPTR)                               0706 02655000
*         CALL RMSBCRN->IRARMRTN;   /* ACTION INVK FUNCT             */ 02656000
         L     @15,RMSBCRN(,RMCTPTR)                               0707 02657000
         BALR  @14,@15                                             0707 02658000
*       END;                        /* INVOKE I/O MONITORING ACTION     02659000
*                                      ROUTINE                       */ 02660000
*     END;                                                         0709 02661000
*                                                                  0709 02662000
*   /*****************************************************************/ 02663000
*   /*                                                               */ 02664000
*   /* PREVENT ADDRESS SPACE FROM BEING CAUGHT IN A DELAY DOMAIN     */ 02665000
*   /* BETWEEN JOB STEPS AND DURING TERMINATION PROCESSING. (THIS    */ 02666000
*   /* LOGIC IS ALSO USED BY JOBSELCT AND RESETPG.)          @ZA24836*/ 02667000
*   /*                                                               */ 02668000
*   /*****************************************************************/ 02669000
*                                                                  0710 02670000
*   RFY                                                            0710 02671000
*     DMDTPTR RSTD;                 /*                       @ZA24836*/ 02672000
@RF00703 DS    0H                                                  0711 02673000
*   WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* CURRENT PERIOD      @ZA24836*/ 02674000
         L     @12,WMSTPTR(,RMCTPTR)                               0711 02675000
         SLR   @10,@10                                             0711 02676000
         IC    @10,OUCBNPG(,OUCBPTR)                               0711 02677000
         ALR   @10,@10                                             0711 02678000
         AL    @10,WMSTPGVT(,@12)                                  0711 02679000
         LH    WPGPPTR,WPGVTENT(,@10)                              0711 02680000
         AL    WPGPPTR,WMSTPGDT(,@12)                              0711 02681000
         SLR   @12,@12                                             0711 02682000
         IC    @12,OUCBPGP(,OUCBPTR)                               0711 02683000
         ALR   WPGPPTR,@12                                         0711 02684000
*   DMDTPTR=RMCTDMDT+OUCBDMO;       /* CURRENT DMDT ENRY     @ZA24836*/ 02685000
         LH    DMDTPTR,OUCBDMO(,OUCBPTR)                           0712 02686000
         AL    DMDTPTR,RMCTDMDT(,RMCTPTR)                          0712 02687000
*   DO WHILE(DMDTHI=ZERO&           /* MAX MPL = 0 ??        @ZA24836*/ 02688000
*         WPGPFIN^='1'B);           /* AND NOT LAST PERIOD   @ZA24836*/ 02689000
         B     @DE00713                                            0713 02690000
@DL00713 DS    0H                                                  0714 02691000
*     OUCBPGP=OUCBPGP+LENGTH(WPGP); /* GO TO NEXT PERIOD     @ZA24836*/ 02692000
         LA    @12,8                                               0714 02693000
         SLR   @10,@10                                             0714 02694000
         IC    @10,OUCBPGP(,OUCBPTR)                               0714 02695000
         ALR   @12,@10                                             0714 02696000
         STC   @12,OUCBPGP(,OUCBPTR)                               0714 02697000
*     WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* PTR TO PERIOD     @ZA24836*/ 02698000
         L     @10,WMSTPTR(,RMCTPTR)                               0715 02699000
         SLR   @12,@12                                             0715 02700000
         IC    @12,OUCBNPG(,OUCBPTR)                               0715 02701000
         ALR   @12,@12                                             0715 02702000
         AL    @12,WMSTPGVT(,@10)                                  0715 02703000
         LH    WPGPPTR,WPGVTENT(,@12)                              0715 02704000
         AL    WPGPPTR,WMSTPGDT(,@10)                              0715 02705000
         SLR   @12,@12                                             0715 02706000
         IC    @12,OUCBPGP(,OUCBPTR)                               0715 02707000
         ALR   WPGPPTR,@12                                         0715 02708000
*     OUCBDMN=WPGPDMN;              /* UPDATE DMN NUMBER     @ZA24836*/ 02709000
         SLR   @12,@12                                             0716 02710000
         IC    @12,WPGPDMN(,WPGPPTR)                               0716 02711000
         STC   @12,OUCBDMN(,OUCBPTR)                               0716 02712000
*     OUCBDMO=WDMVTENT;             /* AND DMN OFFSET        @ZA24836*/ 02713000
         ALR   @12,@12                                             0717 02714000
         AL    @12,WMSTDMVT(,@10)                                  0717 02715000
         LH    @12,WDMVTENT(,@12)                                  0717 02716000
         STH   @12,OUCBDMO(,OUCBPTR)                               0717 02717000
*     DMDTPTR=RMCTDMDT+OUCBDMO;     /* PTR TO NEW DMDT ENTRY @ZA24836*/ 02718000
         AL    @12,RMCTDMDT(,RMCTPTR)                              0718 02719000
         LR    DMDTPTR,@12                                         0718 02720000
*   END;                            /*                       @ZA24836*/ 02721000
@DE00713 CLI   DMDTHI(DMDTPTR),0                                   0719 02722000
         BNE   @DC00713                                            0719 02723000
         TM    WPGPFIN(WPGPPTR),B'10000000'                        0719 02724000
         BNO   @DL00713                                            0719 02725000
@DC00713 DS    0H                                                  0720 02726000
*   RFY                                                            0720 02727000
*     DMDTPTR UNRSTD;               /* FREE UP FOR USE...    @ZA24836*/ 02728000
*/*                                                                  */ 02729000
*/*   SET UP NEW APG STATUS FOR THIS MEMORY AND HAVE THE MEMORY MOVED*/ 02730000
*/*   TO THE CORRECT POSITION ON THE ASCB QUEUE.                     */ 02731000
*/*                                                                  */ 02732000
*                                                                  0721 02733000
*   GOTO IRARMAPG;                                                 0721 02734000
         B     IRARMAPG                                            0721 02735000
*   RESPECIFY                                                      0722 02736000
*    (OUXBPTR) UNRSTD;              /* PTR TO OUXB NOT NEEDED        */ 02737000
*IRARME12:                          /* SYSEVENT 12 - QSCEST          */ 02738000
*/*                                                                  */ 02739000
*/*   FOR A NON-SWAPPABLE MEMORY, QUIESCE PROCESSING WILL BE DIRECTED*/ 02740000
*/*   TO RESTORE THE MEMORY. IF SRM RESOURCE SHORTAGE ALGORITHMS ARE */ 02741000
*/*   APPLICABLE TO THIS MEMORY THEN THE I/O USAGE PROFILE ROUTINE IS*/ 02742000
*/*   INVOKED TO CHECK TO SEE IF THE USER'S I/O PROFILE SHOULD BE    */ 02743000
*/*   UPDATED.                                                       */ 02744000
*/*                                                                  */ 02745000
*                                                                  0723 02746000
*   OUCBPSTR='0'B;                  /* RESET XMPOST ERROR ROUTINE  0723 02747000
*                                      FLAG THAT WAS SET BY CSO    0723 02748000
*                                                            @ZA16887*/ 02749000
IRARME12 NI    OUCBPSTR(OUCBPTR),B'11110111'                       0723 02750000
*   RRPARI3=QSCECONT;               /* RCT IS TO CONTINUE QUIESCE    */ 02751000
         MVI   RRPARI3(RRPAPTR),X'00'                              0724 02752000
*   IF OUCBNSW='1'B|                /* MEMORY IS NON-SWAPPABLE OR    */ 02753000
*       OUCBCTI='1'B|               /* CONTROL PROHIBITS SWAP OR     */ 02754000
*       OUCBRSWP='0'B&              /* NO REQSWAP PENDING AND      0725 02755000
*                                                            @ZA16887*/ 02756000
*       OUCBTSWP='0'B&              /* NO TRANSWAP PENDING, AND    0725 02757000
*                                                            @ZA16887*/ 02758000
*       ((OUCBLWT='1'B|             /* MEMORY WAS SWAPPED BECAUSE OF */ 02759000
*       OUCBMWT='1'B)&              /* LONG WAIT BUT IS NOT REALLY   */ 02760000
*       RRPAWAIT=NOWAIT) THEN       /* IN LONG WAIT          @Z30WIMG*/ 02761000
         TM    OUCBNSW(OUCBPTR),B'11000000'                        0725 02762000
         BNZ   @RT00725                                            0725 02763000
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0725 02764000
         BNZ   @RF00725                                            0725 02765000
         TM    OUCBLWT(OUCBPTR),B'10000001'                        0725 02766000
         BZ    @RF00725                                            0725 02767000
         CLI   RRPAWAIT(RRPAPTR),X'00'                             0725 02768000
         BNE   @RF00725                                            0725 02769000
@RT00725 DS    0H                                                  0726 02770000
*     DO;                                                          0726 02771000
*                                                                  0726 02772000
*       /*************************************************************/ 02773000
*       /*                                                           */ 02774000
*       /* FIRST, POST ALL ISSUERS OF REQSWAP OR TRANSWAP, IF NEEDED.*/ 02775000
*       /*                                                   @ZA20975*/ 02776000
*       /*                                                           */ 02777000
*       /*************************************************************/ 02778000
*                                                                  0727 02779000
*       RFY                                                        0727 02780000
*         OUXBPTR RSTD;             /* HOLD REGISTER         @ZA16887*/ 02781000
*       OUXBPTR=ASCBOUXB;           /* GET OUXB ADDRESS      @ZA16887*/ 02782000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0728 02783000
*       IF OUCBRSWP='1'B|OUCBTSWP='1'B THEN/* POSTING NEEDED?      0729 02784000
*                                                            @ZA20975*/ 02785000
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0729 02786000
         BZ    @RF00729                                            0729 02787000
*         DO;                       /* POSSIBLY, SO          @ZA20975*/ 02788000
*           R0=FOUR;                /* I06 WILL POST WITH 4  @ZA20975*/ 02789000
         LA    R0,4                                                0731 02790000
*           CALL EVTENDSW;          /* SUBROUTINE DOES POST  @ZA16887*/ 02791000
         BAL   @14,EVTENDSW                                        0732 02792000
*         END;                      /* DONE POSTING          @ZA20975*/ 02793000
*                                                                  0733 02794000
*       /*************************************************************/ 02795000
*       /*                                                           */ 02796000
*       /* NOW, RESET OTHER FIELDS FOR SWAP TURNAROUND.              */ 02797000
*       /*                                                           */ 02798000
*       /*************************************************************/ 02799000
*                                                                  0734 02800000
*       OUCBLWT='0'B;               /* RESET LONG                    */ 02801000
@RF00729 DS    0H                                                  0735 02802000
*       OUCBMWT='0'B;               /* WAIT FLAGS                    */ 02803000
*       OUCBTRM='0'B;               /* INDICATE NO TERMWAIT SWAPOUT  */ 02804000
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0736 02805000
*       OUCBCTI='0'B;               /* RESET CNTL PROHIBITS SWAP FLAG*/ 02806000
         NI    OUCBCTI(OUCBPTR),B'10111111'                        0737 02807000
*       OUCBGOO='0'B;               /* RESET USER TRANSITIONING OUT  */ 02808000
         NI    OUCBGOO(OUCBPTR),B'01111111'                        0738 02809000
*       CALL EVTCHAP;               /* CHAP TO USER PRIORITY @YM05632*/ 02810000
         BAL   @14,EVTCHAP                                         0739 02811000
*       RRPARI3=RESTORE;            /* RCT IS TO RESTORE ADDR SPACE  */ 02812000
         MVI   RRPARI3(RRPAPTR),X'08'                              0740 02813000
*     END;                                                         0741 02814000
*   ELSE                            /* MEMORY IS SWAPPABLE           */ 02815000
*     OUCBQSS='1'B;                 /* QSCEST SYSEVENT PROCESSED     */ 02816000
         B     @RC00725                                            0742 02817000
@RF00725 OI    OUCBQSS(OUCBPTR),B'00000100'                        0742 02818000
*   IF OUCBRMA='1'B THEN            /* SRM ALGORITHMS APPLICABLE     */ 02819000
*                                                                  0743 02820000
@RC00725 TM    OUCBRMA(OUCBPTR),B'00100000'                        0743 02821000
         BNO   @RF00743                                            0743 02822000
*     /***************************************************************/ 02823000
*     /*                                                             */ 02824000
*     /* ? IRACTLCL EPN(IL0)                                         */ 02825000
*     /*                                                             */ 02826000
*     /***************************************************************/ 02827000
*                                                                  0744 02828000
*     CALL RMSBIL0->IRARMRTN;       /* INVOKE IL0 SUBRTN             */ 02829000
*                                                                  0744 02830000
         L     @15,RMSBIL0(,RMCTPTR)                               0744 02831000
         BALR  @14,@15                                             0744 02832000
*   /*****************************************************************/ 02833000
*   /*                                                               */ 02834000
*   /* I/O USAGE MONITORING ALGORITHM ? IRACTLCL EPN(CTL)            */ 02835000
*   /*                                                               */ 02836000
*   /*****************************************************************/ 02837000
*                                                                  0745 02838000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 02839000
*                                                                  0745 02840000
@RF00743 L     @12,RMEXCTL(,RMCTPTR)                               0745 02841000
         BR    @12                                                 0745 02842000
*   /*****************************************************************/ 02843000
*   /*                                                               */ 02844000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 02845000
*   /*                                                               */ 02846000
*   /*****************************************************************/ 02847000
*                                                                  0746 02848000
*   RFY                                                            0746 02849000
*     OUXBPTR UNRSTD;               /* FREE UP REGISTER      @ZA16887*/ 02850000
*IRARME13:                          /* SYSEVENT 13 - QSCECMP         */ 02851000
*   RESPECIFY                                                      0747 02852000
*    (RTNREG,                                                      0747 02853000
*     NTRREG,                                                      0747 02854000
*     RETNCODE) UNRSTD;                                            0747 02855000
IRARME13 DS    0H                                                  0748 02856000
*   RESPECIFY                                                      0748 02857000
*     OUXBPTR                       /*                       @Z30WIMG*/ 02858000
*         RSTD;                     /* HOLD OUSBPTR LATER    @ZA20975*/ 02859000
*   IF RRPAWAIT=NOWAIT THEN         /* IF MEMORY HAS AT LEAST ONE  0749 02860000
*                                      EXECUTABLE TASK               */ 02861000
         CLI   RRPAWAIT(RRPAPTR),X'00'                             0749 02862000
         BNE   @RF00749                                            0749 02863000
*     OUCBRDYB='1'B;                /* MEMORY ELIGIBLE TO BE SWAPPED    02864000
*                                      IN                            */ 02865000
         L     @12,OUCBRDYB-2(,OUCBPTR)                            0750 02866000
@GL00025 LR    @07,@12                                             0750 02867000
         O     @07,@CF02688                                        0750 02868000
         CS    @12,@07,OUCBRDYB-2(OUCBPTR)                         0750 02869000
         BNE   @GL00025                                            0750 02870000
*/*                                                                  */ 02871000
*/*   DETERMINE THE STATUS OF THE MEMORY.  A NON-SWAPPABLE MEMORY    */ 02872000
*/*   SHOULD BE RESTORED BY THE RCT.                                 */ 02873000
*/*                                                                  */ 02874000
*                                                                  0751 02875000
*   OUXBPTR=ASCBOUXB;               /* ADDRESSABILITY TO OUXB        */ 02876000
@RF00749 L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0751 02877000
*   IF OUCBNSW='1'B|                /* MEMORY IS NON-SWAPPABLE OR    */ 02878000
*       OUCBCTI='1'B|               /* CONTROL PROHIBITS SWAP OR     */ 02879000
*       OUCBRSWP='0'B&              /* NO REQSWAP PENDING AND      0752 02880000
*                                                            @ZA16887*/ 02881000
*       OUCBTSWP='0'B&              /* NO TRANSWAP PENDING, AND    0752 02882000
*                                                            @ZA16887*/ 02883000
*       (((OUCBLWT='1'B|            /* MEMORY WAS SWAPPED BECAUSE OF */ 02884000
*       OUCBMWT='1'B)&              /* LONG WAIT BUT IS NOT REALLY   */ 02885000
*       OUCBRDY='1'B)) THEN         /* IN LONG WAIT                  */ 02886000
         TM    OUCBNSW(OUCBPTR),B'11000000'                        0752 02887000
         BNZ   @RT00752                                            0752 02888000
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0752 02889000
         BNZ   @RF00752                                            0752 02890000
         TM    OUCBLWT(OUCBPTR),B'10000001'                        0752 02891000
         BZ    @RF00752                                            0752 02892000
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0752 02893000
         BNO   @RF00752                                            0752 02894000
@RT00752 DS    0H                                                  0753 02895000
*     DO;                           /* TURN SWAP AROUND              */ 02896000
*                                                                  0753 02897000
*       /*************************************************************/ 02898000
*       /*                                                           */ 02899000
*       /* FIRST, POST ALL ISSUERS OF REQSWAP OR TRANSWAP, IF NEEDED.*/ 02900000
*       /*                                                   @ZA20975*/ 02901000
*       /*                                                           */ 02902000
*       /*************************************************************/ 02903000
*                                                                  0754 02904000
*       IF OUCBRSWP='1'B|OUCBTSWP='1'B THEN/* POSTING NEEDED?      0754 02905000
*                                                            @ZA20975*/ 02906000
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0754 02907000
         BZ    @RF00754                                            0754 02908000
*         DO;                       /* POSSIBLY, SO          @ZA20975*/ 02909000
*           R0=FOUR;                /* I06 WILL POST WITH 4  @ZA20975*/ 02910000
         LA    R0,4                                                0756 02911000
*           CALL EVTENDSW;          /* SUBROUTINE DOES POST  @ZA16887*/ 02912000
         BAL   @14,EVTENDSW                                        0757 02913000
*         END;                      /* DONE POSTING          @ZA20975*/ 02914000
*                                                                  0758 02915000
*       /*************************************************************/ 02916000
*       /*                                                           */ 02917000
*       /* NOW RESET OTHER FIELDS FOR SWAP TURNAROUND.               */ 02918000
*       /*                                                           */ 02919000
*       /*************************************************************/ 02920000
*                                                                  0759 02921000
*       OUCBTRM='0'B;               /* INDICATE NO TERMWAIT SWAPOUT  */ 02922000
@RF00754 NI    OUCBTRM(OUCBPTR),B'10111111'                        0759 02923000
*       CALL EVTCHAP;               /* CHAP TO USER PRIORITY @YM05632*/ 02924000
         BAL   @14,EVTCHAP                                         0760 02925000
*       RRPARI3=RESTORE;            /* RCT IS TO RESTORE ADDR SPACE  */ 02926000
         MVI   RRPARI3(RRPAPTR),X'08'                              0761 02927000
*     END;                                                         0762 02928000
*   ELSE                            /* PREPARE TO SWAP-OUT THE MEMORY*/ 02929000
*     DO;                                                          0763 02930000
*                                                                  0763 02931000
         B     @RC00752                                            0763 02932000
@RF00752 DS    0H                                                  0764 02933000
*       /*************************************************************/ 02934000
*       /*                                                           */ 02935000
*       /* IF THERE IS AN ACTIVE TRANSACTION IN THE MEMORY, INFORM   */ 02936000
*       /* THE WORKLOAD MANAGER THAT THE MEMORY IS BEING SWAPPED OUT.*/ 02937000
*       /* THE ACTIVE TRANSACTION WILL BE SUSPENDED UNTIL THE MEMORY */ 02938000
*       /* IS SWAPPED IN AGAIN.                                      */ 02939000
*       /*                                                           */ 02940000
*       /*************************************************************/ 02941000
*                                                                  0764 02942000
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL        */ 02943000
*                                                                  0764 02944000
         TM    OUCBINC(OUCBPTR),B'00000001'                        0764 02945000
         BNO   @RF00764                                            0764 02946000
*         /***********************************************************/ 02947000
*         /*                                                         */ 02948000
*         /* ? IRACTLCL EPN(WMQ)                                     */ 02949000
*         /*                                                         */ 02950000
*         /***********************************************************/ 02951000
*                                                                  0765 02952000
*         CALL RMSBWMQ->IRARMRTN;   /* INVOKE WMQ SUBRTN             */ 02953000
         L     @15,RMSBWMQ(,RMCTPTR)                               0765 02954000
         BALR  @14,@15                                             0765 02955000
*       RFY                                                        0766 02956000
*         OUSBPTR RSTD;             /* NOW HOLD REGISTER     @ZA20975*/ 02957000
@RF00764 DS    0H                                                  0767 02958000
*       OUSBPTR=ASXBOUSB;           /* ADDRESSABILITY TO OUSB        */ 02959000
*                                                                  0767 02960000
         L     @12,ASXBPTR(,ASCBPTR)                               0767 02961000
         L     OUSBPTR,ASXBOUSB(,@12)                              0767 02962000
*       /*************************************************************/ 02963000
*       /*                                                           */ 02964000
*       /* ADD OUXB PAGE COUNTS FOR THE LAST IN-MAIN STORAGE INTERVAL*/ 02965000
*       /* TO THE ACCUMULATORS IN THE OUSB.                          */ 02966000
*       /*                                                           */ 02967000
*       /*************************************************************/ 02968000
*                                                                  0768 02969000
*       OUSBPIN=OUSBPIN+OUXBPIN;    /* NUMBER OF PAGE-INS            */ 02970000
         L     @12,OUSBPIN(,OUSBPTR)                               0768 02971000
         AL    @12,OUXBPIN(,OUXBPTR)                               0768 02972000
         ST    @12,OUSBPIN(,OUSBPTR)                               0768 02973000
*       OUSBPOUT=OUSBPOUT+OUXBPOUT; /* NUMBER OF PAGE-OUTS           */ 02974000
         L     @12,OUSBPOUT(,OUSBPTR)                              0769 02975000
         AL    @12,OUXBPOUT(,OUXBPTR)                              0769 02976000
         ST    @12,OUSBPOUT(,OUSBPTR)                              0769 02977000
*       OUSBPREC=OUSBPREC+OUXBPREC; /* NUMBER OF PAGE RECLAIMS       */ 02978000
         L     @12,OUSBPREC(,OUSBPTR)                              0770 02979000
         AL    @12,OUXBPREC(,OUXBPTR)                              0770 02980000
         ST    @12,OUSBPREC(,OUSBPTR)                              0770 02981000
*       OUSBVAMI=OUSBVAMI+OUXBVAMI; /* NUMBER OF VAM PAGE-INS        */ 02982000
         L     @12,OUSBVAMI(,OUSBPTR)                              0771 02983000
         AL    @12,OUXBVAMI(,OUXBPTR)                              0771 02984000
         ST    @12,OUSBVAMI(,OUSBPTR)                              0771 02985000
*       OUSBVAMO=OUSBVAMO+OUXBVAMO; /* NUMBER OF VAM PAGE-OUTS       */ 02986000
         L     @12,OUSBVAMO(,OUSBPTR)                              0772 02987000
         AL    @12,OUXBVAMO(,OUXBPTR)                              0772 02988000
         ST    @12,OUSBVAMO(,OUSBPTR)                              0772 02989000
*       OUSBVAMR=OUSBVAMR+OUXBVAMR; /* NUMBER OF VAM PAGE-RECLAIMS   */ 02990000
         L     @12,OUSBVAMR(,OUSBPTR)                              0773 02991000
         AL    @12,OUXBVAMR(,OUXBPTR)                              0773 02992000
         ST    @12,OUSBVAMR(,OUSBPTR)                              0773 02993000
*       OUSBCAPI=OUSBCAPI+OUXBCAPI; /* NUM OF COMMON PGIN    @Z30WIMG*/ 02994000
         L     @12,OUSBCAPI(,OUSBPTR)                              0774 02995000
         AL    @12,OUXBCAPI(,OUXBPTR)                              0774 02996000
         ST    @12,OUSBCAPI(,OUSBPTR)                              0774 02997000
*       OUSBCAPR=OUSBCAPR+OUXBCAPR; /* NUM OF COMMON RCLM    @Z30WIMG*/ 02998000
         L     @12,OUSBCAPR(,OUSBPTR)                              0775 02999000
         AL    @12,OUXBCAPR(,OUXBPTR)                              0775 03000000
         ST    @12,OUSBCAPR(,OUSBPTR)                              0775 03001000
*       OUSBSTCT=OUSBSTCT+OUXBSTCT; /* NUM OF STOLEN         @Z40BPJE*/ 03002000
*                                                                  0776 03003000
         L     @12,OUSBSTCT(,OUSBPTR)                              0776 03004000
         AL    @12,OUXBSTCT(,OUXBPTR)                              0776 03005000
         ST    @12,OUSBSTCT(,OUSBPTR)                              0776 03006000
*       /*************************************************************/ 03007000
*       /*                                                           */ 03008000
*       /* INVOKE CPU LOAD BALANCING PROFILE ADJUSTMENT ROUTINE TO   */ 03009000
*       /* RECALCULATE THE USER AND THE SYSTEM CPU USAGE PROFILE. ?  */ 03010000
*       /* IRACTLCL EPN(CL0)                                         */ 03011000
*       /*                                                           */ 03012000
*       /*************************************************************/ 03013000
*                                                                  0777 03014000
*       CALL RMSBCL0->IRARMRTN;     /* INVOKE CL0 SUBRTN             */ 03015000
*                                                                  0777 03016000
         L     @15,RMSBCL0(,RMCTPTR)                               0777 03017000
         BALR  @14,@15                                             0777 03018000
*       /*************************************************************/ 03019000
*       /*                                                           */ 03020000
*       /* ADJUST I/O LOAD BALANCING BASE TIME OF DAY VALUE IN       */ 03021000
*       /* CONJUNCTION WITH RESTORE COMPLETED TO ELIMINATE TIME USER */ 03022000
*       /* SWAPPED OUT FROM RESOURCE USE CALCULATIONS.               */ 03023000
*       /*                                                           */ 03024000
*       /*************************************************************/ 03025000
*                                                                  0778 03026000
*       OUXBITD=OUXBITD-RMCTTOD;                                   0778 03027000
*                                                                  0778 03028000
         L     @12,OUXBITD(,OUXBPTR)                               0778 03029000
         SL    @12,RMCTTOD(,RMCTPTR)                               0778 03030000
         ST    @12,OUXBITD(,OUXBPTR)                               0778 03031000
*       /*************************************************************/ 03032000
*       /*                                                           */ 03033000
*       /* QSCEFL DID NOT RECUR, SO RESET RECURSION FLAG.    @ZA29919*/ 03034000
*       /*                                                           */ 03035000
*       /*************************************************************/ 03036000
*                                                                  0779 03037000
*       OUCBQSFL='0'B;              /*                       @ZA29919*/ 03038000
*                                                                  0779 03039000
         NI    OUCBQSFL(OUCBPTR),B'11101111'                       0779 03040000
*       /*************************************************************/ 03041000
*       /*                                                           */ 03042000
*       /* TO PRESERVE THE INFORMATION KEPT IN THE OUXB WHILE THE    */ 03043000
*       /* MEMORY IS OUT OF MAIN STORAGE(THE STORAGE OCCUPIED BY THE */ 03044000
*       /* OUXB IS FREED DURING THE SWAPPED-OUT PERIOD), MOVE THE    */ 03045000
*       /* DATA TO THE OUSB.                                         */ 03046000
*       /*                                                           */ 03047000
*       /*************************************************************/ 03048000
*                                                                  0780 03049000
*       OUSBFLDS=OUXBFLDS;                                         0780 03050000
*                                                                  0780 03051000
         MVC   OUSBFLDS(80,OUSBPTR),OUXBFLDS(OUXBPTR)              0780 03052000
*       /*************************************************************/ 03053000
*       /*                                                           */ 03054000
*       /* CHANGE THE STATUS OF THE MEMORY TO OUT OF MAIN STORAGE AND*/ 03055000
*       /* REPOSITON IT ON THE CORRECT OUT OF CORE QUEUE. THE MEMORY */ 03056000
*       /* WILL NORMALLY BE POSITIONED ON THE OUT QUEUE. HOWEVER, IF */ 03057000
*       /* THE MEMORY IS NOT RUNNABLE(IN LONG WAIT) OR AN AUX PAGE   */ 03058000
*       /* SHORTAGE EXISTS, OR THE NUMBER OF FIXED FRAMES IS OVER A  */ 03059000
*       /* THRESHOLD,THEN IT WILL BE PLACED ON THE WAIT QUEUE. THE   */ 03060000
*       /* REQUEST IS PERFORMED INDIRECTLY THROUGH THE USER ACTION   */ 03061000
*       /* REQUEST ROUTINE TO INSURE SRM CONTROL BLOCK INTEGRITY. THE*/ 03062000
*       /* ENTRY POINT BLOCK DESCRIBING THE MEMORY STATUS CHANGE     */ 03063000
*       /* ACTION ROUTINE IS PASSED TO THE USER ACTION REQUEST       */ 03064000
*       /* ROUTINE AS INPUT. IF REQUIRED, THE USER ACTION REQUEST    */ 03065000
*       /* ROUTINE QUEUES THE ACTION UNTIL ANY ASYNCHRONOUS SRM      */ 03066000
*       /* PROCESSING HAS COMPLETED.                                 */ 03067000
*       /*                                                           */ 03068000
*       /*************************************************************/ 03069000
*                                                                  0781 03070000
*       OUCBOUT='1'B;               /* MEMORY OUT OF MAIN STORAGE    */ 03071000
         OI    OUCBOUT(OUCBPTR),B'00000100'                        0781 03072000
*       RMCAINUS=RMCAINUS-ONE;      /* DECREMENT NO. OF IN-CORE USERS*/ 03073000
         LH    @12,RMCAINUS(,RMCTPTR)                              0782 03074000
         BCTR  @12,0                                               0782 03075000
         STH   @12,RMCAINUS(,RMCTPTR)                              0782 03076000
*       OUCBGOB='1'B;               /* RPS HAS BEEN INVOKED          */ 03077000
         OI    OUCBGOB(OUCBPTR),B'00100000'                        0783 03078000
*       IF OUCBAXS='1'B|            /* AUX PAGE SHORTAGE FORCED SWAP */ 03079000
*           OUCBFXS='1'B|           /* REAL PAGE SHORTAGE    @Z40BPEB*/ 03080000
*           OUCBJSAS='1'B|          /* JOB SELECT SWAP (AUX) @ZM43072*/ 03081000
*           OUCBJSFS='1'B|          /* JOB SELECT SWAP (FIX) @ZM43072*/ 03082000
*           (OUCBRDY='0'B&          /* NO USER READY SYSEVENT RCVD & */ 03083000
*           RRPAWAIT=LONGWAIT) THEN /* MEMORY STILL IN LONG WAIT     */ 03084000
         TM    OUCBAXS(OUCBPTR),B'00000101'                        0784 03085000
         BNZ   @RT00784                                            0784 03086000
         TM    OUCBJSAS(OUCBPTR),B'11000000'                       0784 03087000
         BNZ   @RT00784                                            0784 03088000
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0784 03089000
         BNZ   @RF00784                                            0784 03090000
         CLI   RRPAWAIT(RRPAPTR),X'80'                             0784 03091000
         BNE   @RF00784                                            0784 03092000
@RT00784 DS    0H                                                  0785 03093000
*         OUCBOFF='1'B;             /* PLACE MEMORY ON WAIT OUT QUEUE*/ 03094000
         OI    OUCBOFF(OUCBPTR),B'00001000'                        0785 03095000
*       IF OUCBSRC>0&OUCBSRC<=LENGTH(RMCASRC)/4 THEN               0786 03096000
@RF00784 CLI   OUCBSRC(OUCBPTR),0                                  0786 03097000
         BNH   @RF00786                                            0786 03098000
         CLI   OUCBSRC(OUCBPTR),10                                 0786 03099000
         BH    @RF00786                                            0786 03100000
*         RMCASRCD(OUCBSRC)=RMCASRCD(OUCBSRC)+1;/* UPDATE THE      0787 03101000
*                                      APPROPRIATE SWAP OUT REASON 0787 03102000
*                                      CODE COUNTER          @Z40BPJE*/ 03103000
*                                                                  0787 03104000
         SLR   @12,@12                                             0787 03105000
         IC    @12,OUCBSRC(,OUCBPTR)                               0787 03106000
         SLA   @12,2                                               0787 03107000
         LA    @15,1                                               0787 03108000
         AL    @15,RMCASRCD-4(@12,RMCTPTR)                         0787 03109000
         ST    @15,RMCASRCD-4(@12,RMCTPTR)                         0787 03110000
*       /*************************************************************/ 03111000
*       /*                                                           */ 03112000
*       /* ? IRACTLCL EPN(RPS)                                       */ 03113000
*       /*                                                           */ 03114000
*       /*************************************************************/ 03115000
*                                                                  0788 03116000
*       DO;                                                        0788 03117000
@RF00786 DS    0H                                                  0789 03118000
*         R1=ADDR(RMEPBRPS);        /* RPS REQUEST IS PARAM          */ 03119000
         LA    R1,RMEPBRPS(,RMCTPTR)                               0789 03120000
*         CALL RMSBCRN->IRARMRTN;   /* ACTION INVK FUNCT             */ 03121000
         L     @15,RMSBCRN(,RMCTPTR)                               0790 03122000
         BALR  @14,@15                                             0790 03123000
*       END;                                                       0791 03124000
*       RRPARI2=OUCBSRC;            /* PUT IN SWAP OUT REASON CODE 0792 03125000
*                                      FOR RETURN TO CALLER  @Z40BPJE*/ 03126000
         IC    @12,OUCBSRC(,OUCBPTR)                               0792 03127000
         STC   @12,RRPARI2(,RRPAPTR)                               0792 03128000
*       RRPARI3=QSCECONT;           /* RCT IS TO CONTINUE QUIESCE    */ 03129000
         MVI   RRPARI3(RRPAPTR),X'00'                              0793 03130000
*       OUCBQSC='1'B;               /* MARK QUIESCE PROCESS COMPLETE */ 03131000
         OI    OUCBQSC(OUCBPTR),B'00000010'                        0794 03132000
*     END;                                                         0795 03133000
*   IF OUCBRDY='1'B THEN            /* IF USER READY SYSEVENT        */ 03134000
@RC00752 TM    OUCBRDY(OUCBPTR),B'10000000'                        0796 03135000
         BNO   @RF00796                                            0796 03136000
*     DO;                           /* RECEIVED SINCE QUIESCE STARTED*/ 03137000
*       RRPARI0=ZERO;               /* INDICATE TO RCT THAT A USER 0798 03138000
*                                      READY WAS RECEIVED            */ 03139000
         MVI   RRPARI0(RRPAPTR),X'00'                              0798 03140000
*       ASCBOUTB='0'B;              /* ELIMINATE FURTHER USRRDYS     */ 03141000
         L     @12,ASCBOUTB-2(,ASCBPTR)                            0799 03142000
@GL00033 LR    @15,@12                                             0799 03143000
         N     @15,@CF02704                                        0799 03144000
         CS    @12,@15,ASCBOUTB-2(ASCBPTR)                         0799 03145000
         BNE   @GL00033                                            0799 03146000
*     END;                                                         0800 03147000
*                                                                  0800 03148000
*   /*****************************************************************/ 03149000
*   /*                                                               */ 03150000
*   /* ? IRACTLCL EPN(CTL)                                           */ 03151000
*   /*                                                               */ 03152000
*   /*****************************************************************/ 03153000
*                                                                  0801 03154000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 03155000
*                                                                  0801 03156000
@RF00796 L     @12,RMEXCTL(,RMCTPTR)                               0801 03157000
         BR    @12                                                 0801 03158000
*   /*****************************************************************/ 03159000
*   /*                                                               */ 03160000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 03161000
*   /*                                                               */ 03162000
*   /*****************************************************************/ 03163000
*                                                                  0802 03164000
*   RESPECIFY                                                      0802 03165000
*    (OUXBPTR,                                                     0802 03166000
*     OUSBPTR) UNRSTD;              /*                       @Z30WIMG*/ 03167000
*   RESPECIFY                                                      0803 03168000
*    (RTNREG,                                                      0803 03169000
*     NTRREG,                                                      0803 03170000
*     RETNCODE) RSTD;                                              0803 03171000
*IRARME14:                          /* SYSEVENT 14 - TRANSWAP      0804 03172000
*                                                            @ZA16887*/ 03173000
*/* INITIATE THE TRANSITION OF AN ADDRESS SPACE FROM         @ZA16887*/ 03174000
*/* SWAPPABLE TO NONSWAPPABLE.  BEGIN SWAPOUT OF THE ADDRESS @ZA16887*/ 03175000
*/* SPACE AND SET INDICATORS THAT CAUSE ITS FRAMES TO BE     @ZA16887*/ 03176000
*/* OBTAINED FROM PREFERRED STORAGE (RATHER THAN             @ZA16887*/ 03177000
*/* RECONFIGURABLE STORAGE) WHEN IT IS SWAPPED BACK IN.      @ZA16887*/ 03178000
*/* IF ECB ADDRESS IS PASSED IN REGISTER 1,                  @ZA16887*/ 03179000
*/* SYSEVENT 15 (SWOUTCMP) WILL POST THE TRANSWAP ISSUER     @ZA16887*/ 03180000
*/* THAT THE TRANSITION WAS SUCCESSFUL.                      @ZA16887*/ 03181000
*                                                                  0804 03182000
*   RFY                                                            0804 03183000
*     OUXBPTR RSTD;                 /* HOLD REGISTER         @ZA16887*/ 03184000
IRARME14 DS    0H                                                  0805 03185000
*   IF ASCBPTR=PSAAOLD THEN         /* MUST BE FOR CURRENT A.S     0805 03186000
*                                                            @ZA16887*/ 03187000
         C     ASCBPTR,PSAAOLD                                     0805 03188000
         BNE   @RF00805                                            0805 03189000
*     IF OUCBNSW='0'B THEN          /* SWAPPABLE?            @ZA16887*/ 03190000
         TM    OUCBNSW(OUCBPTR),B'10000000'                        0806 03191000
         BNZ   @RF00806                                            0806 03192000
*       DO;                         /* CONTINUE TRANSWAP     @ZA16887*/ 03193000
*         OUXBPTR=ASCBOUXB;         /* GET ADDR OF OUXB      @ZA16887*/ 03194000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0808 03195000
*         IF OUCBTSWP='0'B THEN     /* NO OTHER TRANSWAP PENDING?  0809 03196000
*                                                            @ZA16887*/ 03197000
         TM    OUCBTSWP(OUCBPTR),B'00010000'                       0809 03198000
         BNZ   @RF00809                                            0809 03199000
*           DO;                     /* OK TO BEGIN SWAPOUT   @ZA16887*/ 03200000
*                                                                  0810 03201000
*             /*******************************************************/ 03202000
*             /*                                                     */ 03203000
*             /* ? IRACTLCL EPN(CSO)                                 */ 03204000
*             /*                                                     */ 03205000
*             /*******************************************************/ 03206000
*                                                                  0811 03207000
*             DO;                                                  0811 03208000
*               R1=ADDR(RMEPBCSO);  /* CSO REQUEST IS PARAM          */ 03209000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0812 03210000
*               CALL RMSBCRY->IRARMRTN;/* ACTION INVK FUNCT          */ 03211000
         L     @15,RMSBCRY(,RMCTPTR)                               0813 03212000
         BALR  @14,@15                                             0813 03213000
*             END;                  /* INVOKE SWAPOUT ROUTINE      0814 03214000
*                                                            @ZA16887*/ 03215000
*             IF RETNCODE=ZERO|     /* SWAPOUT WAS BEGUN OR A.S.   0815 03216000
*                                                            @ZA16887*/ 03217000
*                 RETNCODE=CON8 THEN/* WAS TRANSITIONING     @ZA16887*/ 03218000
         LTR   RETNCODE,RETNCODE                                   0815 03219000
         BZ    @RT00815                                            0815 03220000
         C     RETNCODE,@CF00152                                   0815 03221000
         BNE   @RF00815                                            0815 03222000
@RT00815 DS    0H                                                  0816 03223000
*               DO;                 /* CONTINUE TRANSWAP     @ZA16887*/ 03224000
*                 IF ASCBN2LP='0'B THEN/* TURN ON BOTH PREF  @ZA16887*/ 03225000
         TM    ASCBN2LP(ASCBPTR),B'00100000'                       0817 03226000
         BNZ   @RF00817                                            0817 03227000
*                   DO;             /* STORAGE BITS,         @ZA16887*/ 03228000
*                     ASCB1LPU='1'B;/* 1ST LEVEL AND         @ZA16887*/ 03229000
*                     ASCB2LPU='1'B;/* 2ND LEVEL             @ZA16887*/ 03230000
         L     @12,ASCB1LPU(,ASCBPTR)                              0820 03231000
@GL00035 LR    @07,@12                                             0820 03232000
         O     @07,@CF02707                                        0820 03233000
         CS    @12,@07,ASCB1LPU(ASCBPTR)                           0820 03234000
         BNE   @GL00035                                            0820 03235000
*                   END;                                           0821 03236000
*                 ELSE              /* OTHERWISE,            @ZA16887*/ 03237000
*                   ASCB1LPU='1'B;  /* ONLY 1ST LEVEL        @ZA16887*/ 03238000
         B     @RC00817                                            0822 03239000
@RF00817 L     @12,ASCB1LPU(,ASCBPTR)                              0822 03240000
@GL00036 LR    @07,@12                                             0822 03241000
         O     @07,@CF02710                                        0822 03242000
         CS    @12,@07,ASCB1LPU(ASCBPTR)                           0822 03243000
         BNE   @GL00036                                            0822 03244000
*                 OUCBTSWP='1'B;    /* TRANSWAP IS PENDING   @ZA16887*/ 03245000
@RC00817 OI    OUCBTSWP(OUCBPTR),B'00010000'                       0823 03246000
*                 OUXBTSW=RRPAINP;  /* STORE ECB ADDR, IF ANY      0824 03247000
*                                                            @ZA16887*/ 03248000
         L     @12,RRPAINP(,RRPAPTR)                               0824 03249000
         ST    @12,OUXBTSW(,OUXBPTR)                               0824 03250000
*                 IF RETNCODE=ZERO THEN/* SWAP OUT WAS BEGUN @ZA16887*/ 03251000
         LTR   RETNCODE,RETNCODE                                   0825 03252000
         BNZ   @RF00825                                            0825 03253000
*                   DO;             /* SO FINISH TRANSWAP PROCESS  0826 03254000
*                                                            @ZA16887*/ 03255000
*                     OUCBLWT='0'B; /* RESET LONG            @ZA16887*/ 03256000
*                     OUCBMWT='0'B; /* WAIT FLAGS            @ZA16887*/ 03257000
*                     OUCBTRM='0'B; /* INDICATE NO TERMWAIT SWAPOUT     03258000
*                                                            @ZA16887*/ 03259000
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0829 03260000
*                     OUCBSRC=SRCDRQSC;/* COUNT AS REQSWAP   @ZA16887*/ 03261000
         MVI   OUCBSRC(OUCBPTR),X'07'                              0830 03262000
*                     IF RRPASVC='1'B THEN/* IF SVC ENTRY TO SRM,  0831 03263000
*                                                            @ZA16887*/ 03264000
         TM    RRPASVC(RRPAPTR),B'00100000'                        0831 03265000
         BNO   @RF00831                                            0831 03266000
*                       RRPARTN=CVTEXP1;/* FORCE EXIT THRU DISPATCHER   03267000
*                                      TO ALLOW SWAPOUT TO RUN     0832 03268000
*                                                            @ZA16887*/ 03269000
         L     @12,CVTPTR                                          0832 03270000
         L     @12,CVTEXP1(,@12)                                   0832 03271000
         ST    @12,RRPARTN(,RRPAPTR)                               0832 03272000
*                   END;            /* END RC=0 CASE         @ZA16887*/ 03273000
*               END;                /* END RC=0 OR 8 CASE    @ZA16887*/ 03274000
*             ELSE                  /* RC=4 FROM SWAP OUT    @ZA16887*/ 03275000
*               DO;                 /* MEANS INVALID SRM DATA      0835 03276000
*                                                            @ZA16887*/ 03277000
         B     @RC00815                                            0835 03278000
@RF00815 DS    0H                                                  0836 03279000
*                 RESNCODE=CON24;   /* ABEND 15F RC=24       @ZA16887*/ 03280000
*                                                                  0836 03281000
         LA    RESNCODE,24                                         0836 03282000
*                 /***************************************************/ 03283000
*                 /*                                                 */ 03284000
*                 /* ? IRACTLCL EPN(I10)                             */ 03285000
*                 /*                                                 */ 03286000
*                 /***************************************************/ 03287000
*                                                                  0837 03288000
*                 CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT        */ 03289000
*                                                                  0837 03290000
         L     @15,RMSBI10(,RMCTPTR)                               0837 03291000
         BALR  @14,@15                                             0837 03292000
*                 /***************************************************/ 03293000
*                 /*                                                 */ 03294000
*                 /* FRR WILL CONVERT TO 25F ABEND           @ZA16887*/ 03295000
*                 /*                                                 */ 03296000
*                 /***************************************************/ 03297000
*                                                                  0838 03298000
*               END;                /* END RC=4 CASE         @ZA16887*/ 03299000
*           END;                    /*                       @ZA16887*/ 03300000
*         ELSE                      /* ANOTHER TRANSWAP WAS PENDING     03301000
*                                                            @ZA16887*/ 03302000
*           DO;                     /* INVOKE SUBROUTINE     @ZA20975*/ 03303000
         B     @RC00809                                            0840 03304000
@RF00809 DS    0H                                                  0841 03305000
*             R1=ADDR(OUXBTSW);     /* TO STORE ECB ADDR     @ZA20975*/ 03306000
         LA    R1,OUXBTSW(,OUXBPTR)                                0841 03307000
*             CALL EVTSTACK;        /* IF ONE IS SPEC'D.     @ZA20975*/ 03308000
         BAL   @14,EVTSTACK                                        0842 03309000
*             OUCBNTSP=OUCBNTSP+ONE;/* COUNT PENDING TRANSWAPS (USED    03310000
*                                      BY UXB AT SWOUTCMP)   @ZA16887*/ 03311000
         LA    @12,1                                               0843 03312000
         AH    @12,OUCBNTSP(,OUCBPTR)                              0843 03313000
         STH   @12,OUCBNTSP(,OUCBPTR)                              0843 03314000
*           END;                    /* END PENDING CASE      @ZA20975*/ 03315000
*         RRPARI3=ZERO;             /* NORMAL TRANSWAP       @ZA16887*/ 03316000
@RC00809 MVI   RRPARI3(RRPAPTR),X'00'                              0845 03317000
*       END;                        /* END SWAPPABLE CASE    @ZA16887*/ 03318000
*     ELSE                          /* A.S. IS NONSWAPPABLE  @ZA16887*/ 03319000
*       IF OUCBTSWC='1'B THEN       /* TRANSWAP ALREADY DONE @ZA16887*/ 03320000
         B     @RC00806                                            0847 03321000
@RF00806 TM    OUCBTSWC(OUCBPTR),B'00001000'                       0847 03322000
         BNO   @RF00847                                            0847 03323000
*         DO;                       /* ADD ON THIS TRANSWAP  @ZA16887*/ 03324000
*           OUCBNDS=OUCBNDS+ONE;    /* INCR NONSWAP COUNT    @ZA16887*/ 03325000
         LA    @12,1                                               0849 03326000
         AH    @12,OUCBNDS(,OUCBPTR)                               0849 03327000
         STH   @12,OUCBNDS(,OUCBPTR)                               0849 03328000
*           IF OUCBNDS<ZERO THEN    /* COUNT WRAPPED?        @ZA16887*/ 03329000
         LH    @12,OUCBNDS(,OUCBPTR)                               0850 03330000
         LTR   @12,@12                                             0850 03331000
         BNM   @RF00850                                            0850 03332000
*             OUCBNDS=CON32767;     /* SET TO MAX VALUE      @ZA16887*/ 03333000
         MVC   OUCBNDS(2,OUCBPTR),@CH02502                         0851 03334000
*           IF OUCBNDS=ONE THEN     /* SWAP STATUS CHNGD?    @ZA16887*/ 03335000
*                                                                  0852 03336000
@RF00850 CLC   OUCBNDS(2,OUCBPTR),@CH00078                         0852 03337000
         BNE   @RF00852                                            0852 03338000
*             /*******************************************************/ 03339000
*             /*                                                     */ 03340000
*             /* ? IRACTLCL EPN(WMK)                                 */ 03341000
*             /*                                                     */ 03342000
*             /*******************************************************/ 03343000
*                                                                  0853 03344000
*             CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN            */ 03345000
*                                                                  0853 03346000
         L     @15,RMSBWMK(,RMCTPTR)                               0853 03347000
         BALR  @14,@15                                             0853 03348000
*           /*********************************************************/ 03349000
*           /*                                                       */ 03350000
*           /* LET WLM KNOW                                  @ZA16887*/ 03351000
*           /*                                                       */ 03352000
*           /*********************************************************/ 03353000
*                                                                  0854 03354000
*           RRPARI3=CON4;           /* TELL ISSUER TRANSWAP ALREADY     03355000
*                                      ISSUED                @ZA16887*/ 03356000
@RF00852 MVI   RRPARI3(RRPAPTR),X'04'                              0854 03357000
*         END;                      /* END DUPL TRANSWAP CASE      0855 03358000
*                                                            @ZA16887*/ 03359000
*       ELSE                        /* DONTSWAP WAS ISSUED   @ZA16887*/ 03360000
*         DO;                       /* PRIOR TO TRANSWAP     @ZA16887*/ 03361000
         B     @RC00847                                            0856 03362000
@RF00847 DS    0H                                                  0857 03363000
*           RETNCODE=ZERO;          /* ABEND ISSUER WITH 35F @ZA16887*/ 03364000
         SLR   RETNCODE,RETNCODE                                   0857 03365000
*           COMPCODE=CODE35F;       /*                       @ZA16887*/ 03366000
         LA    COMPCODE,863                                        0858 03367000
*           CALL EVTABEND;          /*                       @ZA16887*/ 03368000
         BAL   @14,EVTABEND                                        0859 03369000
*         END;                      /*                       @ZA16887*/ 03370000
*   ELSE                            /* TRANSWAP WAS ISSUED FOR     0861 03371000
*                                                            @ZA16887*/ 03372000
*     DO;                           /* A.S. OTHER THAN CURRENT     0861 03373000
*                                                            @ZA16887*/ 03374000
         B     @RC00805                                            0861 03375000
@RF00805 DS    0H                                                  0862 03376000
*       RESNCODE=CON4;              /* ABEND ISSUER WITH 15F RC=4  0862 03377000
*                                                            @ZA16887*/ 03378000
*                                                                  0862 03379000
         LA    RESNCODE,4                                          0862 03380000
*       /*************************************************************/ 03381000
*       /*                                                           */ 03382000
*       /* ? IRACTLCL EPN(I10)                                       */ 03383000
*       /*                                                           */ 03384000
*       /*************************************************************/ 03385000
*                                                                  0863 03386000
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */ 03387000
*                                                                  0863 03388000
         L     @15,RMSBI10(,RMCTPTR)                               0863 03389000
         BALR  @14,@15                                             0863 03390000
*       /*************************************************************/ 03391000
*       /*                                                           */ 03392000
*       /* INVALID INPUT TO SRM                              @ZA16887*/ 03393000
*       /*                                                           */ 03394000
*       /*************************************************************/ 03395000
*                                                                  0864 03396000
*     END;                          /*                       @ZA16887*/ 03397000
*/*  ? IRACTLCL EPN(CTL)                                             */ 03398000
*                                                                  0865 03399000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 03400000
*                                                                  0865 03401000
@RC00805 L     @12,RMEXCTL(,RMCTPTR)                               0865 03402000
         BR    @12                                                 0865 03403000
*   /*****************************************************************/ 03404000
*   /*                                                               */ 03405000
*   /* EXIT TO CONTROL                                       @ZA16887*/ 03406000
*   /*                                                               */ 03407000
*   /*****************************************************************/ 03408000
*                                                                  0866 03409000
*   RFY                                                            0866 03410000
*     OUXBPTR UNRSTD;               /* FREE UP REGISTER      @ZA16887*/ 03411000
*IRARME15:                          /* SYSEVENT 15 - SWOUTCMP        */ 03412000
*/*                                                                  */ 03413000
*/*    REMOVE ANY ERROR IN CURRENT SWAP OUT COUNT DUE TO DIFFERENCE  */ 03414000
*/*    IN NUMBER OF FRAMES FREED BY SWAP AND NUMBER EXPECTED TO BE   */ 03415000
*/*    FREED                                                         */ 03416000
*/*                                                                  */ 03417000
*                                                                  0867 03418000
*   OUCBPSO=SWOPGCNT;               /* SAVE NO. OF PAGES SWAPPED-OUT */ 03419000
IRARME15 L     @12,RRPAINP(,RRPAPTR)                               0867 03420000
         LH    @11,SWOPGCNT(,@12)                                  0867 03421000
         STH   @11,OUCBPSO(,OUCBPTR)                               0867 03422000
*   OUCBWSS=SWIWSS;                 /* SAVE WORKING SET SIZE         */ 03423000
         LH    @12,SWIWSS(,@12)                                    0868 03424000
         STH   @12,OUCBWSS(,OUCBPTR)                               0868 03425000
*/*                                                                  */ 03426000
*/*   RELEASE OUXB STORAGE.                                          */ 03427000
*/*                                                                  */ 03428000
*                                                                  0869 03429000
*   /*****************************************************************/ 03430000
*   /*                                                               */ 03431000
*   /* ? IRACTLCL EPN(UXB)                                           */ 03432000
*   /*                                                               */ 03433000
*   /*****************************************************************/ 03434000
*                                                                  0869 03435000
*   DO;                                                            0869 03436000
*     R1=ADDR(RMEPBUXB);            /* UXB REQUEST IS PARAM          */ 03437000
         LA    R1,RMEPBUXB(,RMCTPTR)                               0870 03438000
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */ 03439000
         L     @15,RMSBCRN(,RMCTPTR)                               0871 03440000
         BALR  @14,@15                                             0871 03441000
*   END;                                                           0872 03442000
*   IF OUCBRDY^='1'B|               /* IF MEMORY NOT SWAPPED-OUT BY  */ 03443000
*       OUCBPVL='1'B THEN           /* ANALYSIS, OR MEMORY IS      0873 03444000
*                                      PRIVILEGED            @Z40BPJE*/ 03445000
*                                                                  0873 03446000
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0873 03447000
         BNO   @RT00873                                            0873 03448000
         TM    OUCBPVL(OUCBPTR),B'00000100'                        0873 03449000
         BNO   @RF00873                                            0873 03450000
@RT00873 DS    0H                                                  0874 03451000
*     /***************************************************************/ 03452000
*     /*                                                             */ 03453000
*     /* ? IRACTLCL EPN(CAP)                                         */ 03454000
*     /*                                                             */ 03455000
*     /***************************************************************/ 03456000
*                                                                  0874 03457000
*     DO;                                                          0874 03458000
*       R1=ADDR(RMEPBCAP);          /* CAP REQUEST IS PARAM          */ 03459000
         LA    R1,RMEPBCAP(,RMCTPTR)                               0875 03460000
*       CALL RMSBCRL->IRARMRTN;     /* ALGRTHM SCH FUNCT             */ 03461000
         L     @15,RMSBCRL(,RMCTPTR)                               0876 03462000
         BALR  @14,@15                                             0876 03463000
*     END;                                                         0877 03464000
*   IF SWOWRSM='1'B THEN            /* MEMORY WAITING ON RSM SERVICE */ 03465000
@RF00873 L     @12,RRPAINP(,RRPAPTR)                               0878 03466000
         TM    SWOWRSM(@12),B'00000001'                            0878 03467000
         BNO   @RF00878                                            0878 03468000
*     DO;                           /*                               */ 03469000
*       OUCBRSMB='1'B;              /* SET RSM SERVICE READY FLAG    */ 03470000
         L     @12,OUCBRSMB-2(,OUCBPTR)                            0880 03471000
@GL00038 LR    @11,@12                                             0880 03472000
         O     @11,@CF02713                                        0880 03473000
         CS    @12,@11,OUCBRSMB-2(OUCBPTR)                         0880 03474000
         BNE   @GL00038                                            0880 03475000
*       IF OUCBRDY='0'B THEN        /* IF MEMORY NOT MARKED READY    */ 03476000
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0881 03477000
         BNZ   @RF00881                                            0881 03478000
*         CALL IRARME04;            /* MAKE MEMORY ELIGIBLE FOR      */ 03479000
         BAL   @14,IRARME04                                        0882 03480000
*     END;                          /* SWAP IN                       */ 03481000
*                                                                  0883 03482000
@RF00881 DS    0H                                                  0884 03483000
*   /*****************************************************************/ 03484000
*   /*                                                               */ 03485000
*   /* ? IRACTLCL EPN(I01)                                           */ 03486000
*   /*                                                               */ 03487000
*   /*****************************************************************/ 03488000
*                                                                  0884 03489000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 03490000
*                                                                  0884 03491000
@RF00878 L     @12,RMEXI01(,RMCTPTR)                               0884 03492000
         BR    @12                                                 0884 03493000
*   /*****************************************************************/ 03494000
*   /*                                                               */ 03495000
*   /* RETURN TO INVOKER                                             */ 03496000
*   /*                                                               */ 03497000
*   /*****************************************************************/ 03498000
*                                                                  0885 03499000
*IRARME16:                          /* EVENT 16 - SWINSTAT   @Z40BPEB*/ 03500000
*/*  THIS SYSEVENT HAS TWO REASON CODES:                             */ 03501000
*/*      1 - SWAP IN PROCESS HAS STARTED                             */ 03502000
*/*      2 - SWAP IN PROCESS HAS COMPLETED (STAGE ONE)               */ 03503000
*/*   THIS IS A NO-OP FOR RELEASE 4,JUST PROVIDES FOR GTF TRACING    */ 03504000
*/*                                                                  */ 03505000
*                                                                  0885 03506000
*   /*****************************************************************/ 03507000
*   /*                                                               */ 03508000
*   /* ? IRACTLCL EPN(I01)                                           */ 03509000
*   /*                                                               */ 03510000
*   /*****************************************************************/ 03511000
*                                                                  0885 03512000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 03513000
*                                                                  0885 03514000
IRARME16 L     @12,RMEXI01(,RMCTPTR)                               0885 03515000
         BR    @12                                                 0885 03516000
*   /*****************************************************************/ 03517000
*   /*                                                               */ 03518000
*   /* RETURN TO INVOKER                                     @Z40BPEB*/ 03519000
*   /*                                                               */ 03520000
*   /*****************************************************************/ 03521000
*                                                                  0886 03522000
*IRARME17:                          /* SYSEVENT 17 - SWINFL          */ 03523000
*   OUCBGOI='0'B;                   /* MEMORY NO LONGER TRANSITIONING   03524000
*                                      INTO MAIN STORAGE             */ 03525000
IRARME17 NI    OUCBGOI(OUCBPTR),B'10111111'                        0886 03526000
*   RMCACIUS=RMCACIUS-ONE;          /* SUBTR FM SWAPIN COUNT @Z30WIMG*/ 03527000
         LH    @12,RMCACIUS(,RMCTPTR)                              0887 03528000
         BCTR  @12,0                                               0887 03529000
         STH   @12,RMCACIUS(,RMCTPTR)                              0887 03530000
*   OUCBGOB='1'B;                   /* RPS BEING INVOKED             */ 03531000
*                                                                  0888 03532000
         OI    OUCBGOB(OUCBPTR),B'00100000'                        0888 03533000
*   /*****************************************************************/ 03534000
*   /*                                                               */ 03535000
*   /* ? IRACTLCL EPN(RPS)                                           */ 03536000
*   /*                                                               */ 03537000
*   /*****************************************************************/ 03538000
*                                                                  0889 03539000
*   DO;                                                            0889 03540000
*     R1=ADDR(RMEPBRPS);            /* RPS REQUEST IS PARAM          */ 03541000
         LA    R1,RMEPBRPS(,RMCTPTR)                               0890 03542000
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */ 03543000
         L     @15,RMSBCRN(,RMCTPTR)                               0891 03544000
         BALR  @14,@15                                             0891 03545000
*   END;                            /* REQUEUE MEMORY FOR SWAP ANLZ  */ 03546000
*   IF ASCBOUXB^=RMCTOUXB&          /* CANNOT FREE PREDEFINED@ZA00250*/ 03547000
*       OUCBOUT='1'B THEN           /* OUXB OR OUXB OF USER WHO IS 0893 03548000
*                                      NOT OUT OF MAIN STORAGE     0893 03549000
*                                                            @ZA00250*/ 03550000
         L     @12,ASCBOUXB(,ASCBPTR)                              0893 03551000
         C     @12,RMCTOUXB(,RMCTPTR)                              0893 03552000
         BE    @RF00893                                            0893 03553000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0893 03554000
         BNO   @RF00893                                            0893 03555000
*     DO;                           /*                       @ZA00250*/ 03556000
*       R0=LENGTH(OUXB);            /* LENGTH OF STOAGE AREA @ZA00250*/ 03557000
         LA    R0,144                                              0895 03558000
*       R1=ASCBOUXB;                /* STORAGE AREA ADDRESS  @ZA00250*/ 03559000
*                                                                  0896 03560000
         LR    R1,@12                                              0896 03561000
*       /*************************************************************/ 03562000
*       /*                                                           */ 03563000
*       /*                                                   @ZA00250*/ 03564000
*       /* FREE STORAGE                                      @ZA00250*/ 03565000
*       /*                                                   @ZA00250*/ 03566000
*       /* ? IRACTLCL EPN(I04)                                       */ 03567000
*       /*                                                           */ 03568000
*       /*************************************************************/ 03569000
*                                                                  0897 03570000
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */ 03571000
*                                                                  0897 03572000
         L     @15,RMSBI04(,RMCTPTR)                               0897 03573000
         BALR  @14,@15                                             0897 03574000
*       /*************************************************************/ 03575000
*       /*                                                           */ 03576000
*       /*                                                   @ZA00250*/ 03577000
*       /*                                                   @ZA00250*/ 03578000
*       /* PROVIDE DUMMY AREA FOR OUXB TO PREVENT DESTRUCTION        */ 03579000
*       /*                                                   @ZA00250*/ 03580000
*       /* OF VALID INFORMATION IF AN ATTEMPT TO REFERENCE   @ZA00250*/ 03581000
*       /* OUXB OCCURS WHILE THE MEMORY IS SWAPPED OUT.      @ZA00250*/ 03582000
*       /*                                                   @ZA00250*/ 03583000
*       /*                                                           */ 03584000
*       /*************************************************************/ 03585000
*                                                                  0898 03586000
*       ASCBOUXB=RMCTOUXB;          /*                       @ZA00250*/ 03587000
         L     @12,RMCTOUXB(,RMCTPTR)                              0898 03588000
         ST    @12,ASCBOUXB(,ASCBPTR)                              0898 03589000
*     END;                          /*                       @ZA00250*/ 03590000
*                                                                  0899 03591000
*   /*****************************************************************/ 03592000
*   /*                                                               */ 03593000
*   /* ? IRACTLCL EPN(CTL)                                           */ 03594000
*   /*                                                               */ 03595000
*   /*****************************************************************/ 03596000
*                                                                  0900 03597000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 03598000
*                                                                  0900 03599000
@RF00893 L     @12,RMEXCTL(,RMCTPTR)                               0900 03600000
         BR    @12                                                 0900 03601000
*   /*****************************************************************/ 03602000
*   /*                                                               */ 03603000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 03604000
*   /*                                                               */ 03605000
*   /*****************************************************************/ 03606000
*                                                                  0901 03607000
*IRARME18:                          /* SYSEVENT 18 - QSCEFL          */ 03608000
*   OUCBPSTR='0'B;                  /* RESET XMPOST ERROR FLAG THAT     03609000
*                                      WAS SET BY CSO        @ZA16887*/ 03610000
IRARME18 NI    OUCBPSTR(OUCBPTR),B'11110111'                       0901 03611000
*   CALL EVTCHAP;                   /* CHAP TO USER PRIORITY @YM05632*/ 03612000
         BAL   @14,EVTCHAP                                         0902 03613000
*IRARME19:                          /* SYSEVENT 19 - RSTORCMP        */ 03614000
*   RESPECIFY                                                      0903 03615000
*    (RTNREG,                                                      0903 03616000
*     RTNREG,                                                      0903 03617000
*     NTRREG) UNRSTD;                                              0903 03618000
IRARME19 DS    0H                                                  0904 03619000
*   RESPECIFY                                                      0904 03620000
*    (OUXBPTR,                                                     0904 03621000
*     OUSBPTR,                                                     0904 03622000
*     RESNCODE) RSTD;               /*                       @ZA16887*/ 03623000
*   OUXBPTR=ASCBOUXB;               /* ADDRESSABILITY TO OUXB        */ 03624000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0905 03625000
*   OUSBPTR=ASXBOUSB;               /* ADDRESSABILITY TO OUSB        */ 03626000
         L     @14,ASXBPTR(,ASCBPTR)                               0906 03627000
         L     OUSBPTR,ASXBOUSB(,@14)                              0906 03628000
*   IF OUCBGOI='1'B THEN            /* MEMORY WAS SWAPPED OUT        */ 03629000
         TM    OUCBGOI(OUCBPTR),B'01000000'                        0907 03630000
         BNO   @RF00907                                            0907 03631000
*     DO;                                                          0908 03632000
*                                                                  0908 03633000
*       /*************************************************************/ 03634000
*       /*                                                           */ 03635000
*       /* UPDATE THE SWAP ACCUMULATORS IN THE OUSB TO INCLUDE THE   */ 03636000
*       /* NUMBER OF PAGES SWAPPED IN AND OUT.                       */ 03637000
*       /*                                                           */ 03638000
*       /*************************************************************/ 03639000
*                                                                  0909 03640000
*       OUSBSPIN=OUSBSPIN+          /* NUMBER OF PAGES SWAPPED IN    */ 03641000
*           OUCBWSS;                                               0909 03642000
         LH    @14,OUCBWSS(,OUCBPTR)                               0909 03643000
         AL    @14,OUSBSPIN(,OUSBPTR)                              0909 03644000
         ST    @14,OUSBSPIN(,OUSBPTR)                              0909 03645000
*       OUSBSPOT=OUSBSPOT+          /* NUMBER OF PAGES SWAPPED OUT   */ 03646000
*           OUCBPSO;                                               0910 03647000
         LH    @14,OUCBPSO(,OUCBPTR)                               0910 03648000
         AL    @14,OUSBSPOT(,OUSBPTR)                              0910 03649000
         ST    @14,OUSBSPOT(,OUSBPTR)                              0910 03650000
*       OUSBSWCT=OUSBSWCT+ONE;      /* NO. OF TIMES MEMORY SWAPPED   */ 03651000
         LA    @14,1                                               0911 03652000
         AL    @14,OUSBSWCT(,OUSBPTR)                              0911 03653000
         ST    @14,OUSBSWCT(,OUSBPTR)                              0911 03654000
*       RMCACIUS=RMCACIUS-ONE;      /* SUBTR FM SWAPIN COUNT @Z30WIMG*/ 03655000
         LH    @14,RMCACIUS(,RMCTPTR)                              0912 03656000
         BCTR  @14,0                                               0912 03657000
         STH   @14,RMCACIUS(,RMCTPTR)                              0912 03658000
*     END;                                                         0913 03659000
*                                                                  0913 03660000
*/*                                                                  */ 03661000
*/*   MEMORY NO LONGER TRANSITIONING INTO OR OUT OF MAIN STORAGE.    */ 03662000
*/*   RESET SWAP STATUS INDICATORS.                                  */ 03663000
*/*   NOTE:  A SWAP OUT REQUEST AGAINST THIS MEMORY IS NOW VALID.    */ 03664000
*/*                                                                  */ 03665000
*                                                                  0914 03666000
*   OUCBSRC=ZERO;                   /* RESET SWAPOUT REASON CODE   0914 03667000
*                                                            @Z40BPJE*/ 03668000
@RF00907 MVI   OUCBSRC(OUCBPTR),X'00'                              0914 03669000
*   OUCBGOO='0'B;                                                  0915 03670000
*   OUCBGOI='0'B;                                                  0916 03671000
*   OUCBOFF='0'B;                                                  0917 03672000
*   OUCBOUT='0'B;                   /* RESET MEMORY OUT OF STORGE IND*/ 03673000
         NI    OUCBGOO(OUCBPTR),B'00110011'                        0918 03674000
*   IF OUCBQSC='1'B THEN            /* QUIESCE COMPLETED SYSEVENT  0919 03675000
*                                      PROCESSED, PERFORM NORMAL RES-   03676000
*                                      TORE COMPLETED PROCESSING     */ 03677000
         TM    OUCBQSC(OUCBPTR),B'00000010'                        0919 03678000
         BNO   @RF00919                                            0919 03679000
*     DO;                                                          0920 03680000
*                                                                  0920 03681000
*       /*************************************************************/ 03682000
*       /*                                                           */ 03683000
*       /* MOVE THE INFORMATION SAVED AT THE PREVIOUS QUIESCE COMP-  */ 03684000
*       /* LETED SYSEVENT FROM THE OUSB TO THE OUXB.                 */ 03685000
*       /*                                                           */ 03686000
*       /*************************************************************/ 03687000
*                                                                  0921 03688000
*       OUXBFLDS=OUSBFLDS;                                         0921 03689000
*                                                                  0921 03690000
         MVC   OUXBFLDS(80,OUXBPTR),OUSBFLDS(OUSBPTR)              0921 03691000
*       /*************************************************************/ 03692000
*       /*                                                           */ 03693000
*       /* ADJUST START TIME OF I/O MONITORING INTERVAL IN           */ 03694000
*       /* CONJUNCTION WITH QUIESCE COMPLETE TO REFLECT SWAPPED OUT  */ 03695000
*       /* TIME PERIOD.                                              */ 03696000
*       /*                                                           */ 03697000
*       /*************************************************************/ 03698000
*                                                                  0922 03699000
*       OUXBITD=OUXBITD+RMCTTOD;                                   0922 03700000
*                                                                  0922 03701000
         L     @14,OUXBITD(,OUXBPTR)                               0922 03702000
         AL    @14,RMCTTOD(,RMCTPTR)                               0922 03703000
         ST    @14,OUXBITD(,OUXBPTR)                               0922 03704000
*       /*************************************************************/ 03705000
*       /*                                                           */ 03706000
*       /* CALCULATE USER EXECUTION TIME IN 1.024 MILLISECONDS.      */ 03707000
*       /*                                                           */ 03708000
*       /*************************************************************/ 03709000
*                                                                  0923 03710000
*       RESPECIFY                                                  0923 03711000
*        (EJST1,                    /* RESTRICT REGISTERS USED IN THE*/ 03712000
*         EJST2)                    /* CALCULATION OF USER EXECUTION */ 03713000
*             RSTD;                 /* TIME                          */ 03714000
*       GENERATE CODE REFS(ASCBEJST,ASCBPTR,EJST1,EJST2);          0924 03715000
         LM    EJST1,EJST2,ASCBEJST(ASCBPTR)                            03716000
         SRDL  EJST1,MILLISEC                                           03717000
MILLISEC EQU   22                      CONVERT MICRO TO 1.024 MILLIS    03718000
*       OUXBPET=EJST2;              /* SAVE TASK PORTION OF CPU TIME */ 03719000
         ST    EJST2,OUXBPET(,OUXBPTR)                             0925 03720000
*       GENERATE CODE REFS(ASCBSRBT);                              0926 03721000
         LM    EJST1,EJST2,ASCBSRBT(ASCBPTR)                            03722000
         SRDL  EJST1,MILLISEC                                           03723000
*       OUXBPET=OUXBPET+EJST2;      /* SAVE SRB PORTION OF TIME      */ 03724000
         LR    @14,EJST2                                           0927 03725000
         AL    @14,OUXBPET(,OUXBPTR)                               0927 03726000
         ST    @14,OUXBPET(,OUXBPTR)                               0927 03727000
*       OUXBSTC=ZERO;               /* BASE STEAL COUNT              */ 03728000
         SLR   @12,@12                                             0928 03729000
         STH   @12,OUXBSTC(,OUXBPTR)                               0928 03730000
*       RESPECIFY                                                  0929 03731000
*        (EJST1,                    /* CALCULATIONS COMPLETE, RETURN */ 03732000
*         EJST2)                    /* USE OF REGISTERS TO COMPILER  */ 03733000
*             UNRSTD;                                              0929 03734000
*       IF OUCBINC='1'B             /* IF A NEW TSO TRANSACTION IS   */ 03735000
*           &OUCBATR='0'B THEN      /* ABOUT TO BEGIN                */ 03736000
         TM    OUCBINC(OUCBPTR),B'00000001'                        0930 03737000
         BNO   @RF00930                                            0930 03738000
         TM    OUCBATR(OUCBPTR),B'10000000'                        0930 03739000
         BNZ   @RF00930                                            0930 03740000
*         DO;                       /* THEN                          */ 03741000
*           OUXBAET=OUXBPET;        /* RESET APG PRIORITY            */ 03742000
         ST    @14,OUXBAET(,OUXBPTR)                               0932 03743000
*           OUXBWCT=ASCBSWCT;       /* COMPUTATION BASE VALUES       */ 03744000
         LH    @14,ASCBSWCT(,ASCBPTR)                              0933 03745000
         STH   @14,OUXBWCT(,OUXBPTR)                               0933 03746000
*           OUCBCPL='0'B;           /* RESET SIGNIFICANT CPU USER FLG*/ 03747000
         NI    OUCBCPL(OUCBPTR),B'11101111'                        0934 03748000
*         END;                                                     0935 03749000
*                                                                  0935 03750000
*       /*************************************************************/ 03751000
*       /*                                                           */ 03752000
*       /* RESUME AN ACTIVE TRANSACTION IN THE MEMORY.               */ 03753000
*       /*                                                           */ 03754000
*       /*************************************************************/ 03755000
*                                                                  0936 03756000
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL        */ 03757000
*                                                                  0936 03758000
@RF00930 TM    OUCBINC(OUCBPTR),B'00000001'                        0936 03759000
         BNO   @RF00936                                            0936 03760000
*         /***********************************************************/ 03761000
*         /*                                                         */ 03762000
*         /* ? IRACTLCL EPN(WMR)                                     */ 03763000
*         /*                                                         */ 03764000
*         /***********************************************************/ 03765000
*                                                                  0937 03766000
*         CALL RMSBWMR->IRARMRTN;   /* INVOKE WMR SUBRTN             */ 03767000
*                                                                  0937 03768000
         L     @15,RMSBWMR(,RMCTPTR)                               0937 03769000
         BALR  @14,@15                                             0937 03770000
*       /*************************************************************/ 03771000
*       /*                                                           */ 03772000
*       /* INITIALIZE ASM SHORTAGE MONITORING FIELDS                 */ 03773000
*       /*                                                           */ 03774000
*       /*************************************************************/ 03775000
*                                                                  0938 03776000
*       OUXBVSC=ASCBVSC;            /* BASE VAM SLOT COUNT           */ 03777000
@RF00936 LH    @14,ASCBVSC(,ASCBPTR)                               0938 03778000
         STH   @14,OUXBVSC(,OUXBPTR)                               0938 03779000
*       OUXBNVC=ASCBNVSC;           /* BASE NON-VAM SLOT COUNT       */ 03780000
         LH    @14,ASCBNVSC(,ASCBPTR)                              0939 03781000
         STH   @14,OUXBNVC(,OUXBPTR)                               0939 03782000
*       OUXBSTD=RMCTTOD;            /* BASE TIME OF DAY              */ 03783000
         L     @14,RMCTTOD(,RMCTPTR)                               0940 03784000
         ST    @14,OUXBSTD(,OUXBPTR)                               0940 03785000
*       RMCAINUS=RMCAINUS+ONE;      /* INCREMENT NO. OF IN-CORE USERS*/ 03786000
         LA    @14,1                                               0941 03787000
         AH    @14,RMCAINUS(,RMCTPTR)                              0941 03788000
         STH   @14,RMCAINUS(,RMCTPTR)                              0941 03789000
*       OUCBQSC='0'B;               /* RESET QUIESCE COMPLETED     0942 03790000
*                                      SYSEVENT PROCESSED FLAG       */ 03791000
         NI    OUCBQSC(OUCBPTR),B'11111101'                        0942 03792000
*     END;                                                         0943 03793000
*   ELSE                            /* SWAPOUT NOT PERFORMED         */ 03794000
*     RRPAWAIT=ZERO;                /* RESET WAIT STATE INDICATOR    */ 03795000
*                                                                  0944 03796000
         B     @RC00919                                            0944 03797000
@RF00919 MVI   RRPAWAIT(RRPAPTR),X'00'                             0944 03798000
*   /*****************************************************************/ 03799000
*   /*                                                               */ 03800000
*   /* IF A TRANSWAP AND/OR REQSWAP IS PENDING, IMMEDIATELY SWAP THE */ 03801000
*   /* A.S. BACK OUT WITH THE APPROPRIATE REASON CODE.       @ZA16887*/ 03802000
*   /*                                                               */ 03803000
*   /*****************************************************************/ 03804000
*                                                                  0945 03805000
*   IF OUCBRSWP='1'B|OUCBTSWP='1'B THEN/* TRANS OR REQSWAP PENDING 0945 03806000
*                                                            @ZA16887*/ 03807000
@RC00919 TM    OUCBRSWP(OUCBPTR),B'00110000'                       0945 03808000
         BZ    @RF00945                                            0945 03809000
*     IF RRPACOD=SYSEVT19 THEN      /* THIS IS RSTORCMP,     @ZA29919*/ 03810000
         CLI   RRPACOD(RRPAPTR),19                                 0946 03811000
         BNE   @RF00946                                            0946 03812000
*       DO;                         /* FINISH IT NOW         @ZA16887*/ 03813000
*                                                                  0947 03814000
*         /***********************************************************/ 03815000
*         /*                                                         */ 03816000
*         /* ? IRACTLCL EPN(CSO)                                     */ 03817000
*         /*                                                         */ 03818000
*         /***********************************************************/ 03819000
*                                                                  0948 03820000
*         DO;                                                      0948 03821000
*           R1=ADDR(RMEPBCSO);      /* CSO REQUEST IS PARAM          */ 03822000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0949 03823000
*           CALL RMSBCRY->IRARMRTN; /* ACTION INVK FUNCT             */ 03824000
         L     @15,RMSBCRY(,RMCTPTR)                               0950 03825000
         BALR  @14,@15                                             0950 03826000
*         END;                      /* INVOKE SWAPOUT ROUTINE      0951 03827000
*                                                            @ZA16887*/ 03828000
*         IF RETNCODE=ZERO THEN     /* SWAPOUT WAS BEGUN     @ZA16887*/ 03829000
         LTR   RETNCODE,RETNCODE                                   0952 03830000
         BNZ   @RF00952                                            0952 03831000
*           DO;                     /* CONTINUE TRANS OR REQSWAP   0953 03832000
*                                                            @ZA16887*/ 03833000
*             OUCBLWT='0'B;         /* RESET LONG            @ZA16887*/ 03834000
*             OUCBMWT='0'B;         /* WAIT FLAGS            @ZA16887*/ 03835000
*             OUCBTRM='0'B;         /* INDICATE NO TERMWAIT SWAPOUT     03836000
*                                                            @ZA16887*/ 03837000
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0956 03838000
*             OUCBSRC=SRCDRQSC;     /* SET REASON CODE       @ZA16887*/ 03839000
         MVI   OUCBSRC(OUCBPTR),X'07'                              0957 03840000
*             IF RRPASVC='1'B THEN  /* IF SVC ENTRY TO SRM   @ZA16887*/ 03841000
         TM    RRPASVC(RRPAPTR),B'00100000'                        0958 03842000
         BNO   @RF00958                                            0958 03843000
*               RRPARTN=CVTEXP1;    /* FORCE EXIT THRU DISPATCHER  0959 03844000
*                                                            @ZA16887*/ 03845000
         L     @14,CVTPTR                                          0959 03846000
         L     @14,CVTEXP1(,@14)                                   0959 03847000
         ST    @14,RRPARTN(,RRPAPTR)                               0959 03848000
*           END;                    /* TO ALLOW SWAPOUT TO RUN     0960 03849000
*                                                            @ZA16887*/ 03850000
*         ELSE                      /* SWAPOUT NOT BEGUN     @ZA16887*/ 03851000
*           DO;                     /* INVALID SRM CONTROL BLOCKS  0961 03852000
*                                                            @ZA16887*/ 03853000
         B     @RC00952                                            0961 03854000
@RF00952 DS    0H                                                  0962 03855000
*             RESNCODE=CON24;       /* ABEND 15F RC=24       @ZA16887*/ 03856000
*                                                                  0962 03857000
         LA    RESNCODE,24                                         0962 03858000
*             /*******************************************************/ 03859000
*             /*                                                     */ 03860000
*             /* ? IRACTLCL EPN(I10)                                 */ 03861000
*             /*                                                     */ 03862000
*             /*******************************************************/ 03863000
*                                                                  0963 03864000
*             CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT            */ 03865000
*                                                                  0963 03866000
         L     @15,RMSBI10(,RMCTPTR)                               0963 03867000
         BALR  @14,@15                                             0963 03868000
*             /*******************************************************/ 03869000
*             /*                                                     */ 03870000
*             /* FRR WILL CONVERT TO 25F                     @ZA16887*/ 03871000
*             /*                                                     */ 03872000
*             /*******************************************************/ 03873000
*                                                                  0964 03874000
*           END;                    /*                       @ZA16887*/ 03875000
*       END;                        /* END RSTORCMP CASE     @ZA29919*/ 03876000
*     ELSE                          /* THIS IS QSCEFL,       @ZA29919*/ 03877000
*                                                                  0966 03878000
*       /*************************************************************/ 03879000
*       /*                                                           */ 03880000
*       /* IF A SYSEVENT QSCEFL OCCURS WHEN A REQUESTED SWAP OR A    */ 03881000
*       /* TRANSITION-TO-NONSWAPPABLE SWAP IS PENDING, TRY THE SWAP  */ 03882000
*       /* AGAIN. IF QUIESCE FAILS A SECOND TIME, ABEND RCT WITH CODE*/ 03883000
*       /* 45F TO PREVENT THE ISSUER FROM WAITING FOREVER FOR THE    */ 03884000
*       /* SWAP TO COMPLETE AND TO PREVENT POSSIBLE MISUSE OF        */ 03885000
*       /* RECONFIGURABLE OR V=R STORAGE FRAMES.             @ZA29919*/ 03886000
*       /*                                                           */ 03887000
*       /*************************************************************/ 03888000
*                                                                  0966 03889000
*       IF OUCBQSFL='0'B THEN       /* FIRST QSCEFL?         @ZA29919*/ 03890000
         B     @RC00946                                            0966 03891000
@RF00946 TM    OUCBQSFL(OUCBPTR),B'00010000'                       0966 03892000
         BNZ   @RF00966                                            0966 03893000
*         DO;                       /* TRY SWAP OUT AGAIN    @ZA29919*/ 03894000
*                                                                  0967 03895000
*           /*********************************************************/ 03896000
*           /*                                                       */ 03897000
*           /* ? IRACTLCL EPN(CSO)                                   */ 03898000
*           /*                                                       */ 03899000
*           /*********************************************************/ 03900000
*                                                                  0968 03901000
*           DO;                                                    0968 03902000
*             R1=ADDR(RMEPBCSO);    /* CSO REQUEST IS PARAM          */ 03903000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0969 03904000
*             CALL RMSBCRY->IRARMRTN;/* ACTION INVK FUNCT            */ 03905000
         L     @15,RMSBCRY(,RMCTPTR)                               0970 03906000
         BALR  @14,@15                                             0970 03907000
*           END;                    /* INITIATE SWAP OUT     @ZA29919*/ 03908000
*           IF RTNCOD=ZERO THEN     /* SWAP OUT WAS BEGUN    @ZA29919*/ 03909000
         LTR   RTNCOD,RTNCOD                                       0972 03910000
         BNZ   @RF00972                                            0972 03911000
*             DO;                   /*                       @ZA29919*/ 03912000
*               OUCBQSFL='1'B;      /* PREVENT RECURSION (BIT IS   0974 03913000
*                                      RESET AT QSCECMP)     @ZA29919*/ 03914000
         OI    OUCBQSFL(OUCBPTR),B'00010000'                       0974 03915000
*               OUCBSRC=SRCDRQSC;   /* REASON CODE IS SAME FOR     0975 03916000
*                                      REQSWAP OR TRANSWAP   @ZA29919*/ 03917000
         MVI   OUCBSRC(OUCBPTR),X'07'                              0975 03918000
*             END;                  /* END SWAP RETRY CASE   @ZA29919*/ 03919000
*           ELSE                    /* SWAP OUT NOT POSSIBLE @ZA29919*/ 03920000
*             DO;                   /* ABEND RCT             @ZA29919*/ 03921000
         B     @RC00972                                            0977 03922000
@RF00972 DS    0H                                                  0978 03923000
*               RETNCODE=ZERO;      /* PREPARE INPUT         @ZA29919*/ 03924000
         SLR   RETNCODE,RETNCODE                                   0978 03925000
*               COMPCODE=CODE45F;   /* REGISTERS FOR ABEND   @ZA29919*/ 03926000
         LA    COMPCODE,1119                                       0979 03927000
*               CALL EVTABEND;      /* ISSUE ABEND 45F       @ZA29919*/ 03928000
         BAL   @14,EVTABEND                                        0980 03929000
*             END;                  /*                       @ZA29919*/ 03930000
*         END;                      /*                       @ZA29919*/ 03931000
*       ELSE                        /* QSCEFL IS RECURSIVE,  @ZA29919*/ 03932000
*         DO;                       /* ABEND RCT             @ZA29919*/ 03933000
         B     @RC00966                                            0983 03934000
@RF00966 DS    0H                                                  0984 03935000
*           RETNCODE=ZERO;          /* PREPARE INPUT         @ZA29919*/ 03936000
         SLR   RETNCODE,RETNCODE                                   0984 03937000
*           COMPCODE=CODE45F;       /* REGISTERS FOR ABEND   @ZA29919*/ 03938000
         LA    COMPCODE,1119                                       0985 03939000
*           CALL EVTABEND;          /* ISSUE ABEND 45F       @ZA29919*/ 03940000
         BAL   @14,EVTABEND                                        0986 03941000
*         END;                      /*                       @ZA29919*/ 03942000
*                                                                  0987 03943000
*   /*****************************************************************/ 03944000
*   /*                                                               */ 03945000
*   /* NOW CONTINUE WITH RESTORE PROCESSING.                 @ZA29919*/ 03946000
*   /*                                                               */ 03947000
*   /*****************************************************************/ 03948000
*                                                                  0988 03949000
*   OUCBQSS='0'B;                   /* RESET QUIESCE STARTED SYSEVENT   03950000
*                                      PROCESSED FLAG                */ 03951000
@RC00966 DS    0H                                                  0988 03952000
@RC00946 DS    0H                                                  0988 03953000
@RF00945 NI    OUCBQSS(OUCBPTR),B'11111011'                        0988 03954000
*/*                                                                  */ 03955000
*/*   CHANGE THE CURRENT STATUS OF THE MEMORY FROM OUT OF MAIN STOR- */ 03956000
*/*   AGE TO IN MAIN STORAGE.                                        */ 03957000
*/*                                                                  */ 03958000
*                                                                  0989 03959000
*   OUCBGOB='1'B;                   /* RPS HAS BEEN INVOKED          */ 03960000
*                                                                  0989 03961000
         OI    OUCBGOB(OUCBPTR),B'00100000'                        0989 03962000
*   /*****************************************************************/ 03963000
*   /*                                                               */ 03964000
*   /* ? IRACTLCL EPN(RPS)                                           */ 03965000
*   /*                                                               */ 03966000
*   /*****************************************************************/ 03967000
*                                                                  0990 03968000
*   DO;                                                            0990 03969000
*     R1=ADDR(RMEPBRPS);            /* RPS REQUEST IS PARAM          */ 03970000
         LA    R1,RMEPBRPS(,RMCTPTR)                               0991 03971000
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */ 03972000
         L     @15,RMSBCRN(,RMCTPTR)                               0992 03973000
         BALR  @14,@15                                             0992 03974000
*   END;                                                           0993 03975000
*   IF RRPAWAIT=LONGWAIT&           /* IF MEMORY STILL IN LONG WAIT  */ 03976000
*       OUCBNSW='0'B&               /* MEMORY IS NOT NON-SWAPPABLE & */ 03977000
*       OUCBCTI='0'B&               /* CONTROL DOES NOT PROHIBIT SWAP*/ 03978000
*       OUCBENQ='0'B&               /* NOT RESOURCE HOLDER   @YM05631*/ 03979000
*       OUCBRSM='0'B&               /* NOT WAIT FOR RSM SERVC@YM05631*/ 03980000
*       OUCBBIB='0'B&               /* NOT BEING CANCELLED   @Z40BPEB*/ 03981000
*       RRPACOD=SYSEVT19 THEN       /* RESTORE COMPLETED SYSEVENT    */ 03982000
*                                                                  0994 03983000
         CLI   RRPAWAIT(RRPAPTR),X'80'                             0994 03984000
         BNE   @RF00994                                            0994 03985000
         TM    OUCBNSW(OUCBPTR),B'11000010'                        0994 03986000
         BNZ   @RF00994                                            0994 03987000
         TM    OUCBRSM(OUCBPTR),B'01000000'                        0994 03988000
         BNZ   @RF00994                                            0994 03989000
         TM    OUCBBIB(OUCBPTR),B'00100000'                        0994 03990000
         BNZ   @RF00994                                            0994 03991000
         CLI   RRPACOD(RRPAPTR),19                                 0994 03992000
         BNE   @RF00994                                            0994 03993000
*     /***************************************************************/ 03994000
*     /*                                                             */ 03995000
*     /* SWAP-OUT THIS MEMORY                                        */ 03996000
*     /*                                                             */ 03997000
*     /***************************************************************/ 03998000
*                                                                  0995 03999000
*     DO;                                                          0995 04000000
*                                                                  0995 04001000
*       /*************************************************************/ 04002000
*       /*                                                           */ 04003000
*       /* ? IRACTLCL EPN(CSO)                                       */ 04004000
*       /*                                                           */ 04005000
*       /*************************************************************/ 04006000
*                                                                  0996 04007000
*       DO;                                                        0996 04008000
*         R1=ADDR(RMEPBCSO);        /* CSO REQUEST IS PARAM          */ 04009000
         LA    R1,RMEPBCSO(,RMCTPTR)                               0997 04010000
*         CALL RMSBCRY->IRARMRTN;   /* ACTION INVK FUNCT             */ 04011000
         L     @15,RMSBCRY(,RMCTPTR)                               0998 04012000
         BALR  @14,@15                                             0998 04013000
*       END;                                                       0999 04014000
*       RESPECIFY                                                  1000 04015000
*         RTNCOD RSTD;              /*                       @Z30WIAW*/ 04016000
*       IF RTNCOD=ZERO THEN         /* SWAP-OUT REQUEST SUCCESSFUL   */ 04017000
         LTR   RTNCOD,RTNCOD                                       1001 04018000
         BNZ   @RF01001                                            1001 04019000
*         DO;                       /*                       @Z30WIMG*/ 04020000
*           OUCBLWT='1'B;           /* MEMORY MAY BE IN LONG WAIT    */ 04021000
         OI    OUCBLWT(OUCBPTR),B'10000000'                        1003 04022000
*           OUXBSTC=OUXBSTC+ONE;    /* AVOID STEAL ALL PAGES @Z30WIMG*/ 04023000
         LA    @14,1                                               1004 04024000
         AH    @14,OUXBSTC(,OUXBPTR)                               1004 04025000
         STH   @14,OUXBSTC(,OUXBPTR)                               1004 04026000
*           IF OUCBTRM='1'B THEN    /* IF MEMORY IN TERMINAL @ZA30458*/ 04027000
         TM    OUCBTRM(OUCBPTR),B'01000000'                        1005 04028000
         BNO   @RF01005                                            1005 04029000
*             IF OUCBOWT='1'B THEN  /* WAIT CONTINUE TO SWAP @ZA30458*/ 04030000
         TM    OUCBOWT(OUCBPTR),B'00100000'                        1006 04031000
         BNO   @RF01006                                            1006 04032000
*               OUCBSRC=SRCDTOSC;   /* FOR TERMINAL WAIT     @ZA30458*/ 04033000
         MVI   OUCBSRC(OUCBPTR),X'01'                              1007 04034000
*             ELSE                                                 1008 04035000
*               OUCBSRC=SRCDTISC;   /*                       @ZA30458*/ 04036000
         B     @RC01006                                            1008 04037000
@RF01006 MVI   OUCBSRC(OUCBPTR),X'02'                              1008 04038000
*           ELSE                    /* NOT IN TERM WAIT      @ZA30458*/ 04039000
*             OUCBSRC=SRCDLWSC;     /* SWAP DUE TO LONG WAIT DURING     04040000
*                                      RESTORE COMPLETE      @Z40BPEB*/ 04041000
         B     @RC01005                                            1009 04042000
@RF01005 MVI   OUCBSRC(OUCBPTR),X'03'                              1009 04043000
*         END;                      /*                       @Z30WIMG*/ 04044000
*     END;                                                         1011 04045000
*   ELSE                            /* USER WILL REMAIN IN CORE      */ 04046000
*                                                                  1012 04047000
*     /***************************************************************/ 04048000
*     /*                                                             */ 04049000
*     /* RESET INDICATORS AS TO WHY USER WAS SWAPPED OUT OF CORE     */ 04050000
*     /*                                                             */ 04051000
*     /***************************************************************/ 04052000
*                                                                  1012 04053000
*     DO;                                                          1012 04054000
         B     @RC00994                                            1012 04055000
@RF00994 DS    0H                                                  1013 04056000
*       OUCBLWT='0'B;                                              1013 04057000
*       OUCBMWT='0'B;                                              1014 04058000
         NI    OUCBLWT(OUCBPTR),B'01111110'                        1014 04059000
*       OUCBCTI='0'B;                                              1015 04060000
         NI    OUCBCTI(OUCBPTR),B'10111111'                        1015 04061000
*     END;                                                         1016 04062000
*   OUCBRDYB='0'B;                  /* RESET SWAP USER               */ 04063000
@RC00994 DS    0H                                                  1018 04064000
*   OUCBRSMB='0'B;                  /* READY INDICATORS              */ 04065000
         L     @14,OUCBRSMB-2(,OUCBPTR)                            1018 04066000
@GL00044 LR    @12,@14                                             1018 04067000
         N     @12,@CF02717                                        1018 04068000
         CS    @14,@12,OUCBRSMB-2(OUCBPTR)                         1018 04069000
         BNE   @GL00044                                            1018 04070000
*   RESPECIFY                                                      1019 04071000
*    (OUXBPTR,                                                     1019 04072000
*     OUSBPTR,                                                     1019 04073000
*     RTNCOD,                                                      1019 04074000
*     RESNCODE) UNRSTD;             /*                       @ZA16887*/ 04075000
*                                                                  1019 04076000
*   /*****************************************************************/ 04077000
*   /*                                                               */ 04078000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04079000
*   /*                                                               */ 04080000
*   /*****************************************************************/ 04081000
*                                                                  1020 04082000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04083000
*                                                                  1020 04084000
         L     @14,RMEXCTL(,RMCTPTR)                               1020 04085000
         BR    @14                                                 1020 04086000
*   /*****************************************************************/ 04087000
*   /*                                                               */ 04088000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 04089000
*   /*                                                               */ 04090000
*   /*****************************************************************/ 04091000
*                                                                  1021 04092000
*   RESPECIFY                                                      1021 04093000
*    (RTNREG,                                                      1021 04094000
*     NTRREG) RSTD;                                                1021 04095000
*                                                                  1022 04096000
*/********************************************************************/ 04097000
*/*                                                                  */ 04098000
*/*      ENQHOLD -20- ENQ HOLD                                       */ 04099000
*/*                                                                  */ 04100000
*/*                                                                  */ 04101000
*/********************************************************************/ 04102000
*                                                                  1022 04103000
*IRARME20:                          /* SYSEVENT 20 - ENQHOLD         */ 04104000
*/*                                                                  */ 04105000
*/*      MARK USER HOLDING AN ENQ RESOURCE IN DEMAND BY ANOTHER      */ 04106000
*/*      USER.  CONTROL WILL SEE THIS AS AN EXPRESS SWAP IN          */ 04107000
*/*      TO GIVE THE USER A CHANCE TO FREE THE RESOURCE.  THIS       */ 04108000
*/*      WILL INSURE THAT ENQ RESOURCES OF A FEW INSTRUCTIONS        */ 04109000
*/*      DURATION WILL NEVER BE HELD BY A SWAPPED OUT USER.          */ 04110000
*/*                                                                  */ 04111000
*                                                                  1022 04112000
*   RESPECIFY                                                      1022 04113000
*    (OUXBPTR,                                                     1022 04114000
*     ENQJST1,                                                     1022 04115000
*     ENQJST2) RESTRICTED;          /*                       @Z30WIMG*/ 04116000
IRARME20 DS    0H                                                  1023 04117000
*   IF OUCBNQC=ZERO THEN            /* IF NO ENQHOLD SYSEVENTS ARE   */ 04118000
         CLI   OUCBNQC(OUCBPTR),0                                  1023 04119000
         BNE   @RF01023                                            1023 04120000
*     DO;                           /* CURRENT FOR USER,             */ 04121000
*       OUCBENQ='1'B;               /* SET ENQ FLAG ON               */ 04122000
         OI    OUCBENQ(OUCBPTR),B'00000010'                        1025 04123000
*       CCVENQCT=CCVENQCT+ONE;      /* KEEP TRACK OF NUMBER OF USERS    04124000
*                                      MARKED FOR ENQUEUE REASONS.   */ 04125000
         LA    @12,1                                               1026 04126000
         AH    @12,CCVENQCT(,RMCTPTR)                              1026 04127000
         STH   @12,CCVENQCT(,RMCTPTR)                              1026 04128000
*       IF OUCBOUT='0'B             /* IF USER IS IN MAIN STORAGE AND*/ 04129000
*           &OUCBGOO='0'B           /* NOT BEING SWAPPED,            */ 04130000
*           &OUCBGOI='0'B THEN      /*                               */ 04131000
         TM    OUCBOUT(OUCBPTR),B'11000100'                        1027 04132000
         BNZ   @RF01027                                            1027 04133000
*         DO;                                                      1028 04134000
*           GENERATE CODE REFS(ASCBEJST);                          1029 04135000
         LM    ENQJST1,ENQJST2,ASCBEJST(ASCBPTR)                        04136000
         SRDL  ENQJST1,MILLISEC                                         04137000
*           OUXBPTR=ASCBOUXB;       /* SAVE USER EXECUTION TIME VALUE*/ 04138000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1030 04139000
*           OUXBNQT=ENQJST2;        /* AT POINT SYSEVENT OCCURRED    */ 04140000
         ST    ENQJST2,OUXBNQT(,OUXBPTR)                           1031 04141000
*         END;                                                     1032 04142000
*       ELSE                        /* OTHERWISE                     */ 04143000
*         OUCBNQF='1'B;             /* INDICATE INVALID BASE TIME    */ 04144000
         B     @RC01027                                            1033 04145000
@RF01027 OI    OUCBNQF(OUCBPTR),B'00001000'                        1033 04146000
*     END;                                                         1034 04147000
*                                                                  1034 04148000
@RC01027 DS    0H                                                  1035 04149000
*   /*****************************************************************/ 04150000
*   /*                                                               */ 04151000
*   /* IF THE RESOURCE HOLDER IS IN THE MEAN TIME TO WAIT GROUP      */ 04152000
*   /* ENSURE THAT THE DISPATCHING PRIORITY IS HIGH ENOUGH TO ALLOW  */ 04153000
*   /* THE USER TO FREE THE RESOURCE.                        @ZA19283*/ 04154000
*   /*                                                               */ 04155000
*   /*****************************************************************/ 04156000
*                                                                  1035 04157000
*   IF OUCBAPG='1'B&                /* APG USER              @ZA19283*/ 04158000
*       OUCBNDP<CCCAPGDP            /* IN MEAN TIME TO WAIT  @ZA19283*/ 04159000
*     THEN                                                         1035 04160000
@RF01023 TM    OUCBAPG(OUCBPTR),B'01000000'                        1035 04161000
         BNO   @RF01035                                            1035 04162000
         LH    @12,CCCAPGDP(,RMCTPTR)                              1035 04163000
         SLR   @11,@11                                             1035 04164000
         IC    @11,OUCBNDP(,OUCBPTR)                               1035 04165000
         CR    @12,@11                                             1035 04166000
         BNH   @RF01035                                            1035 04167000
*     OUCBNDP=CCCAPGDP;             /* PUT TO TOP.           @ZA19283*/ 04168000
         STC   @12,OUCBNDP(,OUCBPTR)                               1036 04169000
*   OUCBNQC=OUCBNQC+ONE;            /* KEEP TRACK OF NO. OF ENQHOLD     04170000
*                                      SYSEVENTS OUTSTANDING FOR USER   04171000
*                                      ENTER SRM CONTROL ROUTINE     */ 04172000
*                                                                  1037 04173000
@RF01035 LA    @12,1                                               1037 04174000
         SLR   @11,@11                                             1037 04175000
         IC    @11,OUCBNQC(,OUCBPTR)                               1037 04176000
         ALR   @12,@11                                             1037 04177000
         STC   @12,OUCBNQC(,OUCBPTR)                               1037 04178000
*   /*****************************************************************/ 04179000
*   /*                                                               */ 04180000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04181000
*   /*                                                               */ 04182000
*   /*****************************************************************/ 04183000
*                                                                  1038 04184000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04185000
         L     @12,RMEXCTL(,RMCTPTR)                               1038 04186000
         BR    @12                                                 1038 04187000
*   RESPECIFY                                                      1039 04188000
*    (OUXBPTR,                                                     1039 04189000
*     ENQJST1,                                                     1039 04190000
*     ENQJST2) UNRESTRICTED;                                       1039 04191000
*                                                                  1040 04192000
*/********************************************************************/ 04193000
*/*                                                                  */ 04194000
*/*      ENQRLSE -21- ENQ RELEASE                                    */ 04195000
*/*                                                                  */ 04196000
*/********************************************************************/ 04197000
*                                                                  1040 04198000
*IRARME21:                          /* SYSEVENT 21 - ENQRLSE         */ 04199000
*/*                                                                  */ 04200000
*/*      WHEN USER FREES ALL ENQ RESOURCES THEN REMOVE SPECIAL       */ 04201000
*/*      MARKING GIVEN AT ENQHOLD TIME.                              */ 04202000
*/*                                                                  */ 04203000
*                                                                  1040 04204000
*   OUCBNQC=OUCBNQC-ONE;            /* DECREMENT ENQHOLD COUNT       */ 04205000
IRARME21 SLR   @12,@12                                             1040 04206000
         IC    @12,OUCBNQC(,OUCBPTR)                               1040 04207000
         BCTR  @12,0                                               1040 04208000
         STC   @12,OUCBNQC(,OUCBPTR)                               1040 04209000
*   IF OUCBNQC=ZERO THEN            /* IF COUNT GOES TO ZERO AND USER*/ 04210000
         CLI   OUCBNQC(OUCBPTR),0                                  1041 04211000
         BNE   @RF01041                                            1041 04212000
*     IF OUCBENQ='1'B THEN          /* IS MARKED FOR ENQUEUE         */ 04213000
         TM    OUCBENQ(OUCBPTR),B'00000010'                        1042 04214000
         BNO   @RF01042                                            1042 04215000
*       DO;                         /* REASONS:                      */ 04216000
*         OUCBENQ='0'B;             /* MAKE USER NORMAL AGAIN.       */ 04217000
         NI    OUCBENQ(OUCBPTR),B'11111101'                        1044 04218000
*         OUCBNQF='0'B;             /* RESET ENQ TIME INVALID BIT    */ 04219000
         NI    OUCBNQF(OUCBPTR),B'11110111'                        1045 04220000
*         CCVENQCT=CCVENQCT-ONE;    /* REDUCE COUNT OF ENQHOLD USERS */ 04221000
         LH    @12,CCVENQCT(,RMCTPTR)                              1046 04222000
         BCTR  @12,0                                               1046 04223000
         STH   @12,CCVENQCT(,RMCTPTR)                              1046 04224000
*       END;                        /* ENTER SRM CONTROL ROUTINE     */ 04225000
*                                                                  1047 04226000
*   /*****************************************************************/ 04227000
*   /*                                                               */ 04228000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04229000
*   /*                                                               */ 04230000
*   /*****************************************************************/ 04231000
*                                                                  1048 04232000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04233000
@RF01042 DS    0H                                                  1048 04234000
@RF01041 L     @12,RMEXCTL(,RMCTPTR)                               1048 04235000
         BR    @12                                                 1048 04236000
*                                                                  1049 04237000
*/********************************************************************/ 04238000
*/*                                                                  */ 04239000
*/*      RSMCNSTS -22- REAL STORAGE MANAGEMENT CONSTANTS             */ 04240000
*/*                                                                  */ 04241000
*/********************************************************************/ 04242000
*                                                                  1049 04243000
*IRARME22:                          /* SYSEVENT 22 - RSMCNSTS        */ 04244000
*/*                                                                  */ 04245000
*/*      THIS SYSEVENT IS NOW A NO-OP                        @Z40BPJE*/ 04246000
*/*                                                                  */ 04247000
*                                                                  1049 04248000
*   /*****************************************************************/ 04249000
*   /*                                                               */ 04250000
*   /* ? IRACTLCL EPN(I01)                                           */ 04251000
*   /*                                                               */ 04252000
*   /*****************************************************************/ 04253000
*                                                                  1049 04254000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 04255000
IRARME22 L     @12,RMEXI01(,RMCTPTR)                               1049 04256000
         BR    @12                                                 1049 04257000
*                                                                  1050 04258000
*/********************************************************************/ 04259000
*/*                                                                  */ 04260000
*/*      AVQLOW -23- AVAILABLE QUEUE BELOW LIMIT                     */ 04261000
*/*                                                                  */ 04262000
*/********************************************************************/ 04263000
*                                                                  1050 04264000
*IRARME23:                          /* SYSEVENT 23 - AVQLOW          */ 04265000
*/*                                                                  */ 04266000
*/*      INVOKE MAIN STORAGE OCCUPANCY ANALYSIS TO ALLEVIATE         */ 04267000
*/*      PAGE SHORTAGE.                                      @Z40BPJE*/ 04268000
*/*                                                                  */ 04269000
*                                                                  1050 04270000
*   /*****************************************************************/ 04271000
*   /*                                                               */ 04272000
*   /* ? IRACTLCL EPN(MS2)                                           */ 04273000
*   /*                                                               */ 04274000
*   /*****************************************************************/ 04275000
*                                                                  1050 04276000
*   DO;                                                            1050 04277000
IRARME23 DS    0H                                                  1051 04278000
*     R1=ADDR(RMEPBMS2);            /* MS2 REQUEST IS PARAM          */ 04279000
         LA    R1,RMEPBMS2(,RMCTPTR)                               1051 04280000
*     CALL RMSBCRL->IRARMRTN;       /* ALGRTHM SCH FUNCT             */ 04281000
         L     @15,RMSBCRL(,RMCTPTR)                               1052 04282000
         BALR  @14,@15                                             1052 04283000
*   END;                                                           1053 04284000
*   IF LEVEL=ONE THEN               /* IF NUMBER OF AVAILABLE PAGES  */ 04285000
         CLI   LEVEL(RRPAPTR),1                                    1054 04286000
         BNE   @RF01054                                            1054 04287000
*     MCTAVQ1='1'B;                 /* SET AVQLOW FLAG               */ 04288000
         OI    MCTAVQ1(RMCTPTR),B'00100000'                        1055 04289000
*   IF LEVEL=FOUR THEN              /* IF % OF FIXED REAL PAGES IS 1056 04290000
*                                      TOO HIGH              @Z40BPJE*/ 04291000
@RF01054 CLI   LEVEL(RRPAPTR),4                                    1056 04292000
         BNE   @RF01056                                            1056 04293000
*     MCTFAVQ='1'B;                 /* SET FIXED PAGE FLAG   @Z40BPJE   04294000
*                                      RETURN TO INTERFACE PROGRAM   */ 04295000
*                                                                  1057 04296000
         OI    MCTFAVQ(RMCTPTR),B'00010000'                        1057 04297000
*   /*****************************************************************/ 04298000
*   /*                                                               */ 04299000
*   /* ? IRACTLCL EPN(I01)                                           */ 04300000
*   /*                                                               */ 04301000
*   /*****************************************************************/ 04302000
*                                                                  1058 04303000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 04304000
@RF01056 L     @12,RMEXI01(,RMCTPTR)                               1058 04305000
         BR    @12                                                 1058 04306000
*                                                                  1059 04307000
*/********************************************************************/ 04308000
*/*                                                                  */ 04309000
*/*      AVQOK -24- AVAILABLE QUEUE ABOVE LIMIT                      */ 04310000
*/*                                                                  */ 04311000
*/********************************************************************/ 04312000
*                                                                  1059 04313000
*IRARME24:                          /* SYSEVENT 24 - AVQOK           */ 04314000
*/*                                                                  */ 04315000
*/*      RESET AVQLOW BIT AND RETURN                                 */ 04316000
*/*                                                                  */ 04317000
*                                                                  1059 04318000
*   MCTAVQ1='0'B;                   /* INDICATE SHORTAGE RELIEVED  1059 04319000
*                                      RETURN TO INTERFACE PROGRAM   */ 04320000
*                                                                  1059 04321000
IRARME24 NI    MCTAVQ1(RMCTPTR),B'11011111'                        1059 04322000
*   /*****************************************************************/ 04323000
*   /*                                                               */ 04324000
*   /* ? IRACTLCL EPN(I01)                                           */ 04325000
*   /*                                                               */ 04326000
*   /*****************************************************************/ 04327000
*                                                                  1060 04328000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 04329000
         L     @12,RMEXI01(,RMCTPTR)                               1060 04330000
         BR    @12                                                 1060 04331000
*                                                                  1061 04332000
*/********************************************************************/ 04333000
*/*                                                                  */ 04334000
*/*      SQALOW -25- AVAILABLE SYSTEM QUEUE SPACE BELOW LIMIT        */ 04335000
*/*                                                                  */ 04336000
*/********************************************************************/ 04337000
*                                                                  1061 04338000
*IRARME25:                          /* SYSEVENT 25 - SQALOW          */ 04339000
*/*                                                                  */ 04340000
*/*      SET FLAGS INDICATING SHORTAGE OF SYSTEM QUEUE SPACE         */ 04341000
*/*      INVOKE SQA MESSAGE WRITER TO INFORM OPERATOR OF SHORTAGE.   */ 04342000
*/*      MESSAGES CANNOT BE WRITTEN DIRECTLY BECAUSE THE SRM LOCK    */ 04343000
*/*      IS NOT HELD                                                 */ 04344000
*/*                                                                  */ 04345000
*                                                                  1061 04346000
*   RESPECIFY                                                      1061 04347000
*     R1 RESTRICTED;                                               1061 04348000
IRARME25 DS    0H                                                  1062 04349000
*   IF RRPAINP=ONE THEN             /* IF FIRST LEVEL SHORTAGE,      */ 04350000
         CLC   RRPAINP(4,RRPAPTR),@CF00078                         1062 04351000
         BNE   @RF01062                                            1062 04352000
*     MCTSQA1='1'B;                 /* SET FIRST LEVEL FLAG ON       */ 04353000
         OI    MCTSQA1(RMCTPTR),B'10000000'                        1063 04354000
*   ELSE                            /* OTHERWISE                     */ 04355000
*     MCTSQA2='1'B;                 /* INDICATE SECOND LEVEL SHORTAGE   04356000
*                                      INVOKE SQA MESSAGE WRITER     */ 04357000
*                                                                  1064 04358000
         B     @RC01062                                            1064 04359000
@RF01062 OI    MCTSQA2(RMCTPTR),B'01000000'                        1064 04360000
*   /*****************************************************************/ 04361000
*   /*                                                               */ 04362000
*   /* ? IRACTLCL EPN(SQA)                                           */ 04363000
*   /*                                                               */ 04364000
*   /*****************************************************************/ 04365000
*                                                                  1065 04366000
*   DO;                                                            1065 04367000
@RC01062 DS    0H                                                  1066 04368000
*     R1=ADDR(RMEPBSQA);            /* SQA REQUEST IS PARAM          */ 04369000
         LA    R1,RMEPBSQA(,RMCTPTR)                               1066 04370000
*     CALL RMSBCRL->IRARMRTN;       /* ALGRTHM SCH FUNCT             */ 04371000
         L     @15,RMSBCRL(,RMCTPTR)                               1067 04372000
         BALR  @14,@15                                             1067 04373000
*   END;                                                           1068 04374000
*   RESPECIFY                                                      1069 04375000
*     R1 UNRESTRICTED;              /* RETURN TO INTERFACE PROGRAM   */ 04376000
*                                                                  1069 04377000
*   /*****************************************************************/ 04378000
*   /*                                                               */ 04379000
*   /* ? IRACTLCL EPN(I01)                                           */ 04380000
*   /*                                                               */ 04381000
*   /*****************************************************************/ 04382000
*                                                                  1070 04383000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 04384000
         L     @12,RMEXI01(,RMCTPTR)                               1070 04385000
         BR    @12                                                 1070 04386000
*                                                                  1071 04387000
*/********************************************************************/ 04388000
*/*                                                                  */ 04389000
*/*      SQAOK -26- AVAILABLE SYSTEM QUEUE SPACE ABOVE LIMIT         */ 04390000
*/*                                                                  */ 04391000
*/********************************************************************/ 04392000
*                                                                  1071 04393000
*IRARME26:                          /* SYSEVENT 26 - SQAOK           */ 04394000
*/*                                                                  */ 04395000
*/*      RESET SQA SHORTAGE FLAGS AND INVOKE SQA MESSAGE WRITER TO   */ 04396000
*/*      INFORM OPERATOR THAT SQA SHORTAGES HAVE BEEN RELIEVED       */ 04397000
*/*                                                                  */ 04398000
*                                                                  1071 04399000
*   RESPECIFY                                                      1071 04400000
*     R1 RESTRICTED;                                               1071 04401000
IRARME26 DS    0H                                                  1072 04402000
*   IF RRPAINP=ONE THEN             /* IF ALL SHORTAGES RELIEVED     */ 04403000
         CLC   RRPAINP(4,RRPAPTR),@CF00078                         1072 04404000
         BNE   @RF01072                                            1072 04405000
*     DO;                                                          1073 04406000
*       MCTSQA1='0'B;               /* RESET FIRST LEVEL FLAG        */ 04407000
*       MCTSQA2='0'B;               /* RESET SECOND LEVEL FLAG INVOKE   04408000
*                                      SQA MESSAGE WRITER            */ 04409000
*                                                                  1075 04410000
         NI    MCTSQA1(RMCTPTR),B'00111111'                        1075 04411000
*       /*************************************************************/ 04412000
*       /*                                                           */ 04413000
*       /* ? IRACTLCL EPN(SQA)                                       */ 04414000
*       /*                                                           */ 04415000
*       /*************************************************************/ 04416000
*                                                                  1076 04417000
*       DO;                                                        1076 04418000
*         R1=ADDR(RMEPBSQA);        /* SQA REQUEST IS PARAM          */ 04419000
         LA    R1,RMEPBSQA(,RMCTPTR)                               1077 04420000
*         CALL RMSBCRL->IRARMRTN;   /* ALGRTHM SCH FUNCT             */ 04421000
         L     @15,RMSBCRL(,RMCTPTR)                               1078 04422000
         BALR  @14,@15                                             1078 04423000
*       END;                                                       1079 04424000
*     END;                                                         1080 04425000
*   ELSE                            /* OTHERWISE                     */ 04426000
*     MCTSQA2='0'B;                 /* RESET SECOND LEVEL FLAG       */ 04427000
         B     @RC01072                                            1081 04428000
@RF01072 NI    MCTSQA2(RMCTPTR),B'10111111'                        1081 04429000
*   RESPECIFY                                                      1082 04430000
*     R1 UNRESTRICTED;              /* RETURN TO INTERFACE PROGRAM   */ 04431000
*                                                                  1082 04432000
@RC01072 DS    0H                                                  1083 04433000
*   /*****************************************************************/ 04434000
*   /*                                                               */ 04435000
*   /* ? IRACTLCL EPN(I01)                                           */ 04436000
*   /*                                                               */ 04437000
*   /*****************************************************************/ 04438000
*                                                                  1083 04439000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 04440000
         L     @12,RMEXI01(,RMCTPTR)                               1083 04441000
         BR    @12                                                 1083 04442000
*                                                                  1084 04443000
*   /*****************************************************************/ 04444000
*   /*                                                               */ 04445000
*   /* IRARME28: DEVALLOC (DEVICE ALLOCATION) HAS BEEN MOVED TO THE  */ 04446000
*   /* MODULE IRARMIOM.                                      @ZA20975*/ 04447000
*   /*                                                               */ 04448000
*   /*****************************************************************/ 04449000
*                                                                  1084 04450000
*IRARME29:                          /* SYSEVENT 29 - CONFIGCH        */ 04451000
*   IF SMF22RTY=TYPE22 THEN         /* SMF RECORD TYPE IS 22         */ 04452000
IRARME29 L     @12,SMF22PTR(,RRPAPTR)                              1084 04453000
         CLI   SMF22RTY(@12),22                                    1084 04454000
         BNE   @RF01084                                            1084 04455000
*     DO;                                                          1085 04456000
*                                                                  1085 04457000
*       /*************************************************************/ 04458000
*       /*                                                           */ 04459000
*       /* ADJUST SRM CONTROL BLOCKS TO REFLECT THE CHANGE IN THE    */ 04460000
*       /* NUMBER OF ON-LINE CPUS.                                   */ 04461000
*       /*                                                           */ 04462000
*       /*************************************************************/ 04463000
*                                                                  1086 04464000
*       CCVCPUCT=CSDCPUOL;          /* NO. OF ON-LINE CPUS           */ 04465000
*                                                                  1086 04466000
         L     @12,CVTPTR                                          1086 04467000
         L     @12,CVTCSD(,@12)                                    1086 04468000
         LH    @12,CSDCPUOL(,@12)                                  1086 04469000
         STH   @12,CCVCPUCT(,RMCTPTR)                              1086 04470000
*       /*************************************************************/ 04471000
*       /*                                                           */ 04472000
*       /* ADJUST LOGICAL CHANNEL UTILIZATION IMBALANCE THRESHOLDS   */ 04473000
*       /* BASED ON THE NUMBER OF CPUS STILL ON-LINE.                */ 04474000
*       /*                                                           */ 04475000
*       /*************************************************************/ 04476000
*                                                                  1087 04477000
*       ICCHIUTH=ICCINHIT(CCVCPUCT);/* HIGH IMBALANCE THRESHOLD      */ 04478000
         ALR   @12,@12                                             1087 04479000
         LH    @11,ICCINHIT-2(@12,RMCTPTR)                         1087 04480000
         STH   @11,ICCHIUTH(,RMCTPTR)                              1087 04481000
*       ICCLOUTH=ICCINLOT(CCVCPUCT);/* LOW IMBALANCE THRESHOLD       */ 04482000
         LH    @11,ICCINLOT-2(@12,RMCTPTR)                         1088 04483000
         STH   @11,ICCLOUTH(,RMCTPTR)                              1088 04484000
*       ICCDAUTH=ICCINDAT(CCVCPUCT);/* DEVICE ALLOCATION THRESHOLD   */ 04485000
         LH    @12,ICCINDAT-2(@12,RMCTPTR)                         1089 04486000
         STH   @12,ICCDAUTH(,RMCTPTR)                              1089 04487000
*     END;                                                         1090 04488000
*                                                                  1090 04489000
*   /*****************************************************************/ 04490000
*   /*                                                               */ 04491000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04492000
*   /*                                                               */ 04493000
*   /*****************************************************************/ 04494000
*                                                                  1091 04495000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04496000
*                                                                  1091 04497000
@RF01084 L     @12,RMEXCTL(,RMCTPTR)                               1091 04498000
         BR    @12                                                 1091 04499000
*   /*****************************************************************/ 04500000
*   /*                                                               */ 04501000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 04502000
*   /*                                                               */ 04503000
*   /*****************************************************************/ 04504000
*                                                                  1092 04505000
*IRARME30:                          /* SYSEVENT 30 - VERIFYPG        */ 04506000
*/*                                                                  */ 04507000
*/*   THE PERFORMANCE GROUP NUMBER(PGN) IS VERIFIED BY USING IT AS   */ 04508000
*/*   AN INDEX INTO THE WORKLOAD MANAGER PERFORMANCE GROUP VECTOR    */ 04509000
*/*   TABLE(WPGVT), AN ARRAY OF 2 BYTE ELEMENTS.  EACH ELEMENT       */ 04510000
*/*   REPRESENTS AN OFFSET TO ONE OF THE PERFORMANCE GROUP DESCRIP-  */ 04511000
*/*   TIONS THAT CAN BE DEFINED WITHIN AN IPS.  THOSE PERFORMANCE    */ 04512000
*/*   GROUPS THAT ARE UNDEFINED WITHIN AN IPS HAVE A ZERO(0) OFFSET. */ 04513000
*/*   IF THE INDEXED ELEMENT IS NON-ZERO, THEN THE PGN IS KNOWN TO   */ 04514000
*/*   THE SYSTEM RESOURCES MANAGER.  OTHERWISE, A DEFAULT PGN WILL   */ 04515000
*/*   BE RETURNED FOR LOGONS. OTHER MEMORIES HAVE THEIR PGN  @ZA17805*/ 04516000
*/*   VERIFIED AT INITATT TIME.                              @ZA17805*/ 04517000
*/*                                                                  */ 04518000
*                                                                  1092 04519000
*   RRPARI2=OK;                     /* PGN VALID IN IPS              */ 04520000
IRARME30 MVI   RRPARI2(RRPAPTR),X'00'                              1092 04521000
*   RESPECIFY                                                      1093 04522000
*     WPGVTENT BASED(WMSTPGVT+TWO*RRPAPGN);                        1093 04523000
*   IF OUCBLOG='1'B THEN            /* MEMORY ORIGINATED VIA LOGON   */ 04524000
         TM    OUCBLOG(OUCBPTR),B'00100000'                        1094 04525000
         BNO   @RF01094                                            1094 04526000
*     IF(RRPAPGN=ZERO|              /* IF PGN INVALID OR             */ 04527000
*         RRPAPGN>WMSTPGHI|WPGVTENT=ZERO) THEN/* PGN UNDEFINED IN  1095 04528000
*                                      IPS,                          */ 04529000
*                                                                  1095 04530000
         CLI   RRPAPGN(RRPAPTR),0                                  1095 04531000
         BE    @RT01095                                            1095 04532000
         SLR   @12,@12                                             1095 04533000
         IC    @12,RRPAPGN(,RRPAPTR)                               1095 04534000
         L     @11,WMSTPTR(,RMCTPTR)                               1095 04535000
         CH    @12,WMSTPGHI(,@11)                                  1095 04536000
         BH    @RT01095                                            1095 04537000
         ALR   @12,@12                                             1095 04538000
         AL    @12,WMSTPGVT(,@11)                                  1095 04539000
         LH    @12,WPGVTENT(,@12)                                  1095 04540000
         LTR   @12,@12                                             1095 04541000
         BNZ   @RF01095                                            1095 04542000
@RT01095 DS    0H                                                  1096 04543000
*       /*************************************************************/ 04544000
*       /*                                                           */ 04545000
*       /* DETERMINE THE DEFAULT PGN FOR THIS TSO USER               */ 04546000
*       /*                                                           */ 04547000
*       /*************************************************************/ 04548000
*                                                                  1096 04549000
*       RRPADEF=RMCALGPG;           /* DEFAULT PGN FOR TSO USER    1096 04550000
*                                                            @Z40BPJE*/ 04551000
         IC    @12,RMCALGPG(,RMCTPTR)                              1096 04552000
         STC   @12,RRPADEF(,RRPAPTR)                               1096 04553000
*     ELSE                                                         1097 04554000
*       ;                           /* PGN IS OK AS IS       @ZA17805*/ 04555000
@RF01095 DS    0H                                                  1098 04556000
*   ELSE                            /* MEMORY ORIGINATED VIA START OR   04557000
*                                      MOUNT COMMAND                 */ 04558000
*     IF RRPAPGN=ZERO THEN          /* AND NO PGN SPECIFIED  @ZA17805*/ 04559000
         B     @RC01094                                            1098 04560000
@RF01094 CLI   RRPAPGN(RRPAPTR),0                                  1098 04561000
         BNE   @RF01098                                            1098 04562000
*       RRPADEF=RMCABCPG;           /* DEFAULT PGN FOR ALL OTHER USER   04563000
*                                                            @Z40BPJE*/ 04564000
         IC    @12,RMCABCPG(,RMCTPTR)                              1099 04565000
         STC   @12,RRPADEF(,RRPAPTR)                               1099 04566000
*   RFY                                                            1100 04567000
*     WPGVTENT BASED(WMSTPGVT+TWO*OUCBNPG);/*                @Z40BPEB*/ 04568000
*                                                                  1100 04569000
@RF01098 DS    0H                                                  1100 04570000
@RC01094 DS    0H                                                  1101 04571000
*   /*****************************************************************/ 04572000
*   /*                                                               */ 04573000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04574000
*   /*                                                               */ 04575000
*   /*****************************************************************/ 04576000
*                                                                  1101 04577000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04578000
*                                                                  1101 04579000
         L     @12,RMEXCTL(,RMCTPTR)                               1101 04580000
         BR    @12                                                 1101 04581000
*   /*****************************************************************/ 04582000
*   /*                                                               */ 04583000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 04584000
*   /*                                                               */ 04585000
*   /*****************************************************************/ 04586000
*                                                                  1102 04587000
*IRARME31:                          /* SYSEVENT 31 - RESETPG         */ 04588000
*   IF ASCBOUCB^=ZERO&              /* IF OUCB PTR IN ASCB NON-ZERO  */ 04589000
*       OUCBINV='0'B&               /* AND VALID BLOCK INDICATOR SET    04590000
*                                                            @Z40BPCH*/ 04591000
*       ASCBPTR=OUCBASCB THEN       /* AND ASCB PTR IN OUCB VALID,   */ 04592000
IRARME31 SLR   @12,@12                                             1102 04593000
         C     @12,ASCBOUCB(,ASCBPTR)                              1102 04594000
         BE    @RF01102                                            1102 04595000
         TM    OUCBINV(OUCBPTR),B'00010000'                        1102 04596000
         BNZ   @RF01102                                            1102 04597000
         C     ASCBPTR,OUCBASCB(,OUCBPTR)                          1102 04598000
         BNE   @RF01102                                            1102 04599000
*     DO;                           /* DETERMINE VALIDITY OF RESET PG*/ 04600000
*       RESPECIFY                                                  1104 04601000
*         WPGVTENT BASED(WMSTPGVT+TWO*RRPAPGN);                    1104 04602000
*       IF(RRPAPGN^=ZERO&           /* IF PGN VALID                  */ 04603000
*           RRPAPGN<=WMSTPGHI&      /* AND PGN DEFINED               */ 04604000
*           WPGVTENT^=ZERO) THEN    /* IN IPS,                       */ 04605000
         CLI   RRPAPGN(RRPAPTR),0                                  1105 04606000
         BE    @RF01105                                            1105 04607000
         SLR   @11,@11                                             1105 04608000
         IC    @11,RRPAPGN(,RRPAPTR)                               1105 04609000
         L     @10,WMSTPTR(,RMCTPTR)                               1105 04610000
         CH    @11,WMSTPGHI(,@10)                                  1105 04611000
         BH    @RF01105                                            1105 04612000
         LR    @07,@11                                             1105 04613000
         ALR   @07,@07                                             1105 04614000
         AL    @07,WMSTPGVT(,@10)                                  1105 04615000
         CH    @12,WPGVTENT(,@07)                                  1105 04616000
         BE    @RF01105                                            1105 04617000
*         DO;                                                      1106 04618000
*           OUCBRPG=RRPAPGN;        /* ESTABLISH RESET PG VALUE      */ 04619000
         STC   @11,OUCBRPG(,OUCBPTR)                               1107 04620000
*           IF OUCBPVL='0'B THEN    /* IF CURRENT PGN NOT ZERO,      */ 04621000
         TM    OUCBPVL(OUCBPTR),B'00000100'                        1108 04622000
         BNZ   @RF01108                                            1108 04623000
*             OUCBNPG=RRPAPGN;      /* STORE NEW PERF. GROUP FOR NEXT   04624000
*                                      TRANSACTION           @Z40BPEB*/ 04625000
*                                                                  1109 04626000
         STC   @11,OUCBNPG(,OUCBPTR)                               1109 04627000
*           /*********************************************************/ 04628000
*           /*                                                       */ 04629000
*           /* ? IRACTLCL EPN(WMN)                                   */ 04630000
*           /*                                                       */ 04631000
*           /*********************************************************/ 04632000
*                                                                  1110 04633000
*           CALL RMSBWMN->IRARMRTN; /* INVOKE WMN SUBRTN             */ 04634000
*                                                                  1110 04635000
@RF01108 L     @15,RMSBWMN(,RMCTPTR)                               1110 04636000
         BALR  @14,@15                                             1110 04637000
*           /*********************************************************/ 04638000
*           /*                                                       */ 04639000
*           /* START NEW TRANSACTION                                 */ 04640000
*           /*                                                       */ 04641000
*           /*********************************************************/ 04642000
*                                                                  1111 04643000
*           OUCBPGP=WPGPOFST;       /* FIRST PERIOD OFFSET   @Z40BPEB*/ 04644000
         LA    @12,12                                              1111 04645000
         STC   @12,OUCBPGP(,OUCBPTR)                               1111 04646000
*           RFY                                                    1112 04647000
*             WPGVTENT BASED(WMSTPGVT+TWO*OUCBNPG);/*        @ZA28473*/ 04648000
*           WPGPPTR=WMSTPGDT+WPGVTENT+/* RESOLVE ADDRESSING TO     1113 04649000
*                                                            @Z40BPJE*/ 04650000
*               OUCBPGP;            /* THE CORRECT PGP       @Z40BPJE*/ 04651000
         L     @10,WMSTPTR(,RMCTPTR)                               1113 04652000
         SLR   @07,@07                                             1113 04653000
         IC    @07,OUCBNPG(,OUCBPTR)                               1113 04654000
         ALR   @07,@07                                             1113 04655000
         AL    @07,WMSTPGVT(,@10)                                  1113 04656000
         LH    WPGPPTR,WPGVTENT(,@07)                              1113 04657000
         AL    WPGPPTR,WMSTPGDT(,@10)                              1113 04658000
         ALR   WPGPPTR,@12                                         1113 04659000
*           OUCBDMN=WPGPDMN;        /* INITIALIZE THE DOMAIN NUMBER     04660000
*                                                            @Z40BPJE*/ 04661000
         SLR   @12,@12                                             1114 04662000
         IC    @12,WPGPDMN(,WPGPPTR)                               1114 04663000
         STC   @12,OUCBDMN(,OUCBPTR)                               1114 04664000
*           OUCBDMO=WDMVTENT;       /* AND DOMAIN OFFSET     @Z40BPJE*/ 04665000
         ALR   @12,@12                                             1115 04666000
         AL    @12,WMSTDMVT(,@10)                                  1115 04667000
         LH    @12,WDMVTENT(,@12)                                  1115 04668000
         STH   @12,OUCBDMO(,OUCBPTR)                               1115 04669000
*           RFY                                                    1116 04670000
*             DMDTPTR2 RSTD;        /* HOLD IT...            @ZA11854*/ 04671000
*           RFY                                                    1117 04672000
*             DMDT BASED(DMDTPTR2); /*                       @ZA11854*/ 04673000
*           DMDTPTR2=RMCTDMDT+OUCBDMO;/* PTR TO DMDT ENTRY   @ZA11854*/ 04674000
         AL    @12,RMCTDMDT(,RMCTPTR)                              1118 04675000
         LR    DMDTPTR2,@12                                        1118 04676000
*           IF OUCBINC='0'B THEN    /* BETWEEN JOB STEPS?    @ZA11854*/ 04677000
         TM    OUCBINC(OUCBPTR),B'00000001'                        1119 04678000
         BNZ   @RF01119                                            1119 04679000
*             DO;                   /* YES                   @ZA11854*/ 04680000
*               DO WHILE(DMDTHI=ZERO&/* MAX MPL = 0 ??       @ZA11854*/ 04681000
*                     WPGPFIN^='1'B);/* AND NOT LAST PERIOD  @ZA11854*/ 04682000
         B     @DE01121                                            1121 04683000
@DL01121 DS    0H                                                  1122 04684000
*                 OUCBPGP=OUCBPGP+LENGTH(WPGP);/* GO TO NEXT PERIOD     04685000
*                                                            @ZA11854*/ 04686000
         LA    @12,8                                               1122 04687000
         SLR   @07,@07                                             1122 04688000
         IC    @07,OUCBPGP(,OUCBPTR)                               1122 04689000
         ALR   @12,@07                                             1122 04690000
         STC   @12,OUCBPGP(,OUCBPTR)                               1122 04691000
*                 WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* PTR TO PERIOD    04692000
*                                                            @ZA11854*/ 04693000
         L     @07,WMSTPTR(,RMCTPTR)                               1123 04694000
         SLR   @06,@06                                             1123 04695000
         IC    @06,OUCBNPG(,OUCBPTR)                               1123 04696000
         ALR   @06,@06                                             1123 04697000
         AL    @06,WMSTPGVT(,@07)                                  1123 04698000
         LH    WPGPPTR,WPGVTENT(,@06)                              1123 04699000
         AL    WPGPPTR,WMSTPGDT(,@07)                              1123 04700000
         ALR   WPGPPTR,@12                                         1123 04701000
*                 OUCBDMN=WPGPDMN;  /* UPDATE DMN NUMBER     @ZA11854*/ 04702000
         SLR   @12,@12                                             1124 04703000
         IC    @12,WPGPDMN(,WPGPPTR)                               1124 04704000
         STC   @12,OUCBDMN(,OUCBPTR)                               1124 04705000
*                 OUCBDMO=WDMVTENT; /* AND DMN OFFSET        @ZA11854*/ 04706000
         ALR   @12,@12                                             1125 04707000
         AL    @12,WMSTDMVT(,@07)                                  1125 04708000
         LH    @12,WDMVTENT(,@12)                                  1125 04709000
         STH   @12,OUCBDMO(,OUCBPTR)                               1125 04710000
*                 DMDTPTR2=RMCTDMDT+OUCBDMO;/* PTR TO NEW DMDT ENTRY    04711000
*                                                            @ZA11854*/ 04712000
         AL    @12,RMCTDMDT(,RMCTPTR)                              1126 04713000
         LR    DMDTPTR2,@12                                        1126 04714000
*               END;                /*                       @ZA11854*/ 04715000
@DE01121 CLI   DMDTHI(DMDTPTR2),0                                  1127 04716000
         BNE   @DC01121                                            1127 04717000
         TM    WPGPFIN(WPGPPTR),B'10000000'                        1127 04718000
         BNO   @DL01121                                            1127 04719000
@DC01121 DS    0H                                                  1128 04720000
*             END;                  /*                       @ZA11854*/ 04721000
*           RFY                                                    1129 04722000
*             DMDT BASED(DMDTPTR);  /*                       @ZA11854*/ 04723000
@RF01119 DS    0H                                                  1130 04724000
*           RFY                                                    1130 04725000
*             DMDTPTR2 UNRSTD;      /* NOW LET IT GO...      @ZA11854*/ 04726000
*           IF OUCBAPG='1'B THEN    /* AN APG USER?          @ZA11390*/ 04727000
         TM    OUCBAPG(OUCBPTR),B'01000000'                        1131 04728000
         BNO   @RF01131                                            1131 04729000
*             IF WPGPAPG='1'B       /* NEW PERIOD SPECIFY    @ZA11390*/ 04730000
*               THEN                /* AN APG VLAUE ?        @ZA11390*/ 04731000
         TM    WPGPAPG(WPGPPTR),B'00100000'                        1132 04732000
         BNO   @RF01132                                            1132 04733000
*               OUCBNDP=CCCAPMDP+WPGPAPGV;/* ASSIGN REQUESTED DP   1133 04734000
*                                                            @ZA11390*/ 04735000
         SLR   @12,@12                                             1133 04736000
         IC    @12,WPGPAPGV(,WPGPPTR)                              1133 04737000
         AH    @12,CCCAPMDP(,RMCTPTR)                              1133 04738000
         STC   @12,OUCBNDP(,OUCBPTR)                               1133 04739000
*             ELSE                  /* NO APG VALUE CODED    @ZA11390*/ 04740000
*               OUCBNDP=CCCAPGDP;   /* ASSIGN DEFAULT DP     @ZA11390*/ 04741000
         B     @RC01132                                            1134 04742000
@RF01132 LH    @12,CCCAPGDP(,RMCTPTR)                              1134 04743000
         STC   @12,OUCBNDP(,OUCBPTR)                               1134 04744000
*           RRPARI2=OK;             /* RESET PGN REQUEST HONORED     */ 04745000
@RC01132 DS    0H                                                  1135 04746000
@RF01131 MVI   RRPARI2(RRPAPTR),X'00'                              1135 04747000
*         END;                                                     1136 04748000
*       ELSE                        /* RESET PGN IS INVALID IN IPS   */ 04749000
*         RRPARI2=UNKNWPGN;         /* PGN UNDEFINED IN IPS          */ 04750000
         B     @RC01105                                            1137 04751000
@RF01105 MVI   RRPARI2(RRPAPTR),X'04'                              1137 04752000
*     END;                                                         1138 04753000
*   ELSE                            /* INVALID SRM CONTROL BLOCKS    */ 04754000
*     RRPARI2=NULLBLKS;             /* RESET PGN COMMAND IGNORED     */ 04755000
*                                                                  1139 04756000
         B     @RC01102                                            1139 04757000
@RF01102 MVI   RRPARI2(RRPAPTR),X'08'                              1139 04758000
*   /*****************************************************************/ 04759000
*   /*                                                               */ 04760000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04761000
*   /*                                                               */ 04762000
*   /*****************************************************************/ 04763000
*                                                                  1140 04764000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04765000
*                                                                  1140 04766000
@RC01102 L     @12,RMEXCTL(,RMCTPTR)                               1140 04767000
         BR    @12                                                 1140 04768000
*   /*****************************************************************/ 04769000
*   /*                                                               */ 04770000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 04771000
*   /*                                                               */ 04772000
*   /*****************************************************************/ 04773000
*                                                                  1141 04774000
*IRARME32:                          /* SYSEVENT 32 - NEWIPS          */ 04775000
*   WMSTSTCB=PSATOLD;               /* TCB ADDRESS OF SET COMMAND IPS   04776000
*                                      KEYWORD PROCESSOR FOR RECOVERY*/ 04777000
IRARME32 L     @12,WMSTPTR(,RMCTPTR)                               1141 04778000
         L     @11,PSATOLD                                         1141 04779000
         ST    @11,WMSTSTCB(,@12)                                  1141 04780000
*   WMSTNWST=RRPAINP;               /* ADDRESS OF NEW WORKLOAD MANAG-   04781000
*                                      ER SPECIFICATION TABLE(WMST)  */ 04782000
         L     @11,RRPAINP(,RRPAPTR)                               1142 04783000
         ST    @11,WMSTNWST(,@12)                                  1142 04784000
*/*                                                                  */ 04785000
*/*   SET UP ENTRY POINT ADDRESS IN RMSB VECTOR TABLE OF IRARMSET    */ 04786000
*/*   WHICH IS LOADED AND FIXED IN STORAGE BY THE SET COMMAND IPS    */ 04787000
*/*   KEYWORD PROCESSOR.                                             */ 04788000
*/*                                                                  */ 04789000
*                                                                  1143 04790000
*   RMSBSET=RRPAINP->WMSTSET;                                      1143 04791000
         L     @11,WMSTSET(,@11)                                   1143 04792000
         ST    @11,RMSBSET(,RMCTPTR)                               1143 04793000
*   RMCTWAST=ZERO;                  /* CLEAR INDICATOR               */ 04794000
         SLR   @11,@11                                             1144 04795000
         ST    @11,RMCTWAST(,RMCTPTR)                              1144 04796000
*   WMSTSECB=ZERO;                  /* CLEAR ECB BEFORE XMPOST       */ 04797000
         ST    @11,WMSTSECB(,@12)                                  1145 04798000
*/*                                                                  */ 04799000
*/*   REQUEST INVOCATION OF THE SET TO NEW IPS PROCESSOR ROUTINE TO  */ 04800000
*/*   SWITCH THE SRM TO THE NEW IPS.  THIS ROUTINE IS PLACED ON THE  */ 04801000
*/*   ACTION QUEUE TO RECEIVE CONTROL ONLY AFTER SERIALIZATION       */ 04802000
*/*   AGAINST OTHER SRM PROCESSING HAS BEEN ACCOMPLISHED.  CONTROL   */ 04803000
*/*   IS RETURNED TO THE ISSUER PRIOR TO THE EXECUTION OF THE RE-    */ 04804000
*/*   QUESTED ROUTINE.                                               */ 04805000
*/*                                                                  */ 04806000
*                                                                  1146 04807000
*   /*****************************************************************/ 04808000
*   /*                                                               */ 04809000
*   /* ? IRACTLCL EPN(IPS)                                           */ 04810000
*   /*                                                               */ 04811000
*   /*****************************************************************/ 04812000
*                                                                  1146 04813000
*   DO;                                                            1146 04814000
*     R1=ADDR(RMEPBIPS);            /* IPS REQUEST IS PARAM          */ 04815000
         LA    R1,RMEPBIPS(,RMCTPTR)                               1147 04816000
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */ 04817000
         L     @15,RMSBCRN(,RMCTPTR)                               1148 04818000
         BALR  @14,@15                                             1148 04819000
*   END;                                                           1149 04820000
*   IF RMCTWAST=ZERO THEN           /* IF IPS HAS NOT BEEN CHANGED,  */ 04821000
         L     @12,RMCTWAST(,RMCTPTR)                              1150 04822000
         LTR   @12,@12                                             1150 04823000
         BNZ   @RF01150                                            1150 04824000
*     RRPAINP=RMCTWMST;             /* ADDRESS OF WMST TO FREE       */ 04825000
         L     @12,RMCTWMST(,RMCTPTR)                              1151 04826000
         ST    @12,RRPAINP(,RRPAPTR)                               1151 04827000
*   ELSE                            /* IPS HAS BEEN CHANGED          */ 04828000
*     RRPAINP=RMCTWAST;             /* ADDRESS OF WMST TO FREE       */ 04829000
*                                                                  1152 04830000
         B     @RC01150                                            1152 04831000
@RF01150 L     @12,RMCTWAST(,RMCTPTR)                              1152 04832000
         ST    @12,RRPAINP(,RRPAPTR)                               1152 04833000
*   /*****************************************************************/ 04834000
*   /*                                                               */ 04835000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04836000
*   /*                                                               */ 04837000
*   /*****************************************************************/ 04838000
*                                                                  1153 04839000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04840000
*                                                                  1153 04841000
@RC01150 L     @12,RMEXCTL(,RMCTPTR)                               1153 04842000
         BR    @12                                                 1153 04843000
*   /*****************************************************************/ 04844000
*   /*                                                               */ 04845000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 04846000
*   /*                                                               */ 04847000
*   /*****************************************************************/ 04848000
*                                                                  1154 04849000
*IRARME33:                          /* SYSEVENT 33 - ALTCPREC        */ 04850000
*/*                                                                  */ 04851000
*/*   ADJUST SRM CONTROL BLOCKS TO REFLECT THE DECREASE IN THE       */ 04852000
*/*   NUMBER OF ON-LINE CPUS.                                        */ 04853000
*/*                                                                  */ 04854000
*                                                                  1154 04855000
*   CCVCPUCT=CSDCPUOL;              /* NUMBER OF ONLINE CPUS         */ 04856000
IRARME33 L     @12,CVTPTR                                          1154 04857000
         L     @12,CVTCSD(,@12)                                    1154 04858000
         LH    @12,CSDCPUOL(,@12)                                  1154 04859000
         STH   @12,CCVCPUCT(,RMCTPTR)                              1154 04860000
*/*                                                                  */ 04861000
*/*   ADJUST LOGICAL CHANNEL UTILIZATION IMBALANCE THRESHOLDS        */ 04862000
*/*   BASED ON THE NUMBER OF CPUS STILL ON-LINE.                     */ 04863000
*/*                                                                  */ 04864000
*                                                                  1155 04865000
*   ICCHIUTH=ICCINHIT(CCVCPUCT);    /* HIGH IMBALANCE THRESHOLD      */ 04866000
         ALR   @12,@12                                             1155 04867000
         LH    @11,ICCINHIT-2(@12,RMCTPTR)                         1155 04868000
         STH   @11,ICCHIUTH(,RMCTPTR)                              1155 04869000
*   ICCLOUTH=ICCINLOT(CCVCPUCT);    /* LOW IMBALANCE THRESHOLD       */ 04870000
         LH    @11,ICCINLOT-2(@12,RMCTPTR)                         1156 04871000
         STH   @11,ICCLOUTH(,RMCTPTR)                              1156 04872000
*   ICCDAUTH=ICCINDAT(CCVCPUCT);    /* DEVICE ALLOCATION THRESHOLD   */ 04873000
*                                                                  1157 04874000
         LH    @12,ICCINDAT-2(@12,RMCTPTR)                         1157 04875000
         STH   @12,ICCDAUTH(,RMCTPTR)                              1157 04876000
*   /*****************************************************************/ 04877000
*   /*                                                               */ 04878000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04879000
*   /*                                                               */ 04880000
*   /*****************************************************************/ 04881000
*                                                                  1158 04882000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04883000
*                                                                  1158 04884000
         L     @12,RMEXCTL(,RMCTPTR)                               1158 04885000
         BR    @12                                                 1158 04886000
*   /*****************************************************************/ 04887000
*   /*                                                               */ 04888000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 04889000
*   /*                                                               */ 04890000
*   /*****************************************************************/ 04891000
*                                                                  1159 04892000
*IRARME34:                          /* SYSEVENT 34 - TGETTPUT        */ 04893000
*   IF RRPAGTPT='0'B THEN           /* TGET SATISFIED                */ 04894000
IRARME34 TM    RRPAGTPT(RRPAPTR),B'10000000'                       1159 04895000
         BNZ   @RF01159                                            1159 04896000
*     DO;                                                          1160 04897000
*       IF OUCBCIM='0'B THEN        /* NO COMPOSITE INPUT MESSAGE    */ 04898000
         TM    OUCBCIM(OUCBPTR),B'00010000'                        1161 04899000
         BNZ   @RF01161                                            1161 04900000
*         DO;                                                      1162 04901000
*           IF RRPATRAN='1'B THEN   /* MESSAGE TRANSFER INCOMPLETE   */ 04902000
         TM    RRPATRAN(RRPAPTR),B'01000000'                       1163 04903000
         BNO   @RF01163                                            1163 04904000
*             OUCBCIM='1'B;         /* NEXT TGET IS PART OF CURRENT  */ 04905000
         OI    OUCBCIM(OUCBPTR),B'00010000'                        1164 04906000
*           IF OUCBNSW='0'B&        /* NONSWAPPABLE KEEPS OLD XACTN. */ 04907000
*               OUCBTRM='0'B THEN   /* NEW COMMAND BUFFER AVAILABLE  */ 04908000
@RF01163 TM    OUCBNSW(OUCBPTR),B'10000000'                        1165 04909000
         BNZ   @RF01165                                            1165 04910000
         TM    OUCBTRM(OUCBPTR),B'01000000'                        1165 04911000
         BNZ   @RF01165                                            1165 04912000
*             DO;                   /* WITHOUT WAIT                  */ 04913000
*                                                                  1166 04914000
*               /*****************************************************/ 04915000
*               /*                                                   */ 04916000
*               /* ? IRACTLCL EPN(WMN)                               */ 04917000
*               /*                                                   */ 04918000
*               /*****************************************************/ 04919000
*                                                                  1167 04920000
*               CALL RMSBWMN->IRARMRTN;/* INVOKE WMN SUBRTN          */ 04921000
         L     @15,RMSBWMN(,RMCTPTR)                               1167 04922000
         BALR  @14,@15                                             1167 04923000
*/*   START A NEW TRANSACTION                                        */ 04924000
*                                                                  1168 04925000
*               OUCBPGP=WPGPOFST;   /* FIRST PERIOD OFFSET   @Z40BPEB*/ 04926000
         LA    @12,12                                              1168 04927000
         STC   @12,OUCBPGP(,OUCBPTR)                               1168 04928000
*               WPGPPTR=WMSTPGDT+WPGVTENT+/* RESOLVE ADDRESSING TO 1169 04929000
*                                                            @Z40BPJE*/ 04930000
*                   OUCBPGP;        /* THE CORRECT PGP       @Z40BPJE*/ 04931000
         L     @10,WMSTPTR(,RMCTPTR)                               1169 04932000
         SLR   @07,@07                                             1169 04933000
         IC    @07,OUCBNPG(,OUCBPTR)                               1169 04934000
         ALR   @07,@07                                             1169 04935000
         AL    @07,WMSTPGVT(,@10)                                  1169 04936000
         LH    WPGPPTR,WPGVTENT(,@07)                              1169 04937000
         AL    WPGPPTR,WMSTPGDT(,@10)                              1169 04938000
         ALR   WPGPPTR,@12                                         1169 04939000
*               OUCBDMN=WPGPDMN;    /* INITIALIZE THE DOMAIN NUMBER     04940000
*                                                            @Z40BPJE*/ 04941000
         SLR   @12,@12                                             1170 04942000
         IC    @12,WPGPDMN(,WPGPPTR)                               1170 04943000
         STC   @12,OUCBDMN(,OUCBPTR)                               1170 04944000
*               OUCBDMO=WDMVTENT;   /* AND DOMAIN OFFSET     @Z40BPJE*/ 04945000
         ALR   @12,@12                                             1171 04946000
         AL    @12,WMSTDMVT(,@10)                                  1171 04947000
         LH    @12,WDMVTENT(,@12)                                  1171 04948000
         STH   @12,OUCBDMO(,OUCBPTR)                               1171 04949000
*               IF OUCBAPG='1'B THEN/* AN APG USER?          @ZA11390*/ 04950000
         TM    OUCBAPG(OUCBPTR),B'01000000'                        1172 04951000
         BNO   @RF01172                                            1172 04952000
*                 IF WPGPAPG='1'B   /* NEW PERIOD SPECIFY    @ZA11390*/ 04953000
*                   THEN            /* AN APG VLAUE ?        @ZA11390*/ 04954000
         TM    WPGPAPG(WPGPPTR),B'00100000'                        1173 04955000
         BNO   @RF01173                                            1173 04956000
*                   OUCBNDP=CCCAPMDP+WPGPAPGV;/* ASSIGN REQUESTED DP    04957000
*                                                            @ZA11390*/ 04958000
         SLR   @12,@12                                             1174 04959000
         IC    @12,WPGPAPGV(,WPGPPTR)                              1174 04960000
         AH    @12,CCCAPMDP(,RMCTPTR)                              1174 04961000
         STC   @12,OUCBNDP(,OUCBPTR)                               1174 04962000
*                 ELSE              /* NO APG VALUE CODED    @ZA11390*/ 04963000
*                   OUCBNDP=CCCAPGDP;/* ASSIGN DEFAULT DP    @ZA11390*/ 04964000
         B     @RC01173                                            1175 04965000
@RF01173 LH    @12,CCCAPGDP(,RMCTPTR)                              1175 04966000
         STC   @12,OUCBNDP(,OUCBPTR)                               1175 04967000
*             END;                  /* XACTN IS STARTED      @Z40BPEB*/ 04968000
*         END;                                                     1177 04969000
*       ELSE                        /* COMPOSITE INPUT MESSAGE       */ 04970000
*         DO;                                                      1178 04971000
         B     @RC01161                                            1178 04972000
@RF01161 DS    0H                                                  1179 04973000
*           IF RRPATRAN='0'B THEN   /* MESSAGE TRANSFER COMPLETE     */ 04974000
         TM    RRPATRAN(RRPAPTR),B'01000000'                       1179 04975000
         BNZ   @RF01179                                            1179 04976000
*             OUCBCIM='0'B;                                        1180 04977000
         NI    OUCBCIM(OUCBPTR),B'11101111'                        1180 04978000
*         END;                                                     1181 04979000
@RF01179 DS    0H                                                  1182 04980000
*     END;                                                         1182 04981000
*                                                                  1182 04982000
@RC01161 DS    0H                                                  1183 04983000
*/*                                                                  */ 04984000
*/*   RESET TERMINAL WAIT FLAGS.                                     */ 04985000
*/*                                                                  */ 04986000
*                                                                  1183 04987000
*   OUCBTRM='0'B;                                                  1183 04988000
@RF01159 DS    0H                                                  1184 04989000
*   OUCBOWT='0'B;                                                  1184 04990000
*                                                                  1184 04991000
         NI    OUCBTRM(OUCBPTR),B'10011111'                        1184 04992000
*   /*****************************************************************/ 04993000
*   /*                                                               */ 04994000
*   /* ? IRACTLCL EPN(CTL)                                           */ 04995000
*   /*                                                               */ 04996000
*   /*****************************************************************/ 04997000
*                                                                  1185 04998000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 04999000
*                                                                  1185 05000000
         L     @12,RMEXCTL(,RMCTPTR)                               1185 05001000
         BR    @12                                                 1185 05002000
*   /*****************************************************************/ 05003000
*   /*                                                               */ 05004000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 05005000
*   /*                                                               */ 05006000
*   /*****************************************************************/ 05007000
*                                                                  1186 05008000
*IRARME37:                          /* SYSEVENT 37 - SETDMN  @Z40BPEB   05009000
*                                                            @Z40BPEB*/ 05010000
*/* THIS SYSEVENT RECEIVES A DOMAIN NUMBER AS INPUT AND      @Z40BPEB*/ 05011000
*/* OPTIONAL CONSTRAINT VALUES. THE DOMAIN NUMBER IS         @Z40BPEB*/ 05012000
*/* VERIFIED (DOMAIN 0 WILL NOT BE PASSED) , THEN CONSTRAINT       1186 05013000
*                                                            @Z40BPEB*/ 05014000
*/* VALUES ARE PLACED IN THE DOMAIN TABLE IF THEY ARE VALID. @Z40BPEB*/ 05015000
*                                                                  1186 05016000
*   RFY                                                            1186 05017000
*     WDMVTENT BASED(WMSTDMVT+LENGTH(WDMVTENT)*SETDDMN);/*   @Z40BPEB*/ 05018000
IRARME37 DS    0H                                                  1187 05019000
*   RFY                                                            1187 05020000
*     DMDTPTR RSTD;                 /* HOLD REG 7            @Z40BPEB*/ 05021000
*   IF((SETDDMN+1)*LENGTH(WDMVTENT)<=WMSTDMVS)&WDMVTENT^=ZERO/* VALID   05022000
*                                      DOMAIN?               @ZA14985*/ 05023000
*     THEN                          /* YES                   @Z40BPEB*/ 05024000
         L     @12,RRPAINP(,RRPAPTR)                               1188 05025000
         SLR   @06,@06                                             1188 05026000
         IC    @06,SETDDMN(,@12)                                   1188 05027000
         LA    @11,1                                               1188 05028000
         ALR   @11,@06                                             1188 05029000
         ALR   @11,@11                                             1188 05030000
         L     @10,WMSTPTR(,RMCTPTR)                               1188 05031000
         C     @11,WMSTDMVS(,@10)                                  1188 05032000
         BH    @RF01188                                            1188 05033000
         ALR   @06,@06                                             1188 05034000
         AL    @06,WMSTDMVT(,@10)                                  1188 05035000
         LH    @06,WDMVTENT(,@06)                                  1188 05036000
         LTR   @06,@06                                             1188 05037000
         BZ    @RF01188                                            1188 05038000
*     DO;                           /*                       @Z40BPEB*/ 05039000
*       DMDTPTR=WMSTDMDT+WDMVTENT;  /* FIND PROPER DMN TABLE @Z40BPEB*/ 05040000
         AL    @06,WMSTDMDT(,@10)                                  1190 05041000
         LR    DMDTPTR,@06                                         1190 05042000
*       IF MINFLAG='1'B             /* NEWMIN PASSED?        @Z40BPEB*/ 05043000
*         THEN                                                     1191 05044000
         TM    MINFLAG(@12),B'10000000'                            1191 05045000
         BNO   @RF01191                                            1191 05046000
*         MINSET=SETDMIN;           /* PICK IT UP            @Z40BPEB*/ 05047000
         IC    @06,SETDMIN(,@12)                                   1192 05048000
         STC   @06,MINSET                                          1192 05049000
*       ELSE                                                       1193 05050000
*         MINSET=DMDTLO;            /* NO: KEEP OLD MIN      @Z40BPEB*/ 05051000
         B     @RC01191                                            1193 05052000
@RF01191 IC    @12,DMDTLO(,DMDTPTR)                                1193 05053000
         STC   @12,MINSET                                          1193 05054000
*       IF MAXFLAG='1'B             /* NEW MAX PASSED?       @Z40BPEB*/ 05055000
*         THEN                                                     1194 05056000
@RC01191 L     @12,RRPAINP(,RRPAPTR)                               1194 05057000
         TM    MAXFLAG(@12),B'01000000'                            1194 05058000
         BNO   @RF01194                                            1194 05059000
*         MAXSET=SETDMAX;           /* YES: PICK IT UP       @Z40BPEB*/ 05060000
         IC    @06,SETDMAX(,@12)                                   1195 05061000
         STC   @06,MAXSET                                          1195 05062000
*       ELSE                                                       1196 05063000
*         MAXSET=DMDTHI;            /* NO: KEEP OLD MAX      @Z40BPEB*/ 05064000
         B     @RC01194                                            1196 05065000
@RF01194 IC    @12,DMDTHI(,DMDTPTR)                                1196 05066000
         STC   @12,MAXSET                                          1196 05067000
*       IF MINSET<=MAXSET           /* VALUES ARE PROPER     @Z40BPEB*/ 05068000
*         THEN                      /* SO UPDATE THE DMDT    @Z40BPEB*/ 05069000
@RC01194 CLC   MINSET(1),MAXSET                                    1197 05070000
         BH    @RF01197                                            1197 05071000
*         DO;                       /* .WITH PASSED VALUES   @Z40BPEB*/ 05072000
*           DMDTLO=MINSET;          /* STORE MINIMUM         @Z40BPEB*/ 05073000
         IC    @12,MINSET                                          1199 05074000
         STC   @12,DMDTLO(,DMDTPTR)                                1199 05075000
*           DMDTHI=MAXSET;          /* STORE MAXIMUM         @Z40BPEB*/ 05076000
         IC    @12,MAXSET                                          1200 05077000
         STC   @12,DMDTHI(,DMDTPTR)                                1200 05078000
*           IF WTFLAG='1'B          /* NEW WEIGHT PASSED ?   @Z40BPEB*/ 05079000
*             THEN                                                 1201 05080000
         L     @12,RRPAINP(,RRPAPTR)                               1201 05081000
         TM    WTFLAG(@12),B'00100000'                             1201 05082000
         BNO   @RF01201                                            1201 05083000
*             DMDTWT=SETDWT;        /* STORE WEIGHT          @Z40BPEB*/ 05084000
         IC    @06,SETDWT(,@12)                                    1202 05085000
         STC   @06,DMDTWT(,DMDTPTR)                                1202 05086000
*           IF DMDTLO>DMDTMPLT      /* IF MIN EXCEEDS TARGET @Z40BPEB*/ 05087000
*             THEN                                                 1203 05088000
@RF01201 SLR   @12,@12                                             1203 05089000
         IC    @12,DMDTLO(,DMDTPTR)                                1203 05090000
         CH    @12,DMDTMPLT(,DMDTPTR)                              1203 05091000
         BNH   @RF01203                                            1203 05092000
*             DMDTMPLT=DMDTLO;      /* RAISE TARGET          @Z40BPEB*/ 05093000
         STH   @12,DMDTMPLT(,DMDTPTR)                              1204 05094000
*           IF DMDTHI<DMDTMPLT      /* IF TARGET EXCEEDS MAX @Z40BPEB*/ 05095000
*             THEN                                                 1205 05096000
@RF01203 SLR   @12,@12                                             1205 05097000
         IC    @12,DMDTHI(,DMDTPTR)                                1205 05098000
         CH    @12,DMDTMPLT(,DMDTPTR)                              1205 05099000
         BNL   @RF01205                                            1205 05100000
*             DMDTMPLT=DMDTHI;      /* LOWER TARGET          @Z40BPEB*/ 05101000
         STH   @12,DMDTMPLT(,DMDTPTR)                              1206 05102000
*           RRPARTC=ZERO;           /* SUCCESSFUL SYSEVENT   @Z40BPEB*/ 05103000
@RF01205 MVI   RRPARTC(RRPAPTR),X'00'                              1207 05104000
*         END;                      /*                       @Z40BPEB*/ 05105000
*       ELSE                        /* MIN EXCEEDS MAX       @Z40BPEB*/ 05106000
*         RRPARTC=CON8;             /* RETURN ERROR CODE     @Z40BPEB*/ 05107000
         B     @RC01197                                            1209 05108000
@RF01197 MVI   RRPARTC(RRPAPTR),X'08'                              1209 05109000
*     END;                          /*                       @Z40BPEB*/ 05110000
*   ELSE                            /* DOMAIN UNDEFINED      @Z40BPEB*/ 05111000
*     RRPARTC=CON4;                 /* RETURN ERROR CODE     @Z40BPEB*/ 05112000
         B     @RC01188                                            1211 05113000
@RF01188 MVI   RRPARTC(RRPAPTR),X'04'                              1211 05114000
*   RFY                                                            1212 05115000
*     DMDTPTR UNRSTD;               /* FREE UP REG 7         @Z40BPEB*/ 05116000
@RC01188 DS    0H                                                  1213 05117000
*   RFY                                                            1213 05118000
*     WDMVTENT BASED(WMSTDMVT+LENGTH(WDMVTENT)*WPGPDMN);/*   @Z40BPEB*/ 05119000
*                                                                  1213 05120000
*   /*****************************************************************/ 05121000
*   /*                                                               */ 05122000
*   /* ? IRACTLCL EPN(I01)                                           */ 05123000
*   /*                                                               */ 05124000
*   /*****************************************************************/ 05125000
*                                                                  1214 05126000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 05127000
*                                                                  1214 05128000
         L     @12,RMEXI01(,RMCTPTR)                               1214 05129000
         BR    @12                                                 1214 05130000
*   /*****************************************************************/ 05131000
*   /*                                                               */ 05132000
*   /* RETURN TO INTERFACE                                   @Z40BPEB*/ 05133000
*   /*                                                               */ 05134000
*   /*****************************************************************/ 05135000
*                                                                  1215 05136000
*IRARME38:                          /* SYSEVENT 38 - REQSERVC        */ 05137000
*   RESPECIFY                                                      1215 05138000
*    (R0,                                                          1215 05139000
*     R1,                                                          1215 05140000
*     RTNREG,                                                      1215 05141000
*     NTRREG) UNRSTD;                                              1215 05142000
IRARME38 DS    0H                                                  1216 05143000
*   RESPECIFY                                                      1216 05144000
*    (RTNREG1,                                                     1216 05145000
*     RTNREG2,                                                     1216 05146000
*     RTNREG3) RSTD;                                               1216 05147000
*                                                                  1216 05148000
*/*                                                                  */ 05149000
*/*   COLLECT SERVICE RELATED DATA ACCUMULATED BY THE SRM FOR        */ 05150000
*/*   THIS USER.                                                     */ 05151000
*/*                                                                  */ 05152000
*                                                                  1217 05153000
*   IF OUCBINV='0'B&                /* MEMRY STILL VALID AND @Z40BPCH*/ 05154000
*       OUCBDTA='0'B&               /* USER DATA STILL VALID AND     */ 05155000
*       OUCBOUT='0'B THEN           /* MEMORY CURRENTLY IN-CORE      */ 05156000
         TM    OUCBINV(OUCBPTR),B'00010000'                        1217 05157000
         BNZ   @RF01217                                            1217 05158000
         TM    OUCBDTA(OUCBPTR),B'00000010'                        1217 05159000
         BNZ   @RF01217                                            1217 05160000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1217 05161000
         BNZ   @RF01217                                            1217 05162000
*     DO;                                                          1218 05163000
*       OUXBPTR=ASCBOUXB;           /* ADDRESSABILITY TO THE OUXB    */ 05164000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1219 05165000
*       RESPECIFY                                                  1220 05166000
*        (SERVICE,                                                 1220 05167000
*         TRNTIME,                                                 1220 05168000
*         WRKREG2) RSTD;                                           1220 05169000
*       SERVICE=OUXBJBS+            /* TOTAL SERVICE EXCLUDING       */ 05170000
*           OUXBTRS;                /* CURRENT IN-CORE INTERVAL      */ 05171000
         L     SERVICE,OUXBJBS(,OUXBPTR)                           1221 05172000
         AL    SERVICE,OUXBTRS(,OUXBPTR)                           1221 05173000
*       TRNTIME=OUXBJBT+            /* TOTAL TRANSACTION ACTIVE TIME */ 05174000
*           OUXBTRT;                /* EXCLUDING CURRENT IN-CORE   1222 05175000
*                                      INTERVAL                      */ 05176000
         L     TRNTIME,OUXBJBT(,OUXBPTR)                           1222 05177000
         AL    TRNTIME,OUXBTRT(,OUXBPTR)                           1222 05178000
*       WRKREG2=OUCBNPG*CON65536;   /* LAST PGN FOR MEMORY IN LEFT HW*/ 05179000
         SLR   WRKREG2,WRKREG2                                     1223 05180000
         IC    WRKREG2,OUCBNPG(,OUCBPTR)                           1223 05181000
         SLA   WRKREG2,16                                          1223 05182000
*       IF OUCBLOG='1'B THEN        /* LOGON MEMORY                  */ 05183000
         TM    OUCBLOG(OUCBPTR),B'00100000'                        1224 05184000
         BNO   @RF01224                                            1224 05185000
*         WRKREG2=WRKREG2+          /* TOTAL NUMBER OF TRANSACTIONS  */ 05186000
*             OUXBTRC;              /* IN TERMINAL SESSION           */ 05187000
         AL    WRKREG2,OUXBTRC(,OUXBPTR)                           1225 05188000
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL        */ 05189000
@RF01224 TM    OUCBINC(OUCBPTR),B'00000001'                        1226 05190000
         BNO   @RF01226                                            1226 05191000
*         DO;                       /* OBTAIN SERVICE AND TRANSACTION   05192000
*                                      ACTIVE TIME FOR CURRENT TRANS */ 05193000
*                                                                  1227 05194000
*           /*********************************************************/ 05195000
*           /*                                                       */ 05196000
*           /* ? IRACTLCL EPN(WM1)                                   */ 05197000
*           /*                                                       */ 05198000
*           /*********************************************************/ 05199000
*                                                                  1228 05200000
*           CALL RMSBWM1->IRARMRTN; /* INVOKE WM1 SUBRTN             */ 05201000
*                                                                  1228 05202000
         L     @15,RMSBWM1(,RMCTPTR)                               1228 05203000
         BALR  @14,@15                                             1228 05204000
*           /*********************************************************/ 05205000
*           /*                                                       */ 05206000
*           /* CALCULATE SERVICE IN CURRENT IN-CORE INTERVAL         */ 05207000
*           /*                                                       */ 05208000
*           /*********************************************************/ 05209000
*                                                                  1229 05210000
*           SERVICE=SERVICE+        /* ADD SERIVCE ACCUMULATED FOR   */ 05211000
*               OUCBWMS;            /* CURRENT IN-CORE INTERVAL      */ 05212000
         AL    SERVICE,OUCBWMS(,OUCBPTR)                           1229 05213000
*           TRNTIME=TRNTIME+        /* ADD TRANSACTION ACTIVE TIME   */ 05214000
*               (RMCTTOD-           /* FOR CURRENT IN-CORE INTERVAL  */ 05215000
*               OUCBTMS);                                          1230 05216000
         L     @14,RMCTTOD(,RMCTPTR)                               1230 05217000
         SL    @14,OUCBTMS(,OUCBPTR)                               1230 05218000
         ALR   TRNTIME,@14                                         1230 05219000
*         END;                                                     1231 05220000
*       RTNREG1=SERVICE;            /* SET UP FOR RETURN     @Z40BPEB*/ 05221000
@RF01226 LR    RTNREG1,SERVICE                                     1232 05222000
*       RTNREG2=TRNTIME;            /* OF INFORMATION TO     @Z40BPEB*/ 05223000
         LR    RTNREG2,TRNTIME                                     1233 05224000
*       RTNREG3=WRKREG2;            /* INTERFACE ROUTINE     @Z40BPEB*/ 05225000
         LR    RTNREG3,WRKREG2                                     1234 05226000
*       RRPARTC=OK;                 /* REQ FOR SERVICE DATA HONORED  */ 05227000
         MVI   RRPARTC(RRPAPTR),X'00'                              1235 05228000
*       RESPECIFY                                                  1236 05229000
*        (SERVICE,                                                 1236 05230000
*         TRNTIME,                                                 1236 05231000
*         WRKREG2) UNRSTD;                                         1236 05232000
*     END;                                                         1237 05233000
*   ELSE                            /* USER SERVICE DATA INVALID     */ 05234000
*     DO;                                                          1238 05235000
         B     @RC01217                                            1238 05236000
@RF01217 DS    0H                                                  1239 05237000
*       RTNREG1=ZERO;               /* INDICATE THAT SERVICE         */ 05238000
         SLR   RTNREG1,RTNREG1                                     1239 05239000
*       RTNREG2=ZERO;               /* INFORMATION FOR THIS USER     */ 05240000
         SLR   RTNREG2,RTNREG2                                     1240 05241000
*       RTNREG3=ZERO;               /* IS INVALID                    */ 05242000
         SLR   RTNREG3,RTNREG3                                     1241 05243000
*       RRPARTC=INVLDATA;           /* REQ FOR SERVICE DATA IGNORED  */ 05244000
         MVI   RRPARTC(RRPAPTR),X'04'                              1242 05245000
*     END;                                                         1243 05246000
*                                                                  1243 05247000
*   /*****************************************************************/ 05248000
*   /*                                                               */ 05249000
*   /* ? IRACTLCL EPN(I01)                                           */ 05250000
*   /*                                                               */ 05251000
*   /*****************************************************************/ 05252000
*                                                                  1244 05253000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 05254000
*                                                                  1244 05255000
@RC01217 L     @14,RMEXI01(,RMCTPTR)                               1244 05256000
         BR    @14                                                 1244 05257000
*   /*****************************************************************/ 05258000
*   /*                                                               */ 05259000
*   /* RETURN TO INVOKER                                             */ 05260000
*   /*                                                               */ 05261000
*   /*****************************************************************/ 05262000
*                                                                  1245 05263000
*   RESPECIFY                                                      1245 05264000
*    (RTNREG1,                                                     1245 05265000
*     RTNREG2,                                                     1245 05266000
*     RTNREG3) UNRSTD;                                             1245 05267000
*   RESPECIFY                                                      1246 05268000
*    (R0,                                                          1246 05269000
*     R1,                                                          1246 05270000
*     RTNREG,                                                      1246 05271000
*     NTRREG) RSTD;                                                1246 05272000
*IRARME39:                          /* SYSEVENT 39 - REQPGDAT        */ 05273000
*/*                                                                  */ 05274000
*/*   REQUEST BY SMF FOR USER PAGING AND SWAPPING DATA.              */ 05275000
*/*                                                                  */ 05276000
*                                                                  1247 05277000
*   IF OUCBINV='0'B&                /* MEMRY STILL VALID AND @Z40BPCH*/ 05278000
*       OUCBDTA='0'B&               /* USER DATA STILL VALID AND     */ 05279000
*       OUCBOUT='0'B THEN           /* MEMORY CURRENTLY IN-CORE      */ 05280000
IRARME39 TM    OUCBINV(OUCBPTR),B'00010000'                        1247 05281000
         BNZ   @RF01247                                            1247 05282000
         TM    OUCBDTA(OUCBPTR),B'00000010'                        1247 05283000
         BNZ   @RF01247                                            1247 05284000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1247 05285000
         BNZ   @RF01247                                            1247 05286000
*     DO;                                                          1248 05287000
*       RESPECIFY                                                  1249 05288000
*        (OUXBPTR,                  /* RESTRICT POINTERS             */ 05289000
*         OUSBPTR,                                                 1249 05290000
*         WRKREG2) RSTD;                                           1249 05291000
*       OUSBPTR=ASXBOUSB;           /* ADDRESSABILITY TO OUSB        */ 05292000
         L     @12,ASXBPTR(,ASCBPTR)                               1250 05293000
         L     OUSBPTR,ASXBOUSB(,@12)                              1250 05294000
*       OUXBPTR=ASCBOUXB;           /* ADDRESSABILITY TO OUXB        */ 05295000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1251 05296000
*       IF RRPASVC='0'B THEN        /* IF BRANCH ENTERED             */ 05297000
         TM    RRPASVC(RRPAPTR),B'00100000'                        1252 05298000
         BNZ   @RF01252                                            1252 05299000
*         DO;                       /* MODESET KEYADDR(RRPAKEY)    1253 05300000
*                                      WORKREG(MODESETR)             */ 05301000
*           MODESETR=RRPAKEY;       /* GET KEY FORM SAVE LOCATION    */ 05302000
         SLR   MODESETR,MODESETR                                   1254 05303000
         IC    MODESETR,RRPAKEY(,RRPAPTR)                          1254 05304000
*           SPKA(MODESETR);         /* SET PSW KEY                   */ 05305000
         SPKA  0(MODESETR)                                         1255 05306000
*         END;                      /* MODESET KEYADDR(RRPAKEY)    1256 05307000
*                                      WORKREG(MODESETR)     @Z40BPJE*/ 05308000
*       ELSE                        /* OTHERWISE,                    */ 05309000
*         DO;                       /* SWITCH TO PROTECT KEY IN      */ 05310000
         B     @RC01252                                            1257 05311000
@RF01252 DS    0H                                                  1258 05312000
*           R1=PSATOLD;             /* CURRENT TCB           @Z30WIMG*/ 05313000
         L     R1,PSATOLD                                          1258 05314000
*           GENERATE;                                              1259 05315000
*                                                         /*@Z30WIMG*/  05316000
         USING TCB,R1                                                   05317000
         MODESET EXTKEY=RBT1,WORKREG=10                                 05318000
         DROP  R1                                                       05319000
*         END;                      /*                               */ 05320000
*                                                                  1260 05321000
*       /*************************************************************/ 05322000
*       /*                                                           */ 05323000
*       /* GET PAGING DATA TOTALS FOR THE JOB OR TSO SESSION. PAGING */ 05324000
*       /* DATA TOTAL = (TOTAL TO LAST IN-STORAGE INTERVAL) + (TOTAL */ 05325000
*       /* DURING LAST IN-STORAGE INTERVAL).                         */ 05326000
*       /*                                                           */ 05327000
*       /*************************************************************/ 05328000
*                                                                  1261 05329000
*       SMFPIN=OUSBPIN+OUXBPIN;     /* NUMBER OF PAGE-INS            */ 05330000
@RC01252 L     @12,RRPAINP(,RRPAPTR)                               1261 05331000
         L     @11,OUSBPIN(,OUSBPTR)                               1261 05332000
         AL    @11,OUXBPIN(,OUXBPTR)                               1261 05333000
         ST    @11,SMFPIN(,@12)                                    1261 05334000
*       SMFPOUT=OUSBPOUT+OUXBPOUT;  /* NUMBER OF PAGE-OUTS           */ 05335000
         L     @11,OUSBPOUT(,OUSBPTR)                              1262 05336000
         AL    @11,OUXBPOUT(,OUXBPTR)                              1262 05337000
         ST    @11,SMFPOUT(,@12)                                   1262 05338000
*       SMFPREC=OUSBPREC+OUXBPREC;  /* NUMBER OF PAGE-RECLAIMS       */ 05339000
         L     @11,OUSBPREC(,OUSBPTR)                              1263 05340000
         AL    @11,OUXBPREC(,OUXBPTR)                              1263 05341000
         ST    @11,SMFPREC(,@12)                                   1263 05342000
*       SMFVAMI=OUSBVAMI+OUXBVAMI;  /* NUMBER OF VAM PAGE-INS        */ 05343000
         L     @11,OUSBVAMI(,OUSBPTR)                              1264 05344000
         AL    @11,OUXBVAMI(,OUXBPTR)                              1264 05345000
         ST    @11,SMFVAMI(,@12)                                   1264 05346000
*       SMFVAMO=OUSBVAMO+OUXBVAMO;  /* NUMBER OF VAM PAGE-OUTS       */ 05347000
         L     @11,OUSBVAMO(,OUSBPTR)                              1265 05348000
         AL    @11,OUXBVAMO(,OUXBPTR)                              1265 05349000
         ST    @11,SMFVAMO(,@12)                                   1265 05350000
*       SMFVAMR=OUSBVAMR+OUXBVAMR;  /* NUMBER OF VAM PAGE-RECLAIMS   */ 05351000
         L     @11,OUSBVAMR(,OUSBPTR)                              1266 05352000
         AL    @11,OUXBVAMR(,OUXBPTR)                              1266 05353000
         ST    @11,SMFVAMR(,@12)                                   1266 05354000
*       SMFCAPI=OUSBCAPI+OUXBCAPI;  /* NUMBER OF COMMON PAGE INS   1267 05355000
*                                                            @Z40BPJE*/ 05356000
         L     @11,OUSBCAPI(,OUSBPTR)                              1267 05357000
         AL    @11,OUXBCAPI(,OUXBPTR)                              1267 05358000
         ST    @11,SMFCAPI(,@12)                                   1267 05359000
*       SMFCAPR=OUSBCAPR+OUXBCAPR;  /* NUMBER OF COMMON PAGE RECLAIMS   05360000
*                                                            @Z40BPJE*/ 05361000
         L     @11,OUSBCAPR(,OUSBPTR)                              1268 05362000
         AL    @11,OUXBCAPR(,OUXBPTR)                              1268 05363000
         ST    @11,SMFCAPR(,@12)                                   1268 05364000
*       SMFSTCT=OUSBSTCT+OUXBSTCT;  /* NUMBER OF PAGES STOLEN      1269 05365000
*                                                            @Z40BPJE*/ 05366000
         L     @11,OUSBSTCT(,OUSBPTR)                              1269 05367000
         AL    @11,OUXBSTCT(,OUXBPTR)                              1269 05368000
         ST    @11,SMFSTCT(,@12)                                   1269 05369000
*       SMFPGSS=OUCBPSS;            /* NUMBER OF PAGE SECONDS (IN  1270 05370000
*                                      MILLISECONDS)         @Z40BPJE*/ 05371000
*                                                                  1270 05372000
         MVC   SMFPGSS(8,@12),OUCBPSS(OUCBPTR)                     1270 05373000
*       /*************************************************************/ 05374000
*       /*                                                           */ 05375000
*       /* MOVE SWAPPING DATA ACCUMULATED FOR USER TO SMF DATA AREA. */ 05376000
*       /*                                                           */ 05377000
*       /*************************************************************/ 05378000
*                                                                  1271 05379000
*       SMFSCNTS=SWPFLDS;           /* MOVE SWAPPING DATA TO SMF AREA*/ 05380000
         MVC   SMFSCNTS(12,@12),SWPFLDS(OUSBPTR)                   1271 05381000
*       GENERATE;                                                  1272 05382000
*                                                                  1272 05383000
         MODESET EXTKEY=SRM                                             05384000
*       /*************************************************************/ 05385000
*       /*                                                           */ 05386000
*       /* RE-INITIALIZE FIELDS IN OUXB AND OUSB.                    */ 05387000
*       /*                                                           */ 05388000
*       /*************************************************************/ 05389000
*                                                                  1273 05390000
*       PGEFLDS=''B;                /* RE-INIT PAGING AND SWAPPING 1273 05391000
*                                      FIELDS IN OUSB                */ 05392000
         XC    PGEFLDS(48,OUSBPTR),PGEFLDS(OUSBPTR)                1273 05393000
*       PGEFLDX=''B;                /* RE-INIT PAGING FIELDS IN OUXB */ 05394000
         XC    PGEFLDX(36,OUXBPTR),PGEFLDX(OUXBPTR)                1274 05395000
*       RRPARTC=OK;                 /* REQ FOR PAGING DATA HONORED   */ 05396000
         MVI   RRPARTC(RRPAPTR),X'00'                              1275 05397000
*       RESPECIFY                                                  1276 05398000
*        (OUXBPTR,                  /* UNRESTRICT POINTERS           */ 05399000
*         OUSBPTR,                                                 1276 05400000
*         WRKREG2) UNRSTD;                                         1276 05401000
*     END;                                                         1277 05402000
*   ELSE                            /* USER PAGING DATA INVALID      */ 05403000
*     RRPARTC=INVLDATA;             /* REQ FOR PAGING DATA IGNORED   */ 05404000
*                                                                  1278 05405000
         B     @RC01247                                            1278 05406000
@RF01247 MVI   RRPARTC(RRPAPTR),X'04'                              1278 05407000
*   /*****************************************************************/ 05408000
*   /*                                                               */ 05409000
*   /* ? IRACTLCL EPN(CTL)                                           */ 05410000
*   /*                                                               */ 05411000
*   /*****************************************************************/ 05412000
*                                                                  1279 05413000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 05414000
*                                                                  1279 05415000
@RC01247 L     @12,RMEXCTL(,RMCTPTR)                               1279 05416000
         BR    @12                                                 1279 05417000
*   /*****************************************************************/ 05418000
*   /*                                                               */ 05419000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 05420000
*   /*                                                               */ 05421000
*   /*****************************************************************/ 05422000
*                                                                  1280 05423000
*IRARME40:                          /* SYSEVENT 40 - COPYDMDT      1280 05424000
*                                                            @Z40BPEB*/ 05425000
*/* THIS SYSEVENT COPIES THE NUMBER OF VALID DOMAINS AND     @Z40BPEB*/ 05426000
*/* THE DOMAIN TABLE INTO A FIXED AREA PASSED AS INPUT.      @Z40BPEB*/ 05427000
*/* THE SYSEVENT IS NEEDED SO THE COPY CAN BE DONE UNDER     @Z40BPEB*/ 05428000
*/* THE SRM LOCK, WITHOUT FEAR OF SETIPS CHANGING THE DMDT.  @Z40BPEB*/ 05429000
*/*                                                                  */ 05430000
*                                                                  1280 05431000
*   COPYCNT=RMCTDMNC;               /* COPY DOMAIN COUNT     @Z40BPEB*/ 05432000
IRARME40 L     @12,RRPAINP(,RRPAPTR)                               1280 05433000
         LH    @11,RMCTDMNC(,RMCTPTR)                              1280 05434000
         STH   @11,COPYCNT(,@12)                                   1280 05435000
*   RFY                                                            1281 05436000
*    (COPYTARG,                                                    1281 05437000
*     COPYLNG,                                                     1281 05438000
*     COPYSRC,                                                     1281 05439000
*     COPYLGTH) RSTD;               /* HOLD REGS 6,7,10,11 FOR MVCL.    05440000
*                                                            @Z40BPEB*/ 05441000
*   COPYLNG=COPYCNT*LENGTH(DMDT);   /* LENGTH OF MOVE        @Z40BPEB*/ 05442000
         ST    @11,@TF00001                                        1282 05443000
         L     COPYLNG,@TF00001                                    1282 05444000
         MH    COPYLNG,@CH02633                                    1282 05445000
*   COPYLGTH=COPYLNG;               /* LENGTH OF SOURCE TOO. @Z40BPEB*/ 05446000
         LR    COPYLGTH,COPYLNG                                    1283 05447000
*   COPYTARG=ADDR(COPYDMDT);        /* ADDR OF TARGET        @Z40BPEB*/ 05448000
         LA    COPYTARG,COPYDMDT(,@12)                             1284 05449000
*   COPYSRC=WMSTDMDT;               /* ADDR OF DMDT (SOURCE) @Z40BPEB*/ 05450000
         L     @12,WMSTPTR(,RMCTPTR)                               1285 05451000
         L     COPYSRC,WMSTDMDT(,@12)                              1285 05452000
*   MVCL(COPYTARG,COPYSRC);         /* DUPLICATE THE DMDT    @Z40BPEB*/ 05453000
         MVCL  COPYTARG,COPYSRC                                    1286 05454000
*   RFY                                                            1287 05455000
*    (COPYTARG,                                                    1287 05456000
*     COPYLNG,                                                     1287 05457000
*     COPYSRC,                                                     1287 05458000
*     COPYLGTH) UNRSTD;             /*                       @Z40BPEB*/ 05459000
*   RRPARTC=ZERO;                   /* SUCCESSFUL SYSEVENT   @Z40BPEB*/ 05460000
         MVI   RRPARTC(RRPAPTR),X'00'                              1288 05461000
*/*   ? IRACTLCL EPN(I01)                                            */ 05462000
*                                                                  1289 05463000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 05464000
*                                                                  1289 05465000
         L     @12,RMEXI01(,RMCTPTR)                               1289 05466000
         BR    @12                                                 1289 05467000
*   /*****************************************************************/ 05468000
*   /*                                                               */ 05469000
*   /* RETURN TO INTERFACE PGM                               @Z40BPEB*/ 05470000
*   /*                                                               */ 05471000
*   /*****************************************************************/ 05472000
*                                                                  1290 05473000
*IRARME41:                          /* SYSEVENT 41 - DONTSWAP        */ 05474000
*IRARME42:                          /* SYSEVENT 42 - OKSWAP          */ 05475000
*   IF RRPASVC='1'B THEN            /* SVC ENTRY TO SRM              */ 05476000
IRARME41 DS    0H                                                  1290 05477000
IRARME42 TM    RRPASVC(RRPAPTR),B'00100000'                        1290 05478000
         BNO   @RF01290                                            1290 05479000
*     DO;                           /* CHECK AUTHORIZATION TO ISSUE     05480000
*                                      SYSEVENT                      */ 05481000
*                                                                  1291 05482000
*       /*************************************************************/ 05483000
*       /*                                                           */ 05484000
*       /* SAVE REGISTERS ALTERED BY TESTAUTH.                       */ 05485000
*       /*                                                           */ 05486000
*       /*************************************************************/ 05487000
*                                                                  1292 05488000
*       RESPECIFY                                                  1292 05489000
*        (RMCTSAVE,                                                1292 05490000
*         RRPASAVE) RSTD;                                          1292 05491000
*       RMCTSAVE=RMCTPTR;                                          1293 05492000
         LR    RMCTSAVE,RMCTPTR                                    1293 05493000
*       RRPASAVE=RRPAPTR;                                          1294 05494000
*                                                                  1294 05495000
         LR    RRPASAVE,RRPAPTR                                    1294 05496000
*       /*************************************************************/ 05497000
*       /*                                                           */ 05498000
*       /* CHECK AUTHORIZATION OF MEMORY TO ISSUE SYSEVENT.          */ 05499000
*       /*                                                           */ 05500000
*       /*************************************************************/ 05501000
*                                                                  1295 05502000
*       GENERATE CODE REFS(CVTAPF,CVT)                             1295 05503000
*           (TESTAUTH FCTN=1,STATE=YES,KEY=YES,RBLEVEL=1,BRANCH=YES);   05504000
*                                                                  1295 05505000
         TESTAUTH FCTN=1,STATE=YES,KEY=YES,RBLEVEL=1,BRANCH=YES         05506000
*       /*************************************************************/ 05507000
*       /*                                                           */ 05508000
*       /* RESTORE REGISTERS ALTERED BY TESTAUTH.                    */ 05509000
*       /*                                                           */ 05510000
*       /*************************************************************/ 05511000
*                                                                  1296 05512000
*       RMCTPTR=RMCTSAVE;                                          1296 05513000
         LR    RMCTPTR,RMCTSAVE                                    1296 05514000
*       RRPAPTR=RRPASAVE;                                          1297 05515000
         LR    RRPAPTR,RRPASAVE                                    1297 05516000
*       RESPECIFY                                                  1298 05517000
*        (RMCTSAVE,                                                1298 05518000
*         RRPASAVE) UNRSTD;                                        1298 05519000
*       IF RTNCOD^=ZERO&            /* MEMORY NOT AUTH BY TESTAUTH & */ 05520000
*           OUCBASW='0'B THEN       /* NO AUTHORIZATION FROM PREVIOUS   05521000
*                                      INITATT SYSEVENT              */ 05522000
         LTR   RTNCOD,RTNCOD                                       1299 05523000
         BZ    @RF01299                                            1299 05524000
         TM    OUCBASW(OUCBPTR),B'00000001'                        1299 05525000
         BNZ   @RF01299                                            1299 05526000
*         DO;                                                      1300 05527000
*           RRPARI3=NOAUTH;         /* USER NOT AUTHORIZED           */ 05528000
*                                                                  1301 05529000
         MVI   RRPARI3(RRPAPTR),X'08'                              1301 05530000
*           /*********************************************************/ 05531000
*           /*                                                       */ 05532000
*           /* ? IRACTLCL EPN(CTL)                                   */ 05533000
*           /*                                                       */ 05534000
*           /*********************************************************/ 05535000
*                                                                  1302 05536000
*           GOTO RMEXCTL->IRARMNTR; /* EXIT TO CTL FUNCT             */ 05537000
*                                                                  1302 05538000
         L     @12,RMEXCTL(,RMCTPTR)                               1302 05539000
         BR    @12                                                 1302 05540000
*           /*********************************************************/ 05541000
*           /*                                                       */ 05542000
*           /* ENTER SRM CONTROL ROUTINE                             */ 05543000
*           /*                                                       */ 05544000
*           /*********************************************************/ 05545000
*                                                                  1303 05546000
*         END;                                                     1303 05547000
*     END;                                                         1304 05548000
@RF01299 DS    0H                                                  1305 05549000
*   IF ASCBPTR=PSAAOLD THEN         /* MEMORY AFFECTED BY SYSEVENT IS   05550000
*                                      THE CURRENT MEMORY            */ 05551000
@RF01290 C     ASCBPTR,PSAAOLD                                     1305 05552000
         BNE   @RF01305                                            1305 05553000
*     DO;                                                          1306 05554000
*       RRPARI3=OK;                 /* REQUEST FOR MEMORY STATUS   1307 05555000
*                                      CHANGE HONORED                */ 05556000
         MVI   RRPARI3(RRPAPTR),X'00'                              1307 05557000
*       IF RRPACOD=SYSEVT41 THEN    /* IF SYSEVENT 41,               */ 05558000
         CLI   RRPACOD(RRPAPTR),41                                 1308 05559000
         BNE   @RF01308                                            1308 05560000
*         DO;                                                      1309 05561000
*           OUCBNSW='1'B;           /* MEMORY IS NON-SWAPPABLE       */ 05562000
         OI    OUCBNSW(OUCBPTR),B'10000000'                        1310 05563000
*           OUCBNDS=OUCBNDS+ONE;    /* INCREMENT NO. OF OUTSTANDING     05564000
*                                      DONTSWAP SYSEVENTS            */ 05565000
         LA    @12,1                                               1311 05566000
         AH    @12,OUCBNDS(,OUCBPTR)                               1311 05567000
         STH   @12,OUCBNDS(,OUCBPTR)                               1311 05568000
*           IF OUCBNDS<ZERO THEN    /* IF NO. OF DONTSWAP    @ZA20975*/ 05569000
         LH    @12,OUCBNDS(,OUCBPTR)                               1312 05570000
         LTR   @12,@12                                             1312 05571000
         BNM   @RF01312                                            1312 05572000
*             DO;                   /* SYSEVENTS EXCEEDS 32767,      */ 05573000
*               RRPARI3=NOAUTH;     /* DONTSWAP SYSEVENT IGNORED     */ 05574000
         MVI   RRPARI3(RRPAPTR),X'08'                              1314 05575000
*               OUCBNDS=CON32767;   /* RESET COUNT TO MAXIMUM        */ 05576000
         MVC   OUCBNDS(2,OUCBPTR),@CH02502                         1315 05577000
*             END;                                                 1316 05578000
*           IF OUCBNDS=ONE THEN     /* MEMORY BECAME NONSWAPPABLE  1317 05579000
*                                                            @ZA10102*/ 05580000
*                                                                  1317 05581000
@RF01312 CLC   OUCBNDS(2,OUCBPTR),@CH00078                         1317 05582000
         BNE   @RF01317                                            1317 05583000
*             /*******************************************************/ 05584000
*             /*                                                     */ 05585000
*             /* ? IRACTLCL EPN(WMK)                                 */ 05586000
*             /*                                                     */ 05587000
*             /*******************************************************/ 05588000
*                                                                  1318 05589000
*             CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN            */ 05590000
*                                                                  1318 05591000
         L     @15,RMSBWMK(,RMCTPTR)                               1318 05592000
         BALR  @14,@15                                             1318 05593000
*           /*********************************************************/ 05594000
*           /*                                                       */ 05595000
*           /* INVOKE WMK SUBRTN                             @ZA10102*/ 05596000
*           /*                                                       */ 05597000
*           /*********************************************************/ 05598000
*                                                                  1319 05599000
*         END;                                                     1319 05600000
*       ELSE                        /* SYSEVENT 42                   */ 05601000
*         DO;                                                      1320 05602000
         B     @RC01308                                            1320 05603000
@RF01308 DS    0H                                                  1321 05604000
*           IF OUCBNDS>ONE|(OUCBNDS=ONE&ASCBVEQR='0'B) THEN/*      1321 05605000
*                                      OUTSTANDING DONTSWAP SYSEVENTS   05606000
*                                      BUT DON'T LET A V=R JOB BECOME   05607000
*                                      SWAPPABLE             @ZA16887*/ 05608000
         LA    @12,1                                               1321 05609000
         CH    @12,OUCBNDS(,OUCBPTR)                               1321 05610000
         BL    @RT01321                                            1321 05611000
         CH    @12,OUCBNDS(,OUCBPTR)                               1321 05612000
         BNE   @RF01321                                            1321 05613000
         TM    ASCBVEQR(ASCBPTR),B'00010000'                       1321 05614000
         BNZ   @RF01321                                            1321 05615000
@RT01321 DS    0H                                                  1322 05616000
*             OUCBNDS=OUCBNDS-ONE;  /* DECREMENT COUNT OF NO. OF   1322 05617000
*                                      OUTSTANDING DONTSWAP SYSEVENTS*/ 05618000
         LH    @12,OUCBNDS(,OUCBPTR)                               1322 05619000
         BCTR  @12,0                                               1322 05620000
         STH   @12,OUCBNDS(,OUCBPTR)                               1322 05621000
*           IF OUCBNDS=ZERO THEN    /* NO OUTSTANDING DONTSWAP       */ 05622000
@RF01321 LH    @12,OUCBNDS(,OUCBPTR)                               1323 05623000
         LTR   @12,@12                                             1323 05624000
         BNZ   @RF01323                                            1323 05625000
*             DO;                   /* SYSEVENT, CHANGE MEMORY STATUS*/ 05626000
*               OUCBNSW='0'B;       /* MEMORY IS SWAPPABLE           */ 05627000
         NI    OUCBNSW(OUCBPTR),B'01111111'                        1325 05628000
*/*   ? IRACTLCL EPN(WMK)                                            */ 05629000
*                                                                  1326 05630000
*               CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN          */ 05631000
*                                                                  1326 05632000
         L     @15,RMSBWMK(,RMCTPTR)                               1326 05633000
         BALR  @14,@15                                             1326 05634000
*               /*****************************************************/ 05635000
*               /*                                                   */ 05636000
*               /* TELL WLM, MEMORY IS NOW SWAPPABLE         @ZA10102*/ 05637000
*               /*                                                   */ 05638000
*               /*****************************************************/ 05639000
*                                                                  1327 05640000
*               IF OUCBRSWP='1'B    /* Q. REQSWAP PENDING?   @ZA31733*/ 05641000
*                 THEN                                             1327 05642000
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       1327 05643000
         BNO   @RF01327                                            1327 05644000
*                 CALL EVTCSOD;     /* YES. ATTEMPT SWAP OUT @ZA31733*/ 05645000
         BAL   @14,EVTCSOD                                         1328 05646000
*             END;                  /*                               */ 05647000
*         END;                                                     1330 05648000
*     END;                                                         1331 05649000
*   ELSE                            /* MEMORY AFFECTED NOT CURRENT   */ 05650000
*     RRPARI3=INVLDREQ;             /* REQUEST IGNORED               */ 05651000
*                                                                  1332 05652000
         B     @RC01305                                            1332 05653000
@RF01305 MVI   RRPARI3(RRPAPTR),X'04'                              1332 05654000
*   /*****************************************************************/ 05655000
*   /*                                                               */ 05656000
*   /* ? IRACTLCL EPN(CTL)                                           */ 05657000
*   /*                                                               */ 05658000
*   /*****************************************************************/ 05659000
*                                                                  1333 05660000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 05661000
*                                                                  1333 05662000
@RC01305 L     @12,RMEXCTL(,RMCTPTR)                               1333 05663000
         BR    @12                                                 1333 05664000
*   /*****************************************************************/ 05665000
*   /*                                                               */ 05666000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 05667000
*   /*                                                               */ 05668000
*   /*****************************************************************/ 05669000
*                                                                  1334 05670000
*IRARME43:                          /* SYSEVENT 43 - REQSWAP         */ 05671000
*/*                                                                  */ 05672000
*/*   SWAP-OUT OF A PARTICULAR MEMORY IS REQUIRED.                   */ 05673000
*/*    IF REGISTER 1 IS NOT ZERO, THE ECB IT POINTS TO WILL BE       */ 05674000
*/*   POSTED DURING SWAPOUT COMPLETE PROCESSING. THUS THE MEMORY     */ 05675000
*/*   WILL IMMEDIATELY BE ELIGIBLE FOR SWAPIN.                       */ 05676000
*/*                                                                  */ 05677000
*                                                                  1334 05678000
*   RFY                                                            1334 05679000
*     OUXBPTR RSTD;                 /* HOLD REGISTER         @ZA16887*/ 05680000
IRARME43 DS    0H                                                  1335 05681000
*   IF RRPAINP=ZERO|ASCBPTR=PSAAOLD THEN/* IF AN ECB IS SPECIFIED, 1335 05682000
*                                      THE REQUEST MUST BE FOR THE 1335 05683000
*                                      CURRENT A.S.          @ZA16887*/ 05684000
         L     @12,RRPAINP(,RRPAPTR)                               1335 05685000
         LTR   @12,@12                                             1335 05686000
         BZ    @RT01335                                            1335 05687000
         C     ASCBPTR,PSAAOLD                                     1335 05688000
         BNE   @RF01335                                            1335 05689000
@RT01335 DS    0H                                                  1336 05690000
*     IF OUCBNSW='0'B THEN          /* SWAPPABLE?            @ZA16887*/ 05691000
         TM    OUCBNSW(OUCBPTR),B'10000000'                        1336 05692000
         BNZ   @RF01336                                            1336 05693000
*       DO;                         /* CONTINUE REQSWAP      @ZA16887*/ 05694000
*         OUXBPTR=ASCBOUXB;         /* GET ADDR OF OUXB      @ZA16887*/ 05695000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1338 05696000
*         IF OUCBRSWP='0'B THEN     /* NO OTHER REQSWAP PENDING?   1339 05697000
*                                                            @ZA16887*/ 05698000
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       1339 05699000
         BNZ   @RF01339                                            1339 05700000
*           IF OUCBOUT='0'B|OUCBGOI='1'B|/* A.S. IN STORAGE OR     1340 05701000
*                                                            @ZA16887*/ 05702000
*               OUCBGOO='1'B THEN   /* TRANSITIONING?        @ZA16887*/ 05703000
         TM    OUCBGOI(OUCBPTR),B'11000000'                        1340 05704000
         BNZ   @RT01340                                            1340 05705000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1340 05706000
         BO    @RF01340                                            1340 05707000
@RT01340 DS    0H                                                  1341 05708000
*             DO;                   /* OK TO BEGIN SWAPOUT / @ZA16887*/ 05709000
*/*  ? IRACTLCL EPN(CSO)                                             */ 05710000
*                                                                  1342 05711000
*               DO;                                                1342 05712000
*                 R1=ADDR(RMEPBCSO);/* CSO REQUEST IS PARAM          */ 05713000
         LA    R1,RMEPBCSO(,RMCTPTR)                               1343 05714000
*                 CALL RMSBCRY->IRARMRTN;/* ACTION INVK FUNCT        */ 05715000
         L     @15,RMSBCRY(,RMCTPTR)                               1344 05716000
         BALR  @14,@15                                             1344 05717000
*               END;                /* INVOKE SWAPOUT ROUTINE      1345 05718000
*                                                            @ZA16887*/ 05719000
*               IF RETNCODE=ZERO|   /* SWAPOUT WAS BEGUN OR  @ZA16887*/ 05720000
*                   RETNCODE=CON8 THEN/* A.S WAS TRANSITIONING     1346 05721000
*                                                            @ZA16887*/ 05722000
         LTR   RETNCODE,RETNCODE                                   1346 05723000
         BZ    @RT01346                                            1346 05724000
         C     RETNCODE,@CF00152                                   1346 05725000
         BNE   @RF01346                                            1346 05726000
@RT01346 DS    0H                                                  1347 05727000
*                 DO;               /* CONTINUE REQSWAP      @ZA16887*/ 05728000
*                   OUCBRSWP='1'B;  /* REQSWAP IS PENDING    @ZA16887*/ 05729000
         OI    OUCBRSWP(OUCBPTR),B'00100000'                       1348 05730000
*                   OUXBRSW=RRPAINP;/* STORE ECB ADDRESS, IF THERE IS   05731000
*                                      ONE                   @ZA16887*/ 05732000
         L     @12,RRPAINP(,RRPAPTR)                               1349 05733000
         ST    @12,OUXBRSW(,OUXBPTR)                               1349 05734000
*                   IF RETNCODE=ZERO THEN/* SWAPOUT WAS BEGUN      1350 05735000
*                                                            @ZA16887*/ 05736000
         LTR   RETNCODE,RETNCODE                                   1350 05737000
         BNZ   @RF01350                                            1350 05738000
*                     DO;           /* SO FINISH REQSWAP     @ZA16887*/ 05739000
*                       OUCBLWT='0'B;/* RESET LONG           @ZA16887*/ 05740000
*                       OUCBMWT='0'B;/* WAIT FLAGS           @ZA16887*/ 05741000
*                       OUCBTRM='0'B;/* INDICATE NO TERMWAIT SWAPOUT    05742000
*                                                            @ZA16887*/ 05743000
         NI    OUCBLWT(OUCBPTR),B'00111110'                        1354 05744000
*                       OUCBSRC=SRCDRQSC;/* COUNT THIS REQSWAP     1355 05745000
*                                                            @ZA16887*/ 05746000
         MVI   OUCBSRC(OUCBPTR),X'07'                              1355 05747000
*                       IF RRPASVC='1'B THEN/* SVC ENTRY TO SRM    1356 05748000
*                                                            @ZA16887*/ 05749000
         TM    RRPASVC(RRPAPTR),B'00100000'                        1356 05750000
         BNO   @RF01356                                            1356 05751000
*                         RRPARTN=CVTEXP1;/* FORCE EXIT THRU       1357 05752000
*                                      DISPATCHER TO ALLOW SWAPOUT TO   05753000
*                                      RUN                   @ZA16887*/ 05754000
         L     @12,CVTPTR                                          1357 05755000
         L     @12,CVTEXP1(,@12)                                   1357 05756000
         ST    @12,RRPARTN(,RRPAPTR)                               1357 05757000
*                     END;          /* END RC=0 CASE         @ZA16887*/ 05758000
@RF01356 DS    0H                                                  1359 05759000
*                   RRPARI3=ZERO;   /* SUCCESSFUL REQSWAP    @ZA16887*/ 05760000
@RF01350 MVI   RRPARI3(RRPAPTR),X'00'                              1359 05761000
*                 END;              /* END RC=0 OR 8 CASE    @ZA16887*/ 05762000
*               ELSE                /* RC=4 FROM SWAPOUT     @ZA16887*/ 05763000
*                 DO;               /* MEANS INVALID SRM DATA      1361 05764000
*                                                            @ZA16887*/ 05765000
         B     @RC01346                                            1361 05766000
@RF01346 DS    0H                                                  1362 05767000
*                   RESNCODE=CON24; /*                       @ZA16887*/ 05768000
         LA    RESNCODE,24                                         1362 05769000
*/*  ? IRACTLCL EPN(I10)                                             */ 05770000
*                                                                  1363 05771000
*                   CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT      */ 05772000
*                                                                  1363 05773000
         L     @15,RMSBI10(,RMCTPTR)                               1363 05774000
         BALR  @14,@15                                             1363 05775000
*                   /*************************************************/ 05776000
*                   /*                                               */ 05777000
*                   /* FRR WILL CONVERT TO 25F ABEND         @ZA16887*/ 05778000
*                   /*                                               */ 05779000
*                   /*************************************************/ 05780000
*                                                                  1364 05781000
*                 END;              /*                       @ZA16887*/ 05782000
*             END;                  /* END IN-STORAGE CASE   @ZA16887*/ 05783000
*           ELSE                    /* A.S. IS OUT OF STORAGE      1366 05784000
*                                                            @ZA16887*/ 05785000
*             RRPARI3=CON12;        /* TELL REQSWAP ISSUER   @ZA16887*/ 05786000
         B     @RC01340                                            1366 05787000
@RF01340 MVI   RRPARI3(RRPAPTR),X'0C'                              1366 05788000
*         ELSE                      /* ANOTHER REQ WAS PENDING     1367 05789000
*                                                            @ZA16887*/ 05790000
*           DO;                     /* INVOKE SUBROUTINE     @ZA20975*/ 05791000
         B     @RC01339                                            1367 05792000
@RF01339 DS    0H                                                  1368 05793000
*             R1=ADDR(OUXBRSW);     /* TO STORE ECB ADDR     @ZA20975*/ 05794000
         LA    R1,OUXBRSW(,OUXBPTR)                                1368 05795000
*             CALL EVTSTACK;        /* IF ONE IS SPEC'D.     @ZA20975*/ 05796000
         BAL   @14,EVTSTACK                                        1369 05797000
*             RRPARI3=ZERO;         /* NORMAL REQSWAP        @ZA16887*/ 05798000
         MVI   RRPARI3(RRPAPTR),X'00'                              1370 05799000
*           END;                    /* END PENDING CASE      @ZA20975*/ 05800000
*       END;                        /* END SWAPPABLE CASE    @ZA16887*/ 05801000
*     ELSE                          /* A.S. IS NONSWAPPABLE  @ZA16887*/ 05802000
*       DO;                         /*                       @ZA31733*/ 05803000
         B     @RC01336                                            1373 05804000
@RF01336 DS    0H                                                  1374 05805000
*         RRPARI3=CON4;             /* TELL REQSWAP ISSUER.  @ZA16887*/ 05806000
         MVI   RRPARI3(RRPAPTR),X'04'                              1374 05807000
*         OUCBRSWP='1'B;            /* SET REQUEST SWAP PENDING LATCH   05808000
*                                                            @ZA31733*/ 05809000
         OI    OUCBRSWP(OUCBPTR),B'00100000'                       1375 05810000
*       END;                        /*                       @ZA31733*/ 05811000
*   ELSE                            /* ECB WAS SPECIFIED,    @ZA16887*/ 05812000
*     DO;                           /* REMOTE A.S.,          @ZA16887*/ 05813000
         B     @RC01335                                            1377 05814000
@RF01335 DS    0H                                                  1378 05815000
*       RESNCODE=CON4;              /* ABEND 15F RC=4        @ZA16887*/ 05816000
         LA    RESNCODE,4                                          1378 05817000
*/*  ? IRACTLCL EPN(I10)                                             */ 05818000
*                                                                  1379 05819000
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */ 05820000
*                                                                  1379 05821000
         L     @15,RMSBI10(,RMCTPTR)                               1379 05822000
         BALR  @14,@15                                             1379 05823000
*       /*************************************************************/ 05824000
*       /*                                                           */ 05825000
*       /* INVALID INPUT TO SRM                              @ZA16887*/ 05826000
*       /*                                                           */ 05827000
*       /*************************************************************/ 05828000
*                                                                  1380 05829000
*     END;                          /*                       @ZA16887*/ 05830000
*/*  ? IRACTLCL EPN(CTL)                                             */ 05831000
*                                                                  1381 05832000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 05833000
*                                                                  1381 05834000
@RC01335 L     @12,RMEXCTL(,RMCTPTR)                               1381 05835000
         BR    @12                                                 1381 05836000
*   /*****************************************************************/ 05837000
*   /*                                                               */ 05838000
*   /* EXIT TO CONTROL                                       @ZA16887*/ 05839000
*   /*                                                               */ 05840000
*   /*****************************************************************/ 05841000
*                                                                  1382 05842000
*   RFY                                                            1382 05843000
*     OUXBPTR UNRSTD;               /* FREE UP REGISTER      @ZA16887*/ 05844000
*IRARME44:                          /* SYSEVENT 44 - BRINGIN         */ 05845000
*   IF OUCBOUT='1'B THEN            /* ADDRESS SPACE OUT OF STORAGE  */ 05846000
IRARME44 TM    OUCBOUT(OUCBPTR),B'00000100'                        1383 05847000
         BNO   @RF01383                                            1383 05848000
*     DO;                           /* MAKE THE ADDRESS SPACE READY  */ 05849000
*       OUCBBIB='1'B;               /* EXPEDITE SWAP-IN PROCESSING 1385 05850000
*                                                            @Z40BPJE*/ 05851000
         OI    OUCBBIB(OUCBPTR),B'00100000'                        1385 05852000
*       IF OUCBGOO='1'B|            /* TRANSITIONING INTO OR         */ 05853000
*           OUCBGOI='1'B THEN       /* OUT OF MAIN STORAGE,  @Z40BPJE*/ 05854000
         TM    OUCBGOO(OUCBPTR),B'11000000'                        1386 05855000
         BZ    @RF01386                                            1386 05856000
*         RRPARI3=NOAUTH;           /* BRINGIN SYSEVENT UNSUCCESSFUL */ 05857000
         MVI   RRPARI3(RRPAPTR),X'08'                              1387 05858000
*       IF OUCBOFF='1'B|            /* ADDRESS SPACE ON WAIT QUEUE OR*/ 05859000
*           OUCBRDY='0'B THEN       /* ADDRESS SPACE NOT MARKED READY*/ 05860000
*                                                                  1388 05861000
@RF01386 TM    OUCBOFF(OUCBPTR),B'00001000'                        1388 05862000
         BO    @RT01388                                            1388 05863000
         TM    OUCBRDY(OUCBPTR),B'10000000'                        1388 05864000
         BNZ   @RF01388                                            1388 05865000
@RT01388 DS    0H                                                  1389 05866000
*         /***********************************************************/ 05867000
*         /*                                                         */ 05868000
*         /* FORCE READY CONDITION TO INSURE ADDRESS SPACE SWAP-IN   */ 05869000
*         /*                                                         */ 05870000
*         /***********************************************************/ 05871000
*                                                                  1389 05872000
*         DO;                                                      1389 05873000
*           OUCBRDYB='1'B;          /* ADDRESS SPACE READY           */ 05874000
         L     @12,OUCBRDYB-2(,OUCBPTR)                            1390 05875000
@GL00065 LR    @11,@12                                             1390 05876000
         O     @11,@CF02688                                        1390 05877000
         CS    @12,@11,OUCBRDYB-2(OUCBPTR)                         1390 05878000
         BNE   @GL00065                                            1390 05879000
*           ASCBOUTB='0'B;          /* PREVENT USER READY SYSEVENTS  */ 05880000
*           ASCBTLWT='0'B;          /* PREVENT WAIT TIME LIMIT CHEK  */ 05881000
*                                                                  1392 05882000
         L     @12,ASCBTLWT-2(,ASCBPTR)                            1392 05883000
@GL00066 LR    @11,@12                                             1392 05884000
         N     @11,@CF02691                                        1392 05885000
         CS    @12,@11,ASCBTLWT-2(ASCBPTR)                         1392 05886000
         BNE   @GL00066                                            1392 05887000
*           /*********************************************************/ 05888000
*           /*                                                       */ 05889000
*           /* ? IRACTLCL EPN(HIT)                                   */ 05890000
*           /*                                                       */ 05891000
*           /*********************************************************/ 05892000
*                                                                  1393 05893000
*           DO;                                                    1393 05894000
*             R1=ADDR(RMEPBHIT);    /* HIT REQUEST IS PARAM          */ 05895000
         LA    R1,RMEPBHIT(,RMCTPTR)                               1394 05896000
*             CALL RMSBCRN->IRARMRTN;/* ACTION INVK FUNCT            */ 05897000
         L     @15,RMSBCRN(,RMCTPTR)                               1395 05898000
         BALR  @14,@15                                             1395 05899000
*           END;                                                   1396 05900000
*         END;                                                     1397 05901000
*     END;                                                         1398 05902000
*   ELSE                            /* ADDRESS SPACE STILL IN STORAGE*/ 05903000
*     IF OUCBGOO='1'B THEN          /* IF SWAP-OUT HAS BEEN STARTED  */ 05904000
         B     @RC01383                                            1399 05905000
@RF01383 TM    OUCBGOO(OUCBPTR),B'10000000'                        1399 05906000
         BNO   @RF01399                                            1399 05907000
*       OUCBCTI='1'B;               /* PROHIBIT SWAP-OUT FROM      1400 05908000
*                                      COMPLETING                    */ 05909000
         OI    OUCBCTI(OUCBPTR),B'01000000'                        1400 05910000
*/*   ? IRACTLCL EPN(CTL)                                            */ 05911000
*                                                                  1401 05912000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 05913000
@RF01399 DS    0H                                                  1401 05914000
@RC01383 L     @12,RMEXCTL(,RMCTPTR)                               1401 05915000
         BR    @12                                                 1401 05916000
*IRARME45:                          /* SYSEVENT 45 - WKLDINIT        */ 05917000
*   IF(RMCTMFA='1'B|                /* DATA COLLECTION ALREADY ACTIVE*/ 05918000
*       RMCTSTW='1'B&               /* OR SET TO NEW IPS SYSEVENT  1402 05919000
*                                      OCCURRED TERMINATING DATA   1402 05920000
*                                      COLLECTION AND                */ 05921000
*       RMCTWAMT^=ZERO) THEN        /* DATA COLECTION BUFFER EXISTS  */ 05922000
IRARME45 TM    RMCTMFA(RMCTPTR),B'10000000'                        1402 05923000
         BO    @RT01402                                            1402 05924000
         TM    RMCTSTW(RMCTPTR),B'00000100'                        1402 05925000
         BNO   @RF01402                                            1402 05926000
         L     @12,RMCTWAMT(,RMCTPTR)                              1402 05927000
         LTR   @12,@12                                             1402 05928000
         BZ    @RF01402                                            1402 05929000
@RT01402 DS    0H                                                  1403 05930000
*     RRPARTC=ALRDYACT;             /* INITIALIZATION NOT PERFORMED  */ 05931000
         MVI   RRPARTC(RRPAPTR),X'20'                              1403 05932000
*   ELSE                            /* DATA COLLECTION NOT ACTIVE    */ 05933000
*     DO;                           /* INITIALIZE FOR MF/1 WORKLOAD     05934000
*                                      ACTIVITY DATA COLLECTION      */ 05935000
         B     @RC01402                                            1404 05936000
@RF01402 DS    0H                                                  1405 05937000
*       RESPECIFY                                                  1405 05938000
*         WAMTPTR RSTD;                                            1405 05939000
*       WAMTPTR=RRPAINP;            /* ADDRESSABILITY TO WAMT        */ 05940000
         L     WAMTPTR,RRPAINP(,RRPAPTR)                           1406 05941000
*       RRPAWAR='1'B;               /* WORKLOAD ACTIVITY ROUTINE IN     05942000
*                                      CONTROL FOR RECOVERY          */ 05943000
         OI    RRPAWAR(RRPAPTR),B'01000000'                        1407 05944000
*       CALL IRARMWR1;              /* INITIALIZE DATA COLLECTION  1408 05945000
*                                      BUFFER AND INITIATE WORKLOAD     05946000
*                                      ACTIVITY DATA COLLECTION      */ 05947000
         L     @12,WAMTWAR(,WAMTPTR)                               1408 05948000
         L     @15,WARTABLE(,@12)                                  1408 05949000
         BALR  @14,@15                                             1408 05950000
*       RRPAWAR='0'B;               /* WORKLOAD ACTIVITY ROUTINE NO     05951000
*                                      LONGER IN CONTROL             */ 05952000
         NI    RRPAWAR(RRPAPTR),B'10111111'                        1409 05953000
*       RESPECIFY                                                  1410 05954000
*         WAMTPTR UNRSTD;                                          1410 05955000
*     END;                                                         1411 05956000
*                                                                  1411 05957000
*   /*****************************************************************/ 05958000
*   /*                                                               */ 05959000
*   /* ? IRACTLCL EPN(CTL)                                           */ 05960000
*   /*                                                               */ 05961000
*   /*****************************************************************/ 05962000
*                                                                  1412 05963000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 05964000
*                                                                  1412 05965000
@RC01402 L     @12,RMEXCTL(,RMCTPTR)                               1412 05966000
         BR    @12                                                 1412 05967000
*   /*****************************************************************/ 05968000
*   /*                                                               */ 05969000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 05970000
*   /*                                                               */ 05971000
*   /*****************************************************************/ 05972000
*                                                                  1413 05973000
*IRARME46:                          /* SYSEVENT 46 - WKLDCOLL        */ 05974000
*   RESPECIFY                                                      1413 05975000
*    (WAMTPTR) RSTD;                                               1413 05976000
IRARME46 DS    0H                                                  1414 05977000
*   WAMTPTR=RMCTWAMT;               /* ADDRESSABILITY TO DATA      1414 05978000
*                                      COLLECTION BUFFER             */ 05979000
         L     WAMTPTR,RMCTWAMT(,RMCTPTR)                          1414 05980000
*   IF(RMCTMFA='1'B|                /* DATA COLLECTION ACTIVE OR     */ 05981000
*       RMCTSTW='1'B)&              /* SET TO NEW IPS SYSEVENT     1415 05982000
*                                      OCCURRED TERMINATING WORKLOAD    05983000
*                                      ACTIVITY DATA COLLECTION AND  */ 05984000
*       WAMTPTR^=ZERO THEN          /* DATA COLLECTION BUFFER EXISTS */ 05985000
         TM    RMCTMFA(RMCTPTR),B'10000100'                        1415 05986000
         BZ    @RF01415                                            1415 05987000
         LTR   WAMTPTR,WAMTPTR                                     1415 05988000
         BZ    @RF01415                                            1415 05989000
*     DO;                                                          1416 05990000
*       RRPAWAR='1'B;               /* WORKLOAD ACTIVITY ROUTINE IN     05991000
*                                      CONTROL FOR RECOVERY          */ 05992000
         OI    RRPAWAR(RRPAPTR),B'01000000'                        1417 05993000
*       CALL IRARMWR3;              /* COLLECT WORKLOAD ACTIVITY DATA*/ 05994000
         L     @12,WAMTWAR(,WAMTPTR)                               1418 05995000
         L     @15,WARTABLE+4(,@12)                                1418 05996000
         BALR  @14,@15                                             1418 05997000
*       RRPAWAR='0'B;               /* WORKLOAD ACTIVITY ROUTINE NO     05998000
*                                      LONGER IN CONTROL             */ 05999000
         NI    RRPAWAR(RRPAPTR),B'10111111'                        1419 06000000
*     END;                                                         1420 06001000
*   ELSE                            /* DATA COLLECTION NOT ACTIVE OR    06002000
*                                      COLLECTION BUFFER NON-EXISTANT*/ 06003000
*     RRPARTC=NOTACTVE;             /* REQUEST FOR DATA IGNORED      */ 06004000
         B     @RC01415                                            1421 06005000
@RF01415 MVI   RRPARTC(RRPAPTR),X'40'                              1421 06006000
*   RESPECIFY                                                      1422 06007000
*    (WAMTPTR) UNRSTD;                                             1422 06008000
*                                                                  1422 06009000
@RC01415 DS    0H                                                  1423 06010000
*   /*****************************************************************/ 06011000
*   /*                                                               */ 06012000
*   /* ? IRACTLCL EPN(CTL)                                           */ 06013000
*   /*                                                               */ 06014000
*   /*****************************************************************/ 06015000
*                                                                  1423 06016000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 06017000
*                                                                  1423 06018000
         L     @12,RMEXCTL(,RMCTPTR)                               1423 06019000
         BR    @12                                                 1423 06020000
*   /*****************************************************************/ 06021000
*   /*                                                               */ 06022000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 06023000
*   /*                                                               */ 06024000
*   /*****************************************************************/ 06025000
*                                                                  1424 06026000
*IRARME47:                          /* SYSEVENT 47 - WKLDTERM        */ 06027000
*   IF(RMCTMFA='1'B|                /* DATA COLLECTION ACTIVE OR     */ 06028000
*       RMCTSTW='1'B)&              /* SET TO NEW IPS SYSEVENT     1424 06029000
*                                      OCCURRED TERMINATING WORKLOAD    06030000
*                                      ACTIVITY DATA COLLECTION AND  */ 06031000
*       RMCTWAMT^=ZERO THEN         /* DATA COLLECTION BUFFER EXISTS */ 06032000
IRARME47 TM    RMCTMFA(RMCTPTR),B'10000100'                        1424 06033000
         BZ    @RF01424                                            1424 06034000
         SLR   @12,@12                                             1424 06035000
         L     @11,RMCTWAMT(,RMCTPTR)                              1424 06036000
         CR    @11,@12                                             1424 06037000
         BE    @RF01424                                            1424 06038000
*     DO;                           /* TERMINATE WORKLOAD ACTIVITY 1425 06039000
*                                      DATA COLLECTION               */ 06040000
*       RMCTMFA='0'B;               /* DEACTIVATE DATA COLLECTION    */ 06041000
*       RMCTSTW='0'B;               /* TURN OFF INDICATOR            */ 06042000
         NI    RMCTMFA(RMCTPTR),B'01111011'                        1427 06043000
*       RRPAINP=RMCTWAMT;           /* RETURN ADDRESS OF WORKLOAD  1428 06044000
*                                      COLLECTION BUFFER             */ 06045000
         ST    @11,RRPAINP(,RRPAPTR)                               1428 06046000
*       RMCTWAMT=ZERO;              /* CLEAR BUFFER ADDRESS          */ 06047000
         ST    @12,RMCTWAMT(,RMCTPTR)                              1429 06048000
*       RMSBWR4=RMSBNOP;            /* RESET PERIOD ACCUML RTN ADDR  */ 06049000
         L     @12,RMSBNOP(,RMCTPTR)                               1430 06050000
         ST    @12,RMSBWR4(,RMCTPTR)                               1430 06051000
*       RMSBWR6=RMSBNOP;            /* RESET XACTN END CNT RTN ADDR  */ 06052000
         ST    @12,RMSBWR6(,RMCTPTR)                               1431 06053000
*       RRPARTC=ZERO;               /* WAR TERMINATION COMPLETE      */ 06054000
         MVI   RRPARTC(RRPAPTR),X'00'                              1432 06055000
*     END;                                                         1433 06056000
*   ELSE                            /* DATA COLLECTION NOT ACTIVE OR    06057000
*                                      COLLECTION BUFFER NON-EXISTANT*/ 06058000
*     RRPARTC=NOTACTVE;             /* TERMINATION REQUEST IGNORED   */ 06059000
*                                                                  1434 06060000
         B     @RC01424                                            1434 06061000
@RF01424 MVI   RRPARTC(RRPAPTR),X'40'                              1434 06062000
*   /*****************************************************************/ 06063000
*   /*                                                               */ 06064000
*   /* ? IRACTLCL EPN(CTL)                                           */ 06065000
*   /*                                                               */ 06066000
*   /*****************************************************************/ 06067000
*                                                                  1435 06068000
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */ 06069000
*                                                                  1435 06070000
@RC01424 L     @12,RMEXCTL(,RMCTPTR)                               1435 06071000
         BR    @12                                                 1435 06072000
*   /*****************************************************************/ 06073000
*   /*                                                               */ 06074000
*   /* ENTER SRM CONTROL ROUTINE                                     */ 06075000
*   /*                                                               */ 06076000
*   /*****************************************************************/ 06077000
*                                                                  1436 06078000
*IRARME48:                          /* SYSEVENT 48 - INTERNAL EVENT  */ 06079000
*   RESPECIFY                                                      1436 06080000
*     SRBPTR RSTD;                                                 1436 06081000
IRARME48 DS    0H                                                  1437 06082000
*   IF RRPASVC='0'B&                /* IF BRANCH ENTRY AND           */ 06083000
*       RRPAKEY=ZERO THEN           /* INVOKER IN STORAGE KEY ZERO,  */ 06084000
         TM    RRPASVC(RRPAPTR),B'00100000'                        1437 06085000
         BNZ   @RF01437                                            1437 06086000
         CLI   RRPAKEY(RRPAPTR),0                                  1437 06087000
         BNE   @RF01437                                            1437 06088000
*     DO;                                                          1438 06089000
*       RRPASVC='1'B;                                              1439 06090000
*       RRPAENB='0'B;                                              1440 06091000
*       RRPADSB='0'B;                                              1441 06092000
         OI    RRPASVC(RRPAPTR),B'00100000'                        1441 06093000
         NI    RRPAENB(RRPAPTR),B'00111111'                        1441 06094000
*       SRBPTR=RRPAINP;             /* SRB ADDRESS                   */ 06095000
         L     SRBPTR,RRPAINP(,RRPAPTR)                            1442 06096000
*       SRBPARM=ZERO;               /* ALLOW SRM SRB TO BE         1443 06097000
*                                      RESCHEDULED                   */ 06098000
*                                                                  1443 06099000
         SLR   @12,@12                                             1443 06100000
         ST    @12,SRBPARM(,SRBPTR)                                1443 06101000
*       /*************************************************************/ 06102000
*       /*                                                           */ 06103000
*       /* ? IRACTLCL EPN(CTL)                                       */ 06104000
*       /*                                                           */ 06105000
*       /*************************************************************/ 06106000
*                                                                  1444 06107000
*       GOTO RMEXCTL->IRARMNTR;     /* EXIT TO CTL FUNCT             */ 06108000
*                                                                  1444 06109000
         L     @12,RMEXCTL(,RMCTPTR)                               1444 06110000
         BR    @12                                                 1444 06111000
*       /*************************************************************/ 06112000
*       /*                                                           */ 06113000
*       /* ENTER SRM CONTROL ROUTINE                                 */ 06114000
*       /*                                                           */ 06115000
*       /*************************************************************/ 06116000
*                                                                  1445 06117000
*     END;                                                         1445 06118000
*   ELSE                            /* INVALID INVOCATION            */ 06119000
*     DO;                           /* INDICATE UNAUTHORIZED PROGRAM */ 06120000
@RF01437 DS    0H                                                  1447 06121000
*       RESNCODE=CON8;              /* ABEND REASON CODE             */ 06122000
*                                                                  1447 06123000
         LA    RESNCODE,8                                          1447 06124000
*       /*************************************************************/ 06125000
*       /*                                                           */ 06126000
*       /* ? IRACTLCL EPN(I10)                                       */ 06127000
*       /*                                                           */ 06128000
*       /*************************************************************/ 06129000
*                                                                  1448 06130000
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */ 06131000
         L     @15,RMSBI10(,RMCTPTR)                               1448 06132000
         BALR  @14,@15                                             1448 06133000
*     END;                          /*                               */ 06134000
*   RESPECIFY                                                      1450 06135000
*     SRBPTR UNRSTD;                                               1450 06136000
*IRARME49:                          /* SYSEVENT 49 - REQSVDAT      1451 06137000
*                                                            @ZM43092*/ 06138000
*/*                                                          @ZM43092*/ 06139000
*/*   REQUEST BY SMF FOR USER SERVICE DATA.                  @ZM43092*/ 06140000
*/*                                                          @ZM43092*/ 06141000
*                                                                  1451 06142000
*   RFY                                                            1451 06143000
*    (R0,                                                          1451 06144000
*     RTNREG,                                                      1451 06145000
*     NTRREG) UNRSTD;               /*                       @ZM43092*/ 06146000
IRARME49 DS    0H                                                  1452 06147000
*   RQSVDATA=''B;                   /* ZERO COLLECTION AREA  @ZM43092*/ 06148000
         L     @14,RQSVPTR(,RMCTPTR)                               1452 06149000
         XC    RQSVDATA(16,@14),RQSVDATA(@14)                      1452 06150000
*   IF OUCBINV='0'B&                /* MEMORY IS VALID       @ZM43092*/ 06151000
*       OUCBDTA='0'B&               /* USER DATA VALID       @ZM43092*/ 06152000
*       OUCBOUT='0'B THEN           /* MEMORY IN CORE        @ZM43092*/ 06153000
         TM    OUCBINV(OUCBPTR),B'00010000'                        1453 06154000
         BNZ   @RF01453                                            1453 06155000
         TM    OUCBDTA(OUCBPTR),B'00000010'                        1453 06156000
         BNZ   @RF01453                                            1453 06157000
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1453 06158000
         BNZ   @RF01453                                            1453 06159000
*     DO;                           /* COLLECT DATA          @ZM43092*/ 06160000
*       RFY                                                        1455 06161000
*         OUXBPTR RSTD;             /* HOLD THIS REG.        @ZM43092*/ 06162000
*       OUXBPTR=ASCBOUXB;           /* DATA ADDRESSABILITY   @ZM43092*/ 06163000
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1456 06164000
*       RQSVSRV=OUXBJBS+OUXBTRS;    /* SRV TO LAST SWAP-IN   @ZM43092*/ 06165000
         L     @12,OUXBJBS(,OUXBPTR)                               1457 06166000
         AL    @12,OUXBTRS(,OUXBPTR)                               1457 06167000
         ST    @12,RQSVSRV(,@14)                                   1457 06168000
*       RQSVTIM=OUXBJBT+OUXBTRT;    /* TRANSACTION ACTIVE TIME TO  1458 06169000
*                                      LAST SWAP-IN          @ZM43092*/ 06170000
         L     @12,OUXBJBT(,OUXBPTR)                               1458 06171000
         AL    @12,OUXBTRT(,OUXBPTR)                               1458 06172000
         ST    @12,RQSVTIM(,@14)                                   1458 06173000
*       RQSVSRT=OUXBJBR+OUXBTRR;    /* SESSION RESIDENCY TIME      1459 06174000
*                                                            @ZA14216*/ 06175000
         L     @12,OUXBJBR(,OUXBPTR)                               1459 06176000
         AL    @12,OUXBTRR(,OUXBPTR)                               1459 06177000
         ST    @12,RQSVSRT(,@14)                                   1459 06178000
*       RQSVPGN=OUCBNPG;            /* LAST PGN FOR MEMORY   @ZM43092*/ 06179000
         SLR   @12,@12                                             1460 06180000
         IC    @12,OUCBNPG(,OUCBPTR)                               1460 06181000
         STH   @12,RQSVPGN(,@14)                                   1460 06182000
*       IF OUCBLOG='1'B             /* FOR TSO USER, GET     @ZM43092*/ 06183000
*         THEN                                                     1461 06184000
         TM    OUCBLOG(OUCBPTR),B'00100000'                        1461 06185000
         BNO   @RF01461                                            1461 06186000
*         RQSVTRC=OUXBTRC;          /* TRANSACTION COUNT     @ZM43092*/ 06187000
         L     @12,OUXBTRC(,OUXBPTR)                               1462 06188000
         STH   @12,RQSVTRC(,@14)                                   1462 06189000
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL      1463 06190000
*                                                            @ZM43092*/ 06191000
@RF01461 TM    OUCBINC(OUCBPTR),B'00000001'                        1463 06192000
         BNO   @RF01463                                            1463 06193000
*         DO;                       /* GET THIS INTERVAL DATA      1464 06194000
*                                                            @ZM43092*/ 06195000
*                                                                  1464 06196000
*           /*********************************************************/ 06197000
*           /*                                                       */ 06198000
*           /* ? IRACTLCL EPN(WM1)                                   */ 06199000
*           /*                                                       */ 06200000
*           /*********************************************************/ 06201000
*                                                                  1465 06202000
*           CALL RMSBWM1->IRARMRTN; /* INVOKE WM1 SUBRTN             */ 06203000
         L     @15,RMSBWM1(,RMCTPTR)                               1465 06204000
         BALR  @14,@15                                             1465 06205000
*           RQSVSRV=RQSVSRV+OUCBWMS;/* SERVICE THIS INTERVAL @ZM43092*/ 06206000
         L     @14,RQSVPTR(,RMCTPTR)                               1466 06207000
         L     @12,RQSVSRV(,@14)                                   1466 06208000
         AL    @12,OUCBWMS(,OUCBPTR)                               1466 06209000
         ST    @12,RQSVSRV(,@14)                                   1466 06210000
*           RQSVTIM=RQSVTIM+        /* TRANSACTION ACTIVE    @ZM43092*/ 06211000
*               (RMCTTOD-OUCBTMS);  /* TIME THIS INTERVAL    @ZM43092*/ 06212000
         L     @12,RMCTTOD(,RMCTPTR)                               1467 06213000
         SL    @12,OUCBTMS(,OUCBPTR)                               1467 06214000
         L     @07,RQSVTIM(,@14)                                   1467 06215000
         ALR   @07,@12                                             1467 06216000
         ST    @07,RQSVTIM(,@14)                                   1467 06217000
*           RQSVSRT=RQSVSRT+(RMCTTOD-OUCBTMS);/* SESSION RESIDENCY 1468 06218000
*                                      TIME INCLUDING THIS INTERVAL     06219000
*                                                            @ZA14216*/ 06220000
         AL    @12,RQSVSRT(,@14)                                   1468 06221000
         ST    @12,RQSVSRT(,@14)                                   1468 06222000
*         END;                      /*                       @ZM43092*/ 06223000
*       RRPARTC=OK;                 /* REQUEST SUCCESSFUL    @ZM43092*/ 06224000
@RF01463 MVI   RRPARTC(RRPAPTR),X'00'                              1470 06225000
*       RFY                                                        1471 06226000
*         OUXBPTR UNRSTD;           /* FREE UP THIS REG.     @ZM43092*/ 06227000
*     END;                          /*                       @ZM43092*/ 06228000
*   ELSE                            /*                       @ZM43092*/ 06229000
*     RRPARTC=INVLDATA;             /* REQUEST IGNORED       @ZM43092*/ 06230000
         B     @RC01453                                            1473 06231000
@RF01453 MVI   RRPARTC(RRPAPTR),X'04'                              1473 06232000
*/*                                                          @ZM43092*/ 06233000
*/* GET INTO THE APPROPRIATE KEY TO STORE THE DATA           @ZM43092*/ 06234000
*/*  THAT HAS BEEN GATHERED.                                 @ZM43092*/ 06235000
*/* IF THE REQUEST WAS INVALID, ZEROES ARE RETURNED.         @ZM43092*/ 06236000
*/*                                                          @ZM43092*/ 06237000
*                                                                  1474 06238000
*   IF RRPASVC='0'B THEN            /* FOR BRANCH ENTRY,     @ZM43092*/ 06239000
@RC01453 TM    RRPASVC(RRPAPTR),B'00100000'                        1474 06240000
         BNZ   @RF01474                                            1474 06241000
*     DO;                           /*                       @ZM43092*/ 06242000
*       MODESETR=RRPAKEY;           /* GET SAVED KEY         @ZM43092*/ 06243000
         SLR   MODESETR,MODESETR                                   1476 06244000
         IC    MODESETR,RRPAKEY(,RRPAPTR)                          1476 06245000
*       SPKA(MODESETR);             /* AND SET PSW KEY.      @ZM43092*/ 06246000
         SPKA  0(MODESETR)                                         1477 06247000
*     END;                          /*                       @ZM43092*/ 06248000
*   ELSE                                                           1479 06249000
*     DO;                           /* FOR SVC ENTRY, USE THE      1479 06250000
*                                                            @ZM43092*/ 06251000
         B     @RC01474                                            1479 06252000
@RF01474 DS    0H                                                  1480 06253000
*       R1=PSATOLD;                 /* CURRENT TCB KEY       @ZM43092*/ 06254000
         L     R1,PSATOLD                                          1480 06255000
*       GENERATE;                                                  1481 06256000
     USING TCB,R1                                                       06257000
     MODESET EXTKEY=RBT1,WORKREG=10                                     06258000
*     END;                          /*                       @ZM43092*/ 06259000
*/*                                                          @ZM43092*/ 06260000
*/*   NOW STORE THE SERVICE DATA IN SMF'S AREA.              @ZM43092*/ 06261000
*/*                                                          @ZM43092*/ 06262000
*                                                                  1483 06263000
*   REQSPARM=RQSVDATA;              /* COPY DATA             @ZM43092*/ 06264000
@RC01474 L     @14,RRPAINP(,RRPAPTR)                               1483 06265000
         L     @12,RQSVPTR(,RMCTPTR)                               1483 06266000
         MVC   REQSPARM(16,@14),RQSVDATA(@12)                      1483 06267000
*   GENERATE;                                                      1484 06268000
*                                                                  1484 06269000
*                                 /* GET BACK TO SRM KEY    @ZM43092*/  06270000
   MODESET EXTKEY=SRM                                                   06271000
*   /*****************************************************************/ 06272000
*   /*                                                               */ 06273000
*   /* ? IRACTLCL EPN(I01)                                           */ 06274000
*   /*                                                               */ 06275000
*   /*****************************************************************/ 06276000
*                                                                  1485 06277000
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */ 06278000
         L     @14,RMEXI01(,RMCTPTR)                               1485 06279000
         BR    @14                                                 1485 06280000
*   RFY                                                            1486 06281000
*    (R0,                                                          1486 06282000
*     RTNREG,                                                      1486 06283000
*     NTRREG) RSTD;                 /*                       @ZM43092*/ 06284000
*   END IRARMEVT                                                   1487 06285000
*                                                                  1487 06286000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06287000
*/*%INCLUDE SYSLIB  (IRACNSMP)                                       */ 06288000
*/*%INCLUDE SYSLIB  (IRARMCT )                                       */ 06289000
*/*%INCLUDE SYSLIB  (IRACCT  )                                       */ 06290000
*/*%INCLUDE SYSLIB  (IRAICT  )                                       */ 06291000
*/*%INCLUDE SYSLIB  (IRAMCT  )                                       */ 06292000
*/*%INCLUDE SYSLIB  (IRARCT  )                                       */ 06293000
*/*%INCLUDE SYSLIB  (IRARMPT )                                       */ 06294000
*/*%INCLUDE SYSLIB  (IRARMCA )                                       */ 06295000
*/*%INCLUDE SYSLIB  (IRARMEX )                                       */ 06296000
*/*%INCLUDE SYSLIB  (IRARMSB )                                       */ 06297000
*/*%INCLUDE SYSLIB  (IRAEPAT )                                       */ 06298000
*/*%INCLUDE SYSLIB  (IRAEPDT )                                       */ 06299000
*/*%INCLUDE SYSLIB  (IRAEPST )                                       */ 06300000
*/*%INCLUDE SYSLIB  (IRARRPA )                                       */ 06301000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 06302000
*/*%INCLUDE SYSLIB  (IRAOUCB )                                       */ 06303000
*/*%INCLUDE SYSLIB  (IHAOUXB )                                       */ 06304000
*/*%INCLUDE SYSLIB  (IHAOUSB )                                       */ 06305000
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */ 06306000
*/*%INCLUDE SYSLIB  (IRARMEP )                                       */ 06307000
*/*%INCLUDE SYSLIB  (IRAWMST )                                       */ 06308000
*/*%INCLUDE SYSLIB  (IRAWPGDT)                                       */ 06309000
*/*%INCLUDE SYSLIB  (IRAWAMT )                                       */ 06310000
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */ 06311000
*/*%INCLUDE SYSLIB  (IRARQSRV)                                       */ 06312000
*/*%INCLUDE SYSLIB  (IRASRCD )                                       */ 06313000
*/*%INCLUDE SYSLIB  (IRADMDT )                                       */ 06314000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 06315000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 06316000
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */ 06317000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 06318000
*/*%INCLUDE SYSLIB  (IHACSD  )                                       */ 06319000
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */ 06320000
*/*%INCLUDE SYSLIB  (IFASMFR1)                                       */ 06321000
*/*%INCLUDE SYSLIB  (IFASMFR2)                                       */ 06322000
*/*%INCLUDE SYSLIB  (IFASMFR3)                                       */ 06323000
*/*%INCLUDE SYSLIB  (IFASMFR4)                                       */ 06324000
*/*%INCLUDE SYSLIB  (IFASMFR5)                                       */ 06325000
*/*%INCLUDE SYSLIB  (IFASMFR6)                                       */ 06326000
*/*%INCLUDE SYSLIB  (IFASMFR7)                                       */ 06327000
*/*%INCLUDE SYSLIB  (IFASMFR8)                                       */ 06328000
*/*%INCLUDE SYSLIB  (IFASMFR9)                                       */ 06329000
*/*%INCLUDE SYSLIB  (IFASMFRA)                                       */ 06330000
*/*%INCLUDE SYSLIB  (IFASMFRB)                                       */ 06331000
*/*%INCLUDE SYSLIB  (IFASMFRC)                                       */ 06332000
*/*%INCLUDE SYSLIB  (IFASMFRD)                                       */ 06333000
*/*%INCLUDE SYSLIB  (IRAREGS )                                       */ 06334000
*                                                                  1487 06335000
*       ;                                                          1487 06336000
@DATA    DS    0H                                                       06337000
@CH02633 DC    H'20'                                                    06338000
@CH02502 DC    H'32767'                                                 06339000
         DS    0F                                                       06340000
@TF00001 DS    F                                                        06341000
         DS    0F                                                       06342000
@CF00078 DC    F'1'                                                     06343000
@CH00078 EQU   @CF00078+2                                               06344000
@CF00152 DC    F'8'                                                     06345000
@CF02432 DC    F'36'                                                    06346000
@CF02685 DC    F'-4'                                                    06347000
@CF02678 DC    XL4'0000FFFF'                                            06348000
@CF02688 DC    BL4'00000000000000001000000000000000'                    06349000
@CF02691 DC    BL4'11111111111111111111100111111111'                    06350000
@CF02698 DC    BL4'00011111111111111111111111111111'                    06351000
@CF02704 DC    BL4'11111111111111111111101111111111'                    06352000
@CF02707 DC    BL4'11000000000000000000000000000000'                    06353000
@CF02710 DC    BL4'01000000000000000000000000000000'                    06354000
@CF02713 DC    BL4'00000000000000000100000000000000'                    06355000
@CF02717 DC    BL4'11111111111111110011111111111111'                    06356000
@CV02272 DC    V(IRARMI01)                                              06357000
@CV02294 DC    V(IRARME28)                                              06358000
@CV02508 DC    V(IRARMEPS)                                              06359000
         DS    0D                                                       06360000
WPGLPTR  DS    A                                                        06361000
WAMPPTR  DS    A                                                        06362000
MINSET   DC    AL1(0)                                                   06363000
MAXSET   DC    AL1(0)                                                   06364000
@CC02562 DC    C'OUXB'                                                  06365000
         DS    CL2                                                      06366000
CHAPLIST DS    CL8                                                      06367000
         ORG   CHAPLIST                                                 06368000
CHAPFLAG DC    X'80'                                                    06369000
@NM00041 DC    X'0000'                                                  06370000
CHAPDP   DS    FL1                                                      06371000
CHAPASCB DS    AL4                                                      06372000
         ORG   CHAPLIST+8                                               06373000
IRAPRCSR DC    AL4(IRARME01)                                            06374000
         DC    AL4(IRARME02)                                            06375000
         DC    AL4(IRARME03)                                            06376000
         DC    AL4(IRARME04)                                            06377000
         DC    VL4(IRARMI01)                                            06378000
         DC    AL4(IRARME06)                                            06379000
         DC    AL4(IRARME07)                                            06380000
         DC    AL4(IRARME08)                                            06381000
         DC    AL4(IRARME09)                                            06382000
         DC    AL4(IRARME10)                                            06383000
         DC    AL4(IRARME11)                                            06384000
         DC    AL4(IRARME12)                                            06385000
         DC    AL4(IRARME13)                                            06386000
         DC    AL4(IRARME14)                                            06387000
         DC    AL4(IRARME15)                                            06388000
         DC    AL4(IRARME16)                                            06389000
         DC    AL4(IRARME17)                                            06390000
         DC    AL4(IRARME18)                                            06391000
         DC    AL4(IRARME19)                                            06392000
         DC    AL4(IRARME20)                                            06393000
         DC    AL4(IRARME21)                                            06394000
         DC    AL4(IRARME22)                                            06395000
         DC    AL4(IRARME23)                                            06396000
         DC    AL4(IRARME24)                                            06397000
         DC    AL4(IRARME25)                                            06398000
         DC    AL4(IRARME26)                                            06399000
         DC    VL4(IRARMI01)                                            06400000
         DC    VL4(IRARME28)                                            06401000
         DC    AL4(IRARME29)                                            06402000
         DC    AL4(IRARME30)                                            06403000
         DC    AL4(IRARME31)                                            06404000
         DC    AL4(IRARME32)                                            06405000
         DC    AL4(IRARME33)                                            06406000
         DC    AL4(IRARME34)                                            06407000
         DC    VL4(IRARMI01)                                            06408000
         DC    VL4(IRARMI01)                                            06409000
         DC    AL4(IRARME37)                                            06410000
         DC    AL4(IRARME38)                                            06411000
         DC    AL4(IRARME39)                                            06412000
         DC    AL4(IRARME40)                                            06413000
         DC    AL4(IRARME41)                                            06414000
         DC    AL4(IRARME42)                                            06415000
         DC    AL4(IRARME43)                                            06416000
         DC    AL4(IRARME44)                                            06417000
         DC    AL4(IRARME45)                                            06418000
         DC    AL4(IRARME46)                                            06419000
         DC    AL4(IRARME47)                                            06420000
         DC    AL4(IRARME48)                                            06421000
         DC    AL4(IRARME49)                                            06422000
IRARMEVT CSECT                                                          06423000
*                                  /*                                   06424000
         IHARB                                                          06425000
         IKJTCB                                                         06426000
IRARMEVT CSECT                                                          06427000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06428000
@01      EQU   01                                                       06429000
@02      EQU   02                                                       06430000
@03      EQU   03                                                       06431000
@04      EQU   04                                                       06432000
@05      EQU   05                                                       06433000
@06      EQU   06                                                       06434000
@07      EQU   07                                                       06435000
@08      EQU   08                                                       06436000
@09      EQU   09                                                       06437000
@10      EQU   10                                                       06438000
@11      EQU   11                                                       06439000
@12      EQU   12                                                       06440000
@13      EQU   13                                                       06441000
@14      EQU   14                                                       06442000
@15      EQU   15                                                       06443000
ECBPARM  EQU   @11                                                      06444000
WPGPPTR  EQU   @11                                                      06445000
BASE1    EQU   @08                                                      06446000
BASE2    EQU   @09                                                      06447000
RMCTPTR  EQU   @02                                                      06448000
RRPAPTR  EQU   @03                                                      06449000
ASCBPTR  EQU   @05                                                      06450000
OUCBPTR  EQU   @04                                                      06451000
OUXBPTR  EQU   @06                                                      06452000
OUSBPTR  EQU   @07                                                      06453000
RMEPPTR  EQU   @07                                                      06454000
WAMTPTR  EQU   @06                                                      06455000
DMDTPTR  EQU   @07                                                      06456000
SRBPTR   EQU   @10                                                      06457000
R0       EQU   @00                                                      06458000
R1       EQU   @01                                                      06459000
SVEREG   EQU   @13                                                      06460000
RTNREG   EQU   @14                                                      06461000
NTRREG   EQU   @15                                                      06462000
RTNCOD   EQU   @15                                                      06463000
RTNREG1  EQU   @04                                                      06464000
RTNREG2  EQU   @05                                                      06465000
RTNREG3  EQU   @06                                                      06466000
ENQJST1  EQU   @06                                                      06467000
ENQJST2  EQU   @07                                                      06468000
RMCTSAVE EQU   @06                                                      06469000
RRPASAVE EQU   @07                                                      06470000
COPYTARG EQU   @06                                                      06471000
COPYLNG  EQU   @07                                                      06472000
COPYSRC  EQU   @10                                                      06473000
COPYLGTH EQU   @11                                                      06474000
EJST1    EQU   @10                                                      06475000
WRKREG2  EQU   @10                                                      06476000
DMDTPTR2 EQU   @10                                                      06477000
EJST2    EQU   @11                                                      06478000
SERVICE  EQU   @11                                                      06479000
TRNTIME  EQU   @12                                                      06480000
RETNCODE EQU   @15                                                      06481000
MODESETR EQU   @15                                                      06482000
RESNCODE EQU   @00                                                      06483000
COMPCODE EQU   @01                                                      06484000
I        EQU   @12                                                      06485000
PCSAVE   EQU   @07                                                      06486000
AVQNEWAT EQU   @07                                                      06487000
AVQNEWBT EQU   @06                                                      06488000
AVQOLDAT EQU   @05                                                      06489000
AVQOLDBT EQU   @04                                                      06490000
MSNEWCT  EQU   @07                                                      06491000
MSOLDCT  EQU   @06                                                      06492000
RSMDELTA EQU   @06                                                      06493000
RTNREG4  EQU   @07                                                      06494000
SWPCNT   EQU   @11                                                      06495000
WRKREG3  EQU   @11                                                      06496000
         ENTRY IRAPRCSR                                                 06497000
         ENTRY IRARMXPS                                                 06498000
PSA      EQU   0                                                        06499000
FLCRNPSW EQU   PSA                                                      06500000
FLCROPSW EQU   PSA+8                                                    06501000
FLCICCW2 EQU   PSA+16                                                   06502000
FLCCVT   EQU   FLCICCW2                                                 06503000
PSAEEPSW EQU   PSA+132                                                  06504000
PSAESPSW EQU   PSA+136                                                  06505000
FLCSVILC EQU   PSAESPSW+1                                               06506000
PSAEPPSW EQU   PSA+140                                                  06507000
FLCPIILC EQU   PSAEPPSW+1                                               06508000
FLCPICOD EQU   PSAEPPSW+2                                               06509000
PSAPICOD EQU   FLCPICOD+1                                               06510000
FLCTEA   EQU   PSAEPPSW+4                                               06511000
FLCPER   EQU   PSA+152                                                  06512000
FLCMCLA  EQU   PSA+168                                                  06513000
FLCIOEL  EQU   FLCMCLA+4                                                06514000
FLCIOA   EQU   FLCMCLA+16                                               06515000
FLCFSA   EQU   FLCMCLA+80                                               06516000
PSATOLD  EQU   PSA+540                                                  06517000
PSAAOLD  EQU   PSA+548                                                  06518000
PSASUPER EQU   PSA+552                                                  06519000
PSASUP1  EQU   PSASUPER                                                 06520000
PSASUP2  EQU   PSASUPER+1                                               06521000
PSASUP3  EQU   PSASUPER+2                                               06522000
PSASUP4  EQU   PSASUPER+3                                               06523000
PSACLHT  EQU   PSA+640                                                  06524000
PSALKSA  EQU   PSA+696                                                  06525000
PSAHLHI  EQU   PSA+760                                                  06526000
PSADSSFL EQU   PSA+836                                                  06527000
PSADSSF1 EQU   PSADSSFL                                                 06528000
PSADSSF3 EQU   PSADSSFL+2                                               06529000
PSADSSF4 EQU   PSADSSFL+3                                               06530000
PSARSVT  EQU   PSA+896                                                  06531000
RMCT     EQU   0                                                        06532000
RMCTWMST EQU   RMCT+24                                                  06533000
RMCTRMSA EQU   RMCT+32                                                  06534000
RMCTWAST EQU   RMCT+84                                                  06535000
RMCTWAMT EQU   RMCT+88                                                  06536000
RMCTTBS  EQU   RMCT+120                                                 06537000
RMCTTOD  EQU   RMCT+124                                                 06538000
RMCTRQSV EQU   RMCT+144                                                 06539000
RMCTFLGS EQU   RMCT+148                                                 06540000
RMCTMFA  EQU   RMCTFLGS                                                 06541000
RMCTSTW  EQU   RMCTFLGS                                                 06542000
RMCTOUCB EQU   RMCT+168                                                 06543000
RMCTOUXB EQU   RMCT+172                                                 06544000
RMCTDMDT EQU   RMCT+180                                                 06545000
RMCTDMNC EQU   RMCT+188                                                 06546000
CCT      EQU   RMCT+192                                                 06547000
CCCAPBDP EQU   CCT+36                                                   06548000
CCCAPMDP EQU   CCT+40                                                   06549000
CCCAPGDP EQU   CCT+42                                                   06550000
CCVENQCT EQU   CCT+120                                                  06551000
CCVCPUCT EQU   CCT+122                                                  06552000
CCTFLG1  EQU   CCT+124                                                  06553000
ICT      EQU   RMCT+320                                                 06554000
ICCHIUTH EQU   ICT+38                                                   06555000
ICCLOUTH EQU   ICT+40                                                   06556000
ICCDAUTH EQU   ICT+42                                                   06557000
ICCINHIT EQU   ICT+44                                                   06558000
ICCINLOT EQU   ICT+48                                                   06559000
ICCINDAT EQU   ICT+52                                                   06560000
ICTFLAGS EQU   ICT+84                                                   06561000
MCT      EQU   RMCT+408                                                 06562000
MCTSFLGS EQU   MCT+64                                                   06563000
MCTSQA1  EQU   MCTSFLGS                                                 06564000
MCTSQA2  EQU   MCTSFLGS                                                 06565000
MCTAVQ1  EQU   MCTSFLGS                                                 06566000
MCTFAVQ  EQU   MCTSFLGS                                                 06567000
MCTOFLGS EQU   MCT+65                                                   06568000
MCTASM1  EQU   MCTOFLGS                                                 06569000
RCT      EQU   RMCT+504                                                 06570000
RMPT     EQU   RMCT+592                                                 06571000
RMCA     EQU   RMCT+664                                                 06572000
RMCAINUS EQU   RMCA+6                                                   06573000
RMCAFLGS EQU   RMCA+36                                                  06574000
RMCALGPG EQU   RMCA+72                                                  06575000
RMCABCPG EQU   RMCA+73                                                  06576000
RMCAMAS  EQU   RMCA+76                                                  06577000
RMCACIUS EQU   RMCA+118                                                 06578000
RMCASRC  EQU   RMCA+124                                                 06579000
RMEX     EQU   RMCT+832                                                 06580000
RMEPBEVT EQU   RMEX                                                     06581000
RMEPBCTL EQU   RMEX+16                                                  06582000
RMEXCTL  EQU   RMEPBCTL                                                 06583000
RMEXI01  EQU   RMEX+32                                                  06584000
RMEXCET  EQU   RMEX+40                                                  06585000
RMSB     EQU   RMCT+896                                                 06586000
RMSBI02  EQU   RMSB                                                     06587000
RMSBI04  EQU   RMSB+8                                                   06588000
RMSBI06  EQU   RMSB+16                                                  06589000
RMSBI10  EQU   RMSB+32                                                  06590000
RMSBCRL  EQU   RMSB+36                                                  06591000
RMSBCRN  EQU   RMSB+40                                                  06592000
RMSBCRY  EQU   RMSB+44                                                  06593000
RMSBWM1  EQU   RMSB+52                                                  06594000
RMSBWMK  EQU   RMSB+60                                                  06595000
RMSBWMN  EQU   RMSB+64                                                  06596000
RMSBWMO  EQU   RMSB+68                                                  06597000
RMSBWMQ  EQU   RMSB+72                                                  06598000
RMSBWMR  EQU   RMSB+76                                                  06599000
RMSBWMY  EQU   RMSB+80                                                  06600000
RMSBWR4  EQU   RMSB+88                                                  06601000
RMSBWR6  EQU   RMSB+92                                                  06602000
RMSBSET  EQU   RMSB+96                                                  06603000
RMSBNOP  EQU   RMSB+100                                                 06604000
RMSBCL0  EQU   RMSB+108                                                 06605000
RMSBIL0  EQU   RMSB+112                                                 06606000
EPAT     EQU   RMCT+1016                                                06607000
RMEPBCAP EQU   EPAT                                                     06608000
RMEPBSQA EQU   EPAT+96                                                  06609000
RMEPBMS2 EQU   EPAT+160                                                 06610000
EPDT     EQU   RMCT+1416                                                06611000
RMEPBIPS EQU   EPDT                                                     06612000
RMEPBDEL EQU   EPDT+16                                                  06613000
RMEPBIL4 EQU   EPDT+32                                                  06614000
RMEPBUXB EQU   EPDT+48                                                  06615000
RMEPBHIT EQU   EPDT+64                                                  06616000
RMEPBRPS EQU   EPDT+80                                                  06617000
EPST     EQU   RMCT+1512                                                06618000
RMEPBWM3 EQU   EPST                                                     06619000
RMEPBIL3 EQU   EPST+16                                                  06620000
RMEPBCL3 EQU   EPST+32                                                  06621000
RMEPBCSO EQU   EPST+48                                                  06622000
RMEPBCSI EQU   EPST+64                                                  06623000
RRPA     EQU   0                                                        06624000
RRPAINC  EQU   RRPA                                                     06625000
RRPAASD  EQU   RRPAINC                                                  06626000
RRPAVPGN EQU   RRPAINC+2                                                06627000
RRPAFLG0 EQU   RRPAVPGN                                                 06628000
RRPANSWI EQU   RRPAFLG0                                                 06629000
RRPACOD  EQU   RRPAINC+3                                                06630000
RRPAINP  EQU   RRPA+4                                                   06631000
RRPAFLG  EQU   RRPA+8                                                   06632000
RRPADSB  EQU   RRPAFLG                                                  06633000
RRPAENB  EQU   RRPAFLG                                                  06634000
RRPASVC  EQU   RRPAFLG                                                  06635000
RRPAWAR  EQU   RRPAFLG+1                                                06636000
RRPAIPS  EQU   RRPAFLG+1                                                06637000
RRPAKEY  EQU   RRPA+10                                                  06638000
RRPARTC  EQU   RRPA+11                                                  06639000
RRPAINS  EQU   RRPA+16                                                  06640000
RRPARTN  EQU   RRPAINS                                                  06641000
RRPAEPA  EQU   RRPA+20                                                  06642000
ASCB     EQU   0                                                        06643000
ASCBSUPC EQU   ASCB+16                                                  06644000
ASCBIOSM EQU   ASCB+40                                                  06645000
ASCBDP   EQU   ASCB+43                                                  06646000
ASCBRSM  EQU   ASCB+52                                                  06647000
ASCBRSMF EQU   ASCBRSM                                                  06648000
ASCB2LPU EQU   ASCBRSMF                                                 06649000
ASCB1LPU EQU   ASCBRSMF                                                 06650000
ASCBN2LP EQU   ASCBRSMF                                                 06651000
ASCBVEQR EQU   ASCBRSMF                                                 06652000
ASCBEJST EQU   ASCB+64                                                  06653000
ASCBFW1  EQU   ASCB+100                                                 06654000
ASCBRCTF EQU   ASCBFW1+2                                                06655000
ASCBFLG1 EQU   ASCBFW1+3                                                06656000
ASCBASXB EQU   ASCB+108                                                 06657000
ASCBSWCT EQU   ASCB+112                                                 06658000
ASCBDSP1 EQU   ASCB+114                                                 06659000
ASCBFLG2 EQU   ASCB+115                                                 06660000
ASCBVSC  EQU   ASCB+120                                                 06661000
ASCBNVSC EQU   ASCB+122                                                 06662000
ASCBLKGP EQU   ASCB+128                                                 06663000
ASCBMECB EQU   ASCB+140                                                 06664000
ASCBOUCB EQU   ASCB+144                                                 06665000
ASCBOUXB EQU   ASCB+148                                                 06666000
ASCBSRQ  EQU   ASCB+180                                                 06667000
ASCBSRQ1 EQU   ASCBSRQ                                                  06668000
ASCBSRQ2 EQU   ASCBSRQ+1                                                06669000
ASCBSRQ3 EQU   ASCBSRQ+2                                                06670000
ASCBSRQ4 EQU   ASCBSRQ+3                                                06671000
ASCBSRBT EQU   ASCB+200                                                 06672000
OUCB     EQU   0                                                        06673000
OUCBFWD  EQU   OUCB+4                                                   06674000
OUCBBCK  EQU   OUCB+8                                                   06675000
OUCBQFL  EQU   OUCB+16                                                  06676000
OUCBGOO  EQU   OUCBQFL                                                  06677000
OUCBGOI  EQU   OUCBQFL                                                  06678000
OUCBGOB  EQU   OUCBQFL                                                  06679000
OUCBQSFL EQU   OUCBQFL                                                  06680000
OUCBOFF  EQU   OUCBQFL                                                  06681000
OUCBOUT  EQU   OUCBQFL                                                  06682000
OUCBSFL  EQU   OUCB+17                                                  06683000
OUCBNSW  EQU   OUCBSFL                                                  06684000
OUCBCTI  EQU   OUCBSFL                                                  06685000
OUCBBIB  EQU   OUCBSFL                                                  06686000
OUCBINV  EQU   OUCBSFL                                                  06687000
OUCBNSWI EQU   OUCBSFL                                                  06688000
OUCBPVL  EQU   OUCBSFL                                                  06689000
OUCBENQ  EQU   OUCBSFL                                                  06690000
OUCBYFL  EQU   OUCB+18                                                  06691000
OUCBSTT  EQU   OUCBYFL                                                  06692000
OUCBLOG  EQU   OUCBYFL                                                  06693000
OUCBMNT  EQU   OUCBYFL                                                  06694000
OUCBPSTR EQU   OUCBYFL                                                  06695000
OUCBAXS  EQU   OUCBYFL                                                  06696000
OUCBDTA  EQU   OUCBYFL                                                  06697000
OUCBFXS  EQU   OUCBYFL                                                  06698000
OUCBAFL  EQU   OUCB+19                                                  06699000
OUCBAPG  EQU   OUCBAFL                                                  06700000
OUCBRMA  EQU   OUCBAFL                                                  06701000
OUCBCPL  EQU   OUCBAFL                                                  06702000
OUCBJSR  EQU   OUCBAFL                                                  06703000
OUCBASW  EQU   OUCBAFL                                                  06704000
OUCBTFL  EQU   OUCB+20                                                  06705000
OUCBATR  EQU   OUCBTFL                                                  06706000
OUCBSTR  EQU   OUCBTFL                                                  06707000
OUCBINP  EQU   OUCBTFL                                                  06708000
OUCBINC  EQU   OUCBTFL                                                  06709000
OUCBEFL  EQU   OUCB+21                                                  06710000
OUCBLWT  EQU   OUCBEFL                                                  06711000
OUCBTRM  EQU   OUCBEFL                                                  06712000
OUCBOWT  EQU   OUCBEFL                                                  06713000
OUCBCIM  EQU   OUCBEFL                                                  06714000
OUCBNQF  EQU   OUCBEFL                                                  06715000
OUCBQSS  EQU   OUCBEFL                                                  06716000
OUCBQSC  EQU   OUCBEFL                                                  06717000
OUCBMWT  EQU   OUCBEFL                                                  06718000
OUCBNQC  EQU   OUCB+22                                                  06719000
OUCBUFL  EQU   OUCB+23                                                  06720000
OUCBJSFS EQU   OUCBUFL                                                  06721000
OUCBJSAS EQU   OUCBUFL                                                  06722000
OUCBRSWP EQU   OUCBUFL                                                  06723000
OUCBTSWP EQU   OUCBUFL                                                  06724000
OUCBTSWC EQU   OUCBUFL                                                  06725000
OUCBNPG  EQU   OUCB+24                                                  06726000
OUCBRPG  EQU   OUCB+25                                                  06727000
OUCBNDP  EQU   OUCB+26                                                  06728000
OUCBRDP  EQU   OUCB+27                                                  06729000
OUCBSPG  EQU   OUCB+28                                                  06730000
OUCBPGP  EQU   OUCB+31                                                  06731000
OUCBWMG  EQU   OUCB+32                                                  06732000
OUCBDMO  EQU   OUCB+34                                                  06733000
OUCBDMN  EQU   OUCB+36                                                  06734000
OUCBSRC  EQU   OUCB+37                                                  06735000
OUCBASCB EQU   OUCB+40                                                  06736000
OUCBIMCB EQU   OUCB+44                                                  06737000
OUCBWMS  EQU   OUCB+52                                                  06738000
OUCBTMS  EQU   OUCB+68                                                  06739000
OUCBPSO  EQU   OUCB+76                                                  06740000
OUCBWSS  EQU   OUCB+78                                                  06741000
OUCBCSW  EQU   OUCB+84                                                  06742000
OUCBCFL  EQU   OUCBCSW+2                                                06743000
OUCBRDY  EQU   OUCBCFL                                                  06744000
OUCBRSM  EQU   OUCBCFL                                                  06745000
OUCBIOR  EQU   OUCB+100                                                 06746000
OUCBIOSM EQU   OUCB+108                                                 06747000
OUCBPSS  EQU   OUCB+112                                                 06748000
OUCBPS1  EQU   OUCBPSS                                                  06749000
OUCBPS2  EQU   OUCBPSS+4                                                06750000
OUCBPST  EQU   OUCB+120                                                 06751000
OUCBNDS  EQU   OUCB+132                                                 06752000
OUCBNTSP EQU   OUCB+134                                                 06753000
OUXB     EQU   0                                                        06754000
OUXBNAME EQU   OUXB                                                     06755000
OUXBPET  EQU   OUXB+4                                                   06756000
OUXBRSW  EQU   OUXB+12                                                  06757000
OUXBPIN  EQU   OUXB+16                                                  06758000
OUXBPOUT EQU   OUXB+20                                                  06759000
OUXBPREC EQU   OUXB+24                                                  06760000
OUXBVAMI EQU   OUXB+28                                                  06761000
OUXBVAMO EQU   OUXB+32                                                  06762000
OUXBVAMR EQU   OUXB+36                                                  06763000
OUXBCAPI EQU   OUXB+40                                                  06764000
OUXBCAPR EQU   OUXB+44                                                  06765000
OUXBSTCT EQU   OUXB+48                                                  06766000
OUXBSTC  EQU   OUXB+54                                                  06767000
OUXBNQT  EQU   OUXB+60                                                  06768000
OUXBTRC  EQU   OUXB+64                                                  06769000
OUXBJBS  EQU   OUXB+68                                                  06770000
OUXBJBT  EQU   OUXB+72                                                  06771000
OUXBTRS  EQU   OUXB+76                                                  06772000
OUXBTRT  EQU   OUXB+80                                                  06773000
OUXBJBR  EQU   OUXB+84                                                  06774000
OUXBTRR  EQU   OUXB+88                                                  06775000
OUXBAET  EQU   OUXB+92                                                  06776000
OUXBCPS  EQU   OUXB+96                                                  06777000
OUXBITD  EQU   OUXB+112                                                 06778000
OUXBSTD  EQU   OUXB+116                                                 06779000
OUXBWCT  EQU   OUXB+124                                                 06780000
OUXBILS  EQU   OUXB+128                                                 06781000
OUXBVSC  EQU   OUXB+132                                                 06782000
OUXBNVC  EQU   OUXB+136                                                 06783000
OUXBTSW  EQU   OUXB+140                                                 06784000
OUSB     EQU   0                                                        06785000
OUSBCAPI EQU   OUSB+4                                                   06786000
OUSBCAPR EQU   OUSB+8                                                   06787000
OUSBSTCT EQU   OUSB+12                                                  06788000
OUSBSPIN EQU   OUSB+16                                                  06789000
OUSBSPOT EQU   OUSB+20                                                  06790000
OUSBSWCT EQU   OUSB+24                                                  06791000
OUSBPIN  EQU   OUSB+28                                                  06792000
OUSBPOUT EQU   OUSB+32                                                  06793000
OUSBPREC EQU   OUSB+36                                                  06794000
OUSBVAMI EQU   OUSB+40                                                  06795000
OUSBVAMO EQU   OUSB+44                                                  06796000
OUSBVAMR EQU   OUSB+48                                                  06797000
OUSBSAVE EQU   OUSB+52                                                  06798000
ASXB     EQU   0                                                        06799000
ASXBOUSB EQU   ASXB+128                                                 06800000
ASXBAEQ  EQU   ASXB+168                                                 06801000
ASXBSECR EQU   ASXB+199                                                 06802000
ASCBSFLG EQU   ASXBSECR                                                 06803000
ASXBCASW EQU   ASXB+216                                                 06804000
ASXBCRB1 EQU   ASXBCASW                                                 06805000
RMEP     EQU   0                                                        06806000
RMEPEPB  EQU   RMEP                                                     06807000
RMEPFLG  EQU   RMEPEPB+8                                                06808000
RMEPSCH  EQU   RMEP+16                                                  06809000
WMST     EQU   0                                                        06810000
WMSTPGVT EQU   WMST+8                                                   06811000
WMSTPGDT EQU   WMST+16                                                  06812000
WMSTDMDT EQU   WMST+40                                                  06813000
WMSTDMVT EQU   WMST+48                                                  06814000
WMSTDMVS EQU   WMST+52                                                  06815000
WMSTPGHI EQU   WMST+62                                                  06816000
WMSTSET  EQU   WMST+84                                                  06817000
WMSTSTCB EQU   WMST+88                                                  06818000
WMSTNWST EQU   WMST+92                                                  06819000
WMSTSECB EQU   WMST+96                                                  06820000
WPGD     EQU   0                                                        06821000
WPGDPGN  EQU   WPGD                                                     06822000
WPGDDFL  EQU   WPGD+3                                                   06823000
WPGDPGP  EQU   WPGD+12                                                  06824000
WPGDINDS EQU   WPGDPGP+5                                                06825000
WPGP     EQU   0                                                        06826000
WPGPDMN  EQU   WPGP+1                                                   06827000
WPGPAPGV EQU   WPGP+4                                                   06828000
WPGPINDS EQU   WPGP+5                                                   06829000
WPGPFIN  EQU   WPGPINDS                                                 06830000
WPGPAPG  EQU   WPGPINDS                                                 06831000
WPGL     EQU   0                                                        06832000
WPGLISV  EQU   WPGL                                                     06833000
WAMT     EQU   0                                                        06834000
WAMTWAR  EQU   WAMT                                                     06835000
WAMTNX1  EQU   WAMT+56                                                  06836000
WAMP     EQU   0                                                        06837000
WAMPPGP  EQU   WAMP                                                     06838000
ASVT     EQU   0                                                        06839000
ASVTMAXU EQU   ASVT+516                                                 06840000
ASVTFRST EQU   ASVT+524                                                 06841000
ASVTENTY EQU   ASVT+528                                                 06842000
RQSV     EQU   0                                                        06843000
RQSVDATA EQU   RQSV                                                     06844000
RQSVSRV  EQU   RQSVDATA                                                 06845000
RQSVTIM  EQU   RQSVDATA+4                                               06846000
RQSVPGSC EQU   RQSVDATA+8                                               06847000
RQSVPGN  EQU   RQSVPGSC                                                 06848000
RQSVTRC  EQU   RQSVPGSC+2                                               06849000
RQSVSRT  EQU   RQSVDATA+12                                              06850000
DMDT     EQU   0                                                        06851000
DMDTLO   EQU   DMDT+1                                                   06852000
DMDTHI   EQU   DMDT+2                                                   06853000
DMDTWT   EQU   DMDT+3                                                   06854000
DMDTMPLT EQU   DMDT+4                                                   06855000
CVTMAP   EQU   0                                                        06856000
CVT      EQU   CVTMAP                                                   06857000
CVTDAR   EQU   CVTMAP+72                                                06858000
CVTFLGS1 EQU   CVTDAR                                                   06859000
CVTDCB   EQU   CVTMAP+116                                               06860000
CVTIOQET EQU   CVTMAP+120                                               06861000
CVTIERLC EQU   CVTMAP+144                                               06862000
CVTHEAD  EQU   CVTMAP+160                                               06863000
CVTSV76C EQU   CVTHEAD                                                  06864000
CVTOPTA  EQU   CVTMAP+182                                               06865000
CVTOPTB  EQU   CVTMAP+183                                               06866000
CVTGTF   EQU   CVTMAP+236                                               06867000
CVTGTFST EQU   CVTGTF                                                   06868000
CVTGTFS  EQU   CVTGTFST                                                 06869000
CVTSTATE EQU   CVTGTFST                                                 06870000
CVTTMODE EQU   CVTGTFST                                                 06871000
CVTFORM  EQU   CVTGTFST                                                 06872000
CVTAQAVT EQU   CVTMAP+240                                               06873000
CVTTCMFG EQU   CVTAQAVT                                                 06874000
CVTVOLM2 EQU   CVTMAP+244                                               06875000
CVTTATA  EQU   CVTVOLM2                                                 06876000
CVTTSKS  EQU   CVTTATA                                                  06877000
CVTVOLF2 EQU   CVTTSKS                                                  06878000
CVTTAT   EQU   CVTTATA+1                                                06879000
CVTATER  EQU   CVTMAP+248                                               06880000
CVTEXT1  EQU   CVTMAP+252                                               06881000
CVTPURG  EQU   CVTMAP+260                                               06882000
CVTQMSG  EQU   CVTMAP+268                                               06883000
CVTDMSR  EQU   CVTMAP+272                                               06884000
CVTRSV37 EQU   CVTDMSR                                                  06885000
CVTDMSRF EQU   CVTRSV37                                                 06886000
CVTERPV  EQU   CVTMAP+316                                               06887000
CVTINTLA EQU   CVTMAP+320                                               06888000
CVTAPF   EQU   CVTMAP+324                                               06889000
CVTEXT2  EQU   CVTMAP+328                                               06890000
CVTHJES  EQU   CVTMAP+332                                               06891000
CVTPGSIA EQU   CVTMAP+348                                               06892000
CVTA1F1  EQU   CVTMAP+356                                               06893000
CVTSYSK  EQU   CVTMAP+357                                               06894000
CVTVOLM1 EQU   CVTMAP+380                                               06895000
CVTVOLF1 EQU   CVTVOLM1                                                 06896000
CVTATMCT EQU   CVTMAP+388                                               06897000
CVTXTNT1 EQU   0                                                        06898000
CVTXTNT2 EQU   0                                                        06899000
CVTDSSV  EQU   CVTXTNT2                                                 06900000
CVTFLGBT EQU   CVTXTNT2+5                                               06901000
CVTQID   EQU   CVTXTNT2+24                                              06902000
CVTRV400 EQU   CVTXTNT2+52                                              06903000
CVTRV409 EQU   CVTXTNT2+53                                              06904000
CVTATCVT EQU   CVTXTNT2+64                                              06905000
CVTRV429 EQU   CVTXTNT2+84                                              06906000
CVTRV438 EQU   CVTXTNT2+85                                              06907000
CVTRV457 EQU   CVTXTNT2+112                                             06908000
CVTRV466 EQU   CVTXTNT2+113                                             06909000
CVTFIX   EQU   0                                                        06910000
CVTRELNO EQU   CVTFIX+252                                               06911000
PVT      EQU   0                                                        06912000
PVTFLAG1 EQU   PVT                                                      06913000
PVTAPREF EQU   PVTFLAG1                                                 06914000
PVTFLAG2 EQU   PVT+1                                                    06915000
PVTQS    EQU   PVT+304                                                  06916000
PVTWSAX  EQU   PVT+344                                                  06917000
SRBSECT  EQU   0                                                        06918000
SRB      EQU   SRBSECT                                                  06919000
SRBFLC   EQU   SRB+12                                                   06920000
SRBPARM  EQU   SRB+28                                                   06921000
CSD      EQU   0                                                        06922000
CSDCPUAL EQU   CSD+8                                                    06923000
CSDCPUOL EQU   CSD+10                                                   06924000
CSDSCWRD EQU   CSD+12                                                   06925000
CSDSCFL1 EQU   CSDSCWRD                                                 06926000
CSDSCFL2 EQU   CSDSCWRD+1                                               06927000
CSDSCFL3 EQU   CSDSCWRD+2                                               06928000
CSDSCFL4 EQU   CSDSCWRD+3                                               06929000
CSDFLAGS EQU   CSD+23                                                   06930000
SMFRCD22 EQU   0                                                        06931000
SMF22RTY EQU   SMFRCD22+5                                               06932000
SMF22CPU EQU   0                                                        06933000
SMF22CHL EQU   0                                                        06934000
SMF22STR EQU   0                                                        06935000
SMF22IPL EQU   0                                                        06936000
SMF22VON EQU   0                                                        06937000
SMF22VOF EQU   0                                                        06938000
SWOCMPLT EQU   0                                                        06939000
SWOPGCNT EQU   SWOCMPLT                                                 06940000
SWIWSS   EQU   SWOCMPLT+2                                               06941000
SWOFLGS  EQU   SWOCMPLT+7                                               06942000
SWOWRSM  EQU   SWOFLGS                                                  06943000
SETDPRMS EQU   0                                                        06944000
SETDDMN  EQU   SETDPRMS                                                 06945000
SETDFLGS EQU   SETDPRMS+1                                               06946000
MINFLAG  EQU   SETDFLGS                                                 06947000
MAXFLAG  EQU   SETDFLGS                                                 06948000
WTFLAG   EQU   SETDFLGS                                                 06949000
SETDMIN  EQU   SETDPRMS+2                                               06950000
SETDMAX  EQU   SETDPRMS+3                                               06951000
SETDWT   EQU   SETDPRMS+4                                               06952000
SMFAREA  EQU   0                                                        06953000
SMFPIN   EQU   SMFAREA                                                  06954000
SMFPOUT  EQU   SMFAREA+4                                                06955000
SMFPREC  EQU   SMFAREA+8                                                06956000
SMFVAMI  EQU   SMFAREA+12                                               06957000
SMFVAMO  EQU   SMFAREA+16                                               06958000
SMFVAMR  EQU   SMFAREA+20                                               06959000
SMFSCNTS EQU   SMFAREA+24                                               06960000
SMFCAPI  EQU   SMFAREA+36                                               06961000
SMFCAPR  EQU   SMFAREA+40                                               06962000
SMFSTCT  EQU   SMFAREA+44                                               06963000
SMFPGSS  EQU   SMFAREA+48                                               06964000
COPYPRMS EQU   0                                                        06965000
COPYCNT  EQU   COPYPRMS                                                 06966000
COPYDMDT EQU   COPYPRMS+4                                               06967000
REQSPARM EQU   0                                                        06968000
IRARMNTR EQU   0                                                        06969000
IRARMRTN EQU   0                                                        06970000
WPGVTENT EQU   0                                                        06971000
WARTABLE EQU   0                                                        06972000
IRARMWR1 EQU   0                                                        06973000
IRARMWR3 EQU   0                                                        06974000
ECBFIELD EQU   0                                                        06975000
SWAPECB  EQU   ECBFIELD                                                 06976000
NEWCELL  EQU   0                                                        06977000
ECBLIST  EQU   0                                                        06978000
PROCESSR EQU   0                                                        06979000
WDMVTENT EQU   0                                                        06980000
DOMAINS  EQU   0                                                        06981000
ASXBPTR  EQU   ASCBASXB                                                 06982000
WMSTPTR  EQU   RMCTWMST                                                 06983000
WPGDPTR  EQU   WMSTPGDT                                                 06984000
CVTS01   EQU   CVTPGSIA                                                 06985000
CVTPVTP  EQU   CVTS01+8                                                 06986000
CVTLPDIA EQU   CVTS01+12                                                06987000
CVTDIRST EQU   CVTLPDIA                                                 06988000
CVTSLIDA EQU   CVTS01+24                                                06989000
CVTCTLFG EQU   CVTS01+50                                                06990000
CVTASVT  EQU   CVTS01+208                                               06991000
CVTCSD   EQU   CVTS01+312                                               06992000
CVTRV210 EQU   CVTS01+424                                               06993000
CVTRV219 EQU   CVTS01+425                                               06994000
CVTRV228 EQU   CVTS01+426                                               06995000
CVTRV237 EQU   CVTS01+427                                               06996000
CVTMFRTR EQU   CVTS01+452                                               06997000
CVTRV262 EQU   CVTS01+468                                               06998000
CVTRV271 EQU   CVTS01+469                                               06999000
CVTRV280 EQU   CVTS01+470                                               07000000
CVTRV289 EQU   CVTS01+471                                               07001000
CVTEXP1  EQU   CVTS01+572                                               07002000
CVTGSDA  EQU   CVTS01+600                                               07003000
CVTRV609 EQU   CVTS01+652                                               07004000
ASVTPTR  EQU   CVTASVT                                                  07005000
RQSVPTR  EQU   RMCTRQSV                                                 07006000
CVTPTR   EQU   FLCCVT                                                   07007000
PSARSVTE EQU   PSARSVT                                                  07008000
PVTPTR   EQU   CVTPVTP                                                  07009000
SMF22PTR EQU   RRPAINP                                                  07010000
RRPAREG  EQU   RRPAINP                                                  07011000
RRPARI0  EQU   RRPAREG                                                  07012000
RRPAWAIT EQU   RRPARI0                                                  07013000
RRPAWTYP EQU   RRPAWAIT                                                 07014000
RRPAGTPT EQU   RRPAWTYP                                                 07015000
RRPATRAN EQU   RRPAWTYP                                                 07016000
RRPARI1  EQU   RRPAREG+1                                                07017000
RRPAASW  EQU   RRPARI1                                                  07018000
RRPARI2  EQU   RRPAREG+2                                                07019000
RRPADEF  EQU   RRPARI2                                                  07020000
RRPANPG  EQU   RRPADEF                                                  07021000
RRPARI3  EQU   RRPAREG+3                                                07022000
RRPAPGN  EQU   RRPARI3                                                  07023000
RRPANDP  EQU   RRPAPGN                                                  07024000
RRPAMEMO EQU   RRPANDP                                                  07025000
RRPATODO EQU   RRPAMEMO                                                 07026000
LEVEL    EQU   RRPAINP+3                                                07027000
OUXBFLDS EQU   OUXBNQT                                                  07028000
OUSBFLDS EQU   OUSBSAVE                                                 07029000
SWPFLDS  EQU   OUSBSPIN                                                 07030000
PGEFLDX  EQU   OUXBPIN                                                  07031000
PGEFLDS  EQU   OUSBCAPI                                                 07032000
@NM00042 EQU   ECBFIELD                                                 07033000
ECBLISTB EQU   @NM00042                                                 07034000
ASCBFW1A EQU   ASCBFW1                                                  07035000
ASCBOUTB EQU   ASCBFW1A+2                                               07036000
ASCBTLWT EQU   ASCBFW1A+2                                               07037000
ACCNTFLD EQU   OUXBTRC                                                  07038000
OUCBRFLG EQU   OUCBCSW                                                  07039000
OUCBRDYB EQU   OUCBRFLG+2                                               07040000
OUCBRSMB EQU   OUCBRFLG+2                                               07041000
RMCASRCD EQU   RMCASRC                                                  07042000
FLC      EQU   PSA                                                      07043000
MSASCBET EQU   ASCBEJST+2                                               07044000
WAMTNDX  EQU   WAMTNX1                                                  07045000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07046000
@NM00048 EQU   OUCBRFLG+3                                               07047000
@NM00047 EQU   OUCBRFLG+2                                               07048000
@NM00046 EQU   OUCBRFLG                                                 07049000
@NM00045 EQU   ASCBFW1A+2                                               07050000
@NM00044 EQU   ASCBFW1A                                                 07051000
@NM00043 EQU   @NM00042                                                 07052000
@NM00037 EQU   RRPARI1                                                  07053000
@NM00036 EQU   RRPARI1                                                  07054000
PSARSAV  EQU   PSARSVTE+60                                              07055000
PSARSTK  EQU   PSARSVTE+56                                              07056000
PSAESAV3 EQU   PSARSVTE+52                                              07057000
PSAESTK3 EQU   PSARSVTE+48                                              07058000
PSAESAV2 EQU   PSARSVTE+44                                              07059000
PSAESTK2 EQU   PSARSVTE+40                                              07060000
PSAESAV1 EQU   PSARSVTE+36                                              07061000
PSAESTK1 EQU   PSARSVTE+32                                              07062000
PSAPSAV  EQU   PSARSVTE+28                                              07063000
PSAPSTK  EQU   PSARSVTE+24                                              07064000
PSAMSAV  EQU   PSARSVTE+20                                              07065000
PSAMSTK  EQU   PSARSVTE+16                                              07066000
PSASSAV  EQU   PSARSVTE+12                                              07067000
PSASSTK  EQU   PSARSVTE+8                                               07068000
PSANSTK  EQU   PSARSVTE+4                                               07069000
PSACSTK  EQU   PSARSVTE                                                 07070000
CVTRV628 EQU   CVTS01+728                                               07071000
CVTRV627 EQU   CVTS01+724                                               07072000
CVTRV626 EQU   CVTS01+720                                               07073000
CVTRV625 EQU   CVTS01+716                                               07074000
CVTRV624 EQU   CVTS01+712                                               07075000
CVTRV623 EQU   CVTS01+708                                               07076000
CVTRV622 EQU   CVTS01+704                                               07077000
CVTRV621 EQU   CVTS01+700                                               07078000
CVTIHASU EQU   CVTS01+696                                               07079000
CVTSUSP  EQU   CVTS01+692                                               07080000
CVTT6SVC EQU   CVTS01+688                                               07081000
CVTCDAL  EQU   CVTS01+684                                               07082000
CVTTCTL  EQU   CVTS01+680                                               07083000
CVTRSUME EQU   CVTS01+676                                               07084000
CVTJTERM EQU   CVTS01+672                                               07085000
CVTASMRM EQU   CVTS01+668                                               07086000
CVTTCASP EQU   CVTS01+664                                               07087000
CVT0PT03 EQU   CVTS01+660                                               07088000
CVT0PT0E EQU   CVTS01+656                                               07089000
CVTCGK   EQU   CVTS01+648                                               07090000
CVTRAC   EQU   CVTS01+644                                               07091000
CVTHSM   EQU   CVTS01+640                                               07092000
CVTRV605 EQU   CVTS01+636                                               07093000
CVTRV604 EQU   CVTS01+632                                               07094000
CVTEFF02 EQU   CVTS01+628                                               07095000
CVTCBBR  EQU   CVTS01+624                                               07096000
CVTSSCR  EQU   CVTS01+620                                               07097000
CVTEVENT EQU   CVTS01+616                                               07098000
CVTCRCA  EQU   CVTS01+612                                               07099000
CVTTPIO  EQU   CVTS01+608                                               07100000
CVTADV   EQU   CVTS01+604                                               07101000
CVTGSDAB EQU   CVTGSDA                                                  07102000
CVTQV3   EQU   CVTS01+596                                               07103000
CVTQV2   EQU   CVTS01+592                                               07104000
CVTQV1   EQU   CVTS01+588                                               07105000
CVTRPT   EQU   CVTS01+584                                               07106000
CVTSSRB  EQU   CVTS01+580                                               07107000
CVTCSDRL EQU   CVTS01+576                                               07108000
CVTRMPMT EQU   CVTS01+568                                               07109000
CVTRMPTT EQU   CVTS01+564                                               07110000
CVTVPSA  EQU   CVTS01+560                                               07111000
CVTVSTOP EQU   CVTS01+556                                               07112000
CVTGTFR8 EQU   CVTS01+552                                               07113000
CVTQUIT  EQU   CVTS01+548                                               07114000
CVTVACR  EQU   CVTS01+544                                               07115000
CVTWTCB  EQU   CVTS01+540                                               07116000
CVTSTPRS EQU   CVTS01+536                                               07117000
CVT0PT02 EQU   CVTS01+532                                               07118000
CVTDARCM EQU   CVTS01+528                                               07119000
CVTIRECM EQU   CVTS01+524                                               07120000
CVTJRECM EQU   CVTS01+520                                               07121000
CVTVEMS0 EQU   CVTS01+516                                               07122000
CVTSPFRR EQU   CVTS01+512                                               07123000
CVTRLSTG EQU   CVTS01+508                                               07124000
CVT0TC0A EQU   CVTS01+504                                               07125000
CVTGMBR  EQU   CVTS01+500                                               07126000
CVTLFRM  EQU   CVTS01+496                                               07127000
CVTRMBR  EQU   CVTS01+492                                               07128000
CVTVIOP  EQU   CVTS01+488                                               07129000
CVTRV307 EQU   CVTS01+486                                               07130000
CVTRV306 EQU   CVTS01+484                                               07131000
CVTRV305 EQU   CVTS01+482                                               07132000
CVTRV304 EQU   CVTS01+480                                               07133000
CVTRV303 EQU   CVTS01+478                                               07134000
CVTRV302 EQU   CVTS01+476                                               07135000
CVTTRCA  EQU   CVTS01+472                                               07136000
CVTRV297 EQU   CVTRV289                                                 07137000
CVTRV296 EQU   CVTRV289                                                 07138000
CVTRV295 EQU   CVTRV289                                                 07139000
CVTRV294 EQU   CVTRV289                                                 07140000
CVTRV293 EQU   CVTRV289                                                 07141000
CVTRV292 EQU   CVTRV289                                                 07142000
CVTRV291 EQU   CVTRV289                                                 07143000
CVTRV290 EQU   CVTRV289                                                 07144000
CVTRV288 EQU   CVTRV280                                                 07145000
CVTRV287 EQU   CVTRV280                                                 07146000
CVTRV286 EQU   CVTRV280                                                 07147000
CVTRV285 EQU   CVTRV280                                                 07148000
CVTRV284 EQU   CVTRV280                                                 07149000
CVTRV283 EQU   CVTRV280                                                 07150000
CVTRV282 EQU   CVTRV280                                                 07151000
CVTRV281 EQU   CVTRV280                                                 07152000
CVTRV279 EQU   CVTRV271                                                 07153000
CVTRV278 EQU   CVTRV271                                                 07154000
CVTRV277 EQU   CVTRV271                                                 07155000
CVTRV276 EQU   CVTRV271                                                 07156000
CVTRV275 EQU   CVTRV271                                                 07157000
CVTRV274 EQU   CVTRV271                                                 07158000
CVTRV273 EQU   CVTRV271                                                 07159000
CVTRV272 EQU   CVTRV271                                                 07160000
CVTRV270 EQU   CVTRV262                                                 07161000
CVTRV269 EQU   CVTRV262                                                 07162000
CVTRV268 EQU   CVTRV262                                                 07163000
CVTRV267 EQU   CVTRV262                                                 07164000
CVTRV266 EQU   CVTRV262                                                 07165000
CVTRV265 EQU   CVTRV262                                                 07166000
CVTRV264 EQU   CVTRV262                                                 07167000
CVTRV263 EQU   CVTRV262                                                 07168000
CVTVFP   EQU   CVTS01+464                                               07169000
CVTVSI   EQU   CVTS01+460                                               07170000
CVTVPSIB EQU   CVTS01+456                                               07171000
CVTMFACT EQU   CVTMFRTR                                                 07172000
CVTMFCTL EQU   CVTS01+448                                               07173000
CVTPVBP  EQU   CVTS01+444                                               07174000
CVTPWI   EQU   CVTS01+440                                               07175000
CVTRV254 EQU   CVTS01+438                                               07176000
CVTRV253 EQU   CVTS01+436                                               07177000
CVTRV252 EQU   CVTS01+434                                               07178000
CVTRV251 EQU   CVTS01+433                                               07179000
CVTRV250 EQU   CVTS01+432                                               07180000
CVTRV249 EQU   CVTS01+431                                               07181000
CVTRV248 EQU   CVTS01+430                                               07182000
CVTRV247 EQU   CVTS01+429                                               07183000
CVTRV246 EQU   CVTS01+428                                               07184000
CVTRV245 EQU   CVTRV237                                                 07185000
CVTRV244 EQU   CVTRV237                                                 07186000
CVTRV243 EQU   CVTRV237                                                 07187000
CVTRV242 EQU   CVTRV237                                                 07188000
CVTRV241 EQU   CVTRV237                                                 07189000
CVTRV240 EQU   CVTRV237                                                 07190000
CVTRV239 EQU   CVTRV237                                                 07191000
CVTRV238 EQU   CVTRV237                                                 07192000
CVTRV236 EQU   CVTRV228                                                 07193000
CVTRV235 EQU   CVTRV228                                                 07194000
CVTRV234 EQU   CVTRV228                                                 07195000
CVTRV233 EQU   CVTRV228                                                 07196000
CVTRV232 EQU   CVTRV228                                                 07197000
CVTRV231 EQU   CVTRV228                                                 07198000
CVTRV230 EQU   CVTRV228                                                 07199000
CVTRV229 EQU   CVTRV228                                                 07200000
CVTRV227 EQU   CVTRV219                                                 07201000
CVTRV226 EQU   CVTRV219                                                 07202000
CVTRV225 EQU   CVTRV219                                                 07203000
CVTRV224 EQU   CVTRV219                                                 07204000
CVTRV223 EQU   CVTRV219                                                 07205000
CVTRV222 EQU   CVTRV219                                                 07206000
CVTRV221 EQU   CVTRV219                                                 07207000
CVTRV220 EQU   CVTRV219                                                 07208000
CVTRV218 EQU   CVTRV210                                                 07209000
CVTRV217 EQU   CVTRV210                                                 07210000
CVTRV216 EQU   CVTRV210                                                 07211000
CVTRV215 EQU   CVTRV210                                                 07212000
CVTRV214 EQU   CVTRV210                                                 07213000
CVTRV213 EQU   CVTRV210                                                 07214000
CVTRV212 EQU   CVTRV210                                                 07215000
CVTRV211 EQU   CVTRV210                                                 07216000
CVTLCCAT EQU   CVTS01+420                                               07217000
CVTPCCAT EQU   CVTS01+416                                               07218000
CVTIPCRP EQU   CVTS01+412                                               07219000
CVTIPCRI EQU   CVTS01+408                                               07220000
CVTIPCDS EQU   CVTS01+404                                               07221000
CVTAIDVT EQU   CVTS01+400                                               07222000
CVTSSAP  EQU   CVTS01+396                                               07223000
CVTEHCIR EQU   CVTS01+392                                               07224000
CVTEHDEF EQU   CVTS01+388                                               07225000
CVTDAIR  EQU   CVTS01+384                                               07226000
CVTPERFM EQU   CVTS01+380                                               07227000
CVT044R2 EQU   CVTS01+376                                               07228000
CVTFETCH EQU   CVTS01+372                                               07229000
CVTRSTWD EQU   CVTS01+368                                               07230000
CVTSPOST EQU   CVTS01+364                                               07231000
CVTIOBP  EQU   CVTS01+360                                               07232000
CVTASMVT EQU   CVTS01+356                                               07233000
CVTRECRQ EQU   CVTS01+352                                               07234000
CVTWSAC  EQU   CVTS01+348                                               07235000
CVTRV149 EQU   CVTS01+344                                               07236000
CVTWSAL  EQU   CVTS01+340                                               07237000
CVTSPSA  EQU   CVTS01+336                                               07238000
CVTGLMN  EQU   CVTS01+332                                               07239000
CVTVEAC0 EQU   CVTS01+328                                               07240000
CVT062R1 EQU   CVTS01+324                                               07241000
CVTRPOST EQU   CVTS01+320                                               07242000
CVTDQIQE EQU   CVTS01+316                                               07243000
CVTLKRMA EQU   CVTS01+308                                               07244000
CVTRSPIE EQU   CVTS01+304                                               07245000
CVTRENQ  EQU   CVTS01+300                                               07246000
CVTLQCB  EQU   CVTS01+296                                               07247000
CVTFQCB  EQU   CVTS01+292                                               07248000
CVTQCS01 EQU   CVTS01+288                                               07249000
CVTAPFT  EQU   CVTS01+284                                               07250000
CVTPARRL EQU   CVTS01+280                                               07251000
CVTVWAIT EQU   CVTS01+276                                               07252000
CVTGSPL  EQU   CVTS01+272                                               07253000
CVTLSMQ  EQU   CVTS01+268                                               07254000
CVTGSMQ  EQU   CVTS01+264                                               07255000
CVTEXPRO EQU   CVTS01+260                                               07256000
CVTOPCTP EQU   CVTS01+256                                               07257000
CVTSIC   EQU   CVTS01+252                                               07258000
CVTTPIOS EQU   CVTS01+248                                               07259000
CVTRTMS  EQU   CVTS01+244                                               07260000
CVTSDBF  EQU   CVTS01+240                                               07261000
CVTSCBP  EQU   CVTS01+236                                               07262000
CVTSDMP  EQU   CVTS01+232                                               07263000
CVTSV60  EQU   CVTS01+228                                               07264000
CVTRTMCT EQU   CVTS01+224                                               07265000
CVTASCBL EQU   CVTS01+220                                               07266000
CVTASCBH EQU   CVTS01+216                                               07267000
CVTGDA   EQU   CVTS01+212                                               07268000
CVTVVMDI EQU   CVTS01+204                                               07269000
CVTAQTOP EQU   CVTS01+200                                               07270000
CVTIOSCS EQU   CVTS01+196                                               07271000
CVTSDRM  EQU   CVTS01+192                                               07272000
CVTOPTE  EQU   CVTS01+188                                               07273000
CVTSTXU  EQU   CVTS01+184                                               07274000
CVTQUIS  EQU   CVTS01+180                                               07275000
CVTPARS  EQU   CVTS01+176                                               07276000
CVTS1EE  EQU   CVTS01+172                                               07277000
CVTFRAS  EQU   CVTS01+168                                               07278000
CVTQSAS  EQU   CVTS01+164                                               07279000
CVTCRAS  EQU   CVTS01+160                                               07280000
CVTCRMN  EQU   CVTS01+156                                               07281000
CVTDELCP EQU   CVTS01+152                                               07282000
CVTFRECL EQU   CVTS01+148                                               07283000
CVTGETCL EQU   CVTS01+144                                               07284000
CVTBLDCP EQU   CVTS01+140                                               07285000
CVTAUTHL EQU   CVTS01+136                                               07286000
CVTSCAN  EQU   CVTS01+132                                               07287000
CVTRV144 EQU   CVTS01+130                                               07288000
CVTMAXMP EQU   CVTS01+128                                               07289000
CVTSTCK  EQU   CVTS01+124                                               07290000
CVTRV139 EQU   CVTS01+123                                               07291000
CVTDSSAC EQU   CVTS01+122                                               07292000
CVTRV513 EQU   CVTS01+121                                               07293000
CVTIOSPL EQU   CVTS01+120                                               07294000
CVTPTGT  EQU   CVTS01+116                                               07295000
CVTCSPIE EQU   CVTS01+112                                               07296000
CVTSMFEX EQU   CVTS01+108                                               07297000
CVTOLT0A EQU   CVTS01+104                                               07298000
CVTSRBRT EQU   CVTS01+100                                               07299000
CVTPUTL  EQU   CVTS01+96                                                07300000
CVTASCRL EQU   CVTS01+92                                                07301000
CVTASCRF EQU   CVTS01+88                                                07302000
CVTRV326 EQU   CVTS01+84                                                07303000
CVTRV325 EQU   CVTS01+80                                                07304000
CVTRV324 EQU   CVTS01+76                                                07305000
CVT0VL01 EQU   CVTS01+72                                                07306000
CVTSHRVM EQU   CVTS01+68                                                07307000
CVTRV332 EQU   CVTS01+64                                                07308000
CVTTAS   EQU   CVTS01+60                                                07309000
CVTRSCN  EQU   CVTS01+56                                                07310000
CVTTRAC2 EQU   CVTS01+54                                                07311000
CVTTRACE EQU   CVTS01+52                                                07312000
CVTAPG   EQU   CVTS01+51                                                07313000
CVTSDTRC EQU   CVTCTLFG                                                 07314000
CVTGTRCE EQU   CVTCTLFG                                                 07315000
CVTNOMP  EQU   CVTCTLFG                                                 07316000
CVTRSV79 EQU   CVTCTLFG                                                 07317000
CVTDSTAT EQU   CVTCTLFG                                                 07318000
CVTRSV78 EQU   CVTCTLFG                                                 07319000
CVTRV333 EQU   CVTCTLFG                                                 07320000
CVTRV323 EQU   CVTCTLFG                                                 07321000
CVTSPVLK EQU   CVTS01+49                                                07322000
CVTRSV77 EQU   CVTS01+48                                                07323000
CVTRV331 EQU   CVTS01+44                                                07324000
CVTRV330 EQU   CVTS01+40                                                07325000
CVTRV329 EQU   CVTS01+36                                                07326000
CVTRV328 EQU   CVTS01+32                                                07327000
CVTRV322 EQU   CVTS01+28                                                07328000
CVTSLID  EQU   CVTSLIDA+1                                               07329000
CVTSYLK  EQU   CVTSLIDA                                                 07330000
CVTRV321 EQU   CVTS01+20                                                07331000
CVTRV320 EQU   CVTS01+16                                                07332000
CVTLPDIR EQU   CVTLPDIA+1                                               07333000
CVTRSV69 EQU   CVTDIRST                                                 07334000
CVTRSV68 EQU   CVTDIRST                                                 07335000
CVTRSV67 EQU   CVTDIRST                                                 07336000
CVTRSV66 EQU   CVTDIRST                                                 07337000
CVTRSV65 EQU   CVTDIRST                                                 07338000
CVTRSV64 EQU   CVTDIRST                                                 07339000
CVTRSV63 EQU   CVTDIRST                                                 07340000
CVTDICOM EQU   CVTDIRST                                                 07341000
CVTLPDSR EQU   CVTS01+4                                                 07342000
CVTGETL  EQU   CVTS01                                                   07343000
COPYRSV  EQU   COPYPRMS+2                                               07344000
SMFSWCT  EQU   SMFSCNTS+8                                               07345000
SMFSPOT  EQU   SMFSCNTS+4                                               07346000
SMFSPIN  EQU   SMFSCNTS                                                 07347000
@NM00040 EQU   SETDFLGS                                                 07348000
@NM00039 EQU   SWOFLGS                                                  07349000
@NM00038 EQU   SWOCMPLT+6                                               07350000
SWOSPFR  EQU   SWOCMPLT+4                                               07351000
SMF22FSI EQU   SMF22VOF+3                                               07352000
SMF22RVB EQU   SMF22VOF+2                                               07353000
SMF22FID EQU   SMF22VOF+1                                               07354000
SMF22RV6 EQU   SMF22VOF                                                 07355000
SMF22NSI EQU   SMF22VON+3                                               07356000
SMF22RVA EQU   SMF22VON+2                                               07357000
SMF22NID EQU   SMF22VON+1                                               07358000
SMF22RV5 EQU   SMF22VON                                                 07359000
SMF22ION EQU   SMF22IPL+2                                               07360000
SMF22IID EQU   SMF22IPL+1                                               07361000
SMF22RV4 EQU   SMF22IPL                                                 07362000
SMF22NPG EQU   SMF22STR+4                                               07363000
SMF22PGL EQU   SMF22STR+2                                               07364000
SMF22TID EQU   SMF22STR+1                                               07365000
SMF22RV3 EQU   SMF22STR                                                 07366000
SMF22CPD EQU   SMF22CHL+5                                               07367000
SMF22CHA EQU   SMF22CHL+4                                               07368000
SMF22CHN EQU   SMF22CHL+2                                               07369000
SMF22CID EQU   SMF22CHL+1                                               07370000
SMF22RV2 EQU   SMF22CHL                                                 07371000
SMF22CPA EQU   SMF22CPU+5                                               07372000
SMF22RV1 EQU   SMF22CPU+4                                               07373000
SMF22CPN EQU   SMF22CPU+2                                               07374000
SMF22PID EQU   SMF22CPU+1                                               07375000
SMF22RV0 EQU   SMF22CPU                                                 07376000
SMF22ECT EQU   SMFRCD22+20                                              07377000
SMF22IND EQU   SMFRCD22+18                                              07378000
SMF22SID EQU   SMFRCD22+14                                              07379000
SMF22DTE EQU   SMFRCD22+10                                              07380000
SMF22TME EQU   SMFRCD22+6                                               07381000
SMF22FLG EQU   SMFRCD22+4                                               07382000
SMF22SEG EQU   SMFRCD22+2                                               07383000
SMF22LEN EQU   SMFRCD22                                                 07384000
@NM00035 EQU   CSD+160                                                  07385000
CSDMASK  EQU   CSD+128                                                  07386000
CSDUCNT  EQU   CSD+124                                                  07387000
CSDTCNT  EQU   CSD+120                                                  07388000
CSDGDTOD EQU   CSD+116                                                  07389000
CSDGDINT EQU   CSD+112                                                  07390000
CSDGDCC  EQU   CSD+108                                                  07391000
CSDDDRCT EQU   CSD+106                                                  07392000
CSDRV044 EQU   CSD+104                                                  07393000
CSDMAFF  EQU   CSD+24                                                   07394000
CSDRV038 EQU   CSDFLAGS                                                 07395000
CSDRV037 EQU   CSDFLAGS                                                 07396000
CSDRV036 EQU   CSDFLAGS                                                 07397000
CSDRV035 EQU   CSDFLAGS                                                 07398000
CSDRV034 EQU   CSDFLAGS                                                 07399000
CSDRV033 EQU   CSDFLAGS                                                 07400000
CSDRV032 EQU   CSDFLAGS                                                 07401000
CSDMP    EQU   CSDFLAGS                                                 07402000
CSDACR   EQU   CSD+22                                                   07403000
CSDMF1CP EQU   CSD+20                                                   07404000
CSDRV043 EQU   CSD+16                                                   07405000
CSDRV030 EQU   CSDSCFL4                                                 07406000
CSDRV029 EQU   CSDSCFL4                                                 07407000
CSDRV028 EQU   CSDSCFL4                                                 07408000
CSDRV027 EQU   CSDSCFL4                                                 07409000
CSDRV026 EQU   CSDSCFL4                                                 07410000
CSDRV025 EQU   CSDSCFL4                                                 07411000
CSDRV024 EQU   CSDSCFL4                                                 07412000
CSDRV023 EQU   CSDSCFL4                                                 07413000
CSDRV022 EQU   CSDSCFL3                                                 07414000
CSDRV021 EQU   CSDSCFL3                                                 07415000
CSDRV020 EQU   CSDSCFL3                                                 07416000
CSDRV019 EQU   CSDSCFL3                                                 07417000
CSDRV018 EQU   CSDSCFL3                                                 07418000
CSDRV017 EQU   CSDSCFL3                                                 07419000
CSDRV016 EQU   CSDSCFL3                                                 07420000
CSDRV015 EQU   CSDSCFL3                                                 07421000
CSDRV014 EQU   CSDSCFL2                                                 07422000
CSDRV013 EQU   CSDSCFL2                                                 07423000
CSDRV012 EQU   CSDSCFL2                                                 07424000
CSDRV011 EQU   CSDSCFL2                                                 07425000
CSDRV010 EQU   CSDSCFL2                                                 07426000
CSDRV009 EQU   CSDSCFL2                                                 07427000
CSDRV008 EQU   CSDSCFL2                                                 07428000
CSDRV007 EQU   CSDSCFL2                                                 07429000
CSDRV006 EQU   CSDSCFL1                                                 07430000
CSDRV005 EQU   CSDSCFL1                                                 07431000
CSDRV004 EQU   CSDSCFL1                                                 07432000
CSDRV003 EQU   CSDSCFL1                                                 07433000
CSDRV002 EQU   CSDSCFL1                                                 07434000
CSDRV001 EQU   CSDSCFL1                                                 07435000
CSDSYSND EQU   CSDSCFL1                                                 07436000
CSDRV042 EQU   CSDSCFL1                                                 07437000
CSDSAFF  EQU   CSDCPUAL                                                 07438000
CSDCHAD  EQU   CSD+6                                                    07439000
CSDCPUJS EQU   CSD+4                                                    07440000
CSDCSD   EQU   CSD                                                      07441000
@NM00034 EQU   SRB+40                                                   07442000
@NM00033 EQU   SRB+38                                                   07443000
SRBPRIOR EQU   SRB+37                                                   07444000
SRBPKF   EQU   SRB+36                                                   07445000
SRBSAVE  EQU   SRB+32                                                   07446000
SRBRMTR  EQU   SRB+24                                                   07447000
SRBEP    EQU   SRB+20                                                   07448000
SRBPTCB  EQU   SRBFLC+4                                                 07449000
SRBPASID EQU   SRBFLC+2                                                 07450000
SRBCPAFF EQU   SRBFLC                                                   07451000
SRBASCB  EQU   SRB+8                                                    07452000
SRBFLNK  EQU   SRB+4                                                    07453000
SRBID    EQU   SRB                                                      07454000
PVTEND   EQU   PVT+1848                                                 07455000
PVTTASID EQU   PVT+1846                                                 07456000
PVTXXXXX EQU   PVT+1844                                                 07457000
PVTMVCLC EQU   PVT+1840                                                 07458000
PVTSPARE EQU   PVT+1838                                                 07459000
PVTCHUIC EQU   PVT+1836                                                 07460000
PVTCOMFX EQU   PVT+1834                                                 07461000
PVTSQAFX EQU   PVT+1832                                                 07462000
PVTCNTFX EQU   PVT+1830                                                 07463000
PVTDEFFX EQU   PVT+1828                                                 07464000
PVTFIXOK EQU   PVT+1826                                                 07465000
PVTPEROK EQU   PVT+1824                                                 07466000
PVTMAXFX EQU   PVT+1822                                                 07467000
PVTPERFX EQU   PVT+1820                                                 07468000
PVTRSRB  EQU   PVT+1776                                                 07469000
PVTRESV5 EQU   PVT+1773                                                 07470000
PVTSRBS  EQU   PVT+1772                                                 07471000
PVTSSRB  EQU   PVT+1768                                                 07472000
PVTACA   EQU   PVTWSAX+1400                                             07473000
PVTSAVE  EQU   PVTWSAX+1328                                             07474000
PVTWSA18 EQU   PVTWSAX+1256                                             07475000
PVTWSA17 EQU   PVTWSAX+1184                                             07476000
PVTWSA16 EQU   PVTWSAX+1112                                             07477000
PVTWSA15 EQU   PVTWSAX+1040                                             07478000
PVTWSA14 EQU   PVTWSAX+968                                              07479000
PVTWSA13 EQU   PVTWSAX+896                                              07480000
PVTWSA12 EQU   PVTWSAX+824                                              07481000
PVTWSA11 EQU   PVTWSAX+752                                              07482000
PVTWSA10 EQU   PVTWSAX+672                                              07483000
PVTWSA9  EQU   PVTWSAX+592                                              07484000
PVTWSA8  EQU   PVTWSAX+504                                              07485000
PVTWSA7  EQU   PVTWSAX+432                                              07486000
PVTWSA6  EQU   PVTWSAX+360                                              07487000
PVTWSA5  EQU   PVTWSAX+288                                              07488000
PVTWSA4  EQU   PVTWSAX+216                                              07489000
PVTWSA3  EQU   PVTWSAX+144                                              07490000
PVTWSA2  EQU   PVTWSAX+72                                               07491000
PVTWSA1  EQU   PVTWSAX                                                  07492000
PVTCIOQL EQU   PVTQS+36                                                 07493000
PVTCIOQF EQU   PVTQS+32                                                 07494000
PVTGFADL EQU   PVTQS+28                                                 07495000
PVTGFADF EQU   PVTQS+24                                                 07496000
PVTFPCBL EQU   PVTQS+20                                                 07497000
PVTFPCBF EQU   PVTQS+16                                                 07498000
PVTSQAQL EQU   PVTQS+14                                                 07499000
PVTSQAQF EQU   PVTQS+12                                                 07500000
PVTCFQL  EQU   PVTQS+10                                                 07501000
PVTCFQF  EQU   PVTQS+8                                                  07502000
PVTRSRVL EQU   PVTQS+6                                                  07503000
PVTRSRVF EQU   PVTQS+4                                                  07504000
PVTAFQL  EQU   PVTQS+2                                                  07505000
PVTAFQF  EQU   PVTQS                                                    07506000
PVTSPFR  EQU   PVT+302                                                  07507000
PVTCFMCT EQU   PVT+300                                                  07508000
PVTSPREC EQU   PVT+296                                                  07509000
PVTCAREC EQU   PVT+292                                                  07510000
PVTCAOUT EQU   PVT+288                                                  07511000
PVTCAIN  EQU   PVT+284                                                  07512000
PVTNSWPS EQU   PVT+280                                                  07513000
PVTNPREC EQU   PVT+276                                                  07514000
PVTSPOUT EQU   PVT+272                                                  07515000
PVTSPIN  EQU   PVT+268                                                  07516000
PVTVAMR  EQU   PVT+264                                                  07517000
PVTVAMO  EQU   PVT+260                                                  07518000
PVTVAMI  EQU   PVT+256                                                  07519000
PVTNPOUT EQU   PVT+252                                                  07520000
PVTNPIN  EQU   PVT+248                                                  07521000
PVTPRSET EQU   PVT+244                                                  07522000
PVTFRSLT EQU   PVT+240                                                  07523000
PVTPAGIO EQU   PVT+236                                                  07524000
PVTSWPIO EQU   PVT+232                                                  07525000
PVTPSWPP EQU   PVT+228                                                  07526000
PVTPPREF EQU   PVT+224                                                  07527000
PVTPOPBR EQU   PVT+220                                                  07528000
PVTPRELF EQU   PVT+216                                                  07529000
PVTPRELV EQU   PVT+212                                                  07530000
PVTPFREE EQU   PVT+208                                                  07531000
PVTPRELS EQU   PVT+204                                                  07532000
PVTPOUT  EQU   PVT+200                                                  07533000
PVTPFXLD EQU   PVT+196                                                  07534000
PVTPITAS EQU   PVT+192                                                  07535000
PVTPSRBP EQU   PVT+188                                                  07536000
PVTPDSEG EQU   PVT+184                                                  07537000
PVTPCSGB EQU   PVT+180                                                  07538000
PVTPCSEG EQU   PVT+176                                                  07539000
PVTPINV  EQU   PVT+172                                                  07540000
PVTPSWPC EQU   PVT+168                                                  07541000
PVTPSOUT EQU   PVT+164                                                  07542000
PVTPSWIN EQU   PVT+160                                                  07543000
PVTPRCV  EQU   PVT+156                                                  07544000
PVTPRCFI EQU   PVT+152                                                  07545000
PVTPRCF  EQU   PVT+148                                                  07546000
PVTPVRC  EQU   PVT+144                                                  07547000
PVTPVRIN EQU   PVT+140                                                  07548000
PVTPVRLS EQU   PVT+136                                                  07549000
PVTPVEQR EQU   PVT+132                                                  07550000
PVTPPIOI EQU   PVT+128                                                  07551000
PVTPVRPO EQU   PVT+124                                                  07552000
PVTPRFR  EQU   PVT+120                                                  07553000
PVTPFP2  EQU   PVT+116                                                  07554000
PVTPFP   EQU   PVT+112                                                  07555000
PVTPFTE  EQU   PVT+108                                                  07556000
PVTPCB   EQU   PVT+104                                                  07557000
PVTREP2  EQU   PVT+100                                                  07558000
PVTPIOCP EQU   PVT+96                                                   07559000
PVTPIOP  EQU   PVT+92                                                   07560000
PVTPGFAD EQU   PVT+88                                                   07561000
PVTPGFA  EQU   PVT+84                                                   07562000
PVTPSQA  EQU   PVT+80                                                   07563000
PVTPSINT EQU   PVT+76                                                   07564000
PVTPSIB  EQU   PVT+72                                                   07565000
PVTSRBID EQU   PVT+68                                                   07566000
PVTPCIWA EQU   PVT+64                                                   07567000
PVTHQSA  EQU   PVT+62                                                   07568000
PVTLQSA  EQU   PVT+60                                                   07569000
PVTOROOT EQU   PVT+56                                                   07570000
PVTPRCA  EQU   PVT+52                                                   07571000
PVTREUS  EQU   PVT+48                                                   07572000
PVTSQNPC EQU   PVT+47                                                   07573000
PVTSQVRC EQU   PVT+46                                                   07574000
PVTRSUS  EQU   PVT+44                                                   07575000
PVTVROOT EQU   PVT+40                                                   07576000
PVTPCBLO EQU   PVT+38                                                   07577000
PVTPCBCT EQU   PVT+36                                                   07578000
PVTDFRS  EQU   PVT+34                                                   07579000
PVTRSQA  EQU   PVT+32                                                   07580000
PVTPTLB  EQU   PVT+31                                                   07581000
PVTPCBNO EQU   PVT+30                                                   07582000
PVTSRBNO EQU   PVT+29                                                   07583000
PVTSQDC  EQU   PVT+28                                                   07584000
PVTLCSA  EQU   PVT+26                                                   07585000
PVTLPRIV EQU   PVT+24                                                   07586000
PVTLVR   EQU   PVT+22                                                   07587000
PVTFVR   EQU   PVT+20                                                   07588000
PVTLPFN  EQU   PVT+18                                                   07589000
PVTFPFN  EQU   PVT+16                                                   07590000
PVTPFTP  EQU   PVT+12                                                   07591000
PVTSSPIN EQU   PVT+11                                                   07592000
PVTPCBS  EQU   PVT+10                                                   07593000
PVTPOOL  EQU   PVT+8                                                    07594000
PVTAFCOK EQU   PVT+6                                                    07595000
PVTAFCLO EQU   PVT+4                                                    07596000
PVTAFC   EQU   PVT+2                                                    07597000
@NM00032 EQU   PVTFLAG2                                                 07598000
PVTRSMGM EQU   PVTFLAG2                                                 07599000
PVTDUMP  EQU   PVTFLAG1                                                 07600000
PVTSIT   EQU   PVTFLAG1                                                 07601000
PVTLSI   EQU   PVTFLAG1                                                 07602000
PVTPCBLT EQU   PVTFLAG1                                                 07603000
PVTSRBIU EQU   PVTFLAG1                                                 07604000
PVTBGMS  EQU   PVTFLAG1                                                 07605000
PVTPMSG  EQU   PVTFLAG1                                                 07606000
CVTLEVL  EQU   CVTRELNO+2                                               07607000
CVTNUMB  EQU   CVTRELNO                                                 07608000
CVTMDL   EQU   CVTFIX+250                                               07609000
@NM00007 EQU   CVTFIX+248                                               07610000
@NM00006 EQU   CVTFIX                                                   07611000
CVTRV482 EQU   CVTXTNT2+128                                             07612000
CVTRV481 EQU   CVTXTNT2+124                                             07613000
CVTRV480 EQU   CVTXTNT2+120                                             07614000
CVTRV479 EQU   CVTXTNT2+118                                             07615000
CVTRV478 EQU   CVTXTNT2+117                                             07616000
CVTRV477 EQU   CVTXTNT2+116                                             07617000
CVTRV476 EQU   CVTXTNT2+115                                             07618000
CVTRV475 EQU   CVTXTNT2+114                                             07619000
CVTRV474 EQU   CVTRV466                                                 07620000
CVTRV473 EQU   CVTRV466                                                 07621000
CVTRV472 EQU   CVTRV466                                                 07622000
CVTRV471 EQU   CVTRV466                                                 07623000
CVTRV470 EQU   CVTRV466                                                 07624000
CVTRV469 EQU   CVTRV466                                                 07625000
CVTRV468 EQU   CVTRV466                                                 07626000
CVTRV467 EQU   CVTRV466                                                 07627000
CVTRV465 EQU   CVTRV457                                                 07628000
CVTRV464 EQU   CVTRV457                                                 07629000
CVTRV463 EQU   CVTRV457                                                 07630000
CVTRV462 EQU   CVTRV457                                                 07631000
CVTRV461 EQU   CVTRV457                                                 07632000
CVTRV460 EQU   CVTRV457                                                 07633000
CVTRV459 EQU   CVTRV457                                                 07634000
CVTRV458 EQU   CVTRV457                                                 07635000
CVTRV456 EQU   CVTXTNT2+108                                             07636000
CVTRV455 EQU   CVTXTNT2+104                                             07637000
CVTRV454 EQU   CVTXTNT2+100                                             07638000
CVTRV453 EQU   CVTXTNT2+96                                              07639000
CVTRV452 EQU   CVTXTNT2+94                                              07640000
CVTRV451 EQU   CVTXTNT2+92                                              07641000
CVTRV450 EQU   CVTXTNT2+90                                              07642000
CVTRV449 EQU   CVTXTNT2+88                                              07643000
CVTRV448 EQU   CVTXTNT2+87                                              07644000
CVTRV447 EQU   CVTXTNT2+86                                              07645000
CVTRV446 EQU   CVTRV438                                                 07646000
CVTRV445 EQU   CVTRV438                                                 07647000
CVTRV444 EQU   CVTRV438                                                 07648000
CVTRV443 EQU   CVTRV438                                                 07649000
CVTRV442 EQU   CVTRV438                                                 07650000
CVTRV441 EQU   CVTRV438                                                 07651000
CVTRV440 EQU   CVTRV438                                                 07652000
CVTRV439 EQU   CVTRV438                                                 07653000
CVTRV437 EQU   CVTRV429                                                 07654000
CVTRV436 EQU   CVTRV429                                                 07655000
CVTRV435 EQU   CVTRV429                                                 07656000
CVTRV434 EQU   CVTRV429                                                 07657000
CVTRV433 EQU   CVTRV429                                                 07658000
CVTRV432 EQU   CVTRV429                                                 07659000
CVTRV431 EQU   CVTRV429                                                 07660000
CVTRV430 EQU   CVTRV429                                                 07661000
CVTRV428 EQU   CVTXTNT2+80                                              07662000
CVTRV427 EQU   CVTXTNT2+76                                              07663000
CVTRV426 EQU   CVTXTNT2+72                                              07664000
CVTRV425 EQU   CVTXTNT2+68                                              07665000
CVTATACT EQU   CVTATCVT                                                 07666000
CVTRV423 EQU   CVTXTNT2+62                                              07667000
CVTRV422 EQU   CVTXTNT2+60                                              07668000
CVTRV421 EQU   CVTXTNT2+58                                              07669000
CVTRV420 EQU   CVTXTNT2+56                                              07670000
CVTRV419 EQU   CVTXTNT2+55                                              07671000
CVTRV418 EQU   CVTXTNT2+54                                              07672000
CVTRV417 EQU   CVTRV409                                                 07673000
CVTRV416 EQU   CVTRV409                                                 07674000
CVTRV415 EQU   CVTRV409                                                 07675000
CVTRV414 EQU   CVTRV409                                                 07676000
CVTRV413 EQU   CVTRV409                                                 07677000
CVTRV412 EQU   CVTRV409                                                 07678000
CVTRV411 EQU   CVTRV409                                                 07679000
CVTRV410 EQU   CVTRV409                                                 07680000
CVTRV408 EQU   CVTRV400                                                 07681000
CVTRV407 EQU   CVTRV400                                                 07682000
CVTRV406 EQU   CVTRV400                                                 07683000
CVTRV405 EQU   CVTRV400                                                 07684000
CVTRV404 EQU   CVTRV400                                                 07685000
CVTRV403 EQU   CVTRV400                                                 07686000
CVTRV402 EQU   CVTRV400                                                 07687000
CVTRV401 EQU   CVTRV400                                                 07688000
CVTICB   EQU   CVTXTNT2+48                                              07689000
CVTSKTA  EQU   CVTXTNT2+44                                              07690000
CVTCCVT  EQU   CVTXTNT2+40                                              07691000
CVTRSV98 EQU   CVTXTNT2+36                                              07692000
CVTRSV97 EQU   CVTXTNT2+34                                              07693000
CVTRSV96 EQU   CVTXTNT2+32                                              07694000
CVTOLTEP EQU   CVTXTNT2+28                                              07695000
CVTQIDA  EQU   CVTQID+1                                                 07696000
CVTRSV95 EQU   CVTQID                                                   07697000
CVTRSV94 EQU   CVTXTNT2+20                                              07698000
CVTRSV93 EQU   CVTXTNT2+16                                              07699000
CVTRSV92 EQU   CVTXTNT2+12                                              07700000
CVTDEBVR EQU   CVTXTNT2+8                                               07701000
CVTRSV91 EQU   CVTXTNT2+6                                               07702000
CVTRSV9H EQU   CVTFLGBT                                                 07703000
CVTRSV9G EQU   CVTFLGBT                                                 07704000
CVTRSV9F EQU   CVTFLGBT                                                 07705000
CVTRSV9E EQU   CVTFLGBT                                                 07706000
CVTRSV9D EQU   CVTFLGBT                                                 07707000
CVTRSV9C EQU   CVTFLGBT                                                 07708000
CVTVME   EQU   CVTFLGBT                                                 07709000
CVTNPE   EQU   CVTFLGBT                                                 07710000
CVTNUCLS EQU   CVTXTNT2+4                                               07711000
CVTDSSVA EQU   CVTDSSV+1                                                07712000
CVTRSV89 EQU   CVTDSSV                                                  07713000
CVTRSV88 EQU   CVTXTNT1+8                                               07714000
CVTRSV87 EQU   CVTXTNT1+4                                               07715000
CVTFACHN EQU   CVTXTNT1                                                 07716000
CVTRV488 EQU   CVTMAP+412                                               07717000
CVTRV487 EQU   CVTMAP+408                                               07718000
CVTRV486 EQU   CVTMAP+404                                               07719000
CVTRV485 EQU   CVTMAP+400                                               07720000
CVTACTAP EQU   CVTMAP+396                                               07721000
CVTAUTH  EQU   CVTMAP+392                                               07722000
CVTATMCA EQU   CVTATMCT+1                                               07723000
CVTATMST EQU   CVTATMCT                                                 07724000
CVTRSV61 EQU   CVTMAP+384                                               07725000
CVTVOLT1 EQU   CVTVOLM1+1                                               07726000
CVTVOLI1 EQU   CVTVOLF1                                                 07727000
CVTSTOA  EQU   CVTMAP+376                                               07728000
CVTRSV58 EQU   CVTMAP+374                                               07729000
CVTRSV57 EQU   CVTMAP+372                                               07730000
CVTDDCE  EQU   CVTMAP+368                                               07731000
CVTPNWFR EQU   CVTMAP+364                                               07732000
CVTSMF   EQU   CVTMAP+360                                               07733000
CVTSULK  EQU   CVTMAP+358                                               07734000
CVTSLKO  EQU   CVTSYSK                                                  07735000
CVTSLKP  EQU   CVTSYSK                                                  07736000
CVTSLKQ  EQU   CVTSYSK                                                  07737000
CVTSLKR  EQU   CVTSYSK                                                  07738000
CVTRSV56 EQU   CVTSYSK                                                  07739000
CVTRSV55 EQU   CVTSYSK                                                  07740000
CVTRSV54 EQU   CVTSYSK                                                  07741000
CVTRSV53 EQU   CVTSYSK                                                  07742000
CVTRSV52 EQU   CVTA1F1                                                  07743000
CVTRSV51 EQU   CVTA1F1                                                  07744000
CVTRSV50 EQU   CVTA1F1                                                  07745000
CVTRSV49 EQU   CVTA1F1                                                  07746000
CVTRSV48 EQU   CVTA1F1                                                  07747000
CVTRSV47 EQU   CVTA1F1                                                  07748000
CVTSRSW  EQU   CVTA1F1                                                  07749000
CVTPFSW  EQU   CVTA1F1                                                  07750000
CVTPCVT  EQU   CVTMAP+352                                               07751000
CVTRSV46 EQU   CVTMAP+344                                               07752000
CVTRSV45 EQU   CVTMAP+340                                               07753000
CVTRSV44 EQU   CVTMAP+338                                               07754000
CVTRSV43 EQU   CVTMAP+336                                               07755000
CVTHJESA EQU   CVTHJES+1                                                07756000
CVTRSV42 EQU   CVTHJES                                                  07757000
CVTEXT2A EQU   CVTEXT2+1                                                07758000
CVTRSV41 EQU   CVTEXT2                                                  07759000
CVTAPFA  EQU   CVTAPF+1                                                 07760000
CVTRSV40 EQU   CVTAPF                                                   07761000
CVTRV518 EQU   CVTINTLA                                                 07762000
CVTRV517 EQU   CVTERPV                                                  07763000
CVTEORM  EQU   CVTMAP+312                                               07764000
CVTMCHPR EQU   CVTMAP+308                                               07765000
CVTTZ    EQU   CVTMAP+304                                               07766000
CVTJEPS  EQU   CVTMAP+300                                               07767000
CVTJESCT EQU   CVTMAP+296                                               07768000
CVTMODE  EQU   CVTMAP+292                                               07769000
CVTPTRV  EQU   CVTMAP+288                                               07770000
CVTREAL  EQU   CVTMAP+284                                               07771000
CVTRSV39 EQU   CVTMAP+280                                               07772000
CVTRSV38 EQU   CVTMAP+276                                               07773000
CVTDMSRA EQU   CVTDMSR+1                                                07774000
CVTRV634 EQU   CVTDMSRF                                                 07775000
CVTRV633 EQU   CVTDMSRF                                                 07776000
CVTRV632 EQU   CVTDMSRF                                                 07777000
CVTRV631 EQU   CVTDMSRF                                                 07778000
CVTRV630 EQU   CVTDMSRF                                                 07779000
CVTRV629 EQU   CVTDMSRF                                                 07780000
CVTUDUMP EQU   CVTDMSRF                                                 07781000
CVTSDUMP EQU   CVTDMSRF                                                 07782000
CVTQMSGA EQU   CVTQMSG+1                                                07783000
CVTRSV36 EQU   CVTQMSG                                                  07784000
CVTAMFF  EQU   CVTMAP+264                                               07785000
CVTPURGA EQU   CVTPURG+1                                                07786000
CVTRSV35 EQU   CVTPURG                                                  07787000
CVTCBSP  EQU   CVTMAP+256                                               07788000
CVTATERA EQU   CVTATER+1                                                07789000
CVTSYST  EQU   CVTATER                                                  07790000
CVTVOLT2 EQU   CVTTAT                                                   07791000
CVTVOLI2 EQU   CVTVOLF2                                                 07792000
CVTAQAVB EQU   CVTAQAVT+1                                               07793000
CVTRSV34 EQU   CVTTCMFG                                                 07794000
CVTRSV33 EQU   CVTTCMFG                                                 07795000
CVTRSV32 EQU   CVTTCMFG                                                 07796000
CVTRSV31 EQU   CVTTCMFG                                                 07797000
CVTRSV30 EQU   CVTTCMFG                                                 07798000
CVTRSV29 EQU   CVTTCMFG                                                 07799000
CVTLDEV  EQU   CVTTCMFG                                                 07800000
CVTTCRDY EQU   CVTTCMFG                                                 07801000
CVTGTFA  EQU   CVTGTF+1                                                 07802000
CVTRSV27 EQU   CVTGTFST                                                 07803000
CVTRNIO  EQU   CVTGTFST                                                 07804000
CVTUSR   EQU   CVTGTFST                                                 07805000
CVTRV318 EQU   CVTFORM                                                  07806000
CVTRV317 EQU   CVTTMODE                                                 07807000
CVTRV316 EQU   CVTSTATE                                                 07808000
CVTRV315 EQU   CVTGTFS                                                  07809000
CVTGTFAV EQU   CVTGTFS                                                  07810000
CVT0SCR1 EQU   CVTMAP+232                                               07811000
CVTRV515 EQU   CVTMAP+228                                               07812000
CVTRMS   EQU   CVTMAP+224                                               07813000
CVTPATCH EQU   CVTMAP+220                                               07814000
CVTTSCE  EQU   CVTMAP+216                                               07815000
CVTLNKSC EQU   CVTMAP+214                                               07816000
CVTQABST EQU   CVTMAP+212                                               07817000
CVTMDLDS EQU   CVTMAP+208                                               07818000
CVTUSER  EQU   CVTMAP+204                                               07819000
CVTABEND EQU   CVTMAP+200                                               07820000
CVTSMCA  EQU   CVTMAP+196                                               07821000
CVTRSV18 EQU   CVTMAP+192                                               07822000
CVTQLPAQ EQU   CVTMAP+188                                               07823000
CVTQCDSR EQU   CVTMAP+184                                               07824000
CVTRSV17 EQU   CVTOPTB                                                  07825000
CVTRSV16 EQU   CVTOPTB                                                  07826000
CVTFP    EQU   CVTOPTB                                                  07827000
CVTAPTHR EQU   CVTOPTB                                                  07828000
CVTNLOG  EQU   CVTOPTB                                                  07829000
CVTTOD   EQU   CVTOPTB                                                  07830000
CVTCTIMS EQU   CVTOPTB                                                  07831000
CVTPROT  EQU   CVTOPTB                                                  07832000
CVTXPFP  EQU   CVTOPTA                                                  07833000
CVTASCII EQU   CVTOPTA                                                  07834000
CVTRSV13 EQU   CVTOPTA                                                  07835000
CVTRSV12 EQU   CVTOPTA                                                  07836000
CVTNIP   EQU   CVTOPTA                                                  07837000
CVTDDR   EQU   CVTOPTA                                                  07838000
CVTAPR   EQU   CVTOPTA                                                  07839000
CVTCCH   EQU   CVTOPTA                                                  07840000
CVTSNCTR EQU   CVTMAP+180                                               07841000
CVTQMWR  EQU   CVTMAP+176                                               07842000
CVTQOCR  EQU   CVTMAP+172                                               07843000
CVT1EF00 EQU   CVTMAP+168                                               07844000
CVTMZ00  EQU   CVTMAP+164                                               07845000
CVTSV76Q EQU   CVTSV76C                                                 07846000
CVTRSV11 EQU   CVTMAP+156                                               07847000
CVT0PT01 EQU   CVTMAP+152                                               07848000
CVTMSER  EQU   CVTMAP+148                                               07849000
CVTRV516 EQU   CVTIERLC                                                 07850000
CVTILCH  EQU   CVTMAP+140                                               07851000
CVT0DS   EQU   CVTMAP+136                                               07852000
CVTFBOSV EQU   CVTMAP+132                                               07853000
CVTNUCB  EQU   CVTMAP+128                                               07854000
CVTIXAVL EQU   CVTMAP+124                                               07855000
CVTSV76M EQU   CVTIOQET                                                 07856000
CVTDCBA  EQU   CVTMAP+117                                               07857000
CVTMVS2  EQU   CVTDCB                                                   07858000
CVT6DAT  EQU   CVTDCB                                                   07859000
CVT4MPS  EQU   CVTDCB                                                   07860000
CVTRSV09 EQU   CVTDCB                                                   07861000
CVT4MS1  EQU   CVTDCB                                                   07862000
CVT2SPS  EQU   CVTDCB                                                   07863000
CVT1SSS  EQU   CVTDCB                                                   07864000
CVTRSV08 EQU   CVTDCB                                                   07865000
CVTSTB   EQU   CVTMAP+112                                               07866000
CVTQTD00 EQU   CVTMAP+108                                               07867000
CVTQTE00 EQU   CVTMAP+104                                               07868000
CVTCUCB  EQU   CVTMAP+100                                               07869000
CVTSJQ   EQU   CVTMAP+96                                                07870000
CVTPBLDL EQU   CVTMAP+92                                                07871000
CVTTPC   EQU   CVTMAP+88                                                07872000
CVTSVDCB EQU   CVTMAP+84                                                07873000
CVTBRET  EQU   CVTMAP+82                                                07874000
CVTEXIT  EQU   CVTMAP+80                                                07875000
CVT0FN00 EQU   CVTMAP+76                                                07876000
CVTDARA  EQU   CVTDAR+1                                                 07877000
CVTRSV07 EQU   CVTFLGS1                                                 07878000
CVTRSV06 EQU   CVTFLGS1                                                 07879000
CVTRSV05 EQU   CVTFLGS1                                                 07880000
CVTRSV04 EQU   CVTFLGS1                                                 07881000
CVTRSV03 EQU   CVTFLGS1                                                 07882000
CVTRSV02 EQU   CVTFLGS1                                                 07883000
CVTRSV01 EQU   CVTFLGS1                                                 07884000
CVTDMPLK EQU   CVTFLGS1                                                 07885000
CVTXITP  EQU   CVTMAP+68                                                07886000
CVTZDTAB EQU   CVTMAP+64                                                07887000
CVTMSLT  EQU   CVTMAP+60                                                07888000
CVTDATE  EQU   CVTMAP+56                                                07889000
CVTBTERM EQU   CVTMAP+52                                                07890000
CVTSYSAD EQU   CVTMAP+48                                                07891000
CVTXTLER EQU   CVTMAP+44                                                07892000
CVTILK2  EQU   CVTMAP+40                                                07893000
CVTILK1  EQU   CVTMAP+36                                                07894000
CVTPRLTV EQU   CVTMAP+32                                                07895000
CVTPCNVT EQU   CVTMAP+28                                                07896000
CVT0VL00 EQU   CVTMAP+24                                                07897000
CVTXAPG  EQU   CVTMAP+20                                                07898000
CVTBUF   EQU   CVTMAP+16                                                07899000
CVTJOB   EQU   CVTMAP+12                                                07900000
CVTLINK  EQU   CVTMAP+8                                                 07901000
CVT0EF00 EQU   CVTMAP+4                                                 07902000
CVTTCBP  EQU   CVTMAP                                                   07903000
DMDTEND  EQU   DMDT+20                                                  07904000
DMDTRUC  EQU   DMDT+16                                                  07905000
DMDTINCU EQU   DMDT+14                                                  07906000
DMDTOUTU EQU   DMDT+12                                                  07907000
DMDTCMPL EQU   DMDT+10                                                  07908000
DMDTGOOU EQU   DMDT+8                                                   07909000
DMDTRUA  EQU   DMDT+6                                                   07910000
DMDTNO   EQU   DMDT                                                     07911000
RQSVEND  EQU   RQSV+20                                                  07912000
RQSVRSV  EQU   RQSV+16                                                  07913000
ASVTEND  EQU   ASVT+528                                                 07914000
ASVTAVAL EQU   ASVTENTY                                                 07915000
ASVTAVAI EQU   ASVTFRST                                                 07916000
ASVTRS00 EQU   ASVT+520                                                 07917000
ASVTASVT EQU   ASVT+512                                                 07918000
ASVTBEGN EQU   ASVT+512                                                 07919000
@NM00005 EQU   ASVT                                                     07920000
WAMPEND  EQU   WAMP+44                                                  07921000
WAMPRSV  EQU   WAMPPGP+42                                               07922000
WAMPDMN  EQU   WAMPPGP+41                                               07923000
WAMPOBJN EQU   WAMPPGP+40                                               07924000
WAMPSWC  EQU   WAMPPGP+36                                               07925000
WAMPTRR  EQU   WAMPPGP+32                                               07926000
WAMPMSO  EQU   WAMPPGP+28                                               07927000
WAMPIOC  EQU   WAMPPGP+24                                               07928000
WAMPCPU  EQU   WAMPPGP+20                                               07929000
WAMPNWL  EQU   WAMPPGP+16                                               07930000
WAMPTET  EQU   WAMPPGP+12                                               07931000
WAMPSRV  EQU   WAMPPGP+8                                                07932000
WAMPTAT  EQU   WAMPPGP+4                                                07933000
WAMPTRN  EQU   WAMPPGP                                                  07934000
WAMTEND  EQU   WAMT+64                                                  07935000
WAMTR90  EQU   WAMT+60                                                  07936000
WAMTNX0  EQU   WAMT+52                                                  07937000
WAMTIPM  EQU   WAMT+48                                                  07938000
WAMTIPI  EQU   WAMT+44                                                  07939000
WAMTIPC  EQU   WAMT+40                                                  07940000
WAMTHPG  EQU   WAMT+38                                                  07941000
WAMTSPD  EQU   WAMT+36                                                  07942000
WAMTCPD  EQU   WAMT+34                                                  07943000
WAMTIPS  EQU   WAMT+32                                                  07944000
WAMTTCB  EQU   WAMT+28                                                  07945000
WAMTASD  EQU   WAMT+24                                                  07946000
WAMTTOC  EQU   WAMT+16                                                  07947000
WAMTTMA  EQU   WAMT+8                                                   07948000
WAMTSIZ  EQU   WAMT+4                                                   07949000
WPGLEND  EQU   WPGL+4                                                   07950000
WPGLDUR  EQU   WPGLISV                                                  07951000
WPGPEND  EQU   WPGP+8                                                   07952000
WPGPDURP EQU   WPGP+7                                                   07953000
WPGPISVP EQU   WPGP+6                                                   07954000
WPGPRTB  EQU   WPGPINDS                                                 07955000
WPGPRB2  EQU   WPGPINDS                                                 07956000
WPGPUNT  EQU   WPGPINDS                                                 07957000
@NM00004 EQU   WPGP+2                                                   07958000
WPGPOBJN EQU   WPGP                                                     07959000
WPGDEND  EQU   WPGD+20                                                  07960000
WPGDPGL  EQU   WPGD+20                                                  07961000
WPGDDURP EQU   WPGDPGP+7                                                07962000
WPGDISVP EQU   WPGDPGP+6                                                07963000
WPGDRTB  EQU   WPGDINDS                                                 07964000
WPGDRB2  EQU   WPGDINDS                                                 07965000
WPGDAPG  EQU   WPGDINDS                                                 07966000
WPGDUNT  EQU   WPGDINDS                                                 07967000
WPGDFIN  EQU   WPGDINDS                                                 07968000
WPGDAPGV EQU   WPGDPGP+4                                                07969000
@NM00003 EQU   WPGDPGP+2                                                07970000
WPGDDMN  EQU   WPGDPGP+1                                                07971000
WPGDOBJN EQU   WPGDPGP                                                  07972000
WPGDISV  EQU   WPGD+8                                                   07973000
WPGDATM  EQU   WPGD+4                                                   07974000
WPGDRD1  EQU   WPGDDFL                                                  07975000
WPGDVLD  EQU   WPGDDFL                                                  07976000
WPGDR02  EQU   WPGD+2                                                   07977000
WPGDSIZ  EQU   WPGD+1                                                   07978000
WMSTEND  EQU   WMST+112                                                 07979000
WMSTIPM  EQU   WMST+108                                                 07980000
WMSTIPI  EQU   WMST+104                                                 07981000
WMSTIPC  EQU   WMST+100                                                 07982000
WMSTRSVD EQU   WMST+81                                                  07983000
WMSTREAL EQU   WMST+80                                                  07984000
WMSTMSO  EQU   WMST+76                                                  07985000
WMSTIOC  EQU   WMST+72                                                  07986000
WMSTCPU  EQU   WMST+68                                                  07987000
WMSTDMNC EQU   WMST+66                                                  07988000
WMSTPGPC EQU   WMST+64                                                  07989000
WMSTWLHI EQU   WMST+60                                                  07990000
WMSTDMDE EQU   WMST+56                                                  07991000
WMSTDMDS EQU   WMST+44                                                  07992000
WMSTPODS EQU   WMST+36                                                  07993000
WMSTPODT EQU   WMST+32                                                  07994000
WMSTPOVS EQU   WMST+28                                                  07995000
WMSTPOVT EQU   WMST+24                                                  07996000
WMSTPGDS EQU   WMST+20                                                  07997000
WMSTPGVS EQU   WMST+12                                                  07998000
WMSTWLLO EQU   WMST+6                                                   07999000
WMSTID   EQU   WMST+4                                                   08000000
WMSTNAME EQU   WMST                                                     08001000
RMEPSND  EQU   RMEP+32                                                  08002000
RMEPINT  EQU   RMEPSCH+12                                               08003000
RMEPTME  EQU   RMEPSCH+8                                                08004000
RMEPBCK  EQU   RMEPSCH+4                                                08005000
RMEPFWD  EQU   RMEPSCH                                                  08006000
RMEPEND  EQU   RMEP+16                                                  08007000
RMEPPRV  EQU   RMEPEPB+12                                               08008000
RMEPACN  EQU   RMEPFLG+3                                                08009000
RMEPTMD  EQU   RMEPFLG+3                                                08010000
RMEPRCR  EQU   RMEPFLG+3                                                08011000
RMEPVFL  EQU   RMEPFLG                                                  08012000
RMEPERA  EQU   RMEPEPB+4                                                08013000
RMEPEPA  EQU   RMEPEPB                                                  08014000
ASXBEND  EQU   ASXB+232                                                 08015000
ASXBRV25 EQU   ASXB+228                                                 08016000
ASXBRV24 EQU   ASXB+224                                                 08017000
ASXBPT0E EQU   ASXB+220                                                 08018000
ASXBCRB4 EQU   ASXBCASW+3                                               08019000
ASXBCRB3 EQU   ASXBCASW+2                                               08020000
ASXBCRB2 EQU   ASXBCASW+1                                               08021000
ASXBCR06 EQU   ASXBCRB1                                                 08022000
ASXBCR05 EQU   ASXBCRB1                                                 08023000
ASXBCR04 EQU   ASXBCRB1                                                 08024000
ASXBCR03 EQU   ASXBCRB1                                                 08025000
ASXBCR02 EQU   ASXBCRB1                                                 08026000
ASXBCR01 EQU   ASXBCRB1                                                 08027000
ASXBTFD  EQU   ASXBCRB1                                                 08028000
ASXBPIP  EQU   ASXBCRB1                                                 08029000
ASXBCTDC EQU   ASXB+212                                                 08030000
ASXBTDCB EQU   ASXB+208                                                 08031000
ASXBRV19 EQU   ASXB+204                                                 08032000
ASXBSENV EQU   ASXBSECR+1                                               08033000
ASXBRV34 EQU   ASCBSFLG                                                 08034000
ASXBRV33 EQU   ASCBSFLG                                                 08035000
ASXBRV32 EQU   ASCBSFLG                                                 08036000
ASXBRV31 EQU   ASCBSFLG                                                 08037000
ASXBRV30 EQU   ASCBSFLG                                                 08038000
ASXBRV29 EQU   ASCBSFLG                                                 08039000
ASXBRV28 EQU   ASCBSFLG                                                 08040000
ASXBRV27 EQU   ASCBSFLG                                                 08041000
ASXBUSER EQU   ASXB+192                                                 08042000
ASXBLSRB EQU   ASXBAEQ+20                                               08043000
ASXBFSRB EQU   ASXBAEQ+16                                               08044000
ASXBLRQE EQU   ASXBAEQ+12                                               08045000
ASXBFRQE EQU   ASXBAEQ+8                                                08046000
ASXBLIQE EQU   ASXBAEQ+4                                                08047000
ASXBFIQE EQU   ASXBAEQ                                                  08048000
ASXBETSK EQU   ASXB+164                                                 08049000
ASXBSIRB EQU   ASXB+160                                                 08050000
ASXBPSWD EQU   ASXB+152                                                 08051000
ASXBPRG  EQU   ASXB+136                                                 08052000
ASXBRV26 EQU   ASXB+132                                                 08053000
ASXBDDR  EQU   ASXB+124                                                 08054000
ASXBRCTD EQU   ASXB+120                                                 08055000
ASXBRSMD EQU   ASXB+116                                                 08056000
ASXBSPSA EQU   ASXB+112                                                 08057000
ASXBFRWA EQU   ASXB+108                                                 08058000
ASXBFLSA EQU   ASXB+36                                                  08059000
ASXBIHSA EQU   ASXB+32                                                  08060000
ASXBRV15 EQU   ASXB+28                                                  08061000
ASXBRV14 EQU   ASXB+24                                                  08062000
ASXBLWA  EQU   ASXB+20                                                  08063000
ASXBMPST EQU   ASXB+16                                                  08064000
ASXBRS00 EQU   ASXB+14                                                  08065000
ASXBTCBS EQU   ASXB+12                                                  08066000
ASXBLTCB EQU   ASXB+8                                                   08067000
ASXBFTCB EQU   ASXB+4                                                   08068000
ASXBASXB EQU   ASXB                                                     08069000
ASXBEGIN EQU   ASXB                                                     08070000
OUSBEND  EQU   OUSB+136                                                 08071000
OUSBR90  EQU   OUSB+132                                                 08072000
OUSBNAME EQU   OUSB                                                     08073000
OUXBEND  EQU   OUXB+144                                                 08074000
OUXBFIXC EQU   OUXB+138                                                 08075000
OUXBUIC  EQU   OUXB+134                                                 08076000
OUXBRSV1 EQU   OUXB+126                                                 08077000
OUXBPRS  EQU   OUXB+120                                                 08078000
OUXBMSS  EQU   OUXB+104                                                 08079000
OUXBIOSM EQU   OUXB+56                                                  08080000
OUXBIOS  EQU   OUXB+52                                                  08081000
OUXBMET  EQU   OUXB+8                                                   08082000
OUCBEND  EQU   OUCB+136                                                 08083000
OUCBTIO  EQU   OUCB+128                                                 08084000
OUCBTCP  EQU   OUCB+124                                                 08085000
OUCBTMP  EQU   OUCB+104                                                 08086000
OUCBR03  EQU   OUCB+102                                                 08087000
OUCBCRV  EQU   OUCB+98                                                  08088000
OUCBIRV  EQU   OUCB+96                                                  08089000
OUCBWMR  EQU   OUCB+92                                                  08090000
OUCBCMRV EQU   OUCB+88                                                  08091000
OUCBCF2  EQU   OUCBCFL                                                  08092000
OUCBACN  EQU   OUCBCSW                                                  08093000
OUCBACT  EQU   OUCB+80                                                  08094000
OUCBTMO  EQU   OUCB+72                                                  08095000
OUCBMSO  EQU   OUCB+64                                                  08096000
OUCBIOC  EQU   OUCB+60                                                  08097000
OUCBCPU  EQU   OUCB+56                                                  08098000
OUCBTMW  EQU   OUCB+48                                                  08099000
OUCBSWC  EQU   OUCB+38                                                  08100000
OUCBR40  EQU   OUCB+30                                                  08101000
OUCBR30  EQU   OUCB+29                                                  08102000
OUCBUF7  EQU   OUCBUFL                                                  08103000
OUCBUF6  EQU   OUCBUFL                                                  08104000
OUCBUF5  EQU   OUCBUFL                                                  08105000
OUCBMAR  EQU   OUCBTFL                                                  08106000
OUCBPCH  EQU   OUCBTFL                                                  08107000
OUCBRTR  EQU   OUCBTFL                                                  08108000
OUCBNTR  EQU   OUCBTFL                                                  08109000
OUCBNWT  EQU   OUCBAFL                                                  08110000
OUCBR02  EQU   OUCBAFL                                                  08111000
OUCBAF0  EQU   OUCBAFL                                                  08112000
OUCBPSTE EQU   OUCBYFL                                                  08113000
OUCBSCN  EQU   OUCBSFL                                                  08114000
OUCBQF7  EQU   OUCBQFL                                                  08115000
OUCBQF6  EQU   OUCBQFL                                                  08116000
OUCBTMA  EQU   OUCB+12                                                  08117000
OUCBNAME EQU   OUCB                                                     08118000
ASCBEND  EQU   ASCB+208                                                 08119000
ASCBSWTL EQU   ASCB+196                                                 08120000
ASCBRS14 EQU   ASCB+195                                                 08121000
ASCBSMCT EQU   ASCB+194                                                 08122000
ASCBRS12 EQU   ASCB+192                                                 08123000
ASCBPCTT EQU   ASCB+188                                                 08124000
ASCBVGTT EQU   ASCB+184                                                 08125000
ASCBRV43 EQU   ASCBSRQ4                                                 08126000
ASCBRV42 EQU   ASCBSRQ4                                                 08127000
ASCBRV41 EQU   ASCBSRQ4                                                 08128000
ASCBRV40 EQU   ASCBSRQ4                                                 08129000
ASCBRV39 EQU   ASCBSRQ4                                                 08130000
ASCBRV38 EQU   ASCBSRQ4                                                 08131000
ASCBRV37 EQU   ASCBSRQ4                                                 08132000
ASCBRV36 EQU   ASCBSRQ4                                                 08133000
ASCBRV35 EQU   ASCBSRQ3                                                 08134000
ASCBRV34 EQU   ASCBSRQ3                                                 08135000
ASCBRV33 EQU   ASCBSRQ3                                                 08136000
ASCBRV32 EQU   ASCBSRQ3                                                 08137000
ASCBRV31 EQU   ASCBSRQ3                                                 08138000
ASCBRV30 EQU   ASCBSRQ3                                                 08139000
ASCBRV29 EQU   ASCBSRQ3                                                 08140000
ASCBRV28 EQU   ASCBSRQ3                                                 08141000
ASCBRV27 EQU   ASCBSRQ2                                                 08142000
ASCBRV26 EQU   ASCBSRQ2                                                 08143000
ASCBRV25 EQU   ASCBSRQ2                                                 08144000
ASCBRV24 EQU   ASCBSRQ2                                                 08145000
ASCBRV23 EQU   ASCBSRQ2                                                 08146000
ASCBRV22 EQU   ASCBSRQ2                                                 08147000
ASCBRV21 EQU   ASCBSRQ2                                                 08148000
ASCBRV20 EQU   ASCBSRQ2                                                 08149000
ASCBRV19 EQU   ASCBSRQ1                                                 08150000
ASCBRV18 EQU   ASCBSRQ1                                                 08151000
ASCBRV17 EQU   ASCBSRQ1                                                 08152000
ASCBRV16 EQU   ASCBSRQ1                                                 08153000
ASCBRV15 EQU   ASCBSRQ1                                                 08154000
ASCBRV14 EQU   ASCBSRQ1                                                 08155000
ASCBRV13 EQU   ASCBSRQ1                                                 08156000
ASCBSTA  EQU   ASCBSRQ1                                                 08157000
ASCBJBNS EQU   ASCB+176                                                 08158000
ASCBJBNI EQU   ASCB+172                                                 08159000
ASCBMCC  EQU   ASCB+168                                                 08160000
ASCBRTWA EQU   ASCB+164                                                 08161000
ASCBIQEA EQU   ASCB+160                                                 08162000
ASCBXMPQ EQU   ASCB+156                                                 08163000
ASCBRS01 EQU   ASCB+154                                                 08164000
ASCBFMCT EQU   ASCB+152                                                 08165000
ASCBQECB EQU   ASCB+136                                                 08166000
ASCBLSQH EQU   ASCBLKGP+4                                               08167000
ASCBLOCK EQU   ASCBLKGP                                                 08168000
ASCBTCBS EQU   ASCB+124                                                 08169000
ASCBSRBS EQU   ASCB+118                                                 08170000
ASCBSSRB EQU   ASCB+116                                                 08171000
ASCBRV06 EQU   ASCBFLG2                                                 08172000
ASCBRV05 EQU   ASCBFLG2                                                 08173000
ASCBRV04 EQU   ASCBFLG2                                                 08174000
ASCBSNQS EQU   ASCBFLG2                                                 08175000
ASCBS2S  EQU   ASCBFLG2                                                 08176000
ASCBCEXT EQU   ASCBFLG2                                                 08177000
ASCBPXMT EQU   ASCBFLG2                                                 08178000
ASCBXMPT EQU   ASCBFLG2                                                 08179000
ASCBRF07 EQU   ASCBDSP1                                                 08180000
ASCBRF06 EQU   ASCBDSP1                                                 08181000
ASCBRF05 EQU   ASCBDSP1                                                 08182000
ASCBRF04 EQU   ASCBDSP1                                                 08183000
ASCBRF03 EQU   ASCBDSP1                                                 08184000
ASCBRF02 EQU   ASCBDSP1                                                 08185000
ASCBFAIL EQU   ASCBDSP1                                                 08186000
ASCBNOQ  EQU   ASCBDSP1                                                 08187000
ASCBTMCH EQU   ASCB+104                                                 08188000
ASCBNSWP EQU   ASCBFLG1                                                 08189000
ASCBTYP1 EQU   ASCBFLG1                                                 08190000
ASCBSTND EQU   ASCBFLG1                                                 08191000
ASCBABNT EQU   ASCBFLG1                                                 08192000
ASCBTERM EQU   ASCBFLG1                                                 08193000
ASCBS3S  EQU   ASCBFLG1                                                 08194000
ASCBCMSH EQU   ASCBFLG1                                                 08195000
ASCBTOFF EQU   ASCBFLG1                                                 08196000
ASCBRF01 EQU   ASCBRCTF                                                 08197000
ASCBTMLW EQU   ASCBRCTF                                                 08198000
ASCBOUT  EQU   ASCBRCTF                                                 08199000
ASCBWAIT EQU   ASCBRCTF                                                 08200000
ASCBRV08 EQU   ASCBRCTF                                                 08201000
ASCBFQU  EQU   ASCBRCTF                                                 08202000
ASCBFRS  EQU   ASCBRCTF                                                 08203000
ASCBTMNO EQU   ASCBRCTF                                                 08204000
ASCBAFFN EQU   ASCBFW1                                                  08205000
ASCBDUMP EQU   ASCB+96                                                  08206000
ASCBRV44 EQU   ASCB+92                                                  08207000
ASCBUBET EQU   ASCB+88                                                  08208000
ASCBECB  EQU   ASCB+84                                                  08209000
ASCBJSTL EQU   ASCB+80                                                  08210000
ASCBEWST EQU   ASCB+72                                                  08211000
ASCBTSB  EQU   ASCB+60                                                  08212000
ASCBCSCB EQU   ASCB+56                                                  08213000
ASCBRSMA EQU   ASCBRSM+1                                                08214000
ASCBRV54 EQU   ASCBRSMF                                                 08215000
ASCBRV53 EQU   ASCBRSMF                                                 08216000
ASCBRV52 EQU   ASCBRSMF                                                 08217000
ASCBRV51 EQU   ASCBRSMF                                                 08218000
ASCBLDA  EQU   ASCB+48                                                  08219000
ASCBSTOR EQU   ASCB+44                                                  08220000
ASCBRV07 EQU   ASCB+42                                                  08221000
ASCBSEQN EQU   ASCB+38                                                  08222000
ASCBASID EQU   ASCB+36                                                  08223000
ASCBCPUS EQU   ASCB+32                                                  08224000
ASCBSPL  EQU   ASCB+28                                                  08225000
ASCBIOSP EQU   ASCB+24                                                  08226000
ASCBSYNC EQU   ASCBSUPC+4                                               08227000
ASCBSVRB EQU   ASCBSUPC                                                 08228000
ASCBCMSF EQU   ASCB+12                                                  08229000
ASCBBWDP EQU   ASCB+8                                                   08230000
ASCBFWDP EQU   ASCB+4                                                   08231000
ASCBASCB EQU   ASCB                                                     08232000
ASCBEGIN EQU   ASCB                                                     08233000
RRPAEND  EQU   RRPA+24                                                  08234000
RRPATOD  EQU   RRPA+12                                                  08235000
RRPARCI  EQU   RRPAFLG+1                                                08236000
RRPARFI  EQU   RRPAFLG+1                                                08237000
RRPARTI  EQU   RRPAFLG+1                                                08238000
RRPACTL  EQU   RRPAFLG+1                                                08239000
RRPAF11  EQU   RRPAFLG+1                                                08240000
RRPAF07  EQU   RRPAFLG                                                  08241000
RRPAOPT  EQU   RRPAFLG                                                  08242000
RRPAF05  EQU   RRPAFLG                                                  08243000
RRPAF04  EQU   RRPAFLG                                                  08244000
RRPADSP  EQU   RRPAFLG                                                  08245000
RRPAVLU  EQU   RRPAINP                                                  08246000
@NM00002 EQU   RRPAFLG0                                                 08247000
EPSTEND  EQU   EPST+80                                                  08248000
EPSTCSI  EQU   RMEPBCSI                                                 08249000
EPSTCSO  EQU   RMEPBCSO                                                 08250000
EPSTCL3  EQU   RMEPBCL3                                                 08251000
EPSTIL3  EQU   RMEPBIL3                                                 08252000
EPSTWM3  EQU   RMEPBWM3                                                 08253000
EPDTEND  EQU   EPDT+96                                                  08254000
EPATEND  EQU   EPAT+400                                                 08255000
RMEPBPR1 EQU   EPAT+368                                                 08256000
RMEPBEQ1 EQU   EPAT+336                                                 08257000
RMEPBAP1 EQU   EPAT+304                                                 08258000
RMEPBCL1 EQU   EPAT+272                                                 08259000
RMEPBWM2 EQU   EPAT+240                                                 08260000
RMEPBIL1 EQU   EPAT+208                                                 08261000
RMEPBASM EQU   EPAT+176                                                 08262000
RMEPBPR5 EQU   EPAT+144                                                 08263000
RMEPBMS6 EQU   EPAT+112                                                 08264000
RMEPBRM2 EQU   EPAT+64                                                  08265000
RMEPBRM1 EQU   EPAT+32                                                  08266000
RMSBEND  EQU   RMSB+120                                                 08267000
RMSBRA9  EQU   RMSB+116                                                 08268000
RMSBRA6  EQU   RMSB+104                                                 08269000
RMSBTRC  EQU   RMSB+84                                                  08270000
RMSBWM4  EQU   RMSB+56                                                  08271000
RMSBWM5  EQU   RMSB+48                                                  08272000
RMSBI09  EQU   RMSB+28                                                  08273000
RMSBR24  EQU   RMSB+24                                                  08274000
RMSBI07  EQU   RMSB+20                                                  08275000
RMSBI05  EQU   RMSB+12                                                  08276000
RMSBI03  EQU   RMSB+4                                                   08277000
RMEXEND  EQU   RMEX+64                                                  08278000
RMEXSRE  EQU   RMEX+60                                                  08279000
RMEXXPE  EQU   RMEX+56                                                  08280000
RMEXRR2  EQU   RMEX+52                                                  08281000
RMEXRR1  EQU   RMEX+48                                                  08282000
RMEXI48  EQU   RMEX+44                                                  08283000
RMEXCXX  EQU   RMEX+36                                                  08284000
RMEXEVT  EQU   RMEPBEVT                                                 08285000
RMCAEND  EQU   RMCA+168                                                 08286000
RMCAR90  EQU   RMCA+164                                                 08287000
RMCAUSSC EQU   RMCASRC+36                                               08288000
RMCAEXSC EQU   RMCASRC+32                                               08289000
RMCANQSC EQU   RMCASRC+28                                               08290000
RMCARQSC EQU   RMCASRC+24                                               08291000
RMCADWSC EQU   RMCASRC+20                                               08292000
RMCARSSC EQU   RMCASRC+16                                               08293000
RMCAXSSC EQU   RMCASRC+12                                               08294000
RMCALWSC EQU   RMCASRC+8                                                08295000
RMCATISC EQU   RMCASRC+4                                                08296000
RMCATOSC EQU   RMCASRC                                                  08297000
RMCACPW1 EQU   RMCA+120                                                 08298000
RMCAR14  EQU   RMCA+116                                                 08299000
RMCAR13  EQU   RMCA+112                                                 08300000
RMCAWKA  EQU   RMCA+80                                                  08301000
RMCAR20  EQU   RMCA+74                                                  08302000
RMCAISV  EQU   RMCA+70                                                  08303000
RMCAR11  EQU   RMCA+68                                                  08304000
RMCAINV  EQU   RMCA+64                                                  08305000
RMCAR10  EQU   RMCA+60                                                  08306000
RMCARSV9 EQU   RMCA+56                                                  08307000
RMCACHU  EQU   RMCA+52                                                  08308000
RMCACHP  EQU   RMCA+48                                                  08309000
RMCARSV8 EQU   RMCA+44                                                  08310000
RMCARSV7 EQU   RMCA+40                                                  08311000
RMCARSVF EQU   RMCAFLGS                                                 08312000
RMCASAAF EQU   RMCAFLGS                                                 08313000
RMCARSV5 EQU   RMCA+32                                                  08314000
RMCARSV4 EQU   RMCA+28                                                  08315000
RMCARSV3 EQU   RMCA+24                                                  08316000
RMCATOI  EQU   RMCA+20                                                  08317000
RMCATRS  EQU   RMCA+16                                                  08318000
RMCATQS  EQU   RMCA+12                                                  08319000
RMCARSV2 EQU   RMCA+10                                                  08320000
RMCARSV1 EQU   RMCA+8                                                   08321000
RMCAR04  EQU   RMCA+4                                                   08322000
RMCANAME EQU   RMCA                                                     08323000
RMPTEND  EQU   RMPT+72                                                  08324000
RMPTOPE  EQU   RMPT+66                                                  08325000
RMPTOPI  EQU   RMPT+63                                                  08326000
RMPTOPC  EQU   RMPT+60                                                  08327000
RMPTIOET EQU   RMPT+56                                                  08328000
RMPTCPET EQU   RMPT+52                                                  08329000
RMPTWMET EQU   RMPT+48                                                  08330000
RMPTSAET EQU   RMPT+44                                                  08331000
RMPTXCHT EQU   RMPT+40                                                  08332000
RMPTRSV3 EQU   RMPT+38                                                  08333000
RMPTRSV2 EQU   RMPT+36                                                  08334000
RMPTRSV1 EQU   RMPT+32                                                  08335000
RMPTTOL  EQU   RMPT+28                                                  08336000
RMPTTOM  EQU   RMPT+24                                                  08337000
RMPTTCS  EQU   RMPT+20                                                  08338000
RMPTIMN  EQU   RMPT+16                                                  08339000
RMPTERV  EQU   RMPT+12                                                  08340000
RMPTIOC  EQU   RMPT+8                                                   08341000
RMPTCPU  EQU   RMPT+4                                                   08342000
RMPTNAME EQU   RMPT                                                     08343000
RCTEND   EQU   RCT+88                                                   08344000
RCVRSVF3 EQU   RCT+84                                                   08345000
RCVRSVF2 EQU   RCT+80                                                   08346000
RCVTAPAD EQU   RCT+76                                                   08347000
RCVRSVF1 EQU   RCT+74                                                   08348000
RCVTOTDF EQU   RCT+72                                                   08349000
RCVBPTTM EQU   RCT+68                                                   08350000
RCVBPTCT EQU   RCT+64                                                   08351000
RCVASMQ  EQU   RCT+60                                                   08352000
RCVAVQP  EQU   RCT+56                                                   08353000
RCVCPUC  EQU   RCT+52                                                   08354000
RCVUICC  EQU   RCT+48                                                   08355000
RCVPTR   EQU   RCT+46                                                   08356000
RCVASMQA EQU   RCT+44                                                   08357000
RCVAVQC  EQU   RCT+42                                                   08358000
RCVCPUA  EQU   RCT+40                                                   08359000
RCVUICA  EQU   RCT+38                                                   08360000
RCVCTMC  EQU   RCT+36                                                   08361000
RCCRSVF3 EQU   RCT+32                                                   08362000
RCCRSVF2 EQU   RCT+28                                                   08363000
RCCRSVF1 EQU   RCT+26                                                   08364000
RCCLCHRR EQU   RCT+24                                                   08365000
RCCLCHUT EQU   RCT+22                                                   08366000
RCCTOTUT EQU   RCT+20                                                   08367000
RCCASMTH EQU   RCT+18                                                   08368000
RCCASMTL EQU   RCT+16                                                   08369000
RCCPTRTH EQU   RCT+14                                                   08370000
RCCPTRTL EQU   RCT+12                                                   08371000
RCCCPUTH EQU   RCT+10                                                   08372000
RCCCPUTL EQU   RCT+8                                                    08373000
RCCUICTH EQU   RCT+6                                                    08374000
RCCUICTL EQU   RCT+4                                                    08375000
RCTRCT   EQU   RCT                                                      08376000
MCTEND   EQU   MCT+96                                                   08377000
MCVRSVF3 EQU   MCT+92                                                   08378000
MCVRSVF2 EQU   MCT+88                                                   08379000
MCVRSVF1 EQU   MCT+84                                                   08380000
MCCINTMX EQU   MCT+80                                                   08381000
MCCPR1IN EQU   MCT+76                                                   08382000
MCCUICIN EQU   MCT+72                                                   08383000
MCCUICBD EQU   MCT+68                                                   08384000
MCTRSVB1 EQU   MCT+67                                                   08385000
MCTXRSVD EQU   MCT+66                                                   08386000
MCTFX2   EQU   MCTOFLGS                                                 08387000
MCTFX1   EQU   MCTOFLGS                                                 08388000
MCTSMS2  EQU   MCTOFLGS                                                 08389000
MCTSMS1  EQU   MCTOFLGS                                                 08390000
MCTAMS2  EQU   MCTOFLGS                                                 08391000
@NM00001 EQU   MCTOFLGS                                                 08392000
MCTASM2  EQU   MCTOFLGS                                                 08393000
MCTSF04  EQU   MCTSFLGS                                                 08394000
MCVAVQC  EQU   MCT+60                                                   08395000
MCVFRCNT EQU   MCT+58                                                   08396000
MCVSTCRI EQU   MCT+56                                                   08397000
MCCEND   EQU   MCT+56                                                   08398000
MCCASMT2 EQU   MCT+54                                                   08399000
MCCASMT1 EQU   MCT+52                                                   08400000
MCCRSVH1 EQU   MCT+50                                                   08401000
MCCPLUS  EQU   MCT+48                                                   08402000
MCCMS403 EQU   MCT+44                                                   08403000
MCCMS402 EQU   MCT+40                                                   08404000
MCCMS401 EQU   MCT+36                                                   08405000
MCCMS400 EQU   MCT+32                                                   08406000
MCCMS203 EQU   MCT+28                                                   08407000
MCCMS202 EQU   MCT+24                                                   08408000
MCCMS201 EQU   MCT+20                                                   08409000
MCCMS200 EQU   MCT+16                                                   08410000
MCCMS102 EQU   MCT+12                                                   08411000
MCCMS101 EQU   MCT+8                                                    08412000
MCCMS100 EQU   MCT+4                                                    08413000
MCTMCT   EQU   MCT                                                      08414000
ICTEND   EQU   ICT+88                                                   08415000
ICTRSVB3 EQU   ICT+87                                                   08416000
ICTRSVB2 EQU   ICT+86                                                   08417000
ICTRSVB1 EQU   ICT+85                                                   08418000
ICT003   EQU   ICTFLAGS                                                 08419000
ICTIOOT  EQU   ICTFLAGS                                                 08420000
ICTIOL   EQU   ICTFLAGS                                                 08421000
ICTDRSV4 EQU   ICTFLAGS                                                 08422000
ICVIRSV3 EQU   ICT+80                                                   08423000
ICVULCBT EQU   ICT+76                                                   08424000
ICVOLCBT EQU   ICT+72                                                   08425000
ICVLCBPT EQU   ICT+68                                                   08426000
ICVLUTBT EQU   ICT+64                                                   08427000
ICCEND   EQU   ICT+64                                                   08428000
ICCRSV01 EQU   ICT+62                                                   08429000
ICCEDSUT EQU   ICT+60                                                   08430000
ICCSRSV2 EQU   ICT+58                                                   08431000
ICCSIGUP EQU   ICT+56                                                   08432000
ICCDASF2 EQU   ICT+36                                                   08433000
ICCDASF1 EQU   ICT+34                                                   08434000
ICCMINRV EQU   ICT+32                                                   08435000
ICCMAXRV EQU   ICT+30                                                   08436000
ICCRVSCF EQU   ICT+28                                                   08437000
ICCMNIOR EQU   ICT+26                                                   08438000
ICCLCHN  EQU   ICT+24                                                   08439000
ICCLCLST EQU   ICT+20                                                   08440000
ICCMNSWP EQU   ICT+16                                                   08441000
ICCMNUIN EQU   ICT+12                                                   08442000
ICCMXICT EQU   ICT+8                                                    08443000
ICCMRSV1 EQU   ICT+4                                                    08444000
ICTICT   EQU   ICT                                                      08445000
CCVEND   EQU   CCT+128                                                  08446000
CCTFLG2  EQU   CCT+125                                                  08447000
CCTCPUOT EQU   CCTFLG1                                                  08448000
CCTALL   EQU   CCTFLG1                                                  08449000
CCVLGFMC EQU   CCT+118                                                  08450000
CCVLGUTL EQU   CCT+116                                                  08451000
CCVR07   EQU   CCT+114                                                  08452000
CCVR06   EQU   CCT+112                                                  08453000
CCVUTILP EQU   CCT+110                                                  08454000
CCVR05   EQU   CCT+108                                                  08455000
CCVIMBBT EQU   CCT+104                                                  08456000
CCVEJST  EQU   CCT+100                                                  08457000
CCVPGCPF EQU   CCT+96                                                   08458000
CCVRVSWF EQU   CCT+92                                                   08459000
CCVRBSTD EQU   CCT+88                                                   08460000
CCVR04   EQU   CCT+84                                                   08461000
CCVRBSWT EQU   CCT+80                                                   08462000
CCVR03   EQU   CCT+76                                                   08463000
CCCEND   EQU   CCT+76                                                   08464000
CCCRSVH1 EQU   CCT+74                                                   08465000
CCCSCFC2 EQU   CCT+72                                                   08466000
CCCSCFC1 EQU   CCT+70                                                   08467000
CCCR02   EQU   CCT+68                                                   08468000
CCCSIGUR EQU   CCT+66                                                   08469000
CCCSIGDP EQU   CCT+64                                                   08470000
CCCSCFAC EQU   CCT+62                                                   08471000
CCCMINRV EQU   CCT+60                                                   08472000
CCCMAXRV EQU   CCT+58                                                   08473000
CCCLOSCF EQU   CCT+56                                                   08474000
CCCHISCF EQU   CCT+54                                                   08475000
CCCUTLOT EQU   CCT+52                                                   08476000
CCCUTHIT EQU   CCT+50                                                   08477000
CCCAPRHT EQU   CCT+48                                                   08478000
CCCAPRLT EQU   CCT+46                                                   08479000
CCCR01   EQU   CCT+44                                                   08480000
CCCAPLDP EQU   CCT+38                                                   08481000
CCCAPROT EQU   CCT+34                                                   08482000
CCCAPDIV EQU   CCT+32                                                   08483000
CCCRSVF1 EQU   CCT+28                                                   08484000
CCCMNSIN EQU   CCT+24                                                   08485000
CCCMNUIN EQU   CCT+20                                                   08486000
CCCAPDEL EQU   CCT+16                                                   08487000
CCCAPMAX EQU   CCT+12                                                   08488000
CCCAPMIN EQU   CCT+8                                                    08489000
CCCAPMET EQU   CCT+4                                                    08490000
CCTCCT   EQU   CCT                                                      08491000
RMCTEND  EQU   RMCT+192                                                 08492000
RMCTR50  EQU   RMCT+190                                                 08493000
RMCTDMDE EQU   RMCT+184                                                 08494000
RMCTSRBT EQU   RMCT+176                                                 08495000
RMCTTOCI EQU   RMCT+160                                                 08496000
RMCTCPID EQU   RMCT+156                                                 08497000
RMCTTELM EQU   RMCT+152                                                 08498000
RMCTF09  EQU   RMCTFLGS+1                                               08499000
RMCTMFS  EQU   RMCTFLGS+1                                               08500000
RMCTF07  EQU   RMCTFLGS+1                                               08501000
RMCTF06  EQU   RMCTFLGS                                                 08502000
RMCTRSV2 EQU   RMCTFLGS                                                 08503000
RMCTRSV1 EQU   RMCTFLGS                                                 08504000
RMCTINIT EQU   RMCTFLGS                                                 08505000
RMCTF03  EQU   RMCTFLGS                                                 08506000
RMCTCPS1 EQU   RMCTFLGS                                                 08507000
RMCTALR  EQU   RMCT+140                                                 08508000
RMCTALA  EQU   RMCT+136                                                 08509000
RMCTTOC  EQU   RMCT+128                                                 08510000
RMCTR10  EQU   RMCT+116                                                 08511000
RMCTINQE EQU   RMCT+112                                                 08512000
RMCTOTQE EQU   RMCT+108                                                 08513000
RMCTWTQE EQU   RMCT+104                                                 08514000
RMCTAQHD EQU   RMCT+100                                                 08515000
RMCTAQCT EQU   RMCT+96                                                  08516000
RMCTTMQE EQU   RMCT+92                                                  08517000
RMCTEPPR EQU   RMCT+80                                                  08518000
RMCTFLTM EQU   RMCT+76                                                  08519000
RMCTEPET EQU   RMCT+72                                                  08520000
RMCTITT  EQU   RMCT+68                                                  08521000
RMCTADJC EQU   RMCT+64                                                  08522000
RMCTEPBG EQU   RMCT+60                                                  08523000
RMCTEPAT EQU   RMCT+56                                                  08524000
RMCTEPDT EQU   RMCT+52                                                  08525000
RMCTEPPA EQU   RMCT+48                                                  08526000
RMCTRMSB EQU   RMCT+44                                                  08527000
RMCTRMEX EQU   RMCT+40                                                  08528000
RMCTRMPD EQU   RMCT+36                                                  08529000
RMCTRLCT EQU   RMCT+28                                                  08530000
RMCTRMCA EQU   RMCT+20                                                  08531000
RMCTRMPT EQU   RMCT+16                                                  08532000
RMCTMCT  EQU   RMCT+12                                                  08533000
RMCTICT  EQU   RMCT+8                                                   08534000
RMCTCCT  EQU   RMCT+4                                                   08535000
RMCTNAME EQU   RMCT                                                     08536000
@NM00031 EQU   PSA+3668                                                 08537000
PSASTAK  EQU   PSA+3072                                                 08538000
@NM00030 EQU   PSA+1048                                                 08539000
PSAUSEND EQU   PSA+1048                                                 08540000
PSARV062 EQU   PSA+1044                                                 08541000
PSACDAL  EQU   PSA+1040                                                 08542000
PSAWTCOD EQU   PSA+1036                                                 08543000
PSAATCVT EQU   PSA+1032                                                 08544000
PSAPCPSW EQU   PSA+1024                                                 08545000
PSAPIR2  EQU   PSA+1020                                                 08546000
PSARV059 EQU   PSA+1018                                                 08547000
PSASVC13 EQU   PSA+1016                                                 08548000
PSALSFCC EQU   PSA+1012                                                 08549000
PSASFACC EQU   PSA+1008                                                 08550000
PSASTOP  EQU   PSA+992                                                  08551000
PSASTART EQU   PSA+976                                                  08552000
PSARSPSW EQU   PSA+968                                                  08553000
PSASRPSW EQU   PSA+960                                                  08554000
PSARV045 EQU   PSA+892                                                  08555000
PSARV044 EQU   PSA+888                                                  08556000
PSARV043 EQU   PSA+884                                                  08557000
PSARV042 EQU   PSA+880                                                  08558000
PSARV041 EQU   PSA+876                                                  08559000
PSARV040 EQU   PSA+872                                                  08560000
PSARV025 EQU   PSA+868                                                  08561000
PSADSSED EQU   PSA+868                                                  08562000
PSADSSPR EQU   PSA+864                                                  08563000
PSADSSFW EQU   PSA+860                                                  08564000
PSADSS14 EQU   PSA+856                                                  08565000
PSADSSPP EQU   PSA+848                                                  08566000
PSADSSRP EQU   PSA+840                                                  08567000
PSADSS05 EQU   PSADSSF4                                                 08568000
PSADSS10 EQU   PSADSSF4                                                 08569000
PSADSSVE EQU   PSADSSF4                                                 08570000
PSADSSDE EQU   PSADSSF4                                                 08571000
PSADSSC0 EQU   PSADSSF4                                                 08572000
PSADSSIE EQU   PSADSSF4                                                 08573000
PSADSS12 EQU   PSADSSF4                                                 08574000
PSADSSRC EQU   PSADSSF4                                                 08575000
PSARV057 EQU   PSADSSF3                                                 08576000
PSARV056 EQU   PSADSSF3                                                 08577000
PSARV055 EQU   PSADSSF3                                                 08578000
PSADSSMC EQU   PSADSSF3                                                 08579000
PSADSSRW EQU   PSADSSF3                                                 08580000
PSADSSNM EQU   PSADSSF3                                                 08581000
PSADSSES EQU   PSADSSF3                                                 08582000
PSADSSGP EQU   PSADSSF3                                                 08583000
PSADSSF2 EQU   PSADSSFL+1                                               08584000
PSADSSPI EQU   PSADSSF1                                                 08585000
PSADSSOI EQU   PSADSSF1                                                 08586000
PSADSSSP EQU   PSADSSF1                                                 08587000
PSADSSTP EQU   PSADSSF1                                                 08588000
PSADSSDW EQU   PSADSSF1                                                 08589000
PSADSSDD EQU   PSADSSF1                                                 08590000
PSADSSDM EQU   PSADSSF1                                                 08591000
PSADSSMV EQU   PSADSSF1                                                 08592000
PSADSSTS EQU   PSA+816                                                  08593000
PSADSSWK EQU   PSA+812                                                  08594000
PSADSSR3 EQU   PSA+808                                                  08595000
PSADSSR2 EQU   PSA+804                                                  08596000
PSADSSRS EQU   PSA+800                                                  08597000
PSASTOR  EQU   PSA+796                                                  08598000
PSACPUSA EQU   PSA+794                                                  08599000
PSAVSTAP EQU   PSA+792                                                  08600000
PSAWKVAP EQU   PSA+788                                                  08601000
PSAWKRAP EQU   PSA+784                                                  08602000
PSAMCHIC EQU   PSA+783                                                  08603000
PSARV061 EQU   PSA+782                                                  08604000
PSASYMSK EQU   PSA+781                                                  08605000
PSAMCHFL EQU   PSA+780                                                  08606000
PSACR0   EQU   PSA+776                                                  08607000
PSAPSWSV EQU   PSA+768                                                  08608000
PSALITA  EQU   PSA+764                                                  08609000
PSACLHS  EQU   PSAHLHI                                                  08610000
PSALKR15 EQU   PSALKSA+60                                               08611000
PSALKR14 EQU   PSALKSA+56                                               08612000
PSALKR13 EQU   PSALKSA+52                                               08613000
PSALKR12 EQU   PSALKSA+48                                               08614000
PSALKR11 EQU   PSALKSA+44                                               08615000
PSALKR10 EQU   PSALKSA+40                                               08616000
PSALKR9  EQU   PSALKSA+36                                               08617000
PSALKR8  EQU   PSALKSA+32                                               08618000
PSALKR7  EQU   PSALKSA+28                                               08619000
PSALKR6  EQU   PSALKSA+24                                               08620000
PSALKR5  EQU   PSALKSA+20                                               08621000
PSALKR4  EQU   PSALKSA+16                                               08622000
PSALKR3  EQU   PSALKSA+12                                               08623000
PSALKR2  EQU   PSALKSA+8                                                08624000
PSALKR1  EQU   PSALKSA+4                                                08625000
PSALKR0  EQU   PSALKSA                                                  08626000
PSARV023 EQU   PSACLHT+52                                               08627000
PSALOCAL EQU   PSACLHT+48                                               08628000
PSACMSL  EQU   PSACLHT+44                                               08629000
PSAOPTL  EQU   PSACLHT+40                                               08630000
PSATPACL EQU   PSACLHT+36                                               08631000
PSATPDNL EQU   PSACLHT+32                                               08632000
PSATPNCL EQU   PSACLHT+28                                               08633000
PSAIOSLL EQU   PSACLHT+24                                               08634000
PSAIOSUL EQU   PSACLHT+20                                               08635000
PSAIOSCL EQU   PSACLHT+16                                               08636000
PSAIOSSL EQU   PSACLHT+12                                               08637000
PSASALCL EQU   PSACLHT+8                                                08638000
PSAASML  EQU   PSACLHT+4                                                08639000
PSADISPL EQU   PSACLHT                                                  08640000
PSASRSA  EQU   PSA+636                                                  08641000
PSARV050 EQU   PSA+634                                                  08642000
PSADSSGO EQU   PSA+633                                                  08643000
PSARECUR EQU   PSA+632                                                  08644000
PSAHLHIS EQU   PSA+628                                                  08645000
PSAIPCSA EQU   PSA+624                                                  08646000
@NM00029 EQU   PSA+621                                                  08647000
PSAIPCDM EQU   PSA+620                                                  08648000
PSAIPCD  EQU   PSA+616                                                  08649000
@NM00028 EQU   PSA+613                                                  08650000
PSAIPCRM EQU   PSA+612                                                  08651000
PSAIPCR  EQU   PSA+608                                                  08652000
PSAMCHEX EQU   PSA+600                                                  08653000
PSAMPSW  EQU   PSA+592                                                  08654000
PSAEXPS2 EQU   PSA+584                                                  08655000
PSAEXPS1 EQU   PSA+576                                                  08656000
PSAPIREG EQU   PSA+572                                                  08657000
PSARSREG EQU   PSA+568                                                  08658000
PSAGPREG EQU   PSA+556                                                  08659000
PSARV022 EQU   PSASUP4                                                  08660000
PSARV021 EQU   PSASUP4                                                  08661000
PSARV020 EQU   PSASUP4                                                  08662000
PSARV019 EQU   PSASUP4                                                  08663000
PSARV018 EQU   PSASUP4                                                  08664000
PSARV017 EQU   PSASUP4                                                  08665000
PSARV016 EQU   PSASUP4                                                  08666000
PSARV015 EQU   PSASUP4                                                  08667000
PSARV014 EQU   PSASUP3                                                  08668000
PSAULCMS EQU   PSASUP3                                                  08669000
PSARV012 EQU   PSASUP3                                                  08670000
PSAESTA  EQU   PSASUP3                                                  08671000
PSASPR   EQU   PSASUP3                                                  08672000
PSAPSREG EQU   PSASUP3                                                  08673000
PSAPI2   EQU   PSASUP3                                                  08674000
PSAIOSUP EQU   PSASUP3                                                  08675000
PSALCR   EQU   PSASUP2                                                  08676000
PSARTM   EQU   PSASUP2                                                  08677000
PSAACR   EQU   PSASUP2                                                  08678000
PSAIPCE2 EQU   PSASUP2                                                  08679000
PSAIPCES EQU   PSASUP2                                                  08680000
PSAIPCEC EQU   PSASUP2                                                  08681000
PSAGTF   EQU   PSASUP2                                                  08682000
PSAIPCRI EQU   PSASUP2                                                  08683000
PSATYPE6 EQU   PSASUP1                                                  08684000
PSATCTL  EQU   PSASUP1                                                  08685000
PSADISP  EQU   PSASUP1                                                  08686000
PSALOCK  EQU   PSASUP1                                                  08687000
PSAPI    EQU   PSASUP1                                                  08688000
PSAEXT   EQU   PSASUP1                                                  08689000
PSASVC   EQU   PSASUP1                                                  08690000
PSAIO    EQU   PSASUP1                                                  08691000
PSAANEW  EQU   PSA+544                                                  08692000
PSATNEW  EQU   PSA+536                                                  08693000
PSALCCAR EQU   PSA+532                                                  08694000
PSALCCAV EQU   PSA+528                                                  08695000
PSAPCCAR EQU   PSA+524                                                  08696000
PSAPCCAV EQU   PSA+520                                                  08697000
PSACPULA EQU   PSA+518                                                  08698000
PSACPUPA EQU   PSA+516                                                  08699000
PSAPSA   EQU   PSA+512                                                  08700000
FLCHDEND EQU   PSA+512                                                  08701000
FLCCRSAV EQU   FLCMCLA+280                                              08702000
FLCGRSAV EQU   FLCMCLA+216                                              08703000
FLCFPSAV EQU   FLCMCLA+184                                              08704000
FLCFLA   EQU   FLCMCLA+88                                               08705000
FLCRGNCD EQU   FLCMCLA+84                                               08706000
FLCFSAA  EQU   FLCFSA+1                                                 08707000
@NM00027 EQU   FLCFSA                                                   08708000
@NM00026 EQU   FLCMCLA+72                                               08709000
FLCMCIC  EQU   FLCMCLA+64                                               08710000
@NM00025 EQU   FLCMCLA+20                                               08711000
FLCIOAA  EQU   FLCIOA+1                                                 08712000
@NM00024 EQU   FLCIOA                                                   08713000
@NM00023 EQU   FLCMCLA+15                                               08714000
@NM00022 EQU   FLCMCLA+14                                               08715000
@NM00021 EQU   FLCMCLA+12                                               08716000
FLCLCL   EQU   FLCMCLA+8                                                08717000
FLCIOELA EQU   FLCIOEL+1                                                08718000
@NM00020 EQU   FLCIOEL                                                  08719000
FLCCHNID EQU   FLCMCLA                                                  08720000
@NM00019 EQU   PSA+160                                                  08721000
FLCMTRCD EQU   PSA+157                                                  08722000
@NM00018 EQU   PSA+156                                                  08723000
FLCPERA  EQU   FLCPER+1                                                 08724000
@NM00017 EQU   FLCPER                                                   08725000
@NM00016 EQU   PSA+151                                                  08726000
FLCPERCD EQU   PSA+150                                                  08727000
FLCMCNUM EQU   PSA+149                                                  08728000
@NM00015 EQU   PSA+148                                                  08729000
FLCTEAA  EQU   FLCTEA+1                                                 08730000
@NM00014 EQU   FLCTEA                                                   08731000
PSAPIPC  EQU   PSAPICOD                                                 08732000
PSAPIMC  EQU   PSAPICOD                                                 08733000
PSAPIPER EQU   PSAPICOD                                                 08734000
PSARV049 EQU   FLCPICOD                                                 08735000
FLCPILCB EQU   FLCPIILC                                                 08736000
@NM00013 EQU   FLCPIILC                                                 08737000
@NM00012 EQU   PSAEPPSW                                                 08738000
FLCSVCN  EQU   PSAESPSW+2                                               08739000
FLCSILCB EQU   FLCSVILC                                                 08740000
@NM00011 EQU   FLCSVILC                                                 08741000
@NM00010 EQU   PSAESPSW                                                 08742000
FLCEICOD EQU   PSAEEPSW+2                                               08743000
PSASPAD  EQU   PSAEEPSW                                                 08744000
@NM00009 EQU   PSA+128                                                  08745000
FLCINPSW EQU   PSA+120                                                  08746000
FLCMNPSW EQU   PSA+112                                                  08747000
FLCPNPSW EQU   PSA+104                                                  08748000
FLCSNPSW EQU   PSA+96                                                   08749000
FLCENPSW EQU   PSA+88                                                   08750000
FLCTRACE EQU   PSA+84                                                   08751000
FLCTIMER EQU   PSA+80                                                   08752000
FLCCVT2  EQU   PSA+76                                                   08753000
FLCCAW   EQU   PSA+72                                                   08754000
FLCCSW   EQU   PSA+64                                                   08755000
FLCIOPSW EQU   PSA+56                                                   08756000
FLCMOPSW EQU   PSA+48                                                   08757000
FLCPOPSW EQU   PSA+40                                                   08758000
FLCSOPSW EQU   PSA+32                                                   08759000
FLCEOPSW EQU   PSA+24                                                   08760000
@NM00008 EQU   FLCICCW2+4                                               08761000
FLCICCW1 EQU   FLCROPSW                                                 08762000
FLCIPPSW EQU   FLCRNPSW                                                 08763000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08764000
@RF00256 EQU   @EL00002                                                 08765000
@RC00277 EQU   @RC00275                                                 08766000
@RC00422 EQU   @RC00420                                                 08767000
@RC00428 EQU   @RC00420                                                 08768000
@RC00554 EQU   @RC00550                                                 08769000
@RC00634 EQU   @RC00632                                                 08770000
@RC00815 EQU   @RC00809                                                 08771000
@RC00847 EQU   @RC00805                                                 08772000
@RC00806 EQU   @RC00805                                                 08773000
@RC00952 EQU   @RC00946                                                 08774000
@RC00972 EQU   @RC00966                                                 08775000
@RF01001 EQU   @RC00994                                                 08776000
@RC01005 EQU   @RC00994                                                 08777000
@RC01105 EQU   @RC01102                                                 08778000
@RF01165 EQU   @RC01161                                                 08779000
@RC01173 EQU   @RC01161                                                 08780000
@RF01172 EQU   @RC01161                                                 08781000
@RC01197 EQU   @RC01188                                                 08782000
@RC01308 EQU   @RC01305                                                 08783000
@RF01323 EQU   @RC01305                                                 08784000
@RF01327 EQU   @RC01305                                                 08785000
@RC01336 EQU   @RC01335                                                 08786000
@RF01388 EQU   @RC01383                                                 08787000
@RC00281 EQU   @RC00277                                                 08788000
@RC00442 EQU   @RC00428                                                 08789000
@RF00825 EQU   @RC00815                                                 08790000
@RF00831 EQU   @RC00815                                                 08791000
@RF00958 EQU   @RC00952                                                 08792000
@RC01006 EQU   @RC01005                                                 08793000
@RF01317 EQU   @RC01308                                                 08794000
@RC01339 EQU   @RC01336                                                 08795000
@RC01340 EQU   @RC01339                                                 08796000
@RC01346 EQU   @RC01340                                                 08797000
@ENDDATA EQU   *                                                        08798000
         END   IRARMEVT,(C'PLS1912',0701,78167)                         08799000
