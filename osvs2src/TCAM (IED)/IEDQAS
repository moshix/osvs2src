DQAS     TITLE    '''IEDQAS''  -  HOLD ROUTINE'                         00086900
IEDQAS   CSECT                                                          00186900
         SPACE 3                                                        00286900
*  CHANGE ACTIVITY AS FOLLOWS                                           00386900
******************** MICROFICHE FLAGS *********************** SUPT CODE 00486900
*A000000,999999       RESEQUENCED ONLY                         @Y17XA00 00586900
*A177869,562869,589869,679869                                  @OZ14184 00636900
*A295000,347600                                                @OZ15629 00646900
*C345200-346000,369400-369640                                  @OZ15629 00656900
*A118000,118600                                                @OX16386 00666900
*A808869                                                       @OZ29587 00667082
         SPACE 3                                                        00686900
         SPACE 3                                                        00786900
         ENTRY IEDQAS01                                                 00886900
*********************************************************************** 00986900
*                                                                     * 01086900
*  TITLE: IEDQAS - HOLD ROUTINE / IEDQAS01 - RELEASE ROUTINE          * 01186900
*                                                                     * 01286900
*  MODULE NAME = IEDQAS                                               * 01386900
*                                                                     * 01486900
*  COPYRIGHT = 'NONE'                                                 * 01586900
*                                                                     * 01686900
*  STATUS:  CHANGE LEVEL 5                                            * 01786900
*                                                                     * 01886900
*FUNCTION -- THE APPEARANCE OF A HOLD MACRO IN A MESSAGE HANDLER S21903 01986900
*   WILL RESULT IN THE EXECUTION OF THIS ROUTINE.  IEDQAS WILL   S21903 02086900
*   STOP ALL OUTPUT TO THE TERMINAL TO BE HELD.  THE TERMINAL    S21903 02186900
*   TO BE HELD AND SUBSEQUENT ACTION TO BE TAKEN WILL DEPEND UPONS21903 02286900
*   THE PLACEMENT OF THE MACRO IN THE MH.  IF THE TERMINAL TO BE S21093 02386900
*   HELD HAS MAIN STORAGE ONLY QUEUEING, THE HOLD WILL NOT BE    S21903 02486900
*   DONE.                                                        S21903 02586900
*                                                                S21903 02686900
*   INHDR OR INMSG SUBGROUP - EXECUTION OF THE MACRO IS          S21903 02786900
*   UNCONDITIONAL.  THE SOURCE TERMINAL WILL BE HELD.  AN        S21903 02886900
*   OPERATOR COMMAND OR AN MRELEASE APPLICATION MACRO MUST BE    S21093 02986900
*   ISSUED TO RESUME TRANSMISSION.  THE MESSAGE WHICH CAUSED THE S21093 03086900
*   MACRO TO BE EXECUTED WILL NOT BE RESENT.                     S21093 03186900
*                                                                S21903 03286900
*   OUTMSG SUBGROUP - THE EXECUTION OF THE MACRO IS CONDITIONAL. S21093 03386900
*   IF THE CONDITIONS ARE SATISFIED, THE DESTINATION TERMINAL    S21093 03486900
*   WILL BE HELD AND THE MESSAGE WHICH CAUSED THE MACRO EXECUTIONS21903 03586900
*   WILL BE RESENT LATER.  THE MACRO MAY SPECIFY THAT THE HOLD   S21903 03686900
*   BE ACTIVE FOR AN INTERVAL OR UNTIL AN OPERATOR COMMAND OR    S21903 03786900
*   APPLICATION PROGRAM MRELEASE MACRO IS USSUED TO RESUME       S21903 03886900
*   TRANSMISSION.                                                S21903 03986900
*   HOLD FOR MID-BATCH RECOVERY WILL PERFORM THE HOLD FUNCTION   S22025 04086900
*   ON ANY BLOCK OF A MSG WHEN AN ERROR IS DETECTED ON TRANS-    S22025 04186900
*   MISSION OF THAT BLOCK, EXCEPT ON THE FIRST BLOCK OF THE MSG, S22025 04286900
*   SELECTION ERRORS,OR A DIAL LINE NO LONGER CONNECTED, IN      S22025 04386900
*   CASES NORMAL HOLD IS EXECUTED.  IN A MID-BATCH SITUATION     S22025 04486900
*   IF A TIME INTERVAL IS SPECIFIED,THE SEND SCHEDULERS STCB IS  S22025 04586900
*   IS REMOVED FROM STCB CHAIN AND THE QCB IS PUT ON THE TIME    S22025 04686900
*   DELAY QUEUE.  WHEN THE QCB COMES OFF TIME DELAY,THE SEND     S22025 04786900
*   SCHEDULERS STCB IS REINSERTED INTO THE STCB CHAIN, AND       S22025 04886900
*   RETURN IS MADE TO THE DISPATCHER.  IF NO TIME VALUE WAS      S22025 04986900
*   SPECIFIED THEN THE SEND SCHEDULER IS NOT REMOVED FROM THE    S22025 05086900
*   STCB CHAIN.                                                  S22025 05186900
*                                                                     * 05286900
*ENTR Y POINTS -- IEDQAS - TO HOLD A TERMINAL                         * 05386900
*                                                              * S21101 05486900
*   WHEN HOLD IS ISSUED IN THE INHDR SUBGROUP ENTRY IS THRU    * S21101 05586900
*   THE USER INTERFACE ROUTINE (IEDQUI).                       * S21101 05686900
*                                                              * S21101 05786900
*   WHEN HOLD IS ISSUED IN THE INMSG OR OUTMSG SUBGROUP, ENTRY ISS21903 05886900
*   FROM IEDQBD WHEN THE ERROR BYTES ARE FOUND TO MATCH THE      S21903 05986900
*   SPECIFIED MASK.                                              S21903 06086900
*                                                                S21903 06186900
*   THE CALLING SEQUENCE IF   LA    R12,IEDQAS                   S21903 06286900
*                             BR    R12                               * 06386900
*                                                                     * 06486900
*INPUT  -    WHEN ENTERED THRU IEDQUI                          * S21101 06586900
*   WHEN THE HOLD MACRO IS EXECUTED IN THE INHDR SUBGROUP,     * S21101 06686900
*   IEDQAS IS ENTERED WITH THE FOLLOWING REGISTERS             * S21101 06786900
*                                                              * S21101 06886900
*   R1   HAS THE PARAMETER LIST ADDRESS                        * S21101 06986900
*   R4   HAS THE LCB ADDRESS                                   * S21101 07086900
*   R13  HAS THE ADDRESS OF AVTSAVE2                           * S21101 07186900
*                                                              * S21101 07286900
*   WHEN IEDQAS IS CALLED BY IEDQBD UPON FINDING ERRORS        * S21101 07386900
*   WITH THE FOLLOWING REGISTERS SET.                                 * 07486900
*   R1 HAS THE ADDRESS OF A LIST OF THINGS TO BE POSTED               * 07586900
*   R3 HAS THE SCB ADDRESS                                            * 07686900
*   R4 HAS THE LCB ADDRESS                                            * 07786900
*   R6 HAS THE RECALLED HEADER BUFFER                                 * 07886900
*   R11 HAS THE DISPATCHER ADDRESS                                    * 07986900
*   R12 HAS THE ENTRY POJNT ADDRESS                                   * 08086900
*   R13 HAS THE ADDRESS OF AVTSAVE2                                   * 08186900
*                                                                     * 08286900
*OUTPUT -- THE HOLD FLAG IN THE TERMINAL TABLE INTRY WILL BE SET.S21903 08386900
*   IF ENTRY WAS FROM IEDQBD, A CHAIN OF ELEMENTS WILL BE PLACED S21903 08486900
*   ON THE READY QUEUE.  IF THE HOLD IS FOR A TIME INTERVAL, A   S21903 08586900
*   BUFFER WILL BE PLACED ON THE TIME DELQY QUEUE.               S21903 08686900
*                                                                     * 08786900
*EXTERNAL ROUTINES -- DISPATCHER CHAIN FUNCTION - PLACES A LIST OF    * 08886900
*   ITEMS ON THE READY Q.                                             * 08986900
*   IEDQTNT - TO FIND THE TERMINAL ENTRY FROM THE DESTINATION OFFSET  * 09086900
*   IN THE BUFFER.                                                    * 09186900
*                                                                     * 09286900
*EXITS-NORMAL -- WHEN EXECUTED IN THE INDHR SUBFROUP, EXIT IS TO S21903 09386900
*   THE MH WITH ZERO IN REGISTER 15.                             S21903 09486900
*   WHEN EXECUTED IN THE INMSG OR OUTMSG SUBFROUP, EXIT IS TO THES21903 09586900
*   DISPATCHER AT CHAIN.                                         S21903 09686900
*                                                                S21903 09786900
*EXITS-ERROR -- WHEN EXECUTED IN THE INHDR SUBGROUP, EXIT IS TO  S21903 09886900
*   THE MH WITH REGISTER 15 NON-ZERO.                            S21903 09986900
*                                                                     * 10086900
*TABLES/WORKAREAS -- AVT, SCB, TTABLE, PRF, QCB.                      * 10186900
*                                                                     * 10286900
*ATTRIBUTES -- REUSABLE, ENABLED, RESIDENT                            * 10386900
*                                                                     * 10486900
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 10586900
*   PARTICULAR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER      * 10686900
*   SET.                                                              * 10786900
*                                                                     * 10886900
*********************************************************************** 10986900
*********************************************************************** 11086900
*                                                                     * 11186900
*                            REGISTER EQUATES                         * 11286900
*                                                                     * 11386900
*********************************************************************** 11486900
R0       EQU   0                                                        11586900
R1       EQU   1                                                        11686900
R2       EQU   2                                                        11786900
R3       EQU   3                                                        11886900
RSCB     EQU   3                                                        11986900
R4       EQU   4                                                        12086900
R5       EQU   5                                                        12186900
RPRF     EQU   6                                                        12286900
RQCB     EQU   7                                                        12386900
R8       EQU   8                                                        12486900
RPQ      EQU   8                                                        12586900
R9       EQU   9                                                        12686900
R10      EQU   10                                                       12786900
RDCB     EQU   10                                                       12886900
RDISP    EQU   11                                                       12986900
RBASE    EQU   12                                                       13086900
R12      EQU   12                                                S21101 13186900
R13      EQU   13                                                       13286900
R14      EQU   14                                                       13386900
R15      EQU   15                                                       13486900
*                            USING STATMENTS                          * 13586900
         USING IEDQSCB,RSCB                                             13686900
         USING IEDQPRF,RPRF                                             13786900
         USING IEDQTRM,R1                                               13886900
         USING IEDQQCB,RQCB                                             13986900
         USING IEDQPQCB,RPQ                                             14086900
         USING IEDQDISP,RDISP                                           14186900
         USING IEDQLCB,R4                                               14286900
         USING IHADCB,RDCB                                              14386900
         USING AVTSAVE2,R13                                      S22025 14486900
         USING *,RBASE                                                  14586900
*                                                                     * 14686900
ONE      EQU   1                        ONE                      S22024 14786900
TWO      EQU   2                        TWO                     SA63009 14886900
NE       EQU   7                        BRANCH NOT EQUAL         S21903 14986900
ZERO     EQU   0                        ZERO                     S21903 15086900
L2       EQU   2                        LENGTH OF 2              S21903 15186900
L3       EQU   3                        LENGTH OF 3              S21903 15286900
CPBQTYPE EQU   X'03'                    MASK FOR QUEUING MEDIA  SA52971 15386900
TIMEINTV EQU   8                        DISPLACEMENT INTO THE    S22025 15486900
*                                       PARMAMETR LIST OF THE    S22025 15586900
*                                       DELAY VALUE              S22025 15686900
INVTCNT  EQU   4                        DISP OF THE INVITATION   S22025 15786900
*                                       LIST COUNTER             S22025 15886900
LVLBLKBT EQU   2                        DISP TO PARM LST BYTE    S22025 15986900
X01      EQU   X'01'                    01 CONSTANT              S21903 16086900
X80      EQU   X'80'                    80 CONSTANT              S21903 16186900
XE4      EQU   X'E4'                    E4 CONSTANT              S21903 16286900
LVLMASK  EQU   X'02'                    MASK FOR LEVEL=BLK       S22025 16386900
INVALSRC EQU   X'10'                    ORIGIN NOT IDENTIFIED    CLUP21 16486900
NOTHELD  EQU   X'0C'                    ENTRY NOT HOLDABLE       CLUP21 16586900
ALRDYHLD EQU   X'08'                    TERMINAL ALREADY HELD    CLUP21 16686900
NOTDISK  EQU   X'04'                    NOT DISK QUEUED          CLUP21 16786900
FOUR     EQU   4                        FOUR                     S22024 16886900
X60      EQU   X'60'                    QCBSTPRI FOR DIAL      @OS76674 16986900
*                                        W/O CLOCK OR INTVL    @OS76674 17086900
FIVE     EQU   5                        OFFSET                 @OY12688 17186900
EIGHT    EQU   8                        OFFSET FOR PLIST       @OY12688 17286900
ELEVEN   EQU   11                       PARM LIST REG OFFSET   @OY12688 17386900
TWELVE   EQU   12                       SAVE AREA OFFSET       @OY12688 17486900
X18      EQU   X'18'                    OPFIELD NOT FOUND      @OY12688 17586900
X1C      EQU   X'1C'                    NO BUFFERS AVAILABLE   @OY12688 17686900
OPFLDI   EQU   X'60'                    INTVL SPECIFIED IN OPFL@OY12688 17786900
BUFFER   EQU   X'08'                    BUFFER IDENTIFIER      @OZ14184 17816900
OFFSET1C EQU   X'1C'                    OFFSET FOR TTCIN       @OZ14184 17846900
*                                                                     * 17886900
         EJECT                                                          17986900
*        HOLD FROM MH MAY BE FOR A TIME INTERVAL OR UNCONDITIONAL       18086900
*        UNTIL AN OPERATOR CONTROL RELEASE.  THE INTERVAL IN THE        18186900
*        PARAMETER LIST =0 IF HOLD UNITL RELEASE IS DESIRED.            18286900
*        WHEN ENTERED R8 HAS THE ADDRESS OF THE PARAMETER LIST          18386900
*        IF THE DESTINATION QCB REFERENCED IS A CORE ONLY QUEUE,        18486900
*        ( NO DISK QUEUES) THE MESSAGE WILL BE CANCELED AND THE         18586900
*        TERMINAL IS NOT HELD.  THE FIRST FEFO MESSAGE FOR THIS         18686900
*        QCB WILL BECOME THIS MESSAGE AND THE CANCEL BIT WILL           18786900
*        BE SET CAUSING THIS MESSAGE TO BE FREED FROM THE QUEUE         18886900
*        WHEN AN ATTEMPT IS MADE TO RESEND IT.                          18986900
HOLD     EQU   *                                                        19086900
IEDQAS   IEDHJN HOLD1                   GENERATE MODULE ID DATE  S22025 19186900
         LTR   R0,R0                    IS ENTRY FROM IEDQBD     S21101 19286900
         BNZ   IEDQAS02                 NO, BRANCH               S21101 19386900
         L    R5,AVTMSGS-1              ADDR OF LIST OF ADDRS           19486900
         L     R5,0(R5)                 ADDR OF BD                      19586900
         ST    R5,LCBERBQB-1            FOR POST                        19686900
         LA    R5,LCBERB                ADDR ERB TO POST LIST           19786900
         ST    R1,LCBERBLK-1            AND SAVE LIST IN R5             19886900
         MVI   LCBERBPY,PRIRCQCB                                        19986900
         XC    LCBERBCH(3),LCBERBCH                                     20086900
         NI    LCBSTAT1,X'FF'-LCBRCLLN  RECALL FLAG OFF                 20186900
         TM    LCBSTAT1,LCBRECVN        HOLD IN INMSG          @OX16386 20216900
         BO    RECVE                    YES                    @OX16386 20246900
         NC    LCBLSPCI,LCBLSPCI        HAS HOLD BEEN EXECUTED   S22025 20286900
         BZ    NOTYET                   NO,BRANCH              @OS76483 20386900
RECVE    EQU   *                                               @OX16386 20436900
         TM    LCBSTAT1,LCBINITN        IS THIS INITATE MODE            20486900
         BO    NOHOLD                   BR YES TO BYPASS HOLD           20586900
         LH    R1,LCBTTCIN              DEST OFFSET                     20686900
         L     R15,AVTRNMPT             ADDRESS OF IEDQTNT              20786900
         USING IEDQTNTD,R15             SET UP BASE FOR TERMNAMESA63011 20886900
*                                       TABLE                   SA63011 20986900
         N     R1,AVTCLRHI              CLEAR HI BYTE                   21086900
         BZ    NOHOLD                   NO TNT OFFSET            S22025 21186900
         CLC   LCBTTCIN,TNTLEN          IS THIS A TOTE TTE? COND        21286900
*                                       CHEKED VIA SPM LATER   @Y17XANQ 21386900
         DROP  R15                                             @Y17XANQ 21486900
         BALR  R14,R15                  CALL                            21586900
         TM    TRMSTATE,TRMLIST+TRMPROC    CAN THIS            @OX12499 21686900
*                                         TERMINAL BE HELD      SA66617 21786900
         BNZ   NOHOLD                   BR NO                           21886900
         TM    LCBSTAT1,LCBRECVN        HOLD IN INMSG?         @OX12499 21986900
         BNO   SKPTEST                  NO, IN OUTMSG          @OX12499 22086900
         TM    TRMSTATE,TRMHELDN        IS TERM ALREADY HELD?  @OX12499 22186900
         BO    NOHOLD                   YES, CANNOT HOLD       @OX12499 22286900
SKPTEST  EQU   *                                               @OX12499 22386900
         SPM   R14                      IS THIS A TOTE TTE?    @Y17XANQ 22486900
         BNH   NOTOTE                     BRANCH IF NOT        @Y17XANQ 22586900
         SPACE                                                          22686900
         TM    TRMSTATE,TRMPREF         IS THIS AN ATTACHED NCP?        22786900
         BZ    NOHOLD                     BRANCH IF NOT        @Y17XANQ 22886900
         SPACE                                                          22986900
         LR    RQCB,R1                  COPY TTE ADDRESS       @Y17XANQ 23086900
         LA    R15,TRMPRFSZ             PREFIX SIZE            @Y17XANQ 23186900
         SLR   RQCB,R15                 BACK UP TO PREFIX      @Y17XANQ 23286900
         TM    TRMBYTE0-IEDNTRM(RQCB),TRMSNA   IF TTE IS SNA TOTE,      23386900
*                                       ALLOW A HOLD FUNCTION  @Y17XANQ 23486900
         BZ    NOHOLD                     BRANCH IF NOT SNA    @Y17XANQ 23586900
         SPACE                                                          23686900
NOTOTE   EQU   *                                               @Y17XANQ 23786900
         L     RQCB,TRMDESTQ-1          QCB ADDR                        23886900
         TM    QCBDSFLG,QCBREUS+QCBNREUS                                23986900
         BZ    NOHOLD                   BR IF NO DISK                   24086900
         CLI   LCBFLAG1,AVTEZERO        3705 PLCB                S22024 24186900
         BE    NOMDBTCH                 YES, BRANCH              S22024 24286900
         TM    LVLBLKBT(R8),LVLMASK     LEVEL=BLK SPECIFIED      S22025 24386900
         BZ    NOMDBTCH                 NO-BRANCH TO NORMAL HOLD S22025 24486900
*                                       PROCESSING               S22025 24586900
         L     R14,TIMEINTV(R8)         GET TIME INTERVAL        S22025 24686900
         LTR   R14,R14                  ANY INTERVAL SPECIFIED?@YA07685 24786900
         BZ    NOINTVL                  BRANCH IF NO           @YA07685 24886900
         TM    TRMSTATE,TRMHELDN        TERM ALREADY HELD      @OY12688 24986900
         BNO   INTVLOK                  BRANCH IF NOT          @OY12688 25086900
         SR    R14,R14                  CLEAR INTVL IF HELD    @OY12688 25186900
INTVLOK  EQU   *                                               @OY12688 25286900
         ST    R14,TDLEOLDT(RPRF)       SET INTVL IN BUFFER      S22025 25386900
NOINTVL  EQU   *                                               @YA07685 25486900
         TM    SCBERR4,SCBSLCTN         SELECTON ERROR           S22025 25586900
         BO    NOMDBTCH                 YES, NORMAL HOLD FUNCTON S22025 25686900
         TM    SCBERR4,SCBTXTTN         WAS THERE A TEXT TRANSFERS22025 25786900
*                                       ERROR                    S22025 25886900
         BZ    NOMDBTCH                 NO, BRANCH               S22025 25986900
         TM    SCBQTYPE,SCBBBFTM        MID BATCH SPECIFIED      S22025 26086900
         BZ    NOMDBTCH                NO GO DO NORMAL HOLD      S22025 26186900
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL TERM      S22025 26286900
         BZ    GOMDBTCH                 NO-BR                    S22025 26386900
         TM    LCBSTAT1,LCBOCNI         STOPLINE IN PROGRESS    OX02199 26486900
         BO    NOMDBTCH                 YES,DO NORMAL HOLD      OX02199 26586900
         CLI   LCBTSTSW,AVTEFF          NO LONGER CONNECTED     OX02199 26686900
         BNE   MIDBATCH                 NO,DO MIDBATCH HOLD     OX02199 26786900
NOMDBTCH EQU   *                                                 S22025 26886900
         TM    LCBSTAT1,LCBRECVN        IS THIS HOLD IN INMSG    A49221 26986900
         BNO   SEND                     BR IF THIS IS OUTMSG     A49221 27086900
         OI    TRMSTATE,TRMHELDN        SET TERMINAL ENTRY HELD  A49221 27186900
         OI    QCBSTAT,QCBTRMHO         SET QCBHELD              A49221 27286900
         B     SAME2                    RETURN TO BD             A49221 27386900
SEND     EQU   *                                                 A49221 27486900
         TM    PRFCRCD+L'PRFCRCD-1,CPBQTYPE CORE POINTER        SA52971 27586900
         BNZ   NOTCORE                  NO, GOT DISK ADDRESS    SA52971 27686900
         L     R15,PRFCRCD-1            GET THE DISK ADDR OF THE HDR    27786900
         MVC   PRFCRCD(3),PRFCRCD-IEDQPRF(R15)                          27886900
NOTCORE  EQU   *                                                        27986900
         L     R9,LCBLSPCI-1            ADDR OF BFR FOR SERVICED FLG    28086900
         MVC   SCBPRI(1),PRFTQBCK-IEDQPRF(R9) SAVE PRI INDEX OF SA52971 28186900
*                                         MESSAGE TO HOLD       SA52971 28286900
         ST    R5,PRFLINK-1-IEDQPRF(R9) THIS BFR INTO POST LIST         28386900
         LR    R5,R9                    NEW FIRST IN POST LIST          28486900
         MVI   PRFPRI-IEDQPRF(R5),PRIBFRTB                              28586900
         LA    R9,AVTBFRTB              ADDR OF BFR RTN QCB             28686900
         ST    R9,PRFQCBA-1-IEDQPRF(R5) RTN THIS BF*R                   28786900
        XC    LCBLSPCI(3),LCBLSPCI     STOP THE SERVICED FLAG           28886900
         TM    SCBQTYPE,SCBCONC         IS THIS A CONCENTRATOR  SA52971 28986900
         BZ    RESET                    NO, GO RESET FLAGS      SA52971 29086900
         LR    R9,RQCB                  COMPUTE MAIN EXTENSION  SA52971 29186900
         AH    R9,QCBEXTO                 ADDRESS               SA52971 29286900
         TM    QCBEFLG-IEDQQCBE(R9),QCBEOPL MSG,L               SA52971 29386900
         BZ    RESET                    NO, GO RESET FLAGS      SA52971 29486900
         SR    R14,R14                  CLEAR REG               SA52971 29586900
         SR    R15,R15                  CLEAR REG               SA52971 29686900
         IC    R14,QCBELGTH-IEDQQCBE(,R9) GET MAIN EXTENSION    SA52971 29786900
*                                         SIZE                  SA52971 29886900
         AR    R9,R14                   GET TO FIRST SUB EXTEN  SA52971 29986900
         IC    R14,QCBELGTH-IEDQQCBE(,R9) GET SUB EXTENSION     SA52971 30086900
*                                         SIZE                  SA52971 30186900
         IC    R15,SCBPRI               GET PRI LVL INDEX       SA52971 30286900
         MR    R14,R14                  GET OFFSET TO EXTENSION SA52971 30386900
         AR    R9,R15                   POINT TO CORRECT EXTEN  SA52971 30486900
         XC    QCBEHDR-IEDQQCBE(3,R9),QCBEHDR-IEDQQCBE(R9) ZERO SA52971 30586900
*                                         HDR PTR AS FLAG FOR   SA52971 30686900
*                                         HM03                  SA52971 30786900
         B     NOSET                    BYPASS RESET OF SDFFO   SA52971 30886900
         SPACE 1                                                SA52971 30986900
RESET    EQU   *                                                SA52971 31086900
         NI    QCBFLAG,X'FF'-QCBSDFFO   CLEAR 'SENDING NOW'     SA52971 31186900
NOSET    EQU   *                                                SA52971 31286900
         L     RSCB,LCBSCBA-1           SCB ADDR                        31386900
         LH    R9,TRMOUTSQ              SUBTRACT ONE FROM SEQUENCE      31486900
         BCTR  R9,ZERO                  OUT NUMBER               S21903 31586900
         CH    R9,SCBOSEQ               DID AA INCREMENT        SA68011 31686900
*                                        SEQUENCE OUT NO.       SA68011 31786900
         BNE   NODECR                   NO, DONT DECREMENT IT   SA68011 31886900
         STH   R9,TRMOUTSQ                                              31986900
NODECR   EQU   *                                                SA68011 32086900
*        IF TERMINAL IS IN LOCK MODE - THE REQUEST TO HOLD SHOULD BE    32186900
*        IGNORED AND THE MESSAGE RETRANSMITTED                          32286900
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN    LOCK MODE                  32386900
         BZ    NOTLOCK                  BR NO                           32486900
*        SET LCB TO RETRANSMIT THE MSG                                  32586900
         MVC   QCBLKRRN(3),PRFCRCD      RESET ADDR OF LOCK RESPONSE     32686900
         B     RETBUF                   RETURN BUFFER           SA66605 32786900
NOTLOCK  EQU   *                                                        32886900
         LM    R2,R3,4(R8)              R8 HAS PARLIST ADDR             32986900
         TM    0(R8),X01                IS THERE AN ERROR MASK   S21903 33086900
         BO    NOMASK                   BR NO                           33186900
         LR    R2,R3                    RESET INTVL IF ANY              33286900
         TM    TRMSTATE,TRMHELDN        TERM ALREADY HELD      @OY12688 33386900
         BNO   NOMASK                   BRANCH IF NO           @OY12688 33486900
         SR    R2,R2                    CLEAR INTVL IF HELD    @OY12688 33586900
NOMASK   EQU   *                                                        33686900
         ST    R2,TDLEOLDT(RPRF)        R2 HAS INTVL IF ANY             33786900
         OI    TRMSTATE,TRMHELDN        SET HELD BIT                    33886900
         OI    QCBSTAT,QCBTRMHO         INDICATE TERMINAL WAS HELD      33986900
         CLI   PRFNBUNT,ONE             ANY UNNECESSARY UNITS           34086900
         BE    JUSTONE                  BR NO                           34186900
         ST    R1,AVTDOUBL                                              34286900
         L     R1,PRFTIC                ADDR OF FIRST UNIT              34386900
         IC    R9,PRFNBUNT              ADJUST NUMBER OF UNITS          34486900
         BCTR  R9,ZERO                  IN BOTH OLDBFR AND       S21903 34586900
         STC   R9,PRFNBUNT-IEDQPRF(R1)  EXTRA UNITS                     34686900
         MVI   PRFNBUNT,ONE                                             34786900
         LA    R9,AVTBFRTB              ADDR FOR POST                   34886900
         ST    R9,PRFQCBA-1-IEDQPRF(R1)                                 34986900
         ST    R5,PRFLINK-1-IEDQPRF(R1)    ADD EXTRA UNIT(S) TO         35086900
         MVI   PRFPRI-IEDQPRF(R1),PRIBFRTB                              35186900
         LR    R5,R1                    POST LIST                       35286900
         L     R1,AVTDOUBL                                              35386900
JUSTONE  EQU   *                                                        35486900
         L     RQCB,TRMDESTQ-1          DEST QCB ADDR                   35586900
         L     RSCB,LCBSCBA-1           SCB ADDRESS                     35686900
         LR    R10,R8                   SAVE PARAMETER LIST ADDR S22025 35786900
         SR    R1,R1                    CLEAR                    CLUP21 35886900
         IC    R1,SCBPRI                GET PRIORITY LEVEL INDEX CLUP21 35986900
         LTR   R1,R1                    IS IT FIRST ONE          CLUP21 36086900
         BZ    GOTIT                    BR YES                          36186900
         LA    R0,QCBPSIZE              SIZE OF PRIORITY QCB     CLUP21 36286900
         MR    R0,R0                    SIZE X LEVEL                    36386900
GOTIT    EQU   *                                                        36486900
         LA    RPQ,QCBMSIZE(RQCB,R1)    POINT TO PRIORITY QCB    CLUP21 36586900
         LA    R9,AVTBFRTB                                              36686900
         ST    R9,PRFQCBA-1                                             36786900
         NC    QCBINTFF(3),QCBINTFF     ANY HELD MSGS THERE             36886900
         BNZ   SAME                     YES-BR                   S22025 36986900
         CLC   PRFCRCD(3),QCBPREVF      IS MSG FIRST IN CHAIN?  SA52971 37086900
         BNE   SAME                     BRANCH IF NO            SA52971 37186900
         MVC   QCBINTFF(3),QCBPREVF     SET FIRST INTERCEPTED TOSA52971 37286900
SAME     EQU   *                        HDR PTR                 SA52971 37386900
         NC    TDLEOLDT(L2,RPRF),TDLEOLDT(RPRF)   ANY INTVL      S21903 37486900
         BZ    RTNBFR                   BR IF NO DELAY                  37586900
         MVI   TDLOFF(RPRF),TDLINDEX    SET OFFSET TO QCV               37686900
         MVI   PRFPRI,PRIRELSE          SET PRTY                        37786900
         LA    R9,IEDQAS01              QCB ADDR TO POST TO             37886900
         ST    R9,TDLQCBAD-1(RPRF)      SET IN ELEM                     37986900
         LR    R1,RPRF                  ELEM IN R1                      38086900
         L    R15,AVTHG01               E.P. TO INSERT AN ELEM          38186900
         BALR  R14,R15                  PUT BFR ON TIME QUEUE    CLUP21 38286900
SAME2    EQU   *                                                        38386900
         LR    R1,R5                    RESTORE LIST                    38486900
         BAL   R14,DSPCHAIN             EXIT                   @Y17XAMX 38586900
         SPACE 3                                                 S21903 38686900
MIDBATCH EQU   *                                                 S22025 38786900
         XC    TDLEOLDT(L2,RPRF),TDLEOLDT(RPRF)   CLEAR INTVL    S21903 38886900
GOMDBTCH EQU   *                                                 S22025 38986900
         NC    SCBEOB,SCBEOB            IS THIS THE FIRST BLOCK  S22025 39086900
*                                       OF THE MSG               S22025 39186900
         BZ    NOMDBTCH                 YES-GO DO NORMAL HOLD    S22025 39286900
         MVZ   SCBQTYPE(1),SCBHBFNO     RESET Q TYPE             S22025 39386900
         NI    SCBHBFNO,AVTEFF-SCBNREUS-SCBREUS-SCBCOREQ        SA52971 39486900
*                                       RESET QTYPE FLAGS       SA52971 39586900
         L     R15,LCBLSPCI-1           GET ERROR BUFFER ADDR    S22025 39686900
*                                       WHERE SCBPRI WAS SAVED BDS22025 39786900
         MVC   SCBPRI(1),PRFTQBCK-IEDQPRF(R15) RESET PRIORITY   SA52971 39886900
         MVC   SCBDEOB(4),LCBCPA        RESTORE DEOB FROM WHERE  S22025 39986900
*                                       IT WAS SAVED BY BD       S22025 40086900
         MVC   SCBTRANS(3),LCBCPA+4      RESTORE SCB TRANS FROM  S22025 40186900
*                                       WHERE IT WAS SAVED BY BD S22025 40286900
         ST    R5,PRFLINK-1-IEDQPRF(R15) ERROR BUFFER INTO POST  S22025 40386900
*                                       LIST                     S22025 40486900
         LR    R5,R15                   NEW FIRST IN POST LIST   S22025 40586900
         MVI   PRFPRI-IEDQPRF(R15),PRIBFRTB PRIORITY             S22025 40686900
         LA    R15,AVTBFRTB             BFR RETURN QCB           S22025 40786900
         ST    R15,PRFQCBA-1-IEDQPRF(R5) ERROR BUFFER TO BFR RTN S22025 40886900
         MVI   SCBERR4,AVTEZERO         CLEAR SCBERROR FLAGS     S22025 40986900
         MVI   LCBSENS0,AVTEZERO        CLEAR LCBERROR FLAGS     S22025 41086900
         NI    SCBERR3,SCBXCEPF         TURN OF UNIT EXCEPTION   S22025 41186900
         OI    QCBSTAT,QCBSEND          SET SEND MODE BIT        S22025 41286900
         OI    SCBQTYPE,SCBBFMM         SET MIDDLE OF MSG BIT    S22025 41386900
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN   IS LINE IN LOCK MODE S22025 41486900
         BNZ   NOMIDMSG                 YES, BRANCH              S22025 41586900
         CLI   QCBSTVTO,DSPBUFSC        BUFFERED QCB             S22025 41686900
         BE    NOMIDMSG                 YES-BR                   S22025 41786900
         NC    TDLEOLDT(2,RPRF),TDLEOLDT(RPRF) TIME INTERVAL     S22025 41886900
         BZ    NOMIDMSG                 NO-BRANCH                S22025 41986900
         LA    R15,QCBSTVTO              STCB ADDR               S22025 42086900
         LA    R2,LCBSTCBA-5            SET SO FIRST STCB WILL   S22025 42186900
*                                       COINCIDE WITH THE STCB LIS22025 42286900
         TM    SCBQTYPE,SCBCONC                                  S22026 42386900
         BZ    STCBLOOP                 BRANCH IF NO             S22026 42486900
         LH    R2,QCBEXTO               EXT OFFSET               S22026 42586900
         AR    R2,RQCB                  QCBE ADDR                S22026 42686900
         L     R2,QCBECONC-1-IEDQQCBE(R2)                        S22026 42786900
*                                       CONC TRM ADDR            S22026 42886900
         L     R2,TRMDESTQ-1-IEDQTRM(R2)                         S22026 42986900
*                                       DRQ ADDR                 S22026 43086900
         SH    R2,AVTHA4                SET REG                  S22026 43186900
STCBLOOP EQU   *                                                 S22025 43286900
         L     R9,STCBLINK-1-IEDQSTCB(R2) NEXT STCB ADDR         S22025 43386900
         LA    R9,0(R9)                 CLEAR HIGH BUTE          S22025 43486900
         CLR   R9,R15                   THIS THE RIGHT STCB      S22025 43586900
         BE    TAKEOUT                  YES-BRANCH               S22025 43686900
         LR    R2,R9                    SET ADDR OF PREVIOUS STCBS22025 43786900
         B     STCBLOOP                 TO TOP OF LOOP           S22025 43886900
TAKEOUT  EQU   *                                                 S22025 43986900
         MVC   STCBLINK-IEDQSTCB(L3,R2),STCBLINK-IEDQSTCB(R9)    S21903 44086900
*                                       REMOVE THE STCB FROM THE S22025 44186900
*                                       CHAIN                    S22025 44286900
         MVC   QCBEOLDT(2),TDLEOLDT(RPRF) SET DELAY INTERVAL     S22025 44386900
         MVI   QCBEOLDT+2,AVTEZERO      TIME DELAY INTERFACE     S22025 44486900
*                                       INDEX FOR QCB            S22025 44586900
         MVI   QCBPRI,PRIRELSE          SET PRIORITY             S22025 44686900
         IC    R15,QCBDSFLG             SAVE FLAG BITE           S22025 44786900
         LA    R1,TIMEQBK               RETURN QCB ADDR WHEN TIMES22025 44886900
         ST    R1,QCBELCHN-1            DELAY EXPIRES            S22025 44986900
         STC   R15,QCBDSFLG             RESTORE FLAG             S22025 45086900
         LR    R1,RQCB                  SET ELEMEMT ADDR FOR TIMES22025 45186900
*                                       DELAY                    S22025 45286900
         L     R15,AVTHG01              E.P.A. TO INSERT QCB IN  S22025 45386900
*                                       TIME DELAY Q             S22025 45486900
         BALR  R14,R15                  GO TIME DELAY QCB        S22025 45586900
         SPACE 3                                                        45686900
NOMIDMSG EQU   *                                                 S22025 45786900
         MVC   SCBDCHDR(2),LCBTTCIN     SET  COUNT               S22025 45886900
         XC    LCBLSPCI(3),LCBLSPCI     SET LSPCI TO ZERO        S22025 45986900
         LA    R10,AVTINOUT             END OUTMSG PROCESSING    S22025 46086900
         IC    R14,SCBMACR-1            SAVE HIGH ORDER BYTE     S22025 46186900
         ST    R10,SCBMACR-1            SET NEW LIST ADDRESS     S22025 46286900
         STC   R14,SCBMACR-1            RESTORE                  S22025 46386900
NOHOLD   EQU   *                                                        46486900
         TM    LCBSTAT1,LCBRECVN        HOLD IN IN MSG           A49221 46586900
         BO    SAME2                    BR YES - NO BFRS THERE   A49221 46686900
NOTYET   EQU   *                                               @OS76483 46786900
RETBUF   EQU   *                                                SA66605 46886900
         LA    R9,AVTBFRTB              BFR RETRN Q                     46986900
         ST    R9,PRFQCBA-1                                             47086900
RTNBFR   EQU   *                                                        47186900
         LR    R1,RPRF                  ADD TO POST LIST                47286900
         ST    R5,PRFLINK-1             OLD POST LIST IN LINK           47386900
         MVI   PRFPRI,PRIBFRTB          OF BFR                          47486900
         BAL   R14,DSPCHAIN             EXIT                   @Y17XAMX 47586900
         SPACE 5                                                 S22025 47686900
         DS    0F                                                S22025 47786900
TIMEQBK  EQU   *-8                      RETURN HERE WITH QCB FROMS22025 47886900
*                                       TIME DELAY               S22025 47986900
OFFTIMEQ DC    AL1(DSPMCPL4)            STCB                     S22025 48086900
         DC    AL3(OFFTIMEQ)            THAT GAIN CONTROL WHEN Q S22025 48186900
*                                       QCB COMES FROM TIME DELAYS22025 48286900
         USING *,R15                    ADDRESSABILITY ON R15    S22025 48386900
         LR    RQCB,R1                  SET QCB REG THIS IS THE  S22025 48486900
*                                       QCB FROM THE TIME DELAY QS22025 48586900
         SR    R0,R0                                                    48686900
         LR    R1,R0                    CLEAR                           48786900
         IC    R1,QCBRELLN              QCB REL LINE NO                 48886900
         L     RDCB,QCBDCBAD-1          DCB ADDR                        48986900
         L     R4,DCBIOBAD              FIRST IOB ADDR - SIZE OF LCB    49086900
         IC    R0,DCBEIOBX              ISZE OF LCB                     49186900
         MR    R0,R0                    SIZE X REL LN. NO               49286900
         AR    R4,R1                    + ADDR FIRST IOB                49386900
         LA    R9,LCBFLAG1-IEDQLCB      DIFFERENCE BETWEEN LCB AND IOB  49486900
         SR    R4,R9                    R4 HAS LCB ADDR                 49586900
         LA    R14,DSPDISP              SET RTN ADDR             CLUP21 49686900
         B     NOTEST                   BRANCH                  SA56907 49786900
         SPACE 2                                                SA52971 49886900
         DROP  R15                                               S22025 49986900
         TITLE    '''IEDQAS01''  -  RELEASE'                            50086900
*********************************************************************** 50186900
*TITLE  'IEDQAS01'  RELEASE                                           * 50286900
*                                                                     * 50386900
*  MODULE NAME IEDQAS ( IEDQAS01 )                                    * 50486900
*                                                                     * 50586900
*  DESCRIPTIVE NAME = RELESAE ROUTINE                                 * 50686900
*                                                                     * 50786900
*  COPYRIGHT = 'NONE'                                                 * 50886900
*                                                                     * 50986900
*  STATUS:  CHANGE LEVEL 5                                            * 51086900
*                                                                     * 51186900
*FUNCTION -- TO RELEASE A TERMINAL THAT HAS BEEN HELD PREVIOUSLY.     * 51286900
*   RELEASE WILL BACK UP THE FEFO CHAIN BY MOVING THE SAVED     SA52971 51386900
*   POINTER IN INTFF INTO THE POINTER TO THE BEGINNING OF THE   SA52971 51486900
*   FEFO CHAIN.  THE SEND SCHEDULER FOR THIS QUEUE WILL THEN BE SA52971 51586900
*   ACTIVATED TO SEND THESE MESSAGES ACCORDING TO ITS OWN       SA52971 51686900
*   ALGORITHM.                                                  SA52971 51786900
*                                                                     * 51886900
*ENTRY POINTS -- IEDQAS01 - TO RELEASE A TERMINAL                     * 51986900
*   CALLING SEQUENCE         LA    R15,IEDQAS01                       * 52086900
*                            BR   R15                                 * 52186900
*                                                                     * 52286900
*INPUT -- A BUFFER UNIT FROM OPERATOR CONTROL OR FROM THE TIME        * 52386900
*   DELAY QUEUE.                                                      * 52486900
*                                                                     * 52586900
*OUTPUT -- THE HOLD BIT IN THE TERMINAL ENTRY IS OFF AND THE QCBINTFF * 52686900
*   CHAIN WILL BE MOVED TO THE FFEFO CHAIN.                           * 52786900
*                                                                     * 52886900
*EXTERNAL ROUTINES -- DSPPOST - TO PLACE ELEMENTS ON THE READY Q      * 52986900
*   A SCHEDULER SUBROUTINE TO FIND A LINE FOR THE SCHEDULER           * 53086900
*                                                                     * 53186900
*EXITS-ERROR -- NONE                                                  * 53286900
*                                                                     * 53386900
*TABLES/WORKAREAS -- AVT, SCB, TTABLE, PRF, QCB, STCB, DCB      SA52971 53486900
*                                                                     * 53586900
*ATTRIBUTES -- REUSABLE, ENABLED, RESIDENT                            * 53686900
*                                                                     * 53786900
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 53886900
*   PARTICULAR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER      * 53986900
*   SET.                                                              * 54086900
*                                                                     * 54186900
*********************************************************************** 54286900
*                                                                     * 54386900
         DS    0F                                                       54486900
IEDQAS01 EQU   *-8                      RELEASE QCB              CLUP21 54586900
RELSTCB  DC    AL1(DSPMCPL4)           SUBTASK ENTRY CODE               54686900
         DC    AL3(RELSTCB)            STCB ADDRESS                     54786900
         SPACE 2                                                        54886900
RELEASE  EQU   *                                                        54986900
         USING *,R15                    SET BASE AS R15        @X50X9MH 55086900
         LR    RBASE,R15                SET UP REG 12          @X50X9MH 55186900
         SH    RBASE,OFFSET             BASE = TO START OF QAS @X50X9MH 55286900
         B     SKIPDC                   BRANCH AROUND CONSTANT @X50X9MH 55386900
OFFSET   DC    AL2(RELEASE-IEDQAS)                             @X50X9MH 55486900
SKIPDC   EQU   *                                               @X50X9MH 55586900
         DROP  R15                      DROP R15 AS BASE       @X50X9MH 55686900
         NC    SAVERLSE,SAVERLSE        IS THIS IEDRELS?       @VS41080 55786900
         BNZ   NEWRELS                  BRANCH YES             @VS41080 55886900
         LR    RPRF,R1                  BFR ADDR                        55986900
         LH    R1,PRFDEST               DEST OFFSET                     56086900
NEWRELS  EQU   *                                               @X50X9MH 56186900
         N     R1,AVTCLRHI                                              56286900
         LR    R4,R1                    LOAD TTCIN IN R4       @OZ14184 56336900
         L     R15,AVTRNMPT             TO SUBROUTINE TO FIND           56386900
         BALR  R14,R15                  TERM ENTRY                      56486900
         L     RQCB,TRMDESTQ-1          DEST QCB ADDR           SA52971 56586900
         CLI   PRFPRI,PRIOPCTL          IS THIS PERM HOLD      @OZ15629 56590900
         BNE   HOLDNO                   NO, SKIP DELAY Q SCAN  @OZ15629 56594900
         CLI   PRFSTAT1,ONE             STOP MID-MSG           @OZ15629 56598900
         BNE   BUFFCHK                  BRANCH NO              @OZ15629 56602900
         TM    QCBINSRC+2,QCBDELAY      QCB ON TIME DELAY Q    @OZ15629 56606900
         BZ    BUFFCHK                  NO, GO CK FOR BUF ON Q @OZ15629 56610900
         L     R10,QCBELCHN-1           GET QCB POST ADDR      @OZ15629 56614900
         LA    R10,0(,R10)              ZERO BYTE 0            @OZ15629 56618900
         LA    R14,TIMEQBK              DELAY RETRN QCB ADDR   @OZ15629 56622900
         CR    R10,R14                  SAME AS POST QCB       @OZ15629 56626900
         BNE   BUFFCHK                  NO, CK BUF ON TDELAY Q @OZ15629 56630900
         LR    R10,R1                   SAVE TERM ENTRY ADDR   @OZ15629 56634900
         LR    R1,RQCB                  PUT QCB ADDR IN R1     @OZ15629 56638900
         L     R15,AVTHG02              ADDR ELEM REMOVE RTN   @OZ15629 56642900
         AH    R13,SAVESIZE             BUMP TO NEXT SAVE AREA @OZ15629 56646900
         BALR  R14,R15                  REMVE QCB FROM TDELAY Q@OZ15629 56650900
         SH    R13,SAVESIZE             RESTORE SAVE AREA PTR  @OZ15629 56654900
         LR    R1,R10                   RETURN TERN ENTRY ADDR @OZ15629 56658900
         NI    QCBINSRC+2,AVTEFF-QCBDELAY TURN OFF TDELAY BIT  @OZ15629 56662900
BUFFCHK  EQU   *                                               @OZ15629 56666900
         BAL   R10,QSCAN                GO SCAN TDELAY Q FOR BU@OZ15629 56670900
         LA    R14,DSPDISP              SET ROUTINE ADDR       @OZ15629 56674900
         B     FREEBUF                  GO FREE BUFFER         @OZ15629 56678900
HOLDNO   EQU   *                                               @OZ15629 56682900
         TM    TRMSTATE,TRMHELDN        TERMINAL HELD?         @X50X9MH 56686900
         BO    RLSTERM                  BRANCH YES             @X50X9MH 56786900
         NC    SAVERLSE,SAVERLSE        IS THIS IEDRELS?       @VS41080 56886900
         BZ    ALLFEFO                  BRANCH NO              @VS41080 56986900
         MVI   RTNFIELD,X'04'           ISSUE 04 RETURN CODE   @X50X9MH 57086900
         B     ALLFEFO                  DON'T FREE BUFFER      @X50X9MH 57186900
RLSTERM  EQU   *                                               @X50X9MH 57286900
         NI    TRMSTATE,TRMHELDF        TURN OFF HELD FLAG              57386900
         NI    QCBSTAT,AVTEFF-QCBTRMHO  INDICATE TERMINAL WAS RELEASED  57486900
         TM    QCBDSFLG,QCBDRQQ         CONC DRQ                 S22026 57586900
         BO    ALLFEFO                  BRANCH IF YES            S22026 57686900
         LA    RPQ,QCBMSIZE(RQCB)       ADDR OF PRTY QCB                57786900
LOOP     EQU   *                                                        57886900
         NC    QCBINTFF(3),QCBINTFF     ANY HELD MSGS ON THES LEVEL     57986900
         BZ    NEXTLVL                  NO, GO TO NEXT ONE       CLUP21 58086900
         MVC   QCBFFEFO(3),QCBINTFF     SET NEW FEFO                    58186900
         XC    QCBINTFF(3),QCBINTFF     CLEAR FIRST HELD FEFO           58286900
         MVC   QCBPREVF(3),QCBPFEFO     RESET SHUFFLE SPOT      SA52971 58386900
NEXTLVL  EQU   *                                                        58486900
         CLI   QCBPRIPQ,AVTEZERO        LAST PRTY QCB                   58586900
         LA    RPQ,QCBPEND-IEDQPQCB(RPQ)                                58686900
*              ADDR OF NEXT PRTY LEVEL QCB                              58786900
         BNE   LOOP                     NO, CONTINUE SEARCH      CLUP21 58886900
ALLFEFO  EQU   *                                                        58986900
         BAL   R10,QSCAN                SCAN TIME DELAY QUEUE  @OZ14184 59036900
         NC    SAVERLSE,SAVERLSE        IS THIS IEDRELS?       @VS41080 59086900
         BNZ   NOBUFRTN                 YES-DON'T FREE BUFFER  @VS41080 59186900
         LR    R10,RQCB                 SAVE QCB ADDR FROM DISPATCHER   59286900
         BAL   R14,FREEBUF              GO FREE BUFFER         @OZ15629 59336900
         LR    RQCB,R10                 RESTORE QCB ADDR                59886900
         LA    R14,DSPDISP              SET RTN ADDR             CLUP21 59986900
         B     OLDCODE                  CONTINUE OLD PATH      @X50X9MH 60086900
FREEBUF  EQU   *                                               @OZ15629 60096900
         LA    R1,AVTBFRTB              GET BUF RTN QCB PTR    @OZ15629 60106900
         ST    R1,PRFQCBA-1             PUT PTR IN BUFFER      @OZ15629 60116900
         MVI   PRFPRI,PRIBFRTB          SET POST PRIORITY      @OZ15629 60126900
         LR    R1,RPRF                  PUT BUF ADDR IN REG1   @OZ15629 60136900
         B     DSPPOSTR                 GO POST BUFFER         @OZ15629 60146900
NOBUFRTN EQU   *                                               @X50X9MH 60186900
         LA    14,RETURN02              RETURN THRU IEDQUI     @X50X9MH 60286900
OLDCODE  EQU   *                                               @X50X9MH 60386900
         CLI   QCBSTPRI,X80             DIAL W/DELAY             S21903 60486900
         BE    NOTEST                                           SA56303 60586900
         TM    QCBINSRC+2,QCBDELAY      IS TIME Q                       60686900
         BO    TIMEQ                    BRANCH IF YES          @OS76674 60786900
         CLI   QCBSTPRI,X60             DIAL W/O CLOCK OR INTVL@OS76674 60886900
         BL    NOTEST                   BRANCH IF NO           @OY13627 60986900
*   SCAN DIAL-OUT CALL QUEUE FOR STCB AND,IF FOUND,PROCEED AS IF        61086900
*   QCB HAD BEEN REMOVED FROM THE TIME DELAY QUEUE             @OS76674 61186900
         SR    R15,R15                  CLEAR FOR IC           @OS76674 61286900
         L     R10,QCBDCBAD-ONE         GET DCB ADDRESS        @OS76674 61386900
         TM    DCBDSORG-IHADCB(R10),AVTE80 IS THIS DCB OR LGB  @OS77382 61486900
         BO    NOTEST                   LGB, BRANCH            @OS77382 61586900
         IC    R15,DCBEIOBX-IHADCB(R10) LCB LENGTH             @OS76674 61686900
         L     R10,DCBIOBAD-IHADCB(,R10) ADDR OF IOB           @OS76674 61786900
*                                         LESS LCB SIZE        @OS76674 61886900
         AR    R10,R15                  POINT TO FIRST IOB     @OS76674 61986900
         SH    R10,DOCQ                 ADDR OF D/O CALL QUEUE @OS76674 62086900
         LA    R2,QCBSTVTO              SEND SCHED TO FIND     @OS76674 62186900
LOOPDOCQ EQU   *                                               @OS76674 62286900
         LR    R15,R10                  SAVE PREVIOUS ELEMENT  @OS76674 62386900
         L     R10,STCBLINK-1-IEDQSTCB(,R15) NEXT ELEMENT      @OS76674 62486900
         CLI   STCBPRI-IEDQSTCB(R10),AVTEZERO END OF CHAIN?    @OS76674 62586900
         BE    NOTEST                   BRANCH IF YES          @OS76674 62686900
         LA    R10,0(,R10)              CLEAR HIGH BYTE        @OS76674 62786900
         CLR   R10,R2                   IS THIS THE SEND SCHED @OS76674 62886900
*                                        WE ARE LOOKING FOR?   @OS76674 62986900
         BNE   LOOPDOCQ                 CONTINUE SCAN IF NO    @OS76674 63086900
         MVC   STCBLINK-IEDQSTCB(3,R15),STCBLINK-IEDQSTCB(R10) @OS76674 63186900
*              REMOVE SEND SCHED FROM D/O CALL QUEUE           @OS76674 63286900
         B     RESETQ                   PUT SEND SCHED BACK    @OS76674 63386900
*                                        INTO DEST QCB         @OS76674 63486900
TIMEQ    EQU   *                                               @OS76674 63586900
         LR    R1,RQCB                  QCB TO BE REMOVED       SA56303 63686900
         L     R15,AVTHG02              ADDR TO REMOVE          SA56303 63786900
         AH    R13,SAVESIZE             BUMP TO NEXT SAVEAREA  @OX12493 63886900
         LR    R10,R14                  SAVE R14                SA56303 63986900
         BALR  R14,R15                  REMOVE FROM TIME DELAY  SA56303 64086900
         LR    R14,R10                  RESTORE R14             SA56303 64186900
         SH    R13,SAVESIZE             RESTORE SAVEAREA ADDR  @OX12493 64286900
         NI    QCBINSRC+2,AVTEFF-QCBDELAY   RESET DELAY FLAG    SA56303 64386900
RESETQ   EQU   *                                               @OS76674 64486900
         MVC   QCBSLINK(3),QCBSTCHN     REINSERT SEND           SA56303 64586900
         LA    R10,QCBSTCHN-1            SCHEDULER STCB         SA56303 64686900
         IC    R15,QCBSTVTO              INTO THE               SA56303 64786900
         ST    R10,QCBSTVTO              QCB STCB               SA56303 64886900
         STC   R15,QCBSTVTO              CHAIN                  SA56303 64986900
         CLI   QCBSTVTO,DSPBUFSC        BUFFERED QCB            SA63009 65086900
         BNE   NOTEST                   NO, BRANCH              SA63009 65186900
         TM    QCBSTAT,QCBSEND          SENDING TO BFRD TERM   @OX12572 65286900
         BZ    NOTEST                   NO, COUNT WAS DECRMNTD @OX12572 65386900
*                                       BY BFRD TERM SCHEDULER @OX12572 65486900
         L     R10,QCBDCBAD-ONE         GET DCB ADDRESS         SA63009 65586900
         SR    R15,R15                  CLEAR FOR IC            SA63009 65686900
         IC    R15,QCBRELLN             GET RELATIVE LINE NUMBERSA63009 65786900
         SLL   R15,TWO                  MULTIPLY BY FOUR        SA63009 65886900
         L     R10,DCBINVLI-IHADCB-AVTECD4(R10,R15) GET         SA63009 65986900
*                                        INVITATION LIST ADDR   SA63009 66086900
         IC    R15,INVTCNT(R10)         SUBTRACT ONE FROM COUNT SA63009 66186900
         BCTR  R15,ZERO                 OF TERMINALS CURRENTLY  SA63009 66286900
         STC   R15,INVTCNT(R10)         BEING SENT TO -         SA63009 66386900
*                                        BUFFERED SCHEDULER     SA63009 66486900
*                                        WILL ADD IT BACK       SA63009 66586900
NOTEST   EQU   *                                                        66686900
         LA    R10,QCBSTCHN-1           ADDR OF STCB                    66786900
         L     R15,QCBSTCHN-1           SUBTASK POINTER          CLUP21 66886900
         LA    R15,AVTEZERO(,R15)       CLEAR FOR COMPARE        CLUP21 66986900
         CR    R10,R15                  IS SEND-SCHED THERE      CLUP21 67086900
         BCR   NE,R14                   NO, EXIT                 S21903 67186900
         SR    R15,R15                  THIS ROUTINE WILL               67286900
         IC    R15,QCBSTVTO             FIND THE SUBROUTINE             67386900
         AR    R15,R15                  IN THE SCHEDULER TO             67486900
         L     R2,AVTDISP-24(R15)       CALL TO MOVE THE STCB           67586900
         SH    R2,AVTHA2                FROM THE QCB TO THE SCB         67686900
         LH    R15,0(R2)                TO THE SCB TO DIAL OUT Q        67786900
         AR    R15,R2                                                   67886900
         BR    R15                      RETURN                   S22025 67986900
QSCAN    EQU   *                                               @OZ14184 67988900
         LA    R2,AVTDELYB              ADDR TIME DELAY QCB    @OZ14184 67990900
LOOPBUF  EQU   *                                               @OZ14184 67992900
         L     R3,OFFSET1C(,R2)         GET LINK ADDR          @OZ14184 67994900
         LA    R3,0(,R3)                ZERO HIGH BYTE         @OZ14184 67996900
         C     R3,AVTDELYB              IS ELEM TIME DELAY QCB @OZ14184 67998900
         BER   R10                      YES, ELEM NOT HERE     @OZ14184 68000900
         CLI   TDLOFF(R3),BUFFER        IS THIS ELEM A BUFFER  @OZ14184 68002900
         BNE   NOTBUF                   NO, GET NEXT ELEM      @OZ14184 68004900
         CH    R4,PRFDEST-IEDQPRF(R3)   MATCHING BUFFER        @OZ14184 68006900
*                                       ON TIME DELAY QUEUE ?  @OZ14184 68008900
         BNE   NOTBUF                   NO, BRANCH             @OZ14184 68010900
         LA    R2,IEDQAS01              GET ADDR OF RELEASE QCB@OZ14184 68012900
         CLM   R2,7,TDLQCBAD(R3)        BUF SCHED FOR REL POST @OZ14184 68014900
         BE    FOUND                    YES, GO TO REMOVE      @OZ14184 68016900
NOTBUF   EQU   *                                               @OZ14184 68018900
         LR    R2,R3                    PUT NEXT ELEM ADDR     @OZ14184 68020900
*                                       IN REG 2               @OZ14184 68022900
         B     LOOPBUF                  GO SEARCH NEXT ELEM    @OZ14184 68024900
*                                       ON TIME DELAY QUEUE    @OZ14184 68026900
FOUND    EQU   *                                               @OZ14184 68028900
         L     R15,AVTHG02              GET ADDR OF TIME DELAY @OZ14184 68030900
*                                       REMOVE ELEM ROUTINE    @OZ14184 68032900
         AH    R13,SAVESIZE             BUMP TO NEXT SAVE AREA @OZ14184 68034900
         LR    R1,R3                    PUT BUFFER ADDR IN REQ @OZ14184 68036900
         BALR  R14,R15                  REMOVE BUFFER FROM TIME@OZ14184 68038900
*                                       DELAY QUEUE            @OZ14184 68040900
         SH    R13,SAVESIZE             RESTORE SAVE AREA PTR  @OZ14184 68042900
         LR    R2,RQCB                  SAVE QCB ADDR          @OZ14184 68044900
         LR    R5,RPRF                  SAVE BUF ADDR          @OZ15629 68045300
         LR    RPRF,R3                  SET BUFFER ADDR        @OZ15629 68045700
         BAL   R14,FREEBUF              GO PUT BFR ON RDY QUEUE@OZ15629 68046100
         LR    RPRF,R5                  RESTORE BUF ADDR       @OZ15629 68046500
         LR    RQCB,R2                  RESTORE QCB ADDR       @OZ14184 68054900
         BR    R10                      RETURN TO CALLER       @OZ14184 68056900
         SPACE 1                                                        68086900
         EJECT                                                          68186900
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  S21101 68286900
*                                                             *  S21101 68386900
*        THIS SECTION OF CODE GETS CONTROL WHEN THE HOLD      *  S21101 68486900
*        MACRO IS ISSUED IN THE INHEADER SUBGROUP AND IS      *  S21101 68586900
*        ENTERED FROM THE USER INTERFACE ROUTINE, IEDQUI      *  S21101 68686900
*                                                             *  S21101 68786900
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@X50X9MH 68886900
IEDQAS02 EQU   *                                               @X50X9MH 68986900
         DROP  13                                              @X50X9MH 69086900
         USING IEDQAVTD,R9                                     @X50X9MH 69186900
         USING HOLD,RBASE                                      @X50X9MH 69286900
         XC    SAVERLSE,SAVERLSE        CLEAR SAVEAREA         @X50X9MH 69386900
         CLI   2(R1),X'D9'              IS THIS IEDRELS MACRO  @X50X9MH 69486900
         BNE   OLDRLSE                  BR NO TO CONTINUE      @X50X9MH 69586900
         XC    RTNFIELD,RTNFIELD        CLEAR RTNFIELD         @X50X9MH 69686900
         LH    R1,PRFSRCE               TERMINAL TO BE RELEASED@X50X9MH 69786900
         LA    R15,INVALSRC             ASSUME ERROR           @OX12507 69886900
         N     R1,AVTCLRHI              CLEAR HI HALFWORD AND  @OX12507 69986900
*                                       CHECK FOR ZERO         @OX12507 70086900
         BZ    GOODRTN                  BR IF SOURCE INVALID   @OX12507 70186900
         ST    R9,SAVERLS1              SAVE REG 9             @VS41488 70286900
         ST    R13,SAVERLSE             SAVE REG 13            @X50X9MH 70386900
         LA    R13,AVTSAVE2             PUT AVT ADDR IN REG13  @X50X9MH 70486900
         L     RDISP,AVTEA              PUT DISPATCH ADDR IN B @YM08009 70536900
         LA    R15,RELEASE              PREPARE TO BRANCH      @X50X9MH 70586900
         BR    R15                      BR TO OLD RELEASE CODE @X50X9MH 70686900
OLDRLSE  EQU   *                                               @X50X9MH 70786900
         LR    R8,R1                    SAVE PARM LIST ADDRESS @OY12688 70886900
*                                         ADDRESS                S21101 70986900
         LH    R1,LCBTTCIN              CURRENTLY CONNECTED    @OY12688 71086900
         LA    R15,INVALSRC             ASSUME ERROR             CLUP21 71186900
         N     R1,AVTCLRHI              CLEAR THE HIGH ORDER     S21101 71286900
*                                         BYTE OF THE OFFSET     S21101 71386900
         BZ    RETURN02                NO, RETURN                CLUP21 71486900
         L     R15,AVTRNMPT            LOAD THE ADDRESS OF THE   S21101 71586900
*                                         IEDQTNT ROUTINE        S21101 71686900
         CLC   LCBTTCIN,TNTLEN-IEDQTNTD(R15)   A TOTE TNT?     @Y17XANQ 71786900
         BALR  R14,R15                  BRANCH TO IEDQTNT        S21101 71886900
         SPACE 2                                                 S21101 71986900
         LA    R15,NOTHELD              ASSUME ERROR             CLUP21 72086900
         TM    TRMSTATE,TRMLIST+TRMPROC CAN TERM BE HELD        SA66617 72186900
         BNZ   RETURN02                NO, RETURN                CLUP21 72286900
         LA    R15,ALRDYHLD             ASSUME ERROR             CLUP21 72386900
         TM    TRMSTATE,TRMHELDN        IS TERMINAL ALREADY HELD CLUP21 72486900
         BNZ   RETURN02                 YES, RETURN              CLUP21 72586900
         SPM   R14                      IS THIS A TOTE TTE?    @Y17XANQ 72686900
         BNH   NOXTOTE                    BRANCH IF NOT        @Y17XANQ 72786900
         SPACE                                                          72886900
         TM    TRMSTATE,TRMPREF         IS TTE ATTACHED VIA NCP?        72986900
         BZ    NOXTOTE                    BRANCH IF NOT        @Y17XANQ 73086900
         SPACE                                                          73186900
         LR    RQCB,R1                  COPY TTE ADDRESS       @Y17XANQ 73286900
         LA    R15,TRMPRFSZ             PREFIX SIZE            @Y17XANQ 73386900
         SLR   RQCB,R15                 BACK UP TO PREFIX      @Y17XANQ 73486900
         TM    TRMBYTE0-IEDNTRM(RQCB),TRMSNA    SNA TOTE,      @Y17XANQ 73586900
*                                       ALLOW A HOLD FUNCTION  @Y17XANQ 73686900
         BZ    RETURN02                   BRANCH IF NOT SNA    @Y17XANQ 73786900
         SPACE                                                          73886900
NOXTOTE  EQU   *                                               @Y17XANQ 73986900
         L     RQCB,TRMDESTQ-1          LOAD THE ADDRESS OF THE  S21101 74086900
*                                         DESTINATION QCB        S21101 74186900
         LA    R15,NOTDISK              ASSUME ERROR             CLUP21 74286900
         TM    QCBDSFLG,QCBREUS+QCBNREUS     IS DISK QUEUEING    S21101 74386900
*                                         BEING USED             S21101 74486900
         BZ    RETURN02                NO, RETURN                CLUP21 74586900
         OI    TRMSTATE,TRMHELDN        SET THE HELD BIT IN THE  S21101 74686900
*                                         TERMINAL ENTRY         S21101 74786900
         OI    QCBSTAT,QCBTRMHO         AND IN THE DEST QCB      S21101 74886900
         SR    R2,R2                    CLEAR FOR RETURN CODE  @OY12688 74986900
         TM    LCBSTAT1,LCBSENDN        SENDING/OUTHDR         @OY12688 75086900
         BNO   RETURN01                 NO RETURN              @OY12688 75186900
         TM    TWO(R8),OPFLDI           INTERVAL SPECIFIED     @OY12688 75286900
         BZ    RETURN01                 NO, EXIT               @OY12688 75386900
         BM    NOPT                     NOT INTVL=OPFLD        @OY12688 75486900
         LA    R1,EIGHT(R8)             SET QAE PARM LIST      @OY12688 75586900
         L     R15,FOUR(R8)             ADDRESS OF IEDQAE      @OY12688 75686900
         MVI   AVTEZERO(R1),AVTEFF      SET PARAMETERS FOR     @YM07733 75786900
         MVI   ONE(R1),FOUR             ENTRY TO IEDQAE        @YM07733 75886900
         LA    R3,AVTSAVE3-AVTSAVE2(R13) NEXT SAVE AREA ADDR   @OY12688 75986900
         ST    R13,FOUR(R3)             SAVE BACKWARD POINTER  @OY12688 76086900
         ST    R3,EIGHT(R13)            SAVE FORWARD POINTER   @OY12688 76186900
         LR    R13,R3                   QAE SAVE AREA          @OY12688 76286900
         BAL   R14,FOUR(R15)            LINK TO QAE PLUS FOUR  @YM07733 76486900
         L     R13,FOUR(R13)            RESTORE SAVE AREA      @YM08009 76586900
HERE     EQU   *                                                        76636900
         LTR   R15,R15                  CHECK RETURN CODE      @OY12688 76686900
         BZ    MOVE                     OPTION FLD FOUND       @YM07733 76786900
DEFLT    EQU   *                                               @OY12688 77286900
         LA    R2,X18                   NO OPFIELD FOUND RET CO@OY12688 77386900
         LA    R1,ONESCND               DEFAULT OF ONE SECOND  @OY12688 77486900
MOVE     EQU   *                                               @OY12688 77586900
         MVC   EIGHT(TWO,R8),ZERO(R1)   MOVE INTVL TO PLIST    @OY12688 77686900
         LA    R8,FOUR(,R8)             BUMP PARMLIST ADDR     @OY12688 77786900
NOPT     EQU   *                                               @OY12688 77886900
         L     R1,AVTBFREB              AVAIL BUFFER QUEUE     @OY12688 77986900
         LA    R1,ZERO(R1)              CLEAR HIGH ORDER HALF  @OY12688 78086900
         LTR   R1,R1                    ANY BUFFERS AVAIL      @OY12688 78186900
         BNZ   NOCHNG                   YES, LEAVE RET CODE    @OY12688 78286900
         LA    R15,X1C                  NO BFRS AVAIL RET CODE @OY12688 78386900
         B     RETURN02                 EXIT                   @OY12688 78486900
NOCHNG   EQU   *                                               @OY12688 78586900
         MVC   AVTBFREB+1(3),FIVE(R1)   REMOVE BUFFER FROM Q   @OY12688 78686900
         LH    R15,AVTAVFCT             AVAILABLE COUNT        @OY12688 78786900
         BCTR  R15,0                    DECREMENT              @OY12688 78886900
         STH   R15,AVTAVFCT             STORE IT BACK          @OY12688 78986900
         MVC   PRFDEST-IEDQPRF(2,R1),LCBTTCIN SET UP DEST      @OY12688 79086900
         MVI   PRFSTAT1-IEDQPRF(R1),ZERO MARK AS HDR BUFFER    @OY12688 79186900
         MVI   PRFNBUNT-IEDQPRF(R1),X01 INDICATE ONE UNIT      @OY12688 79286900
         MVC   PRFSRCE-IEDQPRF(2,R1),FOUR(R8) PUT INTVL IN BFR @OY12688 79386900
         MVI   PRFSIZE-IEDQPRF(R1),EIGHT OFFSET TO QCB         @OY12688 79486900
         MVI   FOUR(R1),PRIRELSE        SET PRIORITY           @OY12688 79586900
         LA    R15,IEDQAS01             RELEASE QCB ADDRESS    @OY12688 79686900
         ST    R15,EIGHT(R1)            PUT IT IN BUFFER       @OY12688 79786900
         L     R15,AVTHG01              INSERT TIME ELEMENT RTN@OY12688 79886900
         LR    RPRF,R13                 SAVE AVTSAVE ADDRESS   @OY12688 79986900
         LA    R13,AVTSAVE3             MOVE TO NEXT           @OY12688 80086900
         BALR  R14,R15                  LINK TO INSERT ELEMENT @OY12688 80186900
         LR    R13,RPRF                 RESTORE SAVE2 ADDRESS  @OY12688 80286900
RETURN01 EQU   *                                               @OY12688 80386900
         LR    R15,R2                   SET RETURN CODE        @OY12688 80486900
RETURN02 EQU   *                                               @OY12688 80586900
         NC    SAVERLSE,SAVERLSE        SAVEAREA CONTAIN ZEROS @X50X9MH 80686900
         BZ    GOODRTN                  YES, CON'T OLD CODE    @X50X9MH 80786900
         L     R13,SAVERLSE             RESTORE REG 13         @OX12493 80886900
         XC    SAVERLSE,SAVERLSE        CLEAR SAVE AREA        @OZ29587 80936982
         LR    R9,R13                   R9 HAS CALLERS SAVEADR @OX12493 80986900
         SH    R9,SAVESIZE              SUBTRACT X'48'         @OX12493 81086900
         ST    R9,4(R13)                RESTORE BACK POINTER   @OX12493 81186900
         L     R9,SAVERLS1              RESTORE R9             @OX12493 81286900
         SR    R15,R15                  CLEAR R15 FOR RET CODE @OX12493 81386900
         IC    R15,RTNFIELD             ISSUE RETURN CODE      @OX12493 81486900
GOODRTN  EQU   *                                               @OX12493 81586900
         XC    SAVERLSE,SAVERLSE        CLEAR SAVE AREA                 81686900
         L     R12,AVTUI                LOAD ADDR OF RETURN RTN@OY12688 81786900
         B     FOUR(R12)                RETURN TO CALLER       @OY12688 81886900
DOCQ     DC    AL2(LCBFLAG1-IEDQLCB+8)  CALL QUEUE OFFSET      @OY12688 81986900
         DS    0F                       BOUNDARY ALIGNMENT     @YM07733 82036900
SAVERLSE DC    XL4'0'                   SAVE AREA FOR R13      @OX12492 82086900
SAVERLS1 DC    XL4'0'                   SAVE AREA FOR REG 9    @OX12492 82186900
SAVESIZE DC    H'72'                    SIZE OF AVT SAVE AREA  @OX12493 82286900
ONESCND  DC    H'1'                     ONE SECOND DELAY DEFAUL@OY12688 82386900
RTNFIELD DC    XL1'0'                   RTNCODE FIELD          @OX12492 82486900
         EJECT                                                          82586900
         TQCBED                                                  S22026 82686900
         EJECT                                                   S21101 82786900
         TPRIOR                                                         82886900
         EJECT                                                          82986900
         TAVTD                                                   S22025 83086900
         EJECT                                                          83186900
         TLCBD                                                          83286900
         TSTCBD                                                         83386900
         TPRFD                                                          83486900
         TQCBD                                                          83586900
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *       83686900
*        OFFSETS FOR THE TIME DELAT SUBTASK                        *    83786900
TDLLINK  EQU   QCBLKRRN-IEDQQCB         AT X'1D'                        83886900
TDLOFF   EQU   QCBEOLDT+2-IEDQQCB       AT X'12'                        83986900
TDLEOLDT EQU   QCBEOLDT-IEDQQCB         AT X'10'                        84086900
TDLQCBAD EQU   QCBSTCHN-IEDQQCB         AT X'08'                        84186900
TDLINDEX EQU   X'08'                    OFFSET TO QCB ADDR              84286900
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *       84386900
*        TO COMPLY WITH THESE OFFSETS THE FOLLOWING WILL                84486900
*        BE DESTROYED                                                   84586900
*        PRFTIC                         AT X'08'                        84686900
*        PRFCRCD                        AT X'28H                        84786900
*        PRFSRCE                        AT 16                           84886900
*        PRFSIZE                        AT 18                           84986900
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *       85086900
         DCBD  DSORG=TX                                                 85186900
         TTRMD                                                          85286900
         TSCBD                                                          85386900
         EJECT                                                   S21903 85486900
         TTNTD                         TERMNAME TABLE DSECT     SA63011 85586900
         TDISPD                                                         85686900
         END                                                            85786900
