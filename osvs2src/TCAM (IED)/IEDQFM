         TITLE 'IEDQFM, USS-FSS/FSS-USS CONVERSION PROGRAM             *00001000
                        '                                               00002000
IEDQFM   CSECT ,                                                01S0001 00003000
@PROLOG  BALR  @12,0                                            01S0001 00004000
@PSTART  DS    0H                                               01S0001 00005000
         USING @PSTART,@12                                      01S0001 00006000
*                    /*                                                 00007000
IEDQFM   IEDHJN AFTERHJN,HJN           MODULE IDENTIFICATION MACRO      00008000
*   PARM=RPARM;                     /* SAVE PARAMETER REGISTER       */ 00009000
         LR    PARM,RPARM                                       03S0317 00010000
*   IEDQPPTR=AVTADBUF;              /* BUFFER PREFIX BASE            */ 00011000
         L     @08,AVTADBUF(,RAVT)                              03S0318 00012000
         ST    @08,IEDQPPTR                                     03S0318 00013000
*   EXITCODE=TRANSOK;               /* INITIATE RETURN CODE AS  03S0319 00014000
*                                      TRANSLATION OK                */ 00015000
         SLR   @07,@07                                          03S0319 00016000
         ST    @07,EXITCODE                                     03S0319 00017000
*   SAVEDB=0;                       /* CLEAR VALUE ENTRY POINTER SAVE   00018000
*                                      AREA                          */ 00019000
         SLR   @07,@07                                          03S0320 00020000
         ST    @07,SAVEDB                                       03S0320 00021000
*   INPTR=PRMINBFR;                 /* INITIATE INPUT AREA BASE      */ 00022000
         L     INPTR,PRMINBFR(,PARM)                            03S0321 00023000
*   OUTPTR=PRMOUTBF;                /* INITIATE OUTPUT AREA BASE     */ 00024000
         L     OUTPTR,PRMOUTBF(,PARM)                           03S0322 00025000
*   LASTIN=INDATLEN;                /* INITIATE INDEX TO LAST CHAR IN   00026000
*                                      INPUT AREA - USED TO DETERMINE   00027000
*                                      END OF INPUT DATA             */ 00028000
         LH    LASTIN,INDATLEN(,INPTR)                          03S0323 00029000
*   OUTDATA(1:OUTWKLN)=OUTDATA(1:OUTWKLN)&&OUTDATA(1:OUTWKLN);/* ZERO   00030000
*                                      THE OUTPUT AREA               */ 00031000
         LH    @07,OUTWKLN(,OUTPTR)                             03S0324 00032000
         BCTR  @07,0                                            03S0324 00033000
         EX    @07,@SX01710                                     03S0324 00034000
*   LASTOUT=1;                      /* SET INDEX TO FIRST CHARACTER     00035000
*                                      OF OUTPUT AREA -THIS INDEX IS    00036000
*                                      USED AS HIGH WATER MARK TO       00037000
*                                      LAST BYTE OF OUTPUT DATA      */ 00038000
         MVC   LASTOUT(2),@CH00061                              03S0325 00039000
*   KEYWORD=NO;                     /* RESET KEYWORD BEING PROCESSED    00040000
*                                      FLAG                          */ 00041000
         NI    KEYWORD,B'01111111'                              03S0326 00042000
*   PAREN=NO;                       /* RESET PARENTHETICAL VALUE FLAG*/ 00043000
         NI    PAREN,B'01111111'                                03S0327 00044000
*   RFY                                                         03S0328 00045000
*     RPARM UNRSTD;                                             03S0328 00046000
*   IF USSFLAG=USSTYPE THEN         /* IF THE INPUT TABLE TYPE IS       00047000
*                                      USS-FSS                       */ 00048000
         L     @07,PRMTABLE(,PARM)                              02S0329 00049000
         CLI   USSFLAG(@07),X'F1'                               02S0329 00050000
         BNE   @RF00329                                         02S0329 00051000
*     DO;                                                       02S0330 00052000
*                                                               02S0330 00053000
*       /*************************************************************/ 00054000
*       /*                                                           */ 00055000
*       /* THEN PERFORM USS TO FSS CONVERSION                        */ 00056000
*       /*                                                           */ 00057000
*       /*************************************************************/ 00058000
*                                                               02S0331 00059000
*                                                               03S0331 00060000
*       /*************************************************************/ 00061000
*       /*                                                           */ 00062000
*       /* PROCESS.USSTRANS: THIS SEGMENT REPRESENTS THE TOTAL USS TO*/ 00063000
*       /* FSS CONVERSION PROCESS.                                   */ 00064000
*       /*                                                           */ 00065000
*       /*************************************************************/ 00066000
*                                                               03S0331 00067000
*       IF TRHFI^=USS THEN                                      03S0331 00068000
         AL    @08,@CF01713                                     03S0331 00069000
         TM    TRHFI(@08),B'00001000'                           03S0331 00070000
         BNZ   @RT00331                                         03S0331 00071000
*         ;                         /* IF THE INPUT RU IS NOT   03S0332 00072000
*                                      UNFORMATTED, THEN NO ACTION IS   00073000
*                                      TAKEN                         */ 00074000
*       ELSE                                                    03S0333 00075000
*         DO;                                                   03S0333 00076000
*           IF LCBRECVN^=YES THEN   /* ELSE IF THIS IS THE OUTPUT       00077000
*                                      SIDE OF THE MH,               */ 00078000
         TM    LCBRECVN(RLCB),B'00000010'                       03S0334 00079000
         BO    @RF00334                                         03S0334 00080000
*             EXITCODE=BADTABLE;    /* THEN SET INVALID CONVERSION      00081000
*                                      TABLE RETURN CODE AND SUSPEND    00082000
*                                      TRANSLATION                   */ 00083000
*                                                               03S0335 00084000
         LA    @08,32                                           03S0335 00085000
         ST    @08,EXITCODE                                     03S0335 00086000
*           /*********************************************************/ 00087000
*           /*                                                       */ 00088000
*           /* FETCH THE VERB FROM THE INPUT DATA STREAM             */ 00089000
*           /*                                                       */ 00090000
*           /*********************************************************/ 00091000
*                                                               03S0336 00092000
*           ELSE                                                03S0336 00093000
*             DO;                                               03S0336 00094000
*                                                               03S0336 00095000
         B     @RC00334                                         03S0336 00096000
@RF00334 DS    0H                                               03S0337 00097000
*               /*****************************************************/ 00098000
*               /*                                                   */ 00099000
*               /* FETCH THE VERB FROM THE INPUT STREAM              */ 00100000
*               /*                                                   */ 00101000
*               /*****************************************************/ 00102000
*                                                               03S0337 00103000
*                                                               04S0337 00104000
*               /*****************************************************/ 00105000
*               /*                                                   */ 00106000
*               /* PROCESS.USSTRANS.USSCAN: THIS ROUTINE DELINEATES  */ 00107000
*               /* THE USS COMMAND VERB FROM THE INPUT DATA STREAM.  */ 00108000
*               /*                                                   */ 00109000
*               /*****************************************************/ 00110000
*                                                               04S0337 00111000
*               CHARLEN=0;          /* SET LENGTH OF DELIMITED STRING   00112000
*                                      TO ZERO                       */ 00113000
*                                                               04S0337 00114000
         SLR   CHARLEN,CHARLEN                                  04S0337 00115000
*               /*****************************************************/ 00116000
*               /*                                                   */ 00117000
*               /* SCAN TO FIRST CHARACTER IN THE VERB. IF END OF    */ 00118000
*               /* INPUT REACHED SET INVALID INPUT RETURN CODE.      */ 00119000
*               /*                                                   */ 00120000
*               /*****************************************************/ 00121000
*                                                               04S0338 00122000
*               DO SCANPTR=1 TO LASTIN WHILE(INDATA(SCANPTR)=' ');/*    00123000
*                                      SCAN TO VERB                  */ 00124000
         LA    SCANPTR,1                                        04S0338 00125000
         B     @DE00338                                         04S0338 00126000
@DL00338 LR    @08,INPTR                                        04S0338 00127000
         ALR   @08,SCANPTR                                      04S0338 00128000
         CLI   INDATA-1(@08),C' '                               04S0338 00129000
         BNE   @DC00338                                         04S0338 00130000
*               END;                                            04S0339 00131000
         AL    SCANPTR,@CF00061                                 04S0339 00132000
@DE00338 CR    SCANPTR,LASTIN                                   04S0339 00133000
         BNH   @DL00338                                         04S0339 00134000
@DC00338 DS    0H                                               04S0340 00135000
*               IF SCANPTR>LASTIN THEN                          04S0340 00136000
         CR    SCANPTR,LASTIN                                   04S0340 00137000
         BNH   @RF00340                                         04S0340 00138000
*                 EXITCODE=BADINPUT;/* IF END OF INPUT SET INVALID      00139000
*                                      RETURN CODE                   */ 00140000
         LA    @08,28                                           04S0341 00141000
         ST    @08,EXITCODE                                     04S0341 00142000
*               ELSE                                            04S0342 00143000
*                 DO;                                           04S0342 00144000
         B     @RC00340                                         04S0342 00145000
@RF00340 DS    0H                                               04S0343 00146000
*                   FSTCHAR=SCANPTR;/* SET POINTER TO VERB           */ 00147000
*                                                               04S0343 00148000
         STH   SCANPTR,FSTCHAR                                  04S0343 00149000
*                   /*************************************************/ 00150000
*                   /*                                               */ 00151000
*                   /* COUNT THE NUMBER OF CHARACTERS IN THE VERB AND*/ 00152000
*                   /* SAVE                                          */ 00153000
*                   /*                                               */ 00154000
*                   /*************************************************/ 00155000
*                                                               04S0344 00156000
*                   DO SCANPTR=SCANPTR BY 1 WHILE(SCANPTR<=LASTIN&      00157000
*                         INDATA(SCANPTR)^=' ');/* LOOP UNTIL BLANK     00158000
*                                      FOUND OR END OF INPUT OCCURS  */ 00159000
         B     @DE00344                                         04S0344 00160000
@DL00344 DS    0H                                               04S0345 00161000
*                   END;            /* END OF VERB COUNT DO WHILE       00162000
*                                      LOOP                          */ 00163000
         AL    SCANPTR,@CF00061                                 04S0345 00164000
@DE00344 CR    SCANPTR,LASTIN                                   04S0345 00165000
         BH    @DC00344                                         04S0345 00166000
         LR    @08,INPTR                                        04S0345 00167000
         ALR   @08,SCANPTR                                      04S0345 00168000
         CLI   INDATA-1(@08),C' '                               04S0345 00169000
         BNE   @DL00344                                         04S0345 00170000
@DC00344 DS    0H                                               04S0346 00171000
*                   CHARLEN=SCANPTR-FSTCHAR;/* CALCULATE CHARACTER      00172000
*                                      LENGTH                        */ 00173000
         LR    CHARLEN,SCANPTR                                  04S0346 00174000
         SH    CHARLEN,FSTCHAR                                  04S0346 00175000
*                 END;                                          04S0347 00176000
*               IF CHARLEN=0 THEN   /* IF VERB COULD NOT BE FETCHED,    00177000
*                                      ...                           */ 00178000
@RC00340 C     CHARLEN,@CF01591                                 03S0348 00179000
         BNE   @RF00348                                         03S0348 00180000
*                 EXITCODE=BADINPUT;/* THEN SET INVALID INPUT RETURN    00181000
*                                      CODE AND SUSPEND PROCESSING   */ 00182000
*                                                               03S0349 00183000
         LA    @08,28                                           03S0349 00184000
         ST    @08,EXITCODE                                     03S0349 00185000
*               /*****************************************************/ 00186000
*               /*                                                   */ 00187000
*               /* LOCATE VERB'S CONVERSION TABLE ENTRY              */ 00188000
*               /*                                                   */ 00189000
*               /*****************************************************/ 00190000
*                                                               03S0350 00191000
*               ELSE                                            03S0350 00192000
*                 DO;                                           03S0350 00193000
*                                                               03S0350 00194000
         B     @RC00348                                         03S0350 00195000
@RF00348 DS    0H                                               03S0351 00196000
*                   /*************************************************/ 00197000
*                   /*                                               */ 00198000
*                   /* LOCATE VERB'S TABLE ENTRY                     */ 00199000
*                   /*                                               */ 00200000
*                   /*************************************************/ 00201000
*                                                               03S0351 00202000
*                                                               04S0351 00203000
*                   /*************************************************/ 00204000
*                   /*                                               */ 00205000
*                   /* PROCESS.USSTRANS.USSVLOOK: THIS ROUTINE       */ 00206000
*                   /* SEARCHES THE CONVERSION TABLE FOR THE VERB    */ 00207000
*                   /* ENTRY FOR THIS VERB.                          */ 00208000
*                   /*                                               */ 00209000
*                   /*************************************************/ 00210000
*                                                               04S0351 00211000
*                   RFY                                         04S0351 00212000
*                     IEDUSSV BASED(TABLEPTR);                  04S0351 00213000
*                   TABLEPTR=PRMTABLE+1;/* INITIATE TABLE POINTER TO    00214000
*                                      FIRST VERB ENTRY IN CONVERSION   00215000
*                                      TABLE                         */ 00216000
         LA    TABLEPTR,1                                       04S0352 00217000
         AL    TABLEPTR,PRMTABLE(,PARM)                         04S0352 00218000
*                   USSVB=0;        /* CLEAR CURRENT VERB ENTRY 04S0353 00219000
*                                      POINTER                       */ 00220000
         SLR   @08,@08                                          04S0353 00221000
         ST    @08,USSVB                                        04S0353 00222000
*                   DO WHILE(TABLEPTR^=0);/* SEARCH FOR VERB ENTRY      00223000
*                                      UNTIL END OF TABLE REACHED.      00224000
*                                      TABLE ENTRY POINTER IS ZEROED    00225000
*                                      WHEN VERB FOUND OR IS ZERO       00226000
*                                      WHEN END OF TABLE.            */ 00227000
         B     @DE00354                                         04S0354 00228000
@DL00354 DS    0H                                               04S0355 00229000
*                     IF CHARLEN=USSVLEN&INDATA(FSTCHAR:FSTCHAR+CHARLEN 00230000
*                         -1)=USSVERB(1:CHARLEN) THEN           04S0355 00231000
         SLR   @08,@08                                          04S0355 00232000
         IC    @08,USSVLEN(,TABLEPTR)                           04S0355 00233000
         CR    CHARLEN,@08                                      04S0355 00234000
         BNE   @RF00355                                         04S0355 00235000
         LH    @08,FSTCHAR                                      04S0355 00236000
         LR    @05,CHARLEN                                      04S0355 00237000
         BCTR  @05,0                                            04S0355 00238000
         ALR   @08,INPTR                                        04S0355 00239000
         EX    @05,@SC01714                                     04S0355 00240000
         BNE   @RF00355                                         04S0355 00241000
*                       DO;                                     04S0356 00242000
*                                                               04S0356 00243000
*                         /*******************************************/ 00244000
*                         /*                                         */ 00245000
*                         /* IF THIS IS THE VERB ENTRY WE'RE LOOKING */ 00246000
*                         /* FOR, ... THEN ...                       */ 00247000
*                         /*                                         */ 00248000
*                         /*******************************************/ 00249000
*                                                               04S0357 00250000
*                         USSVB=TABLEPTR;/* SET VERB ENTRY BASE      */ 00251000
         ST    TABLEPTR,USSVB                                   04S0357 00252000
*                         TABLEPTR=0;/* CLEAR TABLE SCAN POINTER TO     00253000
*                                      BREAK DO WHILE LOOP           */ 00254000
         SLR   TABLEPTR,TABLEPTR                                04S0358 00255000
*                       END;                                    04S0359 00256000
*                     ELSE                                      04S0360 00257000
*                       TABLEPTR=USSVADDR;/* ELSE, SET POINTER TO       00258000
*                                      NEXT VERB ENTRY IN TABLE      */ 00259000
         B     @RC00355                                         04S0360 00260000
@RF00355 ICM   TABLEPTR,15,USSVADDR(TABLEPTR)                   04S0360 00261000
*                   END;            /* END OF TABLE SEARCH           */ 00262000
@RC00355 DS    0H                                               04S0361 00263000
@DE00354 SLR   @08,@08                                          04S0361 00264000
         CR    TABLEPTR,@08                                     04S0361 00265000
         BNE   @DL00354                                         04S0361 00266000
*                   RFY                                         04S0362 00267000
*                     IEDUSSV BASED(USSVB);                     04S0362 00268000
*                   IF USSVB=0 THEN /* IF TABLE ENTRY NOT FOUND, ... */ 00269000
         C     @08,USSVB                                        03S0363 00270000
         BNE   @RF00363                                         03S0363 00271000
*                     EXITCODE=BADVERB;/* THEN SET INVALID VERB 03S0364 00272000
*                                      RETURN CODE AND SUSPEND  03S0364 00273000
*                                      PROCESSING                    */ 00274000
         LA    @08,20                                           03S0364 00275000
         ST    @08,EXITCODE                                     03S0364 00276000
*                   ELSE                                        03S0365 00277000
*                     DO;           /* ELSE CONTINUE USS CONVERSION     00278000
*                                      PROCESS                       */ 00279000
*                                                               03S0365 00280000
         B     @RC00363                                         03S0365 00281000
@RF00363 DS    0H                                               03S0366 00282000
*                       /*********************************************/ 00283000
*                       /*                                           */ 00284000
*                       /* PLACE SNA COMMAND AND IDENTIFIER INTO     */ 00285000
*                       /* FORMATTED COMMAND                         */ 00286000
*                       /*                                           */ 00287000
*                       /*********************************************/ 00288000
*                                                               03S0366 00289000
*                       OUTDATA(1:LENGTH(USSVSSCP))=USSVSSCP;   03S0366 00290000
*                                                               03S0366 00291000
         L     @08,USSVB                                        03S0366 00292000
         MVC   OUTDATA(3,OUTPTR),USSVSSCP(@08)                  03S0366 00293000
*                       /*********************************************/ 00294000
*                       /*                                           */ 00295000
*                       /* SCAN FOR DATA DELIMITER AND MOVE USER DATA*/ 00296000
*                       /* TO OUTPUT AREA                            */ 00297000
*                       /*                                           */ 00298000
*                       /*********************************************/ 00299000
*                                                               03S0367 00300000
*                                                               04S0367 00301000
*                       /*********************************************/ 00302000
*                       /*                                           */ 00303000
*                       /* PROCESS.USSTRANS.USSDEL: SCAN FOR USER    */ 00304000
*                       /* DATA DELIMITER, IF THERE IS ONE, AND IF   */ 00305000
*                       /* FOUND MOVE USER DATA TO FORMATTED OUTPUT. */ 00306000
*                       /*                                           */ 00307000
*                       /*********************************************/ 00308000
*                                                               04S0367 00309000
*                       IF USSVDEL=0 THEN                       04S0367 00310000
         CLI   USSVDEL(@08),0                                   04S0367 00311000
         BE    @RT00367                                         04S0367 00312000
*                         ;         /* IF NO USER DATA DELIMITER        00313000
*                                      SPECIFIED, THEN NO FURTHER       00314000
*                                      ACTION                        */ 00315000
*                                                               04S0368 00316000
*                       /*********************************************/ 00317000
*                       /*                                           */ 00318000
*                       /* SEARCH FOR DELIMITER                      */ 00319000
*                       /*                                           */ 00320000
*                       /*********************************************/ 00321000
*                                                               04S0369 00322000
*                       ELSE                                    04S0369 00323000
*                         DO;       /* ELSE ...                      */ 00324000
*                           FOUND=NO;/* RESET FOUND SWITCH           */ 00325000
         NI    FOUND,B'01111111'                                04S0370 00326000
*                           DO DELINDEX=SCANPTR TO LASTIN-1 WHILE(FOUND 00327000
*                                 =NO);/* SEARCH INPUT UNTIL END OF     00328000
*                                      DATA REACHED OR DELIMITER        00329000
*                                      FOUND                         */ 00330000
         LR    DELINDEX,SCANPTR                                 04S0371 00331000
         B     @DE00371                                         04S0371 00332000
@DL00371 TM    FOUND,B'10000000'                                04S0371 00333000
         BNZ   @DC00371                                         04S0371 00334000
*                             IF INDATA(DELINDEX)=USSVDEL THEN/* IF     00335000
*                                      THIS IS THE DELIMITER, ...    */ 00336000
         LR    @08,INPTR                                        04S0372 00337000
         ALR   @08,DELINDEX                                     04S0372 00338000
         L     @05,USSVB                                        04S0372 00339000
         CLC   INDATA-1(1,@08),USSVDEL(@05)                     04S0372 00340000
         BNE   @RF00372                                         04S0372 00341000
*                               FOUND=YES;/* THEN INDICATE DELIMITER    00342000
*                                      FOUND                         */ 00343000
         OI    FOUND,B'10000000'                                04S0373 00344000
*                           END;    /* END OF DELIMITER SEARCH       */ 00345000
@RF00372 AL    DELINDEX,@CF00061                                04S0374 00346000
@DE00371 LR    @08,LASTIN                                       04S0374 00347000
         BCTR  @08,0                                            04S0374 00348000
         CR    DELINDEX,@08                                     04S0374 00349000
         BNH   @DL00371                                         04S0374 00350000
@DC00371 DS    0H                                               04S0375 00351000
*                           IF FOUND=NO THEN                    04S0375 00352000
         TM    FOUND,B'10000000'                                04S0375 00353000
         BZ    @RT00375                                         04S0375 00354000
*                             ;     /* IF DELIMITER NOT FOUND THEN NO   00355000
*                                      FURTHER ACTION                */ 00356000
*                                                               04S0376 00357000
*                           /*****************************************/ 00358000
*                           /*                                       */ 00359000
*                           /* IF USER DATA EXCEEDS MAXIMUM, ABORT   */ 00360000
*                           /*                                       */ 00361000
*                           /*****************************************/ 00362000
*                                                               04S0377 00363000
*                           ELSE                                04S0377 00364000
*                             DO;   /* ELSE CONTINUE PROCESSING      */ 00365000
*                               CHARLEN=LASTIN-DELINDEX;/* SAVE USER    00366000
*                                      DATA LENGTH                   */ 00367000
         LR    CHARLEN,LASTIN                                   04S0378 00368000
         SLR   CHARLEN,DELINDEX                                 04S0378 00369000
*                               IF CHARLEN>USSVDLEN THEN/* IF USER      00370000
*                                      DATA LENGTH EXCEEDS FORMATTED    00371000
*                                      FIELD WIDTH, ...              */ 00372000
         L     @08,USSVB                                        04S0379 00373000
         SLR   @05,@05                                          04S0379 00374000
         IC    @05,USSVDLEN(,@08)                               04S0379 00375000
         CR    CHARLEN,@05                                      04S0379 00376000
         BNH   @RF00379                                         04S0379 00377000
*                                 EXITCODE=TOOMUCH;/* THEN SET  04S0380 00378000
*                                      INVALID RETURN CODE AND  04S0380 00379000
*                                      SUSPEND PROCESSING            */ 00380000
*                                                               04S0380 00381000
         LA    @08,40                                           04S0380 00382000
         ST    @08,EXITCODE                                     04S0380 00383000
*                               /*************************************/ 00384000
*                               /*                                   */ 00385000
*                               /* ELSE PLACE USER DATA INTO         */ 00386000
*                               /* FORMATTED OUTPUT AREA             */ 00387000
*                               /*                                   */ 00388000
*                               /*************************************/ 00389000
*                                                               04S0381 00390000
*                               ELSE                            04S0381 00391000
*                                 DO;                           04S0381 00392000
         B     @RC00379                                         04S0381 00393000
@RF00379 DS    0H                                               04S0382 00394000
*                                   DO COUNTER=(USSVDISP+2) TO(USSVDISP 00395000
*                                        +1+USSVDLEN);/* LOOP UNTIL     00396000
*                                      OUTPUT AREA BLANKED           */ 00397000
         LA    @10,2                                            04S0382 00398000
         L     @08,USSVB                                        04S0382 00399000
         SLR   @05,@05                                          04S0382 00400000
         IC    @05,USSVDISP(,@08)                               04S0382 00401000
         ALR   @10,@05                                          04S0382 00402000
         B     @DE00382                                         04S0382 00403000
@DL00382 DS    0H                                               04S0383 00404000
*                                    OUTDATA(COUNTER)=' ';/* BLANK      00405000
*                                      CHARACTER                     */ 00406000
         ALR   @10,OUTPTR                                       04S0383 00407000
         MVI   OUTDATA-1(@10),C' '                              04S0383 00408000
*                                   END;/* END BLANKING LOOP         */ 00409000
*                                                               04S0384 00410000
         SLR   @08,@08                                          04S0384 00411000
         IC    @08,COUNTER                                      04S0384 00412000
         AL    @08,@CF00061                                     04S0384 00413000
         LR    @10,@08                                          04S0384 00414000
@DE00382 STC   @10,COUNTER                                      04S0384 00415000
         LA    @08,1                                            04S0384 00416000
         L     @05,USSVB                                        04S0384 00417000
         SLR   @15,@15                                          04S0384 00418000
         IC    @15,USSVDISP(,@05)                               04S0384 00419000
         ALR   @08,@15                                          04S0384 00420000
         L     @05,USSVB                                        04S0384 00421000
         SLR   @15,@15                                          04S0384 00422000
         IC    @15,USSVDLEN(,@05)                               04S0384 00423000
         ALR   @08,@15                                          04S0384 00424000
         CR    @10,@08                                          04S0384 00425000
         BNH   @DL00382                                         04S0384 00426000
*                                   /*********************************/ 00427000
*                                   /*                               */ 00428000
*                                   /* SET USER DATA LENGTH INTO     */ 00429000
*                                   /* OUTPUT AREA                   */ 00430000
*                                   /*                               */ 00431000
*                                   /*********************************/ 00432000
*                                                               04S0385 00433000
*                                   OUTDATA(USSVDISP+1)=USSVDLEN;       00434000
         L     @08,USSVB                                        04S0385 00435000
         SLR   @05,@05                                          04S0385 00436000
         IC    @05,USSVDISP(,@08)                               04S0385 00437000
         SLR   @15,@15                                          04S0385 00438000
         IC    @15,USSVDLEN(,@08)                               04S0385 00439000
         STC   @15,OUTDATA(@05,OUTPTR)                          04S0385 00440000
*                                   OUTDATA(USSVDISP+2:USSVDISP+CHARLEN 00441000
*                                       +1)=INDATA(DELINDEX+1:DELINDEX+ 00442000
*                                       CHARLEN);/* PLACE USER DATA     00443000
*                                      INTO FORMATTED OUTPUT AREA    */ 00444000
         ALR   @05,OUTPTR                                       04S0386 00445000
         LR    @08,CHARLEN                                      04S0386 00446000
         BCTR  @08,0                                            04S0386 00447000
         LR    @01,INPTR                                        04S0386 00448000
         ALR   @01,DELINDEX                                     04S0386 00449000
         EX    @08,@SM01717                                     04S0386 00450000
*                                   LASTOUT=USSVDISP+USSVDLEN+1;/*      00451000
*                                      SAVE OUTPUT HIGH WATER MARK   */ 00452000
         L     @08,USSVB                                        04S0387 00453000
         SLR   @05,@05                                          04S0387 00454000
         IC    @05,USSVDISP(,@08)                               04S0387 00455000
         ALR   @05,@15                                          04S0387 00456000
         LA    @05,1(,@05)                                      04S0387 00457000
         STH   @05,LASTOUT                                      04S0387 00458000
*                                   LASTIN=DELINDEX-2;/* RESET LAST     00459000
*                                      INPUT DATA LIMITING ADDRESS   */ 00460000
         LR    LASTIN,DELINDEX                                  04S0388 00461000
         BCTR  LASTIN,0                                         04S0388 00462000
         BCTR  LASTIN,0                                         04S0388 00463000
*                                 END;                          04S0389 00464000
*                             END;                              04S0390 00465000
@RC00379 DS    0H                                               04S0391 00466000
*                         END;                                  04S0391 00467000
@RT00375 DS    0H                                               04S0392 00468000
*                       IF EXITCODE=TRANSOK THEN                03S0392 00469000
@RT00367 L     @08,EXITCODE                                     03S0392 00470000
         LTR   @08,@08                                          03S0392 00471000
         BNZ   @RF00392                                         03S0392 00472000
*                         DO;       /* IF ERROR WAS NOT FOUND,  03S0393 00473000
*                                      CONTINUE PROCESSING           */ 00474000
*                                                               03S0393 00475000
*                           /*****************************************/ 00476000
*                           /*                                       */ 00477000
*                           /* PERFORM CONVERSION OF POSITIONAL      */ 00478000
*                           /* PARAMETERS AND KEYWORDS FOR THIS VERB */ 00479000
*                           /* AS SPECIFIED IN THE CONVERSION TABLE  */ 00480000
*                           /*                                       */ 00481000
*                           /*****************************************/ 00482000
*                                                               03S0394 00483000
*                                                               04S0394 00484000
*                           /*****************************************/ 00485000
*                           /*                                       */ 00486000
*                           /* PROCESS.USSTRANS.USSVERB: THIS SEGMENT*/ 00487000
*                           /* PERFORMS USS-FSS CONVERSION AS        */ 00488000
*                           /* SPECIFIED IN THE TABLE FOR THE VERB   */ 00489000
*                           /* ENTRY LOCATED EARLIER.                */ 00490000
*                           /*                                       */ 00491000
*                           /*****************************************/ 00492000
*                                                               04S0394 00493000
*                           USSPB=USSVB+LENGTH(IEDUSSV)+USSVLEN;/*      00494000
*                                      ADDRESS OF FIRST TABLE ENTRY     00495000
*                                      FOLLOWING THE VERB ENTRY      */ 00496000
*                                                               04S0394 00497000
         L     @08,USSVB                                        04S0394 00498000
         LA    USSPB,17                                         04S0394 00499000
         ALR   USSPB,@08                                        04S0394 00500000
         SLR   @02,@02                                          04S0394 00501000
         IC    @02,USSVLEN(,@08)                                04S0394 00502000
         ALR   USSPB,@02                                        04S0394 00503000
*                           /*****************************************/ 00504000
*                           /*                                       */ 00505000
*                           /* PROCESS THOSE COMMAND FIELDS HAVING NO*/ 00506000
*                           /* USER INPUT                            */ 00507000
*                           /*                                       */ 00508000
*                           /*****************************************/ 00509000
*                                                               04S0395 00510000
*                                                               05S0395 00511000
*                           /*****************************************/ 00512000
*                           /*                                       */ 00513000
*                           /* PROCESS.USSTRANS.USSVERB.USSNOINP:    */ 00514000
*                           /* THIS SEGMENT PLACES DATA INTO A SNA   */ 00515000
*                           /* FORMATTED COMMAND FIELD FOR WHICH NO  */ 00516000
*                           /* USER INPUT IS REQUIRED. THESE FIELDS  */ 00517000
*                           /* ARE REPRESENTED BY POSITIONAL         */ 00518000
*                           /* PARAMETER CONVERSION TABLE ENTRIES    */ 00519000
*                           /* WHICH ARE FLAGGED AS NO HAVEING USER  */ 00520000
*                           /* DATA INPUT THE USER'S INPUT SYNTAX IS */ 00521000
*                           /* NOT AFFECTED BY THESE ENTRIES, THEY   */ 00522000
*                           /* ARE TRANSPARENT TO THE USER.          */ 00523000
*                           /*                                       */ 00524000
*                           /*****************************************/ 00525000
*                                                               05S0395 00526000
*                           DO WHILE(USSPTYPE=USSFPOS&USSPNOIN=YES);    00527000
         B     @DE00395                                         05S0395 00528000
@DL00395 DS    0H                                               05S0396 00529000
*                                   /* LOOP UNTIL ALL NO INPUT  05S0396 00530000
*                                      ENTRIES PROCESSED             */ 00531000
*                             USSDB=USSPB+LENGTH(IEDUSSP);/* ADDRESS    00532000
*                                      OF VALUE ENTRY                */ 00533000
         LA    @08,6                                            05S0396 00534000
         ALR   @08,USSPB                                        05S0396 00535000
         ST    @08,USSDB                                        05S0396 00536000
*                             CALL USSMOVE;/* MOVE DATA SPECIFIED IN    00537000
*                                      VALUE ENTRY TO FIELD          */ 00538000
         BAL   @14,USSMOVE                                      05S0397 00539000
*                             USSPB=USSDB;/* UPDATE POSITIONAL  05S0398 00540000
*                                      POINTER                       */ 00541000
         L     USSPB,USSDB                                      05S0398 00542000
*                           END;                                05S0399 00543000
@DE00395 TM    USSPTYPE(USSPB),B'01000000'                      05S0399 00544000
         BNO   @DC00395                                         05S0399 00545000
         TM    USSPTYPE(USSPB),B'10100000'                      05S0399 00546000
         BNZ   @DC00395                                         05S0399 00547000
         TM    USSPNOIN(USSPB),B'00100000'                      05S0399 00548000
         BO    @DL00395                                         05S0399 00549000
@DC00395 DS    0H                                               05S0400 00550000
*                                                               04S0400 00551000
*                           /*****************************************/ 00552000
*                           /*                                       */ 00553000
*                           /* PROCESS POSITIONAL PARAMETERS(IF ANY) */ 00554000
*                           /*                                       */ 00555000
*                           /*****************************************/ 00556000
*                                                               04S0400 00557000
*                           CALL USSPARM;                       04S0400 00558000
*                                                               04S0400 00559000
         BAL   @14,USSPARM                                      04S0400 00560000
*                           /*****************************************/ 00561000
*                           /*                                       */ 00562000
*                           /* IF NO ERRORS THEN PROCESS KEYWORD     */ 00563000
*                           /* PARAMETERS (IF ANY)                   */ 00564000
*                           /*                                       */ 00565000
*                           /*****************************************/ 00566000
*                                                               04S0401 00567000
*                           IF EXITCODE^=TRANSOK THEN           04S0401 00568000
         L     @08,EXITCODE                                     04S0401 00569000
         LTR   @08,@08                                          04S0401 00570000
         BNZ   @RT00401                                         04S0401 00571000
*                             ;     /* IF AN ERROR OCCURRED IN  04S0402 00572000
*                                      PROCESSING POSITIONAL    04S0402 00573000
*                                      PARAMETERS, THEN NO FURTHER      00574000
*                                      PROCESSING                    */ 00575000
*                           ELSE                                04S0403 00576000
*                             DO;                               04S0403 00577000
*                                                               04S0403 00578000
*                               /*************************************/ 00579000
*                               /*                                   */ 00580000
*                               /* PROCESS KEYWORD PARAMETERS IF ANY */ 00581000
*                               /*                                   */ 00582000
*                               /*************************************/ 00583000
*                                                               04S0404 00584000
*                                                               05S0404 00585000
*                               /*************************************/ 00586000
*                               /*                                   */ 00587000
*                               /* PROCESS.USSTRANS.USSVERB.USSKEY:  */ 00588000
*                               /* THIS SEGMENT CONVERTS KEYWORD     */ 00589000
*                               /* ENTRIES FROM THE INPUT STREAM TO  */ 00590000
*                               /* FORMATTED OUTPUT FIELDS.          */ 00591000
*                               /* PROCESSING CONTINUES UNTIL NO MORE*/ 00592000
*                               /* KEYS EXIST OR AN ERROR OCCURS.    */ 00593000
*                               /*                                   */ 00594000
*                               /*************************************/ 00595000
*                                                               05S0404 00596000
*                               IF USSVKADD=0 THEN              05S0404 00597000
         L     @08,USSVB                                        05S0404 00598000
         ICM   @05,15,USSVKADD(@08)                             05S0404 00599000
         BZ    @RT00404                                         05S0404 00600000
*                                 ; /* IF THERE ARE NO KEYWORDS TO      00601000
*                                      PROCESS THEN NO FURTHER ACTION*/ 00602000
*                               ELSE                            05S0406 00603000
*                                 DO WHILE(SCANPTR<=LASTIN&EXITCODE=    00604000
*                                       TRANSOK);/* LOOP WHILE MORE     00605000
*                                      KEYWORDS TO CONVERT AND NO       00606000
*                                      ERRORS HAVE OCCURRED          */ 00607000
         B     @DE00406                                         05S0406 00608000
@DL00406 DS    0H                                               05S0407 00609000
*                                                               06S0407 00610000
*                                   /*********************************/ 00611000
*                                   /*                               */ 00612000
*                                   /* PROCESS.USSTRANS.USSVERB.USSKE*/ 00613000
*                                   /* Y.USSKSRCH: THIS SEGMENT      */ 00614000
*                                   /* DELIMITS A KEYWORD FROM THE   */ 00615000
*                                   /* INPUT CHARACTER STRING.       */ 00616000
*                                   /*                               */ 00617000
*                                   /*********************************/ 00618000
*                                                               06S0407 00619000
*                                   CHARLEN=0;/* RESET CHARACTER        00620000
*                                      LENGTH FOUND TO ZERO          */ 00621000
         SLR   CHARLEN,CHARLEN                                  06S0407 00622000
*                                   DO SCANPTR=SCANPTR+1 WHILE(INDATA(  00623000
*                                        SCANPTR)=' '&SCANPTR<=LASTIN); 00624000
         LA    @08,1                                            06S0408 00625000
         ALR   @08,SCANPTR                                      06S0408 00626000
         LR    SCANPTR,@08                                      06S0408 00627000
         LR    @08,INPTR                                        06S0408 00628000
         ALR   @08,SCANPTR                                      06S0408 00629000
         CLI   INDATA-1(@08),C' '                               06S0408 00630000
         BNE   @DC00408                                         06S0408 00631000
         CR    SCANPTR,LASTIN                                   06S0408 00632000
         BH    @DC00408                                         06S0408 00633000
*                                    /* LOOP UNTIL THE END OF THE       00634000
*                                      INPUT DATA OR A NON-BLANK        00635000
*                                      CHARACTER IS FOUND            */ 00636000
*                                   END;/* END OF SEARCH LOOP        */ 00637000
@DC00408 DS    0H                                               06S0410 00638000
*                                   FSTCHAR=SCANPTR;/* SAVE KEYWORD     00639000
*                                      INDEX                         */ 00640000
         STH   SCANPTR,FSTCHAR                                  06S0410 00641000
*                                   DO SCANPTR=SCANPTR BY 1 WHILE(      00642000
*                                        INDATA(SCANPTR)^=' '&INDATA(   00643000
*                                        SCANPTR)^='='&SCANPTR<=LASTIN) 00644000
*                                        ;/* LOOP UNTIL A BLANK, =,     00645000
*                                      OR END OF INPUT DATA IS  06S0411 00646000
*                                      ENCOUNTERED                   */ 00647000
         B     @DE00411                                         06S0411 00648000
@DL00411 DS    0H                                               06S0412 00649000
*                                   END;/* END OF KEYWORD SEARCH LOOP*/ 00650000
         AL    SCANPTR,@CF00061                                 06S0412 00651000
@DE00411 LR    @08,INPTR                                        06S0412 00652000
         ALR   @08,SCANPTR                                      06S0412 00653000
         CLI   INDATA-1(@08),C' '                               06S0412 00654000
         BE    @DC00411                                         06S0412 00655000
         LR    @08,INPTR                                        06S0412 00656000
         ALR   @08,SCANPTR                                      06S0412 00657000
         CLI   INDATA-1(@08),C'='                               06S0412 00658000
         BE    @DC00411                                         06S0412 00659000
         CR    SCANPTR,LASTIN                                   06S0412 00660000
         BNH   @DL00411                                         06S0412 00661000
@DC00411 DS    0H                                               06S0413 00662000
*                                   CHARLEN=SCANPTR-FSTCHAR;/*  06S0413 00663000
*                                      CALCULATE FIELD LENGTH        */ 00664000
         LR    CHARLEN,SCANPTR                                  06S0413 00665000
         SH    CHARLEN,FSTCHAR                                  06S0413 00666000
*                                   DO SCANPTR=SCANPTR BY 1 WHILE(      00667000
*                                        INDATA(SCANPTR)^='='&SCANPTR<= 00668000
*                                        LASTIN&EXITCODE=TRANSOK);/*    00669000
*                                      SCAN TO THE EQUALS SIGN       */ 00670000
         B     @DE00414                                         06S0414 00671000
@DL00414 DS    0H                                               06S0415 00672000
*                                    IF INDATA(SCANPTR)^=' ' THEN       00673000
         LR    @08,INPTR                                        06S0415 00674000
         ALR   @08,SCANPTR                                      06S0415 00675000
         CLI   INDATA-1(@08),C' '                               06S0415 00676000
         BE    @RF00415                                         06S0415 00677000
*                                     EXITCODE=BADINPUT;/* IF   06S0416 00678000
*                                      NON-BLANK OR NON-EQUAL SIGN IS   00679000
*                                      FOUND, SET BAD RETURN CODE    */ 00680000
         LA    @08,28                                           06S0416 00681000
         ST    @08,EXITCODE                                     06S0416 00682000
*                                    ELSE                       06S0417 00683000
*                                     ;                         06S0417 00684000
@RF00415 DS    0H                                               06S0418 00685000
*                                   END;                        06S0418 00686000
         AL    SCANPTR,@CF00061                                 06S0418 00687000
@DE00414 LR    @08,INPTR                                        06S0418 00688000
         ALR   @08,SCANPTR                                      06S0418 00689000
         CLI   INDATA-1(@08),C'='                               06S0418 00690000
         BE    @DC00414                                         06S0418 00691000
         CR    SCANPTR,LASTIN                                   06S0418 00692000
         BH    @DC00414                                         06S0418 00693000
         L     @08,EXITCODE                                     06S0418 00694000
         LTR   @08,@08                                          06S0418 00695000
         BZ    @DL00414                                         06S0418 00696000
@DC00414 DS    0H                                               06S0419 00697000
*                                   /* DELIMIT A KEYWORD FROM THE       00698000
*                                      INPUT STREAM                  */ 00699000
*                                   IF CHARLEN=0|EXITCODE^=TRANSOK THEN 00700000
         C     CHARLEN,@CF01591                                 05S0419 00701000
         BE    @RT00419                                         05S0419 00702000
         L     @08,EXITCODE                                     05S0419 00703000
         LTR   @08,@08                                          05S0419 00704000
         BNZ   @RT00419                                         05S0419 00705000
*                                    ;/* IF NO MORE KEYWORDS TO 05S0420 00706000
*                                      PROCESS OR BAD RETURN CODE       00707000
*                                      THEN NO FURTHER PROCESSING    */ 00708000
*                                   ELSE                        05S0421 00709000
*                                    DO;/* ELSE PROCESS KEYWORD      */ 00710000
*                                                               05S0421 00711000
*                                     /*******************************/ 00712000
*                                     /*                             */ 00713000
*                                     /* FETCH KEYWORD'S TABLE ENTRY.*/ 00714000
*                                     /* IF NOT FOUND, ABORT. SEARCH */ 00715000
*                                     /* TABLE FOR KEYWORD           */ 00716000
*                                     /*                             */ 00717000
*                                     /*******************************/ 00718000
*                                                               05S0422 00719000
*                                                               06S0422 00720000
*                                     /*******************************/ 00721000
*                                     /*                             */ 00722000
*                                     /* PROCESS.USSTRANS.USSVERB.USS*/ 00723000
*                                     /* KEY.USSKLOOK: THIS SEGMENT  */ 00724000
*                                     /* LOCATES THE CURRENT         */ 00725000
*                                     /* KEYWORD'S CONVERSION TABLE  */ 00726000
*                                     /* ENTRY.                      */ 00727000
*                                     /*                             */ 00728000
*                                     /*******************************/ 00729000
*                                                               06S0422 00730000
*                                     TABLEPTR=USSVKADD;/* FIRST        00731000
*                                      KEYWORD ENTRY FOR THIS VERB   */ 00732000
         L     @08,USSVB                                        06S0422 00733000
         ICM   TABLEPTR,15,USSVKADD(@08)                        06S0422 00734000
*                                     USSKB=0;/* RESET KEYWORD  06S0423 00735000
*                                      POINTER TO INDICATE NOT FOUND */ 00736000
         SLR   @08,@08                                          06S0423 00737000
         ST    @08,USSKB                                        06S0423 00738000
*                                     DO WHILE(TABLEPTR^=0&USSKB=0);    00739000
         B     @DE00424                                         06S0424 00740000
@DL00424 DS    0H                                               06S0425 00741000
*                                      /* LOOP UNTIL ENTRY FOUND OR     00742000
*                                      NO MORE ENTRIES FOR THIS VERB */ 00743000
*                                      IF CHARLEN=USSKLEN THEN/*        00744000
*                                      LENGTHS MUST BE EQUAL         */ 00745000
         L     @08,USSKB                                        06S0425 00746000
         SLR   @05,@05                                          06S0425 00747000
         IC    @05,USSKLEN(,@08)                                06S0425 00748000
         CR    CHARLEN,@05                                      06S0425 00749000
         BNE   @RF00425                                         06S0425 00750000
*                                       IF INDATA(FSTCHAR:FSTCHAR-1+    00751000
*                                           CHARLEN)=TABLEPTR->USSKEY(1 00752000
*                                           :CHARLEN) THEN/* IF THIS    00753000
*                                      IS THE KEYWORD WE'RE LOOKING     00754000
*                                      FOR, ...                      */ 00755000
         LH    @08,FSTCHAR                                      06S0426 00756000
         LR    @05,CHARLEN                                      06S0426 00757000
         BCTR  @05,0                                            06S0426 00758000
         ALR   @08,INPTR                                        06S0426 00759000
         EX    @05,@SC01719                                     06S0426 00760000
         BNE   @RF00426                                         06S0426 00761000
*                                        USSKB=TABLEPTR;/* SET  06S0427 00762000
*                                      KEYWORD ENTRY BASE TO BREAK      00763000
*                                      LOOP                          */ 00764000
         ST    TABLEPTR,USSKB                                   06S0427 00765000
*                                      TABLEPTR=TABLEPTR->USSKADDR;/*   00766000
*                                      ADVANCE TO NEXT KEYWORD  06S0428 00767000
*                                      POINTER                       */ 00768000
@RF00426 DS    0H                                               06S0428 00769000
@RF00425 ICM   TABLEPTR,15,USSKADDR(TABLEPTR)                   06S0428 00770000
*                                     END;/* END OF KEYWORD ENTRY       00771000
*                                      SEARCH                        */ 00772000
@DE00424 SLR   @08,@08                                          06S0429 00773000
         CR    TABLEPTR,@08                                     06S0429 00774000
         BE    @DC00424                                         06S0429 00775000
         C     @08,USSKB                                        06S0429 00776000
         BE    @DL00424                                         06S0429 00777000
@DC00424 DS    0H                                               06S0430 00778000
*                                     IF USSKB=0 THEN/* IF KEYWORD      00779000
*                                      NOT IN TABLE, ...             */ 00780000
         L     @08,USSKB                                        05S0430 00781000
         LTR   @08,@08                                          05S0430 00782000
         BNZ   @RF00430                                         05S0430 00783000
*                                      EXITCODE=BADKEY;/* SET INVALID   00784000
*                                      KEYWORD RETURN CODE           */ 00785000
*                                                               05S0431 00786000
         LA    @08,24                                           05S0431 00787000
         ST    @08,EXITCODE                                     05S0431 00788000
*                                     /*******************************/ 00789000
*                                     /*                             */ 00790000
*                                     /* CONVERT KEYWORD VALUE(S)    */ 00791000
*                                     /*                             */ 00792000
*                                     /*******************************/ 00793000
*                                                               05S0432 00794000
*                                     ELSE                      05S0432 00795000
*                                      DO;/* ELSE CONTINUE PROCESSING*/ 00796000
         B     @RC00430                                         05S0432 00797000
@RF00430 DS    0H                                               05S0433 00798000
*                                       KEYWORD=YES;/* INDICATE 05S0433 00799000
*                                      KEYWORD BEING PROCESSED TO       00800000
*                                      PARAMETER PROCESSING ROUTINE,    00801000
*                                      USSPARM                       */ 00802000
         OI    KEYWORD,B'10000000'                              05S0433 00803000
*                                       USSPB=USSKB+(ADDR(USSKEY)-ADDR( 00804000
*                                           IEDUSSK))+USSKLEN;/* SET    00805000
*                                      POINTER TO FIRST POSITIONAL      00806000
*                                      PARAMETER ENTRY FOLLOWING        00807000
*                                      KEYWORD TABLE ENTRY           */ 00808000
         L     @08,USSKB                                        05S0434 00809000
         LA    USSPB,6                                          05S0434 00810000
         ALR   USSPB,@08                                        05S0434 00811000
         SLR   @02,@02                                          05S0434 00812000
         IC    @02,USSKLEN(,@08)                                05S0434 00813000
         ALR   USSPB,@02                                        05S0434 00814000
*                                       CALL USSPARM;/* PROCESS 05S0435 00815000
*                                      KEYWORD VALUES                */ 00816000
         BAL   @14,USSPARM                                      05S0435 00817000
*                                       IF PAREN=YES THEN/* IF SYNTAX   00818000
*                                      ERROR OCCURRED(UNBALANCED        00819000
*                                      PARENTHESES )                 */ 00820000
         TM    PAREN,B'10000000'                                05S0436 00821000
         BNO   @RF00436                                         05S0436 00822000
*                                        EXITCODE=BADINPUT;/* THEN      00823000
*                                      SET RETURN CODE FOR INVALID      00824000
*                                      INPUT                         */ 00825000
         LA    @08,28                                           05S0437 00826000
         ST    @08,EXITCODE                                     05S0437 00827000
*                                       ELSE                    05S0438 00828000
*                                        DO;/* ELSE CONTINUE         */ 00829000
         B     @RC00436                                         05S0438 00830000
@RF00436 DS    0H                                               05S0439 00831000
*                                         KEYWORD=NO;/* RESET KEYWORD   00832000
*                                      CONVERSION INDICATOR          */ 00833000
         NI    KEYWORD,B'01111111'                              05S0439 00834000
*                                         USSKFMT=YES;/* INDICATE       00835000
*                                      KEYWORD WAS PROCESSED         */ 00836000
         L     @08,USSKB                                        05S0440 00837000
         OI    USSKFMT(@08),B'00010000'                         05S0440 00838000
*                                        END;                   05S0441 00839000
*                                      END;                     05S0442 00840000
@RC00436 DS    0H                                               05S0443 00841000
*                                    END;                       05S0443 00842000
@RC00430 DS    0H                                               05S0444 00843000
*                                 END;/* END OF KEYWORD CONVERSION      00844000
*                                      LOOP                          */ 00845000
@RT00419 DS    0H                                               05S0444 00846000
@DE00406 CR    SCANPTR,LASTIN                                   05S0444 00847000
         BH    @DC00406                                         05S0444 00848000
         L     @08,EXITCODE                                     05S0444 00849000
         LTR   @08,@08                                          05S0444 00850000
         BZ    @DL00406                                         05S0444 00851000
@DC00406 DS    0H                                               05S0445 00852000
*                                                               04S0445 00853000
*                               /*************************************/ 00854000
*                               /*                                   */ 00855000
*                               /* SET DEFAULT VALUES INTO OUTPUT    */ 00856000
*                               /* PLACE REQUIRED DEFAULT VALUES INTO*/ 00857000
*                               /* ANY FIELDS WHICH REQUIRE THEM     */ 00858000
*                               /*                                   */ 00859000
*                               /*************************************/ 00860000
*                                                               04S0445 00861000
*                                                               05S0445 00862000
*                               /*************************************/ 00863000
*                               /*                                   */ 00864000
*                               /* PROCESS.USSTRANS.USSVERB.USSKDEF: */ 00865000
*                               /* THIS SEGMENT PLACES DEFAULT VALUES*/ 00866000
*                               /* FOR THOSE KEYWORDS NOT ENTERED BY */ 00867000
*                               /* THE USER INTO THE FORMATTED OUTPUT*/ 00868000
*                               /* COMMAND.                          */ 00869000
*                               /*                                   */ 00870000
*                               /*************************************/ 00871000
*                                                               05S0445 00872000
*                               USSKB=USSVKADD;/* FIRST KEYWORD ENTRY*/ 00873000
@RT00404 L     @10,USSVB                                        05S0445 00874000
         MVC   USSKB(4),USSVKADD(@10)                           05S0445 00875000
*                               DO WHILE(USSKB^=0);/* LOOP THROUGH      00876000
*                                      KEYWORD ENTRIES FOR THIS VERB    00877000
*                                      UNTIL ALL ARE PROCESSED       */ 00878000
         B     @DE00446                                         05S0446 00879000
@DL00446 DS    0H                                               05S0447 00880000
*                                 IF USSKFMT=YES|EXITCODE^=TRANSOK THEN 00881000
         L     @10,USSKB                                        05S0447 00882000
         TM    USSKFMT(@10),B'00010000'                         05S0447 00883000
         BO    @RT00447                                         05S0447 00884000
         L     @10,EXITCODE                                     05S0447 00885000
         LTR   @10,@10                                          05S0447 00886000
         BZ    @RF00447                                         05S0447 00887000
@RT00447 DS    0H                                               05S0448 00888000
*                                   /* RESET USSKFMT IF SET OR IF       00889000
*                                      ERROR HAS OCCURRED            */ 00890000
*                                   USSKFMT=NO;/* THEN RESET FLAG    */ 00891000
         L     @10,USSKB                                        05S0448 00892000
         NI    USSKFMT(@10),B'11101111'                         05S0448 00893000
*                                 ELSE                          05S0449 00894000
*                                   DO;/* ELSE PROCESS KEYWORD ENTRY    00895000
*                                      FOR DEFAULT                   */ 00896000
         B     @RC00447                                         05S0449 00897000
@RF00447 DS    0H                                               05S0450 00898000
*                                    USSPB=USSKB+(ADDR(USSKEY)-ADDR(    00899000
*                                        IEDUSSK))+USSKLEN;/* SET       00900000
*                                      POINTER TO FIRST PARAMETER       00901000
*                                      ENTRY FOR THIS KEYWORD        */ 00902000
         L     @10,USSKB                                        05S0450 00903000
         LA    USSPB,6                                          05S0450 00904000
         ALR   USSPB,@10                                        05S0450 00905000
         SLR   @08,@08                                          05S0450 00906000
         IC    @08,USSKLEN(,@10)                                05S0450 00907000
         ALR   USSPB,@08                                        05S0450 00908000
*                                    DO WHILE(USSPTYPE=USSFPOS&EXITCODE 00909000
*                                         =TRANSOK);/* LOOP UNTIL ALL   00910000
*                                      PARAMETERS FOR THIS KEYWORD      00911000
*                                      ARE PROCESSED                 */ 00912000
         B     @DE00451                                         05S0451 00913000
@DL00451 DS    0H                                               05S0452 00914000
*                                     USSDB=USSPB+LENGTH(IEDUSSP);/*    00915000
*                                      SET POINTER TO FIRST VALUE       00916000
*                                      ENTRY FOR THIS PARAMETER      */ 00917000
         LA    @10,6                                            05S0452 00918000
         ALR   @10,USSPB                                        05S0452 00919000
         ST    @10,USSDB                                        05S0452 00920000
*                                     CALL USSDEF;/* PLACE DEFAULT      00921000
*                                      VALUE(IF ANY) INTO COMMAND       00922000
*                                      FIELD                         */ 00923000
         BAL   @14,USSDEF                                       05S0453 00924000
*                                    END;                       05S0454 00925000
@DE00451 TM    USSPTYPE(USSPB),B'01000000'                      05S0454 00926000
         BNO   @DC00451                                         05S0454 00927000
         TM    USSPTYPE(USSPB),B'10100000'                      05S0454 00928000
         BNZ   @DC00451                                         05S0454 00929000
         L     @10,EXITCODE                                     05S0454 00930000
         LTR   @10,@10                                          05S0454 00931000
         BZ    @DL00451                                         05S0454 00932000
@DC00451 DS    0H                                               05S0455 00933000
*                                    USSPB=USSDB;/* UPDATE PARAMETER    00934000
*                                      ENTRY POINTER                 */ 00935000
         L     USSPB,USSDB                                      05S0455 00936000
*                                   END;                        05S0456 00937000
*                                 USSKB=USSKADDR;/* NEXT KEYWORD        00938000
*                                      ENTRY ADDRESS                 */ 00939000
@RC00447 L     @10,USSKB                                        05S0457 00940000
         ICM   @08,15,USSKADDR(@10)                             05S0457 00941000
         ST    @08,USSKB                                        05S0457 00942000
*                               END;/* END OF KEYWORD ENTRY LOOP     */ 00943000
@DE00446 L     @10,USSKB                                        05S0458 00944000
         LTR   @10,@10                                          05S0458 00945000
         BNZ   @DL00446                                         05S0458 00946000
*                             END;                              04S0459 00947000
*                                                               03S0460 00948000
*                           /*****************************************/ 00949000
*                           /*                                       */ 00950000
*                           /* IF CONVERSION OK THEN INDICATE RU IS  */ 00951000
*                           /* FORMATTED                             */ 00952000
*                           /*                                       */ 00953000
*                           /*****************************************/ 00954000
*                                                               03S0460 00955000
*                           IF EXITCODE=TRANSOK THEN/* CONVERSION WAS   00956000
*                                      SUCCESSFUL, ...               */ 00957000
@RT00401 L     @10,EXITCODE                                     03S0460 00958000
         LTR   @10,@10                                          03S0460 00959000
         BNZ   @RF00460                                         03S0460 00960000
*                             DO;   /* THEN                          */ 00961000
*                               TRHFI=FSS;/* INDICATE RU IS FORMATTED   00962000
*                                      IN THE RH                     */ 00963000
*                                                               03S0462 00964000
         L     @10,IEDQPPTR                                     03S0462 00965000
         SL    @10,@CF00046                                     03S0462 00966000
         OI    TRHFI(@10),B'00001000'                           03S0462 00967000
*                               /*************************************/ 00968000
*                               /*                                   */ 00969000
*                               /* UPDATE OUTPUT DATA LENGTH TO      */ 00970000
*                               /* REFLECT RU LENGTH                 */ 00971000
*                               /*                                   */ 00972000
*                               /*************************************/ 00973000
*                                                               03S0463 00974000
*                               PRF1USS=ON;/* INDICATE THE BUFFER WAS   00975000
*                                      UNFORMATED            @YM06087*/ 00976000
         OI    PRF1USS(@10),B'00001000'                         03S0463 00977000
*                               OUTDATLN=LASTOUT+USSVADD;/* PI06031  */ 00978000
         L     @10,USSVB                                        03S0464 00979000
         SLR   @08,@08                                          03S0464 00980000
         IC    @08,USSVADD(,@10)                                03S0464 00981000
         AH    @08,LASTOUT                                      03S0464 00982000
         STH   @08,OUTDATLN(,OUTPTR)                            03S0464 00983000
*                             END;                              03S0465 00984000
*                         END;                                  03S0466 00985000
*                     END;                                      03S0467 00986000
*                 END;                                          03S0468 00987000
*             END;                                              03S0469 00988000
*         END;                                                  03S0470 00989000
*     END;                                                      02S0471 00990000
*   ELSE                                                        02S0472 00991000
*     DO;                                                       02S0472 00992000
*                                                               02S0472 00993000
         B     @RC00329                                         02S0472 00994000
@RF00329 DS    0H                                               02S0473 00995000
*       /*************************************************************/ 00996000
*       /*                                                           */ 00997000
*       /* ELSE PERFORM FSS TO USS CONVERSION                        */ 00998000
*       /*                                                           */ 00999000
*       /*************************************************************/ 01000000
*                                                               02S0473 01001000
*                                                               03S0473 01002000
*       /*************************************************************/ 01003000
*       /*                                                           */ 01004000
*       /* PROCESS.FSSTRANS: THIS SEGMENT REPRESENTS THE TOTAL FSS TO*/ 01005000
*       /* USS CONVERSION PROCESS. IF THE INPUT RU IS NOT FORMATTED, */ 01006000
*       /* OR IF THE OUTPUT SIDE OF THE MH IS NOT BEING EXECUTED, OR */ 01007000
*       /* IF THE RU IS NOT AN NS PROC ERROR , AN ERROR RETURN CODE  */ 01008000
*       /* IS SET AND NO CONVERSION TAKES PLACE.                     */ 01009000
*       /*                                                           */ 01010000
*       /*************************************************************/ 01011000
*                                                               03S0473 01012000
*       IF TRHFI^=FSS THEN          /* IF THIS IS NOT A FORMATTED       01013000
*                                      BUFFER THEN ...               */ 01014000
         L     @10,IEDQPPTR                                     03S0473 01015000
         AL    @10,@CF01713                                     03S0473 01016000
         TM    TRHFI(@10),B'00001000'                           03S0473 01017000
         BO    @RF00473                                         03S0473 01018000
*         EXITCODE=BADRU;           /* SET INVALID RU TYPE RETURN       01019000
*                                      CODE                          */ 01020000
         LA    @08,52                                           03S0474 01021000
         ST    @08,EXITCODE                                     03S0474 01022000
*       ELSE                                                    03S0475 01023000
*         IF LCBSENDN=NO THEN       /* IF OUTPUT SIDE OF MH IS NOT      01024000
*                                      BEING EXECUTED                */ 01025000
         B     @RC00473                                         03S0475 01026000
@RF00473 TM    LCBSENDN(RLCB),B'00000001'                       03S0475 01027000
         BNZ   @RF00475                                         03S0475 01028000
*           EXITCODE=BADTABLE;      /* SET INVALID CONVERSION TABLE     01029000
*                                      RETURN CODE                   */ 01030000
         LA    @08,32                                           03S0476 01031000
         ST    @08,EXITCODE                                     03S0476 01032000
*         ELSE                                                  03S0477 01033000
*           IF INDATA(1:3)^=CD1XNSP THEN/* IF NOT AN NS PROC ERROR      01034000
*                                      ...                           */ 01035000
         B     @RC00475                                         03S0477 01036000
@RF00475 CLC   INDATA(3,INPTR),@CB00744                         03S0477 01037000
         BE    @RF00477                                         03S0477 01038000
*             EXITCODE=BADRU;       /* THEN INDICATE INVALID RU      */ 01039000
*                                                               03S0478 01040000
         LA    @08,52                                           03S0478 01041000
         ST    @08,EXITCODE                                     03S0478 01042000
*       /*************************************************************/ 01043000
*       /*                                                           */ 01044000
*       /* LOCATE THE REPLACEMENT MESSAGE IN THE FSS-USS TABLE AND   */ 01045000
*       /* MOVE IT INTO THE OUTPUT BUFFER. IF SCS OR 3270 FORMAT     */ 01046000
*       /* CHARACTERS REQUIRED PLACE THEM IN THE OUTPUT AREA.        */ 01047000
*       /*                                                           */ 01048000
*       /*************************************************************/ 01049000
*                                                               03S0479 01050000
*           ELSE                                                03S0479 01051000
*             IF USSFLAG^=FSSTYPE THEN                          03S0479 01052000
         B     @RC00477                                         03S0479 01053000
@RF00477 L     @10,PRMTABLE(,PARM)                              03S0479 01054000
         CLI   USSFLAG(@10),X'F2'                               03S0479 01055000
         BE    @RF00479                                         03S0479 01056000
*               EXITCODE=BADTABLE;                              03S0480 01057000
*                                                               03S0480 01058000
         LA    @08,32                                           03S0480 01059000
         ST    @08,EXITCODE                                     03S0480 01060000
*       /*************************************************************/ 01061000
*       /*                                                           */ 01062000
*       /* INSURE THAT CORRECT TABLE HAS BEEN LINKEDITED             */ 01063000
*       /*                                                           */ 01064000
*       /*************************************************************/ 01065000
*                                                               03S0481 01066000
*             ELSE                                              03S0481 01067000
*               DO;                                             03S0481 01068000
         B     @RC00479                                         03S0481 01069000
@RF00479 DS    0H                                               03S0482 01070000
*                 FSTCHAR=1;        /* POINTER TO FIRST OUTPUT  03S0482 01071000
*                                      LOCATION                      */ 01072000
         LA    @10,1                                            03S0482 01073000
         STH   @10,FSTCHAR                                      03S0482 01074000
*                 FOUND=NO;         /* RESET MESSAGE FOUND INDICATOR */ 01075000
         NI    FOUND,B'01111111'                                03S0483 01076000
*                 FSSB=PRMTABLE+1;  /* FIRST FSS-USS CONVERSION TABLE   01077000
*                                      ENTRY                         */ 01078000
         AL    @10,PRMTABLE(,PARM)                              03S0484 01079000
         LR    FSSB,@10                                         03S0484 01080000
*                 DO WHILE(FSSB^=0&FOUND=NO);/* LOOP UNTIL END OF       01081000
*                                      TABLE REACHED OR THE MESSAGE     01082000
*                                      TO REPLACE THE NS PROC ERROR     01083000
*                                      IS FOUND                      */ 01084000
         B     @DE00485                                         03S0485 01085000
@DL00485 DS    0H                                               03S0486 01086000
*                   IF XNSPRSN=FSSMSGID THEN/* IF THIS IS THE MESSAGE   01087000
*                                      WE ARE AFTER ...              */ 01088000
         CLC   XNSPRSN+6(1,INPTR),FSSMSGID(FSSB)                03S0486 01089000
         BNE   @RF00486                                         03S0486 01090000
*                     DO;           /* THEN ...                      */ 01091000
*                       RFY                                     03S0488 01092000
*                         R1 RSTD;                              03S0488 01093000
*                       R1=PRFDEST; /* TNT INDEX OF NS PROC     03S0489 01094000
*                                      DESTINATION                   */ 01095000
         L     @10,IEDQPPTR                                     03S0489 01096000
         LH    R1,PRFDEST(,@10)                                 03S0489 01097000
*                       CALL IEDQTNT;/* CONVERT INDEX TO TERMINAL       01098000
*                                      ENTRY ADDRESS                 */ 01099000
         L     @15,AVTRNMPT(,RAVT)                              03S0490 01100000
         BALR  @14,@15                                          03S0490 01101000
*                       IEDQTPTR=R1;/* SET TERMINAL ENTRY BASE       */ 01102000
         LR    IEDQTPTR,R1                                      03S0491 01103000
*                       RFY                                     03S0492 01104000
*                         R1 UNRSTD;                            03S0492 01105000
*                       DCTPTR=AVTCSTCS+((TRMCHCIN-1)*AVTDCTLN);/*      01106000
*                                      DCT ENTRY BASE                */ 01107000
         SLR   @01,@01                                          03S0493 01108000
         IC    @01,TRMCHCIN(,IEDQTPTR)                          03S0493 01109000
         BCTR  @01,0                                            03S0493 01110000
         MH    @01,AVTDCTLN(,RAVT)                              03S0493 01111000
         AL    @01,AVTCSTCS(,RAVT)                              03S0493 01112000
         LR    DCTPTR,@01                                       03S0493 01113000
*                       IF DCTSCS=YES THEN/* IF SCS FORMAT CHARACTERS   01114000
*                                      INDICATED...                  */ 01115000
         TM    DCTSCS(DCTPTR),B'10000000'                       03S0494 01116000
         BNO   @RF00494                                         03S0494 01117000
*                         DO;       /* THEN ...                      */ 01118000
*                           OUTDATA(FSTCHAR)=NL;/* PLACE NEW LINE       01119000
*                                      CHARACTER AT FRONT OF MESSAGE */ 01120000
         LH    @10,FSTCHAR                                      03S0496 01121000
         ALR   @10,OUTPTR                                       03S0496 01122000
         MVI   OUTDATA-1(@10),X'15'                             03S0496 01123000
*                           FSTCHAR=FSTCHAR+1;/* ADVANCE 1ST MESSAGE    01124000
*                                      BYTE INDEX                    */ 01125000
         LH    @10,FSTCHAR                                      03S0497 01126000
         LA    @10,1(,@10)                                      03S0497 01127000
         STH   @10,FSTCHAR                                      03S0497 01128000
*                         END;                                  03S0498 01129000
*                       ELSE                                    03S0499 01130000
*                         IF DCTL3270=YES THEN/* ELSE IF 3270   03S0499 01131000
*                                      FORMATTING...                 */ 01132000
         B     @RC00494                                         03S0499 01133000
@RF00494 TM    DCTL3270(DCTPTR),B'01000000'                     03S0499 01134000
         BNO   @RF00499                                         03S0499 01135000
*                           DO;     /* THEN ...                      */ 01136000
*                             OUTDATA(FSTCHAR)=WDC;/* SET WRITE TO      01137000
*                                      CURSOR COMMAND                */ 01138000
         LH    @10,FSTCHAR                                      03S0501 01139000
         ALR   @10,OUTPTR                                       03S0501 01140000
         MVI   OUTDATA-1(@10),X'F1'                             03S0501 01141000
*                             OUTDATA(FSTCHAR+1)=WCC;/* SET WRITE       01142000
*                                      CONTOLR CHARS         @YM08162*/ 01143000
         LH    @10,FSTCHAR                                      03S0502 01144000
         ALR   @10,OUTPTR                                       03S0502 01145000
         MVI   OUTDATA(@10),X'C3'                               03S0502 01146000
*                             FSTCHAR=FSTCHAR+2;/* ADVANCE FIRST        01147000
*                                      MESSAGE CHARACTER INDEX  03S0503 01148000
*                                                            @YM08162*/ 01149000
         LH    @10,FSTCHAR                                      03S0503 01150000
         LA    @10,2(,@10)                                      03S0503 01151000
         STH   @10,FSTCHAR                                      03S0503 01152000
*                           END;                                03S0504 01153000
*                       OUTDATA(FSTCHAR:FSTCHAR-1+FSSLEN)=FSSMSG(1:     01154000
*                           FSSLEN);/* MOVE MESSAGE TO BUFFER        */ 01155000
@RF00499 DS    0H                                               03S0505 01156000
@RC00494 LH    @10,FSTCHAR                                      03S0505 01157000
         ALR   @10,OUTPTR                                       03S0505 01158000
         LH    @08,FSTCHAR                                      03S0505 01159000
         LR    @07,@08                                          03S0505 01160000
         BCTR  @07,0                                            03S0505 01161000
         SLR   @02,@02                                          03S0505 01162000
         IC    @02,FSSLEN(,FSSB)                                03S0505 01163000
         ALR   @07,@02                                          03S0505 01164000
         SLR   @07,@08                                          03S0505 01165000
         EX    @07,@SM01724                                     03S0505 01166000
*                       IF DCTL3270=YES THEN/* IF 3270 FORMATTING       01167000
*                                      USED ...                      */ 01168000
         TM    DCTL3270(DCTPTR),B'01000000'                     03S0506 01169000
         BNO   @RF00506                                         03S0506 01170000
*                         DO;       /* THEN ...                      */ 01171000
*                           OUTDATA(FSTCHAR+FSSLEN)=IC;/* SET INSERT    01172000
*                                      CURSOR AT END OF MESSAGE      */ 01173000
         ALR   @02,@08                                          03S0508 01174000
         ALR   @02,OUTPTR                                       03S0508 01175000
         MVI   OUTDATA-1(@02),X'13'                             03S0508 01176000
*                           FSTCHAR=FSTCHAR+1;/* INCREMENT EXTRA        01177000
*                                      CHARACTER COUNT               */ 01178000
         LA    @08,1(,@08)                                      03S0509 01179000
         STH   @08,FSTCHAR                                      03S0509 01180000
*                         END;                                  03S0510 01181000
*                       OUTDATLN=FSTCHAR-1+FSSLEN;/* INDICATE MESSAGE   01182000
*                                      LENGTH IN OUTPUT              */ 01183000
@RF00506 LH    @10,FSTCHAR                                      03S0511 01184000
         BCTR  @10,0                                            03S0511 01185000
         SLR   @08,@08                                          03S0511 01186000
         IC    @08,FSSLEN(,FSSB)                                03S0511 01187000
         ALR   @10,@08                                          03S0511 01188000
         STH   @10,OUTDATLN(,OUTPTR)                            03S0511 01189000
*                       FOUND=YES;  /* INDICATE MESSAGE FOUND TO        01190000
*                                      BREAK LOOP                    */ 01191000
         OI    FOUND,B'10000000'                                03S0512 01192000
*                     END;                                      03S0513 01193000
*                   ELSE                                        03S0514 01194000
*                     FSSB=FSSADDR; /* NEXT MESSAGE ENTRY            */ 01195000
         B     @RC00486                                         03S0514 01196000
@RF00486 ICM   FSSB,15,FSSADDR(FSSB)                            03S0514 01197000
*                 END;              /* END OF MESSAGE SEARCH LOOP    */ 01198000
@RC00486 DS    0H                                               03S0515 01199000
@DE00485 LTR   FSSB,FSSB                                        03S0515 01200000
         BZ    @DC00485                                         03S0515 01201000
         TM    FOUND,B'10000000'                                03S0515 01202000
         BZ    @DL00485                                         03S0515 01203000
@DC00485 DS    0H                                               03S0516 01204000
*                 IF FOUND=NO THEN  /* IF MESSAGE NOT FOUND SET 03S0516 01205000
*                                      INVALID NS PROC RETURN CODE   */ 01206000
         TM    FOUND,B'10000000'                                03S0516 01207000
         BNZ   @RF00516                                         03S0516 01208000
*                   EXITCODE=BADPROC;/* INVALID NS PROC RETURN CODE  */ 01209000
         LA    @08,48                                           03S0517 01210000
         ST    @08,EXITCODE                                     03S0517 01211000
*                 ELSE                                          03S0518 01212000
*                   TRHFI=USS;      /* ELSE INDICATE MESSAGE IS 03S0518 01213000
*                                      UNFORMATTED IN RH             */ 01214000
         B     @RC00516                                         03S0518 01215000
@RF00516 L     @08,IEDQPPTR                                     03S0518 01216000
         AL    @08,@CF01713                                     03S0518 01217000
         NI    TRHFI(@08),B'11110111'                           03S0518 01218000
*               END;                                            03S0519 01219000
@RC00516 DS    0H                                               03S0520 01220000
*     END;                                                      02S0520 01221000
@RC00479 DS    0H                                               02S0520 01222000
@RC00477 DS    0H                                               02S0520 01223000
@RC00475 DS    0H                                               02S0520 01224000
@RC00473 DS    0H                                               02S0521 01225000
*   RFY                                                         02S0521 01226000
*     RCODE RSTD;                                               02S0521 01227000
@RC00329 DS    0H                                               02S0522 01228000
*   RCODE=EXITCODE;                 /* SET RETURN CODE               */ 01229000
         L     RCODE,EXITCODE                                   02S0522 01230000
*   R12=AVTUI+4;                    /* IEDQUI'S RETURN ADDRESS       */ 01231000
         LA    R12,4                                            02S0523 01232000
         AL    R12,AVTUI(,RAVT)                                 02S0523 01233000
*   GEN(         BR    R12  );      /* RETURN TO IEDQUI              */ 01234000
                  BR    R12                                             01235000
*                                                               02S0525 01236000
*   /*****************************************************************/ 01237000
*   /*                                                               */ 01238000
*   /* USSDEF: THIS SEGMENT INITIATES A DEFAULT VALUE FOR THE CURRENT*/ 01239000
*   /* COMMAND OUTPUT FIELD IF SPECIFIED IN A VALUE ENTRY. IF ENTRY  */ 01240000
*   /* REQUIRES USER INPUT A MISSING PARAMETER RETURN CODE IS SET AND*/ 01241000
*   /* PROCESSING TERMINATES.                                        */ 01242000
*   /*                                                               */ 01243000
*   /*****************************************************************/ 01244000
*                                                               02S0525 01245000
*USSDEF:                                                        02S0525 01246000
*   PROCEDURE OPTIONS(RETREG,SAVE(R14));                        02S0525 01247000
@EL00001 DS    0H                                               02S0525 01248000
@EF00001 DS    0H                                               02S0525 01249000
@ER00001 BR    @14                                              02S0525 01250000
USSDEF   ST    @14,@SA00002                                     02S0525 01251000
*   DO WHILE(USSDTYPE=USSFVAL);     /* LOOP THROUGH VALUE ENTRIES       01252000
*                                      LOOKING FOR THIS FIELD LOOKING   01253000
*                                      FOR A DEFAULT VALUE           */ 01254000
         B     @DE00526                                         02S0526 01255000
@DL00526 DS    0H                                               02S0527 01256000
*     IF USSDVLEN=0&USSDRLEN^=0 THEN/* IF THIS IS A DEFAULT VALUE       01257000
*                                      ENTRY ...                     */ 01258000
         L     @14,USSDB                                        02S0527 01259000
         CLI   USSDVLEN(@14),0                                  02S0527 01260000
         BNE   @RF00527                                         02S0527 01261000
         CLI   USSDRLEN(@14),0                                  02S0527 01262000
         BE    @RF00527                                         02S0527 01263000
*       CALL USSMOVE;               /* MOVE DEFAULT VALUE TO OUTPUT     01264000
*                                      FIELD. THE VALUE POINTER IS      01265000
*                                      SET TO THE NEXT PARAMETER        01266000
*                                      ENTRY BY USSMOVE.             */ 01267000
         BAL   @14,USSMOVE                                      02S0528 01268000
*     ELSE                                                      02S0529 01269000
*       USSDB=USSDB+ADDR(USSDVAL)-ADDR(IEDUSSD)+USSDVLEN+USSDRLEN;/*    01270000
*                                      ADDRESS OF NEXT VALUE ENTRY   */ 01271000
         B     @RC00527                                         02S0529 01272000
@RF00527 L     @14,USSDB                                        02S0529 01273000
         LA    @08,USSDVAL(,@14)                                02S0529 01274000
         ALR   @08,@14                                          02S0529 01275000
         SLR   @08,@14                                          02S0529 01276000
         SLR   @02,@02                                          02S0529 01277000
         IC    @02,USSDVLEN(,@14)                               02S0529 01278000
         ALR   @08,@02                                          02S0529 01279000
         SLR   @02,@02                                          02S0529 01280000
         IC    @02,USSDRLEN(,@14)                               02S0529 01281000
         ALR   @08,@02                                          02S0529 01282000
         ST    @08,USSDB                                        02S0529 01283000
*   END;                            /* END VALUE ENTRY LOOP          */ 01284000
@RC00527 DS    0H                                               02S0530 01285000
@DE00526 L     @14,USSDB                                        02S0530 01286000
         TM    USSDTYPE(@14),B'10000000'                        02S0530 01287000
         BNO   @DC00526                                         02S0530 01288000
         TM    USSDTYPE(@14),B'01100000'                        02S0530 01289000
         BZ    @DL00526                                         02S0530 01290000
@DC00526 DS    0H                                               02S0531 01291000
*   IF USSPREQ=YES&MOVED=NO THEN    /* IF USER INPUT REQUIRED TO THE    01292000
*                                      CURRENT PARAMETER AND NONE       01293000
*                                      MOVED ...                     */ 01294000
         TM    USSPREQ(USSPB),B'01000000'                       02S0531 01295000
         BNO   @RF00531                                         02S0531 01296000
         TM    MOVED,B'10000000'                                02S0531 01297000
         BNZ   @RF00531                                         02S0531 01298000
*     EXITCODE=MISSPARM;            /* THEN SET PARAMETER NOT CODED     01299000
*                                      RETURN CODE                   */ 01300000
         LA    @14,36                                           02S0532 01301000
         ST    @14,EXITCODE                                     02S0532 01302000
*   USSPB=USSDB;                    /* SET POINTER TO NEXT PARAMETER    01303000
*                                      ENTRY                         */ 01304000
@RF00531 L     USSPB,USSDB                                      02S0533 01305000
*   END;                            /* END OF USSDEF PROCEDURE       */ 01306000
@EL00002 DS    0H                                               02S0534 01307000
@EF00002 DS    0H                                               02S0534 01308000
@ER00002 L     @14,@SA00002                                     02S0534 01309000
         BR    @14                                              02S0534 01310000
*                                                               02S0535 01311000
*   /*****************************************************************/ 01312000
*   /*                                                               */ 01313000
*   /* USSEOD: THIS SEGMENT SCANS UNTIL A COMMA, RIGHT PARENTHESIS OR*/ 01314000
*   /* END OF INPUT IS REACHED.                                      */ 01315000
*   /*                                                               */ 01316000
*   /*****************************************************************/ 01317000
*                                                               02S0535 01318000
*USSEOD:                                                        02S0535 01319000
*   PROCEDURE OPTIONS(RETREG,SAVE(R14));                        02S0535 01320000
USSEOD   ST    @14,12(,@13)                                     02S0535 01321000
*   DO SCANPTR=SCANPTR BY 1 WHILE(INDATA(SCANPTR)^=','&SCANPTR<=LASTIN) 01322000
*         ;                         /* LOOP UNTIL A COMMA ENCOUNTERED   01323000
*                                      OR END OF INPUT               */ 01324000
         B     @DE00536                                         02S0536 01325000
@DL00536 DS    0H                                               02S0537 01326000
*     IF INDATA(SCANPTR)=' ' THEN                               02S0537 01327000
         LR    @14,INPTR                                        02S0537 01328000
         ALR   @14,SCANPTR                                      02S0537 01329000
         CLI   INDATA-1(@14),C' '                               02S0537 01330000
         BE    @RT00537                                         02S0537 01331000
*       ;                           /* IF THIS CHARACTER IS A BLANK     01332000
*                                      THEN KEEP SCANNING            */ 01333000
*     ELSE                                                      02S0539 01334000
*       IF INDATA(SCANPTR)=')'&PAREN=YES THEN/* IF ) AND IF (   02S0539 01335000
*                                      PROCESSED PREVIOUSLY ...      */ 01336000
         LR    @14,INPTR                                        02S0539 01337000
         ALR   @14,SCANPTR                                      02S0539 01338000
         CLI   INDATA-1(@14),C')'                               02S0539 01339000
         BNE   @RF00539                                         02S0539 01340000
         TM    PAREN,B'10000000'                                02S0539 01341000
         BNO   @RF00539                                         02S0539 01342000
*         PAREN=NO;                 /* THEN RESET PARENTHETICAL FLAG */ 01343000
         NI    PAREN,B'01111111'                                02S0540 01344000
*       ELSE                                                    02S0541 01345000
*         EXITCODE=BADINPUT;        /* ELSE SET INVALID INPUT RETURN    01346000
*                                      CODE                          */ 01347000
         B     @RC00539                                         02S0541 01348000
@RF00539 LA    @14,28                                           02S0541 01349000
         ST    @14,EXITCODE                                     02S0541 01350000
*   END;                            /* END OF DELIMITER SCAN         */ 01351000
@RC00539 DS    0H                                               02S0542 01352000
@RT00537 AL    SCANPTR,@CF00061                                 02S0542 01353000
@DE00536 LR    @14,INPTR                                        02S0542 01354000
         ALR   @14,SCANPTR                                      02S0542 01355000
         CLI   INDATA-1(@14),C','                               02S0542 01356000
         BE    @DC00536                                         02S0542 01357000
         CR    SCANPTR,LASTIN                                   02S0542 01358000
         BNH   @DL00536                                         02S0542 01359000
@DC00536 DS    0H                                               02S0543 01360000
*   END;                            /* END OF PROCEDURE              */ 01361000
@EL00003 DS    0H                                               02S0543 01362000
@EF00003 DS    0H                                               02S0543 01363000
@ER00003 L     @14,12(,@13)                                     02S0543 01364000
         BR    @14                                              02S0543 01365000
*                                                               02S0544 01366000
*   /*****************************************************************/ 01367000
*   /*                                                               */ 01368000
*   /* USSMOVE: THIS SEGMENT MOVES A POSITIONAL PARAMETER OR KEYWORD */ 01369000
*   /* VALUE INTO THE FORMATTED OUTPUT AREA.                         */ 01370000
*   /*                                                               */ 01371000
*   /*****************************************************************/ 01372000
*                                                               02S0544 01373000
*USSMOVE:                                                       02S0544 01374000
*   PROCEDURE OPTIONS(RETREG,SAVE(R14));                        02S0544 01375000
USSMOVE  ST    @14,12(,@13)                                     02S0544 01376000
*   MOVED=NO;                       /* RESET DATA MOVED INDICATOR    */ 01377000
         NI    MOVED,B'01111111'                                02S0545 01378000
*   MOVEOUT=USSPBYTE+1;             /* DISPLACEMENT INTO OUTPUT AREA    01379000
*                                      OF COMMAND FIELD              */ 01380000
*                                                               02S0546 01381000
         SLR   @14,@14                                          02S0546 01382000
         IC    @14,USSPBYTE(,USSPB)                             02S0546 01383000
         LA    @14,1(,@14)                                      02S0546 01384000
         LR    MOVEOUT,@14                                      02S0546 01385000
*   /*****************************************************************/ 01386000
*   /*                                                               */ 01387000
*   /* IF ENCODED BIT FIELD OR DATA INTO OUTPUT AREA                 */ 01388000
*   /*                                                               */ 01389000
*   /*****************************************************************/ 01390000
*                                                               02S0547 01391000
*   IF USSPDATA=USSPBIN&USSPBIT^=0 THEN/* IF THIS IS AN ENCODED BIT     01392000
*                                      FIELD(IS NOT ON A BYTE   02S0547 01393000
*                                      BOUNDARY AND LESS THAN OR        01394000
*                                      EQUAL TO ONE BYTE)            */ 01395000
         TM    USSPDATA(USSPB),B'00000010'                      02S0547 01396000
         BNO   @RF00547                                         02S0547 01397000
         TM    USSPDATA(USSPB),B'00001101'                      02S0547 01398000
         BNZ   @RF00547                                         02S0547 01399000
         CLI   USSPBIT(USSPB),0                                 02S0547 01400000
         BE    @RF00547                                         02S0547 01401000
*     DO;                           /* THEN SET UP ENCODED BIT FIELD */ 01402000
*       WKAREA=0;                   /* CLEAR WORK AREA               */ 01403000
         SLR   @14,@14                                          02S0549 01404000
         STCM  @14,3,WKAREA                                     02S0549 01405000
*       WKAREA1=USSDREP(USSDVLEN+1);/* PLACE REPLACEMENT VALUE INTO     01406000
*                                      THE WORK AREA                 */ 01407000
         L     @14,USSDB                                        02S0550 01408000
         SLR   @02,@02                                          02S0550 01409000
         IC    @02,USSDVLEN(,@14)                               02S0550 01410000
         ALR   @14,@02                                          02S0550 01411000
         MVC   WKAREA1(1),USSDREP(@14)                          02S0550 01412000
*       SHIFT=16-USSPLEN-USSPBIT;   /* SHIFT COUNT = 16 - FIELD BIT     01413000
*                                      WIDTH - FIELD BIT DISPLACEMENT   01414000
*                                      IN SINGLE BYTE                */ 01415000
         LA    @14,16                                           02S0551 01416000
         SLR   @02,@02                                          02S0551 01417000
         ICM   @02,3,USSPLEN(USSPB)                             02S0551 01418000
         SLR   @14,@02                                          02S0551 01419000
         SLR   @02,@02                                          02S0551 01420000
         IC    @02,USSPBIT(,USSPB)                              02S0551 01421000
         SLR   @14,@02                                          02S0551 01422000
         STC   @14,SHIFT                                        02S0551 01423000
*       SLL(WKAREA,SHIFT);          /* SHIFT REPLACEMENT VALUE TO       01424000
*                                      PROPER FIELD BIT DISPLACEMENT    01425000
*                                      IN LEFT MOST BYTE             */ 01426000
         SLR   @02,@02                                          02S0552 01427000
         ICM   @02,3,WKAREA                                     02S0552 01428000
         SLL   @02,0(@14)                                       02S0552 01429000
         STCM  @02,3,WKAREA                                     02S0552 01430000
*       OUTDATA(MOVEOUT:MOVEOUT+1)=OUTDATA(MOVEOUT:MOVEOUT+1)|WKAREAC(1 01431000
*           :2);                    /* PLACE BIT ENCODED FIELD INTO     01432000
*                                      FSS OUTPUT BUFFER             */ 01433000
         LR    @14,OUTPTR                                       02S0553 01434000
         ALR   @14,MOVEOUT                                      02S0553 01435000
         OC    OUTDATA-1(2,@14),WKAREAC                         02S0553 01436000
*     END;                          /* END ENCODED BIT FIELD    02S0554 01437000
*                                      PROCESSING                    */ 01438000
*                                                               02S0554 01439000
*   /*****************************************************************/ 01440000
*   /*                                                               */ 01441000
*   /* ELSE MOVE FIELD OF INTEGRAL # BYTES INTO OUTPUT AREA          */ 01442000
*   /*                                                               */ 01443000
*   /*****************************************************************/ 01444000
*                                                               02S0555 01445000
*   ELSE                                                        02S0555 01446000
*     DO;                           /* ELSE FIELD IS INTEGRAL # OF      01447000
*                                      BYTES ...                     */ 01448000
         B     @RC00547                                         02S0555 01449000
@RF00547 DS    0H                                               02S0556 01450000
*       MOVEEND=USSDRLEN+MOVEOUT-1; /* DISPLACEMENT OF END OF   02S0556 01451000
*                                      RECEIVING FIELD               */ 01452000
         L     @14,USSDB                                        02S0556 01453000
         SLR   @02,@02                                          02S0556 01454000
         IC    @02,USSDRLEN(,@14)                               02S0556 01455000
         LR    @14,MOVEOUT                                      02S0556 01456000
         ALR   @14,@02                                          02S0556 01457000
         BCTR  @14,0                                            02S0556 01458000
         STC   @14,MOVEEND                                      02S0556 01459000
*       CHARLEN=USSDRLEN;           /* REPLACEMENT VALUE LENGTH      */ 01460000
         LR    CHARLEN,@02                                      02S0557 01461000
*       IF USSPINS=YES THEN         /* IF LENGTH BYTE REQUIRED AT       01462000
*                                      BEGINNING OF FIELD, ...       */ 01463000
         TM    USSPINS(USSPB),B'00010000'                       02S0558 01464000
         BNO   @RF00558                                         02S0558 01465000
*         DO;                       /* THEN ...                      */ 01466000
*                                                               02S0559 01467000
*           /*********************************************************/ 01468000
*           /*                                                       */ 01469000
*           /* PLACE LENGTH INTO FIELD                               */ 01470000
*           /*                                                       */ 01471000
*           /*********************************************************/ 01472000
*                                                               02S0560 01473000
*           OUTDATA(MOVEOUT)=((USSPLEN+7)/8);/* PI06031              */ 01474000
         LA    @00,7                                            02S0560 01475000
         SLR   @02,@02                                          02S0560 01476000
         ICM   @02,3,USSPLEN(USSPB)                             02S0560 01477000
         ALR   @00,@02                                          02S0560 01478000
         SRDA  @00,32                                           02S0560 01479000
         D     @00,@CF00046                                     02S0560 01480000
         STC   @01,OUTDATA-1(MOVEOUT,OUTPTR)                    02S0560 01481000
*           MOVEOUT=MOVEOUT+1;      /* INCREMENT MOVE TO STARTING       01482000
*                                      ADDRESS                       */ 01483000
         LA    @02,1                                            02S0561 01484000
         ALR   MOVEOUT,@02                                      02S0561 01485000
*           MOVEEND=MOVEEND+1;      /* INCREMENT END OF MOVE ADDRESS */ 01486000
         ALR   @14,@02                                          02S0562 01487000
         STC   @14,MOVEEND                                      02S0562 01488000
*         END;                      /* END OF LENGTH PLACEMENT DO    */ 01489000
*       IF USSPDATA=USSPCHAR THEN   /* IF OUTPUT FIELD IS CHARACTER     01490000
*                                      DATA, ...                     */ 01491000
@RF00558 TM    USSPDATA(USSPB),B'00000001'                      02S0564 01492000
         BNO   @RF00564                                         02S0564 01493000
         TM    USSPDATA(USSPB),B'00001110'                      02S0564 01494000
         BNZ   @RF00564                                         02S0564 01495000
*         DO COUNTER=MOVEOUT TO(((USSPLEN)/8)+MOVEOUT-1);/* THEN LOOP   01496000
*                                      UNTIL RECEIVING AREA BLANKED  */ 01497000
         LR    @14,MOVEOUT                                      02S0565 01498000
         B     @DE00565                                         02S0565 01499000
@DL00565 DS    0H                                               02S0566 01500000
*           OUTDATA(COUNTER)=' ';   /* BLANK CHARACTER               */ 01501000
         ALR   @14,OUTPTR                                       02S0566 01502000
         MVI   OUTDATA-1(@14),C' '                              02S0566 01503000
*         END;                      /* END OF BLANKING LOOP          */ 01504000
         SLR   @02,@02                                          02S0567 01505000
         IC    @02,COUNTER                                      02S0567 01506000
         AL    @02,@CF00061                                     02S0567 01507000
         LR    @14,@02                                          02S0567 01508000
@DE00565 STC   @14,COUNTER                                      02S0567 01509000
         SLR   @02,@02                                          02S0567 01510000
         ICM   @02,3,USSPLEN(USSPB)                             02S0567 01511000
         SRL   @02,3                                            02S0567 01512000
         ALR   @02,MOVEOUT                                      02S0567 01513000
         BCTR  @02,0                                            02S0567 01514000
         CR    @14,@02                                          02S0567 01515000
         BNH   @DL00565                                         02S0567 01516000
*       OUTDATA(MOVEOUT:MOVEEND)=USSDREP(USSDVLEN+1:USSDVLEN+USSDRLEN); 01517000
@RF00564 LR    @14,OUTPTR                                       02S0568 01518000
         ALR   @14,MOVEOUT                                      02S0568 01519000
         SLR   @02,@02                                          02S0568 01520000
         IC    @02,MOVEEND                                      02S0568 01521000
         SLR   @02,MOVEOUT                                      02S0568 01522000
         L     @01,USSDB                                        02S0568 01523000
         ST    @14,@TF00001                                     02S0568 01524000
         SLR   @14,@14                                          02S0568 01525000
         IC    @14,USSDVLEN(,@01)                               02S0568 01526000
         ST    @14,@TF00002                                     02S0568 01527000
         L     @14,@TF00001                                     02S0568 01528000
         AL    @01,@TF00002                                     02S0568 01529000
         EX    @02,@SM01727                                     02S0568 01530000
*                                   /* MOVE REPLACEMENT DATA TO 02S0569 01531000
*                                      RECEIVING FIELD               */ 01532000
*     END;                          /* END BYTE LENGTH FIELD MOVE    */ 01533000
*                                                               02S0569 01534000
*   /*****************************************************************/ 01535000
*   /*                                                               */ 01536000
*   /* BYPASS REMAINING VALUE ENTRIES FOR THIS PARAMETER             */ 01537000
*   /*                                                               */ 01538000
*   /*****************************************************************/ 01539000
*                                                               02S0570 01540000
*   IF SAVEDB^=0 THEN                                           02S0570 01541000
@RC00547 L     @14,SAVEDB                                       02S0570 01542000
         LTR   @14,@14                                          02S0570 01543000
         BZ    @RF00570                                         02S0570 01544000
*     USSDB=SAVEDB;                 /* IF USING DUMMY, MUST     02S0571 01545000
*                                      RESTABLISH VALUE ENTRY POINTER*/ 01546000
         ST    @14,USSDB                                        02S0571 01547000
*   DO WHILE(USSDTYPE=USSFVAL);     /* LOOP UNTIL ALL VALUE ENTRIES     01548000
*                                      HAVE BEEN BYPASSED FOR THE       01549000
*                                      CURRENT POSITIONAL PARAMETER  */ 01550000
@RF00570 B     @DE00572                                         02S0572 01551000
@DL00572 DS    0H                                               02S0573 01552000
*     USSDB=USSDB+(ADDR(USSDVAL)-ADDR(IEDUSSD))+USSDVLEN+USSDRLEN;/*    01553000
*                                      CALCULATE THE ADDRESS OF THE     01554000
*                                      NEXT VALUE ENTRY              */ 01555000
         L     @14,USSDB                                        02S0573 01556000
         LA    @02,3                                            02S0573 01557000
         ALR   @02,@14                                          02S0573 01558000
         SLR   @01,@01                                          02S0573 01559000
         IC    @01,USSDVLEN(,@14)                               02S0573 01560000
         ALR   @02,@01                                          02S0573 01561000
         SLR   @01,@01                                          02S0573 01562000
         IC    @01,USSDRLEN(,@14)                               02S0573 01563000
         ALR   @02,@01                                          02S0573 01564000
         ST    @02,USSDB                                        02S0573 01565000
*   END;                                                        02S0574 01566000
@DE00572 L     @14,USSDB                                        02S0574 01567000
         TM    USSDTYPE(@14),B'10000000'                        02S0574 01568000
         BNO   @DC00572                                         02S0574 01569000
         TM    USSDTYPE(@14),B'01100000'                        02S0574 01570000
         BZ    @DL00572                                         02S0574 01571000
@DC00572 DS    0H                                               02S0575 01572000
*   MOVED=YES;                      /* SET DATA MOVED INDICATOR      */ 01573000
*                                                               02S0575 01574000
         OI    MOVED,B'10000000'                                02S0575 01575000
*   /*****************************************************************/ 01576000
*   /*                                                               */ 01577000
*   /* SET NEW OUTPUT HIGH WATER MARK IF FIELD DISPLACEMENT EXCEEDS  */ 01578000
*   /* HIGHEST TO DATE                                               */ 01579000
*   /*                                                               */ 01580000
*   /*****************************************************************/ 01581000
*                                                               02S0576 01582000
*   WORK=((USSPLEN+USSPBIT+7)/8);                               02S0576 01583000
         SLR   @00,@00                                          02S0576 01584000
         ICM   @00,3,USSPLEN(USSPB)                             02S0576 01585000
         SLR   @14,@14                                          02S0576 01586000
         IC    @14,USSPBIT(,USSPB)                              02S0576 01587000
         ALR   @00,@14                                          02S0576 01588000
         AL    @00,@CF00569                                     02S0576 01589000
         SRDA  @00,32                                           02S0576 01590000
         D     @00,@CF00046                                     02S0576 01591000
         ST    @01,WORK                                         02S0576 01592000
*   WORK=WORK+MOVEOUT-1;            /*                       @YM06100*/ 01593000
         ALR   @01,MOVEOUT                                      02S0577 01594000
         BCTR  @01,0                                            02S0577 01595000
         ST    @01,WORK                                         02S0577 01596000
*   IF LASTOUT<WORK THEN                                        02S0578 01597000
*                                                               02S0578 01598000
         CH    @01,LASTOUT                                      02S0578 01599000
         BNH   @RF00578                                         02S0578 01600000
*/* IF CURRENT FIELD                                            02S0579 01601000
* END ADDRESS HIGHER THAN PREVIOUSLY HIGH OUTPUT DISPLACEMENT, ...   */ 01602000
*                                                               02S0579 01603000
*     LASTOUT=WORK;                 /* SET NEW HIGH WATER MARK       */ 01604000
         STH   @01,LASTOUT                                      02S0579 01605000
*   END;                            /* END OF USSMOVE                */ 01606000
@EL00004 DS    0H                                               02S0580 01607000
@EF00004 DS    0H                                               02S0580 01608000
@ER00004 L     @14,12(,@13)                                     02S0580 01609000
         BR    @14                                              02S0580 01610000
*                                                               02S0581 01611000
*   /*****************************************************************/ 01612000
*   /*                                                               */ 01613000
*   /* USSPARM: THIS SEGMENT PROCESSES POSITIONAL PARAMETERS. THIS IS*/ 01614000
*   /* DONE FOR INITIAL POSITIONAL PARAMETERS IN THE INPUT STREAM    */ 01615000
*   /* IMMEDIATELY FOLLOWING THE VERB. CONTROL IS ALSO RECEIVED WHEN */ 01616000
*   /* KEYWORDS ARE BEING PROCESSED. A KEYWORD VALUE IS CONSIDERED TO*/ 01617000
*   /* BE A SINGLE POSITIONAL PARAMETER FROM THE VIEWPOINT OF THIS   */ 01618000
*   /* ROUTINE. KEYWORDS ARE ALSO PROCESSED WHICH ARE EQUATED TO ONE */ 01619000
*   /* OR MORE POSITIONAL PARAMETERS ENCLOSED IN PARENTHESES.        */ 01620000
*   /*                                                               */ 01621000
*   /*****************************************************************/ 01622000
*                                                               02S0581 01623000
*USSPARM:                                                       02S0581 01624000
*   PROCEDURE OPTIONS(RETREG,SAVE(R14));                        02S0581 01625000
USSPARM  ST    @14,@SA00005                                     02S0581 01626000
*   DO WHILE(USSPTYPE=USSFPOS&EXITCODE=TRANSOK);/* PROCESS POSITIONAL   01627000
*                                      PARAMETERS UNTIL ALL     02S0582 01628000
*                                      POSITIONAL PARAMETERS ARE        01629000
*                                      PROCESSED OR AN ERROR OCCURS.    01630000
*                                      POSITIONAL PARMS ARE PROCESSED   01631000
*                                      UNTIL A KEYWORD ENTRY, VERB      01632000
*                                      ENTRY OR END OF TABLE IS 02S0582 01633000
*                                      ENCOUNTERED.                  */ 01634000
         B     @DE00582                                         02S0582 01635000
@DL00582 DS    0H                                               02S0583 01636000
*     USSDB=USSPB+LENGTH(IEDUSSP);  /* ADDRESS OF FIRST VALUE ENTRY     01637000
*                                      IN TABLE FOLLOWING THIS  02S0583 01638000
*                                      POSITIONAL ENTRY              */ 01639000
         LA    @14,6                                            02S0583 01640000
         ALR   @14,USSPB                                        02S0583 01641000
         ST    @14,USSDB                                        02S0583 01642000
*     MOVED=NO;                     /* RESET DATA MOVED INDICATOR    */ 01643000
*                                                               02S0584 01644000
         NI    MOVED,B'01111111'                                02S0584 01645000
*     /***************************************************************/ 01646000
*     /*                                                             */ 01647000
*     /* DELIMIT PARAMETER VALUE FROM INPUT STREAM. ESTABLISH DEFAULT*/ 01648000
*     /* IF NO DATA FOUND AND NOT A KEYWORD VALUE.                   */ 01649000
*     /*                                                             */ 01650000
*     /***************************************************************/ 01651000
*                                                               02S0585 01652000
*                                                               03S0585 01653000
*     /***************************************************************/ 01654000
*     /*                                                             */ 01655000
*     /* USSPARM.USSEARCH: THIS SEGMENT DELIMITS KEYWORD OR          */ 01656000
*     /* POSITIONAL PARAMETER INPUT DATA.                            */ 01657000
*     /*                                                             */ 01658000
*     /***************************************************************/ 01659000
*                                                               03S0585 01660000
*     IMBEDDED=NO;                  /* RESET DATA FOUND FLAG - USED     01661000
*                                      TO DIAGNOSE IMBEDDED SYNTAX      01662000
*                                      CHARACTERS                    */ 01663000
         NI    IMBEDDED,B'01111111'                             03S0585 01664000
*     CHARLEN=0;                    /* RESET CHARACTER COUNT         */ 01665000
         SLR   CHARLEN,CHARLEN                                  03S0586 01666000
*     DO SCANPTR=SCANPTR+1 BY 1 WHILE(INDATA(SCANPTR)=' '&SCANPTR<=     01667000
*           LASTIN);                /* LOOP UNTIL A NON BLANK   03S0587 01668000
*                                      CHARACTER IS FOUND OR END OF     01669000
*                                      INPUT OCCURS                  */ 01670000
         LA    @14,1                                            03S0587 01671000
         ALR   @14,SCANPTR                                      03S0587 01672000
         LR    SCANPTR,@14                                      03S0587 01673000
         B     @DE00587                                         03S0587 01674000
@DL00587 DS    0H                                               03S0588 01675000
*     END;                          /* END OF LOOP                   */ 01676000
         AL    SCANPTR,@CF00061                                 03S0588 01677000
@DE00587 LR    @14,INPTR                                        03S0588 01678000
         ALR   @14,SCANPTR                                      03S0588 01679000
         CLI   INDATA-1(@14),C' '                               03S0588 01680000
         BNE   @DC00587                                         03S0588 01681000
         CR    SCANPTR,LASTIN                                   03S0588 01682000
         BNH   @DL00587                                         03S0588 01683000
@DC00587 DS    0H                                               03S0589 01684000
*     FSTCHAR=SCANPTR;              /* SAVE INDEX TO FIRST CHARACTER */ 01685000
         STH   SCANPTR,FSTCHAR                                  03S0589 01686000
*                                                               04S0590 01687000
*     /***************************************************************/ 01688000
*     /*                                                             */ 01689000
*     /* USSPARM.USSEARCH.USSDDATA: THIS SEGMENT DELIMITS DATA AND   */ 01690000
*     /* VALIDATES USAGE OF SYNTAX CHARACTERS.                       */ 01691000
*     /*                                                             */ 01692000
*     /***************************************************************/ 01693000
*                                                               04S0590 01694000
*     DO SCANPTR=SCANPTR BY 1 WHILE(EXITCODE=TRANSOK&INDATA(SCANPTR)^=  01695000
*           ','&SCANPTR<=LASTIN);   /* LOOP WHILE NO ERRORS, A COMMA    01696000
*                                      HAS NOT BEEN FOUND, AND END OF   01697000
*                                      INPUT NOT REACHED             */ 01698000
         B     @DE00590                                         04S0590 01699000
@DL00590 DS    0H                                               04S0591 01700000
*       IF INDATA(SCANPTR)='=' THEN /* IF THIS CHARACTER IS AN = ... */ 01701000
         LR    @14,INPTR                                        04S0591 01702000
         ALR   @14,SCANPTR                                      04S0591 01703000
         CLI   INDATA-1(@14),C'='                               04S0591 01704000
         BNE   @RF00591                                         04S0591 01705000
*         EXITCODE=BADINPUT;        /* SET INVALID INPUT RETURN CODE */ 01706000
         LA    @14,28                                           04S0592 01707000
         ST    @14,EXITCODE                                     04S0592 01708000
*       ELSE                                                    04S0593 01709000
*         IF INDATA(SCANPTR)=' ' THEN/* IF THIS CHARACTER IS A  04S0593 01710000
*                                      BLANK...                      */ 01711000
         B     @RC00591                                         04S0593 01712000
@RF00591 LR    @14,INPTR                                        04S0593 01713000
         ALR   @14,SCANPTR                                      04S0593 01714000
         CLI   INDATA-1(@14),C' '                               04S0593 01715000
         BNE   @RF00593                                         04S0593 01716000
*           CALL USSEOD;            /* THEN SCAN TO THE NEXT    04S0594 01717000
*                                      DELIMITER                     */ 01718000
         BAL   @14,USSEOD                                       04S0594 01719000
*         ELSE                                                  04S0595 01720000
*           IF INDATA(SCANPTR)='''' THEN/* IF THIS CHARACTER IS AN      01721000
*                                      APOSTROPHE ...                */ 01722000
         B     @RC00593                                         04S0595 01723000
@RF00593 LR    @14,INPTR                                        04S0595 01724000
         ALR   @14,SCANPTR                                      04S0595 01725000
         CLI   INDATA-1(@14),C''''                              04S0595 01726000
         BNE   @RF00595                                         04S0595 01727000
*             DO;                   /* THEN ...                      */ 01728000
*                                                               04S0596 01729000
*               /*****************************************************/ 01730000
*               /*                                                   */ 01731000
*               /* PROCESS DATA BETWEEN APOSTROPHES                  */ 01732000
*               /*                                                   */ 01733000
*               /*****************************************************/ 01734000
*                                                               04S0597 01735000
*                                                               05S0597 01736000
*               /*****************************************************/ 01737000
*               /*                                                   */ 01738000
*               /* USSPARM.USSEARCH.USSDDATA.USSFDQU: THIS SEGMENT   */ 01739000
*               /* COUNTS ALL DATA BETWEEN APOSTROPHES THEN SCANS TO */ 01740000
*               /* NEXT DELIMITER WHEN THE SECOND APOSTROPHE IS      */ 01741000
*               /* ENCOUNTERED. IF TWO CONSECUTIVE APOSTROPHES ARE   */ 01742000
*               /* ENCOUNTERED THEY ARE COUNTED AND THE SCAN         */ 01743000
*               /* CONTINUES.                                        */ 01744000
*               /*                                                   */ 01745000
*               /*****************************************************/ 01746000
*                                                               05S0597 01747000
*               FOUND=NO;           /* RESET DATA FOUND FLAG - SET      01748000
*                                      WHEN 2ND APOSTROPHE FOUND     */ 01749000
         NI    FOUND,B'01111111'                                05S0597 01750000
*               IF IMBEDDED=YES THEN                            05S0598 01751000
         TM    IMBEDDED,B'10000000'                             05S0598 01752000
         BO    @RT00598                                         05S0598 01753000
*                 ;                 /* IF FIRST APOSTROPHE IMBEDDED     01754000
*                                      IN DATA THEN NO FURTHER ACTION   01755000
*                                      TAKEN                         */ 01756000
*               ELSE                                            05S0600 01757000
*                 DO;               /* ELSE ...                      */ 01758000
*                   FSTCHAR=SCANPTR+1;/* SET DATA INDEX TO CHARACTER    01759000
*                                      PAST '                        */ 01760000
         LA    @14,1(,SCANPTR)                                  05S0601 01761000
         STH   @14,FSTCHAR                                      05S0601 01762000
*                   DO SCANPTR=SCANPTR+1 BY 1 WHILE(SCANPTR<=LASTIN&    01763000
*                         EXITCODE=TRANSOK&FOUND=NO);/* LOOP WHILE      01764000
*                                      NOT END OF INPUT, NO ERRORS      01765000
*                                      ENCOUNTERED AND DATA NOT 05S0602 01766000
*                                      DELIMITED                     */ 01767000
         LR    SCANPTR,@14                                      05S0602 01768000
         B     @DE00602                                         05S0602 01769000
@DL00602 DS    0H                                               05S0603 01770000
*                     IF INDATA(SCANPTR)^='''' THEN/* IF THIS   05S0603 01771000
*                                      CHARACTER NOT AN ' ...        */ 01772000
         LR    @14,INPTR                                        05S0603 01773000
         ALR   @14,SCANPTR                                      05S0603 01774000
         CLI   INDATA-1(@14),C''''                              05S0603 01775000
         BE    @RF00603                                         05S0603 01776000
*                       CHARLEN=CHARLEN+1;/* INCREMENT CHARACTER        01777000
*                                      COUNT                         */ 01778000
         LA    CHARLEN,1(,CHARLEN)                              05S0604 01779000
*                     ELSE                                      05S0605 01780000
*                       IF INDATA(SCANPTR+1)='''' THEN/* IF TWO 05S0605 01781000
*                                      CONSECUTIVE ' ...             */ 01782000
         B     @RC00603                                         05S0605 01783000
@RF00603 LR    @14,INPTR                                        05S0605 01784000
         ALR   @14,SCANPTR                                      05S0605 01785000
         CLI   INDATA(@14),C''''                                05S0605 01786000
         BNE   @RF00605                                         05S0605 01787000
*                         DO;                                   05S0606 01788000
*                           CHARLEN=CHARLEN+2;/* ADD 2 TO CHARACTER     01789000
*                                      COUNT, THE EXTRA ' WILL BE       01790000
*                                      REMOVED LATER                 */ 01791000
         LA    CHARLEN,2(,CHARLEN)                              05S0607 01792000
*                           SCANPTR=SCANPTR+1;/* INCREMENT SCAN 05S0608 01793000
*                                      POINTER TO BYPASS SECOND '    */ 01794000
         AL    SCANPTR,@CF00061                                 05S0608 01795000
*                         END;                                  05S0609 01796000
*                       ELSE                                    05S0610 01797000
*                         DO;       /* ELSE ...                      */ 01798000
         B     @RC00605                                         05S0610 01799000
@RF00605 DS    0H                                               05S0611 01800000
*                           SCANPTR=SCANPTR+1;/* ADVANCE SCAN POINTER*/ 01801000
         AL    SCANPTR,@CF00061                                 05S0611 01802000
*                           CALL USSEOD;/* SCAN TO NEXT DELIMITER    */ 01803000
         BAL   @14,USSEOD                                       05S0612 01804000
*                           FOUND=YES;/* SET DATA FOUND FLAG         */ 01805000
         OI    FOUND,B'10000000'                                05S0613 01806000
*                           SCANPTR=SCANPTR-1;                  05S0614 01807000
         BCTR  SCANPTR,0                                        05S0614 01808000
*                         END;                                  05S0615 01809000
*                   END;            /* END OF APOSTROPHE LOOP        */ 01810000
@RC00605 DS    0H                                               05S0616 01811000
@RC00603 AL    SCANPTR,@CF00061                                 05S0616 01812000
@DE00602 CR    SCANPTR,LASTIN                                   05S0616 01813000
         BH    @DC00602                                         05S0616 01814000
         L     @14,EXITCODE                                     05S0616 01815000
         LTR   @14,@14                                          05S0616 01816000
         BNZ   @DC00602                                         05S0616 01817000
         TM    FOUND,B'10000000'                                05S0616 01818000
         BZ    @DL00602                                         05S0616 01819000
@DC00602 DS    0H                                               05S0617 01820000
*                 END;                                          05S0617 01821000
*               IF FOUND=NO THEN                                05S0618 01822000
@RT00598 TM    FOUND,B'10000000'                                05S0618 01823000
         BNZ   @RF00618                                         05S0618 01824000
*                 EXITCODE=BADINPUT;/* IF 2ND APOSTROPHE NOT FOUND      01825000
*                                      THEN SET INVALID INPUT RETURN    01826000
*                                      CODE                          */ 01827000
         LA    @14,28                                           05S0619 01828000
         ST    @14,EXITCODE                                     05S0619 01829000
*             END;                                              04S0620 01830000
*           ELSE                                                04S0621 01831000
*             IF INDATA(SCANPTR)='(' THEN/* IF THIS CHARACTER ( ...  */ 01832000
         B     @RC00595                                         04S0621 01833000
@RF00595 LR    @14,INPTR                                        04S0621 01834000
         ALR   @14,SCANPTR                                      04S0621 01835000
         CLI   INDATA-1(@14),C'('                               04S0621 01836000
         BNE   @RF00621                                         04S0621 01837000
*               DO;                 /* THEN ...                      */ 01838000
*                                                               04S0622 01839000
*                 /***************************************************/ 01840000
*                 /*                                                 */ 01841000
*                 /* VALIDATE SYNTAX                                 */ 01842000
*                 /*                                                 */ 01843000
*                 /***************************************************/ 01844000
*                                                               04S0623 01845000
*                                                               05S0623 01846000
*                 /***************************************************/ 01847000
*                 /*                                                 */ 01848000
*                 /* USSPARM.USSEARCH.USSDDATA.USSLEFT: THIS SEGMENT */ 01849000
*                 /* PERFORMS SYNTAX VALIDATION AFTER A ( IS         */ 01850000
*                 /* ENCOUNTERED. IT THEN SCANS TO THE NEXT NON-BLANK*/ 01851000
*                 /* CHARACTER.                                      */ 01852000
*                 /*                                                 */ 01853000
*                 /***************************************************/ 01854000
*                                                               05S0623 01855000
*                 EXITCODE=BADINPUT;/* SET ERROR RETURN. RESET IF       01856000
*                                      SYNTAX VALID                  */ 01857000
         LA    @14,28                                           05S0623 01858000
         ST    @14,EXITCODE                                     05S0623 01859000
*                 IF KEYWORD=NO THEN                            05S0624 01860000
         TM    KEYWORD,B'10000000'                              05S0624 01861000
         BZ    @RT00624                                         05S0624 01862000
*                   ;               /* IF KEYWORD NOT BEING PROCESSED   01863000
*                                      THEN TERMINATE WITH AN ERROR  */ 01864000
*                 ELSE                                          05S0626 01865000
*                   IF PAREN=YES THEN                           05S0626 01866000
         TM    PAREN,B'10000000'                                05S0626 01867000
         BO    @RT00626                                         05S0626 01868000
*                     ;             /* IF ( ALREADY ENCOUNTERED 05S0627 01869000
*                                      TERMINATE WITH AN ERROR       */ 01870000
*                   ELSE                                        05S0628 01871000
*                     IF IMBEDDED=YES THEN                      05S0628 01872000
         TM    IMBEDDED,B'10000000'                             05S0628 01873000
         BO    @RT00628                                         05S0628 01874000
*                       ;           /* IF ( IMBEDDED IN DATA    05S0629 01875000
*                                      TERMINATE WITH AN ERROR       */ 01876000
*                     ELSE                                      05S0630 01877000
*                       DO;         /* ELSE ...                      */ 01878000
*                         PAREN=YES;/* SET PARENTHETICAL FLAG        */ 01879000
         OI    PAREN,B'10000000'                                05S0631 01880000
*                         EXITCODE=TRANSOK;/* RESET ERROR CODE       */ 01881000
         SLR   @14,@14                                          05S0632 01882000
         ST    @14,EXITCODE                                     05S0632 01883000
*                         DO SCANPTR=SCANPTR+1 BY 1 WHILE(INDATA(       01884000
*                               SCANPTR)=' '&SCANPTR<=LASTIN);/* LOOP   01885000
*                                      UNTIL END OF INPUT OR    05S0633 01886000
*                                      NON-BLANK                     */ 01887000
         LA    @14,1                                            05S0633 01888000
         ALR   @14,SCANPTR                                      05S0633 01889000
         LR    SCANPTR,@14                                      05S0633 01890000
         B     @DE00633                                         05S0633 01891000
@DL00633 DS    0H                                               05S0634 01892000
*                         END;                                  05S0634 01893000
         AL    SCANPTR,@CF00061                                 05S0634 01894000
@DE00633 LR    @14,INPTR                                        05S0634 01895000
         ALR   @14,SCANPTR                                      05S0634 01896000
         CLI   INDATA-1(@14),C' '                               05S0634 01897000
         BNE   @DC00633                                         05S0634 01898000
         CR    SCANPTR,LASTIN                                   05S0634 01899000
         BNH   @DL00633                                         05S0634 01900000
@DC00633 DS    0H                                               05S0635 01901000
*                       END;                                    05S0635 01902000
*                 FSTCHAR=SCANPTR;  /* FIRST DATA CHARACTER POINTER  */ 01903000
@RT00628 DS    0H                                               05S0636 01904000
@RT00626 DS    0H                                               05S0636 01905000
@RT00624 STH   SCANPTR,FSTCHAR                                  05S0636 01906000
*               END;                                            04S0637 01907000
*             ELSE                                              04S0638 01908000
*               IF INDATA(SCANPTR)=')' THEN/* IF THIS CHARACTER ) ...*/ 01909000
         B     @RC00621                                         04S0638 01910000
@RF00621 LR    @14,INPTR                                        04S0638 01911000
         ALR   @14,SCANPTR                                      04S0638 01912000
         CLI   INDATA-1(@14),C')'                               04S0638 01913000
         BNE   @RF00638                                         04S0638 01914000
*                 DO;               /* THEN ...                      */ 01915000
*                                                               04S0639 01916000
*                   /*************************************************/ 01917000
*                   /*                                               */ 01918000
*                   /* VALIDATE SYNTAX                               */ 01919000
*                   /*                                               */ 01920000
*                   /*************************************************/ 01921000
*                                                               04S0640 01922000
*                                                               05S0640 01923000
*                   /*************************************************/ 01924000
*                   /*                                               */ 01925000
*                   /* USSPARM.USSEARCH.USSDDATA.USSRIGHT: THIS      */ 01926000
*                   /* SEGMENT VALIDATES SYNTAX AFTER A ) IS         */ 01927000
*                   /* ENCOUNTERED THEN SCANS TO THE NEXT DELIMITER  */ 01928000
*                   /* OR END OF INPUT.                              */ 01929000
*                   /*                                               */ 01930000
*                   /*************************************************/ 01931000
*                                                               05S0640 01932000
*                   EXITCODE=BADINPUT;/* SET INVALID INPUT RETURN       01933000
*                                      CODE - RESET IF NO ERRORS     */ 01934000
         LA    @14,28                                           05S0640 01935000
         ST    @14,EXITCODE                                     05S0640 01936000
*                   IF KEYWORD=NO THEN                          05S0641 01937000
         TM    KEYWORD,B'10000000'                              05S0641 01938000
         BZ    @RT00641                                         05S0641 01939000
*                     ;             /* IF KEYWORD NOT BEING PROCESSED   01940000
*                                      THEN TERMINATE WITH AN ERROR  */ 01941000
*                   ELSE                                        05S0643 01942000
*                     IF PAREN=NO THEN                          05S0643 01943000
         TM    PAREN,B'10000000'                                05S0643 01944000
         BZ    @RT00643                                         05S0643 01945000
*                       ;           /* IF NOT PARENTHETICAL DATA THEN   01946000
*                                      TERMINATE WITH AN ERROR       */ 01947000
*                     ELSE                                      05S0645 01948000
*                       DO;         /* ELSE ...                      */ 01949000
*                         PAREN=NO; /* SET PARENTHETICAL VALUE FLAG  */ 01950000
         NI    PAREN,B'01111111'                                05S0646 01951000
*                         EXITCODE=TRANSOK;/* RESET ERROR CODE       */ 01952000
         SLR   @14,@14                                          05S0647 01953000
         ST    @14,EXITCODE                                     05S0647 01954000
*                         CALL USSEOD;/* SCAN TO NEXT DELIMITER      */ 01955000
         BAL   @14,USSEOD                                       05S0648 01956000
*                       END;                                    05S0649 01957000
*                 END;                                          04S0650 01958000
*               ELSE                                            04S0651 01959000
*                 DO;                                           04S0651 01960000
         B     @RC00638                                         04S0651 01961000
@RF00638 DS    0H                                               04S0652 01962000
*                   CHARLEN=CHARLEN+1;/* # OF CHARACTERS             */ 01963000
         LA    CHARLEN,1(,CHARLEN)                              04S0652 01964000
*                   IMBEDDED=YES;   /* SET DATA FOUND FLAG           */ 01965000
         OI    IMBEDDED,B'10000000'                             04S0653 01966000
*                 END;                                          04S0654 01967000
*     END;                          /* END OF SYNTAX CHECK LOOP      */ 01968000
@RC00638 DS    0H                                               04S0655 01969000
@RC00621 DS    0H                                               04S0655 01970000
@RC00595 DS    0H                                               04S0655 01971000
@RC00593 DS    0H                                               04S0655 01972000
@RC00591 AL    SCANPTR,@CF00061                                 04S0655 01973000
@DE00590 L     @14,EXITCODE                                     04S0655 01974000
         LTR   @14,@14                                          04S0655 01975000
         BNZ   @DC00590                                         04S0655 01976000
         LR    @14,INPTR                                        04S0655 01977000
         ALR   @14,SCANPTR                                      04S0655 01978000
         CLI   INDATA-1(@14),C','                               04S0655 01979000
         BE    @DC00590                                         04S0655 01980000
         CR    SCANPTR,LASTIN                                   04S0655 01981000
         BNH   @DL00590                                         04S0655 01982000
@DC00590 DS    0H                                               04S0656 01983000
*                                   /* DELIMIT DATA                  */ 01984000
*     IF EXITCODE^=TRANSOK THEN                                 02S0656 01985000
         L     @14,EXITCODE                                     02S0656 01986000
         LTR   @14,@14                                          02S0656 01987000
         BNZ   @RT00656                                         02S0656 01988000
*       ;                           /* IF AN ERROR OCCURED, THEN        01989000
*                                      SUSPEND PROCESSING            */ 01990000
*     ELSE                                                      02S0658 01991000
*       DO;                         /* ELSE CONTINUE                 */ 01992000
*         IF CHARLEN=0 THEN         /* IF INPUT DATA WAS NOT FOUND      01993000
*                                      ...                           */ 01994000
         C     CHARLEN,@CF01591                                 02S0659 01995000
         BNE   @RF00659                                         02S0659 01996000
*           CALL USSDEF;            /* THEN PLACE DEFAULT VALUE INTO    01997000
*                                      FORMATTED OUTPUT IF REQUIRED  */ 01998000
*                                                               02S0660 01999000
         BAL   @14,USSDEF                                       02S0660 02000000
*         /***********************************************************/ 02001000
*         /*                                                         */ 02002000
*         /* SEARCH FOR VALUE ENTRY HAVING SAME NAME AND MOVE        */ 02003000
*         /* REPLACEMENT DATA IF FOUND                               */ 02004000
*         /*                                                         */ 02005000
*         /***********************************************************/ 02006000
*                                                               02S0661 02007000
*         ELSE                                                  02S0661 02008000
*           DO;                                                 02S0661 02009000
         B     @RC00659                                         02S0661 02010000
@RF00659 DS    0H                                               02S0662 02011000
*                                                               03S0662 02012000
*             /*******************************************************/ 02013000
*             /*                                                     */ 02014000
*             /* USSPARM.USSETVAL: THIS SEGMENT SEARCHES FOR A VALUE */ 02015000
*             /* ENTRY HAVING THE SAME NAME AS THE DELIMITED         */ 02016000
*             /* PARAMETER VALUE AND IF FOUND MOVES THE REPLACEMENT  */ 02017000
*             /* DATA TO THE COMMAND OUTPUT FIELD.                   */ 02018000
*             /*                                                     */ 02019000
*             /*******************************************************/ 02020000
*                                                               03S0662 02021000
*             DO WHILE(USSDTYPE=USSFVAL&USSDVLEN^=0&MOVED^=YES);/*      02022000
*                                      SEARCH FOR VALUE DESCRIPTORS     02023000
*                                      UNTIL A VALUE NAME IS FOUND      02024000
*                                      WHICH IS EQUAL TO THE ONE        02025000
*                                      DELIMITED, OR THE VALUE  03S0662 02026000
*                                      ENTRIES FOR THE CURRENT  03S0662 02027000
*                                      PARAMETER ARE EXHAUSTED       */ 02028000
         B     @DE00662                                         03S0662 02029000
@DL00662 DS    0H                                               03S0663 02030000
*               IF CHARLEN^=USSDVLEN|INDATA(FSTCHAR:FSTCHAR+CHARLEN-1)  02031000
*                   ^=USSDVAL(1:CHARLEN) THEN/* IF THE DELIMITED        02032000
*                                      VALUE CHARACTERS DO NOT EQUAL    02033000
*                                      THE NAME IN THE VALUE ENTRY,     02034000
*                                      ...                           */ 02035000
         L     @14,USSDB                                        03S0663 02036000
         SLR   @08,@08                                          03S0663 02037000
         IC    @08,USSDVLEN(,@14)                               03S0663 02038000
         CR    CHARLEN,@08                                      03S0663 02039000
         BNE   @RT00663                                         03S0663 02040000
         LH    @08,FSTCHAR                                      03S0663 02041000
         LR    @02,CHARLEN                                      03S0663 02042000
         BCTR  @02,0                                            03S0663 02043000
         ALR   @08,INPTR                                        03S0663 02044000
         EX    @02,@SC01729                                     03S0663 02045000
         BE    @RF00663                                         03S0663 02046000
@RT00663 DS    0H                                               03S0664 02047000
*                 USSDB=USSDB+((ADDR(USSDVAL)-ADDR(IEDUSSD))+USSDVLEN+  02048000
*                     USSDRLEN);    /* STEP POINTER TO NEXT VALUE       02049000
*                                      ENTRY IN TABLE                */ 02050000
         L     @14,USSDB                                        03S0664 02051000
         LA    @08,3                                            03S0664 02052000
         SLR   @02,@02                                          03S0664 02053000
         IC    @02,USSDVLEN(,@14)                               03S0664 02054000
         ALR   @08,@02                                          03S0664 02055000
         SLR   @02,@02                                          03S0664 02056000
         IC    @02,USSDRLEN(,@14)                               03S0664 02057000
         ALR   @08,@02                                          03S0664 02058000
         ALR   @14,@08                                          03S0664 02059000
         ST    @14,USSDB                                        03S0664 02060000
*               ELSE                                            03S0665 02061000
*                 CALL USSMOVE;     /* ELSE MOVE THE EQUATED VALUE      02062000
*                                      FROM THE ENTRY INTO THE  03S0665 02063000
*                                      FORMATTED OUTPUT AREA         */ 02064000
         B     @RC00663                                         03S0665 02065000
@RF00663 BAL   @14,USSMOVE                                      03S0665 02066000
*             END;                  /* END OF VALUE ENTRY SEARCH     */ 02067000
@RC00663 DS    0H                                               03S0666 02068000
@DE00662 L     @14,USSDB                                        03S0666 02069000
         TM    USSDTYPE(@14),B'10000000'                        03S0666 02070000
         BNO   @DC00662                                         03S0666 02071000
         TM    USSDTYPE(@14),B'01100000'                        03S0666 02072000
         BNZ   @DC00662                                         03S0666 02073000
         CLI   USSDVLEN(@14),0                                  03S0666 02074000
         BE    @DC00662                                         03S0666 02075000
         TM    MOVED,B'10000000'                                03S0666 02076000
         BNO   @DL00662                                         03S0666 02077000
@DC00662 DS    0H                                               03S0667 02078000
*                                                               02S0667 02079000
*             /*******************************************************/ 02080000
*             /*                                                     */ 02081000
*             /* IF ALL VALUE ENTRIES PROCESSED INSURE DATA MOVED    */ 02082000
*             /*                                                     */ 02083000
*             /*******************************************************/ 02084000
*                                                               02S0667 02085000
*             IF USSDTYPE^=USSFVAL THEN/* IF ALL VALUE ENTRIES HAVE     02086000
*                                      BEEN PROCESSED, ...           */ 02087000
         L     @14,USSDB                                        02S0667 02088000
         TM    USSDTYPE(@14),B'10000000'                        02S0667 02089000
         BNO   @RT00667                                         02S0667 02090000
         TM    USSDTYPE(@14),B'01100000'                        02S0667 02091000
         BZ    @RF00667                                         02S0667 02092000
@RT00667 DS    0H                                               02S0668 02093000
*               DO;                 /* THEN DO                       */ 02094000
*                 IF MOVED=NO THEN  /* IF THIS IS A REQUIRED    02S0669 02095000
*                                      PARAMETER AND DATA HAS NOT       02096000
*                                      BEEN MOVED, ...               */ 02097000
         TM    MOVED,B'10000000'                                02S0669 02098000
         BNZ   @RF00669                                         02S0669 02099000
*                   EXITCODE=BADPARM;/* THEN SET INVALID PARAMETER      02100000
*                                      ERROR RETURN CODE AND SUSPEND    02101000
*                                      PROCESSING                    */ 02102000
         LA    @14,44                                           02S0670 02103000
         ST    @14,EXITCODE                                     02S0670 02104000
*                 USSPB=USSDB;      /* RESET CURRENT POSITIONAL 02S0671 02105000
*                                      PARAMETER TABLE ENTRY POINTER    02106000
*                                      TO THE NEXT POSITIONAL   02S0671 02107000
*                                      PARAMETER ENTRY               */ 02108000
@RF00669 L     USSPB,USSDB                                      02S0671 02109000
*               END;                                            02S0672 02110000
*                                                               02S0672 02111000
*             /*******************************************************/ 02112000
*             /*                                                     */ 02113000
*             /* MOVE USER DATA IF PERMITTED, OTHERWISE SET ERROR    */ 02114000
*             /* RETURN                                              */ 02115000
*             /*                                                     */ 02116000
*             /*******************************************************/ 02117000
*                                                               02S0673 02118000
*             ELSE                                              02S0673 02119000
*               DO;                 /* ELSE IF A VALUE ENTRY         */ 02120000
         B     @RC00667                                         02S0673 02121000
@RF00667 DS    0H                                               02S0674 02122000
*                 IF USSDRLEN=0 THEN/* IF THIS IS A VALUE ENTRY THAT    02123000
*                                      SPECIFIES USER INPUT (VALUE      02124000
*                                      NAME NOT SPECIFIED AND NO        02125000
*                                      REPLACEMENT DATA INDICATED)...*/ 02126000
         L     @14,USSDB                                        02S0674 02127000
         CLI   USSDRLEN(@14),0                                  02S0674 02128000
         BNE   @RF00674                                         02S0674 02129000
*                   DO;             /* THEN CONVERT AND MOVE USER       02130000
*                                      DATA TO OUTPUT FIELD          */ 02131000
*                                                               03S0676 02132000
*                     /***********************************************/ 02133000
*                     /*                                             */ 02134000
*                     /* USSPARM.USSCONV: THIS SEGMENT PROCESSES USER*/ 02135000
*                     /* INPUT DATA, CHARACTER OR BINARY, AND PLACES */ 02136000
*                     /* IT INTO THE APPROPRIATE COMMAND OUTPUT      */ 02137000
*                     /* FIELD. CONVERT DATA TO BINARY IF REQUIRED   */ 02138000
*                     /*                                             */ 02139000
*                     /***********************************************/ 02140000
*                                                               03S0676 02141000
*                     IF USSPDATA=USSPBIN THEN/* IF DATA IS TO BE       02142000
*                                      CONVERTED TO BINARY, ...      */ 02143000
         TM    USSPDATA(USSPB),B'00000010'                      03S0676 02144000
         BNO   @RF00676                                         03S0676 02145000
         TM    USSPDATA(USSPB),B'00001101'                      03S0676 02146000
         BNZ   @RF00676                                         03S0676 02147000
*                       DO;         /* THEN CONVERT TO BINARY   03S0677 02148000
*                                      REPLACEMENT DATA              */ 02149000
*                                                               04S0678 02150000
*                         /*******************************************/ 02151000
*                         /*                                         */ 02152000
*                         /* USSPARM.USSCONV.USSBBVAL: THIS SEGMENT  */ 02153000
*                         /* VALIDATES THAT USER INPUT DATA IS ALL   */ 02154000
*                         /* NUMERIC, THEN TRANSLATES IT TO BINARY   */ 02155000
*                         /* AND MAKES SURE IT DOESN'T EXCEED MAXIMUM*/ 02156000
*                         /* VALUE FOR FIELD.                        */ 02157000
*                         /*                                         */ 02158000
*                         /*******************************************/ 02159000
*                                                               04S0678 02160000
*                         UNPACKED(1:16)='';/* BLANK WORK AREA       */ 02161000
*                                                               04S0678 02162000
         MVI   UNPACKED,C' '                                    04S0678 02163000
         MVC   UNPACKED+1(15),UNPACKED                          04S0678 02164000
*                         /*******************************************/ 02165000
*                         /*                                         */ 02166000
*                         /* VALIDATE CHARACTERS ARE NUMERIC         */ 02167000
*                         /*                                         */ 02168000
*                         /*******************************************/ 02169000
*                                                               04S0679 02170000
*                         UNPACKED(17-CHARLEN:16)=INDATA(FSTCHAR:       02171000
*                             FSTCHAR+CHARLEN-1);               04S0679 02172000
*                                                               04S0679 02173000
         LA    @14,17                                           04S0679 02174000
         SLR   @14,CHARLEN                                      04S0679 02175000
         LA    @08,UNPACKED-1(@14)                              04S0679 02176000
         LCR   @14,@14                                          04S0679 02177000
         AL    @14,@CF00166                                     04S0679 02178000
         LH    @02,FSTCHAR                                      04S0679 02179000
         ALR   @02,INPTR                                        04S0679 02180000
         EX    @14,@SM01731                                     04S0679 02181000
*                         /*******************************************/ 02182000
*                         /*                                         */ 02183000
*                         /* MOVE CHARACTER STRING INTO WORK AREA    */ 02184000
*                         /*                                         */ 02185000
*                         /*******************************************/ 02186000
*                                                               04S0680 02187000
*                         DO MOVECOUN=FSTCHAR TO(FSTCHAR+CHARLEN-1)     02188000
*                               WHILE(EXITCODE=TRANSOK);        04S0680 02189000
*                                                               04S0680 02190000
         LH    @14,FSTCHAR                                      04S0680 02191000
         LR    MOVECOUN,@14                                     04S0680 02192000
         B     @DE00680                                         04S0680 02193000
@DL00680 L     @14,EXITCODE                                     04S0680 02194000
         LTR   @14,@14                                          04S0680 02195000
         BNZ   @DC00680                                         04S0680 02196000
*                           /*****************************************/ 02197000
*                           /*                                       */ 02198000
*                           /* INSURE THAT CHARACTER STRING IS       */ 02199000
*                           /* NUMERIC                               */ 02200000
*                           /*                                       */ 02201000
*                           /*****************************************/ 02202000
*                                                               04S0681 02203000
*                           IF INDATA(MOVECOUN)<'0'|INDATA(MOVECOUN)>'9 02204000
*                             THEN  /* IF CHARACTER NOT NUMERIC, ... */ 02205000
         LR    @14,INPTR                                        04S0681 02206000
         ALR   @14,MOVECOUN                                     04S0681 02207000
         CLI   INDATA-1(@14),C'0'                               04S0681 02208000
         BL    @RT00681                                         04S0681 02209000
         LR    @14,INPTR                                        04S0681 02210000
         ALR   @14,MOVECOUN                                     04S0681 02211000
         CLI   INDATA-1(@14),C'9'                               04S0681 02212000
         BNH   @RF00681                                         04S0681 02213000
@RT00681 DS    0H                                               04S0682 02214000
*                             EXITCODE=BADPARM;/* THEN SET INVALID      02215000
*                                      PARAMETER RETURN CODE         */ 02216000
         LA    @14,44                                           04S0682 02217000
         ST    @14,EXITCODE                                     04S0682 02218000
*                         END;      /* END OF CHARACTER VALIDATION      02219000
*                                      LOOP                          */ 02220000
@RF00681 AL    MOVECOUN,@CF00061                                04S0683 02221000
@DE00680 LR    @14,CHARLEN                                      04S0683 02222000
         AH    @14,FSTCHAR                                      04S0683 02223000
         BCTR  @14,0                                            04S0683 02224000
         CR    MOVECOUN,@14                                     04S0683 02225000
         BNH   @DL00680                                         04S0683 02226000
@DC00680 DS    0H                                               04S0684 02227000
*                         IF EXITCODE^=TRANSOK THEN             04S0684 02228000
         L     @14,EXITCODE                                     04S0684 02229000
         LTR   @14,@14                                          04S0684 02230000
         BNZ   @RT00684                                         04S0684 02231000
*                           ;       /* IF AN ERROR OCCURRED THEN        02232000
*                                      SUSPEND PROCESSING            */ 02233000
*                                                               04S0685 02234000
*                         /*******************************************/ 02235000
*                         /*                                         */ 02236000
*                         /* IF NO ERRORS CONVERT TO BINARY AND      */ 02237000
*                         /* INSURE VALUE DOES NOT EXCEED MAXIMUM    */ 02238000
*                         /* POSSIBLE FOR FIELD                      */ 02239000
*                         /*                                         */ 02240000
*                         /*******************************************/ 02241000
*                                                               04S0686 02242000
*                         ELSE                                  04S0686 02243000
*                           DO;     /* ELSE CONTINUE ...             */ 02244000
*                             PACK(PACKED,UNPACKED);/* PACK DATA TO     02245000
*                                      BE CONVERTED TO BINARY        */ 02246000
         PACK  PACKED(8),UNPACKED(16)                           04S0687 02247000
*                             CVB(BINDATA,PACKED);/* CONVERT IT TO      02248000
*                                      BINARY                        */ 02249000
         CVB   @14,PACKED                                       04S0688 02250000
         ST    @14,BINDATA                                      04S0688 02251000
*                             MAXFIELD=-1;/* INITIATE MAX FIELD VALUE*/ 02252000
         SLR   MAXFIELD,MAXFIELD                                04S0689 02253000
         BCTR  MAXFIELD,0                                       04S0689 02254000
*                             SHIFT=32-USSPLEN;/* SHIFT VALUE        */ 02255000
         LA    @02,32                                           04S0690 02256000
         SLR   @01,@01                                          04S0690 02257000
         ICM   @01,3,USSPLEN(USSPB)                             04S0690 02258000
         SLR   @02,@01                                          04S0690 02259000
         STC   @02,SHIFT                                        04S0690 02260000
*                             SRL(MAXFIELD,SHIFT);/* SET MAXIMUM        02261000
*                                      VALUE                         */ 02262000
         SRL   MAXFIELD,0(@02)                                  04S0691 02263000
*                             IF MAXFIELD<BINDATA THEN/* IF CONVERTED   02264000
*                                      DATA EXCEEDS MAXIMUM, ...     */ 02265000
         CR    MAXFIELD,@14                                     04S0692 02266000
         BNL   @RF00692                                         04S0692 02267000
*                               EXITCODE=TOOMUCH;/* SET RETURN CODE     02268000
*                                      FOR INPUT EXCEEDS MAXIMUM        02269000
*                                      ALLOWABLE                     */ 02270000
*                                                               04S0693 02271000
         LA    @14,40                                           04S0693 02272000
         ST    @14,EXITCODE                                     04S0693 02273000
*                             /***************************************/ 02274000
*                             /*                                     */ 02275000
*                             /* IF NO ERRORS TRANSFER BINARY NUMBER */ 02276000
*                             /* TO VALUE ENTRY                      */ 02277000
*                             /*                                     */ 02278000
*                             /***************************************/ 02279000
*                                                               04S0694 02280000
*                             ELSE                              04S0694 02281000
*                               DO; /* ELSE ...                      */ 02282000
         B     @RC00692                                         04S0694 02283000
@RF00692 DS    0H                                               04S0695 02284000
*                                 BLDWIDTH=(USSPLEN+7)/8;/* SET BYTE    02285000
*                                      COUNT OF CONVERTED VALUE      */ 02286000
         LA    @00,7                                            04S0695 02287000
         SLR   BLDWIDTH,BLDWIDTH                                04S0695 02288000
         ICM   BLDWIDTH,3,USSPLEN(USSPB)                        04S0695 02289000
         ALR   @00,BLDWIDTH                                     04S0695 02290000
         SRDA  @00,32                                           04S0695 02291000
         D     @00,@CF00046                                     04S0695 02292000
         LR    BLDWIDTH,@01                                     04S0695 02293000
*                                 MYVAL->USSDRLEN=BLDWIDTH;/* SET       02294000
*                                      WIDTH OF CONVERTED USER DATA     02295000
*                                      INTO VALUE ENTRY              */ 02296000
         L     @14,MYVAL                                        04S0696 02297000
         STC   BLDWIDTH,USSDRLEN(,@14)                          04S0696 02298000
*                                 MYVAL->USSDREP(1:BLDWIDTH)=BINDATAC(5 02299000
*                                     -BLDWIDTH:4);/* MOVE      04S0697 02300000
*                                      REPLACEMENT DATA TO VALUE        02301000
*                                      ENTRY                         */ 02302000
         LR    @02,BLDWIDTH                                     04S0697 02303000
         BCTR  @02,0                                            04S0697 02304000
         LA    @01,5                                            04S0697 02305000
         SLR   @01,BLDWIDTH                                     04S0697 02306000
         ST    @02,@TF00001                                     04S0697 02307000
         LA    @02,BINDATAC-1(@01)                              04S0697 02308000
         L     @01,@TF00001                                     04S0697 02309000
         EX    @01,@SM01733                                     04S0697 02310000
*                               END;                            04S0698 02311000
*                           END;                                04S0699 02312000
*                       END;                                    03S0700 02313000
*                     ELSE                                      03S0701 02314000
*                       DO;         /* ELSE PREPARE CHARACTER   03S0701 02315000
*                                      REPLACEMENT DATA              */ 02316000
         B     @RC00676                                         03S0701 02317000
@RF00676 DS    0H                                               03S0702 02318000
*                                                               04S0702 02319000
*                         /*******************************************/ 02320000
*                         /*                                         */ 02321000
*                         /* USSPARM.USSCONV.USSREMOV: THIS SEGMENT  */ 02322000
*                         /* SCANS THE POSITIONAL PARAMETER/KEYWORD  */ 02323000
*                         /* VALUE INPUT BY THE USER AND TRANSFERS IT*/ 02324000
*                         /* TO THE VALUE ENTRY BEING CONSTRUCTED.   */ 02325000
*                         /* APOSTROPHES ARE REMOVED IN THE PROCESS. */ 02326000
*                         /*                                         */ 02327000
*                         /*******************************************/ 02328000
*                                                               04S0702 02329000
*                         TARGINDX=0;/* RESET INDEX INTO TARGET AREA */ 02330000
         SLR   @14,@14                                          04S0702 02331000
         ST    @14,TARGINDX                                     04S0702 02332000
*                         DO MOVECOUN=FSTCHAR TO(FSTCHAR+CHARLEN-1);    02333000
         LH    MOVECOUN,FSTCHAR                                 04S0703 02334000
         B     @DE00703                                         04S0703 02335000
@DL00703 DS    0H                                               04S0704 02336000
*                                   /* LOOP UNTIL ALL CHARS HAVE BEEN   02337000
*                                      MOVED TO VALUE ENTRY          */ 02338000
*                           TARGINDX=TARGINDX+1;/* INCREMENT INDEX   */ 02339000
         LA    @14,1                                            04S0704 02340000
         L     @02,TARGINDX                                     04S0704 02341000
         ALR   @02,@14                                          04S0704 02342000
         ST    @02,TARGINDX                                     04S0704 02343000
*                           IF INDATA(TARGINDX)='''' THEN       04S0705 02344000
         ALR   @02,INPTR                                        04S0705 02345000
         CLI   INDATA-1(@02),C''''                              04S0705 02346000
         BNE   @RF00705                                         04S0705 02347000
*                             MOVECOUN=MOVECOUN+1;/* MUST BUMP INPUT    02348000
*                                      INDEX IF QUOTE IS FOUND       */ 02349000
         ALR   MOVECOUN,@14                                     04S0706 02350000
*                           MYVAL->USSDREP(TARGINDX)=INDATA(MOVECOUN);  02351000
@RF00705 L     @14,MYVAL                                        04S0707 02352000
         AL    @14,TARGINDX                                     04S0707 02353000
         LR    @02,INPTR                                        04S0707 02354000
         ALR   @02,MOVECOUN                                     04S0707 02355000
         MVC   USSDREP-1(1,@14),INDATA-1(@02)                   04S0707 02356000
*                                   /* MOVE A BYTE OF DATA           */ 02357000
*                         END;                                  04S0708 02358000
         AL    MOVECOUN,@CF00061                                04S0708 02359000
@DE00703 LR    @14,CHARLEN                                      04S0708 02360000
         AH    @14,FSTCHAR                                      04S0708 02361000
         BCTR  @14,0                                            04S0708 02362000
         CR    MOVECOUN,@14                                     04S0708 02363000
         BNH   @DL00703                                         04S0708 02364000
*                         CHARLEN=TARGINDX;/* UPDATE CHARLEN FIELD   */ 02365000
         L     CHARLEN,TARGINDX                                 04S0709 02366000
*                                   /* REMOVE DUPLICATE QUOTES FROM     02367000
*                                      INPUT STREAM AND TRANSFER DATA   02368000
*                                      TO CONSTRUCTED VALUE ENTRY    */ 02369000
*                                                               03S0710 02370000
*                         /*******************************************/ 02371000
*                         /*                                         */ 02372000
*                         /* BUILD VALUE ENTRY                       */ 02373000
*                         /*                                         */ 02374000
*                         /*******************************************/ 02375000
*                                                               03S0710 02376000
*                                                               04S0710 02377000
*                         /*******************************************/ 02378000
*                         /*                                         */ 02379000
*                         /* USSPARM.USSCONV.USSBCVAL: THIS SEGMENT  */ 02380000
*                         /* INSURES THAT USER CHARACTER INPUT DOES  */ 02381000
*                         /* NOT EXCEED THE MAXIMUM AMOUNT ALLOWED   */ 02382000
*                         /* FOR THE OUTPUT COMMAND FIELD.           */ 02383000
*                         /*                                         */ 02384000
*                         /*******************************************/ 02385000
*                                                               04S0710 02386000
*                         IF CHARLEN>((USSPLEN+7)/8) THEN/* IF THE      02387000
*                                      NUMBER OF CHARACTERS EXCEEDS     02388000
*                                      THE MAXIMUM,...               */ 02389000
         LA    @00,7                                            04S0710 02390000
         SLR   @14,@14                                          04S0710 02391000
         ICM   @14,3,USSPLEN(USSPB)                             04S0710 02392000
         ALR   @00,@14                                          04S0710 02393000
         SRDA  @00,32                                           04S0710 02394000
         D     @00,@CF00046                                     04S0710 02395000
         CR    CHARLEN,@01                                      04S0710 02396000
         BNH   @RF00710                                         04S0710 02397000
*                           EXITCODE=BADINPUT;/* THEN SET INVALID       02398000
*                                      INPUT RETURN CODE             */ 02399000
         LA    @14,28                                           04S0711 02400000
         ST    @14,EXITCODE                                     04S0711 02401000
*                         ELSE                                  04S0712 02402000
*                           MYVAL->USSDRLEN=CHARLEN;/* SET LENGTH IN    02403000
*                                      VALUE ENTRY                   */ 02404000
         B     @RC00710                                         04S0712 02405000
@RF00710 L     @14,MYVAL                                        04S0712 02406000
         STC   CHARLEN,USSDRLEN(,@14)                           04S0712 02407000
*                       END;                                    03S0713 02408000
@RC00710 DS    0H                                               03S0714 02409000
*                     IF EXITCODE^=TRANSOK THEN                 03S0714 02410000
@RC00676 L     @14,EXITCODE                                     03S0714 02411000
         LTR   @14,@14                                          03S0714 02412000
         BNZ   @RT00714                                         03S0714 02413000
*                       ;           /* IF AN ERROR HAS OCCURRED, THEN   02414000
*                                      NO FURTHER ACTION             */ 02415000
*                     ELSE                                      03S0716 02416000
*                       DO;                                     03S0716 02417000
*                         SAVEDB=USSDB;/* SAVE VALUE ENTRY           */ 02418000
         L     @14,USSDB                                        03S0717 02419000
         ST    @14,SAVEDB                                       03S0717 02420000
*                         USSDB=MYVAL;/* SET VALUE ENTRY ADDR TO        02421000
*                                      DUMMY AREA                    */ 02422000
         L     @14,MYVAL                                        03S0718 02423000
         ST    @14,USSDB                                        03S0718 02424000
*                         CALL USSMOVE;/* MOVE USER DATA TO COMMAND     02425000
*                                      FIELD IN OUTPUT AREA          */ 02426000
         BAL   @14,USSMOVE                                      03S0719 02427000
*                         USSPB=USSDB;/* SETUP POSTIONAL ENTRY  03S0720 02428000
*                                      POINTER                       */ 02429000
         L     USSPB,USSDB                                      03S0720 02430000
*                         SAVEDB=0; /* CLEAR SAVE ADDRESS            */ 02431000
         SLR   @14,@14                                          03S0721 02432000
         ST    @14,SAVEDB                                       03S0721 02433000
*                       END;                                    03S0722 02434000
*                   END;                                        02S0723 02435000
*                 ELSE                                          02S0724 02436000
*                   EXITCODE=BADPARM;/* SET INVALID POSITIONAL  02S0724 02437000
*                                      PARAMETER RETURN CODE         */ 02438000
         B     @RC00674                                         02S0724 02439000
@RF00674 LA    @14,44                                           02S0724 02440000
         ST    @14,EXITCODE                                     02S0724 02441000
*               END;                                            02S0725 02442000
@RC00674 DS    0H                                               02S0726 02443000
*           END;                                                02S0726 02444000
@RC00667 DS    0H                                               02S0727 02445000
*       END;                                                    02S0727 02446000
@RC00659 DS    0H                                               02S0728 02447000
*   END;                                                        02S0728 02448000
@RT00656 DS    0H                                               02S0728 02449000
@DE00582 TM    USSPTYPE(USSPB),B'01000000'                      02S0728 02450000
         BNO   @DC00582                                         02S0728 02451000
         TM    USSPTYPE(USSPB),B'10100000'                      02S0728 02452000
         BNZ   @DC00582                                         02S0728 02453000
         L     @14,EXITCODE                                     02S0728 02454000
         LTR   @14,@14                                          02S0728 02455000
         BZ    @DL00582                                         02S0728 02456000
@DC00582 DS    0H                                               02S0729 02457000
*   END USSPARM;                                                02S0729 02458000
@EL00005 DS    0H                                               02S0729 02459000
@EF00005 DS    0H                                               02S0729 02460000
@ER00005 L     @14,@SA00005                                     02S0729 02461000
         BR    @14                                              02S0729 02462000
*   END IEDQFM                                                  01S0730 02463000
*                                                               01S0730 02464000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02465000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */ 02466000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 02467000
*/*%INCLUDE SYSLIB  (TCD1D   )                                       */ 02468000
*/*%INCLUDE SYSLIB  (TDCTD   )                                       */ 02469000
*/*%INCLUDE SYSLIB  (TFSSD   )                                       */ 02470000
*/*%INCLUDE SYSLIB  (TLCBD   )                                       */ 02471000
*/*%INCLUDE SYSLIB  (TPRFD   )                                       */ 02472000
*/*%INCLUDE SYSLIB  (TRHD    )                                       */ 02473000
*/*%INCLUDE SYSLIB  (TTHD    )                                       */ 02474000
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */ 02475000
*/*%INCLUDE SYSLIB  (TUSSDD  )                                       */ 02476000
*/*%INCLUDE SYSLIB  (TUSSFD  )                                       */ 02477000
*/*%INCLUDE SYSLIB  (TUSSKD  )                                       */ 02478000
*/*%INCLUDE SYSLIB  (TUSSPD  )                                       */ 02479000
*/*%INCLUDE SYSLIB  (TUSSVD  )                                       */ 02480000
*/*%INCLUDE SYSLIB  (TXNSPD  )                                       */ 02481000
*/*%INCLUDE SYSUT5  (RFY     )                                       */ 02482000
*/*%INCLUDE SYSUT5  (DCL     )                                       */ 02483000
*/*%INCLUDE SYSUT5  (PROCESS )                                       */ 02484000
*/*%INCLUDE SYSUT5  (INITIAL )                                       */ 02485000
*/*%INCLUDE SYSUT5  (USSTRANS)                                       */ 02486000
*/*%INCLUDE SYSUT5  (USSCAN  )                                       */ 02487000
*/*%INCLUDE SYSUT5  (USSVLOOK)                                       */ 02488000
*/*%INCLUDE SYSUT5  (USSDEL  )                                       */ 02489000
*/*%INCLUDE SYSUT5  (USSVERB )                                       */ 02490000
*/*%INCLUDE SYSUT5  (USSNOINP)                                       */ 02491000
*/*%INCLUDE SYSUT5  (USSKEY  )                                       */ 02492000
*/*%INCLUDE SYSUT5  (USSKSRCH)                                       */ 02493000
*/*%INCLUDE SYSUT5  (USSKLOOK)                                       */ 02494000
*/*%INCLUDE SYSUT5  (USSKDEF )                                       */ 02495000
*/*%INCLUDE SYSUT5  (FSSTRANS)                                       */ 02496000
*/*%INCLUDE SYSUT5  (USSDEF  )                                       */ 02497000
*/*%INCLUDE SYSUT5  (USSEOD  )                                       */ 02498000
*/*%INCLUDE SYSUT5  (USSMOVE )                                       */ 02499000
*/*%INCLUDE SYSUT5  (USSPARM )                                       */ 02500000
*/*%INCLUDE SYSUT5  (USSEARCH)                                       */ 02501000
*/*%INCLUDE SYSUT5  (USSDDATA)                                       */ 02502000
*/*%INCLUDE SYSUT5  (USSFDQU )                                       */ 02503000
*/*%INCLUDE SYSUT5  (USSLEFT )                                       */ 02504000
*/*%INCLUDE SYSUT5  (USSRIGHT)                                       */ 02505000
*/*%INCLUDE SYSUT5  (USSETVAL)                                       */ 02506000
*/*%INCLUDE SYSUT5  (USSCONV )                                       */ 02507000
*/*%INCLUDE SYSUT5  (USSBBVAL)                                       */ 02508000
*/*%INCLUDE SYSUT5  (USSREMOV)                                       */ 02509000
*/*%INCLUDE SYSUT5  (USSBCVAL)                                       */ 02510000
*                                                               01S0730 02511000
*       ;                                                       01S0730 02512000
@DATA    DS    0H                                                       02513000
@SX01710 XC    OUTDATA(0,OUTPTR),OUTDATA(OUTPTR)                        02514000
@SC01714 CLC   INDATA-1(0,@08),USSVERB(TABLEPTR)                        02515000
@SM01717 MVC   OUTDATA+1(0,@05),INDATA(@01)                             02516000
@SC01719 CLC   INDATA-1(0,@08),USSKEY(TABLEPTR)                         02517000
@SM01724 MVC   OUTDATA-1(0,@10),FSSMSG(FSSB)                            02518000
@SM01727 MVC   OUTDATA-1(0,@14),USSDREP(@01)                            02519000
@SC01729 CLC   INDATA-1(0,@08),USSDVAL(@14)                             02520000
@SM01731 MVC   0(0,@08),INDATA-1(@02)                                   02521000
@SM01733 MVC   USSDREP(0,@14),0(@02)                                    02522000
         DS    0F                                                       02523000
@SA00005 DS    1F                                                       02524000
@SA00002 DS    1F                                                       02525000
@TF00001 DS    F                                                        02526000
@TF00002 DS    F                                                        02527000
         DS    0F                                                       02528000
@CF01591 DC    F'0'                                                     02529000
@CF00061 DC    F'1'                                                     02530000
@CH00061 EQU   @CF00061+2                                               02531000
@CF00569 DC    F'7'                                                     02532000
@CF00046 DC    F'8'                                                     02533000
@CF00166 DC    F'16'                                                    02534000
@CF01713 DC    F'-8'                                                    02535000
         DS    0D                                                       02536000
IEDQPPTR DS    A                                                        02537000
USSDB    DS    A                                                        02538000
USSKB    DS    A                                                        02539000
USSVB    DS    A                                                        02540000
BINDATA  DS    F                                                        02541000
EXITCODE DC    F'0'                                                     02542000
MYVAL    DC    AL4(BLDVALUE)                                            02543000
SAVEDB   DS    A                                                        02544000
TARGINDX DS    A                                                        02545000
WORK     DS    A                                                        02546000
FSTCHAR  DS    H                                                        02547000
LASTOUT  DS    H                                                        02548000
COUNTER  DS    FL1                                                      02549000
MOVEEND  DS    FL1                                                      02550000
SHIFT    DS    FL1                                                      02551000
@CB00744 DC    X'010604'                                                02552000
BLDVALUE DS    CL259                                                    02553000
         ORG   BLDVALUE                                                 02554000
BLDFLAG  DS    BL1                                                      02555000
BLDDVLEN DC    AL1(0)                                                   02556000
BLDDRLEN DS    FL1                                                      02557000
BLDDREP  DS    CL256                                                    02558000
         ORG   BLDVALUE+259                                             02559000
         DS    CL3                                                      02560000
PACKED   DS    CL8                                                      02561000
UNPACKED DS    CL16                                                     02562000
FOUND    DS    BL1                                                      02563000
IMBEDDED DS    BL1                                                      02564000
KEYWORD  DS    BL1                                                      02565000
MOVED    DS    BL1                                                      02566000
PAREN    DS    BL1                                                      02567000
WKAREA   DS    BL2                                                      02568000
         ORG   WKAREA                                                   02569000
WKAREAC  DS    CL2                                                      02570000
         ORG   WKAREAC                                                  02571000
@NM00176 DS    BL1                                                      02572000
WKAREA1  DS    BL1                                                      02573000
         ORG   WKAREA+2                                                 02574000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02575000
@01      EQU   01                                                       02576000
@02      EQU   02                                                       02577000
@03      EQU   03                                                       02578000
@04      EQU   04                                                       02579000
@05      EQU   05                                                       02580000
@06      EQU   06                                                       02581000
@07      EQU   07                                                       02582000
@08      EQU   08                                                       02583000
@09      EQU   09                                                       02584000
@10      EQU   10                                                       02585000
@11      EQU   11                                                       02586000
@12      EQU   12                                                       02587000
@13      EQU   13                                                       02588000
@14      EQU   14                                                       02589000
@15      EQU   15                                                       02590000
TABLEPTR EQU   @02                                                      02591000
PARM     EQU   @05                                                      02592000
OUTPTR   EQU   @11                                                      02593000
INPTR    EQU   @06                                                      02594000
SCANPTR  EQU   @03                                                      02595000
MOVEOUT  EQU   @08                                                      02596000
MOVECOUN EQU   @08                                                      02597000
MAXFIELD EQU   @08                                                      02598000
LASTIN   EQU   @10                                                      02599000
DELINDEX EQU   @02                                                      02600000
CHARLEN  EQU   @07                                                      02601000
BLDWIDTH EQU   @08                                                      02602000
DCTPTR   EQU   @05                                                      02603000
USSPB    EQU   @05                                                      02604000
IEDQTPTR EQU   @07                                                      02605000
FSSB     EQU   @03                                                      02606000
LCBXPTR  EQU   @05                                                      02607000
RAVT     EQU   @09                                                      02608000
RLCB     EQU   @04                                                      02609000
R0       EQU   @00                                                      02610000
R1       EQU   @01                                                      02611000
RPARM    EQU   @01                                                      02612000
R12      EQU   @12                                                      02613000
RBASE    EQU   @12                                                      02614000
R14      EQU   @14                                                      02615000
RCODE    EQU   @15                                                      02616000
RSAVE    EQU   @13                                                      02617000
R10      EQU   @10                                                      02618000
R11      EQU   @11                                                      02619000
R13      EQU   @13                                                      02620000
R15      EQU   @15                                                      02621000
R2       EQU   @02                                                      02622000
R3       EQU   @03                                                      02623000
R4       EQU   @04                                                      02624000
R5       EQU   @05                                                      02625000
R6       EQU   @06                                                      02626000
R7       EQU   @07                                                      02627000
R8       EQU   @08                                                      02628000
R9       EQU   @09                                                      02629000
IEDQAVTD EQU   0                                                        02630000
AVTSAVEX EQU   IEDQAVTD+288                                             02631000
AVTCSTCS EQU   IEDQAVTD+328                                             02632000
@NM00003 EQU   IEDQAVTD+388                                             02633000
AVTCKFLG EQU   @NM00003                                                 02634000
AVTBASE  EQU   IEDQAVTD+412                                             02635000
AVTPKF   EQU   AVTBASE                                                  02636000
AVTRNMPT EQU   IEDQAVTD+424                                             02637000
AVTUI    EQU   IEDQAVTD+520                                             02638000
AVTHG02  EQU   IEDQAVTD+528                                             02639000
AVTDISP  EQU   IEDQAVTD+552                                             02640000
AVTHD    EQU   IEDQAVTD+556                                             02641000
AVTSCOPT EQU   AVTHD                                                    02642000
AVTSAVTP EQU   IEDQAVTD+612                                             02643000
AVTSAVTF EQU   AVTSAVTP                                                 02644000
AVTCKPEL EQU   IEDQAVTD+652                                             02645000
AVTCKRMV EQU   AVTCKPEL                                                 02646000
AVTCKELF EQU   IEDQAVTD+680                                             02647000
AVTCKBYT EQU   IEDQAVTD+691                                             02648000
AVTHG01  EQU   IEDQAVTD+692                                             02649000
AVTCKLNK EQU   IEDQAVTD+696                                             02650000
AVTCRELE EQU   IEDQAVTD+708                                             02651000
AVTCCELE EQU   AVTCRELE                                                 02652000
AVTCLRHI EQU   IEDQAVTD+716                                             02653000
AVTADBUF EQU   IEDQAVTD+720                                             02654000
AVTSYSER EQU   IEDQAVTD+728                                             02655000
AVTCKPQB EQU   IEDQAVTD+804                                             02656000
AVTCKPTB EQU   AVTCKPQB                                                 02657000
AVTCKPEC EQU   AVTCKPQB+4                                               02658000
AVTCKPCC EQU   AVTCKPEC                                                 02659000
AVTOPCQB EQU   IEDQAVTD+816                                             02660000
AVTOPCOB EQU   AVTOPCQB                                                 02661000
AVTOPCEC EQU   AVTOPCQB+4                                               02662000
AVTOPCCC EQU   AVTOPCEC                                                 02663000
AVTOLTQB EQU   IEDQAVTD+828                                             02664000
AVTCWFL1 EQU   IEDQAVTD+924                                             02665000
AVTCWFL2 EQU   IEDQAVTD+925                                             02666000
AVTSUBT  EQU   IEDQAVTD+948                                             02667000
AVTIOTR  EQU   IEDQAVTD+949                                             02668000
AVTBIT1  EQU   IEDQAVTD+1050                                            02669000
AVTBIT2  EQU   IEDQAVTD+1051                                            02670000
AVTBIT3  EQU   IEDQAVTD+1052                                            02671000
AVTDCTLN EQU   IEDQAVTD+1072                                            02672000
AVTBIT4  EQU   IEDQAVTD+1136                                            02673000
@NM00083 EQU   IEDQAVTD+1232                                            02674000
IEDQAPTR EQU   0                                                        02675000
IEDNSVTD EQU   0                                                        02676000
SAVTDIAG EQU   IEDNSVTD                                                 02677000
SAVTDIAF EQU   SAVTDIAG                                                 02678000
SAVTLUSQ EQU   IEDNSVTD+88                                              02679000
SAVTTCPU EQU   IEDNSVTD+238                                             02680000
SAVTZELM EQU   IEDNSVTD+270                                             02681000
SAVTRDRV EQU   IEDNSVTD+284                                             02682000
SAVTCKQB EQU   IEDNSVTD+300                                             02683000
SAVTCKTB EQU   SAVTCKQB                                                 02684000
SAVTCKEC EQU   SAVTCKQB+4                                               02685000
SAVTCKCC EQU   SAVTCKEC                                                 02686000
IEDDCT   EQU   0                                                        02687000
DCTBYTE1 EQU   IEDDCT+1                                                 02688000
DCTBYTE2 EQU   IEDDCT+2                                                 02689000
DCTBYTE3 EQU   IEDDCT+3                                                 02690000
DCTBYTE4 EQU   IEDDCT+4                                                 02691000
DCTBYTE5 EQU   IEDDCT+5                                                 02692000
DCTSCS   EQU   DCTBYTE5                                                 02693000
DCTL3270 EQU   DCTBYTE5                                                 02694000
IEDFSS   EQU   0                                                        02695000
FSSMSGID EQU   IEDFSS                                                   02696000
FSSADDR  EQU   IEDFSS+1                                                 02697000
FSSLEN   EQU   IEDFSS+5                                                 02698000
FSSMSG   EQU   IEDFSS+6                                                 02699000
IEDQLCB  EQU   0                                                        02700000
LCBRCB   EQU   IEDQLCB                                                  02701000
LCBTSOB  EQU   IEDQLCB+19                                               02702000
LCBCHAIN EQU   IEDQLCB+20                                               02703000
LCBSCRNN EQU   LCBCHAIN                                                 02704000
LCBTETEN EQU   LCBCHAIN                                                 02705000
LCBINSRC EQU   IEDQLCB+21                                               02706000
LCBLKMDE EQU   LCBINSRC+2                                               02707000
LCBNTXT  EQU   IEDQLCB+24                                               02708000
LCBSTAT4 EQU   LCBNTXT                                                  02709000
LCBPHASE EQU   LCBSTAT4                                                 02710000
LCBSCBDA EQU   IEDQLCB+25                                               02711000
LCBMHA   EQU   IEDQLCB+29                                               02712000
LCBFLAG1 EQU   IEDQLCB+32                                               02713000
LCBIOBSN EQU   IEDQLCB+33                                               02714000
LCBSENS0 EQU   LCBIOBSN+1                                               02715000
LCBLOSDT EQU   LCBSENS0                                                 02716000
LCBTMOUT EQU   LCBSENS0                                                 02717000
LCBFLAG3 EQU   LCBIOBSN+7                                               02718000
LCBCSW   EQU   LCBIOBSN+8                                               02719000
LCBCSWST EQU   LCBCSW+3                                                 02720000
LCBCSWUS EQU   LCBCSWST                                                 02721000
LCBCSWCS EQU   LCBCSWST+1                                               02722000
LCBSIOCC EQU   LCBIOBSN+15                                              02723000
LCBDCBPT EQU   IEDQLCB+52                                               02724000
LCBRCQCB EQU   IEDQLCB+56                                               02725000
LCBTHSQ  EQU   IEDQLCB+60                                               02726000
LCBINCAM EQU   LCBTHSQ                                                  02727000
LCBERRCT EQU   IEDQLCB+62                                               02728000
LCBLSPCI EQU   IEDQLCB+65                                               02729000
LCBRCBFR EQU   LCBLSPCI                                                 02730000
LCBSTATE EQU   IEDQLCB+70                                               02731000
LCBSTAT1 EQU   LCBSTATE                                                 02732000
LCBRECVN EQU   LCBSTAT1                                                 02733000
LCBSENDN EQU   LCBSTAT1                                                 02734000
LCBSTAT2 EQU   LCBSTATE+1                                               02735000
LCBBEOTN EQU   LCBSTAT2                                                 02736000
LCBSYNC  EQU   LCBSTAT2                                                 02737000
LCBDIAL  EQU   LCBSTAT2                                                 02738000
LCBTSTSW EQU   IEDQLCB+72                                               02739000
LCBERB   EQU   IEDQLCB+76                                               02740000
LCBERBST EQU   IEDQLCB+84                                               02741000
LCBDLNKN EQU   LCBERBST                                                 02742000
LCBERBCT EQU   IEDQLCB+88                                               02743000
LCBRBCT2 EQU   LCBERBCT+1                                               02744000
LCBMSGFM EQU   IEDQLCB+92                                               02745000
LCBOBRCH EQU   IEDQLCB+96                                               02746000
LCBINVPT EQU   LCBOBRCH+1                                               02747000
LCBBFRW  EQU   LCBINVPT                                                 02748000
LCBTPCD  EQU   IEDQLCB+100                                              02749000
LCBSTAT5 EQU   LCBTPCD                                                  02750000
LCBSTAT6 EQU   LCBTPCD+4                                                02751000
LCBRSPSV EQU   LCBTPCD+8                                                02752000
LCBSAVSN EQU   IEDQLCB+112                                              02753000
LCBERCCW EQU   IEDQLCB+120                                              02754000
LCBCPA   EQU   IEDQLCB+144                                              02755000
IEDQLPTR EQU   0                                                        02756000
IEDQLCBX EQU   0                                                        02757000
LCBXCON  EQU   IEDQLCBX                                                 02758000
LCBXFLAG EQU   LCBXCON                                                  02759000
LCBXDCT  EQU   LCBXCON+1                                                02760000
LCBXRADR EQU   LCBXCON+4                                                02761000
IEDQPRF  EQU   0                                                        02762000
PRFRCB   EQU   IEDQPRF                                                  02763000
PRFKEY   EQU   PRFRCB                                                   02764000
PRFQCBA  EQU   PRFRCB+1                                                 02765000
PRFPRI   EQU   PRFRCB+4                                                 02766000
PRFLINK  EQU   PRFRCB+5                                                 02767000
PRFTIC   EQU   IEDQPRF+8                                                02768000
PRFTICC  EQU   PRFTIC                                                   02769000
PRFNBUNT EQU   IEDQPRF+12                                               02770000
PRFSUNIT EQU   PRFNBUNT                                                 02771000
PRFPLQCB EQU   PRFSUNIT                                                 02772000
@NM00149 EQU   IEDQPRF+16                                               02773000
PRFSVFFO EQU   @NM00149                                                 02774000
PRFSTAT1 EQU   IEDQPRF+20                                               02775000
PRFEOFN  EQU   PRFSTAT1                                                 02776000
PRFCORE  EQU   IEDQPRF+21                                               02777000
PRFXTRA  EQU   PRFCORE                                                  02778000
PRFSCAN  EQU   IEDQPRF+24                                               02779000
PRFTQBCK EQU   IEDQPRF+26                                               02780000
PRFNTXT  EQU   PRFTQBCK                                                 02781000
PRFEOBOF EQU   PRFNTXT                                                  02782000
PRFCHDR  EQU   IEDQPRF+32                                               02783000
PRFHQBCK EQU   IEDQPRF+35                                               02784000
PRFDEST  EQU   IEDQPRF+40                                               02785000
IEDPF1   EQU   0                                                        02786000
PRF1FLG1 EQU   IEDPF1+3                                                 02787000
PRF1USS  EQU   PRF1FLG1                                                 02788000
PRF1WD2  EQU   IEDPF1+4                                                 02789000
PRF1SEQP EQU   PRF1WD2                                                  02790000
PRF1SQID EQU   PRF1SEQP                                                 02791000
PRF1TAG1 EQU   PRF1SQID                                                 02792000
IEDPF2   EQU   0                                                        02793000
PRF2FLG2 EQU   IEDPF2                                                   02794000
PRF2WD2  EQU   IEDPF2+4                                                 02795000
IEDRH    EQU   0                                                        02796000
TRHBYTE0 EQU   IEDRH                                                    02797000
TRHFI    EQU   TRHBYTE0                                                 02798000
TRHBYTE1 EQU   IEDRH+1                                                  02799000
TRHBYTE2 EQU   IEDRH+2                                                  02800000
IEDTH    EQU   0                                                        02801000
TTHBYTE0 EQU   IEDTH                                                    02802000
TTHSNF   EQU   IEDTH+6                                                  02803000
TTHTAG   EQU   TTHSNF                                                   02804000
TTHTAG1  EQU   TTHTAG                                                   02805000
IEDQTRM  EQU   0                                                        02806000
TRMSTATE EQU   IEDQTRM                                                  02807000
TRMLOG   EQU   TRMSTATE                                                 02808000
TRMINSEQ EQU   IEDQTRM+4                                                02809000
TLISTCNT EQU   TRMINSEQ                                                 02810000
TRMOUTSQ EQU   IEDQTRM+6                                                02811000
TLISTEN  EQU   TRMOUTSQ                                                 02812000
TRMDSORG EQU   TLISTEN                                                  02813000
TRMALTD  EQU   IEDQTRM+8                                                02814000
TRMDEVFL EQU   IEDQTRM+10                                               02815000
TRMSTAT  EQU   IEDQTRM+12                                               02816000
TRMCHCIN EQU   IEDQTRM+16                                               02817000
IEDNTRM  EQU   0                                                        02818000
TRMBYTE4 EQU   IEDNTRM                                                  02819000
TRMBYTE3 EQU   IEDNTRM+1                                                02820000
TRMBYTE2 EQU   IEDNTRM+2                                                02821000
TRMINPG  EQU   TRMBYTE2                                                 02822000
TRMBYTE1 EQU   IEDNTRM+3                                                02823000
TRMSCPRQ EQU   TRMBYTE1                                                 02824000
TRMBYTE0 EQU   IEDNTRM+6                                                02825000
TRMSIBPT EQU   IEDNTRM+7                                                02826000
IEDUSSD  EQU   0                                                        02827000
USSDFLAG EQU   IEDUSSD                                                  02828000
USSDTYPE EQU   USSDFLAG                                                 02829000
USSDVLEN EQU   IEDUSSD+1                                                02830000
USSDRLEN EQU   IEDUSSD+2                                                02831000
USSDVAL  EQU   IEDUSSD+3                                                02832000
IEDUSSF  EQU   0                                                        02833000
USSFLAG  EQU   IEDUSSF                                                  02834000
IEDUSSK  EQU   0                                                        02835000
USSKFLAG EQU   IEDUSSK                                                  02836000
USSKFMT  EQU   USSKFLAG                                                 02837000
USSKADDR EQU   IEDUSSK+1                                                02838000
USSKLEN  EQU   IEDUSSK+5                                                02839000
USSKEY   EQU   IEDUSSK+6                                                02840000
IEDUSSP  EQU   0                                                        02841000
USSPFLAG EQU   IEDUSSP                                                  02842000
USSPTYPE EQU   USSPFLAG                                                 02843000
USSPPFLG EQU   IEDUSSP+1                                                02844000
USSPREQ  EQU   USSPPFLG                                                 02845000
USSPNOIN EQU   USSPPFLG                                                 02846000
USSPINS  EQU   USSPPFLG                                                 02847000
USSPDATA EQU   USSPPFLG                                                 02848000
USSPBYTE EQU   IEDUSSP+2                                                02849000
USSPBIT  EQU   IEDUSSP+3                                                02850000
USSPLEN  EQU   IEDUSSP+4                                                02851000
IEDUSSV  EQU   0                                                        02852000
USSVFLAG EQU   IEDUSSV                                                  02853000
USSVADDR EQU   IEDUSSV+1                                                02854000
USSVKADD EQU   IEDUSSV+5                                                02855000
USSVSSCP EQU   IEDUSSV+9                                                02856000
USSVADD  EQU   IEDUSSV+12                                               02857000
USSVDEL  EQU   IEDUSSV+13                                               02858000
USSVDLEN EQU   IEDUSSV+14                                               02859000
USSVDISP EQU   IEDUSSV+15                                               02860000
USSVLEN  EQU   IEDUSSV+16                                               02861000
USSVERB  EQU   IEDUSSV+17                                               02862000
IEDXNSPD EQU   0                                                        02863000
XNSPCMD  EQU   IEDXNSPD                                                 02864000
XNSPCODE EQU   XNSPCMD                                                  02865000
XNSPRSN  EQU   XNSPCMD+3                                                02866000
XNSPPLUN EQU   XNSPCMD+4                                                02867000
XNSPSLUN EQU   XNSPCMD+14                                               02868000
XNSPPTR  EQU   0                                                        02869000
INBUFFER EQU   0                                                        02870000
INPRF    EQU   INBUFFER                                                 02871000
INDATLEN EQU   INPRF+2                                                  02872000
INDATA   EQU   INBUFFER+6                                               02873000
OUTBUFFR EQU   0                                                        02874000
OUTPRF   EQU   OUTBUFFR                                                 02875000
OUTWKLN  EQU   OUTPRF                                                   02876000
OUTDATLN EQU   OUTPRF+2                                                 02877000
OUTDATA  EQU   OUTBUFFR+6                                               02878000
PRMLIST  EQU   0                                                        02879000
PRMTABLE EQU   PRMLIST+4                                                02880000
PRMINBFR EQU   PRMLIST+8                                                02881000
PRMOUTBF EQU   PRMLIST+12                                               02882000
IEDQTNT  EQU   0                                                        02883000
LCBRSPIN EQU   LCBIOBSN                                                 02884000
LCBLUSNS EQU   LCBRSPIN+5                                               02885000
LCBSCPRS EQU   LCBRSPIN+9                                               02886000
LCBCSWU1 EQU   LCBSCPRS+2                                               02887000
LCBRSPFG EQU   LCBRSPIN+15                                              02888000
LCBCOREQ EQU   LCBTPCD                                                  02889000
@NM00130 EQU   LCBCPA+40                                                02890000
LCBQNX   EQU   LCBERCCW                                                 02891000
LCBQNXMN EQU   LCBQNX                                                   02892000
LCBCANCL EQU   LCBSAVSN                                                 02893000
LCBCANFG EQU   LCBCANCL                                                 02894000
TRMPRE1  EQU   TRMBYTE4                                                 02895000
TRMNCP1  EQU   TRMBYTE4                                                 02896000
TRMPRE   EQU   TRMBYTE3                                                 02897000
TRMNCP   EQU   TRMBYTE3                                                 02898000
TRMPU    EQU   TRMBYTE3                                                 02899000
TRMLU    EQU   TRMBYTE3                                                 02900000
TRMLINK  EQU   TRMBYTE3                                                 02901000
USSDREP  EQU   USSDVAL                                                  02902000
BINDATAC EQU   BINDATA                                                  02903000
CHARMLEN EQU   CHARLEN                                                  02904000
PRFSHDR  EQU   IEDQPRF+42                                               02905000
TRMOPT   EQU   IEDQTRM+20                                               02906000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02907000
@NM00171 EQU   TRMLINK                                                  02908000
TRMLSTAT EQU   TRMLINK                                                  02909000
TRMLINT  EQU   TRMLINK                                                  02910000
TRMEPMOD EQU   TRMLINK                                                  02911000
TRMLULOG EQU   TRMLU                                                    02912000
TRMINERR EQU   TRMLU                                                    02913000
TRMLUREQ EQU   TRMLU                                                    02914000
TRMSESRQ EQU   TRMLU                                                    02915000
TRMTDIFF EQU   TRMLU                                                    02916000
TRMLUTM  EQU   TRMLU                                                    02917000
TRMLUIT  EQU   TRMLU                                                    02918000
TRMAUTO  EQU   TRMLU                                                    02919000
TRMPCONT EQU   TRMPU                                                    02920000
@NM00170 EQU   TRMPU                                                    02921000
TRMNCONT EQU   TRMNCP                                                   02922000
TRMQUCKN EQU   TRMNCP                                                   02923000
TRMSLOWN EQU   TRMNCP                                                   02924000
TRMSYGEN EQU   TRMNCP                                                   02925000
TRMNCPCL EQU   TRMNCP                                                   02926000
TRMIPLDM EQU   TRMNCP                                                   02927000
TRMINOUT EQU   TRMPRE                                                   02928000
TRMRDOUT EQU   TRMPRE                                                   02929000
TRMNLOUT EQU   TRMPRE                                                   02930000
TRMWROUT EQU   TRMPRE                                                   02931000
TRMASNXI EQU   TRMPRE                                                   02932000
TRMSTMM  EQU   TRMPRE                                                   02933000
TRMCMODE EQU   TRMPRE                                                   02934000
TRMSTPND EQU   TRMPRE                                                   02935000
@NM00169 EQU   TRMNCP1                                                  02936000
TRMINOP  EQU   TRMNCP1                                                  02937000
TRMLYNCH EQU   TRMPRE1                                                  02938000
TRMSPOUT EQU   TRMPRE1                                                  02939000
TRMERLCK EQU   TRMPRE1                                                  02940000
TRMQNPL  EQU   TRMPRE1                                                  02941000
TRMSPACT EQU   TRMPRE1                                                  02942000
TRMOCNI  EQU   TRMPRE1                                                  02943000
TRMSESSN EQU   TRMPRE1                                                  02944000
TRMCONT  EQU   TRMPRE1                                                  02945000
@NM00137 EQU   LCBCANCL+3                                               02946000
LCBCANTH EQU   LCBCANCL+1                                               02947000
@NM00136 EQU   LCBCANFG                                                 02948000
LCBCANCD EQU   LCBCANFG                                                 02949000
@NM00135 EQU   LCBCANFG                                                 02950000
LCBCANEB EQU   LCBCANFG                                                 02951000
LCBCANXT EQU   LCBCANFG                                                 02952000
LCBUNADD EQU   LCBQNX+21                                                02953000
LCBUASZE EQU   LCBQNX+20                                                02954000
LCBDSTEA EQU   LCBQNX+16                                                02955000
@NM00134 EQU   LCBQNX+4                                                 02956000
LCBSTSAV EQU   LCBQNX+1                                                 02957000
@NM00133 EQU   LCBQNXMN                                                 02958000
LCBNX509 EQU   LCBQNXMN                                                 02959000
LCBNX162 EQU   LCBQNXMN                                                 02960000
LCBNX142 EQU   LCBQNXMN                                                 02961000
LCBNX064 EQU   LCBQNXMN                                                 02962000
@NM00132 EQU   @NM00130+4                                               02963000
LCBNCPPT EQU   @NM00130+1                                               02964000
@NM00131 EQU   @NM00130                                                 02965000
LCBWRSCH EQU   LCBCOREQ+8                                               02966000
LCBCQLNK EQU   LCBCOREQ+4                                               02967000
LCBCQELE EQU   LCBCOREQ                                                 02968000
LCBPAKCH EQU   LCBRSPIN+16                                              02969000
@NM00129 EQU   LCBRSPFG                                                 02970000
LCBRSRH  EQU   LCBRSPFG                                                 02971000
LCBEXPI  EQU   LCBRSPFG                                                 02972000
@NM00128 EQU   LCBRSPIN+12                                              02973000
LCBUSUE1 EQU   LCBCSWU1                                                 02974000
@NM00127 EQU   LCBCSWU1                                                 02975000
@NM00126 EQU   LCBSCPRS+1                                               02976000
LCBDFCMD EQU   LCBSCPRS                                                 02977000
LCBUSER  EQU   LCBLUSNS+2                                               02978000
LCBSMIN  EQU   LCBLUSNS+1                                               02979000
LCBSMAJ  EQU   LCBLUSNS                                                 02980000
LCBRHSV  EQU   LCBRSPIN+2                                               02981000
LCBSNS0  EQU   LCBRSPIN+1                                               02982000
@NM00125 EQU   LCBRSPIN                                                 02983000
@NM00175 EQU   PRMLIST+3                                                02984000
PRM2IDX  EQU   PRMLIST+2                                                02985000
PRMLEN   EQU   PRMLIST+1                                                02986000
PRMMHIDX EQU   PRMLIST                                                  02987000
@NM00174 EQU   OUTPRF+4                                                 02988000
INUNRES  EQU   INPRF+5                                                  02989000
INSTAT   EQU   INPRF+4                                                  02990000
INWKLEN  EQU   INPRF                                                    02991000
XNSPSNME EQU   XNSPSLUN+2                                               02992000
XNSPSLEN EQU   XNSPSLUN+1                                               02993000
XNSPSTYP EQU   XNSPSLUN                                                 02994000
XNSPPNME EQU   XNSPPLUN+2                                               02995000
XNSPPLEN EQU   XNSPPLUN+1                                               02996000
XNSPPTYP EQU   XNSPPLUN                                                 02997000
XNSPREQ  EQU   XNSPCODE+2                                               02998000
XNSPSESS EQU   XNSPCODE+1                                               02999000
XNSPNETS EQU   XNSPCODE                                                 03000000
USSVFMT  EQU   USSVFLAG                                                 03001000
USSVTYPE EQU   USSVFLAG                                                 03002000
@NM00173 EQU   USSPPFLG                                                 03003000
USSPFMT  EQU   USSPFLAG                                                 03004000
USSKTYPE EQU   USSKFLAG                                                 03005000
@NM00172 EQU   USSFLAG                                                  03006000
USSFFMT  EQU   USSFLAG                                                  03007000
USSFTYPE EQU   USSFLAG                                                  03008000
USSDFMT  EQU   USSDFLAG                                                 03009000
TRMSUBST EQU   IEDNTRM+12                                               03010000
TRMTYPE  EQU   IEDNTRM+11                                               03011000
TRMRLMCT EQU   IEDNTRM+10                                               03012000
TRMCOHTG EQU   TRMSIBPT+1                                               03013000
TRMGPCNT EQU   TRMSIBPT                                                 03014000
TRMBUFRD EQU   TRMBYTE0                                                 03015000
TRMSNA   EQU   TRMBYTE0                                                 03016000
TRMGP    EQU   TRMBYTE0                                                 03017000
TRMDIAL  EQU   TRMBYTE0                                                 03018000
@NM00168 EQU   TRMBYTE0                                                 03019000
TRMOUTPT EQU   TRMBYTE0                                                 03020000
TRMINPUT EQU   TRMBYTE0                                                 03021000
TRMUDEF  EQU   TRMBYTE0                                                 03022000
TRMCOHRT EQU   IEDNTRM+4                                                03023000
TRMSTOTE EQU   TRMBYTE1                                                 03024000
TRMCKPRN EQU   TRMBYTE1                                                 03025000
TRMTSATN EQU   TRMBYTE1                                                 03026000
TRMTRACE EQU   TRMBYTE1                                                 03027000
TRMSWBCK EQU   TRMBYTE1                                                 03028000
TRMAUTOC EQU   TRMBYTE1                                                 03029000
TRMINPTP EQU   TRMBYTE1                                                 03030000
TRMWTNEG EQU   TRMSCPRQ                                                 03031000
TRMWRBRK EQU   TRMBYTE2                                                 03032000
TRMNOSND EQU   TRMBYTE2                                                 03033000
TRMPREP  EQU   TRMBYTE2                                                 03034000
TRMGPACT EQU   TRMBYTE2                                                 03035000
TRMANDL  EQU   TRMBYTE2                                                 03036000
TRMCLOSN EQU   TRMINPG                                                  03037000
TRMREMB  EQU   TRMBYTE2                                                 03038000
TRMRSACT EQU   TRMBYTE2                                                 03039000
TRMOPTBL EQU   IEDQTRM+18                                               03040000
TRMOPNO  EQU   IEDQTRM+17                                               03041000
TRMSENSE EQU   TRMSTAT+3                                                03042000
TRMTEMPR EQU   TRMSTAT+2                                                03043000
TRMSIO   EQU   TRMSTAT                                                  03044000
@NM00167 EQU   TRMDEVFL+1                                               03045000
TRMTPIN  EQU   TRMDEVFL+1                                               03046000
TRMNCPI  EQU   TRMDEVFL+1                                               03047000
TRMRNTRM EQU   TRMDEVFL+1                                               03048000
@NM00166 EQU   TRMDEVFL+1                                               03049000
TRMLMD   EQU   TRMDEVFL+1                                               03050000
TRMCONC  EQU   TRMDEVFL+1                                               03051000
TRMTSOB  EQU   TRMDEVFL                                                 03052000
TRMBFDY  EQU   TRMDEVFL                                                 03053000
TRMTBLK  EQU   TRMDEVFL                                                 03054000
TRMSBLK  EQU   TRMDEVFL                                                 03055000
TRMBLKS  EQU   TRMDEVFL                                                 03056000
TRMADDC  EQU   TRMDEVFL                                                 03057000
TRMDDIG  EQU   TRMDEVFL                                                 03058000
TRMBUFS  EQU   TRMDEVFL                                                 03059000
TRMPRILK EQU   TRMALTD                                                  03060000
TRMLGB   EQU   TRMDSORG                                                 03061000
TRMUTERM EQU   TLISTCNT                                                 03062000
TRMDESTQ EQU   IEDQTRM+1                                                03063000
TRMSCNYN EQU   TRMSTATE                                                 03064000
TRMOPTFN EQU   TRMSTATE                                                 03065000
TRMHELDN EQU   TRMSTATE                                                 03066000
TRMACPTN EQU   TRMSTATE                                                 03067000
TRMPREF  EQU   TRMSTATE                                                 03068000
TRMPROC  EQU   TRMLOG                                                   03069000
TRMLIST  EQU   TRMLOG                                                   03070000
TRMLINE  EQU   TRMSTATE                                                 03071000
TTHDCF   EQU   IEDTH+8                                                  03072000
TTHTAG2  EQU   TTHTAG+1                                                 03073000
@NM00165 EQU   TTHTAG1                                                  03074000
TTHTAGS  EQU   TTHTAG1                                                  03075000
TTHOAF   EQU   IEDTH+4                                                  03076000
TTHDAF   EQU   IEDTH+2                                                  03077000
TTHBYTE1 EQU   IEDTH+1                                                  03078000
TTHEFI   EQU   TTHBYTE0                                                 03079000
@NM00164 EQU   TTHBYTE0                                                 03080000
TTHEBIU  EQU   TTHBYTE0                                                 03081000
TTHBBIU  EQU   TTHBYTE0                                                 03082000
TTHFTYPE EQU   TTHBYTE0                                                 03083000
@NM00163 EQU   TRHBYTE2                                                 03084000
@NM00162 EQU   TRHBYTE2                                                 03085000
@NM00161 EQU   TRHBYTE2                                                 03086000
TRHCSI   EQU   TRHBYTE2                                                 03087000
@NM00160 EQU   TRHBYTE2                                                 03088000
TRHCDI   EQU   TRHBYTE2                                                 03089000
TRHEB    EQU   TRHBYTE2                                                 03090000
TRHBB    EQU   TRHBYTE2                                                 03091000
TRHPI    EQU   TRHBYTE1                                                 03092000
@NM00159 EQU   TRHBYTE1                                                 03093000
@NM00158 EQU   TRHBYTE1                                                 03094000
@NM00157 EQU   TRHBYTE1                                                 03095000
TRHER    EQU   TRHBYTE1                                                 03096000
TRHDR2   EQU   TRHBYTE1                                                 03097000
@NM00156 EQU   TRHBYTE1                                                 03098000
TRHDR1   EQU   TRHBYTE1                                                 03099000
TRHEC    EQU   TRHBYTE0                                                 03100000
TRHBC    EQU   TRHBYTE0                                                 03101000
TRHSDI   EQU   TRHBYTE0                                                 03102000
@NM00155 EQU   TRHBYTE0                                                 03103000
TRHRUCAT EQU   TRHBYTE0                                                 03104000
TRHTYPE  EQU   TRHBYTE0                                                 03105000
PRF2SEQP EQU   PRF2WD2                                                  03106000
@NM00154 EQU   IEDPF2+1                                                 03107000
@NM00153 EQU   PRF2FLG2                                                 03108000
PRF2SMI  EQU   PRF2FLG2                                                 03109000
PRF2FORM EQU   PRF2FLG2                                                 03110000
PRF2TNTI EQU   PRF2FLG2                                                 03111000
PRF1RULN EQU   PRF1SEQP+2                                               03112000
PRF1TAG2 EQU   PRF1SQID+1                                               03113000
@NM00152 EQU   PRF1TAG1                                                 03114000
PRF1TAGS EQU   PRF1TAG1                                                 03115000
@NM00151 EQU   PRF1FLG1                                                 03116000
PRF1LOGD EQU   PRF1FLG1                                                 03117000
PRF1FORM EQU   PRF1FLG1                                                 03118000
PRF1EXPI EQU   PRF1FLG1                                                 03119000
PRF1FIDI EQU   PRF1FLG1                                                 03120000
PRF1RH   EQU   IEDPF1                                                   03121000
PRFISEQ  EQU   IEDQPRF+38                                               03122000
PRFSTXT  EQU   PRFHQBCK                                                 03123000
PRFNHDR  EQU   PRFCHDR                                                  03124000
PRFCRCD  EQU   IEDQPRF+29                                               03125000
PRFSVSEQ EQU   PRFNTXT+1                                                03126000
PRFSVPRI EQU   PRFEOBOF                                                 03127000
PRFISIZE EQU   PRFSCAN+1                                                03128000
@NM00150 EQU   PRFSCAN                                                  03129000
PRFEOB   EQU   PRFXTRA+1                                                03130000
PRFSTSO  EQU   PRFXTRA                                                  03131000
PRFNHDRN EQU   PRFSTAT1                                                 03132000
PRFNLSTN EQU   PRFSTAT1                                                 03133000
PRFLOCK  EQU   PRFEOFN                                                  03134000
PRFDUPLN EQU   PRFSTAT1                                                 03135000
PRFTSMSG EQU   PRFSTAT1                                                 03136000
PRFITCPN EQU   PRFSTAT1                                                 03137000
PRFERMGN EQU   PRFSTAT1                                                 03138000
PRFCNCLN EQU   PRFSTAT1                                                 03139000
PRFSVFLG EQU   @NM00149+3                                               03140000
PRFSIZE  EQU   PRFSVFFO+2                                               03141000
PRFSRCE  EQU   PRFSVFFO                                                 03142000
PRFLCB   EQU   IEDQPRF+13                                               03143000
PRFPIUO  EQU   PRFPLQCB                                                 03144000
PRFTI0   EQU   PRFTIC+1                                                 03145000
@NM00148 EQU   PRFTICC                                                  03146000
@NM00147 EQU   PRFTICC                                                  03147000
@NM00146 EQU   PRFTICC                                                  03148000
PRFTICON EQU   PRFTICC                                                  03149000
@NM00145 EQU   PRFTICC                                                  03150000
@NM00144 EQU   PRFTICC                                                  03151000
PRFBFMM  EQU   PRFTICC                                                  03152000
PRFEOMSG EQU   PRFTICC                                                  03153000
PRFCOUNT EQU   PRFLINK+1                                                03154000
@NM00143 EQU   PRFLINK                                                  03155000
PRFFLAGS EQU   PRFPRI                                                   03156000
PRFIOADR EQU   PRFQCBA                                                  03157000
PRFOPCDE EQU   PRFKEY                                                   03158000
LCBERADR EQU   LCBXRADR+1                                               03159000
LCBPCIRC EQU   LCBXRADR                                                 03160000
LCBDCT3  EQU   LCBXDCT+2                                                03161000
LCBDCT2  EQU   LCBXDCT+1                                                03162000
LCBDCT1  EQU   LCBXDCT                                                  03163000
@NM00142 EQU   LCBXFLAG                                                 03164000
LCBERPND EQU   LCBXFLAG                                                 03165000
LCBSRCPF EQU   LCBXFLAG                                                 03166000
LCBGPCTV EQU   LCBXFLAG                                                 03167000
@NM00141 EQU   LCBXFLAG                                                 03168000
@NM00140 EQU   LCBXFLAG                                                 03169000
@NM00139 EQU   LCBXFLAG                                                 03170000
@NM00138 EQU   LCBXFLAG                                                 03171000
LCBCCW10 EQU   LCBCPA+72                                                03172000
LCBCCW9  EQU   LCBCPA+64                                                03173000
LCBCCW8  EQU   LCBCPA+56                                                03174000
LCBCCW7  EQU   LCBCPA+48                                                03175000
LCBCCW6  EQU   LCBCPA+40                                                03176000
LCBCCW5  EQU   LCBCPA+32                                                03177000
LCBCCW4  EQU   LCBCPA+24                                                03178000
LCBCCW3  EQU   LCBCPA+16                                                03179000
LCBCCW2  EQU   LCBCPA+8                                                 03180000
LCBCCW1  EQU   LCBCPA                                                   03181000
@NM00124 EQU   LCBERCCW                                                 03182000
LCBCSWSV EQU   LCBSAVSN+1                                               03183000
LCBSNSV  EQU   LCBSAVSN                                                 03184000
LCBBFSNS EQU   LCBRSPSV                                                 03185000
LCBWAITC EQU   LCBTPCD+5                                                03186000
LCBINPAK EQU   LCBSTAT6                                                 03187000
LCBMHBID EQU   LCBSTAT6                                                 03188000
LCBRTRRO EQU   LCBSTAT6                                                 03189000
LCBHDRPD EQU   LCBSTAT6                                                 03190000
LCBCHN   EQU   LCBSTAT6                                                 03191000
LCBBFRSV EQU   LCBTPCD+1                                                03192000
@NM00123 EQU   LCBSTAT5                                                 03193000
LCBLUS   EQU   LCBSTAT5                                                 03194000
LCBLUNIT EQU   LCBSTAT5                                                 03195000
LCBPERM  EQU   LCBSTAT5                                                 03196000
LCBNXCMD EQU   LCBBFRW                                                  03197000
LCBERMSK EQU   LCBOBRCH                                                 03198000
LCBSCBA  EQU   IEDQLCB+93                                               03199000
LCBOLT   EQU   LCBMSGFM                                                 03200000
LCBEOT   EQU   LCBMSGFM                                                 03201000
LCBENQ   EQU   LCBMSGFM                                                 03202000
LCBTTD   EQU   LCBMSGFM                                                 03203000
LCBRSTRT EQU   LCBMSGFM                                                 03204000
LCBVSTRT EQU   LCBMSGFM                                                 03205000
LCBACKI  EQU   LCBMSGFM                                                 03206000
LCBNAK   EQU   LCBMSGFM                                                 03207000
LCBTTCIN EQU   IEDQLCB+90                                               03208000
@NM00122 EQU   LCBRBCT2                                                 03209000
LCBDCNT  EQU   LCBRBCT2                                                 03210000
LCBRBCT1 EQU   LCBERBCT                                                 03211000
LCBERBCH EQU   IEDQLCB+85                                               03212000
LCBCOMPL EQU   LCBDLNKN                                                 03213000
LCBPRCPG EQU   LCBERBST                                                 03214000
LCBERROR EQU   LCBERBST                                                 03215000
@NM00121 EQU   LCBERBST                                                 03216000
LCBINQ   EQU   LCBERBST                                                 03217000
LCBRDERR EQU   LCBERBST                                                 03218000
LCBEOMSG EQU   LCBERBST                                                 03219000
LCBMSG   EQU   LCBERBST                                                 03220000
LCBERBLK EQU   IEDQLCB+81                                               03221000
LCBERBPY EQU   IEDQLCB+80                                               03222000
LCBERBQB EQU   LCBERB+1                                                 03223000
LCBERBKY EQU   LCBERB                                                   03224000
LCBRECAD EQU   IEDQLCB+73                                               03225000
@NM00120 EQU   LCBTSTSW                                                 03226000
@NM00119 EQU   LCBTSTSW                                                 03227000
@NM00118 EQU   LCBTSTSW                                                 03228000
@NM00117 EQU   LCBTSTSW                                                 03229000
@NM00116 EQU   LCBTSTSW                                                 03230000
@NM00115 EQU   LCBTSTSW                                                 03231000
@NM00114 EQU   LCBTSTSW                                                 03232000
LCBCONCT EQU   LCBTSTSW                                                 03233000
LCBRESP  EQU   LCBSTAT2                                                 03234000
LCBBFRAV EQU   LCBDIAL                                                  03235000
LCBATTN  EQU   LCBSYNC                                                  03236000
LCBNEGRP EQU   LCBSTAT2                                                 03237000
LCBSNDPR EQU   LCBSTAT2                                                 03238000
LCBCONNN EQU   LCBBEOTN                                                 03239000
LCBMSGNN EQU   LCBSTAT2                                                 03240000
LCBTRACE EQU   LCBSTAT2                                                 03241000
LCBFREEN EQU   LCBSTAT1                                                 03242000
LCBCONT  EQU   LCBSTAT1                                                 03243000
LCBINITN EQU   LCBSTAT1                                                 03244000
LCBOCNI  EQU   LCBSTAT1                                                 03245000
LCBOCWTN EQU   LCBSTAT1                                                 03246000
LCBRCLLN EQU   LCBSTAT1                                                 03247000
LCBRECOF EQU   IEDQLCB+68                                               03248000
LCBRDBFR EQU   LCBRCBFR                                                 03249000
LCBUCBX  EQU   IEDQLCB+64                                               03250000
LCBTTBIN EQU   LCBERRCT                                                 03251000
@NM00113 EQU   LCBINCAM                                                 03252000
LCBGETMN EQU   LCBINCAM                                                 03253000
LCBRESTR EQU   LCBRCQCB                                                 03254000
LCBPCILK EQU   LCBDCBPT                                                 03255000
LCBSTART EQU   LCBIOBSN+16                                              03256000
LCBAP4OL EQU   LCBSIOCC                                                 03257000
LCBAP3OL EQU   LCBSIOCC                                                 03258000
LCBAP2OL EQU   LCBSIOCC                                                 03259000
LCBAP1OL EQU   LCBSIOCC                                                 03260000
LCBSIOC2 EQU   LCBSIOCC                                                 03261000
LCBSIOC1 EQU   LCBSIOCC                                                 03262000
@NM00112 EQU   LCBSIOCC                                                 03263000
LCBCSWRC EQU   LCBCSW+5                                                 03264000
LCBCSCHC EQU   LCBCSWCS                                                 03265000
LCBCSICC EQU   LCBCSWCS                                                 03266000
LCBCSCCC EQU   LCBCSWCS                                                 03267000
LCBCSCDC EQU   LCBCSWCS                                                 03268000
LCBCSPTC EQU   LCBCSWCS                                                 03269000
LCBCSPGC EQU   LCBCSWCS                                                 03270000
LCBCSIL  EQU   LCBCSWCS                                                 03271000
LCBCSPCI EQU   LCBCSWCS                                                 03272000
LCBUSUE  EQU   LCBCSWUS                                                 03273000
LCBUSUC  EQU   LCBCSWUS                                                 03274000
LCBUSDE  EQU   LCBCSWUS                                                 03275000
LCBUSCE  EQU   LCBCSWUS                                                 03276000
LCBUSBSY EQU   LCBCSWUS                                                 03277000
LCBUSCUE EQU   LCBCSWUS                                                 03278000
LCBUSSM  EQU   LCBCSWUS                                                 03279000
LCBUSAT  EQU   LCBCSWUS                                                 03280000
LCBCSWCA EQU   LCBCSW                                                   03281000
LCBOBR   EQU   LCBFLAG3                                                 03282000
LCBOBRRD EQU   LCBFLAG3                                                 03283000
LCBIOMSG EQU   LCBFLAG3                                                 03284000
LCBSOHC  EQU   LCBFLAG3                                                 03285000
LCBRLAD  EQU   LCBFLAG3                                                 03286000
LCBSOHR  EQU   LCBFLAG3                                                 03287000
@NM00111 EQU   LCBFLAG3                                                 03288000
LCBECBPT EQU   LCBIOBSN+4                                               03289000
LCBECBCC EQU   LCBIOBSN+3                                               03290000
LCBSENS1 EQU   LCBIOBSN+2                                               03291000
LCBABORT EQU   LCBTMOUT                                                 03292000
LCBNOTIN EQU   LCBLOSDT                                                 03293000
LCBOVRUN EQU   LCBSENS0                                                 03294000
LCBDATCK EQU   LCBSENS0                                                 03295000
LCBEQUCK EQU   LCBSENS0                                                 03296000
LCBBUSCK EQU   LCBSENS0                                                 03297000
LCBINTRQ EQU   LCBSENS0                                                 03298000
LCBCMDRJ EQU   LCBSENS0                                                 03299000
LCBFLAG2 EQU   LCBIOBSN                                                 03300000
@NM00110 EQU   LCBFLAG1                                                 03301000
LCBUNREL EQU   LCBFLAG1                                                 03302000
LCBEXCPN EQU   LCBFLAG1                                                 03303000
@NM00109 EQU   LCBFLAG1                                                 03304000
LCBERPIN EQU   LCBFLAG1                                                 03305000
@NM00108 EQU   LCBFLAG1                                                 03306000
LCBFSBFR EQU   LCBMHA                                                   03307000
LCBISZE  EQU   IEDQLCB+28                                               03308000
LCBLNENT EQU   LCBSCBDA+1                                               03309000
@NM00107 EQU   LCBSCBDA                                                 03310000
LCBCPGMH EQU   LCBSTAT4                                                 03311000
LCBREAL  EQU   LCBPHASE                                                 03312000
@NM00106 EQU   LCBSTAT4                                                 03313000
LCBACTRQ EQU   LCBSTAT4                                                 03314000
LCBIPLRQ EQU   LCBSTAT4                                                 03315000
LCBDACRQ EQU   LCBSTAT4                                                 03316000
LCBDMPRQ EQU   LCBSTAT4                                                 03317000
@NM00105 EQU   LCBLKMDE                                                 03318000
LCBLOCKI EQU   LCBLKMDE                                                 03319000
LCBLOCKR EQU   LCBLKMDE                                                 03320000
LCBHMFLG EQU   LCBLKMDE                                                 03321000
LCBBDFLG EQU   LCBLKMDE                                                 03322000
@NM00104 EQU   LCBINSRC                                                 03323000
LCBABRTN EQU   LCBCHAIN                                                 03324000
LCBCTLMD EQU   LCBTETEN                                                 03325000
LCBBFRSZ EQU   LCBCHAIN                                                 03326000
LCBUREQN EQU   LCBCHAIN                                                 03327000
LCBNORTY EQU   LCBCHAIN                                                 03328000
LCBERMSG EQU   LCBCHAIN                                                 03329000
LCBEXCP  EQU   LCBCHAIN                                                 03330000
LCBINVRQ EQU   LCBSCRNN                                                 03331000
LCB2741N EQU   LCBTSOB                                                  03332000
LCBINHBN EQU   LCBTSOB                                                  03333000
LCBCIRCD EQU   LCBTSOB                                                  03334000
LCBPREP  EQU   LCBTSOB                                                  03335000
LCBSOPL  EQU   LCBTSOB                                                  03336000
LCBSATRD EQU   LCBTSOB                                                  03337000
LCBTSBUF EQU   LCBTSOB                                                  03338000
LCBWRBRK EQU   LCBTSOB                                                  03339000
LCBTDL   EQU   IEDQLCB+18                                               03340000
LCBEOLTD EQU   IEDQLCB+16                                               03341000
LCBRSLNK EQU   IEDQLCB+13                                               03342000
LCBRSPRI EQU   IEDQLCB+12                                               03343000
LCBSTCBA EQU   IEDQLCB+9                                                03344000
LCBRSKEY EQU   IEDQLCB+8                                                03345000
LCBLINK  EQU   LCBRCB+5                                                 03346000
LCBPRI   EQU   LCBRCB+4                                                 03347000
LCBQCBA  EQU   LCBRCB+1                                                 03348000
LCBKEY   EQU   LCBRCB                                                   03349000
@NM00103 EQU   DCTBYTE5                                                 03350000
DCTTSPRF EQU   DCTBYTE4                                                 03351000
DCTFMPRF EQU   DCTBYTE4                                                 03352000
DCT2760  EQU   DCTBYTE3                                                 03353000
DCTNOIDL EQU   DCTBYTE3                                                 03354000
DCTCONTN EQU   DCTBYTE3                                                 03355000
DCTBUFF  EQU   DCTBYTE3                                                 03356000
DCTCHECK EQU   DCTBYTE3                                                 03357000
DCTENCTL EQU   DCTBYTE3                                                 03358000
DCTWTTA  EQU   DCTBYTE3                                                 03359000
DCT1050  EQU   DCTBYTE3                                                 03360000
DCTAUDIO EQU   DCTBYTE2                                                 03361000
DCTLOCAL EQU   DCTBYTE2                                                 03362000
DCTCONT  EQU   DCTBYTE2                                                 03363000
DCTXMIT  EQU   DCTBYTE2                                                 03364000
DCTSTCTL EQU   DCTBYTE2                                                 03365000
DCTTWX   EQU   DCTBYTE2                                                 03366000
DCTBRDST EQU   DCTBYTE2                                                 03367000
DCTBISYN EQU   DCTBYTE2                                                 03368000
DCTUMASK EQU   DCTBYTE1                                                 03369000
DCTSADEV EQU   DCTBYTE1                                                 03370000
DCT3270  EQU   DCTBYTE1                                                 03371000
DCT2741  EQU   DCTBYTE1                                                 03372000
DCT5041  EQU   DCTBYTE1                                                 03373000
DCTATTEN EQU   DCTBYTE1                                                 03374000
DCTBREAK EQU   DCTBYTE1                                                 03375000
DCTINHIB EQU   DCTBYTE1                                                 03376000
DCTBYTE0 EQU   IEDDCT                                                   03377000
SAVTBITN EQU   IEDNSVTD+312                                             03378000
@NM00102 EQU   SAVTCKQB+8                                               03379000
@NM00101 EQU   SAVTCKEC+1                                               03380000
@NM00100 EQU   SAVTCKCC                                                 03381000
SAVTCKPO EQU   SAVTCKCC                                                 03382000
SAVTCKWA EQU   SAVTCKCC                                                 03383000
SAVTCKCH EQU   SAVTCKTB+1                                               03384000
SAVTCKVT EQU   SAVTCKTB                                                 03385000
@NM00099 EQU   IEDNSVTD+297                                             03386000
SAVTRDFG EQU   SAVTRDRV+12                                              03387000
@NM00098 EQU   SAVTRDRV+5                                               03388000
SAVTRDPY EQU   SAVTRDRV+4                                               03389000
SAVTRDQB EQU   SAVTRDRV+1                                               03390000
SAVTRDKY EQU   SAVTRDRV                                                 03391000
SAVTNID  EQU   IEDNSVTD+280                                             03392000
SAVTDVAS EQU   IEDNSVTD+276                                             03393000
SAVTPLSZ EQU   IEDNSVTD+274                                             03394000
@NM00097 EQU   IEDNSVTD+273                                             03395000
SAVTSUBL EQU   IEDNSVTD+272                                             03396000
@NM00096 EQU   SAVTZELM+1                                               03397000
SAVTSUBM EQU   SAVTZELM                                                 03398000
SAVTMHDX EQU   IEDNSVTD+268                                             03399000
SAVTNAT1 EQU   IEDNSVTD+266                                             03400000
SAVTSH20 EQU   IEDNSVTD+264                                             03401000
SAVTLCBS EQU   IEDNSVTD+260                                             03402000
SAVTRNMP EQU   IEDNSVTD+256                                             03403000
SAVTTNTX EQU   IEDNSVTD+252                                             03404000
SAVTNAX  EQU   IEDNSVTD+248                                             03405000
SAVTSUBV EQU   IEDNSVTD+247                                             03406000
SAVTSUBA EQU   IEDNSVTD+246                                             03407000
SAVTSIBC EQU   IEDNSVTD+244                                             03408000
SAVTBSM  EQU   IEDNSVTD+240                                             03409000
SAVTSCPT EQU   SAVTTCPU                                                 03410000
SAVTRQTG EQU   IEDNSVTD+236                                             03411000
SAVTRQCH EQU   IEDNSVTD+232                                             03412000
SAVTMAND EQU   IEDNSVTD+228                                             03413000
SAVTSPLN EQU   IEDNSVTD+224                                             03414000
SAVTNADL EQU   IEDNSVTD+222                                             03415000
SAVTNATL EQU   IEDNSVTD+220                                             03416000
SAVTMHTB EQU   IEDNSVTD+216                                             03417000
SAVTSSMH EQU   IEDNSVTD+212                                             03418000
SAVTQRS  EQU   IEDNSVTD+208                                             03419000
SAVTRQIN EQU   IEDNSVTD+204                                             03420000
SAVTDFCO EQU   IEDNSVTD+200                                             03421000
SAVTSAO  EQU   IEDNSVTD+196                                             03422000
SAVTSARI EQU   IEDNSVTD+192                                             03423000
SAVTSAC  EQU   IEDNSVTD+188                                             03424000
SAVTSAI  EQU   IEDNSVTD+184                                             03425000
SAVTCSCI EQU   IEDNSVTD+180                                             03426000
SAVTSSRP EQU   IEDNSVTD+176                                             03427000
SAVTSSRQ EQU   IEDNSVTD+172                                             03428000
SAVTSCLU EQU   IEDNSVTD+168                                             03429000
SAVTXTRQ EQU   IEDNSVTD+164                                             03430000
SAVTMVBF EQU   IEDNSVTD+160                                             03431000
@NM00095 EQU   IEDNSVTD+148                                             03432000
SAVTIPCQ EQU   IEDNSVTD+144                                             03433000
@NM00094 EQU   IEDNSVTD+136                                             03434000
SAVTXFMI EQU   IEDNSVTD+132                                             03435000
@NM00093 EQU   IEDNSVTD+124                                             03436000
SAVTXFMO EQU   IEDNSVTD+120                                             03437000
@NM00092 EQU   IEDNSVTD+116                                             03438000
SAVTSSSR EQU   IEDNSVTD+112                                             03439000
SAVTSCPQ EQU   IEDNSVTD+108                                             03440000
SAVTSLCB EQU   IEDNSVTD+104                                             03441000
SAVTLUSR EQU   IEDNSVTD+100                                             03442000
@NM00091 EQU   SAVTLUSQ+8                                               03443000
SAVTLUSP EQU   SAVTLUSQ+4                                               03444000
SAVTLUSB EQU   SAVTLUSQ                                                 03445000
@NM00090 EQU   IEDNSVTD+84                                              03446000
SAVTSAT  EQU   IEDNSVTD+80                                              03447000
SAVTNAT  EQU   IEDNSVTD+76                                              03448000
SAVTCLUP EQU   IEDNSVTD+72                                              03449000
SAVTPIUT EQU   IEDNSVTD+68                                              03450000
SAVTRNTA EQU   IEDNSVTD+64                                              03451000
SAVTDNIR EQU   IEDNSVTD+60                                              03452000
SAVTCNIR EQU   IEDNSVTD+56                                              03453000
SAVTFLDH EQU   IEDNSVTD+52                                              03454000
SAVTSRTN EQU   IEDNSVTD+48                                              03455000
SAVTSREQ EQU   IEDNSVTD+44                                              03456000
SAVTFAIL EQU   IEDNSVTD+42                                              03457000
SAVTSUSE EQU   IEDNSVTD+40                                              03458000
SAVTSIB  EQU   IEDNSVTD+36                                              03459000
SAVTPRTN EQU   IEDNSVTD+32                                              03460000
@NM00089 EQU   IEDNSVTD+28                                              03461000
SAVTWH20 EQU   IEDNSVTD+26                                              03462000
SAVTPWT  EQU   IEDNSVTD+24                                              03463000
SAVTPRTQ EQU   IEDNSVTD+20                                              03464000
SAVTPREQ EQU   IEDNSVTD+16                                              03465000
SAVTPH20 EQU   IEDNSVTD+14                                              03466000
SAVTPUSE EQU   IEDNSVTD+12                                              03467000
SAVTPLCB EQU   IEDNSVTD+8                                               03468000
SAVTPOOL EQU   IEDNSVTD+4                                               03469000
SAVTPRMT EQU   SAVTDIAF                                                 03470000
SAVTVIRT EQU   SAVTDIAF                                                 03471000
AVTCPBNO EQU   IEDQAVTD+1244                                            03472000
AVTHRESS EQU   IEDQAVTD+1243                                            03473000
@NM00088 EQU   IEDQAVTD+1242                                            03474000
@NM00087 EQU   IEDQAVTD+1241                                            03475000
@NM00086 EQU   IEDQAVTD+1240                                            03476000
@NM00085 EQU   IEDQAVTD+1237                                            03477000
@NM00084 EQU   IEDQAVTD+1236                                            03478000
AVTHRESE EQU   @NM00083                                                 03479000
AVTRADDR EQU   IEDQAVTD+1228                                            03480000
AVTNADDR EQU   IEDQAVTD+1224                                            03481000
AVTHRESN EQU   IEDQAVTD+1220                                            03482000
AVTVOLRN EQU   IEDQAVTD+1216                                            03483000
AVTTOTNN EQU   IEDQAVTD+1212                                            03484000
AVTTRCYN EQU   IEDQAVTD+1208                                            03485000
AVTRCTRN EQU   IEDQAVTD+1204                                            03486000
AVTNOVON EQU   IEDQAVTD+1200                                            03487000
AVTADEBN EQU   IEDQAVTD+1196                                            03488000
AVTVOLRR EQU   IEDQAVTD+1192                                            03489000
AVTTOTNR EQU   IEDQAVTD+1188                                            03490000
AVTTRCYR EQU   IEDQAVTD+1184                                            03491000
AVTRCTRR EQU   IEDQAVTD+1180                                            03492000
AVTNOVOR EQU   IEDQAVTD+1176                                            03493000
AVTADEBR EQU   IEDQAVTD+1172                                            03494000
AVTLODPT EQU   IEDQAVTD+1168                                            03495000
AVTIOBN  EQU   IEDQAVTD+1164                                            03496000
AVTIOBR  EQU   IEDQAVTD+1160                                            03497000
AVTCPBPT EQU   IEDQAVTD+1156                                            03498000
AVTFCPB  EQU   IEDQAVTD+1152                                            03499000
@NM00082 EQU   IEDQAVTD+1148                                            03500000
AVTINCPQ EQU   IEDQAVTD+1144                                            03501000
@NM00081 EQU   IEDQAVTD+1140                                            03502000
@NM00080 EQU   IEDQAVTD+1137                                            03503000
@NM00079 EQU   AVTBIT4                                                  03504000
@NM00078 EQU   AVTBIT4                                                  03505000
@NM00077 EQU   AVTBIT4                                                  03506000
@NM00076 EQU   AVTBIT4                                                  03507000
@NM00075 EQU   AVTBIT4                                                  03508000
@NM00074 EQU   AVTBIT4                                                  03509000
@NM00073 EQU   AVTBIT4                                                  03510000
AVTRUFTN EQU   AVTBIT4                                                  03511000
@NM00072 EQU   IEDQAVTD+1132                                            03512000
AVTNOBFQ EQU   IEDQAVTD+1128                                            03513000
@NM00071 EQU   IEDQAVTD+1124                                            03514000
AVTDKENQ EQU   IEDQAVTD+1120                                            03515000
@NM00070 EQU   IEDQAVTD+1116                                            03516000
AVTDKAPQ EQU   IEDQAVTD+1112                                            03517000
AVTCOPY  EQU   IEDQAVTD+1108                                            03518000
AVTIA    EQU   IEDQAVTD+1104                                            03519000
AVTFL    EQU   IEDQAVTD+1100                                            03520000
@NM00069 EQU   IEDQAVTD+1096                                            03521000
AVTNCPBQ EQU   IEDQAVTD+1092                                            03522000
AVTTOTNC EQU   IEDQAVTD+1088                                            03523000
AVTCMAX  EQU   IEDQAVTD+1084                                            03524000
AVTCMIN  EQU   IEDQAVTD+1080                                            03525000
AVTHM02  EQU   IEDQAVTD+1076                                            03526000
AVTOPCIN EQU   IEDQAVTD+1074                                            03527000
AVTOPMSK EQU   IEDQAVTD+1068                                            03528000
AVTDDFT  EQU   IEDQAVTD+1064                                            03529000
AVTSTEAL EQU   IEDQAVTD+1060                                            03530000
AVTOPTN  EQU   IEDQAVTD+1056                                            03531000
AVTDSKCT EQU   IEDQAVTD+1054                                            03532000
AVTCKRST EQU   IEDQAVTD+1053                                            03533000
AVTSTAN  EQU   AVTBIT3                                                  03534000
AVTSTACN EQU   AVTBIT3                                                  03535000
AVTSTAIN EQU   AVTBIT3                                                  03536000
AVTSTAYN EQU   AVTBIT3                                                  03537000
AVTOLTBN EQU   AVTBIT3                                                  03538000
AVTTSAB  EQU   AVTBIT3                                                  03539000
AVTRFULN EQU   AVTBIT3                                                  03540000
AVTRECVN EQU   AVTBIT3                                                  03541000
@NM00068 EQU   AVTBIT2                                                  03542000
@NM00067 EQU   AVTBIT2                                                  03543000
AVTOPEIN EQU   AVTBIT2                                                  03544000
AVTSTRTN EQU   AVTBIT2                                                  03545000
AVTTOPOL EQU   AVTBIT2                                                  03546000
AVTCOPYN EQU   AVTBIT2                                                  03547000
AVTREUSN EQU   AVTBIT2                                                  03548000
AVTEXTSC EQU   AVTBIT2                                                  03549000
AVTDISKN EQU   AVTBIT1                                                  03550000
AVTQUCKN EQU   AVTBIT1                                                  03551000
AVTCLOSN EQU   AVTBIT1                                                  03552000
AVTREADN EQU   AVTBIT1                                                  03553000
AVTDLAYN EQU   AVTBIT1                                                  03554000
AVTAQTAN EQU   AVTBIT1                                                  03555000
AVTTSON  EQU   AVTBIT1                                                  03556000
AVTAPLKN EQU   AVTBIT1                                                  03557000
AVTDUMBR EQU   IEDQAVTD+1048                                            03558000
AVTDLQX  EQU   IEDQAVTD+1046                                            03559000
AVTINTLV EQU   IEDQAVTD+1044                                            03560000
AVTSMCNT EQU   IEDQAVTD+1042                                            03561000
AVTAVFCT EQU   IEDQAVTD+1040                                            03562000
AVTOPCON EQU   IEDQAVTD+1038                                            03563000
AVTOPCNT EQU   IEDQAVTD+1036                                            03564000
AVTLNCNT EQU   IEDQAVTD+1034                                            03565000
AVTKEYLE EQU   IEDQAVTD+1032                                            03566000
AVTHA16  EQU   IEDQAVTD+1030                                            03567000
AVTHA7   EQU   IEDQAVTD+1028                                            03568000
AVTHA4   EQU   IEDQAVTD+1026                                            03569000
AVTHA3   EQU   IEDQAVTD+1024                                            03570000
AVTHA2   EQU   IEDQAVTD+1022                                            03571000
AVTGETMS EQU   IEDQAVTD+1021                                            03572000
@NM00066 EQU   IEDQAVTD+1020                                            03573000
AVTGETMD EQU   IEDQAVTD+1016                                            03574000
AVTGETMN EQU   IEDQAVTD+1012                                            03575000
AVTCWTOT EQU   IEDQAVTD+1008                                            03576000
AVTCWINT EQU   IEDQAVTD+956                                             03577000
AVTDTRAP EQU   IEDQAVTD+952                                             03578000
@NM00065 EQU   IEDQAVTD+950                                             03579000
@NM00064 EQU   AVTIOTR                                                  03580000
AVTIOTRH EQU   AVTIOTR                                                  03581000
AVTIOTRE EQU   AVTIOTR                                                  03582000
@NM00063 EQU   AVTSUBT                                                  03583000
AVTSUBPT EQU   AVTSUBT                                                  03584000
AVTSUBON EQU   AVTSUBT                                                  03585000
AVTAFE30 EQU   IEDQAVTD+944                                             03586000
AVTAFE20 EQU   IEDQAVTD+940                                             03587000
AVTAFE10 EQU   IEDQAVTD+936                                             03588000
AVTCWEC2 EQU   IEDQAVTD+932                                             03589000
AVTCWPM2 EQU   IEDQAVTD+928                                             03590000
AVTCWTS2 EQU   IEDQAVTD+927                                             03591000
AVTCWTS1 EQU   IEDQAVTD+926                                             03592000
AVTCWCLD EQU   AVTCWFL2                                                 03593000
AVTCWRAP EQU   AVTCWFL2                                                 03594000
@NM00062 EQU   AVTCWFL2                                                 03595000
@NM00061 EQU   AVTCWFL2                                                 03596000
@NM00060 EQU   AVTCWFL2                                                 03597000
@NM00059 EQU   AVTCWFL2                                                 03598000
@NM00058 EQU   AVTCWFL2                                                 03599000
AVTCWACT EQU   AVTCWFL2                                                 03600000
@NM00057 EQU   AVTCWFL1                                                 03601000
@NM00056 EQU   AVTCWFL1                                                 03602000
@NM00055 EQU   AVTCWFL1                                                 03603000
@NM00054 EQU   AVTCWFL1                                                 03604000
@NM00053 EQU   AVTCWFL1                                                 03605000
@NM00052 EQU   AVTCWFL1                                                 03606000
@NM00051 EQU   AVTCWFL1                                                 03607000
AVTCOMWN EQU   AVTCWFL1                                                 03608000
AVTCWEC1 EQU   IEDQAVTD+920                                             03609000
AVTCWPM1 EQU   IEDQAVTD+916                                             03610000
AVTCAREA EQU   IEDQAVTD+912                                             03611000
AVTFZERO EQU   IEDQAVTD+908                                             03612000
AVTCADDR EQU   IEDQAVTD+904                                             03613000
AVTCOREC EQU   IEDQAVTD+900                                             03614000
@NM00050 EQU   IEDQAVTD+892                                             03615000
AVTCPBCB EQU   IEDQAVTD+888                                             03616000
@NM00049 EQU   IEDQAVTD+880                                             03617000
AVTDSIOB EQU   IEDQAVTD+876                                             03618000
@NM00048 EQU   IEDQAVTD+868                                             03619000
AVTCPRMB EQU   IEDQAVTD+864                                             03620000
@NM00047 EQU   IEDQAVTD+856                                             03621000
AVTCLOSB EQU   IEDQAVTD+852                                             03622000
@NM00046 EQU   IEDQAVTD+844                                             03623000
AVTACTIB EQU   IEDQAVTD+840                                             03624000
@NM00045 EQU   IEDQAVTD+836                                             03625000
AVTOLTEB EQU   IEDQAVTD+832                                             03626000
AVTOLTCH EQU   AVTOLTQB+1                                               03627000
AVTOLTVT EQU   AVTOLTQB                                                 03628000
@NM00044 EQU   AVTOPCQB+8                                               03629000
@NM00043 EQU   AVTOPCEC+1                                               03630000
@NM00042 EQU   AVTOPCCC                                                 03631000
AVTOPCPO EQU   AVTOPCCC                                                 03632000
AVTOPCWA EQU   AVTOPCCC                                                 03633000
AVTOPCCH EQU   AVTOPCOB+1                                               03634000
AVTOPCVT EQU   AVTOPCOB                                                 03635000
@NM00041 EQU   AVTCKPQB+9                                               03636000
AVTCKPTS EQU   AVTCKPQB+8                                               03637000
@NM00040 EQU   AVTCKPEC+1                                               03638000
@NM00039 EQU   AVTCKPCC                                                 03639000
AVTCKPPO EQU   AVTCKPCC                                                 03640000
AVTCKPWA EQU   AVTCKPCC                                                 03641000
AVTCKPCH EQU   AVTCKPTB+1                                               03642000
AVTCKPVT EQU   AVTCKPTB                                                 03643000
@NM00038 EQU   IEDQAVTD+796                                             03644000
AVTBFRTB EQU   IEDQAVTD+792                                             03645000
@NM00037 EQU   IEDQAVTD+784                                             03646000
AVTBFREB EQU   IEDQAVTD+780                                             03647000
AVTTIMQ  EQU   IEDQAVTD+776                                             03648000
@NM00036 EQU   IEDQAVTD+772                                             03649000
AVTIMQPS EQU   IEDQAVTD+768                                             03650000
AVTINOUT EQU   IEDQAVTD+766                                             03651000
AVTREFTM EQU   IEDQAVTD+764                                             03652000
@NM00035 EQU   IEDQAVTD+752                                             03653000
AVTDELYB EQU   IEDQAVTD+748                                             03654000
AVTOCQPT EQU   IEDQAVTD+744                                             03655000
AVTTSOPT EQU   IEDQAVTD+740                                             03656000
AVTSUPPT EQU   IEDQAVTD+736                                             03657000
AVTCBQCB EQU   IEDQAVTD+732                                             03658000
AVTMSGS  EQU   IEDQAVTD+729                                             03659000
@NM00034 EQU   AVTSYSER                                                 03660000
@NM00033 EQU   AVTSYSER                                                 03661000
@NM00032 EQU   AVTSYSER                                                 03662000
@NM00031 EQU   AVTSYSER                                                 03663000
@NM00030 EQU   AVTSYSER                                                 03664000
@NM00029 EQU   AVTSYSER                                                 03665000
AVTCMAXN EQU   AVTSYSER                                                 03666000
AVTCMINN EQU   AVTSYSER                                                 03667000
AVT2260L EQU   IEDQAVTD+724                                             03668000
AVTABEPL EQU   AVTADBUF                                                 03669000
AVTHFF   EQU   AVTCLRHI+2                                               03670000
@NM00028 EQU   AVTCLRHI                                                 03671000
AVTCCLNK EQU   AVTCRELE+5                                               03672000
AVTCCPRI EQU   AVTCRELE+4                                               03673000
AVTCCQCB EQU   AVTCCELE+1                                               03674000
AVTCCKEY EQU   AVTCCELE                                                 03675000
AVTDELAD EQU   IEDQAVTD+704                                             03676000
AVTDELEM EQU   IEDQAVTD+700                                             03677000
AVTBSX   EQU   AVTCKLNK                                                 03678000
AVTOPETR EQU   AVTHG01                                                  03679000
@NM00027 EQU   AVTCKBYT                                                 03680000
AVTCKONQ EQU   AVTCKBYT                                                 03681000
@NM00026 EQU   AVTCKBYT                                                 03682000
@NM00025 EQU   AVTCKBYT                                                 03683000
@NM00024 EQU   AVTCKBYT                                                 03684000
@NM00023 EQU   AVTCKBYT                                                 03685000
@NM00022 EQU   AVTCKBYT                                                 03686000
@NM00021 EQU   AVTCKBYT                                                 03687000
AVTOPERT EQU   IEDQAVTD+690                                             03688000
AVTOPXCL EQU   IEDQAVTD+688                                             03689000
AVTOPERL EQU   IEDQAVTD+687                                             03690000
@NM00020 EQU   IEDQAVTD+686                                             03691000
AVTCKTIM EQU   IEDQAVTD+684                                             03692000
AVTCKELV EQU   IEDQAVTD+682                                             03693000
AVTCPRCD EQU   IEDQAVTD+681                                             03694000
AVTWARMN EQU   AVTCKELF                                                 03695000
AVTCRTLN EQU   AVTCKELF                                                 03696000
AVTCPIPN EQU   AVTCKELF                                                 03697000
AVTCCLCN EQU   AVTCKELF                                                 03698000
AVTCINCN EQU   AVTCKELF                                                 03699000
@NM00019 EQU   AVTCKELF                                                 03700000
AVTCMCPN EQU   AVTCKELF                                                 03701000
AVTCRDYN EQU   AVTCKELF                                                 03702000
AVTCKQAD EQU   IEDQAVTD+677                                             03703000
AVTSCBSZ EQU   IEDQAVTD+676                                             03704000
@NM00018 EQU   IEDQAVTD+672                                             03705000
AVTCKELE EQU   IEDQAVTD+668                                             03706000
@NM00017 EQU   AVTCKPEL+8                                               03707000
AVTCKRLK EQU   AVTCKPEL+5                                               03708000
AVTCKRPR EQU   AVTCKPEL+4                                               03709000
AVTCKRMQ EQU   AVTCKRMV+1                                               03710000
AVTCKRKY EQU   AVTCKRMV                                                 03711000
AVTHK    EQU   IEDQAVTD+648                                             03712000
AVTHI    EQU   IEDQAVTD+644                                             03713000
AVTIOT   EQU   IEDQAVTD+640                                             03714000
AVTNX    EQU   IEDQAVTD+636                                             03715000
AVTTONE  EQU   IEDQAVTD+632                                             03716000
AVTA3TL  EQU   IEDQAVTD+628                                             03717000
AVTDMECB EQU   IEDQAVTD+624                                             03718000
AVTABEND EQU   IEDQAVTD+618                                             03719000
AVTPLCBN EQU   IEDQAVTD+616                                             03720000
@NM00016 EQU   AVTSAVTP+1                                               03721000
@NM00015 EQU   AVTSAVTF                                                 03722000
AVTSNA   EQU   AVTSAVTF                                                 03723000
AVTONSNA EQU   AVTSAVTF                                                 03724000
AVTVTMCP EQU   AVTSAVTF                                                 03725000
@NM00014 EQU   IEDQAVTD+608                                             03726000
AVTCMBSS EQU   IEDQAVTD+604                                             03727000
AVTRCV   EQU   IEDQAVTD+600                                             03728000
AVTSEND  EQU   IEDQAVTD+596                                             03729000
AVTCSCH  EQU   IEDQAVTD+592                                             03730000
AVTQ1    EQU   IEDQAVTD+588                                             03731000
AVTE7    EQU   IEDQAVTD+584                                             03732000
AVTHB    EQU   IEDQAVTD+580                                             03733000
AVTR1    EQU   IEDQAVTD+576                                             03734000
AVTBZ    EQU   IEDQAVTD+572                                             03735000
AVTEZ    EQU   IEDQAVTD+568                                             03736000
AVTEC    EQU   IEDQAVTD+564                                             03737000
AVTEW    EQU   IEDQAVTD+560                                             03738000
AVTNDIAL EQU   AVTSCOPT                                                 03739000
AVTN2741 EQU   AVTSCOPT                                                 03740000
AVTCONCO EQU   AVTSCOPT                                                 03741000
AVTCONC  EQU   AVTSCOPT                                                 03742000
AVTCMBUF EQU   AVTSCOPT                                                 03743000
AVTAPDMP EQU   AVTSCOPT                                                 03744000
@NM00013 EQU   AVTSCOPT                                                 03745000
AVTHA    EQU   AVTDISP                                                  03746000
AVTEA    EQU   IEDQAVTD+548                                             03747000
AVTAX    EQU   IEDQAVTD+544                                             03748000
AVTA3    EQU   IEDQAVTD+540                                             03749000
AVTGD    EQU   IEDQAVTD+536                                             03750000
AVTAL    EQU   IEDQAVTD+532                                             03751000
AVTOLTST EQU   AVTHG02                                                  03752000
AVTE8    EQU   IEDQAVTD+524                                             03753000
AVTCOMPT EQU   IEDQAVTD+516                                             03754000
AVTCRSRF EQU   IEDQAVTD+512                                             03755000
@NM00012 EQU   IEDQAVTD+508                                             03756000
AVTKA02  EQU   IEDQAVTD+504                                             03757000
AVTOPTPT EQU   IEDQAVTD+500                                             03758000
AVTPCBPT EQU   IEDQAVTD+496                                             03759000
AVTOSECB EQU   IEDQAVTD+492                                             03760000
AVTOPECA EQU   IEDQAVTD+488                                             03761000
AVTOLECA EQU   IEDQAVTD+484                                             03762000
AVTCKECA EQU   IEDQAVTD+480                                             03763000
AVTCWECA EQU   IEDQAVTD+476                                             03764000
AVTCWTCB EQU   IEDQAVTD+472                                             03765000
AVTOLTCB EQU   IEDQAVTD+468                                             03766000
AVTOCTCB EQU   IEDQAVTD+464                                             03767000
AVTCKTCB EQU   IEDQAVTD+460                                             03768000
AVTAS    EQU   IEDQAVTD+456                                             03769000
AVTNOLBF EQU   IEDQAVTD+454                                             03770000
AVTNCKPR EQU   IEDQAVTD+453                                             03771000
AVTCIB   EQU   IEDQAVTD+452                                             03772000
AVTSPLPT EQU   IEDQAVTD+448                                             03773000
AVTMVBFR EQU   IEDQAVTD+444                                             03774000
AVTSBTA  EQU   IEDQAVTD+440                                             03775000
AVTRARTN EQU   IEDQAVTD+436                                             03776000
AVTBSCAN EQU   IEDQAVTD+432                                             03777000
AVTRDYA  EQU   IEDQAVTD+428                                             03778000
AVTDISTR EQU   IEDQAVTD+420                                             03779000
AVTPARM3 EQU   IEDQAVTD+416                                             03780000
@NM00011 EQU   AVTPKF                                                   03781000
@NM00010 EQU   AVTPKF                                                   03782000
@NM00009 EQU   AVTPKF                                                   03783000
AVTFTCHF EQU   AVTPKF                                                   03784000
@NM00008 EQU   AVTPKF                                                   03785000
@NM00007 EQU   AVTPKF                                                   03786000
@NM00006 EQU   AVTPKF                                                   03787000
@NM00005 EQU   AVTPKF                                                   03788000
AVTPARM  EQU   IEDQAVTD+408                                             03789000
AVTEXS2A EQU   IEDQAVTD+402                                             03790000
AVTEXA2S EQU   IEDQAVTD+396                                             03791000
AVTOCGET EQU   IEDQAVTD+392                                             03792000
AVTCKAVT EQU   @NM00003+1                                               03793000
@NM00004 EQU   AVTCKFLG                                                 03794000
AVTCKHLT EQU   AVTCKFLG                                                 03795000
AVTCKREQ EQU   AVTCKFLG                                                 03796000
AVTCKENV EQU   AVTCKFLG                                                 03797000
AVTCKNAC EQU   AVTCKFLG                                                 03798000
AVTCKTAC EQU   AVTCKFLG                                                 03799000
@NM00002 EQU   IEDQAVTD+384                                             03800000
AVTREADD EQU   IEDQAVTD+380                                             03801000
AVTREADY EQU   IEDQAVTD+376                                             03802000
AVTRACE  EQU   IEDQAVTD+372                                             03803000
AVTTCB   EQU   IEDQAVTD+368                                             03804000
AVTPASWD EQU   IEDQAVTD+360                                             03805000
AVTCTLCH EQU   IEDQAVTD+352                                             03806000
AVTDOUBL EQU   IEDQAVTD+344                                             03807000
AVTDOUBX EQU   IEDQAVTD+336                                             03808000
AVTDPARM EQU   IEDQAVTD+332                                             03809000
AVTDLQ   EQU   AVTSAVEX+32                                              03810000
@NM00001 EQU   AVTSAVEX                                                 03811000
AVTSAVE4 EQU   IEDQAVTD+216                                             03812000
AVTSAVE3 EQU   IEDQAVTD+144                                             03813000
AVTSAVE2 EQU   IEDQAVTD+72                                              03814000
AVTSAVE1 EQU   IEDQAVTD                                                 03815000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03816000
@RT00331 EQU   @RC00329                                                 03817000
@RC00334 EQU   @RC00329                                                 03818000
@RC00348 EQU   @RC00329                                                 03819000
@RC00363 EQU   @RC00329                                                 03820000
@RF00392 EQU   @RC00329                                                 03821000
@RF00460 EQU   @RC00329                                                 03822000
@RF00578 EQU   @EL00004                                                 03823000
@RF00618 EQU   @RC00595                                                 03824000
@RT00643 EQU   @RC00638                                                 03825000
@RT00641 EQU   @RC00638                                                 03826000
@RT00684 EQU   @RC00676                                                 03827000
@RC00692 EQU   @RC00676                                                 03828000
@RT00714 EQU   @RC00674                                                 03829000
@PB00005 EQU   @EL00001                                                 03830000
@PB00004 EQU   @PB00005                                                 03831000
@PB00003 EQU   @PB00004                                                 03832000
@PB00002 EQU   @PB00003                                                 03833000
@ENDDATA EQU   *                                                        03834000
         END   IEDQFM,(C'PLS0532',0701,77033)                           03835000
