HK01     TITLE '''IEDQHK'' - RESIDENT STOPLINE I/O HANDLER'             00200020
IEDQHK   CSECT                                                          00400020
*A-000000-999999                                               @X31X8R0 00400108
         SPACE 3                                                        00400222
*CHANGE-ACTIVITY = AS FOLLOWS:                                   S21903 00400422
******************** MICROFICHE FLAGS *********************** SUPT CODE 00400622
*C014000                                                       @Z30X8RB 00400808
*A246200,247300,569500-570300                                    S99228 00401022
*D569500-570505                                                  S99228 00401122
*A530000                                                         A47145 00401222
*C667000                                                         A47145 00401322
*A667000                                                         CLUP21 00401422
*C322000,326000,354200-357200,363000,374000-388000,398000-400000 CLUP21 00401522
*C430000-437000,456000,456800,462100,463200,480000,483998        CLUP21 00401622
*C502600-503200,527000-528000,536000-538000,542000-544000        CLUP21 00401722
*C550000-552000,568500-573000,578000-580000,584000-586000        CLUP21 00401822
*C592000-594000,598000-600000,604000,609000-612000,616000-618000 CLUP21 00401922
*C623000,634000-636000,642600,644000,653000,658000,660000        CLUP21 00402022
*D247300,416000,674000                                           CLUP21 00402122
*A480000                                                          M6561 00402222
*A021000,112400-113600,139000,172500-173500,293100-293400        S22025 00402322
*A326600-327200,641000,643600,658400-659600,671000               S22025 00402422
*A202000,212000,216000,292000,296000,570500,676000               S21101 00402522
*A266000,411000,570570                                           S22025 00402622
*C481960,667000                                                   M6561 00402722
*C020000,116000-118000,308000,310000-312000,396000,402200-404000 S22025 00402822
*C412200,456600,458600,459400,524000-546000,556000,558000-566000 S22025 00402922
*C570740-570755,570785,570800,658000,661000-662000               S22025 00403022
*C294000,308000,667000                                           S21101 00403122
*C308000,524000-546000,558000-566000,570740-570755,570785,5708000S22025 00403222
*D480500-481920                                                   M6561 00403322
*D204000-206000,571000-574000,672000-674000                      S21101 00403422
*D488000-512000,568500-569000                                    S22025 00403522
*A540000                                                          M6684 00403622
*A292800,642600,643200,659600,671000                            SA54930 00403722
*D412600-412800                                                 SA54929 00403822
*A004000                                                         S21903 00403922
*C010000,210000-212000,216000,224000,238000-244000,              S21903 00404022
*C247000-247200,247500-251500,256500-266000                      S21903 00404122
*A582100-583500                                                  Y05331 00404205
*A437000                                                        SA66918 00484254
*A656000                                                        SA67759 00484305
* A416000                                                      @SA70195 00504361
*A233000                                                       @SA70889 00524361
*C643300,643400                                                @SA70889 00544361
*A282000,482998,483986                                         @SA71514 00544461
*A372000,378000                                                @ZA02071 00544561
*C656900                                                       @ZA02055 00554361
*A295500                                                       @YA07691 00562361
*C376000                                                       @YA07691 00570361
*A474000                                                       @ZA05018 00571309
*A280000,643400,659900                                         @YA10232 00572309
*A474000                                                       @SA75467 00573309
*D480000                                                       @SA75467 00574309
*A563000,C564000                                               @OY11167 00574481
*A246000,404000,410000,689000                                  @OY13669 00574791
*C282000,348000,364000,410050                                  @OY14491 00574891
*C456000-470000                                                @OX14763 00574991
*A293400,671000,443000                                         @OX14763 00575091
*A328300                                                       @OY15473 00575191
*A215000,219000,220600-221200,295511-295518,312600-313200      @OY14092 00575291
*A323000,416030-416630,493998,671001-689060,410350             @OY14092 00575391
*C310000,370000-380200,474000-483598,659960-660950,410500      @OY14092 00575491
*D483986-483990                                                @OY14092 00575591
*A416540                                                       @OY16355 00575600
*C416030-416450                                                @OY16355 00575700
*D474300,474600                                                @OY16355 00575800
*A660270,660400,660420                                         @OY18823 00576000
*C660010-660020                                                @OY18823 00576100
*A283200,437000,671000                                         @OZ24311 00576300
*A479400,480000                                                @OY19040 00577000
*C660120,416540-416550                                         @OY19040 00577700
*D365000                                                       @OY19040 00578400
* DUMMY APAR                                                   @OZ27328 00579100
*A479400                                                       @OZ30095 00579286
*A399000                                                       @OZ28736 00579386
*C411000,437000                                                @OZ29091 00579486
*C416150                                                       @OZ28940 00579586
*A410350,416000,410680                                         @OY20036 00579686
         SPACE 3                                                        00580022
*********************************************************************** 00600020
*                                                                     * 00800020
*MODULE-NAME = IEDQHK                                            S21903 01000022
*                                                                S21903 01040022
*DESCRIPTIVE-NAME = RESIDENT STOPLINE I/O HANDLER                S21903 01080022
*                                                                S21903 01120022
*COPYRIGHTS = 'NONE'                                             S21903 01160022
*                                                                       01200020
*STATUS -- CHANGE LEVEL 8                                      @Z30X8RB 01400008
*                                                                     * 01600020
*FUNCTION -- THIS MODULE PROVIDES THE I/O HANDLING REQUIRED TO        * 01800020
*   EFFECT A STOPLINE FUNCTION AND TO DETERMINE IF A TRUE ATTEN- S22025 02000022
*   TION SIGNAL HAS BEEN RECEIVED FROM A 2741 OR 1050 TERMINAL.  S22025 02100022
*                                                                     * 02200020
*   WHEN A VARY OFFTP (C OR I), HALT, OR ICHANGE COMMAND IS           * 02400020
*   RECEIVED BY OPERATOR CONTROL, A REQUEST FOR STOPLINE IS POSTED    * 02600020
*   TO THIS MODULE.  IF THE REQUEST IS FOR AN I-TYPE VARY, THE LINE   * 02800020
*   IS TESTED TO SEE IF IT IS ALREADY FREE.  IF SO, LCBSTAT1 IS SET   * 03000020
*   TO ZERO TO INDICATE LINE STOPPED AND THE LCB IS POSTED TO THE     * 03200020
*   OPERATOR CONTROL QUEUE.  IF IT IS NOT ALREADY FREE, AN IOHALT     * 03400020
*   (SVC 33) IS ISSUED, LCBOCNI IS SET ON IN LCBSTAT1, THE ADDRESS    * 03600020
*   OF THE STOPLINE REQUEST ELEMENT IS SAVED IN LCBEOLTD, AND THE     * 03800020
*   ROUTINE EXITS TO THE DISPATCHER.                                  * 04000020
*                                                                     * 04200020
*   IF THE REQUEST IS FOR A C-TYPE VARY (ICHANGE IS ALWAYS A C-TYPE   * 04400020
*   VARY) THE LCB IS REMOVED FROM THE TIME DELAY QUEUE IF IT IS ON.   * 04600020
*   IF THE LINE IS DIAL AND LCBTSTSW IS NOT ON, A TEST-AND-SET IS     * 04800020
*   DONE AND THE ZERO BRANCH TAKEN TO HALT I/O CODE AS ABOVE.  THE    * 05000020
*   NON-ZERO BRANCH SKIPS THE IOHALT BUT SETS THE LCB FIELDS AND      * 05200020
*   TAKES THE EXIT AS ABOVE.  IF THE TEST-AND-SET SWITCH IS NOT ON,   * 05400020
*   OR IF THIS IS NOT A DIAL LINE, THE LINE IS TESTED TO SEE IF IT    * 05600020
*   IS ALREADY FREE.  IF SO, THE EXIT IS THE SAME AS THE I-TYPE       * 05800020
*   EXIT WHEN ALREADY FREE.                                           * 06000020
*                                                                     * 06200020
*   IF THE LINE IS AUTOPOLL, THE CHANNEL PROGRAM IS SET TO A NOP      * 06400020
*   AND THE BIT-SETTING CODE IS EXECUTED (AS ABOVE, AFTER IOHALT).    * 06600020
*   IF THE LINE IS BI-SYNC AND THERE IS NO PREPARE ON THE LINE,       * 06800020
*   LCB FIELDS ARE SET AS ABOVE AND THE ROUTINE EXITS TO THE          * 07000020
*   DISPATCHER.  IF A PREPARE IS UP, THE TEST-AND-SET IS DONE AS      * 07200020
*   FOR DIAL LINES WHEN THE TEST-AND-SET BIT IS NOT ON.  IF THE       * 07400020
*   LINE IS NOT BUSY, LCB FIELDS ARE SET AND EXIT TAKEN AS ABOVE.     * 07600020
*   IF THE LINE IS RECEIVING, THE ACTION IS THE SAME AS FOR NOT       * 07800020
*   BUSY.  OTHERWISE AN IOHALT IS ISSUED AND THE SAME EXIT CODE IS    * 08000020
*   EXECUTED.  THIS LOGIC IS REPEATED FOR EACH LCB TO BE STOPPED.     * 08200020
*                                                                     * 08400020
*   THE LCBS WILL BE RETURNED TO THIS SUBTASK WHEN THE SCHEDULERS     * 08600020
*   RECOGNIZE THE NON-IMMEDIATE BIT (LCBOCNI).  FOR NON-DIAL LINES,   * 08800020
*   LCBSTAT1 IS SET TO ZERO TO INDICATE LINE STOPPED AND CONTROL      * 09000020
*   EXITS TO THE DISPATCHER WITH A REQUEST TO POST THE LCB TO THE     * 09200020
*   OPERATOR CONTROL QUEUE.  IF THE LCB IS A DIAL LCB AND EXCP HAS    * 09400020
*   ALREADY BEEN DONE, THE EXCP FLAG IS TURNED OFF AND EXIT IS AS     * 09600020
*   FOR NON-DIAL LINES.                                               * 09800020
*                                                                     * 10000020
*   FOR A DIAL LINE ON WHICH EXCPVR HAS NOT BEEN DONE, THE EXCPVR     * 10200005
*   FLAG IS TURNED ON, A DISABLE IS SET IN THE CHANNEL PROGRAM AREA,  * 10400005
*   LCBTTCIN IS CLEARED, THE TEST-AND-SET SWITCH IS TURNED ON,        * 10600020
*   NEGATIVE RESPONSE TO POLLING IS SET, AND EXCPVR (SVC 114) IS      * 10800005
*   ISSUED.  THE ROUTINE GIVES UP CONTROL TO THE DISPATCHER.          * 11000020
*                                                                     * 11200020
*   WHEN AN LCB IS TPOSTED BY LINE END APPENDAGE, A PREPARE/HALT S22025 11240022
*   IO COMMAND SEQUENCE IS EXECUTED AND EXIT IS MADE TO THE      S22025 11280022
*   DISPATCHER.                                                  S22025 11320022
*                                                                     * 11360022
*ENTRY POINTS --                                                      * 11400020
*   IEDQHK01 - ENTERED THROUGH THE TCAM DISPATCHER.              S22025 11600022
*                                                                     * 12000020
*INPUT -- REGISTER 1 - FROM OPERATOR CONTROL, A STOPLINE REQUEST      * 12200020
*   ELEMENT FIVE WORDS LONG.  FIRST WORD IS ADDRESS OF IEDQHK,        * 12400020
*   SECOND HAS X'DC' PRIORITY IN FIRST BYTE, HIGH BYTE OF THIRD       * 12600020
*   WORD IS X'00' IF STOP SINGLE LINE, X'80' IF I-TYPE VARY, X'49'    * 12800020
*   IF ICHANGE, X'01' IF STOP A LINE GROUP, AND X'10' IF STOP ALL     * 13000020
*   LINES FOR CLOSEDOWN (HALT COMMAND).  IF NOT CLOSEDOWN, FOURTH     * 13200020
*   WORD IS DEB ADDRESS.  IF NOT CLOSEDOWN, THE FIFTH WORD IS DCB     * 13400020
*   ADDRESS FOR STOP LINE GROUP, LCB ADDRESS OTHERWISE.  FROM THE     * 13600020
*   SCHEDULERS, THE ADDRESS OF THE LCB.                               * 13800020
*   FROM LINE END, REGISTER 1 CONTAINS THE LCB ADDRESS.          S22025 13900022
*                                                                     * 14000020
*   REGISTER 13 - SAVE AREA ADDRESS.                                  * 14200020
*                                                                     * 14400020
*   REGISTER 15 - ENTRY POINT ADDRESS.                                * 14600020
*                                                                     * 14800020
*OUTPUT -- REGISTER 1 - ADDRESS OF ELEMENT TO BE RETURNED TO          * 15000020
*   OPERATOR CONTROL.                                                 * 15200020
*                                                                     * 15400020
*EXTERNAL ROUTINES -- IEDQHG02                                   S22025 15600022
*                     IEDQTNT                                    S22025 15700022
*                    AOS EXCPVR ROUTINE (SVC 114) - TO START A        * 15730005
*   CHANNEL PROGRAM.                                                  * 15760005
*                                                                     * 15800020
*EXITS-NORMAL -- STOPPED LCB IS POSTED TO OPERATOR CONTROL QCB.       * 16000020
*   EXIT IS TO THE TCAM DISPATCHER TO DO THE POST.                    * 16200020
*                                                                     * 16400020
*   THE LCB IS NOT FREE.  BITS ARE SET TO INDICATE IT IS TO BE        * 16600020
*   RETURNED BY THE SCHEDULERS WHEN I/O IS COMPLETE.  EXIT IS TO      * 16800020
*   THE DISPATCHER.                                                   * 17000020
*                                                                     * 17200020
*   FOR ATTENTION SIGNAL CHECKING EXIT IS TO LINE END APPENDAGE  S22025 17250022
*   VIA THE TCAM DISPATCHER.                                     S22025 17300022
*                                                                     * 17350022
*EXITS-ERROR -- N/A.                                                  * 17400020
*                                                                     * 17600020
*TABLES/WORK AREAS -- DSECTS OF THE TCAM DISPATCHER, THE AVT, LCB,    * 17800020
*   CCW, DCB, DEB, AND PRIORITY LEVELS.                               * 18000020
*                                                                     * 18200020
*ATTRIBUTES -- SERIALLY REUSABLE, REFRESHABLE, ENABLED, RESIDENT,     * 18400020
*   PROBLEM PROGRAM MODE.                                             * 18600020
*                                                                     * 18800020
*NOTES -- THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL       * 19000020
*   REPRESENTATION OF THE EXTERNAL CHARACTER SET.  THE CODING HAS     * 19200020
*   BEEN ARRANGED SO THAT REDEFINITION OF 'CHARACTER' CONSTANTS, BY   * 19400020
*   REASSEMBLY, WILL RESULT IN A CORRECT MODULE FOR THE NEW           * 19600020
*   DEFINITIONS.                                                      * 19800020
*                                                                     * 20000020
*********************************************************************** 20200020
         EJECT                                                          20250020
*        REGISTER EQUATES                                               20800020
R0       EQU   0                        REGISTER EQUATE          S21903 21000022
R1       EQU   1                        REGISTER EQUATE          S21903 21100022
RQCB     EQU   1                        QCB BASE REGISTER        S21101 21250020
RELE     EQU   2                                                        21400020
R2       EQU   2                        REGISTER               @OY14092 21500091
R3       EQU   3                        REGISTER EQUATE          S21903 21600022
RINVLIST EQU   3                        INVITATION LIST REGISTER S21101 21650020
RLCB     EQU   4                                                        21800020
R4       EQU   4                        REGISTER               @OY14092 21900091
RWORK    EQU   5                                                        22000020
R5       EQU   5                        REGISTER               @OY14092 22060091
RWORK1   EQU   6                        REGISTER               @OY14092 22120091
RDEB     EQU   6                                                        22200020
R7       EQU   7                        REGISTER EQUATE          S21903 22400022
RDCB     EQU   8                                                        22600020
ROFF     EQU   9                                                        23000020
R9       EQU   9                        REGISTER               @OY14092 23100091
RLINK    EQU   9                        REGISTER               @OY14092 23200091
RSCB     EQU   ROFF                                                     23300020
LOCKI    EQU   X'10'                    LOCK INQUIRY           @SA70889 23320061
RINV     EQU   10                       INVITATION LIST ADDR            23350020
RDISP    EQU   11                                                       23600020
RBASE    EQU   12                       BASE REGISTER            S21903 23800022
R13      EQU   13                       REGISTER EQUATE          S21903 24000022
R14      EQU   14                       REGISTER EQUATE          S21903 24200022
R15      EQU   15                       REGISTER EQUATE          S21903 24400022
*        OTHER EQUATES                                                  24600020
X1E      EQU   X'1E'                    DEVICE CHECK BYTE      @OY13669 24610091
X08      EQU   X'08'                    HEX EIGHT                S99228 24620022
X1A      EQU   X'1A'                                                    24650020
ZERO     EQU   0                        LENGTH CONSTANT          S21903 24700022
ONE      EQU   1                        LENGTH CONSTANT          S21903 24710022
TWO      EQU   2                        LENGTH CONSTANT          S21903 24720022
THREE    EQU   3                        THREE                    S99228 24730022
FOUR     EQU   4                        LENGTH CONSTANT          S21903 24750022
FIVE     EQU   5                        LENGTH CONSTANT          S21903 25150022
PRI      EQU   4                                                        25600020
SEVEN    EQU   7                        LENGTH CONSTANT          S21903 25650022
EIGHT    EQU   8                        LENGTH CONSTANT          S21903 25950022
TWELVE   EQU   12                       LENGTH CONSTANT          S21903 26250022
SIXTEEN  EQU   16                       LENGTH CONSTANT          S21903 26550022
CNDZERO  EQU   8                                                 S22025 27000022
UCB      EQU   X'20'                                                    27400020
HI       EQU   X'80'                                                    28000020
BDFLAG   EQU   X'80'                    INMSG COMPLETE FLAG    @YA10232 28100009
DIS      EQU   X'01'                    DISABLE MASK           @OY14491 28200091
OFFHI    EQU   X'FF'-DIS                                       @OY14491 28230091
X40      EQU   X'40'               INTERNAL STOPLN INDICATOR   @SA71514 28260061
XBF      EQU   X'BF'               RESET INT. STOPLN MASK      @SA71514 28320061
XDF      EQU   X'DF'                    TURN OFF HK PROC BIT   @OZ24311 28360000
PRISTOP  EQU   X'E8'                    USED TO RETURN A STOPPED        28400020
*                                         LINE TO OP CTL                28800020
*                                         USED BY IEDQHK                29000020
*                                         TESTED BY OPERATOR CONTROL    29200020
ENDILIST EQU   X'FE'                    END OF INVITATION LIST   S21101 29250020
REG2     EQU   2                                                        29280022
LOCKR    EQU   X'20'                   LOCK RESPONSE FROM PUT S SA54930 29290000
XTEN     EQU   X'10'                                             S22025 29310022
OPNCHK   EQU   X'AC'                   FLAG THAT A PREPARE IS UP S22025 29340022
UNITOFF  EQU   24                       OFFSET TO EXTRA UNIT   @OX14763 29346091
STCBOFF  EQU   20                       OFFSET TO STCB IN UNIT @OX14763 29352091
OPCDE    EQU   12                       OFFSET TO OCOPTCDE     @OX14763 29358091
TERMOFF  EQU   16                       OFFSET TO TERM ENTRY   @OX14763 29364091
*                                        ADDRESS               @OX14763 29370091
AD       EQU   7                        MASK                   @OX14763 29376091
OCICHNGE EQU   X'49'                    ICHNGE COMMAND         @OX14763 29382091
SWITCH   EQU   13                       OFFSET TO OCSWITCH     @OX14763 29388091
STOPMM   EQU   X'20'                    STOP TERM MID-MSG FLAG @OX14763 29394091
         EJECT                                                          29400020
OPTCAMLN EQU   X'2F'                    TO TEST FOR OPEN TCAM LINE      29450020
RLNDISP  EQU   X'66'                    DISP FROM OPCSAVE2 TO HEX       29500020
*                                       RLN IN OPCBITSW+1 FROM CV       29550020
CNTOFF   EQU   6                        OFFSET TO COUNT IN CCW @YA07691 29551061
ALL      EQU   15                       MASK                   @OY14092 29551191
AL3      EQU   3                        LENGTH OF 3            @OY14092 29551291
CBREAK   EQU   X'40'                    BREAK FEATURE          @OY14092 29551391
T4       EQU   24                       LENGTH OF 24           @OY14092 29551491
SCTEOT   EQU   0                        INDEX TO EOT OFFSET    @OY14092 29551591
DISCON   EQU   X'01'                    DISCONNECT NEEDED      @OY14092 29551691
SCTDLEOT EQU   X'10'                    INDEX TO DLEEOT OFFSET @OY14092 29551791
OFF11    EQU   11                       OFFSET 11              @OY14092 29551891
         EJECT                                                          29552061
HIOCC    EQU   X'48'                    HALT I/O COMPLETION CODE Y02027 29555006
         SPACE                                                          29560020
         USING IEDQDISP,RDISP                                           29600020
         USING IEDQQCB,RQCB             QCB DSECT BASE           S21101 29650020
         USING IEDQLCB,RLCB                                             29800020
         USING IEDQAVTD,R13                                             30000020
         USING IHADCB,RDCB                                              30200020
         USING IEDQSCB,RSCB                                             30300020
         USING DEBNMSUB,RDEB                                            30400020
*                                                                       30600020
IEDQHK   IEDHJN ,                                                S22025 30800022
         DC    AL1(DSPMCPL8)            STCB VTO               @OY14092 31000091
         DC    AL3(*-1)                 STCB ADDRESS             S22025 31200022
         DC    A(0)                     REQUEST QUEUE          @OY14092 31260091
         USING REQELE,RELE              REQUEST ADDRESS        @OY14092 31320091
IEDQHK01 EQU   *                                                        31400020
         USING IEDQHK01,RBASE                                           31600020
         LR    RBASE,R15                BASE                            31800020
         LR    RELE,R1                  COPY PARAMETER ADDRESS   CLUP21 32200022
         LR    RLCB,RELE                SET LCB ADDRESS        @OY14092 32300091
         CLI   PRI(RELE),PRIOPCTL       ELEMENT OR LCB                  32400020
         BE    SRCHLCBS                 BRANCH IF ELEMENT        CLUP21 32600022
         CLI   PRI(RELE),PRILCBAT       REQUEST TO TEST FOR ATTN S22025 32660022
         BE    CHKTNT                   YES, BRANCH              S22025 32720022
*                                                                       32800020
         LR    RLCB,RELE                LCB - SET IN LCB REG            32830091
         ST    RLCB,LCBQCBA-1           SET TO POST LCB TO SELF@OY15473 32836091
         CLI   LCBPRI,X'DD'             REQUEST FROM STARTLINE @OY15473 32842091
         BE    EXCP1                    YES, ISSUE EXCP        @OY15473 32848091
         ST    R7,LCBQCBA-1             SET TO REPOST LCB TO HK@OY15473 32854091
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @OY13669 32860091
         BZ    ICHNG                    GO SET LCB STOPPED     @OY13669 32920091
         TM    LCBRSPRI,DIS             IS EXCPVR ALREADY DONE @OY14491 34800091
         BNO   EXCP                     NO                              35000020
*                                                                       35200020
         L     R7,LCBSTCBA-1            GET FIRST STCB ADDRESS   CLUP21 35420022
         CLI   ZERO(R7),DSPSNDSC        IS IT SEND SCHEDULER     CLUP21 35440022
         BNE   ICHNG                    BRANCH IF NOT            CLUP21 35460022
         MVC   LCBSTCBA(3),FIVE(R7)     REMOVE SEND SCHED STCB   CLUP21 35480022
         MVC   FIVE(3,R7),ONE(R7)       SAVE IN DESTINATION QCB  CLUP21 35500022
         ST    R7,ZERO(R7)              CHAIN STCB TO ITSELF     CLUP21 35520022
         MVI   ZERO(R7),DSPSNDSC        SET TO SEND SCHEDULER    CLUP21 35540022
         SH    R7,HALF8                 BACK UP TO QCB           CLUP21 35560022
         SR    RWORK,RWORK              ZERO 'CURRENTLY CONNECTEDCLUP21 35580022
         STH   RWORK,LCBTTCIN           TERMINAL' INDICATOR      CLUP21 35600022
         LR    RWORK,RLCB               SAVE LCB ADDRESS         CLUP21 35620022
         L     R15,AVTDISP+4            GET SEND SCHEDULER ADDR  CLUP21 35640022
         SH    R15,AVTHA2               BACK UP TO OFFSET        CLUP21 35660022
         AH    R15,ZERO(R15)            COMPUTE ENTRY POINT      CLUP21 35680022
         BALR  R14,R15                  LINK TO SELECT NEW LINE  CLUP21 35700022
         LR    RLCB,RWORK               RESTORE LCB ADDRESS      CLUP21 35720022
         B     ICHNG                    CHECK FOR RETURN                35800020
*                                                                       36000020
EXCP     EQU   *                                                        36200020
         MVI   LCBTPCD+10,ZERO          ZERO TP CODE FOR TSO     CLUP21 36300022
         OI    LCBRSPRI,DIS             TURN ON EXCP INDICATOR @OY14491 36400091
         MVC   LCBTTBIN,LCBTTCIN        SAVE CURRENTLY CONNECT @OY14092 36406091
         SR    RWORK,RWORK              CLEAR                           36600020
         STH   RWORK,LCBTTCIN           CLEAR TTCIN                     36800020
         XC    LCBCPA(T4),LCBCPA        CLEAR CCW AREA         @OY14092 37000091
         LA    R1,LCBCPA                POINT TO START         @OY14092 37030091
         L     RDCB,LCBDCBPT            GET DCB ADDR           @OY14092 37060091
         L     RDCB,DCBSCTAD-1          GET SCT ADDR           @OY14092 37090091
         TM    LCBSTAT2,LCBSYNC         BI-SYNC                @OY14092 37120091
         BZ    NOEOT                    NO, CONTINUE           @OY14092 37150091
         TM    LCBTPCD+OFF11,DISCON     DISCONNECT NEEDED      @OY14092 37180091
         BZ    NOEOT                    NO, CONTINUE           @OY14092 37210091
         NI    LCBTPCD+OFF11,AVTEFF-DISCON  RESET DISCONNECT   @OY14092 37240091
         LA    RWORK,SCTDLEOT           GET DLEEOT INDEX       @OY14092 37270091
         IC    RWORK,ZERO(RWORK,RDCB)   GET OFFSET TO COUNT    @OY14092 37300091
         LTR   RWORK,RWORK              CHARS SPECIFIED        @OY14092 37330091
         BZ    NOEOT                    NO, BRANCH             @OY14092 37360091
         LA    RWORK,ZERO(RWORK,RDCB)   GET ADDR OF COUNT      @OY14092 37390091
         USING IEDQCCW,R1               ADDRESSABILITY         @OY14092 37420091
         MVC   CCWCOUNT+1(ONE),ZERO(RWORK) SET COUNT           @OY14092 37450091
         LA    RWORK,ONE(,RWORK)        BUMP TO CHARS          @OY14092 37480091
         ST    RWORK,CCWADDR-1          SET DATA ADDR          @OY14092 37510091
         MVI   CCWOPCDE,CCWWRITE        SET WRITE COMMAND      @OY14092 37540091
         MVI   CCWFLAGS,CCWCC+CCWSLI    SET CHAINING           @OY14092 37570091
         LA    R1,EIGHT(,R1)            BUMP CCW POINTER       @OY14092 37600091
NOEOT    EQU   *                                               @OY14092 37630091
         ST    RLCB,CCWADDR-1           SET ADDR               @OY14092 37660091
         MVI   CCWOPCDE,CCWDISAB        DISABLE COMMAND        @OY14092 37690091
         MVI   CCWFLAGS,CCWCC+CCWSLI    SET CHAINING           @OY14092 37720091
         MVI   CCWCOUNT+1,ONE           SET DISABLE COUNT      @OY14092 37750091
         LA    R1,EIGHT(,R1)            BUMP TO NEXT CCW       @OY14092 37780091
         ST    RLCB,CCWADDR-1           SET ADDR               @OY14092 37810091
         MVI   CCWOPCDE,CCWNOP          SET NOOP COMMAND       @OY14092 37840091
         MVI   CCWCOUNT+1,ONE           SET NOOP COUNT         @OY14092 37870091
         MVI   LCBTPCD,TWO              SET FIRST TPCODE       @OY14092 37900091
         MVC   LCBTPCD+ONE(TWO),LCBTPCD SET OTHER TPCODES      @OY14092 37930091
         DROP  R1                                              @OY14092 37960091
         USING IEDQQCB,RQCB                                    @OY14092 37990091
         SPACE                                                          38020091
         L     RWORK,AVTHK              STOPLINE QCB ADDRESS     CLUP21 38200022
         ST    RWORK,AVTEZERO(RLCB)     PUT IN QCB FLD OF LCB           39000020
         MVI   LCBTSTSW,AVTEFF          TURN ON TEST/SET SWITCH         39200020
         OI    LCBSTAT2,LCBNEGRP        SET NEG RESPONSE                39400020
EXCP1    LA    RWORK,LCBCPA             GET CHANNEL PROGRAM ADDR S22025 39600022
         ST    RWORK,LCBSTART-1         SET CHANNEL PROGRAM      CLUP21 39800022
*                                         START ADDRESS          CLUP21 39900022
         MVI   LCBINCAM,AVTEZERO        RESET RETRY COUNT      @OZ28736 39950086
         LA    R1,LCBFLAG1              IOB FOR IOS              CLUP21 40000022
         EXCPVR (1),SUBSYS                                       X01004 40200005
         TM    LCBTPCD+11,OPNCHK        RETURN FROM PREPARE ?    S22025 40220022
         BNO   DSPDISP                  NO EXIT                  S22025 40240022
         LA    R3,DSPDISP               GET RETURN ADDRESS       S22025 40260022
         L     RDCB,LCBDCBPT            GET DCB BASE             S22025 40280022
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          S22025 40300022
         B     HIO1                     GO DO HALT I/O           S22025 40320022
*                                                                       40400020
LOOPUNIT EQU   *                                               @OY13669 40500091
         L     RWORK,AVTEZERO(RWORK)    NEXT ELEMENT           @OY13669 40600091
         B     CHKLCB                   COMPARE LCB            @OY13669 40700091
*                                                              @OY13669 40800091
ICHNG    EQU   *                                                        41000020
         TM    LCBRSPRI,DIS             DISABLE DONE           @OY14491 41005091
         BO    EXCPDONE                 YES                    @OY13669 41010091
         L     RWORK,AVTOCGET           OPERATOR CONTROL AVT   @OY13669 41015091
         USING IEDQOPCD,RWORK                                  @OY13669 41020091
         L     RWORK,OPCWAITL           OP CTL STOPLINE LIST   @OY13669 41025091
         USING IEDQOPCE,RWORK                                  @OY13669 41030091
CHKLCB   EQU   *                                               @OY13669 41035091
         LTR   RWORK,RWORK              OPCE ADDRESS ZERO?     @OY20036 41035286
         BZ    FOUND                    YES                    @OY20036 41035486
         CLI   OCOPTCDE,OCVARY          VARY REQUEST           @OY14092 41035891
         BNE   GETREQ                   SKIP GROUP CHECK       @OY14092 41036691
         CLC   LCBDCBPT+1(THREE),OCMODNME+FIVE  SAME LINE GRP? @OY14092 41037491
         BNE   LOOPUNIT                 NO,LOOK AT NEXT        @OY14092 41038291
GETREQ   EQU   *                                               @OY14092 41039091
         L     R1,OCUNIT                PICK UP STOPLINE UNIT  @OY13669 41040091
         CLM   RLCB,SEVEN,SIXTEEN+ONE(R1) THIS LCB             @OY13669 41045091
         BE    FOUND                    YES,GO CHECK IT        @OY14092 41050091
         TM    OCFLAG,OCATTACH          ATTACHED REQUEST       @OY14092 41050891
         BZ    EXCPDONE                 NO, DON'T DISABLE      @OY14092 41051691
         L     RWORK,OCELEM             GET NEXT               @OY14092 41052491
         B     GETREQ                                          @OY14092 41053291
FOUND    EQU   *                                               @OY14092 41054091
         SPACE                                                          41055091
         MVI   LCBSTAT1,LCBOCNI+LCBRECVN SET STATUS            @OY13669 41060091
         LTR   RWORK,RWORK              OPCE ADDRESS ZERO?     @OY20036 41061086
         BZ    CKLOCAL                  YES,CHECK FOR LOCAL    @OY20036 41062086
         TM    OCSWITCH,X40             LINE TO BE RESTARTED   @OY13669 41065091
         BO    EXCPDONE                 YES, DO NOT DISABLE    @OY13669 41068091
CKLOCAL  EQU   *                                               @OY20036 41069086
         CLI   LCBRSKEY,X1E             LOCAL DEVICE ?         @OY13669 41071091
         BNE   EXCP                     GO SET LCB STOPPED     @OY13669 41072091
EXCPDONE EQU   *                                               @OY13669 41075091
         NI    LCBRSPRI,OFFHI           RESET DISABLE          @OY13669 41080091
         SPACE                                                          41085091
         MVI   LCBPRI,PRISTOP           SET LINE STOPPED PRTY  @OZ29091 41100086
         TM    LCBINSRC+2,TWO           LCB IN TIME DELAY        S22025 41120022
         BNO   FFREE                    NO-BR                    S22025 41140022
*                                                                S22025 41160022
         LR    R1,RLCB                  SET TO REMAVE LCB FROM   S22025 41180022
         L     R15,AVTHG02              TIME DELAY QUEUE         S22025 41200022
         BALR  R14,R15                  REMOVE LCB FROM QUEUE    S22025 41220022
*                                                                S22025 41240022
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL LINE      S22025 41260022
         BO    FFREE                    YES-BYPASS               S22025 41280022
*                                                                S22025 41300022
         CLI   LCBRSKEY,X1A             BUFFERED TERMINAL        S22025 41320022
         BE    FFREE                    YES-BR                   S22025 41340022
*                                                                S22025 41360022
         LA    R7,LCBRSKEY              PUTIN THE RECIEVE        S22025 41380022
         LR    R1,R7                    SCHEDULER                S22025 41400022
         BAL   R14,DSPPRIOR             BACK ON QUEUE            S22025 41420022
*                                                                S22025 41440022
FFREE    EQU   *                                                        41600020
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN              @OY16355 41603000
         BO    GETOFF                   YES, LOG USERS OFF     @OY16355 41604000
         L     RWORK,AVTOCGET           GET WORKAREA ADDRESS   @OY16355 41606000
         ICM   RWORK,AD,OPCWAITL+1-IEDQOPCD(RWORK) GET FIRST RE@OY16355 41609000
GRPCHK   EQU   *                                               @OY16355 41610000
         BZ    POSTLCB                  NONE THERE             @OY16355 41612000
         CLC   LCBDCBPT+1(THREE),OCMODNME+FIVE   SAME GROUP    @OZ28940 41615086
         BE    FOUNDGRP                 YES, BRANCH            @OY16355 41616000
         ICM   RWORK,AD,ONE(RWORK)      NO, GET NEXT           @OY16355 41618000
         B     GRPCHK                   GO CHECK NEXT          @OY16355 41621000
FOUNDGRP EQU   *                                               @OY16355 41622000
         L     RELE,OCUNIT              GET ADDR OF QHK REQ    @OY16355 41624000
         CLM   RLCB,AD,REQLCBA          CORRECT REQUEST        @OY16355 41627000
         BE    OFFQUE                   YES, GO CHECK OPTION   @OY16355 41628000
         TM    OCFLAG,OCATTACH          ANY MORE REQUESTS      @OY16355 41630000
         BZ    POSTLCB                  NO, BRANCH             @OY16355 41633000
         ICM   RWORK,AD,OCELEM+ONE      GET RELATED ONE        @OY16355 41634000
         B     FOUNDGRP                 GO CHECK               @OY16355 41636000
OFFQUE   EQU   *                                               @OY14092 41648091
         TM    REQOPT,LOGOFF            FORCE LOGOFF REQUESTED @OY14092 41651091
         BZ    POSTLCB                  NO, BRANCH TO OPCTL    @OY19040 41652000
GETOFF   EQU   *                                               @OY19040 41654000
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN              @OY19040 41654100
         BZ    ALRDYSET                 NO,ALREADY SET         @OY19040 41654200
         L     RWORK,AVTOCGET                                  @OY19040 41654300
         ICM   RWORK,AD,OPCWAITL+1-IEDQOPCD(RWORK)             @OY19040 41654400
*                                       TOP REQUEST            @OY19040 41654500
         L     RELE,OCUNIT              STOPLINE UNIT          @OY19040 41654600
ALRDYSET EQU   *                                               @OY19040 41654700
         LR    R1,RELE                  SET REGISTER FOR       @OY19040 41654800
*                                       INVSCAN                @OY19040 41655000
         CLI   REQPRI,AVTEZERO          HAS PRTY BEEN ZEROED   @OY19040 41655100
         BE    GOSCAN                   YES                    @OY19040 41655200
         SR    R1,R1                    SET REG FOR INVSCAN    @OY19040 41655300
GETNEXT  EQU   *                                               @OY19040 41655400
         TM    OCFLAG,OCATTACH          ANY MORE REQUESTS      @OY19040 41655500
         BZ    GOSCAN                   NO                     @OY19040 41655600
         ICM   RWORK,AD,OCELEM+ONE      GET RELATED ONE        @OY19040 41655700
         L     RWORK1,OCUNIT            GET ADDR OF HK REQ     @OY19040 41655800
         CLI   REQPRI-REQELE(RWORK1),AVTEZERO                  @OY19040 41655900
*                                     HAS PRIORITY BEEN ZEROED @OY19040 41656000
         BNE   GETNEXT                  GET NEXT ELEMENTS      @OY19040 41656100
         LR    R1,RWORK1                SET REG FOR INVSCAN    @OY19040 41656200
GOSCAN   EQU   *                                               @OY19040 41656300
         BAL   RLINK,INVSCAN            SCAN FOR SESSIONS      @OY14092 41657091
*        B     POSTLCB                  POST LCB               @OY14092 41660091
POSTLCB  EQU   *                                               @OY14092 41663091
         L     RDCB,LCBDCBPT            GET DCB ADDRESS        @SA70195 41670061
         SR    RWORK,RWORK              CLEAR FOR IC           @SA70195 41740061
         IC    RWORK,LCBUCBX            GET RLN - 1            @SA70195 41810061
         SLL   RWORK,2                  SHIFT RLN              @SA70195 41840061
         L     RWORK,DCBINVLI(RWORK)    GET INVLIST ADDRESS    @SA70195 41880061
         LA    RWORK,AVTECD8(RWORK)     POINT TO FIRST ENTRY   @SA70195 41950061
         ST    RWORK,AVTDOUBL           SAVE IN WORK AREA      @SA70195 42020061
         MVC   LCBINVPT,AVTDOUBL+1      SET CURRENT I LIST PTR @SA70195 42090061
         LA    RWORK,AVTOPCOB           GET OP CTL QCB ADDR             42200020
         LR    R1,RLCB                                                  42300020
         ST    RWORK,LCBQCBA-1          SET QCB ADDRESS          CLUP21 43000022
         MVI   LCBSTAT1,AVTEZERO        SET LINE STOPPED       @OZ29091 43700086
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN              @OZ24311 43710000
         BNO   NOCLS                    NORMAL PROCESSING      @OZ24311 43720000
         L     RWORK,AVTOCGET           OPERATOR CTL AVT       @OZ24311 43730000
         USING IEDQOPCD,RWORK                                  @OZ24311 43740000
         L     RWORK,OPCWAITL           GET WAITL CHAIN        @OZ24311 43750000
         USING IEDQOPCE,RWORK                                  @OZ24311 43760000
         CLC   OCBACKUP(TWO),MODZ1      CLOSEDOWN OPCE         @OZ24311 43770000
         BNE   NOCLS                    STILL IN IGCZ110D      @OZ24311 43780000
         NI    OCSWITCH,XDF             TURN HK PROC SWTCH OFF @OZ24311 43790000
NOCLS    EQU   *                        NOT CLOSEDOWN          @OZ24311 43800000
         XC    LCBINSRC,LCBINSRC        CLEAR LCB OF LOCK       SA66918 43900054
         L     RSCB,LCBSCBA-1           SCB ADDRESS             SA66918 44100054
         NI    SCBSTATE,AVTEFF-(SCBLCK1N+SCBMSGLN) CLEAR LOCK   SA66918 44300054
         L     RWORK,LCBSTCBA-1         GET FIRST STCB         @OX14763 44360091
         CLC   AVTEZERO(FOUR,RWORK),STOPSTCB THIS MODULE       @OX14763 44420091
         BNE   DSPPOST                  NO, GO POST            @OX14763 44480091
         MVC   LCBSTCBA(THREE),FIVE(RWORK) DELINK STCB         @OX14763 44540091
         B     DSPPOST                  RETURN                          44600020
*                                                                       44800020
SETBIT   EQU   *                                                        45000020
         OI    LCBSTAT1,LCBOCNI         REQUEST LCB FROM SCHED   CLUP21 45600022
         L     R1,UNITOFF(RELE)         GET EXTRA UNIT FOR     @OX14763 45620091
*                                       BFRD STOP TERMINAL     @OX14763 45720091
         LTR   R1,R1                    IS ONE THERE           @OX14763 45820091
         BZ    DSPDISP                  NO, EXIT               @OX14763 45920091
         MVC   STCBOFF(ENDSTOP-STOPSTCB,R1),STOPSTCB INSERT    @OX14763 46020091
*                                       STOPLN STCB IN UNIT    @OX14763 46120091
         LA    R1,STCBOFF(R1)           GET STCB ADDR          @OX14763 46220091
         LA    R7,LCBSTCBA-1            SET TO INSERT STCB     @OX14763 46320091
         B     DSPPRIO                  GO INSERT IT           @OX14763 46420091
*                                                                       47200020
SRCHLCBS EQU   *                                               @OY14092 47400091
         L     RLCB,REQLCBA-ONE         SET LCB ADDRESS        @OY14092 47940091
         CLI   LCBSTAT1,AVTEZERO        IS LCB STOPPED         @OZ30095 47943086
         BE    DSPDISP                  YES, EXIT              @OZ30095 47946086
         LH    R9,LCBTTCIN              PICK UP TTCIN          @OY19040 47950000
         ST    R9,REQPRI                STORE IN STOPLINE ELE  @OY19040 47960000
         TM    REQOPT,CKTSO             TSO CHECK REQUESTED    @OY14092 47970091
         BZ    CONTINHK                 NO,CONTINUE            @OY14092 48000091
         LR    R1,RELE                  SET REG FOR INVSCAN    @OY19040 48010000
         BAL   RLINK,INVSCAN            SCAN INVLIST           @OY14092 48030091
         B     CONTINHK                 NO TSO FOUND           @OY14092 48060091
TSOERR   EQU   *                                               @OY14092 48090091
         SPACE                                                          48369820
         LR    R1,RELE                  YES, PASS ELEM BACK TO CV       48379820
         LA    RWORK,AVTOPCOB           GET OP CTL QCB ADDR             48389820
         ST    RWORK,ZERO(RELE)         PUT OP CTL QCB ADDR IN ELEM     48391820
         MVI   FOUR(RELE),PRISTOP       SET E8 PRI FOR USE IN CV        48393820
         B     DSPPOST                  RETURN TO TELL CV THAT THIS     48395820
*                                       LINE NOT STOPPED DUE TO TSO     48397820
         SPACE                                                          48398220
         SPACE                                                          48399420
CONTINHK EQU   *                                                        48399520
         L     RLCB,SIXTEEN(RELE)       PICK UP LCB ADDRESS      CLUP21 48399822
         L     RDEB,REQDEBA             GET DEB ADDR           @OY14092 49399891
TESTACT  EQU   *                                                        51700020
         TM    LCBSTAT1,LCBFREEN        LINE ALREADY FREE               52200020
         BO    DIALCHK                  YES-BR                   S22025 52400022
         SPACE 2                                                        52600022
         TM    EIGHT(RELE),HI           HALT LINE IMMEDIATE      S22025 52620022
         BO    HIO                      YES, BRANCH              S22025 52640022
         SPACE 2                                                        52660022
         TM    LCBSTAT1,LCBSENDN+LCBRECVN  LCB MARKED AS SENDING S22025 52680022
*                                          AND RECEIVING         S22025 52700022
         BO    ICHNG                    YES, BRANCH              S22025 52720022
         SPACE 2                                                        52740022
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL LINE      S22025 52800022
         BNO   ACT                      NO-BR                    S22025 53000022
*                                                                S22025 53200022
         TM    AVTBIT1,AVTCLOSN         CLOSE DOWN IN PROGRESS   S22025 53400022
         BO    HIO                      YES-BR                   S22025 53600022
         TM    LCBTSTSW,HI                                       S22025 53800022
         BO    ACT                      YES-BR                   S22025 54000022
*                                                                S22025 54200022
TST      EQU   *                                                        54800020
         TS    LCBTSTSW                 BEEN SET BEFORE          CLUP21 55000022
         BZ    HIO                      BRANCH IF NOT TO HALTIO  CLUP21 55200022
*                                                                       55400020
         B     SETBIT                   GO REQUEST LCB           S22025 55600022
DIALCHK  EQU   *                                                 S22025 55800022
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL LINE      S22025 55900022
         BNO   SETFREE                  NO-BR                    S22025 56000022
         L     R14,LCBSCBA-1            GET DIAL SCB ADDR        S22025 56100022
         TM    SCBQTYPE-IEDQSCB(R14),SCBBFMM MIDDLE OF MSG       S22025 56200022
         BO    SETBIT                   YES-BR                   S22025 56300022
         MVI   LCBSTAT1,LCBOCNI+LCBRECVN TURN ON STOPLINE BIT  @OY11167 56350081
         B     EXCP                     SET LINE STOPPED       @OY11167 56400081
SETFREE  EQU   *                                                        56800020
         SR    R15,R15                  CLEAR REGISTER           S99228 56950022
         IC    R15,LCBUCBX              PICK UP RLN              S99228 56955022
         SLL   R15,TWO                  MULTIPLY BY FOUR         S99228 56960022
         L     RDCB,LCBDCBPT            PICK UP DCB ADDR         S99228 56965022
         L     RINVLIST,DCBINVLI(R15)   PICK UP INVLIST ADDR     S99228 56970022
         CLI   LCBRSKEY,X1A             BUFFERED TERMINALS       S99228 56975022
         BE    QHK010                   YES, GO CHECK LINE STATUSS99228 56980022
         SR    R1,R1                    CLEAR REGISTER           S99228 56985022
         IC    R1,DCBEIOBX              INSERT LENGTH OF IOB     S99228 56990022
         SH    R1,AVTHA4                REDUCE LCB LENGTH BY 8   S99228 56995022
         SH    R1,AVTHA4                BYTES TO POINT TO EXTEN. S99228 57000022
         LA    R15,ZERO(R1,RLCB)        PICK LCB EXTEN. ADDR.    S99228 57005022
         USING IEDQLCBX,R15             SET ADDRESSABILITY       S99228 57010022
         TM    LCBXFLAG,LCBGPCTV+LCBERPND G.P. OR ERP ACTIVE     S99228 57015022
         BZ    ICHNG                    NO, SET LCB STOPPED      S99228 57020022
         TM    AVTBIT1,AVTCLOSN         IS CLOSEDOWN IN PROGRESS        57021022
         BO    ICHNG                    YES, SET LCB STOPPED            57022022
         B     SETBIT                   YES, GO REQUEST LCB      S99228 57025022
QHK010   EQU   *                                                 S99228 57030022
         L     RINVLIST,DCBINVLI(R15)   GET THE INVITATION LIST  S21101 57051020
*                                         ADDRESS FOR THIS LINE  S21101 57051520
         CLI   FOUR(RINVLIST),ZERO      ARE WE CURRENTLY SENDING S21101 57052020
*                                         TO ANY STATIONS ON     S21101 57052520
*                                         THIS LINE              S21101 57053020
         BNE   SETBIT                   YES, SET THE STOP LINE   S21101 57053520
*                                         REQUEST BIT AND WAIT   S21101 57054020
*                                         FOR A SCHEDULER TO     S21101 57054520
*                                         POST THE LCB TO IEDQHK S21101 57055020
         CLI   ONE(RINVLIST),ZERO       ARE WE CURRENTLY         S21101 57055520
*                                         RECEIVING FROM ANY     S21101 57056020
*                                         STATIONS ON THIS LINE  S21101 57056520
         BE    ICHNG                    NO, LINE CAN BE TAKEN    S21101 57057020
         LA    RDEB,ICHNG               SET RETURN ADDR          S22025 57057222
         EJECT                                                          57057520
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  S21101 57058020
*                                                             *  S21101 57058520
*        THIS SUBROUTINE WILL COMPUTE THE ADDRESS OF A        *  S21101 57059020
*        DESTINATION QCB BASED ON THE INVITATION LIST         *  S21101 57059520
*                        POINTER                              *  S21101 57060020
*                                                             *  S21101 57060520
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  S21101 57061020
GETQCBAD EQU   *                                                 S21101 57061520
         LA    RWORK,EIGHT(RINVLIST)    GET THE ADDRESS OF THE   S21101 57062020
*                                         FIRST INVITATION LIST  S21101 57062520
*                                         ENTRY                  S21101 57063020
         SR    RDCB,RDCB                CLEAR A WORK REGISTER    S21101 57063520
         IC    RDCB,TWO(RINVLIST)       GET THE SIZE OF EACH     S21101 57064020
*                                         ILIST ENTRY            S21101 57064520
DECISIZE EQU   *                                                 S21101 57065020
         LR    R14,RDCB                 COPY THE SIZE                   57065520
         BCTR  R14,0                    REDUCE THE SIZE BY 1     S21101 57066020
         IC    R14,ZERO(R14,RWORK)      PICK UP THE INDEX TO THE S21101 57066520
*                                         TNT OFFSET             S21101 57067020
         AR    R14,R14                  DOUBLE TO COMPUT THE     S21101 57067520
*                                         ILIST OFFSET           S21101 57068020
         LR    R15,RINVLIST             COPY THE ADDRESS OF THE  S21101 57068520
*                                         INVITATION LIST        S21101 57069020
         SR    R15,R14                  SUBTRACT THE INDEX FROM  S21101 57069520
*                                         THE BEGINNING ADDRESS  S21101 57070020
         LH    R1,ZERO(R15)             GET THE TNT OFFSET       S21101 57070520
         L     R15,AVTRNMPT             GET THE ADDRESS OF THE   S21101 57071020
*                                         TNT CONVERSION ROUTINE S21101 57071520
         BALR  R14,R15                  BRANCH AND LINK TO IT    S21101 57072020
         SPACE 3                                                        57072520
         L     RQCB,ZERO(R1)            LOAD THE DESTINATION     S21101 57073020
*                                         QCB ADDRESS                   57073520
         SR    R0,R0                    CLEAR                    S22025 57074022
         SR    R14,R14                  REGS FOR                 S22025 57074222
         SR    R15,R15                  INDEXING                 S22025 57074422
         IC    R14,QCBSCBOF             GET SCB OFFSET           S22025 57074622
         IC    R15,AVTSCBSZ             GET SCB SIZE             S22025 57074822
         MR    R14,R14                 SIZE  X OFFSST EQ INDEX   S22025 57075022
         L     R14,LCBSCBDA-1           SCB DIRECTORY POINTER    S22025 57075222
         LA    R15,ZERO(R14,R15)        GET SCB ADDR             S22025 57075422
         TM    SCBQTYPE-IEDQSCB(R15),SCBBFMM MIDDLE OF MSG       S22025 57075622
         BO    SETBIT                   YES RETURN               S22025 57075822
         SPACE 3                                                        57076020
         AR    RWORK,RDCB               INCREMENT THE CURRENT    S21101 57076520
*                                         ILIST POINTER          S21101 57077020
         CLI   ZERO(RWORK),ENDILIST     IS THIS THE END OF THE   S21101 57077520
*                                         INVITATION LIST        S21101 57078020
         BCR   CNDZERO,RDEB             YES-BR                   S22025 57078522
         CLI   ONE(RWORK),ENDILIST      IS THIS THE END OF THE   S21101 57079020
*                                         INVITATION LIST        S21101 57079520
         BCR   CNDZERO,RDEB             YES-BR                   S22025 57080022
         B     DECISIZE                 COMPUTE NEXT QCB ADDRESS S21101 57080520
         EJECT                                                          57081020
ACT      EQU   *                                                        57600020
         CLI   LCBCPA+24,CCWPOLL        AUTOPOLL LINE            CLUP21 57800022
         BNE   BSC                      BRANCH IF NOT            CLUP21 58000022
*                                                                       58200020
         ST    RLCB,AVTSAVE2            LCB POINTER              Y05331 58210005
         L     R1,AVTSAVTP              SECONDARY AVT POINTER    Y05331 58220005
         USING IEDNSVTD,R1                                       Y05331 58230005
         TM    SAVTDIAF,SAVTVIRT        RUNNING UNDER VM  ?      Y05331 58240005
         BZ    NOVIRT                  * NO,BRANCH               Y05331 58250005
         L     R15,SAVTDIAG             VIRTUAL DIAGNOSE ROUTINE Y05331 58260005
         DROP  R1                                                Y05331 58270005
         LA    R0,LCBCPA+56             TIC ADDRESS              Y05331 58280005
         ST    R14,AVTSAVE2+24          R14 POSSIBLY NEDDS SAVINGY05331 58290005
         MVI    LCBCPA+56,CCWNOP        NOP VIRTUAL TIC          Y05331 58300005
         BAL   R14,4(,R15)              NOP CORRESPONDING REALTICY05331 58310005
         L     R14,AVTSAVE2+24     RESTORE R14                   Y05331 58320005
         B     SETBIT                   GO REQUEST LCB           Y05331 58330005
         SPACE                                                          58340005
NOVIRT   EQU   *                                                 Y05331 58350005
         MVI   LCBCPA+56,CCWNOP         SET NOP IN CCW           CLUP21 58400022
         B     SETBIT                   GO REQUEST LCB           CLUP21 58600022
*                                                                       58800020
BSC      EQU   *                                                        59000020
         TM    LCBSTAT2,LCBSYNC         BI-SYNCH LINE            CLUP21 59200022
         BNO   SENSE                    BRANCH IF NOT            CLUP21 59400022
*                                                                       59600020
         CLI   LCBCPA+16,CCWPREP        PREPARE ON THE LINE      CLUP21 59800022
         BNE   SETBIT                   BRANCH IF NOT            CLUP21 60000022
*                                                                       60200020
         B     TST                      RETURN TO TEST-AND-SET   CLUP21 60400022
*                                                                       60600020
SENSE    EQU   *                                                        60800020
         L     RWORK,LCBCPA+24          ADDRESS THE SENSE BYTE   CLUP21 60900022
         CLI   LCBCPA+24,CCWSENSE       SENSE COMMAND            CLUP21 61000022
         BE    CLI                      BRANCH IF YES            CLUP21 61100022
*                                                                       61400020
         CLI   LCBCPA+32,CCWSENSE       WORLD TRADE              CLUP21 61600022
         BNE   SETBIT                   BRANCH IF NOT            CLUP21 61800022
*                                                                       62000020
         L     RWORK,LCBCPA+32          ADDRESS THE SENSE BYTE   CLUP21 62300022
*                                                                       62600020
CLI      EQU   *                                                        63200020
         CLI   LCBCSWSV,AVTEFF          HAS DATA ALREADY BEEN    X01004 63400005
*                                       ENTERED                  X01004 63500005
         BNE   SETBIT                   NO, GO REQUEST LCB       CLUP21 63600022
*                                                                       63800020
HIO      EQU   *                                                        64000020
         LA    R3,SETBIT                SET UP BRANCH AFTER EXCP S22025 64100022
         OI    LCBSTAT1,LCBOCNI         REQUEST LCB                     64200020
         L     RSCB,LCBSCBA-1           POINT TO THE SCB         CLUP21 64260022
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN LCB IN LOCK MODE      SA54930 64280000
         BZ    HIO1                    NO, PROCEED              SA54930 64300000
         NI    SCBSTATE,X'FF'-(SCBLCK1N+SCBMSGLN) TURN OFF LOCK         64320020
         TM    LCBINSRC+2,LOCKR+LOCKI   AFTER LOCK & BEFORE PUT@SA70889 64330061
         BNZ   LOCKCLR                  YES, BRANCH            @SA70889 64340061
CLRINSRC EQU   *                                               @YA10232 64345009
         XC    LCBINSRC(3),LCBINSRC    CLEAR LCB LOCK FLAGS     SA54930 64350000
HIO1     EQU   *                                                 S22025 64360022
         SR    RWORK,RWORK              CLEAR                           64600020
         IC    RWORK,LCBUCBX            GET UCB INDEX                   64800020
         SLL   RWORK,TWO                MULTIPLY BY FOUR                65000020
         L     R1,UCB(RDEB,RWORK)       GET UCB ADDR                    65200020
         LA    R1,ZERO(R1)              CLEAR HIGH ORDER BYTE    CLUP21 65300022
         MVI   LCBECBCC,HIOCC           SET HALT I/O COMPLETION  Y02027 65350006
         IOHALT (1)                     HALT I/O ON LINE                65400020
*                                                                       65600020
         LTR   R15,R15                  RETURN CODE ZERO        SA67759 65630005
         BZR   R3                       YES, HIO COMPLETE       SA67759 65660005
         SR    R15,R15                  CLEAR FOR COMPARE      @ZA02055 65690061
         CLM   R15,15,LCBCSW+THREE      DID CHANNEL PROGRAM    @ZA02055 65700061
*                                        COMPLETE               SA67759 65720005
         BZ    HIO1                     NO, REISSUE HIO         SA67759 65750005
         BR    R3                       IF PROCESSING OP CONTROL S22025 65800022
*                                       BRANCH TO SET STOPLINE   S22025 65804022
*                                       BIT.  IF CHECKING FOR AN S22025 65808022
*                                       ATTENTION SIGNAL EXIT TO S22025 65812022
*                                       DSPDISP                  S22025 65816022
         SPACE 5                                                        65820022
CHKTNT   EQU   *                                                        65840022
         LR    RLCB,RELE                GET LCB BASE             S22025 65860022
ISSPRP   MVC   LCBCSWSV(7),LCBCSW       SAVE CSW                 S22025 65880022
         MVC   LCBCPA(8),PREPCCW        SET UP PREPARE CCW       S22025 65900022
         STCM  RLCB,7,LCBCPA+1          VALID FIXED CORE ADDR    Y01004 65910005
         MVI   LCBTPCD,XTEN             SET UP TP OP CODE        S22025 65920022
         MVI   LCBTPCD+11,OPNCHK        SET OPEN LINE CHECK      S22025 65940022
         B     EXCP1                    GO ISSUE PREPARE         S22025 65960022
LOCKCLR  EQU   *                                                        65963000
         LH    R1,LCBTTCIN             TERMINAL INDEX           SA54930 65966000
         L     R15,AVTRNMPT            ADDRESS OF ENABLED SRCH  SA54930 65969000
         USING IEDQTNTD,R15            ADDRESSABILITY           SA54930 65972000
         BAL   R14,TNTCODE             GET TERMINAL ENTRY       SA54930 65975000
         DROP  R15                                              SA54930 65978000
         USING IEDQTRM,R1                                       SA54930 65981000
         L     R1,TRMDESTQ-1           GET QCB ADDRESS          SA54930 65984000
         USING IEDQQCB,R1                                       SA54930 65987000
         MVI   QCBLKRLN,ZERO           CLEAR LOCK REL LINE      SA54930 65990000
         TM    LCBINSRC+2,BDFLAG        HAS INMSG COMPLETED    @YA10232 65991009
         BO    CLRINSRC                 NO, ISSUE THE HIO      @YA10232 65992009
         XC    LCBINSRC(3),LCBINSRC    CLEAR LCB LOCK FLAGS     SA54930 65993000
         B     ICHNG                                                    65996091
INVSCAN  EQU   *                                                        65997091
         SR    R3,R3                    CLEAR FOR INDEX        @OY14092 65998091
         IC    R3,LCBUCBX               GET RLN                @OY14092 65999091
         SLL   R3,TWO                   MULTIPLY BY FOUR                66000091
         L     RDCB,LCBDCBPT            GET DCB ADDRESS        @OY18823 66001000
         L     RINV,DCBINVLI(R3)        GET CORRECT INVLIST    @OY14092 66003091
         LA    RWORK,SEVEN(,RINV)       POINT TO LIST -7       @OY14092 66004091
         SR    R3,R3                    CLEAR FOR COUNTER      @OY14092 66005091
         IC    R3,ONE(,RINV)            GET ACTIVE ENTRIES     @OY14092 66006091
         LTR   R3,R3                    ANY ACTIVE             @OY14092 66007091
         BZR   RLINK                    NO, RETURN TO CALLER   @OY14092 66008091
         L     R15,AVTRNMPT             GET LOOKUP RTN ADDR    @OY14092 66009091
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @OY14092 66010091
         BZ    NOTDIAL                  NO, CONTINUE           @OY14092 66011091
         LTR   R1,R1                    VALID STOPLINE ELEMENT @OY19040 66011500
*                                       FOUND                  @OY19040 66012000
         BZ    NOTDIAL                  NO USE INVLIST         @OY19040 66012200
         LH    R1,REQLINK+ONE-REQELE(R1) PICK UP TTCIN TO USE  @OY19040 66012400
         LTR   R1,R1                    ONE THERE              @OY14092 66013091
         LA    R3,ONE                   SET COUNT TO 1         @OY14092 66014091
         BH    GETENTRY                 BRANCH IF ONE THERE    @OY14092 66015091
         IC    R3,ONE(,RINV)            RESTORE TO ACT ENTRIES @OY14092 66016091
NOTDIAL  EQU   *                                               @OY14092 66017091
         SR    R7,R7                    CLEAR LENGTH           @OY14092 66018091
         IC    R7,TWO(,RINV)            GET ENTRY WIDTH        @OY14092 66019091
TSOLOOP  EQU   *                                               @OY14092 66020091
         AR    RWORK,R7                 BUMP TO NEXT           @OY14092 66021091
         SR    R0,R0                    CLEAR FOR INDEX        @OY14092 66022091
         IC    R0,ZERO(,RWORK)          GET INDEX              @OY14092 66023091
         SLL   R0,ONE                   DOUBLE INDEX           @OY14092 66024091
         LR    R1,RINV                  POINT TO LIST          @OY14092 66025091
         SR    R1,R0                    BACK UP TO OFFSET      @OY14092 66026091
         LH    R1,ZERO(,R1)             GET TNT OFFSET         @OY14092 66027091
         TM    AVTBIT1,AVTCLOSN         CLOSING DOWN           @OY18823 66027300
         BO    GETENTRY                 BRANCH IF YES          @OY18823 66027600
         LH    R0,REQTTCIN              GET SPECIFIED TERM     @OY14092 66028091
         LTR   R0,R0                    ONE SPECIFIED?         @OY14092 66029091
         BZ    GETENTRY                 NO, CONTINUE           @OY14092 66030091
         CR    R1,R0                    CORRECT ONE            @OY14092 66031091
         BNE   CONTLOOP                 NO, GET NEXT           @OY14092 66032091
         LA    R3,ONE                   SET LOOP COUNT         @OY14092 66033091
GETENTRY EQU   *                                               @OY14092 66034091
         BALR  R14,R15                  LOCATE TERMINAL ENTRY  @OY14092 66035091
         USING IEDQQCB,R1                                      @OY14092 66036091
         LR    RDEB,R1                  SAVE TERM ENTRY        @OY14092 66037091
         L     R1,TRMDESTQ-1-IEDQTRM(,R1) GET QCB ADDR         @OY14092 66038091
         TM    QCBFLAG,QCBTSSES         IN SESSION?            @OY14092 66039091
         BZ    CONTLOOP                 NO,CONTINUE            @OY14092 66040091
         TM    AVTBIT1,AVTCLOSN         CLOSING DOWN           @OY18823 66040300
         BO    FORCE                    BRANCH IF YES          @OY18823 66040600
         TM    REQOPT,LOGOFF            FORCE LOGOFF           @OY14092 66041091
         BZ    CKTTCIN                  NO,CONTINUE CHECKS     @OY14092 66042091
FORCE    EQU   *                                               @OY18823 66042500
         STM   R0,R15,REGSAVE           SAVE REGISTERS         @OY14092 66043091
         TM    QCBTSOF1,QCBDELAY        QCB IN TIME DELAY QUE  @OY14092 66044091
         BZ    CKTJID                   NO, CONTINUE           @OY14092 66045091
         L     R15,AVTHG02              ADDR OF DELAY REMOVER  @OY14092 66046091
         BALR  R14,R15                  REMOVE FROM TIME DELAY @OY14092 66047091
CKTJID   EQU   *                                               @OY14092 66048091
         NC    QCBTJID(TWO),QCBTJID     TJID ZERO              @OY14092 66049091
         BZ    NONTSO                   YES,ALREADY LOGGED OFF @OY14092 66050091
         L     RWORK,CVTPTR             GET CVT ADDR           @OY14092 66051091
         L     R2,CVTASVT-CVTMAP(,RWORK)  ASVT ADDRESS         @OY14092 66052091
         TM    AVTBIT3,AVTTSAB          HAS TSO ABENDED        @OY14092 66053091
         BO    NONTSO                   BRANCH YES             @OY14092 66054091
         SR    R5,R5                    CLEAR FOR ID           @OY14092 66055091
         ICM   R5,THREE,QCBTJID         GET TSO JOB ID         @OY14092 66056091
         BZ    NONTSO                   BRANCH NON THERE       @OY14092 66057091
         BCTR  R5,ZERO                  SUBTRACT ONE           @OY14092 66058091
         SLL   R5,TWO                   MULTIPLY BY FOUR       @OY14092 66059091
         L     R2,ASVTENTY-ASVT(R5,R2)  ASCB ADDR              @OY14092 66060091
         L     R9,ASCBTSB-ASCB(,R2)     TSB ADDR               @OY14092 66061091
         LR    R7,R1                    QCB ADDR               @OY14092 66062091
         LR    R1,R13                   SAVE AREA ADDR         @OY14092 66063091
         TM    AVTBIT3,AVTTSAB          TSO ABENDED            @OY14092 66064091
         BO    NONTSO                   YES, BRANCH            @OY14092 66065091
         QTIP  4,(1)                    CALL HANGUP            @OY14092 66066091
NONTSO   EQU   *                                               @OY14092 66067091
         LM    R0,R15,REGSAVE           RESTORE ALL REGS       @OY14092 66068091
         NI    QCBFLAG,AVTEFF-QCBTSSES-QCBREAD-QCBNOBRK        @OY14092 66069091
*                                       RESET STATUS           @OY14092 66070091
         NI    QCBDSFLG,AVTEFF-QCBALTMH RESET ALTERNATE MH     @OY14092 66071091
         MVI   QCBRETCT,AVTEZERO        CLEAR RETRY COUNT      @OY14092 66072091
         XC    QCBCARCT(THREE),QCBCARCT CLEAR CARR.CT & TJID   @OY14092 66073091
         XC    QCBSATCT(THREE),QCBSATCT CLEAR SIMATTN COUNT    @OY14092 66074091
         SR    R14,R14                  CLEAR REGISTER         @OY14092 66075091
         IC    R14,TRMCHCIN-IEDQTRM(,RDEB) GET INDEX           @OY14092 66076091
         BCTR  R14,ZERO                 SUBTRACT ONE           @OY14092 66077091
         SLL   R14,TWO                  MULTIPLY BY FOUR       @OY14092 66078091
         A     R14,AVTCSTCS             ADD TABLE POINTER      @OY14092 66079091
         TM    ONE(R14),CBREAK          BREAK SPECIFIED        @OY14092 66080091
         BO    SETBRK                   YES,BRANCH             @OY14092 66081091
         OI    QCBFLAG,QCBNOBRK         SET NO BREAK           @OY14092 66082091
SETBRK   EQU   *                                               @OY14092 66083091
         B     CONTLOOP                 CONTINUE               @OY14092 66084091
CKTTCIN  EQU   *                                               @OY14092 66085091
         NC    REQTTCIN(TWO),REQTTCIN   TERMINAL SPECIFIED     @OY14092 66086091
         BNZ   FOUR(RLINK)              YES, RETURN ERROR      @OY14092 66087091
         OI    LCBSTAT1,LCBOCWTN        INDICATE REQUEST WAIT'G@OY14092 66088091
         B     DSPDISP                  RETURN ERROR TO CALLER @OY14092 66089091
CONTLOOP EQU   *                                               @OY14092 66090091
         BCT   R3,TSOLOOP               CHECK NEST ENTRY       @OY14092 66091091
         BR    RLINK                    RETURN TO CALLER       @OY14092 66092091
         EJECT                                                 @OY14092 66093091
MINUS8   DC    H'-8'                    NEGATIVE EIGHT         @OY14092 66094091
REGSAVE  DC    16F'0'                   REGISTER SAVEAREA      @OY14092 66095091
HALF8    DC    H'8'                     TO BACK UP PTR TO QCB    S22025 66100022
PREPCCW  DC    X'06',AL3(*),X'200000BC' PREPARE CCW              S22025 67100022
MODZ1    DC    C'Z1'                    MOD ID TO MATCH        @OZ24311 67101000
STOPSTCB DS    0F                       FULL WORD ALIGNMENT    @OX14763 67102091
         DC    AL1(DSPMCPL8)            8-BYTE STCB            @OX14763 67104091
         DC    AL3(BFRDSTOP)            ROUTING ADDRESS        @OX14763 67106091
         DC    X'B0',AL3(0)             LINK FIELD AND PRI     @OX14763 67108091
         L     R15,AVTEZERO(R3)         GET ROUTINE ADDRESS    @OX14763 67110091
         BR    R15                      BRANCH TO IT           @OX14763 67112091
ENDSTOP  EQU   *                                               @OX14763 67114091
         USING *,R15                                           @OX14763 67116091
BFRDSTOP EQU   *                        SUBROUTINE FOR BFRD    @OX14763 67118091
*                                        STOP TERMINAL         @OX14763 67120091
         LR    RLCB,R1                  LCB ADDRESSABILITY     @OX14763 67122091
         LR    RELE,R3                  STCB ADDRESS           @OX14763 67124091
         SH    RELE,BACKUP              BACK UP TO UNIT        @OX14763 67126091
         ICM   R3,AD,FIVE(R3)           GET ADDR OF NEXT STCB  @OX14763 67128091
         LA    R1,ZERO(,R1)             CLEAR FOR COMPARE      @OX14763 67130091
         LA    R7,ZERO(,R7)             CLEAR FOR COMPARE      @OX14763 67132091
         CR    R1,R7                    LCB POSTED             @OX14763 67134091
         BNE   DSPBYPAS                 NO, BYPASS TO SCHEDULER@OX14763 67136091
         TM    LCBSTAT1,LCBSENDN        LCB MARKED AS SENDING  @OX14763 67138091
         BO    DSPBYPAS                 YES,EXIT               @OX14763 67140091
         CLI   OPCDE(RELE),OCICHNGE     ICHNGE COMMAND         @OX14763 67142091
         BE    POSTHK                   YES, POST LCB TO HK    @OX14763 67144091
*                                        FOR STOPLINE          @OX14763 67146091
         L     RWORK,TERMOFF(RELE)      TERM ENTRY ADDRESS     @OX14763 67148091
         USING IEDQTRM,RWORK            TERM ENTRY ADDR'BILITY @OX14763 67150091
         L     RWORK,TRMDESTQ-1         GET QCB ADDR           @OX14763 67152091
         USING IEDQQCB,RWORK            QCB ADDRESSABILITY     @OX14763 67154091
         TM    SWITCH(RELE),STOPMM      STOP TERM MID-MSG      @OX14763 67156091
         BZ    CHECKMM                  NO, CHECK MID-MSG      @OX14763 67158091
         TM    QCBSTAT,QCBSEND          TERMINAL SENDING       @OX14763 67160091
         BO    DSPBYPAS                 YES, EXIT              @OX14763 67162091
POSTHK   EQU   *                                               @OX14763 67164091
         MVC   LCBQCBA,AVTHK+1          SET TO POST TO HK      @OX14763 67166091
         MVI   LCBPRI,PRILNFRE          SET POST PRIORITY      @OX14763 67168091
         STCM  R3,AD,LCBSTCBA           REMOVE SPECIAL STCB    @OX14763 67170091
         B     DSPPOST                  POST LCB TO HK         @OX14763 67172091
CHECKMM  EQU   *                                               @OX14763 67174091
         SR    RDCB,RDCB                CLEAR FOR INDEX        @OX14763 67176091
         LR    RSCB,RDCB                CLEAR FOR INDEX        @OX14763 67178091
         IC    RDCB,QCBSCBOF            GET SCB INDEX          @OX14763 67180091
         IC    RSCB,AVTSCBSZ            GET SCB SIZE           @OX14763 67182091
         MR    RDCB,RDCB                OFFSET TO SCB          @OX14763 67184091
         AL    RSCB,LCBSCBDA-1          GET SCB ADDRESS        @OX14763 67186091
         TM    SCBQTYPE,SCBBFMM         MIDDLE OF MSG          @OX14763 67188091
         BO    DSPBYPAS                 YES, EXIT              @OX14763 67190091
         B     POSTHK                   POST LCB TO STOPLN     @OX14763 67192091
BACKUP   DC    AL2(STCBOFF)             OFFSET OF STCB IN UNIT @OX14763 67194091
         TTNTD                                                          67200000
REQELE   DSECT                          REQUEST ELEMENT        @OY14092 67206091
REQQCB   DS    F .                      QCB ADDR               @OY14092 67212091
REQPRI   DS    XL1 .                    PRIORITY               @OY14092 67218091
REQLINK  DS    AL3 .                    LINK FIELD             @OY14092 67224091
REQOPT   DS    XL1 .                    OPTION BYTE            @OY14092 67230091
IMMED    EQU   X'80' .                  IMMEDIATE REQUEST      @OY14092 67236091
INTREQ   EQU   X'40' .                  INTERNAL REQUEST       @OY14092 67242091
CKTSO    EQU   X'20' .                  TSO CHECK REQUIRED     @OY14092 67248091
LOGOFF   EQU   X'10' .                  FORCE LOGOFF           @OY14092 67254091
REQCHAIN DS    AL3 .                    CHAIN OF RELATED REQ'S @OY14092 67260091
REQDEBA  DS    F .                      ADDRESS OF DEB         @OY14092 67266091
         DS    X .                                             @OY14092 67272091
REQLCBA  DS    AL3                      ADDRESS OF LCB         @OY14092 67278091
REQTTCIN DS    H .                      TERMINAL ENTRY INDEX   @OY14092 67284091
REQRLN   DS    XL1 .                    RELATIVE LINE NO       @OY14092 67290091
         SPACE 3                                                        67300022
         TDISPD                                                         67600020
         EJECT                                                          67650020
         TSCBD                                                          67700020
         TAVTD 2                                                        67800020
         TLCBD                                                          68000020
         TCCWD                                                          68200020
         TPRIOR                                                         68400020
         DCBD  DSORG=TX                                                 68600020
         TDEBD                                                          68800020
         TTRMD                                                          68850020
         TQCBD                                                          68900020
         CVT                                                   @OY14092 68902091
         IHAASCB                                               @OY14092 68904091
         IHAASVT                                               @OY14092 68906091
         TOPCED                                                @OY13669 68910091
         TOPCAVTD                                              @OY13669 68920091
         IEFUCBOB                                                       68950020
         END                                                            69000020
