WTOR     TITLE '''IEDQOB''-WTOR INTERPRETER'                            00080020
IEDQOB   CSECT                                                          00160020
*A000000-999999                                                @G36XRNP 00160210
         SPACE 3                                                 S21903 00160405
*  CHANGE ACTIVITY AS FOLLOWS                                           00160805
******************** MICROFICHE FLAGS *********************** SUPT CODE 00161205
*A001620,002500-003000,135285,628400,638600-639000,640400       SA51078 00161605
*A654500-654900,657600-659400                                   SA51078 00161705
*D657600-659200                                                 SA51078 00161805
*A117600                                                         S21101 00161905
*C133600                                                         S21101 00162005
*A135200                                                         S21101 00162105
*C136000                                                         S21101 00162205
*D140000                                                         S21101 00162305
*C162800-165600                                                  S21101 00162405
*D167200                                                         S21101 00162505
*C172400-173200                                                  S21101 00162605
*A176000                                                         S21101 00162705
*C179200-182400,187200,279200-283200                             S21101 00162805
*D285600-326400                                                  S21101 00162905
*C394400,396800-400800,575200-578400,704800-708800               S21101 00163005
*A736000,948000,951200                                           S21101 00163105
*D955200                                                         S21101 00163205
*A959200                                                         S21101 00163305
*D960000-967840,969600                                           S21101 00163405
*A135583,432830-433490                                           S22024 00163505
*C194400,202400-338400,362400,369000-369400                      S22024 00163605
*C959220-959350,959490-959706                                    S22024 00163705
*C532000,535200-536000,9516000                                   S22024 00163805
*A 950400                                                       SA63008 00163905
*C 459200                                                       SA63008 00164005
*C959454,959535,919715                                           X03039 00174007
*D369000,432830,433070,959445,959530,959710                      X03039 00184007
*C532000,535200-536000,951600                                    S05331 00194052
*A361200,A403280-403840,A624020-624660,D959427-959454,           Y05331 00194105
*A959427-959459,A959526-959527,C959530-959531,C959700-959703     Y05331 00194205
*C612000                                                       @SA70222 00204256
*A185600,187600                                                @SA70307 00214256
*A369200,432800,959451,959530                                    X03039 00224207
*A135583,369300,433070,959535,959711                           @X50X9NI 00224309
*A135586,624520                                                @ZA07074 00224481
*C959526-959527                                                @ZA07074 00224581
*A403360                                                       @OZ06187 00224691
*A056000,064000,132800,366400,369350,385600,432830,432980      @Y17XANG 00227600
*A659400,959535,959537,959715,972000                           @Y17XANG 00230600
*C005000,059200,064000,365600-366400,948800                    @Y17XANG 00233600
*D433040-433071,959720                                         @Y17XANG 00236600
*D431500-431700,443400-443800                                  @Y17XANA 00237600
*C532000,535200-536000,951600                                  @Y17XANU 00238600
         SPACE 3                                                 S21903 00240005
*          TCAM LEVEL 10.0 MVS CHANGES                         @G36XRNP 00250010
*A036000,056720,119600,135290,135440,135588,160000,369390      @G36XRNP 00260010
*A638800,642400,645600,649600,652800,654700,654800,659596      @G36XRNP 00270010
*A736080,959466,959541,959727                                  @G36XRNP 00280010
*A628400,638800,642400,645600,649600,652800,654700654900       @OS77945 00285010
*A640400                                                       @OS77945 00290010
*A557660,557740,952000                                         @OZ17630 00295010
*********************************************************************** 00300005
*                                                                     * 00320005
*  TITLE: IEDQOB - WTOR INTERPETER                                    * 00340005
*                                                                     * 00360005
*  MODULE NAME = IEDQOB (TCAM,INITIALIZATION)                  @G36XRNP 00380010
*                                                                     * 00400005
*  DESCRIPTIVE NAME = WTOR INTERPETER                                 * 00420005
*                                                                     * 00440005
*  COPYRIGHT = 'NONE'                                                 * 00460005
*                                                                     * 00480005
*STATUS -- CHANGE LEVEL 10.0                                   @G36XRNP 00490010
*                                                                     * 00560020
*FUNCTION -- THIS ROUTINE ACCEPTS FROM THE OPERATOR NEW VALUES TO     * 00640020
*   REPLACE THOSE VALUES SPECIFIED AT ASSEMBLY TIME ON CERTAIN        * 00720020
*   KEYWORDS ON INTRO MACRO.  THIS PERMITS SYSTEM REDEFINITION        * 00800020
*   WITHOUT REASSEMBLY.                                               * 00880020
*                                                                     * 00960020
*ENTRY POINTS -- CALLED ONLY FROM 'IEDQOA'                            * 01040020
*        'IEDQOB' - INTERPRET OPERATOR RESPONSES                      * 01120020
*   CALLING SEQUENCE IS                                               * 01200020
*        LINK  EP=IEDQOB                                       @G36XRNP 01280010
*                                                                     * 01600020
*INPUT -- REGISTERS AT INPUT MUST BE SET AS FOLLOWS -                 * 01680020
*   REG 1 - ADDRESS OF AVT                                            * 01760020
*   REG 13- ADDRESS OF CALLER'S SAVEAREA                              * 01840020
*   REG 14- RETURN ADDRESS                                            * 01920020
*   REG 15- ENTRY POINT ADDRESS                                       * 02000020
*   ADDITIONAL DATA IS RECEIVED FROM THE OPERATOR AS RESPONSES        * 02080020
*   TO REQUESTS MADE BY WTOR.                                         * 02160020
*                                                                     * 02240020
*OUTPUT -- CERTAIN FIELDS OF THE AVT HAVE BEEN MODIFIED ACCORDING     * 02320020
*   TO OPERATOR'S REPLY.  ALL REGISTERS ARE RETURNED INTACT.          * 02400020
*                                                                     * 02480020
*EXTERNAL ROUTINES -- SUPERVISOR IS CALLED TO PROVIDE 'WTOR' AND      * 02560020
*   'WAIT' FUNCTIONS.                                                 * 02640020
*                                                                     * 02720020
*EXITS-NORMAL -- RETURN IS MADE TO IEDQOA.  USER HAS SPECIFIED        * 02800010
*   ONE OF THESE INTRO OPERANDS IN RESPONSE TO WTOR REQUESTS.  @G36XRNP 02810010
*                                                              @G36XRNP 02820010
*     CPB - NUMBER OF CHANNEL PROGRAM BLOCKS  - REQUIRED IF    @G36XRNP 02830010
*           DISK=YES IS SPECIFIED                              @G36XRNP 02840010
*     EITHER ON INTRO OPERANDS OF IN RESPONSES TO WTOR REQUESTS -     * 02880010
*     LNUNITS - NUMBER OF LINE BUFFERS                                * 02960010
*     KEYLEN - LENGTH OF KEY PORTION OF DATA RECORD                   * 03040010
*     START - WARM OR COLD                                            * 03120010
*     OTHER FIELDS OF AVT MAY HAVE BEEN ALTERED ALSO. (OPTIONAL)      * 03200010
*     RETURN CODE IN REGISTER 15 IS ZERO.                             * 03280010
*                                                                     * 03360020
*EXITS-ERROR -- RETURN CODE IN REGISTER 15 IS 4.  THE TCAM WORD IN    * 03440020
*   THE CVT IS NON-ZERO, INDICATING ANOTHER TCAM IS ACTIVE.           * 03520020
*               RETURN CODE IN REGISTER 15 IS 28.  THE TCB     @G36XRNP 03540010
*               INDICATES THAT THE TCAM MCP IS UNAUTHORIZED    @G36XRNP 03560010
*                                                                     * 03600020
*TABLES-WORK AREAS -- CERTAIN FIELDS IN AVT MAY HAVE BEEN MODIFIED.   * 03680020
*        INTRO KEYWORD    RESPONSES KEYWORD  AVT FIELD  FIELD LENGTH  * 03760020
*        STARTUP          S                 AVTBIT3    4 BITS         * 03840020
*        LNUNITS          B                 AVTNOLBF   2 BYTES        * 03920020
*        MSUNITS          M                 AVTTOTNC   4 BYTES        * 04000020
*        KEYLEN           K                 AVTKEYLE   2 BYTES        * 04080020
*        UNITSZ           K                 AVTKEYLE   2 BYTES        * 04130020
*        RESTART          N                 AVTCKRST   1 BYTE         * 04180020
*        CPINTVL          V                 AVTCKELV   2 BYTES        * 04250020
*        CONTROL          L                 AVTCTLCH   8 CHARS        * 04320020
*        PRIMARY          P                 AVTDOUBX   8 CHARS        * 04400020
*        INTVAL           I                 AVTINTLV   2 BYTES        * 04480020
*        PASSWRD          W                 AVTPASWD   8 CHAR         * 04560020
*        CKREQS           R                 AVTNCKPR   1 BYTE         * 04640020
*        CPB              D                 AVTCPBNO   2 BYTES        * 04720020
*        CPRCDS           E                 AVTCPRCD   1 BYTE         * 04800020
*        CROSSRF          F                 AVTCRSRF   4 BYTES        * 04880020
*        COMWRTE          G                 AVTCWFL1   1 BIT          * 04960020
*        TOPMSG           H                 AVTBIT2    1 BIT          * 05040020
*        TRACE            T                 AVTRACE    4 BYTES        * 05120020
*        DTRACE           A                 AVTDISTR   4 BYTES        * 05200020
*        CIB              C                 AVTCIB     2 BYTES        * 05280020
*        MSMIN            Y                 AVTCMIN    4 BYTES        * 05360020
*        MSMAX            X                 AVTCMAX    4 BYTES        * 05440020
*        DLQ              Q                 AVTDLQX    8 BYTES        * 05520020
*        OLTEST           O                 AVTOLTST   1 BYTE         * 05600020
*        BRACKET          BR                SAVTBSM    4 BYTES @Y17XANG 05608000
*        OPMASK           OP                AVTOPMSK   4 BYTES @Y17XANG 05616000
*        PLCBNO           PL                AVTPLCBN   2 BYTES @Y17XANG 05624000
*        SUBAREA          SA                SAVTSUBV   1 BYTE  @Y17XANG 05632000
*        MAXSUBA          MA                SAVTSUBA   1 BYTE  @Y17XANG 05640000
*        BTRACE           BT                SAVTPIUT   4 BYTES @Y17XANG 05648000
*        TTRACE           TT                SAVTPIUT   4 BYTES @Y17XANG 05656000
*        SIBCNT           SB                SAVTSIBC   2 BYTES @Y17XANG 05664000
*        VM               Z                 SAVTDIAF   1 BYTE  @Y17XANG 05672000
*        APWAS            WA                AVTEW      2 BYTES @G36XRNP 05674010
*        AUTHA            AU                AVTEW+2    1 BIT   @G36XRNP 05676010
*   OTHER INTRO KEYWORDS CANNOT BE MODIFIED BY OPERATOR.              * 05680020
*                                                                     * 05760020
*   IF INTRO IS ASSEMBLED WITH KEYLEN, CPB (OR DISK=NO), STARTUP,     * 05840020
*   LNUNITS AND SUBAREA(OR FEATURES=NO3705 OR NOVTAM)          @Y17XANG 05860000
*   SPECIFIED, THE OPERATOR IS NOT GIVEN                       @Y17XANG 05880000
*   THE OPPORTUNITY TO MODIFY ANY INTRO VALUES AT EXECUTION TIME      * 06000020
*   SINCE THIS ROUTINE WILL SKIP ISSUEING THE 'WTOR'.  TO BE ABLE     * 06080020
**  TO MAKE EXECUTION TIME MODIFICATIONS, AT LEAST ONE OF THESE       * 06160020
*   FOUR MUST BE OMITTED FROM THE INTRO ASSEMBLY.                     * 06240020
*                                                                     * 06320020
*   FOLLOWING MACROS ARE USED TO GENERATE DSECTS - TAVTD,CVT,  @Y17XANG 06340000
*   TMSKD,TTCBD. THE FOLLOWING SYSTEM MACROS ARE USED - WTO,   @Y17XANG 06360000
*   WTOR, WAIT, DOM, RETURN, SAVE.                             @Y17XANG 06380000
*                                                                     * 06480020
*ATTRIBUTES -- TRANSIENT, NON-REUSABLE, NON-REFRESHABLE, ENABLED,     * 06560020
*   PROBLEM PROGRAM MODE                                              * 06640020
*                                                                     * 06720020
*NOTES -- THE OPERATION OF THIS SUBROUTINE DEPENDS UPON AN INTERNAL   * 06800020
*   REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT  * 06880020
*   TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED   * 06960020
*   SO THAT REDIFINITION OF 'CHARACTER' CONSTANTS, BY REASSEMBLY,     * 07040020
*   WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.          * 07120020
*                                                                     * 07200020
*   MESSAGES TO OPERATOR -                                            * 07280020
*  'IED001I TCAM JOB JJJJJJJJSSSSSSSSPPPPPPPP ADDRESS OF AVT AAAAAAAA'* 07360010
*        'JJJJJJJJ' - JOB NAME                                        * 07440020
*        'SSSSSSSS' - STEP NAME                                       * 07520020
*        'PPPPPPPP' - PROC STEP NAME.                                 * 07600020
*        'AAAAAAAA' - ADDRESS OF AVT                           @G36XRNP 07640010
*   'IED002A SPECIFY TCAM PARAMETERS'                                 * 07680020
*        SYSTEM WAITS FOR USER RESPONSE.  REPLY MUST BE LIMITED       * 07760020
*        TO 41 CHARACTERS.  RESPONSE IS BY KEYWORDS,SEPARATED BY      * 07840020
*        COMMAS.  SEVERAL KEYWORDS MAY BE CODED IN ONE RESPONSE,      * 07920020
*        SUBJECT TO THE 55 CHARACTER LIMIT.  THE RESPONSE FIELD       * 08000000
*        IS INTERPRETED LEFT TO RIGHT.  AN ERROR IN ONE KEYWORD       * 08080020
*        PREVENTS INTERPRETATION OF OTHER KEYWORD FURTHER TO THE      * 08160020
*        RIGHT IN THAT SAME RESPONSE.  A KEYWORD MAY BE RECORDED      * 08240020
*        TO MODIFY A VALUE PREVIOUSLY CODED AS A RESPONSE.  THIS      * 08320020
*        ROUTINE WILL CONTINUE TO REPEAT THE ABOVE REQUEST FOR        * 08400020
*        INPUT UNTIL THE USER INDICATES THAT HE HAS NOTHING ELSE      * 08480020
*        TO SAY.  THIS IS INDICATED BY CODING 'U' AS LAST KEYWORD.    * 08560020
*        USER MAY CODE EITHER THE SINGLE LETTER KEYWORD OR THE FULL   * 08640020
*        KEYWORD AS IT APPEARS IN INTRO.                              * 08720020
*        KEYWORDS MAY BE EITHER UPPER OR LOWER CASE.                  * 08800020
*   'IED003A INVALID KEYWORD XXXXXX'                                  * 08880020
*        'XXXX' - FIRST 4 CHARACTERS OF UNDEFINED KEYWORD.  ALL       * 08960020
*        KEYWORDS TO THE RIGHT OF THIS ARE IGNORED.  KEYWORDS TO      * 09040020
*        THE LEFT OF ERROR HAVE BEEN INTERPRETED.                     * 09120020
*   'IED004A REQUIRED PARAMETER MISSING. SPECIFY XX'                  * 09200020
*        THE USER CODED 'U' INDICATING HE WAS THRU.  THIS STATEMENT   * 09280020
*        REMINDS HIM OF A REQUIRED PARAMETER HE HAS YET TO CODE.      * 09360020
*        'XX' IS THE KEYWORD NEEDED.  USER SHOULD REPLY WITH THE      * 09440020
*        INDICATED KEYWORD (OR ANY KEYWORDS) JUST AS IF HE HAD        * 09520020
*        NEVER SAID 'U' YET.  HE MUST AGAIN INDICATE HE IS THRU       * 09600020
*        RESPONDING BY CODING 'U'.  THE REQUIRED KEYWORDS WHICH       * 09680020
*        MAY BE CALLED FOR HERE ARE 'STARTUP ='(COLD OR        @Y17XANG 09760000
*        WARMSTART), 'LNUNITS='(NUMBER OF LINE BUFFERS),       @Y17XANG 09800000
*        'KEYLEN='(SIZE OF A BUFFER), 'CPB='(NUMBER OF CPBS,   @Y17XANG 09920000
*        REQUIRED ONLY IF DISK IS BEING USED BY SPECIFYING     @Y17XANG 09960000
*        DISK=YES ON INTRO), 'SUBAREA='(REQUIRED ONLY IF       @Y17XANG 10000000
*        FEATURES=MIXED3705 OR ONLY3705 IS SPECIFIED ON INTRO) @Y17XANG 10040000
*        OR 'VM='.                                             @Y17XANG 10080000
*   'IED005A MSUNITS(M) SPECIFICATION NOT PERMITTED.  CONTINUE        * 10160020
*        RESPONSE'                                                    * 10240020
*        USER HAS CODED THE 'M=' KEYWORD TO SET THE NUMBER OF CORE    * 10320020
*        QUEUE RECORDS, BUT CORE QUEUEING WAS NOT SPECIFIED AT INTRO  * 10400020
*        ASSEMBLY TIME.  THE 'M=' RESPONSE IS LEGAL ONLY IF CORE      * 10480020
*        QUEUEING (INTRO MSUNITS=YES OR INTEGER) WAS SPECIFIED AT     * 10560020
*        ASSEMBLY TIME.                                               * 10640020
*   'IED006A INVALID OPERAND ON KEYWORD.  RESPECIFY XX'               * 10720020
*        'XX -- KEYWORD CONTAINING ILLEGAL VALUE.  ALL KEYWORDS       * 10800020
*        IN THIS RESPONSE AFTER THE ILLEGAL ONE ARE IGNORED.  ALL     * 10880020
*        KEYWORDS UP TO THIS KEYWORD HAVE BEEN INTERPRETED.           * 10960020
*   'IED014I TCAM ALREADY IN SYSTEM'                                  * 11040020
*        THE TCAM WORD IN THE CVT WAS FOUND TO BE NON-ZERO, INDICAT-  * 11120020
*        ING THAT ANOTHER PARTITION(REGION) HAS AN ACTIVE TCAM.       * 11200020
*        SINCE TWO TCAMS CANNOT COEXIST, THIS ROUTINE RETURNS         * 11280020
*        IMMEDIATELY TO IEDQOA WITH AN ERROR CODE OF 4.               * 11360020
*   THIS ROUTINE IS ON SYS1.LINKLIB AND IS LINKED TO BY IEDQOA, THE   * 11440020
*   TCAM NON-RESIDENT START UP ROUTINE WHICH WAS ITSELF LINKED TO     * 11520020
*   BY 'INTRO'                                                        * 11600020
*                                                                     * 11680020
*                                                                     * 11760020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 11800021
         EJECT                                                 @Y17XANG 11820000
*                                                                       11840020
R15      EQU   15                       ENTRY ADDRESS, TEMP BASE        11870020
*                                       RETURN CODE -                   11900020
*                                         0 - NORMAL                    11930020
*                                         4 - TCAM ALREADY IN SYSTEM    11960020
*                                        28 - MCP UNAUTHORIZED @G36XRNP 11970010
R14      EQU   14                       RETURN ADDRESS TO IEDQOA        11990020
*                                       RETURN ADDRESS FROM INTERNAL    12020020
*                                         SUBROUTINES, 'HALFNO' AND     12050020
*                                         'CHAR8'                       12080020
R13      EQU   13                       CALLERS SAVEAREA ADDRESS        12110020
RAVT     EQU   13                       AVT DSECT BASE (AVTSAVE4)       12140020
RBASE    EQU   12                       PROGRAM BASE                    12170020
RESERVD  EQU   11                       KEYWORD TABLE SEARCH LOOP       12200020
*                                         STOPPING POINT                12230020
RBUMP    EQU   10                       INCREMENTOR (VALUE 2) IN        12260020
*                                         KEYWORD TABLE SEARCH LOOP     12290020
RINDEX   EQU   9                        INDEX TO LIST OF KEYWORDS       12320020
RTEMP    EQU   8                        TEMPORARY STORAGE, WORK REG     12350020
RCNT     EQU   7                        NUMBER OF BYTES IN OPERAND      12380020
RANS     EQU   6                        BINARY EQUIVALENT OF DECODED    12410020
*                                         INTEGER OPERANDS, SET BY      12440020
*                                         'NUMCONV' ROUTINE             12470020
REND     EQU   5                        ADDRESS OF FIRST CHARACTER      12500020
*                                         BEYOND OPERAND, SET BY        12530020
*                                         'SCAN' ROUTINE                12560020
RESUL    EQU   4                        ADDRESS OF AVT FIELD TO BE      12590020
*                                         MODIFIED                      12620020
RX       EQU   3                        RETURN ADDRESS FROM INTERNAL    12650020
*                                         SUBROUTINES, 'SCAN' AND       12680020
*                                         'NUMCONV'                     12710020
RSTART   EQU   2                        SCAN POINTER TO RESPONSE TEXT   12740020
*                                         ADDRESS OF START OF KEYWORD   12770020
*                                         OR START OF OPERAND           12800020
R1       EQU   1                        AS INPUT, AVT ADDRESS           12830020
*                                         TEMPORARY USE - HAS CVT       12860020
*                                         ADDRESS, TCAM WORD IN CVT,    12890020
*                                         PARAMETER PASSER TO 'WTO',    12920020
*                                         ADDR OF TAG 'BACK'            12950020
R0       EQU   0                        UNUSED                          12980020
*                                                                       13280020
REOT     EQU   R15                      END OF MASK TABLE REG  @Y17XANG 13300000
RDLIM    EQU   R14                      CURRENT SCAN DELIM FOR @Y17XANG 13320000
*                                       OPMASK ROUTINE         @Y17XANG 13340000
         USING *,R15                    TEMPORARY BASE           S21101 13360021
         USING IEDQAVTD,RAVT                                            13440020
*                                                                       13520020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 13521021
*                                                                S21101 13522021
*                       EQUATES                                  S21101 13523021
*                                                                S21101 13524021
Y        EQU   C'Y'                     STARTUP=Y                S21101 13525021
I        EQU   C'I'                     STARTUP=I                S21101 13526021
W        EQU   C'W'                     STARTUP=W                S21101 13527021
C        EQU   C'C'                     STARTUP=C                S21101 13528021
E        EQU   C'E'                     STARTUP=E               SA51078 13528110
N        EQU   C'N'                     N=NO                   @G36XRNP 13528210
AUTHBIT  EQU   X'80'                    AUTHORIZATION = YES    @G36XRNP 13528510
NOAUTRQD EQU   X'FF'-AUTHBIT            AUTHORIZATION = NO     @G36XRNP 13528610
AUTHKEY6 EQU   X'60'                    AUTHORIZED KEY 6       @G36XRNP 13528710
*                                                                S21101 13529021
COMMA    EQU   C','                     FIELD SEPARATOR IN REPLY S21101 13530021
XF0      EQU   X'F0'                    CLEARS LOW 4 BITS IN BYTES21101 13531021
*                                       TESTS FOR CHAR AS X'F-'  S21101 13532021
REPLYBIT EQU   X'01'                    BIT IN 'FLAG'            S21101 13533021
*                                         '1'-WTOR HAS BEEN ISSUES21101 13534021
*                                         '0'-NO WTOR YET        S21101 13535021
TABSIZ   EQU   2                        LENGTH OF EACH ENTRY IN  S21101 13536021
*                                         'OPTABLE'              S21101 13537021
EQUAL    EQU   8                        CONDITIONAL BRANCH MASK  S21101 13538021
D0       EQU   0                       CONSTANT EQUATE FOR ZERO  S21903 13538505
AL       EQU   8                        NO. CHARS IN AVT ADDRESS S21101 13539021
T2       EQU   2                        TIMES 2                  S21903 13539205
T3       EQU   3                        TIMES 3                  S21903 13539405
ZERO     EQU   0                        ZERO                     S21903 13539605
XFF      EQU   X'FF'                    HEX FF                   S21903 13539805
W2       EQU   4                        OFFSET TO SECOND WORD    S21101 13540021
W3       EQU   8                        OFFSET TO THIRD WORD     S21101 13541021
IDS      EQU   8                        LENGTH OF JOBNAME,       S21101 13542021
*                                         PROCNAME, AND          S21101 13543021
*                                         PROCSTEPNAME           S21101 13544021
TWO      EQU   2                        OFFSET                 @G36XRNP 13544310
AVTECD28 EQU   28                       ERROR CODE FOR IEDQOA  @G36XRNP 13544610
TIOTJOB  EQU   0                        OFFSET INTO TIOT OF      S21101 13545021
*                                         JOBNAME                S21101 13546021
TIOTPROC EQU   8                        OFFSET INTO TIOT OF      S21101 13547021
*                                         PROCNAME               S21101 13548021
TIOTSTEP EQU   16                       OFFSET INTO TIOT OF      S21101 13549021
*                                         STEPNAME               S21101 13550021
LREPLY   EQU   55                       REPLY LENGTH             S21101 13551000
KEY4     EQU   4                        KEYWORD LENGTH OF 4      S21101 13552021
KEY6     EQU   6                        KEYWORD LENGTH OF 6      S21101 13553021
KEY7     EQU   7                        KEYWORD LENGTH OF 7      S21101 13554021
KEY8     EQU   8                        KEYWORD LENGTH OF 8      S21101 13555021
LKEYWORD EQU   8                        LENGTH OF KEYWORD ID MAXIS21101 13556021
L8       EQU   8                        LENGTH OF DOUBLEWORD     S21101 13557021
INC      EQU   1                        INCREMENTOR TO NEXT BYTE S21101 13558021
E3       EQU   3                        TABLE ENTRY LENGTH       S22024 13558322
ONE      EQU   1                        CONSTANT               @X50X9NI 13558409
ENDTAB2  EQU   X'FF'                    END OF TABLE INDICATOR   S22024 13558622
X7F      EQU   X'7F'                    MASK TO CLEAR X'80' BIT@ZA07074 13558881
*                                                                S21101 13559021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 13560021
         EJECT                                                 @Y17XANG 13560500
*                                                                S21101 13561021
         SAVE  (14,12)                  SAVE REGS FOR IEDQOA     S21101 13571021
*                                                                S21101 13591021
         USING IEDQOB,RBASE             PROGRAM BASE             S21903 13601022
         LR    RBASE,R15                SET UP BASE REGISTER     S21903 13611022
         DROP  R15                      FORGET TEMPORARY BASE    S21903 13621022
IEDQOB   IEDHJN TAG,HJN                MODULE NAME AND HJN       S21903 13631022
         LA    RTEMP,T3*AVTSVSIZ(R1)    POINT TO AVTSAVE4        S21903 13680005
         ST    R13,W2(,RTEMP)           EXCHANGE SAVEAREA ADDRESSES     13760020
         ST    RTEMP,W3(,R13)                                           13840020
         LR    R13,RTEMP                                                13920020
*                                                                       14080020
         UNPK  ADAVT(AL+INC),AVTBASE(L'AVTBASE+INC) GET AVT ADDRESS     14160020
         TR    ADAVT(AL),TRTABLE          TO MESSAGE                    14240020
         TM    AVTBIT1,AVTDISKN         ARE DISK CONSTANTS IN AVT       14320020
         BO    DISK                       YES, ACCEPT DISK CHANGES      14400020
*                                         NO, DISK CONSTANTS BAD        14480020
         MVC   DISKC(TABSIZ),AVTHFF     FORBID DISK OPERANDS            14560020
         MVC   XCPB(TABSIZ),AVTHFF      FORBID DISK OPERANDS            14640020
DISK     EQU   *                                                        14720020
         TM    AVTBIT1,AVTAQTAN         ARE CORE CONSTANTS IN AVT       14800020
         BO    CORE                       YES, ACCEPT CORE CHANGES      14880020
*                                         NO, CORE CONSTANTS BAD        14960020
         MVC   COREM(TABSIZ),AVTHFF     FORBID CORE CONSTANTS           15040020
         MVC   XMSUNITS(TABSIZ),AVTHFF  FORBID CORE CONSTANTS           15120020
         MVC   COREY(TABSIZ),AVTHFF     FORBID CORE CONSTANTS           15200020
         MVC   XMSMIN(TABSIZ),AVTHFF    FORBID CORE CONSTANTS           15280020
         MVC   COREX(TABSIZ),AVTHFF     FORBID CORE CONSTANTS           15360020
         MVC   XMSMAX(TABSIZ),AVTHFF    FORBID CORE CONSTANTS           15440020
CORE     EQU   *                                                        15520020
         LA    RBUMP,TABSIZ             PRESET INCREMENTOR TO TABLE SIZ 15600020
         L     RTEMP,CVTPTR             GET ADDR OF CVT                 15680020
         USING CVTD,RTEMP                                               15760020
         L     RTEMP,CVTTCBP            GET ADDR OF TCB POINTERS        15840020
         L     RTEMP,W2(,RTEMP)         GET TCB ADDRESS                 15920020
         USING IEDQTCB,RTEMP                                            16000020
         CLI   TCBPKF,AUTHKEY6          IS MCP AUTHORIZED      @G36XRNP 16020010
         BNE   AUTHMSG                  NO, ISSUE ERROR MSG    @G36XRNP 16040010
         L     RTEMP,TCBTIO             GET ADDR OF TIOT                16080020
         MVC   JOBID(IDS),TIOTJOB(RTEMP) FROM TIOT GET JOBNAME,         16130020
         MVC   JOBID+(IDS+(T2*INC))(IDS),TIOTPROC(RTEMP)         S21903*16180005
                                        PROCNAME, AND            S21903 16280005
         MVC   JOBID+(T2*(IDS+(T2*INC)))(IDS),TIOTSTEP(RTEMP)    S21903*16380005
                                        STEPNAME                 S21903 16480005
         MVI   ADAVT+AL,AVTEPER                                         16640020
         L     R1,CVTPTR                GET ADDR OF CVT                 16800020
         L     R1,AVTCVTPT(,R1)         GET CONTENTS OF TCAM            16880020
*                                         WORD IN CVT                   16960020
         LTR   R1,R1                    IS TCAM ALREADY IN SYSTEM       17040020
         BZ    EOF                        NO, CONTINUE                  17120020
*                                         YES, FUSS AND QUIT            17200020
         WTO   MF=(E,IED014I)          TCAM IN SYSTEM MSG        S21101 17280021
*                                                                       17360020
         LA    R15,AVTECD4              SET BAD RETURN CODE             17440020
         B     EXIT                    BRANCH TO EXIT ROUTINE    S21903 17520022
*                                                                       17600020
MSG001   WTO   MF=(E,IED001I)           JOBNAME, AVT ADDR MSG    S21101 17620021
*                                                                S21101 17640021
REQUEST  EQU   *                                                        17680020
         OI    FLAG,REPLYBIT            INDICATE A REQUEST FOR          17760020
*                                         REPLIES HAS BEEN MADE         17840020
         LA    R1,IED002A               SPECIFY TCAM PARAMETERS MS21101 18040021
WTOR     EQU   *                                                        18320020
         XC    REPLY(LREPLY),REPLY      CLEAR RESPONSE AREA             18400020
         XC    ECB,ECB                  CLEAR ECB                       18480020
         WTOR  MF=(E,(1))                                               18560020
         LR    RINDEX,R1               @SAVE MSG ID NUMBER     @SA70307 18600056
*                                                                       18640020
         LA    RSTART,REPLY             PRESET SCAN POINTER      S21101 18680021
*                                                                S21101 18720021
         WAIT  ECB=ECB                  WAIT FOR OPERATOR        S21101 18760021
         DOM   MSG=(9)                  DELETE OPERATOR MSG    @SA70307 18780056
*                                                                       18800020
         TR    REPLY(LREPLY),CHTABLE    CHANGE LOWER TO UPPER CASE      18880020
*                                                                       18960020
* RSTART HAS ADDR OF KEYWORD                                            19040020
*                                                                       19120020
KEYWORD  EQU   *                                                        19200020
         SR    RINDEX,RINDEX            CLEAR INDEX TO OPTABLE          19280020
         LA    RBUMP+1,ENDTAB-OPTABLE-TABSIZ SET STOP VALUE             19360020
         LA    RBUMP,TABSIZ             SET TABLE SIZE           S22024 19440022
         STH   RBUMP,KEYL               SET KEYWORD LENGTH       S22024 19520022
*                                                                       19600020
OPLOOP   EQU   *                                                        19680020
         LA    RTEMP,OPTABLE(RINDEX)    GET ADDR OF OP CODE ENTRY       19760020
         CLC   0(TABSIZ,RTEMP),0(RSTART) CHECK RESPONSE FOR KEYWORD     19840020
         BE    BTABLE                   FOUND MATCHING KEYWORD          19920020
*                                                                       20000020
         BXLE  RINDEX,RBUMP,OPLOOP      GO CHECK NEXT KEYWORD,IF ANY    20080020
*                                       KEYWORD NOT IN TABLE            20160020
         SR    RBUMP,RBUMP              CLEAR REGISTER           S22024 20240022
         SR    RINDEX,RINDEX            CLEAR REGISTER           S22024 20840022
         LA    RTEMP,OPTABLE2           KEYWORD TABLE ADDRESS    S22024 21440022
OPLOOP2  EQU   *                                                 S22024 22040022
         IC    RBUMP,0(RTEMP)           LENGTH OF KEYWORD - 1    S22024 22640022
         EX    RBUMP,CLC                IS KEYWORD FOUND         S22024 23240022
         BE    FOUND                    BRANCH ON YES            S22024 23840022
         LA    RTEMP,E3(RBUMP,RTEMP)    BUMP TO NEXT IN TABLE    S22024 24440022
         CLI   0(RTEMP),ENDTAB2         IS THIS END OF TABLE     S22024 25040022
         BNE   OPLOOP2                  BRANCH ON NO             S22024 25640022
         MVC   MSGKEY(KEY4),0(RSTART)   GET UNIDENTIFIED KEYWORD S22024 26240022
         LA    R1,IED003A               INVALID KEYWORD MESSAGE  S22024 26840022
         B     WTOR                     GO WRITE MESSAGE         S22024 27440022
*                                                                S22024 28040022
CLC      CLC   0(0,RSTART),2(RTEMP)     COMPARE FOR KEYWORD      S22024 28640022
FOUND    EQU   *                                                 S22024 29240022
         LA    RBUMP,1(RBUMP)           ADJUST COUNT             S22024 29840022
         STH   RBUMP,KEYL               SET KEYWORD LENGTH       S22024 30440022
         IC    RINDEX,1(RTEMP)          PICK UP INDEX            S22024 31040022
*                                                                S22024 31640022
BTABLE   EQU   *                                                        33920020
         LA    R1,BACK                  SET RETURN ADDRESS              34000020
         AH    RSTART,KEYL              BUMP PAST KEYWORD TO OPERAND    34080020
         AR    RINDEX,RINDEX            DOUBLE INDEX                    34160020
*                                                                S21903 34170022
* THE FOLLOWING BRANCH TABLE IS USED TO PROCESS EACH OF THE      S21903 34180022
* 'INTRO' OPERANDS THAT CAN BE ENTERED FROM THE SYSTEM CONSOLE.  S21903 34190022
* THE LABEL TO WHICH THE BRANCH IS TAKEN SPECIFIES THE OPERAND   S21903 34200022
* WHICH IS TO BE EXAMINED.                                       S21903 34210022
*                                                                S21903 34220022
         B     *+W2(RINDEX)             ENTER BRANCH TABLE              34240020
         B     LINEBUF                  GO PROCESS LINEBUF       S21903 34320022
         B     CIB                      GO PROCESS CIB           S21903 34400022
         B     CPB                      GO PROCESS CPB           S21903 34480022
         B     INTVAL                   GO PROCESS INTVAL        S21903 34560022
         B     KEYLEN                   GO PROCESS KEYLEN        S21903 34640022
         B     CONTROL                  GO PROCESS CONTROL       S21903 34720022
         B     COREBUF                  GO PROCESS COREBUF       S21903 34800022
         B     RESTART                  GO PROCESS RESTART       S21903 34880022
         B     PRIMARY                  GO PROCESS PRIMARY       S21903 34960022
         B     CKREQS                   GO PROCESS CKREQS        S21903 35040022
         B     STARTUP                  GO PROCESS STARTUP       S21903 35120022
         B     TRACE                    GO PROCESS TRACE         S21903 35200022
         B     DTRACE                   GO PROCESS DTRACE        S21903 35280022
         B     CPINTVL                  GO PROCESS CPINTVL       S21903 35360022
         B     PASSWRD                  GO PROCESS PASSWRD       S21903 35440022
         B     DLQ                      GO PROCESS DLQ           S21903 35520022
         B     CPRCDS                   GO PROCESS CPRCDS        S21903 35600022
         B     CROSSRF                  GO PROCESS CROSSRF       S21903 35680022
         B     COMWRTE                  GO PROCESS COMWRTE       S21903 35760022
         B     TOPMSG                   GO PROCESS TOPMSG        S21903 35840022
         B     OLTEST                   GO PROCESS OLTEST        S21903 35920022
         B     COREMAX                  GO PROCESS COREMAX       S21903 36000022
         B     COREMIN                  GO PROCESS COREMIN       S21903 36080022
         B     VIRTUAL                  GO PROCESS VM            Y05331 36120005
         B     REQUEST                  GO PROCESS REQUEST       S21903 36160022
         B     EOF                      GO TO EOF                S22024 36240022
*                                                                       36320020
* WHEN THIS MODULE IS FIRST ENTERED, CONTROL IS PASSED TO 'EOF' TO      36400020
* SEE IF THE USER WISHES TO SUPPRESS THE 'WTOR' BY SPECIFYING AT        36480020
* INTRO ASSEMBLY TIME ALL FIVE REQUIRED OPERANDS -- KEYLEN,    @Y17XANG 36500000
* LNUNITS, STARTUP, CPB(OR DISK=NO), AND SUBAREA(OR FEATURE=   @Y17XANG 36520000
* NO3705) AND VM(OR VM=NOPROMPT).                              @Y17XANG 36540000
*                                                                       36720020
* WHEN THE USER REPLIES 'U', 'EOF' ALSO GETS CONTROL.                   36800020
*                                                                       36880020
         B     PLCBNO                   GO PROCESS PLCBNO        S22024 36920022
         B     TTRACE                   PROCESS TTRACE           X03039 36930007
*                                       BTRACE AND TTRACE ARE  @Y17XANG 36931000
*                                       SYNONYMOUS, ROUTINE    @Y17XANG 36932000
*                                       LABELED TTRACE SERVES  @Y17XANG 36933000
*                                       BOTH.                  @Y17XANG 36934000
         B     BRACKET                  PROCESS BRACKET        @X50X9NI 36935009
         B     MAXSUBA                  PROCESS MAX SUBAREA    @Y17XANG 36935800
         B     OPMASK                   PROCESS AN OPERATOR    @Y17XANG 36936600
*                                       MASK ENTRY             @Y17XANG 36937400
         B     SUBAREA                  PROCESS SUBAREA ENTRY  @Y17XANG 36938200
         B     SIBCOUNT                 PROCESS SIB COUNT      @Y17XANG 36939000
         B     APWAS                    PROCESS APPLICATION    @G36XRNP 36939210
*                                       WORK AREA SIZE         @G36XRNP 36939410
         B     AUTHA                    PROCESS AUTHORIZATION  @G36XRNP 36939610
*                                                                S22024 36940022
EOF      EQU   *                                                        36960020
         MVI   MISSKEY,AVTEBLNK         CLEAR MSG AREA                  37040020
         MVC   MISSKEY+INC(LKEYWORD-INC),MISSKEY TO SPACES              37120020
         TM    AVTBIT1,AVTDISKN         ARE DISK CONSTANTS IN AVT       37200020
         BZ    CONTINUE                   NO, FORGET CPBS               37280020
*                                         YES, CPBS MUST BE SPECIFIED   37360020
         MVC   MISSKEY(L'XCPB),XCPB     PUT 'CPB=' INTO MSG             37440020
         LH    RTEMP,AVTCPBNO           GET NUMBER OF CPBS              37520020
         LTR   RTEMP,RTEMP              WERE ANY CPBS SPECIFIED         37600020
         BZ    MISSING                    NO, CPBS ARE MISSING          37680020
*                                         YES, CPB= SPECIFIED           37760020
CONTINUE EQU   *                                                        37840020
         MVC   MISSKEY(L'XKEYLEN),XKEYLEN PUT 'KEYLEN=' INTO MSG        37920020
         LH    RTEMP,AVTKEYLE          GET UNIT SIZE FROM AVT    S21903 38000022
         LTR   RTEMP,RTEMP              WAS KEYLEN SPECIFIED            38080020
         BZ    MISSING                    NO, KEYLEN MISSING            38160020
*                                         YES, KEYLEN= SPECIFIED        38240020
         MVC   MISSKEY(L'XLNUNITS),XLNUNITS PUT 'LNUNITS=' INTO MSG     38320020
         LH    RTEMP,AVTNOLBF          GET NUMBER OF BUFFER      S21903 38400022
*                                        UNITS AVAILABLE FOR     S21903 38420022
*                                        BUILDING BUFFERS FROM   S21903 38440022
*                                        THE AVT                 S21903 38460022
         LTR   RTEMP,RTEMP              WAS LNUNITS SPECIFIED           38480020
         BZ    MISSING                    NO, LNUNITS MISSING           38560020
*                                         YES, LNUNITS SPECIFIED        38640020
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 38645000
         BZ    TSTSTART                 BRANCH IF NOT          @Y17XANG 38650000
         L     R14,AVTSAVTP             SAVT BASE              @Y17XANG 38655000
         USING IEDNSVTD,R14                                    @Y17XANG 38660000
         MVC   MISSKEY(L'XSUBAREA),XSUBAREA PLACE SUBAREA=     @Y17XANG 38665000
*                                       INTO WTO MSG.          @Y17XANG 38670000
         CLI   SAVTSUBV,0               SUBAREA SPECIFIED?     @Y17XANG 38675000
         BE    MISSING                  BRANCH NO TO GET       @Y17XANG 38680000
*                                       SUBAREA.               @Y17XANG 38685000
         CLC   SAVTSUBV,SAVTSUBA        SUBAREA EXCEED MAX?    @Y17XANG 38690000
         BNH   TSTSTART                 BRANCH IF NOT.         @Y17XANG 38695000
         LA    R1,IED527A               MSG IED527A ADDRESS    @Y17XANG 38700000
         B     WTOR                     GO ISSUE DIAGNOSTIC    @Y17XANG 38705000
         DROP  R14                                             @Y17XANG 38710000
TSTSTART EQU   *                                               @Y17XANG 38715000
         MVC   MISSKEY(L'XSTARTUP),XSTARTUP PUT 'STARTUP=' INTO MSG     38720020
         TM    AVTBIT3,AVTSTAN          IS STARTUP SPECIFIED            38800020
         BNZ   GETMAIN                    YES, REQ'D PARMS ALL HERE     38880020
*                                         NO, STARTUP= MISSING          38960020
MISSING  EQU   *                                                        39040020
         TM    FLAG,REPLYBIT            WAS A MISSING KEYWORD FOUND     39120020
*                                         BECAUSE USER REPLIED 'U'      39200020
*                                         OR BECAUSE THIS IS THE        39280020
*                                         FIRST TIME IN FROM INTRO      39360020
         BZ    MSG001                     FIRST TIME,SHOW AVT ADDS21101 39440021
*                                       USER REPLIED 'U', SPECIFY       39520020
*                                         MISSING KEYWORD               39600020
         LA    R1,IED004A               REQUIRED PARM MISSING MSGS21101 39800021
         B     WTOR                    GO ISSUE MISSING KEYWORD  S21903 40160022
*                                        MESSAGE                 S21903 40200022
*                                                                       40240020
GETMAIN  EQU   *                                                        40320020
         L     R15,AVTSAVTP             SECONDARY AVT POINTER    Y05331 40328005
         USING IEDNSVTD,R15                                      Y05331 40336005
         MVI   MISSKEY,AVTEBLNK         CLEAR MESSAGE AREA     @OZ06187 40338091
         MVC   MISSKEY+INC(LKEYWORD-INC),MISSKEY  TO BLANKS    @OZ06187 40340091
         MVC   MISSKEY(L'XVM),XVM                                Y05331 40344005
         TM    SAVTDIAF,SAVTPRMT        PROMPT REQUIRED ?        Y05331 40352005
         BZ    GOODEXIT                 NO,BRANCH                Y05331 40360005
         B     MISSING                  YES,VM MISSING           Y05331 40368005
         DROP  R15                                               Y05331 40376005
GOODEXIT EQU   *                                                 Y05331 40384005
         SR    R15,R15                  SET GOOD RETURN CODE            40400020
EXIT     EQU   *                                                        40480020
         L     R13,W2(,R13)             GET CALLERS SAVEAREA ADDR       40560020
         RETURN (14,12),T,RC=(15)       EXIT                            40640020
*                                                                       40720020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 40800020
*                                                                       40880020
CROSSRF  EQU   *                                                        40960020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          41040020
*                                                                       41120020
         ST    RANS,AVTCRSRF            STORE VALUE IN AVT              41200020
         BR    R1                       GO TO 'BACK'                    41280020
*                                                                       41360020
LINEBUF  EQU   *                                                        41440020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          41520020
*                                                                       41600020
         LTR   RANS,RANS                WAS ZERO SPECIFIED              41680020
         BZ    NOTNUM                     YES,ILLEGAL,MUST HAVE BUFFERS 41760020
*                                         NO, NOW GOT BUFFERS           41840020
         STH   RANS,AVTNOLBF            STORE VALUE IN AVT              41920020
         BR    R1                       GO TO 'BACK'                    42000020
*                                                                       42080020
CIB      EQU   *                                                        42160020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          42240020
*                                                                       42320020
         CH    RANS,L255                IS 255 LIMIT EXCEEDED           42400020
         BH    NOTNUM                     YES, TOO BIG                  42480020
*                                         NO, SMALL ENOUGH              42560020
         STC   RANS,AVTCIB              STORE VALUE IN AVT              42640020
         BR    R1                       GO TO 'BACK'                    42720020
*                                                                       42800020
TRACE    EQU   *                                                        42880020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          42960020
*                                                                       43040020
         ST    RANS,AVTRACE             STORE VALUE IN AVT              43120020
         LTR   RANS,RANS                NEW TRACE VALUE ZERO   @Y17XANA 43140000
         BNZR  R1                       NO , GO TO 'BACK'      @Y17XANA 43160000
         MVI   AVTIOTR,AVTEZERO         YES,RESET AVTIOTR TO 0 @Y17XANA 43170000
         BR    R1                       GO TO 'BACK'                    43200020
*                                                                       43280020
TTRACE   EQU   *                                                 X03039 43283007
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 43283700
         BZ    NOT3705                  BRANCH IF NOT, TRACE   @Y17XANG 43284400
*                                       NOR BTRACE ACCEPTABLE. @Y17XANG 43285100
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY   X03039 43292007
*                                                                       43295007
         L     R14,AVTSAVTP             SECONDARY AVTPOINTER     X03039 43298007
         ST    RANS,SAVTPIUT-IEDNSVTD(R14)   SAVE # TBL ENTRIES@Y17XANG 43299000
*                                            IN SAVT           @Y17XANG 43300000
         BR    R1                                              @Y17XANG 43301000
*                                                              @Y17XANG 43302000
BRACKET  EQU   *                        PROCESS BRACKET        @Y17XANG 43303000
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 43304000
         BZ    NOT3705                  BRANCH IF NOT          @Y17XANG 43305000
         L     R14,AVTSAVTP             SECONDARY AVT ADDR     @X50X9NI 43307209
         BAL   RX,SCAN                  BRANCH TO FIND LAST    @X50X9NI 43307309
*                                       CHAR OF OPERAND        @X50X9NI 43307409
         CLC   YESCOM,0(RSTART)         BRACKET=YES 'YES,'     @X50X9NI 43307509
         BE    BRKTYES                  YES-BRANCH             @X50X9NI 43307609
         CLC   YES0(L'YESCOM),0(RSTART) BRACKET=YES 'YES0'     @X50X9NI 43307709
         BE    BRKTYES                  YES-BRANCH             @X50X9NI 43307809
*                                                              @X50X9NI 43307909
         CLC   NOCOM,0(RSTART)          BRACKET=NO 'NO,'       @X50X9NI 43308009
         BE    BRKTNO                   YES-BRANCH             @X50X9NI 43308109
         CLC   NO0(L'NOCOM),0(RSTART)   BRACKET=NO 'NO0'       @X50X9NI 43308209
         BNE   NOTNUM                   BR NO-INVALID          @X50X9NI 43308309
*                                                              @X50X9NI 43308409
BRKTNO   EQU   *                                               @X50X9NI 43308509
         SR    R0,R0                    INIT TO ZERO           @X50X9NI 43308609
         ST    R0,SAVTBSM-IEDNSVTD(R14) INDICATE BRACKET MGR.  @X50X9NI 43308709
*                                       NOT TO BE LOADED       @X50X9NI 43308809
         BR    R1                       GO TO 'BACK'           @X50X9NI 43308909
BRKTYES  EQU   *                                               @X50X9NI 43309009
         LA    R0,ONE                   PUT A '1' IN REG       @X50X9NI 43309109
         ST    R0,SAVTBSM-IEDNSVTD(R14) INDICATE BRACKET MGR.  @X50X9NI 43309209
*                                       IS TO BE LOADED        @X50X9NI 43309309
         BR    R1                       GO TO  'BACK'          @X50X9NI 43309409
PLCBNO   EQU   *                                                 S22024 43310022
         TM    AVTSAVTF,AVTVTMCP        IS NCP DEFINED?        @G36XRNP 43313010
         BZ    NOT3705                  BRANCH ON NO             S22024 43316022
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY   S22024 43319022
*                                                                S22024 43322022
         STH   RANS,AVTPLCBN            STORE VALUE IN AVT       S22024 43325022
         BR    R1                       GO TO 'BACK'             S22024 43328022
*                                                                S22024 43331022
NOT3705  EQU   *                                                 S22024 43334022
         SH    RSTART,KEYL              BACK UP TO KEYWORD       S22024 43337022
         MVC   MSGKEY(KEY4),0(RSTART)   MOVE INVALID KEYWORD     S22024 43340022
         LA    R1,IED003A               INVALID KEYWORD MESSAGE  S22024 43343022
         B     WTOR                     GO WRITE MESSAGE         S22024 43346022
*                                                                S22024 43349022
RESTART  EQU   *                                                        43360020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          43440020
*                                                                       43520020
         CH    RANS,L255                IS VALUE LESS THAN 255          43600020
         BH    NOTNUM                     NO, TOO BIG                   43680020
*                                         YES, OK                       43760020
         STC   RANS,AVTCKRST            STORE VALUE IN AVT              43840020
         BR    R1                       GO TO 'BACK'                    43920020
*                                                                       44000020
DTRACE   EQU   *                                                        44080020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          44160020
*                                                                       44240020
         ST    RANS,AVTDISTR            STORE VALUE IN AVT              44320020
         LTR   RANS,RANS                NEW DTRACE VALUE ZERO  @Y17XANA 44340000
         BNZR  R1                       NO , GO TO 'BACK'      @Y17XANA 44360000
         MVI   AVTSUBT,AVTEZERO         YES,RESET AVTSUBT TO 0 @Y17XANA 44380000
         BR    R1                       GO TO 'BACK'                    44400020
*                                                                       44480020
CPB      EQU   *                                                        44560020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          44640020
*                                                                       44720020
         STH   RANS,AVTCPBNO            STORE VALUE IN AVT              44800020
         BR    R1                       GO TO 'BACK'                    44880020
*                                                                       44960020
INTVAL   EQU   *                                                        45040020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          45120020
*                                                                       45200020
         STH   RANS,AVTINTLV            STORE VALUE IN AVT              45280020
         BR    R1                       GO TO 'BACK'                    45360020
*                                                                       45440020
CPINTVL  EQU   *                                                        45520020
         BAL   R14,HALFNO              GO CONVERT TO BINARY AND  S21903 45600022
*                                        PUT VALUE INTO RANS     S21903 45640022
*                                                                       45680020
         CH    RANS,H30                 CPINTVL MUST BE AT LEAST 30     45760020
         BL    NOTNUM                     IF TOO LITTLE, ERROR          45840020
         C     RANS,MAXCPVL             CPINTVL CAN BE AT       SA63008 45920005
*                                       MOST 43199              SA63008 45940005
         BH    NOTNUM                     IF TOO BIG, ERROR     SA63008 45960005
         STH   RANS,AVTCKELV           STORE VALUE IN AVT        S21903 46000022
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    46080020
*                                                                       46160020
*                                                                       46240020
KEYLEN   EQU   *                                                        46320020
         BAL   R14,HALFNO              GO CONVERT TO BINARY AND  S21903 46400022
*                                        PUT VALUE INTO RANS     S21903 46440022
*                                                                       46480020
         LA    RTEMP,AVTMINKY           GET MINIMUM KEYLEN              46560000
         TM    AVTSAVTP,AVTVTMCP        3705 ENVIRONMENT       @YM06968 46570000
         BNO   KEYLEN1                  BR NO, MIN IS 36       @YM06968 46580000
         LA    RTEMP,AVTMIN05           MIN FOR 3705 IS 44     @YM06968 46590000
KEYLEN1  EQU   *                                               @YM06968 46600000
         CR    RANS,RTEMP               IS KEYLEN BIG ENOUGH            46640020
         BL    NOTNUM                     NO, ERROR                     46720020
*                                         YES, OK                       46800020
         CH    RANS,L255                IS KEYLEN TOO BIG               46880020
         BH    NOTNUM                     YES, ERROR                    46960020
*                                         NO, OK                        47040020
         STH   RANS,AVTKEYLE                                            47120020
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    47200020
*                                                                       47280020
*                                                                       47360020
CONTROL  EQU   *                                                        47440020
         LA    RESUL,AVTCTLCH           PASS AREA TO RECEIVE RESULT     47520020
         BAL   R14,CHAR8                GET OPERAND                     47600020
*                                       IF CONTROL IS RETURNED FROM     47680020
*                                         CHAR8, 'ERASE' WAS REQUESTED  47760020
         MVC   AVTCTLCH,CTLCHDEF        NO CONTROL SPECIFIED            47840020
         BR    R1                       GO TO 'BACK'                    47920020
*                                                                       48000020
PRIMARY  EQU   *                                                        48080020
         LA    RESUL,AVTDOUBX           PASS AREA TO RECEIVE RESULT     48160020
         BAL   R14,CHAR8                GET OPERAND                     48240020
*                                       IF CONTROL IS RETURNED FROM     48320020
*                                         CHAR8, 'ERASE' WAS REQUESTED  48400020
         MVC   AVTDOUBX,DOUBXDEF        SET PRIMARY TO 'SYSCON'         48480020
         BR    R1                       GO TO 'BACK'                    48560020
*                                                                       48640020
PASSWRD  EQU   *                                                        48720020
         LA    RESUL,AVTPASWD           PASS AREA TO RECEIVE RESULT     48800020
         BAL   R14,CHAR8                GET OPERAND                     48880020
*                                       IF CONTROL IS RETURNED FROM     48960020
*                                         CHAR8, 'ERASE' WAS REQUESTED  49040020
         MVC   AVTPASWD,PASWDDEF        NO PASSWORD NEEDED              49120020
         BR    R1                       GO TO 'BACK'                    49200020
*                                                                       49280020
DLQ      EQU   *                                                        49360020
         LA    RESUL,AVTDLQ             PASS AREA TO RECEIVE RESULT     49440020
         BAL   R14,CHAR8                GET OPERAND                     49520020
*                                       IF CONTROL IS RETURNED FROM     49600020
*                                         CHAR8, 'ERASE' WAS REQUESTED  49680020
         MVC   AVTDLQ,DLQDEF            NO DEAD LETTER QUEUE            49760020
         BR    R1                       GO TO 'BACK'                    49840020
*                                                                       49920020
*                                                                       50000020
* RESUL HAS ADDR OF 8 CHARACTER AREA TO RECEIVE RESULT.                 50080020
* RSTART POINT TO FIRST OF OPERAND.                                     50160020
*                                                                       50240020
CHAR8    EQU   *                                                        50320020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 50400022
*                                        CHARACTER OF OPERAND    S21903 50440022
*                                                                       50480020
         BCTR  RTEMP,ZERO               ADJUST LENGTH FOR EX INSTS21903 50560005
         CH    RTEMP,AVTHA7             8 IS MAXIMUM LENGTH             50640020
         BH    NOTNUM                   ILLEGAL OPERAND                 50720020
*                                                                       50800020
         MVI   0(RESUL),AVTEBLNK        SET ENTIRE RESULT 8 CHAR        50880020
         MVC   INC(L8-INC,RESUL),0(RESUL) AREA TO BLANKS                50960020
         EX    RTEMP,MVC                PUT OPERAND TO ANSWER AREA      51040020
         CLC   0(L'ERASE,RESUL),ERASE   DOES OPERATOR WISH TO ERASE     51120020
*                                         THIS KEYWORD                  51200020
         BCR   EQUAL,R14                  YES, GO INSERT DEFAULT        51280020
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    51360020
*                                                                       51440020
MVC      MVC   0(0,RESUL),0(RSTART)     EXECUTED INSTRUCTION, SETS      51520020
*                                         OPERAND INTO RESULT AREA      51600020
*                                                                       51680020
CPRCDS   EQU   *                                                        51760020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          51840020
*                                                                       51920020
         CH    RANS,L75                 IS VALUE OVER 75                52000020
         BH    NOTNUM                     YES, TOO BIG                  52080020
*                                         NO, SMALL ENOUGH              52160020
         CH    RANS,AVTHA2              2 IS MINIMUM VALUE              52240020
         BL    NOTNUM                     TOO SMALL                     52320020
*                                         LARGE ENOUGH                  52400020
         STC   RANS,AVTCPRCD            STORE VALUE IN AVT              52480020
         BR    R1                       GO TO 'BACK'                    52560020
*                                                                       52640020
OLTEST   EQU   *                                                        52720020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          52800020
*                                                                       52880020
         CH    RANS,L255                IS VALUE OVER 255               52960020
         BH    NOTNUM                     YES, TOO BIG                  53040020
*                                         NO, SMALL ENOUGH              53120020
         CH    RANS,L56                 IS VALUE LESS THAN 56? @Y17XAUU 53200000
         BNL   OLTGOOD                    NO, OK                        53280020
*                                         YES, QUESTIONABLE             53360020
         LTR   RANS,RANS                IS VALUE ZERO                   53440020
         BNZ   NOTNUM                   NO, RANGE 1-55 INVALID @Y17XANU 53520000
*                                       YES, ZERO OR 56-255 OK @Y17XANU 53600000
OLTGOOD EQU    *                                                        53680020
         STC   RANS,AVTOLTST            STORE VALUE IN AVT              53760020
         BR    R1                       GO TO 'BACK'                    53840020
*                                                                       53920020
COREMAX  EQU   *                                                        54000020
         BAL   R14,HALFNO               GET NUMBER INTO RANS            54080020
*                                                                       54160020
         CH    RANS,H100                NO. CANNOT BE OVER 100          54240020
         BH    NOTNUM                     ERROR, TOO BIG                54320020
*                                         OK SO FAR, CONTINUE           54400020
         C     RANS,AVTCMIN             NO.MUST BE GREATER THAN MIN     54480020
         BNH   NOTNUM                     ERROR, TOO SMALL              54560020
*                                         OK, CONTINUE                  54640020
         ST    RANS,AVTCMAX             STORE VALUE IN AVT              54720020
         BR    R1                       GO TO 'BACK'                    54800020
*                                                                       54880020
COREMIN  EQU   *                                                        54960020
         BAL   R14,HALFNO               GET NUMBER INTO RANS            55040020
*                                                                       55120020
         CH    RANS,H100                NO, MUST BE LESS THAN 100       55200020
         BNL   NOTNUM                     ERROR, TOO BIG                55280020
*                                         OK SO FAR, CONTINUE           55360020
         C     RANS,AVTCMAX             NO. MUST BE LESS THAN MAX       55440020
         BNL   NOTNUM                     ERROR, TOO BIG                55520020
*                                         OK, CONTINUE                  55600020
         ST    RANS,AVTCMIN             STORE VALUE IN AVT              55680020
         BR    R1                       GO TO 'BACK'                    55760020
*                                                                       55840020
CKREQS   EQU   *                                                        55920020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          56000020
*                                                                       56080020
         CH    RANS,L255                IS LIMIT EXCEEDED               56160020
         BH    NOTNUM                     YES, ILLEGAL OPERAND          56240020
*                                         NO, OK OPERAND                56320020
         STC   RANS,AVTNCKPR           STORE VALUE IN AVT        S21903 56400022
BACK     EQU   *                                                        56480020
         LA    RSTART,INC(,REND)        BUMP TO NEXT KEYWORD            56560020
         B     KEYWORD                 GO EXAMINE NEXT KEYWORD   S21903 56640022
*                                                                       56720020
COREBUF  EQU   *                                                        56800020
*                                                                       56880020
* MSUNITS(M) CAN BE SPECIFIED ONLY IF A NON-ZERO VALUE WAS SPECIFIED    56960020
* FOR MSUNITS ON INTRO MACRO ASSEMBLY.  MSUNITS=YES IS ASSEMBLED        57040020
* IDENTICALLY TO MSUNITS=1, THUS SETTING A NON-ZERO VALUE.              57120020
*                                                                       57200020
         NC    AVTTOTNC,AVTTOTNC        IS CORE BUFFERING REQUESTED     57280020
         BNZ   GOODCORE                   YES, GO SET NEW VALUE         57360020
*                                         NO, NOT PERMITTED             57440020
         LA    R1,IED005A               MSUNITS NOT PERMITTED MSGS21101 57640021
         B     WTOR                     GO FUSS AND WAIT FOR REPLY      57920020
*                                                                       58000020
GOODCORE EQU   *                                                        58080020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          58160020
*                                                                       58240020
         LTR   RANS,RANS                IS VALUE ZERO                   58320020
         BZ    NOTNUM                     YES, NOT PERMITTED            58400020
*                                         NO, NON-ZERO VALUE OK         58480020
         ST    RANS,AVTTOTNC           STORE VALUE IN AVT        S21903 58560022
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    58640020
*                                                                       58720020
COMWRTE  EQU   *                                                        58800020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 58880022
*                                        CHARACTER OF OPERAND    S21903 58920022
*                                                                       58960020
         CLC   YESCOM,0(RSTART)         IS OPERAND 'YES'                59040020
         BE    COMWRYES                GO SET BIT IN AVT TO      S21903 59120022
*                                        INDICATE COMWRTE        S21903 59140022
*                                        SPECIFIED               S21903 59160022
*                                                                       59200020
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND 'YES'?       S21903 59280022
         BE    COMWRYES                BRANCH IF YES             S21903 59360022
*                                                                       59440020
         CLC   NOCOM,0(RSTART)          IS OPERAND 'NO'                 59520020
         BE    COMWRNO                 YES, GO SET BIT INDICATINGS21903 59600022
*                                        NO COMWRTE SPECIFIED    S21903 59640022
*                                                                       59680020
         CLC   NO0(L'NOCOM),D0(RSTART) IS OPERAND 'NO'?          S21903 59760022
         BNE   NOTNUM                   INVALID OPERAND COMWRTE         59840020
*                                                                       59920020
COMWRNO  EQU   *                                                        60000020
         NI    AVTCWFL1,AVTEFF-AVTCOMWN COMWRTE=NO SPECIFIED            60080020
         BR    R1                       GO TO 'BACK'                    60160020
*                                                                       60240020
COMWRYES EQU   *                                                        60320020
         OI    AVTCWFL1,AVTCOMWN        COMWRTE=YES SPECIFIED           60400020
         BR    R1                       GO TO 'BACK'                    60480020
*                                                                       60560020
TOPMSG   EQU   *                                                        60640020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 60720022
*                                        CHARACTER OF OPERAND    S21903 60760022
*                                                                       60800020
         CLC   YESCOM,0(RSTART)         IS OPERAND 'YES'                60880020
         BE    TOPYES                  GO SET BIT IN AVT         S21903 60960022
*                                        INDICATING TOPMSG       S21903 60980022
*                                        SPECIFIED               S21903 61000022
*                                                                       61040020
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND 'YES'?       S21903 61120022
         BE    TOPYES                   YES, GO SET BIT        @SA70222 61200056
*                                                                       61280020
         CLC   NOCOM,0(RSTART)          IS OPERAND 'NO'                 61360020
         BE    TOPNO                   YES, GO SET BIT IN AVT    S21903 61440022
*                                        INDICATING NO TOPMSG    S21903 61460022
*                                        SPECIFIED               S21903 61480022
*                                                                       61520020
         CLC   NO0(L'NOCOM),D0(RSTART) IS OPERAND 'NO'?          S21903 61600022
         BNE   NOTNUM                  NO, INVALID OPERAND TOPMSGS21903 61680022
*                                                                       61760020
TOPNO    EQU   *                                                        61840020
         OI    AVTBIT2,AVTTOPOL         TOPMSG=NO SPECIFIED             61920020
         BR    R1                       GO TO 'BACK'                    62000020
*                                                                       62080020
TOPYES   EQU   *                                                        62160020
         NI    AVTBIT2,XFF-AVTTOPOL     TOPMSG=YES, SPECIFIED    S21903 62240005
         BR    R1                       GO TO 'BACK'                    62320020
*                                                                       62400020
VIRTUAL  EQU   *                                                 Y05331 62402005
         BAL   RX,SCAN                  BRANCH TO FIND LAST CHAR Y05331 62404005
*                                       OF OPERAND.              Y05331 62406005
*                                                                Y05331 62408005
         CLC   YESCOM,0(RSTART)         IS OPERAND 'YES' ?       Y05331 62410005
         BE    VIRTYES                  YES, GO SET BIT IN       Y05331 62412005
*                                       SECONDARY AVT INDICATING Y05331 62414005
*                                       VIRTUAL SPECIFIED        Y05331 62416005
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND 'YES' ?      Y05331 62418005
         BE    VIRTYES                  YES,GO SET BIT           Y05331 62420005
*                                                                Y05331 62422005
         CLC   NOCOM,0(RSTART)          IS OPERAND 'NO' ?        Y05331 62424005
         BC    8,VIRTNO                 YES,BRANCH               Y05331 62426005
         SPACE                                                          62428005
         CLC   NO0(L'NOCOM),D0(RSTART)  IS OPERAND 'NO' ?        Y05331 62430005
         BC    8,VIRTNO                 YES,BRANCH               Y05331 62432005
         B     NOTNUM                   INVALID OPERAND,VIRTUAL  Y05331 62434005
         SPACE                                                          62436005
VIRTYES  EQU   *                                                 Y05331 62438005
         L     RSTART,AVTSAVTP          POINTER TO SECONDARY AVT Y05331 62440005
         USING IEDNSVTD,RSTART                                   Y05331 62442005
         OI    SAVTDIAF,SAVTVIRT        TURN ON VIRTUAL          Y05331 62444005
*                                       ENVIRONMENT INDICATOR    Y05331 62446005
         B     ENDVIRT                  BRANCH                   Y05331 62448005
VIRTNO   EQU   *                                                 Y05331 62450005
         L     RSTART,AVTSAVTP          SECONDARY AVT POINTER    Y05331 62452005
         NI    SAVTDIAF,X7F             TURN OFF VM=YES BIT    @ZA07074 62453081
ENDVIRT  EQU   *                                                 Y05331 62454005
         NI    SAVTDIAF,XBF             TURN OFF VM PROMPT       Y05331 62456005
*                                       INDICATOR IF ON          Y05331 62458005
         BR    R1                       RETURN                   Y05331 62460005
XBF      EQU   X'BF'                                             Y05331 62462005
         DROP  RSTART                                            Y05331 62464005
         SPACE                                                          62466005
STARTUP  EQU   *                                                        62480020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 62560022
*                                        CHARACTER OF OPERAND    S21903 62600022
*                                                                       62640020
         LR    RTEMP,RSTART                                             62720020
         NI    AVTBIT3,XF0              FORGET PREVIOUS S=REPLIES       62800020
         NI    AVTBIT2,AVTEFF-AVTEXTSC  RESET PREV S= REPLIES   SA51078 62840022
         NI    AVTCKELF,AVTEFF-AVTNQBCK RESET PREVIOUS REPLY   @OS77945 62860010
STA      EQU   *                                                        62880020
         CLI   0(RSTART),C              IS COLDSTART REQUESTED          62960020
         BE    GOTC                       YES, COLDSTART                63040020
*                                         NO, GUESS AGAIN               63120020
         CLI   0(RSTART),W              IS WARMSTART REQUESTED          63200020
         BE    GOTW                       YES, WARMSTART                63280020
*                                         NO, GUESS AGAIN               63360020
         CLI   0(RSTART),I              IS INVITATION LIST REQUESTED    63440020
         BE    GOTI                       YES, INVITATION LIST REQ      63520020
*                                         NO, GUESS AGAIN               63600020
         CLI   0(RSTART),Y              IS NO CONTINUATION REQUESTED    63680020
         BE    GOTY                       YES, NO CONTINUATION          63760020
*                                         NO, OPERATOR BLEW IT          63840020
         CLI   0(RSTART),E              IS EXTENDED RESTART REQ SA51078 63860022
         BE    GOTE                     BRANCH IF YES           SA51078 63880022
         CLI   D0(RSTART),N             NO QBACK SCAN REQUESTED@G36XRNP 63886010
         BE    GOTN                     BRANCH IF YES          @G36XRNP 63892010
STRTERR  EQU   *                                                SA51078 63900022
         LR    RSTART,RTEMP             SET TO START OF OPERAND         63920020
         NI    AVTBIT3,XF0              ERROR,FORGET ALL S= REPLIES     64000020
         NI    AVTBIT2,AVTEFF-AVTEXTSC  RESET PREV S= REPLIES   SA51078 64040022
         NI    AVTCKELF,AVTEFF-AVTNQBCK RESET PREVIOUS REPLY   @OS77945 64060010
         B     NOTNUM                   FUSS AT INVALID OPERAND         64080020
*                                                                       64160020
GOTC     EQU   *                                                        64240020
         TM    AVTBIT3,AVTSTAN          ALREADY SPECIFIED      @G36XRNP 64260010
         BO    STRTERR                  YES, TRY AGAIN         @G36XRNP 64280010
         OI    AVTBIT3,AVTSTAN+AVTSTACN  COLDSTART                      64320020
         B     ENDSTA                  GO GET NEXT CHARACTER     S21903 64400022
*                                                                       64480020
GOTW     EQU   *                                                        64560020
         TM    AVTBIT3,AVTSTAN          ALREADY SPECIFIED      @G36XRNP 64580010
         BO    STRTERR                  YES, TRY AGAIN         @G36XRNP 64600010
         OI    AVTBIT3,AVTSTAN          STARTUP                         64640020
         NI    AVTBIT3,AVTSTAWN         WARMSTART                       64720020
         B     ENDSTA                  GO GET NEXT CHARACTER     S21903 64800022
*                                                                       64880020
GOTI     EQU   *                                                        64960020
         TM    AVTBIT3,AVTSTAIN         ALREADY SPECIFIED      @G36XRNP 64980010
         BO    STRTERR                  YES, TRY AGAIN         @G36XRNP 65000010
         OI    AVTBIT3,AVTSTAIN         INVITATION LIST                 65040020
         B     ENDSTA                  GO GET NEXT CHARACTER     S21903 65120022
*                                                                       65200020
GOTY     EQU   *                                                        65280020
         TM    AVTBIT3,AVTSTAYN         ALREADY SPECIFIED      @G36XRNP 65282010
         BO    STRTERR                  YES TRY AGAIN          @G36XRNP 65284010
         TM    AVTBIT2,AVTEXTSC         EXTENDED SCAN          @G36XRNP 65286010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65288010
         TM    AVTCKELF,AVTNQBCK        NO QBACK SCAN          @G36XRNP 65290010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65292010
         OI    AVTBIT3,AVTSTAYN         NO CONTINUATION                 65294010
*                                                                       65296010
         B     ENDSTA                   CHECK FOR KEYWORD END   SA51078 65298010
*                                                               SA51078 65300010
GOTE     EQU   *                                                SA51078 65302010
         TM    AVTBIT2,AVTEXTSC         ALREADY SPECIFIED      @G36XRNP 65304010
         BO    STRTERR                  YES TRY AGAIN          @G36XRNP 65306010
         TM    AVTBIT3,AVTSTAYN         NO SCAN                @G36XRNP 65308010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65310010
         TM    AVTCKELF,AVTNQBCK        NO QBACK SCAN          @G36XRNP 65312010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65314010
         OI    AVTBIT2,AVTEXTSC         SET EXTENDED RESTART    SA51078 65316010
*                                                               SA51078 65318010
         B     ENDSTA                   GO GET NEXT CHARACTER  @G36XRNP 65320010
GOTN     EQU   *                                               @G36XRNP 65322010
         TM    AVTCKELF,AVTNQBCK        ALREADY SPECIFIED      @G36XRNP 65324010
         BO    STRTERR                  YES,TRY AGAIN          @G36XRNP 65326010
         TM    AVTBIT2,AVTEXTSC         EXTENDED SCAN          @G36XRNP 65328010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65330010
         TM    AVTBIT3,AVTSTAYN         NO SCAN                @G36XRNP 65332010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65334010
         OI    AVTCKELF,AVTNQBCK        SET NO QBACK SCAN      @G36XRNP 65336010
ENDSTA   EQU   *                                                        65338010
         LA    RSTART,INC(,RSTART)      BUMP TO NEXT CHARACTER          65340010
         CR    RSTART,REND              WAS THAT THE LAST CHARACTER     65360010
         BNE   STA                      BRANCH IF NO            SA51078 65362010
         TM    AVTBIT3,AVTSTAN          WAS C OR W SPECIFIED    SA51078 65364010
         BZ    STRTERR                  BRANCH IF NO            SA51078 65366010
         BR    R1                       RETURN                  SA51078 65368010
         EJECT                                                          65370010
* IF THERE IS NO SAVT THEN SUBAREA IS INVALID. GO TO SEND      @Y17XANG 65372010
* ERROR MSG AND REISSUE WTOR.                                  @Y17XANG 65374010
         SPACE                                                          65376010
SUBAREA EQU    *                                               @Y17XANG 65378010
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 65380010
         BZ    NOT3705                  BRANCH                 @Y17XANG 65382010
         SPACE                                                          65384010
* CONVERT KEYBOARD OPERAND TO BINARY                           @Y17XANG 65386010
         SPACE                                                          65388010
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY.@Y17XANG 65390010
         SPACE                                                          65392010
* IF THE SUBAREA ADDRESS EXCEEDS A SINGLE BYTE THEN GO PRINT   @Y17XANG 65394010
* INVALID OPERAND MESSAGE.                                     @Y17XANG 65396010
         SPACE                                                          65398010
         LA    R14,255                  MAX ADDRESS IN BYTE    @Y17XANG 65400010
         CR    RANS,R14                 DOES IT EXCEED BYTE?   @Y17XANG 65402010
         BH    NOTNUM                   BRANCH IF SO.          @Y17XANG 65404010
         SPACE                                                          65406010
* PLACE HOST SUBAREA INTO SAVT. RETURN TO CHECK OPERANDS.      @Y17XANG 65408010
         SPACE                                                          65410010
         L     R14,AVTSAVTP             SAVT BASE              @Y17XANG 65412010
         USING IEDNSVTD,R14                                    @Y17XANG 65414010
         STC   RANS,SAVTSUBV            SAVE SUBAREA           @Y17XANG 65416010
         BR    R1                       GO TO'BACK'            @Y17XANG 65418010
MAXCLI   CLI   SAVTSUBA,0               COMPARE MAXSUB TO SUB  @Y17XANG 65420010
         DROP  R14                                                      65422010
         EJECT                                                          65424010
* IF THERE IS NO SAVT MAXSUBA IS INVALID - GO TO PRINT         @Y17XANG 65426010
* INVALID KEYWORD MESSAGE.                                     @Y17XANG 65428010
         SPACE                                                          65430010
MAXSUBA  EQU   *                                               @Y17XANG 65432010
         TM    AVTSAVTF,AVTVTMCP        IS SAVT PRESENT?       @Y17XANG 65434010
         BZ    NOT3705                  BRANCH NO              @Y17XANG 65436010
         SPACE                                                          65438010
* CONVERT MAX SUBAREA TO BINARY.                               @Y17XANG 65440010
         SPACE                                                          65442010
         BAL   R14,HALFNO               CONVERT MAX TO BINARY  @Y17XANG 65444010
         SPACE                                                          65446010
* IF MAX SUBAREA NOT GE 2 AND LE 255 GO PRINT INVALID OPERAND  @Y17XANG 65448010
* DIAGNOSTIC.                                                  @Y17XANG 65450010
         SPACE                                                          65452010
         LA    R15,MINMAXA              MINIMUM MAX SUBAREA    @Y17XANG 65454010
         CR    RANS,R15                 MAX LT 2?              @Y17XANG 65456010
         BL    NOTNUM                   BRANCH YES TO DIAG     @Y17XANG 65458010
         LA    R15,MAXMAXA              MAXIMUM MAX SUBAREA    @Y17XANG 65460010
         CR    RANS,R15                 MAX GT 255?            @Y17XANG 65462010
         BH    NOTNUM                   BRANCH YES TO DIAG.    @Y17XANG 65464010
         SPACE                                                          65466010
* SAVE MAX SUBAREA IN SAVT -SAVTSUBA- AND RETURN TO 'BACK'     @Y17XANG 65470010
         SPACE                                                          65472010
         USING IEDNSVTD,R14                                    @Y17XANG 65474010
         L     R14,AVTSAVTP             SAVT ADDRESS           @Y17XANG 65476010
         STC   RANS,SAVTSUBA            SAVE MAX               @Y17XANG 65478010
         DROP  R14                                             @Y17XANG 65480010
         SPACE                                                          65482010
         BR    R1                                              @Y17XANG 65484010
MINMAXA  EQU   2                        MIN MAX SUBAREA ADDR   @Y17XANG 65486010
MAXMAXA  EQU   255                      MAX MAX SUBAREA ADDR   @Y17XANG 65488010
         EJECT                                                 @Y17XANG 65490010
* IF NO SAVT SIBCOUNT IS INVALID KEY - GO PRINT INVALID KEY    @Y17XANG 65492010
* MESSAGE AND REISSUE WTOR.                                    @Y17XANG 65494010
         SPACE                                                          65496010
SIBCOUNT EQU   *                                               @Y17XANG 65498010
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 65500010
         BZ    NOT3705                  BRANCH NO TO DIAG.     @Y17XANG 65502010
         SPACE                                                          65504010
* CONVERT SIBCOUNT TO BINARY.                                  @Y17XANG 65506010
         SPACE                                                          65508010
         BAL   R14,HALFNO               CONVERT                @Y17XANG 65510010
         SPACE                                                          65512010
* IF SIBCOUNT=0 GO PRINT INVALID OPERAND AND REISSUE WTOR.     @Y17XANG 65514010
         SPACE                                                          65516010
         LTR   RANS,RANS                SIBCOUNT=0?            @Y17XANG 65518010
         BZ    NOTNUM                   BRANCH YES             @Y17XANG 65520010
         SPACE                                                          65522010
* IF SNA AND SIBCOUNT < 4 ISSUE INVALID OPERAND AND REISSUE    @Y17XANG 65524010
* WTOR.                                                        @Y17XANG 65526010
         SPACE                                                          65528010
         TM    AVTSAVTF,AVTSNA          SNA?                   @Y17XANG 65530010
         BZ    NOSNA                    BRANCH NO              @Y17XANG 65532010
         LA    R15,MINSIB               MINIMUM #SIBS WITH SNA @Y17XANG 65534010
         CR    RANS,R15                 SIB COUNT LT MIN?      @Y17XANG 65536010
         BL    NOTNUM                   BRANCH YES.            @Y17XANG 65538010
NOSNA    EQU   *                                               @Y17XANG 65540010
         SPACE                                                          65542010
* SAVE SIB COUNT IN SAVT. RETURN TO 'BACK'.                    @Y17XANG 65544010
         SPACE                                                          65546010
         L     R14,AVTSAVTP             SAVT BASE              @Y17XANG 65548010
         USING IEDNSVTD,R14                                    @Y17XANG 65550010
         STH   RANS,SAVTSIBC            SAVE SIB COUNT.        @Y17XANG 65552010
         BR    R1                       GO TO'BACK'            @Y17XANG 65554010
         DROP  R14                                             @Y17XANG 65556010
MINSIB   EQU   4                        MIN SNA SIB COUNT -    @Y17XANG 65558010
*                                           .NCP                        65560010
*                                           .PU-SSCP                    65562010
*                                           .LU-SSCP                    65564010
*                                           .LU-LU                      65566010
         EJECT                                                          65568010
***************************************************************@G36XRNP 65570010
*                                                              @G36XRNP 65572010
*        APPLICATION PROGRAM WORKAREA SIZE PROCESSING          @G36XRNP 65574010
*                                                              @G36XRNP 65576010
***************************************************************@G36XRNP 65578010
APWAS    EQU   *                                               @G36XRNP 65580010
         BAL   R14,HALFNO               CONVERT APWAS OPERAND  @G36XRNP 65582010
         CH    RANS,H4024              IS THIS A 4024 BYTE AREA@G36XRNP 65584010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65586010
         BH    LARGEAIB                 BRANCH IF AIB OVER 4K  @G36XRNP 65588010
         CH    RANS,H1976              IS THIS A 1976 BYTE AREA@G36XRNP 65590010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65592010
         CH    RANS,H952               IS THIS A 952 BYTE AREA @G36XRNP 65594010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65596010
         CH    RANS,H440               IS THIS A 440 BYTE AREA @G36XRNP 65598010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65600010
         CH    RANS,H184               IS THIS A I84 BYTE QREA @G36XRNP 65602010
         BNE   NOTNUM                   NO, BRANCH             @G36XRNP 65604010
         B     APWASOK                  YES,BRANCH             @G36XRNP 65606010
LARGEAIB EQU   *                                               @G36XRNP 65608010
         CH    RANS,MAXAIB              AIB IN RANGE ALLOWED   @G36XRNP 65610010
         BH    NOTNUM                   NO, BRANCH             @G36XRNP 65612010
APWASOK  EQU   *                                               @G36XRNP 65614010
         STH   RANS,AVTEW               SAVE SIZE IN THE AVT   @G36XRNP 65616010
         BR    R1                       TEST NEXT KEYWORD      @G36XRNP 65618010
         EJECT                                                          65620010
***************************************************************@G36XRNP 65622010
*                                                              @G36XRNP 65624010
*         AUTHORIZATION OPERAND PROCESSING                     @G36XRNP 65626010
*                                                              @G36XRNP 65628010
***************************************************************@G36XRNP 65630010
AUTHA    EQU   *                                               @G36XRNP 65632010
         BAL   RX,SCAN                  SCAN FOR VALID OPTION  @G36XRNP 65634010
         CLC   YESCOM,D0(RSTART)        IS OPERAND='YES'       @G36XRNP 65636010
         BE    AUTHAYES                 YES, GO SET BIT IN AVT @G36XRNP 65638010
*                                      INDICATING AUTHORIZATION@G36XRNP 65640010
*                                       SPECIFIED              @G36XRNP 65642010
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND='YES'      @G36XRNP 65644010
         BE    AUTHAYES                 YES, GO SET BIT IN AVT @G36XRNP 65646010
*                                      INDICATING AUTHORIZATION@G36XRNP 65648010
*                                       SPECIFIED              @G36XRNP 65650010
         CLC   NOCOM,D0(RSTART)         IS OPERAND ='NO'       @G36XRNP 65652010
         BE    AUTHANO                  YES, GO TURN OFF BIT IN@G36XRNP 65654010
*                                       AVT INDICATING         @G36XRNP 65656010
*                                       AUTHORIZATION SPECIFIED@G36XRNP 65658010
         CLC   NO0(L'NOCOM),D0(RSTART)  IS OPERAND='NO'        @G36XRNP 65660010
         BNE   NOTNUM                   NO, INVALID OPERAND    @G36XRNP 65662010
AUTHANO  EQU   *                                               @G36XRNP 65664010
         NI    AVTEW+TWO,NOAUTRQD       TURN THE AUTHORIZATION @G36XRNP 65666010
*                                       REQUIRED BIT OFF       @G36XRNP 65668010
         BR    R1                       CHECK NEXT OPERAND     @G36XRNP 65670010
AUTHAYES EQU   *                                               @G36XRNP 65672010
         OI    AVTEW+TWO,AUTHBIT        TURN ON AUTHORIZATION  @G36XRNP 65674010
*                                       REQUIRED BIT           @G36XRNP 65676010
         BR    R1                       CHECK NEXT OPERAND     @G36XRNP 65678010
         EJECT                                                          65959800
* SET UP OPERAND CONVERSION.                                   @Y17XANG 65960000
         SPACE                                                          65960200
OPMASK   EQU   *                                               @Y17XANG 65960400
         LA    REND,1(RSTART)           ADDRESS 1ST CHAR AFTER @Y17XANG 65960600
*                                      '('.                    @Y17XANG 65960800
         L     RANS,AVTOPMSK            MASK TABLE BASE        @Y17XANG 65961000
         LA    REOT,L'MSKMASK           MASK LENGTH            @Y17XANG 65961200
         MH    REOT,MSKNUM-IEDMSK(RANS) * # MASKS = LENGTH OF  @Y17XANG 65961400
*                                       MASKS.                 @Y17XANG 65961600
         LA    REOT,MSKMASK-IEDMSK-L'MSKMASK(REOT,RANS)        @Y17XANG 65961800
*                                       ADDRESS OF LAST MASK   @Y17XANG 65962000
         LR    RDLIM,RSTART             ADDRESS OF '('         @Y17XANG 65962200
         LA    RANS,MSKMASK-IEDMSK(RANS)    ADDRESS 1ST MASK.  @Y17XANG 65962400
         USING MSKMASK,RANS                                    @Y17XANG 65962600
         SPACE                                                          65962800
* FIRST CHAR A '('? IF NOT GO PRINT INVALID OPERAND DIAG AND   @Y17XANG 65963000
* REISSUE WTOR.                                                @Y17XANG 65963200
         SPACE                                                          65963400
         CLI   0(RSTART),C'('           '(' ?                  @Y17XANG 65963600
         BNE   NOTNUM                   BRANCH NO TO DIAG      @Y17XANG 65963800
         MVI   0(RDLIM),C','            INSURE 1ST SYNTAX CHK  @Y17XANG 65964000
         SPACE                                                          65964200
* SET UP SCAN INCREMENT TO ADVANCE 1 CHAR IN CASE ',' INDICATES@Y17XANG 65964400
* MASK TO DEFAULT.                                             @Y17XANG 65964600
         SPACE                                                          65964800
MSKLOOP  EQU   *                                               @Y17XANG 65965000
         LA    RX,1                     SCAN POINTER INCREMENT @Y17XANG 65965200
         SPACE                                                          65965400
* IF NO MORE MASKS BRANCH TO ADVANCE TO NEXT SYNTAX DELIMITER  @Y17XANG 65965600
* AND EXIT.                                                    @Y17XANG 65965800
         SPACE                                                          65966000
         CLI   0(REND),C')'             ANY MORE MASKS?        @Y17XANG 65966200
         BE    NXTMSK                   BRANCH NO              @Y17XANG 65966400
         SPACE                                                          65966600
* IF LAST DELIMITER NOT A COMMA GO PRINT OPERAND ERROR MESSAGE @Y17XANG 65966800
* AND REQUEST ANOTHER OPERATOR INPUT.                          @Y17XANG 65967000
         SPACE                                                          65967200
         CLI   0(RDLIM),C','            COMMA?                 @Y17XANG 65967400
         BNE   NOTNUM                                          @Y17XANG 65967600
         SPACE                                                          65967800
* IF NEXT CHAR A ',' INDICATING DEFAULT GO ADVANCE TO NEXT     @Y17XANG 65968000
* MASK.                                                        @Y17XANG 65968200
         SPACE                                                          65968400
         CLI   0(REND),C','             ',' ?                  @Y17XANG 65968600
         BE    NXTMSK                   BRANCH YES TO ADVANCE. @Y17XANG 65968800
         SPACE                                                          65969000
* TRANSLATE NEXT 4 CHARS.  INVALID CHARS WILL TRANSLATE TO     @Y17XANG 65969200
* X'00'.  VALID HEX CHAR, N, WILL TRANSLATE TO X'FN'.          @Y17XANG 65969400
         SPACE                                                          65969600
         TR    0(4,REND),TRANMSK        TRANSLATE              @Y17XANG 65969800
         SPACE                                                          65970000
* IF ANY INVALID CHARS GO ISSUE INVALID OPERAND MSG AND WTOR.  @Y17XANG 65970200
         SPACE                                                          65970400
         MVC   AVTDOUBL(L'MSKMASK*2),0(REND) COPY TRANS CHARS  @Y17XANG 65970600
         NC    AVTDOUBL(L'MSKMASK*2),CLRNUM CLEAR NUMERICS     @Y17XANG 65970800
         XC    AVTDOUBL(L'MSKMASK*2),CLRNUM ANY INVALID CHARS? @Y17XANG 65971000
*                                      (RESULT OF XC WILL BE   @Y17XANG 65971200
*                                       ZERO IF NOT SINCE ALL  @Y17XANG 65971400
*                                       VALID HEX NO'S WERE    @Y17XANG 65971600
*                                       X'F0' AFTER THE NC)    @Y17XANG 65971800
         BNZ   NOTNUM                   BRANCH ANY INVALID     @Y17XANG 65972000
         SPACE                                                          65972200
* PLACE HEX CHARS INTO CURRENT MASK TABLE ENTRY.               @Y17XANG 65972400
         SPACE                                                          65972600
         PACK  AVTDOUBL(L'MSKMASK+1),0(L'MSKMASK*2,REND)       @Y17XANG 65972800
*                                       REMOVE ZONES FROM HEX  @Y17XANG 65973000
*                                       DIGITS.                @Y17XANG 65973200
         MVO   AVTDOUBL(L'MSKMASK+2),AVTDOUBL(L'MSKMASK+1)     @Y17XANG 65973400
*                                       SHIFT HEX DIGITS LEFT  @Y17XANG 65973600
*                                       4 BITS TO ALIGN IN     @Y17XANG 65973800
*                                       2 BYTES                @Y17XANG 65974000
         MVC   0(L'MSKMASK,RANS),AVTDOUBL+1 PLACE MASK IN TBL  @Y17XANG 65974200
         SPACE                                                          65974400
* SET SCAN INCREMENT TO ADVANCE TO NEXT MASK (5 CHARS FWD).    @Y17XANG 65974600
         SPACE                                                          65974800
         LA    RX,L'MSKMASK*2+1         INCREMENT TO NEXT MASK @Y17XANG 65975000
         SPACE                                                          65975200
* ADVANCE TO NEXT MASK GROUP IN TABLE AND KEYBOARD INPUT.      @Y17XANG 65975400
         SPACE                                                          65975600
NXTMSK   EQU   *                                               @Y17XANG 65975800
         LA    RDLIM,0(RX,RDLIM)        NEXT INPUT MASK ADDRESS@Y17XANG 65976000
*                                       MINUS ONE=DELIMITER    @Y17XANG 65976200
*                                       ADDRESS(RDLIM=REND-1)  @Y17XANG 65976400
         LA    REND,0(RX,REND)          INPUT MASK ADDRESS     @Y17XANG 65976600
         LA    RANS,MSKLEN(RANS)        NEXT MASK TABLE ENTRY  @Y17XANG 65976800
         SPACE                                                          65977000
* IF THERE ARE MORE INPUT MASKS AND MASK TABLE NOT EXCEEDED    @Y17XANG 65977200
* GO TRANSLATE THE NEXT INPUT AND PLACE INTO TABLE.            @Y17XANG 65977400
         SPACE                                                          65977600
         CLI   0(RDLIM),C')'            IF DELIMITER IS ')'    @Y17XANG 65977800
*                                       THERE ARE NO MORE      @Y17XANG 65978000
*                                       INPUT MASKS.           @Y17XANG 65978200
         BE    NOMOPARM                 BRANCH IF ')'          @Y17XANG 65978400
         CR    RANS,REOT                END OF MASK TABLE?     @Y17XANG 65978600
         BNH   MSKLOOP                  BRANCH NO TO PROCESS   @Y17XANG 65978800
*                                       NEXT INPUT MASK        @Y17XANG 65979000
         SPACE                                                          65979200
* MORE INPUT PARMS BUT END OF TABLE NOT REACHED GO PRINT       @Y17XANG 65979400
* OPERAND ERROR MESSAGE AND REISSUE DIAGNOSTIC.                @Y17XANG 65979600
         SPACE                                                          65979800
         B     NOTNUM                   BRANCH FOR DIAG        @Y17XANG 65980000
         SPACE                                                          65980200
* RETURN TO PROCESS NEXT KEYWORD.                              @Y17XANG 65980400
         SPACE                                                          65980600
NOMOPARM EQU   *                                               @Y17XANG 65980800
         BR    R1                       GO TO'BACK             @Y17XANG 65981000
         EJECT                                                 @Y17XANG 65981200
*                                                                       66000020
* RSTART POINTS TO FIRST OF OPERAND.                                    66080020
* RESULT IS IN RANS.                                                    66160020
*                                                                       66240020
HALFNO   EQU   *                                                        66320020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 66400022
*                                        CHARACTER OF OPERAND    SI1903 66440022
*                                                                       66480020
         BAL   RX,NUMCONV              GO PERFORM VALIDITY CHECK S21903 66560022
*                                        FOR PROPER NUMERICAL    S21903 66580022
*                                        CHARACTERS              S21903 66600022
*                                                                       66640020
         C     RANS,K64                 IS RESULT GT 64 K               66720020
         BH    NOTNUM                     YES, ILLEGAL OPERAND          66800020
*                                         NO,RESULT IS OK               66880020
         BR    R14                      RETURN TO CALLER                66960020
*                                                                       67040020
* NUMERICAL CONVERT ROUTINE -                                           67120020
* GIVEN A NUMERICAL OPERAND FIELD, DO VALIDITY CHECKING FOR PROPER      67200020
* NUMERICAL CHARACTERS.  IF OK, CONVERT NUMBER TO BINARY.               67280020
*                                                                       67360020
*        INPUT - RSTART HAS ADDRESS OF FIRST CHARACTER OF OPERAND,      67440020
*              REND HAS ADDRESS OF NEXT CHARACTER BEYOND OPERAND.       67520020
*        OUTPUT - RANS HAS POSITIVE BINARY RESULT.  IF NOT PROPER       67600020
*              NUMERICAL CHARACTERS, CONTROL IS GIVEN TO INVALID        67680020
*              OPERAND ROUTINE AT 'NOTNUM'.                             67760020
*                                                                       67840020
NUMCONV  EQU   *                                                        67920020
         LR    RCNT,RTEMP               GET SIZE OF OPERAND             68000020
         CH    RCNT,AVTHA7              IS OPERAND OVER 7 CHARS         68080020
         BH    NOTNUM                     YES, TOO BIG                  68160020
*                                         NO, SO FAR SO GOOD            68240020
         LR    RINDEX,RSTART            GET ADDR OF FIRST CHARACTER     68320020
*                                                                       68400020
CONVLOOP EQU   *                                                        68480020
         TM    0(RINDEX),XF0            IS CHARACTER NUMERICAL          68560020
         BNO   NOTNUM                     NO, ILLEGAL OPERAND           68640020
*                                         YES, OK CHARACTER             68720020
         LA    RINDEX,INC(,RINDEX)      BUMP TO NEXT CHARACTER          68800020
         BCT   RCNT,CONVLOOP            CHECK NEXT CHAR, IF ANY         68880020
*                                                                       68960020
         LR    RCNT,REND                                                69040020
         SR    RCNT,RSTART              GET SIZE OF OPERAND AGAIN       69120020
         BCTR  RCNT,0                   ADJUST FOR EX INSTR.            69200020
         EX    RCNT,PACK               GO PACK THE NUMBER        S21903 69280022
         MVN   AVTDOUBL+L'AVTDOUBL-INC(INC),P GET PROPER PLUS SIGN      69360020
         CVB   RANS,AVTDOUBL            GET BINARY RESULT               69440020
         BR    RX                       RETURN TO MAIN ROUTINE          69520020
*                                                                       69600020
PACK     PACK  AVTDOUBL,0(0,RSTART)     EXECUTED INSTRUCTION            69680020
MVCKEY   MVC   MSGOP(0),0(RSTART)       MOVES KEYWORD TO MSG            69760020
*                                                                       69840020
NOTNUM   EQU   *                                                        69920020
         MVI   MSGOP,AVTEBLNK           CLEAR MESSAGE                   70000020
         MVC   MSGOP+INC(LKEYWORD-INC),MSGOP AREA TO BLANKS             70080020
         SH    RSTART,KEYL              BACK UP TO KEYWORD              70160020
         LH    RTEMP,KEYL                                               70240020
         BCTR  RTEMP,D0                DECREMENT COUNT BY 1      S21903 70320022
         EX    RTEMP,MVCKEY             GET KEYWORD TO MSG              70400020
         LA    R1,IED006A               INVALID OPERAND MSG      S21101 70600021
         B     WTOR                    GO ISSUE INVALID OPERAND  S21903 70960022
*                                        MESSAGE                 S21903 71000022
*                                                                       71040020
* SCAN ROUTINE -                                                        71120020
* GIVEN A STARTING ADDRESS OF AN OPERAND, LOOK FOR THE LAST CHARACTER   71200020
* OF THE OPERAND BY SCANNING FOR EITHER A COMMA OR FOR X'00' AS         71280020
* ENDING THE OPERAND.                                                   71360020
*                                                                       71440020
*        INPUT - RSTART HAS THE ADDRESS OF THE FIRST CHARACTER OF       71520020
*              THE OPERAND.                                             71600020
*        OUTPUT - REND HAS THE ADDRESS OF THE FIRST CHARACTER BEYOND    71680020
*              THE OPERAND.  RSTART IS UNCHANGED.                       71760020
*              RTEMP HAS SIZE OF OPERAND.                               71840020
*                                                                       71920020
SCAN     EQU   *                                                        72000020
         LR    REND,RSTART              INITIALIZE ENDING REG           72080020
SCANLOOP EQU   *                                                        72160020
         CLI   0(REND),COMMA            IS NEXT CHAR A COMMA            72240020
         BE    ENDSCAN                    YES, CHECK LENGTH             72320020
*                                         NO, KEEP LOOKING              72400020
         CLI   0(REND),AVTEZERO         IS THAT END OF REPLY            72480020
         BNE   BUMP                       NO, KEEP LOOKING              72560020
*                                         YES, RETURN TO CALLER         72640020
ENDSCAN  EQU   *                                                        72720020
         LR    RTEMP,REND                                               72800020
         SR    RTEMP,RSTART             GET SIZE OF OPERAND             72880020
*                                       SIZE MUST BE AT LEAST ONE       72960020
         BZ    NOTNUM                   IF NOT, ERROR                   73040020
*                                       IF SO, OK                       73120020
         BR    RX                       RETURN TO CALLER                73200020
*                                                                       73280020
BUMP     EQU   *                                                        73360020
         LA    REND,INC(,REND)          BUMP ENDING REG TO NEXT CHAR    73440020
         B     SCANLOOP                 TRY AGAIN                       73520020
         EJECT                                                          73600010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 73602021
*                                                                S21101 73604021
*                       WRITE - TO - OPERATORS                   S21101 73606021
*                                                                S21101 73608021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       73608210
AUTHMSG  EQU   *                                               @G36XRNP 73608410
         WTO   MF=(E,IED155I)           WRITE ERROR MSG        @G36XRNP 73608610
         LA    R15,AVTECD28             SET ERROR CODE         @G36XRNP 73608810
         B     EXIT                     RETURN TO IEDQOA       @G36XRNP 73609010
IED155I  WTO   'IED155I TCAM START REJECTED - TCAM MCP IS UNAUTHORIZED'*73609210
               ,ROUTCDE=(2,11),DESC=6,MF=L                     @G36XRNP 73609410
IED001I  WTO   'IED001I TCAM JOB JOBNAMEX, PROCNAME, STEPNAME ADDRESS OF73610021
               F AVT          ',ROUTCDE=(2,11),DESC=6,MF=L       S21101 73612021
JOBID    EQU   IED001I+21               JOBID                    S22024 73614022
ADAVT    EQU   IED001I+65               ADAVT                    S22024 73616022
         ENTRY IED001I                                           S21101 73618021
*                                                                S21101 73620021
IED014I  WTO   'IED014I TCAM ALREADY IN SYSTEM',                 S21101*73622021
               ROUTCDE=(2,11),DESC=6,MF=L                        S21101 73624021
         ENTRY IED014I                                           S21101 73626021
*                                                                S21101 73628021
IED002A  WTOR  'IED002A SPECIFY TCAM PARAMETERS',                S21101*73630021
               REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L         @Y17XANG 73631000
         ENTRY IED002A                                           S21101 73634021
*                                                                S21101 73636021
IED003A  WTOR  'IED003A INVALID KEYWORD     ',                   S21101*73638021
               REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L         @Y17XANG 73640000
MSGKEY   EQU   IED003A+36               MSGKEY                   S22024 73642022
         ENTRY IED003A                                           S21101 73644021
*                                                                S21101 73646021
IED004A  WTOR  'IED004A REQUIRED PARAMETER MISSING. SPECIFY         ', *73648021
               REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L         @Y17XANG 73650000
MISSKEY  EQU   IED004A+56               MISSKEY                  S22024 73652022
         ENTRY IED004A                                           S21101 73654021
*                                                                S21101 73656021
IED005A  WTOR  'IED005A MSUNITS(M) SPECIFICATION NOT PERMITTED.  CONTIN*73658021
               UE RESPONSE',REPLY,L'REPLY,ECB,ROUTCDE=1,       @Y17XANG*73660000
               DESC=2,MF=L                                              73661000
         ENTRY IED005A                                           S21101 73662021
*                                                                S21101 73664021
IED006A  WTOR  'IED006A INVALID OPERAND ON KEYWORD.  RESPECIFY         *73666021
               ',REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L       @Y17XANG 73668000
MSGOP    EQU   IED006A+59               MSSOP                    S22024 73670022
         ENTRY IED006A                                           S21101 73672021
IED527A  WTOR  'IED527A HOST SUBAREA EXCEEDS MAXIMUM. SPECIFY NEW SUBAR*73672400
               EA OR MAXSUBA',REPLY,L'REPLY,ECB,ROUTCDE=1,     @YM06974*73672800
               DESC=2,MF=L                                     @YM06974 73673200
         ENTRY IED527A                                         @Y17XANG 73673600
*                                                                S21101 73674021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 73676021
*                                                                S21101 73678021
CHTABLE  DS    0F                                                       73680020
         DC    X'00'                    00                              73760020
         DC    C'.'                     01                              73840020
         DC    C'.'                     02                              73920020
         DC    C'.'                     03                              74000020
         DC    C'.'                     04                              74080020
         DC    C'.'                     05                              74160020
         DC    C'.'                     06                              74240020
         DC    C'.'                     07                              74320020
         DC    C'.'                     08                              74400020
         DC    C'.'                     09                              74480020
         DC    C'.'                     0A                              74560020
         DC    C'.'                     0B                              74640020
         DC    C'.'                     0C                              74720020
         DC    C'.'                     0D                              74800020
         DC    C'.'                     0E                              74880020
         DC    C'.'                     0F                              74960020
         DC    C'.'                     10                              75040020
         DC    C'.'                     11                              75120020
         DC    C'.'                     12                              75200020
         DC    C'.'                     13                              75280020
         DC    C'.'                     14                              75360020
         DC    C'.'                     15                              75440020
         DC    C'.'                     16                              75520020
         DC    C'.'                     17                              75600020
         DC    C'.'                     18                              75680020
         DC    C'.'                     19                              75760020
         DC    C'.'                     1A                              75840020
         DC    C'.'                     1B                              75920020
         DC    C'.'                     1C                              76000020
         DC    C'.'                     1D                              76080020
         DC    C'.'                     1E                              76160020
         DC    C'.'                     1F                              76240020
         DC    C'.'                     20                              76320020
         DC    C'.'                     21                              76400020
         DC    C'.'                     22                              76480020
         DC    C'.'                     23                              76560020
         DC    C'.'                     24                              76640020
         DC    C'.'                     25                              76720020
         DC    C'.'                     26                              76800020
         DC    C'.'                     27                              76880020
         DC    C'.'                     28                              76960020
         DC    C'.'                     29                              77040020
         DC    C'.'                     2A                              77120020
         DC    C'.'                     2B                              77200020
         DC    C'.'                     2C                              77280020
         DC    C'.'                     2D                              77360020
         DC    C'.'                     2E                              77440020
         DC    C'.'                     2F                              77520020
         DC    C'.'                     30                              77600020
         DC    C'.'                     31                              77680020
         DC    C'.'                     32                              77760020
         DC    C'.'                     33                              77840020
         DC    C'.'                     34                              77920020
         DC    C'.'                     35                              78000020
         DC    C'.'                     36                              78080020
         DC    C'.'                     37                              78160020
         DC    C'.'                     38                              78240020
         DC    C'.'                     39                              78320020
         DC    C'.'                     3A                              78400020
         DC    C'.'                     3B                              78480020
         DC    C'.'                     3C                              78560020
         DC    C'.'                     3D                              78640020
         DC    C'.'                     3E                              78720020
         DC    C'.'                     3F                              78800020
* START OF SECOND QUARTER OF TABLE                                      78840022
         DC    C' '                     40                              78880020
         DC    C'.'                     41                              78960020
         DC    C'.'                     42                              79040020
         DC    C'.'                     43                              79120020
         DC    C'.'                     44                              79200020
         DC    C'.'                     45                              79280020
         DC    C'.'                     46                              79360020
         DC    C'.'                     47                              79440020
         DC    C'.'                     48                              79520020
         DC    C'.'                     49                              79600020
         DC    C'.'                     4A                              79680020
         DC    X'4B'                    4B                              79760020
         DC    X'4C'                    4C                              79840020
         DC    X'4D'                    4D                              79920020
         DC    X'4E'                    4E                              80000020
         DC    C','                     4F CHANGE 'BAR' TO 'COMMA'      80080020
         DC    X'50'                    50                              80160020
         DC    C'.'                     51                              80240020
         DC    C'.'                     52                              80320020
         DC    C'.'                     53                              80400020
         DC    C'.'                     54                              80480020
         DC    C'.'                     55                              80560020
         DC    C'.'                     56                              80640020
         DC    C'.'                     57                              80720020
         DC    C'.'                     58                              80800020
         DC    C'.'                     59                              80880020
         DC    C'.'                     5A                              80960020
         DC    C'$'                     5B                              81040020
         DC    C'*'                     5C                              81120020
         DC    C')'                     5D                              81200020
         DC    C';'                     5E                              81280020
         DC    C'^'                     5F                              81360020
         DC    C'-'                     60                              81440020
         DC    C'/'                     61                              81520020
         DC    C'.'                     62                              81600020
         DC    C'.'                     63                              81680020
         DC    C'.'                     64                              81760020
         DC    C'.'                     65                              81840020
         DC    C'.'                     66                              81920020
         DC    C'.'                     67                              82000020
         DC    C'.'                     68                              82080020
         DC    C'.'                     69                              82160020
         DC    C'.'                     6A                              82240020
         DC    C','                     6B                              82320020
         DC    X'6C'                    6C                              82400020
         DC    X'6D'                    6D                              82480020
         DC    C'>'                     6E                              82560020
         DC    C'?'                     6F                              82640020
         DC    C'.'                     70                              82720020
         DC    C'.'                     71                              82800020
         DC    C'.'                     72                              82880020
         DC    C'.'                     73                              82960020
         DC    C'.'                     74                              83040020
         DC    C'.'                     75                              83120020
         DC    C'.'                     76                              83200020
         DC    C'.'                     77                              83280020
         DC    C'.'                     78                              83360020
         DC    C'.'                     79                              83440020
         DC    C':'                     7A                              83520020
         DC    C'#'                     7B                              83600020
         DC    X'7C'                    7C                              83680020
         DC    C''''                    7D                              83760020
         DC    C'='                     7E                              83840020
         DC    C'"'                     7F                              83920020
* START OF THIRD QUARTER OF TABLE                                       83960022
         DC    C'.'                     80                              84000020
         DC    C'A'                     81                              84080020
         DC    C'B'                     82                              84160020
         DC    C'C'                     83                              84240020
         DC    C'D'                     84                              84320020
         DC    C'E'                     85                              84400020
         DC    C'F'                     86                              84480020
         DC    C'G'                     87                              84560020
         DC    C'H'                     88                              84640020
         DC    C'I'                     89                              84720020
         DC    C'.'                     8A                              84800020
         DC    C'.'                     8B                              84880020
         DC    C'.'                     8C                              84960020
         DC    C'.'                     8D                              85040020
         DC    C'.'                     8E                              85120020
         DC    C'.'                     8F                              85200020
         DC    C'.'                     90                              85280020
         DC    C'J'                     91                              85360020
         DC    C'K'                     92                              85440020
         DC    C'L'                     93                              85520020
         DC    C'M'                     94                              85600020
         DC    C'N'                     95                              85680020
         DC    C'O'                     96                              85760020
         DC    C'P'                     97                              85840020
         DC    C'Q'                     98                              85920020
         DC    C'R'                     99                              86000020
         DC    C'.'                     9A                              86080020
         DC    C'.'                     9B                              86160020
         DC    C'.'                     9C                              86240020
         DC    C'.'                     9D                              86320020
         DC    C'.'                     9E                              86400020
         DC    C'.'                     9F                              86480020
         DC    C'.'                     A0                              86560020
         DC    C'.'                     A1                              86640020
         DC    C'S'                     A2                              86720020
         DC    C'T'                     A3                              86800020
         DC    C'U'                     A4                              86880020
         DC    C'V'                     A5                              86960020
         DC    C'W'                     A6                              87040020
         DC    C'X'                     A7                              87120020
         DC    C'Y'                     A8                              87200020
         DC    C'Z'                     A9                              87280020
         DC    C'.'                     AA                              87360020
         DC    C'.'                     AB                              87440020
         DC    C'.'                     AC                              87520020
         DC    C'.'                     AD                              87600020
         DC    C'.'                     AE                              87680020
         DC    C'.'                     AF                              87760020
         DC    C'.'                     B0                              87840020
         DC    C'.'                     B1                              87920020
         DC    C'.'                     B2                              88000020
         DC    C'.'                     B3                              88080020
         DC    C'.'                     B4                              88160020
         DC    C'.'                     B5                              88240020
         DC    C'.'                     B6                              88320020
         DC    C'.'                     B7                              88400020
         DC    C'.'                     B8                              88480020
         DC    C'.'                     B9                              88560020
         DC    C'.'                     BA                              88640020
         DC    C'.'                     BB                              88720020
         DC    C'.'                     BC                              88800020
         DC    C'.'                     BD                              88880020
         DC    C'.'                     BE                              88960020
         DC    C'.'                     BF                              89040020
* START OF LAST QUARTER OF TABLE                                        89080022
         DC    C'.'                     C0                              89120020
         DC    C'A'                     C1                              89200020
         DC    C'B'                     C2                              89280020
         DC    C'C'                     C3                              89360020
         DC    C'D'                     C4                              89440020
         DC    C'E'                     C5                              89520020
         DC    C'F'                     C6                              89600020
         DC    C'G'                     C7                              89680020
         DC    C'H'                     C8                              89760020
         DC    C'I'                     C9                              89840020
         DC    C'.'                     CA                              89920020
         DC    C'.'                     CB                              90000020
         DC    C'.'                     CC                              90080020
         DC    C'.'                     CD                              90160020
         DC    C'.'                     CE                              90240020
         DC    C'.'                     CF                              90320020
         DC    C'.'                     D0                              90400020
         DC    C'J'                     D1                              90480020
         DC    C'K'                     D2                              90560020
         DC    C'L'                     D3                              90640020
         DC    C'M'                     D4                              90720020
         DC    C'N'                     D5                              90800020
         DC    C'O'                     D6                              90880020
         DC    C'P'                     D7                              90960020
         DC    C'Q'                     D8                              91040020
         DC    C'R'                     D9                              91120020
         DC    C'.'                     DA                              91200020
         DC    C'.'                     DB                              91280020
         DC    C'.'                     DC                              91360020
         DC    C'.'                     DD                              91440020
         DC    C'.'                     DE                              91520020
         DC    C'.'                     DF                              91600020
         DC    C'.'                     E0                              91680020
         DC    C'.'                     E1                              91760020
         DC    C'S'                     E2                              91840020
         DC    C'T'                     E3                              91920020
         DC    C'U'                     E4                              92000020
         DC    C'V'                     E5                              92080020
         DC    C'W'                     E6                              92160020
         DC    C'X'                     E7                              92240020
         DC    C'Y'                     E8                              92320020
         DC    C'Z'                     E9                              92400020
         DC    C'.'                     EA                              92480020
         DC    C'.'                     EB                              92560020
         DC    C'.'                     EC                              92640020
         DC    C'.'                     ED                              92720020
         DC    C'.'                     EE                              92800020
         DC    C'.'                     EF                              92880020
         DC    C'0'                     F0                              92960020
         DC    C'1'                     F1                              93040020
         DC    C'2'                     F2                              93120020
         DC    C'3'                     F3                              93200020
         DC    C'4'                     F4                              93280020
         DC    C'5'                     F5                              93360020
         DC    C'6'                     F6                              93440020
         DC    C'7'                     F7                              93520020
         DC    C'8'                     F8                              93600020
         DC    C'9'                     F9                              93680020
         DC    C'.'                     FA                              93760020
         DC    C'.'                     FB                              93840020
         DC    C'.'                     FC                              93920020
         DC    C'.'                     FD                              94000020
         DC    C'.'                     FE                              94080020
         DC    C'.'                     FF                              94160020
         ORG   *-239                   RESET LOCATION COUNTER    S21903 94240022
TRTABLE  DS    239C                    TRANSLATE                 S21903 94300022
         DC    C' 0123456789ABCDEF'      TABLE                   S21903 94360022
         SPACE 1                                                        94370022
*        MISCELLANEOUS CONSTANTS.                                       94380022
         SPACE 1                                                        94390022
FLAG     DC    X'00'                   FLAG BYTE                 S21903 94420022
L255     DC    H'255'                  CONSTANT VALUE            S21903 94540022
KEYL     DC    H'0'                     LENGTH OF KEYWORD               94640020
L75      DC    H'75'                    MAX CPRCDS                      94720020
K64      DC    F'65535'                DECIMAL EQUIVALENT OF 64K S21903 94800022
ECB      DC    F'0'                     ECB FOR WTOR'S WAIT      S21101 94840021
REPLY    DC    XL55'00'                 RESPONSE AREA          @Y17XANG 94860000
H100     DC    H'100'                   MAX VALUE OF 'MSMAX'            94960020
H30      DC    H'30'                   CONSTANT VALUE            S21903 95040022
MAXCPVL  DC    F'43199'                 MAXIMUM CPINTVL         SA63008 95080005
ERASE    DC    C'0 '                    SPECIFIED TO ERASE 8 CHARS      95120020
L56      DC    H'56'                    DEFAULT FOR OLTEST     @Y17XANU 95160000
TRACEMIN DC    H'20'                    MIN TRACE VALUE        @G36XRNP 95165010
MAXAIB   DC    H'32695'                 MAX AIB SIZE           @G36XRNP 95170010
H4024    DC    H'4024'                  4024 BYTE AIB SIZE     @G36XRNP 95175010
H1976    DC    H'1976'                  1976 BYTE AIB SIZE     @G36XRNP 95180010
H952     DC    H'952'                   952 BYTE AIB SIZE      @G36XRNP 95185010
H440     DC    H'440'                   440 BYTE AIB SIZE      @G36XRNP 95190010
H184     DC    H'184'                   184 BYTE AIB SIZE      @G36XRNP 95195010
DLQDEF   DC    2F'0'                    DEAD LETTER Q DEFAULT VALUE     95200020
PASWDDEF DC    CL8' '                   PASSWORD DEFAULT                95280020
CTLCHDEF DC    8X'FF'                   CONTROL DEFAULT                 95360020
DOUBXDEF EQU   DLQDEF                   PRIMARY DEFAULT                 95440020
YESCOM   DC    C'YES,'                  COMWRTE OPERAND COMPARAND       95600020
YES0     DC    C'YES',X'00'             COMWRTE OPERAND COMPARAND       95680020
NOCOM    DC    C'NO,'                   COMWRTE OPERAND COMPARAND       95760020
NO0      DC    C'NO',X'00'              COMWRTE OPERAND COMPARAND       95840020
P        DC    PL1'0'                  PACKED DECIMAL VALUE FOR  S21903 95920022
*                                        ZERO                    S21903 95920522
OPTABLE  EQU   *                                                 S21101 95921021
         DC    C'B='                    LNUNITS   00             S22024 95922022
         DC    C'C='                    CIB       02             S22024 95922922
DISKC    DC    C'D='                    CPB       04             S22024 95923822
         DC    C'I='                    INTVAL    06             S22024 95924722
         DC    C'K='                    KEYLEN    08             S22024 95925622
         DC    C'L='                    CONTROL   10             S22024 95926522
COREM    DC    C'M='                    MSUNITS   12             S22024 95927422
         DC    C'N='                    RESTART   14             S22024 95928322
         DC    C'P='                    PRIMARY   16             S22024 95929222
         DC    C'R='                    CKREQS    18             S22024 95930122
         DC    C'S='                    STARTUP   20             S22024 95931022
         DC    C'T='                    TRACE     22             S22024 95931922
         DC    C'A='                    DTRACE    24             S22024 95932822
         DC    C'V='                    CPINTVL   26             S22024 95933722
         DC    C'W='                    PASSWRD   28             S22024 95934622
         DC    C'Q='                    DLQ       30             S22024 95935522
         DC    C'E='                    CPRCDS    32             S22024 95936422
         DC    C'F='                    CROSSRF   34             S22024 95937322
         DC    C'G='                    COMWRTE   36             S22024 95938222
         DC    C'H='                    TOPMSG    38             S22024 95939122
         DC    C'O='                    OLTEST    40             S22024 95940022
COREX    DC    C'X='                    MSMAX     42             S22024 95940922
COREY    DC    C'Y='                    MSMIN     44             S22024 95941822
         DC    C'Z='                    VIRTUAL   46             Y05331 95942705
         DC    X'0000'                  END OF TXT48                    95943505
         DC    C'U',X'00'               EOF       50                    95944305
*                                       PLCBNO    52             X03039 95945107
*                                       TTRACE    54                    95946007
*                                       BTRACE    54           @Y17XANG 95946100
*                                       BRACKET   56           @Y17XANG 95946200
*                                       MAXSUBA   58           @Y17XANG 95946300
*                                       OPMASK    60           @Y17XANG 95946400
*                                       SUBAREA   62           @Y17XANG 95946500
*                                       SIBCNT    64           @Y17XANG 95946600
*                                       APWAS     66           @G36XRNP 95946710
*                                       AUTHA     68           @G36XRNP 95946810
ENDTAB   EQU   *                                                 S21101 95947021
*                                                                S21101 95948021
OPTABLE2 EQU   *                                                 S22024 95949022
*                                                                S22024 95949522
*   TABLE ENTRY FORMAT -                                         S22024 95950022
*      BYTE 1:  KEYWORD LENGTH - 1                               S22024 95950522
*      BYTE 2:  (INDEX INTO BRANCH TABLE) / 2                    S22024 95951022
*      BYTE 3:  KEYWORD IN EBCDIC (VARIABLE LENGTH)              S22024 95951522
*                                                                S22024 95952022
*   TWO CHARACTER ABREVIATIONS                                   S22024 95952522
         DC    AL1(2),AL1(46)                                  @ZA07074 95952681
XVM      DC    CL3'VM='                                        @ZA07074 95952881
         DC    AL1(2),AL1(52),CL3'PL=' .PLCBNO                   X03039 95953007
         DC    AL1(2),AL1(54),CL3'TT='  TTRACE                   X03039 95953507
XBT      DC    AL1(2),AL1(54),CL3'BT='  BTRACE                 @Y17XANG 95953600
         DC    AL1(2),AL1(56),CL3'BR='  BRACKET                @Y17XANG 95953700
XMA      DC    AL1(2),AL1(58),CL3'MA='  MAXSUBA                @Y17XANG 95953800
XOP      DC    AL1(2),AL1(60),CL3'OP='  OPMASK                 @Y17XANG 95954000
XSA      DC    AL1(2),AL1(62),CL3'SA='  SUBAREA                @Y17XANG 95954100
XSB      DC    AL1(2),AL1(64),CL3'SB='  SIBCOUNT               @Y17XANG 95954200
XWA      DC    AL1(2),AL1(66),CL3'WA='  APWAS                  @G36XRNP 95954310
XAU      DC    AL1(2),AL1(68),CL3'AU='  AUTHA                  @G36XRNP 95954410
*   FULL LENGTH KEYWORDS                                       @Y17XANG 95954510
         DC    AL1(7),AL1(00)           LNUNITS                  S22024 95954610
XLNUNITS DC    CL8'LNUNITS='            LNUNITS                  S22024 95955022
         DC    AL1(3),AL1(02),CL4'CIB=' CIB                      S22024 95955522
         DC    AL1(3),AL1(04)           CPB                      S22024 95956022
XCPB     DC    CL4'CPB='                CPB                      S22024 95956522
         DC    AL1(6),AL1(06),CL7'INTVAL=' INTVAL                S22024 95957022
         DC    AL1(6),AL1(08),CL7'UNITSZ=' UNITSZ                S22024 95957522
         DC    AL1(6),AL1(08)           KEYLEN                   S22024 95958022
XKEYLEN  DC    CL7'KEYLEN='             KEYLEN                   S22024 95958522
         DC    AL1(7),AL1(10),CL8'CONTROL=' CONTROL              S22024 95959022
         DC    AL1(7),AL1(12)           MSUNITS                  S22024 95959522
XMSUNITS DC    CL8'MSUNITS='            MSUNITS                  S22024 95960022
         DC    AL1(7),AL1(14),CL8'RESTART=' RESTART              S22024 95960522
         DC    AL1(7),AL1(16),CL8'PRIMARY=' PRIMARY              S22024 95961022
         DC    AL1(6),AL1(18),CL7'CKREQS=' CKREQS                S22024 95961522
         DC    AL1(7),AL1(20)           STARTUP                  S22024 95962022
XSTARTUP DC    CL8'STARTUP='            STARTUP                  S22024 95962522
         DC    AL1(5),AL1(22),CL6'TRACE=' TRACE                  S22024 95963022
         DC    AL1(6),AL1(24),CL7'DTRACE=' DTRACE                S22024 95963522
         DC    AL1(7),AL1(26),CL8'CPINTVL=' CPINTVL              S22024 95964022
         DC    AL1(7),AL1(28),CL8'PASSWRD=' PASSWRD              S22024 95964522
         DC    AL1(3),AL1(30),CL4'DLQ=' DLQ                      S22024 95965022
         DC    AL1(6),AL1(32),CL7'CPRCDS=' CPRCDS                S22024 95965522
         DC    AL1(7),AL1(34),CL8'CROSSRF=' CROSSRF              S22024 95966022
         DC    AL1(7),AL1(36),CL8'COMWRTE=' COMWRTE              S22024 95966522
         DC    AL1(6),AL1(38),CL7'TOPMSG=' TOPMSG                S22024 95967022
         DC    AL1(6),AL1(40),CL7'OLTEST=' OLTEST                S22024 95967522
         DC    AL1(5),AL1(42)           MSMAX                    S22024 95968022
XMSMAX   DC    CL6'MSMAX='              MSMAX                    S22024 95968522
         DC    AL1(5),AL1(44)           MSMIN                    S22024 95969022
XMSMIN   DC    CL6'MSMIN='              MSMIN                    S22024 95969522
*                         46            VIRTUAL                @Y17XANG 95969700
*                         48            END OF TEXT                     95970005
*                         50            EOF                             95970105
         DC    AL1(6),AL1(52),CL7'PLCBNO=' PLCBNO                X03039 95970207
         DC    AL1(6),AL1(54),CL7'TTRACE='  TTRACE               X03039 95971107
XBTRACE  DC    AL1(6),AL1(54),CL7'BTRACE='  BTRACE             @Y17XANG 95971300
         DC    AL1(7),AL1(56),CL8'BRACKET='  BRACKET           @X50X9NI 95971509
XMAXSUBA DC    AL1(7),AL1(58),CL8'MAXSUBA='  MAXSUBA           @Y17XANG 95971700
XOPMASK  DC    AL1(6),AL1(60),CL7'OPMASK='   OPMASK            @Y17XANG 95971900
         DC    AL1(7),AL1(62)                                  @Y17XANG 95972100
XSUBAREA DC    CL8'SUBAREA='                 SUBAREA           @Y17XANG 95972300
XSIBCOUN DC    AL1(6),AL1(64),CL7'SIBCNT='   SIBCOUNT          @Y17XANG 95972500
XAPWAS   DC    AL1(5),AL1(66),CL6'APWAS='    APWAS             @G36XRNP 95972610
XAUTHA   DC    AL1(5),AL1(68),CL6'AUTHA='    AUTHA             @G36XRNP 95972710
         DC    XL1'FF'                  END OF TABLE INDICATOR @Y17XANG 95972810
*                                                                S21101 95973021
CLRNUM   DC    X'F0F0F0F0'              MASK TO TEST OPMASK    @Y17XANG 96073000
*                                       VALIDITY               @Y17XANG 96173000
TRANMSK  DC    XL193'00',X'FAFBFCFDFEFF',XL41'00' TRANS TABLE  @Y17XANG 96273000
         DC    X'F0F1F2F3F4F5F6F7F8F9',XL6'00'    TRANS TABLE  @Y17XANG 96373000
         EJECT                                                 @Y17XANG 96473000
         TAVTD 4                                                        96880020
CVTD     DSECT                                                          97040020
         CVT                                                            97120020
         TTCBD                                                          97200020
         TMSKD                                                 @Y17XANG 97240000
         END                                                            97280020
