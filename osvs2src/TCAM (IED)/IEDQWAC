         TITLE 'IEDQWV  GRAB - $LETGO SERVICE MODULE'                   00100000
IEDQWV   CSECT                                                          00200000
*A000000-999999                                                @Y16X5U0 00300000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00400000
*A216000                                                         A41584 00500000
*A276000                                                         A41584 00600000
*C444000                                                         A41584 00700000
* A004400,A010000-016000,A136000,A228540-228560,C232000,C244000  S22024 00800000
* A395000-398700,C672400,A676410-676430,C836000                  S22024 00900000
*C675800                                                       @XA06343 01000000
*A228780,228800,269120,396500,397300,652000,696000,696370      @Y17XAUU 01100000
*A752000,755700,821700,836000                                  @Y17XAUU 01200000
*C269720,395100,397200,398600,676410,752100-752200,752315      @Y17XAUU 01300000
*C752321,752333,752350                                         @Y17XAUU 01400000
* A014000,138000,198000,199000,445000,623000,624000,631000,    @G36XRUV 01410010
* A644000,673000                                               @G36XRUV 01420010
* C199000,200000,446000,632000,645000                          @G36XRUV 01430010
* D622000                                                      @G36XRUV 01440010
*   TOTE ALIAS                                                 @OY13283 01445010
*                                                                       01450010
*********************************************************************** 01500000
*                                                                     * 01600000
* DESCRIPTIVE NAME:  GRAB AND $LETGO SERVICE MODULE              S22024 01700000
*                                                                S22024 01800000
* MODULE NAME: IEDQWV (TCAM,TOTE)                              @Y17XAUU 01900000
*                                                                S22024 02000000
* STATUS: VERSION 10.0                                         @Y17XAUU 02100000
*                                                                     * 02200000
* FUNCTIONS:                                                          * 02300000
*                                                                     * 02400000
*       GRAB -                                                        * 02500000
*       THE PURPOSE OF THIS ROUTINE IS TO ASSIGN A SECONDARY          * 02600000
*       DEVICE TO THE UNIT TEST.                                      * 02700000
*                                                                     * 02800000
*       THE GRAB MACRO REQUESTS THAT A SECONDARY DEVICE MEETING       * 02900000
*       SPECIFIED REQUIREMENTS BE ASSIGNED TO THE UNIT TEST.          * 03000000
*                                                              @Y17XAUU 03010000
*       IF THE GRAB REQUEST IS FOR A SNA LU COUNTERFEIT        @Y17XAUU 03020000
*       CONTROL BLOCKS MUST BE SET UP FOR THE TEST DEVICE.     @Y17XAUU 03030000
*       IEDQWB2 IS CALLED TO PROCESS THE COUNTERFEITING OF     @Y17XAUU 03040000
*       TTE, QCB, AND LGB.                                     @Y17XAUU 03050000
*                                                                     * 03100000
*       THE DEVICE ENTRY LIST BUILT FROM THE TEST REQUEST MESSAGE     * 03200000
*       IS SEARCHED TO FIND A DEVICE MEETING THE SPECIFIED REQUIRE-   * 03300000
*       MENTS.  IF A PROPER DEVICE IS FOUND, IT IS ASSIGNED AS        * 03400000
*       A TEST DEVICE TO THE UNIT TEST.                               * 03500000
*                                                                     * 03600000
*       AT THE COMPLETION OF THIS ROUTINE, ONE OF THE FOLLOWING       * 03700000
*       RETURN CODES IS PLACED IN REGISTER 15:                        * 03800000
*                                                                     * 03900000
*       X'00' - NORMAL COMPLETION OF THE GRAB FUNCTION.               * 04000000
*       X'04' - UNSUPPORTED MACRO                              @Y17XAUU 04100000
*       X'08' - NO (MORE) DEVICES IN THE ENTRY LIST MEET              * 04200000
*       THE SPECIFIED REQUIREMENTS.                                   * 04300000
*                                                                     * 04400000
*       X'0C' - DEVICE ENTRY LIST CONTAINS ONLY ONE DEVICE.           * 04500000
*                                                                     * 04600000
*       $LETGO -                                                      * 04700000
*       THE PURPOSE OF THIS ROUTINE IS TO REMOVE A PREVIOUSLY         * 04800000
*       GRABED DEVICE FROM THE DEVICE TABLE                           * 04900000
*                                                                     * 05000000
* ENTRY POINT:                                                        * 05100000
*                                                                     * 05200000
*       IEDQWV - CALLED WHEN A GRAB OR $LETGO MACRO IS ISSUED         * 05300000
*       BY THE UNIT TEST                                              * 05400000
*                                                                     * 05500000
* LINKAGE: BALR R14,R15 FROM IEDQWA                            @Y17XAUU 05600000
*                                                              @Y17XAUU 05700000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 05800000
*                                                              @Y17XAUU 05900000
* MODULE SIZE: 2K MAXIMUM                                      @Y17XAUU 06000000
*                                                              @Y17XAUU 06100000
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 06200000
*                                                              @Y17XAUU 06300000
* MACROS:AQCTL,SAVE,CLOSE,DELETE,LOAD,DEQ,ENQ,IEDHJN,OPEN      @Y17XAUU 06400000
*                                                              @Y17XAUU 06500000
* INPUT:        REGISTERS 01,02,13,14,15 CONTAIN THE FOLLOWING VALUES:* 06600000
*                                                                     * 06700000
*                         01-GRAB PARAMETER LIST ADDRESS              * 06800000
*                         02-OLTCB POINTER                            * 06900000
*                         13-SAVE AREA ADDRESS                        * 07000000
*                         14-RETURN ADDRESS                           * 07100000
*                         15-ENTRY POINT ADDRESS                      * 07200000
*                                                                     * 07300000
*                                                                     * 07400000
* OUTPUT:       REGISTERS 15 CONTAIN THE FOLLOWING VALUES:            * 07500000
*                                                                     * 07600000
*                         15-RETURN CODE:- GRAB                       * 07700000
*                            X'00' - NORMAL COMPLETION                * 07800000
*                            X'04' - UNSUPPORTED MACRO         @Y17XAUU 07900000
*                            X'08' - NO (MORE)DEVICES IN THE ENTRY    * 08000000
*                                    LIST MEET THE SPECIFIED          * 08100000
*                                    REQUIREMENTS                     * 08200000
*                            X'0C' - DEVICE ENTRY LIST CONTAINS ONLY  * 08300000
*                                    ONE DEVICE                       * 08400000
*                                                                     * 08500000
*                         15-RETURN CODE:- $LETGO                     * 08600000
*                            X'00' NORMAL COMPLETION                  * 08700000
*                            X'04' - UNSUPPORTED MACRO         @Y17XAUU 08800000
*                            X'0C' DEVICE NOT PREVIOUSLY GRABED       * 08900000
* EXTERNAL ROUTINE: IEDQTNT - FIND TTE                         @Y17XAUU 09000000
*                    IEDQA1 - FIND TTCIN                       @Y17XAUU 09100000
*                    IEDIAP04 - FIND NETWORK ADDRESS           @Y17XAUU 09200000
*                    IEDQWB2 - COUNTERFEIT SNA LU TEST DEVICE  @Y17XAUU 09250000
*                                                                     * 09300000
* EXIT POINTS:    BR AFTER 'GRB070'   TO IEDQWA                       * 09400000
*                                                                     * 09500000
* TABLES/WORK AREAS:  OLTCB                                           * 09600000
*                                                                     * 09700000
* ATTRIBUTES:                                                         * 09800000
*                                                                     * 09900000
*       ENABLED, PROBLEM PROGRAM MODE, RESIDENT, REENTRANT     @Y17XAUU 10000000
*                                                                     * 10100000
* COPYRIGHT='NONE'                                               S22024 10200000
*                                                              @Y17XAUU 10300000
* NOTE: SEE BELOW                                              @Y17XAUU 10400000
*                                                              @Y17XAUU 10500000
*  DEPENDENCIES: EBCDIC CHARACTER CODE SET                     @Y17XAUU 10600000
*                                                              @Y17XAUU 10700000
*  RESTRICTIONS: NONE                                          @Y17XAUU 10800000
*                                                              @Y17XAUU 10900000
*  REGISTER CONVENTIONS: SEE REGISTERS ASSIGNMENT              @Y17XAUU 11000000
*                                                              @Y17XAUU 11100000
*  PATCH LABEL: PATCH                                          @Y17XAUU 11200000
*                                                                     * 11300000
*********************************************************************** 11400000
*                                                                       11500000
*        EQUATES                                                        11600000
*                                                                       11700000
R0       EQU   0                       REG 0                     S99528 11800000
R1       EQU   1                       REG 1                     S99528 11900000
R2       EQU   2                       REG 2                     S99528 12000000
R3       EQU   3                       REG 3                     S99528 12100000
R4       EQU   4                       REG 4                     S99528 12200000
R5       EQU   5                       REG 5                     S99528 12300000
R6       EQU   6                       REG 6                     S99528 12400000
R7       EQU   7                       REG 7                     S99528 12500000
R8       EQU   8                       REG 8                     S99528 12600000
R9       EQU   9                       REG 9                     S99528 12700000
R10      EQU   10                      REG 10                    S99528 12800000
R11      EQU   11                      REG 11                    S99528 12900000
R12      EQU   12                      REG 12                    S99528 13000000
R13      EQU   13                      REG 13                    S99528 13100000
R14      EQU   14                      REG 14                    S99528 13200000
R15      EQU   15                      REG 15                    S99528 13300000
PURGE    EQU   X'10'              SVC EQUATE FOR PURGE           A41584 13400000
PARMREG0 EQU   R0                      MSG PARM                  S99528 13500000
PARMREG1 EQU   R1                      MSG PARM                  S99528 13600000
ZERO     EQU   0                       ZERO DISPLACEMENT         S99528 13700000
THREE    EQU   3                       THREE                     S99528 13800000
HALF     EQU   3                       HALF WORD               @G36XRUV 13850010
FOUR     EQU   4                       FOUR                      S99528 13900000
FIVE     EQU   5                       FIVE                      S99528 14000000
EIGHT    EQU   8                       EIGHT                     S99528 14100000
D0       EQU   0                  DISPLACEMENT OF 0            @Y17XAUU 14150000
D2       EQU   2                       TWO                       S22024 14200000
D3       EQU   3                  DISPLACEMENT OF 3            @Y17XAUU 14250000
TEN      EQU   10                      TEN                       S99528 14300000
D4       EQU   4                       FOUR                      S22024 14400000
D32      EQU   32                      THIRTY TWO                S22024 14500000
D34      EQU   34                      DISPLACEMENT 34           S99528 14600000
SYMCLASS EQU   X'44'                   CLASS SUPORTED            S22024 14700000
SAMSAMSA EQU   X'55'                   SAME CHANNEL SAME CONTROL S22024 14800000
*                                      UNIT SAME DEVICE          S22024 14900000
NXTDEV   EQU   X'01'                   NEXT DEV IN LIST          S22024 15000000
ADRMSK   EQU   7                       ADDRESS MASK            @Y17XAUU 15100000
RETDAF   EQU   X'10'              DAF RETURNED RET CODE        @Y17XAUU 15150000
DISREG2  EQU   28                 DISPLACEMENT TO REG 2        @Y17XAUU 15200000
ERRCD08  EQU   8                  ERROR RETURN CODE            @Y17XAUU 15250000
ERRCD12  EQU   12                 ERROR RETURN CODE            @Y17XAUU 15300000
D1       EQU   1                  DISPLACEMENT OF 1            @Y17XAUU 15400000
D5       EQU   5                       DISPLACEMENT OF 5       @Y17XAUU 15500000
D8       EQU   8                  DISPLACEMENT OF 8            @Y17XAUU 15600000
X25      EQU   X'25'                   DISPLACEMENT OF X'25'   @Y17XAUU 15700000
XFF      EQU   X'FF'              MASK FIELD                   @Y17XAUU 15750000
ADRMSK7  EQU   7                  ADDRESS MASK                 @Y17XAUU 15770000
         EJECT                                                          15800000
IEDQWAC  EQU   *                                                 S99528 15900000
IEDQW21  EQU   *                                               @Y17XAUU 16000000
         ENTRY IEDQW21,IEDQWAC                                   S99528 16100000
         USING IEDQWV,R15              ADDRESSIBILITY            S99528 16200000
IEDQWV   IEDHJN IEDQWVV,HJN            NAME AND HJN              S99528 16300000
         DROP  R15                                               S99528 16400000
         USING IEDQWV,R4                                                16500000
         USING TOTOLTCB,R2             TOTE CONTROL BLOCK        S22024 16600000
         SAVE  (14,12)                 SAVE REGS                 S99528 16700000
         LR    R4,R15             SET BASE REG.                         16800000
         LA    R15,TOTSAVE1            ADDRESS OF OWN SAVE AREA  S22024 16900000
         ST    R15,8(R13)         PUT ADDR. IN CALLER'S SAVE.           17000000
         ST    R13,4(R15)         SAVE ADDR. OF CALLER'S SAVE AREA.     17100000
         LR    R13,R15            SET R13 TO POINT TO OWN SAVE AREA.    17200000
         SPACE                                                          17300000
         CLI   1(R1),X'02'        CORRECT MACRO LEVEL.                  17400000
         BE    GRB000             YES.                                  17500000
*                                                                       17600000
         LA    R15,FOUR                INCORRECT LEVEL MACRO     S99528 17700000
         B     GRB070                  EXIT                      S99528 17800000
         SPACE                                                          17900000
GRB000   EQU   *                                                 S99528 18000000
         MVC   TOTSERV(END-START),START SET UP WORK AREA       @Y17XAUU 18100000
         MVC   BLDLLIST(BLDLEND-BLDLLIST),QLDLLIST COPY        @Y17XAUU 18130000
*                                      BLDL PLIST              @Y17XAUU 18160000
         LA    R15,JFCBAA              GET JFCB ADDRESS        @Y17XAUU 18200000
         STCM  R15,ADRMSK,JFCBADDR+D1  SAVE IN EXIT PLIST      @Y17XAUU 18300000
         LA    R15,ADDOFUCB            USC ADDRESS             @Y17XAUU 18400000
         STCM  R15,ADRMSK,TOT102+D1    SAVE IN PLIST           @Y17XAUU 18500000
         LA    R15,TOT102LN            GET ADDRESS OF LEN FIELD@Y17XAUU 18600000
         STCM  R15,ADRMSK,TOT102A+D5   ADDRESS OF LENGTH FIELD @Y17XAUU 18700000
         LA    R15,JFCBADDR            GET ADDRESS OF JFCB     @Y17XAUU 18800000
         STCM  R15,ADRMSK,EXCPDCB+X25  PUT IT IN DCB EXLST     @Y17XAUU 18900000
         LA    R15,QNAME               GET QNAME ADDRESS       @Y17XAUU 19000000
         ST    R15,DEQLIST+D4          PUT IN DEQ PLIST        @Y17XAUU 19100000
         LA    R15,RNAME               GET RNAME ADDRESS       @Y17XAUU 19200000
         ST    R15,DEQLIST+D8          PUT IN DEQ PLIST        @Y17XAUU 19300000
         MVC   CDSLINE,NAMEFLD         INIT NAME FIELD         @Y17XAUU 19400000
         EJECT                                                          19450000
         ST    R1,GRABPARM             SAVE PARM POINTER         S99528 19500000
         CLC   2(2,R1),GRABREQ         GRAB REQUEST?           @Y17XAUU 19600000
         BNE   LET002                  NO ASSUME ENTRY FOR LETGO S99528 19700000
         LA    R11,8(R1)               GET FLAG BYTE             S99528 19800000
         SR    R10,R10                 CLEAR                   @G36XRUV 19850010
         ICM   R10,HALF,TOTPRUCB       GET PRIMARY UCB ADDR    @G36XRUV 19900010
         SR    R9,R9                   CLEAR                   @G36XRUV 19950010
         ICM   R9,HALF,TOTSCUCB        GET SECONDARY UCB ADDR  @G36XRUV 20000010
         LA    R9,0(R9)                CLEAR HIGH ORDER BYTE     S99528 20100000
         LTR   R9,R9                   IS PURGE REQUIRED         S99528 20200000
         BZ    GRB0005                 NO BYPASS PURGE           S99528 20300000
         LA    R1,TOTSCDCB             SECENDARY DEC             S99528 20400000
         ST    R1,OPENAREA             STORE IN P LIST           S99528 20500000
         MVI   OPENAREA,X'B0'          OPTION CLOSE              S99528 20600000
         LA    R1,OPENAREA             ADDRESS OF P LIST         S99528 20700000
         CLOSE MF=(E,(1))              CLOSE SECONDARY DCB       S99528 20800000
GRB0005  EQU   *                                                 A41584 20900000
         LA    R1,TOTTDTBL             FIRST ENTRY POINTER       S99528 21000000
         L     R1,4(R1)                GET SECOND ENTRY          S99528 21100000
         LTR   R1,R1                   AT LEAST TWO ENTRIES      S99528 21200000
         BP    GRB001                  YES BRANCH                S99528 21300000
         LA    R15,ERRCD12             SET RETURN CODE         @Y17XAUU 21400000
          B     GRB070                 GET OUT                   S99528 21500000
GRB001   L     R8,TOTGRABP             GET GRAB POINTER          S99528 21600000
GRB002   LA    R8,4(R8)                BUMP GRAB POINTER TO NEXT S99528 21700000
         L     R9,0(R8)                GET TNT ADDRESS           S99528 21800000
         ST    R9,TOTSRTNT             SAVE IT                   S99528 21900000
         LA    R5,TOTTDEND             GET ADDRESS OF END OF TABLS99528 22000000
         CR    R5,R8                   GRAB POINTER PAST END OF  S99528 22100000
         BE    EIGRET                  YES BRANCH                S22024 22200000
         L     R7,0(R8)                GET UCB ADDRESS           S99528 22300000
         LA    R7,0(R7)                CLEAR HI BYTE             S99528 22400000
         LTR   R7,R7                   IS THIS A UCB ADDRESS?    S99528 22500000
         BZ    EIGRET                  NO BRANCH                 S22024 22600000
         ST    R8,TOTGRABP             SAVE GRAB POINTER TO NXT  S22024 22700000
         OI    0(R8),TOTTDGRB          TURN ON GRAB FLAG         S22024 22800000
         CR    R7,R10                  IS GRABED DEVICE PRIMARY  S99528 22900000
         BNE   GRB008                  NO BRANCH                 S99528 23000000
EIGRET   EQU   *                                                 S22024 23100000
         LA    R15,8                   DEVICE NOT FOUND CODE     S99528 23200000
         B     GRB070                  RETURN                    S99528 23300000
MOVECDS  MVC   CDSLINE,0(R7)           MOVE NAME FOR LOAD        S22024 23400000
         EJECT                                                          23450000
QCBFIND  EQU   *                       FIND SECONDARY QCB,RESOU@Y17XAUU 23500000
*                                      CE ID,AND THE LCB         S22024 23600000
         LR    R9,R7                   GET TNT ADDRESS           S22024 23700000
         ST    R9,TRMTNT               SAVE TNT ADDRESS        @Y17XAUU 23750000
         SR    R3,R3                   CLEAR REG                 S22024 23800000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 23900000
         AR    R9,R3                   ADDRESS PTR               S22024 24000000
         MVC   TNTENTRY+D1(D3),D0(R9)  ALLINE ADDRESS          @Y17XAUU 24050000
         BCTR  R3,0                    DECREMENT FOR EX          S22024 24200000
         EX    R3,MOVECDS              MOVE NAME TO CDS          S22024 24300000
         L     R9,TNTENTRY             TTE ADDRESS             @Y17XAUU 24350000
         USING IEDQTRM,R9              TTE                       S22024 24500000
         L     R6,TOTAVTPT             GET AVT ADDRESS         @Y17XAUU 24600000
         USING IEDQAVTD,R6             SET AVT ADDRESSABILITY  @Y17XAUU 24700000
         L     R15,AVTRNMPT            TERM NAME TABLE ADDR    @Y17XAUU 24730000
         ST    R15,TERNMTAB            SAVE IT                 @Y17XAUU 24760000
         L     R15,AVTMSGS-D1          VCON TABLE ADDRESS      @Y17XAUU 24800000
         L     R15,D8(R15)             ADDRESS OF A1 ROUTINE   @Y17XAUU 24900000
         LA    R0,1(R3)                GET NAME LENGTH         @Y17XAUU 25000000
         LA    R1,CDSLINE              GET ADDRESS OF NAME     @Y17XAUU 25100000
         BAL   R14,FOUR(R15)           FIND SEC TD TTCIN       @Y17XAUU 25200000
*                                                              @Y17XAUU 25300000
*        IEDQA1 RETURNS TEST DEVICE TTCIN IN REG 15            @Y17XAUU 25400000
*                                                              @Y17XAUU 25500000
         STH   R15,TOTSCOFF            SAVE SC TD TTCIN        @Y17XAUU 25600000
         LR    R1,R15                  SET UP TO FIND NETWORK  @Y17XAUU 25700000
*                                      ADDRESS                 @Y17XAUU 25800000
         L     R15,AVTSAVTP            GET SAVT ADDRESS        @Y17XAUU 25900000
         L     R15,SAVTTNTX-IEDNSVTD(R15) GET ADDRESS OF TTCIN @Y17XAUU 26000000
*                                      TO NETWORK ADDR CONV RTN@Y17XAUU 26100000
         BALR  R14,R15                 FIND NETWORK ADDRESS    @Y17XAUU 26200000
*                                                              @Y17XAUU 26300000
*        IEDIAP04 RETURNS NETWORK ADDRESS IN REG 15            @Y17XAUU 26400000
*                                                              @Y17XAUU 26500000
         STH   R15,TOTSRSID            SAVE NETWORK ADDRESS    @YM07278 26600000
         DROP  R6                                              @Y17XAUU 26700000
         EJECT                                                          26750000
         L     R9,TRMDESTQ-1           QCB ADDRESS               S22024 26800000
         ST    R9,TRMQCB               SAVE QCB ADDRESS        @Y17XAUU 26850000
         DROP  R9                      TTE                       S22024 26900000
         USING IEDQQCB,R9              QCB                       S22024 27000000
         L     R9,QCBLGBAD-1           LGB ADDRESS               S22024 27100000
         DROP  R9                      QCB                       S22024 27200000
         USING IEDNLGB,R9              LGB                       S22024 27300000
         MVC   NAMESAVE(D8),LGBNAME    SAVE GROUP NAME         @Y17XAUU 27400000
         DROP  R9                      LGB                       S22024 27500000
         L     R1,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 27550000
         BAL   R14,NCPTTE              GET NCP TTE ADDRESS     @Y17XAUU 27700000
*                                                              @Y17XAUU 27800000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 27900000
*                                                              @Y17XAUU 28000000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 28100000
         L     R1,TRMDESTQ-D1          GET QCB ADDRESS         @Y17XAUU 28200000
         DROP  R1                                              @Y17XAUU 28300000
         USING IEDQQCB,R1              SET QCB ADDRESSABILITY  @Y17XAUU 28400000
         L     R9,QCBDCBAD-D1          GET 3705 DCB ADDRESS    @Y17XAUU 28500000
         USING IHADCB,R9               DCB                       S22024 28600000
         L     R3,DCBIOBAD             IOB ADDRESS               S22024 28700000
         SR    R6,R6                   CLEAR REG                 S22024 28800000
         IC    R6,DCBEIOBX             LCB SIZE                  S22024 28900000
         AR    R3,R6                   LCB OFFSET FROM DCB       S22024 29000000
         LA    R6,D32                  ADD ADJUSTMENT TO START   S22024 29100000
*                                      OF LCB                    S22024 29200000
         DROP  R9                                              @Y17XAUU 29250000
         SR    R3,R6                   STARTING LCB ADDRESS      S22024 29300000
         STCM  R3,ADRMSK,TOTSCLCB      SAVE RN LCB             @Y17XAUU 29400000
         BAL   R9,DUMMYTNT             CHECK FOR COUNTERFEITING@Y17XAUU 29420000
         LTR   R15,R15                 GOOD RETURN             @Y17XAUU 29440000
         BNZ   MOVEIN1                 ERROR EXIT              @Y17XAUU 29460000
         L     R5,GRABPARM             GET PARM ADDRESS          S22024 29500000
         USING GRABMAP,R5              GRAB PARM                 S22024 29600000
         CLI   $GRABCLS,SYMCLASS       CLASS 44                  S22024 29700000
         BNE   EIGRET                  NO BRANCH                 S22024 29800000
         CLI   $GRABFLG,NXTDEV         REQ FOR NEXT DEV IN LIST  S22024 29900000
         BE    LOADNAME                YES BRANCH                S22024 30000000
         CLI   $GRABFLG,SAMSAMSA       REQ FOR CH,CU,DV          S22024 30100000
         BNE   EIGRET                  NO BRANCH                 S22024 30200000
         CLC   TOTSCLCB,TOTPRLCB       LCB FOR PRI AND SEC SAME  S22024 30300000
         BNE     GRB001                NO BRANCH                 S22024 30400000
         B     LOADNAME                GO LOAD CDS               S22024 30500000
         EJECT                                                          30550000
GRB008   EQU   *                                                 S22024 30600000
         TM    0(R8),TOTTDORN          TEST DEVICE ON RN         S22024 30700000
         BO    QCBFIND                 YES BRANCH              @Y17XAUU 30800000
         TM    0(R8),TOTTDTRM          TERMINAL TEST ON 0X       S22024 30900000
         BO    UCBFIND                 YES BRANCH                S99528 31000000
*        CHECK FOR VALID DEVICE                                         31100000
TNTRET   EQU   *                                                 S99528 31200000
         SPACE                                                          31300000
         TM    0(R11),CLOMIT           WAS CLASS OMITTED         S99528 31400000
         BO    GRB010             BRANCH IF YES.                        31500000
         SPACE                                                          31600000
         CLC   18(1,R7),1(R11)         DOES CLASS COMPARE        S99528 31700000
         BNE   GRB002             BRANCH IF NO - GET NEXT ENTRY.        31800000
         SPACE                                                          31900000
GRB010   TM    0(R11),TYOMIT      WAS TYPE OMITTED ?                    32000000
         BO    GRB015             BRANCH IF YES.                        32100000
         SPACE                                                          32200000
         MVC   CLASS(1),19(R7)         UCB TYPE                  S99528 32300000
         NI    CLASS,X'0F'             CLEAR HI NIBBLE           S99528 32400000
         CLC   CLASS,CLAS02            CLASS 2702                S99528 32500000
         BNE   CLASS1                  NO BR                     S99528 32600000
         MVI   CLASS,X'02'             CLASSS TO 2702            S99528 32700000
         B     COMPCLAS                GO COMPARE CLASS          S99528 32800000
CLASS1   CLC   CLASS,CLAS01            CLASS 2701                S99528 32900000
         BNE   CLA7770                 NO BR                     S99528 33000000
         MVI   CLASS,X'01'             CLASS TO 2701             S99528 33100000
         B     COMPCLAS                GO COMPARE CLASS          S99528 33200000
CLA7770  CLC   CLASS,CLASS77           CLASS 7770                S99528 33300000
         BNE   COMPCLAS                NO BR                     S99528 33400000
         MVI   CLASS,X'04'             CLASS TO 04               S99528 33500000
COMPCLAS CLC   CLASS,2(R11)            DOES TYPE COMPARE         S99528 33600000
         BNE   GRB002             BRANCH IF NO - GET NEXT ENTRY.        33700000
         SPACE                                                          33800000
GRB015   TM    0(R11),DCH+CH      IS ANY CHANNEL OK ?                   33900000
         BZ    GRB025             BRANCH IF YES.                        34000000
         SPACE                                                          34100000
         CLC   4(1,R7),4(R10)     SAME CHANNEL AS PRIMARY ?             34200000
         BE    GRB020             BRANCH IF YES.                        34300000
         SPACE                                                          34400000
         TM    0(R11),DCH         WAS DIFFERENT CHNL REQUESTED ?        34500000
         BO    GRB025             BRANCH IF YES.                        34600000
         B     GRB002             GET NEXT ENTRY.                       34700000
         EJECT                                                          34750000
         SPACE                                                          34800000
GRB020   TM    0(R11),CH          WAS SAME CHNL REQUESTED ?             34900000
         BZ    GRB002             BRANCH IF NO - GET NEXT ENTRY.        35000000
         SPACE                                                          35100000
GRB025   TM    0(R11),DCU+CU      IS ANY CONTROL UNIT OK ?              35200000
         BZ    GRB035             BRANCH IF YES.                        35300000
         SPACE                                                          35400000
         L     R5,0(R7)           GET UCB INFO.                         35500000
         N     R5,GRB080          CLEAR ALL BUT CNTL UNIT BITS.         35600000
         L     R6,0(R10)          GET PRIM DEV UCB INFO.                35700000
         N     R6,GRB080          CLEAR ALL BUT CNTL UNIT BITS.         35800000
         CR    R5,R6              IS IT SAME CNTL UNIT ?                35900000
         BE    GRB030             BRANCH IF YES.                        36000000
         SPACE                                                          36100000
         TM    0(R11),DCU         WAS DIFFERENT CNTL UNIT REQUESTED.    36200000
         BO    GRB035             BRANCH IF YES.                        36300000
         B     GRB002             GET NEXT ENTRY.                       36400000
         SPACE                                                          36500000
GRB030   TM    0(R11),CU          WAS SAME CNTL UNIT REQUESTED ?        36600000
         BZ    GRB002             BRANCH IF NO - GET NEXT ENTRY.        36700000
         SPACE                                                          36800000
GRB035   TM    0(R11),DDV+DV      IS ANY DEVICE OK ?                    36900000
         BZ    GRB045             BRANCH IF YES.                        37000000
         SPACE                                                          37100000
         L     R5,0(R7)           GET UCB INFO.                         37200000
         N     R5,GRB081          CLEAR ALL BUT DEVICE BITS.            37300000
         L     R6,0(R10)          GET PRIM DEV UCB INFO.                37400000
         N     R6,GRB081          CLEAR ALL BUT DEVICE BITS.            37500000
         CR    R5,R6              IS IT THE SAME DEVICE ?               37600000
         BE    GRB040             BRANCH IF YES.                        37700000
         SPACE                                                          37800000
         TM    0(R11),DDV         WAS DIFFERENT DEVICE REQUESTED ?      37900000
         BO    GRB045             BRANCH IF YES.                        38000000
         B     GRB002             GET NEXT ENTRY.                       38100000
         SPACE                                                          38200000
GRB040   TM    0(R11),DV          WAS SAME DEVICE REQUESTED ?           38300000
         BZ    GRB002             BRANCH IF NO - GET NEXT ENTRY.        38400000
         SPACE                                                          38500000
GRB045   L     R11,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 38600000
         USING IEDQAVTD,R11            AVT ADDRESSIBILITY        S99528 38700000
         L     R11,AVTTCB              GGT TCB  ADDRESS          S99528 38800000
         DROP  R11                                               S99528 38900000
         L     R11,8(R11)              GET FIRST DEB POINTER     S99528 39000000
         USING DEBNMSUB,R11            CLEAR R10                 S99528 39100000
         SR    R10,R10                 GET NUMBER OF EXTENTS     S99528 39200000
NXTDEBNT IC    R10,DEBNMEXT            FROM DEB                  S99528 39300000
         LR    R12,R10                 SAVE                      S99528 39400000
         L     R5,DEBUCBAD             GET UCB ADDRESS           S99528 39500000
UCBCOMP  LA    R5,ZERO(R5)             CLEAR HI BYTE             S99528 39600000
         CR    R5,R7                   SAME UCB                  S99528 39700000
         BE    RLNCOMPT                YES BRANCH                S99528 39800000
         BCTR  R10,0                   DECREMENT EXTENT NUMBER   S99528 39900000
         LTR   R10,R10                 ZERO YET?                 S99528 40000000
         BZ    NEXTDEB                 YES BRANCH                S99528 40100000
         L     R5,DEBUCBAD+4           GET NEXT UCB ADDRESS      S99528 40200000
         B     UCBCOMP                 BRANCH                    S99528 40300000
         EJECT                                                          40350000
NEXTDEB  L     R11,4(R11)              GET ADDRESS OF NEXT DEB   S99528 40400000
         LA    R11,ZERO(R11)           CLEAR HI BYTE             S99528 40500000
         LTR   R11,R11                 ADDRESS HERE              S99528 40600000
         BZ    NOTFOUND                NO BR                     S99528 40700000
         B     NXTDEBNT                BRANCH                    S99528 40800000
RLNCOMPT SR    R12,R10                 COMPUTE RLN               S99528 40900000
         STC   R12,TOTSCRLN            STORE RLN IN TOTSCENT     S99528 41000000
         STH   R5,TOTSCUCB             STORE UCB IN TOTSCENT     S99528 41100000
         STH   R5,ADDOFUCB             STORE UCB ADDRESS         S99528 41200000
         L     R10,DEBDCBAD            GET DCB ADDRESS           S99528 41300000
         USING IHADCB,R10                                        S99528 41400000
         L     R7,DCBIOBAD             GET DUMMY IOB ADDRESS     S99528 41500000
         DROP  R10                                               S99528 41600000
         LA    R6,32                   GET IOB DISPLACEMENT      S99528 41700000
         SR    R7,R6                   POINT TO DUMMY LCB        S99528 41800000
         MH    R12,LCBLENGT            FIND POINTER TO           S99528 41900000
         AR    R7,R12                  RIGHT LCB                 S99528 42000000
         TM    TOTTDTBL,TOTTDTRM       IS ENTRY TNT              S99528 42100000
         BO    NAMEBULD                YES BRANCH                S99528 42200000
         ST    R7,TOTSCQCB             SAVE LCB ADDRESS          S22024 42300000
         USING UCBOB,R5                                          S99528 42400000
         MVC   CDSLINE+FIVE(THREE),UCBNAME  NAME TO LOAD         S99528 42500000
         DROP  R5                                                S99528 42600000
         EJECT                                                          42650000
*        CDS FOR GRABED DEVICE                                          42700000
LOADNAME EQU   *                                                 S99528 42800000
         MVC   BLDLNAM(D8),CDSLINE COPY SYMBOLIC NAME          @Y17XAUU 42801000
         BLDL  0,BLDLLIST         FIND CDS                     @Y17XAUU 42802000
         LTR   R15,R15            RECORD FOUND                 @Y17XAUU 42803000
         BZ    GC040              YES - GO LOAD IT             @Y17XAUU 42804000
         TM    TOTFLG10,TOTTERMS  TERMINAL ENTRY               @Y17XAUU 42805000
         BZ    GCLINK             NO - LINE                    @Y17XAUU 42806000
         SLR   R9,R9              CLEAR REG                    @Y17XAUU 42807000
         SLR   R8,R8              CLEAR REG                    @Y17XAUU 42808000
         IC    R9,TOTTTBEL        NAME LENGTH                  @Y17XAUU 42809000
         ICM   R8,ADRMSK7,TOTTDTBL+D1 TNT ADDRESS              @Y17XAUU 42810000
         AR    R8,R9              ADDRESS OF TTE ADDRESS       @Y17XAUU 42811000
         ICM   R8,ADRMSK7,D0(R8)  TTE ADDRESS                  @Y17XAUU 42812000
         LA    R9,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 42813000
         SLR   R8,R9              TTE PREFIX ADDRESS           @Y17XAUU 42814000
         USING IEDNTRM,R8         TTE PREFIX BASE              @Y17XAUU 42815000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 42816000
         BNE   CDSPRES            NO                           @Y17XAUU 42817000
         LH    R9,TRMCHCIN        DCT INDEX                    @Y17XAUU 42818000
         BCTR  R9,R0              ADJUST INDEX                 @Y17XAUU 42819000
         L     R6,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 42820000
         USING IEDQAVTD,R6        SET AVT ADDRESSABILITY       @Y17XAUU 42821000
         MH    R9,AVTDCTLN        OFFSET TO DCT ENTRY          @Y17XAUU 42822000
         A     R9,AVTCSTCS        DCT ENTRY ADDRESS            @Y17XAUU 42823000
         DROP  R6                                              @Y17XAUU 42824000
         USING IEDDCT,R9          SET DCT ADDRESSABILITY       @Y17XAUU 42825000
         TM    DCTBYTE1,DCT3270   SNA 3270 LU                  @Y17XAUU 42826000
         BO    CDSPRES            YES                          @Y17XAUU 42827000
         DROP  R9                                              @Y17XAUU 42828000
*        BUILD CDS RECORD FOR 3767 OR 3770                     @Y17XAUU 42829000
         L     R1,GRABPARM        GET GRAB PARAMETER           @Y17XAUU 42830000
         USING GRABMAP,R1         SET ADDRESSABILITY           @Y17XAUU 42831000
         SLR   R3,R3              CLEAR REG                    @Y17XAUU 42832000
         IC    R3,$GRABCNT        GET BUFFER SIZE              @Y17XAUU 42833000
         L     R5,$GRABCDS        GET BUFFER ADDRESS           @Y17XAUU 42834000
         LA    R15,0              SET GOOD RETURN CODE         @Y17XAUU 42835000
         BCTR  R3,0               ADJUST BYTES COUNT           @Y17XAUU 42836000
         EX    R3,SNACDS          MOVE CDS TO BUFFER           @Y17XAUU 42837000
         DROP  R1                                              @Y17XAUU 42838000
         USING IEDTCDSD,R5        SET CDS ADDRESSABILTITY      @Y17XAUU 42839000
         MVC   TCDSNAM(D8),CDSLINE  SET SYMBOLIC NAME          @Y17XAUU 42840000
         SLR   R1,R1              CLEAR REG                    @Y17XAUU 42841000
         ICM   R1,3,TOTSCUCB      GET UCB ADDRESS              @Y17XAUU 42842000
         USING UCB,R1             SET UCB ADDRESSABILITY       @Y17XAUU 42843000
         MVC   TCDSUCB+D2(D2),UCBCHA  SET UCB BINARY CUU ADDR  @Y17XAUU 42844000
         DROP  R1                                              @Y17XAUU 42845000
         B     NODELETE           EXIT                         @Y17XAUU 42846000
         SPACE                                                          42847000
GCLINK   DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 42848000
*        CONSTRUCT 3705 LINE CDS                               @Y17XAUU 42849000
         L     R1,GRABPARM        POINT TO GRAB PLIST          @Y17XAUU 42850000
         USING GRABMAP,R1                                      @Y17XAUU 42851000
         L     R5,$GRABCDS        BUFFER ADDRESS               @Y17XAUU 42852000
         SLR   R3,R3              CLEAR REG                    @Y17XAUU 42853000
         IC    R3,$GRABCNT        GET BUFFER SIZE              @Y17XAUU 42854000
         LA    R15,0              SET GOOD RETURN CODE         @Y17XAUU 42855000
         LA    R8,SNALCDS         GET FIXED LINE CDS FORMAT    @Y17XAUU 42856000
         BCTR  R3,0               ADJUST BYTE COUNT            @Y17XAUU 42857000
         EX    R3,SNACDS          MOVE CDS TO BUFFER           @Y17XAUU 42858000
         MVC   TCDSNAM(D8),CDSLINE  SET SYMBOLIC NAME          @Y17XAUU 42859000
         DROP  R1                                              @Y17XAUU 42860000
         SLR   R1,R1              CLEAR REG                    @Y17XAUU 42861000
         ICM   R1,3,TOTSCUCB      GET UCB ADDRESS              @Y17XAUU 42862000
         USING UCB,R1             SET UCB ADDRESSABILITY       @Y17XAUU 42863000
         MVC   TCDSUCB+D2(D2),UCBCHA SET UCB BINARY CUU ADDR   @Y17XAUU 42864000
         DROP  R1                                              @Y17XAUU 42865000
         MVC   TCDSDAF(D2),TOTSRSID SET NETWORK ADDR IN CDS    @Y17XAUU 42866000
         B     NODELETE           EXIT                         @Y17XAUU 42867000
         SPACE                                                          42868000
CDSPRES  DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 42869000
         LA    R15,RETDAF         SET RETURN CODE FOR CDS NOT  @Y17XAUU 42870000
*                                 FOUND AND NETWORK ADDR RETURN@Y17XAUU 42871000
         SLR   R0,R0              CLEAR REG                    @Y17XAUU 42872000
         ICM   R0,3,TOTSRSID      SET UP NETWORK ADDRESS       @Y17XAUU 42873000
         B     NODELETE           EXIT                                  42874000
         SPACE                                                          42875000
         DROP  R8                                              @Y17XAUU 42876000
GC040    DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 42877000
         LOAD  EPLOC=CDSLINE           BRING MEMBER IN CORE      S99528 42900000
         LR    R6,R0                   EP OF CDS                 S99528 43000000
         L     R5,GRABPARM             GET PARM POINTER          S99528 43100000
         L     R7,FOUR(R5)             GET CDSMOVE ADDRESS       S99528 43200000
         L     R5,EIGHT(R5)            POINT TO FLAGS            S99528 43300000
         N     R5,CDSNO                CLEAR ALL BUT NOS BYTES   S99528 43400000
         LTR   R7,R7                   CDS ADDRESS GIVEN         S99528 43500000
         BZ    DDMOVE                  NO BR                     S99528 43600000
         LTR   R5,R5                    NUMBER GIVEN           @XA06343 43700000
         BP    CDSMV                   YES BR                    S99528 43800000
         LA    R5,TEN                  ASSUME DEFULT             S99528 43900000
CDSMV    EX    R5,CDSMOVE              GO MOVE CDS               S99528 44000000
DDMOVE   EQU   *                       FIND DD ENTRY             S99528 44100000
         DELETE EPLOC=CDSLINE          REMOVE CDS                S22024 44200000
NODELETE DS    0H                                              @Y17XAUU 44250000
         ICM   R9,ADRMSK,TOTSCLCB      GET LCB ADDRESS         @Y17XAUU 44300000
         LTR   R9,R9                   IS THTER ONE              S22024 44400000
         BNZ   GOOD00                  YES BRANCH                S22024 44500000
         SR    R9,R9                   CLEAR                   @G36XRUV 44550010
         ICM   R9,HALF,TOTSCUCB        GET UCB ADDRESS         @G36XRUV 44600010
         USING UCB,R9                                            S99528 44700000
         TM    UCBTBYT3,UCB3DISP       GRAGHIC                   S99528 44800000
         BO    GRAPHIC                 YES BRANCH                S99528 44900000
         NI    EXCPDCB+50,X'DF'        NO DEV DEPENDENT          S99528 45000000
         DROP  R9                                                S99528 45100000
GRAPHIC  LA    R9,CVTPTR               GET CVT ADDRESS           S99528 45200000
         L     R9,0(R9)                CVT ADDRESS               S99528 45300000
         L     R9,0(R9)                TCBPOINTERS ADDRESS       S99528 45400000
         L     R9,4(R9)                CURRENT TCB ADDRESS       S99528 45500000
         L     R9,12(R9)               TIOT POINTER              S99528 45600000
         USING TIOT,R9                                           S99528 45700000
         LA    R9,TIOENTRY             POINT TO FIRST ENTRY      S99528 45800000
         DROP  R9                                                S99528 45900000
         USING TIOENTRY,R9                                       S99528 46000000
         EJECT                                                          46050000
GETLENGT SR    R3,R3                   CLEAR REG                 S99528 46100000
         IC    R3,TIOELNGH             DD ENTRY LENGTH           S99528 46200000
         LTR   R3,R3                   ANY LENGTH                S99528 46300000
         BZ    NOTFOUND                NO BRANCH                 S99528 46400000
         LA    R5,POOLSTAR-TIOESTTB    GET LENGTH OF DEVICE ENTRYS99528 46500000
         DROP  R9                                                S99528 46600000
         LR    R6,R3                   SAVE LENGTH               S99528 46700000
         SR    R3,R5                   DD LENGTH -4              S99528 46800000
         AR    R3,R9                   DEVICE                    S99528 46900000
         USING TIOESTTB,R3                                       S99528 47000000
         CLC   TIOEFSRT+1(2),TOTSCUCB  COMPARE UCB ADDRESSES FOR S99528 47100000
         DROP  R3                                                S99528 47200000
         BE    UCBFOUND                BRANCH WHEN FOUND         S99528 47300000
         AR    R9,R6                   BUMP TO NEXT DD ENTRY     S99528 47400000
         B     GETLENGT                BRANCH                    S99528 47500000
NOTFOUND EQU   *                                                 S99528 47600000
          LA    R15,EIGHT              RETURN CODE               S99528 47700000
         B     GRB070                  RETURN                    S99528 47800000
GOOD00   EQU   *                       ZERO                      S22024 47900000
         SR    R15,R15                 RETURN                    S22024 48000000
         B     GRB070                  CODE                      S22024 48100000
UCBFOUND EQU   *                                                 S99528 48200000
         USING TIOENTRY,R9             TIOT ENTRY BASE                  48300000
COMPAREN EQU   *                                                 S99528 48400000
         CLI   TIOEDDNM,X'40'          IS NAME FIELD BLANK?      S99528 48500000
         BNE   MOVEIN                  NO, GO MOVE DDNAME        S99528 48600000
         SR    R9,R6                   SET ENTRY TO PRECEDING ONES99528 48700000
         B     COMPAREN                GO LOOK FOR NAME          S99528 48800000
MOVEIN   EQU   *                                                 S99528 48900000
         MVC   EXCPDCB+40(8),TIOEDDNM  MOVE DDNMME TO DCB        S99528 49000000
         DROP  R9                                                       49100000
         LA    R6,EXCPDCB         GET DCB ADDRESS              @Y17XAUU 49200000
         RDJFCB (R6)                                           @Y17XAUU 49300000
         MVI   JFCBAA+53,X'00'         CLEAR                     S99528 49400000
         MVC   JFCBAA+54(12),JFCBAA+53 UNUSED                    S99528 49500000
         MVI   JFCBAA+67,X'00'         SECTION                   S99528 49600000
         MVC   JFCBAA+68(12),JFCBAA+67 OF                        S99528 49700000
         MVI   JFCBAA+88,X'00'         THE                       S99528 49800000
         MVC   JFCBAA+89(29),JFCBAA+88 JFCB                      S99528 49900000
         MVI   JFCBAA+148,X'00'        FOR                       S99528 50000000
         MVC   JFCBAA+149(25),JFCBAA+148 TOTE                    S99528 50100000
         MVI   JFCBAA+52,X'08'         PREVENT                   S99528 50200000
         MVI   JFCBAA+66,X'02'         REVERSE MERGE             S99528 50300000
         MVC   TOTSCDCB(72),EXCPDCB    MOVE DCB TO OLTCB         S99528 50400000
         LA    R1,TOTSCDCB             DCB ADDRESS               S99528 50500000
         ST    R1,OPENAREA             STORE IN P LIST           S99528 50600000
         MVI   OPENAREA,X'8F'          OPTION OPEN               S99528 50700000
         LA    R1,OPENAREA             ADDRESS OF P LIST         S99528 50800000
         OPEN  MF=(E,(1)),TYPE=J       SECONAARY DCB             S99528 50900000
         EJECT                                                          50950000
         TM    TOTSCDCB+48,X'10'       SUCCESSFUL OPEN?          S99528 51000000
         BNO   MOVEIN1                 BRANCH IF ERROR ON OPEN   S99528 51100000
         L     R3,TOTSCDEB             GET ADDRESS OF DEB        S99528 51200000
         LA    R3,D34(R3)              GET ADDRESS OF UCB IN DEB S99528 51300000
         ST    R3,TOT102A              STORE ADDRESS INTO SVC    S99528 51400000
*                                        102 PARAMETER LIST      S99528 51500000
         LA    R1,TOT102               LOAD ADDRESS OF PARM LIST S99528 51600000
*                                        INTO REG 1              S99528 51700000
         AQCTL                         ISSUE DATA MOVE SVC       S99528 51800000
         B     GRB070                  GOOD EXIT                 S99528 51900000
MOVEIN1  EQU   *                                                 S99528 52000000
         LA    R15,EIGHT               SET BAD RETURN CODE       S99528 52100000
         SPACE                                                          52200000
GRB070   EQU   *                       EXIT                      S99528 52300000
         STC   R15,TOTRTCOD            RETURN CODE TO OLTCB      S99528 52400000
         TM    $OLTFLGS,$TRACE         TRACE OPTION              S99528 52500000
         BO    M2                      YES BR                    S99528 52600000
         TM    $RETMASK,X'FF'          RETURN OPTION             S99528 52700000
         BZ    RETURN                  NO BR                     S99528 52800000
         CLI   TOTRTCOD,0              RETURN CODE ZERO          S99528 52900000
         BNE   M2                      NO BR                     S99528 53000000
RETURN   L     R13,4(R13)              CALLERS SAVE ADDRESS      S99528 53100000
         L     R14,12(R13)        RESTORE R14.                          53200000
         LM    R0,R12,20(R13)     RESTORE R0-R12.                       53300000
         BR    R14                RETURN TO CALLER.                     53400000
M2       EQU   *                       GO TO IEDQWM2             S99528 53500000
         L     R13,4(R13)              RESTORE R13               S99528 53600000
         L     R14,12(R13)             RESTORE R14               S99528 53700000
         USING RESPL,R15               SET RESPL ADDRESSABILITY@Y17XAUU 53800000
         L     R15,TOTRESPL            GET RESPL ADDRESS       @Y17XAUU 53900000
         L     R15,RESPLM2             GET TRACE ROUTINE ADDR  @Y17XAUU 54000000
         LM    R2,R12,DISREG2(R13)     RESTORE REGISTERS       @Y17XAUU 54100000
         BR    R15                     EXIT TO IEDQWM2         @Y17XAUU 54200000
         DROP  R15                                             @Y17XAUU 54300000
         EJECT                                                          54350000
NAMEBULD EQU   *                                                 S99528 54400000
         MVI   CDSLINE,C' '            BLANK OUT                 S99528 54500000
         MVC   CDSLINE+1(7),CDSLINE    EIGHT CHARACTER NAME      S99528 54600000
         L     R12,TRMTNT              GET SAVED TNT ADDRESS   @Y17XAUU 54700000
         L     R9,CDSLINE              GET ADDRESS OF NAME FIELD S99528 54800000
         SR    R3,R3                   CLEAR REG                 S99528 54900000
         IC    R3,TOTTTBEL             GET NAME LRNGTH           S99528 55000000
         BCTR  R3,0                    DECREMENT COUNT FOR EX    S99528 55100000
         EX    R3,NAMEMOVE             GO MOVE NAME              S99528 55200000
         B     LOADNAME                GO LOAD NAME            @Y17XAUU 55230000
         SPACE 2                                                        55260000
NAMEMOVE MVC   0(0,R9),0(R12)          MOVE NAME FROM TERMINAL TAS99528 55400000
         EJECT                                                          55450000
***   THIS CODE FINDS UCB ADDRESS IF GRAB IS FOR A TERMINAL      S99528 55500000
UCBFIND  EQU   *                                                 S99528 55600000
         ST    R7,TRMTNT               SAVE TNT ADDRESS        @Y17XAUU 55700000
         SR    R6,R6                   CLEAR REG                 S99528 55800000
         IC    R6,TOTTTBEL             GET TERMINAL NAME LENGTH  S99528 55900000
         AR    R5,R6                   GET TNT ADDRESS           S99528 56000000
         MVC   TNTENTRY+D1(D3),D0(R6)  ALLINE ADDRESS          @Y17XAUU 56030000
         L     R7,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 56060000
         USING IEDQTRM,R7                                        S99528 56300000
         L     R7,TRMDESTQ-1           GET QCB ADDRESS           S99528 56400000
         DROP  R7                                                S99528 56500000
         USING IEDQQCB,R7                                        S99528 56600000
         SR    R3,R3                   CLEAR REG                 S99528 56700000
         IC    R3,QCBRELLN             GET RLN                   S99528 56800000
         SLL   R3,2                    MULT BY 4                 S99528 56900000
         L     R7,QCBDCBAD-1           GET DCB ADDRESS           S99528 57000000
         DROP  R7                                                S99528 57100000
         USING IHADCB,R7                                         S99528 57200000
         L     R7,DCBDEBAD             GET DBE ADDRESS           S99528 57300000
         DROP  R7                                                S99528 57400000
         USING DEBNMSUB,R7                                       S99528 57500000
         SR    R15,R15                 CLEAR REG                 S99528 57600000
         IC    R15,DEBNMEXT            GET NUMBER OF EXTENTS     S99528 57700000
         SLL   R15,2                   MULT BY 4                 S99528 57800000
         L     R7,DEBUCBAD-4(R3)       GET UCB ADDRESS           S99528 57900000
         B     TNTRET                  BRANCH                    S99528 58000000
         EJECT                                                          58100000
************************************************************** @Y17XAUU 58200000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 58300000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE PRFIX * @Y17XAUU 58400000
*        ADDRESS. RETURN TO CALLER VIA REG 14.                 @Y17XAUU 58500000
************************************************************** @Y17XAUU 58600000
NCPTTE   EQU   *                                               @Y17XAUU 58700000
         ST    R14,SAVERET             SAVE RETURN ADDRESS     @Y17XAUU 58800000
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 58900000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 59000000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 59100000
NCPLOOP  EQU   *                                               @Y17XAUU 59200000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 59300000
         L     R15,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 59400000
         USING IEDQAVTD,R15            SET AVT ADDRESSABILITY  @Y17XAUU 59500000
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 59600000
*                                      ROUTINE ADDRESS         @Y17XAUU 59700000
         DROP  R15                                             @Y17XAUU 59800000
         BALR  R14,R15                 FIND TTE ADDRESS        @Y17XAUU 59900000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 60000000
         CLI   TRMTYPE,TRMLNCP         NCP ENTRY               @Y17XAUU 60100000
         BNE   NCPLOOP                 NO - CHECK NEXT ENTRY   @Y17XAUU 60200000
         L     R14,SAVERET             RESTORE RETURN ADDRESS  @Y17XAUU 60300000
         BR    R14                     RETURN TO CALLER        @Y17XAUU 60400000
         DROP  R1                                              @Y17XAUU 60500000
         EJECT                                                          60502000
***************************************************************@Y17XAUU 60504000
*        ROUTINE TO GO TO IEDQWB2 TO CALCULATE THE AMOUNT OF   @Y17XAUU 60506000
*        OF CORE NEEDED TO BUILD DUMMY ENTRIES FOR A SPECIFIED @Y17XAUU 60508000
*        REMOTE TERMINAL. CONTROL IS PASS TO IEDQWB TO ATTAIN  @Y17XAUU 60510000
*        THE ACTUAL CORE.  CONTROL IS THEN RETURNED TO IEDQWB2 @Y17XAUU 60512000
*        TO COPY THE ENTRIES.                                  @Y17XAUU 60514000
***************************************************************@Y17XAUU 60516000
DUMMYTNT EQU   *                                               @Y17XAUU 60518000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS               @Y17XAUU 60520000
         SLR   R15,R15            CLEAR RETURN CODE REG        @Y17XAUU 60522000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 60524000
         LA    R7,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 60526000
         SLR   R8,R7              POINT TO TTE PREFIX          @Y17XAUU 60528000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 60530000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 60532000
         BNE   DUMOUT             NO - RETURN TO CALLER        @Y17XAUU 60534000
         MVI   TRMRQFLG,SCREQ     SHOW SEC TD REQUEST          @Y17XAUU 60536000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 60538000
         XC    TRMFLG01(D1),TRMFLG01 CLEAR CONTROL FLAG        @Y17XAUU 60540000
*                                                              @Y17XAUU 60542000
         LINK  EP=IEDQWB2         CALCULATE CORE               @Y17XAUU 60544000
         LTR   R15,R15            REQUEST SUCCESSFUL           @Y17XAUU 60546000
         BNZ   DUMOUT             NO - ERROR                   @Y17XAUU 60548000
*                                                              @Y17XAUU 60550000
         CLI   TRMRQFLG,ALRDY     COUNTERFEITING COMPLETE      @Y17XAUU 60552000
         BNE   DUM08              NO CONTINUE PROCESSING       @Y17XAUU 60554000
         NI    TOTSCFLG,TOTSCTAS  RESET ASSIGNED FLAG          @Y17XAUU 60556000
         B     DUMOUT             RETURN TO CALLER             @Y17XAUU 60558000
DUM08    EQU   *                                               @Y17XAUU 60560000
         L     R10,TOTRESPL       ADDR OF TOTE RES. CTL BLK    @Y17XAUU 60562000
         USING RESPL,R10                                       @Y17XAUU 60564000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                 @Y17XAUU 60566000
         POST  RESTECB1           POST REQUEST TO IEDQWB       @Y17XAUU 60568000
         WAIT  ECB=TOTOTECB       WAIT FOR REQUEST TO BE HONORE@Y17XAUU 60570000
         DROP  R10                                             @Y17XAUU 60572000
*                                                              @Y17XAUU 60574000
         CLI   TOTWKSPC,XFF       REQUEST SUCCESSFUL           @Y17XAUU 60576000
         BE    DUMOUT             NO - ERROR                   @Y17XAUU 60578000
*                                                              @Y17XAUU 60580000
         OI    TRMFLG01,TRMQWB3   SHOW SECOND PASS             @Y17XAUU 60582000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 60584000
         LINK  EP=IEDQWB2         COPY ENTRIES                 @Y17XAUU 60586000
*                                                              @Y17XAUU 60588000
         OI    TOTFLG04,X'04' .TOTSCCTF ********************** @YM08057 60589000
DUMOUT   EQU   *                                               @Y17XAUU 60590000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS            @Y17XAUU 60592000
         BR    R9                 RETURN                       @Y17XAUU 60594000
         EJECT                                                          60600000
*                                                                       60700000
*        $LETGO ENTRY                                                   60800000
*                                                                       60900000
LET002   EQU   *                                                        61000000
         L     R5,4(R1)                GET UNIT                  S99528 61100000
         L     R5,0(R5)                ADDRESS FROM CDS          S99528 61200000
         STH   R5,UCBNAMES             SAVE UNIT NAME            S99528 61300000
         L     R9,CVTPTR               GET CVT ADDRESS           S99528 61400000
         USING CVT,R9                                            S99528 61500000
         L     R11,CVTILK2             GET ADDR OF UCB ADDR TABLES99528 61600000
*                                      UCB LOOK UP TABLE         S99528 61700000
         DROP  R9                                                S99528 61800000
DISP083  EQU   *                                                 S99528 61900000
         LH    R10,0(R11)              GET FIRST UCB ADDRESS     S99528 62000000
         LTR   R10,R10                 TEST ENTRY                S99528 62100000
         BZ    DISP085                 ZERO ENTRY,GET NEXT       S99528 62300000
         BP    GOODUCB                 NO HI ORDER BITS ON     @G36XRUV 62320010
         N     R10,CLRHALF             CLEAR HIGH ORDER        @G36XRUV 62340010
         CLM   R10,HALF,TABEND         END OF TABLE ?          @G36XRUV 62360010
         BE    ERROR                   YES - END OF TABLE      @G36XRUV 62380010
         USING UCB,R10                                           S99528 62400000
GOODUCB  DS    0H                                              @G36XRUV 62450010
         CLC   UCBCHA(2),UCBNAMES      CORRECT ENTRY?            S99528 62500000
         BE    FOUND                   YES BRANCH                S99528 62600000
DISP085  EQU   *                                                 S99528 62700000
         LA    R11,2(R11)              GET NEXT ENTRY            S99528 62800000
         B     DISP083                 BR -LOOP                  S99528 62900000
FOUND    L     R9,TOTTDEND             GET END OF TABLE          S99528 63000000
         L     R11,TOTTDTBL            GET START OF DEVICE TABLE S99528 63100000
LOOP     DS    0H                                              @G36XRUV 63130010
         SR    R12,R12                 CLEAR                   @G36XRUV 63160010
         ICM   R12,HALF,2(R11)         GET UCB ADDRESS         @G36XRUV 63200010
         CR    R12,R10                 UCB ADDRESSESTHESAME      S99528 63300000
         BE    FOUND2                  YES BRANCH                S99528 63400000
         LA    R11,4(R11)              POINT TO NEXT ENTRY       S99528 63500000
         CR    R9,R11                  ENDOFLIST                 S99528 63600000
         BE    ERROR                   YESBRANCH                 S99528 63700000
         B     LOOP                    BRANCH                    S99528 63800000
FOUND2   EQU   *                                                 S99528 63900000
         TM    0(R11),TOTTDGRB         BEEN PREVIOUSLY GRABED    S99528 64000000
         BO    LET008                  YES BRANCH                S99528 64100000
         LA    R15,X'0C'               SET RETURN CODE           S99528 64200000
         B     GRB070                  RETURN                    S99528 64300000
         EJECT                                                          64350000
LET008   EQU   *                                                 S99528 64400000
         SR    R9,R9                   CLEAR                   @G36XRUV 64450010
         ICM   R9,HALF,TOTSCUCB        SECONDARY UCB ADDRESS   @G36XRUV 64500010
         USING UCB,R9                  UCB                       S99528 64600000
         MVC   RNAME(THREE),UCBNAME    NAME TO DEQ               S99528 64700000
         DROP  R9                      UCB                       S99528 64800000
         DEQ   ,MF=(E,DEQLIST)         DEQ UCB NAME              S99528 64900000
         LA    R1,TOTSCDCB             GET SECONDARY DCB         S99528 65000000
         ST    R1,OPENAREA             STORE IN P LIST           S99528 65100000
         MVI   OPENAREA,X'B0'          OPTION CLOSE              S99528 65200000
         LA    R1,OPENAREA             ADDRESS OF P LIST         S99528 65300000
         CLOSE MF=(E,(1))              CLOSE SECONDARY DCB       S99528 65400000
*                                                                       65500000
LET010   EQU   *                                                        65600000
         SR    R15,R15            SET RETURN CODE TO 0                  65700000
         LR    R8,R11                  SAVE LET GO ENTRY ADDR    S99528 65800000
         LA    R6,TOTTDEND             GET END OF TABLE ADDRESS  S99528 65900000
         LA    R11,4(R11)              SET UP TO                 S99528 66000000
         SR    R6,R11                  DETERMINE                 S99528 66100000
         BCTR  R6,ZERO                 DECREMENT FOR MOVE        S99528 66200000
         EX    R6,MOVE                 GO MOVE                   S99528 66300000
          XC    TOTLETGO(4),TOTLETGO   CLEAR LAST ENTRY          S99528 66400000
         L     R7,TOTGRABP             GET GRAB POINTER          S99528 66500000
         LA    R9,FOUR                 BACK UP POINTER           S99528 66600000
         SR    R7,R9                   BY FOUR                   S99528 66700000
         ST    R7,TOTGRABP             SAVE NEW ADDRESS          S99528 66800000
         B     GRB070             EXIT TO RETURN                        66900000
ERROR    LA    R15,X'0C'               SET RETURN CODE           S99528 67000000
         B     GRB070                  BRANCH                    S99528 67100000
         EJECT                                                          67150000
         DS    0F                                                       67300000
CLRHALF  DS    0F                      CLEAR HALF WORD         @G36XRUV 67302010
         DC    X'0000FFFF'                                     @G36XRUV 67304010
TABEND   DC    X'FFFF'                 END OF UCB TAB COMPARAND@G36XRUV 67306010
QLDLLIST DS    0F                 BLDL P-LIST                  @Y17XAUU 67310000
         DC    XL2'0001'          NUMBER OF LIST ENTRIES       @Y17XAUU 67320000
         DC    XL2'003A'          LENGTH OF EACH ENTRY         @Y17XAUU 67330000
         DC    8XL1'40'           MODULE ID                    @Y17XAUU 67340000
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 67350000
QORENEED DC    XL3'0'             MAIN STORAGE NEEDED          @Y17XAUU 67360000
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 67370000
WORKA    DC    X'000F'            USED FOR CONVERSION          @Y17XAUU 67380000
GRB080   DC    X'00F00000'        MASK FOR ISOLATING CNTL UNIT BITS.    67400000
GRB081   DC    X'000F0000'        MASK FOR ISOLATING DEVICE BITS.       67500000
MOVE     MVC   0(0,R8),0(R11)          MOVE REST OF TABLE UP     S99528 67600000
SNACDS   MVC   ZERO(ZERO,R5),ZERO(R8) CDS TO OLT               @Y17XAUU 67610000
SNATCDS  DC    XL4'0',XL2'0',XL4'4420180A',XL2'0',CL8' ',XL4'0'         67620000
*                                       BASIC 3767/3770 CDS    @Y17XAUU 67630000
SNALCDS  DC    XL4'0',XL2'0',XL4'4420240A',XL2'0',CL8' ',X'10',XL3'0',X*67640000
               L4'0',X'E0',XL2'0',XL5'0'                                67650000
*                                 BASIC 3705 LINE CDS          @Y17XAUU 67660000
PATCH    DS    CL50               MAINTENANCE AREA.                     67700000
         SPACE                                                          67800000
DCH      EQU   X'80'              DIFFERENT CHANNEL.                    67900000
CH       EQU   X'40'              SAME CHANNEL.                         68000000
DCU      EQU   X'20'              DIFFERENT CONTROL UNIT.               68100000
CU       EQU   X'10'              SAME CONTROL UNIT.                    68200000
DDV      EQU   X'08'              DIFFERENT DEVICE.                     68300000
DV       EQU   X'04'              SAME DEVICE.                          68400000
CLOMIT   EQU   X'02'              CLASS OMITTED.                        68500000
TYOMIT   EQU   X'01'              TYPE OMITTED.                         68600000
         EJECT                                                          68700000
START    DS    0F                 ***** START OF MODIFIABLE    @Y17XAUU 68800000
* DATA AREA -- DO NOT INSERT RECORD BETWEEN ***                @Y17XAUU 68900000
         DC    X'07'                   EXIT ADDR LIST          @Y17XAUU 69000000
         DC    AL3(0)                  JFCB ADDRESS            @Y17XAUU 69100000
         DC    X'80'                   END                       S99528 69200000
         DC    AL3(0)                  FILLER                    S99528 69300000
*                                                                S99528 69400000
**************************************************************** S99528 69500000
*        PARAMETER LIST FOR DATA MOVE                          * S99528 69600000
**************************************************************** S99528 69700000
         DS    0F                      ALIGNMENT               @Y17XAUU 69800000
         DC    X'08'                   FLAG FOR DATA MOVE        S99528 69900000
         DC    AL3(0)                  DATA ADDRESS            @Y17XAUU 70000000
         DC    X'00'                   FLAGS                   @Y17XAUU 70100000
         DC    AL3(0)                  TARGET ADDRESS            S99528 70200000
         DC    X'80'                   LAST WORD FLAG            S99528 70300000
         DC    AL3(0)                  ADDRESS OF LENGTH FIELD @Y17XAUU 70400000
         DC    H'2'                    LENGTH OF UCB ADDRESS MO@Y17XAUU 70500000
*                                                                S99528 70600000
         DC    H'0'                    ADDRESS OF UCB          @Y17XAUU 70700000
         DCB   DDNAME=DD274E,DSORG=PS,EXLST=*,MACRF=(E),       @Y17XAUUC70800000
               SIOA=AO,CENDA=AP,XENDA=AP                         S99528 70900000
         SPACE                                                          71000000
         DS    0F                                              @Y17XAUU 71100000
         DC    X'A0'                   FLAG BYTE               @Y17XAUU 71200000
         DC    XL3'0'             DEB ADDR                              71300000
         DC    F'0'                    PURGE USE                 S99528 71400000
         DS    0F                 ADDR OF IOB FOR PURGE        @Y17XAUU 71500000
         DC    X'01'                   NUMBER OF BEDS          @Y17XAUU 71600000
         DC    XL3'0'             IOB ADDR                              71700000
         DEQ   (QQAME,RRAME,8,STEP),RET=HAVE,MF=L DEQ PLIST    @Y17XAUU 71800000
QQAME    DC    CL8'SYSZTOTE'           QNAME ADDRESS           @Y17XAUU 71900000
RRAME    DC    CL8' '                  RNAME ADDRESS           @Y17XAUU 72000000
         DC    CL8'G0000000'           BUILD CDS NAME          @Y17XAUU 72100000
         DC    AL4(0)                  PARM SAVE AREA          @Y17XAUU 72200000
END      DS    0C                 *** END OF MODIFIABLE DATA   @Y17XAUU 72300000
***                               AREA TO BE MOVE***           @Y17XAUU 72400000
         EJECT                                                          72500000
LCBLENGT DC    X'0090'                 LCB LENGTH                S99528 72600000
CDSMOVE  MVC   ZERO(ZERO,R7),ZERO(R6)  CDS TO OLT                S99528 72700000
CDSNO    DC    X'000000FF'             MASK # CDS BYTES          S99528 72800000
CLASS    DC    X'00'                   CLASS BYTE                S99528 72900000
CLAS02   DC    X'01'                   2702                      S99528 73000000
CLAS01   DC    X'02'                   2701                      S99528 73100000
CLASS77  DC    X'00'                   7770                      S99528 73200000
NAMEFLD  DC    CL8'G0000000'           INIT NAME FIELD         @Y17XAUU 73300000
GRABREQ  DC    CL2'21'                 GRAB FUNCTION REQ       @Y17XAUU 73400000
         EJECT                                                          73500000
         OLTCB                         TOTE CONTROL BLOCK        S22024 73600000
JFCBADDR DC    X'07'                   EXIT ADDR LIST          @Y17XAUU 73700000
         DC    AL3(0)                  JFCB ADDRESS            @Y17XAUU 73800000
         DC    X'80'                   END                     @Y17XAUU 73900000
         DC    AL3(0)                  FILLER                  @Y17XAUU 74000000
*                                                              @Y17XAUU 74100000
****************************************************           @Y17XAUU 74200000
*        PARAMETER LIST FOR DATA MOVE               *          @Y17XAUU 74300000
****************************************************           @Y17XAUU 74400000
TOT102   DS    0F                      ALIGNMENT               @Y17XAUU 74500000
         DC    X'08'                   FLAG FOR DATA MOVE      @Y17XAUU 74600000
         DC    AL3(0)                  DATA ADDRESS            @Y17XAUU 74700000
TOT102A  DC    X'00'                   FLAGS                   @Y17XAUU 74800000
         DC    AL3(0)                  TARGET ADDRESS          @Y17XAUU 74900000
         DC    X'80'                   LAST WORD FLAG          @Y17XAUU 75000000
         DC    AL3(0)                  ADDRESS OF LENGTH FIELD @Y17XAUU 75100000
TOT102LN DC    H'2'                    LEN OF UCB ADDRESS      @Y17XAUU 75200000
*                                                              @Y17XAUU 75300000
ADDOFUCB DC    H'0'                    ADDRESS OF UCB          @Y17XAUU 75400000
EXCPDCB  DCB   DDNAME=DD274E,DSORG=PS,EXLST=JFCBADDR,MACRF=(E),        C75500000
               SIOA=AO,CENDA=AP,XENDA=AP                       @Y17XAUU 75600000
QVPRGLST DS    0F                                              @Y17XAUU 75700000
QVPURFLG DC    X'A0'                   FLAG BYTE               @Y17XAUU 75800000
         DC    XL3'0'             DEB ADDR                     @Y17XAUU 75900000
         DC    F'0'                    PURGE USE               @Y17XAUU 76000000
QVPRGIOB DS    0F                 ADDR OF IOB FOR PURGE        @Y17XAUU 76100000
QVPDEBNO DC    X'01'                   NUMBER OF BEDS          @Y17XAUU 76200000
         DC    XL3'0'             IOB ADDR                     @Y17XAUU 76300000
DEQLIST  DEQ   (QNAME,RNAME,8,STEP),RET=HAVE,MF=L DEQ PLIST    @Y17XAUU 76400000
QNAME    DC    CL8'SYSZTOTE'           QNAME ADDRESS           @Y17XAUU 76500000
RNAME    DC    CL8' '                  RNAME ADDRESS           @Y17XAUU 76600000
CDSLINE  DC    CL8'G0000000'           BUILD CDS NAME          @Y17XAUU 76700000
GRABPARM DC    AL4(0)                  PARM SAVE AREA          @Y17XAUU 76800000
OPENAREA DS    F                  OPEN CLOSE PARM              @Y17XAUU 76900000
TNTPOINT DS    F                  TNT ADDRESS                  @Y17XAUU 77100000
JFCBAA   DS    44F                JFCB                         @Y17XAUU 77200000
SAVERET  DS    F                  SAVE AREA                    @Y17XAUU 77300000
NAMESAVE DS    CL8                SECONDARY TD NAME            @Y17XAUU 77400000
BLDLLIST DS    0F                 BLDL P-LIST                  @Y17XAUU 77402000
         DC    XL2'0001'          NUMBER OF LIST ENTRIES       @Y17XAUU 77404000
         DC    XL2'003A'          LENGTH OF EACH ENTRY         @Y17XAUU 77406000
BLDLNAM  DC    8XL1'40'           MODULE ID                    @Y17XAUU 77408000
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 77410000
CORENEED DC    XL3'0'             MAIN STORAGE NEEDED          @Y17XAUU 77412000
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 77414000
BLDLEND  DS    0C                 END OF BLDL PLIST            @Y17XAUU 77416000
KTRM     DS    0F                 ***DO NOT INSERT BETWEEN *** @Y17XAUU 77418000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS       @Y17XAUU 77420000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS       @Y17XAUU 77422000
TRMQCB   DS    A                  CT/AP QCB ADDRESS            @Y17XAUU 77424000
TRMTNT   DS    A                  CT/AP TNT ADDRESS            @Y17XAUU 77426000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 77428000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA          @Y17XAUU 77430000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 77432000
REGSAVE  DS    F                  WORK AREA                    @Y17XAUU 77434000
F32      DC    F'32'              VALUE OF 32                  @Y17XAUU 77436000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @Y17XAUU 77436200
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @Y17XAUU 77436400
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @Y17XAUU 77436600
KDRQ     DS    A                  TRUE DRQ ADDRESS             @Y17XAUU 77436800
KPQCBSZ  DS    H                  P-QCB SIZE                   @Y17XAUU 77437000
KMQCBSZ  DS    H                  M-QCB SIZE                   @Y17XAUU 77437200
KDRQSZ   DS    H                  DRQ SIZE                     @Y17XAUU 77437400
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @Y17XAUU 77437600
TTECSZ   DS    CL1                CONC TTE SIZE                @Y17XAUU 77437800
TRMRQFLG DS    CL1                DUMMY TNT REQUEST FLAG       @Y17XAUU 77438000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 77440000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 77442000
PRREQ    EQU   X'20'              PRIMARY TD REQUEST           @Y17XAUU 77444000
SCREQ    EQU   X'10'              SECONDARY TD REQUEST         @Y17XAUU 77446000
ALRDY    EQU   X'00'              COUNTERFEIT STORAGE ALREADY  @Y17XAUU 77448000
*                                 EXIST FOR THIS REQUEST       @Y17XAUU 77450000
TRMFLG01 DS    CL1                CONTROL FLAG                 @Y17XAUU 77452000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC    @Y17XAUU 77454000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE             @Y17XAUU 77456000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION         @Y17XAUU 77458000
TRMRNLU  EQU   X'10'              SNA LU ENTRY                 @Y17XAUU 77460000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE      @Y17XAUU 77462000
TRM3705  EQU   X'04'              3705 MODE                    @Y17XAUU 77464000
TRMCTEAP EQU   X'02'              CT EQU AP                    @Y17XAUU 77466000
WRKFLG   DS    CL1                WORK AREA                    @Y17XAUU 77468000
KTRMEND  DS    0C                 END OF KTRM DSECT            @Y17XAUU 77470000
************************************************************** @Y17XAUU 77472000
UCBNAMES DS    H                  UCB ADDRESS                  @Y17XAUU 77500000
         EJECT                                                          77600000
GRABMAP  DSECT                                                   S22024 77700000
         DS    XL1                     CONTROL PROMRAM FLAGS     S22024 77800000
         DS    XL1                     MACRO LEVEL               S22024 77900000
         DS    XL2                     MACRO ID                  S22024 78000000
$GRABCDS DS    A                       CDS INFO AREA             S22024 78100000
$GRABFLG DS    XL1                     FLAGS                     S22024 78200000
$GRABCLS DS    XL1                     CLASS                     S22024 78300000
$GRABTYP DS    XL1                     TYPE                      S22024 78400000
$GRABCNT DS    XL1                     NUMBER OF CDS BYTES       S22024 78500000
         TLGBD                         LGB                       S22024 78600000
         EJECT                                                          78700000
         TDEBD                                                          78800000
DCBDSECT DCBD  DSORG=TX                DCB                       S22024 78900000
TIOT     DSECT                                                   S22024 79000000
         IEFTIOT1                      TIOT                      S99528 79100000
         TAVTD                                                   S99528 79200000
         TTRMD                                                   S99528 79300000
         TQCBD                                                   S99528 79400000
         TLCBD                                                   S99528 79500000
CVT      DSECT                                                   S99528 79600000
         CVT                                                     S99528 79700000
         EJECT                                                          79800000
RESPL    RESPL                                                 @Y17XAUU 79900000
         EJECT                                                          80000000
UCB      DSECT                                                   S99528 80100000
         IEFUCBOB                                                S99528 80200000
         EJECT                                                          80220000
         TDCTD                                                 @Y17XAUU 80240000
         EJECT                                                          80260000
         TTCDSD                                                @Y17XAUU 80280000
         END                                                            80300000
