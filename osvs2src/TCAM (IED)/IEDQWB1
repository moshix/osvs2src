         TITLE 'IEDQWB1 TRM ANALYSIS BUFFER ANALYZER'                   00200022
IEDQWB1  CSECT                                                          00400022
*A000000-999999                                                @Y16X5U0 00410000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00450000
*A211000,249500-249800,538070-539750,730570,731820              SA41592 00500022
*A680600                                                        SA59008 00550022
*A246000,520000                                                 SA41604 00570022
*A249400,280000,681910                                          SA41614 00580022
*A004500,010200-011600,231000,281070,624000-625600,637000        S22024 00582000
*A681247,681526-681528,681707,730570,730810,731820-731900        S22024 00584000
*C016000,280100-280140,280160-280180,280200-280240               S22024 00586000
*C681495-681499,681501-681503,681505-681507,681585,681720        S22024 00588000
*C681812,696000-697600,730630,730840,731680                      S22024 00590000
*D280350-280400,474000-486000,681395,681645-681655,730120-730300 S22024 00592000
*C280260-280280,280300-280340,644000,646000,681420,681425        S22024 00594000
*C686200                                                         S05331 00597000
*A681291-681292,681387-681389                                    S05331 00598000
*A442000                                                       @XA06325 00598158
*D358000-370000,378000,440000                                  @XA06325 00598258
*C280220-280280,396000-416000,444000                           @XA06325 00598358
*C681470-681495                                                @YA07679 00598858
*A731740                                                       @YA07679 00599358
*C681478                                                       @YA10430 00599458
*A249800,338000,340000,489000,496000,624400,687200,730480      @Y17XAUU 00599500
*A731760                                                       @Y17XAUU 00599600
*D280800-280900,731740                                         @Y17XAUU 00599700
*D312000-336000,350000-352000                                  @OY20346 00599886
         SPACE                                                          00600022
****************************************************************        00800022
*                                                              *        01000022
* MODULE NAME = IEDQWB1 (TCAM,TOTE)                            @Y17XAUU 01060000
*                                                              * S22024 01080000
* DESCRIPTIVE NAME = TRM ANALYSIS BUFFER ANALYZER              * S22024 01100000
*                                                              * S22024 01120000
* COPYRIGHT = NONE                                             * S22024 01140000
*                                                              * S22024 01160000
* STATUS --                                                    *        01200022
*                                                              *        01400022
*    VERSION 10.0                                              @Y17XAUU 01600000
*                                                              *        01800022
* FUNCTIONS --                                                 *        02000022
*                                                              *        02200022
*    THE PURPOSE OF THIS MODULE IS TO OBTAIN THE TRM FROM      *        02400022
*    THE TCAM BUFFER AND RETURN THE BUFFER BACK TO TCAM.       *        02600022
*                                                              *        02800022
*    IF THE TRM WAS ENTERED FROM THE SYSTEM CONSOLE, THE       *        03000022
*    BUFFER IS POSTED TO TCAM.                                 *        03200022
*                                                              *        03400022
*    IF THE TRM WAS ENTERED FROM A REMOTE TERMINAL, THE        *        03600022
*    LCB OR BUFFER IS POSTED TO TCAM.                          @Y17XAUU 03800000
*                                                              @Y17XAUU 03800300
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 03800600
*                                                              @Y17XAUU 03800900
* LINKAGE -- ATTACHED BY IEDQWB OR XCTL'ED TO BY IEDQWC.       @Y17XAUU 03801200
*                                                              @Y17XAUU 03801500
* MACROS -- IEDHJN                                             @Y17XAUU 03801800
*           XCTL                                               @Y17XAUU 03802100
*           SAVE                                               @Y17XAUU 03802400
*           AQCTL                                              @Y17XAUU 03802700
*           WTO                                                @Y17XAUU 03803000
*           LINK                                               @Y17XAUU 03803300
*           IEDQMSG                                            @Y17XAUU 03803600
*           TCONV                                              @Y17XAUU 03803900
*           BLDL                                               @Y17XAUU 03804200
*           LOAD                                               @Y17XAUU 03804500
*           DELETE                                             @Y17XAUU 03804800
*           WTOR                                               @Y17XAUU 03805100
*           STIMER                                             @Y17XAUU 03805400
*           WAIT                                               @Y17XAUU 03805700
*           TTIMER                                             @Y17XAUU 03806000
*           POST                                               @Y17XAUU 03806300
*           ENQ                                                @Y17XAUU 03806600
*                                                              *        04000022
* ENTRY POINTS                                                 *        04200022
*                                                              *        04400022
*    IEDQWB1                                                   @Y17XAUU 04600000
*                                                              *        04800022
* INPUT --                                                     *        05000022
*                                                              *        05200022
*    REGISTERS 02,13,14,15 CONTAIN THE FOLLOWING VALUES:       *        05400022
*                                                              *        05600022
*    02 - OLTCB POINTER                                        *        05800022
*    13 - SAVE AREA ADDRESS                                    *        06000022
*    14 - RETURN ADDRESS                                       *        06200022
*    15 - ENTRY POINT ADDRESS                                  *        06400022
*                                                              *        06600022
* OUTPUT --                                                    *        06800022
*                                                              *        07000022
*    REGISTERS 0 AND 1 CONTAIN PARAMETERS FOR IEDQWC           *        07200022
*                                                              *        07400022
* EXTERNAL REFERENCES --                                       *        07600022
*                                                              *        07800022
*    NONE                                                      *        08000022
*                                                              *        08200022
* EXITS,NORMAL                                                 *        08400022
*                                                              *        08600022
*    XCTL TO IEDQWH (NUMERICAL ANALYSIS MODULE) IF TRM WAS     *        08800022
*    ENTERED FROM A NUMERIC-ONLY TERMINAL.                     *        09000022
*                                                              *        09200022
*    XCTL TO IEDQWC (TRM ANALYSIS MODULE I) NORMALLY.          *        09400022
*                                                              *        09600022
* EXITS,ERROR --                                               *        09800022
*                                                              *        10000022
*    NONE                                                      *        10200022
*                                                              *        10400022
* TABLES/WORK AREAS --                                         *        10600022
*                                                              *        10800022
*    CVT, AVT, OLTCB, LCB, SCB                                 *        11000022
*                                                              *        11200022
* ATTRIBUTES --                                                *        11400022
*                                                              *        11600022
*    ENABLED, PROBLEM PROGRAM MODE, TRANSIENT                  *        11800022
*                                                              *        12000022
* NOTES -- SEE BELOW                                           @Y17XAUU 12200000
*                                                              @Y17XAUU 12202000
*  DEPENDENCIES -- EBCDIC CHARACTER CODE                       @Y17XAUU 12204000
*                                                              @Y17XAUU 12206000
*  RESTRICTION -- NONE                                         @Y17XAUU 12208000
*                                                              @Y17XAUU 12210000
*  REGISTER CONVENTIONS - SEE REGISTER ASSIGNMENT              @Y17XAUU 12212000
*                                                              @Y17XAUU 12214000
*  PATCH LABEL -- PATCH                                        @Y17XAUU 12216000
*                                                              *        12600022
****************************************************************        12800022
         EJECT                                                          13000022
*                                                              *        13200022
*        E Q U A T E S                                         *        13400022
*                                                              *        13600022
R0       EQU   0                  REG 0                                 13800022
R1       EQU   1                  REG 1                                 14000022
R2       EQU   2                  REG 2                                 14200022
R3       EQU   3                  REG 3                                 14400022
R4       EQU   4                  REG 4                                 14600022
R5       EQU   5                  REG 5                                 14800022
R6       EQU   6                  REG 6                                 15000022
R7       EQU   7                  REG 7                                 15200022
R8       EQU   8                  REG 8                                 15400022
R9       EQU   9                  REG 9                                 15600022
R10      EQU   10                 REG 10                                15800022
R11      EQU   11                 REG 11                                16000022
R12      EQU   12                 REG 12                                16200022
R13      EQU   13                 REG 13                                16400022
R14      EQU   14                 REG 14                                16600022
R15      EQU   15                 REG 15                                16800022
         SPACE                                                          17000022
D0       EQU   0                  DISP OF 0                             17200022
D1       EQU   1                  DISP OF 1                             17400022
D2       EQU   2                  DISP OF 2                             17600022
D3       EQU   3                  DISP OF 3                             17800022
D4       EQU   4                  DISP OF 4                             18000022
D5       EQU   5                  DISP OF 5                             18200022
D6       EQU   6                  DISP OF 6                             18400022
D7       EQU   7                  DISP OF 7                             18600022
D8       EQU   8                  DISP OF 8                             18800022
D9       EQU   9                  DISP OF 9                             19000022
D10      EQU   10                 DISP OF 10                            19200022
D11      EQU   11                 DISP OF 11                            19400022
D12      EQU   12                 DISP OF 12                            19600022
D13      EQU   13                 DISP OF 13                            19800022
D14      EQU   14                 DISP OF 14                            20000022
D15      EQU   15                 DISP OF 15                            20200022
D16      EQU   16                 DISP OF 16                            20400022
D17      EQU   17                 DISP OF 17                            20600022
D18      EQU   18                 DISP OF 18                            20800022
D19      EQU   19                 DISP OF 19                            21000022
D20      EQU   20                 DISP OF 20                            21200022
D24      EQU   24                 DISP OF 24                            21400022
D28      EQU   28                 DISP OF 28                            21600022
D32      EQU   32                 DISP OF 32                            21800022
D36      EQU   36                 DISP OF 36                            22000022
D40      EQU   40                 DISP OF 40                            22200022
D80      EQU   80                 DISP OF 80                            22400022
         SPACE                                                          22600022
XF0      EQU   X'F0'              LCB MASK FOR ANR LOCAL                22800022
ANR      EQU   X'1E'              REQ TERMINAL EQU ANR LOCAL            23000022
LGBA     EQU   X'80'              LGB MAP                        S22024 23100000
BTURSP   EQU   X'18'              OLTT BTU                       S22024 23150000
MULBUF   EQU   X'14'              MULTIPLE BUFFER PREFIX         S22024 23170000
TRMCONS  EQU   X'0C'              REQ TERMINAL EQU SYSCON               23200000
TRMSCCT  EQU   X'10'              REQ TERMINAL EQU SEC. SYSCON          23400022
TRMPRI   EQU   X'E7'              LCB PRIORITY FLAG                     23600022
XBLANK   EQU   X'61'              A SLASH CHAR                          23800022
ECBCODE  EQU   0                  ECB CODE                              24000022
TRMAX    EQU   72                 MAXIMUM TRM LENGTH                    24200022
NUMEN    EQU   X'80'              NUMERIC TRM ENTRY                     24400022
TPOSTE   EQU   X'80'              END OF LIST FLAG                      24600022
TPOSTA   EQU   X'0C'              FIRST ELEMENT FLAG            SA41604 24700022
POSTLCB  EQU   X'0C'              POST LCB FLAG                         24800022
CAP      EQU   X'40'              FACTOR FOR CAPITALIZATION             24820022
YES      EQU   X'E8'              CHAR 'Y'                              24840022
PARMREG0 EQU   0                  PARAMETER REG 0                       24860022
PARMREG1 EQU   1                  PARAMETER REG 1                       24880022
RESDP    EQU   X'20'              DEVICE PROTECTED                      24900022
CDSLEN   EQU   255                CDS BUFFER LENGTH                     24920022
D64      EQU   64                 DISP /F 64                            24940022
XFF      EQU   X'FF'              MASK SETTING                  SA41614 24950022
TRMTERM  EQU   X'10'              PRFKEY SETTING FROM OPERATOR  SA41592 24960022
*                                   CONTROL TERMINAL            SA41592 24980022
LUTYPE   EQU   X'1C'              SOURCE IS AN LU              @Y17XAUU 24985000
         EJECT                                                          25000022
         USING IEDQWB1,R15                                              25200022
IEDQWB1  IEDHJN STARB1,HJN                                              25400022
         DROP  R15                                                      25600022
         SPACE                                                          25800022
         SAVE  (14,12)            SAVE CALLER'S REGISTERS               26000022
         SPACE                                                          26200022
         LR    R6,R15             SET BASE REG                          26400022
         USING IEDQWB1,R6                                               26600022
         USING TOTOLTCB,R2                                              26800022
         SPACE                                                          27000022
         LA    R3,TOTSAVE4        GET MY SAVE AREA ADDR                 27200022
         ST    R3,D8(R13)         STORE IN CALLER'S SAVE AREA           27400022
         ST    R13,D4(R3)         SAVE CALLER'S SAVE ADDR               27600022
         ST    R13,TOTRESSV       SAVE MOTHER TASK SAVE AREA ADDR       27800022
         LR    R13,R3             SET REG 13 TO SAVE AREA               28000022
         SPACE                                                          28001022
         TM    TOTFLG04,TOTNUMDV  NUMERIC ENTRY                 SA41614 28002022
         BO    NUMERIC            YES                           SA41614 28003022
         SPACE                                                          28005022
**************************************************************** S22024 28010000
*                                                              * S22024 28012000
*        SECOND PASS CHECK. EXIT IS TO 'DEVPRT'.               * S22024 28014000
*                                                              * S22024 28016000
**************************************************************** S22024 28018000
         SPACE                                                          28020000
         TM    TOTFLG01,TOTPRMPT+TOTCONFG PROMPT OR CONFIG REQ @XA06325 28022058
         BNZ   DEVPRT                   BRANCH IF YES          @XA06325 28026058
         TM    TOTFLG02,TOTOLTRQ  ON-LINE TEST REQUEST           S22024 28030000
         BO    DEVPRT             YES- CHECK FOR DEVICE PROTECT  S22024 28032000
*                                 ELSE ASSUME ENTRY IS FROM QWB  S22024 28034000
         SPACE                                                          28045022
*********************************************************************** 28050022
*                                                                     * 28055022
*        INITIALIZATION OF THE OLTCB                                  * 28060022
*                                                                     * 28065022
*********************************************************************** 28070022
         SPACE 1                                                        28075022
         LA    R5,TOTINBUF        GET TOTE INPUT BUFFER ADDRESS         28095022
         ST    R5,TOTINADR-D1       AND STORE IN WTOR PARM LIST         28100022
         MVI   TOTINCNT,D80       SET TOTE INPUT COUNT TO 80            28105022
         MVI   $DRIVER,$TOTE           SET TOTE ID               S22024 28107000
         LA    R5,TOTOTECB        GET TOTE SUBTASK ECB ADDRESS          28110022
         ST    R5,TOTINECB          AND STORE IN WTOR PARM LIST         28115022
         ST    R5,TOTECBPT        SAVE ECB ADDRESS                      28120022
         MVI   TOTECBPT,D80       SET HI ORDER FLAG                     28125022
         OI    TOTFLG06,TOTNPERR  SET NO PERMANENT ERROR FLAG           28130022
         OI    TOTFLG08,D3        SET DRPINT DEFAULT LEVEL              28135022
         LA    R5,TOTPASS         GET ADDRESS OF PASSON DATA BUFFER     28140022
         ST    R5,$PASS           PUT IT IN OLT SCT                     28145022
         XC    D0(D64,R5),D0(R5)  CLEAR PASSON DATA BUFFER              28150022
         LA    R5,TOTEXT          GET ADDRESS OF EXTERNAL DATA BUFFER   28155022
         ST    R5,$EXT            PUT IT IN OLT SCT                     28160022
         ST    R2,TOTOLTPL        STORE OLTCB ADDRESS                   28165022
         LA    R5,TOTPLNKQ        GET ADDRESS OF PLINK MODULE QUEUE     28170022
         ST    R5,TOTPLFWD        PUT IT IN FORWARD POINTER             28175022
         ST    R5,TOTPLBKW        PUT IT IN BACKWARD POINTER            28180022
         SPACE 2                                                        28185022
         SPACE 2                                                        28200022
****************************************************************        28400022
*                                                              *        28600022
*        ROUTINE TO GET AND FIND SHADE OF TRM                  *        28800022
*                                                              *        29000022
****************************************************************        29200022
         SPACE                                                          29400022
         L     R12,TOTAVTPT       AVT ADDR                              29600022
         USING IEDQAVTD,R12                                             29800022
         MVI   TOTOTECB,ECBCODE   CLEAR ECB CODE                        30000022
         L     R11,TOTOLTMQ       GET ADDRESS OF TCAM BUFFER            30200022
         SPACE                                                          30400022
         LR    R5,R11             SAVE ADDR OF HEADER BUFFER            30600022
         USING IEDQPRF,R5                                               30800022
         ST    R5,WORK5           SAVE HEADER ADDRESS                   31000022
RES0715  EQU   *                                                        33800022
         MVC   TOTSRLCB(D4),PRFLCB-D1 SAVE SOURCE LCB ADDRESS  @Y17XAUU 33820000
         MVC   TOTSROFF(D2),PRFSRCE SAVE INDEX TO TERMNAME TAB @Y17XAUU 33840000
         MVC   TRMSRCE(D2),PRFSRCE SAVE INDEX TO TERMNAME TABLE         34000022
         CLI   PRFKEY,TRMCONS     REQ TERMINAL EQU SYSCON      @Y17XAUU 34020000
         BE    RES0717            YES                          @Y17XAUU 34040000
         SPACE                                                          35400022
RES0717  EQU   *                                                        35600022
         MVC   TRMKEY(D1),PRFKEY  SAVE REQUEST TERMINAL FLAG            37200022
         LH    R1,AVTKEYLE        GET UNIT LENGTH                       37400022
         SR    R15,R15            INITIALIZE REG                        37600022
         LR    R10,R5             SAVE BUFFER ADDR                      38000022
         LA    R3,TOTTRMBF        POINT TO TRM BUFFER                   38200022
         LA    R14,PRFSUNIT       GET START OF 1ST UNIT THIS BUFFER     38400022
         SH    R1,PRFSCAN         SUBTRACT RESERVE CHAR                 38600022
         AH    R14,PRFSCAN        BUMP R14 PAST RESERVE CHAR            38800000
         IC    R15,PRFNBUNT       GET NUMBER OF UNITS                   39000022
         SPACE                                                          39200022
RES080   EQU   *                                                        39400022
         LH    R9,PRFSIZE         GET DATA SIZE FROM BUFFER    @XA06325 39600058
         SH    R9,PRFSCAN         GET LENGTH OF TRM DATA       @XA06325 39700058
         LA    R8,TRMAX           SET MAXIMUM TRM BUFFER SIZE  @XA06325 39800058
         CR    R8,R9              WAS MORE THAN MAX ENTERED?   @XA06325 39900058
         BNL   RES082A            NO, BRANCH                   @XA06325 40000058
         LR    R9,R8              TRUNCATE TRM TO MAX SIZE     @XA06325 40100058
RES082A  EQU   *                                               @XA06325 40200058
         CR    R1,R9              IS ALL TRM DATA IN THIS UNIT @XA06325 40300058
         BL    RES082             NO, BRANCH                   @XA06325 40400058
         BCTR  R9,R0              DECREMENT COUNT FOR EXECUTE  @XA06325 40500058
         EX    R9,TRMMOVE         MOVE DATA                    @XA06325 40600058
         B     RES089             EXIT                         @XA06325 40700058
         SPACE                                                          41800022
RES082   EQU   *                                                        42000022
         BCTR  R1,R0              DECREMENT COUNT FOR EXECUTE           42200022
         EX    R1,TRMMOVE         MOVE BUFFER UNIT                      42400022
         LA    R3,D1(R1,R3)       POINT TO NEW BUFFER LOCATION          42600022
         BCT   R15,RES088         ANY MORE UNITS IN THIS BUFFER         42800022
         B     RES089             NO - EXIT                             43000022
         SPACE                                                          43200022
RES088   EQU   *                                                        43400022
         L     R14,PRFTIC         GET ADDRESS OF NEXT UNIT              43600022
         LR    R5,R14             SAVE IT                               43800022
         SR    R9,R1              DETERMINE NUMBER OF DATA     @XA06325 44000058
*                                   BYTES LEFT TO BE MOVED     @XA06325 44070058
         LH    R1,AVTKEYLE        GET UNIT LENGTH              @XA06325 44140058
         CR    R1,R9              IS REMAINDER OF TRM IN THIS  @XA06325 44210058
*                                   UNIT?                      @XA06325 44280058
         BL    RES082             NO, MOVE ENTIRE UNIT         @XA06325 44350058
         LR    R1,R9              YES, MOVE DATA THAT REMAINS  @XA06325 44420058
         B     RES082A            BRANCH TO MOVE DATA          @XA06325 44490058
         SPACE                                                          44600022
RES089   EQU   *                                                        44800022
         CLC   TOTTRMBF(D2),NUMER NUMERIC ENTRY                         45000022
         BNE   RES089A            NO                                    45200022
         OI    NUMFLG,NUMEN       SHOW NUMERIC ENTRY                    45400022
         DROP  R5                                                       45600022
         SPACE                                                          45800022
RES089A  EQU   *                                                        46000022
         L     R10,WORK5          GET HEADER ADDR                       46200022
         USING IEDQPRF,R10                                              46400022
         SPACE                                                          46600022
*                                                              *        46800022
*        PREPARE TO POST BUFFER TO TCAM                        *        47000022
*                                                              *        47200022
         CLI   TRMKEY,BTURSP      OLTT BTU RESPONSE              S22024 47700000
         BE    RES089B1           YES - ERROR BUFFER             S22024 48200000
         CLI   TRMKEY,TRMTERM     IS REQUEST FROM A SECONDARY   SA41592 48700000
*                                   OPERATOR CONTROL TERMINAL?  SA41592 48800022
         BE    RES089B1           YES, GO FREE BUFFER           SA41592 48900022
         CLI   TRMKEY,LUTYPE      SOURCE IS AN LU              @Y17XAUU 48930000
         BE    RES089B1           YES - POST BUFFER ONLY       @Y17XAUU 48960000
         CLI   TRMKEY,MULBUF      MULTIPLE BUFFERS               S22024 49000000
         BE    RES089B1           YES - POST BUFFER ONLY         S22024 49100000
         SPACE                                                          49200022
         CLI   TRMKEY,TRMCONS     TRM ENTERED FROM SYSCON      @Y17XAUU 49260000
         BNE   RES089D            NO                                    49600022
         OI    TOTFLG05,TOTSRCON  SET TRM ENTERED FROM SYSTEM  @Y17XAUU 49620000
*                                 CONSOLE FLAG                 @Y17XAUU 49640000
         SPACE                                                          49800022
*                                                              *        50000022
*        TRM ENTERED FROM SYSCON                               *        50200022
*                                                              *        50400022
RES089B  EQU   *                                                        50600022
RES089B1 EQU   *                                                SA41592 50900022
         LA    R7,AVTBFRTB        GET ADDR OF BUFFER RETURN QCB         51000022
         ST    R7,PRFKEY          PUT IT IN BUFFER BEING RETURNED       51200022
         MVI   PRFPRI,PRIBFRTB    PUT IN PRIORITY                       51400022
         ST    R10,TPOSTPAR+D4    SET UP POST                           51600022
         MVC   TPOSTPAR+D1(D3),TPOSTPAR+D5 ELEMENT                      51800022
         MVI   TPOSTPAR+D4,TPOSTE SHOW LAST BUFFER                      52000022
         MVI   TPOSTPAR,TPOSTA    SET FLAG                      SA41604 52100022
         LA    R1,TPOSTPAR        POINT TO PARAMETER LIST               52200022
*                                                                       52400022
         AQCTL                                                          52600022
         B     RESEXIT            EXIT                                  52800022
         SPACE 2                                                        53000022
RES089D  EQU   *                                                        53200022
*                                                              *        53400022
*        TRM ENTERED FROM REMOTE TERMINAL                      *        53600022
*                                                              *        53800022
         L     R7,PRFLCB-D1       GET REQ LINE LCB ADDR                 54000022
         ST    R7,REQLCB          SAVE IT                               54200022
         USING IEDQLCB,R7                                               54400022
         MVC   LCBLSPCI(D3),TOTOLTMQ+D1 PUT IN BUFFER ADDR              54600022
         MVI   LCBPRI,TRMPRI      SET PRIORITY                          54800022
         L     R8,LCBSCBA-D1      GET SCB ADDR                          55000022
         LA    R8,D0(R8)          CLEAR HIGH ORDER BYTE                 55200022
         USING IEDQSCB,R8                                               55400022
         LA    R4,AVTBFRTB        GET ADDR OF BFR RETURN QCB            55600022
         ST    R4,WORK2           SAVE IN WORK AREA                     55800022
         MVC   SCBDESTQ(D3),WORK2+D1 PUT IT IN SCB                      56000022
         L     R4,SCBMACR-D1      GET ADDR OF BFR HDR ENTRY             56200022
         LA    R4,D0(R4)          CLEAR HI ORDER BYTE                   56400022
         LA    R3,AVTINOUT        INEND/OUTEND PLIST ADDR               56800022
         ST    R3,DPARM           SAVE IT IN WORK AREA                  56850022
         MVC   SCBMACR(D3),DPARM+D1  PUT IN SCB                         56900022
         DROP  R8                                                       56950022
         L     R8,AVTMSGS-D1      GET VCON TABLE ADDR                   57000022
         LA    R8,D0(R8)          CLEAR HI ORDER BYTE                   57200022
         L     R8,D0(R8)          GET BD QCB ADDRESS                    57400022
         ST    R8,WORK2           SAVE IT                               57600022
         CLI   LCBRSKEY,ANR       REQ TERM = ANR LOCAL                  57800022
         BNE   RES089I            NO                                    58600022
         MVI   LCBTSTSW,XF0       SET LCB FLAG FOR ANR LOCAL            58800022
         SPACE                                                          59400022
RES089I  EQU   *                                                        59600022
         MVC   LCBQCBA(D3),WORK2+D1 PUT QCB ADDR FOR BD IN LCB          59700022
         ST    R7,TPOSTPAR        PUT LCB ADDR IN PLIST                 59800022
         ST    R7,TPOSTPAR+D4     PUT LCB ADDR IN PLIST                 60000022
         MVI   TPOSTPAR,POSTLCB   SET FLAG                              60200022
         MVI   TPOSTPAR+D4,TPOSTE SHOW LAST ELEMENT                     60400022
         LA    R1,TPOSTPAR        GET ADDRESS OF ELEMENT                60600022
         DROP  R7                                                       60800022
*                                                                       61000022
         AQCTL                    TPOST BUFFER TO BD                    61200022
         SPACE                                                          61400022
         L     R3,REQLCB          GET REQ LINE LCB ADDR                 61600022
         USING IEDQLCB,R3                                               61800022
         L     R9,LCBDCBPT        GET DCB ADDR                          62200022
         USING IHADCB,R9                                                62400022
         TM    DCBDSORG,LGBA      LGB VS. DCB                    S22024 62420000
         BZ    RES090             NO                             S22024 62440000
         LH    R1,TOTSROFF        GET SOURCE TTCIN             @Y17XAUU 62440500
         L     R15,AVTRNMPT       TTCIN TO TTE CONVERSION      @Y17XAUU 62441000
*                                 ROUTINE ADDRESS              @Y17XAUU 62441500
         BALR  R14,R15            GET SOURCE TTE ADDRESS       @Y17XAUU 62442000
         BAL   R14,NCPTTE         GET NCP TTE ADDRESS          @Y17XAUU 62442500
*                                                              @Y17XAUU 62443000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 62443500
*                                                              @Y17XAUU 62444000
         USING IEDNTRM,R1         SET TTE ADDRESSABILITY       @Y17XAUU 62444500
         L     R1,TRMDESTQ-D1     GET QCB ADDRESS              @Y17XAUU 62445000
         DROP  R1                                              @Y17XAUU 62445500
         USING IEDQQCB,R1                                      @Y17XAUU 62446000
         L     R9,QCBDCBAD-D1     GET 3705 DCB ADDRESS         @Y17XAUU 62446500
         DROP  R1                                              @Y17XAUU 62447000
RES090   EQU   *                                                 S22024 62560000
         SR    R15,R15            CLEAR REG                             62800022
         IC    R15,LCBUCBX        GET RLN                               63000022
         DROP  R3                                                       63200022
         LA    R14,D1(R15)        ADJUST RLN                            63400022
         L     R8,DCBDEBAD        PICK UP DEB ADDR                      63600022
         DROP  R9                                                S22024 63700000
         SLL   R15,D2             SET DISPLACEMENT                      63800022
         L     R8,D32(R15,R8)     PICK UP UCB ADDR FOR RQ LINE          64000022
         LA    R8,D0(R8)          CLEAR HI ORDER BYTE                   64200022
         STH   R8,TOTCTUCB        SAVE RQ UCB ADDR               S22024 64400000
         STC   R14,TOTCTRLN       SAVE RLN                       S22024 64600000
         EJECT                                                          64800022
RESEXIT  EQU   *                                                        64900022
         LA    R4,TOTTRMBF        SET TO XLATE TO UPPER CASE            65000022
         LA    R7,D9              SET LOOP COUNT                        65200022
RESTRAN  EQU   *                                                        65400022
         OC    D0(D8,R4),ORFLD    XLATE 8 BYTES                         65600022
         LA    R4,D8(R4)          POINT TO NEXT FIELD                   65800022
         BCT   R7,RESTRAN         XLATE NEXT FIELD                      66000022
         SPACE 4                                                        66200022
*                                                              *        66400022
*                                                              *        66600022
*        SET UP PARAMETERS TO PASS TO IEDQWC                   *        66800022
*                                                              *        67000022
*                                                              *        67200022
         XC    PLIST(D4),PLIST    CLEAR PARAMETER FIELD                 67400022
         MVC   PLIST(D1),NUMFLG   GET FLAG BYTE                         67600022
         MVC   PLIST+D2(D2),TRMSRCE GET INDEX TO TERMNAME TABLE         67800022
         L     R1,PLIST                                                 68000022
         L     R13,D4(R13)        RESTORE CALLER'S SAVE                 68060022
         LM    R14,R0,D12(R13)    RESTORE REG                   SA59008 68090022
         XCTL  (2,12),EP=IEDQWC   GO TO IEDQWC                          68120022
         EJECT                                                          68120522
****************************************************************        68121022
*        ROUTINE TO LOAD CDS RECORDS FOR CONTROL TERMINAL AND  *        68121522
*        ALTERNATE PRINTER TO DETERMINE IF THE DEVICE PROTECT  *        68122022
*        FEATURE IS SET. IF THE OPTION IS SET THE SYSTEM       *        68122522
*        OPERATOR WILL BE REQUESTED TO GIVE AUTHORIZATION      *        68123022
*        FOR USE OF TERMINALS.                                 *        68123522
****************************************************************        68124022
DEVPRT   EQU   *                                                        68124522
         TM    $ERROPT,$ALTPRNT   AP OPTION SET                         68125022
         BZ    DEVCT              NO - CHECK CT                         68125522
         TM    TOTFLG09,TOTAPCON+TOTAPOUT AP EQU SYSTEM DEVICE          68126022
         BNZ   DEVCT              YES - CHECK CT                        68126522
         SPACE                                                          68127022
         MVC   READNAME(D8),TOTAPNAM GET AP SYMBOLIC NAME               68127522
         BAL   R5,CDSCHK          LOAD CDS                              68128022
         SPACE                                                          68128522
DEVCT    EQU   *                                                        68129022
         MVI   READNAME,CAP       BLANK OUT NAME FIELD           S05331 68129100
         MVC   READNAME+D1(D7),READNAME  IN BLDL LIST            S05331 68129200
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE                 68129522
         BO    RESEND             YES - EXIT                            68130022
         LA    R4,TOTCTNAM        CT NAME                               68130522
         LA    R7,D0              INIT COUNTER                          68131022
DEVCT4   EQU   *                                                        68131522
         CLI   D0(R4),XBLANK      END OF CT NAME                        68132022
         BE    DEVCT12            YES                                   68132522
         LA    R7,D1(R7)          INCREMENT COUNTER                     68133022
         LA    R4,D1(R4)          NEXT CHAR                             68133522
         B     DEVCT4             CHECK NEXT CHAR                       68134022
DEVCT12  EQU   *                                                        68134522
         BCTR  R7,R0              DECREMENT COUNT FOR EXECUTE           68135022
         EX    R7,CTNAME          MOVE CT NAME TO BLDL PLIST            68135522
         BAL   R5,CDSCHK          LOAD CDS                              68136022
         SPACE                                                          68136522
****************************************************************        68137022
*        EXIT TO APPROPRIATE MODULE                            *        68137522
****************************************************************        68138022
RESEND   EQU   *                                                        68138522
         MVI   READNAME,CAP       BLANK OUT NAME FIELD           S05331 68138700
         MVC   READNAME+D1(D7),READNAME  IN BLDL LIST            S05331 68138900
         BAL   R5,OLTACT          SEND OLT ACTIVE MSG            S22024 68139200
         L     R13,D4(R13)        CALLER'S SAVE AREA                    68140022
         LM    R14,R0,D12(R13)    RESTORE REGS                          68140522
         TM    TOTFLG01,TOTCONFG  CONFIGURATOR REQUEST                  68141022
         BO    RESCON             YES - EXIT                            68141522
         BAL   R3,CDSENQ          ENQ CDS DATA SETS              S22024 68141700
         TM    TOTFLG01,TOTPRMPT  PROMPT REQUEST                 S22024 68142000
         BO    RESPROM            YES - EXIT                     S22024 68142500
         SPACE                                                          68143022
         XCTL  (2,12),EP=IEDQWC1  CONTINUE TRM PROCESSING               68143522
         SPACE                                                          68144022
RESCON   EQU   *                                                        68144522
         XCTL  (2,12),EP=IEDQWI   GO TO CONFIGURATOR                    68145022
         SPACE                                                          68145522
RESPROM  EQU   *                                                        68146058
         XCTL  (2,12),EP=IEDQWJ         GO TO PROMPTER                  68146158
         EJECT                                                          68146258
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@YA07679 68146358
*                                                             *@YA07679 68146458
*              SEND ON-LINE TESTING ACTIVE MESSAGE            *@YA07679 68146558
*                                                             *@YA07679 68146658
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@YA07679 68146758
OLTACT   EQU   *                                               @YA07679 68146858
         IEDQMSG MSGID=002,FUNCT=CEC   ISSUE THE MESSAGE       @YA07679 68149258
         MVC   TRMCTID(D2),TOTOLTID                                     68149700
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 68149900
         ST    R2,TMID+16                                               68150100
         TCONV FROM=TMID+16,TO=TMID+8,COUNT=4,TYPE=HE                   68150300
         MVC   TMID+16(4),TMID+21                                       68150500
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 68150700
         SPACE                                                          68151022
         IEDQMSG FUNCT=CEC,OTBUF=TMID,OTCNT=TMIDE-TMID                  68151522
         SPACE                                                          68152022
         BR    R5                 RETURN                                68152522
#EXIT    L     R15,$TABLE                                               68152600
         L     R15,28(R15)                                              68152700
         BR    R15                                                      68152800
         EJECT                                                          68153022
****************************************************************        68153522
*        GET AND EVALUATE CDS RECORD FOR AP/CT.                *        68154022
*        CHECK FOR DEVICE PROTECT FEATURE.                     *        68154522
****************************************************************        68155022
CDSCHK   EQU   *                                                        68155522
         BLDL  0,BLDLLIST         BUILD DIRECTOY ENTRY POINT LIST       68156022
         SPACE                                                          68156522
         LTR   R15,R15            WAS BUILD SUCCESSFUL                  68157022
         BZ    CDSLOAD            YES                                   68157522
         CH    R15,H4             RECORD FOUND                          68158022
         BE    D0(R5)             NO - EXIT                      S22024 68158500
****************************************************************        68159022
*        ASSUME I/O ERROR                                      *        68159522
****************************************************************        68160022
         IEDQMSG MSGID=041,FUNCT=CEC,LINK=YES                           68160522
         SPACE                                                          68161022
CDSERR   EQU   *                                                        68161522
         L     R13,D4(R13)        CALLER'S SAVE AREA                    68162022
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG             S22024 68162500
         LM    R14,R1,D12(R13)    RESTORE REGISTERS 14-1         S22024 68163000
         XCTL  (2,12),EP=IEDQWE   TERMINATE TRM                  S22024 68163500
         SPACE                                                          68164022
         SPACE                                                          68166022
CDSLOAD  EQU   *                                                        68166522
         LOAD  DE=READNAME        LOAD THE ENTRY                        68167022
         SPACE                                                          68167522
         LR    R8,R0              ENTRY POINT ADDR                      68168022
         MVC   CDSBFR(CDSLEN),D0(R8) SAVE ENTRY                         68168522
         DELETE DE=READNAME       DELETE THE ENTRY                      68169022
         SPACE                                                          68169522
         TM    CDSBFR+D10,RESDP   DEVICE PROTECTED                      68170022
         BZ    D0(R5)             NO - RETURN                           68170522
CDSDVP   EQU   *                                                 S22024 68170700
         MVC   DEVNAM(D8),READNAME PUT NAME IN MSG                      68171022
         MVC   MSG+D16(D8),READNAME MOVE NAME TO MSG                    68171522
         WTO   'IED213D CAN ON LINE TEST USE PROTECTED DEVICE',        *68172000
               ROUTCDE=10,DESC=7                                        68172522
         SPACE                                                          68173022
         XC    ECB(D4),ECB        CLEAR ECB                             68173522
         SPACE                                                          68174022
MSG      WTOR  '          (YES OR NO)',ANSWER,3,                       *68174522
               ECB,ROUTCDE=(8,10),DESC=2                                68175022
         SPACE                                                          68175522
         STIMER REAL,NOANS,DINTVL=TIMOUT SET TIMER FOR TIMEOUT          68176022
         SPACE                                                          68176522
         WAIT  ECB=ECB            WAIT FOR REPLY                        68177022
         SPACE                                                          68177522
         TTIMER CANCEL            CANCEL TIMER                          68178022
         SPACE                                                          68178522
         OI    ANSWER,CAP         XLATE RESPONSE TO CAP                 68179022
         CLI   ANSWER,YES         ANSWER YES                            68179522
         BE    D0(R5)             YES - RETURN                          68180022
         SPACE                                                          68180522
         MVC   REJMSG+D8(REJECTE-REJECTA),REJECTA MSG TO PLIST   S22024 68181200
REJMSG   WTO   '                                                       *68181300
                               ',ROUTCDE=10,DESC=7               S22024 68181400
         SPACE                                                          68181522
         B     CDSERR             EXIT                                  68182022
         EJECT                                                          68182522
****************************************************************        68183022
*        TIMER COMPLETION ROUTINE FOR WTOR                     *        68183522
****************************************************************        68184022
NOANS    EQU   *                                                        68184522
         STM   R14,R12,D12(R13)   SAVE CALLER'S REGS                    68185022
         LR    R4,R15             SET BASE                              68185522
         USING NOANS,R4                                                 68186022
         LA    R12,TRMSAV2        GET MY SAVE AREA ADDR                 68186522
         ST    R13,D4(R12)        SAVE HIS SAVE AREA ADDR               68187022
         ST    R12,D8(R13)        SAVE MY SAVE AREA ADDR                68187522
         LR    R13,R12            SET SAVE AREA POINTER                 68188022
         SPACE                                                          68188522
         POST  ECB                POST WTOR ECB                         68189022
         L     R13,D4(R13)        GET CALLER'S SAVE AREA ADDR           68189522
         LM    R14,R12,D12(R13)   RESTORE REGS                          68190022
         BR    R14                RETURN                                68190522
         DROP  R4                                                       68191022
         SPACE                                                          68192022
NUMERIC  EQU   *                                                SA41614 68193022
         NI    TOTFLG04,XFF-TOTNUMDV CLEAR NUMERIC ENTRY FLAG   SA41614 68194022
         BAL   R5,OLTACT          SEND ACTIVE MSG               SA41614 68195022
         L     R13,D4(R13)        RESTORE SAVE REG              SA41614 68196022
         LM    R14,R0,D12(R13)    RESTORE REG 14-0              SA41614 68197022
         XCTL  (2,12),EP=IEDQWH   EXIT TO NUMERIC HANDLER       SA41614 68198022
         EJECT                                                          68200022
**************************************************************** S22024 68400000
*        ENQUEUE CDS DATA SETS SHARED                          * S22024 68420000
**************************************************************** S22024 68440000
CDSENQ   DS    0H                 BOUNDARY ALLIGNMENT            S22024 68460000
         ENQ   ,MF=(E,ENQLIST)    REQUEST USE OF RESOURCE        S22024 68480000
         LTR   R15,R15            WAS IT ASSIGNED                S22024 68500000
         BZ    CDSENQE            YES                            S22024 68520000
         CLI   D3(R15),D8         WAS IT PREVIOUSLY ASSIGNED     S22024 68540000
         BE    CDSENQE            YES                            S22024 68560000
         SPACE                                                          68580000
         IEDQMSG MSGID=109,FUNCT=CEC CDS DATA SET IN             S05331 68600000
*                                 UNSHAREABLE STATE              S05331 68620000
         LA    R13,TOTSAVE4       MY SAVE AREA ADDR              S22024 68640000
         SPACE                                                          68645000
         B     CDSERR             CLEANUP EXIT                   S22024 68650000
CDSENQE  DS    0H                 BOUNDARY ALLIGNMENT            S22024 68680000
         LM    R14,R1,D12(R13)    RESTORE CALLER REG             S22024 68700000
         BR    R3                 RETURN                         S22024 68720000
         EJECT                                                          68720600
************************************************************** @Y17XAUU 68721200
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 68723000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE PREFIX* @Y17XAUU 68723600
*        ADDRESS. RETURN TO CALLER VIA REG 14 .        .       @Y17XAUU 68724200
************************************************************** @Y17XAUU 68726000
NCPTTE   EQU   *                                               @Y17XAUU 68726600
         ST    R14,TRMSAVE2       SAVE RETURN ADDRESS          @Y17XAUU 68727200
         L     R14,AVTRNMPT       TTCIN TO TTE CONVERSION      @Y17XAUU 68729000
*                                 ROUTINE ADDRESS              @Y17XAUU 68729600
         LA    R8,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 68730200
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 68732000
         USING IEDNTRM,R1         SET TTE ADDRESSABILITY       @Y17XAUU 68732600
NCPLOOP  EQU   *                                               @Y17XAUU 68733200
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 68735000
         L     R15,AVTRNMPT       TTCIN TO TTE CONVERSION      @Y17XAUU 68735600
*                                 ROUTINE ADDRESS              @Y17XAUU 68735900
         BALR  R14,R15            FIND TTE ADDRESS             @Y17XAUU 68736200
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 68738000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 68738600
         BNE   NCPLOOP            NO - CHECK NEXT ENTRY        @Y17XAUU 68740000
         L     R14,TRMSAVE2       RESTORE RETURN ADDRESS       @Y17XAUU 68743000
         BR    R14                RETURN TO CALLER             @Y17XAUU 68746000
         DROP   R1                                             @Y17XAUU 68749000
         EJECT                                                          68752000
**************************************************************** S22024 68755000
*        C O N S T A N T S                                     * S22024 68780000
**************************************************************** S22024 68800000
PLIST    DS    F                  PLACE FOR IEDQWC PARAMETERS           69000022
REQLCB   DS    F                  REQUEST LINE LCB                      69200022
*                                                                       69400022
TPOSTPAR DS    0F                 TPOST PARMLIST                 S22024 69600000
         DC    X'0C'              FIRST ELEMENT FLAG             S22024 69640000
         DC    AL3(0)             FIRST ELEMENT                  S22024 69680000
         DC    X'80'              LAST ELEMENT FLAG              S22024 69720000
         DC    AL3(0)             LAST ELEMENT                   S22024 69760000
WORK2    DS    F                  WORK AREA                             69800022
WORK5    DS    F                  WORK AREA                             70000022
*                                                                       70200022
PATCH    DC    100XL1'40'         PATCH AREA                            70400022
*                                                                       70600022
TRMSRCE  DS    H                  INDEX TO TERMNAME TABLE               70800022
TRMTST   DC    H'72'              TRM BUFFER LENGTH                     71000022
X0100    DC    X'0100'            MASK SETTING FOR SCB                  71200022
ORFLD    DC    8XL1'40'           BLANK FIELD                           71400022
NUMER    DC    2CL1'9'            NUMERIC TRM PREFIX                    71600022
*                                                                       71800022
THREE    DC    X'03'              VALUE OF 3                            72000022
NUMFLG   DC    X'00'              PROGRAM FLAG                          72200022
TRMKEY   DC    X'00'              PROGRAM FLAG                          72400022
*                                                                       72600022
ENQLIST  ENQ   (QNAME,RNAME,S,8,STEP),RET=USE,MF=L ENQ PLIST     S22024 72640000
         SPACE                                                          72680000
QNAME    DC    CL8'CDSLIB'        MAJOR NAME                     S22024 72720000
RNAME    DC    CL8'OLT2LIB'       MINOR NAME                     S22024 72760000
ENDTEST  TM    THREE,D0           TEST FOR LAST BUFFER UNIT             72800022
TRMMOVE  MVC   D0(D0,R3),D0(R14)  MOVE TRM TO BUFFER                    73000022
DPARM    DS    F                  WORK AREA                             73006022
         SPACE                                                          73036022
ECB      DC    F'0'               ECB                                   73042022
TRMSAV2  DS    18F                TIMER RTN SAVE AREA                   73048022
TRMSAVE2 DS    F                  REGISTER SAVE AREA           @Y17XAUU 73049000
H4       DC    H'4'               VALUE OF 4                            73054022
         DS    0F                  ALIGN ON FULLWORD             S22024 73057000
*                                 THE FOLLOWING MESSAGE GIVES    S22024 73060000
*                                 THE ID OF THE OLT RUNNING      S22024 73061000
TMID     DC    C'IED335I                   ***CONTROL TERMINAL ID IS' * 73062000
         DC    X'40'              BLANK CHAR                     S22024 73063000
TRMCTID  DC    CL5'XX***'         MESSAGE TO PRINT CT ID                73066022
TMIDE    DS    0C                 END OF MESSAGE                        73072022
ANSWER   DS    CL3                RESPONSE BUFFER                       73078022
REJECTA  DC    C'IED345I '        MSG ID                         S22024 73081000
*                                 THE FOLLOWING MESSAGE REJECTS  S22024 73084000
*                                 THE OLT REQUEST                S22024 73086000
REJECT   DC    C'TRM REJECTED - OLT CAN NOT USE PROTECTED DEVICE' MSG   73088000
SPACE    DC    X'40'              SPACE                                 73090022
DEVNAM   DC    8XL1'40'           DEVICE NAME                           73096022
REJECTE  DS    0C                 END OF MESSAGE                        73102022
TIMOUT   DC    X'F0F0F0F3F0F0F0F0' TIMER FOR WTOR                       73108022
*                                                                       73114022
BLDLLIST DS    0F                 BLDL PARAMETER LIST                   73120022
         DC    XL2'0001'          NUMBER OF LIST ENTRIES                73126022
         DC    XL2'003A'          LENGTH OF EACH ENTRY                  73132022
READNAME DC    8XL1'40'           TERMINAL NAME                         73138022
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO             73144022
CORNEED  DC    XL3'0'             MAIN STORAGE NEEDED FOR ENTRY         73150022
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO             73156022
CDSBFR   DS    CL256              CDS BUFFER                            73162022
CTNAME   MVC   READNAME(D0),TOTCTNAM MOVE CONTROL TERM NAME      S22024 73168000
ADDRESS  DC    F'0'               ADDRESS OF TERMINAL ENTRY    @YA07679 73176058
TERNMTAB DS    A                  SAVE AREA                    @Y17XAUU 73176500
         EJECT                                                          73178058
         TTRMD                                                 @YA07679 73180058
         EJECT                                                          73182000
         TLGBD                                                   S22024 73190000
         EJECT                                                          73200022
         OLTCB                                                          73400022
         EJECT                                                          73600022
         TQCBD                                                          73800022
         EJECT                                                          74000022
         TSCBD                                                          74200022
         EJECT                                                          74400022
         TLCBD                                                          74600022
         EJECT                                                          74800022
RESPL    RESPL                                                          75000022
         EJECT                                                          75200022
         TAVTD                                                          75400022
         EJECT                                                          75600022
         TPRFD                                                          75800022
         EJECT                                                          76000022
         TPRIOR                                                         76200022
         EJECT                                                          76400022
DCBDSECT DCBD  DSORG=TX                                                 76600022
         END                                                            76800022
