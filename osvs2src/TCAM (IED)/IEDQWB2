         TITLE 'IEDQWB2 - TOTE DUMMY TNT PROCESSOR'                     00100000
IEDQWB2  CSECT                                                          00200000
*A000000-999999                                                @Y16X5U0 00220000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00250000
*A428500          MOVE 425650 AFTER 428500                     @YA10965 00250158
*A169800,192000,204000,210400,210600,216400,285400,315000      @Y17XAUU 00257100
*A348400,382000,383000,391500,411200,411500,422400,425500      @Y17XAUU 00264100
*A431400,443400,498000,504000,593000,621000,695000,726500      @Y17XAUU 00271100
*A757000,761000,763000                                         @Y17XAUU 00278100
*C182500-182600,205000,608000-611000,670000,672000,            @Y17XAUU 00285100
*C756000-757000                                                @Y17XAUU 00292100
* A002921,210770,672000                                        @G36XRUV 00293100
* C210770                                                      @G36XRUV 00294100
*                                                                       00295100
         SPACE 2                                                        00300000
         USING IEDQWB2,R15                                              00400000
IEDQWB2  IEDHJN STARB2,HJN                                              00500000
         SPACE 2                                                        00600000
****************************************************************        00700000
*                                                              *        00800000
* MODULE NAME = IEDQWB2 (TCAM,TOTE)                            @Y17XAUU 00830000
*                                                              * S22024 00840000
* DESCRIPTIVE NAME = TOTE DUMMY TNT PROCESSOR                  @Y17XAUU 00845000
*                                                              * S22024 00860000
* COPYRIGHT = NONE                                             * S22024 00870000
*                                                              * S22024 00880000
* STATUS --                                                    *        00900000
*                                                              *        01000000
*    VERSION 10.0                                              @Y17XAUU 01100011
*                                                              *        01200000
* FUNCTION --                                                  *        01300000
*                                                              *        01400000
*    THE PURPOSE OF THIS ROUTINE IS TO BUILD DUMMY TNT ENTRIES *        01500000
*    FOR REMOTE TERMINALS SERVING AS CONTROL TERMINALS OR AS   *        01600000
*    ALTERNATE PRINTERS OR AS SNA TEST LU'S.                   @Y17XAUU 01700000
*                                                              *        01800000
*    THIS ROUTINE HAS TWO ENTRY POINTS. IEDQWB2 IS THE FIRST   *        01900000
*    ENTRY POINT. DURING THE FIRST PASS THE AMOUNT OF CORE     *        02000000
*    NEEDED BY TOTE TO BUILD DUMMY ENTRIES FOR A SINGLE REMOTE *        02100000
*    STATION IS CALCULATED. AT THIS POINT CONTROL IS RETURNED  *        02200000
*    TO THE CALLING PROGRAM TO REQUEST THE CORE. (IEDQWB2      *        02300000
*    BUILDS THE REQUEST ELEMENT FOR THE CORE NEEDED IN THE     *        02400000
*    OLTCB.) THE CALLING PROGRAM THEN ISSUES A POST TO IEDQWB  *        02500000
*    FOR THE CORE.                                             *        02600000
*                                                              *        02700000
*    IF THE REQUEST TO IEDQWB IS HONORED SUCCESSFULLY, CONTROL *        02800000
*    IS RETURNED TO THIS MODULE AT THE SECOND ENTRY POINT,     *        02900000
*    IEDQWB3. DURING THE SECOND PASS THE REAL ENTRIES FOR      *        03000000
*    THE SPECIFIED REMOTE TERMINALS ARE COPIED INTO THE AREA   *        03100000
*    OBTAINED BY IEDQWB. THE INITIAL STATUS OF REMOTE TERMINAL *        03200000
*    AND LINE ARE SAVED IN THE OLTCB.                          *        03300000
*                                                              *        03400000
* ENTRY POINTS --                                              *        03500000
*                                                              *        03600000
*    IEDQWB2 - TO CALCULATE THE AMOUNT OF CORE NEEDED TO BUILD *        03700000
*    DUMMY ENTRIES FOR A SPECIFIED REMOTE TERMINAL.            *        03800000
*                                                              *        03900000
*    IEDQWB3 - TO COPY THE REAL ENTRIES INTO THE DUMMY AREA    *        04000000
*    AND TO SET THE INITIAL STATUS FLAGS FOR THE TERMINALS.    *        04100000
*                                                              *        04200000
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 04207000
*                                                              @Y17XAUU 04214000
* MODULE TYPE = PROCEDURE                                      @Y17XAUU 04221000
*                                                              @Y17XAUU 04228000
* MODULE SIZE = 4K MAXIMUM                                     @Y17XAUU 04235000
*                                                              @Y17XAUU 04242000
* PROCESSOR = ASSEMBLER XF                                     @Y17XAUU 04249000
*                                                              @Y17XAUU 04256000
* LINKAGE = LINKED TO FROM IEDQWC,IEDQWJ2,IEDQWE,IEDQWV        @Y17XAUU 04263000
*                                                              @Y17XAUU 04270000
* MACROS = IEDHJN,AQCTL,SAVE,WAIT                              @Y17XAUU 04277000
*                                                              @Y17XAUU 04284000
* INPUT --                                                     *        04300000
*                                                              *        04400000
*    REGISTERS 02,12,13,14,15 CONTAIN THE FOLLOWING VALUES:    *        04500000
*                                                              *        04600000
*    02 - OLTCB POINTER                                        *        04700000
*    12 - BASE FOR PARAMETER LIST PASSED                       *        04800000
*    13 - SAVE AREA ADDRESS                                    *        04900000
*    14 - RETURN ADDRESS                                       *        05000000
*    15 - ENTRY POINT ADDRESS                                  *        05100000
*                                                              *        05200000
* OUTPUT --                                                    *        05300000
*                                                              *        05400000
*    REGISTER 15 CONTAIN A RETURN CODE:                        *        05500000
*                                                              *        05600000
*    X'00' - OPERATION COMPLETED SUCCESSFULLY                  *        05700000
*    X'04' - ERROR IN BUILDING DUMMY ENTRIES                   *        05800000
*                                                              *        05900000
* EXTERNAL REFERENCES --                                       *        06000000
*                                                              *        06100000
*    NONE                                                      *        06200000
*                                                              *        06300000
* EXITS,NORMAL --                                              *        06400000
*                                                              *        06500000
*    BRANCH REGISTER 14 TO CALLING PROGRAM WITH A ZERO RETURN  *        06600000
*    CODE.                                                     *        06700000
*                                                              *        06800000
* EXITS,ERROR --                                               *        06900000
*                                                              *        07000000
*    BRANCH REGISTER 14 TO CALLING PROGRAM WITH A FOUR RETURN  *        07100000
*    CODE.                                                     *        07200000
*                                                              *        07300000
* TABLES/WORK AREAS --                                         *        07400000
*                                                              *        07500000
*    OLTCB,AVT,TNT,TTE,QCB,DRQ,QCBE,PARAMETER LIST             *        07600000
*    LGB                                                       @Y17XAUU 07650000
*                                                              *        07700000
* ATTRIBUTES --                                                *        07800000
*                                                              *        07900000
*    ENABLED,PROBLEM PROGRAM MODE,TRANSIENT                    *        08000000
*                                                              *        08100000
* NOTES -- SEE BELOW                                           @Y17XAUU 08200000
*                                                              @Y17XAUU 08210000
*  DEPENDENCIES = EBCDIC CHARACTER CODE                        @Y17XAUU 08220000
*                                                              @Y17XAUU 08230000
*  REGISTERS CONVENTION = SEE REGISTERS ASSIGNMENT             @Y17XAUU 08240000
*                                                              @Y17XAUU 08250000
*  RESTRICTIONS = NONE                                         @Y17XAUU 08260000
*                                                              @Y17XAUU 08270000
*  PATCH LABEL = PATCH                                         @Y17XAUU 08280000
*                                                              *        08300000
*                                                              *        08500000
****************************************************************        08600000
         EJECT                                                          08700000
*********************************************************************** 08800000
*                                                                     * 08900000
*        EQUATES                                                      * 09000000
*                                                                     * 09100000
*********************************************************************** 09200000
         SPACE 2                                                        09300000
R0       EQU   0                  REG 0                                 09400000
R1       EQU   1                  REG 1                                 09500000
R2       EQU   2                  OLTCB POINTER/SCT POINTER             09600000
R3       EQU   3                  REG 3                                 09700000
R4       EQU   4                  REG 4                                 09800000
RAVT     EQU   4                  AVT BASE                     @Y17XAUU 09850000
R5       EQU   5                  REG 5                                 09900000
R6       EQU   6                  BASE REG                              10000000
R7       EQU   7                  REG 7                                 10100000
RSAVT    EQU   7                  SAVT BASE                    @Y17XAUU 10150000
R8       EQU   8                  REG 8                                 10200000
R9       EQU   9                  REG 9                                 10300000
R10      EQU   10                 REG 10                                10400000
R11      EQU   11                 REG 11                                10500000
R12      EQU   12                 REG 12                                10600000
R13      EQU   13                 SAVE AREA POINTER                     10700000
R14      EQU   14                 RETURN ADDR                           10800000
RSIB     EQU   14                 SIB BASE                     @Y17XAUU 10850000
R15      EQU   15                 ENTRY POINT ADDR                      10900000
         SPACE 2                                                        11000000
XFF      EQU   X'FF'              MASK SETTING                          11100000
XF0      EQU   X'F0'              LCB MASK FOR ANR LOCAL                11200000
ANR      EQU   X'1E'              REQ TERM = ANR LO                     11300000
ACTVBCD  EQU   X'46'              OP CONTROL ACTIVATE CMMD              11400000
ACTRTCD  EQU   X'08'              INVITATION LIST ACTIVE RT CD          11500000
INACT    EQU   X'48'              INACTIVATE VERB CODE                  11530000
INACTRC  EQU   X'08'              TERMINAL ALREADY INACT RC             11560000
D0       EQU   0                  DISP OF 0                             11600000
D1       EQU   1                  DISP OF 1                             11700000
D2       EQU   2                  DISP OF 2                             11800000
D3       EQU   3                  DISP OF 3                             11900000
D4       EQU   4                  DISP OF 4                             12000000
D5       EQU   5                  DISP OF 5                             12100000
D6       EQU   6                  DISP OF 6                             12200000
D7       EQU   7                  DISP OF 7                             12300000
D8       EQU   8                  DISP OF 8                             12400000
D9       EQU   9                  DISP OF 9                             12500000
D10      EQU   10                 DISP OF 10                            12600000
D11      EQU   11                 DISP OF 11                            12700000
D12      EQU   12                 DISP OF 12                            12800000
D13      EQU   13                 DISP OF 13                            12900000
D14      EQU   14                 DISP OF 14                            13000000
D15      EQU   15                 DISP OF 15                            13100000
D16      EQU   16                 DISP OF 16                            13200000
D20      EQU   20                 DISP OF 20                            13300000
D22      EQU   22                 DISP OF 22                            13350000
D24      EQU   24                 DISP OF 24                            13400000
D28      EQU   28                 DISP OF 28                            13500000
D32      EQU   32                 DISP OF 32                            13600000
ACVT     EQU   16                 POINTER TO CVT ADDRESS                13700000
PRETERM  EQU   X'52'              DISP TO 1ST ENTRY IN TABLE            13800000
TRMAX    EQU   72                 TRM BUFFER LENGTH                     13900000
SLASH    EQU   X'61'              A / CHAR                              14000000
COMMA    EQU   X'6B'              A , CHAR                              14100000
D17      EQU   17                 DISP OF 17                            14200000
D18      EQU   18                 DISP OF 18                            14300000
X40      EQU   X'40'              A BLANK CHAR                          14400000
XE0      EQU   X'E0'              QCB MASK SETTING                      14500000
DEFLEV   EQU   X'03'              DPRINT DEFAULT LEVEL                  14600000
PARMREG0 EQU   0                  REG 0                                 14700000
PARMREG1 EQU   1                  REG 1                                 14800000
D72      EQU   72                 LENGTH OF TRM BUFFER                  14900000
XBLANK   EQU   X'61'              A SLASH CHAR                          15000000
TWO      EQU   2                  DISP OF TWO                           15100000
FOUR     EQU   4                  DISP OF FOUR                          15200000
TRMSCCT  EQU   X'10'              SECONDARY SYSTEM CONSOLE ENTRY ?      15300000
XFO      EQU   X'F0'              NUMERIC TESTER                        15400000
X52      EQU   X'52'              1060 CT FLAG                          15500000
X18      EQU   X'18'              DISP OF 24                            15600000
X24      EQU   X'24'              DISP OF 36                            15700000
X1C      EQU   X'1C'              DISP OF 28                            15800000
X10      EQU   X'10'              DCB OPEN FLAG                         15900000
X80      EQU   X'80'              LAST DUMMY ENTRY RQ FLAG              16000000
X14      EQU   X'14'              DISP OF 20                            16100000
X07      EQU   X'07'              LINE STOPPED FLAG                     16200000
HOLD     EQU   X'88'              'HOLD' OPERATOR CONTROL VERB CODE     16300000
RELEASE  EQU   X'87'              RELEASE VERB CODE            @Y17XAUU 16350000
UCB1060  EQU   X'52'              UCB SETTING FOR 1060 TERMINAL         16400000
ZERO     EQU   X'00'              CONSTANT VALUE                        16500000
PROMPTFL EQU   X'01'              PROMPTER RQ FLAG                      16600000
CONFIGFL EQU   X'02'              INDICATES CONFIGURATOR REQUEST        16700000
TRMMAX   EQU   256                MAXIMUM LENGTH OF TRM                 16800000
ERRCD4   EQU   X'04'              ERROR RETURN CODE                     16900000
ERRCD8   EQU   8                  LU ERROR RETURN CODE         @XM05678 16920000
HELDN    EQU   X'04'              HOLD MODE                             16950000
SHFTBIT  EQU   128                BIT TESTER                            16960000
RQINIT   EQU   X'0C'              START OF LIST                         16970000
RQEND    EQU   X'80'              END OF LIST                           16980000
LGBSZ    EQU   X'40'              LGB SIZE                     @Y17XAUU 16985000
MAXRUSIZ EQU   256                MAXIMUM RU SIZE              @YM08523 16986000
ADRMSK3  EQU   3                  ADDRESS MASK                 @YM08410 16987000
ADRMSK7  EQU   7                  ADDRESS MASK                 @Y17XAUU 16990000
ADRMSKF  EQU   15                 ADDRESS MASK                 @Y17XAUU 16995000
         EJECT                                                          17000000
         SAVE  (14,12)                                                  17100000
         SPACE                                                          17200000
         DROP  R15                                                      17300000
         LR    R6,R15                   LOAD BASE                       17400000
         USING KTRM,R12                                                 17500000
         USING TOTOLTCB,R2                                              17600000
         USING IEDQWB2,R6                                               17700000
         SPACE 2                                                        17800000
         LA    R3,QWB2SAVE        MY SAVE AREA                          17900000
         ST    R3,D8(R13)         STORE IN CALLER'S SAVE AREA           18000000
         ST    R13,D4(R3)         SAVE MY SAVE AREA ADDR                18100000
         LR    R13,R3                   SET R13 TO SAVE AREA            18200000
         SPACE                                                          18210000
         L     R5,TOTAVTPT        AVT ADDRESS                           18220000
         USING IEDQAVTD,R5                                              18230000
         LA    R7,AVTOPCOB        OP CONTROL QCB ADDRESS                18240000
         ST    R7,TOTOQCBA-D1     PUT IN P-LIST                @Y17XAUU 18250000
         MVI   TOTOKEY,D0         SET KEY FIELD                @Y17XAUU 18260000
         DROP  R5                                                       18270000
         SPACE 2                                                        18300000
         TM    TRMFLG01,TRMQWB3   SECOND PASS                           18400000
         BO    IEDQWB3            YES - BRANCH                          18500000
         SPACE 2                                                        18600000
****************************************************************        18700000
*        ROUTINE TO CALCULATE THE AMOUNT OF CORE NEEDED TO     *        18800000
*        COPY DUMMY ENTRIES FOR A REMOTE TERMINAL.             *        18900000
****************************************************************        19000000
DUMMYTNT EQU   *                                                        19100000
*        SET REQUEST ELEMENT FLAGS                                      19200000
         LA    R5,TOTWKSPC        ADDRESS OF WORK AREA         @Y17XAUU 19201000
         USING RQTNTENT,R5        SET REQUEST ELEMENT BASE     @Y17XAUU 19202000
         TM    TRMRQFLG,CTREQ     CT REQUEST                   @Y17XAUU 19203000
         BZ    DUMAPCHK           NO - CHECK AP REQUEST        @Y17XAUU 19204000
         MVI   RQTNTTYP,RQTNTCT   SET CT FLAG IN REQ ELEMENT   @Y17XAUU 19205000
         B     DUMRQGO            COMPLETE REQ ELEMENT SET UP  @Y17XAUU 19206000
         SPACE                                                          19207000
DUMAPCHK EQU   *                                               @Y17XAUU 19208000
         TM    TRMRQFLG,APREQ     AP REQUEST                   @Y17XAUU 19209000
         BZ    DUMPRCHK           NO - CHECK PRI TD REQUEST    @Y17XAUU 19210000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSCON                @Y17XAUU 19211000
         BO    DUMAPBD            YES - GO SET AP REQUEST      @Y17XAUU 19212000
         CLC   TOTCRTNT+D1(D3),TOTARTNT+D1 CT EQU AP           @YM08562 19212500
         BNE   DUMAPBD            NO - GO SET AP REQUEST       @Y17XAUU 19214000
         OI    TRMFLG01,TRMCTEAP  SHOW CT EQU AP               @Y17XAUU 19215000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19216000
DUMAPBD  EQU   *                                               @Y17XAUU 19217000
         MVI   RQTNTTYP,RQTNTAP   SET AP FLAG IN REQ ELEMENT   @Y17XAUU 19218000
         B     DUMRQGO            COMPLETE REQ ELEMENT SET UP  @Y17XAUU 19219000
         SPACE                                                          19220000
DUMPRCHK EQU   *                                               @Y17XAUU 19221000
         TM    TRMRQFLG,PRREQ     PRIMARY TD REQUEST           @Y17XAUU 19222000
         BZ    DUMSCCHK           NO - CHECK SEC TD REQUEST    @Y17XAUU 19223000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSCON                @Y17XAUU 19224000
         BO    DUMPRAP            YES - CHECK AP               @Y17XAUU 19225000
         CLC   TOTCRTNT+D1(D3),TOTTNTPR+D1 CT EQU PRIMARY TD   @YM08562 19225500
         BNE   DUMPRAP            NO - CHECK AP                @Y17XAUU 19227000
         MVC   TOTPRENT(TOTCTEND-TOTCTENT),TOTCTENT SET UP     @Y17XAUU 19228000
*                                 PRIMARY TEST DEVICE FIELDS   @Y17XAUU 19229000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19230000
*                                 COMPLETE                     @Y17XAUU 19231000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19232000
         SPACE                                                          19233000
DUMPRAP  EQU   *                                               @Y17XAUU 19234000
         TM    TOTFLG09,TOTAPCON+TOTAPOUT AP EQU SYSCON/SYSOUT @Y17XAUU 19235000
         BNZ   DUMPRBD            YES - GO SET PRI TD REQ      @Y17XAUU 19236000
         TM    TOTFLG09,TOTCTCON+TOTPRECT CT EQU SYSCON AND AP          19236200
*                                 DEFAULTED                    @YM08474 19236400
         BO    DUMPRBD            YES - GO SET PRI TD REQ      @YM08474 19236600
         CLC   TOTARTNT+D1(D3),TOTTNTPR+D1 AP EQU PRIMARY TD   @YM08562 19236800
         BNE   DUMPRBD            NO - GO SET PRI TD REQ       @Y17XAUU 19238000
         MVC   TOTPRENT(TOTAPEND-TOTAPENT),TOTAPENT SET UP     @Y17XAUU 19239000
*                                 PRIMARY TEST DEVICE FIELDS   @Y17XAUU 19240000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19241000
*                                 COMPLETE(APPLIES TO QWE/QWV) @Y17XAUU 19242000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19243000
DUMPRBD  EQU   *                                               @Y17XAUU 19244000
         MVI   RQTNTTYP,RQTNTPR   SET PRI TD FLAG IN REQUEST   @Y17XAUU 19245000
*                                 ELEMENT                      @Y17XAUU 19246000
         B     DUMRQGO            COMPLETE REQ ELEMENT SET UP  @Y17XAUU 19247000
         SPACE                                                          19248000
DUMSCCHK EQU   *                                               @Y17XAUU 19249000
         TM    TRMRQFLG,SCREQ     SECONDARY TD REQUEST         @Y17XAUU 19250000
         BZ    DUMHR              NO - RETURN TO CALLER        @Y17XAUU 19251000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSCON                @Y17XAUU 19252000
         BO    DUMSCAP            YES - CHECK AP               @Y17XAUU 19253000
         CLC   TOTCRTNT+D1(D3),TOTSRTNT+D1 CT EQU SECONDARY TD @YM08562 19253500
         BNE   DUMSCAP            NO - CHECK AP                @Y17XAUU 19255000
         MVC   TOTSCENT(TOTCTEND-TOTCTENT),TOTCTENT SET UP     @Y17XAUU 19256000
*                                 SECONDARY TEST DEVICE FIELDS @Y17XAUU 19257000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19258000
*                                 COMPLETE                     @Y17XAUU 19259000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19260000
DUMSCAP  EQU   *                                               @Y17XAUU 19261000
         TM    TOTFLG09,TOTAPCON+TOTAPOUT AP EQU SYSCON/SYSOUT @Y17XAUU 19262000
         BNZ   DUMSCBD            YES - GO SET SEC TD REQ      @Y17XAUU 19263000
         CLC   TOTARTNT+D1(D3),TOTSRTNT+D1 AP EQU SECONDARY TD @YM08562 19263500
         BNE   DUMSCBD            NO - GO SET SEC TD REQ       @Y17XAUU 19265000
         MVC   TOTSCENT(TOTAPEND-TOTAPENT),TOTAPENT SET UP     @Y17XAUU 19266000
*                                 SECONDARY TEST DEVICE FIELDS @Y17XAUU 19267000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19268000
*                                 COMPLETE                     @Y17XAUU 19269000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19270000
DUMSCBD  EQU   *                                               @Y17XAUU 19271000
         MVI   RQTNTTYP,RQTNTSC   SET SEC TD FLAG IN REQUEST   @Y17XAUU 19272000
*                                 ELEMENT                      @Y17XAUU 19273000
         SPACE                                                          19274000
DUMRQGO  EQU   *                                               @Y17XAUU 19275000
         MVI   RQTNTFGS,RQTNTLST  INDICATE LAST ENTRY          @Y17XAUU 19276000
         DROP  R5                                              @Y17XAUU 19277000
         SPACE                                                          19278000
         OI    TOTFLG10,TOTTNTRQ+TOTOLTRS  SET REQUEST/RESTART FLAGS    20200000
*                                                                       20300000
         L     R11,TNTENTRY       GET TTE ADDRESS                       20400000
         LA    R8,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 20430000
         SLR   R11,R8             POINT TO TTE PREFIX          @Y17XAUU 20460000
         USING IEDNTRM,R11        SET TTE ADDRESSABILITY       @Y17XAUU 20500000
         L     R8,TRMDESTQ-D1     GET QCB ADDRESS                       20600000
         LA    R8,D0(R8)          CLEAR HI-ORDER BYTE                   20700000
         ST    R8,TRMQCB          SAVE IT                               20800000
         USING IEDQQCB,R8                                               20900000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 20950000
         BZ    DUM2A              NO                                    21040000
         L     R1,TOTRESPL        GET RESIDENT CONTROL BLK ADDR@Y17XAUU 21042000
         USING RESPL,R1           SET RESPL ADDRESSABILITY     @Y17XAUU 21044000
         L     R1,RESTOTMH        GET TOTE MH ADDRESS          @Y17XAUU 21046000
         DROP  R1                                              @Y17XAUU 21048000
         LTR   R1,R1              WAS MH GEN'ED                @Y17XAUU 21050000
         BZ    DUMFAIL            NO - TERMINATE REQUEST       @Y17XAUU 21052000
         OI    TRMFLG01,TRM3705   YES - SHOW IT                         21060000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 21060500
         BNE   DUM2A              NO                           @Y17XAUU 21061000
         OI    TRMFLG01,TRMRNLU   SET LU FLAG                  @Y17XAUU 21061500
************************************************************** @Y17XAUU 21062000
*        VERIFY THAT LU IS IN A STATE WHERE BY TOTE          * @Y17XAUU 21062500
*        CAN USE THE DEVICE:                                 * @Y17XAUU 21063000
*        (1) AN SSCP-LU SESSION EXISTS AND                   * @Y17XAUU 21063500
*        (2) NO LU-LU SESSION EXISTS                         * @Y17XAUU 21064000
************************************************************** @Y17XAUU 21064500
         SLR   R1,R1              CLEAR REG                    @Y17XAUU 21064600
         IC    R1,TOTTTBEL        GET NAME LENGTH              @Y17XAUU 21064700
         BCTR  R1,R0              ADJUST LENGTH                @Y17XAUU 21064800
         L     R7,TRMTNT          GET TNT ADDRESS              @Y17XAUU 21064900
         EX    R1,TTENAME         COPY SYMBOLIC NAME           @ZM47913 21065011
         MVI   TOTOVBCD,HOLD      SET HOLD VERB CODE           @Y17XAUU 21065200
         MVC   TOTOLADR(D8),WORK1 SET RESOURCE NAME            @Y17XAUU 21065500
         MVC   TOTORLN(D1),QCBRELLN SET RLN                    @Y17XAUU 21066000
         BAL   R14,OPCREQ         ISSUE HOLD TERMINAL          @Y17XAUU 21066500
         CLI   TOTORTCD,ERRCD4    ERROR RETURN                 @Y17XAUU 21067000
         BE    DUMER1             YES - TERMINATE REQUEST      @XM05678 21067200
         SLR   RSIB,RSIB          CLEAR REG                    @Y17XAUU 21068000
         ICM   RSIB,ADRMSK7,TRMSIBPT SIB CHAIN POINTER         @Y17XAUU 21068500
         BZ    DUMER0             ERROR - NO SSCP-LU SESSION   @XM05678 21068700
         USING IEDSIBD,RSIB       SET SIB ADDRESSABILITY       @Y17XAUU 21069500
         L     RAVT,TOTAVTPT      GET AVT ADDRESS              @Y17XAUU 21070000
         USING IEDQAVTD,RAVT      SET AVT ADDRESSABILITY       @Y17XAUU 21070500
         ICM   RSAVT,ADRMSKF,AVTSAVTP GET SAVT ADDRESS         @Y17XAUU 21071000
         LA    RSAVT,D0(RSAVT)    CLEAR FLAG FIELD             @Y17XAUU 21071500
         USING IEDNSVTD,RSAVT     SET SAVT ADDRESSABILITY      @Y17XAUU 21072000
         CLC   SIBINDEX,SAVTSCPT  IF TTCIN EQU SSCP TTCIN THEN @Y17XAUU 21072500
*                                 ONLY AN SSCP-LU SESSION      @Y17XAUU 21073000
*                                 EXIST                        @Y17XAUU 21073500
         BE    DUM2A              YES - CONTINUE PROCESSING    @Y17XAUU 21074000
         DROP  RSAVT                                           @Y17XAUU 21074500
DUMER0   EQU   *                                               @XM05678 21074700
         MVI   TOTOVBCD,RELEASE   SET RELEASE VERB CODE        @Y17XAUU 21075000
         MVC   TOTOLADR(D8),WORK1 SET RESOURCE NAME            @Y17XAUU 21075500
         MVC   TOTORLN(D1),QCBRELLN SET RLN                    @Y17XAUU 21076000
         BAL   R14,OPCREQ         RELEASE RESOURCE             @Y17XAUU 21076500
DUMER1   EQU   *                                               @XM05678 21076700
         L     R14,TRMBYTE2       WORD CONTAINS TRMSTOTE FLAG  @G36XRUV 21077000
CSLOOP1  DS    0H                                              @G36XRUV 21077300
         LR    R15,R14            COPY                         @G36XRUV 21077600
         N     R15,OFFSTOTE       TURN OFF TOTE BIT IN REG     @G36XRUV 21077900
         CS    R14,R15,TRMBYTE2   RESET TRMSTOTE IN TTE        @G36XRUV 21078200
         BNZ   CSLOOP1            IF WORD ALTERED, TRY AGAIN   @G36XRUV 21078500
         L     R13,D4(R13)        RESTORE CALLERS SAVE AREA @  @XM05678 21078800
         LM    R14,R12,D12(R13)   RESTORE CALLERS REG          @XM05678 21079100
         LA    R15,ERRCD8         SET ERROR RETURN CODE        @XM05678 21079400
         BR    R14                RETURN TO CALLER             @XM05678 21079700
DUM2A    EQU   *                                                        21080000
         TM    QCBTSOF1,QCBDELAY  QCB IN DELAY QUEUE                    21100000
         BZ    DUM2B              NO - CONTINUE                  S22024 21200000
         OI    TRMFLG01,TRMDELY   SHOW QCB ON TIME DELAY QUEUE   S22024 21300000
DUM2B    EQU   *                                                 S22024 21400000
*        FIND LENGTH OF QCB                                             21500000
         LA    R9,QCBMSIZE        GET M-QCB SIZE                        21600000
         TM    TRMFLG01,TRM3705   3705 MODE                             21620000
         BZ    DUM2C              NO                                    21640000
         LA    R9,QCBPRFSZ(R9)    ADD ON QCB PREFIX SIZE       @Y17XAUU 21650000
DUM2C    EQU   *                                                        21680000
         LA    R10,QCBPSIZE       GET P-QCB SIZE                        21700000
*        FIND LEVEL ZERO PRIORITY QCB                                   21800000
         LA    R3,QCBMEND         POINT TO FIRST P-QCB                  21900000
DUM2D    EQU   *                                                        22000000
         CLI   D24(R3),D0         LEVEL ZERO ?                          22100000
         BE    DUM2H              YES                                   22200000
         AR    R3,R10             POINT TO NEXT P-QCB                   22300000
         B     DUM2D              MAKE ANOTHER CHECK                    22400000
DUM2H    EQU   *                                                        22500000
         ST    R3,KPQCB           SAVE ADDR OF P-QCB                    22600000
         STH   R10,KPQCBSZ        SAVE SIZE OF P-QCB                    22700000
         AR    R10,R9             GET TOTAL QCB SIZE                    22800000
         STH   R10,REGSAVE        SAVE QCB LENGTH                       22900000
         STH   R9,KMQCBSZ         SAVE SIZE OF MASTER QCB               23000000
         TM    TRMDEVFL+D1,TRMCONC CONC OR TERMINAL ATTACHED            23100000
         BZ    DUM2K              NO - CONTINUE NORMAL PROCESSING       23200000
         TM    QCBDSFLG,QCBDRQQ   TERMINAL A CONC                       23300000
         BO    DUMFAIL            YES - TERMINATE TRM                   23400000
*                                                                       23500000
*        TERMINAL IS ATTACHED TO A CONCENTRATOR                         23600000
*                                                                       23700000
         OI    TRMFLG01,CONC      SHOW TERMINAL ATTACHED TO CONC        23800000
         LH    R3,KPQCBSZ         GET LEVEL 0 P-QCB SIZE                23900000
         A     R3,KPQCB           POINT TO QCB EXTENSION                24000000
         ST    R3,KEXT            SAVE EXTENSION ADDR                   24100000
         USING IEDQQCBE,R3                                              24200000
         TM    QCBEFLG,XE0        PROCESS REQUEST                       24300000
         BZ    DUM2J              YES                                   24400000
         B     DUMFAIL            NO - TERMINATE TRM                    24500000
DUM2J    EQU   *                                                        24600000
         SR    R9,R9              CLEAR REG                             24700000
         IC    R9,QCBELGTH        LENGTH OF QCB EXTENSION               24800000
         SPACE                                                          24900000
         SR    R4,R4              CLEAR REG                             25000000
         LR    R5,R9              GET QCB EXT LENGTH                    25100000
         D     R4,K4              DIVIDE TOTAL QCB EXT LEN BY 4         25200000
         SLL   R5,D2              RESTORE INTEGRAL PART                 25300000
         LTR   R4,R4              REMAINDER                             25400000
         BZ    DUM2J4             NO                                    25500000
         A     R5,K4              INSURE F-WORD BOUNDARY                25600000
         SPACE                                                          25700000
DUM2J4   EQU   *                                                        25800000
         STH   R5,KQCBESZ         SAVE QCBE LEN                         25900000
         LR    R9,R5              SAVE VALUE                            26000000
         AH    R9,KPQCBSZ         P-QCB + QCBE                          26100000
         STH   R9,KPQCBSZ         SAVE COUNT                            26200000
         LA    R9,QCBMSIZE        GET M-QCB LENGTH                      26300000
         STH   R9,KMQCBSZ         SAVE IT                               26400000
         AH    R9,KPQCBSZ         M-QCB + P-QCB+ QCBE                   26500000
         STH   R9,REGSAVE         SAVE TOTAL                            26600000
         L     R9,QCBECONC-D1     GET ADDR OF CONC TERMINAL ENTRY       26700000
         LA    R9,D0(R9)          CLEAR FLAG BYTE                       26800000
         ST    R9,CONCTTE         SAVE TERMINAL ENTRY ADDR              26900000
         DROP  R3                                                       27000000
         DROP  R11                                                      27100000
         USING IEDQTRM,R9                                               27200000
         L     R3,TRMDESTQ-D1     GET ADDR OF DRQ                       27300000
         LA    R3,D0(R3)          CLEAR FLAG BYTE                       27400000
         ST    R3,KDRQ            SAVE DRQ ADDR                         27500000
         LA    R3,QCBMSIZE        GET SIZE OF DRQ                       27600000
         STH   R3,KDRQSZ          SAVE IT                               27700000
         AH    R3,REGSAVE         M-QCB + P-QCB + QCBE + DRQ            27800000
         LR    R10,R3             SAVE TOTAL                            27900000
DUM2K    EQU   *                                                        28000000
         DROP  R8                                                       28100000
         TM    TRMFLG01,CONC      TERMINAL ATTACHED TO CONC             28200000
         BZ    DUM2N              NO                                    28300000
         OI    TRMFLG01,TRMSPAS   SET SECOND PASS FLAG                  28400000
         LA    R14,TRMOPNO-IEDQTRM INIT TTE COUNT FOR CONC TERM@Y17XAUU 28500000
         TM    TRMFLG01,TRM3705   3705 MODE                             28520000
         BZ    DUM2L              NO                                    28540000
         LA    R14,TRMPRFSZ(R14) ADD ON TTE PREFIX SIZE        @Y17XAUU 28550000
DUM2L    EQU   *                                                        28580000
         LR    R15,R14            INIT TTE COUNT FOR CONC               28600000
         SPACE                                                          28700000
         DROP  R9                                                       28800000
         USING IEDQTRM,R11                                              28900000
DUM2N    EQU   *                                                        29000000
*        FIND LENGTH OF TTE                                             29100000
         L     R11,TNTENTRY       RESET TTE BASE               @YM07726 29120000
         LA    R0,D2              SET DEV DEP FIELDS TO CHECK           29150000
         LA    R8,TRMOPNO-IEDQTRM SIZE OF BASIC PORTION OF TTE @Y17XAUU 29300000
         LA    R9,TRMOPNO         POINT TO OPTION FIELD COUNT           29400000
         TM    TRMSTATE,TRMOPTFN  OPTION FIELDS PRESENT?                29500000
         BZ    DUMNOPT            NO                                    29600000
         SR    R7,R7              CLEAR REG 7                           29700000
         IC    R7,TRMOPNO         GET OPTION FIELD COUNT                29800000
         AR    R8,R7              ADD OPTION COUNT                      29900000
         TM    TRMFLG01,CONC      CONC TERMINAL                         30000000
         BZ    DUMOP8             NO                                    30100000
         TM    TRMFLG01,TRMSPAS   TERMINAL CHECK                        30200000
         BZ    DUMOP4             NO - CONC CHECK                       30300000
         LA    R14,D3(R7,R14)     GET OPTION COUNT FOR CONC TERMINAL    30400000
         B     DUMOP8             BYPASS CONC                           30500000
DUMOP4   EQU   *                                                        30600000
         LA    R15,D3(R7,R15)     OPTION COUNT FOR CONC                 30700000
DUMOP8   EQU   *                                                        30800000
         LA    R10,D3(R8,R10)     ADD OPTION FIELDS LENGTH              30900000
         AR    R9,R7                                                    31000000
         LA    R9,D3(R9)          POINT TO DEVICE DEPENENT FIELD        31100000
DUMNOPT  EQU   *   EVALUATE DEVICE DEPENDENT FIELD                      31200000
         TM    TRMSTATE,TRMOPTFN  OPTION FIELDS PRESENT?                31300000
         BO    DUMNOPT1           YES                                   31400000
         AR    R10,R8             KEEP RUNNING TOTAL                    31500000
DUMNOPT1 EQU   *                                                        31600000
         LA    R3,D8              SET NUMBER OF BITS TO TEST            31700000
         SR    R5,R5              CLEAR REG 5                           31800000
         LA    R4,SHFTBIT         SET INITIAL BIT TO TEST               31900000
DUMTEST  EQU   *                                                        32000000
         EX    R4,DUMDEV          IS THIS BIT SET?                      32100000
         BZ    DUMSHIFT           NO                                    32200000
         IC    R5,D0(R9)          CORE NEEDED FOR THIS ENTRY            32300000
         LA    R5,D1(R5)          TOTAL CORE                            32400000
         TM    TRMFLG01,CONC      CONC TERMINAL                         32500000
         BZ    DUMD8              NO                                    32600000
         TM    TRMFLG01,TRMSPAS   TERMINAL CHECK                        32700000
         BZ    DUMD4              NO - CONC CHECK                       32800000
         AR    R14,R5             TTE COUNT FOR CONC TERMINAL           32900000
         B     DUMD8              EXIT                                  33000000
DUMD4    EQU   *                                                        33100000
         AR    R15,R5             TTE COUNT FOR CONC                    33200000
DUMD8    EQU   *                                                        33300000
         AR    R10,R5             KEEP RUNNING TOTAL                    33400000
         AR    R9,R5              POINT TO NEXT ENTRY                   33500000
DUMSHIFT EQU   *                                                        33600000
         SRL   R4,1               ADJUST TO TEST NEXT BIT               33700000
         BCT   R3,DUMTEST         TEST NEXT BIT                         33800000
         LA    R11,D1(R11)        GET ADDRESS OF NEXT BYTE TO TEST      33900000
         BCT   R0,DUMNOPT1        GO EXAMINE NEXT BYTE                  34000000
         TM    TRMFLG01,CONC      TERMINAL ATTACHED TO CONC             34100000
         BZ    DUMSH4             NO                                    34200000
         TM    TRMFLG01,TRMSPAS   SECOND PASS COMPLETE                  34300000
         BZ    DUMSH4             EXIT                                  34400000
         NI    TRMFLG01,XFF-TRMSPAS TURN OFF SECOND PASS FLAG           34500000
         L     R11,CONCTTE        POINT TO CONC TERMINAL ENTRY          34600000
         B     DUM2N              GET SIZE OF CONC TTE                  34700000
DUMSH4   EQU   *                                                        34800000
         TM    TRMFLG01,TRM3705   3705 MODE                             34820000
         BZ    DUMSH6             NO                                    34840000
         LA    R10,IEDQTRM-IEDTRM(R10) ADD ON TTE PREFIX SIZE  @Y17XAUU 34850000
DUMSH6   EQU   *                                                        34880000
         SR    R4,R4              CLEAR REG 4                           35000000
         LR    R5,R10             COPY TOTAL CORE NEEDED                35100000
         D     R4,K4              DIVIDE TOTAL CORE BY 4                35200000
         SLL   R5,D2              RESTORE INTEGRAL PART OF TOTAL        35300000
         LTR   R4,R4              A  REMAINDER?                         35400000
         BZ    DUMREQ             NO                                    35500000
         A     R5,K4              INSURE F-WORD BOUNDARY FOR QCB        35600000
DUMREQ   EQU   *                                                        35700000
         LR    R10,R5             SAVE TOTAL CORE                       35800000
         TM    TRMFLG01,CONC      CONC                                  35900000
         BZ    DUMR12             NO                                    36000000
         SPACE                                                          36100000
         SR    R4,R4              CLEAR REG                             36200000
         LR    R5,R14             GET CONC TERM TTE LEN                 36300000
         D     R4,K4              DIVIDE BY 4                           36400000
         SLL   R5,D2              RESTORE INTEGRAL PART                 36500000
         LTR   R4,R4              REMAINDER                             36600000
         BZ    DUMR4              NO                                    36700000
         A     R5,K4              INSURE F-WORD BOUNDARY                36800000
DUMR4    EQU   *                                                        36900000
         STC   R5,TTETSZ          SAVE CONC TERM TTE LEN                37000000
         SPACE                                                          37100000
         SR    R4,R4              CLEAR REG                             37200000
         LR    R5,R15             GET CONC TTE LEN                      37300000
         D     R4,K4              DIVIDE BY 4                           37400000
         SLL   R5,D2              RESTORE INTEGRAL PART                 37500000
         LTR   R4,R4              REMAINDER                             37600000
         BZ    DUMR8              NO                                    37700000
         A     R5,K4              INSURE F-WORD BOUNDARY                37800000
DUMR8    EQU   *                                                        37900000
         STC   R5,TTECSZ          SAVE CONC TTE SIZE                    38000000
         A     R10,K12            SET UP FOR BOUNDARY ALIGNMENT         38100000
DUMR12   EQU   *                                                        38200000
         TM    TRMFLG01,TRM3705   3705 MODE                    @Y17XAUU 38220000
         BZ    DUMR14             NO                           @Y17XAUU 38240000
         LA    R10,LGBSZ(R10)     ADD LGB SIZE TO TOTAL        @Y17XAUU 38260000
DUMR14   EQU   *                                               @Y17XAUU 38280000
         STH   R10,REGSAVE+D2     SAVE TOTAL CORE NEEDED                38300000
         LA    R1,TOTWKSPC        ADDRESS OF WORK AREA         @Y17XAUU 38320000
         USING RQTNTENT,R1        SET REQUEST ELEMENT BASE     @Y17XAUU 38340000
         STH   R10,RQTNTLNT       SET REQUEST LENGTH           @Y17XAUU 38360000
         DROP  R1                                              @Y17XAUU 38380000
         TM    TRMFLG01,TRM3705   3705 MODE                    @Y17XAUU 38410000
         BZ    DUMHR              NO - EXIT                    @Y17XAUU 38440000
         LA    R1,LGBSZ           GET LGB SIZE                 @Y17XAUU 38470000
         SLR   R10,R1             TTE/QCB SIZE                 @Y17XAUU 38500000
         STH   R10,REGSAVE+D2     SAVE LENGTH                  @Y17XAUU 38530000
         B     DUMHR              RETURN                                38600000
         EJECT                                                          38600500
OPCREQ   EQU   *                                               @Y17XAUU 38601000
         XC    TOTOLINK(D3),TOTOLINK CLEAR LINK FIELD          @Y17XAUU 38601500
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                 @Y17XAUU 38602000
         MVI   TOTOPRI,PRISSOLT   SET POST PRIORITY            @Y17XAUU 38602500
         MVI   TOTOELNG,X18       SET ELEMENT LENGTH           @Y17XAUU 38602700
         XC    TOTORTCD,TOTORTCD  ZERO RETURN CODE FIELD       @Y17XAUU 38603000
         LA    R1,TOTOTECB        GET ECB ADDRESS              @Y17XAUU 38603500
         ST    R1,TOTOECBA        SET IT IN PLIST              @Y17XAUU 38604000
         LA    R1,TOTPLIST        GET PLIST ADDRESS            @Y17XAUU 38604500
         ST    R1,TRMSLPL         SAVE IN POST PLIST           @Y17XAUU 38605000
         ST    R1,TRMSLPL+D4      SAVE IN POST PLIST           @Y17XAUU 38605500
         MVI   TRMSLPL,RQINIT     SET REQUEST TYPE             @Y17XAUU 38606000
         MVI   TRMSLPL+D4,RQEND   SHOW END OF LIST             @Y17XAUU 38606500
         LA    R1,TRMSLPL         POINT TO POST PLIST          @Y17XAUU 38607000
         AQCTL                    POST REQUEST                 @Y17XAUU 38607500
         WAIT  ECB=TOTOTECB       WAIT FOR COMPLETION          @Y17XAUU 38608000
         BR    R14                RETURN TO CALLER             @Y17XAUU 38608500
         EJECT                                                          38700000
****************************************************************        38800000
*        ROUTINE TO COPY DUMMY ENTRIES FOR A REMOTE TERMINAL.  *        38900000
****************************************************************        39000000
IEDQWB3  EQU   *                                                        39100000
         NI    TRMFLG01,XFF-TRMQWB3 CLEAR SECOND PASS FLAG              39150000
         TM    TRMRQFLG,CTREQ     CT REQUEST                   @Y17XAUU 39152000
         BZ    DUM360             NO                           @Y17XAUU 39154000
         L     R3,TOTCTTNT        CT DUMMY TNT ADDRESS         @Y17XAUU 39156000
         LA    R4,TOTCTENT        CT DEVICE ENTRY ADDRESS      @Y17XAUU 39157000
         B     DUM390             CONTINUE                     @Y17XAUU 39158000
DUM360   EQU   *                                               @Y17XAUU 39160000
         TM    TRMRQFLG,APREQ     AP REQUEST                   @Y17XAUU 39162000
         BZ    DUM370             NO                           @Y17XAUU 39164000
         L     R3,TOTAPTNT        AP DUMMY TNT ADDRESS         @Y17XAUU 39166000
         LA    R4,TOTAPENT        AP DEVICE ENTRY ADDRESS      @Y17XAUU 39167000
         B     DUM390             CONTAINS                     @Y17XAUU 39168000
DUM370   EQU   *                                               @Y17XAUU 39170000
         TM    TRMRQFLG,PRREQ     PRIMARY TD REQUEST           @Y17XAUU 39172000
         BZ    DUM380             NO                           @Y17XAUU 39174000
         L     R3,TOTPDTNT        PRIMARY TD DUMMY TNT ADDRESS @Y17XAUU 39176000
         LA    R4,TOTPRENT        PRI TD DEVICE ENTRY ADDRESS  @Y17XAUU 39177000
         B     DUM390             CONTINUE                     @Y17XAUU 39178000
DUM380   EQU   *                                               @Y17XAUU 39180000
         L     R3,TOTSDTNT        SECOND TD DUMMY TNT ADDRESS  @Y17XAUU 39182000
         LA    R4,TOTSCENT        SEC TD DEVICE ENTRY ADDRESS  @Y17XAUU 39183000
DUM390   EQU   *                                               @Y17XAUU 39184000
         ST    R4,DEVENT          SAVE DEVICE ENTRY ADDRESS    @Y17XAUU 39484000
         SR    R4,R4              CLEAR REG 4                           39900000
         L     R10,TERNMTAB       GET TERM NAME TABLE POINTER           40000000
         USING IEDQTNTD,R10                                             40100000
         IC    R4,TNTENLEN        GET MAX. NAME LENGTH                  40200000
         DROP  R10                                                      40300000
         BCTR  R4,D0              DECREMENT FOR EXECUTE                 40400000
         L     R7,TRMTNT          POINT TO TRUE TNT                     40500000
         EX    R4,DUMNAME         MOVE NAME TO DUMMY TNT                40600000
         EX    R4,TTENAME         NAME TO WORK AREA            @ZM47913 40650011
         LA    R5,D1(R4)          RESTORE MAX. NAME LENGTH              40700000
         AR    R5,R3              POINT TO TTE POINTER                  40800000
         LR    R3,R5              SAVE TTE POINTER ADDR                 40850000
         MVC   TRMSAV1+D1(D3),D0(R5)  GET TTE POINTER                   40900000
         MVI   TRMSAV1,D0         ZERO HI-ORDER BYTE                    41000000
         L     R5,TRMSAV1         PUT IT IN REG 5                       41100000
         TM    TRMFLG01,TRM3705   3705 MODE                             41110000
         BZ    DUM4E              NO                                    41120000
         LA    R5,IEDQTRM-IEDTRM(R5) POINT PASS TTE PREFIX     @Y17XAUU 41125000
         ST    R5,TRMSAV1         PUT IN WORK AREA                      41140000
         MVC   D0(D3,R3),TRMSAV1+D1 REPLACE TTE ADDR IN TNT             41150000
         LA    R1,IEDQTRM-IEDTRM  TTE PREFIX SIZE              @Y17XAUU 41153000
         SLR   R5,R1              TTE PREFIX ADDRESS           @Y17XAUU 41156000
DUM4E    EQU   *                                                        41170000
         TM    TRMFLG01,CONC      CONC TERMINAL                         41200000
         BZ    DUMS4              NO                                    41300000
         SR    R3,R3              CLEAR REG                             41400000
         IC    R3,TTETSZ          LENGTH OF CONC TERMINAL TTE ENTRY     41500000
         B     DUMS8              CONTINUE PROCESSING                   41600000
DUMS4    EQU   *                                                        41700000
         LH    R3,REGSAVE+D2      GET TOTAL CORE NEEDED                 41800000
         SH    R3,REGSAVE         GET TTE SIZE                          41900000
DUMS8    EQU   *                                                        42000000
         BCTR  R3,D0              DECREMENT FOR EXECUTE                 42100000
         L     R7,TNTENTRY        POINT TO TRUE TTE                     42200000
         TM    TRMFLG01,TRM3705   3705 MODE                             42220000
         BZ    DUMS10             NO                                    42240000
         LA    R1,IEDQTRM-IEDTRM  TTE PREFIX SIZE              @Y17XAUU 42246000
         SLR   R7,R1              TTE PREFIX ADDRESS           @Y17XAUU 42252000
DUMS10   EQU   *                                                        42280000
         EX    R3,DUMTTE          COPY TTE                              42300000
         OI    TRMLU-IEDTRM(R5),TRMLUTM SET SO THAT SESSION    @ZM47913 42320011
*                       WILL NOT BE TERMINATED WHEN Q RUNS DRY @ZM47913 42340011
         NI    TRMLU-IEDTRM(R5),XFF-TRMLUIT LU DOES NOT INIT   @ZM47913 42360011
*                                                    SESSION   @ZM47913 42380011
         LR    R10,R5             SAVE DUMMY TTE POINTER                42400000
         LA    R5,D1(R3,R5)       POINT TO PLACE FOR QCB                42500000
         TM    TRMFLG01,TRM3705   3705 MODE                             42510000
         BZ    DUMS12             NO                                    42520000
         LA    R7,IEDQTRM-IEDTRM(R7) PT PASS TTE PREFIX (R)    @Y17XAUU 42521000
         LA    R10,IEDQTRM-IEDTRM(R10) PT PASS TTE PREFIX (D)  @Y17XAUU 42522000
         NI    TRMDEVFL-IEDQTRM(R10),XFF-TRMBUFS NO BUF SIZE   @YM08410 42522300
*                                  SPECIFIED FOR COUNTERFEIT   @YM08410 42522600
         LA    R5,QCBPRFSZ(R5)    POINT PASS PL FOR QCB PREFIX @Y17XAUU 42523000
         ST    R5,D0(R10)         PUT QCB ADDRESS IN TTE                42550000
         MVC   D0(D1,R10),D0(R7)  MOVE IN FLAG BYTE                     42560000
         LA    R1,QCBPRFSZ        QCB PREFIX SIZE              @Y17XAUU 42563000
         SLR   R5,R1              POINT TO QCB PREFIX          @Y17XAUU 42566000
         B     DUMS13             BRANCH                                42575000
DUMS12   EQU   *                                                        42580000
         ST    R5,D0(R10)         PUT QCB ADDRESS IN TTE                42600000
         MVC   D0(D1,R10),D0(R7)  MOVE IN FLAG BYTE                     42700000
*                                                                       42800000
DUMS13   EQU   *                                                        42850000
         NI    D0(R10),XFF-HELDN        TURN OFF HOLD FLAG     @YA10965 42870058
         LH    R3,KMQCBSZ         GET M-QCB LENGTH                      42900000
         BCTR  R3,D0              DECREMENT FOR EX                      43000000
         L     R7,TRMQCB          POINT TO TRUE M-QCB                   43100000
         TM    TRMFLG01,TRM3705   3705 MODE                             43120000
         BZ    DUMS15             NO                                    43140000
         LA    R1,QCBPRFSZ        QCB PREFIX SIZE              @Y17XAUU 43146000
         SLR   R7,R1              POINT TO QCB PREFIX          @Y17XAUU 43152000
DUMS15   EQU   *                                                        43180000
         EX    R3,DUMQCB          COPY M-QCB                            43200000
         TM    TRMFLG01,CONC      CONC TERMINAL                         43300000
         BZ    DUMHD              NO                                    43400000
         LA    R14,QCBMSIZE       GET M-QCB LENGTH                      43500000
         LA    R15,QCBPSIZE       GET P-QCB LENGTH                      43600000
         AR    R14,R15            OFFSET TO EXTENSION                   43700000
         STH   R14,D24(R5)        PUT IN DUMMY M-QCB                    43800000
         AR    R14,R5             GET ADDR OF PLACE FOR DUMMY EXT       43900000
         ST    R14,DUMEXTA        SAVE IT                               44000000
DUMHD    EQU   *                                                        44100000
         TM    TRMFLG01,TRM3705   3705 MODE                             44120000
         BZ    DUMHD2             NO                                    44140000
         LA    R1,QCBPRFSZ        QCB PREFIX SIZE              @Y17XAUU 44143000
         SLR   R3,R1              ADJUST COUNT                 @Y17XAUU 44146000
         LA    R5,QCBPRFSZ(R5)    POINT PASS QCB PREFIX        @Y17XAUU 44150000
DUMHD2   EQU   *                                                        44180000
         ST    R5,KMQCB           SAVE DUMMY M-QCB ADDR                 44200000
         LA    R5,D1(R3,R5)       POINT TO PLACE FOR P-QCB              44300000
         TM    TRMFLG01,TRM3705   3705 MODE                             44320000
         BZ    DUMHD4             NO                                    44340000
DUMHD4   EQU   *                                                        44380000
         LH    R3,KPQCBSZ         GET SIZE OF P-QCB                     44400000
         BCTR  R3,D0              DECREMENT FOR EX                      44500000
         L     R4,KPQCB           GET ADDR OF TRUE P-QCB                44600000
         EX    R3,DUMPQCB         COPY P-QCB                            44700000
         TM    TRMFLG01,CONC      CONC TERMINAL                         44800000
         BZ    DUMHJ              NO                                    44900000
         LA    R5,D1(R3,R5)       PLACE FOR DUMMY CONC TTE              45000000
         ST    R5,KCTTE           SAVE IT                               45100000
         SR    R3,R3              CLEAR REG                             45200000
         IC    R3,TTECSZ          GET LENGTH OF CONC TTE                45300000
         BCTR  R3,R0              DECREMENT FOR EX                      45400000
         L     R7,CONCTTE         REAL CONC TTE ADDR                    45500000
         EX    R3,DUMCTTE         COPY DUMMY CONC TTE                   45600000
         L     R14,DUMEXTA        DUMMY EXTENSION ADDR                  45700000
         USING IEDQQCBE,R14                                             45800000
         MVC   QCBECONC(D3),KCTTE+D1 PUT DUMMY CONC TTE ADDR IN EXT     45900000
         XC    QCBEFLG(D1),QCBEFLG  CLEAR FLAG BYTE IN EXTENSION        46000000
         DROP  R14                                                      46100000
         SPACE                                                          46200000
         LA    R5,D1(R3,R5)       PLACE FOR DRQ                         46300000
         L     R7,KDRQ            REAL DRQ                              46400000
         LH    R3,KDRQSZ          SIZE OF DRQ                           46500000
         BCTR  R3,R0              DECREMENT FOR EX                      46600000
         EX    R3,DUMDRQ          COPE IT                               46700000
         L     R14,KCTTE          ADDR OF DUMMY CONC TTE                46800000
         ST    R5,DKDRQ           SAVE DUMMY DRQ ADDR                   46900000
         MVC   D1(D3,R14),DKDRQ+D1 PUT DRQ ADDR IN CONC TTE             47000000
         USING IEDQDRQ,R5                                               47100000
         NI    DRQFLAG1,XFF-DRQHELD TURN OFF STOP SENDING BIT           47200000
         NI    DRQSTAT,XFF-DRQTRMHO TURN OFF HELD BIT                   47300000
         L     R1,TOTAVTPT        GET ADDRESS OF AVT                    47400000
         USING IEDQAVTD,R1        SET UP ADDRESSIBILITY FOR AVT         47500000
         MVC   DRQELCHN(D3),AVTDELAD+D1 PUT DUMMY LAST ELEMENT          47600000
*                                         ADDRESS INTO DATA READY       47700000
*                                         QUEUE                         47800000
         DROP  R1                 DROP AVT BASE                         47900000
*                                                                       48000000
*        SET UP HM POINTER IN DRQ                                       48100000
*                                                                       48200000
         LR    R4,R7              ADDR OF REAL DRQ                      48300000
         L     R3,D8(R4)          GET STCB CHAIN ADDR                   48400000
         LA    R3,D0(R3)          CLEAR HI ORDER BYTE                   48500000
         LA    R15,D8(R4)         GET ADDR OF 3RD WORD                  48600000
         CR    R3,R15             3RD WORD POINT TO SELF                48700000
         BE    DUMHG              YES - HM PTR IS 4TH WORD              48800000
         ST    R3,DRQSTPRI        PUT IN 4TH WORD                       48900000
         MVC   DRQSTPRI(D1),D12(R4) PUT FLAG BYTE IN                    49000000
DUMHG    EQU   *                                                        49100000
         LA    R3,DRQSTVTO        3RD WORD                              49200000
         ST    R3,DRQSTVTO        PUT IT IN ITSELF                      49300000
         MVC   DRQSTVTO(D1),D8(R4) SET INDEX                            49400000
         XC    DRQCURQ(D3),DRQCURQ CLEAR CURRENT QCB POINTER            49500000
         MVC   DRQSCBOF(D1),D20(R4) MOVE IN FLAG BYTE                   49600000
DUMHJ    EQU   *                                                        49650000
         L     R7,TRMQCB          RESTORE TRUE M-QCB                    49700000
         DROP  R5                                                       49800000
         SPACE                                                          49900000
*                                                              @Y17XAUU 49908000
*        COPY LGB IF 3705 RESOURCE                             @Y17XAUU 49916000
*                                                              @Y17XAUU 49924000
         TM    TRMFLG01,TRM3705   3705 MODE                    @Y17XAUU 49932000
         BZ    DUMHJ2             NO - NO LGB TO COPY          @Y17XAUU 49940000
         LA    R10,D1(R3,R5)      PLACE FOR DUMMY LGB          @Y17XAUU 49948000
         USING IEDQQCB,R7         SET REAL QCB ADDRESSABILITY  @Y17XAUU 49949000
         L     R8,QCBLGBAD-D1     GET REAL LGB ADDRESS         @Y17XAUU 49950000
         DROP  R7                                              @Y17XAUU 49951000
         LA    R3,LGBSZ           GET LGB SIZE                 @Y17XAUU 49952000
         BCTR  R3,D0              DECREMENT FOR EX             @Y17XAUU 49953000
         EX    R3,LGBMOVE         COPY LGB                     @Y17XAUU 49954000
         L     R5,KMQCB           RESTORE DUMMY M-QCB ADDRESS  @Y17XAUU 49956000
         USING IEDNQCB,R5         SET QCB ADDRESSABILITY       @Y17XAUU 49964000
         LA    R1,QCBPRFSZ        GET QCB PREFIX SIZE          @Y17XAUU 49965000
         SLR   R5,R1              POINT TO QCB PREFIX          @Y17XAUU 49966000
         L     R8,DEVENT          GET DEVICE ENTRY ADDRESS     @Y17XAUU 49967000
         MVC   QCBTTCIN(D2),D2(R8) SET DUMMY TTCIN IN QCB      @Y17XAUU 49968000
         STCM  R10,ADRMSK7,QCBLGBAD SET DUMMY LGB ADDRESS IN   @Y17XAUU 49969000
*                                 DUMMY QCB                    @Y17XAUU 49980000
         DROP  R5                                              @Y17XAUU 50012000
         USING IEDNLGB,R10        SET LGB ADDRESSABILITY       @Y17XAUU 50020000
         L     R5,TOTRESPL        RESIDENT CONTROL BLOCK ADDR  @Y17XAUU 50028000
         USING RESPL,R5           SET RESPL ADDRESSABILITY     @Y17XAUU 50036000
         L     R5,RESTOTMH        GET TOTE MH ADDRESS          @Y17XAUU 50044000
         STCM  R5,ADRMSK7,LGBMHA  SET MH ADDRESS IN LGB        @Y17XAUU 50052000
         LA    R5,MAXRUSIZ        SET MAXIMUM RU SIZE          @YM08523 50054000
         CLM   R5,ADRMSK3,LGBBUFSI IS RU SIZE GT BUF SIZE      @YM09025 50054600
         BNH   DUMHJ2             NO - BRANCH                  @YM09025 50055200
         STCM  R5,ADRMSK3,LGBBUFSI IN COUNTERFEIT              @YM08410 50056000
         DROP  R5                                              @Y17XAUU 50060000
         DROP  R10                                             @Y17XAUU 50068000
DUMHJ2   EQU   *                                               @Y17XAUU 50076000
         L     R5,KMQCB           RESTORE DUMMY M-QCB ADDRESS  @Y17XAUU 50084000
*                                                                       50200000
         USING IEDQQCB,R5                                               50300000
         BAL   R3,DUMQMGR         EVALUATE QUEUE METHOD                 50400000
         TM    TRMFLG01,TRMRNLU   LU ENTRY                     @Y17XAUU 50407000
         BO    DUMHJ4             YES - BYPASS HOLD            @Y17XAUU 50414000
         MVI   TOTOVBCD,HOLD      SET HOLD VERB CODE           @Y17XAUU 50421000
         MVC   TOTOLADR(D8),WORK1 SET RESOURCE NAME            @Y17XAUU 50428000
         MVC   TOTORLN(D1),QCBRELLN SET RLN                    @Y17XAUU 50435000
         BAL   R14,OPCREQ         ISSUE HOLD TERMINAL          @Y17XAUU 50442000
DUMHJ4   DS    0H                 RETURN AFTER BRANCH                   50450000
         TM    TRMFLG01,TRMDELY   QCB IN TIME DELAY QUEUE        S22024 50500000
         BZ    DUMHK              NO - CONTINUE                  S22024 50600000
         NI    QCBTSOF1,XFF-QCBDELAY YES - TURN IT OFF           S22024 50700000
DUMHK    EQU   *                                                 S22024 50800000
         XC    QCBMSGCT(D2),QCBMSGCT  CLEAR COUNT OF MSG IN QUEUE       50900000
         NI    QCBSTAT,XFF-QCBTRMHO  TURN OFF HOLD BIT IF ON            51000000
         L     R3,QCBSTVTO        GET STCB CHAIN ADDRESS                51100000
         LA    R3,D0(R3)          CLEAR HI-ORDER BYTE                   51200000
         LA    R4,D8(R7)          GET ADDRESS OF 3RD WORD               51300000
         CR    R3,R4              3RD WORD POINT TO SELF                51400000
         BE    DUMHM              YES - HM POINTER IS 4TH WORD          51500000
         ST    R3,QCBSTPRI        PUT HM IN 4TH WORD OF DUMMY           51600000
         MVC   QCBSTPRI(D1),D12(R7)  PUT FLAG BYTE IN DUMMY             51700000
DUMHM    EQU   *                                                        51800000
         LA    R3,QCBSTVTO        GET ADDR OF 3RD WORD IN DUMMY         51900000
         ST    R3,QCBSTVTO        PUT IT IN ITSELF                      52000000
         MVC   QCBSTVTO(D1),D8(R7) SET INDEX IN DUMMY QCB               52100000
         ST    R5,QCBSCBOF        PUT DUMMY QCB ADDR IN CHAIN           52200000
         MVC   QCBSCBOF(D1),X14(R7)  MOVE IN FLAG BYTE                  52300000
         NI    QCBFLAG,XFF-QCBSDFFO  TURN OFF CURRENTLY SENDING FEFO    52600000
*                                      FLAG                             52700000
         NI    QCBDSFLG,XFF-QCBHELD  TURN OFF HELD BIT                  52800000
         XC    QCBDATFL(D22),QCBDATFL CLEAR PQCB                        52900000
         SPACE                                                          53300000
DUMHR    EQU   *                                                        57200000
         L     R13,D4(R13)        CALLLER'S SAVE AREA ADDRESS           57300000
         LM    R14,R12,D12(R13)   CALLER'S REGISTERS                    57400000
         SR    R15,R15            CLEAR RETURN CODE REGISTER            57500000
         BR    R14                RETURN                                57600000
         SPACE 2                                                        57700000
DUMFAIL  EQU   *                                                        57800000
         SPACE                                                          58100000
         L     R13,D4(R13)        RESTORE CALLERS SAVE AREA ADDRESS     58300000
         LM    R14,R12,D12(R13)   RESTORE CALLER'S REG                  58400000
         LA    R15,ERRCD4         ERROR RETURN CODE                     58500000
         BR    R14                RETURN                                58600000
         SPACE                                                          58700000
         DROP  R11                                                      58800000
         EJECT                                                          58900000
DUMQMGR  EQU   *                                                        59000000
         STM   R10,R12,WORK4      SAVE CALLER'S REG                     59100000
         USING IEDQQCB,R5                                               59200000
*                                                                       59300000
         TM    TRMFLG01,TRMRNLU   LU ENTRY                     @Y17XAUU 59320000
         BNZ   DDD4               YES - BYPASS STATUS CHECK    @Y17XAUU 59340000
         TM    TRMRQFLG,CTREQ     CT REQUEST                   @Y17XAUU 59360000
         BO    DDD1               YES                          @Y17XAUU 59500000
         LA    R10,TOTAPDFL       AP INIT STATUS FLAGS                  59600000
         LA    R1,TOTAPOFF        @ AP COUNTERFEIT TTCIN       @YM08136 59650000
         B     DDD2               EXIT                                  59700000
DDD1     EQU   *                                                        59800000
         LA    R10,TOTCTDFL       CT INIT STATUS FLAGS                  59900000
         LA    R1,TOTCTOFF        @ CT COUNTERFEIT TTCIN       @YM08136 59950000
DDD2     EQU   *                                                        60000000
         TM    TRMFLG01,TRM3705   NCP PRE SNA ENTRY            @YM08136 60010000
         BZ    DDD20              NO - BYPASS ALT TTCIN SETUP  @YM08136 60020000
         OI    TOTOFLG,TOTOATC    USE ALTERNATE TTCIN          @YM08136 60030000
         MVC   TOTOALTT(D2),D0(R1) SET UP ALTERNATE TTCIN      @YM08136 60040000
DDD20    EQU   *                                               @YM08136 60050000
         TM    QCBSTAT,QCBTRMHO   TERMINAL INIT HELD ?                  60100000
         BZ    DDD3               NO                                    60200000
         OI    D0(R10),X40        SHOW INT STATE                        60300000
DDD3     EQU   *                                                        60400000
*        DETERMINE IF INVITATION LIST INIT. INACTIVE                    60600000
         LA    R1,TOTOTECB        GET ECB ADDR                          60700000
         STCM  R1,7,TOTOECBA+1    PUT IT IN P-LIST             @YM08136 60800000
         MVC   TOTORLN(D1),QCBRELLN  PUT IN RLN                @Y17XAUU 60880000
         MVI   TOTOVBCD,INACT     INACTIVATE VERB CODE         @Y17XAUU 60960000
         MVI   TOTOELNG,X18       SET ELEMENT LENGTH           @Y17XAUU 61000000
         XC    TOTOLINK(D3),TOTOLINK  CLEAR LINK FIELD         @Y17XAUU 61040000
         MVI   TOTOPRI,PRISSOLT   SET POST PRIORITY            @Y17XAUU 61120000
         XC    TOTOTECB(D4),TOTOTECB  CLEAR ECB                         61200000
         MVC   TOTOLADR(D8),WORK1 PUT IN TERMINAL NAME         @Y17XAUU 61300000
         LA    R1,TOTPLIST        ADDR OF ELEMENT                       61410000
         ST    R1,TRMSLPL         PUT IN PLIST                          61420000
         ST    R1,TRMSLPL+D4      PUT IN PLIST                          61430000
         MVI   TRMSLPL,RQINIT     SET INITIAL ELEMENT FLAG              61440000
         MVI   TRMSLPL+D4,RQEND   SET LAST ELEMENT FLAG                 61450000
         LA    R1,TRMSLPL         ADDR OF PLIST                         61460000
         AQCTL                    ISSUE ACTIVATE REQUEST                61500000
         WAIT  ECB=TOTOTECB                                             61600000
         CLI   TOTORTCD,INACTRC   INIT INACTIVE                         61700000
         BNE   DDD4               NO - INIT ACTIVE                      61800000
DDD3E    EQU   *                                                        61900000
         OI    D0(R10),TOTAPIAC   SHOW THAT LIST INACTIVE               62000000
DDD4     EQU   *                                                        62100000
         L     R9,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 62110000
         USING IEDQAVTD,R9                                              62200000
         TM    QCBDSFLG,QCBREUS   REUSABLE DISK ?                       62300000
         BZ    DUMQM1             NO                                    62400000
         MVC   QCBDNHDR(D3),AVTRADDR+D1  PUT R-DISK Q ADDR IN QCB       62500000
         L     R8,AVTRADDR        GET R-DISK Q ADDR                     62600000
         LA    R8,D4(R8)          INCREMENT BY FOUR                     62700000
         ST    R8,AVTRADDR        REPLACE IT                            62800000
         LM    R10,R12,WORK4      RESTORE REG.                          62900000
         BR    R3                 RETURN                                63000000
*                                                                       63100000
DUMQM1   EQU   *                                                        63200000
*                                                                       63300000
         TM    QCBDSFLG,QCBNREUS  NONREUSABLE DISK ?                    63400000
         BZ    D0(R3)             NO - RETURN                  @Y17XAUU 63500000
         MVC   QCBDNHDR(D3),AVTNADDR+D1  PUT NR-DISK Q ADDR IN QCB      63600000
         L     R8,AVTNADDR        GET NR-DISK ADDRESS                   63700000
         LA    R8,D4(R8)          INCREMENT BY FOUR                     63800000
         ST    R8,AVTNADDR        PUT IT BACK IN AVT                    63900000
         LM    R10,R12,WORK4      RESTORE REG                           64000000
         BR    R3                 RETURN                                64100000
         DROP  R9                                                       64200000
         DROP  R5                                                       64300000
         EJECT                                                          64400000
QWB2SAVE DS    18F                IEDQWB2 SAVW AREA                     65400000
TRMSLPL  DS    0F                 PARAMETER LIST FOR START/STOP LINE    66800000
         DC    X'0C'              START OF LIST INDICATOR               66900000
         DC    AL3(0)             ADDRESS OF REQUEST ELEMENT   @Y17XAUU 67000000
         DC    X'80'              END OF LIST INDICATOR                 67100000
         DC    AL3(0)             ADDRESS OF REQUEST ELEMENT   @Y17XAUU 67200000
OFFSTOTE DS    0F                 RESETS TRMSTOTE W/ C&S       @G36XRUV 67220000
         DC    XL1'FF'                                         @G36XRUV 67240000
         DC    AL1(255-TRMSTOTE)                               @G36XRUV 67260000
         DC    XL2'FFFF'                                       @G36XRUV 67280000
         SPACE                                                          67300000
WORK1    DC    8XL1'40'           PLACE FOR CT/AP/TD NAME      @Y17XAUU 69300000
WORK4    DS    3F                 WORK AREA                             69500000
DEVENT   DS    A                  DEVICE ENTRY ADDRESS         @Y17XAUU 69500500
DUMEXTA  DS    A                  DUMMY QCBE ADDRESS           @Y17XAUU 69501000
K1       DC    F'1'               VALUE OF 1                   @Y17XAUU 69504000
K4       DC    F'4'               VALUE OF 4                   @Y17XAUU 69505000
K12      DC    F'12'              VALUE OF 12                  @Y17XAUU 69506000
KEXT     DS    A                  TRUE QCBE ADDRESS            @Y17XAUU 69507000
DCTTETA  DS    A                  DUMMY CONC TERM TTE ADDRESS  @Y17XAUU 69510000
DKDRQ    DS    A                  DUMMY DRQ ADDRESS            @Y17XAUU 69511000
KCTTE    DS    A                  DUMMY CONC TTE ADDRESS       @Y17XAUU 69512000
KQCBESZ  DS    H                  QCBE SIZE                    @Y17XAUU 69513000
         SPACE                                                          69519000
DUMNAME  MVC   D0(D1,R3),D0(R7)   COPY TERMINAL NAME           @Y17XAUU 69520000
DUMTTE   MVC   D0(D1,R5),D0(R7)   COPY TTE                     @Y17XAUU 69521000
DUMQCB   MVC   D0(D1,R5),D0(R7)   COPY M-QCB                   @Y17XAUU 69522000
DUMDEV   TM    TRMDEVFL-IEDQTRM(R11),D0 TEST DEV DEP FIELDS    @Y17XAUU 69523000
DUMPQCB  MVC   D0(D1,R5),D0(R4)   COPY P-QCB                   @Y17XAUU 69524000
DUMCTTE  MVC   D0(D0,R5),D0(R7)   COPY CONC TTE                @Y17XAUU 69525000
DUMDRQ   MVC   D0(D0,R5),D0(R7)   COPY DRQ                     @Y17XAUU 69526000
CTTENAME MVC   D0(D0,R14),D0(R7)  SYMBOLIC NAME OF CONC        @Y17XAUU 69527000
         SPACE                                                          69528000
TTENAME  MVC   WORK1(D0),D0(R7)   COPY TERMINAL NAME           @ZM47913 72650011
LGBMOVE  MVC   D0(D0,R10),D0(R8)  COPY LGB                     @Y17XAUU 72660000
         DC    20F'0'                   TEMP PATCH AREA                 72670058
         EJECT                                                          72700000
KTRM     DSECT                                                          72800000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS                72900000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS                73000000
TRMQCB   DS    A                  CT/AP QCB ADDRESS                     73100000
TRMTNT   DS    A                  CT/AP TNT ADDRESS                     73200000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA                   73300000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA                   73400000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA                   73500000
REGSAVE  DS    F                  WORK AREA                             73600000
F32      DC    F'32'              VALUE OF 32                           74000000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @Y17XAUU 74100000
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @Y17XAUU 74200000
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @Y17XAUU 74300000
KDRQ     DS    A                  TRUE DRQ ADDRESS             @Y17XAUU 74400000
KPQCBSZ  DS    H                  P-QCB SIZE                   @Y17XAUU 74500000
KMQCBSZ  DS    H                  M-QCB SIZE                   @Y17XAUU 74600000
KDRQSZ   DS    H                  DRQ SIZE                     @Y17XAUU 74700000
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @Y17XAUU 74800000
TTECSZ   DS    CL1                CONC TTE SIZE                @Y17XAUU 74900000
TRMRQFLG DS    CL1                DUMMY TNT REQUEST FLAG                75500000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 75600000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 75630000
PRREQ    EQU   X'20'              PRIMARY TD REQUEST           @Y17XAUU 75660000
SCREQ    EQU   X'10'              SECONDARY TD REQUEST         @Y17XAUU 75690000
ALRDY    EQU   X'00'              COUNTERFEIT STORAGE ALREADY  @Y17XAUU 75720000
*                                 EXIST FOR THIS REQUEST       @Y17XAUU 75750000
TRMFLG01 DS    CL1                CONTROL FLAG                          75800000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC             75900000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE                      76000000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION                  76100000
TRMRNLU  EQU   X'10'              SNA LU ENTRY                 @Y17XAUU 76150000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE               76200000
TRM3705  EQU   X'04'              3705 MODE                             76250000
TRMCTEAP EQU   X'02'              CT EQU AP                             76270000
WRKFLG   DS    CL1                WORK AREA                             76300000
KTRMEND  DS    0C                 END OF KTRM DSECT            @Y17XAUU 76330000
************************************************************** @Y17XAUU 76360000
         EJECT                                                          77600000
         TLGBD                                                   S22024 77700000
         EJECT                                                          77800000
         TQCBED                                                         77900000
         EJECT                                                          78000000
         TDRQD                                                          78100000
         EJECT                                                          78200000
         EJECT                                                          78300000
         TPRIOR                                                         78400000
         EJECT                                                          78500000
         TQCBD                                                          78600000
         EJECT                                                          78700000
DCBDSECT DCBD  DSORG=TX                                                 78800000
         EJECT                                                          78900000
         TSCBD                                                          79000000
         EJECT                                                          79100000
         TPRFD                                                          79200000
         EJECT                                                          79300000
         TLCBD                                                          79400000
         EJECT                                                          79500000
CVT      DSECT                                                          79600000
         CVT                                                            79700000
         EJECT                                                          79800000
UCB      DSECT                                                          79900000
         IEFUCBOB                                                       80000000
         EJECT                                                          80100000
         TAVTD                                                          80200000
         EJECT                                                          80300000
         TTRMD                                                          80400000
         EJECT                                                          80500000
         TDEBD                                                          80600000
         EJECT                                                          80700000
         TTNTD                                                          80800000
         EJECT                                                          80900000
         OLTCB                                                          81000000
         EJECT                                                          81007000
RQTNTERR EQU   X'FF'              ERROR RETURN CODE            @Y17XAUU 81014000
RQTNTENT DSECT                                                 @Y17XAUU 81021000
RQTNTFGS DS    BL1                TNT REQUEST FLAGS            @Y17XAUU 81028000
RQTNTLST EQU   X'80'              LAST ENTRY FLAG              @Y17XAUU 81035000
RQTNTTYP DS    BL1                TNT REQ ENTRY TYPE FIELD     @Y17XAUU 81042000
RQTNTCT  EQU   X'80'              CONTROL TERMINAL ENTRY       @Y17XAUU 81049000
RQTNTAP  EQU   X'40'              ALTERNATE PRINTER ENTRY      @Y17XAUU 81056000
RQTNTPR  EQU   X'20'              PRIMARY TEST DEVICE ENTRY    @Y17XAUU 81063000
RQTNTSC  EQU   X'10'              SECONDARY TEST DEVICE ENTRY  @Y17XAUU 81070000
RQTYPANY EQU   RQTNTCT+RQTNTAP+RQTNTPR+RQTNTSC ANY ENTRY FLAG  @Y17XAUU 81077000
RQTNTLNT DS    H                  TNT REQUEST BLOCK LENGTH     @Y17XAUU 81084000
RQTENLEN EQU   4                  TNT REQUEST ELEMENT LENGTH   @Y17XAUU 81091000
         EJECT                                                          81400000
RESPL    RESPL                                                          81500000
         EJECT                                                          81530000
         TSIBD                                                 @Y17XAUU 81560000
         END                                                            81700000
