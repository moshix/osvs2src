         TITLE 'IEDQWC TRM ANALYSIS MODULE 1'                           00070000
IEDQWC   CSECT                                                          00140000
*A000000-999999                                                @Y16X5U0 00150000
* CHANGE ACTIVITY AS FOLLOWS:                                           00210000
*C840880                                                         S21903 00280000
*D834100-834600,836860-836880                                   SA51078 00350000
*C836820-836840                                                 SA51078 00420000
*A837000                                                        SA41597 00490000
*C836100                                                        SA41597 00560000
*D837440-837520                                                 SA41597 00630000
*A088860,813600                                                 SA41607 00700000
*A440600                                                        SA41606 00770000
*C824000                                                        SA41611 00840000
*D104200-104400,358560-363560                                   SA41614 00910000
*A151400-151600,580380,580425-580620,580780-581400              SA61759 00930000
*C477800                                                       @SA70654 00930156
*A147200-147400,379470-379960,394300-394500,408850-409450        S05331 00936000
*A410900-411200,690240-690800,766520-767020                      S05331 00942000
*C645400                                                         S05331 00950000
*A233100,409150,891600,466200,467600,469000,477400,581300      @Y17XAUU 00955000
*A597100,617400,646100,654500,657300,666400,690280,703500      @Y17XAUU 00960000
*A707000,710500,713300,723800                                  @Y17XAUU 00965000
*C166600                                                       @Y17XAUU 00970000
*D184100,795200-796600,798000-807100,816200-822500             @Y17XAUU 00975000
* A073500,237300,285900,402500,439600,770700,766640,766720     @G36XRUV 00976000
* C073500,237300,285900,403200,439600,766660,766740            @G36XRUV 00977000
*A321300                                                       @OZ27338 00977182
*C329000-329700                                                @OZ27338 00977282
*                                                                       00978000
         SPACE 2                                                        00980000
         USING IEDQWC,R15                                               01050000
IEDQWC   IEDHJN STARC,HJN                                               01120000
         SPACE 2                                                        01190000
****************************************************************        01260000
*                                                              *        01330000
* MODULE NAME = IEDQWC (TCAM,TOTE)                             @Y17XAUU 01540000
*                                                              *        01610000
* DESCRIPTIVE NAME = TRM ANALYSIS MODULE 1                     *        01680000
*                                                              *        01750000
* COPYRIGHT = NONE                                             *        01820000
*                                                              *        01890000
* STATUS --                                                    *        01960000
*                                                              *        02030000
*    VERSION 10.0                                              @Y17XAUU 02100000
*                                                              *        02170000
* FUNCTIONS --                                                 *        02240000
*                                                              *        02310000
*    THE PURPOSE OF THIS MODULE IS TO ANALYZE TRM'S AND TURN   *        02380000
*    OVER CONTROL TO THE APPROPRIATE MODULE FOR FURTHER        *        02450000
*    PROCESSING.                                               *        02520000
*                                                              *        02590000
*    THE TRM IS OBTAINED FROM THE OLTCB CONTROL BLOCK.         @Y17XAUU 02660000
*                                                              *        02800000
*    THE CONTROL TERMINAL ENTRY OF THE TRM IS ANALYZED. IF     *        02870000
*    THERE IS AN ERROR IN THE CONTROL TERMINAL ENTRY, THE      *        02940000
*    SOURCE IS NOTIFIED OF THE ERROR CONDITION AND THE         @Y17XAUU 02950000
*    SYSTEM OPERATOR IS INFORMED THAT A TRM WAS RECEIVED BUT   *        03010000
*    IGNORED BECAUSE OF AN ERROR. IF AN ERROR IS DETECTED IN   *        03080000
*    THE AP OPTION ON THE OPTION FIELD, AN ERROR BIT IS SET    *        03150000
*    FOR IEDQWC2 TO INTERROGATE. CONTROL IS THEN PASSED TO THE *        03220000
*    NEXT TRM ANALYSIS MODULE, IEDQWC1.                        *        03290000
*                                                              *        03360000
*    IF THE CONTROL TERMINAL OR ALTERNATE PRINTER IS A REMOTE  *        03430000
*    TERMINAL, A DUMMY QCB AND TTE IS SET UP FOR EACH. IF      *        03500000
*    ENOUGH IS UNAVAILABLE FOR THE ENTRIES, THE SYSTEM OPERATOR*        03570000
*    AND THE SOURCE ARE NOTIFIED AND THE TRM REJECTED.         @Y17XAUU 03640000
*                                                              *        03710000
*    IF ENTRY IS FROM A NUMERIC ONLY DEVICE, THE CONTROL       *        03780000
*    FIELD IS SET UP. THE CONTROL TERMINAL DEFAULTS TO THE     *        03850000
*    REQUEST TERMINAL. CONTROL IS PASSED TO THE NUMERIC TRM    *        03920000
*    ANALYSIS MODULE TO READ IN THE REMAINDED OF THE TRM.      *        03990000
*    UPON RETURN TO IEDQWC, THE TRM THAT WAS BUILT IS ANALYZED *        04060000
*    NORMALLY BY IEDQWC.                                       *        04130000
*                                                              *        04200000
*    THE OPTION FIELD OF THE TRM IS CHECKED FOR THE AP OPTION. *        04690000
*    IF THE AP OPTION IS SPECIFIED, THIS MODULE VERIFIES THE   *        04760000
*    NAME OF THE ALTERNATE PRINTER TO BE SYSCON, SYSOUT, OR A  *        04830000
*    VALID OPERAND TCAM TERMINAL.                              *        04900000
*                                                              *        04970000
* ENTRY POINTS --                                              *        05040000
*                                                              *        05110000
*    IEDQWC                                                    @Y17XAUU 05180000
*                                                              *        05460000
* LINKAGE -- XCTL'ED FROM IEDQWB1                              @Y17XAUU 05460100
*                                                              @Y17XAUU 05460200
* MACROS -- AQCTL                                              @Y17XAUU 05460300
*           DEQ                                                @Y17XAUU 05460400
*           ENQ                                                @Y17XAUU 05460500
*           IEDHJN                                             @Y17XAUU 05460600
*           IEDQMSG                                            @Y17XAUU 05460700
*           LINK                                               @Y17XAUU 05460800
*           POST                                               @Y17XAUU 05460900
*           SAVE                                               @Y17XAUU 05461000
*           WAIT                                               @Y17XAUU 05461100
*           WTO                                                @Y17XAUU 05461200
*           XCTL                                               @Y17XAUU 05461300
*                                                              @Y17XAUU 05461400
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 05461500
*                                                              @Y17XAUU 05461600
* MODULE SIZE -- 4K MAXIMUM                                    @Y17XAUU 05461700
*                                                              @Y17XAUU 05461800
* MODULE TYPE -- PROCEDURE                                     @Y17XAUU 05461900
*                                                              @Y17XAUU 05462000
* PROCESSOR -- ASSEMBLER XF                                    @Y17XAUU 05462100
*                                                              @Y17XAUU 05462200
* INPUT --                                                     *        05530000
*                                                              *        05600000
*    REGISTER 02,13,14,15 CONTAIN THE FOLLOWING VALUES:        *        05670000
*                                                              *        05740000
*    02 - OLTCB POINTER                                        *        05810000
*    13 - SAVE AREA ADDRESS                                    *        05880000
*    14 - RETURN ADDRESS                                       *        05950000
*    15 - ENTRY POINT ADDRESS                                  *        06020000
*                                                              *        06090000
* OUTPUT --                                                    *        06160000
*                                                              *        06230000
*    NONE                                                      *        06300000
*                                                              *        06370000
* EXTERNAL REFERENCES --                                       *        06440000
*                                                              *        06510000
*    IEDQWB - RESOURCE MANAGER                                 *        06580000
*    AVTUI  - TCAM BINARY SEARCH ROUTINE                       *        06650000
*    IEDQCA - TCAM OPERATOR CONTROL MODULE                     *        06720000
*    IEDQWK - TOTE MESSAGE MODULE                              *        06790000
*                                                              *        06860000
* EXITS,NORMAL --                                              *        06930000
*                                                              *        07000000
*    XCTL TO IEDQWB1 ON CONFIGURATOR,PROMPT AND NORMAL TRM     @G36XRUV 07350000
*    REQUESTS.                                                 @G36XRUV 07360000
*    XCTL TO IEDQWH WHEN TRM IS ENTERED FROM NUMERIC-ONLY      @G36XRUV 07370000
*    DEVICES.                                                  @G36XRUV 07380000
*    XCTL TO IEDQWF1 ON DEALLOCATION REQUESTS.                 @G36XRUV 07390000
*                                                              *        07420000
* EXITS,ERROR --                                               *        07490000
*    XCTL TO IEDQWB1 (AP ERROR)                                @Y17XAUU 07492000
*    XCTL TO IEDQWE (CT ERROR)                                          07494000
*    RETURN TO IEDQWA (CT ERROR)                               @Y17XAUU 07496000
*                                                              *        07560000
* TABLES/WORK AREA --                                          *        07910000
*                                                              *        07980000
*    CVT,AVT,TERMNAME TABLE,TERMINAL TABLE,OLTCB,LCB,DCB,SCB,  *        08050000
*    TCB,IEDQWC WORK AREA,DEB                                  *        08120000
*                                                              *        08190000
* ATTRIBUTES -- --                                             *        08260000
*                                                              *        08330000
*    ENABLED, PROBLEM PROGRAM MODE, TRANSIENT                  *        08400000
*                                                              *        08470000
* NOTE --                                                      *        08540000
*                                                              *        08610000
*  DEPENDENCIES -- EBCDIC CHARACTER CODE                       @Y17XAUU 08611000
*                                                              @Y17XAUU 08612000
*  RESTRICTIONS -- NONE                                        @Y17XAUU 08613000
*                                                              @Y17XAUU 08614000
*  REGISTER CONVENTIONS -- SEE REGISTER ASSIGNMENT             @Y17XAUU 08615000
*                                                              @Y17XAUU 08616000
*  PATCH LABEL -- PATCH                                                 08617000
*                                                              *        08750000
****************************************************************        08820000
         EJECT                                                          08890000
*********************************************************************** 08960000
*                                                                     * 09030000
*        EQUATES                                                      * 09100000
*                                                                     * 09170000
*********************************************************************** 09240000
         SPACE 2                                                        09310000
R0       EQU   0                  REG 0                                 09380000
R1       EQU   1                  REG 1                                 09450000
R2       EQU   2                  OLTCB POINTER/SCT POINTER             09520000
R3       EQU   3                  REG 3                                 09590000
R4       EQU   4                  REG 4                                 09660000
R5       EQU   5                  REG 5                                 09730000
R6       EQU   6                  BASE REG                              09800000
R7       EQU   7                  REG 7                                 09870000
R8       EQU   8                  REG 8                                 09940000
R9       EQU   9                  REG 9                                 10010000
R10      EQU   10                 REG 10                                10080000
R11      EQU   11                 REG 11                                10150000
R12      EQU   12                 REG 12                                10220000
R13      EQU   13                 SAVE AREA POINTER                     10290000
R14      EQU   14                 RETURN ADDR                           10360000
R15      EQU   15                 ENTRY POINT ADDR                      10430000
         SPACE 2                                                        10500000
XFF      EQU   X'FF'              MASK SETTING                          10570000
XF0      EQU   X'F0'              LCB MASK FOR ANR LOCAL                10640000
ANR      EQU   X'1E'              REQ TERM = ANR LO                     10710000
ACTVBCD  EQU   X'46'              OP CONTROL ACTIVATE CMMD              10780000
ACTRTCD  EQU   X'08'              INVITATION LIST ACTIVE RT CD          10850000
HELDN    EQU   X'04'              HOLD MODE                     SA41607 10920000
D0       EQU   0                  DISP OF 0                             10990000
D1       EQU   1                  DISP OF 1                             11060000
D2       EQU   2                  DISP OF 2                             11130000
D3       EQU   3                  DISP OF 3                             11200000
D4       EQU   4                  DISP OF 4                             11270000
D5       EQU   5                  DISP OF 5                             11340000
D6       EQU   6                  DISP OF 6                             11410000
D7       EQU   7                  DISP OF 7                             11480000
D8       EQU   8                  DISP OF 8                             11550000
D9       EQU   9                  DISP OF 9                             11620000
D10      EQU   10                 DISP OF 10                            11690000
D11      EQU   11                 DISP OF 11                            11760000
D12      EQU   12                 DISP OF 12                            11830000
D13      EQU   13                 DISP OF 13                            11900000
D14      EQU   14                 DISP OF 14                            11970000
D15      EQU   15                 DISP OF 15                            12040000
D16      EQU   16                 DISP OF 16                            12110000
D20      EQU   20                 DISP OF 20                            12180000
D22      EQU   22                 DISP OF 22                            12250000
D24      EQU   24                 DISP OF 24                            12320000
D28      EQU   28                 DISP OF 28                            12390000
D32      EQU   32                 DISP OF 32                            12460000
ACVT     EQU   16                 POINTER TO CVT ADDRESS                12530000
PRETERM  EQU   X'52'              DISP TO 1ST ENTRY IN TABLE            12600000
TRMAX    EQU   72                 TRM BUFFER LENGTH                     12670000
SLASH    EQU   X'61'              A / CHAR                              12740000
COMMA    EQU   X'6B'              A , CHAR                              12810000
D17      EQU   17                 DISP OF 17                            12880000
D18      EQU   18                 DISP OF 18                            12950000
D19      EQU   25                 DISP OF 25                     S22024 13020000
DCBNIDLE EQU   X'02'              3705 ACTIVE                    S22024 13090000
X40      EQU   X'40'              A BLANK CHAR                          13160000
RNTERM   EQU   X'E0'              RN TERMINAL (IF OFF)           S22024 13230000
XE0      EQU   X'E0'              QCB MASK SETTING                      13300000
RNLINE   EQU   X'80'              RN LINE CHECK                  S22024 13370000
TCAMDEB  EQU   X'44'              DEB BELONGS TO TCAM FLAG       S22024 13440000
DEFLEV   EQU   X'03'              DPRINT DEFAULT LEVEL                  13510000
PARMREG0 EQU   0                  REG 0                                 13580000
PARMREG1 EQU   1                  REG 1                                 13650000
RQINIT   EQU   X'0C'              START OF LIST                  S22024 13670000
RQEND    EQU   X'80'              END OF LIST                    S22024 13690000
D72      EQU   72                 LENGTH OF TRM BUFFER                  13720000
XBLANK   EQU   X'61'              A SLASH CHAR                          13790000
TWO      EQU   2                  DISP OF TWO                           13860000
FOUR     EQU   4                  DISP OF FOUR                          13930000
TRMSCCT  EQU   X'10'              SECONDARY SYSTEM CONSOLE ENTRY ?      14000000
PROMPTFL EQU   X'01'              PROMPTER RQ FLAG                      14070000
XFO      EQU   X'F0'              NUMERIC TESTER                        14140000
X52      EQU   X'52'              1060 CT FLAG                          14210000
X18      EQU   X'18'              DISP OF 24                            14280000
X24      EQU   X'24'              DISP OF 36                            14350000
X1C      EQU   X'1C'              DISP OF 28                            14420000
X10      EQU   X'10'              DCB OPEN FLAG                         14490000
X80      EQU   X'80'              LAST DUMMY ENTRY RQ FLAG              14560000
X14      EQU   X'14'              DISP OF 20                            14630000
X07      EQU   X'07'              LINE STOPPED FLAG                     14700000
DEQFLG   EQU   X'01'              DEQ REQUEST FLAG               S05331 14720000
ENQFLG   EQU   X'83'              ENQ REQUEST FLAG               S05331 14740000
HOLD     EQU   X'88'              'HOLD' OPERATOR CONTROL VERB CODE     14770000
UCB1060  EQU   X'52'              UCB SETTING FOR 1060 TERMINAL         14840000
ZERO     EQU   X'00'              CONSTANT VALUE                        14910000
CONFIGFL EQU   X'02'              INDICATES CONFIGURATOR REQUEST        14980000
TRMMAX   EQU   256                MAXIMUM LENGTH OF TRM                 15050000
LGBA     EQU   X'80'              LGB MAP                        S22024 15120000
X60      EQU   X'60'              MASK FIELD                    SA61759 15140000
TSONLY   EQU   X'40'              TSO ONLY SYSTEM CHECK         SA61759 15160000
         EJECT                                                          15190000
*********************************************************************** 15260000
*                                                                     * 15330000
*        PERFORM INITIALIZATION                                       * 15400000
*                                                                     * 15470000
*********************************************************************** 15540000
         SPACE 1                                                        15610000
         SPACE 2                                                        15680000
         SAVE  (14,12)                                                  15750000
         SPACE                                                          15820000
         DROP  R15                                                      15890000
         LR    R6,R15                   LOAD BASE                       15960000
         USING TOTOLTCB,R2                                              16030000
         USING IEDQWC,R6                                                16100000
         LA    R3,TOTSAVE4        GET MY SAVE AREA ADDR                 16170000
         ST    R3,D8(R13)         STORE IN CALLER'S SAVE AREA           16240000
         ST    R13,D4(R3)         SAVE MY SAVE AREA ADDR                16310000
         ST    R13,TOTRESSV       SAVE MOTHER TASK SAVE AREA ADDR       16380000
         LR    R13,R3                   SET R13 TO SAVE AREA            16450000
         SPACE 2                                                        16520000
         L     R10,TOTAVTPT       GET AVT ADDR                          16590000
         USING IEDQAVTD,R10                                    @Y17XAUU 16660000
         OI    $OLTFLGS,$RETCODE  SHOW RETURN CODE FTN SUPPORTED S22024 16900000
TRM000   EQU   *                                                        16940000
*                                                                       17010000
*        SAVE PARAMETER PASSED BY IEDQWB1                               17080000
*                                                                       17150000
         STH   R1,TRMSRCE         INDEX TO TERMNAME TABLE               17220000
         SRL   R1,D24             ADJUST TO GET FLAG BYTE               17290000
         STC   R1,NUMFLG          SAVE NUMERIC ENTRY FLAG BYTE          17360000
         SPACE                                                          17430000
         MVC   TRMWRK(D72),TOTTRMBF MOVE TRM TO WORK AREA               17500000
         SPACE                                                          17570000
         TM    NUMFLG,NUMEN       NUMERIC ENTRY                         17640000
         BO    TRMNUH             YES PROCESS                           17710000
         SPACE                                                          17780000
TRMCHK6  EQU   *                                                        17850000
         LA    R4,TRMWRK          PICK UP WORK AREA ADDRESS             17920000
         L     R3,AVTRNMPT        PICK UP ADDRESS OF TERMNAME TABLE     18480000
         ST    R3,TERNMTAB        SAVE IT                               18550000
         B     TRMCHK8            GO CONTINUE TRM PROCESSING            18620000
         SPACE                                                          18690000
         EJECT                                                          18760000
*********************************************************************** 18830000
*                                                                     * 18900000
*        PRE-PROCESSOR FOR NUMERIC ENTRY                              * 18970000
*                                                                     * 19040000
*********************************************************************** 19110000
         SPACE 2                                                        19180000
TRMNUH   EQU   *                                                        19250000
         SR    R4,R4              CLEAR REG 4                           19320000
         IC    R4,TOTTTBEL        GET MAX. NAME LENGTH                  19390000
         LA    R4,D3(R4)          ADJUST FOR ONE ENTRY                  19460000
         LH    R3,TRMSRCE         GET RELATIVE POS. OF TERM IN TT       19530000
         BCTR  R3,R0              DECREMENT BY 1                        19600000
         STH   R3,TRMSRCE         SAVE IT                               19670000
         MH    R4,TRMSRCE         GET DISP TO ENTRY                     19740000
         L     R5,AVTRNMPT        GET ADDR OF TERMNAME TABLE            19880000
         LA    R5,PRETERM(R5)     POINT PASS PREFIX                     19950000
         AR    R4,R5              POINT TO SYMBOLIC NAME OF RQ TER.     20020000
         SR    R5,R5              CLEAR REG 5                           20090000
         IC    R5,TOTTTBEL        GET MAX. NAME LENGTH                  20160000
         BCTR  R5,R0              DECREMENT BY ONE                      20230000
         EX    R5,EXMSYM          MOVE NAME TO WORK AREA                20300000
TRMNUH1  EQU   *                                                        20370000
         LA    R1,WORK1           POINT NAME                            20440000
         MVC   TOTCTNAM(D8),WORK1 SAVE CT NAME IN OLTCB                 20510000
         MVI   TOTCTNAM+D8,XBLANK SHOW END                              20580000
         LA    R10,D0             INIT COUNTER                          20650000
         SR    R3,R3              CLEAR REG 3                           20720000
         IC    R3,TOTTTBEL        GET MAX. NAME LENGTH                  20790000
         LA    R3,D1(R3)          INCREMENT BY 1                        20860000
TRMNUH3  EQU   *                                                        20930000
         CLI   D0(R1),X40         END OF NAME                           21000000
         BE    TRMNUH7            YES                                   21070000
         BCT   R3,TRMNUH5         SET UP TO CHECK NEXT CHAR             21140000
         B     TRMNUH7            BRANCH TO PUT NAME LENGTH INTO        21210000
*                                   PARAMETER LIST                      21280000
TRMNUH5  EQU   *                                                        21350000
         LA    R1,D1(R1)          POINT TO NEXT CHAR                    21420000
         LA    R10,D1(R10)        INCREMENT NAME COUNTER                21490000
         B     TRMNUH3            CHECK NEXT CHAR                       21560000
TRMNUH7  EQU   *                                                        21630000
         STC   R10,LENGTH         PUT NAME LENGTH IN P - LIST           21700000
         LA    R5,TRMWRK          POINT TO TRM                          21770000
         OI    TOTFLG09,TOTPRECT  SET CT EQUALS PRINTER FLAG            21840000
         B     TRMCK14A           EXIT TO VERIFY NAME                   21910000
EXMSYM   MVC   WORK1(D0),D0(R4)   MOVE RQ TERMINAL TO WORK AREA         21980000
         DROP  R10                                                      22050000
         EJECT                                                          22260000
*********************************************************************** 22330000
*                                                                     * 22400000
*        CONTINUE NORMAL TRM PROCESSING                               * 22470000
*                                                                     * 22540000
*********************************************************************** 22610000
         SPACE 1                                                        22680000
         SPACE 2                                                        22750000
TRMCHK8  EQU   *                                                        22820000
         LA    R5,TRMWRK          POINT TO TRM                          22890000
         OI    TOTFLG09,TOTPRECT  SET C.T. EQUALS PRINTER FLAG          22960000
TRMCHK11 EQU   *                                                        23030000
         MVC   WORK1(D9),D0(R5)   MOVE CONTROL TERM TO WORK AREA        23100000
         CLC   WORK1(D7),SYSCONL  CONTROL TERM. EQU SYSTEM CON          23170000
         BNE   TRM11A             NO, BRANCH                            23240000
         OI    TOTFLG09,TOTCTCON+TOTPRECT  TURN ON CONT TERM FLAG       23310000
         LA    R10,D7(R5)         POINT TO TEST DEVICE FIELD   @Y17XAUU 23310100
         LA    R3,TRMMAX          GET MAX TRM LENGTH ALLOWED   @Y17XAUU 23310200
TOTE1    DS    0H                 FIND END OF TEST DEV FIELD   @Y17XAUU 23310300
         CLI   D0(R10),SLASH      END REACHED                  @Y17XAUU 23310400
         BE    TOTE11             YES                          @Y17XAUU 23310500
         LA    R10,D1(R10)        BUMP TO NEXT FIELD           @Y17XAUU 23310600
         BCT   R3,TOTE1           CONTINUE SEARCH              @Y17XAUU 23310700
         B     TRMCK85            NO SLASH EQU ERROR           @Y17XAUU 23310800
TOTE11   DS    0H                 CHECK FOR DEALLOCATION REQ   @Y17XAUU 23310900
         CLC   D0(D7,R10),TOTE    DEALLOCATION TRM             @Y17XAUU 23311000
         BNE   TRMCK85            NO - CONTINUE                @Y17XAUU 23311100
         C     R3,TRMMAX          TEST DEVICE FIELD OMITTED    @Y17XAUU 23311200
         BE    TRMCK85            YES - ERROR                  @Y17XAUU 23311300
         L     R13,D4(R13)        RESTORE                      @Y17XAUU 23311400
         LM    R14,R0,D12(R13)    REGISTERS                    @Y17XAUU 23311500
         XCTL  (2,12),EP=IEDQWF1  PROCESS DEALLOCATION REQUEST @Y17XAUU 23311600
TRMCK85  DS    0H                                              @Y17XAUU 23311700
         LA    R10,D6             SET COUNTER REG FOR SYSCON            23380000
         MVC   WORK1+D6(D2),BLANK PAD WORK1 WITH BLANKS                 23450000
         LA    R5,D1(R5,R10)      BUMP POINTER TO NEXT FIELD            23520000
         B     TRM045             BRANCH                                23590000
TRM11CA  EQU   *                                                        23660000
         L     R3,TOTFLG01        WORD CONTAINING TOTCONFG     @G36XRUV 23730000
CSLOOP1  DS    0H                                              @G36XRUV 23740000
         LR    R4,R3              COPY                         @G36XRUV 23750000
         O     R4,SETCONFG        SET CONFIG BIT IN REG        @G36XRUV 23760000
         CS    R3,R4,TOTFLG01     SET TOTCONFG                 @G36XRUV 23770000
         BNZ   CSLOOP1            BR IF BYTE HAS CHANGED       @G36XRUV 23780000
****************************************************************        23800000
*        EXIT TO IEDQWB1 TO CHECK FOR DEVICE PROTECT FEATURE   *        23870000
*        AND SEND ON LINE TESTING ACTIVE MESSAGE               *        23940000
****************************************************************        24010000
TRMEND   EQU   *                                                        24080000
         TM    TOTFLG01,TOTCONFG+TOTPRMPT PROMPT OR CONFIG       S22024 24150000
         NI    TOTFLG04,XFF-TOTNUMDV CLEAR NUMERIC ENTRY FLAG   SA41614 24220000
         BNZ   TRMEND1            YES - ONE IS SET               S22024 24290000
         OI    TOTFLG02,TOTOLTRQ  SHOW ON-LINE TEST REQUEST      S22024 24360000
TRMEND1  EQU   *                                                 S22024 24430000
         L     R13,D4(R13)        PICK UP CALLERS SAVE AREA ADDRESS     24500000
         LM    R14,R0,D12(R13)    RESTORE REGS                          24570000
         XCTL  (2,12),EP=IEDQWB1  CONTINUE TRM PROCESSING               24640000
TRM11A   EQU   *                                                        24710000
         LA    R1,WORK1           FIND LENGTH OF CONTROL TERMINAL       24780000
         LA    R10,D0               IF IT IS LESS                       24850000
         LA    R3,D9                THAN 8 CHARACTERS                   24920000
TRMCHK12 EQU   *                                                        24990000
         CLI   D0(R1),SLASH       END OF FIELD?                         25060000
         BE    TRMCHK14                 YES BRANCH                      25130000
         BCT   R3,TRMCHK13              GREATER THAN 8?                 25200000
         B     TRMERROR                 YES GO TO ERROR ROUTINE         25270000
TRMCHK13 EQU   *                                                        25340000
         LA    R1,D1(R1)          NO BUMP POINTER                       25410000
         LA    R10,D1(R10)        BUMP COUNTER                          25480000
         B     TRMCHK12                 GO LOOK AGAIN                   25550000
TRMCHK14 EQU   *                                                        25620000
         STC   R10,LENGTH         SAVE LENGTH                           25690000
         LA    R9,D8              SET UP TO PAD WORK1 WITH BLANKS       25760000
         CR    R10,R9                  ALREADY 8 CHARS                  25830000
         BE    TRMCK14A           YES                                   25900000
         SR    R9,R10                  GET NUMBER OF POSITIONS TO FILL  25970000
         LA    R1,WORK1                GET WORK1 ADDRESS                26040000
         BCTR  R9,D0              DECREMENT FOR MOVE                    26110000
         AR    R1,R10                  POINT PAST NAME                  26180000
         EX    R9,BLMOVE               MOVE IN BLANKS                   26250000
TRMCK14A EQU   *                                                        26320000
         MVC   RNAME(D8),WORK1    MOVE CT NAME TO ENQ LIST              26390000
         BAL   R9,NAMESRCH              GO COMPARE                      26460000
         B     TRMFIND                  TERM NAME FOUND                 26530000
         B     TRMERROR                 NO BRANCH TO ERROR ROUTINE      26600000
BLMOVE   MVC   D0(D0,R1),BLANK    GENERAL BLANK MOVE                    26670000
TRMFIND  EQU   *                                                        26740000
         MVC   TOTCROFF(D2),TRMTTCIN SAVE CT REAL TTCIN        @Y17XAUU 26770000
         MVC   WORK3(D8),WORK1    SAVE CONTROL TERMINAL NAME            26810000
         MVC   TRMCTSAV(D8),WORK1 SAVE IT AGAIN                         26880000
         MVI   TRMRQFLG,CTREQ     SHOW C.T.REQUEST             @Y17XAUU 26950000
         SPACE                                                          27020000
         BAL   R9,DEVCHK          VERIFY CTL TERMINAL EQU DEVICE S22024 27090000
         MVC   TOTCRTNT(D4),TRMTNT SAVE REAL CT TNT ADDR         S22024 27160000
         BAL   R9,UCBFIND         GO FIND UCB ADDR               S22024 27230000
*                                                                S22024 27300000
*        ERROR RETURN IS D0(R9); GOOD RETURN IS TO D4(R9)        S22024 27370000
*                                                                S22024 27440000
         B     NOOPEN             ERROR EXIT                     S22024 27510000
         STH   R8,TOTCTUCB        CT UCB ADDR TO OLTCB           S22024 27580000
         SPACE                                                          27650000
         BAL   R9,DUMMYTNT        REQUEST DUMMY TNT                     27720000
         MVC   TRMNAME(D8),WORK1  MOVE FOR READ COMPARE                 27790000
         BAL   R9,LCBSCAN         FIND CT LCB ADDRESS                   27860000
         ST    R11,TOTCTLCB-D1    PUT LCB ADDRESS IN OLTCB              27930000
         MVC   TOTCTRLN(D1),TRMRLN  PUT RLN OF CT IN OLTCB              28000000
         LA    R5,D1(R10,R5)      POINT TO NEXT FIELD            S22024 28070000
TRM045   EQU   *                                                        28140000
         CLC   D0(D9,R5),PROMPT   PROMPT REQUEST?                       28210000
         BE    TRM050             YES                            S22024 28280000
         CLC   D0(D9,R5),CONFIG   IS CONFIG REQUESTED?                  28350000
         BNE   TRM11E                    NO                             28420000
         OI    SSFLG,CONFIGFL     YES, SET CONFIG INDICATOR             28490000
         B     TRM15Y                      AND BRANCH                   28560000
TRM050   DS    0H                 BOUNDARY ALLIGNMENT            S22024 28570000
         OI    SSFLG,PROMPTFL     SHOW PROMPT REQUEST            S22024 28580000
         L     R7,TOTFLG01        CONTAINS TOTPRMPT            @G36XRUV 28590000
CSLOOP2  DS    0H                                              @G36XRUV 28591000
         LR    R8,R7              COPY                         @G36XRUV 28592000
         O     R8,SETPRMPT        SET PROMPT FLAG IN REG       @G36XRUV 28593000
         CS    R7,R8,TOTFLG01     SET TOTPRMPT                 @G36XRUV 28594000
         BNZ   CSLOOP2            BR OF BYTE HAS CHANGED       @G36XRUV 28595000
         B     TRM15Y             ENQUEUE CT                     S22024 28600000
         EJECT                                                          28630000
*********************************************************************** 28700000
*                                                                     * 28770000
*        ROUTINE TO EVALUATE ALTERNATE PRINTER OPTION                 * 28840000
*                                                                     * 28910000
*********************************************************************** 28980000
         SPACE 1                                                        29050000
TRM11E   EQU   *                                                        29120000
         TM    NUMFLG,NUMEN       NUMERIC ENTRY ?                       29190000
         BO    TRM15Y             YES                                   29260000
TRM12    EQU   *                                                        29330000
         CLI   D0(R5),X40         BLANK CHAR                    SA41606 29400000
         BNE   TRM12A             NO                            SA41606 29470000
         OI    TOTFLG03,TOTTDFER  SET TEST DEV ERROR FLAG       SA41606 29540000
         B     TRMPROMT           GO TO PROMPTER                SA41606 29610000
TRM12A   EQU   *                                                SA41606 29680000
         CLC   D0(D2,R5),SLASH2   TWO SLASHES ?                         29750000
         BNE   TRM14              NO                                    29820000
TRM12D   DS    0H                 BOUNDARY ALLIGNMENT            S22024 29850000
         OI    TOTFLG03,TOTTDFER  SET TEST DEVICE ERROR FLAG            29890000
         B     TRMPROMT           GO TO PROMPTER                        29960000
TRM14    EQU   *                                                        30030000
         LR    R1,R5              SET UP TO FIND OPTIONS FIELD          30100000
         LA    R3,TRMMAX          SET TRM LENGTH MAXIMUM                30170000
         LA    R10,D2             SET COUNTER TO 2                      30240000
TRM15B   EQU   *                                                        30310000
         CLI   D0(R1),SLASH       END OF FIELD?                         30380000
         BE    TRM15A             YES, BRANCH                           30450000
         LA    R1,D1(R1)          BUMP POINTER                          30520000
         BCT   R3,TRM15B          GO EXAMINE NEXT BYTE                  30590000
         CL    R10,F2             ERROR IN TD FIELD              S22024 30660000
         BE    TRM12D             YES - EXIT                     S22024 30670000
         OI    TOTFLG03,TOTTSTER  ASSUME ERROR IN TEST FIELD     S22024 30680000
         B     TRMPROMT           GO TO PROMPTER                 S22024 30690000
TRM15A   EQU   *                                                        30730000
         LA    R1,D1(R1)          BUMP POINTER                          30800000
         BCT   R10,TRM15B         LOOK FOR END OF NEXT FIELD            30870000
TRM15E   EQU   *                                                        30940000
         CLI   D0(R1),SLASH       END OF OPTION FIELD?                  31010000
         BE    TRM15Y             YES - EXIT                            31080000
TRM15EA  EQU   *                                                        31150000
         CLC   D0(D3,R1),NAP      NAP OPTION SPECIFIED?                 31220000
         BNE   TRM15EB            NO, CHECK FOR AP                      31290000
         NI    $ERROPT,XFF-$ALTPRNT  TURN OFF AP OPTION                 31360000
         OI    TOTFLG09,TOTPRECT  SET NO ALTERNATE PRINTER FLAG         31430000
         LA    R1,D2(R1)          POINT PAST NA                         31500000
         B     TRM15F             GO CHECK NEXT FIELD                   31570000
TRM15EB  EQU   *                                                        31640000
         CLC   D0(D2,R1),AP       AP OPTION?                            31710000
         BNE   TRM15F             NO                                    31780000
         OI    $ERROPT,$ALTPRNT    SET AP OPTION                        31850000
         NI    TOTFLG09,XFF-TOTPRECT TURN OFF NO ALT PRNT FLAG          31920000
         B     TRM15D             BRANCH TO GET NEXT OPTION             31990000
TRM15F   EQU   *                                                        32060000
         LA    R1,D1(R1)          BUMP POINTER                          32130000
         BCT   R3,TRM15FB               LOOP IF NOT AT END     @OZ27338 32150082
         B     APCOM                    TRM TOO LONG           @OZ27338 32170082
TRM15FB  EQU   *                                                        32200000
         CLI   D0(R1),COMMA       OPTION DELIMITER ?                    32270000
         BE    TRM15FA                 YES BRANCH                       32340000
         CLI   D0(R1),SLASH       END OF FIELD ?                        32410000
         BNE   TRM15F             NO                                    32480000
         TM    $ERROPT,$ALTPRNT   HAS A TERMINAL BEEN ENTERED FOR AP?   32550000
         BZ    TRM15Y             NO                                    32620000
         B     TRM15H1            YES                                   32690000
TRM15FA  EQU   *                                                        32760000
         LA    R1,D1(R1)          BUMP POINTER PAST COMMA               32830000
         BCT   R3,TRM15EA               GO LOOK AT NEXT OPTION @OZ27338 32900082
         B     APCOM              OPTION ERROR                          33040000
TRM15D   EQU   *                                                        33110000
         LA    R1,D2(R1)          POINT PAST AP                         33180000
         LA    R10,D0             SET UP LENGTH COUNTER                 33250000
         LR    R4,R1              SAVE R1                               33320000
         LA    R3,D9              SET ERROR COUNTER                     33390000
TRM15G   EQU   *                                                        33460000
         CLI   D0(R1),COMMA       END OF AP OPTION ?                    33530000
         BE    TRM15H                  YES BRANCH                       33600000
         CLI   D0(R1),SLASH       END OF FIELD ?                        33670000
         BE    TRM15H                  YES BRANCH                       33740000
         LA    R10,D1(R10)        BUMP COUNTER BY 1                     33810000
         LA    R1,D1(R1)          BUMP POINTER                          33880000
         BCT   R3,TRM15G          LOOP UNTIL END OF AP FIELD            33950000
         B     APCOM              A.P. NAME TOO LONG                    34020000
APMOVE   MVC   WORK1(D0),D0(R4)   GENERAL MOVE                          34090000
TRM15H   EQU   *                                                        34160000
         LTR   R10,R10            IS NAME FIELD PRESENT?                34230000
         BZ    APCOM                NO: GO TO PROMPTER                  34300000
         STC   R10,LENGTH         SAVE LENGTH OF OPTION                 34370000
         BCTR  R10,D0             DECREMENT COUNTER                     34440000
         MVC   WORK1(D8),BLANK    FILL BUFFER WITH BLANKS               34510000
         EX    R10,APMOVE               MOVE NAME TO WORK AREA          34580000
         CLI   D0(R1),SLASH       END OF OPTION FIELD ?                 34650000
         BE    TRM15H1            YES                                   34720000
         B     TRM15FB            NO                                    34790000
TRM15H1  EQU   *                                                        34860000
         CLC   WORK1(D6),SYSCON   SYSTEM CONSOLE ?                      34930000
         BNE   TRM15H2                   NO                             35000000
         OI    TOTFLG09,TOTAPCON  SET ALT PRINTER EQU SYSCON   @YM0     35030000
         OI    TOTFLG09,TOTPRECT  ASSUME PRINTER EQU CT                 35070000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE ?               35140000
         BO    TRM15Y                    YES                            35210000
         NI    TOTFLG09,XFF-TOTPRECT CLEAR PRINTER EQU CT FLAG          35280000
         B    TRM15Y                  YES BRANCH                        35420000
TRM15H2  EQU   *                                                        35490000
         CLC   WORK1(D6),SYSOUT   SYSTEM OUTPUT DEVICE ?                35560000
         BNE   TRM15HA                   NO                             35630000
         NI    TOTFLG09,XFF-TOTPRECT CLEAR PRINTER EQU CT FLAG          35700000
         OI    TOTFLG09,TOTAPOUT  SET PRINTER EQU SYSOUT                35770000
         B     TRM15Y                  YES BRANCH                       35840000
TRM15HA  EQU   *                                                        35910000
         MVC   RNAME(D8),WORK1    MOVE AP NAME TO ENQ LIST              35980000
         MVC   TOTAPNAM(D8),WORK1 MOVE AP NAME TO OLTCB                 36050000
         BAL   R9,NAMESRCH             GO FIND ENTRY IN TERMNAME TABLE  36120000
         B     TRM15I                  BRANCH AROUND ERROR RETURN       36190000
         B     APCOM              ERROR                                 36260000
TRM15I   EQU   *                                                        36330000
         MVC   TOTAROFF(D2),TRMTTCIN SAVE AP REAL TTCIN        @Y17XAUU 36360000
         MVI   TRMRQFLG,APREQ     SHOW A.P. REQUEST            @Y17XAUU 36400000
         BAL   R9,DEVCHK          VERIFY AP EQU A TERMINAL       S22024 36470000
         MVC   TOTARTNT(D4),TRMTNT SAVE REAL AP TNT ADDR         S22024 36540000
         BAL   R9,UCBFIND         GO FIND UCB ADDR               S22024 36610000
         B     APNOER             ERROR EXIT                     S22024 36680000
         STH   R8,TOTAPUCB        AP UCB ADDR TO OLTCB           S22024 36750000
         BAL   R9,DUMMYTNT        REQUEST DUMMY TNT                     36820000
         TM    TRMFLG01,TRMCTEAP  CT EQU AP                      S22024 36890000
         BZ    TRM15I2            NO - PROCESS AP                S22024 36960000
         OI    TOTFLG09,TOTPRECT  SET CT EQU AP FLAG             S22024 37030000
         B     TRM15Y             BYPASS AP SETUP                S22024 37100000
TRM15I2  EQU   *                                                 S22024 37170000
         MVC   TRMNAME(D8),WORK1  MOVE FOR READ COMPARE                 37240000
         BAL   R9,LCBSCAN         GET AP LCB ADDR                       37310000
         ST    R11,TOTAPLCB-D1    PUT IT IN OLTCB                       37380000
         MVC   TOTAPRLN(D1),TRMRLN PUT RLN FOR AP IN OLTCB       S22024 37450000
         USING UCB,R8                                                   37520000
TRMAPENQ EQU   *                                                        37590000
         ENQ   ,MF=(E,ENQLIST)         REQUEST RESOURCE                 37660000
         LTR   R15,R15                 WAS IT ASSIGNED                  37730000
         BZ    TRM15I4                   YES                            37800000
         CLI   D3(R15),D8         WAS IT ALREADY ASSIGNED?              37870000
         BE    TRM15I4                   YES                            37940000
         TM    RNAME,XF0          ENQ FAIL ON UCB NAME           S05331 37947000
         BNO   TRMAPX             NO - BYPASS TERMINAL NAME DEQ  S05331 37954000
*        DEQ AP TERMINAL NAME                                    S05331 37961000
         MVI   ENQLIST+D2,DEQFLG  SET DEQ FLAG                   S05331 37968000
         MVC   RNAME(D8),TOTAPNAM AP NAME TO PLIST               S05331 37975000
         XC    TOTAPNAM(D8),TOTAPNAM CLEAR AP NAME FIELD         S05331 37982000
         DEQ   ,MF=(E,ENQLIST)    DEQ AP NAME                    S05331 37989000
TRMAPX   DS    0H                 BOUNDARY ALLIGNMENT            S05331 37996000
         WTO   'IED128I ALTERNATE PRINTER REQUESTED BY OLT ALREADY IN U*38010000
               SE',ROUTCDE=10,DESC=7                                    38080000
         B     APCOM              SHOW AP ERROR                         38150000
TRM15I4  EQU   *                                                        38220000
         TM    RNAME,XFO          HAS UCBNAME BEEN ENQ?                 38290000
         BO    TRM15I4A           YES - EXIT                            38360000
         MVC   RNAME(D8),BLANK    BLANK AP NAME FIELD            S22024 38430000
         MVC   RNAME(D3),UCBNAME  MOVE AP UCBNAME TO ENQ LIST           38500000
         B     TRMAPENQ           GO REQUEST RESOURCE                   38570000
TRM15I4A EQU   *                                                        38640000
         NI    TRMFLG04,XFF-CTRSID CLEAR CT FLAG                 S22024 38710000
         OI    TRMFLG04,APRSID    SHOW AP REQUEST                S22024 38780000
         BAL   R9,RNLINET         CHECK FOR RN TERM FOR L ENQ    S22024 38850000
         SPACE                                                          38920000
         SPACE                                                          38990000
         SPACE                                                          39060000
         OI    TOTFLG09,TOTPRECT  SET PRINTER EQU CT                    39130000
         CLC   TRMCTSAV(D8),TOTAPNAM CT = AP ?                          39200000
         BE    TRM15Y             YES                            S22024 39270000
         NI    TOTFLG09,XFF-TOTPRECT NO - SET                           39340000
         OI    TOTFLG09,TOTAPTRM  SET PRINTER EQU TERMINAL FLAG         39410000
         EJECT                                                          39480000
*********************************************************************** 39550000
*                                                                     * 39620000
*        FIND IF TRM WAS ENTERED FROM CONTROL TERMINAL                * 39690000
*                                                                     * 39760000
*********************************************************************** 39830000
         SPACE 1                                                        39900000
TRM15Y   EQU   *                                                        39970000
         TM    TOTFLG04,TOTNUMDV  RETURN FROM NUMERIC HANDLER ?         40040000
         BO    TRM080             YES                                   40110000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE ?               40180000
         BO    TRM080             YES - BRANCH                   S22024 40250000
         SLR   R8,R8              CLEAR                        @G36XRUV 40280000
         ICM   R8,3,TOTCTUCB      GET CT UCB ADDR              @G36XRUV 40320000
         USING UCB,R8                                                   40390000
         MVC   RNAME(D8),WORK3    GET CT NAME                           40460000
TRMCTENQ EQU   *                                                        40530000
         ENQ   ,MF=(E,ENQLIST)         REQUEST USE OF RESOURCE          40600000
         LTR   R15,R15                 WAS IT ASSIGNED?                 40670000
         BZ    TRM15Y4                   YES                            40740000
         CLI   D3(R15),D8         WAS IT PREVIOUSLY ASSIGNED?           40810000
         BE    TRM15Y4                   YES                            40880000
         L     R11,TOTCRTNT       CT TNT ADDR                    S05331 40885000
         SR    R7,R7              CLEAR REG                      S05331 40890000
         IC    R7,TOTTTBEL        MAXIMUM NAME LENGTH            S05331 40895000
         AR    R11,R7             POINT TO TTE ADDR              S05331 40900000
         MVC   TNTENTRY+D1(D3),D0(R11) CT TTE ADDR               S05331 40905000
         L     R7,TNTENTRY        CT TTE ADDR                    S05331 40910000
         USING IEDNTRM,R7                                        S05331 40915000
         LA    R1,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 40915200
         SLR   R7,R1              GET ADDRESS OF TTE PREFIX    @Y17XAUU 40915400
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 40915600
         BZ    TRMCTX             NO                             S05331 40930000
         OI    TOTCTFLG,TOTCTORN  CT ON 3705                     S05331 40935000
         DROP  R7                                                S05331 40940000
TRMCTX   DS    0H                 BOUNDARY ALLIGNMENT            S05331 40945000
         WTO   'IED133I C.T. REQUESTED BY OLT ASSIGNED TO ANOTHER OLT',*40950000
               ROUTCDE=10,DESC=7                                        41020000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 41022000
         BO    TRMCTXE            YES - EXIT                   @Y17XAUU 41024000
         IEDQMSG MSGID=053,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 41026000
TRMCTXE  DS    0H                                              @Y17XAUU 41028000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG             S05331 41090000
         L     R13,D4(R13)        CALLER'S SAVE AREA             S05331 41100000
         LM    R14,R1,D12(R13)    RESTORE REG 14-1               S05331 41110000
         XCTL  (2,12),EP=IEDQWE2  TERMINATE TRM                  S05331 41120000
TRM15Y4  EQU   *                                                        41160000
         TM    RNAME,XFO          HAS UCBNAME BEEN ENQ?                 41230000
         BO    TRM15Y4A           YES - EXIT                            41300000
         MVI   RNAME,X40          BLANK RNAME                           41370000
         MVC   RNAME+D1(D7),RNAME   FIELD                               41440000
         MVC   RNAME(D3),UCBNAME  MOVE CT UCBNAME TO ENQ LIST           41510000
         B     TRMCTENQ           GO REQUEST RESOURCE                   41580000
TRM15Y4A EQU   *                                                        41650000
         NI    TRMFLG04,XFF-APRSID CLEAR AP FLAG                 S22024 41720000
         OI    TRMFLG04,CTRSID    SHOW CT REQUEST                S22024 41790000
         L     R11,TOTCRTNT       CT TNT ADDR                    S22024 41860000
         SR    R7,R7              CLEAR REG                      S22024 41930000
         IC    R7,TOTTTBEL        MAX NAME LENGTH                S22024 42000000
         AR    R11,R7             POINT TO TTE ADDR              S22024 42070000
         MVC   TNTENTRY+D1(D3),D0(R11) CT TTE ADDR               S22024 42140000
         L     R7,TNTENTRY        TTE ADDR                       S22024 42210000
         USING IEDQTRM,R7                                        S22024 42280000
         L     R7,TRMDESTQ-D1     CT QCB ADDR                    S22024 42350000
         LA    R7,D0(R7)          CLEAR FLAG BYTE                S22024 42420000
         ST    R7,TRMQCB          SAVE IT                        S22024 42490000
         DROP  R7                                                S22024 42560000
         BAL   R9,RNLINET         CHECK FOR RN TERM FOR L ENQ    S22024 42630000
         TM    TOTFLG09,TOTCTCON  CONTROL TERM = SYSCON ?               42700000
         BO    TRM080             YES                                   42770000
         MVC   WORK1(D3),UCBNAME  MOVE LINE ADDRESS TO WORK AREA        42840000
         DROP  R8                                                       42910000
         BAL   R9,CTSTOP          VERIFY UCB NAME                       42980000
TRM080   EQU   *                                                        43610000
         TM    SSFLG,PROMPTFL+CONFIGFL PROMPT OR CONFIG REQUESTED       43680000
         BZ    TRM090                    NO                             43750000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE                 43820000
         BO    TRM090                    YES                            43890000
         SLR   R8,R8              CLEAR                        @G36XRUV 43960000
         ICM   R8,3,TOTCTUCB      GET CONTROL TERM UCB ADDR    @G36XRUV 43990000
         USING UCB,R8                                                   44030000
         CLI   UCBTBYT1,X52       1060?                                 44100000
         DROP  R8                                                       44170000
         BNE   TRM090                    NO                             44240000
         IEDQMSG MSGID=097,FUNCT=CEC,LINK=YES                           44310000
TRM085   EQU   *                                                 S22024 44380000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG                    44450000
         L     R13,D4(R13)        GET CALLER'S SAVE AREA ADDR           44520000
         LM    R14,R1,D12(R13)    RESTORE REGISTERS 14-1                44590000
         XCTL  (2,12),EP=IEDQWE   TERMINATE TRM                         44660000
TRM090   EQU   *                                                        44730000
         OI    TOTFLG05,TOTNDMSG  TURN ON ENDED MESSAGE FLAG            44800000
         TM    SSFLG,PROMPTFL     RETURN TO PROMPT LOAD?                44870000
         BO    TRMPT                   YES BRANCH                       44940000
         TM    SSFLG,CONFIGFL     RETURN TO CONFIG LOAD?                45010000
         BO    TRM11CA                 YES BRANCH                       45080000
         TM    NUMFLG,NUMEN       NUMERIC ENTRY ?                       45150000
         BO    TRM091             YES                                   45220000
         B     TRMEND             EXIT TO IEDQWB1                       45290000
TRM091   EQU   *                                                        45360000
         OI    TOTFLG04,TOTNUMDV  SET NUMERIC ENTRY FLAG        SA41614 45430000
         L     R13,D4(R13)        RESTORE SAVE REG              SA41614 45500000
         LM    R14,R1,D12(R13)    RESTORE REG 14-1              SA41614 45570000
         XCTL  (2,12),EP=IEDQWB1  EXIT TO IEDQWB1               SA41614 45640000
         EJECT                                                          45710000
         OI    TOTFLG05,TOTNDMSG  SET FLAG TO SEND TERMINATE FLAG       45780000
         SPACE                                                          45850000
**************************************************************** S22024 45920000
*                                                              * S22024 45990000
*        ROUTINE TO VERIFY THAT THE SYMBOLIC NAME ENTERED      * S22024 46060000
*        AS THE CONTROL TERMINAL OR ALTERNATE PRINTER IS A     * S22024 46130000
*        DEVICE AS OPPOSED TO A SUB CHANNEL HUNG OFF THE       * S22024 46200000
*        RN.                                                   * S22024 46270000
*                                                              * S22024 46340000
**************************************************************** S22024 46410000
DEVCHK   EQU   *                                                 S22024 46480000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS 7-11            S22024 46550000
         L     R11,TNTENTRY       GET TTE ADDR                   S22024 46620000
         LA    R7,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 46626000
         SLR   R11,R7             GET ADDRESS OF TTE PREFIX    @Y17XAUU 46632000
         USING IEDNTRM,R11                                       S22024 46760000
         TM    TRMSTATE,TRMPROC   VERIFY NOT PROCESS ENTRY     @Y17XAUU 46762000
         BO    DEVCHKE            BR IF YES                    @Y17XAUU 46764000
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 46766000
         BZ    DEVCHKE            NO - RETURN                    S22024 46900000
         CLI   TRMTYPE,TRMPUNT    PU ENTRY                     @Y17XAUU 46901000
         BE    DEVCHK8            YES - ERROR                  @Y17XAUU 46902000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 46903000
         BE    DEVCHK8            YES - ERROR                  @Y17XAUU 46904000
         CLI   TRMTYPE,TRMSSCP    SSCP ENTRY                   @Y17XAUU 46905000
         BE    DEVCHK8            YES - ERROR                  @Y17XAUU 46906000
         TM    TRMSTATE,RNTERM    TERMINAL ATTACHED TO RN        S22024 46970000
         BZ    DEVCHKE            YES                            S22024 47040000
*                                                              * S22024 47110000
*        AN INVALID ENTRY HAS BEEN MADE IN THE AP/CT FIELD.    * S22024 47180000
*        IF CT ERROR NOTIFY SYSTEM OPERATOR VIA A 'WTO'.       * S22024 47250000
*        IF AP ERROR SET ERROR FLAG AND CONTINUE PROCESSING.   * S22024 47320000
*                                                              * S22024 47390000
DEVCHK8  DS    0H                 BOUNDARY ALLIGNMENT            S22024 47420000
         CLI   TRMRQFLG,CTREQ     CONTROL TERMINAL ERROR       @Y17XAUU 47460000
         BNE   APCOM              NO - ASSUME AP ERROR           S22024 47530000
         B     TRMERROR           TERMINATE REQUEST              S22024 47600000
         SPACE                                                          47670000
DEVCHKE  EQU   *                                                 S22024 47740000
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 47742000
         BO    DEVCHKED           YES - BYPASS CHECK             S22024 47760000
         TM    TRMSTATE,XE0       TERMINAL ENTRY                 S22024 47770000
         BZ    DEVCHKED                 YES, VALID TERMINAL    @SA70654 47780056
         MVC   WRKFLG(D1),TRMSTATE      GET FLAG BYTE          @SA70654 47782056
         NI    WRKFLG,XE0               CLEAR UNWANTED FLAGS   @SA70654 47784056
         CLI   WRKFLG,RNLINE            270X DIAL TERMINAL     @SA70654 47786056
         BZ    DEVCHK8                  NO, ERROR              @SA70654 47788056
DEVCHKED DS    0H                 BOUNDARY ALLIGNMENT            22     47790000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS              S22024 47810000
         BR    R9                 RETURN                         S22024 47880000
         DROP  R11                                               S22024 47950000
         SPACE 3                                                        48020000
APCOM    EQU   *                                                        48090000
         OI    TOTFLG03,TOTAPOER  YES - SHOW OPTION ERROR               48160000
         B     TRMPROMT           GO TO PROMPTER                 S22024 48230000
         SPACE                                                          48300000
APNOER   EQU   *                                                        49630000
         TM    TRMFLG01,TRMINACV  3705 INACTIVE                  S22024 49700000
         BO    APNOER4            YES                            S22024 49770000
         OI    TOTFLG03,TOTAPOER  SHOW AP OPTION ERROR                  49840000
         NI    $ERROPT,XFF-$ALTPRNT CLEAR AP OPTION FLAG                49910000
         IEDQMSG MSGID=004,FUNCT=CEC  AP LINE NOT OPENED                49980000
         B     TRMPROMT           GOT TO PROMPTER                S22024 50050000
         SPACE                                                          50120000
APNOER4  EQU   *                                                 S22024 50190000
         OI    TOTFLG03,TOTAPOER  SHOW AP ERROR                  S22024 50260000
         OI    TOTFLG09,TOTPRECT  CT EQU AP                      S22024 50330000
         IEDQMSG MSGID=010,FUNCT=CEC 3705 INACTIVE MSG           S22024 50400000
         B     TRMPROMT           GO TO PROMPTER                 S22024 50470000
         EJECT                                                          50540000
TRMERROR EQU   *                                                        50610000
         WTO   'IED127I OLT REQUEST REJECTED, CONTROL TERMINAL UNIDENTI*50680000
               FIED',ROUTCDE=10,DESC=7                                  50750000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 50752000
         BO    TRMERR2            YES - EXIT                   @Y17XAUU 50754000
         IEDQMSG MSGID=077,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 50756000
TRMERR2  EQU   *                                                        50820000
         NI    TOTFLG06,XFF-TOTOTERM  CLEAR SECTION RESTART FLAG        50890000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG                    50960000
         L     R13,D4(R13)        PICK UP CALLERS SAVE AREA ADDRESS     51030000
         LM    R14,R12,D12(R13)   RESTORE CALLER'S REGISTERS            51100000
         SR    R15,R15            CLEAR RETURN CODE REG                 51170000
         BR    R14                RETURN TO MOTHER                      51240000
TRMPROMT EQU   *                                                        51310000
         OI    SSFLG,PROMPTFL     TURN ON PROMPT FLAG                   51380000
         B     TRM15Y             GO SEE IF I HAVE TO ENQUEUE           51450000
TRMPT    EQU   *                                                        51520000
         B     TRMEND             EXIT TO IEDQWB1                       51660000
*                                                                       51730000
         SPACE 2                                                        51800000
         SPACE                                                          51870000
         EJECT                                                          51940000
CTSTOP   EQU   *                                                        52010000
*                                                                       52080000
*        R8    HAS UCB ADDR IN IT                                       52150000
*                                                                       52220000
         ST    R11,REGSAVE        SAVE REGISTER 11                      52290000
         L     R1,TOTAVTPT        GET AVT ADDR                          52360000
         USING IEDQAVTD,R1                                              52430000
         L     R1,AVTTCB               GET ADDR OF TCB                  52500000
         DROP  R1                                                       52570000
         L     R1,D8(R1)          GET DEB CHAIN ADDRESS                 52640000
AGAIN    EQU   *                                                        52710000
         SR    R3,R3              CLEAR REGISTER 3                      52780000
         IC    R3,D16(R1)         GET NUMBER OF EXTENTS                 52850000
         LA    R5,D32(R1)         GET UCB CHAIN ADDRESS                 52920000
         L     R4,X18(R1)         GET DCB ADDRESS                       52990000
         MVC   MULT+D3(D1),X24(R4)  GET LCB LENGTH                      53060000
         L     R12,D4(R1)         GET NEXT DEB                          53130000
         USING IHADCB,R4                                                53200000
         TM    DCBDSORG+D1,TCAMDEB TCAM DEB                      S22024 53270000
         BZ    HERE1              NO, BRANCH                            53340000
         DROP  R4                                                       53410000
         LA    R7,D1              SET UP COUNTER                        53480000
HERE     EQU   *                                                        53550000
         L     R10,D0(R5)         GET UCB ADDRESS                       53620000
         LA    R10,D0(R10)          FROM CHAIN                          53690000
         LA    R8,D0(R8)          GET UCB ADDRESS THAT WAS PASSED       53760000
*                                   TO THE SUBROUTINE                   53830000
         CR    R8,R10             UCB ADDRESSES MATCH?                  53900000
         BE    THERE              YES, BRANCH                           53970000
         LA    R5,D4(R5)          GET NEXT UCB ADDRESS                  54040000
         LA    R7,D1(R7)          BUMP LINE COUNTER                     54110000
         BCT   R3,HERE            CHECK NEXT UCB ADDR                   54180000
HERE1    EQU   *                                                        54250000
         LR    R1,R12                  SET R1 TO NEXT DEB               54320000
         B     AGAIN              EVALUATE NEXT DEB EXTENT              54390000
THERE    EQU   *                                                        54460000
         LR    R11,R7                   SET UP MULTIPLICAND             54600000
         SR    R10,R10            CLEAR REGISTER 10                     54670000
         M     R10,MULT                 MULT BY LINE NO.                54740000
         L     R7,X1C(R4)         PICK UP IOB ADDRESS                   54810000
         L     R11,REGSAVE             RESTORE R11                      54880000
         BR    R9                      RETURN                           54950000
         EJECT                                                          55020000
**************************************************************** S22024 55090000
*                                                              * S22024 55160000
*        ROUTINE TO SEARCH TERMINAL NAME TABLE TO VERIFY THAT  * S22024 55230000
*        SYMBOLIC ENTRY FOR CONTROL TERMINAL OR ALTERNATE      * S22024 55300000
*        PRINTER IS VALID.                                     * S22024 55370000
*                                                              * S22024 55440000
**************************************************************** S22024 55510000
*                                                                       55580000
NAMESRCH EQU   *                                                        55650000
         SPACE                                                          55720000
         L     R14,TOTAVTPT       GET AVT ADDR                          55790000
         USING IEDQAVTD,R14                                             55860000
         L     R15,AVTRNMPT       GET ADDRESS OF TERMNAME TABLE         55930000
         ST    R15,TERNMTAB       SAVE IT                               56000000
         MVC   PAREMLST(D1),AVTBSX  GET OFFSET TO BINARY SEARCH ADDRESS 56070000
         L     R15,AVTMSGS-D1     VCON TABLE ADDRESS                    56140000
         L     R15,D8(R15)        LOAD ADDRESS OF A1 ROUTINE            56210000
         DROP  R14                                                      56280000
         LA    R1,PAREMLST              SET R1                          56350000
         LH    R0,TWO(R1)         LOAD CHAR STRING LEN                  56420000
         L     R1,FOUR(R1)        LOAD ADDR OF CHARS                    56490000
         BAL   R14,FOUR(R15)      BRANCH TO SCAN ROUTINE                56560000
         LTR   R15,R15            WAS NAME FOUND IN TABLE?              56630000
         BZ    D4(R9)             NAME NOT FOUND - ERROR                56700000
         SPACE                                                          56770000
         STM   R7,R9,TRMSAV1      SAVE REG 7-9                          56840000
         L     R8,TERNMTAB        SET START OF TABLE                    56910000
         USING IEDQTNTD,R8                                              56980000
         LA    R7,TNTFIRST        POINT TO FIRST ENTRY IN TABLE         57050000
         SR    R9,R9              CLEAR REG 9                           57120000
         IC    R9,TNTENLEN        GET MAX. LENGTH OF NAME FIELD         57190000
         LA    R9,D3(R9)          GET LENGTH OF 1 ENTRY                 57260000
         DROP  R8                                                       57330000
         BCTR  R15,D0             DECREMENT ENTRY REL. POSITION         57400000
         MR    R8,R15             GET DISPLACEMENT TO ENTRY DESIRED     57470000
         AR    R7,R9              GET DESIRED TNT ADDRESS               57540000
         ST    R7,TRMTNT          SAVE IT                               57610000
         LA    R1,D1(R15)         RESTORE ENTRY REL. POSITION           57680000
         STH   R1,TRMTTCIN        SAVE TTCIN                   @Y17XAUU 57690000
         LM    R7,R9,TRMSAV1      RESTORE REG 7-9                       57750000
         SPACE                                                          57820000
         L     R15,TERNMTAB       GET ADDRESS OF TERMNAME TABLE         57890000
         BALR  R14,R15            GO FIND TTE ADDRESS                   57960000
         ST    R1,TNTENTRY        SAVE TERMINAL ENTRY ADDRESS           58030000
         USING IEDQTRM,R1                                       SA61759 58038000
         TM    TRMDSORG,TRMLGB    LGB RATHER THAN A TTE          S22024 58040000
         BO    D4(R9)             YES - ERROR - NOT A TERMINAL   S22024 58042000
         L     R14,TOTAVTPT       GET AVT ADDRESS               SA61759 58042500
         USING IEDQAVTD,R14                                     SA61759 58043000
         MVC   WRKFLG(D1),AVTBIT1 GET ENVIRONMENTAL FLAG        SA61759 58043500
         NI    WRKFLG,X60         CLEAR UNWANTED BITS           SA61759 58044000
         CLI   WRKFLG,TSONLY      TSO ONLY SYSTEM               SA61759 58044500
         BE    TRMTSO             YES - TERMINATE TRM           SA61759 58045000
         DROP  R14                                              SA61759 58045500
         L     R1,TRMDESTQ-D1     DEST. QCB ADDR                SA61759 58046000
         DROP  R1                                               SA61759 58054000
         USING IEDQQCB,R1                                       SA61759 58062000
         TM    QCBFLAG,QCBTSSES   TSO TERMINAL                   S22024 58070000
         BO    TRMTSO             YES - TERMINATE TRM           SA61759 58078000
         TM    QCBDSFLG,QCBREUS+QCBNREUS+QCBCORE  ARE THERE     SA61759 58080000
*                                 ANY QUEUES USED               SA61759 58082000
         BZ    TRMTSO             NO - TERMINATE                SA61759 58084000
         DROP  R1                                               SA61759 58086000
         BR    R9                 RETURN TO CALLER                      58100000
TRMTSO   DS    0H                 BOUNDARY ALLIGNMENT           SA61759 58110000
         WTO   'IED216I TRM CANCELLED - TOTE CANNOT USE TSO DEVICE',ROU*58120000
               TCDE=10,DESC=7     TSO DEVICE REJECT MSG         SA61759 58130000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 58130500
         BO    TRM085             YES - EXIT                   @Y17XAUU 58131000
         IEDQMSG MSGID=078,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 58131500
         B     TRM085             EXIT TO CLEANUP               SA61759 58140000
         EJECT                                                          58170000
*                                                                       58240000
*                                                                       58310000
*        ROUTINE TO FIND UCB ADDR AFTER ENTRY IN TERMINAL TABLE HAS     58380000
*         BEEN FOUND                                                    58450000
*                                                                       58520000
*                                                                       58590000
UCBFIND  EQU   *                                                        58660000
         L     R8,TNTENTRY        GET TERMINAL ENTRY ADDRESS            58730000
         USING IEDQTRM,R8                                               58800000
         L     R8,TRMDESTQ-D1     GET QCB ADDRESS                       58870000
         DROP  R8                                                       58940000
         USING IEDQQCB,R8                                               59010000
         SR    R7,R7              CLEAR REGISTER 7                      59080000
         IC    R7,QCBRELLN        GET RELATIVE LINE NUMBER              59150000
         STC   R7,TRMRLN          SAVE CT RLN                           59220000
         SLL   R7,D2              MULTIPLY BY 4                         59290000
         L     R8,QCBDCBAD-D1     GET DCB ADDRESS                       59360000
         DROP  R8                                                       59430000
         USING IHADCB,R8                                                59500000
         TM    DCBDSORG,LGBA      LGB VS. DCB                    S22024 59570000
         BZ    UCB0X              NO                             S22024 59640000
         DROP  R8                                                S22024 59710000
         L     R1,TNTENTRY        GET TERMINAL ENTRY ADDRESS   @Y17XAUU 59710300
         BAL   R14,NCPTTE         GET NCP TTE ADDRESS          @Y17XAUU 59710600
*                                                              @Y17XAUU 59710900
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 59711200
*                                                              @Y17XAUU 59711500
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 59711800
         TM    TRMBYTE2,TRMRSACT  3705 ACTIVE                  @Y17XAUU 59712100
         BZ    UCB08              NO - ERROR                   @Y17XAUU 59712400
         TM    TRMBYTE2,TRMINPG   ACT/DEACT IN PROGRESS        @Y17XAUU 59712700
         BO    UCB08              YES - ERROR                  @Y17XAUU 59713000
         L     R1,TRMDESTQ-D1     GET NCP QCB ADDRESS          @Y17XAUU 59713300
         DROP  R1                                              @Y17XAUU 59713600
         USING IEDQQCB,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 59713900
         L     R8,QCBDCBAD-D1     GET DCB ADDRESS              @Y17XAUU 59714200
         DROP  R1                                              @Y17XAUU 59714500
         LA    R7,D4              SHOW RLN EQU 1                 S22024 60020000
UCB0X    EQU   *                                                 S22024 60060000
         USING IHADCB,R8                                         S22024 60200000
         TM    DCBOFLGS,X10       IS DCB OPEN?                          60270000
         BZ    D0(R9)             NO, BRANCH                            60340000
         L     R8,DCBDEBAD        GET DEB ADDRESS                       60410000
         DROP  R8                                                       60480000
         USING DEBNMSUB,R8                                              60550000
         SR    R15,R15            CLEAR REGISTER 15                     60620000
         IC    R15,DEBNMEXT       GET NUMBER OF EXTENTS                 60690000
         SLL   R15,D2             MULTIPLY BY 4                         60760000
UCB04    EQU   *                                                 S22024 61040000
         CR    R15,R7             IS DESIRED LINE OPENED?               61110000
         BL    D0(R9)             NO                                    61180000
         L     R8,DEBUCBAD-D4(R7) GET UCB ADDRESS                       61250000
         USING UCB,R8                                                   61320000
         MVC   WORK1(D3),UCBNAME  MOVE UCB ID IN EBCDIC                 61390000
         DROP  R8                                                       61460000
         B     D4(R9)             RETURN                                61530000
UCB08    EQU   *                                                 S22024 61600000
         OI    TRMFLG01,TRMINACV  SET 3705 INACTIVE FLAG         S22024 61670000
         B     D0(R9)             ERROR RETURN                   S22024 61740000
         EJECT                                                          61740500
*                                                             *@Y17XAUU 61741000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =      *@Y17XAUU 61741500
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE ADDRESS*@Y17XAUU 61742000
*        RETURN TO CALLER VIA REG 14.                         *@Y17XAUU 61742500
*                                                             *@Y17XAUU 61743000
NCPTTE   DS    0H                 BOUNDARY ALLIGHMENT          @Y17XAUU 61743500
         ST    R14,TRMSAVE3       SAVE RETURN ADDRESS          @YM08072 61744000
         LA    R8,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 61744600
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 61745200
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 61746000
NCPLOOP  DS    0H                 FIND NCP TTE                 @Y17XAUU 61746500
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 61747000
         LTR   R1,R1              ENTRY IN HIERARCHY           @YM07415 61747100
         BZR   R9                 NO - ERROR RETURN            @YM07415 61747200
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION      @Y17XAUU 61747500
*                                 ROUTINE ADDRESS              @Y17XAUU 61748000
         BALR R14,R15             FIND TTE ADDRESS             @Y17XAUU 61749000
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 61750000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 61750600
         BNE   NCPLOOP            NO - CHECK NEXT ENTRY        @Y17XAUU 61751200
         L     R14,TRMSAVE3       RESTORE RETURN ADDRESS       @YM08072 61752000
         BR    R14                RETURN TO CALLER             @Y17XAUU 61752600
         DROP  R1                                              @Y17XAUU 61753200
         EJECT                                                          61810000
**************************************************************** S22024 61880000
*        ROUTINE TO GO TO IEDQWB2 TO CALCULATE THE AMOUNT OF   * S22024 61950000
*        OF CORE NEEDED TO BUILD DUMMY ENTRIES FOR A SPECIFIED * S22024 62020000
*        REMOTE TERMINAL. CONTROL IS PASS TO IEDQWB TO ATTAIN  * S22024 62090000
*        THE ACTUAL CORE.  CONTROL IS THEN RETURNED TO IEDQWB2 * S22024 62160000
*        TO COPY THE ENTRIES.                                  * S22024 62230000
**************************************************************** S22024 62300000
DUMMYTNT EQU   *                                                 S22024 62370000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS                 S22024 62440000
         LA    R12,KTRM           PASS PARAMETERS                S22024 62510000
         XC    TRMFLG01(D1),TRMFLG01 CLEAR CONTROL FLAG          S22024 62580000
*                                                                S22024 62650000
         LINK  EP=IEDQWB2         CALCULATE CORE                 S22024 62720000
         CL    R15,ERRCD8         SNA LU REJECT                @XM05678 62740000
         BE    DUMFAILU           YES-WRITE ERROR MESSAGE      @XM05678 62760000
         LTR   R15,R15            REQUEST SUCCESSFUL             S22024 62790000
         BNZ   DUMFAIL            NO - ERROR                     S22024 62860000
         TM    TRMFLG01,TRMCTEAP  CT EQU AP                      S22024 62930000
         BO    DUMOUT             RETURN                         S22024 63000000
*                                                                S22024 63070000
         L     R10,TOTRESPL       ADDR OF TOTE RES. CTL BLK      S22024 63140000
         USING RESPL,R10                                         S22024 63210000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                   S22024 63280000
         POST  RESTECB1           POST REQUEST TO IEDQWB         S22024 63350000
         WAIT  ECB=TOTOTECB       WAIT FOR REQUEST TO BE HONORED S22024 63420000
*                                                                S22024 63490000
         CLI   TOTWKSPC,XFF       REQUEST SUCCESSFUL             S22024 63560000
         BE    DUMFAIL            NO - ERROR                     S22024 63630000
*                                                                S22024 63700000
         OI    TRMFLG01,TRMQWB3   SHOW SECOND PASS               S22024 63770000
         LA    R12,KTRM           PASS PARAMETERS                S22024 63840000
         LINK  EP=IEDQWB2         COPY ENTRIES                   S22024 63910000
         LTR   R15,R15            REQUEST SUCCESSFUL             S22024 63980000
         BNZ   DUMFAIL            NO - ERROR                     S22024 64050000
*                                                                S22024 64120000
DUMOUT   EQU   *                                                 S22024 64190000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS              S22024 64260000
         BR    R9                 RETURN                         S22024 64330000
         SPACE                                                          64337000
DUMFAILU EQU   *                                               @XM05678 64344000
         WTO   'IED586I OLT REQUEST REJECTED, SNA LU NOT IN SSCP-LU SES*64351000
               SION ONLY',ROUTCDE=10,DESC=7                    @XM05678 64358000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @XM05678 64365000
         BO    DUMEND             YES - EXIT                   @XM05678 64372000
         IEDQMSG MSGID=093,FUNCT=SRC                           @XM05678 64379000
         B     DUMEND             TERMINATE TRM                @XM05678 64386000
         SPACE 2                                                        64400000
DUMFAIL  EQU   *                                                        64470000
         WTO   'IED215I OLT REQUEST REJECTED, UNABLE TO ALLOCATE RESOUR*64540000
               CES FOR CT/AP',ROUTCDE=10,DESC=7                         64610000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 64612000
         BO    DUMEND             YES - EXIT                   @Y17XAUU 64614000
         IEDQMSG MSGID=080,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 64616000
         SPACE                                                          64680000
DUMEND   EQU   *                                                        64750000
         L     R13,D4(R13)        RESTORE CALLERS SAVE AREA ADDRESS     64820000
         LM    R14,R12,12(R13)    RESTORE CALLER'S REG                  64890000
         SR    R15,R15            CLEAR REG                             64960000
         BR    R14                RETURN                                65030000
         SPACE                                                          65100000
         EJECT                                                          65170000
NOOPEN   EQU   *                                                        65240000
         TM    TRMFLG01,TRMINACV  3705 INACTIVE                  S22024 65310000
         BZ    NOOP2              NO                             S22024 65380000
         WTO   'IED217I 3705 NOT ACTIVE',ROUTCDE=10,DESC=7       S22024 65450000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 65452000
         BO    TRMERR2            YES - EXIT                   @Y17XAUU 65454000
         IEDQMSG MSGID=086,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 65456000
         B     TRMERR2            EXIT                           S22024 65520000
NOOP2    EQU   *                                                 S22024 65590000
         WTO   'IED130I OLT REQUEST REJECTED, CONTROL TERMINAL NOT OPEN*65660000
               ED',ROUTCDE=10,DESC=7                                    65730000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 65732000
         BO    TRMERR2            YES - EXIT                   @Y17XAUU 65734000
         IEDQMSG MSGID=092,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 65736000
         B     TRMERR2            BR TO SET UP FOR TERMINATION          65800000
         SPACE 4                                                        65870000
LCBSCAN  EQU   *                                                        65940000
         STM   R10,R12,TRMSAVE1   SAVE REG 10-12                        66010000
         STM   R5,R9,TRMSAVE2     SAVE REG 5-9                          66080000
         L     R5,TRMQCB          GET CT QCB ADDRESS                    66150000
         USING IEDQQCB,R5                                               66220000
         LA    R5,D0(R5)          CLEAR HI ORDER BYTE                   66290000
         L     R9,QCBDCBAD-D1     GET DCB ADDRESS                       66360000
         USING IHADCB,R9                                                66430000
         TM    DCBDSORG,LGBA      LGB VS DCB                     S22024 66500000
         BZ    LCB0X              NO                             S22024 66570000
         DROP  R9                                                S22024 66640000
         L     R1,TNTENTRY        GET TERMINAL TTE ADDRESS     @Y17XAUU 66641000
         BAL   R14,NCPTTE         FIND NCP TTE ADDRESS         @Y17XAUU 66642000
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 66643000
         L     R5,TRMDESTQ-D1     GET QCB ADDRESS              @Y17XAUU 66644000
         DROP  R1                                              @Y17XAUU 66645000
         L     R9,QCBDCBAD-D1     GET DCB ADDRESS              @Y17XAUU 66646000
         USING IHADCB,R9                                         S22024 66920000
LCB0X    EQU   *                                                 S22024 66990000
         L     R7,DCBDEBAD        GET DEB ADDR                          67060000
         USING DEBNMSUB,R7                                              67130000
         SR    R8,R8              CLEAR REG 8                           67200000
         IC    R8,DEBNMEXT        GET DEB NUMBER OF EXTENTS             67270000
         DROP  R7                                                       67340000
         SR    R7,R7              CLEAR REG 7                           67410000
         IC    R7,QCBRELLN        GET QCB'S STARTING RLN                67480000
         TM    TRMFLG01,TRM3705   3705 MODE                      S22024 67550000
         BZ    LCB04              NO                             S22024 67620000
         LA    R7,D1              SET RLN EQU 1                  S22024 67690000
LCB04    EQU   *                                                 S22024 67760000
         DROP  R5                                                       67830000
         LR    R5,R7              COPY RLN FOR NEXT TEST                67900000
         BCTR  R5,D0              GET RLN MINUS 1                       67970000
         SR    R8,R5              GET COUNT OF LCB'S TO SCAN            68040000
         SR    R12,R12            CLEAR REG 12                          68110000
         IC    R12,DCBEIOBX       GET LCB SIZE                          68180000
         LR    R11,R7             SAVE QCB'S STARTING RLN               68250000
         MR    R10,R12            GET STARTING LCB OFFSET               68320000
         AL    R11,DCBIOBAD       POINT TO IOB OF LCB                   68390000
         DROP  R9                                                       68460000
         S     R11,F32            ADJUST TO START OF LCB                68530000
         CLI   TRMRQFLG,CTREQ     C.T.REQUEST?                 @Y17XAUU 68600000
         BE    LCBSS4             YES                                   68670000
         LA    R5,TOTAPDFL        AP INIT STATUS FLAGS                  68740000
         B     LCBSS8             BRANCH TO TEST LINE STATUS            68810000
LCBSS4   EQU   *                                                        68880000
         LA    R5,TOTCTDFL        CT INIT STATUS FLAGS                  68950000
LCBSS8   EQU   *                                                        69020000
         TM    TRMFLG01,TRM3705   3705 MODE?                     S05331 69024000
         BZ    MODE0X             NO, BRANCH                     S05331 69028000
         L     R8,TNTENTRY        GET TERMINAL TTE ADDRESS     @Y17XAUU 69029000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 69030000
         SR    R8,R1              POINT TO TTE PREFIX          @Y17XAUU 69031000
         USING IEDNTRM,R8         ESTABLISH ADDRESSABILITY     @Y17XAUU 69031200
LINELOOP DS    0H                 FIND LINE TTE                @Y17XAUU 69033200
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 69035200
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION      @Y17XAUU 69037200
*                                 ROUTINE ADDRESS              @Y17XAUU 69039200
         BALR  R14,R15            FIND TTE ADDRESS             @Y17XAUU 69041200
         LR    R8,R1              GET TTE ADDRESS              @Y17XAUU 69043200
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 69045200
         SR    R8,R1              POINT TO TTE PREFIX          @Y17XAUU 69047200
         CLI   TRMTYPE,TRMNSDLC   PRE SNA LINE ENTRY           @Y17XAUU 69049200
         BE    LINEFND            YES                          @Y17XAUU 69051200
         CLI   TRMTYPE,TRMSDLC    SNA LINE ENTRY               @Y17XAUU 69053200
         BNE   LINELOOP           CHECK NEXT ENTRY             @Y17XAUU 69055200
LINEFND  DS    0H                 LINE ENTRY FOUND             @Y17XAUU 69057200
         TM    TRMLINK,TRMLACTV   LINE STOPPED                 @Y17XAUU 69059200
         BO    LCBSSC             NO                           @Y17XAUU 69061200
         OI    D0(R5),TOTCTLST    SHOW LINE INITIALLY STOPPED    S05331 69068000
         B     LCBSSC             BRANCH                         S05331 69072000
         DROP  R8                 DROP QCB BASE                  S05331 69076000
MODE0X   EQU   *                                                 S05331 69080000
         USING IEDQLCB,R11                                              69090000
         TM    LCBSTAT1,X07       LINE STOPPED?                         69160000
         BNZ   LCBSSC             NO                                    69230000
         OI    D0(R5),TOTCTLST    SHOW CT INIT. STOPPED                 69300000
LCBSSC   EQU   *                                                        69370000
         DROP  R11                                                      69440000
         LM    R5,R9,TRMSAVE2     RESTORE REG 5-9                       69510000
         L     R10,TRMSAVE1       RESTORE REG 10                        69580000
         L     R12,TRMSAVE1+8     RESTORE REG 12                        69650000
         BR    R9                 RETURN TO CALLER                      69720000
         EJECT                                                          69790000
**************************************************************** S22024 69860000
*        ROUTINE TO FIND THE SYMBOLIC NAME OF THE RN LINE      * S22024 69930000
*        FOR THE TERMINAL ATTACHED TO THE RN.                  * S22024 70000000
**************************************************************** S22024 70070000
RNLINET  EQU   *                                                 S22024 70140000
         STM   R7,R11,TRMSAVE2    SAVE CALLER'S REG              S22024 70210000
         L     R11,TNTENTRY       TTE ADDR                       S22024 70280000
         USING IEDNTRM,R11                                       S22024 70350000
         LA    R7,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 70355000
         SLR   R11,R7             TTE PREFIX ADDRESS           @Y17XAUU 70360000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 70365000
         BZ    RNLINEND           NO                             S22024 70560000
         TM    TRMSTATE,XE0       RN TERMINAL                    S22024 70630000
         BNZ   RNLINEND           NO                             S22024 70700000
         LH    R7,TRMTTCIN        GET TERMINAL TTCIN                    70710000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S22024 70840000
         BZ    RN02               NO - ASSUME AP                 S22024 70910000
         OI    TOTCTFLG,TOTCTORN  CT ON 3705                     S22024 70980000
         STH   R7,TOTCROFF        CT REAL TTCIN                @Y17XAUU 71050000
         LA    R7,TOTCRSID        ADDRESS OF CT NETWORK ADDR   @Y17XAUU 71080000
         B     RN03               EXIT                           S22024 71120000
RN02     EQU   *                                                 S22024 71190000
         OI    TOTAPFLG,TOTAPORN  AP ON 3705                     S22024 71260000
         STH   R7,TOTAROFF        AP REAL TTCIN                @Y17XAUU 71330000
         LA    R7,TOTARSID        ADDRESS OF AP NETWORK ADDR   @Y17XAUU 71360000
RN03     EQU   *                                                 S22024 71400000
         L     R4,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 71410000
         USING IEDQAVTD,R4        SET AVT ADDRESSABILITY       @Y17XAUU 71420000
         L     R4,AVTSAVTP        GET SAVT ADDRESS             @Y17XAUU 71430000
         DROP  R4                                              @Y17XAUU 71440000
         USING IEDNSVTD,R4        SET SAVT ADDRESSABILITY      @Y17XAUU 71450000
         L     R15,SAVTTNTX       TTCIN TO NETWORK ADDR RTN    @Y17XAUU 71470000
         DROP  R4                                              @Y17XAUU 71480000
         LH    R1,TRMTTCIN        GET TERMINAL TTCIN           @Y17XAUU 71490000
         BALR  R14,R15            CALL CONVERSION ROUTINE      @Y17XAUU 71500000
         STH   R15,D0(R7)         SAVE NETWORK ADDRESS         @YM07278 71510000
         L     R10,TRMQCB         GET QCB ADDR                   S22024 71540000
         USING IEDQQCB,R10                                       S22024 71610000
         L     R10,QCBLGBAD-D1    LGB ADDR                       S22024 71680000
         LA    R10,D0(R10)        CLEAR HIGH ORDER BYTE          S22024 71750000
         DROP  R10                                               S22024 71820000
         USING IEDNLGB,R10                                       S22024 71890000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S22024 71960000
         BZ    RN03F              NO                             S22024 72030000
         MVC   TOTCTRNL(D8),LGBNAME SAVE CT LINE GROUP NAME      S22024 72100000
         B     CHKTTE             EXIT                         @Y17XAUU 72170000
RN03F    EQU   *                                                 S22024 72240000
         MVC   TOTAPRNL(D8),LGBNAME SAVE AP LINE GROUP NAME             72310000
         DROP  R10                                             @Y17XAUU 72313000
CHKTTE   DS    0H                 FIND LINE ENTRY              @Y17XAUU 72316000
         LH    R1,TRMCOHRT        GET TTCIN OF NEXT ENTRY      @Y17XAUU 72319000
         LR    R9,R1              SAVE TTCIN                   @Y17XAUU 72322000
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION RTN  @Y17XAUU 72325000
         BALR  R14,R15            FIND TTE ADDRESS             @Y17XAUU 72328000
         LR    R11,R1             SET TTE BASE                 @Y17XAUU 72331000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 72332000
         SLR   R11,R1             POINT TO TTE PREFIX          @Y17XAUU 72333000
         CLI   TRMTYPE,TRMNSDLC   NON SNA LINE                 @Y17XAUU 72334000
         BE    LINETTE            YES - LINE TTE FOUND         @Y17XAUU 72337000
         CLI   TRMTYPE,TRMSDLC    SNA LINE                     @Y17XAUU 72340000
         BE    LINETTE            YES - LINE TTE FOUND         @Y17XAUU 72343000
         B     CHKTTE             CHECK NEXT ENTRY             @Y17XAUU 72346000
LINETTE  DS    0H                 FIND LINE SYMBOLIC NAME      @Y17XAUU 72349000
         BCTR  R9,R0              DECREMENT FOR MULTIPLY       @Y17XAUU 72352000
         L     R1,TERNMTAB        SET TNT BASE                 @Y17XAUU 72355000
         USING IEDQTNTD,R1        ESTABLISH ADDRESSABILITY     @Y17XAUU 72358000
         SR    R8,R8              CLEAR REGISTER               @Y17XAUU 72361000
         IC    R8,TNTENLEN        LENGTH OF NAME               @Y17XAUU 72364000
         LA    R8,D3(R8)          TOTAL LEN OF A TNT ENTRY     @Y17XAUU 72367000
         MR    R8,R8              OFFSET TO TNT ENTRY          @Y17XAUU 72370000
         LA    R10,TNTFIRST(R9)   LINE TNT ADDRESS             @Y17XAUU 72373000
         DROP  R1                                              @Y17XAUU 72376000
         SPACE                                                          75950000
*                                                                S22024 76020000
*        ENQUEUE THE RN LINE SHARED                              S22024 76090000
*                                                                S22024 76160000
RN0C     EQU   *                                                        76230000
         SR    R9,R9              CLEAR REG                      S22024 76300000
         IC    R9,TOTTTBEL        MAX NAME LENGTH                S22024 76370000
         BCTR  R9,R0              DECREMENT FOR EXECUTE          S22024 76440000
         EX    R9,RNENQ           MOVE RN LINE NAME TO ENQ LIST  S22024 76510000
         SPACE                                                          76580000
         ENQ   ,MF=(E,ENQLIST)    ENQ RN LINE                    S22024 76650000
         LTR   R15,R15            WAS IT ASSIGNED                S05331 76652000
         BZ    RNLINEND           YES                            S05331 76654000
         CLI   D3(R15),D8         WAS IT PREVIOUSLY ASSIGNED     S05331 76656000
         BE    RNLINEND           YES                            S05331 76658000
*        DEQ TERMINAL NAME AND UCB - ERROR EXIT                  S05331 76660000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S05331 76662000
         BZ    RN10               NO - ASSUME AP                 S05331 76664000
         SR    R8,R8              CLEAR                        @G36XRUV 76665000
         ICM   R8,3,TOTCTUCB      GET CT UCB ADDR              @G36XRUV 76666000
         LA    R7,WORK3           ADDR OF CT NAME                S05331 76668000
         B     RN14               CONTINUE PROCESSING            S05331 76670000
RN10     DS    0H                 BOUNDARY ALLIGNMENT            S05331 76672000
         SR    R8,R8              CLEAR                        @G36XRUV 76673000
         ICM   R8,3,TOTAPUCB      GET AP UCB ADDR              @G36XRUV 76674000
         LA    R7,TOTAPNAM        ADDR OF AP NAME                S05331 76676000
RN14     DS    0H                 BOUNDARY ALLIGNMENT            S05331 76678000
         USING UCB,R8                                            S05331 76680000
         MVI   ENQLIST+D2,DEQFLG  SET DEQ FLAG                   S05331 76682000
         MVC   RNAME(D8),D0(R7)   GET TERMINAL NAME              S05331 76684000
         DEQ   ,MF=(E,ENQLIST)    DEQ IT                         S05331 76686000
         MVI   RNAME,X40          BLANK NAME                     S05331 76688000
         MVC   RNAME+D1(D7),RNAME   FIELD                        S05331 76690000
         MVC   RNAME(D3),UCBNAME  GET UCB NAME                   S05331 76692000
         DEQ   ,MF=(E,ENQLIST)    DEQ IT                         S05331 76694000
         MVI   ENQLIST+D2,ENQFLG  RESTORE ENQ FLAG               S05331 76696000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S05331 76698000
         BO    TRMCTX             YES - TERMINATE TRM            S05331 76700000
         B     APCOM              SHOW AP ERROR                  S05331 76702000
         SPACE                                                          76720000
RNLINEND EQU   *                                                 S22024 76790000
         LM    R7,R11,TRMSAVE2    RESTORE REG                    S22024 76860000
         BR    R9                 RETURN                         S22024 76930000
RNENQ    MVC   RNAME(D0),D0(R10)  MOVE RN LINE NAME TO ENQ LIST         77000000
         EJECT                                                          77070000
SETCONFG DS    0F                 USED TO SET TOTCONFG W/ C&S  @G36XRUV 77170000
         DC    AL1(TOTCONFG)                                   @G36XRUV 77270000
         DC    AL3(0)                                          @G36XRUV 77370000
SETPRMPT DS    0F                 USED TO SET TOTPRMPT W/ C&S  @G36XRUV 77470000
         DC    AL1(TOTPRMPT)                                   @G36XRUV 77570000
         DC    AL3(0)                                          @G36XRUV 77670000
TRMSAVE3 DS    A                        REGISTER SAVE AREA     @YM08072 77770000
ERRCD8   DC    F'8'               ERROR RETURN CODE            @XM05678 78070000
TRMCTSAV DC    8XL1'40'           CT NAME SAVE AREA              S22024 78540000
F2       DC    F'2'               VALUE OF 2                     S22024 78570000
OFFSET   DS    H                  3705 LINE TNT OFFSET           S22024 78610000
TRMTTCIN DC    H'0'               TTCIN SAVE AREA              @Y17XAUU 78620000
TMRQLADR DC    8CL1' '                  SYMBOLIC NAME FIELD             78630000
PATCH    DC    100XL1'0'          IEDQWC PATCH AREA            @Y17XAUU 78680000
         SPACE 2                                                        78750000
**************************************************************** S22024 78820000
KTRM     DS    0F                 P-LIST PASSED TO QWB2          S22024 78890000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS         S22024 78960000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS         S22024 79030000
TRMQCB   DS    A                  CT/AP QCB ADDRESS              S22024 79100000
TRMTNT   DS    A                  CT/AP TNT ADDRESS              S22024 79170000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA            S22024 79240000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA            S22024 79310000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA            S22024 79380000
REGSAVE  DS    F                  WORK AREA                      S22024 79450000
F32      DC    F'32'              VALUE OF 32                    S22024 79730000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @YM08027 79830000
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @YM08027 79930000
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @YM08027 80030000
KDRQ     DS    A                  TRUE DRQ ADDRESS             @YM08027 80130000
KPQCBSZ  DS    H                  P-QCB SIZE                   @YM08027 80230000
KMQCBSZ  DS    H                  M-QCB SIZE                   @YM08027 80330000
KDRQSZ   DS    H                  DRQ SIZE                     @YM08027 80430000
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @YM08027 80530000
TTECSZ   DS    CL1                CONC TTE SIZE                @YM08027 80630000
TRMRQFLG DC    X'00'              DUMMY TNT REQUEST FLAG         S22024 80780000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 80790000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 80800000
PRREQ    EQU   X'20'              PRIMARY TEST DEVICE REQUEST  @Y17XAUU 80810000
SCREQ    EQU   X'10'              SECONDARY TEST DEV REQUEST   @Y17XAUU 80820000
TRMFLG01 DS    CL1                CONTROL FLAG                   S22024 80990000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC      S22024 81060000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE               S22024 81130000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION           S22024 81200000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE        S22024 81270000
TRM3705  EQU   X'04'              3705 MODE                      S22024 81340000
TRMCTEAP EQU   X'02'              CT EQU AP                      S22024 81410000
TRMINACV EQU   X'01'              3705 INACTIVE                  S22024 81480000
WRKFLG   DS    CL1                WORK AREA                      S22024 81550000
**************************************************************** S22024 82320000
         SPACE                                                          82460000
MULT     DC    F'0'               WORK AREA                    @Y17XAUU 82490000
WORK1    DC    8X'0'              PLACE FOR CT/AP NAME                  82880000
WORK3    DS    CL8                SAVE AREA FOR CTL TERM. NAME          82950000
WORK4    DS    3F                 WORK AREA                             83020000
F8       DC    F'8'               VALUE OF 8                     S22024 83090000
TRMSRCE  DS    H                  INDEX TO TERMINAME TABLE ENTRY        83160000
TRMNAME  DC    8C' '              PLACE FOR CT/AP NAME                  83230000
TRMFLG   DC    X'00'              TRM FLAGS                             83300000
NUMFLG   DC    X'00'              CONTROL FLAG                          83370000
NUMEN    EQU   X'80'              NUMERIC ENTRY                         83440000
         DS    0F                 USED FOR ALLIGNMENT                   83510000
PAREMLST DS    0CL8               BINARY SEARCH PARM-LIST               83580000
         DS    CL1                OFFSET TO BINARY SEARCH ADDRESS       83650000
         DC    X'00'              FLAG BYTE 1                           83720000
         DC    X'00'              FLAG BYTE 2                           83790000
LENGTH   DS    CL1                LENGTH OF TERMINAL NAME               83860000
         DC    A(WORK1)           ADDRESS OF TERMINAL NAME              83930000
SSFLG    DC    X'00'              CONTROL BYTE                          84000000
         DS    0H                 USED FOR ALLIGNMENT                   84070000
BLANK    DC    8X'40'             OR FIELD                              84140000
*                                                                       84210000
*                                                                       84280000
ENQLIST  ENQ   (QNAME,RNAME,S,8,STEP),RET=USE,MF=L  ENQUEUE PARAMETER  *84350000
                                                      LIST FOR CT/AP    84420000
QNAME    DC    CL8'SYSZTOTE'      MAJOR ELEMENT                @Y17XAUU 84430000
RNAME    DC    8CL1' '            RESOURCE NAME FOR ENQUEUE             84560000
TRMRLN   DS    CL1                CT/AP RLN                             84630000
SLASH2   DC    CL3'///'           THREE SLASHES                         84700000
SYSOUT   DC    C'SYSOUT'          COMPARE FIELD                         84770000
SYSCON   DC    C'SYSCON'          COMPARE FIELD                         84840000
SYSCONL  DC    C'SYSCON/'         CT EQU SYSTEM CONSOLE                 84910000
CONFIG   DC    C'//CONFIG/'       CONFIG COMPARE FIELD                  84980000
PROMPT   DC    C'//PROMPT/'       PROMPT COMPARE FIELD                  85050000
TOTE     DC    C'/TOTE//'         DEALLOCATION REQUEST         @Y17XAUU 85060000
TRMFLG04 DC    X'00'              FLAG BYTE                      S22024 85120000
CTRSID   EQU   X'80'              CT RSID INDICATOR              S22024 85190000
APRSID   EQU   X'40'              AP RSID INDICATOR              S22024 85260000
NAP      DC    C'NAP'             NO ALTERNATE PRINTER COMPARE FIELD    85330000
AP       DC    C'AP'              ALTERNATE PRINTER COMPARE FIELD       85400000
         EJECT                                                          85470000
         TLGBD                                                   S22024 85540000
         EJECT                                                          85610000
         TQCBED                                                         85680000
         EJECT                                                          85750000
         TDRQD                                                          85820000
         EJECT                                                          85960000
         TPRIOR                                                         86030000
         EJECT                                                          86100000
         TQCBD                                                          86170000
         EJECT                                                          86240000
DCBDSECT DCBD  DSORG=TX                                                 86310000
         EJECT                                                          86380000
         TSCBD                                                          86450000
         EJECT                                                          86520000
         TPRFD                                                          86590000
         EJECT                                                          86660000
         TLCBD                                                          86730000
         EJECT                                                          86800000
CVT      DSECT                                                          86870000
         CVT                                                            86940000
         EJECT                                                          87010000
UCB      DSECT                                                          87080000
         IEFUCBOB                                                       87150000
         EJECT                                                          87220000
         TAVTD                                                          87290000
         EJECT                                                          87360000
         TTRMD                                                          87430000
         EJECT                                                          87500000
         TDEBD                                                          87570000
         EJECT                                                          87640000
         TTNTD                                                          87710000
         EJECT                                                          87780000
         OLTCB                                                          87850000
ECB      EQU   TOTOTECB                                                 87920000
TRMWRK   EQU   TOTTRMBF+72                                              87990000
DUMMY    EQU   TOTWKSPC                                                 88060000
         EJECT                                                          88130000
RESPL    RESPL                                                          88200000
         SPACE 2                                                        88270000
         END                                                            88340000
