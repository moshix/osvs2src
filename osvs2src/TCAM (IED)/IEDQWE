         TITLE 'IEDQWE - TOTE TEST CONTROL MODULE'                      00090000
IEDQWE   CSECT                                                          00180000
*A000000-999999                                                @Y16X5U0 00270000
*  TOTE ALIAS                                                  @OY13283 00310010
*** THIS MODULE IS RESEQUENCED AS OF TCAM 10.0                 @Y17XAUU 00360000
* CHANGE ACTIVITY AS FOLLOWS:                                   SA41597 00450000
* C011000-011500,C018500,A018700,C035800-035890,                SA41597 00540000
* C039300,A039400,A482100-482400                                SA41597 00630000
* A074500-075500,A453960-453990,A474935-474938                  SA41597 00720000
* A073700-074300,C086000,C097800,C104000,A116700-116750,         S22024 00810000
* A118130-118160,C120000,C134400,C137000,C149000,C153600,C154600 S22024 00900000
* C157000,A161000-163000,C192000,C194400,C195100,A195860-195920  S22024 00990000
* C197200,C202000,C211000,C215000,C219000-219500,C227000         S22024 01080000
* C235100,A237700-238000,C243340,C243700,A283660-283720,C296000  S22024 01170000
* C299550,C300000-301000,C303000,C308000,A327000-335000          S22024 01260000
* C339000,C345000,C348000,A352000-412660,C503000,C506000-508000  S22024 01350000
* D584000-589381,A589650,C589765,C589790,C589810,A589963-589966  S22024 01440000
*A073800,076200,344100-344800,351200-351800,382300-409600        S05331 01530000
*C139000,155200,285000,290400-291000,295200                    @YA12242 01620000
*D144000                                                       @YA12242 01710000
*A062500,412120,412440,412660,589580,589755                    @Y17XAUU 01800000
*C505000                                                       @Y17XAUU 01890000
*D351200-351600,382900-409300                                  @Y17XAUU 01980000
* A283500,378000,378400,850000                                 @G36XRUV 02010010
* C284400,378400                                               @G36XRUV 02040010
*********************************************************************** 02070000
*                                                              @Y17XAUU 02160000
* DESCRIPTIVE NAME: 'OLT TEST CONTROL MODULE'                   SA41597 02250000
*                                                              @Y17XAUU 02340000
* MODULE NAME:  IEDQWE (TCAM,TOTE)                             @Y17XAUU 02430000
*                                                                     * 02520000
* STATUS:  VERSION 10.0                                        @Y17XAUU 02610000
*                                                                     * 02700000
* ENTRY POINT:                                                        * 02790000
*                                                                     * 02880000
*       IEDQWE CALLED BY THE TOTE DISPATCHER MODULE IEDQWD            * 02970000
*       IEDQWE1 ON RETURN FROM IEDQWF.                                * 03060000
*                                                                     * 03150000
* FUNCTIONS:                                                          * 03240000
*       THE PURPOSE OF THIS MODULE IS TO SCHEDULE THE OLT'S REQUESTED * 03330000
*       IN THE TRM AND TO CLEAN UP AFTER THE EXECUTION OF EACH.       * 03420000
*                                                                     * 03510000
*       IF THE SECTION-TERMINATE FLAG IS SET, REQUIRED CLEANUP IS     * 03600000
*       DONE AND IMMEDIATE RETURN IS MADE TO THE TOTE RESIDENT        * 03690000
*        MODULE, UNLESS ANY TEST DEVICE IS ON A CONCENTRATOR    SA41597 03780000
*        THEN EXIT IS TO IEDQWEC.                               SA41597 03870000
*                                                                     * 03960000
*       REGISTER POINTERS ARE INITIALIZED FOR SECTION, UCB AND DEVICE * 04050000
*       TABLES.  THE SIZE OF THE OLT ROOT MODULE IS OBTAINED BY       * 04140000
*       BLDL MACRO.  IF BLDL WAS UNSUCCESSFUL, A MESSAGE IS           * 04230000
*       SENT TO THE CONTROL TERMINAL AND A CHECK MADE FOR ANOTHER     * 04320000
*       MODULE REQUESTED.  IF SUCCESSFUL, MODULE SIZE IS CHECKED      * 04410000
*       AGAINST AVAILABLE CORE.  IF TOTAL CORE IS INSUFFICIENT, A     * 04500000
*       MESSAGE IS SENT TO CONTROL TERMINAL AND A CHECK MADE          * 04590000
*       FOR ANOTHER MODULE REQUESTED.  IF ALLOCATED CORE IS           * 04680000
*       INSUFFICIENT, IEDQWA IS POSTED FOR THE ASSIGNMENT OF          * 04770000
*       ADDITIONAL CORE.                                              * 04860000
*                                                                     * 04950000
*       IF CORE IS SUFFICIENT, A SECTION START MESSAGE IS SENT TO     * 05040000
*       CONTROL TERMINAL AND THE MODULE XCTL'S TO IEDQWF.             * 05130000
*       UPON RETURN FROM IEDQWF A TERMINATE MESSAGE IS SENT           * 05220000
*       TO CONTROL TERMINAL AND A CHECK IS MADE FOR ANOTHER MODULE    * 05310000
*       REQUESTED.                                                    * 05400000
*                                                                     * 05490000
*       WHEN ANOTHER OLT MODULE IS REQUESTED IT WILL BE EXECUTED      * 05580000
*       AS DESCRIBED ABOVE.  IF A NEW MODULE IS NOT REQUIRED, A CHECK * 05670000
*       IS MADE FOR ANOTHER DEVICE REQUIRED.  IF A DEVICE IS REQUIRED,* 05760000
*       TABLES AND POINTERS ARE UPDATED AND THE OLT MODULE IS         * 05850000
*       EXECUTED AGAIN.                                               * 05940000
*                                                                     * 06030000
*       WHEN AN OLT IS FINISHED WITH ALL REQUESTED DEVICES, A CHECK   * 06120000
*       IS MADE FOR TEST LOOP REQUESTED.  IF YES, THE LOOP COUNT IS   * 06210000
*       DECREMENTED AND THE OLT MODULE IS RE-EXECUTED UNTIL THE       * 06300000
*       COUNT IS EXHAUSTED.                                           * 06390000
*                                                                     * 06480000
*       WHEN THE TEST REQUEST IS SATISFIED ANY STILL LOADED MODULES   * 06570000
*       ARE DELETED.  IF THE TEST DEVICES ARE TERMINALS A START       * 06660000
*       TERMINAL REQUEST IS POSTED TO OPERATOR CONTROL FOR EACH.      * 06750000
*       IF THEY ARE TCU'S A START LINE REQUEST IS POSTED FOR EACH.    * 06840000
*       FINALLY RETURN IS MADE TO IEDQWA.                             * 06930000
*                                                              @Y17XAUU 07020000
* PURPOSE: SEE FUNCTION                                        @Y17XAUU 07110000
*                                                              @Y17XAUU 07200000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 07290000
*                                                              @Y17XAUU 07380000
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 07470000
*                                                              @Y17XAUU 07560000
* MODULE SIZE: 4K                                              @Y17XAUU 07650000
*                                                              @Y17XAUU 07740000
* LINKAGE: XCTL'ED FROM IEDQWD AND IEDQWF                      @Y17XAUU 07830000
*                                                              @Y17XAUU 07920000
* MACROS: AQCTL                                                @Y17XAUU 08010000
*         BLDL                                                 @Y17XAUU 08100000
*         CLOSE                                                @Y17XAUU 08190000
*         DELETE                                               @Y17XAUU 08280000
*         IEDHJN                                               @Y17XAUU 08370000
*         IEDQMSG                                              @Y17XAUU 08460000
*         LINK                                                 @Y17XAUU 08550000
*         LOAD                                                 @Y17XAUU 08640000
*         OPEN                                                 @Y17XAUU 08730000
*         POST                                                 @Y17XAUU 08820000
*         SAVE                                                 @Y17XAUU 08910000
*         WAIT                                                 @Y17XAUU 09000000
*         XCTL                                                 @Y17XAUU 09090000
*                                                                     * 09180000
* INPUT:        REGISTER 02,13,14,15 CONTAIN THE FOLLOWING VALUES:    * 09270000
*                                                                     * 09360000
*                         02-OLTCB POINTER                            * 09450000
*                         13-SAVE AREA ADDRESS                        * 09540000
*                         14-RETURN ADDRESS                           * 09630000
*                         15-ENTRY POINT ADDRESS                      * 09720000
*                                                                     * 09810000
*                                                                     * 09900000
* COPYRIGHT: 'NONE'                                             SA41597 09990000
*                                                                     * 10080000
*                                                                     * 10170000
* EXTERNAL ROUTINES:                                                  * 10260000
*                                                                     * 10350000
*       IEDQWK - TOTE MESSAGE MODULE                                  * 10440000
*       IGC00059                                                      * 10530000
*       IEDQCA - TCAM STARTLINE                                       * 10620000
*       IEDQCA - TCAM STOP LINE                                       * 10710000
*                                                                     * 10800000
* EXIT POINTS:  XCTL AFTER 'TCNTL06'  TO IEDQWF                       * 10890000
*                 BR AFTER 'RETURN4'  TO IEDQWA                       * 10980000
*                                                                     * 11070000
* TABLES/WORK AREAS:                                                  * 11160000
*                                                                     * 11250000
*       OLTCB, UCB                                                    * 11340000
*                                                                     * 11430000
* ATTRIBUTES:                                                         * 11520000
*                                                                     * 11610000
*       ENABLED, PROBLEM PROGRAM MODE, TRANSIENT.                     * 11700000
*                                                              @Y17XAUU 11790000
* NOTES: SEE BELOW                                             @Y17XAUU 11880000
*                                                              @Y17XAUU 11970000
*  DEPENDENCIES: EBCDIC CHARACTER CODE                         @Y17XAUU 12060000
*                                                              @Y17XAUU 12150000
*  RESTRICTION: NONE                                           @Y17XAUU 12240000
*                                                              @Y17XAUU 12330000
*  REGISTER CONVENTIONS: SEE REGISTERS ASSIGNMENT              @Y17XAUU 12420000
*                                                              @Y17XAUU 12510000
*  PATCH LABEL: PATCH                                          @Y17XAUU 12600000
*                                                              @Y17XAUU 12690000
*********************************************************************** 12780000
         EJECT                                                          12870000
*                                                                       12960000
*        REGISTER EQUATES                                               13050000
*                                                                       13140000
R0       EQU   0                       REG 0                     S99528 13230000
PARMREG0 EQU   0                       PARAMETER REGISTER      @XM05678 13260010
PARMREG1 EQU   1                       PARAMETER REGISTER      @XM05678 13290010
R1       EQU   1                       REG 1                     S99528 13320000
R2       EQU   2                       REG 2                     S99528 13410000
R3       EQU   3                       REG 3                     S99528 13500000
R4       EQU   4                       REG 4                     S99528 13590000
R5       EQU   5                       REG 5                     S99528 13680000
R6       EQU   6                       REG 6                     S99528 13770000
R7       EQU   7                       REG 7                     S99528 13860000
R8       EQU   8                       REG 8                     S99528 13950000
R9       EQU   9                       REG 9                     S99528 14040000
R10      EQU   10                      REG 10                    S99528 14130000
R11      EQU   11                      REG 11                    S99528 14220000
R12      EQU   12                      REG 12                    S99528 14310000
R13      EQU   13                      REG 13                    S99528 14400000
R14      EQU   14                      REG 14                    S99528 14490000
R15      EQU   15                      REG 15                    S99528 14580000
DISREG2  EQU   16                      DISPLACEMENT TO REG2    @Y17XAUU 14670000
D0       EQU   0                       DISPLACEMENT OF 0       @Y17XAUU 14700000
D3       EQU   3                       DISPLACEMENT OF 3       @Y17XAUU 14730000
JFCBTSDM EQU   X'08'                   DISP                      S99528 14760000
JFCBLTYP EQU   X'02'                   TYPE                      S99528 14850000
ZERO     EQU   0                       ZERO                      S99528 14940000
ONE      EQU   1                       ONE                       S99528 15030000
TWO      EQU   2                       TWO                       S99528 15120000
THREE    EQU   3                       THREE                     S99528 15210000
FOUR     EQU   4                       FOUR                      S99528 15300000
FIVE     EQU   5                       FIVE                      S99528 15390000
SIX      EQU   6                       SIX                       S99528 15480000
SEVEN    EQU   7                       SEVEN                     S99528 15570000
EIGHT    EQU   8                       EIGHT                     S99528 15660000
NINE     EQU   9                       NINE                      S99528 15750000
TENN     EQU   10                      TEN                       S99528 15840000
ONEONE   EQU   11                      ELEVEN                    S99528 15930000
D34      EQU   34                      DISPLACEMENT 34           S99528 16020000
DEVTBEND EQU   X'00'                   TEST DEVICE TABLE END CODES99528 16110000
DEC58    EQU   58                      FIFTY EIGHT               S99528 16200000
SECTBEND EQU   X'40'                   SECTION TABLE END CODE    S99528 16290000
STRTCODE EQU   X'40'                   START CODE                S99528 16380000
STOPCODE EQU   X'41'                   START LINE                S99528 16470000
LINESTRT EQU   X'40'                   STOP LINE                 S99528 16560000
LINESTOP EQU   X'41'                   VERB CODE                 S99528 16650000
TERMSTRT EQU   X'45'                   VERB CODE START TERM      S99528 16740000
TERMSTOP EQU   X'47'                   TERMINAL CODE STOP        S99528 16830000
HOLDTERM EQU   X'88'                   HOLD TERMINAL VERB CODE   S99528 16920000
ACTIVETM EQU   X'46'                   ACTIVATE TERM VERB CODE   S99528 17010000
REALTERM EQU   X'87'                   RELEASE TERM VERB CODE    S99528 17100000
INACTERM EQU   X'48'                   INACTIVATE VERB CODE      S99528 17190000
BLANK    EQU   X'40'                   INCLUSIVE DLIM            S99528 17280000
D1       EQU   1                       ONE                       S22024 17370000
D2       EQU   2                       TWO                       S22024 17460000
D8       EQU   8                       EIGHT                     S22024 17550000
D4       EQU   4                       FOUR                      S22024 17640000
D12      EQU   12                      CONSTANT DISPLACEMENT     S05331 17730000
D32      EQU   32                      LCB ADJUSTMENT            S22024 17820000
D62      EQU   62                      DISP 62                   S22024 17910000
D64      EQU   64                      DISP 64                   S22024 18000000
TOTEIND  EQU   X'00'                   CLEAR TOTE INDICATOR     SA41597 18090000
*                                      IN THE LCB               SA41597 18180000
XFF      EQU   X'FF'                   USED TO CLEAR BITS        S05331 18270000
ADRMSK   EQU   7                             ADDRESS MASK      @Y17XAUU 18360000
BCDSLEN  EQU   20                      CDS LEN TO MOVE TO OLTCB@Y17XAUU 18400000
*                                                                       18450000
         EJECT                                                          18540000
         SAVE  (14,12)                 SAVE REGS                 S99528 18630000
         USING TOTOLTCB,R2             TOTE CONTROL BLOCK        S22024 18720000
*                                                                       18810000
*        SATISFY LINKAGE CONVENTIONS                                    18900000
*                                                                       18990000
         LR    R4,R15                  ESTABLISH BASE REG        S99528 19080000
         USING IEDQWE,R4               IEDQWE                    S99528 19170000
         ST    R13,TOTSAVE4+FOUR       SAVE CALLERS SAVE ADDR    S99528 19260000
         LR    R12,R13                 SAVE IT HERE TOO          S99528 19350000
         LA    R13,TOTSAVE4            MY SAVE AREA ADDRESS      S99528 19440000
         ST    R13,EIGHT(R12)          MY SAVE TO HIS            S99528 19530000
IEDQWE   IEDHJN IEDQWEE,HJN            NAME AND HJN              S99528 19620000
         TM    TOTFLG06,TOTOTERM+TOTCANCL  CANCELOR TERMINATE    S99528 19710000
         BNZ   TCNTL07                 YES BRANCH                S99528 19800000
         LA    R11,TOTOLTTB            SECTION ID TABLE ADDRESS  S99528 19890000
         ST    R11,TOTSAVE5+D4         SAVE ADDRESS              S22024 19980000
         LA    R11,TOTTDTBL            RESTORE FIRST DEV ENTRY   S99528 20070000
         ST    R11,TOTGRABP            GRAB POINTER              S99528 20160000
         ST    R11,TOTSAVE5            CURRENT DEVICE            S22024 20250000
TCNTL004 EQU   *                                                        20340000
*                                                                       20430000
*        INITIALIZE TABLES & POINTERS                                   20520000
*                                                                       20610000
*                                                                       20700000
TCNTL01  EQU   *                                                        20790000
***                                                                     20880000
***                                                                     20970000
***     FIND UCB FOR FIRST TEST DEVICE                                  21060000
**AFTER UCB FOUND BAL TO FIND DDNAME AND OPEN                           21150000
         L     R8,TOTTDTBL             GET TNT OR UCB            S99528 21240000
         ST    R8,SAVEENT              SAVE STATUS               S22024 21330000
         TM    SAVEENT,TOTTDORN        TEST DEVICE ON RN         S22024 21420000
         BZ    NORNTST                 NO BRANCH                 S22024 21510000
         BAL   R12,QCBFIND             GO FIND QCB AND LCB       S22024 21600000
         BAL   R9,DUMMYTNT             CHECK FOR COUNTERFEITING@Y17XAUU 21640000
         B     PRIENT                  GET FIRST SECTION ID      S22024 21690000
NORNTST  LA    R8,0(R8)                CLEAR HI BYTE             S22024 21780000
NEXTDEV  EQU   *                                                 S22024 21870000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 21960000
         BO    STORE                   YES BRANCH                S99528 22050000
         BAL   R12,UCBFIND             FIND UCB FOR TERMINALS    S99528 22140000
STORE    STH   R8,ADDOFUCB             SAVE UCB ADDRESS          S99528 22230000
         BAL   R12,DDMOVE              GO FIND DDNAME IN TIOT    S99528 22320000
**                                     TO MOVE TO DCB AND OPEN   S99528 22410000
**       SET UP FIRST PRIMARY DEVICE ENTRY IN TOTPRENT           S99528 22500000
FSTPRI   MVC   TOTPRUCB,ADDOFUCB       MOVE UCB ADD TO TOTPRENT  S99528 22590000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 22680000
         BZ    PRIENT                  NO BRANCH                 S99528 22770000
         B     FSTSECID                SET UP FIRST SECTION ID   S99528 22860000
PRIENT   EQU   *                                                 S99528 22950000
         L     R8,0(R11)               GET REAL TNT POINTER      S99528 23040000
         ST    R8,TOTTNTPR             SAVE IN TOTPRENT          S99528 23130000
         TM    SAVEENT,TOTTDORN        TEST DEVICE ON RN         S22024 23220000
         BO    FSTSECID                YES BRANCH                S22024 23310000
***    BAL TO ROUTINE TO FIND PLN AND LCB ADDRESS   GIVEN TNT ADD¶99528 23400000
         BAL   R12,RLNLCB              LCB AND RLN INTO TOTPRENT S99528 23490000
FSTSECID EQU   *                                                 S99528 23580000
         MVC   TOTCRALP(3),TOTOLTTB    GET FIRST OLT ID          S99528 23670000
         LA    R6,TOTOLTTB             UPDATE OLT ID             S99528 23760000
          ST    R6,TOTOLTPT             TABLE POINTER            S99528 23850000
         TM    TOTFLG03,TOTTSINC       INCLUSIVE ID ENTRY        S99528 23940000
         BZ    TCNT01A                 NO BRANCH                 S99528 24030000
         MVI   TOTCRFLG,TOTFTTIM       TURN ON FST PASS FLAG     S99528 24120000
TCNT01A  EQU   *                                                        24210000
         NI    $ERROPT,X'FF'-$TESTERR-$ASTERIK RESET ERR FLGS    S22024 24300000
*        GET SIZE OF OLT ROOT MODULE                                    24390000
*             & UPDATE CORE AVAILABLE TO SUB-MODULES                    24480000
*                                                                       24570000
         XC    TCNTBLDL(62),TCNTBLDL   CLEAR PARM LIST FOR BLDL         24660000
         MVI   TCNTBECT,ONE            SET ENTRY COUNT TO ONE           24750000
         MVI   TCNTBELN,DEC58          SET ENTRY LENGTH TO 58           24840000
         MVC   TCNTMDNM(8),TOTCROLT    MOVE IN MODULE NAME              24930000
         BLDL  0,TCNTBLDL              ISSUE BLDL                       25020000
         LTR   R15,R15                WAS IT SUCCESSFUL?                25110000
         BZ    TCNTL04                  YES                             25200000
TCNTL02  EQU   *                                                        25290000
******                                                                  25380000
******                                                                  25470000
******   IED330I   OLT MODULE XXXXXX NOT LOADABLE                S22024 25560000
******                                                                  25650000
         MVC   NOTLOAD+ONEONE(EIGHT),TOTCROLT  OLT NAME          S99528 25740000
         IEDQMSG OTBUF=NOTLOADD,OTCNT=40,PREG0=R0,PREG1=R1,      S22024C25830000
               FUNCT=(CEC,PRT),RET=TCNT490                     @YA12242 25920000
****  BRANCH TO AREA TO FIND THE NEXT OLT ID                            26010000
TCNTL04  EQU   *                                                        26100000
         L     R7,TCNTMDSZ        GET OLT SCHEDULER SIZE                26190000
         SRL   R7,8                 MODULE SIZE                         26280000
         L     R8,TOTMMSPC             TOTAL CORE AVAIL TO OLT   S22024 26370000
         SR    R8,R7                  IS THERE ENOUGH CORE?             26460000
         BNM   TCNT043                  YES                             26550000
         BAL   R12,TCNTL30              NO: GO GET MORE ASSIGNED        26640000
         B     TCNTL04            ENOUGH CORE WAS AVAILABLE, CONTINUE   26730000
************                                                            26820000
************                                                            26910000
*********   IED331I  NOT ENOUGH CORE FOR SECTION XXX             S22024 27000000
*********                                                               27090000
         MVC   NOCORE+29(8),TOTCROLT   OLT ID                    S99528 27180000
         IEDQMSG OTBUF=NOCOREE,OTCNT=45,PREG0=R0,PREG1=R1,       S22024C27270000
               FUNCT=(CEC,PRT),RET=TCNT490                     @YA12242 27360000
TCNT043  EQU   *                                                        27450000
         ST    R8,TOTMMSPC             UPDATE CORE AVAILABLE     S22024 27540000
         A     R7,TOTUSCOR        ADD SIZE TO USED CORE          Y06330 27630000
         ST    R7,TOTUSCOR             SAVE SIZE OF ROOT MODULE  S22024 27720000
*                                        IN CORE IN USE FIELD    S22024 27810000
         AR    R8,R7                ADD SIZE OF DELETED OLT             27900000
         LR    R11,R8             MOVE IT TO WORK REG                   27990000
         SRL   R11,2              GET AVAIL CORE IN WORDS               28080000
         STH   R11,$OLTSIZE            STORE IN SCT              S22024 28170000
         TM    SAVEENT,TOTTDTRM+TOTTDORN IS ENTRY TNT            S22024 28260000
         BNZ   NAMEBULD                YES BRANCH                S22024 28350000
         SR    R5,R5                   CLEAR                   @G36XRUV 28390010
         ICM   R5,3,TOTPRUCB           GET UCB ADDRESS         @G36XRUV 28440010
         USING UCBOB,R5                                          S99528 28530000
         MVC   CDSLINE+5(3),UCBNAME    GET LINE ADDRESS          S99528 28620000
         DROP  R5                                                S99528 28710000
LOADNAME EQU   *                                                 S99528 28800000
         LOAD  EPLOC=CDSLINE           BRING MEMBER IN CORE      S99528 28890000
         LR    R6,R0                   EP OF CDS                 S99528 28980000
         MVC   $PDEVADR(20),0(R6)      CDS TO SCT                S99528 29070000
         B     DELETE                  GO TO DELETE CDS          S99528 29160000
NAMEBULD EQU   *                                                 S99528 29250000
         MVI   CDSLINE,C' '            BLANK OUT                 S99528 29340000
         MVC   CDSLINE+1(7),CDSLINE    EIGHT CHARACTER NAME      S99528 29430000
         L     R12,TOTTNTPR            GET SAVED TNT ADDRESS     S99528 29520000
         LA    R9,CDSLINE              GET ADDRESS OF NAME FIELD S99528 29610000
         SR    R3,R3                   CLEAR REG                 S99528 29700000
         IC    R3,TOTTTBEL             GET NAME LRNGTH           S99528 29790000
         BCTR  R3,0                    DECREMENT COUNT FOR EX    S99528 29880000
         EX    R3,NAMEMOV              GO MOVE NAME              S99528 29970000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 29972000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 29974000
         SLR   R8,R1              POINT TO TTE PREFIX          @Y17XAUU 29976000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 29978000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 29980000
         BZ    LOADNAME           NO - LOAD CDS                @Y17XAUU 29982000
         CLI   TRMTYPE,TRMNSDLC   PRE SNA LINK                 @XM05808 29982610
         BE    BLDLCDS            YES - CHECK FOR CDS IN DS    @XM05808 29983310
         CLI   TRMTYPE,TRMSDLC    SNA LINK                     @Y17XAUU 29984000
         BE    BLDLCDS            YES -CHECK FOR CDS IN DS     @Y17XAUU 29986000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 29988000
         BNE   LOADNAME           NO - LOAD CDS                @Y17XAUU 29990000
BLDLCDS  DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 29992000
         MVC   READNAME(D8),CDSLINE COPY NAME TO BLDL PLIST    @Y17XAUU 29993000
         BLDL  0,BLDLLIST         FIND CDS ENTRY               @Y17XAUU 29996000
         LTR   R15,R15            ENTRY FOUND                  @Y17XAUU 29998000
         BZ    LOADNAME           YES - LOAD CDS               @Y17XAUU 30000000
         DROP  R8                                              @Y17XAUU 30002000
*        CONSTRUCT CDS FOR 3767/3770 OR FOR A 3705 LINE        @Y17XAUU 30004000
         LA    R6,$PDEVADR        POINT TO PLACE TO            @Y17XAUU 30006000
*                                 BUILD CDS RECORD             @Y17XAUU 30008000
         USING IEDTCDSD,R6        SET CDS REC ADDRESSABILITY   @Y17XAUU 30010000
         XC    $PDEVADR(BCDSLEN),$PDEVADR CLEAR CDS AREA       @Y17XAUU 30012000
         MVI   TCDSCLS,TCDSCL37   SET CLASS FIELD              @Y17XAUU 30014000
         MVI   TCDSTYP,TCDSTY37   SET TYPE FIELD               @Y17XAUU 30016000
         MVI   TCDSFLG2,TCDSSEC   SET FLAG FIELD               @Y17XAUU 30018000
         MVC   TCDSNAM(D8),CDSLINE COPY SYMBOLIC NAME          @Y17XAUU 30020000
         MVI   TCDSCNT,TCDSSNA    SET CDS LENGTH 3767/3770     @Y17XAUU 30022000
         L     R8,NCPDCB          GET 3705 DCB ADDRESS         @XM05808 30022110
         USING IHADCB,R8          SET DCB ADDRESSABILITY       @XM05808 30022810
         L     R8,DCBDEBAD        GET DEB ADDRESS              @XM05808 30023510
         DROP  R8                                              @XM05808 30024210
         USING DEBNMSUB,R8        SET DEB ADDRESSABILITY       @XM05808 30024910
         SLR   R15,R15            CLEAR REGISTER               @XM05808 30025610
         IC    R15,DEBNMEXT       GET NUMBER OF EXTENTS        @XM05808 30026310
         SLL   R15,4              MULT BY FOUR                 @XM05808 30027010
         LA    R3,4               SET OFFSET TO UCB ADDRESS    @XM05808 30027710
         L     R8,DEBUCBAD-4(R3)  GET UCB ADDRESS              @XM05808 30028410
         DROP  R8                                              @XM05808 30029110
         USING UCB,R8             SET UCB ADDRESSABILITY       @Y17XAUU 30030000
         MVC   TCDSUCB+D2(D2),UCBCHA  SET 3705 UCB CUU         @Y17XAUU 30032000
         DROP  R8                                              @Y17XAUU 30034000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 30036000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 30038000
         SLR   R8,R1              POINT TO TTE PREFIX          @Y17XAUU 30040000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 30042000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 30044000
         BE    NODELETE           CONTINUE PROCESSING          @Y17XAUU 30046000
         MVI   TCDSCNT,TCDSLINK   SET LINE CDS BYTE COUNT      @Y17XAUU 30048000
         B     NODELETE           CONTINUE PROCESSING          @Y17XAUU 30050000
         DROP  R6                                              @Y17XAUU 30052000
         DROP  R8                                              @YM07769 30092000
NAMEMOV  MVC   0(0,R9),0(R12)          MOVE NAME FROM TERMINAL   S99528 30150000
DELETE   DELETE EPLOC=CDSLINE          DELETE CDS                S99528 30240000
*        SET BIT IN SCT TO INDICATE IF THE CONTROL TERMINAL      S22024 30330000
*        AND TEST TERMINAL ARE ON THE SAME COMM LINE             S22024 30420000
NODELETE DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 30460000
         NI    $TOTFLG1,XFF-$CTEQTT    RESET CT ON TEST LINE   @Y17XAUU 30510000
*                                      FLAG                    @Y17XAUU 30600000
         TM    TOTCTFLG,TOTCTORN       CT ON A RN                S22024 30690000
         BZ    CTNOTRN                 NO BRANCH                 S22024 30780000
         TM    SAVEENT,TOTTDORN        TEST DEV ON RN            S22024 30870000
         BZ    STRTMSG                 NO BRANCH                 S22024 30960000
         CLC   NAMESAVE(D8),TOTCTRNL   GROUP NAMES THE SAME      S22024 31050000
         BNE   STRTMSG                 NO BRANCH                 S22024 31140000
         CLC   TOTCTRLN(D1),TOTPRRLN   RLNS THE SAME             S22024 31230000
         BNE   STRTMSG                 NO BRANCH                 S22024 31320000
         L     R1,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 31328000
         LA    R14,TRMPRFSZ            GET TTE PREFIX SIZE     @Y17XAUU 31336000
         SLR   R1,R14                  POINT TO TTE PREFIX     @Y17XAUU 31344000
         USING IEDNTRM,R1              SET ADDRESSABILITY      @Y17XAUU 31352000
         CLI   TRMTYPE,TRMLUNT         LU ENTRY                @Y17XAUU 31360000
         BNE   CTTTSAME                NO                      @Y17XAUU 31368000
         DROP  R1                                              @Y17XAUU 31376000
         CLC   TOTCRTNT+D1(D3),TOTTNTPR+D1 LU CT EQU TD        @Y17XAUU 31384000
         BNE   STRTMSG                 NO - BYPASS SETTING CT  @Y17XAUU 31392000
*                                      EQU TD FLAG             @Y17XAUU 31400000
         NI    $OLTFLGS,XFF-$TRACE     INSURE TRACE OPT OFF    @XM05673 31405010
CTTTSAME EQU   *                                                 S22024 31410000
         OI    $TOTFLG1,$CTEQTT        CT AND TEST DEV SAME LINE S22024 31500000
         B     STRTMSG                 BRANCH                    S22024 31590000
CTNOTRN  EQU   *                                                 S22024 31680000
         TM    SAVEENT,TOTTDORN        TEST DEV ON RN            S22024 31770000
         BO    STRTMSG                 YES BRANCH                S22024 31860000
         CLC   TOTCTUCB(D2),TOTPRUCB   UCBS THE SEME             S22024 31950000
         BE    CTTTSAME                YES BRANCH                S22024 32040000
STRTMSG  EQU   *                                                 S22024 32130000
         NI    TOTFLG01,XFF-TOTAPTST   RESET AP ON TEST LINE   @Y17XAUU 32220000
*                                      FLAG                    @Y17XAUU 32310000
         TM    TOTFLG09,TOTPRECT       CT EQU TD               @Y17XAUU 32340000
         BO    STRTMSG1                YES - BYPASS CHECK      @Y17XAUU 32370000
         TM    TOTAPFLG,TOTAPORN       AP ON 3705              @Y17XAUU 32400000
         BZ    STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 32490000
         TM    SAVEENT,TOTTDORN        TEST DEVICE ON 3705     @Y17XAUU 32580000
         BZ    STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 32670000
         CLC   NAMESAVE(D8),TOTAPRNL   SAME GROUP              @Y17XAUU 32760000
         BNE   STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 32850000
         CLC   TOTAPRLN(D1),TOTPRRLN   AP ON TEST DEVICE LINE  @Y17XAUU 32940000
         BNE   STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 33030000
         USING IEDNTRM,R1              SET ADDRESSABILITY      @Y17XAUU 33040000
         CLI   TRMTYPE,TRMLUNT         LU ENTRY                @Y17XAUU 33050000
         BNE   APTTSAME                NO                      @Y17XAUU 33060000
         DROP  R1                                              @Y17XAUU 33070000
         CLC   TOTARTNT+D1(D3),TOTTNTPR+D1 LU AP = TD          @Y17XAUU 33080000
         BNE   STRTMSG1                NO - BYPASS SETTING AP  @Y17XAUU 33090000
*                                      EQU TD FLAG             @Y17XAUU 33100000
         NI    $OLTFLGS,XFF-$TRACE     INSURE TRACE OPT OFF    @XM05673 33105010
APTTSAME DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 33110000
         OI    TOTFLG01,TOTAPTST       SHOW AP ON TEST LINE    @Y17XAUU 33120000
STRTMSG1 EQU   *                                               @Y17XAUU 33210000
*                                                                       33300000
*        SEND SECTION START MESSAGE                                     33390000
*                                                                       33480000
         TM    $ERROPT,$NOCNTRL        NO CONTROL PRINT          S22024 33570000
         BO    TCNTL06              YES: SKIP MESSAGE                   33660000
********                                                                33750000
********                                                                33840000
********   IED333I  S XXXX  UNIT  XXXX                           S22024 33930000
********                                                                34020000
         XC    UNIT,UNIT               CLEAR NAME                S99528 34110000
         MVC   TERMIAT,STARTID         START ID TO MSG           S22024 34200000
         MVI   TERMIATE+1,S            START                     S99528 34290000
         MVC   TERMIATE+3(8),TOTCROLT  SEC ID                    S99528 34380000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 34470000
         BZ    NAMEFIND                NO BRANCH                 S99528 34560000
         TM    SAVEENT,TOTTDORN        LINE ON RN                S22024 34650000
         BO    NAMEFIND                YES BRANCH                S22024 34740000
         L     R1,TOTPRUCB             GET UCB                   S99528 34830000
         SRL   R1,16                   ADDRESS                   S99528 34920000
         USING UCB,R1                                            S99528 35010000
         MVC   UNIT+5(3),UCBNAME       MOVE NAME                 S99528 35100000
         DROP R1                                                 S99528 35190000
MSGCOMP  MVC   TERMIATE+18(8),UNIT     FILL IN UNIT              S99528 35280000
         OI    TOTFLG05,TOTCECOM       TURN ON CECOM FLAG        S99528 35370000
         NI    TOTFLG05,X'FF'-TOTREPLY TURN OFF REPLY FLAG       S99528 35460000
         TM    TOTFLG09,TOTAPTRM       AP EQUAL CONTROL TERMINAL S99528 35550000
         BO    STARTMSG                GO TO PRINT START MSG     S99528 35640000
         OI    TOTFLG05,TOTPRINT       TURN ON PRINT FLAG        S99528 35730000
STARTMSG EQU   *                                                 S99528 35820000
         IEDQMSG OTBUF=TERMIAT,OTCNT=34,FUNCT=(CEC,PRT),         S22024C35910000
               PREG0=R0,PREG1=R1,RET=TCNTL06                     S99528 36000000
NAMEFIND L     R1,TOTTNTPR             GET NAME ADDRESS          S99528 36090000
         SR    R15,R15                 CLEAR REG                 S99528 36180000
         IC    R15,TOTTTBEL            NAME LENGTH               S99528 36270000
         BCTR  R15,0                   DECREMENT COUNT           S99528 36360000
         EX    R15,NAMEMOVE            GO MOVE NAME              S99528 36450000
         B     MSGCOMP                 BRANCH                    S99528 36540000
TCNTL06  EQU   *                                                        36630000
*                                                                       36720000
         OI    TOTFLG02,TOTCHKSZ  INDICATE SIZE CHECK OF                36810000
*                                   OLT IS REQUIRED                     36900000
         OI    TOTFLG06,TOTOTACT       SET OLT ACTIVE FLG        S22024 36990000
         L     R13,4(R13)         GET CALLER'S SAVE                     37080000
         L     R14,12(R13)        GET RETURN ADDRESS                    37170000
         XCTL  (2,12),EP=IEDQWF   GO TO TEST CONTROL SUB-MODULE         37260000
         EJECT                                                          37350000
IEDQWE1  EQU   *                                                        37440000
         ENTRY IEDQWE1                                                  37530000
         DROP  R4                                                       37620000
         USING IEDQWE1,R15                                              37710000
         STM   R14,R12,12(R13)    SAVE CALLER'S REGISTERS               37800000
         L     R5,TOTFLG01             CONTAINS TOTCLNST       @G36XRUV 37810010
CSLOOP1  DS    0H                                              @G36XRUV 37820010
         LR    R6,R5                   COPY                    @G36XRUV 37830010
         O     R6,SETCLNST             SET CLEANUP START IN REG@G36XRUV 37840010
         CS    R5,R6,TOTFLG01          SET TOTCLNST            @G36XRUV 37850010
         BNZ   CSLOOP1                 BR IF WORD ALTERED      @G36XRUV 37860010
         NI    TOTFLG06,X'FF'-TOTOTACT CLEAR OLT ACTIVE FLAG     S22024 37890000
         L     R4,=A(IEDQWE)      GET BASE ADDRESS                      37980000
         DROP  R15                                                      38070000
         USING IEDQWE,R4                                                38160000
         LA    R12,TOTSAVE4            GET MY SAVE ADDRESS       S22024 38250000
         ST    R12,8(R13)         SAVE IT IN CALLER'S SAVE              38340000
         ST    R13,4(R12)         SAVE POINTER TO CALLER'S SAVE         38430000
         LR    R13,R12                                                  38520000
         L     R11,TOTSAVE5            CURRENT PRIMARY DEVICE PTRS22024 38610000
         L     R6,ZERO(R11)            SAVE ENTRY                S22024 38700000
         ST    R6,SAVEENT              TO WORK WITH              S22024 38790000
         L     R6,TOTSAVE5+D4          CURREST SECTION ID        S22024 38880000
*                                                                       38970000
*                                                                       39060000
*        SEND SECTION TERMINATE MESSAGE                                 39150000
*                                                                       39240000
         TM    $ERROPT,$NOCNTRL        NO CONTROL PRINT FLG SET  S22024 39330000
         BO    TCNTL07              YES: SKIP MESSAGE                   39420000
*                                                                       39510000
         TM    $ERROPT,$ASTERIK        ASTERIK PRINT NEEDED      S99528 39600000
         BZ    TMOVE                   NO BRANCH                 S99528 39690000
         MVI   TERMIATE,ASTRICK        ASTERICK TO MSG           S99528 39780000
TMOVE    MVI   TERMIATE+1,TEE          MOVE T TO MSG             S99528 39870000
         MVC   TERMIAT,TERMID          TERMINATE ID TO MSG       S22024 39960000
         MVC   TERMIATE+3(8),TOTCROLT  SEC ID                    S99528 40050000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 40140000
         BZ    NAMEFIN                 NO BRANCH                 S99528 40230000
         TM    SAVEENT,TOTTDORN        LINE ON RN                S22024 40320000
         BO    NAMEFIN                 YES BRANCH                S22024 40410000
         L     R1,TOTPRUCB             GET UCB                   S99528 40500000
         SRL   R1,16                   ADDRESS                   S99528 40590000
         USING UCB,R1                                            S99528 40680000
         MVC   UNIT+5(3),UCBNAME       MOVE NAME                 S99528 40770000
         DROP R1                                                 S99528 40860000
MSGCOM   MVC   TERMIATE+18(8),UNIT     FILL IN UNIT              S99528 40950000
         OI    TOTFLG05,TOTCECOM       TURN ON CECOM FLAG        S99528 41040000
         NI    TOTFLG05,X'FF'-TOTREPLY TURN OFF REPLY FLAG       S99528 41130000
         TM    TOTFLG09,TOTAPTRM       AP EQUAL CONTROL TERMINAL S99528 41220000
         BO    STOPMSG                 GO TO PRINT STOP MSG      S99528 41310000
         OI    TOTFLG05,TOTPRINT       TURN ON PRINT FLAG        S99528 41400000
****                                                                    41490000
****   IED334I  (*) T  XXX   UNIT   XXX                          S22024 41580000
****                                                                    41670000
STOPMSG  EQU   *                                                 S99528 41760000
         IEDQMSG OTBUF=TERMIAT,OTCNT=34,FUNCT=(CEC,PRT),         S22024C41850000
               PREG0=R0,PREG1=R1,RET=TCNTL07                     S99528 41940000
NAMEFIN  L     R1,TOTTNTPR             GET NAME ADDRESS          S99528 42030000
         SR    R15,R15                 CLEAR REG                 S99528 42120000
         IC    R15,TOTTTBEL            NAME LENGTH               S99528 42210000
         BCTR  R15,0                   DECREMENT COUNT           S99528 42300000
         EX    R15,NAMEMOVE            GO MOVE NAME              S99528 42390000
         B     MSGCOM                  BRANCH                    S99528 42480000
*                                                                       42570000
TCNTL07  EQU   *                                                        42660000
         MVI   TERMIATE,BLANK          CLEAR ASTRIC              S99528 42750000
*                                                                       42840000
*        DELETE ANY OLT SUBMODULES THAT ARE STILL LOADED                42930000
*                                                                       43020000
         TM    TOTFLG06,TOTABEND  OLT ABEND                      S22024 43110000
         BO    TCNT490            YES - BYPASS QCB CHECK         S22024 43200000
         LA    R8,TOTPLNKQ        GET ADDR OF PLINK QCB                 43290000
TCNTL13  EQU   *                                                        43380000
         L     R9,TOTPLBKW              GET LAST PLINK Q ELEM  @YA12242 43470000
         LA    R9,0(R9)           CLEAR HIGH ORDER BYTE                 43560000
         CR    R8,R9            Q  IS ELEMENT THE QCB                   43650000
         BE    TCNT487              YES  END OF QUEUE                   43740000
         USING PLNKPREF,R9                                              43830000
         LH    R10,PLNKMPTR       GET DISPLACEMENT TO                   43920000
*                                   PLINK PARAMETERS                    44010000
         AR    R10,R9             GET ADDR OF QUEUE POINTERS            44100000
         USING PLNKQPTR,R10                                             44190000
         L     R10,PLNKQBKD             GET NEXT ELEM          @YA12242 44280000
         ST    R10,TOTPLBKW             SAVE NEXT POINTER      @YA12242 44370000
         DELETE EPLOC=PLNKNAME    DELETE MODULE                         44460000
         DROP  R10                                                      44550000
         LR    R9,R10             GET NEXT QUEUE ELEMENT                44640000
         DROP  R9                                                       44730000
         B     TCNTL13            GO TRY NEXT ELEMENT                   44820000
TCNT487  EQU   *                                                        44910000
         ST    R8,TOTPLFWD              UPDATE QCB             @YA12242 45000000
TCNT490  EQU   *                                                        45090000
         TM    TOTFLG06,TOTOTERM+TOTCANCL CANCEL OR TERMINATE    S22024 45180000
         BNZ   TCNTL11A                    YES                          45270000
         TM    TOTFLG03,TOTTSINC       INCLUSIVE ID ENTRY        S99528 45360000
         BO    INCHTST                 YES BRANCH                S99528 45450000
         CLI   3(R6),SECTBEND          ANY MORE SECTIONS         S99528 45540000
         BE    TCNT56               NO                                  45630000
         LA    R8,TOTOLTTE        GET END OF OLT TABLE                  45720000
         LA    R6,3(R6)           GET NEXT TABLE ENTRY                  45810000
         CR    R8,R6           Q  IS IT END OF TABLE                    45900000
         BE    TCNT56               YES                                 45990000
         MVC   TOTCRALP(3),0(R6)  UPDATE CURRENT OLT I.D.               46080000
         ST    R6,TOTSAVE5+D4          SAVE SECTION ID           S22024 46170000
         LA    R1,TOTTDTBL             START OF DEVICE TABLE     S99528 46260000
         LA    R7,R10                  SET LOOP COUNT            S99528 46350000
TEN      NI    0(R1),X'FF'-TOTTDGRB    CLEAR GRAB FLAG           S99528 46440000
         LA    R1,4(R1)                BUMP TO NEXT DEVICE       S99528 46530000
         BCT   R7,TEN                  RESET ALL GRABED FLAGS    S99528 46620000
         B     TCNT01A                 GO EXECUTE NEXT OLT       S99528 46710000
TCNT56   EQU   *                                                        46800000
         TM    TOTPRDCB+X'30',X'10'    PRIMARY DCB OPEN          S99528 46890000
         BZ    RESTPTR                 NO BRANCH                 S99528 46980000
         LA    R1,TOTPRDCB             TEST DCB                  S99528 47070000
         ST    R1,TOTWKSPC             STORE IN P LIST           S99528 47160000
         MVI   TOTWKSPC,X'B0'          OPTION CLOSE              S99528 47250000
         LA    R1,TOTWKSPC             ADDRESS OF P LIST         S99528 47340000
         CLOSE MF=(E,(1))              CLOSE TEST DCB            S99528 47430000
RESTPTR  LA    R6,TOTOLTTB             RESTORE SECT POINTER      S22024 47520000
         ST    R6,TOTSAVE5+D4          FIRST SECTION             S22024 47610000
*                                                                       47700000
         TM    TOTFLG06,TOTCANCL+TOTOTERM  CANCEL                S99528 47790000
         BO    TCNTL11A                YES BRANCH                S99528 47880000
         TM    $EXECFLG,$LSTPDEV       IS FINAL FLAG SET         S22024 47970000
         BO    TCNTL09              YES: SKIP REMAINING DEVICES         48060000
NXTDEV   LA    R11,4(R11)              UPDATE CURRENT            S99528 48150000
*                                         DEVICE POINTER                48240000
         CLI   0(R11),DEVTBEND         ANY MORE DEVICES          S99528 48330000
         BE    TCNTL09                NO                                48420000
         TM    0(R11),TOTTDGRB         DEV BEEN GRABED           S99528 48510000
         BO    NXTDEV                  YES DO NOT ASSIGN         S99528 48600000
         LA    R8,TOTTDEND        GET TABLE END ADDRESS                 48690000
         CR    R8,R11                  ARE THERE ANY MORE ENTRIESS99528 48780000
         BE    TCNTL09              NO                                  48870000
         ST    R11,TOTSAVE5            UPDATE DEV ADDR POINTER   S22024 48960000
*********************************************************************** 49050000
*********************************************************************** 49140000
**                                                                   ** 49230000
**       UPDATE PRIMARY DEVICE ENTRY AND MOVE                        ** 49320000
**            PRIMARY INFORMATION TO SCT                             ** 49410000
**                                                                   ** 49500000
*********************************************************************** 49590000
*********************************************************************** 49680000
         L     R8,0(R11)               GET NEXT ENTRY            S99528 49770000
         ST    R8,SAVEENT              SAVE NEXT ENTRY BEING     S22024 49860000
         ST    R8,TOTTNTPR             SAVE TNT POINTER          S22024 49950000
*                                      PROCESSED                 S22024 50040000
         TM    0(R11),TOTTDORN         TEST DEVICE ON RN         S22024 50130000
         BZ    NEXTDEV                 NO BRANCH                 S22024 50220000
         BAL   R12,QCBFIND             GO FIND QCB               S22024 50310000
         B     FSTSECID                GET FIRST SECTION ID      S22024 50400000
*                                                                       50490000
*        CHECK FOR TEST LOOP                                            50580000
*                                                                       50670000
TCNTL09  EQU   *                                                        50760000
         TM    $ERROPT,$LOOPTST        TEST LOOP REQUEST         S22024 50850000
         BZ    TCNTL11A             NO                                  50940000
         LH    R11,TOTTLCNT            YES DECREMENT COUNT       S22024 51030000
         BCT   R11,TCNTL11             EX OLT AGAIN              S99528 51120000
         B     TCNTL11A                GO END OLT                S99528 51210000
TCNTL11  EQU   *                                                        51300000
         STH   R11,TOTTLCNT            STORE NEW LOOP COUNT      S22024 51390000
         B     IEDQWEE                 GO TO RE RUN TEST         S99528 51480000
TCNTL11A EQU   *                                                        51570000
*                                                                       51660000
*        SEND ON-LINE TESTING ENDED MESSAGE                             51750000
*                                                                       51840000
         TM    TOTFLG01,TOTIPLCU       IS FORCED CLEANUP IN      S05331 51930000
*                                        PROGRESS?               S05331 52020000
         BO    EXITE2                  YES, BYPASS WAIT FOR LAST Y06330 52110000
*                                        MESSAGE RESPONSE        S05331 52200000
NOCLEAN  EQU   *                                                 S05331 52290000
         TM    TOTFLG05,TOTNDMSG       END OF MESSAGE REQUEST    S22024 52380000
         BZ    TCNTL11C             NO                                  52470000
         TM    TOTFLG06,TOTCANCL       CANCELL FLAG SET          S22024 52560000
         BZ    TCNTL11B                NO BRANCH                 S99528 52650000
**********                                                              52740000
**********                                                              52830000
**********   ON-LINE TESTING CANCELLED                                  52920000
*******                                                                 53010000
         IEDQMSG   MSGID=20,PREG0=R0,PREG1=R1,FUNCT=CEC,               X53100000
               RET=TCNTL11C                                             53190000
TCNTL11B EQU   *                                                        53280000
*******                                                                 53370000
*******                                                                 53460000
*******   ON-LINE TESTING ENDED                                         53550000
*******                                                                 53640000
         IEDQMSG   MSGID=16,PREG0=R0,PREG1=R1,FUNCT=CEC                 53730000
TCNTL11C EQU   *                                                        53820000
EXITE2   EQU   *                                                 S05331 53910000
         L     R13,4(R13)              GET CALLERS SAVE          S22024 54000000
         L     R14,D12(R13)            GET RETURN ADDRESS        S05331 54090000
         XCTL  (2,12),EP=IEDQWE2       GO TO CLEANUP MODULE      S22024 54180000
         EJECT                                                          54270000
QCBFIND  EQU   *                       FIND PRIMARY QCB AND      S22024 54360000
*                                      THE RN LCB ADDRESS        S22024 54450000
         LR    R9,R8                   GET TNT ADDRESS           S22024 54540000
         ST    R9,TRMTNT               SAVE TNT ADDRESS        @Y17XAUU 54580000
         ST    R9,TOTTNTPR             SAVE TNT ADDRESS        @YM08563 54600000
         SR    R3,R3                   CLEAR REG                 S22024 54630000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 54720000
         AR    R9,R3                   TTE ADDRESS               S22024 54810000
         BCTR  R3,R0                   DECREMENT NAME LEN      @Y17XAUU 54900000
         EX    R3,MOVENAME             MOVE NAME TO P-LIST     @Y17XAUU 54990000
         L     R6,TOTAVTPT             GET AVT ADDRESS         @Y17XAUU 55080000
         USING IEDQAVTD,R6             SET AVT ADDRESSABILITY  @Y17XAUU 55170000
         L     R15,AVTRNMPT            GET TERM NAME TAB ADDR  @Y17XAUU 55200000
         ST    R15,TERNMTAB            SAME IT                 @Y17XAUU 55230000
         L     R15,AVTMSGS-D1          VCON TABLE ADDRESS      @Y17XAUU 55260000
         L     R15,D8(R15)             ADDRESS OF A1 ROUTINE   @Y17XAUU 55350000
         LA    R0,1(R3)                GET NAME LENGTH         @Y17XAUU 55440000
         LA    R1,PRINAME              GET ADDRESS OF NAME     @Y17XAUU 55530000
         BAL   R14,FOUR(R15)           FIND PRI TD TTCIN       @Y17XAUU 55620000
*                                                              @Y17XAUU 55710000
*        IEDQA1 RETURNS TEST DEVICE TTCIN IN REG 15            @Y17XAUU 55800000
*                                                              @Y17XAUU 55890000
         STH   R15,TOTPROFF            SAVE PR TD TTCIN        @Y17XAUU 55980000
         LR    R1,R15                  SET UP TO FIND NETWORK  @Y17XAUU 56070000
*                                      ADDRESS                 @Y17XAUU 56160000
         L     R15,AVTSAVTP            GET SAVT ADDRESS        @Y17XAUU 56250000
         L     R15,SAVTTNTX-IEDNSVTD(R15) GET ADDRESS OF TTCIN @Y17XAUU 56340000
*                                      TO NETWORK ADDR CONV RTN@Y17XAUU 56430000
         BALR  R14,R15                 FIND NETWORK ADDRESS    @Y17XAUU 56520000
*                                                              @Y17XAUU 56610000
*        IEDIAP04 RETURNS NETWORK ADDRESS IN REG 1             @Y17XAUU 56700000
*                                                              @Y17XAUU 56790000
         STH   R15,TOTPRSID            SAVE NETWORK ADDRESS    @YM07278 56880000
         DROP  R6                                              @Y17XAUU 56970000
         MVC   TNTENTRY+D1(D3),D0(R9)  ALLINE ADDRESS          @Y17XAUU 57060000
         L     R9,TNTENTRY             TTE ADDRESS             @Y17XAUU 57150000
         USING IEDQTRM,R9              TTE                       S22024 57240000
         L     R9,TRMDESTQ-1           QCB ADDRESS               S22024 57330000
         ST    R9,TRMQCB               SAVE QCB ADDRESS        @Y17XAUU 57370000
         DROP  R9                      TTE                       S22024 57420000
         USING IEDQQCB,R9              QCB                       S22024 57510000
         MVC   TOTPRRLN(D1),QCBRELLN   SAVE PRI RLN              S22024 57600000
         L     R9,QCBLGBAD-1           LGB ADDRESS               S22024 57690000
         DROP  R9                      QCB                       S22024 57780000
         USING IEDNLGB,R9              LGB                       S22024 57870000
         MVC   NAMESAVE(D8),LGBNAME    SAVE GROUP NAME           S22024 57960000
         DROP  R9                      LGB                       S22024 58050000
         L     R1,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 58140000
         BAL   R14,NCPTTE              GET NCP TTE ADDRESS     @Y17XAUU 58230000
*                                                              @Y17XAUU 58320000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 58410000
*                                                              @Y17XAUU 58500000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 58590000
         L     R1,TRMDESTQ-D1          GET QCB ADDRESS         @Y17XAUU 58680000
         DROP  R1                                              @Y17XAUU 58770000
         USING IEDQQCB,R1              SET QCB ADDRESSABILITY  @Y17XAUU 58860000
         L     R9,QCBDCBAD-D1          GET 3705 DCB ADDRESS    @Y17XAUU 58950000
         ST    R9,NCPDCB               SAVE 3705 DCB ADDRESS   @XM05808 58990010
         DROP  R1                                              @Y17XAUU 59040000
         USING IHADCB,R9               DCB                       S22024 59130000
         L     R3,DCBIOBAD             IOB ADDRESS               S22024 59220000
         SR    R6,R6                   CLEAR REG                 S22024 59310000
         IC    R6,DCBEIOBX             LCB SIZE                  S22024 59400000
         AR    R3,R6                   LCB OFFSET FROM DCB       S22024 59490000
         LA    R6,D32                  ADDTESTMENT TO START      S22024 59580000
*                                      OF LCB                    S22024 59670000
         SR    R3,R6                   STARTING LCB ADDRESS      S22024 59760000
         STCM  R3,ADRMSK,TOTPRLCB      SAVE RN LCB               S22024 59850000
         DROP  R9                      DCB                       S22024 59940000
         BR    R12                     RETURN                    S22024 60030000
         EJECT                                                          60120000
************************************************************** @Y17XAUU 60210000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 60300000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE       * @Y17XAUU 60390000
*        ADDRESS. RETURN TO CALLER VIA REG 14.                 @Y17XAUU 60480000
************************************************************** @Y17XAUU 60570000
NCPTTE   EQU   *                                               @Y17XAUU 60660000
         STM   R14,R12,TRMSAVE3        SAVE CALLER'S REGS      @Y17XAUU 60750000
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 60840000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 60930000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 61020000
NCPLOOP  EQU   *                                               @Y17XAUU 61110000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 61200000
         L     R15,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 61290000
         USING IEDQAVTD,R15            SET AVT ADDRESSABILITY  @Y17XAUU 61380000
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 61470000
*                                      ROUTINE ADDRESS         @Y17XAUU 61560000
         DROP  R15                                             @Y17XAUU 61650000
         BALR  R14,R15                 FIND TTE ADDRESS        @Y17XAUU 61740000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 61830000
         CLI   TRMTYPE,TRMLNCP         NCP ENTRY               @Y17XAUU 61920000
         BNE   NCPLOOP                 NO - CHECK NEXT ENTRY   @Y17XAUU 62010000
         LM    R14,R0,TRMSAVE3         RESTORE REG 14-0        @Y17XAUU 62100000
         LM    R2,R12,TRMSAVE3+DISREG2 RESTORE REG 2-12        @Y17XAUU 62190000
         BR    R14                     RETURN TO CALLER        @Y17XAUU 62280000
         DROP  R1                                              @Y17XAUU 62370000
         EJECT                                                          77040000
****************************************************************@Y17XAU 77090000
*        ROUTINE TO GO TO IEDQWB2 TO CALCULATE THE AMOUNT OF   *@Y17XAU 77140000
*        OF CORE NEEDED TO BUILD DUMMY ENTRIES FOR A SPECIFIED *@Y17XAU 77190000
*        REMOTE TERMINAL. CONTROL IS PASS TO IEDQWB TO ATTAIN  *@Y17XAU 77240000
*        THE ACTUAL CORE.  CONTROL IS THEN RETURNED TO IEDQWB2 *@Y17XAU 77290000
*        TO COPY THE ENTRIES.                                  *@Y17XAU 77340000
****************************************************************@Y17XAU 77390000
DUMMYTNT EQU   *                                               @Y17XAUU 77440000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS               @Y17XAUU 77490000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 77540000
         LA    R7,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 77590000
         SLR   R8,R7              POINT TO TTE PREFIX          @Y17XAUU 77640000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 77690000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 77740000
         BNE   DUMOUT             RETURN TO CALLER             @Y17XAUU 77790000
         DROP  R8                                              @Y17XAUU 77840000
         MVI   TRMRQFLG,PRREQ     SHOW PRI TD REQUEST          @Y17XAUU 77940000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 78010000
         XC    TRMFLG01(D1),TRMFLG01 CLEAR CONTROL FLAG        @Y17XAUU 78080000
*                                                              @Y17XAUU 78150000
         LINK  EP=IEDQWB2         CALCULATE CORE               @Y17XAUU 78220000
         CL    R15,ERRCD8         SNA LU REJECT                @XM05678 78240010
         BE    DUMFAILU           YES - WRITE ERROR MESSAGE    @XM05678 78260010
         LTR   R15,R15            REQUEST SUCCESSFUL           @Y17XAUU 78290000
         BNZ   DUMFAIL            NO - ERROR                   @Y17XAUU 78360000
         CLI   TRMRQFLG,ALRDY     COUNTERFEITING COMPLETE      @Y17XAUU 78430000
         BE    DUMOUT             YES - RETURN TO CALLER       @Y17XAUU 78500000
*                                                              @Y17XAUU 78750000
         L     R10,TOTRESPL       ADDR OF TOTE RES. CTL BLK    @Y17XAUU 78810000
         USING RESPL,R10                                       @Y17XAUU 78870000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                 @Y17XAUU 78930000
         POST  RESTECB1           POST REQUEST TO IEDQWB       @Y17XAUU 78990000
         WAIT  ECB=TOTOTECB       WAIT FOR REQUEST TO BE HONORED@Y17XAU 79050000
*                                                              @Y17XAUU 79110000
         CLI   TOTWKSPC,XFF       REQUEST SUCCESSFUL           @Y17XAUU 79170000
         BE    DUMFAIL            NO - ERROR                   @Y17XAUU 79230000
*                                                              @Y17XAUU 79290000
         OI    TRMFLG01,TRMQWB3   SHOW SECOND PASS             @Y17XAUU 79350000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 79410000
         LINK  EP=IEDQWB2         COPY ENTRIES                 @Y17XAUU 79470000
         LTR   R15,R15            REQUEST SUCCESSFUL           @Y17XAUU 79530000
         BNZ   DUMFAIL            NO - ERROR                   @Y17XAUU 79590000
         OI    TOTFLG04,X'08' .TOTPRCTF *********************  @YM08057 79760000
*                                                              @Y17XAUU 79800000
DUMOUT   EQU   *                                               @Y17XAUU 79870000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS            @Y17XAUU 79940000
         BR    R9                 RETURN                       @Y17XAUU 80010000
         SPACE                                                          80020010
DUMFAILU EQU   *                                               @XM05678 80030010
         IEDQMSG MSGID=093,FUNCT=CEC ERROR,LU NOT IN SSCP LU SESSION    80040010
*                                 ONLY                         @XM05678 80050010
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG           @XM05678 80060010
         B     TCNTL11B           EXIT TO CLEAN UP             @XM05678 80070010
         SPACE 2                                               @Y17XAUU 80080000
DUMFAIL  EQU   *                                               @Y17XAUU 80150000
         WTO   'IED215I OLT REQUEST REJECTED, UNABLE TO ALLOCATE RESOUR*80220000
               CES FOR CT/AP/TD',ROUTCDE=10,DESC=7             @Y17XAUU 80290000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG           @Y17XAUU 80360000
         B     TCNTL11B           EXIT TO CLEANUP              @Y17XAUU 80430000
         EJECT                                                 @Y17XAUU 80820000
TCNTL30  EQU   *                                               @Y17XAUU 80820400
         LR    R14,R7             DIVIDE CORE                  @Y17XAUU 80820800
         SR    R15,R15              REQUIRED BY                @Y17XAUU 80821200
         SRDL  R14,10               X'400'                     @Y17XAUU 80821600
         LTR   R15,R15            IS THERE A REMAINDER?        @Y17XAUU 80822000
         BZ    TCNTL32              NO                         @Y17XAUU 80822400
         LA    R14,1(R14)           YES: ROUND UP TO EVEN MULT @Y17XAUU 80822800
TCNTL32  EQU   *                                               @Y17XAUU 80823200
         LR    R7,R14             SAVE BLOCK REQUIREMENT       @Y17XAUU 80823600
         LA    R8,EIGHT           GET MINIMUM BLOCK COUNT ALREADYS22024 80824000
*                                   ASSIGNED                   @Y17XAUU 80824400
         SR    R7,R8              SUBTRACT AMOUNT ALREADY      @Y17XAUU 80824800
*                                   ASSIGNED FROM REQUIRED     @Y17XAUU 80825200
*                                   AMOUNT                     @Y17XAUU 80825600
         L     R10,TOTRESPL       GET ADDRESS OF RESIDENT      @Y17XAUU 80826000
*                                   PARAMETER LIST             @Y17XAUU 80826400
         USING RESPL,R10                                       @Y17XAUU 80826800
         CH    R7,RESBKTOT        DOES TOTE HAVE ENOUGH CORE?  @Y17XAUU 80827200
         BH    FOUR(R12)          NO: SEND NOT ENOUGH CORE     @Y17XAUU 80827600
*                                   MESSAGE                    @Y17XAUU 80828000
         LA    R8,THREE           GET TRANSIENT AREA REQUIREMENT@Y17XAU 80828400
         AR    R14,R8             GET TOTAL NUMBER OF BLOCKS   @Y17XAUU 80828800
*                                   REQUIRED                   @Y17XAUU 80829200
         STH   R14,TOTBKRQD       PUT NEW CORE BLOCK REQUIREMENT@Y17XAU 80829600
*                                   INTO OLTCB                 @Y17XAUU 80830000
*                                   IN OLTCB                   @Y17XAUU 80830400
         OI    TOTFLG10,TOTOLTWT+TOTOLTRS  SET RESTART FLAGE   @Y17XAUU 80830800
*                                 SET OLT WAITING FOR CORE FLAG@Y17XAUU 80831200
         POST  RESTECB1           REQUEST OLT CORE             @Y17XAUU 80831600
         XC    TOTOTECB(D4),TOTOTECB   CLEAR ECB               @Y17XAUU 80832000
         WAIT  1,ECB=TOTOTECB          WAIT FOR CORE ASSIGNMENT@Y17XAUU 80832400
         L     R8,TOTMMSPC             CORE AVAILABLE TO OLT   @Y17XAUU 80832800
         DROP  R10                                             @Y17XAUU 80833200
         BR    R12                     RETURN TO CK CORE AVAIL @Y17XAUU 80833600
         EJECT                                                 @Y17XAUU 80834000
*****************************************************************S99528 80834400
*****************************************************************S99528 80834800
*                                                              @Y17XAUU 80835200
*        INCLUSIVE OLT ID ROUTINE                              @Y17XAUU 80835600
*                                                              @Y17XAUU 80836000
*****************************************************************S99528 80836400
*****************************************************************S99528 80836800
INCHTST  EQU   *                       INCLUSIVE ROUTINE       @Y17XAUU 80837200
         CLI   TOTSECBL,BLANK          SECOND CHAR BLANK       @Y17XAUU 80837600
         BE    TWOBLNK                 YES BRANCH     A        @Y17XAUU 80838000
         CLI   TOTONECU,BLANK          FIRST CHAR BLANK        @Y17XAUU 80838400
         BE    ONEBLNK                 YES BRANCH    AA        @Y17XAUU 80838800
**   ENTRY LOOKS LIKE  AAA-AAZ                                 @Y17XAUU 80839200
         TM    TOTCRFLG,TOTFTTIM       FIRST TIME THRU         @Y17XAUU 80839600
         BZ    NOTFST                  NO BRANCH               @Y17XAUU 80840000
         LA    R3,ALPHTABL             GET ALPHBET ADDRESS     @Y17XAUU 80840400
FINDTID  CLC   0(1,R3),TOTONECU        FIND TEST ID            @Y17XAUU 80840800
         LA    R3,1(R3)                BUMP ALPHBET ADDRESS    @Y17XAUU 80841200
         BE    SAVEONEA                GO SAVE BUMPED ADDRESS  @Y17XAUU 80841600
         B     FINDTID                 KEEP SEARCHING          @Y17XAUU 80842000
SAVEONEA LR    R1,R4                   GET BASE ADDRESS        @Y17XAUU 80842400
         SR    R3,R1                   COMPUTE OFFSET          @Y17XAUU 80842800
         ST    R3,TOTSAADR             SAVE OFFSET             @Y17XAUU 80843200
         L     R5,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80843600
         AR    R5,R4                   COMPUTE ADDRESS         @Y17XAUU 80844000
MOVEID   MVC   TOTONELT(1),0(R5)       MOVE TO CURRENT OLT ID  @Y17XAUU 80844400
         MVI   TOTCRFLG,TOTCLRFG       CLEAR FIRST TIME FLAG   @Y17XAUU 80844800
         CLC   0(1,R5),TOTONEND        RUN ALL TEST ASK FOR    @Y17XAUU 80845200
         BH    TCNT56                  YES BRANCH              @Y17XAUU 80845600
         B     TCNT01A                 NO BRANCH               @Y17XAUU 80846000
NOTFST   L     R3,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80846400
         LA    R3,1(R3)                BUMP ADDRESS            @Y17XAUU 80846800
         AR    R3,R4                   RESTORE ADDRESS         @Y17XAUU 80847200
        B      SAVEONEA                BRANCH                  @Y17XAUU 80847600
ONEBLNK  TM    TOTCRFLG,TOTFTTIM       FIRST TIME THRU         @Y17XAUU 80848000
         BZ    NOTFST1                 NO BRANCH               @Y17XAUU 80848400
         LA    R3,ALPHTABL             GET ALPHBET ADDRESS     @Y17XAUU 80848800
FINDID1  CLC   0(1,R3),TOTSECBL        FIND TEST ID            @Y17XAUU 80849200
         LA    R3,1(R3)                BUMP ALPHBET ADDRESS    @Y17XAUU 80849600
         BE    SAVEONEB                GO SAVE BUMPED ADDRESS  @Y17XAUU 80850000
         B     FINDID1                 KEEP SEARCHING          @Y17XAUU 80850400
SAVEONEB LR    R1,R4                   GET BASE ADDRESS        @Y17XAUU 80850800
         SR    R3,R1                   COMPUTE OFFSET          @Y17XAUU 80851200
         ST    R3,TOTSAADR             SAVE OFFSET             @Y17XAUU 80851600
         L     R5,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80852000
         AR    R5,R4                   COMPUTE ADDRESS         @Y17XAUU 80852400
MOVEID1  MVC   TOTCRTOO(1),0(R5)       MOVE TO CURRENT OLT ID  @Y17XAUU 80852800
         MVI   TOTCRFLG,TOTCLRFG       CLEAR FIRST TIME FLAG   @Y17XAUU 80853200
         CLC   0(1,R5),TOTSECBK        RUN ALL TEST ASK FOR    @Y17XAUU 80853600
         BH    TCNT56                  YES BRANCH              @Y17XAUU 80854000
         B     TCNT01A                 NO  BRANCH              @Y17XAUU 80854400
NOTFST1  L     R3,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80854800
         LA    R3,1(R3)                BUMP ADDRESS            @Y17XAUU 80855200
         AR    R3,R4                   RESTORE ADDRESS         @Y17XAUU 80855600
         B     SAVEONEB                BRANCH                  @Y17XAUU 80856000
TWOBLNK  TM    TOTCRFLG,TOTFTTIM       FIRST TIME THRU         @Y17XAUU 80856400
         BZ    NOTFST2                 NO BRANCH               @Y17XAUU 80856800
         LA    R3,ALPHTABL             GET ALPHBET ADDRESS     @Y17XAUU 80857200
FINDID2  CLC   0(1,R3),TOTOLTTB        FIND TEST ID            @Y17XAUU 80857600
         LA    R3,1(R3)                BUMP ALPHBET ADDRESS    @Y17XAUU 80858000
         BE    SAVEONEC                GO SAVE BUMPED ADDRESS  @Y17XAUU 80858400
         B     FINDID2                 KEEP SEARCHING          @Y17XAUU 80858800
SAVEONEC LR    R1,R4                   GET BASE ADDRESS        @Y17XAUU 80859200
         SR    R3,R1                   COMPUTE OFFSET          @Y17XAUU 80859600
         ST    R3,TOTSAADR             SAVE OFFSET             @Y17XAUU 80860000
         L     R5,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80860400
         AR    R5,R4                   COMPUTE ADDRESS         @Y17XAUU 80860800
MOVEID2  MVC   TOTCRALP(1),0(R5)       MOVE TO CURRENT OLT ID  @Y17XAUU 80861200
         MVI   TOTCRFLG,TOTCLRFG       CLEAR FIRST TIME FLAG   @Y17XAUU 80861600
         CLC   0(1,R5),TOTCRSEC        RUN ALL TEST ASK FOR    @Y17XAUU 80862000
         BH    TCNT56                  YES BRANCH              @Y17XAUU 80862400
         B     TCNT01A                 NO BRANCH               @Y17XAUU 80862800
NOTFST2  L     R3,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80863200
         LA    R3,1(R3)                BUMP ADDRESS            @Y17XAUU 80863600
         AR    R3,R4                   RESTORE ADDRESS         @Y17XAUU 80864000
         B     SAVEONEC                BRANCH                  @Y17XAUU 80864400
         EJECT                                                 @Y17XAUU 80864800
         IEDQMSG LINK=YES,PREG0=R0                             @Y17XAUU 80865200
         EJECT                                                 @Y17XAUU 80865600
*********************************************************************** 80866000
*********************************************************************** 80866400
*                                                              @Y17XAUU 80866800
*       FIND UCB ROUTINE FOR TNT ENTRIES                       @Y17XAUU 80867200
*                                                              @Y17XAUU 80867600
*********************************************************************** 80868000
*********************************************************************** 80868400
UCBFIND  EQU   *                                               @Y17XAUU 80868800
         ST    R5,UCB5SAVE             SAVE REG                @Y17XAUU 80869200
         ST    R3,UCB3SAVE             SAVE REG                @Y17XAUU 80869600
         SR    R5,R5                   CLEZA REG               @Y17XAUU 80870000
         IC    R5,TOTTTBEL             GET TERMINAL NAME LENGTH@Y17XAUU 80870400
         AR    R5,R8                   GET TTE ADDRESS         @Y17XAUU 80870800
         MVC   TNTENTRY+D1(D3),D0(R5)  ALLINE ADDRESS          @Y17XAUU 80871200
         L     R8,TNTENTRY             GET TTE ADDR            @Y17XAUU 80871600
         USING IEDQTRM,R8                                      @Y17XAUU 80872000
         L     R8,TRMDESTQ-1           GET QCB ADDR            @Y17XAUU 80872400
         DROP  R8                                              @Y17XAUU 80872800
         USING IEDQQCB,R8                                      @Y17XAUU 80873200
         SR    R3,R3                   CLEAR REG               @Y17XAUU 80873600
         IC    R3,QCBRELLN             GET RLN                 @Y17XAUU 80874000
         SLL   R3,2                    MULT BY 4               @Y17XAUU 80874400
         L     R8,QCBDCBAD-1           GET DCB ADDR            @Y17XAUU 80874800
         DROP  R8                                              @Y17XAUU 80875200
         USING IHADCB,R8                                       @Y17XAUU 80875600
         L     R8,DCBDEBAD             GET DEB ADDR            @Y17XAUU 80876000
         DROP  R8                                              @Y17XAUU 80876400
         USING DEBNMSUB,R8                                     @Y17XAUU 80876800
         SR    R15,R15                 CLEAR REG               @Y17XAUU 80877200
         IC    R15,DEBNMEXT            GET # OF EXTENTS        @Y17XAUU 80877600
         SLL   R15,2                   MULT BY 4               @Y17XAUU 80878000
         L     R8,DEBUCBAD-4(R3)       GET UCB ADDR            @Y17XAUU 80878400
         L     R5,UCB5SAVE             RETURN REG              @Y17XAUU 80878800
         L     R3,UCB3SAVE             RESTORE REG             @Y17XAUU 80879200
         B     0(R12)                  BRANCH RETURN           @Y17XAUU 80879600
         EJECT                                                 @Y17XAUU 80880000
DDMOVE   EQU   *                       OPEN PRI DCBS           @Y17XAUU 80880400
GRAPHIC  LA    R9,CVTPTR               GET POINTER TO CVT      @Y17XAUU 80880800
         L     R9,0(R9)                CVT ADDRESS             @Y17XAUU 80881200
         L     R9,0(R9)                TCBPOINTERS ADDRESS     @Y17XAUU 80881600
         L     R9,4(R9)                CURRENT TCB ADDRESS     @Y17XAUU 80882000
         L     R9,12(R9)               TIOT ADDRESS            @Y17XAUU 80882400
         USING TIOT,R9                                         @Y17XAUU 80882800
         LA    R9,TIOENTRY             POINT TO FIRST ENTRY    @Y17XAUU 80883200
         DROP  R9                                              @Y17XAUU 80883600
         USING TIOENTRY,R9                                     @Y17XAUU 80884000
GETLENGT SR    R3,R3                   CLEAR REG               @Y17XAUU 80884400
         IC    R3,TIOELNGH             DD ENTRY LENGTH         @Y17XAUU 80884800
         LTR   R3,R3                   ANY LENGTH              @Y17XAUU 80885200
         BZ    NOTFOUND                NO BRANCH               @Y17XAUU 80885600
         LA    R5,POOLSTAR-TIOESTTB    GET LENGTH OF DEVICE ENTRYS99528 80886000
         DROP  R9                                              @Y17XAUU 80886400
         LR    R6,R3                   SAVE LENGTH             @Y17XAUU 80886800
         SR    R3,R5                   DD LENGTH -4            @Y17XAUU 80887200
         AR    R3,R9                   DEVICE                  @Y17XAUU 80887600
         USING TIOESTTB,R3                                     @Y17XAUU 80888000
         CLC   TIOEFSRT+1(2),ADDOFUCB  COMPARE UCB ADDRESSES FOR        80888400
         DROP  R3                                              @Y17XAUU 80888800
         BE    UCBFOUND                BR WHEN FOUND           @Y17XAUU 80889200
         AR    R9,R6                   BUMP TO NEXT DD ENTRY   @Y17XAUU 80889600
         B     GETLENGT                BRANCH                  @Y17XAUU 80890000
NOTFOUND EQU   *                                               @Y17XAUU 80890400
         B     NOTFOUND                BRANCH                  @Y17XAUU 80890800
UCBFOUND EQU   *                                               @Y17XAUU 80891200
         USING TIOENTRY,R9             TIOT ENTRY BASE         @Y17XAUU 80891600
COMPAREN EQU   *                                               @Y17XAUU 80892000
         CLI   TIOEDDNM,X'40'          IS NAME FIELD BLANK?    @Y17XAUU 80892400
         BNE   MOVEIN                  NO, GO MOVE DDNAME      @Y17XAUU 80892800
         SR    R9,R6                   SET ENTRY TO PRECEDING ONES99528 80893200
         B     COMPAREN                GO LOOK FOR NAME        @Y17XAUU 80893600
MOVEIN   EQU   *                                               @Y17XAUU 80933600
         MVC   EXCPDCB+40(8),TIOEDDNM  MOVE DDNMME TO DCB      @Y17XAUU 80973600
         DROP  R9                                              @Y17XAUU 81013600
         RDJFCB EXCPDCB                                        @Y17XAUU 81053600
         MVI   JFCBAA+53,X'00'         THIS                    @Y17XAUU 81093600
         MVC   JFCBAA+54(12),JFCBAA+53 SECTION                 @Y17XAUU 81133600
         MVI   JFCBAA+67,X'00'         OF CODE                 @Y17XAUU 81173600
         MVC   JFCBAA+68(12),JFCBAA+67 CLEARS                  @Y17XAUU 81213600
         MVI   JFCBAA+88,X'00'         UNUSED                  @Y17XAUU 81253600
         MVC   JFCBAA+89(29),JFCBAA+88 PARTS                   @Y17XAUU 81293600
         MVI   JFCBAA+148,X'00'        OF THE                  @Y17XAUU 81333600
         MVC   JFCBAA+149(25),JFCBAA+148  JFCB                 @Y17XAUU 81373600
         MVI   JFCBAA+52,X'08'         PREVENT REVERSE         @Y17XAUU 81413600
         MVI   JFCBAA+66,X'02'         MERGE AT CLOSE          @Y17XAUU 81453600
         MVC   TOTPRDCB(72),EXCPDCB    MOVE DCB TO OLTCB       @Y17XAUU 81493600
         LA    R1,TOTPRDCB             TEST DCB                @Y17XAUU 81533600
         ST    R1,TOTWKSPC             PUT IN P LIST           @Y17XAUU 81573600
         MVI   TOTWKSPC,X'8F'          OPTION OPEN             @Y17XAUU 81613600
         LA    R1,TOTWKSPC             ADDRESS OF P LIST       @Y17XAUU 81653600
         OPEN  MF=(E,(1)),TYPE=J       OPEN PRIMARY DCB        @Y17XAUU 81693600
         TM    TOTPRDCB+48,X'10'       SUCCESSFUL OPEN?        @Y17XAUU 81733600
         BNO   MOVEIN1                 BRANCH IF ERROR IN OPEN @Y17XAUU 81773600
         L     R3,TOTPRDEB             GET ADDRESS OF DEB      @Y17XAUU 81813600
         LA    R3,D34(R3)              GET ADDRESS OF UCB IN DEB        81853600
         ST    R3,TOT102A              SAVE UCB ADDRESS IN SVC @Y17XAUU 81893600
*                                        102 PARM LIST FOR DATA@Y17XAUU 81933600
*                                        MOVE                  @Y17XAUU 81973600
         LA    R1,TOT102               LOAD ADDRESS OF PARM LIST        82013600
*                                        INTO REG 1            @Y17XAUU 82053600
         AQCTL                         ISSUE DATA MOVE SVC     @Y17XAUU 82093600
         B     0(R12)                  RETURN TO CALLER        @Y17XAUU 82133600
MOVEIN1  EQU   *                                               @Y17XAUU 82173600
         IEDQMSG MSGID=003,FUNCT=CEC,PREG0=R0,PREG1=R1 ERROR MSG        82213600
         OI    TOTFLG06,TOTCANCL       SET CANCEL BIT IN OLTCB @Y17XAUU 82253600
         B     TCNTL11A                GO CANCEL TRM           @Y17XAUU 82293600
**                                                             @Y17XAUU 82333600
RLNLCB   EQU   *                                               @Y17XAUU 82373600
*    IOBBASE ADDRESS PLUS IOBDCB INDEX TIMES RLN MINUS THE     @Y17XAUU 82413600
*        IOB DISPLACEMENT IN THE LCB EQUALS THE LCB ADDRESS    @Y17XAUU 82453600
         L     R8,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 82620000
         USING IEDQTRM,R8              TTE BASE                @Y17XAUU 82710000
         L     R8,TRMDESTQ-1           GET QCB ADDRESS         @Y17XAUU 82800000
         DROP  R8                                              @Y17XAUU 82890000
         USING IEDQQCB,R8              QCB BASE                @Y17XAUU 82980000
         SR    R7,R7                   CLEAR REG               @Y17XAUU 83070000
         IC    R7,QCBRELLN             GET RLN                 @Y17XAUU 83160000
         L     R8,QCBDCBAD-1           GET DCB ADDRESS         @Y17XAUU 83250000
         DROP  R8                                              @Y17XAUU 83340000
         USING IHADCB,R8               DCB BASE                @Y17XAUU 83430000
         SR    R6,R6                   CLEAR REG               @Y17XAUU 83520000
         IC    R6,DCBEIOBX             GET INDEX               @Y17XAUU 83610000
         LR    R9,R7                   SAVE RLN                @Y17XAUU 83700000
         LA    R5,LCBFLAG1-IEDQLCB     GET IOB DISPLACEMENT    @Y17XAUU 83790000
         L     R8,DCBIOBAD             GET IOBBASE ADDRESS     @Y17XAUU 83880000
         DROP  R8                                              @Y17XAUU 83970000
         MR    R6,R7                   RLN TIMES INDEX         @Y17XAUU 84060000
         AR    R6,R8                   RESULTS PLUS BASE       @Y17XAUU 84150000
         SR    R6,R5                   GET LCB ADDRESS         @Y17XAUU 84240000
         ST    R7,TOTPRRLN             PUT RLN AND LCB         @Y17XAUU 84330000
         STC   R9,TOTPRRLN             IN TOTPRENT             @Y17XAUU 84420000
         B     0(R12)                  RETURN                  @Y17XAUU 84510000
         EJECT                                                 @Y17XAUU 84600000
         DS    0F                                              @Y17XAUU 84690000
CDSLINE  DC    CL8'G0000000'           CDS NAME                @Y17XAUU 84780000
DEVADBUF DS    0F                                              @Y17XAUU 84870000
         DC    4CL1'0'                 DEVICE ADDRESS BUFFER   @Y17XAUU 84960000
NCPDCB   DS    F                       3705 DCB ADDR SAVE AREA @XM05808 85000010
SETCLNST DS    0F                      SETS TOTCLNST W/ C&S    @G36XRUV 85010010
         DC    AL1(TOTCLNST)                                   @G36XRUV 85020010
         DC    AL3(0)                                          @G36XRUV 85030010
****************************************************************        85050000
*        PARAMETER LIST FOR DATA MOVE SVC                      *        85140000
****************************************************************        85230000
*                                                              @Y17XAUU 85320000
TOT102   DS    0F                      ALIGNMENT               @Y17XAUU 85410000
         DC    X'08'                   FLAG FOR DATA MOVE      @Y17XAUU 85500000
         DC    AL3(ADDOFUCB)           DATA ADDRESS            @Y17XAUU 85590000
TOT102A  DC    X'00'                   FLAGS                   @Y17XAUU 85680000
         DC    AL3(0)                  TARGET ADDRESS          @Y17XAUU 85770000
         DC    X'80'                   LAST WORD FLAG          @Y17XAUU 85860000
         DC    AL3(TOT102LN)           ADDRESS OF LENGTH FIELD @Y17XAUU 85950000
TOT102LN DC    H'2'                    LENGTH OF UCB ADDRESS MOVES99528 86040000
ADDOFUCB DC    AL3(0)                  UCB ADDRESS             @Y17XAUU 86130000
JFCBAA  DC     CL176'0'                JFCB                    @Y17XAUU 86220000
         DS    0F                      EXIT LIST               @Y17XAUU 86310000
JFCBADDR DC    X'07'                   KEY FOR JFCB            @Y17XAUU 86400000
         DC    AL3(JFCBAA)             ADDRESS OF THE JFCB     @Y17XAUU 86490000
         DC    X'80'                   END OF LIST             @Y17XAUU 86580000
         DC    AL3(0)                  ZEROS                   @Y17XAUU 86670000
MOVENAME MVC   PRINAME(0),0(R8)     MOVE NAME TO PLIST         @Y17XAUU 86760000
PRINAME  DC    CL8' '                  PRIMARY TEST DEVICE NAME@Y17XAUU 86850000
         DS    0F                      BOUNDARY ALLIGNMENT     @Y17XAUU 86940000
TTEADDR  DC    A(0)                    TTE ADDRESS             @Y17XAUU 87030000
EXCPDCB  DCB   DDNAME=DD274E,DSORG=PS,EXLST=JFCBADDR,MACRF=(E),        C87070000
               SIOA=AO,CENDA=AP,XENDA=AP   GRAPHIC APPENDAGES  @Y17XAUU 87210000
EXCP     OPEN  (EXCPDCB,),MF=L                                 @Y17XAUU 87300000
SAVEENT  DC    A(0)                    STATUS SAVE AREA        @Y17XAUU 87390000
***                                                            @Y17XAUU 87480000
***      MESSAGES                                              @Y17XAUU 87570000
***                                                            @Y17XAUU 87660000
UNIT     DC    CL8'        '           NNIT NAME               @Y17XAUU 87750000
UCB5SAVE DC    A(0)                    REG 5 SAVE              @Y17XAUU 87840000
UCB3SAVE DC    A(0)                    REG 3 SEVE              @Y17XAUU 87930000
TRMSAVE3 DS    15F                     SAVE AREA               @Y17XAUU 88020000
ERRCD8   DC    F'8'                    ERROR RETURN CODE       @XM05678 88060010
NAMEMOVE MVC   UNIT(ZERO),ZERO(R1) MOVE NAME                   @Y17XAUU 88110000
TERMIAT  DC    CL8'        '           START TERM MSG ID       @Y17XAUU 88190000
TERMIATE DC    CL26'            UNIT          '  START TERM MSG@Y17XAUU 88270000
NOCOREE  DC    CL8'IED331I '           MESSAGE ID              @Y17XAUU 88350000
NOCORE   DC    CL37'NOT ENOUGH CORE FOR SECTION          ' MSG @Y17XAUU 88430000
NOTLOADD DC    CL8'IED330I '           MESSAGE ID              @Y17XAUU 88510000
NOTLOAD  DC    CL32'OLT MODULE          NOT LOADABLE'    MSG   @Y17XAUU 88590000
ASTRICK  EQU   X'5C'                   ASTERICK                @Y17XAUU 88670000
TEE      EQU   X'E3'                   T                       @Y17XAUU 88750000
S        EQU   X'E2'                   S                       @Y17XAUU 88830000
INITSTAT DC    X'00'                   INITAL STATUS BYTE      @Y17XAUU 88910000
APSTIME  DC    X'00'                   AP STIMER FLAG          @Y17XAUU 88990000
APSTIMER EQU   X'80'                   STIMER FOR AP           @Y17XAUU 89070000
ALPHTABL DC    CL26'ABCDEFGHIJKLMNOPQRSTUVWXYZ'     TABLE      @Y17XAUU 89150000
ENDALTAB DC    X'EA'                   PAST ALPHBET            @Y17XAUU 89230000
STARTID  DC    CL8'IED333I '           START ID                @Y17XAUU 89310000
TERMID   DC    CL8'IED334I '           TERM ID                 @Y17XAUU 89390000
         DS    0D                      DOUBLE WORD ALLINE      @Y17XAUU 89470000
NAMESAVE DC    CL8' '                  TEST DEV GROUP NAME     @Y17XAUU 89550000
PATCH    DC    CL100' '                PATCH AREA              @Y17XAUU 89630000
BLDLLIST DS    0F                 BLDL P-LIST                  @Y17XAUU 89822000
         DC    XL2'0001'          NUMBER OF LIST ENTRIES       @Y17XAUU 89824000
         DC    XL2'003A'          LENGTH OF EACH ENTRY         @Y17XAUU 89826000
READNAME DC    8XL1'40'           MODULE ID                    @Y17XAUU 89828000
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 89830000
BLDLNAM  DC    XL3'0'             MAIN STORAGE NEEDED          @Y17XAUU 89832000
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 89834000
WORKA    DC    X'000F'            USED FOR CONVERSION          @Y17XAUU 89836000
         EJECT                                                 @Y17XAUU 89838000
KTRM     DS    0F                 *** DO NOT INSERT BETWEEN *'S@Y17XAUU 89840000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS       @Y17XAUU 89842000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS       @Y17XAUU 89843000
TRMQCB   DS    A                  CT/AP QCB ADDRESS            @Y17XAUU 89844000
TRMTNT   DS    A                  CT/AP TNT ADDRESS            @Y17XAUU 89845000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 89846000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA          @Y17XAUU 89847000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 89848000
REGSAVE  DS    F                  WORK AREA                    @Y17XAUU 89849000
F32      DC    F'32'              VALUE OF 32                  @Y17XAUU 89850000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @Y17XAUU 89858200
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @Y17XAUU 89858400
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @Y17XAUU 89858600
KDRQ     DS    A                  TRUE DRQ ADDRESS             @Y17XAUU 89858800
KPQCBSZ  DS    H                  P-QCB SIZE                   @Y17XAUU 89859000
KMQCBSZ  DS    H                  M-QCB SIZE                   @Y17XAUU 89859200
KDRQSZ   DS    H                  DRQ SIZE                     @Y17XAUU 89859400
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @Y17XAUU 89859600
TTECSZ   DS    CL1                CONC TTE SIZE                @Y17XAUU 89859800
TRMRQFLG DS    CL1                DUMMY TNT REQUEST FLAG       @Y17XAUU 89860000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 89862000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 89864000
PRREQ    EQU   X'20'              PRIMARY TD REQUEST           @Y17XAUU 89866000
SCREQ    EQU   X'10'              SECONDARY TD REQUEST         @Y17XAUU 89868000
ALRDY    EQU   X'00'              COUNTERFEIT STORAGE ALREADY  @Y17XAUU 89870000
*                                 EXIST FOR THIS REQUEST       @Y17XAUU 89872000
TRMFLG01 DS    CL1                CONTROL FLAG                 @Y17XAUU 89874000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC    @Y17XAUU 89876000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE             @Y17XAUU 89878000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION         @Y17XAUU 89880000
TRMRNLU  EQU   X'10'              SNA LU ENTRY                 @Y17XAUU 89882000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE      @Y17XAUU 89884000
TRM3705  EQU   X'04'              3705 MODE                    @Y17XAUU 89886000
TRMCTEAP EQU   X'02'              CT EQU AP                    @Y17XAUU 89888000
WRKFLG   DS    CL1                WORK AREA                    @Y17XAUU 89890000
KTRMEND  DS    0C                 END OF KTRM DSECT            @Y17XAUU 89892000
************************************************************** @Y17XAUU 89894000
         EJECT                                                 @Y17XAUU 90090000
         TLCBD                                                 @Y17XAUU 90170000
         EJECT                                                 @Y17XAUU 90250000
UCB      DSECT LIST=YES                                        @Y17XAUU 90330000
         IEFUCBOB                                              @Y17XAUU 90410000
         EJECT                                                 @Y17XAUU 90490000
RESPL    RESPL EQUATES=YES                                     @Y17XAUU 90570000
         EJECT                                                 @Y17XAUU 90650000
         OLTCB                         OLTCB CONTROL BLOCK     @Y17XAUU 90730000
         EJECT                                                 @Y17XAUU 90810000
         TLGBD                         LGB                     @Y17XAUU 90890000
TCNTBLDL EQU   TOTWKSPC                                        @Y17XAUU 90970000
TCNTBECT EQU   TCNTBLDL+1                                      @Y17XAUU 91050000
TCNTBELN EQU   TCNTBLDL+3                                      @Y17XAUU 91130000
TCNTMDNM EQU   TCNTBLDL+4                                      @Y17XAUU 91210000
TCNTMDSZ EQU   TCNTBLDL+28                                     @Y17XAUU 91290000
TEMPSAVE EQU   TOTWKSPC+8              WORK AREA               @Y17XAUU 91370000
         EJECT                                                 @Y17XAUU 91450000
         TDEBD                                                 @Y17XAUU 91530000
         EJECT                                                 @Y17XAUU 91610000
PLNKPREF DSECT                                                 @Y17XAUU 91690000
PLNKNAME DS    CL8                     OLT NAME                @Y17XAUU 91770000
         ORG   PLNKPREF+10             TO POINTER              @Y17XAUU 91850000
PLNKMPTR DS    CL2                     POINTER                 @Y17XAUU 91930000
         SPACE 5                                               @Y17XAUU 92010000
PLNKQPTR DSECT                                                 @Y17XAUU 92090000
PLNKQFWD DS    F                       FORWARD POINTER         @Y17XAUU 92170000
PLNKQBKD DS    F                       BACK POINTER            @Y17XAUU 92250000
         EJECT                                                 @Y17XAUU 92330000
DCBDSECT DCBD  DSORG=TX                                        @Y17XAUU 92410000
          TQCBD                                                @Y17XAUU 92490000
CVT      DSECT                                                 @Y17XAUU 92570000
         CVT                                                   @Y17XAUU 92650000
TIOT     DSECT                                                 @Y17XAUU 92730000
         IEFTIOT1                                              @Y17XAUU 92810000
         EJECT                                                 @Y17XAUU 92890000
         TTRMD                                                 @Y17XAUU 92970000
         EJECT                                                 @Y17XAUU 93050000
         TAVTD                                                 @Y17XAUU 93130000
         EJECT                                                 @Y17XAUU 93210000
         TTCDSD                                                @Y17XAUU 93570000
         END                                                            93600000
