         TITLE 'IEDQWE2  TOTE CLEAN UP MODULE     '              S22024 00090000
IEDQWE2  CSECT                                                   S22024 00180000
*A000000-999999                                                @Y16X5U0 00185000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00210000
* A000000-999999                                                 S22024 00240000
*A301200,340600,321360-322020,420020-420220,424300,506240-506640 S05331 00250000
*A510700,569170-569190,569540-569560,625800-626100,863005-863025 S05331 00255000
*D299700,702900-708300                                           S05331 00260000
*A105600-105900,175700-176100,255650-256350                      Y06330 00262005
*C300300,301000,305500,420000,506200,862600                      S05331 00265000
*C521100                                                       @SA74550 00267058
*A125100,204600,285300,420040,506280,569040,569460,733500      @Y17XAUU 00267600
*A760500,844200                                                @Y17XAUU 00268200
*C569190,569560,672300-673200,675000,791100                    @Y17XAUU 00268800
*D762300-784800                                                @Y17XAUU 00269400
* A002694,175600,365400,387900,395820,420084,420100,447240,    @XM05672 00269500
* A458100,506352,506400,863025                                 @XM05672 00269600
* C395820,447240                                               @XM05672 00269700
* D120600-121500,122420-123020,175610-175640,366300,531700     @XM05672 00269800
* A420220,436500,472500,506640,545400,548100                   @G36XRUV 00269900
* C420300,437400,473400,506700,546300,549000                   @G36XRUV 00289900
*A108000,620100,651600,834300                                  @OY20578 00290086
* A164700,196200                                               @OY20828 00290186
* C166500                                                      @OY20828 00290286
*                                                                       00309900
*********************************************************************** 00329900
*                                                               S22024* 00360000
*                                                               S22024* 00400000
* MODULE NAME:                                                  S22024* 00410000
*                                                               S22024* 00420000
*    IEDQWE2 (TCAM,TOTE)                                       @Y17XAUU 00430000
*                                                               S22024* 00440000
* DESCRIPTIVE NAME:                                             S22024* 00450000
*                                                               S22024* 00460000
*    TOTE CLEANUP MODULE                                        S22024* 00470000
*                                                               S22024* 00480000
* COPYRIGHT:                                                    S22024* 00490000
*                                                               S22024* 00500000
*    'NONE'                                                     S22024* 00510000
*                                                               S22024* 00520000
* STATUS:                                                       S22024* 00530000
*                                                               S22024* 00540000
*    VERSION 10.0                                              @Y17XAUU 00550000
*                                                                     * 00720000
* ENTRY POINT:                                                        * 00810000
*                                                                     * 00900000
*    IEDQWE2                                                   @Y17XAUU 00990000
*                                                              @Y17XAUU 00991000
* LINKAGE: XCTL'ED FROM IEDQWE                                 @Y17XAUU 00992000
*                                                              @Y17XAUU 00993000
* PURPOSE: SEE FUNCTION                                        @Y17XAUU 00994000
*                                                               S22024* 01030000
* FUNCTIONS:                                                          * 01080000
*                                                                     * 01170000
*    THE PURPOSE OF THIS MODULE IS TO:                          S22024* 01260000
*    1. GO TO IEDQWAJ FOR $CUTEST CLEANUP IF THE OLT HAS ISSUED S22024* 01320000
*        $CUTEST DURNING HIS RUN                                S22024* 01380000
*    2. IF THE CONTORL TERMINAL OR ALTERNATE PRINTER IS ON A    S22024* 01440000
*        270X WAIT UNTIL TCAM HAS SENT ALL MESSAGES SHIPPED BY  S22024* 01500000
*        TOTE                                                   S22024* 01560000
*    3. RESTORE ALL DEVICES USED BY TOTE ( CONTROL TERMINAL,    S22024* 01620000
*        ALTERNATE PRINTER, AND ALL TEST DEVICES) TO THEIR      S22024* 01680000
*        ORIGINAL STATUS IN THE EYES OF TCAM                    S22024* 01740000
*    4. DEQ ALL DEVICES USED BY TOTE                            S22024* 01800000
*    5. CLOSE THE PRIMARY AND SECONDARY DCB'S IF LEFT OPEN      S22024* 01860000
*    6. INSURE ALL DEVICES USED BY TOTE ARE RETURNED TO TCAM    S22024* 01920000
*    7. IF ANY OF THE DEVICES USED BY TOTE IS ON A CONCENTRATOR S22024* 01980000
*        XCTL   TO IEDQWEC FOR CONCENTRATOR CLEANUP OTHERWISE   S22024* 02040000
*        RETURN TO TOTE'S RESIDENT MODULE IEDQWA                S22024* 02100000
*                                                                     * 02260000
* INPUT:                                                              * 02360000
*                                                                     * 02460000
*    REGISTER 02,13,14,15 CONTAIN THE FOLLOWING VALUES:               * 02560000
*          02 - OLTCB POINTER                                         * 02660000
*          13 - SAVE AREA ADDRESS                                     * 02760000
*          14 - RETURN ADDRESS                                        * 02860000
*          15 - ENTRY POINT ADDRESS                                   * 02960000
*                                                                     * 03060000
* EXTERNAL ROUTINES:                                                  * 03240000
*                                                                     * 03330000
*       IEDQWK - TOTE MESSAGE MODULE                                  * 03420000
*       IEDQWAJ - $CUTEST MODULE                                S22024* 03460000
*                                                                     * 03510000
* EXIT POINTS:                                                        * 03600000
*                                                                     * 03630000
*    RETURN TO IEDQWA                                                 * 03660000
*    XCTL TO IEDQWEC - CONCENTRATOR MODULE                      S22024* 03670000
*                                                                     * 03690000
* TABLES/WORK AREAS:                                                  * 03780000
*                                                                     * 03870000
*       OLTCB, UCB                                                    * 03960000
*                                                                     * 04050000
* ATTRIBUTES:                                                         * 04140000
*                                                                     * 04230000
*       ENABLED, PROBLEM PROGRAM MODE, TRANSIENT.                     * 04320000
*                                                              @Y17XAUU 04320100
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 04320200
*                                                              @Y17XAUU 04320300
* MODULE SIZE: 4K MAXIMUM                                      @Y17XAUU 04320400
*                                                              @Y17XAUU 04320500
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 04320600
*                                                              @Y17XAUU 04320700
* MACROS - SAVE                                                @Y17XAUU 04320800
*          AQCTL                                               @Y17XAUU 04320900
*          IEDHJN                                              @Y17XAUU 04321000
*          XCTL                                                @Y17XAUU 04321100
*          WAIT                                                @Y17XAUU 04321200
*                                                              @Y17XAUU 04321300
* NOTES: SEE BELOW                                             @Y17XAUU 04321400
*                                                              @Y17XAUU 04321500
*  DEPENDENCIES: EBCDIC CHARACTER CODE                         @Y17XAUU 04321600
*                                                              @Y17XAUU 04321700
*  RESTRICTIONS: NONE                                          @Y17XAUU 04321800
*                                                              @Y17XAUU 04321900
*  REGISTER CONVENTIONS: SEE REGISTER ASSIGNMENT               @Y17XAUU 04322000
*                                                              @Y17XAUU 04322100
*  PATCH LABEL: PATCH                                          @Y17XAUU 04322200
*********************************************************************** 04410000
         EJECT                                                          04430000
*                                                                       04500000
*        REGISTER EQUATES                                               04590000
*                                                                       04680000
R0       EQU   0                       REG 0                     S99528 04770000
R1       EQU   1                       REG 1                     S99528 04860000
R2       EQU   2                       REG 2                     S99528 04950000
R3       EQU   3                       REG 3                     S99528 05040000
R4       EQU   4                       REG 4                     S99528 05130000
R5       EQU   5                       REG 5                     S99528 05220000
R6       EQU   6                       REG 6                     S99528 05310000
R7       EQU   7                       REG 7                     S99528 05400000
R8       EQU   8                       REG 8                     S99528 05490000
R9       EQU   9                       REG 9                     S99528 05580000
R10      EQU   10                      REG 10                    S99528 05670000
R11      EQU   11                      REG 11                    S99528 05760000
R12      EQU   12                      REG 12                    S99528 05850000
R13      EQU   13                      REG 13                    S99528 05940000
R14      EQU   14                      REG 14                    S99528 06030000
R15      EQU   15                      REG 15                    S99528 06120000
JFCBTSDM EQU   X'08'                   DISP                      S99528 06210000
JFCBLTYP EQU   X'02'                   TYPE                      S99528 06300000
ZERO     EQU   0                       ZERO                      S99528 06390000
ONE      EQU   1                       ONE                       S99528 06480000
TWO      EQU   2                       TWO                       S99528 06570000
THREE    EQU   3                       THREE                     S99528 06660000
FOUR     EQU   4                       FOUR                      S99528 06750000
FIVE     EQU   5                       FIVE                      S99528 06840000
SIX      EQU   6                       SIX                       S99528 06930000
SEVEN    EQU   7                       SEVEN                     S99528 07020000
EIGHT    EQU   8                       EIGHT                     S99528 07110000
NINE     EQU   9                       NINE                      S99528 07200000
TENN     EQU   10                      TEN                       S99528 07290000
ONEONE   EQU   11                      ELEVEN                    S99528 07380000
D0       EQU   0                       DISPLACEMENT              S22024 07470000
D1       EQU   1                       DISPLACEMENT              S22024 07560000
D2       EQU   2                       DISPLACEMENT              S22024 07650000
D3       EQU   3                       DISPLACEMENT              S22024 07740000
D4       EQU   4                       DISPLACEMENT              S22024 07830000
D5       EQU   5                       DISPLACEMENT              S22024 07920000
D6       EQU   6                       DISPLACEMENT              S22024 08010000
D7       EQU   7                       DISPLACEMENT              S22024 08100000
D8       EQU   8                       DISPLACEMENT              S22024 08190000
D9       EQU   9                       DISPLACEMENT              S22024 08280000
D10      EQU   10                      DISPLACEMENT              S22024 08370000
D13      EQU   13                      DISPLACEMENT              S22024 08390000
D16      EQU   16                      DISPLACEMENT              S22024 08410000
D32      EQU   32                      DISPLACEMENT              S22024 08460000
D34      EQU   34                      DISPLACEMENT 34           S99528 08550000
DEVTBEND EQU   X'00'                   TEST DEVICE TABLE END CODES99528 08640000
X40      EQU   X'40'                   BLANK                     S22024 08730000
X80      EQU   X'80'                   LINE ENTRY OR LGB TEST    S22024 08820000
X00      EQU   X'00'                   OK RETURN                 S22024 08840000
XF1      EQU   X'F1'                   TOTE RESOURCE             S22024 08845000
XDC      EQU   X'DC'                   PRIORITY                  S22024 08850000
X18      EQU   X'18'                   LENGTH OF ELEMENT         S22024 08855000
X08      EQU   X'08'                   ALREADY DONE RETURN       S22024 08860000
X0C      EQU   X'0C'                   FLAG START                S22024 08880000
XE0      EQU   X'E0'                   CLEAR EQU                 S22024 08910000
ZEROZ    EQU   X'00'                   CLEAR FIELD               S22024 09000000
X0F      EQU   X'0F'                   CLEAR FOR UCB TYPE        S22024 09090000
IPL3705  EQU   X'52'                   IPL VERB                  S22024 09180000
ACT3705  EQU   X'53'                   ACTIVATE VERB             S22024 09270000
DACT3705 EQU   X'54'                   DEACTIVATE VERB           S22024 09360000
RNUCBTST EQU   X'05'                   3705 UCB                  S22024 09450000
DEC58    EQU   58                      FIFTY EIGHT               S99528 09540000
SECTBEND EQU   X'40'                   SECTION TABLE END CODE    S99528 09630000
STRTCODE EQU   X'40'                   START CODE                S99528 09720000
STOPCODE EQU   X'41'                   START LINE                S99528 09810000
LINESTRT EQU   X'40'                   STOP LINE                 S99528 09900000
LINESTOP EQU   X'41'                   VERB CODE                 S99528 09990000
TERMSTRT EQU   X'45'                   VERB CODE START TERM      S99528 10080000
TERMSTOP EQU   X'47'                   TERMINAL CODE STOP        S99528 10170000
HOLDTERM EQU   X'88'                   HOLD TERMINAL VERB CODE   S99528 10260000
ACTIVETM EQU   X'46'                   ACTIVATE TERM VERB CODE   S99528 10350000
REALTERM EQU   X'87'                   RELEASE TERM VERB CODE    S99528 10440000
INACTERM EQU   X'48'                   INACTIVATE VERB CODE      S99528 10530000
SWPRI    EQU   X'50'                   SWITCH TO PRIMARY         Y06330 10560005
SWBCK    EQU   X'51'                   SWITCH TO BACKUP          Y06330 10590005
BLANK    EQU   X'40'                   INCLUSIVE DLIM            S99528 10620000
X44      EQU   X'44'                   DEB CK                    S22024 10710000
UCBNALBT EQU   X'04'                   UCB UNALLOCATE BIT        S22024 10740000
UCBNALOF EQU   X'FB'                   TURN OFF UNALLOCATE BIT   S22024 10770000
XFF      EQU   X'FF'                   CLEAN UP ELEMENT          S22024 10780000
X20      EQU   X'20'                   PRIORITY OF CLEANUP       S22024 10790000
ADRMSK   EQU   7                       ADDRESS MASK            @YM08136 10795000
*                                                                       10800000
HALFWORD EQU   3                       HALFWORD MASK           @OY20578 10840086
         EJECT                                                          10890000
         SAVE  (14,12)                 SAVE REGS                 S99528 10980000
         USING TOTOLTCB,R2             OLTCB                     S22024 11070000
*                                                                       11160000
*        SATISFY LINKAGE CONVENTIONS                                    11250000
*                                                                       11340000
         LR    R4,R15                  ESTABLISH BASE REG        S99528 11430000
         USING IEDQWE2,R4              IEDQWE2                          11520000
         ST    R13,TOTSAVE4+FOUR       SAVE CALLERS SAVE ADDR    S99528 11610000
         LR    R12,R13                 SAVE IT HERE TOO          S99528 11700000
         LA    R13,TOTSAVE4            MY SAVE AREA ADDRESS      S99528 11790000
         ST    R13,EIGHT(R12)          MY SAVE TO HIS            S99528 11880000
IEDQWE2  IEDHJN IEDQWEE,HJN            NAME AND HJN                     11970000
*        HOUSEKEEP FOR TERMINATION                                      12240000
         SPACE 2                                                        12304000
TCNT11E  EQU   *                                               @YM08158 12306000
         TM    TOTCUFLG,TOTCUDON       CU TEST BEEN ISSUED       S99528 12330000
         BZ    TCNT172                 BO BRANCH                 S99528 12420000
         OI    TOTCUFLG,TOTCUCUP       CLEAN UP NEEDED FLAG      S99528 12510000
         LA    R8,TOTSERV              ADDR OF  QWAJ WORK AREA @Y17XAUU 12511000
         LR    R10,R8             SET IT AGAIN                 @Y17XAUU 12512000
         LA    R9,L'TOTSERV            LENGTH OF WORKAREA      @Y17XAUU 12513000
         SLR   R11,R11                 SET COUNT REG           @Y17XAUU 12514000
         MVCL  R8,R10                 CLEAR WORK AREA          @Y17XAUU 12515000
         L     R5,TOTRESPL             GET RESPL ADDRESS       @Y17XAUU 12516000
         USING RESPL,R5                SET RESPL ADDRESSABILITY@Y17XAUU 12517000
         L     R15,RESPLAJ             $CUTEST ROUTINE ADDRESS @Y17XAUU 12518000
         BALR  R14,R15                 DO CUTEST CLEANUP       @Y17XAUU 12519000
TCNT172  EQU   *                                                        12690000
         L     R8,TOTAVTPT             GET ADDRESS OF AVT        S22024 12690400
         USING IEDQAVTD,R8             SET UP BASE FOR AVT       S22024 12690800
         LA    R7,AVTOPCOB             GET POINTER TO OP CONTROL S22024 12691200
*                                        QCB                     S22024 12691600
         ST    R7,TOTOKEY              PUT ADDR IN PARM LIST     S22024 12692000
         MVI   TOTOKEY,X00             ZERO OUT KEY FIELD        S22024 12692400
         MVI   TOTOPRI,XDC             PRIORITY OF ELEMENT       S22024 12693000
         MVI   TOTOELNG,X18            LENGTH OF ELEMENT         S22024 12696000
         LA    R8,TOTPLIST             GET OP CONTROL P-LIST     S22024 12700000
         ST    R8,CBSLPL               ADDRESS AND STORE IN      S22024 12710000
         ST    R8,CBSLPL+D4            ELEMENT TWICE             S22024 12720000
         MVI   CBSLPL,X0C              START FLAG                S22024 12730000
         MVI   CBSLPL+D4,X80           END FLAG                  S22024 12740000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 12750000
         MVC   TOTOLADR+D1(D7),TOTOLADR   NAME                   S22024 12760000
         L     R8,TOTCTTNT             GET DUMMY TNT ENTRY       S99528 12780000
         LTR   R8,R8                   IS THERE ONE              S99528 12870000
         BZ    APTEST                  NO BRANCH                 S99528 12960000
         LA    R7,TOTCTENT-4           GET IOBLOCKS DESECT       S99528 13050000
         BAL   R12,STCTAP              START LINE                S99528 13140000
         BAL   R7,TNTALINE             GET TNT ADDRESS           S99528 13230000
         USING IEDQQCB,R6              QCB ADDRESSIBILITY        S99528 13320000
CTWAIT   L     R8,EIGHT(R6)            THIRD WORD OF             S99528 13410000
         LA    R8,ZERO(R8)             QCB POINT                 S99528 13500000
         LA    R7,EIGHT(R6)            TO IT SELF                S99528 13590000
         CR    R7,R8                   IF SO                     S99528 13680000
         BE    APTEST                  BRANCH                    S99528 13770000
         NI    QCBDSFLG,X'FF'-QCBHELD  TURN OFF QCBHELD IF ON    S99528 13950000
         STIMER WAIT,DINTVL=SECS00     WAIT 11 SECS              S99528 14040000
         B     CTWAIT                  BRANCH                    S99528 14130000
APTEST   L     R8,TOTAPTNT             GET DUMMY TNT ADDTESS     S99528 14220000
         LTR   R8,R8                   IS THERE ONE              S99528 14310000
         BZ    TCNT1722                NO BRANCH                 S99528 14400000
         LA    R7,TOTAPENT-4           GET IOBLOCKS DESECT       S99528 14490000
         OI    APSTIME,APSTIMER        SET AP STIMER             S99528 14580000
         BAL   R12,STCTAP              START LINE                S99528 14670000
         BAL   R7,TNTALINE             GET TNT ADDRESS           S99528 14760000
APWAIT   L     R8,EIGHT(R6)            THIRD WORD OF             S99528 14850000
         LA    R8,ZERO(R8)             QCB POINT                 S99528 14940000
         LA    R7,EIGHT(R6)            TO IT SELF                S99528 15030000
         CR    R7,R8                   IF SO                     S99528 15120000
         BE    TCNT1722                BRANCH                    S99528 15210000
         NI    QCBDSFLG,X'FF'-QCBHELD  TURN OFF QCBHELD IF ON    S99528 15300000
         STIMER WAIT,DINTVL=SECS00     WAIT 11 SECS              S99528 15480000
         B     APWAIT                  BRANCH                           15570000
         DROP  R6                                                       15660000
         EJECT                                                          15750000
*        START TEST DEVICES                                             15840000
*   RESTOR TEST DEVICES TO ORGINAL STATUS AND DEQ                       15930000
*                                                                       16020000
**                                                                      16110000
***                                                                     16200000
*                                                                       16290000
TCNT1722 EQU   *                                                 S99528 16380000
         LA    R3,TOTTDTBL             GET TEST DEVICE TABLE ADDRS99528 16470000
ALLENTY  DS    0H                      BOUNDARY ALLIGNMENT     @OY20828 16510086
         LA    R12,TOTTDEND            GE T END OF TABLE ADDRT   S99528 16560000
         CR    R3,R12                  ALL ENTRIES PROCESSED?  @OY20828 16650086
         BE    TCNT179                 YES BRANCH                S99528 16740000
         L     R8,0(R3)                GET ADDRESS FROM TABLE    S99528 16830000
         LR    R1,R8                   RERPARE TO SAEE           S99528 16920000
         SRL   R1,24                   HIGH ORDER BYTE           S99528 17010000
         STC   R1,INITSTAT             BYTE                      S99528 17100000
         LA    R8,0(R8)                CLEAR HI BYTE             S99528 17190000
         LTR   R8,R8                   ANY ADDRESS               S99528 17280000
         BZ    TCNT179                 NO BRANCH                 S99528 17370000
         TM    INITSTAT,TOTTDLIN       UCBS IN TABLE             S99528 17460000
         BO    LINETEST                YES BRANCH                S99528 17550000
         SLR   R1,R1                   CLEAR REGISTER          @YM08136 17551000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LEN    @YM08136 17552000
         LA    R6,D0(R1,R8)            POINT TO TTE ADDRESS    @YM08136 17553000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM08136 17554000
         ST    R6,TTEADDR              SAVE TTE ADDRESS        @YM09003 17555000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @YM08136 17556000
         SLR   R6,R1                   POINT TO TTE PREFIX     @YM08136 17557000
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @YM08136 17558000
         TM    TRMSTATE,TRMPREF        NCP RESOURCE            @YM08136 17559000
         BZ    TCNT1724                NO - CONTINUE           @YM08136 17560000
         CLI   TRMTYPE,TRMSDLC         Q-TD SNA LINE           @XM05672 17560100
         BNE   NOTSNALI                N-PROCESS NONSNA LINE   @XM05672 17560200
*        CONVERT LINE NAME TO TTCIN                            @XM05672 17560300
         USING IEDQAVTD,R8                                     @XM05672 17560400
         L     R8,TOTAVTPT             AVT ADDRESSABILITY      @XM05672 17560500
         SLR   R0,R0                   CLEAR REG 0             @XM05672 17560600
         IC    R0,TOTTTBEL             LENGTH OF NAME          @XM05672 17560700
         L     R1,0(R3)                ADDRESS OF TNT ENTRY    @XM05672 17560800
         LA    R1,0(R1)                CLEAR HI BYTE           @XM05672 17560900
         L     R15,AVTMSGS-1           CONVERT                 @XM05672 17561000
         L     R15,8(R15)               NAME TO                @XM05672 17561100
         BAL   R14,4(R15)               TTCIN                  @XM05672 17561200
         DROP  R8                      DROP AVT ADDRESSABILITY @XM05672 17561300
*        TURN OFF TRMSTOTE IN LINE ENTRY AND IN ALL INFERIOR   @XM05672 17561400
*        ENTRIES.                                              @XM05672 17561500
         LR    R1,R15                  COPY TTCIN              @XM05672 17561600
         USING RESPL,R8                RESPL BASE              @XM05672 17561700
         L     R8,TOTRESPL             RESPL ADDRESSABILITY    @XM05672 17561800
         L     R15,RESTLIB             ADDR OF HIER. SCAN RTN. @XM05672 17561900
         BALR  R14,R15                 TURN OFF BITS           @XM05672 17562000
         DROP  R8                      AVT ADDRESSABILITY      @XM05672 17562100
         B     SNARLSE                 GO RELEASE QUEUES       @XM05672 17562200
NOTSNALI DS    0H                                              @XM05672 17562300
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @YM08136 17562400
         CLI   TRMTYPE,TRMLUNT         SNA LU ENTRY            @YM08136 17562500
         BNE   TCNT1724                N-BYPASS LU PROCESSING  @XM05672 17562600
         TM    INITSTAT,TOTTDTHD       Q-INITIALLY HELD        @XM05672 17562700
         BO    LUTDEND                 Y-BRANCH                @XM05672 17562800
SNARLSE  DS    0H                                              @XM05672 17562900
         MVI   TOTOVBCD,REALTERM       N-SET TO RELEASE LINE   @XM05672 17563000
         BAL   R12,STARTERM            GO RELEASE              @XM05672 17563100
         CLI   TOTORTCD,X00            Q-RELEASED              @XM05672 17563200
         BE    LUTDEND                 Y-BRANCH                @XM05672 17563300
         CLI   TOTORTCD,X08            Q-ALREADY RELEASED      @XM05672 17563400
         BE    LUTDEND                 Y-BRANCH                @XM05672 17563500
         BAL   R12,BSTOP               N-PRINT MESSAGE         @XM05672 17563600
LUTDEND  DS    0H                      END OF LU PROCESSING    @XM05672 17563700
         B     CONTE3                  GO CHECK FOR NEXT TD    @XM05672 17563800
         DROP  R6                                              @YM08136 17564000
TCNT1724 EQU   *                                               @YM08136 17565000
         TM    INITSTAT,TOTTSWPM       HAS TOTE SWITCHED DEVICE  Y06330 17570005
         BO    SWSTRET                 YES BRANCH                Y06330 17590005
SWRETURN EQU   *                                                 Y06330 17610005
         TM    INITSTAT,TOTTDTHD       TERM ORIG HELD            S99528 17820000
         BO    STOPTERM                YES BRANCH                S99528 17910000
CONTE1 EQU  *                                                    S99528 18630000
         MVI   TOTOVBCD,REALTERM       VERB TO REALSE TERMINAL   S22024 18720000
         BAL   R12,STARTERM            GO REALSSE TERMINAL       S99528 18810000
         CLI   TOTORTCD,X00            OK                        S22024 18900000
         BE    CONTE2                  GOOD RETURN               S99528 18990000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 19080000
         BE    CONTE2                  YES BR                    S99528 19170000
         BAL   R12,BSTOP               GO SEND MSG               S99528 19260000
CONTE2 EQU  *                                                    S99528 19350000
LINETEST EQU   *                                                 S99528 19440000
         SLR   R1,R1                   CLEAR REGISTER          @YM09003 19450000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM09003 19460000
         LA    R6,D0(R1,R8)            POINT TO TTE ADDRESS    @YM09003 19470000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM09003 19480000
         ST    R6,TTEADDR              SAVE TTE ADDRESS        @YM09003 19490000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 19500000
         TM    INITSTAT,TOTTDLIN       TEST DEVICE A LINE        S22024 19530000
         BO    UCBTAB                  YES BRANCH                S99528 19620000
         TM    INITSTAT,TOTTDTRM+TOTTDORN 3705 TERMINAL TEST   @OY20828 19630086
         BO    CONTE3                  YES PROCESS NEXT ENTRY  @OY20828 19640086
         TM    INITSTAT,TOTTDORN       TEST DEVICE ON RN         S22024 19650000
         BO    UCBTAB                  YES BRANCH                S22024 19680000
         BAL   R12,UCBFIND             LOCATE UCB                S99528 19710000
UCBTAB   BAL   R12,LISTART             START LINE                S99528 19800000
         CLI   TOTORTCD,X00            OK                        S22024 19890000
         BE    CONTE3                  GOOD RETURN               S99528 19980000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 20070000
         BE    CONTE3                  YES BR                    S99528 20160000
         BAL   R12,BSTOP               GO SEND MSG               S99528 20250000
CONTE3 EQU  *                                                    S99528 20340000
RESTLP   LA    R3,4(R3)                BUMP TABLE POINTER        S99528 20430000
         TM    INITSTAT,TOTTDORN       TEST DEV ON RN            S22024 20440000
         BZ    NOTRNIN                 NO BRANCH                 S22024 20450000
         L     R6,TTEADDR              GET TTE ADDRESS           S22024 20460000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 20460400
         SLR   R6,R1                   ADDRESS OF TTE PREFIX   @Y17XAUU 20460800
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @Y17XAUU 20461200
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 20461600
         DROP  R6                      TTE                       S22024 20490000
NOTRNIN  EQU   *                                                 S22024 20500000
         B     ALLENTY                 GO PROCESS NEXT ENTRY     S99528 20520000
*                                                                     * 21690000
*              ACTIVATE TERMINAL                                      * 21780000
*                                                                     * 21870000
ACTIVTRM EQU   *                                                 S99528 21960000
         MVI   TOTOVBCD,ACTIVETM       VERB TO ACTIVATE TERMINAL S22024 22050000
         BAL   R12,STARTERM            GO ACTIVATE TERMINAL      S99528 22140000
         CLI   TOTORTCD,X00            OK                        S22024 22230000
         BE    CONTE5                  GOOD RETURN               S99528 22320000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 22410000
         BE    CONTE5                  YES BR                    S99528 22500000
         BAL   R12,BSTOP               GO SEND MSG               S99528 22590000
*                                                                     * 22680000
*              HOLD TERMINAL                                          * 22770000
*                                                                     * 22860000
CONTE5 EQU  *                                                    S99528 22950000
         MVI   TOTOVBCD,HOLDTERM       VERB TO HOLD TERMINAL     S22024 23040000
         BAL   R12,STARTERM            GO HOLD TERM              S99528 23130000
         CLI   TOTORTCD,X00            OK                        S22024 23220000
         BE    CONTE6                  GOOD RETURN               S99528 23310000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 23400000
         BE    CONTE6                  YES BR                    S99528 23490000
         BAL   R12,BSTOP               GO SEND MSG               S99528 23580000
CONTE6 EQU  *                                                    S99528 23670000
         B     LINETEST                GO START LINE             S99528 23760000
STOPTERM EQU   *                                                 S99528 23850000
         MVI   TOTOVBCD,TERMSTOP       VERB TO STOP TERMINAL     S22024 23940000
         BAL   R12,STARTERM            GO STOP TERMINAL          S99528 24030000
         CLI   TOTORTCD,X00            OK                        S22024 24120000
         BE    CONTE7                  GOOD RETURN               S99528 24210000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 24300000
         BE    CONTE7                  YES BR                    S99528 24390000
         BAL   R12,BSTOP               GO SEND MSG               S99528 24480000
CONTE7 EQU  *                                                    S99528 24570000
         B     LINETEST                GO START LINE             S99528 24660000
*****                                                              **** 24750000
*****          TOTE CANNOT RETURN TEST DEVICES TO ORIGINAL STATUS  **** 24840000
*****                                                              **** 24930000
BSTOP    WTO   'IED154I TOTE CANNOT RETURN DEVICE          TO ORIGINAL C25020000
               STATUS',ROUTCDE=10,DESC=7                         S99528 25110000
BSTOPNAM EQU   BSTOP+42                NAME IN MSG               S22024 25200000
         MVI   TOTORTCD,DEVTBEND       CLEAR RETURN CODE         S22024 25290000
         MVI   BSTOPNAM,BLANK          CLEAR                     S99528 25380000
         MVC   BSTOPNAM+ONE(SEVEN),BSTOPNAM  NAME IN MSG         S99528 25470000
         BR    R12                     RETURN                    S99528 25560000
SWSTRET  EQU   *                                                 Y06330 25565005
         LR    R9,R8                   SAVE TNT POINTER          Y06330 25570005
         SR    R10,R10                 CLEAR REG                 Y06330 25575005
         IC    R10,TOTTTBEL            NAME LENGTH               Y06330 25580005
         AR    R9,R10                  GET TTE ADDRESS           Y06330 25585005
         MVC   TTEADDR+D1(D3),D0(R9)   ALLINE ADDRESS            Y06330 25590005
         L     R6,TTEADDR              GET TTE ADDRESS           Y06330 25595005
         USING IEDQTRM,R6              TTE                       Y06330 25600005
         MVI   TOTOVBCD,SWBCK          SWITCH TO BACKUP          Y06330 25605005
         BAL   R12,STARTERM            GO SWITCH                 Y06330 25610005
         CLI   TOTORTCD,X00            OK                        Y06330 25615005
         BE    SWRETURN                YES BRANCH                Y06330 25620005
         BAL   R12,BSTOP               GO SEND MESSAGE           Y06330 25625005
         B     SWRETURN                CONTINUE                  Y06330 25630005
         DROP  R6                      TTE                       Y06330 25635005
         EJECT                                                          25650000
***      DEQ TEST DEVICES   ********                                    25740000
***                          *******                                    25830000
TNTMOVE  MVC   RNAME(0),0(R6)          MOVE NAME TO DEQ          S99528 25920000
TNTMOVEE MVC   0(0,R8),0(R1)           MOVE NAME TO DEQ          S22024 25960000
TNTENTRY EQU   *                       TNT ONLY                  S99528 26010000
         LR    R8,R6                   R8 TO TNT ADDRESS                26100000
         BAL   R12,UCBFIND             GO FIND UCB                      26190000
         USING UCB,R8                                                   26280000
         MVC   RNAME(3),UCBNAME                                         26370000
         DROP  R8                                                       26460000
         DEQ   ,MF=(E,DEQLIST)                                          26550000
         MVI   RNAME,X'40'                                              26640000
         MVC   RNAME+1(7),RNAME                                         26730000
         SR    R3,R3                   CLEAR REG                 S99528 26820000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S99528 26910000
         BCTR  R3,0                    DECREMENT LENGTH OOR EX   S99528 27000000
         EX    R3,TNTMOVE              GO TO MOVE NAME           S99528 27090000
         B     DEQNAME                 GO DEQ                    S99528 27180000
RNTEMDQ  EQU   *                       THIS ROUTINE FINDS THE    S22024 27270000
*                                      LINE NAME DOR A TRRMINAL  S22024 27360000
         LR    R9,R6                   GET TNT ADDRESS           S22024 27450000
         BAL   R12,TERMRNDQ            DEQ LINE FOR TERMINAL     S22024 27540000
         B     NXTENT                  GO GET NEXT ENTRY         S22024 27630000
TERMRNDQ EQU   *                                                 S22024 27720000
         STM   R5,R7,DEQSAVE           SAVE REGS 5,6,7           S22024 27810000
         SR    R3,R3                   CLEAR REG                 S22024 27900000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 27990000
         AR    R9,R3                   TTE ADDRESS               S22024 28080000
         MVC   TTEADDR+D1(D3),D0(R9)   ALLINE ADDRESS            S22024 28170000
         L     R9,TTEADDR              TTE ADDRESS               S22024 28260000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 28350000
         SR    R9,R1                   GET NTRM                  S22024 28440000
         USING IEDNTRM,R9              TTE                       S22024 28530000
CHKTTE   EQU   *                                               @Y17XAUU 28530200
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 28530400
         L     R10,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 28530600
         USING IEDQAVTD,R10            SET AVT ADDRESSABILITY  @Y17XAUU 28530800
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 28531000
         STH   R1,OFFSET               SAVE COHORT POINTER     @Y17XAUU 28531200
         BALR  R14,R15                 GET NEXT TTE ENTRY      @Y17XAUU 28531400
         LA    R14,TRMPRFSZ            GET PREFIX SIZE         @Y17XAUU 28531600
         SLR   R1,R14                  POINT TO TTE PREFIX     @Y17XAUU 28531800
         LR    R9,R1                   SET TTE BASE            @Y17XAUU 28532000
         CLI   TRMTYPE,TRMNSDLC        PRE SNA LINE ENTRY      @Y17XAUU 28532200
         BE    LINETTE                 YES                     @Y17XAUU 28532400
         CLI   TRMTYPE,TRMSDLC         SNA LINE ENTRY          @Y17XAUU 28532600
         BNE   CHKTTE                  CHECK NEXT ENTRY        @Y17XAUU 28532800
         DROP  R9                                              @Y17XAUU 28533000
LINETTE  EQU   *                                               @Y17XAUU 28533200
         AR    R1,R14                  RESET TTE BASE          @Y17XAUU 28533400
         DROP  R10                                             @Y17XAUU 28533600
         TM    RNFLAG,APFLAG           IS THIS A SEARCH FOR AP   S05331 32136000
*                                        LINE TTE                S05331 32142000
         BNO   CHKCT                   NO, GO CHECK CT           S05331 32148000
         ST    R1,APLTTE               SAVE TTE ADDRESS          S05331 32154000
         B     D0(R6)                  BRANCH BACK TO CALLER     S05331 32160000
CHKCT    EQU   *                                                 S05331 32166000
         TM    RNFLAG,CTFLAG           IS THIS A SEARCH FOR CT   S05331 32172000
*                                        LINE TTE ADDRESS        S05331 32178000
         BNO   CONTINUE                NO, CONTINUE              S05331 32184000
         ST    R1,CTLTTE               STORE CT LINE TTE ADDR    S05331 32190000
         B     D0(R6)                  RETURN TO CALLER          S05331 32196000
CONTINUE EQU   *                                                 S05331 32202000
         L     R14,TOTAVTPT            GET AVT ADDRESS           S22024 32220000
         USING IEDQAVTD,R14            AVT                       S22024 32310000
         L     R1,AVTRNMPT             GET TERMNAME TABLE ADDR   S22024 32400000
         DROP  R14                     AVT                       S22024 32490000
         USING IEDQTNTD,R1             TNT                       S22024 32580000
         LA    R1,TNTFIRST             FIRST ENTRY ADDR          S22024 32670000
         DROP  R1                      TNT                       S22024 32760000
         LA    R7,D3                   LENGTH OF TTE ADDRESS     S22024 32850000
         SR    R3,R3                   CLEAR REG                 S22024 32880000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 32910000
         AR    R7,R3                   LENGTH OF TNT ENTRY       S22024 32940000
         LH    R11,OFFSET              GET TNT OFFSET            S22024 33030000
         LA    R14,D1                  SUBTRACT ONE              S22024 33060000
         SR    R11,R14                 TO GET RIGHT OFFSET       S22024 33090000
         MR    R10,R7                  OFFSET TO ACTUAL ENTRY    S22024 33120000
         AR    R1,R11                  TNT ADDR OF LINE          S22024 33210000
         BCTR  R3,0                    DECREMENT BY 1            S22024 33300000
         LA    R8,TNTNAME2              GET TNT POINTER        @OY20578 33390086
         EX    R3,TNTMOVEE             MOVE NAME                 S22024 33480000
         MVC   RNAME(D8),TNTNAME2       NAME TO DEQ            @OY20578 33570086
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S22024 33660000
         MVI   RNAME,X40               CLEAR DEQ                 S22024 33750000
         MVC   RNAME+D1(D7),RNAME      PARM                      S22024 33840000
         LM    R5,R7,DEQSAVE           RESTORE REGS              S22024 33930000
         BR    R12                     GO DEQ NEXT ENTRY         S22024 34020000
TCNT179  EQU   *                                                        34110000
         TM    TOTFLG01,TOTCONFG       CLEANUP FOR CONFIG        S99528 34200000
         BO    TCNT21                  YES BRANCH                S99528 34290000
         LA    R5,TOTTDTBL             DEVICE TABLE ADDRESS      S99528 34380000
         LA    R7,TOTTDEND             END OF TABLE ADDRESS      S99528 34470000
LOOPP    L     R6,0(R5)                GET UCB OR TNT            S99528 34560000
       LTR     R6,R6                   IS THERE ONE              S99528 34650000
         BZ    TCNT211                 NO BRANCH                 S99528 34740000
         LR    R1,R6                   SAVE                      S22024 34760000
         SRL   R1,24                   INITIAL                   S22024 34780000
         STC   R1,INITSTAT             STATUS                    S22024 34800000
         TM    0(R5),TOTTDORN          TEST DEVICE ON 3705       S22024 34830000
         BO    TNTENTRY                YES BRANCH                S22024 34920000
         TM    0(R5),TOTTDLIN          TEST FOR 0X LINES         S22024 35010000
         BZ    TNTENTRY                NO BRANCH                 S99528 35100000
         USING UCB,R6                  UCB BASE                  S99528 35190000
         MVC   RNAME(3),UCBNAME        MOVE NAME TO P-LIST       S99528 35280000
         DROP  R6                      DROP                      S99528 35370000
DEQNAME  DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 35460000
         MVI   RNAME,X'40'                                              35550000
         MVC   RNAME+1(7),RNAME                                         35640000
         TM    0(R5),TOTTDORN          TEST DEVICE ON 3705       S22024 35730000
         BZ    NXTENT                  NO BRANCH                 S22024 35820000
         TM    0(R5),TOTTDLIN          TEST DEVICE 3705 LINE    -S22024 35910000
         BZ    RNTEMDQ                 NO BRANCH                 S22024 36000000
NXTENT   EQU   *                                                 S22024 36090000
         LA    R5,4(R5)                GET NEXT ENTRS            S22024 36180000
         CR    R5,R7                   END OF TABLE              S99528 36270000
         BNE   LOOPP                   NO BRANCH                 S99528 36360000
TCNT211  TM    TOTPRDCB+X'30',X'10'    DCB OPEN                  S99528 36450000
         BZ    SECDCBT                 NO BRANCH                 S99528 36540000
         L     R1,TOTPRDEB             GET PRIMARY DEB         @XM05672 36550000
         LA    R1,0(R1)                CLEAR HI BYTE           @XM05672 36560000
         LTR   R1,R1                   Q-IS THERE ONE          @XM05672 36570000
         BZ    SECDCBT                 N-CHECK SECONDARY       @XM05672 36580000
         LA    R1,TOTPRDCB             TEST DCB                  S99528 36720000
         ST    R1,TOTWKSPC             STORE IN P LIST           S99528 36810000
         MVI   TOTWKSPC,X'B0'          OPTION CLOSE              S99528 36900000
         LA    R1,TOTWKSPC             ADDRESS OF P LIST         S99528 36990000
         CLOSE MF=(E,(1))              CLOSE TEST DCB            S99528 37080000
****   CLOSE GRABED DCBS IF ANY        ***********                      37170000
*****                                  ***********                      37260000
SECDCBT  TM    TOTSCDCB+X'30',X'10'    SECOND DCB OPEN           S99528 37350000
         BZ    TCNT21                  NO BRANCH                 S99528 37440000
         L     R1,TOTSCDEB             EET SECONDARY BED         S99528 37530000
         LTR   R1,R1                   IS THERE ONE              S99528 37620000
         BZ    TCNT21                  NO BRANCH                 S99528 37710000
         LA    R1,TOTSCDCB             SECENDARY DEC             S99528 37800000
         ST    R1,TOTWKSPC             STORE IN P LIST           S99528 37890000
         MVI   TOTWKSPC,X'B0'          OPTION CLOSE              S99528 37980000
         LA    R1,TOTWKSPC             ADDRESS OF P LIST         S99528 38070000
         CLOSE MF=(E,(1))              CLOSE SECONDARY DCB       S99528 38160000
TCNT21   EQU   *                                                        38250000
         TM    TOTFLG09,TOTPRECT       WAS AP SELECTED           S99528 38340000
         BO    CTSYSCO                 NO BRANCH                 S99528 38430000
         TM    TOTFLG09,TOTAPTRM       IS AP TERMINAL            S99528 38520000
         BO    APORGST                 YES BRANCH                S99528 38610000
         B     CTSYSCO                 BRANCH                    S99528 38700000
APHOLD   EQU   *                                                 S22024 38790000
         TM    LUFLAGS,APLUNT     Q-IS AP AN LU                @XM05672 38800000
         BO    ON                 Y-BRANCH                     @XM05672 38810000
         MVI   TOTOVBCD,HOLDTERM       VERB TO HOLD TERMINAL     S22024 38830000
         B     HOLDREL                 GO HOLD                   S99528 38880000
INACTLST EQU   *                                                 S22024 38970000
         MVI   TOTOVBCD,INACTERM       VERB TO INACTIVATE        S22024 39010000
         B     INACACTI                GO INACTIVE               S99528 39060000
STOPAP   EQU   *                                                 S22024 39150000
         MVI   TOTOVBCD,LINESTOP       VERB TO STOP LINE         S22024 39190000
         B     STARSTOP                STOP                      S99528 39240000
APORGST  EQU   *                       AP ORGINAL STATUS         S99528 39330000
**   TEST FLAGS IN TOTAPDFL TO DETERMINE ORIGINAL STATUS OF      S99528 39420000
**   AP IF IT IS A TERMINAL-- RETURN TO ORGINAL STATUS           S99528 39510000
         L     R6,TOTARTNT             GET AP TNT ADDRESS      @YM08136 39516000
         SLR   R1,R1                   CLEAR REGISTER          @YM08136 39522000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM08136 39528000
         AR    R6,R1                   POINT TO TTE PREFIX     @YM08136 39534000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM08136 39540000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @YM08136 39546000
         SLR   R6,R1                   POINT TO TTE PREFIX     @YM08136 39552000
         USING IEDNTRM,R6              SET TTE PREFIX ADDRESS  @YM08136 39558000
         TM    TRMSTATE,TRMPREF        NCP RESOURCE            @YM08136 39564000
         BZ    APCHKE                  NO - CONTINUE           @YM08136 39570000
         CLI   TRMTYPE,TRMLUNT         SNA LU ENTRY            @YM08136 39576000
         BNE   APCHKE                  N-BYPASS FLAG SETTING   @XM05672 39582000
         OI    LUFLAGS,APLUNT          AP IS LUNT FLAG         @XM05672 39585000
APCHKE   EQU   *                                               @YM08136 39588000
         DROP  R6                                              @YM08136 39594000
         SR    R7,R7                   CLEAR REG                 S99528 39600000
         IC    R7,TOTAPRLN             GET RLN                   S99528 39690000
         STC   R7,TOTORLN              PUT IN P-LIST             S22024 39780000
         MVC   TOTOLADR(D8),TOTAPNAM   NAME TO P-LIST            S22024 39870000
         MVC   BSTOPNAM(EIGHT),TOTAPNAM MANE TO MSG              S99528 39960000
         TM    TOTAPDFL,TOTAPHD        INIT HELD                 S99528 40050000
         BO    APHOLD                  YES BR                    S99528 40140000
         MVI   TOTOVBCD,REALTERM       VERB TO REALEASE TERMINAL        40230000
HOLDREL  BAL   R12,ORIGTERM            OP CONTROL                S99528 40320000
         CLI   TOTORTCD,X00            OK                        S22024 40410000
         BE    ON                      OK BR                     S99528 40500000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 40590000
         BE    ON                      OK BR                     S99528 40680000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 40770000
ON       EQU   *                       CONTINUE                  S99528 40860000
         MVI   BSTOPNAM,X40            CLEAR OUT                 S22024 40890000
         MVC   BSTOPNAM+D1(D7),BSTOPNAM  NAME IN MSG             S22024 40920000
INACACTI EQU   *                                                 S22024 41170000
         MVC   TOTOLADR(D8),TOTAPNAM   NAME TO P-LIST            S22024 41220000
         MVC   BSTOPNAM(EIGHT),TOTAPNAM  NAME TO MSG             S99528 41310000
ON1      EQU   *                       CONTINUE                  S99528 41940000
         TM    TOTAPFLG,TOTAPORN       AP ON 3705                S22024 41970000
         BNO   LINEAP                  NO, BRANCH                S05331 42000000
         MVC   TRMSAVE(D2),TOTARSID    GET RESOURCE ID OF AP     S05331 42002000
         OI    RNFLAG,APFLAG           SET AP ON 3705 FLAG       S05331 42004000
         L     R9,TOTARTNT             AP TNT ADDRESS          @Y17XAUU 42004200
         SLR   R3,R3                   CLEAR REG               @Y17XAUU 42005000
         IC    R3,TOTTTBEL             GET NAME LENGTH         @Y17XAUU 42005200
         AR    R9,R3                   POINT TO TTE ADDRESS    @Y17XAUU 42005600
         MVC   TTEADDR+D1(D3),D0(R9)   ALLIGN ADDRESS          @Y17XAUU 42006300
         L     R9,TTEADDR              GET TTE ADDRESS         @Y17XAUU 42007000
         LA    R3,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 42007700
         SLR   R9,R3                   ADDRESS OF TTE PREFIX   @Y17XAUU 42008400
         USING IEDNTRM,R9              TTE ADDRESSABILITY      @XM05672 42008500
         NI    TRMBYTE1,XFF-TRMSTOTE   TURN OFF TOTE BIT       @XM05672 42008600
         DROP  R9                                              @XM05672 42008700
         BAL   R6,CHKTTE               GET AP LINE TTE ADDRESS @Y17XAUU 42009100
         NI    RNFLAG,XFF-APFLAG       TURN OFF AP FLAG          S05331 42010000
         TM    LUFLAGS,APLUNT     Q-IS AP AN LU                @XM05672 42010600
         BO    ON2                Y-BRANCH AROUND STARTLINE    @XM05672 42011200
         MVC   TOTOLADR(EIGHT),TOTAPRNL  MOVE AP GROUP NAME INTO S05331 42012000
*                                          OP CONTROL PARM LIST  S05331 42014000
         MVC   BSTOPNAM(EIGHT),TOTAPRNL  MOVE GROUP NAME INTO MSGS05331 42016000
         MVC   TOTORLN(1),TOTAPRLN     MOVE RLN INTO PARM LIST   S05331 42018000
         B     CKLINEAP                GO CHECK INITIAL STATUS   S05331 42020000
LINEAP   EQU   *                                                 S05331 42022000
         SR    R6,R6                   CLEAR                   @G36XRUV 42026000
         ICM   R6,THREE,TOTAPUCB       UCB ADDRESS             @G36XRUV 42030000
         USING UCB,R6                  UCB                       S99528 42120000
         MVC   TOTOLADR(D3),UCBNAME    UCB TO P-LIST             S22024 42210000
         MVC   BSTOPNAM(THREE),UCBNAME UCB TO MSG                S99528 42300000
         DROP  R6                      UCB                       S99528 42390000
CKLINEAP EQU   *                                                 S05331 42430000
         TM    TOTAPDFL,TOTAPLST       AP LINE INIT STOPPED      S22024 42480000
         BO    STOPAP                  YES BR                    S99528 42570000
         MVI   TOTOVBCD,LINESTRT       VERB TO START LINE        S22024 42660000
STARSTOP BAL   R12,ORIGTERM            OP CONTROL                S99528 42750000
         CLI   TOTORTCD,X00            OK                        S22024 42840000
         BE    ON2                     OK BR                     S99528 42930000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 43020000
         BE    ON2                     OK BR                     S99528 43110000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 43200000
ON2      EQU   *                       CONTINUE                  S99528 43290000
         MVC    RNAME(EIGHT),TOTAPNAM  DEQ AP TERM               S99528 43380000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 43470000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 43560000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 43650000
         SR    R5,R5                   CLEAR                   @G36XRUV 43690000
         ICM   R5,THREE,TOTAPUCB       GET AP UCB ADDRESS      @G36XRUV 43740000
         USING UCB,R5                  UCB ADDRESSIBILITY        S99528 43830000
         MVC   RNAME(3),UCBNAME        UCB NAME TO DEQ           S99528 43920000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 44010000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 44100000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 44190000
         TM    TOTAPFLG,TOTAPORN       AP ON A 3705              S22024 44280000
         BO    RNAPDQ                  YES BRANCH                S22024 44370000
CTSYSCO  EQU   *                       CONTROL TERMINAL TO ORG STS99528 44460000
         TM    TOTFLG09,TOTCTCON       CONTROL TERMINAL = SYSCON S99528 44550000
         BO    UNALLOCK                YES BRANCH                S22024 44640000
         L     R3,TOTCRTNT             SEE IF A REAL ENTRY       S22024 44660000
         LTR   R3,R3                   EXIST IF NOT              S22024 44680000
         BZ    UNALLOCK                BRANCH                    S22024 44700000
         L     R6,TOTCRTNT             GET CT TNT ADDRESS      @YM08136 44702000
         SLR   R1,R1                   CLEAR REGISTER          @YM08136 44704000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM08136 44706000
         AR    R6,R1                   POINT TO TTE ADDRESS    @YM08136 44708000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM08136 44710000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @YM08136 44712000
         SLR   R6,R1                   POINT TO TTE PREFIX     @YM08136 44714000
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @YM08136 44716000
         TM    TRMSTATE,TRMPREF        NCP RESOURCE            @YM08136 44718000
         BZ    CTCKE                   NO - CONTINUE           @YM08136 44720000
         CLI   TRMTYPE,TRMLUNT         SNA LU ENTRY            @YM08136 44722000
         BNE   CTCKE                   N-BYPASS FLAG SETIING   @XM05672 44724000
         OI    LUFLAGS,CTLUNT          CONTROL TERM IS LU      @XM05672 44725000
         DROP  R6                                              @YM08136 44726000
CTCKE    EQU   *                                               @YM08136 44728000
*   RETURN CONTROL TO ORGINAL STATUS                             S99528 44730000
         LA    R1,TOTCTNAM             POINT TO TERM NAME        S99528 44820000
         SR    R3,R3                   CLEAR REG                 S99528 44910000
LOP      CLI   0(R1),X'61'             SLASH                     S99528 45000000
         BE    MOVE                    YES BR                    S99528 45090000
         LA    R3,1(R3)                BUMP CNTER                S99528 45180000
         LA    R1,1(R1)                BUMP CNTER                S99528 45270000
         B     LOP                     TRY AGAINM                S99528 45360000
RNAPDQ   EQU   *                                                 S22024 45450000
         L    R9,TOTARTNT              GET ALT PRT TNT ADDRESS   S22024 45540000
         BAL   R12,TERMRNDQ            GO DEQ LINE FOR AP        S22024 45630000
         B     CTSYSCO                 CHECK CONTROL TERM        S22024 45720000
CTHOLD   EQU   *                                                 S22024 45810000
         TM    LUFLAGS,CTLUNT          Q-IS CTL TERM LUNT      @XM05672 45820000
         BO    ON3                     Y-ALREADY HELD          @XM05672 45830000
         MVI   TOTOVBCD,HOLDTERM       HOLD TERMINAL             S22024 45850000
         B     RELHOLD                 GO HOLD                   S99528 45900000
LSTINACT EQU   *                                                 S22024 45990000
         MVI   TOTOVBCD,INACTERM       INACTIVATE TERM           S22024 46030000
         B     ACTIINAC                GO INACTIVE               S99528 46080000
STOPCT   EQU   *                                                 S22024 46170000
         MVI   TOTOVBCD,LINESTOP       STOP LINE                 S22024 46210000
         B     STOPSTAR                STOP                      S99528 46260000
RNCTDQ   EQU   *                                                 S22024 46350000
         L     R9,TOTCRTNT             GET CT TNT ADDRESS        S22024 46440000
         BAL   R12,TERMRNDQ            GO DEQ TERM - LINE        S22024 46530000
         B     APDQRT                  CONTINUE                  S22024 46620000
MOVE     EQU   *                                               @YM08136 46640000
         SLR   R3,R3                   CLEAR REGISTER          @YM08136 46660000
         IC    R3,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM08136 46680000
         BCTR  R3,0                    DECREMENT FOR EX        @YM08136 46710000
         L     R1,TOTCRTNT             GET CT TNT ADDRESSAME   @YM08136 46800000
         EX    R3,CTNAME               GO MOCE NAME              S99528 46890000
         MVC   TOTCTNAM(EIGHT),RNAME   CT NAME SAVE              S99528 46980000
         MVC   TOTOLADR(EIGHT),TOTCTNAM  MOVE CT NAME INTO P-LISTS05331 47020000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 47070000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 47160000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 47250000
         SR    R5,R5                   CLEAR                   @G36XRUV 47290000
         ICM   R5,THREE,TOTCTUCB       GET CT UCB ADDRESS      @G36XRUV 47340000
         USING UCB,R5                  UCB ADDRESSIBILITY        S99528 47430000
         MVC   RNAME(3),UCBNAME        UCB NAME TO DEQ           S99528 47520000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 47610000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 47700000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 47790000
         DROP  R5                                                S99528 47880000
         TM    TOTCTFLG,TOTCTORN       CT ON A 3705              S22024 47970000
         BO    RNCTDQ                  YES BRANCH                S22024 48060000
APDQRT   EQU   *                                                 S22024 48150000
         SR    R7,R7                   CLEAR REG                 S22024 48240000
         IC    R7,TOTCTRLN             GET RLN                   S99528 48330000
         STC   R7,TOTORLN              RLN TO P-LIST             S22024 48420000
         MVC   BSTOPNAM(EIGHT),TOTCTNAM MANE TO MSG              S99528 48600000
         TM    TOTCTDFL,TOTAPHD        INIT HELD                 S99528 48690000
         BO    CTHOLD                  YES BR                    S99528 48780000
         MVI   TOTOVBCD,REALTERM       REALEASE TERMINAL         S22024 48870000
RELHOLD  BAL   R12,ORIGTERM            OP CONTROL                S99528 48960000
         CLI   TOTORTCD,X00            OK                        S22024 49050000
         BE    ON3                     OK BR                     S99528 49140000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 49230000
         BE    ON3                     OK BR                     S99528 49320000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 49410000
ON3      EQU   *                       CONTINUE                  S99528 49500000
         MVI   BSTOPNAM,X40            CLEAR OUT                 S22024 49530000
         MVC   BSTOPNAM+D1(D7),BSTOPNAM  NAME IN MSG             S22024 49560000
ACTIINAC EQU   *                                                 S22024 49810000
         MVC   TOTOLADR(D8),TOTCTNAM   NAME TO P-LIST            S22024 49860000
         MVC   BSTOPNAM(EIGHT),TOTCTNAM  NAME TO MSG             S99528 49950000
ON4      EQU   *                       CONTINUE                  S99528 50580000
         MVI   BSTOPNAM,X40            CLEAR OUT                 S22024 50590000
         MVC   BSTOPNAM+D1(D7),BSTOPNAM  NAME IN MSG             S22024 50600000
         TM    TOTCTFLG,TOTCTORN       CT ON 3705                S22024 50610000
         BNO   LINECT                  NO, BRANCH                S05331 50620000
         MVC   TRMSAVE(D2),TOTCRSID    GET RESOURCE ID OF CT     S05331 50624000
         OI    RNFLAG,CTFLAG           SET CT ON 3705 FLAG       S05331 50628000
         L     R9,TOTCRTNT             CT TNT ADDRESS          @Y17XAUU 50628400
         SLR   R3,R3                   CLEAR REG               @Y17XAUU 50630000
         IC    R3,TOTTTBEL             GET NAME LENGTH         @Y17XAUU 50630400
         AR    R9,R3                   POINT TO TTE ADDRESS    @Y17XAUU 50631200
         MVC   TTEADDR+D1(D3),D0(R9)   ALLIGN ADDRESS          @Y17XAUU 50632200
         L     R9,TTEADDR              GET TTE ADDRESS         @Y17XAUU 50633200
         LA    R3,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 50634200
         SLR   R9,R3                   POINT TO TTE PREFIX     @Y17XAUU 50635200
         USING IEDNTRM,R9              TTE ADDRESSABILITY      @XM05672 50635400
         NI    TRMBYTE1,XFF-TRMSTOTE   TURN OFF TOTE BIT       @XM05672 50635600
         DROP  R9                                              @XM05672 50635800
         BAL   R6,CHKTTE               GET CT LINE TTE ADDRESS @Y17XAUU 50636200
         NI    RNFLAG,XFF-CTFLAG       TURN OFF CT FLAG          S05331 50640000
         TM    LUFLAGS,CTLUNT           Q-IS CTL TERM LUNT     @XM05672 50641000
         BO    ON5                      Y-LINE ALREADY STARTED @XM05672 50642000
         MVC   TOTOLADR(EIGHT),TOTCTRNL  MOVE CT GROUP NAME INTO S05331 50644000
*                                          OP CONTROL PARM LIST  S05331 50648000
         MVC   BSTOPNAM(EIGHT),TOTCTRNL  MOVE GROUP NAME INTO MSGS05331 50652000
         MVC   TOTORLN(1),TOTCTRLN     MOVE RLN INTO PARM LIST   S05331 50656000
         B     CKLINECT                GO CHECK LINE STATUS      S05331 50660000
LINECT   EQU   *                                                 S05331 50664000
         SR    R6,R6                   CLEAR                   @G36XRUV 50667000
         ICM   R6,THREE,TOTCTUCB       UCB ADDRESS             @G36XRUV 50670000
         USING UCB,R6                  UCB                       S99528 50760000
         MVC   TOTOLADR(D3),UCBNAME    UCB TO P-LIST             S22024 50850000
         MVC   BSTOPNAM(THREE),UCBNAME UCB TO MSG                S99528 50940000
         DROP  R6                      UCB                       S99528 51030000
CKLINECT EQU   *                                                 S05331 51070000
         TM    TOTCTDFL,TOTCTLST       LINE INITALLY STOPPED     S22024 51120000
         BO    STOPCT                  YES BR                    S99528 51210000
         MVI   TOTOVBCD,LINESTRT       START LINE                S22024 51300000
STOPSTAR BAL   R12,ORIGTERM            OP CONTROL                S99528 51390000
         CLI   TOTORTCD,X00            OK                        S22024 51480000
         BE    ON5                     OK BR                     S99528 51570000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 51660000
         BE    ON5                     OK BR                     S99528 51750000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 51840000
ON5      EQU   *                       CONTINUE                  S99528 51930000
         B     UNALLOCK                BRANCH                    S22024 52020000
ORIGTERM EQU   *                                               @SA74550 52110058
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 52120000
         LA    R1,TOTOTECB              GET THE TOTE ECB ADDR  @SA74550 52130058
         ST    R1,TOTOECBA              PUT IN PARM LIST       @SA74550 52150058
         LA    R1,CBSLPL                GET PARM LIST ADDR     @SA74550 52170058
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 52200000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 S99528 52290000
         AQCTL                         POST ELEMENT              S99528 52380000
         WAIT  ECB=TOTOTECB            WAIT FOR COMLLEATION      S99528 52470000
         MVI   TOTOLADR,C' '           CLEAR NAME                S22024 52560000
         MVC   TOTOLADR+D1(D7),TOTOLADR IN P-LIST                S22024 52650000
         BR    R12                     RETURN                    S99528 52740000
RETURN4  EQU   *                                                        52830000
*                                                                       52920000
*        RETURN TO RESIDENT MODULE                                      53010000
*                                                                       53100000
         MVC   QNAME,QNAMEE            MAJOR TO LIST             S22024 53100100
         MVC   RNAME(8),RNAMEE         MINOR TO LIST             S22024 53100200
         DEQ   ,MF=(E,DEQLIST)         CONFIG LIBS               S22024 53100300
         SPACE 2                                                        53100500
RETURN3  EQU   *                                                 S22024 53108400
         TM    TOTFLG02,TOTCONCU       CONC CLEANUP REQUIRED     S22024 53110000
         BZ    RETURN                  NO BRANCH                 S22024 53120000
         L     R14,12(R13)             GET RETURN ADDRESS        S22024 53130000
         XCTL  (2,12),EP=IEDQWEC       GO TO CONC CLEANUP MODULE S22024 53140000
RETURN   EQU   *                                                 S22024 53150000
         L     R13,4(R13)              RESTORE SAVE POINTER      S99528 53190000
         LM    R14,R12,12(R13)         RESTORE REGS              S99528 53280000
         SR    R15,R15            SET GOOD RETURN CODE                  53370000
         BR    R14                     RETERN TO IEDQWA          S99528 53460000
*                                      THIS ROUTINE INSURES THAT S22024 53463000
*                                      ALL UCB UNALLOCATE BITS   S22024 53466000
*                                      ARE TURNED OFF            S22024 53469000
UNALLOCK EQU   *                                                 S22024 53472000
*        INSURE TOTE DOESNOT LEAVE THE CONTROL TERM OR ALT       S22024 53472100
*        PRINTER LISE RESORRCE ASSIGNED TO TOTE                  S22024 53472200
         TM    TOTCTFLG,TOTCTORN       CT ON RN                  S22024 53472300
         BO    CTSTOTE                 YES BRANCH                S22024 53472400
         L     R6,TOTCTRLN             GET LCB ADDRESS           S22024 53472500
         LTR   R6,R6                   IS THTER ONE              S22024 53472600
         BZ    APCHECK                 NO BRANCK                 S22024 53472700
         USING IEDQLCB,R6              LCB                       S22024 53472800
         CLI   LCBCPA,XF1              TOTE OWN RESOURCE         S22024 53472900
         BNE   APCHECK                 NO BRANCH                 S22024 53473000
         MVI   LCBCPA,X00              GIVE RESIURCE TO TCAM     S22024 53473100
APCHECK  EQU   *                                                 S22024 53473200
         TM    TOTAPFLG,TOTAPORN       AP ON RN                  S22024 53473300
         BO    APSTOTE                 YES BRANCH                S22024 53473400
         L     R6,TOTAPRLN             GET AP LCB ADDRESS        S22024 53473500
         LTR   R6,R6                   IS THTER ONE              S22024 53473600
         BZ    UNALLBIT                NO BRANCH                 S22024 53473700
         CLI   LCBCPA,XF1              TOE OWN RESOURCE          S22024 53473800
         BNE   UNALLBIT                NO BRANCH                 S22024 53473900
         MVI   LCBCPA,X00              GIVE RESOURCE TO TCAM     S22024 53474000
UNALLBIT EQU   *                                                 S22024 53474100
         DROP  R6                      LCB                       S22024 53474200
         TM    TOTTDTBL,TOTTDLIN       TEST DEV A LINE           S22024 53475000
         BZ    RETURN4                 NO BRANCH                 S22024 53478000
         TM    TOTTDTBL,TOTTDORN       TEST DEV ON RN            S22024 53481000
         BO    RETURN4                 YES BRANCH                S22024 53484000
         LA    R3,TOTTDTBL             TEST DEV TABLE ADDR       S22024 53487000
         LA    R5,TOTTDEND             END ADDRESS               S22024 53490000
UNALLALL EQU   *                                                 S22024 53493000
         CR    R3,R5                   ALL ENTRIES PROCESSED     S22024 53496000
         BE    RETURN4                 YES BRANCH                S22024 53499000
         L     R8,D0(R3)               GET UCB ADDRESS           S22024 53502000
         LA    R8,D0(R8)               CLEAR HIGH BYTE           S22024 53505000
         LTR   R8,R8                   ENTRY ZERO                S22024 53508000
         BZ    RETURN4                 YES BRANCH                S22024 53511000
         TM    D0(R8),UCBNALBT         UCB UNALLOCATE BIT ON     S22024 53514000
         BZ    BMPUNLL                 NO BRANCH                 S22024 53517000
         MVC   UCBWORK(D4),D0(R8)      MOVE UCB TO WORK AREA     S22024 53520000
         NI    UCBWORK+D1,UCBNALOF     TURN OFF UNALLOCATE BIT   S22024 53523000
         ST    R8,TOT102A              TARGET ADDRESS TO P LIST  S22024 53526000
         LA    R1,TOT102               POINT TO P LIST           S22024 53529000
         AQCTL                         MOVE DATA                 S22024 53532000
BMPUNLL  EQU   *                                                 S22024 53535000
         LA    R3,D4(R3)               DUMP TEST DEV PTR         S22024 53538000
         B     UNALLALL                CONTINUE THRU TABLE       S22024 53541000
         EJECT                                                          53550000
         IEDQMSG LINK=YES,PREG0=R0                                      53640000
*                                                                     * 53730000
*        CONTROL TERMINAL AND ALTERNATE PRINTER ORIGINAL STATUS       * 53820000
*                                                                     * 53910000
STCTAP   EQU   *                       START CONTROL TERM AND AP S99528 54000000
         MVI   TOTOVBCD,LINESTRT       VERB TO START LINE        S22024 54090000
         L     R1,TOTAVTPT             GET AVT POINTER   DE      S99528 54180000
         USING IEDQAVTD,R1             AVT ADDRESSIBILITY        S99528 54270000
         LA    R1,AVTOPCOB             GET OP CONTROL QCB        S99528 54360000
         ST    R1,TOTOKEY              PUT IN P-LIST             S22024 54450000
         DROP  R1                                                       54540000
         SR    R1,R1                   CLEAR                   @G36XRUV 54580000
         ICM   R1,THREE,TOTCTUCB       GET UCB ADDRESS         @G36XRUV 54630000
         TM    APSTIME,APSTIMER        STIM FOR AP               S99528 54720000
         BZ    STARTUCB                NO BRANCH                 S99528 54810000
         SR    R1,R1                   CLEAR                   @G36XRUV 54850000
         ICM   R1,THREE,TOTAPUCB       GET AP UCB              @G36XRUV 54900000
         USING UCB,R1                  UCB ADDRESSIBILITY        S99528 54990000
STARTUCB EQU   *                                                 S99528 55080000
         LTR   R1,R1              IS A VALID UCB ADDRESS PRESENT?S99528 55170000
         BZ    0(R12)             NO, RETURN                     S99528 55260000
         MVC   TOTOLADR(D3),UCBNAME    PUT UCB INTO P-LIST       S22024 55350000
         DROP  R1                                                S99528 55440000
         SR    R1,R1                   CLEAR REG                 S99528 55530000
         IC    R1,TOTCTRLN             GET RLN                   S99528 55620000
         TM    APSTIME,APSTIMER        STIMER FOR AP             S99528 55710000
         BZ    STARTRLN                NO BRANCH                 S99528 55800000
         IC    R1,TOTAPRLN             GET AP RLN                S99528 55890000
STARTRLN EQU   *                                                 S22024 55980000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 56000000
         STC   R1,TOTORLN              RLN TO P-LIST             S22024 56020000
         LA    R1,TOTOTECB             GET ECB ADDRESS           S99528 56070000
         ST    R1,TOTOECBA             PUT IN P-LIST             S22024 56160000
         LA    R1,CBSLPL               SVC 102 P-LIST            S22024 56250000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 56340000
         XC    TOTOTECB(4),TOTOTECB    CLEAR ECB                 S99528 56430000
         AQCTL                         GO TO OP CONTOOL          S99528 56520000
         WAIT  ECB=TOTOTECB            WAIT FOR START LINE       S99528 56610000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 56700000
         MVC   TOTOLADR+D1(D7),TOTOLADR NAME IN P-LIST           S22024 56790000
         B     0(R12)                  RETURN                    S99528 56880000
CTSTOTE  EQU   *                                                 S22024 56886000
         L     R8,TOTCRTNT             GET TNT ADDRESS           S22024 56892000
         BAL   R7,TNTALINE             GO ALLINE ADDRESS         S22024 56898000
         L     R6,TTEADDR              GET TTE ADDRESS           S22024 56904000
         LA    R7,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 56904200
         SLR   R6,R7                   ADDRESS OF TTE PREFIX   @Y17XAUU 56904400
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @Y17XAUU 56904600
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56904800
         L     R6,CTLTTE               GET CONTROL TERMINAL LINE S05331 56917000
*                                        TTE ADDRESS             S05331 56918000
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56919000
         B     APCHECK                 BRANCH                    S22024 56922000
APSTOTE  EQU   *                                                 S22024 56928000
         L     R8,TOTARTNT             GET TNT ADDRESS           S22024 56934000
         BAL   R7,TNTALINE             ALLINT TTE ADDRESS        S22024 56940000
         L     R6,TTEADDR              GET AP TTE ADDRESS        S22024 56946000
         LA    R7,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 56946600
         SLR   R6,R7                   POINT TO TTE PREFIX     @Y17XAUU 56947200
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56952000
         L     R6,APLTTE               GET ADDRESS OF AP LINE TTES05331 56954000
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56956000
         B     UNALLBIT                BRANCH                    S22024 56958000
         DROP  R6                      TTE                       S22024 56964000
         EJECT                                                          56970000
*                                                                       57060000
*        START LINE ROUTINE                                             57150000
*                                                                       57240000
LISTART  EQU   *                                                 S22024 57330000
         MVI   TOTOVBCD,LINESTRT       VERB CODE TO START LINE   S22024 57370000
         TM    INITSTAT,TOTTDORN       TEST LIEN ON RN           S22024 57420000
         BO    LINERNST                YES BRANCH                S22024 57510000
         MVC   TOTOLADR(D3),D13(R8)    NAME TO REQ ELE           S22024 57600000
         MVC   BSTOPNAM(3),13(R8)      UCB NAME TO MSG           S99528 57690000
         L     R1,TOTAVTPT             GET AVT ADDRESS           S99528 57780000
         USING IEDQAVTD,R1             AVT ADDRESSIBILITY        S99528 57870000
         LA    R10,AVTOPCOB            GET OPERATOR CONTROL QCB  S99528 57960000
         ST    R10,TOTOKEY             PUT IN P-LIST             S22024 58050000
         L     R1,AVTTCB               GET TCAM TCB ADDRESS      S99528 58140000
         DROP  R1                      REALEASE R1               S99528 58230000
         L     R1,8(R1)                GET DEB CHAIN ADDRESS     S99528 58320000
STLINE01 EQU   *                                                 S99528 58410000
         LA    R1,0(R1)                CLEAR HIGH BYTE           S99528 58500000
         LTR   R1,R1                   ZERO                      S99528 58590000
         BZ    ERROR                   YES BRANCH                S99528 58680000
         SR    R10,R10                 CLEAR LOOP COUNTER AND    S99528 58770000
         IC    R10,16(R1)              INITIALIZE IT TO NUMBER EXS99528 58860000
         LA    R5,32(R1)               GET UCB CHAIN ADDRESS     S99528 58950000
         L     R11,4(R1)               GET NEXT BEB ADDRESS      S99528 59040000
         L     R9,24(R1)               GET DCB ADDRESS           S99528 59130000
         USING IHADCB,R9               DCB ADDRESSIBILITY        S99528 59220000
         TM    DCBDSORG+D1,X44         TCAM DEB                  S22024 59310000
         BZ    STLIN024                NO GET NEXT DEB           S99528 59400000
         LA    R7,1                    INITIALIZE RLN COUNTER           59490000
STLINE02 EQU   *                                                 S99528 59580000
         L     R6,0(R5)                GET UCB ADDDRESS          S99528 59670000
         LA    R6,0(R6)                FOR COMPARE               S99528 59760000
         LA    R8,0(R8)                CLEAR HIGH BYTE           S99528 59850000
         CR    R8,R6                   CORRECT UCB FOUND         S99528 59940000
         BE    STLINE03                YES BRANCH                S99528 60030000
         LA    R5,4(R5)                GET NEXT UCB ADDRESS      S99528 60120000
         LA    R7,1(R7)                BUMP RLN                  S99528 60210000
         BCT   R10,STLINE02            LOOP TILL END OF UCB CH   S99528 60300000
STLIN024 EQU   *                                                 S99528 60390000
         LR    R1,R11                  POINT R1 TO NEXT DEB      S99528 60480000
         B     STLINE01                GET NEXT UCB CHAIN        S99528 60570000
ERROR    EQU   *                                                 S99528 60660000
         OI    TOTFLG06,TOTCANCL+TOTOTERM CANCEL TRM             S99528 60750000
**********     TEST DEVICE DOES NOT BELONG TO TCAM      *********S99528 60840000
         IEDQMSG MSGID=045,PREG0=R0,PREG1=R1,FUNCT=CEC,          S99528C60930000
               RET=TCNT179                                       S99528 61020000
STLINE03 EQU   *                                                 S99528 61110000
         SR    R10,R10                 CLEAR REG                 S99528 61200000
         IC    R10,DCBEXLST            GET LCB LENGTH            S99528 61290000
         LR    R11,R7                  GET RLN                   S99528 61380000
         MR    R10,R10                 RLN TIMES LCB LENGTH      S99528 61470000
         L     R10,DCBIOBAD            GET DUMMY IOB ADDRESS     S99528 61560000
         LA    R10,0(R10,R11)          GET IOB ADDRESS           S99528 61650000
         LA    R11,LCBFLAG1-IEDQLCB    GET OFFSET TO LCB START   S99528 61740000
         SR    R10,R11                 SUBTRACT FROM IOB ADDR    S99528 61830000
         USING IEDQLCB,R10             LCB ADDRESSABILITY        S99528 61920000
         MVI   LCBCPA,X'00'            CLEAR TOTE INDICATOR      S99528 62010000
         MVC   NCPTTCIN(D2),LCBTTCIN   SAVE NCP TTCIN OFFSET   @OY20578 62040086
*                                      FOR 3705 TEST           @OY20578 62070086
         USING UCBOB,R6                UCB                       S22024 62100000
         MVC   X3705(D1),UCBTBYT4      CONTROL UNIT TYPE         S22024 62190000
         NI    X3705,X0F               CLEAR UNWANTED BITS       S22024 62280000
         CLI   X3705,RNUCBTST          IS CONTROL UNIT 3705      S22024 62370000
         DROP  R6                      UCB                       S22024 62460000
         BNE   NO3705                  NO BRANCH                 S22024 62550000
         TM    INITSTAT,TOTTNIPL       IS IPL REQUIRED FOR 3705? S05331 62580000
         BO    CLEARNM                 NO, BYPASS IPL            S05331 62610000
         MVI   TOTOVBCD,IPL3705        IPL VERB                  S22024 62640000
         B     IPL37RN                 BRANCH                    S22024 62730000
NO3705   EQU   *                                                 S22024 62820000
         TM    INITSTAT,TOTTDLST       LINE ORIG STARTED         S22024 62910000
         BO    CLEARNM                 NO BRANCH                 S22024 63000000
         DROP  R9                                                S99528 63090000
         DROP  R10                                               S99528 63180000
IPL37RN  EQU   *                                                 S22024 63270000
         STC   R7,TOTORLN              RLN TO REQ ELE            S22024 63360000
RNLINRT  EQU   *                                                 S22024 63450000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 63490000
         LA    R1,TOTOTECB             GET TOTE ECB              S99528 63540000
         ST    R1,TOTOECBA             PUT IN P-LIST             S22024 63630000
         LA    R1,CBSLPL               POINT R1 TO P-LIST        S99528 63720000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 63810000
         XC    TOTOTECB(4),TOTOTECB    CLEAR TOTE ECB            S99528 63900000
         AQCTL                         POST ELEMENT TO OP CONTROLS99528 63990000
         WAIT  ECB=TOTOTECB            WAIT FOR COMPLETION       S99528 64080000
         CLI   X3705,RNUCBTST          3705 TEST                 S22024 64170000
         BNE   CLEARNM                 NO BRANCH                 S22024 64260000
         MVI   X3705,ZEROZ             CLEAR CONTROL TYPE        S22024 64350000
         MVI   TOTOVBCD,ACT3705        VERB TO ACTIVATE          S22024 64440000
*                                      3705                      S22024 64530000
         B     NO3705                  BRANCH                    S22024 64620000
CLEARNME EQU   *                                                 S22024 64630000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 64640000
         MVC   TOTOLADR+D1(D7),TOTOLADR  NAME                    S22024 64650000
         BR    R12                     RETURN                    S22024 64660000
CLEARNM  EQU   *                                                 S22024 64710000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 64770000
         MVC   TOTOLADR+D1(D7),TOTOLADR  NAME                    S22024 64830000
LINERNST EQU   *                       STOP LINE FOR RN TEST     S22024 64890000
*                                      DEVICES                   S22024 64980000
         TM    INITSTAT,TOTTDLIN+TOTTDORN TEST DEVICE 3705 LINE  S22024 65070000
         BO    SRTRNLIN                YES BRANCH                S22024 65160000
         SLR   R1,R1                   CLEAR PARM REG          @OY20578 65166086
         ICM   R1,HALFWORD,NCPTTCIN    GET NCP TTCIN           @OY20578 65172086
         L     R15,TOTAVTPT            GET AVT ADDRESS         @OY20578 65178086
         USING IEDQAVTD,R15            SET AVT ADDRESSSABILITY @OY20578 65184086
         L     R15,AVTRNMPT            ADDRESS OF TNT CODE     @OY20578 65190086
         DROP  R15                                             @OY20578 65196086
         BALR  R14,R15                 GET TTE ADDRESS         @OY20578 65202086
*        TTE ADDRESS IS RETURN IN REGISTER 1                   @OY20578 65208086
         LA    R15,TRMPRFSZ            TTE PREFIX SIZE         @OY20578 65214086
         SLR   R1,R15                  POINT TO TTE PREFIX     @OY20578 65220086
         USING IEDNTRM,R1              ADDR TO NEG PREFIX      @OY20578 65226086
         NI    TRMBYTE1,X'FF'-TRMSTOTE TURN OFF TOTE FLAG      @OY20578 65232086
         DROP  R1                                              @OY20578 65238086
         B     0(R12)                  RETURN                    S99528 65250000
*                                      TEST DEVICE IS A LINE     S22024 65340000
*                                      TEST ON A 3705            S22024 65430000
RNAMEPLT MVC   TOTOLADR(D0),D0(R8)     NAME TO P-LIST            S22024 65520000
RNAMEMSG MVC   BSTOPNAM(0),0(R8)       NAME TO MESSAGE           S22024 65610000
SRTRNLIN EQU   *                                                 S22024 65700000
         SR    R1,R1                   CLEAR REG                 S22024 65790000
         IC    R1,TOTTTBEL             GET NAME LENGTH           S22024 65880000
         BCTR  R1,D0                   DECREMENT FOR EX          S22024 65970000
         EX    R1,RNAMEMSG             LINE NAME TO MESSAGE      S22024 66150000
         L     R7,TOTAVTPT             GET AVT ADDRESS           S22024 66240000
         USING IEDQAVTD,R7             AVT                       S22024 66330000
         LA    R7,AVTOPCOB             GET ADDR OF OP CONTROL QCBS22024 66420000
         ST    R7,TOTOKEY              PUT IN P-LIST             S22024 66510000
         DROP  R7                      AVT                       S22024 66600000
         BAL   R7,TNTALINE             GET QCB ADDRESS           S22024 66690000
         SR    R7,R8                   CLEAR REG                 S22024 66780000
         USING IEDQQCB,R6              QCB                       S22024 66870000
         IC    R7,QCBRELLN             GET RLN FOR LINE          S22024 66960000
         STC   R7,TOTORLN              RLN TO P-LIST             S22024 67050000
         L     R7,QCBLGBAD-D1          GET LGB ADDRESS           S22024 67060000
         USING IEDNLGB,R7              LGB                       S22024 67070000
         MVC   TOTOLADR(D8),LGBNAME    GROUP NAME TO ELE         S22024 67080000
         DROP  R7                      LGB                       S22024 67090000
         L     R7,TTEADDR              GET TTE ADDRESS           S22024 67140000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 67230000
         SR    R7,R1                   POINT TO TTE PREFIX     @Y17XAUU 67320000
         USING IEDNTRM,R7              TTE                       S22024 67410000
         NI    TRMBYTE1,X'FF'-TRMSTOTE RESET TOTE FLAG         @Y17XAUU 67500000
         DROP  R7                      TTE                       S22024 67590000
         TM    INITSTAT,TOTTDLST       LINE ORIG ATARTED         S22024 67680000
         BO    CLEARNME                NO BRANCH                 S22024 67770000
         OI    INITSTAT,TOTTDLST       SET ORIG STOPPED          S22024 67810000
         B     RNLINRT                 GO START LINE             S22024 67860000
STARTERM EQU   *                                                 S99528 67950000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM      67990000
         BAL   R7,TNTALINE             GET QCB ADDRESS           S99528 68040000
         USING IEDQQCB,R6                                        S99528 68130000
         SR    R7,R7                   CLEAR REG                 S99528 68220000
         IC    R7,QCBRELLN             GET RLN                   S99528 68310000
         DROP  R6                                              @Y17XAUU 68350000
         STC   R7,TOTORLN              PUT IN P-LIST             S22024 68400000
         BCTR  R10,0                   DECREMENT FOR EX          S99528 68490000
         EX    R10,SYMMOVE             GO MAVE SYMBLLIC NAME     S99528 68580000
         EX    R10,MSGMOVE             MOVE NAME TO MSG          S99528 68670000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 68760000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 S99528 68850000
         LA    R1,TOTOTECB             GET ECB ADDRESS           S99528 68940000
         ST    R1,TOTOECBA             PUT IN P-LIST             S22024 69030000
         L     R1,TOTAVTPT             GET AVT ADDRESS           S99528 69120000
         USING IEDQAVTD,R1             AVT ADDRESSIBILITY        S99528 69210000
         LA    R1,AVTOPCOB             GET OP CONTROL QCB        S99528 69300000
         DROP  R1                                                S99528 69390000
         ST    R1,TOTOKEY              PUT IN P-LIST             S22024 69480000
         LA    R1,CBSLPL               GET P-LIST ADDR           S99528 69570000
         AQCTL                         POST ELEMENT TO OP CONRROLS99528 69660000
         WAIT  ECB=TOTOTECB            WAIT FOR COMPLEATION      S99528 69750000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 69840000
         MVC   TOTOLADR+D1(D7),TOTOLADR                                 69900000
         MVC   TOTOLADR+D1(D7),TOTOLADR  NAME                    S22024 69960000
         B     0(R12)                  RETURN                    S99528 70020000
SYMMOVE  MVC   TOTOLADR(D0),D0(R8)     SYMBOLIC NAME TO P-LIST   S22024 70110000
MSGMOVE  MVC   BSTOPNAM(0),0(R8)       NAME TO MSG               S99528 70200000
         EJECT                                                          70920000
*********************************************************************** 71010000
*********************************************************************** 71100000
*                                                                     * 71190000
*       FIND UCB ROUTINE FOR TNT ENTRIES                              * 71280000
*                                                                     * 71370000
*********************************************************************** 71460000
*********************************************************************** 71550000
UCBFIND  EQU   *                                                 S99528 71640000
         ST    R5,UCB5SAVE             SAVE REG                         71730000
         ST    R3,UCB3SAVE             SAVE REG                  S99528 71820000
         SR    R5,R5                   CLEZA REG                 S99528 71910000
         IC    R5,TOTTTBEL             GET TERMINAL NAME LENGTH  S99528 72000000
         AR    R5,R8                   GET TTE ADDRESS           S99528 72090000
         MVC   TTEADDR+1(3),0(R5)      ALLINE ADDRESS            S99528 72180000
         L     R8,TTEADDR              GET TTE ADDR              S99528 72270000
         USING IEDQTRM,R8                                        S99528 72360000
         L     R8,TRMDESTQ-1           GET QCB ADDR              S99528 72450000
         DROP  R8                                                S99528 72540000
         USING IEDQQCB,R8                                        S99528 72630000
         TM    INITSTAT,TOTTDORN       TEST DEVICE ON RN         S22024 72640000
         BZ    TDNRN1                  NO BRANCH                 S22024 72650000
         LA    R3,D4                   FOURCE RLN TO ONE         S22024 72660000
         B     TDNRN2                  BRANCH                    S22024 72670000
TDNRN1   EQU   *                                                 S22024 72680000
         SR    R3,R3                   CLEAR REG                 S99528 72720000
         IC    R3,QCBRELLN             GET RLN                   S99528 72810000
         SLL   R3,2                    MULT BY 4                 S99528 72900000
TDNRN2   EQU   *                                                 S22024 72940000
         L     R8,QCBDCBAD-1           GET DCB ADDR              S99528 72990000
         DROP  R8                                                S99528 73080000
         USING IHADCB,R8                                         S99528 73170000
         TM    DCBDSORG,X80            DCB OR LGB                S22024 73260000
         BZ    GETDEB                  BRANCH IF DCB             S22024 73350000
         L     R1,TTEADDR              GET TTE ADDRESS         @Y17XAUU 73350500
         BAL   R14,NCPTTE              GET NCP TTE ADDRESS     @Y17XAUU 73351000
*                                                              @Y17XAUU 73351500
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 73352000
*                                                              @Y17XAUU 73352500
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 73353000
         L     R1,TRMDESTQ-D1          GET QCB ADDRESS         @Y17XAUU 73353500
         DROP  R1                                              @Y17XAUU 73354000
         USING IEDQQCB,R1              SET QCB ADDRESSABILITY  @Y17XAUU 73354500
         L     R8,QCBDCBAD-D1          GET 3705 DCB ADDRESS    @Y17XAUU 73355000
         DROP  R1                                              @Y17XAUU 73355500
GETDEB   EQU   *                       GET DEB ADDRESS           S22024 73890000
         L     R8,DCBDEBAD             GET DEB ADDR              S99528 73980000
         DROP  R8                                                S99528 74070000
         USING DEBNMSUB,R8                                       S99528 74160000
         SR    R15,R15                 CLEAR REG                 S99528 74250000
         IC    R15,DEBNMEXT            GET # OF EXTENTS          S99528 74340000
         SLL   R15,2                   MULT BY 4                 S99528 74430000
         L     R8,DEBUCBAD-4(R3)       GET UCB ADDR              S99528 74520000
         L     R5,UCB5SAVE             RETURN REG                       74610000
         L     R3,UCB3SAVE             RESTORE REG               S99528 74700000
         B     0(R12)                  BRANCH RETURN             S99528 74790000
*                                                                     * 74880000
*              ALLINE TNT ADDRESS                                     * 74970000
*                                                                     * 75060000
TNTALINE EQU   *                       FIND QCB                  S99528 75150000
         LR    R9,R8                   SAVE TNT POINTER          S99528 75240000
         SR    R10,R10                 CLEAR REG                 S99528 75330000
         IC    R10,TOTTTBEL            GET NAME LENGTH           S99528 75420000
         AR    R9,R10                  POINT TO TTE ADDRESS      S99528 75510000
         MVC   TTEADDR+1(3),0(R9)      ALLINE ADDRESS            S99528 75600000
         L     R6,TTEADDR              GET TTE ADDRESS           S99528 75690000
         USING IEDQTRM,R6                                        S99528 75780000
         L     R6,TRMDESTQ-1           GET QCB ADDRESS           S99528 75870000
         DROP  R6                                                S99528 75960000
         B     0(R7)                   RETURN                    S99528 76050000
         EJECT                                                          76050100
************************************************************** @Y17XAUU 76050200
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 76050300
*        ENTRY TTE ADDRESS. OUTPUT: REG 1 = NCP TTE PREFIX   * @Y17XAUU 76050400
*        ADDRESS. RETURN TO CALLER VIA REG 14.               * @Y17XAUU 76050500
************************************************************** @Y17XAUU 76050600
NCPTTE   EQU   *                                               @Y17XAUU 76050700
         ST    R14,TRMSAVE2            SAVE RETURN ADDRESS     @Y17XAUU 76050800
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 76050900
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 76051000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 76051100
NCPLOOP  EQU   *                                               @Y17XAUU 76051200
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 76051300
         L     R15,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 76051400
         USING IEDQAVTD,R15            SET AVT ADDRESSABILITY  @Y17XAUU 76051500
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 76051600
*                                      ROUTINE ADDRESS         @Y17XAUU 76051700
         DROP  R15                                             @Y17XAUU 76051800
         BALR  R14,R15                 FIND TTE ADDRESS        @Y17XAUU 76051900
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 76052000
         CLI   TRMTYPE,TRMLNCP         NCP ENTRY               @Y17XAUU 76052100
         BNE   NCPLOOP                 NO - CHECK NEXT ENTRY   @Y17XAUU 76052200
         L     R14,TRMSAVE2            RESTORE RETURN ADDRESS  @Y17XAUU 76052300
         BR    R14                     RETURN TO CALLER        @Y17XAUU 76052400
         DROP  R1                                              @Y17XAUU 76052500
         EJECT                                                          76140000
         DS    0F                                                S99528 78660000
CDSLINE  DC    CL8'G0000000'           CDS NAME                  S99528 78750000
DEVADBUF DS    0F                                                       78840000
         DC    4CL1'0'                 DEVICE ADDRESS BUFFER     S99528 78930000
DEQLIST  DEQ   (QNAME,RNAME,8,STEP),RET=HAVE,MF=L                       79020000
QNAME    DC    CL8'SYSZTOTE'           MAJOR ELEMENT           @Y17XAUU 79110000
RNAME    DC    8CL1' '                 MINOR ELEMENT             S99528 79200000
*                                                                       79290000
*       PARAMETER LIST FOR SVC PURGE                                  * 79380000
CBPRGLST DS    0F                                                S99528 79470000
CBPRGDEB EQU   CBPRGLST                BEDADDRESS                S99528 79560000
CBPURFLG DC    A(0)                    FLAGS                     S99528 79650000
         DC    A(0)                    PURGE PARM                S99528 79740000
CBPRGIOB DS    0F                      UOB ADDRESS               S99528 79830000
CBPDEBNO DC    A(0)                    DEB ADDRESS               S99528 79920000
*                                                                S99528 81090000
*       PARAMETER LIST FOR SVC 102                                    * 82260000
CBSLPL   DS    0F                                                S99528 82350000
         DC    X'0C'                   START                     S99528 82440000
         DC    AL3(0)                  ADDR OF FIRST             S22024 82530000
         DC    X'80'                   FLAG END                  S99528 82620000
         DC    AL3(0)                  ADDR OF FIRST             S22024 82710000
ADDOFUCB DC    AL3(0)                  UCB ADDRESS               S99528 82800000
JFCBAA  DC     CL176'0'                JFCB                      S99528 82890000
         DS    0F                      EXIT LIST                 S99528 82980000
JFCBADDR DC    X'07'                   KEY FOR JFCB              S99528 83070000
         DC    AL3(JFCBAA)             ADDRESS OF THE JFCB       S99528 83160000
         DC    X'80'                   END OF LIST               S99528 83250000
         DC    AL3(0)                  ZEROS                     S99528 83340000
TTEADDR  DC    AL4(0)                  TTE ADDRESS               S99528 83430000
NCPTTCIN DC    H'0'                    NCP TTCIN               @OY20578 83470086
EXCPDCB  DCB   DDNAME=DD274E,DSORG=PS,EXLST=JFCBADDR,MACRF=(E),        C83520000
               SIOA=AO,CENDA=AP,XENDA=AP   GRAPHIC APPENDAGES    S99528 83610000
EXCP     OPEN  (EXCPDCB,),MF=L                                   S99528 83700000
EXCPP    CLOSE EXCPDCB,MF=L                                      S99528 83790000
***                                                                     83880000
***      MESSAGES                                                       83970000
***                                                                     84060000
UNIT     DC    CL8'        '           NNIT NAME                 S99528 84150000
UCB5SAVE DC    A(0)                    REG 5 SAVE                S99528 84240000
UCB3SAVE DC    A(0)                    REG 3 SEVE                S99528 84330000
         DS    0F                      ALLINE                    S22024 84420000
INVTIC   DC    X'08000002'             INVALID TIC             @YM08158 84430000
TRMSAVE2 DS    F                       REG SAVE AREA           @Y17XAUU 84440000
ONEE     DC    H'1'                    ONE                       S22024 84510000
OFFSET   DC    H'0'                    OFFSET OF TNT             S22024 84600000
TNTNAME2 DC    CL8'        '            TNTNAME SAVE AREA      @OY20578 84690086
DEQSAVE  DS    3F                      SAVE REGS K 6 7           S22024 84780000
NAMEMOVE MVC   UNIT(ZERO),ZERO(R1) MOVE NAME                            84870000
CTNAME   MVC   RNAME,0(R1)             NAME TO DEQ               S99528 84960000
TERMIATE DC    CL26'            UNIT          '  START TERM MSG  S99528 85050000
NOCORE   DC    CL37'NOT ENOUGH CORE FOR SECTION          ' MSG   S99528 85140000
NOTLOAD  DC    CL32'OLT MODULE          NOT LOADABLE'    MSG     S99528 85230000
ASTRICK  EQU   X'5C'                   ASTERICK                  S99528 85320000
TEE      EQU   X'E3'                   T                         S99528 85410000
S        EQU   X'E2'                   S                         S99528 85500000
INITSTAT DC    X'00'                   INITAL STATUS BYTE        S99528 85590000
APSTIME  DC    X'00'                   AP STIMER FLAG            S99528 85680000
APSTIMER EQU   X'80'                   STIMER FOR AP             S99528 85770000
ALPHTABL DC    CL26'ABCDEFGHIJKLMNOPQRSTUVWXYZ'     TABLE        S99528 85860000
ENDALTAB DC    X'EA'                   PAST ALPHBET              S99528 85950000
         DS    0D                      DOUBLE WORD ALLINE        S99528 86040000
SECS00   DC    X'F0F0F0F0F1F1F1C1'     WAIT TIME                 S99528 86130000
X3705    DC    AL1(0)                  CONTROL UNIT TYPE SAVE    S22024 86220000
TRMSAVE  DC    H'0'                    RSID SAVE AREA            S05331 86260000
*                                                                S22024 86263000
*        PARZMETER LIST FOR SVC 102 DATA MOVE                    S22024 86266000
*                                                                S22024 86269000
         DS    0F                      ALLINE                    S22024 86272000
TOT102   DC    X'08'                   FLAG FOR DATA MOVE        S22024 86275000
         DC    AL3(UCBWORK)            DATA ADDRESS              S22024 86278000
TOT102A  DC    X'00'                   ZERO                      S22024 86281000
         DC    AL3(0)                  TARGET ADDRESS            S22024 86284000
         DC    X'80'                   LAST WORD FLAG            S22024 86287000
         DC    AL3(LENGADDR)           LENGTH ADDRESS            S22024 86290000
UCBWORK  DC    AL4(0)                  WORKAREA                  S22024 86293000
LENGADDR DC    H'04'                   LENGTH OF DATA            S22024 86296000
QNAMEE   DC    CL8'CDSLIB  '           MAJOR NAME                S22024 86298000
RNAMEE   DC    CL8'OLT2LIB '           MINOR NAME                S22024 86300000
RNFLAG   DC    X'00'                   FLAG BYTE FOR 3705        S05331 86300500
CTFLAG   EQU   X'80'                   CT ON 3705                S05331 86301000
APFLAG   EQU   X'40'                   AP ON 3705                S05331 86301500
CTLTTE   DS    F                       ADDR OF TTE FOR CT LINE   S05331 86302000
APLTTE   DS    F                       ADDR OF TTE FOR AP LINE   S05331 86302500
LUFLAGS  DC    X'00'                  LU FLAGS                 @XM05672 86302600
APLUNT   EQU   X'80'                  ALT. PRINTER IS LU       @XM05672 86302700
CTLUNT   EQU   X'40'                  CONTROL TERM IS LU       @XM05672 86302800
PATCH    DC    CL100' '                PATCH AREA                S22024 86303000
WEEND    EQU   *                                                        86310000
         EJECT                                                          86400000
         TLCBD                                                          86490000
         EJECT                                                          86580000
UCB      DSECT                                                          86670000
         IEFUCBOB                                                       86760000
         EJECT                                                          86850000
         EJECT                                                          86940000
RESPL    RESPL EQUATES=YES                                              87030000
         EJECT                                                          87120000
         OLTCB                         OLTCB                     S22024 87210000
TCNTBLDL EQU   TOTWKSPC                                                 87300000
TCNTBECT EQU   TCNTBLDL+1                                               87390000
TCNTBELN EQU   TCNTBLDL+3                                               87480000
TCNTMDNM EQU   TCNTBLDL+4                                               87570000
TCNTMDSZ EQU   TCNTBLDL+28                                              87660000
         EJECT                                                          87750000
         TDEBD                                                          87840000
         EJECT                                                          87930000
PLNKPREF DSECT                                                          88020000
PLNKNAME DS    CL8                     OLT NAME                  S99528 88110000
         ORG   PLNKPREF+10             TO POINTER                S99528 88200000
PLNKMPTR DS    CL2                     POINTER                   S99528 88290000
         SPACE 5                                                        88380000
PLNKQPTR DSECT                                                          88470000
PLNKQFWD DS    F                       FORWARD POINTER           S99528 88560000
PLNKQBKD DS    F                       BACK POINTER              S99528 88650000
         EJECT                                                          88740000
DCBDSECT DCBD  DSORG=TX                                          S99528 88830000
          TQCBD                                                  S99528 88920000
         EJECT                                                          89010000
CVT      DSECT                                                   S99528 89100000
         CVT                                                     S99528 89190000
TIOT     DSECT                                                   S99528 89280000
         IEFTIOT1                                                S99528 89370000
         EJECT                                                          89460000
         TTRMD                                                          89550000
         TPRFD                         BUFFER PREFIX             S22024 89590000
         EJECT                                                          89640000
         TLGBD                         LGB                       S22024 89730000
         TTNTD                         TTE                       S22024 89820000
         TAVTD                                                          89910000
         EJECT                                                          89930000
         TREQD                                                          89950000
         SPACE 4                                                        89970000
         END                                                            90000000
