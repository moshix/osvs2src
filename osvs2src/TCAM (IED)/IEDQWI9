         TITLE 'IEDQWI9 CONFIGURATOR SUB-MODULE 5'                      00100000
IEDQWI9  CSECT                                                   S21903 00200000
*A000000-999999                                                @Y16X5U0 00300000
*D879000                                                       @OY20528 00300186
*A867000                                                       @OY20528 00300286
* CHANGE ACTIVITY AS FOLLOW:                                     S21903 00400000
*C003000-004000                                                  S21903 00500000
*D136000,144000                                                  S21903 00600000
*A207350,207400-207420,207870-207940,718300-718600              SA41605 00700000
*C308000-351000                                                 SA41605 00800000
*A207390,207450-207470,207901-207907,207950-207999,224000        S22024 00900000
*A258410-258540,284400-285800,292600-293200,418000,438000,446000 S22024 01000000
*A454000,466000,482300-483500,484500-485500,495000,514400-515900 S22024 01100000
*A558100,569020-569160,570420-570540,613000,701200-703000,714000 S22024 01200000
*A719700-721100,734100-736800,738400-738500,738986-738988        S22024 01300000
*C006400,009200-013400,146000-191000,218000,234000,246440,246520 S22024 01400000
*C288000,292000,304000,364000,366000,384000,392000,400000,408000 S22024 01500000
*C416000,428000,432000,436000,444000,452000,460000,476000,522000 S22024 01600000
*C532000,542000,552000,558000,567400,578000,612000,616000,620000 S22024 01700000
*C624000,628000,632000,636000,644000,652000,656000,660000,664000 S22024 01800000
*C666500,667500,668500,676000,692000                             S22024 01900000
*D192000-206000,256000-258400,560000                             S22024 02000000
*A207200,564600,564800,563200                                  @YA12402 02100000
**************************************************************** S21903 02200000
*                                                              * S21903 02300000
*                                                              * S21903 02400000
* MODULE NAME:                                                 * S21903 02500000
*                                                              * S21903 02600000
*    IEDQWI9 (TCAM,TOTE)                                       @Y17XAUU 02700000
*                                                              * S21903 02800000
* DESCRIPTIVE NAME:                                            * S21903 02900000
*                                                              * S21903 03000000
*    TOTE CONFIGURATOR SUB-MODULE                              * S21903 03100000
*                                                              * S21903 03200000
* COPYRIGHT:                                                   * S21903 03300000
*                                                              * S21903 03400000
*    'NONE'                                                    * S21903 03500000
*                                                              * S21903 03600000
* STATUS:                                                      * S99528 03700000
*                                                              * S99528 03800000
*    VERSION 10.0                                              @Y17XAUU 03900000
*                                                              * S99528 04000000
* FUNCTION:                                                    * S99528 04100000
*                                                              * S99528 04200000
*    THIS MODULE DETERMINES THE LINE ADDRESS AND TERMINAL TYPE.* S22024 04300000
*    IF THE LINE IS NOT OPENED, THE LINE ADDRESS IS PROMPTED   * S22024 04400000
*    FOR AND THE CORRECT UCB IS THEN FOUND.  THE POLLING       * S22024 04500000
*    CHARACTERS AND, IF NECESSARY, THE CPU ID IS MOVED INTO    * S22024 04600000
*    THE CDS FOR THE TERMINAL BEING CONFIGURED.  THE LINE      * S22024 04700000
*    CONNECTION CODE IS DETERMINED AND MOVED INTO THE CDS.     * S22024 04800000
*    IF THE LINE IS BI-SYNCH THE TRANSLATION CODE OF THE       * S22024 04900000
*    TERMINAL IS PROMPTED FOR.                                 * S22024 05000000
*                                                              * S99528 05100000
* ENTRY POINT:                                                 * S99528 05200000
*                                                              * S99528 05300000
*         IEDQWI9 - CALLED BY ADD SCHEDULER(IEDQWIA)           @Y17XAUU 05400000
*                                                              @Y17XAUU 05500000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 05600000
*                                                              @Y17XAUU 05700000
* MODULE SIZE: SEE LISTING                                     @Y17XAUU 05800000
*                                                              @Y17XAUU 05900000
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 06000000
*                                                              * S99528 06100000
* MACROS: IEDQMSG,IEDHJN,SAVE,DELETE,LOAD,TCONV                @Y17XAUU 06200000
*                                                              @Y17XAUU 06300000
* INPUT:                                                       * S99528 06400000
*                                                              * S99528 06500000
*    REGISTERS 02,11,14,15 CONTAIN THE FOLLOWING VALUES:       * S99528 06600000
*                                                              * S99528 06700000
*    02-OLTCB POINTER                                          * S99528 06800000
*    11-CALLING ROUTINE WORK AREA                              * S99528 06900000
*    14-RETURN ADDRESS                                         * S99528 07000000
*    15-ENTRY POINT ADDRESS                                    * S99528 07100000
*                                                              * S99528 07200000
* OUTPUT:                                                      * S99528 07300000
*                                                              * S99528 07400000
*    REGISTER 1 CONTAINS THE FOLLOWING VALUE:                  * S99528 07500000
*                                                              * S99528 07600000
*    01-PARAMETER LIST ADDRESS                                 * S99528 07700000
*                                                              * S99528 07800000
* EXTERNAL REFERENCES:                                         * S99528 07900000
*                                                              * S99528 08000000
*         IEDQWK-MESSAGE MODULE                                * S99528 08100000
*         IEDQWI5U-TCU/ADAPTER TYPE MODULE                     * S99528 08200000
*         IEDQWI7-LINE TYPE MODULE                             * S99528 08300000
*         IEDIAP04-FIND NETWORK ADDRESS                        @Y17XAUU 08400000
*         IEDIAP06-FIND 3705 LCB ADDRESS                       @Y17XAUU 08500000
*                                                              * S99528 08600000
* EXITS-NORMAL:                                                * S99528 08700000
*                                                              * S99528 08800000
*         BR AFTER 'PLRET' TO IEDQWIA OR IEDQWI9               * S99528 08900000
*                                                              * S99528 09000000
* EXITS-ERROR:                                                 * S99528 09100000
*                                                              * S99528 09200000
*         NONE                                                 * S99528 09300000
*                                                              * S99528 09400000
* TABLES/WORK AREAS:                                           * S99528 09500000
*                                                              * S99528 09600000
*    OLTCB                                                     * S99528 09700000
*    CDS WORK AREA                                             * S99528 09800000
*                                                              * S99528 09900000
* ATTRIBUTES:                                                  * S99528 10000000
*                                                              * S99528 10100000
*    ENABLED,PROBLEM PROGRAM MODE,TRANSIENT                    * S99528 10200000
*                                                              * S99528 10300000
* NOTES: SEE BELOW                                             @Y17XAUU 10400000
*                                                              * S99528 10500000
*  DEPENDENCIES - EBCDIC CHARACTER CODE SET                    @Y17XAUU 10600000
*                                                              @Y17XAUU 10700000
*  RESTRICTIONS-- NONE                                         @Y17XAUU 10800000
*                                                              @Y17XAUU 10900000
*  REGISTERS CONVENTION--                                      @Y17XAUU 11000000
*                                                              @Y17XAUU 11100000
*  PATCH LABEL -- PATCH                                        @Y17XAUU 11200000
*                                                              * S99528 11300000
*********************************************************************** 11400000
         EJECT                                                          11500000
*              EQUATES                                                  11600000
*                                                                       11700000
PARMREG0 EQU   0                       PARAMETER REGISTER        S99528 11800000
PARMREG1  EQU  1                       PARAMETER REGISTER        S99528 11900000
R2       EQU   2                       OLTCB POINTER             S99528 12000000
BASEREG  EQU   3                       PROGRAM BASE REG          S99528 12100000
CALLERS  EQU   8                       OFFSET TO CALLER SAVE     S99528 12200000
OWN      EQU   4                       OFFSET TO OWN SAVE        S99528 12300000
UCBPTREG EQU   10                      POINTER TO UCB            S99528 12400000
AREAADDR EQU   12                      AREA ADDRESS              S99528 12500000
SAVEAREA EQU   13                      POINTER TO SAVE AREA      S99528 12600000
SAVEADDR EQU   15                      SAVE AREA ADDRESS         S99528 12700000
RETCODE  EQU   15                      RETURN CODE               S99528 12800000
ENTRYPT  EQU   15                      ENTRY POINT ADDRESS       S99528 12900000
CUUADR   EQU   2                       CUU ADDRESS               S99528 13000000
LEN      EQU   2                       LENGTH                    S99528 13100000
CUUPTR   EQU   4                       POINTER TO CUU            S99528 13200000
LEFTCLR  EQU   X'0F'                   MASK TO CLEAR LEFT BITS   S99528 13300000
TERMCLAS EQU   X'42'                   CDS TERMINAL CLASS        S99528 13400000
ZERO     EQU   X'00'                   ZERO TEST                 S99528 13500000
LINEOPEN EQU   X'10'                   OPEN LINE INDICATOR       S99528 13600000
EBCDIC   EQU   X'C5'                   EBCDIC RESPONSE INDICATOR S99528 13700000
USASCII  EQU   X'C1'              ASCII RESPONSE INDICATOR       S22024 13800000
TRANSCOD EQU   X'E3'                   TRANSCOD RESPON INDICATOR S99528 13900000
YES      EQU   X'E8'                   YES RESPONSE TEST         S99528 14000000
NO       EQU   X'D5'                   NO  RESPONSE TEST         S99528 14100000
CDSEBCDC EQU   X'07'                   EBCIDIC CODE              S99528 14200000
CDSTRANS EQU   X'08'                   TRANS CODE                S99528 14300000
CDSUSASC EQU   X'05'                   USASC CODE                S99528 14400000
TYPELEN  EQU   4                       LENGTH OF TYPE FIELD      S99528 14500000
R0       EQU   0                       WORK REGISTER           @Y17XAUU 14600000
R1       EQU   1                       WORK REGISTER             S22024 14700000
WORKREG4 EQU   4                       WORK REGISTER             S22024 14800000
WORKREG5 EQU   5                       WORK REGISTER             S22024 14900000
UCBREG   EQU   5                       UCB ADDRESS               S22024 15000000
WORKREG6 EQU   6                       WORK REGISTER             S22024 15100000
WORKREG7 EQU   7                       WORK REGISTER 7           S22024 15200000
WORKREG8 EQU   8                       WORK REGISTER             S22024 15300000
RETURN   EQU   9                       RETURN ADDR FROM SUB-     S22024 15400000
*                                        ROUTINE                 S22024 15500000
R10      EQU   10                      WORK REGISTER             S22024 15600000
R12      EQU   12                      REGISTER 12               S22024 15700000
R13      EQU   13                      WORK REGISTER             S22024 15800000
R14      EQU   14                      RETURN ADDRESS            S22024 15900000
R15      EQU   15                      WORK REGISTER             S22024 16000000
CVT      EQU   16                      ADDRESS OF CVT            S22024 16100000
UCBPTR   EQU   X'28'                   OFFSET TO UCB TABLE       S22024 16200000
BSCTERM  EQU   X'10'                   BI SYNC TERMINAL INDICTR  S99528 16300000
CDSSTDBS EQU   X'80'                   RFT CONFIG FLAG           S99528 16400000
BLANK    EQU   X'40'                    BLANK CHARACTER        @YA12402 16500000
D0       EQU   0                        DISPLACEMENT 0           S99528 16600000
D1       EQU   1                        DISPLACEMENT 1           S99528 16700000
D2       EQU   2                       DISPLACEMENT 2           SA41605 16800000
D3       EQU   3                        DISPLACEMENT 3           S99528 16900000
D4       EQU   4                       CONSTANT DISPLACEMENT 4   S22024 17000000
D8       EQU   8                       DISPLACEMENT 8           SA41605 17100000
D9       EQU   9                       CONSTANT DISPLACEMENT    SA41605 17200000
D11      EQU   11                       DISPLACEMENT 11          S99528 17300000
D13      EQU   13                      CONSTANT DISPLACEMNT 13   S22024 17400000
D17      EQU   17                      CONSTANT DISPLACEMENT 17  S22024 17500000
D28      EQU   28                  CONSTANT DISPLACEMENT 28      S22024 17600000
D48      EQU   48                      CONSTANT DISPLACEMENT 48  S22024 17700000
CONCTERM EQU   X'80'                    BIT SETTING INDICATING   S99528 17800000
*                                         CONCENTRATOR ENTRY     S99528 17900000
R4       EQU   4                        WORK REGISTER            S99528 18000000
R5       EQU   5                        WORK REGISTER            S99528 18100000
R6       EQU   6                  WORK REGISTER                  S99528 18200000
R7       EQU   7                        WORK REGISTER            S99528 18300000
R9       EQU   9                        WORK REGISTER            S99528 18400000
R11      EQU   11                      WORK REGISTER            SA41605 18500000
LISTEND  EQU   X'FE'                   END OF INVITATION LIST   SA41605 18600000
*                                        INDICATOR              SA41605 18700000
INACT    EQU   X'40'                   INACTIVE LIST SCAN       SA41605 18800000
SAD1     EQU   X'01'                   SADONE INDICATION IN UCB  S22024 18900000
SAD3     EQU   X'03'                   SADTHREE INDICATION IN UCBS22024 19000000
LGBFLAG  EQU   X'80'                   BIT SETTING INDICATING    S22024 19100000
*                                        LGB FOR 3705            S22024 19200000
OPEN     EQU   X'10'                   BIT SETTING INDICATING    S22024 19300000
*                                        OPEN DCB                S22024 19400000
ERROR    EQU   X'01'                   ERROR BIT SETTING         S22024 19500000
EOT      EQU   X'80'                   BIT SETTING IN INVIT     SA41605 19600000
*                                        LIST INDICATION EOT IS SA41605 19700000
*                                        SPECIFIED IN LIST      SA41605 19800000
NOACT    EQU   X'80'                   NO ACTIVE ENTRIES IN LISTSA41605 19900000
BFDLAY   EQU   X'02'                   BUFFER DELAY INDICATOR    S22024 20000000
RNLU     EQU   X'6F'                   3705 SNA LU INDICATOR   @YM07722 20050000
RNBISYN  EQU   X'9F'                   3705 BI SYNCH TERMINAL    S22024 20100000
*                                        INDICATOR               S22024 20200000
RNSS     EQU   X'0F'                   3705 START/STOP TERMINAL  S22024 20300000
*                                        INDICATOR               S22024 20400000
RNLINE   EQU   X'FF'                   3705 COMMUNICATION LINE   S22024 20500000
*                                        INDICATOR               S22024 20600000
RNTRM    EQU   X'20'                   3705 TERMINAL OR LINE -   S22024 20700000
*                                        BYPASS POLL CHARS GET   S22024 20800000
DCBNIDLE EQU   X'02'                   3705 ACTIVE BIT IN DCB    S22024 20900000
         EJECT                                                          21000000
**************************************************************** S99528 21100000
*                                                                       21200000
*              INITIALIZATION                                           21300000
*                                                                       21400000
**************************************************************** S99528 21500000
         SAVE  (14,12)                 SAVE CALLER'S REGISTERS   S22024 21600000
         LR    BASEREG,ENTRYPT         LOAD BASE REGISTER        S99528 21700000
         USING IEDQWI9,BASEREG         ESTAB PGM BASE            S99528 21800000
         USING TOTOLTCB,R2             ESTAB OLTCB BASE          S99528 21900000
IEDQWI9  IEDHJN IEDQWI99,HJN           SET DATE AND MODULE NAME  S22024 22000000
         LA    SAVEADDR,QWI9SAVE       LOAD OWN SAVE AREA ADDR   S99528 22100000
         ST    SAVEADDR,CALLERS(SAVEAREA)   STORE ADDR.IN CALLER S99528 22200000
         ST    SAVEAREA,OWN(SAVEADDR)  STORE CALLERS IN QWI9 SAV S99528 22300000
         LR    SAVEAREA,SAVEADDR       GET SAVE ADDR             S99528 22400000
         MVI   OPENFLAG,LINEOPEN       INIT OPEN LINE INDICATOR  S99528 22500000
         CLC   CDSTCUTY,TCU7770        IS TCU A 7770?            S22024 22600000
         BE    PLRET                   BR IF TCU IS 7770         S99528 22700000
         EJECT                                                          22800000
**************************************************************** S99528 22900000
*                                                                       23000000
*  ROUTINE TO FIND INVITATION LIST ADDRESS                              23100000
*                                                                       23200000
**************************************************************** S99528 23300000
INVITE   L     WORKREG6,TERTABLE        PICK UP TERMINAL TABLE ADDR     23400000
         USING IEDQTRM,WORKREG6   SET TTE ADDRESSABILITY       @Y17XAUU 23500000
         TM    TRMDEVFL+D1,TRMCONC  TERMINAL ATTACHED TO       @Y17XAUU 23600000
*                                         A CONCENTRATOR?        S99528 23700000
         BZ    CONTINUE                 NO, BYPASS CONCENTRATOR  S99528 23800000
*                                         SET UP                 S99528 23900000
         L     WORKREG8,TRMDESTQ-D1 GET QCB ADDRESS            @Y17XAUU 24000000
         DROP  WORKREG6                                        @Y17XAUU 24100000
         USING IEDQQCB,WORKREG8                                  S99528 24200000
         LA    WORKREG5,QCBDSFLG        GET ADDRESS OF QCB       S99528 24300000
         AH    WORKREG5,QCBEXTO         ADD OFFSET TO QCB        S99528 24400000
*                                         EXTENSION              S99528 24500000
         DROP  WORKREG8                                          S99528 24600000
         L     R1,D0(WORKREG5)         GET ADDRESS OF CONCEN-    S22024 24700000
*                                         TRATOR TERMINAL ENTRY  S99528 24800000
         ST    R1,CONCTTE              SAVE TERMINAL ADDRESS     S22024 24900000
         L     WORKREG7,TOTAVTPT        GET AVT ADDRESS          S99528 25000000
         USING IEDQAVTD,WORKREG7                                 S99528 25100000
         L     R14,AVTRNMPT             GET ADDRESS OF TERMNAME  S99528 25200000
*                                         TABLE                  S99528 25300000
         DROP  WORKREG7                                          S99528 25400000
         USING IEDQTNTD,R14                                      S99528 25500000
         LA    R7,TNTFIRST              GET ADDRESS OF FIRST     S99528 25600000
*                                         ENTRY IN TABLE         S99528 25700000
         SR    R9,R9                    CLEAR REGISTER 9         S99528 25800000
         IC    R9,TNTENLEN              GET NAME FIELD LENGTH    S99528 25900000
         LA    R4,D3(R9)                GET LENGTH OF ONE ENTRY  S99528 26000000
         LH    R5,TNTLEN                GET NUMBER OF ENTRIES    S99528 26100000
         AR    R7,R9                    GO TO FIRST TTE ADDRESS  S99528 26200000
         LA    R10,D1                   SET COUNTER TO ONE       S99528 26300000
         DROP  R14                                               S99528 26400000
CONC     EQU   *                                                 S99528 26500000
         CLC   D0(D3,R7),CONCTTE+D1     CONCENTRATOR ENTRY       S99528 26600000
*                                         FOUND?                 S99528 26700000
         BE    FOUND                    YES, CONTINUE PROCESSING S99528 26800000
         LA    R10,D1(R10)              INCREMENT COUNTER BY ONE S99528 26900000
         AR    R7,R4                    GET NEXT TTE ADDRESS     S99528 27000000
         BCT   R5,CONC                  CHECK NEXT ENTRY         S99528 27100000
         B     PLRET                    ENTRY NOT FOUND - EXIT   S99528 27200000
FOUND    EQU   *                                                 S99528 27300000
         STH   R10,WORK2                SAVE TERMNAME TABLE      S99528 27400000
*                                         OFFSET                 S99528 27500000
         L     R6,CONCTTE               GET CONCENTRATOR TERMINALS99528 27600000
*                                         ENTRY ADDRESS          S99528 27700000
CONTINUE EQU   *                                                 S99528 27800000
         USING IEDQTRM,WORKREG6   SET TTE ADDRESSABILITY       @Y17XAUU 27900000
         LR    WORKREG8,WORKREG6  COPY TTE ADDRESS             @YM07384 28000000
         L     WORKREG6,TRMDESTQ-D1 GET QCB ADDRESS            @YM07384 28100000
         DROP  WORKREG6                                        @YM07384 28200000
         USING IEDQQCB,WORKREG6   SET QCB ADDRESSABILITY       @YM07384 28300000
         SLR   WORKREG7,WORKREG7  CLEAR REG                    @YM07384 28400000
         IC    WORKREG7,QCBRELLN  GET RLN                      @YM07384 28500000
         L     WORKREG6,QCBDCBAD-D1 GET DCB ADDRESS            @YM07384 28600000
         DROP  WORKREG6                                        @YM07384 28700000
         USING IHADCB,WORKREG6    SET DCB ADDRESSABILITY       @YM07384 28800000
         TM    DCBDSORG,TRMLGB    LGB VS. DCB                  @YM07384 28900000
         BZ    DCBFOUND           NO - ALREADY HAVE DCB        @YM07384 29000000
         OI    POLLFLAG,RNTRM     SHOW 3705 RESOURCE           @YM07384 29100000
         LA    WORKREG7,D1        SET 3705 RLN                 @YM07384 29200000
         L     R4,TOTAVTPT        GET AVT ADDRESS              @YM07384 29300000
         USING IEDQAVTD,R4        SET AVT ADDRESSABILITY       @YM07384 29400000
NCPLOOP  DS    0H                                              @YM07384 29500000
         USING IEDNTRM,WORKREG8   RESET TTE ADDRESSABILITY     @YM07384 29600000
         LA    R14,TRMPRFSZ       GET TTE PREFIX SIZE          @YM07384 29700000
         SLR   WORKREG8,R14       POINT TO TTE PREFIX          @YM07384 29800000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @YM07384 29900000
         BE    NCPFIND            YES                          @YM07384 30000000
         LH    PARMREG1,TRMCOHRT  GET COHORT POINTER           @YM07384 30100000
         LTR   PARMREG1,PARMREG1  ENTRY IN HIERARCHY           @YM07415 30200000
         BZ    NCPROMPT           NO - GO FIND 3705 DCB ADDRE  @YM07415 30300000
         L     R15,AVTRNMPT       TERM NAME TABLE ADDRESS      @YM07384 30400000
         BALR  R14,R15            FIND TTE ADDRESS             @YM07384 30500000
         LR    WORKREG8,PARMREG1  COPY THIS ENTRY              @YM07384 30600000
         B     NCPLOOP            CHECK THIS ENTRY             @YM07384 30700000
NCPFIND  DS    0H                                              @YM07384 30800000
         L     WORKREG6,TRMDESTQ-D1 GET QCB ADDRESS            @YM07384 30900000
         USING IEDQQCB,WORKREG6   SET QCB ADDRESSABILITY       @YM07384 31000000
         L     WORKREG6,QCBDCBAD-D1 GET 3705 DCB ADDRESS       @YM07384 31100000
         DROP  WORKREG6                                        @YM07384 31200000
         USING IHADCB,WORKREG6    SET DCB ADDRESSABILITY       @YM07384 31300000
         TM    TRMBYTE2,TRMRSACT  3705 ACTIVE                  @YM07384 31400000
         BZ    BYPASS             NO                           @YM07384 31500000
         TM    TRMBYTE2,TRMINPG   ACT DEACT IN PROGRESS        @YM07384 31600000
         BO    BYPASS             YES                          @YM07384 31700000
DCBFOUND EQU   *                                                 S22024 31800000
         TM    DCBOFLGS,OPEN           IS LINE OPEN?             S22024 31900000
         BZ    BYPASS                  NO, GO PROMPT FOR LINE    S22024 32000000
*                                        ADDRESS                 S22024 32100000
         L     WORKREG8,DCBDEBAD       GET DEB ADDRESS           S22024 32200000
GETDEB   EQU   *                                                 S22024 32300000
         USING DEBNMSUB,WORKREG8                                        32400000
         SR    R15,R15            GET NUMBER                            32500000
         IC    R15,DEBNMEXT         OF EXTENTS                          32600000
         CR    R15,WORKREG7       IS LINE OPENED?                       32700000
         BL    BYPASS               NO                                  32800000
GETUCBAD EQU   *                       LINE IS OPEN, GET UCB ADD S99528 32900000
         BCTR  WORKREG7,0              CONVERT RLN SCALE         S99528 33000000
         SLL   WORKREG7,2              GET RLN BYTE OFFSET       S99528 33100000
         L     UCBREG,DEBUCBAD(WORKREG7)    GET UCB ADDR.FOR RLN S99528 33200000
         DROP  WORKREG6                                                 33300000
         DROP  WORKREG8                                                 33400000
         B     UCBMOVE                 GO GET LINE INFO          S99528 33500000
GETSCT   L     WORKREG8,48(WORKREG6)   PICK UP SCT ADDR          S99528 33600000
         ST    WORKREG8,SCTADD          SAVE IT                         33700000
         L     WORKREG6,60(WORKREG7,WORKREG6)  PICK UP INVITATION LIST  33800000
         ST    WORKREG6,INVADDR                ADDR AND SAVE            33900000
         EJECT                                                          34000000
**************************************************************** S99528 34100000
*                                                                       34200000
*   ROUTINE TO GET POLLING CHARACTERS FROM INVITATION LIST.             34300000
*                                                                       34500000
**************************************************************** S99528 34600000
         SPACE                                                          34700000
         LTR   WORKREG6,WORKREG6       IS THERE AN INVITATION    S22024 34800000
*                                        LIST ADDRESS?           S22024 34900000
         BZ    SCTROUT                 YES, NO POLLING CHARS     S22024 35000000
         TM    POLLFLAG,RNTRM          IS DEVICE ON 3705?        S22024 35100000
         BO    LINEONRN                YES, NO POLL CHARS      @Y17XAUU 35200000
         SR    WORKREG7,WORKREG7                                        35300000
         LA    WORKREG4,D1             SET COUNTER TO 1                 35400000
         LH    WORKREG7,WORK2     PICK UP TERMNAME TABLE INDEX          35500000
INVSRCH  EQU   *                                                 S22024 35600000
         SH    WORKREG6,TWO            SUBTRACT 2 FROM START OF  S22024 35700000
*                                        LIST                    S22024 35800000
         CH    WORKREG7,0(WORKREG6)    IS THIS ENTRY FOR TERM?          35900000
         BE    INVFIND                 YES BRANCH                       36000000
         LA    WORKREG4,1(WORKREG4)    NO BUMP COUNTER                  36100000
         B     INVSRCH                 GO LOOK AGAIN                    36200000
INVFIND  EQU   *                                                        36300000
         L     R5,INVADDR              RESET INVITE ADDR         S22024 36400000
         SR    WORKREG7,WORKREG7                                        36500000
         SR    R10,R10                 CLEAR REG 10             SA41605 36600000
         SR    WORKREG6,WORKREG6       CLEAR REGISTER 6         SA41605 36700000
         IC    WORKREG6,D2(R5)         PICK UP NUMBER OF BYTES  SA41605 36800000
*                                        PER ENTRY              SA41605 36900000
         IC    WORKREG7,D1(R5)         PICK UP NUMBER OF ACTIVE SA41605 37000000
*                                        ENTRIES                SA41605 37100000
         LTR   WORKREG7,WORKREG7       ARE THERE ANY ACTIVE     SA41605 37200000
*                                        ENTRIES?               SA41605 37300000
         BNZ   ACT1                    YES, CONTINUE            SA41605 37400000
         OI    POLLFLAG,NOACT          SET NO ACTIVE ENTRIES    SA41605 37500000
*                                        INDICATOR              SA41605 37600000
         B     INACT2                  GO CONTINUE SEARCH       SA41605 37700000
ACT1     EQU   *                                                SA41605 37800000
         LA    R11,D1                  SET REG 11 TO 1          SA41605 37900000
         IC    R10,D2(R5)              GET NUMBER OF BYTES IN   SA41605 38000000
*                                        A ENTRY                SA41605 38100000
         SR    R10,R11                 GET OFFSET TO TNT INDEX  SA41605 38200000
*                                        POINTER                SA41605 38300000
NOINV1   EQU   *                                                SA41605 38400000
         LA    R5,D8(R5)               POINT PAST CONTROL WORD  SA41605 38500000
NOINV    EQU   *                                                SA41605 38600000
         SR    R1,R1                   CLEAR REGISTER 1         SA41605 38700000
         IC    R1,D0(R10,R5)           GET TNT OFFSET INDEX     SA41605 38800000
         CR    WORKREG4,R1             IS THIS THE CORRECT      SA41605 38900000
*                                           ENTRY?              SA41605 39000000
         BE    ACTIVE                  YES, GO GET POLLING      SA41605 39100000
*                                        CHARACTERS             SA41605 39200000
         AR    R10,WORKREG6            POINT TO NEXT TNT INDEX  SA41605 39300000
*                                        FIELD                  SA41605 39400000
         SR    WORKREG7,R11            DECREMENT COUNT BY 1     SA41605 39500000
         LTR   WORKREG7,WORKREG7       HAVE ALL ACTIVE ENTRIES  SA41605 39600000
*                                        BEEN EXAMINED?         SA41605 39700000
         BZ    INACT2                  YES, GO SEARCH INACTIVE  SA41605 39800000
*                                        LIST                   SA41605 39900000
         AR    R10,WORKREG6            POINT TO NEXT TNT INDEX  SA41605 40000000
         B     NOINV                   CONTINUE SEARCH          SA41605 40100000
INACT2   EQU   *                                                SA41605 40200000
         TM    POLLFLAG,INACT          IS END OF INACTIVE       SA41605 40300000
*                                        LIST SCAN              SA41605 40400000
         BO    SCTROUT                 YES, GO GET LINE CONN    SA41605 40500000
         L     R5,INVADDR              GET INVITATION LIST ADDR SA41605 40600000
         SR    WORKREG7,WORKREG7       CLEAR REGISTER 7         SA41605 40700000
         SR    R11,R11                 CLEAR REG 11             SA41605 40800000
         IC    WORKREG7,D0(R5)         GET TOTAL NUMBER OF      SA41605 40900000
*                                        ENTRIES                SA41605 41000000
         IC    R11,D1(R5)              GET TOTAL NUMBER OF      SA41605 41100000
*                                        ACTIVE ENTRIES         SA41605 41200000
         SR    WORKREG7,R11            GET NUMBER OF INACTIVE   SA41605 41300000
*                                        ENTRIES                SA41605 41400000
         LTR   WORKREG7,WORKREG7       WERE ALL ENTRIES ACTIVE? SA41605 41500000
         BZ    SCTROUT                 YES, GO SET LINE CONN    SA41605 41600000
INACT1   EQU   *                                                SA41605 41700000
         TM    D3(R5),EOT              IS EOT SPECIFIED IN LIST SA41605 41800000
         BZ    NOEOT                   BRANCH AROUND INCREMENT  SA41605 41900000
         LA    R11,D1                  GET INCREMENT OF 1       SA41605 42000000
         AR    R10,R11                 INCREMENT OFFSET COUNT   SA41605 42100000
*                                        BY 1                   SA41605 42200000
NOEOT    EQU   *                                                SA41605 42300000
         TM    POLLFLAG,NOACT          ALL ENTRIES INACTIVE?    SA41605 42400000
         BNO   INACT5                  NO, ADD 1 TO OFFSET      SA41605 42500000
         LA    R1,D8                   SET REG 1 TO 8           SA41605 42600000
         B     INACT3                  BYPASS INCREMENT OF 9    SA41605 42700000
INACT5   EQU   *                                                SA41605 42800000
         LA    R1,D9                   SET REG1 TO 9            SA41605 42900000
INACT3   EQU   *                                                SA41605 43000000
         AR    R1,R5                   POINT PAST CONTROL WORD  SA41605 43100000
         AR    R1,R10                  POINT TO NEXT BYTE TO    SA41605 43200000
*                                        BE EXAMINED            SA41605 43300000
         CLI   D0(R1),LISTEND          END OF ACTIVE ENTRIED?   SA41605 43400000
         BE    BUMPCNT                 YES, GO INCREMENT OFFSET SA41605 43500000
         B     SCTROUT                 GO SET LINE CONN         SA41605 43600000
BUMPCNT  EQU   *                                                SA41605 43700000
         AR    R10,R11                 INCREMENT OFFSET COUNT   SA41605 43800000
*                                        BY 1                   SA41605 43900000
         AR    R10,WORKREG6            POINT TO TNT INDEX       SA41605 44000000
         OI    POLLFLAG,INACT          SET INDICATOR TO INACT-  SA41605 44100000
*                                        IVE LIST SCAN          SA41605 44200000
         TM    POLLFLAG,NOACT          ALL ENTRIES INACTIVE?    SA41605 44300000
         BNO   INACT4                  NO, BYPASS DECREMENT     SA41605 44400000
         SR    R10,R11                 DECREMENT COUNT BY 1     SA41605 44500000
INACT4   EQU   *                                                SA41605 44600000
         B     NOINV1                  GO CONTINUE SEARCH       SA41605 44700000
ACTIVE   EQU   *                                                SA41605 44800000
         BCT   WORKREG6,ACTIVE1        DECREMENT NUMBER OF              44900000
*                                        BYTES PER ENTRY BY 1   SA41605 45000000
ACTIVE1  EQU   *                                                SA41605 45100000
         SR    R10,WORKREG6            GET OFFSET TO POLL CHARS SA41605 45200000
         AR    R5,R10                  GET ADDRESS OF POLL CHARSSA41605 45300000
         STC   WORKREG6,CDS#POLL       STORE IN CDS INPUT AREA   S99528 45400000
         LTR   WORKREG6,WORKREG6       TEST FOR ZERO                    45500000
         BZ    SCTROUT                 GO TO SET ROUTINE         S99528 45600000
         BCTR  WORKREG6,0              DECREMENT COUNT BY ONE    S99528 45700000
         STC   WORKREG6,POLLMOVE+1      STORE IN MOVE INSTRUCTION       45800000
POLLMOVE MVC   CDSPOLL,D0(R5)          MOVE POLL CHARS TO CDS    S22024 45900000
         LA    WORKREG6,D1(WORKREG6)   RESTORE BYTE COUNT        S22024 46000000
         EJECT                                                          46100000
*********************************************************************** 46200000
*                                                                     * 46300000
* ROUTINE TO DETERMINE LINE CONNECTION CODE AND MOVE IT TO CDS * S99528 46400000
*                                                                     * 46500000
*********************************************************************** 46600000
SCTROUT  EQU   *                                                        46700000
         CLI   CDSADAP,CDSSDA1         IS ADAPTER TYPE SDA I?    S22024 46800000
         BE    CPUID                   GET CPU ID                S99528 46900000
         CLI   CDSADAP,CDSSDA2         IS ADAPTER TYPE SDA II?   S22024 47000000
         BE    CPUID                   GET CPU ID                S99528 47100000
         CLC   CDSTCUTY,TCU2702        IS TCU TYPE 2702?         S22024 47200000
         BE    LNCN02                  GET LINE CONN CODE        S99528 47300000
         MVI   CDSCONN,CDSDISEN        SET LINE CONNECTION       S22024 47400000
         B     CPUID                   GET CPU ID                S99528 47500000
LNCN02   EQU   *                                                 S22024 47600000
         TM    D17(UCBREG),SAD3        DOES UCB SPECIFY SAD 3?   S22024 47700000
         BO    SAD07                   GET CDSCONN               S99528 47800000
         BZ    SAD04                   GET CDS CONN              S99528 47900000
         TM    D17(UCBREG),SAD1        DOES UCB SPECIFIY SAD 1?  S22024 48000000
         BZ    SAD06                   GET CDSCONN               S22024 48100000
SAD05    EQU   *                                                 S22024 48200000
         MVI   CDSCONN,CDSDSAD1        SET LINE CONNECTION CODE  S22024 48300000
         B     CPUID                   GET CPU ID                S99528 48400000
SAD06    EQU   *                                                 S22024 48500000
         MVI   CDSCONN,CDSDSAD2        SET LINE CONNECTION CODE  S22024 48600000
         B     CPUID                   GET CPU ID                S99528 48700000
SAD07    EQU   *                                                 S22024 48800000
         MVI   CDSCONN,CDSDSAD3        SET LINE CONNECTION CODE  S22024 48900000
         B     CPUID                   GET CPU ID                S99528 49000000
SAD04    EQU   *                                                 S22024 49100000
         MVI   CDSCONN,CDSDSAD0        SET LINE CONNECTION CODE  S22024 49200000
         EJECT                                                          49300000
**********************************************************************  49400000
*        GET CPU ID AND MOVE TO CDS                            * S22024 49500000
*********************************************************************** 49600000
*                                                                       49700000
CPUID    EQU   *                                                        49800000
         L     R7,TERTABLE             GET ADDR OF TERM TABLE    S22024 49900000
         USING IEDQTRM,R7              ESTABLISH ADDRESSIBILITY  S22024 50000000
         TM    TRMDEVFL,BFDLAY         IS BUFFER DELAY SPECIFIED S22024 50100000
         BO    CPUID1                  YES, THEREFORE THERE ARE  S22024 50200000
*                                        NO CPU ID CHARS         S22024 50300000
         DROP  R7                                              @Y17XAUU 50400000
         L     WORKREG6,INVADDR        GET INV LIST ADR.                50500000
         LTR   WORKREG6,WORKREG6       IS THERE AN INVITATION    S22024 50600000
         BZ    UNDEF              NO - NO CPU ID DEFINED       @Y17XAUU 50700000
         TM    POLLFLAG,RNTRM          IS DEVICE ON 3705?        S22024 50800000
         BO    UNDEF                   YES, NO CPU ID            S22024 50900000
         L     WORKREG6,4(WORKREG6)    GET ADR OF CPUID FIELD.          51000000
         LTR   WORKREG6,WORKREG6       ADDR = 0?                        51100000
         BZ    UNDEF                   BRANCH IF YES.                   51200000
         MVC   CDS#ID(1),0(WORKREG6)   PUT # ID CHARS IN CDS     S99528 51300000
         MVC   CDSCPUID(15),1(WORKREG6) PUT CPU ID CHARS IN CDS  S99528 51400000
CPUID1   EQU   *                       BRANCH TARGET             S22024 51500000
         EJECT                                                          51600000
*********************************************************************** 51700000
*                                                                     * 51800000
*        ROUTINE TO CHECK IF TERMINAL IS BI-SYNC.  IF IT IS           * 51900000
*        BI-SYNC THE SPECIAL CHARACTERISTICS TABLE IS SEARCHED        * 52000000
*        FOR OLT SOH% TO FIND THE LINE CODE OF THE ADAPTER.           * 52100000
*                                                                     * 52200000
*********************************************************************** 52300000
         SPACE 2                                                        52400000
UNDEF    EQU   *                                                        52500000
         CLI   CDSADAP,CDSSDA2         IS LINE BI-SYNC?          S99528 52600000
         BNE   TERTYPE                 NO SKIP ROUTINE                  52700000
         CLI   OPENFLAG,LINEOPEN       IS LINE OPEN              S99528 52800000
         BNE   CODPRMPT                NO PROMPT FOR INFO        S99528 52900000
         L     WORKREG6,SCTADD         GET SCT ADDR                     53000000
         CLI   D13(WORKREG6),D0        IS THERE AN OLT OFFSET?   S22024 53100000
         BE    TERTYPE                 NO EXIT                          53200000
         SR    WORKREG7,WORKREG7       CLEAR R7                         53300000
         IC    WORKREG7,13(WORKREG6)   PICK UP OFFSET                   53400000
         LA    WORKREG7,1(WORKREG7,WORKREG6) GET ADDR OF OLT CHARS      53500000
         CLC   D0(D2,WORKREG7),CODEEBC IS CODE EBCDIC?           S22024 53600000
         BNE   UNDEF1                  NO BRANCH                        53700000
SETEBCDC MVI   CDSCODE,CDSEBCDC        SET CODE TO EBCDIC        S99528 53800000
         B     BYSNTYPE                CHECK TYPE TERMINAL       S99528 53900000
UNDEF1   EQU   *                                                        54000000
         CLC   D0(D2,WORKREG7),CODETRAN  IS CODE TRANSCODE?      S22024 54100000
         BNE   UNDEF2                  NO BRANCH                        54200000
SETTRANS MVI   CDSCODE,CDSTRANS        SET CODE TO TRANSCODE     S99528 54300000
         B     BYSNTYPE                CHECK TYPE TERMINAL       S99528 54400000
UNDEF2   EQU   *                                                        54500000
         CLC   D0(D2,WORKREG7),CODEASC IS LINE USASC?            S22024 54600000
         BNE   TERTYPE                 NO BRANCH                        54700000
SETASCII MVI   CDSCODE,CDSUSASC        SET CODE TO USASCII       S99528 54800000
         B     BYSNTYPE                CHECK TYPE TERMINAL       S99528 54900000
CODPRMPT EQU   *                       PROMPT FOR LINE ADAPT COD S99528 55000000
         IEDQMSG MSGID=107,FUNCT=REP                             S99528 55100000
         CLI   CEMSG,EBCDIC            IS LINE CODE EBCDIC       S99528 55200000
         BE    SETEBCDC                YES                       S99528 55300000
         CLI   CEMSG,USASCII           IS LINE CODE EBCDIC       S99528 55400000
         BE    SETASCII                YES                      S99528  55500000
         CLI   CEMSG,TRANSCOD          IS LINE CODE EBCDIC       S99528 55600000
         BE    SETTRANS                YES                       S99528 55700000
CODPRMT1 EQU   *                                                 S22024 55800000
         IEDQMSG MSGID=079,FUNCT=CEC                             S22024 55900000
         IEDQMSG MSGID=125,FUNCT=REP   WISH TO CONTINUE          S99528 56000000
         CLI   CEMSG,YES               YES RESPONSE              S99528 56100000
         BE    CODPRMPT                CONTINUE PROMPT           S99528 56200000
         CLI   CEMSG,NO                NO  RESPONSE              S99528 56300000
         BE    CLEANUP                 GO CLEANUP                S99528 56400000
         B     CODPRMT1                INVALID RESPONSE          S99528 56500000
         EJECT                                                          56600000
************************************************************** @YM07415 56700000
*                                                            * @YM07415 56800000
*        ROUTINE TO FIND 3705 DCB ADDRESS WHEN THE 3705 IS   * @YM07415 56900000
*        IN AN INACTIVE STATE.                               * @YM07415 57000000
*                                                            * @YM07415 57100000
************************************************************** @YM07415 57200000
NCPROMPT DS    0H                 BOUNDARY ALLIGNMENT          @YM07415 57300000
*        3705 NOT ACTIVE MESSAGE                               @YM07415 57400000
         IEDQMSG MSGID=086,FUNCT=CEC                           @YM07415 57500000
         SPACE                                                          57600000
NCPLOOP1 DS    0H                 BOUNDARY ALLIGNMENT          @YM07415 57700000
*        ENTER SYMBOLIC NAME OF NCP TO WHICH RESOURCE IS       @YM07415 57800000
*        ATTACHED                                              @YM07415 57900000
         IEDQMSG MSGID=124,FUNCT=REP,INBUF=CEMSG,INCNT=8       @XM05674 57950000
         SPACE                                                          58100000
         MVC   NCPNAME(D8),CEMSG  SAVE INPUT REPLY             @XM05674 58150000
         CLC   NCPNAME(D8),NULL   NAME ENTERED                 @YM07415 58200000
         BE    BADNAME            NO - WRITE ERROR MESSAGE     @YM07415 58300000
         L     R4,TOTAVTPT        GET AVT ADDRESS              @YM07415 58400000
         USING IEDQAVTD,R4        SET AVT ADDRESSABILITY       @YM07415 58500000
         SLR   R9,R9              CLEAR REG                    @YM07415 58600000
         LA    R6,NCPNAME         GET ADDRESS OF NCP NAME      @YM07415 58700000
BLNKTEST DS    0H                 BOUNDARY ALLIGNMENT          @YM07415 58800000
         CLI   D0(R6),BLANK       END OF NAME                  @YM07415 58900000
         BE    BLNKFIND           YES - LEN IS IN REG 9        @YM07415 59000000
         LA    R9,D1(R9)          INCREMENT NAME LEN COUNT     @YM07415 59100000
         LA    R6,D1(R6)          POINT TO NEXT CHARACTER      @YM07415 59200000
         C     R9,F8              SEARCH EXHAUSTED             @YM07415 59300000
         BE    BLNKFIND           YES - LEN IS IN REG 9        @YM07415 59400000
         B     BLNKTEST           CHECK NEXT CHARACTER         @YM07415 59500000
BLNKFIND DS    0H                 BOUNDARY ALLIGNMENT          @YM07415 59600000
         STH   R9,LENGTH          SAVE NAME LENGTH             @YM07415 59700000
         LA    R1,NCPNAME         GET NCP NAME                 @YM07415 59800000
         ALR   R1,R9              POINT TO END OF NAME         @YM07415 59900000
         CL    R9,F8              LENGTH AT MAXIMUM            @YM07415 60000000
         BE    TERSCH1            YES - EXIT                   @YM07415 60100000
         L     R15,F8             GET MAXIMUM LENGTH ALLOWED   @YM07415 60200000
         SLR   R15,R9             GET PAD COUNT                @YM07415 60300000
         EX    R15,BLMOVE         PAD THE NAME WITH BLANKS     @YM07415 60400000
TERSCH1  DS    0H                 BOUNDARY ALLIGNMENT          @YM07415 60500000
         L     R15,AVTMSGS-D1     VCON TABLE ADDRESS           @YM07415 60600000
         L     R15,D8(R15)        GET ADDRESS OF A1 ROUTINE    @YM07415 60700000
         LH    R0,LENGTH          GET NAME LENGTH              @YM07415 60800000
         LA    R1,NCPNAME         GET ADDRESS ON NAME          @YM07415 60900000
         BAL   R14,D4(R15)        VALIDATE NAME                @YM07415 61000000
         LTR   R15,R15            NAME VALID                   @YM07415 61100000
         BZ    BADNAME            NO - ERROR                   @YM07415 61200000
         SPACE                                                          61300000
         LR    R1,R15             GET TTCIN                    @YM07415 61400000
         L     R15,AVTRNMPT       TERM NAME TABLE ADDRESS      @YM07415 61500000
         BALR  R14,R15            FIND TTE ADDRESS             @YM07415 61600000
         LA    R15,TRMPRFSZ       SET TTE PREFIX SIZE          @YM07415 61700000
         SLR   R1,R15             POINT TO TTE PREFIX          @YM07415 61800000
         USING IEDNTRM,R1         SET TTE ADDRESSABILITY       @YM07415 61900000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @YM07415 62000000
         BZ    BADNAME            NO - ERROR                   @YM07415 62100000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @YM07415 62200000
         BNE   BADNAME            NO - ERROR                   @YM07415 62300000
         L     R6,TRMDESTQ-D1     GET QCB ADDRESS              @YM07415 62400000
         DROP  R1                                              @YM07415 62500000
         USING IEDQQCB,R6         SET QCB ADDRESSABILITY       @YM07415 62600000
         L     R6,QCBDCBAD-D1     GET DCB ADDRESS              @YM07415 62700000
         DROP  R6                                              @YM07415 62800000
         USING IHADCB,R6          SET DCB ADDRESSABILITY       @YM07415 62900000
         L     WORKREG8,DCBDEBAD  GET DEB ADDRESS              @YM07415 63000000
         LA    R7,D1              SET RLN                      @YM07415 63100000
         B     GETDEB             CONTINUE CONFIG PROCESSING   @YM07415 63200000
         SPACE                                                          63300000
BADNAME  DS    0H                 BOUNDARY ALLIGNMENT          @YM07415 63400000
*        INVALID NCP ENTRY                                     @YM07415 63500000
         IEDQMSG MSGID=126,FUNCT=CEC                           @YM07415 63600000
         SPACE                                                          63700000
RESPN    DS    0H                 BOUNDARY ALLIGNMENT          @YM07415 63800000
         IEDQMSG MSGID=125,FUNCT=REP WISH TO CONTINUE          @YM07415 63900000
         CLI   CEMSG,YES          YES                          @YM07415 64000000
         BE    NCPLOOP1           PROMPT FOR NCP NAME AGAIN    @YM07415 64100000
         CLI   CEMSG,NO           NO                           @YM07415 64200000
         BE    CLEANUP            CLEANUP AND GET OUT          @YM07415 64300000
         SPACE                                                          64400000
*        INVALID RESPONSE                                      @YM07415 64500000
         IEDQMSG MSGID=079,FUNCT=CEC,RET=RESPN                 @YM07415 64600000
         EJECT                                                          64700000
**************************************************************** S99528 64800000
*                                                              * S99528 64900000
*     ROUTINE TO PROMPT FOR LINE ADDRESS WHEN LINE NOT OPENED *  S99528 65000000
*     THE ADDRESS OF THE UCB IS FOUND AND PLACED IN UCBREG(5).   S99528 65100000
*     ADAPTER IS PLACED IN CDSADAP. LINE CONNECTION CODE IN    * S99528 65200000
*     CDSCONN.                                                 * S99528 65300000
*                                                              * S99528 65400000
**************************************************************** S99528 65500000
BYPASS   EQU   *                                                 S99528 65600000
         MVI   OPENFLAG,ZERO           SET LINE CLOSED INDICATOR S99528 65700000
*                                      SET UP WORKREG7           S99528 65800000
         BCTR  WORKREG7,0              CONVERT RLN SCALE         S99528 65900000
         SLL   WORKREG7,2              GET RLN BYTE OFFSET       S99528 66000000
         IEDQMSG MSGID=118,FUNCT=CEC                             S99528 66100000
BYPASS1 IEDQMSG MSGID=119,FUNCT=REP,INBUF=CEMSG,INCNT=4,               X66200000
               LINK=YES                                        @YA12402 66300000
UCBLOOK  L     WORKREG5,CVT(PARMREG0)  PICK UP CVT POINTER       S99528 66400000
         L     UCBPTREG,UCBPTR(WORKREG5)  6OAD PTR TO UCB TABLE  S99528 66500000
UCBLOOK1 LH    UCBREG,0(UCBPTREG)      LOAD UCB ADDR.            S99528 66600000
         LA    UCBPTREG,2(UCBPTREG)    POINT TO NEXT UCB         S99528 66700000
         LTR   UCBREG,UCBREG           UCB REG ZERO              S99528 66800000
         BZ    UCBLOOK1                PADDING; IGNORE ENTRY     S99528 66900000
         BC    4,UCBEND                END OF LIST; NO MATCH     S99528 67000000
         CLI   CEMSG+D3,BLANK           IS 4TH CHAR BLANK?     @YA12402 67100000
         BE    DIGIT3                   YES                    @YA12402 67200000
         CLI   CEMSG+D4,BLANK           MORE THAN 4 CHAR?      @YA12402 67300000
         BNE   UCBEND                   YES, INVALID LINE ADDR @YA12402 67400000
         CLC   CEMSG+D1(D3),D13(UCBREG) ADJUST FOR LEADING ZERO@YA12402 67500000
         B     UCBMATCH                 GO TAKE APPRO. BRANCH  @YA12402 67600000
DIGIT3   EQU   *                                               @YA12402 67700000
         CLC   CEMSG(3),13(UCBREG)     CUU MATCH?                S99528 67800000
UCBMATCH EQU   *                                               @YA12402 67900000
         BNE   UCBLOOK1                GO CHECK NEXT UCB ENTRY   S99528 68000000
UCBMOVE  MVC   CDSUNIT+CUUADR(LEN),CUUPTR(UCBREG) MOVE HEX CUU   S99528 68100000
         NI    CDSUNIT+CUUADR,LEFTCLR  CLEAR FLAG BITS           S99528 68200000
         B     CONTPRC2                GO TO CONTINUE PROCED     S99528 68300000
UCBEND   EQU   *                       INVALID LINE ADDRESS      S99528 68400000
         IEDQMSG MSGID=141,FUNCT=CEC   PRINT MSG                 S99528 68500000
CONTPROC IEDQMSG MSGID=125,FUNCT=REP   WISH TO CONTINUE?         S99528 68600000
         CLI   CEMSG,YES               YES                       S99528 68700000
         BE    BYPASS1                 GO TO BYPASS              S99528 68800000
         CLI   CEMSG,NO                NO                        S99528 68900000
         BE    CLEANUP                 GO TO CLEANUP GET OUT     S99528 69000000
CONTPRC1 EQU   *                       INVALID RESPONSE          S99528 69100000
         IEDQMSG MSGID=079,FUNCT=CEC,RET=CONTPROC                S22024 69200000
CONTPRC2 EQU   *                                                 S99528 69300000
         MVI   CDSCLASS,TERMCLAS       MOVE CLASS TO CDS         S99528 69400000
         LOAD  EP=IEDQWI5U             LOAD MODULE TO GET        S99528 69500000
         LR    ENTRYPT,PARMREG0             TCU TYPE             S99528 69600000
         BALR  RETURN,ENTRYPT               ADAPTER TYPE         S99528 69700000
         DELETE EP=IEDQWI5U            DELETE MODULE             S99528 69800000
         CLI   CDSRETFL,ZERO           WAS RETURN GOOD?          S99528 69900000
         BNE   CLEANUP                 NO, GET OUT               S99528 70000000
         CLI   CDSADAP,RNLU        SNA LU ENTRY                @YM07722 70030000
         BE    CONTPRC4            YES - GET RESOURCE ID       @YM07722 70060000
         CLI   CDSADAP,RNBISYN     BI-SYNCH ON 3704/3705         S22024 70100000
         BE    CONTPRC4            YES  GET RESOURCE ID          S22024 70200000
         CLI   CDSADAP,RNSS        START/STOP DEV ON 3704/3705   S22024 70300000
         BE    CONTPRC4            YES  GET RESOURCE ID          S22024 70400000
         CLI   CDSADAP,RNLINE      IS IT A COMM LINE ON 3704/3705S22024 70500000
        BE    CONTPRC4            YES  GET RESOURCE ID          S22024  70600000
CONTPRC3 EQU   *                   ESTABLISH BRANCH POINT        S22024 70700000
         CLI   CDSADAP,RNLU        SNA LU ENTRY                @YM07722 70730000
         BE    LINEONRN            YES, PROCESS                @YM07722 70760000
*                                                                S22024 70800000
         LOAD  EP=IEDQWI7              LOAD MODULE TO GET        S99528 70900000
         LR    ENTRYPT,PARMREG0             LINE TYPE            S99528 71000000
         BALR  RETURN,ENTRYPT               LINE CONNECTION CODE S99528 71100000
         DELETE EP=IEDQWI7             DELETE MODULE             S99528 71200000
         CLI   CDSRETFL,ZERO           WAS RETURN GOOD?          S99528 71300000
         BNE   CLEANUP                 NO, GET OUT               S99528 71400000
         B     GETSCT                  GO GET SCT ADDRESSS       S99528 71500000
CONTPRC4 EQU   *                   ESTABLISH BRANCH POINT        S22024 71600000
         CLI   OPENFLAG,ZERO       IS LINE OPEN                  S22024 71700000
         BNE   CONTPRC3            YES SO DONT ASK FOR RSID      S22024 71800000
*                                  ALREADY HAVE IT IN TTE        S22024 71900000
NETWADR  EQU   *                                               @Y17XAUU 72000000
         IEDQMSG MSGID=108,FUNCT=REP,INBUF=CEMSG,INCNT=4         S22024 72100000
         TCONV FROM=CEMSG,TO=CDSUNIT,COUNT=4,TYPE=EH             S22024 72200000
         B     CONTPRC3            NOW HAVE RSID CONTINUE        S22024 72300000
         EJECT                                                          72400000
*********************************************************************** 72500000
*                                                                     * 72600000
*  ROUTINE TO ASK CE TERMINAL TYPE, VERIFY IT, PUT IT INTO CDS * S22024 72700000
*  AND PLINK DEVICE CONFIGURATOR                                      * 72800000
*                                                                     * 72900000
*********************************************************************** 73000000
         SPACE 2                                                        73100000
TERTYPE  IEDQMSG MSGID=112,FUNCT=CEC   TERMINAL TYPES SUPPORTED  S99528 73200000
         IEDQMSG MSGID=113,FUNCT=CEC   ARE 1030,1050,1060,2740,  S99528 73300000
         MVI   TYPEFLAG,ZERO           SET START STOP INDICATOR  S99528 73400000
         LA    WORKREG7,3              SET UP ERROR COUNTER      S99528 73500000
         IEDQMSG MSGID=106,FUNCT=REP                             S99528 73600000
TERTYPE1 EQU   *                                                 S22024 73700000
         CLC   CEIN(D4),TERM1030       1030 SPECIFIED?           S22024 73800000
         BE    TYPEFIND                GO LOAD TYPE INTO CDS     S9952Y 73900000
         CLC   CEIN(D4),TERM1050       1050 SPECIFIED?           S22024 74000000
         BE    TYPEFIND                GO LOAD TYPE INTO CDS     S99528 74100000
         CLC   CEIN(D4),TERM1060       1060 SPECIFIED?           S22024 74200000
         BE    TYPEFIND                GO LOAD TYPE INTO CDS     S99528 74300000
         CLC   CEIN(D4),TERM2260       2260 SPECIFIED?           S22024 74400000
         BE    TYPEFIND                GO LOAD TYPE INTO CDS     S99528 74500000
         CLC   CEIN(D4),TERM2265       2265 SPECIFIED?           S22024 74600000
         BE    TYPEFIND                GO LOAD TYPE INTO CDS     S99528 74700000
         CLC   CEIN(D4),TERM2740       2740 SPECIFIED?           S22024 74800000
         BE    TYPEFIND                GO LOAD TYPE INTO CDS     S99528 74900000
         CLC   CEIN(D4),TERM2741       2741 SPECIFIED?           S22024 75000000
         BE    TYPEFIND                GO LOAD TYPE INTO CDS     S99528 75100000
         CLC   CEIN(D4),TERM2760       2760 SPECIFIED?           S22024 75200000
         BE    TYPEFIND                GO SET UNIT TYPE          S99528 75300000
         CLC   CEIN(D4),LINE3700       3705 RESOURCE           @Y17XAUU 75400000
         BE    TYPEFIND                GO SET UNIT TYPE        @Y17XAUU 75500000
         BCT   WORKREG7,ERROR2     DECREMENT COUNTER             S99528 75600000
         B     ERROR3                  BRANCH IF THIRD ERROR     S99528 75700000
BYSNTYPE MVI   TYPEFLAG,BSCTERM        SET BI SYNC INDICATOR     S99528 75800000
         IEDQMSG MSGID=114,FUNCT=CEC   BI SYNC TERMS SUPPORTED   S99528 75900000
         LA    WORKREG7,3              SET UP ERROR COUNTER      S99528 76000000
         IEDQMSG MSGID=106,FUNCT=REP   ENTER TERM TYPE           S99528 76100000
         CLC   CEIN(D4),TERM1130       1130 SPECIFIED?           S22024 76200000
         BE    STD2700                 GO SET STD RFT CNFG BIT   S99528 76300000
         CLC   CEIN(D4),TERM2020       MOD 20 SPECIFIED?         S22024 76400000
         BE    STD2700                 GO SET STD RFT CNFG BIT   S99528 76500000
         CLC   CEIN(D4),TERMS360       SYSTEM 360 SPECIFIED?     S22024 76600000
         BE    STD2700                 GO SET STD RFT CNFG BIT   S99528 76700000
         CLC   CEIN(D4),TERM2770       2770 SPECIFIED?           S22024 76800000
         BE    STD2700                 GO SET STD RFT CNFG BIT   S99528 76900000
         CLC   CEIN(D4),TERM2780       2780 SPECIFIED?           S22024 77000000
         BE    STD2700                 YES, GET STD BI SYNC CNFG S99528 77100000
         CLC   CEIN(D4),TERM3270       3270 SPECIFIED?           S22024 77200000
         BE    TYPEFIND                YES                       S99528 77300000
         CLC   CEIN(D4),TERM3670       3670 SPECIFIED?           S22024 77400000
         BE    STD2700                 GO SET STD RFT CNFG BIT   S99528 77500000
         CLC   CEIN(D4),LINE3700       3705 RESOURCE           @Y17XAUU 77600000
         BE    LINEONRN                YES - PROCESS           @Y17XAUU 77700000
         BCT   WORKREG7,ERROR2     DECREMENT COUNTER                    77800000
ERROR3   EQU   *                       TOO MANY TRIES, GET OUT   S99528 77900000
         OI    CDSRETFL,ERROR          SET ERROR FLAG            S22024 78000000
         IEDQMSG MSGID=142,FUNCT=CEC,RET=PLRET                   S99528 78100000
ERROR2   IEDQMSG MSGID=142,FUNCT=CEC                             S99528 78200000
ERROR4   EQU   *                                                 S22024 78300000
         IEDQMSG MSGID=125,FUNCT=REP                             S99528 78400000
         CLI   CEMSG,YES               YES                       S99528 78500000
         BE    CHKDEV                  GO CHECK DEVICE TYPE      S22024 78600000
         CLI   CEMSG,NO                IS ANSWER NO?             S22024 78700000
         BE    CLEANUP                 YES, GO TO EXIT           S22024 78800000
         B     ERROR4                  GO ASK QUESTION AGAIN     S22044 78900000
CHKDEV   EQU   *                                                 S22024 79000000
         CLI   TYPEFLAG,ZERO           IS TERMINAL START STOP    S99528 79100000
         BE    TERTYPE                 START STOP DEVICE         S99528 79200000
         B     BYSNTYPE                BI SYNC                   S99528 79300000
CLEANUP  EQU   *                                                 S99528 79400000
         OI    CDSRETFL,ERROR          SET INVALID RETURN FLAG   S22024 79500000
         B     PLRET                   GO RESTORE REGISTERS      S99528 79600000
STD2700  OI    CDSFNFLG,CDSSTDBS       SET 2700 FLG ON           S99528 79700000
TYPEFIND EQU   *                                                 S99528 79800000
         MVC   CDSTERM(TYPELEN),CEMSG  MOVE TERM TYPE TO CDS     S99528 79900000
         B     PLRET               RETURN TO CALLER              S22024 80000000
*                                                                S22024 80100000
#EXIT    DS    0H                  ALIGN FOR INSTRUCTION         S22024 80200000
         L     R15,$TABLE          GET START OF TABLE            S22024 80300000
         L     R15,D28(R15)        BUMP BY 28                    S22024 80400000
         BR    R15                 GO TO MACRO HANDLER           S22024 80500000
*                                                                S22024 80600000
LINEONRN EQU   *                   ESTABLISH BRANCH POINT        S22024 80700000
         MVC   CDSTERM(TYPELEN),LINE3700 MOVE IN SPECIAL NAME    S22024 80800000
*                                  FOR 3705 LINE CONFIGURATION   S22024 80900000
PLRET    EQU   *                                                 S99528 81000000
         L     SAVEAREA,OWN(SAVEAREA)  GET OLD SAVE AREA ADDR    S99528 81100000
         LM    R14,R12,12(SAVEAREA)    RESTORE REG               S99528 81200000
         BR    RETURN                  RETURN                    S99528 81300000
         EJECT                                                          81400000
QWI9SAVE DS    18F                     SAVE AREA                 S99528 81500000
OPENFLAG DC    CL1'0'                  OPEN LINE FLAG            S99528 81600000
TYPEFLAG DC    CL1'0'                  TERM TYPE FLAG            S99528 81700000
POLLFLAG DC    X'00'                   FLAG USED WHEN SCANNING  SA41605 81800000
*                                        FOR POLL CHARACTERS    SA41605 81900000
PATCH    DC    CL50' '                 MAINTAINENCE AREA         S99528 82000000
LINE3700 DC    C'3700'             NAME OF 3705 LINE CONFIG      S22024 82100000
*                                  MODULE FOR COMM LINES         S22024 82200000
*                                                                S22024 82300000
         DS    0F                                                       82400000
INVADDR  DS    F                       INVIT LIST                S99528 82500000
SCTADD   DS    F                       SCT ADDR                  S99528 82600000
CONCTTE  DS    F                        ADDRESS OF CONCENTRATOR  S99528 82700000
*                                         TERMINAL ENTRY         S99528 82800000
         SPACE 1                                                        82900000
*                                                              * S22024 83000000
*        SUPPORTED TERMINAL TYPES                              * S22024 83100000
*                                                              * S22024 83200000
TERM1030 DC    C'1030'                 1030 TERMINAL             S22024 83300000
TERM1050 DC    C'1050'                 1050 TERMINAL             S22024 83400000
TERM1060 DC    C'1060'                 1060 TERMINAL             S22024 83500000
TERM2260 DC    C'2260'                 2260 TERMINAL             S22024 83600000
TERM2265 DC    C'2265'                 2265 TERMINAL             S22024 83700000
TERM2740 DC    C'2740'                 2740 TERMINAL             S22024 83800000
TERM2741 DC    C'2741'                 2741 TERMINAL             S22024 83900000
TERM2760 DC    C'2760'                 2760 TERMINAL             S22024 84000000
TERM1130 DC    C'1130'                 1130 TERMINAL             S22024 84100000
TERM2020 DC    C'2020'                 2020 TERMINAL             S22024 84200000
TERMS360 DC    C'S360'                 S360 TERMINAL             S22024 84300000
TERM2770 DC    C'2770'                 2770 TERMINAL             S22024 84400000
TERM2780 DC    C'2780'                 2780 TERMINAL             S22024 84500000
TERM3270 DC    C'3270'                 3270 TERMINAL             S22024 84600000
TERM3670 DC    C'3670'                 3670 TERMINAL             S22024 84700000
         SPACE 1                                                        84800000
CODEASC  DC    X'0125'                 USASC INDICATION IN SCT   S22024 84900000
CODETRAN DC    X'002C'                 TRANSCODE INDICATION IN   S22024 85000000
*                                        SCT                     S22024 85100000
CODEEBC  DC    X'016C'                 EBCDIC CODE INDICATION IN S22024 85200000
*                                        SCT                     S22024 85300000
TCU2702  DC    C'2702'                 2702 TCU TYPE             S22024 85400000
TCU7770  DC    C'7770'                 TCU TYPE OF 7770          S22024 85500000
TWO      DC    H'2'                    ARITHMETIC VALUE 2        S22024 85600000
         SPACE                                                          85700000
F8       DC    F'8'               VALUE OF 8                   @Y17XAUU 85800000
NCPNAME  DS    CL8                PLACE FOR NCP SYM NAME       @YM07415 85900000
NULL     DC    8XL1'40'           BLANK FIELD                  @YM07415 86000000
LENGTH   DS    H                  LENGTH OF SYM NAME           @YM07415 86100000
BLMOVE   MVC   D0(D0,R1),NULL     PAD NAME FIELD               @YM07415 86200000
         EJECT                                                          86300000
         TTRMD                                                          86400000
         EJECT                                                          86500000
DCBDSECT DCBD  DSORG=TQ                                                 86600000
         OLTCB CONFG=YES               OLTCB DSECT               S99528 86700000
TERTABLE DS    F                        SAVE TTE ADDRESS       @OY20528 86750086
         TDEBD                                                          86800000
         EJECT                                                          86900000
         TLCBD                                                 @Y17XAUU 87000000
         EJECT                                                          87100000
         TQCBD                                                   S99528 87200000
         EJECT                                                          87300000
         TAVTD                                                   S99528 87400000
         EJECT                                                          87500000
         TTNTD                                                   S99528 87600000
         EJECT                                                          87700000
         TLGBD                                                   S22024 87800000
WORK2    EQU   CDSCODE                 PTR TO WORK AREA          S99528 88000000
CEMSG    EQU   TOTINBUF                EQU TO INPUT MESSAGE      S99528 88100000
CEIN     EQU   TOTINBUF                EQU TO INPUT MESSAGE      S99528 88200000
         END                                                            88300000
         EJECT                                                          88400000
         TDEBD                                                          88500000
         END                                                            88600000
