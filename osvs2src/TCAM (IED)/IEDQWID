         TITLE 'IEDQWID - CONFIGURATOR DELETE SCHEDULER'                00400020
IEDQWID  CSECT                                                   S22024 00700000
*CHANGE ACTIVITY AS FOLLOWS:                                            00770000
*D774500                                                         Y06330 00770105
*A775700                                                         Y06330 00770205
*D694000                                                        SA64780 00790254
*A455000                                                        SA64780 00810254
*A404000,626000,628000,654000,656000                           @YA12402 00810310
**************************************************************** S22024 00840000
*                                                              * S22024 00910000
* TITLE:                                                       * S22024 00980000
*                                                              * S22024 01050000
*    'IEDQWID - TOTE CONFIGURATOR DELETE/CHANGE SCHEDULER'     * S22024 01120000
*                                                              * S22024 01190000
* MODULE NAME:                                                 * S22024 01260000
*                                                              * S22024 01330000
*    IEDQWID                                                   * S22024 01400000
*                                                              * S22024 01470000
* DESCRIPTIVE NAME:                                            * S22024 01540000
*                                                              * S22024 01610000
*    TOTE CONFIGURATOR DELETE/CHANGE SCHEDULER                 * S22024 01680000
*                                                              * S22024 01750000
* COPYRIGHT:                                                   * S22024 01820000
*                                                              * S22024 01890000
*    'NONE'                                                    * S22024 01960000
*                                                              * S99528 02100022
* STATUS:                                                      * S99528 02300022
*                                                              * S99528 02500022
*    CHANGE LEVEL 5                                             Y06330* 02700005
*                                                              * S99528 02900022
* FUNCTION:                                                    * S99528 03100022
*    THIS MODULE HANDLES THE DELETION OF CONFIGURATION DATA    * S99528 03300022
*    FROM THE LOCAL AND REMOTE CONFIGURATION DATA SETS.  IT    * S99528 03500022
*    ALSO HANDLES CHANGE REQUESTS.                             * S99528 03700022
*                                                              * S99528 03900022
*    FOR 'DELETE' REQUESTS, THIS MODULE PROMPTS FOR THE LINE   * S99528 04100022
*    ADDRESS OR SYMBOLIC TERMINAL NAME.  FOR A LINE ADDRESS    * S99528 04300022
*    THIS MODULE DETERMINES IF THERE IS A VALID UCB.  VALID    * S99528 04500022
*    UCB'S ARE CHECKED FOR A DEVICE CLASS OF 10 OR 40.  FOR    * S99528 04700022
*    AN INVALID LINE ADDRESS AN ERROR MESSAGE IS SENT TO THE   * S99528 04900022
*    CONTROL TERMINAL.  FOR TERMINALS, IEDQWI8 IS LOADED TO    * S99528 05100022
*    DETERMINE IF THE SYMBOLIC NAME IS A VALID TCAM TERMINAL.  * S99528 05300022
*                                                              * S99528 05500022
*    FOR VALID ENTRIES, THE CDS IS DELETED FROM THE PDS        * S99528 05700022
*    DIRECTORY.  IF A MEMBER TO DELETE IS NOT FOUND IN THE     * S99528 05900022
*    DIRECTORY, A MESSAGE IS SENT TO THE CONTROL TERMINAL.     * S99528 06100022
*                                                              * S99528 06300022
*    FOR 'CHANGE' REQUESTS, THE SAME VALIDITY CHECKING         * S99528 06500022
*    DESCRIBED ABOVE IS PERFORMED.  IF THE ENTRY IS VALID,     * S99528 06700022
*    THIS MODULE ATTEMPTS TO FIND THE CDS RECORD.  IF A CDS    * S99528 06900022
*    RECORD DOES NOT EXIST, A MESSAGE IS SENT TO THE CONTROL   * S99528 07100022
*    TERMINAL.  OTHERWISE THE CDS RECORD IS PASSED TO MODULE   * S99528 07300022
*    IEDQWIA WHICH DETERMINES THE CHARACTERISTICS AND PASSES   * S99528 07500022
*    THE INFORMATION TO A UNIT CONFIGURATOR FOR FURTHER        * S99528 07700022
*    UPDATING.                                                 * S99528 07900022
*                                                              * S22024 08100000
* ENTRY POINTS:                                                * S99528 08300022
*                                                              * S99528 08500022
*         IEDQWID - RECEIVES CONTROL FROM IEDQWI VIA A 'XCTL'  * S99528 08700022
*                   WHEN AN 'DELETE' FUNCTION IS REQUESTED;    * S99528 08900022
*                                                              * S99528 09100022
*                 - RECEIVES CONTROL FROM IEDQWID OR IEDQWIA   * S99528 09300022
*                   VIA A 'XCTL' WHEN A 'CHANGE' FUNCTION IS   * S99528 09500022
*                   REQUESTED.                                 * S99528 09700022
*                                                              * S99528 09900022
* INPUT:                                                       * S99528 10100022
*                                                              * S99528 10300022
*    THE FOLLOWING REGISTERS ARE USED AS INPUT:                * S99528 10500022
*                                                              * S99528 10700022
*    02 - OLTCB POINTER;                                       * S99528 10900022
*    13 - SAVE AREA ADDRESS;                                   * S99528 11100022
*    15 - ENTRY POINT ADDRESS/RETURN CODE.                     * S99528 11300022
*                                                              * S99528 11500022
*    THE FOLLOWING OLTCB FIELD ARE USED AS INPUT:              * S99528 11700022
*                                                              * S99528 11900022
*    CDSWORK - 256 BYTE AREA TO CREATE CNFG RECORDS FOR ADD;   * S99528 12100022
*            - 256 BYTE AREA CONTAINING CDS RECORD FOR CHANGE; * S99528 12300022
*    CDSINPUT-  80 BYTE AREA TO PASS INFO BETWEEN MODULES;     * S99528 12500022
*    CDSBLDL -  40 BYTE AREA USED AS BLDL LIST FOR PDS;        * S99528 12700022
*    CDSCESD -  56 BYTE AREA CONTAINING CDS CESD RECORD;       * S99528 12900022
*    CDSCNTL -  20 BYTE AREA CONTAINING CDS CNTL RECORD;       * S99528 13100022
*    CDSFNFLG- FUNCTION FLAG: X'04' DELETE;                    * S99528 13300022
*                             X'16' CHANGE TERMINAL;           * S99528 13500022
*                             X'26' CHANGE LINE;               * S99528 13700022
*    CDSRETFL- RETURN CODE: X'00' VALID                        * S99528 13900022
*                           X'01' INVALID                      * S99528 14100022
*    TOTINBUF- 80 BYTE AREA FOR INPUT MESSAGES;                * S99528 14300022
*    TOTOTBUF- 80 BYTE AREA FOR OUTPUT MESSAGES;               * S99528 14500022
*    TOTSAVES- SAVE AREA FOR USE BY THIS MODULE.               * S99528 14700022
*                                                              * S99528 14900022
* OUTPUT:                                                      * S99528 15100022
*                                                              * S99528 15300022
*    THE FOLLOWING REGISTERS ARE USED FOR OUTPUT:              * S99528 15500022
*                                                              * S99528 15700022
*    02 - OLTCB POINTER;                                       * S99528 15900022
*    05 - UCB ADDRESS;                                         * S99528 16100022
*    13 - SAVE AREA ADDRESS;                                   * S99528 16300022
*    15 - ENTRY POINT ADDRESS.                                 * S99528 16500022
*                                                              * S99528 16700022
*    THE FOLLOWING OLTCB FIELDS ARE USED FOR OUTPUT:           * S99528 16900022
*                                                              * S99528 17100022
*    CDSWORK - 256 BYTE AREA TO CREATE CDS RECORD FOR ADD;     * S99528 17300022
*            - 256 BYTE AREA CONTAINING CDS RECORD FOR CHANGE; * S99528 17500022
*    CDSINPUT-  80 BYTE AREA CONTAINING LINE/TERMINAL DATA;    * S99528 17700022
*    CDSRETFL- RETURN CODE: X'00' VALID                        * S99528 17900022
*                           X'01' INVALID                      * S99528 18100022
* EXTERNAL ROUTINES:                                           * S99528 18500022
*                                                              * S99528 18700022
*         IEDQWIA - ADD SCHEDULER                              * S99528 18900022
*         IEDQWI5U- TCU/ADAPTER TYPE MODULE                    * S99528 19100022
*                                                              * S99528 19300022
*         IEDQWI8 - TERMINAL VERIFICATION MODULE               * S99528 19500022
*                                                              * S99528 19700022
*         IEDQWK  - MESSAGE MODULE                             * S99528 19900022
*                                                              * S99528 20100022
* EXITS, NORMAL:                                               * S99528 20300022
*         IEDQWI1 - XCTL AFTER 'EXIT' WHEN DELETE COMPLETE     * S99528 20500022
*         IEDQWIA - XCTL AFTER 'GETCHNG' FOR MORE CHANGES      * S99528 20700022
*         IEDQWI5U- BALR AFTER 'ADAPTYPE' FOR LINE ADD         * S99528 20900022
*                                                              * S99528 21100022
*         IEDQWI8 - BALR AFTER 'VALIDTER' FOR TERMINAL ADD     * S99528 21300022
*                                                              * S99528 21500022
* EXITS, ERROR                                                 * S99528 21700022
*                                                              * S99528 21900022
*         IEDQWI1 - XCTL AFTER 'EXIT' FOR CONFG TERMINATION    * S99528 22100022
*         ERROR RECOVERY - RETURN AFTER 'BADCDS' FOR SYNDAD RET* S99528 22300022
*                                                              * S99528 22500022
* TABLES/WORK AREAS:                                           * S99528 22700022
*                                                              * S99528 22900022
*    CDSWORK - WORK AREA USED TO PASS INFO BETWEEN MODULES AND * S99528 23100022
*              CREATE CDS RECORDS.                             * S99528 23300022
*                                                              * S99528 23500022
* CHARACTER CODE DEPENDENCY:                                   * S99528 23700022
*                                                              * S99528 23900022
*    NONE.                                                     * S99528 24100022
*                                                              * S99528 24300022
* NOTES:                                                       * S99528 24500022
*                                                              * S99528 24700022
*    NONE                                                      * S99528 24900022
*                                                              * S99528 25100022
**************************************************************** S99528 25300022
         EJECT                                                          26400020
*              EQUATES                                                  27200020
*                                                                       27600020
PARMREG0 EQU   0                       PARAMETER REGISTER        S99528 28400022
PARMREG1 EQU   1                       PARAMETER REGISTER        S99528 28600022
CUUADR   EQU   2                       OFFSET TO UNIT ADDRESS    S99528 28800022
R2       EQU   2                       OLTCB POINTER             S99528 29000022
BASREG   EQU   8                       IEDQWID BASE REGISTER     S99528 29200022
SAVEAREA EQU   13                      POINTER TO SAVE AREA      S99528 29400022
NEXTLOC  EQU   1                       OFFSET TO NEXT BYTE       S99528 29600022
NO       EQU   X'D5'                   NO RESPONSE               S99528 29800022
YES      EQU   X'E8'                   YES RESPONSE              S99528 30000022
GOODOPEN EQU   X'10'                   TEST FOR GOODOPEN         S99528 30200022
UAPTR    EQU   5                       UNIT ADDR POINTER         S99528 30400022
OPENFLAG EQU   48                      OFFSET TO DCB OPEN FLAGS  S99528 30600022
CDS40DCB EQU   7                       LOCAL DATA SET DCB PTR    S99528 30800022
CDS42DCB EQU   7                       REMOTE DATA SET DCB PTR   S99528 31000022
INPUTLEN EQU   78                      LEN OF CONFIG DATA        S99528 31200022
CDSLEN   EQU   255                     LEN OF CDS RECORD         S99528 31400022
GRAPHCLS EQU   X'10'                   GRAPHICS DEVICE CLASS     S99528 31600022
TCUCLASS EQU   X'40'                   TCU CLASS                 S99528 31800022
CHANGE   EQU   X'06'                   CHANGE REQUEST            S99528 32000022
TERMFLAG EQU   X'16'                   CHANGE TERMINAL REQUEST   S99528 32040022
LINEFLAG EQU   X'26'                   CHANGE LINE     REQUEST   S99528 32080022
DEVPTMSK EQU   X'40'                   DEVICE PROTECT MASK       S99528 32120022
CDSDPMSK EQU   X'20'                   DEV PROTECT CHK           S99528 32160022
NUMENTRY EQU   X'F0'                   NUMERIC ENTRY (LINE)      S99528 32200022
UCBDEVCL EQU   18                      OFFSET TO DEVICE CLASS    S99528 32400022
LEFTCLR  EQU   X'0F'                   MASK TO CLEAR LEFT BITS   S99528 32600022
SAVEADDR EQU   15                      SAVE ADDR PTR             S99528 32800022
RETCODE  EQU   15                      RETURN CODE REGISTER      S99528 33000022
ENTRYPT  EQU   15                      ENTRY POINT ADDRESS       S99528 33200022
LEN      EQU   2                       LEN OF UNIT ADR FLD       S99528 33400022
UNITLEN  EQU   3                       LEN OF UNIT ADDRESS       S99528 33600022
CUUPTR   EQU   4                       PTR TO UNIT ADR IN UCB    S99528 33800022
PREVSAVE EQU   4                       OFFSET TO PREV SAVE       S99528 34000022
GETOUT   EQU   X'01'                   TERMINATE FLAG            S99528 34200022
ZERO     EQU   X'00'                   ZERO CONSTANT             S99528 34400022
NAMELEN  EQU   8                       LEN OF SYMBOLIC NAME      S99528 34600022
R13      EQU   13                      REGISTER 13               S99528 34800022
R14      EQU   14                      RETURN ADDR REGISTER      S99528 35000022
R15      EQU   15                      ENTRY POINT REGISTER      S99528 35200022
UCBREG   EQU   5                       UCB POINTER               S99528 35400022
WORKREG6 EQU   6                       WORK REGISTER             S99528 35600022
WORKREG8 EQU   8                       WORK REGISTER             S99528 35800022
RETURN   EQU   9                       RETURN ADDRESS            S99528 36000022
CVT      EQU   16                      PTR TO CVT                S99528 36200022
UCBPTR   EQU   X'28'                   OFFSET TO UCB             S99528 36400022
UCBDVCLS EQU   18                      OFFSET TO UCB CLASS       S99528 36600022
WORKREG5 EQU   5                       WORK REGISTER             S99528 36800022
CHAR4    EQU   4                       CHAR MOVE CONST OF 4      S99528 38800022
CONCSELF EQU   X'E0'                   CONCENTRATOR ENTRY NAMED  S22024 39200000
SPECIAL  EQU   X'F0'                EXTENSIOT CDS INDICATOR      S22024 39600000
L4       EQU   4                   LENGTH FOR MOVE               S22024 40400000
BLANK    EQU   X'40'                    BLANK CHARACTER        @YA12402 40500010
D1       EQU   1                        CONSTANT 1             @YA12402 40600010
D3       EQU   3                        CONSTANT 3             @YA12402 40700010
D4       EQU   4                        CONSTANT 4             @YA12402 40800010
D13      EQU   13                       CONSTANT 13            @YA12402 40900010
         EJECT                                                          41200020
**************************************************************** S99528 41600022
*                                                              * S99528 41800022
*              INITIALIZATION                                  * S99528 42000022
*                                                              * S99528 42200022
**************************************************************** S99528 42400022
         SAVE  (14,12)                 SAVE REGISTERS            S99528 42600022
         LR    WORKREG8,R15            LOAD BASE                 S99528 42800022
         USING IEDQWID,WORKREG8        USE REG 8 FOR PRGM BASE   S99528 43000022
         USING TOTOLTCB,R2             USE REG 2 FOR OLTCB       S99528 43200022
IEDQWID  IEDHJN QWIDHJN,HJN            SET UP HJN                S99528 43300022
         LA    R15,SVAREA              LOAD ADDR OF OWN SAVE ARE S99528 43400022
         ST    R15,8(R13)              STORE IN CALLERS          S99528 43600022
         ST    R13,4(R15)              STORE CALLERS IN MINE     S99528 43800022
         LR    SAVEAREA,SAVEADDR       PLACE SAVE ADDR IN SAVE   S99528 44000022
         EJECT                                                          44200022
**************************************************************** S99528 44400022
*                                                              * S99528 44600022
*        C H A N G E / D E L E T E   L O G I C                 * S99528 44800022
*                                                              * S99528 45000022
**************************************************************** S99528 45200022
PROCDEL  EQU   *                       CLEAR CDS AREA            S99528 45400022
         CLOSE (CDS40,,CDS42)          INSURE CLOSE             SA64780 45500054
         MVI   CDSREC,ZERO             ZERO OUT FIRST LOCATION   S99528 45600022
         MVC   CDSREC+NEXTLOC(CDSLEN),CDSREC  ZERO OUT REST      S99528 45800022
         MVC   CDSINPUT(INPUTLEN),CDSREC  ZERO OUT WORK AREA     S99528 46000022
*                                      ENTER LINE ADDR OR SYMBOL S99528 46200022
         IEDQMSG MSGID=103,FUNCT=REP,INBUF=CEMSG,INCNT=8,              X46400022
               LINK=YES                                          S99528 46600022
         TM    CEMSG,NUMENTRY          WAS ENTRY A LINE ADDR?    S99528 46800022
         BO    DELLINE                 YES; GO TO DELETE LINE    S99528 47000022
         EJECT                                                          47200022
**************************************************************** S99528 47400022
*                                                              * S99528 47600022
*        D E L E T E   T E R M I N A L   P R O C E D U R E     * S99528 47800022
*                                                              * S99528 48000022
**************************************************************** S99528 48200022
DELTERM  EQU   *                       DELETE TERMINAL LOGIC     S99528 48400022
         MVC   CDSSYMBL(NAMELEN),CEMSG MOVE SYMBOLIC NAME TO CDS S99528 48600022
         LOAD  EP=IEDQWI8              VERIFY THAT NAME VALID    S99528 48800022
         LR    ENTRYPT,PARMREG0        GET ENTRYPT TO IEDQWI8    S99528 49000022
         BALR  RETURN,ENTRYPT          GO SEARCH TCAM TERMINALS  S99528 49200022
         DELETE EP=IEDQWI8             DELETE IEDQWI8            S99528 49400022
         CLI   CDSRETFL,SPECIAL    IS THIS AN EXTENSION CDS?     S22024 49460000
         BE    GOODNAM1            YES SET UP FOR IT             S22024 49520000
         CLI   CDSRETFL,ZERO           WAS SYMBOLIC NAME FOUND   S99528 49600022
         BE    GOODNAME                YES                       S99528 49800022
         CLI   CDSRETFL,CONCSELF       WAS CONCENTRATOR CONFIG   S22024 49840000
*                                        REQUESTED?              S22024 49880000
         BE    CHKFNFLG                YES, INVALID REQUEST - NO S22024 49920000
*                                        CONFIG ALLOWED          S22024 49960000
         MVI   CDSRETFL,ZERO           RESET RETURN FLAG         S99528 50000022
BADNAME  EQU   *                       INVALID TERMINAL NAME     S99528 50200022
         IEDQMSG MSGID=132,FUNCT=CEC,RET=CHKFNFLG                S99528 50400022
CONTPROC EQU   *                       DO YOU WISH TO CONTINUE?  S99528 50600022
         CLOSE CDS40                   CLOSE LOCAL DATA SET      S99528 50800022
         CLOSE CDS42                   CLOSE REMOTE DATA SET     S99528 51000022
         IEDQMSG MSGID=125,FUNCT=REP                             S99528 51200022
         CLI   CEMSG,YES                                         S99528 51400022
         BE    CHKFNFLG                YES RESPONSE              S99528 51600022
         CLI   CEMSG,NO                                          S99528 51800022
         BE    CLEANUP                 DO NOT CONTINUE           S99528 52000022
CONTPRC1 EQU   *                       INVALID RESPONSE          S99528 52200022
         IEDQMSG MSGID=079,FUNCT=CEC,RET=CONTPROC                S22024 52400022
CHKFNFLG EQU   *                       CHECK TYPE OF FUNCTION    S99528 52600022
         MVI   CDSRETFL,ZERO           RESET RETURN FLAG         S99528 52800022
         TM    CDSFNFLG,CHANGE         CHECK FUNCTION            S99528 53000022
         BM    DELMORE                 DELETE FUNCTION BRANCH    S99528 53200022
CHNGMORE EQU   *                       ARE THERE MORE CHANGES?   S99528 53400022
         IEDQMSG MSGID=121,FUNCT=REP                             S99528 53600022
         CLI   CEMSG,NO                MORE CHANGES?             S99528 53800022
         BE    EXIT                    NO, GO TO EXIT            S99528 54000022
         CLI   CEMSG,YES               MORE CHANGES?             S99528 54200022
         BNE   CONTPRC1                INVALID RESPONSE          S99528 54400022
         B     PROCDEL                 YES, GO GET NAME OR LINE  S99528 54600022
DELMORE  EQU   *                       OTHER DELETES?            S99528 54800022
         IEDQMSG MSGID=122,FUNCT=REP                             S99528 55000022
         CLI   CEMSG,YES               WAS RESPONSE YES          S99528 55200022
         BE    PROCDEL                 YES                       S99528 55400022
         CLI   CEMSG,NO                WAS RESPONSE NO           S99528 55600022
         BE    EXIT                    BRANCH TO EXIT            S99528 55800022
         IEDQMSG MSGID=079,FUNCT=CEC,RET=DELMORE                 S22024 56000022
*                                                                S22024 56030000
GOODNAM1 EQU   *                   BRANCH POINT                  S22024 56060000
         MVI   EXTENIP,SPECIAL     INDICATE EXTENSION CONFIGU    S22024 56090000
         MVC   LINEADDR(NAMELEN),CDSSYMBL MOVE IN SYMBOLIC NAME  S22024 56120000
         B     CHNGLINE             CONTINUE CONFIG RUN          S22024 56150000
GOODNAME EQU   *                                                 S99528 56200022
         MVC   CDSIDSAV(LEN),CDSREC SAVE RSID BEFORE READ COVERS S22024 56300000
         TM    CDSFNFLG,CHANGE         CHECK FUNCTION            S99528 56400022
         BM    CHNGTERM                DELETE, GO CHK DEV PRTCT  S99528 56500022
         MVI   CDSFNFLG,TERMFLAG       SET CHNG TERM FLG         S99528 56600022
         B     CHNGTERM                BRANCH CHNG TERM PROC     S99528 56700022
OPENC42  OPEN  (CDS42,(OUTPUT))        OPEN REMOTE DATA SET      S99528 56800022
         LA    CDS42DCB,CDS42          WAS OPEN SUCCESSFUL       S99528 57200022
         TM    OPENFLAG(CDS42DCB),GOODOPEN  TEST OPEN FLAG       S99528 57400022
         BZ    OPENERR                 OPENERR                   S99528 57600022
         MVC   CDSMEMBR(NAMELEN),CDSSYMBL  MOVE NAME TO BLDL LIS S99528 57800022
         STOW  CDS42,CDSBLDL,D         DELETE TERMINAL           S99528 58000022
CHKRETRN EQU   *                                                 S22024 58200000
         CH    RETCODE,SUCCESS         WAS DELETE SUCCESSFUL?    S22024 58300000
         BNE   CHKDIRCT                NO                        S99528 58400022
         IEDQMSG MSGID=115,FUNCT=CEC,RET=DELMORE 'ENTRY DELETED' S99528 58600022
CHKDIRCT CH    RETCODE,NOENTRY         WAS ENTRY MISSING FROM DI S99528 58800022
         BE    ENTRYMIS                YES                       S99528 59000022
*                                      UNABLE TO DELETE          S99528 59200022
         IEDQMSG MSGID=134,FUNCT=CEC,RET=CHKFNFLG                S99528 59400022
ENTRYMIS EQU   *                       ENTRY NOT FOUND           S99528 59600022
         IEDQMSG MSGID=137,FUNCT=CEC,RET=CHKFNFLG                S99528 59800022
         EJECT                                                          60000022
**************************************************************** S99528 60200022
*                                                              * S99528 60400022
*              D E L E T E   L I N E   P R O C E D U R E       * S99528 60600022
*                                                              * S99528 60800022
**************************************************************** S99528 61000022
DELLINE  EQU   *                                                 S99528 61200022
UCBLOOK  L     WORKREG5,CVT(PARMREG0)  PICK UP CVT POINTER       S99528 61400022
         L     WORKREG6,UCBPTR(WORKREG5)  POINTER TO 2 BYTE UCB  S99528 61600022
UCBLOOK1 LH    UCBREG,0(WORKREG6)      LOAD UCB ADDRESS          S99528 61800022
         LA    WORKREG6,2(WORKREG6)    POINT TO NEXT UCB ADDRESS S99528 62000022
         LTR   UCBREG,UCBREG                                     S99528 62200022
         BZ    UCBLOOK1                PADDING;IGNORE ENTRY      S99528 62400022
         BC    4,UCBEND                END OF LIST; NO MATCH     S99528 62600022
         CLI   CEMSG+D3,BLANK           IS 4TH CHAR BLANK?     @YA12402 62620010
         BE    DIGIT3                   YES                    @YA12402 62640010
         CLI   CEMSG+D4,BLANK           MORE THAN 4 CHAR?      @YA12402 62660010
         BNE   UCBEND                   YES INVALID LINE ADDR  @YA12402 62680010
         CLC   CEMSG+D1(D3),D13(UCBREG) ADJUST FOR ZERO        @YA12402 62700010
         B     UCBMATCH                 GO TAKE APPRO. BRANCH  @YA12402 62720010
DIGIT3   EQU   *                                               @YA12402 62740010
         CLC   CEMSG(3),13(UCBREG)     CUU MATCH?                S99528 62800022
UCBMATCH EQU   *                                               @YA12402 62900010
         BNE   UCBLOOK1                NO; GO CHECK NEXT UCB ENT S99528 63000022
         CLI   UCBDEVCL(UCBREG),TCUCLASS  CLASS EQUAL 40         S99528 63200022
         BE    GOODUCB                 VALID DEVICE CLASS        S99528 63400022
         CLI   UCBDEVCL(UCBREG),GRAPHCLS  CLASS EQUAL 10         S99528 63600022
         BE    GOODUCB                 VALID DEVICE CLASS        S99528 63800022
*                                      UNSUPPORTED DEVICE TYPE   S99528 64000022
         IEDQMSG MSGID=143,FUNCT=CEC,RET=CHKFNFLG                S99528 64200022
UCBEND   EQU   *                       INVALID LINE ADDR.        S99528 64400022
         IEDQMSG MSGID=141,FUNCT=CEC,RET=CHKFNFLG                S22024 64600000
GOODUCB  EQU   *                                                 S99528 64800022
         MVC   CDSUNIT+CUUADR(LEN),CUUPTR(UCBREG) MOVE VA TO CDS S99528 65000022
         NI    CDSUNIT+CUUADR,LEFTCLR  CLEAR FLAG BITS           S99528 65200022
         MVC   CDSCESNM(NAMELEN),MODPREFX  MOVE LINE ADDR PREFX  S99528 65400022
         CLI   CEMSG+D3,BLANK           IS 4TH CHAR BLANK?     @YA12402 65430010
         BE    MOVE3                    YES  3 CHAR CUU        @YA12402 65460010
         MVC   CDSCESNM+UAPTR(UNITLEN),CEMSG+D1  ADJUST PTR    @YA12402 65490010
         B     MOVEDON                  MOVE FINISHED          @YA12402 65520010
MOVE3    EQU   *                                               @YA12402 65550010
         MVC   CDSCESNM+UAPTR(UNITLEN),CEMSG  MOVE LINE ADDR.    S99528 65600022
MOVEDON  EQU   *                                               @YA12402 65700010
         MVC   CDSMEMBR(NAMELEN),CDSCESNM  MOVE NAME TO BLDLLST  S99528 65800022
         TM    CDSFNFLG,CHANGE         CHECK FUNCTION            S99528 66000022
         BM    CHNGLINE                GO CHANGE LINE            S99528 66100022
         MVI   CDSFNFLG,LINEFLAG       SET CHANGE LINE FLAG      S99528 66300022
         B     CHNGLINE                BRANCH CHANGE LINE PROC   S99528 66400022
GOODLINE EQU   *                                                 S99528 66600022
         OPEN  (CDS40,(OUTPUT))        OPEN LOCAL DATA DET       S99528 66800022
         LA    CDS40DCB,CDS40          WAS OPEN SUCCESSFUL       S99528 67000022
         TM    OPENFLAG(CDS40DCB),GOODOPEN                       S99528 67200022
         BZ    OPENERR                 OPEN ERROR                S99528 67400022
         STOW  CDS40,CDSBLDL,D         DELETE LINE FROM PDS      S99528 67600022
         B     CHKRETRN                GO CHK FUNCTION           S99528 67800022
         EJECT                                                          68000022
**************************************************************** S99528 68200022
*                                                              * S99528 68400022
*          C H A N G E   T E R M I N A L   P R O C E D U R E   * S99528 68600022
*                                                              * S99528 68800022
**************************************************************** S99528 69000022
CHNGTERM EQU   *                                                 S99528 69200022
         OPEN  (CDS42,(INPUT))         OPEN REMOTE DATA SET      S99528 69600022
         LA    CDS42DCB,CDS42                                    S99528 69800022
         TM    OPENFLAG(CDS42DCB),GOODOPEN  OPEN SUCCESSFUL?     S99528 70000022
         BZ    OPENERR                 NO; OPEN ERROR            S99528 70200022
         MVC   MODNAME(NAMELEN),CDSSYMBL GET SYMBL TERM NAME     S99528 70400022
         BLDL  CDS42,BLDLLIST                                    S99528 70500022
         LTR   RETCODE,RETCODE         CHECK RETURN CODE         S99528 70600022
         BNZ   FINDERR                 ERROR                     S99528 70800022
GETCDS42 EQU   *                                                 S99528 71000022
         MVC   CDSPOINT(CHAR4),USERTTR GET CDS TTR-C             S99528 71200022
         POINT CDS42,CDSPOINT          POINT TO CDS DATA         S99528 71500022
         READ  CDSDECB,SF,CDS42,CDSREC,256,MF=E  GET CDS DATA    S99528 71800022
         CHECK CDSDECB                 WAIT FOR I/O COMPLETION   S99528 72200022
         CLOSE CDS42                   CLOSE REMOTE DATA SET     S99528 72400022
         MVC   CDSREC(LEN),CDSIDSAV PUT RSID BACK IN DATA        S22024 72410000
         TM    CDSSIGNL,CDSDPMSK       IS DEV PROTECT BIT ON     S99528 72420022
         BZ    NO42PTCT                DEV PROTECT BIT OFF       S99528 72440022
         TM    TOTFLG09,TOTCTCON       IS SYSCON THE CNTL TERM   S99528 72460022
         BZ    DEVPRTCT                SYSCON IS NOT CNTL TERM   S99528 72480022
         OI    CDSFNFLG,DEVPTMSK       SET DEV PROTECT BIT ON    S99528 72500022
NO42PTCT TM    CDSFNFLG,CHANGE         IS THIS A CHANGE REQUEST  S99528 72520022
         BO    GETCHNG                 YES, PASS CDS INFO ON     S99528 72540022
         B     OPENC42                 NO, GO DELETE CDS ENTRY   S99528 72640022
         EJECT                                                          72800022
**************************************************************** S99528 73000022
*                                                              * S99528 73200022
*              C H A N G E   L I N E   P R O C E D U R E       * S99528 73400022
*                                                              * S99528 73600022
**************************************************************** S99528 73800022
CHNGLINE EQU   *                                                 S99528 74000022
         OPEN  (CDS40,(INPUT))         OPEN LOCAL DATA SET       S99528 74200022
         LA    CDS40DCB,CDS40          GET DCB ADDRESS           S99528 74400022
         TM    OPENFLAG(CDS40DCB),GOODOPEN  OPEN SUCCESSFUL?     S99528 74600022
         BZ    OPENERR                 NO; OPEN ERROR            S99528 74800022
         MVC   MODNAME(NAMELEN),LINEADDR    GET LINE CDS NAME    S99528 75000022
         BLDL  CDS40,BLDLLIST          FIND ENTRY                S99528 75100022
         LTR   RETCODE,RETCODE         CHECK RETURN CODE         S99528 75200022
         BNZ   FINDERR                 ERROR                     S99528 75400022
GETCDS40 EQU   *                                                 S99528 75600022
         MVC   CDSPOINT(CHAR4),USERTTR GET CDS TTR-C             S99528 75800022
         POINT CDS40,CDSPOINT          POINT TO CDS DATA         S99528 76200022
         READ  CDSDECB,SF,CDS40,CDSREC,256,MF=E  GET CDS DATA    S99528 76600022
         CHECK CDSDECB                 WAIT FOR I/O              S99528 77000022
         CLOSE CDS40                   CLOSE LOCAL DATA SET      S99528 77200022
         CLI   EXTENIP,SPECIAL     IS EXTENSION CONFIG IN PROCES S22024 77206000
         BE    NO40PTCT            YES CONTINUE                  S22024 77212000
         TM    CDSSIGNL,CDSDPMSK       IS DEV PROTECT BIT ON     S99528 77220022
         BZ    NO40PTCT                DEV PROTECT BIT OFF       S99528 77240022
         TM    TOTFLG09,TOTCTCON       IS SYSCON THE CNTL TERM   S99528 77260022
         BZ    DEVPRTCT                SYSCON IS NOT CNTL TERM   S99528 77280022
         OI    CDSFNFLG,DEVPTMSK       SET DEVICE PROTECT BIT ON S99528 77300022
NO40PTCT TM    CDSFNFLG,CHANGE         IS THIS A CHANGE REQUEST         77320022
         BO    ADAPTYPE                YES, PASS CDS INFO ON            77340022
         B     GOODLINE                NO, GO DELETE CDS ENTRY          77370022
ADAPTYPE EQU   *                                                 S99528 77400022
         CLI   EXTENIP,SPECIAL     IS EXTENSION CONFIG IN PROCES S22024 77500000
         BE    SPECNAME            YES CONTINUE                  S22024 77550000
         MVI   CDSRETFL,ZERO      ZERO OUT RETURN CODE           Y06330 77570005
         MVI   CDSCLASS,TCUCLASS       MOVE CLASS TO CDS         S99528 77600022
         LOAD  EP=IEDQWI5U             LOAD MODULE               S99528 77800022
         LR    ENTRYPT,PARMREG0        GET ENTRY PT OF MODULE    S99528 78000022
         BALR  RETURN,ENTRYPT          BRANCH TO MODULE          S99528 78200022
         DELETE EP=IEDQWI5U            DELETE MODULE             S99528 78400022
         CLI   CDSRETFL,ZERO           CHECK RETURN CODE         S99528 78600022
         BNE   CHKFNFLG                BRANCH IF RETURN IS BAD   S99528 78800022
         B     GETCHNG                 GO GET CHNG REC           S99528 79000022
SPECNAME MVC   CDSTCUTY(L4),TCU3705C MOVE IN NAME OF SPEC MODULE S22024 79060000
         B     GETCHNG             CONTINUE PROCESSING           S22024 79120000
         EJECT                                                          79200022
**************************************************************** S99528 79400022
*                                                              * S99528 79600022
*                       E X I T   P R O C E D U R E S          * S99528 79800022
*                                                              * S99528 80000022
**************************************************************** S99528 80200022
CLEANUP  EQU   *                       SET CLEANUP FLAG & EXIT   S99528 80400022
         MVI   CDSRETFL,GETOUT         SET FLAG                  S99528 80600022
EXIT     EQU   *                                                 S99528 80800022
         CLOSE CDS40                   CLOSE LOCAL CONFIG DATA   S99528 81000022
         CLOSE CDS42                   CLOSE REMOTE CNFIG DATA   S99528 81200022
         L     SAVEAREA,PREVSAVE(SAVEAREA)  ADDR.OF CALLERS      S99528 81400022
         LM    R14,R2,12(SAVEAREA)     RESTORE                   S99528 81600022
         XCTL  (2,12),EP=IEDQWI1       TRANSFER CONTROL          S99528 81800022
GETCHNG  EQU   *                                                 S99528 82000022
         L     SAVEAREA,PREVSAVE(SAVEAREA)  ADDR. OF CALLERS     S99528 82200022
         LM    R14,R2,12(SAVEAREA)     RESTORE REGISTERS         S99528 82400022
         XCTL  (2,12),EP=IEDQWIA       TRANSFER CONTROL          S99528 82600022
         EJECT                                                          82800022
**************************************************************** S99528 83000022
*                                                              * S99528 83200022
*        I / O   E R R O R   A N A L Y S I S   L O G I C       * S99528 83400022
*                                                              * S99528 83600022
**************************************************************** S99528 83800022
OPENERR  EQU   *                       OPEN ERROR PROCEDURE      S99528 84000022
         IEDQMSG MSGID=129,FUNCT=CEC,RET=CONTPROC                S99528 84200022
BADCDS   EQU   *                                                 S99528 84400022
         IEDQMSG MSGID=128,FUNCT=CEC                             S99528 84600022
         OI    CDSRETFL,GETOUT         SET TERMINATE FLAG        S99528 84800022
         B     EXIT                    GET OUT                   S99528 85000022
FINDERR  EQU   *                                                 S99528 85200022
*                                      DEVICE NOT CONFIGURED     S99528 85400022
         IEDQMSG MSGID=144,FUNCT=CEC,RET=CHKFNFLG                S99528 85600022
DEVPRTCT EQU   *                       DEL/MOD NOT PREMITTED     S99528 85660022
         IEDQMSG MSGID=117,FUNCT=CEC,RET=CHKFNFLG                S99528 85720022
         READ  CDSDECB,SF,MF=L                                   S99528 85800022
BASEADDR DC    AL4(IEDQWID)            BASE ADDRESS                     85900022
         EJECT                                                          86000022
PATCH    DS    0F                      MAINTENANCE AREA FOR      S99528 86200022
         DS    CL100                   TEMPERARY FIXES           S99528 86400022
BLDLLIST DC    XL2'0001'               NUMBER OF LIST ENTRIES    S99528 86600022
         DC    XL2'003A'               LENGTH OF EACH ENTRY      S99528 86800022
MODNAME  DC    XL8'0'                  MODULE NAME                      87000022
         DC    XL6'0'                  TTR-C                            87060022
USERTTR  DC    XL4'0'                  USER TTR-C                       87120022
         DC    XL48'0'                 ADDITIONAL DIRECTORY             87180022
CDSPOINT DS    0D                                                       87240022
         DC    XL8'0'                  POINTER TO CDS DATA       S99528 87300022
MODPREFX DC    CL8'G0000000'           MODULE PREFIX             S99528 87400022
         DS    0H                                                S99528 87600022
NOENTRY  DC    X'0008'                 NO ENTRY FOUND            S99528 87800022
SUCCESS  DC    X'0000'                 GOOD RETURN CODE FROM STOWS22024 88300000
EXTENIP  DC    X'00'               EXTENSION IN PROCESS FLAG     S22024 88800000
CDSIDSAV DC    X'0000'             SAVE AREA FOR RSID            S22024 89800000
TCU3705C DC    C'3705'             INSETT FOR UCA MODULE NAME    S22024 90800000
         EJECT                                                          93000022
CDS40    DCB   DDNAME=OLTLIB,DSORG=PO,RECFM=U,MACRF=(R,W),       Y06330X93200005
               SYNAD=BADCDS                                      Y06330 93400005
CDS42    DCB   DDNAME=CDSLIB,DSORG=PO,RECFM=U,MACRF=(R,W),       Y06330X93600005
               SYNAD=BADCDS                                      Y06330 93800005
         OLTCB CONFG=YES                                                94400022
CEMSG    EQU   TOTINBUF                                                 94600022
LINEADDR EQU   CDSMEMBR                                                 94800022
SVAREA   EQU   TOTSAVE5                                                 95000022
         END                                                            98000020
