QWQ      TITLE 'IEDQWQ - TOTE CECOM SERVICE MODULE'                     00100000
IEDQWQ   CSECT                                                          00200000
*A000000-999999                                                @Y16X5U0 00300000
*** THIS MODULE IS BEING RESEQUENCED AS OF TCAM 10.0           @Y17XAUU 00400000
* CHANGE ACTIVITY AS FOLLOWS:                                           00500000
*A096400,687884                                                 SA41592 00600000
*C688190-688210,688220-688320                                   SA41592 00700000
*D687948-687956                                                 SA41592 00800000
*A624000                                                        SA41598 00900000
*A120400,528000,625000,705000                                   SA41606 01000000
*C423000,540000,555000-558000,625000-630000                     SA41601 01100000
*D597000                                                        SA41601 01200000
*A687492-687494                                                 SA41601 01300000
*A687634                                                        SA41609 01400000
*C687604                                                        SA41609 01500000
*A687496-687498                                                 SA41613 01600000
*A014000,097100-097160,435600-437400,687471-687478               S22024 01700000
*A689562-689574,689630,726850                                    S22024 01800000
*C695900,728300                                                  S22024 01900000
*D689520                                                         S22024 02000000
*C384450,728914                                                  S05331 02100000
*D591000-600000                                                 SA64786 02200000
*D436800-437400                                                 SA64786 02300000
*A690800-690900                                                 SA64786 02400000
*C687891                                                       @YA06896 02500000
*A137000,279000,288000,327000,437700,486000,686600,687889,     @Y17XAUU 02600000
*A689280,689300,689420,689500,845000                           @Y17XAUU 02700000
*C691500,689500-689540,689300                                  @Y17XAUU 02800000
* A584000                                                      @G36XRUV 02830010
* C585000                                                      @G36XRUV 02860010
IEDQW37  EQU   *                                                 S99528 02900000
         ENTRY IEDQW37                                                  03000000
         SPACE 4                                                        03100000
**************************************************************** S99528 03200000
*                                                              * S99528 03300000
* MODULE NAME = IEDQWQ -ALIAS IEDQW37 (TCAM,TOTE)              @Y17XAUU 03400000
*                                                              *        03500000
* DESCRIPTIVE NAME = CECOM SERVICE MODULE                      *        03600000
*                                                              *        03700000
* COPYRIGHT = NONE                                             *        03800000
*                                                              *        03900000
* STATUS --                                                    * S99528 04000000
*    VERSION 10.0                                              @Y17XAUU 04100000
*                                                              * S99528 04200000
* FUNCTIONS --                                                 * S99528 04300000
*    THE PURPOSE OF THIS MODULE IS TO SERVICE REQUESTS FOR     * S99528 04400000
*    COMMUNICATION WITH THE CONTROL TERMINAL.                  * S99528 04500000
*                                                              * S99528 04600000
*    THE CECOM SERVICE MODULE PROCESSES THE CALLING ROUTINES   * S99528 04700000
*    PARAMETER LIST AND ROUTES OUTPUT REQUESTS TO THE CONTROL  * S99528 04800000
*    TERMINAL VIA THE ACCESS MANAGER ROUTINE. IF THE CONTROL   * S99528 04900000
*    TERMINAL IS THE SYSTEM CONSOLE ALL REPLIES ARE PLACED IN  * S99528 05000000
*    THE INPUT BUFFER OF THE OLTCB.  IF THE CONTROL TERMINAL   * S99528 05100000
*    IS A REMOTE TERMINAL IEDQWQ OBTAINS THE INPUT TEXT FROM   * S99528 05200000
*    THE TCAM BUFFER. THE BUFFER IS THEN RETURNED TO TCAM. IN  * S99528 05300000
*    ALL CASES INVOLVING REPLIES IEDQWQ TRANSLATES THE REPLY   * S99528 05400000
*    MESSAGE TO UPPER CASE AND MOVES IT TO THE CALLING ROUTINE * S99528 05500000
*    INPUT BUFFER.                                             * S99528 05600000
*                                                              * S99528 05700000
*    AT THE COMPLETION OF THIS ROUTINE, ONE OF THE FOLLOWING   * S99528 05800000
*    RETURN CODES IS PLACED IN REGISTER 15:                    * S99528 05900000
*         0 - GOOD RETURN                                      * S99528 06000000
*         4 - UNSUPPORTED FUNCTION OR MACRO LEVEL              * S99528 06100000
*         16 - FOR A 3705 PRE SNA TEST DEVICE, THE CONTROL     @Y17XAUU 06200000
*              TERMINAL EQU THE TEST TERMINAL OR IS ON THE     @Y17XAUU 06300000
*              SAME LINE AS THE TEST DEVICE. THE 3705 LINE     @Y17XAUU 06400000
*              IS STILL IN TEST MODE WHEN A CECOM WITH         @Y17XAUU 06500000
*              REPLY EXPECTED IS ISSUED BY THE OLT(REPLIES     @Y17XAUU 06600000
*              ARE NOT PERMITTED AT THIS TIME).                @Y17XAUU 06700000
*                                                              * S99528 06800000
* ENTRY POINTS --                                              * S99528 06900000
*    IEDQWQ - CALLED WHEN A CECOM MACRO IS ISSUED BY THE       * S99528 07000000
*    ON-LINE TEST PROGRAM. IEDQW37 IS AN ALIAS FOR THIS MODULE.* S99528 07100000
*                                                              @Y17XAUU 07200000
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 07300000
*                                                              @Y17XAUU 07400000
* MODULE TYPE -- PROCEDURE                                     @Y17XAUU 07500000
*                                                              @Y17XAUU 07600000
* MODULE SIZE -- 2K MAXIMUM                                    @Y17XAUU 07700000
*                                                              @Y17XAUU 07800000
* LINKAGE -- BALR R14,R15 FROM IEDQWA                          @Y17XAUU 07900000
*                                                              @Y17XAUU 08000000
* MACROS -- SAVE, IEDHJN, AQCTL, WAIT                          @Y17XAUU 08100000
*                                                              * S99528 08200000
* INPUT --                                                     * S99528 08300000
*    REGISTERS 01,02,03,13,14,15 CONTAIN THE FOLLOWING VALUES: * S99528 08400000
*                                                              * S99528 08500000
*         01 - CECOM PARAMETER LIST ADDRESS                    * S99528 08600000
*         02 - OLTCB AND SCT POINTER                           * S99528 08700000
*         03 - OLT SECTION PREFACE ADDRESS                     * S99528 08800000
*         13 - CALLER'S SAVE AREA ADDRESS                      * S99528 08900000
*         14 - RETURN ADDRESS                                  * S99528 09000000
*         15 - IEDQWQ ENTRY POINT ADDRESS                      * S99528 09100000
*                                                              * S99528 09200000
* OUTPUT --                                                    * S99528 09300000
*    REGISTER 15 CONTAINS THE RETURN CODE.                     * S99528 09400000
*    TOTRTCOD CONTAINS THE RETURN CODE.                        * S99528 09500000
*    THE OLT INPUT BUFFER CONTAINS THE REPLY IF IT IS EXPECTED.* S99528 09600000
*                                                              * S99528 09700000
* EXTERNAL REFERENCES --                                       * S99528 09800000
*    IEDQWO - ACCESS MANAGER ROUTINE TO HANDLE                 * S99528 09900000
*             INPUT/OUTPUT REQUESTS.                           * S99528 10000000
*                                                              * S99528 10100000
* EXITS,NORMAL --                                              * S99528 10200000
*    CONTROL IS PASSED TO THE CALLING PROGRAM IF THE RETURN    * S99528 10300000
*    CODE IS ZERO AND THE TRACE FUNCTION IS NOT REQUESTED.     * S99528 10400000
*                                                              * S99528 10500000
* EXITS,ERROR --                                               * S99528 10600000
*    CONTROL IS PASSED TO IEDQWM2 (TRACE PROGRAM) IF ANY OF    * S99528 10700000
*    CONDITIONS HOLD.                                          * S99528 10800000
*                                                              * S99528 10900000
*         THE TRACE FUNCTION IS REQUESTED.                     * S99528 11000000
*         THE RETURN CODE FUNCTION IS REQUESTED AND THE        * S99528 11100000
*           RETURN CODE IS NONZERO.                            * S99528 11200000
*         THE MACRO LEVEL OF THE REQUEST IS WRONG.             * SÊ9528 11300000
*                                                              * SÊ9528 11400000
* TABLES/WORK AREA --                                          * S99528 11500000
*    OLTCB,LCB,SCB,PRF,AVT,IOBLOCKS,UCB                        * S99528 11600000
*                                                              * S99528 11700000
* ATTRIBUTES --                                                * S99528 11800000
*    ENABLED, PROBLEM PROGRAM MODE, RESIDENT, REENTRANT        @Y17XAUU 11900000
*                                                              * S99528 12000000
* NOTES -- SEE BELOW                                           @Y17XAUU 12100000
*                                                              * S99528 12200000
*  RESTRICTIONS--NONE                                          @Y17XAUU 12300000
*                                                              @Y17XAUU 12400000
*  REGISTERS CONVENTION--SEE REGISTERS ASSIGNMENT              @Y17XAUU 12500000
*                                                              @Y17XAUU 12600000
*  DEPENDENCIES--EBCDIC CHARACTER CODE SET                     @Y17XAUU 12700000
*                                                              @Y17XAUU 12800000
*  PATCH LABEL--PATCH                                          @Y17XAUU 12900000
*                                                              @Y17XAUU 13000000
**************************************************************** S99528 13100000
         EJECT                                                          13200000
*                                                                     * 13300000
*        E Q U A T E S                                                  13400000
*                                                                S99528 13500000
R0       EQU   0                  REGISTER 0                     S99528 13600000
R1       EQU   1                  REGISTER 1                     S99528 13700000
R2       EQU   2                  REGISTER 2                     S99528 13800000
R3       EQU   3                  REGISTER 3                     S99528 13900000
R4       EQU   4                  REGISTER 4                     S99528 14000000
R5       EQU   5                  REGISTER 5                     S99528 14100000
R6       EQU   6                  REGISTER 6                     S99528 14200000
R7       EQU   7                  REGISTER 7                     S99528 14300000
R8       EQU   8                  REGISTER 8                     S99528 14400000
R9       EQU   9                  REGISTER 9                     S99528 14500000
R10      EQU   10                 REGISTER 10                    S99528 14600000
R11      EQU   11                 REGISTER 11                    S99528 14700000
R12      EQU   12                 REGISTER 12                    S99528 14800000
R13      EQU   13                 REGISTER 13                    S99528 14900000
R14      EQU   14                 REGISTER 14                    S99528 15000000
R15      EQU   15                 REGISTER 15                    S99528 15100000
         SPACE                                                          15200000
ONE      EQU   1                  VALUE OF 1                     S99528 15300000
TWO      EQU   2                  VALUE OF 2                     S99528 15400000
THREE    EQU   3                  VALUE OF 3                     S99528 15500000
FOUR     EQU   4                  VALUE OF 4                     S99528 15600000
EIGHT    EQU   8                  VALUE OF 8                     S99528 15700000
NINE     EQU   9                  VALUE OF 9                     S99528 15800000
SIXTN    EQU   16                 VALUE OF 16                    S99528 15900000
MI       EQU   X'80'              MANUAL INTERVENTION            S99528 16000000
TERM     EQU   X'40'              LAST ROUTINE                   S99528 16100000
ZERO     EQU   0                  VALUE OF ZERO                  S99528 16200000
TEN      EQU   10                 VALUE OF TEN                   S99528 16300000
TWELVE   EQU   12                 VALUE OF TWELVE                S99528 16400000
MINUS    EQU   X'FF'              MASK OF 255                    S99528 16500000
LIMIT    EQU   80                 MAXLENGTH OF CECOM MSG ALLOWED S99528 16600000
TPOSTE   EQU   X'80'              END OF REQ. ELEMENT           SA41592 16700000
TRMTERM  EQU   X'10'              SEC. CONTROL TERMINAL         SA41592 16800000
TPOSTA   EQU   X'0C'              FIRST ELEMENT                 SA41592 16900000
XFF      EQU   X'FF'              MASK ALL BITS                  S22024 17000000
RQINIT   EQU   X'0C'              START OF LIST                  S22024 17100000
RQEND    EQU   X'80'              END OF LIST                    S22024 17200000
         SPACE                                                          17300000
D0       EQU   0                  DISP OF 0                      S99528 17400000
D1       EQU   1                  DISP OF 1                      S99528 17500000
D2       EQU   2                  DISP OF 2                      S99528 17600000
D3       EQU   3                  DISP OF 3                      S99528 17700000
D4       EQU   4                  DISP OF 4                      S99528 17800000
D5       EQU   5                  DISP OF 5                      S99528 17900000
D6       EQU   6                  DISP OF 6                      S99528 18000000
A        EQU   X'C1'              CHARACTER A                    S99528 18100000
TPAR1    EQU   X'0C'              TPOST FLAG 1                   S99528 18200000
TPAR2    EQU   X'80'              TPOST FLAG 2                   S99528 18300000
D7       EQU   7                  DISP OF 7                      S99528 18400000
D8       EQU   8                  DISP OF 8                      S99528 18500000
D9       EQU   9                  DISP OF 9                      S99528 18600000
D10      EQU   10                 DISP OF 10                     S99528 18700000
D11      EQU   11                 DISP OF 11                     S99528 18800000
D12      EQU   12                 DISP OF 12                     S99528 18900000
D13      EQU   13                 DISP OF 13                     S99528 19000000
D14      EQU   14                 DISP OF 14                     S99528 19100000
D15      EQU   15                 DISP OF 15                     S99528 19200000
D16      EQU   16                 DISP OF 16                     S99528 19300000
D17      EQU   17                 DISP OF 17                     S99528 19400000
D18      EQU   18                 DISP OF 18                     S99528 19500000
D19      EQU   19                 DISP OF 19                     S99528 19600000
D20      EQU   20                 DISP OF 20                     S99528 19700000
D24      EQU   24                 DISP OF 24                     S99528 19800000
D28      EQU   28                 DISP OF 28                     S99528 19900000
D32      EQU   32                 DISP OF 32                     S99528 20000000
D36      EQU   36                 DISP OF 36                     S99528 20100000
D40      EQU   40                 DISP OF 40                     S99528 20200000
D79      EQU   79                 DISP OF 79                    SA41901 20300000
ANR      EQU   X'1E'              ANR LOCAL                      S99528 20400000
XF0      EQU   X'F0'              LCB FLAG MASK                  S99528 20500000
MACLEV   EQU   X'02'              MACRO LEVEL FOR THIS MODULE    S99528 20600000
BADLEV   EQU   X'04'              UNSUPT'D FTN RETURN CODE       S99528 20700000
OTWTOR   EQU   X'E0'              REQ. FOR OUTSTANDING WTOR      S99528 20800000
CECNT    EQU   62                 MAXIMUM INPUT COUNT            S99528 20900000
LINBUF   EQU   X'50'              LENGTH OF OUTPUT BUFFER        S99528 21000000
BLANKA   EQU   X'40'              BLANK CHARACTER                S99528 21100000
MULBUF   EQU   X'14'              MULTIPLE BUFFER PREFIX         S22024 21200000
PREFIX   EQU   C'I'               MSG PREFIX                     S22024 21300000
DECL     EQU   C'I'               MSG SUFFIX (NO REPLY)          S22024 21400000
REPLY    EQU   C'D'               MSG SUFFIX (REPLY)             S22024 21500000
RQPRI    EQU   X'DC'              POST PRIORITY TO OP CTL      @Y17XAUU 21600000
RQELNG   EQU   X'18'              POST ELEMENT LENGTH          @Y17XAUU 21700000
DISREG2  EQU   28                 DISPLACEMENT TO REG 2        @Y17XAUU 21800000
LUTYPE   EQU   X'1C'              INPUT IS FROM A LU           @Y17XAUU 21900000
ERRCD16  EQU   X'10'              ERROR RETURN CODE - LINE IN  @Y17XAUU 22000000
*                                 TEST MODE FOR A CECOM WITH   @Y17XAUU 22100000
*                                 REPLY EXPECTED               @Y17XAUU 22200000
         EJECT                                                          22300000
         USING IEDQWQ,R15                                               22400000
*                                                                       22500000
IEDQWQ    IEDHJN STARQ,HJN                                       S99528 22600000
*                                                                       22700000
         DROP  R15                                                      22800000
         USING IEDQWQ,R4                                                22900000
*                                                                       23000000
         USING TOTOLTCB,R2                                              23100000
         SPACE                                                          23200000
         SAVE  (14,12)                                           S99528 23300000
         SPACE                                                          23400000
         LR    R4,R15             SET BASE REGISTER              S99528 23500000
         LA    R15,TOTSAVE1       GET ADDR. OF OWN SAVE AREA     S99528 23600000
         ST    R15,D8(R13)        PUT ADDR. IN CALLER'S SAVE     S99528 23700000
         ST    R13,D4(R15)        SAVE ADDR OF CALLER'S SAVE     S99528 23800000
         LR    R13,R15            POINT REG 13 TO MY SAVE AREA   S99528 23900000
         SPACE                                                          24000000
         NI    TOTFLG05,MINUS-TOTEXIOF-TOTCECOM CLEAR ACCESS     S99528 24100000
         NI    TOTFLG05,MINUS-TOTPRINT-TOTREPLY FLAGS            S99528 24200000
         LR    R11,R1             SAVE P-LIST ADDR               S99528 24300000
         LA    R5,D17(R1)         POINT TO CECOM FLAG            S99528 24400000
         CLI   D1(R1),MACLEV      CORRECT MACRO LEVEL            S99528 24500000
         BE    CEC001             YES                            S99528 24600000
         SPACE                                                          24700000
         LA    R15,BADLEV         SET FTN NOT AVAIL RET CODE     S99528 24800000
         STC   R15,TOTRTCOD       SAVE RETURN CODE               S99528 24900000
         SPACE                                                          25000000
CE005    EQU   *                                               @Y17XAUU 25100000
         L     R13,D4(R13)        RESTORE CALLER'S SAVE AREA ADR S99528 25200000
         L     R14,D12(R13)       RESTORE RETURN ADDR            S99528 25300000
         L     R15,TOTRESPL       GET RESPL ADDRESS            @Y17XAUU 25400000
         USING RESPL,R15          SET RESPL ADDRESSABILITY     @Y17XAUU 25500000
         L     R15,RESPLM2        GET ADDRESS OF TRACE ROUTINE @Y17XAUU 25600000
         LM    R2,R12,DISREG2(R13) RESTORE CALLER'S REG        @Y17XAUU 25700000
         DROP  R15                                             @Y17XAUU 25800000
         BR    R15                EXIT TO IEDQWM2              @Y17XAUU 25900000
         SPACE 4                                                        26000000
CEC001   EQU   *                                                 S99528 26100000
         TM    D0(R5),OTWTOR      REQUEST FOR OUTSTANDING WTOR   S99528 26200000
         BZ    CEC003             BR IF NO                       S99528 26300000
         SPACE                                                          26400000
CEC002   EQU   *                                                 S99528 26500000
         OI    TOTFLG09,TOTMACFT  SET UNSUPPORTED MACRO FTN FLAG S99528 26600000
         LA    R15,BADLEV         SET FUNCTION NOT AVAIL RET CODES99528 26700000
         STC   R15,TOTRTCOD       SAVE RETURN CODE               S99528 26800000
         B     CE005              REPORT ERROR                 @Y17XAUU 26900000
         SPACE 4                                                        27000000
CEC003   EQU   *                                                 S99528 27100000
         MVI   TOTRTCOD,ZERO      SET RETURN CODE                S99528 27200000
         SPACE                                                          27300000
CEC004   EQU   *                                                 S99528 27400000
         SR    R15,R15            CLEAR RETURN CODE REG.         S99528 27500000
         OI    TOTFLG05,TOTCECOM  SET CECOM REQUEST FLAG         S99528 27600000
         L     R10,D4(R1)         GET OUT MSG ADDR               S99528 27700000
         L     R9,D8(R1)          GET OUT MSG COUNT              S99528 27800000
         LTR   R9,R9              ZERO COUNT                     S99528 27900000
         BZ    CEC054             YES                            S99528 28000000
         SPACE                                                          28100000
         LA    R5,LIMIT           GET MAX NO. BYTES ALLOWED      S99528 28200000
         CR    R9,R5              IS COUNT > LIMIT               S99528 28300000
         BNH   CEC008             BRANCH IF NO                   S99528 28400000
         SPACE                                                          28500000
         LR    R9,R5              SET COUNT = LIMIT              S99528 28600000
         SPACE                                                          28700000
CEC008   EQU   *                                                 S99528 28800000
         MVI   TOTOTBUF,BLANKA    CLEAR OUTPUT                   S22024 28900000
         MVC   TOTOTBUF+D1(D79),TOTOTBUF BUFFER                  S22024 29000000
         L     R3,TOTOLTEN        START OF OLT                   S22024 29100000
         USING PSPREF,R3                                         S22024 29200000
         MVC   MSGIDSV(D2),$MSGIDAC  SAVE OLT COMPONENT ID       S05331 29300000
         LH    R14,RTNDISP        DISP TO RTN#                   S22024 29400000
         AR    R3,R14             POINT TO RTN#                  S22024 29500000
         DROP  R3                                                S22024 29600000
         USING SPREF,R3                                          S22024 29700000
         TM    #FLAG,#MSGIDRQ     MSGID PROVIDED                 S22024 29800000
         BZ    CEC010             NO                             S22024 29900000
         DROP  R3                                                S22024 30000000
*        BUILD OLT UNIQUE MESSAGE COMPONENT ID                   S22024 30100000
         MVI   TOTOTBUF,PREFIX    MSG PREFIX                     S22024 30200000
         MVC   TOTOTBUF+D1(D2),MSGIDSV OLT COMPONENT ID          S22024 30300000
         MVC   TOTOTBUF+D3(D3),D0(R10) MSG NUMBER                S22024 30400000
         MVI   TOTOTBUF+D6,DECL   SET MSG SUFFIX (NO REPLY)      S22024 30500000
         L     R3,D16(R11)        GET XPTD IN MSG COUNT          S22024 30600000
         LTR   R3,R3              REPLY EXPECTED                 S22024 30700000
         BZ    CEC009             NO                             S22024 30800000
         MVI   TOTOTBUF+D6,REPLY  SET MSG SUFFIX (REPLY)         S22024 30900000
CEC009   DS    0H                 BOUNDARY ALLIGNMENT            S22024 31000000
         LA    R9,D5(R9)          ADJUST MSG COUNT               S22024 31100000
         STC   R9,TOTOTCNT        SET OUTPUT COUNT                      31200000
         L     R9,D8(R1)          OUTMSG COUNT                   S22024 31300000
         S     R9,F4              ADJUST FOR MOVE                S22024 31400000
         C     R9,F0              EX COUNT < 0                   S22024 31500000
         BL    CEC054             YES - NO DATA PRESENT          S22024 31600000
         EX    R9,MSGMOVE1        MOVE MSG TO OUTPUT BUFFER      S22024 31700000
         B     CEC011             CONTINUE                       S22024 31800000
CEC010   DS    0H                 BOUNDARY ALLIGNMENT            S22024 31900000
         STC   R9,TOTOTCNT        PUT OUT MSG CNT IN OLTCB       S99528 32000000
         EX    R9,CEC080          MOVE OUT MSG TO OLTCB          S99528 32100000
CEC011   DS    0H                 BOUNDARY ALLIGNMENT            S22024 32200000
         SPACE                                                          32300000
         L     R9,D12(R1)         GET IN MSG ADDR                S99528 32400000
         LTR   R9,R9              ANY IN MSG                     S99528 32500000
         BZ    CEC012             BRANCH IF NO                   S99528 32600000
         SPACE                                                          32700000
         L     R10,D16(R11)       GET XPTD IN MSG COUNT          S99528 32800000
         LTR   R10,R10            IS COUNT ZERO                  S99528 32900000
         BZ    CEC012             BRANCH IF NO                   S99528 33000000
         SPACE                                                          33100000
         OI    TOTFLG05,TOTREPLY  SET REPLY FLAG                 S99528 33200000
         MVI   TOTINBUF,BLANKA    CLEAR INPUT BUFFER            SA41601 33300000
         MVC   TOTINBUF+D1(D79),TOTINBUF                        SA41601 33400000
         SPACE                                                          33500000
*                                                                S99528 33600000
*        S E T  U P  F O R  S T A R T  L I N E                   S99528 33700000
*                                                                S99528 33800000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSCON                  S22024 33900000
         BO    CEC012             YES                            S22024 34000000
         NI    TOTFLG09,XFF-TOTLNCON TURN OFF LINE CONN FLAG     S22024 34100000
         TM    TOTFLG02,TOTTSST   CT LINE IN TEST MODE         @Y17XAUU 34200000
         BZ    CEC0EX             NO - CONTINUE                @Y17XAUU 34300000
         LA    R15,ERRCD16        SET ERROR RETURN CODE        @Y17XAUU 34400000
         STC   R15,TOTRTCOD       SAVE RETURN CODE             @Y17XAUU 34500000
         B     CEC054             EXIT                         @Y17XAUU 34600000
CEC0EX   EQU   *                                               @Y17XAUU 34700000
         MVI   TOTOVBCD,LINESTRT  SET VERB CODE FOR START LINE @Y17XAUU 34800000
*                                                                S99528 34900000
         BAL   R8,STRTLINE        START CT LINE                  S22024 35000000
         SPACE                                                          35100000
CEC012   EQU   *                                                 S99528 35200000
         TM    $ERROPT,$NOCNTRL   NO CONTROL PRINT SELECTED ?    S99528 35300000
         BZ    CEC016             NO                             S99528 35400000
         TM    TOTFLG05,TOTREPLY  YES - IS REPLY TO CECOM SET    S99528 35500000
         BZ    CEC050             NO - BYPASS PRINT              S99528 35600000
         SPACE                                                          35700000
CEC016   EQU   *                                                 S99528 35800000
         L     R15,TOTRESPL       GET RESPL ADDRESS            @Y17XAUU 35900000
         USING RESPL,R15          SET RESPL ADDRESSABILITY     @Y17XAUU 36000000
         L     R15,RESPLWO        GET I/O ACCESS ROUTINE ADDR  @Y17XAUU 36100000
         DROP  R15                                             @Y17XAUU 36200000
         BALR  R14,R15            WRITE MESSAGE                @Y17XAUU 36300000
         SPACE                                                          36400000
         TM    TOTFLG09,TOTCTCON  CT = SYSCON                    S99528 36500000
         BZ    CECREM             NO - ASSUME REMOTE             S99528 36600000
*                                                                S99528 36700000
         TM    TOTFLG05,TOTREPLY  REPLY REQUESTED                S99528 36800000
         BO    CEC022             BRANCH IF YES                  S99528 36900000
         B     CEC050             NO - RETURN                    S99528 37000000
         SPACE                                                          37100000
CEC022   EQU   *                                                 S99528 37200000
         LA    R5,LINBUF          GET LENGTH OF IN MSG BUFFER    S99528 37300000
         LR    R3,R5              SET MSG COUNTER                S99528 37400000
         LA    R6,TOTINBUF        GET ADDR OF IN BUFFER          S99528 37500000
         BCTR  R5,R0              SUBTRACT ONE FROM LENGTH       S99528 37600000
         CLI   D0(R6),BLANKA      ANY REPLY READ IN             SA41601 37700000
         BNE   CEC026             YES                           SA41601 37800000
         MVI   D0(R9),ZERO        ZERO DATA COUNT               SA41601 37900000
         B     CEC054             RETURN                        SA41601 38000000
CEC026   EQU   *                                                SA41601 38100000
         AR    R6,R5              POINT TO LAST BYTE             S99528 38200000
         SPACE                                                          38300000
CEC028   EQU   *                                                 S99528 38400000
         CLI   D0(R6),BLANKA      END OF MESSAGE                SA41601 38500000
         BNE   CEC030             YES - BRANCH                   S99528 38600000
         BCTR  R3,R0              DECREMENT MSG COUNTER          S99528 38700000
         BCTR  R6,R0              POINT TO NEXT POSITION         S99528 38800000
*                                                                S99528 38900000
         B     CEC028             CHECK NEXT CHAR               SA41601 39000000
         SPACE                                                          39100000
CEC030   EQU   *                                                 S99528 39200000
         LA    R6,TOTINBUF        POINT TO INPUT BUFFER          S99528 39300000
         EX    R5,CEC082          XLATE TO UPPER CASE            S99528 39400000
         SPACE                                                          39500000
CEC040   EQU   *                                                 S99528 39600000
         MVI   D0(R9),ZERO        CLEAR IN COUNT POSITION        S99528 39700000
         L     R5,D16(R11)        GET XPTD IN MSG COUNT          S99528 39800000
         LTR   R5,R5              ZERO COUNT                     S99528 39900000
         BZ    CEC054             YES                            S99528 40000000
         SPACE                                                          40100000
CEC042   EQU   *                                                 S99528 40200000
         CL    R5,K62             MAXIMUM COUNT EXCEEDED         S99528 40300000
         BNH   CEC045             NO                             S99528 40400000
         LA    R5,CECNT           SET COUNT TO MAXIMUM           S99528 40500000
         SPACE                                                          40600000
CEC045   EQU   *                                                 S99528 40700000
         BCTR  R5,R0              DECREMENT FOR EX               S99528 40800000
         EX    R5,CEC090          CLEAR OLT INPUT BUFFER        SA41601 40900000
         LA    R5,D1(R5)          RESTORE XPTD IN COUNT         SA41601 41000000
         CR    R3,R5              XPTD COUNT < ACTUAL COUNT     SA41601 41100000
         BNH   CEC047             NO - USE LESSER COUNT         SA41601 41200000
         LR    R3,R5              GET LESSER COUNT              SA41601 41300000
CEC047   EQU   *                                                SA41601 41400000
         STC   R3,D0(R9)          ACTUAL INPUT COUNT            SA41601 41500000
         BCTR  R3,R0              DECREMENT FOR EX              SA41601 41600000
         EX    R3,CEC084          MOVE RCVD MSG TO OLT          SA41601 41700000
         SPACE                                                          41800000
CEC050   EQU   *                                                 S99528 41900000
CEC054   EQU   *                                                 S99528 42000000
         L     R13,D4(R13)        RESTORE CALLER'S SAVE AREA     S99528 42100000
         L     R14,D12(R13)       RESTORE RETURN ADDR            S99528 42200000
         TM    $OLTFLGS,$TRACE    TRACE OPTION SET               S99528 42300000
         BO    CEC060             YES                            S99528 42400000
         LM    R0,R12,D20(R13)    RESTORE REG                    S99528 42500000
         SR    R15,R15            CLEAR RET CODE REGISTER        S99528 42600000
         BR    R14                RETURN TO CALLER               S99528 42700000
*                                                                S99528 42800000
*        REQUEST IEDQWM2 TO PROVIDE TRACE FUNCTION               S99528 42900000
*                                                                S99528 43000000
CEC060   EQU   *                                                 S99528 43100000
         LM    R0,R1,D20(R13)     RESTORE REGISTERS 0-1          S99528 43200000
         L     R15,TOTRESPL       GET RESPL ADDRESS            @Y17XAUU 43300000
         USING RESPL,R15          SET RESPL ADDRESSABILITY     @Y17XAUU 43400000
         L     R15,RESPLM2        GET TRACE ROUTINE ADDRESS    @Y17XAUU 43500000
         DROP  R15                                             @Y17XAUU 43600000
         LM    R2,R12,DISREG2(R13) RESTORE REGISTERS           @Y17XAUU 43700000
         BR    R15                EXIT TO IEDQWM2              @Y17XAUU 43800000
         SPACE 4                                                        43900000
CECREM   EQU   *                                                 S99528 44000000
         TM    TOTFLG05,TOTREPLY  REPLY EXPECTED?                S99528 44100000
         BZ    CEC050             NO                             S99528 44200000
         STM   R5,R8,WORK4        SAVE REGISTERS                 S99528 44300000
         SPACE                                                          44400000
EMSG01D  EQU   *                                                 S22024 44500000
         SPACE 2                                                        44600000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                   S99528 44700000
         MVI   TOTINBUF,BLANKA    CLEAR INPUT                   SA41601 44800000
         MVC   TOTINBUF+D1(D79),TOTINBUF  BUFFER                SA41601 44900000
         OI    TOTFLG03,TOTREPEX       TURN ON REPLY EXPECTED   SA41613 45000000
*                                        BIT                    SA41613 45100000
*                                                                S99528 45200000
*        WAIT FOR REPLY TO COME IN                               S99528 45300000
*                                                                S99528 45400000
         WAIT  ECB=TOTOTECB       ISSUE WAIT MACRO               S.9528 45500000
         SPACE                                                          45600000
*                                                                S99528 45700000
*        THE FOLLOWING CODE RETRIVES A RESPONSE FROM             S99528 45800000
*        A TCAM BUFFER.  THE FIRST CHARACTER OF THE MESSAGE      S99528 45900000
*        IS THE CONTROL TERMINAL I. D.                           S99528 46000000
*                                                                S99528 46100000
         L     R6,TOTOLTMQ        GET ADDR OF TCAM BFR UNIT      S99528 46200000
         USING IEDQPRF,R6                                        S99528 46300000
         LA    R3,PRFSUNIT        GET START OF FIRST BFR UNIT    S99528 46400000
         AH    R3,PRFSCAN         POINT TO MSG ID                S99528 46500000
         LA    R7,D2              GET SIZE OF ID FIELD          SA41609 46600000
         LH    R10,PRFSIZE        GET TOTAL NUMBER OF DATA BYTES S99528 46700000
*                                   FROM THE BUFFER              S99528 46800000
         SH    R10,PRFSCAN        SUBTRACT RESERVE CHARACTERS    S99528 46900000
*                                   TO GET TOTAL NUMBER OF BYTES S99528 47000000
*                                   IN THE REPLY                 S99528 47100000
         SR    R10,R7             DECREMENT DATA COUNT BY SIZE  SA41609 47200000
*                                   OF ID FIELD(2)              SA41609 47300000
         SR    R7,R7              CLEAR INMSG COUNTER           SA41609 47400000
         LR    R8,R3              GET MSG POINTER                       47500000
MSGLOOP  EQU   *                                                 S99528 47600000
         CLI   D2(R8),BLANKA      END OF MESSAGE?                S99528 47700000
         BL    EXMOVE             YES                            S99528 47800000
         LA    R7,D1(R7)          INCREMENT CHAR COUNTER         S99528 47900000
         LA    R8,D1(R8)          POINT TO NEXT CHAR             S99528 48000000
         BCT   R10,MSGLOOP        GO TEST NEXT BYTE              S99528 48100000
         SPACE                                                          48200000
EXMOVE   EQU   *                                                 S99528 48300000
         STC   R7,D0(R9)          PUT MSG COUNT IN OLT BUFFER    S99528 48400000
         LTR   R7,R7              ANY RESPONSE?                  S99528 48500000
         BZ    EMSG11             NO                             S99528 48600000
         CL    R7,EIGHTY          MAXIMUM CHAR. EXCEEDED?        S99528 48700000
         BH    MAXMSG             YES - TRUNCATE IT              S99528 48800000
         BCTR  R7,R0              DECREMENT FOR EX               S99528 48900000
         B     MOVE               MOVE RESPONSE TO OLT           S99528 49000000
         SPACE                                                          49100000
MAXMSG   EQU   *                                                 S99528 49200000
         LA    R7,LINBUF-ONE      SET MAX COUNT MINUS ONE        S99528 49300000
MOVE     EQU   *                                                 S99528 49400000
         EX    R7,RESPONSE        MOVE RESPONSE TO OLTCB         S99528 49500000
         SPACE                                                          49600000
EMSG11   EQU   *                                                 S99528 49700000
*                                                                S99528 49800000
*        POST BUFFER LCB TO TCAM (BD)                            S99528 49900000
*                                                                S99528 50000000
         L     R12,TOTAVTPT       GET AVT ADDR                   S99528 50100000
         USING IEDQAVTD,R12                                             50200000
         LA    R5,AVTBFRTB        BFR RETURN QCB ADDR           SA41592 50300000
         ST    R5,WORK2           SAVE IT                       SA41592 50400000
         CLI   PRFKEY,TRMTERM     REQUEST FROM A SECONDARY      SA41592 50500000
*                                 OPERATOR CONTROL TERMINAL     SA41592 50600000
         BE    EMSGSCT            YES - BRANCH                  SA41592 50700000
         TM    PRFKEY,LUTYPE      LU ENTRY                     @Y17XAUU 50800000
         BE    EMSGSCT            YES - BRANCH                 @Y17XAUU 50900000
         CLI   PRFKEY,MULBUF      MULTIPLE BUFFERS PREFIX        S22024 51000000
         BE    EMSGSCT                  YES - POST BUFFER ONLY @YA06896 51100000
         L     R7,PRFLCB-ONE      GET REQ LINE LCB ADDR          S99528 51200000
         USING IEDQLCB,R7                                               51300000
         MVC   LCBLSPCI(D3),TOTOLTMQ+ONE PUT IN BUFFER ADDR      S99528 51400000
         MVI   LCBPRI,PRILCB      SET PRIORITY                   S99528 51500000
         L     R8,LCBSCBA-ONE     GET SCB ADDR                   S99528 51600000
         LA    R8,D0(R8)          CLEAR HIGH ORDER BYTE          S99528 51700000
         USING IEDQSCB,R8                                               51800000
         MVC   SCBDESTQ(D3),WORK2+ONE PUT IN SCB                 S99528 51900000
         L     R5,SCBMACR-ONE     GET ADDR OF BFR HDR ENTRY      S99528 52000000
         LA    R5,D0(R5)          CLEAR HI ORDER BYTE            S99528 52100000
         LA    R3,AVTINOUT        INEND/OUTEND PLIST ADDR        S99528 52200000
         ST    R3,DPARM           SAVE IT IN WORK AREA           S99528 52300000
         MVC   SCBMACR(D3),DPARM+D1 PUT IN SCB                   S99528 52400000
         L     R8,AVTMSGS-ONE                                    S99528 52500000
         LA    R8,D0(R8)          CLEAR HI ORDER BYTE            S99528 52600000
         L     R8,D0(R8)          GET QCB ADDR                   S99528 52700000
         ST    R8,WORK2           SAVE QCB ADDR FOR BD           S99528 52800000
         L     R8,LCBQCBA-D1      GET QCB ADDR                   S99528 52900000
         CLI   LCBRSKEY,ANR       TERMINAL = ANR                 S99528 53000000
         BNE   EMSG15             NO                             S99528 53100000
         MVI   LCBTSTSW,XF0       SET LCB FLAG FOR ANR LOCAL     S99528 53200000
         DROP  R8                                                       53300000
EMSG15   EQU   *                                                 S99528 53400000
         MVC   LCBQCBA(D3),WORK2+ONE PUT QCB ADDR FOR BD IN LCB  S99528 53500000
*                                                                S99528 53600000
         ST    R7,TPOSTPAR        PUT LCB ADDR IN P-LIST         S99528 53700000
         ST    R7,TPOSTPAR+D4     PUT LCB ADDR IN P-LIST AGAIN   S99528 53800000
         MVI   TPOSTPAR,TPAR1     SET                            S99528 53900000
         MVI   TPOSTPAR+D4,TPAR2  FLAGS                          S99528 54000000
         LA    R1,TPOSTPAR        GET ADDRESS OF TPOST PLIST     S99528 54100000
         B     EMSG18             EXIT                          SA41592 54200000
         SPACE 2                                                        54300000
*************************************************************** SA41592 54400000
*        REQUEST IS FROM SECONDARY OPERATOR CONTROL TERMINAL  * SA41592 54500000
*************************************************************** SA41592 54600000
EMSGSCT  EQU   *                                                SA41592 54700000
         ST    R5,PRFKEY          QCB ADDR IN BUFFER            SA41592 54800000
         MVI   PRFPRI,PRIBFRTB    PRIORITY                      SA41592 54900000
         L     R5,TOTOLTMQ        BUFFER ADDR                   SA41592 55000000
         ST    R5,TPOSTPAR+D4     SET UP POST                   SA41592 55100000
         MVC   TPOSTPAR+D1(D3),TPOSTPAR+D5 ELEMENT              SA41592 55200000
         MVI   TPOSTPAR,TPOSTA    SHOW FIRST ELEMENT            SA41592 55300000
         MVI   TPOSTPAR+D4,TPOSTE SHOW LAST BUFFER              SA41592 55400000
         LA    R1,TPOSTPAR        POINT TO PLIST                SA41592 55500000
*                                                               SA41592 55600000
         DROP  R7                                               SA41592 55700000
         DROP  R6                                               SA41592 55800000
         DROP  R12                                              SA41592 55900000
*                                                               SA41592 56000000
         SPACE                                                          56100000
EMSG18   EQU   *                                                SA41592 56200000
         AQCTL                    POST BUFFER                   SA41592 56300000
         BAL   R5,CECSTOP         GO CHECK FOR STOPLINE          S99528 56400000
         SPACE 2                                                        56500000
         LM    R5,R8,WORK4        RESTORE REGISTER               S99528 56600000
         B     CEC022             EXIT TO MOVE MSG TO OLT INBUF  S99528 56700000
         EJECT                                                          56800000
**************************************************************** S99528 56900000
*                                                              * S99528 57000000
*        START LINE VIA TCAM'S OP-CONTROL FACILITY             * S99528 57100000
*                                                              * S99528 57200000
**************************************************************** S99528 57300000
STRTLINE DS    0H                                                S99528 57400000
         STM   R6,R12,STRTSAVE     SAVE REGS DURING STARTLINE    S99528 57500000
*                                                                S99528 57600000
         L     R6,TOTAVTPT        GET ADDRESS OF AVT             S99528 57700000
         USING IEDQAVTD,R6                                       S99528 57800000
         LA    R10,AVTOPCOB        GET POINTER TO OP CNTRL QCB   S99528 57900000
         ST    R10,TOTOKEY         PUT IN PARAMETER LIST       @Y17XAUU 58000000
         MVI   TOTOPRI,RQPRI       SET PRIORITY                @Y17XAUU 58100000
         MVI   TOTOELNG,RQELNG    SET ELEMENT LENGTH           @Y17XAUU 58200000
         DROP  R6                                                S99528 58300000
         MVC   TOTORLN(D1),TOTCTRLN CT RLN                     @Y17XAUU 58400000
         SR    R6,R6                                           @G36XRUV 58450010
         ICM   R6,3,TOTCTUCB      CT UCB ADDR                  @G36XRUV 58500010
         LTR   R6,R6               IS THERE A VALID UCB ADDRESS  S99528 58600000
         BZ    STRT5              NO - DONT ISSUE STARTLINE      S99528 58700000
         USING UCB,R6                                            S99528 58800000
         MVC   TOTOLADR(D8),BLANK BLANK OUT NAME FIELD         @Y17XAUU 58900000
         MVC   TOTOLADR(THREE),UCBNAME GET UNIT NAME           @Y17XAUU 59000000
         DROP  R6                                                S99528 59100000
         LA    R1,TOTOTECB         GET TOTE ECB                  S99528 59200000
         ST    R1,TOTOECBA         PUT IN PARAMETER LIST       @Y17XAUU 59300000
         XC    TOTOLINK(THREE),TOTOLINK CLEAR REQ ELEM LINK FLD@Y17XAUU 59400000
         XC    TOTORTCD,TOTORTCD  CLEAR RETURN CODE            @Y17XAUU 59500000
         XC    TOTOTECB(FOUR),TOTOTECB CLEAR TOTE ECB            S99528 59600000
         LA    R1,TOTPLIST        ADDR OF ELEMENT                S22024 59700000
         ST    R1,TRMSLPL         PUT IN PLIST                   S22024 59800000
         ST    R1,TRMSLPL+D4      PUT IN PLIST                   S22024 59900000
         MVI   TRMSLPL,RQINIT     SET INITIAL ELEMENT FLAG       S22024 60000000
         MVI   TRMSLPL+D4,RQEND   SET LAST ELEMENT FLAG          S22024 60100000
         LA    R1,TRMSLPL         ADDR OF PLIST                  S22024 60200000
         AQCTL                     POST ELEMENT TO OPERATOR CNTL S99528 60300000
*                                                                S99528 60400000
         WAIT  ECB=TOTOTECB                                      S99528 60500000
*                                                                S99528 60600000
STRT5    EQU   *                                                        60700000
         LM    R6,R12,STRTSAVE     RESTORE REGS FROM STARTLINE   S99528 60800000
         BR    R8                  RETURN TO CALLER              S99528 60900000
         SPACE                                                          61000000
CECSTOP  EQU   *                                                 S99528 61100000
         TM    TOTCTFLG,TOTCTORN  CT ON 3705                   @Y17XAUU 61200000
         BO    D0(R5)             YES - BYPASS CHECK           @Y17XAUU 61300000
         CLI   TOTOVBCD,LINESTRT  WAS START LINE ISSUED?        SA64786 61400000
         BNE   CECST4             NO, RETURN                    SA64786 61500000
         ST    R5,CECSAVE         SAVE RETURN ADDRESS            S99528 61600000
         MVI   TOTOVBCD,LINESTOP  SET VERB CODE FOR STOP LINE  @Y17XAUU 61700000
         CLI   TOTORTCD,ZERO      CT LINE INIT STOPPED           S22024 61800000
         BNE   CECST4             NO - RETURN                    S22024 61900000
         BAL   R8,STRTLINE        STOP CT LINE                   S22024 62000000
         L     R5,CECSAVE         GET RETURN ADDRESS             S99528 62100000
CECST4   EQU   *                                                 S99528 62200000
         BR    R5                 RETURN                         S99528 62300000
         SPACE 1                                                        62400000
CEC080   MVC   TOTOTBUF(ZERO),ZERO(R10)  MOVE MESSAGE TO         S99528 62500000
*                                          OUTPUT BUFFER         S99528 62600000
MSGMOVE1 MVC   TOTOTBUF+D8(ZERO),D3(R10) OUTPUT MSG TO OLTCB     S22024 62700000
CEC082   OC    D0(D0,R6),BLANK    XLATE RCVD MSG TO UPPER CASE   S99528 62800000
CEC084   MVC   D1(D0,R9),TOTINBUF MOVE RCVD MSG TO OLT BUFFER    S99528 62900000
CEC090   XC    D0(D0,R9),D0(R9)   CLEAR OLT INPUT BUFFER        SA41601 63000000
         SPACE                                                          63100000
         SPACE                                                          63200000
         SPACE                                                          63300000
PATCH    DS    CL50               MAITENANCE AREA.               S99528 63400000
         SPACE 2                                                        63500000
EIGHTY   DC    F'80'              VALUE OF EIGHTY                S99528 63600000
F0       DC    F'0'               VALUE OF ZERO                  S22024 63700000
F4       DC    F'4'               VALUE OF 4                    S22024  63800000
K62      DC    F'62'              VALUE OF SIXTY TWO             S99528 63900000
MSGMOVE  MVC   TOTOTBUF(ZERO),ZERO(R7)  MOVE MESSAGE TO          S99528 64000000
*                                         OUTPUT BUFFER          S99528 64100000
RESPONSE MVC   TOTINBUF(D1),D2(R3) MOVE RCVD MSG TO OLTCB BUFFER S99528 64200000
KLEAR    DC    H'0100'            SCB MASK SETTING               S99528 64300000
BLANK    DC    80XL1'40'          BLANK FIELD                    S99528 64400000
*                                                                S99528 64500000
LINESTRT EQU   X'40'               VERB CODE FOR START LINE      S99528 64600000
LINESTOP EQU   X'41'               VERB CODE FOR STOP  LINE      S99528 64700000
TERMSTRT EQU   X'45'               VERB CODE FOR START TERMINAL  S99528 64800000
TERMSTOP EQU   X'47'               VERB CODE FOR STOP  TERMINAL  S99528 64900000
*                                                                S99528 65000000
         SPACE 2                                                        65100000
PSPREF   DSECT                                                   S22024 65200000
SECTID   DS    CL8                SECTION ID                     S22024 65300000
LEVEL    DS    CL2                LEVEL                          S22024 65400000
RTNDISP  DS    AL2                DISPLACEMENT TO RTN#           S22024 65500000
INST     DS    A                  POINTER TO FIRST EXEC INST.    S22024 65600000
MSGID    DS    CL2                OLT COMPONENT ID               S22024 65700000
         SPACE 2                                                        65800000
SPREF    DSECT                                                   S22024 65900000
RTN#     DS    CL1                RTN NUMBER                     S22024 66000000
         DS    CL15               SECTION PREFACE FLAGS/DATA     S22024 66100000
#FLAG    DS    CL1                FLAGS                          S22024 66200000
#MSGIDRQ EQU   X'10'              MESSAGE ID PROVIDED            S05331 66300000
         EJECT                                                          66400000
         TQCBD                                                   S99528 66500000
         EJECT                                                          66600000
         TPRIOR                                                  S99528 66700000
         SPACE 4                                                        66800000
         EJECT                                                          66900000
         TLCBD                                                          67000000
         EJECT                                                          67100000
         TSCBD                                                          67200000
         EJECT                                                          67300000
         TPRFD                                                          67400000
         EJECT                                                          67500000
         EJECT                                                   S99528 67600000
         TAVTD                                                   S99528 67700000
         EJECT                                                   S99528 67800000
         IOBLOCKS                                                S99528 67900000
         EJECT                                                   S99528 68000000
UCB      DSECT                                                   S99528 68100000
         IEFUCBOB                                                S99528 68200000
         EJECT                                                          68300000
RESPL    RESPL                                                 @Y17XAUU 68400000
         EJECT                                                          68500000
         OLTCB                                                   S99528 68600000
TRMSLPL  DS    0F                 OP CONTROL PLIST             @Y17XAUU 68700000
         DC    X'0C'              FLAG START                   @Y17XAUU 68800000
         DC    AL3(0)             POINTER TO FIRST ELEMENT     @Y17XAUU 68900000
         DC    X'08'              FLAG LAST                    @Y17XAUU 69000000
         DC    AL3(0)             POINTER TO LAST ELEMENT      @Y17XAUU 69100000
TPOSTPAR DS    2F                 TPOST PLIST FOR BFR RETURN   @Y17XAUU 69200000
STRTSAVE DS    7F                 SAVE AREA FOR START LINE     @Y17XAUU 69300000
DPARM    DS    F                  WORK AREA                    @Y17XAUU 69400000
WORK2    DS    F                  WORK AREA                    @Y17XAUU 69500000
WORK4    DS    4F                 REG SAVE AREA                @Y17XAUU 69600000
CECSAVE  DS    F                  SAVE AREA                    @Y17XAUU 69700000
MSGIDSV  DS    H                  OLT COMPONENT ID SAVE AREA   @Y17XAUU 69800000
PRIRTCD  DS    C                  RETURN CODE SAVE AREA        @Y17XAUU 69900000
SECRTCD  DS    C                  RETURN CODE SAVE AREA        @Y17XAUU 70000000
         END                                                            70100000
