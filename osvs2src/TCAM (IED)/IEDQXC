 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - PRIVATE MACROS            ' 00060020
         MACRO                                                          00120020
&LABEL   $PRNT &LOC,&CNT,&PRE,&POST                                     00200020
         LCLA  &LEN                                                     00201022
         LCLB  &ENDIT                                                   00202022
         LCLC  &CARR                                                    00203022
&ENDIT   SETB  (0)                                                      00204022
&CARR    SETC  '&PRE'                                                   00205022
&LEN     SETA  K'&PRE                                                   00206022
         AIF   ('&LABEL' EQ '').NOLAB                                   00207022
&LABEL   DS    0H                       DEFINE ENTRY LABEL              00208022
.NOLAB   AIF   ('&CARR' EQ 'SP1' OR '&CARR' EQ '').CKLOC                00209022
         AIF   (&LEN LT 3).CTLERR                                       00210022
         AIF   ('&CARR'(1,2) EQ 'SP' OR '&CARR'(1,2) EQ 'SK').CTL1      00211022
.CTLERR  MNOTE 2,'CARRIAGE CONTROL INVALID, &CARR IGNORED.'             00212022
         AGO   .CKLOC                                                   00213022
.CTL1    AIF   ('&CARR'(1,2) EQ 'SP').CKSPCE                            00214022
         MVI   OUTAREA,C'1'             INDICATE PAGE EJECT             00215022
         AGO   .CKLOC                                                   00216022
.CKSPCE  AIF   (&LEN NE 3).CTLERR                                       00217022
         AIF   ('&CARR'(3,1) NE '2').CTL2                               00218022
         MVI   OUTAREA,C'0'             INDICATE DOUBLE SPACE           00219022
         AGO   .CKLOC                                                   00220022
.CTL2    AIF   ('&CARR'(3,1) NE '3').CTLERR                             00221022
         MVI   OUTAREA,C'-'             INDICATE TRIPLE SPACE           00222022
.CKLOC   AIF   (&ENDIT).MEND                                            00223022
         AIF   ('&LOC' EQ '').CALLSEQ                                   00224022
         AIF   ('&CNT' EQ '').ONE20                                     00225022
         MVC   OUTAREA+1(&CNT),&LOC     MOVE DATA TO OUTPUT BUFFER      00226022
         AGO   .CALLSEQ                                                 00227022
.ONE20   ANOP                                                           00228022
         MVC   OUTAREA+1(120),&LOC      MOVE DATA TO OUTPUT BUFFER      00229022
.CALLSEQ ANOP                                                           00230022
         BAL   14,PUT                   OUTPUT BUFFER                   00231022
         AIF   ('&POST' EQ '').MEND                                     00232022
&CARR    SETC  '&POST'                                                  00233022
&ENDIT   SETB  1                                                        00234022
&LEN     SETA  K'&POST                                                  00235022
         AGO   .NOLAB                                                   00236022
.MEND    ANOP                                                           00237022
         MEND                                                           00238022
         EJECT                                                          00239022
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - MODULE PROSE              ' 04000022
IEDQXC   CSECT                                                          04000122
*  CHANGE ACTIVITY AS FOLLOWS:                                          04000222
******************** MICROFICHE FLAGS *********************** SUPT CODE 04000322
*A155000,197000,474000,719012,725000                            SA50211 04000422
*C289000                                                         S21101 04000522
*D185000-186000,421000,427000-430000                             S21101 04000622
*A187000,204000,205000,215700,420000,422000,426000,439000,603000 S21101 04000722
*A719000,720000,765000                                           S21101 04000822
*A511000,516000                                                  A42375 04000922
*C515000,519000,530000,659000                                    A42375 04001022
*D513000-514000,517000,532000-533000                             A42375 04001122
*C242000,333000                                                  A42361 04001322
*A131000,187000,187600                                           A50187 04001522
*A439600                                                        SA56902 04001622
*A196500,180300-180600,422700-516120,547200-547600,626010-626640 S21903 04001722
*A697200-697800,722500,725200,792050-792900                      S21903 04001822
*D420016-420046,422700,603999-604266                             S21903 04001922
*C767000                                                         S21903 04002022
*A223500,317500,603999-604449                                   SA51078 04002122
*A176001,283001-283006,308001-308020,353500,604534-604537       SA59967 04002222
*A633001,689001,722001-722003                                   SA59967 04002322
*C178000,184000,215000-215300,474540,604059,606400,608800       SA59967 04002422
*C611200,613600,622000-622015,626200,695000                     SA59967 04002522
*A193300-193600                                                 SA61738 04002605
*D197300-197600                                                 SA61738 04002705
*C604089                                                        SA66943 04002805
*C530000,535000,537000,538000,658400,659000,660000-664000       SA69651 04042805
*A362000                                                       @XA05296 04042956
*D362090,362900                                                @XA08982 04052909
*C516600-543000,516200                                         @XA08072 04062909
*A116000,626640,630000                                         @XA08072 04072909
*A201000,204000,205700,215007,216400,217100,524500,539300      @OY12272 04073091
*A544000,547600,626840,633001,664000,719822,725200,765500      @OY12272 04073191
*D229000,528000                                                @OY12272 04073291
*C067000,074000                                                @OY12272 04073391
*D537600,A539300,A539500                                       @OX13503 04078300
*C242000,C333000                                               @OY19630 04079300
*572000,574000,577000                                          @OZ27790 04080300
*D592000,601000                                                @OZ27790 04081300
*D539360                                                       @OY19631 04082300
* $01=OZ40750  ETC2202  79.10.20 047252:                           @01A 04083227
* $02=OZ40789  ETC2202  79.10.20 047252:                           @02A 04084127
* $11=OZ46500  ETC2302  80.05.22 076195:                           @11A 04084526
* $21=OZ50497  ETC2402  82.01.23 937763: EXPAND REUS QUEUE SIZE    @21A 04084727
         SPACE 3                                                        04085022
*********************************************************************** 04090020
*                                                                     * 04110022
* $MOD(IEDQXC) COMP(Y@) PROD(TCAM):                                @11C 04114026
*                                                                     * 04118022
*DESCRIPTIVE-NAME=TCAM MESSAGE QUEUE PRINT ROUTINE                    * 04118822
*                                                                     * 04119622
*COPYRIGHT='NONE'                                                     * 04119722
*                                                                     * 04120020
*  STATUS:  CHANGE LEVEL 5                                            * 04150056
*                                                                     * 04250022
*FUNCTION:                                                            * 04350022
*   IEDQXC RUNS AS A JOB STEP IN THE BATCH ENVIRONMENT UNDER OS/360   * 04600020
*   AS A UTILITY PROGRAM, INDEPENDENT OF TCAM. THE MESSAGE QUEUE      * 04700020
*   DATASET PRINTOUT CAN BE DIRECTED TO A PRINTER, TAPE, OR DISK      * 04800020
*   FOR LATER PRINTOUT.                                               * 04900020
*   UPON ENTRY THE PARM FIELD OF THE EXEC CARD IS CHECKED FOR VALIDITY* 05000020
*   AND FOR THE TYPE OF OUTPUT DESIRED.                               * 05100020
*   THE TYPE OF DEVICE ON WHICH THE QUEUE RESIDES IS DETERMINED AND   * 05200020
*   THE DATASET IS OPENED.THE OUTPUT DATASET IS OPENED AND A HEADER   * 05300020
*   LINE IS WRITTEN DENOTING THE MEANING OF THE SPECIAL CHARACTERS.   * 05400020
*   NEXT THE PROPER QUEUE IS DETERMINED, AND THE NEXT HEADER LINE IS  * 05500020
*   WRITTEN.  AFTER THE RECORD IS READ THE PREFIX IS CHECKED AND      * 05600020
*   FORMATTED BEFORE PRINTING.                                        * 05700020
*   THE PROGRAM USES THE HEADER PREFIX TO CHAIN EACH MESSAGE SO THAT  * 05800020
*   THE MESSAGE WILL BE PRINTED CONTIGUOUSLY, EVEN THOUGH IT MAY BE   * 05900020
*   SPREAD OVER MORE THAN ONE VOLUME.                                 * 06000020
*                                                                     * 06100020
*ENTRY POINTS  IEDQXC IS THE ONLY ENTRY POINT                         * 06200020
*                                                                     * 06300020
*INPUT                                                                * 06400020
* 1.  INPUT PARAMETERS FROM EXEC CARD.                                * 06500020
*                                                                     * 06600020
*     Q=DMP                                                   @OY12272* 06700091
*     Q=XXXX,DMP                                              @OY12272* 06740091
*     Q=XXXX,ALL(,DU/,DS)(,FMT)                               @OY12272* 06780091
*     Q=XXXX,AAAA,BBBB,...(,DU/,DS)(,FMT)                     @OY12272* 06820091
*                                                             @OY12272* 06860091
*       WHERE - DMP= DUMP MESSAGES SEQUENTIALLY.              @OY12272* 06900091
*               ALL= LIST NUMBER OF QUEUES SPECIFIED IN XXXX  @OY12272* 06940091
*               XXXX= NUMBER OF LOGICAL QUEUES ON MESSAGE     @OY12272* 06980091
*                     QUEUE DATA SET.                         @OY12272* 07020091
*               AAAA,BBBB,...= A SERIES OF 1- TO 4-DIGIT      @OY12272* 07060091
*                     QUEUE NUMBERS, UP TO 5.                 @OY12272* 07100091
*               DU=  DUMP ONLY UNSERVICED MESSAGES IN         @OY12272* 07140091
*                    SPECIFIED QUEUES.                        @OY12272* 07180091
*               DS=  DUMP ONLY SERVICED MESSAGES IN           @OY12272* 07220091
*                    SPECIFIED QUEUES.                        @OY12272* 07260091
*               FMT= FORMAT DATFLAGS BYTE IN DATA FIELD.      @OY12272* 07300091
*                                                             @OY12272* 07340091
*       NOTE - THE PARENTHESES AROUND DU, DS, AND FMT         @OY12272* 07380091
*              INDICATE THAT THESE OPERANDS ARE OPTIONAL.     @OY12272* 07420091
*                                                             @OY12272* 07460091
* 2.  MESSAGE QUEUE DATA SET                                            07500020
*                                                                     * 07700020
*OUTPUT                                                               * 07800020
*   CONSISTS OF PRINTED,FORMATTED RECORDS                             * 07900020
*                                                                     * 08000020
*EXTERNAL ROUTINES  NONE                                              * 08100020
*                                                                     * 08200020
*EXITS-NORMAL WHEN THE PARMETERS FROM EXEC CARD ARE FINISHED            08300020
*                                                                     * 08400020
*EXITS-ERROR BR 14 AFTER WRITING APPROPRIATE MESSAGE ON CONSOLE       * 08500020
*          WHICH EXPLAINS THE REASON FOR TERMINATION                  * 08600020
*                                                                     * 08610020
*MESSAGES-                                                            * 08620020
*       IED119I UNABLE TO OPEN ''DDNAME''.-                           * 08630020
*               SYSTEM WAS NOT ABLE TO OPEN 'DDNAME' DATA SET.        * 08640020
*       IED122I INVALID MESSAGE CHAIN-                                * 08650020
*               CHAINING SEQUENCE ON MSG QUEUE DATA SET IS INVALID.   * 08660020
*       IED123I INVALID PARAMETERS-                                   * 08670020
*               ERROR IN EXEC CARD PARAMETERS.                        * 08680020
*       IED124I QUEUE HAS BEEN WRAPPED-                               * 08690020
*               IEDQXC CANNOT CONTINUE DUE TO A WRAPPED MESSAGE QUEUE.* 08700020
*TABLES AND WORK AREAS                                                * 08800020
*   HEADER PREFIX EXPANDED FROM 'TPRFD' MACRO                         * 08900020
*                                                                     * 09000020
*ATTRIBUTES  SERIALLY REUSEABLE  RUNS AS PROBLEM PROGRAM              * 09100020
*                                                                     * 09200020
*NOTE--THERE ARE NO REGISTER DEPENDENCIES FROM OTHER PROGRAMS.        * 09600020
*                                                                     * 09800020
*********************************************************************** 10000020
R0       EQU   0                                                        10200020
R1       EQU   1                   INPUT- EXEC PARM ADDR                10300020
RWRK1    EQU   1                   WORK REG                             10400020
R2       EQU   2                                                        10500020
RWRK2    EQU   2                   WLRK REG 2                           10600020
R3       EQU   3                                                        10700020
RWRK3    EQU   3                   WORKREG 3                            10800020
RIR1     EQU   4                   INTERNAL RETURN REG 1                10900020
R5       EQU   5                                                        11000020
RDTA     EQU   6                   ADDR OF DATA BLK BEING PROCESSED     11100020
RREC     EQU   7                   ABSOLUTE REC NUMBER REG              11200020
RPRF     EQU   8                   BASE REG FOR BFR PREFIX              11300020
RBASE1   EQU   9                        BASE REGISTER # 1               11400020
RBASE2   EQU   10                       BASE REGISTER # 2               11500020
RTOTNO   EQU   11                  USED IN IEDQFD                       11600020
R13      EQU   13                                              @XA08072 11700009
R14      EQU   14                                                       11800020
R15      EQU   15                                                       11900020
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - INITIALIZATION            ' 12000020
         USING PRFSUNIT,RPRF                                            12100020
         USING IEDQXC,RBASE1,RBASE2                                     12200020
         STM   14,12,12(13)                                             12300020
         LR    RBASE1,R15               SET UP BASE REGISTER            12400020
         LA    RBASE2,4095(,RBASE1)     INITIALIZE SECONDARY BASE       12500020
         LA    RBASE2,1(,RBASE2)        RBASE2=RBASE1+4096              12600020
         ST    13,SAVE+4                                                12700020
         LA    12,SAVE                                                  12800020
         ST    12,8(13)                                                 12900020
         LR    13,12                                                    13000020
         LR    R5,R1                    SAVE PARAMETER POINTER          13100020
IEDQXC   IEDHJN BYPASS                  ID AND DATE              S22025 13150022
         OPEN  (PUTDCB,OUTPUT)                                          13200020
         TM    PUTDCB+48,X'10'     TEST FOR GOOD OPEN                   13300020
         BNO   OPENERR             BRANCH IF NOT                        13400020
         MVI   OUTBUF,X'EF'        CLEAR                                13500020
         MVC   OUTBUF+1(119),OUTBUF     OUTPUT BFR                      13600020
         EJECT                                                          13700020
*********************************************************************** 13800020
***                                                                 *** 13900020
***            INITIALIZE DCB'S & OPEN                              *** 14000020
***                                                                 *** 14100020
*********************************************************************** 14200020
       DEVTYPE QDDNAME,INFO,DEVTAB      GET DEVICE CHARACTERISTICS      14300020
         LTR   R15,R15                  DID WE GET THE DEVTYPE          14400020
         BZ    *+8                      IF YES, READ THE JFCB           14500020
         BAL   R5,OPERR1                GO ISSUE OPEN FAIL MESSAGE      14600020
        RDJFCB RDDCB1                   READ JFCB FOR MESSAGE QUEUE     14700020
        OBTAIN QUEDSCB                  GET FORMAT 1 DSCB FROM VTOC     14800020
         LTR   R15,R15                  DID WE READ THE DSCB            14900020
         BZ    *+8                      IF YES, CONTINUE PROCESSING     15000020
         BAL   R5,OPERR1                GO ISSUE UNABLE TO OPEN MSG     15100020
         OPEN  RDDCB1,TYPE=J                                            15200020
         OPEN  MF=(E,DCBLIST+4)         OPEN REST OF MESSAGE QUEUE      15300020
         LR    R1,R5                    RESTORE PARAMETER POINTER       15400020
         BAL   RIR1,QFORMAT             GO CHECK PARAMETER LIST         15500020
RETURN   EQU   *                                                SA50211 15550022
         LH    R1,INFO+10          GET TRKS/CYL                         15600020
         ST    R1,TRCYL                                                 15700020
         M     R1-1,CYLVOL         TRK/CYL * CYL/VOL                    15800020
         M     R1-1,NOVOL           * # VOLS                            15900020
         LR    R2,R1               MOVE TO R2 FOR DIVIDE                16000020
         L     R1,TOTNO                                                 16100020
         DR    R1-1,R2             TOTNO/TRCYL*CYLVOL*NOVOL             16200020
         M     R1-1,NOVOL          RCTRK*NOVOL                          16300020
         ST    R1,VOLRT                                                 16400020
         LA    RWRK1,0             CLEAR REG                            16500020
         L     RWRK2,DCB                                                16600020
         IC    RWRK1,16(RWRK2)                                          16700020
         LA    RWRK1,6(RWRK1)      ADD DATA SIZE                        16800020
         ST    RWRK1,UNIT          SAVE UNIT SIZE                       16900020
         OI    RR1BIT,ON                SET SO RRN WILL NOT        @21A 16901627
*                                        BE CONVERTED              @21A 16903227
         LA    RREC,ONEE                SET TO READ FIRST RCD      @21A 16904827
         BAL   RIR1,FEDQFP              GO READ FIRST RECORD       @21A 16906427
         NI    RR1BIT,OFF               RESET SWITCH               @21A 16908027
         L     RIR1,UNIT                GET LENGTH OF RECORD       @21A 16909627
         S     RIR1,SIX                 BACK UP TO DATA FIELD      @21A 16911227
         AR    RIR1,RPRF                GET POINTER TO DATA        @21A 16912827
         USING IEDQDATA,RIR1            SET IEDQDATA BASE          @21A 16914427
         TM    DATFLAGS,DATNPRFX        DOES UNIT HAVE PREFIX      @21A 16916027
         BZ    CKZERO                   YES, CHECK FOR ZERO        @21A 16917627
*                                        RECORD                    @21A 16919227
         TM    DATFEFO+TWOO,CPBREUS     IS THIS A REUS QUEUE       @21A 16920827
         BO    SETREUS                  YES, SET REUS SWITCH       @21A 16922427
         B     NONREUS                  NO, NONREUSABLE QUEUE      @21A 16924027
CKZERO   EQU   *                                                   @21A 16925627
         OC    PRFSUNIT(30),PRFSUNIT    IS IT FORMATTED RCD        @21A 16927227
         BNZ   CKCRCD                   NO, CHECK RECORD ADDR      @21A 16928827
*                                        IN PRFCRCD                @21A 16930427
         TM    DATFLAGS,DATIFEFO        IS IT REUS QUEUE           @21A 16932027
* FIRST RECORD ON REUSABLE QUEUE WILL HAVE DATIFEFO SET ON         @21A 16933627
         BO    SETREUS                  YES, SET REUS SWITCH       @21A 16935227
         B     NONREUS                  NO, NONREUSABLE QUEUE      @21A 16936827
CKCRCD   EQU   *                                                   @21A 16938427
         TM    PRFCRCD+TWOO,CPBREUS     IS IT REUS NUMBER          @21A 16940027
         BZ    NONREUS                  NO, NONREUSABLE QUEUE      @21A 16941627
SETREUS  EQU   *                                                   @21A 16943227
         OI    CTRL,REUS                SET REUS QUEUE SWITCH      @21A 16944827
NONREUS  EQU   *                                                   @21A 16946427
         DROP  RIR1                     RELEASE BASE REG           @21A 16948027
PRINT    EQU   *                                                 S21903 16950022
         $PRNT SPECIAL,50,SKIP,SP3 NOTE SPECIAL CHARACTERS              17000020
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - FORMAT ROUTINES           ' 17100020
*********************************************************************** 17200020
***            FIND NEXT QUEUE TO BE PRINTED                        *** 17300020
***                                                                 *** 17400020
*********************************************************************** 17500020
GETNEXT  L     RWRK1,NEXTQUE       GET ADDR NEXT QUEUE                  17600020
         NI    CTRL,REUS+ALLQUES+DUMP   TURN OFF BITS           SA59967 17600122
         OC    0(4,RWRK1),0(RWRK1) IS THIS END OF REQUESTS      PTR1898 17700020
         BZ    ENDED                    YES,EXIT                SA59967 17800022
         L     RREC,QUESTART       GET ADDR                             17900020
         LA    RREC,1(RREC)        NEXT QUEUE                           18000020
         TM    SCANBYTE,ON              IS PARTIAL DUMP REQ      S21903 18030022
         BO    WTORTNE                  BRANCH IF YES            S21903 18060022
         TM    CTRL,DUMP           DUMP REQUESTED ?                     18100020
         BO    DUMPQUE             YES                                  18200020
         C     RREC,NUMQUES        ALL QUEUES CHECKED ?                 18300020
         BH    ENDED                    YES                     SA59967 18400022
GETALL   ST    RREC,QUESTART       QUEUE START ADDR                     18700020
         TM    CTRL,ALLQUES             'ALL' SPECIFIED ?        A50187 18707022
         BO    ALLQ                     YES, BRANCH              A50187 18714022
         MVC   RR1RECD,0(RWRK1)         INITIALIZE TO ABSOLUTE   A50187 18721022
*                                       RCD # OF QUE TO BE DMPED A50187 18728022
         B     GETEND                                            A50187 18735022
ALLQ     EQU   *                                                 A50187 18742022
         ST    RREC,RR1RECD             INITIALIZE THE ABSOLUTE  S21101 18750021
*                                         RECORD NUMBER          S21101 18760021
GETEND   EQU   *                                                 A50187 18780022
         EJECT                                                          18800020
*********************************************************************** 18900020
***            WRITE 'FIRST MSG IN QUEUE'                           *** 19000020
***                                                                 *** 19100020
*********************************************************************** 19200020
         MVI   OUTAREA,C'1'        INDICATE NEW PAGE                    19300020
         OI    FRSTRCD,ON               INDICATE 1ST RECORD FOR SA61738 19330005
*                                       AN INDIVIDUAL QUEUE DMP SA61738 19360005
         TM    CTRL,ALLQUES        IS 'ALL' SPECIFIED                   19400020
         BO    USESTART            YES                                  19500020
         L     RWRK1,NEXTQUE       GET NEXT QUEUE                       19600020
         L     RWRK1,0(RWRK1)                                           19700020
         BC    15,CONV                                                  19800020
USESTART L     RWRK1,QUESTART      GET START QUEUE                      19900020
CONV     CVD   RWRK1,WORKDBL       CONVERT                              20000020
         LR    RREC,RWRK1          INITIALIZE RREC                      20100020
         TM    CTRL2,DUSW+DSSW          DUMP ONLY SERV OR UNSRV@OY12272 20130091
         BNZ   DSDU                     YES                    @OY12272 20160091
         UNPK  FRSTMSG+35(6),WORKDBL+4(4)                               20200020
         OI    FRSTMSG+40,X'F0'                                         20300020
         $PRNT FRSTMSG,50               PRINT FIRST RECORD MESSAGE      20400020
RDREC    EQU   *                                               @OY12272 20420091
         OI    RR1BIT,ON                INDICATE THAT THE RECORD S21101 20450021
*                                         NUMBER IS TO BE        S21101 20460021
*                                         TREATED AS A DISK      S21101 20470021
*                                         RECORD NUMBER          S21101 20480021
         BAL   RIR1,FEDQFP         GO READ                              20500020
         NI    RR1BIT,OFF               TURN OFF THE FIRST-      S21101 20550021
*                                         RECORD-IN-THE-QUEUE    S21101 20560021
*                                         BIT                    S21101 20570021
         B     WRFSTHDR                 GO WRITE FIRST HEADER  @OY12272 20572091
         SPACE 2                                               @OY12272 20574091
DSDU     EQU   *                                               @OY12272 20576091
         UNPK  DSDUMSG+FORTYONE(SIXX),WORKDBL+FOURR(FOURR)     @OY12272 20578091
         OI    DSDUMSG+FORTYSIX,DIGIT                          @OY12272 20580091
         TM    CTRL2,DUSW               DUMP UNSERV MSG?       @OY12272 20582091
         MVC   DSDUMSG+ELEVEN(TWOO),DUMSG   ASSUME YES         @OY12272 20584091
         BO    PRTMSG                   PRINT MESSAGE          @OY12272 20586091
         MVC   DSDUMSG+ELEVEN(TWOO),DSMSG  PRINT SERV MSG      @OY12272 20588091
PRTMSG   EQU   *                                               @OY12272 20590091
         $PRNT DSDUMSG,58                                      @OY12272 20592091
         B     RDREC                    GO READ RECORD         @OY12272 20594091
         EJECT                                                          20600020
*********************************************************************** 20700020
***            FORMAT & WRITE FIRST HEADER PREFIX                   *** 20800020
*********************************************************************** 20900020
WRFSTHDR OC    PRFSUNIT(30),PRFSUNIT IS THIS END OF QUEUE       PTR1898 21100020
         BZ    EMPTYFST            IF YES, GO INDICATE END      PTR1898 21300020
         TM    PRFSTAT1,PRFNHDRN        HEADER                  SA59967 21500022
         BO    CHAINER1                 NO,ERROR                SA59967 21500122
         SR    RIR1,RIR1                CLEAR                   SA59967 21500222
         L     RIR1,UNIT                LENGTH OF UNIT          SA59967 21500322
         S     RIR1,SIX                 DECREMENT KEYLENGTH     SA59967 21500422
         AR    RIR1,RPRF                POINT TO DATA FLAGS     SA59967 21500522
         TM    ZERO(RIR1),ALLQUES       XTRA                    SA59967 21500622
         BO    CHAINER1                 YES,ERROR               SA59967 21500722
         MVC   NHDR+ONEE(THREE),PRFNHDR  NEXT HEADER           @OY12272 21504791
         TM    CTRL2,DUSW               DUMP UNSERV ONLY?      @OY12272 21508791
         BNO   HDR1                     NO                     @OY12272 21512791
         TM    ZERO(RIR1),DATSENT+DATCNCLD  MSG SERVICED OR        @01C 21516712
*                                           CANCELLED              @01A 21517712
         BNZ   MSGCHAIN                 YES, DO NOT PRINT          @01C 21520712
         SPACE 1                                                        21524791
HDR1     EQU   *                                               @OY12272 21528791
         TM    CTRL2,DSSW               DUMP SERV ONLY?        @OY12272 21532791
         BNO   HDR2                     NO                     @OY12272 21536791
         TM    ZERO(RIR1),DATSENT       MSG SERVICED?          @OY12272 21540791
         BNO   MSGCHAIN                 NO, DO NOT PRINT       @OY12272 21544791
         SPACE 1                                                        21548791
HDR2     EQU   *                                               @OY12272 21552791
         MVC   FORMATM(3),HDR+3    INDICATE HEADER              PTR1898 21570020
         MVC   RECORD(4),PRFCRCD-1      MOVE THE TCAM RECORD     S21101 21570221
*                                         NUMBER TO A FULL WORD  S21101 21570421
         UNPK  HEXRCD(7),RECORD+1(4)    UNPACK THE NUMBER        S21101 21570621
         TR    HEXRCD(6),HEXTABLE       TRANSLATE THE RECORD     S21101 21570821
*                                         NUMBER                        21571021
         MVC   FORMATM+3(6),HEXRCD GET HEX RECORD NUMBER        PTR1898 21640020
         TM    CTRL2,FMTSW              FORMAT DATFLAG FIELD   @OY12272 21642091
         BZ    HDR7                     NO                     @OY12272 21644091
         MVC   OUTBUF(ELEVEN),FORMATM   GET HEX RECORD FOR FMT @OY12272 21646091
         LA    RWRK1,OUTBUF             GET ADDR OF OUTPUT AREA@OY12272 21648091
         LA    RWRK1,ELEVEN(RWRK1)      INCREMENT              @OY12272 21650091
         MVC   ZERO(THREE,RWRK1),DSDUMSG  GET 3 ASTERISKS      @OY12272 21652091
         LA    RWRK1,FOURR(RWRK1)       INCREMENT              @OY12272 21654091
         TM    ZERO(RIR1),DATSENT       MSG MARKED SERVICED?   @OY12272 21656091
         BNO   HDR3                     NO                     @OY12272 21658091
         MVC   ZERO(NINE,RWRK1),SERV    GET SERVICE MSG        @OY12272 21660091
         LA    RWRK1,NINE(RWRK1)        INCREMENT POINTER      @OY12272 21662091
HDR3     EQU   *                                               @OY12272 21664091
         TM    ZERO(RIR1),DATCNCLD      MSG CANCELED?          @OY12272 21666091
         BNO   HDR4                     NO                     @OY12272 21668091
         MVC   ZERO(NINE,RWRK1),CANCLD  GET CANCELED MSG       @OY12272 21670091
         LA    RWRK1,NINE(,RWRK1)       INCREMENT POINTER      @OY12272 21672091
HDR4     EQU   *                                               @OY12272 21674091
         TM    ZERO(RIR1),DATIFEFO      INIT MSG ON PRI QCB    @OY12272 21676091
         BNO   HDR5                     NO                     @OY12272 21678091
         MVC   ZERO(NINE,RWRK1),INITFEFO  GET INIT FEFO MSG    @OY12272 21680091
         LA    RWRK1,NINE(,RWRK1)       INCREMENT POINTER      @OY12272 21682091
HDR5     EQU   *                                               @OY12272 21684091
         TM    ZERO(RIR1),DATINITL      MSG LOST?              @OY12272 21686091
         BNO   HDR6                     NO                     @OY12272 21688091
         MVC   ZERO(TWELVE,RWRK1),MSGLOST  INITIATE MSG LOST   @OY12272 21690091
         LA    RWRK1,TWELVE(RWRK1)      INCREMENT POINTER      @OY12272 21692091
HDR6     EQU   *                                               @OY12272 21694091
         MVC   ZERO(THREE,RWRK1),DSDUMSG  PUT IN LAST 3 *'S    @OY12272 21696091
         $PRNT OUTBUF,60,SP3                                   @OY12272 21698091
         MVI   FORMATM,BLNK             BLANK OUT AREA         @OY12272 21700091
         MVC   FORMATM+ONEE(TEN),FORMATM                       @OY12272 21702091
         $PRNT FORMATM,93                                      @OY12272 21704091
         B     HDR8                                            @OY12272 21706091
HDR7     EQU   *                                               @OY12272 21708091
         $PRNT FORMATM,93,SP3      INDICATE FIELD DEFINITION    PTR1898 21710020
HDR8     EQU   *                                               @OY12272 21750091
         TM    PRFSTAT1,PRFNLSTN   ONLY ONE BUFFER ?                    21800020
         BO    SAVENTXT            NO                                   21900020
         XC    NTXT(4),NTXT        IF YES, CLEAR POINTER        PTR1898 22000020
         B     SAVEXTRA                                                 22100020
SAVENTXT MVC   NTXT+1(3),PRFNTXT   SAVE PREFIX                          22200020
SAVEXTRA MVC   XTRA+1(3),PRFXTRA   CHAIN                                22300020
         BAL   RIR1,SETCNT              GO SET UNIT CNT         SA51078 22350022
         MVC   XTRA(1),PRFNBUNT    (SAVE NO OF UNITS)                   22400020
         SR    RWRK1,RWRK1         CLEAR RWRK1                          22500020
         IC    RWRK1,XTRA          ADJUST EXTRA FOR                     22600020
         S     RWRK1,ONE           NUMBER OF TIMES                      22700020
         STC   RWRK1,XTRA          THRU UNCHAIN                         22800020
         TM    PRFSTAT1,PRFNHDRN   IS THIS FIRST HEADER         PTR1898 23000020
         BNZ   WRAPERR             NO- ERROR                            23100020
         UNPK  OUTBUF+11(9),PRFNBUNT(5) FORMAT 1ST HEADER               23200020
         MVC   OUTBUF+19(2),BLANK                                       23300020
         UNPK  OUTBUF+21(5),PRFSRCE(3)                                  23400020
         MVC   OUTBUF+25(2),BLANK                                       23500020
         UNPK  OUTBUF+27(5),PRFSIZE(3)                                  23600020
         MVC   OUTBUF+31(2),BLANK                                       23700020
         UNPK  OUTBUF+33(3),PRFSTAT1(2)                                 23800020
         MVC   OUTBUF+35(2),BLANK                                       23900020
         UNPK  OUTBUF+37(7),PRFXTRA(4)                                  24000020
         MVC   OUTBUF+43(2),BLANK                                       24100020
         UNPK  OUTBUF+45(5),PRFSCAN(3)  SCAN POINTER TO AREA   @OY19630 24200000
         MVC   OUTBUF+49(2),BLANK                                       24300020
         UNPK  OUTBUF+51(7),PRFNTXT(4)                                  24400020
         MVC   OUTBUF+57(2),BLANK                                       24500020
         UNPK  OUTBUF+59(7),PRFCRCD(4)                                  24600020
         MVC   OUTBUF+65(2),BLANK                                       24700020
         UNPK  OUTBUF+67(7),PRFNHDR(4)                                  24800020
         MVC   OUTBUF+73(2),BLANK                                       24900020
         UNPK  OUTBUF+75(7),PRFHQBCK(4)                                 25000020
         MVC   OUTBUF+81(2),BLANK                                       25100020
         UNPK  OUTBUF+83(5),PRFISEQ(3)                                  25200020
         MVC   OUTBUF+87(2),BLANK                                       25300020
         UNPK  OUTBUF+89(5),PRFDEST(3)                                  25400020
         MVC   OUTBUF+93(10),BLANK                                      25500020
         MVC   OUTBUF+103(10),BLANK                                     25600020
         MVC   OUTBUF+113(6),BLANK                                      25700020
         TR    OUTBUF(120),HEXTABLE XLATE TO PRINTABLE HEX      PTR1898 25800020
         $PRNT OUTBUF                   PRINT FILLED BUFFER             25900020
         LA    RDTA,PRFDEST+2                                           26000020
         BAL   RIR1,FMTDATA                                             26100020
         B     UNTCHAIN                                                 26200020
EMPTYFST MVC   OUTBUF+3(6),HEXRCD  INDICATE RECORD NUMBER       PTR1898 26300020
         MVC   OUTBUF+11(20),BLNKMSG                                    26400020
         $PRNT OUTBUF                   PRINT FILLED BUFFER             26500020
         TM    CTRL,ALLQUES        ALL SPECIFIED ?                      26600020
         BO    GETNEXT             YES                                  26700020
         L     RWRK1,NEXTQUE       GET NEXT QUEUE                       26800020
         LA    RWRK1,4(RWRK1)      BUMP TO NEXT REQ                     26900020
         ST    RWRK1,NEXTQUE       SAVE REQ &                           27000020
         B     GETNEXT                                                  27100020
         EJECT                                                          27200020
*********************************************************************** 27300020
*                                                                     * 27400020
*              UNIT CHAIN   FIND NEXT RECORD UNIT                     * 27500020
*                                                                     * 27600020
*********************************************************************** 27700020
UNTCHAIN L     RREC,XTRA           GET REC NO OF NEXT UNIT              27800020
         LA    RWRK1,0                                                  27900020
         IC    RWRK1,XTRA                                               28000020
         LTR   RWRK1,RWRK1         NOW ZERO                             28100020
         BZ    BFRCHAIN            YES                                  28200020
         BAL   RIR1,FEDQFP         GO READ                              28300020
         SR    RIR1,RIR1                CLEAR                   SA59967 28300122
         L     RIR1,UNIT                POINT TO END OF UNIT    SA59967 28300222
         S     RIR1,SIX                 POINT TO DATA FLAGS     SA59967 28300322
         AR    RIR1,RPRF           ADD UNIT PTR                 SA59967 28300422
         TM    ZERO(RIR1),ALLQUES       XTRA                    SA59967 28300522
         BNO   CHAINER2                 NO,ERROR                SA59967 28300622
         MVC   OUTBUF+3(6),HEXRCD  INDICATE RECORD NUMBER       PTR1898 28400020
         LR    RDTA,RPRF           SET ADDR OF DATA                     28600020
         BAL   RIR1,FMTDATA        GO FORMAT + WRITE DATA               28700020
         L     RREC,XTRA                                                28800020
         LA    RWRK1,TWOO               SET INCREMENT OF TWO       @21C 28828527
         TM    CTRL,REUS                IS IT REUSABLE QUEUE       @21C 28857027
         BO    ADDTWO1                  YES, ADD 2 FOR REUS        @21C 28885527
         LA    RWRK1,FOURR              NONREUS QUEUE, ADD 4       @21C 28914027
ADDTWO1  EQU   *                                                   @21C 28942527
         AR    RREC,RWRK1               BUMP TO NEXT UNIT ADDR     @21C 28971027
         LA    RWRK1,0             DECREMENT                            29000020
         IC    RWRK1,XTRA          UNIT COUNT                           29100020
         S     RWRK1,ONE                                                29200020
         ST    RREC,XTRA           SAVE                                 29300020
         STC   RWRK1,XTRA          SAVE UNIT COUNT                      29400020
         B     UNTCHAIN                                                 29500020
         EJECT                                                          29600020
*********************************************************************** 29700020
*                                                                     * 29800020
*              FIND NEXT BUFFER IN THE MESSAGE                        * 29900020
*                                                                     * 30000020
*********************************************************************** 30100020
BFRCHAIN L     RREC,NTXT           GET ADDR NEXT BFR                    30200020
         LTR   RREC,RREC           END OF BFR CHAIN ?                   30300020
         BZ    MSGCHAIN            YES- GET  NEXT MSG                   30400020
         BAL   RIR1,FEDQFP         GO READ                              30500020
         OC    PRFSUNIT(22),PRFSUNIT IS THIS END OF BFR CHAIN   PTR1898 30700020
         BZ    NXTMSG              IF YES, GO GET NEXT HEADER   PTR1898 30800020
         TM    PRFSTAT1,PRFNHDRN        HEADER                  SA59967 30800122
         BZ    CHAINER2                 YES,ERROR               SA59967 30800222
         SR    RIR1,RIR1                CLEAR                   SA59967 30800322
         L     RIR1,UNIT                POINT TO END OF UNIT    SA59967 30800422
         S     RIR1,SIX                 POINT TO DATA FLAGS     SA59967 30800522
         AR    RIR1,RPRF           ADD UNIT PTR                 SA59967 30800622
         TM    ZERO(RIR1),ALLQUES       XTRA                    SA59967 30800722
         BO    CHAINER2                 YES ,ERROR              SA59967 30800822
         L     RIR1,PRFCHDR             HDR POINTER             SA59967 30800922
         SRL   RIR1,8                   MOVE OUT STAT FIELD     SA59967 30801022
         LA    RIR1,ZERO(RIR1)          CLEAR BYTE              SA59967 30801122
         TM    CTRL,SUBSTEXT            SUBSEQUENT TEXT RECORD  SA59967 30801222
         BZ    SKIPLCB                  NO,DONT COMPARE LCB     SA59967 30801322
         C     RIR1,RDSAVE+52                                   SA59967 30801422
         BNE   CHAINER2                 NO,ERROR                SA59967 30801522
         B     DONTSET                  CONTINUE PROCESSING RCD SA59967 30801622
SKIPLCB  EQU   *                                                SA59967 30801722
         ST    RIR1,RDSAVE+52           STORE LCB FOR NEXT PASS SA59967 30801822
         OI    CTRL,SUBSTEXT            SUBSEQUENT TEXT RECORD  SA59967 30801922
DONTSET  EQU   *                                                SA59967 30802022
         MVC   FORMATM(3),BFR+3    INDICATE BUFFER              PTR1898 30900020
         MVC   FORMATM+3(6),HEXRCD GET HEX RECORD NUMBER        PTR1898 31000020
         $PRNT FORMATM,73,SP2      PRINT PARTIAL HEADER         PTR1898 31100020
         TM    PRFSTAT1,PRFNLSTN   ONLY ONE BUFFER ?                    31200020
         BO    SVNTXT              NO                                   31300020
         XC    NTXT(4),NTXT        IF YES, CLEAR WORK POINTER   PTR1898 31400020
         B     SVXTRA                                                   31500020
SVNTXT   MVC   NTXT+1(3),PRFNTXT   SAVE PREFIX                          31600020
SVXTRA   MVC   XTRA+1(3),PRFXTRA    CHAIN POINTERS                      31700020
         BAL   RIR1,SETCNT              GO SET UNIT CNT         SA51078 31750022
         MVC   XTRA(1),PRFNBUNT    (SAVE NO OF UNITS)                   31800020
         SR    RWRK1,RWRK1         CLEAR RWRK1                          31900020
         IC    RWRK1,XTRA          ADJUST EXTRA FOR                     32000020
         S     RWRK1,ONE           NUMBER OF TIMES                      32100020
         STC   RWRK1,XTRA          THRU UNCHAIN                         32200020
         UNPK  OUTBUF+11(9),PRFNBUNT(5) FORMAT BUFFER HEADER            32300020
         MVC   OUTBUF+19(2),BLANK                                       32400020
         UNPK  OUTBUF+21(5),PRFSRCE(3)                                  32500020
         MVC   OUTBUF+25(2),BLANK                                       32600020
         UNPK  OUTBUF+27(5),PRFSIZE(3)                                  32700020
         MVC   OUTBUF+31(2),BLANK                                       32800020
         UNPK  OUTBUF+33(3),PRFSTAT1(2)                                 32900020
         MVC   OUTBUF+35(2),BLANK                                       33000020
         UNPK  OUTBUF+37(7),PRFXTRA(4)                                  33100020
         MVC   OUTBUF+43(2),BLANK                                       33200020
         UNPK  OUTBUF+45(5),PRFSCAN(3)  SCAN POINTER TO AREA   @OY19630 33300000
         MVC   OUTBUF+49(2),BLANK                                       33400020
         UNPK  OUTBUF+51(7),PRFNTXT(4)                                  33500020
         MVC   OUTBUF+57(2),BLANK                                       33600020
         UNPK  OUTBUF+59(7),PRFCRCD(4)                                  33700020
         MVC   OUTBUF+65(2),BLANK                                       33800020
         UNPK  OUTBUF+67(7),PRFCHDR(4)                                  33900020
         MVC   OUTBUF+73(2),BLANK                                       34000020
*                                                                       34100020
*              OUTBUF  HAS  75  BYTES  OF  DATA                         34200020
*                                                                       34300020
         TR    OUTBUF(75),HEXTABLE XLATE TO PRINTABLE HEX       PTR1898 34400020
         $PRNT OUTBUF                   PRINT FILLED BUFFER             34600020
         LA    RDTA,PRFCHDR+3                                           34700020
         BAL   RIR1,FMTDATA        GO FORMAT AND WRITE DATA             34800020
         B     UNTCHAIN                                                 34900020
NXTMSG   MVC   OUTBUF+3(6),HEXRCD  MOVE RECORD NUMBER TO PRINT  PTR1898 35000020
         MVC   OUTBUF+11(20),BLNKMSG                                    35100020
         $PRNT OUTBUF                   PRINT FILLED BUFFER             35200020
MSGCHAIN L     RREC,NHDR           GET ADDR NEXT HDR                    35300020
         NI    CTRL,REUS+ALLQUES+DUMP   INDICATE NO SUBSEQUENTTXSA59967 35350022
         BAL   RIR1,FEDQFP         GO READ                              35400020
         B     WRFSTHDR            GO WRITE IT                          35500020
         EJECT                                                          35600020
*********************************************************************** 35700020
*              FORMAT AND WRITE OUT RECORD DATA                       * 35800020
*                                                                     * 35900020
*********************************************************************** 36000020
FMTDATA  A     RPRF,UNIT           GET ADDR END OF BFR                  36100020
         ST    RIR1,WORKDBL        SAVE RETURN REG                      36200020
DATALOOP LR    RWRK1,RPRF                                               36300020
         SR    RWRK1,RDTA          AMOUNT OF BFR LEFT                   36400020
         C     RWRK1,BLOCK         LESS THAN 32                         36500020
         BL    FMTLAST             YES- USE RWRK1 FOR MOVE              36600020
         LA    RWRK1,32            SET DATA COUNT TO 32                 36700020
         MVI   OUTBUF+86,C'*'      SET EBCIDIC INDICATOR                36800020
         MVC   OUTBUF+87(32),0(RDTA)    MOVE DATA TO EBCIDIC            36900020
         MVI   OUTBUF+119,C'*'     AREA & SET END INDICATOR             37000020
         LA    RDTA,32(RDTA)                                            37100020
XLATE    ST    RWRK1,WORKDBL+4     SAVE ADJUSTED DATA COUNT             37200020
         LR    RWRK2,RWRK1         GET DATA COUNT                       37300020
         AR    RWRK2,RWRK2         DOUBLE FOR UNPK                      37400020
         S     RWRK2,ONE           BUMP FOR UNPK                        37500020
UNPKLOOP IC    RWRK3,OUTBUF+86(RWRK1)   GET CHAR                        37600020
         STC   RWRK3,XWK(RWRK2)    STORE RIGHT HALF                     37700020
         BCTR  RWRK2,0             DECREMENT WORK COUNT                 37800020
         SRL   RWRK3,4             SHIFT TO LEFT HALF                   37900020
         STC   RWRK3,XWK(RWRK2)    STORE LEFT HALF                      38000020
         BCTR  RWRK2,0             DECREMENT WORK COUNT                 38100020
         BCT   RWRK1,UNPKLOOP      DECREMENT DATA COUNT, DO SOME MORE   38200020
         L     RWRK1,WORKDBL+4     RESTORE DATA COUNT                   38300020
         AR    RWRK1,RWRK1         DOUBLE FOR ADDING ZONES              38400020
         S     RWRK1,TWO           ADJUST FOR MOVE ZONES                38500020
         OI    XWK,X'F0'           MOVE ZONE BITS                       38600020
         EX    RWRK1,MOVEZON       INTO WORK AREA                       38700020
         MVC   OUTBUF+11(8),XWK    MOVE CHARS TO OUTPUT AREA            38800020
         MVC   OUTBUF+20(8),XWK+8                                       38900020
         MVC   OUTBUF+29(8),XWK+16                                      39000020
         MVC   OUTBUF+38(8),XWK+24                                      39100020
         MVC   OUTBUF+48(8),XWK+32                                      39200020
         MVC   OUTBUF+57(8),XWK+40                                      39300020
         MVC   OUTBUF+66(8),XWK+48                                      39400020
         MVC   OUTBUF+75(8),XWK+56                                      39500020
         TR    OUTBUF+11(75),HEXTABLE XLATE TO PRINTABLE HEX    PTR1898 39600020
         TR    OUTBUF+87(32),EBCTABLE                                   39700020
         $PRNT OUTBUF                   PRINT FILLED BUFFER             39800020
         B     DATALOOP                                                 39900020
FMTLAST  LTR   RWRK1,RWRK1         FINISHED                             40000020
         BZ    DONEDATA            YES                                  40100020
         MVI   OUTBUF+87,C' '      BLANK OUT                            40200020
         MVC   OUTBUF+88(31),OUTBUF+87  AREA                            40300020
         MVI   XWK,X'EF'           CLEAR WORK AREA                      40400020
         MVC   XWK+1(63),XWK       TO X'EF' BLANKS                      40500020
         LR    RWRK2,RWRK1         SUB ONE                              40600020
         S     RWRK2,ONE           FOR MVC                              40700020
         EX    RWRK2,LASTDATA      MOVE LAST DATA                       40800020
         MVI   OUTBUF+86,C'*'      SET BEGIN +                          40900020
         MVI   OUTBUF+119,C'*'     END INDICATOR                        41000020
         LR    RPRF,RDTA           SET DATA=END                         41100020
         B     XLATE                                                    41200020
DONEDATA L     RIR1,WORKDBL                                             41300020
         BR    RIR1                                                     41400020
         EJECT                                                          41500020
*********************************************************************** 41600020
*                                                                     * 41700020
*              DUMP MSGQUE SEQUENTIALY                                * 41800020
*                                                                     * 41900020
*********************************************************************** 42000020
DUMPQUE  EQU   *                                                 S21101 42000221
         OI    RR1BIT,ON                INDICATE THE ABSOLUTE    S21101 42000421
*                                         RECORD NUMBER IS TO BE S21101 42000621
*                                         USED, NOT THE TCAM     S21101 42000821
*                                         RECORD NUMBER          S21101 42001021
         ST    RREC,RR1RECD             SAVE THE FIRST RECORD    S21101 42001221
*                                         NUMBER                 S21101 42001421
DUMPLOOP BAL   RIR1,FEDQFP         GO READ                              42200020
         OC    PRFSUNIT(30),PRFSUNIT    IS THIS A ZERO RECORD    S21101 42250021
         BZ    BALINCR                  YES, BRANCH              S21101 42260021
         L     RREC,UNIT                GET UNIT SIZE            S21903 42270022
         SH    RREC,DATSIZE             DECR BY DATA SIZE        S21903 42271022
         AR    RREC,RPRF                POINT TO DATA FIELD      S21903 42272022
         USING IEDQDATA,RREC            DATA FIELD BASE          S21903 42273022
         MVC   RECORD(4),PRFCRCD-1      SET RCD NO THIS RCD      S21903 42274022
         TM    DATFLAGS,DATNPRFX        DOES RCD HAVE PREFIX     S21903 42275022
         BZ    YESPRFX1                 YES-CHECK FOR ZERO REC     @11C 42276026
         MVC   RECORD(4),DATFEFO-1      SET RCD NO THIS RCD      S21903 42277022
         B     YESPRFX                  PROCESS RECORD             @11A 42277126
YESPRFX1 EQU   *                                                   @11A 42277226
         OC    PRFSUNIT(30),PRFSUNIT    IS THIS A ZERO RECORD      @11A 42277326
         BZ    BALINCR                  YES-BRANCH                 @11A 42277426
         DROP  RREC                                                     42277526
YESPRFX  EQU   *                                                 S21903 42279022
         UNPK  HEXRCD(7),RECORD+1(4)    UNPACK THE NO            S21903 42280022
         TR    HEXRCD(6),HEXTABLE       TRANSLATE FOR PRINT      S21903 42281022
         TM    SCANBYTE,ON              IS SCAN TO BE DONE       S21903 42282022
         BZ    MOVERECD                 BRANCH IF NO             S21903 42283022
         CLC   RECORD+1(3),PACKFLD1     IS THIS RECORD INCLUDED  S21903 42284022
*                                       IN THE RANGE             S21903 42285022
         BL    BALINCR                  BRANCH IF NO             S21903 42286022
         CLC   RECORD+1(3),PACKFLD2     DOES THIS RECORD EXCEED  S21903 42287022
*                                       THE SPECIFIED RANGE      S21903 42288022
         BH    WTORTNE2                 BRANCH IF YES            S21903 42289022
MOVERECD EQU   *                                                 S21903 42290022
         MVC   OUTBUF+3(6),HEXRCD  INDICATE RECORD NUMBER       PTR1898 42300020
         MVI   OUTAREA,C'0'        INDICATE DOUBLE SPACE        PTR1898 42400020
         LR    RDTA,RPRF           SET ADDR OF DATA                     42500020
         BAL   RIR1,FMTDATA        GO FORMAT DATA + WRITE               42600020
BALINCR  EQU   *                                                 S21101 42650021
         BAL   RIR1,INCRECNT            INCREMENT THE COUNT      S21101 42660021
         SPACE 2                                                        42670021
         L     RREC,RECORD              GET THE PREVIOUS TCAM    S21101 42680021
*                                         RECORD NUMBER          S21101 42690021
         LA    RIR1,TWOO                SET INCREMENT OF TWO       @21C 42740027
         TM    CTRL,REUS                IS IT REUSABLE QUEUE       @21C 42790027
         BO    ADDTWO2                  YES, ADD 2 FOR REUS        @21C 42840027
         LA    RIR1,FOURR               NONREUS QUEUE, ADD 4       @21C 42890027
ADDTWO2  EQU   *                                                   @21C 42940027
         AR    RREC,RIR1                BUMP TO NEXT UNIT ADDR     @21C 42990027
         B     DUMPLOOP            LOOP                                 43100020
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - READ MESSAGE QUEUE ROUTINE' 43200020
*********************************************************************** 43300020
***            COMPUTE MBBCCHHR USING IEDQFP RTNE                   *** 43400020
***            FROM IGG019RC. THEN READ THE RECORD.                 *** 43500020
***                                                                 *** 43600020
*********************************************************************** 43700020
FEDQFP   STM   0,12,RDSAVE                                              43800020
         ST    RREC,RECORD                                              43900020
         L     RREC,RR1RECD             RESET THE ABSOLUTE       S21101 43910021
*                                         RECORD NUMBER          S21101 43920021
         TM    RR1BIT,ON                IS THE FIRST-RECORD-IN-  S21101 43922021
*                                         THE-QUEUE BIT ON       S21101 43924021
         BO    UNPACKIT                 YES, DO NOT ADJUST THE   S21101 43926021
*                                         RECORD NUMBER          S21101 43928021
         L     RREC,RECORD              GET THE TCAM RECORD      S21101 43928421
*                                        NUMBER OF NEXT UNIT       @21C 43928527
         TM    CTRL,REUS                IS IT REUSABLE QUEUE       @21C 43928627
         BZ    NREUS                    NO, NONREUSABLE            @21C 43928727
         LA    RREC,ONEE(,RREC)         BUMP NUMBER BY ONE         @21C 43928827
         SRL   RREC,ONEE                DIVIDE BY TWO              @21C 43928927
         B     UNPACKIT                 SKIP NONREUS CODE          @21C 43929027
NREUS    EQU   *                                                   @21C 43929127
         LA    RREC,THREE(,RREC)        BUMP THE RECORD NUMBER   S21101 43929621
*                                         BY THREE               S21101 43929721
         SRL   RREC,FOUR                DIVIDE BY FOUR           S21101 43929821
UNPACKIT EQU   *                                                 S21101 43929921
         UNPK  HEXRCD(7),RECORD+1(4) GET REC NUMBER TO HEX      PTR1898 43930020
         TR    HEXRCD(6),HEXTABLE  TRANSLATE TO PRINTABLE HEX   PTR1898 43960020
         LA    R1,0(RREC)          CLEAR HI ORD BYTE                    44000020
         SR    R0,R0               CLEAR EVEN REG                       44100020
         L     RTOTNO,TOTNO        LOAD TOTAL # REC                     44200020
         DR    R1-1,RTOTNO         REC#/TOTAL REC                       44300020
         SRDA  R0,32               REMAINDER TO ODD RED                 44400020
         D     R1-1,VOLRT               REL REC/(#VOLS * REC/TRK)       44500020
         LR    R3,R1               GET REL TRK                          44600020
         SR    R2,R2               CLEAR EVEN REG                       44700020
         D     R3-1,TRCYL               DIVIDE BY #TRK/CYL              44800020
         SRDA  R0,32               CLEAR EVEN REG                       44900020
         D     R1-1,RCTRK               REL REC/REC PER TRACK           45000020
         XR    R1,R0                                                    45100020
         XR    R0,R1                                                    45200020
         XR    R1,R0                                                    45300020
         SPACE  3                                                       45400020
***            R0=M, BB=00, R2=HH, R1=R, R3= REL CYL                    45500020
         SPACE  3                                                       45600020
         LR    RTOTNO,R0           GET PROPER DCB                       45700020
         SLL   RTOTNO,2                 MULTIPLY BY 4                   45800020
         L     RTOTNO,DCB(RTOTNO)                                       45900020
         TM    48(RTOTNO),X'10'                                         46000020
         BZ    CHAINERR                                                 46100020
         XC    6(2,RTOTNO),6(RTOTNO) ZERO BB                    PTR1898 46200020
         STC   R2,11(RTOTNO)       STORE                                46300020
         SRL   R2,8                HH                                   46400020
         STC   R2,10(RTOTNO)                                            46500020
         STC   R1,12(RTOTNO)       STORE R                              46600020
         L     R2,44(RTOTNO)       GET DEB ADDRESS                      46700020
         LA    R2,32(R2)           GET DEB EXTENT                       46800020
         AH    R3,6(R2)            GET ACTUAL CYL ADDR                  46900020
         STC   R3,9(RTOTNO)        STORE                                47000020
         SRL   R3,8                CC                                   47100020
         STC   R3,8(RTOTNO)                                             47200020
         NOTE  (RTOTNO)                 ISSUE NOTE TO LOCATE       @02A 47210012
*                                       BLOCK                      @02A 47220012
         ST    R1,POINTARG              STORE ARG IN TTRZ          @02A 47230012
         MVI   Z,ONEE                   SET SEARCH FOR NEXT        @02A 47240012
         LA    R0,POINTARG              SET PARAMETER LIST         @02A 47250012
         POINT (RTOTNO),(R0)            ISSUE POINT TO POSITION    @02A 47260012
*                                       BLOCK                      @02A 47270012
         READ  RDECB,SF,(RTOTNO),INBUF,'S'                              47300020
         CHECK  RDECB                                                   47400020
         TM    FRSTRCD,ON               FIRST RCD FOR INDIVDUAL SA50211 47402022
*                                       QUEUE DUMP?             SA50211 47404022
         BNO   NOCHECK                  NO,BYPASS LOGICAL READ  SA50211 47406022
*                                       ERROR CHECK             SA50211 47408022
         NI    FRSTRCD,ZERO             TURN SWITCH OFF         SA50211 47410022
         OC    INBUF(30),INBUF          END OF QUEUE?           SA50211 47412022
         BZ    NOCHECK                  YES,DON'T CHECK FOR     SA50211 47414022
*                                       LOGICAL READ ERROR      SA50211 47416022
         SR    R2,R2                    CLEAR REG TWO           SA50211 47418022
         L     R3,INBUF+16              LOAD RCD # IN BUFFER    SA50211 47420022
         N     R3,X0FFF                 CLEAR HIGH ORDER BYTE   SA50211 47422022
         LA    R1,TWOO                  SET TO DIVIDE BY TWO       @21C 47422727
         LA    R3,ONEE(,R3)             INCREMENT NUMBER BY 1      @21C 47423427
         TM    CTRL,REUS                IS IT REUSABLE QUEUE       @21C 47424127
         BO    REUSQ                    YES, DIVIDE BY TWO         @21C 47424827
         LA    R1,FOURR                 SET TO DIVIDE BY FOUR      @21C 47425527
         LA    R3,TWOO(,R3)             INCREMENT BY TWO MORE      @21C 47426227
REUSQ    EQU   *                                                   @21C 47426927
         DR    R2,R1                    DIVIDE REC # BY FOUR    SA50211 47428022
         CL    R3,RR1RECD               RCD # SAME AS REQUESTD? SA50211 47430022
         BE    NOCHECK                  YES,NO LOGICAL READ ERR SA50211 47432022
         LTR   R2,R2                    IS REMAINDER ZERO?      SA50211 47434022
         BZ    NOCHECK                  YES,NON-REUSABLE QUEUES SA50211 47436022
WTOR1    EQU   *                                                SA50211 47438022
         WTOR  'IED150D TCAM REUSABLE Q WRAPPED REPLY D TO DUMP ENTIRE *47440022
               MSG DATA SET OR C TO CANCEL',RPLY,1,ECBAD                47442022
         LR    R2,R1                                            SA50211 47444022
         DOM   MSG=(2)                                          SA50211 47446022
         WAIT  ECB=ECBAD                                        SA50211 47448022
         XC    ECBAD,ECBAD              CLEAR ECB               SA50211 47450022
         CLI   RPLY,C                   CANCEL REQUESTED?       SA50211 47452022
         BE    ENDED                    YES,END XC              SA59967 47454022
         CLI   RPLY,D                   DUMP REQUESTED?         SA50211 47456022
         BNE   WTOR1                    REISSUE WTOR            SA50211 47458022
         OI    CTRL,DUMP                SET DUMP REQUEST FLAG   SA50211 47460022
         XC    QUESTART,QUESTART        CLEAR TO DUMP 1ST RCD   SA50211 47462022
         B     RETURN                   START DUMP OF ENTIRE Q  SA50211 47464022
NOCHECK  EQU   *                                                SA50211 47466022
         LM    0,12,RDSAVE                                              47500020
         LA    RPRF,INBUF          GET ADDR BUFFER                      47600020
         BR    RIR1                RETURN TO CALLING RTNE               47700020
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - PARAMETER SCAN ROUTINE    ' 47800020
*********************************************************************** 47900020
***            GET PARM VALUES & INITIALIZE MSGQUEUE VALUES         *** 48000020
****                     Q=NNN,AAA,BBB,CCC,DDD,EEE                 **** 48100020
***                                                                 *** 48200020
*********************************************************************** 48300020
QFORMAT  LH    R3,FMT1DSCB+52           GET NUM OF CYLS IN EXTENT       48400020
         ST    R3,CYLVOL                SAVE FOR LATER USE              48500020
         LH    R3,FMT1DSCB+54           GET TT OF LAST RECORD           48600020
         LA    R3,1(,R3)                ADD 1 TO GET TOTAL NUM TRACKS   48700020
         SR    R14,R14                  CLEAR IC REG                    48800020
         IC    R14,FMT1DSCB+56          GET R OF LAST RECORD            48900020
         ST    R14,RCTRK                SAVE FOR GET REC ALGORITHM      49000020
         MR    R3-1,R14                 CALC TOTAL NUM RECORDS IN EXT   49100020
         ST    R3,TOTNO                 PLACE VALUE INTO SAVE AREA      49200020
         LA    R14,DCBLIST              GET ADDR OF DCB LIST            49300020
         SR    R2,R2                    INITIALIZE VOL COUNT TO ZERO    49400020
VOLLOOP  L     R3,0(,R14)               GET ADDR OF DCB TO TEST         49500020
         TM    48(R3),X'10'             IS DCB OPEN                     49600020
         BZ    *+8                      IF NO, DON'T ADD TO COUNT       49700020
         LA    R2,1(,R2)                ADD ONE TO VOLUME COUNT         49800020
         LA    R14,4(,R14)              BUMP TO GET NEXT DCB            49900020
         LTR   R3,R3                    WAS THIS THE LAST DCB TO TEST   50000020
         BP    VOLLOOP                  IF NO, LOOP UNTIL DONE          50100020
         ST    R2,NOVOL                 SAVE VOLUME COUNT               50200020
         LR    R3,R2                    SHIFT VOL COUNT FOR MULTIPLY    50300020
         M     R3-1,TOTNO               VOLS * (REC/VOL) = TOTAL RECDS  50400020
         ST    R3,TOTNO                 SAVE FOR READ ROUTINE           50500020
         L     RWRK1,0(,R1)             GET PARM POINTER                50600020
         CLI   1(RWRK1),X'00'           ARE NO PARAMETERS SPECIFIED     50700020
         BE    SETDMP                   IF YES, GIVE SEQUENTIAL DUMP    50800020
         CLI   1(RWRK1),PARMLNG         IS THE PARM LENGTH OK           50900020
         BH    PARMERR             TOO LARGE                            51000020
         LH    RWRK2,0(RWRK1)      GET LENGTH                           51100020
         BCTR  RWRK2,0                  DECREMENT LENGTH BY 1    A42375 51150020
         EX    RWRK2,GETPARM       MOVE PARM TO WORKAREA                51200020
         CLC   WKNUMQE,QEQUAL           CHECK FORMAT             A42375 51400020
         BNE   PARMERR                                                  51600020
         CLC   WKNUMX(4),PART           CHECK FOR Q=PART         S21903 51606022
         BE    SETPART                  BRANCH IF YES            S21903 51612022
         CLC   WKNUMX(3),DMP            CHECK FOR Q=DMP        @XA08072 51620009
         BE    SETDMP                   IF YES, SET DUMP REQUEST A42375 51640020
         LA    RWRK1,WKNUMX             GET THE ADDR OF THE    @XA08072 51660009
*                                       FIRST PARAMETER        @XA08072 51690009
         LA    RWRK3,FOURR              SET LOOP COUNT         @XA08072 51720009
         LR    RWRK2,RWRK1              LOAD INDEX REGISTER    @XA08072 51750009
PARMLP1  EQU   *                                               @XA08072 51800009
         TM    0(RWRK2),DIGIT           IS THIS A DECIMAL DIGIT@XA08072 51850009
         BNO   PARMERR                  NO, GO PRINT ERROR     @XA08072 51900009
         LA    RWRK2,ONEE(RWRK2)        INCREMENT INDEX        @XA08072 51930009
         CLI   0(RWRK2),COMMA           IS THIS A COMMA        @XA08072 51960009
         BE    OUT1                     YES, PACK DIGITS       @XA08072 52000009
         BCT   RWRK3,PARMLP1            LOOP 4 TIMES           @XA08072 52050009
         B     PARMERR                  NUM QUEUES SPECIFIED   @XA08072 52100009
*                                       AS MORE THAN 4 DIGITS  @XA08072 52130009
OUT1     EQU   *                                               @XA08072 52160009
         SR    RWRK2,RWRK1              GET THE NR. OF DIGITS  @XA08072 52200009
         BCTR  RWRK2,0                  SUBTRACT 1 FROM LENGTH @XA08072 52250009
         EX    RWRK2,PACKNUM            PACK NR. OF QUEUES     @XA08072 52300009
         AR    RWRK1,RWRK2              POINT TO NEXT PARM-2   @XA08072 52330009
         CVB   RWRK2,WORKDBL            CONVERT NR QUEUES TO   @XA08072 52360009
         ST    RWRK2,NUMQUES            HEX AND STORE          @XA08072 52400009
         LA    RWRK1,TWOO(RWRK1)        INDEX PAST COMMA       @XA08072 52450009
         ST    R13,SAVE13               SAVE REG 13            @OY12272 52470091
         CLC   0(THREE,RWRK1),ALL       ALL QUEUES REQUESTED   @XA08072 52500009
         BE    SETALL                   YES                    @XA08072 52530009
         CLC   0(THREE,RWRK1),DMP       IS QUEDUMP REQUESTED?  @XA08072 52560009
         BE    SETDMP                   YES                    @XA08072 52600009
         LA    RWRK3,QREQ1              GET THE ADDR OF FIRST  @XA08072 52650009
*                                       STORAGE AREA FOR QUEUE @XA08072 52700009
*                                       REQUEST                @XA08072 52730009
         LA    RREC,FIVE                SET LOOP COUNT OF 5    @XA08072 52760009
PARMLP2  EQU   *                                               @XA08072 52850009
         LA    R13,FIVE                 SET LOOP COUNT OF 5    @XA08072 52900009
         LR    RWRK2,RWRK1              LOAD INDEX REGISTER    @XA08072 52930009
PARMLP3  EQU   *                                               @XA08072 52960009
         TM    0(RWRK2),DIGIT           IS THIS A DECIMAL DIGIT@XA08072 53000009
         BNO   OUT2                     NO, CHECK FOR COMMA    @XA08072 53050009
         LA    RWRK2,ONEE(RWRK2)        INCREMENT BY ONE       @XA08072 53100009
         BCT   R13,PARMLP3              CHECK NEXT DIGIT       @XA08072 53130009
         B     PARMERR                  TOO MANY DIGITS IN PARM@XA08072 53160009
OUT2     EQU   *                                               @XA08072 53190009
         CLI   0(RWRK2),COMMA           IS THIS A COMMA        @XA08072 53220009
         BE    SKIP3                    YES, SKIP TO END       @XA08072 53250009
         CLI   0(RWRK2),ZERO            BLANK ?                @XA08072 53280009
         BNE   PARMERR                  NO, PARAMETER ERROR    @XA08072 53310009
         LA    RREC,ONEE                SET REGISTER TO EXIT   @XA08072 53400009
SKIP3    EQU   *                                               @XA08072 53450009
         SR    RWRK2,RWRK1              GET NR. OF DIGITS      @XA08072 53500009
         LTR   RWRK2,RWRK2              WERE THERE ANY DIGITS  @XA08072 53520009
*                                       AFTER COMMA            @XA08072 53550009
         BZ    PARMERR                  NO, PARAMETER ERROR    @XA08072 53600009
         BCTR  RWRK2,0                  SUBTRACT 1 FROM LENGTH @XA08072 53650009
         EX    RWRK2,PACKNUM            PACK QUEUE NUMBER      @XA08072 53700009
         AR    RWRK1,RWRK2              POINT TO NEXT PARM-2   @XA08072 53730009
         LA    RWRK1,TWOO(RWRK1)        INDEX PAST COMMA       @XA08072 53760009
         CVB   RWRK2,WORKDBL            CONVERT NR. QUEUES TO  @XA08072 53800009
         ST    RWRK2,0(RWRK3)           HEX AND STORE IN THE   @XA08072 53850009
*                                       AREA FOR QUEUE REQUEST @XA08072 53900009
         LA    RWRK3,FOURR(RWRK3)       UPDATE REQUEST ADDR    @XA08072 53930009
         CLI   ONEE(RWRK1),ZERO         END OF FIELD           @OX13503 53932000
         BE    FINISHED                 YES                    @OX13503 53934000
         TM    ZERO(RWRK1),DIGIT        IS THIS IS DIGIT?      @OY12272 53940091
         BNO   CHKSERV                  NO                     @OY12272 53950091
FINISHED EQU   *                                               @OX13503 53955000
         BCT   RREC,PARMLP2             PROCESS NEXT QUEUE REQU@XA08072 53960009
         L     R13,SAVE13               RESTORE REG 13         @XA08072 54000009
         BR    RIR1                     RETURN                 @XA08072 54050009
SETALL   OI    CTRL,ALLQUES        SET ALL                              54400020
         LA    RWRK1,THREE(,RWRK1)      INCREMENT PAST ALL     @OY12272 54420091
         CLI   ZERO(RWRK1),COMMA        IS THERE A COMMA?      @OY12272 54440091
         LA    RWRK1,ONEE(,RWRK1)       INCREMENT PAST COMMA   @OY12272 54460091
         BE    CHKSERV                  YES                    @OY12272 54480091
         BR    RIR1                                                     54500020
SETDMP   OI    CTRL,DUMP           SET DUMP REQ                         54600020
         BR    RIR1                                                     54700020
SETPART  EQU   *                                                 S21903 54720022
         OI    SCANBYTE,ON              SET PARTIAL DUMP REQ     S21903 54740022
         BR    RIR1                     RETURN                   S21903 54760022
         SPACE 2                                                        54761091
CHKSERV  EQU   *                                               @OY12272 54762091
         L     R13,SAVE13               RESTORE REG 13         @OY12272 54763091
         CLC   ZERO(TWOO,RWRK1),DS      IS THIS DUMP SERV?     @OY12272 54764091
         BNE   CHKUNSRV                 NO, CHK DUMP UNSERV    @OY12272 54765091
         OI    CTRL2,DSSW               SET DUMP SERV SWITCH   @OY12272 54766091
         LA    RWRK1,TWOO(RWRK1)        INCREMENT TO NEXT CHAR @OY12272 54767091
         CLI   ZERO(RWRK1),COMMA        IS THERE A COMMA?      @OY12272 54768091
         BE    CHKFMTC                  YES                    @OY12272 54769091
         CLI   ZERO(RWRK1),ZERO         BLANK?                 @OY12272 54770091
         BNE   PARMERR                  NO                     @OY12272 54771091
         BR    RIR1                     RETURN                 @OY12272 54772091
         SPACE 2                                                        54773091
CHKUNSRV EQU   *                                               @OY12272 54774091
         CLC   ZERO(TWOO,RWRK1),DU      IS THIS DUMP UNSERV?   @OY12272 54775091
         BNE   CHKFMT                   NO                     @OY12272 54776091
         OI    CTRL2,DUSW               SET DUMP UNSERV SW     @OY12272 54777091
         LA    RWRK1,TWOO(,RWRK1)       INCREMENT TO NEXT CHAR @OY12272 54778091
         CLI   ZERO(RWRK1),COMMA        IS THERE A COMMA?      @OY12272 54779091
         BE    CHKFMTC                  YES                    @OY12272 54780091
         CLI   ZERO(RWRK1),ZERO         BLANK?                 @OY12272 54781091
         BNE   PARMERR                  NO                     @OY12272 54782091
         BR    RIR1                     RETURN                 @OY12272 54783091
         SPACE 2                                                        54784091
CHKFMTC  EQU   *                                               @OY12272 54785091
         LA    RWRK1,ONEE(,RWRK1)       INCREMENT TO NEXT CHAR @OY12272 54786091
         SPACE 1                                                        54787091
CHKFMT   EQU   *                                               @OY12272 54788091
         CLC   ZERO(THREE,RWRK1),FMT    FORMAT DATFLAGS FIELD? @OY12272 54789091
         BNE   PARMERR                  NO                     @OY12272 54790091
         OI    CTRL2,FMTSW              SET FORMAT SWITCH      @OY12272 54791091
         LA    RWRK1,THREE(,RWRK1)      INCREMENT TO NEXT CHAR @OY12272 54792091
         CLI   ZERO(RWRK1),ZERO         BLANK?                 @OY12272 54793091
         BNE   PARMERR                  NO                     @OY12272 54794091
         BR    RIR1                     RETURN                 @OY12272 54795091
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - SYSPRINT OUTPUT ROUTINE   ' 54800020
*********************************************************************** 54900020
*                                                                     * 55000020
*                       PUT TO SYSPRINT ROUTINE                       * 55100020
*                                                                     * 55200020
*        THIS ROUTINE OUTPUTS TO THE 'SYSPRINT' DATA SET.  THE BUFFER * 55300020
*        AREA 'OUTAREA' IS CLEARED TO BLANKS AND THE LINE COUNTER IS  * 55400020
*        DECREMENTED AFTER PRINTING.  WHEN THE LINE COUNTER REACHES   * 55500020
*        ZERO, THE COUNTER WILL BE RE-INITIALIZED.  THE NEXT PASS     * 55600020
*        THROUGH THE ROUTINE WILL CAUSE A PAGE SKIP.  IF THE USER     * 55700020
*        PLACES A X'F1' AT 'OUTAREA', THE LINE COUNTER WILL BE RE-    * 55800020
*        INITIALIZED AND A PAGE SKIP WILL OCCUR.  WHEN THE PRINT      * 55900020
*        ROUTINE SENSES THAT A PAGE SKIP WILL OCCUR ON THE NEXT       * 56000020
*        PRINT OPERATION, REG 15 WILL BE SET TO 4, OTHERWISE IT WILL  * 56100020
*        BE SET TO ZERO...INDICATING NO AUTOMATIC PAGE SKIPPING.      * 56200020
*        RETURN TO THE USER IS DONE VIA R14.  THE AREA 'OUTBUF'       * 56300020
*        MUST ALREADY CONTAIN THE DATA TO BE PRINTED, PRIOR TO THE    * 56400020
*        INVOCATION OF THIS ROUTINE.                                  * 56500020
*                                                                     * 56600020
*        ALL REGISTERS ARE TRANSPARENT, EXCEPT REGS 0, 1, AND 15.     * 56700020
*                                                                     * 56800020
*********************************************************************** 56900020
*                                                                       57000020
PUT      ST    R14,PUTSAVE              SAVE USERS RETURN REG           57100020
         LH    R14,LINECTR              LOAD CURRENT COUNT     @OZ27790 57200000
         CLC   LINECTR,LINECNT          SKIP TO NEW PAGE       @OZ27790 57209000
         BE    EJECT                    BRANCH YES             @OZ27790 57218000
         CLI   OUTAREA,C'-'             TRIPLE SPACE SPECIFIED @OZ27790 57227000
         BNE   DOUB                     BRANCH NO              @OZ27790 57236000
         BCT   R14,TRIP                 REDUCE AND BRANCH      @OZ27790 57245000
         B     EJECT                    CONTINUE               @OZ27790 57254000
DOUB     EQU   *                                               @OZ27790 57263000
         CLI   OUTAREA,C'0'             DOUBLE SPACE SPECIFIED @OZ27790 57272000
         BNE   CEJECT                   BRANCH NO              @OZ27790 57281000
TRIP     EQU   *                                                        57300000
         BCT   R14,SING                 REDUCE AND BRANCH      @OZ27790 57320000
EJECT    EQU   *                                               @OZ27790 57340000
         MVI   OUTAREA,X'F1'            ELSE, SET CARRIAGE CTL TO SKIP  57400020
CEJECT   EQU   *                                               @OZ27790 57450000
         CLI   OUTAREA,X'F1'            DID USER SPECIFY A SKIP         57500020
         BNE   NEJECT                   BRANCH NO EJECT        @OZ27790 57600000
         MVC   LINECTR,LINECNT          SET COUNTER TO MAX LINES        57700020
         B     NEJECT                                          @OZ27790 57720000
SING     EQU   *                                               @OZ27790 57740000
         STH   R14,LINECTR              STORE CURRENT COUNT    @OZ27790 57760000
NEJECT   EQU   *                                               @OZ27790 57780000
         TR    OUTAREA+1(120),PRINTABL  INSURE NO UNPRINTABLES          57800020
         PUT   PUTDCB,OUTAREA           PRINT THE LINE                  57900020
         SR    R15,R15                  SET RETURN CODE EQ ZERO         58000020
         LH    R14,LINECTR              GET LINE COUNTER                58100020
         BCT   R14,PUTEXIT              DECREMENT COUNTER      @OZ27790 58200000
         LH    R14,LINECNT              RE-INITIALIZE LINE COUNTER      58400020
PUTEXIT  STH   R14,LINECTR              UPDATE COUNTER FIELD            58500020
         MVI   OUTAREA,X'40'            CLEAR OUTPUT BUFFER             58600020
         MVC   OUTAREA+1(120),OUTAREA        TO BLANKS                  58700020
         MVI   OUTBUF,X'EF'        CLEAR                                58800020
         MVC   OUTBUF+1(119),OUTBUF BUFFER                              58900020
         L     R14,PUTSAVE              GET USERS RETURN ADDRESS        59000020
         BR    R14                      RETURN TO USER                  59100020
LINECNT  DC    H'60'                    MAX LINES PER PAGE              60200020
LINECTR  DC    H'60'                    ACTIVE LINE COUNTER             60300020
         EJECT                                                          60350021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  S21101 60360021
*                                                             *  S21101 60370021
*        THIS SUBROUTINE INCREMENTS THE ABSOLUTE              *  S21101 60380021
*        RECORD COUNT AND CHECKS TO SEE IF THE                *  S21101 60390021
*        TOTAL RECORD COUNT HAS BEEN EXCEEDED                 *  S21101 60392021
*                                                             *  S21101 60394021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  S21101 60396021
INCRECNT EQU   *                                                 S21101 60398021
         L     RREC,RR1RECD             GET THE LATEST ABSOLUTE  S21101 60398421
*                                         RECORD NUMBER          S21101 60398821
         LA    RREC,1(,RREC)            INCREMENT IT             S21101 60399221
         ST    RREC,RR1RECD             STORE IT BACK            S21101 60399621
         CLC   RR1RECD(4),TOTNO         IS THIS THE END OF THE   S21101 60399721
*                                         DATA SET               S21101 60399821
         BCR   13,RIR1                  BRANCH IF NO             S21903 60399922
         TM    SCANBYTE,ON              HAS SCAN BEEN DONE       S21903 60402922
         BZ    ENDED                    YES,BRANCH              SA59967 60405922
         L     RREC,RECORD              PICK UP RECORD PROCESSEDSA66943 60408905
         LA    RIR1,TWOO                SET INCREMENT OF TWO       @21C 60409027
         TM    CTRL,REUS                IS IT REUSABLE QUEUE       @21C 60409127
         BO    ADDTWO3                  YES, ADD 2 FOR REUS        @21C 60409227
         LA    RIR1,FOURR               NONREUS QUEUE, ADD 4       @21C 60409327
ADDTWO3  EQU   *                                                   @21C 60409427
         AR    RREC,RIR1                BUMP TO NEXT UNIT ADDR     @21C 60409527
         ST    RREC,WORKDBL             SAVE RECORD NUMBER      SA66943 60409905
         CLC   WORKDBL+1(3),PACKFLD2    HAVE WE PASSED RANGE    SA66943 60410405
         BH    WTORTNE2                 YES GO PRINT MESSAGE    SA66943 60410905
         B     DUMPLOOP                 NO DUMP NEXT RECORD     SA66943 60411405
SETCNT   EQU   *                                                SA51078 60411922
         L     RWRK1,UNIT               GET UNIT SIZE           SA51078 60414922
         SH    RWRK1,DATSIZE            DECR FOR DATA FIELD     SA51078 60417922
         LH    R15,PRFSIZE              GET DATA SIZE           SA51078 60420922
         SR    R14,R14                  CLEAR FOR DIVIDE        SA51078 60423922
         DR    R14,RWRK1                GET UNITS PER BUF       SA51078 60426922
         LTR   R14,R14                  ANY REMAINDER           SA51078 60429922
         BZ    HAVECNT                  BRANCH IF NO            SA51078 60432922
         LA    R15,1(R15)               INCR UNIT CNT           SA51078 60435922
HAVECNT  EQU   *                                                SA51078 60438922
         STC   R15,PRFNBUNT             SET UNIT COUNT          SA51078 60441922
         BR    RIR1                     RETURN                  SA51078 60444922
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - WTO ERROR MESSAGES        ' 60453321
CHAINER1 OI    CTRL,NXTQUE              INDICATES NEXT QUEUE    SA59967 60453422
         B     FINISH                   PRINT OUT INVALID MSG   SA59967 60453522
CHAINER2 OI    CTRL,NXTHDR              INDICATE NEXT HEADER    SA59967 60453622
         B     FINISH                   PRINT OUT INVALID MSG   SA59967 60453722
CHAINERR WTO   'IED122I INVALID MESSAGE CHAIN.',                       C60480020
               ROUTCDE=11,DESC=7                                        60560020
         B     ENDED                    GO TERMINATE JOB        SA59967 60640022
PARMERR  WTO   'IED123I INVALID PARAMETERS.',                          C60720020
               ROUTCDE=11,DESC=7                                        60800020
         B     ENDED                    GO TERMINATE JOB        SA59967 60880022
WRAPERR  WTO   'IED124I QUEUE HAS BEEN WRAPPED.',                      C60960020
               ROUTCDE=11,DESC=7                                        61040020
         B     ENDED                    GO TERMINATE JOB        SA59967 61120022
OPENERR  WTO   'IED119I UNABLE TO OPEN ''SYSPRINT''.',                 C61200020
               ROUTCDE=11,DESC=7                                        61280020
         B     ENDED                    GO TERMINATE JOB        SA59967 61360022
OPERR1   WTO   'IED119I UNABLE TO OPEN ''DISKQ01''.',                  C61440020
               ROUTCDE=11,DESC=7                                        61520020
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - RETURN TO SUPERVISOR      ' 61600020
*********************************************************************** 61700020
*                                                                     * 61800020
*              ENTIRE QUEUE DUMPED.    EXIT                           * 61900020
*                                                                     * 62000020
*********************************************************************** 62100020
FINISH   EQU   *                                                SA59967 62200022
         MVC   OUTBUF+3(6),HEXRCD       INSERT RECORD NUMBER    SA59967 62200122
         MVC   OUTBUF+11(39),INVALRCD   INSERT ERROR MESSAGE    SA59967 62200222
         $PRNT OUTBUF                   PRINT FILLED BUFFER     SA59967 62200322
         TM    CTRL,NXTHDR              GO TO NEXT HEADER?      SA59967 62200422
         BO    MSGCHAIN                 READ NEXT HEADER        SA59967 62200522
         TM    CTRL,NXTQUE              GO TO NEXT QUEUE?       SA59967 62200622
         BZ    ENDED                                            SA59967 62200722
         TM    CTRL,ALLQUES             ALL SPECIFIED?          SA59967 62200822
         BO    GETNEXT                  YES                     SA59967 62200922
         L     RWRK1,NEXTQUE            GET NEXT QUEUE          SA59967 62201022
         LA    RWRK1,4(RWRK1)           BUMP TO NEXT REQ        SA59967 62201122
         ST    RWRK1,NEXTQUE            SAVE REQ                SA59967 62201222
         B     GETNEXT                  GO GET ANOTHER QUEUE    SA59967 62201322
ENDED    EQU   *                                                SA59967 62201422
         L     13,SAVE+4                LOAD SAVE AREA BASE    @OX21557 62201586
         CLOSE MF=(E,DCBLIST)           CLOSE QUEUE DATASETS   @OX21557 62221586
         CLOSE (PUTDCB)                 CLOSE OUTPUT DATASET   @OX21557 62241586
         LM    14,12,12(13)                                             62300020
         LA    15,0                                                     62400020
         BR    14                                                       62500020
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - CONSTANTS AND WORK AREAS  ' 62600020
*******                                            ************  S21903 62601022
*                                                             *  S21903 62602022
*        THIS ROUTINE WILL ENABLE A USER TO SPECIFY A         *  S21903 62603022
*        RANGE OF RECORD NUMBERS TO BE PRINTED, THUS          *  S21903 62604022
*        ELIMINATING THE NEED TO DUMP THE ENTIRE              *  S21903 62605022
*        MESSAGE QUEUE IN ORDER TO LOOK AT A FEW              *  S21903 62606022
*        CHOSEN RECORDS                                       *  S21903 62607022
*                                                             *  S21903 62608022
***************************************************************  S21903 62609022
WTORTNE  EQU   *                                                 S21903 62610022
         XC    WTORECB,WTORECB          CLEAR THE WTOR ECB       S21903 62611022
         XC    ANSWER(13),ANSWER        CLEAR WORK AREA          S21903 62612022
         WTOR  'IED426D SPECIFY TCAM RECORDS TO BE DUMPED,ALL,OR END', X62613022
               ANSWER,13,WTORECB                                 S21903 62614022
         WAIT  ECB=WTORECB              WAIT FOR REPLY           S21903 62615022
         OI    CTRL,DUMP                ASSUME SEQ DUMP          S21903 62616022
         NI    SCANBYTE,255-ON          RESET PART DUMP          S21903 62617022
         OC    ANSWER(3),UPCSE          SET LC TO UC             S21903 62618022
         CLC   ANSWER(3),END            IS JOB TO BE TERMINATED  S21903 62619022
         BE    ENDED                    BRANCH IF YES           SA59967 62620022
         CLC   ANSWER(3),ALL            IS SEQ DUMP REQ          S21903 62621022
         BE    PRINT                    BRANCH IF YES            S21903 62622022
         OI    SCANBYTE,ON              INDICATE PART DUMP       S21903 62623022
         SPACE 1                                                 S21903 62624022
TRANSLAT EQU   *                                                 S21903 62625022
         TR    ANSWER(6),TTABLE         TRANSLATE REG RCD NO     S21903 62626022
         TR    ANSWER+7(6),TTABLE       TRANSLATE END RCD NO     S21903 62627022
         PACK  PACKFLD1(4),ANSWER(7)    PACK THE FIRST NO        S21903 62628022
         PACK  PACKFLD2(4),ANSWER+7(7)  PACK THE ENDING NO       S21903 62629022
         L     RREC,PACKFLD1            GET START RRN            S21903 62630022
         SRL   RREC,8                   SHIFT TO LOW ORDER BYTE  S21903 62631022
         ST    RREC,RECORD              SET FIRST RCD TO READ    S21903 62632022
         LA    RREC,0(RREC)             CLEAR HI BYTE            S21903 62633022
         LA    R1,TWOO                  SET TO DIVIDE BY TWO       @21C 62633327
         LA    RREC,ONEE(,RREC)         INCREMENT NUMBER BY 1      @21C 62633627
         TM    CTRL,REUS                IS IT REUSABLE QUEUE       @21C 62633927
         BO    REUSQUE                  YES, DIVIDE BY TWO         @21C 62634227
         LA    R1,FOURR                 SET TO DIVIDE BY FOUR      @21C 62634527
         LA    RREC,TWOO(,RREC)         INCREMENT BY TWO MORE      @21C 62634827
REUSQUE  EQU   *                                                   @21C 62635127
         SR    RDTA,RDTA                CLEAR REG                S21903 62636022
         DR    RDTA,R1                  GET ABSOLUTE REC NO      S21903 62637022
         ST    RREC,RR1RECD             SET START RCD NO         S21903 62638022
         L     RREC,RECORD              GET RECORD NO            S21903 62639022
         OI    RR1BIT,ON                USE ABSOLUTE RRN         S21903 62640022
         B     DUMPLOOP                                          S21903 62641022
         SPACE 2                                                 S21903 62642022
WTORTNE2 EQU   *                                                 S21903 62643022
         SPACE 2                                                 S21903 62644022
         WTO   'IED427I TCAM RECORDS DUMPED'                     S21903 62645022
         OI    SCANBYTE,ON              INDICATE PART DUMP       S21903 62646022
         B     PRINT                    GO FORMAT OUTPUT AREA    S21903 62647022
END      DC    CL3'END'                 END                      S21903 62648022
UPCSE    DC    3CL1' '                  BLANKS                   S21903 62649022
TTABLE DS      0X                       TRANSLATE TABLE          S21903 62650022
         DC    XL129'00'                NULL VALUES              S21903 62651022
         DC    X'FAFBFCFDFEFF'          LOWER CASE A-F           S21903 62652022
         DC    XL58'00'                 NULL                     S21903 62653022
         DC    X'FAFBFCFDFEFF'          A-F                      S21903 62654022
         DC    XL41'00'                 C7-EF                    S21903 62655022
         DC    X'F0F1F2F3F4F5F6F7F8F9'  0-9                      S21903 62656022
         SPACE 2                                                 S21903 62657022
PACKFLD1 DC    F'00'                    FIRST RRN                S21903 62658022
PACKFLD2 DC    F'00'                    SECOND RRN               S21903 62659022
WTORECB  DC    F'00'                    ECB FOR WTOR             S21903 62660022
ANSWER   DC    XL13'00'                 REPLY                    S21903 62661022
         DC    XL1'00'                  RESERCED                 S21903 62662022
SCANBYTE DC    XL1'00'                  FLAG BYTE                S21903 62663022
FIRSTREC EQU   1                        FIRST RRN                S21903 62664022
SAVE13   DS    F                        REG 13 SAVE AREA       @XA08072 62668009
POINTARG DS    0F                                                  @02A 62669012
TTR      DS    XL3                      SAVE AREA FOR TTR          @02A 62670012
Z        DS    XL1                      Z PARAMETER FOR POINT      @02A 62671012
COMMA    EQU   C','                                            @XA08072 62672009
ONEE     EQU   1                                               @XA08072 62676009
TWOO     EQU   2                                               @XA08072 62680009
FOURR    EQU   4                                               @XA08072 62684009
SIXX     EQU   6                        CONSTANT               @OY12272 62684591
NINE     EQU   9                        CONSTANT               @OY12272 62685091
TEN      EQU   10                       CONSTANT               @OY12272 62685591
ELEVEN   EQU   11                       CONSTANT               @OY12272 62686091
TWELVE   EQU   12                       CONSTANT               @OY12272 62686591
FORTYONE EQU   41                       CONSTANT               @OY12272 62687091
FORTYSIX EQU   46                       CONSTANT               @OY12272 62687591
DIGIT    EQU   X'F0'                                           @XA08072 62688009
FIVE     EQU   5                                               @XA08072 62692009
**********************   CONSTANT AREA  ************************        62700020
LASTDATA MVC   OUTBUF+87(0),0(RDTA)                                     62800020
GETPARM  MVC   PARMWORK(0),2(RWRK1) MOVE PARMLIST TO WORK               62900020
MOVEZON  MVZ   XWK+1(0),XWK        MOVE IN ZONES                        63000020
PACKNUM  PACK  WORKDBL(8),0(0,RWRK1)     PACK THE DIGITS AFTER @XA08072 63030009
*                                        LAST COMMA            @XA08072 63060009
BLNKMSG  DC    C'HEADER IS ALL ZEROES'                                  63100020
FRSTMSG  DC    CL50'********** FIRST MESSAGE FOR QUEUE XXXXXX *******'  63200020
SPECIAL  DC    CL50'*** SPECIAL CHARACTERS- EOT= *, EOB= %, EOA= # **'  63300020
INVALRCD DC    C'*****RECORD READ IS INCORRECT TYPE*****'       SA59967 63300122
DSDUMSG  DC    CL58'********** XXSERVICED MESSAGES FOR QUEUE XXXXXX ***C63310191
               *****'                                          @OY12272 63320191
DSMSG    DC    X'4040'                  TO MAKE MSG SAY SERV   @OY12272 63330191
DUMSG    DC    CL2'UN'                  TO MAKE MSG SAY UNSERV @OY12272 63340191
SERV     DC    CL9'SERVICED '           MSG SERVICED           @OY12272 63350191
CANCLD   DC    CL9'CANCELED '           MSG CANCELED           @OY12272 63360191
INITFEFO DC    CL9'INITFEFO '           INIT FEFO MSG          @OY12272 63370191
MSGLOST  DC    CL12'INITMSGLOST '       INITIATE MSG LOST      @OY12272 63380191
FORMATM  DC    11C' '                   FIELD DEFINITION FOR MESSAGES   63400020
         DC    CL8'NT LCB'                                              63500020
         DC    CL2' '                                                   63600020
         DC    CL4'SRCE'                                                63700020
         DC    CL2' '                                                   63800020
         DC    CL4'SIZE'                                                63900020
         DC    CL2' '                                                   64000020
         DC    CL2'ST'                                                  64100020
         DC    CL2' '                                                   64200020
         DC    CL6'NXTREC'                                              64300020
         DC    CL2' '                                                   64400020
         DC    CL4'SCAN'                                                64500020
         DC    CL2' '                                                   64600020
BFR      DC    CL6'NXTTXT'                                      PTR1898 64700020
         DC    CL2' '                                                   64800020
         DC    CL6'FSTREC'                                              64900020
         DC    CL2' '                                                   65000020
HDR      DC    CL6'NXTHDR'                                      PTR1898 65100020
         DC    CL2' '                                                   65200020
         DC    CL6' QBACK'                                              65300020
         DC    CL2' '                                                   65400020
         DC    CL4'SEQO'                                                65500020
         DC    CL2' '                                                   65600020
         DC    CL4'DEST'                                                65700020
PARMWORK DS    0X                                                       65800020
WKNUMQS  DS    0XL7                     TOTAL NO OF QUEUES      SA69651 65840005
WKNUMQE  DC    XL2'0'                   1ST 2 BYTES ARE Q=       A42375 65880020
WKNUMX   DC    XL4'0'                   DMP OR NO OF QUEUES     SA69651 65920005
WKNUMC   DC    XL1'0'                   DELIMETER(COMMA)         A42375 65960020
WKREQ1   DC    5X'00'        1111,      FIRST QUEUE REQUEST/ALL SA69651 66000005
WKREQ2   DC    5X'00'        2222,      SECOND QUEUE REQUEST    SA69651 66100005
WKREQ3   DC    5X'00'        3333,      THIRD QUEUE REQUEST     SA69651 66200005
WKREQ4   DC    5X'00'        4444,      FOURTH QUEUE REQUEST    SA69651 66300005
WKREQ5   DC    4X'00'        5555,      FIFTH QUEUE REQUEST     SA69651 66400005
WKDFMT   DC    7X'00'                   DU,DS,FMT              @OY12272 66450091
ENDPRMWK DC    C','                END OF PARM WORK AREA                66500020
PARMLNG  EQU   (ENDPRMWK-PARMWORK) MAX LNGTH PARM FIELD (52)            66600020
CYLVOL   DC    F'0'                                                     66700020
NOVOL    DC    F'0'                                                     66800020
UNIT     DC    F'0'                                                     66900020
TOTNO    DC    F'0'                                                     67000020
QREQ1    DC    F'1'                SET TO ONE FOR 'ALL' OR 'DMP'        67100020
QREQ2    DC    F'0'                                                     67200020
QREQ3    DC    F'0'                                                     67300020
QREQ4    DC    F'0'                                                     67400020
QREQ5    DC    F'0'                                                     67500020
ENDREQ   DC    F'0'                MARKS END OF REQ                     67600020
TRCYL    DC    F'0'                TRKS PER CYL                         67700020
VOLRT    DC    F'0'                # VOLS * REC/TRK                     67800020
RCTRK    DC    F'0'                # REC/TRK                            67900020
XTRA     DC    F'0'                BUFR PREFIX                          68000020
NTXT     DC    F'0'                LINKAGE                              68100020
NHDR     DC    F'0'                SAVE AREA                            68200020
RECORD   DC    F'0'                ADDR REC BEING PROCESSED             68300020
NUMQUES  DC    F'0'                NUMBER OF QUEUES ON DATASET          68400020
QUESTART DC    F'0'                BEGIN ADDR THIS QUEUE                68500020
NEXTQUE  DC    A(QREQ1)            ADDR OF NEXT QUE REQUEST             68600020
BLOCK    DC    F'32'                                                    68700020
ONE      DC    F'1'                                                     68800020
TWO      DC    F'2'                                                     68900020
SIX      DC    F'6'                                             SA59967 68900122
XWK      DC    64X'EF'             UNPK WORK AREA                       69000020
HEXRCD   DC    CL8' '                                           PTR1898 69100020
OUTBUF   DC    120C' '             OUTPUT BUFFER AREA                   69200020
INFO     DC    5F'0'               WORK AREA FOR DEVTYPE MACRO          69300020
WORKDBL  DC    D'0'                                                     69400020
RDSAVE   DC    14F'0'                   SAVE AREA FOR IEDQFP    SA59967 69500022
SAVE     DC    18F'0'                                                   69600020
PUTSAVE  DS    F                        REG 14 SAVE AREA FOR PRINT RTNE 69700020
EXTLST   DS    0F                       DCB EXIT LST             S21903 69720022
         DC    X'85'                    END OF LIST,DCBEXIT      S21903 69740022
         DC    AL3(IEDQXC01)            ADDR OF EXIT RTN         S21903 69760022
DATSIZE  DC    H'6'                     SIZE OF DATA FIELD       S21903 69780022
QDDNAME  DC    CL8'DISKQ01'             MESSAGE Q DDNAME FOR DEVTYPE    69800020
DCB      DS    0F                                                       69900020
DCBLIST  OPEN  (RDDCB1,,RDDCB2,,RDDCB3,,RDDCB4,,RDDCB5,,RDDCB6,,RDDCB7,C70000020
               ,RDDCB8,,RDDCB9,,RDDCB10,,RDDCB11,,RDDCB12,,RDDCB13,,   C70100020
               RDDCB14,,RDDCB15,,RDDCB16),MF=L                          70200020
OUTAREA  DC    C'1',CL120' '            OUTPUT PRINT BUFFER             70300020
PRINTABL DC    CL16'                '   X 00 - 0F                       70400020
         DC    CL16'                '   X 10 - 1F                       70500020
         DC    CL16'                '   X 20 - 2F                       70600020
         DC    CL16'                '   X 30 - 3F                       70700020
         DC    CL16'           .    '   X 40 - 4F                       70800020
         DC    CL16'           $*   '   X 50 - 5F                       70900020
         DC    CL16'-/         ,%   '   X 60 - 6F                       71000020
         DC    CL16'           #@''= '  X 70 - 7F                       71100020
         DC    CL16'                '   X 80 - 8F                       71200020
         DC    CL16'                '   X 90 - 9F                       71300020
         DC    CL16'                '   X A0 - AF                       71400020
         DC    CL16'                '   X B0 - BF                       71500020
         DC    CL16' ABCDEFGHI      '   X C0 - CF                       71600020
         DC    CL16' JKLMNOPQR      '   X D0 - DF                       71700020
         DC    CL16'  STUVWXYZ      '   X E0 - EF                       71800020
         DC    CL16'0123456789      '   X F0 - FF                       71900020
RR1BIT   DC    X'00'                    FIRST TIME SWITCH        S21101 71900221
ON       EQU   X'01'                    SWITCH ON                S21101 71900421
OFF      EQU   X'FE'                    SWITCH OFF               S21101 71900621
FOUR     EQU   2                                                 S21101 71900821
THREE    EQU   3                                                 S21101 71901021
NOTUSED  EQU   X'03'                                             S21101 71901221
ECBAD    DC    F'0'                     ECB FOR WTOR            SA50211 71910222
X0FFF    DC    X'00FFFFFF'                                      SA50211 71919222
FRSTRCD  DC    X'00'                    FIRST RCD FOR INDIVDUAL SA50211 71928222
*                                       QUEUE DUMP SWITCH       SA50211 71937222
RPLY     DC    X'00'                    REPLY AREA FOR WTOR     SA50211 71946222
ZERO     EQU   X'00'                                            SA50211 71955222
PHOUR    EQU   4                        EQUATE FOR 4            SA50211 71964222
C        EQU   X'C3'                                            SA50211 71973222
D        EQU   X'C4'                                            SA50211 71982222
BLNK     EQU   X'40'                    BLANK                  @OY12272 71984291
CTRL2    DC    X'00'                    CONTROL BYTE           @OY12272 71986291
FMTSW    EQU   X'01'                    SW FOR FORMAT DATFLAGS @OY12272 71988291
DUSW     EQU   X'02'                    DUMP UNSERV MSGS ONLY  @OY12272 71990291
DSSW     EQU   X'04'                    DUMP SERV MSGS ONLY    @OY12272 71992291
CTRL     DC    X'00'               INTERNAL CONTROL BYTE                72000020
         DS    0F                                                S21101 72050021
RR1RECD  DC    F'0'                     ABSOLUTE RECORD NUMBER   S21101 72060021
REUS     EQU   X'02'                    REUSABLE QUEUEING SWITCH S21101 72070021
ALLQUES  EQU   X'80'               ALL QUEUES REQUESTED                 72100020
DUMP     EQU   X'40'               DUMP ALL RECORDS SEQUENTIALLY        72200020
SUBSTEXT EQU   X'01'                    SUBSEQUENT TEXT RECORD  SA59967 72200122
NXTQUE   EQU   X'10'                    NEXT QUEUE TO BE READ   SA59967 72200222
NXTHDR   EQU   X'08'                    NEXT HEADER TO BE READ  SA59967 72200322
DEFAULT  EQU   1331                     DEFAULT BLKSIZE          S21903 72250022
BLANK    DC    10X'EF'             BLANK CHARACTER                      72300020
QEQUAL   DC    CL2'Q='                  USED TO CHECK FORMAT            72350020
DMP      DC    CL3'DMP'                                                 72400020
ALL      DC    CL3'ALL'                                                 72500020
PART     DC    CL4'PART'                Q=PART                   S21903 72520022
FMT      DC    CL3'FMT'                 FORMAT                 @OY12272 72527091
DU       DC    CL2'DU'                  DUMP UNSERVICED        @OY12272 72534091
DS       DC    CL2'DS'                  DUMP SERVICED          @OY12272 72541091
         DS    0F                       BDY ALIGNMENT           SA50211 72550022
INBUF    DC    270X'00'            INPUT BUFFER                         72600020
         ORG   *-X'EF'                                                  72700020
HEXTABLE DS    0X                                                       72800020
         ORG   *+X'EF'                                                  72900020
         DC    X'40F0F1F2F3F4F5F6F7F8F9'                                73000020
         DC    X'C1C2C3C4C5C6'                                          73100020
EBCTABLE DS    0X                  HEX TO EBCDIC TABLE                  73200020
         DC    38C'.'                                                   73300020
         DC    CL1'%'              EOB CHAR                             73400020
         DC    16C'.'                                                   73500020
         DC    CL1'*'              EOT CHAR                             73600020
         DC    8C'.'                                                    73700020
         DC    C' '                                                     73800020
         DC    12C'.'                                                   73900020
         DC    CL4'(+|&&'                                               74000020
         DC    9C'.'                                                    74100020
         DC    CL8'!$*);^-/'                                            74200020
         DC    9C'.'                                                    74300020
         DC    CL1','                                                   74400020
         DC    3C'.'                                                    74500020
         DC    CL1'?'                                                   74600020
         DC    10C'.'                                                   74700020
         DC    CL2':#'             COLAN,POUND SIGN & EOA CHAR          74800020
         DC    CL1'.'                                                   74900020
         DC    CL2'''='                                                 75000020
         DC    2C'.'                                                    75100020
         DC    9C'$'                                                    75200020
         DC    7C'.'                                                    75300020
         DC    9C'$'                                                    75400020
         DC    8C'.'                                                    75500020
         DC    8C'$'                                                    75600020
         DC    23C'.'                                                   75700020
         DC    CL9'ABCDEFGHI'                                           75800020
         DC    7C'.'                                                    75900020
         DC    CL9'JKLMNOPQR'                                           76000020
         DC    8C'.'                                                    76100020
         DC    CL8'STUVWXYZ'                                            76200020
         DC    6C'.'                                                    76300020
         DC    CL10'0123456789'                                         76400020
         DC    6C'.'                                                    76500020
DATE     DC    C'1208'                 07/27/71                  S21101 76550021
         EJECT                                                          76560021
PUTDCB   DCB   DSORG=PS,MACRF=PM,RECFM=FBA,                            C76600020
               LRECL=121,EXLST=EXTLST,                                 X76700022
               DDNAME=SYSPRINT                                          76800020
JFCBADDR DS    0F                       ADDRESS OF JFCB FOR DISKQ01     76900020
         DC    X'87',AL3(JFCB)                                          77000020
QUEDSCB CAMLST SEARCH,JFCB,JFCB+118,FMT1DSCB                            77100020
JFCB     DC    XL176'00'                READ IN AREA FOR JFCB           77200020
FMT1DSCB DC    35XL10'00'               READ IN AREA FOR FMT1 DSCB      77300020
         TPRFD                                                          77400020
 TITLE 'IEDQXC - TCAM MESSAGE QUEUE PRINT - MESSAGE QUEUE DCBS        ' 77460020
IEDQXC   CSECT                                                          77520020
RDDCB1   DCB   BUFNO=1,DDNAME=DISKQ01,MACRF=RP,RECFM=F,            @01CC77522012
               DSORG=PS,EXLST=JFCBADDR                             @01C 77524012
RDDCB2   DCB   BUFNO=1,DDNAME=DISKQ02,MACRF=RP,RECFM=F,            @01CC77526012
               DSORG=PS                                            @01A 77528012
RDDCB3   DCB   BUFNO=1,DDNAME=DISKQ03,MACRF=RP,RECFM=F,            @01CC77530012
               DSORG=PS                                            @01A 77532012
RDDCB4   DCB   BUFNO=1,DDNAME=DISKQ04,MACRF=RP,RECFM=F,            @01CC77534012
               DSORG=PS                                            @01A 77536012
RDDCB5   DCB   BUFNO=1,DDNAME=DISKQ05,MACRF=RP,RECFM=F,            @01CC77538012
               DSORG=PS                                            @01C 77540012
RDDCB6   DCB   BUFNO=1,DDNAME=DISKQ06,MACRF=RP,RECFM=F,            @01CC77542012
               DSORG=PS                                            @01A 77544012
RDDCB7   DCB   BUFNO=1,DDNAME=DISKQ07,MACRF=RP,RECFM=F,            @01CC77546012
               DSORG=PS                                            @01A 77548012
RDDCB8   DCB   BUFNO=1,DDNAME=DISKQ08,MACRF=RP,RECFM=F,            @02CC77550012
               DSORG=PS                                            @02A 77552012
RDDCB9   DCB   BUFNO=1,DDNAME=DISKQ09,MACRF=RP,RECFM=F,            @02CC77554012
               DSORG=PS                                            @02A 77556012
RDDCB10  DCB   BUFNO=1,DDNAME=DISKQ10,MACRF=RP,RECFM=F,            @02CC77558012
               DSORG=PS                                            @02A 77560012
RDDCB11  DCB   BUFNO=1,DDNAME=DISKQ11,MACRF=RP,RECFM=F,            @02CC77562012
               DSORG=PS                                            @02A 77564012
RDDCB12  DCB   BUFNO=1,DDNAME=DISKQ12,MACRF=RP,RECFM=F,            @02CC77566012
               DSORG=PS                                            @02A 77568012
RDDCB13  DCB   BUFNO=1,DDNAME=DISKQ13,MACRF=RP,RECFM=F,            @02CC77570012
               DSORG=PS                                            @02A 77572012
RDDCB14  DCB   BUFNO=1,DDNAME=DISKQ14,MACRF=RP,RECFM=F,            @02CC77574012
               DSORG=PS                                            @02A 77576012
RDDCB15  DCB   BUFNO=1,DDNAME=DISKQ15,MACRF=RP,RECFM=F,            @02CC77578012
               DSORG=PS                                            @02A 77580012
RDDCB16  DCB   BUFNO=1,DDNAME=DISKQ16,MACRF=RP,RECFM=F,            @01CC77582012
               DSORG=PS                                            @01A 77584012
IEDQXC01 CSECT                                                          79205022
         USING IEDQXC01,R15             BASE                     S21903 79210022
         USING IHADCB,R1                DCB                      S21903 79215022
         LH    RREC,DCBBLKSI            GET BLKSIZE              S21903 79220022
         LTR   RREC,RREC                BLKSIZE SPEC             S21903 79225022
         BZ    STDEFALT                 BRANCH IF NO             S21903 79230022
         SR    RDTA,RDTA                CLEAR REG                S21903 79235022
         LH    R2,DCBLRECL              GET RECORD LENGTH        S21903 79240022
         DR    RDTA,R2                  IS BLKSI MULT OF LRECL   S21903 79245022
         LTR   RDTA,RDTA                ANY REMAINDER            S21903 79250022
         BZ    BLKSIOK                  BRANCH IF NO             S21903 79255022
STDEFALT EQU   *                                                 S21903 79260022
         LA    RREC,DEFAULT             GET DEFAULT VALUE        S21903 79265022
         STH   RREC,DCBBLKSI            SET DEFAULT VALUE        S21903 79270022
BLKSIOK  EQU   *                                                 S21903 79275022
         RETURN                                                         79280022
         EJECT ,                                                   @21A 79281227
         TCPBD ,                                                   @21A 79282427
         EJECT ,                                                   @21A 79283627
         DCBD  DSORG=PS                                                 79285022
         EJECT ,                                                   @21A 79287527
         TDATAD                                                         79290022
         END                                                            79300020
