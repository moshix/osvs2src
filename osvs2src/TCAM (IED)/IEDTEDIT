         TITLE 'LOGIC FOR IEDTPEDT MACRO'                               00050082
IEDTEDIT CSECT                                                          00100082
*                                                                       00150082
*        VS1 APAR = VS2 APAR                                            00200082
*         OX02569 = OY02458                                             00250082
*                                                                       00300082
*********************************************************************** 00350082
* FUNCTION     PROVIDES PROGRAM LOGIC FOR IEDTPEDT MACRO. EDITS DATA    00400082
*              FROM 50 MDI                                              00450082
*                                                                       00500082
* INPUT        REGISTER 1 CONTAINS A POINTER TO A PARAMETER LIST        00550082
*              PROVIDED BY THE USER                                     00600082
*                                                                       00650082
*              REGISTER 0 CONTAINS A POINTER TO THE EDIT OPTIONS        00700082
*              SPECIFIED IN THE IEDTPEDT MACRO                          00750082
*                                                                       00800082
*              REGISTER 13 CONTAINS A POINTER TO A 72 BYTE SAVE AREA    00850082
*                                                                       00900082
*              REGISTER 14 CONTAINS THE RETURN ADDRESS                  00950082
*                                                                       01000082
* OUTPUT       REGISTER 1 CONTAINS A POINTER TO A PARAMETER LIST WHICH  01050082
*              CONTAINS THE RECORD ADDRESS AND ADDRESS OF THE RECORD    01100082
*              LENGTH                                                   01150082
*                                                                       01200082
* ENTRY        THE FIRST EXECUTABLE INSTRUCTION                         01250082
*                                                                       01300082
* EXITS        USER ERROR EXIT ROUTINE IF ONE IS SPECIFIED              01350082
*                                                                       01400082
* ATTRIBUTES   REENTRANT                                                01450082
*                                                                       01500082
*********************************************************************** 01550082
         SR    RTCDRG,RTCDRG       ZERO REG 15                          01600082
         STM   RETRNRG,BASERG,12(SAVERG) SAVE USERS REGISTERS           01650082
         BALR  BASERG,0            LOAD BASE REGISTER                   01700082
         USING *,BASERG                                                 01750082
         USING PARMLIST,PRMLSTRG   SET UP AND LOAD                      01800082
         B     A                                                        01850082
         DC    CL8'IEDTEDIT'            MODULE IDENTIFIER               01900082
         DC    XL2'7354'                REVISION DATE                   01950082
         DS    CL48                     PATCH AREA                      02000082
A        DS    0F                                                       02050082
         LR    PRMLSTRG,PARMRG1    DSECT REG FOR USER PARM LIST         02100082
         USING EDITPARM,EDTPRMRG   SET UP AND LOAD                      02150082
         LR    EDTPRMRG,PARMRG0    DSECT REG FOR MACRO PARMS            02200082
         USING WORKSTOR,WRKSTRG    SET UP AND LOAD                      02250082
         SR    WRKRG2,WRKRG2       ZERO REG FOR COMPARE                 02300082
         CL    WRKRG2,PRMWRKAD     IS PTR TO WORK AREA ZERO             02350082
         BNE   LOADRG              BR IF NO TO LOAD REG FOR DSECT BASE  02400082
         L     WRKRG2,PRMMXRCL     GET MAX RCD LNG                      02450082
         LA    WRKRG2,96(WRKRG2)   ADD FIXED NO BYTES RQD               02500082
         TM    EDTTYPSW,HEX08      IS USER EXIT SPECIFIED               02550082
         BO    NOEXIT              BR IF NO                             02600082
         LA    WRKRG2,76(WRKRG2)                                        02650082
NOEXIT   TM    EDTTYPSW,HEX40      DOES RECFM = V                       02700082
         BZ    RECFMNTU            BR IF NO                             02750082
         LA    WRKRG2,4(WRKRG2)                                         02800082
RECFMNTU SRL   WRKRG2,3            DIVIDE BY 8                          02850082
         SLL   WRKRG2,3            MULTIPLY BY 8                        02900082
         LR    PARMRG0,WRKRG2      PUT CORE RQMT IN REG 0 FOR GETMAIN   02950082
         GETMAIN R,LV=(0)                                               03000082
         ST    PARMRG1,PRMWRKAD    SAVE PTR TO CORE OBTAINED            03050082
         OI    PRMMXRCL,HEX40      INDICATE GETMAIN ISSUED              03100082
LOADRG   L     WRKSTRG,PRMWRKAD    LOAD DSECT REG FOR WORK STORAGE      03150082
         TM    PRMMXRCL,HEX80      IS THIS THE BEGINING OF CARTRIDGE    03200082
         BO    NOFORMAT            BR IF NO                             03250082
*                                                                       03300082
* * *  FORMAT WORKING STORAGE  * * *                                    03350082
*                                                                       03400082
FORMAT   XC    WRKADRRC(84),WRKADRRC ZERO OUT CONSTANT AREA             03450082
         OI    PRMMXRCL,HEX80      IND NOT BEG OF CARTRIDGE             03500082
         ST    WRKRG2,WRKLNGSV     SAVE LENGTH OF CORE OBTAINED         03550082
         MVI   WRKLEVST,CHAR0      RESET LEVEL STATUS                   03600082
         LA    PARMRG1,WRKSVLZJ+8  GET ADDR OF RCD LNG                  03650082
         ST    PARMRG1,WRKSVLZJ+4  SAVE ADDR OF RCD LNGTH               03700082
         LA    PARMRG1,WRKMACSV    POINT TO END OF RCD LENGTH           03750082
         TM    EDTTYPSW,HEX08      IS USER EXIT SPECIFIED               03800082
         BO    HUITCLOS            BR IF NO                             03850082
         LA    PARMRG1,76(PARMRG1)                                      03900082
HUITCLOS TM    EDTTYPSW,HEX40      DOES RECFM = V                       03950082
         BZ    RECFMU              BR IF NO                             04000082
         LA    PARMRG1,4(PARMRG1)                                       04050082
RECFMU   ST    PARMRG1,WRKNXAVW    SAVE PTR TO NEXT AVAIL WORK          04100082
         AH    PARMRG1,PRMMXRCL+2  POINT TO END OF WORK + 1             04150082
         ST    PARMRG1,WRKENWRK    SAVE PTR TO END OF WORK              04200082
         SH    PARMRG1,PRMMXRCL+2  RESTORE PTR TO BEG OF WORK           04250082
         ST    PARMRG1,WRKADRRC    SAVE PTR TO RCD                      04300082
         OI    WRKEDSW1,HEX0A      EXPECT SOR AND DO NOT ALLOW DUP      04350082
         L     PARMRG1,PRMINPUT    GET PTR TO INPUT                     04400082
         ST    PARMRG1,WRKADNXB    SAVE PTR TO INPUT                    04450082
NOFORMAT TM    WRKEDSW2,HEX08      WAS INPUT EMPTY AFTER LAST REC       04500082
         BO    CKPARRCD            BR IF NO                             04550082
         L     PARMRG1,WRKADNXB    GET PTR TO NEXT BUFFER               04600082
         LTR   PARMRG1,PARMRG1     ANY BUFFERS LEFT                     04650082
         BNZ   GETBUF              BR IF YES                            04700082
         L     PARMRG1,PRMINPUT    GET POINTER TO INPUT                 04750082
         ST    PARMRG1,WRKADNXB    SAVE PTR TO NEXT BUFFER              04800082
GETBUF   OI    WRKEDSW2,HEX08      INDICATE INPUT NOT EMPTY             04850082
         AH    PARMRG1,PRMIPTLN+2  POINT TO INPUT END + 1               04900082
         ST    PARMRG1,WRKENIPT    AND SAVE                             04950082
         SH    PARMRG1,PRMIPTLN+2  RESTORE PTR TO INPUT                 05000082
         TM    EDTTYPSW,HEX10      ARE USING BTAM BUFFERS               05050082
         BZ    NOBUF1              BR IF NO                             05100082
         L     WRKRG2,0(PARMRG1)   PICK UP PTR TO NEXT BUFFER           05150082
         LA    WRKRG2,0(WRKRG2)    ZERO HIGH ORDER BYTE                 05200082
         ST    WRKRG2,WRKADNXB     SAVE PTR TO NEXT AVAIL BUFFER        05250082
         LA    PARMRG1,4(PARMRG1)  INCR PAST CHAIN FIELD                05300082
NOBUF1   BCTR  PARMRG1,0           DECRE INPUT POINTER                  05350082
         ST    PARMRG1,WRKNXAVI    AND SAVE                             05400082
CKPARRCD TM    WRKEDSW2,HEX01      WAS LAST RCD A PARTIAL RCD           05450082
         BO    PTAGN               BR IF YES                            05500082
ZROTYPST MVI   WRKTYPST,HEX00      ZERO TYPE STATUS                     05550082
         SR    WRKRG2,WRKRG2                                            05600082
         STH   WRKRG2,WRKLZFCT     ZERO PREVIOUS COUNT OF LZF           05650082
PTAGN    BAL   LNKRG8,PTINPUT      GO POINT TO NEXT AVAIL IN INPUT      05700082
         NI    WRKEDSW2,HEXFE      RESET POSSIBLE PARTIAL RCD INDICATOR 05750082
         CLI   0(PARMRG1),HEX19    END OF DATA CODE                     05800082
         BE    ENDDATA             BR IF YES                            05850082
         CLI   0(PARMRG1),DLE      IS FIRST CHAR A DLE                  05900082
         BE    PTAGN               BR IF YES TO POINT TO NEXT BYTE      05950082
         CLI   0(PARMRG1),STX      IS FIRST CHAR A STX                  06000082
         BE    PTAGN               BR IF YES                            06050082
         CLI   0(PARMRG1),ETB      IS THIS BSC END CHAR                 06100082
         BE    BSCCHARS            BR IF YES                            06150082
         CLI   0(PARMRG1),HEX03    IS THIS BSC END CHAR                 06200082
         BE    BSCCHARS            BR IF YES                            06250082
         TM    WRKEDSW2,HEX10      IN LEFT ZERO MODE?          @XA02569 06300082
         BO    CMPRLZF             BR IF YES                   @XA02569 06350082
         TM    WRKEDSW1,HEX08 *    IS SOR EXPECTED                      06400082
         BZ    CONTSCAN            BR IF NO TO CONTINUE SCAN            06450082
         NI    WRKEDSW1,HEXF7      RESET EXPECTED SOR SW                06500082
         SR    WRKRG4,WRKRG4                                            06550082
         IC    WRKRG4,0(PARMRG1)   GET CHAR IN SOR LOCATION             06600082
         LA    WRKRG3,HEX78+1                                           06650082
         LA    WRKRG5,HEX71-1      INIT SCAN FOR PROGRAM LEVEL CODES    06700082
SCNPGMLV LA    WRKRG5,1(WRKRG5)                                         06750082
         CLR   WRKRG5,WRKRG4       IS THIS BYTE A PROG LEVEL CODE       06800082
         BE    PGMLVFND            BR IS YES                            06850082
         CLR   WRKRG5,WRKRG3       HAS SCAN EXCEEDER RANGE OF PL CODES  06900082
         BL    SCNPGMLV            BR IF NO TO CONT SCAN                06950082
         CLI   0(PARMRG1),HEXCAN   IS THIS A CANCEL CODE                07000082
         BE    CANFND              BR IF YES                            07050082
         CLI   0(PARMRG1),HEXGS    IS THIS A GS CODE                    07100082
         BE    GSFND               BR IF YES                            07150082
         OI    WRKTYPST,HEX01      INDICATE SOR/EOR ERROR IN TYPE STAT  07200082
         MVI   WRKSORSV,HEX0E      SET SOR ERROR IN ERROR DESCRIPTION   07250082
         B     CKKPSOR1                                                 07300082
CANFND   OI    WRKEDSW1,HEX82      SET ON DELET SW AND DO NOT ALLOW DUP 07350082
         MVI   WRKLEVST,HEXF0      RESET LEVEL STATUS                   07400082
         B     PTAGN               BR TO CONT SCAN                      07450082
GSFND    OI    WRKEDSW1,HEX08      SET EXPECT SOR SWITCH ON             07500082
         B     PTAGN                                                    07550082
CONTSCAN L     WRKRG3,WRKENIPT     GET INPUT END + 1                    07600082
         SR    WRKRG3,PARMRG1      GET LNG OF BUFFER REMAINING          07650082
         LTR   WRKRG3,WRKRG3       IS INPUT EMPTY                       07700082
         BP    L256CK              BR IF NO                             07750082
         BCTR  PARMRG1,0           DECR PTR TO NXT AVAIL IN IPT         07800082
         B     NOCDS1                                                   07850082
L256CK   C     WRKRG3,LGT256       ARE THERE MORE THAN 256 BYTES LEFT   07900082
         BNH   DECRRG              BR IF NO                             07950082
         L     WRKRG3,LGT256       SET LENGTH TO 256                    08000082
DECRRG   BCTR  WRKRG3,0            DECR LENGTH                          08050082
         LR    WRKRG5,PARMRG1      ADDR OF FIRST BYTE TO BE SCANNED     08100082
         AR    WRKRG5,WRKRG3       PLUS SCAN LNG - 1                    08150082
         ST    WRKRG5,WRKNXAVI     GIVES INPUT PTR IF NO SPECIAL CODES  08200082
         ST    WRKRG5,WRKENSCN     STORE AS END OF SCANNED              08250082
         SR    WRKRG2,WRKRG2       PREPARE FOR TRT                      08300082
         EX    WRKRG3,TRTTBL       TRANSLATE AND TEST                   08350082
         BC    8,NOSPECCD          BR IF NO SPECIAL CODES FOUND         08400082
         ST    PARMRG1,WRKNXAVI    SAVE LAST SCANNED AS INPUT PTR       08450082
         TM    WRKEDSW1,HEX80      IS THIS RECORD BEING DELETED         08500082
         BZ    BRTBL               BR IS NO                             08550082
         CH    WRKRG2,TWOOH        IS THIS END OF DELETED RECORD        08600082
         BL    PTAGN                                                    08650082
BRTBL    B     BRNCHTBL-4(WRKRG2)  BR TO BR TABLE TO HANDLE NONZERO     08700082
NOSPECCD L     PARMRG1,WRKENSCN    GET END OF SCANNED                   08750082
         L     WRKRG6,WRKENIPT     IS END OF SCANNED NOW                08800082
         BCTR  WRKRG6,0            POINTING AT LAST                     08850082
         CR    WRKRG6,PARMRG1      BYTE IN THIS BUFFER                  08900082
         BNE   CKCANRCD            BR IF NO                             08950082
NOCDS1   OI    WRKEDSW2,HEX01      IND PARTIAL RCD                      09000082
         NI    WRKEDSW2,HEXF7      INDICATE IPT EMPTY                   09050082
         TM    WRKEDSW1,HEX80      IS  RCD BEING DELETED                09100082
         BZ    SETRTURN            BR IF NO                             09150082
         TM    EDTTYPSW,HEX10      ARE USING BTAM BUFFERS               09200082
         BZ    DELETRCD            BR IF NO                             09250082
         L     PARMRG1,WRKADNXB    GET PTR TO NEXT BUFFER               09300082
         LTR   PARMRG1,PARMRG1     ARE ANY BUFFERS LEFT                 09350082
         BNZ   GETBUF              BR IF YES TO POINT TO NEXT BUFFE½    09400082
DELETRCD MVI   19(SAVERG),HEX08    IND IPT EMPTY RCD NOT AVAIL          09450082
         B     RETURNX                                                  09500082
CKCANRCD TM    WRKEDSW1,HEX80      IS RECORD BEING DELETED              09550082
         BO    PTAGN               BR IF YES                            09600082
         B     SETRTURN            GO MOVE IT OUT                       09650082
*                                                                       09700082
* * *  BRANCH TABLE * * *                                               09750082
*                                                                       09800082
TRTTBL   TRT   0(0,PARMRG1),TRNSTBLE                                    09850082
BRNCHTBL B     LEFTZROF *          LEFT ZERO FILL                       09900082
         B     DUP      *          DUP                                  09950082
         B     LFTZROST *          LEFT ZERO START                      10000082
         B     CANCEL   *          CANCEL                               10050082
         B     PTAGN    *          GROUP SEPARATOR CODES                10100082
         B     BSCCHARS *          BCS CHARS                            10150082
         B     DATACK   *          DATA CHECK -2772 REPLACE CHARACTER   10200082
         B     ENDDATA             END OF DATA ON CARTRIDGE             10250082
         B     RMORVOK  *          RECORD MARK OR VERIFY OK             10300082
         B     PGMLEVEL *          PROGRAM LEVEL 1-8                    10350082
*                                                                       10400082
* * * END OF BRANCH TABLE * * *                                         10450082
*                                                                       10500082
* *  HANDLE LEFT ZERO FILL CODES                                        10550082
LEFTZROF TM    WRKEDSW1,HEX40      HAS A LEFT ZERO START BEEN FOUND     10600082
         BZ    NOLZSFND            BR IF NO                             10650082
LZFCNT   LH    WRKRG2,WRKLZFCT     PICK UP COUNT OF LA FIL CHARS        10700082
         LA    WRKRG2,1(WRKRG2)    INCR COUNT OF LZF                    10750082
         STH   WRKRG2,WRKLZFCT     AND SAVE                             10800082
         MVC   0(1,PARMRG1),EDTREPCR  MOVE IN REP CHAR IN CASE FLD      10850082
         OI    WRKEDSW2,HEX10      INDICATE LZF FOUND                   10900082
*                                     REMAINS UNJUSTIFIED               10950082
         BAL   LNKRG8,MOVERTN      GO MOVE IT OUT                       11000082
         BAL   LNKRG8,PTINPUT      GO POINT TO NEXT BYTE                11050082
         TM    WRKEDSW2,HEX08      IS INPUT EMPTY                       11100082
         BZ    RETURNX             BR IF YES                            11150082
         CLI   0(PARMRG1),ETB      IS THIS BSC END CHAR                 11200082
         BE    BSCCHARS            BR IF YES                            11250082
         CLI   0(PARMRG1),HEX03    IS THIS BSC END CHAR                 11300082
         BE    BSCCHARS            BR IF YES                            11350082
CMPRLZF  CLI   0(PARMRG1),HEXLZF   IS THIS ALSO A LEFT ZERO FILL        11400082
         BE    LZFCNT              BR IF YES TO CONT SCAN FOR LZF       11450082
         OI    WRKEDSW1,HEX20      INDICATE END OF LZ FIELD             11500082
         NI    WRKEDSW2,HEXEF      RESET LZ MODE SW                     11550082
         BCTR  PARMRG1,0           DECR INPUT POINTER                   11600082
         ST    PARMRG1,WRKNXAVI    STORE INPUT POINTER                  11650082
         B     SETRTURN            GO SET UP FOR ADJUST                 11700082
NOLZSFND MVC   0(1,PARMRG1),EDTREPCR REPLACE FIELD ERROR BYTE           11750082
         OI    WRKTYPST,HEX04      INDICATE FIELD ERROR IN TYPE STATUS  11800082
         B     SETRTURN            GO MOVE IT OUT                       11850082
         SPACE 1                                                        11900082
* * HANDLE DUP CODES                                                    11950082
DUP      NI    WRKEDSW1,HEX9F      RESET POSSIBLE LEFT ZERO             12000082
         BCTR  PARMRG1,0           DECR INPUT POINTER                   12050082
         ST    PARMRG1,WRKNXAVI    STORE PREV ADDR AS INPUT POINTER     12100082
         BAL   LNKRG8,MOVERTN      GO MOVE OUT ALL UP TO DUP            12150082
         BAL   LNKRG8,PTINPUT      POINT TO DUP AGAIN                   12200082
         OI    WRKEDSW1,HEX01      INDICATE DUP FOUND IN THIS RECORD    12250082
         TM    WRKEDSW1,HEX02      IS DUP ALLOWED                       12300082
         BO    NOLZSFND            BR IF NO                             12350082
         L     WRKRG5,WRKNXAVW     GET NEXT AVAIL IN WORK               12400082
         L     WRKRG6,WRKLDBPV     GET PTR TO LAST DATA BYTE PREV RCD   12450082
         TM    EDTTYPSW,HEX80      ARE TO KEEP SOR/EOR CHARS            12500082
         BZ    CMPR8               BR IF NO                             12550082
         BCTR  WRKRG6,0            DECR PTR TO LAST DATA BYTE PREV RCD  12600082
CMPR8    CR    WRKRG5,WRKRG6       IS DUP BEYOND END OF PREV RCD        12650082
         BH    NOLZSFND            BR IF YES TO INDICATE FIELD ERROR    12700082
         CLC   0(WRKRG5),EDTREPCR  IS BYTE TO BE DUPED A REPLACE CHAR   12750082
         BE    NOLZSFND            BR IS YES                            12800082
         MVC   0(1,PARMRG1),0(WRKRG5) PERFORM DUPLICATION               12850082
         B     SETRTURN            GO MOVE IT OUT                       12900082
         SPACE 1                                                        12950082
* *  HANDLE LEFT ZERO START CODES                                       13000082
LFTZROST BCTR  PARMRG1,0           DO NOT MOVE LEFT ZERO START          13050082
         BAL   LNKRG8,MOVERTN      MOVE OUT ALL UP TO LEFT ZERO START   13100082
         OI    WRKEDSW1,HEX40      INDICATE LZ START                    13150082
         MVC   WRKFBLZF,WRKNXAVW   SAVE ADDR OF START OF LZ FIELD       13200082
         B     PTAGN                                                    13250082
         SPACE 1                                                        13300082
* *  HANDLE VERIFY OK OR RECORD MARK                                    13350082
RMORVOK  NI    WRKEDSW1,HEX9F      RESET POSSIBLE LZ MODE               13400082
         OI    WRKEDSW1,HEX08      SET EXPECT SOR SWITCH ON             13450082
         TM    WRKEDSW1,HEX80      IS THIS RECORD BEING DELETED         13500082
         BO    RECDEL              BR IF YES                            13550082
         MVI   WRKEORSV,CVOK       SET VOK IND IN ERROR DESCRIPTION     13600082
         CLI   0(PARMRG1),HEXVOK   WAS EOR AN IRS(VOK) CODE             13650082
         BE    VOK                 BR IF YES                            13700082
         MVI   WRKEORSV,CRM        SAVE RM INDICATOR IN EDW             13750082
         TM    EDTTYPSW,HEX20      MUST EOR BE VOK                      13800082
         BZ    VOK                 BR IF NO                             13850082
         OI    WRKTYPST,HEX01      INDICATE SOR/EOR ERROR IN EDW        13900082
VOK      TM    EDTTYPSW,HEX80      IS EOR TO BE RETAINED                13950082
         BO    EORRTAIN            BR IF YES                            14000082
         BCTR  PARMRG1,0           DECR INPUT PTR SO EOR NOT MOVED OUT  14050082
EORRTAIN B     SETRTURN            GO MOVE IT OUT                       14100082
RECDEL   NI    WRKEDSW1,HEX7F      SET OFF DELETE SWITCH                14150082
         B     PTAGN               GO CONT SCAN                         14200082
         SPACE 1                                                        14250082
* *  HANDLE PROGRAM LEVEL CODES                                         14300082
PGMLEVEL TM    WRKEDSW1,HEX80      IS THIS RECORD BEING DELETED         14350082
         BZ    CANCEL              BR IF NO TO FORCE END OF PREV RCD    14400082
         NI    WRKEDSW1,HEX7F      SET OFF DELETE SW                    14450082
PGMLVFND MVC   WRKSORSV(1),0(PARMRG1) SAVE IT AS SOR IN EDW             14500082
         NI    WRKSORSV,HEX0F      PUT IN FORM OF HEX 0X                14550082
CKKPSOR1 TM    EDTTYPSW,HEX80      SOR TO BE RETAINED                   14600082
         BZ    PTAGN               BR IF NO TO CONT SCAN                14650082
         ST    PARMRG1,WRKFBSCN    SAVE AS START                        14700082
         B     SETRTURN            GO MOVE IT OUT                       14750082
CANCEL   OI    WRKEDSW1,HEX08      SET EXPECT SOR SW ON                 14800082
         NI    WRKEDSW1,HEX9F      RESET POSSIBLE LZ MODE               14850082
         OI    WRKTYPST,HEX01      INDICATE SOR/EOR ERROR               14900082
         MVI   WRKEORSV,CHE        IND EOR ERROR IN EDW                 14950082
         BCTR  PARMRG1,0           DECR INPUT POINTER                   15000082
         ST    PARMRG1,WRKNXAVI    STORE INPUT POINTER                  15050082
         TM    EDTTYPSW,HEX80      EOR TO BE RETAINED                   15100082
         BO    NOEOR               BR IF YES                            15150082
         BCTR  PARMRG1,0           DECR INPUT PTR SO EOR NOT MOVED      15200082
NOEOR    OI    WRKEDSW1,HEX04      INDICATE EOR FORCED                  15250082
         B     SETRTURN            GO MOVE IT OUT                       15300082
         SPACE 1                                                        15350082
* *  HANDLE DATA CHECK  - 2772 REPLACE CHARS X'3F'                      15400082
DATACK   MVC   0(1,PARMRG1),EDTREPCR REPLACE DATA CK IND WITH REP CHAR  15450082
         OI    WRKTYPST,HEX08      IND DATA CHECK IN TYPE STATUS        15500082
         BAL   LNKRG8,MOVERTN      GO MOVE IT OUT                       15550082
         BAL   LNKRG8,PTINPUT      POINT TO NEXT BYTES                  15600082
         CLI   0(PARMRG1),HEX3F    IS THIS DATA CK BYTE ALSO            15650082
         BO    DBLDC               BR IF YES                            15700082
         BCTR  PARMRG1,0           DECR INPUT POINTER                   15750082
         ST    PARMRG1,WRKNXAVI    STORE INPUT POINTER                  15800082
         B     PTAGN                                                    15850082
DBLDC    MVC   0(1,PARMRG1),EDTREPCR REPLACE DATA CK IND WITH REP CHAR  15900082
         OI    WRKEDSW2,HEX02      INDICATE DOUBLE DATA CK              15950082
         B     SETRTURN            GO MOVE IT OUT                       16000082
         SPACE 1                                                        16050082
* *  HANDLE BSC CHARACTERS                                              16100082
BSCCHARS OI    WRKEDSW2,HEX04      INDICATE BSC END CHAR FOUND          16150082
         BCTR  PARMRG1,0           DECR PTR TO IPT                      16200082
         TM    WRKEDSW1,HEX08      IS SOR EXPECTED                      16250082
         BZ    NOCDS1                                                   16300082
         NI    WRKEDSW2,HEXF7      IND IPT EMPTY                        16350082
         MVI   19(SAVERG),HEX08    IND IPT EMPTY RCD NOT AVAIL          16400082
         B     RETURN                                                   16450082
         SPACE 1                                                        16500082
* * HANDLE END OF DATA CODE                                             16550082
ENDDATA  TM    WRKEDSW1,HEX08      IS SOR EXPECTED                      16600082
         BZ    CANCEL              BR IF NO TO FORCE END OF PREV RCD    16650082
         MVI   19(SAVERG),HEX0C    IND LAST RCD                         16700082
         NI    PRMMXRCL,HEX7F      IND BEG OF CARTRIDGE                 16750082
         TM    PRMMXRCL,HEX40      WAS GETMAIN ISSUED                   16800082
         BZ    RETRNZ              BR IF NO                             16850082
         L     PARMRG1,PRMWRKAD    GET PTR TO CORE OBTAINED VIA GETMAIN 16900082
         L     PARMRG0,WRKLNGSV    GET LNG OF CORE OBTAINED             16950082
         SR    WRKRG2,WRKRG2                                            17000082
         ST    WRKRG2,PRMWRKAD     ZERO PTR TO WORK STORAGE             17050082
         FREEMAIN R,LV=(0),A=(1)                                        17100082
RETRNZ   NI    PRMMXRCL,HEXBF      RESET GETMAIN SW                     17150082
         B     RETURNX             RETURN TO USER                       17200082
SETRTURN LA    LNKRG8,PTAGN        SET RETURN ADDR FROM MOVE RTN        17250082
*                                                                       17300082
* * *  MOVE ROUTINE  * * *                                              17350082
*                                                                       17400082
MOVERTN  L     WRKRG5,WRKNXAVW     GET ADDR OF NEXT AVAIL IN WORK       17450082
         L     WRKRG7,WRKFBSCN     GET ADDR OF FIRST BYTE SCANNED       17500082
         LR    WRKRG4,PARMRG1      ADDR OF LAST BYTE SCANNED            17550082
         LA    WRKRG4,1(WRKRG4)    GET END OF SCANNED +1                17600082
         SR    WRKRG4,WRKRG7       CALC LENGTH OF SCANNED               17650082
         BNP   NOBYTES             BR IF NO BYTES TO BE MOVED           17700082
         L     WRKRG6,WRKENWRK     GET END OF WORK AREA + 1             17750082
         SR    WRKRG6,WRKRG5       CALC NO BYTES AVAIL IN WORK AREA     17800082
         CR    WRKRG4,WRKRG6       WILL ALL SCANNED BYTES FIT IN WORK   17850082
         BNH   MVSCN               BR IF YES TO MOVE SCANNED            17900082
         OI    WRKEDSW1,HEX10      INDICATE NOT ALL FIT                 17950082
         NI    WRKEDSW2,HEXFE      RESET POSSIBLE PARTIAL RCD IND       18000082
         LTR   WRKRG4,WRKRG6       WILL ANY BYTES FIT                   18050082
         BNP   RCDTOOLG            BR IF NO                             18100082
MVSCN    BCTR  WRKRG4,0            DECR LNG FOR EXECUTE                 18150082
         EX    WRKRG4,MOVESCND     MOVE SCANNED FROM INPUT TO WORK AREA 18200082
         LA    WRKRG4,1(WRKRG4)    RESTORE LNG                          18250082
         AR    WRKRG7,WRKRG4       CALC ADDR OF FIRST BYTE NOT MOVED    18300082
         ST    WRKRG7,WRKFBSCN     FROM INPUT TO WORK AREA              18350082
         TM    EDTTYPSW,HEX80      ARE TO KEEP SOR/EOR CHARS            18400082
         BZ    DONOTKP             BR IF NO                             18450082
         BCTR  WRKRG7,0            DECR POINTER TO NXT AV IPT           18500082
DONOTKP  AR    WRKRG5,WRKRG4       CALC NEXT AVAIL WORK                 18550082
         ST    WRKRG5,WRKNXAVW     SAVE ADDR OF NEXT AVAIL WORK         18600082
         TM    WRKEDSW1,HEX10      DID ALL SCANNED FIT                  18650082
         BO    RCDTOOLG            BR IF NO                             18700082
NOFCREOR TM    WRKEDSW1,HEX08      WAS END OF RECORD FOUND              18750082
         BO    ENDRCFND            BR IF YES                            18800082
         TM    WRKEDSW2,HEX01      IS THIS A PARTIAL RCD                18850082
         BO    ENDRCFND            BR IF YES                            18900082
         TM    WRKEDSW1,HEX20      WAS END OF LZ FIELD FOUND            18950082
         BCR   8,LNKRG8            BR IF NO TO CALLING RTN              19000082
         SPACE 1                                                        19050082
* * LEFT ZERO JUSTIFICATION                                             19100082
LZJSTRTN NI    WRKEDSW1,HEX9F      SET OFF LZ MODE                      19150082
         L     WRKRG4,WRKFBLZF     GET ADDR OF START OF LZ FIELD        19200082
         LH    WRKRG3,WRKLZFCT     GET COUNT OF LZ FILLS                19250082
         SR    WRKRG5,WRKRG4       CALC FIELD LNG                       19300082
         CH    WRKRG5,HLF15        DOES FIELD LNG EXCEED 15             19350082
         BNH   ADJUST              BR IF NO TO ADJUST                   19400082
         OI    WRKTYPST,HEX04      INDICATE FIELD ERROR                 19450082
         BR    LNKRG8              RETURN TO CALLING RTN                19500082
ADJUST   SR    WRKRG5,WRKRG3       GET NO OF SIGNIFICANT DIGITS         19550082
         BCTR  WRKRG5,0            DECR LNG FOR EXECUTE                 19600082
         LR    WRKRG6,WRKRG4       ADDR OF START OF LZ FIELD IN WORK    19650082
         AR    WRKRG6,WRKRG3       FIELD START + LZ FILL COUNT          19700082
         EX    WRKRG5,MVSIGDGT     MOVE SIGNIFICANT DIGITS TO HOLD AREA 19750082
         EX    WRKRG5,MVDGTWRK     MOVE SIGNIFICANT DIGITS TO RIGHT     19800082
MVZROFIL MVI   0(WRKRG4),HEXF0     MOVE ZERO FILL                       19850082
         LA    WRKRG4,1(WRKRG4)    INCR WORK ADDR                       19900082
         BCT   WRKRG3,MVZROFIL     BR IF NOT ALL FILLED                 19950082
         STH   WRKRG3,WRKLZFCT     ZERO COUNT FIELD                     20000082
         BR    LNKRG8              RETURN TO CALLING ROUTINE            20050082
MVSIGDGT MVC   WRKSVLZJ(0),0(WRKRG4) USED BY EXECUTE TO                 20100082
MVDGTWRK MVC   0(0,WRKRG6),WRKSVLZJ  RIGHT JUSTIFY FIELD                20150082
         SPACE 1                                                        20200082
* *  THIS ROUTINE IS ENTERED FOR RECORDS WHICH EXCEED USER SPECIFIED *  20250082
* *      RECORD  LENGTH                                                 20300082
RCDTOOLG OI    WRKTYPST,HEX03      INDICATE SOR/EOR AND LENGTH ERROR    20350082
         MVI   WRKEORSV,CHE        SET EOR ERROR IN ERROR DESCRIPTION   20400082
         OI    WRKEDSW1,HEX08      SET EXPECT SOR SW ON                 20450082
         OI    WRKEDSW2,HEX08      IND IPT NOT EMPTY                    20500082
         ST    WRKRG7,WRKNXAVI     SAVE ADDR AS INPUT POINTER           20550082
         TM    WRKEDSW1,HEX40      IN LZ MODE                           20600082
         BZ    ENDRCFND            BR IF NO                             20650082
         SR    PARMRG0,PARMRG0     ZERO REG FOR COMPARE                 20700082
         CH    PARMRG0,WRKLZFCT    ANY LZ FILLS FOUND                   20750082
         BE    ENDRCFND            BR IF NO                             20800082
         ST    PARMRG0,WRKLZFCT    SET CNT FIELD TO ZERO                20850082
         BCTR  WRKRG5,0            POINT TO LAST BYTE MOVED TO WORKAREA 20900082
         CLC   0(1,WRKRG5),EDTREPCR WAS LAST MOVED A FILL CHAR          20950082
         BNE   CKKPSOR             BR IF NO                             21000082
         OI    WRKTYPST,HEX04      INDICATE A FIELD ERROR IN TYPE STAT  21050082
CKKPSOR  TM    EDTTYPSW,HEX80      RETAIN SOR/EOR BYTES SPECIFIED       21100082
         BZ    SETUP               BR IF NO                             21150082
         BCTR  WRKRG5,0            POINT TO LAST MOVED TO WORK          21200082
         B     SETUP               GO SET UP TO OUTPUT RCD              21250082
NOBYTES  TM    EDTTYPSW,HEX80      PRE TO KEEP SOR/EOR CHARS            21300082
         BO    NOFCREOR            BR IF YES                            21350082
         TM    WRKEDSW1,HEX04      WAS EOR FORCED                       21400082
         BZ    NOFCREOR            BR IF NO                             21450082
         BCTR  WRKRG5,0            DECR ADDR NEXT WORK SO BAD           21500082
         ST    WRKRG5,WRKNXAVW     EOR NOT RETAINED AS PART OF RCD      21550082
ENDRCFND BCTR  WRKRG5,0            POINT TO LAST MOVED TO WORK          21600082
SETUP    L     PARMRG1,WRKNXAVI    GET POINTER TO INPUT                 21650082
         LA    PARMRG1,1(PARMRG1)  POINT NEXT AVAIL BYTE                21700082
BALROUT  BAL   LNKRG8,CKINPUT      GO SET STATUS OF INPUT               21750082
         TM    WRKEDSW2,HEX08      IS INPUT EMPTY                       21800082
         BZ    IPTNTEPT            BR IF NO                             21850082
         BCTR  PARMRG1,0           DECR POINTER TO INPUT                21900082
         ST    PARMRG1,WRKNXAVI    SAVE AS NEXT AVAIL IN INPUT          21950082
IPTNTEPT TM    WRKEDSW2,HEX01      IS THIS PARTIAL RCD                  22000082
         BO    RETURN              BR IF YES                            22050082
         L     PARMRG0,WRKADRRC    GET ADDR OF RCD                      22100082
         L     PARMRG1,WRKNXAVW    GET PTR TO NEXT AVAIL IN WORK        22150082
         ST    PARMRG0,WRKNXAVW    REINIT PTR TO NEXT AVAIL WORK        22200082
         SR    PARMRG1,PARMRG0     CAL LENGTH OF RCD                    22250082
         TM    EDTTYPSW,HEX80      ARE SOR/EOR CHARS TO BE RETAINED     22300082
         BO    CKLNFR3             BR IF YES                            22350082
         LTR   PARMRG1,PARMRG1     IS RCD LENGTH AT LEAST ONE           22400082
         BZ    CKPARRCD            BR IF NO                             22450082
         BP    SVLSTBYT            BR IF YES TO PASS IT                 22500082
DONTPASS OI    WRKEDSW1,HEX02      RESET EDT SW AND DO NOT ALLOW DUP    22550082
         NI    WRKEDSW1,HEX0A      RESET EDIT SW                        22600082
         NI    WRKEDSW2,HEX88                                           22650082
         MVI   WRKLEVST,CHAR0      RESET LEVEL STATUS                   22700082
         B     ZROTYPST            GO ZERO TYPE STATUS                  22750082
CKLNFR3  CH    PARMRG1,THREE       IS RCD LENGTH AT LEAST 3             22800082
         BL    DONTPASS            BR IF NO                             22850082
SVLSTBYT ST    WRKRG5,WRKLDBPV     SAVE LAST DATA BYTE IN RCD           22900082
         ST    PARMRG1,WRKSVLZJ+8  SAVE LNG OF RCD                      22950082
*                                                                       23000082
* * *  OUTPUT ROUTINE  * * *                                            23050082
OUTPUT   TM    WRKEDSW2,HEX01      IS THIS PARTIAL RCD                  23100082
         BO    RETURN              BR IF YES                            23150082
         CLI   WRKSORSV,HEX0E      WAS SOR IN ERROR                     23200082
         BO    WRNGLN              BR IF YES                            23250082
         SR    WRKRG4,WRKRG4       SET TO ZERO FOR COMPARE              23300082
         SR    WRKRG5,WRKRG5       SET TO ZERO FOR CALC                 23350082
         IC    WRKRG5,WRKSORSV     GET SOR CHAR                         23400082
         AR    WRKRG5,WRKRG5       DOUBLE IT TO INDEX TABL              23450082
         CH    WRKRG4,WRKSVPGL-2(WRKRG5) HAS LENGTH BEEN SAVED          23500082
         BNE   CKLNGPL             BE IF YES                            23550082
         TM    WRKTYPST,HEX0F      DOES RCD HAVE INDENTIFIABLE ERROR    23600082
         BNZ   IDENTER             BR IF YES                            23650082
         STH   PARMRG1,WRKSVPGL-2(WRKRG5) SAVE LNG FOR THIS LEVEL       23700082
         BO    IDENTER             BYPASS LNG CHECK                     23750082
CKLNGPL  CH    PARMRG1,WRKSVPGL-2(WRKRG5) CK LNG WITH SAVED LNG         23800082
         BE    IDENTER             BR IF LNG OK                         23850082
         OI    WRKTYPST,HEX02      INDICATE WRONG LNG RCD               23900082
IDENTER  TM    WRKTYPST,HEX02      WAS IT A WRONG LNG RCD               23950082
         BO    WRNGLN              BR IF YES                            24000082
         TM    WRKEDSW2,HEX02      WAS DOUBLE DATA CHECK FOUND          24050082
         BO    WRNGLN              BR IF YES                            24100082
         CLI   WRKLEVST,CHAR0      IS LEVEL STATUS ZERO                 24150082
         BE    RESETSW             BR IF YES                            24200082
         TM    WRKEDSW1,HEX01      WAS DUP ENCOUNTERED                  24250082
         BO    MKLEVST2            BR IF YES                            24300082
         MVI   WRKLEVST,CHAR0      RESET LEVEL STATUS                   24350082
         B     RESETSW             GO RESET EDIT SWITCHES               24400082
WRNGLN   CLI   WRKLEVST,CHAR0      IS LEVEL STATUS ZERO                 24450082
         BNE   MKLEVST2            BR IF NO                             24500082
         MVI   WRKLEVST,CHAR1      MAKE IT 1                            24550082
         B     RESETSW             GO RESET EDIT SWITCHES               24600082
MKLEVST2 MVI   WRKLEVST,CHAR2      MAKE IT 2                            24650082
RESETSW  NI    WRKEDSW1,HEX08      RESET EDIT SWITCHES                  24700082
         NI    WRKEDSW2,HEX88                                           24750082
         CH    PARMRG1,EDTMINLN    CHECK MINIMUM LENGTH                 24800082
         BNL   MINLNOK             BR IF NOT SHORT                      24850082
         OI    WRKTYPST,HEX02      INDICATE LENGTH ERROR                24900082
MINLNOK  TR    WRKTYPST(2),TREDW   MAKE TYPE AND LEVEL STATUS PRNTABLE  24950082
RETURN1  LR    WRKRG3,PARMRG0      PTR TO RCD                           25000082
         LA    PARMRG0,HEX04       SET UP REG FOR SUB                   25050082
         TM    EDTTYPSW,HEX08      USER ERROR EXIT SPECIFIED            25100082
         BO    CKVFRMT1            BR IF NO                             25150082
         CLC   WRKSVEDW(2),CHAR00  IS THIS AN ERROR RECORD              25200082
         BE    CKVFRMT1            BR IF NO                             25250082
         SR    WRKRG3,PARMRG0      DECR PTR TO RCD                      25300082
         MVC   0(4,WRKRG3),WRKSVEDW APPEND EDW TO BEG OF RCD            25350082
         LA    PARMRG1,4(PARMRG1)  INCR LENGTH OF RCD TO INCLUDE EDW    25400082
CKVFRMT1 TM    EDTTYPSW,HEX40      DOES RECFM=V                         25450082
         BZ    RECFMU1             BR IF NO                             25500082
         LA    PARMRG1,4(PARMRG1)  INCR RCD LENGTH TO INCLUDE V-FIELD   25550082
         SR    WRKRG3,PARMRG0      DECR PTR TO RCD                      25600082
         STH   PARMRG1,0(WRKRG3)   SAVE LENGTH IN V-FIELD               25650082
         XC    2(2,WRKRG3),2(WRKRG3) SET SECOND HALF TO ZERO            25700082
RECFMU1  ST    PARMRG1,WRKSVLZJ+8  SAVE RECORD LENGTH                   25750082
         ST    WRKRG3,WRKSVLZJ     SAVE RECORD ADDR                     25800082
         LA    WRKRG3,WRKSVLZJ+8                                        25850082
         ST    WRKRG3,WRKSVLZJ+4                                        25900082
         TM    EDTTYPSW,HEX08      IS USER ERROR EXIT SPEC              25950082
         BO    RETURN              BR IF NO                             26000082
         CLC   WRKSVEDW(2),CHAR00  IS THIS AN ERROR RECORD              26050082
         BE    RETURN              BR IF NO                             26100082
         LR    WRKRG2,SAVERG       SAVE PTR TO USER SAVE AREA           26150082
         LA    SAVERG,WRKMACSV     POINT TO SAVE AREA                   26200082
         L     RTCDRG,EDTUSRXT     GET ADDR OF USER EXIT RTN            26250082
         LA    PARMRG1,WRKSVLZJ    POINT TO PARM LIST                   26300082
         BALR  RETRNRG,RTCDRG      GO TO USER EXIT ROUTINE              26350082
         LR    SAVERG,WRKRG2       RESTORE PTR SAVE AREA                26400082
         L     PARMRG1,WRKSVLZJ+8  GET RCD LNG                          26450082
         LA    PARMRG0,HEX04       SET UP RG FOR SUB                    26500082
         SR    PARMRG1,PARMRG0     DECR RCD LNG                         26550082
         ST    PARMRG1,WRKSVLZJ+8  SAVE RCD LNG                         26600082
         L     WRKRG3,WRKSVLZJ                                    M4292 26650082
         LA    WRKRG3,4(WRKRG3)    INCR RCD ADDR                        26700082
         TM    EDTTYPSW,HEX40      RECFM=V                              26750082
         BZ    NORCFM3             BR IF NO                             26800082
         MVC   0(4,WRKRG3),0(WRKRG7) MOVE V FIELD                       26850082
         STH   PARMRG1,0(WRKRG3)   SAVE RCD LNG IN V-FIELD              26900082
NORCFM3  ST    WRKRG3,WRKSVLZJ     SAVE RCD ADDR IN PARM LIST           26950082
         LTR   RTCDRG,RTCDRG       ARE TO PASS RCD                      27000082
         BNZ   NOFORMAT            BYPASS RCD                           27050082
RETURN   LA    WRKRG3,WRKSVLZJ     POINT TO PARMLIST                    27100082
         ST    WRKRG3,24(SAVERG)   AND SAVE                             27150082
RETURNX  LM    RETRNRG,BASERG,12(SAVERG) RESTORE USERS REGS             27200082
         BR    RETRNRG                                                  27250082
PTINPUT  L     PARMRG1,WRKNXAVI    POINT TO                             27300082
         LA    PARMRG1,1(PARMRG1)  NEXT BYTE                            27350082
         ST    PARMRG1,WRKNXAVI    IN INPUT                             27400082
SVSCBST  ST    PARMRG1,WRKFBSCN    SAVE SCAN START ADDR                 27450082
CKINPUT  C     PARMRG1,WRKENIPT    ANY BYTES LEFT IN INPUT              27500082
         BNL   IPTBSC              BR IF NO                             27550082
         TM    WRKEDSW2,HEX04      WAS BSC END CHAR FOUND               27600082
         BO    IPTBSC              BR IF YES                            27650082
         OI    WRKEDSW2,HEX08           INPUT NOT EMPTY          A35755 27700082
         MVI   19(SAVERG),HEX04    INDICATE INPUT NOT EMPTY RCD AVAIL   27750082
         BR    LNKRG8              RETURN TO CALLING ROUTINE            27800082
IPTBSC   NI    WRKEDSW2,HEXFB      RESET BSC END CHAR FOUND SW          27850082
         TM    WRKEDSW1,HEX08      SOR EXPECTED                         27900082
         BO    CKBTAMBF                                                 27950082
         OI    WRKEDSW2,HEX01      IND PARTIAL RCD                      28000082
CKBTAMBF TM    EDTTYPSW,HEX10      ARE USING BTAM BUFFERS               28050082
         BZ    NOBUF2              BR IF NO                             28100082
         L     PARMRG1,WRKADNXB    GET PTR TO NEXT BUFFER IN CHAIN      28150082
         LTR   PARMRG1,PARMRG1     ARE ANY MORE BUFFERS IN CHAIN        28200082
         BZ    NOBUF2              BR IF NO                             28250082
         NI    WRKEDSW2,HEXF7      IND BUFFER EMPTY                     28300082
         TM    WRKEDSW2,HEX01      IS THIS A PARTIAL RCD                28350082
         BO    GETBUF              BR IF YES                            28400082
         MVI   19(SAVERG),HEX04    IND IPT NOT EMPTY RCD NOT AVAIL      28450082
         BR    LNKRG8              RETURN TO CALLING RTN                28500082
NOBUF2   NI    WRKEDSW2,HEXF7      INDICATE INPUT EMPTY                 28550082
         MVI   19(SAVERG),HEX00    IND IPT EMPTY RCD AVAIL              28600082
         TM    WRKEDSW1,HEX08      SOR EXPECTED                         28650082
         BCR   1,LNKRG8                                                 28700082
         MVI   19(SAVERG),HEX08    IND INPUT EMPTY RCD NOT AVAIL        28750082
         BR    LNKRG8              RETURN TO CALLING RTN                28800082
*                                                                       28850082
* * *  REGISTER EQUATES * * *                                           28900082
*                                                                       28950082
PARMRG0  EQU   0                                                        29000082
PARMRG1  EQU   1                                                        29050082
WRKRG2   EQU   2                                                        29100082
WRKRG3   EQU   3                                                        29150082
WRKRG4   EQU   4                                                        29200082
WRKRG5   EQU   5                                                        29250082
WRKRG6   EQU   6                                                        29300082
WRKRG7   EQU   7                                                        29350082
LNKRG8   EQU   8                                                        29400082
WRKSTRG  EQU   9                                                        29450082
EDTPRMRG EQU   10                                                       29500082
PRMLSTRG EQU   11                                                       29550082
BASERG   EQU   12                                                       29600082
SAVERG   EQU   13                                                       29650082
RETRNRG  EQU   14                                                       29700082
RTCDRG   EQU   15                                                       29750082
*                                                                       29800082
* * *  EQUATES USED AS CONSTANTS  * * *                                 29850082
*                                                                       29900082
HEX00    EQU   X'00'                                                    29950082
HEX01    EQU   X'01'                                                    30000082
HEX02    EQU   X'02'                                                    30050082
HEX03    EQU   X'03'                                                    30100082
HEX04    EQU   X'04'                                                    30150082
HEX08    EQU   X'08'                                                    30200082
HEX0A    EQU   X'0A'                                                    30250082
HEX0C    EQU   X'0C'                                                    30300082
HEX10    EQU   X'10'                                                    30350082
HEX20    EQU   X'20'                                                    30400082
HEX40    EQU   X'40'                                                    30450082
HEX80    EQU   X'80'                                                    30500082
DLE      EQU   X'10'                                                    30550082
STX      EQU   X'02'                                                    30600082
HEXF7    EQU   X'F7'                                                    30650082
HEX71    EQU   X'71'                                                    30700082
HEX78    EQU   X'78'                                                    30750082
HEXCAN   EQU   X'18'                                                    30800082
HEXGS    EQU   X'1D'                                                    30850082
HEX0E    EQU   X'0E'                                                    30900082
HEX82    EQU   X'82'                                                    30950082
HEXF0    EQU   X'F0'                                                    31000082
HEXLZF   EQU   X'00'                                                    31050082
HEX9F    EQU   X'9F'                                                    31100082
CRM      EQU   C'U'                                                     31150082
HEX7F    EQU   X'7F'                                                    31200082
CVOK     EQU   C'V'                                                     31250082
HEX0F    EQU   X'0F'                                                    31300082
CHE      EQU   C'E'                                                     31350082
HEX3F    EQU   X'3F'                                                    31400082
CHAR0    EQU   C'0'                                                     31450082
CHAR1    EQU   C'1'                                                     31500082
CHAR2    EQU   C'2'                                                     31550082
HEXFE    EQU   X'FE'                                                    31600082
HEXFB    EQU   X'FB'                                                    31650082
HEXDUP   EQU   X'11'                                                    31700082
ETB      EQU   X'26'                                                    31750082
HEX19    EQU   X'19'                                                    31800082
HEXVOK   EQU   X'1E'                                                    31850082
HEXRM    EQU   X'3C'                                                    31900082
HEX12    EQU   X'12'                                                    31950082
HEX88    EQU   X'88'                                                    32000082
HEX16    EQU   X'16'                                                    32050082
HEXBF    EQU   X'BF'                                                    32100082
HEXEF    EQU   X'EF'                                                    32150082
*                                                                       32200082
* * *  CONSTANTS  * * *                                                 32250082
*                                                                       32300082
LGT256   DC    F'256'                                                   32350082
TWOOH    DC    H'20'                                                    32400082
HLF15    DC    H'15'                                                    32450082
THREE    DC    H'3'                                                     32500082
TREDW    DC    C'01234567'         USED TO MAKE EDW                     32550082
         DC    C'89ABCDEF'         PRINTABLE                            32600082
CHAR00   DC    C'00'                                                    32650082
MOVESCND MVC   0(0,WRKRG5),0(WRKRG7) USED BY EXECUTE IN MOVE RTN        32700082
*                                                                       32750082
* * *  TRANSLATE AND TEST TABLE  * * *                                  32800082
*                                                                       32850082
TRNSTBLE DC    256X'00'                                                 32900082
         ORG   TRNSTBLE+HEXLZF                                          32950082
         DC    X'04' *             LEFT ZERO FILL                       33000082
         ORG   TRNSTBLE+HEXDUP                                          33050082
         DC    X'08'               DUP                                  33100082
         ORG   TRNSTBLE+HEX12                                           33150082
         DC    X'0C'               LEFT ZERO START                      33200082
         ORG   TRNSTBLE+HEXCAN                                          33250082
         DC    X'10'               CANCEL                               33300082
         ORG   TRNSTBLE+HEX0C                                           33350082
         DC    X'14'               GROUP SEPARATOR                      33400082
         ORG   TRNSTBLE+ETB                                             33450082
         DC    X'18'               ETB                                  33500082
         ORG   TRNSTBLE+HEX03                                           33550082
         DC    X'18'               ETX                                  33600082
         ORG   TRNSTBLE+HEX3F                                           33650082
         DC    X'1C'               DATA CHECK                           33700082
         ORG   TRNSTBLE+HEX19                                           33750082
         DC    X'20'               END DATA                             33800082
         ORG   TRNSTBLE+HEXVOK                                          33850082
         DC    X'24'               VERIFY OK                            33900082
         ORG   TRNSTBLE+HEXRM                                           33950082
         DC    X'24'               RECORD MARK                          34000082
         ORG   TRNSTBLE+HEX71                                           34050082
         DC    8X'28'              PROGRAM LEVEL 1-8                    34100082
         ORG                                                            34150082
PARMLIST DSECT                                                          34200082
PRMINPUT DS    A *                 ADDR OF INPUT                        34250082
PRMIPTLN DS    A *                 LENGTH OF INPUT                      34300082
PRMWRKAD DS    A *                 ADDR OF WORK AREA                    34350082
PRMMXRCL DS    A *                 MAXIMUM RECORD LENGTH                34400082
EDITPARM DSECT                                                          34450082
EDTTYPSW DS    B *                 EDIT SWS INDICATING USER OPTIONS     34500082
EDTREPCR DS    X *                 REPLACE CHARACTER                    34550082
EDTMINLN DS    H *                 MINIMUN ACCEPTABLE RECORD LENGTH     34600082
EDTUSRXT DS    V *                 USER ERROR EXIT ROUTINE              34650082
WORKSTOR DSECT                                                          34700082
WRKADRRC DS    A *                 ADDR OF RECORD                       34750082
WRKADNXB DS    A *                 POINTER TO NEXT BUFFER               34800082
WRKENWRK DS    A *                 PTR TO END OF WORK + 1               34850082
WRKNXAVW DS    A *                 PTR TO NEXT AVAIL IN WORK AREA       34900082
WRKNXAVI DS    A *                 PTR TO NEXT AVAIL IN INPUT           34950082
WRKENIPT DS    A *                 PTR TO END OF INPUT + 1              35000082
WRKFBSCN DS    A *                 PTR TO FIRST BYTE SCANNED            35050082
WRKENSCN DS    A *                 PTR TO LAST BYTE SCANNED             35100082
WRKLDBPV DS    A *                 PTR TO LAST DATA BYTE OF PREV RCD    35150082
WRKFBLZF DS    A *                 PTR TO FIRST BYTE OF LZ FIELD        35200082
WRKSVLZJ DS    4F *                SAVE AREA FOR LZ JUSTIFICATION RTN   35250082
WRKSVEDW DS    F *                 ERROR DESCRIPTION WORD               35300082
         ORG   WRKSVEDW *                                               35350082
WRKLEVST DS    C *                 LEVEL STATUS                         35400082
WRKTYPST DS    B *                 TYPE STATUS                          35450082
WRKSORSV DS    X *                 SOR                                  35500082
WRKEORSV DS    X *                 EOR                                  35550082
WRKSVPGL DS    8H *                SAVE AREA FOR LNG OF PGM LEVEL CODES 35600082
WRKLZFCT DS    H *                 COUNT OF LZ FILL CHARS               35650082
         SPACE 1                                                        35700082
*      THE BITS IN WRKEDSW1 ARE USED AS FOLLOWS                         35750082
*      BIT 0  ON INDICATES DELETE THIS RECORD                           35800082
*      BIT 1  ON INDICATES LEFT ZERO START CODE FOUND                   35850082
*      BIT 2  ON INDICATES END OF LEFT ZERO FIELD FOUND                 35900082
*      BIT 3  ON INDICATES ALL SCANNED NOT FIT IN WORK AREA             35950082
*      BIT 4  ON INDICATES SOR CHARACTER EXPECTED                       36000082
*      BIT 5  ON INDICATES END OF RECORD FORCED                         36050082
*      BIT 6  ON INDICATES DUP NOT ALLOWED IN THIS RECORD               36100082
*      BIT 7  ON INDICATES DUP FOUND IN THIS RECORD                     36150082
WRKEDSW1 DS    B *                 EDIT SWITCHES                        36200082
         SPACE 1                                                        36250082
*      THE BITS IN WRKEDSW2 ARE USED AS FOLLOWS                         36300082
*      BITS 0-3  RESERVED                                               36350082
*      BIT 4  ON INDICATES INPUT IS NOT EMPTY                           36400082
*     BIT 5 ON INDICATES BSC END CHARACTER FOUND                        36450082
*      BIT 6  ON INDICATES DOUBLE DATA CHECK FOUND IN THIS RECORD       36500082
*      BIT 7  ON INDICATES THIS RECORD IS A PARTIAL RECORD              36550082
WRKEDSW2 DS    B *                 EDIT SWITCH                          36600082
WRKLNGSV DS    F *                 SAVE FOR LENGTH OF WORK AREA         36650082
WRKMACSV DS    F *                 BEGIN OF SAVE AREA IF PRESENT        36700082
         END                                                            36750082
