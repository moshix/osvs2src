         TITLE 'IKJCT432 - EXEC RECORD SCAN ROUTINE                    *00001000
                        '                                               00002000
IKJCT432 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJCT432  77.215'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @09,0                                               0001 00011000
@PSTART  LA    @10,4095(,@09)                                      0001 00012000
         LA    @11,4095(,@10)                                      0001 00013000
         USING @PSTART,@09                                         0001 00014000
         USING @PSTART+4095,@10                                    0001 00015000
         USING @PSTART+8190,@11                                    0001 00016000
         L     @00,@SIZDATD                                        0001 00017000
         GETMAIN  R,LV=(0)                                              00018000
         LR    @12,@01                                             0001 00019000
         USING @DATD,@12                                           0001 00020000
         ST    @13,@SA00001+4                                      0001 00021000
         LM    @00,@01,20(@13)                                     0001 00022000
         ST    @12,8(,@13)                                         0001 00023000
         LR    @13,@12                                             0001 00024000
         MVC   @PC00001(4),0(@01)                                  0001 00025000
*   PARMPTR=R1;                     /* ADDR OF 432 PARM LIST         */ 00026000
         LR    PARMPTR,R1                                          0084 00027000
*   RFY                                                            0085 00028000
*    (R1) UNRSTD;                   /* RELEASE R1                    */ 00029000
*   STMT=OFF;                       /* RESET STMT SWITCH             */ 00030000
         NI    STMT,B'01111111'                                    0086 00031000
*   ECDAPTR=ECDAPTR2;               /* POINTER TO ECDA               */ 00032000
         L     ECDAPTR,ECDAPTR2(,PARMPTR)                          0087 00033000
*   RLENGTH=ECDAIREC->RECLEN-FOUR;  /* REMOVE LL LENGTH              */ 00034000
         L     @14,ECDAIREC(,ECDAPTR)                              0088 00035000
         LH    @14,RECLEN(,@14)                                    0088 00036000
         SL    @14,@CF00072                                        0088 00037000
         ST    @14,RLENGTH                                         0088 00038000
*   OC=ZERO;                        /* ZERO OUT OPCODE               */ 00039000
         L     @14,ECDACNXT(,ECDAPTR)                              0089 00040000
         MVI   OC(@14),X'00'                                       0089 00041000
*   CALL CMDSCAN;                   /* CALL COMMAND SCAN ROUTINE TO     00042000
*                                      CHECK INPUT RECORD            */ 00043000
         BAL   @14,CMDSCAN                                         0090 00044000
*   IF LABLADD=ZERO THEN            /* IF NO LABEL                   */ 00045000
         L     @14,LABLADD                                         0091 00046000
         LTR   @14,@14                                             0091 00047000
         BZ    @RT00091                                            0091 00048000
*     GOTO CMDCHKS;                 /* ELSE GO CHECK COMMAND NAME    */ 00049000
*                                                                  0092 00050000
*   /*****************************************************************/ 00051000
*   /*                                                               */ 00052000
*   /* THE LABEL IS SYNTATICALLY CORRECT. CALL THE SYMBOLIC NAME     */ 00053000
*   /* TABLE ROUTINE TO ADD THE LABEL TO THE TABLE.                  */ 00054000
*   /*                                                               */ 00055000
*   /*****************************************************************/ 00056000
*                                                                  0093 00057000
*   PARMADR=LABLADD;                /* ADDRESS OF THE LABEL          */ 00058000
         ST    @14,PARMADR                                         0093 00059000
*   PARMLNG=LABLLEN;                /* LENGTH OF LABEL               */ 00060000
         L     @14,LABLLEN                                         0094 00061000
         ST    @14,PARMLNG                                         0094 00062000
*   PARMTYPE=LABL;                  /* INDICATE IT IS A LABEL        */ 00063000
         MVC   PARMTYPE(2),@CH00033                                0095 00064000
*   CALL SYNTAB(NTUPTPRM);          /* CALL SYNTAB                   */ 00065000
         LA    @14,NTUPTPRM                                        0096 00066000
         ST    @14,@AL00001                                        0096 00067000
         LA    @01,@AL00001                                        0096 00068000
         BAL   @14,SYNTAB                                          0096 00069000
*   IF R15^=ZERO THEN               /* IF SYNTAB ROUTINE FAILED      */ 00070000
         LTR   R15,R15                                             0097 00071000
         BNZ   @RT00097                                            0097 00072000
*     GO TO SPCLEXIT;               /* THEN RETURN TO THE CALLER     */ 00073000
*CMDCHKS:                                                          0099 00074000
*   IF CMDADD=ZERO THEN             /* NEXT CHECK RECORD FOR A       */ 00075000
CMDCHKS  SLR   @14,@14                                             0099 00076000
         C     @14,CMDADD                                          0099 00077000
         BNE   @RF00099                                            0099 00078000
*     DO;                           /* COMMAND NAME -IF NOT FOUND    */ 00079000
*       IF LABLADD^=ZERO THEN       /* AND THERE WAS A LABEL,        */ 00080000
         L     @06,LABLADD                                         0101 00081000
         CR    @06,@14                                             0101 00082000
         BE    @RF00101                                            0101 00083000
*         DO;                                                      0102 00084000
*           EXMSGID=M532;           /* THEN ISSUE MESSAGE            */ 00085000
         MVC   EXMSGID(4),@CC00491                                 0103 00086000
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */ 00087000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0104 00088000
*           MVAR(2)=LABLADD;        /* LABEL WILL APPEAR IN MESSAGE  */ 00089000
         ST    @06,MVAR+4                                          0105 00090000
*           MVARLEN(2)=LABLLEN;     /* VARIABLE LENGTH               */ 00091000
         L     @14,LABLLEN                                         0106 00092000
         STC   @14,MVARLEN+4                                       0106 00093000
*           STMT=ONS;               /* STATEMENT NUMBER REQUESTED    */ 00094000
         OI    STMT,B'10000000'                                    0107 00095000
*           CALL MSGRTN;            /* ISSUE MESSAGE                 */ 00096000
         BAL   @14,MSGRTN                                          0108 00097000
*         END;                                                     0109 00098000
*       R15=ZERO;                   /* SET THE RC = 0                */ 00099000
@RF00101 SLR   R15,R15                                             0110 00100000
*       NULLINE=ONS;                /* SET THE NULL LINE FLAG      0111 00101000
*                                                            @ZA05505*/ 00102000
         OI    NULLINE(PARMPTR),B'00001000'                        0111 00103000
*       GO TO SPCLEXIT;             /* RETURN AS LINE WAS NULL       */ 00104000
         B     SPCLEXIT                                            0112 00105000
*     END;                                                         0113 00106000
*   OC=ZERO;                        /* ZERO OUT OPCODE FIELD         */ 00107000
@RF00099 L     @14,ECDACNXT(,ECDAPTR)                              0114 00108000
         MVI   OC(@14),X'00'                                       0114 00109000
*   IF TSODISG=ON THEN              /* IF IT IS A TSO COMMAND IN     */ 00110000
         TM    TSODISG,B'00100000'                                 0115 00111000
         BO    @RT00115                                            0115 00112000
*     GOTO TSOCALL;                 /* DISGUISE (%,&) THEN BRANCH    */ 00113000
*                                                                  0116 00114000
*   /*****************************************************************/ 00115000
*   /*                                                               */ 00116000
*   /* NEXT USE THEN LENGTH OF THE COMMAND NAME TO BRANCH TO THE     */ 00117000
*   /* PROPER CALLING ROUTINES. A LENGTH OF GREATER THAN 8 ON A      */ 00118000
*   /* RECORD WITH A LABEL WILL RESULT IN AN ERROR--IF THERE IS NO   */ 00119000
*   /* LABEL THEN ASSUME IT IS A TSO COMMAND A COMMAND WITH A LENGTH */ 00120000
*   /* OF 1 TO 4 MAY BE AN ALTERNATE END. IF IT IS THEN GIVE CONTROL */ 00121000
*   /* TO THE END ROUTINE                                            */ 00122000
*   /*                                                               */ 00123000
*   /*****************************************************************/ 00124000
*                                                                  0117 00125000
*   IF CMDLEN=ECDAELNG THEN         /* NO---                         */ 00126000
         LH    @14,ECDAELNG(,ECDAPTR)                              0117 00127000
         C     @14,CMDLEN                                          0117 00128000
         BNE   @RF00117                                            0117 00129000
*     IF COMMAND(1:CMDLEN)=         /*                               */ 00130000
*         ECDAAEND(1:ECDAELNG) THEN /* YES--CALL END ROUTINE.        */ 00131000
         BCTR  @14,0                                               0118 00132000
         L     @06,CMDADD                                          0118 00133000
         EX    @14,@SC00853                                        0118 00134000
         BNE   @RF00118                                            0118 00135000
*       CALL ENDCMD;                /* CALL END                      */ 00136000
*                                                                  0119 00137000
         BAL   @14,ENDCMD                                          0119 00138000
*   /*****************************************************************/ 00139000
*   /*                                                               */ 00140000
*   /* IF COMMAND WAS NOT AN END OR ALTERNATE END THEN BRANCH TO     */ 00141000
*   /* PROPER CALL ROUTINES WHICH WILL PASS CONTROL TO PROPER COMMAND*/ 00142000
*   /* ROUTINES. A LENGTH OF 1 IS ASSUMED TO BE TSO                  */ 00143000
*   /*                                                               */ 00144000
*   /*****************************************************************/ 00145000
*                                                                  0120 00146000
*   GOTO ROUTINE;                   /* BRANCH TO PROPER ROUTINE      */ 00147000
*                                                                  0120 00148000
@RF00118 DS    0H                                                  0120 00149000
@RF00117 L     @14,CMDLEN                                          0120 00150000
         SLA   @14,2                                               0120 00151000
         L     @14,ROUTE-4(@14)                                    0120 00152000
         BR    @14                                                 0120 00153000
*   /*****************************************************************/ 00154000
*   /*                                                               */ 00155000
*   /* THE FOLLOWING ARE THE CALLING ROUTINES ENTERED ACCORDING TO   */ 00156000
*   /* THE LENGTH OF THE COMMAND LENGTH OF 2 WILL BE IF,DO OR TSO    */ 00157000
*   /*                                                               */ 00158000
*   /*****************************************************************/ 00159000
*                                                                  0121 00160000
*LENGTH2:                                                          0121 00161000
*   IF COMMAND(1:TWO)=CIF THEN      /* IF ?                          */ 00162000
LENGTH2  L     @14,CMDADD                                          0121 00163000
         CLC   COMMAND(2,@14),@CC00527                             0121 00164000
         BNE   @RF00121                                            0121 00165000
*     CALL IFCMD;                   /* IF                            */ 00166000
         BAL   @14,IFCMD                                           0122 00167000
*   IF COMMAND(1:TWO)=DOO THEN      /* DO COMMAND?                   */ 00168000
@RF00121 L     @14,CMDADD                                          0123 00169000
         CLC   COMMAND(2,@14),@CC00412                             0123 00170000
         BNE   @RF00123                                            0123 00171000
*     CALL DOCMD;                   /* YES                           */ 00172000
         BAL   @14,DOCMD                                           0124 00173000
*TSOCALL:                                                          0125 00174000
*   CALL COMCMD;                    /* NO---TSO                      */ 00175000
@RF00123 DS    0H                                                  0125 00176000
TSOCALL  BAL   @14,COMCMD                                          0125 00177000
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */ 00178000
*                                                                  0126 00179000
         B     COMNEXIT                                            0126 00180000
*   /*****************************************************************/ 00181000
*   /*                                                               */ 00182000
*   /* LENGTH OF 3 WILL BE SET COMMAND OR TSO. END WAS CHECKED       */ 00183000
*   /*                                                               */ 00184000
*   /*****************************************************************/ 00185000
*                                                                  0127 00186000
*LENGTH3:                                                          0127 00187000
*   IF COMMAND(1:THREE)=SET THEN    /* SET?                          */ 00188000
LENGTH3  L     @14,CMDADD                                          0127 00189000
         CLC   COMMAND(3,@14),@CC00539                             0127 00190000
         BNE   @RF00127                                            0127 00191000
*     CALL SETCMD;                  /* SET COMMAND                   */ 00192000
         BAL   @14,SETCMD                                          0128 00193000
*   CALL COMCMD;                    /* TSO                           */ 00194000
@RF00127 BAL   @14,COMCMD                                          0129 00195000
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */ 00196000
*                                                                  0130 00197000
         B     COMNEXIT                                            0130 00198000
*   /*****************************************************************/ 00199000
*   /*                                                               */ 00200000
*   /* LENGTH OF 4 WILL BE GOTO,ELSE,READ,EXIT,SETC,DATA OR TSO      */ 00201000
*   /*                                                               */ 00202000
*   /*****************************************************************/ 00203000
*                                                                  0131 00204000
*LENGTH4:                                                          0131 00205000
*   IF COMMAND(1:FOUR)=GOTOS THEN   /* GOTO ?                        */ 00206000
LENGTH4  L     @14,CMDADD                                          0131 00207000
         CLC   COMMAND(4,@14),@CC00541                             0131 00208000
         BNE   @RF00131                                            0131 00209000
*     DO;                           /* GOTO COMMAND                  */ 00210000
*       OC=OPONE;                   /* GOTO OPCODE = 01              */ 00211000
         L     @14,ECDACNXT(,ECDAPTR)                              0133 00212000
         MVI   OC(@14),X'01'                                       0133 00213000
*       CALL COMCMD;                /* GOTO                          */ 00214000
         BAL   @14,COMCMD                                          0134 00215000
*       GOTO COMNEXIT;              /* CALL COMMON EXIT              */ 00216000
         B     COMNEXIT                                            0135 00217000
*     END;                                                         0136 00218000
*   IF COMMAND(1:FOUR)=CELSE THEN   /* ELSE ?                        */ 00219000
@RF00131 L     @14,CMDADD                                          0137 00220000
         CLC   COMMAND(4,@14),@CC00529                             0137 00221000
         BNE   @RF00137                                            0137 00222000
*     CALL ELSECMD;                 /* ELSE                          */ 00223000
         BAL   @14,ELSECMD                                         0138 00224000
*   IF COMMAND(1:FOUR)=READS THEN   /* READ ?                        */ 00225000
@RF00137 L     @14,CMDADD                                          0139 00226000
         CLC   COMMAND(4,@14),@CC00545                             0139 00227000
         BNE   @RF00139                                            0139 00228000
*     DO;                           /*                               */ 00229000
*       CALL READCMD;               /* READ                          */ 00230000
         BAL   @14,READCMD                                         0141 00231000
*       GO TO SPCLEXIT;             /* GO TO SPCLEXIT                */ 00232000
         B     SPCLEXIT                                            0142 00233000
*     END;                                                         0143 00234000
*   IF COMMAND(1:FOUR)=ATTN THEN    /* ATTN ?                        */ 00235000
@RF00139 L     @14,CMDADD                                          0144 00236000
         CLC   COMMAND(4,@14),@CC00416                             0144 00237000
         BNE   @RF00144                                            0144 00238000
*     DO;                           /* ATTENTION CMD                 */ 00239000
*       OC=OPATTN;                  /* SET OP CODE                   */ 00240000
         L     @14,ECDACNXT(,ECDAPTR)                              0146 00241000
         MVI   OC(@14),X'11'                                       0146 00242000
*       CALL ERRORCMD;              /* ATTN USES ERROR CMD PROCESS   */ 00243000
         BAL   @14,ERRORCMD                                        0147 00244000
*     END;                                                         0148 00245000
*   IF COMMAND(1:FOUR)=CDATA THEN   /* DATA ?                        */ 00246000
@RF00144 L     @14,CMDADD                                          0149 00247000
         CLC   COMMAND(4,@14),@CC00533                             0149 00248000
         BNE   @RF00149                                            0149 00249000
*     CALL DATACMD;                 /* DATA                          */ 00250000
         BAL   @14,DATACMD                                         0150 00251000
*   IF COMMAND(1:FOUR)=EXITS THEN   /* EXIT ?                        */ 00252000
@RF00149 L     @14,CMDADD                                          0151 00253000
         CLC   COMMAND(4,@14),@CC00547                             0151 00254000
         BNE   @RF00151                                            0151 00255000
*     OC=OPSIX;                     /* EXIT OPCODE = 06              */ 00256000
         L     @14,ECDACNXT(,ECDAPTR)                              0152 00257000
         MVI   OC(@14),X'06'                                       0152 00258000
*   CALL COMCMD;                    /* EXIT OR TSO CALL COMCMD       */ 00259000
@RF00151 BAL   @14,COMCMD                                          0153 00260000
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */ 00261000
*                                                                  0154 00262000
         B     COMNEXIT                                            0154 00263000
*   /*****************************************************************/ 00264000
*   /*                                                               */ 00265000
*   /* LENGTH OF 5 WILL BE ERROR,WRITE OR TSO COMMAND                */ 00266000
*   /*                                                               */ 00267000
*   /*****************************************************************/ 00268000
*                                                                  0155 00269000
*LENGTH5:                                                          0155 00270000
*   IF COMMAND(1:FIVE)=ERROR THEN   /* ERROR ?                       */ 00271000
LENGTH5  L     @14,CMDADD                                          0155 00272000
         CLC   COMMAND(5,@14),@CC00549                             0155 00273000
         BNE   @RF00155                                            0155 00274000
*     CALL ERRORCMD;                /* ERROR                         */ 00275000
         BAL   @14,ERRORCMD                                        0156 00276000
*   IF COMMAND(1:FIVE)=WRITE THEN   /* WRITE ?                       */ 00277000
@RF00155 L     @14,CMDADD                                          0157 00278000
         CLC   COMMAND(5,@14),@CC00551                             0157 00279000
         BNE   @RF00157                                            0157 00280000
*     OC=OPFIVE;                    /* WRITE-- OPCODE = 05           */ 00281000
         L     @14,ECDACNXT(,ECDAPTR)                              0158 00282000
         MVI   OC(@14),X'05'                                       0158 00283000
*   CALL COMCMD;                    /* WRITE AND TSO CALL COMCMD     */ 00284000
@RF00157 BAL   @14,COMCMD                                          0159 00285000
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */ 00286000
         B     COMNEXIT                                            0160 00287000
*LENGTH6:                                                          0161 00288000
*   IF COMMAND(1:SIX)=GLOBALS THEN  /* GLOBAL COMMAND                */ 00289000
LENGTH6  L     @14,CMDADD                                          0161 00290000
         CLC   COMMAND(6,@14),@CC00553                             0161 00291000
         BNE   @RF00161                                            0161 00292000
*     DO;                           /*                               */ 00293000
*       OC=OPGLOB;                                                 0163 00294000
         L     @14,ECDACNXT(,ECDAPTR)                              0163 00295000
         MVI   OC(@14),X'FF'                                       0163 00296000
*       CALL READCMD;               /* USES THE READ CMDND           */ 00297000
         BAL   @14,READCMD                                         0164 00298000
*       GO TO SPCLEXIT;             /* GO TO SPECIAL EXIT            */ 00299000
         B     SPCLEXIT                                            0165 00300000
*     END;                                                         0166 00301000
*   IF COMMAND(1:SIX)=TERMIN THEN   /* TERMIN COMMAND                */ 00302000
@RF00161 L     @14,CMDADD                                          0167 00303000
         CLC   COMMAND(6,@14),@CC00555                             0167 00304000
         BNE   @RF00167                                            0167 00305000
*     OC=OP11;                      /* TERMIN OP CODE = 13           */ 00306000
         L     @14,ECDACNXT(,ECDAPTR)                              0168 00307000
         MVI   OC(@14),X'0B'                                       0168 00308000
*   IF COMMAND(1:SIX)=RETURNS THEN  /* RETURN COMMAND                */ 00309000
@RF00167 L     @14,CMDADD                                          0169 00310000
         CLC   COMMAND(6,@14),@CC00557                             0169 00311000
         BNE   @RF00169                                            0169 00312000
*     OC=OPEASY;                    /* RETURN OP CODE =0E            */ 00313000
         L     @14,ECDACNXT(,ECDAPTR)                              0170 00314000
         MVI   OC(@14),X'0E'                                       0170 00315000
*   CALL COMCMD;                    /* WRITER,TERMIN AND TSO         */ 00316000
@RF00169 BAL   @14,COMCMD                                          0171 00317000
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */ 00318000
         B     COMNEXIT                                            0172 00319000
*LENGTH7:                                                          0173 00320000
*   IF COMMAND(1:SEVEN)=CENDATA THEN/* ENDDATA ?                     */ 00321000
LENGTH7  L     @14,CMDADD                                          0173 00322000
         CLC   COMMAND(7,@14),@CC00535                             0173 00323000
         BNE   @RF00173                                            0173 00324000
*     DO;                           /* ENDATA COMMAND ISSUE A MESSAGE*/ 00325000
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */ 00326000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0175 00327000
*       EXMSGID=M534;               /* MESSAGE ID                    */ 00328000
         MVC   EXMSGID(4),@CC00495                                 0176 00329000
*       MVAR(2)=ADDR(CENDATA);      /* FIRST INSERT                  */ 00330000
         LA    @14,@CC00535                                        0177 00331000
         ST    @14,MVAR+4                                          0177 00332000
*       MVARLEN(2)=LENGTH(CENDATA); /* LENGTH OF FIRST INSERT        */ 00333000
         MVI   MVARLEN+4,X'07'                                     0178 00334000
*       MVAR(3)=ADDR(CDATA);        /* SECOND INSERT                 */ 00335000
         LA    @14,@CC00533                                        0179 00336000
         ST    @14,MVAR+8                                          0179 00337000
*       MVARLEN(3)=LENGTH(CDATA);   /* LENGTH OF SECOND INSERT       */ 00338000
         MVI   MVARLEN+8,X'04'                                     0180 00339000
*       STMT=ONS;                   /* STATEMENT NUMBER REQUESTED    */ 00340000
         OI    STMT,B'10000000'                                    0181 00341000
*       CALL MSGRTN;                /* ISSUE MESSAGE                 */ 00342000
         BAL   @14,MSGRTN                                          0182 00343000
*       RETURN CODE(ZERO) TO SPCLEXIT;/* RETURN                      */ 00344000
         L     @13,4(,@13)                                         0183 00345000
         L     @00,@SIZDATD                                        0183 00346000
         LR    @01,@12                                             0183 00347000
         FREEMAIN R,LV=(0),A=(1)                                        00348000
         LA    @14,SPCLEXIT                                        0183 00349000
         SLR   @15,@15                                             0183 00350000
         LM    @00,@12,20(@13)                                     0183 00351000
         BR    @14                                                 0183 00352000
*     END;                                                         0184 00353000
*   IF COMMAND(1:SEVEN)=CONTROL THEN/* CONTROL ?                     */ 00354000
@RF00173 L     @14,CMDADD                                          0185 00355000
         CLC   COMMAND(7,@14),@CC00559                             0185 00356000
         BNE   @RF00185                                            0185 00357000
*     CALL CNTRLCMD;                /* CONTROL                       */ 00358000
         BAL   @14,CNTRLCMD                                        0186 00359000
*   IF COMMAND(1:SEVEN)=WRITENR THEN/* IF WRITENR COMMAND            */ 00360000
@RF00185 L     @14,CMDADD                                          0187 00361000
         CLC   COMMAND(7,@14),@CC00561                             0187 00362000
         BNE   @RF00187                                            0187 00363000
*     OC=OPFOUR;                    /* WRITE NO RETURN OC = 04       */ 00364000
         L     @14,ECDACNXT(,ECDAPTR)                              0188 00365000
         MVI   OC(@14),X'04'                                       0188 00366000
*   IF COMMAND(1:SEVEN)=GETFILE THEN/* GETFILE COMMAND               */ 00367000
@RF00187 L     @14,CMDADD                                          0189 00368000
         CLC   COMMAND(7,@14),@CC00422                             0189 00369000
         BNE   @RF00189                                            0189 00370000
*     OC=OPGFILE;                   /* GETFILE OP CODE = 14          */ 00371000
         L     @14,ECDACNXT(,ECDAPTR)                              0190 00372000
         MVI   OC(@14),X'14'                                       0190 00373000
*   IF COMMAND(1:SEVEN)=PUTFILE THEN/* PUTFILE COMMAND               */ 00374000
@RF00189 L     @14,CMDADD                                          0191 00375000
         CLC   COMMAND(7,@14),@CC00424                             0191 00376000
         BNE   @RF00191                                            0191 00377000
*     OC=OPPFILE;                   /* PUTFILE OP CODE = 15          */ 00378000
         L     @14,ECDACNXT(,ECDAPTR)                              0192 00379000
         MVI   OC(@14),X'15'                                       0192 00380000
*   CALL COMCMD;                    /* COMMON CMD ROUTINE            */ 00381000
@RF00191 BAL   @14,COMCMD                                          0193 00382000
*   GOTO COMNEXIT;                  /* EXIT THRU COMMON EXIT         */ 00383000
         B     COMNEXIT                                            0194 00384000
*LENGTH8:                                                          0195 00385000
*   IF COMMAND(1:EIGHT)=READDVAL THEN/* IF READ D COMMAND            */ 00386000
LENGTH8  L     @14,CMDADD                                          0195 00387000
         CLC   COMMAND(8,@14),@CC00537                             0195 00388000
         BNE   @RF00195                                            0195 00389000
*     DO;                           /* PROCESS AS READ COMMAND       */ 00390000
*       CALL READCMD;               /* CALL READ PROCESSOR           */ 00391000
         BAL   @14,READCMD                                         0197 00392000
*       GOTO SPCLEXIT;              /* EXIT                          */ 00393000
         B     SPCLEXIT                                            0198 00394000
*     END;                                                         0199 00395000
*   IF COMMAND(1:EIGHT)=OPENFILE THEN/* OPENFILE                     */ 00396000
@RF00195 L     @14,CMDADD                                          0200 00397000
         CLC   COMMAND(8,@14),@CC00418                             0200 00398000
         BNE   @RF00200                                            0200 00399000
*     OC=OPOFILE;                   /* OPENFILE OP CODE = 12         */ 00400000
         L     @14,ECDACNXT(,ECDAPTR)                              0201 00401000
         MVI   OC(@14),X'12'                                       0201 00402000
*   IF COMMAND(1:EIGHT)=CLOSFILE THEN/* CLOSE FILE                   */ 00403000
@RF00200 L     @14,CMDADD                                          0202 00404000
         CLC   COMMAND(8,@14),@CC00420                             0202 00405000
         BNE   @RF00202                                            0202 00406000
*     OC=OPCFILE;                   /* CLOSFILE OP CODE = 13         */ 00407000
         L     @14,ECDACNXT(,ECDAPTR)                              0203 00408000
         MVI   OC(@14),X'13'                                       0203 00409000
*   CALL COMCMD;                    /* ANYTHING ELSE CALL COMCMD     */ 00410000
@RF00202 BAL   @14,COMCMD                                          0204 00411000
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */ 00412000
*                                                                  0205 00413000
         B     COMNEXIT                                            0205 00414000
*   /*****************************************************************/ 00415000
*   /*                                                               */ 00416000
*   /* WHEN CONTROL IS RETURNED TO COMMON EXIT THEN THE MOVE ROUTINE */ 00417000
*   /* IS CALLED TO MOVE A RECORD TO THE STORAGE AREA                */ 00418000
*   /*                                                               */ 00419000
*   /*****************************************************************/ 00420000
*                                                                  0206 00421000
*COMNEXIT:                                                         0206 00422000
*   CALL MOVERTN;                   /* CALL MOVE ROUTINE             */ 00423000
COMNEXIT BAL   @14,MOVERTN                                         0206 00424000
*SPCLEXIT:                                                         0207 00425000
*   IF RCODE^=FOUR&RCODE^=TWENTY THEN                              0207 00426000
SPCLEXIT C     RCODE,@CF00072                                      0207 00427000
         BE    @RF00207                                            0207 00428000
         C     RCODE,@CF00357                                      0207 00429000
         BE    @RF00207                                            0207 00430000
*     DO WHILE ECDAIREC->OO^=0;     /* UPDATE ECDA                   */ 00431000
         B     @DE00208                                            0208 00432000
@DL00208 DS    0H                                                  0209 00433000
*       ECDAIREC=ECDAIREC-ECDAIREC->OO;/* ADJUST BUFFER              */ 00434000
         L     @14,ECDAIREC(,ECDAPTR)                              0209 00435000
         LR    @08,@14                                             0209 00436000
         SH    @08,OO(,@14)                                        0209 00437000
         ST    @08,ECDAIREC(,ECDAPTR)                              0209 00438000
*     END;                                                         0210 00439000
@DE00208 L     @14,ECDAIREC(,ECDAPTR)                              0210 00440000
         LH    @14,OO(,@14)                                        0210 00441000
         LTR   @14,@14                                             0210 00442000
         BNZ   @DL00208                                            0210 00443000
*   RETURN CODE(R15);               /* RETURN (SPECIAL EXIT ALSO)    */ 00444000
@RF00207 LR    @08,@15                                             0211 00445000
         L     @13,4(,@13)                                         0211 00446000
         L     @00,@SIZDATD                                        0211 00447000
         LR    @01,@12                                             0211 00448000
         FREEMAIN R,LV=(0),A=(1)                                        00449000
         LR    @15,@08                                             0211 00450000
         L     @14,12(,@13)                                        0211 00451000
         LM    @00,@12,20(@13)                                     0211 00452000
         BR    @14                                                 0211 00453000
*                                                                  0212 00454000
*   /*****************************************************************/ 00455000
*   /*                                                               */ 00456000
*   /* THE MOVE ROUTINE IS USED BY A NUMBER OF OTHER ROUTINES TO MOVE*/ 00457000
*   /* DATA INTO THE COMMAND PROCEDURE AREA. IF SPACE RUNS OUT IN THE*/ 00458000
*   /* STORAGE AREA- MOVE WILL DO A GETMAIN FOR A NEW STORAGE AREA.  */ 00459000
*   /* AT THE BEGINNING OF EACH STORAGE AREA THE LENGTH OF THE       */ 00460000
*   /* CURRENT STORAGE AREA AND THE ADDRESS OF OF THE NEXT ARE SAVED.*/ 00461000
*   /* THE ONLY ERROR FROM MOVE MAY BE A GETMAIN FAILURE.            */ 00462000
*   /*                                                               */ 00463000
*   /*****************************************************************/ 00464000
*                                                                  0212 00465000
*MOVERTN:                                                          0212 00466000
*   PROC;                                                          0212 00467000
MOVERTN  STM   @14,@12,@SA00002                                    0212 00468000
*   IF NOTEXEC=ON THEN                                             0213 00469000
         TM    NOTEXEC(ECDAPTR),B'01000000'                        0213 00470000
         BO    @RT00213                                            0213 00471000
*     RETURN;                       /* RETURN-PROC NOT EXECUTIBLE    */ 00472000
*                                                                  0214 00473000
*   /*****************************************************************/ 00474000
*   /*                                                               */ 00475000
*   /* FIRST CHECK FOR ENOUGH ROOM FOR THE MOVE--IF NOT ENOUGH THEN  */ 00476000
*   /* DO A GETMAIN FOR THE NEXT AND RE-INITIALIZE ALL APPROPRIATE   */ 00477000
*   /* POINTERS AND DATA & FREE UNUSED SPACE.                        */ 00478000
*   /*                                                               */ 00479000
*   /*****************************************************************/ 00480000
*                                                                  0215 00481000
*   IF COMPRLNG-COMPRUSE<DATALEN+LL+MAXPREFX THEN/* ENOUGH ROOM      */ 00482000
         L     @14,ECDACBLK(,ECDAPTR)                              0215 00483000
         L     @08,COMPRLNG(,@14)                                  0215 00484000
         SL    @08,COMPRUSE(,@14)                                  0215 00485000
         L     @14,ECDACNXT(,ECDAPTR)                              0215 00486000
         LH    @14,LL(,@14)                                        0215 00487000
         AL    @14,DATALEN                                         0215 00488000
         LA    @06,12                                              0215 00489000
         ALR   @06,@14                                             0215 00490000
         CR    @08,@06                                             0215 00491000
         BNL   @RF00215                                            0215 00492000
*     DO;                           /* NO-- DO A GETMAIN FOR RECORD     00493000
*                                      SIZE UP TO NEXT 4K BDY OR 2 0216 00494000
*                                      TIMES LAST GETMAIN            */ 00495000
*       GETBYTE=MAX((DATALEN+LL+SIXK)/FOURK*FOURK,TWO*ECDACPGM);   0217 00496000
         LR    @00,@14                                             0217 00497000
         AL    @00,@CF00388                                        0217 00498000
         SRDA  @00,32                                              0217 00499000
         D     @00,@CF00390                                        0217 00500000
         SLA   @01,12                                              0217 00501000
         L     GETBYTE,ECDACPGM(,ECDAPTR)                          0217 00502000
         ALR   GETBYTE,GETBYTE                                     0217 00503000
         CR    @01,GETBYTE                                         0217 00504000
         BNL   *+6                                                      00505000
         LR    @01,GETBYTE                                         0217 00506000
         LR    GETBYTE,@01                                         0217 00507000
*       GETBYTE=MIN(GETBYTE,MAXCPGM);/* MAX GM SIZE IS 32K           */ 00508000
         L     @14,@CF00477                                        0218 00509000
         CR    GETBYTE,@14                                         0218 00510000
         BNH   *+6                                                      00511000
         LR    GETBYTE,@14                                         0218 00512000
*       ECDACPGM=GETBYTE;           /* SAVE SIZE OF NEW BLOCK        */ 00513000
         ST    GETBYTE,ECDACPGM(,ECDAPTR)                          0219 00514000
*       DO;                         /* GETMAIN (EC) LV(GETBYTE)    0220 00515000
*                                      A(GTMNPTR) SP(78) RTCD(R15)   */ 00516000
*         RESPECIFY                                                0221 00517000
*          (GPR01P,                                                0221 00518000
*           GPR15F) RESTRICTED;                                    0221 00519000
*         I004=I004&&I004;          /* INIT LIST                     */ 00520000
         XC    I004(10),I004                                       0222 00521000
*         I00404='20'X;             /* TYPE                          */ 00522000
         MVI   I00404,X'20'                                        0223 00523000
*         I00401=GETBYTE;           /* LENGTH                        */ 00524000
         ST    GETBYTE,I00401                                      0224 00525000
*         I00403=ADDR(GTMNPTR);     /* ADDR OF ADDR LIST             */ 00526000
         LA    @14,GTMNPTR                                         0225 00527000
         STCM  @14,7,I00403                                        0225 00528000
*         I00405=78;                /* SUBPOOL VALUE                 */ 00529000
         MVI   I00405,X'4E'                                        0226 00530000
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */ 00531000
         LA    GPR01P,I004                                         0227 00532000
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */ 00533000
         SVC   4                                                   0228 00534000
*         R15=GPR15F;               /* SET RETURN CODE               */ 00535000
*         RESPECIFY                                                0230 00536000
*          (GPR01P,                                                0230 00537000
*           GPR15F) UNRESTRICTED;                                  0230 00538000
*       END;                        /* GETMAIN (EC) LV(GETBYTE)    0231 00539000
*                                      A(GTMNPTR) SP(78) RTCD(R15)   */ 00540000
*/*                                                                  */ 00541000
*                                                                  0232 00542000
*       IF R15^=ZERO THEN           /* IF GETMAIN FAILED THEN        */ 00543000
         LTR   R15,R15                                             0232 00544000
         BZ    @RF00232                                            0232 00545000
*         DO;                       /* ISSUE A MESSAGE               */ 00546000
*           EXMSGID=M511;           /* MESSAGE ID                    */ 00547000
         MVC   EXMSGID(4),@CC00481                                 0234 00548000
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */ 00549000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0235 00550000
*           STMT=ONS;               /* STAMTMENT NUMBERS REQUESTED   */ 00551000
         OI    STMT,B'10000000'                                    0236 00552000
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */ 00553000
         BAL   @14,MSGRTN                                          0237 00554000
*           RETURN CODE(TWELVE);    /* AND RETURN WITH A RTCD=12     */ 00555000
         LA    @15,12                                              0238 00556000
         L     @14,@SA00002                                        0238 00557000
         LM    @00,@12,@SA00002+8                                  0238 00558000
         BR    @14                                                 0238 00559000
*         END;                                                     0239 00560000
*       WORKPTR=ECDACBLK;           /* SAVE CURRENT BLOCK PTR        */ 00561000
@RF00232 L     @14,ECDACBLK(,ECDAPTR)                              0240 00562000
         ST    @14,WORKPTR                                         0240 00563000
*       COMPRNXT=GTMNPTR;           /* INIT @ OF NEXT STORAGE BLK    */ 00564000
         L     @06,GTMNPTR                                         0241 00565000
         STCM  @06,7,COMPRNXT(@14)                                 0241 00566000
*       X=COMPRID;                  /* IN PREVIOUS,SAVE BLK NUM.     */ 00567000
         SLR   X,X                                                 0242 00568000
         IC    X,COMPRID(,@14)                                     0242 00569000
*       ECDACBLK=GTMNPTR;           /* ADDRESS NEW BLOCK             */ 00570000
         ST    @06,ECDACBLK(,ECDAPTR)                              0243 00571000
*       COMPRID=X+ONE;              /* UPDATE BLOCK NUMBER           */ 00572000
         LA    @14,1                                               0244 00573000
         ALR   @14,X                                               0244 00574000
         STC   @14,COMPRID(,@06)                                   0244 00575000
*       ECDAIDS=COMPRID;            /* STORE ID IN ECDACBLK          */ 00576000
         STC   @14,ECDAIDS(,ECDAPTR)                               0245 00577000
*       COMPRNXT=ZERO;              /* POINTER TO NEXT               */ 00578000
         L     @14,ECDACBLK(,ECDAPTR)                              0246 00579000
         SLR   @08,@08                                             0246 00580000
         STCM  @08,7,COMPRNXT(@14)                                 0246 00581000
*       COMPRLNG=GETBYTE;           /* LENGTH OF BLOCK               */ 00582000
         ST    GETBYTE,COMPRLNG(,@14)                              0247 00583000
*       COMPRUSE=TWELVE;            /* # OF BYTES NOT IN USE - LENGTH   00584000
*                                      MINUS HEADER LENGTH           */ 00585000
*                                                                  0248 00586000
         LA    @08,12                                              0248 00587000
         ST    @08,COMPRUSE(,@14)                                  0248 00588000
*       /*************************************************************/ 00589000
*       /*                                                           */ 00590000
*       /* NEXT MOVE PREFIX OF CURRENT STOARGE RECORD INTO THE NEW   */ 00591000
*       /* BLOCK AND RE-ADJUST # OF BYTES UNUSED IN OLD BLOCK        */ 00592000
*       /*                                                           */ 00593000
*       /*************************************************************/ 00594000
*                                                                  0249 00595000
*       RFY                                                        0249 00596000
*        (R2,                                                      0249 00597000
*         R3,                                                      0249 00598000
*         R4,                                                      0249 00599000
*         R5) RSTD;                 /* FROM OLD BLOCK                */ 00600000
*       R4=ADDR(CPHEADER);          /* ADDR OF DATA IN OLD BLOCK     */ 00601000
         L     @06,ECDACNXT(,ECDAPTR)                              0250 00602000
         LR    R4,@06                                              0250 00603000
*       R5=LL;                      /* AMOUNT OF DATA IN OLD BLOCK   */ 00604000
         LH    R5,LL(,@06)                                         0251 00605000
*       R2=ECDACBLK+TWELVE;         /* NEW DATA ADDRESS              */ 00606000
         ALR   @14,@08                                             0252 00607000
         LR    R2,@14                                              0252 00608000
*       R3=R5;                      /* SAME AS OLD LENGTH            */ 00609000
         LR    R3,R5                                               0253 00610000
*       MVCL(R2,R4);                /* MOVE THE DATA                 */ 00611000
         MVCL  R2,R4                                               0254 00612000
*       RFY                                                        0255 00613000
*        (R2,                                                      0255 00614000
*         R3,                                                      0255 00615000
*         R4,                                                      0255 00616000
*         R5) UNRSTD;               /* RELEASE REGS                  */ 00617000
*                                                                  0255 00618000
*       /*************************************************************/ 00619000
*       /*                                                           */ 00620000
*       /* NEXT FREE ANY UNUSED SPACE IN OLD BLOCK                   */ 00621000
*       /*                                                           */ 00622000
*       /*************************************************************/ 00623000
*                                                                  0256 00624000
*       ECDACNXT=(ECDACNXT+SEVEN)/EIGHT*EIGHT;/* DOUBLE WORD         */ 00625000
         LA    @00,7                                               0256 00626000
         AL    @00,ECDACNXT(,ECDAPTR)                              0256 00627000
         SRDA  @00,32                                              0256 00628000
         D     @00,@CF00088                                        0256 00629000
         SLA   @01,3                                               0256 00630000
         ST    @01,ECDACNXT(,ECDAPTR)                              0256 00631000
*       DO;                         /* FREEMAIN (EC) LV(WORKPTR->COMP   00632000
*                                      RLNG-(ECDACNXT-WORKPTR))    0257 00633000
*                                      A(ECDACNXT) SP(78)            */ 00634000
*         RESPECIFY                                                0258 00635000
*          (GPR01P) RESTRICTED;                                    0258 00636000
*         I005=I005&&I005;          /* INIT LIST                     */ 00637000
         XC    I005(10),I005                                       0259 00638000
*         I00505='20'X;             /* SET TYPE                      */ 00639000
         MVI   I00505,X'20'                                        0260 00640000
*         I00502=WORKPTR->COMPRLNG-(ECDACNXT-WORKPTR);/* LENGTH      */ 00641000
         L     @14,WORKPTR                                         0261 00642000
         L     @08,ECDACNXT(,ECDAPTR)                              0261 00643000
         SLR   @08,@14                                             0261 00644000
         LCR   @08,@08                                             0261 00645000
         AL    @08,COMPRLNG(,@14)                                  0261 00646000
         STCM  @08,7,I00502                                        0261 00647000
*         I00504=ADDR(ECDACNXT);    /* ADDR OF ADDR LIST             */ 00648000
         LA    @14,ECDACNXT(,ECDAPTR)                              0262 00649000
         STCM  @14,7,I00504                                        0262 00650000
*         I00506=78;                /* SUBPOOL VALUE                 */ 00651000
         MVI   I00506,X'4E'                                        0263 00652000
*         GPR01P=ADDR(I005);        /* REG1 POINTS TO LIST           */ 00653000
         LA    GPR01P,I005                                         0264 00654000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 00655000
         SVC   5                                                   0265 00656000
*         RESPECIFY                                                0266 00657000
*          (GPR01P) UNRESTRICTED;                                  0266 00658000
*       END;                        /* FREEMAIN (EC) LV(WORKPTR->COMP   00659000
*                                      RLNG-(ECDACNXT-WORKPTR))    0267 00660000
*                                      A(ECDACNXT) SP(78) FREEMAIN   */ 00661000
*       WORKPTR->COMPRLNG=          /* UPDATE LENGTH OF OLD BLOCK    */ 00662000
*           WORKPTR->COMPRUSE;                                     0268 00663000
         L     @14,WORKPTR                                         0268 00664000
         L     @08,COMPRUSE(,@14)                                  0268 00665000
         ST    @08,COMPRLNG(,@14)                                  0268 00666000
*       ECDACNXT=ECDACBLK+TWELVE;   /* UPDATE @ OF CURRENT RECORD    */ 00667000
         LA    @14,12                                              0269 00668000
         AL    @14,ECDACBLK(,ECDAPTR)                              0269 00669000
         ST    @14,ECDACNXT(,ECDAPTR)                              0269 00670000
*     END;                                                         0270 00671000
*                                                                  0270 00672000
*   /*****************************************************************/ 00673000
*   /*                                                               */ 00674000
*   /* AT THIS POINT COMMON CODE BEGINS FOR THE MOVE ROUTINE         */ 00675000
*   /*                                                               */ 00676000
*   /*****************************************************************/ 00677000
*                                                                  0271 00678000
*   RFY                                                            0271 00679000
*    (R2,                                                          0271 00680000
*     R3,                                                          0271 00681000
*     R4,                                                          0271 00682000
*     R5) RSTD;                     /* RESTRICT REGS FOR MVCL        */ 00683000
@RF00215 DS    0H                                                  0272 00684000
*   R2=ECDACNXT+LL;                 /* RECEIVER                      */ 00685000
         L     @14,ECDACNXT(,ECDAPTR)                              0272 00686000
         LH    R2,LL(,@14)                                         0272 00687000
         ALR   R2,@14                                              0272 00688000
*   R3=DATALEN;                     /* LENGTH                        */ 00689000
         L     @14,DATALEN                                         0273 00690000
         LR    R3,@14                                              0273 00691000
*   R4=DATAADD;                     /* SOURCE                        */ 00692000
         L     R4,DATAADD                                          0274 00693000
*   R5=DATALEN;                     /* LENGTH                        */ 00694000
         LR    R5,@14                                              0275 00695000
*   MVCL(R2,R4);                    /* MOVE IN RECORD                */ 00696000
         MVCL  R2,R4                                               0276 00697000
*   RFY                                                            0277 00698000
*    (R3,                                                          0277 00699000
*     R4,                                                          0277 00700000
*     R5) UNRSTD;                   /* FREE REGS                     */ 00701000
*   LL=LL+DATALEN;                  /* UPDATE LL FIELD               */ 00702000
         L     @14,ECDACNXT(,ECDAPTR)                              0278 00703000
         LH    @08,LL(,@14)                                        0278 00704000
         AL    @08,DATALEN                                         0278 00705000
         STH   @08,LL(,@14)                                        0278 00706000
*   IF OC=OPNOMOVE THEN             /* IF IT IS A READ(DVAL) RECORD  */ 00707000
         CLI   OC(@14),254                                         0279 00708000
         BNE   @RF00279                                            0279 00709000
*     RETURN CODE(ZERO);            /* THEN RETURN                   */ 00710000
         SLR   @15,@15                                             0280 00711000
         L     @14,@SA00002                                        0280 00712000
         LM    @00,@12,@SA00002+8                                  0280 00713000
         BR    @14                                                 0280 00714000
*   COMPRUSE=COMPRUSE+LL;           /* INCREMENT BLKNUSE             */ 00715000
@RF00279 L     @14,ECDACBLK(,ECDAPTR)                              0281 00716000
         L     @08,ECDACNXT(,ECDAPTR)                              0281 00717000
         LH    @06,LL(,@08)                                        0281 00718000
         L     @03,COMPRUSE(,@14)                                  0281 00719000
         ALR   @03,@06                                             0281 00720000
         ST    @03,COMPRUSE(,@14)                                  0281 00721000
*   ECDACPRE=ECDACNXT;              /* OTHER WISE UPATE PREVIOUS @   */ 00722000
         ST    @08,ECDACPRE(,ECDAPTR)                              0282 00723000
*   ECDACNXT=ECDACNXT+LL;           /* UPDATE @ OF NEXT (R2 HAS      */ 00724000
         ALR   @08,@06                                             0283 00725000
         ST    @08,ECDACNXT(,ECDAPTR)                              0283 00726000
*   RFY                                                            0284 00727000
*    (R2) UNRSTD;                   /* @ FROM MVCL)                  */ 00728000
*   RETURN CODE(ZERO);              /* RETURN RTCODE=0               */ 00729000
         SLR   @15,@15                                             0285 00730000
         L     @14,@SA00002                                        0285 00731000
         LM    @00,@12,@SA00002+8                                  0285 00732000
         BR    @14                                                 0285 00733000
*   END MOVERTN;                                                   0286 00734000
@EL00002 DS    0H                                                  0286 00735000
@EF00002 DS    0H                                                  0286 00736000
@ER00002 LM    @14,@12,@SA00002                                    0286 00737000
         BR    @14                                                 0286 00738000
*                                                                  0287 00739000
*/********************************************************************/ 00740000
*/*                                                                  */ 00741000
*/*     COMMAND SCAN ROUTINE                                         */ 00742000
*/*                                                                  */ 00743000
*/********************************************************************/ 00744000
*                                                                  0287 00745000
*CMDSCAN:                                                          0287 00746000
*   PROC;                                                          0287 00747000
CMDSCAN  STM   @14,@12,@SA00003                                    0287 00748000
*   TRIP=ZERO;                      /* ZERO OUT PASS COUNT           */ 00749000
         SLR   TRIP,TRIP                                           0288 00750000
*   COUNT=ZERO;                     /* ZERO CHARACTER COUNT          */ 00751000
         SLR   COUNT,COUNT                                         0289 00752000
*   SCANLIST=SCANLIST&&SCANLIST;    /* ZERO SCAN OUTPUT FIELD        */ 00753000
         XC    SCANLIST(17),SCANLIST                               0290 00754000
*   SCANPTR=ECDAIREC;               /* SET UP SCAN POINTER           */ 00755000
         L     @14,ECDAIREC(,ECDAPTR)                              0291 00756000
         ST    @14,SCANPTR                                         0291 00757000
*AGAIN:                                                            0292 00758000
*   TRIP=TRIP+ONE;                  /* KEEP NUMBER OF PASSES         */ 00759000
*                                                                  0292 00760000
AGAIN    AL    TRIP,@CF00033                                       0292 00761000
*   /*****************************************************************/ 00762000
*   /*                                                               */ 00763000
*   /* FIRST SKIP SEPERATORS (COMMA,TAB,BLANK)TO FIND START OF LABEL */ 00764000
*   /* OR COMMAND.                                                   */ 00765000
*   /*                                                               */ 00766000
*   /*****************************************************************/ 00767000
*                                                                  0293 00768000
*SKIP:                                                             0293 00769000
*   COUNT=COUNT+ONCE;               /* INCREMENT TO NEXT CHAR.       */ 00770000
SKIP     AL    COUNT,@CF00033                                      0293 00771000
*   IF COUNT>RLENGTH THEN           /* HAVE WE REACHED END OF        */ 00772000
         C     COUNT,RLENGTH                                       0294 00773000
         BH    @RT00294                                            0294 00774000
*     RETURN;                       /* RECORD--YES THEN RETURN       */ 00775000
*   CALL FINDPARM;                  /* CHECK FOR SEPERATORS          */ 00776000
         BAL   @14,FINDPARM                                        0296 00777000
*   IF COUNT>RLENGTH THEN           /* IF AT END OF BUFFER           */ 00778000
         C     COUNT,RLENGTH                                       0297 00779000
         BH    @RT00297                                            0297 00780000
*     RETURN;                       /* RETURN                        */ 00781000
*   COUNT=COUNT+ONCE;               /* SET FOR NEXT CHARACTER        */ 00782000
         LA    @14,1                                               0299 00783000
         ALR   COUNT,@14                                           0299 00784000
*   LENTH=ONE;                      /* KEEP TRACK OF LENGTH          */ 00785000
         ST    @14,LENTH                                           0300 00786000
*   IF ALPHA=OFF THEN               /* WAS FIRST CHAR ALPHABETIC?    */ 00787000
         TM    ALPHA,B'10000000'                                   0301 00788000
         BNZ   @RF00301                                            0301 00789000
*     DO;                           /* NO THEN CHECK FOR PERCENT     */ 00790000
*       CMDADD=ADDR(RECORD(COUNT-1));/* ADDR OF COMMAND              */ 00791000
         L     @14,SCANPTR                                         0303 00792000
         LA    @14,RECORD-2(COUNT,@14)                             0303 00793000
         ST    @14,CMDADD                                          0303 00794000
*       CALL FINDEND;               /* FIND END OF COMMAND           */ 00795000
         BAL   @14,FINDEND                                         0304 00796000
*       CMDLEN=LENTH;               /* LENGTH OF COMMAND NAME        */ 00797000
         L     @14,LENTH                                           0305 00798000
         ST    @14,CMDLEN                                          0305 00799000
*       IF COLONB=ON THEN           /* IF COLON AFTER NAME           */ 00800000
         TM    COLONB,B'00100000'                                  0306 00801000
         BNO   @RF00306                                            0306 00802000
*         DO;                       /*                               */ 00803000
*LABEND:                                                           0308 00804000
*           LENTH=ONE;              /* SET LENGTH TO TWO             */ 00805000
LABEND   LA    @14,1                                               0308 00806000
         ST    @14,LENTH                                           0308 00807000
*           COUNT=COUNT+ONE;        /* INCREMENT COUNT               */ 00808000
         ALR   COUNT,@14                                           0309 00809000
*           CALL FINDEND;           /* FIND END                      */ 00810000
         BAL   @14,FINDEND                                         0310 00811000
*           CMDLEN=CMDLEN+LENTH;    /* MODIFY LENGTH OF COMMAND      */ 00812000
         L     @14,CMDLEN                                          0311 00813000
         AL    @14,LENTH                                           0311 00814000
         ST    @14,CMDLEN                                          0311 00815000
*         END;                                                     0312 00816000
*TSOCMD:                                                           0313 00817000
*       TSODISG=ONS;                /* MUST BE A TSO COMMAND IN      */ 00818000
@RF00306 DS    0H                                                  0313 00819000
TSOCMD   OI    TSODISG,B'00100000'                                 0313 00820000
*       RETURN CODE(ZERO);          /* RETURN TO MAINLINE            */ 00821000
         SLR   @15,@15                                             0314 00822000
         L     @14,@SA00003                                        0314 00823000
         LM    @00,@12,@SA00003+8                                  0314 00824000
         BR    @14                                                 0314 00825000
*     END;                                                         0315 00826000
*                                                                  0315 00827000
*   /*****************************************************************/ 00828000
*   /*                                                               */ 00829000
*   /* AT THIS POINT FIRST CHARACTER WAS ALPHABETIC. NEXT CALL       */ 00830000
*   /* FINDEND ROUTINE TO SCAN TO THE NEXT SEPARATOR. THE REMAINING  */ 00831000
*   /* LOGIC WILL BE BASED ON WHETHER A COMMAND NAME IS FOUND OR     */ 00832000
*   /* WHETHER A LABEL IS FOUND.                                     */ 00833000
*   /*                                                               */ 00834000
*   /*****************************************************************/ 00835000
*                                                                  0316 00836000
*   CALL FINDEND;                   /* CALL FINDEND ROUTINE          */ 00837000
@RF00301 BAL   @14,FINDEND                                         0316 00838000
*   IF COLONB=OFF THEN              /* IS IT A LABEL(COLON)?         */ 00839000
         TM    COLONB,B'00100000'                                  0317 00840000
         BNZ   @RF00317                                            0317 00841000
*     DO;                           /* NO---CHECK IT AS A COMMAND    */ 00842000
*       CMDLEN=LENTH;               /* CMD NAME IS OK-PUT LENGTH     */ 00843000
         L     @14,LENTH                                           0319 00844000
         ST    @14,CMDLEN                                          0319 00845000
*       CMDADD=ADDR(RECORD(COUNT-LENTH+ONE));/* ADDR OF CMD NAME     */ 00846000
         LR    @08,COUNT                                           0320 00847000
         SLR   @08,@14                                             0320 00848000
         L     @06,SCANPTR                                         0320 00849000
         LA    @08,RECORD(@08,@06)                                 0320 00850000
         ST    @08,CMDADD                                          0320 00851000
*       IF LENTH>EIGHT|NOTALPNU=ONS THEN/* IF BAD SYNTAX,ASSUME TSO  */ 00852000
         C     @14,@CF00088                                        0321 00853000
         BH    @RT00321                                            0321 00854000
         TM    NOTALPNU,B'10000000'                                0321 00855000
         BO    @RT00321                                            0321 00856000
*         GOTO TSOCMD;              /* GO TO IT                      */ 00857000
*       RETURN;                     /* RETURN                        */ 00858000
@EL00003 DS    0H                                                  0323 00859000
@EF00003 DS    0H                                                  0323 00860000
@ER00003 LM    @14,@12,@SA00003                                    0323 00861000
         BR    @14                                                 0323 00862000
*     END;                                                         0324 00863000
*                                                                  0324 00864000
*   /*****************************************************************/ 00865000
*   /*                                                               */ 00866000
*   /* AT THIS POINT IT IS KNOWN THAT THE NAME ENDED WITH A COLON.   */ 00867000
*   /* THEREFORE ASSUME IT IS A LABEL. IF A LABEL HAS BEEN FOUND     */ 00868000
*   /* PREVIOUSLY THEN TREAT IT AS AN INVLAID COMMAND. ALSO VALIDITY */ 00869000
*   /* CHECK THE LABEL FOR CORRECT LENGTH IF EVERYTHING IS OK THEN   */ 00870000
*   /* UPDATE THE LABEL INFORMATION IN THE SCAN OUTPUT FIELDS AND    */ 00871000
*   /* THEN CHECK FOR A COMMAND NAME.                                */ 00872000
*   /*                                                               */ 00873000
*   /*****************************************************************/ 00874000
*                                                                  0325 00875000
*   IF TRIP=TWO|LENTH>EIGHT|NOTALPNU=ONS THEN/* INVALID LABEL OR CMD */ 00876000
@RF00317 C     TRIP,@CF00074                                       0325 00877000
         BE    @RT00325                                            0325 00878000
         L     @14,LENTH                                           0325 00879000
         C     @14,@CF00088                                        0325 00880000
         BH    @RT00325                                            0325 00881000
         TM    NOTALPNU,B'10000000'                                0325 00882000
         BNO   @RF00325                                            0325 00883000
@RT00325 DS    0H                                                  0326 00884000
*     DO;                           /* TREAT AS TSO                  */ 00885000
*       CMDLEN=LENTH+ONE;           /* COMMAND LENGTH                */ 00886000
         LA    @14,1                                               0327 00887000
         AL    @14,LENTH                                           0327 00888000
         ST    @14,CMDLEN                                          0327 00889000
*       CMDADD=ADDR(RECORD(COUNT-CMDLEN+ONE));/* POINT TO BAD COMMAND*/ 00890000
         LCR   @14,@14                                             0328 00891000
         ALR   @14,COUNT                                           0328 00892000
         L     @08,SCANPTR                                         0328 00893000
         LA    @14,RECORD(@14,@08)                                 0328 00894000
         ST    @14,CMDADD                                          0328 00895000
*       GOTO LABEND;                /* PROCESS AS TSO                */ 00896000
         B     LABEND                                              0329 00897000
*     END;                                                         0330 00898000
*   LABLLEN=LENTH;                  /* PUT LENGTH IN OUTPUT FIELD    */ 00899000
@RF00325 L     @14,LENTH                                           0331 00900000
         ST    @14,LABLLEN                                         0331 00901000
*   LABLADD=ADDR(RECORD(COUNT-LENTH));/* ADDR OF LABEL               */ 00902000
         LCR   @14,@14                                             0332 00903000
         ALR   @14,COUNT                                           0332 00904000
         L     @06,SCANPTR                                         0332 00905000
         LA    @14,RECORD-1(@14,@06)                               0332 00906000
         ST    @14,LABLADD                                         0332 00907000
*   GOTO AGAIN;                     /* SCAN MORE                     */ 00908000
         B     AGAIN                                               0333 00909000
*   END CMDSCAN;                                                   0334 00910000
         B     @EL00003                                            0334 00911000
*                                                                  0335 00912000
*/********************************************************************/ 00913000
*/*                                                                  */ 00914000
*/*     CHARACTER CHECK ROUTINE                                      */ 00915000
*/*                                                                  */ 00916000
*/********************************************************************/ 00917000
*                                                                  0335 00918000
*CHARCHK:                                                          0335 00919000
*   PROC;                                                          0335 00920000
*                                                                  0335 00921000
CHARCHK  STM   @14,@12,12(@13)                                     0335 00922000
*   /*****************************************************************/ 00923000
*   /*                                                               */ 00924000
*   /* THIS ROUTINE WILL DETERMINE WHETHER THE CHARACTER IS          */ 00925000
*   /* ALPHABETIC,NUMERIC,COLON,PRECENT SIGN,AMPERSAND,SEPARATOR     */ 00926000
*   /* (THIS ROUTINE REWRITTEN - - - - - - - - - - - - - - -@ZM30993)*/ 00927000
*   /*                                                               */ 00928000
*   /*****************************************************************/ 00929000
*                                                                  0336 00930000
*   SCANBYTE=ZERO;                  /* ZERO OUT WORK BYTE            */ 00931000
         SLR   @14,@14                                             0336 00932000
         STCM  @14,3,SCANBYTE                                      0336 00933000
*   IF RECORD(COUNT)^<A&RECORD(COUNT)^>I|RECORD(COUNT)^<J&RECORD(COUNT) 00934000
*       ^>R|RECORD(COUNT)^<S&RECORD(COUNT)^>Z THEN                 0337 00935000
         L     @14,SCANPTR                                         0337 00936000
         LR    @08,@14                                             0337 00937000
         ALR   @08,COUNT                                           0337 00938000
         CLI   RECORD-1(@08),C'A'                                  0337 00939000
         BL    @GL00006                                            0337 00940000
         ALR   @14,COUNT                                           0337 00941000
         CLI   RECORD-1(@14),C'I'                                  0337 00942000
         BNH   @RT00337                                            0337 00943000
@GL00006 L     @14,SCANPTR                                         0337 00944000
         LR    @08,@14                                             0337 00945000
         ALR   @08,COUNT                                           0337 00946000
         CLI   RECORD-1(@08),C'J'                                  0337 00947000
         BL    @GL00005                                            0337 00948000
         ALR   @14,COUNT                                           0337 00949000
         CLI   RECORD-1(@14),C'R'                                  0337 00950000
         BNH   @RT00337                                            0337 00951000
@GL00005 L     @14,SCANPTR                                         0337 00952000
         LR    @08,@14                                             0337 00953000
         ALR   @08,COUNT                                           0337 00954000
         CLI   RECORD-1(@08),C'S'                                  0337 00955000
         BL    @RF00337                                            0337 00956000
         ALR   @14,COUNT                                           0337 00957000
         CLI   RECORD-1(@14),C'Z'                                  0337 00958000
         BH    @RF00337                                            0337 00959000
@RT00337 DS    0H                                                  0338 00960000
*     DO;                                                          0338 00961000
*       ALPHA=ONS;                                                 0339 00962000
         OI    ALPHA,B'10000000'                                   0339 00963000
*       RETURN;                                                    0340 00964000
@EL00004 DS    0H                                                  0340 00965000
@EF00004 DS    0H                                                  0340 00966000
@ER00004 LM    @14,@12,12(@13)                                     0340 00967000
         BR    @14                                                 0340 00968000
*     END;                                                         0341 00969000
*   IF RECORD(COUNT)^<FOXZERO&RECORD(COUNT)^>FOXNINE THEN          0342 00970000
@RF00337 L     @14,SCANPTR                                         0342 00971000
         LR    @08,@14                                             0342 00972000
         ALR   @08,COUNT                                           0342 00973000
         CLI   RECORD-1(@08),C'0'                                  0342 00974000
         BL    @RF00342                                            0342 00975000
         ALR   @14,COUNT                                           0342 00976000
         CLI   RECORD-1(@14),C'9'                                  0342 00977000
         BH    @RF00342                                            0342 00978000
*     DO;                                                          0343 00979000
*       NUMERIC=ONS;                                               0344 00980000
         OI    NUMERIC,B'01000000'                                 0344 00981000
*       RETURN;                                                    0345 00982000
         B     @EL00004                                            0345 00983000
*     END;                                                         0346 00984000
*   NALPHNUM=ONS;                   /* INDICATE NON-ALPHANUMERIC     */ 00985000
@RF00342 OI    NALPHNUM,B'00000001'                                0347 00986000
*   IF RECORD(COUNT)=BLANK|RECORD(COUNT)=COMMA|RECORD(COUNT)=TAB THEN   00987000
         L     @14,SCANPTR                                         0348 00988000
         LR    @08,@14                                             0348 00989000
         ALR   @08,COUNT                                           0348 00990000
         CLI   RECORD-1(@08),C' '                                  0348 00991000
         BE    @RT00348                                            0348 00992000
         LR    @08,@14                                             0348 00993000
         ALR   @08,COUNT                                           0348 00994000
         CLI   RECORD-1(@08),C','                                  0348 00995000
         BE    @RT00348                                            0348 00996000
         SLR   @08,@08                                             0348 00997000
         IC    @08,RECORD-1(COUNT,@14)                             0348 00998000
         C     @08,@CF00371                                        0348 00999000
         BNE   @RF00348                                            0348 01000000
@RT00348 DS    0H                                                  0349 01001000
*     DO;                                                          0349 01002000
*       SEPAR=ONS;                                                 0350 01003000
         OI    SEPAR,B'00000100'                                   0350 01004000
*       RETURN;                                                    0351 01005000
         B     @EL00004                                            0351 01006000
*     END;                                                         0352 01007000
*   IF RECORD(COUNT)=AMPER THEN                                    0353 01008000
@RF00348 L     @14,SCANPTR                                         0353 01009000
         ALR   @14,COUNT                                           0353 01010000
         CLI   RECORD-1(@14),C'&&'                                 0353 01011000
         BNE   @RF00353                                            0353 01012000
*     AMPERSND=ONS;                                                0354 01013000
         OI    AMPERSND,B'00001000'                                0354 01014000
*   ELSE                                                           0355 01015000
*     IF RECORD(COUNT)=OPN THEN                                    0355 01016000
         B     @RC00353                                            0355 01017000
@RF00353 L     @14,SCANPTR                                         0355 01018000
         ALR   @14,COUNT                                           0355 01019000
         CLI   RECORD-1(@14),C'('                                  0355 01020000
         BNE   @RF00355                                            0355 01021000
*       OPAREN=ONS;                                                0356 01022000
         OI    OPAREN,B'10000000'                                  0356 01023000
*     ELSE                                                         0357 01024000
*       IF RECORD(COUNT)=CLSE THEN                                 0357 01025000
         B     @RC00355                                            0357 01026000
@RF00355 L     @14,SCANPTR                                         0357 01027000
         ALR   @14,COUNT                                           0357 01028000
         CLI   RECORD-1(@14),C')'                                  0357 01029000
         BNE   @RF00357                                            0357 01030000
*         CPAREN=ONS;                                              0358 01031000
         OI    CPAREN,B'01000000'                                  0358 01032000
*       ELSE                                                       0359 01033000
*         IF RECORD(COUNT)=COLON THEN                              0359 01034000
         B     @RC00357                                            0359 01035000
@RF00357 L     @14,SCANPTR                                         0359 01036000
         ALR   @14,COUNT                                           0359 01037000
         CLI   RECORD-1(@14),C':'                                  0359 01038000
         BNE   @RF00359                                            0359 01039000
*           COLONB=ONS;                                            0360 01040000
         OI    COLONB,B'00100000'                                  0360 01041000
*         ELSE                                                     0361 01042000
*           IF RECORD(COUNT)=PERCENT THEN                          0361 01043000
         B     @RC00359                                            0361 01044000
@RF00359 L     @14,SCANPTR                                         0361 01045000
         ALR   @14,COUNT                                           0361 01046000
         CLI   RECORD-1(@14),C'%'                                  0361 01047000
         BNE   @RF00361                                            0361 01048000
*             PERCENTB=ONS;                                        0362 01049000
         OI    PERCENTB,B'00010000'                                0362 01050000
*           ELSE                                                   0363 01051000
*             IF COUNT+ONE^>RLENGTH THEN                           0363 01052000
         B     @RC00361                                            0363 01053000
@RF00361 LA    @14,1                                               0363 01054000
         ALR   @14,COUNT                                           0363 01055000
         C     @14,RLENGTH                                         0363 01056000
         BH    @RF00363                                            0363 01057000
*               IF RECORD(COUNT:COUNT+ONE)=SLASHAST THEN           0364 01058000
         L     @14,SCANPTR                                         0364 01059000
         ALR   @14,COUNT                                           0364 01060000
         CLC   RECORD-1(2,@14),@CC00455                            0364 01061000
         BNE   @RF00364                                            0364 01062000
*                 SLASH=ONS;                                       0365 01063000
         OI    SLASH,B'00000010'                                   0365 01064000
*   RETURN;                         /* RETURN TO CALLER              */ 01065000
         B     @EL00004                                            0366 01066000
*   END CHARCHK;                                                   0367 01067000
         B     @EL00004                                            0367 01068000
*                                                                  0368 01069000
*/********************************************************************/ 01070000
*/*                                                                  */ 01071000
*/*     SEPERATOR SCAN ROUTINE                                       */ 01072000
*/*                                                                  */ 01073000
*/********************************************************************/ 01074000
*                                                                  0368 01075000
*FINDEND:                                                          0368 01076000
*   PROC;                                                          0368 01077000
*                                                                  0368 01078000
FINDEND  STM   @14,@01,@SA00005                                    0368 01079000
         STM   @03,@12,@SA00005+16                                 0368 01080000
*   /*****************************************************************/ 01081000
*   /*                                                               */ 01082000
*   /* THIS ROUTINE WILL SCAN TO THE NEXT SEPARATOR                  */ 01083000
*   /*                                                               */ 01084000
*   /*****************************************************************/ 01085000
*                                                                  0369 01086000
*   ENDWORD=ZERO;                   /* ZERO OUT WORK BYTE            */ 01087000
         MVI   ENDWORD,X'00'                                       0369 01088000
*   IF AMPERSND=ONS THEN            /* SAVE INDICATIONS OF WHETHER   */ 01089000
         TM    AMPERSND,B'00001000'                                0370 01090000
         BNO   @RF00370                                            0370 01091000
*     WASAMPER=ONS;                 /* FIRST CHARACTER WAS AN        */ 01092000
         OI    WASAMPER,B'00100000'                                0371 01093000
*   ELSE                                                           0372 01094000
*     IF PERCENTB=ONS THEN          /*                       @ZM30993*/ 01095000
         B     @RC00370                                            0372 01096000
@RF00370 TM    PERCENTB,B'00010000'                                0372 01097000
         BNO   @RF00372                                            0372 01098000
*       WASPRCNT=ONS;               /* AMPERSAND OR A PERCENT SIGN   */ 01099000
         OI    WASPRCNT,B'01000000'                                0373 01100000
*NEXT:                                                             0374 01101000
*   IF COUNT>RLENGTH THEN           /* THE INDEX---IF WE ARE AT      */ 01102000
@RF00372 DS    0H                                                  0374 01103000
@RC00370 DS    0H                                                  0374 01104000
NEXT     C     COUNT,RLENGTH                                       0374 01105000
         BNH   @RF00374                                            0374 01106000
*     DO;                           /* THE END OF THE RECORD THEN    */ 01107000
*       COUNT=COUNT-ONCE;           /* RETURN---ELSE UP LENGTH AND   */ 01108000
         BCTR  COUNT,0                                             0376 01109000
*       RETURN;                     /* GO CHECK NEXT CHARACTER       */ 01110000
@EL00005 DS    0H                                                  0377 01111000
@EF00005 DS    0H                                                  0377 01112000
@ER00005 LM    @14,@01,@SA00005                                    0377 01113000
         LM    @03,@12,@SA00005+16                                 0377 01114000
         BR    @14                                                 0377 01115000
*     END;                                                         0378 01116000
*   CALL CHARCHK;                   /* CALL CHARCHK ROUTINE          */ 01117000
@RF00374 BAL   @14,CHARCHK                                         0379 01118000
*   IF COLONB=ONS|SEPAR=ONS|SLASH=ONS THEN/* HAS THE END BEEN FOUND? */ 01119000
         TM    COLONB,B'00100110'                                  0380 01120000
         BZ    @RF00380                                            0380 01121000
*     DO;                           /* YES                           */ 01122000
*       IF COLONB=OFF THEN          /* IF IT WAS COMMENT OR A        */ 01123000
         TM    COLONB,B'00100000'                                  0382 01124000
         BNZ   @RF00382                                            0382 01125000
*         COUNT=COUNT-ONCE;         /* SEPARATOR THEN THE CHAR.      */ 01126000
         BCTR  COUNT,0                                             0383 01127000
*       RETURN;                     /* INDEX HAS TO BE BACKED UP     */ 01128000
         B     @EL00005                                            0384 01129000
*     END;                          /* RETURN TO CALLER              */ 01130000
*   IF OC=OPNINE THEN               /* IF CONTROL COMMAND            */ 01131000
@RF00380 L     @14,ECDACNXT(,ECDAPTR)                              0386 01132000
         CLI   OC(@14),9                                           0386 01133000
         BNE   @RF00386                                            0386 01134000
*     IF OPAREN=ONS|CPAREN=ONS THEN /* A CLOSE OR OPEN PAREN         */ 01135000
         TM    OPAREN,B'11000000'                                  0387 01136000
         BZ    @RF00387                                            0387 01137000
*       DO;                         /* PROCESS                       */ 01138000
*         COUNT=COUNT-ONE;          /* DECREMENT COUNT               */ 01139000
         BCTR  COUNT,0                                             0389 01140000
*         RETURN;                   /* RETURN                        */ 01141000
         B     @EL00005                                            0390 01142000
*       END;                        /* END                           */ 01143000
*   LENTH=LENTH+ONCE;               /* LENGTH                        */ 01144000
@RF00387 DS    0H                                                  0392 01145000
@RF00386 LA    @14,1                                               0392 01146000
         AL    @14,LENTH                                           0392 01147000
         ST    @14,LENTH                                           0392 01148000
*   IF NALPHNUM=ONS THEN            /* INDICATE THERE WAS A NON-     */ 01149000
         TM    NALPHNUM,B'00000001'                                0393 01150000
         BNO   @RF00393                                            0393 01151000
*     NOTALPNU=ONS;                 /* ALPHANUMERIC                  */ 01152000
         OI    NOTALPNU,B'10000000'                                0394 01153000
*   COUNT=COUNT+ONCE;               /* IF END NOT FOUND THEN UP      */ 01154000
@RF00393 AL    COUNT,@CF00033                                      0395 01155000
*   GOTO NEXT;                      /* CHECK NEXT                    */ 01156000
         B     NEXT                                                0396 01157000
*   END FINDEND;                                                   0397 01158000
         B     @EL00005                                            0397 01159000
*                                                                  0398 01160000
*/********************************************************************/ 01161000
*/*                                                                  */ 01162000
*/*     COMMENT  ROUTINE                                             */ 01163000
*/*                                                                  */ 01164000
*/********************************************************************/ 01165000
*                                                                  0398 01166000
*COMMENTS:                                                         0398 01167000
*   PROC;                                                          0398 01168000
*                                                                  0398 01169000
COMMENTS STM   @14,@01,12(@13)                                     0398 01170000
         STM   @03,@12,32(@13)                                     0398 01171000
*   /*****************************************************************/ 01172000
*   /*                                                               */ 01173000
*   /* WHEN A COMMENT HAS BEEN FOUND BY THE MAIN SCAN ROUTINE THIS   */ 01174000
*   /* SUB-ROUTINE WILL SCAN TO THE END OF THE COMMENT OR TO THE END */ 01175000
*   /* OF THE RECORD---WHICH EVER OCCURS FIRST.                      */ 01176000
*   /*                                                               */ 01177000
*   /*****************************************************************/ 01178000
*                                                                  0399 01179000
*COMSCN:                                                           0399 01180000
*   COUNT=COUNT+ONCE;               /* INCREMENT TO NEXT CHARACTER   */ 01181000
COMSCN   LA    @14,1                                               0399 01182000
         ALR   COUNT,@14                                           0399 01183000
*   IF COUNT=RLENGTH THEN           /* REACH END OF INPUT?           */ 01184000
         C     COUNT,RLENGTH                                       0400 01185000
         BNE   @RF00400                                            0400 01186000
*     DO;                           /* YES-THEN RETURN---FIRST       */ 01187000
*       COUNT=COUNT+ONCE;           /* CHARACHER THEN SET COUNT      */ 01188000
         ALR   COUNT,@14                                           0402 01189000
*       RETURN;                     /* GREATER THAN RECLEN SO SCAN   */ 01190000
@EL00006 DS    0H                                                  0403 01191000
@EF00006 DS    0H                                                  0403 01192000
@ER00006 LM    @14,@01,12(@13)                                     0403 01193000
         LM    @03,@12,32(@13)                                     0403 01194000
         BR    @14                                                 0403 01195000
*     END;                          /* WILL KNOW WE REACHED END      */ 01196000
*   IF RECORD(COUNT:COUNT+ONE)=ASTSLASH THEN/* END OF COMMENT?       */ 01197000
@RF00400 L     @14,SCANPTR                                         0405 01198000
         ALR   @14,COUNT                                           0405 01199000
         CLC   RECORD-1(2,@14),@CC00457                            0405 01200000
         BNE   @RF00405                                            0405 01201000
*     DO;                           /* YES---THEN SET COUNT TO END   */ 01202000
*       COUNT=COUNT+TWO;            /* OF COMMENT AND RETURN         */ 01203000
         AL    COUNT,@CF00074                                      0407 01204000
*       RETURN;                     /* RETURN                        */ 01205000
         B     @EL00006                                            0408 01206000
*     END;                                                         0409 01207000
*   GOTO COMSCN;                    /* SCAN FURTHER                  */ 01208000
         B     COMSCN                                              0410 01209000
*   END COMMENTS;                   /* END OF COMMENT ROUTINE        */ 01210000
*                                                                  0412 01211000
*/********************************************************************/ 01212000
*/*                                                                  */ 01213000
*/*   PARAMETER LOCATE ROUTINE                                       */ 01214000
*/*                                                                  */ 01215000
*/********************************************************************/ 01216000
*                                                                  0412 01217000
*FINDPARM:                                                         0412 01218000
*   PROC;                                                          0412 01219000
FINDPARM STM   @14,@01,@SA00007                                    0412 01220000
         STM   @04,@12,@SA00007+16                                 0412 01221000
*CALLCHAR:                                                         0413 01222000
*   CALL CHARCHK;                   /* CALL CHARACTER CHECK ROUTINE  */ 01223000
CALLCHAR BAL   @14,CHARCHK                                         0413 01224000
*   IF SEPAR=ON THEN                /* SEPARATOR FOUND?              */ 01225000
         TM    SEPAR,B'00000100'                                   0414 01226000
         BNO   @RF00414                                            0414 01227000
*     DO;                           /* YES.                          */ 01228000
*       COUNT=COUNT+ONE;            /* INCREMENT TO NEXT CHARACTER.  */ 01229000
         AL    COUNT,@CF00033                                      0416 01230000
*       IF COUNT>RLENGTH THEN       /* AT END OF BUFFER?             */ 01231000
         C     COUNT,RLENGTH                                       0417 01232000
         BH    @RT00417                                            0417 01233000
*         GOTO LEAVE;               /* YES--RETURN                   */ 01234000
*       GOTO CALLCHAR;              /* NO--CHECK NEXT CHARACTER.     */ 01235000
         B     CALLCHAR                                            0419 01236000
*     END;                                                         0420 01237000
*   IF SLASH=ON THEN                /* COMMENT FOUND?                */ 01238000
@RF00414 TM    SLASH,B'00000010'                                   0421 01239000
         BNO   @RF00421                                            0421 01240000
*     DO;                           /* YES                           */ 01241000
*       CALL COMMENTS;              /* CALL COMMENT ROUTINE          */ 01242000
         BAL   @14,COMMENTS                                        0423 01243000
*       IF COUNT>RLENGTH THEN       /* AT END OF BUFFER ?            */ 01244000
         C     COUNT,RLENGTH                                       0424 01245000
         BH    @RT00424                                            0424 01246000
*         GOTO LEAVE;               /* YES--RETURN                   */ 01247000
*       GOTO CALLCHAR;              /* GO CHECK NEXT CHARACTER       */ 01248000
         B     CALLCHAR                                            0426 01249000
*     END;                                                         0427 01250000
*LEAVE:                                                            0428 01251000
*   LINCOUNT=COUNT;                 /* CHAR INDEX AT END OF SCAN     */ 01252000
@RF00421 DS    0H                                                  0428 01253000
LEAVE    LR    LINCOUNT,COUNT                                      0428 01254000
*   IF COUNT>RLENGTH THEN           /* IF AT END OF BUFFER           */ 01255000
         C     COUNT,RLENGTH                                       0429 01256000
         BNH   @RF00429                                            0429 01257000
*     SEPS=ONS;                     /* ALL SEPARATORS                */ 01258000
         OI    SEPS,B'10000000'                                    0430 01259000
*   ELSE                            /* ELSE                          */ 01260000
*     IF OC=OPNINE THEN             /* CONTROL COMMAND ?             */ 01261000
         B     @RC00429                                            0431 01262000
@RF00429 L     @14,ECDACNXT(,ECDAPTR)                              0431 01263000
         CLI   OC(@14),9                                           0431 01264000
         BNE   @RF00431                                            0431 01265000
*       DO;                         /* PROCESS                       */ 01266000
*         LENTH=ZERO;               /* SET LENTH TO ONE              */ 01267000
         SLR   @14,@14                                             0433 01268000
         ST    @14,LENTH                                           0433 01269000
*         IF OPAREN=ONS|CPAREN=ONS THEN/* OPEN OR CLOSE PAREN        */ 01270000
         TM    OPAREN,B'11000000'                                  0434 01271000
         BNZ   @RT00434                                            0434 01272000
*           RETURN;                 /* EXIT                          */ 01273000
*         CALL FINDEND;             /* FIND END OF STRING            */ 01274000
         BAL   @14,FINDEND                                         0436 01275000
*       END;                                                       0437 01276000
*   RETURN;                         /* RETURN                        */ 01277000
@EL00007 DS    0H                                                  0438 01278000
@EF00007 DS    0H                                                  0438 01279000
@ER00007 LM    @14,@01,@SA00007                                    0438 01280000
         LM    @04,@12,@SA00007+16                                 0438 01281000
         BR    @14                                                 0438 01282000
*   END FINDPARM;                                                  0439 01283000
         B     @EL00007                                            0439 01284000
*                                                                  0440 01285000
*/********************************************************************/ 01286000
*/*                                                                  */ 01287000
*/*     IF  ROUTINE                                                  */ 01288000
*/*                                                                  */ 01289000
*/********************************************************************/ 01290000
*                                                                  0440 01291000
*IFCMD:                                                            0440 01292000
*   PROC;                                                          0440 01293000
IFCMD    STM   @14,@03,@SA00008                                    0440 01294000
         STM   @05,@12,@SA00008+24                                 0440 01295000
*   OC=TWO;                         /* INITIALIZE OP CODE TO 2       */ 01296000
         L     @14,ECDACNXT(,ECDAPTR)                              0441 01297000
         MVI   OC(@14),X'02'                                       0441 01298000
*   LINEPTR=ECDAIREC+FOUR;          /* INITIALIZE WORK POINTER       */ 01299000
         LA    LINEPTR,4                                           0442 01300000
         AL    LINEPTR,ECDAIREC(,ECDAPTR)                          0442 01301000
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* PAST CMD NAME AND LOOK FOR    */ 01302000
*       -LINEPTR;                   /* PARAMETERS(FIRST NON-         */ 01303000
         L     LINCOUNT,CMDADD                                     0443 01304000
         AL    LINCOUNT,CMDLEN                                     0443 01305000
         AL    LINCOUNT,@CF00033                                   0443 01306000
         SLR   LINCOUNT,LINEPTR                                    0443 01307000
*SCANIF:                                                           0444 01308000
*   IF LINCOUNT>RLENGTH THEN        /* SEPARATOR.LINCOUNT IS USED    */ 01309000
SCANIF   C     LINCOUNT,RLENGTH                                    0444 01310000
         BNH   @RF00444                                            0444 01311000
*     DO;                           /* FOR STOPPING AT END OF        */ 01312000
*BADIF:                                                            0446 01313000
*       EXMSGID=M533;               /* MESSAGE ID                    */ 01314000
BADIF    MVC   EXMSGID(4),@CC00493                                 0446 01315000
*       STMT=ONS;                   /* STATEMENT NUMBERS REQUESTED   */ 01316000
         OI    STMT,B'10000000'                                    0447 01317000
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */ 01318000
         BAL   @14,MSGRTN                                          0448 01319000
*       RCODE=ZERO;                 /* RECORD. IF NO PARAMETERS      */ 01320000
         SLR   RCODE,RCODE                                         0449 01321000
*       NOTEXEC=ON;                 /* THEN ISSUE A MESSAGE,SET      */ 01322000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0450 01323000
*EXIT1:                                                            0451 01324000
*       RETURN CODE(RCODE) TO SPCLEXIT;/* PROC NOT EXECUTABLE AND    */ 01325000
EXIT1    LA    @14,SPCLEXIT                                        0451 01326000
         LR    @15,RCODE                                           0451 01327000
         LM    @00,@03,@SA00008+8                                  0451 01328000
         LM    @05,@12,@SA00008+24                                 0451 01329000
         BR    @14                                                 0451 01330000
*     END;                          /* RETURN                        */ 01331000
*   COUNT=LINCOUNT;                 /* CHARACTER INDEX               */ 01332000
@RF00444 LR    COUNT,LINCOUNT                                      0453 01333000
*   CALL FINDPARM;                  /* FINDPARM ROUTINE              */ 01334000
         BAL   @14,FINDPARM                                        0454 01335000
*   IF LINCOUNT>RLENGTH THEN        /* PARAMETERS FOUND?             */ 01336000
         C     LINCOUNT,RLENGTH                                    0455 01337000
         BH    @RT00455                                            0455 01338000
*     GOTO BADIF;                   /* NO -- INVALID IF COMMAND.     */ 01339000
*   O2O2=LINCOUNT+SEVEN-ONE;        /* WHEN FIRST PARAMETER IS       */ 01340000
         L     @14,ECDACNXT(,ECDAPTR)                              0457 01341000
         LR    @06,LINCOUNT                                        0457 01342000
         SL    @06,@CF00838                                        0457 01343000
         STH   @06,O2O2(,@14)                                      0457 01344000
*   LL=ELEVEN;                      /* FOUND PUT OFFSET IN RECORD    */ 01345000
         MVC   LL(2,@14),@CH00392                                  0458 01346000
*   OO=CMDADD-LINEPTR+SEVEN;        /* SET LL TO 11 & PUT IN         */ 01347000
         L     @06,CMDADD                                          0459 01348000
         SLR   @06,LINEPTR                                         0459 01349000
         AL    @06,@CF00149                                        0459 01350000
         STH   @06,OO(,@14)                                        0459 01351000
*   FALSEP=ZERO;                    /* OFFSET TO COMMAND NAME        */ 01352000
         SLR   @06,@06                                             0460 01353000
         STCM  @06,15,FALSEP(@14)                                  0460 01354000
*THNAGN:                                                           0461 01355000
*   IF LINCOUNT+THREE>RLENGTH THEN  /* BAD IF --NO THEN              */ 01356000
THNAGN   LA    @14,3                                               0461 01357000
         ALR   @14,LINCOUNT                                        0461 01358000
         C     @14,RLENGTH                                         0461 01359000
         BH    @RT00461                                            0461 01360000
*     GOTO BADIF;                   /* LEAVE                         */ 01361000
*   IF LINE(LINCOUNT:LINCOUNT+ONE)=SLASHAST THEN/* COMMENT?          */ 01362000
         LR    @14,LINEPTR                                         0463 01363000
         ALR   @14,LINCOUNT                                        0463 01364000
         BCTR  @14,0                                               0463 01365000
         CLC   LINE(2,@14),@CC00455                                0463 01366000
         BNE   @RF00463                                            0463 01367000
*     DO;                           /* YES--                         */ 01368000
*       COUNT=LINCOUNT;             /* SET UP CHARACTER INDEX        */ 01369000
         LR    COUNT,LINCOUNT                                      0465 01370000
*       CALL COMMENTS;              /* CALL COMMENT ROUTINE          */ 01371000
         BAL   @14,COMMENTS                                        0466 01372000
*       LINCOUNT=COUNT;             /* INDEX PAST COMMENT            */ 01373000
         LR    LINCOUNT,COUNT                                      0467 01374000
*       GOTO THNAGN;                /* GO CHECK FOR THEN             */ 01375000
         B     THNAGN                                              0468 01376000
*     END;                                                         0469 01377000
*   IF LINE(LINCOUNT:LINCOUNT+THREE)^=/* NEXT LOCATE THE THEN WHICH  */ 01378000
*       THENS THEN                  /* MARKS END OF FIRST RECORD     */ 01379000
@RF00463 LR    @14,LINEPTR                                         0470 01380000
         ALR   @14,LINCOUNT                                        0470 01381000
         BCTR  @14,0                                               0470 01382000
         CLC   LINE(4,@14),@CC00398                                0470 01383000
         BE    @RF00470                                            0470 01384000
*     DO;                           /* TO BE SENT TO THE MOVE RTN    */ 01385000
*TRYAGN:                                                           0472 01386000
*       LINCOUNT=LINCOUNT+ONE;      /* OTHERWISE UPDATE CHAR COUNT   */ 01387000
TRYAGN   AL    LINCOUNT,@CF00033                                   0472 01388000
*       GOTO THNAGN;                /* THEN ISSUE A MESSAGE          */ 01389000
         B     THNAGN                                              0473 01390000
*     END;                          /* SET PROC NOT EXECUTABLE AND 0474 01391000
*                                      RETURN. WHEN THEN IS FOUND    */ 01392000
*   IF LINCOUNT+FOUR^>RLENGTH THEN  /* SEE IF NEXT CHARACTER IS      */ 01393000
@RF00470 LA    @14,4                                               0475 01394000
         ALR   @14,LINCOUNT                                        0475 01395000
         C     @14,RLENGTH                                         0475 01396000
         BH    @RF00475                                            0475 01397000
*     DO;                           /* A SEPERATOR IF NOT AT END OF  */ 01398000
*       COUNT=LINCOUNT+FOUR;        /* BUFFER.                       */ 01399000
         LR    COUNT,@14                                           0477 01400000
*       CALL CHARCHK;               /* CALL CHARACTER CHECK ROUTINE  */ 01401000
         BAL   @14,CHARCHK                                         0478 01402000
*       IF SEPAR=OFF&SLASH=OFF&OPAREN=OFF THEN/* COMMENT,SEPAR,(     */ 01403000
         TM    SEPAR,B'00000110'                                   0479 01404000
         BNZ   @RF00479                                            0479 01405000
         TM    OPAREN,B'10000000'                                  0479 01406000
         BNZ   @RF00479                                            0479 01407000
*         IF ALPHA=ONS|NUMERIC=ONS| /* LOOK FOR EMBEDDED..   @ZA20629*/ 01408000
*             CPAREN=ONS THEN       /* THEN IN VARIABLE NME  @ZA20629*/ 01409000
         TM    ALPHA,B'11000000'                                   0480 01410000
         BNZ   @RT00480                                            0480 01411000
         TM    CPAREN,B'01000000'                                  0480 01412000
         BO    @RT00480                                            0480 01413000
*           GOTO TRYAGN;            /* LOOK FOR A REAL THEN  @ZA20629*/ 01414000
*         ELSE                                                     0482 01415000
*           GOTO BADIF;             /* NO INVALID IF COMMAND @ZA20629*/ 01416000
         B     BADIF                                               0482 01417000
*     END;                                                         0483 01418000
@RF00479 DS    0H                                                  0484 01419000
*   COUNT=LINCOUNT-ONE;             /* RESET COUNT                   */ 01420000
@RF00475 LR    COUNT,LINCOUNT                                      0484 01421000
         BCTR  COUNT,0                                             0484 01422000
*   CALL CHARCHK;                   /* WHAT IS IT ?                  */ 01423000
         BAL   @14,CHARCHK                                         0485 01424000
*   IF SEPAR=OFF&CPAREN=OFF&LINE(COUNT-ONE:COUNT)^=ASTSLASH THEN   0486 01425000
         TM    SEPAR,B'00000100'                                   0486 01426000
         BNZ   @RF00486                                            0486 01427000
         TM    CPAREN,B'01000000'                                  0486 01428000
         BNZ   @RF00486                                            0486 01429000
         LR    @14,LINEPTR                                         0486 01430000
         ALR   @14,COUNT                                           0486 01431000
         BCTR  @14,0                                               0486 01432000
         BCTR  @14,0                                               0486 01433000
         CLC   LINE(2,@14),@CC00457                                0486 01434000
         BNE   @RT00486                                            0486 01435000
*     GOTO TRYAGN;                  /* TRY AGAIN                     */ 01436000
*   DATALEN=LINCOUNT+THREE;         /* COMPUTE LENGTH OF RECORD      */ 01437000
@RF00486 LA    @14,3                                               0488 01438000
         ALR   @14,LINCOUNT                                        0488 01439000
         ST    @14,DATALEN                                         0488 01440000
*   DATAADD=LINEPTR;                /* FOR MOVE RTN.AND GET ADDR     */ 01441000
         ST    LINEPTR,DATAADD                                     0489 01442000
*   CALL MOVERTN;                   /* OF DATA TO BE MOVED           */ 01443000
         BAL   @14,MOVERTN                                         0490 01444000
*   RCODE=R15;                      /* SAVE RETURN CODE OF MOVERTN   */ 01445000
         LR    RCODE,R15                                           0491 01446000
*   IF RCODE^=ZERO THEN             /* IF RCODE IS NON ZERO THEN     */ 01447000
         LTR   RCODE,RCODE                                         0492 01448000
         BNZ   @RT00492                                            0492 01449000
*     GOTO EXIT1;                   /* RETURN WITH THE RETURN CODE TO   01450000
*                                      SPECIAL EXIT                  */ 01451000
*   NEWSAVE=ECDACPRE;               /* SAVE ADDRESS OF IF STMT FOR 0494 01452000
*                                      FALSE PATH UPDATE             */ 01453000
*                                                                  0494 01454000
         L     @14,ECDACPRE(,ECDAPTR)                              0494 01455000
         ST    @14,NEWSAVE                                         0494 01456000
*   /*****************************************************************/ 01457000
*   /*                                                               */ 01458000
*   /* AT THIS POINT THE FIRST STORAGE RECORD HAS BEEN BUILT FOR THE */ 01459000
*   /* IF STATEMENT. NEXT WE WILL BUILD A STORAGE RECORD FOR THE     */ 01460000
*   /* OBJECT OF THE THEN. FIRST MAKE THE SECOND PART OF THE INPUT   */ 01461000
*   /* RECORD LOOK LIKE ANY OTHER RECORD(FIRST 4 BYTES CONTAINING THE*/ 01462000
*   /* LENGTH AND OFFSET OF THE RECORD) AND RE-INVOKE THE RECORD SCAN*/ 01463000
*   /* ROUTINE. WHEN CONTROL IS RETURNED THE RECORD WILL HAVE BEEN   */ 01464000
*   /* BUILT UNLESS AN ERROR HAS OCCURED.                            */ 01465000
*   /*                                                               */ 01466000
*   /*****************************************************************/ 01467000
*                                                                  0495 01468000
*   SAVEIREC=ECDAIREC;              /* SAVE IREC POINTER             */ 01469000
         L     SAVEIREC,ECDAIREC(,ECDAPTR)                         0495 01470000
*   ECDAIREC=ADDR(LINE(LINCOUNT));  /* UPDATE POINTER IN COMMON      */ 01471000
         LR    @14,LINEPTR                                         0496 01472000
         BCTR  @14,0                                               0496 01473000
         LA    @14,LINE(LINCOUNT,@14)                              0496 01474000
         ST    @14,ECDAIREC(,ECDAPTR)                              0496 01475000
*   ECDAIREC->OO=ECDAIREC-SAVEIREC; /* OFFSET BACK TO BEGIN BFR      */ 01476000
         LR    @06,@14                                             0497 01477000
         SLR   @06,SAVEIREC                                        0497 01478000
         STH   @06,OO(,@14)                                        0497 01479000
*   ECDAIREC->RECLEN=               /* DATA AREA. RECORD HEADER      */ 01480000
*       RECLEN-(LINCOUNT+FOUR-ONE); /* WILL OVERLAY THE THEN         */ 01481000
         LR    @06,LINCOUNT                                        0498 01482000
         SL    @06,@CF00839                                        0498 01483000
         LCR   @06,@06                                             0498 01484000
         L     @05,SCANPTR                                         0498 01485000
         AH    @06,RECLEN(,@05)                                    0498 01486000
         STH   @06,RECLEN(,@14)                                    0498 01487000
*   PARMS=PARMS&&PARMS;             /* BUILD IKJCT432 PARM LIST      */ 01488000
         XC    PARMS(12),PARMS                                     0499 01489000
*   PARM1=ECDAPTR;                  /* ZERO PARM TWO                 */ 01490000
         ST    ECDAPTR,PARM1                                       0500 01491000
*   RFY                                                            0501 01492000
*    (R1) RSTD;                     /* RESTRICT REG 1                */ 01493000
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */ 01494000
         LA    R1,PARMS                                            0502 01495000
*   CALL IKJCT432;                  /* CALL RECORD SCAN ROUTINE      */ 01496000
         L     @15,@CA00028                                        0503 01497000
         BALR  @14,@15                                             0503 01498000
*   RFY                                                            0504 01499000
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */ 01500000
*   RCODE=R15;                      /* IF RCODE IS GREATER THAN 8    */ 01501000
         LR    RCODE,R15                                           0505 01502000
*   IF RCODE^=ZERO THEN             /* THEN RETURN TO SPECIAL        */ 01503000
         LTR   RCODE,RCODE                                         0506 01504000
         BZ    @RF00506                                            0506 01505000
*     DO;                           /* EXIT                          */ 01506000
*       IF RCODE=FOUR THEN          /* UPDATE FALSE PATH PTR ON      */ 01507000
         C     RCODE,@CF00072                                      0508 01508000
         BNE   @RF00508                                            0508 01509000
*         NEWSAVE->FALSEP=ECDACNXT; /* END OF FILE                   */ 01510000
         L     @14,NEWSAVE                                         0509 01511000
         MVC   FALSEP(4,@14),ECDACNXT(ECDAPTR)                     0509 01512000
*       GOTO OUT;                                                  0510 01513000
         B     OUT                                                 0510 01514000
*     END;                                                         0511 01515000
*   IF RETFLAG2=ONS THEN            /* IF A DO LOOP MUST BE CLOSED   */ 01516000
@RF00506 TM    RETFLAG2,B'00100000'                                0512 01517000
         BNO   @RF00512                                            0512 01518000
*     DO;                           /* BEFORE CONTINUING THEN RETURN */ 01519000
*       RETFLAG=ONS;                /* PROPAGATING FLAGS             */ 01520000
         OI    RETFLAG(PARMPTR),B'00100000'                        0514 01521000
*       IF ENDFLAG2=ONS THEN        /* END FLAG                      */ 01522000
         TM    ENDFLAG2,B'10000000'                                0515 01523000
         BNO   @RF00515                                            0515 01524000
*         ENDFLAG=ONS;              /* ON                            */ 01525000
         OI    ENDFLAG(PARMPTR),B'10000000'                        0516 01526000
*       NEWSAVE->FALSEP=FALEND2;    /* UPDATE FALSE PATH TO END STMT */ 01527000
@RF00515 L     @14,FALEND2                                         0517 01528000
         L     @06,NEWSAVE                                         0517 01529000
         STCM  @14,15,FALSEP(@06)                                  0517 01530000
*       FALEND=FALEND2;             /* PROPAGATE FALSE PATH END      */ 01531000
         ST    @14,FALEND(,PARMPTR)                                0518 01532000
*       GOTO OUT;                   /* LEAVE                         */ 01533000
         B     OUT                                                 0519 01534000
*     END;                                                         0520 01535000
*                                                                  0520 01536000
*   /*****************************************************************/ 01537000
*   /*                                                               */ 01538000
*   /* AT THIS POINT THE ENTIRE IF COMMAND HAS BEEN PROCESSED. THE   */ 01539000
*   /* COMMON DATA AREA POINTERS HAVE BEEN UPDATED AND THE ONLY      */ 01540000
*   /* REQUIREMENT LEFT IS TO BUILD AN INTERNAL GOTO WHICH WILL BE   */ 01541000
*   /* NEEDED IN THE EVENT THE NEXT INPUT RECORD IS AN ELSE COMMAND. */ 01542000
*   /*                                                               */ 01543000
*   /*****************************************************************/ 01544000
*                                                                  0521 01545000
*   LL=ELEVEN;                      /* LENGTH OF INTERNAL GOTO       */ 01546000
@RF00512 L     @14,ECDACNXT(,ECDAPTR)                              0521 01547000
         MVC   LL(2,@14),@CH00392                                  0521 01548000
*   OO=SEVEN;                       /* 11 IS ALSO OFFSET FOR CMD     */ 01549000
         LA    @06,7                                               0522 01550000
         STH   @06,OO(,@14)                                        0522 01551000
*   O2O2=SEVEN;                     /* NAME AND PARM FIELD           */ 01552000
         STH   @06,O2O2(,@14)                                      0523 01553000
*   OC=GOCODE;                      /* PUT IN OP CODE                */ 01554000
         MVI   OC(@14),X'0F'                                       0524 01555000
*   DATAADD=ZERO;                   /* ZERO OUT MOVE PARM LIST       */ 01556000
         SLR   @14,@14                                             0525 01557000
         ST    @14,DATAADD                                         0525 01558000
*   DATALEN=ZERO;                   /* MOVE WILL NOT MOVE ANYTHING   */ 01559000
         ST    @14,DATALEN                                         0526 01560000
*   CALL MOVERTN;                   /* BUT WILL JUST UPDATE PTRS     */ 01561000
         BAL   @14,MOVERTN                                         0527 01562000
*   RCODE=R15;                      /* DID MOVE GO OK ?              */ 01563000
         LR    RCODE,R15                                           0528 01564000
*   IF RCODE^=ZERO THEN             /* NO--- THEN RETURN             */ 01565000
         LTR   RCODE,RCODE                                         0529 01566000
         BNZ   @RT00529                                            0529 01567000
*     GOTO EXIT1;                   /* LEAVE                         */ 01568000
*   ECDACPRE->FALSEP=ECDACNXT;      /* UPDATE INTERNAL GOTO ADDRESS  */ 01569000
         L     @14,ECDACPRE(,ECDAPTR)                              0531 01570000
         L     @06,ECDACNXT(,ECDAPTR)                              0531 01571000
         STCM  @06,15,FALSEP(@14)                                  0531 01572000
*   NEWSAVE->FALSEP=ECDACNXT;       /* UPDATE IF STMT FALSE PATH     */ 01573000
         L     @14,NEWSAVE                                         0532 01574000
         STCM  @06,15,FALSEP(@14)                                  0532 01575000
*   RCODE=ZERO;                     /* ZERO RETCODE                  */ 01576000
*                                                                  0533 01577000
         SLR   RCODE,RCODE                                         0533 01578000
*   /*****************************************************************/ 01579000
*   /*                                                               */ 01580000
*   /* GETALINE WILL BE USED IN ORDER TO ASSURE THAT FALSE PATH      */ 01581000
*   /* POINTERS ARE CORRECT FOR NESTED IF GROUPS                     */ 01582000
*   /*                                                               */ 01583000
*   /*****************************************************************/ 01584000
*                                                                  0534 01585000
*   NULINE=ONS;                     /* SET NULLINE TO FORCE ONE    0534 01586000
*                                      EXECUTION MINIMUM     @ZA05505*/ 01587000
         OI    NULINE,B'00001000'                                  0534 01588000
*   DO WHILE(NULINE=ONS);           /* SKIP TO NEXT COMMAND  @ZA05505*/ 01589000
         B     @DE00535                                            0535 01590000
@DL00535 DS    0H                                                  0536 01591000
*     NULINE=OFF;                   /* RESET NULL LINE SWITCH - IT 0536 01592000
*                                      WILL BE SET AGAIN IF RECORD 0536 01593000
*                                      READ IS A NULL LINE   @ZA05505*/ 01594000
         NI    NULINE,B'11110111'                                  0536 01595000
*     CALL GETALINE;                /* CALL GETALINE ROUTINE         */ 01596000
         BAL   @14,GETALINE                                        0537 01597000
*     RCODE=R15;                    /* SAVE RETURN CODE              */ 01598000
         LR    RCODE,R15                                           0538 01599000
*     IF RCODE^=ZERO THEN           /* RETURN CODE ZERO?             */ 01600000
         SLR   @14,@14                                             0539 01601000
         CR    RCODE,@14                                           0539 01602000
         BNE   @RT00539                                            0539 01603000
*       GOTO OUT;                   /* NO---RETURN                   */ 01604000
*     SAVENEXT=ECDACNXT;            /* SAVE NEXT RECORD ADDR         */ 01605000
         L     SAVENEXT,ECDACNXT(,ECDAPTR)                         0541 01606000
*     PARM1=ECDAPTR;                /* SET UP 432 PARM LIST          */ 01607000
         ST    ECDAPTR,PARM1                                       0542 01608000
*     PARM2=ZERO;                   /*                               */ 01609000
         ST    @14,PARM2                                           0543 01610000
*     IFFLAG2=ON;                   /* INDICATE IF TO ELSE CMD.      */ 01611000
         OI    IFFLAG2,B'01000000'                                 0544 01612000
*     RFY                                                          0545 01613000
*      (R1) RSTD;                   /* RESTRICT REG 1                */ 01614000
*     R1=ADDR(PARMS);               /* ADDR OF PARM LIST             */ 01615000
         LA    R1,PARMS                                            0546 01616000
*     CALL IKJCT432;                /* CALL 432                      */ 01617000
         L     @15,@CA00028                                        0547 01618000
         BALR  @14,@15                                             0547 01619000
*     RFY                                                          0548 01620000
*      (R1) UNRSTD;                 /* RELEASE                       */ 01621000
*     RCODE=R15;                    /* SAVE RETURN CODE              */ 01622000
         LR    RCODE,R15                                           0549 01623000
*     IF ELSFLAG2=OFF|RETFLAG2=ONS THEN/* PROPAGATE FLAG IF THE      */ 01624000
         TM    RETFLAG2,B'00100000'                                0550 01625000
         BNZ   @RT00550                                            0550 01626000
         TM    ELSFLAG2,B'00010000'                                0550 01627000
         BO    @RF00550                                            0550 01628000
@RT00550 DS    0H                                                  0551 01629000
*       DO;                         /* STMT WAS AN END STMT          */ 01630000
*         RETFLAG=ONS;              /* INDICATE A DO LOOP MUST BE    */ 01631000
         OI    RETFLAG(PARMPTR),B'00100000'                        0552 01632000
*         IF ENDFLAG2=ONS THEN                                     0553 01633000
         TM    ENDFLAG2,B'10000000'                                0553 01634000
         BNO   @RF00553                                            0553 01635000
*           ENDFLAG=ONS;            /* CLOSED                        */ 01636000
         OI    ENDFLAG(PARMPTR),B'10000000'                        0554 01637000
*         IF ELSFLAG2=ONS THEN      /* SET FALSE PATH END            */ 01638000
@RF00553 TM    ELSFLAG2,B'00010000'                                0555 01639000
         BNO   @RF00555                                            0555 01640000
*           FALEND=FALEND2;                                        0556 01641000
         L     @14,FALEND2                                         0556 01642000
         ST    @14,FALEND(,PARMPTR)                                0556 01643000
*         ELSE                      /* TO THE LOGICAL END            */ 01644000
*           FALEND=SAVENEXT;                                       0557 01645000
         B     @RC00555                                            0557 01646000
@RF00555 ST    SAVENEXT,FALEND(,PARMPTR)                           0557 01647000
*       END;                                                       0558 01648000
@RC00555 DS    0H                                                  0559 01649000
*   END;                            /*                       @ZA05505*/ 01650000
@RF00550 DS    0H                                                  0559 01651000
@DE00535 TM    NULINE,B'00001000'                                  0559 01652000
         BO    @DL00535                                            0559 01653000
*OUT:                                                              0560 01654000
*   RETURN CODE(RCODE) TO SPCLEXIT; /* RETURN TO SPECIAL EXIT        */ 01655000
OUT      LA    @14,SPCLEXIT                                        0560 01656000
         LR    @15,RCODE                                           0560 01657000
         LM    @00,@03,@SA00008+8                                  0560 01658000
         LM    @05,@12,@SA00008+24                                 0560 01659000
         BR    @14                                                 0560 01660000
*   END IFCMD;                                                     0561 01661000
*                                                                  0562 01662000
*/********************************************************************/ 01663000
*/*                                                                  */ 01664000
*/*     ELSE  ROUTINE                                                */ 01665000
*/*                                                                  */ 01666000
*/********************************************************************/ 01667000
*                                                                  0562 01668000
*ELSECMD:                                                          0562 01669000
*   PROC;                                                          0562 01670000
ELSECMD  STM   @14,@03,@SA00009                                    0562 01671000
         STM   @05,@12,@SA00009+24                                 0562 01672000
*   TRUESAV=ECDACPRE;               /* SAVE PTR TO PREVIOUS RECORD   */ 01673000
         L     TRUESAV,ECDACPRE(,ECDAPTR)                          0563 01674000
*   IF IFFLAG=OFF THEN              /* WAS IT AN IF COMMAND?         */ 01675000
         TM    IFFLAG(PARMPTR),B'01000000'                         0564 01676000
         BNZ   @RF00564                                            0564 01677000
*     DO;                           /* --IF NOT IT IS AN ERROR       */ 01678000
*       EXMSGID=M534;               /* MESSAGE ID                    */ 01679000
         MVC   EXMSGID(4),@CC00495                                 0566 01680000
*       MVAR(2)=ADDR(CELSE);        /* ELSE INSERT                   */ 01681000
         LA    @14,@CC00529                                        0567 01682000
         ST    @14,MVAR+4                                          0567 01683000
*       MVARLEN(2)=LENGTH(CELSE);   /* LENGTH                        */ 01684000
         MVI   MVARLEN+4,X'04'                                     0568 01685000
*       MVAR(3)=ADDR(CIF);          /* IF INSERT                     */ 01686000
         LA    @14,@CC00527                                        0569 01687000
         ST    @14,MVAR+8                                          0569 01688000
*       MVARLEN(3)=LENGTH(CIF);     /* LENGTH OF INSERT              */ 01689000
         MVI   MVARLEN+8,X'02'                                     0570 01690000
*       STMT=ONS;                   /* STATEMENT NUMBER REQUESTED    */ 01691000
         OI    STMT,B'10000000'                                    0571 01692000
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */ 01693000
         BAL   @14,MSGRTN                                          0572 01694000
*       RCODE=ZERO;                 /* ISSUE A MESSAGE TO USER       */ 01695000
         SLR   RCODE,RCODE                                         0573 01696000
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE AND   */ 01697000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0574 01698000
*BADELSE:                                                          0575 01699000
*       RETURN CODE(RCODE)          /* RETURN VIA THE SPECIAL EXIT   */ 01700000
*           TO SPCLEXIT;            /*                               */ 01701000
BADELSE  LA    @14,SPCLEXIT                                        0575 01702000
         LR    @15,RCODE                                           0575 01703000
         LM    @00,@03,@SA00009+8                                  0575 01704000
         LM    @05,@12,@SA00009+24                                 0575 01705000
         BR    @14                                                 0575 01706000
*     END;                                                         0576 01707000
*   ELSFLAG=ONS;                    /* ELSE STMT PROCESSED           */ 01708000
@RF00564 OI    ELSFLAG(PARMPTR),B'00010000'                        0577 01709000
*   OC=THREE;                       /* PUT OPCODE IN RECORD PREFIX   */ 01710000
         L     @14,ECDACNXT(,ECDAPTR)                              0578 01711000
         MVI   OC(@14),X'03'                                       0578 01712000
*   OO=CMDADD-(ECDAIREC+FOUR)+THREE;/* PUT IN OFFSET TO ELSE         */ 01713000
         L     @06,CMDADD                                          0579 01714000
         LA    @04,4                                               0579 01715000
         L     @03,ECDAIREC(,ECDAPTR)                              0579 01716000
         ALR   @03,@04                                             0579 01717000
         LR    @02,@06                                             0579 01718000
         SLR   @02,@03                                             0579 01719000
         AL    @02,@CF00250                                        0579 01720000
         STH   @02,OO(,@14)                                        0579 01721000
*   O2O2=OO+FOUR;                   /* OFFSET PAST ELSE              */ 01722000
         ALR   @02,@04                                             0580 01723000
         STH   @02,O2O2(,@14)                                      0580 01724000
*   LL=SEVEN;                       /* LENGTH OF PREFIX              */ 01725000
         MVC   LL(2,@14),@CH00149                                  0581 01726000
*   DATAADD=ECDAIREC+FOUR;          /* ADDRESS OF ELSE FOR MOVERTN   */ 01727000
         ST    @03,DATAADD                                         0582 01728000
*   DATALEN=(CMDADD+FOUR)-DATAADD;  /* LENGTH OF MOVE                */ 01729000
         ALR   @06,@04                                             0583 01730000
         SLR   @06,@03                                             0583 01731000
         ST    @06,DATALEN                                         0583 01732000
*   CALL MOVERTN;                   /* CALL MOVE ROUTINE             */ 01733000
         BAL   @14,MOVERTN                                         0584 01734000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 01735000
         LR    RCODE,R15                                           0585 01736000
*   IF RCODE^=ZERO THEN             /* IF OTHER THAN ZERO THEN       */ 01737000
         LTR   RCODE,RCODE                                         0586 01738000
         BNZ   @RT00586                                            0586 01739000
*     GOTO BADELSE;                 /* RETURN                        */ 01740000
*                                                                  0587 01741000
*   /*****************************************************************/ 01742000
*   /*                                                               */ 01743000
*   /* AT THIS POINT THE ELSE PORTION OF THE COMMAND HAS BEEN        */ 01744000
*   /* PROCESSED. NEXT SET UP THE INPUT RECORD AND CALL THE RECORD   */ 01745000
*   /* SCAN ROUTINE TO PROCESS THE OBJECT OF THE ELSE.               */ 01746000
*   /*                                                               */ 01747000
*   /*****************************************************************/ 01748000
*                                                                  0588 01749000
*   CMDADD->RECLEN=RECLEN-(CMDADD-ECDAIREC);/* START AT ELSE. LENGTH */ 01750000
         L     @14,CMDADD                                          0588 01751000
         L     @06,ECDAIREC(,ECDAPTR)                              0588 01752000
         LR    @03,@14                                             0588 01753000
         SLR   @03,@06                                             0588 01754000
         L     @01,SCANPTR                                         0588 01755000
         LH    @01,RECLEN(,@01)                                    0588 01756000
         SLR   @01,@03                                             0588 01757000
         STH   @01,RECLEN(,@14)                                    0588 01758000
*   SAVEIREC=ECDAIREC;              /* SAVE IREC POINTER             */ 01759000
         LR    SAVEIREC,@06                                        0589 01760000
*   CMDADD->OO=CMDADD-ECDAIREC;     /* OFFSET TO BEGIN OF BFR        */ 01761000
         STH   @03,OO(,@14)                                        0590 01762000
*   ECDAIREC=CMDADD;                /* UPDATE INPUT POINTER          */ 01763000
         ST    @14,ECDAIREC(,ECDAPTR)                              0591 01764000
*   PARMS=PARMS&&PARMS;             /* BUILD PARM LIST               */ 01765000
         XC    PARMS(12),PARMS                                     0592 01766000
*   PARM1=ECDAPTR;                  /* ZERO PARM TWO                 */ 01767000
         ST    ECDAPTR,PARM1                                       0593 01768000
*   RFY                                                            0594 01769000
*    (R1) RSTD;                     /* RESTRICT REG 1                */ 01770000
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */ 01771000
         LA    R1,PARMS                                            0595 01772000
*   CALL IKJCT432;                  /* CALL RECORD SCAN ROUTINE      */ 01773000
         L     @15,@CA00028                                        0596 01774000
         BALR  @14,@15                                             0596 01775000
*   RFY                                                            0597 01776000
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */ 01777000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 01778000
         LR    RCODE,R15                                           0598 01779000
*   IF RCODE<=FOUR THEN             /* IF RETURN CODE IS NOT LESS    */ 01780000
         C     RCODE,@CF00072                                      0599 01781000
         BH    @RF00599                                            0599 01782000
*     DO;                           /* THAN FOUR THEN RETURN         */ 01783000
*       IF RETFLAG2=ONS THEN        /* PROPAGATE END OF DO LOOP FLAG */ 01784000
         TM    RETFLAG2,B'00100000'                                0601 01785000
         BNO   @RF00601                                            0601 01786000
*         DO;                                                      0602 01787000
*           RETFLAG=ONS;            /* IF ON                         */ 01788000
         OI    RETFLAG(PARMPTR),B'00100000'                        0603 01789000
*           IF ENDFLAG2=ONS THEN                                   0604 01790000
         TM    ENDFLAG2,B'10000000'                                0604 01791000
         BNO   @RF00604                                            0604 01792000
*             ENDFLAG=ONS;          /* PROP END FLAG IF ON           */ 01793000
         OI    ENDFLAG(PARMPTR),B'10000000'                        0605 01794000
*           FALEND=FALEND2;         /* PROPAGATE THE FALSE PATH END  */ 01795000
@RF00604 L     @14,FALEND2                                         0606 01796000
         ST    @14,FALEND(,PARMPTR)                                0606 01797000
*           TRUESAV->FALSEP=FALEND2;/* SET TO LAST STMT PROCESSED    */ 01798000
         STCM  @14,15,FALSEP(TRUESAV)                              0607 01799000
*         END;                                                     0608 01800000
*       ELSE                        /* OTHERWISE SET TO NEXT STMT    */ 01801000
*         TRUESAV->FALSEP=ECDACNXT; /* SAVE ADDR                     */ 01802000
         B     @RC00601                                            0609 01803000
@RF00601 MVC   FALSEP(4,TRUESAV),ECDACNXT(ECDAPTR)                 0609 01804000
*     END;                                                         0610 01805000
@RC00601 DS    0H                                                  0611 01806000
*   RETURN CODE(RCODE) TO SPCLEXIT; /* ADDRESS IN PREVIOUS RECORD AND   01807000
*                                      RETURN                        */ 01808000
@RF00599 LA    @14,SPCLEXIT                                        0611 01809000
         LR    @15,RCODE                                           0611 01810000
         LM    @00,@03,@SA00009+8                                  0611 01811000
         LM    @05,@12,@SA00009+24                                 0611 01812000
         BR    @14                                                 0611 01813000
*   END ELSECMD;                                                   0612 01814000
*                                                                  0613 01815000
*/********************************************************************/ 01816000
*/*                                                                  */ 01817000
*/*     COMMON (TSO)  ROUTINE                                        */ 01818000
*/*                                                                  */ 01819000
*/********************************************************************/ 01820000
*                                                                  0613 01821000
*COMCMD:                                                           0613 01822000
*   PROC;                                                          0613 01823000
COMCMD   STM   @14,@12,@SA00010                                    0613 01824000
*   LL=SEVEN;                       /* UPDATE LL FIELD               */ 01825000
         L     @14,ECDACNXT(,ECDAPTR)                              0614 01826000
         MVC   LL(2,@14),@CH00149                                  0614 01827000
*   OO=CMDADD-ECDAIREC-FOUR+THREE;  /* UPDATE OO FIELD WHICH         */ 01828000
         L     @08,CMDADD                                          0615 01829000
         L     @06,ECDAIREC(,ECDAPTR)                              0615 01830000
         LR    @04,@08                                             0615 01831000
         SLR   @04,@06                                             0615 01832000
         BCTR  @04,0                                               0615 01833000
         STH   @04,OO(,@14)                                        0615 01834000
*   O2O2=ZERO;                      /* IS OFFSET TO COMMAND NAME NEXT   01835000
*                                      UPDATE O2O2 WHICH IS          */ 01836000
         SLR   @04,@04                                             0616 01837000
         STH   @04,O2O2(,@14)                                      0616 01838000
*   LINEPTR=ECDAIREC+FOUR;          /* OFFSET TO FIRST PARAMETER     */ 01839000
         AL    @06,@CF00072                                        0617 01840000
         LR    LINEPTR,@06                                         0617 01841000
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* FIRST GET BEGINNING OF        */ 01842000
*       -LINEPTR;                   /* SEARCH.(LINCOUNT)             */ 01843000
         AL    @08,CMDLEN                                          0618 01844000
         AL    @08,@CF00033                                        0618 01845000
         SLR   @08,LINEPTR                                         0618 01846000
         LR    LINCOUNT,@08                                        0618 01847000
*SCANER:                                                           0619 01848000
*   IF LINCOUNT>RLENGTH THEN        /* IF NO PARMS THEN SET O2O2     */ 01849000
SCANER   C     LINCOUNT,RLENGTH                                    0619 01850000
         BNH   @RF00619                                            0619 01851000
*     DO;                           /* TO END OF BUFFER              */ 01852000
*SET02:                                                            0621 01853000
*       O2O2=LINCOUNT+THREE-ONE;    /*                               */ 01854000
SET02    L     @14,ECDACNXT(,ECDAPTR)                              0621 01855000
         LR    @08,LINCOUNT                                        0621 01856000
         SL    @08,@CF00840                                        0621 01857000
         STH   @08,O2O2(,@14)                                      0621 01858000
*       GOTO COMRET;                /* AND RETURN                    */ 01859000
         B     COMRET                                              0622 01860000
*     END;                                                         0623 01861000
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */ 01862000
@RF00619 LR    COUNT,LINCOUNT                                      0624 01863000
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */ 01864000
         BAL   @14,FINDPARM                                        0625 01865000
*   O2O2=LINCOUNT+THREE-ONE;        /* HAVE FOUND FIRST PARM ADD3 FOR   01866000
*                                      CORRECT OFFSET                */ 01867000
*                                                                  0626 01868000
         L     @14,ECDACNXT(,ECDAPTR)                              0626 01869000
         LR    @08,LINCOUNT                                        0626 01870000
         SL    @08,@CF00840                                        0626 01871000
         STH   @08,O2O2(,@14)                                      0626 01872000
*   /*****************************************************************/ 01873000
*   /*                                                               */ 01874000
*   /* IF COMMAND IS WRITE OR WRITER THEN HAVE O2O2 POINT IMMEDIATELY*/ 01875000
*   /* AFTER THE COMMAND NAME.                                       */ 01876000
*   /*                                                               */ 01877000
*   /*****************************************************************/ 01878000
*                                                                  0627 01879000
*COMRET:                                                           0627 01880000
*   IF OC=OPFOUR|OC=OPFIVE THEN                                    0627 01881000
COMRET   L     @14,ECDACNXT(,ECDAPTR)                              0627 01882000
         CLI   OC(@14),4                                           0627 01883000
         BE    @RT00627                                            0627 01884000
         CLI   OC(@14),5                                           0627 01885000
         BNE   @RF00627                                            0627 01886000
@RT00627 DS    0H                                                  0628 01887000
*     DO;                           /* PROCESS WRITE O2O2            */ 01888000
*       COUNT=OO+CMDLEN-TWO;        /* POINT AFTER CMDNAME           */ 01889000
         L     @14,ECDACNXT(,ECDAPTR)                              0629 01890000
         LH    @08,OO(,@14)                                        0629 01891000
         AL    @08,CMDLEN                                          0629 01892000
         LR    COUNT,@08                                           0629 01893000
         BCTR  COUNT,0                                             0629 01894000
         BCTR  COUNT,0                                             0629 01895000
*       IF COUNT>RLENGTH THEN       /* IF AT END OF BFR              */ 01896000
         C     COUNT,RLENGTH                                       0630 01897000
         BNH   @RF00630                                            0630 01898000
*         O2O2=OO+CMDLEN;           /* AFTER COMMAND NAME            */ 01899000
         STH   @08,O2O2(,@14)                                      0631 01900000
*       ELSE                        /* OTHERWISE                     */ 01901000
*         DO;                                                      0632 01902000
         B     @RC00630                                            0632 01903000
@RF00630 DS    0H                                                  0633 01904000
*           O2O2=COUNT+THREE;       /* INIT O2O2                     */ 01905000
         L     @14,ECDACNXT(,ECDAPTR)                              0633 01906000
         LA    @08,3                                               0633 01907000
         ALR   @08,COUNT                                           0633 01908000
         STH   @08,O2O2(,@14)                                      0633 01909000
*           IF LINE(COUNT:COUNT+ONE)=SLASHAST THEN/* IF AN OPEN    0634 01910000
*                                      COMMENT                       */ 01911000
         LR    @14,LINEPTR                                         0634 01912000
         ALR   @14,COUNT                                           0634 01913000
         BCTR  @14,0                                               0634 01914000
         CLC   LINE(2,@14),@CC00455                                0634 01915000
         BNE   @RF00634                                            0634 01916000
*             DO;                   /*                               */ 01917000
*               CALL COMMENTS;      /* SKIP COMMENTS                 */ 01918000
         BAL   @14,COMMENTS                                        0636 01919000
*               O2O2=COUNT+TWO;     /* SET TO END OF BFR             */ 01920000
         L     @14,ECDACNXT(,ECDAPTR)                              0637 01921000
         LA    @08,2                                               0637 01922000
         ALR   @08,COUNT                                           0637 01923000
         STH   @08,O2O2(,@14)                                      0637 01924000
*             END;                                                 0638 01925000
*         END;                                                     0639 01926000
@RF00634 DS    0H                                                  0640 01927000
*     END;                                                         0640 01928000
@RC00630 DS    0H                                                  0641 01929000
*   IF OC=ZERO THEN                 /* IF TSO COMMAND,MAKE O2O2 SAME */ 01930000
@RF00627 L     @14,ECDACNXT(,ECDAPTR)                              0641 01931000
         CLI   OC(@14),0                                           0641 01932000
         BNE   @RF00641                                            0641 01933000
*     O2O2=OO;                      /* AS OO                         */ 01934000
         LH    @08,OO(,@14)                                        0642 01935000
         STH   @08,O2O2(,@14)                                      0642 01936000
*   DATAADD=ECDAIREC+FOUR;          /* ADDR OF DATA FOR MOVE RTN     */ 01937000
@RF00641 LA    @14,4                                               0643 01938000
         AL    @14,ECDAIREC(,ECDAPTR)                              0643 01939000
         ST    @14,DATAADD                                         0643 01940000
*   DATALEN=RLENGTH;                /* LENGTH OF DATA TO BE MOVED    */ 01941000
         L     @14,RLENGTH                                         0644 01942000
         ST    @14,DATALEN                                         0644 01943000
*   RETURN CODE(ZERO);              /* RETURN (MOVE DONE AT EXIT)    */ 01944000
         SLR   @15,@15                                             0645 01945000
         L     @14,@SA00010                                        0645 01946000
         LM    @00,@12,@SA00010+8                                  0645 01947000
         BR    @14                                                 0645 01948000
*   END COMCMD;                                                    0646 01949000
*                                                                  0647 01950000
*/********************************************************************/ 01951000
*/*                                                                  */ 01952000
*/*     END  ROUTINE                                                 */ 01953000
*/*                                                                  */ 01954000
*/********************************************************************/ 01955000
*                                                                  0647 01956000
*ENDCMD:                                                           0647 01957000
*   PROC;                                                          0647 01958000
ENDCMD   STM   @14,@12,@SA00011                                    0647 01959000
*   ECDANDO=ECDANDO-ONE;            /* LOWER THE DO COUNT BY 1       */ 01960000
         LH    @14,ECDANDO(,ECDAPTR)                               0648 01961000
         BCTR  @14,0                                               0648 01962000
         STH   @14,ECDANDO(,ECDAPTR)                               0648 01963000
*   IF ECDANDO<ZERO THEN            /* IF DO COUNT GOES NEGATIVE     */ 01964000
         LTR   @14,@14                                             0649 01965000
         BNM   @RF00649                                            0649 01966000
*     DO;                           /* THEN ASSUME IT IS A TSO CMD   */ 01967000
*       IF CMDLEN^=THREE|           /* OR AN ALTERNATE END. AN       */ 01968000
*           COMMAND(1:THREE)^=CEND THEN/* ALTERNATE END AND NO OPEN  */ 01969000
         CLC   CMDLEN(4),@CF00250                                  0651 01970000
         BNE   @RT00651                                            0651 01971000
         L     @14,CMDADD                                          0651 01972000
         CLC   COMMAND(3,@14),@CC00187                             0651 01973000
         BE    @RF00651                                            0651 01974000
@RT00651 DS    0H                                                  0652 01975000
*         DO;                       /* DO IS ILLEGAL. ISSUE A MESSAGE*/ 01976000
*           EXMSGID=M534;           /* TO THE USER                   */ 01977000
         MVC   EXMSGID(4),@CC00495                                 0653 01978000
*           MVAR(2)=ADDR(ECDAAEND); /* POINT TO ALTERNATE END        */ 01979000
         LA    @14,ECDAAEND(,ECDAPTR)                              0654 01980000
         ST    @14,MVAR+4                                          0654 01981000
*           MVARLEN(2)=ECDAELNG;    /* LENGTH OF ALTERNATE END       */ 01982000
         LH    @14,ECDAELNG(,ECDAPTR)                              0655 01983000
         STC   @14,MVARLEN+4                                       0655 01984000
*           MVAR(3)=ADDR(CDO);      /* POINT TO DO                   */ 01985000
         LA    @14,@CC00412                                        0656 01986000
         ST    @14,MVAR+8                                          0656 01987000
*           MVARLEN(3)=LENGTH(CDO); /* LENGTH OF DO                  */ 01988000
         MVI   MVARLEN+8,X'02'                                     0657 01989000
*           STMT=ONS;               /* STATEMENT NUMBERS REQ         */ 01990000
         OI    STMT,B'10000000'                                    0658 01991000
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */ 01992000
         BAL   @14,MSGRTN                                          0659 01993000
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */ 01994000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0660 01995000
*           RETURN CODE(ZERO) TO SPCLEXIT;/* AND RETURN              */ 01996000
         LA    @14,SPCLEXIT                                        0661 01997000
         SLR   @15,@15                                             0661 01998000
         LM    @00,@12,@SA00011+8                                  0661 01999000
         BR    @14                                                 0661 02000000
*         END;                                                     0662 02001000
*       ECDANDO=ZERO;               /* IF IT IS A TSO COMMAND        */ 02002000
@RF00651 SLR   @14,@14                                             0663 02003000
         STH   @14,ECDANDO(,ECDAPTR)                               0663 02004000
*       CALL COMCMD;                /* ZERO THE DO COUNT,CALL        */ 02005000
         BAL   @14,COMCMD                                          0664 02006000
*       RETURN;                     /* RETURN                        */ 02007000
@EL00011 DS    0H                                                  0665 02008000
@EF00011 DS    0H                                                  0665 02009000
@ER00011 LM    @14,@12,@SA00011                                    0665 02010000
         BR    @14                                                 0665 02011000
*     END;                          /* COMCMD (TSO) AND RETURN       */ 02012000
*                                                                  0666 02013000
*   /*****************************************************************/ 02014000
*   /*                                                               */ 02015000
*   /* AT THIS POINT IT IS KNOWN THAT THE COMMAND IS A VALID END OR  */ 02016000
*   /* ALTERNATE END COMMAND                                         */ 02017000
*   /*                                                               */ 02018000
*   /*****************************************************************/ 02019000
*                                                                  0667 02020000
*   ENDFLAG=ON;                     /* SET END FLAG FOR DO ROUTINE   */ 02021000
@RF00649 OI    ENDFLAG(PARMPTR),B'10000000'                        0667 02022000
*   OC=OPEIGHT;                     /* SET OPCODE IN DATA AREA       */ 02023000
         L     @14,ECDACNXT(,ECDAPTR)                              0668 02024000
         MVI   OC(@14),X'08'                                       0668 02025000
*   O2O2=RLENGTH+THREE;             /* SET OFFSET TO END OF RECORD   */ 02026000
         L     @06,RLENGTH                                         0669 02027000
         LA    @05,3                                               0669 02028000
         LR    @04,@06                                             0669 02029000
         ALR   @04,@05                                             0669 02030000
         STH   @04,O2O2(,@14)                                      0669 02031000
*   OO=CMDADD-(ECDAIREC+FOUR)+THREE;/* SET OFFSET TO E IN END        */ 02032000
         LA    @04,4                                               0670 02033000
         AL    @04,ECDAIREC(,ECDAPTR)                              0670 02034000
         L     @03,CMDADD                                          0670 02035000
         SLR   @03,@04                                             0670 02036000
         ALR   @03,@05                                             0670 02037000
         STH   @03,OO(,@14)                                        0670 02038000
*   LL=SEVEN;                       /* LENGTH OF PREFIX              */ 02039000
         MVC   LL(2,@14),@CH00149                                  0671 02040000
*   DATAADD=ECDAIREC+FOUR;          /* ADDR OF END OR MOVE RTN       */ 02041000
         ST    @04,DATAADD                                         0672 02042000
*   DATALEN=RLENGTH;                /* LENGTH OF END FOR MOVE        */ 02043000
         ST    @06,DATALEN                                         0673 02044000
*   END ENDCMD;                     /* END OF END ROUTINE            */ 02045000
         B     @EL00011                                            0674 02046000
*                                                                  0675 02047000
*/********************************************************************/ 02048000
*/*                                                                  */ 02049000
*/*     DO  ROUTINE                                                  */ 02050000
*/*                                                                  */ 02051000
*/********************************************************************/ 02052000
*                                                                  0675 02053000
*DOCMD:                                                            0675 02054000
*   PROC;                                                          0675 02055000
DOCMD    STM   @14,@03,@SA00012                                    0675 02056000
         STM   @05,@12,@SA00012+24                                 0675 02057000
*   OC=OPSEVEN;                     /* INIT OPCODE FIELD             */ 02058000
         L     @14,ECDACNXT(,ECDAPTR)                              0676 02059000
         MVI   OC(@14),X'07'                                       0676 02060000
*   FLGS=ZERO;                      /* ZERO OUT FLAG FIELD           */ 02061000
         MVI   FLGS(@14),X'00'                                     0677 02062000
*   ECDANDO=ECDANDO+ONE;            /* UPDATE DO COUNT BY 1          */ 02063000
*                                                                  0678 02064000
         LA    @08,1                                               0678 02065000
         LH    @06,ECDANDO(,ECDAPTR)                               0678 02066000
         ALR   @06,@08                                             0678 02067000
         STH   @06,ECDANDO(,ECDAPTR)                               0678 02068000
*   /*****************************************************************/ 02069000
*   /*                                                               */ 02070000
*   /* NEXT DETERMINE IF THIS IS A SIMPLE DO STATEMENT OR A DO WHILE */ 02071000
*   /* STATEMENT. FOR A DO WHILE THE WHOLE STATEMENT WILL BE MOVED   */ 02072000
*   /* INTO THE CLIST PARM AREA(INCLUDING THE OBJECT OF THE WHILE    */ 02073000
*   /* STATEMENT)--OTHERWISE JUST THE DO WILL BE MOVED               */ 02074000
*   /*                                                               */ 02075000
*   /*****************************************************************/ 02076000
*                                                                  0679 02077000
*   LINEPTR=ECDAIREC+FOUR;          /* FIND FIRST NON-SEPARATOR      */ 02078000
         LA    LINEPTR,4                                           0679 02079000
         AL    LINEPTR,ECDAIREC(,ECDAPTR)                          0679 02080000
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* AFTER DO AND SEE IF IT IS     */ 02081000
*       -LINEPTR;                   /* A WHILE STATEMENT             */ 02082000
         L     LINCOUNT,CMDADD                                     0680 02083000
         AL    LINCOUNT,CMDLEN                                     0680 02084000
         ALR   LINCOUNT,@08                                        0680 02085000
         SLR   LINCOUNT,LINEPTR                                    0680 02086000
*   LL=EIGHT;                       /* LENGTH OF PREFIX              */ 02087000
         MVC   LL(2,@14),@CH00088                                  0681 02088000
*SCANDO:                                                           0682 02089000
*   IF LINCOUNT>RLENGTH THEN        /* DO NOT GO PAST END OF         */ 02090000
SCANDO   C     LINCOUNT,RLENGTH                                    0682 02091000
         BNH   @RF00682                                            0682 02092000
*     DO;                           /* RECORD.                       */ 02093000
*SCANDO2:                                                          0684 02094000
*       IF FLGS=EIGHTY THEN         /* END. IF DO WHILE AND NO       */ 02095000
SCANDO2  L     @14,ECDACNXT(,ECDAPTR)                              0684 02096000
         CLI   FLGS(@14),128                                       0684 02097000
         BNE   @RF00684                                            0684 02098000
*         DO;                       /* OPERANDS THEN NOTIFY USER AND */ 02099000
*           EXMSGID=M536;           /* TREAT AS NORMAL               */ 02100000
         MVC   EXMSGID(4),@CC00497                                 0686 02101000
*           STMT=ONS;               /* STMATMENT NUMBERS REQUIRED    */ 02102000
         OI    STMT,B'10000000'                                    0687 02103000
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */ 02104000
         BAL   @14,MSGRTN                                          0688 02105000
*           FLGS=ZERO;              /* END STATEMENT.                */ 02106000
         L     @14,ECDACNXT(,ECDAPTR)                              0689 02107000
         MVI   FLGS(@14),X'00'                                     0689 02108000
*           LL=EIGHT;               /* LENGTH OF REC PREFIX          */ 02109000
         MVC   LL(2,@14),@CH00088                                  0690 02110000
*         END;                                                     0691 02111000
*       GOTO REGDO;                 /* RECORD.IF END IS REACHED      */ 02112000
         B     REGDO                                               0692 02113000
*     END;                                                         0693 02114000
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */ 02115000
@RF00682 LR    COUNT,LINCOUNT                                      0694 02116000
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */ 02117000
         BAL   @14,FINDPARM                                        0695 02118000
*   IF LINCOUNT>RLENGTH THEN        /* PAST END OF BUFFER            */ 02119000
         L     @14,RLENGTH                                         0696 02120000
         CR    LINCOUNT,@14                                        0696 02121000
         BH    @RT00696                                            0696 02122000
*     GOTO SCANDO2;                 /* YES--THEN BRANCH              */ 02123000
*   IF FLGS=EIGHTY THEN             /* WAS SCAN FOR WHILE PARMS?     */ 02124000
         L     @08,ECDACNXT(,ECDAPTR)                              0698 02125000
         CLI   FLGS(@08),128                                       0698 02126000
         BE    @RT00698                                            0698 02127000
*     GOTO REGDO;                   /* YES--RETURN TO WHILE CODE     */ 02128000
*   IF LINCOUNT+FOUR>RLENGTH THEN   /* ARE NON-SEPARATORS A WHILE?   */ 02129000
         LA    @06,4                                               0700 02130000
         ALR   @06,LINCOUNT                                        0700 02131000
         CR    @06,@14                                             0700 02132000
         BH    @RT00700                                            0700 02133000
*     GOTO DOBAD;                   /* PUT OUT WARNING MSG   @ZM30996*/ 02134000
*   IF LINE(LINCOUNT:LINCOUNT+FOUR)=/* MATCH ON WHILE?               */ 02135000
*       WHILES THEN                 /*                               */ 02136000
         LR    @14,LINEPTR                                         0702 02137000
         ALR   @14,LINCOUNT                                        0702 02138000
         BCTR  @14,0                                               0702 02139000
         CLC   LINE(5,@14),@CC00430                                0702 02140000
         BNE   @RF00702                                            0702 02141000
*     DO;                           /* YES--IT IS A DO WHILE         */ 02142000
*       FALSEP2=ZERO;               /* RESERVE FALSE APTH ADDR       */ 02143000
         SLR   @14,@14                                             0704 02144000
         STCM  @14,15,FALSEP2(@08)                                 0704 02145000
*       FLGS=EIGHTY;                /* INDICATE WHILE IN FLAGS       */ 02146000
         MVI   FLGS(@08),X'80'                                     0705 02147000
*       LL=TWELVE;                  /* SET PREFIX LENGTH TO 12       */ 02148000
         MVC   LL(2,@08),@CH00359                                  0706 02149000
*       LINCOUNT=LINCOUNT+FIVE;     /* SET TO LOOK FOR WHILE OPERANDS*/ 02150000
         AL    LINCOUNT,@CF00371                                   0707 02151000
*       GOTO SCANDO;                /* SCAN DO STMT                  */ 02152000
         B     SCANDO                                              0708 02153000
*     END;                                                         0709 02154000
*DOBAD:                                                            0710 02155000
*   EXMSGID=M526;                   /* INVALID KEYWORD       @ZM30996*/ 02156000
@RF00702 DS    0H                                                  0710 02157000
DOBAD    MVC   EXMSGID(4),@CC00515                                 0710 02158000
*   STMT=ONS;                       /* STMT NUMBER IN MSG    @ZM30996*/ 02159000
         OI    STMT,B'10000000'                                    0711 02160000
*   MVAR(2)=ADDR(LINE(LINCOUNT));   /* LOC OF INVALID KYWD   @ZM30996*/ 02161000
         LR    @14,LINEPTR                                         0712 02162000
         BCTR  @14,0                                               0712 02163000
         LA    @14,LINE(LINCOUNT,@14)                              0712 02164000
         ST    @14,MVAR+4                                          0712 02165000
*   MVARLEN(2)=MIN(5,RLENGTH-LINCOUNT+1);/* LENGTH OF INSERT @ZM30996*/ 02166000
         L     @14,RLENGTH                                         0713 02167000
         SLR   @14,LINCOUNT                                        0713 02168000
         AL    @14,@CF00033                                        0713 02169000
         LA    @08,5                                               0713 02170000
         CR    @14,@08                                             0713 02171000
         BNH   *+6                                                      02172000
         LR    @14,@08                                             0713 02173000
         STC   @14,MVARLEN+4                                       0713 02174000
*   CALL MSGRTN;                    /* SEND MSG              @ZM30996*/ 02175000
         BAL   @14,MSGRTN                                          0714 02176000
*   FLGS=ZERO;                      /* INDICATE ORDINARY DO  @ZM30996*/ 02177000
         L     @14,ECDACNXT(,ECDAPTR)                              0715 02178000
         MVI   FLGS(@14),X'00'                                     0715 02179000
*   LL=EIGHT;                       /* REC PREFIX 4 SIMPLE DO@ZM30996*/ 02180000
         MVC   LL(2,@14),@CH00088                                  0716 02181000
*REGDO:                                                            0717 02182000
*   O2O2=LINCOUNT-ONE+LL-FOUR;      /* SET UP O2O2 FIELD             */ 02183000
REGDO    L     @14,ECDACNXT(,ECDAPTR)                              0717 02184000
         LA    @08,4                                               0717 02185000
         LR    @06,LINCOUNT                                        0717 02186000
         BCTR  @06,0                                               0717 02187000
         AH    @06,LL(,@14)                                        0717 02188000
         SLR   @06,@08                                             0717 02189000
         STH   @06,O2O2(,@14)                                      0717 02190000
*   OO=CMDADD-ECDAIREC;             /* INIT VALUE FOR OO             */ 02191000
         L     @06,CMDADD                                          0718 02192000
         SL    @06,ECDAIREC(,ECDAPTR)                              0718 02193000
         STH   @06,OO(,@14)                                        0718 02194000
*   IF FLGS=EIGHTY THEN             /* IF DO WHILE PROCESSING        */ 02195000
         CLI   FLGS(@14),128                                       0719 02196000
         BNE   @RF00719                                            0719 02197000
*     OO=OO+FOUR;                   /* ALLOW FOR FALSE PATH PTR      */ 02198000
         ALR   @06,@08                                             0720 02199000
         STH   @06,OO(,@14)                                        0720 02200000
*   DATAADD=ECDAIREC+FOUR;          /* SET UP FOR MOVE. ADDR AND     */ 02201000
@RF00719 LA    @14,4                                               0721 02202000
         AL    @14,ECDAIREC(,ECDAPTR)                              0721 02203000
         ST    @14,DATAADD                                         0721 02204000
*   DATALEN=RLENGTH;                /* LENGTH OF DATA                */ 02205000
         L     @14,RLENGTH                                         0722 02206000
         ST    @14,DATALEN                                         0722 02207000
*   CALL MOVERTN;                   /* CALL MOVE ROUTINE             */ 02208000
         BAL   @14,MOVERTN                                         0723 02209000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 02210000
         LR    RCODE,R15                                           0724 02211000
*   IF RCODE^=ZERO THEN             /* MOVE FAIL?                    */ 02212000
         LTR   RCODE,RCODE                                         0725 02213000
         BZ    @RF00725                                            0725 02214000
*     RETURN CODE(RCODE) TO SPCLEXIT;/* YES---RETURN                 */ 02215000
         LA    @14,SPCLEXIT                                        0726 02216000
         LR    @15,RCODE                                           0726 02217000
         LM    @00,@03,@SA00012+8                                  0726 02218000
         LM    @05,@12,@SA00012+24                                 0726 02219000
         BR    @14                                                 0726 02220000
*   DOBASE=ECDACPRE;                /* SAVE ADDRESS OF DO STMT FOR 0727 02221000
*                                      FALSE PATH UPDATE LATER       */ 02222000
@RF00725 L     DOBASE,ECDACPRE(,ECDAPTR)                           0727 02223000
*GETAGN:                                                           0728 02224000
*   CALL GETALINE;                  /* GETALINE ROUTINE              */ 02225000
GETAGN   BAL   @14,GETALINE                                        0728 02226000
*   RCODE=R15;                      /* DID GETALINE FAIL             */ 02227000
         LR    RCODE,R15                                           0729 02228000
*   IF RCODE^=ZERO THEN                                            0730 02229000
         LTR   RCODE,RCODE                                         0730 02230000
         BZ    @RF00730                                            0730 02231000
*     DO;                           /* YES --                        */ 02232000
*       IF RCODE=FOUR THEN          /* WAS IT END OF FILE?           */ 02233000
         C     RCODE,@CF00072                                      0732 02234000
         BNE   @RF00732                                            0732 02235000
*         DO;                       /* YES-- ISSUE MESSAGE TO USER   */ 02236000
*OPENDO:                                                           0734 02237000
*           EXMSGID=M537;           /* FOR OPEN DO GROUP             */ 02238000
OPENDO   MVC   EXMSGID(4),@CC00499                                 0734 02239000
*           MVAR(1)=ADDR(CDO);      /* INSERT                        */ 02240000
         LA    @14,@CC00412                                        0735 02241000
         ST    @14,MVAR                                            0735 02242000
*           MVARLEN(1)=LENGTH(CDO); /* LENGTH OF INSERT              */ 02243000
         MVI   MVARLEN,X'02'                                       0736 02244000
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */ 02245000
         BAL   @14,MSGRTN                                          0737 02246000
*         END;                                                     0738 02247000
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */ 02248000
@RF00732 OI    NOTEXEC(ECDAPTR),B'01000000'                        0739 02249000
*       RETURN CODE(RCODE) TO SPCLEXIT;/* RETURN                     */ 02250000
         LA    @14,SPCLEXIT                                        0740 02251000
         LR    @15,RCODE                                           0740 02252000
         LM    @00,@03,@SA00012+8                                  0740 02253000
         LM    @05,@12,@SA00012+24                                 0740 02254000
         BR    @14                                                 0740 02255000
*     END;                                                         0741 02256000
*                                                                  0741 02257000
*   /*****************************************************************/ 02258000
*   /*                                                               */ 02259000
*   /* AT THIS POINT THE NEXT INPUT RECORD IS READY FOR PROCESS SET  */ 02260000
*   /* UP FLAGS AND POINTERS AND CALL RECORD SCAN ROUTINE            */ 02261000
*   /*                                                               */ 02262000
*   /*****************************************************************/ 02263000
*                                                                  0742 02264000
*   PARM1=ECDAPTR;                  /* BUILD 432 PARM LIST           */ 02265000
@RF00730 ST    ECDAPTR,PARM1                                       0742 02266000
*   PARM2=ZERO;                     /* ZERO PARM 2                   */ 02267000
         SLR   @14,@14                                             0743 02268000
         ST    @14,PARM2                                           0743 02269000
*   RFY                                                            0744 02270000
*    (R1) RSTD;                     /* RESTRICT REG 1                */ 02271000
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */ 02272000
         LA    R1,PARMS                                            0745 02273000
*   CALL IKJCT432;                  /* REINVOKE 432                  */ 02274000
         L     @15,@CA00028                                        0746 02275000
         BALR  @14,@15                                             0746 02276000
*   RFY                                                            0747 02277000
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */ 02278000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 02279000
         LR    RCODE,R15                                           0748 02280000
*   IF RCODE^=ZERO THEN             /* ERROR--YES THEN ISSUE MSG     */ 02281000
         SLR   @14,@14                                             0749 02282000
         CR    RCODE,@14                                           0749 02283000
         BNE   @RT00749                                            0749 02284000
*     GOTO OPENDO;                  /* AND RETURN                    */ 02285000
*   IF ENDFLAG2=OFF THEN            /* HAS AN END STATEMENT BEEN     */ 02286000
         TM    ENDFLAG2,B'10000000'                                0751 02287000
         BZ    @RT00751                                            0751 02288000
*     GOTO GETAGN;                  /* REACHED-NO--GET NEXT RECORD   */ 02289000
*   IF DOBASE->FLGS=EIGHTY THEN     /* WAS DO STATEMENT A DO WHILE   */ 02290000
         CLI   FLGS(DOBASE),128                                    0753 02291000
         BNE   @RF00753                                            0753 02292000
*     DO;                           /* YES--THEN GENERATE AN         */ 02293000
*       LL=ELEVEN;                  /* INTERNAL GOTO, LL FIELD       */ 02294000
         L     @08,ECDACNXT(,ECDAPTR)                              0755 02295000
         MVC   LL(2,@08),@CH00392                                  0755 02296000
*       OO=SEVEN;                   /* OO FILED                      */ 02297000
         LA    @06,7                                               0756 02298000
         STH   @06,OO(,@08)                                        0756 02299000
*       O2O2=SEVEN;                 /* O2O2 FIELD                    */ 02300000
         STH   @06,O2O2(,@08)                                      0757 02301000
*       OC=GOCODE;                  /* SET OPCODE                    */ 02302000
         MVI   OC(@08),X'0F'                                       0758 02303000
*       FALSEP=DOBASE;              /* GOTO ADDRESS                  */ 02304000
         STCM  DOBASE,15,FALSEP(@08)                               0759 02305000
*       DATAADD=ZERO;               /* CALL MOVE RTN TO UPDATE       */ 02306000
         ST    @14,DATAADD                                         0760 02307000
*       DATALEN=ZERO;               /* POINTERS WITHOUT ACTUALLY     */ 02308000
         ST    @14,DATALEN                                         0761 02309000
*       CALL MOVERTN;               /* MOVING ANY DATA               */ 02310000
         BAL   @14,MOVERTN                                         0762 02311000
*       RCODE=R15;                  /* SAVE RETURN CODE              */ 02312000
         LR    RCODE,R15                                           0763 02313000
*       DOBASE->FALSEP2=ECDACNXT;   /* UPDATE FALSE PATH ADDRESS     */ 02314000
         MVC   FALSEP2(4,DOBASE),ECDACNXT(ECDAPTR)                 0764 02315000
*     END;                          /* IN ORIGINAL DO WHILE          */ 02316000
*   RETURN CODE(RCODE) TO SPCLEXIT; /* RETURN. END OF DO.            */ 02317000
@RF00753 LA    @14,SPCLEXIT                                        0766 02318000
         LR    @15,RCODE                                           0766 02319000
         LM    @00,@03,@SA00012+8                                  0766 02320000
         LM    @05,@12,@SA00012+24                                 0766 02321000
         BR    @14                                                 0766 02322000
*   END DOCMD;                                                     0767 02323000
*                                                                  0768 02324000
*/********************************************************************/ 02325000
*/*                                                                  */ 02326000
*/*     ERROR  ROUTINE                                               */ 02327000
*/*                                                                  */ 02328000
*/********************************************************************/ 02329000
*                                                                  0768 02330000
*ERRORCMD:                                                         0768 02331000
*   PROC;                                                          0768 02332000
ERRORCMD STM   @14,@03,@SA00013                                    0768 02333000
         STM   @05,@12,@SA00013+24                                 0768 02334000
*   IF OC^=OPATTN THEN              /* IF NOT THE ATTENTION CMD      */ 02335000
         L     @14,ECDACNXT(,ECDAPTR)                              0769 02336000
         CLI   OC(@14),17                                          0769 02337000
         BE    @RF00769                                            0769 02338000
*     OC=OP10;                      /* SET OPCODE IN CP AREA TO 12   */ 02339000
         MVI   OC(@14),X'0A'                                       0770 02340000
*   FLGS=ZERO;                      /* ZERO OUT FLAG FIELD           */ 02341000
@RF00769 L     @14,ECDACNXT(,ECDAPTR)                              0771 02342000
         MVI   FLGS(@14),X'00'                                     0771 02343000
*   LL=EIGHT;                       /* LENGTH OF PREFIX              */ 02344000
         MVC   LL(2,@14),@CH00088                                  0772 02345000
*   O2O2=RLENGTH+FOUR;              /* OFFSET TO END OF ERROR/ATTN   */ 02346000
         LA    @08,4                                               0773 02347000
         L     @06,RLENGTH                                         0773 02348000
         ALR   @06,@08                                             0773 02349000
         STH   @06,O2O2(,@14)                                      0773 02350000
*   OO=CMDADD-ECDAIREC;             /* OFFSET TO E OF ERROR/ATTN     */ 02351000
*                                                                  0774 02352000
         L     @06,CMDADD                                          0774 02353000
         L     @02,ECDAIREC(,ECDAPTR)                              0774 02354000
         LR    @01,@06                                             0774 02355000
         SLR   @01,@02                                             0774 02356000
         STH   @01,OO(,@14)                                        0774 02357000
*   /*****************************************************************/ 02358000
*   /*                                                               */ 02359000
*   /* NEXT DETERMINE IF OFF WAS SPECIFIED ON THE ERROR STATEMENT IF */ 02360000
*   /* IT WAS SET APPROPRIATE FLAGS AND EXIT VIA COMMON EXIT.        */ 02361000
*   /*                                                               */ 02362000
*   /*****************************************************************/ 02363000
*                                                                  0775 02364000
*   LINEPTR=ECDAIREC+FOUR;          /* POINTER TO DATA               */ 02365000
         ALR   @02,@08                                             0775 02366000
         LR    LINEPTR,@02                                         0775 02367000
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* GET FIRST CHARACTER TO        */ 02368000
*       -LINEPTR;                   /* CHECK AFTER ERROR/ATTN        */ 02369000
         AL    @06,CMDLEN                                          0776 02370000
         AL    @06,@CF00033                                        0776 02371000
         SLR   @06,LINEPTR                                         0776 02372000
         LR    LINCOUNT,@06                                        0776 02373000
*OFFAGN:                                                           0777 02374000
*   IF LINCOUNT>RLENGTH THEN        /* AT END OF RECORD? IF SO       */ 02375000
OFFAGN   C     LINCOUNT,RLENGTH                                    0777 02376000
         BNH   @RF00777                                            0777 02377000
*     DO;                           /* NO OPERANDS                   */ 02378000
*OFFAGN2:                                                          0779 02379000
*       FLGS=FORTY;                 /* SET FLAG TO HEX FORTY         */ 02380000
OFFAGN2  L     @14,ECDACNXT(,ECDAPTR)                              0779 02381000
         MVI   FLGS(@14),X'40'                                     0779 02382000
*       GOTO NOOPS;                 /* GO TO MOVE CODE               */ 02383000
         B     NOOPS                                               0780 02384000
*     END;                                                         0781 02385000
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */ 02386000
@RF00777 LR    COUNT,LINCOUNT                                      0782 02387000
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */ 02388000
         BAL   @14,FINDPARM                                        0783 02389000
*   IF LINCOUNT>RLENGTH THEN        /* PAST END OF BUFFER ?          */ 02390000
         L     @14,RLENGTH                                         0784 02391000
         CR    LINCOUNT,@14                                        0784 02392000
         BH    @RT00784                                            0784 02393000
*     GOTO OFFAGN2;                 /* YES--GO SET NO OPERAND BIT    */ 02394000
*   IF LINCOUNT+TWO>RLENGTH THEN    /* OFF SPECIFIED??               */ 02395000
         LA    @08,2                                               0786 02396000
         ALR   @08,LINCOUNT                                        0786 02397000
         CR    @08,@14                                             0786 02398000
         BH    @RT00786                                            0786 02399000
*     GOTO NOOFF;                   /* NO--SKIP OFF CODE             */ 02400000
*   IF LINE(LINCOUNT:LINCOUNT+TWO)= /* FIRST NON-SEPAR FOUND--IS     */ 02401000
*       OFFS THEN                   /* IT OFF?                       */ 02402000
         LR    @14,LINEPTR                                         0788 02403000
         ALR   @14,LINCOUNT                                        0788 02404000
         BCTR  @14,0                                               0788 02405000
         CLC   LINE(3,@14),@CC00414                                0788 02406000
         BNE   @RF00788                                            0788 02407000
*     DO;                           /* YES                           */ 02408000
*       FLGS=EIGHTY;                /* SET FLAG BYTE TO HEX 80       */ 02409000
         L     @14,ECDACNXT(,ECDAPTR)                              0790 02410000
         MVI   FLGS(@14),X'80'                                     0790 02411000
*NOOPS:                                                            0791 02412000
*       DATAADD=ECDAIREC+FOUR;      /* SET UP FOR MOVE OF ERROR/ATTN */ 02413000
NOOPS    LA    @14,4                                               0791 02414000
         AL    @14,ECDAIREC(,ECDAPTR)                              0791 02415000
         ST    @14,DATAADD                                         0791 02416000
*       DATALEN=RLENGTH;            /* AT COMMON EXIT                */ 02417000
         L     @14,RLENGTH                                         0792 02418000
         ST    @14,DATALEN                                         0792 02419000
*       RETURN CODE(ZERO) TO COMNEXIT;/* RETURN VIA COMMON EXIT.     */ 02420000
         LA    @14,COMNEXIT                                        0793 02421000
         SLR   @15,@15                                             0793 02422000
         LM    @00,@03,@SA00013+8                                  0793 02423000
         LM    @05,@12,@SA00013+24                                 0793 02424000
         BR    @14                                                 0793 02425000
*     END;                                                         0794 02426000
*NOOFF:                                                            0795 02427000
*   DATAADD=ECDAIREC+FOUR;          /* OFF NOT SPECIFIED. GO TO      */ 02428000
@RF00788 DS    0H                                                  0795 02429000
NOOFF    LA    @14,4                                               0795 02430000
         L     @08,ECDAIREC(,ECDAPTR)                              0795 02431000
         ALR   @08,@14                                             0795 02432000
         ST    @08,DATAADD                                         0795 02433000
*   DATALEN=CMDADD+CMDLEN-(ECDAIREC+FOUR);/* MOVE ROUTINE TO MOVE IN */ 02434000
         L     @06,CMDADD                                          0796 02435000
         AL    @06,CMDLEN                                          0796 02436000
         SLR   @06,@08                                             0796 02437000
         ST    @06,DATALEN                                         0796 02438000
*   LL=LL+FOUR;                     /* SAVE ROOM FOR FALSE PTR       */ 02439000
         L     @08,ECDACNXT(,ECDAPTR)                              0797 02440000
         LH    @06,LL(,@08)                                        0797 02441000
         ALR   @06,@14                                             0797 02442000
         STH   @06,LL(,@08)                                        0797 02443000
*   OO=OO+FOUR;                     /* '' ''                         */ 02444000
         AH    @14,OO(,@08)                                        0798 02445000
         STH   @14,OO(,@08)                                        0798 02446000
*   FALSEP2=ZERO;                   /* ZERO POINTER FOR NOW          */ 02447000
         SLR   @14,@14                                             0799 02448000
         STCM  @14,15,FALSEP2(@08)                                 0799 02449000
*   CALL MOVERTN;                   /* ERROR                         */ 02450000
         BAL   @14,MOVERTN                                         0800 02451000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 02452000
         LR    RCODE,R15                                           0801 02453000
*   IF RCODE^=ZERO THEN             /* OK? IF NOT RETURN.            */ 02454000
         LTR   RCODE,RCODE                                         0802 02455000
         BZ    @RF00802                                            0802 02456000
*     RETURN CODE(RCODE) TO SPCLEXIT;/*                              */ 02457000
         LA    @14,SPCLEXIT                                        0803 02458000
         LR    @15,RCODE                                           0803 02459000
         LM    @00,@03,@SA00013+8                                  0803 02460000
         LM    @05,@12,@SA00013+24                                 0803 02461000
         BR    @14                                                 0803 02462000
*   O2O2=LL-FOUR;                   /* BACK DOWN TO CORRECT LENGTH   */ 02463000
@RF00802 L     @14,ECDACNXT(,ECDAPTR)                              0804 02464000
         LH    @08,LL(,@14)                                        0804 02465000
         SL    @08,@CF00072                                        0804 02466000
         STH   @08,O2O2(,@14)                                      0804 02467000
*   ERRBASE=ECDACPRE;               /* SAVE BASE TO ERROR/ATTN STMT  */ 02468000
*                                                                  0805 02469000
         L     ERRBASE,ECDACPRE(,ECDAPTR)                          0805 02470000
*   /*****************************************************************/ 02471000
*   /*                                                               */ 02472000
*   /* NEXT SET UP TO CALL RECORD SCAN ROUTINE TO PROCESS THE OBJECT */ 02473000
*   /* OF THE ERROR COMMAND. MAKE THE OBJECT OF THE ERROR COMMAND    */ 02474000
*   /* LOOK LIKE ANY INPUT RECORD AND UPDATE CDA.                    */ 02475000
*   /*                                                               */ 02476000
*   /*****************************************************************/ 02477000
*                                                                  0806 02478000
*   IF OC^=OPATTN THEN              /* DONT ADD ONE IF ATTN          */ 02479000
         CLI   OC(@14),17                                          0806 02480000
         BE    @RF00806                                            0806 02481000
*     CMDADD=CMDADD+ONE;            /* OVERLAY ERROR/ATTN WITH HDR   */ 02482000
         LA    @14,1                                               0807 02483000
         AL    @14,CMDADD                                          0807 02484000
         ST    @14,CMDADD                                          0807 02485000
*   CMDADD->RECLEN=RECLEN-(CMDADD-ECDAIREC);/* SET RECORD LEN        */ 02486000
@RF00806 L     @14,CMDADD                                          0808 02487000
         LR    @08,@14                                             0808 02488000
         SL    @08,ECDAIREC(,ECDAPTR)                              0808 02489000
         L     @06,SCANPTR                                         0808 02490000
         LH    @06,RECLEN(,@06)                                    0808 02491000
         SLR   @06,@08                                             0808 02492000
         STH   @06,RECLEN(,@14)                                    0808 02493000
*   CMDADD->OO=CMDADD-ECDAIREC;     /* SAVE OFFSET TO NEW LL         */ 02494000
         STH   @08,OO(,@14)                                        0809 02495000
*   ECDAIREC=CMDADD;                /* UPDATE INPUT RECORD ADDRESS   */ 02496000
         ST    @14,ECDAIREC(,ECDAPTR)                              0810 02497000
*   PARM1=ECDAPTR;                  /* BUILD PARM LIST               */ 02498000
         ST    ECDAPTR,PARM1                                       0811 02499000
*   PARM2=ZERO;                     /* ZERO FLAGS                    */ 02500000
         SLR   @14,@14                                             0812 02501000
         ST    @14,PARM2                                           0812 02502000
*   RFY                                                            0813 02503000
*    (R1) RSTD;                     /* RESTRICT REG 1                */ 02504000
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */ 02505000
         LA    R1,PARMS                                            0814 02506000
*   CALL IKJCT432;                  /* CALL RECORD SCAN ROUTINE      */ 02507000
         L     @15,@CA00028                                        0815 02508000
         BALR  @14,@15                                             0815 02509000
*   RFY                                                            0816 02510000
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */ 02511000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 02512000
         LR    RCODE,R15                                           0817 02513000
*   ERRBASE->FALSEP2=ECDACNXT;      /* GO AROUND ACTION              */ 02514000
         MVC   FALSEP2(4,ERRBASE),ECDACNXT(ECDAPTR)                0818 02515000
*   RETURN CODE(RCODE) TO SPCLEXIT; /* RETURN TO CALLER              */ 02516000
         LA    @14,SPCLEXIT                                        0819 02517000
         LR    @15,RCODE                                           0819 02518000
         LM    @00,@03,@SA00013+8                                  0819 02519000
         LM    @05,@12,@SA00013+24                                 0819 02520000
         BR    @14                                                 0819 02521000
*   END ERRORCMD;                                                  0820 02522000
*                                                                  0821 02523000
*/********************************************************************/ 02524000
*/*                                                                  */ 02525000
*/*     DATA   ROUTINE                                               */ 02526000
*/*                                                                  */ 02527000
*/********************************************************************/ 02528000
*                                                                  0821 02529000
*DATACMD:                                                          0821 02530000
*   PROC;                                                          0821 02531000
*                                                                  0821 02532000
DATACMD  STM   @14,@03,@SA00014                                    0821 02533000
         STM   @05,@12,@SA00014+24                                 0821 02534000
*   /*****************************************************************/ 02535000
*   /*                                                               */ 02536000
*   /* THE DATA ROUTINE PROCESSES ALL STATEMENTS BETWEEN DATA AND    */ 02537000
*   /* ENDDATA STATEMENTS AS TSO COMMANDS. EACH ADDITIONAL RECORD IS */ 02538000
*   /* OBTAINED THROUGH THE GETALINE ROUTINE IF AN ERROR OCCURS AN   */ 02539000
*   /* APPROPRIATE MESSAGE WILL BE ISSUED AND CONTROL RETURNED TO    */ 02540000
*   /* CALLER WITH ERROR RETURN CODE                                 */ 02541000
*   /*                                                               */ 02542000
*   /*****************************************************************/ 02543000
*                                                                  0822 02544000
*NEXTREC:                                                          0822 02545000
*   CALL GETALINE;                  /* GET NEXT RECORD               */ 02546000
NEXTREC  BAL   @14,GETALINE                                        0822 02547000
*   RCODE=R15;                      /* END OF FILE? OR OTHER ERROR   */ 02548000
         LR    RCODE,R15                                           0823 02549000
*   IF RCODE^=ZERO THEN                                            0824 02550000
         LTR   RCODE,RCODE                                         0824 02551000
         BZ    @RF00824                                            0824 02552000
*     DO;                           /* NON-ZERO RETCODE?             */ 02553000
*       IF RCODE=FOUR THEN          /* END OF FILE (RC=16)           */ 02554000
         C     RCODE,@CF00072                                      0826 02555000
         BNE   @RF00826                                            0826 02556000
*         DO;                       /* YES 1 ISSUE MESSAGE           */ 02557000
*           MVAR(1)=ADDR(CDATA);    /* INSERT                        */ 02558000
         LA    @14,@CC00533                                        0828 02559000
         ST    @14,MVAR                                            0828 02560000
*           MVARLEN(1)=LENGTH(CDATA);/* LENGTH OF INSERT             */ 02561000
         MVI   MVARLEN,X'04'                                       0829 02562000
*           EXMSGID=M537;           /* MESSAGE ID                    */ 02563000
         MVC   EXMSGID(4),@CC00499                                 0830 02564000
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */ 02565000
         BAL   @14,MSGRTN                                          0831 02566000
*         END;                                                     0832 02567000
*       RETURN CODE(RCODE) TO SPCLEXIT;/* RETURN                     */ 02568000
@RF00826 LA    @14,SPCLEXIT                                        0833 02569000
         LR    @15,RCODE                                           0833 02570000
         LM    @00,@03,@SA00014+8                                  0833 02571000
         LM    @05,@12,@SA00014+24                                 0833 02572000
         BR    @14                                                 0833 02573000
*     END;                                                         0834 02574000
*   RLENGTH=ECDAIREC->RECLEN-FOUR;  /* SET UP LENGTH FOR CMD SCAN    */ 02575000
@RF00824 L     @14,ECDAIREC(,ECDAPTR)                              0835 02576000
         LH    @14,RECLEN(,@14)                                    0835 02577000
         SL    @14,@CF00072                                        0835 02578000
         ST    @14,RLENGTH                                         0835 02579000
*   CALL CMDSCAN;                   /* CALL COMMAND SCAN             */ 02580000
         BAL   @14,CMDSCAN                                         0836 02581000
*   IF CMDADD^=ZERO&                /* SEE IF COMMAND NAME WAS FOUND */ 02582000
*       LABLADD=0&                  /* WITH NO LABEL PRESENT AND     */ 02583000
*       CMDLEN=SEVEN&               /* IF SO WAS IT AN               */ 02584000
*       COMMAND(1:SEVEN)=CENDATA THEN/* ENDDATA STATEMENT --YES--    */ 02585000
         L     @14,CMDADD                                          0837 02586000
         SLR   @08,@08                                             0837 02587000
         CR    @14,@08                                             0837 02588000
         BE    @RF00837                                            0837 02589000
         C     @08,LABLADD                                         0837 02590000
         BNE   @RF00837                                            0837 02591000
         CLC   CMDLEN(4),@CF00149                                  0837 02592000
         BNE   @RF00837                                            0837 02593000
         CLC   COMMAND(7,@14),@CC00535                             0837 02594000
         BNE   @RF00837                                            0837 02595000
*     RETURN CODE(ZERO) TO SPCLEXIT;/* --RETURN VIA SPECIALEXIT      */ 02596000
         LA    @14,SPCLEXIT                                        0838 02597000
         LR    @15,@08                                             0838 02598000
         LM    @00,@03,@SA00014+8                                  0838 02599000
         LM    @05,@12,@SA00014+24                                 0838 02600000
         BR    @14                                                 0838 02601000
*   LL=SEVEN;                       /* SET UP LENGTH IN PREFIX       */ 02602000
@RF00837 L     @14,ECDACNXT(,ECDAPTR)                              0839 02603000
         MVC   LL(2,@14),@CH00149                                  0839 02604000
*   OC=ZERO;                        /* PUT IN TSO OPCODE             */ 02605000
*                                                                  0840 02606000
         MVI   OC(@14),X'00'                                       0840 02607000
*   /*****************************************************************/ 02608000
*   /*                                                               */ 02609000
*   /* FOR SETTING UP OO AND O2O2 OFFSET FIELDS FIRST DETERMINE IF A */ 02610000
*   /* COMMAND NAME HAD BEEN FOUND--IF ONE WAS NOT FOUND THEN SET    */ 02611000
*   /* OFFSETS TO THE END OF THE BUFFER.OTHERWISE OO WILL BE THE     */ 02612000
*   /* OFFSET TO THE COMMAND AND O2O2 THE OFFSET TO THE FIRST        */ 02613000
*   /* PARAMETER(IF FOUND--OTHERWISE TO END OF BUFFER).              */ 02614000
*   /*                                                               */ 02615000
*   /*****************************************************************/ 02616000
*                                                                  0841 02617000
*   OO=THREE;                       /* SET OFFSET TO BEGINNING OF BUF*/ 02618000
         LA    @08,3                                               0841 02619000
         STH   @08,OO(,@14)                                        0841 02620000
*   O2O2=OO;                        /* O2O2 OFFSET SAME AS OO        */ 02621000
         STH   @08,O2O2(,@14)                                      0842 02622000
*   DATAADD=ECDAIREC+FOUR;          /* ADDR OF DATA FOR MOVE RTN     */ 02623000
         LA    @14,4                                               0843 02624000
         AL    @14,ECDAIREC(,ECDAPTR)                              0843 02625000
         ST    @14,DATAADD                                         0843 02626000
*   DATALEN=RLENGTH;                /* LENGTH OF DATA                */ 02627000
         L     @14,RLENGTH                                         0844 02628000
         ST    @14,DATALEN                                         0844 02629000
*   CALL MOVERTN;                   /* MOVE ROUTINE                  */ 02630000
         BAL   @14,MOVERTN                                         0845 02631000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 02632000
         LR    RCODE,R15                                           0846 02633000
*   IF RCODE^=ZERO THEN             /* IF RETURN CODE IS NON ZERO    */ 02634000
         LTR   RCODE,RCODE                                         0847 02635000
         BZ    @RF00847                                            0847 02636000
*     RETURN CODE(RCODE) TO SPCLEXIT;/* THEN RETURN WITH RETCODE     */ 02637000
         LA    @14,SPCLEXIT                                        0848 02638000
         LR    @15,RCODE                                           0848 02639000
         LM    @00,@03,@SA00014+8                                  0848 02640000
         LM    @05,@12,@SA00014+24                                 0848 02641000
         BR    @14                                                 0848 02642000
*   GOTO NEXTREC;                   /* ELSE GET NEXT RECORD          */ 02643000
         B     NEXTREC                                             0849 02644000
*   END DATACMD;                                                   0850 02645000
*                                                                  0851 02646000
*/********************************************************************/ 02647000
*/*                                                                  */ 02648000
*/*     SET  ROUTINE                                                 */ 02649000
*/*                                                                  */ 02650000
*/********************************************************************/ 02651000
*                                                                  0851 02652000
*SETCMD:                                                           0851 02653000
*   PROC;                                                          0851 02654000
SETCMD   STM   @14,@12,@SA00015                                    0851 02655000
*   OC=DOG;                         /* SET OPCODE TO 0D              */ 02656000
         L     @14,ECDACNXT(,ECDAPTR)                              0852 02657000
         MVI   OC(@14),X'0D'                                       0852 02658000
*   LL=SEVEN;                       /* MOVE IN PREFIX LENGTH         */ 02659000
         MVC   LL(2,@14),@CH00149                                  0853 02660000
*   LINEPTR=ECDAIREC+FOUR;          /* NEXT FIND SYMBOLIC PARM       */ 02661000
         LA    @08,4                                               0854 02662000
         AL    @08,ECDAIREC(,ECDAPTR)                              0854 02663000
         LR    LINEPTR,@08                                         0854 02664000
*   OO=CMDADD-(ECDAIREC+FOUR)+THREE;/* SET OO FIELD                  */ 02665000
         L     @06,CMDADD                                          0855 02666000
         LCR   @08,@08                                             0855 02667000
         ALR   @08,@06                                             0855 02668000
         AL    @08,@CF00250                                        0855 02669000
         STH   @08,OO(,@14)                                        0855 02670000
*   LINCOUNT=(CMDADD+CMDLEN+1)-LINEPTR;/* GET CHARACTER INDEX        */ 02671000
         AL    @06,CMDLEN                                          0856 02672000
         AL    @06,@CF00033                                        0856 02673000
         SLR   @06,LINEPTR                                         0856 02674000
         LR    LINCOUNT,@06                                        0856 02675000
*SETSCN:                                                           0857 02676000
*   IF LINCOUNT>RLENGTH THEN        /* END OF RECORD?                */ 02677000
SETSCN   C     LINCOUNT,RLENGTH                                    0857 02678000
         BNH   @RF00857                                            0857 02679000
*     DO;                           /* YES--NO SYMBOLIC PARMS IS   0858 02680000
*                                      CAUSE FOR FAILURE--ISSUE      */ 02681000
*SETSCN2:                                                          0859 02682000
*       EXMSGID=M538;               /* MESSAGE ID                    */ 02683000
SETSCN2  MVC   EXMSGID(4),@CC00501                                 0859 02684000
*       STMT=ONS;                   /* STATEMENT NUMBERS REQUIRED    */ 02685000
         OI    STMT,B'10000000'                                    0860 02686000
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */ 02687000
         BAL   @14,MSGRTN                                          0861 02688000
*       NOTEXEC=ON;                 /* MESSAGE,SET PROC NOT          */ 02689000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0862 02690000
*       RETURN CODE(ZERO) TO SPCLEXIT;/* EXECUTABLE AND RETURN       */ 02691000
         LA    @14,SPCLEXIT                                        0863 02692000
         SLR   @15,@15                                             0863 02693000
         LM    @00,@12,@SA00015+8                                  0863 02694000
         BR    @14                                                 0863 02695000
*     END;                                                         0864 02696000
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */ 02697000
@RF00857 LR    COUNT,LINCOUNT                                      0865 02698000
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */ 02699000
         BAL   @14,FINDPARM                                        0866 02700000
*   IF LINCOUNT>RLENGTH THEN        /* PAST END OF BUFFER?           */ 02701000
         C     LINCOUNT,RLENGTH                                    0867 02702000
         BH    @RT00867                                            0867 02703000
*     GOTO SETSCN2;                 /* YES---ERROR                   */ 02704000
*   IF AMPERSND=ON THEN             /* IF FIRST IS AMPERSAND         */ 02705000
         TM    AMPERSND,B'00001000'                                0869 02706000
         BNO   @RF00869                                            0869 02707000
*     LINCOUNT=LINCOUNT+ONE;        /* INCREMENT BY ONE              */ 02708000
         AL    LINCOUNT,@CF00033                                   0870 02709000
*   O2O2=ADDR(LINE(LINCOUNT))-LINEPTR+THREE;/* UPDATE 0202 FIELD     */ 02710000
@RF00869 L     @14,ECDACNXT(,ECDAPTR)                              0871 02711000
         LR    @08,LINEPTR                                         0871 02712000
         BCTR  @08,0                                               0871 02713000
         LA    @08,LINE(LINCOUNT,@08)                              0871 02714000
         SLR   @08,LINEPTR                                         0871 02715000
         AL    @08,@CF00250                                        0871 02716000
         STH   @08,O2O2(,@14)                                      0871 02717000
*   DATAADD=LINEPTR;                /* SET UP FOR MOVE ROUTINE IN    */ 02718000
         ST    LINEPTR,DATAADD                                     0872 02719000
*   DATALEN=RLENGTH;                /* COMMON EXIT                   */ 02720000
         L     @14,RLENGTH                                         0873 02721000
         ST    @14,DATALEN                                         0873 02722000
*   RETURN CODE(ZERO) TO COMNEXIT;  /* RETURN TO COMMON EXIT         */ 02723000
         LA    @14,COMNEXIT                                        0874 02724000
         SLR   @15,@15                                             0874 02725000
         LM    @00,@12,@SA00015+8                                  0874 02726000
         BR    @14                                                 0874 02727000
*   END SETCMD;                                                    0875 02728000
*                                                                  0876 02729000
*   /*****************************************************************/ 02730000
*   /*                                                               */ 02731000
*   /* CONTROL ROUTINE                                               */ 02732000
*   /*                                                               */ 02733000
*   /*****************************************************************/ 02734000
*                                                                  0876 02735000
*CNTRLCMD:                                                         0876 02736000
*   PROC;                                                          0876 02737000
CNTRLCMD STM   @14,@12,@SA00016                                    0876 02738000
*   OC=OPNINE;                      /* SET OP CODE                   */ 02739000
         L     @14,ECDACNXT(,ECDAPTR)                              0877 02740000
         MVI   OC(@14),X'09'                                       0877 02741000
*   CNTLFLG=''B;                    /* ZERO CONTROL FLAGS            */ 02742000
         XC    CNTLFLG(2,@14),CNTLFLG(@14)                         0878 02743000
*   OO=CMDADD-(ECDAIREC+FOUR)+FIVE; /* SET OO TO CONTROL             */ 02744000
         LA    @08,5                                               0879 02745000
         L     @06,CMDADD                                          0879 02746000
         LA    @03,4                                               0879 02747000
         AL    @03,ECDAIREC(,ECDAPTR)                              0879 02748000
         LR    @01,@06                                             0879 02749000
         SLR   @01,@03                                             0879 02750000
         ALR   @01,@08                                             0879 02751000
         STH   @01,OO(,@14)                                        0879 02752000
*   LL=NINER;                       /* SET TOTAL LENGTH              */ 02753000
         MVC   LL(2,@14),@CH00171                                  0880 02754000
*   O2O2=RLENGTH+FIVE;              /* POINT TO END OF BUFFER        */ 02755000
         AL    @08,RLENGTH                                         0881 02756000
         STH   @08,O2O2(,@14)                                      0881 02757000
*   LINEPTR=ECDAIREC+FOUR;          /* POINT TO LINE                 */ 02758000
         LR    LINEPTR,@03                                         0882 02759000
*   COUNT=(CMDADD+CMDLEN)-LINEPTR;  /* POINT AFTER CMD NAME          */ 02760000
         AL    @06,CMDLEN                                          0883 02761000
         SLR   @06,LINEPTR                                         0883 02762000
         LR    COUNT,@06                                           0883 02763000
*   SEPS=OFF;                       /* TURN OFF SEPARATOR SWITCH     */ 02764000
         NI    SEPS,B'01111111'                                    0884 02765000
*   DO WHILE SEPS=OFF;              /* PROCESS UNTIL END             */ 02766000
         B     @DE00885                                            0885 02767000
@DL00885 DS    0H                                                  0886 02768000
*     EXACT=OFF;                    /* SET SWITCH                    */ 02769000
*     AMBIG=OFF;                    /* SET SWITCH                    */ 02770000
*     MATCH=OFF;                    /* SET SWITCH                    */ 02771000
         NI    EXACT,B'10001111'                                   0888 02772000
*     COUNT=COUNT+ONE;              /* UP PAST LAST CHAR CHECKED     */ 02773000
         AL    COUNT,@CF00033                                      0889 02774000
*     CALL FINDPARM;                /* FIND A WORD                   */ 02775000
         BAL   @14,FINDPARM                                        0890 02776000
*     IF SEPS=OFF THEN              /* OFFT ALL SEPARATORS           */ 02777000
         TM    SEPS,B'10000000'                                    0891 02778000
         BNZ   @RF00891                                            0891 02779000
*       DO;                         /* PROCESS KYWD FOUND            */ 02780000
*         INDEX=ZERO;               /* ZERO INDEX COUNTER            */ 02781000
         SLR   @14,@14                                             0893 02782000
         ST    @14,INDEX                                           0893 02783000
*         DO ICTR=1 TO DIM(TABLE) WHILE EXACT=OFF;/* FIND IF KEY IS     02784000
*                                      VALID                         */ 02785000
         LA    ICTR,1                                              0894 02786000
@DL00894 TM    EXACT,B'01000000'                                   0894 02787000
         BNZ   @DC00894                                            0894 02788000
*           IF LENTH<=KEYLEN(ICTR)& /* IF LENGTH ^ GT THAN TABL      */ 02789000
*               LINE(LINCOUNT:COUNT)=KEYWRD(ICTR,1:LENTH) THEN     0895 02790000
         L     @14,LENTH                                           0895 02791000
         LR    @06,ICTR                                            0895 02792000
         MH    @06,@CH00043                                        0895 02793000
         LA    @01,KEYLEN-15(@06)                                  0895 02794000
         ICM   @01,12,0(@01)                                       0895 02795000
         SRA   @01,16                                              0895 02796000
         CR    @14,@01                                             0895 02797000
         BH    @RF00895                                            0895 02798000
         LR    @00,@14                                             0895 02799000
         BCTR  @00,0                                               0895 02800000
         LR    @14,LINEPTR                                         0895 02801000
         ALR   @14,LINCOUNT                                        0895 02802000
         BCTR  @14,0                                               0895 02803000
         ST    @01,@TF00001                                        0895 02804000
         LA    @01,KEYWRD-15(@06)                                  0895 02805000
         LR    @06,@00                                             0895 02806000
         EX    @06,@SC00861                                        0895 02807000
         BNE   @RF00895                                            0895 02808000
*             DO;                   /* EVEN A PARTIAL MATCH ?        */ 02809000
*               IF LENTH=KEYLEN(ICTR) THEN/* IF AN EXACT MATCH       */ 02810000
         L     @14,LENTH                                           0897 02811000
         C     @14,@TF00001                                        0897 02812000
         BNE   @RF00897                                            0897 02813000
*                 EXACT=ONS;        /* KEYWORD WAS FOUND             */ 02814000
         OI    EXACT,B'01000000'                                   0898 02815000
*               ELSE                /* OTHERWISE                     */ 02816000
*                 IF MATCH=ONS THEN /* IF ONE PARTIAL ALREADY        */ 02817000
         B     @RC00897                                            0899 02818000
@RF00897 TM    MATCH,B'00100000'                                   0899 02819000
         BNO   @RF00899                                            0899 02820000
*                   AMBIG=ONS;      /* SET AMBIGUOUS SWITCH          */ 02821000
         OI    AMBIG,B'00010000'                                   0900 02822000
*                 ELSE              /* IF OFFN OF THE ABOVE          */ 02823000
*                   MATCH=ONS;      /* AT LEAST A PARTIAL MATCH      */ 02824000
         B     @RC00899                                            0901 02825000
@RF00899 OI    MATCH,B'00100000'                                   0901 02826000
*               INDEX=ICTR;         /* SAVE CURRENT INDEX            */ 02827000
@RC00899 DS    0H                                                  0902 02828000
@RC00897 ST    ICTR,INDEX                                          0902 02829000
*             END;                                                 0903 02830000
*         END;                                                     0904 02831000
@RF00895 AL    ICTR,@CF00033                                       0904 02832000
         C     ICTR,@CF00169                                       0904 02833000
         BNH   @DL00894                                            0904 02834000
@DC00894 DS    0H                                                  0905 02835000
*         IF INDEX=DIM(TABLE) THEN  /* END KEY WORD ?                */ 02836000
         CLC   INDEX(4),@CF00169                                   0905 02837000
         BNE   @RF00905                                            0905 02838000
*           DO;                     /* PROCESS VALUE                 */ 02839000
*             COUNT=COUNT+ONE;      /* SKIP LAST CHAR CHECKED        */ 02840000
         AL    COUNT,@CF00033                                      0907 02841000
*             CALL FINDPARM;        /* FIND NEXT WORD                */ 02842000
         BAL   @14,FINDPARM                                        0908 02843000
*             IF OPAREN=OFF THEN    /* IF NOT AN '(' ERROR           */ 02844000
         TM    OPAREN,B'10000000'                                  0909 02845000
         BNZ   @RF00909                                            0909 02846000
*               CALL ENDMSG;        /* PUT OUT ERROR MSG             */ 02847000
         BAL   @14,ENDMSG                                          0910 02848000
*             ELSE                  /* OTHER WISE                    */ 02849000
*               DO;                 /* FIND VALUE                    */ 02850000
         B     @RC00909                                            0911 02851000
@RF00909 DS    0H                                                  0912 02852000
*                 COUNT=COUNT+ONE;  /* INCREMENT PAST '('            */ 02853000
         AL    COUNT,@CF00033                                      0912 02854000
*                 CALL FINDPARM;    /* FIND NEXT PARM                */ 02855000
         BAL   @14,FINDPARM                                        0913 02856000
*                 IF SEPS=ONS|LENTH>FOUR|NOTALPNU=ONS THEN/* INVALID */ 02857000
         TM    SEPS,B'10000000'                                    0914 02858000
         BO    @RT00914                                            0914 02859000
         L     @14,LENTH                                           0914 02860000
         C     @14,@CF00072                                        0914 02861000
         BH    @RT00914                                            0914 02862000
         TM    NOTALPNU,B'10000000'                                0914 02863000
         BNO   @RF00914                                            0914 02864000
@RT00914 DS    0H                                                  0915 02865000
*                   CALL ENDMSG;    /* PUT OUT ERROR MESSAGE         */ 02866000
         BAL   @14,ENDMSG                                          0915 02867000
*                 ELSE              /* OTHER WISE                    */ 02868000
*                   DO;             /* UPDATE ALTERNATE END          */ 02869000
         B     @RC00914                                            0916 02870000
@RF00914 DS    0H                                                  0917 02871000
*                     ECDAELNG=LENTH;/* SET LENGTH                   */ 02872000
         L     @14,LENTH                                           0917 02873000
         STH   @14,ECDAELNG(,ECDAPTR)                              0917 02874000
*                     ECDAAEND='';  /* CLEAR OLD END                 */ 02875000
         MVI   ECDAAEND(ECDAPTR),C' '                              0918 02876000
         MVC   ECDAAEND+1(3,ECDAPTR),ECDAAEND(ECDAPTR)             0918 02877000
*                     ECDAAEND(1:LENTH)=LINE(LINCOUNT:COUNT);/*      */ 02878000
         BCTR  @14,0                                               0919 02879000
         LR    @08,LINEPTR                                         0919 02880000
         ALR   @08,LINCOUNT                                        0919 02881000
         BCTR  @08,0                                               0919 02882000
         EX    @14,@SM00863                                        0919 02883000
*                   END;                                           0920 02884000
*                 COUNT=COUNT+ONE;  /* SKIP PAST LAST CHAR           */ 02885000
@RC00914 AL    COUNT,@CF00033                                      0921 02886000
*                 CALL FINDPARM;    /* FIND NEXT PARM                */ 02887000
         BAL   @14,FINDPARM                                        0922 02888000
*                 DO WHILE SEPS=OFF&CPAREN=OFF;/* DO GROUP           */ 02889000
         B     @DE00923                                            0923 02890000
@DL00923 DS    0H                                                  0924 02891000
*                   CALL ENDMSG;    /* PRINT ERROR MSG               */ 02892000
         BAL   @14,ENDMSG                                          0924 02893000
*                   COUNT=COUNT+ONE;/* SKIP OVER LAST                */ 02894000
         AL    COUNT,@CF00033                                      0925 02895000
*                   CALL FINDPARM;  /* FIND NEXT PARM                */ 02896000
         BAL   @14,FINDPARM                                        0926 02897000
*                 END;                                             0927 02898000
@DE00923 TM    SEPS,B'10000000'                                    0927 02899000
         BNZ   @DC00923                                            0927 02900000
         TM    CPAREN,B'01000000'                                  0927 02901000
         BZ    @DL00923                                            0927 02902000
@DC00923 DS    0H                                                  0928 02903000
*               END;                                               0928 02904000
*           END;                                                   0929 02905000
@RC00909 DS    0H                                                  0930 02906000
*         IF EXACT=ONS|(MATCH=ONS&AMBIG=OFF) THEN/* OK OK OK         */ 02907000
@RF00905 TM    EXACT,B'01000000'                                   0930 02908000
         BO    @RT00930                                            0930 02909000
         TM    MATCH,B'00100000'                                   0930 02910000
         BNO   @RF00930                                            0930 02911000
         TM    AMBIG,B'00010000'                                   0930 02912000
         BNZ   @RF00930                                            0930 02913000
@RT00930 DS    0H                                                  0931 02914000
*           DO;                     /* OK OK OK                      */ 02915000
*             CNTLFLG=CNTLFLG|MASK1(INDEX);/* TURN ON FLAGS          */ 02916000
         L     @14,ECDACNXT(,ECDAPTR)                              0932 02917000
         L     @08,INDEX                                           0932 02918000
         MH    @08,@CH00043                                        0932 02919000
         LA    @06,MASK1-15(@08)                                   0932 02920000
         OC    CNTLFLG(2,@14),0(@06)                               0932 02921000
*             CNTLFLG=CNTLFLG&MASK2(INDEX);/* TURN ON FLAGS          */ 02922000
         LA    @06,MASK2-15(@08)                                   0933 02923000
         NC    CNTLFLG(2,@14),0(@06)                               0933 02924000
*           END;                                                   0934 02925000
*         ELSE                      /* ELSE                          */ 02926000
*           DO;                                                    0935 02927000
         B     @RC00930                                            0935 02928000
@RF00930 DS    0H                                                  0936 02929000
*             IF AMBIG=ONS THEN     /* AMBIGUOUS                     */ 02930000
         TM    AMBIG,B'00010000'                                   0936 02931000
         BNO   @RF00936                                            0936 02932000
*               EXMSGID=M528;       /* AMBIGUOUS                     */ 02933000
         MVC   EXMSGID(4),@CC00517                                 0937 02934000
*             ELSE                  /* OTHERWISE                     */ 02935000
*               EXMSGID=M526;       /* INVALID                       */ 02936000
         B     @RC00936                                            0938 02937000
@RF00936 MVC   EXMSGID(4),@CC00515                                 0938 02938000
*             MVAR(2)=ADDR(LINE(LINCOUNT));/* BAD GUY                */ 02939000
@RC00936 LR    @14,LINEPTR                                         0939 02940000
         BCTR  @14,0                                               0939 02941000
         LA    @14,LINE(LINCOUNT,@14)                              0939 02942000
         ST    @14,MVAR+4                                          0939 02943000
*             NOTEXEC=ONS;          /* SET PROC NOT EXEC             */ 02944000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0940 02945000
*             MVARLEN(2)=MAX(ONE,LENTH);/* BAD GUYS LENGTH           */ 02946000
         L     @14,LENTH                                           0941 02947000
         LA    @08,1                                               0941 02948000
         CR    @14,@08                                             0941 02949000
         BNL   *+6                                                      02950000
         LR    @14,@08                                             0941 02951000
         STC   @14,MVARLEN+4                                       0941 02952000
*             STMT=ONS;             /* STATEMENT NUMBERS REQUIRED    */ 02953000
         OI    STMT,B'10000000'                                    0942 02954000
*             CALL MSGRTN;          /* ISSUE MESSAGE                 */ 02955000
         BAL   @14,MSGRTN                                          0943 02956000
*           END;                                                   0944 02957000
*       END;                                                       0945 02958000
@RC00930 DS    0H                                                  0946 02959000
*   END;                                                           0946 02960000
@RF00891 DS    0H                                                  0946 02961000
@DE00885 TM    SEPS,B'10000000'                                    0946 02962000
         BZ    @DL00885                                            0946 02963000
*   DATAADD=ECDAIREC+FOUR;          /* DATA ADDRESS                  */ 02964000
         LA    @14,4                                               0947 02965000
         AL    @14,ECDAIREC(,ECDAPTR)                              0947 02966000
         ST    @14,DATAADD                                         0947 02967000
*   DATALEN=RLENGTH;                /* DATA LENGTH                   */ 02968000
         L     @14,RLENGTH                                         0948 02969000
         ST    @14,DATALEN                                         0948 02970000
*   RETURN CODE(ZERO) TO COMNEXIT;  /* RETURN TO MAINLINE            */ 02971000
         LA    @14,COMNEXIT                                        0949 02972000
         SLR   @15,@15                                             0949 02973000
         LM    @00,@12,@SA00016+8                                  0949 02974000
         BR    @14                                                 0949 02975000
*   END CNTRLCMD;                                                  0950 02976000
*ENDMSG:                                                           0951 02977000
*   PROC;                                                          0951 02978000
ENDMSG   STM   @14,@12,@SA00017                                    0951 02979000
*   NOTEXEC=ONS;                    /* SET PROC NOT EXEC             */ 02980000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0952 02981000
*   STMT=ONS;                       /* STMT SWITCH ON                */ 02982000
         OI    STMT,B'10000000'                                    0953 02983000
*   IF SEPS=OFF THEN                /* END OF BUFFER?                */ 02984000
         TM    SEPS,B'10000000'                                    0954 02985000
         BNZ   @RF00954                                            0954 02986000
*     DO;                           /* YES                           */ 02987000
*       EXMSGID=M544;               /* MESSAGE ID                    */ 02988000
         MVC   EXMSGID(4),@CC00519                                 0956 02989000
*       MVAR(2)=ADDR(LINE(LINCOUNT));/* SET MESSAGE INSERT           */ 02990000
         LR    @14,LINEPTR                                         0957 02991000
         BCTR  @14,0                                               0957 02992000
         LA    @14,LINE(LINCOUNT,@14)                              0957 02993000
         ST    @14,MVAR+4                                          0957 02994000
*       MVARLEN(2)=MAX(ONE,LENTH);  /* INSERT LENGTH                 */ 02995000
         L     @14,LENTH                                           0958 02996000
         LA    @08,1                                               0958 02997000
         CR    @14,@08                                             0958 02998000
         BNL   *+6                                                      02999000
         LR    @14,@08                                             0958 03000000
         STC   @14,MVARLEN+4                                       0958 03001000
*     END;                                                         0959 03002000
*   ELSE                            /* ELSE ISSUE                    */ 03003000
*     EXMSGID=M543;                 /* END MESSAGE                   */ 03004000
         B     @RC00954                                            0960 03005000
@RF00954 MVC   EXMSGID(4),@CC00509                                 0960 03006000
*   CALL MSGRTN;                    /* CALL MSGRTN                   */ 03007000
@RC00954 BAL   @14,MSGRTN                                          0961 03008000
*   END ENDMSG;                                                    0962 03009000
@EL00017 DS    0H                                                  0962 03010000
@EF00017 DS    0H                                                  0962 03011000
@ER00017 LM    @14,@12,@SA00017                                    0962 03012000
         BR    @14                                                 0962 03013000
*                                                                  0963 03014000
*/********************************************************************/ 03015000
*/*                                                                  */ 03016000
*/*     READ ROUTINE                                                 */ 03017000
*/*                                                                  */ 03018000
*/********************************************************************/ 03019000
*                                                                  0963 03020000
*READCMD:                                                          0963 03021000
*   PROC;                                                          0963 03022000
READCMD  STM   @14,@03,@SA00018                                    0963 03023000
         STM   @05,@12,@SA00018+24                                 0963 03024000
*   IF OC^=OPGLOB THEN              /* GLOBAL PROCESS                */ 03025000
         L     @14,ECDACNXT(,ECDAPTR)                              0964 03026000
         CLI   OC(@14),255                                         0964 03027000
         BE    @RF00964                                            0964 03028000
*     OC=OPNOMOVE;                  /* SET OP CODE FOR NO MOVE       */ 03029000
         MVI   OC(@14),X'FE'                                       0965 03030000
*   RCODE=ZERO;                     /* ZERO OUT RETURN CODE          */ 03031000
@RF00964 SLR   RCODE,RCODE                                         0966 03032000
*   PARMCNT=ZERO;                   /* SET PARAMETER COUNT TO ZERO   */ 03033000
         L     @14,ECDACNXT(,ECDAPTR)                              0967 03034000
         SLR   @08,@08                                             0967 03035000
         STCM  @08,3,PARMCNT(@14)                                  0967 03036000
*   LL=NINER;                       /* SET PREFIX LENGTH             */ 03037000
         MVC   LL(2,@14),@CH00171                                  0968 03038000
*   LINEPTR=ECDAIREC+FOUR;          /* POINTER TO DATA               */ 03039000
         LA    LINEPTR,4                                           0969 03040000
         AL    LINEPTR,ECDAIREC(,ECDAPTR)                          0969 03041000
*   LINCOUNT=(CMDADD+CMDLEN)        /* SET UP INDEX TO FIRST         */ 03042000
*       -LINEPTR+ONE;               /* CHARACTER AFTER CMD NAME      */ 03043000
         L     LINCOUNT,CMDADD                                     0970 03044000
         AL    LINCOUNT,CMDLEN                                     0970 03045000
         SLR   LINCOUNT,LINEPTR                                    0970 03046000
         AL    LINCOUNT,@CF00033                                   0970 03047000
*NXTPARM:                                                          0971 03048000
*   TRIP=ONE;                       /* USED FOR ERROR INDICATIONS    */ 03049000
NXTPARM  LA    @14,1                                               0971 03050000
         LR    TRIP,@14                                            0971 03051000
*   IF OC=OPGLOB THEN               /* GLOBAL ?                      */ 03052000
         L     @08,ECDACNXT(,ECDAPTR)                              0972 03053000
         CLI   OC(@08),255                                         0972 03054000
         BE    @RT00972                                            0972 03055000
*     GO TO GLOB2;                  /* BRANCH                        */ 03056000
*   IF PARMCNT+ONE>TWO56 THEN       /* CANNOT HAVE MORE THAN         */ 03057000
         ICM   @08,12,PARMCNT(@08)                                 0974 03058000
         SRA   @08,16                                              0974 03059000
         ALR   @14,@08                                             0974 03060000
         C     @14,@CF00479                                        0974 03061000
         BNH   @RF00974                                            0974 03062000
*     DO;                           /* 256 PARAMETERS ON READ CMD    */ 03063000
*       EXMSGID=M539;               /* ISSUE A MSG TO USER           */ 03064000
         MVC   EXMSGID(4),@CC00503                                 0976 03065000
*       STMT=ONS;                   /* STATEMENT NUMBER REQUIRED     */ 03066000
         OI    STMT,B'10000000'                                    0977 03067000
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */ 03068000
         BAL   @14,MSGRTN                                          0978 03069000
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */ 03070000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0979 03071000
*       RETURN CODE(ZERO);          /* RETURN                        */ 03072000
         SLR   @15,@15                                             0980 03073000
         L     @14,@SA00018                                        0980 03074000
         LM    @00,@03,@SA00018+8                                  0980 03075000
         LM    @05,@12,@SA00018+24                                 0980 03076000
         BR    @14                                                 0980 03077000
*     END;                                                         0981 03078000
*GLOB2:                                                            0982 03079000
*   X=ZERO;                         /* USED FOR AMPERSAND CHECKS     */ 03080000
@RF00974 DS    0H                                                  0982 03081000
GLOB2    SLR   X,X                                                 0982 03082000
*   IF LINCOUNT>RLENGTH THEN        /* AT END OF RECORD?             */ 03083000
         C     LINCOUNT,RLENGTH                                    0983 03084000
         BNH   @RF00983                                            0983 03085000
*     DO;                           /* YES--SET UP FOR MOVE RTN      */ 03086000
*MOVEOUT:                                                          0985 03087000
*       IF OC=OPGLOB THEN           /* GLOBAL                        */ 03088000
MOVEOUT  L     @14,ECDACNXT(,ECDAPTR)                              0985 03089000
         CLI   OC(@14),255                                         0985 03090000
         BNE   @RF00985                                            0985 03091000
*         RETURN CODE(RCODE) TO SPCLEXIT;/* RETURN                   */ 03092000
         LA    @14,SPCLEXIT                                        0986 03093000
         LR    @15,RCODE                                           0986 03094000
         LM    @00,@03,@SA00018+8                                  0986 03095000
         LM    @05,@12,@SA00018+24                                 0986 03096000
         BR    @14                                                 0986 03097000
*       DATAADD=LINEPTR;            /* ADDRESS OF DATA AND           */ 03098000
@RF00985 ST    LINEPTR,DATAADD                                     0987 03099000
*       DATALEN=RLENGTH;            /* LENGTH OF DATA TO BE MOVED    */ 03100000
         L     @14,RLENGTH                                         0988 03101000
         ST    @14,DATALEN                                         0988 03102000
*       O2O2=(LL-FOUR)+RLENGTH;     /* OFFSET TO END OF RECORD       */ 03103000
         L     @08,ECDACNXT(,ECDAPTR)                              0989 03104000
         LA    @06,4                                               0989 03105000
         LH    @05,LL(,@08)                                        0989 03106000
         SLR   @05,@06                                             0989 03107000
         ALR   @14,@05                                             0989 03108000
         STH   @14,O2O2(,@08)                                      0989 03109000
*       OO=(LL-FOUR)+(CMDADD-(ECDAIREC+FOUR));/* OFFSET TO R IN READ */ 03110000
         AL    @06,ECDAIREC(,ECDAPTR)                              0990 03111000
         LCR   @06,@06                                             0990 03112000
         AL    @06,CMDADD                                          0990 03113000
         ALR   @05,@06                                             0990 03114000
         STH   @05,OO(,@08)                                        0990 03115000
*       IF CMDLEN=EIGHT THEN        /* IF READ DVAL                  */ 03116000
         CLC   CMDLEN(4),@CF00088                                  0991 03117000
         BNE   @RF00991                                            0991 03118000
*         OC=OPSXTEEN;              /* OP 16                         */ 03119000
         MVI   OC(@08),X'10'                                       0992 03120000
*       ELSE                        /* OTHERWISE THE OP CODE IS 12   */ 03121000
*         OC=OP12;                                                 0993 03122000
         B     @RC00991                                            0993 03123000
@RF00991 L     @14,ECDACNXT(,ECDAPTR)                              0993 03124000
         MVI   OC(@14),X'0C'                                       0993 03125000
*       RETURN CODE(RCODE) TO COMNEXIT;/* RETURN VIA COMMON EXIT     */ 03126000
@RC00991 LA    @14,COMNEXIT                                        0994 03127000
         LR    @15,RCODE                                           0994 03128000
         LM    @00,@03,@SA00018+8                                  0994 03129000
         LM    @05,@12,@SA00018+24                                 0994 03130000
         BR    @14                                                 0994 03131000
*     END;                                                         0995 03132000
*   COUNT=LINCOUNT;                 /* SET UP FOR CHARCHK ROUTINE    */ 03133000
@RF00983 LR    COUNT,LINCOUNT                                      0996 03134000
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */ 03135000
         BAL   @14,FINDPARM                                        0997 03136000
*   IF LINCOUNT>RLENGTH THEN                                       0998 03137000
         C     LINCOUNT,RLENGTH                                    0998 03138000
         BH    @RT00998                                            0998 03139000
*     GOTO MOVEOUT;                 /* PARM NOT FOUND                */ 03140000
*   PARMADR=ADDR(LINE(LINCOUNT));   /* NO--SAVE ADDRESS OF PARM      */ 03141000
         LR    @14,LINEPTR                                         1000 03142000
         BCTR  @14,0                                               1000 03143000
         LA    @14,LINE(LINCOUNT,@14)                              1000 03144000
         ST    @14,PARMADR                                         1000 03145000
*   IF AMPERSND=ON THEN             /* IF FIRST CHARACTER IS AN      */ 03146000
         TM    AMPERSND,B'00001000'                                1001 03147000
         BNO   @RF01001                                            1001 03148000
*     DO;                           /* AMPERSAND THEN INDICATE SO.   */ 03149000
*       X=OPGLOB;                   /* BY SETTING WORK BYTE AND GO   */ 03150000
         LA    X,255                                               1003 03151000
*       GOTO NXTCHR;                /* CHECK NEXT CHARACTER.         */ 03152000
         B     NXTCHR                                              1004 03153000
*     END;                                                         1005 03154000
*   IF ALPHA=OFF THEN               /* IS FIRST CHARACTER ALPHA.?    */ 03155000
@RF01001 TM    ALPHA,B'10000000'                                   1006 03156000
         BNZ   @RF01006                                            1006 03157000
*     DO;                           /* NO--                          */ 03158000
*BADCHR:                                                           1008 03159000
*       X=ZERO;                     /* ISSUE A MESSAGE               */ 03160000
BADCHR   SLR   X,X                                                 1008 03161000
*       COUNT=LINCOUNT;             /* CHARACTER INDEX               */ 03162000
         LR    COUNT,LINCOUNT                                      1009 03163000
*       CALL FINDEND;               /* FIND END OF PARM              */ 03164000
         BAL   @14,FINDEND                                         1010 03165000
*       LINCOUNT=COUNT+ONE;         /* INCREMENT PAST END OF PARM    */ 03166000
         LA    LINCOUNT,1                                          1011 03167000
         ALR   LINCOUNT,COUNT                                      1011 03168000
*       EXMSGID=B540;               /* INVALID PARM MSG              */ 03169000
         MVC   EXMSGID(4),@CC00507                                 1012 03170000
*BADCHR2:                                                          1013 03171000
*       STMT=ONS;                   /* STMT SWITCH ON                */ 03172000
BADCHR2  OI    STMT,B'10000000'                                    1013 03173000
*       MVAR(2)=PARMADR;            /* ADDR OF MSG VARIABLE          */ 03174000
         L     @14,PARMADR                                         1014 03175000
         ST    @14,MVAR+4                                          1014 03176000
*       MVARLEN(2)=ADDR(LINE(LINCOUNT))-PARMADR;/* LENGTH            */ 03177000
         LR    @08,LINEPTR                                         1015 03178000
         BCTR  @08,0                                               1015 03179000
         LA    @08,LINE(LINCOUNT,@08)                              1015 03180000
         SLR   @08,@14                                             1015 03181000
         STC   @08,MVARLEN+4                                       1015 03182000
*       IF ADDR(LINE(LINCOUNT))-PARMADR>ONE27 THEN/* TRUNCATE LEN    */ 03183000
         C     @08,@CF00475                                        1016 03184000
         BNH   @RF01016                                            1016 03185000
*         MVARLEN(2)=ONE27;         /* LENGTH                        */ 03186000
         MVI   MVARLEN+4,X'7F'                                     1017 03187000
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */ 03188000
@RF01016 BAL   @14,MSGRTN                                          1018 03189000
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */ 03190000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1019 03191000
*       GOTO NXTPARM;               /* LOOK FOR NEXT PARM            */ 03192000
         B     NXTPARM                                             1020 03193000
*     END;                                                         1021 03194000
*   IF LINCOUNT=RLENGTH THEN        /* IF AT END OF BFR              */ 03195000
@RF01006 C     LINCOUNT,RLENGTH                                    1022 03196000
         BNE   @RF01022                                            1022 03197000
*     DO;                           /*                               */ 03198000
*       PARMLNG=ONE;                /* SET PARMLNG = 1               */ 03199000
         LA    @14,1                                               1024 03200000
         ST    @14,PARMLNG                                         1024 03201000
*       LINCOUNT=LINCOUNT+ONE;      /* UPDATE PAST BUFFER END        */ 03202000
         ALR   LINCOUNT,@14                                        1025 03203000
*       GO TO PARMEND;              /* FINI                          */ 03204000
         B     PARMEND                                             1026 03205000
*     END;                          /*                               */ 03206000
*NXTCHR:                                                           1028 03207000
*   LINCOUNT=LINCOUNT+ONE;          /* GET NEXT CHARACTER INDEX      */ 03208000
@RF01022 DS    0H                                                  1028 03209000
NXTCHR   AL    LINCOUNT,@CF00033                                   1028 03210000
*   IF LINCOUNT>RLENGTH THEN        /* AT END OF RECORD?             */ 03211000
         C     LINCOUNT,RLENGTH                                    1029 03212000
         BH    @RT01029                                            1029 03213000
*     GOTO MOVEOUT;                 /* YES---LEAVE                   */ 03214000
*   COUNT=LINCOUNT;                 /* SET UP FOR CHARCHK ROUTINE    */ 03215000
         LR    COUNT,LINCOUNT                                      1031 03216000
*   CALL CHARCHK;                   /* CALL CHARCHK ROUTINE          */ 03217000
         BAL   @14,CHARCHK                                         1032 03218000
*   IF X=OPGLOB&ALPHA=OFF THEN      /* FIRST CHAR AMPERSAND AND      */ 03219000
         C     X,@CF00374                                          1033 03220000
         BNE   @RF01033                                            1033 03221000
         TM    ALPHA,B'10000000'                                   1033 03222000
         BZ    @RT01033                                            1033 03223000
*     GOTO BADCHR;                  /* SECOND NOT ALPHA?--ERROR      */ 03224000
*   X=ZERO;                         /* TURN OFF I FOR REST OF CHKS   */ 03225000
@RF01033 SLR   X,X                                                 1035 03226000
*   IF SEPAR=ON|SLASH=ON THEN       /* IF A SEPERATOR                */ 03227000
         TM    SEPAR,B'00000110'                                   1036 03228000
         BNZ   @RT01036                                            1036 03229000
*     GO TO FOUND;                  /* PROCESS THIS VARIABLE         */ 03230000
*   IF NALPHNUM=ON THEN             /* IF CHARACTER IS NOT ALPHA-    */ 03231000
         TM    NALPHNUM,B'00000001'                                1038 03232000
         BO    @RT01038                                            1038 03233000
*     GOTO BADCHR;                  /* NUMERIC THEN IT IS AN ERROR   */ 03234000
*   IF RLENGTH^=LINCOUNT THEN                                      1040 03235000
         C     LINCOUNT,RLENGTH                                    1040 03236000
         BNE   @RT01040                                            1040 03237000
*     GOTO NXTCHR;                  /* NO--CHECK NEXT CHARACTER.     */ 03238000
*   LINCOUNT=LINCOUNT+ONE;          /* INCREMENT PAST END            */ 03239000
         AL    LINCOUNT,@CF00033                                   1042 03240000
*FOUND:                                                            1043 03241000
*   SAVEPTR=ADDR(LINE(LINCOUNT));   /* YES--COMPUTE LENGTH OF PARM   */ 03242000
FOUND    LR    SAVEPTR,LINEPTR                                     1043 03243000
         BCTR  SAVEPTR,0                                           1043 03244000
         LA    SAVEPTR,LINE(LINCOUNT,SAVEPTR)                      1043 03245000
*   PARMLNG=SAVEPTR-PARMADR;        /* SET UP FOR SYNTAB RTN--WITH   */ 03246000
         L     @14,PARMADR                                         1044 03247000
         LR    @08,SAVEPTR                                         1044 03248000
         SLR   @08,@14                                             1044 03249000
         ST    @08,PARMLNG                                         1044 03250000
*   IF PARMADR->LINE(1)=AMPER THEN  /* IF VARIABLE STARTS WITH &     */ 03251000
         CLI   LINE(@14),C'&&'                                     1045 03252000
         BNE   @RF01045                                            1045 03253000
*     DO;                           /* UPDATE SYNTAM PARMS           */ 03254000
*       PARMADR=PARMADR+ONE;        /* UP ONE                        */ 03255000
         AL    @14,@CF00033                                        1047 03256000
         ST    @14,PARMADR                                         1047 03257000
*       PARMLNG=PARMLNG-ONE;        /* DOWN ONE                      */ 03258000
         BCTR  @08,0                                               1048 03259000
         ST    @08,PARMLNG                                         1048 03260000
*     END;                                                         1049 03261000
*   IF(OC^=OPGLOB&PARMLNG>TWO52)|   /* CHECK FOR INVALID LENGTHS OF  */ 03262000
*       (OC=OPGLOB&PARMLNG>THIRTY1) THEN/* SYMPARMS ON GLOBAL AND    */ 03263000
@RF01045 L     @14,ECDACNXT(,ECDAPTR)                              1050 03264000
         CLI   OC(@14),255                                         1050 03265000
         BE    @GL00028                                            1050 03266000
         L     @14,PARMLNG                                         1050 03267000
         C     @14,@CF00473                                        1050 03268000
         BH    @RT01050                                            1050 03269000
@GL00028 L     @14,ECDACNXT(,ECDAPTR)                              1050 03270000
         CLI   OC(@14),255                                         1050 03271000
         BNE   @RF01050                                            1050 03272000
         L     @14,PARMLNG                                         1050 03273000
         C     @14,@CF00041                                        1050 03274000
         BNH   @RF01050                                            1050 03275000
@RT01050 DS    0H                                                  1051 03276000
*     DO;                           /* READ COMMANDS                 */ 03277000
*       EXMSGID=A540;               /* MESSAGE ID                    */ 03278000
         MVC   EXMSGID(4),@CC00505                                 1052 03279000
*       GOTO BADCHR2;               /* GO ISSUE MESSAGE              */ 03280000
         B     BADCHR2                                             1053 03281000
*     END;                                                         1054 03282000
*PARMEND:                                                          1055 03283000
*   IF OC=OPGLOB THEN               /* GLOBAL PROCESSING ?           */ 03284000
@RF01050 DS    0H                                                  1055 03285000
PARMEND  L     @14,ECDACNXT(,ECDAPTR)                              1055 03286000
         CLI   OC(@14),255                                         1055 03287000
         BNE   @RF01055                                            1055 03288000
*     PARMTYPE=GLOBAL;              /* YES - SET PARMTYPE TO 2       */ 03289000
         MVC   PARMTYPE(2),@CH00074                                1056 03290000
*   ELSE                            /* NO - SET PARMTYPE TO ZERO     */ 03291000
*     PARMTYPE=KEYW;                /* LENGTH AND POINTER TO PARM    */ 03292000
         B     @RC01055                                            1057 03293000
@RF01055 MVC   PARMTYPE(2),@CH00250                                1057 03294000
*   CALL SYNTAB(NTUPTPRM);          /* CALL SYNTAB                   */ 03295000
@RC01055 LA    @14,NTUPTPRM                                        1058 03296000
         ST    @14,@AL00001                                        1058 03297000
         LA    @01,@AL00001                                        1058 03298000
         BAL   @14,SYNTAB                                          1058 03299000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 03300000
         LR    RCODE,R15                                           1059 03301000
*   IF RCODE^=ZERO THEN             /* NON-ZERO RETURN CODE?         */ 03302000
         LTR   RCODE,RCODE                                         1060 03303000
         BZ    @RF01060                                            1060 03304000
*     DO;                           /* YES-- ISSUE MESSAGE           */ 03305000
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */ 03306000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1062 03307000
*       GOTO NXTPARM;               /* GO LOOK FOR NEXT PARM         */ 03308000
         B     NXTPARM                                             1063 03309000
*     END;                                                         1064 03310000
*   IF OC=OPGLOB THEN               /* GLOBAL ?                      */ 03311000
@RF01060 L     @14,ECDACNXT(,ECDAPTR)                              1065 03312000
         CLI   OC(@14),255                                         1065 03313000
         BE    @RT01065                                            1065 03314000
*     GO TO NXTPARM;                /* GET NEXT PARM                 */ 03315000
*   DATAADD=ADDR(PARMRADR);         /* SET UP FOR MOVE OF @ OF       */ 03316000
         LA    @14,PARMRADR                                        1067 03317000
         ST    @14,DATAADD                                         1067 03318000
*   DATALEN=FOUR;                   /* SYNTAB ELEMENT TO STORAGE     */ 03319000
         MVC   DATALEN(4),@CF00072                                 1068 03320000
*   CALL MOVERTN;                   /* RECORD. CALL MOVE ROUTINE     */ 03321000
         BAL   @14,MOVERTN                                         1069 03322000
*   RCODE=R15;                      /* SAVE RETURN CODE              */ 03323000
         LR    RCODE,R15                                           1070 03324000
*   IF RCODE^=ZERO THEN             /* NON-ZERO RETURN CODE?         */ 03325000
         LTR   RCODE,RCODE                                         1071 03326000
         BZ    @RF01071                                            1071 03327000
*     DO;                           /* YES ISSUE MESSAGE             */ 03328000
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */ 03329000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1073 03330000
*       GOTO NXTPARM;               /* GO CHECK NEXT PARM            */ 03331000
         B     NXTPARM                                             1074 03332000
*     END;                                                         1075 03333000
*   PARMCNT=PARMCNT+ONE;            /* INCREMENT PARM COUNT BY 1     */ 03334000
@RF01071 L     @14,ECDACNXT(,ECDAPTR)                              1076 03335000
         LA    @08,1                                               1076 03336000
         ICM   @06,12,PARMCNT(@14)                                 1076 03337000
         SRA   @06,16                                              1076 03338000
         ALR   @08,@06                                             1076 03339000
         STCM  @08,3,PARMCNT(@14)                                  1076 03340000
*   GOTO NXTPARM;                   /* GO CHECK NEXT PARAMETER       */ 03341000
         B     NXTPARM                                             1077 03342000
*   END READCMD;                                                   1078 03343000
*SYNTAB:                                                           1079 03344000
*   PROC;                                                          1079 03345000
*                                                                  1079 03346000
SYNTAB   STM   @14,@12,@SA00019                                    1079 03347000
*/********************************************************************/ 03348000
*/*                                                                  */ 03349000
*/*     SYNTAB ROUTINE                                               */ 03350000
*/*                                                                  */ 03351000
*/********************************************************************/ 03352000
*                                                                  1080 03353000
*   PARMRADR=CON0;                  /* ZERO ELEMENT RETURN ADDR      */ 03354000
         SLR   @14,@14                                             1080 03355000
         ST    @14,PARMRADR                                        1080 03356000
*   SNTABPTR=SNTABFST;              /* SET BASE TO FIRST SNTAB       */ 03357000
         L     @14,ECDALSD(,ECDAPTR)                               1081 03358000
         L     @14,LSDEXEC(,@14)                                   1081 03359000
         L     SNTABPTR,SNTABFST(,@14)                             1081 03360000
*   SVTABPTR=SVTABFST;              /* AND SVTAB                     */ 03361000
         L     @14,SVTABFST(,@14)                                  1082 03362000
         ST    @14,SVTABPTR                                        1082 03363000
*   SNTELPTR=SNTABPTR+LENGTH(SNTAB);/* ELEMENT PTR                   */ 03364000
         LA    SNTELPTR,12                                         1083 03365000
         ALR   SNTELPTR,SNTABPTR                                   1083 03366000
*   ENDPTR=ECDALNEL+ECDALNEL->SNTLNG+LENGTH(SNTELEM);/* FIND END OF     03367000
*                                      CURRENT SNTAB                 */ 03368000
*                                                                  1084 03369000
         L     @14,ECDALNEL(,ECDAPTR)                              1084 03370000
         LH    ENDPTR,SNTLNG(,@14)                                 1084 03371000
         ALR   ENDPTR,@14                                          1084 03372000
         AL    ENDPTR,@CF00088                                     1084 03373000
*   /*****************************************************************/ 03374000
*   /*                                                               */ 03375000
*   /* DETERMINE IF SYBMOLIC PARAMETER IS ALREADY DEFINED            */ 03376000
*   /*                                                               */ 03377000
*   /*****************************************************************/ 03378000
*                                                                  1085 03379000
*   CYCLE=CON1;                     /* INDICATOR                     */ 03380000
         LA    CYCLE,1                                             1085 03381000
*   DO WHILE SNTELPTR^=ENDPTR&CYCLE=CON1;/* DO WHILE                 */ 03382000
         B     @DE01086                                            1086 03383000
@DL01086 DS    0H                                                  1087 03384000
*     IF SNTLNG=PARMLNG&            /* IF THE CURRENT ELEMENT IS     */ 03385000
*         SNTDATA(1:SNTLNG)=PARMDAT(1:SNTLNG) THEN/* THE SAME LENGTH,   03386000
*                                      CHECK THE NAME - WHEN EQUAL   */ 03387000
         LH    @14,SNTLNG(,SNTELPTR)                               1087 03388000
         C     @14,PARMLNG                                         1087 03389000
         BNE   @RF01087                                            1087 03390000
         BCTR  @14,0                                               1087 03391000
         L     @08,PARMADR                                         1087 03392000
         EX    @14,@SC00865                                        1087 03393000
         BNE   @RF01087                                            1087 03394000
*       CYCLE=CON0;                 /* TERMINATE THE LOOP            */ 03395000
         SLR   CYCLE,CYCLE                                         1088 03396000
*     ELSE                          /* UPDATE TO THE NEXT SNTAB ELMT */ 03397000
*                                                                  1089 03398000
*       /*************************************************************/ 03399000
*       /*                                                           */ 03400000
*       /* UPDATE TO NEXT SNTAB ELEMENT                              */ 03401000
*       /*                                                           */ 03402000
*       /*************************************************************/ 03403000
*                                                                  1089 03404000
*       IF SNTLAST=ON THEN          /* IF THIS IS LAST ELEMENT IN    */ 03405000
         B     @RC01087                                            1089 03406000
@RF01087 TM    SNTLAST(SNTELPTR),B'00000001'                       1089 03407000
         BNO   @RF01089                                            1089 03408000
*         DO;                       /* THIS SNTAB THE LOCATE NEXT    */ 03409000
*           SNTABPTR=SNTABNXT;      /* TABLE AND ITS FIRST ELEMENT   */ 03410000
         L     SNTABPTR,SNTABNXT(,SNTABPTR)                        1091 03411000
*           SNTELPTR=SNTABPTR+LENGTH(SNTAB);/* ELEMENT PTR           */ 03412000
         LA    SNTELPTR,12                                         1092 03413000
         ALR   SNTELPTR,SNTABPTR                                   1092 03414000
*         END;                                                     1093 03415000
*       ELSE                        /* OTHERWISE GET NEXT ELEMENT    */ 03416000
*         SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);/* ELEMENT PTR    */ 03417000
         B     @RC01089                                            1094 03418000
@RF01089 LR    @14,SNTELPTR                                        1094 03419000
         AH    @14,SNTLNG(,SNTELPTR)                               1094 03420000
         AL    @14,@CF00088                                        1094 03421000
         LR    SNTELPTR,@14                                        1094 03422000
*   END;                                                           1095 03423000
@RC01089 DS    0H                                                  1095 03424000
@RC01087 DS    0H                                                  1095 03425000
@DE01086 CR    SNTELPTR,ENDPTR                                     1095 03426000
         BE    @DC01086                                            1095 03427000
         C     CYCLE,@CF00033                                      1095 03428000
         BE    @DL01086                                            1095 03429000
@DC01086 DS    0H                                                  1096 03430000
*   IF CYCLE=CON0 THEN              /* IF THE PARM WAS ALREADY       */ 03431000
         LTR   CYCLE,CYCLE                                         1096 03432000
         BNZ   @RF01096                                            1096 03433000
*     DO;                           /* DEFINED AND WE ARE CALLED     */ 03434000
*       IF PARMTYPE^=KEYW THEN      /* PLACE A LABEL OR A GLOBAL     */ 03435000
         LH    @14,PARMTYPE                                        1098 03436000
         C     @14,@CF00250                                        1098 03437000
         BE    @RF01098                                            1098 03438000
*         DO;                       /* IN THE SNTAB THEN IT IS AN  1099 03439000
*                                      ERROR---ISSUE MESSAGE, RETURN */ 03440000
*           STMT=ONS;               /* STATEMENT NUMBER REQUITED     */ 03441000
         OI    STMT,B'10000000'                                    1100 03442000
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */ 03443000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1101 03444000
*           IF PARMTYPE=LABL THEN   /* IF LABEL WAS SEARCH ARGUMNT   */ 03445000
         C     @14,@CF00033                                        1102 03446000
         BNE   @RF01102                                            1102 03447000
*             EXMSGID=M531;         /* USE MESSAGE IKJ56531          */ 03448000
         MVC   EXMSGID(4),@CC00485                                 1103 03449000
*           ELSE                    /* OTHERWISE USE GLOBAL MESSAGE  */ 03450000
*             EXMSGID=A530;         /* MSG ID                        */ 03451000
         B     @RC01102                                            1104 03452000
@RF01102 MVC   EXMSGID(4),@CC00487                                 1104 03453000
*           MVAR(2)=PARMADR;        /* ADDR OF MSG VARIABLE          */ 03454000
@RC01102 L     @14,PARMADR                                         1105 03455000
         ST    @14,MVAR+4                                          1105 03456000
*           MVARLEN(2)=PARMLNG;     /* LENGTH OF MSG VARIABLE        */ 03457000
         L     @14,PARMLNG                                         1106 03458000
         STC   @14,MVARLEN+4                                       1106 03459000
*           CALL MSGRTN;            /* CALL MSG RTN                  */ 03460000
         BAL   @14,MSGRTN                                          1107 03461000
*         END;                                                     1108 03462000
*       ELSE                        /* IF CALLED ONLY TO LOCATE A    */ 03463000
*         PARMRADR=SNTELPTR;        /* SYMBOLIC PARM THEN RETURN     */ 03464000
         B     @RC01098                                            1109 03465000
@RF01098 ST    SNTELPTR,PARMRADR                                   1109 03466000
*       RETURN CODE(CON0);          /* WITH ITS ADDRESS              */ 03467000
@RC01098 SLR   @15,@15                                             1110 03468000
         L     @14,@SA00019                                        1110 03469000
         LM    @00,@12,@SA00019+8                                  1110 03470000
         BR    @14                                                 1110 03471000
*     END;                                                         1111 03472000
*   ELSE                            /* ELSE                          */ 03473000
*     IF PARMLNG>THIRTY1 THEN       /* NEW PARMS CANNOT BE GREATER   */ 03474000
@RF01096 L     @14,PARMLNG                                         1112 03475000
         C     @14,@CF00041                                        1112 03476000
         BNH   @RF01112                                            1112 03477000
*       DO;                         /* THAN 31 - IF SO ISSUE         */ 03478000
*         STMT=ONS;                 /* MESSAGE AND RETURN            */ 03479000
         OI    STMT,B'10000000'                                    1114 03480000
*         MVAR(2)=PARMADR;          /* PTR TO MSG VARIABLE           */ 03481000
         L     @08,PARMADR                                         1115 03482000
         ST    @08,MVAR+4                                          1115 03483000
*         IF PARMLNG>ONE27 THEN     /* TRUNCATE LEN TO 127           */ 03484000
         C     @14,@CF00475                                        1116 03485000
         BNH   @RF01116                                            1116 03486000
*           MVARLEN(2)=ONE27;       /* LENGTH OF MSG VARIABLE        */ 03487000
         MVI   MVARLEN+4,X'7F'                                     1117 03488000
*         ELSE                      /* OTHERWISE USE THE PARM LEN    */ 03489000
*           MVARLEN(2)=PARMLNG;     /* LENGTH OF MSG VARIABLE        */ 03490000
         B     @RC01116                                            1118 03491000
@RF01116 L     @14,PARMLNG                                         1118 03492000
         STC   @14,MVARLEN+4                                       1118 03493000
*         NOTEXEC=ONS;              /* SET PROC NOT EXECUTABLE       */ 03494000
@RC01116 OI    NOTEXEC(ECDAPTR),B'01000000'                        1119 03495000
*         EXMSGID=C540;             /* MSG ID                        */ 03496000
         MVC   EXMSGID(4),@CC00511                                 1120 03497000
*         CALL MSGRTN;              /* CALL MSG RTN                  */ 03498000
         BAL   @14,MSGRTN                                          1121 03499000
*         RETURN CODE(CON0);        /* RETURN                        */ 03500000
         SLR   @15,@15                                             1122 03501000
         L     @14,@SA00019                                        1122 03502000
         LM    @00,@12,@SA00019+8                                  1122 03503000
         BR    @14                                                 1122 03504000
*       END;                                                       1123 03505000
*                                                                  1123 03506000
*   /*****************************************************************/ 03507000
*   /*                                                               */ 03508000
*   /* IF NAME WAS NOT IN SYNTAB THEN CREATE AN ENTRY                */ 03509000
*   /*                                                               */ 03510000
*   /*****************************************************************/ 03511000
*                                                                  1124 03512000
*   IF NOTEXEC=OFF THEN             /* IF NO ERRORS YET, CONTINUE    */ 03513000
@RF01112 TM    NOTEXEC(ECDAPTR),B'01000000'                        1124 03514000
         BNZ   @RF01124                                            1124 03515000
*     DO;                           /* WITH A TABLE UPDATE           */ 03516000
*       IF((PARMTYPE^=GLOBAL&SNTABLNG-SNTABUSE<PARMLNG+LENGTH(SNTELEM)) 03517000
*           |(PARMTYPE=GLOBAL&NESTED=ON&SNTABLNG-SNTABUSE<PARMLNG+ 1126 03518000
*           LENGTH(SNTELEM))|(PARMTYPE=GLOBAL&NESTED=OFF&SNTABLNG- 1126 03519000
*           SNTABUSE<PARMLNG+LENGTH(ECDAGCNT)+LENGTH(SNTELEM)*TWO))     03520000
*         THEN                                                     1126 03521000
         CLC   PARMTYPE(2),@CH00074                                1126 03522000
         BE    @GL00034                                            1126 03523000
         L     @14,SNTABLNG(,SNTABPTR)                             1126 03524000
         SL    @14,SNTABUSE(,SNTABPTR)                             1126 03525000
         LA    @08,8                                               1126 03526000
         AL    @08,PARMLNG                                         1126 03527000
         CR    @14,@08                                             1126 03528000
         BL    @RT01126                                            1126 03529000
@GL00034 CLC   PARMTYPE(2),@CH00074                                1126 03530000
         BNE   @GL00033                                            1126 03531000
         TM    NESTED(ECDAPTR),B'00000010'                         1126 03532000
         BNO   @GL00033                                            1126 03533000
         L     @14,SNTABLNG(,SNTABPTR)                             1126 03534000
         SL    @14,SNTABUSE(,SNTABPTR)                             1126 03535000
         LA    @08,8                                               1126 03536000
         AL    @08,PARMLNG                                         1126 03537000
         CR    @14,@08                                             1126 03538000
         BL    @RT01126                                            1126 03539000
@GL00033 CLC   PARMTYPE(2),@CH00074                                1126 03540000
         BNE   @RF01126                                            1126 03541000
         TM    NESTED(ECDAPTR),B'00000010'                         1126 03542000
         BNZ   @RF01126                                            1126 03543000
         L     @14,SNTABLNG(,SNTABPTR)                             1126 03544000
         SL    @14,SNTABUSE(,SNTABPTR)                             1126 03545000
         LA    @08,20                                              1126 03546000
         AL    @08,PARMLNG                                         1126 03547000
         CR    @14,@08                                             1126 03548000
         BNL   @RF01126                                            1126 03549000
@RT01126 DS    0H                                                  1127 03550000
*         DO;                       /* DO GROUP                      */ 03551000
*           ECDALNEL->SNTLAST=ON;   /* IF NO SPACE IS AVAILABLE IN   */ 03552000
         L     @14,ECDALNEL(,ECDAPTR)                              1128 03553000
         OI    SNTLAST(@14),B'00000001'                            1128 03554000
*           FREEADR=(SNTABPTR+SNTABUSE/* PRESENT THEN GET A NEW TAB  */ 03555000
*               +SEVEN)/EIGHT*EIGHT;/*                               */ 03556000
         L     @14,SNTABUSE(,SNTABPTR)                             1129 03557000
         LR    @00,SNTABPTR                                        1129 03558000
         ALR   @00,@14                                             1129 03559000
         AL    @00,@CF00149                                        1129 03560000
         SRDA  @00,32                                              1129 03561000
         D     @00,@CF00088                                        1129 03562000
         SLA   @01,3                                               1129 03563000
         ST    @01,FREEADR                                         1129 03564000
*           FREEAMT=SNTABPTR+SNTABLNG-FREEADR;/*                     */ 03565000
         LR    FREEAMT,SNTABPTR                                    1130 03566000
         AL    FREEAMT,SNTABLNG(,SNTABPTR)                         1130 03567000
         SLR   FREEAMT,@01                                         1130 03568000
*           SNTABLNG=SNTABUSE;      /*                               */ 03569000
         ST    @14,SNTABLNG(,SNTABPTR)                             1131 03570000
*           DO;                     /* FREEMAIN (E) LV(FREEAMT)    1132 03571000
*                                      A(FREEADR) SP(78)             */ 03572000
*             RESPECIFY                                            1133 03573000
*              (GPR01P) RESTRICTED;                                1133 03574000
*             I005=I005&&I005;      /* INIT LIST                     */ 03575000
         XC    I005(10),I005                                       1134 03576000
*             I00505='00'X;         /* SET TYPE                      */ 03577000
         MVI   I00505,X'00'                                        1135 03578000
*             I00502=FREEAMT;       /* LENGTH                        */ 03579000
         STCM  FREEAMT,7,I00502                                    1136 03580000
*             I00504=ADDR(FREEADR); /* ADDR OF ADDR LIST             */ 03581000
         LA    @14,FREEADR                                         1137 03582000
         STCM  @14,7,I00504                                        1137 03583000
*             I00506=78;            /* SUBPOOL VALUE                 */ 03584000
         MVI   I00506,X'4E'                                        1138 03585000
*             GPR01P=ADDR(I005);    /* REG1 POINTS TO LIST           */ 03586000
         LA    GPR01P,I005                                         1139 03587000
*             SVC(5);               /* STANDARD-FORM OF GETMAIN      */ 03588000
         SVC   5                                                   1140 03589000
*             RESPECIFY                                            1141 03590000
*              (GPR01P) UNRESTRICTED;                              1141 03591000
*           END;                    /* FREEMAIN (E) LV(FREEAMT)    1142 03592000
*                                      A(FREEADR) SP(78) FREEMAIN    */ 03593000
*           GETAMT=(SNTABLNG+FREEAMT+LENGTH(SNTELEM)*TWO+PARMLNG+LENGTH 03594000
*               (ECDAGCNT)+SEVEN)/EIGHT*EIGHT;/* AMOUNT              */ 03595000
         LR    @00,FREEAMT                                         1143 03596000
         AL    @00,SNTABLNG(,SNTABPTR)                             1143 03597000
         AL    @00,@CF00191                                        1143 03598000
         AL    @00,PARMLNG                                         1143 03599000
         AL    @00,@CF00392                                        1143 03600000
         SRDA  @00,32                                              1143 03601000
         D     @00,@CF00088                                        1143 03602000
         SLA   @01,3                                               1143 03603000
         LR    GETAMT,@01                                          1143 03604000
*           RFY                                                    1144 03605000
*             R15 RSTD;             /* RESTRICT R15                  */ 03606000
*           DO;                     /* GETMAIN (EC) LV(GETAMT)     1145 03607000
*                                      A(GETADR) SP(78)              */ 03608000
*             RESPECIFY                                            1146 03609000
*              (GPR01P) RESTRICTED;                                1146 03610000
*             I004=I004&&I004;      /* INIT LIST                     */ 03611000
         XC    I004(10),I004                                       1147 03612000
*             I00404='20'X;         /* TYPE                          */ 03613000
         MVI   I00404,X'20'                                        1148 03614000
*             I00401=GETAMT;        /* LENGTH                        */ 03615000
         ST    GETAMT,I00401                                       1149 03616000
*             I00403=ADDR(GETADR);  /* ADDR OF ADDR LIST             */ 03617000
         LA    @14,GETADR                                          1150 03618000
         STCM  @14,7,I00403                                        1150 03619000
*             I00405=78;            /* SUBPOOL VALUE                 */ 03620000
         MVI   I00405,X'4E'                                        1151 03621000
*             GPR01P=ADDR(I004);    /* REG1 POINTS TO LIST           */ 03622000
         LA    GPR01P,I004                                         1152 03623000
*             SVC(4);               /* STANDARD-FORM OF GETMAIN      */ 03624000
         SVC   4                                                   1153 03625000
*             RESPECIFY                                            1154 03626000
*              (GPR01P) UNRESTRICTED;                              1154 03627000
*           END;                    /* GETMAIN (EC) LV(GETAMT)     1155 03628000
*                                      A(GETADR) SP(78) GETMAIN      */ 03629000
*           IF R15^=CON0 THEN       /* IF GETMAIN FAILS THEN         */ 03630000
         LTR   R15,R15                                             1156 03631000
         BZ    @RF01156                                            1156 03632000
*             DO;                   /* NOTIFY USER AND RETURN        */ 03633000
*               RFY                                                1158 03634000
*                 R15 UNRSTD;       /* RELEASE R15                   */ 03635000
*               EXMSGID=M511;       /* MSG ID                        */ 03636000
         MVC   EXMSGID(4),@CC00481                                 1159 03637000
*               NOTEXEC=ON;         /* SET PROC NOT EXECUTABLE       */ 03638000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1160 03639000
*               CALL MSGRTN;        /* CALL MSGRTN                   */ 03640000
         BAL   @14,MSGRTN                                          1161 03641000
*               RETURN CODE(CON16); /* RETURN                        */ 03642000
         LA    @15,16                                              1162 03643000
         L     @14,@SA00019                                        1162 03644000
         LM    @00,@12,@SA00019+8                                  1162 03645000
         BR    @14                                                 1162 03646000
*             END;                                                 1163 03647000
*           GETADR->SNTABNXT=CON0;  /* ADDR OF NEXT TABLE            */ 03648000
@RF01156 L     @06,GETADR                                          1164 03649000
         SLR   @05,@05                                             1164 03650000
         ST    @05,SNTABNXT(,@06)                                  1164 03651000
*           GETADR->SNTABLNG=GETAMT;/* AMOUNT OF GOTTEN CORE         */ 03652000
         ST    GETAMT,SNTABLNG(,@06)                               1165 03653000
*           GETADR->SNTABUSE=LENGTH(SNTAB);/* LENGTH OF TABLE        */ 03654000
         LA    @08,12                                              1166 03655000
         ST    @08,SNTABUSE(,@06)                                  1166 03656000
*           SNTABNXT=GETADR;        /* ADDR OF NEXT TABLE            */ 03657000
         ST    @06,SNTABNXT(,SNTABPTR)                             1167 03658000
*           SNTABPTR=SNTABNXT;      /* PTR TO NEXT TABLE             */ 03659000
         LR    SNTABPTR,@06                                        1168 03660000
*           SNTELPTR=SNTABPTR+LENGTH(SNTAB);/* ELEMENT PTR           */ 03661000
         ALR   @08,SNTABPTR                                        1169 03662000
         LR    SNTELPTR,@08                                        1169 03663000
*         END;                                                     1170 03664000
*                                                                  1170 03665000
*       /*************************************************************/ 03666000
*       /*                                                           */ 03667000
*       /* PLACE NAME OF PARAMETER IN SNTAB                          */ 03668000
*       /*                                                           */ 03669000
*       /*************************************************************/ 03670000
*                                                                  1171 03671000
*       SNTFLAGS=SNTFLAGS&&SNTFLAGS;/* FLAGS                         */ 03672000
@RF01126 XC    SNTFLAGS(2,SNTELPTR),SNTFLAGS(SNTELPTR)             1171 03673000
*       SNTDATA(1:PARMLNG)=PARMDAT(1:PARMLNG);/* DATA                */ 03674000
         L     @08,PARMLNG                                         1172 03675000
         LR    @06,@08                                             1172 03676000
         BCTR  @06,0                                               1172 03677000
         L     @05,PARMADR                                         1172 03678000
         EX    @06,@SM00867                                        1172 03679000
*       SNTLNG=PARMLNG;             /* LENGTH                        */ 03680000
         STH   @08,SNTLNG(,SNTELPTR)                               1173 03681000
*       SNTABUSE=SNTABUSE+SNTLNG+LENGTH(SNTELEM);/* AMOUNT USED      */ 03682000
         AL    @08,SNTABUSE(,SNTABPTR)                             1174 03683000
         AL    @08,@CF00088                                        1174 03684000
         ST    @08,SNTABUSE(,SNTABPTR)                             1174 03685000
*       PARMRADR=SNTELPTR;          /* SEND BACK ELEMENT PTR         */ 03686000
         ST    SNTELPTR,PARMRADR                                   1175 03687000
*       IF PARMTYPE=LABL THEN       /* IF PARAMETER IS A LABEL       */ 03688000
         CLC   PARMTYPE(2),@CH00033                                1176 03689000
         BNE   @RF01176                                            1176 03690000
*         DO;                       /* THEN PLACE ITS ADDRESS IN     */ 03691000
*           SNTLABEL=ON;            /* VALUE PTR                     */ 03692000
         OI    SNTLABEL(SNTELPTR),B'00010000'                      1178 03693000
*           SNTVLPTR=ECDACNXT;      /* VALUE PTR                     */ 03694000
         L     @08,ECDACNXT(,ECDAPTR)                              1179 03695000
         ST    @08,SNTVLPTR(,SNTELPTR)                             1179 03696000
*         END;                                                     1180 03697000
*       ELSE                        /* DETERMINE IF PARM IS A        */ 03698000
*         IF PARMTYPE^=GLOBAL THEN  /* KEYWORD OR GLOBAL?            */ 03699000
         B     @RC01176                                            1181 03700000
@RF01176 CLC   PARMTYPE(2),@CH00074                                1181 03701000
         BE    @RF01181                                            1181 03702000
*           DO;                     /* -KEYWORD---PUT VALUE IN       */ 03703000
*             SNTKEYW=ON;           /* VALUE POINTER                 */ 03704000
         OI    SNTKEYW(SNTELPTR),B'00100000'                       1183 03705000
*             SNTVLPTR=ADDR(SVTELFST);/* VALUE PTR                   */ 03706000
         L     @08,SVTABPTR                                        1184 03707000
         LA    @08,SVTELFST(,@08)                                  1184 03708000
         ST    @08,SNTVLPTR(,SNTELPTR)                             1184 03709000
*           END;                                                   1185 03710000
*         ELSE                      /* ELSE                          */ 03711000
*           DO;                                                    1186 03712000
         B     @RC01181                                            1186 03713000
@RF01181 DS    0H                                                  1187 03714000
*             SNTGLOB=ON;           /* GLOBAL                        */ 03715000
         OI    SNTGLOB(SNTELPTR),B'10000000'                       1187 03716000
*             SNTGVAL=ECDAGCNT;     /* SAVE THE CURRENT GLOBAL VALUE */ 03717000
         L     @08,ECDAGCNT(,ECDAPTR)                              1188 03718000
         ST    @08,SNTGVAL(,SNTELPTR)                              1188 03719000
*             IF NESTED=OFF THEN    /* IF THIS IS THE FIRST NESTED   */ 03720000
         TM    NESTED(ECDAPTR),B'00000010'                         1189 03721000
         BNZ   @RF01189                                            1189 03722000
*               DO;                 /* LEVEL, THEN CREATE A GLOBAL 1190 03723000
*                                      NAME ENTRY IN THE SNTAB       */ 03724000
*                 SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);        1191 03725000
         LA    @08,8                                               1191 03726000
         LR    @06,SNTELPTR                                        1191 03727000
         AH    @06,SNTLNG(,SNTELPTR)                               1191 03728000
         ALR   @06,@08                                             1191 03729000
         LR    SNTELPTR,@06                                        1191 03730000
*                 SNTDATA(1:LENGTH(GLOBVAL))=GLOBVAL;/* MOVE IN THE     03731000
*                                      NEW NAME                      */ 03732000
         MVC   SNTDATA(4,SNTELPTR),GLOBVAL(ECDAPTR)                1192 03733000
*                 SNTFLAGS=SNTFLAGS&&SNTFLAGS;/* NO FLAGS SET        */ 03734000
         XC    SNTFLAGS(2,SNTELPTR),SNTFLAGS(SNTELPTR)             1193 03735000
*                 SNTVLPTR=ADDR(SVTELFST);/* VALUE IS INITIALLY NULL */ 03736000
         L     @06,SVTABPTR                                        1194 03737000
         LA    @06,SVTELFST(,@06)                                  1194 03738000
         ST    @06,SNTVLPTR(,SNTELPTR)                             1194 03739000
*                 SNTLNG=LENGTH(GLOBVAL);/* LENGTH                   */ 03740000
         LA    @06,4                                               1195 03741000
         STH   @06,SNTLNG(,SNTELPTR)                               1195 03742000
*                 SNTABUSE=SNTABUSE+SNTLNG+LENGTH(SNTELEM);/* USED   */ 03743000
         AL    @06,SNTABUSE(,SNTABPTR)                             1196 03744000
         ALR   @06,@08                                             1196 03745000
         ST    @06,SNTABUSE(,SNTABPTR)                             1196 03746000
*               END;                                               1197 03747000
*           END;                                                   1198 03748000
@RF01189 DS    0H                                                  1199 03749000
*       ECDALNEL=SNTELPTR;          /* ELEMENT PTR                   */ 03750000
@RC01181 DS    0H                                                  1199 03751000
@RC01176 ST    SNTELPTR,ECDALNEL(,ECDAPTR)                         1199 03752000
*     END;                                                         1200 03753000
*   IF PARMTYPE=GLOBAL THEN         /* IF PARM WAS A GLOBAL THEN     */ 03754000
@RF01124 CLC   PARMTYPE(2),@CH00074                                1201 03755000
         BNE   @RF01201                                            1201 03756000
*     DO;                                                          1202 03757000
*       IF NESTED=ONS&ECDAGCNT>GEXECDAT->GEXECCNT THEN/* MAKE SURE WE   03758000
*                                      DONT HAVE TOO MANY            */ 03759000
         TM    NESTED(ECDAPTR),B'00000010'                         1203 03760000
         BNO   @RF01203                                            1203 03761000
         L     @08,ECDALSD(,ECDAPTR)                               1203 03762000
         L     @08,LSDEXEC(,@08)                                   1203 03763000
         L     @08,GEXECDAT(,@08)                                  1203 03764000
         L     @06,ECDAGCNT(,ECDAPTR)                              1203 03765000
         C     @06,GEXECCNT(,@08)                                  1203 03766000
         BNH   @RF01203                                            1203 03767000
*         DO;                                                      1204 03768000
*           NOTEXEC=ON;             /* COMMAND PROC NOT EXECUTABLE   */ 03769000
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1205 03770000
*           EXMSGID=M535;           /* MESSAGE TO BE ISSUED          */ 03771000
         MVC   EXMSGID(4),@CC00489                                 1206 03772000
*           STMT=ONS;               /* STATEMENT NUMBERS REQ         */ 03773000
         OI    STMT,B'10000000'                                    1207 03774000
*           CALL MSGRTN;            /* ISSUE MESSAGE                 */ 03775000
         BAL   @14,MSGRTN                                          1208 03776000
*         END;                                                     1209 03777000
*       ECDAGCNT=ECDAGCNT+ONE;      /* UP THE GLOBAL COUNT BY ONE    */ 03778000
@RF01203 LA    @08,1                                               1210 03779000
         AL    @08,ECDAGCNT(,ECDAPTR)                              1210 03780000
         ST    @08,ECDAGCNT(,ECDAPTR)                              1210 03781000
*     END;                                                         1211 03782000
*   RETURN CODE(CON0);              /* RETURN                        */ 03783000
@RF01201 SLR   @15,@15                                             1212 03784000
         L     @14,@SA00019                                        1212 03785000
         LM    @00,@12,@SA00019+8                                  1212 03786000
         BR    @14                                                 1212 03787000
*   END SYNTAB;                                                    1213 03788000
*                                                                  1214 03789000
*/********************************************************************/ 03790000
*/* GETALINE ROUTINE - THE GETALINE ROUTINE ISSUES DATA SET I/O      */ 03791000
*/*                   GETLINES FOR THE CLIST RECORDS FROM THE        */ 03792000
*/*                   INPUT DATA SET                                 */ 03793000
*/********************************************************************/ 03794000
*                                                                  1214 03795000
*GETALINE:                                                         1214 03796000
*   PROC;                                                          1214 03797000
GETALINE STM   @14,@12,@SA00020                                    1214 03798000
*   DO WHILE ECDAIREC->OO^=0;       /* DO GROUP                      */ 03799000
         B     @DE01215                                            1215 03800000
@DL01215 DS    0H                                                  1216 03801000
*     ECDAIREC=ECDAIREC-ECDAIREC->OO;/* ADJUST POINTER IN BFR FREE 1216 03802000
*                                      THE PREVIOUS BUFFER           */ 03803000
         L     @08,ECDAIREC(,ECDAPTR)                              1216 03804000
         LR    @06,@08                                             1216 03805000
         SH    @06,OO(,@08)                                        1216 03806000
         ST    @06,ECDAIREC(,ECDAPTR)                              1216 03807000
*   END;                                                           1217 03808000
@DE01215 L     @08,ECDAIREC(,ECDAPTR)                              1217 03809000
         LH    @06,OO(,@08)                                        1217 03810000
         LTR   @06,@06                                             1217 03811000
         BNZ   @DL01215                                            1217 03812000
*   DO;                             /* FREEMAIN (E)                1218 03813000
*                                      LV(ECDAIREC->RECLEN)        1218 03814000
*                                      A(ECDAIREC) SP(1)             */ 03815000
*     RESPECIFY                                                    1219 03816000
*      (GPR01P) RESTRICTED;                                        1219 03817000
*     I005=I005&&I005;              /* INIT LIST                     */ 03818000
         XC    I005(10),I005                                       1220 03819000
*     I00505='00'X;                 /* SET TYPE                      */ 03820000
         MVI   I00505,X'00'                                        1221 03821000
*     I00502=ECDAIREC->RECLEN;      /* LENGTH                        */ 03822000
         LH    @08,RECLEN(,@08)                                    1222 03823000
         STCM  @08,7,I00502                                        1222 03824000
*     I00504=ADDR(ECDAIREC);        /* ADDR OF ADDR LIST             */ 03825000
         LA    @08,ECDAIREC(,ECDAPTR)                              1223 03826000
         STCM  @08,7,I00504                                        1223 03827000
*     I00506=1;                     /* SUBPOOL VALUE                 */ 03828000
         MVI   I00506,X'01'                                        1224 03829000
*     GPR01P=ADDR(I005);            /* REG1 POINTS TO LIST           */ 03830000
         LA    GPR01P,I005                                         1225 03831000
*     SVC(5);                       /* STANDARD-FORM OF GETMAIN      */ 03832000
         SVC   5                                                   1226 03833000
*     RESPECIFY                                                    1227 03834000
*      (GPR01P) UNRESTRICTED;                                      1227 03835000
*   END;                            /* FREEMAIN (E)                1228 03836000
*                                      LV(ECDAIREC->RECLEN)        1228 03837000
*                                      A(ECDAIREC) SP(1) NOT FIRST 1228 03838000
*                                      READ                          */ 03839000
*   RFY                                                            1229 03840000
*    (R1,                                                          1229 03841000
*     R15) RSTD;                    /* RESTRICT R1,R15               */ 03842000
*   R1=ECDASPTR;                    /* IOPL ADDR                     */ 03843000
         L     R1,ECDASPTR(,ECDAPTR)                               1230 03844000
*   R15=ECDAGETL;                   /* LOAD GETLINE ADDR             */ 03845000
         L     R15,ECDAGETL(,ECDAPTR)                              1231 03846000
*   GEN(GETLINE MF=(E,(1)),ENTRY=(15));/* GET THE NEXT RECORD        */ 03847000
         GETLINE MF=(E,(1)),ENTRY=(15)                                  03848000
*   SRETCDE=R15;                    /* SAVE THE RETURN CODE          */ 03849000
         ST    R15,SRETCDE                                         1233 03850000
*   RFY                                                            1234 03851000
*    (R1,                                                          1234 03852000
*     R15) UNRSTD;                  /* RELEASE                       */ 03853000
*   IF SRETCDE^=FOUR&               /* IF RETURN CODE ABNORMAL       */ 03854000
*       SRETCDE^=CON16 THEN         /* THEN NOTIFY USER AND TAKE     */ 03855000
         L     @08,SRETCDE                                         1235 03856000
         C     @08,@CF00072                                        1235 03857000
         BE    @RF01235                                            1235 03858000
         C     @08,@CF00191                                        1235 03859000
         BE    @RF01235                                            1235 03860000
*     DO;                           /* THE ERROR EXIT                */ 03861000
*       MVAR(1)=ADDR(GETLIN);       /* INSERTION VARIABLES           */ 03862000
         LA    @08,@CC00564                                        1237 03863000
         ST    @08,MVAR                                            1237 03864000
*       MVARLEN(1)=LENGTH(GETLIN);  /* LENGTH OF MSG VARIABLE        */ 03865000
         MVI   MVARLEN,X'07'                                       1238 03866000
*       MVAR(2)=ADDR(SRETCDE);      /* REURN CODE WILL BE IN MESSAGE */ 03867000
         LA    @08,SRETCDE                                         1239 03868000
         ST    @08,MVAR+4                                          1239 03869000
*       MVARLEN(2)=LENGTH(SRETCDE); /* LENGTH OF MSG VARIABLE        */ 03870000
         MVI   MVARLEN+4,X'04'                                     1240 03871000
*       MVARHEX(2)=ON;              /* MSG SWITCH                    */ 03872000
         OI    MVARHEX+4,B'10000000'                               1241 03873000
*       EXMSGID=M524;               /* MSG ID                        */ 03874000
         MVC   EXMSGID(4),@CC00483                                 1242 03875000
*       CALL MSGRTN;                /* ISSUE MESSAGE                 */ 03876000
         BAL   @14,MSGRTN                                          1243 03877000
*       SRETCDE=TWENTY;             /* RETURN CODE OF 20             */ 03878000
         MVC   SRETCDE(4),@CF00357                                 1244 03879000
*     END;                                                         1245 03880000
*   ELSE                            /* 4 OR 16 IS NORMAL             */ 03881000
*     IF SRETCDE=FOUR THEN          /* RECORD WAS FOUND              */ 03882000
         B     @RC01235                                            1246 03883000
@RF01235 CLC   SRETCDE(4),@CF00072                                 1246 03884000
         BNE   @RF01246                                            1246 03885000
*       DO;                                                        1247 03886000
*         ECDALCTR=ECDALCTR+CON1;   /* UP LINE COUNT                 */ 03887000
         LA    @08,1                                               1248 03888000
         AL    @08,ECDALCTR(,ECDAPTR)                              1248 03889000
         ST    @08,ECDALCTR(,ECDAPTR)                              1248 03890000
*         SRETCDE=ZERO;             /* CONVERT TO NORMAL RETURN      */ 03891000
         SLR   @08,@08                                             1249 03892000
         ST    @08,SRETCDE                                         1249 03893000
*       END;                                                       1250 03894000
*     ELSE                          /* END OF FILE                   */ 03895000
*       SRETCDE=FOUR;               /* END OF FILE RETURN CODE       */ 03896000
         B     @RC01246                                            1251 03897000
@RF01246 MVC   SRETCDE(4),@CF00072                                 1251 03898000
*   ECDAIREC=GTPBIBUF;              /* UPDATE TO INPUT RECORD        */ 03899000
@RC01246 DS    0H                                                  1252 03900000
@RC01235 L     @08,ECDASPTR(,ECDAPTR)                              1252 03901000
         L     @08,IOPLIOPB(,@08)                                  1252 03902000
         L     @08,GTPBIBUF(,@08)                                  1252 03903000
         ST    @08,ECDAIREC(,ECDAPTR)                              1252 03904000
*   RETURN CODE(SRETCDE);           /* RETURN                        */ 03905000
         L     @15,SRETCDE                                         1253 03906000
         L     @14,@SA00020                                        1253 03907000
         LM    @00,@12,@SA00020+8                                  1253 03908000
         BR    @14                                                 1253 03909000
*   END GETALINE;                   /* END OF GETLINE ROUTINE        */ 03910000
*                                                                  1255 03911000
*   /*****************************************************************/ 03912000
*   /*                                                               */ 03913000
*   /* MSGRTN - THE MESSAGE ROUTINE BUILDS THE IKJEFF02 PARAMETER    */ 03914000
*   /* LIST AND THEN INVOKES IKJEFF02 TO ISSUE A MESSAGE             */ 03915000
*   /*                                                               */ 03916000
*   /*****************************************************************/ 03917000
*                                                                  1255 03918000
*MSGRTN:                                                           1255 03919000
*   PROC OPTIONS(SAVEAREA);                                        1255 03920000
MSGRTN   STM   @14,@12,12(@13)                                     1255 03921000
         ST    @13,@SA00021+4                                      1255 03922000
         LA    @14,@SA00021                                        1255 03923000
         ST    @14,8(,@13)                                         1255 03924000
         LR    @13,@14                                             1255 03925000
*   ECB=ZERO;                       /* ZERO ECB                      */ 03926000
         SLR   @08,@08                                             1256 03927000
         ST    @08,ECB                                             1256 03928000
*   MSGTABLE=MSGTABLE&&MSGTABLE;    /* INITIALIZE IKJEFF02 PARMLIST  */ 03929000
         XC    MSGTABLE(56),MSGTABLE                               1257 03930000
*   LISTPTR=ADDR(MSGCSECT);         /* START OF MESSAGE PARMS        */ 03931000
         LA    @08,MSGCSECT                                        1258 03932000
         ST    @08,LISTPTR                                         1258 03933000
*   TMCTPTR=CPPLPTR;                /* ADDRESS OF THE CPPL           */ 03934000
         L     @08,CPPLPTR(,ECDAPTR)                               1259 03935000
         ST    @08,TMCTPTR                                         1259 03936000
*   ECBPTR=ADDR(ECB);               /* DUMMY ECB ADDRESS             */ 03937000
         LA    @08,ECB                                             1260 03938000
         ST    @08,ECBPTR                                          1260 03939000
*   MSGCSECT=ADDR(IKJCT435);        /* IKJCT435 IS MESSAGE CSECT     */ 03940000
         L     @08,@CV00340                                        1261 03941000
         ST    @08,MSGCSECT                                        1261 03942000
*   MTPUTLSW=ON;                    /* PUTLINE MESSAGE REUESTED      */ 03943000
         OI    MTPUTLSW,B'01000000'                                1262 03944000
*   MSGID=EXMSGID;                  /* ID OF THE MESSAGE TO BE ISSUED*/ 03945000
         MVC   MSGID(4),EXMSGID                                    1263 03946000
*   IF STMT=ONS THEN                /* STATEMENT NUMBER REQ ?        */ 03947000
         TM    STMT,B'10000000'                                    1264 03948000
         BNO   @RF01264                                            1264 03949000
*     DO;                           /* --YUP--                       */ 03950000
*       STMT=OFF;                   /* RESET SWITCH                  */ 03951000
         NI    STMT,B'01111111'                                    1266 03952000
*       MVAR(1)=ADDR(AREAA);        /* INSERT                        */ 03953000
         LA    @08,AREAA                                           1267 03954000
         ST    @08,MVAR                                            1267 03955000
*       AREAA=CSTMT;                /* 'STMT'                        */ 03956000
         MVI   AREAA+4,C' '                                        1268 03957000
         MVC   AREAA(4),@CC00543                                   1268 03958000
*       CVD(ECDALCTR,WORKAREA);     /* CONVERT TO DECIMAL            */ 03959000
         L     @08,ECDALCTR(,ECDAPTR)                              1269 03960000
         CVD   @08,WORKAREA                                        1269 03961000
*       UNPK(AREAB,WORKAREA);       /* CONVERT TO PRINTABLE          */ 03962000
         UNPK  AREAB(8),WORKAREA(8)                                1270 03963000
*       AREAB(LENGTH(AREAB))=AREAB(LENGTH(AREAB))|FOXZERO;/*         */ 03964000
         OI    AREAB+7,C'0'                                        1271 03965000
*       DO ICTR=LENGTH(AREAB) TO 2 BY-1 WHILE AREAB(1)=FOXZERO;/*    */ 03966000
         LA    ICTR,8                                              1272 03967000
@DL01272 CLI   AREAB,C'0'                                          1272 03968000
         BNE   @DC01272                                            1272 03969000
*         AREAB(1:LENGTH(AREAB)-1)=AREAB(2:LENGTH(AREAB));/*         */ 03970000
         MVC   @TS00001(7),AREAB+1                                 1273 03971000
         MVC   AREAB(7),@TS00001                                   1273 03972000
*       END;                                                       1274 03973000
         BCTR  ICTR,0                                              1274 03974000
         C     ICTR,@CF00074                                       1274 03975000
         BNL   @DL01272                                            1274 03976000
@DC01272 DS    0H                                                  1275 03977000
*       MVARLEN(1)=LENGTH(AREAA)+ICTR;/* LENGTH OF MSG VARIABLE      */ 03978000
         LA    @06,5                                               1275 03979000
         ALR   @06,ICTR                                            1275 03980000
         STC   @06,MVARLEN                                         1275 03981000
*     END;                                                         1276 03982000
*   DO ICTR=1 TO DIM(MVAR);         /* MVAR HAS BEEN PREVIOUSLY SET  */ 03983000
@RF01264 LA    ICTR,1                                              1277 03984000
@DL01277 DS    0H                                                  1278 03985000
*     MTINSRT(ICTR)=MVAR(ICTR);     /* MVAR HAS BEEN PREVIOUSLY SET  */ 03986000
         LR    @06,ICTR                                            1278 03987000
         SLA   @06,2                                               1278 03988000
         L     @15,MVAR-4(@06)                                     1278 03989000
         ST    @15,MTINSRT-4(@06)                                  1278 03990000
*   END;                                                           1279 03991000
         AL    ICTR,@CF00033                                       1279 03992000
         C     ICTR,@CF00250                                       1279 03993000
         BNH   @DL01277                                            1279 03994000
*   RFY                                                            1280 03995000
*    (R1) RSTD;                     /* RESTRICT REG 1                */ 03996000
*   R1=ADDR(MSGTABLE);              /* ADDRESS OF MSGTABLE           */ 03997000
         LA    R1,MSGTABLE                                         1281 03998000
*   DO;                             /* LINK EP(IKJEFF02)             */ 03999000
*     I00601='00'X;                 /* EP/DE FLAG                    */ 04000000
         MVI   I00601,X'00'                                        1283 04001000
*     I00602=ADDR(IKJEFF02);        /* ADDR OF EP/DE                 */ 04002000
         LA    @08,@CC00566                                        1284 04003000
         STCM  @08,7,I00602                                        1284 04004000
*     I00604=0;                     /* DCB PTR                       */ 04005000
         SLR   @08,@08                                             1285 04006000
         STCM  @08,7,I00604                                        1285 04007000
*     I00603='00'X;                 /* ERRET FLAG                    */ 04008000
         MVI   I00603,X'00'                                        1286 04009000
*     RESPECIFY                                                    1287 04010000
*      (GPR15P) RESTRICTED;                                        1287 04011000
*     GPR15P=ADDR(I006);            /* ADDR OF LINK LIST             */ 04012000
         LA    GPR15P,I006                                         1288 04013000
*     SVC(6);                       /* ISSUE LINK SVC                */ 04014000
         SVC   6                                                   1289 04015000
*     RESPECIFY                                                    1290 04016000
*      (GPR15P) UNRESTRICTED;                                      1290 04017000
*   END;                            /* LINK EP(IKJEFF02) USE IKJEFF02   04018000
*                                      TO ISSUE MESSAGE              */ 04019000
*   RFY                                                            1292 04020000
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */ 04021000
*   END MSGRTN;                     /* END OF MSGRTN                 */ 04022000
@EL00021 L     @13,4(,@13)                                         1293 04023000
@EF00021 DS    0H                                                  1293 04024000
@ER00021 LM    @14,@12,12(@13)                                     1293 04025000
         BR    @14                                                 1293 04026000
*                                                                  1294 04027000
*   /*****************************************************************/ 04028000
*   /*                                                               */ 04029000
*   /* PATCH AREA                                                    */ 04030000
*   /*                                                               */ 04031000
*   /*****************************************************************/ 04032000
*                                                                  1294 04033000
*   DCL                                                            1294 04034000
*     PATCHES FIXED(31) STATIC;                                    1294 04035000
*   GEN DATA DEFS(PATCHES);                                        1295 04036000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 04037000
*     GPR15F FIXED(31) REG(15),                                    1296 04038000
*     GPR01P PTR(31) REG(1),                                       1296 04039000
*     GPR15P PTR(31) REG(15);                                      1296 04040000
*   DCL                                                            1297 04041000
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */ 04042000
*      2 I00401 PTR(31),            /* LENGTH                        */ 04043000
*      2 I00402 CHAR(1),            /* HIARCHY                       */ 04044000
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */ 04045000
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */ 04046000
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */ 04047000
*   DCL                                                            1298 04048000
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */ 04049000
*       3 I00501 PTR(8),            /* RESERVED                      */ 04050000
*       3 I00502 PTR(24),           /* LENGTH                        */ 04051000
*       3 I00503 PTR(8),            /* RESERVED                      */ 04052000
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */ 04053000
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */ 04054000
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */ 04055000
*   DCL                                                            1299 04056000
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */ 04057000
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */ 04058000
*      2 I00602 PTR(24),            /* EP/DE PTR                     */ 04059000
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */ 04060000
*      2 I00604 PTR(24),            /* DCB PTR                       */ 04061000
*      2 I00605 PTR(31);            /* ERRET PTR                     */ 04062000
*   DECLARE                                                        1300 04063000
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */ 04064000
*   DECLARE                         /* COMMON VARIABLES              */ 04065000
*     I256C CHAR(256) BASED,                                       1301 04066000
*     I031F FIXED(31) BASED,                                       1301 04067000
*     I031P PTR(31) BASED,                                         1301 04068000
*     I015F FIXED(15) BASED,                                       1301 04069000
*     I015P PTR(15) BASED,                                         1301 04070000
*     I008P PTR(8) BASED,                                          1301 04071000
*     I001C CHAR(1) BASED;                                         1301 04072000
*   END IKJCT432                                                   1302 04073000
*                                                                  1302 04074000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04075000
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */ 04076000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */ 04077000
*/*%INCLUDE SYSLIB  (IKJEXEC )                                       */ 04078000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 04079000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                       */ 04080000
*                                                                  1302 04081000
*       ;                                                          1302 04082000
@EL00001 L     @13,4(,@13)                                         1302 04083000
@EF00001 L     @00,@SIZDATD                                        1302 04084000
         LR    @01,@12                                             1302 04085000
         FREEMAIN R,LV=(0),A=(1)                                        04086000
@ER00001 LM    @14,@12,12(@13)                                     1302 04087000
         BR    @14                                                 1302 04088000
@DATA    DS    0H                                                       04089000
@CH00171 DC    H'9'                                                     04090000
@CH00359 DC    H'12'                                                    04091000
@CH00043 DC    H'15'                                                    04092000
@SC00853 CLC   COMMAND(0,@06),ECDAAEND(ECDAPTR)                         04093000
@SC00861 CLC   LINE(0,@14),0(@01)                                       04094000
@SM00863 MVC   ECDAAEND(0,ECDAPTR),LINE(@08)                            04095000
@SC00865 CLC   SNTDATA(0,SNTELPTR),PARMDAT(@08)                         04096000
@SM00867 MVC   SNTDATA(0,SNTELPTR),PARMDAT(@05)                         04097000
@DATD    DSECT                                                          04098000
         DS    0F                                                       04099000
@SA00001 DS    18F                                                      04100000
@PC00001 DS    1F                                                       04101000
@SA00003 DS    15F                                                      04102000
@SA00019 DS    15F                                                      04103000
@SA00021 DS    18F                                                      04104000
@SA00011 DS    15F                                                      04105000
@SA00008 DS    14F                                                      04106000
@SA00012 DS    14F                                                      04107000
@SA00010 DS    15F                                                      04108000
@SA00015 DS    15F                                                      04109000
@SA00009 DS    14F                                                      04110000
@SA00018 DS    14F                                                      04111000
@SA00013 DS    14F                                                      04112000
@SA00014 DS    14F                                                      04113000
@SA00016 DS    15F                                                      04114000
@SA00002 DS    15F                                                      04115000
@SA00007 DS    13F                                                      04116000
@SA00005 DS    14F                                                      04117000
@SA00020 DS    15F                                                      04118000
@SA00017 DS    15F                                                      04119000
@AL00001 DS    1A                                                       04120000
@TF00001 DS    F                                                        04121000
IKJCT432 CSECT                                                          04122000
         DS    0F                                                       04123000
@CF00033 DC    F'1'                                                     04124000
@CH00033 EQU   @CF00033+2                                               04125000
@CF00074 DC    F'2'                                                     04126000
@CH00074 EQU   @CF00074+2                                               04127000
@CF00250 DC    F'3'                                                     04128000
@CH00250 EQU   @CF00250+2                                               04129000
@CF00072 DC    F'4'                                                     04130000
@CF00371 DC    F'5'                                                     04131000
@CF00149 DC    F'7'                                                     04132000
@CH00149 EQU   @CF00149+2                                               04133000
@CF00088 DC    F'8'                                                     04134000
@CH00088 EQU   @CF00088+2                                               04135000
@CF00392 DC    F'11'                                                    04136000
@CH00392 EQU   @CF00392+2                                               04137000
@CF00169 DC    F'14'                                                    04138000
@CF00191 DC    F'16'                                                    04139000
@CF00357 DC    F'20'                                                    04140000
@CF00041 DC    F'31'                                                    04141000
@CF00475 DC    F'127'                                                   04142000
@CF00473 DC    F'252'                                                   04143000
@CF00374 DC    F'255'                                                   04144000
@CF00479 DC    F'256'                                                   04145000
@CF00390 DC    F'4096'                                                  04146000
@CF00388 DC    F'6144'                                                  04147000
@CF00477 DC    F'36864'                                                 04148000
@CF00838 DC    F'-6'                                                    04149000
@CF00839 DC    F'-3'                                                    04150000
@CF00840 DC    F'-2'                                                    04151000
@DATD    DSECT                                                          04152000
         DS    0D                                                       04153000
LSDPTR   DS    A                                                        04154000
IOPLPTR  DS    A                                                        04155000
SVTABPTR DS    A                                                        04156000
NEWSAVE  DS    A                                                        04157000
GTMNPTR  DS    A                                                        04158000
WORKPTR  DS    A                                                        04159000
SCANPTR  DS    A                                                        04160000
LENTH    DS    F                                                        04161000
RLENGTH  DS    A                                                        04162000
INDEX    DS    F                                                        04163000
SRETCDE  DS    F                                                        04164000
FREEADR  DS    A                                                        04165000
GETADR   DS    A                                                        04166000
ECB      DS    F                                                        04167000
@TS00001 DS    CL7                                                      04168000
@NM00008 DS    CL1                                                      04169000
         ORG   @NM00008                                                 04170000
SEPS     DS    BL1                                                      04171000
EXACT    EQU   @NM00008+0                                               04172000
MATCH    EQU   @NM00008+0                                               04173000
AMBIG    EQU   @NM00008+0                                               04174000
         ORG   @NM00008+1                                               04175000
MSGTABLE DS    CL56                                                     04176000
         ORG   MSGTABLE                                                 04177000
LISTPTR  DS    AL4                                                      04178000
TMCTPTR  DS    AL4                                                      04179000
         ORG   TMCTPTR                                                  04180000
MTCPPL   DS    AL4                                                      04181000
         ORG   MSGTABLE+8                                               04182000
ECBPTR   DS    AL4                                                      04183000
@NM00009 DS    AL4                                                      04184000
         ORG   @NM00009                                                 04185000
MTHIGH   DS    BL1                                                      04186000
         ORG   MSGTABLE+16                                              04187000
MSGCSECT DS    AL4                                                      04188000
SW       DS    AL1                                                      04189000
         ORG   SW                                                       04190000
MTNOIDSW DS    BL1                                                      04191000
MTPUTLSW EQU   SW+0                                                     04192000
MTWTOSW  EQU   SW+0                                                     04193000
MTHEXSW  EQU   SW+0                                                     04194000
MTKEY1SW EQU   SW+0                                                     04195000
MTJOBISW EQU   SW+0                                                     04196000
MTWTPSW  EQU   SW+0                                                     04197000
MTNHEXSW EQU   SW+0                                                     04198000
         ORG   MSGTABLE+21                                              04199000
RETMSG   DS    AL3                                                      04200000
SW2      DS    AL1                                                      04201000
         ORG   SW2                                                      04202000
MT2OLDSW DS    BL1                                                      04203000
MTDOMSW  EQU   SW2+0                                                    04204000
MTNOXQSW EQU   SW2+0                                                    04205000
MTNPLMSW EQU   SW2+0                                                    04206000
MTPGMSW  EQU   SW2+0                                                    04207000
@NM00010 EQU   SW2+0                                                    04208000
         ORG   MSGTABLE+25                                              04209000
@NM00011 DS    AL3                                                      04210000
MTOLDPTR DS    AL4                                                      04211000
@NM00012 DS    AL4                                                      04212000
@NM00013 DS    AL4                                                      04213000
MSGID    DS    CL4                                                      04214000
MTINSRTS DS    CL12                                                     04215000
         ORG   MTINSRTS                                                 04216000
MTINSRT  DS    CL4                                                      04217000
         ORG   MTINSRT+0                                                04218000
MTLEN    DS    AL1                                                      04219000
         ORG   MTLEN+0                                                  04220000
MTHIGHL  DS    BL1                                                      04221000
         ORG   MTINSRT+1                                                04222000
MTADDR   DS    AL3                                                      04223000
         ORG   MSGTABLE+56                                              04224000
SCANLIST DS    CL17                                                     04225000
         ORG   SCANLIST                                                 04226000
LABLADD  DS    AL4                                                      04227000
LABLLEN  DS    AL4                                                      04228000
CMDADD   DS    AL4                                                      04229000
CMDLEN   DS    AL4                                                      04230000
FLAGS    DS    CL1                                                      04231000
         ORG   FLAGS                                                    04232000
LABLBAD  DS    BL1                                                      04233000
CMDBAD   EQU   FLAGS+0                                                  04234000
TSODISG  EQU   FLAGS+0                                                  04235000
         ORG   SCANLIST+17                                              04236000
         DS    CL3                                                      04237000
NAMELIST DS    CL12                                                     04238000
         ORG   NAMELIST                                                 04239000
NAMEPTR  DS    AL4                                                      04240000
NAMELEN  DS    FL2                                                      04241000
NAMEFLAG DS    FL2                                                      04242000
         ORG   NAMEFLAG                                                 04243000
LABELBIT DS    BL1                                                      04244000
         ORG   NAMELIST+8                                               04245000
ANSWER   DS    AL4                                                      04246000
         ORG   NAMELIST+12                                              04247000
NTUPTPRM DS    CL14                                                     04248000
         ORG   NTUPTPRM                                                 04249000
PARMADR  DS    AL4                                                      04250000
PARMLNG  DS    FL4                                                      04251000
PARMRADR DS    AL4                                                      04252000
PARMTYPE DS    FL2                                                      04253000
         ORG   NTUPTPRM+14                                              04254000
EXMSGID  DS    CL4                                                      04255000
         DS    CL2                                                      04256000
MOVELIST DS    CL8                                                      04257000
         ORG   MOVELIST                                                 04258000
DATAADD  DS    AL4                                                      04259000
DATALEN  DS    FL4                                                      04260000
         ORG   MOVELIST+8                                               04261000
SCANBYTE DS    CL2                                                      04262000
         ORG   SCANBYTE                                                 04263000
ALPHA    DS    BL1                                                      04264000
NUMERIC  EQU   SCANBYTE+0                                               04265000
COLONB   EQU   SCANBYTE+0                                               04266000
PERCENTB EQU   SCANBYTE+0                                               04267000
AMPERSND EQU   SCANBYTE+0                                               04268000
SEPAR    EQU   SCANBYTE+0                                               04269000
SLASH    EQU   SCANBYTE+0                                               04270000
NALPHNUM EQU   SCANBYTE+0                                               04271000
OPAREN   DS    BL1                                                      04272000
CPAREN   EQU   SCANBYTE+1                                               04273000
@NM00016 EQU   SCANBYTE+1                                               04274000
         ORG   SCANBYTE+2                                               04275000
ENDWORD  DS    CL1                                                      04276000
         ORG   ENDWORD                                                  04277000
NOTALPNU DS    BL1                                                      04278000
WASPRCNT EQU   ENDWORD+0                                                04279000
WASAMPER EQU   ENDWORD+0                                                04280000
@NM00017 EQU   ENDWORD+0                                                04281000
         ORG   ENDWORD+1                                                04282000
@NM00018 DS    CL13                                                     04283000
         ORG   @NM00018                                                 04284000
AREAA    DS    CL5                                                      04285000
AREAB    DS    CL8                                                      04286000
         ORG   @NM00018+13                                              04287000
         DS    CL4                                                      04288000
WORKAREA DS    CL8                                                      04289000
STMT     DS    BL1                                                      04290000
         DS    CL3                                                      04291000
PARMS    DS    CL12                                                     04292000
         ORG   PARMS                                                    04293000
PARM1    DS    AL4                                                      04294000
PARM2    DS    CL4                                                      04295000
         ORG   PARM2                                                    04296000
FLAG1    DS    CL1                                                      04297000
         ORG   FLAG1                                                    04298000
ENDFLAG2 DS    BL1                                                      04299000
IFFLAG2  EQU   FLAG1+0                                                  04300000
RETFLAG2 EQU   FLAG1+0                                                  04301000
ELSFLAG2 EQU   FLAG1+0                                                  04302000
NULINE   EQU   FLAG1+0                                                  04303000
         ORG   PARMS+8                                                  04304000
FALEND2  DS    AL4                                                      04305000
         ORG   PARMS+12                                                 04306000
ILIST    DS    CL12                                                     04307000
MVAR     DS    AL4                                                      04308000
         ORG   MVAR+0                                                   04309000
MVARLEN  DS    AL1                                                      04310000
         ORG   MVARLEN+0                                                04311000
MVARHEX  DS    BL1                                                      04312000
         ORG   MVAR+12                                                  04313000
IKJCT432 CSECT                                                          04314000
         DS    0F                                                       04315000
@SIZDATD DC    AL1(1)                                                   04316000
         DC    AL3(@ENDDATD-@DATD)                                      04317000
@CA00028 DC    A(IKJCT432)                                              04318000
@CV00340 DC    V(IKJCT435)                                              04319000
         DS    0D                                                       04320000
@CC00418 DC    C'OPENFILE'                                              04321000
@CC00420 DC    C'CLOSFILE'                                              04322000
@CC00537 DC    C'READDVAL'                                              04323000
@CC00566 DC    C'IKJEFF02'                                              04324000
@CC00422 DC    C'GETFILE'                                               04325000
@CC00424 DC    C'PUTFILE'                                               04326000
@CC00535 DC    C'ENDDATA'                                               04327000
@CC00559 DC    C'CONTROL'                                               04328000
@CC00561 DC    C'WRITENR'                                               04329000
@CC00564 DC    C'GETLINE'                                               04330000
@CC00553 DC    C'GLOBAL'                                                04331000
@CC00555 DC    C'TERMIN'                                                04332000
@CC00557 DC    C'RETURN'                                                04333000
@CC00430 DC    C'WHILE'                                                 04334000
@CC00549 DC    C'ERROR'                                                 04335000
@CC00551 EQU   @CC00561                                                 04336000
@CC00398 DC    C'THEN'                                                  04337000
@CC00416 DC    C'ATTN'                                                  04338000
@CC00481 DC    C'M511'                                                  04339000
@CC00483 DC    C'M524'                                                  04340000
@CC00485 DC    C'M531'                                                  04341000
@CC00487 DC    C'A530'                                                  04342000
@CC00489 DC    C'M535'                                                  04343000
@CC00491 DC    C'M532'                                                  04344000
@CC00493 DC    C'M533'                                                  04345000
@CC00495 DC    C'M534'                                                  04346000
@CC00497 DC    C'M536'                                                  04347000
@CC00499 DC    C'M537'                                                  04348000
@CC00501 DC    C'M538'                                                  04349000
@CC00503 DC    C'M539'                                                  04350000
@CC00505 DC    C'A540'                                                  04351000
@CC00507 DC    C'B540'                                                  04352000
@CC00509 DC    C'M543'                                                  04353000
@CC00511 DC    C'C540'                                                  04354000
@CC00515 DC    C'M526'                                                  04355000
@CC00517 DC    C'M528'                                                  04356000
@CC00519 DC    C'M544'                                                  04357000
@CC00529 DC    C'ELSE'                                                  04358000
@CC00533 DC    C'DATA'                                                  04359000
@CC00541 DC    C'GOTO'                                                  04360000
@CC00543 DC    C'STMT'                                                  04361000
@CC00545 EQU   @CC00537                                                 04362000
@CC00547 DC    C'EXIT'                                                  04363000
@CC00187 EQU   @CC00535                                                 04364000
@CC00414 DC    C'OFF'                                                   04365000
@CC00539 DC    C'SET'                                                   04366000
@CC00412 DC    C'DO'                                                    04367000
@CC00455 DC    C'/*'                                                    04368000
@CC00457 DC    C'*/'                                                    04369000
@CC00527 DC    C'IF'                                                    04370000
TABLE    DS    CL15                                                     04371000
         ORG   TABLE+0                                                  04372000
KEYWRD   DC    CL9'FLUSH'                                               04373000
KEYLEN   DC    AL2(5)                                                   04374000
MASK1    DC    X'8000'                                                  04375000
MASK2    DC    X'BFFF'                                                  04376000
         ORG   TABLE+15                                                 04377000
         ORG   TABLE+15                                                 04378000
         DC    CL9'NOFLUSH'                                             04379000
         DC    AL2(7)                                                   04380000
         DC    X'4000'                                                  04381000
         DC    X'7FFF'                                                  04382000
         ORG   TABLE+30                                                 04383000
         ORG   TABLE+30                                                 04384000
         DC    CL9'PROMPT'                                              04385000
         DC    AL2(6)                                                   04386000
         DC    X'2000'                                                  04387000
         DC    X'EFFF'                                                  04388000
         ORG   TABLE+45                                                 04389000
         ORG   TABLE+45                                                 04390000
         DC    CL9'NOPROMPT'                                            04391000
         DC    AL2(8)                                                   04392000
         DC    X'1000'                                                  04393000
         DC    X'DFFF'                                                  04394000
         ORG   TABLE+60                                                 04395000
         ORG   TABLE+60                                                 04396000
         DC    CL9'LIST'                                                04397000
         DC    AL2(4)                                                   04398000
         DC    X'0800'                                                  04399000
         DC    X'FBFF'                                                  04400000
         ORG   TABLE+75                                                 04401000
         ORG   TABLE+75                                                 04402000
         DC    CL9'NOLIST'                                              04403000
         DC    AL2(6)                                                   04404000
         DC    X'0400'                                                  04405000
         DC    X'F7FF'                                                  04406000
         ORG   TABLE+90                                                 04407000
         ORG   TABLE+90                                                 04408000
         DC    CL9'CONLIST'                                             04409000
         DC    AL2(7)                                                   04410000
         DC    X'0200'                                                  04411000
         DC    X'FEFF'                                                  04412000
         ORG   TABLE+105                                                04413000
         ORG   TABLE+105                                                04414000
         DC    CL9'NOCONLIST'                                           04415000
         DC    AL2(9)                                                   04416000
         DC    X'0100'                                                  04417000
         DC    X'FDFF'                                                  04418000
         ORG   TABLE+120                                                04419000
         ORG   TABLE+120                                                04420000
         DC    CL9'SYMLIST'                                             04421000
         DC    AL2(7)                                                   04422000
         DC    X'0080'                                                  04423000
         DC    X'FFBF'                                                  04424000
         ORG   TABLE+135                                                04425000
         ORG   TABLE+135                                                04426000
         DC    CL9'NOSYMLIST'                                           04427000
         DC    AL2(9)                                                   04428000
         DC    X'0040'                                                  04429000
         DC    X'FF7F'                                                  04430000
         ORG   TABLE+150                                                04431000
         ORG   TABLE+150                                                04432000
         DC    CL9'MSG'                                                 04433000
         DC    AL2(3)                                                   04434000
         DC    X'0020'                                                  04435000
         DC    X'FFFE'                                                  04436000
         ORG   TABLE+165                                                04437000
         ORG   TABLE+165                                                04438000
         DC    CL9'NOMSG'                                               04439000
         DC    AL2(5)                                                   04440000
         DC    X'0010'                                                  04441000
         DC    X'FFFD'                                                  04442000
         ORG   TABLE+180                                                04443000
         ORG   TABLE+180                                                04444000
         DC    CL9'MAIN'                                                04445000
         DC    AL2(4)                                                   04446000
         DC    X'0008'                                                  04447000
         DC    X'FFFF'                                                  04448000
         ORG   TABLE+195                                                04449000
         ORG   TABLE+195                                                04450000
         DC    CL9'END'                                                 04451000
         DC    AL2(3)                                                   04452000
         DC    X'0004'                                                  04453000
         DC    X'FFFF'                                                  04454000
         ORG   TABLE+210                                                04455000
         DS    CL2                                                      04456000
ROUTE    DC    AL4(TSOCALL)                                             04457000
         DC    AL4(LENGTH2)                                             04458000
         DC    AL4(LENGTH3)                                             04459000
         DC    AL4(LENGTH4)                                             04460000
         DC    AL4(LENGTH5)                                             04461000
         DC    AL4(LENGTH6)                                             04462000
         DC    AL4(LENGTH7)                                             04463000
         DC    AL4(LENGTH8)                                             04464000
IKJCT432 CSECT                                                          04465000
         DS   0H                                                        04466000
PATCHES DC ((@DATA-@PSTART)/20)X'00'                                    04467000
@DATD    DSECT                                                          04468000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04469000
@ENDDATD EQU   *                                                        04470000
IKJCT432 CSECT                                                          04471000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04472000
@01      EQU   01                                                       04473000
@02      EQU   02                                                       04474000
@03      EQU   03                                                       04475000
@04      EQU   04                                                       04476000
@05      EQU   05                                                       04477000
@06      EQU   06                                                       04478000
@07      EQU   07                                                       04479000
@08      EQU   08                                                       04480000
@09      EQU   09                                                       04481000
@10      EQU   10                                                       04482000
@11      EQU   11                                                       04483000
@12      EQU   12                                                       04484000
@13      EQU   13                                                       04485000
@14      EQU   14                                                       04486000
@15      EQU   15                                                       04487000
FREEAMT  EQU   @05                                                      04488000
GETAMT   EQU   @08                                                      04489000
CYCLE    EQU   @03                                                      04490000
ENDPTR   EQU   @05                                                      04491000
SAVEIREC EQU   @02                                                      04492000
ICTR     EQU   @08                                                      04493000
COUNT    EQU   @02                                                      04494000
TRIP     EQU   @08                                                      04495000
GETBYTE  EQU   @04                                                      04496000
X        EQU   @08                                                      04497000
PARMPTR  EQU   @08                                                      04498000
ERRBASE  EQU   @05                                                      04499000
DOBASE   EQU   @05                                                      04500000
SAVENEXT EQU   @05                                                      04501000
TRUESAV  EQU   @05                                                      04502000
SAVEPTR  EQU   @02                                                      04503000
RCODE    EQU   @04                                                      04504000
LINCOUNT EQU   @03                                                      04505000
LINEPTR  EQU   @05                                                      04506000
SNTELPTR EQU   @02                                                      04507000
SNTABPTR EQU   @04                                                      04508000
ECDAPTR  EQU   @07                                                      04509000
R9       EQU   @09                                                      04510000
R10      EQU   @10                                                      04511000
R11      EQU   @11                                                      04512000
R15      EQU   @15                                                      04513000
R1       EQU   @01                                                      04514000
R2       EQU   @02                                                      04515000
R3       EQU   @03                                                      04516000
R4       EQU   @04                                                      04517000
R5       EQU   @05                                                      04518000
GPR01P   EQU   @01                                                      04519000
GPR15F   EQU   @15                                                      04520000
GPR15P   EQU   @15                                                      04521000
LSD      EQU   0                                                        04522000
LSDEXEC  EQU   LSD+12                                                   04523000
IOPL     EQU   0                                                        04524000
IOPLIOPB EQU   IOPL+12                                                  04525000
ECDA     EQU   0                                                        04526000
ECDACPPL EQU   ECDA                                                     04527000
ECDALSD  EQU   ECDA+12                                                  04528000
ECDAIREC EQU   ECDA+16                                                  04529000
ECDACBLK EQU   ECDA+20                                                  04530000
ECDACPRE EQU   ECDA+24                                                  04531000
ECDACNXT EQU   ECDA+28                                                  04532000
ECDASPTR EQU   ECDA+32                                                  04533000
ECDALCTR EQU   ECDA+36                                                  04534000
ECDALNEL EQU   ECDA+40                                                  04535000
ECDAGCNT EQU   ECDA+44                                                  04536000
ECDANDO  EQU   ECDA+48                                                  04537000
ECDAELNG EQU   ECDA+50                                                  04538000
ECDAAEND EQU   ECDA+52                                                  04539000
ECDAFLAG EQU   ECDA+56                                                  04540000
NOTEXEC  EQU   ECDAFLAG                                                 04541000
NESTED   EQU   ECDAFLAG                                                 04542000
ECDAGETL EQU   ECDA+60                                                  04543000
ECDACPGM EQU   ECDA+68                                                  04544000
ECDAINME EQU   ECDA+72                                                  04545000
EXECDATA EQU   0                                                        04546000
SNTABFST EQU   EXECDATA                                                 04547000
SVTABFST EQU   EXECDATA+4                                               04548000
GEXECDAT EQU   EXECDATA+8                                               04549000
@NM00004 EQU   EXECDATA+16                                              04550000
EXDATFLG EQU   EXECDATA+32                                              04551000
@NM00005 EQU   EXDATFLG                                                 04552000
GEXECCNT EQU   EXECDATA+36                                              04553000
COMPROC  EQU   0                                                        04554000
COMPRPTR EQU   COMPROC                                                  04555000
COMPRID  EQU   COMPRPTR                                                 04556000
COMPRNXT EQU   COMPRPTR+1                                               04557000
COMPRLNG EQU   COMPROC+4                                                04558000
COMPRUSE EQU   COMPROC+8                                                04559000
SNTAB    EQU   0                                                        04560000
SNTABNXT EQU   SNTAB                                                    04561000
SNTABLNG EQU   SNTAB+4                                                  04562000
SNTABUSE EQU   SNTAB+8                                                  04563000
SNTELEM  EQU   0                                                        04564000
SNTVLPTR EQU   SNTELEM                                                  04565000
SNTGVAL  EQU   SNTVLPTR                                                 04566000
SNTFLAGS EQU   SNTELEM+4                                                04567000
SNTKEYW  EQU   SNTFLAGS                                                 04568000
SNTLABEL EQU   SNTFLAGS                                                 04569000
SNTLAST  EQU   SNTFLAGS                                                 04570000
SNTGLOB  EQU   SNTFLAGS+1                                               04571000
SNTLNG   EQU   SNTELEM+6                                                04572000
SNTDATA  EQU   SNTELEM+8                                                04573000
SVTAB    EQU   0                                                        04574000
SVTELFST EQU   SVTAB+16                                                 04575000
SVTELEM  EQU   0                                                        04576000
CPPL     EQU   0                                                        04577000
RET      EQU   0                                                        04578000
LINE     EQU   0                                                        04579000
PARMBLOC EQU   0                                                        04580000
ECDAPTR2 EQU   PARMBLOC                                                 04581000
FLAAGS   EQU   PARMBLOC+4                                               04582000
FLAG     EQU   FLAAGS                                                   04583000
ENDFLAG  EQU   FLAG                                                     04584000
IFFLAG   EQU   FLAG                                                     04585000
RETFLAG  EQU   FLAG                                                     04586000
ELSFLAG  EQU   FLAG                                                     04587000
NULLINE  EQU   FLAG                                                     04588000
FALEND   EQU   PARMBLOC+8                                               04589000
COMMAND  EQU   0                                                        04590000
CPHEADER EQU   0                                                        04591000
LL       EQU   CPHEADER                                                 04592000
OO       EQU   CPHEADER+2                                               04593000
O2O2     EQU   CPHEADER+4                                               04594000
OC       EQU   CPHEADER+6                                               04595000
SCANIN   EQU   0                                                        04596000
RECLEN   EQU   SCANIN                                                   04597000
RECORD   EQU   SCANIN+4                                                 04598000
ROUTINE  EQU   0                                                        04599000
GTPBIBUF EQU   4                                                        04600000
PARMDAT  EQU   0                                                        04601000
COMREC   EQU   0                                                        04602000
INPUT    EQU   0                                                        04603000
I001C    EQU   0                                                        04604000
I008P    EQU   0                                                        04605000
I015F    EQU   0                                                        04606000
I015P    EQU   0                                                        04607000
I031F    EQU   0                                                        04608000
I031P    EQU   0                                                        04609000
I256C    EQU   0                                                        04610000
MSGECB   EQU   0                                                        04611000
MSGTMCT  EQU   0                                                        04612000
OPTION   EQU   0                                                        04613000
APARM    EQU   0                                                        04614000
CPPLPTR  EQU   ECDACPPL                                                 04615000
ECDAIDS  EQU   ECDACBLK                                                 04616000
FALSEP   EQU   OC+1                                                     04617000
FALSEP2  EQU   OC+2                                                     04618000
FLGS     EQU   OC+1                                                     04619000
CNTLFLG  EQU   OC+1                                                     04620000
PARMCNT  EQU   OC+1                                                     04621000
GLOBVAL  EQU   ECDAGCNT                                                 04622000
I004     EQU   ILIST                                                    04623000
I00401   EQU   I004                                                     04624000
I00403   EQU   I004+5                                                   04625000
I00404   EQU   I004+8                                                   04626000
I00405   EQU   I004+9                                                   04627000
I005     EQU   ILIST                                                    04628000
I00502   EQU   I005+1                                                   04629000
I00504   EQU   I005+5                                                   04630000
I00505   EQU   I005+8                                                   04631000
I00506   EQU   I005+9                                                   04632000
I006     EQU   ILIST                                                    04633000
I00601   EQU   I006                                                     04634000
I00602   EQU   I006+1                                                   04635000
I00603   EQU   I006+4                                                   04636000
I00604   EQU   I006+5                                                   04637000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04638000
I00605   EQU   I006+8                                                   04639000
I00503   EQU   I005+4                                                   04640000
I00501   EQU   I005                                                     04641000
I00402   EQU   I004+4                                                   04642000
@NM00015 EQU   SCANIN+2                                                 04643000
@NM00014 EQU   CPHEADER+7                                               04644000
RETCHAR  EQU   RET+2                                                    04645000
RETSIZE  EQU   RET                                                      04646000
CPPLECT  EQU   CPPL+12                                                  04647000
CPPLPSCB EQU   CPPL+8                                                   04648000
CPPLUPT  EQU   CPPL+4                                                   04649000
CPPLCBUF EQU   CPPL                                                     04650000
SVTDATA  EQU   SVTELEM+4                                                04651000
SVTORIG  EQU   SVTELEM+2                                                04652000
SVTLNG   EQU   SVTELEM                                                  04653000
SVTABFRE EQU   SVTAB+12                                                 04654000
SVTABUSE EQU   SVTAB+8                                                  04655000
SVTABLNG EQU   SVTAB+4                                                  04656000
SVTABNXT EQU   SVTAB                                                    04657000
@NM00007 EQU   SNTFLAGS+1                                               04658000
SNTEVAL  EQU   SNTFLAGS                                                 04659000
SNTNAUTH EQU   SNTFLAGS                                                 04660000
SNTNOSCN EQU   SNTFLAGS                                                 04661000
SNTKEY   EQU   SNTFLAGS                                                 04662000
SNTPOSIT EQU   SNTFLAGS                                                 04663000
SNTELFST EQU   SNTAB+12                                                 04664000
COMRCDS  EQU   COMPROC+12                                               04665000
@NM00006 EQU   EXECDATA+60                                              04666000
FILEDCBS EQU   EXECDATA+56                                              04667000
RETPTR2  EQU   EXECDATA+52                                              04668000
ATACTEND EQU   EXECDATA+48                                              04669000
ATACTSTR EQU   EXECDATA+44                                              04670000
EXDLMPTR EQU   EXECDATA+40                                              04671000
NOLASTCC EQU   @NM00005+1                                               04672000
ATINCNTL EQU   @NM00005+1                                               04673000
ATTNCMD  EQU   @NM00005                                                 04674000
NOMSG    EQU   @NM00005                                                 04675000
CMAIN    EQU   @NM00005                                                 04676000
ERINCNTL EQU   @NM00005                                                 04677000
SYMLST   EQU   @NM00005                                                 04678000
NOFLUSH  EQU   @NM00005                                                 04679000
ERRCMD   EQU   @NM00005                                                 04680000
CONLST   EQU   @NM00005                                                 04681000
RETPTR   EQU   EXECDATA+28                                              04682000
ERACTEND EQU   EXECDATA+24                                              04683000
ERACTSTR EQU   EXECDATA+20                                              04684000
EXINSAVE EQU   @NM00004                                                 04685000
LASTTSO  EQU   EXECDATA+12                                              04686000
ECDAILNG EQU   ECDAINME                                                 04687000
ECDAGDAT EQU   ECDA+64                                                  04688000
@NM00003 EQU   ECDA+58                                                  04689000
SP78BLK  EQU   ECDAFLAG                                                 04690000
@NM00002 EQU   ECDAFLAG                                                 04691000
@NM00001 EQU   ECDAFLAG                                                 04692000
SP78CORE EQU   ECDAFLAG                                                 04693000
IMPLICIT EQU   ECDAFLAG                                                 04694000
ECDAEANS EQU   ECDA+8                                                   04695000
ECDAGADD EQU   ECDA+4                                                   04696000
IOPLECB  EQU   IOPL+8                                                   04697000
IOPLECT  EQU   IOPL+4                                                   04698000
IOPLUPT  EQU   IOPL                                                     04699000
LSDANEXT EQU   LSD+8                                                    04700000
LSDTOTLN EQU   LSD+6                                                    04701000
LSDRCLEN EQU   LSD+4                                                    04702000
LSDADATA EQU   LSD                                                      04703000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04704000
@RT00091 EQU   CMDCHKS                                                  04705000
@RT00097 EQU   SPCLEXIT                                                 04706000
@RT00115 EQU   TSOCALL                                                  04707000
@RT00213 EQU   @EL00002                                                 04708000
@RT00294 EQU   @EL00003                                                 04709000
@RT00297 EQU   @EL00003                                                 04710000
@RT00321 EQU   TSOCMD                                                   04711000
@RF00364 EQU   @EL00004                                                 04712000
@RF00363 EQU   @EL00004                                                 04713000
@RC00361 EQU   @EL00004                                                 04714000
@RC00359 EQU   @EL00004                                                 04715000
@RC00357 EQU   @EL00004                                                 04716000
@RC00355 EQU   @EL00004                                                 04717000
@RC00353 EQU   @EL00004                                                 04718000
@RF00382 EQU   @EL00005                                                 04719000
@RF00405 EQU   COMSCN                                                   04720000
@RT00417 EQU   LEAVE                                                    04721000
@RT00424 EQU   LEAVE                                                    04722000
@RT00434 EQU   @EL00007                                                 04723000
@RF00431 EQU   @EL00007                                                 04724000
@RC00429 EQU   @EL00007                                                 04725000
@RT00455 EQU   BADIF                                                    04726000
@RT00461 EQU   BADIF                                                    04727000
@RT00480 EQU   TRYAGN                                                   04728000
@RF00480 EQU   BADIF                                                    04729000
@RT00486 EQU   TRYAGN                                                   04730000
@RT00492 EQU   EXIT1                                                    04731000
@RF00508 EQU   OUT                                                      04732000
@RT00529 EQU   EXIT1                                                    04733000
@RT00539 EQU   OUT                                                      04734000
@RT00586 EQU   BADELSE                                                  04735000
@RF00684 EQU   REGDO                                                    04736000
@RT00696 EQU   SCANDO2                                                  04737000
@RT00698 EQU   REGDO                                                    04738000
@RT00700 EQU   DOBAD                                                    04739000
@RT00749 EQU   OPENDO                                                   04740000
@RT00751 EQU   GETAGN                                                   04741000
@RT00784 EQU   OFFAGN2                                                  04742000
@RT00786 EQU   NOOFF                                                    04743000
@RF00847 EQU   NEXTREC                                                  04744000
@RT00867 EQU   SETSCN2                                                  04745000
@RT00972 EQU   GLOB2                                                    04746000
@RT00998 EQU   MOVEOUT                                                  04747000
@RT01029 EQU   MOVEOUT                                                  04748000
@RT01033 EQU   BADCHR                                                   04749000
@RT01036 EQU   FOUND                                                    04750000
@RT01038 EQU   BADCHR                                                   04751000
@RT01040 EQU   NXTCHR                                                   04752000
@RT01065 EQU   NXTPARM                                                  04753000
@ENDDATA EQU   *                                                        04754000
         END   IKJCT432,(C'PLS1055',0701,77215)                         04755000
