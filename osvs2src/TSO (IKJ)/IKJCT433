         TITLE 'IKJCT433, EXEC CONTROL MODULE - PHASE II PART I        *00001000
                        '                                               00002000
IKJCT433 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'IKJCT433  77.215'                                 0001 00009000
IKJUPDT  DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00356-IKJUPDT)                                    00013000
         ENTRY IKJUPDT                                                  00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00016000
         BALR  @12,0                                               0001 00017000
@PSTART  LA    @11,4095(,@12)                                      0001 00018000
         LA    @10,4095(,@11)                                      0001 00019000
         USING @PSTART,@12                                         0001 00020000
         USING @PSTART+4095,@11                                    0001 00021000
         USING @PSTART+8190,@10                                    0001 00022000
         L     @00,@SIZDATD                                        0001 00023000
         IKJEXEC  R,LV=(0)                                              00024000
         LR    @09,@01                                             0001 00025000
         USING @DATD,@09                                           0001 00026000
         ST    @13,@SA00001+4                                      0001 00027000
         LM    @15,@01,16(@13)                                     0001 00028000
         ST    @09,8(,@13)                                         0001 00029000
         LR    @13,@09                                             0001 00030000
         AH    @15,4(,@15)                                         0001 00031000
         BR    @15                                                 0001 00032000
@EP00001 MVC   @PC00001(20),0(@01)                                 0001 00033000
*                                                                  0035 00034000
*   /*****************************************************************/ 00035000
*   /*                                                               */ 00036000
*   /* START OF EXECUTABLE CODE                                      */ 00037000
*   /*                                                               */ 00038000
*   /*****************************************************************/ 00039000
*                                                                  0035 00040000
*   CALL INTSETUP;                  /* INIT MAIN SWITCHES - VARIABLES*/ 00041000
         BAL   @14,INTSETUP                                        0035 00042000
*   OLDLINE=GTPBLINE;               /* POINT TO OLD RECORD           */ 00043000
         L     @15,@PC00001+12                                     0036 00044000
         L     @15,GTPBLINE(,@15)                                  0036 00045000
         ST    @15,OLDLINE(,COMONPTR)                              0036 00046000
*   SCANLIM=F0;                     /* CLEAR SCAN LIMIT              */ 00047000
         SLR   @15,@15                                             0037 00048000
         ST    @15,SCANLIM                                         0037 00049000
*   ERCOM=F0;                       /* INIT ERROR COUNTER (COMMON)   */ 00050000
         ST    @15,ERCOM(,COMONPTR)                                0038 00051000
*   CONTINU=YES;                    /* ALLOW CONTINUING              */ 00052000
         OI    CONTINU(COMONPTR),B'01000000'                       0039 00053000
*   STM(R9,R12,REGAREA);            /* SAVE PHASE2 PART 1 REGS       */ 00054000
         STM   R9,R12,REGAREA(COMONPTR)                            0040 00055000
*   DO WHILE CONTINU=YES;           /* PROCESS UNTIL DONE            */ 00056000
         B     @DE00041                                            0041 00057000
@DL00041 DS    0H                                                  0042 00058000
*     EXECDPTR=LSDEXEC;             /* BASE EXEC DATA ON PTR IN LSD  */ 00059000
         L     @01,LSDPTR(,COMONPTR)                               0042 00060000
         L     @15,LSDEXEC(,@01)                                   0042 00061000
         ST    @15,EXECDPTR(,COMONPTR)                             0042 00062000
*     ERROR=F0;                     /* INIT ERROR COUNTER TO ZERO    */ 00063000
         SLR   @14,@14                                             0043 00064000
         ST    @14,ERROR                                           0043 00065000
*     SWS=''B;                      /* CLEAR INIT SWITCHES           */ 00066000
         XC    SWS(5,COMONPTR),SWS(COMONPTR)                       0044 00067000
*     NEWBASE=MIN(BUFBASE,NEWBASE); /* POINTER TO OLD BUFFER IF ONE  */ 00068000
         L     @14,BUFBASE(,COMONPTR)                              0045 00069000
         L     @07,NEWBASE(,COMONPTR)                              0045 00070000
         CR    @14,@07                                             0045 00071000
         BNH   *+6                                                      00072000
         LR    @14,@07                                             0045 00073000
         ST    @14,NEWBASE(,COMONPTR)                              0045 00074000
*     BUFBASE=GTPBLINE;             /* SET BASE TO LINE PASSED       */ 00075000
         L     @14,@PC00001+12                                     0046 00076000
         L     @14,GTPBLINE(,@14)                                  0046 00077000
         ST    @14,BUFBASE(,COMONPTR)                              0046 00078000
*     IF GTPBLINE>=ERACTSTR&GTPBLINE<ERACTEND&/* IF ERROR ACTIVE     */ 00079000
*         ERINCNTL=YES THEN         /* AND WITHIN RANGE              */ 00080000
         C     @14,ERACTSTR(,@15)                                  0047 00081000
         BL    @RF00047                                            0047 00082000
         C     @14,ERACTEND(,@15)                                  0047 00083000
         BNL   @RF00047                                            0047 00084000
         TM    ERINCNTL(@15),B'00001000'                           0047 00085000
         BNO   @RF00047                                            0047 00086000
*       ERRRANGE=YES;               /* SET ERROR RANGE INDICATOR     */ 00087000
         OI    ERRRANGE(COMONPTR),B'00000100'                      0048 00088000
*     ELSE                          /* OTHERWISE                     */ 00089000
*       IF ERINCNTL=YES THEN        /* IF DROPPING OUT OF ERROR      */ 00090000
         B     @RC00047                                            0049 00091000
@RF00047 L     @15,EXECDPTR(,COMONPTR)                             0049 00092000
         TM    ERINCNTL(@15),B'00001000'                           0049 00093000
         BNO   @RF00049                                            0049 00094000
*         DO;                       /* SWAP RETURN POINTERS          */ 00095000
*           RETPTR=RETPTR&&RETPTR2; /*                               */ 00096000
         L     @14,RETPTR2(,@15)                                   0051 00097000
         L     @07,RETPTR(,@15)                                    0051 00098000
         XR    @07,@14                                             0051 00099000
         ST    @07,RETPTR(,@15)                                    0051 00100000
*           RETPTR2=RETPTR2&&RETPTR;/*                               */ 00101000
         XR    @14,@07                                             0052 00102000
         ST    @14,RETPTR2(,@15)                                   0052 00103000
*           RETPTR=RETPTR&&RETPTR2; /*                               */ 00104000
         XR    @07,@14                                             0053 00105000
         ST    @07,RETPTR(,@15)                                    0053 00106000
*           ERINCNTL=NO;            /* RESET SWITCH                  */ 00107000
         NI    ERINCNTL(@15),B'11110111'                           0054 00108000
*         END;                      /*                               */ 00109000
*     IF GTPBLINE>=ATACTSTR&GTPBLINE<ATACTEND&/* IF ERROR ACTIVE     */ 00110000
*         ATINCNTL=YES THEN         /* AND WITHIN RANGE              */ 00111000
@RF00049 DS    0H                                                  0056 00112000
@RC00047 L     @15,@PC00001+12                                     0056 00113000
         L     @15,GTPBLINE(,@15)                                  0056 00114000
         L     @14,EXECDPTR(,COMONPTR)                             0056 00115000
         C     @15,ATACTSTR(,@14)                                  0056 00116000
         BL    @RF00056                                            0056 00117000
         C     @15,ATACTEND(,@14)                                  0056 00118000
         BNL   @RF00056                                            0056 00119000
         TM    ATINCNTL(@14),B'10000000'                           0056 00120000
         BNO   @RF00056                                            0056 00121000
*       ATRANGE=YES;                /* SET ERROR RANGE INDICATOR     */ 00122000
         OI    ATRANGE(COMONPTR),B'00000010'                       0057 00123000
*     ELSE                          /* OTHERWISE                     */ 00124000
*       IF ATINCNTL=YES THEN        /* IF DROPPING OUT OF ERROR      */ 00125000
         B     @RC00056                                            0058 00126000
@RF00056 L     @15,EXECDPTR(,COMONPTR)                             0058 00127000
         TM    ATINCNTL(@15),B'10000000'                           0058 00128000
         BNO   @RF00058                                            0058 00129000
*         DO;                       /* SWAP RETURN POINTERS          */ 00130000
*           RETPTR=RETPTR&&RETPTR2; /*                               */ 00131000
         L     @14,RETPTR2(,@15)                                   0060 00132000
         L     @07,RETPTR(,@15)                                    0060 00133000
         XR    @07,@14                                             0060 00134000
         ST    @07,RETPTR(,@15)                                    0060 00135000
*           RETPTR2=RETPTR2&&RETPTR;/*                               */ 00136000
         XR    @14,@07                                             0061 00137000
         ST    @14,RETPTR2(,@15)                                   0061 00138000
*           RETPTR=RETPTR&&RETPTR2; /*                               */ 00139000
         XR    @07,@14                                             0062 00140000
         ST    @07,RETPTR(,@15)                                    0062 00141000
*           ATINCNTL=NO;            /* RESET SWITCH                  */ 00142000
         NI    ATINCNTL(@15),B'01111111'                           0063 00143000
*         END;                      /*                               */ 00144000
*     IF ECTATTN=YES THEN           /* IF TMP ATTN ENTRY      @Z30969*/ 00145000
@RF00058 DS    0H                                                  0065 00146000
@RC00056 L     @15,@PC00001+4                                      0065 00147000
         TM    ECTATTN(@15),B'00000001'                            0065 00148000
         BNO   @RF00065                                            0065 00149000
*       DO;                         /* PROCESS                       */ 00150000
*         ECTATTN=NO;               /* RESET ENTRY                   */ 00151000
         NI    ECTATTN(@15),B'11111110'                            0067 00152000
*         ATINCNTL=YES;             /* SET CNTL BIT                  */ 00153000
         L     @01,EXECDPTR(,COMONPTR)                             0068 00154000
         OI    ATINCNTL(@01),B'10000000'                           0068 00155000
*         CALL RETUPDT(GTPBLINE);   /* SET RETURN POINTER            */ 00156000
         L     @15,@PC00001+12                                     0069 00157000
         LA    @15,GTPBLINE(,@15)                                  0069 00158000
         ST    @15,@AL00001                                        0069 00159000
         LA    @01,@AL00001                                        0069 00160000
         BAL   @14,RETUPDT                                         0069 00161000
*         LSDANEXT=ATACTSTR;        /* BRANCH TO ACTION START        */ 00162000
         L     @15,LSDPTR(,COMONPTR)                               0070 00163000
         L     @14,EXECDPTR(,COMONPTR)                             0070 00164000
         L     @14,ATACTSTR(,@14)                                  0070 00165000
         ST    @14,LSDANEXT(,@15)                                  0070 00166000
*         ERROR=E4;                 /* GET ANOTHER COMMAND           */ 00167000
         MVC   ERROR(4),@CF00107                                   0071 00168000
*         GTPBLINE=LSDANEXT;        /* SAVE LSDANEXT         @ZA08099*/ 00169000
         L     @07,@PC00001+12                                     0072 00170000
         ST    @14,GTPBLINE(,@07)                                  0072 00171000
*         LSDANEXT=LSDANEXT+LSDANEXT->LL;/* UPDATE LSD POINTER     0073 00172000
*                                                            @ZA08099*/ 00173000
         LH    @07,LL(,@14)                                        0073 00174000
         ALR   @07,@14                                             0073 00175000
         ST    @07,LSDANEXT(,@15)                                  0073 00176000
*         GOTO FASTCYCL;            /* START MAIN LOOP AGAIN @ZA08099*/ 00177000
         B     FASTCYCL                                            0074 00178000
*       END;                        /*                               */ 00179000
*                                                                  0076 00180000
*     /***************************************************************/ 00181000
*     /*                                                             */ 00182000
*     /* PROCESS RETURN CODES                                        */ 00183000
*     /*                                                             */ 00184000
*     /***************************************************************/ 00185000
*                                                                  0076 00186000
*     ERRSAV=ECTRTCD;               /* SAVE ECT RETURN CODE          */ 00187000
@RF00065 L     @15,@PC00001+4                                      0076 00188000
         L     @14,ECTRTCD-1(,@15)                                 0076 00189000
         LA    @14,0(,@14)                                         0076 00190000
         ST    @14,ERRSAV                                          0076 00191000
*     IF ECTRCDF=ABNDFLG THEN       /* IF CODE IS ABEND              */ 00192000
         CLI   ECTRCDF(@15),X'80'                                  0077 00193000
         BNE   @RF00077                                            0077 00194000
*       RCABEND=YES;                /* USE ABEND CONVERSION          */ 00195000
         OI    RCABEND(COMONPTR),B'10000000'                       0078 00196000
*     IF ERRSAV^=F0 THEN            /* IF TSO CMD ENDED IN ERROR     */ 00197000
@RF00077 L     @15,ERRSAV                                          0079 00198000
         LTR   @15,@15                                             0079 00199000
         BZ    @RF00079                                            0079 00200000
*       DO;                         /*                               */ 00201000
*         IF ERRCMD=NO THEN         /* AN NO ERROR IN EFFECT         */ 00202000
         L     @01,EXECDPTR(,COMONPTR)                             0081 00203000
         TM    ERRCMD(@01),B'01000000'                             0081 00204000
         BNZ   @RF00081                                            0081 00205000
*           CALL RCUPDT;            /* UPDATE LASTCC AND MAXCC       */ 00206000
         BAL   @14,RCUPDT                                          0082 00207000
*         ELSE                      /* OTHERWISE                     */ 00208000
*           DO;                     /* CHECK IF ERROR ALREADY IN CNTL*/ 00209000
         B     @RC00081                                            0083 00210000
@RF00081 DS    0H                                                  0084 00211000
*             IF ERRRANGE=YES THEN  /* IF IT IS THEN SET ERROR CODE  */ 00212000
         TM    ERRRANGE(COMONPTR),B'00000100'                      0084 00213000
         BNO   @RF00084                                            0084 00214000
*               IF GTPBLINE^=ERACTSTR THEN/* NOT FIRST ERROR CMD     */ 00215000
         L     @15,@PC00001+12                                     0085 00216000
         L     @01,EXECDPTR(,COMONPTR)                             0085 00217000
         CLC   GTPBLINE(4,@15),ERACTSTR(@01)                       0085 00218000
         BE    @RF00085                                            0085 00219000
*                 DO;               /* MUST HAVE BEEN A TSO COMMAND  */ 00220000
*                   BACKUP=YES;     /* BACK UP AND LIST LAST TSO     */ 00221000
         OI    BACKUP(COMONPTR),B'00000001'                        0087 00222000
*                   ERROR=E908;     /*                               */ 00223000
         MVC   ERROR(4),@CF00785                                   0088 00224000
*                 END;              /*                               */ 00225000
*               ELSE                                               0090 00226000
*                 ;                 /* OTHERWISE NOTHING             */ 00227000
@RF00085 DS    0H                                                  0091 00228000
*             ELSE                  /* OTHERWISE GIVE ERRACTION CNTL */ 00229000
*               DO;                 /*                               */ 00230000
         B     @RC00084                                            0091 00231000
@RF00084 DS    0H                                                  0092 00232000
*                 CALL RCUPDT;      /* PROCESS MAXCC AND LASTCC      */ 00233000
         BAL   @14,RCUPDT                                          0092 00234000
*                 IF ERACTSTR^=F0 THEN/* IF A ERROR ACTION SPECIFIED */ 00235000
         L     @15,EXECDPTR(,COMONPTR)                             0093 00236000
         L     @14,ERACTSTR(,@15)                                  0093 00237000
         LTR   @14,@14                                             0093 00238000
         BZ    @RF00093                                            0093 00239000
*                   DO;             /* GO TO ERRACTION               */ 00240000
*                     ERINCNTL=YES; /* SET ERROR IN CONTROL          */ 00241000
         OI    ERINCNTL(@15),B'00001000'                           0095 00242000
*                     CALL RETUPDT(GTPBLINE);/* UPDATE RETURN POINT  */ 00243000
         L     @15,@PC00001+12                                     0096 00244000
         LA    @15,GTPBLINE(,@15)                                  0096 00245000
         ST    @15,@AL00001                                        0096 00246000
         LA    @01,@AL00001                                        0096 00247000
         BAL   @14,RETUPDT                                         0096 00248000
*                     LSDANEXT=ERACTSTR;/* UPDATE LSD NEXT CMD       */ 00249000
         L     @01,LSDPTR(,COMONPTR)                               0097 00250000
         L     @15,EXECDPTR(,COMONPTR)                             0097 00251000
         L     @00,ERACTSTR(,@15)                                  0097 00252000
         ST    @00,LSDANEXT(,@01)                                  0097 00253000
*                     ERROR=E4;     /* SET ERROR CODE                */ 00254000
         MVC   ERROR(4),@CF00107                                   0098 00255000
*                     GOTO FASTEXIT;/* GET NEXT COMMAND              */ 00256000
         B     FASTEXIT                                            0099 00257000
*                   END;            /*                               */ 00258000
*                 ELSE              /* IF NO ERROR ACTION, SET UP    */ 00259000
*                   IF INSLIST=NO THEN/* TSO NOT ALREADY LISTED      */ 00260000
@RF00093 L     @15,@PC00001+4                                      0101 00261000
         L     @01,ECTIOWA(,@15)                                   0101 00262000
         L     @01,IOSTELM(,@01)                                   0101 00263000
         TM    INSLIST(@01),B'00000001'                            0101 00264000
         BNZ   @RF00101                                            0101 00265000
*                     BACKUP=YES;   /* BACKUP TO LIST TSO            */ 00266000
         OI    BACKUP(COMONPTR),B'00000001'                        0102 00267000
*               END;                /*                               */ 00268000
@RF00101 DS    0H                                                  0104 00269000
*             IF BACKUP=YES THEN    /* BACK UP AND LIST ?            */ 00270000
@RC00084 TM    BACKUP(COMONPTR),B'00000001'                        0104 00271000
         BNO   @RF00104                                            0104 00272000
*               DO;                 /* YES -                         */ 00273000
*                 LSDANEXT=GTPBLINE;/* BACK UP LSD COMMAND POINTER   */ 00274000
         L     @01,LSDPTR(,COMONPTR)                               0106 00275000
         L     @15,@PC00001+12                                     0106 00276000
         L     @00,GTPBLINE(,@15)                                  0106 00277000
         ST    @00,LSDANEXT(,@01)                                  0106 00278000
*                 GTPBLINE=LASTTSO; /* GET TSO COMMAND               */ 00279000
         L     @01,EXECDPTR(,COMONPTR)                             0107 00280000
         L     @14,LASTTSO(,@01)                                   0107 00281000
         ST    @14,GTPBLINE(,@15)                                  0107 00282000
*                 BUFBASE=LASTTSO;  /* POINT BUFFER TO LAST TSO CMD  */ 00283000
         ST    @14,BUFBASE(,COMONPTR)                              0108 00284000
*                 LISTONLY=YES;     /* LIST COMMAND ONLY             */ 00285000
         OI    LISTONLY(COMONPTR),B'00100000'                      0109 00286000
*               END;                /*                               */ 00287000
*           END;                    /*                               */ 00288000
@RF00104 DS    0H                                                  0112 00289000
*         ECTRTCD=F0;               /* ZERO ECT RETURN CODE          */ 00290000
@RC00081 L     @15,@PC00001+4                                      0112 00291000
         SLR   @14,@14                                             0112 00292000
         STCM  @14,7,ECTRTCD(@15)                                  0112 00293000
*         ECTRCDF=''B;              /* ZERO ABEND FLAG IF ON         */ 00294000
         MVI   ECTRCDF(@15),X'00'                                  0113 00295000
*       END;                        /*                               */ 00296000
*     ELSE                          /* IF RETURN CODE WAS ZERO       */ 00297000
*       IF ERRRANGE=NO THEN         /* AND NOT IN ERROR RANGE        */ 00298000
         B     @RC00079                                            0115 00299000
@RF00079 TM    ERRRANGE(COMONPTR),B'00000100'                      0115 00300000
         BNZ   @RF00115                                            0115 00301000
*         CALL RCUPDT;              /* UPDATE RETURN CODES           */ 00302000
         BAL   @14,RCUPDT                                          0116 00303000
*     RCABEND=NO;                   /* INSURE ABEND CLEAR            */ 00304000
@RF00115 DS    0H                                                  0117 00305000
@RC00079 NI    RCABEND(COMONPTR),B'01111111'                       0117 00306000
*                                                                  0118 00307000
*     /***************************************************************/ 00308000
*     /*                                                             */ 00309000
*     /* SYMBOLIC SUBSTITUTION INITIALIZATION                        */ 00310000
*     /*                                                             */ 00311000
*     /***************************************************************/ 00312000
*                                                                  0118 00313000
*     OLDLINE=GTPBLINE;             /* BASE FOR OLD LINE WITH PARMS  */ 00314000
         L     @15,@PC00001+12                                     0118 00315000
         L     @15,GTPBLINE(,@15)                                  0118 00316000
         ST    @15,OLDLINE(,COMONPTR)                              0118 00317000
*     V2=F0;                        /* INIT TO ZERO                  */ 00318000
         SLR   @15,@15                                             0119 00319000
         ST    @15,V2                                              0119 00320000
*     MYO2=O2-OO+F1;                /* SET OFFSET TO START OF SCAN   */ 00321000
         L     @15,BUFBASE(,COMONPTR)                              0120 00322000
         LH    @14,OO(,@15)                                        0120 00323000
         LH    @15,O2(,@15)                                        0120 00324000
         SLR   @15,@14                                             0120 00325000
         AL    @15,@CF00042                                        0120 00326000
         ST    @15,MYO2(,COMONPTR)                                 0120 00327000
*     IF CORE=NO THEN               /* IF NO CORE HAS BEEN GOTTEN    */ 00328000
         TM    CORE(COMONPTR),B'10000000'                          0121 00329000
         BNZ   @RF00121                                            0121 00330000
*       CALL GETMORE(EVAL(-OO));    /* GETMAIN FOR NEW BUFFER        */ 00331000
         LCR   @14,@14                                             0122 00332000
         ST    @14,@AFTEMPS+4                                      0122 00333000
         LA    @15,@AFTEMPS+4                                      0122 00334000
         ST    @15,@AL00001                                        0122 00335000
         LA    @01,@AL00001                                        0122 00336000
         BAL   @14,GETMORE                                         0122 00337000
*     ELSE                          /* IF OTHER THAN FIRST LOOP      */ 00338000
*       IF LL>NEWLL THEN            /* IF NEW LINE BIGGER THAN GOTTEN*/ 00339000
         B     @RC00121                                            0123 00340000
@RF00121 L     @01,BUFBASE(,COMONPTR)                              0123 00341000
         L     @15,NEWBASE(,COMONPTR)                              0123 00342000
         LH    @15,NEWLL(,@15)                                     0123 00343000
         CH    @15,LL(,@01)                                        0123 00344000
         BNL   @RF00123                                            0123 00345000
*         DO;                       /* CORE, GET MORE CORE           */ 00346000
*           DO;                     /* FREEMAIN LV(NEWLL*2)        0125 00347000
*                                      A(NEWBASE) SP(1) MF(E,FRELST) */ 00348000
*             RESPECIFY                                            0126 00349000
*              (GPR01P) RESTRICTED;                                0126 00350000
*             FRELST02=NEWLL*2;     /* LENGTH                        */ 00351000
         ALR   @15,@15                                             0127 00352000
         STCM  @15,7,FRELST02                                      0127 00353000
*             FRELST04=ADDR(NEWBASE);/* ADDR OF ADDR LIST            */ 00354000
         LA    @00,NEWBASE(,COMONPTR)                              0128 00355000
         STCM  @00,7,FRELST04                                      0128 00356000
*             FRELST06=1;           /* SUBPOOL VALUE                 */ 00357000
         MVI   FRELST06,X'01'                                      0129 00358000
*             GPR01P=ADDR(FRELST);  /* REG1 POINTS TO LIST           */ 00359000
         LA    GPR01P,FRELST                                       0130 00360000
*             SVC(5);               /* STANDARD-FORM OF GETMAIN      */ 00361000
         SVC   5                                                   0131 00362000
*             RESPECIFY                                            0132 00363000
*              (GPR01P) UNRESTRICTED;                              0132 00364000
*           END;                    /* FREEMAIN LV(NEWLL*2)        0133 00365000
*                                      A(NEWBASE) SP(1) MF(E,FRELST) */ 00366000
*           CORE=NO;                /* YES WE HAVE NO CORE TODAY     */ 00367000
         NI    CORE(COMONPTR),B'01111111'                          0134 00368000
*           CALL GETMORE(EVAL(-OO));/* MINIMUM CORE REQIRED          */ 00369000
         L     @01,BUFBASE(,COMONPTR)                              0135 00370000
         LH    @15,OO(,@01)                                        0135 00371000
         LCR   @15,@15                                             0135 00372000
         ST    @15,@AFTEMPS+4                                      0135 00373000
         LA    @15,@AFTEMPS+4                                      0135 00374000
         ST    @15,@AL00001                                        0135 00375000
         LA    @01,@AL00001                                        0135 00376000
         BAL   @14,GETMORE                                         0135 00377000
*         END;                      /*                               */ 00378000
*       ELSE                        /* OTHERWISE                     */ 00379000
*         FREEAMT=NEWLL-(LL-OO);    /* SET FREEAMT                   */ 00380000
         B     @RC00123                                            0137 00381000
@RF00123 L     @01,NEWBASE(,COMONPTR)                              0137 00382000
         L     @15,BUFBASE(,COMONPTR)                              0137 00383000
         LH    @14,LL(,@15)                                        0137 00384000
         SH    @14,OO(,@15)                                        0137 00385000
         LCR   @14,@14                                             0137 00386000
         AH    @14,NEWLL(,@01)                                     0137 00387000
         ST    @14,FREEAMT(,COMONPTR)                              0137 00388000
*                                                                  0138 00389000
*     /***************************************************************/ 00390000
*     /*                                                             */ 00391000
*     /* COPY INPUT BUFFER TO GOTTEN BUFFER                          */ 00392000
*     /*                                                             */ 00393000
*     /***************************************************************/ 00394000
*                                                                  0138 00395000
*     RFY                                                          0138 00396000
*      (R2,                                                        0138 00397000
*       R3,                                                        0138 00398000
*       R4,                                                        0138 00399000
*       R5) RSTD;                   /* RESTRICT REGS FOR MVCL        */ 00400000
@RC00123 DS    0H                                                  0138 00401000
@RC00121 DS    0H                                                  0139 00402000
*     R2=(ADDR(NEWC(1)));           /* POINTER TO 'TO' BUFFER        */ 00403000
         L     @15,NEWBASE(,COMONPTR)                              0139 00404000
         LA    R2,NEWC(,@15)                                       0139 00405000
*     R4=ADDR(C(OO+1));             /* POINTER TO 'FROM' BUFFER      */ 00406000
         L     @14,BUFBASE(,COMONPTR)                              0140 00407000
         LH    @07,OO(,@14)                                        0140 00408000
         LA    R4,C(@07,@14)                                       0140 00409000
*     R3=NEWLL-F4;                  /* LENGTH OF 'TO' BUFFER         */ 00410000
         LA    @06,4                                               0141 00411000
         LH    R3,NEWLL(,@15)                                      0141 00412000
         SLR   R3,@06                                              0141 00413000
*     R5=(LL-(F4+OO))|BLANKS;       /* LENGTH OF 'FROM' BUFFER AND 0142 00414000
*                                      PADDING CHARACTER FOR MVCL    */ 00415000
         ALR   @07,@06                                             0142 00416000
         LCR   @07,@07                                             0142 00417000
         AH    @07,LL(,@14)                                        0142 00418000
         O     @07,@CF00622                                        0142 00419000
         LR    R5,@07                                              0142 00420000
*     MVCL(R2,R4);                  /* MOVE TO NEW BUFFER            */ 00421000
         MVCL  R2,R4                                               0143 00422000
*     RFY                                                          0144 00423000
*      (R2,                                                        0144 00424000
*       R3,                                                        0144 00425000
*       R4,                                                        0144 00426000
*       R5) UNRSTD;                 /* RELEASE REGISTERS             */ 00427000
*     BUFBASE=NEWBASE;              /* POINT TO GOTTEN BUFFER        */ 00428000
         L     @15,NEWBASE(,COMONPTR)                              0145 00429000
         ST    @15,BUFBASE(,COMONPTR)                              0145 00430000
*     OO=F0;                        /* ZERO OFFSET FIELD             */ 00431000
         SLR   @14,@14                                             0146 00432000
         STH   @14,OO(,@15)                                        0146 00433000
*     NEWBASE=NEWBASE+LL;           /* POINT TO NEW BUFFER           */ 00434000
         LH    @07,LL(,@15)                                        0147 00435000
         ALR   @15,@07                                             0147 00436000
         ST    @15,NEWBASE(,COMONPTR)                              0147 00437000
*     IF ERROR=E16 THEN             /* IF A GETMAIN ERROR OCCURRED   */ 00438000
         L     @06,ERROR                                           0148 00439000
         C     @06,@CF00104                                        0148 00440000
         BE    @RT00148                                            0148 00441000
*       GO TO FASTEXIT;             /* PROCESS ERROR MSG AND QUIT    */ 00442000
*     CORE=YES;                     /* CORE HAS BEEN GOTTEN          */ 00443000
         OI    CORE(COMONPTR),B'10000000'                          0150 00444000
*     NEWLL=LL;                     /* INIT LENGTH                   */ 00445000
         STH   @07,NEWLL(,@15)                                     0151 00446000
*     NEWOO=F0;                     /* INIT OFFSET                   */ 00447000
         STH   @14,NEWOO(,@15)                                     0152 00448000
*     IF ERROR=F0 THEN              /* IF OK SO FAR                  */ 00449000
         CR    @06,@14                                             0153 00450000
         BNE   @RF00153                                            0153 00451000
*       DO;                         /* LOCATE SYSDLM                 */ 00452000
*         CALL LOCATE(SYSSCAN,LENGTH(SYSSCAN),F0);/* LOCATE SYSSCAN  */ 00453000
         LA    @01,@AL00155                                        0155 00454000
         BAL   @14,LOCATE                                          0155 00455000
*         IF ERROR=F0 THEN          /* IF LOCATE SUCCESSFUL          */ 00456000
         L     @15,ERROR                                           0156 00457000
         LTR   @15,@15                                             0156 00458000
         BNZ   @RF00156                                            0156 00459000
*           DO;                     /* PROCESS VALUE                 */ 00460000
*             ANSPTR=ADDR(SVTDATA); /* POINT TO SCAN DATA            */ 00461000
         L     @01,SNTELPTR(,COMONPTR)                             0158 00462000
         L     @15,SNTVLPTR(,@01)                                  0158 00463000
         LA    @14,SVTDATA(,@15)                                   0158 00464000
         ST    @14,ANSPTR(,COMONPTR)                               0158 00465000
*             CLEN=SVTLNG;          /* LENGTH OF SCAN NUMBER         */ 00466000
         LH    @15,SVTLNG(,@15)                                    0159 00467000
         STH   @15,CLEN(,COMONPTR)                                 0159 00468000
*             CALL CONVERT;         /* CONVERT TO USABLE FORM        */ 00469000
         BAL   @14,CONVERT                                         0160 00470000
*             SCANLIM=V2;           /* SET SCAN LIMIT                */ 00471000
         L     @15,V2                                              0161 00472000
         ST    @15,SCANLIM                                         0161 00473000
*             IF ERROR^=F0 THEN     /* VONVERT OK                    */ 00474000
         L     @15,ERROR                                           0162 00475000
         LTR   @15,@15                                             0162 00476000
         BZ    @RF00162                                            0162 00477000
*               ERROR=E960;         /* SET ERROR CODE                */ 00478000
         MVC   ERROR(4),@CF00811                                   0163 00479000
*           END;                    /*                               */ 00480000
*         ELSE                      /* OTHERWISE                     */ 00481000
*           ERROR=E999;             /* SET ERROR CODE                */ 00482000
         B     @RC00156                                            0165 00483000
@RF00156 MVC   ERROR(4),@CF00817                                   0165 00484000
*       END;                                                       0166 00485000
@RC00156 DS    0H                                                  0167 00486000
*     IF SYMLST=YES THEN            /* SYMBOL LIST SPECIFIED ?       */ 00487000
@RF00153 L     @01,EXECDPTR(,COMONPTR)                             0167 00488000
         TM    SYMLST(@01),B'00010000'                             0167 00489000
         BNO   @RF00167                                            0167 00490000
*       CALL CMDLST;                /* LIST COMMAND                  */ 00491000
         BAL   @14,CMDLST                                          0168 00492000
*     IF OPCODE=IFCODE THEN         /* ON IF CMD, REMOVE 'THEN'      */ 00493000
@RF00167 L     @01,OLDLINE(,COMONPTR)                              0169 00494000
         CLI   OPCODE(@01),2                                       0169 00495000
         BNE   @RF00169                                            0169 00496000
*       FREEAMT=FREEAMT+F4;         /* LOGICALLY REMOVE THEN         */ 00497000
         LA    @15,4                                               0170 00498000
         AL    @15,FREEAMT(,COMONPTR)                              0170 00499000
         ST    @15,FREEAMT(,COMONPTR)                              0170 00500000
*                                                                  0171 00501000
*     /***************************************************************/ 00502000
*     /*                                                             */ 00503000
*     /* SYMBOLIC SUBSTITUTION MAINLINE                              */ 00504000
*     /*                                                             */ 00505000
*     /***************************************************************/ 00506000
*                                                                  0171 00507000
*     DO Z=1 TO SCANLIM WHILE EXITA=NO&ERROR=F0;/* SUB TO SCANLIM OR    00508000
*                                      DONE                          */ 00509000
@RF00169 LA    @15,1                                               0171 00510000
         B     @DE00171                                            0171 00511000
@DL00171 TM    EXITA(COMONPTR),B'10000000'                         0171 00512000
         BNZ   @DC00171                                            0171 00513000
         L     @15,ERROR                                           0171 00514000
         LTR   @15,@15                                             0171 00515000
         BNZ   @DC00171                                            0171 00516000
*       EXITA=YES;                  /* CAUSE END UNLESS INSERT HAS 0172 00517000
*                                      BEEN CALLED AT LEAST ONCE     */ 00518000
         OI    EXITA(COMONPTR),B'10000000'                         0172 00519000
*       DO I=MYO2 TO LL-(F4+FREEAMT) WHILE ERROR=F0;/* SCAN RECORD   */ 00520000
         L     @15,MYO2(,COMONPTR)                                 0173 00521000
         B     @DE00173                                            0173 00522000
@DL00173 L     @15,ERROR                                           0173 00523000
         LTR   @15,@15                                             0173 00524000
         BNZ   @DC00173                                            0173 00525000
*         IF C(I)=AMPSAND THEN      /* IF AN AMPERSAND               */ 00526000
         L     @15,I(,COMONPTR)                                    0174 00527000
         L     @14,BUFBASE(,COMONPTR)                              0174 00528000
         ALR   @14,@15                                             0174 00529000
         CLI   C-1(@14),C'&&'                                      0174 00530000
         BNE   @RF00174                                            0174 00531000
*           DO;                     /*                               */ 00532000
*             I=I+F1;               /* SKIP AMPERSAND                */ 00533000
         AL    @15,@CF00042                                        0176 00534000
         ST    @15,I(,COMONPTR)                                    0176 00535000
*             V=I;                  /* SAVE START OF VARIABLE        */ 00536000
         ST    @15,V                                               0177 00537000
*             CALL SCANWORD;        /* SCAN FOR VALID CHARS          */ 00538000
         BAL   @14,SCANWORD                                        0178 00539000
*             IF C(I)=PERIOD THEN   /* IF A CONCAT '.', SQUASH IT OUT*/ 00540000
         L     @01,I(,COMONPTR)                                    0179 00541000
         L     @15,BUFBASE(,COMONPTR)                              0179 00542000
         ALR   @15,@01                                             0179 00543000
         CLI   C-1(@15),C'.'                                       0179 00544000
         BNE   @RF00179                                            0179 00545000
*               CALL SQUASH;        /* GET RID OF PERIOD             */ 00546000
         BAL   @14,SQUASH                                          0180 00547000
*             IF LEN=F0 THEN        /* IF ONLY AN AMPERSAND          */ 00548000
@RF00179 L     @15,LEN(,COMONPTR)                                  0181 00549000
         LTR   @15,@15                                             0181 00550000
         BNZ   @RF00181                                            0181 00551000
*               IF C(I)^=AMPSAND THEN/* IF NOT DOUBLE AMPERSANDS     */ 00552000
         L     @01,I(,COMONPTR)                                    0182 00553000
         L     @15,BUFBASE(,COMONPTR)                              0182 00554000
         ALR   @15,@01                                             0182 00555000
         CLI   C-1(@15),C'&&'                                      0182 00556000
         BE    @RF00182                                            0182 00557000
*                 ERROR=E900;       /* SET ERROR CODE                */ 00558000
         MVC   ERROR(4),@CF00781                                   0183 00559000
*               ELSE                                               0184 00560000
*                 ;                 /* OTHERWISE NOTHING             */ 00561000
@RF00182 DS    0H                                                  0185 00562000
*             ELSE                  /* OTHERWISE SUBSTITUTE VALUE    */ 00563000
*               CALL INSERT;        /* CALL INSERT ROUTINE           */ 00564000
         B     @RC00181                                            0185 00565000
@RF00181 BAL   @14,INSERT                                          0185 00566000
*           END;                                                   0186 00567000
*         ELSE                      /* IF NOT AN & CHECK FOR COMMENT */ 00568000
*           IF I<LL-(FREEAMT+F4)&C(I:I+F1)=OPENCMT THEN/*            */ 00569000
         B     @RC00174                                            0187 00570000
@RF00174 L     @15,I(,COMONPTR)                                    0187 00571000
         L     @14,BUFBASE(,COMONPTR)                              0187 00572000
         LA    @07,4                                               0187 00573000
         AL    @07,FREEAMT(,COMONPTR)                              0187 00574000
         LCR   @07,@07                                             0187 00575000
         AH    @07,LL(,@14)                                        0187 00576000
         CR    @15,@07                                             0187 00577000
         BNL   @RF00187                                            0187 00578000
         ALR   @14,@15                                             0187 00579000
         CLC   C-1(2,@14),@CC00628                                 0187 00580000
         BNE   @RF00187                                            0187 00581000
*             DO I=I+F3 TO LL-(F4+FREEAMT) WHILE C(I-F1:I)^=CLOSCMT;    00582000
         AL    @15,@CF00054                                        0188 00583000
         B     @DE00188                                            0188 00584000
@DL00188 L     @01,I(,COMONPTR)                                    0188 00585000
         L     @15,BUFBASE(,COMONPTR)                              0188 00586000
         ALR   @15,@01                                             0188 00587000
         CLC   C-2(2,@15),@CC00630                                 0188 00588000
         BE    @DC00188                                            0188 00589000
*                                   /*                               */ 00590000
*             END;                  /* FIND END OF COMMENT           */ 00591000
         LA    @15,1                                               0189 00592000
         AL    @15,I(,COMONPTR)                                    0189 00593000
@DE00188 ST    @15,I(,COMONPTR)                                    0189 00594000
         L     @14,BUFBASE(,COMONPTR)                              0189 00595000
         LA    @07,4                                               0189 00596000
         AL    @07,FREEAMT(,COMONPTR)                              0189 00597000
         LCR   @07,@07                                             0189 00598000
         AH    @07,LL(,@14)                                        0189 00599000
         CR    @15,@07                                             0189 00600000
         BNH   @DL00188                                            0189 00601000
@DC00188 DS    0H                                                  0190 00602000
*       END;                                                       0190 00603000
@RF00187 DS    0H                                                  0190 00604000
@RC00174 LA    @15,1                                               0190 00605000
         AL    @15,I(,COMONPTR)                                    0190 00606000
@DE00173 ST    @15,I(,COMONPTR)                                    0190 00607000
         L     @14,BUFBASE(,COMONPTR)                              0190 00608000
         LA    @07,4                                               0190 00609000
         AL    @07,FREEAMT(,COMONPTR)                              0190 00610000
         LCR   @07,@07                                             0190 00611000
         AH    @07,LL(,@14)                                        0190 00612000
         CR    @15,@07                                             0190 00613000
         BNH   @DL00173                                            0190 00614000
@DC00173 DS    0H                                                  0191 00615000
*     END;                                                         0191 00616000
         LA    @15,1                                               0191 00617000
         AL    @15,Z                                               0191 00618000
@DE00171 ST    @15,Z                                               0191 00619000
         C     @15,SCANLIM                                         0191 00620000
         BNH   @DL00171                                            0191 00621000
@DC00171 DS    0H                                                  0192 00622000
*                                                                  0192 00623000
*     /***************************************************************/ 00624000
*     /*                                                             */ 00625000
*     /* ACCESS METHOD SERVICES COMPATABILITY CHECK - LASTCC AND     */ 00626000
*     /* MAXCC ARE ALLOWED WITHOUT & ON THE LEFT OF THE OPERATOR     */ 00627000
*     /*                                                             */ 00628000
*     /***************************************************************/ 00629000
*                                                                  0192 00630000
*     IF OPCODE=IFCODE|OPCODE=DOCODE THEN/* IF OR DO COMMANDS        */ 00631000
         L     @15,OLDLINE(,COMONPTR)                              0192 00632000
         CLI   OPCODE(@15),2                                       0192 00633000
         BE    @RT00192                                            0192 00634000
         CLI   OPCODE(@15),7                                       0192 00635000
         BNE   @RF00192                                            0192 00636000
@RT00192 DS    0H                                                  0193 00637000
*       DO;                         /* MAKE CHECK                    */ 00638000
*         I=MYO2;                   /* START OF SCAN                 */ 00639000
         L     @15,MYO2(,COMONPTR)                                 0194 00640000
         ST    @15,I(,COMONPTR)                                    0194 00641000
*         CALL FINDWORD;            /* FIND A WORD                   */ 00642000
         BAL   @14,FINDWORD                                        0195 00643000
*         IF SEPS=NO THEN           /* IF NOT ALL SEPARATORS         */ 00644000
         TM    SEPS(COMONPTR),B'10000000'                          0196 00645000
         BNZ   @RF00196                                            0196 00646000
*           IF(LEN=LENGTH(LASTCC)&  /* LASTCC LENGTH                 */ 00647000
*               C(BEGIN:BEGIN+LENGTH(LASTCC)-F1)=LASTCC)|/* LASTCC   */ 00648000
*               (LEN=LENGTH(MAXCC)& /* MAXCC LENGTH                  */ 00649000
*               C(BEGIN:BEGIN+LENGTH(MAXCC)-F1)=MAXCC) THEN/* MAXCC  */ 00650000
         CLC   LEN(4,COMONPTR),@CF00248                            0197 00651000
         BNE   @GL00008                                            0197 00652000
         L     @01,BEGIN(,COMONPTR)                                0197 00653000
         L     @15,BUFBASE(,COMONPTR)                              0197 00654000
         ALR   @15,@01                                             0197 00655000
         CLC   C-1(6,@15),@CC00643                                 0197 00656000
         BE    @RT00197                                            0197 00657000
@GL00008 CLC   LEN(4,COMONPTR),@CF00052                            0197 00658000
         BNE   @RF00197                                            0197 00659000
         L     @01,BEGIN(,COMONPTR)                                0197 00660000
         L     @15,BUFBASE(,COMONPTR)                              0197 00661000
         ALR   @15,@01                                             0197 00662000
         CLC   C-1(5,@15),@CC00641                                 0197 00663000
         BNE   @RF00197                                            0197 00664000
@RT00197 DS    0H                                                  0198 00665000
*             DO;                   /* PROCESS                       */ 00666000
*               V=BEGIN;            /* BACK UP ONE FOR INSERT        */ 00667000
         L     @15,BEGIN(,COMONPTR)                                0199 00668000
         ST    @15,V                                               0199 00669000
*               NOAMPER=YES;        /* INDICATE NO AMPERSAND         */ 00670000
         OI    NOAMPER(COMONPTR),B'00000010'                       0200 00671000
*               CALL INSERT;        /* INSERT VALUE HERE             */ 00672000
         BAL   @14,INSERT                                          0201 00673000
*             END;                                                 0202 00674000
*         IF OPCODE=IFCODE THEN     /* ON OF STMT                    */ 00675000
@RF00197 DS    0H                                                  0203 00676000
@RF00196 L     @01,OLDLINE(,COMONPTR)                              0203 00677000
         CLI   OPCODE(@01),2                                       0203 00678000
         BNE   @RF00203                                            0203 00679000
*           DO;                     /* RE-INSERT 'THEN'              */ 00680000
*             V=LL-(F3+FREEAMT);    /* SET START OF AREA             */ 00681000
         L     @01,BUFBASE(,COMONPTR)                              0205 00682000
         LA    @00,3                                               0205 00683000
         AL    @00,FREEAMT(,COMONPTR)                              0205 00684000
         LCR   @00,@00                                             0205 00685000
         AH    @00,LL(,@01)                                        0205 00686000
         ST    @00,V                                               0205 00687000
*             I=V;                  /* SET END AREA                  */ 00688000
         ST    @00,I(,COMONPTR)                                    0206 00689000
*             LEN=F0;               /* SET ZERO LENGTH TO REMOVE     */ 00690000
         SLR   @15,@15                                             0207 00691000
         ST    @15,LEN(,COMONPTR)                                  0207 00692000
*             NOAMPER=YES;          /* NO AMPERSAND ON VARIABLE      */ 00693000
*             INSTHEN=YES;          /* INSERT THEN TO INSERT         */ 00694000
         OI    NOAMPER(COMONPTR),B'00000011'                       0209 00695000
*             ERRSAV=ERROR;         /* SAVE ERROR CODE               */ 00696000
         L     @14,ERROR                                           0210 00697000
         ST    @14,ERRSAV                                          0210 00698000
*             ERROR=F0;             /* CLEAR ERROR IF ANY            */ 00699000
         ST    @15,ERROR                                           0211 00700000
*             CALL INSERT;          /* INSERT THEN                   */ 00701000
         BAL   @14,INSERT                                          0212 00702000
*             ERROR=ERRSAV;         /* RESTORE ERROR CONDITION       */ 00703000
         L     @15,ERRSAV                                          0213 00704000
         ST    @15,ERROR                                           0213 00705000
*           END;                    /*                               */ 00706000
*       END;                        /*                               */ 00707000
@RF00203 DS    0H                                                  0216 00708000
*                                                                  0216 00709000
*     /***************************************************************/ 00710000
*     /*                                                             */ 00711000
*     /* CONTROL COMMAND LIST                                        */ 00712000
*     /*                                                             */ 00713000
*     /***************************************************************/ 00714000
*                                                                  0216 00715000
*     EXECDPTR=LSDEXEC;             /* RESET EXEC DATA POINTER       */ 00716000
@RF00192 L     @01,LSDPTR(,COMONPTR)                               0216 00717000
         L     @15,LSDEXEC(,@01)                                   0216 00718000
         ST    @15,EXECDPTR(,COMONPTR)                             0216 00719000
*     IF ERROR=F0 THEN              /* IF OK SO FAR                  */ 00720000
         L     @15,ERROR                                           0217 00721000
         LTR   @15,@15                                             0217 00722000
         BNZ   @RF00217                                            0217 00723000
*       DO I=1 TO LL-(F4+FREEAMT);  /* DO UNTIL END OF BUFFER        */ 00724000
         LA    @15,1                                               0218 00725000
         B     @DE00218                                            0218 00726000
@DL00218 DS    0H                                                  0219 00727000
*         IF I<LL-(F4+FREEAMT)&     /* NOT BEFORE END OF BUFFER      */ 00728000
*             (C(I:I+F1)=DAMPSAND|  /* DOUBLE AMPERSAND              */ 00729000
*             C(I:I+F1)=FDMPSAND) THEN/* FOLDED AMPERSANDS           */ 00730000
         L     @15,I(,COMONPTR)                                    0219 00731000
         L     @14,BUFBASE(,COMONPTR)                              0219 00732000
         LA    @07,4                                               0219 00733000
         AL    @07,FREEAMT(,COMONPTR)                              0219 00734000
         LCR   @07,@07                                             0219 00735000
         AH    @07,LL(,@14)                                        0219 00736000
         CR    @15,@07                                             0219 00737000
         BNL   @RF00219                                            0219 00738000
         ALR   @15,@14                                             0219 00739000
         CLC   C-1(2,@15),@CC00662                                 0219 00740000
         BE    @RT00219                                            0219 00741000
         L     @15,I(,COMONPTR)                                    0219 00742000
         ALR   @14,@15                                             0219 00743000
         CLC   C-1(2,@14),@CB00664                                 0219 00744000
         BNE   @RF00219                                            0219 00745000
@RT00219 DS    0H                                                  0220 00746000
*           CALL SQUASH;            /* SQUASH OUT THE EXTRA AMPERSAND*/ 00747000
         BAL   @14,SQUASH                                          0220 00748000
*         IF OPCODE^=IFCODE&OPCODE^=DOCODE&/* NOT IF AND NOT DO      */ 00749000
*             OPCODE^=SETCODE THEN  /* AND NOT SET                   */ 00750000
@RF00219 L     @15,OLDLINE(,COMONPTR)                              0221 00751000
         CLI   OPCODE(@15),2                                       0221 00752000
         BE    @RF00221                                            0221 00753000
         CLI   OPCODE(@15),7                                       0221 00754000
         BE    @RF00221                                            0221 00755000
         CLI   OPCODE(@15),13                                      0221 00756000
         BE    @RF00221                                            0221 00757000
*           DO;                     /* FOLD TO UPPER CASE            */ 00758000
*             FOLD=NO;              /* RESET FOLD INDICATOR          */ 00759000
         NI    FOLD(COMONPTR),B'11101111'                          0223 00760000
*             TR(C(I),TRTABUP);     /* FOLD TO NORMAL CHARACTERS     */ 00761000
         L     @01,I(,COMONPTR)                                    0224 00762000
         L     @15,BUFBASE(,COMONPTR)                              0224 00763000
         ALR   @15,@01                                             0224 00764000
         TR    C-1(1,@15),TRTABUP                                  0224 00765000
*           END;                    /*                               */ 00766000
*       END;                                                       0226 00767000
@RF00221 LA    @15,1                                               0226 00768000
         AL    @15,I(,COMONPTR)                                    0226 00769000
@DE00218 ST    @15,I(,COMONPTR)                                    0226 00770000
         L     @14,BUFBASE(,COMONPTR)                              0226 00771000
         LA    @07,4                                               0226 00772000
         AL    @07,FREEAMT(,COMONPTR)                              0226 00773000
         LCR   @07,@07                                             0226 00774000
         AH    @07,LL(,@14)                                        0226 00775000
         CR    @15,@07                                             0226 00776000
         BNH   @DL00218                                            0226 00777000
*     IF LISTONLY=YES|              /* BACKUP LIST OF TSO COMMAND    */ 00778000
*         (ERROR>E16&(ERACTSTR=F0|ERRRANGE=YES))|/* A SEVERE ERROR   */ 00779000
*         (CONLST=YES&(OPCODE^=F0|ERROR>E16)) THEN/* CONLIST         */ 00780000
@RF00217 TM    LISTONLY(COMONPTR),B'00100000'                      0227 00781000
         BO    @RT00227                                            0227 00782000
         L     @15,ERROR                                           0227 00783000
         C     @15,@CF00104                                        0227 00784000
         BNH   @GL00015                                            0227 00785000
         L     @01,EXECDPTR(,COMONPTR)                             0227 00786000
         L     @15,ERACTSTR(,@01)                                  0227 00787000
         LTR   @15,@15                                             0227 00788000
         BZ    @RT00227                                            0227 00789000
         TM    ERRRANGE(COMONPTR),B'00000100'                      0227 00790000
         BO    @RT00227                                            0227 00791000
@GL00015 L     @01,EXECDPTR(,COMONPTR)                             0227 00792000
         TM    CONLST(@01),B'10000000'                             0227 00793000
         BNO   @RF00227                                            0227 00794000
         L     @01,OLDLINE(,COMONPTR)                              0227 00795000
         CLI   OPCODE(@01),0                                       0227 00796000
         BNE   @RT00227                                            0227 00797000
         L     @15,ERROR                                           0227 00798000
         C     @15,@CF00104                                        0227 00799000
         BNH   @RF00227                                            0227 00800000
@RT00227 DS    0H                                                  0228 00801000
*       DO;                                                        0228 00802000
*         LISTED=YES;               /* COMMAND ALREADY LISTED        */ 00803000
         OI    LISTED(COMONPTR),B'00001000'                        0229 00804000
*         CALL CMDLST;              /* LIST COMMAND                  */ 00805000
         BAL   @14,CMDLST                                          0230 00806000
*         IF LISTONLY=YES&ERROR=F0 THEN/* IF LISTED OK               */ 00807000
         TM    LISTONLY(COMONPTR),B'00100000'                      0231 00808000
         BNO   @RF00231                                            0231 00809000
         L     @15,ERROR                                           0231 00810000
         LTR   @15,@15                                             0231 00811000
         BNZ   @RF00231                                            0231 00812000
*           ERROR=E4;               /* GET ANOTHER LINE              */ 00813000
         MVC   ERROR(4),@CF00107                                   0232 00814000
*       END;                                                       0233 00815000
@RF00231 DS    0H                                                  0234 00816000
*                                                                  0234 00817000
*     /***************************************************************/ 00818000
*     /*                                                             */ 00819000
*     /* FUNCTION CALL AND NEXT COMMAND UPDATE                       */ 00820000
*     /*                                                             */ 00821000
*     /***************************************************************/ 00822000
*                                                                  0234 00823000
*     IF ERROR=F0 THEN              /* IF OK UP TO NOW               */ 00824000
@RF00227 L     @15,ERROR                                           0234 00825000
         LTR   @15,@15                                             0234 00826000
         BNZ   @RF00234                                            0234 00827000
*       DO;                         /* CALL FUNCTION                 */ 00828000
*         RFY                                                      0236 00829000
*          (R15) RSTD;              /* RESTRICT REG 15               */ 00830000
*         CALL IKJCT436(UPTX,ECTX,ECB,GTPB,PARM433);/* CALL FUNCTION */ 00831000
         L     @14,@PC00001                                        0237 00832000
         ST    @14,@AL00001                                        0237 00833000
         L     @14,@PC00001+4                                      0237 00834000
         ST    @14,@AL00001+4                                      0237 00835000
         L     @14,@PC00001+8                                      0237 00836000
         ST    @14,@AL00001+8                                      0237 00837000
         L     @14,@PC00001+12                                     0237 00838000
         ST    @14,@AL00001+12                                     0237 00839000
         L     @14,@PC00001+16                                     0237 00840000
         ST    @14,@AL00001+16                                     0237 00841000
         L     @15,@CV00099                                        0237 00842000
         LA    @01,@AL00001                                        0237 00843000
         BALR  @14,@15                                             0237 00844000
*         ERROR=R15;                /* SET ERROR CODE                */ 00845000
         ST    R15,ERROR                                           0238 00846000
*         RFY                                                      0239 00847000
*          (R15) UNRSTD;            /* RELEASE REG 15                */ 00848000
*       END;                        /*                               */ 00849000
*     ERCOM=F0;                     /* CLEAR COMMON ERROR FOR MSGOUT */ 00850000
@RF00234 SLR   @15,@15                                             0241 00851000
         ST    @15,ERCOM(,COMONPTR)                                0241 00852000
*     IF PARMDEFR=YES THEN          /* IF OK TO CHANGE STATUS        */ 00853000
         L     @15,@PC00001+16                                     0242 00854000
         TM    PARMDEFR(@15),B'10000000'                           0242 00855000
         BNO   @RF00242                                            0242 00856000
*       GEN REFS(DEFERNO)(STAX MF=(E,DEFERNO));/* ALLOW ATTNS        */ 00857000
         STAX MF=(E,DEFERNO)                                            00858000
*     IF ECBCBIT=YES THEN           /* IF ATTN POSTED                */ 00859000
@RF00242 L     @15,@PC00001+8                                      0244 00860000
         TM    ECBCBIT(@15),B'01000000'                            0244 00861000
         BNO   @RF00244                                            0244 00862000
*       ERROR=E8;                   /* SET ATTN CODE                 */ 00863000
         MVC   ERROR(4),@CF00094                                   0245 00864000
*     IF PARMDEFR=YES THEN          /* IF OK TO CHANGE STATUS        */ 00865000
@RF00244 L     @15,@PC00001+16                                     0246 00866000
         TM    PARMDEFR(@15),B'10000000'                           0246 00867000
         BNO   @RF00246                                            0246 00868000
*       GEN REFS(DEFERYES)(STAX MF=(E,DEFERYES));/* NO ATTNS AGAIN   */ 00869000
         STAX MF=(E,DEFERYES)                                           00870000
*     IF ERROR^=E4 THEN             /* IF NOT A CONTINU RETURN CODE  */ 00871000
@RF00246 CLC   ERROR(4),@CF00107                                   0248 00872000
         BE    @RF00248                                            0248 00873000
*       CONTINU=NO;                 /* DON''T CONTINUE               */ 00874000
         NI    CONTINU(COMONPTR),B'10111111'                       0249 00875000
*     IF CONTINU=YES THEN           /* IF OK TO CONTINUE             */ 00876000
@RF00248 TM    CONTINU(COMONPTR),B'01000000'                       0250 00877000
         BNO   @RF00250                                            0250 00878000
*       DO;                         /* CHECK FOR END OF CLIST        */ 00879000
*         ECDACBLK=LSDADATA;        /* POINT TO FIRST BLOCK          */ 00880000
         L     @01,LSDPTR(,COMONPTR)                               0252 00881000
         L     @15,LSDADATA(,@01)                                  0252 00882000
         ST    @15,ECDACBLK                                        0252 00883000
*         DO WHILE ECDACBK2^=F0&CONTINU=YES;/* FIND NEXT BLOCK       */ 00884000
         B     @DE00253                                            0253 00885000
@DL00253 DS    0H                                                  0254 00886000
*           IF CURID=COMPRID&       /* IF IDS MATCH                  */ 00887000
*               CURADDR>=ECDACBK2+COMPRLNG THEN/* AND AT END         */ 00888000
         L     @15,LSDPTR(,COMONPTR)                               0254 00889000
         L     @14,ECDACBLK                                        0254 00890000
         CLC   CURID(1,@15),COMPRID(@14)                           0254 00891000
         BNE   @RF00254                                            0254 00892000
         L     @07,ECDACBK2-1                                      0254 00893000
         LA    @07,0(,@07)                                         0254 00894000
         AL    @07,COMPRLNG(,@14)                                  0254 00895000
         L     @06,CURADDR-1(,@15)                                 0254 00896000
         LA    @06,0(,@06)                                         0254 00897000
         CR    @07,@06                                             0254 00898000
         BH    @RF00254                                            0254 00899000
*             IF COMPRNXT=F0 THEN   /* IF NO MORE BLOCKS     @ZA08099*/ 00900000
         L     @15,COMPRNXT-1(,@14)                                0255 00901000
         LA    @15,0(,@15)                                         0255 00902000
         LTR   @15,@15                                             0255 00903000
         BNZ   @RF00255                                            0255 00904000
*               DO;                 /*                       @ZA08099*/ 00905000
*                 EOCLIST=YES;      /* END OF THIS CLIST     @ZA08099*/ 00906000
         L     @15,@PC00001+16                                     0257 00907000
         OI    EOCLIST(@15),B'01000000'                            0257 00908000
*                 CONTINU=NO;       /* DISSALLOW CONTINUE            */ 00909000
         NI    CONTINU(COMONPTR),B'10111111'                       0258 00910000
*               END;                /*                       @ZA08099*/ 00911000
*             ELSE                  /* OTHERWISE                     */ 00912000
*               DO;                 /* GO TO NEXT BLOCK              */ 00913000
         B     @RC00255                                            0260 00914000
@RF00255 DS    0H                                                  0261 00915000
*                 CURADDR=COMPRNXT+LENGTH(COMPROC);/* UPDATE LSD     */ 00916000
         L     @15,LSDPTR(,COMONPTR)                               0261 00917000
         L     @14,ECDACBLK                                        0261 00918000
         LA    @07,12                                              0261 00919000
         L     @06,COMPRNXT-1(,@14)                                0261 00920000
         LA    @06,0(,@06)                                         0261 00921000
         ALR   @07,@06                                             0261 00922000
         STCM  @07,7,CURADDR(@15)                                  0261 00923000
*                 CURID=COMPRID+1;  /* INCREMENT BLOCK ID            */ 00924000
         LA    @07,1                                               0262 00925000
         SLR   @06,@06                                             0262 00926000
         IC    @06,COMPRID(,@14)                                   0262 00927000
         ALR   @07,@06                                             0262 00928000
         STC   @07,CURID(,@15)                                     0262 00929000
*                 ECDACBLK=F0;      /* END SCAN                      */ 00930000
         SLR   @15,@15                                             0263 00931000
         ST    @15,ECDACBLK                                        0263 00932000
*               END;                /*                               */ 00933000
*           ELSE                    /* OTHERWISE                     */ 00934000
*             ECDACBLK=COMPRPTR;    /* CHECK NEXT BLOCK              */ 00935000
         B     @RC00254                                            0265 00936000
@RF00254 L     @01,ECDACBLK                                        0265 00937000
         L     @15,COMPRPTR(,@01)                                  0265 00938000
         ST    @15,ECDACBLK                                        0265 00939000
*         END;                      /*                               */ 00940000
@RC00254 DS    0H                                                  0266 00941000
@DE00253 L     @15,ECDACBK2-1                                      0266 00942000
         LA    @15,0(,@15)                                         0266 00943000
         LTR   @15,@15                                             0266 00944000
         BZ    @DC00253                                            0266 00945000
         TM    CONTINU(COMONPTR),B'01000000'                       0266 00946000
         BO    @DL00253                                            0266 00947000
@DC00253 DS    0H                                                  0267 00948000
*         IF CONTINU=YES THEN       /* IF CONTINUING                 */ 00949000
         TM    CONTINU(COMONPTR),B'01000000'                       0267 00950000
         BNO   @RF00267                                            0267 00951000
*           DO;                     /* UPDATE POINTERS               */ 00952000
*             GTPBLINE=LSDANEXT;    /* SAVE LSDANEXT                 */ 00953000
         L     @15,@PC00001+12                                     0269 00954000
         L     @14,LSDPTR(,COMONPTR)                               0269 00955000
         L     @07,LSDANEXT(,@14)                                  0269 00956000
         ST    @07,GTPBLINE(,@15)                                  0269 00957000
*             LSDANEXT=LSDANEXT+LSDANEXT->LL;/* UPDATE LSD POINTER   */ 00958000
         LH    @15,LL(,@07)                                        0270 00959000
         ALR   @15,@07                                             0270 00960000
         ST    @15,LSDANEXT(,@14)                                  0270 00961000
*           END;                    /*                               */ 00962000
*       END;                        /*                               */ 00963000
@RF00267 DS    0H                                                  0273 00964000
*FASTCYCL:                                                         0273 00965000
*   END;                            /*                       @ZA08099*/ 00966000
@RF00250 DS    0H                                                  0273 00967000
FASTCYCL DS    0H                                                  0273 00968000
@DE00041 TM    CONTINU(COMONPTR),B'01000000'                       0273 00969000
         BO    @DL00041                                            0273 00970000
*                                                                  0274 00971000
*   /*****************************************************************/ 00972000
*   /*                                                               */ 00973000
*   /* RETURN CODE UPDATE IF ERROR AND STACK FLUSH IF NEEDED         */ 00974000
*   /*                                                               */ 00975000
*   /*****************************************************************/ 00976000
*                                                                  0274 00977000
*FASTEXIT:                                                         0274 00978000
*   IF ERROR>E8 THEN                /* IF AN ERROR OCCURRED          */ 00979000
FASTEXIT L     @15,ERROR                                           0274 00980000
         C     @15,@CF00094                                        0274 00981000
         BNH   @RF00274                                            0274 00982000
*     DO;                           /* PROCESS ERROR CONDITION       */ 00983000
*       IF ERROR=E16 THEN           /* IF A GETMAIN FAIL             */ 00984000
         C     @15,@CF00104                                        0276 00985000
         BNE   @RF00276                                            0276 00986000
*         QUIT=YES;                 /* FLUSH STACK                   */ 00987000
         OI    QUIT(COMONPTR),B'00100000'                          0277 00988000
*       ELSE                        /* OTHERWISE                     */ 00989000
*         QUIT=NO;                  /* DONT FLUSH -- YET             */ 00990000
         B     @RC00276                                            0278 00991000
@RF00276 NI    QUIT(COMONPTR),B'11011111'                          0278 00992000
*       ERRSAV=ERROR;               /* SAVE ERROR CODE               */ 00993000
@RC00276 L     @15,ERROR                                           0279 00994000
         ST    @15,ERRSAV                                          0279 00995000
*       ERROR=F0;                   /* SET ERROR TO ZERO TO          */ 00996000
         SLR   @15,@15                                             0280 00997000
         ST    @15,ERROR                                           0280 00998000
*       CALL RCUPDT;                /* SET RETURN CODE INDICATORS    */ 00999000
         BAL   @14,RCUPDT                                          0281 01000000
*       IF ERRCMD=YES THEN          /* ID ERROR COMMAND IN EFFECT    */ 01001000
         L     @01,EXECDPTR(,COMONPTR)                             0282 01002000
         TM    ERRCMD(@01),B'01000000'                             0282 01003000
         BNO   @RF00282                                            0282 01004000
*         IF ERRRANGE=YES THEN      /* IF IN AN ERROR RANGE          */ 01005000
         TM    ERRRANGE(COMONPTR),B'00000100'                      0283 01006000
         BNO   @RF00283                                            0283 01007000
*           DO;                     /*                               */ 01008000
*             IF ERRSAV^=E908 THEN  /* NOT ALREADY A RECURSE MSG     */ 01009000
         CLC   ERRSAV(4),@CF00785                                  0285 01010000
         BE    @RF00285                                            0285 01011000
*               RECURSE=YES;        /* SET RECURSIVE ERROR BIT       */ 01012000
         OI    RECURSE(COMONPTR),B'00100000'                       0286 01013000
*             QUIT=YES;             /* FLUSH STACK                   */ 01014000
@RF00285 OI    QUIT(COMONPTR),B'00100000'                          0287 01015000
*           END;                    /*                               */ 01016000
*         ELSE                      /* IF NOT IN ERRANGE             */ 01017000
*           IF ERACTSTR^=F0 THEN    /* IF NO ERACTSTR                */ 01018000
         B     @RC00283                                            0289 01019000
@RF00283 L     @15,EXECDPTR(,COMONPTR)                             0289 01020000
         L     @14,ERACTSTR(,@15)                                  0289 01021000
         LTR   @14,@14                                             0289 01022000
         BZ    @RF00289                                            0289 01023000
*             DO;                   /*                               */ 01024000
*               ERINCNTL=YES;       /* SET ERROR IN CONTROL          */ 01025000
         OI    ERINCNTL(@15),B'00001000'                           0291 01026000
*               CALL RETUPDT(LSDANEXT);/* UPDATE RETURN POINT        */ 01027000
         L     @01,LSDPTR(,COMONPTR)                               0292 01028000
         LA    @15,LSDANEXT(,@01)                                  0292 01029000
         ST    @15,@AL00001                                        0292 01030000
         LA    @01,@AL00001                                        0292 01031000
         BAL   @14,RETUPDT                                         0292 01032000
*               LSDANEXT=ERACTSTR;  /* SET GOTO ADDR                 */ 01033000
         L     @01,LSDPTR(,COMONPTR)                               0293 01034000
         L     @15,EXECDPTR(,COMONPTR)                             0293 01035000
         L     @00,ERACTSTR(,@15)                                  0293 01036000
         ST    @00,LSDANEXT(,@01)                                  0293 01037000
*             END;                  /*                               */ 01038000
*           ELSE                    /* OTHERWISE                     */ 01039000
*             IF LISTED=NO THEN     /* IF COMMAND NOT LISTED         */ 01040000
         B     @RC00289                                            0295 01041000
@RF00289 TM    LISTED(COMONPTR),B'00001000'                        0295 01042000
         BNZ   @RF00295                                            0295 01043000
*               DO;                 /* LIST COMMAND IN ERROR         */ 01044000
*                 LISTED=YES;       /* SAY WE HAVE LISTED COMMAND    */ 01045000
         OI    LISTED(COMONPTR),B'00001000'                        0297 01046000
*                 CALL CMDLST;      /* LIST COMMAND                  */ 01047000
         BAL   @14,CMDLST                                          0298 01048000
*               END;                /*                               */ 01049000
*             ELSE                                                 0300 01050000
*               ;                   /* NOTHING                       */ 01051000
@RF00295 DS    0H                                                  0301 01052000
*       ELSE                        /* IF NO ERRCMD                  */ 01053000
*         QUIT=YES;                 /* FLUSH STACK                   */ 01054000
         B     @RC00282                                            0301 01055000
@RF00282 OI    QUIT(COMONPTR),B'00100000'                          0301 01056000
*       IF QUIT=YES|LISTED=YES THEN /* FLUSH STACK ?                 */ 01057000
@RC00282 TM    QUIT(COMONPTR),B'00100000'                          0302 01058000
         BO    @RT00302                                            0302 01059000
         TM    LISTED(COMONPTR),B'00001000'                        0302 01060000
         BNO   @RF00302                                            0302 01061000
@RT00302 DS    0H                                                  0303 01062000
*         DO;                       /* IF SO PRINT ERROR MSG         */ 01063000
*           IF LISTED=NO THEN       /* IF NOT ALREADY LISTED         */ 01064000
         TM    LISTED(COMONPTR),B'00001000'                        0304 01065000
         BNZ   @RF00304                                            0304 01066000
*             CALL CMDLST;          /* LIST COMMAND                  */ 01067000
         BAL   @14,CMDLST                                          0305 01068000
*           IF QUIT=YES THEN        /* GOING TO FLUSH ?              */ 01069000
@RF00304 TM    QUIT(COMONPTR),B'00100000'                          0306 01070000
         BNO   @RF00306                                            0306 01071000
*             NOMSG=NO;             /* ALLOW MESSAGE TO GO OUT       */ 01072000
         L     @01,EXECDPTR(,COMONPTR)                             0307 01073000
         NI    NOMSG(@01),B'11111101'                              0307 01074000
*           CALL MSGOUT;            /* PUT OUT SELECTED MESSAGE      */ 01075000
@RF00306 BAL   @14,MSGOUT                                          0308 01076000
*           IF RECURSE=YES THEN     /* A RECURSIVE ERROR ?           */ 01077000
         TM    RECURSE(COMONPTR),B'00100000'                       0309 01078000
         BNO   @RF00309                                            0309 01079000
*             DO;                   /* BUILD CORRECT MESSAGE         */ 01080000
*               ERRSAV=E908;        /* SET RECURSIVE ERROR           */ 01081000
         MVC   ERRSAV(4),@CF00785                                  0311 01082000
*               CALL MSGOUT;        /* PUT OUT RECURSIVE MESSAGE     */ 01083000
         BAL   @14,MSGOUT                                          0312 01084000
*             END;                  /*                               */ 01085000
*           IF QUIT=YES THEN        /* FLUSH THE STACK               */ 01086000
@RF00309 TM    QUIT(COMONPTR),B'00100000'                          0314 01087000
         BNO   @RF00314                                            0314 01088000
*             DO;                   /* FLUSH IT                      */ 01089000
*               ECTRTCD=ERRSAV;     /* SET ECT RETURN CODE FIELD     */ 01090000
         L     @15,@PC00001+4                                      0316 01091000
         MVC   ECTRTCD(3,@15),ERRSAV+1                             0316 01092000
*               ECTRCDF=''B;        /* CLEAR ABEND FLAG              */ 01093000
         MVI   ECTRCDF(@15),X'00'                                  0317 01094000
*               NOFLUSH=NO;         /* TURN OFF NOFLUSH OPTION       */ 01095000
*               CMAIN=NO;           /* TURN OFF MAIN OPTION          */ 01096000
         L     @01,EXECDPTR(,COMONPTR)                             0319 01097000
         NI    NOFLUSH(@01),B'11011011'                            0319 01098000
*               IOPL(4)=ADDR(STFLUSH);/* PUTLINE PARM BLOCK          */ 01099000
         LA    @15,STFLUSH                                         0320 01100000
         ST    @15,IOPL+12(,COMONPTR)                              0320 01101000
*               RFY                                                0321 01102000
*                (R1) RSTD;         /* RESTRICT REG ONE              */ 01103000
*               R1=ADDR(IOPL);      /* LOAD PARM ADDRESS             */ 01104000
         LR    R1,COMONPTR                                         0322 01105000
*               CALL IKJEFT30;      /* FLUSH STACK                   */ 01106000
         L     @15,@CV00100                                        0323 01107000
         BALR  @14,@15                                             0323 01108000
*               RFY                                                0324 01109000
*                (R1) UNRSTD;       /* RELEASE REG ONE               */ 01110000
*             END;                  /*                               */ 01111000
*         END;                      /*                               */ 01112000
@RF00314 DS    0H                                                  0327 01113000
*       ERROR=E4;                   /* SET OK TO GET ANOTHER COMMAND */ 01114000
@RF00302 MVC   ERROR(4),@CF00107                                   0327 01115000
*     END;                          /*                               */ 01116000
*                                                                  0329 01117000
*   /*****************************************************************/ 01118000
*   /*                                                               */ 01119000
*   /* FREE BUFFERS AS REQUIRED                                      */ 01120000
*   /*                                                               */ 01121000
*   /*****************************************************************/ 01122000
*                                                                  0329 01123000
*   IF CORE=YES THEN                /* NO GETMAIN ERROR YET          */ 01124000
@RF00274 TM    CORE(COMONPTR),B'10000000'                          0329 01125000
         BNO   @RF00329                                            0329 01126000
*     DO;                           /* FREE PARTS OF OR ALL BUFFERS  */ 01127000
*       IF ERROR=F0 THEN            /* IF ALL OK                     */ 01128000
         L     @15,ERROR                                           0331 01129000
         LTR   @15,@15                                             0331 01130000
         BNZ   @RF00331                                            0331 01131000
*         DO;                       /* FREEMAIN EXCESS PART OF BUFFER*/ 01132000
*           FREEADDR(1)=(BUFBASE+LL-FREEAMT+7)/8*8;/* CALC FREE ADDR */ 01133000
         L     @15,BUFBASE(,COMONPTR)                              0333 01134000
         LH    @14,LL(,@15)                                        0333 01135000
         LR    @00,@15                                             0333 01136000
         ALR   @00,@14                                             0333 01137000
         L     @07,FREEAMT(,COMONPTR)                              0333 01138000
         SLR   @00,@07                                             0333 01139000
         AL    @00,@CF00208                                        0333 01140000
         SRDA  @00,32                                              0333 01141000
         D     @00,@CF00094                                        0333 01142000
         SLA   @01,3                                               0333 01143000
         ST    @01,FREEADDR                                        0333 01144000
*           FREELEN(1)=LL-(FREEADDR(1)-BUFBASE);/* CALC FREE LENGTH  */ 01145000
         SLR   @01,@15                                             0334 01146000
         LCR   @01,@01                                             0334 01147000
         ALR   @01,@14                                             0334 01148000
         ST    @01,FREELEN                                         0334 01149000
*           LL=LL-FREEAMT;          /* ADJUST BUFFER LL              */ 01150000
         SLR   @14,@07                                             0335 01151000
         STH   @14,LL(,@15)                                        0335 01152000
*           GTPBLINE=BUFBASE;       /* PUT LINE ADDR IN CALLERS AREA */ 01153000
         L     @14,@PC00001+12                                     0336 01154000
         ST    @15,GTPBLINE(,@14)                                  0336 01155000
*         END;                      /*                               */ 01156000
*       ELSE                        /* OTHERWISE FREE OBTAINED BUFFER*/ 01157000
*         DO;                       /*                               */ 01158000
         B     @RC00331                                            0338 01159000
@RF00331 DS    0H                                                  0339 01160000
*           FREEADDR(1)=BUFBASE;    /* BUFFER ADDRESS                */ 01161000
         L     @15,BUFBASE(,COMONPTR)                              0339 01162000
         ST    @15,FREEADDR                                        0339 01163000
*           FREELEN(1)=LL;          /* BUFFER LENGTH                 */ 01164000
         LH    @15,LL(,@15)                                        0340 01165000
         ST    @15,FREELEN                                         0340 01166000
*         END;                      /*                               */ 01167000
*       FREEADDR(2)=NEWBASE;        /* ALTERNATE BUFFER ALWAYS FREED */ 01168000
@RC00331 L     @15,NEWBASE(,COMONPTR)                              0342 01169000
         ST    @15,FREEADDR+4                                      0342 01170000
*       FREELEN(2)=NEWLL|FREELAST;  /* LENGTH OF ALTERNATE BUFFER    */ 01171000
         LH    @15,NEWLL(,@15)                                     0343 01172000
         O     @15,@CF00097                                        0343 01173000
         ST    @15,FREELEN+4                                       0343 01174000
*       DO;                         /* FREEMAIN (L) LA(FREELEN(1)) 0344 01175000
*                                      A(FREEADDR(1)) SP(F1)       0344 01176000
*                                      MF(E,FRELST)                  */ 01177000
*         RESPECIFY                                                0345 01178000
*          (GPR01P) RESTRICTED;                                    0345 01179000
*         FRELST05='80'X;           /* SET TYPE                      */ 01180000
         MVI   FRELST05,X'80'                                      0346 01181000
*         FRELST02=ADDR(FREELEN(1));/* ADDR OF LENGTH LIST           */ 01182000
         LA    @00,FREELEN                                         0347 01183000
         STCM  @00,7,FRELST02                                      0347 01184000
*         FRELST04=ADDR(FREEADDR(1));/* ADDR OF ADDR LIST            */ 01185000
         LA    @00,FREEADDR                                        0348 01186000
         STCM  @00,7,FRELST04                                      0348 01187000
*         FRELST06=F1;              /* SUBPOOL VALUE                 */ 01188000
         MVI   FRELST06,X'01'                                      0349 01189000
*         GPR01P=ADDR(FRELST);      /* REG1 POINTS TO LIST           */ 01190000
         LA    GPR01P,FRELST                                       0350 01191000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 01192000
         SVC   5                                                   0351 01193000
*         RESPECIFY                                                0352 01194000
*          (GPR01P) UNRESTRICTED;                                  0352 01195000
*       END;                        /* FREEMAIN (L) LA(FREELEN(1)) 0353 01196000
*                                      A(FREEADDR(1)) SP(F1)       0353 01197000
*                                      MF(E,FRELST)                  */ 01198000
*     END;                                                         0354 01199000
*   RETURN CODE(ERROR);             /* RETURN TO GETLINE             */ 01200000
@RF00329 L     @07,ERROR                                           0355 01201000
         L     @13,4(,@13)                                         0355 01202000
         L     @00,@SIZDATD                                        0355 01203000
         LR    @01,@09                                             0355 01204000
         IKJEXEC  R,LV=(0),A=(1)                                        01205000
         LR    @15,@07                                             0355 01206000
         L     @14,12(,@13)                                        0355 01207000
         LM    @00,@12,20(@13)                                     0355 01208000
         BR    @14                                                 0355 01209000
*                                                                  0356 01210000
*   /*****************************************************************/ 01211000
*   /*                                                               */ 01212000
*   /* UPDATE ONLY ENTRY                                             */ 01213000
*   /*                                                               */ 01214000
*   /*****************************************************************/ 01215000
*                                                                  0356 01216000
*IKJUPDT:                                                          0356 01217000
*   ENTRY(UPTX,ECTX,ECB,UPLIST);    /*                               */ 01218000
@EP00356 MVC   @PC00001(12),0(@01)                                 0356 01219000
         MVC   @PC00001+20(4),12(@01)                              0356 01220000
*   SWS=''B;                        /* CLEAR MOST SWITCHES           */ 01221000
         XC    SWS(5,COMONPTR),SWS(COMONPTR)                       0357 01222000
*   CALL INTSETUP;                  /* INIT VARIABLES                */ 01223000
         BAL   @14,INTSETUP                                        0358 01224000
*   SYSUPDTE=YES;                   /* INDICATE SYSTEM UPDATE        */ 01225000
         OI    SYSUPDTE(COMONPTR),B'00000100'                      0359 01226000
*   CALL LOCATE(LCVAL,LCVALLEN,F0); /* LOCATE VARIABLE               */ 01227000
         L     @15,@PC00001+20                                     0360 01228000
         L     @01,LCVALPTR(,@15)                                  0360 01229000
         ST    @01,@AL00001                                        0360 01230000
         LA    @15,LCVALLEN(,@15)                                  0360 01231000
         ST    @15,@AL00001+4                                      0360 01232000
         LA    @15,@CF00439                                        0360 01233000
         ST    @15,@AL00001+8                                      0360 01234000
         LA    @01,@AL00001                                        0360 01235000
         BAL   @14,LOCATE                                          0360 01236000
*   IF ERROR=F0 THEN                /* IF FOUND                      */ 01237000
         L     @15,ERROR                                           0361 01238000
         LTR   @15,@15                                             0361 01239000
         BNZ   @RF00361                                            0361 01240000
*     CALL UPDATE(UPVAL,UPVALLEN);  /* UPDATE THE VARIABLE           */ 01241000
         L     @15,@PC00001+20                                     0362 01242000
         L     @01,UPVALPTR(,@15)                                  0362 01243000
         ST    @01,@AL00001                                        0362 01244000
         LA    @15,UPVALLEN(,@15)                                  0362 01245000
         ST    @15,@AL00001+4                                      0362 01246000
         LA    @01,@AL00001                                        0362 01247000
         BAL   @14,UPDATE                                          0362 01248000
*   RETURN CODE(ERROR);             /* RETURN TO GETLINE             */ 01249000
@RF00361 L     @07,ERROR                                           0363 01250000
         L     @13,4(,@13)                                         0363 01251000
         L     @00,@SIZDATD                                        0363 01252000
         LR    @01,@09                                             0363 01253000
         IKJEXEC  R,LV=(0),A=(1)                                        01254000
         LR    @15,@07                                             0363 01255000
         L     @14,12(,@13)                                        0363 01256000
         LM    @00,@12,20(@13)                                     0363 01257000
         BR    @14                                                 0363 01258000
*                                                                  0364 01259000
*   /*****************************************************************/ 01260000
*   /*                                                               */ 01261000
*   /* INITIALIZATION ROUTINE                                        */ 01262000
*   /*                                                               */ 01263000
*   /*****************************************************************/ 01264000
*                                                                  0364 01265000
*INTSETUP:                                                         0364 01266000
*   PROC;                                                          0364 01267000
@EL00001 L     @13,4(,@13)                                         0364 01268000
@EF00001 L     @00,@SIZDATD                                        0364 01269000
         LR    @01,@09                                             0364 01270000
         IKJEXEC  R,LV=(0),A=(1)                                        01271000
@ER00001 LM    @14,@12,12(@13)                                     0364 01272000
         BR    @14                                                 0364 01273000
INTSETUP STM   @14,@12,12(@13)                                     0364 01274000
*   STFLUSH(1:MACLEN)=STACKL(1:MACLEN);/* COPY LIST MACROS           */ 01275000
         L     @15,MACLEN                                          0365 01276000
         BCTR  @15,0                                               0365 01277000
         EX    @15,@SM01094                                        0365 01278000
*   IOPL(1)=ADDR(UPT);              /* ADDR OF UPT                   */ 01279000
         L     @15,@PC00001                                        0366 01280000
         ST    @15,IOPL(,COMONPTR)                                 0366 01281000
*   IOPL(2)=ADDR(ECT);              /* ADDR OF ECT                   */ 01282000
         L     @15,@PC00001+4                                      0367 01283000
         ST    @15,IOPL+4(,COMONPTR)                               0367 01284000
*   IOPL(3)=ADDR(ECB);              /* ADDR OF ECB                   */ 01285000
         L     @14,@PC00001+8                                      0368 01286000
         ST    @14,IOPL+8(,COMONPTR)                               0368 01287000
*   ERROR=F0;                       /* ZERO ERROR INDICATOR          */ 01288000
         SLR   @14,@14                                             0369 01289000
         ST    @14,ERROR                                           0369 01290000
*   ERCOM=F0;                       /* ZERO ERROR INDICATOR (COMMON) */ 01291000
         ST    @14,ERCOM(,COMONPTR)                                0370 01292000
*   FREEAMT=F0;                     /* ZERO AMOUNT THAT IS FREE      */ 01293000
         ST    @14,FREEAMT(,COMONPTR)                              0371 01294000
*   FREEADDR(1)=F0;                 /* INIT FREEMAIN ADDR TO 0       */ 01295000
         ST    @14,FREEADDR                                        0372 01296000
*   FREELEN(1)=F0;                  /* INIT FREEMAIN LENGTH TO 0     */ 01297000
         ST    @14,FREELEN                                         0373 01298000
*   SW2=''B;                        /* TURN OFF LOOP SWITCHES        */ 01299000
         MVI   SW2(COMONPTR),X'00'                                 0374 01300000
*   FRELST=''B;                     /* CLEAR FREEMAIN LIST AREA      */ 01301000
         XC    FRELST(10),FRELST                                   0375 01302000
*   GETLST=''B;                     /* CLEAR GETMIAN LIST AREA       */ 01303000
         XC    GETLST(10),GETLST                                   0376 01304000
*   LSDPTR=INSADLSD;                /* POINT TO LSD                  */ 01305000
         L     @01,ECTIOWA(,@15)                                   0377 01306000
         L     @01,IOSTELM(,@01)                                   0377 01307000
         L     @15,INSADLSD-1(,@01)                                0377 01308000
         LA    @15,0(,@15)                                         0377 01309000
         ST    @15,LSDPTR(,COMONPTR)                               0377 01310000
*   DO;                             /* GETMAIN (EC) MF(M,GETLST)     */ 01311000
*     GETLST04='20'X;               /* TYPE                          */ 01312000
         MVI   GETLST04,X'20'                                      0379 01313000
*   END;                            /* GETMAIN (EC) MF(M,GETLST) SET    01314000
*                                      TYPE OF GETMAIN               */ 01315000
*   DO;                             /* FREEMAIN (E) MF(M,FRELST)     */ 01316000
*     FRELST05='00'X;               /* SET TYPE                      */ 01317000
         MVI   FRELST05,X'00'                                      0382 01318000
*   END;                            /* FREEMAIN (E) MF(M,FRELST) SET    01319000
*                                      TYPE OF FREEMAIN              */ 01320000
*   END INTSETUP;                                                  0384 01321000
@EL00002 DS    0H                                                  0384 01322000
@EF00002 DS    0H                                                  0384 01323000
@ER00002 LM    @14,@12,12(@13)                                     0384 01324000
         BR    @14                                                 0384 01325000
*                                                                  0385 01326000
*   /*****************************************************************/ 01327000
*   /*                                                               */ 01328000
*   /* MESSAGE OUTPUT ROUTINE                                        */ 01329000
*   /*                                                               */ 01330000
*   /*****************************************************************/ 01331000
*                                                                  0385 01332000
*MSGOUT:                                                           0385 01333000
*   PROC OPTIONS(SAVEAREA);                                        0385 01334000
MSGOUT   STM   @14,@12,12(@13)                                     0385 01335000
         ST    @13,@SA00003+4                                      0385 01336000
         LA    @14,@SA00003                                        0385 01337000
         ST    @14,8(,@13)                                         0385 01338000
         LR    @13,@14                                             0385 01339000
*   MATCH=NO;                       /* RESET MATCH SWITCH            */ 01340000
         NI    MATCH(COMONPTR),B'11101111'                         0386 01341000
*   IF RCABEND=YES THEN             /* FOR AN ABEND ERROR            */ 01342000
         TM    RCABEND(COMONPTR),B'10000000'                       0387 01343000
         BNO   @RF00387                                            0387 01344000
*     I=MSGDIM;                     /* GET INTERNAL ERROR MSG        */ 01345000
         L     @15,@CA00231                                        0388 01346000
         LH    @15,MSGDIM-MSGTABL(,@15)                            0388 01347000
         ST    @15,I(,COMONPTR)                                    0388 01348000
*   ELSE                            /* OTHERWISE START FROM BEGINNING*/ 01349000
*     I=F1;                         /*                               */ 01350000
         B     @RC00387                                            0389 01351000
@RF00387 MVC   I(4,COMONPTR),@CF00042                              0389 01352000
*   DO I=I TO MSGDIM WHILE MATCH=NO;/* NOT FOUND?-TRY HERE           */ 01353000
@RC00387 L     @15,I(,COMONPTR)                                    0390 01354000
         B     @DE00390                                            0390 01355000
@DL00390 TM    MATCH(COMONPTR),B'00010000'                         0390 01356000
         BNZ   @DC00390                                            0390 01357000
*     IF(ERRSAV>=IDA(I)&ERRSAV<=IDC(I))|I=MSGDIM THEN/* A MATCH      */ 01358000
         L     @15,ERRSAV                                          0391 01359000
         L     @14,I(,COMONPTR)                                    0391 01360000
         MH    @14,@CH00216                                        0391 01361000
         L     @07,@CA00231                                        0391 01362000
         LA    @01,0(@14,@07)                                      0391 01363000
         AL    @01,@CF01096                                        0391 01364000
         CH    @15,IDA-MSGTABL-2(,@01)                             0391 01365000
         BL    @GL00025                                            0391 01366000
         AL    @07,@CF01097                                        0391 01367000
         CH    @15,IDC-MSGTABL-4(@14,@07)                          0391 01368000
         BNH   @RT00391                                            0391 01369000
@GL00025 L     @15,@CA00231                                        0391 01370000
         L     @14,I(,COMONPTR)                                    0391 01371000
         CH    @14,MSGDIM-MSGTABL(,@15)                            0391 01372000
         BNE   @RF00391                                            0391 01373000
@RT00391 DS    0H                                                  0392 01374000
*       DO;                         /* FILL IN OLD                   */ 01375000
*         MATCH=YES;                /* TERMINATE SCAN FOR MESSAGE    */ 01376000
         OI    MATCH(COMONPTR),B'00010000'                         0393 01377000
*         N=SEGNUM(I);              /* GET CURRENT NUMBER OF SEGMENTS*/ 01378000
         L     @15,I(,COMONPTR)                                    0394 01379000
         MH    @15,@CH00216                                        0394 01380000
         L     @14,@CA00231                                        0394 01381000
         LA    @01,0(@15,@14)                                      0394 01382000
         BCTR  @01,0                                               0394 01383000
         BCTR  @01,0                                               0394 01384000
         SLR   @00,@00                                             0394 01385000
         IC    @00,SEGNUM-MSGTABL-10(,@01)                         0394 01386000
         ST    @00,N                                               0394 01387000
*         OLD(3)=MSGSEG1(I);        /* FIRST SEGMENT                 */ 01388000
         LA    @01,0(@15,@14)                                      0395 01389000
         AL    @01,@CF01099                                        0395 01390000
         L     @01,MSGSEG1-MSGTABL-7(,@01)                         0395 01391000
         LA    @01,0(,@01)                                         0395 01392000
         ST    @01,OLD+8                                           0395 01393000
*         OLD(4)=MSGSEG2(I);        /* SECOND SEGMENT IF ONE         */ 01394000
         BCTR  @14,0                                               0396 01395000
         BCTR  @14,0                                               0396 01396000
         L     @01,MSGSEG2-MSGTABL-11(@15,@14)                     0396 01397000
         LA    @01,0(,@01)                                         0396 01398000
         ST    @01,OLD+12                                          0396 01399000
*         IF RECURSE=YES&ERRSAV=E908 THEN/* IF ALSO TYPE ERROR       */ 01400000
         TM    RECURSE(COMONPTR),B'00100000'                       0397 01401000
         BNO   @RF00397                                            0397 01402000
         CLC   ERRSAV(4),@CF00785                                  0397 01403000
         BNE   @RF00397                                            0397 01404000
*           DO;                     /* FILL IN OLD                   */ 01405000
*             OLD(2)=N+F1;          /* SET COUNT                     */ 01406000
         AL    @00,@CF00042                                        0399 01407000
         ST    @00,OLD+4                                           0399 01408000
*             OLD(5)=OLD(4);        /* GET ROOM FOR ALSO             */ 01409000
         L     @15,OLD+12                                          0400 01410000
         ST    @15,OLD+16                                          0400 01411000
*             OLD(4)=ADDR(ALSO);    /* GET ADDR OF ALSO              */ 01412000
         L     @15,@CA00229                                        0401 01413000
         ST    @15,OLD+12                                          0401 01414000
*           END;                    /*                               */ 01415000
*         ELSE                      /* OTHERWISE                     */ 01416000
*           OLD(2)=N;               /* NUMBER OF SEGMENTS            */ 01417000
         B     @RC00397                                            0403 01418000
@RF00397 L     @15,N                                               0403 01419000
         ST    @15,OLD+4                                           0403 01420000
*         IF SECLEVEL(I)=YES THEN   /* IF PROCESSING REQ SECOND LVL  */ 01421000
@RC00397 L     @15,I(,COMONPTR)                                    0404 01422000
         MH    @15,@CH00216                                        0404 01423000
         L     @14,@CA00231                                        0404 01424000
         ALR   @14,@15                                             0404 01425000
         AL    @14,@CF01099                                        0404 01426000
         TM    SECLEVEL-MSGTABL-6(@14),B'10000000'                 0404 01427000
         BNO   @RF00404                                            0404 01428000
*           DO;                     /* BUILD SECOND LEVEL MSG        */ 01429000
*             OLD(1)=ADDR(OLD2);    /* POINT TO SECOND LEVEL         */ 01430000
         LA    @15,OLD2                                            0406 01431000
         ST    @15,OLD                                             0406 01432000
*             OLD2(1)=F0;           /* NO THIRD LEVEL MESSAGE        */ 01433000
         SLR   @15,@15                                             0407 01434000
         ST    @15,OLD2                                            0407 01435000
*             OLD2(2)=F1;           /* ONE SEGMENT                   */ 01436000
         MVC   OLD2+4(4),@CF00042                                  0408 01437000
*             OLD2(3)=ADDR(MYSEG);  /* MESSAGE                       */ 01438000
         LA    @15,MYSEG                                           0409 01439000
         ST    @15,OLD2+8                                          0409 01440000
*             MYSEG=MSTRLV2(1:LENGTH(MYSEG));/* COPY MSG TO GOTTEN   */ 01441000
         L     @15,@CA00230                                        0410 01442000
         MVC   MYSEG(35),MSTRLV2-MSTRLV2(@15)                      0410 01443000
*             CALL LOCATE(LASTCC,LENGTH(LASTCC),F0);/* LOCATE LASTCC */ 01444000
         LA    @01,@AL00411                                        0411 01445000
         BAL   @14,LOCATE                                          0411 01446000
*             IF ERROR=F0&SVTLNG>F0 THEN/* IF LOCATE OK              */ 01447000
         SLR   @15,@15                                             0412 01448000
         C     @15,ERROR                                           0412 01449000
         BNE   @RF00412                                            0412 01450000
         L     @01,SNTELPTR(,COMONPTR)                             0412 01451000
         L     @14,SNTVLPTR(,@01)                                  0412 01452000
         LH    @07,SVTLNG(,@14)                                    0412 01453000
         CR    @07,@15                                             0412 01454000
         BNH   @RF00412                                            0412 01455000
*               DO;                 /* FILL IN CODE                  */ 01456000
*                 N=MIN(SVTLNG,F5); /* SAVE LENGTH (MAX OF 5)        */ 01457000
         LA    @06,5                                               0414 01458000
         CR    @07,@06                                             0414 01459000
         BNH   *+6                                                      01460000
         LR    @07,@06                                             0414 01461000
         ST    @07,N                                               0414 01462000
*                 IF SVTDATA(1)=CCS|SVTDATA(1)=CCU THEN/* ABEND CD   */ 01463000
         CLI   SVTDATA(@14),C'S'                                   0415 01464000
         BE    @RT00415                                            0415 01465000
         CLI   SVTDATA(@14),C'U'                                   0415 01466000
         BNE   @RF00415                                            0415 01467000
@RT00415 DS    0H                                                  0416 01468000
*                   DO;             /* ABEND CODE ?                  */ 01469000
*                     N=MIN(SVTLNG,F5);/* SAVE LENGTH (MAX OF 5)     */ 01470000
         L     @01,SNTELPTR(,COMONPTR)                             0417 01471000
         L     @15,SNTVLPTR(,@01)                                  0417 01472000
         LH    @14,SVTLNG(,@15)                                    0417 01473000
         LA    @07,5                                               0417 01474000
         CR    @14,@07                                             0417 01475000
         BNH   *+6                                                      01476000
         LR    @14,@07                                             0417 01477000
         ST    @14,N                                               0417 01478000
*                     OUTCD=SVTDATA(1:N);/* OK ALL CHARS             */ 01479000
         MVI   OUTCD+1,C' '                                        0418 01480000
         MVC   OUTCD+2(3),OUTCD+1                                  0418 01481000
         BCTR  @14,0                                               0418 01482000
         EX    @14,@SM01100                                        0418 01483000
*                   END;            /*                               */ 01484000
*                 ELSE              /* OTHERWISE                     */ 01485000
*                   DO;             /* DONT OVERLAY THE 'E'          */ 01486000
         B     @RC00415                                            0420 01487000
@RF00415 DS    0H                                                  0421 01488000
*                     N=MIN(SVTLNG,F3);/* MAX NUMBER LENGTH          */ 01489000
         L     @01,SNTELPTR(,COMONPTR)                             0421 01490000
         L     @15,SNTVLPTR(,@01)                                  0421 01491000
         LH    @14,SVTLNG(,@15)                                    0421 01492000
         LA    @07,3                                               0421 01493000
         CR    @14,@07                                             0421 01494000
         BNH   *+6                                                      01495000
         LR    @14,@07                                             0421 01496000
         ST    @14,N                                               0421 01497000
*                     OUTCD(5-N:4)=SVTDATA(1:N);/* ON NUMBERS        */ 01498000
         LCR   @14,@14                                             0422 01499000
         AL    @14,@CF00052                                        0422 01500000
         LA    @01,OUTCD-1(@14)                                    0422 01501000
         LCR   @14,@14                                             0422 01502000
         AL    @14,@CF00107                                        0422 01503000
         EX    @14,@SM01102                                        0422 01504000
*                   END;            /*                               */ 01505000
*               END;                /*                               */ 01506000
*           END;                    /*                               */ 01507000
*         ELSE                      /* OTHERWISE                     */ 01508000
*           OLD(1)=F0;              /* NO SECOUND LEVEL MESSAGE      */ 01509000
         B     @RC00404                                            0426 01510000
@RF00404 SLR   @15,@15                                             0426 01511000
         ST    @15,OLD                                             0426 01512000
*       END;                        /*                               */ 01513000
@RC00404 DS    0H                                                  0428 01514000
*   END;                            /*                               */ 01515000
@RF00391 LA    @15,1                                               0428 01516000
         AL    @15,I(,COMONPTR)                                    0428 01517000
         ST    @15,I(,COMONPTR)                                    0428 01518000
@DE00390 L     @14,@CA00231                                        0428 01519000
         CH    @15,MSGDIM-MSGTABL(,@14)                            0428 01520000
         BNH   @DL00390                                            0428 01521000
@DC00390 DS    0H                                                  0429 01522000
*   IOPL(4)=ADDR(PUTMLVL);          /* PUTLINE LIST FORM             */ 01523000
         LA    @15,PUTMLVL                                         0429 01524000
         ST    @15,IOPL+12(,COMONPTR)                              0429 01525000
*   RFY                                                            0430 01526000
*    (R1,                                                          0430 01527000
*     R2,                                                          0430 01528000
*     R15) RSTD;                    /* RESTRICT ENTRY REG            */ 01529000
*   R1=ADDR(IOPL);                  /* GET ADDR OF IOPL              */ 01530000
         LR    R1,COMONPTR                                         0431 01531000
*   R2=ADDR(OLD);                   /* GET ADDR OF OLD               */ 01532000
         LA    R2,OLD                                              0432 01533000
*   R15=ADDR(IKJEFT40);             /* ENTRY TO PUTLINE              */ 01534000
         L     R15,@CV00101                                        0433 01535000
*   GEN REFS(R1,R2,R15)                                            0434 01536000
*       (PUTLINE OUTPUT=((2),MULTLVL),MF=(E,(1)),ENTRY=(15));      0434 01537000
         PUTLINE OUTPUT=((2),MULTLVL),MF=(E,(1)),ENTRY=(15)             01538000
*   RFY                                                            0435 01539000
*    (R1,                                                          0435 01540000
*     R2,                                                          0435 01541000
*     R15) UNRSTD;                  /* RELEASE REG 15                */ 01542000
*   END MSGOUT;                                                    0436 01543000
@EL00003 L     @13,4(,@13)                                         0436 01544000
@EF00003 DS    0H                                                  0436 01545000
@ER00003 LM    @14,@12,12(@13)                                     0436 01546000
         BR    @14                                                 0436 01547000
*                                                                  0437 01548000
*   /*****************************************************************/ 01549000
*   /*                                                               */ 01550000
*   /* INSERT MAINLINE                                               */ 01551000
*   /*                                                               */ 01552000
*   /*****************************************************************/ 01553000
*                                                                  0437 01554000
*INSERT:                                                           0437 01555000
*   PROC;                                                          0437 01556000
INSERT   STM   @14,@12,@SA00004                                    0437 01557000
*   IF INSTHEN=NO THEN              /* AS LONG AS NOT INSERT THEN    */ 01558000
         TM    INSTHEN(COMONPTR),B'00000001'                       0438 01559000
         BNZ   @RF00438                                            0438 01560000
*     CALL LOCATE(C(V),LEN,F0);     /* LOCATE SYMBOLIC VARIABLE      */ 01561000
         L     @01,BUFBASE(,COMONPTR)                              0439 01562000
         L     @15,V                                               0439 01563000
         LA    @15,C-1(@15,@01)                                    0439 01564000
         ST    @15,@AL00001                                        0439 01565000
         LA    @15,LEN(,COMONPTR)                                  0439 01566000
         ST    @15,@AL00001+4                                      0439 01567000
         LA    @15,@CF00439                                        0439 01568000
         ST    @15,@AL00001+8                                      0439 01569000
         LA    @01,@AL00001                                        0439 01570000
         BAL   @14,LOCATE                                          0439 01571000
*   IF ERROR=F0 THEN                /* IF VARIABLE FOUND             */ 01572000
@RF00438 L     @15,ERROR                                           0440 01573000
         LTR   @15,@15                                             0440 01574000
         BNZ   @RF00440                                            0440 01575000
*     DO;                           /*                               */ 01576000
*       IF NOAMPER=NO THEN          /* IF AMPERSAND PRESENT          */ 01577000
         TM    NOAMPER(COMONPTR),B'00000010'                       0442 01578000
         BNZ   @RF00442                                            0442 01579000
*         DO;                       /* RESET V TO AMPERSAND AND      */ 01580000
*           V=V-F1;                 /* ADD THE LENGTH OF AN          */ 01581000
         L     @15,V                                               0444 01582000
         BCTR  @15,0                                               0444 01583000
         ST    @15,V                                               0444 01584000
*           LEN=LEN+F1;             /* AMPERSAND TO LEN              */ 01585000
         LA    @15,1                                               0445 01586000
         AL    @15,LEN(,COMONPTR)                                  0445 01587000
         ST    @15,LEN(,COMONPTR)                                  0445 01588000
*         END;                      /*                               */ 01589000
*       IF INSTHEN=YES THEN         /* IF IN INSERT THEN MODE        */ 01590000
@RF00442 TM    INSTHEN(COMONPTR),B'00000001'                       0447 01591000
         BNO   @RF00447                                            0447 01592000
*         DO;                       /* POINT TO THEN                 */ 01593000
*           INSRTDA=ADDR(CTHEN);    /* ADDR OF THEN                  */ 01594000
         LA    @15,@CC00727                                        0449 01595000
         ST    @15,INSRTDA                                         0449 01596000
*           INSRTLN=LENGTH(CTHEN);  /* LENGTH OF THEN                */ 01597000
         MVC   INSRTLN(4),@CF00107                                 0450 01598000
*         END;                      /*                               */ 01599000
*       ELSE                        /* OTHERWISE                     */ 01600000
*         DO;                       /* GET VARIABLES INSERT DATA     */ 01601000
         B     @RC00447                                            0452 01602000
@RF00447 DS    0H                                                  0453 01603000
*           INSRTLN=SVTLNG;         /* GET INSERT LENGTH             */ 01604000
         L     @15,SNTELPTR(,COMONPTR)                             0453 01605000
         L     @14,SNTVLPTR(,@15)                                  0453 01606000
         LH    @07,SVTLNG(,@14)                                    0453 01607000
         ST    @07,INSRTLN                                         0453 01608000
*           INSRTDA=ADDR(SVTDATA);  /* GET POINTER TO INSERT DATA    */ 01609000
         LA    @14,SVTDATA(,@14)                                   0454 01610000
         ST    @14,INSRTDA                                         0454 01611000
*           IF SNTEVAL=YES THEN     /* IF EVALUATION REQUIRED        */ 01612000
         TM    SNTEVAL(@15),B'00000010'                            0455 01613000
         BNO   @RF00455                                            0455 01614000
*             CALL IMVALRTN;        /* CALL ROUTINE TO PROCESS EVAL  */ 01615000
         BAL   @14,IMVALRTN                                        0456 01616000
*         END;                                                     0457 01617000
@RF00455 DS    0H                                                  0458 01618000
*       EXITA=NO;                   /* SAY WE HAVE INSERTED DATA     */ 01619000
@RC00447 NI    EXITA(COMONPTR),B'01111111'                         0458 01620000
*       IF ERROR=F0&WAIT=NO THEN    /* IF NO ERROR FROM BUILT IN FUNC*/ 01621000
         L     @15,ERROR                                           0459 01622000
         LTR   @15,@15                                             0459 01623000
         BNZ   @RF00459                                            0459 01624000
         TM    WAIT(COMONPTR),B'00010000'                          0459 01625000
         BNZ   @RF00459                                            0459 01626000
*         DO;                       /* PERFORM INSERT                */ 01627000
*           IF INSRTLN-LEN>FREEAMT THEN/* IF INSERT DATA IS GREATER  */ 01628000
         L     @15,INSRTLN                                         0461 01629000
         SL    @15,LEN(,COMONPTR)                                  0461 01630000
         L     @14,FREEAMT(,COMONPTR)                              0461 01631000
         CR    @15,@14                                             0461 01632000
         BNH   @RF00461                                            0461 01633000
*             CALL GETMORE(INSRTLN-LEN-FREEAMT);/* GET BIGGER BUFFER */ 01634000
         SLR   @15,@14                                             0462 01635000
         ST    @15,@AFTEMPS                                        0462 01636000
         LA    @15,@AFTEMPS                                        0462 01637000
         ST    @15,@AL00001                                        0462 01638000
         LA    @01,@AL00001                                        0462 01639000
         BAL   @14,GETMORE                                         0462 01640000
*           ELSE                    /* OTHERWISE UPDATE FREE AMOUNT  */ 01641000
*             FREEAMT=FREEAMT-(INSRTLN-LEN);/* UPDATE FREEAMT        */ 01642000
         B     @RC00461                                            0463 01643000
@RF00461 L     @15,INSRTLN                                         0463 01644000
         SL    @15,LEN(,COMONPTR)                                  0463 01645000
         LCR   @15,@15                                             0463 01646000
         AL    @15,FREEAMT(,COMONPTR)                              0463 01647000
         ST    @15,FREEAMT(,COMONPTR)                              0463 01648000
*           IF ERROR=F0 THEN        /* NO ERROR FROM GETMORE         */ 01649000
@RC00461 L     @15,ERROR                                           0464 01650000
         LTR   @15,@15                                             0464 01651000
         BNZ   @RF00464                                            0464 01652000
*             DO;                   /*                               */ 01653000
*               RFY                                                0466 01654000
*                (R2,                                              0466 01655000
*                 R3,                                              0466 01656000
*                 R4,                                              0466 01657000
*                 R5) RSTD;         /* RESTRICT REGISTERS            */ 01658000
*               R2=ADDR(NEWC);      /* POINT TO NEW BUFFER           */ 01659000
         L     R2,NEWBASE(,COMONPTR)                               0467 01660000
         LA    R2,NEWC(,R2)                                        0467 01661000
*               R3=V-F1;            /* LENGTH OF FIRST PART          */ 01662000
         L     R3,V                                                0468 01663000
         BCTR  R3,0                                                0468 01664000
*               R4=ADDR(C);         /* POINT TO OLD BUFFER           */ 01665000
         L     R4,BUFBASE(,COMONPTR)                               0469 01666000
         LA    R4,C(,R4)                                           0469 01667000
*               R5=R3;              /* SAME LENGTH                   */ 01668000
         LR    R5,R3                                               0470 01669000
*               MVCL(R2,R4);        /* MOVE FIRST PART OF BUFFER     */ 01670000
         MVCL  R2,R4                                               0471 01671000
*               KPTR=R2;            /* SAVE LOC IN BUFFER WHERE DATA    01672000
*                                      IS GOING                      */ 01673000
         ST    R2,KPTR                                             0472 01674000
*               R3=INSRTLN;         /* LENGTH OF SYMBOLIC VARIABLE   */ 01675000
         L     R3,INSRTLN                                          0473 01676000
*               R4=INSRTDA;         /* POINT TO SUBSTITUTE DATA      */ 01677000
         L     R4,INSRTDA                                          0474 01678000
*               R5=R3;              /* EQUAL LENGTH                  */ 01679000
         LR    R5,R3                                               0475 01680000
*               MVCL(R2,R4);        /* MOVE IN DATA (R2 UPDATED BY 0476 01681000
*                                      MVCL)                         */ 01682000
         MVCL  R2,R4                                               0476 01683000
*               R3=NEWLL-(INSRTLN+V+F3);/* TO LENGTH - ALREADY MOVED */ 01684000
         L     @15,NEWBASE(,COMONPTR)                              0477 01685000
         LA    @14,3                                               0477 01686000
         L     R3,INSRTLN                                          0477 01687000
         AL    R3,V                                                0477 01688000
         ALR   R3,@14                                              0477 01689000
         LCR   R3,R3                                               0477 01690000
         AH    R3,NEWLL(,@15)                                      0477 01691000
*               R4=ADDR(C(I));      /* POINT TO RESUME BUFFER        */ 01692000
         L     @07,I(,COMONPTR)                                    0478 01693000
         L     @06,BUFBASE(,COMONPTR)                              0478 01694000
         LA    R4,C-1(@07,@06)                                     0478 01695000
*               R5=(LL-(I+F3))|BLANKS;/* THE REMAINING SEGMENT AND 0479 01696000
*                                      PAD                           */ 01697000
         ALR   @07,@14                                             0479 01698000
         LCR   @07,@07                                             0479 01699000
         AH    @07,LL(,@06)                                        0479 01700000
         O     @07,@CF00622                                        0479 01701000
         LR    R5,@07                                              0479 01702000
*               I=R2-(ADDR(NEWC));  /* POINT I TO RESUME SEGMENT     */ 01703000
         LA    @15,NEWC(,@15)                                      0480 01704000
         LCR   @15,@15                                             0480 01705000
         ALR   @15,R2                                              0480 01706000
         ST    @15,I(,COMONPTR)                                    0480 01707000
*               MVCL(R2,R4);        /* MOVE RESUME PART OF BUFFER    */ 01708000
         MVCL  R2,R4                                               0481 01709000
*               RFY                                                0482 01710000
*                (R2,                                              0482 01711000
*                 R3,                                              0482 01712000
*                 R4,                                              0482 01713000
*                 R5) UNRSTD;       /* RELEASE REGISTERS             */ 01714000
*               IF SNTNOSCN=YES THEN/* IF NO RESCAN ALLOWED          */ 01715000
         L     @01,SNTELPTR(,COMONPTR)                             0483 01716000
         TM    SNTNOSCN(@01),B'00001000'                           0483 01717000
         BNO   @RF00483                                            0483 01718000
*                 DO K=INSRTLN TO F1 BY-F1;                        0484 01719000
         L     @15,INSRTLN                                         0484 01720000
         ST    @15,K                                               0484 01721000
         B     @DE00484                                            0484 01722000
@DL00484 DS    0H                                                  0485 01723000
*                   FOLD=YES;       /* FOLD TO SPECIAL CHARS         */ 01724000
         OI    FOLD(COMONPTR),B'00010000'                          0485 01725000
*                   IF KPTR->INSRTCHR(K)=AMPSAND THEN/* NO RESCAN    */ 01726000
         L     @14,KPTR                                            0486 01727000
         ALR   @15,@14                                             0486 01728000
         BCTR  @15,0                                               0486 01729000
         CLI   INSRTCHR(@15),C'&&'                                 0486 01730000
         BNE   @RF00486                                            0486 01731000
*                     KPTR->INSRTCHR(K)=NOSCNAMP;/* REQUIRES SPECIAL    01732000
*                                      FOLDED NO-RESCAN AMPERSAND    */ 01733000
         L     @15,K                                               0487 01734000
         ALR   @14,@15                                             0487 01735000
         BCTR  @14,0                                               0487 01736000
         MVI   INSRTCHR(@14),X'03'                                 0487 01737000
*                   ELSE                                           0488 01738000
*                     TR(KPTR->INSRTCHR(K),TRTABDN);               0488 01739000
         B     @RC00486                                            0488 01740000
@RF00486 L     @01,KPTR                                            0488 01741000
         AL    @01,K                                               0488 01742000
         BCTR  @01,0                                               0488 01743000
         TR    INSRTCHR(1,@01),TRTABDN                             0488 01744000
*                 END;                                             0489 01745000
*                                                                  0489 01746000
@RC00486 SLR   @15,@15                                             0489 01747000
         BCTR  @15,0                                               0489 01748000
         AL    @15,K                                               0489 01749000
         ST    @15,K                                               0489 01750000
@DE00484 LTR   @15,@15                                             0489 01751000
         BP    @DL00484                                            0489 01752000
*               /*****************************************************/ 01753000
*               /*                                                   */ 01754000
*               /* FREE OLD BUFFER IF A NEW ONE WAS GOTTEN           */ 01755000
*               /*                                                   */ 01756000
*               /*****************************************************/ 01757000
*                                                                  0490 01758000
*               IF FREESW=YES THEN  /* IF FREEMAIN NECESSARY         */ 01759000
@RF00483 TM    FREESW(COMONPTR),B'00100000'                        0490 01760000
         BNO   @RF00490                                            0490 01761000
*                 DO;               /*                               */ 01762000
*                   DO;             /* FREEMAIN LV(FREELEN(1))     0492 01763000
*                                      A(FREEADDR) SP(1) MF(E,FRELST)*/ 01764000
*                     RESPECIFY                                    0493 01765000
*                      (GPR01P) RESTRICTED;                        0493 01766000
*                     FRELST02=FREELEN(1);/* LENGTH                  */ 01767000
         MVC   FRELST02(3),FREELEN+1                               0494 01768000
*                     FRELST04=ADDR(FREEADDR);/* ADDR OF ADDR LIST   */ 01769000
         LA    @00,FREEADDR                                        0495 01770000
         STCM  @00,7,FRELST04                                      0495 01771000
*                     FRELST06=1;   /* SUBPOOL VALUE                 */ 01772000
         MVI   FRELST06,X'01'                                      0496 01773000
*                     GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST     */ 01774000
         LA    GPR01P,FRELST                                       0497 01775000
*                     SVC(5);       /* STANDARD-FORM OF GETMAIN      */ 01776000
         SVC   5                                                   0498 01777000
*                     RESPECIFY                                    0499 01778000
*                      (GPR01P) UNRESTRICTED;                      0499 01779000
*                   END;            /* FREEMAIN LV(FREELEN(1))     0500 01780000
*                                      A(FREEADDR) SP(1) MF(E,FRELST)*/ 01781000
*                   BUFBASE=NEWBASE;/* RESET POINTER TO BUFFER       */ 01782000
         L     @15,NEWBASE(,COMONPTR)                              0501 01783000
         ST    @15,BUFBASE(,COMONPTR)                              0501 01784000
*                   NEWBASE=NEWBASE+LL;/* POINT TO NEW FREE BUFFER   */ 01785000
         LH    @14,LL(,@15)                                        0502 01786000
         ALR   @15,@14                                             0502 01787000
         ST    @15,NEWBASE(,COMONPTR)                              0502 01788000
*                   NEWLL=LL;       /* INIT LENGTH                   */ 01789000
         STH   @14,NEWLL(,@15)                                     0503 01790000
*                   NEWOO=F0;       /* INIT OFFSET                   */ 01791000
         SLR   @14,@14                                             0504 01792000
         STH   @14,NEWOO(,@15)                                     0504 01793000
*                   FREESW=NO;      /* RESET FREESWITCH              */ 01794000
         NI    FREESW(COMONPTR),B'11011111'                        0505 01795000
*                 END;                                             0506 01796000
*               ELSE                /* OTHERWISE                     */ 01797000
*                 DO;                                              0507 01798000
         B     @RC00490                                            0507 01799000
@RF00490 DS    0H                                                  0508 01800000
*                   BUFBASE=BUFBASE&&NEWBASE;/* SWAP BUFFER POINTERS */ 01801000
         L     @15,NEWBASE(,COMONPTR)                              0508 01802000
         L     @14,BUFBASE(,COMONPTR)                              0508 01803000
         XR    @14,@15                                             0508 01804000
         ST    @14,BUFBASE(,COMONPTR)                              0508 01805000
*                   NEWBASE=NEWBASE&&BUFBASE;/*                      */ 01806000
         XR    @15,@14                                             0509 01807000
         ST    @15,NEWBASE(,COMONPTR)                              0509 01808000
*                   BUFBASE=BUFBASE&&NEWBASE;/*                      */ 01809000
         XR    @14,@15                                             0510 01810000
         ST    @14,BUFBASE(,COMONPTR)                              0510 01811000
*                 END;                                             0511 01812000
*             END;                                                 0512 01813000
*         END;                                                     0513 01814000
*       ELSE                        /* OTHERWISE                     */ 01815000
*         WAIT=NO;                  /* TURN OFFF WAIT                */ 01816000
         B     @RC00459                                            0514 01817000
@RF00459 NI    WAIT(COMONPTR),B'11101111'                          0514 01818000
*     END;                                                         0515 01819000
*   END INSERT;                                                    0516 01820000
@EL00004 DS    0H                                                  0516 01821000
@EF00004 DS    0H                                                  0516 01822000
@ER00004 LM    @14,@12,@SA00004                                    0516 01823000
         BR    @14                                                 0516 01824000
*                                                                  0517 01825000
*   /*****************************************************************/ 01826000
*   /*                                                               */ 01827000
*   /* GET BIGGER BUFFER                                             */ 01828000
*   /*                                                               */ 01829000
*   /*****************************************************************/ 01830000
*                                                                  0517 01831000
*GETMORE:                                                          0517 01832000
*   PROC(MINIMUM);                                                 0517 01833000
GETMORE  STM   @14,@12,12(@13)                                     0517 01834000
         MVC   @PC00005(4),0(@01)                                  0517 01835000
*   DCL                                                            0518 01836000
*     MINIMUM FIXED(31);                                           0518 01837000
*   HOWMUCH=F16*((GAS+MINIMUM+LL)/F8);/* CALCULATE HOWMUCH TO GET    */ 01838000
         L     @15,@PC00005                                        0519 01839000
         LA    @00,200                                             0519 01840000
         AL    @00,MINIMUM(,@15)                                   0519 01841000
         L     @15,BUFBASE(,COMONPTR)                              0519 01842000
         LH    @14,LL(,@15)                                        0519 01843000
         ALR   @00,@14                                             0519 01844000
         SRDA  @00,32                                              0519 01845000
         D     @00,@CF00094                                        0519 01846000
         SLA   @01,4                                               0519 01847000
         ST    @01,HOWMUCH                                         0519 01848000
*   IF CORE=YES THEN                /* IF ALREADY CORE               */ 01849000
         TM    CORE(COMONPTR),B'10000000'                          0520 01850000
         BNO   @RF00520                                            0520 01851000
*     DO;                           /* FIND ADDR OF OLD CORE         */ 01852000
*       FREESW=YES;                 /* ALLOW FREEMAIN                */ 01853000
         OI    FREESW(COMONPTR),B'00100000'                        0522 01854000
*       FREEADDR(1)=MIN(BUFBASE,NEWBASE);/* GET LOW ADDR FOR FREE    */ 01855000
         L     @07,NEWBASE(,COMONPTR)                              0523 01856000
         CR    @15,@07                                             0523 01857000
         BNH   *+6                                                      01858000
         LR    @15,@07                                             0523 01859000
         ST    @15,FREEADDR                                        0523 01860000
*       FREELEN(1)=LL*F2;           /* AMOUNT TO FREE                */ 01861000
         ALR   @14,@14                                             0524 01862000
         ST    @14,FREELEN                                         0524 01863000
*     END;                          /*                               */ 01864000
*   DO;                             /* GETMAIN LV(HOWMUCH) A(NEWBASE)   01865000
*                                      SP(1) MF(E,GETLST)          0526 01866000
*                                      RTCD(RETURNCD)                */ 01867000
@RF00520 DS    0H                                                  0527 01868000
*     RESPECIFY                                                    0527 01869000
*      (GPR01P,                                                    0527 01870000
*       GPR15F) RESTRICTED;                                        0527 01871000
*     GETLST01=HOWMUCH;             /* LENGTH                        */ 01872000
         L     @14,HOWMUCH                                         0528 01873000
         ST    @14,GETLST01                                        0528 01874000
*     GETLST03=ADDR(NEWBASE);       /* ADDR OF ADDR LIST             */ 01875000
         LA    @14,NEWBASE(,COMONPTR)                              0529 01876000
         STCM  @14,7,GETLST03                                      0529 01877000
*     GETLST05=1;                   /* SUBPOOL VALUE                 */ 01878000
         MVI   GETLST05,X'01'                                      0530 01879000
*     GPR01P=ADDR(GETLST);          /* REG1 POINTS TO LIST           */ 01880000
         LA    GPR01P,GETLST                                       0531 01881000
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */ 01882000
         SVC   4                                                   0532 01883000
*     RETURNCD=GPR15F;              /* SET RETURN CODE               */ 01884000
         ST    GPR15F,RETURNCD                                     0533 01885000
*     RESPECIFY                                                    0534 01886000
*      (GPR01P,                                                    0534 01887000
*       GPR15F) UNRESTRICTED;                                      0534 01888000
*   END;                            /* GETMAIN LV(HOWMUCH) A(NEWBASE)   01889000
*                                      SP(1) MF(E,GETLST)          0535 01890000
*                                      RTCD(RETURNCD)                */ 01891000
*   IF ERROR=F0&RETURNCD^=F0 THEN   /* GETMAIN FAIL                  */ 01892000
         SLR   @15,@15                                             0536 01893000
         C     @15,ERROR                                           0536 01894000
         BNE   @RF00536                                            0536 01895000
         L     @14,RETURNCD                                        0536 01896000
         CR    @14,@15                                             0536 01897000
         BE    @RF00536                                            0536 01898000
*     DO;                           /* AND PROCESS ORIG BUFFER       */ 01899000
*       IF CORE=NO THEN             /* POINT TO ORIG BUFFER          */ 01900000
         TM    CORE(COMONPTR),B'10000000'                          0538 01901000
         BNZ   @RF00538                                            0538 01902000
*         NEWBASE=BUFBASE;          /* FOR SQUASH                    */ 01903000
         L     @15,BUFBASE(,COMONPTR)                              0539 01904000
         ST    @15,NEWBASE(,COMONPTR)                              0539 01905000
*       ERROR=E16;                  /* SET ERROR CODE                */ 01906000
@RF00538 MVC   ERROR(4),@CF00104                                   0540 01907000
*     END;                                                         0541 01908000
*   ELSE                                                           0542 01909000
*     DO;                           /*                               */ 01910000
         B     @RC00536                                            0542 01911000
@RF00536 DS    0H                                                  0543 01912000
*       NEWLL=HOWMUCH/F2;           /* SET NEW LL                    */ 01913000
         L     @15,NEWBASE(,COMONPTR)                              0543 01914000
         L     @00,HOWMUCH                                         0543 01915000
         SRDA  @00,32                                              0543 01916000
         D     @00,@CF00062                                        0543 01917000
         STH   @01,NEWLL(,@15)                                     0543 01918000
*       FREEAMT=NEWLL-(LL+MINIMUM); /* RESET FREEAMT                 */ 01919000
         L     @14,BUFBASE(,COMONPTR)                              0544 01920000
         L     @07,@PC00005                                        0544 01921000
         LH    @06,LL(,@14)                                        0544 01922000
         AL    @06,MINIMUM(,@07)                                   0544 01923000
         SLR   @01,@06                                             0544 01924000
         ST    @01,FREEAMT(,COMONPTR)                              0544 01925000
*       NEWOO=F0;                   /* INIT OFFSET TO ZERO           */ 01926000
         SLR   @14,@14                                             0545 01927000
         STH   @14,NEWOO(,@15)                                     0545 01928000
*     END;                          /*                               */ 01929000
*   END GETMORE;                                                   0547 01930000
@EL00005 DS    0H                                                  0547 01931000
@EF00005 DS    0H                                                  0547 01932000
@ER00005 LM    @14,@12,12(@13)                                     0547 01933000
         BR    @14                                                 0547 01934000
*                                                                  0548 01935000
*   /*****************************************************************/ 01936000
*   /*                                                               */ 01937000
*   /* REMOVE ONE CHARACTER FROM BUFFER                              */ 01938000
*   /*                                                               */ 01939000
*   /*****************************************************************/ 01940000
*                                                                  0548 01941000
*SQUASH:                                                           0548 01942000
*   PROC;                                                          0548 01943000
SQUASH   STM   @14,@12,12(@13)                                     0548 01944000
*   RFY                                                            0549 01945000
*    (R2,                                                          0549 01946000
*     R3,                                                          0549 01947000
*     R4,                                                          0549 01948000
*     R5) RSTD;                     /* RESTRICT REGISTERS            */ 01949000
*   R2=ADDR(C(I));                  /* ADDRESS OF 'TO'               */ 01950000
         L     @15,I(,COMONPTR)                                    0550 01951000
         L     @14,BUFBASE(,COMONPTR)                              0550 01952000
         LA    R2,C-1(@15,@14)                                     0550 01953000
*   R4=ADDR(C(I+F1));               /* ADDRESS OF 'FROM'             */ 01954000
         LA    R4,C(@15,@14)                                       0551 01955000
*   R3=LL-(I+F3);                   /* LENGTH OF 'TO'                */ 01956000
         AL    @15,@CF00054                                        0552 01957000
         LCR   @15,@15                                             0552 01958000
         AH    @15,LL(,@14)                                        0552 01959000
         LR    R3,@15                                              0552 01960000
*   R5=(R3-F1)|BLANKS;              /* LENGTH OF 'FROM' AND PADDING     01961000
*                                      CHARACTER FOR LONGER 'TO' AREA*/ 01962000
         LR    R5,R3                                               0553 01963000
         BCTR  R5,0                                                0553 01964000
         O     R5,@CF00622                                         0553 01965000
*   MVCL(R2,R4);                    /* SQUASH BUFFER                 */ 01966000
         MVCL  R2,R4                                               0554 01967000
*   RFY                                                            0555 01968000
*    (R2,                                                          0555 01969000
*     R3,                                                          0555 01970000
*     R4,                                                          0555 01971000
*     R5) UNRSTD;                   /* RELEASE REGISTERS             */ 01972000
*   FREEAMT=FREEAMT+F1;             /* ADD REMOVED BYTE TO FREEAMT   */ 01973000
         LA    @15,1                                               0556 01974000
         AL    @15,FREEAMT(,COMONPTR)                              0556 01975000
         ST    @15,FREEAMT(,COMONPTR)                              0556 01976000
*   END SQUASH;                                                    0557 01977000
@EL00006 DS    0H                                                  0557 01978000
@EF00006 DS    0H                                                  0557 01979000
@ER00006 LM    @14,@12,12(@13)                                     0557 01980000
         BR    @14                                                 0557 01981000
*                                                                  0558 01982000
*   /*****************************************************************/ 01983000
*   /*                                                               */ 01984000
*   /* RETURN POINTER UPDATE ROUTINE                                 */ 01985000
*   /*                                                               */ 01986000
*   /*****************************************************************/ 01987000
*                                                                  0558 01988000
*RETUPDT:                                                          0558 01989000
*   PROC(NEXTCMD);                                                 0558 01990000
RETUPDT  STM   @14,@12,12(@13)                                     0558 01991000
         MVC   @PC00007(4),0(@01)                                  0558 01992000
*   DCL                                                            0559 01993000
*     NEXTCMD FIXED(31);            /* THE NEXT COMMAND AFTER THE ONE   01994000
*                                      INTERRUPTED FROM              */ 01995000
*   RETPTR2=RETPTR;                 /* SWAP AND SAVE RETURN          */ 01996000
         L     @15,EXECDPTR(,COMONPTR)                             0560 01997000
         L     @14,RETPTR(,@15)                                    0560 01998000
         ST    @14,RETPTR2(,@15)                                   0560 01999000
*   RETPTR=NEXTCMD;                 /* SAVE ANSWER                   */ 02000000
         L     @14,@PC00007                                        0561 02001000
         L     @14,NEXTCMD(,@14)                                   0561 02002000
         ST    @14,RETPTR(,@15)                                    0561 02003000
*   END RETUPDT;                    /*                               */ 02004000
@EL00007 DS    0H                                                  0562 02005000
@EF00007 DS    0H                                                  0562 02006000
@ER00007 LM    @14,@12,12(@13)                                     0562 02007000
         BR    @14                                                 0562 02008000
*                                                                  0563 02009000
*   /*****************************************************************/ 02010000
*   /*                                                               */ 02011000
*   /* SUBSTRING FUNCTION                                            */ 02012000
*   /*                                                               */ 02013000
*   /*****************************************************************/ 02014000
*                                                                  0563 02015000
*SUBSTRTN:                                                         0563 02016000
*   PROC OPTIONS(SAVEAREA);                                        0563 02017000
SUBSTRTN STM   @14,@12,12(@13)                                     0563 02018000
         ST    @13,@SA00008+4                                      0563 02019000
         LA    @14,@SA00008                                        0563 02020000
         ST    @14,8(,@13)                                         0563 02021000
         LR    @13,@14                                             0563 02022000
*   CALL WAITRTN;                   /* CHECK IF '&' VARIABLE IN RNGE */ 02023000
         BAL   @14,WAITRTN                                         0564 02024000
*   IF WAIT=NO&ERROR=F0 THEN        /* IF OK TO PROCEED THEN         */ 02025000
         TM    WAIT(COMONPTR),B'00010000'                          0565 02026000
         BNZ   @RF00565                                            0565 02027000
         L     @15,ERROR                                           0565 02028000
         LTR   @15,@15                                             0565 02029000
         BNZ   @RF00565                                            0565 02030000
*     DO;                           /* GET RANGE TO PROCESS          */ 02031000
*       CSAVE=C(I-F1:I);            /* SAVE ORIGINAL BUFFER          */ 02032000
         L     @15,I(,COMONPTR)                                    0567 02033000
         L     @14,BUFBASE(,COMONPTR)                              0567 02034000
         ALR   @15,@14                                             0567 02035000
         MVC   CSAVE(2),C-2(@15)                                   0567 02036000
*       C(I-F1:I)=XEQUAL;           /* MAKE RANGE LOOK LINE SET STMT */ 02037000
         L     @15,I(,COMONPTR)                                    0568 02038000
         ALR   @15,@14                                             0568 02039000
         MVC   C-2(2,@15),@CC00632                                 0568 02040000
*       BUFPTR=ADDR(C(I-F1));       /* POINT TO DUMMY SET STATEMENT  */ 02041000
         L     @15,I(,COMONPTR)                                    0569 02042000
         LA    @15,C-2(@15,@14)                                    0569 02043000
         ST    @15,BUFPTR(,COMONPTR)                               0569 02044000
*       DO CLEN=F3 TO M-I+F1 WHILE BUF(CLEN)^=COLON&BUF(CLEN)^=COMMA;   02045000
         LA    @15,3                                               0570 02046000
         B     @DE00570                                            0570 02047000
@DL00570 LH    @15,CLEN(,COMONPTR)                                 0570 02048000
         L     @14,BUFPTR(,COMONPTR)                               0570 02049000
         ALR   @15,@14                                             0570 02050000
         BCTR  @15,0                                               0570 02051000
         CLI   BUF(@15),C':'                                       0570 02052000
         BE    @DC00570                                            0570 02053000
         LH    @15,CLEN(,COMONPTR)                                 0570 02054000
         ALR   @14,@15                                             0570 02055000
         BCTR  @14,0                                               0570 02056000
         CLI   BUF(@14),C','                                       0570 02057000
         BE    @DC00570                                            0570 02058000
*                                   /*                               */ 02059000
*       END;                        /* AND LENGTH OF DUMMY STMT      */ 02060000
         LA    @15,1                                               0571 02061000
         AH    @15,CLEN(,COMONPTR)                                 0571 02062000
@DE00570 STH   @15,CLEN(,COMONPTR)                                 0571 02063000
         L     @14,M                                               0571 02064000
         SL    @14,I(,COMONPTR)                                    0571 02065000
         AL    @14,@CF00042                                        0571 02066000
         CR    @15,@14                                             0571 02067000
         BNH   @DL00570                                            0571 02068000
@DC00570 DS    0H                                                  0572 02069000
*       IF BUF(CLEN)=':' THEN       /* IF COLON FOUND, THE SET RANGE */ 02070000
         LH    @01,CLEN(,COMONPTR)                                 0572 02071000
         L     @15,BUFPTR(,COMONPTR)                               0572 02072000
         ALR   @15,@01                                             0572 02073000
         BCTR  @15,0                                               0572 02074000
         CLI   BUF(@15),C':'                                       0572 02075000
         BNE   @RF00572                                            0572 02076000
*         RANGE=YES;                /* SWITCH                        */ 02077000
         OI    RANGE(COMONPTR),B'00001000'                         0573 02078000
*       ELSE                        /* CHECK FOR STRING DELIM        */ 02079000
*         IF BUF(CLEN)=COMMA THEN   /* IF IT IS                      */ 02080000
         B     @RC00572                                            0574 02081000
@RF00572 LH    @15,CLEN(,COMONPTR)                                 0574 02082000
         L     @14,BUFPTR(,COMONPTR)                               0574 02083000
         ALR   @15,@14                                             0574 02084000
         BCTR  @15,0                                               0574 02085000
         CLI   BUF(@15),C','                                       0574 02086000
         BNE   @RF00574                                            0574 02087000
*           DO;                     /* INIT INSERT START AND LENGTH  */ 02088000
*             INSRTDA=ADDR(BUF(CLEN+F1));/* BEGIN OF STRING          */ 02089000
         LH    @15,CLEN(,COMONPTR)                                 0576 02090000
         LA    @15,BUF(@15,@14)                                    0576 02091000
         ST    @15,INSRTDA                                         0576 02092000
*             INSRTLN=ADDR(C(M))-INSRTDA;/* LENGTH OF STRING         */ 02093000
         L     @01,BUFBASE(,COMONPTR)                              0577 02094000
         L     @14,M                                               0577 02095000
         LA    @14,C-1(@14,@01)                                    0577 02096000
         SLR   @14,@15                                             0577 02097000
         ST    @14,INSRTLN                                         0577 02098000
*             RANGE=NO;             /* RE-INIT RANGE SWITCH  @ZA24504*/ 02099000
         NI    RANGE(COMONPTR),B'11110111'                         0578 02100000
*           END;                    /*                               */ 02101000
*       IF ERROR=F0 THEN            /* IF OK UNTIL NOW               */ 02102000
@RF00574 DS    0H                                                  0580 02103000
@RC00572 SLR   @15,@15                                             0580 02104000
         C     @15,ERROR                                           0580 02105000
         BNE   @RF00580                                            0580 02106000
*         DO;                       /* THEN CONTINUE                 */ 02107000
*           CLEN=CLEN-F1;           /* DECREMENT CLEN FROM DO INCR   */ 02108000
         LH    @14,CLEN(,COMONPTR)                                 0582 02109000
         BCTR  @14,0                                               0582 02110000
         STH   @14,CLEN(,COMONPTR)                                 0582 02111000
*           TYPE=F0;                /* ALLOW ONLY NUMERIC STMT       */ 02112000
         ST    @15,TYPE(,COMONPTR)                                 0583 02113000
*           LEN1=CLEN;              /* SAVE LENGTH OF FIRST STMT     */ 02114000
         ST    @14,LEN1                                            0584 02115000
*           RFY                                                    0585 02116000
*            (R15) RSTD;            /* RESTRICT R15 FOR RETURNCD     */ 02117000
*           CALL IKJCT434(BUF,CLEN,TYPE,OUTA1);/* PROCESS EXPRESSOIN */ 02118000
         L     @14,BUFPTR(,COMONPTR)                               0586 02119000
         ST    @14,@AL00001                                        0586 02120000
         LA    @14,CLEN(,COMONPTR)                                 0586 02121000
         ST    @14,@AL00001+4                                      0586 02122000
         LA    @14,TYPE(,COMONPTR)                                 0586 02123000
         ST    @14,@AL00001+8                                      0586 02124000
         LA    @14,OUTA1                                           0586 02125000
         ST    @14,@AL00001+12                                     0586 02126000
         L     @15,@CV00098                                        0586 02127000
         LA    @01,@AL00001                                        0586 02128000
         BALR  @14,@15                                             0586 02129000
*           ERROR=R15;              /* SAVE ERROR CODE               */ 02130000
         ST    R15,ERROR                                           0587 02131000
*           C(I-F1:I)=CSAVE;        /* RESTORE ORIGINAL BUFFER       */ 02132000
         L     @14,I(,COMONPTR)                                    0588 02133000
         L     @01,BUFBASE(,COMONPTR)                              0588 02134000
         ALR   @01,@14                                             0588 02135000
         MVC   C-2(2,@01),CSAVE                                    0588 02136000
*           RFY                                                    0589 02137000
*            (R15) UNRSTD;          /* RELEASE R15                   */ 02138000
*                                                                  0590 02139000
*           /*********************************************************/ 02140000
*           /*                                                       */ 02141000
*           /* PROCESS SUBSTRING                                     */ 02142000
*           /*                                                       */ 02143000
*           /*********************************************************/ 02144000
*                                                                  0590 02145000
*           IF ERROR=F0 THEN        /* IF OK                         */ 02146000
         L     @15,ERROR                                           0590 02147000
         LTR   @15,@15                                             0590 02148000
         BNZ   @RF00590                                            0590 02149000
*             DO;                   /* CONVERT ANSWER TO USEABLE     */ 02150000
*               CALL CONVERT;       /* FORM                          */ 02151000
         BAL   @14,CONVERT                                         0592 02152000
*               V1=V2;              /* SET START OF RANGE            */ 02153000
         L     @15,V2                                              0593 02154000
         ST    @15,V1                                              0593 02155000
*               IF ERROR=F0&RANGE=YES THEN/* IF RANGE, THEN FIND   0594 02156000
*                                      VALUE 2                       */ 02157000
         L     @15,ERROR                                           0594 02158000
         LTR   @15,@15                                             0594 02159000
         BNZ   @RF00594                                            0594 02160000
         TM    RANGE(COMONPTR),B'00001000'                         0594 02161000
         BNO   @RF00594                                            0594 02162000
*                 DO;               /*                               */ 02163000
*                   BUFPTR=ADDR(BUF(LEN1));/* POINT TO DUMMY STMT  0596 02164000
*                                      NUMBER 2                      */ 02165000
         L     @01,BUFPTR(,COMONPTR)                               0596 02166000
         L     @15,LEN1                                            0596 02167000
         BCTR  @01,0                                               0596 02168000
         LA    @15,BUF(@15,@01)                                    0596 02169000
         ST    @15,BUFPTR(,COMONPTR)                               0596 02170000
*                   CSAVE=BUF(F1:F2);/* SAVE ORIGINAL BUFFER         */ 02171000
         MVC   CSAVE(2),BUF(@15)                                   0597 02172000
*                   BUF(F1:F2)=XEQUAL;/* CREATE DUMMY STMT           */ 02173000
         MVC   BUF(2,@15),@CC00632                                 0598 02174000
*                   DO CLEN=F3 TO M-(I+LEN1)+F2 WHILE BUF(CLEN)^=COMMA; 02175000
         LA    @15,3                                               0599 02176000
         B     @DE00599                                            0599 02177000
@DL00599 LH    @01,CLEN(,COMONPTR)                                 0599 02178000
         L     @15,BUFPTR(,COMONPTR)                               0599 02179000
         ALR   @15,@01                                             0599 02180000
         BCTR  @15,0                                               0599 02181000
         CLI   BUF(@15),C','                                       0599 02182000
         BE    @DC00599                                            0599 02183000
*                   END;                                           0600 02184000
         LA    @15,1                                               0600 02185000
         AH    @15,CLEN(,COMONPTR)                                 0600 02186000
@DE00599 STH   @15,CLEN(,COMONPTR)                                 0600 02187000
         L     @14,I(,COMONPTR)                                    0600 02188000
         AL    @14,LEN1                                            0600 02189000
         LCR   @14,@14                                             0600 02190000
         AL    @14,M                                               0600 02191000
         AL    @14,@CF00062                                        0600 02192000
         CR    @15,@14                                             0600 02193000
         BNH   @DL00599                                            0600 02194000
@DC00599 DS    0H                                                  0601 02195000
*                   INSRTDA=ADDR(BUF(CLEN+1));/* POINT TO INSERT DATA*/ 02196000
         LH    @15,CLEN(,COMONPTR)                                 0601 02197000
         L     @14,BUFPTR(,COMONPTR)                               0601 02198000
         LA    @07,BUF(@15,@14)                                    0601 02199000
         ST    @07,INSRTDA                                         0601 02200000
*                   INSRTLN=ADDR(C(M))-INSRTDA;/* GET LENGTH OF DATA */ 02201000
         L     @01,BUFBASE(,COMONPTR)                              0602 02202000
         L     @06,M                                               0602 02203000
         LA    @06,C-1(@06,@01)                                    0602 02204000
         SLR   @06,@07                                             0602 02205000
         ST    @06,INSRTLN                                         0602 02206000
*                   CLEN=CLEN-F1;   /* BACK PAST COMMA               */ 02207000
         BCTR  @15,0                                               0603 02208000
         STH   @15,CLEN(,COMONPTR)                                 0603 02209000
*                   TYPE=F0;        /* ALLOW ONLY NUMERIC            */ 02210000
         SLR   @15,@15                                             0604 02211000
         ST    @15,TYPE(,COMONPTR)                                 0604 02212000
*                   RFY                                            0605 02213000
*                    (R15) RSTD;    /* RESTRICT R15 FOR RETURN CODE  */ 02214000
*                   CALL IKJCT434(BUF,CLEN,TYPE,OUTA1);/* PROCESS  0606 02215000
*                                      NUMBER 2                      */ 02216000
         ST    @14,@AL00001                                        0606 02217000
         LA    @14,CLEN(,COMONPTR)                                 0606 02218000
         ST    @14,@AL00001+4                                      0606 02219000
         LA    @14,TYPE(,COMONPTR)                                 0606 02220000
         ST    @14,@AL00001+8                                      0606 02221000
         LA    @14,OUTA1                                           0606 02222000
         ST    @14,@AL00001+12                                     0606 02223000
         L     @15,@CV00098                                        0606 02224000
         LA    @01,@AL00001                                        0606 02225000
         BALR  @14,@15                                             0606 02226000
*                   ERROR=R15;      /* SAVE ERROR CODE               */ 02227000
         ST    R15,ERROR                                           0607 02228000
*                   BUF(F1:F2)=CSAVE;/* RESTORE OLD BUFFER           */ 02229000
         L     @14,BUFPTR(,COMONPTR)                               0608 02230000
         MVC   BUF(2,@14),CSAVE                                    0608 02231000
*                   RFY                                            0609 02232000
*                    (R15) UNRSTD;  /* RELEASE R15                   */ 02233000
*                   IF ERROR=F0 THEN/* IF OKAY                       */ 02234000
         L     @15,ERROR                                           0610 02235000
         LTR   @15,@15                                             0610 02236000
         BNZ   @RF00610                                            0610 02237000
*                     DO;           /* CHECK FOR VALID RANGE         */ 02238000
*                       CALL CONVERT;/* CONVERT NUMBER 2 TO USABLE   */ 02239000
         BAL   @14,CONVERT                                         0612 02240000
*                       IF ERROR=F0&V1>V2 THEN/* FORM AND CHECK RANGE*/ 02241000
         L     @15,ERROR                                           0613 02242000
         LTR   @15,@15                                             0613 02243000
         BNZ   @RF00613                                            0613 02244000
         L     @15,V1                                              0613 02245000
         C     @15,V2                                              0613 02246000
         BNH   @RF00613                                            0613 02247000
*                         ERROR=E912;/* SET ERROR CODE               */ 02248000
         MVC   ERROR(4),@CF00787                                   0614 02249000
*                     END;          /*                               */ 02250000
@RF00613 DS    0H                                                  0616 02251000
*                 END;                                             0616 02252000
@RF00610 DS    0H                                                  0617 02253000
*               IF ERROR=F0 THEN    /* IF EVERYTHING STILL OK        */ 02254000
@RF00594 SLR   @15,@15                                             0617 02255000
         C     @15,ERROR                                           0617 02256000
         BNE   @RF00617                                            0617 02257000
*                 IF V2>INSRTLN|V1=F0 THEN/* IF OUTSIDE RANGE, SET 0618 02258000
*                                      ERROR                         */ 02259000
         L     @14,V2                                              0618 02260000
         C     @14,INSRTLN                                         0618 02261000
         BH    @RT00618                                            0618 02262000
         C     @15,V1                                              0618 02263000
         BNE   @RF00618                                            0618 02264000
@RT00618 DS    0H                                                  0619 02265000
*                   ERROR=E932;     /* INDICATOR                     */ 02266000
         MVC   ERROR(4),@CF00797                                   0619 02267000
*                 ELSE              /*                               */ 02268000
*                   DO;             /* SET UP INSERT INFO            */ 02269000
         B     @RC00618                                            0620 02270000
@RF00618 DS    0H                                                  0621 02271000
*                     INSRTLN=V2-V1+F1;/* LENGTH OF INSERT DATA      */ 02272000
         LA    @15,1                                               0621 02273000
         L     @14,V1                                              0621 02274000
         L     @07,V2                                              0621 02275000
         SLR   @07,@14                                             0621 02276000
         ALR   @07,@15                                             0621 02277000
         ST    @07,INSRTLN                                         0621 02278000
*                     INSRTDA=INSRTDA+V1-F1;/* POINTER TO INSERT DATA*/ 02279000
         AL    @14,INSRTDA                                         0622 02280000
         BCTR  @14,0                                               0622 02281000
         ST    @14,INSRTDA                                         0622 02282000
*                     DO I=1 TO INSRTLN;/* NUMBER OF CHARS           */ 02283000
         B     @DE00623                                            0623 02284000
@DL00623 DS    0H                                                  0624 02285000
*                       TR(INSRTCHR(I),TRTABDN);/* FOLD TO SPCL CHRS */ 02286000
         L     @01,I(,COMONPTR)                                    0624 02287000
         L     @15,INSRTDA                                         0624 02288000
         ALR   @15,@01                                             0624 02289000
         BCTR  @15,0                                               0624 02290000
         TR    INSRTCHR(1,@15),TRTABDN                             0624 02291000
*                     END;          /*                               */ 02292000
         LA    @15,1                                               0625 02293000
         AL    @15,I(,COMONPTR)                                    0625 02294000
@DE00623 ST    @15,I(,COMONPTR)                                    0625 02295000
         C     @15,INSRTLN                                         0625 02296000
         BNH   @DL00623                                            0625 02297000
*                     I=M+F1;       /* POINT I TO RESUME DATA        */ 02298000
         LA    @15,1                                               0626 02299000
         AL    @15,M                                               0626 02300000
         ST    @15,I(,COMONPTR)                                    0626 02301000
*                   END;            /*                               */ 02302000
*             END;                  /*                               */ 02303000
*         END;                      /*                               */ 02304000
*     END;                          /*                               */ 02305000
*   END SUBSTRTN;                   /*                               */ 02306000
@EL00008 L     @13,4(,@13)                                         0631 02307000
@EF00008 DS    0H                                                  0631 02308000
@ER00008 LM    @14,@12,12(@13)                                     0631 02309000
         BR    @14                                                 0631 02310000
*                                                                  0632 02311000
*   /*****************************************************************/ 02312000
*   /*                                                               */ 02313000
*   /* WAIT ROUTINE                                                  */ 02314000
*   /*                                                               */ 02315000
*   /*****************************************************************/ 02316000
*                                                                  0632 02317000
*WAITRTN:                                                          0632 02318000
*   PROC;                                                          0632 02319000
WAITRTN  STM   @14,@12,12(@13)                                     0632 02320000
*   PCTR=F1;                        /* INIT PAREN COUNTER            */ 02321000
         MVC   PCTR(4),@CF00042                                    0633 02322000
*   SENTINAL=NO;                    /* CLEAR SWITCH                  */ 02323000
*   FOLD=YES;                       /* INDICATE POSSIBLE FOLD        */ 02324000
         OI    FOLD(COMONPTR),B'00010000'                          0635 02325000
         NI    SENTINAL(COMONPTR),B'01111111'                      0635 02326000
*   M=I;                            /* START OF PSTRING SCAN         */ 02327000
         L     @15,I(,COMONPTR)                                    0636 02328000
         ST    @15,M                                               0636 02329000
*   IF M>LL-(FREEAMT+F4)|(C(M)^=LPAREN&/* PAST BFR OR NO '('         */ 02330000
*       C(M)^=SENTNLL) THEN         /* OR LEFT SENTINAL              */ 02331000
         L     @14,BUFBASE(,COMONPTR)                              0637 02332000
         LA    @07,4                                               0637 02333000
         AL    @07,FREEAMT(,COMONPTR)                              0637 02334000
         LCR   @07,@07                                             0637 02335000
         AH    @07,LL(,@14)                                        0637 02336000
         CR    @15,@07                                             0637 02337000
         BH    @RT00637                                            0637 02338000
         ALR   @15,@14                                             0637 02339000
         CLI   C-1(@15),C'('                                       0637 02340000
         BE    @RF00637                                            0637 02341000
         L     @15,M                                               0637 02342000
         ALR   @14,@15                                             0637 02343000
         CLI   C-1(@14),X'01'                                      0637 02344000
         BE    @RF00637                                            0637 02345000
@RT00637 DS    0H                                                  0638 02346000
*     ERROR=E936;                   /* SET ERROR CODE                */ 02347000
         MVC   ERROR(4),@CF00799                                   0638 02348000
*   ELSE                            /* OTHERWISE                     */ 02349000
*     DO;                           /* FIND END OF BIF               */ 02350000
         B     @RC00637                                            0639 02351000
@RF00637 DS    0H                                                  0640 02352000
*       IF C(M)=SENTNLL THEN        /* IF SENTINAL PROCESSING        */ 02353000
         L     @01,BUFBASE(,COMONPTR)                              0640 02354000
         AL    @01,M                                               0640 02355000
         CLI   C-1(@01),X'01'                                      0640 02356000
         BNE   @RF00640                                            0640 02357000
*         SENTINAL=YES;             /* SETIN SWITCH                  */ 02358000
         OI    SENTINAL(COMONPTR),B'10000000'                      0641 02359000
*       ELSE                        /* OTHERWISE                     */ 02360000
*         C(M)=SENTNLL;             /* FLAG AS SENTINAL PROCESS      */ 02361000
         B     @RC00640                                            0642 02362000
@RF00640 L     @01,BUFBASE(,COMONPTR)                              0642 02363000
         AL    @01,M                                               0642 02364000
         MVI   C-1(@01),X'01'                                      0642 02365000
*       DO M=M+F1 TO LL-(F4+FREEAMT) WHILE PCTR>F0;/* FIND END OF BF */ 02366000
@RC00640 LA    @15,1                                               0643 02367000
         AL    @15,M                                               0643 02368000
         B     @DE00643                                            0643 02369000
@DL00643 L     @14,PCTR                                            0643 02370000
         LTR   @14,@14                                             0643 02371000
         BNP   @DC00643                                            0643 02372000
*         IF M<LL-(F4+FREEAMT)&C(M:M+F1)=DAMPSAND THEN/* NOT D AMP   */ 02373000
         L     @14,BUFBASE(,COMONPTR)                              0644 02374000
         LA    @07,4                                               0644 02375000
         AL    @07,FREEAMT(,COMONPTR)                              0644 02376000
         LCR   @07,@07                                             0644 02377000
         AH    @07,LL(,@14)                                        0644 02378000
         CR    @15,@07                                             0644 02379000
         BNL   @RF00644                                            0644 02380000
         ALR   @14,@15                                             0644 02381000
         CLC   C-1(2,@14),@CC00662                                 0644 02382000
         BNE   @RF00644                                            0644 02383000
*           M=M+F1;                 /* SKIP OVER                     */ 02384000
         AL    @15,@CF00042                                        0645 02385000
         ST    @15,M                                               0645 02386000
*         ELSE                      /* CHECK IF A SINGLE AMPERSAND   */ 02387000
*           IF C(M)=AMPSAND THEN    /* IF IT IS THEN                 */ 02388000
         B     @RC00644                                            0646 02389000
@RF00644 L     @01,BUFBASE(,COMONPTR)                              0646 02390000
         AL    @01,M                                               0646 02391000
         CLI   C-1(@01),C'&&'                                      0646 02392000
         BNE   @RF00646                                            0646 02393000
*             WAIT=YES;             /* SET WAIT SWITCH               */ 02394000
         OI    WAIT(COMONPTR),B'00010000'                          0647 02395000
*           ELSE                    /* OTHERWISE                     */ 02396000
*             IF C(M)=SENTNLR THEN  /* IF A SENTINAL                 */ 02397000
         B     @RC00646                                            0648 02398000
@RF00646 L     @15,M                                               0648 02399000
         L     @01,BUFBASE(,COMONPTR)                              0648 02400000
         ALR   @01,@15                                             0648 02401000
         CLI   C-1(@01),X'02'                                      0648 02402000
         BNE   @RF00648                                            0648 02403000
*               DO;                 /* CHECK IF SENTINAL MODE        */ 02404000
*                 PCTR=F0;          /* TERMINATE SCAN                */ 02405000
         SLR   @14,@14                                             0650 02406000
         ST    @14,PCTR                                            0650 02407000
*                 IF SENTINAL=NO THEN/* IF IN SENTINAL MODE          */ 02408000
         TM    SENTINAL(COMONPTR),B'10000000'                      0651 02409000
         BNZ   @RF00651                                            0651 02410000
*                   M=M-F1;         /* DONT COUNT SENTINAL           */ 02411000
         BCTR  @15,0                                               0652 02412000
         ST    @15,M                                               0652 02413000
*               END;                /* IF A CLOSE PAREN              */ 02414000
*             ELSE                  /* IF NOT SENTINAL               */ 02415000
*               IF SENTINAL=NO THEN /* IF IN SENTINAL MODE           */ 02416000
         B     @RC00648                                            0654 02417000
@RF00648 TM    SENTINAL(COMONPTR),B'10000000'                      0654 02418000
         BNZ   @RF00654                                            0654 02419000
*                 DO;               /* SKIP PAREN CHECK              */ 02420000
*                   IF C(M)=RPAREN THEN/* IF A CLOSE PAREN           */ 02421000
         L     @15,M                                               0656 02422000
         L     @14,BUFBASE(,COMONPTR)                              0656 02423000
         ALR   @15,@14                                             0656 02424000
         CLI   C-1(@15),C')'                                       0656 02425000
         BNE   @RF00656                                            0656 02426000
*                     DO;           /* DECREMENT COUNT               */ 02427000
*                       PCTR=PCTR-F1;/*                              */ 02428000
         L     @15,PCTR                                            0658 02429000
         BCTR  @15,0                                               0658 02430000
         ST    @15,PCTR                                            0658 02431000
*                       IF PCTR=F0 THEN/* IF PAREN COUNT IS ZERO     */ 02432000
         LTR   @15,@15                                             0659 02433000
         BNZ   @RF00659                                            0659 02434000
*                         C(M)=SENTNLR;/* PAREN TO SENTINAL          */ 02435000
         L     @15,M                                               0660 02436000
         ALR   @14,@15                                             0660 02437000
         MVI   C-1(@14),X'02'                                      0660 02438000
*                     END;          /*                               */ 02439000
*                   ELSE            /* OTHERWISE                     */ 02440000
*                     IF C(M)=LPAREN THEN/* IF AN OPEN PAREN         */ 02441000
         B     @RC00656                                            0662 02442000
@RF00656 L     @01,BUFBASE(,COMONPTR)                              0662 02443000
         AL    @01,M                                               0662 02444000
         CLI   C-1(@01),C'('                                       0662 02445000
         BNE   @RF00662                                            0662 02446000
*                       PCTR=PCTR+F1;/* INCREMENT THE PAREN COUNT    */ 02447000
         LA    @15,1                                               0663 02448000
         AL    @15,PCTR                                            0663 02449000
         ST    @15,PCTR                                            0663 02450000
*                 END;              /*                               */ 02451000
@RF00662 DS    0H                                                  0664 02452000
@RC00656 DS    0H                                                  0665 02453000
*       END;                        /*                               */ 02454000
@RF00654 DS    0H                                                  0665 02455000
@RC00648 DS    0H                                                  0665 02456000
@RC00646 DS    0H                                                  0665 02457000
@RC00644 LA    @15,1                                               0665 02458000
         AL    @15,M                                               0665 02459000
@DE00643 ST    @15,M                                               0665 02460000
         L     @14,BUFBASE(,COMONPTR)                              0665 02461000
         LA    @07,4                                               0665 02462000
         AL    @07,FREEAMT(,COMONPTR)                              0665 02463000
         LCR   @07,@07                                             0665 02464000
         AH    @07,LL(,@14)                                        0665 02465000
         CR    @15,@07                                             0665 02466000
         BNH   @DL00643                                            0665 02467000
@DC00643 DS    0H                                                  0666 02468000
*     END;                          /*                               */ 02469000
*   LEN=M-V;                        /* ADJUST LEN FOR WHOLE BIF      */ 02470000
@RC00637 L     @15,M                                               0667 02471000
         LR    @14,@15                                             0667 02472000
         SL    @14,V                                               0667 02473000
         ST    @14,LEN(,COMONPTR)                                  0667 02474000
*   IF PCTR=F0 THEN                 /* IF CLOSE PAREN FOUND          */ 02475000
         L     @14,PCTR                                            0668 02476000
         LTR   @14,@14                                             0668 02477000
         BNZ   @RF00668                                            0668 02478000
*     M=M-F1;                       /* DECREMENT M                   */ 02479000
         BCTR  @15,0                                               0669 02480000
         ST    @15,M                                               0669 02481000
*   END WAITRTN;                                                   0670 02482000
@EL00009 DS    0H                                                  0670 02483000
@EF00009 DS    0H                                                  0670 02484000
@ER00009 LM    @14,@12,12(@13)                                     0670 02485000
         BR    @14                                                 0670 02486000
*                                                                  0671 02487000
*   /*****************************************************************/ 02488000
*   /*                                                               */ 02489000
*   /* CONVERT ROUTINE                                               */ 02490000
*   /*                                                               */ 02491000
*   /*****************************************************************/ 02492000
*                                                                  0671 02493000
*CONVERT:                                                          0671 02494000
*   PROC;                                                          0671 02495000
CONVERT  STM   @14,@12,12(@13)                                     0671 02496000
*   DCL                                                            0672 02497000
*     NDX FIXED(31);                /* INDEX TO ANSWER               */ 02498000
*   AREA=ZEROS;                     /* PLACE ZEROS IN AREA           */ 02499000
         MVC   AREA(16),@CC00619                                   0673 02500000
*   IF ANSWER(F1)=MINUS THEN        /* IF ANSWER IS NEGATIVE         */ 02501000
         L     @01,ANSPTR(,COMONPTR)                               0674 02502000
         CLI   ANSWER(@01),C'-'                                    0674 02503000
         BNE   @RF00674                                            0674 02504000
*     ERCOM=E920;                   /* SET ERROR CODE                */ 02505000
         MVC   ERCOM(4,COMONPTR),@CF00791                          0675 02506000
*   ELSE                            /* OTHERWISE OK                  */ 02507000
*     DO;                           /* BUILD PACKAREA                */ 02508000
         B     @RC00674                                            0676 02509000
@RF00674 DS    0H                                                  0677 02510000
*       IF CLEN<F1|CLEN>F16 THEN    /* IF ANS NOT NUMERIC OR NULL    */ 02511000
         LH    @15,CLEN(,COMONPTR)                                 0677 02512000
         LTR   @15,@15                                             0677 02513000
         BNP   @RT00677                                            0677 02514000
         C     @15,@CF00104                                        0677 02515000
         BNH   @RF00677                                            0677 02516000
@RT00677 DS    0H                                                  0678 02517000
*         ERCOM=E924;               /* SET ERROR CODE                */ 02518000
         MVC   ERCOM(4,COMONPTR),@CF00793                          0678 02519000
*       ELSE                        /* IF OK THEN MOVE INTO AREA     */ 02520000
*         AREA(F17-CLEN:F16)=ANSWER(F1:CLEN);/* MOVE IN VARIABLE   0679 02521000
*                                      ANSWER                        */ 02522000
         B     @RC00677                                            0679 02523000
@RF00677 LA    @15,17                                              0679 02524000
         SH    @15,CLEN(,COMONPTR)                                 0679 02525000
         LA    @14,AREA-1(@15)                                     0679 02526000
         LCR   @15,@15                                             0679 02527000
         AL    @15,@CF00104                                        0679 02528000
         L     @01,ANSPTR(,COMONPTR)                               0679 02529000
         EX    @15,@SM01104                                        0679 02530000
*       DO NDX=F16 TO F1 BY-F1 WHILE ERCOM=F0;/* CHECK FOR ALPHA   0680 02531000
*                                      ANSWER                        */ 02532000
@RC00677 LA    @15,16                                              0680 02533000
         ST    @15,NDX                                             0680 02534000
@DL00680 L     @14,ERCOM(,COMONPTR)                                0680 02535000
         LTR   @14,@14                                             0680 02536000
         BNZ   @DC00680                                            0680 02537000
*         IF AREA(NDX)<CC0|AREA(NDX)>CC9 THEN/*                      */ 02538000
         LA    @14,AREA-1(@15)                                     0681 02539000
         CLI   0(@14),C'0'                                         0681 02540000
         BL    @RT00681                                            0681 02541000
         LA    @14,AREA-1(@15)                                     0681 02542000
         CLI   0(@14),C'9'                                         0681 02543000
         BNH   @RF00681                                            0681 02544000
@RT00681 DS    0H                                                  0682 02545000
*           ERCOM=E916;             /* SET ERROR CODE                */ 02546000
         MVC   ERCOM(4,COMONPTR),@CF00789                          0682 02547000
*       END;                                                       0683 02548000
@RF00681 SLR   @15,@15                                             0683 02549000
         BCTR  @15,0                                               0683 02550000
         AL    @15,NDX                                             0683 02551000
         ST    @15,NDX                                             0683 02552000
         LTR   @15,@15                                             0683 02553000
         BP    @DL00680                                            0683 02554000
@DC00680 DS    0H                                                  0684 02555000
*       IF ERCOM=F0 THEN            /* IF NO ERROR SO FAR            */ 02556000
         L     @15,ERCOM(,COMONPTR)                                0684 02557000
         LTR   @15,@15                                             0684 02558000
         BNZ   @RF00684                                            0684 02559000
*         DO;                       /* PACK INTO USABLE FORM         */ 02560000
*           PACK(WORKAREA,AREA);    /* ISSUE PACK                    */ 02561000
         PACK  WORKAREA(8),AREA(16)                                0686 02562000
*           CVB(V2,WORKAREA);       /* ISSUE CONVERT TO BINARY       */ 02563000
         CVB   @15,WORKAREA                                        0687 02564000
         ST    @15,V2                                              0687 02565000
*           CNVTANS=V2;             /* PLACE IN COMMON AREA          */ 02566000
         ST    @15,CNVTANS(,COMONPTR)                              0688 02567000
*         END;                      /*                               */ 02568000
*     END;                                                         0690 02569000
@RF00684 DS    0H                                                  0691 02570000
*   ERROR=ERCOM;                    /* SAVE ERROR FIR INT USE        */ 02571000
@RC00674 L     @15,ERCOM(,COMONPTR)                                0691 02572000
         ST    @15,ERROR                                           0691 02573000
*   END CONVERT;                                                   0692 02574000
@EL00010 DS    0H                                                  0692 02575000
@EF00010 DS    0H                                                  0692 02576000
@ER00010 LM    @14,@12,12(@13)                                     0692 02577000
         BR    @14                                                 0692 02578000
*                                                                  0693 02579000
*   /*****************************************************************/ 02580000
*   /*                                                               */ 02581000
*   /* IMMEDIATE VALUE NEEDED                                        */ 02582000
*   /*                                                               */ 02583000
*   /*****************************************************************/ 02584000
*                                                                  0693 02585000
*IMVALRTN:                                                         0693 02586000
*   PROC;                                                          0693 02587000
IMVALRTN STM   @14,@12,@SA00011                                    0693 02588000
*   INDEX=F0;                       /* INIT INDEX                    */ 02589000
         SLR   @15,@15                                             0694 02590000
         ST    @15,INDEX                                           0694 02591000
*   DO N=1 TO DIM(IMMDATA) WHILE INDEX=F0;/* FIND BUILT IN FUNCTION  */ 02592000
         LA    @15,1                                               0695 02593000
         ST    @15,N                                               0695 02594000
@DL00695 L     @14,INDEX                                           0695 02595000
         LTR   @14,@14                                             0695 02596000
         BNZ   @DC00695                                            0695 02597000
*     IF IMMLEN(N)=SNTLNG&          /* SAME LENGTH                   */ 02598000
*         IMMDATA(N,1:SNTLNG)=C(V+F1:V+SNTLNG) THEN/* SAME TEXT      */ 02599000
         LR    @14,@15                                             0696 02600000
         SLA   @14,4                                               0696 02601000
         L     @01,SNTELPTR(,COMONPTR)                             0696 02602000
         LH    @07,SNTLNG(,@01)                                    0696 02603000
         CH    @07,IMMLEN-16(@14)                                  0696 02604000
         BNE   @RF00696                                            0696 02605000
         L     @01,BUFBASE(,COMONPTR)                              0696 02606000
         BCTR  @07,0                                               0696 02607000
         LA    @06,IMMDATA-16(@14)                                 0696 02608000
         AL    @01,V                                               0696 02609000
         EX    @07,@SC01106                                        0696 02610000
         BNE   @RF00696                                            0696 02611000
*       INDEX=N;                    /* SET INDEX TO ROUTINE          */ 02612000
         ST    @15,INDEX                                           0697 02613000
*   END;                                                           0698 02614000
@RF00696 LA    @15,1                                               0698 02615000
         AL    @15,N                                               0698 02616000
         ST    @15,N                                               0698 02617000
         C     @15,@CF00174                                        0698 02618000
         BNH   @DL00695                                            0698 02619000
@DC00695 DS    0H                                                  0699 02620000
*   IF INDEX=F0 THEN                /* IF NO MATCH                   */ 02621000
         L     @15,INDEX                                           0699 02622000
         LTR   @15,@15                                             0699 02623000
         BNZ   @RF00699                                            0699 02624000
*     ERROR=E999;                   /* SET ERROR CODE                */ 02625000
         MVC   ERROR(4),@CF00817                                   0700 02626000
*   ELSE                            /* CHECK FOR &STR                */ 02627000
*     CALL ROUTINE;                 /* PROCESS IMVAL                 */ 02628000
         B     @RC00699                                            0701 02629000
@RF00699 L     @14,INDEX                                           0701 02630000
         SLA   @14,4                                               0701 02631000
         L     @15,VECTOR-16(@14)                                  0701 02632000
         BALR  @14,@15                                             0701 02633000
*   END;                                                           0702 02634000
@EL00011 DS    0H                                                  0702 02635000
@EF00011 DS    0H                                                  0702 02636000
@ER00011 LM    @14,@12,@SA00011                                    0702 02637000
         BR    @14                                                 0702 02638000
*                                                                  0703 02639000
*   /*****************************************************************/ 02640000
*   /*                                                               */ 02641000
*   /* TIME BUILT IN FUNCTION                                        */ 02642000
*   /*                                                               */ 02643000
*   /*****************************************************************/ 02644000
*                                                                  0703 02645000
*TIMERTN:                                                          0703 02646000
*   PROC;                                                          0703 02647000
TIMERTN  STM   @14,@12,@SA00012                                    0703 02648000
*   RFY                                                            0704 02649000
*    (R0) RSTD;                     /* RESTRICT TIME REGISTER        */ 02650000
*   GEN SETS(R0)(TIME DEC);         /* ISSUE TIME MACRO              */ 02651000
         TIME DEC                                                       02652000
*   TEMPA=R0;                       /* SAVE TIME OF DAY              */ 02653000
         ST    R0,TEMPA                                            0706 02654000
*   RFY                                                            0707 02655000
*    (R0) UNRSTD;                   /* RELEASE REGISTER              */ 02656000
*   UNPK(TIMEOUT,TEMPA);            /* UNPACK TIME                   */ 02657000
         UNPK  TIMEOUT(7),TEMPA(4)                                 0708 02658000
*   OUT1=HRS;                       /* HOURS                         */ 02659000
         MVC   OUT1(2),HRS                                         0709 02660000
*   OUT2=MINUTES;                   /* MINUTES                       */ 02661000
         MVC   OUT2(2),MINUTES                                     0710 02662000
*   OUT3=SEC;                       /* SECONDS                       */ 02663000
         MVC   OUT3(2),SEC                                         0711 02664000
*   DELIM1=COLON;                   /* SEPARATE TIME ELEMENTS WITH   */ 02665000
         MVI   DELIM1,C':'                                         0712 02666000
*   DELIM2=COLON;                   /* A COLON                       */ 02667000
         MVI   DELIM2,C':'                                         0713 02668000
*   INSRTDA=ADDR(TIMEDATE);         /* POINT TO INSERT DATA          */ 02669000
         LA    @15,TIMEDATE                                        0714 02670000
         ST    @15,INSRTDA                                         0714 02671000
*   INSRTLN=LENGTH(TIMEDATE);       /* SET LENGTH OF INSERT DATA     */ 02672000
         MVC   INSRTLN(4),@CF00094                                 0715 02673000
*   END TIMERTN;                                                   0716 02674000
@EL00012 DS    0H                                                  0716 02675000
@EF00012 DS    0H                                                  0716 02676000
@ER00012 LM    @14,@12,@SA00012                                    0716 02677000
         BR    @14                                                 0716 02678000
*                                                                  0717 02679000
*   /*****************************************************************/ 02680000
*   /*                                                               */ 02681000
*   /* DATE BUILT IN FUNCTION                                        */ 02682000
*   /*                                                               */ 02683000
*   /*****************************************************************/ 02684000
*                                                                  0717 02685000
*DATERTN:                                                          0717 02686000
*   PROC;                                                          0717 02687000
DATERTN  STM   @14,@12,@SA00013                                    0717 02688000
*   RFY                                                            0718 02689000
*    (R1) RSTD;                     /* RESTRICT DATE REG             */ 02690000
*   GEN SETS(R1)(TIME DEC);         /* ISSUE TIME MACRO              */ 02691000
         TIME DEC                                                       02692000
*   TEMPA=R1;                       /* SAVE DATE                     */ 02693000
         ST    R1,TEMPA                                            0720 02694000
*   RFY                                                            0721 02695000
*    (R1) UNRSTD;                   /* RELEASE DATE REGISTER         */ 02696000
*   UNPK(DATEOUT,TEMPA);            /* UNPACK DATE                   */ 02697000
         UNPK  DATEOUT(5),TEMPA(4)                                 0722 02698000
*   PACK(WORKAREA,YR);              /* CONVERT YEAR TO USEABLE FORM  */ 02699000
         PACK  WORKAREA(8),YR(2)                                   0723 02700000
*   CVB(YEAR,WORKAREA);             /*                               */ 02701000
         CVB   @15,WORKAREA                                        0724 02702000
         ST    @15,YEAR                                            0724 02703000
*   PACK(WORKAREA,DYS);             /* CONVERT DAYS TO USEABLE FORM  */ 02704000
         PACK  WORKAREA(8),DYS(3)                                  0725 02705000
*   CVB(DAYS,WORKAREA);             /*                               */ 02706000
         CVB   @14,WORKAREA                                        0726 02707000
         ST    @14,DAYS                                            0726 02708000
*   IF YEAR//F4=F0 THEN             /* IF A LEAP YEAR, SET LEAP      */ 02709000
         LR    @00,@15                                             0727 02710000
         SRDA  @00,32                                              0727 02711000
         D     @00,@CF00107                                        0727 02712000
         LTR   @00,@00                                             0727 02713000
         BNZ   @RF00727                                            0727 02714000
*     LEAP=YES;                     /* YEAR SWITCH                   */ 02715000
         OI    LEAP(COMONPTR),B'00000100'                          0728 02716000
*   ELSE                            /* IF NOT, TURN IT OFF           */ 02717000
*     LEAP=NO;                      /*                               */ 02718000
         B     @RC00727                                            0729 02719000
@RF00727 NI    LEAP(COMONPTR),B'11111011'                          0729 02720000
*   DO MONTH=1 TO DIM(DAYIN) WHILE DAYS>F0;/* SUBTRACT DAYS OF EACH     02721000
*                                      MONTH                         */ 02722000
@RC00727 LA    @15,1                                               0730 02723000
         ST    @15,MONTH                                           0730 02724000
@DL00730 L     @14,DAYS                                            0730 02725000
         LTR   @14,@14                                             0730 02726000
         BNP   @DC00730                                            0730 02727000
*     DAYS=DAYS-DAYIN(MONTH);       /* UNTIL DAYS GOES NEGATIVE      */ 02728000
         LR    @07,@15                                             0731 02729000
         ALR   @07,@07                                             0731 02730000
         SH    @14,DAYIN-2(@07)                                    0731 02731000
         ST    @14,DAYS                                            0731 02732000
*     IF MONTH=2&LEAP=YES THEN      /* IF LEAP YEAR, ADJUST FOR      */ 02733000
         C     @15,@CF00062                                        0732 02734000
         BNE   @RF00732                                            0732 02735000
         TM    LEAP(COMONPTR),B'00000100'                          0732 02736000
         BNO   @RF00732                                            0732 02737000
*       DAYS=DAYS-F1;               /* EXTRA DAY IN FEBRUARY         */ 02738000
         BCTR  @14,0                                               0733 02739000
         ST    @14,DAYS                                            0733 02740000
*   END;                            /*                               */ 02741000
@RF00732 LA    @15,1                                               0734 02742000
         AL    @15,MONTH                                           0734 02743000
         ST    @15,MONTH                                           0734 02744000
         C     @15,@CF00216                                        0734 02745000
         BNH   @DL00730                                            0734 02746000
@DC00730 DS    0H                                                  0735 02747000
*   MONTH=MONTH-F1;                 /* ADJUST MONTH                  */ 02748000
         L     @15,MONTH                                           0735 02749000
         BCTR  @15,0                                               0735 02750000
         ST    @15,MONTH                                           0735 02751000
*   DAYS=DAYS+DAYIN(MONTH);         /* ADD BACK DAYS                 */ 02752000
         LR    @14,@15                                             0736 02753000
         ALR   @14,@14                                             0736 02754000
         LH    @14,DAYIN-2(@14)                                    0736 02755000
         AL    @14,DAYS                                            0736 02756000
         ST    @14,DAYS                                            0736 02757000
*   IF LEAP=YES&MONTH=FEBRUARY THEN /* IF LEAP YEAR, READJUST DAYS   */ 02758000
         TM    LEAP(COMONPTR),B'00000100'                          0737 02759000
         BNO   @RF00737                                            0737 02760000
         C     @15,@CF00062                                        0737 02761000
         BNE   @RF00737                                            0737 02762000
*     DAYS=DAYS+F1;                 /*                               */ 02763000
         AL    @14,@CF00042                                        0738 02764000
         ST    @14,DAYS                                            0738 02765000
*   CVD(MONTH,WORKAREA);            /* CONVERT MONTH AND DAY TO      */ 02766000
@RF00737 L     @15,MONTH                                           0739 02767000
         CVD   @15,WORKAREA                                        0739 02768000
*   UNPK(OUT1,WORKAREA);            /* PRINTABLE FORM                */ 02769000
         UNPK  OUT1(2),WORKAREA(8)                                 0740 02770000
*   OUT1(2)=OUT1(2)|CC0;            /* INSURE PRINTABLE CHAR         */ 02771000
         OI    OUT1+1,C'0'                                         0741 02772000
*   CVD(DAYS,WORKAREA);             /* DITTO FOR DAYS                */ 02773000
         L     @15,DAYS                                            0742 02774000
         CVD   @15,WORKAREA                                        0742 02775000
*   UNPK(OUT2,WORKAREA);            /*                               */ 02776000
         UNPK  OUT2(2),WORKAREA(8)                                 0743 02777000
*   OUT2(2)=OUT2(2)|CC0;            /*                               */ 02778000
         OI    OUT2+1,C'0'                                         0744 02779000
*   OUT3=YR;                        /* GET YEAR                      */ 02780000
         MVC   OUT3(2),YR                                          0745 02781000
*   DELIM1=SLASH;                   /* SET DATE DELIMITERS TO SLASH  */ 02782000
         MVI   DELIM1,C'/'                                         0746 02783000
*   DELIM2=SLASH;                   /*                               */ 02784000
         MVI   DELIM2,C'/'                                         0747 02785000
*   INSRTDA=ADDR(TIMEDATE);         /* POINT TO INSERT DATA          */ 02786000
         LA    @15,TIMEDATE                                        0748 02787000
         ST    @15,INSRTDA                                         0748 02788000
*   INSRTLN=LENGTH(TIMEDATE);       /* SET INSERT DATA LENGTH        */ 02789000
         MVC   INSRTLN(4),@CF00094                                 0749 02790000
*   END DATERTN;                                                   0750 02791000
@EL00013 DS    0H                                                  0750 02792000
@EF00013 DS    0H                                                  0750 02793000
@ER00013 LM    @14,@12,@SA00013                                    0750 02794000
         BR    @14                                                 0750 02795000
*                                                                  0751 02796000
*   /*****************************************************************/ 02797000
*   /*                                                               */ 02798000
*   /* LENGTH BUILT IN FUNCTION                                      */ 02799000
*   /*                                                               */ 02800000
*   /*****************************************************************/ 02801000
*                                                                  0751 02802000
*LENGRTN:                                                          0751 02803000
*   PROC;                                                          0751 02804000
LENGRTN  STM   @14,@12,@SA00014                                    0751 02805000
*   CALL SETUP;                     /* CHECK IF TO WAIT AND CALL     */ 02806000
         BAL   @14,SETUP                                           0752 02807000
*   IF ERROR=F0&WAIT=NO THEN        /* EVALUATE P-STRING             */ 02808000
         L     @15,ERROR                                           0753 02809000
         LTR   @15,@15                                             0753 02810000
         BNZ   @RF00753                                            0753 02811000
         TM    WAIT(COMONPTR),B'00010000'                          0753 02812000
         BNZ   @RF00753                                            0753 02813000
*     DO;                           /*                               */ 02814000
*       CVD(CLEN,WORKAREA);         /* GET LENGTH IN PRINTABLE       */ 02815000
         LH    @15,CLEN(,COMONPTR)                                 0755 02816000
         CVD   @15,WORKAREA                                        0755 02817000
*       UNPK(AREA,WORKAREA);        /* FORM FOR TABLE                */ 02818000
         UNPK  AREA(16),WORKAREA(8)                                0756 02819000
*       AREA(16)=AREA(16)|CC0;      /* INSURE NO SIGN                */ 02820000
         OI    AREA+15,C'0'                                        0757 02821000
*       DO I=F16 TO F2 BY-F1 WHILE AREA(1)=CC0;/* LEFT JUSTIFY       */ 02822000
         LA    @15,16                                              0758 02823000
         ST    @15,I(,COMONPTR)                                    0758 02824000
@DL00758 CLI   AREA,C'0'                                           0758 02825000
         BNE   @DC00758                                            0758 02826000
*         AREA(1:F15)=AREA(2:F16);  /* SHIFT BUFFER TO LEFT          */ 02827000
         MVC   @TS00001(15),AREA+1                                 0759 02828000
         MVC   AREA(15),@TS00001                                   0759 02829000
*       END;                        /*                               */ 02830000
         SLR   @15,@15                                             0760 02831000
         BCTR  @15,0                                               0760 02832000
         AL    @15,I(,COMONPTR)                                    0760 02833000
         ST    @15,I(,COMONPTR)                                    0760 02834000
         C     @15,@CF00062                                        0760 02835000
         BNL   @DL00758                                            0760 02836000
@DC00758 DS    0H                                                  0761 02837000
*       INSRTDA=ADDR(AREA);         /* POINT TO INSERT LENGTH        */ 02838000
         LA    @15,AREA                                            0761 02839000
         ST    @15,INSRTDA                                         0761 02840000
*       INSRTLN=I;                  /* GET LENGTH OF LENGTH          */ 02841000
         L     @15,I(,COMONPTR)                                    0762 02842000
         ST    @15,INSRTLN                                         0762 02843000
*       I=M+F1;                     /* POINT TO RESUME DATA          */ 02844000
         LA    @15,1                                               0763 02845000
         AL    @15,M                                               0763 02846000
         ST    @15,I(,COMONPTR)                                    0763 02847000
*     END;                          /*                               */ 02848000
*   END LENGRTN;                                                   0765 02849000
@EL00014 DS    0H                                                  0765 02850000
@EF00014 DS    0H                                                  0765 02851000
@ER00014 LM    @14,@12,@SA00014                                    0765 02852000
         BR    @14                                                 0765 02853000
*                                                                  0766 02854000
*   /*****************************************************************/ 02855000
*   /*                                                               */ 02856000
*   /* EVAL BUILT IN FUNCTION                                        */ 02857000
*   /*                                                               */ 02858000
*   /*****************************************************************/ 02859000
*                                                                  0766 02860000
*EVALRTN:                                                          0766 02861000
*   PROC;                                                          0766 02862000
EVALRTN  STM   @14,@12,@SA00015                                    0766 02863000
*   CALL SETUP;                     /* CHECK IF TO WAIT AND PSTR     */ 02864000
         BAL   @14,SETUP                                           0767 02865000
*   IF ERROR=F0&WAIT=NO THEN        /* OK TO PROCESS                 */ 02866000
         L     @15,ERROR                                           0768 02867000
         LTR   @15,@15                                             0768 02868000
         BNZ   @RF00768                                            0768 02869000
         TM    WAIT(COMONPTR),B'00010000'                          0768 02870000
         BNZ   @RF00768                                            0768 02871000
*     DO;                           /*                               */ 02872000
*       INSRTDA=ADDR(ANSWER);       /* ANSWER OF EVALUATION          */ 02873000
         L     @15,ANSPTR(,COMONPTR)                               0770 02874000
         ST    @15,INSRTDA                                         0770 02875000
*       INSRTLN=CLEN;               /* LENGTH OF ANSWER              */ 02876000
         LH    @15,CLEN(,COMONPTR)                                 0771 02877000
         ST    @15,INSRTLN                                         0771 02878000
*       I=M+F1;                     /* POINT TO RESUME DATA          */ 02879000
         LA    @15,1                                               0772 02880000
         AL    @15,M                                               0772 02881000
         ST    @15,I(,COMONPTR)                                    0772 02882000
*     END;                          /*                               */ 02883000
*   END EVALRTN;                    /* END OF EVAL BIF               */ 02884000
@EL00015 DS    0H                                                  0774 02885000
@EF00015 DS    0H                                                  0774 02886000
@ER00015 LM    @14,@12,@SA00015                                    0774 02887000
         BR    @14                                                 0774 02888000
*                                                                  0775 02889000
*   /*****************************************************************/ 02890000
*   /*                                                               */ 02891000
*   /* DATATYPE ROUTINE                                              */ 02892000
*   /*                                                               */ 02893000
*   /*****************************************************************/ 02894000
*                                                                  0775 02895000
*DATYRTN:                                                          0775 02896000
*   PROC;                                                          0775 02897000
DATYRTN  STM   @14,@12,@SA00016                                    0775 02898000
*   ALPHA=NO;                       /* RESET ALPHA SWITCH            */ 02899000
         NI    ALPHA(COMONPTR),B'11111101'                         0776 02900000
*   CALL SETUP;                     /* CHECK TO SEE IF TO WAIT AND   */ 02901000
         BAL   @14,SETUP                                           0777 02902000
*   IF ERROR=F0&WAIT=NO THEN        /* EVALUATE STRING               */ 02903000
         L     @15,ERROR                                           0778 02904000
         LTR   @15,@15                                             0778 02905000
         BNZ   @RF00778                                            0778 02906000
         TM    WAIT(COMONPTR),B'00010000'                          0778 02907000
         BNZ   @RF00778                                            0778 02908000
*     DO;                           /*                               */ 02909000
*       DO I=CLEN TO F1 BY-F1 WHILE ALPHA=NO;/* CHECK IF ANY ALPHA   */ 02910000
         LH    @15,CLEN(,COMONPTR)                                 0780 02911000
         ST    @15,I(,COMONPTR)                                    0780 02912000
         B     @DE00780                                            0780 02913000
@DL00780 TM    ALPHA(COMONPTR),B'00000010'                         0780 02914000
         BNZ   @DC00780                                            0780 02915000
*         IF ANSWER(I)<CC0|ANSWER(I)>CC9 THEN/* IF AN ALPHA CHAR     */ 02916000
         L     @15,I(,COMONPTR)                                    0781 02917000
         L     @14,ANSPTR(,COMONPTR)                               0781 02918000
         ALR   @15,@14                                             0781 02919000
         BCTR  @15,0                                               0781 02920000
         CLI   ANSWER(@15),C'0'                                    0781 02921000
         BL    @RT00781                                            0781 02922000
         L     @15,I(,COMONPTR)                                    0781 02923000
         ALR   @14,@15                                             0781 02924000
         BCTR  @14,0                                               0781 02925000
         CLI   ANSWER(@14),C'9'                                    0781 02926000
         BNH   @RF00781                                            0781 02927000
@RT00781 DS    0H                                                  0782 02928000
*           IF I^=F1|ANSWER(I)^=MINUS THEN/* IF NOT NEGATIVE         */ 02929000
         L     @15,I(,COMONPTR)                                    0782 02930000
         C     @15,@CF00042                                        0782 02931000
         BNE   @RT00782                                            0782 02932000
         L     @01,ANSPTR(,COMONPTR)                               0782 02933000
         ALR   @01,@15                                             0782 02934000
         BCTR  @01,0                                               0782 02935000
         CLI   ANSWER(@01),C'-'                                    0782 02936000
         BE    @RF00782                                            0782 02937000
@RT00782 DS    0H                                                  0783 02938000
*             ALPHA=YES;            /* SET ALPHA SWITCH              */ 02939000
         OI    ALPHA(COMONPTR),B'00000010'                         0783 02940000
*       END;                        /*                               */ 02941000
@RF00782 DS    0H                                                  0784 02942000
@RF00781 SLR   @15,@15                                             0784 02943000
         BCTR  @15,0                                               0784 02944000
         AL    @15,I(,COMONPTR)                                    0784 02945000
         ST    @15,I(,COMONPTR)                                    0784 02946000
@DE00780 LTR   @15,@15                                             0784 02947000
         BP    @DL00780                                            0784 02948000
@DC00780 DS    0H                                                  0785 02949000
*       IF ALPHA=YES|CLEN=F0 THEN   /* IF DATATYPE IS ALPHA THEN     */ 02950000
         TM    ALPHA(COMONPTR),B'00000010'                         0785 02951000
         BO    @RT00785                                            0785 02952000
         LH    @15,CLEN(,COMONPTR)                                 0785 02953000
         LTR   @15,@15                                             0785 02954000
         BNZ   @RF00785                                            0785 02955000
@RT00785 DS    0H                                                  0786 02956000
*         DO;                       /* POINT TO 'CHAR' AND ITS LENGTH*/ 02957000
*           INSRTDA=ADDR(CHR);      /*                               */ 02958000
         LA    @15,CHR                                             0787 02959000
         ST    @15,INSRTDA                                         0787 02960000
*           INSRTLN=LENGTH(CHR);    /*                               */ 02961000
         MVC   INSRTLN(4),@CF00107                                 0788 02962000
*         END;                      /*                               */ 02963000
*       ELSE                        /* IF NOT ALPHA, POINT INSERT    */ 02964000
*         DO;                       /* TO 'NUM' AND ITS LENGTH       */ 02965000
         B     @RC00785                                            0790 02966000
@RF00785 DS    0H                                                  0791 02967000
*           INSRTDA=ADDR(NUM);      /*                               */ 02968000
         LA    @15,NUM                                             0791 02969000
         ST    @15,INSRTDA                                         0791 02970000
*           INSRTLN=LENGTH(NUM);    /*                               */ 02971000
         MVC   INSRTLN(4),@CF00054                                 0792 02972000
*         END;                      /*                               */ 02973000
*       I=M+F1;                     /* POINT TO RESUME DATA          */ 02974000
@RC00785 LA    @15,1                                               0794 02975000
         AL    @15,M                                               0794 02976000
         ST    @15,I(,COMONPTR)                                    0794 02977000
*     END;                          /*                               */ 02978000
*   END DATYRTN;                                                   0796 02979000
@EL00016 DS    0H                                                  0796 02980000
@EF00016 DS    0H                                                  0796 02981000
@ER00016 LM    @14,@12,@SA00016                                    0796 02982000
         BR    @14                                                 0796 02983000
*                                                                  0797 02984000
*   /*****************************************************************/ 02985000
*   /*                                                               */ 02986000
*   /* USERID PREFIX ROUTINE                                         */ 02987000
*   /*                                                               */ 02988000
*   /*****************************************************************/ 02989000
*                                                                  0797 02990000
*PREFRTN:                                                          0797 02991000
*   PROC;                                                          0797 02992000
PREFRTN  STM   @14,@12,12(@13)                                     0797 02993000
*   INSRTDA=ADDR(UPTPREFX);         /* POINT TO PREFIX               */ 02994000
         L     @15,@PC00001                                        0798 02995000
         LA    @14,UPTPREFX(,@15)                                  0798 02996000
         ST    @14,INSRTDA                                         0798 02997000
*   INSRTLN=UPTPREFL;               /* GET PREFIX LENGTH             */ 02998000
         SLR   @14,@14                                             0799 02999000
         IC    @14,UPTPREFL(,@15)                                  0799 03000000
         ST    @14,INSRTLN                                         0799 03001000
*   END PREFRTN;                                                   0800 03002000
@EL00017 DS    0H                                                  0800 03003000
@EF00017 DS    0H                                                  0800 03004000
@ER00017 LM    @14,@12,12(@13)                                     0800 03005000
         BR    @14                                                 0800 03006000
*                                                                  0801 03007000
*   /*****************************************************************/ 03008000
*   /*                                                               */ 03009000
*   /* SYSPCMD ROUTINE GET SYSTEM PRIMARY COMMAND NAME               */ 03010000
*   /*                                                               */ 03011000
*   /*****************************************************************/ 03012000
*                                                                  0801 03013000
*SYSPRTN:                                                          0801 03014000
*   PROC;                                                          0801 03015000
SYSPRTN  STM   @14,@12,12(@13)                                     0801 03016000
*   INSRTDA=ADDR(ECTPCMD);          /* POINT TO PRIMARY NAME         */ 03017000
         L     @15,@PC00001+4                                      0802 03018000
         LA    @15,ECTPCMD(,@15)                                   0802 03019000
         ST    @15,INSRTDA                                         0802 03020000
*   DO INSRTLN=F8 TO F2 BY-F1 WHILE INSRTCHR(INSRTLN)=BLANK;       0803 03021000
         LA    @15,8                                               0803 03022000
         ST    @15,INSRTLN                                         0803 03023000
@DL00803 L     @01,INSRTDA                                         0803 03024000
         ALR   @01,@15                                             0803 03025000
         BCTR  @01,0                                               0803 03026000
         CLI   INSRTCHR(@01),C' '                                  0803 03027000
         BNE   @DC00803                                            0803 03028000
*   END;                            /* SCAN FOR LAST NON BLANK       */ 03029000
         BCTR  @15,0                                               0804 03030000
         ST    @15,INSRTLN                                         0804 03031000
         C     @15,@CF00062                                        0804 03032000
         BNL   @DL00803                                            0804 03033000
@DC00803 DS    0H                                                  0805 03034000
*   END SYSPRTN;                                                   0805 03035000
@EL00018 DS    0H                                                  0805 03036000
@EF00018 DS    0H                                                  0805 03037000
@ER00018 LM    @14,@12,12(@13)                                     0805 03038000
         BR    @14                                                 0805 03039000
*                                                                  0806 03040000
*   /*****************************************************************/ 03041000
*   /*                                                               */ 03042000
*   /* SYSSCMD ROUTINE GET SYSTEM SECONDARY COMMAND NAME             */ 03043000
*   /*                                                               */ 03044000
*   /*****************************************************************/ 03045000
*                                                                  0806 03046000
*SYSSRTN:                                                          0806 03047000
*   PROC;                                                          0806 03048000
SYSSRTN  STM   @14,@12,12(@13)                                     0806 03049000
*   INSRTDA=ADDR(ECTSCMD);          /* POINT TO SECONDARY NAME       */ 03050000
         L     @15,@PC00001+4                                      0807 03051000
         LA    @15,ECTSCMD(,@15)                                   0807 03052000
         ST    @15,INSRTDA                                         0807 03053000
*   DO INSRTLN=F8 TO F2 BY-F1 WHILE INSRTCHR(INSRTLN)=BLANK;       0808 03054000
         LA    @15,8                                               0808 03055000
         ST    @15,INSRTLN                                         0808 03056000
@DL00808 L     @01,INSRTDA                                         0808 03057000
         ALR   @01,@15                                             0808 03058000
         BCTR  @01,0                                               0808 03059000
         CLI   INSRTCHR(@01),C' '                                  0808 03060000
         BNE   @DC00808                                            0808 03061000
*   END;                            /* SCAN FOR LAST NON BLANK       */ 03062000
         BCTR  @15,0                                               0809 03063000
         ST    @15,INSRTLN                                         0809 03064000
         C     @15,@CF00062                                        0809 03065000
         BNL   @DL00808                                            0809 03066000
@DC00808 DS    0H                                                  0810 03067000
*   END SYSSRTN;                                                   0810 03068000
@EL00019 DS    0H                                                  0810 03069000
@EF00019 DS    0H                                                  0810 03070000
@ER00019 LM    @14,@12,12(@13)                                     0810 03071000
         BR    @14                                                 0810 03072000
*                                                                  0811 03073000
*   /*****************************************************************/ 03074000
*   /*                                                               */ 03075000
*   /* EVALUATION SETUP                                              */ 03076000
*   /*                                                               */ 03077000
*   /*****************************************************************/ 03078000
*                                                                  0811 03079000
*SETUP:                                                            0811 03080000
*   PROC OPTIONS(SAVEAREA);                                        0811 03081000
SETUP    STM   @14,@12,12(@13)                                     0811 03082000
         ST    @13,@SA00020+4                                      0811 03083000
         LA    @14,@SA00020                                        0811 03084000
         ST    @14,8(,@13)                                         0811 03085000
         LR    @13,@14                                             0811 03086000
*   CALL WAITRTN;                   /* CHECK FOR & IN P-STRING       */ 03087000
         BAL   @14,WAITRTN                                         0812 03088000
*   IF WAIT=NO&ERROR=F0 THEN        /* IF OK TO PROCESS              */ 03089000
         TM    WAIT(COMONPTR),B'00010000'                          0813 03090000
         BNZ   @RF00813                                            0813 03091000
         SLR   @15,@15                                             0813 03092000
         C     @15,ERROR                                           0813 03093000
         BNE   @RF00813                                            0813 03094000
*     DO;                           /*                               */ 03095000
*       BUFPTR=ADDR(C(I-F1));       /* POINT TO DUMMY BUFFER         */ 03096000
         L     @14,I(,COMONPTR)                                    0815 03097000
         L     @01,BUFBASE(,COMONPTR)                              0815 03098000
         LA    @07,C-2(@14,@01)                                    0815 03099000
         ST    @07,BUFPTR(,COMONPTR)                               0815 03100000
*       CSAVE=BUF(F1:F2);           /* SAVE ORIGINAL BUFFER          */ 03101000
         MVC   CSAVE(2),BUF(@07)                                   0816 03102000
*       BUF(F1:F2)=XEQUAL;          /* MAKE DUMMY STATEMENT          */ 03103000
         MVC   BUF(2,@07),@CC00632                                 0817 03104000
*       CLEN=M-I+F1;                /* SET LENGTH OF DUMMY STMT      */ 03105000
         LCR   @14,@14                                             0818 03106000
         AL    @14,M                                               0818 03107000
         AL    @14,@CF00042                                        0818 03108000
         STH   @14,CLEN(,COMONPTR)                                 0818 03109000
*       TYPE=F0;                    /* NUMERIC ASSIGNMENT            */ 03110000
         ST    @15,TYPE(,COMONPTR)                                 0819 03111000
*       RFY                                                        0820 03112000
*        (R15) RSTD;                /* RESTRICT RETURN CODE REG      */ 03113000
*       CALL IKJCT434(BUF,CLEN,TYPE,OUTA1);/* PROCESS EXPRESSION     */ 03114000
         ST    @07,@AL00001                                        0821 03115000
         LA    @14,CLEN(,COMONPTR)                                 0821 03116000
         ST    @14,@AL00001+4                                      0821 03117000
         LA    @14,TYPE(,COMONPTR)                                 0821 03118000
         ST    @14,@AL00001+8                                      0821 03119000
         LA    @14,OUTA1                                           0821 03120000
         ST    @14,@AL00001+12                                     0821 03121000
         L     @15,@CV00098                                        0821 03122000
         LA    @01,@AL00001                                        0821 03123000
         BALR  @14,@15                                             0821 03124000
*       ERROR=R15;                  /* SAVE ERROR CODE               */ 03125000
         ST    R15,ERROR                                           0822 03126000
*       BUF(F1:F2)=CSAVE;           /* RESTORE BUFFER                */ 03127000
         L     @14,BUFPTR(,COMONPTR)                               0823 03128000
         MVC   BUF(2,@14),CSAVE                                    0823 03129000
*       RFY                                                        0824 03130000
*        (R15) UNRSTD;              /* RELEASE RETURN CODE REG       */ 03131000
*     END;                                                         0825 03132000
*   END SETUP;                                                     0826 03133000
@EL00020 L     @13,4(,@13)                                         0826 03134000
@EF00020 DS    0H                                                  0826 03135000
@ER00020 LM    @14,@12,12(@13)                                     0826 03136000
         BR    @14                                                 0826 03137000
*                                                                  0827 03138000
*   /*****************************************************************/ 03139000
*   /*                                                               */ 03140000
*   /* SYMBOLIC VARIABLE LOCATE                                      */ 03141000
*   /*                                                               */ 03142000
*   /*****************************************************************/ 03143000
*                                                                  0827 03144000
*LOCATE:                                                           0827 03145000
*   PROC(NAME,NAML,FUNC);                                          0827 03146000
LOCATE   STM   @14,@12,@SA00021                                    0827 03147000
         MVC   @PC00021(12),0(@01)                                 0827 03148000
*   DCL                                                            0828 03149000
*     NAME CHAR(*),                                                0828 03150000
*     NAML FIXED(31),                                              0828 03151000
*     FUNC FIXED(31);                                              0828 03152000
*   EXECDPTR=LSDEXEC;               /* RESET EXEC DATA POINTER       */ 03153000
         L     @01,LSDPTR(,COMONPTR)                               0829 03154000
         L     @15,LSDEXEC(,@01)                                   0829 03155000
         ST    @15,EXECDPTR(,COMONPTR)                             0829 03156000
*   SNTABPTR=SNTABFST;              /* POINT TO FIRST SNTAB          */ 03157000
         L     @15,SNTABFST(,@15)                                  0830 03158000
         ST    @15,SNTABPTR                                        0830 03159000
*   SNTELPTR=ADDR(SNTELFST);        /* POINT TO FIRST NAME ENTRY     */ 03160000
         LA    @15,SNTELFST(,@15)                                  0831 03161000
         ST    @15,SNTELPTR(,COMONPTR)                             0831 03162000
*   EXITB=NO;                       /* CLEAR EXITB                   */ 03163000
         NI    EXITB(COMONPTR),B'10111111'                         0832 03164000
*   IF NAML>F252 THEN               /* IF NAME IS TOO LONG           */ 03165000
         L     @15,@PC00021+4                                      0833 03166000
         L     @15,NAML(,@15)                                      0833 03167000
         C     @15,@CF00433                                        0833 03168000
         BNH   @RF00833                                            0833 03169000
*     ERCOM=E940;                   /* SET ERCOM CODE                */ 03170000
         MVC   ERCOM(4,COMONPTR),@CF00801                          0834 03171000
*   DO WHILE EXITB=NO&ERCOM=F0;     /* SEARCH TABLE UNTIL FOUND OR 0835 03172000
*                                      UNTIL AN ERCOM OCCURS         */ 03173000
@RF00833 B     @DE00835                                            0835 03174000
@DL00835 DS    0H                                                  0836 03175000
*     IF NAML=SNTLNG&NAME(1:NAML)=SNTDATA(1:SNTLNG) THEN/* IF FOUND  */ 03176000
         L     @15,@PC00021+4                                      0836 03177000
         L     @14,SNTELPTR(,COMONPTR)                             0836 03178000
         LH    @07,SNTLNG(,@14)                                    0836 03179000
         C     @07,NAML(,@15)                                      0836 03180000
         BNE   @RF00836                                            0836 03181000
         L     @06,@PC00021                                        0836 03182000
         BCTR  @07,0                                               0836 03183000
         EX    @07,@SC01109                                        0836 03184000
         BNE   @RF00836                                            0836 03185000
*       EXITB=YES;                  /* SET FOUND SWITCH              */ 03186000
         OI    EXITB(COMONPTR),B'01000000'                         0837 03187000
*     ELSE                          /* OTHERWISE UPDATE POINTER      */ 03188000
*       IF SNTLAST=YES THEN         /* IF END OF TABLE               */ 03189000
         B     @RC00836                                            0838 03190000
@RF00836 L     @01,SNTELPTR(,COMONPTR)                             0838 03191000
         TM    SNTLAST(@01),B'00000001'                            0838 03192000
         BNO   @RF00838                                            0838 03193000
*         IF SNTABNXT=F0 THEN       /* AND NO MORE TABLES            */ 03194000
         L     @01,SNTABPTR                                        0839 03195000
         L     @15,SNTABNXT(,@01)                                  0839 03196000
         LTR   @15,@15                                             0839 03197000
         BNZ   @RF00839                                            0839 03198000
*           IF FUNC=F8 THEN         /* IF VARIABLE TO BE ADDED       */ 03199000
         L     @15,@PC00021+8                                      0840 03200000
         CLC   FUNC(4,@15),@CF00094                                0840 03201000
         BNE   @RF00840                                            0840 03202000
*             DO;                   /* ADD NAME TO TABLE             */ 03203000
*               CALL NAMEADD;       /* ADD NAME TO TABLE             */ 03204000
         BAL   @14,NAMEADD                                         0842 03205000
*               EXITB=YES;          /* CAUSE TERMINATION             */ 03206000
         OI    EXITB(COMONPTR),B'01000000'                         0843 03207000
*             END;                  /*                               */ 03208000
*           ELSE                    /* OTHERWISE                     */ 03209000
*             ERCOM=E904;           /* SET NOT FOUND RETURN CODE     */ 03210000
         B     @RC00840                                            0845 03211000
@RF00840 MVC   ERCOM(4,COMONPTR),@CF00783                          0845 03212000
*         ELSE                      /*                               */ 03213000
*           DO;                     /* IF NOT THE END, UPDATE TO NEXT*/ 03214000
         B     @RC00839                                            0846 03215000
@RF00839 DS    0H                                                  0847 03216000
*             SNTABPTR=SNTABNXT;    /* TABLE                         */ 03217000
         L     @01,SNTABPTR                                        0847 03218000
         L     @15,SNTABNXT(,@01)                                  0847 03219000
         ST    @15,SNTABPTR                                        0847 03220000
*             SNTELPTR=ADDR(SNTELFST);/* POINT TO FIRST NAME ENTRY IN*/ 03221000
         LA    @15,SNTELFST(,@15)                                  0848 03222000
         ST    @15,SNTELPTR(,COMONPTR)                             0848 03223000
*           END;                    /* NEXT TABLE                    */ 03224000
*       ELSE                        /* NO MOE TABLES AND NOT FOUND   */ 03225000
*         SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);/* UPDATE POINTER */ 03226000
         B     @RC00838                                            0850 03227000
@RF00838 L     @15,SNTELPTR(,COMONPTR)                             0850 03228000
         LH    @14,SNTLNG(,@15)                                    0850 03229000
         ALR   @14,@15                                             0850 03230000
         AL    @14,@CF00094                                        0850 03231000
         ST    @14,SNTELPTR(,COMONPTR)                             0850 03232000
*   END;                                                           0851 03233000
@RC00838 DS    0H                                                  0851 03234000
@RC00836 DS    0H                                                  0851 03235000
@DE00835 TM    EXITB(COMONPTR),B'01000000'                         0851 03236000
         BNZ   @DC00835                                            0851 03237000
         L     @15,ERCOM(,COMONPTR)                                0851 03238000
         LTR   @15,@15                                             0851 03239000
         BZ    @DL00835                                            0851 03240000
@DC00835 DS    0H                                                  0852 03241000
*   IF ERCOM=F0&((FUNC^=F4&SNTLABEL=YES)|/* IF A LABEL WAS FOUND WHEN*/ 03242000
*       (FUNC=F4&SNTLABEL=NO)) THEN /* IT SHOULDNT, THEN SET         */ 03243000
         L     @15,ERCOM(,COMONPTR)                                0852 03244000
         LTR   @15,@15                                             0852 03245000
         BNZ   @RF00852                                            0852 03246000
         L     @15,@PC00021+8                                      0852 03247000
         CLC   FUNC(4,@15),@CF00107                                0852 03248000
         BE    @GL00055                                            0852 03249000
         L     @01,SNTELPTR(,COMONPTR)                             0852 03250000
         TM    SNTLABEL(@01),B'00010000'                           0852 03251000
         BO    @RT00852                                            0852 03252000
@GL00055 L     @15,@PC00021+8                                      0852 03253000
         CLC   FUNC(4,@15),@CF00107                                0852 03254000
         BNE   @RF00852                                            0852 03255000
         L     @01,SNTELPTR(,COMONPTR)                             0852 03256000
         TM    SNTLABEL(@01),B'00010000'                           0852 03257000
         BNZ   @RF00852                                            0852 03258000
@RT00852 DS    0H                                                  0853 03259000
*     ERCOM=E944;                   /* ERCOM INDICATOR               */ 03260000
         MVC   ERCOM(4,COMONPTR),@CF00803                          0853 03261000
*   IF ERCOM=F0&SNTGLOB=YES THEN    /* IF A GLOBAL VARIABLE          */ 03262000
@RF00852 L     @15,ERCOM(,COMONPTR)                                0854 03263000
         LTR   @15,@15                                             0854 03264000
         BNZ   @RF00854                                            0854 03265000
         L     @01,SNTELPTR(,COMONPTR)                             0854 03266000
         TM    SNTGLOB(@01),B'10000000'                            0854 03267000
         BNO   @RF00854                                            0854 03268000
*     CALL GLOCATE;                 /* DO A GLOBAL SEARCH            */ 03269000
         BAL   @14,GLOCATE                                         0855 03270000
*   ERROR=ERCOM;                    /*                               */ 03271000
@RF00854 L     @15,ERCOM(,COMONPTR)                                0856 03272000
         ST    @15,ERROR                                           0856 03273000
*                                                                  0857 03274000
*   /*****************************************************************/ 03275000
*   /*                                                               */ 03276000
*   /* NAME TABLE UPDATE - ADD A NAME ENTRY                          */ 03277000
*   /*                                                               */ 03278000
*   /*****************************************************************/ 03279000
*                                                                  0857 03280000
*NAMEADD:                                                          0857 03281000
*   PROC;                                                          0857 03282000
         B     @PB00022                                            0857 03283000
NAMEADD  STM   @14,@12,12(@13)                                     0857 03284000
*   IF NAML>F31 THEN                /* IF NAME TOO LONG              */ 03285000
         L     @15,@PC00021+4                                      0858 03286000
         L     @15,NAML(,@15)                                      0858 03287000
         C     @15,@CF00059                                        0858 03288000
         BNH   @RF00858                                            0858 03289000
*     ERCOM=E940;                   /* SET ERCOM CODE                */ 03290000
         MVC   ERCOM(4,COMONPTR),@CF00801                          0859 03291000
*   ELSE                            /* OTHERWISE                     */ 03292000
*     IF NAML+LENGTH(SNTELEM)>SNTABLNG-SNTABUSE THEN/* IF NO ROOM  0860 03293000
*                                      LEFT                          */ 03294000
         B     @RC00858                                            0860 03295000
@RF00858 L     @15,@PC00021+4                                      0860 03296000
         L     @15,NAML(,@15)                                      0860 03297000
         LA    @14,8                                               0860 03298000
         ALR   @14,@15                                             0860 03299000
         L     @07,SNTABPTR                                        0860 03300000
         L     @06,SNTABLNG(,@07)                                  0860 03301000
         LR    @05,@06                                             0860 03302000
         SL    @05,SNTABUSE(,@07)                                  0860 03303000
         CR    @14,@05                                             0860 03304000
         BNH   @RF00860                                            0860 03305000
*       DO;                         /* GET ANOTHER TABLE             */ 03306000
*         NEWLNG=MAX(SNTABLNG,NAML+LENGTH(SNTELEM)+LENGTH(SNTAB)+GAS);  03307000
         AL    @15,@CF00419                                        0862 03308000
         CR    @06,@15                                             0862 03309000
         BNL   *+6                                                      03310000
         LR    @06,@15                                             0862 03311000
         ST    @06,NEWLNG                                          0862 03312000
*         DO;                       /* GETMAIN LV(NEWLNG) A(SNTSAVE)    03313000
*                                      SP(78) MF(E,GETLST)         0863 03314000
*                                      RTCD(ERCOM)                   */ 03315000
*           RESPECIFY                                              0864 03316000
*            (GPR01P,                                              0864 03317000
*             GPR15F) RESTRICTED;                                  0864 03318000
*           GETLST01=NEWLNG;        /* LENGTH                        */ 03319000
         ST    @06,GETLST01                                        0865 03320000
*           GETLST03=ADDR(SNTSAVE); /* ADDR OF ADDR LIST             */ 03321000
         LA    @14,SNTSAVE                                         0866 03322000
         STCM  @14,7,GETLST03                                      0866 03323000
*           GETLST05=78;            /* SUBPOOL VALUE                 */ 03324000
         MVI   GETLST05,X'4E'                                      0867 03325000
*           GPR01P=ADDR(GETLST);    /* REG1 POINTS TO LIST           */ 03326000
         LA    GPR01P,GETLST                                       0868 03327000
*           SVC(4);                 /* STANDARD-FORM OF GETMAIN      */ 03328000
         SVC   4                                                   0869 03329000
*           ERCOM=GPR15F;           /* SET RETURN CODE               */ 03330000
         ST    GPR15F,ERCOM(,COMONPTR)                             0870 03331000
*           RESPECIFY                                              0871 03332000
*            (GPR01P,                                              0871 03333000
*             GPR15F) UNRESTRICTED;                                0871 03334000
*         END;                      /* GETMAIN LV(NEWLNG) A(SNTSAVE)    03335000
*                                      SP(78) MF(E,GETLST)         0872 03336000
*                                      RTCD(ERCOM)                   */ 03337000
*         IF ERCOM^=F0 THEN         /* IF GETMAIN ERCOM              */ 03338000
         L     @15,ERCOM(,COMONPTR)                                0873 03339000
         LTR   @15,@15                                             0873 03340000
         BZ    @RF00873                                            0873 03341000
*           ERCOM=E16;              /* SET ERCOM CODE                */ 03342000
         MVC   ERCOM(4,COMONPTR),@CF00104                          0874 03343000
*         ELSE                      /* OTHERWISE                     */ 03344000
*           DO;                     /* CHAIN NEW TABLE               */ 03345000
         B     @RC00873                                            0875 03346000
@RF00873 DS    0H                                                  0876 03347000
*             RFY                                                  0876 03348000
*               SNTAB BASED(SNTSAVE);/* RESET BASE FOR NEW TABLE     */ 03349000
*             SNTABNXT=F0;          /* NO NEXT TABLE                 */ 03350000
         L     @15,SNTSAVE                                         0877 03351000
         SLR   @14,@14                                             0877 03352000
         ST    @14,SNTABNXT(,@15)                                  0877 03353000
*             SNTABLNG=NEWLNG;      /* LENGTH OG THIS TABLE          */ 03354000
         L     @14,NEWLNG                                          0878 03355000
         ST    @14,SNTABLNG(,@15)                                  0878 03356000
*             SNTABUSE=LENGTH(SNTAB);/* LENGTH OF HEADER             */ 03357000
         MVC   SNTABUSE(4,@15),@CF00216                            0879 03358000
*             RFY                                                  0880 03359000
*               SNTAB BASED(SNTABPTR);/* RESTORE BASE                */ 03360000
*             SNTABNXT=SNTSAVE;     /* CHAIN NEW TABLE               */ 03361000
         L     @14,SNTABPTR                                        0881 03362000
         ST    @15,SNTABNXT(,@14)                                  0881 03363000
*             SNTABPTR=SNTSAVE;     /* SET BASE TO NEW TABLE         */ 03364000
         ST    @15,SNTABPTR                                        0882 03365000
*           END;                    /*                               */ 03366000
*       END;                        /*                               */ 03367000
*     ELSE                          /* NOT A NEW TABLE               */ 03368000
*       SNTLAST=NO;                 /* CLEAR OLD LAST SWITCH         */ 03369000
         B     @RC00860                                            0885 03370000
@RF00860 L     @01,SNTELPTR(,COMONPTR)                             0885 03371000
         NI    SNTLAST(@01),B'11111110'                            0885 03372000
*   IF ERCOM=F0 THEN                /* IF NO GETMAIN ERCOM           */ 03373000
@RC00860 DS    0H                                                  0886 03374000
@RC00858 L     @15,ERCOM(,COMONPTR)                                0886 03375000
         LTR   @15,@15                                             0886 03376000
         BNZ   @RF00886                                            0886 03377000
*     DO;                           /* ADD ENTRY                     */ 03378000
*       SNTELPTR=SNTABPTR+SNTABUSE; /* POINT TO NEW SLOT             */ 03379000
         L     @15,SNTABPTR                                        0888 03380000
         L     @14,SNTABUSE(,@15)                                  0888 03381000
         LR    @07,@15                                             0888 03382000
         ALR   @07,@14                                             0888 03383000
         ST    @07,SNTELPTR(,COMONPTR)                             0888 03384000
*       SNTFLAGS=''B;               /* CLEAR FLAGS                   */ 03385000
         XC    SNTFLAGS(2,@07),SNTFLAGS(@07)                       0889 03386000
*       SNTKEYW=YES;                /* KEYWORD WITH VALUE            */ 03387000
*       SNTLAST=YES;                /* NOW LAST ELEMENT              */ 03388000
         OI    SNTKEYW(@07),B'00100001'                            0891 03389000
*       SNTVLPTR=SVTABFST+LENGTH(SVTAB);/* POINT TO NULL ELEMENT     */ 03390000
         L     @01,EXECDPTR(,COMONPTR)                             0892 03391000
         LA    @06,16                                              0892 03392000
         AL    @06,SVTABFST(,@01)                                  0892 03393000
         ST    @06,SNTVLPTR(,@07)                                  0892 03394000
*       SNTLNG=NAML;                /* LENGTH OF NAME                */ 03395000
         L     @06,@PC00021+4                                      0893 03396000
         L     @06,NAML(,@06)                                      0893 03397000
         STH   @06,SNTLNG(,@07)                                    0893 03398000
*       SNTDATA(1:NAML)=NAME(1:NAML);/* NAME                         */ 03399000
         LR    @05,@06                                             0894 03400000
         BCTR  @05,0                                               0894 03401000
         L     @04,@PC00021                                        0894 03402000
         EX    @05,@SM01111                                        0894 03403000
*       SNTABUSE=SNTABUSE+NAML+LENGTH(SNTELEM);/* AMOUNT IN USE      */ 03404000
         ALR   @14,@06                                             0895 03405000
         AL    @14,@CF00094                                        0895 03406000
         ST    @14,SNTABUSE(,@15)                                  0895 03407000
*     END;                          /*                               */ 03408000
*   END NAMEADD;                                                   0897 03409000
@EL00022 DS    0H                                                  0897 03410000
@EF00022 DS    0H                                                  0897 03411000
@ER00022 LM    @14,@12,12(@13)                                     0897 03412000
         BR    @14                                                 0897 03413000
*   END LOCATE;                                                    0898 03414000
@EL00021 DS    0H                                                  0898 03415000
@EF00021 DS    0H                                                  0898 03416000
@ER00021 LM    @14,@12,@SA00021                                    0898 03417000
         BR    @14                                                 0898 03418000
*                                                                  0899 03419000
*   /*****************************************************************/ 03420000
*   /*                                                               */ 03421000
*   /* GLOBAL LOCATE FUNCTION                                        */ 03422000
*   /*                                                               */ 03423000
*   /*****************************************************************/ 03424000
*                                                                  0899 03425000
*GLOCATE:                                                          0899 03426000
*   PROC;                                                          0899 03427000
GLOCATE  STM   @14,@12,12(@13)                                     0899 03428000
*   SNTSAVE=SNTELPTR;               /* SAVE NAME POINTER             */ 03429000
         L     @15,SNTELPTR(,COMONPTR)                             0900 03430000
         ST    @15,SNTSAVE                                         0900 03431000
*   EXECDPTR=GEXECDAT;              /* POINT TO GLOBAL EXEC          */ 03432000
         L     @01,EXECDPTR(,COMONPTR)                             0901 03433000
         L     @15,GEXECDAT(,@01)                                  0901 03434000
         ST    @15,EXECDPTR(,COMONPTR)                             0901 03435000
*   SNTABPTR=SNTABFST;              /* POINT TO FIRST NAME TABLE     */ 03436000
         L     @15,SNTABFST(,@15)                                  0902 03437000
         ST    @15,SNTABPTR                                        0902 03438000
*   SNTELPTR=ADDR(SNTELFST);        /* BEGIN OF GLOBAL NAMES         */ 03439000
         LA    @15,SNTELFST(,@15)                                  0903 03440000
         ST    @15,SNTELPTR(,COMONPTR)                             0903 03441000
*   EXITB=NO;                       /* TURN OFF EXIT SWITCH          */ 03442000
         NI    EXITB(COMONPTR),B'10111111'                         0904 03443000
*   DO WHILE EXITB=NO&ERCOM=F0;     /* FIND GLOBAL VARIABLE          */ 03444000
         B     @DE00905                                            0905 03445000
@DL00905 DS    0H                                                  0906 03446000
*     IF SNTLNG=F4&                 /* IF LENGTH IS FOUR             */ 03447000
*         SNTSAVE->SNTGVAL=SNTDATA(1:F4) THEN/* MATCH                */ 03448000
         L     @15,SNTELPTR(,COMONPTR)                             0906 03449000
         CLC   SNTLNG(2,@15),@CH00107                              0906 03450000
         BNE   @RF00906                                            0906 03451000
         L     @01,SNTSAVE                                         0906 03452000
         CLC   SNTGVAL(4,@01),SNTDATA(@15)                         0906 03453000
         BNE   @RF00906                                            0906 03454000
*       EXITB=YES;                  /* EXIT LOCATE                   */ 03455000
         OI    EXITB(COMONPTR),B'01000000'                         0907 03456000
*     ELSE                          /* OTHERWISE                     */ 03457000
*       IF SNTLAST=YES THEN         /* LAST NAME ?                   */ 03458000
         B     @RC00906                                            0908 03459000
@RF00906 L     @01,SNTELPTR(,COMONPTR)                             0908 03460000
         TM    SNTLAST(@01),B'00000001'                            0908 03461000
         BNO   @RF00908                                            0908 03462000
*         IF SNTABNXT=F0 THEN       /* NO MORE TABLES ?              */ 03463000
         L     @01,SNTABPTR                                        0909 03464000
         L     @15,SNTABNXT(,@01)                                  0909 03465000
         LTR   @15,@15                                             0909 03466000
         BNZ   @RF00909                                            0909 03467000
*           ERCOM=E312;             /* SET ERCOM CODE                */ 03468000
         MVC   ERCOM(4,COMONPTR),@CF00747                          0910 03469000
*         ELSE                      /* OTHERWISE                     */ 03470000
*           DO;                     /* SCAN NEXT TABLE               */ 03471000
         B     @RC00909                                            0911 03472000
@RF00909 DS    0H                                                  0912 03473000
*             SNTABPTR=SNTABNXT;    /* BASE NEXT TABLE               */ 03474000
         L     @01,SNTABPTR                                        0912 03475000
         L     @15,SNTABNXT(,@01)                                  0912 03476000
         ST    @15,SNTABPTR                                        0912 03477000
*             SNTELPTR=ADDR(SNTELFST);/* POINT TO FIRST NAME         */ 03478000
         LA    @15,SNTELFST(,@15)                                  0913 03479000
         ST    @15,SNTELPTR(,COMONPTR)                             0913 03480000
*           END;                    /*                               */ 03481000
*       ELSE                        /* OTHERWISE                     */ 03482000
*         SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);/* GET NEXT       */ 03483000
         B     @RC00908                                            0915 03484000
@RF00908 L     @15,SNTELPTR(,COMONPTR)                             0915 03485000
         LH    @14,SNTLNG(,@15)                                    0915 03486000
         ALR   @14,@15                                             0915 03487000
         AL    @14,@CF00094                                        0915 03488000
         ST    @14,SNTELPTR(,COMONPTR)                             0915 03489000
*   END;                            /*                               */ 03490000
@RC00908 DS    0H                                                  0916 03491000
@RC00906 DS    0H                                                  0916 03492000
@DE00905 TM    EXITB(COMONPTR),B'01000000'                         0916 03493000
         BNZ   @DC00905                                            0916 03494000
         L     @15,ERCOM(,COMONPTR)                                0916 03495000
         LTR   @15,@15                                             0916 03496000
         BZ    @DL00905                                            0916 03497000
@DC00905 DS    0H                                                  0917 03498000
*   ERROR=ERCOM;                                                   0917 03499000
         L     @15,ERCOM(,COMONPTR)                                0917 03500000
         ST    @15,ERROR                                           0917 03501000
*   END GLOCATE;                    /*                               */ 03502000
@EL00023 DS    0H                                                  0918 03503000
@EF00023 DS    0H                                                  0918 03504000
@ER00023 LM    @14,@12,12(@13)                                     0918 03505000
         BR    @14                                                 0918 03506000
*                                                                  0919 03507000
*   /*****************************************************************/ 03508000
*   /*                                                               */ 03509000
*   /* SYMBOLIC VARIABLE UPDATE                                      */ 03510000
*   /*                                                               */ 03511000
*   /*****************************************************************/ 03512000
*                                                                  0919 03513000
*UPDATE:                                                           0919 03514000
*   PROC(VALUE,VALLEN);             /* UPDATE A VTAB ELEMENT         */ 03515000
UPDATE   STM   @14,@12,12(@13)                                     0919 03516000
         MVC   @PC00024(8),0(@01)                                  0919 03517000
*   DCL                                                            0920 03518000
*     VALUE CHAR(*),                                               0920 03519000
*     VALLEN FIXED(31);                                            0920 03520000
*   SVTABPTR=SVTABFST;              /* POIT TO CURRENT VTAB          */ 03521000
         L     @01,EXECDPTR(,COMONPTR)                             0921 03522000
         L     @15,SVTABFST(,@01)                                  0921 03523000
         ST    @15,SVTABPTR                                        0921 03524000
*   IF SNTNAUTH=YES&SYSUPDTE=NO THEN/* IF AN UNAUTHORIZED VARIABLE   */ 03525000
         L     @01,SNTELPTR(,COMONPTR)                             0922 03526000
         TM    SNTNAUTH(@01),B'00000100'                           0922 03527000
         BNO   @RF00922                                            0922 03528000
         TM    SYSUPDTE(COMONPTR),B'00000100'                      0922 03529000
         BNZ   @RF00922                                            0922 03530000
*     ERCOM=E300;                   /* SET ERCOM CODE                */ 03531000
         MVC   ERCOM(4,COMONPTR),@CF00741                          0923 03532000
*   ELSE                            /* OTHERWISE                     */ 03533000
*     DO;                           /* UPDATE VARIABLE               */ 03534000
         B     @RC00922                                            0924 03535000
@RF00922 DS    0H                                                  0925 03536000
*       IF VALLEN>SVTORIG THEN      /* IF A NEW SLOT IS NEEDED       */ 03537000
         L     @15,@PC00024+4                                      0925 03538000
         L     @15,VALLEN(,@15)                                    0925 03539000
         L     @14,SNTELPTR(,COMONPTR)                             0925 03540000
         L     @01,SNTVLPTR(,@14)                                  0925 03541000
         CH    @15,SVTORIG(,@01)                                   0925 03542000
         BNH   @RF00925                                            0925 03543000
*         DO;                                                      0926 03544000
*           IF VALLEN+LENGTH(SVTELEM)>SVTABLNG-SVTABUSE THEN/* IF NEW   03545000
*                                      TABLE                         */ 03546000
         LA    @07,4                                               0927 03547000
         ALR   @07,@15                                             0927 03548000
         L     @06,SVTABPTR                                        0927 03549000
         L     @05,SVTABLNG(,@06)                                  0927 03550000
         L     @04,SVTABUSE(,@06)                                  0927 03551000
         LR    @03,@05                                             0927 03552000
         SLR   @03,@04                                             0927 03553000
         CR    @07,@03                                             0927 03554000
         BNH   @RF00927                                            0927 03555000
*             DO;                   /* IS NEEDED, GET ONE            */ 03556000
*               SNTSAVE=SNTELPTR;   /* SAVE NAME POINTER             */ 03557000
         ST    @14,SNTSAVE                                         0929 03558000
*               EXITC=NO;           /* TURN OFF SWITCH               */ 03559000
         NI    EXITC(COMONPTR),B'11111110'                         0930 03560000
*               NEWLNG=MAX(SVTABLNG+VALLEN+GAS,/* OLD SIZE + GAS     */ 03561000
*                   (SVTABUSE-SVTABFRE)*F3/F2);/* 1.5 TIMES USED     */ 03562000
         ALR   @05,@15                                             0931 03563000
         AL    @05,@CF00353                                        0931 03564000
         SL    @04,SVTABFRE(,@06)                                  0931 03565000
         LR    @01,@04                                             0931 03566000
         M     @00,@CF00054                                        0931 03567000
         D     @00,@CF00062                                        0931 03568000
         CR    @05,@01                                             0931 03569000
         BNL   *+6                                                      03570000
         LR    @05,@01                                             0931 03571000
         ST    @05,NEWLNG                                          0931 03572000
*               DO;                 /* GETMAIN LV(NEWLNG) A(SVTABPTR)   03573000
*                                      SP(78) MF(E,GETLST)         0932 03574000
*                                      RTCD(ERCOM)                   */ 03575000
*                 RESPECIFY                                        0933 03576000
*                  (GPR01P,                                        0933 03577000
*                   GPR15F) RESTRICTED;                            0933 03578000
*                 GETLST01=NEWLNG;  /* LENGTH                        */ 03579000
         ST    @05,GETLST01                                        0934 03580000
*                 GETLST03=ADDR(SVTABPTR);/* ADDR OF ADDR LIST       */ 03581000
         LA    @14,SVTABPTR                                        0935 03582000
         STCM  @14,7,GETLST03                                      0935 03583000
*                 GETLST05=78;      /* SUBPOOL VALUE                 */ 03584000
         MVI   GETLST05,X'4E'                                      0936 03585000
*                 GPR01P=ADDR(GETLST);/* REG1 POINTS TO LIST         */ 03586000
         LA    GPR01P,GETLST                                       0937 03587000
*                 SVC(4);           /* STANDARD-FORM OF GETMAIN      */ 03588000
         SVC   4                                                   0938 03589000
*                 ERCOM=GPR15F;     /* SET RETURN CODE               */ 03590000
         ST    GPR15F,ERCOM(,COMONPTR)                             0939 03591000
*                 RESPECIFY                                        0940 03592000
*                  (GPR01P,                                        0940 03593000
*                   GPR15F) UNRESTRICTED;                          0940 03594000
*               END;                /* GETMAIN LV(NEWLNG) A(SVTABPTR)   03595000
*                                      SP(78) MF(E,GETLST)         0941 03596000
*                                      RTCD(ERCOM)                   */ 03597000
*               IF ERCOM^=F0 THEN   /* IF GETMAIN FAILS              */ 03598000
         L     @15,ERCOM(,COMONPTR)                                0942 03599000
         LTR   @15,@15                                             0942 03600000
         BZ    @RF00942                                            0942 03601000
*                 DO;               /* TERMINATE UPDATE              */ 03602000
*                   ERCOM=E16;      /* SET ERCOM CODE                */ 03603000
         LA    @15,16                                              0944 03604000
         ST    @15,ERCOM(,COMONPTR)                                0944 03605000
*                   ERROR=ERCOM;    /* SET INT ERROR                 */ 03606000
         ST    @15,ERROR                                           0945 03607000
*                   RETURN;         /* RETURN                        */ 03608000
@EL00024 DS    0H                                                  0946 03609000
@EF00024 DS    0H                                                  0946 03610000
@ER00024 LM    @14,@12,12(@13)                                     0946 03611000
         BR    @14                                                 0946 03612000
*                 END;              /*                               */ 03613000
*               ELSE                /* OTHERWISE                     */ 03614000
*                 DO;               /* SET UP AND COPY TABLE         */ 03615000
@RF00942 DS    0H                                                  0949 03616000
*                   SVTABNXT=SVTABFST;/* POINT TO OLD TABLE          */ 03617000
         L     @15,SVTABPTR                                        0949 03618000
         L     @14,EXECDPTR(,COMONPTR)                             0949 03619000
         L     @07,SVTABFST(,@14)                                  0949 03620000
         ST    @07,SVTABNXT(,@15)                                  0949 03621000
*                   SVTABFRE=F0;    /* NO FREE SAPCE IN TABLE        */ 03622000
         SLR   @07,@07                                             0950 03623000
         ST    @07,SVTABFRE(,@15)                                  0950 03624000
*                   SVTABLNG=NEWLNG;/* LENGTH OF THIS TABLE          */ 03625000
         L     @06,NEWLNG                                          0951 03626000
         ST    @06,SVTABLNG(,@15)                                  0951 03627000
*                   SVTABUSE=LENGTH(SVTAB)+LENGTH(NULELEM);/* INIT 0952 03628000
*                                      USED                          */ 03629000
         MVC   SVTABUSE(4,@15),@CF00255                            0952 03630000
*                   SVTABFST=SVTABPTR;/* INIT EXEC DATA POINTER      */ 03631000
         ST    @15,SVTABFST(,@14)                                  0953 03632000
*                   SNTABPTR=SNTABFST;/* POINT TO FIRST NAME TAB     */ 03633000
         L     @14,SNTABFST(,@14)                                  0954 03634000
         ST    @14,SNTABPTR                                        0954 03635000
*                   SNTELPTR=ADDR(SNTELFST);/* GET ADDR OF FIRST NAME*/ 03636000
         LA    @14,SNTELFST(,@14)                                  0955 03637000
         ST    @14,SNTELPTR(,COMONPTR)                             0955 03638000
*                   RFY                                            0956 03639000
*                    (R2,                                          0956 03640000
*                     R3,                                          0956 03641000
*                     R4,                                          0956 03642000
*                     R5) RSTD;     /* RESTRICT REGS                 */ 03643000
*                   EXITC=NO;       /* RESET EXIT SWITCH             */ 03644000
         NI    EXITC(COMONPTR),B'11111110'                         0957 03645000
*                   R2=ADDR(SVTELFST)+LENGTH(NULELEM);/* GET FIRST 0958 03646000
*                                      ALAIL SLOT                    */ 03647000
         LA    R2,SVTELFST(,@15)                                   0958 03648000
         AL    R2,@CF00107                                         0958 03649000
*                   NULELEM=NULVAL; /* INIT NULL ELEMENT             */ 03650000
         ST    @07,NULELEM(,@15)                                   0959 03651000
*                   DO WHILE EXITC=NO;/* MOVE UNTIL END OF TABLE     */ 03652000
         B     @DE00960                                            0960 03653000
@DL00960 DS    0H                                                  0961 03654000
*                     IF SNTELPTR^=SNTSAVE&SNTLABEL=NO&/* OK TO COPY */ 03655000
*                         SNTGLOB=NO THEN/* ELEMENT ?                */ 03656000
         L     @15,SNTELPTR(,COMONPTR)                             0961 03657000
         C     @15,SNTSAVE                                         0961 03658000
         BE    @RF00961                                            0961 03659000
         TM    SNTLABEL(@15),B'00010000'                           0961 03660000
         BNZ   @RF00961                                            0961 03661000
         TM    SNTGLOB(@15),B'10000000'                            0961 03662000
         BNZ   @RF00961                                            0961 03663000
*                       DO;         /* YES-MOVE INTO NEW TABLE       */ 03664000
*                         IF SVTORIG=F0 THEN/* IF ORIGINALLY NULL    */ 03665000
         L     @01,SNTVLPTR(,@15)                                  0963 03666000
         LH    @14,SVTORIG(,@01)                                   0963 03667000
         LTR   @14,@14                                             0963 03668000
         BNZ   @RF00963                                            0963 03669000
*                           SNTVLPTR=ADDR(NULELEM);/* POINT TO NULL     03670000
*                                      ELEM                          */ 03671000
         L     @01,SVTABPTR                                        0964 03672000
         LA    @14,NULELEM(,@01)                                   0964 03673000
         ST    @14,SNTVLPTR(,@15)                                  0964 03674000
*                         ELSE      /* OTHERWISE ASSIGN A SLOT       */ 03675000
*                           DO;     /* IN NEW TABLE                  */ 03676000
         B     @RC00963                                            0965 03677000
@RF00963 DS    0H                                                  0966 03678000
*                             R3=SVTORIG+LENGTH(SVTELEM);/* LENGTH OF   03679000
*                                      MOVE                          */ 03680000
         LA    @15,4                                               0966 03681000
         L     @14,SNTELPTR(,COMONPTR)                             0966 03682000
         L     @07,SNTVLPTR(,@14)                                  0966 03683000
         LH    @06,SVTORIG(,@07)                                   0966 03684000
         LR    R3,@06                                              0966 03685000
         ALR   R3,@15                                              0966 03686000
*                             R4=SNTVLPTR;/* POINT TO OLD DATA       */ 03687000
         LR    R4,@07                                              0967 03688000
*                             R5=R3;/* GET FROM LENGTH               */ 03689000
         LR    R5,R3                                               0968 03690000
*                             SVTABFRE=SVTABFRE+SVTORIG-SVTLNG;/*  0969 03691000
*                                      UPDATE FREE                   */ 03692000
         L     @01,SVTABPTR                                        0969 03693000
         L     @00,SVTABFRE(,@01)                                  0969 03694000
         ALR   @00,@06                                             0969 03695000
         SH    @00,SVTLNG(,@07)                                    0969 03696000
         ST    @00,SVTABFRE(,@01)                                  0969 03697000
*                             SVTABUSE=SVTABUSE+SVTORIG+LENGTH(SVTELEM) 03698000
*                                 ;                                0970 03699000
         AL    @06,SVTABUSE(,@01)                                  0970 03700000
         ALR   @06,@15                                             0970 03701000
         ST    @06,SVTABUSE(,@01)                                  0970 03702000
*                             SNTVLPTR=R2;/* RESET VALUE POINTER     */ 03703000
         ST    R2,SNTVLPTR(,@14)                                   0971 03704000
*                             MVCL(R2,R4);/* COPY INT NEW TABLE      */ 03705000
         MVCL  R2,R4                                               0972 03706000
*                           END;                                   0973 03707000
*                       END;        /*                               */ 03708000
@RC00963 DS    0H                                                  0975 03709000
*                     IF SNTLAST=YES THEN/* IF LAST IN TABLE         */ 03710000
@RF00961 L     @01,SNTELPTR(,COMONPTR)                             0975 03711000
         TM    SNTLAST(@01),B'00000001'                            0975 03712000
         BNO   @RF00975                                            0975 03713000
*                       IF SNTABNXT=F0 THEN/* AND NO MORE TABLES     */ 03714000
         L     @01,SNTABPTR                                        0976 03715000
         L     @15,SNTABNXT(,@01)                                  0976 03716000
         LTR   @15,@15                                             0976 03717000
         BNZ   @RF00976                                            0976 03718000
*                         EXITC=YES;/* END COPY                      */ 03719000
         OI    EXITC(COMONPTR),B'00000001'                         0977 03720000
*                       ELSE        /* RESET TO NEW TABLE            */ 03721000
*                         DO;       /*                               */ 03722000
         B     @RC00976                                            0978 03723000
@RF00976 DS    0H                                                  0979 03724000
*                           SNTABPTR=SNTABNXT;/* RESET BASE          */ 03725000
         L     @01,SNTABPTR                                        0979 03726000
         L     @15,SNTABNXT(,@01)                                  0979 03727000
         ST    @15,SNTABPTR                                        0979 03728000
*                           SNTELPTR=ADDR(SNTELFST);/* RESET EL PTR  */ 03729000
         LA    @15,SNTELFST(,@15)                                  0980 03730000
         ST    @15,SNTELPTR(,COMONPTR)                             0980 03731000
*                         END;      /*                               */ 03732000
*                     ELSE          /* OTHERWISE                     */ 03733000
*                       SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);  0982 03734000
         B     @RC00975                                            0982 03735000
@RF00975 L     @15,SNTELPTR(,COMONPTR)                             0982 03736000
         LH    @14,SNTLNG(,@15)                                    0982 03737000
         ALR   @14,@15                                             0982 03738000
         AL    @14,@CF00094                                        0982 03739000
         ST    @14,SNTELPTR(,COMONPTR)                             0982 03740000
*                   END;            /*                               */ 03741000
@RC00975 DS    0H                                                  0983 03742000
@DE00960 TM    EXITC(COMONPTR),B'00000001'                         0983 03743000
         BZ    @DL00960                                            0983 03744000
*                   RFY                                            0984 03745000
*                    (R2,                                          0984 03746000
*                     R3,                                          0984 03747000
*                     R4,                                          0984 03748000
*                     R5) UNRSTD;   /* RELEASE REGS                  */ 03749000
*                   SNTELPTR=SNTSAVE;/* RESTORE SNTELPTR             */ 03750000
         L     @15,SNTSAVE                                         0985 03751000
         ST    @15,SNTELPTR(,COMONPTR)                             0985 03752000
*                   SNTABPTR=SNTABFST;/* RESTORE TABLE POINTER       */ 03753000
         L     @01,EXECDPTR(,COMONPTR)                             0986 03754000
         L     @15,SNTABFST(,@01)                                  0986 03755000
         ST    @15,SNTABPTR                                        0986 03756000
*                   DO;             /* FREEMAIN                    0987 03757000
*                                      LV(SVTABNXT->SVTABLNG)      0987 03758000
*                                      A(SVTABNXT) SP(78)          0987 03759000
*                                      MF(E,FRELST)                  */ 03760000
*                     RESPECIFY                                    0988 03761000
*                      (GPR01P) RESTRICTED;                        0988 03762000
*                     FRELST02=SVTABNXT->SVTABLNG;/* LENGTH          */ 03763000
         L     @15,SVTABPTR                                        0989 03764000
         L     @14,SVTABNXT(,@15)                                  0989 03765000
         MVC   FRELST02(3),SVTABLNG+1(@14)                         0989 03766000
*                     FRELST04=ADDR(SVTABNXT);/* ADDR OF ADDR LIST   */ 03767000
         STCM  @15,7,FRELST04                                      0990 03768000
*                     FRELST06=78;  /* SUBPOOL VALUE                 */ 03769000
         MVI   FRELST06,X'4E'                                      0991 03770000
*                     GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST     */ 03771000
         LA    GPR01P,FRELST                                       0992 03772000
*                     SVC(5);       /* STANDARD-FORM OF GETMAIN      */ 03773000
         SVC   5                                                   0993 03774000
*                     RESPECIFY                                    0994 03775000
*                      (GPR01P) UNRESTRICTED;                      0994 03776000
*                   END;            /* FREEMAIN                    0995 03777000
*                                      LV(SVTABNXT->SVTABLNG)      0995 03778000
*                                      A(SVTABNXT) SP(78)          0995 03779000
*                                      MF(E,FRELST)                  */ 03780000
*                   SVTABNXT=F0;    /* BREAK CHAIN                   */ 03781000
         L     @01,SVTABPTR                                        0996 03782000
         SLR   @00,@00                                             0996 03783000
         ST    @00,SVTABNXT(,@01)                                  0996 03784000
*                 END;              /*                               */ 03785000
*             END;                  /*                               */ 03786000
*           SNTVLPTR=SVTABPTR+SVTABUSE;/* ASSIGN NEW SLOT            */ 03787000
@RF00927 L     @01,SNTELPTR(,COMONPTR)                             0999 03788000
         L     @15,SVTABPTR                                        0999 03789000
         L     @14,SVTABUSE(,@15)                                  0999 03790000
         LR    @00,@15                                             0999 03791000
         ALR   @00,@14                                             0999 03792000
         ST    @00,SNTVLPTR(,@01)                                  0999 03793000
*           SVTORIG=VALLEN;         /* SET LENGTH OF VALUE           */ 03794000
         L     @01,@PC00024+4                                      1000 03795000
         L     @01,VALLEN(,@01)                                    1000 03796000
         LR    @07,@00                                             1000 03797000
         STH   @01,SVTORIG(,@07)                                   1000 03798000
*           SVTLNG=VALLEN;          /*                               */ 03799000
         LR    @07,@00                                             1001 03800000
         STH   @01,SVTLNG(,@07)                                    1001 03801000
*           SVTABUSE=SVTABUSE+VALLEN+LENGTH(SVTELEM);/*              */ 03802000
         ALR   @14,@01                                             1002 03803000
         AL    @14,@CF00107                                        1002 03804000
         ST    @14,SVTABUSE(,@15)                                  1002 03805000
*         END;                      /*                               */ 03806000
*       SVTABFRE=SVTABFRE+SVTLNG-VALLEN;/* ADJUST FREE AREA          */ 03807000
@RF00925 L     @15,SVTABPTR                                        1004 03808000
         L     @01,SNTELPTR(,COMONPTR)                             1004 03809000
         L     @14,SNTVLPTR(,@01)                                  1004 03810000
         LH    @07,SVTLNG(,@14)                                    1004 03811000
         AL    @07,SVTABFRE(,@15)                                  1004 03812000
         L     @06,@PC00024+4                                      1004 03813000
         SL    @07,VALLEN(,@06)                                    1004 03814000
         ST    @07,SVTABFRE(,@15)                                  1004 03815000
*       IF NODATA=YES THEN          /* IF NODATA SPECIFIED           */ 03816000
         TM    NODATA(COMONPTR),B'01000000'                        1005 03817000
         BNO   @RF01005                                            1005 03818000
*         SVTLNG=F0;                /* CURRENT LENGTH IS ZERO        */ 03819000
         SLR   @15,@15                                             1006 03820000
         STH   @15,SVTLNG(,@14)                                    1006 03821000
*       ELSE                        /* OTHERWISE                     */ 03822000
*         SVTLNG=VALLEN;            /* SET NEW LENGTH                */ 03823000
         B     @RC01005                                            1007 03824000
@RF01005 L     @01,SNTELPTR(,COMONPTR)                             1007 03825000
         L     @01,SNTVLPTR(,@01)                                  1007 03826000
         L     @15,@PC00024+4                                      1007 03827000
         L     @00,VALLEN(,@15)                                    1007 03828000
         STH   @00,SVTLNG(,@01)                                    1007 03829000
*       RFY                                                        1008 03830000
*        (R2,                                                      1008 03831000
*         R3,                                                      1008 03832000
*         R4,                                                      1008 03833000
*         R5) RSTD;                 /* RESTRICT REGS                 */ 03834000
@RC01005 DS    0H                                                  1009 03835000
*       R2=ADDR(SVTDATA);           /*                               */ 03836000
         L     @01,SNTELPTR(,COMONPTR)                             1009 03837000
         L     @15,SNTVLPTR(,@01)                                  1009 03838000
         LA    R2,SVTDATA(,@15)                                    1009 03839000
*       R3=SVTORIG;                 /* ALWAYS CLEAR OR MOVE TO ALL   */ 03840000
         LH    R3,SVTORIG(,@15)                                    1010 03841000
*       R4=ADDR(VALUE);             /* POINT TO NEW DATA             */ 03842000
         L     R4,@PC00024                                         1011 03843000
*       R5=SVTLNG|BLANKS;           /* ONLY MOVE WHAT SVTLNG SAYS    */ 03844000
         LH    R5,SVTLNG(,@15)                                     1012 03845000
         O     R5,@CF00622                                         1012 03846000
*       MVCL(R2,R4);                /* MOVE NEW DATA                 */ 03847000
         MVCL  R2,R4                                               1013 03848000
*       RFY                                                        1014 03849000
*        (R2,                                                      1014 03850000
*         R3,                                                      1014 03851000
*         R4,                                                      1014 03852000
*         R5) UNRSTD;               /* RELEASE REGS                  */ 03853000
*     END;                          /*                               */ 03854000
*   EXECDPTR=LSDEXEC;               /* RESET EXEC DATA POINTER       */ 03855000
@RC00922 L     @01,LSDPTR(,COMONPTR)                               1016 03856000
         L     @15,LSDEXEC(,@01)                                   1016 03857000
         ST    @15,EXECDPTR(,COMONPTR)                             1016 03858000
*   ERROR=ERCOM;                                                   1017 03859000
         L     @15,ERCOM(,COMONPTR)                                1017 03860000
         ST    @15,ERROR                                           1017 03861000
*   END UPDATE;                     /* END OF UPDATE                 */ 03862000
         B     @EL00024                                            1018 03863000
*                                                                  1019 03864000
*   /*****************************************************************/ 03865000
*   /*                                                               */ 03866000
*   /* RETURN CODE UPDATE                                            */ 03867000
*   /*                                                               */ 03868000
*   /*****************************************************************/ 03869000
*                                                                  1019 03870000
*RCUPDT:                                                           1019 03871000
*   PROC;                                                          1019 03872000
RCUPDT   STM   @14,@12,@SA00025                                    1019 03873000
*   IF NOLASTCC=YES THEN            /* IF SKIP LASTCC UPDATE @ZA03879*/ 03874000
         L     @15,EXECDPTR(,COMONPTR)                             1020 03875000
         TM    NOLASTCC(@15),B'01000000'                           1020 03876000
         BNO   @RF01020                                            1020 03877000
*     NOLASTCC=NO;                  /* TURN OFF FLAG         @ZA03879*/ 03878000
         NI    NOLASTCC(@15),B'10111111'                           1021 03879000
*   ELSE                            /*                       @ZA03879*/ 03880000
*     DO;                           /* NORMAL UPDATE         @ZA03879*/ 03881000
         B     @RC01020                                            1022 03882000
@RF01020 DS    0H                                                  1023 03883000
*       IF RCABEND=YES&ERRSAV//F4096=F0 THEN/* IF SYSTEM ABEND CODE  */ 03884000
         TM    RCABEND(COMONPTR),B'10000000'                       1023 03885000
         BNO   @RF01023                                            1023 03886000
         L     @15,ERRSAV                                          1023 03887000
         LR    @00,@15                                             1023 03888000
         SRDA  @00,32                                              1023 03889000
         D     @00,@CF00725                                        1023 03890000
         LTR   @00,@00                                             1023 03891000
         BNZ   @RF01023                                            1023 03892000
*         DO;                       /* DETRIMINE TYPE                */ 03893000
*           AREA(1:4)=ERRSAV;       /* PREPARE FOR UNPAK             */ 03894000
         STCM  @15,15,AREA                                         1025 03895000
*           UNPK(OUTA1(2:8),AREA(1:5));/* UNPACK ABEND CODE          */ 03896000
         UNPK  OUTA1+1(7),AREA(5)                                  1026 03897000
*           DO I=F7 TO F2 BY-F1;    /* TRANSLATE FA-FF TO C1-C5      */ 03898000
         LA    @15,7                                               1027 03899000
         ST    @15,I(,COMONPTR)                                    1027 03900000
@DL01027 DS    0H                                                  1028 03901000
*             IF OUTFX(I)>F249 THEN /* DECIMAL OF F9 (FA-FF IS >)    */ 03902000
         L     @15,I(,COMONPTR)                                    1028 03903000
         SLR   @14,@14                                             1028 03904000
         IC    @14,OUTFX-1(@15)                                    1028 03905000
         C     @14,@CF00402                                        1028 03906000
         BNH   @RF01028                                            1028 03907000
*               OUTFX(I)=OUTFX(I)-F57;/* SUBTRACT 39 (FA-39=C1)      */ 03908000
         SL    @14,@CF00288                                        1029 03909000
         STC   @14,OUTFX-1(@15)                                    1029 03910000
*           END;                    /* DONE TRANSLATE                */ 03911000
@RF01028 SLR   @15,@15                                             1030 03912000
         BCTR  @15,0                                               1030 03913000
         AL    @15,I(,COMONPTR)                                    1030 03914000
         ST    @15,I(,COMONPTR)                                    1030 03915000
         C     @15,@CF00062                                        1030 03916000
         BNL   @DL01027                                            1030 03917000
*           OUTA1(1)=CCS;           /* INSERT S FOR SYSTEM           */ 03918000
         MVI   OUTA1,C'S'                                          1031 03919000
*           LEN=F4;                 /* LENGTH OF ANSWER              */ 03920000
         MVC   LEN(4,COMONPTR),@CF00107                            1032 03921000
*         END;                      /*                               */ 03922000
*       ELSE                        /* NORMAL PROCESSING             */ 03923000
*         DO;                       /*                               */ 03924000
         B     @RC01023                                            1034 03925000
@RF01023 DS    0H                                                  1035 03926000
*           CVD(ERRSAV,WORKAREA);   /* CONVERT CODE TO PRINTABLE     */ 03927000
         L     @15,ERRSAV                                          1035 03928000
         CVD   @15,WORKAREA                                        1035 03929000
*           UNPK(OUTA1(1:16),WORKAREA);/*                            */ 03930000
         UNPK  OUTA1(16),WORKAREA(8)                               1036 03931000
*           OUTA1(16)=OUTA1(16)|CC0;/* INSURE PRINTABLE CHARS        */ 03932000
         OI    OUTA1+15,C'0'                                       1037 03933000
*           IF RCABEND=YES THEN     /* IF USER ABEND CODE            */ 03934000
         TM    RCABEND(COMONPTR),B'10000000'                       1038 03935000
         BNO   @RF01038                                            1038 03936000
*             DO;                   /*                               */ 03937000
*               LEN=F5;             /* LENGTH IS FIVE                */ 03938000
         MVC   LEN(4,COMONPTR),@CF00052                            1040 03939000
*               OUTA1(1)=CCU;       /* SET U TYPE                    */ 03940000
         MVI   OUTA1,C'U'                                          1041 03941000
*               OUTA1(2:5)=OUTA1(13:16);/* MOVE OVER CHARS           */ 03942000
         MVC   OUTA1+1(4),OUTA1+12                                 1042 03943000
*             END;                  /*                               */ 03944000
*           ELSE                    /* OTHERWISE GET CODE            */ 03945000
*             DO LEN=F16 TO F2 BY-F1 WHILE OUTA1(1)=CC0;/* LZ      1044 03946000
*                                      SUPPRESS                      */ 03947000
         B     @RC01038                                            1044 03948000
@RF01038 LA    @15,16                                              1044 03949000
         ST    @15,LEN(,COMONPTR)                                  1044 03950000
@DL01044 CLI   OUTA1,C'0'                                          1044 03951000
         BNE   @DC01044                                            1044 03952000
*               OUTA1(1:15)=OUTA1(2:16);/* SHIFT DOWN BUFFER         */ 03953000
         MVC   @TS00001(15),OUTA1+1                                1045 03954000
         MVC   OUTA1(15),@TS00001                                  1045 03955000
*             END;                  /*                               */ 03956000
         SLR   @15,@15                                             1046 03957000
         BCTR  @15,0                                               1046 03958000
         AL    @15,LEN(,COMONPTR)                                  1046 03959000
         ST    @15,LEN(,COMONPTR)                                  1046 03960000
         C     @15,@CF00062                                        1046 03961000
         BNL   @DL01044                                            1046 03962000
@DC01044 DS    0H                                                  1047 03963000
*         END;                      /*                               */ 03964000
@RC01038 DS    0H                                                  1048 03965000
*       CALL LOCATE(LASTCC,LENGTH(LASTCC),F0);/* LOCATE LASTCC       */ 03966000
@RC01023 LA    @01,@AL01048                                        1048 03967000
         BAL   @14,LOCATE                                          1048 03968000
*       IF ERROR=F0 THEN            /* IF LOCATE OK                  */ 03969000
         L     @15,ERROR                                           1049 03970000
         LTR   @15,@15                                             1049 03971000
         BNZ   @RF01049                                            1049 03972000
*         DO;                       /* PROCESS UPDATE                */ 03973000
*           CALL UPDATE(OUTA1,LEN); /* UPDATE LASTCC                 */ 03974000
         LA    @15,OUTA1                                           1051 03975000
         ST    @15,@AL00001                                        1051 03976000
         LA    @15,LEN(,COMONPTR)                                  1051 03977000
         ST    @15,@AL00001+4                                      1051 03978000
         LA    @01,@AL00001                                        1051 03979000
         BAL   @14,UPDATE                                          1051 03980000
*           CALL LOCATE(MAXCC,LENGTH(MAXCC),F0);/* LOCATE MAXCC      */ 03981000
         LA    @01,@AL01052                                        1052 03982000
         BAL   @14,LOCATE                                          1052 03983000
*           IF ERROR=F0&SVTLNG<LEN|(SVTLNG=/* MX SMALLER ?           */ 03984000
*               LEN&SVTDATA(1:LEN)<OUTA1(1:LEN)) THEN/* UPDATE       */ 03985000
         L     @15,ERROR                                           1053 03986000
         LTR   @15,@15                                             1053 03987000
         BNZ   @GL00065                                            1053 03988000
         L     @01,SNTELPTR(,COMONPTR)                             1053 03989000
         L     @01,SNTVLPTR(,@01)                                  1053 03990000
         LH    @15,SVTLNG(,@01)                                    1053 03991000
         C     @15,LEN(,COMONPTR)                                  1053 03992000
         BL    @RT01053                                            1053 03993000
@GL00065 L     @01,SNTELPTR(,COMONPTR)                             1053 03994000
         L     @15,SNTVLPTR(,@01)                                  1053 03995000
         L     @14,LEN(,COMONPTR)                                  1053 03996000
         CH    @14,SVTLNG(,@15)                                    1053 03997000
         BNE   @RF01053                                            1053 03998000
         BCTR  @14,0                                               1053 03999000
         EX    @14,@SC01113                                        1053 04000000
         BNL   @RF01053                                            1053 04001000
@RT01053 DS    0H                                                  1054 04002000
*             CALL UPDATE(OUTA1,LEN);/* UPDATE MAXCC                 */ 04003000
         LA    @15,OUTA1                                           1054 04004000
         ST    @15,@AL00001                                        1054 04005000
         LA    @15,LEN(,COMONPTR)                                  1054 04006000
         ST    @15,@AL00001+4                                      1054 04007000
         LA    @01,@AL00001                                        1054 04008000
         BAL   @14,UPDATE                                          1054 04009000
*         END;                      /*                               */ 04010000
@RF01053 DS    0H                                                  1056 04011000
*       IF ERROR^=F0&ERROR^=E16 THEN/* ERROR FINDIN OR UPDATIN CC S  */ 04012000
@RF01049 L     @15,ERROR                                           1056 04013000
         LTR   @15,@15                                             1056 04014000
         BZ    @RF01056                                            1056 04015000
         C     @15,@CF00104                                        1056 04016000
         BE    @RF01056                                            1056 04017000
*         ERROR=E999;               /* SET INTERNAL CLIST ERROR      */ 04018000
         MVC   ERROR(4),@CF00817                                   1057 04019000
*     END;                          /* END NORMAL UPDATE     @ZA03879*/ 04020000
*   END RCUPDT;                                                    1059 04021000
@EL00025 DS    0H                                                  1059 04022000
@EF00025 DS    0H                                                  1059 04023000
@ER00025 LM    @14,@12,@SA00025                                    1059 04024000
         BR    @14                                                 1059 04025000
*                                                                  1060 04026000
*   /*****************************************************************/ 04027000
*   /*                                                               */ 04028000
*   /* PRINT SUB FUNCTION                                            */ 04029000
*   /*                                                               */ 04030000
*   /*****************************************************************/ 04031000
*                                                                  1060 04032000
*PRINT:                                                            1060 04033000
*   PROC(LINEADDR,TERMPUT) OPTIONS(SAVEAREA);                      1060 04034000
PRINT    STM   @14,@12,12(@13)                                     1060 04035000
         ST    @13,@SA00026+4                                      1060 04036000
         LA    @14,@SA00026                                        1060 04037000
         ST    @14,8(,@13)                                         1060 04038000
         LR    @13,@14                                             1060 04039000
         MVC   @PC00026(8),0(@01)                                  1060 04040000
*   DCL                                                            1061 04041000
*     TERMPUT FIXED(31),                                           1061 04042000
*     LINEADDR PTR(31),                                            1061 04043000
*     ASIS FIXED(31) CONSTANT(2);                                  1061 04044000
*   IOPL(4)=ADDR(PLBLK);            /* ADDR OF PARM BLOCK            */ 04045000
         LA    @15,PLBLK                                           1062 04046000
         ST    @15,IOPL+12(,COMONPTR)                              1062 04047000
*   CLEN=LINEADDR->LL;              /* SAVE ORIGINAL LENGTH          */ 04048000
         L     @15,@PC00026                                        1063 04049000
         L     @15,LINEADDR(,@15)                                  1063 04050000
         LH    @14,LL(,@15)                                        1063 04051000
         STH   @14,CLEN(,COMONPTR)                                 1063 04052000
*   LINEADDR->LL=LINEADDR->LL-FREEAMT;/* REDUCE TOTAL LENGTH         */ 04053000
         SL    @14,FREEAMT(,COMONPTR)                              1064 04054000
         STH   @14,LL(,@15)                                        1064 04055000
*   IF LINEADDR->LL=F4 THEN         /* IF LL=4 THEN SET LL=5         */ 04056000
         C     @14,@CF00107                                        1065 04057000
         BNE   @RF01065                                            1065 04058000
*     LINEADDR->LL=F5;              /* TO FOOL TCAM (FOR C/R)        */ 04059000
         MVC   LL(2,@15),@CH00052                                  1066 04060000
*   RFY                                                            1067 04061000
*    (R1,                                                          1067 04062000
*     R4,                                                          1067 04063000
*     R15) RSTD;                    /* RESTRICT REGS                 */ 04064000
@RF01065 DS    0H                                                  1068 04065000
*   R15=ADDR(IKJEFT40);             /* ADDR OF T40                   */ 04066000
         L     R15,@CV00101                                        1068 04067000
*   R1=ADDR(IOPL);                  /* LOAD REG 1                    */ 04068000
         LR    R1,COMONPTR                                         1069 04069000
*   R4=LINEADDR;                    /* POINTER TO LINE TO PRINT      */ 04070000
         L     @14,@PC00026                                        1070 04071000
         L     R4,LINEADDR(,@14)                                   1070 04072000
*   IF TERMPUT=ASIS THEN            /* PUTLINE ASIS                  */ 04073000
         L     @14,@PC00026+4                                      1071 04074000
         CLC   TERMPUT(4,@14),@CF00062                             1071 04075000
         BNE   @RF01071                                            1071 04076000
*     GEN                                                          1072 04077000
*(PUTLINE OUTPUT=((R4),DATA),TERMPUT=ASIS,MF=(E,(1)),ENTRY=(15));  1072 04078000
         PUTLINE OUTPUT=((R4),DATA),TERMPUT=ASIS,MF=(E,(1)),ENTRY=(15)  04079000
*   ELSE                            /* OTHERWISE PRINT EDIT          */ 04080000
*     GEN                                                          1073 04081000
*(PUTLINE OUTPUT=((R4),DATA),TERMPUT=EDIT,MF=(E,(1)),ENTRY=(15));  1073 04082000
         B     @RC01071                                            1073 04083000
@RF01071 DS    0H                                                  1073 04084000
         PUTLINE OUTPUT=((R4),DATA),TERMPUT=EDIT,MF=(E,(1)),ENTRY=(15)  04085000
*   RFY                                                            1074 04086000
*    (R1,                                                          1074 04087000
*     R4,                                                          1074 04088000
*     R15) UNRSTD;                  /* FREE REGS                     */ 04089000
@RC01071 DS    0H                                                  1075 04090000
*   LINEADDR->LL=CLEN;              /* RESTORE LENGTH                */ 04091000
         L     @15,@PC00026                                        1075 04092000
         L     @01,LINEADDR(,@15)                                  1075 04093000
         LH    @00,CLEN(,COMONPTR)                                 1075 04094000
         STH   @00,LL(,@01)                                        1075 04095000
*   END PRINT;                                                     1076 04096000
@EL00026 L     @13,4(,@13)                                         1076 04097000
@EF00026 DS    0H                                                  1076 04098000
@ER00026 LM    @14,@12,12(@13)                                     1076 04099000
         BR    @14                                                 1076 04100000
*                                                                  1077 04101000
*   /*****************************************************************/ 04102000
*   /*                                                               */ 04103000
*   /* COMMAND LIST ROUTINE                                          */ 04104000
*   /*                                                               */ 04105000
*   /*****************************************************************/ 04106000
*                                                                  1077 04107000
*CMDLST:                                                           1077 04108000
*   PROC;                                                          1077 04109000
CMDLST   STM   @14,@12,@SA00027                                    1077 04110000
*   IF OPCODE^=IGOTO THEN           /* AS LONG AS NOT INTERNAL GOTO  */ 04111000
         L     @01,OLDLINE(,COMONPTR)                              1078 04112000
         CLI   OPCODE(@01),15                                      1078 04113000
         BE    @RF01078                                            1078 04114000
*     DO;                           /* LIST COMMAND                  */ 04115000
*       IF FOLD=NO THEN             /* FOLD INTO UPPER CASE ?        */ 04116000
         TM    FOLD(COMONPTR),B'00010000'                          1080 04117000
         BNZ   @RF01080                                            1080 04118000
*         CALL PRINT(BUFBASE,F0);   /* NO- PRINT OK                  */ 04119000
         LA    @15,BUFBASE(,COMONPTR)                              1081 04120000
         ST    @15,@AL00001                                        1081 04121000
         LA    @15,@CF00439                                        1081 04122000
         ST    @15,@AL00001+4                                      1081 04123000
         LA    @01,@AL00001                                        1081 04124000
         BAL   @14,PRINT                                           1081 04125000
*       ELSE                        /* YES- FOLD TO UPPER CASE       */ 04126000
*         DO;                       /* BEFORE PRINTING               */ 04127000
         B     @RC01080                                            1082 04128000
@RF01080 DS    0H                                                  1083 04129000
*           DO I=1 TO LL-(F4+FREEAMT);/* FOLD TO UPPER CASE          */ 04130000
         LA    @15,1                                               1083 04131000
         B     @DE01083                                            1083 04132000
@DL01083 DS    0H                                                  1084 04133000
*             NEWC(I)=C(I);         /* COPY TO NEW BUFFER            */ 04134000
         L     @15,I(,COMONPTR)                                    1084 04135000
         L     @14,NEWBASE(,COMONPTR)                              1084 04136000
         ALR   @15,@14                                             1084 04137000
         L     @07,I(,COMONPTR)                                    1084 04138000
         L     @06,BUFBASE(,COMONPTR)                              1084 04139000
         ALR   @06,@07                                             1084 04140000
         MVC   NEWC-1(1,@15),C-1(@06)                              1084 04141000
*             TR(NEWC(I),TRTABUP);  /* TRANSLATE TO UPPER CASE       */ 04142000
         ALR   @14,@07                                             1085 04143000
         TR    NEWC-1(1,@14),TRTABUP                               1085 04144000
*           END;                    /*                               */ 04145000
         LA    @15,1                                               1086 04146000
         AL    @15,I(,COMONPTR)                                    1086 04147000
@DE01083 ST    @15,I(,COMONPTR)                                    1086 04148000
         L     @14,BUFBASE(,COMONPTR)                              1086 04149000
         LA    @07,4                                               1086 04150000
         AL    @07,FREEAMT(,COMONPTR)                              1086 04151000
         LCR   @07,@07                                             1086 04152000
         AH    @07,LL(,@14)                                        1086 04153000
         CR    @15,@07                                             1086 04154000
         BNH   @DL01083                                            1086 04155000
*           CALL PRINT(NEWBASE,F0); /* PRINT FOLDED LINE             */ 04156000
         LA    @15,NEWBASE(,COMONPTR)                              1087 04157000
         ST    @15,@AL00001                                        1087 04158000
         LA    @15,@CF00439                                        1087 04159000
         ST    @15,@AL00001+4                                      1087 04160000
         LA    @01,@AL00001                                        1087 04161000
         BAL   @14,PRINT                                           1087 04162000
*         END;                      /*                               */ 04163000
*     END;                                                         1089 04164000
*   END CMDLST;                                                    1090 04165000
@EL00027 DS    0H                                                  1090 04166000
@EF00027 DS    0H                                                  1090 04167000
@ER00027 LM    @14,@12,@SA00027                                    1090 04168000
         BR    @14                                                 1090 04169000
*                                                                  1091 04170000
*   /*****************************************************************/ 04171000
*   /*                                                               */ 04172000
*   /* STRING BUILT IN FUNCTION                                      */ 04173000
*   /*                                                               */ 04174000
*   /*****************************************************************/ 04175000
*                                                                  1091 04176000
*STRRTN:                                                           1091 04177000
*   PROC;                                                          1091 04178000
STRRTN   STM   @14,@12,@SA00028                                    1091 04179000
*   CALL WAITRTN;                   /* CHECK FOR WAIT                */ 04180000
         BAL   @14,WAITRTN                                         1092 04181000
*   IF WAIT=NO&ERROR=F0 THEN        /* IF OK                         */ 04182000
         TM    WAIT(COMONPTR),B'00010000'                          1093 04183000
         BNZ   @RF01093                                            1093 04184000
         L     @15,ERROR                                           1093 04185000
         LTR   @15,@15                                             1093 04186000
         BNZ   @RF01093                                            1093 04187000
*     DO;                           /* PROCESS                       */ 04188000
*       PCTR=F1;                    /* INIT PCTR                     */ 04189000
         LA    @15,1                                               1095 04190000
         ST    @15,PCTR                                            1095 04191000
*       INSRTDA=ADDR(C(I+1));       /* POINT TO VALUE                */ 04192000
         L     @01,I(,COMONPTR)                                    1096 04193000
         L     @14,BUFBASE(,COMONPTR)                              1096 04194000
         LA    @07,C(@01,@14)                                      1096 04195000
         ST    @07,INSRTDA                                         1096 04196000
*       INSRTLN=ADDR(C(M))-INSRTDA; /* FIND LENGTH OF STRING         */ 04197000
         L     @01,M                                               1097 04198000
         LA    @06,C-1(@01,@14)                                    1097 04199000
         SLR   @06,@07                                             1097 04200000
         ST    @06,INSRTLN                                         1097 04201000
*       DO I=1 TO INSRTLN;          /*                               */ 04202000
         B     @DE01098                                            1098 04203000
@DL01098 DS    0H                                                  1099 04204000
*         TR(INSRTCHR(I),TRTABDN);  /* FOLD TO SPCL CHR              */ 04205000
         L     @01,I(,COMONPTR)                                    1099 04206000
         L     @15,INSRTDA                                         1099 04207000
         ALR   @15,@01                                             1099 04208000
         BCTR  @15,0                                               1099 04209000
         TR    INSRTCHR(1,@15),TRTABDN                             1099 04210000
*       END;                                                       1100 04211000
         LA    @15,1                                               1100 04212000
         AL    @15,I(,COMONPTR)                                    1100 04213000
@DE01098 ST    @15,I(,COMONPTR)                                    1100 04214000
         C     @15,INSRTLN                                         1100 04215000
         BNH   @DL01098                                            1100 04216000
*       I=M+F1;                     /* POINT TO RESUME DATA          */ 04217000
         LA    @15,1                                               1101 04218000
         AL    @15,M                                               1101 04219000
         ST    @15,I(,COMONPTR)                                    1101 04220000
*     END;                                                         1102 04221000
*   END STRRTN;                                                    1103 04222000
@EL00028 DS    0H                                                  1103 04223000
@EF00028 DS    0H                                                  1103 04224000
@ER00028 LM    @14,@12,@SA00028                                    1103 04225000
         BR    @14                                                 1103 04226000
*                                                                  1104 04227000
*   /*****************************************************************/ 04228000
*   /*                                                               */ 04229000
*   /* SEPARATOR FLUSH ROUTINE                                       */ 04230000
*   /*                                                               */ 04231000
*   /*****************************************************************/ 04232000
*                                                                  1104 04233000
*SKIPSEPS:                                                         1104 04234000
*   PROC;                                                          1104 04235000
SKIPSEPS STM   @14,@12,12(@13)                                     1104 04236000
*   SEPS=YES;                       /* SKIP ALL DELIMETERS           */ 04237000
         OI    SEPS(COMONPTR),B'10000000'                          1105 04238000
*   WORDPTR=BUFBASE;                /* POINT TO BUFFER               */ 04239000
         L     @15,BUFBASE(,COMONPTR)                              1106 04240000
         ST    @15,WORDPTR                                         1106 04241000
*   WI=I;                           /* GET I                         */ 04242000
         L     @15,I(,COMONPTR)                                    1107 04243000
         ST    @15,WI                                              1107 04244000
*   DO WHILE SEPS=YES&WI<=WLL-(F4+FREEAMT);/*                        */ 04245000
         B     @DE01108                                            1108 04246000
@DL01108 DS    0H                                                  1109 04247000
*     IF W(WI)^=BLANK&W(WI)^=COMMA&W(WI)^=TAB THEN/* NOT DELIM       */ 04248000
         L     @15,WORDPTR                                         1109 04249000
         L     @14,WI                                              1109 04250000
         ALR   @14,@15                                             1109 04251000
         CLI   W-1(@14),C' '                                       1109 04252000
         BE    @RF01109                                            1109 04253000
         L     @14,WI                                              1109 04254000
         ALR   @14,@15                                             1109 04255000
         CLI   W-1(@14),C','                                       1109 04256000
         BE    @RF01109                                            1109 04257000
         L     @14,WI                                              1109 04258000
         ALR   @14,@15                                             1109 04259000
         CLI   W-1(@14),X'05'                                      1109 04260000
         BE    @RF01109                                            1109 04261000
*       IF WI<WLL-(F4+FREEAMT)&W(WI:WI+F1)=OPENCMT THEN/* CMT        */ 04262000
         L     @14,WI                                              1110 04263000
         LA    @07,4                                               1110 04264000
         L     @06,FREEAMT(,COMONPTR)                              1110 04265000
         ALR   @06,@07                                             1110 04266000
         LCR   @06,@06                                             1110 04267000
         AH    @06,WLL(,@15)                                       1110 04268000
         CR    @14,@06                                             1110 04269000
         BNL   @RF01110                                            1110 04270000
         ALR   @15,@14                                             1110 04271000
         CLC   W-1(2,@15),@CC00628                                 1110 04272000
         BNE   @RF01110                                            1110 04273000
*         DO;                       /*                               */ 04274000
*           DO WI=WI+F4 TO WLL-(F4+FREEAMT) WHILE/*                  */ 04275000
*                 W(WI-F2:WI-F1)^=CLOSCMT;/*                         */ 04276000
         ALR   @14,@07                                             1112 04277000
         B     @DE01112                                            1112 04278000
@DL01112 L     @01,WORDPTR                                         1112 04279000
         ALR   @01,@14                                             1112 04280000
         CLC   W-3(2,@01),@CC00630                                 1112 04281000
         BE    @DC01112                                            1112 04282000
*           END;                    /* FIND CLOSE COMMENT            */ 04283000
         AL    @14,@CF00042                                        1113 04284000
@DE01112 ST    @14,WI                                              1113 04285000
         LA    @15,4                                               1113 04286000
         AL    @15,FREEAMT(,COMONPTR)                              1113 04287000
         LCR   @15,@15                                             1113 04288000
         L     @01,WORDPTR                                         1113 04289000
         AH    @15,WLL(,@01)                                       1113 04290000
         CR    @14,@15                                             1113 04291000
         BNH   @DL01112                                            1113 04292000
@DC01112 DS    0H                                                  1114 04293000
*         END;                                                     1114 04294000
*       ELSE                        /* IF NOT A DELIMETER, END SKIP  */ 04295000
*         SEPS=NO;                  /*                               */ 04296000
         B     @RC01110                                            1115 04297000
@RF01110 NI    SEPS(COMONPTR),B'01111111'                          1115 04298000
*     ELSE                          /* IF A SEPARATOR, INCREMENT     */ 04299000
*       WI=WI+F1;                   /* INDEX                         */ 04300000
         B     @RC01109                                            1116 04301000
@RF01109 LA    @15,1                                               1116 04302000
         AL    @15,WI                                              1116 04303000
         ST    @15,WI                                              1116 04304000
*   END;                                                           1117 04305000
@RC01109 DS    0H                                                  1117 04306000
@DE01108 TM    SEPS(COMONPTR),B'10000000'                          1117 04307000
         BNO   @DC01108                                            1117 04308000
         LA    @15,4                                               1117 04309000
         AL    @15,FREEAMT(,COMONPTR)                              1117 04310000
         LCR   @15,@15                                             1117 04311000
         L     @14,WORDPTR                                         1117 04312000
         AH    @15,WLL(,@14)                                       1117 04313000
         C     @15,WI                                              1117 04314000
         BNL   @DL01108                                            1117 04315000
@DC01108 DS    0H                                                  1118 04316000
*   I=WI;                           /* SET I                         */ 04317000
         L     @15,WI                                              1118 04318000
         ST    @15,I(,COMONPTR)                                    1118 04319000
*   END SKIPSEPS;                                                  1119 04320000
@EL00029 DS    0H                                                  1119 04321000
@EF00029 DS    0H                                                  1119 04322000
@ER00029 LM    @14,@12,12(@13)                                     1119 04323000
         BR    @14                                                 1119 04324000
*                                                                  1120 04325000
*   /*****************************************************************/ 04326000
*   /*                                                               */ 04327000
*   /* FIND A WORD ROUTINE                                           */ 04328000
*   /*                                                               */ 04329000
*   /*****************************************************************/ 04330000
*                                                                  1120 04331000
*FINDWORD:                                                         1120 04332000
*   PROC;                                                          1120 04333000
FINDWORD STM   @14,@12,@SA00030                                    1120 04334000
*   CALL SKIPSEPS;                  /* SKIP SEPARATORS               */ 04335000
         BAL   @14,SKIPSEPS                                        1121 04336000
*SCANWORD:                                                         1122 04337000
*   ENTRY;                          /* SCANWORD ENTRY                */ 04338000
         B     @EC01122                                            1122 04339000
SCANWORD STM   @14,@12,@SA00030                                    1122 04340000
@EC01122 DS    0H                                                  1123 04341000
*   BEGIN=I;                        /* BEGIN OF KYWWORD              */ 04342000
         L     @15,I(,COMONPTR)                                    1123 04343000
         ST    @15,BEGIN(,COMONPTR)                                1123 04344000
*   WI=I;                           /* GET I                         */ 04345000
         ST    @15,WI                                              1124 04346000
*   ENDDLM=YES;                     /* INIT ENDDLM TO YES            */ 04347000
         OI    ENDDLM(COMONPTR),B'01000000'                        1125 04348000
*   WORDPTR=BUFBASE;                /* SET BASE                      */ 04349000
         L     @14,BUFBASE(,COMONPTR)                              1126 04350000
         ST    @14,WORDPTR                                         1126 04351000
*   IF SEPS=NO THEN                 /* IF ALL SEPARATORS             */ 04352000
         TM    SEPS(COMONPTR),B'10000000'                          1127 04353000
         BNZ   @RF01127                                            1127 04354000
*     DO;                                                          1128 04355000
*       DO WI=WI TO LL-(F4+FREEAMT) WHILE/* CHECK FOR VALID CHARS    */ 04356000
*             (W(WI)>=CCA&W(WI)<=CCI)|/* A TO I                      */ 04357000
*             (W(WI)>=CCJ&W(WI)<=CCR)|/* J TO R                      */ 04358000
*             (W(WI)>=CCS&W(WI)<=CCZ)|/* S TO Z                      */ 04359000
*             (WI^=BEGIN&W(WI)>=CC0&W(WI)<=CC9);/* 0 TO 9            */ 04360000
         B     @DE01129                                            1129 04361000
@DL01129 L     @14,WORDPTR                                         1129 04362000
         ALR   @15,@14                                             1129 04363000
         CLI   W-1(@15),C'A'                                       1129 04364000
         BL    @GL00076                                            1129 04365000
         L     @15,WI                                              1129 04366000
         ALR   @14,@15                                             1129 04367000
         CLI   W-1(@14),C'I'                                       1129 04368000
         BNH   @DB01129                                            1129 04369000
@GL00076 L     @15,WORDPTR                                         1129 04370000
         L     @14,WI                                              1129 04371000
         ALR   @14,@15                                             1129 04372000
         CLI   W-1(@14),C'J'                                       1129 04373000
         BL    @GL00075                                            1129 04374000
         L     @14,WI                                              1129 04375000
         ALR   @15,@14                                             1129 04376000
         CLI   W-1(@15),C'R'                                       1129 04377000
         BNH   @DB01129                                            1129 04378000
@GL00075 L     @15,WORDPTR                                         1129 04379000
         L     @14,WI                                              1129 04380000
         ALR   @14,@15                                             1129 04381000
         CLI   W-1(@14),C'S'                                       1129 04382000
         BL    @GL00074                                            1129 04383000
         L     @14,WI                                              1129 04384000
         ALR   @15,@14                                             1129 04385000
         CLI   W-1(@15),C'Z'                                       1129 04386000
         BNH   @DB01129                                            1129 04387000
@GL00074 L     @15,WI                                              1129 04388000
         C     @15,BEGIN(,COMONPTR)                                1129 04389000
         BE    @DC01129                                            1129 04390000
         L     @14,WORDPTR                                         1129 04391000
         ALR   @15,@14                                             1129 04392000
         CLI   W-1(@15),C'0'                                       1129 04393000
         BL    @DC01129                                            1129 04394000
         L     @15,WI                                              1129 04395000
         ALR   @14,@15                                             1129 04396000
         CLI   W-1(@14),C'9'                                       1129 04397000
         BH    @DC01129                                            1129 04398000
@DB01129 DS    0H                                                  1130 04399000
*       END;                        /*                               */ 04400000
         LA    @15,1                                               1130 04401000
         AL    @15,WI                                              1130 04402000
         ST    @15,WI                                              1130 04403000
@DE01129 L     @14,BUFBASE(,COMONPTR)                              1130 04404000
         LA    @07,4                                               1130 04405000
         AL    @07,FREEAMT(,COMONPTR)                              1130 04406000
         LCR   @07,@07                                             1130 04407000
         AH    @07,LL(,@14)                                        1130 04408000
         CR    @15,@07                                             1130 04409000
         BNH   @DL01129                                            1130 04410000
@DC01129 DS    0H                                                  1131 04411000
*       IF WI<=WLL-(F4+FREEAMT)&W(WI)^=BLANK&/* NOT END OF BFR AND NT*/ 04412000
*           W(WI)^=COMMA&W(WI)^=TAB&(OPCODE^=SETCODE|W(WI)^=EQUAL)&/**/ 04413000
*           (WI=WLL-(F4+FREEAMT)|W(WI:WI+F1)^=OPENCMT) THEN/* NOT CMT*/ 04414000
         L     @15,WI                                              1131 04415000
         L     @14,WORDPTR                                         1131 04416000
         LA    @07,4                                               1131 04417000
         AL    @07,FREEAMT(,COMONPTR)                              1131 04418000
         LCR   @07,@07                                             1131 04419000
         AH    @07,WLL(,@14)                                       1131 04420000
         CR    @15,@07                                             1131 04421000
         BH    @RF01131                                            1131 04422000
         ALR   @15,@14                                             1131 04423000
         CLI   W-1(@15),C' '                                       1131 04424000
         BE    @RF01131                                            1131 04425000
         L     @15,WI                                              1131 04426000
         ALR   @15,@14                                             1131 04427000
         CLI   W-1(@15),C','                                       1131 04428000
         BE    @RF01131                                            1131 04429000
         L     @15,WI                                              1131 04430000
         ALR   @15,@14                                             1131 04431000
         CLI   W-1(@15),X'05'                                      1131 04432000
         BE    @RF01131                                            1131 04433000
         L     @01,OLDLINE(,COMONPTR)                              1131 04434000
         CLI   OPCODE(@01),13                                      1131 04435000
         BNE   @GL00082                                            1131 04436000
         L     @15,WI                                              1131 04437000
         ALR   @14,@15                                             1131 04438000
         CLI   W-1(@14),C'='                                       1131 04439000
         BE    @RF01131                                            1131 04440000
@GL00082 L     @15,WI                                              1131 04441000
         L     @14,WORDPTR                                         1131 04442000
         LA    @07,4                                               1131 04443000
         AL    @07,FREEAMT(,COMONPTR)                              1131 04444000
         LCR   @07,@07                                             1131 04445000
         AH    @07,WLL(,@14)                                       1131 04446000
         CR    @15,@07                                             1131 04447000
         BE    @RT01131                                            1131 04448000
         ALR   @14,@15                                             1131 04449000
         CLC   W-1(2,@14),@CC00628                                 1131 04450000
         BE    @RF01131                                            1131 04451000
@RT01131 DS    0H                                                  1132 04452000
*         ENDDLM=NO;                /* SET NOT VALID DELIMETER       */ 04453000
         NI    ENDDLM(COMONPTR),B'10111111'                        1132 04454000
*     END;                          /*                               */ 04455000
@RF01131 DS    0H                                                  1134 04456000
*   I=WI;                           /* RESTORE I                     */ 04457000
@RF01127 L     @15,WI                                              1134 04458000
         ST    @15,I(,COMONPTR)                                    1134 04459000
*   LEN=I-BEGIN;                    /* GET LENGTH OF KYWWORD         */ 04460000
         SL    @15,BEGIN(,COMONPTR)                                1135 04461000
         ST    @15,LEN(,COMONPTR)                                  1135 04462000
*   END FINDWORD;                                                  1136 04463000
@EL00030 DS    0H                                                  1136 04464000
@EF00030 DS    0H                                                  1136 04465000
@ER00030 LM    @14,@12,@SA00030                                    1136 04466000
         BR    @14                                                 1136 04467000
*                                                                  1137 04468000
*   /*****************************************************************/ 04469000
*   /*                                                               */ 04470000
*   /* FIND A FILE ROUTINE                                           */ 04471000
*   /*                                                               */ 04472000
*   /*****************************************************************/ 04473000
*                                                                  1137 04474000
*FINDFILE:                                                         1137 04475000
*   PROC;                           /*                       @ZA17843*/ 04476000
FINDFILE STM   @14,@12,@SA00031                                    1137 04477000
*   CALL SKIPSEPS;                  /* SKIP SEPARATORS       @ZA17843*/ 04478000
         BAL   @14,SKIPSEPS                                        1138 04479000
*   BEGIN=I;                        /* BEGIN OF KYWWORD      @ZA17843*/ 04480000
         L     @15,I(,COMONPTR)                                    1139 04481000
         ST    @15,BEGIN(,COMONPTR)                                1139 04482000
*   WI=I;                           /* GET I                 @ZA17843*/ 04483000
         ST    @15,WI                                              1140 04484000
*   ENDDLM=YES;                     /* INIT ENDDLM TO YES    @ZA17843*/ 04485000
         OI    ENDDLM(COMONPTR),B'01000000'                        1141 04486000
*   WORDPTR=BUFBASE;                /* SET BASE              @ZA17843*/ 04487000
         L     @14,BUFBASE(,COMONPTR)                              1142 04488000
         ST    @14,WORDPTR                                         1142 04489000
*   IF SEPS=NO THEN                 /* IF ALL SEPARATORS     @ZA17843*/ 04490000
         TM    SEPS(COMONPTR),B'10000000'                          1143 04491000
         BNZ   @RF01143                                            1143 04492000
*     DO;                           /*                       @ZA17843*/ 04493000
*       DO WI=WI TO LL-(F4+FREEAMT) WHILE/* CHAR CHECK       @ZA17843*/ 04494000
*             (W(WI)>=CCA&W(WI)<=CCI)|/* A TO I              @ZA17843*/ 04495000
*             (W(WI)>=CCJ&W(WI)<=CCR)|/* J TO R              @ZA17843*/ 04496000
*             (W(WI)>=CCS&W(WI)<=CCZ)|/* S TO Z              @ZA17843*/ 04497000
*             (W(WI)=CC$|W(WI)=CC@|W(WI)=CC#)|/* NATIONALS   @ZA17843*/ 04498000
*             (WI^=BEGIN&W(WI)>=CC0&W(WI)<=CC9);/* 0 TO 9    @ZA17843*/ 04499000
         B     @DE01145                                            1145 04500000
@DL01145 L     @14,WORDPTR                                         1145 04501000
         ALR   @15,@14                                             1145 04502000
         CLI   W-1(@15),C'A'                                       1145 04503000
         BL    @GL00092                                            1145 04504000
         L     @15,WI                                              1145 04505000
         ALR   @14,@15                                             1145 04506000
         CLI   W-1(@14),C'I'                                       1145 04507000
         BNH   @DB01145                                            1145 04508000
@GL00092 L     @15,WORDPTR                                         1145 04509000
         L     @14,WI                                              1145 04510000
         ALR   @14,@15                                             1145 04511000
         CLI   W-1(@14),C'J'                                       1145 04512000
         BL    @GL00091                                            1145 04513000
         L     @14,WI                                              1145 04514000
         ALR   @15,@14                                             1145 04515000
         CLI   W-1(@15),C'R'                                       1145 04516000
         BNH   @DB01145                                            1145 04517000
@GL00091 L     @15,WORDPTR                                         1145 04518000
         L     @14,WI                                              1145 04519000
         ALR   @14,@15                                             1145 04520000
         CLI   W-1(@14),C'S'                                       1145 04521000
         BL    @GL00090                                            1145 04522000
         L     @14,WI                                              1145 04523000
         ALR   @15,@14                                             1145 04524000
         CLI   W-1(@15),C'Z'                                       1145 04525000
         BNH   @DB01145                                            1145 04526000
@GL00090 L     @15,WORDPTR                                         1145 04527000
         L     @14,WI                                              1145 04528000
         ALR   @14,@15                                             1145 04529000
         CLI   W-1(@14),C'$'                                       1145 04530000
         BE    @DB01145                                            1145 04531000
         L     @14,WI                                              1145 04532000
         ALR   @14,@15                                             1145 04533000
         CLI   W-1(@14),C'@'                                       1145 04534000
         BE    @DB01145                                            1145 04535000
         L     @14,WI                                              1145 04536000
         ALR   @14,@15                                             1145 04537000
         CLI   W-1(@14),C'#'                                       1145 04538000
         BE    @DB01145                                            1145 04539000
         L     @14,WI                                              1145 04540000
         C     @14,BEGIN(,COMONPTR)                                1145 04541000
         BE    @DC01145                                            1145 04542000
         ALR   @14,@15                                             1145 04543000
         CLI   W-1(@14),C'0'                                       1145 04544000
         BL    @DC01145                                            1145 04545000
         L     @14,WI                                              1145 04546000
         ALR   @15,@14                                             1145 04547000
         CLI   W-1(@15),C'9'                                       1145 04548000
         BH    @DC01145                                            1145 04549000
@DB01145 DS    0H                                                  1146 04550000
*       END;                        /*                       @ZA17843*/ 04551000
         LA    @15,1                                               1146 04552000
         AL    @15,WI                                              1146 04553000
         ST    @15,WI                                              1146 04554000
@DE01145 L     @14,BUFBASE(,COMONPTR)                              1146 04555000
         LA    @07,4                                               1146 04556000
         AL    @07,FREEAMT(,COMONPTR)                              1146 04557000
         LCR   @07,@07                                             1146 04558000
         AH    @07,LL(,@14)                                        1146 04559000
         CR    @15,@07                                             1146 04560000
         BNH   @DL01145                                            1146 04561000
@DC01145 DS    0H                                                  1147 04562000
*       IF WI<=WLL-(F4+FREEAMT)&W(WI)^=BLANK&/* BUFFER END?  @ZA17843*/ 04563000
*           W(WI)^=COMMA&W(WI)^=TAB&(OPCODE^=SETCODE|W(WI)^=EQUAL)&/**/ 04564000
*           (WI=WLL-(F4+FREEAMT)|W(WI:WI+F1)^=OPENCMT) THEN/*      1147 04565000
*                                                            @ZA17843*/ 04566000
         L     @15,WI                                              1147 04567000
         L     @14,WORDPTR                                         1147 04568000
         LA    @07,4                                               1147 04569000
         AL    @07,FREEAMT(,COMONPTR)                              1147 04570000
         LCR   @07,@07                                             1147 04571000
         AH    @07,WLL(,@14)                                       1147 04572000
         CR    @15,@07                                             1147 04573000
         BH    @RF01147                                            1147 04574000
         ALR   @15,@14                                             1147 04575000
         CLI   W-1(@15),C' '                                       1147 04576000
         BE    @RF01147                                            1147 04577000
         L     @15,WI                                              1147 04578000
         ALR   @15,@14                                             1147 04579000
         CLI   W-1(@15),C','                                       1147 04580000
         BE    @RF01147                                            1147 04581000
         L     @15,WI                                              1147 04582000
         ALR   @15,@14                                             1147 04583000
         CLI   W-1(@15),X'05'                                      1147 04584000
         BE    @RF01147                                            1147 04585000
         L     @01,OLDLINE(,COMONPTR)                              1147 04586000
         CLI   OPCODE(@01),13                                      1147 04587000
         BNE   @GL00100                                            1147 04588000
         L     @15,WI                                              1147 04589000
         ALR   @14,@15                                             1147 04590000
         CLI   W-1(@14),C'='                                       1147 04591000
         BE    @RF01147                                            1147 04592000
@GL00100 L     @15,WI                                              1147 04593000
         L     @14,WORDPTR                                         1147 04594000
         LA    @07,4                                               1147 04595000
         AL    @07,FREEAMT(,COMONPTR)                              1147 04596000
         LCR   @07,@07                                             1147 04597000
         AH    @07,WLL(,@14)                                       1147 04598000
         CR    @15,@07                                             1147 04599000
         BE    @RT01147                                            1147 04600000
         ALR   @14,@15                                             1147 04601000
         CLC   W-1(2,@14),@CC00628                                 1147 04602000
         BE    @RF01147                                            1147 04603000
@RT01147 DS    0H                                                  1148 04604000
*         ENDDLM=NO;                /* SET NOT VALID DELIMET @ZA17843*/ 04605000
         NI    ENDDLM(COMONPTR),B'10111111'                        1148 04606000
*     END;                          /*                       @ZA17843*/ 04607000
@RF01147 DS    0H                                                  1150 04608000
*   I=WI;                           /* RESTORE I             @ZA17843*/ 04609000
@RF01143 L     @15,WI                                              1150 04610000
         ST    @15,I(,COMONPTR)                                    1150 04611000
*   LEN=I-BEGIN;                    /* GET LENGTH OF KYWWORD @ZA17843*/ 04612000
         SL    @15,BEGIN(,COMONPTR)                                1151 04613000
         ST    @15,LEN(,COMONPTR)                                  1151 04614000
*   END FINDFILE;                   /*                       @ZA17843*/ 04615000
@EL00031 DS    0H                                                  1152 04616000
@EF00031 DS    0H                                                  1152 04617000
@ER00031 LM    @14,@12,@SA00031                                    1152 04618000
         BR    @14                                                 1152 04619000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 04620000
*     GPR15F FIXED(31) REG(15),                                    1153 04621000
*     GPR01P PTR(31) REG(1);                                       1153 04622000
*   DECLARE                         /* COMMON VARIABLES              */ 04623000
*     I256C CHAR(256) BASED,                                       1154 04624000
*     I031F FIXED(31) BASED,                                       1154 04625000
*     I031P PTR(31) BASED,                                         1154 04626000
*     I015F FIXED(15) BASED,                                       1154 04627000
*     I015P PTR(15) BASED,                                         1154 04628000
*     I008P PTR(8) BASED,                                          1154 04629000
*     I001C CHAR(1) BASED;                                         1154 04630000
*   END IKJCT433                                                   1155 04631000
*                                                                  1155 04632000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04633000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */ 04634000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 04635000
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */ 04636000
*/*%INCLUDE SYSLIB  (IKJEXEC )                                       */ 04637000
*                                                                  1155 04638000
*       ;                                                          1155 04639000
@DATA    DS    0H                                                       04640000
@SM01094 MVC   STFLUSH(0),STACKL                                        04641000
@SM01100 MVC   OUTCD(0),SVTDATA(@15)                                    04642000
@SM01102 MVC   0(0,@01),SVTDATA(@15)                                    04643000
@SM01104 MVC   0(0,@14),ANSWER(@01)                                     04644000
@SC01106 CLC   0(0,@06),C(@01)                                          04645000
@SC01109 CLC   NAME(0,@06),SNTDATA(@14)                                 04646000
@SM01111 MVC   SNTDATA(0,@07),NAME(@04)                                 04647000
@SC01113 CLC   SVTDATA(0,@15),OUTA1                                     04648000
         DS    0F                                                       04649000
@AL00155 DC    A(@CC00645)             LIST WITH   3 ARGUMENT(S)        04650000
         DC    A(@CF00208)                                              04651000
         DC    A(@CF00439)                                              04652000
@AL00411 EQU   *                       LIST WITH   3 ARGUMENT(S)        04653000
@AL01048 DC    A(@CC00643)             LIST WITH   3 ARGUMENT(S)        04654000
         DC    A(@CF00248)                                              04655000
         DC    A(@CF00439)                                              04656000
@AL01052 DC    A(@CC00641)             LIST WITH   3 ARGUMENT(S)        04657000
         DC    A(@CF00052)                                              04658000
         DC    A(@CF00439)                                              04659000
@DATD    DSECT                                                          04660000
         DS    0F                                                       04661000
@SA00001 DS    18F                                                      04662000
@PC00001 DS    6F                                                       04663000
@SA00028 DS    15F                                                      04664000
@SA00015 DS    15F                                                      04665000
@SA00008 DS    18F                                                      04666000
@SA00012 DS    15F                                                      04667000
@SA00013 DS    15F                                                      04668000
@SA00014 DS    15F                                                      04669000
@SA00016 DS    15F                                                      04670000
@SA00030 DS    15F                                                      04671000
@SA00026 DS    18F                                                      04672000
@PC00026 DS    2F                                                       04673000
@SA00021 DS    15F                                                      04674000
@PC00021 DS    3F                                                       04675000
@PC00024 DS    2F                                                       04676000
@SA00031 DS    15F                                                      04677000
@PC00007 DS    1F                                                       04678000
@SA00025 DS    15F                                                      04679000
@PC00005 DS    1F                                                       04680000
@SA00027 DS    15F                                                      04681000
@SA00004 DS    15F                                                      04682000
@SA00003 DS    18F                                                      04683000
@SA00011 DS    15F                                                      04684000
@SA00020 DS    18F                                                      04685000
@AL00001 DS    5A                                                       04686000
@AFTEMPS DS    2F                                                       04687000
IKJCT433 CSECT                                                          04688000
         DS    0F                                                       04689000
@CF00439 DC    F'0'                                                     04690000
@CF00042 DC    F'1'                                                     04691000
@CF00062 DC    F'2'                                                     04692000
@CF00054 DC    F'3'                                                     04693000
@CF00107 DC    F'4'                                                     04694000
@CH00107 EQU   @CF00107+2                                               04695000
@CF00052 DC    F'5'                                                     04696000
@CH00052 EQU   @CF00052+2                                               04697000
@CF00248 DC    F'6'                                                     04698000
@CF00208 DC    F'7'                                                     04699000
@CF00094 DC    F'8'                                                     04700000
@CF00174 DC    F'10'                                                    04701000
@CF00216 DC    F'12'                                                    04702000
@CH00216 EQU   @CF00216+2                                               04703000
@CF00104 DC    F'16'                                                    04704000
@CF00255 DC    F'20'                                                    04705000
@CF00059 DC    F'31'                                                    04706000
@CF00288 DC    F'57'                                                    04707000
@CF00353 DC    F'200'                                                   04708000
@CF00419 DC    F'220'                                                   04709000
@CF00402 DC    F'249'                                                   04710000
@CF00433 DC    F'252'                                                   04711000
@CF00741 DC    F'300'                                                   04712000
@CF00747 DC    F'312'                                                   04713000
@CF00781 DC    F'900'                                                   04714000
@CF00783 DC    F'904'                                                   04715000
@CF00785 DC    F'908'                                                   04716000
@CF00787 DC    F'912'                                                   04717000
@CF00789 DC    F'916'                                                   04718000
@CF00791 DC    F'920'                                                   04719000
@CF00793 DC    F'924'                                                   04720000
@CF00797 DC    F'932'                                                   04721000
@CF00799 DC    F'936'                                                   04722000
@CF00801 DC    F'940'                                                   04723000
@CF00803 DC    F'944'                                                   04724000
@CF00811 DC    F'960'                                                   04725000
@CF00817 DC    F'999'                                                   04726000
@CF00725 DC    F'4096'                                                  04727000
@CF01096 DC    F'-10'                                                   04728000
@CF01097 DC    F'-8'                                                    04729000
@CF01099 DC    F'-6'                                                    04730000
@CF00097 DC    XL4'80000000'                                            04731000
@CF00622 DC    XL4'40000000'                                            04732000
@DATD    DSECT                                                          04733000
         DS    0D                                                       04734000
ECTPTR   DS    A                                                        04735000
WORDPTR  DS    A                                                        04736000
SNTSAVE  DS    A                                                        04737000
KPTR     DS    A                                                        04738000
K        DS    A                                                        04739000
UPTPTR   DS    A                                                        04740000
INSRTDA  DS    A                                                        04741000
RETURNCD DS    F                                                        04742000
ERROR    DS    F                                                        04743000
INDEX    DS    F                                                        04744000
NEWLNG   DS    F                                                        04745000
LEN1     DS    F                                                        04746000
WI       DS    F                                                        04747000
M        DS    F                                                        04748000
N        DS    F                                                        04749000
Z        DS    F                                                        04750000
ERRSAV   DS    F                                                        04751000
INSRTLN  DS    F                                                        04752000
V1       DS    F                                                        04753000
V2       DS    F                                                        04754000
YEAR     DS    F                                                        04755000
MONTH    DS    F                                                        04756000
DAYS     DS    F                                                        04757000
PCTR     DS    F                                                        04758000
V        DS    F                                                        04759000
SCANLIM  DS    F                                                        04760000
HOWMUCH  DS    F                                                        04761000
ECDACBLK DS    AL4                                                      04762000
         ORG   ECDACBLK                                                 04763000
@NM00003 DS    AL1                                                      04764000
ECDACBK2 DS    AL3                                                      04765000
         ORG   ECDACBLK+4                                               04766000
SNTABPTR DS    A                                                        04767000
SVTABPTR DS    A                                                        04768000
NDX      DS    F                                                        04769000
@TS00001 DS    CL15                                                     04770000
OUTA1    DS    CL17                                                     04771000
AREA     DS    CL16                                                     04772000
CSAVE    DS    CL2                                                      04773000
         DS    CL2                                                      04774000
WORKAREA DS    CL8                                                      04775000
FRELST   DS    CL10                                                     04776000
         ORG   FRELST                                                   04777000
FRELST01 DS    AL1                                                      04778000
FRELST02 DS    AL3                                                      04779000
FRELST03 DS    AL1                                                      04780000
FRELST04 DS    AL3                                                      04781000
FRELST05 DS    BL1                                                      04782000
FRELST06 DS    AL1                                                      04783000
         ORG   FRELST+10                                                04784000
         DS    CL2                                                      04785000
GETLST   DS    CL10                                                     04786000
         ORG   GETLST                                                   04787000
GETLST01 DS    AL4                                                      04788000
GETLST02 DS    CL1                                                      04789000
GETLST03 DS    AL3                                                      04790000
GETLST04 DS    CL1                                                      04791000
GETLST05 DS    AL1                                                      04792000
         ORG   GETLST+10                                                04793000
         DS    CL2                                                      04794000
MYSEG    DS    CL35                                                     04795000
         ORG   MYSEG                                                    04796000
@NM00001 DS    FL4                                                      04797000
@NM00002 DS    CL26                                                     04798000
OUTCD    DS    CL5                                                      04799000
         ORG   MYSEG+35                                                 04800000
TIMEDATE DS    CL8                                                      04801000
         ORG   TIMEDATE                                                 04802000
OUT1     DS    CL2                                                      04803000
DELIM1   DS    CL1                                                      04804000
OUT2     DS    CL2                                                      04805000
DELIM2   DS    CL1                                                      04806000
OUT3     DS    CL2                                                      04807000
         ORG   TIMEDATE+8                                               04808000
         DS    CL1                                                      04809000
OLD      DS    5A                                                       04810000
OLD2     DS    3A                                                       04811000
FREEADDR DS    2F                                                       04812000
FREELEN  DS    2F                                                       04813000
IKJCT433 CSECT                                                          04814000
         DS    0F                                                       04815000
@SIZDATD DC    AL1(1)                                                   04816000
         DC    AL3(@ENDDATD-@DATD)                                      04817000
@CV00098 DC    V(IKJCT434)                                              04818000
@CV00099 DC    V(IKJCT436)                                              04819000
@CV00100 DC    V(IKJEFT30)                                              04820000
@CV00101 DC    V(IKJEFT40)                                              04821000
@CA00229 DC    A(ALSO)                                                  04822000
@CA00230 DC    A(MSTRLV2)                                               04823000
@CA00231 DC    A(MSGTABL)                                               04824000
@CV00102 DC    V(IKJEFT55)                                              04825000
         DS    0D                                                       04826000
@CC00619 DC    C'0000000000000000'                                      04827000
@CC00645 DC    C'SYSSCAN'                                               04828000
@CC00643 DC    C'LASTCC'                                                04829000
@CC00641 DC    C'MAXCC'                                                 04830000
@CC00727 DC    C'THEN'                                                  04831000
@CC00628 DC    C'/*'                                                    04832000
@CC00630 DC    C'*/'                                                    04833000
@CC00632 DC    C'X='                                                    04834000
@CC00662 DC    C'&&&&'                                                  04835000
@CB00664 DC    X'1010'                                                  04836000
CHR      DC    CL4'CHAR'                                                04837000
NUM      DC    CL3'NUM'                                                 04838000
TRTABUP  DS    CL256                                                    04839000
         ORG   TRTABUP                                                  04840000
@NM00011 DC    AL1(64)                                                  04841000
         DC    AL1(77)                                                  04842000
         DC    AL1(93)                                                  04843000
         DC    AL1(80)                                                  04844000
         DC    AL1(4)                                                   04845000
         DC    AL1(5)                                                   04846000
         DC    AL1(6)                                                   04847000
         DC    AL1(7)                                                   04848000
         DC    AL1(8)                                                   04849000
         DC    AL1(9)                                                   04850000
         DC    AL1(10)                                                  04851000
         DC    AL1(11)                                                  04852000
         DC    AL1(76)                                                  04853000
         DC    AL1(77)                                                  04854000
         DC    AL1(78)                                                  04855000
         DC    AL1(79)                                                  04856000
         DC    AL1(80)                                                  04857000
         DC    AL1(17)                                                  04858000
         DC    AL1(18)                                                  04859000
         DC    AL1(19)                                                  04860000
         DC    AL1(20)                                                  04861000
         DC    AL1(21)                                                  04862000
         DC    AL1(22)                                                  04863000
         DC    AL1(23)                                                  04864000
         DC    AL1(24)                                                  04865000
         DC    AL1(25)                                                  04866000
         DC    AL1(26)                                                  04867000
         DC    AL1(27)                                                  04868000
         DC    AL1(92)                                                  04869000
         DC    AL1(93)                                                  04870000
         DC    AL1(30)                                                  04871000
         DC    AL1(95)                                                  04872000
         DC    AL1(96)                                                  04873000
         DC    AL1(97)                                                  04874000
         DC    AL1(34)                                                  04875000
         DC    AL1(35)                                                  04876000
         DC    AL1(36)                                                  04877000
         DC    AL1(37)                                                  04878000
         DC    AL1(38)                                                  04879000
         DC    AL1(39)                                                  04880000
         DC    AL1(40)                                                  04881000
         DC    AL1(41)                                                  04882000
         DC    AL1(42)                                                  04883000
         DC    AL1(107)                                                 04884000
         DC    AL1(44)                                                  04885000
         DC    AL1(45)                                                  04886000
         DC    AL1(110)                                                 04887000
         DC    AL1(47)                                                  04888000
         DC    AL1(48)                                                  04889000
         DC    AL1(49)                                                  04890000
         DC    AL1(50)                                                  04891000
         DC    AL1(51)                                                  04892000
         DC    AL1(52)                                                  04893000
         DC    AL1(53)                                                  04894000
         DC    AL1(54)                                                  04895000
         DC    AL1(55)                                                  04896000
         DC    AL1(56)                                                  04897000
         DC    AL1(57)                                                  04898000
         DC    AL1(58)                                                  04899000
         DC    AL1(59)                                                  04900000
         DC    AL1(60)                                                  04901000
         DC    AL1(61)                                                  04902000
         DC    AL1(126)                                                 04903000
         DC    AL1(63)                                                  04904000
         DC    AL1(64)                                                  04905000
         DC    AL1(65)                                                  04906000
         DC    AL1(66)                                                  04907000
         DC    AL1(67)                                                  04908000
         DC    AL1(68)                                                  04909000
         DC    AL1(69)                                                  04910000
         DC    AL1(70)                                                  04911000
         DC    AL1(71)                                                  04912000
         DC    AL1(72)                                                  04913000
         DC    AL1(73)                                                  04914000
         DC    AL1(74)                                                  04915000
         DC    AL1(75)                                                  04916000
         DC    AL1(76)                                                  04917000
         DC    AL1(77)                                                  04918000
         DC    AL1(78)                                                  04919000
         DC    AL1(79)                                                  04920000
         DC    AL1(80)                                                  04921000
         DC    AL1(81)                                                  04922000
         DC    AL1(82)                                                  04923000
         DC    AL1(83)                                                  04924000
         DC    AL1(84)                                                  04925000
         DC    AL1(85)                                                  04926000
         DC    AL1(86)                                                  04927000
         DC    AL1(87)                                                  04928000
         DC    AL1(88)                                                  04929000
         DC    AL1(89)                                                  04930000
         DC    AL1(90)                                                  04931000
         DC    AL1(91)                                                  04932000
         DC    AL1(92)                                                  04933000
         DC    AL1(93)                                                  04934000
         DC    AL1(94)                                                  04935000
         DC    AL1(95)                                                  04936000
         DC    AL1(96)                                                  04937000
         DC    AL1(97)                                                  04938000
         DC    AL1(98)                                                  04939000
         DC    AL1(99)                                                  04940000
         DC    AL1(100)                                                 04941000
         DC    AL1(101)                                                 04942000
         DC    AL1(102)                                                 04943000
         DC    AL1(103)                                                 04944000
         DC    AL1(104)                                                 04945000
         DC    AL1(105)                                                 04946000
         DC    AL1(106)                                                 04947000
         DC    AL1(107)                                                 04948000
         DC    AL1(108)                                                 04949000
         DC    AL1(109)                                                 04950000
         DC    AL1(110)                                                 04951000
         DC    AL1(111)                                                 04952000
         DC    AL1(112)                                                 04953000
         DC    AL1(113)                                                 04954000
         DC    AL1(114)                                                 04955000
         DC    AL1(115)                                                 04956000
         DC    AL1(116)                                                 04957000
         DC    AL1(117)                                                 04958000
         DC    AL1(118)                                                 04959000
         DC    AL1(119)                                                 04960000
         DC    AL1(120)                                                 04961000
         DC    AL1(121)                                                 04962000
         DC    AL1(122)                                                 04963000
         DC    AL1(123)                                                 04964000
         DC    AL1(124)                                                 04965000
         DC    AL1(125)                                                 04966000
         DC    AL1(126)                                                 04967000
         DC    AL1(127)                                                 04968000
         DC    AL1(128)                                                 04969000
         DC    AL1(193)                                                 04970000
         DC    AL1(194)                                                 04971000
         DC    AL1(195)                                                 04972000
         DC    AL1(196)                                                 04973000
         DC    AL1(197)                                                 04974000
         DC    AL1(198)                                                 04975000
         DC    AL1(199)                                                 04976000
         DC    AL1(200)                                                 04977000
         DC    AL1(201)                                                 04978000
         DC    AL1(138)                                                 04979000
         DC    AL1(139)                                                 04980000
         DC    AL1(140)                                                 04981000
         DC    AL1(141)                                                 04982000
         DC    AL1(142)                                                 04983000
         DC    AL1(143)                                                 04984000
         DC    AL1(144)                                                 04985000
         DC    AL1(209)                                                 04986000
         DC    AL1(210)                                                 04987000
         DC    AL1(211)                                                 04988000
         DC    AL1(212)                                                 04989000
         DC    AL1(213)                                                 04990000
         DC    AL1(214)                                                 04991000
         DC    AL1(215)                                                 04992000
         DC    AL1(216)                                                 04993000
         DC    AL1(217)                                                 04994000
         DC    AL1(154)                                                 04995000
         DC    AL1(155)                                                 04996000
         DC    AL1(156)                                                 04997000
         DC    AL1(157)                                                 04998000
         DC    AL1(158)                                                 04999000
         DC    AL1(159)                                                 05000000
         DC    AL1(160)                                                 05001000
         DC    AL1(161)                                                 05002000
         DC    AL1(226)                                                 05003000
         DC    AL1(227)                                                 05004000
         DC    AL1(228)                                                 05005000
         DC    AL1(229)                                                 05006000
         DC    AL1(230)                                                 05007000
         DC    AL1(231)                                                 05008000
         DC    AL1(232)                                                 05009000
         DC    AL1(233)                                                 05010000
         DC    AL1(170)                                                 05011000
         DC    AL1(171)                                                 05012000
         DC    AL1(172)                                                 05013000
         DC    AL1(173)                                                 05014000
         DC    AL1(174)                                                 05015000
         DC    AL1(175)                                                 05016000
         DC    AL1(240)                                                 05017000
         DC    AL1(241)                                                 05018000
         DC    AL1(242)                                                 05019000
         DC    AL1(243)                                                 05020000
         DC    AL1(244)                                                 05021000
         DC    AL1(245)                                                 05022000
         DC    AL1(246)                                                 05023000
         DC    AL1(247)                                                 05024000
         DC    AL1(248)                                                 05025000
         DC    AL1(249)                                                 05026000
         DC    AL1(186)                                                 05027000
         DC    AL1(187)                                                 05028000
         DC    AL1(188)                                                 05029000
         DC    AL1(189)                                                 05030000
         DC    AL1(190)                                                 05031000
         DC    AL1(191)                                                 05032000
         DC    AL1(192)                                                 05033000
         DC    AL1(193)                                                 05034000
         DC    AL1(194)                                                 05035000
         DC    AL1(195)                                                 05036000
         DC    AL1(196)                                                 05037000
         DC    AL1(197)                                                 05038000
         DC    AL1(198)                                                 05039000
         DC    AL1(199)                                                 05040000
         DC    AL1(200)                                                 05041000
         DC    AL1(201)                                                 05042000
         DC    AL1(202)                                                 05043000
         DC    AL1(203)                                                 05044000
         DC    AL1(204)                                                 05045000
         DC    AL1(205)                                                 05046000
         DC    AL1(206)                                                 05047000
         DC    AL1(207)                                                 05048000
         DC    AL1(208)                                                 05049000
         DC    AL1(209)                                                 05050000
         DC    AL1(210)                                                 05051000
         DC    AL1(211)                                                 05052000
         DC    AL1(212)                                                 05053000
         DC    AL1(213)                                                 05054000
         DC    AL1(214)                                                 05055000
         DC    AL1(215)                                                 05056000
         DC    AL1(216)                                                 05057000
         DC    AL1(217)                                                 05058000
         DC    AL1(218)                                                 05059000
         DC    AL1(219)                                                 05060000
         DC    AL1(220)                                                 05061000
         DC    AL1(221)                                                 05062000
         DC    AL1(222)                                                 05063000
         DC    AL1(223)                                                 05064000
         DC    AL1(224)                                                 05065000
         DC    AL1(225)                                                 05066000
         DC    AL1(226)                                                 05067000
         DC    AL1(227)                                                 05068000
         DC    AL1(228)                                                 05069000
         DC    AL1(229)                                                 05070000
         DC    AL1(230)                                                 05071000
         DC    AL1(231)                                                 05072000
         DC    AL1(232)                                                 05073000
         DC    AL1(233)                                                 05074000
         DC    AL1(234)                                                 05075000
         DC    AL1(235)                                                 05076000
         DC    AL1(236)                                                 05077000
         DC    AL1(237)                                                 05078000
         DC    AL1(238)                                                 05079000
         DC    AL1(239)                                                 05080000
         DC    AL1(240)                                                 05081000
         DC    AL1(241)                                                 05082000
         DC    AL1(242)                                                 05083000
         DC    AL1(243)                                                 05084000
         DC    AL1(244)                                                 05085000
         DC    AL1(245)                                                 05086000
         DC    AL1(246)                                                 05087000
         DC    AL1(247)                                                 05088000
         DC    AL1(248)                                                 05089000
         DC    AL1(249)                                                 05090000
         DC    AL1(250)                                                 05091000
         DC    AL1(251)                                                 05092000
         DC    AL1(252)                                                 05093000
         DC    AL1(253)                                                 05094000
         DC    AL1(254)                                                 05095000
         DC    AL1(255)                                                 05096000
         ORG   TRTABUP+256                                              05097000
TRTABDN  DS    CL256                                                    05098000
         ORG   TRTABDN                                                  05099000
@NM00012 DC    AL1(0)                                                   05100000
         DC    AL1(1)                                                   05101000
         DC    AL1(2)                                                   05102000
         DC    AL1(3)                                                   05103000
         DC    AL1(4)                                                   05104000
         DC    AL1(5)                                                   05105000
         DC    AL1(6)                                                   05106000
         DC    AL1(7)                                                   05107000
         DC    AL1(8)                                                   05108000
         DC    AL1(9)                                                   05109000
         DC    AL1(10)                                                  05110000
         DC    AL1(11)                                                  05111000
         DC    AL1(12)                                                  05112000
         DC    AL1(13)                                                  05113000
         DC    AL1(14)                                                  05114000
         DC    AL1(15)                                                  05115000
         DC    AL1(16)                                                  05116000
         DC    AL1(17)                                                  05117000
         DC    AL1(18)                                                  05118000
         DC    AL1(19)                                                  05119000
         DC    AL1(20)                                                  05120000
         DC    AL1(21)                                                  05121000
         DC    AL1(22)                                                  05122000
         DC    AL1(23)                                                  05123000
         DC    AL1(24)                                                  05124000
         DC    AL1(25)                                                  05125000
         DC    AL1(26)                                                  05126000
         DC    AL1(27)                                                  05127000
         DC    AL1(28)                                                  05128000
         DC    AL1(29)                                                  05129000
         DC    AL1(30)                                                  05130000
         DC    AL1(31)                                                  05131000
         DC    AL1(32)                                                  05132000
         DC    AL1(33)                                                  05133000
         DC    AL1(34)                                                  05134000
         DC    AL1(35)                                                  05135000
         DC    AL1(36)                                                  05136000
         DC    AL1(37)                                                  05137000
         DC    AL1(38)                                                  05138000
         DC    AL1(39)                                                  05139000
         DC    AL1(40)                                                  05140000
         DC    AL1(41)                                                  05141000
         DC    AL1(42)                                                  05142000
         DC    AL1(43)                                                  05143000
         DC    AL1(44)                                                  05144000
         DC    AL1(45)                                                  05145000
         DC    AL1(46)                                                  05146000
         DC    AL1(47)                                                  05147000
         DC    AL1(48)                                                  05148000
         DC    AL1(49)                                                  05149000
         DC    AL1(50)                                                  05150000
         DC    AL1(51)                                                  05151000
         DC    AL1(52)                                                  05152000
         DC    AL1(53)                                                  05153000
         DC    AL1(54)                                                  05154000
         DC    AL1(55)                                                  05155000
         DC    AL1(56)                                                  05156000
         DC    AL1(57)                                                  05157000
         DC    AL1(58)                                                  05158000
         DC    AL1(59)                                                  05159000
         DC    AL1(60)                                                  05160000
         DC    AL1(61)                                                  05161000
         DC    AL1(62)                                                  05162000
         DC    AL1(63)                                                  05163000
         DC    AL1(0)                                                   05164000
         DC    AL1(65)                                                  05165000
         DC    AL1(66)                                                  05166000
         DC    AL1(67)                                                  05167000
         DC    AL1(68)                                                  05168000
         DC    AL1(69)                                                  05169000
         DC    AL1(70)                                                  05170000
         DC    AL1(71)                                                  05171000
         DC    AL1(72)                                                  05172000
         DC    AL1(73)                                                  05173000
         DC    AL1(74)                                                  05174000
         DC    AL1(75)                                                  05175000
         DC    AL1(12)                                                  05176000
         DC    AL1(13)                                                  05177000
         DC    AL1(14)                                                  05178000
         DC    AL1(15)                                                  05179000
         DC    AL1(16)                                                  05180000
         DC    AL1(81)                                                  05181000
         DC    AL1(82)                                                  05182000
         DC    AL1(83)                                                  05183000
         DC    AL1(84)                                                  05184000
         DC    AL1(85)                                                  05185000
         DC    AL1(86)                                                  05186000
         DC    AL1(87)                                                  05187000
         DC    AL1(88)                                                  05188000
         DC    AL1(89)                                                  05189000
         DC    AL1(90)                                                  05190000
         DC    AL1(91)                                                  05191000
         DC    AL1(28)                                                  05192000
         DC    AL1(29)                                                  05193000
         DC    AL1(94)                                                  05194000
         DC    AL1(31)                                                  05195000
         DC    AL1(32)                                                  05196000
         DC    AL1(33)                                                  05197000
         DC    AL1(98)                                                  05198000
         DC    AL1(99)                                                  05199000
         DC    AL1(100)                                                 05200000
         DC    AL1(101)                                                 05201000
         DC    AL1(102)                                                 05202000
         DC    AL1(103)                                                 05203000
         DC    AL1(104)                                                 05204000
         DC    AL1(105)                                                 05205000
         DC    AL1(106)                                                 05206000
         DC    AL1(43)                                                  05207000
         DC    AL1(108)                                                 05208000
         DC    AL1(109)                                                 05209000
         DC    AL1(46)                                                  05210000
         DC    AL1(111)                                                 05211000
         DC    AL1(112)                                                 05212000
         DC    AL1(113)                                                 05213000
         DC    AL1(114)                                                 05214000
         DC    AL1(115)                                                 05215000
         DC    AL1(116)                                                 05216000
         DC    AL1(117)                                                 05217000
         DC    AL1(118)                                                 05218000
         DC    AL1(119)                                                 05219000
         DC    AL1(120)                                                 05220000
         DC    AL1(121)                                                 05221000
         DC    AL1(122)                                                 05222000
         DC    AL1(123)                                                 05223000
         DC    AL1(124)                                                 05224000
         DC    AL1(125)                                                 05225000
         DC    AL1(62)                                                  05226000
         DC    AL1(127)                                                 05227000
         DC    AL1(128)                                                 05228000
         DC    AL1(129)                                                 05229000
         DC    AL1(130)                                                 05230000
         DC    AL1(131)                                                 05231000
         DC    AL1(132)                                                 05232000
         DC    AL1(133)                                                 05233000
         DC    AL1(134)                                                 05234000
         DC    AL1(135)                                                 05235000
         DC    AL1(136)                                                 05236000
         DC    AL1(137)                                                 05237000
         DC    AL1(138)                                                 05238000
         DC    AL1(139)                                                 05239000
         DC    AL1(140)                                                 05240000
         DC    AL1(141)                                                 05241000
         DC    AL1(142)                                                 05242000
         DC    AL1(143)                                                 05243000
         DC    AL1(144)                                                 05244000
         DC    AL1(145)                                                 05245000
         DC    AL1(146)                                                 05246000
         DC    AL1(147)                                                 05247000
         DC    AL1(148)                                                 05248000
         DC    AL1(149)                                                 05249000
         DC    AL1(150)                                                 05250000
         DC    AL1(151)                                                 05251000
         DC    AL1(152)                                                 05252000
         DC    AL1(153)                                                 05253000
         DC    AL1(154)                                                 05254000
         DC    AL1(155)                                                 05255000
         DC    AL1(156)                                                 05256000
         DC    AL1(157)                                                 05257000
         DC    AL1(158)                                                 05258000
         DC    AL1(159)                                                 05259000
         DC    AL1(160)                                                 05260000
         DC    AL1(161)                                                 05261000
         DC    AL1(162)                                                 05262000
         DC    AL1(163)                                                 05263000
         DC    AL1(164)                                                 05264000
         DC    AL1(165)                                                 05265000
         DC    AL1(166)                                                 05266000
         DC    AL1(167)                                                 05267000
         DC    AL1(168)                                                 05268000
         DC    AL1(169)                                                 05269000
         DC    AL1(170)                                                 05270000
         DC    AL1(171)                                                 05271000
         DC    AL1(172)                                                 05272000
         DC    AL1(173)                                                 05273000
         DC    AL1(174)                                                 05274000
         DC    AL1(175)                                                 05275000
         DC    AL1(176)                                                 05276000
         DC    AL1(177)                                                 05277000
         DC    AL1(178)                                                 05278000
         DC    AL1(179)                                                 05279000
         DC    AL1(180)                                                 05280000
         DC    AL1(181)                                                 05281000
         DC    AL1(182)                                                 05282000
         DC    AL1(183)                                                 05283000
         DC    AL1(184)                                                 05284000
         DC    AL1(185)                                                 05285000
         DC    AL1(186)                                                 05286000
         DC    AL1(187)                                                 05287000
         DC    AL1(188)                                                 05288000
         DC    AL1(189)                                                 05289000
         DC    AL1(190)                                                 05290000
         DC    AL1(191)                                                 05291000
         DC    AL1(192)                                                 05292000
         DC    AL1(129)                                                 05293000
         DC    AL1(130)                                                 05294000
         DC    AL1(131)                                                 05295000
         DC    AL1(132)                                                 05296000
         DC    AL1(133)                                                 05297000
         DC    AL1(134)                                                 05298000
         DC    AL1(135)                                                 05299000
         DC    AL1(136)                                                 05300000
         DC    AL1(137)                                                 05301000
         DC    AL1(202)                                                 05302000
         DC    AL1(203)                                                 05303000
         DC    AL1(204)                                                 05304000
         DC    AL1(205)                                                 05305000
         DC    AL1(206)                                                 05306000
         DC    AL1(207)                                                 05307000
         DC    AL1(208)                                                 05308000
         DC    AL1(145)                                                 05309000
         DC    AL1(146)                                                 05310000
         DC    AL1(147)                                                 05311000
         DC    AL1(148)                                                 05312000
         DC    AL1(149)                                                 05313000
         DC    AL1(150)                                                 05314000
         DC    AL1(151)                                                 05315000
         DC    AL1(152)                                                 05316000
         DC    AL1(153)                                                 05317000
         DC    AL1(218)                                                 05318000
         DC    AL1(219)                                                 05319000
         DC    AL1(220)                                                 05320000
         DC    AL1(221)                                                 05321000
         DC    AL1(222)                                                 05322000
         DC    AL1(223)                                                 05323000
         DC    AL1(224)                                                 05324000
         DC    AL1(225)                                                 05325000
         DC    AL1(162)                                                 05326000
         DC    AL1(163)                                                 05327000
         DC    AL1(164)                                                 05328000
         DC    AL1(165)                                                 05329000
         DC    AL1(166)                                                 05330000
         DC    AL1(167)                                                 05331000
         DC    AL1(168)                                                 05332000
         DC    AL1(169)                                                 05333000
         DC    AL1(234)                                                 05334000
         DC    AL1(235)                                                 05335000
         DC    AL1(236)                                                 05336000
         DC    AL1(237)                                                 05337000
         DC    AL1(238)                                                 05338000
         DC    AL1(239)                                                 05339000
         DC    AL1(176)                                                 05340000
         DC    AL1(177)                                                 05341000
         DC    AL1(178)                                                 05342000
         DC    AL1(179)                                                 05343000
         DC    AL1(180)                                                 05344000
         DC    AL1(181)                                                 05345000
         DC    AL1(182)                                                 05346000
         DC    AL1(183)                                                 05347000
         DC    AL1(184)                                                 05348000
         DC    AL1(185)                                                 05349000
         DC    AL1(250)                                                 05350000
         DC    AL1(251)                                                 05351000
         DC    AL1(252)                                                 05352000
         DC    AL1(253)                                                 05353000
         DC    AL1(254)                                                 05354000
         DC    AL1(255)                                                 05355000
         ORG   TRTABDN+256                                              05356000
         DS    CL1                                                      05357000
@NM00007 DS    CL16                                                     05358000
         ORG   @NM00007+0                                               05359000
IMMLEN   DC    AL2(3)                                                   05360000
IMMDATA  DC    CL10'STR'                                                05361000
VECTOR   DC    AL4(STRRTN)                                              05362000
         ORG   @NM00007+16                                              05363000
         ORG   @NM00007+16                                              05364000
         DC    AL2(4)                                                   05365000
         DC    CL10'EVAL'                                               05366000
         DC    AL4(EVALRTN)                                             05367000
         ORG   @NM00007+32                                              05368000
         ORG   @NM00007+32                                              05369000
         DC    AL2(6)                                                   05370000
         DC    CL10'SUBSTR'                                             05371000
         DC    AL4(SUBSTRTN)                                            05372000
         ORG   @NM00007+48                                              05373000
         ORG   @NM00007+48                                              05374000
         DC    AL2(7)                                                   05375000
         DC    CL10'SYSTIME'                                            05376000
         DC    AL4(TIMERTN)                                             05377000
         ORG   @NM00007+64                                              05378000
         ORG   @NM00007+64                                              05379000
         DC    AL2(7)                                                   05380000
         DC    CL10'SYSDATE'                                            05381000
         DC    AL4(DATERTN)                                             05382000
         ORG   @NM00007+80                                              05383000
         ORG   @NM00007+80                                              05384000
         DC    AL2(6)                                                   05385000
         DC    CL10'LENGTH'                                             05386000
         DC    AL4(LENGRTN)                                             05387000
         ORG   @NM00007+96                                              05388000
         ORG   @NM00007+96                                              05389000
         DC    AL2(8)                                                   05390000
         DC    CL10'DATATYPE'                                           05391000
         DC    AL4(DATYRTN)                                             05392000
         ORG   @NM00007+112                                             05393000
         ORG   @NM00007+112                                             05394000
         DC    AL2(7)                                                   05395000
         DC    CL10'SYSPREF'                                            05396000
         DC    AL4(PREFRTN)                                             05397000
         ORG   @NM00007+128                                             05398000
         ORG   @NM00007+128                                             05399000
         DC    AL2(7)                                                   05400000
         DC    CL10'SYSPCMD'                                            05401000
         DC    AL4(SYSPRTN)                                             05402000
         ORG   @NM00007+144                                             05403000
         ORG   @NM00007+144                                             05404000
         DC    AL2(7)                                                   05405000
         DC    CL10'SYSSCMD'                                            05406000
         DC    AL4(SYSSRTN)                                             05407000
         ORG   @NM00007+160                                             05408000
DAYIN    DC    H'31'                                                    05409000
         DC    H'28'                                                    05410000
         DC    H'31'                                                    05411000
         DC    H'30'                                                    05412000
         DC    H'31'                                                    05413000
         DC    H'30'                                                    05414000
         DC    H'31'                                                    05415000
         DC    H'31'                                                    05416000
         DC    H'30'                                                    05417000
         DC    H'31'                                                    05418000
         DC    H'30'                                                    05419000
         DC    H'31'                                                    05420000
ROUTINES DC    AL4(FINDWORD)                                            05421000
         DC    AL4(SCANWORD)                                            05422000
         DC    AL4(SKIPSEPS)                                            05423000
         DC    AL4(PRINT)                                               05424000
         DC    AL4(LOCATE)                                              05425000
         DC    AL4(GLOCATE)                                             05426000
         DC    AL4(CONVERT)                                             05427000
         DC    AL4(UPDATE)                                              05428000
         DC    AL4(FINDFILE)                                            05429000
IKJCT433 CSECT                                                          05430000
STACKL   STACK   DELETE=ALL,MF=L                                        05431000
         PUTLINE MF=L                                                   05432000
         PUTLINE MF=L                                                   05433000
         STAX    DEFER=NO,MF=L                                          05434000
         STAX    DEFER=YES,MF=L                                         05435000
MACLEN DC A(MACLEN-STACKL)                                              05436000
@DATD    DSECT                                                          05437000
STFLUSH  STACK   DELETE=ALL,MF=L                                        05438000
PLBLK    PUTLINE MF=L                                                   05439000
PUTMLVL  PUTLINE MF=L                                                   05440000
DEFERNO  STAX    DEFER=NO,MF=L                                          05441000
DEFERYES STAX    DEFER=YES,MF=L                                         05442000
IKJCT433 CSECT                                                          05443000
         DS   0H                                                        05444000
PATCH DC ((@DATA-@PSTART)/20)X'00'                                      05445000
@DATD    DSECT                                                          05446000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05447000
@ENDDATD EQU   *                                                        05448000
IKJCT433 CSECT                                                          05449000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05450000
@01      EQU   01                                                       05451000
@02      EQU   02                                                       05452000
@03      EQU   03                                                       05453000
@04      EQU   04                                                       05454000
@05      EQU   05                                                       05455000
@06      EQU   06                                                       05456000
@07      EQU   07                                                       05457000
@08      EQU   08                                                       05458000
@09      EQU   09                                                       05459000
@10      EQU   10                                                       05460000
@11      EQU   11                                                       05461000
@12      EQU   12                                                       05462000
@13      EQU   13                                                       05463000
@14      EQU   14                                                       05464000
@15      EQU   15                                                       05465000
R12      EQU   @12                                                      05466000
R11      EQU   @11                                                      05467000
R10      EQU   @10                                                      05468000
R0       EQU   @00                                                      05469000
R1       EQU   @01                                                      05470000
R2       EQU   @02                                                      05471000
R3       EQU   @03                                                      05472000
R4       EQU   @04                                                      05473000
R5       EQU   @05                                                      05474000
R9       EQU   @09                                                      05475000
R15      EQU   @15                                                      05476000
COMONPTR EQU   @08                                                      05477000
GPR01P   EQU   @01                                                      05478000
GPR15F   EQU   @15                                                      05479000
         ENTRY ROUTINES                                                 05480000
         ENTRY TRTABUP                                                  05481000
         EXTRN ALSO                                                     05482000
         EXTRN MSTRLV2                                                  05483000
         EXTRN MSGTABL                                                  05484000
INSRTCHR EQU   0                                                        05485000
ANSWER   EQU   0                                                        05486000
BUF      EQU   0                                                        05487000
ROUTINE  EQU   0                                                        05488000
@NM00005 EQU   0                                                        05489000
WLL      EQU   @NM00005                                                 05490000
W        EQU   @NM00005+4                                               05491000
UPVAL    EQU   0                                                        05492000
LCVAL    EQU   0                                                        05493000
UPT      EQU   0                                                        05494000
UPTSWS   EQU   UPT+12                                                   05495000
UPTPREFX EQU   UPT+16                                                   05496000
UPTPREFL EQU   UPT+23                                                   05497000
ECT      EQU   0                                                        05498000
ECTRCDF  EQU   ECT                                                      05499000
ECTRTCD  EQU   ECT+1                                                    05500000
ECTIOWA  EQU   ECT+4                                                    05501000
ECTPCMD  EQU   ECT+12                                                   05502000
ECTSCMD  EQU   ECT+20                                                   05503000
ECTSWS   EQU   ECT+28                                                   05504000
ECTATTN  EQU   ECTSWS                                                   05505000
ECTSWS2  EQU   ECT+40                                                   05506000
ECTSWS21 EQU   ECTSWS2                                                  05507000
LSD      EQU   0                                                        05508000
LSDADATA EQU   LSD                                                      05509000
LSDANEXT EQU   LSD+8                                                    05510000
LSDEXEC  EQU   LSD+12                                                   05511000
EXECDATA EQU   0                                                        05512000
SNTABFST EQU   EXECDATA                                                 05513000
SVTABFST EQU   EXECDATA+4                                               05514000
GEXECDAT EQU   EXECDATA+8                                               05515000
LASTTSO  EQU   EXECDATA+12                                              05516000
@NM00022 EQU   EXECDATA+16                                              05517000
ERACTSTR EQU   EXECDATA+20                                              05518000
ERACTEND EQU   EXECDATA+24                                              05519000
RETPTR   EQU   EXECDATA+28                                              05520000
EXDATFLG EQU   EXECDATA+32                                              05521000
@NM00023 EQU   EXDATFLG                                                 05522000
CONLST   EQU   @NM00023                                                 05523000
ERRCMD   EQU   @NM00023                                                 05524000
NOFLUSH  EQU   @NM00023                                                 05525000
SYMLST   EQU   @NM00023                                                 05526000
ERINCNTL EQU   @NM00023                                                 05527000
CMAIN    EQU   @NM00023                                                 05528000
NOMSG    EQU   @NM00023                                                 05529000
ATINCNTL EQU   @NM00023+1                                               05530000
NOLASTCC EQU   @NM00023+1                                               05531000
ATACTSTR EQU   EXECDATA+44                                              05532000
ATACTEND EQU   EXECDATA+48                                              05533000
RETPTR2  EQU   EXECDATA+52                                              05534000
COMPROC  EQU   0                                                        05535000
COMPRPTR EQU   COMPROC                                                  05536000
COMPRID  EQU   COMPRPTR                                                 05537000
COMPRNXT EQU   COMPRPTR+1                                               05538000
COMPRLNG EQU   COMPROC+4                                                05539000
SNTAB    EQU   0                                                        05540000
SNTABNXT EQU   SNTAB                                                    05541000
SNTABLNG EQU   SNTAB+4                                                  05542000
SNTABUSE EQU   SNTAB+8                                                  05543000
SNTELFST EQU   SNTAB+12                                                 05544000
SNTELEM  EQU   0                                                        05545000
SNTVLPTR EQU   SNTELEM                                                  05546000
SNTGVAL  EQU   SNTVLPTR                                                 05547000
SNTFLAGS EQU   SNTELEM+4                                                05548000
SNTKEYW  EQU   SNTFLAGS                                                 05549000
SNTLABEL EQU   SNTFLAGS                                                 05550000
SNTNOSCN EQU   SNTFLAGS                                                 05551000
SNTNAUTH EQU   SNTFLAGS                                                 05552000
SNTEVAL  EQU   SNTFLAGS                                                 05553000
SNTLAST  EQU   SNTFLAGS                                                 05554000
SNTGLOB  EQU   SNTFLAGS+1                                               05555000
SNTLNG   EQU   SNTELEM+6                                                05556000
SNTDATA  EQU   SNTELEM+8                                                05557000
SVTAB    EQU   0                                                        05558000
SVTABNXT EQU   SVTAB                                                    05559000
SVTABLNG EQU   SVTAB+4                                                  05560000
SVTABUSE EQU   SVTAB+8                                                  05561000
SVTABFRE EQU   SVTAB+12                                                 05562000
SVTELFST EQU   SVTAB+16                                                 05563000
SVTELEM  EQU   0                                                        05564000
SVTLNG   EQU   SVTELEM                                                  05565000
SVTORIG  EQU   SVTELEM+2                                                05566000
SVTDATA  EQU   SVTELEM+4                                                05567000
@NM00026 EQU   0                                                        05568000
LL       EQU   @NM00026                                                 05569000
OO       EQU   @NM00026+2                                               05570000
O2       EQU   @NM00026+4                                               05571000
C        EQU   O2                                                       05572000
@NM00027 EQU   0                                                        05573000
NEWLL    EQU   @NM00027                                                 05574000
NEWOO    EQU   @NM00027+2                                               05575000
NEWC     EQU   @NM00027+4                                               05576000
@NM00029 EQU   0                                                        05577000
INSCODE  EQU   @NM00029                                                 05578000
INSLIST  EQU   INSCODE                                                  05579000
INSADLSD EQU   @NM00029+1                                               05580000
@NM00032 EQU   0                                                        05581000
IOSTELM  EQU   @NM00032                                                 05582000
@NM00034 EQU   0                                                        05583000
OPCODE   EQU   @NM00034+6                                               05584000
COMAREA  EQU   0                                                        05585000
@NM00040 EQU   COMAREA                                                  05586000
IOPL     EQU   @NM00040                                                 05587000
BUFPTR   EQU   @NM00040+16                                              05588000
SNTELPTR EQU   @NM00040+20                                              05589000
EXECDPTR EQU   @NM00040+24                                              05590000
OLDLINE  EQU   @NM00040+28                                              05591000
BUFBASE  EQU   @NM00040+32                                              05592000
NEWBASE  EQU   @NM00040+36                                              05593000
LSDPTR   EQU   @NM00040+40                                              05594000
TYPE     EQU   @NM00040+44                                              05595000
CNVTANS  EQU   @NM00040+48                                              05596000
CLEN     EQU   @NM00040+52                                              05597000
MYO2     EQU   @NM00040+56                                              05598000
BEGIN    EQU   @NM00040+60                                              05599000
I        EQU   @NM00040+64                                              05600000
LEN      EQU   @NM00040+68                                              05601000
FREEAMT  EQU   @NM00040+72                                              05602000
ERCOM    EQU   @NM00040+76                                              05603000
REGAREA  EQU   @NM00040+80                                              05604000
SWSAREA  EQU   @NM00040+112                                             05605000
SW2AREA  EQU   @NM00040+117                                             05606000
I001C    EQU   0                                                        05607000
I008P    EQU   0                                                        05608000
I015F    EQU   0                                                        05609000
I015P    EQU   0                                                        05610000
I031F    EQU   0                                                        05611000
I031P    EQU   0                                                        05612000
I256C    EQU   0                                                        05613000
MSGDIM   EQU   MSGTABL                                                  05614000
@NM00009 EQU   MSGTABL+2                                                05615000
IDA      EQU   @NM00009                                                 05616000
IDC      EQU   @NM00009+2                                               05617000
@NM00010 EQU   @NM00009+4                                               05618000
SECLEVEL EQU   @NM00010                                                 05619000
MSGSEG1  EQU   @NM00009+5                                               05620000
SEGNUM   EQU   @NM00009+8                                               05621000
MSGSEG2  EQU   @NM00009+9                                               05622000
UPTX     EQU   0                                                        05623000
ECTX     EQU   0                                                        05624000
ECB      EQU   0                                                        05625000
ECBCBIT  EQU   ECB                                                      05626000
GTPB     EQU   0                                                        05627000
GTPBLINE EQU   GTPB+4                                                   05628000
PARM433  EQU   0                                                        05629000
@NM00036 EQU   PARM433                                                  05630000
PARMDEFR EQU   @NM00036                                                 05631000
EOCLIST  EQU   @NM00036                                                 05632000
UPLIST   EQU   0                                                        05633000
LCVALPTR EQU   UPLIST                                                   05634000
LCVALLEN EQU   UPLIST+4                                                 05635000
UPVALPTR EQU   UPLIST+8                                                 05636000
UPVALLEN EQU   UPLIST+12                                                05637000
MINIMUM  EQU   0                                                        05638000
NEXTCMD  EQU   0                                                        05639000
NAME     EQU   0                                                        05640000
NAML     EQU   0                                                        05641000
FUNC     EQU   0                                                        05642000
VALUE    EQU   0                                                        05643000
VALLEN   EQU   0                                                        05644000
LINEADDR EQU   0                                                        05645000
TERMPUT  EQU   0                                                        05646000
OUTFX    EQU   OUTA1                                                    05647000
NULELEM  EQU   SVTELFST                                                 05648000
ANSPTR   EQU   TYPE                                                     05649000
@NM00004 EQU   LSDANEXT                                                 05650000
CURID    EQU   @NM00004                                                 05651000
CURADDR  EQU   @NM00004+1                                               05652000
@NM00008 EQU   AREA                                                     05653000
TEMPA    EQU   @NM00008                                                 05654000
TIMEOUT  EQU   @NM00008+4                                               05655000
HRS      EQU   TIMEOUT                                                  05656000
MINUTES  EQU   TIMEOUT+2                                                05657000
SEC      EQU   TIMEOUT+4                                                05658000
DATEOUT  EQU   TIMEOUT                                                  05659000
YR       EQU   DATEOUT                                                  05660000
DYS      EQU   DATEOUT+2                                                05661000
SWS      EQU   SWSAREA                                                  05662000
EXITA    EQU   SWS                                                      05663000
EXITB    EQU   SWS                                                      05664000
FREESW   EQU   SWS                                                      05665000
WAIT     EQU   SWS                                                      05666000
RANGE    EQU   SWS                                                      05667000
LEAP     EQU   SWS                                                      05668000
ALPHA    EQU   SWS                                                      05669000
EXITC    EQU   SWS                                                      05670000
SEPS     EQU   SWS+1                                                    05671000
ENDDLM   EQU   SWS+1                                                    05672000
QUIT     EQU   SWS+1                                                    05673000
MATCH    EQU   SWS+1                                                    05674000
SYSUPDTE EQU   SWS+1                                                    05675000
NOAMPER  EQU   SWS+1                                                    05676000
INSTHEN  EQU   SWS+1                                                    05677000
SENTINAL EQU   SWS+2                                                    05678000
LISTONLY EQU   SWS+2                                                    05679000
FOLD     EQU   SWS+2                                                    05680000
LISTED   EQU   SWS+2                                                    05681000
ERRRANGE EQU   SWS+2                                                    05682000
ATRANGE  EQU   SWS+2                                                    05683000
BACKUP   EQU   SWS+2                                                    05684000
RCABEND  EQU   SWS+3                                                    05685000
NODATA   EQU   SWS+3                                                    05686000
SW2      EQU   SW2AREA                                                  05687000
CORE     EQU   SW2                                                      05688000
CONTINU  EQU   SW2                                                      05689000
RECURSE  EQU   SW2                                                      05690000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05691000
STABND   EQU   SWS+3                                                    05692000
STAECNTL EQU   SWS+3                                                    05693000
SKIP1    EQU   SWS+2                                                    05694000
SKPCOMMA EQU   SWS+1                                                    05695000
SUSPENDI EQU   PARM433+4                                                05696000
@NM00038 EQU   @NM00036+1                                               05697000
@NM00037 EQU   @NM00036                                                 05698000
EXITSTMT EQU   @NM00036                                                 05699000
@NM00028 EQU   GTPB                                                     05700000
@NM00039 EQU   ECB                                                      05701000
DYNAREA  EQU   COMAREA+300                                              05702000
SYNREGS  EQU   @NM00040+182                                             05703000
STAEREGS EQU   @NM00040+118                                             05704000
REGAREA2 EQU   @NM00040+96                                              05705000
@NM00041 EQU   @NM00040+54                                              05706000
FLSEPATH EQU   @NM00034+7                                               05707000
@NM00035 EQU   @NM00034                                                 05708000
@NM00033 EQU   @NM00032+4                                               05709000
@NM00031 EQU   INSCODE                                                  05710000
INSPROM  EQU   INSCODE                                                  05711000
INSEXEC  EQU   INSCODE                                                  05712000
@NM00030 EQU   INSCODE                                                  05713000
INSTERM  EQU   INSCODE                                                  05714000
@NM00025 EQU   SNTFLAGS+1                                               05715000
SNTKEY   EQU   SNTFLAGS                                                 05716000
SNTPOSIT EQU   SNTFLAGS                                                 05717000
COMRCDS  EQU   COMPROC+12                                               05718000
COMPRUSE EQU   COMPROC+8                                                05719000
@NM00024 EQU   EXECDATA+60                                              05720000
FILEDCBS EQU   EXECDATA+56                                              05721000
EXDLMPTR EQU   EXECDATA+40                                              05722000
GEXECCNT EQU   EXECDATA+36                                              05723000
ATTNCMD  EQU   @NM00023                                                 05724000
EXINSAVE EQU   @NM00022                                                 05725000
LSDTOTLN EQU   LSD+6                                                    05726000
LSDRCLEN EQU   LSD+4                                                    05727000
@NM00021 EQU   ECT+52                                                   05728000
@NM00020 EQU   ECT+48                                                   05729000
@NM00019 EQU   ECT+44                                                   05730000
@NM00018 EQU   ECTSWS2+1                                                05731000
@NM00017 EQU   ECTSWS21                                                 05732000
ECTTABND EQU   ECTSWS21                                                 05733000
ECTDEFCS EQU   ECTSWS21                                                 05734000
ECTBKPB  EQU   ECT+36                                                   05735000
ECTUSER  EQU   ECT+32                                                   05736000
ECTDDNUM EQU   ECT+29                                                   05737000
ECTBKGRD EQU   ECTSWS                                                   05738000
ECTNNOT  EQU   ECTSWS                                                   05739000
ECTNMAL  EQU   ECTSWS                                                   05740000
ECTLOGF  EQU   ECTSWS                                                   05741000
ECTATRM  EQU   ECTSWS                                                   05742000
@NM00016 EQU   ECTSWS                                                   05743000
ECTNOPD  EQU   ECTSWS                                                   05744000
ECTSMSG  EQU   ECT+9                                                    05745000
ECTMSGF  EQU   ECT+8                                                    05746000
@NM00015 EQU   UPT+15                                                   05747000
UPTLDEL  EQU   UPT+14                                                   05748000
UPTCDEL  EQU   UPT+13                                                   05749000
UPTWTP   EQU   UPTSWS                                                   05750000
UPTMODE  EQU   UPTSWS                                                   05751000
UPTALD   EQU   UPTSWS                                                   05752000
UPTPAUS  EQU   UPTSWS                                                   05753000
UPTNCOM  EQU   UPTSWS                                                   05754000
UPTMID   EQU   UPTSWS                                                   05755000
UPTNPRM  EQU   UPTSWS                                                   05756000
@NM00014 EQU   UPTSWS                                                   05757000
UPTUSER  EQU   UPT+2                                                    05758000
@NM00013 EQU   UPT                                                      05759000
@NM00006 EQU   @NM00005+2                                               05760000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05761000
@RT00148 EQU   FASTEXIT                                                 05762000
@RF00162 EQU   @RC00156                                                 05763000
@RC00181 EQU   @RC00174                                                 05764000
@RC00255 EQU   @RC00254                                                 05765000
@RC00289 EQU   @RC00282                                                 05766000
@RC00283 EQU   @RC00282                                                 05767000
@RF00412 EQU   @RC00404                                                 05768000
@RC00415 EQU   @RC00404                                                 05769000
@RF00440 EQU   @EL00004                                                 05770000
@RC00459 EQU   @EL00004                                                 05771000
@RC00536 EQU   @EL00005                                                 05772000
@RF00565 EQU   @EL00008                                                 05773000
@RF00580 EQU   @EL00008                                                 05774000
@RF00590 EQU   @EL00008                                                 05775000
@RC00618 EQU   @EL00008                                                 05776000
@RF00617 EQU   @EL00008                                                 05777000
@RF00651 EQU   @RC00648                                                 05778000
@RF00659 EQU   @RC00656                                                 05779000
@RF00668 EQU   @EL00009                                                 05780000
@RC00699 EQU   @EL00011                                                 05781000
@RF00753 EQU   @EL00014                                                 05782000
@RF00768 EQU   @EL00015                                                 05783000
@RF00778 EQU   @EL00016                                                 05784000
@RF00813 EQU   @EL00020                                                 05785000
@RC00839 EQU   @RC00838                                                 05786000
@RC00873 EQU   @RC00860                                                 05787000
@RF00886 EQU   @EL00022                                                 05788000
@PB00022 EQU   @EL00021                                                 05789000
@RC00909 EQU   @RC00908                                                 05790000
@RC00976 EQU   @RC00975                                                 05791000
@RC01020 EQU   @EL00025                                                 05792000
@RF01056 EQU   @EL00025                                                 05793000
@RF01078 EQU   @EL00027                                                 05794000
@RC01080 EQU   @EL00027                                                 05795000
@RF01093 EQU   @EL00028                                                 05796000
@RC01110 EQU   @RC01109                                                 05797000
@RF00464 EQU   @RC00459                                                 05798000
@RC00490 EQU   @RC00459                                                 05799000
@RC00840 EQU   @RC00839                                                 05800000
@ENDDATA EQU   *                                                        05801000
         END   IKJCT433,(C'PLS1154',0701,77215)                         05802000
