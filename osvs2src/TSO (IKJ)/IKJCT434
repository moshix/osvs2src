         TITLE 'IKJCT434, EXEC EVALUATION ROUTINE                      *00001000
                        '                                               00002000
IKJCT434 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJCT434  75.349'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@11                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         USING @DATD,@10                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @10,8(,@13)                                         0001 00021000
         LR    @13,@10                                             0001 00022000
         MVC   @PC00001(16),0(@01)                                 0001 00023000
*                                                                  0012 00024000
*   /*****************************************************************/ 00025000
*   /*                                                               */ 00026000
*   /* START EXECUTABLE CODE, QUE GETMAIN, AND SETUP                 */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                                  0012 00030000
*   IF CLEN<F1 THEN                 /* IF LENGTH TOO SMALL           */ 00031000
         L     @08,@PC00001+4                                      0012 00032000
         LH    @08,CLEN(,@08)                                      0012 00033000
         LTR   @08,@08                                             0012 00034000
         BP    @RF00012                                            0012 00035000
*     ERROR=E840;                   /* SET ERROR CODE                */ 00036000
         LA    ERROR,840                                           0013 00037000
*   ELSE                            /* OTHERWISE                     */ 00038000
*     DO;                           /* GET CORE                      */ 00039000
         B     @RC00012                                            0014 00040000
@RF00012 DS    0H                                                  0015 00041000
*       HOWMUCH=F2*(LENGTH(QUE)+LENGTH(VQUE))*(CLEN+F1);/* CALC STG  */ 00042000
         L     @15,@PC00001+4                                      0015 00043000
         LA    HOWMUCH,1                                           0015 00044000
         AH    HOWMUCH,CLEN(,@15)                                  0015 00045000
         SLA   HOWMUCH,5                                           0015 00046000
*       DO;                         /* GETMAIN (EC) LV(HOWMUCH)    0016 00047000
*                                      A(QBASE) SP(F1) RTCD(ERROR)   */ 00048000
*         RESPECIFY                                                0017 00049000
*          (GPR01P,                                                0017 00050000
*           GPR15F) RESTRICTED;                                    0017 00051000
*         I004=I004&&I004;          /* INIT LIST                     */ 00052000
         XC    I004(10),I004                                       0018 00053000
*         I00404='20'X;             /* TYPE                          */ 00054000
         MVI   I00404,X'20'                                        0019 00055000
*         I00401=HOWMUCH;           /* LENGTH                        */ 00056000
         ST    HOWMUCH,I00401                                      0020 00057000
*         I00403=ADDR(QBASE);       /* ADDR OF ADDR LIST             */ 00058000
         LA    @14,QBASE                                           0021 00059000
         STCM  @14,7,I00403                                        0021 00060000
*         I00405=F1;                /* SUBPOOL VALUE                 */ 00061000
         MVI   I00405,X'01'                                        0022 00062000
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */ 00063000
         LA    GPR01P,I004                                         0023 00064000
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */ 00065000
         SVC   4                                                   0024 00066000
*         ERROR=GPR15F;             /* SET RETURN CODE               */ 00067000
         LR    ERROR,GPR15F                                        0025 00068000
*         RESPECIFY                                                0026 00069000
*          (GPR01P,                                                0026 00070000
*           GPR15F) UNRESTRICTED;                                  0026 00071000
*       END;                        /* GETMAIN (EC) LV(HOWMUCH)    0027 00072000
*                                      A(QBASE) SP(F1) RTCD(ERROR)   */ 00073000
*       IF ERROR^=F0 THEN           /* IF A GETMAIN ERROR            */ 00074000
         LTR   ERROR,ERROR                                         0028 00075000
         BZ    @RF00028                                            0028 00076000
*         ERROR=E16;                /* SET ERROR CODE                */ 00077000
         LA    ERROR,16                                            0029 00078000
*     END;                          /*                               */ 00079000
@RF00028 DS    0H                                                  0031 00080000
*   IF ERROR^=F0 THEN               /* IF NOT ENOUGH STORAGE         */ 00081000
@RC00012 LTR   ERROR,ERROR                                         0031 00082000
         BNZ   @RT00031                                            0031 00083000
*     GO TO NOFREEXT;               /* DO NOT ISSUE FREEMAIN AND EXIT*/ 00084000
*   SEARCH=SOPER;                   /* INIT SEARCH SO FIRST IS DATA  */ 00085000
         MVI   SEARCH,X'01'                                        0033 00086000
*   SWS=''B;                        /* CLEAR ALL SWITCHES            */ 00087000
         XC    SWS(2),SWS                                          0034 00088000
*   IF TYPE=RELAT THEN              /* CHECK WHICH OPER LIMIT TO USE */ 00089000
         L     @08,@PC00001+8                                      0035 00090000
         CLC   TYPE(4,@08),@CF00058                                0035 00091000
         BNE   @RF00035                                            0035 00092000
*     DO;                           /* ALLOW A NULL ELEMENT BEFORE   */ 00093000
*       NULLELEM=YES;               /* EXCLUSIVE OPERATOR            */ 00094000
         OI    NULLELEM,B'01000000'                                0037 00095000
*       X=DIM(OPS);                 /* VALID OPERATORS TO MAXIMUM-   */ 00096000
         LA    X,28                                                0038 00097000
*     END;                          /*                               */ 00098000
*   ELSE                            /* OTHERWISE SET TO NUMBER OF  0040 00099000
*                                      VALID                         */ 00100000
*     X=ASGNONLY;                   /* ASSIGNMENT OPERATORS          */ 00101000
         B     @RC00035                                            0040 00102000
@RF00035 LA    X,10                                                0040 00103000
*   ERROR=F0;                       /* CLEAR COUNTERS AND ERROR IND  */ 00104000
@RC00035 SLR   ERROR,ERROR                                         0041 00105000
*   MAXX=F0;                        /*                               */ 00106000
         SLR   MAXX,MAXX                                           0042 00107000
*   PCTR=F0;                        /*                               */ 00108000
         SLR   PCTR,PCTR                                           0043 00109000
*   N=F1;                           /* SET N TO LOOK AT FIRST        */ 00110000
         LA    @08,1                                               0044 00111000
         ST    @08,N                                               0044 00112000
*                                                                  0045 00113000
*   /*****************************************************************/ 00114000
*   /*                                                               */ 00115000
*   /* QUE BUILDER AND SYNTAX CHECKER                                */ 00116000
*   /*                                                               */ 00117000
*   /*****************************************************************/ 00118000
*                                                                  0045 00119000
*   DO I=F1 BY F1 WHILE EXITA=NO&ERROR=F0;/* DO UNTIL DONE OR ERROR  */ 00120000
         LR    I,@08                                               0045 00121000
         B     @DE00045                                            0045 00122000
@DL00045 DS    0H                                                  0046 00123000
*     CALL SKIPRTN;                 /* SKIP DELIMITERS               */ 00124000
         BAL   @14,SKIPRTN                                         0046 00125000
*     IF N>=CLEN THEN               /* IF AT END OF LINE OR BEYOND   */ 00126000
         L     @08,@PC00001+4                                      0047 00127000
         L     @04,N                                               0047 00128000
         CH    @04,CLEN(,@08)                                      0047 00129000
         BL    @RF00047                                            0047 00130000
*       EXITA=YES;                  /* SET EXIT SWITCH TO TERMINATE     00131000
*                                      SCAN                          */ 00132000
         OI    EXITA,B'01000000'                                   0048 00133000
*     IF N<=CLEN THEN               /* IF NOT PAST END OF LINE ,   0049 00134000
*                                      CONTINUE                      */ 00135000
@RF00047 L     @08,@PC00001+4                                      0049 00136000
         L     @04,N                                               0049 00137000
         CH    @04,CLEN(,@08)                                      0049 00138000
         BH    @RF00049                                            0049 00139000
*       DO;                         /*                               */ 00140000
*         MAXX=I;                   /* SAVE CURRENT COUNT OF ELEMENTS*/ 00141000
         LR    MAXX,I                                              0051 00142000
*         SEARCH=SEARCH&&FLIP;      /* FLIP SEARCH ARGUMENT          */ 00143000
         XI    SEARCH,X'01'                                        0052 00144000
*         MATCH=NO;                 /* RESET MATCH SWITCH            */ 00145000
         NI    MATCH,B'11111101'                                   0053 00146000
*         NULLREQ=NO;               /* RESET NULL REQUIRED SWITCH    */ 00147000
         NI    NULLREQ,B'11011111'                                 0054 00148000
*         QFLGS(I)=QFLGS(I)&&QFLGS(I);/* CLEAR FLAGS ON QUE ELEMENT  */ 00149000
         LR    @08,I                                               0055 00150000
         SLA   @08,3                                               0055 00151000
         L     @04,QBASE                                           0055 00152000
         ALR   @04,@08                                             0055 00153000
         BCTR  @04,0                                               0055 00154000
         XC    QFLGS-7(1,@04),QFLGS-7(@04)                         0055 00155000
*         DO K=F1 TO X WHILE MATCH=NO&NULLREQ=NO&/* DO UNTIL @ZM30968*/ 00156000
*               ERROR=F0;           /* OP FOUND OR IS NO OPER        */ 00157000
         LA    K,1                                                 0056 00158000
         B     @DE00056                                            0056 00159000
@DL00056 TM    MATCH,B'00000010'                                   0056 00160000
         BNZ   @DC00056                                            0056 00161000
         TM    NULLREQ,B'00100000'                                 0056 00162000
         BNZ   @DC00056                                            0056 00163000
         LTR   ERROR,ERROR                                         0056 00164000
         BNZ   @DC00056                                            0056 00165000
*           IF OPS(K,1:OPLEN(K))=C(N:N+OPLEN(K)-F1)&/* VALID OP OR   */ 00166000
*               (PCONCAT=NO|(K^=RPAREN&K^=LPAREN)) THEN/* NOT PSTRNG */ 00167000
         LR    @08,K                                               0057 00168000
         SLA   @08,4                                               0057 00169000
         L     @15,@PC00001                                        0057 00170000
         LH    @14,OPLEN-16(@08)                                   0057 00171000
         BCTR  @14,0                                               0057 00172000
         LA    @01,OPS-16(@08)                                     0057 00173000
         AL    @15,N                                               0057 00174000
         BCTR  @15,0                                               0057 00175000
         EX    @14,@SC00376                                        0057 00176000
         BNE   @RF00057                                            0057 00177000
         TM    PCONCAT,B'00010000'                                 0057 00178000
         BZ    @RT00057                                            0057 00179000
         C     K,@CF00091                                          0057 00180000
         BE    @RF00057                                            0057 00181000
         C     K,@CF00067                                          0057 00182000
         BE    @RF00057                                            0057 00183000
@RT00057 DS    0H                                                  0058 00184000
*             DO;                   /* IS FOUND, PERFORM OPERATOR  0058 00185000
*                                      SYNTAX CHECK                  */ 00186000
*               IF SEARCH=SDATA&K^=LPAREN&(K^=RPAREN|/* IF PREFIX    */ 00187000
*                   NULLELEM=YES)&K^=PLUS&K^=MINUS THEN/*            */ 00188000
         CLI   SEARCH,X'00'                                        0059 00189000
         BNE   @RF00059                                            0059 00190000
         C     K,@CF00067                                          0059 00191000
         BE    @RF00059                                            0059 00192000
         C     K,@CF00091                                          0059 00193000
         BNE   @GL00007                                            0059 00194000
         TM    NULLELEM,B'01000000'                                0059 00195000
         BNO   @RF00059                                            0059 00196000
@GL00007 C     K,@CF00082                                          0059 00197000
         BE    @RF00059                                            0059 00198000
         C     K,@CF00058                                          0059 00199000
         BE    @RF00059                                            0059 00200000
*                 IF NULLELEM=YES THEN/* IF NULL ELEMENT ALLOWED     */ 00201000
         TM    NULLELEM,B'01000000'                                0060 00202000
         BNO   @RF00060                                            0060 00203000
*                   DO;             /* THEN BUILD IT                 */ 00204000
*                     NULLELEM=NO;  /* NO MORE NULLELEMS ALL         */ 00205000
         NI    NULLELEM,B'10111111'                                0062 00206000
*                     EXITA=NO;     /* RESCAN OPER IF NECESSARY      */ 00207000
         NI    EXITA,B'10111111'                                   0063 00208000
*                     NULLREQ=YES;  /* FORCE NULL ELEMENT            */ 00209000
         OI    NULLREQ,B'00100000'                                 0064 00210000
*                   END;            /*                               */ 00211000
*                 ELSE              /* IF NO NULLELEMENT ALLOWED     */ 00212000
*                   ERROR=E804;     /* SET INVALID PREFEX RETURN CODE*/ 00213000
         B     @RC00060                                            0066 00214000
@RF00060 LA    ERROR,804                                           0066 00215000
*                                                                  0067 00216000
*               /*****************************************************/ 00217000
*               /*                                                   */ 00218000
*               /* PARENTHESIS CHECK                                 */ 00219000
*               /*                                                   */ 00220000
*               /*****************************************************/ 00221000
*                                                                  0067 00222000
*               ELSE                /* IF NOT A PREFEX OPERATOR      */ 00223000
*                 DO;               /* CHECK TO SEE IF OPERATOR IS   */ 00224000
         B     @RC00059                                            0067 00225000
@RF00059 DS    0H                                                  0068 00226000
*                   IF K=RPAREN|K=LPAREN THEN/* IF A PAREN, CHECK TO    00227000
*                                      SEE                           */ 00228000
         C     K,@CF00091                                          0068 00229000
         BE    @RT00068                                            0068 00230000
         C     K,@CF00067                                          0068 00231000
         BNE   @RF00068                                            0068 00232000
@RT00068 DS    0H                                                  0069 00233000
*                     DO;           /* IF ONE IS VALID AT THIS TIME  */ 00234000
*                       IF K=LPAREN THEN/* IF AN OPEN PAREN          */ 00235000
         C     K,@CF00067                                          0070 00236000
         BNE   @RF00070                                            0070 00237000
*                         DO;       /* AND WE NEED AN OPERATOR, THEN */ 00238000
*                           IF SEARCH=SOPER THEN/* SET THE ERROR CODE*/ 00239000
         CLI   SEARCH,X'01'                                        0072 00240000
         BNE   @RF00072                                            0072 00241000
*                             PCTR=-F1;/* CAUSE RESCAN OF BFR        */ 00242000
         SLR   PCTR,PCTR                                           0073 00243000
         BCTR  PCTR,0                                              0073 00244000
*                           ELSE    /* OTHERWISE IT IS VALID         */ 00245000
*                             DO;   /*                               */ 00246000
         B     @RC00072                                            0074 00247000
@RF00072 DS    0H                                                  0075 00248000
*                               PCTR=PCTR+F1;/* INCREMENT PAREN COUNT*/ 00249000
         AL    PCTR,@CF00082                                       0075 00250000
*                               SEARCH=SEARCH&&FLIP;/* FLIP SEARCH 0076 00251000
*                                      ARG                           */ 00252000
         XI    SEARCH,X'01'                                        0076 00253000
*                             END;  /*                               */ 00254000
*                         END;      /*                               */ 00255000
*                       ELSE        /*                               */ 00256000
*                         DO;       /* IF IT IS A RIGHT PAREN AND  0079 00257000
*                                      SEARCH IS                     */ 00258000
         B     @RC00070                                            0079 00259000
@RF00070 DS    0H                                                  0080 00260000
*                           IF SEARCH=SDATA THEN/* FOR DATA THEN SET */ 00261000
         CLI   SEARCH,X'00'                                        0080 00262000
         BNE   @RF00080                                            0080 00263000
*                             PCTR=-F1;/* CAUSE RESCAN OF BFR        */ 00264000
         SLR   PCTR,PCTR                                           0081 00265000
         BCTR  PCTR,0                                              0081 00266000
*                           ELSE    /* OTHERWISE IT IS VALID         */ 00267000
*                             DO;   /*                               */ 00268000
         B     @RC00080                                            0082 00269000
@RF00080 DS    0H                                                  0083 00270000
*                               PCTR=PCTR-F1;/* DECREMENT PAREN    0083 00271000
*                                      COUNTER                       */ 00272000
         BCTR  PCTR,0                                              0083 00273000
*                               SEARCH=SEARCH&&FLIP;/* FLIP SEARCH 0084 00274000
*                                      ARG                           */ 00275000
         XI    SEARCH,X'01'                                        0084 00276000
*                             END;  /*                               */ 00277000
*                         END;      /*                               */ 00278000
@RC00080 DS    0H                                                  0087 00279000
*                     END;          /*                               */ 00280000
@RC00070 DS    0H                                                  0088 00281000
*                   IF PCTR<F0 THEN /* IF A PAREN ERROR , USE AS DATA*/ 00282000
@RF00068 LTR   PCTR,PCTR                                           0088 00283000
         BNM   @RF00088                                            0088 00284000
*                     DO;           /* AND RESET SCAN TO BEGIN       */ 00285000
*                       I=F0;       /* START AT FIRST ELEMENT        */ 00286000
         SLR   I,I                                                 0090 00287000
*                       PCTR=F0;    /* RESET PCTR TO ZERO            */ 00288000
         SLR   PCTR,PCTR                                           0091 00289000
*                       MAXX=F0;    /* RESET MAXX                    */ 00290000
         SLR   MAXX,MAXX                                           0092 00291000
*                       IF TYPE=RELAT THEN/* RESET NULLELEM          */ 00292000
         L     @08,@PC00001+8                                      0093 00293000
         CLC   TYPE(4,@08),@CF00058                                0093 00294000
         BNE   @RF00093                                            0093 00295000
*                         NULLELEM=YES;/* TURN IT ON                 */ 00296000
         OI    NULLELEM,B'01000000'                                0094 00297000
*                       ELSE        /* OTHERWISE                     */ 00298000
*                         NULLELEM=NO;/* TURN IT OFF                 */ 00299000
         B     @RC00093                                            0095 00300000
@RF00093 NI    NULLELEM,B'10111111'                                0095 00301000
*                       OPFND=NO;   /* RESET OPFOUND                 */ 00302000
@RC00093 DS    0H                                                  0097 00303000
*                       PCONCAT=YES;/* PAREN AS DATA SWITCH          */ 00304000
         OI    PCONCAT,B'00010000'                                 0097 00305000
         NI    OPFND,B'01111111'                                   0097 00306000
*                       SEARCH=SOPER;/* INIT SCAN TYPE               */ 00307000
         MVI   SEARCH,X'01'                                        0098 00308000
*                       N=F1;       /* START AT FIRST CHAR           */ 00309000
         MVC   N(4),@CF00082                                       0099 00310000
*                       MATCH=YES;  /* SKIP FOLLOWING SECTIONS       */ 00311000
         OI    MATCH,B'00000010'                                   0100 00312000
*                     END;          /*                               */ 00313000
*                   ELSE            /* OTHERWISE BUILD OPER ELEMENT  */ 00314000
*                     DO;           /*                               */ 00315000
*                                                                  0102 00316000
         B     @RC00088                                            0102 00317000
@RF00088 DS    0H                                                  0103 00318000
*                       /*********************************************/ 00319000
*                       /*                                           */ 00320000
*                       /* BUILD OPERATOR ELEMENT                    */ 00321000
*                       /*                                           */ 00322000
*                       /*********************************************/ 00323000
*                                                                  0103 00324000
*                       QFLGS(I)=OPFLG(K);/* COPY FLAGS FROM TABLE   */ 00325000
         L     @08,QBASE                                           0103 00326000
         LR    @15,I                                               0103 00327000
         SLA   @15,3                                               0103 00328000
         ST    @15,@TF00001                                        0103 00329000
         ALR   @15,@08                                             0103 00330000
         BCTR  @15,0                                               0103 00331000
         LR    @14,K                                               0103 00332000
         SLA   @14,4                                               0103 00333000
         LA    @01,OPFLG-16(@14)                                   0103 00334000
         MVC   QFLGS-7(1,@15),0(@01)                               0103 00335000
*                       QSTREN(I)=OPSTR(K);/* FILL IN THE STRENGTH OF   00336000
*                                      THE OP                        */ 00337000
         LH    @15,OPSTR-16(@14)                                   0104 00338000
         L     @01,@TF00001                                        0104 00339000
         BCTR  @01,0                                               0104 00340000
         BCTR  @01,0                                               0104 00341000
         STC   @15,QSTREN-6(@01,@08)                               0104 00342000
*                       QLEN(I)=OPLEN(K);/* FILL IN THE LENGTH OF THE   00343000
*                                      OPER                          */ 00344000
         LH    @15,OPLEN-16(@14)                                   0105 00345000
         L     @14,@TF00001                                        0105 00346000
         AL    @14,@CF00381                                        0105 00347000
         STH   @15,QLEN-4(@14,@08)                                 0105 00348000
*                       MATCH=YES;  /* SET THE FACT THAT WE HAVE AN     00349000
*                                      OP                            */ 00350000
         OI    MATCH,B'00000010'                                   0106 00351000
*                       QVAL(I)=K;  /* SET THE OPCODE INDEX INTO QUE */ 00352000
         L     @01,@TF00001                                        0107 00353000
         AL    @08,@CF00382                                        0107 00354000
         ST    K,QVAL(@01,@08)                                     0107 00355000
*                       N=N+OPLEN(K);/* UPDATE N TO POINT PAST     0108 00356000
*                                      OPERATOR                      */ 00357000
         AL    @15,N                                               0108 00358000
         ST    @15,N                                               0108 00359000
*                       IF SEARCH=SDATA&(K=PLUS|K=MINUS) THEN/*      */ 00360000
         CLI   SEARCH,X'00'                                        0109 00361000
         BNE   @RF00109                                            0109 00362000
         C     K,@CF00082                                          0109 00363000
         BE    @RT00109                                            0109 00364000
         C     K,@CF00058                                          0109 00365000
         BNE   @RF00109                                            0109 00366000
@RT00109 DS    0H                                                  0110 00367000
*                         DO;       /* MAKE OPERATOR A PREFIX OPER   */ 00368000
*                           QPREFX(I)=YES;/* SET THE PREFIX BIT      */ 00369000
         L     @08,QBASE                                           0111 00370000
         LR    @15,I                                               0111 00371000
         SLA   @15,3                                               0111 00372000
         ST    @15,@TF00001                                        0111 00373000
         ALR   @15,@08                                             0111 00374000
         BCTR  @15,0                                               0111 00375000
         OI    QPREFX-7(@15),B'00010000'                           0111 00376000
*                           QSTREN(I)=F4+F2;/* SET THE STRENGTH      */ 00377000
         LA    @15,6                                               0112 00378000
         L     @14,@TF00001                                        0112 00379000
         BCTR  @14,0                                               0112 00380000
         BCTR  @14,0                                               0112 00381000
         STC   @15,QSTREN-6(@14,@08)                               0112 00382000
*                           SEARCH=SEARCH&&FLIP;/* CONTINUE SCAN FOR */ 00383000
         XI    SEARCH,X'01'                                        0113 00384000
*                           IF I>F1&QPREFX(I-F1)=YES THEN/* 2 PREFXS */ 00385000
         LA    @15,1                                               0114 00386000
         CR    I,@15                                               0114 00387000
         BNH   @RF00114                                            0114 00388000
         LR    @01,@08                                             0114 00389000
         AL    @01,@TF00001                                        0114 00390000
         AL    @01,@CF00384                                        0114 00391000
         TM    QPREFX-7(@01),B'00010000'                           0114 00392000
         BNO   @RF00114                                            0114 00393000
*                             DO;   /* MAKE ONLY ONE PREFIX OUT OF 2 */ 00394000
*                               I=I-F1;/* DECREMENT I TO REUSE ELEMT */ 00395000
         BCTR  I,0                                                 0116 00396000
*                               IF QVAL(I)=K THEN/* IF THE SAME      */ 00397000
         LR    @14,I                                               0117 00398000
         SLA   @14,3                                               0117 00399000
         LA    @01,0(@14,@08)                                      0117 00400000
         AL    @01,@CF00382                                        0117 00401000
         C     K,QVAL(,@01)                                        0117 00402000
         BNE   @RF00117                                            0117 00403000
*                                 QVAL(I)=PLUS;/* ASSIGN PLUS        */ 00404000
         AL    @08,@CF00382                                        0118 00405000
         ST    @15,QVAL(@14,@08)                                   0118 00406000
*                               ELSE/* OTHERWISE DOUBLE PREFX IS     */ 00407000
*                                 QVAL(I)=MINUS;/* MINUS             */ 00408000
         B     @RC00117                                            0119 00409000
@RF00117 LR    @08,I                                               0119 00410000
         SLA   @08,3                                               0119 00411000
         LA    @15,2                                               0119 00412000
         L     @14,QBASE                                           0119 00413000
         AL    @14,@CF00382                                        0119 00414000
         ST    @15,QVAL(@08,@14)                                   0119 00415000
*                             END;  /*                               */ 00416000
@RC00117 DS    0H                                                  0121 00417000
*                         END;      /* DATA                          */ 00418000
@RF00114 DS    0H                                                  0122 00419000
*                                                                  0122 00420000
*                       /*********************************************/ 00421000
*                       /*                                           */ 00422000
*                       /* CHECK FOR MULTIPLE EXCLUSIVE OPERATORS    */ 00423000
*                       /*                                           */ 00424000
*                       /*********************************************/ 00425000
*                                                                  0122 00426000
*                       IF TYPE=NUMBR THEN/* IF NUMBER ENTRY         */ 00427000
@RF00109 L     @08,@PC00001+8                                      0122 00428000
         L     @08,TYPE(,@08)                                      0122 00429000
         LTR   @08,@08                                             0122 00430000
         BNZ   @RF00122                                            0122 00431000
*                         DO;       /* MAKE SURE EXCLUSIVE OPER IS 0123 00432000
*                                      1ST                           */ 00433000
*                           IF OPFND=NO&QEXCLU(I)=NO THEN/* IF NO  0124 00434000
*                                      GOOD                          */ 00435000
         TM    OPFND,B'10000000'                                   0124 00436000
         BNZ   @RF00124                                            0124 00437000
         LR    @08,I                                               0124 00438000
         SLA   @08,3                                               0124 00439000
         L     @01,QBASE                                           0124 00440000
         ALR   @01,@08                                             0124 00441000
         BCTR  @01,0                                               0124 00442000
         TM    QEXCLU-7(@01),B'00001000'                           0124 00443000
         BNZ   @RF00124                                            0124 00444000
*                             ERROR=E820;/* SET ERROR CODE           */ 00445000
         LA    ERROR,820                                           0125 00446000
*                           ELSE    /* IF OK SO FAR , CHECK TO SEE   */ 00447000
*                             IF QEXCLU(I)=YES THEN/* IF ONE ALREADY    00448000
*                                      FOUND                         */ 00449000
         B     @RC00124                                            0126 00450000
@RF00124 LR    @08,I                                               0126 00451000
         SLA   @08,3                                               0126 00452000
         L     @01,QBASE                                           0126 00453000
         ALR   @01,@08                                             0126 00454000
         BCTR  @01,0                                               0126 00455000
         TM    QEXCLU-7(@01),B'00001000'                           0126 00456000
         BNO   @RF00126                                            0126 00457000
*                               IF OPFND=YES THEN/* IF SO THEN SYNTAX   00458000
*                                      ERROR                         */ 00459000
         TM    OPFND,B'10000000'                                   0127 00460000
         BNO   @RF00127                                            0127 00461000
*                                 ERROR=E824;/* SET ERROR CODE       */ 00462000
         LA    ERROR,824                                           0128 00463000
*                               ELSE/* OTHERWISE SET THAT WE HAVE ONE*/ 00464000
*                                 DO;/*                              */ 00465000
         B     @RC00127                                            0129 00466000
@RF00127 DS    0H                                                  0130 00467000
*                                   OPFND=YES;/* SET SWITCH          */ 00468000
*                                   NULLELEM=YES;/* ALLOW NULL     0131 00469000
*                                      ELEMENTS                      */ 00470000
         OI    OPFND,B'11000000'                                   0131 00471000
*                                 END;/*                             */ 00472000
*                         END;      /*                               */ 00473000
*                       ELSE        /* IF RELATIONAL ENTRY           */ 00474000
*                         IF QEXCLU(I)=YES THEN/* AND OPER IS      0134 00475000
*                                      EXCLUSIVE                     */ 00476000
         B     @RC00122                                            0134 00477000
@RF00122 LR    @08,I                                               0134 00478000
         SLA   @08,3                                               0134 00479000
         L     @01,QBASE                                           0134 00480000
         ALR   @01,@08                                             0134 00481000
         BCTR  @01,0                                               0134 00482000
         TM    QEXCLU-7(@01),B'00001000'                           0134 00483000
         BNO   @RF00134                                            0134 00484000
*                           IF OPFND=YES THEN/* AND WE ALREADY HAVE     00485000
*                                      ONE                           */ 00486000
         TM    OPFND,B'10000000'                                   0135 00487000
         BNO   @RF00135                                            0135 00488000
*                             ERROR=E828;/* SET ERROR CODE           */ 00489000
         LA    ERROR,828                                           0136 00490000
*                           ELSE    /* IF FIRST ONE, SET SWITCH TO   */ 00491000
*                             DO;   /*                               */ 00492000
         B     @RC00135                                            0137 00493000
@RF00135 DS    0H                                                  0138 00494000
*                               OPFND=YES;/* INDICATE SO             */ 00495000
*                               NULLELEM=YES;/*                      */ 00496000
         OI    OPFND,B'11000000'                                   0139 00497000
*                             END;  /*                               */ 00498000
*                         ELSE      /* OTHERWISE CHECK FOR AND/OR    */ 00499000
*                           IF QCOMB(I)=YES THEN/* IF AND/OR         */ 00500000
         B     @RC00134                                            0141 00501000
@RF00134 LR    @08,I                                               0141 00502000
         SLA   @08,3                                               0141 00503000
         L     @01,QBASE                                           0141 00504000
         ALR   @01,@08                                             0141 00505000
         BCTR  @01,0                                               0141 00506000
         TM    QCOMB-7(@01),B'00000001'                            0141 00507000
         BNO   @RF00141                                            0141 00508000
*                             IF OPFND=YES THEN/* OK HERE            */ 00509000
         TM    OPFND,B'10000000'                                   0142 00510000
         BNO   @RF00142                                            0142 00511000
*                               DO; /* PROCESS                       */ 00512000
*                                 OPFND=NO;/* RESET OPFND            */ 00513000
*                                 NULLELEM=YES;/* RESET NULL         */ 00514000
         OI    NULLELEM,B'01000000'                                0145 00515000
         NI    OPFND,B'01111111'                                   0145 00516000
*                               END;/*                               */ 00517000
*                             ELSE  /* OTHERWISE                     */ 00518000
*                               ERROR=E808;/* AND/OR NOT ALLOWED     */ 00519000
         B     @RC00142                                            0147 00520000
@RF00142 LA    ERROR,808                                           0147 00521000
*                     END;          /*                               */ 00522000
@RC00142 DS    0H                                                  0148 00523000
@RF00141 DS    0H                                                  0148 00524000
@RC00134 DS    0H                                                  0148 00525000
@RC00122 DS    0H                                                  0149 00526000
*                 END;              /*                               */ 00527000
@RC00088 DS    0H                                                  0150 00528000
*             END;                  /*                               */ 00529000
@RC00059 DS    0H                                                  0151 00530000
*         END;                      /*                               */ 00531000
@RF00057 AL    K,@CF00082                                          0151 00532000
@DE00056 CR    K,X                                                 0151 00533000
         BNH   @DL00056                                            0151 00534000
@DC00056 DS    0H                                                  0152 00535000
*         IF SEARCH=SOPER&MATCH=NO&ERROR=F0 THEN/* DOUBLE DATA ?     */ 00536000
         CLI   SEARCH,X'01'                                        0152 00537000
         BNE   @RF00152                                            0152 00538000
         TM    MATCH,B'00000010'                                   0152 00539000
         BNZ   @RF00152                                            0152 00540000
         LTR   ERROR,ERROR                                         0152 00541000
         BNZ   @RF00152                                            0152 00542000
*           DO;                     /* IF SO AND TYPE IS RELAT OR  0153 00543000
*                                      OPER FOUND                    */ 00544000
*             IF TYPE=RELAT|OPFND=YES THEN/*                         */ 00545000
         L     @08,@PC00001+8                                      0154 00546000
         CLC   TYPE(4,@08),@CF00058                                0154 00547000
         BE    @RT00154                                            0154 00548000
         TM    OPFND,B'10000000'                                   0154 00549000
         BNO   @RF00154                                            0154 00550000
@RT00154 DS    0H                                                  0155 00551000
*               DO;                 /* RESET SEARCH AND SET CONCAT 0155 00552000
*                                      SWITCH                        */ 00553000
*                 SEARCH=SEARCH&&FLIP;/*                             */ 00554000
         XI    SEARCH,X'01'                                        0156 00555000
*                 CONCAT=YES;       /*                               */ 00556000
         OI    CONCAT,B'00000001'                                  0157 00557000
*               END;                /*                               */ 00558000
*             ELSE                  /* OTHERWISE DOUBLE DATA NOT   0159 00559000
*                                      VALID                         */ 00560000
*               ERROR=E800;         /* SET ERROR CODE                */ 00561000
         B     @RC00154                                            0159 00562000
@RF00154 LA    ERROR,800                                           0159 00563000
*           END;                    /*                               */ 00564000
*                                                                  0160 00565000
@RC00154 DS    0H                                                  0161 00566000
*         /***********************************************************/ 00567000
*         /*                                                         */ 00568000
*         /* PROCESS DATA ELEMENT                                    */ 00569000
*         /*                                                         */ 00570000
*         /***********************************************************/ 00571000
*                                                                  0161 00572000
*         IF MATCH=NO THEN          /* IF CURRENT VARIABLE NOT AN  0161 00573000
*                                      OPERATOR                      */ 00574000
@RF00152 TM    MATCH,B'00000010'                                   0161 00575000
         BNZ   @RF00161                                            0161 00576000
*           DO;                     /* PROCESS DATA ELEMENT          */ 00577000
*             CALL SKIPRTN;         /* SKIP DELIMITERS               */ 00578000
         BAL   @14,SKIPRTN                                         0163 00579000
*             EXITB=NO;             /* INIT EXIT SWITCH              */ 00580000
         NI    EXITB,B'11101111'                                   0164 00581000
*             NSAVE=N;              /* SAVE CURRENT INDEX            */ 00582000
         L     @04,N                                               0165 00583000
         LR    NSAVE,@04                                           0165 00584000
*             QPTR(I)=ADDR(C(N));   /* POINT TO BEGINNING OF DATA    */ 00585000
         LR    @15,I                                               0166 00586000
         SLA   @15,3                                               0166 00587000
         L     @14,@PC00001                                        0166 00588000
         BCTR  @14,0                                               0166 00589000
         LA    @04,C(@04,@14)                                      0166 00590000
         L     @01,QBASE                                           0166 00591000
         AL    @01,@CF00382                                        0166 00592000
         ST    @04,QPTR(@15,@01)                                   0166 00593000
*             DO N=N BY 1 WHILE EXITB=NO;/* DO UNTIL END OR DELIM    */ 00594000
         B     @DE00167                                            0167 00595000
@DL00167 DS    0H                                                  0168 00596000
*               DO K=1 TO X WHILE EXITB=NO;/* FIND A DELIMETER       */ 00597000
         LA    K,1                                                 0168 00598000
         B     @DE00168                                            0168 00599000
@DL00168 TM    EXITB,B'00010000'                                   0168 00600000
         BNZ   @DC00168                                            0168 00601000
*                 IF N>CLEN|        /* IF PAST END OF BUFFER OR      */ 00602000
*                     NULLREQ=YES|  /* IF A NULL ELEMENT IS REQUIRED */ 00603000
*                     ((CONCAT=NO|N-NSAVE^=F0)&/* CONCAT OR NON ZERO */ 00604000
*                     (PCONCAT=NO|  /* NOT IN PAREN SKIP             */ 00605000
*                     (K^=RPAREN&K^=LPAREN))&/* OR NOT PARENS        */ 00606000
*                     ENDDLM(K)=C(N)) THEN/* A DELIMETER             */ 00607000
         L     @15,N                                               0169 00608000
         L     @14,@PC00001+4                                      0169 00609000
         CH    @15,CLEN(,@14)                                      0169 00610000
         BH    @RT00169                                            0169 00611000
         TM    NULLREQ,B'00100000'                                 0169 00612000
         BO    @RT00169                                            0169 00613000
         TM    CONCAT,B'00000001'                                  0169 00614000
         BZ    @GL00022                                            0169 00615000
         SLR   @15,NSAVE                                           0169 00616000
         LTR   @15,@15                                             0169 00617000
         BZ    @RF00169                                            0169 00618000
@GL00022 TM    PCONCAT,B'00010000'                                 0169 00619000
         BZ    @GL00021                                            0169 00620000
         C     K,@CF00091                                          0169 00621000
         BE    @RF00169                                            0169 00622000
         C     K,@CF00067                                          0169 00623000
         BE    @RF00169                                            0169 00624000
@GL00021 L     @15,@PC00001                                        0169 00625000
         LA    @01,ENDDLM-1(K)                                     0169 00626000
         AL    @15,N                                               0169 00627000
         BCTR  @15,0                                               0169 00628000
         CLC   0(1,@01),C(@15)                                     0169 00629000
         BNE   @RF00169                                            0169 00630000
@RT00169 DS    0H                                                  0170 00631000
*                   DO;             /* SET THE LENGTH OF DATA        */ 00632000
*                     NSAVE=N-NSAVE;/*                               */ 00633000
         L     @15,N                                               0171 00634000
         SLR   @15,NSAVE                                           0171 00635000
         LR    NSAVE,@15                                           0171 00636000
*                     EXITB=YES;    /* FALL OUT OF LOOP              */ 00637000
         OI    EXITB,B'00010000'                                   0172 00638000
*                   END;            /*                               */ 00639000
*               END;                /*                               */ 00640000
@RF00169 AL    K,@CF00082                                          0174 00641000
@DE00168 CR    K,X                                                 0174 00642000
         BNH   @DL00168                                            0174 00643000
@DC00168 DS    0H                                                  0175 00644000
*             END;                  /*                               */ 00645000
         LA    @04,1                                               0175 00646000
         AL    @04,N                                               0175 00647000
         ST    @04,N                                               0175 00648000
@DE00167 TM    EXITB,B'00010000'                                   0175 00649000
         BZ    @DL00167                                            0175 00650000
*             N=N-F1;               /* RESET N                       */ 00651000
         L     @04,N                                               0176 00652000
         BCTR  @04,0                                               0176 00653000
         ST    @04,N                                               0176 00654000
*             QLEN(I)=NSAVE;        /* SET LENGTH OF DATA ITEM       */ 00655000
         L     @04,QBASE                                           0177 00656000
         LR    @15,I                                               0177 00657000
         SLA   @15,3                                               0177 00658000
         LA    @01,0(@15,@04)                                      0177 00659000
         AL    @01,@CF00381                                        0177 00660000
         STH   NSAVE,QLEN-4(,@01)                                  0177 00661000
*             IF NSAVE=F0 THEN      /* IF A NULL ELEMENT             */ 00662000
         LTR   NSAVE,NSAVE                                         0178 00663000
         BNZ   @RF00178                                            0178 00664000
*               QSTREN(I)=F1;       /* FORCE ALPHA                   */ 00665000
         LA    @08,1                                               0179 00666000
         BCTR  @04,0                                               0179 00667000
         BCTR  @04,0                                               0179 00668000
         STC   @08,QSTREN-6(@15,@04)                               0179 00669000
*             ELSE                  /* OTHERWISE                     */ 00670000
*               QSTREN(I)=F0;       /* INIT TO NUMERIC UNTIL CHECK   */ 00671000
         B     @RC00178                                            0180 00672000
@RF00178 LR    @08,I                                               0180 00673000
         SLA   @08,3                                               0180 00674000
         SLR   @04,@04                                             0180 00675000
         L     @01,QBASE                                           0180 00676000
         BCTR  @01,0                                               0180 00677000
         BCTR  @01,0                                               0180 00678000
         STC   @04,QSTREN-6(@08,@01)                               0180 00679000
*                                                                  0181 00680000
*             /*******************************************************/ 00681000
*             /*                                                     */ 00682000
*             /* PERFORM CONCATENATION                               */ 00683000
*             /*                                                     */ 00684000
*             /*******************************************************/ 00685000
*                                                                  0181 00686000
*             IF CONCAT=YES THEN    /* IF CONCAT REQUIRED THEN       */ 00687000
@RC00178 TM    CONCAT,B'00000001'                                  0181 00688000
         BNO   @RF00181                                            0181 00689000
*               DO;                 /*                               */ 00690000
*                 CONCAT=NO;        /* RESET CONCAT SWITCH           */ 00691000
         NI    CONCAT,B'11111110'                                  0183 00692000
*                 QLEN(I-F1)=QPTR(I)+QLEN(I)-QPTR(I-F1);/* RESET   0184 00693000
*                                      LNGTH                         */ 00694000
         L     @08,QBASE                                           0184 00695000
         LR    @04,I                                               0184 00696000
         SLA   @04,3                                               0184 00697000
         LA    @01,0(@04,@08)                                      0184 00698000
         AL    @01,@CF00381                                        0184 00699000
         LH    @15,QLEN-4(,@01)                                    0184 00700000
         LA    @14,0(@04,@08)                                      0184 00701000
         AL    @14,@CF00382                                        0184 00702000
         AL    @15,QPTR(,@14)                                      0184 00703000
         LA    @14,0(@04,@08)                                      0184 00704000
         AL    @14,@CF00388                                        0184 00705000
         SL    @15,QPTR(,@14)                                      0184 00706000
         AL    @08,@CF00389                                        0184 00707000
         STH   @15,QLEN-4(@04,@08)                                 0184 00708000
*                 I=I-F1;           /* DECREMENT I TO RE-USE ELEMENT */ 00709000
         BCTR  I,0                                                 0185 00710000
*                 MAXX=MAXX-F1;     /* DECREMENT MAXX                */ 00711000
         BCTR  MAXX,0                                              0186 00712000
*               END;                /*                               */ 00713000
*             DO K=1 TO QLEN(I);    /* CHECK FOR                     */ 00714000
@RF00181 LA    K,1                                                 0188 00715000
         B     @DE00188                                            0188 00716000
@DL00188 DS    0H                                                  0189 00717000
*               IF QCHAR(K)<'0'|QCHAR(K)>'9' THEN/* IF ANY CHAR IS   */ 00718000
         LR    @08,I                                               0189 00719000
         SLA   @08,3                                               0189 00720000
         L     @01,QBASE                                           0189 00721000
         AL    @01,@CF00382                                        0189 00722000
         L     @08,QPTR(@08,@01)                                   0189 00723000
         LR    @01,@08                                             0189 00724000
         ALR   @01,K                                               0189 00725000
         BCTR  @01,0                                               0189 00726000
         CLI   QCHAR(@01),C'0'                                     0189 00727000
         BL    @RT00189                                            0189 00728000
         ALR   @08,K                                               0189 00729000
         BCTR  @08,0                                               0189 00730000
         CLI   QCHAR(@08),C'9'                                     0189 00731000
         BNH   @RF00189                                            0189 00732000
@RT00189 DS    0H                                                  0190 00733000
*                 QSTREN(I)=F1;     /* ALPHA, SET STRENGTH TO ONE    */ 00734000
         LR    @08,I                                               0190 00735000
         SLA   @08,3                                               0190 00736000
         LA    @15,1                                               0190 00737000
         L     @14,QBASE                                           0190 00738000
         BCTR  @14,0                                               0190 00739000
         BCTR  @14,0                                               0190 00740000
         STC   @15,QSTREN-6(@08,@14)                               0190 00741000
*             END;                  /*                               */ 00742000
@RF00189 AL    K,@CF00082                                          0191 00743000
@DE00188 LR    @08,I                                               0191 00744000
         SLA   @08,3                                               0191 00745000
         L     @01,QBASE                                           0191 00746000
         AL    @01,@CF00381                                        0191 00747000
         CH    K,QLEN-4(@08,@01)                                   0191 00748000
         BNH   @DL00188                                            0191 00749000
*           END;                    /*                               */ 00750000
*       END;                        /*                               */ 00751000
@RF00161 DS    0H                                                  0194 00752000
*   END;                            /*                               */ 00753000
@RF00049 AL    I,@CF00082                                          0194 00754000
@DE00045 TM    EXITA,B'01000000'                                   0194 00755000
         BNZ   @DC00045                                            0194 00756000
         LTR   ERROR,ERROR                                         0194 00757000
         BZ    @DL00045                                            0194 00758000
@DC00045 DS    0H                                                  0195 00759000
*                                                                  0195 00760000
*   /*****************************************************************/ 00761000
*   /*                                                               */ 00762000
*   /* MISC SYNTAX CHECKING                                          */ 00763000
*   /*                                                               */ 00764000
*   /*****************************************************************/ 00765000
*                                                                  0195 00766000
*   IF ERROR=F0 THEN                /* IF NO ERROR SO FAR            */ 00767000
         SLR   @08,@08                                             0195 00768000
         CR    ERROR,@08                                           0195 00769000
         BNE   @RF00195                                            0195 00770000
*     IF SEARCH=SOPER THEN          /* IF AN OPER ON END OF STMT     */ 00771000
         CLI   SEARCH,X'01'                                        0196 00772000
         BNE   @RF00196                                            0196 00773000
*       IF NULLELEM=YES THEN        /* IF NULL ELEMENT IS REQUIRED   */ 00774000
         TM    NULLELEM,B'01000000'                                0197 00775000
         BNO   @RF00197                                            0197 00776000
*         DO;                       /* A NULL ELEMENT                */ 00777000
*           MAXX=MAXX+F1;           /* INCREMENT MAXX                */ 00778000
         LA    @07,1                                               0199 00779000
         ALR   MAXX,@07                                            0199 00780000
*           QLEN(MAXX)=F0;          /* ZERO LENGTH                   */ 00781000
         L     @02,QBASE                                           0200 00782000
         LR    @15,MAXX                                            0200 00783000
         SLA   @15,3                                               0200 00784000
         LA    @01,0(@15,@02)                                      0200 00785000
         AL    @01,@CF00381                                        0200 00786000
         STH   @08,QLEN-4(,@01)                                    0200 00787000
*           QPTR(MAXX)=ADDR(C(1));  /* SET VALID ADDRESS             */ 00788000
         L     @08,@PC00001                                        0201 00789000
         LA    @01,0(@15,@02)                                      0201 00790000
         AL    @01,@CF00382                                        0201 00791000
         ST    @08,QPTR(,@01)                                      0201 00792000
*           QSTREN(MAXX)=F1;        /* SET ALPHA BIT                 */ 00793000
         LA    @08,0(@15,@02)                                      0202 00794000
         BCTR  @08,0                                               0202 00795000
         BCTR  @08,0                                               0202 00796000
         STC   @07,QSTREN-6(,@08)                                  0202 00797000
*           QFLGS(MAXX)=QFLGS(MAXX)&&QFLGS(MAXX);/* ZERO FLAGS       */ 00798000
         ALR   @02,@15                                             0203 00799000
         BCTR  @02,0                                               0203 00800000
         XC    QFLGS-7(1,@02),QFLGS-7(@02)                         0203 00801000
*         END;                                                     0204 00802000
*       ELSE                        /* OTHERWISE                     */ 00803000
*         ERROR=E816;               /* OTHER ERROR, SET ERROR CODE   */ 00804000
         B     @RC00197                                            0205 00805000
@RF00197 LA    ERROR,816                                           0205 00806000
*   IF ERROR=F0 THEN                /* IF STILL OK                   */ 00807000
@RC00197 DS    0H                                                  0206 00808000
@RF00196 DS    0H                                                  0206 00809000
@RF00195 LTR   ERROR,ERROR                                         0206 00810000
         BNZ   @RF00206                                            0206 00811000
*     IF MAXX<3 THEN                /* IF INSUFFICIENT OPERANDS      */ 00812000
         C     MAXX,@CF00234                                       0207 00813000
         BNL   @RF00207                                            0207 00814000
*       ERROR=E840;                 /* SET ERROR CODE                */ 00815000
         LA    ERROR,840                                           0208 00816000
*     ELSE                          /*                               */ 00817000
*       IF OPFND=NO THEN            /* IF NO VALID OPERATORS FOUND   */ 00818000
         B     @RC00207                                            0209 00819000
@RF00207 TM    OPFND,B'10000000'                                   0209 00820000
         BNZ   @RF00209                                            0209 00821000
*         ERROR=E844;               /* SET ERROR CODE                */ 00822000
         LA    ERROR,844                                           0210 00823000
*   IF ERROR^=F0 THEN               /* IF ERROR UP TO THIS POINT,  0211 00824000
*                                      TERMINATE                     */ 00825000
@RF00209 DS    0H                                                  0211 00826000
@RC00207 DS    0H                                                  0211 00827000
@RF00206 LTR   ERROR,ERROR                                         0211 00828000
         BNZ   @RT00211                                            0211 00829000
*     GO TO EXIT;                   /* PROCESSINT AND RETURN         */ 00830000
*                                                                  0213 00831000
*   /*****************************************************************/ 00832000
*   /*                                                               */ 00833000
*   /* POLISH SCAN SECTION                                           */ 00834000
*   /*                                                               */ 00835000
*   /*****************************************************************/ 00836000
*                                                                  0213 00837000
*   OUTQDX=F1;                      /* INIT HORIZONTAL QUE INDEX     */ 00838000
         LA    @08,1                                               0213 00839000
         LR    OUTQDX,@08                                          0213 00840000
*   VINDX=F0;                       /* INIT VERTICAL QUE INDEX       */ 00841000
         SLR   VINDX,VINDX                                         0214 00842000
*   DO N=1 TO MAXX;                 /* SORT ALL OF QUE               */ 00843000
         B     @DE00215                                            0215 00844000
@DL00215 DS    0H                                                  0216 00845000
*     IF QOPER(N)=NO THEN           /* IF CURRENT ELEMENT IS DATA    */ 00846000
         L     @07,QBASE                                           0216 00847000
         LR    @05,@08                                             0216 00848000
         SLA   @05,3                                               0216 00849000
         ST    @05,@TF00001                                        0216 00850000
         ALR   @05,@07                                             0216 00851000
         BCTR  @05,0                                               0216 00852000
         TM    QOPER-7(@05),B'10000000'                            0216 00853000
         BNZ   @RF00216                                            0216 00854000
*       DO;                         /* COPY TO OUTPUT HORIZ QUE      */ 00855000
*                                                                  0217 00856000
*         /***********************************************************/ 00857000
*         /*                                                         */ 00858000
*         /* PROCESS DATA ELEMENT                                    */ 00859000
*         /*                                                         */ 00860000
*         /***********************************************************/ 00861000
*                                                                  0218 00862000
*         OUTQUE(OUTQDX)=QUE(N);    /* COPY ELEMENT                  */ 00863000
         LR    @15,OUTQDX                                          0218 00864000
         SLA   @15,3                                               0218 00865000
         ALR   @15,@07                                             0218 00866000
         AL    @15,@CF00382                                        0218 00867000
         LR    @01,@07                                             0218 00868000
         AL    @01,@TF00001                                        0218 00869000
         AL    @01,@CF00382                                        0218 00870000
         MVC   @TS00001(8),QUE(@01)                                0218 00871000
         MVC   OUTQUE(8,@15),@TS00001                              0218 00872000
*         OUTQDX=OUTQDX+F1;         /* INCREMENT OUTQUE INDEX        */ 00873000
         AL    OUTQDX,@CF00082                                     0219 00874000
*         I=N;                      /* USE I                         */ 00875000
         LR    I,@08                                               0220 00876000
*         DO X=QLEN(I) TO 1 BY-1;   /* DO YOUR THING                 */ 00877000
         L     @08,QBASE                                           0221 00878000
         LR    @15,I                                               0221 00879000
         SLA   @15,3                                               0221 00880000
         AL    @08,@CF00381                                        0221 00881000
         LH    X,QLEN-4(@15,@08)                                   0221 00882000
         B     @DE00221                                            0221 00883000
@DL00221 DS    0H                                                  0222 00884000
*           TR(QCHAR(X),TRTABUP);   /* FOLD TO NORMAL CHARS          */ 00885000
         LR    @08,I                                               0222 00886000
         SLA   @08,3                                               0222 00887000
         L     @01,QBASE                                           0222 00888000
         AL    @01,@CF00382                                        0222 00889000
         L     @08,QPTR(@08,@01)                                   0222 00890000
         ALR   @08,X                                               0222 00891000
         BCTR  @08,0                                               0222 00892000
         L     @15,@CA00071                                        0222 00893000
         TR    QCHAR(1,@08),TRTABUP-TRTABUP(@15)                   0222 00894000
*         END;                      /*                               */ 00895000
         BCTR  X,0                                                 0223 00896000
@DE00221 LTR   X,X                                                 0223 00897000
         BP    @DL00221                                            0223 00898000
*       END;                        /*                               */ 00899000
*     ELSE                          /* IF CURRENT ELEMENT IS AN    0225 00900000
*                                      OPERATOR                      */ 00901000
*       DO;                         /* SEE IF THE OPERATOR IS A LEFT    00902000
*                                      PAREN                         */ 00903000
         B     @RC00216                                            0225 00904000
@RF00216 DS    0H                                                  0226 00905000
*         IF QVAL(N)=LPAREN THEN    /* IF IT IS, THEN WE ADD THIS TO    00906000
*                                      VERT                          */ 00907000
         L     @08,QBASE                                           0226 00908000
         L     @07,N                                               0226 00909000
         SLA   @07,3                                               0226 00910000
         LA    @05,0(@07,@08)                                      0226 00911000
         AL    @05,@CF00382                                        0226 00912000
         L     @05,QVAL(,@05)                                      0226 00913000
         C     @05,@CF00067                                        0226 00914000
         BNE   @RF00226                                            0226 00915000
*           DO;                     /* QUE AND GO GET NEXT ELEMENT   */ 00916000
*             VINDX=VINDX+F1;       /* INCREMENT VERTICAL INDEX      */ 00917000
         LA    @05,1                                               0228 00918000
         ALR   VINDX,@05                                           0228 00919000
*             VQUE(VINDX)=QUE(N);   /* COPY ELEMENT TO VERTICAL QUE  */ 00920000
         LR    @15,VINDX                                           0229 00921000
         SLA   @15,3                                               0229 00922000
         L     @14,@PC00001+4                                      0229 00923000
         AH    @05,CLEN(,@14)                                      0229 00924000
         SLA   @05,4                                               0229 00925000
         ALR   @05,@08                                             0229 00926000
         ALR   @05,@15                                             0229 00927000
         AL    @05,@CF00382                                        0229 00928000
         ALR   @08,@07                                             0229 00929000
         AL    @08,@CF00382                                        0229 00930000
         MVC   VQUE(8,@05),QUE(@08)                                0229 00931000
*           END;                    /*                               */ 00932000
*         ELSE                      /* IF NOT A LEFT PAREN, CHECK IF    00933000
*                                      IT IS                         */ 00934000
*           IF QVAL(N)=RPAREN THEN  /* A RIGHT PAREN. IF IT IS, THEN    00935000
*                                      EMPTY                         */ 00936000
         B     @RC00226                                            0231 00937000
@RF00226 L     @08,N                                               0231 00938000
         SLA   @08,3                                               0231 00939000
         L     @07,QBASE                                           0231 00940000
         AL    @07,@CF00382                                        0231 00941000
         L     @08,QVAL(@08,@07)                                   0231 00942000
         C     @08,@CF00091                                        0231 00943000
         BNE   @RF00231                                            0231 00944000
*             DO;                   /* VERTICAL QUE DOWN TO LEFT   0232 00945000
*                                      PAREN                         */ 00946000
*               DO WHILE VVAL(VINDX)^=LPAREN;/* DO UNTIL LEFT PAREN  */ 00947000
         B     @DE00233                                            0233 00948000
@DL00233 DS    0H                                                  0234 00949000
*                 CALL POPUP;       /* POP OPERATOR OFF VERTICLE QUE */ 00950000
         BAL   @14,POPUP                                           0234 00951000
*               END;                /*                               */ 00952000
@DE00233 LR    @08,VINDX                                           0235 00953000
         SLA   @08,3                                               0235 00954000
         L     @07,@PC00001+4                                      0235 00955000
         LA    @05,1                                               0235 00956000
         AH    @05,CLEN(,@07)                                      0235 00957000
         SLA   @05,4                                               0235 00958000
         AL    @05,QBASE                                           0235 00959000
         AL    @05,@CF00382                                        0235 00960000
         L     @08,VVAL(@08,@05)                                   0235 00961000
         C     @08,@CF00067                                        0235 00962000
         BNE   @DL00233                                            0235 00963000
*               VINDX=VINDX-F1;     /* THROUGH AWAY LEFT PAREN AND 0236 00964000
*                                      GET NEW                       */ 00965000
         BCTR  VINDX,0                                             0236 00966000
*             END;                  /* ELEMENT                       */ 00967000
*           ELSE                    /* IF NEITHER PAREN, THEN      0238 00968000
*                                      DETERMINE                     */ 00969000
*                                                                  0238 00970000
*             /*******************************************************/ 00971000
*             /*                                                     */ 00972000
*             /* PROCESS OPERATOR                                    */ 00973000
*             /*                                                     */ 00974000
*             /*******************************************************/ 00975000
*                                                                  0238 00976000
*             DO;                   /* WHERE TO PUT OPERATOR         */ 00977000
         B     @RC00231                                            0238 00978000
@RF00231 DS    0H                                                  0239 00979000
*               PUSH=NO;            /* DO UNTIL OPERATOR IS ON VERT     00980000
*                                      QUE                           */ 00981000
         NI    PUSH,B'11110111'                                    0239 00982000
*               DO WHILE PUSH=NO;   /*                               */ 00983000
         B     @DE00240                                            0240 00984000
@DL00240 DS    0H                                                  0241 00985000
*                 IF VINDX=F0|VVAL(VINDX)=LPAREN THEN/* IF VERT EMPTY*/ 00986000
         LTR   VINDX,VINDX                                         0241 00987000
         BZ    @RT00241                                            0241 00988000
         LR    @08,VINDX                                           0241 00989000
         SLA   @08,3                                               0241 00990000
         L     @07,@PC00001+4                                      0241 00991000
         LA    @05,1                                               0241 00992000
         AH    @05,CLEN(,@07)                                      0241 00993000
         SLA   @05,4                                               0241 00994000
         AL    @05,QBASE                                           0241 00995000
         AL    @05,@CF00382                                        0241 00996000
         L     @08,VVAL(@08,@05)                                   0241 00997000
         C     @08,@CF00067                                        0241 00998000
         BNE   @RF00241                                            0241 00999000
@RT00241 DS    0H                                                  0242 01000000
*                   PUSH=YES;       /* OR LAST VERT LPAREN, PUSH OPER   01001000
*                                      NOW                           */ 01002000
         OI    PUSH,B'00001000'                                    0242 01003000
*                 ELSE              /* OR IF NEW STRENGTH > OLD    0243 01004000
*                                      STRENGTH PUSH                 */ 01005000
*                   IF QSTREN(N)>VSTREN(VINDX) THEN/* NOW            */ 01006000
         B     @RC00241                                            0243 01007000
@RF00241 L     @08,QBASE                                           0243 01008000
         L     @07,N                                               0243 01009000
         SLA   @07,3                                               0243 01010000
         LR    @05,VINDX                                           0243 01011000
         SLA   @05,3                                               0243 01012000
         L     @15,@PC00001+4                                      0243 01013000
         LA    @14,1                                               0243 01014000
         AH    @14,CLEN(,@15)                                      0243 01015000
         SLA   @14,4                                               0243 01016000
         ALR   @14,@08                                             0243 01017000
         BCTR  @08,0                                               0243 01018000
         BCTR  @08,0                                               0243 01019000
         SLR   @15,@15                                             0243 01020000
         IC    @15,QSTREN-6(@07,@08)                               0243 01021000
         BCTR  @14,0                                               0243 01022000
         BCTR  @14,0                                               0243 01023000
         SLR   @08,@08                                             0243 01024000
         IC    @08,VSTREN-6(@05,@14)                               0243 01025000
         CR    @15,@08                                             0243 01026000
         BNH   @RF00243                                            0243 01027000
*                     PUSH=YES;     /*                               */ 01028000
         OI    PUSH,B'00001000'                                    0244 01029000
*                   ELSE            /* IF NONE OF THE ABOVE, POP OPER   01030000
*                                      OFF VERT                      */ 01031000
*                     CALL POPUP;   /* AND TRY TO PUSH AGAIN         */ 01032000
         B     @RC00243                                            0245 01033000
@RF00243 BAL   @14,POPUP                                           0245 01034000
*               END;                /*                               */ 01035000
@RC00243 DS    0H                                                  0246 01036000
@RC00241 DS    0H                                                  0246 01037000
@DE00240 TM    PUSH,B'00001000'                                    0246 01038000
         BZ    @DL00240                                            0246 01039000
*               VINDX=VINDX+F1;     /* INCREMENT VERTICAL INDEX      */ 01040000
         LA    @08,1                                               0247 01041000
         ALR   VINDX,@08                                           0247 01042000
*               VQUE(VINDX)=QUE(N); /* COPY (PUSH) CURRENT OPER ON 0248 01043000
*                                      VERT                          */ 01044000
         LR    @07,VINDX                                           0248 01045000
         SLA   @07,3                                               0248 01046000
         L     @05,QBASE                                           0248 01047000
         L     @15,@PC00001+4                                      0248 01048000
         AH    @08,CLEN(,@15)                                      0248 01049000
         SLA   @08,4                                               0248 01050000
         ALR   @08,@05                                             0248 01051000
         ALR   @08,@07                                             0248 01052000
         AL    @08,@CF00382                                        0248 01053000
         L     @07,N                                               0248 01054000
         SLA   @07,3                                               0248 01055000
         ALR   @05,@07                                             0248 01056000
         AL    @05,@CF00382                                        0248 01057000
         MVC   VQUE(8,@08),QUE(@05)                                0248 01058000
*             END;                  /* QUE                           */ 01059000
*       END;                        /*                               */ 01060000
@RC00231 DS    0H                                                  0250 01061000
@RC00226 DS    0H                                                  0251 01062000
*   END;                            /*                               */ 01063000
@RC00216 LA    @08,1                                               0251 01064000
         AL    @08,N                                               0251 01065000
@DE00215 ST    @08,N                                               0251 01066000
         CR    @08,MAXX                                            0251 01067000
         BNH   @DL00215                                            0251 01068000
*   DO WHILE VINDX^=F0;             /* IF OPERATORS ARE LEFT ON VERT */ 01069000
         B     @DE00252                                            0252 01070000
@DL00252 DS    0H                                                  0253 01071000
*     IF VVAL(VINDX)=LPAREN THEN    /* QUE, THROW AWAY LEFT PARENS   */ 01072000
         LR    @08,VINDX                                           0253 01073000
         SLA   @08,3                                               0253 01074000
         L     @07,@PC00001+4                                      0253 01075000
         LA    @05,1                                               0253 01076000
         AH    @05,CLEN(,@07)                                      0253 01077000
         SLA   @05,4                                               0253 01078000
         AL    @05,QBASE                                           0253 01079000
         AL    @05,@CF00382                                        0253 01080000
         L     @08,VVAL(@08,@05)                                   0253 01081000
         C     @08,@CF00067                                        0253 01082000
         BNE   @RF00253                                            0253 01083000
*       VINDX=VINDX-F1;             /*                               */ 01084000
         BCTR  VINDX,0                                             0254 01085000
*     ELSE                          /* OTHERWISE                     */ 01086000
*       CALL POPUP;                 /* POP OPERATOR OFF VERTICAL QUE */ 01087000
         B     @RC00253                                            0255 01088000
@RF00253 BAL   @14,POPUP                                           0255 01089000
*   END;                            /*                               */ 01090000
@RC00253 DS    0H                                                  0256 01091000
@DE00252 LTR   VINDX,VINDX                                         0256 01092000
         BNZ   @DL00252                                            0256 01093000
*   MAXX=OUTQDX-F1;                 /* SET MAXX TO NUMBER OF ELEMENTS*/ 01094000
         LR    MAXX,OUTQDX                                         0257 01095000
         BCTR  MAXX,0                                              0257 01096000
*   QEND(MAXX)=YES;                 /* TURN ON END OF PROCESSING BIT */ 01097000
         LR    @08,MAXX                                            0258 01098000
         SLA   @08,3                                               0258 01099000
         L     @07,QBASE                                           0258 01100000
         ALR   @07,@08                                             0258 01101000
         BCTR  @07,0                                               0258 01102000
         OI    QEND-7(@07),B'00000010'                             0258 01103000
*   EXITA=NO;                       /* RESET EXITA SWITCH            */ 01104000
         NI    EXITA,B'10111111'                                   0259 01105000
*   OUTPTR=ADDR(OUTAREA);           /* POINT TO OUTAREA FOR UNPK ETC.*/ 01106000
         L     OUTPTR,@PC00001+12                                  0260 01107000
*   DO WHILE EXITA=NO&ERROR=F0;     /* DO UNTIL DONE OR ERROR        */ 01108000
         B     @DE00261                                            0261 01109000
@DL00261 DS    0H                                                  0262 01110000
*     OPFND=NO;                     /* RESET OPFND SWITCH            */ 01111000
*                                                                  0262 01112000
         NI    OPFND,B'01111111'                                   0262 01113000
*     /***************************************************************/ 01114000
*     /*                                                             */ 01115000
*     /* FIND OPERATOR                                               */ 01116000
*     /*                                                             */ 01117000
*     /***************************************************************/ 01118000
*                                                                  0263 01119000
*     DO I=1 TO MAXX WHILE OPFND=NO;/* FIND NON PROCESSED OPERATOR   */ 01120000
         LA    I,1                                                 0263 01121000
         B     @DE00263                                            0263 01122000
@DL00263 TM    OPFND,B'10000000'                                   0263 01123000
         BNZ   @DC00263                                            0263 01124000
*       IF QSKIP(I)=NO&QOPER(I)=YES THEN/* IF NON PROCESSED OPERATOR */ 01125000
         LR    @08,I                                               0264 01126000
         SLA   @08,3                                               0264 01127000
         L     @07,QBASE                                           0264 01128000
         ALR   @07,@08                                             0264 01129000
         BCTR  @07,0                                               0264 01130000
         TM    QOPER-7(@07),B'10000000'                            0264 01131000
         BNO   @RF00264                                            0264 01132000
         TM    QSKIP-7(@07),B'00100000'                            0264 01133000
         BNZ   @RF00264                                            0264 01134000
*         OPFND=YES;                /* SET SWITCH                    */ 01135000
         OI    OPFND,B'10000000'                                   0265 01136000
*     END;                          /*                               */ 01137000
@RF00264 AL    I,@CF00082                                          0266 01138000
@DE00263 CR    I,MAXX                                              0266 01139000
         BNH   @DL00263                                            0266 01140000
@DC00263 DS    0H                                                  0267 01141000
*     K=I-F1;                       /* SAVE INDEX TO OPERATOR        */ 01142000
         LR    K,I                                                 0267 01143000
         BCTR  K,0                                                 0267 01144000
*     IF QEND(K)=YES THEN           /* IF LAST OPERATION,SET EXIT    */ 01145000
         LR    @08,K                                               0268 01146000
         SLA   @08,3                                               0268 01147000
         L     @07,QBASE                                           0268 01148000
         ALR   @07,@08                                             0268 01149000
         BCTR  @07,0                                               0268 01150000
         TM    QEND-7(@07),B'00000010'                             0268 01151000
         BNO   @RF00268                                            0268 01152000
*       EXITA=YES;                  /* SWITCH                        */ 01153000
         OI    EXITA,B'01000000'                                   0269 01154000
*     CALL LOAD;                    /* LOAD DATA FOR PROCESSING      */ 01155000
@RF00268 BAL   @14,LOAD                                            0270 01156000
*     IF ERROR=F0 THEN              /* IF LOAD SUCCESSFUL, PROCESS   */ 01157000
         LTR   ERROR,ERROR                                         0271 01158000
         BNZ   @RF00271                                            0271 01159000
*       DO;                         /*                               */ 01160000
*                                                                  0272 01161000
*         /***********************************************************/ 01162000
*         /*                                                         */ 01163000
*         /* PERFORM FUNCTION                                        */ 01164000
*         /*                                                         */ 01165000
*         /***********************************************************/ 01166000
*                                                                  0273 01167000
*         ANS=FALSE;                /* RESET FALSE SWITCH            */ 01168000
         NI    ANS,B'11111011'                                     0273 01169000
*         CALL ROUTINE;             /* CALL ROUTINE TO PROCESS DATA  */ 01170000
         LR    @08,K                                               0274 01171000
         SLA   @08,3                                               0274 01172000
         L     @07,QBASE                                           0274 01173000
         AL    @07,@CF00382                                        0274 01174000
         L     @08,QVAL(@08,@07)                                   0274 01175000
         SLA   @08,4                                               0274 01176000
         L     @15,VECTOR-16(@08)                                  0274 01177000
         BALR  @14,@15                                             0274 01178000
*         IF TYPE=RELAT&(QEXCLU(K)=YES|QCOMB(K)=YES) THEN/* UPDATE   */ 01179000
         L     @08,@PC00001+8                                      0275 01180000
         CLC   TYPE(4,@08),@CF00058                                0275 01181000
         BNE   @RF00275                                            0275 01182000
         L     @08,QBASE                                           0275 01183000
         LR    @07,K                                               0275 01184000
         SLA   @07,3                                               0275 01185000
         ST    @07,@TF00001                                        0275 01186000
         ALR   @07,@08                                             0275 01187000
         BCTR  @07,0                                               0275 01188000
         TM    QEXCLU-7(@07),B'00001001'                           0275 01189000
         BZ    @RF00275                                            0275 01190000
*           DO;                     /* PROCESS TRUE/FALSE            */ 01191000
*             IF QNOT(K)=YES THEN   /* IF 'NOT' IS SPECIFIED, REVERSE*/ 01192000
         AL    @08,@TF00001                                        0277 01193000
         BCTR  @08,0                                               0277 01194000
         TM    QNOT-7(@08),B'00000100'                             0277 01195000
         BNO   @RF00277                                            0277 01196000
*               IF ANS=TRUE THEN    /* IF ANSWER IS TRUE, SET FALSE  */ 01197000
         TM    ANS,B'00000100'                                     0278 01198000
         BNO   @RF00278                                            0278 01199000
*                 ANS=FALSE;        /*                               */ 01200000
         NI    ANS,B'11111011'                                     0279 01201000
*               ELSE                /* OTHERWISE MAKE IT TRUE        */ 01202000
*                 ANS=TRUE;         /*                               */ 01203000
         B     @RC00278                                            0280 01204000
@RF00278 OI    ANS,B'00000100'                                     0280 01205000
*             IF ANS=TRUE THEN      /* IF ANS IS TRUE THEN           */ 01206000
@RC00278 DS    0H                                                  0281 01207000
@RF00277 TM    ANS,B'00000100'                                     0281 01208000
         BNO   @RF00281                                            0281 01209000
*               QVAL(K)=F0;         /* SAVE A TRUE ANSWER            */ 01210000
         LR    @08,K                                               0282 01211000
         SLA   @08,3                                               0282 01212000
         SLR   @07,@07                                             0282 01213000
         L     @05,QBASE                                           0282 01214000
         AL    @05,@CF00382                                        0282 01215000
         ST    @07,QVAL(@08,@05)                                   0282 01216000
*             ELSE                  /* OTHERWISE                     */ 01217000
*               QVAL(K)=F4;         /* STORE A FALSE ANSWER          */ 01218000
         B     @RC00281                                            0283 01219000
@RF00281 LR    @08,K                                               0283 01220000
         SLA   @08,3                                               0283 01221000
         LA    @07,4                                               0283 01222000
         L     @05,QBASE                                           0283 01223000
         AL    @05,@CF00382                                        0283 01224000
         ST    @07,QVAL(@08,@05)                                   0283 01225000
*             QSTREN(K)=F2;         /* CHANGE STRENGTH               */ 01226000
@RC00281 L     @08,QBASE                                           0284 01227000
         LR    @07,K                                               0284 01228000
         SLA   @07,3                                               0284 01229000
         LA    @05,2                                               0284 01230000
         LA    @01,0(@07,@08)                                      0284 01231000
         BCTR  @01,0                                               0284 01232000
         BCTR  @01,0                                               0284 01233000
         STC   @05,QSTREN-6(,@01)                                  0284 01234000
*             QTEMP(K)=YES;         /* SET TEMP SWITCH               */ 01235000
         ALR   @08,@07                                             0285 01236000
         BCTR  @08,0                                               0285 01237000
         OI    QTEMP-7(@08),B'01000000'                            0285 01238000
*           END;                                                   0286 01239000
*       END;                        /*                               */ 01240000
@RF00275 DS    0H                                                  0288 01241000
*   END;                            /*                               */ 01242000
@RF00271 DS    0H                                                  0288 01243000
@DE00261 TM    EXITA,B'01000000'                                   0288 01244000
         BNZ   @DC00261                                            0288 01245000
         LTR   ERROR,ERROR                                         0288 01246000
         BZ    @DL00261                                            0288 01247000
@DC00261 DS    0H                                                  0289 01248000
*                                                                  0289 01249000
*   /*****************************************************************/ 01250000
*   /*                                                               */ 01251000
*   /* FREE CORE USED AND EXIT TO CALLER                             */ 01252000
*   /*                                                               */ 01253000
*   /*****************************************************************/ 01254000
*                                                                  0289 01255000
*   IF TYPE=RELAT&ERROR=F0 THEN     /* IF RELATIONAL ENTRY, SET    0289 01256000
*                                      APPRO-                        */ 01257000
         L     @08,@PC00001+8                                      0289 01258000
         CLC   TYPE(4,@08),@CF00058                                0289 01259000
         BNE   @RF00289                                            0289 01260000
         LTR   ERROR,ERROR                                         0289 01261000
         BNZ   @RF00289                                            0289 01262000
*     IF ANS=FALSE THEN             /* RETURN CODE                   */ 01263000
         TM    ANS,B'00000100'                                     0290 01264000
         BNZ   @RF00290                                            0290 01265000
*       ERROR=E4;                   /*                               */ 01266000
         LA    ERROR,4                                             0291 01267000
*   TYPE=OUTPTR;                    /* SET OUTPUT ADDR FOR CALLER    */ 01268000
@RF00290 DS    0H                                                  0292 01269000
@RF00289 L     @08,@PC00001+8                                      0292 01270000
         ST    OUTPTR,TYPE(,@08)                                   0292 01271000
*   IF TOOBIG=YES THEN              /* IF MAX VALUE EXCEEDED @ZA04832*/ 01272000
         TM    TOOBIG,B'00000100'                                  0293 01273000
         BNO   @RF00293                                            0293 01274000
*     ERROR=E832;                   /* MAX VAL EXCEEDED CODE @ZA04832*/ 01275000
         LA    ERROR,832                                           0294 01276000
*EXIT:                                                             0295 01277000
*   DO;                             /* FREEMAIN (E) LV(HOWMUCH)    0295 01278000
*                                      A(QBASE) SP(F1)               */ 01279000
@RF00293 DS    0H                                                  0295 01280000
EXIT     DS    0H                                                  0296 01281000
*     RESPECIFY                                                    0296 01282000
*      (GPR01P) RESTRICTED;                                        0296 01283000
*     I005=I005&&I005;              /* INIT LIST                     */ 01284000
         XC    I005(10),I005                                       0297 01285000
*     I00505='00'X;                 /* SET TYPE                      */ 01286000
         MVI   I00505,X'00'                                        0298 01287000
*     I00502=HOWMUCH;               /* LENGTH                        */ 01288000
         STCM  HOWMUCH,7,I00502                                    0299 01289000
*     I00504=ADDR(QBASE);           /* ADDR OF ADDR LIST             */ 01290000
         LA    @07,QBASE                                           0300 01291000
         STCM  @07,7,I00504                                        0300 01292000
*     I00506=F1;                    /* SUBPOOL VALUE                 */ 01293000
         MVI   I00506,X'01'                                        0301 01294000
*     GPR01P=ADDR(I005);            /* REG1 POINTS TO LIST           */ 01295000
         LA    GPR01P,I005                                         0302 01296000
*     SVC(5);                       /* STANDARD-FORM OF GETMAIN      */ 01297000
         SVC   5                                                   0303 01298000
*     RESPECIFY                                                    0304 01299000
*      (GPR01P) UNRESTRICTED;                                      0304 01300000
*   END;                            /* FREEMAIN (E) LV(HOWMUCH)    0305 01301000
*                                      A(QBASE) SP(F1) FREE QUES     */ 01302000
*NOFREEXT:                                                         0306 01303000
*   RETURN CODE(ERROR);             /* RETURN TO CALLER WITH ERROR 0306 01304000
*                                      CODE                          */ 01305000
NOFREEXT L     @13,4(,@13)                                         0306 01306000
         L     @00,@SIZDATD                                        0306 01307000
         LR    @01,@10                                             0306 01308000
         FREEMAIN R,LV=(0),A=(1)                                        01309000
         LR    @15,@06                                             0306 01310000
         L     @14,12(,@13)                                        0306 01311000
         LM    @00,@12,20(@13)                                     0306 01312000
         BR    @14                                                 0306 01313000
*                                                                  0307 01314000
*   /*****************************************************************/ 01315000
*   /*                                                               */ 01316000
*   /* LOAD ROUTINE                                                  */ 01317000
*   /*                                                               */ 01318000
*   /*****************************************************************/ 01319000
*                                                                  0307 01320000
*LOAD:                                                             0307 01321000
*   PROC;                                                          0307 01322000
@EL00001 L     @13,4(,@13)                                         0307 01323000
@EF00001 L     @00,@SIZDATD                                        0307 01324000
         LR    @01,@10                                             0307 01325000
         FREEMAIN R,LV=(0),A=(1)                                        01326000
@ER00001 LM    @14,@12,12(@13)                                     0307 01327000
         BR    @14                                                 0307 01328000
LOAD     STM   @14,@05,12(@13)                                     0307 01329000
         STM   @07,@12,48(@13)                                     0307 01330000
*   VINDX=F2;                       /* SET UP VARIABLE COUNTER       */ 01331000
         LA    VINDX,2                                             0308 01332000
*   DO I=K-1 TO 1 BY-1 WHILE VINDX>F0;/* SEARCH BACKWARDS FOR TWO  0309 01333000
*                                      DATA                          */ 01334000
         LR    I,K                                                 0309 01335000
         BCTR  I,0                                                 0309 01336000
         B     @DE00309                                            0309 01337000
@DL00309 LTR   VINDX,VINDX                                         0309 01338000
         BNP   @DC00309                                            0309 01339000
*     IF QSKIP(I)=NO THEN           /* ELEMENTS THAT ARE ELIGIBLE    */ 01340000
         L     @07,QBASE                                           0310 01341000
         LR    @03,I                                               0310 01342000
         SLA   @03,3                                               0310 01343000
         ALR   @03,@07                                             0310 01344000
         BCTR  @03,0                                               0310 01345000
         TM    QSKIP-7(@03),B'00100000'                            0310 01346000
         BNZ   @RF00310                                            0310 01347000
*       DO;                         /*                               */ 01348000
*         V(VINDX)=I;               /* SET V1 OR V2 TO CURRENT INDEX */ 01349000
         LR    @03,VINDX                                           0312 01350000
         SLA   @03,2                                               0312 01351000
         ST    I,V-4(@03)                                          0312 01352000
*         IF QPREFX(K)=YES THEN     /* IF A PREFIX OPERATOR          */ 01353000
         LR    @03,K                                               0313 01354000
         SLA   @03,3                                               0313 01355000
         ALR   @07,@03                                             0313 01356000
         BCTR  @07,0                                               0313 01357000
         TM    QPREFX-7(@07),B'00010000'                           0313 01358000
         BNO   @RF00313                                            0313 01359000
*           VINDX=F0;               /* USE ONLY ONE DATA ELEMENT     */ 01360000
         SLR   VINDX,VINDX                                         0314 01361000
*         ELSE                      /* OTHERWISE                     */ 01362000
*           VINDX=VINDX-F1;         /* DECREMENT INDEX               */ 01363000
         B     @RC00313                                            0315 01364000
@RF00313 BCTR  VINDX,0                                             0315 01365000
*         QSKIP(I)=YES;             /* CAUSE SKIPPING OF THIS ELEMENT*/ 01366000
@RC00313 LR    @07,I                                               0316 01367000
         SLA   @07,3                                               0316 01368000
         L     @03,QBASE                                           0316 01369000
         ALR   @03,@07                                             0316 01370000
         BCTR  @03,0                                               0316 01371000
         OI    QSKIP-7(@03),B'00100000'                            0316 01372000
*       END;                        /*                               */ 01373000
*   END;                            /* V1 AND V2 POINT TO TWO DATA 0318 01374000
*                                      ELEMENTS (PREFIX ONLY V2)     */ 01375000
@RF00310 BCTR  I,0                                                 0318 01376000
@DE00309 LTR   I,I                                                 0318 01377000
         BP    @DL00309                                            0318 01378000
@DC00309 DS    0H                                                  0319 01379000
*   IF(QPREFX(K)=NO&(V1^=F1|TYPE=RELAT)&QSTREN(V1)=F1)|/* IF ALPHA   */ 01380000
*       QSTREN(V2)=F1 THEN          /* IN A DATA ELEMENT             */ 01381000
         LR    @07,K                                               0319 01382000
         SLA   @07,3                                               0319 01383000
         L     @05,QBASE                                           0319 01384000
         ALR   @05,@07                                             0319 01385000
         BCTR  @05,0                                               0319 01386000
         TM    QPREFX-7(@05),B'00010000'                           0319 01387000
         BNZ   @GL00032                                            0319 01388000
         CLC   V1(4),@CF00082                                      0319 01389000
         BNE   @GL00033                                            0319 01390000
         L     @07,@PC00001+8                                      0319 01391000
         CLC   TYPE(4,@07),@CF00058                                0319 01392000
         BNE   @GL00032                                            0319 01393000
@GL00033 L     @07,V1                                              0319 01394000
         SLA   @07,3                                               0319 01395000
         L     @05,QBASE                                           0319 01396000
         BCTR  @05,0                                               0319 01397000
         BCTR  @05,0                                               0319 01398000
         SLR   @15,@15                                             0319 01399000
         IC    @15,QSTREN-6(@07,@05)                               0319 01400000
         C     @15,@CF00082                                        0319 01401000
         BE    @RT00319                                            0319 01402000
@GL00032 L     @07,V2                                              0319 01403000
         SLA   @07,3                                               0319 01404000
         L     @05,QBASE                                           0319 01405000
         BCTR  @05,0                                               0319 01406000
         BCTR  @05,0                                               0319 01407000
         SLR   @15,@15                                             0319 01408000
         IC    @15,QSTREN-6(@07,@05)                               0319 01409000
         C     @15,@CF00082                                        0319 01410000
         BNE   @RF00319                                            0319 01411000
@RT00319 DS    0H                                                  0320 01412000
*     DO;                           /* CAUSE ALPHA MODE TO BE USED   */ 01413000
*       ALPHA=YES;                  /* SET ALPHA SWITCH              */ 01414000
         OI    ALPHA,B'10000000'                                   0321 01415000
*       IF QTEMP(V2)=YES|(QPREFX(K)=NO&QTEMP(V1)=YES) THEN/* IF    0322 01416000
*                                      EITHER DATA ELEMENT HAS A   0322 01417000
*                                      TEMPORARY VALUE, ALPHA MODE IS   01418000
*                                      IN ERROR                      */ 01419000
         L     @07,QBASE                                           0322 01420000
         L     @05,V2                                              0322 01421000
         SLA   @05,3                                               0322 01422000
         ALR   @05,@07                                             0322 01423000
         BCTR  @05,0                                               0322 01424000
         TM    QTEMP-7(@05),B'01000000'                            0322 01425000
         BO    @RT00322                                            0322 01426000
         LR    @05,K                                               0322 01427000
         SLA   @05,3                                               0322 01428000
         ALR   @05,@07                                             0322 01429000
         BCTR  @05,0                                               0322 01430000
         TM    QPREFX-7(@05),B'00010000'                           0322 01431000
         BNZ   @RF00322                                            0322 01432000
         L     @05,V1                                              0322 01433000
         SLA   @05,3                                               0322 01434000
         ALR   @07,@05                                             0322 01435000
         BCTR  @07,0                                               0322 01436000
         TM    QTEMP-7(@07),B'01000000'                            0322 01437000
         BNO   @RF00322                                            0322 01438000
@RT00322 DS    0H                                                  0323 01439000
*         ERROR=E848;               /* SET ERROR CODE                */ 01440000
         LA    ERROR,848                                           0323 01441000
*       ELSE                        /* OTHERWISE                     */ 01442000
*         IF QPREFX(K)=YES THEN     /* IF A PREFIX OPERATOR          */ 01443000
         B     @RC00322                                            0324 01444000
@RF00322 LR    @07,K                                               0324 01445000
         SLA   @07,3                                               0324 01446000
         L     @05,QBASE                                           0324 01447000
         ALR   @05,@07                                             0324 01448000
         BCTR  @05,0                                               0324 01449000
         TM    QPREFX-7(@05),B'00010000'                           0324 01450000
         BNO   @RF00324                                            0324 01451000
*           ERROR=E868;             /* SET THE ERROR CODE            */ 01452000
         LA    ERROR,868                                           0325 01453000
*     END;                          /*                               */ 01454000
*                                                                  0327 01455000
*   /*****************************************************************/ 01456000
*   /*                                                               */ 01457000
*   /* PROCESS NUMERIC                                               */ 01458000
*   /*                                                               */ 01459000
*   /*****************************************************************/ 01460000
*                                                                  0327 01461000
*   ELSE                            /* IF NUMERIC                    */ 01462000
*     DO;                           /*                               */ 01463000
         B     @RC00319                                            0327 01464000
@RF00319 DS    0H                                                  0328 01465000
*       ALPHA=NO;                   /* SET ALPHA SWITCH              */ 01466000
         NI    ALPHA,B'01111111'                                   0328 01467000
*       DO VINDX=2 TO 1 BY-1;       /* SET UP TO CONVERT CHARACTER   */ 01468000
         LA    VINDX,2                                             0329 01469000
@DL00329 DS    0H                                                  0330 01470000
*         I=V(VINDX);               /* TO BINARY FOR ARITHMETIC      */ 01471000
         LR    @07,VINDX                                           0330 01472000
         SLA   @07,2                                               0330 01473000
         L     I,V-4(@07)                                          0330 01474000
*         IF(QPREFX(K)=YES&VINDX=F1)|(I=F1&TYPE=NUMBR) THEN/*        */ 01475000
         LR    @07,K                                               0331 01476000
         SLA   @07,3                                               0331 01477000
         L     @03,QBASE                                           0331 01478000
         ALR   @03,@07                                             0331 01479000
         BCTR  @03,0                                               0331 01480000
         TM    QPREFX-7(@03),B'00010000'                           0331 01481000
         BNO   @GL00038                                            0331 01482000
         C     VINDX,@CF00082                                      0331 01483000
         BE    @RT00331                                            0331 01484000
@GL00038 C     I,@CF00082                                          0331 01485000
         BNE   @RF00331                                            0331 01486000
         L     @07,@PC00001+8                                      0331 01487000
         L     @07,TYPE(,@07)                                      0331 01488000
         LTR   @07,@07                                             0331 01489000
         BNZ   @RF00331                                            0331 01490000
@RT00331 DS    0H                                                  0332 01491000
*           V(1)=F0;                /* SET RETURN TO ZERO            */ 01492000
         SLR   @07,@07                                             0332 01493000
         ST    @07,V                                               0332 01494000
*         ELSE                      /* OTHERWISE LOAD NORMALLY       */ 01495000
*           DO;                     /*                               */ 01496000
*                                                                  0333 01497000
         B     @RC00331                                            0333 01498000
@RF00331 DS    0H                                                  0334 01499000
*             /*******************************************************/ 01500000
*             /*                                                     */ 01501000
*             /* LOAD VALUES INTO V1 AND V2 - V1 AND V2 HAVE VALUES  */ 01502000
*             /*                                                     */ 01503000
*             /*******************************************************/ 01504000
*                                                                  0334 01505000
*             IF QTEMP(I)=NO THEN   /* IF NOT A TEMP, MUST PACK      */ 01506000
         L     @07,QBASE                                           0334 01507000
         LR    @03,I                                               0334 01508000
         SLA   @03,3                                               0334 01509000
         ST    @03,@TF00001                                        0334 01510000
         ALR   @03,@07                                             0334 01511000
         BCTR  @03,0                                               0334 01512000
         TM    QTEMP-7(@03),B'01000000'                            0334 01513000
         BNZ   @RF00334                                            0334 01514000
*               IF QLEN(I)>LENGTH(MAXVAL)|(QLEN(I)=LENGTH(MAXVAL)&/* */ 01515000
*                   QCHAR(1:LENGTH(MAXVAL))>MAXVAL) THEN/* TOO BIG   */ 01516000
         LA    @03,10                                              0335 01517000
         L     @01,@TF00001                                        0335 01518000
         AL    @01,@CF00381                                        0335 01519000
         LH    @15,QLEN-4(@01,@07)                                 0335 01520000
         CR    @15,@03                                             0335 01521000
         BH    @RT00335                                            0335 01522000
         CR    @15,@03                                             0335 01523000
         BNE   @RF00335                                            0335 01524000
         L     @03,@TF00001                                        0335 01525000
         AL    @07,@CF00382                                        0335 01526000
         L     @07,QPTR(@03,@07)                                   0335 01527000
         CLC   QCHAR(10,@07),@CC00118                              0335 01528000
         BNH   @RF00335                                            0335 01529000
@RT00335 DS    0H                                                  0336 01530000
*                 ERROR=E872;       /* IF NUMBER WILL CAUSE CVB TO 0336 01531000
*                                      0C9                           */ 01532000
         LA    ERROR,872                                           0336 01533000
*               ELSE                /* SET ERROR CODE                */ 01534000
*                 DO;               /*                               */ 01535000
         B     @RC00335                                            0337 01536000
@RF00335 DS    0H                                                  0338 01537000
*                   OUTAREA=ZERO;   /* ZERO ALL OF PACKAREA          */ 01538000
         L     @07,@PC00001+12                                     0338 01539000
         MVC   OUTAREA(17,@07),@CC00114                            0338 01540000
*                   OUTAREA(17-QLEN(I):16)=QCHAR(1:QLEN(I));/* RIGHT    01541000
*                                      JUSTIFY                       */ 01542000
         L     @03,QBASE                                           0339 01543000
         LR    @15,I                                               0339 01544000
         SLA   @15,3                                               0339 01545000
         LA    @14,17                                              0339 01546000
         LA    @01,0(@15,@03)                                      0339 01547000
         AL    @01,@CF00381                                        0339 01548000
         SH    @14,QLEN-4(,@01)                                    0339 01549000
         ST    @14,@TF00001                                        0339 01550000
         ALR   @14,@07                                             0339 01551000
         BCTR  @14,0                                               0339 01552000
         LA    @09,16                                              0339 01553000
         SL    @09,@TF00001                                        0339 01554000
         AL    @03,@CF00382                                        0339 01555000
         L     @03,QPTR(@15,@03)                                   0339 01556000
         EX    @09,@SM00396                                        0339 01557000
*                   PACK(WORKAREA,OUTAREA(1:16));/* NUMBER TO BE   0340 01558000
*                                      PACKED                        */ 01559000
         PACK  WORKAREA(8),OUTAREA(16,@07)                         0340 01560000
*                   CVB(V(VINDX),WORKAREA);/* CONVERT NUMBER TO    0341 01561000
*                                      BINARY                        */ 01562000
         CVB   @07,WORKAREA                                        0341 01563000
         LR    @03,VINDX                                           0341 01564000
         SLA   @03,2                                               0341 01565000
         ST    @07,V-4(@03)                                        0341 01566000
*                 END;              /* END PACK LOGIC                */ 01567000
*             ELSE                  /* IF NUMBER IS STORED BINARILY  */ 01568000
*               V(VINDX)=QVAL(I);   /* JUST RETREIVE                 */ 01569000
         B     @RC00334                                            0343 01570000
@RF00334 LR    @07,VINDX                                           0343 01571000
         SLA   @07,2                                               0343 01572000
         LR    @03,I                                               0343 01573000
         SLA   @03,3                                               0343 01574000
         L     @01,QBASE                                           0343 01575000
         AL    @01,@CF00382                                        0343 01576000
         L     @03,QVAL(@03,@01)                                   0343 01577000
         ST    @03,V-4(@07)                                        0343 01578000
*             QSKIP(I)=YES;         /* CAUSE SKIPPING OF THIS ELEMENT*/ 01579000
@RC00334 LR    @07,I                                               0344 01580000
         SLA   @07,3                                               0344 01581000
         L     @03,QBASE                                           0344 01582000
         ALR   @03,@07                                             0344 01583000
         BCTR  @03,0                                               0344 01584000
         OI    QSKIP-7(@03),B'00100000'                            0344 01585000
*           END;                    /*                               */ 01586000
*       END;                        /*                               */ 01587000
@RC00331 BCTR  VINDX,0                                             0346 01588000
         LTR   VINDX,VINDX                                         0346 01589000
         BP    @DL00329                                            0346 01590000
*     END;                          /*                               */ 01591000
*   QOPER(K)=NO;                    /* MAKE CURRENT ELEMENT A DATA EL*/ 01592000
@RC00319 LR    @07,K                                               0348 01593000
         SLA   @07,3                                               0348 01594000
         L     @05,QBASE                                           0348 01595000
         ALR   @05,@07                                             0348 01596000
         BCTR  @05,0                                               0348 01597000
         NI    QOPER-7(@05),B'01111111'                            0348 01598000
*   END LOAD;                       /* END OF LOAD PROC              */ 01599000
@EL00002 DS    0H                                                  0349 01600000
@EF00002 DS    0H                                                  0349 01601000
@ER00002 LM    @14,@05,12(@13)                                     0349 01602000
         LM    @07,@12,48(@13)                                     0349 01603000
         BR    @14                                                 0349 01604000
*                                                                  0350 01605000
*   /*****************************************************************/ 01606000
*   /*                                                               */ 01607000
*   /* ADD ROUTINE - ADD TWO NUMBERS TOGETHER                        */ 01608000
*   /*                                                               */ 01609000
*   /*****************************************************************/ 01610000
*                                                                  0350 01611000
*ADDRTN:                                                           0350 01612000
*   PROC;                                                          0350 01613000
ADDRTN   STM   @14,@05,@SA00003                                    0350 01614000
         STM   @07,@12,@SA00003+32                                 0350 01615000
*   IF ALPHA=YES THEN               /* IF DATA IS ALPHA              */ 01616000
         TM    ALPHA,B'10000000'                                   0351 01617000
         BNO   @RF00351                                            0351 01618000
*     ERROR=E852;                   /* SET ERROR CODE                */ 01619000
         LA    ERROR,852                                           0352 01620000
*   ELSE                            /* OTHERWISE PROCESS             */ 01621000
*     DO;                           /*                               */ 01622000
         B     @RC00351                                            0353 01623000
@RF00351 DS    0H                                                  0354 01624000
*       RFY                                                        0354 01625000
*        (R1) RSTD;                 /* RESTRICT WORK REG     @ZA04832*/ 01626000
*       GEN REFS(V1,V2,R1)          /*                       @ZA04832*/ 01627000
*           SETS(V1,R1);                                           0355 01628000
*                                  /*                       @ZA04832*/  01629000
        L     R1,V1                LOAD V1                  @ZA04832*/  01630000
        A     R1,V2                ADD V2 TO V1             @ZA04832*/  01631000
        ST    R1,V1                SAVE SUM IN V1           @ZA04832*/  01632000
*       RFY                                                        0356 01633000
*        (R1) UNRSTD;               /* MAKE WORK REG AVAIL   @ZA04832*/ 01634000
*       BC(OVERFLOW,AOFLOW);        /* DETECT F.P. OVERFLOW  @ZA04832*/ 01635000
         BC    1,AOFLOW                                            0357 01636000
*ADD2:                                                             0358 01637000
*       QVAL(K)=V1;                 /* SAVE SUM IN TEMP AREA @ZA04832*/ 01638000
ADD2     L     @07,QBASE                                           0358 01639000
         LR    @05,K                                               0358 01640000
         SLA   @05,3                                               0358 01641000
         L     @15,V1                                              0358 01642000
         LA    @14,0(@05,@07)                                      0358 01643000
         AL    @14,@CF00382                                        0358 01644000
         ST    @15,QVAL(,@14)                                      0358 01645000
*       QTEMP(K)=YES;               /* TURN ON TEMP BIT              */ 01646000
         ALR   @07,@05                                             0359 01647000
         BCTR  @07,0                                               0359 01648000
         OI    QTEMP-7(@07),B'01000000'                            0359 01649000
*       RETURN;                     /*                       @ZA04832*/ 01650000
@EL00003 DS    0H                                                  0360 01651000
@EF00003 DS    0H                                                  0360 01652000
@ER00003 LM    @14,@05,@SA00003                                    0360 01653000
         LM    @07,@12,@SA00003+32                                 0360 01654000
         BR    @14                                                 0360 01655000
*     END;                          /*                               */ 01656000
*AOFLOW:                                                           0362 01657000
*   TOOBIG=YES;                     /* INDICATE OVERFLOW     @ZA04832*/ 01658000
@RC00351 DS    0H                                                  0362 01659000
AOFLOW   OI    TOOBIG,B'00000100'                                  0362 01660000
*   GOTO ADD2;                      /* CONTINUE EVALUATION   @ZA04832*/ 01661000
         B     ADD2                                                0363 01662000
*   END ADDRTN;                     /* END ADD PROC                  */ 01663000
*                                                                  0365 01664000
*   /*****************************************************************/ 01665000
*   /*                                                               */ 01666000
*   /* SUBTRACT ROUTINE - SUBTRACTS TWO NUMBERS                      */ 01667000
*   /*                                                               */ 01668000
*   /*****************************************************************/ 01669000
*                                                                  0365 01670000
*SUBRTN:                                                           0365 01671000
*   PROC;                                                          0365 01672000
SUBRTN   STM   @14,@05,@SA00004                                    0365 01673000
         STM   @07,@12,@SA00004+32                                 0365 01674000
*   IF ALPHA=YES THEN               /* IF ALPHA DATA                 */ 01675000
         TM    ALPHA,B'10000000'                                   0366 01676000
         BNO   @RF00366                                            0366 01677000
*     ERROR=E856;                   /* SET ERROR CODE                */ 01678000
         LA    ERROR,856                                           0367 01679000
*   ELSE                            /* OTHERWISE PROCESS NORMALLY    */ 01680000
*     DO;                           /*                               */ 01681000
         B     @RC00366                                            0368 01682000
@RF00366 DS    0H                                                  0369 01683000
*       RFY                                                        0369 01684000
*        (R1) RSTD;                 /* RESTRICT WORK REG     @ZA04832*/ 01685000
*       GEN REFS(V1,V2,R1)          /*                       @ZA04832*/ 01686000
*           SETS(V1,R1);                                           0370 01687000
*                                  /*                       @ZA04832*/  01688000
        L     R1,V1                LOAD V1                  @ZA04832*/  01689000
        S     R1,V2                SUBTRACT V2 FROM V1      @ZA04832*/  01690000
        ST    R1,V1                SAVE DIFFERENCE IN V1    @ZA04832*/  01691000
*       RFY                                                        0371 01692000
*        (R1) UNRSTD;               /* MAKE WORK REG AVAIL   @ZA04832*/ 01693000
*       BC(OVERFLOW,SOFLOW);        /* DETECT F.P. OVERFLOW  @ZA04832*/ 01694000
         BC    1,SOFLOW                                            0372 01695000
*SUB2:                                                             0373 01696000
*       QVAL(K)=V1;                 /* SAVE DIF IN TEMP AREA @ZA04832*/ 01697000
SUB2     L     @07,QBASE                                           0373 01698000
         LR    @05,K                                               0373 01699000
         SLA   @05,3                                               0373 01700000
         L     @15,V1                                              0373 01701000
         LA    @14,0(@05,@07)                                      0373 01702000
         AL    @14,@CF00382                                        0373 01703000
         ST    @15,QVAL(,@14)                                      0373 01704000
*       QTEMP(K)=YES;               /* TURN ON TEMP BIT              */ 01705000
         ALR   @07,@05                                             0374 01706000
         BCTR  @07,0                                               0374 01707000
         OI    QTEMP-7(@07),B'01000000'                            0374 01708000
*       RETURN;                     /*                       @ZA04832*/ 01709000
@EL00004 DS    0H                                                  0375 01710000
@EF00004 DS    0H                                                  0375 01711000
@ER00004 LM    @14,@05,@SA00004                                    0375 01712000
         LM    @07,@12,@SA00004+32                                 0375 01713000
         BR    @14                                                 0375 01714000
*     END;                          /*                               */ 01715000
*SOFLOW:                                                           0377 01716000
*   TOOBIG=YES;                     /* INDICATE OVERFLOW     @ZA04832*/ 01717000
@RC00366 DS    0H                                                  0377 01718000
SOFLOW   OI    TOOBIG,B'00000100'                                  0377 01719000
*   GOTO SUB2;                      /* CONTINUE EVALUATION   @ZA04832*/ 01720000
         B     SUB2                                                0378 01721000
*   END SUBRTN;                     /* END SUB PROC                  */ 01722000
*                                                                  0380 01723000
*   /*****************************************************************/ 01724000
*   /*                                                               */ 01725000
*   /* MULTIPLY ROUTINE                                              */ 01726000
*   /*                                                               */ 01727000
*   /*****************************************************************/ 01728000
*                                                                  0380 01729000
*MULRTN:                                                           0380 01730000
*   PROC;                                                          0380 01731000
MULRTN   STM   @14,@05,@SA00005                                    0380 01732000
         STM   @07,@12,@SA00005+32                                 0380 01733000
*   IF ALPHA=YES THEN               /* IF ALPHA DATA THEN            */ 01734000
         TM    ALPHA,B'10000000'                                   0381 01735000
         BNO   @RF00381                                            0381 01736000
*     ERROR=E860;                   /* SET ERROR CODE                */ 01737000
         LA    ERROR,860                                           0382 01738000
*   ELSE                            /* OTHERWISE PROCESS MORMALLY    */ 01739000
*     DO;                           /* TURN ON TEMP BIT              */ 01740000
         B     @RC00381                                            0383 01741000
@RF00381 DS    0H                                                  0384 01742000
*       QTEMP(K)=YES;               /*                               */ 01743000
         L     @07,QBASE                                           0384 01744000
         LR    @05,K                                               0384 01745000
         SLA   @05,3                                               0384 01746000
         ST    @05,@TF00001                                        0384 01747000
         ALR   @05,@07                                             0384 01748000
         BCTR  @05,0                                               0384 01749000
         OI    QTEMP-7(@05),B'01000000'                            0384 01750000
*       IF QLEN(K)=F1 THEN          /* IF MULTIPLY                   */ 01751000
         L     @05,@TF00001                                        0385 01752000
         AL    @07,@CF00381                                        0385 01753000
         LH    @07,QLEN-4(@05,@07)                                 0385 01754000
         C     @07,@CF00082                                        0385 01755000
         BNE   @RF00385                                            0385 01756000
*         DO;                       /*                               */ 01757000
*           RFY                                                    0387 01758000
*            (R0,                                                  0387 01759000
*             R1) RSTD;             /*                       @ZA04832*/ 01760000
*           GEN REFS(V1,V2,R0,R1,MVCK)/*                     @ZA04832*/ 01761000
*               SETS(V1,R0,R1,MVCK);                               0388 01762000
*                                      /*                   @ZA04832*/  01763000
        L     R1,V1                LOAD MULTIPLICAND        @ZA04832    01764000
        M     R0,V2                MULTIPLY BY MULTIPLIER   @ZA04832    01765000
        ST    R1,V1                STORE PRODUCT            @ZA04832    01766000
        ST    R0,MVCK              STORE HI-ORDER REG       @ZA04832    01767000
*           RFY                                                    0389 01768000
*            (R0,                                                  0389 01769000
*             R1) UNRSTD;           /*                       @ZA04832*/ 01770000
*           IF V1>=0 THEN           /* IF POSITIVE PRODUCT   @ZA04832*/ 01771000
         SLR   @07,@07                                             0390 01772000
         C     @07,V1                                              0390 01773000
         BH    @RF00390                                            0390 01774000
*             DO;                   /*                       @ZA04832*/ 01775000
*               IF MVCK^=0 THEN     /* VALIDITY CK POS #     @ZA04832*/ 01776000
         C     @07,MVCK                                            0392 01777000
         BE    @RF00392                                            0392 01778000
*                 TOOBIG=YES;       /* PRODUCT TOO LARGE     @ZA04832*/ 01779000
         OI    TOOBIG,B'00000100'                                  0393 01780000
*             END;                  /*                       @ZA04832*/ 01781000
*           ELSE                    /* FOR NEGATIVE PRODUCTS @ZA04832*/ 01782000
*             DO;                   /*                       @ZA04832*/ 01783000
         B     @RC00390                                            0395 01784000
@RF00390 DS    0H                                                  0396 01785000
*               IF MVCK^=ALLONES THEN/* VALIDITY CK NEG #    @ZA04832*/ 01786000
         CLC   MVCK(4),@CF00107                                    0396 01787000
         BE    @RF00396                                            0396 01788000
*                 TOOBIG=YES;       /* PRODUCT TOO LARGE     @ZA04832*/ 01789000
         OI    TOOBIG,B'00000100'                                  0397 01790000
*             END;                  /*                       @ZA04832*/ 01791000
*         END;                      /*                               */ 01792000
*       ELSE                        /* OTHERWISE DO EXPONENTIATION   */ 01793000
*         DO;                       /*                               */ 01794000
         B     @RC00385                                            0400 01795000
@RF00385 DS    0H                                                  0401 01796000
*           IF V2<=F0 THEN          /* IF POWER IS TOO SMALL, DEFAULT*/ 01797000
         L     @07,V2                                              0401 01798000
         LTR   @07,@07                                             0401 01799000
         BP    @RF00401                                            0401 01800000
*             V1=F1;                /* AS POWER OF ZERO (1)          */ 01801000
         MVC   V1(4),@CF00082                                      0402 01802000
*           ELSE                    /* OTHERWISE COMPUTE POWER       */ 01803000
*             DO;                   /*                               */ 01804000
         B     @RC00401                                            0403 01805000
@RF00401 DS    0H                                                  0404 01806000
*               N=V1;               /* MULTIPLY AS MANY TIMES AS     */ 01807000
         L     @07,V1                                              0404 01808000
         ST    @07,N                                               0404 01809000
*               DO I=1 TO V2-1;     /* NECESSARY (POWER TIMES)       */ 01810000
         LA    I,1                                                 0405 01811000
         B     @DE00405                                            0405 01812000
@DL00405 DS    0H                                                  0406 01813000
*                 RFY                                              0406 01814000
*                  (R0,                                            0406 01815000
*                   R1) RSTD;       /*                       @ZA04832*/ 01816000
*                 GEN REFS(V1,N,R0,R1,MVCK)/*                @ZA04832*/ 01817000
*                     SETS(V1,R0,R1,MVCK);                         0407 01818000
*                                           /*              @ZA04832*/  01819000
        L     R1,V1                LOAD MULTIPLICAND        @ZA04832    01820000
        M     R0,N                 MULTIPLY BY MULTIPLIER   @ZA04832    01821000
        ST    R1,V1                STORE PRODUCT            @ZA04832    01822000
        ST    R0,MVCK              STORE HI-ORDER REG       @ZA04832    01823000
*                 RFY                                              0408 01824000
*                  (R0,                                            0408 01825000
*                   R1) UNRSTD;     /*                       @ZA04832*/ 01826000
*                 IF V1>=0 THEN     /* IF POSITIVE PRODUCT   @ZA04832*/ 01827000
         SLR   @07,@07                                             0409 01828000
         C     @07,V1                                              0409 01829000
         BH    @RF00409                                            0409 01830000
*                   DO;             /*                       @ZA04832*/ 01831000
*                     IF MVCK^=0 THEN/* VALIDITY CK POS #    @ZA04832*/ 01832000
         C     @07,MVCK                                            0411 01833000
         BE    @RF00411                                            0411 01834000
*                       TOOBIG=YES; /* PRODUCT TOO LARGE     @ZA04832*/ 01835000
         OI    TOOBIG,B'00000100'                                  0412 01836000
*                   END;            /*                       @ZA04832*/ 01837000
*                 ELSE              /* FOR NEGATIVE PRODUCTS @ZA04832*/ 01838000
*                   DO;             /*                       @ZA04832*/ 01839000
         B     @RC00409                                            0414 01840000
@RF00409 DS    0H                                                  0415 01841000
*                     IF MVCK^=ALLONES|/* VALIDITY CK NEG #  @ZA04832*/ 01842000
*                         V1=MAXNEG THEN/* -2**31 TOO BIG    @ZA04832*/ 01843000
         CLC   MVCK(4),@CF00107                                    0415 01844000
         BNE   @RT00415                                            0415 01845000
         CLC   V1(4),@CF00105                                      0415 01846000
         BNE   @RF00415                                            0415 01847000
@RT00415 DS    0H                                                  0416 01848000
*                       TOOBIG=YES; /* PRODUCT TOO LARGE     @ZA04832*/ 01849000
         OI    TOOBIG,B'00000100'                                  0416 01850000
*                   END;            /*                       @ZA04832*/ 01851000
@RF00415 DS    0H                                                  0418 01852000
*               END;                /*                               */ 01853000
@RC00409 AL    I,@CF00082                                          0418 01854000
@DE00405 L     @07,V2                                              0418 01855000
         BCTR  @07,0                                               0418 01856000
         CR    I,@07                                               0418 01857000
         BNH   @DL00405                                            0418 01858000
*             END;                  /*                               */ 01859000
*         END;                      /*                               */ 01860000
@RC00401 DS    0H                                                  0421 01861000
*       QVAL(K)=V1;                 /* STORE RESULTS IN TEMP AREA    */ 01862000
@RC00385 LR    @07,K                                               0421 01863000
         SLA   @07,3                                               0421 01864000
         L     @05,V1                                              0421 01865000
         L     @01,QBASE                                           0421 01866000
         AL    @01,@CF00382                                        0421 01867000
         ST    @05,QVAL(@07,@01)                                   0421 01868000
*     END;                          /*                               */ 01869000
*   END MULRTN;                     /* END MULTIPLY PROC             */ 01870000
@EL00005 DS    0H                                                  0423 01871000
@EF00005 DS    0H                                                  0423 01872000
@ER00005 LM    @14,@05,@SA00005                                    0423 01873000
         LM    @07,@12,@SA00005+32                                 0423 01874000
         BR    @14                                                 0423 01875000
*                                                                  0424 01876000
*   /*****************************************************************/ 01877000
*   /*                                                               */ 01878000
*   /* DIVIDE ROUTINE - DIVIDES TWO NUMBERS                          */ 01879000
*   /*                                                               */ 01880000
*   /*****************************************************************/ 01881000
*                                                                  0424 01882000
*DIVRTN:                                                           0424 01883000
*   PROC;                                                          0424 01884000
DIVRTN   STM   @14,@05,12(@13)                                     0424 01885000
         STM   @07,@12,48(@13)                                     0424 01886000
*   IF ALPHA=YES|V2=F0 THEN         /* IF ALPHA DATA OR DIVIDE BY 0  */ 01887000
         TM    ALPHA,B'10000000'                                   0425 01888000
         BO    @RT00425                                            0425 01889000
         L     @07,V2                                              0425 01890000
         LTR   @07,@07                                             0425 01891000
         BNZ   @RF00425                                            0425 01892000
@RT00425 DS    0H                                                  0426 01893000
*     ERROR=E864;                   /* SET ERROR CODE                */ 01894000
         LA    ERROR,864                                           0426 01895000
*   ELSE                            /* OTHERWISE PROCESS             */ 01896000
*     DO;                           /*                               */ 01897000
         B     @RC00425                                            0427 01898000
@RF00425 DS    0H                                                  0428 01899000
*       IF QLEN(K)=F1 THEN          /* IF NORMAL DIVIDE              */ 01900000
         LR    @07,K                                               0428 01901000
         SLA   @07,3                                               0428 01902000
         L     @05,QBASE                                           0428 01903000
         AL    @05,@CF00381                                        0428 01904000
         LH    @07,QLEN-4(@07,@05)                                 0428 01905000
         C     @07,@CF00082                                        0428 01906000
         BNE   @RF00428                                            0428 01907000
*         V1=V1/V2;                 /* STORE QUOTIENT IN TEMPAREA    */ 01908000
         L     @00,V1                                              0429 01909000
         SRDA  @00,32                                              0429 01910000
         D     @00,V2                                              0429 01911000
         ST    @01,V1                                              0429 01912000
*       ELSE                        /* IF REMAINDER                  */ 01913000
*         V1=V1//V2;                /* STORE REMAINDER IN TEMPAREA   */ 01914000
         B     @RC00428                                            0430 01915000
@RF00428 L     @00,V1                                              0430 01916000
         SRDA  @00,32                                              0430 01917000
         D     @00,V2                                              0430 01918000
         ST    @00,V1                                              0430 01919000
*       QVAL(K)=V1;                 /* SAVE ANS IN TEMP AREA         */ 01920000
@RC00428 L     @07,QBASE                                           0431 01921000
         LR    @05,K                                               0431 01922000
         SLA   @05,3                                               0431 01923000
         L     @15,V1                                              0431 01924000
         LA    @14,0(@05,@07)                                      0431 01925000
         AL    @14,@CF00382                                        0431 01926000
         ST    @15,QVAL(,@14)                                      0431 01927000
*       QTEMP(K)=YES;               /* SET TEMP BIT                  */ 01928000
         ALR   @07,@05                                             0432 01929000
         BCTR  @07,0                                               0432 01930000
         OI    QTEMP-7(@07),B'01000000'                            0432 01931000
*     END;                          /*                               */ 01932000
*   END DIVRTN;                     /* END DIVIDE PROC               */ 01933000
@EL00006 DS    0H                                                  0434 01934000
@EF00006 DS    0H                                                  0434 01935000
@ER00006 LM    @14,@05,12(@13)                                     0434 01936000
         LM    @07,@12,48(@13)                                     0434 01937000
         BR    @14                                                 0434 01938000
*                                                                  0435 01939000
*   /*****************************************************************/ 01940000
*   /*                                                               */ 01941000
*   /* ASSIGN ROUTINE                                                */ 01942000
*   /*                                                               */ 01943000
*   /*****************************************************************/ 01944000
*                                                                  0435 01945000
*ASSIGN:                                                           0435 01946000
*   PROC;                                                          0435 01947000
ASSIGN   STM   @14,@01,@SA00007                                    0435 01948000
         STM   @03,@12,@SA00007+16                                 0435 01949000
*   IF TYPE=RELAT THEN              /* IF RELATIONAL ENTRY           */ 01950000
         L     @03,@PC00001+8                                      0436 01951000
         CLC   TYPE(4,@03),@CF00058                                0436 01952000
         BNE   @RF00436                                            0436 01953000
*     CALL ASSIGNR;                 /* CALL RELATIONAL ASSIGN        */ 01954000
         BAL   @14,ASSIGNR                                         0437 01955000
*   ELSE                            /* OTHERWISE GET READY TO STORE  */ 01956000
*     DO;                           /* ANSWER                        */ 01957000
         B     @RC00436                                            0438 01958000
@RF00436 DS    0H                                                  0439 01959000
*       IF ALPHA=YES THEN           /* IF ALPHA DATA                 */ 01960000
         TM    ALPHA,B'10000000'                                   0439 01961000
         BNO   @RF00439                                            0439 01962000
*         DO;                       /* SET RETURN POINTER TO DATA    */ 01963000
*           OUTPTR=QPTR(V2);        /* SET POINTER                   */ 01964000
         L     @15,QBASE                                           0441 01965000
         L     @14,V2                                              0441 01966000
         SLA   @14,3                                               0441 01967000
         LA    @01,0(@14,@15)                                      0441 01968000
         AL    @01,@CF00382                                        0441 01969000
         L     OUTPTR,QPTR(,@01)                                   0441 01970000
*           CLEN=QLEN(V2);          /* SET LENGTH OF DATA            */ 01971000
         L     @03,@PC00001+4                                      0442 01972000
         AL    @15,@CF00381                                        0442 01973000
         LH    @15,QLEN-4(@14,@15)                                 0442 01974000
         STH   @15,CLEN(,@03)                                      0442 01975000
*         END;                      /*                               */ 01976000
*       ELSE                        /* OTHERWISE UNPACK INTO USER    */ 01977000
*         DO;                       /* PROVIDED OUTAREA              */ 01978000
         B     @RC00439                                            0444 01979000
@RF00439 DS    0H                                                  0445 01980000
*           CVD(V2,WORKAREA);       /* CONVERT NUMBER TO DECIMAL     */ 01981000
         L     @03,V2                                              0445 01982000
         CVD   @03,WORKAREA                                        0445 01983000
*           UNPK(OUTAREA(2:17),WORKAREA);/* UNPACK DECIMAL INTO ZONED*/ 01984000
         L     @03,@PC00001+12                                     0446 01985000
         UNPK  OUTAREA+1(16,@03),WORKAREA(8)                       0446 01986000
*           OUTAREA(17)=OUTAREA(17)|'0';/* INSURE LAST ZONE          */ 01987000
         OI    OUTAREA+16(@03),C'0'                                0447 01988000
*           DO CLEN=16 TO 2 BY-1 WHILE OUTAREA(2)='0';/* STRIP LEAD  */ 01989000
         LA    @03,16                                              0448 01990000
         L     @15,@PC00001+4                                      0448 01991000
         STH   @03,CLEN(,@15)                                      0448 01992000
@DL00448 L     @03,@PC00001+12                                     0448 01993000
         CLI   OUTAREA+1(@03),C'0'                                 0448 01994000
         BNE   @DC00448                                            0448 01995000
*             OUTAREA(2:16)=OUTAREA(3:17);/* ZEROS AND LEFT JUSTIFY  */ 01996000
         MVC   @TS00001(15),OUTAREA+2(@03)                         0449 01997000
         MVC   OUTAREA+1(15,@03),@TS00001                          0449 01998000
*           END;                    /*                               */ 01999000
         L     @15,@PC00001+4                                      0450 02000000
         SLR   @03,@03                                             0450 02001000
         BCTR  @03,0                                               0450 02002000
         AH    @03,CLEN(,@15)                                      0450 02003000
         L     @15,@PC00001+4                                      0450 02004000
         STH   @03,CLEN(,@15)                                      0450 02005000
         C     @03,@CF00058                                        0450 02006000
         BNL   @DL00448                                            0450 02007000
@DC00448 DS    0H                                                  0451 02008000
*           IF V2<F0 THEN           /* IF NEGATIVE RESULT            */ 02009000
         L     @03,V2                                              0451 02010000
         LTR   @03,@03                                             0451 02011000
         BNM   @RF00451                                            0451 02012000
*             DO;                   /*                               */ 02013000
*               OUTAREA(1)='-';     /* MOVE IN MINUS SIGN            */ 02014000
         L     @03,@PC00001+12                                     0453 02015000
         MVI   OUTAREA(@03),C'-'                                   0453 02016000
*               CLEN=CLEN+F1;       /* ADD ONE TO LENGTH             */ 02017000
         L     @03,@PC00001+4                                      0454 02018000
         LA    @15,1                                               0454 02019000
         AH    @15,CLEN(,@03)                                      0454 02020000
         STH   @15,CLEN(,@03)                                      0454 02021000
*             END;                  /*                               */ 02022000
*           ELSE                    /* IF POSITIVE NUMBER            */ 02023000
*             OUTAREA(1:16)=OUTAREA(2:17);/* MOVE DOWN TO LEFT       */ 02024000
         B     @RC00451                                            0456 02025000
@RF00451 L     @03,@PC00001+12                                     0456 02026000
         MVC   @TS00001(16),OUTAREA+1(@03)                         0456 02027000
         MVC   OUTAREA(16,@03),@TS00001                            0456 02028000
*         END;                      /*                               */ 02029000
*     END;                          /*                               */ 02030000
*   END ASSIGN;                     /* END ASSIGN PROC               */ 02031000
@EL00007 DS    0H                                                  0459 02032000
@EF00007 DS    0H                                                  0459 02033000
@ER00007 LM    @14,@01,@SA00007                                    0459 02034000
         LM    @03,@12,@SA00007+16                                 0459 02035000
         BR    @14                                                 0459 02036000
*                                                                  0460 02037000
*   /*****************************************************************/ 02038000
*   /*                                                               */ 02039000
*   /* POPUP PROC - POPS AN OPERATOR OFF VERTICAL QUE                */ 02040000
*   /*                                                               */ 02041000
*   /*****************************************************************/ 02042000
*                                                                  0460 02043000
*POPUP:                                                            0460 02044000
*   PROC;                                                          0460 02045000
POPUP    STM   @14,@01,12(@13)                                     0460 02046000
         ST    @03,32(,@13)                                        0460 02047000
         STM   @05,@12,40(@13)                                     0460 02048000
*   OUTQUE(OUTQDX)=VQUE(VINDX);     /* COPY VERT QUE ELEMENT TO HORIZ*/ 02049000
         L     @05,QBASE                                           0461 02050000
         LR    @03,OUTQDX                                          0461 02051000
         SLA   @03,3                                               0461 02052000
         ALR   @03,@05                                             0461 02053000
         AL    @03,@CF00382                                        0461 02054000
         LR    @15,VINDX                                           0461 02055000
         SLA   @15,3                                               0461 02056000
         LA    @14,1                                               0461 02057000
         L     @09,@PC00001+4                                      0461 02058000
         LH    @09,CLEN(,@09)                                      0461 02059000
         ALR   @09,@14                                             0461 02060000
         SLA   @09,4                                               0461 02061000
         ALR   @05,@09                                             0461 02062000
         ALR   @05,@15                                             0461 02063000
         AL    @05,@CF00382                                        0461 02064000
         MVC   OUTQUE(8,@03),VQUE(@05)                             0461 02065000
*   VINDX=VINDX-F1;                 /* QUE AND DECREMENT VERT INDEX  */ 02066000
         BCTR  VINDX,0                                             0462 02067000
*   OUTQDX=OUTQDX+F1;               /* INCREMENT OUTQUE INDEX        */ 02068000
         ALR   OUTQDX,@14                                          0463 02069000
*   END POPUP;                      /* END POPUP PROC                */ 02070000
@EL00008 DS    0H                                                  0464 02071000
@EF00008 DS    0H                                                  0464 02072000
@ER00008 LM    @14,@01,12(@13)                                     0464 02073000
         L     @03,32(,@13)                                        0464 02074000
         LM    @05,@12,40(@13)                                     0464 02075000
         BR    @14                                                 0464 02076000
*                                                                  0465 02077000
*   /*****************************************************************/ 02078000
*   /*                                                               */ 02079000
*   /* LESS THAN ROUTINE                                             */ 02080000
*   /*                                                               */ 02081000
*   /*****************************************************************/ 02082000
*                                                                  0465 02083000
*LTRTN:                                                            0465 02084000
*   PROC;                                                          0465 02085000
LTRTN    STM   @14,@12,@SA00009                                    0465 02086000
*   IF ALPHA=YES THEN               /* IF ALPHA DATA,                */ 02087000
         TM    ALPHA,B'10000000'                                   0466 02088000
         BNO   @RF00466                                            0466 02089000
*     DO;                           /*                               */ 02090000
*       CALL COMPR;                 /* CALL COMPARE ROUTINE          */ 02091000
         BAL   @14,COMPR                                           0468 02092000
*       BC(11,FLSE);                /* BRANCH IF NOT LESS THAN       */ 02093000
         BC    11,FLSE                                             0469 02094000
*       ANS=TRUE;                   /* SET TRUE SWITCH               */ 02095000
         OI    ANS,B'00000100'                                     0470 02096000
*FLSE:                                                             0471 02097000
*       ;                           /* TARGET FOR BRANCH             */ 02098000
FLSE     DS    0H                                                  0472 02099000
*     END;                          /*                               */ 02100000
*   ELSE                            /*                               */ 02101000
*     IF V1<V2 THEN                 /* IF NUMERIC, PERFORM NUMERIC   */ 02102000
         B     @RC00466                                            0473 02103000
@RF00466 L     @15,V1                                              0473 02104000
         C     @15,V2                                              0473 02105000
         BNL   @RF00473                                            0473 02106000
*       ANS=TRUE;                   /* COMPARISON - SET TRUE IF SO   */ 02107000
         OI    ANS,B'00000100'                                     0474 02108000
*   END LTRTN;                      /* END LESS THAN ROUTINE         */ 02109000
@EL00009 DS    0H                                                  0475 02110000
@EF00009 DS    0H                                                  0475 02111000
@ER00009 LM    @14,@12,@SA00009                                    0475 02112000
         BR    @14                                                 0475 02113000
*                                                                  0476 02114000
*   /*****************************************************************/ 02115000
*   /*                                                               */ 02116000
*   /* GREATER THAN ROUTINE                                          */ 02117000
*   /*                                                               */ 02118000
*   /*****************************************************************/ 02119000
*                                                                  0476 02120000
*GTRTN:                                                            0476 02121000
*   PROC;                                                          0476 02122000
GTRTN    STM   @14,@12,@SA00010                                    0476 02123000
*   IF ALPHA=YES THEN               /* IF ALPHA DATA                 */ 02124000
         TM    ALPHA,B'10000000'                                   0477 02125000
         BNO   @RF00477                                            0477 02126000
*     DO;                           /*                               */ 02127000
*       CALL COMPR;                 /* CALL COMPARE ROUTINE          */ 02128000
         BAL   @14,COMPR                                           0479 02129000
*       BC(13,FLSE2);               /* BRANCH IF FALSE               */ 02130000
         BC    13,FLSE2                                            0480 02131000
*       ANS=TRUE;                   /* SET TRUE OF TRUE              */ 02132000
         OI    ANS,B'00000100'                                     0481 02133000
*FLSE2:                                                            0482 02134000
*       ;                           /* TARGET FOR BRANCH             */ 02135000
FLSE2    DS    0H                                                  0483 02136000
*     END;                          /*                               */ 02137000
*   ELSE                            /* IF NUMERIC PERFORM            */ 02138000
*     IF V1>V2 THEN                 /* NUMERIC COMPARE               */ 02139000
         B     @RC00477                                            0484 02140000
@RF00477 L     @15,V1                                              0484 02141000
         C     @15,V2                                              0484 02142000
         BNH   @RF00484                                            0484 02143000
*       ANS=TRUE;                   /* SET TO TRUE IF SO             */ 02144000
         OI    ANS,B'00000100'                                     0485 02145000
*   END GTRTN;                      /* END GREATER THAN              */ 02146000
@EL00010 DS    0H                                                  0486 02147000
@EF00010 DS    0H                                                  0486 02148000
@ER00010 LM    @14,@12,@SA00010                                    0486 02149000
         BR    @14                                                 0486 02150000
*                                                                  0487 02151000
*   /*****************************************************************/ 02152000
*   /*                                                               */ 02153000
*   /* LESS THAN OR EQUAL PROC                                       */ 02154000
*   /*                                                               */ 02155000
*   /*****************************************************************/ 02156000
*                                                                  0487 02157000
*LERTN:                                                            0487 02158000
*   PROC;                                                          0487 02159000
LERTN    STM   @14,@12,@SA00011                                    0487 02160000
*   CALL LTRTN;                     /* CALL LESSTHAN ROUTINE         */ 02161000
         BAL   @14,LTRTN                                           0488 02162000
*   IF ANS=FALSE THEN               /* IF NOT TRUE , TRY EQUAL       */ 02163000
         TM    ANS,B'00000100'                                     0489 02164000
         BNZ   @RF00489                                            0489 02165000
*     CALL ASSIGNR;                 /* ROUTINE                       */ 02166000
         BAL   @14,ASSIGNR                                         0490 02167000
*   END LERTN;                      /* END LESS THAN PROC            */ 02168000
@EL00011 DS    0H                                                  0491 02169000
@EF00011 DS    0H                                                  0491 02170000
@ER00011 LM    @14,@12,@SA00011                                    0491 02171000
         BR    @14                                                 0491 02172000
*                                                                  0492 02173000
*   /*****************************************************************/ 02174000
*   /*                                                               */ 02175000
*   /* GREATER THAN OR EQUAL ROUTINE                                 */ 02176000
*   /*                                                               */ 02177000
*   /*****************************************************************/ 02178000
*                                                                  0492 02179000
*GERTN:                                                            0492 02180000
*   PROC;                                                          0492 02181000
GERTN    STM   @14,@12,@SA00012                                    0492 02182000
*   CALL GTRTN;                     /* CALL GREATER THAN ROUTINE     */ 02183000
         BAL   @14,GTRTN                                           0493 02184000
*   IF ANS=FALSE THEN               /* IF ANS NOT TRUE, THEN TRY     */ 02185000
         TM    ANS,B'00000100'                                     0494 02186000
         BNZ   @RF00494                                            0494 02187000
*     CALL ASSIGNR;                 /* EQUAL ROUTINE                 */ 02188000
         BAL   @14,ASSIGNR                                         0495 02189000
*   END GERTN;                      /* END GREATER THAN OR EQUAL     */ 02190000
@EL00012 DS    0H                                                  0496 02191000
@EF00012 DS    0H                                                  0496 02192000
@ER00012 LM    @14,@12,@SA00012                                    0496 02193000
         BR    @14                                                 0496 02194000
*                                                                  0497 02195000
*   /*****************************************************************/ 02196000
*   /*                                                               */ 02197000
*   /* EQUAL ROUTINE                                                 */ 02198000
*   /*                                                               */ 02199000
*   /*****************************************************************/ 02200000
*                                                                  0497 02201000
*ASSIGNR:                                                          0497 02202000
*   PROC;                                                          0497 02203000
ASSIGNR  STM   @14,@12,@SA00013                                    0497 02204000
*   IF ALPHA=YES THEN               /* IF ALPHA DATA                 */ 02205000
         TM    ALPHA,B'10000000'                                   0498 02206000
         BNO   @RF00498                                            0498 02207000
*     DO;                           /*                               */ 02208000
*       CALL COMPR;                 /* CALL COMPARE ROUTINE          */ 02209000
         BAL   @14,COMPR                                           0500 02210000
*       BC(7,FLSE3);                /* BRANCH IF FALSE               */ 02211000
         BC    7,FLSE3                                             0501 02212000
*       ANS=TRUE;                   /* SET TRUE IF SO                */ 02213000
         OI    ANS,B'00000100'                                     0502 02214000
*FLSE3:                                                            0503 02215000
*       ;                           /* TARGET FOR BRANCH             */ 02216000
FLSE3    DS    0H                                                  0504 02217000
*     END;                          /*                               */ 02218000
*   ELSE                            /* IF NUMERIC DATA PERFORM       */ 02219000
*     IF V1=V2 THEN                 /* NUMERIC COMPARE               */ 02220000
         B     @RC00498                                            0505 02221000
@RF00498 CLC   V1(4),V2                                            0505 02222000
         BNE   @RF00505                                            0505 02223000
*       ANS=TRUE;                   /* SET TRUE IF SO                */ 02224000
         OI    ANS,B'00000100'                                     0506 02225000
*   END ASSIGNR;                    /* END EQUAL PROC                */ 02226000
@EL00013 DS    0H                                                  0507 02227000
@EF00013 DS    0H                                                  0507 02228000
@ER00013 LM    @14,@12,@SA00013                                    0507 02229000
         BR    @14                                                 0507 02230000
*                                                                  0508 02231000
*   /*****************************************************************/ 02232000
*   /*                                                               */ 02233000
*   /* AND RELATIONAL ROUTINE                                        */ 02234000
*   /*                                                               */ 02235000
*   /*****************************************************************/ 02236000
*                                                                  0508 02237000
*ANDRTN:                                                           0508 02238000
*   PROC;                                                          0508 02239000
ANDRTN   STM   @14,@12,12(@13)                                     0508 02240000
*   IF V1=F0&V2=F0 THEN             /* IF BOTHE TRUE THEN            */ 02241000
         SLR   @15,@15                                             0509 02242000
         C     @15,V1                                              0509 02243000
         BNE   @RF00509                                            0509 02244000
         C     @15,V2                                              0509 02245000
         BNE   @RF00509                                            0509 02246000
*     ANS=TRUE;                     /* SET TRUE ANS                  */ 02247000
         OI    ANS,B'00000100'                                     0510 02248000
*   END ANDRTN;                                                    0511 02249000
@EL00014 DS    0H                                                  0511 02250000
@EF00014 DS    0H                                                  0511 02251000
@ER00014 LM    @14,@12,12(@13)                                     0511 02252000
         BR    @14                                                 0511 02253000
*                                                                  0512 02254000
*   /*****************************************************************/ 02255000
*   /*                                                               */ 02256000
*   /* OR RELATIONAL ROUTINE                                         */ 02257000
*   /*                                                               */ 02258000
*   /*****************************************************************/ 02259000
*                                                                  0512 02260000
*ORRTN:                                                            0512 02261000
*   PROC;                                                          0512 02262000
ORRTN    STM   @14,@12,12(@13)                                     0512 02263000
*   IF V1=F0|V2=F0 THEN             /* IF EITHER TRUE                */ 02264000
         SLR   @15,@15                                             0513 02265000
         C     @15,V1                                              0513 02266000
         BE    @RT00513                                            0513 02267000
         C     @15,V2                                              0513 02268000
         BNE   @RF00513                                            0513 02269000
@RT00513 DS    0H                                                  0514 02270000
*     ANS=TRUE;                     /* SET TRUE ANS                  */ 02271000
         OI    ANS,B'00000100'                                     0514 02272000
*   END ORRTN;                      /* END                           */ 02273000
@EL00015 DS    0H                                                  0515 02274000
@EF00015 DS    0H                                                  0515 02275000
@ER00015 LM    @14,@12,12(@13)                                     0515 02276000
         BR    @14                                                 0515 02277000
*                                                                  0516 02278000
*   /*****************************************************************/ 02279000
*   /*                                                               */ 02280000
*   /* COMPARE FUNCTION FOR ALPHA DATA                               */ 02281000
*   /*                                                               */ 02282000
*   /*****************************************************************/ 02283000
*                                                                  0516 02284000
*COMPR:                                                            0516 02285000
*   PROC;                                                          0516 02286000
COMPR    STM   @14,@12,12(@13)                                     0516 02287000
*   RFY                                                            0517 02288000
*    (R2,                                                          0517 02289000
*     R3,                                                          0517 02290000
*     R4,                                                          0517 02291000
*     R5) RSTD;                     /* RESTRICT REGISTERS            */ 02292000
*   R2=QPTR(V1);                    /* ADDR OF 'A'                   */ 02293000
         L     @15,QBASE                                           0518 02294000
         L     @14,V1                                              0518 02295000
         SLA   @14,3                                               0518 02296000
         LA    @01,0(@14,@15)                                      0518 02297000
         AL    @01,@CF00382                                        0518 02298000
         L     R2,QPTR(,@01)                                       0518 02299000
*   R4=QPTR(V2);                    /* ADDR OF 'B'                   */ 02300000
         L     @09,V2                                              0519 02301000
         SLA   @09,3                                               0519 02302000
         LA    @01,0(@09,@15)                                      0519 02303000
         AL    @01,@CF00382                                        0519 02304000
         L     R4,QPTR(,@01)                                       0519 02305000
*   R3=QLEN(V1);                    /* LENGTH OF 'A'                 */ 02306000
         AL    @14,@CF00381                                        0520 02307000
         LH    R3,QLEN-4(@14,@15)                                  0520 02308000
*   R5=QLEN(V2)|BLANKS;             /* LENGTH OF 'B' AND PAD CHAR    */ 02309000
         AL    @15,@CF00381                                        0521 02310000
         LH    R5,QLEN-4(@09,@15)                                  0521 02311000
         O     R5,@CF00103                                         0521 02312000
*   CLCL(R2,R4);                    /* ISSUE COMPARE LONG            */ 02313000
         CLCL  R2,R4                                               0522 02314000
*   RFY                                                            0523 02315000
*    (R2,                                                          0523 02316000
*     R3,                                                          0523 02317000
*     R4,                                                          0523 02318000
*     R5) UNRSTD;                   /* RELEASE REGISTERS             */ 02319000
*   END COMPR;                      /* END COMPARE PROC              */ 02320000
@EL00016 DS    0H                                                  0524 02321000
@EF00016 DS    0H                                                  0524 02322000
@ER00016 LM    @14,@12,12(@13)                                     0524 02323000
         BR    @14                                                 0524 02324000
*                                                                  0525 02325000
*   /*****************************************************************/ 02326000
*   /*                                                               */ 02327000
*   /* SEPARATOR SEPARATOR ROUTINE                                   */ 02328000
*   /*                                                               */ 02329000
*   /*****************************************************************/ 02330000
*                                                                  0525 02331000
*SKIPRTN:                                                          0525 02332000
*   PROC;                                                          0525 02333000
SKIPRTN  STM   @14,@12,12(@13)                                     0525 02334000
*   SEPS=YES;                       /* SKIP ALL DELIMETERS           */ 02335000
         OI    SEPS,B'00100000'                                    0526 02336000
*   DO WHILE SEPS=YES&N<=CLEN;      /*                               */ 02337000
         B     @DE00527                                            0527 02338000
@DL00527 DS    0H                                                  0528 02339000
*     IF C(N)^=' '&C(N)^=','&C(N)^='05'X THEN/* IF NOT A DELIMETER   */ 02340000
         L     @15,N                                               0528 02341000
         L     @14,@PC00001                                        0528 02342000
         ALR   @15,@14                                             0528 02343000
         BCTR  @15,0                                               0528 02344000
         CLI   C(@15),C' '                                         0528 02345000
         BE    @RF00528                                            0528 02346000
         L     @15,N                                               0528 02347000
         ALR   @15,@14                                             0528 02348000
         BCTR  @15,0                                               0528 02349000
         CLI   C(@15),C','                                         0528 02350000
         BE    @RF00528                                            0528 02351000
         L     @15,N                                               0528 02352000
         ALR   @15,@14                                             0528 02353000
         BCTR  @15,0                                               0528 02354000
         CLI   C(@15),X'05'                                        0528 02355000
         BE    @RF00528                                            0528 02356000
*       IF N<CLEN&C(N:N+F1)='/*' THEN/* IF AN OPEN COMMENT           */ 02357000
         L     @15,N                                               0529 02358000
         L     @09,@PC00001+4                                      0529 02359000
         CH    @15,CLEN(,@09)                                      0529 02360000
         BNL   @RF00529                                            0529 02361000
         ALR   @14,@15                                             0529 02362000
         BCTR  @14,0                                               0529 02363000
         CLC   C(2,@14),@CC00354                                   0529 02364000
         BNE   @RF00529                                            0529 02365000
*         DO;                       /*                               */ 02366000
*           DO N=N+4 TO CLEN WHILE C(N-2:N-1)^='*/';/* SKIP COMMENT  */ 02367000
         AL    @15,@CF00085                                        0531 02368000
         B     @DE00531                                            0531 02369000
@DL00531 L     @14,@PC00001                                        0531 02370000
         ALR   @14,@15                                             0531 02371000
         AL    @14,@CF00398                                        0531 02372000
         CLC   C(2,@14),@CC00355                                   0531 02373000
         BE    @DC00531                                            0531 02374000
*           END;                                                   0532 02375000
         AL    @15,@CF00082                                        0532 02376000
@DE00531 ST    @15,N                                               0532 02377000
         L     @14,@PC00001+4                                      0532 02378000
         CH    @15,CLEN(,@14)                                      0532 02379000
         BNH   @DL00531                                            0532 02380000
@DC00531 DS    0H                                                  0533 02381000
*         END;                                                     0533 02382000
*       ELSE                        /* IF NOT A DELIMETER, END SKIP  */ 02383000
*         SEPS=NO;                  /*                               */ 02384000
         B     @RC00529                                            0534 02385000
@RF00529 NI    SEPS,B'11011111'                                    0534 02386000
*     ELSE                          /* IF A SEPARATOR, INCREMENT     */ 02387000
*       N=N+F1;                     /* INDEX                         */ 02388000
         B     @RC00528                                            0535 02389000
@RF00528 LA    @15,1                                               0535 02390000
         AL    @15,N                                               0535 02391000
         ST    @15,N                                               0535 02392000
*   END;                                                           0536 02393000
@RC00528 DS    0H                                                  0536 02394000
@DE00527 TM    SEPS,B'00100000'                                    0536 02395000
         BNO   @DC00527                                            0536 02396000
         L     @15,@PC00001+4                                      0536 02397000
         L     @14,N                                               0536 02398000
         CH    @14,CLEN(,@15)                                      0536 02399000
         BNH   @DL00527                                            0536 02400000
@DC00527 DS    0H                                                  0537 02401000
*   END SKIPRTN;                                                   0537 02402000
@EL00017 DS    0H                                                  0537 02403000
@EF00017 DS    0H                                                  0537 02404000
@ER00017 LM    @14,@12,12(@13)                                     0537 02405000
         BR    @14                                                 0537 02406000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 02407000
*     GPR15F FIXED(31) REG(15),                                    0538 02408000
*     GPR01P PTR(31) REG(1);                                       0538 02409000
*   DCL                                                            0539 02410000
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */ 02411000
*      2 I00401 PTR(31),            /* LENGTH                        */ 02412000
*      2 I00402 CHAR(1),            /* HIARCHY                       */ 02413000
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */ 02414000
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */ 02415000
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */ 02416000
*   DCL                                                            0540 02417000
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */ 02418000
*       3 I00501 PTR(8),            /* RESERVED                      */ 02419000
*       3 I00502 PTR(24),           /* LENGTH                        */ 02420000
*       3 I00503 PTR(8),            /* RESERVED                      */ 02421000
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */ 02422000
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */ 02423000
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */ 02424000
*   DECLARE                                                        0541 02425000
*     ILIST CHAR(10) BDY(DWORD);    /* STANDARD LIST                 */ 02426000
*   DECLARE                         /* COMMON VARIABLES              */ 02427000
*     I256C CHAR(256) BASED,                                       0542 02428000
*     I031F FIXED(31) BASED,                                       0542 02429000
*     I031P PTR(31) BASED,                                         0542 02430000
*     I015F FIXED(15) BASED,                                       0542 02431000
*     I015P PTR(15) BASED,                                         0542 02432000
*     I008P PTR(8) BASED,                                          0542 02433000
*     I001C CHAR(1) BASED;                                         0542 02434000
*   END IKJCT434;                                                  0543 02435000
@DATA    DS    0H                                                       02436000
@SC00376 CLC   0(0,@01),C(@15)                                          02437000
@SM00396 MVC   OUTAREA(0,@14),QCHAR(@03)                                02438000
@DATD    DSECT                                                          02439000
         DS    0F                                                       02440000
@SA00001 DS    18F                                                      02441000
@PC00001 DS    4F                                                       02442000
@SA00003 DS    14F                                                      02443000
@SA00004 DS    14F                                                      02444000
@SA00005 DS    14F                                                      02445000
@SA00007 DS    14F                                                      02446000
@SA00012 DS    15F                                                      02447000
@SA00011 DS    15F                                                      02448000
@SA00009 DS    15F                                                      02449000
@SA00010 DS    15F                                                      02450000
@SA00013 DS    15F                                                      02451000
@TF00001 DS    F                                                        02452000
IKJCT434 CSECT                                                          02453000
         DS    0F                                                       02454000
@CF00082 DC    F'1'                                                     02455000
@CF00058 DC    F'2'                                                     02456000
@CF00234 DC    F'3'                                                     02457000
@CF00085 DC    F'4'                                                     02458000
@CF00091 DC    F'7'                                                     02459000
@CF00067 DC    F'8'                                                     02460000
@CF00388 DC    F'-16'                                                   02461000
@CF00389 DC    F'-12'                                                   02462000
@CF00384 DC    F'-9'                                                    02463000
@CF00382 DC    F'-8'                                                    02464000
@CF00381 DC    F'-4'                                                    02465000
@CF00398 DC    F'-3'                                                    02466000
@CF00103 DC    XL4'40000000'                                            02467000
@CF00105 DC    XL4'80000000'                                            02468000
@CF00107 DC    XL4'FFFFFFFF'                                            02469000
@DATD    DSECT                                                          02470000
         DS    0D                                                       02471000
QBASE    DS    A                                                        02472000
N        DS    F                                                        02473000
MVCK     DS    F                                                        02474000
@TS00001 DS    CL16                                                     02475000
         DS    CL4                                                      02476000
WORKAREA DS    CL8                                                      02477000
SEARCH   DS    BL1                                                      02478000
SWS      DS    CL2                                                      02479000
         ORG   SWS                                                      02480000
ALPHA    DS    BL1                                                      02481000
EXITA    EQU   SWS+0                                                    02482000
SEPS     EQU   SWS+0                                                    02483000
EXITB    EQU   SWS+0                                                    02484000
PUSH     EQU   SWS+0                                                    02485000
ANS      EQU   SWS+0                                                    02486000
MATCH    EQU   SWS+0                                                    02487000
CONCAT   EQU   SWS+0                                                    02488000
OPFND    DS    BL1                                                      02489000
NULLELEM EQU   SWS+1                                                    02490000
NULLREQ  EQU   SWS+1                                                    02491000
PCONCAT  EQU   SWS+1                                                    02492000
PENDPREF EQU   SWS+1                                                    02493000
TOOBIG   EQU   SWS+1                                                    02494000
         ORG   SWS+2                                                    02495000
         DS    CL5                                                      02496000
ILIST    DS    CL10                                                     02497000
         DS    CL2                                                      02498000
V        DS    2F                                                       02499000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02500000
@ENDDATD EQU   *                                                        02501000
IKJCT434 CSECT                                                          02502000
         DS    0F                                                       02503000
@SIZDATD DC    AL1(1)                                                   02504000
         DC    AL3(@ENDDATD-@DATD)                                      02505000
@CA00071 DC    A(TRTABUP)                                               02506000
         DS    0D                                                       02507000
@CC00114 DC    C'00000000000000000'                                     02508000
@CC00118 DC    C'2147483647'                                            02509000
@CC00354 DC    C'/*'                                                    02510000
@CC00355 DC    C'*/'                                                    02511000
         DS    CL1                                                      02512000
@NM00004 DS    CL16                                                     02513000
         ORG   @NM00004+0                                               02514000
OPS      DC    CL7'+'                                                   02515000
OPFLG    DC    X'80'                                                    02516000
OPSTR    DC    H'3'                                                     02517000
OPLEN    DC    H'1'                                                     02518000
VECTOR   DC    AL4(ADDRTN)                                              02519000
         ORG   @NM00004+16                                              02520000
         ORG   @NM00004+16                                              02521000
         DC    CL7'-'                                                   02522000
         DC    X'80'                                                    02523000
         DC    H'3'                                                     02524000
         DC    H'1'                                                     02525000
         DC    AL4(SUBRTN)                                              02526000
         ORG   @NM00004+32                                              02527000
         ORG   @NM00004+32                                              02528000
         DC    CL7'**'                                                  02529000
         DC    X'80'                                                    02530000
         DC    H'5'                                                     02531000
         DC    H'2'                                                     02532000
         DC    AL4(MULRTN)                                              02533000
         ORG   @NM00004+48                                              02534000
         ORG   @NM00004+48                                              02535000
         DC    CL7'//'                                                  02536000
         DC    X'80'                                                    02537000
         DC    H'5'                                                     02538000
         DC    H'2'                                                     02539000
         DC    AL4(DIVRTN)                                              02540000
         ORG   @NM00004+64                                              02541000
         ORG   @NM00004+64                                              02542000
         DC    CL7'*'                                                   02543000
         DC    X'80'                                                    02544000
         DC    H'4'                                                     02545000
         DC    H'1'                                                     02546000
         DC    AL4(MULRTN)                                              02547000
         ORG   @NM00004+80                                              02548000
         ORG   @NM00004+80                                              02549000
         DC    CL7'/'                                                   02550000
         DC    X'80'                                                    02551000
         DC    H'4'                                                     02552000
         DC    H'1'                                                     02553000
         DC    AL4(DIVRTN)                                              02554000
         ORG   @NM00004+96                                              02555000
         ORG   @NM00004+96                                              02556000
         DC    CL7')'                                                   02557000
         DC    X'80'                                                    02558000
         DC    H'2'                                                     02559000
         DC    H'1'                                                     02560000
         DC    A(0)                                                     02561000
         ORG   @NM00004+112                                             02562000
         ORG   @NM00004+112                                             02563000
         DC    CL7'('                                                   02564000
         DC    X'80'                                                    02565000
         DC    H'2'                                                     02566000
         DC    H'1'                                                     02567000
         DC    A(0)                                                     02568000
         ORG   @NM00004+128                                             02569000
         ORG   @NM00004+128                                             02570000
         DC    CL7'='                                                   02571000
         DC    X'88'                                                    02572000
         DC    H'2'                                                     02573000
         DC    H'1'                                                     02574000
         DC    AL4(ASSIGN)                                              02575000
         ORG   @NM00004+144                                             02576000
         ORG   @NM00004+144                                             02577000
         DC    CL7'EQ'                                                  02578000
         DC    X'88'                                                    02579000
         DC    H'2'                                                     02580000
         DC    H'3'                                                     02581000
         DC    AL4(ASSIGN)                                              02582000
         ORG   @NM00004+160                                             02583000
         ORG   @NM00004+160                                             02584000
         DC    CL7'>='                                                  02585000
         DC    X'88'                                                    02586000
         DC    H'2'                                                     02587000
         DC    H'2'                                                     02588000
         DC    AL4(GERTN)                                               02589000
         ORG   @NM00004+176                                             02590000
         ORG   @NM00004+176                                             02591000
         DC    CL7'<='                                                  02592000
         DC    X'88'                                                    02593000
         DC    H'2'                                                     02594000
         DC    H'2'                                                     02595000
         DC    AL4(LERTN)                                               02596000
         ORG   @NM00004+192                                             02597000
         ORG   @NM00004+192                                             02598000
         DC    CL7'LT'                                                  02599000
         DC    X'88'                                                    02600000
         DC    H'2'                                                     02601000
         DC    H'3'                                                     02602000
         DC    AL4(LTRTN)                                               02603000
         ORG   @NM00004+208                                             02604000
         ORG   @NM00004+208                                             02605000
         DC    CL7'GT'                                                  02606000
         DC    X'88'                                                    02607000
         DC    H'2'                                                     02608000
         DC    H'3'                                                     02609000
         DC    AL4(GTRTN)                                               02610000
         ORG   @NM00004+224                                             02611000
         ORG   @NM00004+224                                             02612000
         DC    CL7'LE'                                                  02613000
         DC    X'88'                                                    02614000
         DC    H'2'                                                     02615000
         DC    H'3'                                                     02616000
         DC    AL4(LERTN)                                               02617000
         ORG   @NM00004+240                                             02618000
         ORG   @NM00004+240                                             02619000
         DC    CL7'GE'                                                  02620000
         DC    X'88'                                                    02621000
         DC    H'2'                                                     02622000
         DC    H'3'                                                     02623000
         DC    AL4(GERTN)                                               02624000
         ORG   @NM00004+256                                             02625000
         ORG   @NM00004+256                                             02626000
         DC    CL7'<'                                                   02627000
         DC    X'88'                                                    02628000
         DC    H'2'                                                     02629000
         DC    H'1'                                                     02630000
         DC    AL4(LTRTN)                                               02631000
         ORG   @NM00004+272                                             02632000
         ORG   @NM00004+272                                             02633000
         DC    CL7'>'                                                   02634000
         DC    X'88'                                                    02635000
         DC    H'2'                                                     02636000
         DC    H'1'                                                     02637000
         DC    AL4(GTRTN)                                               02638000
         ORG   @NM00004+288                                             02639000
         ORG   @NM00004+288                                             02640000
         DC    CL7'NE'                                                  02641000
         DC    X'8C'                                                    02642000
         DC    H'2'                                                     02643000
         DC    H'3'                                                     02644000
         DC    AL4(ASSIGNR)                                             02645000
         ORG   @NM00004+304                                             02646000
         ORG   @NM00004+304                                             02647000
         DC    CL7'NL'                                                  02648000
         DC    X'8C'                                                    02649000
         DC    H'2'                                                     02650000
         DC    H'3'                                                     02651000
         DC    AL4(LTRTN)                                               02652000
         ORG   @NM00004+320                                             02653000
         ORG   @NM00004+320                                             02654000
         DC    CL7'NG'                                                  02655000
         DC    X'8C'                                                    02656000
         DC    H'2'                                                     02657000
         DC    H'3'                                                     02658000
         DC    AL4(GTRTN)                                               02659000
         ORG   @NM00004+336                                             02660000
         ORG   @NM00004+336                                             02661000
         DC    CL7'^='                                                  02662000
         DC    X'8C'                                                    02663000
         DC    H'2'                                                     02664000
         DC    H'2'                                                     02665000
         DC    AL4(ASSIGNR)                                             02666000
         ORG   @NM00004+352                                             02667000
         ORG   @NM00004+352                                             02668000
         DC    CL7'^<'                                                  02669000
         DC    X'8C'                                                    02670000
         DC    H'2'                                                     02671000
         DC    H'2'                                                     02672000
         DC    AL4(LTRTN)                                               02673000
         ORG   @NM00004+368                                             02674000
         ORG   @NM00004+368                                             02675000
         DC    CL7'^>'                                                  02676000
         DC    X'8C'                                                    02677000
         DC    H'2'                                                     02678000
         DC    H'2'                                                     02679000
         DC    AL4(GTRTN)                                               02680000
         ORG   @NM00004+384                                             02681000
         ORG   @NM00004+384                                             02682000
         DC    CL7'AND'                                                 02683000
         DC    X'81'                                                    02684000
         DC    H'1'                                                     02685000
         DC    H'4'                                                     02686000
         DC    AL4(ANDRTN)                                              02687000
         ORG   @NM00004+400                                             02688000
         ORG   @NM00004+400                                             02689000
         DC    CL7'OR'                                                  02690000
         DC    X'81'                                                    02691000
         DC    H'0'                                                     02692000
         DC    H'3'                                                     02693000
         DC    AL4(ORRTN)                                               02694000
         ORG   @NM00004+416                                             02695000
         ORG   @NM00004+416                                             02696000
         DC    CL7'&&'                                                  02697000
         DC    X'81'                                                    02698000
         DC    H'1'                                                     02699000
         DC    H'1'                                                     02700000
         DC    AL4(ANDRTN)                                              02701000
         ORG   @NM00004+432                                             02702000
         ORG   @NM00004+432                                             02703000
         DC    CL7'|'                                                   02704000
         DC    X'81'                                                    02705000
         DC    H'0'                                                     02706000
         DC    H'1'                                                     02707000
         DC    AL4(ORRTN)                                               02708000
         ORG   @NM00004+448                                             02709000
ENDDLM   DC    CL1'+'                                                   02710000
         DC    CL1'-'                                                   02711000
         DC    CL1'/'                                                   02712000
         DC    CL1'*'                                                   02713000
         DC    CL1','                                                   02714000
         DC    CL1' '                                                   02715000
         DC    CL1')'                                                   02716000
         DC    CL1'('                                                   02717000
         DC    CL1'='                                                   02718000
         DC    X'05'                                                    02719000
         DC    CL1'^'                                                   02720000
         DC    CL1'&&'                                                  02721000
         DC    CL1'|'                                                   02722000
         DC    CL1'<'                                                   02723000
         DC    CL1'>'                                                   02724000
         DC    13CL1' '                                                 02725000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02726000
@01      EQU   01                                                       02727000
@02      EQU   02                                                       02728000
@03      EQU   03                                                       02729000
@04      EQU   04                                                       02730000
@05      EQU   05                                                       02731000
@06      EQU   06                                                       02732000
@07      EQU   07                                                       02733000
@08      EQU   08                                                       02734000
@09      EQU   09                                                       02735000
@10      EQU   10                                                       02736000
@11      EQU   11                                                       02737000
@12      EQU   12                                                       02738000
@13      EQU   13                                                       02739000
@14      EQU   14                                                       02740000
@15      EQU   15                                                       02741000
OUTQDX   EQU   @04                                                      02742000
VINDX    EQU   @02                                                      02743000
MAXX     EQU   @03                                                      02744000
K        EQU   @04                                                      02745000
PCTR     EQU   @02                                                      02746000
ERROR    EQU   @06                                                      02747000
X        EQU   @07                                                      02748000
HOWMUCH  EQU   @09                                                      02749000
NSAVE    EQU   @08                                                      02750000
I        EQU   @05                                                      02751000
OUTPTR   EQU   @02                                                      02752000
R12      EQU   @12                                                      02753000
R11      EQU   @11                                                      02754000
R0       EQU   @00                                                      02755000
R1       EQU   @01                                                      02756000
R2       EQU   @02                                                      02757000
R3       EQU   @03                                                      02758000
R4       EQU   @04                                                      02759000
R5       EQU   @05                                                      02760000
GPR01P   EQU   @01                                                      02761000
GPR15F   EQU   @15                                                      02762000
         EXTRN TRTABUP                                                  02763000
QCHAR    EQU   0                                                        02764000
QUE      EQU   0                                                        02765000
QPTR     EQU   QUE                                                      02766000
QVAL     EQU   QPTR                                                     02767000
QLEN     EQU   QUE+4                                                    02768000
QSTREN   EQU   QUE+6                                                    02769000
QFLGS    EQU   QUE+7                                                    02770000
QOPER    EQU   QFLGS                                                    02771000
QTEMP    EQU   QFLGS                                                    02772000
QSKIP    EQU   QFLGS                                                    02773000
QPREFX   EQU   QFLGS                                                    02774000
QEXCLU   EQU   QFLGS                                                    02775000
QNOT     EQU   QFLGS                                                    02776000
QEND     EQU   QFLGS                                                    02777000
QCOMB    EQU   QFLGS                                                    02778000
ROUTINE  EQU   0                                                        02779000
VQUE     EQU   0                                                        02780000
VVAL     EQU   VQUE                                                     02781000
VSTREN   EQU   VQUE+6                                                   02782000
I001C    EQU   0                                                        02783000
I008P    EQU   0                                                        02784000
I015F    EQU   0                                                        02785000
I015P    EQU   0                                                        02786000
I031F    EQU   0                                                        02787000
I031P    EQU   0                                                        02788000
I256C    EQU   0                                                        02789000
C        EQU   0                                                        02790000
CLEN     EQU   0                                                        02791000
TYPE     EQU   0                                                        02792000
OUTAREA  EQU   0                                                        02793000
OUTQUE   EQU   QUE                                                      02794000
@NM00003 EQU   V                                                        02795000
V1       EQU   @NM00003                                                 02796000
V2       EQU   @NM00003+4                                               02797000
I004     EQU   ILIST                                                    02798000
I00401   EQU   I004                                                     02799000
I00403   EQU   I004+5                                                   02800000
I00404   EQU   I004+8                                                   02801000
I00405   EQU   I004+9                                                   02802000
I005     EQU   ILIST                                                    02803000
I00502   EQU   I005+1                                                   02804000
I00504   EQU   I005+5                                                   02805000
I00505   EQU   I005+8                                                   02806000
I00506   EQU   I005+9                                                   02807000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02808000
I00503   EQU   I005+4                                                   02809000
I00501   EQU   I005                                                     02810000
I00402   EQU   I004+4                                                   02811000
@NM00002 EQU   VQUE+7                                                   02812000
@NM00001 EQU   VQUE+4                                                   02813000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02814000
@RT00031 EQU   NOFREEXT                                                 02815000
@RC00060 EQU   @RC00059                                                 02816000
@RC00072 EQU   @RC00070                                                 02817000
@RC00127 EQU   @RC00122                                                 02818000
@RF00126 EQU   @RC00122                                                 02819000
@RC00124 EQU   @RC00122                                                 02820000
@RC00135 EQU   @RC00134                                                 02821000
@RT00211 EQU   EXIT                                                     02822000
@RF00324 EQU   @RC00319                                                 02823000
@RC00322 EQU   @RC00319                                                 02824000
@RC00335 EQU   @RC00334                                                 02825000
@RC00390 EQU   @RC00385                                                 02826000
@RF00396 EQU   @RC00385                                                 02827000
@RF00411 EQU   @RC00409                                                 02828000
@RC00381 EQU   @EL00005                                                 02829000
@RC00425 EQU   @EL00006                                                 02830000
@RC00436 EQU   @EL00007                                                 02831000
@RC00439 EQU   @EL00007                                                 02832000
@RC00451 EQU   @EL00007                                                 02833000
@RF00473 EQU   @EL00009                                                 02834000
@RC00466 EQU   @EL00009                                                 02835000
@RF00484 EQU   @EL00010                                                 02836000
@RC00477 EQU   @EL00010                                                 02837000
@RF00489 EQU   @EL00011                                                 02838000
@RF00494 EQU   @EL00012                                                 02839000
@RF00505 EQU   @EL00013                                                 02840000
@RC00498 EQU   @EL00013                                                 02841000
@RF00509 EQU   @EL00014                                                 02842000
@RF00513 EQU   @EL00015                                                 02843000
@RC00529 EQU   @RC00528                                                 02844000
@RF00392 EQU   @RC00390                                                 02845000
@ENDDATA EQU   *                                                        02846000
         END   IKJCT434,(C'PLS1932',0701,75349)                         02847000
