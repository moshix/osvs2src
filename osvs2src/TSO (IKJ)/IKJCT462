         TITLE 'IKJCT462   OUTPUT COMMAND JOB PROCESSOR                *00001000
                        '                                               00002000
IKJCT462 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJCT462  74.364'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@11                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         USING @DATD,@10                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @10,8(,@13)                                         0001 00021000
         LR    @13,@10                                             0001 00022000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00023000
         MVC   @PC00001(4),0(@01)                                  0001 00024000
*                                                                  0089 00025000
*/********************************************************************/ 00026000
*/*                                                                  */ 00027000
*/*  THE BASIC FLOW OF IKJCT462, THE JOB PROCESSOR, CAN BE OBTAINED  */ 00028000
*/*  FROM THE FOLLOWING SECTION OF CODE:                             */ 00029000
*/*                                                                  */ 00030000
*/*          1. INITIALIZE OUTCOMTB'S BASE                           */ 00031000
*/*          2. IF IKJCT469 HAS NO MORE JOBS TO PROCESS, INVOKE      */ 00032000
*/*             SUBSYSTEM FOR FINAL CALL TO INDICATE PROCESSING      */ 00033000
*/*             COMPLETE, THEN RETURN IKJCT469                       */ 00034000
*/*          3. SET UP SSOB & SSSO CONTROL BLOCKS                    */ 00035000
*/*          4. INVOKE THE SUBSYSTEM TO LOCATE, ROUTE, OR DELETE     */ 00036000
*/*             A SYSOUT DATA SET                                    */ 00037000
*/*          5. IF PRINT REQUESTED, ALLOCATE THE SYSOUT DATA SET,    */ 00038000
*/*             READ SYSOUT & WRITE TO DATA SET, UNALLOCATE THE      */ 00039000
*/*             SYSOUT DATA SET                                      */ 00040000
*/*          6. RETURN TO CALLER                                     */ 00041000
*/*                                                                  */ 00042000
*/********************************************************************/ 00043000
*                                                                  0089 00044000
*   OCMTBPTR=OPTR;                  /* INIT BASE OF OUTCOMTB (USE A     00045000
*                                      REGISTER FOR EFFICIENCY) WITH    00046000
*                                      PTR PASSED AS A PARM          */ 00047000
*                                                                  0089 00048000
         L     @14,@PC00001                                        0089 00049000
         L     OCMTBPTR,OPTR(,@14)                                 0089 00050000
*   /*****************************************************************/ 00051000
*   /*                                                               */ 00052000
*   /* IF NO MORE WORK TO DO FOR THE PREVIOUS JOB- ISSUE FINAL CALL  */ 00053000
*   /* TO SUBSYSTEM FOR THIS JOB                                     */ 00054000
*   /*                                                               */ 00055000
*   /*****************************************************************/ 00056000
*                                                                  0090 00057000
*   IF NOWORK=ON THEN               /* NO MORE WORK TO DO            */ 00058000
         TM    NOWORK(OCMTBPTR),B'00000010'                        0090 00059000
         BNO   @RF00090                                            0090 00060000
*     CALL FINISH;                  /* INVOKE SUBSYS - FINAL CALL    */ 00061000
*                                                                  0091 00062000
         BAL   @14,FINISH                                          0091 00063000
*   /*****************************************************************/ 00064000
*   /*                                                               */ 00065000
*   /* ELSE WORK TO DO - PROCESS THE JOB                             */ 00066000
*   /*                                                               */ 00067000
*   /*****************************************************************/ 00068000
*                                                                  0092 00069000
*   ELSE                            /* JOB TO PROCESS - GET BUSY     */ 00070000
*     DO;                                                          0092 00071000
         B     @RC00090                                            0092 00072000
@RF00090 DS    0H                                                  0093 00073000
*       SKIPDS=OFF;                 /* INIT SWITCH TO ZERO           */ 00074000
         NI    SKIPDS,B'01111111'                                  0093 00075000
*       SKIPGET=OFF;                /* INIT SWITCH TO ZERO           */ 00076000
         NI    SKIPGET,B'01111111'                                 0094 00077000
*       SUBSYS=OFF;                 /* INIT SWITCH TO ZERO           */ 00078000
*                                                                  0095 00079000
         NI    SUBSYS(OCMTBPTR),B'01111111'                        0095 00080000
*       /*************************************************************/ 00081000
*       /*                                                           */ 00082000
*       /* INITIALIZE THE SUBSYSTEM CONTROL BLOCKS                   */ 00083000
*       /*                                                           */ 00084000
*       /*************************************************************/ 00085000
*                                                                  0096 00086000
*       CALL INITSSSO;              /* CALL RTN TO SET UP SSOB & SSSO   00087000
*                                      CTL BLKS                      */ 00088000
         BAL   @14,INITSSSO                                        0096 00089000
*       FIRSTIME=ON;                /* SET SWITCH FOR FIRST CALL TO     00090000
*                                      SUBSYS FOR A JOB/CLASS      0097 00091000
*                                      COMBINATION-USED TO DECIDE  0097 00092000
*                                      WHAT SSOBRETN=4 MEANS (NO DS     00093000
*                                      OR NO MORE DS)                */ 00094000
         OI    FIRSTIME,B'10000000'                                0097 00095000
*       LOOP=YES;                   /* INIT LOOP CONTROL-ALWAYS GO 0098 00096000
*                                      THRU CODE AT LEAST ONCE. FOR     00097000
*                                      DELETING OR ROUTINE, DON'T  0098 00098000
*                                      LOOP TO SUBSYS AS FOR       0098 00099000
*                                      PRINTING.                     */ 00100000
*                                                                  0098 00101000
         OI    LOOP,B'10000000'                                    0098 00102000
*       /*************************************************************/ 00103000
*       /*                                                           */ 00104000
*       /* PROCESS THE JOB IKJCT469 PASSED: 1) IF GROUP REQUEST, NEED*/ 00105000
*       /* ONLY CALL SUBSYSTEM ONCE. 2) IF PRINT REQUEST, CALL THE   */ 00106000
*       /* SUBSYSTEM TO GET A DATA SET. PROCESS IT, THEN LOOP BACK TO*/ 00107000
*       /* THE SUBSYSTEM AND GET ANOTHER SYSOUT DATASET. CONTINUE    */ 00108000
*       /* LOOPING UNTIL NO MORE DATASETS.                           */ 00109000
*       /*                                                           */ 00110000
*       /*************************************************************/ 00111000
*                                                                  0099 00112000
*       DO WHILE ERROR=NO&ENDSW=NO&SSOBRETN=ZERO&LOOP=YES;/* THIS  0099 00113000
*                                      LOOP WILL ACCESS SYSOUT DATA     00114000
*                                      SETS FOR A JOB/CLASS UNTIL: AN   00115000
*                                      ERROR OCCURS, END IS        0099 00116000
*                                      REQUESTED, OR NO MORE DATA  0099 00117000
*                                      SETS CAN BE FOUND. FOR GROUP     00118000
*                                      REQUESTS THE LOOP IS EXECUTED    00119000
*                                      ONCE.                         */ 00120000
         B     @DE00099                                            0099 00121000
@DL00099 DS    0H                                                  0100 00122000
*         CALL SUBSYSTM;            /* CALL RTN TO SET-UP & INVOKE 0100 00123000
*                                      SUBSYS & CHECK RETURN CODE    */ 00124000
         BAL   @14,SUBSYSTM                                        0100 00125000
*         FIRSTIME=OFF;             /* NO LONGER 1ST CALL TO SUBSYS  */ 00126000
         NI    FIRSTIME,B'01111111'                                0101 00127000
*         IF ERROR=NO&PRINT=YES&SSOBRETN=ZERO THEN/* NO ERROR & A  0102 00128000
*                                      SYSOUT DATASET WAS FOUND      */ 00129000
         TM    ERROR(OCMTBPTR),B'00001000'                         0102 00130000
         BNZ   @RF00102                                            0102 00131000
         TM    PRINT(OCMTBPTR),B'00000010'                         0102 00132000
         BNO   @RF00102                                            0102 00133000
         L     @14,OUTSOBH(,OCMTBPTR)                              0102 00134000
         L     @14,SSOBRETN(,@14)                                  0102 00135000
         LTR   @14,@14                                             0102 00136000
         BNZ   @RF00102                                            0102 00137000
*           CALL ALLOCSO;           /* CALL RTN TO ALLOCATE THE    0103 00138000
*                                      SYSOUT DS                     */ 00139000
         BAL   @14,ALLOCSO                                         0103 00140000
*         IF ERROR=NO&PRINT=YES&SSOBRETN=ZERO THEN/* SYSOUT WAS ALLOC   00141000
*                                      & PRINT REQUESTED             */ 00142000
@RF00102 TM    ERROR(OCMTBPTR),B'00001000'                         0104 00143000
         BNZ   @RF00104                                            0104 00144000
         TM    PRINT(OCMTBPTR),B'00000010'                         0104 00145000
         BNO   @RF00104                                            0104 00146000
         L     @14,OUTSOBH(,OCMTBPTR)                              0104 00147000
         L     @14,SSOBRETN(,@14)                                  0104 00148000
         LTR   @14,@14                                             0104 00149000
         BNZ   @RF00104                                            0104 00150000
*           CALL PRINTRTN;          /* CALL RTN TO READ SYSOUT &   0105 00151000
*                                      WRITE RCDS TO PRINT DS        */ 00152000
         BAL   @14,PRINTRTN                                        0105 00153000
*         IF ALLOC=YES THEN         /* SYSOUT WAS ALLOCATED          */ 00154000
@RF00104 TM    ALLOC(OCMTBPTR),B'00000100'                         0106 00155000
         BNO   @RF00106                                            0106 00156000
*           CALL UNALCSO;           /* CALL RTN TO DETERMINE THE   0107 00157000
*                                      UNALLOCATION DISPOSITION &  0107 00158000
*                                      UNALLOC IT APPROPRIATELY      */ 00159000
         BAL   @14,UNALCSO                                         0107 00160000
*       END;                        /* END OF DO WHILE LOOP TO     0108 00161000
*                                      RETRIEVE SYSOUT DATA SETS     */ 00162000
*                                                                  0108 00163000
@RF00106 DS    0H                                                  0108 00164000
@DE00099 TM    ERROR(OCMTBPTR),B'00011000'                         0108 00165000
         BNZ   @DC00099                                            0108 00166000
         L     @14,OUTSOBH(,OCMTBPTR)                              0108 00167000
         L     @14,SSOBRETN(,@14)                                  0108 00168000
         LTR   @14,@14                                             0108 00169000
         BNZ   @DC00099                                            0108 00170000
         TM    LOOP,B'10000000'                                    0108 00171000
         BO    @DL00099                                            0108 00172000
@DC00099 DS    0H                                                  0109 00173000
*       /*************************************************************/ 00174000
*       /*                                                           */ 00175000
*       /* IF EARLY TERMINATION DUE TO END SUBCMD OR ERROR, WHILE    */ 00176000
*       /* PROCESSING A PRINT REQUEST ISSUE FINAL CALL TO SUBSYSTEM. */ 00177000
*       /*                                                           */ 00178000
*       /*************************************************************/ 00179000
*                                                                  0109 00180000
*       IF SUBSYS=YES&(ENDSW=YES|ERROR=YES) THEN/* EARLY TERMINATION    00181000
*                                      PROCESSING A SET OF DATASETS.    00182000
*                                      EITHER END SUBCMD OR ERROR.   */ 00183000
         TM    SUBSYS(OCMTBPTR),B'10000000'                        0109 00184000
         BNO   @RF00109                                            0109 00185000
         TM    ENDSW(OCMTBPTR),B'00011000'                         0109 00186000
         BZ    @RF00109                                            0109 00187000
*         CALL FINISH;              /* RETURN TO SUBSYS WHEN DONE  0110 00188000
*                                      WITH DATA SETS IN THIS      0110 00189000
*                                      JOB/CLASS COMBINATION         */ 00190000
         BAL   @14,FINISH                                          0110 00191000
*     END;                          /* END OF CODE TO PROCESS JOB    */ 00192000
@RF00109 DS    0H                                                  0112 00193000
*   RETURN CODE(RETNCODE);          /* RETURN TO IKJCT469            */ 00194000
@RC00090 L     @05,RETNCODE                                        0112 00195000
         L     @13,4(,@13)                                         0112 00196000
         L     @00,@SIZDATD                                        0112 00197000
         LR    @01,@10                                             0112 00198000
         FREEMAIN R,LV=(0),A=(1)                                        00199000
         LR    @15,@05                                             0112 00200000
         L     @14,12(,@13)                                        0112 00201000
         LM    @00,@12,20(@13)                                     0112 00202000
         BR    @14                                                 0112 00203000
*                                                                  0113 00204000
*/********************************************************************/ 00205000
*/*                                                                  */ 00206000
*/*      INITIALIZE THE NECESSARY SSOB FIELDS                        */ 00207000
*/*      SET UP THE SSSO FLAGS & FIELDS BASED ON THE FUNCTION        */ 00208000
*/*         REQUESTED (PRINT, DELETE, ETC.).                         */ 00209000
*/*                                                                  */ 00210000
*/********************************************************************/ 00211000
*                                                                  0113 00212000
*INITSSSO:                                                         0113 00213000
*   PROC;                           /* INTERNAL PROCEDURE TO       0113 00214000
*                                      INITIALIZE SSOB & SSSO        */ 00215000
@EL00001 L     @13,4(,@13)                                         0113 00216000
@EF00001 L     @00,@SIZDATD                                        0113 00217000
         LR    @01,@10                                             0113 00218000
         FREEMAIN R,LV=(0),A=(1)                                        00219000
@ER00001 LM    @14,@12,12(@13)                                     0113 00220000
         BR    @14                                                 0113 00221000
INITSSSO STM   @14,@12,12(@13)                                     0113 00222000
*   SSOBFUNC=SSOBSOUT;              /* SSOB HEADER REQUESTS LOCATE 0114 00223000
*                                      FUNCTION FROM SUBSYSTEM       */ 00224000
         L     @14,OUTSOBH(,OCMTBPTR)                              0114 00225000
         MVC   SSOBFUNC(2,@14),@CH00033                            0114 00226000
*   SSOBINDV=ADDR(SSSO);            /* SSOB HEADER POINTS TO THE   0115 00227000
*                                      LOCATE FUNCTION CNTRL BLK     */ 00228000
         L     @05,OUTSOBSO(,OCMTBPTR)                             0115 00229000
         ST    @05,SSOBINDV(,@14)                                  0115 00230000
*   SSOBRETN=SSOBRETN&&SSOBRETN;    /* INIT TO ZERO                  */ 00231000
         L     @02,SSOBRETN(,@14)                                  0116 00232000
         LR    @09,@02                                             0116 00233000
         XR    @09,@02                                             0116 00234000
         ST    @09,SSOBRETN(,@14)                                  0116 00235000
*   SSSO=SSSO&&SSSO;                /* INIT TO ZERO                  */ 00236000
         XC    SSSO(120,@05),SSSO(@05)                             0117 00237000
*   SSSOLEN=LENGTH(SSSO);           /* LENGTH OF SSSO SECTION        */ 00238000
*                                                                  0118 00239000
         MVC   SSSOLEN(2,@05),@CH01559                             0118 00240000
*   /*****************************************************************/ 00241000
*   /*                                                               */ 00242000
*   /* SET SELECTION CRITERIA BITS AND FIELDS IN SSSO                */ 00243000
*   /*                                                               */ 00244000
*   /*****************************************************************/ 00245000
*                                                                  0119 00246000
*   SSSOSHLD=ON;                    /* INCLUDE HELD SYSOUT DS        */ 00247000
*   SSSOSJBN=ON;                    /* USE JOBNAME                   */ 00248000
         OI    SSSOSHLD(@05),B'10010000'                           0120 00249000
*   SSSOJOBN=JOBNAME(1:JOBNLEN);    /* PASS JOBNAME TO SUBSYSTEM.  0121 00250000
*                                      JOBNAME FOUND IN PDE.         */ 00251000
         MVI   SSSOJOBN+1(@05),C' '                                0121 00252000
         MVC   SSSOJOBN+2(6,@05),SSSOJOBN+1(@05)                   0121 00253000
         L     @14,OUTJBPDE(,OCMTBPTR)                             0121 00254000
         LH    @02,JOBNLEN(,@14)                                   0121 00255000
         BCTR  @02,0                                               0121 00256000
         L     @09,JOBNMPTR(,@14)                                  0121 00257000
         EX    @02,@SM01575                                        0121 00258000
*   IF JOBIDLEN^=ZERO THEN          /* USER GAVE A JOBID             */ 00259000
         LH    @02,JOBIDLEN(,@14)                                  0122 00260000
         LTR   @02,@02                                             0122 00261000
         BZ    @RF00122                                            0122 00262000
*     DO;                                                          0123 00263000
*       SSSOSJBI=ON;                /* USE JOBID                     */ 00264000
         OI    SSSOSJBI(@05),B'00001000'                           0124 00265000
*       SSSOJOBI=JOBID(1:JOBIDLEN); /* PASS JOBID TO SUBSYSTEM. JOBID   00266000
*                                      IN PDE.                       */ 00267000
         MVI   SSSOJOBI+1(@05),C' '                                0125 00268000
         MVC   SSSOJOBI+2(6,@05),SSSOJOBI+1(@05)                   0125 00269000
         BCTR  @02,0                                               0125 00270000
         L     @14,JOBIDPTR(,@14)                                  0125 00271000
         EX    @02,@SM01578                                        0125 00272000
*     END;                                                         0126 00273000
*   ELSE                                                           0127 00274000
*     ;                             /* NO JOBID GIVEN                */ 00275000
@RF00122 DS    0H                                                  0128 00276000
*   IF CLASBUFF^=BLANKS THEN        /* USER ENTERED A CLASSNAME      */ 00277000
         CLC   CLASBUFF(8,OCMTBPTR),@CC01391                       0128 00278000
         BE    @RF00128                                            0128 00279000
*     DO;                                                          0129 00280000
*       SSSOSCLS=ON;                /* USE CLASS                     */ 00281000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0130 00282000
         OI    SSSOSCLS(@14),B'01000000'                           0130 00283000
*       SSSOCLSL=CLASBUFF;          /* CLASS(ES) TO CHOOSE           */ 00284000
         MVC   SSSOCLSL(8,@14),CLASBUFF(OCMTBPTR)                  0131 00285000
*     END;                                                         0132 00286000
*   ELSE                                                           0133 00287000
*     ;                             /* USE SUBSYS CLASS DEFAULT WHICH   00288000
*                                      IS ALL HELD CLASSES           */ 00289000
*                                                                  0133 00290000
@RF00128 DS    0H                                                  0134 00291000
*   /*****************************************************************/ 00292000
*   /*                                                               */ 00293000
*   /* SET OTHER BITS AND FIELDS UNIQUE TO SPECIFIC FUNCTIONS        */ 00294000
*   /*                                                               */ 00295000
*   /*****************************************************************/ 00296000
*                                                                  0134 00297000
*   IF PRINT=YES THEN               /* PRINT REQUESTED               */ 00298000
         TM    PRINT(OCMTBPTR),B'00000010'                         0134 00299000
         BNO   @RF00134                                            0134 00300000
*     SSSOCTRL=OFF;                 /* SUBSYSTEM TO RETURN A DATA SET   00301000
*                                      NAME                          */ 00302000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0135 00303000
         NI    SSSOCTRL(@14),B'01111111'                           0135 00304000
*   ELSE                                                           0136 00305000
*     IF DELETE=YES THEN            /* DELETE REQUESTED              */ 00306000
         B     @RC00134                                            0136 00307000
@RF00134 TM    DELETE(OCMTBPTR),B'00000100'                        0136 00308000
         BNO   @RF00136                                            0136 00309000
*       DO;                                                        0137 00310000
*         SSSODELC=ON;              /* SUBSYSTEM TO DELETE DS        */ 00311000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0138 00312000
         OI    SSSODELC(@14),B'01000000'                           0138 00313000
*         SSSOCTRL=ON;              /* A 'DELETE' GROUP REQUEST IS 0139 00314000
*                                      REALLY A FINAL REQUEST        */ 00315000
         OI    SSSOCTRL(@14),B'10000000'                           0139 00316000
*       END;                                                       0140 00317000
*     ELSE                          /* A ROUTING REQUEST             */ 00318000
*       DO;                                                        0141 00319000
         B     @RC00136                                            0141 00320000
@RF00136 DS    0H                                                  0142 00321000
*         SSSOCTRL=ON;              /* A 'ROUTING' GROUP REQUEST IS     00322000
*                                      REALLY A FINAL REQUEST        */ 00323000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0142 00324000
         OI    SSSOCTRL(@14),B'10000000'                           0142 00325000
*         IF NEWCLASS=YES THEN      /* NEWCLASS KEYWORD SPECIFIED    */ 00326000
         TM    NEWCLASS(OCMTBPTR),B'00000001'                      0143 00327000
         BNO   @RF00143                                            0143 00328000
*           DO;                                                    0144 00329000
*             SSSOSETC=ON;          /* SUBSYSTEM TO CHANGE CLASS     */ 00330000
         OI    SSSOSETC(@14),B'10000000'                           0145 00331000
*             SSSOCLAS=NEWCLAS;     /* NEWCLASS CLASS                */ 00332000
         L     @05,ONEWCPDE(,OCMTBPTR)                             0146 00333000
         L     @05,NEWCLPTR(,@05)                                  0146 00334000
         MVC   SSSOCLAS(1,@14),NEWCLAS(@05)                        0146 00335000
*           END;                                                   0147 00336000
*         IF DEST=YES THEN          /* DEST KEYWORD SPECIFIED        */ 00337000
@RF00143 TM    DEST(OCMTBPTR),B'01000000'                          0148 00338000
         BNO   @RF00148                                            0148 00339000
*           DO;                                                    0149 00340000
*             SSSOROUT=ON;          /* SUBSYSTEM TO ROUTE TO DEST    */ 00341000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0150 00342000
         OI    SSSOROUT(@14),B'00100000'                           0150 00343000
*             SSSODEST=' ';         /* BLANK DESTID FIELD            */ 00344000
         MVI   SSSODEST+1(@14),C' '                                0151 00345000
         MVC   SSSODEST+2(6,@14),SSSODEST+1(@14)                   0151 00346000
         MVI   SSSODEST(@14),C' '                                  0151 00347000
*             SSSODEST(1:DESTLEN)=DESTID(1:DESTLEN);/* REMOTE USERID */ 00348000
         L     @05,ODESTPDE(,OCMTBPTR)                             0152 00349000
         LH    @02,DESTLEN(,@05)                                   0152 00350000
         BCTR  @02,0                                               0152 00351000
         L     @05,DESTPTR(,@05)                                   0152 00352000
         EX    @02,@SM01582                                        0152 00353000
*           END;                                                   0153 00354000
*         IF HOLD=YES THEN          /* HOLD KEYWORD SPECIFIED        */ 00355000
@RF00148 TM    HOLD(OCMTBPTR),B'01000000'                          0154 00356000
         BNO   @RF00154                                            0154 00357000
*           SSSOHOLD=ON;            /* SUBSYSTEM SHOULD HOLD DS      */ 00358000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0155 00359000
         OI    SSSOHOLD(@14),B'00010000'                           0155 00360000
*         ELSE                      /* NOHOLD SPECIFIED OR DEFAULTED */ 00361000
*           SSSORLSE=ON;            /* SUBSYS SHOULD RELEASE DS      */ 00362000
         B     @RC00154                                            0156 00363000
@RF00154 L     @14,OUTSOBSO(,OCMTBPTR)                             0156 00364000
         OI    SSSORLSE(@14),B'00001000'                           0156 00365000
*       END;                                                       0157 00366000
*   END INITSSSO;                                                  0158 00367000
@EL00002 DS    0H                                                  0158 00368000
@EF00002 DS    0H                                                  0158 00369000
@ER00002 LM    @14,@12,12(@13)                                     0158 00370000
         BR    @14                                                 0158 00371000
*                                                                  0159 00372000
*/********************************************************************/ 00373000
*/*                                                                  */ 00374000
*/*    INVOKE THE SUBSYSTEM TO:                                      */ 00375000
*/*      LOCATE SYSOUT DATA SETS FOR THE JOB/CLASS COMBINATION       */ 00376000
*/*        PASSED BY IKJCT469.                                       */ 00377000
*/*      DELETE SYSOUT DATA SETS IN THE JOB/CLASSLIST PASSED.        */ 00378000
*/*      ROUTE SYSOUT DATA SETS IN THE JOB/CLASSLIST PASSED.         */ 00379000
*/*      ANALYZE THE RETURN CODE FROM THE SUBSYSTEM AND TAKE         */ 00380000
*/*        APPROPRIATE ACTION.                                       */ 00381000
*/*                                                                  */ 00382000
*/********************************************************************/ 00383000
*                                                                  0159 00384000
*SUBSYSTM:                                                         0159 00385000
*   PROC;                           /* INTERNAL PROCEDURE TO INVOKE     00386000
*                                      THE SUBSYSTEM                 */ 00387000
SUBSYSTM STM   @14,@12,@SA00003                                    0159 00388000
*/********************************************************************/ 00389000
*/*   INVOKE SUBSYSTEM TO PERFORM THE REQUESTED FUNCTION             */ 00390000
*/********************************************************************/ 00391000
*                                                                  0160 00392000
*   REG1=ADDR(OUTSOBH);             /* PASS SSOB PTR TO SUBSYSTEM    */ 00393000
         LA    REG1,OUTSOBH(,OCMTBPTR)                             0160 00394000
*   HASPABND=ON;                    /* IN CASE SUBSYS ABENDS, TELL 0161 00395000
*                                      ESTAE EXIT                    */ 00396000
         OI    HASPABND(OCMTBPTR),B'00000001'                      0161 00397000
*/*  ? IEFSSREQ;                                                     */ 00398000
*/*                                                                  */ 00399000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */ 00400000
*/*  PROCESS REQUEST -                                               */ 00401000
*/*                                                                  */ 00402000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */ 00403000
*/*            WORD PARAMETER LIST WHICH                             */ 00404000
*/*            POINTS TO THE SSOB                                    */ 00405000
*/*                                                                  */ 00406000
*                                                                  0162 00407000
*   CALL SSREQ;                     /* INVOKE SUBSYSTEM              */ 00408000
         L     @05,CVTPTR                                          0162 00409000
         L     @05,CVTJESCT(,@05)                                  0162 00410000
         L     @15,JESSSREQ(,@05)                                  0162 00411000
         BALR  @14,@15                                             0162 00412000
*   HASPABND=OFF;                   /* NO LONGER IN SUBSYS           */ 00413000
         NI    HASPABND(OCMTBPTR),B'11111110'                      0163 00414000
*   OUTRTCD=REG15;                  /* SAVE SUBSYSTEM RETURN CODE    */ 00415000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0164 00416000
*   SSSOCHKP=OFF;                   /* TURN OFF IN CASE SET BY     0165 00417000
*                                      PREVIOUS CALL                 */ 00418000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0165 00419000
         NI    SSSOCHKP(@14),B'10111111'                           0165 00420000
*                                                                  0166 00421000
*/********************************************************************/ 00422000
*/*  ANALYZE THE SUBSYSTEM RETURN CODE                               */ 00423000
*/********************************************************************/ 00424000
*                                                                  0166 00425000
*   IF OUTRTCD=SSRTOK THEN          /* SUBSYSTEM COMPLETED OK        */ 00426000
*                                                                  0166 00427000
         SLR   @14,@14                                             0166 00428000
         LH    @05,OUTRTCD(,OCMTBPTR)                              0166 00429000
         CR    @05,@14                                             0166 00430000
         BNE   @RF00166                                            0166 00431000
*     /***************************************************************/ 00432000
*     /*                                                             */ 00433000
*     /* SUBSYSTEM RETURN CODE IS ZERO                               */ 00434000
*     /*                                                             */ 00435000
*     /***************************************************************/ 00436000
*                                                                  0167 00437000
*     DO;                           /* CHECK SSOBRETN FIELD          */ 00438000
*       IF SSOBRETN=SSSORTOK THEN   /* SSOBRETN=0 - COMPLETED OK     */ 00439000
*                                                                  0168 00440000
         L     @05,OUTSOBH(,OCMTBPTR)                              0168 00441000
         C     @14,SSOBRETN(,@05)                                  0168 00442000
         BNE   @RF00168                                            0168 00443000
*         /***********************************************************/ 00444000
*         /*                                                         */ 00445000
*         /* SSOBRETN IS ZERO (SYSOUT DSN WAS RETURNED)              */ 00446000
*         /*                                                         */ 00447000
*         /***********************************************************/ 00448000
*                                                                  0169 00449000
*         DO;                                                      0169 00450000
*           RETNCODE=ZERO;          /* TELL 69 TO PASS NEXT JB/CL    */ 00451000
         ST    @14,RETNCODE                                        0170 00452000
*           WORKDONE=YES;           /* WORK DONE FOR THIS JOB.     0171 00453000
*                                      IKJCT469 INITS THIS BIT FOR 0171 00454000
*                                      1ST CALL TO '62 FOR EACH    0171 00455000
*                                      JOBNAME.                      */ 00456000
         OI    WORKDONE(OCMTBPTR),B'00010000'                      0171 00457000
*           IF PRINT=YES THEN       /* IF PRINT FUNCTION,            */ 00458000
         TM    PRINT(OCMTBPTR),B'00000010'                         0172 00459000
         BNO   @RF00172                                            0172 00460000
*             SUBSYS=ON;            /* INDICATE SUBSYS PROCESSING A     00461000
*                                      SET OF DATA SETS              */ 00462000
         OI    SUBSYS(OCMTBPTR),B'10000000'                        0173 00463000
*           ELSE                    /* ELSE DELETE OR ROUTE FUNC     */ 00464000
*             LOOP=NO;              /* FOR ROUTING, DONT LOOP TO   0174 00465000
*                                      SUBSYS, GO BACK TO IKJCT469 IN   00466000
*                                      CASE MORE CLASSES FOR THIS  0174 00467000
*                                      JOB, OR ANOTHER JOB TO PROCESS*/ 00468000
         B     @RC00172                                            0174 00469000
@RF00172 NI    LOOP,B'01111111'                                    0174 00470000
*         END;                                                     0175 00471000
*       ELSE                        /* SSOBRETN NON ZERO             */ 00472000
*                                                                  0176 00473000
*         /***********************************************************/ 00474000
*         /*                                                         */ 00475000
*         /* SSOBRETN IS NON ZERO - FIND OUT WHAT IT IS              */ 00476000
*         /*                                                         */ 00477000
*         /***********************************************************/ 00478000
*                                                                  0176 00479000
*         IF SSOBRETN=SSSOEODS THEN /* SSOBRETN=4 - NO DATASETS OR NO   00480000
*                                      MORE DATASETS                 */ 00481000
*                                                                  0176 00482000
         B     @RC00168                                            0176 00483000
@RF00168 L     @14,OUTSOBH(,OCMTBPTR)                              0176 00484000
         CLC   SSOBRETN(4,@14),@CF00053                            0176 00485000
         BNE   @RF00176                                            0176 00486000
*           /*********************************************************/ 00487000
*           /*                                                       */ 00488000
*           /* SSOBRETN=4 (NO DATASETS OR NO MORE DATASETS)          */ 00489000
*           /*                                                       */ 00490000
*           /*********************************************************/ 00491000
*                                                                  0177 00492000
*           DO;                                                    0177 00493000
*             IF PRINT=YES THEN     /* PRINT REQUESTED       @ZM30982*/ 00494000
         TM    PRINT(OCMTBPTR),B'00000010'                         0178 00495000
         BNO   @RF00178                                            0178 00496000
*               IF FIRSTIME=YES&CLASBUFF^=BLANKS THEN/* CLASS      0179 00497000
*                                      REQUESTED BUT NO HELD OUTPUT     00498000
*                                                            @ZM30982*/ 00499000
         TM    FIRSTIME,B'10000000'                                0179 00500000
         BNO   @RF00179                                            0179 00501000
         CLC   CLASBUFF(8,OCMTBPTR),@CC01391                       0179 00502000
         BE    @RF00179                                            0179 00503000
*                 DO;               /*                       @ZM30982*/ 00504000
*                   OUTMSGID=56;    /* ISSUE MSG 320I SINCE ONLY 1 0181 00505000
*                                      CLASS SEARCHED AND NO HELD  0181 00506000
*                                      OUTPUT                @ZM30982*/ 00507000
         MVI   OUTMSGID(OCMTBPTR),X'38'                            0181 00508000
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER    0182 00509000
*                                                            @ZM30982*/ 00510000
         ST    OCMTBPTR,@AL00001                                   0182 00511000
         L     @15,@CV01406                                        0182 00512000
         LA    @01,@AL00001                                        0182 00513000
         BALR  @14,@15                                             0182 00514000
*                   RETNCODE=ZERO;  /* TELL 69 TO PASS NEXT JB/CL  0183 00515000
*                                      COMBINATION           @ZM30982*/ 00516000
         SLR   @14,@14                                             0183 00517000
         ST    @14,RETNCODE                                        0183 00518000
*                 END;              /*                       @ZM30982*/ 00519000
*               ELSE                /*                       @ZM30982*/ 00520000
*                 IF FIRSTIME=YES&CLASBUFF=BLANKS THEN/* ALL HELD  0185 00521000
*                                      CLASSES SEARCHED BUT NO OUTPUT   00522000
*                                                            @ZM30982*/ 00523000
         B     @RC00179                                            0185 00524000
@RF00179 TM    FIRSTIME,B'10000000'                                0185 00525000
         BNO   @RF00185                                            0185 00526000
         CLC   CLASBUFF(8,OCMTBPTR),@CC01391                       0185 00527000
         BNE   @RF00185                                            0185 00528000
*                   DO;             /*                       @ZM30982*/ 00529000
*                     OUTMSGID=60;  /* ISSUE MSG 339I SINCE ALL    0187 00530000
*                                      CLASSES SEARCHED BUT NO OUTPUT   00531000
*                                                            @ZM30982*/ 00532000
         MVI   OUTMSGID(OCMTBPTR),X'3C'                            0187 00533000
*                     CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER  0188 00534000
*                                                            @ZM30982*/ 00535000
         ST    OCMTBPTR,@AL00001                                   0188 00536000
         L     @15,@CV01406                                        0188 00537000
         LA    @01,@AL00001                                        0188 00538000
         BALR  @14,@15                                             0188 00539000
*                     RETNCODE=FOUR;/* TELL 69 TO PASS NEXT JOB    0189 00540000
*                                                            @ZM30982*/ 00541000
         MVC   RETNCODE(4),@CF00053                                0189 00542000
*                   END;            /*                       @ZM30982*/ 00543000
*                 ELSE              /* NO MORE DATA SETS FOR THIS  0191 00544000
*                                      JOB/CLASS             @ZM30982*/ 00545000
*                   RETNCODE=ZERO;  /* TELL 69 TO PASS NEXT JB/CL  0191 00546000
*                                      COMBINATION           @ZM30982*/ 00547000
         B     @RC00185                                            0191 00548000
@RF00185 SLR   @14,@14                                             0191 00549000
         ST    @14,RETNCODE                                        0191 00550000
*             ELSE                  /* DELETE OR ROUTE REQUESTED   0192 00551000
*                                                            @ZM30982*/ 00552000
*               IF ENDLIST=YES&WORKDONE=NO&CLASBUFF^=BLANKS THEN/* 0192 00553000
*                                      LAST CALL FOR THIS JOB AND NO    00554000
*                                      WORK ACCOMPLISHED FOR GIVEN 0192 00555000
*                                      CLASS(ES)             @ZM30982*/ 00556000
         B     @RC00178                                            0192 00557000
@RF00178 TM    ENDLIST(OCMTBPTR),B'00001000'                       0192 00558000
         BNO   @RF00192                                            0192 00559000
         TM    WORKDONE(OCMTBPTR),B'00010000'                      0192 00560000
         BNZ   @RF00192                                            0192 00561000
         CLC   CLASBUFF(8,OCMTBPTR),@CC01391                       0192 00562000
         BE    @RF00192                                            0192 00563000
*                 DO;               /*                       @ZM30982*/ 00564000
*                   OUTMSGID=64;    /* ISSUE MSG 343I, SINCE NO    0194 00565000
*                                      OUTPUT IN CLASSES REQUESTED 0194 00566000
*                                                            @ZM30982*/ 00567000
         MVI   OUTMSGID(OCMTBPTR),X'40'                            0194 00568000
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER    0195 00569000
*                                                            @ZM30982*/ 00570000
         ST    OCMTBPTR,@AL00001                                   0195 00571000
         L     @15,@CV01406                                        0195 00572000
         LA    @01,@AL00001                                        0195 00573000
         BALR  @14,@15                                             0195 00574000
*                   RETNCODE=FOUR;  /* TELL 69 TO PASS NEXT JOB    0196 00575000
*                                                            @ZM30982*/ 00576000
         MVC   RETNCODE(4),@CF00053                                0196 00577000
*                 END;              /*                       @ZM30982*/ 00578000
*               ELSE                /*                       @ZM30982*/ 00579000
*                 IF ENDLIST=YES&WORKDONE=NO&CLASBUFF=BLANKS THEN/*     00580000
*                                      LAST AND ONLY CALL FOR THIS 0198 00581000
*                                      JOB-NO CLASS GIVEN & ALL HELD    00582000
*                                      CLASSES SEARCHED      @ZM30982*/ 00583000
         B     @RC00192                                            0198 00584000
@RF00192 TM    ENDLIST(OCMTBPTR),B'00001000'                       0198 00585000
         BNO   @RF00198                                            0198 00586000
         TM    WORKDONE(OCMTBPTR),B'00010000'                      0198 00587000
         BNZ   @RF00198                                            0198 00588000
         CLC   CLASBUFF(8,OCMTBPTR),@CC01391                       0198 00589000
         BNE   @RF00198                                            0198 00590000
*                   DO;             /*                       @ZM30982*/ 00591000
*                     OUTMSGID=60;  /* ISSUE MSG M339, SINCE NO    0200 00592000
*                                      OUTPUT IN ANY HELD CLASSES  0200 00593000
*                                                            @ZM30982*/ 00594000
         MVI   OUTMSGID(OCMTBPTR),X'3C'                            0200 00595000
*                     CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER  0201 00596000
*                                                            @ZM30982*/ 00597000
         ST    OCMTBPTR,@AL00001                                   0201 00598000
         L     @15,@CV01406                                        0201 00599000
         LA    @01,@AL00001                                        0201 00600000
         BALR  @14,@15                                             0201 00601000
*                     RETNCODE=FOUR;/* TELL 69 TO PASS NEXT JOB    0202 00602000
*                                                            @ZM30982*/ 00603000
         MVC   RETNCODE(4),@CF00053                                0202 00604000
*                   END;            /*                       @ZM30982*/ 00605000
*                 ELSE              /* NOT LAST CALL FOR THIS JOB  0204 00606000
*                                                            @ZM30982*/ 00607000
*                   RETNCODE=ZERO;  /* TELL 69 TO PASS NEXT JB/CL  0204 00608000
*                                      COMBINATION           @ZM30982*/ 00609000
         B     @RC00198                                            0204 00610000
@RF00198 SLR   @14,@14                                             0204 00611000
         ST    @14,RETNCODE                                        0204 00612000
*           END;                                                   0205 00613000
*         ELSE                      /* CHECK FURTHER                 */ 00614000
*           IF SSOBRETN=SSSONJOB THEN/* SSOBRETN=8 - NO JOB FOUND    */ 00615000
*                                                                  0206 00616000
         B     @RC00176                                            0206 00617000
@RF00176 L     @14,OUTSOBH(,OCMTBPTR)                              0206 00618000
         CLC   SSOBRETN(4,@14),@CF00047                            0206 00619000
         BNE   @RF00206                                            0206 00620000
*             /*******************************************************/ 00621000
*             /*                                                     */ 00622000
*             /* SSOBRETN=8 (NO JOB FOUND)                           */ 00623000
*             /*                                                     */ 00624000
*             /*******************************************************/ 00625000
*                                                                  0207 00626000
*             DO;                                                  0207 00627000
*               IF PRINT=YES THEN   /* PRINT REQUESTED               */ 00628000
         TM    PRINT(OCMTBPTR),B'00000010'                         0208 00629000
         BNO   @RF00208                                            0208 00630000
*                 DO;                                              0209 00631000
*                   IF WORKDONE=NO THEN/* NO JOB FOUND AND NO WORK 0210 00632000
*                                      ACCOMPLISHED                  */ 00633000
         TM    WORKDONE(OCMTBPTR),B'00010000'                      0210 00634000
         BNZ   @RF00210                                            0210 00635000
*                     DO;                                          0211 00636000
*                       RETNCODE=FOUR;/* TELL '69 TO PASS NEXT JOB   */ 00637000
         MVC   RETNCODE(4),@CF00053                                0212 00638000
*                       OUTMSGID=102;/* ISSUE MSG 340I-JOB NOT FND   */ 00639000
         MVI   OUTMSGID(OCMTBPTR),X'66'                            0213 00640000
*                     END;                                         0214 00641000
*                   ELSE            /* JOB NOT FOUND, BUT PREVIOUS 0215 00642000
*                                      WORK ACCOMPLISHED BEFORE DATA    00643000
*                                      PRINTED AND JOB PURGED        */ 00644000
*                     DO;                                          0215 00645000
         B     @RC00210                                            0215 00646000
@RF00210 DS    0H                                                  0216 00647000
*                       RETNCODE=ZERO;/* TELL '69 TO PASS NEXT CLASS    00648000
*                                      WITH THIS JOB                 */ 00649000
         SLR   @14,@14                                             0216 00650000
         ST    @14,RETNCODE                                        0216 00651000
*                       OUTMSGID=56;/* ISSUE MSG 320I-NO OUTPUT IN 0217 00652000
*                                      THIS CLASS            @ZM30892*/ 00653000
         MVI   OUTMSGID(OCMTBPTR),X'38'                            0217 00654000
*                     END;                                         0218 00655000
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER      */ 00656000
@RC00210 ST    OCMTBPTR,@AL00001                                   0219 00657000
         L     @15,@CV01406                                        0219 00658000
         LA    @01,@AL00001                                        0219 00659000
         BALR  @14,@15                                             0219 00660000
*                 END;              /* END OF PRINT PROCESSING FOR 0220 00661000
*                                      RC=8                          */ 00662000
*               ELSE                /* DELETE OR ROUTE REQUEST       */ 00663000
*                 DO;                                              0221 00664000
         B     @RC00208                                            0221 00665000
@RF00208 DS    0H                                                  0222 00666000
*                   RETNCODE=FOUR;  /* TELL '69 TO PASS NEXT JOB     */ 00667000
         MVC   RETNCODE(4),@CF00053                                0222 00668000
*                   IF WORKDONE=NO THEN/* NO JOB FOUND AND NO WORK 0223 00669000
*                                      ACCOMPLISHED BEFORE           */ 00670000
         TM    WORKDONE(OCMTBPTR),B'00010000'                      0223 00671000
         BNZ   @RF00223                                            0223 00672000
*                     DO;                                          0224 00673000
*                       OUTMSGID=102;/* ISSUE MSG 340I-JOB NOT FOUND */ 00674000
         MVI   OUTMSGID(OCMTBPTR),X'66'                            0225 00675000
*                       CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER  */ 00676000
         ST    OCMTBPTR,@AL00001                                   0226 00677000
         L     @15,@CV01406                                        0226 00678000
         LA    @01,@AL00001                                        0226 00679000
         BALR  @14,@15                                             0226 00680000
*                     END;                                         0227 00681000
*                   ELSE                                           0228 00682000
*                     ;             /* JOB NO LONGER FOUND, BUT WORK    00683000
*                                      WAS ACCOMPLISHED BEFORE       */ 00684000
@RF00223 DS    0H                                                  0229 00685000
*                 END;              /* END OF ROUTE REQUEST        0229 00686000
*                                      PROCESSING FOR RC=8           */ 00687000
*             END;                                                 0230 00688000
*           ELSE                    /* CHECK FURTHER                 */ 00689000
*             IF SSOBRETN=SSSOINVA THEN/* SSOBRETN=12 - INV SRCH ARG */ 00690000
*                                                                  0231 00691000
         B     @RC00206                                            0231 00692000
@RF00206 LA    @14,12                                              0231 00693000
         L     @05,OUTSOBH(,OCMTBPTR)                              0231 00694000
         L     @05,SSOBRETN(,@05)                                  0231 00695000
         CR    @05,@14                                             0231 00696000
         BNE   @RF00231                                            0231 00697000
*               /*****************************************************/ 00698000
*               /*                                                   */ 00699000
*               /* SSOBRETN=12 (INVALID SEARCH ARGS)                 */ 00700000
*               /*                                                   */ 00701000
*               /*****************************************************/ 00702000
*                                                                  0232 00703000
*               DO;                                                0232 00704000
*                 RETNCODE=TWELVE;  /* QUIT COMMAND                  */ 00705000
         ST    @14,RETNCODE                                        0233 00706000
*                 ERROR=YES;        /* SEVERE ERROR                  */ 00707000
         OI    ERROR(OCMTBPTR),B'00001000'                         0234 00708000
*                 OUTRTCD=SSOBRETN; /* SAVE SSOBRETN CODE FOR '67    */ 00709000
         STH   @05,OUTRTCD(,OCMTBPTR)                              0235 00710000
*                 OUTMSGID=146;     /* ISSUE MSG 358I                */ 00711000
         MVI   OUTMSGID(OCMTBPTR),X'92'                            0236 00712000
*                 CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER        */ 00713000
         ST    OCMTBPTR,@AL00001                                   0237 00714000
         L     @15,@CV01406                                        0237 00715000
         LA    @01,@AL00001                                        0237 00716000
         BALR  @14,@15                                             0237 00717000
*               END;                                               0238 00718000
*             ELSE                  /* CHECK FURTHER                 */ 00719000
*               IF SSOBRETN=SSSOUNAV THEN/* SSOBRETN=16 - UNABLE TO     00720000
*                                      PROCESS JOB NOW               */ 00721000
*                                                                  0239 00722000
         B     @RC00231                                            0239 00723000
@RF00231 L     @14,OUTSOBH(,OCMTBPTR)                              0239 00724000
         CLC   SSOBRETN(4,@14),@CF00101                            0239 00725000
         BNE   @RF00239                                            0239 00726000
*                 /***************************************************/ 00727000
*                 /*                                                 */ 00728000
*                 /* SSOBRETN=16 (UNABLE TO PROCESS JOB NOW)         */ 00729000
*                 /*                                                 */ 00730000
*                 /***************************************************/ 00731000
*                                                                  0240 00732000
*                 DO;                                              0240 00733000
*                   RETNCODE=FOUR;  /* TELL 69 TO PASS NEXT JOB      */ 00734000
         MVC   RETNCODE(4),@CF00053                                0241 00735000
*                   OUTMSGID=129;   /* ISSUE MSG 350I                */ 00736000
         MVI   OUTMSGID(OCMTBPTR),X'81'                            0242 00737000
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER      */ 00738000
         ST    OCMTBPTR,@AL00001                                   0243 00739000
         L     @15,@CV01406                                        0243 00740000
         LA    @01,@AL00001                                        0243 00741000
         BALR  @14,@15                                             0243 00742000
*                 END;                                             0244 00743000
*               ELSE                /* CHECK FURTHER                 */ 00744000
*                 IF SSOBRETN=SSSODUPJ THEN/* SSOBRETN=20 - DUP    0245 00745000
*                                      JOBNAMES                      */ 00746000
*                                                                  0245 00747000
         B     @RC00239                                            0245 00748000
@RF00239 L     @14,OUTSOBH(,OCMTBPTR)                              0245 00749000
         CLC   SSOBRETN(4,@14),@CF00813                            0245 00750000
         BNE   @RF00245                                            0245 00751000
*                   /*************************************************/ 00752000
*                   /*                                               */ 00753000
*                   /* SSOBRETN=20 (DUPLICATE JOB NAMES)             */ 00754000
*                   /*                                               */ 00755000
*                   /*************************************************/ 00756000
*                                                                  0246 00757000
*                   DO;                                            0246 00758000
*                     RETNCODE=FOUR;/* TELL 69 TO PASS NEXT JOB      */ 00759000
         MVC   RETNCODE(4),@CF00053                                0247 00760000
*                     OUTMSGID=136; /* ISSUE MSG 348I                */ 00761000
         MVI   OUTMSGID(OCMTBPTR),X'88'                            0248 00762000
*                     CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER    */ 00763000
         ST    OCMTBPTR,@AL00001                                   0249 00764000
         L     @15,@CV01406                                        0249 00765000
         LA    @01,@AL00001                                        0249 00766000
         BALR  @14,@15                                             0249 00767000
*                   END;                                           0250 00768000
*                 ELSE              /* CHECK FURTHER                 */ 00769000
*                   IF SSOBRETN=SSSOINVJ THEN/* SSOBRETN=24 - INV  0251 00770000
*                                      JOBNAME- JOBID COMBINATION    */ 00771000
*                                                                  0251 00772000
         B     @RC00245                                            0251 00773000
@RF00245 L     @14,OUTSOBH(,OCMTBPTR)                              0251 00774000
         CLC   SSOBRETN(4,@14),@CF00182                            0251 00775000
         BNE   @RF00251                                            0251 00776000
*                     /***********************************************/ 00777000
*                     /*                                             */ 00778000
*                     /* SSOBRETN=24 (INVALID JOBNAME/JOBID)         */ 00779000
*                     /*                                             */ 00780000
*                     /***********************************************/ 00781000
*                                                                  0252 00782000
*                     DO;                                          0252 00783000
*                       RETNCODE=FOUR;/* TELL 69 TO PASS NEXT JOB    */ 00784000
         MVC   RETNCODE(4),@CF00053                                0253 00785000
*                       OUTMSGID=137;/* ISSUE MSG 349I               */ 00786000
         MVI   OUTMSGID(OCMTBPTR),X'89'                            0254 00787000
*                       CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER  */ 00788000
         ST    OCMTBPTR,@AL00001                                   0255 00789000
         L     @15,@CV01406                                        0255 00790000
         LA    @01,@AL00001                                        0255 00791000
         BALR  @14,@15                                             0255 00792000
*                     END;                                         0256 00793000
*                   ELSE            /* CHECK FURTHER                 */ 00794000
*                     IF SSOBRETN=SSSOIDST THEN/* SSOBRETN=28 -    0257 00795000
*                                      INVALID DESTID                */ 00796000
*                                                                  0257 00797000
         B     @RC00251                                            0257 00798000
@RF00251 L     @14,OUTSOBH(,OCMTBPTR)                              0257 00799000
         L     @14,SSOBRETN(,@14)                                  0257 00800000
         CH    @14,@CH00823                                        0257 00801000
         BNE   @RF00257                                            0257 00802000
*                       /*********************************************/ 00803000
*                       /*                                           */ 00804000
*                       /* SSOBRETN=28 (INVALID DESTID)              */ 00805000
*                       /*                                           */ 00806000
*                       /*********************************************/ 00807000
*                                                                  0258 00808000
*                       DO;                                        0258 00809000
*                         RETNCODE=TWELVE;/* QUIT COMMAND            */ 00810000
         MVC   RETNCODE(4),@CF00034                                0259 00811000
*                         ERROR=YES;/* SEVERE ERROR                  */ 00812000
         OI    ERROR(OCMTBPTR),B'00001000'                         0260 00813000
*                         OUTRTCD=SSOBRETN;/* SAVE SSOBRETN CODE FOR    00814000
*                                      '67                           */ 00815000
         STH   @14,OUTRTCD(,OCMTBPTR)                              0261 00816000
*                         OUTMSGID=130;/* ISSUE MSG 351I             */ 00817000
         MVI   OUTMSGID(OCMTBPTR),X'82'                            0262 00818000
*                         CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER*/ 00819000
         ST    OCMTBPTR,@AL00001                                   0263 00820000
         L     @15,@CV01406                                        0263 00821000
         LA    @01,@AL00001                                        0263 00822000
         BALR  @14,@15                                             0263 00823000
*                       END;                                       0264 00824000
*                     ELSE          /* SSOBRETN=? - SOME STRANGE   0265 00825000
*                                      RETURN CODE                   */ 00826000
*                                                                  0265 00827000
*                       /*********************************************/ 00828000
*                       /*                                           */ 00829000
*                       /* SSOBRETN=? (STRANGE RC)                   */ 00830000
*                       /*                                           */ 00831000
*                       /*********************************************/ 00832000
*                                                                  0265 00833000
*                       DO;                                        0265 00834000
         B     @RC00257                                            0265 00835000
@RF00257 DS    0H                                                  0266 00836000
*                         RETNCODE=TWELVE;/* QUIT COMMAND            */ 00837000
         MVC   RETNCODE(4),@CF00034                                0266 00838000
*                         ERROR=YES;/* ERROR OCCURRED                */ 00839000
         OI    ERROR(OCMTBPTR),B'00001000'                         0267 00840000
*                         OUTRTCD=SSOBRETN;/* SAVE SSOB RETURN CODE     00841000
*                                      FOR '67                       */ 00842000
         L     @14,OUTSOBH(,OCMTBPTR)                              0268 00843000
         MVC   OUTRTCD(2,OCMTBPTR),SSOBRETN+2(@14)                 0268 00844000
*                         OUTMSGID=138;/* ISSUE MSG 353I             */ 00845000
         MVI   OUTMSGID(OCMTBPTR),X'8A'                            0269 00846000
*                         CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER*/ 00847000
         ST    OCMTBPTR,@AL00001                                   0270 00848000
         L     @15,@CV01406                                        0270 00849000
         LA    @01,@AL00001                                        0270 00850000
         BALR  @14,@15                                             0270 00851000
*                       END;                                       0271 00852000
*     END;                          /* END OF SSOBRETN CHECK         */ 00853000
*                                                                  0273 00854000
*   /*****************************************************************/ 00855000
*   /*                                                               */ 00856000
*   /* SUBSYSTEM RETURN CODE IS NON ZERO                             */ 00857000
*   /*                                                               */ 00858000
*   /*****************************************************************/ 00859000
*                                                                  0273 00860000
*   ELSE                            /* SUBSYSTEM RETURN CODE IS NON     00861000
*                                      ZERO - ANALYZE FURTHER        */ 00862000
*     DO;                                                          0273 00863000
         B     @RC00166                                            0273 00864000
@RF00166 DS    0H                                                  0274 00865000
*       ERROR=ON;                   /* SET QUIT SW INDICATION ERR    */ 00866000
         OI    ERROR(OCMTBPTR),B'00001000'                         0274 00867000
*       RETNCODE=TWELVE;            /* SET RETURN CODE TO 12         */ 00868000
         MVC   RETNCODE(4),@CF00034                                0275 00869000
*       IF OUTRTCD=SSRTNSUP|OUTRTCD=SSRTLERR THEN/* SUBSYS RC=4 OR 0276 00870000
*                                      20, FUNCTION NOT SUPPORTED OR    00871000
*                                      LOGICAL ERROR                 */ 00872000
         LH    @14,OUTRTCD(,OCMTBPTR)                              0276 00873000
         CH    @14,@CH00053                                        0276 00874000
         BE    @RT00276                                            0276 00875000
         CH    @14,@CH00813                                        0276 00876000
         BNE   @RF00276                                            0276 00877000
@RT00276 DS    0H                                                  0277 00878000
*         OUTMSGID=133;             /* ISSUE MSG 345I                */ 00879000
         MVI   OUTMSGID(OCMTBPTR),X'85'                            0277 00880000
*       ELSE                        /* CHECK FURTHER                 */ 00881000
*         IF OUTRTCD=SSRTNTUP THEN  /* SUBSYS RC=8,SUBSYS NOT UP     */ 00882000
         B     @RC00276                                            0278 00883000
@RF00276 CLC   OUTRTCD(2,OCMTBPTR),@CH00047                        0278 00884000
         BNE   @RF00278                                            0278 00885000
*           OUTMSGID=135;           /* ISSUE MSG 347I                */ 00886000
         MVI   OUTMSGID(OCMTBPTR),X'87'                            0279 00887000
*         ELSE                      /* SUBSYS RC=12,16,OR ANY OTHER     00888000
*                                      NON ZERO- SUBSYS NO EXIST OR     00889000
*                                      DISASTROUS ERROR              */ 00890000
*           OUTMSGID=134;           /* ISSUE MSG 346I                */ 00891000
         B     @RC00278                                            0280 00892000
@RF00278 MVI   OUTMSGID(OCMTBPTR),X'86'                            0280 00893000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MESSAGE HANDLER          */ 00894000
@RC00278 DS    0H                                                  0281 00895000
@RC00276 ST    OCMTBPTR,@AL00001                                   0281 00896000
         L     @15,@CV01406                                        0281 00897000
         LA    @01,@AL00001                                        0281 00898000
         BALR  @14,@15                                             0281 00899000
*     END;                                                         0282 00900000
*   END SUBSYSTM;                   /* END OF SUBSYS RTN             */ 00901000
@EL00003 DS    0H                                                  0283 00902000
@EF00003 DS    0H                                                  0283 00903000
@ER00003 LM    @14,@12,@SA00003                                    0283 00904000
         BR    @14                                                 0283 00905000
*                                                                  0284 00906000
*/********************************************************************/ 00907000
*/*                                                                  */ 00908000
*/*    INITIALIZE THE REQUEST BLOCK POINTER, THE TEXT UNIT POINTER   */ 00909000
*/*      LIST AND THE TEXT UNITS FOR ALLOCATING THE SYSOUT DATA SET  */ 00910000
*/*    SET REGISTER 1 WITH THE REQUEST BLOCK POINTER ADDRESS AND     */ 00911000
*/*      ISSUE SVC 99                                                */ 00912000
*/*    ANALYZE THE RETURN CODE AND TAKE APPROPRIATE ACTION           */ 00913000
*/*                                                                  */ 00914000
*/********************************************************************/ 00915000
*                                                                  0284 00916000
*ALLOCSO:                                                          0284 00917000
*   PROC;                           /* INTERNAL PROCEDURE TO ALLOCATE   00918000
*                                      THE SYSOUT DATASET            */ 00919000
ALLOCSO  STM   @14,@12,@SA00004                                    0284 00920000
*/********************************************************************/ 00921000
*/*   SET UP THE REQUEST BLOCK                                       */ 00922000
*/********************************************************************/ 00923000
*                                                                  0285 00924000
*   S99RB=S99RB&&S99RB;             /* CLEAR THE REQUEST BLOCK       */ 00925000
         XC    S99RB(20),S99RB                                     0285 00926000
*   S99RBLN=LENGTH(S99RB);          /* LENGTH OF REQUEST BLOCK       */ 00927000
         MVI   S99RBLN,X'14'                                       0286 00928000
*   S99VERB=S99VRBAL;               /* ALLOCATION VERB CODE          */ 00929000
         MVI   S99VERB,X'01'                                       0287 00930000
*   S99TXTPP=ADDR(PTRLIST);         /* ADDRESS TEXT UNIT PTR LIST    */ 00931000
         LA    @14,PTRLIST                                         0288 00932000
         ST    @14,S99TXTPP                                        0288 00933000
*/********************************************************************/ 00934000
*/*   SETUP TEXT UNIT POINTER LIST AND THE TEXT UNITS FOR ALLOCATING */ 00935000
*/*   THE SYSOUT DATA SET                                            */ 00936000
*/********************************************************************/ 00937000
*                                                                  0289 00938000
*   PLIST=PLIST&&PLIST;             /* CLEAR POINTER LIST            */ 00939000
         XC    PLIST(16),PLIST                                     0289 00940000
*   ADSNTU=ADSNTU&&ADSNTU;          /* CLEAR TEXT UNIT               */ 00941000
         XC    ADSNTU(54),ADSNTU                                   0290 00942000
*   ASSREQTU=ASSREQTU&&ASSREQTU;    /* CLEAR TEXT UNIT               */ 00943000
         XC    ASSREQTU(4),ASSREQTU                                0291 00944000
*   ARTDDNTU=ARTDDNTU&&ARTDDNTU;    /* CLEAR TEXT UNIT               */ 00945000
         XC    ARTDDNTU(18),ARTDDNTU                               0292 00946000
*   RFY                                                            0293 00947000
*     S99TUNIT BASED(S99TUPTR(ELEM));/* BASE TEXT UNIT ON ADDR IN  0293 00948000
*                                      CURRENT PTR LIST ELEMENT      */ 00949000
*/*                                                                  */ 00950000
*                                                                  0294 00951000
*   ELEM=ONE;                       /* INIT INDEX INTO PTR LIST      */ 00952000
         LA    @05,1                                               0294 00953000
         LR    ELEM,@05                                            0294 00954000
*   S99TUPTR(ELEM)=ADDR(ADSNTU);    /* ADDR 'DSN ALC' TU INTO PTRLST */ 00955000
         LR    @09,ELEM                                            0295 00956000
         SLA   @09,2                                               0295 00957000
         LA    @08,ADSNTU                                          0295 00958000
         AL    @09,@CF01588                                        0295 00959000
         ST    @08,S99TUPTR(@09,@14)                               0295 00960000
*   S99TUKEY=DALDSNAM;              /* KEY FOR DSN SPECIFICATION     */ 00961000
         MVC   S99TUKEY(2,@08),@CB00926                            0296 00962000
*   S99TUNUM=1;                     /* ONE PARAMETER                 */ 00963000
         MVC   S99TUNUM(2,@08),@CH00033                            0297 00964000
*   S99TUPAR(1:44)=SSSODSN;         /* SYSOUT DSNAME                 */ 00965000
         L     @09,OUTSOBSO(,OCMTBPTR)                             0298 00966000
         MVC   S99TUPAR(44,@08),SSSODSN(@09)                       0298 00967000
*   S99TULNG=LENGTH(SSSODSN);       /* LENGTH OF SYSOUT DSNAME       */ 00968000
         MVC   S99TULNG(2,@08),@CH00857                            0299 00969000
*/*                                                                  */ 00970000
*                                                                  0300 00971000
*   ELEM=ELEM+ONE;                  /* INCRE INDEX INTO PTR LIST     */ 00972000
         ALR   ELEM,@05                                            0300 00973000
*   S99TUPTR(ELEM)=ADDR(ASSREQTU);  /* ADDR 'SUBSYS REQ' TU IN LST   */ 00974000
         LR    @09,ELEM                                            0301 00975000
         SLA   @09,2                                               0301 00976000
         LA    @08,ASSREQTU                                        0301 00977000
         AL    @09,@CF01588                                        0301 00978000
         ST    @08,S99TUPTR(@09,@14)                               0301 00979000
*   S99TUKEY=DALSSREQ;              /* KEY FOR SUBSYS REQ ON ALLOC   */ 00980000
         MVC   S99TUKEY(2,@08),@CB01106                            0302 00981000
*   S99TUNUM=0;                     /* NO PARAMETERS                 */ 00982000
         SLR   @09,@09                                             0303 00983000
         ST    @09,@TF00001                                        0303 00984000
         MVC   S99TUNUM(2,@08),@TF00001+2                          0303 00985000
*/*                                                                  */ 00986000
*                                                                  0304 00987000
*   ELEM=ELEM+ONE;                  /* INCRE INDEX INTO PTR LIST     */ 00988000
         ALR   ELEM,@05                                            0304 00989000
*   S99TUPTR(ELEM)=ADDR(ARTDDNTU);  /* ADDR 'RETN DDN' TU INTO PLST  */ 00990000
         LR    @09,ELEM                                            0305 00991000
         SLA   @09,2                                               0305 00992000
         LA    @08,ARTDDNTU                                        0305 00993000
         AL    @09,@CF01588                                        0305 00994000
         ST    @08,S99TUPTR(@09,@14)                               0305 00995000
*   S99TUKEY=DALRTDDN;              /* KEY FOR DDN RETURN            */ 00996000
         MVC   S99TUKEY(2,@08),@CB01092                            0306 00997000
*   S99TUNUM=1;                     /* ONE PARAMETER                 */ 00998000
         MVC   S99TUNUM(2,@08),@CH00033                            0307 00999000
*   S99TUPAR(1:8)='';               /* DDNAME - INIT TO BLANKS       */ 01000000
         MVI   S99TUPAR(@08),C' '                                  0308 01001000
         MVC   S99TUPAR+1(7,@08),S99TUPAR(@08)                     0308 01002000
*   S99TULNG=8;                     /* LENGTH DDNAME                 */ 01003000
         MVC   S99TULNG(2,@08),@CH00047                            0309 01004000
*/*                                                                  */ 01005000
*                                                                  0310 01006000
*   ELEM=ELEM+ONE;                  /* INCRE INDEX INTO PTR LIST     */ 01007000
         ALR   ELEM,@05                                            0310 01008000
*   S99TUPTR(ELEM)=ADDR(ADISPTU);   /* ADDR 'DS STATUS' TU IN LIST   */ 01009000
         LR    @09,ELEM                                            0311 01010000
         SLA   @09,2                                               0311 01011000
         LA    @08,ADISPTU                                         0311 01012000
         LA    @07,0(@09,@14)                                      0311 01013000
         AL    @07,@CF01588                                        0311 01014000
         ST    @08,S99TUPTR(,@07)                                  0311 01015000
*   S99TUKEY=DALSTATS;              /* KEY FOR DS STATUS             */ 01016000
         MVC   S99TUKEY(2,@08),@CB00930                            0312 01017000
*   S99TUNUM=1;                     /* ONE PARAMETER                 */ 01018000
         MVC   S99TUNUM(2,@08),@CH00033                            0313 01019000
*   S99TUPAR(1)=1;                  /* DISPOSITION 'OLD'             */ 01020000
         STC   @05,S99TUPAR(,@08)                                  0314 01021000
*   S99TULNG=1;                     /* LENGTH OF DISPOSION           */ 01022000
         MVC   S99TULNG(2,@08),@CH00033                            0315 01023000
*/*                                                                  */ 01024000
*                                                                  0316 01025000
*   S99TUPLN(ELEM)=ON;              /* SET END OF PTRLIST INDICATOR  */ 01026000
         ALR   @14,@09                                             0316 01027000
         AL    @14,@CF01588                                        0316 01028000
         OI    S99TUPLN(@14),B'10000000'                           0316 01029000
*                                                                  0317 01030000
*/********************************************************************/ 01031000
*/*   INVOKE DYNAMIC ALLOCATION                                      */ 01032000
*/********************************************************************/ 01033000
*                                                                  0317 01034000
*   S99RBPTR=ADDR(S99RB);           /* SET UP REQUEST BLOCK PTR      */ 01035000
         LA    @14,S99RB                                           0317 01036000
         ST    @14,S99RBPTR                                        0317 01037000
*   S99RBPND=ON;                    /* TURN ON HI ORDER BIT          */ 01038000
         OI    S99RBPND,B'10000000'                                0318 01039000
*   REG1=ADDR(S99RBPTR);            /* PASS S99RB PTR TO DYN ALC     */ 01040000
         LA    REG1,S99RBPTR                                       0319 01041000
*/* MACDATE Y-2 73082                                                */ 01042000
*                                                                  0320 01043000
*   SVC(99);                        /* INVOKE DYNAMIC ALLOCATION     */ 01044000
         SVC   99                                                  0320 01045000
*   OUTRTCD=REG15;                  /* SAVE DYN ALLOC RTN CODE       */ 01046000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0321 01047000
*/********************************************************************/ 01048000
*/*   ANALYZE DYNAMIC ALLOCATION RETURN CODE                         */ 01049000
*/********************************************************************/ 01050000
*                                                                  0322 01051000
*   IF OUTRTCD=ZERO THEN            /* IF ALLOCATION WAS SUCCESSFUL  */ 01052000
         SLR   @14,@14                                             0322 01053000
         LH    @05,OUTRTCD(,OCMTBPTR)                              0322 01054000
         CR    @05,@14                                             0322 01055000
         BNE   @RF00322                                            0322 01056000
*     DO;                                                          0323 01057000
*       ALLOC=ON;                   /* INDICATE SYSOUT IS ALLOC      */ 01058000
         OI    ALLOC(OCMTBPTR),B'00000100'                         0324 01059000
*       RFY                                                        0325 01060000
*         S99TUNIT BASED(ADDR(ARTDDNTU));/* BASE TU MAP ON 'RETN DDN'   01061000
*                                      TU                            */ 01062000
*       OSYSODDN(1:8)=S99TUPAR(1:8);/* SAVE DDN OF ALLOC SYSOUT DATA    01063000
*                                      SET                           */ 01064000
         LA    @05,ARTDDNTU                                        0326 01065000
         MVC   OSYSODDN(8,OCMTBPTR),S99TUPAR(@05)                  0326 01066000
*       IF S99INFO^=ZERO THEN       /* IF INFO MESSAGE NEEDED        */ 01067000
         MVC   @ZT00002+2(2),S99INFO                               0327 01068000
         C     @14,@ZT00002                                        0327 01069000
         BE    @RF00327                                            0327 01070000
*         DO;                                                      0328 01071000
*           OUTDARB=ADDR(S99RB);    /* SET UP FOR DAIRFAIL           */ 01072000
         LA    @14,S99RB                                           0329 01073000
         ST    @14,OUTDARB(,OCMTBPTR)                              0329 01074000
*           OUTMSGID=8;             /* MSG ID FOR IKJCT467           */ 01075000
         MVI   OUTMSGID(OCMTBPTR),X'08'                            0330 01076000
*           CALL IKJCT467(OUTCOMTB);/* CALL MESSAGE HANDLER          */ 01077000
         ST    OCMTBPTR,@AL00001                                   0331 01078000
         L     @15,@CV01406                                        0331 01079000
         LA    @01,@AL00001                                        0331 01080000
         BALR  @14,@15                                             0331 01081000
*         END;                                                     0332 01082000
*       ELSE                                                       0333 01083000
*         ;                         /* NO INFO MSG NEEDED            */ 01084000
@RF00327 DS    0H                                                  0334 01085000
*     END;                                                         0334 01086000
*   ELSE                            /* ALLOCATION NOT SUCCESSFUL     */ 01087000
*     DO;                           /* DYN ALC RETURN CODE NOT ZERO  */ 01088000
         B     @RC00322                                            0335 01089000
@RF00322 DS    0H                                                  0336 01090000
*       OUTDARB=ADDR(S99RB);        /* SET UP FOR DAIRFAIL           */ 01091000
         LA    @14,S99RB                                           0336 01092000
         ST    @14,OUTDARB(,OCMTBPTR)                              0336 01093000
*       OUTMSGID=8;                 /* MSG ID FOR IKJCT467           */ 01094000
         MVI   OUTMSGID(OCMTBPTR),X'08'                            0337 01095000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MESSAGE HANDLER          */ 01096000
         ST    OCMTBPTR,@AL00001                                   0338 01097000
         L     @15,@CV01406                                        0338 01098000
         LA    @01,@AL00001                                        0338 01099000
         BALR  @14,@15                                             0338 01100000
*       ERROR=YES;                  /* SET QUIT SWITCH               */ 01101000
         OI    ERROR(OCMTBPTR),B'00001000'                         0339 01102000
*       RETNCODE=TWELVE;            /* RETURN CODE OF 12             */ 01103000
         MVC   RETNCODE(4),@CF00034                                0340 01104000
*     END;                                                         0341 01105000
*   END ALLOCSO;                                                   0342 01106000
@EL00004 DS    0H                                                  0342 01107000
@EF00004 DS    0H                                                  0342 01108000
@ER00004 LM    @14,@12,@SA00004                                    0342 01109000
         BR    @14                                                 0342 01110000
*                                                                  0343 01111000
*/********************************************************************/ 01112000
*/*                                                                  */ 01113000
*/*    DETERMINE WHERE TO BEGIN PRINTING BASED ON WHETHER 'HERE',    */ 01114000
*/*      'BEGIN', OR 'NEXT' WAS ON THE COMMAND AND WHETHER THE       */ 01115000
*/*      SYSOUT DATA SET HAS BEEN PREVIOUSLY CHECKPOINTED.           */ 01116000
*/*    IF THE SYSOUT DATA SET IS NOT TO BE SKIPPED, INITIALIZE THE   */ 01117000
*/*      RPL/ACB CONTROL BLOCKS AND OPEN THE SYSOUT DATA SET.        */ 01118000
*/*    READ AND WRITE THE SYSOUT DATA SET UNTIL:                     */ 01119000
*/*      ATTENTION AND 'CONTINUE NEXT' SUBCOMMAND ENTERED            */ 01120000
*/*      ATTENTION AND 'END' SUBCOMMAND ENTERED                      */ 01121000
*/*      END OF DATA AND NOPAUSE WAS SPECIFIED                       */ 01122000
*/*      END OF DATA,PAUSE SPECIFIED, AND 'CONTINUE HERE' SUBCOMMAND */ 01123000
*/*      END OF DATA,PAUSE SPECIFIED, AND 'CONTINUE NEXT' SUBCOMMAND */ 01124000
*/*      END OF DATA,PAUSE SPECIFIED, AND 'END' SUBCOMMAND           */ 01125000
*/*      ERROR OCCURS                                                */ 01126000
*/*    IF EOD/PAUSE OR ATTENTION OCCURS, CALL IKJCT463 TO PROCESS    */ 01127000
*/*      SUBCOMMANDS.                                                */ 01128000
*/*    WHEN DONE WITH THE SYSOUT DATASET, CLOSE IT.                  */ 01129000
*/*                                                                  */ 01130000
*/********************************************************************/ 01131000
*                                                                  0343 01132000
*PRINTRTN:                                                         0343 01133000
*   PROC;                           /* INTERNAL PROCEDURE TO READ AND   01134000
*                                      WRITE SYSOUT RCDS             */ 01135000
PRINTRTN STM   @14,@12,@SA00005                                    0343 01136000
*   CALL STARTPT;                   /* CALL RTN TO DECIDE WHERE TO 0344 01137000
*                                      BEGIN PRINTING SYSOUT DS      */ 01138000
         BAL   @14,STARTPT                                         0344 01139000
*   IF SKIPDS=NO THEN               /* SYSOUT DS NOT TO BE SKIPPED   */ 01140000
         TM    SKIPDS,B'10000000'                                  0345 01141000
         BNZ   @RF00345                                            0345 01142000
*     DO;                                                          0346 01143000
*       CALL OPENSYSO;              /* CALL RTN TO INIT RPL & ACB, 0347 01144000
*                                      OPEN DS AND GET INPUT BUFFERS */ 01145000
         BAL   @14,OPENSYSO                                        0347 01146000
*       DO WHILE ERROR=NO&SKIPGET=NO&ENDSW=NO;/* THIS LOOP GETS AND     01147000
*                                      PUTS SYSOUT RCDS UNTIL ERROR     01148000
*                                      OR FINISHED WITH THIS DATASET:   01149000
*                                      ATTN/CONT NEXT EOD-NOPAUSE  0348 01150000
*                                      EOD-PAUSE/CONT HERE         0348 01151000
*                                      EOD-PAUSE/CONT NEXT           */ 01152000
         B     @DE00348                                            0348 01153000
@DL00348 DS    0H                                                  0349 01154000
*         CALL IKJCT470(OPTR);      /* GO GET A RECORD               */ 01155000
         L     @14,@PC00001                                        0349 01156000
         ST    @14,@AL00001                                        0349 01157000
         L     @15,@CV01407                                        0349 01158000
         LA    @01,@AL00001                                        0349 01159000
         BALR  @14,@15                                             0349 01160000
*         IF POSTED=YES THEN        /* ATTN INTERRUPT OCCURRED       */ 01161000
         TM    POSTED(OCMTBPTR),B'01000000'                        0350 01162000
         BNO   @RF00350                                            0350 01163000
*           CALL ATTNRTN;           /* HANDLE SUBCOMMANDS            */ 01164000
         BAL   @14,ATTNRTN                                         0351 01165000
*         ELSE                      /* CHECK FURTHER                 */ 01166000
*           IF EODSW=YES THEN       /* EOD REACHED ON SYSOUT         */ 01167000
         B     @RC00350                                            0352 01168000
@RF00350 TM    EODSW(OCMTBPTR),B'00010000'                         0352 01169000
         BNO   @RF00352                                            0352 01170000
*             DO;                                                  0353 01171000
*               IF TERM=YES THEN    /* PRINTING TO A TERMINAL        */ 01172000
         TM    TERM(OCMTBPTR),B'00001000'                          0354 01173000
         BNO   @RF00354                                            0354 01174000
*                 CALL IKJCT471(OPTR);/* CALL '71 TO PUT A BLANK   0355 01175000
*                                      SEPARATOR AFTER THIS DS       */ 01176000
         L     @14,@PC00001                                        0355 01177000
         ST    @14,@AL00001                                        0355 01178000
         L     @15,@CV01408                                        0355 01179000
         LA    @01,@AL00001                                        0355 01180000
         BALR  @14,@15                                             0355 01181000
*               CALL EODRTN;        /* GO HANDLE END OF DATA         */ 01182000
@RF00354 BAL   @14,EODRTN                                          0356 01183000
*             END;                                                 0357 01184000
*           ELSE                    /* ELSE GOT A RCD OR AN ERROR. IF   01185000
*                                      ERROR, SWITCH ALREADY SET TO     01186000
*                                      STOP FURTHER PROCESSING. IF 0358 01187000
*                                      SUCCESSFUL RETRIEVE OF RCD, 0358 01188000
*                                      CONTINUE WITH PUT.            */ 01189000
*             IF ERROR=YES THEN     /* ERROR DETECTED DURING GET     */ 01190000
         B     @RC00352                                            0358 01191000
@RF00352 TM    ERROR(OCMTBPTR),B'00001000'                         0358 01192000
         BNO   @RF00358                                            0358 01193000
*               DO;                                                0359 01194000
*                 SSSOCHKP=YES;     /* TELL SUBSYS TO CHECKPOINT     */ 01195000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0360 01196000
         OI    SSSOCHKP(@14),B'01000000'                           0360 01197000
*                 SSSORBA=OUTHOLD;  /* CKPT RBA CORRESPONDS TO LAST     01198000
*                                      RCD PUT. ANY RCDS STACKED IN     01199000
*                                      BUF WILL BE PUT AT CLOSE.     */ 01200000
         MVC   SSSORBA(8,@14),OUTHOLD(OCMTBPTR)                    0361 01201000
*               END;                                               0362 01202000
*             ELSE                  /* SUCCESSFUL GET                */ 01203000
*               DO;                                                0363 01204000
         B     @RC00358                                            0363 01205000
@RF00358 DS    0H                                                  0364 01206000
*                 CALL IKJCT471(OPTR);/* GO 'PUT' THE RECORD         */ 01207000
         L     @14,@PC00001                                        0364 01208000
         ST    @14,@AL00001                                        0364 01209000
         L     @15,@CV01408                                        0364 01210000
         LA    @01,@AL00001                                        0364 01211000
         BALR  @14,@15                                             0364 01212000
*                 IF SYNADERR=YES THEN/* ERROR WHILE PUT OF RCD      */ 01213000
         TM    SYNADERR(OCMTBPTR),B'10000000'                      0365 01214000
         BNO   @RF00365                                            0365 01215000
*                   DO;                                            0366 01216000
*                     RETNCODE=TWELVE;/* SET RETURN CODE FOR '69     */ 01217000
         MVC   RETNCODE(4),@CF00034                                0367 01218000
*                     ERROR=YES;    /* INDICATE TERMINATING ERR      */ 01219000
         OI    ERROR(OCMTBPTR),B'00001000'                         0368 01220000
*                     SSSOCHKP=YES; /* TELL SUBSYS TO CKPT           */ 01221000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0369 01222000
         OI    SSSOCHKP(@14),B'01000000'                           0369 01223000
*                     SSSORBA=OUTBKAPX;/* CKPT 10 PUT RCDS BACK SINCE   01224000
*                                      LAST BUFFER WAS NOT WRITTEN 0370 01225000
*                                      OUT                           */ 01226000
         MVC   SSSORBA(8,@14),OUTBKAPX(OCMTBPTR)                   0370 01227000
*                   END;                                           0371 01228000
*               END;                                               0372 01229000
@RF00365 DS    0H                                                  0373 01230000
*       END;                        /* END OF GET-PUT DO WHILE       */ 01231000
@RC00358 DS    0H                                                  0373 01232000
@RC00352 DS    0H                                                  0373 01233000
@RC00350 DS    0H                                                  0373 01234000
@DE00348 TM    ERROR(OCMTBPTR),B'00001000'                         0373 01235000
         BNZ   @DC00348                                            0373 01236000
         TM    SKIPGET,B'10000000'                                 0373 01237000
         BNZ   @DC00348                                            0373 01238000
         TM    ENDSW(OCMTBPTR),B'00010000'                         0373 01239000
         BZ    @DL00348                                            0373 01240000
@DC00348 DS    0H                                                  0374 01241000
*       SKIPGET=OFF;                /* TURN OFF SKIPGET SWITCH       */ 01242000
         NI    SKIPGET,B'01111111'                                 0374 01243000
*       CALL CLSSYSO;               /* DONE WITH THIS DATASET. GO  0375 01244000
*                                      FREE BUFS AND CLOSE IT.       */ 01245000
         BAL   @14,CLSSYSO                                         0375 01246000
*     END;                          /* END OPEN/PRINT/CLOSE GROUP    */ 01247000
*   ELSE                            /* ELSE SKIP PRINTING THIS DS    */ 01248000
*     SKIPDS=OFF;                   /* TURN OFF SKIPDS SWITCH        */ 01249000
         B     @RC00345                                            0377 01250000
@RF00345 NI    SKIPDS,B'01111111'                                  0377 01251000
*                                                                  0378 01252000
*/********************************************************************/ 01253000
*/*                                                                  */ 01254000
*/*  IF SYSOUT DATASET NEVER CHECKPOINTED, HERE/BEGIN/NEXT ALL START */ 01255000
*/*     PRINTING AT THE BEGINNING.                                   */ 01256000
*/*  IF SYSOUT DATASET WAS PREVIOUSLY INTERRUPTED (CHECKPOINTED),    */ 01257000
*/*     HERE/BEGIN/NEXT CONTROL THE POINT WHERE PRINTING STARTS.     */ 01258000
*/*             BEGIN - START AT THE BEGINNING AND IGNORE CHECKPOINT */ 01259000
*/*             HERE  - START AT THE CHECKPOINT                      */ 01260000
*/*             NEXT  - SKIP THIS DATASET                            */ 01261000
*/*  AN EXCEPTION TO THE ABOVE RULES FOR INTERRUPTED DATASETS IS     */ 01262000
*/*     THE CASE WHERE 'CONTINUE HERE' WAS ENTERED AFTER A PAUSE.    */ 01263000
*/*     WHEN THE NEXT DATASET IS ACCESSED, PRINTING SHOULD START     */ 01264000
*/*     FROM THE BEGINNING.  IF A CHECKPOINT EXISTS IT IS IGNORED.   */ 01265000
*/********************************************************************/ 01266000
*                                                                  0378 01267000
*STARTPT:                                                          0378 01268000
*   PROC;                           /* INTERNAL PROCEDURE TO DECIDE     01269000
*                                      WHERE TO START PRINT          */ 01270000
         B     @PB00006                                            0378 01271000
STARTPT  STM   @14,@12,@SA00006                                    0378 01272000
*/********************************************************************/ 01273000
*/* INITIALIZE THE FIELDS USED IN CALCULATING SEVERAL RECORDS BACK   */ 01274000
*/* WHEN ATTENTION OCCURS. IF THIS SYSOUT DATA SET WAS NEVER         */ 01275000
*/* INTERRUPTED, PROCESSING STARTS AT BEGINNING.                     */ 01276000
*/********************************************************************/ 01277000
*                                                                  0379 01278000
*   OUTHOLD=ZEROS;                  /* INIT CURRENT RBA FIELD        */ 01279000
         MVC   OUTHOLD(8,OCMTBPTR),@CB01394                        0379 01280000
*   OUTBKAPX=ZEROS;                 /* INIT APPROX RBA FOR BACKUP    */ 01281000
         MVC   OUTBKAPX(8,OCMTBPTR),@CB01394                       0380 01282000
*   OUTBKNEW=ZEROS;                 /* INIT TEMP. APPROX RBA FOR   0381 01283000
*                                      BACKUP                        */ 01284000
         MVC   OUTBKNEW(8,OCMTBPTR),@CB01394                       0381 01285000
*   OUTBKCNT=ZERO;                  /* ZERO COUNT FIELD              */ 01286000
         SLR   @14,@14                                             0382 01287000
         ST    @14,OUTBKCNT(,OCMTBPTR)                             0382 01288000
*   POINT=YES;                      /* TELL IKJCT470 TO POINT        */ 01289000
         OI    POINT(OCMTBPTR),B'10000000'                         0383 01290000
*   IF SSSORBA^=ZEROS THEN          /* SYSOUT WAS PREVIOUSLY       0384 01291000
*                                      INTERRUPTED (CHECKPOINTED). 0384 01292000
*                                      CHECK FOR FURTHER INDICATION     01293000
*                                      OF WHERE TO START PRINTING    */ 01294000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0384 01295000
         CLC   SSSORBA(8,@14),@CB01394                             0384 01296000
         BE    @RF00384                                            0384 01297000
*     IF SUBHERE=ON|BEGIN=YES THEN  /* EITHER THIS DS NEXT TO BE   0385 01298000
*                                      ACCESSED AFTER 'PAUSE-CONT  0385 01299000
*                                      HERE' OR BEGIN SPECIFIED ON 0385 01300000
*                                      COMMAND. SO IGNORE CHECKPOINT    01301000
*                                      AND START AT BEGINNING.       */ 01302000
         TM    SUBHERE(OCMTBPTR),B'00010000'                       0385 01303000
         BO    @RT00385                                            0385 01304000
         TM    BEGIN(OCMTBPTR),B'00010000'                         0385 01305000
         BNO   @RF00385                                            0385 01306000
@RT00385 DS    0H                                                  0386 01307000
*       SUBHERE=OFF;                /* TURN OFF SUBHERE SWITCH       */ 01308000
         NI    SUBHERE(OCMTBPTR),B'11101111'                       0386 01309000
*     ELSE                          /* PRINT CKPTED SYSOUT ON BASIS     01310000
*                                      OF HERE OR NEXT               */ 01311000
*       IF HERE=YES THEN            /* PRINT FROM LAST POINT OF    0387 01312000
*                                      INTERRUPTION                  */ 01313000
         B     @RC00385                                            0387 01314000
@RF00385 TM    HERE(OCMTBPTR),B'00100000'                          0387 01315000
         BNO   @RF00387                                            0387 01316000
*         DO;                                                      0388 01317000
*           OUTHOLD=SSSORBA;        /* START READING AT CKPT         */ 01318000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0389 01319000
         MVC   OUTHOLD(8,OCMTBPTR),SSSORBA(@14)                    0389 01320000
*           OUTBKAPX=OUTHOLD;       /* SET FOR IKJCT471              */ 01321000
         MVC   OUTBKAPX(8,OCMTBPTR),OUTHOLD(OCMTBPTR)              0390 01322000
*           OUTBKNEW=OUTHOLD;       /* SET FOR IKJCT471              */ 01323000
         MVC   OUTBKNEW(8,OCMTBPTR),OUTHOLD(OCMTBPTR)              0391 01324000
*           INTRPMSG=YES;           /* SO IKJCT471 WILL ISSUE MSG    */ 01325000
         OI    INTRPMSG(OCMTBPTR),B'00000010'                      0392 01326000
*         END;                                                     0393 01327000
*       ELSE                        /* ELSE NEXT GIVEN ON COMMAND. 0394 01328000
*                                      SKIP THIS DATASET             */ 01329000
*         DO;                                                      0394 01330000
         B     @RC00387                                            0394 01331000
@RF00387 DS    0H                                                  0395 01332000
*           SKIPDS=YES;             /* SKIP THIS CKPT DATASET        */ 01333000
         OI    SKIPDS,B'10000000'                                  0395 01334000
*           OUTMSGID=132;           /* ISSUE MSG 344I                */ 01335000
         MVI   OUTMSGID(OCMTBPTR),X'84'                            0396 01336000
*           CALL IKJCT467(OUTCOMTB);/* CALL MESSAGE HANDLER          */ 01337000
         ST    OCMTBPTR,@AL00001                                   0397 01338000
         L     @15,@CV01406                                        0397 01339000
         LA    @01,@AL00001                                        0397 01340000
         BALR  @14,@15                                             0397 01341000
*           IF ERROR=YES THEN       /* ANY TERMINATING ERRORS FROM 0398 01342000
*                                      MESSAGE HANDLER               */ 01343000
         TM    ERROR(OCMTBPTR),B'00001000'                         0398 01344000
         BNO   @RF00398                                            0398 01345000
*             DO;                                                  0399 01346000
*               RETNCODE=TWELVE;    /* SET RETURN CODE 12            */ 01347000
         MVC   RETNCODE(4),@CF00034                                0400 01348000
*               ERROR=YES;          /* TURN ON QUIT SWITCH           */ 01349000
         OI    ERROR(OCMTBPTR),B'00001000'                         0401 01350000
*             END;                                                 0402 01351000
*           ELSE                                                   0403 01352000
*             ;                     /* NO ERRORS IN MSG HANDLER      */ 01353000
@RF00398 DS    0H                                                  0404 01354000
*         END;                                                     0404 01355000
*   ELSE                                                           0405 01356000
*     ;                             /* SYSOUT NEVER INTERRUPTED.   0405 01357000
*                                      START AT BEGINNING.           */ 01358000
@RF00384 DS    0H                                                  0406 01359000
*   END STARTPT;                    /* END OF RTN TO CALC START OF 0406 01360000
*                                      PRINTING                      */ 01361000
@EL00006 DS    0H                                                  0406 01362000
@EF00006 DS    0H                                                  0406 01363000
@ER00006 LM    @14,@12,@SA00006                                    0406 01364000
         BR    @14                                                 0406 01365000
*                                                                  0407 01366000
*/********************************************************************/ 01367000
*/*                                                                  */ 01368000
*/*   INITIALIZE THE RPL                                             */ 01369000
*/*   INITIALIZE THE ACB                                             */ 01370000
*/*   OPEN ACB                                                       */ 01371000
*/*   ANALYZE OPEN RETURN CODE AND TAKE APPROPRIATE ACTION           */ 01372000
*/*   GET CORE FOR INPUT BUFFERS                                     */ 01373000
*/*                                                                  */ 01374000
*/********************************************************************/ 01375000
*                                                                  0407 01376000
*OPENSYSO:                                                         0407 01377000
*   PROC;                           /* INTERNAL PROCEDURE TO OPEN A     01378000
*                                      SYSOUT DATA SET               */ 01379000
OPENSYSO STM   @14,@12,@SA00007                                    0407 01380000
*/********************************************************************/ 01381000
*/*   INITIALIZE THE RPL AND ASSOCIATED OUTCOMTB FIELDS              */ 01382000
*/********************************************************************/ 01383000
*                                                                  0408 01384000
*   OUTRPL=ADDR(RPLCORE);           /* POINTER TO RPL IN OUTCOMTB    */ 01385000
         LA    @14,RPLCORE                                         0408 01386000
         ST    @14,OUTRPL(,OCMTBPTR)                               0408 01387000
*   OUTRPLL=LENGTH(RPLCORE);        /* LENGTH OF RPL IN OUTCOMTB     */ 01388000
         LA    @05,76                                              0409 01389000
         ST    @05,OUTRPLL(,OCMTBPTR)                              0409 01390000
*   RFY                                                            0410 01391000
*     IFGRPL BASED(OUTRPL);         /* BASE RPL MAP ON RPLCORE       */ 01392000
*   IFGRPL=IFGRPL&&IFGRPL;          /* CLEAR THE RPL                 */ 01393000
         XC    IFGRPL(76,@14),IFGRPL(@14)                          0411 01394000
*   IFGRPL=INPRPL;                  /* MOVE THE INLINE EXPANDED RPL     01395000
*                                      TO DYNAMIC CORE               */ 01396000
         MVC   IFGRPL(76,@14),INPRPL                               0412 01397000
*   RPLDACB=ADDR(ACBCORE);          /* PUT ADDR OF DYNAMIC ACB IN RPL*/ 01398000
         LA    @02,ACBCORE                                         0413 01399000
         ST    @02,RPLDACB(,@14)                                   0413 01400000
*   RPLARG=ADDR(OUTHOLD);           /* ADDR SEARCH ARG FOR POINT     */ 01401000
         LA    @09,OUTHOLD(,OCMTBPTR)                              0414 01402000
         ST    @09,RPLARG(,@14)                                    0414 01403000
*/********************************************************************/ 01404000
*/*   INITIALIZE THE ACB AND ASSOCIATED OUTCOMTB FIELDS              */ 01405000
*/********************************************************************/ 01406000
*                                                                  0415 01407000
*   OUTACB=ADDR(ACBCORE);           /* POINTER TO ACB IN OUTCOMTB    */ 01408000
         ST    @02,OUTACB(,OCMTBPTR)                               0415 01409000
*   OUTACBL=LENGTH(ACBCORE);        /* LENGTH OF ACB IN OUTCOMTB     */ 01410000
         ST    @05,OUTACBL(,OCMTBPTR)                              0416 01411000
*   RFY                                                            0417 01412000
*     IFGACB BASED(OUTACB);         /* BASE ACB MAP ON ACB CORE      */ 01413000
*   IFGACB=IFGACB&&IFGACB;          /* CLEAR CORE FOR THE ACB        */ 01414000
         XC    IFGACB(76,@02),IFGACB(@02)                          0418 01415000
*   IFGACB=INPACB;                  /* MOVE ACB TO DYNAMIC CORE      */ 01416000
         MVC   IFGACB(76,@02),INPACB                               0419 01417000
*   ACBDDNM=OSYSODDN;               /* DDNAME IN ACB FROM TXT UNT    */ 01418000
         MVC   ACBDDNM(8,@02),OSYSODDN(OCMTBPTR)                   0420 01419000
*   ACBLENG=LENGTH(ACBCORE);        /* ACB LEN IN ACB FOR SUBSYS     */ 01420000
         STH   @05,ACBLENG(,@02)                                   0421 01421000
*/********************************************************************/ 01422000
*/*    OPEN THE ACB                                                  */ 01423000
*/********************************************************************/ 01424000
*                                                                  0422 01425000
*   OPENLSTA(1:LNGOLSTS)=OPENLSTS(1:LNGOLSTS);/* MOVE OPEN LIST TO 0422 01426000
*                                      DYN CORE                      */ 01427000
         L     @14,LNGOLSTS                                        0422 01428000
         BCTR  @14,0                                               0422 01429000
         EX    @14,@SM01592                                        0422 01430000
*   REG4=ADDR(ACBCORE);             /* ADDR OF ACB TO OPEN           */ 01431000
         LR    REG4,@02                                            0423 01432000
*   GEN(OPEN  ((4)),MF=(E,OPENLSTA));/* OPEN THE ACB                 */ 01433000
         OPEN  ((4)),MF=(E,OPENLSTA)                                    01434000
*   OUTRTCD=REG15;                                                 0425 01435000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0425 01436000
*   IF ACBOPEN=NO THEN              /* ACB DID NOT OPEN              */ 01437000
         L     @14,OUTACB(,OCMTBPTR)                               0426 01438000
         TM    ACBOPEN(@14),B'00010000'                            0426 01439000
         BNZ   @RF00426                                            0426 01440000
*     DO;                                                          0427 01441000
*       ERROR=YES;                  /* INDICATE TERMINATING ERR      */ 01442000
         OI    ERROR(OCMTBPTR),B'00001000'                         0428 01443000
*       OUTMSGID=52;                /* ISSUE MSG VIA VSMFAIL         */ 01444000
         MVI   OUTMSGID(OCMTBPTR),X'34'                            0429 01445000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MSG HANDLER              */ 01446000
         ST    OCMTBPTR,@AL00001                                   0430 01447000
         L     @15,@CV01406                                        0430 01448000
         LA    @01,@AL00001                                        0430 01449000
         BALR  @14,@15                                             0430 01450000
*       RETNCODE=TWELVE;            /* SET ERROR RETURN CODE         */ 01451000
         MVC   RETNCODE(4),@CF00034                                0431 01452000
*     END;                                                         0432 01453000
*   ELSE                            /* ACB OPENED SUCCESSFULLY       */ 01454000
*/********************************************************************/ 01455000
*/*      GET CORE FOR INPUT BUFFERS AND SAVE INFO.                   */ 01456000
*/********************************************************************/ 01457000
*                                                                  0433 01458000
*     DO;                                                          0433 01459000
         B     @RC00426                                            0433 01460000
@RF00426 DS    0H                                                  0434 01461000
*       OPENED=YES;                 /* INDICATE SYSOUT IS OPENED     */ 01462000
         OI    OPENED(OCMTBPTR),B'01000000'                        0434 01463000
*       RPLBUFL=ACBLRECL;           /* INPUT BUFFER LEN- MAX SYSOUT     01464000
*                                      RCD                           */ 01465000
         L     @14,OUTRPL(,OCMTBPTR)                               0435 01466000
         L     @05,OUTACB(,OCMTBPTR)                               0435 01467000
         LH    @05,ACBLRECL(,@05)                                  0435 01468000
         ST    @05,RPLBUFL(,@14)                                   0435 01469000
*       REG4=ACBLRECL;              /* RCD LEN FOR GETMAIN BUF       */ 01470000
         LR    REG4,@05                                            0436 01471000
*       GEN(GETMAIN R,LV=(4),SP=1);                                0437 01472000
         GETMAIN R,LV=(4),SP=1                                          01473000
*       RPLAREA=REG1;               /* ADDR OF 'INPUT' BUF           */ 01474000
         L     @14,OUTRPL(,OCMTBPTR)                               0438 01475000
         ST    REG1,RPLAREA(,@14)                                  0438 01476000
*       FREEBUF=YES;                /* FREEMAIN BEFORE END           */ 01477000
         OI    FREEBUF,B'10000000'                                 0439 01478000
*     END;                                                         0440 01479000
*   END OPENSYSO;                   /* END OF OPEN SYSOUT RTN        */ 01480000
@EL00007 DS    0H                                                  0441 01481000
@EF00007 DS    0H                                                  0441 01482000
@ER00007 LM    @14,@12,@SA00007                                    0441 01483000
         BR    @14                                                 0441 01484000
*                                                                  0442 01485000
*/********************************************************************/ 01486000
*/*                                                                  */ 01487000
*/*       ATTENTION ROUTINE                                          */ 01488000
*/*                                                                  */ 01489000
*/********************************************************************/ 01490000
*                                                                  0442 01491000
*ATTNRTN:                                                          0442 01492000
*   PROC;                           /* INTERNAL TO PRINTRTN - HANDLE    01493000
*                                      ATTENTION INTERRUPTS          */ 01494000
ATTNRTN  STM   @14,@12,@SA00008                                    0442 01495000
*   EODSW=OFF;                      /* IN CASE EOD, IGNORE           */ 01496000
         NI    EODSW(OCMTBPTR),B'11101111'                         0443 01497000
*   CALL TCLRQSTK;                  /* CALL RTN TO CLEARQ AND RESET     01498000
*                                      THE STACK                     */ 01499000
*                                                                  0444 01500000
         BAL   @14,TCLRQSTK                                        0444 01501000
*   /*****************************************************************/ 01502000
*   /*                                                               */ 01503000
*   /* INVOKE IKJCT463 TO PROCESS THE SUBCMD. ANALYZE THE RESULTS.   */ 01504000
*   /*                                                               */ 01505000
*   /*****************************************************************/ 01506000
*                                                                  0445 01507000
*   CALL IKJCT463(OPTR);            /* GO PROCESS SUBCOMMAND ENTERED    01508000
*                                      AFTER ATTN HIT                */ 01509000
         L     @14,@PC00001                                        0445 01510000
         ST    @14,@AL00001                                        0445 01511000
         L     @15,@CV01405                                        0445 01512000
         LA    @01,@AL00001                                        0445 01513000
         BALR  @14,@15                                             0445 01514000
*   IF ERROR=YES THEN               /* IF IKJCT463 FAILED            */ 01515000
*                                                                  0446 01516000
         TM    ERROR(OCMTBPTR),B'00001000'                         0446 01517000
         BNO   @RF00446                                            0446 01518000
*     /***************************************************************/ 01519000
*     /*                                                             */ 01520000
*     /* ERROR OCCURRED                                              */ 01521000
*     /*                                                             */ 01522000
*     /***************************************************************/ 01523000
*                                                                  0447 01524000
*     DO;                                                          0447 01525000
*       SSSOCHKP=YES;               /* TELL SUBSYS TO CHECKPOINT   0448 01526000
*                                      INTERRUPTED SYSOUT DS         */ 01527000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0448 01528000
         OI    SSSOCHKP(@14),B'01000000'                           0448 01529000
*       IF TERM=YES THEN            /* PRINT TO A TERMINAL, THERE- 0449 01530000
*                                      FORE TCAM BUFFERS WERE LOST 0449 01531000
*                                      AFTER ATTENTION.              */ 01532000
         TM    TERM(OCMTBPTR),B'00001000'                          0449 01533000
         BNO   @RF00449                                            0449 01534000
*         SSSORBA=OUTBKAPX;         /* GIVE SUBSYS THE CKPT RBA    0450 01535000
*                                      CORRESPONDING TO APPROX 10 PUT   01536000
*                                      LINES BACK.                   */ 01537000
         MVC   SSSORBA(8,@14),OUTBKAPX(OCMTBPTR)                   0450 01538000
*       ELSE                        /* PRINT TO A DATASET, BUFS NOT     01539000
*                                      LOST. RCDS REMAINING IN PUT 0451 01540000
*                                      BUFS ARE WRITTEN DURING CLOSE,   01541000
*                                      SO DON'T BACK UP.             */ 01542000
*         SSSORBA=OUTHOLD;          /* USE CURRENT RBA IN OUTHOLD    */ 01543000
         B     @RC00449                                            0451 01544000
@RF00449 L     @14,OUTSOBSO(,OCMTBPTR)                             0451 01545000
         MVC   SSSORBA(8,@14),OUTHOLD(OCMTBPTR)                    0451 01546000
*     END;                                                         0452 01547000
*   ELSE                            /* NO ERROR, SEE WHAT SUBCMD     */ 01548000
*     IF SUBCONT=YES&SUBBEGN=YES THEN/* IF CONTINUE BEGIN SUBCMD     */ 01549000
*                                                                  0453 01550000
         B     @RC00446                                            0453 01551000
@RF00446 TM    SUBCONT(OCMTBPTR),B'00101000'                       0453 01552000
         BNO   @RF00453                                            0453 01553000
*       /*************************************************************/ 01554000
*       /*                                                           */ 01555000
*       /* 'CONTINUE BEGIN' SUBCMD ENTERED                           */ 01556000
*       /*                                                           */ 01557000
*       /*************************************************************/ 01558000
*                                                                  0454 01559000
*       DO;                                                        0454 01560000
*         SUBCONT=OFF;              /* TURN OFF SUBCONT INDICATOR    */ 01561000
*         SUBBEGN=OFF;              /* TURN OFF SUBBEGN INDICATOR    */ 01562000
         NI    SUBCONT(OCMTBPTR),B'11010111'                       0456 01563000
*         POINT=YES;                /* TELL '70 TO POINT             */ 01564000
         OI    POINT(OCMTBPTR),B'10000000'                         0457 01565000
*         OUTHOLD=ZEROS;            /* SET POINT ARG FOR '70         */ 01566000
         MVC   OUTHOLD(8,OCMTBPTR),@CB01394                        0458 01567000
*         OUTBKAPX=ZEROS;           /* APPROX CTRS AT 1ST RCD AGAIN  */ 01568000
         MVC   OUTBKAPX(8,OCMTBPTR),@CB01394                       0459 01569000
*         OUTBKNEW=ZEROS;           /* APPROX CTRS AT 1ST RCD AGAIN  */ 01570000
         MVC   OUTBKNEW(8,OCMTBPTR),@CB01394                       0460 01571000
*         OUTBKCNT=ZERO;            /* START '71 COUNTING AGAIN      */ 01572000
         SLR   @14,@14                                             0461 01573000
         ST    @14,OUTBKCNT(,OCMTBPTR)                             0461 01574000
*       END;                                                       0462 01575000
*     ELSE                          /* CHECK FURTHER                 */ 01576000
*       IF SUBCONT=YES&SUBHERE=YES THEN/* IF CONTINUE HERE SUBCMD    */ 01577000
*                                                                  0463 01578000
         B     @RC00453                                            0463 01579000
@RF00453 TM    SUBCONT(OCMTBPTR),B'00110000'                       0463 01580000
         BNO   @RF00463                                            0463 01581000
*         /***********************************************************/ 01582000
*         /*                                                         */ 01583000
*         /* 'CONTINUE HERE' SUBCMD ENTERED                          */ 01584000
*         /*                                                         */ 01585000
*         /***********************************************************/ 01586000
*                                                                  0464 01587000
*         DO;                                                      0464 01588000
*           SUBCONT=OFF;            /* TURN OFF SUBCONT INDICATOR    */ 01589000
*           SUBHERE=OFF;            /* TURN OFF SUBHERE INDICATOR    */ 01590000
         NI    SUBCONT(OCMTBPTR),B'11001111'                       0466 01591000
*           INTRPMSG=YES;           /* TELL IKJCT471 TO ISSUE MSG    */ 01592000
*           POINT=YES;              /* TELL '70 TO POINT             */ 01593000
         OI    INTRPMSG(OCMTBPTR),B'10000010'                      0468 01594000
*           OUTBKCNT=ZERO;          /* START '71 COUNTING AGAIN      */ 01595000
         SLR   @14,@14                                             0469 01596000
         ST    @14,OUTBKCNT(,OCMTBPTR)                             0469 01597000
*           IF TERM=YES THEN        /* PRINTING TO A TERMINAL, BACK     01598000
*                                      UP SO RCDS NOT LOST           */ 01599000
         TM    TERM(OCMTBPTR),B'00001000'                          0470 01600000
         BNO   @RF00470                                            0470 01601000
*             DO;                                                  0471 01602000
*               OUTHOLD=OUTBKAPX;   /* SET POINT ARG FOR '70         */ 01603000
         MVC   OUTHOLD(8,OCMTBPTR),OUTBKAPX(OCMTBPTR)              0472 01604000
*               OUTBKNEW=OUTBKAPX;  /* APPROX CTRS AT INTRP POINT    */ 01605000
         MVC   OUTBKNEW(8,OCMTBPTR),OUTBKAPX(OCMTBPTR)             0473 01606000
*             END;                                                 0474 01607000
*           ELSE                                                   0475 01608000
*             ;                     /* PRINT TO DS - POINT TO CURRENT   01609000
*                                      OUTHOLD RCD. REREAD LAST RCD     01610000
*                                      WHICH WAS NEVER PUT           */ 01611000
@RF00470 DS    0H                                                  0476 01612000
*         END;                                                     0476 01613000
*       ELSE                        /* CHECK FURTHER                 */ 01614000
*         IF SUBCONT=YES&SUBNEXT=YES THEN/* CONT NEXT SUBCMD         */ 01615000
*                                                                  0477 01616000
         B     @RC00463                                            0477 01617000
@RF00463 TM    SUBCONT(OCMTBPTR),B'00100100'                       0477 01618000
         BNO   @RF00477                                            0477 01619000
*           /*********************************************************/ 01620000
*           /*                                                       */ 01621000
*           /* 'CONTINUE NEXT' SUBCMD ENTERED                        */ 01622000
*           /*                                                       */ 01623000
*           /*********************************************************/ 01624000
*                                                                  0478 01625000
*           DO;                     /* IF CONTINUE NEXT SUBCMD       */ 01626000
*             SKIPGET=YES;          /* SKIP FURTHER GETS FROM DS     */ 01627000
         OI    SKIPGET,B'10000000'                                 0479 01628000
*             SUBCONT=OFF;          /* TURN OFF SUBCONT INDICATOR    */ 01629000
*             SUBNEXT=OFF;          /* TURN OFF SUBNEXT INDICATOR    */ 01630000
         NI    SUBCONT(OCMTBPTR),B'11011011'                       0481 01631000
*             IF KEEP=YES THEN      /* IF KEEP REQUESTED             */ 01632000
         TM    KEEP(OCMTBPTR),B'10000000'                          0482 01633000
         BNO   @RF00482                                            0482 01634000
*               DO;                                                0483 01635000
*                 SSSOCHKP=YES;     /* TELL SUBSYS TO CKPT SYSOUT    */ 01636000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0484 01637000
         OI    SSSOCHKP(@14),B'01000000'                           0484 01638000
*                 IF TERM=YES THEN  /* PRINTING TO A TERMINAL        */ 01639000
         TM    TERM(OCMTBPTR),B'00001000'                          0485 01640000
         BNO   @RF00485                                            0485 01641000
*                   SSSORBA=OUTBKAPX;/* GIVE SUSBYS THE CKPT RBA   0486 01642000
*                                      CORRESPONDING TO APPROX 10 PUT   01643000
*                                      LINES BACK.                   */ 01644000
         MVC   SSSORBA(8,@14),OUTBKAPX(OCMTBPTR)                   0486 01645000
*                 ELSE              /* PRINTING TO A DATASET         */ 01646000
*                   SSSORBA=OUTHOLD;                               0487 01647000
         B     @RC00485                                            0487 01648000
@RF00485 L     @14,OUTSOBSO(,OCMTBPTR)                             0487 01649000
         MVC   SSSORBA(8,@14),OUTHOLD(OCMTBPTR)                    0487 01650000
*               END;                                               0488 01651000
*             ELSE                                                 0489 01652000
*               ;                   /* DS TO BE DELETED, SO DON'T  0489 01653000
*                                      NEED TO CKPT                  */ 01654000
@RF00482 DS    0H                                                  0490 01655000
*           END;                                                   0490 01656000
*         ELSE                      /* CHECK FURTHER                 */ 01657000
*           IF ENDSW=YES THEN       /* IF END SUBCMD                 */ 01658000
*                                                                  0491 01659000
         B     @RC00477                                            0491 01660000
@RF00477 TM    ENDSW(OCMTBPTR),B'00010000'                         0491 01661000
         BNO   @RF00491                                            0491 01662000
*             /*******************************************************/ 01663000
*             /*                                                     */ 01664000
*             /* 'END' SUBCMD ENTERED                                */ 01665000
*             /*                                                     */ 01666000
*             /*******************************************************/ 01667000
*                                                                  0492 01668000
*             DO;                                                  0492 01669000
*               ENDKEEP=YES;        /* OVERRIDE ANY 'NOKEEP' STATUS     01670000
*                                      SINCE PROCESSING WAS        0493 01671000
*                                      INTERRUPTED                   */ 01672000
         OI    ENDKEEP(OCMTBPTR),B'00000100'                       0493 01673000
*               SSSOCHKP=YES;       /* TELL SUBSYS TO CKPT SYSOUT    */ 01674000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0494 01675000
         OI    SSSOCHKP(@14),B'01000000'                           0494 01676000
*               IF TERM=YES THEN    /* PRINT TO A TERMINAL, THERE- 0495 01677000
*                                      FORE TCAM BUFS LOST AFTER   0495 01678000
*                                      ATTENTION.                    */ 01679000
         TM    TERM(OCMTBPTR),B'00001000'                          0495 01680000
         BNO   @RF00495                                            0495 01681000
*                 SSSORBA=OUTBKAPX; /* GIVE SUBSYS THE CKPT RBA    0496 01682000
*                                      CORRESPONDING TO APPROX 10  0496 01683000
*                                      LINES BACK.                   */ 01684000
         MVC   SSSORBA(8,@14),OUTBKAPX(OCMTBPTR)                   0496 01685000
*               ELSE                /* PRINT TO A DS. REST OF RCDS 0497 01686000
*                                      WRITTEN DURING CLOSE SO NEED     01687000
*                                      NOT BACK UP.                  */ 01688000
*                 SSSORBA=OUTHOLD;  /* USE CURRENT RBA IN OUTHOLD    */ 01689000
         B     @RC00495                                            0497 01690000
@RF00495 L     @14,OUTSOBSO(,OCMTBPTR)                             0497 01691000
         MVC   SSSORBA(8,@14),OUTHOLD(OCMTBPTR)                    0497 01692000
*             END;                                                 0498 01693000
*           ELSE                                                   0499 01694000
*             ;                     /* NO OTHER VALID SUBCMDS        */ 01695000
@RF00491 DS    0H                                                  0500 01696000
*   END ATTNRTN;                    /* END RTN TO HANDLE ATTN        */ 01697000
@EL00008 DS    0H                                                  0500 01698000
@EF00008 DS    0H                                                  0500 01699000
@ER00008 LM    @14,@12,@SA00008                                    0500 01700000
         BR    @14                                                 0500 01701000
*                                                                  0501 01702000
*/********************************************************************/ 01703000
*/*                                                                  */ 01704000
*/*        END OF DATA ROUTINE                                       */ 01705000
*/*                                                                  */ 01706000
*/********************************************************************/ 01707000
*                                                                  0501 01708000
*EODRTN:                                                           0501 01709000
*   PROC;                           /* INTERNAL TO PRINTRTN - HANDLE    01710000
*                                      END OF DATA                   */ 01711000
EODRTN   STM   @14,@12,@SA00009                                    0501 01712000
*   EODSW=OFF;                      /* TURN OFF EOD INDICATOR        */ 01713000
         NI    EODSW(OCMTBPTR),B'11101111'                         0502 01714000
*   IF PAUSE=NO THEN                /* DONT PAUSE FOR SUBCMDS        */ 01715000
         TM    PAUSE(OCMTBPTR),B'10000000'                         0503 01716000
         BNZ   @RF00503                                            0503 01717000
*     SKIPGET=YES;                  /* SKIP NEXT GET FROM THIS DS    */ 01718000
         OI    SKIPGET,B'10000000'                                 0504 01719000
*   ELSE                            /* PAUSE FOR SUBCMDS             */ 01720000
*     DO;                                                          0505 01721000
         B     @RC00503                                            0505 01722000
@RF00503 DS    0H                                                  0506 01723000
*       OUTMSGID=0;                 /* INDICATE MODE MSG NEEDED      */ 01724000
         MVI   OUTMSGID(OCMTBPTR),X'00'                            0506 01725000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MESSAGE HANDLER TO     0507 01726000
*                                      RETRIEVE A SUBCMD             */ 01727000
         ST    OCMTBPTR,@AL00001                                   0507 01728000
         L     @15,@CV01406                                        0507 01729000
         LA    @01,@AL00001                                        0507 01730000
         BALR  @14,@15                                             0507 01731000
*       IF ERROR=NO THEN            /* IF SUBCMD RETRIEVED           */ 01732000
         TM    ERROR(OCMTBPTR),B'00001000'                         0508 01733000
         BNZ   @RF00508                                            0508 01734000
*         DO;                                                      0509 01735000
*           IF POSTED=YES THEN      /* IKJCT467 WAS INTERRUPTED BY 0510 01736000
*                                      ATTENTION                     */ 01737000
         TM    POSTED(OCMTBPTR),B'01000000'                        0510 01738000
         BNO   @RF00510                                            0510 01739000
*             CALL TCLRQSTK;        /* CALL RTN TO CLEAR Q AND RESET    01740000
*                                      THE STACK                     */ 01741000
         BAL   @14,TCLRQSTK                                        0511 01742000
*           ELSE                                                   0512 01743000
*             ;                                                    0512 01744000
@RF00510 DS    0H                                                  0513 01745000
*           CALL IKJCT463(OPTR);    /* CALL SUBCMD HANDLER           */ 01746000
         L     @14,@PC00001                                        0513 01747000
         ST    @14,@AL00001                                        0513 01748000
         L     @15,@CV01405                                        0513 01749000
         LA    @01,@AL00001                                        0513 01750000
         BALR  @14,@15                                             0513 01751000
*           IF ERROR=YES THEN       /* IF IKJCT463 FAILED            */ 01752000
         TM    ERROR(OCMTBPTR),B'00001000'                         0514 01753000
         BNO   @RF00514                                            0514 01754000
*             DO;                                                  0515 01755000
*               SSSOCHKP=NO;        /* DON'T TELL SUBSYS TO CKPT   0516 01756000
*                                      SYSOUT SINCE EOF REACHED      */ 01757000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0516 01758000
         NI    SSSOCHKP(@14),B'10111111'                           0516 01759000
*             END;                                                 0517 01760000
*           ELSE                    /* ELSE IKJCT463 SUCCESSFUL,   0518 01761000
*                                      DETERMINE WHICH SUBCMD        */ 01762000
*             IF SUBCONT=YES&SUBBEGN=YES THEN/* IF CONTINUE BEGIN  0518 01763000
*                                      SUBCMD                        */ 01764000
*                                                                  0518 01765000
         B     @RC00514                                            0518 01766000
@RF00514 TM    SUBCONT(OCMTBPTR),B'00101000'                       0518 01767000
         BNO   @RF00518                                            0518 01768000
*               /*****************************************************/ 01769000
*               /*                                                   */ 01770000
*               /* 'CONTINUE BEGIN' SUBCMD ENTERED                   */ 01771000
*               /*                                                   */ 01772000
*               /*****************************************************/ 01773000
*                                                                  0519 01774000
*               DO;                                                0519 01775000
*                 SUBCONT=OFF;      /* TURN OFF SUBCONT INDICATOR    */ 01776000
*                 SUBBEGN=OFF;      /* TURN OFF SUBBEGN INDICATOR    */ 01777000
         NI    SUBCONT(OCMTBPTR),B'11010111'                       0521 01778000
*                 POINT=YES;        /* TELL '70 TO POINT             */ 01779000
         OI    POINT(OCMTBPTR),B'10000000'                         0522 01780000
*                 OUTHOLD=ZEROS;    /* SET POINT ARG FOR '70         */ 01781000
         MVC   OUTHOLD(8,OCMTBPTR),@CB01394                        0523 01782000
*                 OUTBKAPX=ZEROS;   /* APPROX CTRS AT 1ST RCD AGAIN  */ 01783000
         MVC   OUTBKAPX(8,OCMTBPTR),@CB01394                       0524 01784000
*                 OUTBKNEW=ZEROS;   /* APPROX CTRS AT 1ST RCD AGAIN  */ 01785000
         MVC   OUTBKNEW(8,OCMTBPTR),@CB01394                       0525 01786000
*                 OUTBKCNT=ZERO;    /* START '71 COUNTING AGAIN      */ 01787000
         SLR   @14,@14                                             0526 01788000
         ST    @14,OUTBKCNT(,OCMTBPTR)                             0526 01789000
*               END;                                               0527 01790000
*             ELSE                  /* CHECK FURTHER                 */ 01791000
*               IF SUBCONT=YES&SUBHERE=YES THEN/* IF CONTINUE HERE 0528 01792000
*                                      SUBCMD                        */ 01793000
*                                                                  0528 01794000
         B     @RC00518                                            0528 01795000
@RF00518 TM    SUBCONT(OCMTBPTR),B'00110000'                       0528 01796000
         BNO   @RF00528                                            0528 01797000
*                 /***************************************************/ 01798000
*                 /*                                                 */ 01799000
*                 /* 'CONTINUE HERE' SUBCMD ENTERED                  */ 01800000
*                 /*                                                 */ 01801000
*                 /***************************************************/ 01802000
*                                                                  0529 01803000
*                 DO;                                              0529 01804000
*                   SUBCONT=OFF;    /* TURN OFF SUBCONT INDICATOR. 0530 01805000
*                                      LEAVE SUBHERE ON TO TELL    0530 01806000
*                                      STARTPT RTN TO IGNORE CKPTS 0530 01807000
*                                      AND BEGIN AT START OF NEXT  0530 01808000
*                                      SYSOUT DS ACCESSED            */ 01809000
         NI    SUBCONT(OCMTBPTR),B'11011111'                       0530 01810000
*                   SKIPGET=YES;    /* NO MORE READS FOR THIS DS     */ 01811000
         OI    SKIPGET,B'10000000'                                 0531 01812000
*                 END;                                             0532 01813000
*               ELSE                /* CHECK FURTHER                 */ 01814000
*                 IF SUBCONT=YES&SUBNEXT=YES THEN/* IF CONTINUE NEXT    01815000
*                                      SUBCMD                        */ 01816000
*                                                                  0533 01817000
         B     @RC00528                                            0533 01818000
@RF00528 TM    SUBCONT(OCMTBPTR),B'00100100'                       0533 01819000
         BNO   @RF00533                                            0533 01820000
*                   /*************************************************/ 01821000
*                   /*                                               */ 01822000
*                   /* 'CONTINUE NEXT' SUBCMD ENTERED                */ 01823000
*                   /*                                               */ 01824000
*                   /*************************************************/ 01825000
*                                                                  0534 01826000
*                   DO;                                            0534 01827000
*                     SKIPGET=YES;  /* SKIP FURTHER GETS FROM DS     */ 01828000
         OI    SKIPGET,B'10000000'                                 0535 01829000
*                     SUBCONT=OFF;  /* TURN OFF SUBCONT INDICATOR    */ 01830000
*                     SUBNEXT=OFF;  /* TURN OFF SUBNEXT INDICATOR    */ 01831000
         NI    SUBCONT(OCMTBPTR),B'11011011'                       0537 01832000
*                   END;                                           0538 01833000
*                 ELSE              /* CHECK FURTHER                 */ 01834000
*                   IF ENDSW=YES THEN/* IF END SUBCMD                */ 01835000
*                                                                  0539 01836000
         B     @RC00533                                            0539 01837000
@RF00533 TM    ENDSW(OCMTBPTR),B'00010000'                         0539 01838000
         BNO   @RF00539                                            0539 01839000
*                     /***********************************************/ 01840000
*                     /*                                             */ 01841000
*                     /* 'END' SUBCMD ENTERED                        */ 01842000
*                     /*                                             */ 01843000
*                     /***********************************************/ 01844000
*                                                                  0540 01845000
*                     DO;                                          0540 01846000
*                       SSSOCHKP=NO;/* DON'T TELL SUBSYS TO CKPT   0541 01847000
*                                      SYSOUT SINCE EOF REACHED      */ 01848000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0541 01849000
         NI    SSSOCHKP(@14),B'10111111'                           0541 01850000
*                     END;                                         0542 01851000
*                   ELSE                                           0543 01852000
*                     ;             /* NO OTHER VALID SUBCMDS        */ 01853000
@RF00539 DS    0H                                                  0544 01854000
*         END;                                                     0544 01855000
*       ELSE                                                       0545 01856000
*         ;                         /* ELSE SUBCMD NOT RETRIEVED     */ 01857000
@RF00508 DS    0H                                                  0546 01858000
*     END;                                                         0546 01859000
*   END EODRTN;                     /* END RTN TO HANDLE EOD         */ 01860000
@EL00009 DS    0H                                                  0547 01861000
@EF00009 DS    0H                                                  0547 01862000
@ER00009 LM    @14,@12,@SA00009                                    0547 01863000
         BR    @14                                                 0547 01864000
*                                                                  0548 01865000
*/********************************************************************/ 01866000
*/*                                                                  */ 01867000
*/*  WHEN POSTED BIT IS DETECTED, THIS ROUTINE IS CALLED             */ 01868000
*/*  TO CLEAR THE INPUT QUEUE AND RESET THE STACK.                   */ 01869000
*/*                                                                  */ 01870000
*/********************************************************************/ 01871000
*                                                                  0548 01872000
*TCLRQSTK:                                                         0548 01873000
*   PROC;                                                          0548 01874000
TCLRQSTK STM   @14,@12,@SA00010                                    0548 01875000
*   DO WHILE POSTED=YES;                                           0549 01876000
         B     @DE00549                                            0549 01877000
@DL00549 DS    0H                                                  0550 01878000
*     POSTED=NO;                    /* TURN OFF POSTED BIT           */ 01879000
*                                                                  0550 01880000
         NI    POSTED(OCMTBPTR),B'10111111'                        0550 01881000
*     /***************************************************************/ 01882000
*     /*                                                             */ 01883000
*     /* INITIALIZE THE IOPL                                         */ 01884000
*     /*                                                             */ 01885000
*     /***************************************************************/ 01886000
*                                                                  0551 01887000
*     IOPLPTR=ADDR(IOPLAREA);       /* BASE IOPL                     */ 01888000
         LA    @14,IOPLAREA(,OCMTBPTR)                             0551 01889000
         ST    @14,IOPLPTR(,OCMTBPTR)                              0551 01890000
*     IOPLUPT=CPPLUPT;              /* ADDR OF UPT                   */ 01891000
         L     @05,CPPLPTR(,OCMTBPTR)                              0552 01892000
         MVC   IOPLUPT(4,@14),CPPLUPT(@05)                         0552 01893000
*     IOPLECT=CPPLECT;              /* ADDR OF ECT                   */ 01894000
         MVC   IOPLECT(4,@14),CPPLECT(@05)                         0553 01895000
*     IOPLECB=ADDR(OUTATTN);        /* ADDR OF ECB                   */ 01896000
         LA    @05,OUTATTN(,OCMTBPTR)                              0554 01897000
         ST    @05,IOPLECB(,@14)                                   0554 01898000
*     IOPLIOPB=ADDR(STCKLSTA);      /* ADDR OF STPB IN IOPL          */ 01899000
*                                                                  0555 01900000
         LA    @05,STCKLSTA                                        0555 01901000
         ST    @05,IOPLIOPB(,@14)                                  0555 01902000
*     /***************************************************************/ 01903000
*     /*                                                             */ 01904000
*     /* TCLEARQ                                                     */ 01905000
*     /*                                                             */ 01906000
*     /***************************************************************/ 01907000
*                                                                  0556 01908000
*     GEN(TCLEARQ  INPUT);                                         0556 01909000
*                                                                  0556 01910000
         TCLEARQ  INPUT                                                 01911000
*     /***************************************************************/ 01912000
*     /*                                                             */ 01913000
*     /* STACK                                                       */ 01914000
*     /*                                                             */ 01915000
*     /***************************************************************/ 01916000
*                                                                  0557 01917000
*     STCKLSTA(1:STCKLNGS)=STCKLSTS(1:STCKLNGS);/* LIST TO DYN CORE  */ 01918000
         L     @14,STCKLNGS                                        0557 01919000
         BCTR  @14,0                                               0557 01920000
         EX    @14,@SM01595                                        0557 01921000
*     REG1=IOPLPTR;                 /* SET PARM REG FOR STACK      0558 01922000
*                                                            @OZ01550*/ 01923000
         L     REG1,IOPLPTR(,OCMTBPTR)                             0558 01924000
*     KEY1=NO;                                                     0559 01925000
         NI    KEY1(OCMTBPTR),B'01111111'                          0559 01926000
*     GEN(MODESET EXTKEY=SUPR);                                    0560 01927000
         MODESET EXTKEY=SUPR                                            01928000
*     GEN(STACK MF=(E,(1)));                                       0561 01929000
         STACK MF=(E,(1))                                               01930000
*     GEN(MODESET EXTKEY=SCHED);                                   0562 01931000
         MODESET EXTKEY=SCHED                                           01932000
*     KEY1=YES;                                                    0563 01933000
         OI    KEY1(OCMTBPTR),B'10000000'                          0563 01934000
*                                                                  0564 01935000
*     /***************************************************************/ 01936000
*     /*                                                             */ 01937000
*     /* FREE PREVIOUS BUFFER AND SAVE ADDRESS OF NEW ONE            */ 01938000
*     /*                                                             */ 01939000
*     /***************************************************************/ 01940000
*                                                                  0564 01941000
*     IF OUTSBBUF^=ZERO THEN        /* THERE IS A PREVIOUS BUFFER TO    01942000
*                                      FREE                          */ 01943000
         L     @14,OUTSBBUF(,OCMTBPTR)                             0564 01944000
         LTR   @14,@14                                             0564 01945000
         BZ    @RF00564                                            0564 01946000
*       DO;                                                        0565 01947000
*         REG1=OUTSBBUF;            /* ADDR OF BUFFER TO FREE        */ 01948000
         LR    REG1,@14                                            0566 01949000
*         REG0=PSUBLEN;             /* LEN OF PREVIOUS BUFFER        */ 01950000
         LH    REG0,PSUBLEN(,@14)                                  0567 01951000
*         REG0=REG0|SUBPOOL1;       /* SUBPOOL NO. IN HI ORDER BYTE  */ 01952000
         O     REG0,@CF01397                                       0568 01953000
*         GEN(FREEMAIN R,LV=(0),A=(1));/* FREE PREVIOUS BUFFER       */ 01954000
         FREEMAIN R,LV=(0),A=(1)                                        01955000
*         OUTSBBUF=OUTSBBUF&&OUTSBBUF;/* INDICATE BUFFER FREED       */ 01956000
         L     @14,OUTSBBUF(,OCMTBPTR)                             0570 01957000
         LR    @05,@14                                             0570 01958000
         XR    @05,@14                                             0570 01959000
         ST    @05,OUTSBBUF(,OCMTBPTR)                             0570 01960000
*       END;                                                       0571 01961000
*     ELSE                                                         0572 01962000
*       ;                           /* NO BUFFER TO FREE             */ 01963000
@RF00564 DS    0H                                                  0573 01964000
*     OUTSBBUF=OUTEMPSB;            /* SAVE PTR OF SUBCMD RETRIEVED     01965000
*                                      BY '72                        */ 01966000
         MVC   OUTSBBUF(4,OCMTBPTR),OUTEMPSB(OCMTBPTR)             0573 01967000
*   END;                            /* END DOWHILE PROCESSING FOR  0574 01968000
*                                      ATTN                          */ 01969000
@DE00549 TM    POSTED(OCMTBPTR),B'01000000'                        0574 01970000
         BO    @DL00549                                            0574 01971000
*   END TCLRQSTK;                                                  0575 01972000
@EL00010 DS    0H                                                  0575 01973000
@EF00010 DS    0H                                                  0575 01974000
@ER00010 LM    @14,@12,@SA00010                                    0575 01975000
         BR    @14                                                 0575 01976000
*                                                                  0576 01977000
*/********************************************************************/ 01978000
*/*                                                                  */ 01979000
*/*     FREE INPUT BUFFERS IF NECCESSARY                             */ 01980000
*/*     CLOSE SYSOUT DATA SET IF OPENED                              */ 01981000
*/*                                                                  */ 01982000
*/********************************************************************/ 01983000
*                                                                  0576 01984000
*CLSSYSO:                                                          0576 01985000
*   PROC;                           /* INTERNAL PROCEDURE TO CLOSE A    01986000
*                                      SYSOUT DATA SET               */ 01987000
CLSSYSO  STM   @14,@12,@SA00011                                    0576 01988000
*/********************************************************************/ 01989000
*/*    FREE INPUT BUFFERS                                            */ 01990000
*/********************************************************************/ 01991000
*                                                                  0577 01992000
*   IF FREEBUF=YES THEN             /* NEED TO FREE INPUT BUFFER     */ 01993000
         TM    FREEBUF,B'10000000'                                 0577 01994000
         BNO   @RF00577                                            0577 01995000
*     DO;                                                          0578 01996000
*       REG1=RPLAREA;               /* ADDR OF AREA TO FREE          */ 01997000
         L     @14,OUTRPL(,OCMTBPTR)                               0579 01998000
         L     REG1,RPLAREA(,@14)                                  0579 01999000
*       REG4=RPLBUFL;               /* LENGTH OF AREA TO FREE        */ 02000000
         L     REG4,RPLBUFL(,@14)                                  0580 02001000
*       GEN(FREEMAIN R,LV=(4),A=(1),SP=1);/* ISSUE FREEMAIN          */ 02002000
         FREEMAIN R,LV=(4),A=(1),SP=1                                   02003000
*       FREEBUF=NO;                                                0582 02004000
         NI    FREEBUF,B'01111111'                                 0582 02005000
*     END;                                                         0583 02006000
*   ELSE                                                           0584 02007000
*     ;                                                            0584 02008000
*                                                                  0584 02009000
@RF00577 DS    0H                                                  0585 02010000
*/********************************************************************/ 02011000
*/*    CLOSE THE ACB                                                 */ 02012000
*/********************************************************************/ 02013000
*                                                                  0585 02014000
*   IF OPENED=YES THEN              /* A DATA SET IS OPEN            */ 02015000
         TM    OPENED(OCMTBPTR),B'01000000'                        0585 02016000
         BNO   @RF00585                                            0585 02017000
*     DO;                                                          0586 02018000
*       REG4=ADDR(ACBCORE);         /* ADDR OF ACB TO CLOSE          */ 02019000
         LA    REG4,ACBCORE                                        0587 02020000
*       CLSLSTA(1:LNGCLSTS)=CLSLSTS(1:LNGCLSTS);/* MOVE CLOSE LST TO    02021000
*                                      DYN CORE                      */ 02022000
         L     @14,LNGCLSTS                                        0588 02023000
         BCTR  @14,0                                               0588 02024000
         EX    @14,@SM01597                                        0588 02025000
*       OPENED=NO;                  /* INDICATE SYSOUT NOT OPENED. 0589 02026000
*                                      TURN THIS BIT OFF BEFORE    0589 02027000
*                                      CLOSE, SO IF CLOSE ABENDS,  0589 02028000
*                                      ESTAE WON'T TRY TO CLOSE AGAIN*/ 02029000
         NI    OPENED(OCMTBPTR),B'10111111'                        0589 02030000
*       GEN(CLOSE ((4)),MF=(E,CLSLSTA));/* CLOSE THE ACB             */ 02031000
         CLOSE ((4)),MF=(E,CLSLSTA)                                     02032000
*     END;                                                         0591 02033000
*   ELSE                                                           0592 02034000
*     ;                                                            0592 02035000
@RF00585 DS    0H                                                  0593 02036000
*   END PRINTRTN;                                                  0593 02037000
@EL00011 DS    0H                                                  0593 02038000
@EF00011 DS    0H                                                  0593 02039000
@ER00011 LM    @14,@12,@SA00011                                    0593 02040000
         BR    @14                                                 0593 02041000
@EL00005 DS    0H                                                  0594 02042000
@EF00005 DS    0H                                                  0594 02043000
@ER00005 LM    @14,@12,@SA00005                                    0594 02044000
         BR    @14                                                 0594 02045000
*                                                                  0595 02046000
*/********************************************************************/ 02047000
*/*                                                                  */ 02048000
*/*    INITIALIZE THE REQUEST BLOCK POINTER AND THE REQUEST BLOCK.   */ 02049000
*/*    DETERMINE THE NATURE OF THE UNALLOCATION REQUEST AND          */ 02050000
*/*       INITIALIZE THE NECESSARY TEXT UNITS. SET UP THE POINTER    */ 02051000
*/*       LIST ACCORDINGLY.                                          */ 02052000
*/*    ANALYZE THE RETURN CODE AND TAKE APPROPRIATE ACTION.          */ 02053000
*/*                                                                  */ 02054000
*/********************************************************************/ 02055000
*                                                                  0595 02056000
*UNALCSO:                                                          0595 02057000
*   PROC;                           /* INTERNAL PROCEDURE TO       0595 02058000
*                                      UNALLOCATE SYSOUT DATA SET    */ 02059000
UNALCSO  STM   @14,@12,@SA00012                                    0595 02060000
*/********************************************************************/ 02061000
*/*   SET UP REQUEST BLOCK                                           */ 02062000
*/********************************************************************/ 02063000
*                                                                  0596 02064000
*   S99RB=S99RB&&S99RB;             /* CLEAR THE REQUEST BLOCK       */ 02065000
         XC    S99RB(20),S99RB                                     0596 02066000
*   S99RBLN=LENGTH(S99RB);          /* LENGTH OF REQUEST BLOCK       */ 02067000
         MVI   S99RBLN,X'14'                                       0597 02068000
*   S99VERB=S99VRBUN;               /* UNALLOCATE VERB CODE          */ 02069000
         MVI   S99VERB,X'02'                                       0598 02070000
*   S99TXTPP=ADDR(PTRLIST);         /* ADDR TEXT UNIT PTR LIST       */ 02071000
         LA    @14,PTRLIST                                         0599 02072000
         ST    @14,S99TXTPP                                        0599 02073000
*/********************************************************************/ 02074000
*/* INITIALIZE THE POINTER LIST AND TEXT UNITS TO ZERO.              */ 02075000
*/*   SET UP THE TU KEY TO SPECIFY DDNAME - ALWAYS USED.             */ 02076000
*/********************************************************************/ 02077000
*                                                                  0600 02078000
*   PLIST=''B;                      /* CLEAR POINTER LIST            */ 02079000
         XC    PLIST(16),PLIST                                     0600 02080000
*   UDDNTU=UDDNTU&&UDDNTU;          /* CLEAR DDN UNALC TU            */ 02081000
         XC    UDDNTU(18),UDDNTU                                   0601 02082000
*   UDISPTU=UDISPTU&&UDISPTU;       /* CLEAR OVRIDE DISP TU          */ 02083000
         XC    UDISPTU(11),UDISPTU                                 0602 02084000
*   UHLDQTU=UHLDQTU&&UHLDQTU;       /* CLEAR HOLD TEXT UNIT          */ 02085000
         XC    UHLDQTU(6),UHLDQTU                                  0603 02086000
*   UNONHQTU=UNONHQTU&&UNONHQTU;    /* CLEAR RLSE TEXT UNIT          */ 02087000
         XC    UNONHQTU(6),UNONHQTU                                0604 02088000
*   ELEM=ONE;                       /* INIT INDEX INTO PTR LIST      */ 02089000
         LA    @05,1                                               0605 02090000
         LR    ELEM,@05                                            0605 02091000
*   RFY                                                            0606 02092000
*     S99TUNIT BASED(S99TUPTR(ELEM));/* BASE TEXT UNIT ON ADDR IN  0606 02093000
*                                      CURRENT PTR LIST ELEM         */ 02094000
*   S99TUPTR(ELEM)=ADDR(UDDNTU);    /* ADR 'DDN UNALC' TU IN PL      */ 02095000
         LR    @09,ELEM                                            0607 02096000
         SLA   @09,2                                               0607 02097000
         LA    @08,UDDNTU                                          0607 02098000
         AL    @09,@CF01588                                        0607 02099000
         ST    @08,S99TUPTR(@09,@14)                               0607 02100000
*   S99TUKEY=DUNDDNAM;              /* KEY TO UNALC WITH DDN         */ 02101000
         MVC   S99TUKEY(2,@08),@CB00924                            0608 02102000
*   S99TUNUM=1;                     /* ONE PARAMETER                 */ 02103000
         MVC   S99TUNUM(2,@08),@CH00033                            0609 02104000
*   S99TUPAR(1:8)=OSYSODDN;         /* DDNAME PARM                   */ 02105000
         MVC   S99TUPAR(8,@08),OSYSODDN(OCMTBPTR)                  0610 02106000
*   S99TULNG=8;                     /* LENGTH OF DDNAME PARM         */ 02107000
         MVC   S99TULNG(2,@08),@CH00047                            0611 02108000
*/********************************************************************/ 02109000
*/*   INITIALIZE THE OTHER NECESSARY TEXT UNITS AND PUT THEIR        */ 02110000
*/*       ADDRESSES IN THE POINTER LIST                              */ 02111000
*/********************************************************************/ 02112000
*                                                                  0612 02113000
*                                   /* SET UP KEY 5 TO OVERRIDE    0612 02114000
*                                      DISPOSTION                    */ 02115000
*   ELEM=ELEM+ONE;                  /* INCRE INDEX INTO PTR LST      */ 02116000
         ALR   ELEM,@05                                            0612 02117000
*   S99TUPTR(ELEM)=ADDR(UDISPTU);   /* ADR 'OVRIDE DISP' TU IN PL    */ 02118000
         LR    @05,ELEM                                            0613 02119000
         SLA   @05,2                                               0613 02120000
         LA    @09,UDISPTU                                         0613 02121000
         AL    @14,@CF01588                                        0613 02122000
         ST    @09,S99TUPTR(@05,@14)                               0613 02123000
*   S99TUKEY=DUNOVDSP;              /* KEY TO OVERRIDE DISP          */ 02124000
         MVC   S99TUKEY(2,@09),@CB00932                            0614 02125000
*   S99TUNUM=1;                     /* ONE PARAMETER                 */ 02126000
         MVC   S99TUNUM(2,@09),@CH00033                            0615 02127000
*   S99TULNG=1;                     /* LENGTH OF DISP PARM           */ 02128000
         MVC   S99TULNG(2,@09),@CH00033                            0616 02129000
*   IF KEEP=YES|ERROR=YES|ENDKEEP=YES THEN/* IF KEEP SPECIFIED OR  0617 02130000
*                                      ERROR OCCURRED OR END       0617 02131000
*                                      REQUESTED AFTER ATTN, KEEP THE   02132000
*                                      SYSOUT DS                     */ 02133000
         TM    KEEP(OCMTBPTR),B'10000000'                          0617 02134000
         BO    @RT00617                                            0617 02135000
         TM    ERROR(OCMTBPTR),B'00001100'                         0617 02136000
         BZ    @RF00617                                            0617 02137000
@RT00617 DS    0H                                                  0618 02138000
*     S99TUPAR(1)=KEEPDISP;         /* SET PARM FOR KEEP DISP        */ 02139000
         LR    @14,ELEM                                            0618 02140000
         SLA   @14,2                                               0618 02141000
         L     @05,S99TXTPP                                        0618 02142000
         AL    @05,@CF01588                                        0618 02143000
         L     @14,S99TUPTR(@14,@05)                               0618 02144000
         MVI   S99TUPAR(@14),X'08'                                 0618 02145000
*   ELSE                            /* ELSE DELETE THE DS            */ 02146000
*     S99TUPAR(1)=DELDISP;          /* SET PARM FOR DELETE DISP      */ 02147000
         B     @RC00617                                            0619 02148000
@RF00617 LR    @14,ELEM                                            0619 02149000
         SLA   @14,2                                               0619 02150000
         L     @05,S99TXTPP                                        0619 02151000
         AL    @05,@CF01588                                        0619 02152000
         L     @14,S99TUPTR(@14,@05)                               0619 02153000
         MVI   S99TUPAR(@14),X'04'                                 0619 02154000
*   IF HOLD=YES|ERROR=YES|ENDKEEP=YES THEN/* IF HOLD WAS SPECIFIED OR   02155000
*                                      ERROR OCCURRED OR END       0620 02156000
*                                      REQUESTED AFTER ATTN, HOLD  0620 02157000
*                                      HOLD THE SYSOUT DS            */ 02158000
@RC00617 TM    HOLD(OCMTBPTR),B'01000000'                          0620 02159000
         BO    @RT00620                                            0620 02160000
         TM    ERROR(OCMTBPTR),B'00001100'                         0620 02161000
         BZ    @RF00620                                            0620 02162000
@RT00620 DS    0H                                                  0621 02163000
*     DO;                           /* SET UP TXT UNIT FOR KEY59     */ 02164000
*       ELEM=ELEM+ONE;              /* INCRE INDEX INTO PTR LIST     */ 02165000
         AH    ELEM,@CH00033                                       0622 02166000
*       S99TUPTR(ELEM)=ADDR(UHLDQTU);/* ADR 'OVRIDE W/ HOLD' TU IN 0623 02167000
*                                      PTR LIST                      */ 02168000
         LR    @14,ELEM                                            0623 02169000
         SLA   @14,2                                               0623 02170000
         LA    @05,UHLDQTU                                         0623 02171000
         L     @09,S99TXTPP                                        0623 02172000
         AL    @09,@CF01588                                        0623 02173000
         ST    @05,S99TUPTR(@14,@09)                               0623 02174000
*       S99TUKEY=DUNOVSHQ;          /* KEY TO OVERRIDE W/ HOLD Q     */ 02175000
         MVC   S99TUKEY(2,@05),@CB01100                            0624 02176000
*       S99TUNUM=0;                 /* NO PARMS                      */ 02177000
         SLR   @14,@14                                             0625 02178000
         ST    @14,@TF00001                                        0625 02179000
         MVC   S99TUNUM(2,@05),@TF00001+2                          0625 02180000
*     END;                                                         0626 02181000
*   ELSE                            /* IF NOHOLD SPECIFIED OR      0627 02182000
*                                      DEFAULTED                     */ 02183000
*     DO;                           /* SET UP KEY 0A                 */ 02184000
         B     @RC00620                                            0627 02185000
@RF00620 DS    0H                                                  0628 02186000
*       ELEM=ELEM+ONE;              /* INCRE INDEX INTO PTR LIST     */ 02187000
         AH    ELEM,@CH00033                                       0628 02188000
*       S99TUPTR(ELEM)=ADDR(UNONHQTU);/* ADR 'OVRIDE W/ NO HOLD' TU     02189000
*                                      IN PTR LIST                   */ 02190000
         LR    @14,ELEM                                            0629 02191000
         SLA   @14,2                                               0629 02192000
         LA    @05,UNONHQTU                                        0629 02193000
         L     @09,S99TXTPP                                        0629 02194000
         AL    @09,@CF01588                                        0629 02195000
         ST    @05,S99TUPTR(@14,@09)                               0629 02196000
*       S99TUKEY=DUNOVSNH;          /* KEY TO OVRIDE W/ NO HOLDQ     */ 02197000
         MVC   S99TUKEY(2,@05),@CB00942                            0630 02198000
*       S99TUNUM=0;                 /* NO PARMS                      */ 02199000
         SLR   @14,@14                                             0631 02200000
         ST    @14,@TF00001                                        0631 02201000
         MVC   S99TUNUM(2,@05),@TF00001+2                          0631 02202000
*     END;                                                         0632 02203000
*   S99TUPLN(ELEM)=ON;              /* SET LAST TU PTR INDICATOR     */ 02204000
@RC00620 LR    @14,ELEM                                            0633 02205000
         SLA   @14,2                                               0633 02206000
         L     @05,S99TXTPP                                        0633 02207000
         ALR   @05,@14                                             0633 02208000
         AL    @05,@CF01588                                        0633 02209000
         OI    S99TUPLN(@05),B'10000000'                           0633 02210000
*                                                                  0634 02211000
*/********************************************************************/ 02212000
*/*   INVOKE DYNAMIC UNALLOCATION                                    */ 02213000
*/********************************************************************/ 02214000
*                                                                  0634 02215000
*   S99RBPTR=ADDR(S99RB);           /* SET UP REQUEST BLOCK PTR      */ 02216000
         LA    @14,S99RB                                           0634 02217000
         ST    @14,S99RBPTR                                        0634 02218000
*   REG1=ADDR(S99RBPTR);            /* REG1 PTS TO ADDR S99RB        */ 02219000
         LA    REG1,S99RBPTR                                       0635 02220000
*   S99RBPND=ON;                    /* TURN ON HI ORDER BIT          */ 02221000
         OI    S99RBPND,B'10000000'                                0636 02222000
*   ALLOC=OFF;                      /* INDICATE SYSOUT IS UNALLOC. 0637 02223000
*                                      TURN THIS BIT OFF BEFORE    0637 02224000
*                                      SVC99, SO IF UNALLOC ABENDS,     02225000
*                                      ESTAE WON'T TRY TO UNALLOC  0637 02226000
*                                      AGAIN.                        */ 02227000
         NI    ALLOC(OCMTBPTR),B'11111011'                         0637 02228000
*/* MACDATE Y-2 73082                                                */ 02229000
*                                                                  0638 02230000
*   SVC(99);                                                       0638 02231000
         SVC   99                                                  0638 02232000
*   OUTRTCD=REG15;                  /* SAVE DYN ALLOC RTN CODE       */ 02233000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0639 02234000
*/********************************************************************/ 02235000
*/*   ANALYZE DYNAMIC UNALLOCATION RETURN CODE                       */ 02236000
*/********************************************************************/ 02237000
*                                                                  0640 02238000
*   IF OUTRTCD=ZERO THEN            /* IF UNALLOC WAS SUCCESSFUL     */ 02239000
         SLR   @14,@14                                             0640 02240000
         LH    @05,OUTRTCD(,OCMTBPTR)                              0640 02241000
         CR    @05,@14                                             0640 02242000
         BNE   @RF00640                                            0640 02243000
*     DO;                                                          0641 02244000
*       IF S99INFO^=ZERO THEN       /* IF INFO MESSAGE NEEDED        */ 02245000
         MVC   @ZT00002+2(2),S99INFO                               0642 02246000
         C     @14,@ZT00002                                        0642 02247000
         BE    @RF00642                                            0642 02248000
*         DO;                                                      0643 02249000
*           OUTDARB=ADDR(S99RB);    /* SET UP FOR DAIRFAIL           */ 02250000
         LA    @14,S99RB                                           0644 02251000
         ST    @14,OUTDARB(,OCMTBPTR)                              0644 02252000
*           OUTMSGID=8;             /* MSG ID FOR IKJCT467           */ 02253000
         MVI   OUTMSGID(OCMTBPTR),X'08'                            0645 02254000
*           CALL IKJCT467(OUTCOMTB);/* CALL MESSAGE HANDLER          */ 02255000
         ST    OCMTBPTR,@AL00001                                   0646 02256000
         L     @15,@CV01406                                        0646 02257000
         LA    @01,@AL00001                                        0646 02258000
         BALR  @14,@15                                             0646 02259000
*         END;                                                     0647 02260000
*       ELSE                                                       0648 02261000
*         ;                         /* NO INFO MSG NEEDED            */ 02262000
@RF00642 DS    0H                                                  0649 02263000
*     END;                                                         0649 02264000
*   ELSE                            /* DYN ALC RETURN CODE NOT ZERO  */ 02265000
*     DO;                                                          0650 02266000
         B     @RC00640                                            0650 02267000
@RF00640 DS    0H                                                  0651 02268000
*       OUTDARB=ADDR(S99RB);        /* SET UP FOR DAIRFAIL           */ 02269000
         LA    @14,S99RB                                           0651 02270000
         ST    @14,OUTDARB(,OCMTBPTR)                              0651 02271000
*       OUTMSGID=8;                 /* MSG ID FOR IKJCT467           */ 02272000
         MVI   OUTMSGID(OCMTBPTR),X'08'                            0652 02273000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MESSAGE HANDLER          */ 02274000
         ST    OCMTBPTR,@AL00001                                   0653 02275000
         L     @15,@CV01406                                        0653 02276000
         LA    @01,@AL00001                                        0653 02277000
         BALR  @14,@15                                             0653 02278000
*       ERROR=YES;                  /* SET QUIT SWITCH               */ 02279000
         OI    ERROR(OCMTBPTR),B'00001000'                         0654 02280000
*       RETNCODE=TWELVE;            /* RETURN CODE OF 12             */ 02281000
         MVC   RETNCODE(4),@CF00034                                0655 02282000
*     END;                                                         0656 02283000
*   END UNALCSO;                    /* END OF UNALLOCATION RTN       */ 02284000
@EL00012 DS    0H                                                  0657 02285000
@EF00012 DS    0H                                                  0657 02286000
@ER00012 LM    @14,@12,@SA00012                                    0657 02287000
         BR    @14                                                 0657 02288000
*                                                                  0658 02289000
*/********************************************************************/ 02290000
*/*                                                                  */ 02291000
*/*    INVOKE SUBSYSTEM TO TELL IT NO MORE PROCESSING FOR THIS       */ 02292000
*/*      JOB (EARLY TERMINATION, OR NO MORE CLASSES FOR THIS JOB)    */ 02293000
*/*    ANALYZE THE SUBSYSTEM RETURN CODE AND TAKE APPROPRIATE ACTION.*/ 02294000
*/*    RETURN TO CALLER.                                             */ 02295000
*/*                                                                  */ 02296000
*/********************************************************************/ 02297000
*                                                                  0658 02298000
*FINISH:                                                           0658 02299000
*   PROC;                           /* INTERNAL PROCEDURE TO TELL  0658 02300000
*                                      SUBSYS OF COMPLETION          */ 02301000
FINISH   STM   @14,@12,@SA00013                                    0658 02302000
*   SSSOCTRL=ON;                    /* PROCESSING COMPLETE FOR JOB   */ 02303000
         L     @14,OUTSOBSO(,OCMTBPTR)                             0659 02304000
         OI    SSSOCTRL(@14),B'10000000'                           0659 02305000
*   SSSOUFLG=SSSOUFLG&&SSSOUFLG;    /* ZERO GROUP REQUEST FLAGS FOR     02306000
*                                      FINAL CALL (FLAGS TELL TYPE OF   02307000
*                                      GROUP REQUEST)                */ 02308000
         XC    SSSOUFLG(1,@14),SSSOUFLG(@14)                       0660 02309000
*   IF NOWORK=ON THEN               /* NO MORE CLASSES TO SELECT FOR    02310000
*                                      JOB. WON'T NEED SUBSYSTEM ANY    02311000
*                                      MORE FOR THIS JOB.            */ 02312000
         TM    NOWORK(OCMTBPTR),B'00000010'                        0661 02313000
         BNO   @RF00661                                            0661 02314000
*     SSSOFLG1=SSSOFLG1&&SSSOFLG1;  /* ZERO DS SELECTION FLAGS FOR 0662 02315000
*                                      THIS SITUATION (FLAGS TELL  0662 02316000
*                                      WHAT TO USE FOR SEARCH)       */ 02317000
         XC    SSSOFLG1(1,@14),SSSOFLG1(@14)                       0662 02318000
*   REG1=ADDR(OUTSOBH);             /* PASS ADDR SSOB PTR TO SUBSYS  */ 02319000
@RF00661 LA    REG1,OUTSOBH(,OCMTBPTR)                             0663 02320000
*   HASPABND=ON;                    /* IF SUBSYS ABENDS TELL ESTAE   */ 02321000
         OI    HASPABND(OCMTBPTR),B'00000001'                      0664 02322000
*/*  ? IEFSSREQ;                                                     */ 02323000
*/*                                                                  */ 02324000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */ 02325000
*/*  PROCESS REQUEST -                                               */ 02326000
*/*                                                                  */ 02327000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */ 02328000
*/*            WORD PARAMETER LIST WHICH                             */ 02329000
*/*            POINTS TO THE SSOB                                    */ 02330000
*/*                                                                  */ 02331000
*                                                                  0665 02332000
*   CALL SSREQ;                     /* INVOKE SUBSYSTEM              */ 02333000
         L     @05,CVTPTR                                          0665 02334000
         L     @05,CVTJESCT(,@05)                                  0665 02335000
         L     @15,JESSSREQ(,@05)                                  0665 02336000
         BALR  @14,@15                                             0665 02337000
*   HASPABND=OFF;                   /* NO LONGER IN SUBSYS           */ 02338000
         NI    HASPABND(OCMTBPTR),B'11111110'                      0666 02339000
*   OUTRTCD=REG15;                  /* SAVE SUSBYS RETURN CODE       */ 02340000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0667 02341000
*                                                                  0668 02342000
*/********************************************************************/ 02343000
*/*  ANALYZE THE SUBSYSTEM RETURN CODE                               */ 02344000
*/********************************************************************/ 02345000
*                                                                  0668 02346000
*   IF OUTRTCD^=SSRTOK THEN         /* SUBSYSTEM FAILED              */ 02347000
         LH    @14,OUTRTCD(,OCMTBPTR)                              0668 02348000
         LTR   @14,@14                                             0668 02349000
         BZ    @RF00668                                            0668 02350000
*     DO;                                                          0669 02351000
*       ERROR=YES;                  /* QUIT SWITCH INDICATES ERR     */ 02352000
         OI    ERROR(OCMTBPTR),B'00001000'                         0670 02353000
*       RETNCODE=TWELVE;            /* SET RETURN CODE TO 12         */ 02354000
         MVC   RETNCODE(4),@CF00034                                0671 02355000
*       OUTMSGID=134;               /* ISSUE MSG 346I                */ 02356000
         MVI   OUTMSGID(OCMTBPTR),X'86'                            0672 02357000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MESSAGE HANDLER          */ 02358000
         ST    OCMTBPTR,@AL00001                                   0673 02359000
         L     @15,@CV01406                                        0673 02360000
         LA    @01,@AL00001                                        0673 02361000
         BALR  @14,@15                                             0673 02362000
*     END;                                                         0674 02363000
*   ELSE                            /* SUBSYSTEM SUCCESSFUL          */ 02364000
*     DO;                                                          0675 02365000
         B     @RC00668                                            0675 02366000
@RF00668 DS    0H                                                  0676 02367000
*       SUBSYS=OFF;                 /* SUBSYSTEM HAS COMPLETED DATA     02368000
*                                      SET PROCESSING FOR THIS SET OF   02369000
*                                      DATA SETS                     */ 02370000
         NI    SUBSYS(OCMTBPTR),B'01111111'                        0676 02371000
*       RETNCODE=FOUR;              /* TELL '69 TO PASS THE NEXT JOB.*/ 02372000
         MVC   RETNCODE(4),@CF00053                                0677 02373000
*     END;                                                         0678 02374000
*   END FINISH;                                                    0679 02375000
@EL00013 DS    0H                                                  0679 02376000
@EF00013 DS    0H                                                  0679 02377000
@ER00013 LM    @14,@12,@SA00013                                    0679 02378000
         BR    @14                                                 0679 02379000
*   END IKJCT462                                                   0680 02380000
*                                                                  0680 02381000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02382000
*/*%INCLUDE SYSLIB  (IKJOCMTB)                                       */ 02383000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 02384000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */ 02385000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */ 02386000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */ 02387000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */ 02388000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 02389000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 02390000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 02391000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */ 02392000
*                                                                  0680 02393000
*       ;                                                          0680 02394000
@DATA    DS    0H                                                       02395000
@CH00033 DC    H'1'                                                     02396000
@CH00823 DC    H'28'                                                    02397000
@CH00857 DC    H'44'                                                    02398000
@CH01559 DC    H'120'                                                   02399000
@SM01575 MVC   SSSOJOBN(0,@05),JOBNAME(@09)                             02400000
@SM01578 MVC   SSSOJOBI(0,@05),JOBID(@14)                               02401000
@SM01582 MVC   SSSODEST(0,@14),DESTID(@05)                              02402000
@SM01592 MVC   OPENLSTA(0),OPENLSTS                                     02403000
@SM01595 MVC   STCKLSTA(0),STCKLSTS                                     02404000
@SM01597 MVC   CLSLSTA(0),CLSLSTS                                       02405000
@DATD    DSECT                                                          02406000
         DS    0F                                                       02407000
@SA00001 DS    18F                                                      02408000
@PC00001 DS    1F                                                       02409000
@SA00013 DS    15F                                                      02410000
@SA00003 DS    15F                                                      02411000
@SA00005 DS    15F                                                      02412000
@SA00007 DS    15F                                                      02413000
@SA00008 DS    15F                                                      02414000
@SA00009 DS    15F                                                      02415000
@SA00011 DS    15F                                                      02416000
@SA00010 DS    15F                                                      02417000
@SA00006 DS    0F                                                       02418000
@SA00012 DS    0F                                                       02419000
@SA00004 DS    0F                                                       02420000
         DS    15F                                                      02421000
@AL00001 DS    1A                                                       02422000
@TF00001 DS    F                                                        02423000
@ZTEMPS  DS    0F                                                       02424000
@ZT00002 DC    F'0'                                                     02425000
@ZTEMPND EQU   *                                                        02426000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         02427000
IKJCT462 CSECT                                                          02428000
         DS    0F                                                       02429000
@CF00053 DC    F'4'                                                     02430000
@CH00053 EQU   @CF00053+2                                               02431000
@CF00047 DC    F'8'                                                     02432000
@CH00047 EQU   @CF00047+2                                               02433000
@CF00034 DC    F'12'                                                    02434000
@CF00101 DC    F'16'                                                    02435000
@CF00813 DC    F'20'                                                    02436000
@CH00813 EQU   @CF00813+2                                               02437000
@CF00182 DC    F'24'                                                    02438000
@CF01588 DC    F'-4'                                                    02439000
@CF01397 DC    XL4'01000000'                                            02440000
@DATD    DSECT                                                          02441000
         DS    0D                                                       02442000
S99RBPTR DS    AL4                                                      02443000
         ORG   S99RBPTR                                                 02444000
S99RBPND DS    BL1                                                      02445000
         ORG   S99RBPTR+4                                               02446000
S99TUFP  DS    A                                                        02447000
RETNCODE DS    F                                                        02448000
S99RB    DS    CL20                                                     02449000
         ORG   S99RB                                                    02450000
S99RBLN  DS    CL1                                                      02451000
S99VERB  DS    CL1                                                      02452000
S99FLAG1 DS    CL2                                                      02453000
         ORG   S99FLAG1                                                 02454000
S99FLG11 DS    CL1                                                      02455000
         ORG   S99FLG11                                                 02456000
S99ONCNV DS    BL1                                                      02457000
S99NOCNV EQU   S99FLG11+0                                               02458000
S99NOMNT EQU   S99FLG11+0                                               02459000
S99JBSYS EQU   S99FLG11+0                                               02460000
         ORG   S99FLAG1+1                                               02461000
S99FLG12 DS    CL1                                                      02462000
         ORG   S99RB+4                                                  02463000
S99RSC   DS    CL4                                                      02464000
         ORG   S99RSC                                                   02465000
S99ERROR DS    CL2                                                      02466000
S99INFO  DS    CL2                                                      02467000
         ORG   S99RB+8                                                  02468000
S99TXTPP DS    AL4                                                      02469000
S99RSV01 DS    FL4                                                      02470000
S99FLAG2 DS    CL4                                                      02471000
         ORG   S99FLAG2                                                 02472000
S99FLG21 DS    CL1                                                      02473000
         ORG   S99FLG21                                                 02474000
S99WTVOL DS    BL1                                                      02475000
S99WTDSN EQU   S99FLG21+0                                               02476000
S99NORES EQU   S99FLG21+0                                               02477000
S99WTUNT EQU   S99FLG21+0                                               02478000
S99OFFLN EQU   S99FLG21+0                                               02479000
S99TIONQ EQU   S99FLG21+0                                               02480000
S99CATLG EQU   S99FLG21+0                                               02481000
S99MOUNT EQU   S99FLG21+0                                               02482000
         ORG   S99FLAG2+1                                               02483000
S99FLG22 DS    CL1                                                      02484000
         ORG   S99FLG22                                                 02485000
S99UDEVT DS    BL1                                                      02486000
S99PCINT EQU   S99FLG22+0                                               02487000
         ORG   S99FLAG2+2                                               02488000
S99FLG23 DS    CL1                                                      02489000
S99FLG24 DS    CL1                                                      02490000
         ORG   S99RB+20                                                 02491000
SKIPDS   DS    BL1                                                      02492000
SKIPGET  DS    BL1                                                      02493000
FIRSTIME DS    BL1                                                      02494000
LOOP     DS    BL1                                                      02495000
FREEBUF  DS    BL1                                                      02496000
ADSNTU   DS    CL54                                                     02497000
ADISPTU  DS    CL7                                                      02498000
ASSREQTU DS    CL4                                                      02499000
ARTDDNTU DS    CL18                                                     02500000
UDDNTU   DS    CL18                                                     02501000
UDISPTU  DS    CL11                                                     02502000
UHLDQTU  DS    CL6                                                      02503000
UNONHQTU DS    CL6                                                      02504000
         DS    CL3                                                      02505000
ACBCORE  DS    CL76                                                     02506000
RPLCORE  DS    CL76                                                     02507000
PTRLIST  DS    4A                                                       02508000
IKJCT462 CSECT                                                          02509000
         DS    0F                                                       02510000
@SIZDATD DC    AL1(1)                                                   02511000
         DC    AL3(@ENDDATD-@DATD)                                      02512000
@CV01405 DC    V(IKJCT463)                                              02513000
@CV01406 DC    V(IKJCT467)                                              02514000
@CV01407 DC    V(IKJCT470)                                              02515000
@CV01408 DC    V(IKJCT471)                                              02516000
         DS    0D                                                       02517000
@CC01391 DC    C'        '                                              02518000
@CB01394 DC    X'0000000000000000'                                      02519000
@CB00924 DC    X'0001'                                                  02520000
@CB00926 DC    X'0002'                                                  02521000
@CB00930 DC    X'0004'                                                  02522000
@CB00932 DC    X'0005'                                                  02523000
@CB00942 DC    X'000A'                                                  02524000
@CB01092 DC    X'0055'                                                  02525000
@CB01100 DC    X'0059'                                                  02526000
@CB01106 DC    X'005C'                                                  02527000
PATCH62  DS    CL100                                                    02528000
         ORG   PATCH62                                                  02529000
PTCHINIT DC    20CL5'ZAP62'                                             02530000
         ORG   PATCH62+100                                              02531000
IKJCT462 CSECT                                                          02532000
*********************************************************************** 02533000
*    CREATE RPL  -  LOCAL                                             * 02534000
*********************************************************************** 02535000
INPRPL   RPL ACB=INPACB,                                               *02536000
               OPTCD=(ADR,SEQ,SYN,NUP,MVE)                              02537000
         EJECT                                                          02538000
*********************************************************************** 02539000
*    CREATE ACB  -  LOCAL                                             * 02540000
*********************************************************************** 02541000
INPACB   ACB   MACRF=(ADR,SEQ,IN)                                       02542000
IKJCT462 CSECT                                                          02543000
*                                      /* OPEN LIST FORM-LOCAL       */ 02544000
OPENLSTS OPEN (0),MF=L                                                  02545000
ENDOPENL EQU   *                                                        02546000
LNGOLSTS DC  A(ENDOPENL-OPENLSTS)         LENGTH OF LIST                02547000
@DATD    DSECT                                                          02548000
*                                      /* OPEN LIST FORM-DYNAMIC     */ 02549000
OPENLSTA OPEN (0),MF=L                                                  02550000
IKJCT462 CSECT                                                          02551000
*                                      /* CLOSE LIST FORM-LOCAL      */ 02552000
CLSLSTS  CLOSE (0),MF=L                                                 02553000
ENDCLSL  EQU   *                                                        02554000
LNGCLSTS DC   A(ENDCLSL-CLSLSTS)          LENGTH OF LIST                02555000
@DATD    DSECT                                                          02556000
*                                      /* CLOSE LIST FORM-DYNAMIC    */ 02557000
CLSLSTA  CLOSE (0),MF=L                                                 02558000
IKJCT462 CSECT                                                          02559000
*                                    /* LIST FORM OF STACK - LOCAL */   02560000
STCKLSTS STACK DELETE=ALL,MF=L                                          02561000
ENDSTCKL EQU   *                                                        02562000
STCKLNGS DC    A(ENDSTCKL-STCKLSTS)            LENGTH OF LIST           02563000
@DATD    DSECT                                                          02564000
*                                    /* LIST FORM OF STACK - AUTO */    02565000
STCKLSTA STACK DELETE=ALL,MF=L                                          02566000
@DATD    DSECT                                                          02567000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02568000
@ENDDATD EQU   *                                                        02569000
IKJCT462 CSECT                                                          02570000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02571000
@01      EQU   01                                                       02572000
@02      EQU   02                                                       02573000
@03      EQU   03                                                       02574000
@04      EQU   04                                                       02575000
@05      EQU   05                                                       02576000
@06      EQU   06                                                       02577000
@07      EQU   07                                                       02578000
@08      EQU   08                                                       02579000
@09      EQU   09                                                       02580000
@10      EQU   10                                                       02581000
@11      EQU   11                                                       02582000
@12      EQU   12                                                       02583000
@13      EQU   13                                                       02584000
@14      EQU   14                                                       02585000
@15      EQU   15                                                       02586000
ELEM     EQU   @02                                                      02587000
OCMTBPTR EQU   @03                                                      02588000
REG0     EQU   @00                                                      02589000
REG1     EQU   @01                                                      02590000
REG4     EQU   @04                                                      02591000
REG15    EQU   @15                                                      02592000
CVTPTR   EQU   16                                                       02593000
OUTCOMTB EQU   0                                                        02594000
OUTCPPL  EQU   OUTCOMTB                                                 02595000
OUTMSGID EQU   OUTCOMTB+4                                               02596000
OUTFLAGS EQU   OUTCOMTB+5                                               02597000
KEY1     EQU   OUTFLAGS                                                 02598000
OUTRTCD  EQU   OUTCOMTB+6                                               02599000
OUTATTN  EQU   OUTCOMTB+24                                              02600000
POSTED   EQU   OUTATTN                                                  02601000
OUTSOBH  EQU   OUTCOMTB+40                                              02602000
OUTSOBSO EQU   OUTCOMTB+44                                              02603000
OUTRPL   EQU   OUTCOMTB+48                                              02604000
OUTRPLL  EQU   OUTCOMTB+52                                              02605000
OUTACB   EQU   OUTCOMTB+56                                              02606000
OUTACBL  EQU   OUTCOMTB+60                                              02607000
OUTEMPSB EQU   OUTCOMTB+64                                              02608000
OUTHOLD  EQU   OUTCOMTB+68                                              02609000
OUTBKNEW EQU   OUTCOMTB+76                                              02610000
OUTBKAPX EQU   OUTCOMTB+84                                              02611000
OUTBKCNT EQU   OUTCOMTB+92                                              02612000
O73PARM  EQU   OUTCOMTB+100                                             02613000
@NM00002 EQU   O73PARM+16                                               02614000
OUTKEYWD EQU   OUTCOMTB+146                                             02615000
PAUSE    EQU   OUTKEYWD                                                 02616000
HOLD     EQU   OUTKEYWD                                                 02617000
HERE     EQU   OUTKEYWD                                                 02618000
BEGIN    EQU   OUTKEYWD                                                 02619000
DELETE   EQU   OUTKEYWD                                                 02620000
PRINT    EQU   OUTKEYWD                                                 02621000
NEWCLASS EQU   OUTKEYWD                                                 02622000
KEEP     EQU   OUTKEYWD+1                                               02623000
DEST     EQU   OUTKEYWD+1                                               02624000
SUBCONT  EQU   OUTKEYWD+1                                               02625000
SUBHERE  EQU   OUTKEYWD+1                                               02626000
SUBBEGN  EQU   OUTKEYWD+1                                               02627000
SUBNEXT  EQU   OUTKEYWD+1                                               02628000
OUTSW    EQU   OUTCOMTB+148                                             02629000
SUBSYS   EQU   OUTSW                                                    02630000
ENDSW    EQU   OUTSW                                                    02631000
ERROR    EQU   OUTSW                                                    02632000
ENDKEEP  EQU   OUTSW                                                    02633000
NOWORK   EQU   OUTSW                                                    02634000
HASPABND EQU   OUTSW                                                    02635000
SYNADERR EQU   OUTSW+1                                                  02636000
OPENED   EQU   OUTSW+1                                                  02637000
WORKDONE EQU   OUTSW+1                                                  02638000
ENDLIST  EQU   OUTSW+1                                                  02639000
OUTIDSSW EQU   OUTCOMTB+150                                             02640000
POINT    EQU   OUTIDSSW                                                 02641000
EODSW    EQU   OUTIDSSW                                                 02642000
TERM     EQU   OUTIDSSW                                                 02643000
ALLOC    EQU   OUTIDSSW                                                 02644000
INTRPMSG EQU   OUTIDSSW                                                 02645000
OUTDARB  EQU   OUTCOMTB+152                                             02646000
OUTXMSG  EQU   OUTCOMTB+164                                             02647000
OUTSBBUF EQU   OUTCOMTB+184                                             02648000
CLASBUFF EQU   OUTCOMTB+244                                             02649000
OSYSODDN EQU   OUTCOMTB+252                                             02650000
OUTPLIST EQU   OUTCOMTB+260                                             02651000
ONEWCPDE EQU   OUTPLIST+8                                               02652000
ODESTPDE EQU   OUTPLIST+12                                              02653000
OUTJBPDE EQU   OUTCOMTB+276                                             02654000
IOPLPTR  EQU   OUTCOMTB+292                                             02655000
IOPLAREA EQU   OUTCOMTB+296                                             02656000
CVTMAP   EQU   0                                                        02657000
CVTDAR   EQU   CVTMAP+72                                                02658000
CVTFLGS1 EQU   CVTDAR                                                   02659000
CVTDCB   EQU   CVTMAP+116                                               02660000
CVTIERLC EQU   CVTMAP+144                                               02661000
CVTOPTA  EQU   CVTMAP+182                                               02662000
CVTOPTB  EQU   CVTMAP+183                                               02663000
CVTGTF   EQU   CVTMAP+236                                               02664000
CVTGTFST EQU   CVTGTF                                                   02665000
CVTGTFS  EQU   CVTGTFST                                                 02666000
CVTSTATE EQU   CVTGTFST                                                 02667000
CVTTMODE EQU   CVTGTFST                                                 02668000
CVTFORM  EQU   CVTGTFST                                                 02669000
CVTAQAVT EQU   CVTMAP+240                                               02670000
CVTTCMFG EQU   CVTAQAVT                                                 02671000
CVTVOLM2 EQU   CVTMAP+244                                               02672000
CVTTATA  EQU   CVTVOLM2                                                 02673000
CVTTSKS  EQU   CVTTATA                                                  02674000
CVTVOLF2 EQU   CVTTSKS                                                  02675000
CVTTAT   EQU   CVTTATA+1                                                02676000
CVTATER  EQU   CVTMAP+248                                               02677000
CVTEXT1  EQU   CVTMAP+252                                               02678000
CVTPURG  EQU   CVTMAP+260                                               02679000
CVTQMSG  EQU   CVTMAP+268                                               02680000
CVTDMSR  EQU   CVTMAP+272                                               02681000
CVTJESCT EQU   CVTMAP+296                                               02682000
CVTERPV  EQU   CVTMAP+316                                               02683000
CVTINTLA EQU   CVTMAP+320                                               02684000
CVTAPF   EQU   CVTMAP+324                                               02685000
CVTEXT2  EQU   CVTMAP+328                                               02686000
CVTHJES  EQU   CVTMAP+332                                               02687000
CVTPGSIA EQU   CVTMAP+348                                               02688000
CVTA1F1  EQU   CVTMAP+356                                               02689000
CVTSYSK  EQU   CVTMAP+357                                               02690000
CVTVOLM1 EQU   CVTMAP+380                                               02691000
CVTVOLF1 EQU   CVTVOLM1                                                 02692000
CVTATMCT EQU   CVTMAP+388                                               02693000
CVTXTNT1 EQU   0                                                        02694000
CVTXTNT2 EQU   0                                                        02695000
CVTDSSV  EQU   CVTXTNT2                                                 02696000
CVTFLGBT EQU   CVTXTNT2+5                                               02697000
CVTQID   EQU   CVTXTNT2+24                                              02698000
CVTRV400 EQU   CVTXTNT2+52                                              02699000
CVTRV409 EQU   CVTXTNT2+53                                              02700000
CVTATCVT EQU   CVTXTNT2+64                                              02701000
CVTRV429 EQU   CVTXTNT2+84                                              02702000
CVTRV438 EQU   CVTXTNT2+85                                              02703000
CVTRV457 EQU   CVTXTNT2+112                                             02704000
CVTRV466 EQU   CVTXTNT2+113                                             02705000
CVTFIX   EQU   0                                                        02706000
CVTRELNO EQU   CVTFIX+252                                               02707000
JESCT    EQU   0                                                        02708000
JESWAA   EQU   JESCT+8                                                  02709000
JESSSREQ EQU   JESCT+20                                                 02710000
SSREQ    EQU   0                                                        02711000
SSOB     EQU   0                                                        02712000
SSOBFUNC EQU   SSOB+6                                                   02713000
SSOBRETN EQU   SSOB+12                                                  02714000
SSOBINDV EQU   SSOB+16                                                  02715000
SSSO     EQU   0                                                        02716000
SSSOLEN  EQU   SSSO                                                     02717000
SSSOUFLG EQU   SSSO+2                                                   02718000
SSSOSETC EQU   SSSOUFLG                                                 02719000
SSSODELC EQU   SSSOUFLG                                                 02720000
SSSOROUT EQU   SSSOUFLG                                                 02721000
SSSOHOLD EQU   SSSOUFLG                                                 02722000
SSSORLSE EQU   SSSOUFLG                                                 02723000
SSSOFLG1 EQU   SSSO+4                                                   02724000
SSSOSHLD EQU   SSSOFLG1                                                 02725000
SSSOSCLS EQU   SSSOFLG1                                                 02726000
SSSOSJBN EQU   SSSOFLG1                                                 02727000
SSSOSJBI EQU   SSSOFLG1                                                 02728000
SSSOFLG2 EQU   SSSO+5                                                   02729000
SSSOCTRL EQU   SSSOFLG2                                                 02730000
SSSOCHKP EQU   SSSOFLG2                                                 02731000
SSSOJOBN EQU   SSSO+8                                                   02732000
SSSOJOBI EQU   SSSO+16                                                  02733000
SSSOCLAS EQU   SSSO+24                                                  02734000
SSSODEST EQU   SSSO+28                                                  02735000
SSSORBA  EQU   SSSO+44                                                  02736000
SSSODSN  EQU   SSSO+52                                                  02737000
SSSOCLSL EQU   SSSO+100                                                 02738000
S99TUPL  EQU   0                                                        02739000
S99TUPTR EQU   S99TUPL                                                  02740000
S99TUPLN EQU   S99TUPTR                                                 02741000
S99TUP   EQU   0                                                        02742000
S99TUNIT EQU   0                                                        02743000
S99TUKEY EQU   S99TUNIT                                                 02744000
S99TUNUM EQU   S99TUNIT+2                                               02745000
S99TUENT EQU   S99TUNIT+4                                               02746000
S99TULNG EQU   S99TUENT                                                 02747000
S99TUPAR EQU   S99TUENT+2                                               02748000
S99TUFLD EQU   0                                                        02749000
IFGACB   EQU   0                                                        02750000
ACBCOMN  EQU   IFGACB                                                   02751000
ACBLENG  EQU   ACBCOMN+2                                                02752000
ACBLENG2 EQU   ACBLENG                                                  02753000
ACBAMBL  EQU   ACBCOMN+4                                                02754000
ACBIXLST EQU   ACBAMBL                                                  02755000
ACBJWA   EQU   ACBIXLST                                                 02756000
ACBMACRF EQU   ACBCOMN+12                                               02757000
ACBMACR1 EQU   ACBMACRF                                                 02758000
ACBADR   EQU   ACBMACR1                                                 02759000
ACBCNV   EQU   ACBMACR1                                                 02760000
ACBMACR2 EQU   ACBMACRF+1                                               02761000
ACBLFB   EQU   ACBCOMN+20                                               02762000
ACBBUFPL EQU   ACBLFB                                                   02763000
ACBRECFM EQU   ACBCOMN+24                                               02764000
ACBCCTYP EQU   ACBCOMN+25                                               02765000
ACBOPT   EQU   ACBCOMN+26                                               02766000
ACBDSORG EQU   ACBOPT                                                   02767000
ACBCROPS EQU   ACBDSORG                                                 02768000
ACBEXLST EQU   ACBCOMN+36                                               02769000
ACBDDNM  EQU   ACBCOMN+40                                               02770000
ACBAMETH EQU   ACBDDNM+3                                                02771000
ACBOFLGS EQU   ACBCOMN+48                                               02772000
ACBOPEN  EQU   ACBOFLGS                                                 02773000
ACBEXFG  EQU   ACBOFLGS                                                 02774000
ACBIOSFG EQU   ACBOFLGS                                                 02775000
ACBINFLG EQU   ACBCOMN+50                                               02776000
ACBUJFCB EQU   ACBCOMN+52                                               02777000
ACBWAPTR EQU   ACBUJFCB                                                 02778000
ACBLRECL EQU   ACBCOMN+62                                               02779000
IFGRPL   EQU   0                                                        02780000
RPLCOMN  EQU   IFGRPL                                                   02781000
RPLIDWD  EQU   RPLCOMN                                                  02782000
RPLLEN   EQU   RPLIDWD+3                                                02783000
RPLECB   EQU   RPLCOMN+8                                                02784000
RPLFDBK  EQU   RPLCOMN+13                                               02785000
RPLRTNCD EQU   RPLFDBK                                                  02786000
RPLCNDCD EQU   RPLFDBK+1                                                02787000
RPLCMPON EQU   RPLCNDCD                                                 02788000
RPLFDB2  EQU   RPLCMPON                                                 02789000
RPLERRCD EQU   RPLCNDCD+1                                               02790000
RPLFDB3  EQU   RPLERRCD                                                 02791000
RPLKEYLE EQU   RPLCOMN+16                                               02792000
RPLDACB  EQU   RPLCOMN+24                                               02793000
RPLAREA  EQU   RPLCOMN+32                                               02794000
RPLARG   EQU   RPLCOMN+36                                               02795000
RPLOPTCD EQU   RPLCOMN+40                                               02796000
RPLOPT1  EQU   RPLOPTCD                                                 02797000
RPLECBSW EQU   RPLOPT1                                                  02798000
RPLOPT2  EQU   RPLOPTCD+1                                               02799000
RPLADR   EQU   RPLOPT2                                                  02800000
RPLOPT3  EQU   RPLOPTCD+2                                               02801000
RPLNXTRP EQU   RPLCOMN+44                                               02802000
RPLBUFL  EQU   RPLCOMN+52                                               02803000
RPLOPTC2 EQU   RPLCOMN+56                                               02804000
RPLOPT5  EQU   RPLOPTC2                                                 02805000
RPLWRTYP EQU   RPLOPT5                                                  02806000
RPLOPT6  EQU   RPLOPTC2+1                                               02807000
RPLUNTYP EQU   RPLOPT6                                                  02808000
RPLOPT7  EQU   RPLOPTC2+2                                               02809000
RPLCNOPT EQU   RPLOPT7                                                  02810000
RPLOPT8  EQU   RPLOPTC2+3                                               02811000
RPLRBAR  EQU   RPLCOMN+60                                               02812000
RPL6RBA  EQU   RPLRBAR+2                                                02813000
RPLEXTDS EQU   RPLCOMN+68                                               02814000
RPLEXTD1 EQU   RPLEXTDS                                                 02815000
CPPL     EQU   0                                                        02816000
CPPLUPT  EQU   CPPL+4                                                   02817000
CPPLECT  EQU   CPPL+12                                                  02818000
IOPL     EQU   0                                                        02819000
IOPLUPT  EQU   IOPL                                                     02820000
IOPLECT  EQU   IOPL+4                                                   02821000
IOPLECB  EQU   IOPL+8                                                   02822000
IOPLIOPB EQU   IOPL+12                                                  02823000
PSUBBUF  EQU   0                                                        02824000
PSUBLEN  EQU   PSUBBUF                                                  02825000
JOBNPDE  EQU   0                                                        02826000
JOBNMPTR EQU   JOBNPDE                                                  02827000
JOBNLEN  EQU   JOBNPDE+4                                                02828000
JOBIDPTR EQU   JOBNPDE+8                                                02829000
JOBIDLEN EQU   JOBNPDE+12                                               02830000
JOBNAME  EQU   0                                                        02831000
JOBID    EQU   0                                                        02832000
NEWCLPDE EQU   0                                                        02833000
NEWCLPTR EQU   NEWCLPDE                                                 02834000
NEWCLAS  EQU   0                                                        02835000
DESTPDE  EQU   0                                                        02836000
DESTPTR  EQU   DESTPDE                                                  02837000
DESTLEN  EQU   DESTPDE+4                                                02838000
DESTID   EQU   0                                                        02839000
SWAMGR   EQU   0                                                        02840000
OPTR     EQU   0                                                        02841000
CVTS01   EQU   CVTPGSIA                                                 02842000
CVTLPDIA EQU   CVTS01+12                                                02843000
CVTDIRST EQU   CVTLPDIA                                                 02844000
CVTSLIDA EQU   CVTS01+24                                                02845000
CVTCTLFG EQU   CVTS01+50                                                02846000
CVTRV210 EQU   CVTS01+424                                               02847000
CVTRV219 EQU   CVTS01+425                                               02848000
CVTRV228 EQU   CVTS01+426                                               02849000
CVTRV237 EQU   CVTS01+427                                               02850000
CVTMFRTR EQU   CVTS01+452                                               02851000
CVTRV262 EQU   CVTS01+468                                               02852000
CVTRV271 EQU   CVTS01+469                                               02853000
CVTRV280 EQU   CVTS01+470                                               02854000
CVTRV289 EQU   CVTS01+471                                               02855000
CVTGSDA  EQU   CVTS01+600                                               02856000
CPPLPTR  EQU   OUTCPPL                                                  02857000
PLIST    EQU   PTRLIST                                                  02858000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02859000
CVTRV628 EQU   CVTS01+728                                               02860000
CVTRV627 EQU   CVTS01+724                                               02861000
CVTRV626 EQU   CVTS01+720                                               02862000
CVTRV625 EQU   CVTS01+716                                               02863000
CVTRV624 EQU   CVTS01+712                                               02864000
CVTRV623 EQU   CVTS01+708                                               02865000
CVTRV622 EQU   CVTS01+704                                               02866000
CVTRV621 EQU   CVTS01+700                                               02867000
CVTRV620 EQU   CVTS01+696                                               02868000
CVTRV619 EQU   CVTS01+692                                               02869000
CVTRV618 EQU   CVTS01+688                                               02870000
CVTRV617 EQU   CVTS01+684                                               02871000
CVTRV616 EQU   CVTS01+680                                               02872000
CVTRV615 EQU   CVTS01+676                                               02873000
CVTRV614 EQU   CVTS01+672                                               02874000
CVTRV613 EQU   CVTS01+668                                               02875000
CVTRV612 EQU   CVTS01+664                                               02876000
CVTRV611 EQU   CVTS01+660                                               02877000
CVTRV610 EQU   CVTS01+656                                               02878000
CVTRV609 EQU   CVTS01+652                                               02879000
CVTRV608 EQU   CVTS01+648                                               02880000
CVTRV607 EQU   CVTS01+644                                               02881000
CVTRV606 EQU   CVTS01+640                                               02882000
CVTRV605 EQU   CVTS01+636                                               02883000
CVTRV604 EQU   CVTS01+632                                               02884000
CVTEFF02 EQU   CVTS01+628                                               02885000
CVTCBBR  EQU   CVTS01+624                                               02886000
CVTSSCR  EQU   CVTS01+620                                               02887000
CVTEVENT EQU   CVTS01+616                                               02888000
CVTCRCA  EQU   CVTS01+612                                               02889000
CVTTPIO  EQU   CVTS01+608                                               02890000
CVTADV   EQU   CVTS01+604                                               02891000
CVTGSDAB EQU   CVTGSDA                                                  02892000
CVTQV3   EQU   CVTS01+596                                               02893000
CVTQV2   EQU   CVTS01+592                                               02894000
CVTQV1   EQU   CVTS01+588                                               02895000
CVTRPT   EQU   CVTS01+584                                               02896000
CVTSSRB  EQU   CVTS01+580                                               02897000
CVTCSDRL EQU   CVTS01+576                                               02898000
CVTEXP1  EQU   CVTS01+572                                               02899000
CVTRMPMT EQU   CVTS01+568                                               02900000
CVTRMPTT EQU   CVTS01+564                                               02901000
CVTVPSA  EQU   CVTS01+560                                               02902000
CVTVSTOP EQU   CVTS01+556                                               02903000
CVTGTFR8 EQU   CVTS01+552                                               02904000
CVTQUIT  EQU   CVTS01+548                                               02905000
CVTVACR  EQU   CVTS01+544                                               02906000
CVTWTCB  EQU   CVTS01+540                                               02907000
CVTSTPRS EQU   CVTS01+536                                               02908000
CVT0PT02 EQU   CVTS01+532                                               02909000
CVTDARCM EQU   CVTS01+528                                               02910000
CVTIRECM EQU   CVTS01+524                                               02911000
CVTJRECM EQU   CVTS01+520                                               02912000
CVTVEMS0 EQU   CVTS01+516                                               02913000
CVTSPFRR EQU   CVTS01+512                                               02914000
CVTRLSTG EQU   CVTS01+508                                               02915000
CVT0TC0A EQU   CVTS01+504                                               02916000
CVTGMBR  EQU   CVTS01+500                                               02917000
CVTLFRM  EQU   CVTS01+496                                               02918000
CVTRMBR  EQU   CVTS01+492                                               02919000
CVTVIOP  EQU   CVTS01+488                                               02920000
CVTRV307 EQU   CVTS01+486                                               02921000
CVTRV306 EQU   CVTS01+484                                               02922000
CVTRV305 EQU   CVTS01+482                                               02923000
CVTRV304 EQU   CVTS01+480                                               02924000
CVTRV303 EQU   CVTS01+478                                               02925000
CVTRV302 EQU   CVTS01+476                                               02926000
CVTTRCA  EQU   CVTS01+472                                               02927000
CVTRV297 EQU   CVTRV289                                                 02928000
CVTRV296 EQU   CVTRV289                                                 02929000
CVTRV295 EQU   CVTRV289                                                 02930000
CVTRV294 EQU   CVTRV289                                                 02931000
CVTRV293 EQU   CVTRV289                                                 02932000
CVTRV292 EQU   CVTRV289                                                 02933000
CVTRV291 EQU   CVTRV289                                                 02934000
CVTRV290 EQU   CVTRV289                                                 02935000
CVTRV288 EQU   CVTRV280                                                 02936000
CVTRV287 EQU   CVTRV280                                                 02937000
CVTRV286 EQU   CVTRV280                                                 02938000
CVTRV285 EQU   CVTRV280                                                 02939000
CVTRV284 EQU   CVTRV280                                                 02940000
CVTRV283 EQU   CVTRV280                                                 02941000
CVTRV282 EQU   CVTRV280                                                 02942000
CVTRV281 EQU   CVTRV280                                                 02943000
CVTRV279 EQU   CVTRV271                                                 02944000
CVTRV278 EQU   CVTRV271                                                 02945000
CVTRV277 EQU   CVTRV271                                                 02946000
CVTRV276 EQU   CVTRV271                                                 02947000
CVTRV275 EQU   CVTRV271                                                 02948000
CVTRV274 EQU   CVTRV271                                                 02949000
CVTRV273 EQU   CVTRV271                                                 02950000
CVTRV272 EQU   CVTRV271                                                 02951000
CVTRV270 EQU   CVTRV262                                                 02952000
CVTRV269 EQU   CVTRV262                                                 02953000
CVTRV268 EQU   CVTRV262                                                 02954000
CVTRV267 EQU   CVTRV262                                                 02955000
CVTRV266 EQU   CVTRV262                                                 02956000
CVTRV265 EQU   CVTRV262                                                 02957000
CVTRV264 EQU   CVTRV262                                                 02958000
CVTRV263 EQU   CVTRV262                                                 02959000
CVTVFP   EQU   CVTS01+464                                               02960000
CVTVSI   EQU   CVTS01+460                                               02961000
CVTVPSIB EQU   CVTS01+456                                               02962000
CVTMFACT EQU   CVTMFRTR                                                 02963000
CVTMFCTL EQU   CVTS01+448                                               02964000
CVTPVBP  EQU   CVTS01+444                                               02965000
CVTPWI   EQU   CVTS01+440                                               02966000
CVTRV254 EQU   CVTS01+438                                               02967000
CVTRV253 EQU   CVTS01+436                                               02968000
CVTRV252 EQU   CVTS01+434                                               02969000
CVTRV251 EQU   CVTS01+433                                               02970000
CVTRV250 EQU   CVTS01+432                                               02971000
CVTRV249 EQU   CVTS01+431                                               02972000
CVTRV248 EQU   CVTS01+430                                               02973000
CVTRV247 EQU   CVTS01+429                                               02974000
CVTRV246 EQU   CVTS01+428                                               02975000
CVTRV245 EQU   CVTRV237                                                 02976000
CVTRV244 EQU   CVTRV237                                                 02977000
CVTRV243 EQU   CVTRV237                                                 02978000
CVTRV242 EQU   CVTRV237                                                 02979000
CVTRV241 EQU   CVTRV237                                                 02980000
CVTRV240 EQU   CVTRV237                                                 02981000
CVTRV239 EQU   CVTRV237                                                 02982000
CVTRV238 EQU   CVTRV237                                                 02983000
CVTRV236 EQU   CVTRV228                                                 02984000
CVTRV235 EQU   CVTRV228                                                 02985000
CVTRV234 EQU   CVTRV228                                                 02986000
CVTRV233 EQU   CVTRV228                                                 02987000
CVTRV232 EQU   CVTRV228                                                 02988000
CVTRV231 EQU   CVTRV228                                                 02989000
CVTRV230 EQU   CVTRV228                                                 02990000
CVTRV229 EQU   CVTRV228                                                 02991000
CVTRV227 EQU   CVTRV219                                                 02992000
CVTRV226 EQU   CVTRV219                                                 02993000
CVTRV225 EQU   CVTRV219                                                 02994000
CVTRV224 EQU   CVTRV219                                                 02995000
CVTRV223 EQU   CVTRV219                                                 02996000
CVTRV222 EQU   CVTRV219                                                 02997000
CVTRV221 EQU   CVTRV219                                                 02998000
CVTRV220 EQU   CVTRV219                                                 02999000
CVTRV218 EQU   CVTRV210                                                 03000000
CVTRV217 EQU   CVTRV210                                                 03001000
CVTRV216 EQU   CVTRV210                                                 03002000
CVTRV215 EQU   CVTRV210                                                 03003000
CVTRV214 EQU   CVTRV210                                                 03004000
CVTRV213 EQU   CVTRV210                                                 03005000
CVTRV212 EQU   CVTRV210                                                 03006000
CVTRV211 EQU   CVTRV210                                                 03007000
CVTLCCAT EQU   CVTS01+420                                               03008000
CVTPCCAT EQU   CVTS01+416                                               03009000
CVTIPCRP EQU   CVTS01+412                                               03010000
CVTIPCRI EQU   CVTS01+408                                               03011000
CVTIPCDS EQU   CVTS01+404                                               03012000
CVTAIDVT EQU   CVTS01+400                                               03013000
CVTSSAP  EQU   CVTS01+396                                               03014000
CVTEHCIR EQU   CVTS01+392                                               03015000
CVTEHDEF EQU   CVTS01+388                                               03016000
CVTDAIR  EQU   CVTS01+384                                               03017000
CVTPERFM EQU   CVTS01+380                                               03018000
CVT044R2 EQU   CVTS01+376                                               03019000
CVTFETCH EQU   CVTS01+372                                               03020000
CVTRSTWD EQU   CVTS01+368                                               03021000
CVTSPOST EQU   CVTS01+364                                               03022000
CVTIOBP  EQU   CVTS01+360                                               03023000
CVTASMVT EQU   CVTS01+356                                               03024000
CVTRECRQ EQU   CVTS01+352                                               03025000
CVTWSAC  EQU   CVTS01+348                                               03026000
CVTRV149 EQU   CVTS01+344                                               03027000
CVTWSAL  EQU   CVTS01+340                                               03028000
CVTSPSA  EQU   CVTS01+336                                               03029000
CVTGLMN  EQU   CVTS01+332                                               03030000
CVTVEAC0 EQU   CVTS01+328                                               03031000
CVT062R1 EQU   CVTS01+324                                               03032000
CVTRPOST EQU   CVTS01+320                                               03033000
CVTDQIQE EQU   CVTS01+316                                               03034000
CVTCSD   EQU   CVTS01+312                                               03035000
CVTLKRMA EQU   CVTS01+308                                               03036000
CVTRSPIE EQU   CVTS01+304                                               03037000
CVTRENQ  EQU   CVTS01+300                                               03038000
CVTLQCB  EQU   CVTS01+296                                               03039000
CVTFQCB  EQU   CVTS01+292                                               03040000
CVTQCS01 EQU   CVTS01+288                                               03041000
CVTAPFT  EQU   CVTS01+284                                               03042000
CVTPARRL EQU   CVTS01+280                                               03043000
CVTVWAIT EQU   CVTS01+276                                               03044000
CVTGSPL  EQU   CVTS01+272                                               03045000
CVTLSMQ  EQU   CVTS01+268                                               03046000
CVTGSMQ  EQU   CVTS01+264                                               03047000
CVTEXPRO EQU   CVTS01+260                                               03048000
CVTOPCTP EQU   CVTS01+256                                               03049000
CVTSIC   EQU   CVTS01+252                                               03050000
CVTTPIOS EQU   CVTS01+248                                               03051000
CVTRTMS  EQU   CVTS01+244                                               03052000
CVTSDBF  EQU   CVTS01+240                                               03053000
CVTSCBP  EQU   CVTS01+236                                               03054000
CVTSDMP  EQU   CVTS01+232                                               03055000
CVTSV60  EQU   CVTS01+228                                               03056000
CVTRTMCT EQU   CVTS01+224                                               03057000
CVTASCBL EQU   CVTS01+220                                               03058000
CVTASCBH EQU   CVTS01+216                                               03059000
CVTGDA   EQU   CVTS01+212                                               03060000
CVTASVT  EQU   CVTS01+208                                               03061000
CVTVVMDI EQU   CVTS01+204                                               03062000
CVTAQTOP EQU   CVTS01+200                                               03063000
CVTIOSCS EQU   CVTS01+196                                               03064000
CVTSDRM  EQU   CVTS01+192                                               03065000
CVTOPTE  EQU   CVTS01+188                                               03066000
CVTSTXU  EQU   CVTS01+184                                               03067000
CVTQUIS  EQU   CVTS01+180                                               03068000
CVTPARS  EQU   CVTS01+176                                               03069000
CVTS1EE  EQU   CVTS01+172                                               03070000
CVTFRAS  EQU   CVTS01+168                                               03071000
CVTQSAS  EQU   CVTS01+164                                               03072000
CVTCRAS  EQU   CVTS01+160                                               03073000
CVTCRMN  EQU   CVTS01+156                                               03074000
CVTDELCP EQU   CVTS01+152                                               03075000
CVTFRECL EQU   CVTS01+148                                               03076000
CVTGETCL EQU   CVTS01+144                                               03077000
CVTBLDCP EQU   CVTS01+140                                               03078000
CVTAUTHL EQU   CVTS01+136                                               03079000
CVTSCAN  EQU   CVTS01+132                                               03080000
CVTRV144 EQU   CVTS01+130                                               03081000
CVTMAXMP EQU   CVTS01+128                                               03082000
CVTSTCK  EQU   CVTS01+124                                               03083000
CVTRV139 EQU   CVTS01+123                                               03084000
CVTDSSAC EQU   CVTS01+122                                               03085000
CVTRV513 EQU   CVTS01+121                                               03086000
CVTIOSPL EQU   CVTS01+120                                               03087000
CVTPTGT  EQU   CVTS01+116                                               03088000
CVTCSPIE EQU   CVTS01+112                                               03089000
CVTSMFEX EQU   CVTS01+108                                               03090000
CVTOLT0A EQU   CVTS01+104                                               03091000
CVTSRBRT EQU   CVTS01+100                                               03092000
CVTPUTL  EQU   CVTS01+96                                                03093000
CVTRV519 EQU   CVTS01+92                                                03094000
CVTRV327 EQU   CVTS01+88                                                03095000
CVTRV326 EQU   CVTS01+84                                                03096000
CVTRV325 EQU   CVTS01+80                                                03097000
CVTRV324 EQU   CVTS01+76                                                03098000
CVT0VL01 EQU   CVTS01+72                                                03099000
CVTSHRVM EQU   CVTS01+68                                                03100000
CVTRV332 EQU   CVTS01+64                                                03101000
CVTTAS   EQU   CVTS01+60                                                03102000
CVTRSCN  EQU   CVTS01+56                                                03103000
CVTTRAC2 EQU   CVTS01+54                                                03104000
CVTTRACE EQU   CVTS01+52                                                03105000
CVTAPG   EQU   CVTS01+51                                                03106000
CVTSDTRC EQU   CVTCTLFG                                                 03107000
CVTGTRCE EQU   CVTCTLFG                                                 03108000
CVTNOMP  EQU   CVTCTLFG                                                 03109000
CVTRSV79 EQU   CVTCTLFG                                                 03110000
CVTDSTAT EQU   CVTCTLFG                                                 03111000
CVTRSV78 EQU   CVTCTLFG                                                 03112000
CVTRV333 EQU   CVTCTLFG                                                 03113000
CVTRV323 EQU   CVTCTLFG                                                 03114000
CVTSPVLK EQU   CVTS01+49                                                03115000
CVTRSV77 EQU   CVTS01+48                                                03116000
CVTRV331 EQU   CVTS01+44                                                03117000
CVTRV330 EQU   CVTS01+40                                                03118000
CVTRV329 EQU   CVTS01+36                                                03119000
CVTRV328 EQU   CVTS01+32                                                03120000
CVTRV322 EQU   CVTS01+28                                                03121000
CVTSLID  EQU   CVTSLIDA+1                                               03122000
CVTSYLK  EQU   CVTSLIDA                                                 03123000
CVTRV321 EQU   CVTS01+20                                                03124000
CVTRV320 EQU   CVTS01+16                                                03125000
CVTLPDIR EQU   CVTLPDIA+1                                               03126000
CVTRSV69 EQU   CVTDIRST                                                 03127000
CVTRSV68 EQU   CVTDIRST                                                 03128000
CVTRSV67 EQU   CVTDIRST                                                 03129000
CVTRSV66 EQU   CVTDIRST                                                 03130000
CVTRSV65 EQU   CVTDIRST                                                 03131000
CVTRSV64 EQU   CVTDIRST                                                 03132000
CVTRSV63 EQU   CVTDIRST                                                 03133000
CVTDICOM EQU   CVTDIRST                                                 03134000
CVTPVTP  EQU   CVTS01+8                                                 03135000
CVTLPDSR EQU   CVTS01+4                                                 03136000
CVTGETL  EQU   CVTS01                                                   03137000
NEWCLLEN EQU   NEWCLPDE+4                                               03138000
NEXTJOB  EQU   JOBNPDE+16                                               03139000
@NM00030 EQU   JOBNPDE+14                                               03140000
@NM00029 EQU   JOBNPDE+6                                                03141000
CPPLPSCB EQU   CPPL+8                                                   03142000
CPPLCBUF EQU   CPPL                                                     03143000
RPLERMSA EQU   RPLCOMN+72                                               03144000
RPLEMLEN EQU   RPLCOMN+70                                               03145000
RPLACTIV EQU   RPLCOMN+69                                               03146000
RPLBRANC EQU   RPLEXTD1                                                 03147000
RPLNIB   EQU   RPLEXTD1                                                 03148000
@NM00028 EQU   RPLEXTD1                                                 03149000
RPLEXIT  EQU   RPLEXTD1                                                 03150000
RPLNEXIT EQU   RPLEXTD1                                                 03151000
RPLEXSCH EQU   RPLEXTD1                                                 03152000
RPLDDDD  EQU   RPL6RBA+2                                                03153000
RPLS2S2  EQU   RPL6RBA                                                  03154000
RPLS1S1  EQU   RPLRBAR                                                  03155000
RPLRSV88 EQU   RPLOPT8                                                  03156000
RPLUNCON EQU   RPLOPT8                                                  03157000
RPLACTV  EQU   RPLOPT8                                                  03158000
RPLSESS  EQU   RPLOPT8                                                  03159000
RPLPEND  EQU   RPLOPT8                                                  03160000
RPLODPRM EQU   RPLOPT8                                                  03161000
RPLODACP EQU   RPLOPT8                                                  03162000
RPLODACQ EQU   RPLOPT8                                                  03163000
RPLRSV78 EQU   RPLOPT7                                                  03164000
RPLRSV77 EQU   RPLOPT7                                                  03165000
RPLRLSOP EQU   RPLOPT7                                                  03166000
RPLTPOST EQU   RPLOPT7                                                  03167000
RPLQOPT  EQU   RPLOPT7                                                  03168000
RPLCNIMM EQU   RPLCNOPT                                                 03169000
RPLCNANY EQU   RPLCNOPT                                                 03170000
RPLCNALL EQU   RPLCNOPT                                                 03171000
RPLRSV68 EQU   RPLOPT6                                                  03172000
RPLRSV67 EQU   RPLOPT6                                                  03173000
RPLLOCK  EQU   RPLOPT6                                                  03174000
RPLNCOND EQU   RPLOPT6                                                  03175000
RPLCOND  EQU   RPLOPT6                                                  03176000
RPLEOT   EQU   RPLUNTYP                                                 03177000
RPLEOM   EQU   RPLUNTYP                                                 03178000
RPLEOB   EQU   RPLUNTYP                                                 03179000
RPLWROPT EQU   RPLOPT5                                                  03180000
RPLNODE  EQU   RPLOPT5                                                  03181000
RPLERACE EQU   RPLWRTYP                                                 03182000
RPLEAU   EQU   RPLWRTYP                                                 03183000
RPLNERAS EQU   RPLWRTYP                                                 03184000
RPLPSOPT EQU   RPLOPT5                                                  03185000
RPLSSNIN EQU   RPLOPT5                                                  03186000
RPLDLGIN EQU   RPLOPT5                                                  03187000
RPLRLEN  EQU   RPLCOMN+48                                               03188000
RPLCHAIN EQU   RPLNXTRP                                                 03189000
RPLOPT4  EQU   RPLOPTCD+3                                               03190000
RPLALIGN EQU   RPLOPT3                                                  03191000
RPLFMT   EQU   RPLOPT3                                                  03192000
RPLFLD   EQU   RPLOPT3                                                  03193000
RPLVFY   EQU   RPLOPT3                                                  03194000
RPLBLK   EQU   RPLOPT3                                                  03195000
RPLSFORM EQU   RPLOPT3                                                  03196000
RPLEODS  EQU   RPLOPT3                                                  03197000
RPLNSP   EQU   RPLOPT2                                                  03198000
RPLUPD   EQU   RPLOPT2                                                  03199000
@NM00027 EQU   RPLOPT2                                                  03200000
RPLCNV   EQU   RPLOPT2                                                  03201000
RPLADD   EQU   RPLADR                                                   03202000
RPLKEY   EQU   RPLOPT2                                                  03203000
RPLECBIN EQU   RPLECBSW                                                 03204000
RPLGEN   EQU   RPLOPT1                                                  03205000
RPLKGE   EQU   RPLOPT1                                                  03206000
RPLASY   EQU   RPLOPT1                                                  03207000
RPLSKP   EQU   RPLOPT1                                                  03208000
RPLSEQ   EQU   RPLOPT1                                                  03209000
RPLDIR   EQU   RPLOPT1                                                  03210000
RPLLOC   EQU   RPLOPT1                                                  03211000
RPLDAF   EQU   RPLARG+2                                                 03212000
RPLSAF   EQU   RPLARG                                                   03213000
RPLTCBPT EQU   RPLCOMN+28                                               03214000
RPLCCHAR EQU   RPLCOMN+20                                               03215000
RPLSTRID EQU   RPLCOMN+18                                               03216000
RPLKEYL  EQU   RPLKEYLE                                                 03217000
RPLRDSOH EQU   RPLFDB3                                                  03218000
RPLRLG   EQU   RPLFDB3                                                  03219000
RPLLGFRC EQU   RPLFDB3                                                  03220000
RPLREOT  EQU   RPLFDB3                                                  03221000
RPLREOM  EQU   RPLFDB3                                                  03222000
RPLREOB  EQU   RPLFDB3                                                  03223000
RPLSV32  EQU   RPLFDB3                                                  03224000
RPLUINPT EQU   RPLFDB3                                                  03225000
RPLSTSAV EQU   RPLFDB2                                                  03226000
RPLCUERR EQU   RPLFDB2                                                  03227000
RPLDLGFL EQU   RPLFDB2                                                  03228000
RPLIOERR EQU   RPLFDB2                                                  03229000
RPLDVUNS EQU   RPLFDB2                                                  03230000
RPLATND  EQU   RPLFDB2                                                  03231000
RPLRVID  EQU   RPLFDB2                                                  03232000
RPLERLK  EQU   RPLFDB2                                                  03233000
RPLERREG EQU   RPLRTNCD                                                 03234000
RPLSTAT  EQU   RPLCOMN+12                                               03235000
RPLPOST  EQU   RPLECB                                                   03236000
RPLWAIT  EQU   RPLECB                                                   03237000
RPLPLHPT EQU   RPLCOMN+4                                                03238000
RPLLEN2  EQU   RPLLEN                                                   03239000
RPLREQ   EQU   RPLIDWD+2                                                03240000
RPLSTYP  EQU   RPLIDWD+1                                                03241000
RPLID    EQU   RPLIDWD                                                  03242000
ACBAPID  EQU   ACBCOMN+72                                               03243000
ACBCBMWA EQU   ACBCOMN+68                                               03244000
ACBUAPTR EQU   ACBCOMN+64                                               03245000
ACBBLKSZ EQU   ACBCOMN+60                                               03246000
ACBBUFSP EQU   ACBCOMN+56                                               03247000
@NM00026 EQU   ACBWAPTR+1                                               03248000
ACBOPTN  EQU   ACBWAPTR                                                 03249000
ACBVVIC  EQU   ACBINFLG                                                 03250000
@NM00025 EQU   ACBINFLG                                                 03251000
ACBCAT   EQU   ACBINFLG                                                 03252000
ACBIJRQE EQU   ACBINFLG                                                 03253000
ACBJEPS  EQU   ACBINFLG                                                 03254000
@NM00024 EQU   ACBINFLG                                                 03255000
ACBERFLG EQU   ACBCOMN+49                                               03256000
ACBBUSY  EQU   ACBIOSFG                                                 03257000
ACBLOCK  EQU   ACBEXFG                                                  03258000
@NM00023 EQU   ACBOFLGS                                                 03259000
ACBDSERR EQU   ACBOFLGS                                                 03260000
ACBEOV   EQU   ACBOFLGS                                                 03261000
@NM00022 EQU   ACBOFLGS                                                 03262000
ACBDEB   EQU   ACBDDNM+5                                                03263000
ACBERFL  EQU   ACBDDNM+4                                                03264000
ACBAM    EQU   ACBAMETH                                                 03265000
ACBINFL  EQU   ACBDDNM+2                                                03266000
ACBTIOT  EQU   ACBDDNM                                                  03267000
ACBUEL   EQU   ACBEXLST                                                 03268000
ACBPASSW EQU   ACBCOMN+32                                               03269000
@NM00021 EQU   ACBCOMN+28                                               03270000
@NM00020 EQU   ACBDSORG+1                                               03271000
ACBDORGA EQU   ACBDSORG+1                                               03272000
@NM00019 EQU   ACBDSORG                                                 03273000
ACBCRNRE EQU   ACBCROPS                                                 03274000
ACBCRNCK EQU   ACBCROPS                                                 03275000
ACBASA   EQU   ACBCCTYP                                                 03276000
@NM00018 EQU   ACBCCTYP                                                 03277000
ACBRECAF EQU   ACBRECFM                                                 03278000
ACBJBUF  EQU   ACBBUFPL+2                                               03279000
@NM00017 EQU   ACBBUFPL                                                 03280000
ACBBUFNI EQU   ACBCOMN+18                                               03281000
ACBBUFND EQU   ACBCOMN+16                                               03282000
ACBSTRNO EQU   ACBCOMN+14                                               03283000
@NM00016 EQU   ACBMACR2                                                 03284000
ACBLOGON EQU   ACBMACR2                                                 03285000
ACBSKP   EQU   ACBMACR2                                                 03286000
ACBCHN   EQU   ACBMACR2                                                 03287000
ACBCBRD  EQU   ACBMACR2                                                 03288000
ACBCBOPN EQU   ACBMACR2                                                 03289000
ACBUBF   EQU   ACBMACR1                                                 03290000
ACBOUT   EQU   ACBMACR1                                                 03291000
ACBIN    EQU   ACBMACR1                                                 03292000
ACBDIR   EQU   ACBMACR1                                                 03293000
ACBSEQ   EQU   ACBMACR1                                                 03294000
ACBBLK   EQU   ACBCNV                                                   03295000
ACBADD   EQU   ACBADR                                                   03296000
ACBKEY   EQU   ACBMACR1                                                 03297000
ACBINRTN EQU   ACBCOMN+8                                                03298000
ACBIBCT  EQU   ACBJWA                                                   03299000
ACBLEN2  EQU   ACBLENG2                                                 03300000
ACBSTYP  EQU   ACBCOMN+1                                                03301000
ACBID    EQU   ACBCOMN                                                  03302000
S99TUPRM EQU   S99TUFLD+2                                               03303000
S99TULEN EQU   S99TUFLD                                                 03304000
S99TUPND EQU   S99TUP                                                   03305000
SSSODSID EQU   SSSO+112                                                 03306000
SSSOWTRC EQU   SSSO+108                                                 03307000
SSSOFORM EQU   SSSO+96                                                  03308000
SSSOPGMN EQU   SSSO+36                                                  03309000
@NM00015 EQU   SSSO+25                                                  03310000
SSSOCOPY EQU   SSSO+6                                                   03311000
@NM00014 EQU   SSSOFLG2                                                 03312000
@NM00013 EQU   SSSOFLG1                                                 03313000
SSSOSFRM EQU   SSSOFLG1                                                 03314000
SSSOSPGM EQU   SSSOFLG1                                                 03315000
SSSOSDST EQU   SSSOFLG1                                                 03316000
@NM00012 EQU   SSSO+3                                                   03317000
@NM00011 EQU   SSSOUFLG                                                 03318000
SSOBSSIB EQU   SSOB+8                                                   03319000
SSOBLEN  EQU   SSOB+4                                                   03320000
SSOBID   EQU   SSOB                                                     03321000
JESPJESN EQU   JESCT+28                                                 03322000
JESSSCT  EQU   JESCT+24                                                 03323000
JESRESQM EQU   JESCT+16                                                 03324000
JESQMGR  EQU   JESCT+12                                                 03325000
JESUNITS EQU   JESCT+4                                                  03326000
@NM00010 EQU   JESCT                                                    03327000
CVTLEVL  EQU   CVTRELNO+2                                               03328000
CVTNUMB  EQU   CVTRELNO                                                 03329000
CVTMDL   EQU   CVTFIX+250                                               03330000
@NM00009 EQU   CVTFIX+248                                               03331000
@NM00008 EQU   CVTFIX                                                   03332000
CVTRV482 EQU   CVTXTNT2+128                                             03333000
CVTRV481 EQU   CVTXTNT2+124                                             03334000
CVTRV480 EQU   CVTXTNT2+120                                             03335000
CVTRV479 EQU   CVTXTNT2+118                                             03336000
CVTRV478 EQU   CVTXTNT2+117                                             03337000
CVTRV477 EQU   CVTXTNT2+116                                             03338000
CVTRV476 EQU   CVTXTNT2+115                                             03339000
CVTRV475 EQU   CVTXTNT2+114                                             03340000
CVTRV474 EQU   CVTRV466                                                 03341000
CVTRV473 EQU   CVTRV466                                                 03342000
CVTRV472 EQU   CVTRV466                                                 03343000
CVTRV471 EQU   CVTRV466                                                 03344000
CVTRV470 EQU   CVTRV466                                                 03345000
CVTRV469 EQU   CVTRV466                                                 03346000
CVTRV468 EQU   CVTRV466                                                 03347000
CVTRV467 EQU   CVTRV466                                                 03348000
CVTRV465 EQU   CVTRV457                                                 03349000
CVTRV464 EQU   CVTRV457                                                 03350000
CVTRV463 EQU   CVTRV457                                                 03351000
CVTRV462 EQU   CVTRV457                                                 03352000
CVTRV461 EQU   CVTRV457                                                 03353000
CVTRV460 EQU   CVTRV457                                                 03354000
CVTRV459 EQU   CVTRV457                                                 03355000
CVTRV458 EQU   CVTRV457                                                 03356000
CVTRV456 EQU   CVTXTNT2+108                                             03357000
CVTRV455 EQU   CVTXTNT2+104                                             03358000
CVTRV454 EQU   CVTXTNT2+100                                             03359000
CVTRV453 EQU   CVTXTNT2+96                                              03360000
CVTRV452 EQU   CVTXTNT2+94                                              03361000
CVTRV451 EQU   CVTXTNT2+92                                              03362000
CVTRV450 EQU   CVTXTNT2+90                                              03363000
CVTRV449 EQU   CVTXTNT2+88                                              03364000
CVTRV448 EQU   CVTXTNT2+87                                              03365000
CVTRV447 EQU   CVTXTNT2+86                                              03366000
CVTRV446 EQU   CVTRV438                                                 03367000
CVTRV445 EQU   CVTRV438                                                 03368000
CVTRV444 EQU   CVTRV438                                                 03369000
CVTRV443 EQU   CVTRV438                                                 03370000
CVTRV442 EQU   CVTRV438                                                 03371000
CVTRV441 EQU   CVTRV438                                                 03372000
CVTRV440 EQU   CVTRV438                                                 03373000
CVTRV439 EQU   CVTRV438                                                 03374000
CVTRV437 EQU   CVTRV429                                                 03375000
CVTRV436 EQU   CVTRV429                                                 03376000
CVTRV435 EQU   CVTRV429                                                 03377000
CVTRV434 EQU   CVTRV429                                                 03378000
CVTRV433 EQU   CVTRV429                                                 03379000
CVTRV432 EQU   CVTRV429                                                 03380000
CVTRV431 EQU   CVTRV429                                                 03381000
CVTRV430 EQU   CVTRV429                                                 03382000
CVTRV428 EQU   CVTXTNT2+80                                              03383000
CVTRV427 EQU   CVTXTNT2+76                                              03384000
CVTRV426 EQU   CVTXTNT2+72                                              03385000
CVTRV425 EQU   CVTXTNT2+68                                              03386000
CVTATACT EQU   CVTATCVT                                                 03387000
CVTRV423 EQU   CVTXTNT2+62                                              03388000
CVTRV422 EQU   CVTXTNT2+60                                              03389000
CVTRV421 EQU   CVTXTNT2+58                                              03390000
CVTRV420 EQU   CVTXTNT2+56                                              03391000
CVTRV419 EQU   CVTXTNT2+55                                              03392000
CVTRV418 EQU   CVTXTNT2+54                                              03393000
CVTRV417 EQU   CVTRV409                                                 03394000
CVTRV416 EQU   CVTRV409                                                 03395000
CVTRV415 EQU   CVTRV409                                                 03396000
CVTRV414 EQU   CVTRV409                                                 03397000
CVTRV413 EQU   CVTRV409                                                 03398000
CVTRV412 EQU   CVTRV409                                                 03399000
CVTRV411 EQU   CVTRV409                                                 03400000
CVTRV410 EQU   CVTRV409                                                 03401000
CVTRV408 EQU   CVTRV400                                                 03402000
CVTRV407 EQU   CVTRV400                                                 03403000
CVTRV406 EQU   CVTRV400                                                 03404000
CVTRV405 EQU   CVTRV400                                                 03405000
CVTRV404 EQU   CVTRV400                                                 03406000
CVTRV403 EQU   CVTRV400                                                 03407000
CVTRV402 EQU   CVTRV400                                                 03408000
CVTRV401 EQU   CVTRV400                                                 03409000
CVTICB   EQU   CVTXTNT2+48                                              03410000
CVTSKTA  EQU   CVTXTNT2+44                                              03411000
CVTRSV99 EQU   CVTXTNT2+40                                              03412000
CVTRSV98 EQU   CVTXTNT2+36                                              03413000
CVTRSV97 EQU   CVTXTNT2+34                                              03414000
CVTRSV96 EQU   CVTXTNT2+32                                              03415000
CVTOLTEP EQU   CVTXTNT2+28                                              03416000
CVTQIDA  EQU   CVTQID+1                                                 03417000
CVTRSV95 EQU   CVTQID                                                   03418000
CVTRSV94 EQU   CVTXTNT2+20                                              03419000
CVTRSV93 EQU   CVTXTNT2+16                                              03420000
CVTRSV92 EQU   CVTXTNT2+12                                              03421000
CVTDEBVR EQU   CVTXTNT2+8                                               03422000
CVTRSV91 EQU   CVTXTNT2+6                                               03423000
CVTRSV9H EQU   CVTFLGBT                                                 03424000
CVTRSV9G EQU   CVTFLGBT                                                 03425000
CVTRSV9F EQU   CVTFLGBT                                                 03426000
CVTRSV9E EQU   CVTFLGBT                                                 03427000
CVTRSV9D EQU   CVTFLGBT                                                 03428000
CVTRSV9C EQU   CVTFLGBT                                                 03429000
CVTVME   EQU   CVTFLGBT                                                 03430000
CVTNPE   EQU   CVTFLGBT                                                 03431000
CVTNUCLS EQU   CVTXTNT2+4                                               03432000
CVTDSSVA EQU   CVTDSSV+1                                                03433000
CVTRSV89 EQU   CVTDSSV                                                  03434000
CVTRSV88 EQU   CVTXTNT1+8                                               03435000
CVTRSV87 EQU   CVTXTNT1+4                                               03436000
CVTFACHN EQU   CVTXTNT1                                                 03437000
CVTRV488 EQU   CVTMAP+412                                               03438000
CVTRV487 EQU   CVTMAP+408                                               03439000
CVTRV486 EQU   CVTMAP+404                                               03440000
CVTRV485 EQU   CVTMAP+400                                               03441000
CVTACTAP EQU   CVTMAP+396                                               03442000
CVTAUTH  EQU   CVTMAP+392                                               03443000
CVTATMCA EQU   CVTATMCT+1                                               03444000
CVTATMST EQU   CVTATMCT                                                 03445000
CVTRSV61 EQU   CVTMAP+384                                               03446000
CVTVOLT1 EQU   CVTVOLM1+1                                               03447000
CVTVOLI1 EQU   CVTVOLF1                                                 03448000
CVTSTOA  EQU   CVTMAP+376                                               03449000
CVTRSV58 EQU   CVTMAP+374                                               03450000
CVTRSV57 EQU   CVTMAP+372                                               03451000
CVTDDCE  EQU   CVTMAP+368                                               03452000
CVTPNWFR EQU   CVTMAP+364                                               03453000
CVTSMF   EQU   CVTMAP+360                                               03454000
CVTSULK  EQU   CVTMAP+358                                               03455000
CVTSLKO  EQU   CVTSYSK                                                  03456000
CVTSLKP  EQU   CVTSYSK                                                  03457000
CVTSLKQ  EQU   CVTSYSK                                                  03458000
CVTSLKR  EQU   CVTSYSK                                                  03459000
CVTRSV56 EQU   CVTSYSK                                                  03460000
CVTRSV55 EQU   CVTSYSK                                                  03461000
CVTRSV54 EQU   CVTSYSK                                                  03462000
CVTRSV53 EQU   CVTSYSK                                                  03463000
CVTRSV52 EQU   CVTA1F1                                                  03464000
CVTRSV51 EQU   CVTA1F1                                                  03465000
CVTRSV50 EQU   CVTA1F1                                                  03466000
CVTRSV49 EQU   CVTA1F1                                                  03467000
CVTRSV48 EQU   CVTA1F1                                                  03468000
CVTRSV47 EQU   CVTA1F1                                                  03469000
CVTSRSW  EQU   CVTA1F1                                                  03470000
CVTPFSW  EQU   CVTA1F1                                                  03471000
CVTPCVT  EQU   CVTMAP+352                                               03472000
CVTRSV46 EQU   CVTMAP+344                                               03473000
CVTRSV45 EQU   CVTMAP+340                                               03474000
CVTRSV44 EQU   CVTMAP+338                                               03475000
CVTRSV43 EQU   CVTMAP+336                                               03476000
CVTHJESA EQU   CVTHJES+1                                                03477000
CVTRSV42 EQU   CVTHJES                                                  03478000
CVTEXT2A EQU   CVTEXT2+1                                                03479000
CVTRSV41 EQU   CVTEXT2                                                  03480000
CVTAPFA  EQU   CVTAPF+1                                                 03481000
CVTRSV40 EQU   CVTAPF                                                   03482000
CVTRV518 EQU   CVTINTLA                                                 03483000
CVTRV517 EQU   CVTERPV                                                  03484000
CVTEORM  EQU   CVTMAP+312                                               03485000
CVTMCHPR EQU   CVTMAP+308                                               03486000
CVTTZ    EQU   CVTMAP+304                                               03487000
CVTJEPS  EQU   CVTMAP+300                                               03488000
CVTMODE  EQU   CVTMAP+292                                               03489000
CVTPTRV  EQU   CVTMAP+288                                               03490000
CVTREAL  EQU   CVTMAP+284                                               03491000
CVTRSV39 EQU   CVTMAP+280                                               03492000
CVTRSV38 EQU   CVTMAP+276                                               03493000
CVTDMSRA EQU   CVTDMSR+1                                                03494000
CVTRSV37 EQU   CVTDMSR                                                  03495000
CVTQMSGA EQU   CVTQMSG+1                                                03496000
CVTRSV36 EQU   CVTQMSG                                                  03497000
CVTAMFF  EQU   CVTMAP+264                                               03498000
CVTPURGA EQU   CVTPURG+1                                                03499000
CVTRSV35 EQU   CVTPURG                                                  03500000
CVTCBSP  EQU   CVTMAP+256                                               03501000
CVTATERA EQU   CVTATER+1                                                03502000
CVTSYST  EQU   CVTATER                                                  03503000
CVTVOLT2 EQU   CVTTAT                                                   03504000
CVTVOLI2 EQU   CVTVOLF2                                                 03505000
CVTAQAVB EQU   CVTAQAVT+1                                               03506000
CVTRSV34 EQU   CVTTCMFG                                                 03507000
CVTRSV33 EQU   CVTTCMFG                                                 03508000
CVTRSV32 EQU   CVTTCMFG                                                 03509000
CVTRSV31 EQU   CVTTCMFG                                                 03510000
CVTRSV30 EQU   CVTTCMFG                                                 03511000
CVTRSV29 EQU   CVTTCMFG                                                 03512000
CVTRSV28 EQU   CVTTCMFG                                                 03513000
CVTTCRDY EQU   CVTTCMFG                                                 03514000
CVTGTFA  EQU   CVTGTF+1                                                 03515000
CVTRSV27 EQU   CVTGTFST                                                 03516000
CVTRNIO  EQU   CVTGTFST                                                 03517000
CVTUSR   EQU   CVTGTFST                                                 03518000
CVTRV318 EQU   CVTFORM                                                  03519000
CVTRV317 EQU   CVTTMODE                                                 03520000
CVTRV316 EQU   CVTSTATE                                                 03521000
CVTRV315 EQU   CVTGTFS                                                  03522000
CVTGTFAV EQU   CVTGTFS                                                  03523000
CVT0SCR1 EQU   CVTMAP+232                                               03524000
CVTRV515 EQU   CVTMAP+228                                               03525000
CVTRMS   EQU   CVTMAP+224                                               03526000
CVTPATCH EQU   CVTMAP+220                                               03527000
CVTTSCE  EQU   CVTMAP+216                                               03528000
CVTLNKSC EQU   CVTMAP+214                                               03529000
CVTQABST EQU   CVTMAP+212                                               03530000
CVTMDLDS EQU   CVTMAP+208                                               03531000
CVTUSER  EQU   CVTMAP+204                                               03532000
CVTABEND EQU   CVTMAP+200                                               03533000
CVTSMCA  EQU   CVTMAP+196                                               03534000
CVTRSV18 EQU   CVTMAP+192                                               03535000
CVTQLPAQ EQU   CVTMAP+188                                               03536000
CVTQCDSR EQU   CVTMAP+184                                               03537000
CVTRSV17 EQU   CVTOPTB                                                  03538000
CVTRSV16 EQU   CVTOPTB                                                  03539000
CVTFP    EQU   CVTOPTB                                                  03540000
CVTAPTHR EQU   CVTOPTB                                                  03541000
CVTNLOG  EQU   CVTOPTB                                                  03542000
CVTTOD   EQU   CVTOPTB                                                  03543000
CVTCTIMS EQU   CVTOPTB                                                  03544000
CVTPROT  EQU   CVTOPTB                                                  03545000
CVTXPFP  EQU   CVTOPTA                                                  03546000
CVTASCII EQU   CVTOPTA                                                  03547000
CVTRSV13 EQU   CVTOPTA                                                  03548000
CVTRSV12 EQU   CVTOPTA                                                  03549000
CVTNIP   EQU   CVTOPTA                                                  03550000
CVTDDR   EQU   CVTOPTA                                                  03551000
CVTAPR   EQU   CVTOPTA                                                  03552000
CVTCCH   EQU   CVTOPTA                                                  03553000
CVTSNCTR EQU   CVTMAP+180                                               03554000
CVTQMWR  EQU   CVTMAP+176                                               03555000
CVTQOCR  EQU   CVTMAP+172                                               03556000
CVT1EF00 EQU   CVTMAP+168                                               03557000
CVTMZ00  EQU   CVTMAP+164                                               03558000
CVTHEAD  EQU   CVTMAP+160                                               03559000
CVTRSV11 EQU   CVTMAP+156                                               03560000
CVT0PT01 EQU   CVTMAP+152                                               03561000
CVTMSER  EQU   CVTMAP+148                                               03562000
CVTRV516 EQU   CVTIERLC                                                 03563000
CVTILCH  EQU   CVTMAP+140                                               03564000
CVT0DS   EQU   CVTMAP+136                                               03565000
CVTFBOSV EQU   CVTMAP+132                                               03566000
CVTNUCB  EQU   CVTMAP+128                                               03567000
CVTIXAVL EQU   CVTMAP+124                                               03568000
CVTIOQET EQU   CVTMAP+120                                               03569000
CVTDCBA  EQU   CVTMAP+117                                               03570000
CVTMVS2  EQU   CVTDCB                                                   03571000
CVT6DAT  EQU   CVTDCB                                                   03572000
CVT4MPS  EQU   CVTDCB                                                   03573000
CVTRSV09 EQU   CVTDCB                                                   03574000
CVT4MS1  EQU   CVTDCB                                                   03575000
CVT2SPS  EQU   CVTDCB                                                   03576000
CVT1SSS  EQU   CVTDCB                                                   03577000
CVTRSV08 EQU   CVTDCB                                                   03578000
CVTSTB   EQU   CVTMAP+112                                               03579000
CVTQTD00 EQU   CVTMAP+108                                               03580000
CVTQTE00 EQU   CVTMAP+104                                               03581000
CVTCUCB  EQU   CVTMAP+100                                               03582000
CVTSJQ   EQU   CVTMAP+96                                                03583000
CVTPBLDL EQU   CVTMAP+92                                                03584000
CVTTPC   EQU   CVTMAP+88                                                03585000
CVTSVDCB EQU   CVTMAP+84                                                03586000
CVTBRET  EQU   CVTMAP+82                                                03587000
CVTEXIT  EQU   CVTMAP+80                                                03588000
CVT0FN00 EQU   CVTMAP+76                                                03589000
CVTDARA  EQU   CVTDAR+1                                                 03590000
CVTRSV07 EQU   CVTFLGS1                                                 03591000
CVTRSV06 EQU   CVTFLGS1                                                 03592000
CVTRSV05 EQU   CVTFLGS1                                                 03593000
CVTRSV04 EQU   CVTFLGS1                                                 03594000
CVTRSV03 EQU   CVTFLGS1                                                 03595000
CVTRSV02 EQU   CVTFLGS1                                                 03596000
CVTRSV01 EQU   CVTFLGS1                                                 03597000
CVTDMPLK EQU   CVTFLGS1                                                 03598000
CVTXITP  EQU   CVTMAP+68                                                03599000
CVTZDTAB EQU   CVTMAP+64                                                03600000
CVTMSLT  EQU   CVTMAP+60                                                03601000
CVTDATE  EQU   CVTMAP+56                                                03602000
CVTBTERM EQU   CVTMAP+52                                                03603000
CVTSYSAD EQU   CVTMAP+48                                                03604000
CVTXTLER EQU   CVTMAP+44                                                03605000
CVTILK2  EQU   CVTMAP+40                                                03606000
CVTILK1  EQU   CVTMAP+36                                                03607000
CVTPRLTV EQU   CVTMAP+32                                                03608000
CVTPCNVT EQU   CVTMAP+28                                                03609000
CVT0VL00 EQU   CVTMAP+24                                                03610000
CVTXAPG  EQU   CVTMAP+20                                                03611000
CVTBUF   EQU   CVTMAP+16                                                03612000
CVTJOB   EQU   CVTMAP+12                                                03613000
CVTLINK  EQU   CVTMAP+8                                                 03614000
CVT0EF00 EQU   CVTMAP+4                                                 03615000
CVTTCBP  EQU   CVTMAP                                                   03616000
CVT      EQU   CVTMAP                                                   03617000
EWAPTR   EQU   OUTCOMTB+288                                             03618000
OSVDSPDE EQU   OUTCOMTB+284                                             03619000
OUTCLPDE EQU   OUTCOMTB+280                                             03620000
OPRDSPDE EQU   OUTPLIST+4                                               03621000
OUTCPDE1 EQU   OUTPLIST                                                 03622000
OUTWORK  EQU   OUTCOMTB+196                                             03623000
OUTSTAE  EQU   OUTCOMTB+188                                             03624000
OUTSBPDL EQU   OUTCOMTB+180                                             03625000
OHELPECB EQU   OUTCOMTB+176                                             03626000
OUTTCBH  EQU   OUTCOMTB+172                                             03627000
OUTXRPLY EQU   OUTCOMTB+168                                             03628000
OUTSYNMS EQU   OUTXMSG                                                  03629000
OUTPDL   EQU   OUTCOMTB+160                                             03630000
OUTDAIR  EQU   OUTCOMTB+156                                             03631000
@NM00007 EQU   OUTIDSSW                                                 03632000
@NM00006 EQU   OUTIDSSW                                                 03633000
@NM00005 EQU   OUTIDSSW                                                 03634000
NONTERM  EQU   OUTSW+1                                                  03635000
UNALCALL EQU   OUTSW                                                    03636000
SUBCMODE EQU   OUTSW                                                    03637000
NEXT     EQU   OUTKEYWD                                                 03638000
OUTRECL  EQU   OUTCOMTB+144                                             03639000
OUTRECA  EQU   OUTCOMTB+140                                             03640000
OUTBUFL  EQU   @NM00002+2                                               03641000
OUTRECUN EQU   @NM00002+1                                               03642000
NOMEMNAM EQU   @NM00002+1                                               03643000
NEWDS    EQU   @NM00002+1                                               03644000
NEEDFREE EQU   @NM00002+1                                               03645000
OUTRECV  EQU   @NM00002+1                                               03646000
DSOPEN   EQU   @NM00002+1                                               03647000
DSALLOC  EQU   @NM00002+1                                               03648000
@NM00004 EQU   @NM00002+1                                               03649000
@NM00003 EQU   @NM00002                                                 03650000
OUTBUFA  EQU   O73PARM+12                                               03651000
PRINTDDN EQU   O73PARM+4                                                03652000
OUTDCB   EQU   O73PARM                                                  03653000
STRCTNUM EQU   OUTCOMTB+96                                              03654000
OUTEMPMN EQU   OUTCOMTB+32                                              03655000
OUTEXTRA EQU   OUTCOMTB+28                                              03656000
@NM00001 EQU   OUTATTN                                                  03657000
OUTCMDNM EQU   OUTCOMTB+16                                              03658000
OUTMACN  EQU   OUTCOMTB+8                                               03659000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03660000
@RC00136 EQU   @EL00002                                                 03661000
@RC00134 EQU   @EL00002                                                 03662000
@RC00154 EQU   @EL00002                                                 03663000
@RC00166 EQU   @EL00003                                                 03664000
@RC00322 EQU   @EL00004                                                 03665000
@RC00384 EQU   @EL00006                                                 03666000
@RC00426 EQU   @EL00007                                                 03667000
@RC00491 EQU   @EL00008                                                 03668000
@RC00477 EQU   @EL00008                                                 03669000
@RC00463 EQU   @EL00008                                                 03670000
@RC00453 EQU   @EL00008                                                 03671000
@RC00446 EQU   @EL00008                                                 03672000
@RC00503 EQU   @EL00009                                                 03673000
@RC00508 EQU   @EL00009                                                 03674000
@PB00011 EQU   @EL00005                                                 03675000
@RC00640 EQU   @EL00012                                                 03676000
@RC00668 EQU   @EL00013                                                 03677000
@RC00257 EQU   @RC00166                                                 03678000
@RC00251 EQU   @RC00166                                                 03679000
@RC00245 EQU   @RC00166                                                 03680000
@RC00239 EQU   @RC00166                                                 03681000
@RC00231 EQU   @RC00166                                                 03682000
@RC00206 EQU   @RC00166                                                 03683000
@RC00176 EQU   @RC00166                                                 03684000
@RC00168 EQU   @RC00166                                                 03685000
@RC00387 EQU   @RC00384                                                 03686000
@RC00385 EQU   @RC00384                                                 03687000
@RC00449 EQU   @RC00446                                                 03688000
@RC00482 EQU   @RC00477                                                 03689000
@RC00495 EQU   @RC00491                                                 03690000
@RC00533 EQU   @RC00508                                                 03691000
@RC00528 EQU   @RC00508                                                 03692000
@RC00518 EQU   @RC00508                                                 03693000
@RC00514 EQU   @RC00508                                                 03694000
@PB00010 EQU   @PB00011                                                 03695000
@RC00172 EQU   @RC00168                                                 03696000
@RC00198 EQU   @RC00176                                                 03697000
@RC00192 EQU   @RC00176                                                 03698000
@RC00178 EQU   @RC00176                                                 03699000
@RC00208 EQU   @RC00206                                                 03700000
@RC00485 EQU   @RC00482                                                 03701000
@PB00009 EQU   @PB00010                                                 03702000
@RC00185 EQU   @RC00178                                                 03703000
@RC00179 EQU   @RC00178                                                 03704000
@PB00008 EQU   @PB00009                                                 03705000
@PB00007 EQU   @PB00008                                                 03706000
@PB00006 EQU   @PB00007                                                 03707000
@RC00345 EQU   @PB00006                                                 03708000
@ENDDATA EQU   *                                                        03709000
         END   IKJCT462,(C'PLS2038',0603,74364)                         03710000
