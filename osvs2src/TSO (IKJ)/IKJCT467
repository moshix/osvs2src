*/*                                                                     00011002
*/*/******************************************************************* 00059902
*/**/                                                                   00100302
         TITLE     'IKJCT467     OUTPUT MESSAGE HANDLER'                00150302
*/*MODULE NAME= IKJCT467                                             */ 00200302
*/*  CSECT NAME= IKJCT467                                            */ 00250302
*/*              IKJCT4MC (MESSAGE CSECT)                            */ 00300302
*/*DESCRIPTIVE NAME= MESSAGE PROCESSOR                               */ 00350302
*/*COPYRIGHT = NONE                                                  */ 00400302
*/*STATUS= CHANGE LEVEL 00                                           */ 00450302
*/*                                                                  */ 00500302
*/*FUNCTION= TO DETERMINE THE APPROPRIATE MESSAGE WHICH THE CALLER   */ 00550302
*/*          DESIRES AND WRITE IT TO THE TERMINAL USER.              */ 00600302
*/*  OPERATION= SET UP TO PRINT MESSAGE REQUESTED.                   */ 00650302
*/*             IF SERVICE ROUTINE ERROR, DO FURTHER ANALYSIS OF     */ 00700302
*/*               RETURN CODE TO CHOOSE APPROPRIATE MESSAGE.         */ 00750302
*/*                                                                  */ 00800302
*/*NOTES=                                                            */ 00850302
*/*  DEPENDENCIES= 1. PSCB CAN BE ACCESSED ONLY IF CALLER IN PP      */ 00900302
*/*                     KEY. THE PSCB IS NEEDED TO OBTAIN THE        */ 00950302
*/*                     USERID FOR A MSG.                            */ 01000302
*/*                2. MESSAGES CAN HAVE UP TO 3 INSERTS. IF MORE     */ 01050302
*/*                     ARE NEEDED, THE FOLLOWING CHANGES ARE        */ 01100302
*/*                     NECESSARY:                                   */ 01150302
*/*                       A.  CODE SIMILAR TO THAT OF LABELS         */ 01200302
*/*                           SEGMENT2, SEGMENT3, AND SEGMENT4       */ 01250302
*/*                           MUST BE ADDED FOR EACH NEW INSERT.     */ 01300302
*/*                       B.  ADD A PTR AND SEGMENT TO THE 'OLDMAP'  */ 01350302
*/*                           DSECT AND INCREASE THE SIZE OF         */ 01400302
*/*                           SAVOUTL1 AND SAVOUTL2 WHICH IT MAPS.   */ 01450302
*/*                       C.  ADD NECESSARY INSERTS TO THE 'MSGCHAR' */ 01500302
*/*                           DSECT AND ADD A HEX BYTE TO EACH ENTRY */ 01550302
*/*                           IN THE MGCHAR TABLE WHICH IT MAPS.     */ 01600302
*/*                       D.  ADD AN ENTRY IN THE BRANCH TABLE       */ 01650302
*/*                           'BRTABVI', DOCUMENT THE OFFSET, AND    */ 01700302
*/*                           ADD A ROUTINE TO RETRIEVE THE INSERT.  */ 01750302
*/*                3. THE BASIC MESSAGE SEGMENT MUST NOT EXCEED      */ 01800302
*/*                     A LENGTH OF 88 BYTES AND THE INSERTS MUST    */ 01850302
*/*                     NOT EXCEED 48 BYTES. IF IT IS NECESSARY      */ 01900302
*/*                     TO HAVE A LARGER SEGMENT THE  'OLDMAP'       */ 01950302
*/*                     DSECT MUST BE INCREASED AND THE SIZE OF      */ 02000302
*/*                     SAVOUTL1 AND SAVOUTL2 WHICH IT MAPS.         */ 02050302
*/*                           NOTE:  IF THE INSTALLATION EXIT MSG IS */ 02100302
*/*                                  USED AS AN INSERT AND EXCEEDS   */ 02150302
*/*                                  44 CHARACTERS, THE EXCESS IS    */ 02200302
*/*                                  TRUNCATED.                      */ 02250302
*/*    CHARACTER-CODE DEPENDENCIES= EBCDIC CHARACTER SET USED.       */ 02300302
*/*                                 REASSEMBLE IF ANOTHER CHAR SET   */ 02350302
*/*                                 DESIRED.                         */ 02400302
*/*  RESTRICTIONS=                                                   */ 02450302
*/*  REGISTER CONVENTIONS= REGISTERS ARE DEFINED UNDER THE           */ 02500302
*/*                        HEADING 'REGISTERS'                       */ 02550302
*/*  PATCH LABEL= PATCH67                                            */ 02600302
*/*                                                                  */ 02650302
*/*MODULE TYPE=                                                      */ 02700302
*/*  PROCESSOR= BAL                                                  */ 02750302
*/*  MODULE SIZE= 5800 BYTES                                         */ 02800302
*/*  ATTRIBUTES= REENTRANT, REFRESHABLE, REUSABLE                    */ 02850302
*/*              KEY/STATE DEPENDS ON CALLER:                        */ 02900302
*/*                PROB PROG KEY - PROB PROG STATE                   */ 02950302
*/*                SCHED KEY 1 - SUPERVISOR STATE                    */ 03000302
*/*                SUPR KEY 0 - SUPERVISOR STATE                     */ 03050302
*/*                                                                  */ 03100302
*/*ENTRY POINT= IKJCT467                                             */ 03150302
*/*  PURPOSE= MAIN ENTRY TO ISSUE MESSAGES                           */ 03200302
*/*  LINKAGE= STANDARD                                               */ 03250302
*/*  INPUT= REG 1 HAS ADDRESS OF OUTCOMTB POINTER                    */ 03300302
*/*  OUTPUT= THE REQUESTED MESSAGE IS ISSUED                         */ 03350302
*/*  REGISTERS SAVED= ALL                                            */ 03400302
*/*  REGISTER USAGE= SEE SECTION LABELED 'REGISTERS'                 */ 03450302
*/*  REGISTERS RESTORED= ALL BUT 15                                  */ 03500302
*/*                                                                  */ 03550302
*/*EXIT - NORMAL=                                                    */ 03600302
*/*  CONDITIONS= MESSAGE HAS BEEN ISSUED                             */ 03650302
*/*  OUTPUT= A MESSAGE                                               */ 03700302
*/*  RETURN CODES= 0                                                 */ 03750302
*/*                                                                  */ 03800302
*/*EXIT - ERROR= NONE                                                */ 03850302
*/*                                                                  */ 03900302
*/*EXTERNAL REFERENCES= IKJCT4MC - MESSAGE CSECT                     */ 03950302
*/*  ROUTINES= IKJEFF18 (DAIRFAIL)                                   */ 04000302
*/*            IKJEFF19 (VSAMFAIL)                                   */ 04050302
*/*  DATA AREAS= OUTCOMTB (R,W) - COMMUNICATION TABLE FOR ALL OUTPUT */ 04100302
*/*                OUTMSGID, OUTRTCD, OUTCPPL, IOPL, OUTCMDNM,       */ 04150302
*/*                OUTWORK, OUTJBPDE, OSVDSPDE, OPRDSPDE, CLASBUFF,  */ 04200302
*/*                OUTSOBH, OUTSOBSO, OUTSBBUF, OUTMACN, OUTXMSG,    */ 04250302
*/*                OUTXRPLY, OUTDARB, OUTDAIR, OUTFLAGS(KEY1),       */ 04300302
*/*                OUTSW(ERROR,SUBCMODE), OUTSW2(NONTERM)            */ 04350302
*/*  CONTROL BLOCKS= IOPL (W) - INPUT OUTPUT PARAMETER LIST          */ 04400302
*/*                    INTERFACE WITH THE I/O SERVICE RTNS FOR       */ 04450302
*/*                    PUTLINE AND PUTGET.                           */ 04500302
*/*                  PGPB (C-R) - PUTGET PARAMETER BLOCK             */ 04550302
*/*                    PICKUP THE USER'S RESPONSE (INPUT BUFFER)     */ 04600302
*/*                    TO A PUTGET MODE OR PUTGET PROMPT.            */ 04650302
*/*                  CPPL (R) - CMD PROCESSOR PARM LIST USED TO      */ 04700302
*/*                    LOCATE PSCB AND GET ADDRESSES TO BUILD IOPL   */ 04750302
*/*                  PSCB (R) - PROTECTED STEP CTL BLK USED TO OBTAIN*/ 04800302
*/*                    USERID                                        */ 04850302
*/*                  SSOB (R) - SUBSYSTEM OPTIONS BLK USED TO        */ 04900302
*/*                    FIND SSSO AND SSIB                            */ 04950302
*/*                  SSIB (R) - SUBSYSTEM IDENTIFICATION BLK USED TO */ 05000302
*/*                    FIND SUBSYSTEM NAME                           */ 05050302
*/*                  PDE (R) - PARSE DESCRIPTOR ELEMENT USED TO FIND */ 05100302
*/*                    JOBNAME, JOBID, PRINT/SAVE DSNAMES            */ 05150302
*/*                                                                  */ 05200302
*/*TABLES= YES                                                       */ 05250302
*/*                                                                  */ 05300302
*/*MACROS= SAVE, MODID, GETMAIN, FREEMAIN, PUTLINE, PUTGET,          */ 05350302
*/*        LINK, RETURN, MODESET                                     */ 05400302
*/*    SERIALIZATION= N/A                                            */ 05450302
*/*                                                                  */ 05500302
*/*MAPPING MACROS= IKJOCMTB, IKJPGPB, IKJCPPL, IKJPSCB,              */ 05550302
*/*                IEFJSSOB, IEFJSSIB, IKJEFFGF, IKJEFFDF            */ 05600302
*/*                                                                  */ 05650302
*/*CHANGE ACTIVITY=                                                  */ 05700303
*/*                C737601,742401,737001,743001,746601         @ZM30982 05710303
*/*                C799701-801701                              @ZM30982 05720303
*/*                C840801-842401                              @ZM30982 05730303
*/*                A827101-827301,614901,843301-843701         @ZM30982 05740303
*/*                A827011-827401,802201-802601                @ZM30982 05743303
*/*                A566641-568191,142603-142803                @ZM30982 05746303
*/*                                                                  */ 05750302
*/*MESSAGES= CONTAINS TEXT FOR MESSAGES ISSUED BY OTHER MODULES      */ 05800302
*/*          ALSO ISSUES ITS OWN MESSAGES:                           */ 05850302
*/*      IKJ56312I - NOT ENOUGH VIRTUAL STORAGE TO EXECUTE COMMAND   */ 05900302
*/*                     PUTGET RC=28.                                */ 05950302
*/*      IKJ56313I - COMMAND SYSTEM ERROR - <PUTGET> ERROR           */ 06000302
*/*                  CODE <XXX>                                      */ 06050302
*/*                     NON ZERO PUTGET RC. (OTHER THAN 4,8,28)      */ 06100302
*/*      IKJ56333I - UNABLE TO PROMPT FOR REPLY TO INSTALLATION      */ 06150302
*/*                  EXIT MESSAGE <MSG TEXT>                         */ 06170302
*/*                     USER IN NOPROMPT MODE, THEREFORE             */ 06200302
*/*                     MSG REPLY  NOT RETRIEVED.                    */ 06250302
*/*                                                                  */ 06300302
*/*ABEND CODES= NONE                                                 */ 06350302
*/********************************************************************/ 06400302
         EJECT                                                          06450302
IKJCT467 CSECT                                                          06500302
         EJECT                                                          06550302
*********************************************************************** 06600302
*                 CONSTANTS                                           * 06650302
*********************************************************************** 06700302
ZERO     EQU   0                   SET A FIELD TO ZERO                  06750302
ONE      EQU   1                   INDEX INTO A FIELD                   06800302
TWO2     EQU   2                   DISPLACEMENT                         06850302
THREE    EQU   3                   DISPLACEMENT                         06900302
FOUR4    EQU   4                   DISPLACEMENT                         06950302
FIVE5    EQU   5                   CALCULATE LENGTHS                    07000302
SIX6     EQU   6                   DISPLACEMENT                         07050302
SEVEN    EQU   7                   USE FOR LENGTHS                      07100302
EIGHT    EQU   8                   LENGTH IN 'MVC' INSTR                07150302
FORTY3   EQU   43                  USE FOR LENGTHS                      07200302
SIXTY    EQU   60                  USE FOR SYNAD MSG LENGTH             07220302
ONEHNDRD EQU   100                 CHECK OUTMSGID                       07250302
         SPACE                                                          07300302
LEN2     EQU  2                    LENGTH IN 'UNPK' INSTR               07350302
LEN3     EQU  3                    LENGTH IN 'UNPK' INSTR               07400302
LEN4     EQU  4                    LENGTH IN 'TR' INSTR                 07450302
LEN7     EQU  7                    LENGTH IN 'UNPK' INSTR               07500302
         SPACE                                                          07550302
NOVAR    EQU   X'00'               CHECK FOR ABSENCE OF MSG INSERT VAR  07600302
QUOTES   EQU   X'40'               CHECK PDE FOR QUALIFIED DSNAME       07620302
OFF      EQU   X'00'               INIT SWITCHES TO ZERO                07650302
TERMINAL EQU   X'DF'               TURN OFF NONTERM BIT                 07670302
         SPACE                                                          07700302
SECPUTLA EQU   124                 PUTLINE SECURITY EXIT MESSAGE M328I  07750302
SECPUTLB EQU   143                 PUTLINE SECURITY EXIT MESSAGE M333I  07800302
         SPACE 2                                                        07850302
RC0      EQU   0                   RETURN CODE 0                        07900302
RC4      EQU   4                   RETURN CODE 4                        07950302
RC8      EQU   8                   RETURN CODE 8                        08000302
RC12     EQU   12                  RETURN CODE 12                       08050302
RC16     EQU   16                  RETURN CODE 16                       08100302
RC28     EQU   28                  RETURN CODE 28                       08150302
         SPACE  2                                                       08200302
M312S    EQU   111                 MSGID FOR SUBCMD FAILURE             08250302
M312C    EQU   112                 MSGID FOR CMD FAILURE                08300302
         EJECT                                                          08350302
*********************************************************************** 08400302
*                   REGISTERS                                         * 08450302
*********************************************************************** 08500302
R0       EQU   0                   REGISTER 0 -WORK REG                 08550302
R1       EQU   1                   REGISTER 1 -ADDR OF PARAMETER LISTS  08600302
*                                             -TEMP BASE FOR JEFF18PL   08650302
*                                             -TEMP BASE FOR PDE        08700302
*                                             -TEMP BASE FOR SSIB       08750302
*                                             -TEMP BASE FOR SSS0       08800302
*                                             -GENERAL WORK REG         08850302
R2       EQU   2                   REGISTER 2 -WORK REG                 08900302
R3       EQU   3                   REGISTER 3 -TEMP BASE FOR SSOB       08950302
*                                             -INDEX INTO BRTAB         09000302
*                                             -INDEX INTO MSG CHAR TBL  09050302
*                                             -LENGTH VARIABLE INSERT   09100302
*                                             -GENERAL WORK REG         09150302
R4       EQU   4                   REGISTER 4 -TEMP BASE FOR PGPB       09200302
*                                             -TEMP BASE FOR GFPARMS    09250302
R5       EQU   5                   REGISTER 5 -WORK REG                 09300302
R6       EQU   6                   REGISTER 6 -BRANCH REG (BAL)         09350302
R7       EQU   7                   REGISTER 7 -TEMP BASE FOR CPPL       09400302
*                                             -TEMP BASE FOR PSCB       09450302
*                                             -TEMP BASE FOR SSSO       09500302
*                                             -ADDR OF VARIABLE INSERT  09550302
*                                             -GENERAL WORK REG         09600302
R8       EQU   8                   REGISTER 8 -BASE FOR IKJEFFMC        09650302
R9       EQU   9                   REGISTER 9 -BASE FOR MSGCHAR         09700302
R10      EQU   10                  REGISTER 10-BASE FOR OUTCOMTB        09750302
R11      EQU   11                  REGISTER 11-BASE FOR OLD             09800302
R12      EQU   12                  REGISTER 12-BASE REG FOR IKJCT467    09850302
R13      EQU   13                  REGISTER 13-BASE FOR SAVEAREA        09900302
R14      EQU   14                  REGISTER 14-RETURN REG               09950302
R15      EQU   15                  REGISTER 15-RETURN CODE REG          10000302
         EJECT                                                          10050302
*********************************************************************** 10100302
*                                                                     * 10150302
*        ESTABLISH ADDRESSABILITY FOR IKJCT467                        * 10200302
*        OBTAIN GETMAIN STORAGE FOR SAVEAREA AND WORKAREA             * 10250302
*                                                                     * 10300302
*********************************************************************** 10350302
         SAVE  (14,12)                                                  10400302
         BALR  R12,0               ESTABLISH BASE ADDRESS               10450302
         USING *,R12                                                    10500302
         MODID  BRANCH=YES                                              10550302
         L     R10,0(R1)           ADDR OF OUTCOMTB                     10600302
         USING OUTCOMTB,R10        ADDRESSABILITY FOR OUTCOMTB          10650302
         GETMAIN R,LV=SAVLTH,SP=1  OBTAIN STORAGE                       10700302
         USING SAVEAREA,R1         ADDRESSABILITY FOR NEW AREA          10750302
         ST    R13,SAVEBACK        STORE BACK PTR IN NEW AREA           10800302
         USING SAVEAREA,R13        ADDRESSABILITY FOR OLD AREA          10850302
         ST    R1,SAVEFORW         SAVE FORWARD PTR IN OLD AREA         10900302
         LR    R13,R1              ESTABLISH NEW SAVEAREA               10950302
         EJECT                                                          11000302
*********************************************************************** 11050302
*                                                                     * 11100302
*        H O U S E K E E P I N G                                      * 11150302
*                                                                     * 11200302
*********************************************************************** 11250302
         L     R8,VMSGCON          ADDR OF MESSAGE CONSTANTS CSECT      11300302
         USING IKJCT4MC,R8                                              11350302
         MVI   SAVSW,SAVSWCLR      CLEAR STATUS SWITCHES                11400302
         USING MSGCHAR,R9          ADDRESSABILITY FOR MESSAGE           11450302
*                                  CHARACTERISTICS MAP                  11500302
         LA    R11,SAVOUTL1        ADDR 1ST LEVEL MSG                   11550302
         USING OLDMAP,R11          ADDRESS. FOR OUTPUT LINE DESCRIPTOR  11600302
         SPACE 2                                                        11650302
*********************************************************************** 11700302
*                       SET  UP  IOPL                                 * 11750302
*********************************************************************** 11800302
         L     R7,OUTCPPL          ADDR CPPL                            11850302
         USING CPPL,R7             ADDRESSABILITY FOR CPPL              11900302
         MVC   IOPLUPT,CPPLUPT     ADDR OF UPT                          11950302
         MVC   IOPLECT,CPPLECT     ADDR OF ECT                          12000302
         DROP  R7                                                       12050302
         LA    R7,OUTATTN          GET ADDR OF  THE ECB                 12200302
         ST    R7,IOPLECB          ADDR OF ATTN ECB TO PASS TO I/O      12250302
*                                    SERVICE RTNS                       12270302
         LA    R7,SAVPUTGT                                              12300302
         ST    R7,IOPLIOPB         ADDR OF PGPB (LIST OF PUTGET)        12350302
*                                  UPDATE IF PTPB NEEDED (PUTLINE)      12400302
               EJECT                                                    12450302
*********************************************************************** 12500302
*                                                                     * 12550302
*        DETERMINE MESSAGE TO BE ISSUED                               * 12600302
*        IF OUTMSGID IS < 100, THEN A SERVICE ROUTINE WAS IN ERROR    * 12650302
*        AND A SPECIAL ROUTINE WILL HANDLE IT.                        * 12700302
*                                                                     * 12750302
*********************************************************************** 12800302
MSGTYPE  EQU   *                                                        12850302
         CLI   OUTMSGID,ONEHNDRD   IS MSG INFORMATION TYPE (>=100)      12900302
         BNL   IMSGS               YES-GO SET UP 'OLD' AND ISSUE MSG    12950302
         SR    R3,R3               NO - SET UP TO USE BRANCH TABLE      13000302
         IC    R3,OUTMSGID         ID OF MESSAGE OR MESSAGE TYPE        13050302
         B     BRTABSR(R3)         GO TO BRANCH TABLE FOR SERV RTNS     13100302
*                                    ANALYZE RC AND CHOOSE A MSG        13150302
         SPACE                                                          13200302
*********************************************************************** 13250302
*     SERVICE RTN ERROR MESSAGE - GO TO ROUTINE TO ANALYZE RETURN     * 13300302
*     CODE, CHOOSE APPROPRIATE MSG, AND SET OUTMSGID FIELD. THEN      * 13350302
*     PROCEED TO 'IMSGS' ROUTINE TO SET UP AND ISSUE MSG.             * 13400302
*********************************************************************** 13450302
         DS    0F                                                       13500302
BRTABSR  EQU   *                                                        13550302
         B     OUTPUT              00      ISSUE 'OUTPUT' MESSAGE       13600302
         B     ATTACH              04      ISSUE ATTACH FAILURE MSG     13650302
         B     DYNALERR            08      ISSUE DYNALC FAILURE MSG     13700302
         B     PARS                12      ISSUE PARSE FAILURE MESSAGE  13750302
         B     DAIRERR             16      ISSUE DAIR FAILURE MESSAGE   13800302
         B     SCAN                20      ISSUE CMD SCAN FAILURE MSG   13850302
         B     PUTGC               24      ISSUE PUTGET FAILURE MESSAGE 13900302
         B     BADPOINT            28      ISSUE POINT FAILURE MESSAGE  13950302
         B     GETERROR            32      ISSUE GET FAILURE MESSAGE    14000302
         B     HELPF               36      ISSUE HELP FAILED MESSAGE    14050302
         B     STAERR              40      ISSUE ESTAE FAILURE MSG      14100302
         B     STAX                44      ISSUE STAX FAILURE MSG       14150302
         B     STATUS              48      ISSUE STATUS FAILURE MSG     14200302
         B     OPENFAIL            52      ISSUE OPEN FAILURE MSG       14250302
         B     JESM320I            56      ISSUE JES MSG 320   @ZM30982 14260303
         B     JESM339I            60      ISSUE JES MSG 339   @ZM30982 14270303
         B     JESM343I            64      ISSUE JES MSG 343   @ZM30982 14280303
         SPACE 2                                                        14300302
*********************************************************************** 14350302
*                                                                     * 14400302
*        INFORMATIONAL MESSAGE - GET ADDR OF                          * 14450302
*        'CHARACTERISTICS' FOR REQUIRED MSG                           * 14500302
*                                                                     * 14550302
*********************************************************************** 14600302
IMSGS    EQU   *                                                        14650302
         SR    R9,R9               CLEAR REGISTER                       14700302
         IC    R9,OUTMSGID         LOAD MESSAGE ID                      14750302
         SH    R9,HUNDRED          SUBTRACT 100                         14800302
         MH    R9,TWELVE           MULTIPLY BY 12 (LENGTH OF EACH       14850302
*                                  ENTRY IN MSG CHAR.)                  14900302
         LA    R3,MGCHAR           ADDR OF MSG CHARACTERISTICS          14950302
         AR    R9,R3               ADD TO OFFSET JUST CALCULATED        15000302
         EJECT                                                          15050302
*********************************************************************** 15100302
*                                                                     * 15150302
*        DETERMINE MSG FORMAT (SINGLE OR MULTI                        * 15200302
*        LEVEL) TO MAKE ADDRESSING ADJUSTMENTS                        * 15250302
*                                                                     * 15300302
*********************************************************************** 15350302
MSGFORMT EQU   *                                                        15400302
         L     R0,MSGC2LVP         ADDR OF 2ND LEVEL MSG-IF ONE EXISTS  15450302
         LTR   R0,R0               TEST FOR 2ND LEVEL MSG               15500302
         BNZ   MULTILVL            BRANCH - MSG IS MULTILEVEL           15550302
         SH    R11,FOUR            REDUCE BY 4 BASE FOR OUTPUT          15600302
*                                  LINE TO COMPENSATE FOR LACK OF       15650302
*                                  FWD PTR IN SINGLE LEVEL MSG          15700302
         B     SEGMENT1            START PROCESSING MSG                 15750302
         SPACE 3                                                        15800302
MULTILVL OI    SAVSW,SAVSET        INDICATE 2ND LVL MSG NOW BEING       15850302
*                                    PROCESSED & IT'S MULTILVL          15900302
         LA    R2,SAVOUTL2         ADDR OF 'OLD' FOR 2ND LEVEL MSG      15950302
         ST    R2,OLDNXTLV         STORE IN 1ST LEVEL 'OLD' TO          16000302
*                                    2ND LEVEL 'OLD' AS FWD PTR         16050302
         EJECT                                                          16100302
*********************************************************************** 16150302
*                                                                     * 16200302
*        FILL IN OUTPUT LINE WITH INFO FOR THE BASIC MESSAGE SEGMENT. * 16250302
*        THAT IS, FILL IN THE OUTPUT LINE DESCRIPTOR (MSGMAP)         * 16300302
*        AND THE INFO FOR THE FIRST SEGMENT.                          * 16350302
*                                                                     * 16400302
*********************************************************************** 16450302
SEGMENT1 EQU   *                                                        16500302
         MVC   OLDSEGNO,ONESEG     NO. OF SEGMENTS (1)                  16550302
         LA    R2,MSGSEGAL         ADDR OF 1ST SEGMENT (A)              16600302
         ST    R2,OLDSEGA          STORE IN OUTPUT LINE                 16650302
         L     R2,MSGCMSGP         ADDR OF MSG CONSTANTS                16700302
         LH    R3,0(R2)            LENGTH OF MESSAGE TEXT               16750302
         AH    R3,FOUR             ADD 4 TO GET LENGTH OF SEGMENT       16800302
         STH   R3,MSGSEGAL         STORE IN OUTPUT LINE                 16850302
         MVC   MSGSEGAO,SEGAOFST   MOVE SEGMENT A OFFSET (0)            16900302
         LA    R2,TWO2(R2)         GET BY LL FIELD TO GET AT TEXT       16950302
         SH    R3,FIVE             GET LENGTH OF TEXT MINUS 1           17000302
         EX    R3,MVCTEXT          MOVE TEXT INTO OUTPUT LINE           17050302
         CLI   MSGCVAR1,NOVAR      CHECK FOR PRESENCE OF 1ST VAR        17100302
         BE    CHK2LVL             NO VAR INSERTS -GO CK FOR 2ND LEVEL  17150302
         SPACE 1                                                        17200302
*********************************************************************** 17250302
*                                                                     * 17300302
*        FILL IN OUTPUT LINE WITH INFO FOR 2ND MESSAGE SEGMENT        * 17350302
*       (1ST VARIABLE INSERT). FILL IN NO. SEGMENTS AND ADDRESS OF    * 17400302
*        SEGMENT B.                                                   * 17450302
*                                                                     * 17500302
*********************************************************************** 17550302
SEGMENT2 EQU   *                                                        17600302
         MVC   OLDSEGNO,TWOSEG     NO. OF SEGMENTS (2)                  17650302
         LA    R2,MSGSEGBL         ADDR OF 2ND SEGMENT (B)              17700302
         ST    R2,OLDSEGB          STORE IN OUTPUT LINE                 17750302
*                                GET VARIABLE AND PUT IN OUT LINE       17800302
         SR    R2,R2               ZERO REGISTER                        17850302
         IC    R2,MSGCVAR1         INSER VARIABLE ID                    17900302
         BAL   R6,BRTABVI(R2)      GO GET VARIABLE INSERT               17950302
*                                    R3 - LENGTH VARIABLE +4            18000302
*                                    R7 - ADDR OF VARIABLE INSERT       18050302
         STH   R3,MSGSEGBL         STORE SEGMENT LNTH IN OUTLINE        18100302
         SH    R3,FIVE             GET LEN OF VARIABLE, -1 FOR 'MVC'    18150302
         EX    R3,MVCVAR1          MOVE VARIABLE 1 IN OUTPUT LINE       18200302
*                                  GET OFFSET AND PUT IN OUT LINE       18250302
         L     R2,MSGCMSGP         ADDR OF MSG CONSTANT INFO            18300302
         LH    R3,0(R2)            LENGTH OF MESSAGE TEXT               18350302
         A     R3,TWOSEG           ADD 2 FOR HALF WORK LENGTH FIELD     18400302
         AR    R2,R3               SUM IS ADDR OF 1ST VAR OFFSET        18450302
         MVC   MSGSEGBO,0(R2)      MOVE OFFSET INTO OUTPUT LINE         18500302
         CLI   MSGCVAR2,NOVAR      CHECK FOR PRESENCE OF 2ND VAR        18550302
         BE    CHK2LVL             BRANCH -VARIABLE CODE IS 00          18600302
         SPACE 3                                                        18650302
*********************************************************************** 18700302
*                                                                     * 18750302
*        FILL IN OUTPUT LINE WITH INFO FOR 3RD MESSAGE SEGMENT        * 18800302
*        (VARIABLE INSERT). FILL IN NO. SEGMENTS AND ADDRESS          * 18850302
*        OF SEGMENT C.                                                * 18900302
*                                                                     * 18950302
*********************************************************************** 19000302
SEGMENT3 EQU   *                                                        19050302
         MVC   OLDSEGNO,THREESEG   NO. OF SEGMENTS (3)                  19100302
         LA    R2,MSGSEGCL         ADDR OF 3RD SEGMENT (C)              19150302
         ST    R2,OLDSEGC          STORE IN OUTPUT LINE                 19200302
*                                GET VARIABLE AND PUT IN OUT LINE       19250302
         SR    R2,R2               ZERO REGISTER                        19300302
         IC    R2,MSGCVAR2         INSERT VARIABLE ID                   19350302
         BAL   R6,BRTABVI(R2)      GO GET VARIABLE INSERT               19400302
*                                    R3 - LENGTH VARIABLE +4            19450302
*                                    R7 - ADDR OF VARIABLE INSERT       19500302
         STH   R3,MSGSEGCL         STORE SEGMENT LNTH IN OUTLINE        19550302
         SH    R3,FIVE             GET LNTH OF VARIABLE MINUS 1         19600302
         EX    R3,MVCVAR2          MOVE VARIABLE 2 IN OUTPUT LINE       19650302
*                                  GET OFFSET AND PUT IN OUT LINE       19700302
         L     R2,MSGCMSGP         ADDR OF MSG CONSTANT                 19750302
         LH    R3,0(R2)            LENGTH OF MSG TEXT                   19800302
         AH    R3,FOUR             ADD 4 TO FIND DISTANCE TO            19850302
*                                  THE 2ND VARIABLE OFFSET              19900302
         AR    R2,R3               SUM IS ADDR OF 2ND VAR OFFSET        19950302
         MVC   MSGSEGCO,0(R2)      MOVE OFFSET INTO OUTPUT LINE         20000302
         CLI   MSGCVAR3,NOVAR      CHECK FOR PRESENCE OF 2ND VAR        20050302
         BE    CHK2LVL             BRANCH-VARIABLE CODE IS 00           20100302
         SPACE 1                                                        20150302
*********************************************************************** 20200302
*                                                                     * 20250302
*        FILL IN OUTPUT LINE WITH INFO FOR 4TH MESSAGE SEGMENT        * 20300302
*        (VARIABLE INSERT). FILL IN NO. SEGMENTS AND ADDRESS          * 20350302
*        OF SEGMENT D.                                                * 20400302
*                                                                     * 20450302
*********************************************************************** 20500302
SEGMENT4 EQU   *                                                        20550302
         MVC   OLDSEGNO,FOURSEG    NO. OF SEGMENTS (4)                  20600302
         LA    R2,MSGSEGDL         ADDR OF 4TH SEGMENT (D)              20650302
         ST    R2,OLDSEGD          STORE IN OUTPUT LINE                 20700302
*                                GET VARIABLE AND PUT IN OUT LINE       20750302
         SR    R2,R2               ZERO REGISTER                        20800302
         IC    R2,MSGCVAR3         INSERT VARIABLE ID                   20850302
         BAL   R6,BRTABVI(R2)      GO GET VARIABLE INSERT               20900302
*                                    R3 - LENGTH VARIABLE +4            20950302
*                                    R7 - ADDR OF VARIABLE INSERT       21000302
         STH   R3,MSGSEGDL         STORE SEGMENT LNTH IN OUTLINE        21050302
         SH    R3,FIVE             GET LNTH OF VARIABLE MINUS 1         21100302
         EX    R3,MVCVAR3          MOVE VARIABLE 3 IN OUTPUT LINE       21150302
*                                  GET OFFSET AND PUT IN OUT LINE       21200302
         L     R2,MSGCMSGP         ADDR OF MSG CONSTANT                 21250302
         LH    R3,0(R2)            LENGTH OF MSG TEXT                   21300302
         AH    R3,SIX              ADD 6 TO FIND DISTANCE TO            21350302
*                                  THE 2ND VARIABLE OFFSET              21400302
         AR    R2,R3               SUM IS ADDR OF 3RD VAR OFFSET        21450302
         MVC   MSGSEGDO,0(R2)      MOVE OFFSET INTO OUTPUT LINE         21500302
         EJECT                                                          21550302
*********************************************************************** 21600302
*     DETERMINE IF MSG HAS ONE LEVEL OR TWO.                          * 21650302
*       IF ONE LEVEL, GO CHOSE PUTLINE OR PUTGET.                     * 21700302
*       IF TWO LEVELS, SET UP 2ND LEVEL 'OLD' BEFORE ISSUING MSG      * 21750302
*********************************************************************** 21800302
CHK2LVL  EQU   *                                                        21850302
         TM    SAVSW,SAV2LVL       WAS MSG THE 1ST OF 2 LEVELS          21900302
         BZ    CKPGPL              NO-GO CK IF PUTLINE OR PUTGET NEEDED 21950302
         LA    R11,SAVOUTL2        PUT ADDR OF  2ND LEVEL OUTPUT        22000302
*                                  LINE INTO THE MAP BASE REG           22050302
         L     R9,MSGC2LVP         PUT ADDR CHARARISTICS FOR 2ND        22100302
*                                  LVL MSG INTO THE MAP BASE REG        22150302
         XC    OLDNXTLV(FOUR4),OLDNXTLV  PUT ZEROS AS FWD PTR           22200302
*                                          FOR NXT 'OLD'                22250302
         NI    SAVSW,SAV2LVOF      TURN OFF 2ND LVL SWITCH TO AVOID     22300302
*                                    ANOTHER LOOP TO BUILD MSG SEGMENTS 22350302
         B     SEGMENT1            BRANCH                               22400302
         SPACE 3                                                        22450302
*********************************************************************** 22500302
*     DECIDE IF PUTLINE OR PUTGET PROMPT (SEC EXIT MAY NEED PUTGET)   * 22550302
*********************************************************************** 22600302
CKPGPL   EQU   *                                                        22650302
         TM    SAVSW,SAVPTGTP      PUTGET PROMPT REQUEST?               22700302
         BO    PROMPT              YES-GO PUTGET (PROMPT)               22750302
         SPACE 3                                                        22800302
*********************************************************************** 22850302
*    DECIDE IF SINGLE LEVEL OR MULTI LEVEL PUTLINE NEEDED             * 22900302
*********************************************************************** 22950302
PUTLINE  EQU   *                   ISSUE PUTLINE FOR SINGLE OR MULTI    23000302
*                                  LEVEL MESSAGE                        23050302
*                                                                       23100302
         LA    R2,SAVOUTL1         ADDR OF OUTPUT LINE                  23150302
         MVC   SAVPUTL(PUTLSIZE),PUTLINL LIST TO DYN CORE               23200302
         LA    R3,SAVPUTL          GET ADR OF PUTLINE LIST FORM         23250302
         ST    R3,IOPLIOPB         STOR ADR IN IOPL                     23300302
         SPACE                                                          23350302
         TM    SAVSW,SAVMULTI      CHECK IF MSG IS MULTI LEVEL          23400302
         BO    PUTMULTI            YES, USER PUTLINE MULTI-LEVEL        23450302
         EJECT                                                          23500302
*********************************************************************** 23550302
*   ISSUE PUTLINE - SINGLE LEVEL                                      * 23600302
*********************************************************************** 23650302
         TM    OUTFLAGS,KEY1       WAS CALLER IN KEY 1?                 23700302
         BZ    PUTLS               NO, NEED NOT MODESET                 23750302
         SPACE                                                          23800302
*      MODESET                                                          23850302
         MODESET EXTKEY=SUPR       YES, GET IN SUPR KEY                 23900302
         SPACE                                                          23950302
PUTLS    EQU   *                                                        24000302
         PUTLINE OUTPUT=((R2),SINGLE),MF=(E,IOPL)                       24050302
         LR    R3,R15              SAVE PUTLINE RC                      24100302
         SPACE                                                          24150302
         TM    OUTFLAGS,KEY1       WAS CALLER IN KEY 1?                 24200302
         BZ    CKPUTLRC            NO, THEREFORE MODESET NOT DONE       24250302
         SPACE                                                          24300302
*      MODESET                                                          24350302
         MODESET EXTKEY=SCHED      YES, GET BACK TO KEY1                24400302
         SPACE                                                          24450302
         B     CKPUTLRC            GO CHECK PUTLINE RETURN CODES        24500302
         EJECT                                                          24550302
*********************************************************************** 24600302
*     ISSUE PUTLINE - MULTI LEVEL                                     * 24650302
*********************************************************************** 24700302
PUTMULTI EQU   *                                                        24750302
         NI    SAVSW,SAVMLVOF      TURN OFF MULTI LEVEL SWITCH          24800302
         TM    OUTFLAGS,KEY1       WAS CALLER IN KEY1 ?                 24850302
         BZ    PUTLM               NO, NEED NOT MODESET                 24900302
         SPACE                                                          24950302
*      MODESET                                                          25000302
         MODESET EXTKEY=SUPR       YES, GET IN SUPR KEY                 25050302
         SPACE                                                          25100302
PUTLM    EQU   *                                                        25150302
         PUTLINE OUTPUT=((R2),MULTLVL),MF=(E,IOPL)                      25200302
         SPACE                                                          25250302
         LR    R3,R15              SAVE PUTLINE RC                      25300302
         SPACE                                                          25350302
         TM    OUTFLAGS,KEY1       WAS CALLER IN KEY 1 ?                25400302
         BZ    CKPUTLRC            NO, NEED NOT MODESET BACK            25450302
         SPACE                                                          25500302
*      MODESET                                                          25550302
         MODESET EXTKEY=SCHED      YES, GET IN KEY 1 AGAIN              25600302
         SPACE                                                          25650302
         EJECT                                                          25700302
*********************************************************************** 25750302
*     ANALYZE PUTLINE RETURN CODE                                     * 25800302
*********************************************************************** 25850302
CKPUTLRC EQU   *                                                        25900302
         LTR   R3,R3               CHECK ZERO RETURN CODE               25950302
         BZ    RETURN              RETURN IF MSG ISSUED SUCCESSFULLY    26000302
         CH    R3,FOUR             WAS ECB POSTED - ATTN OCCURRED?      26050302
         BE    RETURN              RETURN IF ATTN                       26200302
         TM    SAVSW,SAVPUTL1      ANY PREVIOUS UNSUCCESSFUL PUTLINES?  26250302
         BO    QUIT                YES, QUIT                            26300302
*                                  NO, TRY ONCE MORE TO ISSUE MSG       26350302
         OI    SAVSW,SAVPUTL1      INDICATE 1ST PUTLINE FAILURE         26400302
         B     PUTLINE             GO TRY PUTLINE AGAIN                 26450302
QUIT     EQU   *                                                        26500302
         OI    OUTSW,ERROR         SET ERROR BIT TO END COMMAND         26550302
         B     RETURN              RETURN TO CALLER                     26600302
         EJECT                                                          26650302
*********************************************************************** 26700302
*     ISSUE PUTGET - PROMPT (FOR SECURITY EXIT MSG)                   * 26750302
*********************************************************************** 26800302
PROMPT   EQU   *                                                        26850302
         NI    SAVSW,SAVPGPOF      TURN OFF PUTGET REQUEST SW           26900302
         NI    SAVSW,SAVMLVOF      TURN OFF MULTI LEVEL SWITCH-IN CASE  26950302
*                                  PUTGET FAILS AND A SINGLE LEVEL      27000302
*                                  MESSAGE IS NEEDED                    27050302
         MVC   SAVPUTGT(PUTGSIZE),PUTGL MOVE PUTGET LIST TO DYN CORE    27100302
         LA    R2,SAVOUTL1         ADDR 'OLD' FOR PUTGET                27150302
         TM    OUTFLAGS,KEY1       IN KEY1?                             27200302
         BZ    PRMPTMSG            NO, DON'T NEED MODESET FOR KEY0      27250302
         SPACE                                                          27300302
*      MODESET                                                          27350302
         MODESET EXTKEY=SUPR       YES, GET IN KEY0                     27400302
         SPACE                                                          27450302
PRMPTMSG EQU   *                                                        27500302
         LA    R1,IOPL             ADDR IOPL                            27550302
         PUTGET OUTPUT=((R2),MULTLVL,PROMPT),MF=(E,(1))                 27600302
         SPACE                                                          27650302
         STH   R15,OUTRTCD         SAVE PUTGET RC                       27700302
         TM    OUTFLAGS,KEY1       IN KEY1 PRIOR TO CALLING IKJCT467?   27750302
         BZ    CKNOPRMP            NO, NEED NOT GET IN KEY1 AGAIN       27800302
         SPACE                                                          27850302
*      MODESET                                                          27900302
         MODESET EXTKEY=SCHED      YES, GET IN KEY1 AGAIN               27950302
         SPACE                                                          28000302
CKNOPRMP EQU   *                                                        28050302
         CLI   OUTRTCD+ONE,RC12    IN NOPROMPT MODE                     28100302
         BNE   CKPUTGRC            NO, BRANCH                           28150302
         SPACE                                                          28200302
*                                ISSUE MESSAGE THAT INCLUDES UP TO      28250302
*                                40 CHARACTERS OF MSG FROM SECURITY     28300302
*                                EXIT AND QUIT COMMAND                  28350302
         SPACE                                                          28400302
         OI    OUTSW,ERROR         TURN ON ERROR SWITCH                 28450302
         L     R2,OUTXMSG          ADDR OF SECURITY EXIT MESSAGE        28500302
         LH    R1,0(R2)            GET LL FIELD OF EXIT MSG             28550302
         CH    R1,FORTY2           MSG GTR THAN 40 (+2 FOR LL) CHARS ?  28600302
         BNH   SIZEOK              NO, MSG IS <= 40 CHARS.              28650302
         LH    R1,FORTY2           LOAD MAX SIZE +2                     28700302
         STH   R1,0(R2)            STORE ADJUSTED LEN IN MSG LL FIELD   28750302
SIZEOK   EQU   *                                                        28800302
         MVI   OUTMSGID,M333I      ISSUE 'UNABLE TO PROMPT' MSG         28850302
         LA    R11,SAVOUTL1        REINIT R11 TO 1ST LEVEL 'OLD' BASE   28900302
         B     IMSGS               ISSUE MESSAGE                        28950302
         EJECT                                                          29000302
*********************************************************************** 29050302
*                                                                     * 29100302
*        SET UP TO ISSUE MODE MSG    -    USUALLY 'OUTPUT'            * 29150302
*          INITIALIZE THE 'OLD' AND MSG SEGMENTS                      * 29200302
*********************************************************************** 29250302
OUTPUT   EQU   *                                                        29300302
         SH    R11,FOUR            REDUCE R11 BASE FOR OUTPUT LINE MAP  29350302
*                                    TO COMPENSATE FOR LACK OF FORWARD  29400302
*                                    PTR IN A 1 LEVEL MSG               29450302
         MVC   SAVOUTL1(MODELN),MODEMSG   SET CONSTANTS IN 'OLD' & SEG1 29500302
         MVC   MSGSEGAT+1(EIGHT),OUTCMDNM     MOVE IN CMD NAME          29520302
*           COMMAND NAME STORED IN OUTCOMTB (FROM THE ECT)              29530302
         SPACE                                                          29550302
         LA    R2,MSGSEGAL         ADDR OF 1ST SEGMENT (MSGID TEXT)     29600302
         ST    R2,OLDSEGA          STORE IN 'OLD'                       29650302
         EJECT                                                          30100302
*********************************************************************** 30150302
*                      ISSUE PUTGET - MODE                            * 30200302
*********************************************************************** 30250302
         SPACE                                                          30300302
         MVC   SAVPUTGT(PUTGSIZE),PUTGL   MOVE PUTGET LIST TO DYN CORE  30350302
         TM    OUTFLAGS,KEY1       IN KEY 1?                            30400302
         BZ    PTGTMMSG            NO -MODESET NOT NEEDED TO GET KEY 0  30450302
         SPACE                                                          30500302
*      MODESET                                                          30550302
         MODESET EXTKEY=SUPR       YES- GET IN KEY 0                    30600302
         SPACE                                                          30650302
PTGTMMSG EQU   *                                                        30700302
         LA    R2,SAVOUTL1         ADDR OF 'OLD' FOR PUTGET             30750302
         LA    R1,IOPL             ADDR OF IOPL                         30800302
         PUTGET OUTPUT=((R2),SINGLE,MODE),MF=(E,(1))                    30850302
         STH   R15,OUTRTCD         SAVE RETURN CODE                     30900302
         SPACE                                                          30950302
         TM    OUTFLAGS,KEY1       IN KEY1 PRIOR TO CALLING IKJCT467?   31000302
         BZ    CKPUTGRC            NO -MODESET NOT NEEDED TO GET KEY 1  31050302
         SPACE                                                          31100302
*      MODESET                                                          31150302
         MODESET EXTKEY=SCHED      YES-GET IN KEY 1 AGAIN               31200302
         EJECT                                                          31250302
*********************************************************************** 31300302
*   ANALYZE PUTGET RETURN CODE  (MODE AND PROMPT)                     * 31350302
*********************************************************************** 31400302
         SPACE                                                          31450302
CKPUTGRC EQU   *                                                        31500302
         CLI   OUTRTCD+ONE,RC0     IS PUTGET RC=0? - ALL OK             31550302
         BNE   PTGTRC4             NO, CHECK FURTHER                    31560302
         NI    OUTSW2,TERMINAL     YES, TURN OFF BIT. INDICATE TERM     31570302
         B     CKBUF               GO CLEAN UP                          31600302
PTGTRC4  EQU   *                   NO, CHECK FURTHER                    31650302
         CLI   OUTRTCD+ONE,RC4     IS PUTGET RC=4(MODE ONLY)? - ALL OK  31700302
         BNE   PTGTRC8             NO - CHECK FOR RC=8                  31750302
         OI    OUTSW2,NONTERM      YES-INDICATE OTHER THAN TERM INPUT   31800302
*                                    COULD BE A CLIST                   31850302
         B     CKBUF               GO CLEAN UP                          31900302
PTGTRC8  EQU   *                                                        31950302
         CLI   OUTRTCD+ONE,RC8     IS PUTGET RC=8? - ATTN OCCURRED, SO  32000302
*                                    ATTN EXIT GOT COMMAND - RETURN     32050302
         BE    RETURN              FREE SAVEAREA & RETURN               32200302
         SPACE                                                          32250302
OTHERRCS EQU   *                   OTHER POSSIBLE RETURN CODES:         32300302
*                                  PUTGET RC=12(MODE ONLY)? - COULD     32350302
*                                    NOT OBTAIN SUBCMD                  32400302
*                                  PUTGET RC=16? - NO LINE PUT          32450302
*                                  PUTGET RC=20? - NO LINE RECEIVED     32500302
*                                  RC WAS 24, INV PARMS, OR 28,         32550302
*                                     GETMAIN FAILURE, OR OTHER RC?     32600302
         OI    OUTSW,ERROR         SET ERROR INDICATOR                  32650302
         B     PUTGC               GO ISSUE APPROPRIATE MSG             32700302
         EJECT                                                          32750302
*********************************************************************** 32800302
*                                                                     * 32850302
*     THE FOLLOWING CODE PERFORMS THE NECESSARY PROCESSING            * 32900302
*       AFTER A SUCCESSFUL 'PUTGET'.                                  * 32950302
*                                                                     * 33000302
*********************************************************************** 33050302
         SPACE 3                                                        33100302
*********************************************************************** 33150302
*     IF THERE WAS A BUFFER FROM A PREVIOUS SUBCOMMAND,               * 33200302
*       FREE IT BEFORE SAVING THE BUFFER ADDR OF THIS COMMAND         * 33250302
*********************************************************************** 33300302
CKBUF    EQU   *                                                        33350302
         L     R1,OUTSBBUF         YES- CHECK FOR AN EXISTING BUFFER    33400302
         LTR   R1,R1               WAS A BUFFER PREVIOUSLY GOTTEN?      33450302
         BZ    NOFREE              NO - DON'T BOTHER TO FREE IT         33500302
*                                  YES-SET UP TO FREE IT                33550302
         LH    R0,0(R1)            GET LENGTH - FIRST HALF OF BUFFER    33600302
         O     R0,SUBPOOL1         SET PUTGET BUFFER SUBPOOL            33650302
         SPACE                                                          33700302
         FREEMAIN  R,LV=(0),A=(1)                                       33750302
         SPACE                                                          33800302
*********************************************************************** 33850302
*     SAVE BUFFER ADDR OF USER'S RESPONSE                             * 33900302
*********************************************************************** 33950302
NOFREE   EQU   *                                                        34000302
         LA    R4,SAVPUTGT                                              34050302
         USING PGPB,R4             ADDRESSABILITY FOR PUTGET PARM BLK   34100302
         MVC   OUTSBBUF,PGPBIBUF   ADDR SUBCMD BUF-MODE OR PROMPT REPLY 34150302
         SPACE                                                          34200302
*********************************************************************** 34250302
*     IF THE USER'S REPLY WAS FOR AN INSTALLATION EXIT MSG,           * 34300302
*       SAVE THE REPLY ADDR IN INST EXIT PARM LIST.                   * 34350302
*********************************************************************** 34400302
         TM    SAVSW,SAVSECMG      WAS INST EXIT MSG REPLY RECEIVED?    34450302
         BZ    RETURN              NO - GO FREE SAVEAREA & RETURN       34500302
         SPACE                                                          34550302
         L     R1,PGPBIBUF                                              34600302
         LH    R2,0(R1)            PICK UP LL OF REPLY BUFFER           34650302
         S     R2,TWO              DECREMENT OFFSET LENGTH FROM TOTAL   34700302
         STH   R2,TWO2(R1)         STORE LENGTH OVER OFFSET FIELD -     34750302
*                                    THE HALF WORD BEFORE THE TEXT      34800302
         LA    R2,TWO2(R1)         POINT TO HALF WORD BEFORE TEXT       34850302
         ST    R2,OUTXRPLY         PASS ADDR TO SECURITY EXIT           34900302
         DROP  R4                                                       34950302
         B     RETURN              GO FREE SAVEAREA & RETURN            35000302
         EJECT                                                          35050302
*********************************************************************** 35100302
*          FREE CORE AND RETURN TO CALLER                             * 35150302
*********************************************************************** 35200302
RETURN   EQU   *                                                        35250302
         SR    R5,R5               ZERO RETURN CODE                     35300302
         LR    R1,R13              ADDR OF CURRENT SAVE AREA            35350302
         L     R13,SAVEBACK        ADDR OF OLD SAVE AREA                35400302
         SPACE                                                          35450302
         FREEMAIN R,LV=SAVLTH,A=(1),SP=1 FREE CURRENT SAVE AREA         35500302
         SPACE                                                          35550302
         LR    R15,R5              TRANSFER RETURN CODE                 35600302
         SPACE                                                          35650302
         RETURN (14,12),T,RC=(15)  RETURN TO CALLER                     35700302
         EJECT                                                          35750302
*********************************************************************** 35800302
*      SPECIAL ROUTINES FOLLOW TO FIND VARIABLES TO BE PLACED INTO    * 35850302
*      THE MESSAGE SEGMENT BEING BUILT.  ON EXIT, REG3 SHOULD CONTAIN * 35900302
*      THE VARIABLE LENGTH+4, AND REG7 SHOULD CONTAIN THE ADDRESS OF  * 35950302
*      THE VARIABLE.                                                  * 36000302
*********************************************************************** 36050302
BRTABVI  DS    F                   BRANCH TABLE FOR VARIABLE FETCH      36100302
*                                  ROUTINES                             36150302
*                                                                       36200302
         B     JOBNAME             FETCH JOBNAME                   04   36250302
         B     CLASSNAM            FETCH CLASSNAME                 08   36300302
         B     USERID              FETCH USERID                    0C   36350302
         B     CMDNM               FETCH COMMAND NAME              10   36400302
         B     R15CODE             FETCH R15 RETURN CODE           14   36450302
         B     RTNCODE             FETCH RETURN CODE               18   36500302
         B     DSNAME              FETCH DSNAME-PRINT/SAVE         1C   36550302
         B     DESTID              FETCH REMOTE STATION ID         20   36600302
         B     SRVRTN              FETCH SERVICE ROUTINE NAME      24   36650302
         DC    F'0'                UNUSED                          28   36700302
         B     JOBIDS              FETCH SYSTEM SUPPLIED JOBID     2C   36750302
         DC    F'0'                UNUSED                          30   36800302
         B     JOBIDU              FETCH USER SUPPLIED JOBID       34   36850302
         B     EXITMSG             FETCH SEC EXIT MSG              38   36900302
         DC    F'0'                UNUSED                          3C   36950302
         B     FIBMAC              FETCH FIB MACRO                 40   37000302
         B     SUBSYSTM            FETCH SUBSYS NAME               44   37050302
         B     DSNSYSO             FETCH SYSOUT DSNAME             48   37100302
         B     MEMBER              FETCH MEMBER NAME               4C   37150302
         B     SYNAD               FETCH SYNAD MESSAGE             50   37170302
         SPACE 3                                                        37200302
*********************************************************************** 37250302
*        GENERAL ROUTINE FOR FINDING SIZE OF VARIABLES                * 37300302
*        AFTER DELETING TRAILING BLANKS                               * 37350302
*         INPUT:                                                      * 37400302
*           R3 - MAXIMUM LENGTH OF VARIABLE MINUS 1                   * 37450302
*           R7 - ADDRESS OF VARIABLE                                  * 37500302
*********************************************************************** 37550302
CHKSIZE  EQU   *                                                        37600302
         LA    R3,0(R3,R7)         POINT TO LAST CHARACTER OF THE       37650302
*                                  FIELD CONTAINING THE VARIABLE        37700302
VARLN    EQU   *                                                        37750302
         CLI   0(R3),C' '          BLANK CHAR?                          37800302
         BNE   NONBLNK             EXIT LOOP AT 1ST NON BLANK           37850302
         BCT   R3,VARLN            LOOP UNTIL NON BLANK IS FOUND        37900302
NONBLNK  EQU   *                                                        37950302
         SR    R3,R7               DIFF IS LENGTH MINUS 1               38000302
         LA    R3,FIVE5(R3)        ADD 5 TO GET LENGTH+4                38050302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 38100302
*                                  OR VSAMERR ROUTINE                   38150302
         EJECT                                                          38200302
*********************************************************************** 38250302
*        FIND JOBNAME FROM PDE                                        * 38300302
*********************************************************************** 38350302
JOBNAME  EQU   *                                                        38400302
         L     R1,OUTJBPDE         ADDR OF JOBNAME PDE                  38450302
         USING PDE,R1              PDE ADDRESSABILITY                   38458302
         L     R7,PDEAD            ADDR OF THE JOBNAME                  38466302
         LH    R3,PDELEN           ITS LENGTH                           38474302
         LA    R3,FOUR4(R3)        PLUS 4 TO JOBNAME LENGTH             38482302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 38490302
         SPACE 2                                                        38550302
*********************************************************************** 38600302
*              FIND USER SUPPLIED JOBID FROM JOBNAME PDE              * 38650302
*********************************************************************** 38700302
JOBIDU   EQU   *                                                        38750302
         L     R1,OUTJBPDE         ADDR OF JOBNAME PDE                  38800302
         USING PDE,R1              PDE ADDRESSABILITY                   38850302
         L     R7,PDEAD2           ADDR OF ITEM                         38900302
         LH    R3,PDELEN2          ITS LENGTH                           38950302
         LA    R3,FOUR4(R3)        PLUS 4 TO ITEM'S LENGTH              39000302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 39050302
         SPACE 2                                                        39100302
*********************************************************************** 39150302
*      FIND SYSTEM RETURNED JOBID FROM SSOB                           * 39200302
*********************************************************************** 39250302
JOBIDS  EQU   *                                                         39300302
         L     R3,OUTSOBH          ADDR OF SSOB HEADER                  39350302
         USING SSOB,R3             SSOB HEADER ADDRESSABILITY           39400302
         L     R1,SSOBINDV         ADDR OF SSSO                         39450302
         USING SSOBEXT,R1          SSSO ADDRESSABILITY                  39500302
         LA    R7,SSSOJOBI         ADDR OF JOBID                        39550302
         LA    R3,SEVEN            MAX LEN MINUS 1                      39600302
         B     CHKSIZE             GO CALCULATE LENGTH                  39650302
         DROP  R3                                                       39700302
         DROP  R1                                                       39750302
         SPACE 2                                                        39800302
*********************************************************************** 39850302
*    FIND CLASSNAME FROM CLASBUFF IN OUTCOMTB                         * 39900302
*********************************************************************** 39950302
CLASSNAM EQU   *                                                        40000302
         LA    R7,CLASBUFF         ADDR OF CLASSNAME                    40050302
         LA    R3,FIVE5            CLASSNAME LENGTH PLUS FOUR           40100302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 40150302
         EJECT                                                          40200302
*********************************************************************** 40250302
*            FIND DSNAME FOR PRINT OR SAVE FROM PDE                   * 40300302
*********************************************************************** 40350302
DSNAME   EQU   *                   GET DSNAME VARIABLE                  40400302
         TM    OUTSW,SUBCMODE      WAS IT A CMD OR SUBCMD?              40450302
         BZ    PRNTDS              IT WAS A CMD, GO GET PRNT PDE        40500302
         L     R1,OSVDSPDE         GET SAVE DSNAME PDE                  40550302
         B     COMMON              RTN WHICH EXTRACTS PDE INFO          40600302
PRNTDS   EQU   *                                                        40650302
         L     R1,OPRDSPDE         GET PRINT DSNAME PDE                 40700302
         B     COMMON              RTN WHICH EXTRACTS PDE INFO          40750302
         SPACE 3                                                        40800302
*********************************************************************** 40803302
*    EXTRACT DSNAME PDE INFORMATION                                   * 40806302
*********************************************************************** 40809302
COMMON   EQU   *                   COMMON ROUTINE TO ACCESS PDE FIELDS  40812302
*                                    THE SPECIFIC PDE ADDR IS ALREADY   40815302
*                                    IN R1                              40818302
         USING PDE,R1              PDE ADDRESSABILITY                   40821302
         L     R7,PDEAD            ADDR OF THE DSNAME                   40824302
         LH    R3,PDELEN           ITS LENGTH                           40827302
         TM    PDEFLGS,QUOTES      WAS DSN ENTERED QUALIFIED?           40830302
         BO    CALCLEN             YES, PRINT IT AS IT IS IN PDE        40833302
*                                  NO, DSN NOT ENTERED QUALIFIED.       40836302
*                                    STRIP THE QUALIFIER PARSE ADDED    40839302
*                                    BEFORE PRINTING                    40842302
         LA    R2,1                FOR GENERAL DECREMENTING OF REGS     40845302
CKDOT    EQU   *                                                        40850302
         CLI   0(R7),C'.'          IS THIS CHAR A PERIOD?               40853302
         BE    FOUND               YES, GO GET ADDR OF NEXT CHAR        40856302
         LA    R7,1(R7)            NO, INCRE ADDR AND CHECK NEXT CHAR   40859302
         SR    R3,R2               DECRE LENGTH OF DSN                  40862302
         B     CKDOT                                                    40865302
FOUND    EQU   *                                                        40868302
         LA    R7,1(R7)           GET ADDR OF CHAR AFTER THE PERIOD     40871302
         SR    R3,R2              DECRE LENGTH                          40874302
CALCLEN  EQU   *                                                        40877302
         LA    R3,FOUR4(R3)        PLUS 4 TO DSNAME'S LENGTH            40880302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 40883302
         SPACE 3                                                        40886302
*********************************************************************** 40889302
*              GET MEMBERNAME FOR 'SAVE' DATA SET FROM PDE            * 40900302
*********************************************************************** 40950302
MEMBER   EQU   *                                                        41000302
         L     R1,OSVDSPDE         GET SAVE DSNAME PDE                  41050302
         USING PDE,R1                                                   41100302
         L     R7,PDEAD2           GET ADDR MEMBER NAME                 41150302
         LH    R3,PDELEN2          GET LENGTH MEMBER NAME               41200302
         LA    R3,FOUR4(R3)        LENGTH OF MEMBER NAME + 4            41250302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 41300302
         DROP  R1                                                       41350302
         EJECT                                                          41950302
*********************************************************************** 42000302
*  FIND USERID FROM PSCB - MUST BE IN KEY0 OR PROB PROG KEY TO READ   * 42050302
*********************************************************************** 42100302
USERID   EQU   *                   GET USERID VARIABLE                  42150302
         L     R7,OUTCPPL          ADDR OF CPPL                         42200302
         USING CPPL,R7             ADDRESSABILITY FOR CPPL              42250302
         L     R7,CPPLPSCB         ADDR OF PSCB                         42300302
         USING PSCB,R7             ADDRESSABILITY FOR PSCB              42350302
         SR    R3,R3               ZERO REGISTER                        42400302
         IC    R3,PSCBUSRL         LENGTH OF USERID                     42450302
         LA    R3,FOUR4(R3)        ADD 4 TO LENGTH OF USERID            42500302
         LA    R7,PSCBUSER         ADDR USERID                          42550302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 42600302
         SPACE 3                                                        42650302
*********************************************************************** 42700302
*    RETRIEVE COMMAND NAME IN OUTCOMTB (FROM ECT ORIGINALLY)          * 42750302
*********************************************************************** 42800302
CMDNM    EQU   *                   GET COMMAND NAME                     42850302
         LA    R7,OUTCMDNM         ADDR OF COMMAND NAME                 42900302
         LA    R3,SEVEN            MAX LEN CMDNAME MINUS 1              42950302
         B     CHKSIZE             GO CALCULATE LENGTH                  43000302
         EJECT                                                          43050302
*********************************************************************** 43100302
*          GET & CONVERT RETURN CODE FOR PRINTING                     * 43150302
*          THIS RETURN CODE COULD BE IN REG15, OR AN ERROR CODE IN A  * 43200302
*          CONTROL BLOCK (LIKE AN RPL ERROR CODE)                     * 43250302
*            RC MUST BE <= 153 DECIMAL OR <= X'99'                    * 43300302
*********************************************************************** 43350302
R15CODE  EQU   *                   CONVERT R15 RTN CODE FROM            43400302
*                                  HEX TO DECIMAL                       43450302
*                                                                       43500302
         LH    R1,OUTRTCD          LOAD RETURN CODE                     43550302
         CVD   R1,SAVRTCD          CONVERT IT TO PACKED DECIMAL         43600302
         MVC   OUTRTCD,SAVRTCD+SIX6  MOVE THE 2 SIGNIFICANT BYTES OF    43650302
*                                    PACKED CODE                        43700302
         UNPK  SAVRTCD(LEN3),OUTRTCD(LEN2)   PACKED DEC TO ZONED DEC    43750302
         OI    SAVRTCD+TWO2,X'F0'  SET SIGN TO PRINTABLE IN LAST BYTE   43800302
         LA    R7,SAVRTCD          ADDR OF RETURN CODE (NOW PRINTABLE)  43850302
         LA    R3,SEVEN            LNGTH OF VAR INSERT (CODE LEN 3 + 4) 43900302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 43950302
         SPACE                                                          44000302
*********************************************************************** 44050302
*        GET & CONVERT ERROR CODE OR COMPLETION CODE FOR PRINTING     * 44100302
*          CODE MUST BE <= 3 PACKED DIGITS (1 1/2 BYTES)              * 44150302
*********************************************************************** 44200302
RTNCODE  EQU   *                   PREPARE COMPLETION CODE FOR PRINTING 44250302
*                                                                       44300302
         UNPK  SAVRTCD(LEN7),OUTRTCD(LEN4)   PACKED CODE TO ZONED       44350302
         TR    SAVRTCD(LEN4),TABLE-C'0'      TRANSLATE 0-9, A-F         44400302
*                                  ACTUALLY, ANY NUMBERS IN THE RC ARE  44450302
*                                  ALREADY IN PRINTABLE FORM, THIS WILL 44500302
*                                  TRANSLATE ALPHABETICS WHICH HAVE     44550302
*                                  ZONES (FB TO C2). NOTE, COMPENSATION 44600302
*                                  FOR ABBREVIATED TRT TABLE.           44650302
         SPACE                                                          44700302
         LA    R7,SAVRTCD          ADDR OF 4 DIGIT CODE (NOW PRINTABLE) 44750302
         LA    R7,ONE(R7)          GET ADDR OF THE 3 SIGNIFICANT DIGITS 44800302
         LA    R3,SEVEN            LEN OF 3 BYTE CODE + 4               44850302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 44900302
         EJECT                                                          44950302
*********************************************************************** 45000302
*        FIND DSNAME FOR SYSOUT DATA SET FROM SSOB                    * 45050302
*********************************************************************** 45100302
DSNSYSO  EQU   *                                                        45150302
         L     R7,OUTSOBSO         GET ADDR OF SSSO SECTION             45200302
         USING SSOBEXT,R7                                               45250302
         LA    R7,SSSODSN          ADDR OF SYSOUT DSNAME                45300302
         LA    R3,FORTY3           MAX LENGTH OF SYSOUT DSNAME MINUS 1  45350302
         B     CHKSIZE             GO DELETE ANY TRAILING BLANKS        45400302
         SPACE 3                                                        45450302
*********************************************************************** 45500302
*          FIND SERVICE ROUTINE NAME                                  * 45550302
*********************************************************************** 45600302
SRVRTN   EQU   *                   GET NAME OF SERVICE ROUTINE          45650302
         L     R7,SAVSVRTN         ADDR OF SERVICE RTN NAME             45700302
         LH    R3,0(R7)            LENGTH OF VARIABLE                   45750302
         LA    R3,FOUR4(R3)        ADD 4 TO LENGTH                      45800302
         LA    R7,TWO2(R7)         ADJUST ADDR TO GET BY LL             45850302
         BR    R6                  BRANCH TO CALLER(SEGMENT2,3,4 CODE)  45900302
         SPACE 3                                                        45950302
*********************************************************************** 46000302
*                 FIND REMOTE STATION ID FROM SSOB                    * 46050302
*********************************************************************** 46100302
DESTID   EQU   *                                                        46150302
         L     R7,OUTSOBSO         GET ADDR OF SSSO SECTION             46200302
         USING SSOBEXT,R7                                               46250302
         LA    R7,SSSODEST         ADDR OF DEST ID                      46300302
         LA    R3,SEVEN            MAX LEN OF DESTID MINUS 1            46350302
*                                  (THE SSOB PROVIDES SPACE FOR 8       46360302
*                                  CHARS, TSO SUPPORTS 7)               46370302
         B     CHKSIZE             GO DELETE ANY TRAILING BLANKS        46400302
         EJECT                                                          46500302
*********************************************************************** 46550302
*          FIND SECURITY EXIT MESSAGE                                 * 46600302
*********************************************************************** 46650302
EXITMSG  EQU   *                                                        46700302
         L     R7,OUTXMSG          ADDRESS OF SECURITY EXIT MSG         46750302
         LH    R3,0(R7)            LL FIELD OF USER'S MSG               46800302
         S     R3,TWO              REDUCE BY 2 TO GET USER'S MSG LENGTH 46850302
         AH    R3,FOUR             MSG LENGTH PLUS 4 - FOR SEG2 LEN FLD 46900302
         LA    R7,TWO2(R7)         POINT TO MSG TEXT - 2 PAST LL FIELD  46950302
         CLI   OUTMSGID,SECPUTLA   IS REQUEST FOR A PUTLINE FOR M328I?  47000302
         BE    SETSW               YES, SKIP SET OF PUTGET PROMPT SW    47050302
         CLI   OUTMSGID,SECPUTLB   IS REQUEST FOR PUTLINE FOR M333I?    47100302
         BE    SETSW               YES, SKIP SET OF PUTGET PROMPT SW    47150302
         OI    SAVSW,SAVPTGTP      NO, SET SWITCH FOR PUTGET PROMPT     47200302
SETSW    OI    SAVSW,SAVSECMG      SET SW FOR SECURITY MSG BEING ISSUED 47250302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 47300302
         SPACE 3                                                        47305302
*********************************************************************** 47310302
*    FIND SYNAD MESSAGE                                               * 47315302
*********************************************************************** 47320302
SYNAD    EQU   *                                                        47325302
         L     R7,OUTSYNMS         ADDR OF SYNAD MSG                    47330302
         LA    R7,50(R7)           START AT JOBNAME WITHIN SYNAD MSG    47335302
         LA    R3,SIXTY            SIZE OF SYNAD RCD + 4                47340302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 47345302
         EJECT                                                          47350302
*********************************************************************** 47400302
*              FIND NAME OF THE FIB SVC'S FAILING MACRO               * 47450302
*********************************************************************** 47500302
FIBMAC   EQU   *                                                        47550302
         LA    R7,OUTMACN          ADDR OF MACRO'S NAME                 47600302
         LA    R3,SEVEN            MAX LEN OF MACRO MINUS 1             47650302
         B     CHKSIZE             GO CALCULATE LENGTH                  47700302
         SPACE 3                                                        47750302
*********************************************************************** 47800302
*      FIND SUBSYSTEM NAME FROM SSIB                                  * 47850302
*********************************************************************** 47900302
SUBSYSTM EQU   *                                                        47950302
         L     R3,OUTSOBH          ADDR OF SSOB HEADER                  48000302
         USING SSOB,R3             SSOB HEADER ADDRESSABILITY           48050302
         L     R1,SSOBSSIB         GET ADDR SSIB                        48100302
         USING SSIB,R1             SSIB ADDRESSABILITY                  48150302
         LA    R7,SSIBSSNM         GET SUBSYSTEM NAME ADDR              48200302
*  FIND SIZE OF SUBSYS NAME                                             48250302
         LR    R3,R7               COPY ADDR OF SUBSYS NAME             48300302
         LA    R3,THREE(R3)        POINT AT END OF 4 BYTE FIELD         48350302
VARLNG  CLI    0(R3),C' '          BLANK CHAR                           48400302
         BNE   NONBLANK            EXIT LOOP AT 1ST NON BLANK           48450302
         BCT   R3,VARLNG           LOOP UNTIL NON BLANK IS FOUND        48500302
NONBLANK SR    R3,R7               DIFF IS LENGTH MINUS 1               48550302
         LA    R3,FIVE5(R3)        ADD 5 TO GET LENGTH + 4              48600302
         BR    R6                  RETURN TO CALLER (SEGMENT2,3,4 CODE) 48650302
         DROP  R3                                                       48700302
         EJECT                                                          48750302
*********************************************************************** 48800302
*    FOR DAIR ERRORS, ISSUE MSGS VIA IKJEFF18 (DAIRFAIL)              * 48850302
*    THIS COMMON ROUTINE IS USED BY SEVERAL COMMAND PROCESSORS.       * 48900302
*********************************************************************** 48950302
DAIRERR  EQU   *                                                        49000302
         MVC   DFDAPLP,OUTDAIR     PASS ADDR OF DAPL                    49050302
         SPACE                                                          49100302
         LA    R2,F18RC            PASS ADDR OF RC                      49150302
         ST    R2,DFRCP            ...                                  49200302
         LH    R15,OUTRTCD         SAVE REG15 RETURN CODE               49250302
         ST    R15,F18RC           ...                                  49300302
         SPACE                                                          49350302
         LA    R2,F18MW            POINT TO MSG WTR POINTER             49400302
         ST    R2,DFJEFF02         ...                                  49450302
         LA    R2,ZERO                                                  49500302
         ST    R2,F18MW            TELL '18 THAT IKJEFF02 IS NOT LOADED 49550302
         SPACE                                                          49600302
         LA    R2,F18ID            POINT TO CODE                        49650302
         ST    R2,DFIDP            ...                                  49700302
         LA    R2,DFDAIR           PASS A CODE OF 1 - DAIR ERROR        49750302
         STH   R2,F18ID            ...                                  49800302
         SPACE                                                          49850302
         B     SETUPDF             GO SETUP FOR DAIRFAIL TO ISSUE MSG   49900302
         EJECT                                                          49950302
*********************************************************************** 50000302
*    FOR DYNAMIC ALLOCATION ERRORS, ISSUE MESSAGES VIA                * 50050302
*    IKJEFF18 (DAIRFAIL). THIS COMMON ROUTINE IS USED BY              * 50141002
*    SEVERAL COMMAND PROCESSORS.                                      * 50150302
*********************************************************************** 50250002
DYNALERR EQU   *                                                        50250802
         L     R3,OUTDARB          GET ADDR REQUEST BLOCK               50300102
         ST    R3,DFS99RBP         STORE IN PARMLIST                    50362402
         SPACE                                                          50450002
         LA    R3,F18RC            ADDR OF WORD WITH CODE               50450102
         ST    R3,DFRCP            STORE ADDR IN PARMLIST               50550002
         LH    R3,OUTRTCD          PICK UP DYNAC RC                     50550302
         ST    R3,F18RC            STORE RC                             50600102
         SPACE                                                          50650402
         LA    R3,F18MW            POINT TO MSG WTR ADDR                50701502
         ST    R3,DFJEFF02                                              50750802
         LA    R3,ZERO                                                  50823002
         ST    R3,F18MW            TELL '18 THAT IKJEFF02 IS NOT LOADED 50861702
         SPACE                                                          50901702
         LA    R3,F18ID            ADDR OF WORD WITH CALLER ID          50951702
         ST    R3,DFIDP            STORE ADDR IN PARMLIST               51001702
         LA    R3,DFSVC99          PASS A CODE OF 50-DYNALC ERROR       51051702
         STH   R3,F18ID            STORE CALLERS ID                     51101702
         SPACE                                                          51150202
         L     R3,OUTCPPL          ADDR CPPL                            51200202
         ST    R3,DFCPPLP         STORE ADDR IN PARMLIST                51250202
         SPACE                                                          51300202
*********************************************************************** 51350202
*              INVOKE IKJEFF18 (DAIRFAIL) FROM SYS1.LINKLIB           * 51400202
*********************************************************************** 51450202
SETUPDF  EQU   *                                                        51500202
         TM    OUTFLAGS,KEY1       IN KEY1 ?                            51550202
         BZ    GODAIRFL            NO, MODESET NOT NEEDED FOR KEY0      51600202
         SPACE                                                          51650202
*      MODESET                                                          51700202
         MODESET EXTKEY=SUPR       YES, GET IN KEY0                     51792502
         SPACE                                                          51800102
GODAIRFL EQU   *                                                        51860102
         LA    R1,DFPARMS          GET ADDR OF PARM LIST                51920102
         LINK EP=IKJEFF18          GOTO DAIRFAIL RTN & ISSUE MSG        51980102
         SPACE                                                          52040102
         TM    OUTFLAGS,KEY1       IN KEY1 PRIOR TO CALLING IKJCT467?   52070102
         BZ    RETURN              NO, NEED NOT GET IN KEY1 AGAIN       52100102
         SPACE                                                          52160102
*      MODESET                                                          52220102
         MODESET EXTKEY=SCHED      YES, GET IN KEY1 AGAIN               52280102
         SPACE                                                          52340102
         B     RETURN              RETURN TO CALLER                     52370102
         EJECT                                                          52400102
*********************************************************************** 52460102
*     INITIALIZE UNIQUE VSAMFAIL PARMLIST FIELDS FOR OPEN FAILURES    * 52520102
*********************************************************************** 52580102
OPENFAIL EQU   *                                                        52640102
         LA    R2,GFOPEN           GET 'OPEN' ID                        52670102
         STH   R2,GFCALLID         INDICATE OPEN FAILURE                52700102
         SPACE                                                          52760102
         L     R2,OUTACB           PICK UP ADDR OF ACB                  52820102
         ST    R2,GFCBPTR          PASS ACB ADDR ON AN OPEN ERROR       52880102
         SPACE                                                          52940102
         B     VSAMERR             GO ISSUE MESSAGE                     52970102
         SPACE 3                                                        53000102
*********************************************************************** 53060102
*    INITIALIZE UNIQUE VSAMFAIL PARMLIST FIELDS FOR POINT FAILURES    * 53120102
*********************************************************************** 53180102
BADPOINT EQU   *                                                        53240102
         LA    R2,GFPOINT          GET 'POINT' ID                       53270102
         STH   R2,GFCALLID         INDICATE POINT FAILURE               53300102
         SPACE                                                          53360102
         L     R2,OUTRPL           PICK UP ADDR OF RPL                  53420102
         ST    R2,GFCBPTR          PASS RPL ADDR ON A POINT FAILURE     53480102
         SPACE                                                          53540102
         B     VSAMERR             GO ISSUE MESSAGE                     53570102
         SPACE 3                                                        53600102
*********************************************************************** 53660102
*     INITIALIZE UNIQUE VSAMFAIL PARMLIST FIELDS FOR GET FAILURES     * 53720102
*********************************************************************** 53780102
GETERROR EQU   *                                                        53840102
         LA    R2,GFGET            PICK UP 'GET' ID                     53870102
         STH   R2,GFCALLID         INDICATE GET FAILURE                 53900102
         SPACE                                                          53960102
         L     R2,OUTRPL           PICK UP ADDR OF RPL                  54020102
         ST    R2,GFCBPTR          PASS RPL ADDR ON A GET FAILURE       54080102
         SPACE 3                                                        54140102
*********************************************************************** 54170102
*     FOR OPEN/CLOSE ERRORS, AND POINT/GET ERRORS WITH THE            * 54200102
*     SYSOUT DATASET, ISSUE THE APPROPRIATE MESSAGE VIA               * 54260102
*     IKJEFF19 (VSAMFAIL).                                            * 54320102
*********************************************************************** 54380102
VSAMERR  EQU   *                                                        54440102
         LH    R2,OUTRTCD          GET REG15 ERROR CODE                 54470102
         ST    R2,GFRCODE          PASS RETURN CODE                     54500102
         SPACE                                                          54560102
         LA    R2,ZERO                                                  54620102
         ST    R2,GF02PTR          ZERO SINCE IKJEFF02 NOT LOADED       54680102
         SPACE                                                          54740102
         NI    GFBITS,OFF          ZERO SWITCHES                        54770102
         OI    GFBITS,GFKEYN08     TURN ON SWITCH IF NOT KEY0 OR 8      54800102
         OI    GFBITS,GFSUBSYS     TURN ON SWITCH IF USE VSAM-SUBSYS    54860102
*                                     INTERFACE                         54920102
         SPACE                                                          54980102
         LA    R2,ZERO                                                  55040102
         STC   R2,GFRESV1          ZERO RESERVED FIELD                  55070102
         SPACE                                                          55100102
         L     R2,OUTCPPL          PICK UP CPPL PTR                     55160102
         ST    R2,GFCPPLP          PASS CPPL PTR                        55220102
         SPACE                                                          55280102
         LA    R2,ZERO                                                  55340102
         ST    R2,GFECBP           ZERO ECB PTR FOR PUTLINE             55370102
         SPACE                                                          55400102
         BAL   R6,DSNSYSO          GO FIND ADDR OF SYSOUT DATASET NAME, 55460102
*                                  THEN FIND LENGTH VIA CHKSIZE RTN.    55520102
*                                  ON RETURN:                           55580102
*                                    R3 - LENGTH DSN PLUS 4             55640102
*                                    R7 - ADDR DSN                      55670102
         LA    R2,FOUR4                                                 55700102
         SR    R3,R2               SUBTRACT 4 TO GET DSN LENGTH         55760102
         STH   R3,GFDSNLEN         PASS DSN LENGTH                      55820102
         ST    R7,GFDSNP           PASS PTR TO DSN                      55880102
         SPACE                                                          55940102
         LA    R2,ZERO                                                  55970102
         ST    R2,GFECBP           ZERO ECB PTR                         56000102
         STH   R2,GFPGMNL          ZERO PGM NAME LENGTH                 56060102
         ST    R2,GFPGMNP          ZERO PGM NAME - DEFAULT IS CMDNAME   56120102
         ST    R2,GFRESV2          ZERO RESERVED FIELD                  56180102
         ST    R2,GFRESV3          ZERO RESERVED FIELD                  56240102
         SPACE                                                          56270102
         LA    R2,GFPARMS          ADDR OF PARMLIST                     56300102
         ST    R2,OUTWORK          SAVE IN OUTWORK                      56360102
         LA    R1,OUTWORK          REG1 PTS TO ADDR OF GFPARMS          56420102
         SPACE                                                          56480102
         LINK  EP=IKJEFF19         GO TO VSAMFAIL RTN & ISSUE MSG       56540102
         SPACE                                                          56570102
         B     RETURN              RETURN TO CALLER                     56600102
         EJECT                                                          56660102
*********************************************************************** 56664103
*        JES MSG 320 - DECIDE IF JOBID CAN BE INSERTED                * 56668103
*********************************************************************** 56672103
JESM320I EQU   *                                               @ZM30982 56676103
         L     R3,OUTSOBH          ADDR OF SSOB HEADER         @ZM30982 56676903
         USING SSOB,R3             SSOB HEADER ADDRESSABILITY  @ZM30982 56677703
         L     R7,SSOBINDV         ADDR OF SSSO                @ZM30982 56678503
         USING SSOBEXT,R7          SSSO ADDRESSABILITY         @ZM30982 56679303
         CLC   SSSOJOBI(8),NOJOBID IS THERE A JOBID?           @ZM30982 56680103
         BE    NOJID320            NO, ISSUE MSG W/O           @ZM30982 56684103
         MVI   OUTMSGID,M320I      YES, ISSUE MSG W/           @ZM30982 56688103
         B     IMSGS               GO ISSUE MSG                @ZM30982 56692103
NOJID320 EQU   *                                               @ZM30982 56696103
         MVI   OUTMSGID,M320A      ISSUE MSG W/O ID            @ZM30982 56700103
         B     IMSGS               GO ISSUE MSG                @ZM30982 56704103
         SPACE 3                                                        56708103
*********************************************************************** 56720103
*       JES MSG 339 - DECIDE IF JOBID CAN BE INSERTED                 * 56726103
*********************************************************************** 56732103
JESM339I EQU   *                                               @ZM30982 56738103
         L     R3,OUTSOBH          ADDR OF SSOB HEADER         @ZM30982 56739103
         USING SSOB,R3             SSOB HEADER ADDRESSABILITY  @ZM30982 56740103
         L     R7,SSOBINDV         ADDR OF SSSO                @ZM30982 56741103
         USING SSOBEXT,R7          SSSO ADDRESSABILITY         @ZM30982 56742103
         CLC   SSSOJOBI(8),NOJOBID IS THERE A JOBID?           @ZM30982 56743103
         BE    NOJID339            NO, ISSUE MSG W/O           @ZM30982 56748103
         MVI   OUTMSGID,M339A      YES, ISSUE MSG W/           @ZM30982 56753103
         B     IMSGS               ISSUE MSG                   @ZM30982 56758103
NOJID339 EQU   *                                               @ZM30982 56763103
         MVI   OUTMSGID,M339I      ISSUE MSG W/O ID            @ZM30982 56768103
         B     IMSGS               ISSUE MSG                   @ZM30982 56773103
         SPACE 3                                                        56783103
*********************************************************************** 56786103
*        JES MSG 343 - DECIDE IF JOBID CAN BE INSERTED                * 56789103
*********************************************************************** 56792103
JESM343I EQU   *                                               @ZM30982 56795103
         L    R3,OUTSOBH           ADDR OF SSOB HEADER         @ZM30982 56795703
         USING SSOB,R3             SSOB HEADER ADDRESSABILITY  @ZM30982 56796303
         L    R7,SSOBINDV          ADDR OF SSSO                @ZM30982 56796903
         USING SSOBEXT,R7          SSSO ADDRESSABILITY         @ZM30982 56797503
         CLC   SSSOJOBI(8),NOJOBID IS THERE A JOBID?           @ZM30982 56798103
         BE    NOJID343            NO, ISSUE MSG W/O           @ZM30982 56801103
         MVI   OUTMSGID,M343I      YES, ISSUE MSG W/           @ZM30982 56804103
         B     IMSGS               ISSUE MSG                   @ZM30982 56807103
NOJID343 EQU   *                                               @ZM30982 56810103
         MVI   OUTMSGID,M343A      ISSUE MSG W/O ID            @ZM30982 56813103
         B     IMSGS               ISSUE MSG                   @ZM30982 56816103
         EJECT                                                          56819103
*********************************************************************** 56822103
*              PICK UP 'STAX' INSERT FOR MESSAGE                      * 56825103
*********************************************************************** 56840102
STAX     EQU   *                                                        56870102
         LA    R2,STAXMAC          ADDR SERVICE RTN NAME                56900102
         ST    R2,SAVSVRTN         SAVE FOR MSG INSERT                  56960102
         B     PRNT313I            GO ISSUE MSG 313I                    57020102
         SPACE                                                          57080102
*********************************************************************** 57140102
*            PICK UP 'STATUS' INSERT FOR MESSAGE                      * 57170102
*********************************************************************** 57200102
STATUS   EQU   *                                                        57260102
         LA    R2,STAT             ADDR SERVICE RTN NAME                57320102
         ST    R2,SAVSVRTN         SAVE FOR MSG INSERT                  57380102
         B     PRNT313I            GO ISSUE MSG 313I                    57440102
         SPACE                                                          57470102
*********************************************************************** 57500102
*            PICK UP 'ATTACH' INSERT FOR MESSAGE                      * 57560102
*********************************************************************** 57620102
ATTACH   EQU   *                                                        57680102
         LA    R2,ATTCH            ADDR SERVICE RTN NAME                57740102
         ST    R2,SAVSVRTN         SAVE FOR MSG INSERT                  57770102
         B     PRNT313I            GO ISSUE MSG 313I                    57800102
         SPACE                                                          57860102
*********************************************************************** 57920102
*                 CHECK PUTGET RETURN CODES                           * 57980102
*********************************************************************** 58040102
PUTGC    EQU   *                                                        58070102
         CLI   OUTRTCD+ONE,RC28    IS FAILURE FOR GETMAIN ?             58100102
         BE    PRNT312I            BRANCH IF YES                        58160102
         LA    R2,PUTGET           ADDR OF SERVICE ROUTINE NAME         58220102
         ST    R2,SAVSVRTN         SAVE FOR FETCH OF NAME               58280102
         B     PRNT313I            ISSUE MESSAGE                        58340102
         SPACE                                                          58370102
*********************************************************************** 58400102
*                  CHECK PARSE RETURN CODES                           * 58460102
*********************************************************************** 58520102
PARS     EQU   *                                                        58580102
         CLI   OUTRTCD+ONE,RC16    IS FAILURE FOR GETMAIN ?             58640102
         BE    PRNT312I            YES, ISSUE MSG FOR GETMAIN FAILURE   58670102
         LA    R2,PARSE            ADDR OF SERVICE ROUTINE NAME         58700102
         ST    R2,SAVSVRTN         STORE FOR FETCH ROUTINE              58760102
         B     PRNT313I            NO, NOT GETMAIN FAILURE              58820102
         SPACE                                                          58880102
*********************************************************************** 58940102
*               SAVE 'COMMAND SCAN' INSERT VARIABLE                   * 58970102
*********************************************************************** 59000102
SCAN     EQU   *                                                        59060102
         LA    R2,SCAN1            ADDR OF SERVICE ROUTINE NAME         59120102
         ST    R2,SAVSVRTN         STORE FOR INSERT LATER               59180102
         B     PRNT313I            ISSUE MESSAGE                        59240102
         SPACE                                                          59270102
*********************************************************************** 59300102
*               SAVE 'ESTAE MACRO' INSERT VARIABLE                    * 59360102
*********************************************************************** 59420102
STAERR   EQU   *                                                        59480102
         LA    R2,STAE             ADDR OF  'ESTAE MACRO'               59540102
         ST    R2,SAVSVRTN         STORE FOR INSERT LATER               59570102
         B     PRNT313I            BRANCH                               59600102
         SPACE 3                                                        59660102
*********************************************************************** 59720102
*              SET UP 'HELP' INSERT FOR MESSAGE                       * 59780102
*********************************************************************** 59840102
HELPF    EQU   *                                                        59870102
         LA    R2,HELP              ADDR OF SERVICE ROUTINE NAME        59900102
         ST    R2,SAVSVRTN          STORE FOR FETCH ROUTINE             59960102
         MVI   OUTMSGID,M318B       'HELP ENDED' MSG                    60020102
         B     IMSGS                ISSUE MESSAGE                       60080102
         EJECT                                                          60140102
*********************************************************************** 60170102
*  SET UP MSGID FOR 'NOT ENOUGH VIRTUAL STORAGE' MSG                  * 60200102
*********************************************************************** 60260102
PRNT312I EQU   *                   'NOT ENOUGH VIRTUAL STORAGE TO       60320102
*                                  EXECUTE'                             60380102
         TM    OUTSW,SUBCMODE      WAS IT A CMD OR SUBCMD FAILURE       60440102
         BZ    COMDFAIL            BRANCH, IT WAS A CMD.                60470102
         MVI   OUTMSGID,M312S      MSG ID,SUBCOMMAND FAILURE            60500102
         B     IMSGS               ISSUE MESSAGE                        60560102
COMDFAIL MVI   OUTMSGID,M312C      MSG ID, COMMAND FAILURE              60620102
         B     IMSGS               ISSUE MESSAGE                        60680102
         SPACE                                                          60740102
*********************************************************************** 60770102
*    SET UP MSGID FOR 'CMD SYSTEM ERROR' MSG                          * 60800102
*********************************************************************** 60860102
PRNT313I EQU   *                   'COMMAND SYSTEM ERROR   '            60920102
         MVI   OUTMSGID,M313I      ID FOR MESSAGE IKJ56313I             60980102
         B     IMSGS               ISSUE MESSAGE                        61040102
         SPACE                                                          61070102
         EJECT                                                          61100102
*********************************************************************** 61160102
*                                                                     * 61220102
*                          D E C L A R E S                            * 61280102
*                                                                     * 61340102
*********************************************************************** 61370102
         DS    0F                                                       61400102
PATCH67  DC    30C'ZAP67'          PATCH AREA FOR F.E. ZAPS             61460102
NOJOBID  DC    D'0'                NO JOBID IN SSSOJOBI        @ZM30982 61490103
FOUR     DC    H'4'                BASE ADDR ADJUSTMENT                 61520102
FIVE     DC    H'5'                ADJUSTMENT                           61580102
SIX      DC    H'6'                BASE ADDR ADJUSTMENT                 61640102
TEN      DC    H'10'               SET OFFSETS FOR MSG SEGMENT          61670102
TWELVE   DC    H'12'               USE TO MULTIPLY, AND AS A LENGTH     61700102
FORTY2   DC    H'42'               CONSTANT                             61760102
HUNDRED  DC    H'100'              SUBTRACT FROM MSGID ON INFO MSG      61820102
*                                                                       61880102
ONESEG   DC    F'1'                SEGMENT NO. FOR OUTPUT LINE          61940102
TWOSEG   DC    F'2'                SEGMENT NO. FOR OUTPUT LINE          61970102
TWO      EQU   TWOSEG              USED FOR SUBTRACTION                 62000102
THREESEG DC    F'3'                SEGMENT NO. FOR OUTPUT LINE          62060102
FOURSEG  DC    F'4'                SEGMENT NO. FOR OUTPUT LINE          62120102
SEGAOFST DC    H'0'                OFFSET FOR SEGMENT A IN 'OLD' IS     62180102
*                                  ALWAYS 0                             62240102
         DS    0F                                                       62270102
SUBPOOL1 DC    X'01000000'         INDICATE SP 1 FOR FREEMAIN           62300102
TABLE    EQU   *                   TRANSLATE TABLE FOR RETURN CODES     62360102
         DC    C'0123456789ABCDEF' TRANSLATE TABLE                      62420102
VMSGCON  DC    V(IKJCT4MC)         ADDR OF MESSAGE CONSTANTS CSECT      62480102
*                                                                       62540102
         EJECT                                                          62570102
*********************************************************************** 62600102
*     PUTGET/PUTLINE LIST FORMS                                       * 62660102
*********************************************************************** 62720102
PUTLINL  PUTLINE  MF=L             LIST FORM OF PUTLINE MACRO           62780102
ENDPUTLN EQU   *                                                        62840102
PUTLSIZE EQU   ENDPUTLN-PUTLINL    LENGTH OF PUTLINE MACRO              62870102
         SPACE                                                          62900102
PUTGL    PUTGET MF=L               LIST FORM OF PUTGET MACRO            62960102
ENDPTGT  EQU   *                                                        63020102
PUTGSIZE EQU   ENDPTGT-PUTGL       LENGTH OF PUTGET MACRO               63080102
         SPACE 6                                                        63140102
*********************************************************************** 63170102
*              CONSTANTS FOR MODE MSG 'OLD' & SEG1                      63200102
*********************************************************************** 63260102
MODEMSG  DC    F'1',4F'0',H'13',H'0',C'         '      MODE MSG CONST   63320102
MODELN   EQU   *-MODEMSG           LENGTH                               63380102
         SPACE 2                                                        63440102
         EJECT                                                          63470102
*********************************************************************** 63500102
*                                                                     * 63560102
*        EXECUTABLE 'MOVE INSTRUCTIONS' FOR THE CONSTANT AND THE      * 63620102
*        VARIABLE PORTIONS OF THE MESSAGE INTO THE PROPER SEGMENTS    * 63680102
*        WHICH THE 'OLD' POINTS TO.                                   * 63740102
*                                                                     * 63770102
*********************************************************************** 63800102
MVCTEXT  MVC   MSGSEGAT(0),ZERO(R2)   MOVE SEG A TEXT INTO OUT LINE     63860102
MVCVAR1  MVC   MSGSEGBT(0),ZERO(R7)   MOVE SEG B VARIABLE INTO OUT L    63920102
MVCVAR2  MVC   MSGSEGCT(0),ZERO(R7)   MOVE SEG C VARIABLE INTO OUT L    63980102
MVCVAR3  MVC   MSGSEGDT(0),ZERO(R7)   MOVE SEG D VARIABLE INTO OUT L    64040102
         EJECT                                                          64070102
*********************************************************************** 64100102
*  MSG INSERTS - SERVICE ROUTINE NAMES                                * 64160102
*********************************************************************** 64220102
PARSE    DC    H'5'                INSERT LENGTH                        64280102
         DC    C'PARSE'            INSERT NAME                          64340102
         SPACE                                                          64370102
PUTGET   DC    H'6'                INSERT LENGTH                        64400102
         DC    C'PUTGET'           INSERT NAME                          64460102
         SPACE                                                          64520102
SCAN1    DC    H'12'               INSERT LENGTH                        64580102
         DC    C'COMMAND SCAN'     INSERT NAME                          64640102
         SPACE                                                          64670102
STAE     DC    H'11'               INSERT LENGTH                        64700102
         DC    C'ESTAE MACRO'      INSERT NAME                          64760102
         SPACE                                                          64820102
HELP     DC    H'4'                INSERT LENGTH                        64880102
         DC    C'HELP'             INSERT NAME                          64940102
         SPACE                                                          64970102
ATTCH    DC     H'6'               INSERT LENGTH                        65000102
         DC    C'ATTACH'           INSERT NAME                          65060102
         SPACE 2                                                        65120102
STAXMAC  DC    H'10'               INSERT LENGTH                        65180102
         DC    C'STAX MACRO'       INSERT NAME                          65240102
         SPACE 2                                                        65270102
STAT     DC    H'6'                INSERT LENGTH                        65300102
         DC    C'STATUS'           INSERT NAME                          65360102
         EJECT                                                          65420102
*********************************************************************** 65480102
*                                                                     * 65540102
*                                                                     * 65570102
*            SAVE AREA AND WORK AREA DSECT                            * 65600102
*                                                                     * 65660102
*                                                                     * 65720102
*********************************************************************** 65780102
SAVEAREA DSECT                                                          65840102
         SPACE 2                                                        65870102
*********************************************************************** 65900102
*                  REGISTER SAVE AREA                                 * 65960102
*********************************************************************** 66020102
         DS    F                   REGISTER                             66080102
SAVEBACK DS    F                   BACKWARD POINTER                     66140102
SAVEFORW DS    F                   FORWARD POINTER                      66170102
         DS    15F                 REGISTERS                            66200102
         SPACE 2                                                        66260102
*********************************************************************** 66320102
*              OUTPUT LINE DESCRIPTORS (OLD) AND MESSAGE SEGMENTS     * 66380102
*********************************************************************** 66440102
SAVOUTL1 DS    68F                  OLD FOR 1ST LEVEL MESSAGE           66470102
SAVOUTL2 DS    68F                  OLD FOR 2ND LEVEL MESSAGE           66500102
         SPACE 2                                                        66560102
*********************************************************************** 66620102
*             SWITCHES                                                * 66680102
*********************************************************************** 66740102
SAVSW    DS    XL1                 SWITCH                               66770102
SAVSWCLR EQU   X'00'               CLEAR SWITCH                         66800102
SAVPUTL1 EQU   X'04'               ONE UNSUCCESSFUL PUTLINE-AVOID LOOP  66860102
SAVPTGTP EQU   X'08'               INDICATE PUTGET (PROMPT),NOT PUTLINE 66920102
SAVPGPOF EQU   X'F7'               TURN OFF PUTGET (PROMPT) REQ BIT     66980102
SAVSECMG EQU   X'10'               SECURITY EXIT MESSAGE PROCESSED      67040102
SAVMULTI EQU   X'40'               MULTI LEVEL                          67070102
SAVMLVOF EQU   X'BF'               TURN OFF MULTI LEVEL SW              67100102
SAV2LVL  EQU   X'80'               2ND LEVEL MSG BEING PROCESSED        67160102
SAV2LVOF EQU   X'7F'               TURN OFF 2ND LEVEL BIT               67220102
SAVSET   EQU   X'C0'               SET BOTH ABOVE CONDITIONS            67280102
         SPACE 2                                                        67340102
*********************************************************************** 67370102
*             WORK AREAS AND MISCELLANEOUS                            * 67400102
*********************************************************************** 67460102
SAVRTCD  DS    D                   UNPACKED DECIMAL RETURN CODE         67520102
         DS    0F                                                       67580102
SAVSVRTN DS    A                   ADDR OF SERVICE ROUTINE VARIABLE     67640102
         SPACE 2                                                        67940102
*********************************************************************** 67970102
*            LIST FORMS                                               * 68000102
*********************************************************************** 68060102
         DS    0F                                                       68120102
SAVPUTGT PUTGET MF=L               PUTGET LIST - IN GETMAIN AREA        68180102
         SPACE 2                                                        68240102
SAVPUTL  PUTLINE MF=L              PUTLINE LIST - IN GETMAIN AREA       68270102
         SPACE  5                                                       68300102
*********************************************************************** 68360102
*     CORE FOR VSAMFAIL PARAMETER LIST                                * 68420102
*********************************************************************** 68480102
         IKJEFFGF                                                       68540102
         SPACE  5                                                       68570102
*********************************************************************** 68600102
*     CORE FOR DAIRFAIL PARAMETER LIST                                  68660102
*********************************************************************** 68720102
         IKJEFFDF    DFDSECT=NO                                         68780102
         SPACE 3                                                        68840102
*********************************************************************** 68870102
*        AREAS POINTED TO BY THE DAIRFAIL PARAMETER LIST              * 68900102
*********************************************************************** 68960102
F18RC    DS    F                    REG15 RETURN CODE FROM DAIR/DYNALC  69020102
F18MW    DS    F                    ADDR OF IKJEFF02 OR ZEROS           69080102
F18ID    DS    H                    ID FOR DAIR OR DYNAMIC ALLOC        69140102
         SPACE 5                                                        69170102
SAVLTH   EQU   *-SAVEAREA                                               69200102
         EJECT                                                          69260102
*********************************************************************** 69320102
*               MAP FOR MESSAGE CHARACTERISTICS -                     * 69380102
*               MAPS AN ENTRY IN THE MGCHAR TABLE BELOW               * 69440102
*********************************************************************** 69470102
MSGCHAR  DSECT                                                          69500102
         DS    0F                                                       69560102
MSGCSEGN DS    XL1                 THIS FIELD IS NOT REFERENCED BY      69620102
*                                  THE PROGRAM, IT IS MERELY A          69680102
*                                  PLACEHOLDER WHICH INDICATES THE      69740102
*                                  NUMBER OF SEGMENTS THAT COM-         69770102
*                                  PRISE THE MESSAGE.                   69800102
*                                  THE CODE IS AS FOLLOWS:              69860102
*                                                                       69920102
*                             00 -1 SEGMENT  (BASE OR CONSTANT TEXT)    69980102
*                             04 -2 SEGMENTS (1 VARIABLE INSERT)        70040102
*                             08 -3 SEGMENTS (2 VARIABLE INSERTS)       70070102
*                             0C -4 SEGMENTS (3 VARIABLE INSERTS)       70100102
         SPACE                                                          70160102
MSGCVAR1 DS    XL1                 1ST VARIABLE - INDICATES THE         70220102
*                                  VARIABLE FIRST TO BE INSERTED        70280102
*                                  IN THE MESSAGE.  THE VALUES          70340102
*                                  ASSIGNED TO THE VARIABLES ARE        70370102
*                                  USED TO INDEX INTO BRTABVI TO        70400102
*                                  FIGURE THE VARIABLE TO INSERT.       70460102
*                                  THE ASSIGNMENTS ARE AS FOLLOWS:      70520102
*                                          00 - NONE                    70580102
*                                          04 - JOBNAME                 70640102
*                                          08 - CLASSNAME               70670102
*                                          0C - USERID                  70700102
*                                          10 - COMMAND                 70760102
*                                          14 - REGISTER RETURN CODE    70820102
*                                          18 - RETURN CODE             70880102
*                                          1C - DSNAME-PRINT/SAVE       70940102
*                                          20 - REMOTE STATION ID       70970102
*                                          24 - SERVICE ROUTINE         71000102
*                                          28 - UNUSED                  71060102
*                                          2C - SYSTEM SUPPLIED JOBID   71120102
*                                          30 - RPL CODE                71180102
*                                          34 - USER SUPPLIED JOBID     71240102
*                                          38 - SECURITY EXIT MSG       71270102
*                                          3C - UNUSED                  71300102
*                                          40 - FIB MACRO               71360102
*                                          44 - SUBSYSTEM               71420102
*                                          48 - DSNAME-SYSOUT DS        71480102
*                                          4C - MEMBER NAME             71540102
*                                          50 - SYNAD INFO-PRINT/SAVE   71550102
         SPACE                                                          71570102
MSGCVAR2 DS    XL1                 2ND VARIABLE - INDICATES THE         71600102
*                                  SECOND INSERTED VARIABLE.  THE       71660102
*                                  VALUES GIVEN TO THE VARIABLES        71720102
*                                  ARE AS ABOVE                         71780102
         SPACE                                                          71840102
MSGCVAR3 DS    XL1                 3RD VARIABLE - INDICATES THE         71870102
*                                  THIRD INSERTED VARIABLE.  THE        71900102
*                                  VALUES GIVEN TO THE VARIABLES        71960102
*                                  ARE AS ABOVE                         72020102
         SPACE                                                          72080102
MSGCMSGP DS    AL4                 ADDR OF MESSAGE CONSTANTS            72140102
         SPACE                                                          72170102
MSGC2LVP DS    AL4                 ADDR OF CHARACTERISTICS OF RE-       72200102
*                                  LATED 2ND LEVEL MESSAGE              72260102
         EJECT                                                          72320102
*********************************************************************** 72380102
*               MESSAGE CHARACTERISTICS - THE FOLLOWING               * 72440102
*               CONSTANTS DESCRIBE THE CHARACTERISTICS                * 72470102
*               OF THE MESSAGES ISSUED BY THIS ROUTINE.               * 72500102
*               THE 'MSGCHAR' DSECT ABOVE THE CONSTANTS               * 72560102
*               DESCRIBES THEIR FIELDS AS WELL AS PROVIDING           * 72620102
*               A MAP FOR THE AREA.                                   * 72680102
*********************************************************************** 72740102
IKJCT4MC CSECT                                                          72752102
         SPACE 3                                                        72800102
*********************************************************************** 72860102
*               1ST LEVEL MESSAGE CHARACTERISTICS                     * 72902102
*********************************************************************** 72980102
         SPACE                                                          73040102
*              NO.                       ADDR 2ND MSG       MSG         73070102
*              SEG.  VARIABLES MSG ADDR  CHARACTERISTICS    ID          73100102
*              ----  --------- --- ----  ---------------    --          73160102
*        SPACE 2                                                        73220102
MGCHAR   DS    0F                                                       73280102
         DS    12C                                          100         73340102
         DS    12C                                          101         73370102
         DC    X'04',X'040000',A(MSG340),A(0)               102         73400102
         DC    X'0C',X'104014',A(MSG342A),A(MGC342S1)       103         73460102
         DC    X'08',X'101400',A(MSG342B),A(MGC342S1)       104         73520102
         DS    12C                                          105         73580102
         DC    X'04',X'1C0000',A(MSG309),A(0)               106         73640102
         DC    X'04',X'1C0000',A(MSG357),A(0)               107         73670102
         DC    X'04',X'040000',A(MSG339A),A(0)              108@ZM30982 73700103
         DC    X'08',X'042C00',A(MSG339),A(0)               109@ZM30982 73760103
         DC    X'04',X'1C0000',A(MSG310),A(0)               110         73820102
         DC    X'00',X'000000',A(MSG312A),A(0)              111         73880102
         DC    X'00',X'000000',A(MSG312),A(0)               112         73940102
         DC    X'08',X'241400',A(MSG313),A(0)               113         73970102
         DC    X'08',X'101800',A(MSG318),A(MGC318S1)        114         74000102
         DC    X'08',X'241800',A(MSG318A),A(0)              115         74060102
         DC    X'08',X'101800',A(MSG318),A(MGC318S3)        116         74120102
         DC    X'08',X'101800',A(MSG318A),A(0)              117         74180102
         DC    X'0C',X'042C08',A(MSG320),A(0)               118@ZM30982 74240103
         DC    X'04',X'0C0000',A(MSG321),A(MGC321S1)        119         74270102
         DC    X'08',X'040800',A(MSG320A),A(0)              120@ZM30982 74300103
         DC    X'08',X'1C4C00',A(MSG325A),A(0)              121         74360102
         DC    X'04',X'1C0000',A(MSG325),A(0)               122         74420102
         DC    X'04',X'380000',A(MSG328A),A(MGC328S1)       123         74480102
         DC    X'04',X'380000',A(MSG328I),A(0)              124         74540102
         DS    12C                                          125         74570102
         DC    X'04',X'1C0000',A(MSG330),A(MGC330S1)        126         74600102
         DC    X'04',X'040000',A(MSG343A),A(0)              127@ZM30982 74660103
         DC    X'00',X'000000',A(MSG323),A(0)               128         74720102
         DC    X'04',X'040000',A(MSG350),A(0)               129         74780102
         DC    X'04',X'200000',A(MSG351),A(0)               130         74840102
         DC    X'08',X'042C00',A(MSG343),A(0)               131         74870102
         DC    X'04',X'480000',A(MSG344),A(MGC344S1)        132         74900102
         DC    X'08',X'441400',A(MSG345),A(MGC345S1)        133         74960102
         DC    X'08',X'441400',A(MSG346),A(MGC346S1)        134         75020102
         DC    X'04',X'440000',A(MSG347),A(MGC347S1)        135         75080102
         DC    X'04',X'040000',A(MSG348),A(MGC348S1)        136         75140102
         DC    X'08',X'043400',A(MSG349),A(MGC349S1)        137         75170102
         DC    X'04',X'140000',A(MSG353),A(MGC353S1)        138         75200102
         DS    12C                                          139         75260102
         DC    X'04',X'1C0000',A(MSG355),A(MGC355S1)        140         75320102
         DS    12C                                          141         75380102
         DC    X'04',X'140000',A(MSG332),A(0)               142         75440102
         DC    X'04',X'380000',A(MSG333),A(0)               143         75470102
         DS    12C                                          144         75500102
         DC    X'04',X'100000',A(MSG341),A(0)               145         75560102
         DC    X'04',X'140000',A(MSG358),A(MGC358S1)        146         75620102
         DS    12C                                          147         75680102
         DS    12C                                          148         75740102
         EJECT                                                          75770102
*********************************************************************** 75800102
*               2ND  LEVEL MESSAGE CHARACTERISTICS                    * 75860102
*********************************************************************** 75920102
         SPACE                                                          75980102
*               NO.                                                     76040102
*               SEG. VARIABLES  MSG ADDR                                76070102
*               ---- ---------  --- ----                                76100102
         SPACE                                                          76160102
         DS    0F                                                       76220102
MGC318S1 DC    X'04',X'1C0000',A(MSG318S1)    2ND LEVEL CHARACTERISTICS 76280102
MGC318S3 DC    X'04',X'1C0000',A(MSG318S3)    2ND LEVEL CHARACTERISTICS 76340102
MGC321S1 DC    X'00',X'000000',A(MSG321S1)    2ND LEVEL CHARACTERISTICS 76370102
MGC328S1 DC    X'00',X'000000',A(MSG328S1)    2ND LEVEL CHARACTERISTICS 76400102
MGC330S1 DC    X'00',X'000000',A(MSG330S1)    2ND LEVEL CHARACTERISTICS 76460102
MGC342S1 DC    X'00',X'000000',A(MSG342S1)    2ND LEVEL CHARACTERISTICS 76520102
MGC344S1 DC    X'00',X'000000',A(MSG344S1)    2ND LEVEL CHARACTERISTICS 76580102
MGC345S1 DC    X'00',X'000000',A(MSG345S1)    2ND LEVEL CHARACTERISTICS 76640102
MGC346S1 DC    X'00',X'000000',A(MSG346S1)    2ND LEVEL CHARACTERISTICS 76670102
MGC347S1 DC    X'00',X'000000',A(MSG347S1)    2ND LEVEL CHARACTERISTICS 76700102
MGC348S1 DC    X'00',X'000000',A(MSG348S1)    2ND LEVEL CHARACTERISTICS 76760102
MGC349S1 DC    X'00',X'000000',A(MSG349S1)    2ND LEVEL CHARACTERISTICS 76820102
MGC353S1 DC    X'00',X'000000',A(MSG353S1)    2ND LEVEL CHARACTERISTICS 76880102
MGC355S1 DC    X'04',X'500000',A(MSG355S1)    2ND LEVEL CHARACTERISTICS 76910102
MGC358S1 DC    X'00',X'000000',A(MSG358S1)    2ND LEVEL CHARACTERISTICS 76940102
         EJECT                                                          76970102
*********************************************************************** 77000102
*                                                                     * 77060102
*                   MESSAGE CSECT                                     * 77120102
*                                                                     * 77180102
*      THE FOLLOWING CONTAINS THE CONSTANTS NEEDED FOR ALL FIRST      * 77240102
*      AND SECOND LEVEL MESSAGES.                                     * 77270102
*          1  THE FIRST LINE FOR EACH MESSAGE CONTAINS THE            * 77300102
*             TEXT LENGTH                                             * 77360102
*          2  THE SECOND (AND POSSIBLY THIRD) LINE CONTAINS           * 77420102
*             THE TEXT MINUS ANY VARIABLE INSERTS                     * 77480102
*          3  THE SUCCEEDING LINES CONTAIN THE OFFSET INTO THE        * 77540102
*             MESSAGE TEXT WHERE THE VARIABLES WILL BE PLACED         * 77570102
*                                                                     * 77600102
*********************************************************************** 77660102
IKJCT4MC CSECT                                                          77720102
         SPACE 3                                                        77780102
MSG309   DC    H'34'                                                    77840102
         DC    C'IKJ56309I UNABLE TO OPEN DATA SET '                    77870102
         DC    X'0022'                                                  77900102
         SPACE                                                          77960102
MSG310   DC    H'70'                                                    78020102
         DC    C'IKJ56310I INVALID DATA SET NAME,  EXCEEDS 44 '         78080102
         DC    C'CHARACTERS WHEN QUALIFIED'                             78140102
         DC    X'0021'                                                  78170102
         SPACE                                                          78200102
MSG312   DC    H'55'                                                    78260102
         DC    C'IKJ56312I NOT ENOUGH VIRTUAL STORAGE TO EXECUTE '      78320102
         DC    C'COMMAND'                                               78370102
         SPACE                                                          78420102
MSG312A  DC    H'58'                                                    78470102
         DC    C'IKJ56312I NOT ENOUGH VIRTUAL STORAGE TO EXECUTE '      78520102
         DC    C'SUBCOMMAND'                                            78570102
         SPACE                                                          78620102
MSG313   DC    H'45'                                                    78670102
         DC    C'IKJ56313I COMMAND SYSTEM ERROR -  ERROR CODE '         78720102
         DC    X'0021'                                                  78770102
         DC    X'002E'                                                  78820102
         SPACE                                                          78870102
MSG318A  DC    H'49'                                                    78920102
         DC    C'IKJ56318I  ENDED DUE TO ERROR, SYSTEM ABEND CODE '     78970102
         DC    X'000A'                                                  79020102
         DC    X'0031'                                                  79070102
         SPACE                                                          79120102
MSG318   DC    H'50'                                                    79170102
         DC    C'IKJ56318I  ENDED DUE TO ERROR, SYSTEM '                79220102
         DC    C'ABEND CODE +'                                          79270102
         DC    X'000A'                                                  79320102
         DC    X'0031'                                                  79370102
         SPACE                                                          79420102
MSG318S1 DC    H'75'                                                    79470102
         DC    C'IKJ56318I NOT ENOUGH DIRECT ACCESS SPACE TO '          79520102
         DC    C'CONTAIN ALL RECORDS IN DATASET '                       79570102
         DC    X'004B'                                                  79620102
         SPACE                                                          79670102
MSG318S3 DC    H'49'                                                    79720102
         DC    C'IKJ56318I INVALID PASSWORD SPECIFIED '                 79770102
         DC    C'FOR DATASET '                                          79820102
         DC    X'0031'                                                  79870102
         SPACE                                                          79920102
MSG320   DC    H'45'                                           @ZM30982 79970103
        DC    C'IKJ56320I NO HELD OUTPUT FOR JOB () IN CLASS ' @ZM30982 80020103
         DC    X'0021'                                         @ZM30982 80070103
         DC    X'0022'                                         @ZM30982 80120103
         DC    X'002D'                                         @ZM30982 80170103
         SPACE                                                          80220103
MSG320A  DC    H'43'                                           @ZM30982 80228103
         DC    C'IKJ56320I NO HELD OUTPUT FOR JOB  IN CLASS '  @ZM30982 80236103
         DC    X'0021'                                         @ZM30982 80244103
         DC    X'002B'                                         @ZM30982 80252103
         SPACE                                                          80260103
MSG321   DC    H'38'                                                    80270102
         DC    C'IKJ56321I COMMAND NOT AUTHORIZED FOR +'                80320102
         DC    X'0025'                                                  80370102
         SPACE                                                          80420102
MSG321S1 DC    H'62'                                                    80470102
         DC    C'IKJ56321I YOUR INSTALLATION MUST AUTHORIZE USE '       80520102
         DC    C'OF THIS COMMAND'                                       80570102
         SPACE                                                          80620102
MSG323   DC    H'28'                                                    80670102
         DC    C'IKJ56323I INVALID SUBCOMMAND'                          80720102
         SPACE                                                          80770102
MSG325   DC    H'16'                                                    80820102
         DC    C'IKJ56325I  SAVED'                                      80870102
         DC    X'000A'                                                  80920102
         SPACE                                                          80970102
MSG325A  DC    H'18'                                                    81020102
         DC    C'IKJ56325I () SAVED'                                    81070102
         DC    X'000A'                                                  81120102
         DC    X'000B'                                                  81170102
         SPACE                                                          81220102
MSG328A  DC    H'11'                                                    81270102
         DC    C'IKJ56328A +'                                           81320102
         DC    X'000A'                                                  81370102
         SPACE                                                          81420102
MSG328S1 DC    H'43'                                                    81470102
         DC    C'IKJ56328A ENTER REPLY FOR INSTALLATION EXIT'           81520102
         SPACE                                                          81570102
MSG328I  DC    H'10'                                                    81620102
         DC    C'IKJ56328I '                                            81670102
         DC    X'000A'                                                  81720102
         SPACE                                                          81770102
MSG330   DC    H'51'                                                    81820102
         DC    C'IKJ56330I ORGANIZATION OF DATA SET  NOT '              81870102
         DC    C'ACCEPTABLE+'                                           81920102
         DC    X'0023'                                                  81970102
         SPACE                                                          82040102
MSG330S1 DC    H'56'                                                    82052102
         DC    C'IKJ56330I ORGANIZATION MUST BE SEQUENTIAL'             82092102
         DC    C' OR PARTITIONED'                                       82132102
         SPACE                                                          82172102
MSG332   DC    H'59'                                                    82212102
         DC    C'IKJ56332I UNABLE TO DIAGNOSE INSTALLATION '            82252102
         DC    C'EXIT RETURN CODE '                                     82292102
         DC    X'003B'                                                  82332102
         SPACE                                                          82372102
MSG333   DC    H'68'                                                    82412102
         DC    C'IKJ56333I UNABLE TO PROMPT FOR REPLY TO '              82482102
         DC    C'INSTALLATION EXIT MESSAGE '''''                        82552102
         DC    X'0043'                                                  82622102
         SPACE                                                          82700102
MSG339   DC    H'36'                                           @ZM30982 82701103
         DC    C'IKJ56339I NO HELD OUTPUT FOR JOB () '         @ZM30982 82702103
         DC    X'0021'                                         @ZM30982 82703103
         DC    X'0022'                                         @ZM30982 82704103
         SPACE                                                          82705103
MSG339A  DC    H'33'                                           @ZM30982 82710103
         DC    C'IKJ56339I NO HELD OUTPUT FOR JOB '            @ZM30982 82720103
         DC    X'0021'                                         @ZM30982 82730103
         SPACE                                                          82740103
MSG340   DC    H'24'                                                    82760102
         DC    C'IKJ56340I JOB  NOT FOUND'                              82820102
         DC    X'000E'                                                  82880102
         SPACE                                                          82940102
MSG341   DC    H'54'                                                    82970102
         DC    C'IKJ56341I  COMMAND INVALID DUE TO CONFLICTING '        83000102
         DC    C'KEYWORDS'                                              83060102
         DC    X'000A'                                                  83120102
         SPACE                                                          83180102
MSG342A  DC    H'53'                                                    83240102
         DC    C'IKJ56342I  COMMAND ENDED DUE TO FIB SVC  '             83270102
         DC    C'ERROR CODE +'                                          83300102
         DC    X'000A'                                                  83360102
         DC    X'0028'                                                  83420102
         DC    X'0034'                                                  83480102
         SPACE                                                          83540102
MSG342B  DC    H'52'                                                    83570102
         DC    C'IKJ56342I  COMMAND ENDED DUE TO FIB SVC '              83600102
         DC    C'ERROR CODE +'                                          83660102
         DC    X'000A'                                                  83720102
         DC    X'0033'                                                  83780102
         SPACE                                                          83840102
MSG342S1 DC    H'68'                                                    83870102
         DC    C'IKJ56342I REENTER COMMAND, THEN IF ERROR CALL '        83900102
         DC    C'YOUR SYSTEM PROGRAMMER'                                83960102
         SPACE                                                          84020102
MSG343   DC    H'58'                                           @ZM30982 84080103
         DC    C'IKJ56343I NO HELD OUTPUT FOR JOB () IN '      @ZM30982 84120103
         DC    C'CLASS(ES) REQUESTED'                          @ZM30982 84160103
         DC    X'0021'                                         @ZM30982 84200103
         DC    X'0022'                                         @ZM30982 84240103
         SPACE                                                          84320102
MSG343A  DC    H'56'                                           @ZM30982 84330103
         DC    C'IKJ56343I NO HELD OUTPUT FOR JOB  IN '        @ZM30982 84340103
         DC    C'CLASS(ES) REQUESTED'                          @ZM30982 84350103
         DC    X'0021'                                         @ZM30982 84360103
         SPACE                                                          84370103
MSG344   DC    H'72'                                                    84380102
         DC    C'IKJ56344I DATA SET  SKIPPED, INTERRUPTED '             84440102
         DC    C'DURING PREVIOUS OUTPUT COMMAND+'                       84470102
         DC    X'0013'                                                  84500102
         SPACE                                                          84560102
MSG344S1 DC    H'95'                                                    84620102
         DC    C'IKJ56344I IF "KEEP" WAS SPECIFIED, RETRIEVE '          84680102
         DC    C'THE DATA SET BY REENTERING THE COMMAND '               84740102
         DC    C'WITH "BEGIN"'                                          84770102
         SPACE                                                          84800102
MSG345   DC    H'51'                                                    84860102
         DC    C'IKJ56345I  SUBSYSTEM INTERFACE ERROR, RETURN '         84920102
         DC    C'CODE +'                                                84980102
         DC    X'000A'                                                  85040102
         DC    X'0032'                                                  85070102
         SPACE                                                          85100102
MSG345S1 DC    H'68'                                                    85160102
         DC    C'IKJ56345I REENTER COMMAND, THEN IF ERROR CALL '        85220102
         DC    C'YOUR SYSTEM PROGRAMMER'                                85280102
         SPACE                                                          85340102
MSG346   DC    H'41'                                                    85370102
         DC    C'IKJ56346I  SUBSYSTEM ERROR, RETURN CODE +'             85400102
         DC    X'000A'                                                  85460102
         DC    X'0028'                                                  85520102
         SPACE                                                          85580102
MSG346S1 DC    H'68'                                                    85640102
         DC    C'IKJ56346I REENTER COMMAND, THEN IF ERROR CALL '        85670102
         DC    C'YOUR SYSTEM PROGRAMMER'                                85700102
         SPACE                                                          85760102
MSG347   DC    H'49'                                                    85820102
         DC    C'IKJ56347I COMMAND FAILED -  SUBSYSTEM NOT '            85880102
         DC    C'ACTIVE+'                                               85940102
         DC    X'001B'                                                  85970102
         SPACE                                                          86000102
MSG347S1 DC    H'40'                                                    86060102
         DC    C'IKJ56347I RETRY WHEN SUBSYSTEM IS ACTIVE'              86120102
         SPACE                                                          86180102
MSG348   DC    H'75'                                                    86240102
         DC    C'IKJ56348I DUPLICATE JOBNAMES , CORRECT'                86270102
         DC    C' JOBNAME(JOBID) COMBINATION REQUIRED+'                 86300102
         DC    X'001D'                                                  86360102
         SPACE                                                          86420102
MSG348S1 DC    H'61'                                                    86480102
         DC    C'IKJ56348I STATUS COMMAND MAY BE USED TO '              86540102
         DC    C'OBTAIN A UNIQUE JOBID'                                 86570102
         SPACE                                                          86600102
MSG349   DC    H'37'                                                    86660102
         DC    C'IKJ56349I JOB () COMBINATION INVALID+'                 86720102
         DC    X'000E'                                                  86780102
         DC    X'000F'                                                  86840102
         SPACE                                                          86870102
MSG349S1 DC    H'61'                                                    86900102
         DC    C'IKJ56349I STATUS COMMAND MAY BE USED TO '              86960102
         DC    C'OBTAIN A UNIQUE JOBID'                                 87020102
         SPACE                                                          87080102
MSG350   DC    H'56'                                                    87140102
         DC    C'IKJ56350I UNABLE TO PROCESS JOB  AT THIS TIME,'        87170102
         DC    C' TRY LATER'                                            87200102
         DC    X'0020'                                                  87260102
         SPACE                                                          87320102
MSG351   DC    H'36'                                                    87380102
         DC    C'IKJ56351I INVALID REMOTE STATION ID '                  87440102
         DC    X'0024'                                                  87470102
         SPACE                                                          87500102
MSG353   DC    H'65'                                                    87560102
         DC    C'IKJ56353I SSOBRETN FIELD FROM SUBSYSTEM '              87620102
         DC    C'IS  - UNABLE TO DIAGNOSE+'                             87680102
         DC    X'002B'                                                  87740102
         SPACE                                                          87770102
MSG353S1 DC    H'68'                                                    87800102
         DC    C'IKJ56353I REENTER COMMAND, THEN IF ERROR CALL '        87860102
         DC    C'YOUR SYSTEM PROGRAMMER'                                87920102
         SPACE                                                          87980102
MSG355   DC    H'31'                                                    87986102
         DC    C'IKJ56355I DATA SET  NOT USABLE+'                       87992102
         DC    X'0013'                                                  87998102
         SPACE                                                          88004102
MSG355S1 DC    H'26'                                                    88010102
         DC    C'IKJ56355I I/O SYNAD ERROR '                            88016102
         DC    X'001A'                                                  88022102
         SPACE                                                          88028102
MSG357   DC    H'71'                                                    88040102
         DC    C'IKJ56357I DATA SET  PARTITIONED,'                      88070102
         DC    C' NO MEMBER NAME GIVEN - "TEMPNAME" USED'               88100102
         DC    X'0013'                                                  88160102
         SPACE                                                          88220102
MSG358   DC    H'51'                                                    88280102
         DC    C'IKJ56358I INVALID SEARCH ARGUMENTS, SSOBRETN '         88340102
         DC    C'CODE +'                                                88370102
         DC    X'0032'                                                  88400102
         SPACE                                                          88460102
MSG358S1 DC    H'68'                                                    88520102
         DC    C'IKJ56358I REENTER COMMAND, THEN IF ERROR CALL '        88580102
         DC    C'YOUR SYSTEM PROGRAMMER'                                88640102
         EJECT                                                          88670102
*********************************************************************** 88700102
* MAPPING OF THE OUTPUT LINE DESCRIPTOR (OLD)                         * 88760102
*********************************************************************** 88820102
OLDMAP   DSECT                MAP OF OUTPUT LINE FOR THE MAXIMUM        88880102
*                             LENGTH MESSAGE                            88940102
OLDNXTLV DS    A                   LINK TO OLD FOR NEXT LEVEL           88970102
OLDSEGNO DS    F                   NO. OF SEGMENTS                      89000102
OLDSEGA  DS    A                   ADDR OF SEGMENT A                    89060102
OLDSEGB  DS    A                   ADDR OF SEGMENT B                    89120102
OLDSEGC  DS    A                   ADDR OF SEGMENT C                    89180102
OLDSEGD  DS    A                   ADDR OF SEGMENT D                    89240102
         SPACE 5                                                        89270102
*********************************************************************** 89300102
*        THIS ENDS THE MAP OF THE OLD.  BELOW ARE AREAS POINTED       * 89360102
*        TO BY THE OLD FIELDS : OLDSEGA, OLDSEGB, OLDSEGC, OLDSEGD.   * 89420102
*        TO PROCESS MORE THAN 4 SEGMENTS, THE MAP MUST BE EXTENDED,   * 89480102
*        AND NEW CODE ADDED.                                          * 89540102
*********************************************************************** 89570102
MSGSEGAL DS    H                   SEGMENT A LENGTH (TEXT + 4)          89600102
MSGSEGAO DS    H                   SEGMENT A OFFSET                     89660102
MSGSEGAT DS    22F                 SEGMENT A TEXT                       89720102
*                                                                       89780102
MSGSEGBL DS    H                   SEGMENT B LENGTH (TEXT + 4)          89840102
MSGSEGBO DS    H                   SEGMENT B OFFSET                     89870102
MSGSEGBT DS    12F                 SEGMENT B TEXT                       89900102
*                                                                       89960102
MSGSEGCL DS    H                   SEGMENT C LENGTH (TEXT + 4)          90020102
MSGSEGCO DS    H                   SEGMENT C OFFSET                     90080102
MSGSEGCT DS    12F                 SEGMENT C TEXT                       90140102
*                                                                       90170102
MSGSEGDL DS    H                   SEGMENT D LENGTH (TEXT + 4)          90200102
MSGSEGDO DS    H                   SEGMENT D OFFSET                     90260102
MSGSEGDT DS    12F                 SEGMENT D TEXT                       90320102
MSGLTH   EQU   *-OLDMAP            LENGTH OF MAP                        90380102
         EJECT                                                          90440102
*********************************************************************** 90470102
*    MAPPING OF PDE                                                   * 90500102
*********************************************************************** 90560102
PDE      DSECT                     MAP OF ANY IKJIDENT-LIKE PDE         90620102
PDEAD    DS    A                   ADDR OF MAIN ITEM                    90680102
PDELEN   DS    H                   LENGTH OF MAIN ITEM                  90740102
PDEFLGS  DS    H                   FLAGS, ETC                           90770102
PDEAD2   DS    A                   ADDR OF 2ND ITEM                     90800102
PDELEN2  DS    H                   LENGTH OF 2ND ITEM                   90860102
         EJECT                                                          90920102
         IKJPGPB                   PUTGET PARAMETER BLOCK               90980102
         EJECT                                                          91040102
         IKJCPPL                                                        91070102
         EJECT                                                          91100102
         IKJPSCB                                                        91160102
         EJECT                                                          91220102
         IEFJSSOB    (SO),CONTIG=NO                                     91280102
         EJECT                                                          91340102
         IEFJSSIB                                                       91370102
         EJECT                                                          91400102
         IKJOCMTB                                                       91460102
         END  IKJCT467                                                  91520102
