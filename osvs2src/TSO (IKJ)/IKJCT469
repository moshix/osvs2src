         TITLE 'IKJCT469 TSO OUTPUT CP - PARSE && INITIALIZATION       *00001000
                         '                                              00002000
IKJCT469 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJCT469  76.056'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00022000
         MVC   @PC00001(4),0(@01)                                  0001 00023000
*                                                                  0087 00024000
*/********************************************************************/ 00025000
*/*                                                                  */ 00026000
*/*                                                                  */ 00027000
*/*                  ***  B E G I N    C O D E  ***                  */ 00028000
*/*                                                                  */ 00029000
*/*                                                                  */ 00030000
*/********************************************************************/ 00031000
*                                                                  0087 00032000
*   KEY1=YES;                       /* INDICATE KEY 1 FOR MSG WRITER */ 00033000
         OI    KEY1,B'10000000'                                    0087 00034000
*/********************************************************************/ 00035000
*/*                         ZERO OUTCOMTB                            */ 00036000
*/********************************************************************/ 00037000
*                                                                  0088 00038000
*   OUTCOMTB(1:256)=OUTCOMTB(1:256)&&OUTCOMTB(1:256);              0088 00039000
         XC    OUTCOMTB(256),OUTCOMTB                              0088 00040000
*   OUTCOMTB(257:LENGTH(OUTCOMTB))=OUTCOMTB(257:LENGTH(OUTCOMTB))&&     00041000
*       OUTCOMTB(257:LENGTH(OUTCOMTB));                            0089 00042000
*                                                                  0089 00043000
         XC    OUTCOMTB+256(56),OUTCOMTB+256                       0089 00044000
*/********************************************************************/ 00045000
*/*                      ZERO ESTAE WORK AREA                        */ 00046000
*/********************************************************************/ 00047000
*                                                                  0090 00048000
*   ESTAEWA(1:256)=ESTAEWA(1:256)&&ESTAEWA(1:256);                 0090 00049000
         XC    ESTAEWA(256),ESTAEWA                                0090 00050000
*   ESTAEWA(257:LENGTH(ESTAEWA))=ESTAEWA(257:LENGTH(ESTAEWA))&&ESTAEWA( 00051000
*       257:LENGTH(ESTAEWA));                                      0091 00052000
*                                                                  0091 00053000
         XC    ESTAEWA+256(84),ESTAEWA+256                         0091 00054000
*/********************************************************************/ 00055000
*/*                  SET UP ESTAE EXIT TO IKJCT460                   */ 00056000
*/********************************************************************/ 00057000
*                                                                  0092 00058000
*   EWAPTR=ADDR(ESTAEWA);           /* DYNAMIC CORE FOR ESTAE EXIT   */ 00059000
         LA    @14,ESTAEWA                                         0092 00060000
         ST    @14,EWAPTR                                          0092 00061000
*   REG2=ADDR(IKJCT460);            /* ESTAE MOD TO GET CONTROL      */ 00062000
         L     REG2,@CV00625                                       0093 00063000
*   GEN(EXTRN IKJCT460);                                           0094 00064000
         EXTRN IKJCT460                                                 00065000
*   GEN REFS(ESTALSTD,ESTAEXC,ESTALSTD,STICESTA);                  0095 00066000
         MVC   ESTALSTD(ESTAELTH),STICESTA                              00067000
ESTAEXC  ESTAE  (2),PARAM=OUTCOMTB,TERM=YES,MF=(E,ESTALSTD)             00068000
*   OUTRTCD=REG15;                  /* SAVE RETURN CODE FROM ESTAE 0096 00069000
*                                      SVC                           */ 00070000
         STH   REG15,OUTRTCD                                       0096 00071000
*   IF OUTRTCD^=ZERO THEN           /* IF NON ZERO RETURN CODE       */ 00072000
         LH    @14,OUTRTCD                                         0097 00073000
         LTR   @14,@14                                             0097 00074000
         BZ    @RF00097                                            0097 00075000
*     DO;                                                          0098 00076000
*       OUTMSGID=40;                /* ISSUE ESTAE ERROR MSG         */ 00077000
         MVI   OUTMSGID,X'28'                                      0099 00078000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MSG WRITER               */ 00079000
         LA    @14,OUTCOMTB                                        0100 00080000
         ST    @14,@AL00001                                        0100 00081000
         L     @15,@CV00621                                        0100 00082000
         LA    @01,@AL00001                                        0100 00083000
         BALR  @14,@15                                             0100 00084000
*       ERROR=YES;                  /* INDICATE ERROR                */ 00085000
         OI    ERROR,B'00001000'                                   0101 00086000
*       OUTRTCD=BADERROR;           /* STOP PROCCESING               */ 00087000
         MVC   OUTRTCD(2),@CH00150                                 0102 00088000
*     END;                                                         0103 00089000
*   ELSE                                                           0104 00090000
*     ;                                                            0104 00091000
@RF00097 DS    0H                                                  0105 00092000
*   IF ERROR=NO THEN                /* NO ERROR YET, CONTINUE      0105 00093000
*                                      PROCESSING                    */ 00094000
         TM    ERROR,B'00001000'                                   0105 00095000
         BNZ   @RF00105                                            0105 00096000
*     DO;                                                          0106 00097000
*                                                                  0106 00098000
*       /*************************************************************/ 00099000
*       /*                                                           */ 00100000
*       /* INITIALIZE SOME OUTCOMTB AND SSOB FIELDS                  */ 00101000
*       /*                                                           */ 00102000
*       /*************************************************************/ 00103000
*                                                                  0107 00104000
*       OUTCPPL=ADDR(FIBCPPLC);     /* INCOMING PARM IS THE FIB    0107 00105000
*                                      PARMLIST                      */ 00106000
         L     @14,@PC00001                                        0107 00107000
         LA    @10,FIBCPPLC(,@14)                                  0107 00108000
         ST    @10,OUTCPPL                                         0107 00109000
*       OUTCMDNM=FIBECTCN;          /* COMMAND NAME FROM ECT VIA   0108 00110000
*                                      SVC100                        */ 00111000
         MVC   OUTCMDNM(8),FIBECTCN(@14)                           0108 00112000
*       OUTSOBH=ADDR(SSOB);         /* ADDR OF SSOB TO OUTCOMTB      */ 00113000
         LA    @14,SSOB                                            0109 00114000
         ST    @14,OUTSOBH                                         0109 00115000
*       OUTSOBSO=ADDR(SSSO);        /* ADDR SYSOUT PROCESS MAP IN  0110 00116000
*                                      OUTCOMTB                      */ 00117000
         LA    @14,SSSO                                            0110 00118000
         ST    @14,OUTSOBSO                                        0110 00119000
*       SSOBSSIB=ZERO;              /* SET SUBSYSTEM NAME TO ZERO    */ 00120000
         SLR   @14,@14                                             0111 00121000
         ST    @14,SSOBSSIB                                        0111 00122000
*       SSOBLEN=LENGTH(SSOB);       /* LENGTH OF SSOB HEADER         */ 00123000
         MVC   SSOBLEN(2),@CH00236                                 0112 00124000
*       SSOBID='SSOB';              /* CONTROL BLOCK IDENTIFIER      */ 00125000
*                                                                  0113 00126000
         MVC   SSOBID(4),@CC00738                                  0113 00127000
*       /*************************************************************/ 00128000
*       /*                                                           */ 00129000
*       /* BUILD THE IOPL PARM LIST, USED GENERALLY BY OTHER MODULES */ 00130000
*       /*                                                           */ 00131000
*       /*************************************************************/ 00132000
*                                                                  0114 00133000
*       IOPLPTR=ADDR(IOPLAREA);     /* CONTIG. TO OUTCOMTB           */ 00134000
         LA    @14,IOPLAREA                                        0114 00135000
         ST    @14,IOPLPTR                                         0114 00136000
*       IOPLUPT=CPPLUPT;            /* PUT UPT ADDR IN IOPL          */ 00137000
         MVC   IOPLUPT(4,@14),CPPLUPT(@10)                         0115 00138000
*       IOPLECT=CPPLECT;            /* PUT ECT ADDR IN IOPL          */ 00139000
         MVC   IOPLECT(4,@14),CPPLECT(@10)                         0116 00140000
*       IOPLECB=ADDR(OUTATTN);      /* PUT ECB ADDR IN IOPL          */ 00141000
         LA    @10,OUTATTN                                         0117 00142000
         ST    @10,IOPLECB(,@14)                                   0117 00143000
*     END;                                                         0118 00144000
*   IF ERROR=NO THEN                /* NO ERROR YET, CONTINUE      0119 00145000
*                                      PROCESSING                    */ 00146000
@RF00105 TM    ERROR,B'00001000'                                   0119 00147000
         BNZ   @RF00119                                            0119 00148000
*     DO;                                                          0120 00149000
*                                                                  0120 00150000
*       /*************************************************************/ 00151000
*       /*                                                           */ 00152000
*       /* BUILD THE PPL TO PASS TO IKJPARS                          */ 00153000
*       /*                                                           */ 00154000
*       /*************************************************************/ 00155000
*                                                                  0121 00156000
*       PPLPTR=ADDR(PPLAREA);       /* BUILD PPL HERE                */ 00157000
         LA    PPLPTR,PPLAREA                                      0121 00158000
*       PPLECT=CPPLECT;             /* .....                         */ 00159000
         L     @14,OUTCPPL                                         0122 00160000
         MVC   PPLECT(4,PPLPTR),CPPLECT(@14)                       0122 00161000
*       PPLUPT=CPPLUPT;             /* .....                         */ 00162000
         MVC   PPLUPT(4,PPLPTR),CPPLUPT(@14)                       0123 00163000
*       PPLECB=ADDR(OUTATTN);       /* .....                         */ 00164000
         LA    @10,OUTATTN                                         0124 00165000
         ST    @10,PPLECB(,PPLPTR)                                 0124 00166000
*       PPLANS=ADDR(OUTPDL);        /* .....                         */ 00167000
         LA    @10,OUTPDL                                          0125 00168000
         ST    @10,PPLANS(,PPLPTR)                                 0125 00169000
*       PPLPCL=PCLADCON;            /* .....                         */ 00170000
         MVC   PPLPCL(4,PPLPTR),PCLADCON                           0126 00171000
*       PPLCBUF=CPPLCBUF;           /* .....                         */ 00172000
         MVC   PPLCBUF(4,PPLPTR),CPPLCBUF(@14)                     0127 00173000
*       PPLUWA=ZERO;                /* .....                         */ 00174000
*                                                                  0128 00175000
         SLR   @14,@14                                             0128 00176000
         ST    @14,PPLUWA(,PPLPTR)                                 0128 00177000
*       /*************************************************************/ 00178000
*       /*                                                           */ 00179000
*       /* LINK TO PARSE                                             */ 00180000
*       /*                                                           */ 00181000
*       /*************************************************************/ 00182000
*                                                                  0129 00183000
*       KEY1=NO;                    /* INDICATE NO LONGER IN KEY1    */ 00184000
         NI    KEY1,B'01111111'                                    0129 00185000
*       GEN(MODESET EXTKEY=SUPR);   /* KEY 0 FOR PARSE               */ 00186000
         MODESET EXTKEY=SUPR                                            00187000
*       REG1=ADDR(PPL);             /* PASS THE PPL TO IKJPARS       */ 00188000
         LR    REG1,PPLPTR                                         0131 00189000
*       GEN(LINK  EP=IKJPARS);      /* LINK TO IKJPARS               */ 00190000
         LINK  EP=IKJPARS                                               00191000
*       OUTRTCD=REG15;              /* SAVE IKJPARS' RETURN CODE     */ 00192000
         STH   REG15,OUTRTCD                                       0133 00193000
*       GEN(MODESET EXTKEY=SCHED);  /* RETURN TO KEY 1               */ 00194000
         MODESET EXTKEY=SCHED                                           00195000
*       KEY1=YES;                   /* INDICATE BACK IN KEY1         */ 00196000
*                                                                  0135 00197000
         OI    KEY1,B'10000000'                                    0135 00198000
*       /*************************************************************/ 00199000
*       /*                                                           */ 00200000
*       /* ANALYZE PARSE RETURN CODE. IF NO ERRORS GO CHECK FOR      */ 00201000
*       /* CONFLICTING KEYWORDS.                                     */ 00202000
*       /*                                                           */ 00203000
*       /*************************************************************/ 00204000
*                                                                  0136 00205000
*       IF OUTRTCD^=ZERO THEN       /* IF SOME ERROR, THEN           */ 00206000
         LH    @14,OUTRTCD                                         0136 00207000
         LTR   @14,@14                                             0136 00208000
         BZ    @RF00136                                            0136 00209000
*         DO;                                                      0137 00210000
*           IF OUTRTCD=4 THEN       /* IF RETURN CODE OF 4 PARSE     */ 00211000
         CH    @14,@CH00067                                        0138 00212000
         BNE   @RF00138                                            0138 00213000
*             ERROR=YES;            /* WAS UNABLE TO PROMPT          */ 00214000
         OI    ERROR,B'00001000'                                   0139 00215000
*           ELSE                    /* ANY OTHER ERROR CODES WILL    */ 00216000
*             DO;                   /* BE FIELDED BY '67             */ 00217000
         B     @RC00138                                            0140 00218000
@RF00138 DS    0H                                                  0141 00219000
*               OUTMSGID=12;        /* INDICATE PARSE ERROR MSG ID   */ 00220000
         MVI   OUTMSGID,X'0C'                                      0141 00221000
*               CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER          */ 00222000
         LA    @14,OUTCOMTB                                        0142 00223000
         ST    @14,@AL00001                                        0142 00224000
         L     @15,@CV00621                                        0142 00225000
         LA    @01,@AL00001                                        0142 00226000
         BALR  @14,@15                                             0142 00227000
*             END;                                                 0143 00228000
*           OUTRTCD=BADERROR;       /* OUTPUT'S ERROR CODE           */ 00229000
@RC00138 MVC   OUTRTCD(2),@CH00150                                 0144 00230000
*           ERROR=YES;              /* INDICATE ERROR FOR OTHER MODS */ 00231000
         OI    ERROR,B'00001000'                                   0145 00232000
*         END;                                                     0146 00233000
*       ELSE                        /* IF PARSE DETECTED NO ERRORS   */ 00234000
*         DO;                       /* ESTABLISH ASSEMBLER         0147 00235000
*                                      ADDRESSABILITY FOR PDL LABELS */ 00236000
         B     @RC00136                                            0147 00237000
@RF00136 DS    0H                                                  0148 00238000
*           PDLBASE=OUTPDL;                                        0148 00239000
         L     PDLBASE,OUTPDL                                      0148 00240000
*           GEN(USING IKJPARMD,PDLBASE);                           0149 00241000
         USING IKJPARMD,PDLBASE                                         00242000
*           CALL SYNTAX;            /* VALIDATE CORRECT SYNTAX AND 0150 00243000
*                                      AND SET UP OUTCOMTB SWITCHES  */ 00244000
         BAL   @14,SYNTAX                                          0150 00245000
*         END;                                                     0151 00246000
*     END;                          /* END PARSE PROCESSING          */ 00247000
@RC00136 DS    0H                                                  0153 00248000
*                                                                  0153 00249000
*/********************************************************************/ 00250000
*/*                  GO TO THE INSTALLATION EXIT                     */ 00251000
*/********************************************************************/ 00252000
*                                                                  0153 00253000
*   IF OUTRTCD=ZERO&ERROR=NO THEN   /* IF NO ERRORS THUS FAR         */ 00254000
@RF00119 LH    @14,OUTRTCD                                         0153 00255000
         LTR   @14,@14                                             0153 00256000
         BNZ   @RF00153                                            0153 00257000
         TM    ERROR,B'00001000'                                   0153 00258000
         BNZ   @RF00153                                            0153 00259000
*     CALL SECURITY;                /* CALL INSTALLATION EXIT        */ 00260000
         BAL   @14,SECURITY                                        0154 00261000
*                                                                  0155 00262000
*/********************************************************************/ 00263000
*/*  IF PRINT SPECIFIED:                                             */ 00264000
*/*              SET UP STAX ENVIRONMENT                             */ 00265000
*/*              ALLOCATE THE PRINT DATASET                          */ 00266000
*/*              OPEN THE PRINT DATASET                              */ 00267000
*/*              GET CORE FOR BUFFERS                                */ 00268000
*/********************************************************************/ 00269000
*                                                                  0155 00270000
*   IF OUTRTCD=ZERO&ERROR=NO&PRINT=YES&JOBCOUNT>ZERO THEN/* NO ERRORS   00271000
*                                      YET & PRINT SPECIFIED AND JOBS   00272000
*                                      LEFT TO PROCESS               */ 00273000
@RF00153 SLR   @14,@14                                             0155 00274000
         CH    @14,OUTRTCD                                         0155 00275000
         BNE   @RF00155                                            0155 00276000
         TM    ERROR,B'00001000'                                   0155 00277000
         BNZ   @RF00155                                            0155 00278000
         TM    PRINT,B'00000010'                                   0155 00279000
         BNO   @RF00155                                            0155 00280000
         CH    @14,JOBCOUNT                                        0155 00281000
         BNL   @RF00155                                            0155 00282000
*     DO;                                                          0156 00283000
*                                                                  0156 00284000
*       /*************************************************************/ 00285000
*       /*                                                           */ 00286000
*       /* CREATE STAX ENVIRONMENT                                   */ 00287000
*       /*                                                           */ 00288000
*       /*************************************************************/ 00289000
*                                                                  0157 00290000
*       STAXLSTD(1:STAXLTH)=STICSTAX(1:STAXLTH);/* MAP STAX LIST IN     00291000
*                                      DYNAMIC CORE                  */ 00292000
         L     @14,STAXLTH                                         0157 00293000
         BCTR  @14,0                                               0157 00294000
         EX    @14,@SM00787                                        0157 00295000
*       STXMSG='';                  /* BLANK STAX MSG AREA           */ 00296000
         MVI   STXMSG,C' '                                         0158 00297000
         MVC   STXMSG+1(7),STXMSG                                  0158 00298000
*       MODEMSG=OUTCMDNM;           /* GET NAME GIVEN TO 'OUTPUT' CP    00299000
*                                      FROM ECT VIA SVC 100          */ 00300000
         MVC   MODEMSG(8),OUTCMDNM                                 0159 00301000
*       REG2=ADDR(IKJCT472);        /* ADDR OF ATTN HANDLER MODULE   */ 00302000
         L     REG2,@CV00622                                       0160 00303000
*       GEN REFS(STAXEX,STAXLSTD,OUTCOMTB);                        0161 00304000
STAXEX STAX (2),OBUF=(STXMSG,8),USADDR=OUTCOMTB,                       *00305000
               MF=(E,STAXLSTD)                                          00306000
*       OUTRTCD=REG15;              /* SAVE RETURN CODE FROM STAX    */ 00307000
         STH   REG15,OUTRTCD                                       0162 00308000
*       IF OUTRTCD^=ZERO THEN       /* IF NONZERO RETURN CODE        */ 00309000
         LH    @14,OUTRTCD                                         0163 00310000
         LTR   @14,@14                                             0163 00311000
         BZ    @RF00163                                            0163 00312000
*         DO;                                                      0164 00313000
*           OUTMSGID=44;            /* STAX ERROR MSGID              */ 00314000
         MVI   OUTMSGID,X'2C'                                      0165 00315000
*           CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER               */ 00316000
         LA    @14,OUTCOMTB                                        0166 00317000
         ST    @14,@AL00001                                        0166 00318000
         L     @15,@CV00621                                        0166 00319000
         LA    @01,@AL00001                                        0166 00320000
         BALR  @14,@15                                             0166 00321000
*           ERROR=YES;              /* INDICATE ERROR AND QUIT       */ 00322000
         OI    ERROR,B'00001000'                                   0167 00323000
*           OUTRTCD=BADERROR;       /* PREPARE RETURN CODE 12        */ 00324000
         MVC   OUTRTCD(2),@CH00150                                 0168 00325000
*         END;                                                     0169 00326000
*       ELSE                        /* ATTENTION ENVIRONMENT CREATED,   00327000
*                                      CONTINUE                      */ 00328000
*                                                                  0170 00329000
*         /***********************************************************/ 00330000
*         /*                                                         */ 00331000
*         /* ALLOCATE THE PRINT DATA SET                             */ 00332000
*         /*                                                         */ 00333000
*         /***********************************************************/ 00334000
*                                                                  0170 00335000
*         DO;                                                      0170 00336000
         B     @RC00163                                            0170 00337000
@RF00163 DS    0H                                                  0171 00338000
*           STRCTNUM=ONE;           /* SET STRUCTURE SUBSCRIPT IN  0171 00339000
*                                      OCMTB FOR THE PRINT DATASET   */ 00340000
         MVC   STRCTNUM(4),@CF00033                                0171 00341000
*           CALL IKJCT473(ADDR(OUTCOMTB));/* CALL THE ALLOC/UNALLOC     00342000
*                                      MODULE.                       */ 00343000
         LA    @14,OUTCOMTB                                        0172 00344000
         ST    @14,@TF00001                                        0172 00345000
         LA    @14,@TF00001                                        0172 00346000
         ST    @14,@AL00001                                        0172 00347000
         L     @15,@CV00624                                        0172 00348000
         LA    @01,@AL00001                                        0172 00349000
         BALR  @14,@15                                             0172 00350000
*           IF OUTRTCD^=ZERO|ERROR=YES|NOMEMNAM(STRCTNUM)=YES THEN/*    00351000
*                                      IF '73 DETECTED ANY ERRORS    */ 00352000
         LH    @14,OUTRTCD                                         0173 00353000
         LTR   @14,@14                                             0173 00354000
         BNZ   @RT00173                                            0173 00355000
         TM    ERROR,B'00001000'                                   0173 00356000
         BO    @RT00173                                            0173 00357000
         L     @14,STRCTNUM                                        0173 00358000
         MH    @14,@CH00236                                        0173 00359000
         LA    @10,NOMEMNAM-20(@14)                                0173 00360000
         TM    0(@10),B'00000010'                                  0173 00361000
         BNO   @RF00173                                            0173 00362000
@RT00173 DS    0H                                                  0174 00363000
*             DO;                                                  0174 00364000
*               ERROR=YES;          /* TURN ON ERROR SWITCH          */ 00365000
         OI    ERROR,B'00001000'                                   0175 00366000
*               OUTRTCD=BADERROR;   /* SET ERROR RETURN CODE,END   0176 00367000
*                                      OUTPUT                        */ 00368000
         MVC   OUTRTCD(2),@CH00150                                 0176 00369000
*             END;                                                 0177 00370000
*           ELSE                    /* IF NO ERRORS IN ALLOC,      0178 00371000
*                                      CONTINUE                      */ 00372000
*                                                                  0178 00373000
*             /*******************************************************/ 00374000
*             /*                                                     */ 00375000
*             /* OPEN THE PRINT DATASET                              */ 00376000
*             /*                                                     */ 00377000
*             /*******************************************************/ 00378000
*                                                                  0178 00379000
*             DO;                                                  0178 00380000
         B     @RC00173                                            0178 00381000
@RF00173 DS    0H                                                  0179 00382000
*               DCBPTR=ADDR(DCBOUTD);/* BASE DCB DSECT ON DYNAMIC DCB*/ 00383000
         LA    @14,DCBOUTD                                         0179 00384000
         ST    @14,DCBPTR                                          0179 00385000
*               OUTDCB(STRCTNUM)=DCBPTR;/* MAKE DCB ADDR KNOWN TO  0180 00386000
*                                      OTHER MODS                    */ 00387000
         L     @10,STRCTNUM                                        0180 00388000
         MH    @10,@CH00236                                        0180 00389000
         ST    @14,OUTDCB-20(@10)                                  0180 00390000
*               DCBOUTD(1:DCBLTH)=DCBOUT(1:DCBLTH);/* MAP DCB INTO 0181 00391000
*                                      DYNAMIC CORE                  */ 00392000
         L     @09,DCBLTH                                          0181 00393000
         BCTR  @09,0                                               0181 00394000
         EX    @09,@SM00789                                        0181 00395000
*               IF NEWDS(STRCTNUM)=YES/* IF ALLOCATED DS IS NEW AND  */ 00396000
*                   &TERM=YES THEN  /* IF TERMINAL ALLOCATED         */ 00397000
         LA    @09,NEWDS-20(@10)                                   0182 00398000
         TM    0(@09),B'00000100'                                  0182 00399000
         BNO   @RF00182                                            0182 00400000
         TM    TERM,B'00001000'                                    0182 00401000
         BNO   @RF00182                                            0182 00402000
*                 DO;                                              0183 00403000
*                   DCBLRECL=132;   /* DEFAULT LRECL                 */ 00404000
         LA    @10,132                                             0184 00405000
         STH   @10,DCBLRECL+72(,@14)                               0184 00406000
*                   DCBBLKSI=132;   /* DEFAULT BLOCKSIZE             */ 00407000
         STH   @10,DCBBLKSI+52(,@14)                               0185 00408000
*                   DCBRECFM='98'X; /* RECFM IS FBS                  */ 00409000
         MVI   DCBRECFM+28(@14),X'98'                              0186 00410000
*                 END;                                             0187 00411000
*               ELSE                /* IF NOT A TERMINAL             */ 00412000
*                 DO;                                              0188 00413000
         B     @RC00182                                            0188 00414000
@RF00182 DS    0H                                                  0189 00415000
*                   DCBEXLST=ADDR(OPENEXAD);/* PROVIDE EXIT LIST     */ 00416000
         LA    @14,OPENEXAD                                        0189 00417000
         L     @10,DCBPTR                                          0189 00418000
         ST    @14,DCBEXLST+28(,@10)                               0189 00419000
*                   FLAG='85'X;     /* INDICATE END OF LIST AND DCB     00420000
*                                      EXIT                          */ 00421000
         MVI   FLAG,X'85'                                          0190 00422000
*                   ADDREXIT=ADDR(OPENEXIT);/* PTR TO OPEN EXIT      */ 00423000
         LA    @14,OPENEXIT                                        0191 00424000
         ST    @14,@TF00001                                        0191 00425000
         MVC   ADDREXIT(3),@TF00001+1                              0191 00426000
*                 END;                                             0192 00427000
*               DCBDDNAM=PRINTDDN(STRCTNUM);/* PUT DDNAME IN DCB     */ 00428000
@RC00182 L     @14,DCBPTR                                          0193 00429000
         L     @10,STRCTNUM                                        0193 00430000
         MH    @10,@CH00236                                        0193 00431000
         LA    @09,PRINTDDN-20(@10)                                0193 00432000
         MVC   DCBDDNAM+40(8,@14),0(@09)                           0193 00433000
*               GEN(OPEN (DCBOUTD,(OUTPUT)),MF=(E,OPENLSTD));      0194 00434000
         OPEN (DCBOUTD,(OUTPUT)),MF=(E,OPENLSTD)                        00435000
*               IF DCBOFOPN^=YES THEN/* OPEN UNSUCCESSFUL            */ 00436000
         L     @14,DCBPTR                                          0195 00437000
         TM    DCBOFOPN+40(@14),B'00010000'                        0195 00438000
         BO    @RF00195                                            0195 00439000
*                 DO;                                              0196 00440000
*                   OUTMSGID=106;   /* ISSUE MSG 309I                */ 00441000
         MVI   OUTMSGID,X'6A'                                      0197 00442000
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER       */ 00443000
         LA    @14,OUTCOMTB                                        0198 00444000
         ST    @14,@AL00001                                        0198 00445000
         L     @15,@CV00621                                        0198 00446000
         LA    @01,@AL00001                                        0198 00447000
         BALR  @14,@15                                             0198 00448000
*                   OUTRTCD=BADERROR;/* END 'OUTPUT'                 */ 00449000
         MVC   OUTRTCD(2),@CH00150                                 0199 00450000
*                   ERROR=YES;      /* SET ERROR SWITCH ON           */ 00451000
         OI    ERROR,B'00001000'                                   0200 00452000
*                 END;                                             0201 00453000
*               ELSE                /* PRINT DS OPENED OK            */ 00454000
*                                                                  0202 00455000
*                 /***************************************************/ 00456000
*                 /*                                                 */ 00457000
*                 /* SET DCB ATTRIB SWITCHES IN OUTCOMTB & GET PRINT */ 00458000
*                 /* BUFFERS                                         */ 00459000
*                 /*                                                 */ 00460000
*                 /***************************************************/ 00461000
*                                                                  0202 00462000
*                 DO;                                              0202 00463000
         B     @RC00195                                            0202 00464000
@RF00195 DS    0H                                                  0203 00465000
*                   DSOPEN(STRCTNUM)=YES;/* INDICATE DATASET OPEN    */ 00466000
         L     @14,STRCTNUM                                        0203 00467000
         MH    @14,@CH00236                                        0203 00468000
         LA    @10,DSOPEN-20(@14)                                  0203 00469000
         OI    0(@10),B'00100000'                                  0203 00470000
*                   IF DCBRECL='01'B THEN/* RECFM=VAR                */ 00471000
         L     @10,DCBPTR                                          0204 00472000
         TM    DCBRECL+28(@10),B'01000000'                         0204 00473000
         BNO   @RF00204                                            0204 00474000
         TM    DCBRECL+28(@10),B'10000000'                         0204 00475000
         BNZ   @RF00204                                            0204 00476000
*                     OUTRECV(STRCTNUM)=YES;/* INDICATE VAR LEN RCD  */ 00477000
         LA    @10,OUTRECV-20(@14)                                 0205 00478000
         OI    0(@10),B'00010000'                                  0205 00479000
*                   ELSE            /* RCD NOT VAR OR UNDEF          */ 00480000
*                     OUTRECV(STRCTNUM)=NO;/* MAKE SURE BIT IS OFF   */ 00481000
         B     @RC00204                                            0206 00482000
@RF00204 L     @14,STRCTNUM                                        0206 00483000
         MH    @14,@CH00236                                        0206 00484000
         LA    @10,OUTRECV-20(@14)                                 0206 00485000
         NI    0(@10),B'11101111'                                  0206 00486000
*                   IF DCBRECL='11'B THEN/* UNDEFINED REC INDICATED  */ 00487000
@RC00204 L     @14,DCBPTR                                          0207 00488000
         TM    DCBRECL+28(@14),B'11000000'                         0207 00489000
         BNO   @RF00207                                            0207 00490000
*                     DO;                                          0208 00491000
*                       OUTRECUN(STRCTNUM)=YES;/* INDICATE UNDEFINED    00492000
*                                      RECL                          */ 00493000
         L     @10,STRCTNUM                                        0209 00494000
         MH    @10,@CH00236                                        0209 00495000
         LA    @09,OUTRECUN-20(@10)                                0209 00496000
         OI    0(@09),B'00000001'                                  0209 00497000
*                       DCBLRECL=132;/* DEFAULT ALL RECORDS TO 132 0210 00498000
*                                      CHARACTERS                    */ 00499000
         MVC   DCBLRECL+72(2,@14),@CH00742                         0210 00500000
*                     END;                                         0211 00501000
*                   ELSE            /* IF LRECL DEFINED              */ 00502000
*                     OUTRECUN(STRCTNUM)=NO;/* MAKE SURE BIT IS OFF  */ 00503000
         B     @RC00207                                            0212 00504000
@RF00207 L     @14,STRCTNUM                                        0212 00505000
         MH    @14,@CH00236                                        0212 00506000
         LA    @10,OUTRECUN-20(@14)                                0212 00507000
         NI    0(@10),B'11111110'                                  0212 00508000
*                   OUTBUFL(STRCTNUM)=DCBLRECL;/* LTH OF 'PUT' BUF 0213 00509000
*                                      FOR '71                       */ 00510000
@RC00207 L     @14,STRCTNUM                                        0213 00511000
         MH    @14,@CH00236                                        0213 00512000
         L     @10,DCBPTR                                          0213 00513000
         LH    @10,DCBLRECL+72(,@10)                               0213 00514000
         STH   @10,OUTBUFL-20(@14)                                 0213 00515000
*                   REG2=DCBLRECL;  /* LENGTH FOR GETMAIN            */ 00516000
         LR    REG2,@10                                            0214 00517000
*                   GEN(GETMAIN R,LV=(2),SP=1);                    0215 00518000
         GETMAIN R,LV=(2),SP=1                                          00519000
*                   OUTBUFA(STRCTNUM)=REG1;/* ADR OF 'PUT' BUF FOR 0216 00520000
*                                      '71                           */ 00521000
         L     @14,STRCTNUM                                        0216 00522000
         MH    @14,@CH00236                                        0216 00523000
         ST    REG1,OUTBUFA-20(@14)                                0216 00524000
*                   NEEDFREE(STRCTNUM)=YES;/* NEED FREEMAIN OF PRINT    00525000
*                                      BUFFER BEFORE END             */ 00526000
         LA    @10,NEEDFREE-20(@14)                                0217 00527000
         OI    0(@10),B'00001000'                                  0217 00528000
*                 END;              /* END OF GET BUF DO GROUP       */ 00529000
*             END;                  /* END OF OPEN DO GROUP          */ 00530000
@RC00195 DS    0H                                                  0220 00531000
*         END;                      /* END OF ALLOC DO GROUP         */ 00532000
@RC00173 DS    0H                                                  0221 00533000
*     END;                          /* END OF STAX DO GROUP. ALSO END   00534000
*                                      OF PRINT ONLY PROCESSING.     */ 00535000
@RC00163 DS    0H                                                  0222 00536000
*                                                                  0222 00537000
*/********************************************************************/ 00538000
*/*      GO TO ROUTINE WHICH LOOPS TO IKJCT462 TO PROCESS JOBS       */ 00539000
*/********************************************************************/ 00540000
*                                                                  0222 00541000
*   IF OUTRTCD=ZERO&ERROR=NO&JOBCOUNT>ZERO THEN/* NO ERRORS AND THERE   00542000
*                                      ARE JOBS TO PROCESS           */ 00543000
@RF00155 SLR   @14,@14                                             0222 00544000
         CH    @14,OUTRTCD                                         0222 00545000
         BNE   @RF00222                                            0222 00546000
         TM    ERROR,B'00001000'                                   0222 00547000
         BNZ   @RF00222                                            0222 00548000
         CH    @14,JOBCOUNT                                        0222 00549000
         BNL   @RF00222                                            0222 00550000
*     CALL JBPROCES;                /* CALL LOOP THAT CALLS '62      */ 00551000
         BAL   @14,JBPROCES                                        0223 00552000
*   ELSE                                                           0224 00553000
*     ;                                                            0224 00554000
@RF00222 DS    0H                                                  0225 00555000
*                                                                  0225 00556000
*/********************************************************************/ 00557000
*/*          CLEAN UP AND RETURN                                     */ 00558000
*/********************************************************************/ 00559000
*                                                                  0225 00560000
*   GEN(IKJRLSA OUTPDL);            /* RELEASE PARSE CORE            */ 00561000
         IKJRLSA OUTPDL                                                 00562000
*   IF PRINT=YES THEN               /* THIS WAS A PRINT REQUEST      */ 00563000
         TM    PRINT,B'00000010'                                   0226 00564000
         BNO   @RF00226                                            0226 00565000
*     DO;                                                          0227 00566000
*       IF NEEDFREE(STRCTNUM)=YES THEN/* CORE GOTTEN FOR BUFFER      */ 00567000
         L     @14,STRCTNUM                                        0228 00568000
         MH    @14,@CH00236                                        0228 00569000
         LA    @10,NEEDFREE-20(@14)                                0228 00570000
         TM    0(@10),B'00001000'                                  0228 00571000
         BNO   @RF00228                                            0228 00572000
*         DO;                                                      0229 00573000
*           NEEDFREE(STRCTNUM)=NO;  /* TURN FLAG OFF                 */ 00574000
         LA    @10,NEEDFREE-20(@14)                                0230 00575000
         NI    0(@10),B'11110111'                                  0230 00576000
*           REG1=OUTBUFA(STRCTNUM); /* PUT CORE ADDR IN REG          */ 00577000
         L     REG1,OUTBUFA-20(@14)                                0231 00578000
*           REG2=OUTBUFL(STRCTNUM); /* LEN OF BUF TO FREE            */ 00579000
         LH    REG2,OUTBUFL-20(@14)                                0232 00580000
*           GEN(FREEMAIN R,LV=(2),A=(1),SP=1);/* FREE THE GOTTEN CORE*/ 00581000
         FREEMAIN R,LV=(2),A=(1),SP=1                                   00582000
*         END;                                                     0234 00583000
*       IF DSOPEN(STRCTNUM)=YES THEN/* IF THE DCB WAS OPENED         */ 00584000
@RF00228 L     @14,STRCTNUM                                        0235 00585000
         MH    @14,@CH00236                                        0235 00586000
         LA    @10,DSOPEN-20(@14)                                  0235 00587000
         TM    0(@10),B'00100000'                                  0235 00588000
         BNO   @RF00235                                            0235 00589000
*         DO;                                                      0236 00590000
*           DSOPEN(STRCTNUM)=NO;                                   0237 00591000
         LA    @10,DSOPEN-20(@14)                                  0237 00592000
         NI    0(@10),B'11011111'                                  0237 00593000
*           IF SYNADERR=NO THEN     /* NO PREVIOUS SYNAD ERRORS      */ 00594000
         TM    SYNADERR,B'10000000'                                0238 00595000
         BNZ   @RF00238                                            0238 00596000
*             GEN(CLOSE (DCBOUTD),MF=(E,CLOSLSTD));/* CLOSE DCB      */ 00597000
         CLOSE (DCBOUTD),MF=(E,CLOSLSTD)                                00598000
*           ELSE                                                   0240 00599000
*             ;                     /* SYNAD ERROR, SKIP CLOSE       */ 00600000
@RF00238 DS    0H                                                  0241 00601000
*         END;                                                     0241 00602000
*       IF DSALLOC(STRCTNUM)=YES THEN/* IF DATASET ALLOCATED         */ 00603000
@RF00235 L     @14,STRCTNUM                                        0242 00604000
         MH    @14,@CH00236                                        0242 00605000
         LA    @10,DSALLOC-20(@14)                                 0242 00606000
         TM    0(@10),B'01000000'                                  0242 00607000
         BNO   @RF00242                                            0242 00608000
*         DO;                                                      0243 00609000
*           DSALLOC(STRCTNUM)=NO;   /* TURN OFF BIT WHETHER UNALC OR    00610000
*                                      NOT SO ESTAE WON'T ATTEMPT  0244 00611000
*                                      UNALC                         */ 00612000
         LA    @10,DSALLOC-20(@14)                                 0244 00613000
         NI    0(@10),B'10111111'                                  0244 00614000
*           IF SYNADERR=NO THEN     /* NO SYNAD ERROR, SO DS WAS   0245 00615000
*                                      CLOSED, THEREFORE CAN BE UNALC*/ 00616000
         TM    SYNADERR,B'10000000'                                0245 00617000
         BNZ   @RF00245                                            0245 00618000
*             DO;                                                  0246 00619000
*               UNALCALL=YES;       /* TURN ON UNALLOC REQST BIT     */ 00620000
         OI    UNALCALL,B'00100000'                                0247 00621000
*               CALL IKJCT473(ADDR(OUTCOMTB));/* CALL '73 TO UNALLOC    00622000
*                                      DS                            */ 00623000
         LA    @14,OUTCOMTB                                        0248 00624000
         ST    @14,@TF00001                                        0248 00625000
         LA    @14,@TF00001                                        0248 00626000
         ST    @14,@AL00001                                        0248 00627000
         L     @15,@CV00624                                        0248 00628000
         LA    @01,@AL00001                                        0248 00629000
         BALR  @14,@15                                             0248 00630000
*             END;                                                 0249 00631000
*           ELSE                                                   0250 00632000
*             ;                     /* SYNAD ERROR, DS COULD NOT BE     00633000
*                                      CLOSED, SO DON'T UNALC        */ 00634000
@RF00245 DS    0H                                                  0251 00635000
*         END;                                                     0251 00636000
*     END;                                                         0252 00637000
@RF00242 DS    0H                                                  0253 00638000
*   RETURN CODE(OUTRTCD);           /* RETURN TO CALLER W/ RC        */ 00639000
@RF00226 LH    @10,OUTRTCD                                         0253 00640000
         L     @13,4(,@13)                                         0253 00641000
         L     @00,@SIZDATD                                        0253 00642000
         LR    @01,@11                                             0253 00643000
         FREEMAIN R,LV=(0),A=(1)                                        00644000
         LR    @15,@10                                             0253 00645000
         L     @14,12(,@13)                                        0253 00646000
         LM    @00,@12,20(@13)                                     0253 00647000
         BR    @14                                                 0253 00648000
*                                                                  0254 00649000
*/********************************************************************/ 00650000
*/*                                                                  */ 00651000
*/*         OPEN EXIT   -   FILL IN PRINT DS DCB DEFAULT VALUES      */ 00652000
*/*                                                                  */ 00653000
*/********************************************************************/ 00654000
*                                                                  0254 00655000
*OPENEXIT:                                                         0254 00656000
*   RFY                                                            0254 00657000
*     REG14 RSTD;                                                  0254 00658000
OPENEXIT DS    0H                                                  0255 00659000
*   IF DCBRECFM=ZERO THEN           /* IF DCBRECFM FIELD IS ZERO     */ 00660000
         L     @10,DCBPTR                                          0255 00661000
         LA    @09,28                                              0255 00662000
         ALR   @09,@10                                             0255 00663000
         CLI   DCBRECFM(@09),0                                     0255 00664000
         BNE   @RF00255                                            0255 00665000
*     DO;                           /* ASSUME LRECL AND BLOCKS NEEDED*/ 00666000
*       DCBLRECL=132;               /* STANDARD SYSOUT PRINTER LINE  */ 00667000
         MVC   DCBLRECL+72(2,@10),@CH00742                         0257 00668000
*       DCBRECFM='98'X;             /* RECFM = FBS                   */ 00669000
         MVI   DCBRECFM(@09),X'98'                                 0258 00670000
*       DCBBLKSI=3036;              /* 23 RECORDS PER BLOCK          */ 00671000
         MVC   DCBBLKSI+52(2,@10),@CH00751                         0259 00672000
*     END;                                                         0260 00673000
*   GEN(BR  REG14);                 /* BRANCH BACK TO OPEN (ADDR   0261 00674000
*                                      PLACED IN REG14 PRIOR TO    0261 00675000
*                                      ENTRY)                        */ 00676000
@RF00255 DS    0H                                                  0261 00677000
         BR  REG14                                                      00678000
*   RFY                                                            0262 00679000
*     REG14 UNRSTD;                                                0262 00680000
*                                                                  0263 00681000
*/********************************************************************/ 00682000
*/*                                                                  */ 00683000
*/*                                                                  */ 00684000
*/*                                                                  */ 00685000
*/*  B E G I N     I N T E R N A L     S U B R O U T I N E S         */ 00686000
*/*                                                                  */ 00687000
*/*                                                                  */ 00688000
*/*                                                                  */ 00689000
*/********************************************************************/ 00690000
*                                                                  0263 00691000
*                                                                  0263 00692000
*/********************************************************************/ 00693000
*/* SYNTAX:                                                          */ 00694000
*/*   THIS ROUTINE EXAMINES THE PDL RETURNED BY IKJPARS, AND REJECTS */ 00695000
*/*   THE COMMAND IF TWO OR MORE CONFLICTING KEYWORDS ARE            */ 00696000
*/*   PRESENT.  IT WILL CONSTRUCT THE NECESSARY DEFAULTS             */ 00697000
*/*   FOR OMITTED KEYWORDS, E.G., PRINT(*) IF ONLY JOB               */ 00698000
*/*   NAMES AND 'CLASS' WERE ENTERED (DEFINED BY 'PRINTING' BIT).    */ 00699000
*/*   IF A CONFLICT IS DETECTED A MSG WILL BE WRITEN (VIA IKJCT467)  */ 00700000
*/*   AND 'OUTPUT' PROCCESING WILL BE TERMINATED.                    */ 00701000
*/*   IF NO ERRORS ARE DETECTED, THEN SET SWITCHES AND FIELDS IN     */ 00702000
*/*   OUTCOMTB TO REFLECT THE SYNTAX ENTERED.                        */ 00703000
*/*                                                                  */ 00704000
*/*   NOTE -- THE FOLLOWING NOTATION IS USED: PDE'S BEGIN WITH       */ 00705000
*/*   'P', EXCEPT FOR SUBFIELDS WHICH BEGIN WITH 'S'                 */ 00706000
*/*                                                                  */ 00707000
*/*                                                                  */ 00708000
*/*    KEY TO DETERMINING WHAT OPERANDS THE USER ENTERED BY          */ 00709000
*/*    ANALYZING THE PARSE PDE'S:                                    */ 00710000
*/*                 PCLASS=0   'CLASS' NOT ENTERED                   */ 00711000
*/*                       =1   'CLASS' ENTERED                       */ 00712000
*/*                 PPRINT=0   'PRINT' NOT ENTERED                   */ 00713000
*/*                       =1   'PRINT' ENTERED                       */ 00714000
*/*                 PHERE=0    'HERE'/'BEGIN'/'NEXT' NOT ENTERED     */ 00715000
*/*                      =1    'NEXT' ENTERED                        */ 00716000
*/*                      =2    'HERE' ENTERED                        */ 00717000
*/*                      =3    'BEGIN' ENTERED                       */ 00718000
*/*                 PPAUSE=0   'PAUSE'/'NOPAUSE' NOT ENTERED         */ 00719000
*/*                       =1   'PAUSE' ENTERED                       */ 00720000
*/*                       =2   'NOPAUSE' ENTERED                     */ 00721000
*/*                 PKEEP=0    'KEEP'/'NOKEEP' NOT ENTERED           */ 00722000
*/*                      =1    'KEEP' ENTERED                        */ 00723000
*/*                      =2    'NOKEEP' ENTERED                      */ 00724000
*/*                 PHOLD=0    'HOLD'/'NOHOLD' NOT ENTERED           */ 00725000
*/*                      =1    'HOLD' ENTERED                        */ 00726000
*/*                      =2    'NOHOLD' ENTERED                      */ 00727000
*/*                 PDELETE=0  'DELETE' NOT ENTERED                  */ 00728000
*/*                        =1  'DELETE' ENTERED                      */ 00729000
*/*                 PNEWCL=0   'NEWCLASS' NOT ENTERED                */ 00730000
*/*                       =1   'NEWCLASS' ENTERED                    */ 00731000
*/*                 PDEST=0    'DEST' NOT ENTERED                    */ 00732000
*/*                      =1    'DEST' ENTERED                        */ 00733000
*/********************************************************************/ 00734000
*                                                                  0263 00735000
*SYNTAX:                                                           0263 00736000
*   PROC;                                                          0263 00737000
@EL00001 L     @13,4(,@13)                                         0263 00738000
@EF00001 L     @00,@SIZDATD                                        0263 00739000
         LR    @01,@11                                             0263 00740000
         FREEMAIN R,LV=(0),A=(1)                                        00741000
@ER00001 LM    @14,@12,12(@13)                                     0263 00742000
         BR    @14                                                 0263 00743000
SYNTAX   STM   @14,@12,@SA00002                                    0263 00744000
*   SYNSW=NO;                       /* INITIALIZE SWITCHES OFF       */ 00745000
         MVI   SYNSW,B'00000000'                                   0264 00746000
*/********************************************************************/ 00747000
*/*          INIT SYNTAX SWITCHES TO REFLECT WHAT USER ENTERED       */ 00748000
*/********************************************************************/ 00749000
*                                                                  0265 00750000
*   IF PPRINT=ONE|PHERE>=ONE|PPAUSE>=ONE|PKEEP>=ONE THEN/* PRINT, OR    00751000
*                                      NEXT/HERE/BEGIN, OR         0265 00752000
*                                      PAUSE/NOPAUSE,OR KEEP/NOKEEP     00753000
*                                      ENTERED - INDICATES USER WANTS   00754000
*                                      TO 'PRINT'                    */ 00755000
         LA    @14,1                                               0265 00756000
         CH    @14,PPRINT                                          0265 00757000
         BE    @RT00265                                            0265 00758000
         CH    @14,PHERE                                           0265 00759000
         BNH   @RT00265                                            0265 00760000
         CH    @14,PPAUSE                                          0265 00761000
         BNH   @RT00265                                            0265 00762000
         CH    @14,PKEEP                                           0265 00763000
         BH    @RF00265                                            0265 00764000
@RT00265 DS    0H                                                  0266 00765000
*     PRINTING=YES;                                                0266 00766000
         OI    PRINTING,B'10000000'                                0266 00767000
*   IF PDEST=ONE|PNEWCL=ONE THEN    /* DEST, OR NEWCLASS ENTERED - 0267 00768000
*                                      INDICATES USER WANTS TO ROUTE    00769000
*                                      DATASETS                      */ 00770000
@RF00265 LA    @14,1                                               0267 00771000
         CH    @14,PDEST                                           0267 00772000
         BE    @RT00267                                            0267 00773000
         CH    @14,PNEWCL                                          0267 00774000
         BNE   @RF00267                                            0267 00775000
@RT00267 DS    0H                                                  0268 00776000
*     ROUTING=YES;                                                 0268 00777000
         OI    ROUTING,B'01000000'                                 0268 00778000
*   IF PRINTING=NO&PHOLD>=ONE THEN  /* NO OTHER PRINT OPERANDS SO  0269 00779000
*                                      HOLD/NOHOLD FOR ROUTING       */ 00780000
@RF00267 TM    PRINTING,B'10000000'                                0269 00781000
         BNZ   @RF00269                                            0269 00782000
         LH    @14,PHOLD                                           0269 00783000
         CH    @14,@CH00033                                        0269 00784000
         BL    @RF00269                                            0269 00785000
*     ROUTING=YES;                                                 0270 00786000
*                                                                  0270 00787000
         OI    ROUTING,B'01000000'                                 0270 00788000
*/********************************************************************/ 00789000
*/*     CHECK FOR CONFLICTING KEYWORD   E R R O R  C A S E S         */ 00790000
*/********************************************************************/ 00791000
*                                                                  0271 00792000
*   IF PRINTING=YES&ROUTING=YES THEN/* PRINT AND ROUTE               */ 00793000
@RF00269 TM    PRINTING,B'11000000'                                0271 00794000
         BNO   @RF00271                                            0271 00795000
*     SYNERROR=YES;                 /* CONFLICTING KEYWORDS - CAN'T     00796000
*                                      PRINT AND ROUTE               */ 00797000
         OI    SYNERROR,B'00100000'                                0272 00798000
*   ELSE                            /* CHECK FURTHER                 */ 00799000
*     IF PRINTING=YES&PDELETE=ONE THEN/* PRINT AND DELETE            */ 00800000
         B     @RC00271                                            0273 00801000
@RF00271 TM    PRINTING,B'10000000'                                0273 00802000
         BNO   @RF00273                                            0273 00803000
         CLC   PDELETE(2),@CH00033                                 0273 00804000
         BNE   @RF00273                                            0273 00805000
*       SYNERROR=YES;               /* CONFLICTING KEYWORDS - CAN'T     00806000
*                                      PRINT AND DELETE              */ 00807000
         OI    SYNERROR,B'00100000'                                0274 00808000
*     ELSE                          /* CHECK FURTHER                 */ 00809000
*       IF ROUTING=YES&PDELETE=ONE THEN/* ROUTE AND DELETE           */ 00810000
         B     @RC00273                                            0275 00811000
@RF00273 TM    ROUTING,B'01000000'                                 0275 00812000
         BNO   @RF00275                                            0275 00813000
         CLC   PDELETE(2),@CH00033                                 0275 00814000
         BNE   @RF00275                                            0275 00815000
*         SYNERROR=YES;             /* CONFLICTING KEYWORDS - CAN'T     00816000
*                                      ROUTE AND DELETE              */ 00817000
         OI    SYNERROR,B'00100000'                                0276 00818000
*       ELSE                        /* CHECK FURTHER                 */ 00819000
*         IF PDELETE=ONE&PHOLD>=ONE THEN/* DELETE & HOLD/NOHOLD      */ 00820000
         B     @RC00275                                            0277 00821000
@RF00275 LA    @14,1                                               0277 00822000
         CH    @14,PDELETE                                         0277 00823000
         BNE   @RF00277                                            0277 00824000
         CH    @14,PHOLD                                           0277 00825000
         BH    @RF00277                                            0277 00826000
*           SYNERROR=YES;           /* CONFLICTING KEYWORDS - CAN'T     00827000
*                                      USE HOLD/NOHOLD WITH DELETE   */ 00828000
         OI    SYNERROR,B'00100000'                                0278 00829000
*         ELSE                      /* CHECK FURTHER                 */ 00830000
*           IF PRINTING=YES&PKEEP^=ONE&PHOLD=>ONE THEN/* CONFLICTING    00831000
*                                      KEYWORDS - PRINT REQUEST WITH    00832000
*                                      NOKEEP ENTERED OR DEFAULTED,     00833000
*                                      AND HOLD/NOHOLD ENTERED       */ 00834000
         B     @RC00277                                            0279 00835000
@RF00277 TM    PRINTING,B'10000000'                                0279 00836000
         BNO   @RF00279                                            0279 00837000
         LA    @14,1                                               0279 00838000
         CH    @14,PKEEP                                           0279 00839000
         BE    @RF00279                                            0279 00840000
         CH    @14,PHOLD                                           0279 00841000
         BH    @RF00279                                            0279 00842000
*             SYNERROR=YES;                                        0280 00843000
         OI    SYNERROR,B'00100000'                                0280 00844000
*           ELSE                                                   0281 00845000
*             ;                     /* NO OTHER CONFLICTS            */ 00846000
@RF00279 DS    0H                                                  0282 00847000
*   IF SYNERROR=YES THEN            /* IF SYNTAX ERRORS DETECTED     */ 00848000
@RC00277 DS    0H                                                  0282 00849000
@RC00275 DS    0H                                                  0282 00850000
@RC00273 DS    0H                                                  0282 00851000
@RC00271 TM    SYNERROR,B'00100000'                                0282 00852000
         BNO   @RF00282                                            0282 00853000
*     DO;                                                          0283 00854000
*       OUTRTCD=BADERROR;           /* SET ERROR CODE                */ 00855000
         MVC   OUTRTCD(2),@CH00150                                 0284 00856000
*       OUTMSGID=145;               /* CONFLICTING KEYWORDS MSG 341I */ 00857000
         MVI   OUTMSGID,X'91'                                      0285 00858000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MSG WRITER               */ 00859000
         LA    @14,OUTCOMTB                                        0286 00860000
         ST    @14,@AL00001                                        0286 00861000
         L     @15,@CV00621                                        0286 00862000
         LA    @01,@AL00001                                        0286 00863000
         BALR  @14,@15                                             0286 00864000
*     END;                                                         0287 00865000
*   ELSE                            /* IF NO SYNTAX ERRORS           */ 00866000
*     DO;                                                          0288 00867000
*                                                                  0288 00868000
         B     @RC00282                                            0288 00869000
@RF00282 DS    0H                                                  0289 00870000
*       /*************************************************************/ 00871000
*       /*                                                           */ 00872000
*       /* SET DEFAULT VALUES IN PDL, SYNTAX NOW HAS NO DETECTABLE   */ 00873000
*       /* ERRORS. IF ROUTING OR DELETING IS NOT SPECIFICALLY        */ 00874000
*       /* ENTERED, THEN PRINTING IS BEING DONE. IF 'PRINT' WAS NOT  */ 00875000
*       /* ENTERED, THEN THE DEFAULT IS 'PRINT(*)'. NOTE: IF THE USER*/ 00876000
*       /* ENTERS 'OUTPUT JOBNAME NOHOLD', IT IS TREATED AS A ROUTING*/ 00877000
*       /* REQUEST, NOT AS A PRINT REQUEST.                          */ 00878000
*       /*                                                           */ 00879000
*       /*************************************************************/ 00880000
*                                                                  0289 00881000
*       IF ROUTING=NO&PDELETE=ZERO THEN/* IF PRINT REQUEST           */ 00882000
         TM    ROUTING,B'01000000'                                 0289 00883000
         BNZ   @RF00289                                            0289 00884000
         SLR   @14,@14                                             0289 00885000
         CH    @14,PDELETE                                         0289 00886000
         BNE   @RF00289                                            0289 00887000
*         DO;                       /* SET PRINT DEFAULTS            */ 00888000
*           IF PPRINT=ZERO THEN     /* IF 'PRINT' NOT ENTERED, THEN  */ 00889000
         CH    @14,PPRINT                                          0291 00890000
         BNE   @RF00291                                            0291 00891000
*             DO;                                                  0292 00892000
*               PPRINT=ONE;         /* INDICATE PRINT IN PDL         */ 00893000
         MVC   PPRINT(2),@CH00033                                  0293 00894000
*               DSPDE(1:LENGTH(DSPDE))=DFLTPRNT;/* DEFAULT TO      0294 00895000
*                                      'PRINT(*)'                    */ 00896000
         LA    @14,SPRINT                                          0294 00897000
         MVC   DSPDE(24,@14),DFLTPRNT                              0294 00898000
*             END;                                                 0295 00899000
*           IF PHERE=ZERO THEN      /* IF NEITHER HERE, NEXT, OR   0296 00900000
*                                      BEGIN                         */ 00901000
@RF00291 LH    @14,PHERE                                           0296 00902000
         LTR   @14,@14                                             0296 00903000
         BNZ   @RF00296                                            0296 00904000
*             PHERE=2;              /* DEFAULT TO 'HERE'             */ 00905000
         MVC   PHERE(2),@CH00082                                   0297 00906000
*           IF PPAUSE=ZERO THEN     /* IF NEITHER PAUSE OR NOPAUSE,  */ 00907000
@RF00296 LH    @14,PPAUSE                                          0298 00908000
         LTR   @14,@14                                             0298 00909000
         BNZ   @RF00298                                            0298 00910000
*             PPAUSE=2;             /* DEFAULT TO 'NOPAUSE'          */ 00911000
         MVC   PPAUSE(2),@CH00082                                  0299 00912000
*           IF PKEEP=ZERO THEN      /* IF NEITHER KEEP NOR NOKEEP,   */ 00913000
@RF00298 LH    @14,PKEEP                                           0300 00914000
         LTR   @14,@14                                             0300 00915000
         BNZ   @RF00300                                            0300 00916000
*             PKEEP=2;              /* DEFAULT TO 'NOKEEP'           */ 00917000
         MVC   PKEEP(2),@CH00082                                   0301 00918000
*           IF PKEEP=ONE&PHOLD=ZERO THEN/* IF HOLD NOT SPECIFIED WITH   00919000
*                                      KEEP, DEFAULT TO NOHOLD       */ 00920000
@RF00300 CLC   PKEEP(2),@CH00033                                   0302 00921000
         BNE   @RF00302                                            0302 00922000
         LH    @14,PHOLD                                           0302 00923000
         LTR   @14,@14                                             0302 00924000
         BNZ   @RF00302                                            0302 00925000
*             PHOLD=2;                                             0303 00926000
         MVC   PHOLD(2),@CH00082                                   0303 00927000
*         END;                                                     0304 00928000
*       ELSE                                                       0305 00929000
*         ;                         /* ROUTING OR DELETE REQUEST - 0305 00930000
*                                      ROUTING DEFAULT (NOHOLD), DONE   00931000
*                                      AUTOMATICALLY - SEE BELOW     */ 00932000
@RF00289 DS    0H                                                  0306 00933000
*                                                                  0306 00934000
*       /*************************************************************/ 00935000
*       /*                                                           */ 00936000
*       /* SET SWITCHES/VALUES IN OUTCOMTB TO INDICATE TOTAL SYNTAX  */ 00937000
*       /*                                                           */ 00938000
*       /*************************************************************/ 00939000
*                                                                  0306 00940000
*       IF PPRINT=ONE THEN          /* IF PARSE INDICATES PRINT    0306 00941000
*                                      SPECIFIED                     */ 00942000
@RC00289 CLC   PPRINT(2),@CH00033                                  0306 00943000
         BNE   @RF00306                                            0306 00944000
*         PRINT=YES;                /* INDICATE PRINT IN OUTCOMTB    */ 00945000
         OI    PRINT,B'00000010'                                   0307 00946000
*       IF PPAUSE=ONE THEN          /* PAUSE .....                   */ 00947000
@RF00306 CLC   PPAUSE(2),@CH00033                                  0308 00948000
         BNE   @RF00308                                            0308 00949000
*         PAUSE=YES;                /* INDICATE PAUSE                */ 00950000
         OI    PAUSE,B'10000000'                                   0309 00951000
*       IF PNEWCL=ONE THEN          /* NEW CLASS .....               */ 00952000
@RF00308 CLC   PNEWCL(2),@CH00033                                  0310 00953000
         BNE   @RF00310                                            0310 00954000
*         NEWCLASS=YES;             /* INDICATE NEW CLASS            */ 00955000
         OI    NEWCLASS,B'00000001'                                0311 00956000
*       IF PHOLD=ONE THEN           /* HOLD .....                    */ 00957000
@RF00310 CLC   PHOLD(2),@CH00033                                   0312 00958000
         BNE   @RF00312                                            0312 00959000
*         HOLD=YES;                 /* INDICATE HOLD                 */ 00960000
         OI    HOLD,B'01000000'                                    0313 00961000
*       IF PHERE=ONE THEN           /* NEXT .....                    */ 00962000
@RF00312 CLC   PHERE(2),@CH00033                                   0314 00963000
         BNE   @RF00314                                            0314 00964000
*         NEXT=YES;                 /* INDICATE NEXT                 */ 00965000
         OI    NEXT,B'00001000'                                    0315 00966000
*       ELSE                        /* ELSE HERE OR BEGIN            */ 00967000
*         IF PHERE=2 THEN           /* HERE .....                    */ 00968000
         B     @RC00314                                            0316 00969000
@RF00314 CLC   PHERE(2),@CH00082                                   0316 00970000
         BNE   @RF00316                                            0316 00971000
*           HERE=YES;               /* INDICATE HERE                 */ 00972000
         OI    HERE,B'00100000'                                    0317 00973000
*         ELSE                      /* MUST BE BEGIN                 */ 00974000
*           IF PHERE=3 THEN         /* BEGIN .....                   */ 00975000
         B     @RC00316                                            0318 00976000
@RF00316 CLC   PHERE(2),@CH00257                                   0318 00977000
         BNE   @RF00318                                            0318 00978000
*             BEGIN=YES;            /* INDICATE BEGIN                */ 00979000
         OI    BEGIN,B'00010000'                                   0319 00980000
*       IF PKEEP=ONE THEN           /* KEEP .....                    */ 00981000
@RF00318 DS    0H                                                  0320 00982000
@RC00316 DS    0H                                                  0320 00983000
@RC00314 CLC   PKEEP(2),@CH00033                                   0320 00984000
         BNE   @RF00320                                            0320 00985000
*         KEEP=YES;                 /* INDICATE KEEP                 */ 00986000
         OI    KEEP,B'10000000'                                    0321 00987000
*       IF PDELETE=ONE THEN         /* DELETE .....                  */ 00988000
@RF00320 CLC   PDELETE(2),@CH00033                                 0322 00989000
         BNE   @RF00322                                            0322 00990000
*         DELETE=YES;               /* INDICATE DELETE               */ 00991000
         OI    DELETE,B'00000100'                                  0323 00992000
*       IF PDEST=ONE THEN           /* DEST .....                    */ 00993000
@RF00322 CLC   PDEST(2),@CH00033                                   0324 00994000
         BNE   @RF00324                                            0324 00995000
*         DO;                                                      0325 00996000
*           DEST=YES;               /* INDICATE DEST                 */ 00997000
         OI    DEST,B'01000000'                                    0326 00998000
*           ODESTPDE=ADDR(SDEST);   /* PUT DEST PDE IN OUTCOMTB      */ 00999000
         LA    @14,SDEST                                           0327 01000000
         ST    @14,ODESTPDE                                        0327 01001000
*         END;                                                     0328 01002000
*       IF PCLASS=ONE THEN          /* IF CLASS NOT DEFAULTED        */ 01003000
@RF00324 CLC   PCLASS(2),@CH00033                                  0329 01004000
         BNE   @RF00329                                            0329 01005000
*         OUTCPDE1=ADDR(SCLASS);    /* PUT CURRENT CLASS PDE IN    0330 01006000
*                                      OUTCOMTB                      */ 01007000
         LA    @14,SCLASS                                          0330 01008000
         ST    @14,OUTCPDE1                                        0330 01009000
*       ELSE                        /* IF NO CLASS ENTERED           */ 01010000
*         OUTCPDE1=ZERO;            /* ZERO PDE POINTER              */ 01011000
         B     @RC00329                                            0331 01012000
@RF00329 SLR   @14,@14                                             0331 01013000
         ST    @14,OUTCPDE1                                        0331 01014000
*       IF PNEWCL=ONE THEN          /* IF NEW CLASS SPECIFIED        */ 01015000
@RC00329 CLC   PNEWCL(2),@CH00033                                  0332 01016000
         BNE   @RF00332                                            0332 01017000
*         ONEWCPDE=ADDR(SNEWCL);    /* PUT PDE ADDR IN OUTCOMTB      */ 01018000
         LA    @14,SNEWCL                                          0333 01019000
         ST    @14,ONEWCPDE                                        0333 01020000
*       IF PPRINT=ONE THEN          /* IF PRINT SPECIFIED OR       0334 01021000
*                                      DEFAULTED                     */ 01022000
@RF00332 CLC   PPRINT(2),@CH00033                                  0334 01023000
         BNE   @RF00334                                            0334 01024000
*         DO;                                                      0335 01025000
*           OPRDSPDE=ADDR(SPRINT);  /* PUT PRINT DSNAME PDE IN     0336 01026000
*                                      OUTCOMTB                      */ 01027000
         LA    @14,SPRINT                                          0336 01028000
         ST    @14,OPRDSPDE                                        0336 01029000
*           IF DSNAME='*' THEN      /* AND '*' SPECIFEID OR DEFAULTED*/ 01030000
         MVC   @TF00001(4),DSNAMEAD(@14)                           0337 01031000
         L     @14,@TF00001                                        0337 01032000
         CLI   DSNAME(@14),C'*'                                    0337 01033000
         BNE   @RF00337                                            0337 01034000
*             TERM=YES;             /* INDICATES THAT THE PRINTER IS    01035000
*                                      A TERMINAL                    */ 01036000
         OI    TERM,B'00001000'                                    0338 01037000
*         END;                                                     0339 01038000
@RF00337 DS    0H                                                  0340 01039000
*       OUTJBPDE=ADDR(PJOBNAME);    /* PUT JOB NAME PDE IN OUTCOMTB  */ 01040000
@RF00334 LA    @14,PJOBNAME                                        0340 01041000
         ST    @14,OUTJBPDE                                        0340 01042000
*     END;                                                         0341 01043000
*   END SYNTAX;                                                    0342 01044000
@EL00002 DS    0H                                                  0342 01045000
@EF00002 DS    0H                                                  0342 01046000
@ER00002 LM    @14,@12,@SA00002                                    0342 01047000
         BR    @14                                                 0342 01048000
*                                                                  0343 01049000
*/****************************************************************** */ 01050000
*/*  SECURITY:                                                       */ 01051000
*/*     THE FOLLOWING ROUTINE WILL PASS CONTROL TO AN INSTALLATION   */ 01052000
*/*         EXIT FOR SECURITY CHECKING AS THE INSTALLATION DESIRES   */ 01053000
*/*         ( IBM PROVIDES IKJEFF53 FOR THIS PURPOSE )               */ 01054000
*/*                                                                  */ 01055000
*/****************************************************************** */ 01056000
*                                                                  0343 01057000
*SECURITY:                                                         0343 01058000
*   PROC;                                                          0343 01059000
SECURITY STM   @14,@12,@SA00003                                    0343 01060000
*   DCL                                                            0344 01061000
*     USERLIST CHAR(20),            /* OUTPUT CP EXTENSION TO THE  0344 01062000
*                                      INSTALLATION EXIT PARM LIST   */ 01063000
*     LOOP BIT(1),                  /* SWITCH FOR LOOPING            */ 01064000
*     QUIT BIT(1);                  /* SWITCH FOR LOOPING            */ 01065000
*   USERLIST(1:16)=OUTPLIST;        /* USER LIST OF PDES             */ 01066000
         MVC   USERLIST(16),OUTPLIST                               0345 01067000
*   USERLIST(17:18)=OUTKEYWD;       /* USER KEYWORDS ENTERED         */ 01068000
         MVC   USERLIST+16(2),OUTKEYWD                             0346 01069000
*   JOBASE=OUTJBPDE;                /* BASE JOB PDE DSECT            */ 01070000
         L     JOBASE,OUTJBPDE                                     0347 01071000
*   JOBCOUNT=ZERO;                  /* INIT JOB COUNTER TO ZERO      */ 01072000
         SLR   @14,@14                                             0348 01073000
         STH   @14,JOBCOUNT                                        0348 01074000
*   QUIT=NO;                        /* INIT LOOP SW TO ALLOW FIRST 0349 01075000
*                                      TIME THROUGH                  */ 01076000
         NI    QUIT,B'01111111'                                    0349 01077000
*   RFY                                                            0350 01078000
*     JOBPDE BASED(JOBASE);         /* BASE FOR PDE DSECT            */ 01079000
*/********************************************************************/ 01080000
*/*  'DOWHILE' LOOP TO:                                              */ 01081000
*/*     LOOP THROUGH THE JOB PDE CHAIN, CALLING THE INSTALLATION     */ 01082000
*/*     EXIT FOR EACH JOBNAME IN ORDER TO VERIFY IT.                 */ 01083000
*/********************************************************************/ 01084000
*                                                                  0351 01085000
*   DO WHILE JOBASE^=ENDCHAIN&QUIT=NO;/* LOOP TO THE EXIT TO VERIFY     01086000
*                                      JOBS UNTIL: NO MORE JOBS,   0351 01087000
*                                      ERROR IN IKJCT467, ABORT RC OR   01088000
*                                      UNKNOWN RC FROM EXIT          */ 01089000
         B     @DE00351                                            0351 01090000
@DL00351 DS    0H                                                  0352 01091000
*     PARMLIST=PARMLIST&&PARMLIST;  /* ZERO OUT PARMLIST             */ 01092000
         XC    PARMLIST(40),PARMLIST                               0352 01093000
*     JOBNAMEP=JBNAMEAD;            /* FILL IN PARMLIST              */ 01094000
         MVC   JOBNAMEP(4),JBNAMEAD(JOBASE)                        0353 01095000
*     NAMELENP=ADDR(JBNMLTH);       /* .....                         */ 01096000
         LA    @14,JBNMLTH(,JOBASE)                                0354 01097000
         ST    @14,NAMELENP                                        0354 01098000
*     USERIDP=ADDR(FIBPSCBU);       /* .....                         */ 01099000
         L     @14,@PC00001                                        0355 01100000
         LA    @10,FIBPSCBU(,@14)                                  0355 01101000
         ST    @10,USERIDP                                         0355 01102000
*     IDLENPTR=ADDR(FIBPSCBL);      /* .....                         */ 01103000
         LA    @14,FIBPSCBL(,@14)                                  0356 01104000
         ST    @14,IDLENPTR                                        0356 01105000
*     CODEP=ADDR(IEOUTPUT);         /* .....                         */ 01106000
         LA    @14,@CH00041+1                                      0357 01107000
         ST    @14,CODEP                                           0357 01108000
*     JOBIDP=JBIDADR;               /* .....                         */ 01109000
         MVC   JOBIDP(4),JBIDADR(JOBASE)                           0358 01110000
*     JIDLENP=ADDR(JBIDLTH);        /* .....                         */ 01111000
         LA    @14,JBIDLTH(,JOBASE)                                0359 01112000
         ST    @14,JIDLENP                                         0359 01113000
*     IEOUTPLP=ADDR(USERLIST);      /* .....                         */ 01114000
         LA    @14,USERLIST                                        0360 01115000
         ST    @14,IEOUTPLP                                        0360 01116000
*     LOOP=YES;                     /* ALLOW FIRST TIME THROUGH      */ 01117000
         OI    LOOP,B'10000000'                                    0361 01118000
*/********************************************************************/ 01119000
*/*  INTERNAL 'DOWHILE' LOOP TO:                                     */ 01120000
*/*     RETURN TO IKJEFF53 WITH THE SAME JOBNAME AFTER RC OF 4 OR 8. */ 01121000
*/*     THAT IS, GO BACK TO THE EXIT WITH THE SAME JOBNAME AFTER     */ 01122000
*/*     COMPLETING EXIT'S REQUEST TO ISSUE A MSG FOR THAT JOBNAME.   */ 01123000
*/********************************************************************/ 01124000
*                                                                  0362 01125000
*     DO WHILE LOOP=YES|RETCODE=4|RETCODE=8;/* LOOP WITH SAME JOBNAME*/ 01126000
         B     @DE00362                                            0362 01127000
@DL00362 DS    0H                                                  0363 01128000
*       REG1=ADDR(PARMLIST);        /* PARM FOR IKJEFF53             */ 01129000
         LA    REG1,PARMLIST                                       0363 01130000
*       GEN(LINK EP=IKJEFF53);      /* CALL SECURITY EXIT            */ 01131000
         LINK EP=IKJEFF53                                               01132000
*       RETCODE=REG15;              /* SAVE RETURN CODE              */ 01133000
         ST    REG15,RETCODE                                       0365 01134000
*                                                                  0366 01135000
*       /*************************************************************/ 01136000
*       /*                                                           */ 01137000
*       /* ANALYZE THE EXIT RETURN CODE                              */ 01138000
*       /*                                                           */ 01139000
*       /*************************************************************/ 01140000
*                                                                  0366 01141000
*       IF RETCODE^=ZERO THEN       /* IF ANY ERROR                  */ 01142000
         L     @14,RETCODE                                         0366 01143000
         LTR   @14,@14                                             0366 01144000
         BZ    @RF00366                                            0366 01145000
*         DO;                                                      0367 01146000
*           IF RETCODE=4|RETCODE=8 THEN/* SECURITY EXIT WANTS TO PASS   01147000
*                                      MSG TO USER                   */ 01148000
*                                                                  0368 01149000
         CH    @14,@CH00067                                        0368 01150000
         BE    @RT00368                                            0368 01151000
         CH    @14,@CH00041                                        0368 01152000
         BNE   @RF00368                                            0368 01153000
@RT00368 DS    0H                                                  0369 01154000
*             /*******************************************************/ 01155000
*             /*                                                     */ 01156000
*             /* RETURN CODE 4 OR 8                                  */ 01157000
*             /*                                                     */ 01158000
*             /*******************************************************/ 01159000
*                                                                  0369 01160000
*             DO;                                                  0369 01161000
*               OUTXRPLY=ZERO;      /* ZERO USER REPLY PTR           */ 01162000
         SLR   @14,@14                                             0370 01163000
         ST    @14,OUTXRPLY                                        0370 01164000
*               IF RETCODE=4 THEN   /* EXIT WANTS TO PROMPT          */ 01165000
         CLC   RETCODE(4),@CF00067                                 0371 01166000
         BNE   @RF00371                                            0371 01167000
*                 OUTMSGID=123;     /* PUTGET                        */ 01168000
         MVI   OUTMSGID,X'7B'                                      0372 01169000
*               ELSE                /* ISSUE MSG W/NO REPLY          */ 01170000
*                 OUTMSGID=124;     /* PUTLINE                       */ 01171000
         B     @RC00371                                            0373 01172000
@RF00371 MVI   OUTMSGID,X'7C'                                      0373 01173000
*               OUTXMSG=MESSAGEP;   /* PUT EXIT MSG IN OUTCOMTB      */ 01174000
@RC00371 MVC   OUTXMSG(4),MESSAGEP                                 0374 01175000
*               CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER          */ 01176000
         LA    @14,OUTCOMTB                                        0375 01177000
         ST    @14,@AL00001                                        0375 01178000
         L     @15,@CV00621                                        0375 01179000
         LA    @01,@AL00001                                        0375 01180000
         BALR  @14,@15                                             0375 01181000
*               IF ERROR=YES THEN   /* MSG HANDLER COULD NOT PUTLINE    01182000
*                                      MSG OR ELSE COULD NOT GET   0376 01183000
*                                      REPLY FROM PUTGET PROMPT      */ 01184000
         TM    ERROR,B'00001000'                                   0376 01185000
         BNO   @RF00376                                            0376 01186000
*                 DO;                                              0377 01187000
*                   QUIT=YES;       /* INDICATE QUIT LOOP WHICH CALLS   01188000
*                                      INSTALLATION EXIT             */ 01189000
         OI    QUIT,B'10000000'                                    0378 01190000
*                   LOOP=NO;        /* QUIT LOOP WITH SAME JOBNAME   */ 01191000
         NI    LOOP,B'01111111'                                    0379 01192000
*                   RETCODE=BADERROR;/* SET ERROR RC                 */ 01193000
         MVC   RETCODE(4),@CF00150                                 0380 01194000
*                 END;                                             0381 01195000
*               ELSE                /* MSG OUT SUCCESSFULLY          */ 01196000
*                 DO;                                              0382 01197000
         B     @RC00376                                            0382 01198000
@RF00376 DS    0H                                                  0383 01199000
*                   IF RETCODE=4 THEN/* REPLY REQUESTED              */ 01200000
         CLC   RETCODE(4),@CF00067                                 0383 01201000
         BNE   @RF00383                                            0383 01202000
*                     REPLYP=OUTXRPLY;/* PASS REPLY TO EXIT          */ 01203000
         MVC   REPLYP(4),OUTXRPLY                                  0384 01204000
*                   LOOP=YES;       /* LOOP BACK TO '53 WITH REPLY   */ 01205000
@RF00383 OI    LOOP,B'10000000'                                    0385 01206000
*                 END;                                             0386 01207000
*             END;                                                 0387 01208000
*           ELSE                    /* NONZERO RC OTHER THAN 4 OR 8  */ 01209000
*                                                                  0388 01210000
*             /*******************************************************/ 01211000
*             /*                                                     */ 01212000
*             /* RETURN CODE 12, 16, UNKNOWN                         */ 01213000
*             /*                                                     */ 01214000
*             /*******************************************************/ 01215000
*                                                                  0388 01216000
*             DO;                                                  0388 01217000
         B     @RC00368                                            0388 01218000
@RF00368 DS    0H                                                  0389 01219000
*               LOOP=NO;            /* AFTER THESE RCS DON'T LOOP TO    01220000
*                                      53 AGAIN WITH THIS JOBNAME    */ 01221000
         NI    LOOP,B'01111111'                                    0389 01222000
*               IF RETCODE=12 THEN  /* USER DOES NOT HAVE ACCESS TO     01223000
*                                      THIS DATA SET                 */ 01224000
         CLC   RETCODE(4),@CF00150                                 0390 01225000
         BNE   @RF00390                                            0390 01226000
*                 DO;                                              0391 01227000
*                   JBNTFND=ON;     /* FLAG JOB AS INELIGIBLE        */ 01228000
         OI    JBNTFND(JOBASE),B'10000000'                         0392 01229000
*                   RETCODE=ZERO;   /* PASS BACK ZERO RETCODE TO GET    01230000
*                                      NEXT JOBNAME                  */ 01231000
         SLR   @14,@14                                             0393 01232000
         ST    @14,RETCODE                                         0393 01233000
*                 END;                                             0394 01234000
*               ELSE                /* IF RC=16 OR UNKNOWN           */ 01235000
*                 DO;                                              0395 01236000
         B     @RC00390                                            0395 01237000
@RF00390 DS    0H                                                  0396 01238000
*                   IF RETCODE=16 THEN/* EXIT WANTS TO ABORT THIS  0396 01239000
*                                      JOBNAME                       */ 01240000
         CLC   RETCODE(4),@CF00115                                 0396 01241000
         BNE   @RF00396                                            0396 01242000
*                     RETCODE=BADERROR;/* STOP PROCESSING            */ 01243000
         MVC   RETCODE(4),@CF00150                                 0397 01244000
*                   ELSE            /* IF RETCODE NOT 4,8,12,OR 16,     01245000
*                                      IT IS UNDEFINED               */ 01246000
*                     DO;                                          0398 01247000
         B     @RC00396                                            0398 01248000
@RF00396 DS    0H                                                  0399 01249000
*                       OUTRTCD=RETCODE;                           0399 01250000
         MVC   OUTRTCD(2),RETCODE+2                                0399 01251000
*                       OUTMSGID=142;/* UNKNOWN RETURN CODE MSG      */ 01252000
         MVI   OUTMSGID,X'8E'                                      0400 01253000
*                       CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER  */ 01254000
         LA    @14,OUTCOMTB                                        0401 01255000
         ST    @14,@AL00001                                        0401 01256000
         L     @15,@CV00621                                        0401 01257000
         LA    @01,@AL00001                                        0401 01258000
         BALR  @14,@15                                             0401 01259000
*                     END;                                         0402 01260000
*                   QUIT=YES;       /* INDICATE END LOOP JBNM PDE'S  */ 01261000
@RC00396 OI    QUIT,B'10000000'                                    0403 01262000
*                   RETCODE=BADERROR;/* ERROR RC                     */ 01263000
         MVC   RETCODE(4),@CF00150                                 0404 01264000
*                 END;                                             0405 01265000
*             END;                                                 0406 01266000
@RC00390 DS    0H                                                  0407 01267000
*           OUTRTCD=RETCODE;        /* RETURN CODE FOR MAIN PROC     */ 01268000
@RC00368 MVC   OUTRTCD(2),RETCODE+2                                0407 01269000
*         END;                      /* END OF PROCESSING FOR NONZERO    01270000
*                                      INST EXIT RC                  */ 01271000
*                                                                  0408 01272000
*       /*************************************************************/ 01273000
*       /*                                                           */ 01274000
*       /* EXIT RETURN CODE 0                                        */ 01275000
*       /*                                                           */ 01276000
*       /*************************************************************/ 01277000
*                                                                  0409 01278000
*       ELSE                        /* IF 53'S RC WAS ZERO           */ 01279000
*         DO;                                                      0409 01280000
         B     @RC00366                                            0409 01281000
@RF00366 DS    0H                                                  0410 01282000
*           LOOP=NO;                /* DO NOT LOOP TO 53 AGAIN WITH     01283000
*                                      THIS JOBNAME                  */ 01284000
         NI    LOOP,B'01111111'                                    0410 01285000
*           OUTRTCD=ZERO;           /* SET RC FOR CODE THAT CALLED 0411 01286000
*                                      THIS SUBRTN (IN CASE THIS WAS    01287000
*                                      LAST JOB IN LIST SO ABOUT TO     01288000
*                                      EXIT FROM THIS SUBRTN)        */ 01289000
         SLR   @14,@14                                             0411 01290000
         STH   @14,OUTRTCD                                         0411 01291000
*         END;                                                     0412 01292000
*     END;                          /* END DO WHILE LOOP WITH SAME 0413 01293000
*                                      JOBNAME                       */ 01294000
*                                                                  0413 01295000
@RC00366 DS    0H                                                  0413 01296000
@DE00362 TM    LOOP,B'10000000'                                    0413 01297000
         BO    @DL00362                                            0413 01298000
         L     @14,RETCODE                                         0413 01299000
         CH    @14,@CH00067                                        0413 01300000
         BE    @DL00362                                            0413 01301000
         CH    @14,@CH00041                                        0413 01302000
         BE    @DL00362                                            0413 01303000
*     /***************************************************************/ 01304000
*     /*                                                             */ 01305000
*     /* THIS CODE EXECUTED WHEN DONE LOOPING TO EXIT WITH THE SAME  */ 01306000
*     /* JOBNAME                                                     */ 01307000
*     /*                                                             */ 01308000
*     /***************************************************************/ 01309000
*                                                                  0414 01310000
*     IF JBNTFND=OFF THEN           /* JOBNAME OK                    */ 01311000
         TM    JBNTFND(JOBASE),B'10000000'                         0414 01312000
         BNZ   @RF00414                                            0414 01313000
*       JOBCOUNT=JOBCOUNT+ONE;      /* INCREMENT JOB COUNTER BY 1    */ 01314000
         LH    @14,JOBCOUNT                                        0415 01315000
         LA    @14,1(,@14)                                         0415 01316000
         STH   @14,JOBCOUNT                                        0415 01317000
*     JOBASE=NEXTPDE;               /* INCRE DSECT OVER NEXT DPE     */ 01318000
@RF00414 L     JOBASE,NEXTPDE(,JOBASE)                             0416 01319000
*   END;                            /* END LOOP THRU JOB PDE CHAIN   */ 01320000
@DE00351 CL    JOBASE,@CF00706                                     0417 01321000
         BE    @DC00351                                            0417 01322000
         TM    QUIT,B'10000000'                                    0417 01323000
         BZ    @DL00351                                            0417 01324000
@DC00351 DS    0H                                                  0418 01325000
*   END SECURITY;                   /* RETURN TO MAJOR ROUTINE       */ 01326000
@EL00003 DS    0H                                                  0418 01327000
@EF00003 DS    0H                                                  0418 01328000
@ER00003 LM    @14,@12,@SA00003                                    0418 01329000
         BR    @14                                                 0418 01330000
*                                                                  0419 01331000
*/********************************************************************/ 01332000
*/* JBPROCES:                                                        */ 01333000
*/*                                                                  */ 01334000
*/*  THE FOLLOWING ROUTINE WILL CALL IKJCT462 WITH THE INFORMATION   */ 01335000
*/*     REQUIRED TO HANDLE THE JOB SPECIFIED IN THE REQUESTED        */ 01336000
*/*     MANOR.                                                       */ 01337000
*/*                                                                  */ 01338000
*/********************************************************************/ 01339000
*                                                                  0419 01340000
*JBPROCES:                                                         0419 01341000
*   PROC;                                                          0419 01342000
JBPROCES STM   @14,@12,@SA00004                                    0419 01343000
*   DCL                                                            0420 01344000
*     CLASPTR PTR(31),              /* BASE FOR CLASS PDE DSECT      */ 01345000
*     CLASS CHAR(1) BASED(CLASNMAD),/* CLASS POINTED TO BY PDE       */ 01346000
*     NEXTJOB BIT(1);               /* SWITCH - NEXT JOBNAME REQUEST */ 01347000
*   RFY                                                            0421 01348000
*     JOBPDE BASED(OUTJBPDE);       /* RESPECIFY BASE FOR DSECT      */ 01349000
*/********************************************************************/ 01350000
*/*     GROUP REQUEST (DELETE OR ROUTE).  PROCESS JOBS               */ 01351000
*/********************************************************************/ 01352000
*                                                                  0422 01353000
*   IF PRINT=NO THEN                /* DELETE OR ROUTING REQUESTED   */ 01354000
         TM    PRINT,B'00000010'                                   0422 01355000
         BNZ   @RF00422                                            0422 01356000
*     DO;                                                          0423 01357000
*       RFY                                                        0424 01358000
*         CLASSPDE BASED(CLASPTR);  /* BASE DSECT FOR CLASS PDE ON   */ 01359000
*       CLASPTR=OUTCPDE1;           /* FIRST CLASS IN CHAIN          */ 01360000
         L     CLASPTR,OUTCPDE1                                    0425 01361000
*       NEXTJOB=NO;                 /* SET SWITCH OFF                */ 01362000
         NI    NEXTJOB,B'01111111'                                 0426 01363000
*       WORKDONE=NO;                /* INIT BEFORE STARTING EACH JOB */ 01364000
*                                                                  0427 01365000
         NI    WORKDONE,B'11101111'                                0427 01366000
*       /*************************************************************/ 01367000
*       /*                                                           */ 01368000
*       /* PROCESS UNTIL NO JOBS LEFT OR AN ERROR OCCURRS            */ 01369000
*       /*                                                           */ 01370000
*       /*************************************************************/ 01371000
*                                                                  0428 01372000
*       DO WHILE OUTJBPDE^=ENDCHAIN&ERROR=NO;                      0428 01373000
         B     @DE00428                                            0428 01374000
@DL00428 DS    0H                                                  0429 01375000
*         IF JBNTFND=ON THEN        /* INSTALLATION EXIT FOUND JOB 0429 01376000
*                                      INELIGIBLE FOR PROCESSING     */ 01377000
         L     @14,OUTJBPDE                                        0429 01378000
         TM    JBNTFND(@14),B'10000000'                            0429 01379000
         BNO   @RF00429                                            0429 01380000
*           NEXTJOB=YES;            /* INDICATE TO PROCESS NEXT JOB  */ 01381000
         OI    NEXTJOB,B'10000000'                                 0430 01382000
*         IF NEXTJOB=YES THEN       /* IF NEXT JOBNAME REQUESTED     */ 01383000
@RF00429 TM    NEXTJOB,B'10000000'                                 0431 01384000
         BNO   @RF00431                                            0431 01385000
*           DO;                                                    0432 01386000
*             NEXTJOB=NO;           /* TURN OFF REQUEST BIT          */ 01387000
         NI    NEXTJOB,B'01111111'                                 0433 01388000
*             WORKDONE=NO;          /* REINIT SINCE STARTING NEW JOB.   01389000
*                                      '62 USES THIS BIT FOR GROUP 0434 01390000
*                                      REQUESTS TO SEE IF MSG NEEDED */ 01391000
         NI    WORKDONE,B'11101111'                                0434 01392000
*             OUTJBPDE=NEXTPDE;     /* MAP NEXT JOB WITH DSECT       */ 01393000
         L     @14,OUTJBPDE                                        0435 01394000
         L     @14,NEXTPDE(,@14)                                   0435 01395000
         ST    @14,OUTJBPDE                                        0435 01396000
*             CLASPTR=OUTCPDE1;     /* START WITH 1ST CLASS AGAIN    */ 01397000
         L     CLASPTR,OUTCPDE1                                    0436 01398000
*           END;                                                   0437 01399000
*         ELSE                      /* IF CURRENT JOB OK, CONTINUE   */ 01400000
*           DO;                                                    0438 01401000
         B     @RC00431                                            0438 01402000
@RF00431 DS    0H                                                  0439 01403000
*             CLASBUFF='';          /* BLANK CLASS BUFFER            */ 01404000
         MVI   CLASBUFF,C' '                                       0439 01405000
         MVC   CLASBUFF+1(7),CLASBUFF                              0439 01406000
*             CLASSCNT=ZERO;        /* ZERO CLASS COUNT              */ 01407000
*                                                                  0440 01408000
         SLR   CLASSCNT,CLASSCNT                                   0440 01409000
*             /*******************************************************/ 01410000
*             /*                                                     */ 01411000
*             /* IF THE USER SPECIFIED ONE OR MORE CLASSES, FILL THE */ 01412000
*             /* CLASSLIST UNTIL EITHER 8 CLASSES IN THE LIST OR NO  */ 01413000
*             /* MORE USER CLASSES TO PUT IN THE LIST.               */ 01414000
*             /*                                                     */ 01415000
*             /*******************************************************/ 01416000
*                                                                  0441 01417000
*             DO WHILE CLASSCNT<8&CLASPTR^=ENDCHAIN&CLASPTR^=0;    0441 01418000
         B     @DE00441                                            0441 01419000
@DL00441 DS    0H                                                  0442 01420000
*               CLASSCNT=CLASSCNT+ONE;/* INCREMENT INDEX             */ 01421000
         AL    CLASSCNT,@CF00033                                   0442 01422000
*               CLASBUFF(CLASSCNT)=CLASS;/* PUT CLASS IN BUFFER      */ 01423000
         LA    @14,CLASBUFF-1(CLASSCNT)                            0443 01424000
         L     @10,CLASNMAD(,CLASPTR)                              0443 01425000
         MVC   0(1,@14),CLASS(@10)                                 0443 01426000
*               CLASPTR=CLASSNXT;   /* REPOSITION CLASS PDE DSECT    */ 01427000
         L     CLASPTR,CLASSNXT(,CLASPTR)                          0444 01428000
*             END;                  /* IF END OF CLASS PDE CHAIN     */ 01429000
@DE00441 CH    CLASSCNT,@CH00041                                   0445 01430000
         BNL   @DC00441                                            0445 01431000
         CL    CLASPTR,@CF00706                                    0445 01432000
         BE    @DC00441                                            0445 01433000
         LTR   CLASPTR,CLASPTR                                     0445 01434000
         BNZ   @DL00441                                            0445 01435000
@DC00441 DS    0H                                                  0446 01436000
*             IF CLASPTR=ENDCHAIN|CLASPTR=0 THEN/* NO MORE CLASSES 0446 01437000
*                                      AFTER THIS TO MATCH UP, OR USE   01438000
*                                      CLASS DEFAULT                 */ 01439000
         CL    CLASPTR,@CF00706                                    0446 01440000
         BE    @RT00446                                            0446 01441000
         LTR   CLASPTR,CLASPTR                                     0446 01442000
         BNZ   @RF00446                                            0446 01443000
@RT00446 DS    0H                                                  0447 01444000
*               ENDLIST=YES;        /* INDICATE LAST CALL TO '62 FOR    01445000
*                                      THIS JOB                      */ 01446000
         OI    ENDLIST,B'00001000'                                 0447 01447000
*             CALL IKJCT462(ADDR(OUTCOMTB));/* CALL '62 TO PROCESS 0448 01448000
*                                      JOB                           */ 01449000
@RF00446 LA    @14,OUTCOMTB                                        0448 01450000
         ST    @14,@TF00001                                        0448 01451000
         LA    @14,@TF00001                                        0448 01452000
         ST    @14,@AL00001                                        0448 01453000
         L     @15,@CV00623                                        0448 01454000
         LA    @01,@AL00001                                        0448 01455000
         BALR  @14,@15                                             0448 01456000
*             RETCODE=REG15;        /* SAVE RETURN CODE              */ 01457000
         ST    REG15,RETCODE                                       0449 01458000
*             IF RETCODE>4 THEN     /* IF >4 SERIOUS ERROR           */ 01459000
         L     @14,RETCODE                                         0450 01460000
         CH    @14,@CH00067                                        0450 01461000
         BNH   @RF00450                                            0450 01462000
*               ERROR=YES;          /* INDICATE ERROR                */ 01463000
         OI    ERROR,B'00001000'                                   0451 01464000
*             IF RETCODE=4|ENDLIST=YES THEN/* END OF CLASS CHAIN     */ 01465000
@RF00450 CLC   RETCODE(4),@CF00067                                 0452 01466000
         BE    @RT00452                                            0452 01467000
         TM    ENDLIST,B'00001000'                                 0452 01468000
         BNO   @RF00452                                            0452 01469000
@RT00452 DS    0H                                                  0453 01470000
*               DO;                 /* OR '62 WANTS NEXT JOB         */ 01471000
*                 NEXTJOB=YES;      /* GET NEXT JOBNAME              */ 01472000
         OI    NEXTJOB,B'10000000'                                 0454 01473000
*                 ENDLIST=NO;       /* TURN OFF SWITCH               */ 01474000
         NI    ENDLIST,B'11110111'                                 0455 01475000
*               END;                                               0456 01476000
*           END;                    /* END PROCESSING OF ELIGIBLE JOB*/ 01477000
@RF00452 DS    0H                                                  0458 01478000
*       END;                        /* END DO WHILE LOOP OF JOB PDES */ 01479000
@RC00431 DS    0H                                                  0458 01480000
@DE00428 CLC   OUTJBPDE(4),@CF00706                                0458 01481000
         BE    @DC00428                                            0458 01482000
         TM    ERROR,B'00001000'                                   0458 01483000
         BZ    @DL00428                                            0458 01484000
@DC00428 DS    0H                                                  0459 01485000
*     END;                          /* END PROCESSING PRINT REQUEST  */ 01486000
*                                                                  0460 01487000
*/********************************************************************/ 01488000
*/*   PRINT REQUEST.    PROCESS THE JOBS FOR 'PRINT'                 */ 01489000
*/********************************************************************/ 01490000
*                                                                  0460 01491000
*   ELSE                            /* ELSE PRINT SPECIFIED          */ 01492000
*     DO WHILE OUTJBPDE^=ENDCHAIN&ENDSW=NO&ERROR=NO;/* LOOP THRU JOB    01493000
*                                      PDE'S UNLESS ERROR OR EARLY 0460 01494000
*                                      END                           */ 01495000
         B     @RC00422                                            0460 01496000
@RF00422 B     @DE00460                                            0460 01497000
@DL00460 DS    0H                                                  0461 01498000
*       WORKDONE=NO;                /* INIT SWITCH BEFORE PROCESSING    01499000
*                                      A JOB                         */ 01500000
         NI    WORKDONE,B'11101111'                                0461 01501000
*       IF JBNTFND=OFF THEN         /* IF JOB/JOBCLASS GOOD          */ 01502000
         L     @14,OUTJBPDE                                        0462 01503000
         TM    JBNTFND(@14),B'10000000'                            0462 01504000
         BNZ   @RF00462                                            0462 01505000
*         DO;                                                      0463 01506000
*           RETCODE=ZERO;           /* INIT RETCODE TO ZERO          */ 01507000
         SLR   @14,@14                                             0464 01508000
         ST    @14,RETCODE                                         0464 01509000
*           OUTCLPDE=OUTCPDE1;      /* REBASE CLASS PDE DSECT        */ 01510000
         MVC   OUTCLPDE(4),OUTCPDE1                                0465 01511000
*           RFY                                                    0466 01512000
*             CLASSPDE BASED(OUTCLPDE);/* .....                      */ 01513000
*           DO WHILE OUTCLPDE^=ENDCHAIN&RETCODE=ZERO&ENDSW=NO&ERROR=NO; 01514000
         B     @DE00467                                            0467 01515000
@DL00467 DS    0H                                                  0468 01516000
*                                   /* LOOP THRU CLASS PDE'S ONCE FOR   01517000
*                                      EACH JOB                      */ 01518000
*             CLASBUFF='';          /* BLANK CLASS BUFFER            */ 01519000
*                                                                  0468 01520000
         MVI   CLASBUFF,C' '                                       0468 01521000
         MVC   CLASBUFF+1(7),CLASBUFF                              0468 01522000
*             /*******************************************************/ 01523000
*             /*                                                     */ 01524000
*             /* IF CLASS DEFAULTED, CALL '62 THIS WAY               */ 01525000
*             /*                                                     */ 01526000
*             /*******************************************************/ 01527000
*                                                                  0469 01528000
*             IF OUTCLPDE=ZERO THEN /* IF CLASS PDE PTR ZERO         */ 01529000
         L     @14,OUTCLPDE                                        0469 01530000
         LTR   @14,@14                                             0469 01531000
         BNZ   @RF00469                                            0469 01532000
*               DO;                 /* ALL HELD CLASSES WILL BE    0470 01533000
*                                      SEARCHED                      */ 01534000
*                 CALL IKJCT462(ADDR(OUTCOMTB));/* CALL '62          */ 01535000
         LA    @14,OUTCOMTB                                        0471 01536000
         ST    @14,@TF00001                                        0471 01537000
         LA    @14,@TF00001                                        0471 01538000
         ST    @14,@AL00001                                        0471 01539000
         L     @15,@CV00623                                        0471 01540000
         LA    @01,@AL00001                                        0471 01541000
         BALR  @14,@15                                             0471 01542000
*                 RETCODE=REG15;    /* SAVE RETURN CODE              */ 01543000
         ST    REG15,RETCODE                                       0472 01544000
*                 IF RETCODE>4 THEN /* IF '62'S RC IS GREATER THAN 4    01545000
*                                      IT'S EITHER UNKNOWN OR ERROR  */ 01546000
         L     @14,RETCODE                                         0473 01547000
         CH    @14,@CH00067                                        0473 01548000
         BNH   @RF00473                                            0473 01549000
*                   ERROR=YES;                                     0474 01550000
         OI    ERROR,B'00001000'                                   0474 01551000
*                 ELSE              /* PRINT REQUEST PROCESSED OK FOR   01552000
*                                      ALL HELD DATASETS OF JOB      */ 01553000
*                   RETCODE=4;      /* GET NEXT JOBNAME              */ 01554000
         B     @RC00473                                            0475 01555000
@RF00473 MVC   RETCODE(4),@CF00067                                 0475 01556000
*               END;                                               0476 01557000
*                                                                  0476 01558000
*             /*******************************************************/ 01559000
*             /*                                                     */ 01560000
*             /* IF CLASS SPECIFIED CALL '62 THIS WAY                */ 01561000
*             /*                                                     */ 01562000
*             /*******************************************************/ 01563000
*                                                                  0477 01564000
*             ELSE                                                 0477 01565000
*               DO;                                                0477 01566000
         B     @RC00469                                            0477 01567000
@RF00469 DS    0H                                                  0478 01568000
*                 CLASBUFF(ONE)=CLASS;/* INSERT ONE CLASS NAME       */ 01569000
         L     @14,OUTCLPDE                                        0478 01570000
         L     @14,CLASNMAD(,@14)                                  0478 01571000
         MVC   CLASBUFF(1),CLASS(@14)                              0478 01572000
*                 CALL IKJCT462(ADDR(OUTCOMTB));/* CALL JOB PROCESSOR*/ 01573000
         LA    @14,OUTCOMTB                                        0479 01574000
         ST    @14,@TF00001                                        0479 01575000
         LA    @14,@TF00001                                        0479 01576000
         ST    @14,@AL00001                                        0479 01577000
         L     @15,@CV00623                                        0479 01578000
         LA    @01,@AL00001                                        0479 01579000
         BALR  @14,@15                                             0479 01580000
*                 RETCODE=REG15;    /* SAVE RETURN CODE              */ 01581000
         ST    REG15,RETCODE                                       0480 01582000
*                 IF RETCODE>4 THEN /* CHECK RETURN CODE, IF ERROR   */ 01583000
         L     @14,RETCODE                                         0481 01584000
         CH    @14,@CH00067                                        0481 01585000
         BNH   @RF00481                                            0481 01586000
*                   ERROR=YES;      /* TURN ON ERROR SWITCH          */ 01587000
         OI    ERROR,B'00001000'                                   0482 01588000
*                 ELSE              /* NO ERROR                      */ 01589000
*                   OUTCLPDE=CLASSNXT;/* INCREMENT CLASS PTR         */ 01590000
         B     @RC00481                                            0483 01591000
@RF00481 L     @14,OUTCLPDE                                        0483 01592000
         L     @14,CLASSNXT(,@14)                                  0483 01593000
         ST    @14,OUTCLPDE                                        0483 01594000
*               END;                                               0484 01595000
@RC00481 DS    0H                                                  0485 01596000
*           END;                    /* END DO WHILE LOOP OF CLASS  0485 01597000
*                                      PDE'S FOR A JOB               */ 01598000
*                                                                  0485 01599000
@RC00469 DS    0H                                                  0485 01600000
@DE00467 CLC   OUTCLPDE(4),@CF00706                                0485 01601000
         BE    @DC00467                                            0485 01602000
         L     @14,RETCODE                                         0485 01603000
         LTR   @14,@14                                             0485 01604000
         BNZ   @DC00467                                            0485 01605000
         TM    ENDSW,B'00011000'                                   0485 01606000
         BZ    @DL00467                                            0485 01607000
@DC00467 DS    0H                                                  0486 01608000
*           /*********************************************************/ 01609000
*           /*                                                       */ 01610000
*           /* THIS CODE IS EXECUTED WHEN THERE ARE NO MORE CLASSES  */ 01611000
*           /* TO PROCESS FOR THIS JOB, OR WHEN THERE WILL BE NO MORE*/ 01612000
*           /* CALLS TO '62 FOR THIS JOB FOR SOME OTHER REASON       */ 01613000
*           /*                                                       */ 01614000
*           /*********************************************************/ 01615000
*                                                                  0486 01616000
*           IF SUBSYS=YES&ERROR=NO&ENDSW=NO THEN/* IN MIDDLE OF    0486 01617000
*                                      PROCESSING A SET OF DATA SETS.   01618000
*                                      SINCE NO EARLY TERMINATION, 0486 01619000
*                                      '62 HAS NOT ISSUED THE CLEAN     01620000
*                                      UP CALL TO THE SUBSYSTEM FOR     01621000
*                                      THIS JOB.                     */ 01622000
         TM    SUBSYS,B'10000000'                                  0486 01623000
         BNO   @RF00486                                            0486 01624000
         TM    ERROR,B'00011000'                                   0486 01625000
         BNZ   @RF00486                                            0486 01626000
*             DO;                   /* SO ISSUE CLEAN UP CALL        */ 01627000
*               NOWORK=ON;          /* INDICATE NO MORE PROCESSING 0488 01628000
*                                      FOR THIS JOB                  */ 01629000
         OI    NOWORK,B'00000010'                                  0488 01630000
*               CALL IKJCT462(ADDR(OUTCOMTB));/* FINAL CALL SO '62 0489 01631000
*                                      CAN TELL SUBSYS THAT DONE WITH   01632000
*                                      JOB                           */ 01633000
         LA    @14,OUTCOMTB                                        0489 01634000
         ST    @14,@TF00001                                        0489 01635000
         LA    @14,@TF00001                                        0489 01636000
         ST    @14,@AL00001                                        0489 01637000
         L     @15,@CV00623                                        0489 01638000
         LA    @01,@AL00001                                        0489 01639000
         BALR  @14,@15                                             0489 01640000
*               NOWORK=OFF;                                        0490 01641000
         NI    NOWORK,B'11111101'                                  0490 01642000
*             END;                                                 0491 01643000
*         END;                      /* END OF PROCESSING ELIGIBLE JOB*/ 01644000
*       ELSE                                                       0493 01645000
*         ;                         /* THIS JOB NOT ELIGIBLE FOR   0493 01646000
*                                      PROCESSING, GET NEXT JOB.     */ 01647000
@RF00462 DS    0H                                                  0494 01648000
*/********************************************************************/ 01649000
*/*    THIS CODE IS EXECUTED WHEN THERE ARE NO MORE CLASSES TO       */ 01650000
*/*    MATCH UP WITH THE CURRENT JOB, OR IF THE CURRENT JOB WAS      */ 01651000
*/*    INELIGIBLE                                                    */ 01652000
*/********************************************************************/ 01653000
*                                                                  0494 01654000
*       OUTJBPDE=NEXTPDE;           /* GO TO NEXT JOB IN PDE CHAIN   */ 01655000
@RC00462 L     @14,OUTJBPDE                                        0494 01656000
         L     @14,NEXTPDE(,@14)                                   0494 01657000
         ST    @14,OUTJBPDE                                        0494 01658000
*       WORKDONE=NO;                /* REINIT SWITCH FOR '62 BEFORE     01659000
*                                      PROCESSING NEXT JOB           */ 01660000
         NI    WORKDONE,B'11101111'                                0495 01661000
*       RETCODE=ZERO;                                              0496 01662000
         SLR   @14,@14                                             0496 01663000
         ST    @14,RETCODE                                         0496 01664000
*     END;                          /* END DO WHILE LOOP OF JOB PDE'S*/ 01665000
@DE00460 CLC   OUTJBPDE(4),@CF00706                                0497 01666000
         BE    @DC00460                                            0497 01667000
         TM    ENDSW,B'00011000'                                   0497 01668000
         BZ    @DL00460                                            0497 01669000
@DC00460 DS    0H                                                  0498 01670000
*                                                                  0498 01671000
*/********************************************************************/ 01672000
*/*      DONE PROCESSING ALL JOBS.  RETURN TO CALLER.                */ 01673000
*/********************************************************************/ 01674000
*                                                                  0498 01675000
*   IF ERROR=YES THEN               /* IF ANY ERRORS                 */ 01676000
@RC00422 TM    ERROR,B'00001000'                                   0498 01677000
         BNO   @RF00498                                            0498 01678000
*     OUTRTCD=BADERROR;             /* SET RETURN CODE TO 12         */ 01679000
         MVC   OUTRTCD(2),@CH00150                                 0499 01680000
*   END JBPROCES;                   /* RETURN TO MAIN PROC           */ 01681000
@EL00004 DS    0H                                                  0500 01682000
@EF00004 DS    0H                                                  0500 01683000
@ER00004 LM    @14,@12,@SA00004                                    0500 01684000
         BR    @14                                                 0500 01685000
*   END IKJCT469                                                   0501 01686000
*                                                                  0501 01687000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01688000
*/*%INCLUDE SYSLIB  (IKJEFFB2)                                       */ 01689000
*/*%INCLUDE SYSLIB  (IKJOCMTB)                                       */ 01690000
*/*%INCLUDE SYSLIB  (IKJEFFIE)                                       */ 01691000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 01692000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */ 01693000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */ 01694000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */ 01695000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 01696000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 01697000
*                                                                  0501 01698000
*       ;                                                          0501 01699000
@DATA    DS    0H                                                       01700000
@CH00082 DC    H'2'                                                     01701000
@CH00257 DC    H'3'                                                     01702000
@CH00041 DC    H'8'                                                     01703000
@CH00236 DC    H'20'                                                    01704000
@CH00742 DC    H'132'                                                   01705000
@CH00751 DC    H'3036'                                                  01706000
@SM00787 MVC   STAXLSTD(0),STICSTAX                                     01707000
@SM00789 MVC   DCBOUTD(0),DCBOUT                                        01708000
@DATD    DSECT                                                          01709000
         DS    0F                                                       01710000
@SA00001 DS    18F                                                      01711000
@PC00001 DS    1F                                                       01712000
@SA00003 DS    15F                                                      01713000
@SA00004 DS    0F                                                       01714000
@SA00002 DS    0F                                                       01715000
         DS    15F                                                      01716000
@AL00001 DS    1A                                                       01717000
@TF00001 DS    F                                                        01718000
@ZTEMPS  DS    C                                                        01719000
@ZTEMPND EQU   *                                                        01720000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01721000
IKJCT469 CSECT                                                          01722000
         DS    0F                                                       01723000
@CF00033 DC    F'1'                                                     01724000
@CH00033 EQU   @CF00033+2                                               01725000
@CF00067 DC    F'4'                                                     01726000
@CH00067 EQU   @CF00067+2                                               01727000
@CF00150 DC    F'12'                                                    01728000
@CH00150 EQU   @CF00150+2                                               01729000
@CF00115 DC    F'16'                                                    01730000
@CF00706 DC    XL4'FF000000'                                            01731000
@DATD    DSECT                                                          01732000
         DS    0D                                                       01733000
DCBPTR   DS    A                                                        01734000
OPENEXAD DS    AL4                                                      01735000
         ORG   OPENEXAD                                                 01736000
FLAG     DS    AL1                                                      01737000
ADDREXIT DS    AL3                                                      01738000
         ORG   OPENEXAD+4                                               01739000
RETCODE  DS    F                                                        01740000
ECTPTR   DS    A                                                        01741000
OUTP     DS    A                                                        01742000
JOBCOUNT DS    H                                                        01743000
         DS    CL2                                                      01744000
OUTCOMTB DS    CL312                                                    01745000
         ORG   OUTCOMTB                                                 01746000
OUTCPPL  DS    AL4                                                      01747000
OUTMSGID DS    CL1                                                      01748000
OUTFLAGS DS    CL1                                                      01749000
         ORG   OUTFLAGS                                                 01750000
KEY1     DS    BL1                                                      01751000
         ORG   OUTCOMTB+6                                               01752000
OUTRTCD  DS    FL2                                                      01753000
OUTMACN  DS    CL8                                                      01754000
OUTCMDNM DS    CL8                                                      01755000
OUTATTN  DS    AL4                                                      01756000
         ORG   OUTATTN                                                  01757000
@NM00004 DS    BL1                                                      01758000
POSTED   EQU   OUTATTN+0                                                01759000
         ORG   OUTCOMTB+28                                              01760000
OUTEXTRA DS    CL4                                                      01761000
OUTEMPMN DS    CL8                                                      01762000
OUTSOBH  DS    AL4                                                      01763000
OUTSOBSO DS    AL4                                                      01764000
OUTRPL   DS    AL4                                                      01765000
OUTRPLL  DS    FL4                                                      01766000
OUTACB   DS    AL4                                                      01767000
OUTACBL  DS    FL4                                                      01768000
OUTEMPSB DS    AL4                                                      01769000
OUTHOLD  DS    CL8                                                      01770000
OUTBKNEW DS    CL8                                                      01771000
OUTBKAPX DS    CL8                                                      01772000
OUTBKCNT DS    FL4                                                      01773000
STRCTNUM DS    FL4                                                      01774000
O73PARM  DS    CL20                                                     01775000
         ORG   O73PARM+0                                                01776000
OUTDCB   DS    AL4                                                      01777000
PRINTDDN DS    CL8                                                      01778000
OUTBUFA  DS    AL4                                                      01779000
@NM00005 DS    FL4                                                      01780000
         ORG   @NM00005+0                                               01781000
@NM00006 DS    CL1                                                      01782000
@NM00007 DS    BL1                                                      01783000
DSALLOC  EQU   @NM00005+1                                               01784000
DSOPEN   EQU   @NM00005+1                                               01785000
OUTRECV  EQU   @NM00005+1                                               01786000
NEEDFREE EQU   @NM00005+1                                               01787000
NEWDS    EQU   @NM00005+1                                               01788000
NOMEMNAM EQU   @NM00005+1                                               01789000
OUTRECUN EQU   @NM00005+1                                               01790000
OUTBUFL  DS    FL2                                                      01791000
         ORG   OUTCOMTB+140                                             01792000
OUTRECA  DS    AL4                                                      01793000
OUTRECL  DS    FL2                                                      01794000
OUTKEYWD DS    CL2                                                      01795000
         ORG   OUTKEYWD                                                 01796000
PAUSE    DS    BL1                                                      01797000
HOLD     EQU   OUTKEYWD+0                                               01798000
HERE     EQU   OUTKEYWD+0                                               01799000
BEGIN    EQU   OUTKEYWD+0                                               01800000
NEXT     EQU   OUTKEYWD+0                                               01801000
DELETE   EQU   OUTKEYWD+0                                               01802000
PRINT    EQU   OUTKEYWD+0                                               01803000
NEWCLASS EQU   OUTKEYWD+0                                               01804000
KEEP     DS    BL1                                                      01805000
DEST     EQU   OUTKEYWD+1                                               01806000
SUBCONT  EQU   OUTKEYWD+1                                               01807000
SUBHERE  EQU   OUTKEYWD+1                                               01808000
SUBBEGN  EQU   OUTKEYWD+1                                               01809000
SUBNEXT  EQU   OUTKEYWD+1                                               01810000
         ORG   OUTCOMTB+148                                             01811000
OUTSW    DS    BL2                                                      01812000
         ORG   OUTSW                                                    01813000
SUBSYS   DS    BL1                                                      01814000
SUBCMODE EQU   OUTSW+0                                                  01815000
UNALCALL EQU   OUTSW+0                                                  01816000
ENDSW    EQU   OUTSW+0                                                  01817000
ERROR    EQU   OUTSW+0                                                  01818000
ENDKEEP  EQU   OUTSW+0                                                  01819000
NOWORK   EQU   OUTSW+0                                                  01820000
HASPABND EQU   OUTSW+0                                                  01821000
SYNADERR DS    BL1                                                      01822000
OPENED   EQU   OUTSW+1                                                  01823000
NONTERM  EQU   OUTSW+1                                                  01824000
WORKDONE EQU   OUTSW+1                                                  01825000
ENDLIST  EQU   OUTSW+1                                                  01826000
         ORG   OUTCOMTB+150                                             01827000
OUTIDSSW DS    BL1                                                      01828000
         ORG   OUTIDSSW                                                 01829000
POINT    DS    BL1                                                      01830000
@NM00008 EQU   OUTIDSSW+0                                               01831000
@NM00009 EQU   OUTIDSSW+0                                               01832000
EODSW    EQU   OUTIDSSW+0                                               01833000
TERM     EQU   OUTIDSSW+0                                               01834000
ALLOC    EQU   OUTIDSSW+0                                               01835000
INTRPMSG EQU   OUTIDSSW+0                                               01836000
@NM00010 EQU   OUTIDSSW+0                                               01837000
         ORG   OUTCOMTB+152                                             01838000
OUTDARB  DS    AL4                                                      01839000
OUTDAIR  DS    AL4                                                      01840000
OUTPDL   DS    AL4                                                      01841000
OUTXMSG  DS    AL4                                                      01842000
         ORG   OUTXMSG                                                  01843000
OUTSYNMS DS    AL4                                                      01844000
         ORG   OUTCOMTB+168                                             01845000
OUTXRPLY DS    AL4                                                      01846000
OUTTCBH  DS    AL4                                                      01847000
OHELPECB DS    AL4                                                      01848000
OUTSBPDL DS    AL4                                                      01849000
OUTSBBUF DS    AL4                                                      01850000
OUTSTAE  DS    2A                                                       01851000
OUTWORK  DS    12F                                                      01852000
CLASBUFF DS    CL8                                                      01853000
OSYSODDN DS    CL8                                                      01854000
OUTPLIST DS    CL16                                                     01855000
         ORG   OUTPLIST                                                 01856000
OUTCPDE1 DS    AL4                                                      01857000
OPRDSPDE DS    AL4                                                      01858000
ONEWCPDE DS    AL4                                                      01859000
ODESTPDE DS    AL4                                                      01860000
         ORG   OUTCOMTB+276                                             01861000
OUTJBPDE DS    AL4                                                      01862000
OUTCLPDE DS    AL4                                                      01863000
OSVDSPDE DS    AL4                                                      01864000
EWAPTR   DS    AL4                                                      01865000
IOPLPTR  DS    AL4                                                      01866000
IOPLAREA DS    CL16                                                     01867000
         ORG   OUTCOMTB+312                                             01868000
PARMLIST DS    CL40                                                     01869000
         ORG   PARMLIST                                                 01870000
JOBNAMEP DS    AL4                                                      01871000
NAMELENP DS    AL4                                                      01872000
USERIDP  DS    AL4                                                      01873000
IDLENPTR DS    AL4                                                      01874000
MESSAGEP DS    AL4                                                      01875000
REPLYP   DS    AL4                                                      01876000
CODEP    DS    AL4                                                      01877000
JOBIDP   DS    AL4                                                      01878000
JIDLENP  DS    AL4                                                      01879000
IEOUTPLP DS    AL4                                                      01880000
         ORG   IEOUTPLP                                                 01881000
IEHIGH   DS    BL1                                                      01882000
         ORG   PARMLIST+40                                              01883000
SSOB     DS    CL20                                                     01884000
         ORG   SSOB                                                     01885000
SSOBID   DS    CL4                                                      01886000
SSOBLEN  DS    FL2                                                      01887000
SSOBFUNC DS    FL2                                                      01888000
SSOBSSIB DS    AL4                                                      01889000
SSOBRETN DS    AL4                                                      01890000
SSOBINDV DS    AL4                                                      01891000
         ORG   SSOB+20                                                  01892000
SSSO     DS    CL120                                                    01893000
         ORG   SSSO                                                     01894000
SSSOLEN  DS    FL2                                                      01895000
SSSOUFLG DS    BL1                                                      01896000
         ORG   SSSOUFLG                                                 01897000
SSSOSETC DS    BL1                                                      01898000
SSSODELC EQU   SSSOUFLG+0                                               01899000
SSSOROUT EQU   SSSOUFLG+0                                               01900000
SSSOHOLD EQU   SSSOUFLG+0                                               01901000
SSSORLSE EQU   SSSOUFLG+0                                               01902000
@NM00013 EQU   SSSOUFLG+0                                               01903000
         ORG   SSSO+3                                                   01904000
@NM00014 DS    AL1                                                      01905000
SSSOFLG1 DS    BL1                                                      01906000
         ORG   SSSOFLG1                                                 01907000
SSSOSHLD DS    BL1                                                      01908000
SSSOSCLS EQU   SSSOFLG1+0                                               01909000
SSSOSDST EQU   SSSOFLG1+0                                               01910000
SSSOSJBN EQU   SSSOFLG1+0                                               01911000
SSSOSJBI EQU   SSSOFLG1+0                                               01912000
SSSOSPGM EQU   SSSOFLG1+0                                               01913000
SSSOSFRM EQU   SSSOFLG1+0                                               01914000
@NM00015 EQU   SSSOFLG1+0                                               01915000
         ORG   SSSO+5                                                   01916000
SSSOFLG2 DS    BL1                                                      01917000
         ORG   SSSOFLG2                                                 01918000
SSSOCTRL DS    BL1                                                      01919000
SSSOCHKP EQU   SSSOFLG2+0                                               01920000
@NM00016 EQU   SSSOFLG2+0                                               01921000
         ORG   SSSO+6                                                   01922000
SSSOCOPY DS    FL2                                                      01923000
SSSOJOBN DS    CL8                                                      01924000
SSSOJOBI DS    CL8                                                      01925000
SSSOCLAS DS    CL1                                                      01926000
@NM00017 DS    CL3                                                      01927000
SSSODEST DS    CL8                                                      01928000
SSSOPGMN DS    CL8                                                      01929000
SSSORBA  DS    CL8                                                      01930000
SSSODSN  DS    CL44                                                     01931000
SSSOFORM DS    CL4                                                      01932000
SSSOCLSL DS    CL8                                                      01933000
SSSOWTRC DS    AL4                                                      01934000
SSSODSID DS    CL8                                                      01935000
         ORG   SSSO+120                                                 01936000
ESTAEWA  DS    CL340                                                    01937000
SYNSW    DS    BL1                                                      01938000
         ORG   SYNSW                                                    01939000
PRINTING DS    BL1                                                      01940000
ROUTING  EQU   SYNSW+0                                                  01941000
SYNERROR EQU   SYNSW+0                                                  01942000
         ORG   SYNSW+1                                                  01943000
STXMSG   DS    CL8                                                      01944000
         ORG   STXMSG                                                   01945000
MODEMSG  DS    CL8                                                      01946000
         ORG   STXMSG+8                                                 01947000
         DS    CL3                                                      01948000
PPLAREA  DS    CL28                                                     01949000
USERLIST DS    CL20                                                     01950000
LOOP     DS    BL1                                                      01951000
QUIT     DS    BL1                                                      01952000
NEXTJOB  DS    BL1                                                      01953000
IKJCT469 CSECT                                                          01954000
         DS    0F                                                       01955000
@SIZDATD DC    AL1(1)                                                   01956000
         DC    AL3(@ENDDATD-@DATD)                                      01957000
@CV00621 DC    V(IKJCT467)                                              01958000
@CV00622 DC    V(IKJCT472)                                              01959000
@CV00623 DC    V(IKJCT462)                                              01960000
@CV00624 DC    V(IKJCT473)                                              01961000
@CV00625 DC    V(IKJCT460)                                              01962000
         DS    0D                                                       01963000
@CC00738 DC    C'SSOB'                                                  01964000
PATCH69  DS    CL300                                                    01965000
         ORG   PATCH69                                                  01966000
PACHINIT DC    60CL5'ZAP69'                                             01967000
         ORG   PATCH69+300                                              01968000
DFLTPRNT DS    CL24                                                     01969000
         ORG   DFLTPRNT                                                 01970000
@NM00049 DC    AL4(DFLTNAME)                                            01971000
@NM00050 DC    X'00018000'                                              01972000
@NM00051 DC    4F'0'                                                    01973000
         ORG   DFLTPRNT+24                                              01974000
DFLTNAME DC    CL1'*'                                                   01975000
IKJCT469 CSECT                                                          01976000
PCLADCON DC    V(IKJCT4PO)               VCON FOR OUTPUT CP PCL         01977000
IKJCT4PO IKJPARM                                                        01978000
PJOBNAME IKJPOSIT JOBNAME,                                             X01979000
               LIST,                                                   X01980000
               PROMPT='JOBNAME OR JOBNAME(JOBID)',                     X01981000
               HELP='JOBNAME OF PREVIOUSLY SUBMITTED JOB'               01982000
*                                                                       01983000
PCLASS   IKJKEYWD                                                       01984000
         IKJNAME 'CLASS',SUBFLD=CLASSUB                                 01985000
*                                                                       01986000
PPRINT   IKJKEYWD                                                       01987000
         IKJNAME 'PRINT',SUBFLD=PRINTSUB                                01988000
*                                                                       01989000
PKEEP    IKJKEYWD                                                       01990000
         IKJNAME 'KEEP'                                                 01991000
         IKJNAME 'NOKEEP'                                               01992000
*                                                                       01993000
PNEWCL   IKJKEYWD                                                       01994000
         IKJNAME 'NEWCLASS',SUBFLD=NEWCLSUB                             01995000
*                                                                       01996000
PDELETE  IKJKEYWD                                                       01997000
         IKJNAME 'DELETE'                                               01998000
*                                                                       01999000
PHOLD    IKJKEYWD                                                       02000000
         IKJNAME 'HOLD'                                                 02001000
         IKJNAME 'NOHOLD'                                               02002000
*                                                                       02003000
PDEST    IKJKEYWD                                                       02004000
         IKJNAME 'DEST',SUBFLD=DESTSUB                                  02005000
*                                                                       02006000
PHERE    IKJKEYWD                                                       02007000
         IKJNAME 'NEXT'                                                 02008000
         IKJNAME 'HERE'                                                 02009000
         IKJNAME 'BEGIN'                                                02010000
*                                                                       02011000
PPAUSE   IKJKEYWD                                                       02012000
         IKJNAME  'PAUSE'                                               02013000
         IKJNAME  'NOPAUSE'                                             02014000
*                                                                       02015000
*        B E G I N   S U B F I E L D S                                  02016000
*                                                                       02017000
CLASSUB  IKJSUBF                                                        02018000
SCLASS   IKJIDENT 'CLASSNAME',LIST,FIRST=NONATNUM,MAXLNTH=1,           *02019000
               PROMPT='CLASS NAME'                                      02020000
*                                                                       02021000
PRINTSUB IKJSUBF                                                        02022000
SPRINT   IKJPOSIT  DSTHING,USID,DEFAULT='*',                           *02023000
               HELP='DSNAME(MEMBERNAME) /PASSWORD'                      02024000
*                                                                       02025000
NEWCLSUB IKJSUBF                                                        02026000
SNEWCL   IKJIDENT 'NEW CLASSNAME',FIRST=NONATNUM,MAXLNTH=1,            *02027000
               PROMPT='NEW CLASSNAME'                                   02028000
*                                                                       02029000
DESTSUB  IKJSUBF                                                        02030000
SDEST    IKJPOSIT USERID,                                              *02031000
               PROMPT='REMOTE STATION ID FOR THE DEST KEYWORD'          02032000
*                                                                       02033000
         IKJENDP                                                        02034000
IKJCT469 CSECT                                                          02035000
DCBOUT    DCB   DSORG=PS,MACRF=PM,BFTEK=S                               02036000
OPENLIST  OPEN  (0,(OUTPUT)),MF=L                                       02037000
CLOSLIST  CLOSE (0),MF=L                                                02038000
TEMPLTH   EQU   *                                                       02039000
DCBLTH    DC    A(TEMPLTH-DCBOUT)           LEN DCB, OPEN & CLOSE LSTS  02040000
STICSTAX  STAX  MF=L                                                    02041000
TEMPLTH1  EQU   *                                                       02042000
STAXLTH   DC    A(TEMPLTH1-STICSTAX)        LEN STAX LIST               02043000
STICESTA  ESTAE  MF=L                                                   02044000
ESTAELTH  EQU  *-STICESTA                                               02045000
@DATD    DSECT                                                          02046000
DCBOUTD   DCB   DSORG=PS,MACRF=PM,BFTEK=S                               02047000
OPENLSTD  OPEN  (0,(OUTPUT)),MF=L                                       02048000
CLOSLSTD  CLOSE (0),MF=L                                                02049000
STAXLSTD  STAX  MF=L                                                    02050000
ESTALSTD  ESTAE   MF=L                                                  02051000
@DATD    DSECT                                                          02052000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02053000
@ENDDATD EQU   *                                                        02054000
IKJCT469 CSECT                                                          02055000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02056000
@01      EQU   01                                                       02057000
@02      EQU   02                                                       02058000
@03      EQU   03                                                       02059000
@04      EQU   04                                                       02060000
@05      EQU   05                                                       02061000
@06      EQU   06                                                       02062000
@07      EQU   07                                                       02063000
@08      EQU   08                                                       02064000
@09      EQU   09                                                       02065000
@10      EQU   10                                                       02066000
@11      EQU   11                                                       02067000
@12      EQU   12                                                       02068000
@13      EQU   13                                                       02069000
@14      EQU   14                                                       02070000
@15      EQU   15                                                       02071000
CLASPTR  EQU   @04                                                      02072000
JOBASE   EQU   @04                                                      02073000
CLASSCNT EQU   @05                                                      02074000
PPLPTR   EQU   @04                                                      02075000
REG0     EQU   @00                                                      02076000
REG1     EQU   @01                                                      02077000
REG2     EQU   @02                                                      02078000
REG3     EQU   @03                                                      02079000
REG14    EQU   @14                                                      02080000
REG15    EQU   @15                                                      02081000
PDLBASE  EQU   @02                                                      02082000
MESSAGE  EQU   0                                                        02083000
IEREPLY  EQU   0                                                        02084000
IEOUTPL  EQU   0                                                        02085000
@NM00011 EQU   IEOUTPL+16                                               02086000
IESYNTAX EQU   @NM00011                                                 02087000
CPPL     EQU   0                                                        02088000
CPPLCBUF EQU   CPPL                                                     02089000
CPPLUPT  EQU   CPPL+4                                                   02090000
CPPLECT  EQU   CPPL+12                                                  02091000
PPL      EQU   0                                                        02092000
PPLUPT   EQU   PPL                                                      02093000
PPLECT   EQU   PPL+4                                                    02094000
PPLECB   EQU   PPL+8                                                    02095000
PPLPCL   EQU   PPL+12                                                   02096000
PPLANS   EQU   PPL+16                                                   02097000
PPLCBUF  EQU   PPL+20                                                   02098000
PPLUWA   EQU   PPL+24                                                   02099000
IOPL     EQU   0                                                        02100000
IOPLUPT  EQU   IOPL                                                     02101000
IOPLECT  EQU   IOPL+4                                                   02102000
IOPLECB  EQU   IOPL+8                                                   02103000
IHADCB   EQU   0                                                        02104000
IHADCS00 EQU   0                                                        02105000
DCBFDAD  EQU   IHADCS00+5                                               02106000
IHADCS01 EQU   0                                                        02107000
DCBDVTBL EQU   IHADCS01                                                 02108000
IHADCS11 EQU   0                                                        02109000
DCBRELB  EQU   IHADCS11                                                 02110000
DCBREL   EQU   DCBRELB+1                                                02111000
DCBBUFCB EQU   IHADCS11+4                                               02112000
DCBDSORG EQU   IHADCS11+10                                              02113000
DCBDSRG1 EQU   DCBDSORG                                                 02114000
DCBDSRG2 EQU   DCBDSORG+1                                               02115000
DCBIOBAD EQU   IHADCS11+12                                              02116000
DCBODEB  EQU   DCBIOBAD                                                 02117000
DCBLNP   EQU   DCBODEB                                                  02118000
DCBQSLM  EQU   DCBLNP                                                   02119000
DCBIOBAA EQU   DCBODEB+1                                                02120000
IHADCS50 EQU   0                                                        02121000
DCBSVCXL EQU   IHADCS50                                                 02122000
DCBEODAD EQU   IHADCS50+4                                               02123000
DCBBFALN EQU   DCBEODAD                                                 02124000
DCBHIARC EQU   DCBBFALN                                                 02125000
DCBBFTEK EQU   DCBHIARC                                                 02126000
DCBBFT   EQU   DCBBFTEK                                                 02127000
DCBEXLST EQU   IHADCS50+8                                               02128000
DCBRECFM EQU   DCBEXLST                                                 02129000
DCBRECLA EQU   DCBRECFM                                                 02130000
DCBRECL  EQU   DCBRECLA                                                 02131000
IHADCS24 EQU   0                                                        02132000
DCBDDNAM EQU   IHADCS24                                                 02133000
DCBOFLGS EQU   IHADCS24+8                                               02134000
DCBOFLWR EQU   DCBOFLGS                                                 02135000
DCBOFOPN EQU   DCBOFLGS                                                 02136000
DCBIFLG  EQU   IHADCS24+9                                               02137000
DCBMACR  EQU   IHADCS24+10                                              02138000
DCBMACR1 EQU   DCBMACR                                                  02139000
DCBMRFE  EQU   DCBMACR1                                                 02140000
DCBMRGET EQU   DCBMRFE                                                  02141000
DCBMRAPG EQU   DCBMACR1                                                 02142000
DCBMRRD  EQU   DCBMRAPG                                                 02143000
DCBMRCI  EQU   DCBMACR1                                                 02144000
DCBMRMVG EQU   DCBMRCI                                                  02145000
DCBMRLCG EQU   DCBMACR1                                                 02146000
DCBMRABC EQU   DCBMACR1                                                 02147000
DCBMRPT1 EQU   DCBMRABC                                                 02148000
DCBMRSBG EQU   DCBMRPT1                                                 02149000
DCBMRCRL EQU   DCBMACR1                                                 02150000
DCBMRCHK EQU   DCBMRCRL                                                 02151000
DCBMRRDX EQU   DCBMRCHK                                                 02152000
DCBMRDMG EQU   DCBMACR1                                                 02153000
DCBMACR2 EQU   DCBMACR+1                                                02154000
DCBMRPUT EQU   DCBMACR2                                                 02155000
DCBMRWRT EQU   DCBMACR2                                                 02156000
DCBMRMVP EQU   DCBMACR2                                                 02157000
DCBMR5WD EQU   DCBMACR2                                                 02158000
DCBMRLDM EQU   DCBMR5WD                                                 02159000
DCBMRLCP EQU   DCBMRLDM                                                 02160000
DCBMR4WD EQU   DCBMACR2                                                 02161000
DCBMRPT2 EQU   DCBMR4WD                                                 02162000
DCBMRTMD EQU   DCBMRPT2                                                 02163000
DCBMR3WD EQU   DCBMACR2                                                 02164000
DCBMRCTL EQU   DCBMR3WD                                                 02165000
DCBMRSTK EQU   DCBMRCTL                                                 02166000
DCBMR1WD EQU   DCBMACR2                                                 02167000
DCBMRSWA EQU   DCBMR1WD                                                 02168000
DCBMRDMD EQU   DCBMRSWA                                                 02169000
IHADCS25 EQU   0                                                        02170000
DCBMACRF EQU   IHADCS25+2                                               02171000
DCBMACF1 EQU   DCBMACRF                                                 02172000
DCBMFFE  EQU   DCBMACF1                                                 02173000
DCBMFGET EQU   DCBMFFE                                                  02174000
DCBMFAPG EQU   DCBMACF1                                                 02175000
DCBMFRD  EQU   DCBMFAPG                                                 02176000
DCBMFCI  EQU   DCBMACF1                                                 02177000
DCBMFMVG EQU   DCBMFCI                                                  02178000
DCBMFLCG EQU   DCBMACF1                                                 02179000
DCBMFABC EQU   DCBMACF1                                                 02180000
DCBMFPT1 EQU   DCBMFABC                                                 02181000
DCBMFSBG EQU   DCBMFPT1                                                 02182000
DCBMFCRL EQU   DCBMACF1                                                 02183000
DCBMFCHK EQU   DCBMFCRL                                                 02184000
DCBMFDMG EQU   DCBMACF1                                                 02185000
DCBMACF2 EQU   DCBMACRF+1                                               02186000
DCBMFPUT EQU   DCBMACF2                                                 02187000
DCBMFWRT EQU   DCBMACF2                                                 02188000
DCBMFMVP EQU   DCBMACF2                                                 02189000
DCBMF5WD EQU   DCBMACF2                                                 02190000
DCBMFLDM EQU   DCBMF5WD                                                 02191000
DCBMFLCP EQU   DCBMFLDM                                                 02192000
DCBMF4WD EQU   DCBMACF2                                                 02193000
DCBMFPT2 EQU   DCBMF4WD                                                 02194000
DCBMFTMD EQU   DCBMFPT2                                                 02195000
DCBMF3WD EQU   DCBMACF2                                                 02196000
DCBMFCTL EQU   DCBMF3WD                                                 02197000
DCBMFSTK EQU   DCBMFCTL                                                 02198000
DCBMF1WD EQU   DCBMACF2                                                 02199000
DCBMFSWA EQU   DCBMF1WD                                                 02200000
DCBMFDMD EQU   DCBMFSWA                                                 02201000
DCBDEBAD EQU   IHADCS25+4                                               02202000
DCBIFLGS EQU   DCBDEBAD                                                 02203000
IHADCS26 EQU   0                                                        02204000
DCBWRITE EQU   IHADCS26                                                 02205000
DCBREAD  EQU   DCBWRITE                                                 02206000
DCBWRITA EQU   DCBREAD+1                                                02207000
IHADCS27 EQU   0                                                        02208000
DCBGET   EQU   IHADCS27                                                 02209000
DCBPUT   EQU   DCBGET                                                   02210000
DCBGETA  EQU   DCBPUT+1                                                 02211000
IHADCS36 EQU   0                                                        02212000
DCBGERR  EQU   IHADCS36                                                 02213000
DCBPERR  EQU   DCBGERR                                                  02214000
DCBCHECK EQU   DCBPERR                                                  02215000
DCBOPTCD EQU   DCBCHECK                                                 02216000
DCBOPTH  EQU   DCBOPTCD                                                 02217000
DCBOPTO  EQU   DCBOPTH                                                  02218000
DCBOPTZ  EQU   DCBOPTCD                                                 02219000
DCBGERRA EQU   DCBCHECK+1                                               02220000
DCBPERRA EQU   DCBGERRA                                                 02221000
DCBSYNAD EQU   IHADCS36+4                                               02222000
DCBCIND1 EQU   IHADCS36+8                                               02223000
DCBCIND2 EQU   IHADCS36+9                                               02224000
DCBBLKSI EQU   IHADCS36+10                                              02225000
DCBIOBA  EQU   IHADCS36+16                                              02226000
DCBCICB  EQU   DCBIOBA                                                  02227000
IHADCS52 EQU   0                                                        02228000
DCBDIRCT EQU   IHADCS52                                                 02229000
DCBQSWS  EQU   DCBDIRCT                                                 02230000
DCBUSASI EQU   DCBQSWS                                                  02231000
DCBQADFS EQU   DCBUSASI                                                 02232000
DCBBUFOF EQU   DCBDIRCT+1                                               02233000
IHADCS37 EQU   0                                                        02234000
DCBFLAG1 EQU   IHADCS37                                                 02235000
IHADCS38 EQU   0                                                        02236000
DCBEOBR  EQU   IHADCS38                                                 02237000
DCBLRECL EQU   IHADCS38+10                                              02238000
DCBPOINT EQU   IHADCS38+12                                              02239000
DCBCNTRL EQU   DCBPOINT                                                 02240000
IHADCS40 EQU   0                                                        02241000
DCBEOBAD EQU   IHADCS40                                                 02242000
DCBCCCW  EQU   IHADCS40+4                                               02243000
DCBRECAD EQU   DCBCCCW                                                  02244000
DCBRECBT EQU   DCBRECAD                                                 02245000
DCBRCREL EQU   DCBRECBT                                                 02246000
@NM00042 EQU   IHADCS40+12                                              02247000
DCBEROPT EQU   @NM00042                                                 02248000
JOBPDE   EQU   0                                                        02249000
JBNAMEAD EQU   JOBPDE                                                   02250000
JBNTFND  EQU   JBNAMEAD                                                 02251000
JBNMLTH  EQU   JOBPDE+4                                                 02252000
JBIDADR  EQU   JOBPDE+8                                                 02253000
JBIDLTH  EQU   JOBPDE+12                                                02254000
NEXTPDE  EQU   JOBPDE+16                                                02255000
CLASSPDE EQU   0                                                        02256000
CLASNMAD EQU   CLASSPDE                                                 02257000
CLASSNXT EQU   CLASSPDE+8                                               02258000
DSPDE    EQU   0                                                        02259000
DSNAMEAD EQU   DSPDE                                                    02260000
DSNAME   EQU   0                                                        02261000
CLASS    EQU   0                                                        02262000
CMNDCODE EQU   0                                                        02263000
IDLENGTH EQU   0                                                        02264000
IEJOBID  EQU   0                                                        02265000
IEJOBNM  EQU   0                                                        02266000
JIDLEN   EQU   0                                                        02267000
JOBID    EQU   0                                                        02268000
JOBNAME  EQU   0                                                        02269000
JOBNAMEL EQU   0                                                        02270000
USERID   EQU   0                                                        02271000
FIBCPARM EQU   0                                                        02272000
FIBPSCBU EQU   FIBCPARM+4                                               02273000
FIBPSCBL EQU   FIBCPARM+11                                              02274000
FIBCPPLC EQU   FIBCPARM+12                                              02275000
FIBECTCN EQU   FIBCPARM+28                                              02276000
FIBFLAGS EQU   FIBCPARM+36                                              02277000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02278000
FIBCMDBF EQU   FIBCPARM+52                                              02279000
@NM00003 EQU   FIBCPARM+48                                              02280000
@NM00002 EQU   FIBCPARM+44                                              02281000
FIBCUSER EQU   FIBCPARM+40                                              02282000
@NM00001 EQU   FIBCPARM+38                                              02283000
FIBECTNO EQU   FIBFLAGS                                                 02284000
FIBCPPLE EQU   FIBCPARM+24                                              02285000
FIBCPPLP EQU   FIBCPARM+20                                              02286000
FIBCPPLU EQU   FIBCPARM+16                                              02287000
FIBCID   EQU   FIBCPARM+2                                               02288000
FIBCLEN  EQU   FIBCPARM                                                 02289000
@NM00048 EQU   CLASSPDE+4                                               02290000
@NM00047 EQU   JOBPDE+14                                                02291000
@NM00046 EQU   JOBPDE+6                                                 02292000
DCBEOB   EQU   IHADCS40+20                                              02293000
DCBPRECL EQU   IHADCS40+18                                              02294000
@NM00045 EQU   IHADCS40+16                                              02295000
@NM00044 EQU   @NM00042+1                                               02296000
@NM00043 EQU   DCBEROPT                                                 02297000
DCBERABE EQU   DCBEROPT                                                 02298000
DCBERSKP EQU   DCBEROPT                                                 02299000
DCBERACC EQU   DCBEROPT                                                 02300000
@NM00041 EQU   IHADCS40+10                                              02301000
@NM00040 EQU   IHADCS40+9                                               02302000
@NM00039 EQU   IHADCS40+8                                               02303000
DCBRECA  EQU   DCBRECAD+1                                               02304000
@NM00038 EQU   DCBRECBT                                                 02305000
DCBRCFGT EQU   DCBRCREL                                                 02306000
DCBRCTRU EQU   DCBRCREL                                                 02307000
DCBLCCW  EQU   DCBEOBAD                                                 02308000
DCBNOTE  EQU   DCBCNTRL                                                 02309000
@NM00037 EQU   IHADCS38+8                                               02310000
DCBEOBW  EQU   IHADCS38+4                                               02311000
DCBEOBRA EQU   DCBEOBR+1                                                02312000
DCBNCP   EQU   DCBEOBR                                                  02313000
@NM00036 EQU   DCBFLAG1                                                 02314000
DCBSTFLS EQU   DCBFLAG1                                                 02315000
DCBSTQCK EQU   DCBFLAG1                                                 02316000
DCBDIRCQ EQU   DCBBUFOF                                                 02317000
DCBQSTRU EQU   DCBUSASI                                                 02318000
@NM00035 EQU   DCBUSASI                                                 02319000
DCBQADF3 EQU   DCBQADFS                                                 02320000
DCBQADF2 EQU   DCBQADFS                                                 02321000
DCBQADF1 EQU   DCBQADFS                                                 02322000
DCBBLBP  EQU   DCBUSASI                                                 02323000
@NM00034 EQU   DCBUSASI                                                 02324000
DCBCICBA EQU   DCBCICB+1                                                02325000
@NM00033 EQU   DCBCICB                                                  02326000
DCBOFFSW EQU   IHADCS36+15                                              02327000
DCBOFFSR EQU   IHADCS36+14                                              02328000
DCBWCPL  EQU   IHADCS36+13                                              02329000
DCBWCPO  EQU   IHADCS36+12                                              02330000
DCBCNQSM EQU   DCBCIND2                                                 02331000
DCBCNFEO EQU   DCBCIND2                                                 02332000
DCBCNCHS EQU   DCBCIND2                                                 02333000
DCBCNBFP EQU   DCBCIND2                                                 02334000
DCBCNIOE EQU   DCBCIND2                                                 02335000
DCBCNCLO EQU   DCBCIND2                                                 02336000
DCBCNWRO EQU   DCBCIND2                                                 02337000
DCBCNSTO EQU   DCBCIND2                                                 02338000
DCBCNEXB EQU   DCBCIND1                                                 02339000
@NM00032 EQU   DCBCIND1                                                 02340000
DCBCNBRM EQU   DCBCIND1                                                 02341000
@NM00031 EQU   DCBCIND1                                                 02342000
DCBCNEVA EQU   DCBCIND1                                                 02343000
DCBCNEVB EQU   DCBCIND1                                                 02344000
DCBCNSRD EQU   DCBCIND1                                                 02345000
DCBCNTOV EQU   DCBCIND1                                                 02346000
DCBSYNA  EQU   DCBSYNAD+1                                               02347000
DCBIOBL  EQU   DCBSYNAD                                                 02348000
DCBCHCKA EQU   DCBPERRA                                                 02349000
@NM00030 EQU   DCBOPTCD                                                 02350000
DCBOPTT  EQU   DCBOPTCD                                                 02351000
DCBSRCHD EQU   DCBOPTZ                                                  02352000
DCBOPTQ  EQU   DCBOPTCD                                                 02353000
DCBBCKPT EQU   DCBOPTO                                                  02354000
DCBOPTC  EQU   DCBOPTCD                                                 02355000
DCBOPTU  EQU   DCBOPTCD                                                 02356000
DCBOPTW  EQU   DCBOPTCD                                                 02357000
DCBPUTA  EQU   DCBGETA                                                  02358000
@NM00029 EQU   DCBPUT                                                   02359000
DCBREADA EQU   DCBWRITA                                                 02360000
@NM00028 EQU   DCBREAD                                                  02361000
DCBDEBA  EQU   DCBDEBAD+1                                               02362000
@NM00027 EQU   DCBIFLGS                                                 02363000
DCBIFIOE EQU   DCBIFLGS                                                 02364000
DCBIFPCT EQU   DCBIFLGS                                                 02365000
DCBIFEC  EQU   DCBIFLGS                                                 02366000
DCBMFSTI EQU   DCBMFDMD                                                 02367000
DCBMFAWR EQU   DCBMFSTK                                                 02368000
DCBMFUIP EQU   DCBMFTMD                                                 02369000
DCBMFIDW EQU   DCBMFLCP                                                 02370000
DCBMFWRK EQU   DCBMFMVP                                                 02371000
DCBMFRDQ EQU   DCBMFWRT                                                 02372000
DCBMFGTQ EQU   DCBMFPUT                                                 02373000
DCBMFSTL EQU   DCBMACF2                                                 02374000
DCBMFCK  EQU   DCBMFDMG                                                 02375000
DCBMFRDX EQU   DCBMFCHK                                                 02376000
DCBMFDBF EQU   DCBMFSBG                                                 02377000
DCBMFRDI EQU   DCBMFLCG                                                 02378000
DCBMFRDK EQU   DCBMFMVG                                                 02379000
DCBMFWRQ EQU   DCBMFRD                                                  02380000
DCBMFPTQ EQU   DCBMFGET                                                 02381000
DCBMFECP EQU   DCBMACF1                                                 02382000
DCBTIOT  EQU   IHADCS25                                                 02383000
DCBMRSTI EQU   DCBMRDMD                                                 02384000
DCBMRAWR EQU   DCBMRSTK                                                 02385000
DCBMRUIP EQU   DCBMRTMD                                                 02386000
DCBMRIDW EQU   DCBMRLCP                                                 02387000
DCBMRWRK EQU   DCBMRMVP                                                 02388000
DCBMRRDQ EQU   DCBMRWRT                                                 02389000
DCBMRGTQ EQU   DCBMRPUT                                                 02390000
DCBMRSTL EQU   DCBMACR2                                                 02391000
DCBMRCK  EQU   DCBMRDMG                                                 02392000
DCBPGFXA EQU   DCBMRRDX                                                 02393000
DCBMRDBF EQU   DCBMRSBG                                                 02394000
DCBMRRDI EQU   DCBMRLCG                                                 02395000
DCBMRRDK EQU   DCBMRMVG                                                 02396000
DCBMRWRQ EQU   DCBMRRD                                                  02397000
DCBMRPTQ EQU   DCBMRGET                                                 02398000
DCBMRECP EQU   DCBMACR1                                                 02399000
@NM00026 EQU   DCBIFLG                                                  02400000
DCBIBIOE EQU   DCBIFLG                                                  02401000
DCBIBPCT EQU   DCBIFLG                                                  02402000
DCBIBEC  EQU   DCBIFLG                                                  02403000
DCBOFIOF EQU   DCBOFLGS                                                 02404000
DCBOFUEX EQU   DCBOFLGS                                                 02405000
DCBOFTM  EQU   DCBOFLGS                                                 02406000
DCBOFPPC EQU   DCBOFLGS                                                 02407000
DCBOFEOV EQU   DCBOFLGS                                                 02408000
DCBOFLRB EQU   DCBOFLGS                                                 02409000
DCBOFIOD EQU   DCBOFLWR                                                 02410000
DCBEXLSA EQU   DCBEXLST+1                                               02411000
DCBRECKL EQU   DCBRECFM                                                 02412000
DCBRECCC EQU   DCBRECFM                                                 02413000
DCBRECSB EQU   DCBRECFM                                                 02414000
DCBRECBR EQU   DCBRECFM                                                 02415000
DCBRECTO EQU   DCBRECLA                                                 02416000
DCBEODA  EQU   DCBEODAD+1                                               02417000
DCBBFA   EQU   DCBBFTEK                                                 02418000
DCBH0    EQU   DCBBFTEK                                                 02419000
DCBBFTKD EQU   DCBBFTEK                                                 02420000
DCBBFTE  EQU   DCBBFT                                                   02421000
DCBBFTKR EQU   DCBBFT                                                   02422000
DCBBFTS  EQU   DCBBFT                                                   02423000
DCBH1    EQU   DCBBFTEK                                                 02424000
DCBSVCXA EQU   DCBSVCXL+1                                               02425000
@NM00025 EQU   DCBSVCXL                                                 02426000
DCBODEBA EQU   DCBIOBAA                                                 02427000
@NM00024 EQU   DCBQSLM                                                  02428000
DCBUPDBT EQU   DCBQSLM                                                  02429000
DCBUPDCM EQU   DCBQSLM                                                  02430000
DCB1DVDS EQU   DCBQSLM                                                  02431000
@NM00023 EQU   DCBDSRG2                                                 02432000
DCBDSGTR EQU   DCBDSRG2                                                 02433000
DCBACBM  EQU   DCBDSRG2                                                 02434000
@NM00022 EQU   DCBDSRG2                                                 02435000
DCBDSGTQ EQU   DCBDSRG2                                                 02436000
DCBDSGTX EQU   DCBDSRG2                                                 02437000
DCBDSGGS EQU   DCBDSRG2                                                 02438000
DCBDSGU  EQU   DCBDSRG1                                                 02439000
DCBDSGPO EQU   DCBDSRG1                                                 02440000
DCBDSGMQ EQU   DCBDSRG1                                                 02441000
DCBDSGCQ EQU   DCBDSRG1                                                 02442000
DCBDSGCX EQU   DCBDSRG1                                                 02443000
DCBDSGDA EQU   DCBDSRG1                                                 02444000
DCBDSGPS EQU   DCBDSRG1                                                 02445000
DCBDSGIS EQU   DCBDSRG1                                                 02446000
DCBBUFL  EQU   IHADCS11+8                                               02447000
DCBBUFCA EQU   DCBBUFCB+1                                               02448000
DCBBUFNO EQU   DCBBUFCB                                                 02449000
DCBDEVT  EQU   DCBREL                                                   02450000
DCBKEYLE EQU   DCBRELB                                                  02451000
DCBTRBAL EQU   IHADCS01+6                                               02452000
@NM00021 EQU   IHADCS01+5                                               02453000
@NM00020 EQU   IHADCS01+4                                               02454000
DCBDVTBA EQU   DCBDVTBL+1                                               02455000
@NM00019 EQU   DCBDVTBL                                                 02456000
DCBKEYCN EQU   IHADCS00+4                                               02457000
DCBRELAD EQU   IHADCS00                                                 02458000
@NM00018 EQU   IHADCB                                                   02459000
IOPLIOPB EQU   IOPL+12                                                  02460000
CPPLPSCB EQU   CPPL+8                                                   02461000
@NM00012 EQU   IESYNTAX+1                                               02462000
IEDEST   EQU   IESYNTAX+1                                               02463000
IEKEEP   EQU   IESYNTAX+1                                               02464000
IENCLASS EQU   IESYNTAX                                                 02465000
IEPRINT  EQU   IESYNTAX                                                 02466000
IEDELETE EQU   IESYNTAX                                                 02467000
IENEXT   EQU   IESYNTAX                                                 02468000
IEBEGIN  EQU   IESYNTAX                                                 02469000
IEHERE   EQU   IESYNTAX                                                 02470000
IEHOLD   EQU   IESYNTAX                                                 02471000
IEPAUSE  EQU   IESYNTAX                                                 02472000
DESTPDE  EQU   IEOUTPL+12                                               02473000
NEWCPDE  EQU   IEOUTPL+8                                                02474000
PRDSPDE  EQU   IEOUTPL+4                                                02475000
CLASPDE1 EQU   IEOUTPL                                                  02476000
IERTEXT  EQU   IEREPLY+2                                                02477000
IEREPLYL EQU   IEREPLY                                                  02478000
MSGTEXT  EQU   MESSAGE+2                                                02479000
MSGLENGT EQU   MESSAGE                                                  02480000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02481000
@RF00302 EQU   @RC00289                                                 02482000
@RC00282 EQU   @EL00002                                                 02483000
@RC00376 EQU   @RC00368                                                 02484000
@RC00473 EQU   @RC00469                                                 02485000
@RF00486 EQU   @RC00462                                                 02486000
@RF00498 EQU   @EL00004                                                 02487000
@PB00004 EQU   @EL00001                                                 02488000
@PB00003 EQU   @PB00004                                                 02489000
@PB00002 EQU   @PB00003                                                 02490000
@ENDDATA EQU   *                                                        02491000
         END   IKJCT469,(C'PLS1855',0701,76056)                         02492000
