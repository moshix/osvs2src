         TITLE 'IKJCT470 OUTPUT GET ROUTINE                            *00001000
                        '                                               00002000
IKJCT470 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJCT470  74.107'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00022000
         MVC   @PC00001(4),0(@01)                                  0001 00023000
*                                                                    */ 00024000
*                                                                  0047 00025000
*/********************************************************************/ 00026000
*/*                                                                  */ 00027000
*/*  THE BASIC FLOW OF IKJCT470, THE GET ROUTINE, CAN BE OBTAINED    */ 00028000
*/*  FROM THE FOLLOWING SECTION OF CODE:                             */ 00029000
*/*                                                                  */ 00030000
*/*          1. IF POINT SWITCH SET, ISSUE POINT TO POSITION FOR GET */ 00031000
*/*          2. GET A RECORD FROM THE SYSOUT DATASET                 */ 00032000
*/*          3. RETURN TO CALLER                                     */ 00033000
*/*                                                                  */ 00034000
*/********************************************************************/ 00035000
*                                                                  0047 00036000
*   OCMTBPTR=OPTR;                  /* INIT BASE OF OUTCOMTB (USE A     00037000
*                                      REG FOR EFFICIENCY)           */ 00038000
         L     @14,@PC00001                                        0047 00039000
         L     OCMTBPTR,OPTR(,@14)                                 0047 00040000
*   GETSW=ON;                       /* INIT SWITCH FOR GET           */ 00041000
         OI    GETSW,B'10000000'                                   0048 00042000
*   RFY                                                            0049 00043000
*     IFGRPL BASED(OUTRPL);         /* BASE RPL MAP ON RPLCORE       */ 00044000
*   RPLECB=ADDR(OUTATTN);           /* ADDR OF ECB TO BE POSTED IF 0050 00045000
*                                      ATTN HIT                      */ 00046000
         L     @14,OUTRPL(,OCMTBPTR)                               0050 00047000
         LA    @10,OUTATTN(,OCMTBPTR)                              0050 00048000
         ST    @10,RPLECB(,@14)                                    0050 00049000
*   RFY                                                            0051 00050000
*     IFGACB BASED(OUTACB);         /* BASE ACB MAP ON ACBCORE       */ 00051000
*   IF POINT=YES THEN               /* POINT BEFORE GET REQUEST      */ 00052000
         TM    POINT(OCMTBPTR),B'10000000'                         0052 00053000
         BNO   @RF00052                                            0052 00054000
*     CALL DOPOINT;                 /* CALL RTN TO HANDLE POINT      */ 00055000
         BAL   @14,DOPOINT                                         0053 00056000
*   DO WHILE ERROR=NO&EODSW=NO&GETSW=YES;/* IF NO ERRORS OR EOD      */ 00057000
@RF00052 B     @DE00054                                            0054 00058000
@DL00054 DS    0H                                                  0055 00059000
*     CALL GETRCD;                  /* GO GET A RECORD               */ 00060000
         BAL   @14,GETRCD                                          0055 00061000
*   END;                                                           0056 00062000
@DE00054 TM    ERROR(OCMTBPTR),B'00001000'                         0056 00063000
         BNZ   @DC00054                                            0056 00064000
         TM    EODSW(OCMTBPTR),B'00010000'                         0056 00065000
         BNZ   @DC00054                                            0056 00066000
         TM    GETSW,B'10000000'                                   0056 00067000
         BO    @DL00054                                            0056 00068000
@DC00054 DS    0H                                                  0057 00069000
*   RETNCODE=ZERO;                  /* SET ZERO RETURN CODE          */ 00070000
         SLR   RETNCODE,RETNCODE                                   0057 00071000
*   RETURN CODE(RETNCODE);          /* RETURN TO CALLER            0058 00072000
*                                                                    */ 00073000
         L     @13,4(,@13)                                         0058 00074000
         L     @00,@SIZDATD                                        0058 00075000
         LR    @01,@11                                             0058 00076000
         FREEMAIN R,LV=(0),A=(1)                                        00077000
         LR    @15,@02                                             0058 00078000
         L     @14,12(,@13)                                        0058 00079000
         LM    @00,@12,20(@13)                                     0058 00080000
         BR    @14                                                 0058 00081000
*                                                                  0059 00082000
*/********************************************************************/ 00083000
*/*                                                                  */ 00084000
*/*            ROUTINE WHICH ISSUES THE POINT MACRO                  */ 00085000
*/*                                                                  */ 00086000
*/********************************************************************/ 00087000
*                                                                  0059 00088000
*DOPOINT:                                                          0059 00089000
*   PROC;                           /* INTERNAL PROCEDURE TO ISSUE 0059 00090000
*                                      POINT                         */ 00091000
@EL00001 L     @13,4(,@13)                                         0059 00092000
@EF00001 L     @00,@SIZDATD                                        0059 00093000
         LR    @01,@11                                             0059 00094000
         FREEMAIN R,LV=(0),A=(1)                                        00095000
@ER00001 LM    @14,@12,12(@13)                                     0059 00096000
         BR    @14                                                 0059 00097000
@PB00001 DS    0H                                                  0059 00098000
DOPOINT  STM   @14,@12,@SA00002                                    0059 00099000
*/********************************************************************/ 00100000
*/*  SET UP THE RPL FOR POINT REQUEST AND ISSUE 'POINT'              */ 00101000
*/********************************************************************/ 00102000
*                                                                  0060 00103000
*   RPLREQ='03'X;                   /* INDICATE 'POINT' REQUEST      */ 00104000
         L     @14,OUTRPL(,OCMTBPTR)                               0060 00105000
         MVI   RPLREQ(@14),X'03'                                   0060 00106000
*   REG1=OUTRPL;                    /* REG1 POINTS TO RPL            */ 00107000
         LR    REG1,@14                                            0061 00108000
*   GEN(POINT  RPL=(1));            /* ISSUE 'POINT' MACRO           */ 00109000
         POINT  RPL=(1)                                                 00110000
*   RETNCODE=REG15;                 /* SAVE 'POINT' RETURN CODE      */ 00111000
         LR    RETNCODE,REG15                                      0063 00112000
*   POINT=NO;                       /* REINIT POINT SWITCH TO ZERO   */ 00113000
         NI    POINT(OCMTBPTR),B'01111111'                         0064 00114000
*/********************************************************************/ 00115000
*/*   CHECK RESULTS OF 'POINT'                                       */ 00116000
*/********************************************************************/ 00117000
*                                                                  0065 00118000
*   IF RETNCODE^=ZERO THEN          /* POINT FAILED                  */ 00119000
         LTR   RETNCODE,RETNCODE                                   0065 00120000
         BZ    @RF00065                                            0065 00121000
*     DO;                                                          0066 00122000
*       ERROR=YES;                  /* SET QUIT SWITCH               */ 00123000
         OI    ERROR(OCMTBPTR),B'00001000'                         0067 00124000
*       OUTMSGID=28;                /* ISSUE MSG VIA VSAMFAIL        */ 00125000
         MVI   OUTMSGID(OCMTBPTR),X'1C'                            0068 00126000
*       OUTRTCD=RETNCODE;           /* SAVE POINT RETURN CODE        */ 00127000
         STH   RETNCODE,OUTRTCD(,OCMTBPTR)                         0069 00128000
*       CALL IKJCT467(OUTCOMTB);    /* CALL MSG HANDLER              */ 00129000
         ST    OCMTBPTR,@AL00001                                   0070 00130000
         L     @15,@CV00412                                        0070 00131000
         LA    @01,@AL00001                                        0070 00132000
         BALR  @14,@15                                             0070 00133000
*     END;                                                         0071 00134000
*   ELSE                                                           0072 00135000
*     ;                             /* POINT SUCCESSFUL              */ 00136000
@RF00065 DS    0H                                                  0073 00137000
*   END DOPOINT;                                                   0073 00138000
@EL00002 DS    0H                                                  0073 00139000
@EF00002 DS    0H                                                  0073 00140000
@ER00002 LM    @14,@12,@SA00002                                    0073 00141000
         BR    @14                                                 0073 00142000
*                                                                  0074 00143000
*/********************************************************************/ 00144000
*/*                                                                  */ 00145000
*/*              ROUTINE WHICH GETS A SYSOUT RECORD                  */ 00146000
*/*                                                                  */ 00147000
*/********************************************************************/ 00148000
*                                                                  0074 00149000
*GETRCD:                                                           0074 00150000
*   PROC;                           /* INTERNAL PROCEDURE TO GET THE    00151000
*                                      NEXT LOGICAL RECORD           */ 00152000
GETRCD   STM   @14,@12,@SA00003                                    0074 00153000
*/********************************************************************/ 00154000
*/*  SET UP RPL FOR GET REQUEST AND ISSUE 'GET'                      */ 00155000
*/********************************************************************/ 00156000
*                                                                  0075 00157000
*   RPLREQ='00'X;                   /* SPECIFY 'GET' REQUEST         */ 00158000
         L     @14,OUTRPL(,OCMTBPTR)                               0075 00159000
         MVI   RPLREQ(@14),X'00'                                   0075 00160000
*   REG1=OUTRPL;                    /* REG1 POINTS TO RPL            */ 00161000
         LR    REG1,@14                                            0076 00162000
*   GEN(GET   RPL=(1));             /* ISSUE GET                     */ 00163000
         GET   RPL=(1)                                                  00164000
*   RETNCODE=REG15;                 /* SAVE 'GET' RETURN CODE        */ 00165000
         LR    RETNCODE,REG15                                      0078 00166000
*   GETSW=OFF;                      /* TURN OFF GET SWITCH           */ 00167000
         NI    GETSW,B'01111111'                                   0079 00168000
*/********************************************************************/ 00169000
*/*   CHECK RESULTS OF 'GET'                                         */ 00170000
*/********************************************************************/ 00171000
*                                                                  0080 00172000
*   IF RETNCODE=NOERROR THEN        /* RC=0 GET WAS SUCCESSFUL       */ 00173000
*                                                                  0080 00174000
         SLR   @14,@14                                             0080 00175000
         CR    RETNCODE,@14                                        0080 00176000
         BNE   @RF00080                                            0080 00177000
*     /***************************************************************/ 00178000
*     /*                                                             */ 00179000
*     /* SUCCESSFUL 'GET'                                            */ 00180000
*     /*                                                             */ 00181000
*     /***************************************************************/ 00182000
*                                                                  0081 00183000
*     DO;                                                          0081 00184000
*       RETNCODE=ZERO;              /* SET RETURN CODE               */ 00185000
         LR    RETNCODE,@14                                        0082 00186000
*       OUTHOLD=RPLRBAR;            /* SAVE RBA OF SYSOUT RCD JUST 0083 00187000
*                                      READ                          */ 00188000
         L     @14,OUTRPL(,OCMTBPTR)                               0083 00189000
         MVC   OUTHOLD(8,OCMTBPTR),RPLRBAR(@14)                    0083 00190000
*       OUTRECL=RPLRLEN;            /* SAVE LEN OF CURRENT RECORD FOR   00191000
*                                      IKJCT471                      */ 00192000
         MVC   OUTRECL(2,OCMTBPTR),RPLRLEN+2(@14)                  0084 00193000
*       OUTRECA=RPLAREA;            /* SAVE ADDR OF RCD FOR '71      */ 00194000
         MVC   OUTRECA(4,OCMTBPTR),RPLAREA(@14)                    0085 00195000
*       IF ACBASA='4'X|ACBASA='2'X THEN/* A CTL CHAR IS PRESENT -  0086 00196000
*                                      EITHER ASA OR MACHINE         */ 00197000
         L     @14,OUTACB(,OCMTBPTR)                               0086 00198000
         TM    ACBASA(@14),B'00000100'                             0086 00199000
         BNO   @GL00003                                            0086 00200000
         TM    ACBASA(@14),B'00001011'                             0086 00201000
         BZ    @RT00086                                            0086 00202000
@GL00003 L     @14,OUTACB(,OCMTBPTR)                               0086 00203000
         TM    ACBASA(@14),B'00000010'                             0086 00204000
         BNO   @RF00086                                            0086 00205000
         TM    ACBASA(@14),B'00001101'                             0086 00206000
         BNZ   @RF00086                                            0086 00207000
@RT00086 DS    0H                                                  0087 00208000
*         IF SUBCMODE=NO&TERM=YES THEN/* NOT PROCESSING A SAVE DS, 0087 00209000
*                                      RATHER PRINT TO A TERMINAL    */ 00210000
         TM    SUBCMODE(OCMTBPTR),B'01000000'                      0087 00211000
         BNZ   @RF00087                                            0087 00212000
         TM    TERM(OCMTBPTR),B'00001000'                          0087 00213000
         BNO   @RF00087                                            0087 00214000
*           DO;                                                    0088 00215000
*             OUTRECL=OUTRECL-ONE;  /* STRIP THE CTL CHAR - UPDATE 0089 00216000
*                                      LEN OF RECORD TO EXCLUDE CTL     00217000
*                                      CHAR                          */ 00218000
         LH    @14,OUTRECL(,OCMTBPTR)                              0089 00219000
         BCTR  @14,0                                               0089 00220000
         STH   @14,OUTRECL(,OCMTBPTR)                              0089 00221000
*             OUTRECA=RPLAREA+ONE;  /* GIVE '71 ADDR OF RCD WITHOUT     00222000
*                                      CTL CHAR                      */ 00223000
         L     @14,OUTRPL(,OCMTBPTR)                               0090 00224000
         LA    @10,1                                               0090 00225000
         AL    @10,RPLAREA(,@14)                                   0090 00226000
         ST    @10,OUTRECA(,OCMTBPTR)                              0090 00227000
*           END;                                                   0091 00228000
*         ELSE                                                     0092 00229000
*           ;                       /* WRITE TO SAVE DS OR REGULAR 0092 00230000
*                                      PRINT DS SO SAVE CTL CHAR     */ 00231000
@RF00087 DS    0H                                                  0093 00232000
*       ELSE                                                       0093 00233000
*         ;                         /* CTL CHAR NOT PRESENT          */ 00234000
@RF00086 DS    0H                                                  0094 00235000
*     END;                          /* END OF ACTION FOR SUCCESSFUL     00236000
*                                      'GET'                       0094 00237000
*                                                                    */ 00238000
*   ELSE                            /* CONTINUE CHECK OF RETN CD     */ 00239000
*     IF RETNCODE=LOGICERR THEN     /* RC=8 LOGICAL ERROR            */ 00240000
*                                                                  0095 00241000
         B     @RC00080                                            0095 00242000
@RF00080 CH    RETNCODE,@CH00045                                   0095 00243000
         BNE   @RF00095                                            0095 00244000
*       /*************************************************************/ 00245000
*       /*                                                           */ 00246000
*       /* LOGICAL ERROR                                             */ 00247000
*       /*                                                           */ 00248000
*       /*************************************************************/ 00249000
*                                                                  0096 00250000
*       DO;                         /* CHECK WHICH LOGIC ERROR       */ 00251000
*         IF RPLERRCD=RPLEODER THEN /* ERROR CODE 4 - END OF DATA    */ 00252000
         L     @14,OUTRPL(,OCMTBPTR)                               0097 00253000
         CLI   RPLERRCD(@14),4                                     0097 00254000
         BNE   @RF00097                                            0097 00255000
*           DO;                                                    0098 00256000
*             EODSW=ON;             /* TURN ON EOD INDICATOR         */ 00257000
         OI    EODSW(OCMTBPTR),B'00010000'                         0099 00258000
*             IF SUBCMODE=YES THEN  /* PROCESSING SAVE SUBCMD        */ 00259000
         TM    SUBCMODE(OCMTBPTR),B'01000000'                      0100 00260000
         BNO   @RF00100                                            0100 00261000
*               DO;                 /* THEREFORE ISSUE 'SAVED'       */ 00262000
*                 IF MEMBNADR=ZERO THEN/* NO MEMBER NAME- PS DATASET */ 00263000
         L     @14,OSVDSPDE(,OCMTBPTR)                             0102 00264000
         L     @14,MEMBNADR(,@14)                                  0102 00265000
         LTR   @14,@14                                             0102 00266000
         BNZ   @RF00102                                            0102 00267000
*                   OUTMSGID=122;   /* ISSUE MSG 325I FOR PS DS      */ 00268000
         MVI   OUTMSGID(OCMTBPTR),X'7A'                            0103 00269000
*                 ELSE              /* DATASET IS PARTITIONED        */ 00270000
*                   OUTMSGID=121;   /* ISSUE MSG 325I FOR PO DS      */ 00271000
         B     @RC00102                                            0104 00272000
@RF00102 MVI   OUTMSGID(OCMTBPTR),X'79'                            0104 00273000
*                 CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER        */ 00274000
@RC00102 ST    OCMTBPTR,@AL00001                                   0105 00275000
         L     @15,@CV00412                                        0105 00276000
         LA    @01,@AL00001                                        0105 00277000
         BALR  @14,@15                                             0105 00278000
*               END;                                               0106 00279000
*             ELSE                                                 0107 00280000
*               ;                   /* PROCESSING FOR PRINT DS       */ 00281000
@RF00100 DS    0H                                                  0108 00282000
*           END;                                                   0108 00283000
*         ELSE                      /* CONTINUE CHECK OF ERR CODE    */ 00284000
*           IF RPLERRCD=RPLINBUF THEN/* ERROR CODE 44 - BUFFER TOO 0109 00285000
*                                      SMALL TO CONTAIN RECORD       */ 00286000
         B     @RC00097                                            0109 00287000
@RF00097 L     @14,OUTRPL(,OCMTBPTR)                               0109 00288000
         CLI   RPLERRCD(@14),44                                    0109 00289000
         BNE   @RF00109                                            0109 00290000
*             DO;                                                  0110 00291000
*               REG4=RPLBUFL;       /* LENGTH OF AREA TO FREE        */ 00292000
         L     REG4,RPLBUFL(,@14)                                  0111 00293000
*               REG1=RPLAREA;       /* ADDR OF AREA TO FREE          */ 00294000
         L     REG1,RPLAREA(,@14)                                  0112 00295000
*               GEN(FREEMAIN R,LV=(4),A=(1),SP=1);/* FREE OLD BUFFER */ 00296000
         FREEMAIN R,LV=(4),A=(1),SP=1                                   00297000
*               RPLBUFL=RPLRLEN;    /* USER INPUT BUFFER SIZE        */ 00298000
         L     @14,OUTRPL(,OCMTBPTR)                               0114 00299000
         L     @10,RPLRLEN(,@14)                                   0114 00300000
         ST    @10,RPLBUFL(,@14)                                   0114 00301000
*               REG4=RPLBUFL;       /* LEN TO GETMAIN FOR BUFFER     */ 00302000
         LR    REG4,@10                                            0115 00303000
*               GEN(GETMAIN R,LV=(4),SP=1);/* GET A LARGER BUFFER    */ 00304000
         GETMAIN R,LV=(4),SP=1                                          00305000
*               RPLAREA=REG1;       /* SAVE ADDR OF NEW INPUT BUFFER    00306000
*                                      FOR SYSOUT RCD                */ 00307000
         L     @14,OUTRPL(,OCMTBPTR)                               0117 00308000
         ST    REG1,RPLAREA(,@14)                                  0117 00309000
*               GETSW=YES;          /* TRY 'GET' AGAIN               */ 00310000
         OI    GETSW,B'10000000'                                   0118 00311000
*             END;                  /* END OF GETTING LARGER BUF     */ 00312000
*           ELSE                    /* ERROR CODES: 32 - INVALID RBA,   00313000
*                                      40 - VIRTUAL STORAGE NA, OR 0120 00314000
*                                      104- INVALID RPL OPTIONS OTHER*/ 00315000
*             DO;                                                  0120 00316000
         B     @RC00109                                            0120 00317000
@RF00109 DS    0H                                                  0121 00318000
*               ERROR=YES;          /* SET ERROR INDICATOR           */ 00319000
         OI    ERROR(OCMTBPTR),B'00001000'                         0121 00320000
*               OUTMSGID=32;        /* ISSUE MSG VIA VSAMFAIL        */ 00321000
         MVI   OUTMSGID(OCMTBPTR),X'20'                            0122 00322000
*               OUTRTCD=RETNCODE;   /* SAVE REG15 RC FOR MSG         */ 00323000
         STH   RETNCODE,OUTRTCD(,OCMTBPTR)                         0123 00324000
*               CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER          */ 00325000
         ST    OCMTBPTR,@AL00001                                   0124 00326000
         L     @15,@CV00412                                        0124 00327000
         LA    @01,@AL00001                                        0124 00328000
         BALR  @14,@15                                             0124 00329000
*             END;                                                 0125 00330000
*       END;                        /* END OF CK FOR WHICH LOGIC   0126 00331000
*                                      ERROR (RC=8)                0126 00332000
*                                                                    */ 00333000
*     ELSE                          /* CONTINUE CHECK OF RC          */ 00334000
*       IF RETNCODE=PHYSERR THEN    /* RC=12 PHYSICAL ERROR          */ 00335000
*                                                                  0127 00336000
         B     @RC00095                                            0127 00337000
@RF00095 CH    RETNCODE,@CH00134                                   0127 00338000
         BNE   @RF00127                                            0127 00339000
*         /***********************************************************/ 00340000
*         /*                                                         */ 00341000
*         /* PHYSICAL ERROR                                          */ 00342000
*         /*                                                         */ 00343000
*         /***********************************************************/ 00344000
*                                                                  0128 00345000
*         DO;                                                      0128 00346000
*           ERROR=YES;              /* SET ERROR INDICATOR           */ 00347000
         OI    ERROR(OCMTBPTR),B'00001000'                         0129 00348000
*           OUTMSGID=32;            /* ISSUE MSG VIA VSAMFAIL        */ 00349000
         MVI   OUTMSGID(OCMTBPTR),X'20'                            0130 00350000
*           OUTRTCD=RETNCODE;       /* SAVE REG15 RC FOR MSG         */ 00351000
         STH   RETNCODE,OUTRTCD(,OCMTBPTR)                         0131 00352000
*           CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER              */ 00353000
         ST    OCMTBPTR,@AL00001                                   0132 00354000
         L     @15,@CV00412                                        0132 00355000
         LA    @01,@AL00001                                        0132 00356000
         BALR  @14,@15                                             0132 00357000
*         END;                                                     0133 00358000
*       ELSE                        /* RC=? STRANGE RC               */ 00359000
*                                                                  0134 00360000
*         /***********************************************************/ 00361000
*         /*                                                         */ 00362000
*         /* UNKNOWN ERROR                                           */ 00363000
*         /*                                                         */ 00364000
*         /***********************************************************/ 00365000
*                                                                  0134 00366000
*         DO;                                                      0134 00367000
         B     @RC00127                                            0134 00368000
@RF00127 DS    0H                                                  0135 00369000
*           ERROR=YES;              /* SET ERROR INDICATOR           */ 00370000
         OI    ERROR(OCMTBPTR),B'00001000'                         0135 00371000
*           OUTMSGID=32;            /* ISSUE MSG VIA VSAMFAIL        */ 00372000
         MVI   OUTMSGID(OCMTBPTR),X'20'                            0136 00373000
*           OUTRTCD=RETNCODE;       /* SAVE REG 15 RC FOR MSG        */ 00374000
         STH   RETNCODE,OUTRTCD(,OCMTBPTR)                         0137 00375000
*           CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER              */ 00376000
         ST    OCMTBPTR,@AL00001                                   0138 00377000
         L     @15,@CV00412                                        0138 00378000
         LA    @01,@AL00001                                        0138 00379000
         BALR  @14,@15                                             0138 00380000
*         END;                                                     0139 00381000
*   END GETRCD;                                                    0140 00382000
@EL00003 DS    0H                                                  0140 00383000
@EF00003 DS    0H                                                  0140 00384000
@ER00003 LM    @14,@12,@SA00003                                    0140 00385000
         BR    @14                                                 0140 00386000
*   END IKJCT470                                                   0141 00387000
*                                                                  0141 00388000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00389000
*/*%INCLUDE SYSLIB  (IKJOCMTB)                                       */ 00390000
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */ 00391000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 00392000
*/*%INCLUDE SYSLIB  (IFGACBVT)                                       */ 00393000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 00394000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                       */ 00395000
*                                                                  0141 00396000
*       ;                                                          0141 00397000
@DATA    DS    0H                                                       00398000
@CH00045 DC    H'8'                                                     00399000
@CH00134 DC    H'12'                                                    00400000
@DATD    DSECT                                                          00401000
         DS    0F                                                       00402000
@SA00001 DS    18F                                                      00403000
@PC00001 DS    1F                                                       00404000
@SA00002 DS    15F                                                      00405000
@SA00003 DS    15F                                                      00406000
@AL00001 DS    1A                                                       00407000
@ZTEMPS  DS    C                                                        00408000
@ZTEMPND EQU   *                                                        00409000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00410000
IKJCT470 CSECT                                                          00411000
         DS    0F                                                       00412000
@DATD    DSECT                                                          00413000
         DS    0D                                                       00414000
GETSW    DS    BL1                                                      00415000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00416000
@ENDDATD EQU   *                                                        00417000
IKJCT470 CSECT                                                          00418000
         DS    0F                                                       00419000
@SIZDATD DC    AL1(1)                                                   00420000
         DC    AL3(@ENDDATD-@DATD)                                      00421000
@CV00412 DC    V(IKJCT467)                                              00422000
         DS    0D                                                       00423000
PATCH70  DS    CL100                                                    00424000
         ORG   PATCH70                                                  00425000
PTCHINIT DC    20CL5'ZAP70'                                             00426000
         ORG   PATCH70+100                                              00427000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00428000
@01      EQU   01                                                       00429000
@02      EQU   02                                                       00430000
@03      EQU   03                                                       00431000
@04      EQU   04                                                       00432000
@05      EQU   05                                                       00433000
@06      EQU   06                                                       00434000
@07      EQU   07                                                       00435000
@08      EQU   08                                                       00436000
@09      EQU   09                                                       00437000
@10      EQU   10                                                       00438000
@11      EQU   11                                                       00439000
@12      EQU   12                                                       00440000
@13      EQU   13                                                       00441000
@14      EQU   14                                                       00442000
@15      EQU   15                                                       00443000
RETNCODE EQU   @02                                                      00444000
OCMTBPTR EQU   @03                                                      00445000
REG1     EQU   @01                                                      00446000
REG4     EQU   @04                                                      00447000
REG15    EQU   @15                                                      00448000
OUTCOMTB EQU   0                                                        00449000
OUTMSGID EQU   OUTCOMTB+4                                               00450000
OUTFLAGS EQU   OUTCOMTB+5                                               00451000
OUTRTCD  EQU   OUTCOMTB+6                                               00452000
OUTATTN  EQU   OUTCOMTB+24                                              00453000
OUTRPL   EQU   OUTCOMTB+48                                              00454000
OUTACB   EQU   OUTCOMTB+56                                              00455000
OUTHOLD  EQU   OUTCOMTB+68                                              00456000
O73PARM  EQU   OUTCOMTB+100                                             00457000
@NM00002 EQU   O73PARM+16                                               00458000
OUTRECA  EQU   OUTCOMTB+140                                             00459000
OUTRECL  EQU   OUTCOMTB+144                                             00460000
OUTKEYWD EQU   OUTCOMTB+146                                             00461000
OUTSW    EQU   OUTCOMTB+148                                             00462000
SUBCMODE EQU   OUTSW                                                    00463000
ERROR    EQU   OUTSW                                                    00464000
OUTIDSSW EQU   OUTCOMTB+150                                             00465000
POINT    EQU   OUTIDSSW                                                 00466000
EODSW    EQU   OUTIDSSW                                                 00467000
TERM     EQU   OUTIDSSW                                                 00468000
OUTXMSG  EQU   OUTCOMTB+164                                             00469000
OUTPLIST EQU   OUTCOMTB+260                                             00470000
OSVDSPDE EQU   OUTCOMTB+284                                             00471000
IFGACB   EQU   0                                                        00472000
ACBCOMN  EQU   IFGACB                                                   00473000
ACBLENG  EQU   ACBCOMN+2                                                00474000
ACBLENG2 EQU   ACBLENG                                                  00475000
ACBAMBL  EQU   ACBCOMN+4                                                00476000
ACBIXLST EQU   ACBAMBL                                                  00477000
ACBJWA   EQU   ACBIXLST                                                 00478000
ACBMACRF EQU   ACBCOMN+12                                               00479000
ACBMACR1 EQU   ACBMACRF                                                 00480000
ACBADR   EQU   ACBMACR1                                                 00481000
ACBCNV   EQU   ACBMACR1                                                 00482000
ACBMACR2 EQU   ACBMACRF+1                                               00483000
ACBLFB   EQU   ACBCOMN+20                                               00484000
ACBBUFPL EQU   ACBLFB                                                   00485000
ACBRECFM EQU   ACBCOMN+24                                               00486000
ACBCCTYP EQU   ACBCOMN+25                                               00487000
ACBASA   EQU   ACBCCTYP                                                 00488000
ACBOPT   EQU   ACBCOMN+26                                               00489000
ACBDSORG EQU   ACBOPT                                                   00490000
ACBCROPS EQU   ACBDSORG                                                 00491000
ACBEXLST EQU   ACBCOMN+36                                               00492000
ACBDDNM  EQU   ACBCOMN+40                                               00493000
ACBAMETH EQU   ACBDDNM+3                                                00494000
ACBOFLGS EQU   ACBCOMN+48                                               00495000
ACBEXFG  EQU   ACBOFLGS                                                 00496000
ACBIOSFG EQU   ACBOFLGS                                                 00497000
ACBINFLG EQU   ACBCOMN+50                                               00498000
ACBUJFCB EQU   ACBCOMN+52                                               00499000
ACBWAPTR EQU   ACBUJFCB                                                 00500000
IFGRPL   EQU   0                                                        00501000
RPLCOMN  EQU   IFGRPL                                                   00502000
RPLIDWD  EQU   RPLCOMN                                                  00503000
RPLREQ   EQU   RPLIDWD+2                                                00504000
RPLLEN   EQU   RPLIDWD+3                                                00505000
RPLECB   EQU   RPLCOMN+8                                                00506000
RPLFDBK  EQU   RPLCOMN+13                                               00507000
RPLRTNCD EQU   RPLFDBK                                                  00508000
RPLCNDCD EQU   RPLFDBK+1                                                00509000
RPLCMPON EQU   RPLCNDCD                                                 00510000
RPLERRCD EQU   RPLCNDCD+1                                               00511000
RPLKEYLE EQU   RPLCOMN+16                                               00512000
RPLAREA  EQU   RPLCOMN+32                                               00513000
RPLARG   EQU   RPLCOMN+36                                               00514000
RPLOPTCD EQU   RPLCOMN+40                                               00515000
RPLOPT1  EQU   RPLOPTCD                                                 00516000
RPLECBSW EQU   RPLOPT1                                                  00517000
RPLOPT2  EQU   RPLOPTCD+1                                               00518000
RPLADR   EQU   RPLOPT2                                                  00519000
RPLOPT3  EQU   RPLOPTCD+2                                               00520000
RPLNXTRP EQU   RPLCOMN+44                                               00521000
RPLRLEN  EQU   RPLCOMN+48                                               00522000
RPLBUFL  EQU   RPLCOMN+52                                               00523000
RPLOPTC2 EQU   RPLCOMN+56                                               00524000
RPLOPT5  EQU   RPLOPTC2                                                 00525000
RPLWRTYP EQU   RPLOPT5                                                  00526000
RPLOPT6  EQU   RPLOPTC2+1                                               00527000
RPLUNTYP EQU   RPLOPT6                                                  00528000
RPLOPT7  EQU   RPLOPTC2+2                                               00529000
RPLCNOPT EQU   RPLOPT7                                                  00530000
RPLOPT8  EQU   RPLOPTC2+3                                               00531000
RPLRBAR  EQU   RPLCOMN+60                                               00532000
RPL6RBA  EQU   RPLRBAR+2                                                00533000
RPLEXTDS EQU   RPLCOMN+68                                               00534000
RPLEXTD1 EQU   RPLEXTDS                                                 00535000
PRNTPDE  EQU   0                                                        00536000
MEMBNADR EQU   PRNTPDE+8                                                00537000
OPTR     EQU   0                                                        00538000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00539000
@NM00020 EQU   PRNTPDE+4                                                00540000
@NM00019 EQU   PRNTPDE                                                  00541000
RPLERMSA EQU   RPLCOMN+72                                               00542000
RPLEMLEN EQU   RPLCOMN+70                                               00543000
RPLACTIV EQU   RPLCOMN+69                                               00544000
RPLBRANC EQU   RPLEXTD1                                                 00545000
RPLNIB   EQU   RPLEXTD1                                                 00546000
RPLGVNT  EQU   RPLEXTD1                                                 00547000
RPLLVNT  EQU   RPLEXTD1                                                 00548000
RPLEXIT  EQU   RPLEXTD1                                                 00549000
RPLNEXIT EQU   RPLEXTD1                                                 00550000
RPLEXSCH EQU   RPLEXTD1                                                 00551000
RPLDDDD  EQU   RPL6RBA+2                                                00552000
RPLS2S2  EQU   RPL6RBA                                                  00553000
RPLS1S1  EQU   RPLRBAR                                                  00554000
RPLRSV88 EQU   RPLOPT8                                                  00555000
RPLUNCON EQU   RPLOPT8                                                  00556000
RPLACTV  EQU   RPLOPT8                                                  00557000
RPLSESS  EQU   RPLOPT8                                                  00558000
RPLPEND  EQU   RPLOPT8                                                  00559000
RPLODPRM EQU   RPLOPT8                                                  00560000
RPLODACP EQU   RPLOPT8                                                  00561000
RPLODACQ EQU   RPLOPT8                                                  00562000
RPLRSV78 EQU   RPLOPT7                                                  00563000
RPLRSV77 EQU   RPLOPT7                                                  00564000
RPLRLSOP EQU   RPLOPT7                                                  00565000
RPLRSV75 EQU   RPLOPT7                                                  00566000
RPLQOPT  EQU   RPLOPT7                                                  00567000
RPLCNIMM EQU   RPLCNOPT                                                 00568000
RPLCNANY EQU   RPLCNOPT                                                 00569000
RPLCNALL EQU   RPLCNOPT                                                 00570000
RPLRSV68 EQU   RPLOPT6                                                  00571000
RPLRSV67 EQU   RPLOPT6                                                  00572000
RPLLOCK  EQU   RPLOPT6                                                  00573000
RPLNCOND EQU   RPLOPT6                                                  00574000
RPLCOND  EQU   RPLOPT6                                                  00575000
RPLEOT   EQU   RPLUNTYP                                                 00576000
RPLEOM   EQU   RPLUNTYP                                                 00577000
RPLEOB   EQU   RPLUNTYP                                                 00578000
RPLWROPT EQU   RPLOPT5                                                  00579000
RPLNODE  EQU   RPLOPT5                                                  00580000
RPLERACE EQU   RPLWRTYP                                                 00581000
RPLEAU   EQU   RPLWRTYP                                                 00582000
RPLNERAS EQU   RPLWRTYP                                                 00583000
RPLPSOPT EQU   RPLOPT5                                                  00584000
RPLSSNIN EQU   RPLOPT5                                                  00585000
RPLDLGIN EQU   RPLOPT5                                                  00586000
RPLCHAIN EQU   RPLNXTRP                                                 00587000
RPLOPT4  EQU   RPLOPTCD+3                                               00588000
RPLALIGN EQU   RPLOPT3                                                  00589000
RPLFMT   EQU   RPLOPT3                                                  00590000
RPLFLD   EQU   RPLOPT3                                                  00591000
RPLVFY   EQU   RPLOPT3                                                  00592000
RPLBLK   EQU   RPLOPT3                                                  00593000
RPLSFORM EQU   RPLOPT3                                                  00594000
RPLEODS  EQU   RPLOPT3                                                  00595000
RPLNSP   EQU   RPLOPT2                                                  00596000
RPLUPD   EQU   RPLOPT2                                                  00597000
@NM00018 EQU   RPLOPT2                                                  00598000
RPLCNV   EQU   RPLOPT2                                                  00599000
RPLADD   EQU   RPLADR                                                   00600000
RPLKEY   EQU   RPLOPT2                                                  00601000
RPLECBIN EQU   RPLECBSW                                                 00602000
RPLGEN   EQU   RPLOPT1                                                  00603000
RPLKGE   EQU   RPLOPT1                                                  00604000
RPLASY   EQU   RPLOPT1                                                  00605000
RPLSKP   EQU   RPLOPT1                                                  00606000
RPLSEQ   EQU   RPLOPT1                                                  00607000
RPLDIR   EQU   RPLOPT1                                                  00608000
RPLLOC   EQU   RPLOPT1                                                  00609000
RPLDAF   EQU   RPLARG+2                                                 00610000
RPLSAF   EQU   RPLARG                                                   00611000
RPLTCBPT EQU   RPLCOMN+28                                               00612000
RPLDACB  EQU   RPLCOMN+24                                               00613000
RPLCCHAR EQU   RPLCOMN+20                                               00614000
RPLSTRID EQU   RPLCOMN+18                                               00615000
RPLKEYL  EQU   RPLKEYLE                                                 00616000
RPLFDB3  EQU   RPLERRCD                                                 00617000
RPLFDB2  EQU   RPLCMPON                                                 00618000
RPLERREG EQU   RPLRTNCD                                                 00619000
RPLSTAT  EQU   RPLCOMN+12                                               00620000
RPLPOST  EQU   RPLECB                                                   00621000
RPLWAIT  EQU   RPLECB                                                   00622000
RPLPLHPT EQU   RPLCOMN+4                                                00623000
RPLLEN2  EQU   RPLLEN                                                   00624000
RPLSTYP  EQU   RPLIDWD+1                                                00625000
RPLID    EQU   RPLIDWD                                                  00626000
ACBAPID  EQU   ACBCOMN+72                                               00627000
ACBCBMWA EQU   ACBCOMN+68                                               00628000
ACBUAPTR EQU   ACBCOMN+64                                               00629000
ACBLRECL EQU   ACBCOMN+62                                               00630000
ACBBLKSZ EQU   ACBCOMN+60                                               00631000
ACBBUFSP EQU   ACBCOMN+56                                               00632000
@NM00017 EQU   ACBWAPTR+1                                               00633000
ACBOPTN  EQU   ACBWAPTR                                                 00634000
ACBCAT   EQU   ACBINFLG                                                 00635000
ACBIJRQE EQU   ACBINFLG                                                 00636000
ACBJEPS  EQU   ACBINFLG                                                 00637000
@NM00016 EQU   ACBINFLG                                                 00638000
ACBERFLG EQU   ACBCOMN+49                                               00639000
ACBBUSY  EQU   ACBIOSFG                                                 00640000
ACBLOCK  EQU   ACBEXFG                                                  00641000
@NM00015 EQU   ACBOFLGS                                                 00642000
ACBDSERR EQU   ACBOFLGS                                                 00643000
ACBOPEN  EQU   ACBOFLGS                                                 00644000
ACBEOV   EQU   ACBOFLGS                                                 00645000
@NM00014 EQU   ACBOFLGS                                                 00646000
ACBDEB   EQU   ACBDDNM+5                                                00647000
ACBERFL  EQU   ACBDDNM+4                                                00648000
ACBAM    EQU   ACBAMETH                                                 00649000
ACBINFL  EQU   ACBDDNM+2                                                00650000
ACBTIOT  EQU   ACBDDNM                                                  00651000
ACBUEL   EQU   ACBEXLST                                                 00652000
ACBPASSW EQU   ACBCOMN+32                                               00653000
@NM00013 EQU   ACBCOMN+28                                               00654000
@NM00012 EQU   ACBDSORG+1                                               00655000
ACBDORGA EQU   ACBDSORG+1                                               00656000
@NM00011 EQU   ACBDSORG                                                 00657000
ACBCRNRE EQU   ACBCROPS                                                 00658000
ACBCRNCK EQU   ACBCROPS                                                 00659000
@NM00010 EQU   ACBCCTYP                                                 00660000
ACBRECAF EQU   ACBRECFM                                                 00661000
ACBJBUF  EQU   ACBBUFPL+2                                               00662000
@NM00009 EQU   ACBBUFPL                                                 00663000
ACBBUFNI EQU   ACBCOMN+18                                               00664000
ACBBUFND EQU   ACBCOMN+16                                               00665000
ACBSTRNO EQU   ACBCOMN+14                                               00666000
@NM00008 EQU   ACBMACR2                                                 00667000
ACBLOGON EQU   ACBMACR2                                                 00668000
ACBSKP   EQU   ACBMACR2                                                 00669000
ACBCHN   EQU   ACBMACR2                                                 00670000
ACBCBRD  EQU   ACBMACR2                                                 00671000
ACBCBOPN EQU   ACBMACR2                                                 00672000
ACBUBF   EQU   ACBMACR1                                                 00673000
ACBOUT   EQU   ACBMACR1                                                 00674000
ACBIN    EQU   ACBMACR1                                                 00675000
ACBDIR   EQU   ACBMACR1                                                 00676000
ACBSEQ   EQU   ACBMACR1                                                 00677000
ACBBLK   EQU   ACBCNV                                                   00678000
ACBADD   EQU   ACBADR                                                   00679000
ACBKEY   EQU   ACBMACR1                                                 00680000
ACBINRTN EQU   ACBCOMN+8                                                00681000
ACBIBCT  EQU   ACBJWA                                                   00682000
ACBLEN2  EQU   ACBLENG2                                                 00683000
ACBSTYP  EQU   ACBCOMN+1                                                00684000
ACBID    EQU   ACBCOMN                                                  00685000
IOPLAREA EQU   OUTCOMTB+296                                             00686000
IOPLPTR  EQU   OUTCOMTB+292                                             00687000
EWAPTR   EQU   OUTCOMTB+288                                             00688000
OUTCLPDE EQU   OUTCOMTB+280                                             00689000
OUTJBPDE EQU   OUTCOMTB+276                                             00690000
ODESTPDE EQU   OUTPLIST+12                                              00691000
ONEWCPDE EQU   OUTPLIST+8                                               00692000
OPRDSPDE EQU   OUTPLIST+4                                               00693000
OUTCPDE1 EQU   OUTPLIST                                                 00694000
OSYSODDN EQU   OUTCOMTB+252                                             00695000
CLASBUFF EQU   OUTCOMTB+244                                             00696000
OUTWORK  EQU   OUTCOMTB+196                                             00697000
OUTSTAE  EQU   OUTCOMTB+188                                             00698000
OUTSBBUF EQU   OUTCOMTB+184                                             00699000
OUTSBPDL EQU   OUTCOMTB+180                                             00700000
OHELPECB EQU   OUTCOMTB+176                                             00701000
OUTTCBH  EQU   OUTCOMTB+172                                             00702000
OUTXRPLY EQU   OUTCOMTB+168                                             00703000
OUTSYNMS EQU   OUTXMSG                                                  00704000
OUTPDL   EQU   OUTCOMTB+160                                             00705000
OUTDAIR  EQU   OUTCOMTB+156                                             00706000
OUTDARB  EQU   OUTCOMTB+152                                             00707000
@NM00007 EQU   OUTIDSSW                                                 00708000
INTRPMSG EQU   OUTIDSSW                                                 00709000
ALLOC    EQU   OUTIDSSW                                                 00710000
@NM00006 EQU   OUTIDSSW                                                 00711000
@NM00005 EQU   OUTIDSSW                                                 00712000
ENDLIST  EQU   OUTSW+1                                                  00713000
WORKDONE EQU   OUTSW+1                                                  00714000
NONTERM  EQU   OUTSW+1                                                  00715000
OPENED   EQU   OUTSW+1                                                  00716000
SYNADERR EQU   OUTSW+1                                                  00717000
HASPABND EQU   OUTSW                                                    00718000
NOWORK   EQU   OUTSW                                                    00719000
ENDKEEP  EQU   OUTSW                                                    00720000
ENDSW    EQU   OUTSW                                                    00721000
UNALCALL EQU   OUTSW                                                    00722000
SUBSYS   EQU   OUTSW                                                    00723000
SUBNEXT  EQU   OUTKEYWD+1                                               00724000
SUBBEGN  EQU   OUTKEYWD+1                                               00725000
SUBHERE  EQU   OUTKEYWD+1                                               00726000
SUBCONT  EQU   OUTKEYWD+1                                               00727000
DEST     EQU   OUTKEYWD+1                                               00728000
KEEP     EQU   OUTKEYWD+1                                               00729000
NEWCLASS EQU   OUTKEYWD                                                 00730000
PRINT    EQU   OUTKEYWD                                                 00731000
DELETE   EQU   OUTKEYWD                                                 00732000
NEXT     EQU   OUTKEYWD                                                 00733000
BEGIN    EQU   OUTKEYWD                                                 00734000
HERE     EQU   OUTKEYWD                                                 00735000
HOLD     EQU   OUTKEYWD                                                 00736000
PAUSE    EQU   OUTKEYWD                                                 00737000
OUTBUFL  EQU   @NM00002+2                                               00738000
OUTRECUN EQU   @NM00002+1                                               00739000
NOMEMNAM EQU   @NM00002+1                                               00740000
NEWDS    EQU   @NM00002+1                                               00741000
NEEDFREE EQU   @NM00002+1                                               00742000
OUTRECV  EQU   @NM00002+1                                               00743000
DSOPEN   EQU   @NM00002+1                                               00744000
DSALLOC  EQU   @NM00002+1                                               00745000
@NM00004 EQU   @NM00002+1                                               00746000
@NM00003 EQU   @NM00002                                                 00747000
OUTBUFA  EQU   O73PARM+12                                               00748000
PRINTDDN EQU   O73PARM+4                                                00749000
OUTDCB   EQU   O73PARM                                                  00750000
STRCTNUM EQU   OUTCOMTB+96                                              00751000
OUTBKCNT EQU   OUTCOMTB+92                                              00752000
OUTBKAPX EQU   OUTCOMTB+84                                              00753000
OUTBKNEW EQU   OUTCOMTB+76                                              00754000
OUTEMPSB EQU   OUTCOMTB+64                                              00755000
OUTACBL  EQU   OUTCOMTB+60                                              00756000
OUTRPLL  EQU   OUTCOMTB+52                                              00757000
OUTSOBSO EQU   OUTCOMTB+44                                              00758000
OUTSOBH  EQU   OUTCOMTB+40                                              00759000
OUTEMPMN EQU   OUTCOMTB+32                                              00760000
OUTEXTRA EQU   OUTCOMTB+28                                              00761000
POSTED   EQU   OUTATTN                                                  00762000
@NM00001 EQU   OUTATTN                                                  00763000
OUTCMDNM EQU   OUTCOMTB+16                                              00764000
OUTMACN  EQU   OUTCOMTB+8                                               00765000
KEY1     EQU   OUTFLAGS                                                 00766000
OUTCPPL  EQU   OUTCOMTB                                                 00767000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00768000
@RC00127 EQU   @EL00003                                                 00769000
@RC00095 EQU   @EL00003                                                 00770000
@RC00080 EQU   @EL00003                                                 00771000
@PB00003 EQU   @EL00001                                                 00772000
@PB00002 EQU   @PB00003                                                 00773000
@RC00109 EQU   @RC00095                                                 00774000
@RC00097 EQU   @RC00095                                                 00775000
@ENDDATA EQU   *                                                        00776000
         END   IKJCT470                                                 00777000
