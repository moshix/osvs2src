         TITLE 'IKJCT473 OUTPUT CP ALLOC/UNALLOC                       *00001000
                        '                                               00002000
IKJCT473 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJCT473  74.107'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00022000
         MVC   @PC00001(4),0(@01)                                  0001 00023000
*                                                                    */ 00024000
*                                                                  0027 00025000
*/********************************************************************/ 00026000
*/*                                                                  */ 00027000
*/*                                                                  */ 00028000
*/*                       B E G I N  C O D E                         */ 00029000
*/*                                                                  */ 00030000
*/*                                                                  */ 00031000
*/********************************************************************/ 00032000
*                                                                  0027 00033000
*   OCMTBPTR=OUTP;                  /* PUT BASE IN REG FOR EFFICIENCY*/ 00034000
         L     @14,@PC00001                                        0027 00035000
         L     OCMTBPTR,OUTP(,@14)                                 0027 00036000
*   OUTDAIR=ADDR(DAPLSTRG);         /* ADDR OF DAIR PARMLIST IN    0028 00037000
*                                      OUTCOMTB FOR '67              */ 00038000
         LA    @14,DAPLSTRG                                        0028 00039000
         ST    @14,OUTDAIR(,OCMTBPTR)                              0028 00040000
*   IF SUBCMODE=YES THEN            /* SUBCMD MODE, SO SAVE DS TO  0029 00041000
*                                      PROCESS                       */ 00042000
         TM    SUBCMODE(OCMTBPTR),B'01000000'                      0029 00043000
         BNO   @RF00029                                            0029 00044000
*     PDEBASE=OSVDSPDE;             /* SET DSNAME PDE BASE ON SAVE 0030 00045000
*                                      PDE                           */ 00046000
         L     PDEBASE,OSVDSPDE(,OCMTBPTR)                         0030 00047000
*   ELSE                            /* NOT SUBCMD MODE, MUST BE PRINT   00048000
*                                      DS                            */ 00049000
*     PDEBASE=OPRDSPDE;             /* SET DSNAME PDE BASE ON PRINT     00050000
*                                      PDE                           */ 00051000
*                                                                  0031 00052000
         B     @RC00029                                            0031 00053000
@RF00029 L     PDEBASE,OPRDSPDE(,OCMTBPTR)                         0031 00054000
*   /*****************************************************************/ 00055000
*   /*                                                               */ 00056000
*   /* FILL IN DAIR PARAMETER LIST                                   */ 00057000
*   /*                                                               */ 00058000
*   /*****************************************************************/ 00059000
*                                                                  0032 00060000
*   DAIRPTR=ADDR(DAIRAREA);         /* BASE DAIR PARM BLOCKS - 04 &     00061000
*                                      08                            */ 00062000
@RC00029 LA    DAIRPTR,DAIRAREA                                    0032 00063000
*   DAPB1PTR=ADDR(DAPBAREA);        /* BASE DAIR PARM BLOCKS - 1C &     00064000
*                                      18                            */ 00065000
         LA    DAPB1PTR,DAPBAREA                                   0033 00066000
*   DAPLPTR=ADDR(DAPLSTRG);         /* BASE DAPL                     */ 00067000
         LA    DAPLPTR,DAPLSTRG                                    0034 00068000
*   DAPL=DAPL&&DAPL;                /* ZERO DAPL                     */ 00069000
         XC    DAPL(20,DAPLPTR),DAPL(DAPLPTR)                      0035 00070000
*   DAPLUPT=CPPLUPT;                /* FILL IN DAPL                  */ 00071000
         L     @14,OUTCPPL(,OCMTBPTR)                              0036 00072000
         MVC   DAPLUPT(4,DAPLPTR),CPPLUPT(@14)                     0036 00073000
*   DAPLECT=CPPLECT;                /* .....                         */ 00074000
         MVC   DAPLECT(4,DAPLPTR),CPPLECT(@14)                     0037 00075000
*   DAPLECB=ADDR(OUTATTN);          /* .....                         */ 00076000
         LA    @10,OUTATTN(,OCMTBPTR)                              0038 00077000
         ST    @10,DAPLECB(,DAPLPTR)                               0038 00078000
*   DAPLPSCB=CPPLPSCB;              /* .....                         */ 00079000
*                                                                  0039 00080000
         MVC   DAPLPSCB(4,DAPLPTR),CPPLPSCB(@14)                   0039 00081000
*   /*****************************************************************/ 00082000
*   /*                                                               */ 00083000
*   /* INITIALIZE CORE FOR DAIR PARM BLOCKS - 04/08 & 18/1C. KEEP 08 */ 00084000
*   /* AND 18 BLOCKS SEPARATE, SO THAT FOR A SEQUENCE OF: SEARCH(04),*/ 00085000
*   /* ALLOC(08), UNALLOC(18), AND REALLOC(08), CERTAIN FIELDS OF THE*/ 00086000
*   /* 08 BLOCK NEED NOT BE REINIT BY THE OVERHEAD OF A SEARCH(04).  */ 00087000
*   /*                                                               */ 00088000
*   /*****************************************************************/ 00089000
*                                                                  0040 00090000
*   DAPB08='';                      /* FIRST BLANK THE ENTIRE BLOCK  */ 00091000
         MVI   DAPB08(DAIRPTR),C' '                                0040 00092000
         MVC   DAPB08+1(83,DAIRPTR),DAPB08(DAIRPTR)                0040 00093000
*   DAPB08(1:8)=DAPB08(1:8)&&DAPB08(1:8);/* THEN ZERO SELECT FLDS    */ 00094000
         XC    DAPB08(8,DAIRPTR),DAPB08(DAIRPTR)                   0041 00095000
*   DAPB08(37:52)=DAPB08(37:52)&&DAPB08(37:52);                    0042 00096000
         XC    DAPB08+36(16,DAIRPTR),DAPB08+36(DAIRPTR)            0042 00097000
*   DAPB08(69:76)=DAPB08(69:76)&&DAPB08(69:76);                    0043 00098000
         XC    DAPB08+68(8,DAIRPTR),DAPB08+68(DAIRPTR)             0043 00099000
*   DAPB18='';                      /* FIRST BLANK THE ENTIRE BLOCK  */ 00100000
         MVI   DAPB18(DAPB1PTR),C' '                               0044 00101000
         MVC   DAPB18+1(39,DAPB1PTR),DAPB18(DAPB1PTR)              0044 00102000
*   DAPB18(1:8)=DAPB18(1:8)&&DAPB18(1:8);/* THEN ZERO SELECT FIELDS     00103000
*                                                                    */ 00104000
         XC    DAPB18(8,DAPB1PTR),DAPB18(DAPB1PTR)                 0045 00105000
*                                                                  0046 00106000
*/********************************************************************/ 00107000
*/*                                                                  */ 00108000
*/*                                                                  */ 00109000
*/*  DETERMINE THE REASON FOR CALLING THIS DAIR INTERFACE MODULE     */ 00110000
*/*  AND SET BITS TO REQUEST THAT FUNCTION.                          */ 00111000
*/*                                                                  */ 00112000
*/*                                                                  */ 00113000
*/********************************************************************/ 00114000
*                                                                  0046 00115000
*   SWITCHES=SWITCHES&&SWITCHES;    /* INIT THE FUNTION SWITCHES     */ 00116000
         XC    SWITCHES(1),SWITCHES                                0046 00117000
*   IF UNALCALL=YES THEN            /* UNALLOCATION REQUESTED        */ 00118000
         TM    UNALCALL(OCMTBPTR),B'00100000'                      0047 00119000
         BNO   @RF00047                                            0047 00120000
*     DO;                                                          0048 00121000
*       UNALCALL=NO;                                               0049 00122000
         NI    UNALCALL(OCMTBPTR),B'11011111'                      0049 00123000
*       ENTRY18=YES;                                               0050 00124000
         OI    ENTRY18,B'00100000'                                 0050 00125000
*     END;                                                         0051 00126000
*   ELSE                            /* CHECK TO SEE WHICH ALLOCATION */ 00127000
*     IF SUBCMODE=NO&TERM=YES THEN  /* NOT SAVE DS, BUT PRINT TERM   */ 00128000
         B     @RC00047                                            0052 00129000
@RF00047 TM    SUBCMODE(OCMTBPTR),B'01000000'                      0052 00130000
         BNZ   @RF00052                                            0052 00131000
         TM    TERM(OCMTBPTR),B'00001000'                          0052 00132000
         BNO   @RF00052                                            0052 00133000
*       ENTRY1C=YES;                                               0053 00134000
         OI    ENTRY1C,B'00010000'                                 0053 00135000
*     ELSE                          /* PRINT DS TO ALLOC             */ 00136000
*       DO;                                                        0054 00137000
         B     @RC00052                                            0054 00138000
@RF00052 DS    0H                                                  0055 00139000
*         ENTRY04=YES;                                             0055 00140000
*         ENTRY08=YES;                                             0056 00141000
         OI    ENTRY04,B'11000000'                                 0056 00142000
*       END;                                                       0057 00143000
*                                                                  0058 00144000
*/********************************************************************/ 00145000
*/*                                                                  */ 00146000
*/*                                                                  */ 00147000
*/*  PROCESS THE INITIAL REQUEST AS WELL AS ANY SUBSEQUENT           */ 00148000
*/*  REQUESTS WHICH OCCUR.  FOR INSTANCE, THE DSORG OF THE           */ 00149000
*/*  ALLOCATED DATASET MAY NOT BE ACCEPTABLE, SO UNALLOCATE          */ 00150000
*/*  IT AFTER ISSUING AN ERROR MESSAGE.                              */ 00151000
*/*                                                                  */ 00152000
*/*                                                                  */ 00153000
*/********************************************************************/ 00154000
*                                                                  0058 00155000
*   DO WHILE ENTRY04=YES|ENTRY08=YES|ENTRY18=YES|ENTRY1C=YES;      0058 00156000
*                                                                  0058 00157000
@RC00052 DS    0H                                                  0058 00158000
@RC00047 B     @DE00058                                            0058 00159000
@DL00058 DS    0H                                                  0059 00160000
*/********************************************************************/ 00161000
*/* ENTRY CODE 18                                                    */ 00162000
*/*        UNALLOCATE THE DATASET                                    */ 00163000
*/********************************************************************/ 00164000
*                                                                  0059 00165000
*     IF ENTRY18=YES THEN                                          0059 00166000
         TM    ENTRY18,B'00100000'                                 0059 00167000
         BNO   @RF00059                                            0059 00168000
*       DO;                                                        0060 00169000
*         ENTRY18=OFF;                                             0061 00170000
         NI    ENTRY18,B'11011111'                                 0061 00171000
*         DA18CD=DA18;              /* TELL DAIR TO UNALLOCATE       */ 00172000
         MVC   DA18CD(2,DAPB1PTR),@CB00318                         0062 00173000
*         DA18FLG=DA18FLG&&DA18FLG; /* CLEAR FLAG RETURN FIELD       */ 00174000
         XC    DA18FLG(2,DAPB1PTR),DA18FLG(DAPB1PTR)               0063 00175000
*         DA18PDSN=ZERO;                                           0064 00176000
         SLR   @14,@14                                             0064 00177000
         ST    @14,DA18PDSN(,DAPB1PTR)                             0064 00178000
*         DA18DDN=PRINTDDN(STRCTNUM);/* TELL DAIR DDNAME TO UNALLOC  */ 00179000
         L     @14,STRCTNUM(,OCMTBPTR)                             0065 00180000
         MH    @14,@CH00300                                        0065 00181000
         ALR   @14,OCMTBPTR                                        0065 00182000
         MVC   DA18DDN(8,DAPB1PTR),PRINTDDN-20(@14)                0065 00183000
*         DA18DPS2=ZERO;                                           0066 00184000
         MVI   DA18DPS2(DAPB1PTR),X'00'                            0066 00185000
*         DA18CTL=ZERO;                                            0067 00186000
         MVI   DA18CTL(DAPB1PTR),X'00'                             0067 00187000
*         DA18JBNM='';                                             0068 00188000
         MVI   DA18JBNM(DAPB1PTR),C' '                             0068 00189000
         MVC   DA18JBNM+1(7,DAPB1PTR),DA18JBNM(DAPB1PTR)           0068 00190000
*         DAPLDAPB=ADDR(DAPBAREA);  /* DAPL POINTS TO DAIR BLD       */ 00191000
         LA    @14,DAPBAREA                                        0069 00192000
         ST    @14,DAPLDAPB(,DAPLPTR)                              0069 00193000
*         REG1=DAPLPTR;             /* PARAM FOR DAIR                */ 00194000
         LR    REG1,DAPLPTR                                        0070 00195000
*         GEN(LINK EP=IKJDAIR);     /* LINK TO DAIR                  */ 00196000
         LINK EP=IKJDAIR                                                00197000
*         OUTRTCD=REG15;            /* SAVE DAIR RETURN CODE         */ 00198000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0072 00199000
*         IF OUTRTCD^=ZERO THEN                                    0073 00200000
         LH    @14,OUTRTCD(,OCMTBPTR)                              0073 00201000
         LTR   @14,@14                                             0073 00202000
         BZ    @RF00073                                            0073 00203000
*           DO;                                                    0074 00204000
*             OUTMSGID=16;          /* ISSUE DAIRFAIL MSG            */ 00205000
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0075 00206000
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */ 00207000
         ST    OCMTBPTR,@AL00001                                   0076 00208000
         L     @15,@CV00338                                        0076 00209000
         LA    @01,@AL00001                                        0076 00210000
         BALR  @14,@15                                             0076 00211000
*             OUTRTCD=ERRCDE;                                      0077 00212000
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0077 00213000
*           END;                                                   0078 00214000
*         ELSE                      /* DAIR TC=0                     */ 00215000
*           DSALLOC(STRCTNUM)=NO;   /* INDICATE NO LONGER ALLOC      */ 00216000
         B     @RC00073                                            0079 00217000
@RF00073 L     @14,STRCTNUM(,OCMTBPTR)                             0079 00218000
         MH    @14,@CH00300                                        0079 00219000
         ALR   @14,OCMTBPTR                                        0079 00220000
         NI    DSALLOC-20(@14),B'10111111'                         0079 00221000
*       END;                        /* END UNALLOC REQUEST PROCESSING   00222000
*                                                                    */ 00223000
@RC00073 DS    0H                                                  0081 00224000
*                                                                  0081 00225000
*/********************************************************************/ 00226000
*/*   ENTRY CODE 1C                                                  */ 00227000
*/*       ALLOCATE A TERMINAL FOR PRINT DATASET                      */ 00228000
*/********************************************************************/ 00229000
*                                                                  0081 00230000
*     IF ENTRY1C=YES THEN                                          0081 00231000
@RF00059 TM    ENTRY1C,B'00010000'                                 0081 00232000
         BNO   @RF00081                                            0081 00233000
*       DO;                                                        0082 00234000
*         ENTRY1C=OFF;                                             0083 00235000
         NI    ENTRY1C,B'11101111'                                 0083 00236000
*         DA1CCD=DA1C;              /* DAIR ENTRY CODE 1C            */ 00237000
         MVC   DA1CCD(2,DAPB1PTR),@CB00320                         0084 00238000
*         DAPLDAPB=ADDR(DAPBAREA);  /* DAPL POINTS TO PARM BLK       */ 00239000
         LA    @14,DAPBAREA                                        0085 00240000
         ST    @14,DAPLDAPB(,DAPLPTR)                              0085 00241000
*         REG1=DAPLPTR;             /* DAIR PARAMETER LIST           */ 00242000
         LR    REG1,DAPLPTR                                        0086 00243000
*         GEN(LINK EP=IKJDAIR);     /* LINK TO DAIR TO ALLOC TERM    */ 00244000
         LINK EP=IKJDAIR                                                00245000
*         OUTRTCD=REG15;            /* SAVE DAIR RETURN CODE         */ 00246000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0088 00247000
*         IF OUTRTCD^=ZERO THEN     /* IF ANY ERRORS                 */ 00248000
         LH    @14,OUTRTCD(,OCMTBPTR)                              0089 00249000
         LTR   @14,@14                                             0089 00250000
         BZ    @RF00089                                            0089 00251000
*           DO;                                                    0090 00252000
*             OUTMSGID=16;          /* PROVIDE DAIRFAIL CODE         */ 00253000
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0091 00254000
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */ 00255000
         ST    OCMTBPTR,@AL00001                                   0092 00256000
         L     @15,@CV00338                                        0092 00257000
         LA    @01,@AL00001                                        0092 00258000
         BALR  @14,@15                                             0092 00259000
*             ERROR=YES;            /* INDICATE SERIOUS ERROR        */ 00260000
         OI    ERROR(OCMTBPTR),B'00001000'                         0093 00261000
*             OUTRTCD=ERRCDE;       /* INDICATE TERMINATION OF OUTPUT*/ 00262000
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0094 00263000
*           END;                                                   0095 00264000
*         ELSE                      /* NO DAIR ERRORS                */ 00265000
*           DO;                                                    0096 00266000
         B     @RC00089                                            0096 00267000
@RF00089 DS    0H                                                  0097 00268000
*             NEWDS(STRCTNUM)=YES;  /* INDICATE DEFAULT LRECL NEEDED */ 00269000
         L     @14,STRCTNUM(,OCMTBPTR)                             0097 00270000
         MH    @14,@CH00300                                        0097 00271000
         ST    @14,@TF00001                                        0097 00272000
         ALR   @14,OCMTBPTR                                        0097 00273000
         OI    NEWDS-20(@14),B'00000100'                           0097 00274000
*             PRINTDDN(STRCTNUM)=DA1CDDN;/* SAVE DDNAME              */ 00275000
         LR    @14,OCMTBPTR                                        0098 00276000
         AL    @14,@TF00001                                        0098 00277000
         MVC   PRINTDDN-20(8,@14),DA1CDDN(DAPB1PTR)                0098 00278000
*             DSALLOC(STRCTNUM)=YES;/* INDICATE A DS ALLOCATED       */ 00279000
         LR    @14,OCMTBPTR                                        0099 00280000
         AL    @14,@TF00001                                        0099 00281000
         OI    DSALLOC-20(@14),B'01000000'                         0099 00282000
*           END;                                                   0100 00283000
*       END;                        /* END ALLOC TERMINAL PROCESSING    00284000
*                                                                    */ 00285000
@RC00089 DS    0H                                                  0102 00286000
*                                                                  0102 00287000
*/********************************************************************/ 00288000
*/*   ENTRY CODE 04                                                  */ 00289000
*/*         SEARCH THE ALLOCATED DATASETS AND CATALOG TO SEE IF      */ 00290000
*/*         THE DATASET EXISTS                                       */ 00291000
*/********************************************************************/ 00292000
*                                                                  0102 00293000
*     IF ENTRY04=YES THEN                                          0102 00294000
@RF00081 TM    ENTRY04,B'10000000'                                 0102 00295000
         BNO   @RF00102                                            0102 00296000
*       DO;                                                        0103 00297000
*         ENTRY04=OFF;                                             0104 00298000
*                                                                  0104 00299000
         NI    ENTRY04,B'01111111'                                 0104 00300000
*         /***********************************************************/ 00301000
*         /*                                                         */ 00302000
*         /* CHECK THE DATASET NAME LENGTH - CAN'T BE >44 CHARS WHEN */ 00303000
*         /* QUALIFIED                                               */ 00304000
*         /*                                                         */ 00305000
*         /***********************************************************/ 00306000
*                                                                  0105 00307000
*         IF(DSNLTH1>36&DSNFLG1^=DSNQUO)|(DSNLTH1>44&DSNFLG1=DSNQUO)    00308000
*           THEN                    /* DSN>36 & NOT QUOTED OR DSN>44    00309000
*                                      AND QUOTED                    */ 00310000
*                                                                  0105 00311000
         LH    @14,DSNLTH1(,PDEBASE)                               0105 00312000
         CH    @14,@CH00382                                        0105 00313000
         BNH   @GL00002                                            0105 00314000
         CLI   DSNFLG1(PDEBASE),192                                0105 00315000
         BNE   @RT00105                                            0105 00316000
@GL00002 LH    @14,DSNLTH1(,PDEBASE)                               0105 00317000
         CH    @14,@CH00358                                        0105 00318000
         BNH   @RF00105                                            0105 00319000
         CLI   DSNFLG1(PDEBASE),192                                0105 00320000
         BNE   @RF00105                                            0105 00321000
@RT00105 DS    0H                                                  0106 00322000
*           /*********************************************************/ 00323000
*           /*                                                       */ 00324000
*           /* ERROR - FULLY QUALIFIED DSNAME IS OR WILL BE > 44     */ 00325000
*           /* CHARACTERS                                            */ 00326000
*           /*                                                       */ 00327000
*           /*********************************************************/ 00328000
*                                                                  0106 00329000
*           DO;                                                    0106 00330000
*             SWITCHES=SWITCHES&&SWITCHES;/* HALT FURTHER DAIR CALLS */ 00331000
         XC    SWITCHES(1),SWITCHES                                0107 00332000
*             OUTMSGID=110;         /* DSNAME TOO LONG MSG           */ 00333000
         MVI   OUTMSGID(OCMTBPTR),X'6E'                            0108 00334000
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */ 00335000
         ST    OCMTBPTR,@AL00001                                   0109 00336000
         L     @15,@CV00338                                        0109 00337000
         LA    @01,@AL00001                                        0109 00338000
         BALR  @14,@15                                             0109 00339000
*             IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS AND TERMINAL 0110 00340000
*                                      INPUT                         */ 00341000
         TM    ERROR(OCMTBPTR),B'00001000'                         0110 00342000
         BNZ   @RF00110                                            0110 00343000
         TM    NONTERM(OCMTBPTR),B'00100000'                       0110 00344000
         BNZ   @RF00110                                            0110 00345000
*               NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME ERROR INDICATOR,   00346000
*                                      BUT GIVE USER ANOTHER CHANCE     00347000
*                                      IF IN SUBCMD MODE             */ 00348000
         L     @14,STRCTNUM(,OCMTBPTR)                             0111 00349000
         MH    @14,@CH00300                                        0111 00350000
         ALR   @14,OCMTBPTR                                        0111 00351000
         OI    NOMEMNAM-20(@14),B'00000010'                        0111 00352000
*             ELSE                  /* IF IN CLIST OR NOPROMPT MODE  */ 00353000
*               DO;                                                0112 00354000
         B     @RC00110                                            0112 00355000
@RF00110 DS    0H                                                  0113 00356000
*                 ERROR=YES;        /* TERMINATE OUTPUT              */ 00357000
         OI    ERROR(OCMTBPTR),B'00001000'                         0113 00358000
*                 OUTRTCD=ERRCDE;   /* INDICATE ERROR CONDITIONS     */ 00359000
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0114 00360000
*               END;                                               0115 00361000
*           END;                                                   0116 00362000
*         ELSE                      /* DSNAME CORRECT LENGTH         */ 00363000
*                                                                  0117 00364000
*           /*********************************************************/ 00365000
*           /*                                                       */ 00366000
*           /* SET UP AND SEARCH THE ALLOCATED DATASETS AND THE      */ 00367000
*           /* CATALOG FOR THE DATASET NAME TO BE ALLOCATED - ENTRY  */ 00368000
*           /* 04                                                    */ 00369000
*           /*                                                       */ 00370000
*           /*********************************************************/ 00371000
*                                                                  0117 00372000
*           DO;                                                    0117 00373000
         B     @RC00105                                            0117 00374000
@RF00105 DS    0H                                                  0118 00375000
*             QUALDSNL=DSNLTH1;     /* GET DSNAME LENGTH FROM PDE    */ 00376000
         LH    @14,DSNLTH1(,PDEBASE)                               0118 00377000
         STH   @14,QUALDSNL                                        0118 00378000
*             QUALDSNM='';          /* BLANK DATASET NAME FIELD      */ 00379000
         MVI   QUALDSNM,C' '                                       0119 00380000
         MVC   QUALDSNM+1(43),QUALDSNM                             0119 00381000
*             QUALDSNM=NAME(1:DSNLTH1);/* MOVE DSN                   */ 00382000
         MVI   QUALDSNM+1,C' '                                     0120 00383000
         MVC   QUALDSNM+2(42),QUALDSNM+1                           0120 00384000
         LR    @10,@14                                             0120 00385000
         BCTR  @10,0                                               0120 00386000
         L     @07,DSNAMEAD(,PDEBASE)                              0120 00387000
         EX    @10,@SM00407                                        0120 00388000
*             IF DSNFLG1^=DSNQUO THEN/* IF DSNAME NOT IN QUOTES IT IS   00389000
*                                      NOT QUALIFIED                 */ 00390000
         CLI   DSNFLG1(PDEBASE),192                                0121 00391000
         BE    @RF00121                                            0121 00392000
*               DO;                 /* ADD QUALIFIER                 */ 00393000
*                 QUALDSNM(DSNLTH1+1:DSNLTH1+8)=OUTLIST;/* APPEND  0123 00394000
*                                      .OUTLIST                      */ 00395000
         LA    @10,QUALDSNM(@14)                                   0123 00396000
         MVC   0(8,@10),@CC00333                                   0123 00397000
*                 QUALDSNL=QUALDSNL+8;/* ADD LTH OF QUALIFIER        */ 00398000
         AH    @14,@CH00045                                        0124 00399000
         STH   @14,QUALDSNL                                        0124 00400000
*               END;                                               0125 00401000
*             DA04CD=DA04;          /* DAIR ENTRY CODE TO CHECK    0126 00402000
*                                      STATUS OF DATASET             */ 00403000
@RF00121 MVC   DA04CD(2,DAIRPTR),@CB00314                          0126 00404000
*             DA04PDSN=ADDR(QUALNAME);/* INSERT ADDR OF FULLY      0127 00405000
*                                      QUALIFIED DSNAME              */ 00406000
         LA    @14,QUALNAME                                        0127 00407000
         ST    @14,DA04PDSN(,DAIRPTR)                              0127 00408000
*             DAPB04(13:16)=ZERO;   /* ZERO THE DAIR FLAGS           */ 00409000
         SLR   @14,@14                                             0128 00410000
         ST    @14,@TF00001                                        0128 00411000
         MVC   DAPB04+12(4,DAIRPTR),@TF00001                       0128 00412000
*             DAPLDAPB=ADDR(DAIRAREA);/* DAPL POINTS TO PARM BLK     */ 00413000
         LA    @14,DAIRAREA                                        0129 00414000
         ST    @14,DAPLDAPB(,DAPLPTR)                              0129 00415000
*             REG1=DAPLPTR;         /* LOAD DAIR PARAMETER LIST      */ 00416000
         LR    REG1,DAPLPTR                                        0130 00417000
*             GEN(LINK EP=IKJDAIR); /* LINK TO DAIR FOR DS STATUS    */ 00418000
         LINK EP=IKJDAIR                                                00419000
*             OUTRTCD=REG15;        /* SAVE RETURN CODE            0132 00420000
*                                                                    */ 00421000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0132 00422000
*                                                                  0133 00423000
*             /*******************************************************/ 00424000
*             /*                                                     */ 00425000
*             /* CHECK THE RESULTS OF DAIR ENTRY 04 TO DETERMINE IF  */ 00426000
*             /* THE DATASET IS NEW OR OLD. SET UP TO ALLOCATE THE   */ 00427000
*             /* DATASET ACCORDINGLY (NEW/CATLOG OR OLD/KEEP). IF    */ 00428000
*             /* ERRORS IN DSORG ARE DETECTED IKJCT463 WILL ISSUE    */ 00429000
*             /* MODE FOR NEW DATASET NAME (IF IN SUBCMD MODE) OR    */ 00430000
*             /* IKJCT469 WILL END AND RETURN TO THE TMP. NOTE: IF   */ 00431000
*             /* THE DATASET IS ALLOCATED BEFORE THE DSORG ERROR IS  */ 00432000
*             /* DETECTED THE DATASET IS FIRST UNALLOCATED BEFORE    */ 00433000
*             /* RETURNING                                           */ 00434000
*             /*                                                     */ 00435000
*             /*******************************************************/ 00436000
*                                                                  0133 00437000
*             IF OUTRTCD=ZERO THEN  /* DAIR RC=0 INDICATES DS WAS  0133 00438000
*                                      FOUND ON ENTRY 04. DS IS OLD. */ 00439000
*                                                                  0133 00440000
         LH    @14,OUTRTCD(,OCMTBPTR)                              0133 00441000
         LTR   @14,@14                                             0133 00442000
         BNZ   @RF00133                                            0133 00443000
*               /*****************************************************/ 00444000
*               /*                                                   */ 00445000
*               /* DATASET IS OLD (WAS ALLOCATED OR FOUND IN         */ 00446000
*               /* CATALOG). SET SOME FIELDS IN PARM BLK FOR 08 ENTRY*/ 00447000
*               /* TO DAIR.                                          */ 00448000
*               /*                                                   */ 00449000
*               /*****************************************************/ 00450000
*                                                                  0134 00451000
*               DO;                                                0134 00452000
*                 IF DA04CAT=YES|DA04DSE=YES THEN/* DS FOUND IN CATLG   00453000
*                                      OR IS ALLOCATED               */ 00454000
         TM    DA04CAT(DAIRPTR),B'00000110'                        0135 00455000
         BZ    @RF00135                                            0135 00456000
*                   DO;             /* SET UP FOR ENTRY CODE 08      */ 00457000
*                     DA08OLD=YES;  /* SET STATUS TO OLD             */ 00458000
         OI    DA08OLD(DAIRPTR),B'00000001'                        0137 00459000
*                     DA08KEEP=YES; /* NORMAL UNALLOC - KEEP         */ 00460000
         OI    DA08KEEP(DAIRPTR),B'00001000'                       0138 00461000
*                     DA08KEP=YES;  /* IF ABEND UNALLOC - KEEP       */ 00462000
         OI    DA08KEP(DAIRPTR),B'00001000'                        0139 00463000
*                   END;                                           0140 00464000
*                 IF DA04DSE=YES THEN/* DSN ALLOCATED                */ 00465000
*                                                                  0141 00466000
@RF00135 TM    DA04DSE(DAIRPTR),B'00000010'                        0141 00467000
         BNO   @RF00141                                            0141 00468000
*                   /*************************************************/ 00469000
*                   /*                                               */ 00470000
*                   /* DATASET IS ALREADY ALLOCATED CHECK FOR AN     */ 00471000
*                   /* ACCEPTABLE DSORG (PO/PS). IF DSORG IS PO,     */ 00472000
*                   /* CHECK FOR MEMBER NAME. NOTE: THESE FLAGS SET  */ 00473000
*                   /* ONLY IF DS IS ALLOCATED, NOT IF FOUND IN      */ 00474000
*                   /* CATALOG.                                      */ 00475000
*                   /*                                               */ 00476000
*                   /*************************************************/ 00477000
*                                                                  0142 00478000
*                   DO;                                            0142 00479000
*                                                                  0142 00480000
*                     /***********************************************/ 00481000
*                     /*                                             */ 00482000
*                     /* CHECK FOR AN ACCEPTABLE DSORG               */ 00483000
*                     /*                                             */ 00484000
*                     /***********************************************/ 00485000
*                                                                  0143 00486000
*                     IF DA04DSO^=PO&DA04DSO^=PS THEN/* DSORG NOT PO    00487000
*                                      OR PS                         */ 00488000
         CLI   DA04DSO(DAIRPTR),X'02'                              0143 00489000
         BE    @RF00143                                            0143 00490000
         CLI   DA04DSO(DAIRPTR),X'40'                              0143 00491000
         BE    @RF00143                                            0143 00492000
*                       DO;                                        0144 00493000
*                         SWITCHES=SWITCHES&&SWITCHES;/* HALT FURTHER   00494000
*                                      DAIR PROCESSING               */ 00495000
         XC    SWITCHES(1),SWITCHES                                0145 00496000
*                         OUTMSGID=126;/* DSORG NOT SUPPORTED MSG    */ 00497000
         MVI   OUTMSGID(OCMTBPTR),X'7E'                            0146 00498000
*                         CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER */ 00499000
         ST    OCMTBPTR,@AL00001                                   0147 00500000
         L     @15,@CV00338                                        0147 00501000
         LA    @01,@AL00001                                        0147 00502000
         BALR  @14,@15                                             0147 00503000
*                         IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS &     00504000
*                                      INPUT FROM TERM               */ 00505000
         TM    ERROR(OCMTBPTR),B'00001000'                         0148 00506000
         BNZ   @RF00148                                            0148 00507000
         TM    NONTERM(OCMTBPTR),B'00100000'                       0148 00508000
         BNZ   @RF00148                                            0148 00509000
*                           NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME   0149 00510000
*                                      ERROR INDICATOR, BUT GIVE USER   00511000
*                                      ANOTHER CHANCE IF SUBCMD MODE */ 00512000
         L     @14,STRCTNUM(,OCMTBPTR)                             0149 00513000
         MH    @14,@CH00300                                        0149 00514000
         ALR   @14,OCMTBPTR                                        0149 00515000
         OI    NOMEMNAM-20(@14),B'00000010'                        0149 00516000
*                         ELSE      /* ERROR OR INPUT FROM CLIST     */ 00517000
*                           DO;                                    0150 00518000
         B     @RC00148                                            0150 00519000
@RF00148 DS    0H                                                  0151 00520000
*                             ERROR=YES;/* INDICATE SERIOUS ERROR    */ 00521000
         OI    ERROR(OCMTBPTR),B'00001000'                         0151 00522000
*                             OUTRTCD=ERRCDE;/* TERMINATION RETURN 0152 00523000
*                                      CODE                          */ 00524000
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0152 00525000
*                           END;                                   0153 00526000
*                       END;                                       0154 00527000
*                     ELSE          /* DSORG ACCEPTABLE, CK MEMBER 0155 00528000
*                                      NAME                          */ 00529000
*                                                                  0155 00530000
*                       /*********************************************/ 00531000
*                       /*                                           */ 00532000
*                       /* CHECK IF MEMBER NAME PRESENT FOR PO       */ 00533000
*                       /* DATASET                                   */ 00534000
*                       /*                                           */ 00535000
*                       /*********************************************/ 00536000
*                                                                  0155 00537000
*                       IF DA04DSO=PO&DSNFLG2^=DSM THEN/* PARTITIONED   00538000
*                                      DS W/ NO MEMBER NAME IN PDE   */ 00539000
         B     @RC00143                                            0155 00540000
@RF00143 CLI   DA04DSO(DAIRPTR),X'02'                              0155 00541000
         BNE   @RF00155                                            0155 00542000
         CLI   DSNFLG2(PDEBASE),128                                0155 00543000
         BE    @RF00155                                            0155 00544000
*                         DO;                                      0156 00545000
*                           OUTMSGID=107;/* MSG THAT TEMPNAME      0157 00546000
*                                      DEFAULTS                      */ 00547000
         MVI   OUTMSGID(OCMTBPTR),X'6B'                            0157 00548000
*                           CALL IKJCT467(OUTCOMTB);/* CALL MSG    0158 00549000
*                                      WRITER                        */ 00550000
         ST    OCMTBPTR,@AL00001                                   0158 00551000
         L     @15,@CV00338                                        0158 00552000
         LA    @01,@AL00001                                        0158 00553000
         BALR  @14,@15                                             0158 00554000
*                           DSNFLG2=DSNFLG2|DSM;/* SET PDE FLAG FOR     00555000
*                                      MEMBER NAME                   */ 00556000
         LA    @14,128                                             0159 00557000
         MVC   @ZT00003+3(1),DSNFLG2(PDEBASE)                      0159 00558000
         O     @14,@ZT00003                                        0159 00559000
         STC   @14,DSNFLG2(,PDEBASE)                               0159 00560000
*                           DSNLTH2=8;/* LENGTH OF MEMBER NAME       */ 00561000
         MVC   DSNLTH2(2,PDEBASE),@CH00045                         0160 00562000
*                           DSNMEMAD=ADDR(OUTEMPMN);/* PDE POINTS TO    00563000
*                                      MEMBERNAME                    */ 00564000
         LA    @14,OUTEMPMN(,OCMTBPTR)                             0161 00565000
         ST    @14,DSNMEMAD(,PDEBASE)                              0161 00566000
*                           MEMNAME=DEFAULT;/* DEFAULT MEMBERNAME    */ 00567000
         MVC   MEMNAME(8,@14),@CC00335                             0162 00568000
*                         END;                                     0163 00569000
*                   END;            /* END DSORG CHECK FOR ALLOCATED    00570000
*                                      DS                            */ 00571000
*               END;                /* END OF PROCESSING FOR OLD DS     00572000
*                                                                    */ 00573000
*                                                                  0166 00574000
*             /*******************************************************/ 00575000
*             /*                                                     */ 00576000
*             /* DATASET IS NOT OLD, CHECK DAIR RETURN CODE FURTHER  */ 00577000
*             /*                                                     */ 00578000
*             /*******************************************************/ 00579000
*                                                                  0166 00580000
*             ELSE                  /* CHECK DAIR RC FURTHER         */ 00581000
*               IF OUTRTCD=8&DA08CTRC=NOTINCAT THEN/* RTCD OF 8    0166 00582000
*                                      INDICATES ERROR CATLG MNGMT 0166 00583000
*                                      AND CTRC=8 INDICATES DS NOT 0166 00584000
*                                      FOUND IN CATLG                */ 00585000
*                                                                  0166 00586000
         B     @RC00133                                            0166 00587000
@RF00133 CLC   OUTRTCD(2,OCMTBPTR),@CH00045                        0166 00588000
         BNE   @RF00166                                            0166 00589000
         CLC   DA08CTRC(2,DAIRPTR),@CH00316                        0166 00590000
         BNE   @RF00166                                            0166 00591000
*                 /***************************************************/ 00592000
*                 /*                                                 */ 00593000
*                 /* DATASET IS NEW. PREPARE PARM BLK FOR 08 DAIR    */ 00594000
*                 /* ENTRY                                           */ 00595000
*                 /*                                                 */ 00596000
*                 /***************************************************/ 00597000
*                                                                  0167 00598000
*                 DO;                                              0167 00599000
*                   OUTRTCD=ZERO;   /* CLEAR RETURN CODE AREA        */ 00600000
         SLR   @14,@14                                             0168 00601000
         STH   @14,OUTRTCD(,OCMTBPTR)                              0168 00602000
*                   DA08NEW=YES;    /* SET STATUS NEW                */ 00603000
         OI    DA08NEW(DAIRPTR),B'00000100'                        0169 00604000
*                   DA08ABKL=YES;   /* REQUEST SPACE IN BLOCKS       */ 00605000
*                   DA08RLSE=YES;   /* AND RELEASE ANY NOT USED      */ 00606000
         OI    DA08ABKL(DAIRPTR),B'01010000'                       0171 00607000
*                   DA08PQTY=PRIMSPCE;/* DEFAULT PRIMARY SPACE     0172 00608000
*                                      REQUEST                       */ 00609000
         MVC   DA08PQTY(4,DAIRPTR),@CF00300                        0172 00610000
*                   DA08SQTY=SECSPCE;/* DEFAULT SECONDARY SPACE    0173 00611000
*                                      REQUEST                       */ 00612000
         MVC   DA08SQTY(4,DAIRPTR),@CF00300                        0173 00613000
*                   DA08BLK=BLOCKSZ;/* SET DEFAULT BLOCKSIZE FOR   0174 00614000
*                                      SPACE REQUEST                 */ 00615000
         MVC   DA08BLK(4,DAIRPTR),@CF00304                         0174 00616000
*                   DA08CAT=YES;    /* SET DISP TO CATALOG           */ 00617000
         OI    DA08CAT(DAIRPTR),B'00000010'                        0175 00618000
*                   IF DSNLTH2>ZERO THEN/* IF MEMBER NAME PRESENT    */ 00619000
         CH    @14,DSNLTH2(,PDEBASE)                               0176 00620000
         BNL   @RF00176                                            0176 00621000
*                     DA08DQTY=DIRSPCE;/* ALLOCATE ONE DIRECTORY   0177 00622000
*                                      BLOCK                         */ 00623000
         MVC   DA08DQTY(4,DAIRPTR),@CF00033                        0177 00624000
*                   DA08CATL=YES;   /* ABEND DISPOSITION IS CATLG    */ 00625000
@RF00176 OI    DA08CATL(DAIRPTR),B'00000010'                       0178 00626000
*                   NEWDS(STRCTNUM)=YES;/* INDICATE NEW DATASET FOR     00627000
*                                      DEFAULTS                      */ 00628000
         L     @14,STRCTNUM(,OCMTBPTR)                             0179 00629000
         MH    @14,@CH00300                                        0179 00630000
         ALR   @14,OCMTBPTR                                        0179 00631000
         OI    NEWDS-20(@14),B'00000100'                           0179 00632000
*                 END;              /* END OF NEW DATASET PROCESSING */ 00633000
*               ELSE                /* NONZERO RC FROM DAIR OTHER  0181 00634000
*                                      THAN 8                        */ 00635000
*                                                                  0181 00636000
*                 /***************************************************/ 00637000
*                 /*                                                 */ 00638000
*                 /* DAIR ERROR ON ENTRY 04                          */ 00639000
*                 /*                                                 */ 00640000
*                 /***************************************************/ 00641000
*                                                                  0181 00642000
*                 DO;                                              0181 00643000
         B     @RC00166                                            0181 00644000
@RF00166 DS    0H                                                  0182 00645000
*                   SWITCHES=SWITCHES&&SWITCHES;                   0182 00646000
         XC    SWITCHES(1),SWITCHES                                0182 00647000
*                   OUTMSGID=16;    /* DAIR ERROR MSG                */ 00648000
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0183 00649000
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER       */ 00650000
         ST    OCMTBPTR,@AL00001                                   0184 00651000
         L     @15,@CV00338                                        0184 00652000
         LA    @01,@AL00001                                        0184 00653000
         BALR  @14,@15                                             0184 00654000
*                   IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS & INPUT     00655000
*                                      FROM TERM                     */ 00656000
         TM    ERROR(OCMTBPTR),B'00001000'                         0185 00657000
         BNZ   @RF00185                                            0185 00658000
         TM    NONTERM(OCMTBPTR),B'00100000'                       0185 00659000
         BNZ   @RF00185                                            0185 00660000
*                     NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME ERROR   0186 00661000
*                                      INDICATOR, BUT GIVE USER    0186 00662000
*                                      ANOTHER CHANCE IF SUBCMD MODE */ 00663000
         L     @14,STRCTNUM(,OCMTBPTR)                             0186 00664000
         MH    @14,@CH00300                                        0186 00665000
         ALR   @14,OCMTBPTR                                        0186 00666000
         OI    NOMEMNAM-20(@14),B'00000010'                        0186 00667000
*                   ELSE            /* ERROR OR CLIST INPUT          */ 00668000
*                     DO;                                          0187 00669000
         B     @RC00185                                            0187 00670000
@RF00185 DS    0H                                                  0188 00671000
*                       ERROR=YES;  /* INDICATE SERIOUS ERROR        */ 00672000
         OI    ERROR(OCMTBPTR),B'00001000'                         0188 00673000
*                       OUTRTCD=ERRCDE;/* TERMINATION RETURN CODE    */ 00674000
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0189 00675000
*                     END;                                         0190 00676000
*                 END;                                             0191 00677000
@RC00185 DS    0H                                                  0192 00678000
*           END;                    /* END OF 04 SEARCH              */ 00679000
@RC00166 DS    0H                                                  0192 00680000
@RC00133 DS    0H                                                  0193 00681000
*       END;                        /* END OF ALL 04 PROCESSING    0193 00682000
*                                                                    */ 00683000
@RC00105 DS    0H                                                  0194 00684000
*                                                                  0194 00685000
*/****************************************************************** */ 00686000
*/*   ENTRY CODE 08                                                  */ 00687000
*/*        ALLOCATE THE DATASET                                      */ 00688000
*/****************************************************************** */ 00689000
*                                                                  0194 00690000
*     IF ENTRY08=YES THEN                                          0194 00691000
@RF00102 TM    ENTRY08,B'01000000'                                 0194 00692000
         BNO   @RF00194                                            0194 00693000
*       DO;                         /* ALLOCATE THE DATASET          */ 00694000
*         ENTRY08=OFF;                                             0196 00695000
         NI    ENTRY08,B'10111111'                                 0196 00696000
*         DA08CD=DA08;              /* FUNCTION CODE TO ALLOCATE     */ 00697000
         MVC   DA08CD(2,DAIRPTR),@CB00316                          0197 00698000
*         DA08FLG=ZERO;             /* ZERO FIELDS                   */ 00699000
         SLR   @14,@14                                             0198 00700000
         ST    @14,@TF00001                                        0198 00701000
         MVC   DA08FLG(2,DAIRPTR),@TF00001+2                       0198 00702000
*         DA08DARC=ZERO;            /* .....                         */ 00703000
         SLR   @14,@14                                             0199 00704000
         STH   @14,DA08DARC(,DAIRPTR)                              0199 00705000
*         DA08CTRC=ZERO;            /* .....                         */ 00706000
         STH   @14,DA08CTRC(,DAIRPTR)                              0200 00707000
*         DA08DDN='';               /* BLANK FIELDS                  */ 00708000
         MVI   DA08DDN(DAIRPTR),C' '                               0201 00709000
         MVC   DA08DDN+1(7,DAIRPTR),DA08DDN(DAIRPTR)               0201 00710000
*         DA08UNIT='';              /* .....                         */ 00711000
         MVI   DA08UNIT(DAIRPTR),C' '                              0202 00712000
         MVC   DA08UNIT+1(7,DAIRPTR),DA08UNIT(DAIRPTR)             0202 00713000
*         DA08SER='';               /* .....                         */ 00714000
         MVI   DA08SER(DAIRPTR),C' '                               0203 00715000
         MVC   DA08SER+1(7,DAIRPTR),DA08SER(DAIRPTR)               0203 00716000
*         DA08MNM='';               /* .....                         */ 00717000
         MVI   DA08MNM(DAIRPTR),C' '                               0204 00718000
         MVC   DA08MNM+1(7,DAIRPTR),DA08MNM(DAIRPTR)               0204 00719000
*         DA08PSWD='';              /* .....                         */ 00720000
         MVI   DA08PSWD(DAIRPTR),C' '                              0205 00721000
         MVC   DA08PSWD+1(7,DAIRPTR),DA08PSWD(DAIRPTR)             0205 00722000
*         IF DSNLTH3>ZERO THEN      /* PASSWORD PRESENT              */ 00723000
         CH    @14,DSNLTH3(,PDEBASE)                               0206 00724000
         BNL   @RF00206                                            0206 00725000
*           DA08PSWD=PASSWORD;      /* MOVE INTO DAIR BLOCK          */ 00726000
         L     @14,DSNPASAD(,PDEBASE)                              0207 00727000
         MVC   DA08PSWD(8,DAIRPTR),PASSWORD(@14)                   0207 00728000
*         IF DSNFLG2=DSM THEN       /* MEMBER NAME SPECIFIED         */ 00729000
@RF00206 CLI   DSNFLG2(PDEBASE),128                                0208 00730000
         BNE   @RF00208                                            0208 00731000
*           DA08MNM(1:DSNLTH2)=MEMNAME;/* MOVE INTO MEMBER NAME FIELD*/ 00732000
         LH    @14,DSNLTH2(,PDEBASE)                               0209 00733000
         BCTR  @14,0                                               0209 00734000
         L     @10,DSNMEMAD(,PDEBASE)                              0209 00735000
         EX    @14,@SM00410                                        0209 00736000
*         DAPLDAPB=ADDR(DAIRAREA);  /* DAPL POINTS TO PARM BLK       */ 00737000
@RF00208 LA    @14,DAIRAREA                                        0210 00738000
         ST    @14,DAPLDAPB(,DAPLPTR)                              0210 00739000
*         REG1=DAPLPTR;             /* PARAMETER FOR IKJDAIR         */ 00740000
         LR    REG1,DAPLPTR                                        0211 00741000
*         GEN(LINK EP=IKJDAIR);     /* CALL DAIR ROUTINE             */ 00742000
         LINK EP=IKJDAIR                                                00743000
*         OUTRTCD=REG15;            /* SAVE RETURN CODE FROM DAIR    */ 00744000
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0213 00745000
*         IF OUTRTCD^=ZERO THEN     /* NON-ZERO INDICATES DAIR ERROR */ 00746000
*                                                                  0214 00747000
         LH    @14,OUTRTCD(,OCMTBPTR)                              0214 00748000
         LTR   @14,@14                                             0214 00749000
         BZ    @RF00214                                            0214 00750000
*           /*********************************************************/ 00751000
*           /*                                                       */ 00752000
*           /* DAIR ERROR ON ENTRY 08                                */ 00753000
*           /*                                                       */ 00754000
*           /*********************************************************/ 00755000
*                                                                  0215 00756000
*           DO;                                                    0215 00757000
*             OUTMSGID=16;          /* DAIR ERROR MSG                */ 00758000
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0216 00759000
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */ 00760000
         ST    OCMTBPTR,@AL00001                                   0217 00761000
         L     @15,@CV00338                                        0217 00762000
         LA    @01,@AL00001                                        0217 00763000
         BALR  @14,@15                                             0217 00764000
*             IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS & INPUT FROM 0218 00765000
*                                      TERM                          */ 00766000
         TM    ERROR(OCMTBPTR),B'00001000'                         0218 00767000
         BNZ   @RF00218                                            0218 00768000
         TM    NONTERM(OCMTBPTR),B'00100000'                       0218 00769000
         BNZ   @RF00218                                            0218 00770000
*               NOMEMNAM(STRCTNUM)=YES;/* SET INDICATOR THAT ALLOC 0219 00771000
*                                      FAILED, BUT GIVE USER ANOTHER    00772000
*                                      CHANCE IF IN SUBCMD MODE      */ 00773000
         L     @14,STRCTNUM(,OCMTBPTR)                             0219 00774000
         MH    @14,@CH00300                                        0219 00775000
         ALR   @14,OCMTBPTR                                        0219 00776000
         OI    NOMEMNAM-20(@14),B'00000010'                        0219 00777000
*             ELSE                  /* ERROR OR CLIST INPUT          */ 00778000
*               DO;                                                0220 00779000
         B     @RC00218                                            0220 00780000
@RF00218 DS    0H                                                  0221 00781000
*                 ERROR=YES;        /* INDICATE SERIOUS ERROR        */ 00782000
         OI    ERROR(OCMTBPTR),B'00001000'                         0221 00783000
*                 OUTRTCD=ERRCDE;   /* TERMINATION RETURN CODE       */ 00784000
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0222 00785000
*               END;                                               0223 00786000
*           END;                                                   0224 00787000
*         ELSE                      /* NO DAIR ERROR                 */ 00788000
*                                                                  0225 00789000
*           /*********************************************************/ 00790000
*           /*                                                       */ 00791000
*           /* DATASET ALLOCATED                                     */ 00792000
*           /*                                                       */ 00793000
*           /*********************************************************/ 00794000
*                                                                  0225 00795000
*           DO;                                                    0225 00796000
         B     @RC00214                                            0225 00797000
@RF00214 DS    0H                                                  0226 00798000
*             DSALLOC(STRCTNUM)=YES;/* INDICATE DATASET ALLOCATED    */ 00799000
         L     @14,STRCTNUM(,OCMTBPTR)                             0226 00800000
         MH    @14,@CH00300                                        0226 00801000
         ST    @14,@TF00001                                        0226 00802000
         ALR   @14,OCMTBPTR                                        0226 00803000
         OI    DSALLOC-20(@14),B'01000000'                         0226 00804000
*             PRINTDDN(STRCTNUM)=DA08DDN;/* PASS DDNAME FOR OPEN     */ 00805000
*                                                                  0227 00806000
         LR    @14,OCMTBPTR                                        0227 00807000
         AL    @14,@TF00001                                        0227 00808000
         MVC   PRINTDDN-20(8,@14),DA08DDN(DAIRPTR)                 0227 00809000
*             /*******************************************************/ 00810000
*             /*                                                     */ 00811000
*             /* CHECK FOR AN ACCEPTABLE DSORG - THIS CHECK CANNOT BE*/ 00812000
*             /* MADE AFTER DAIR ENTRY 04 UNLESS DS WAS ALLOCATED    */ 00813000
*             /*                                                     */ 00814000
*             /*******************************************************/ 00815000
*                                                                  0228 00816000
*             IF DA08DSO^=PO&DA08DSO^=PS THEN/* DATASET IS NOT     0228 00817000
*                                      PARTITIONED OR SEQUENTIAL     */ 00818000
         CLI   DA08DSO(DAIRPTR),X'02'                              0228 00819000
         BE    @RF00228                                            0228 00820000
         CLI   DA08DSO(DAIRPTR),X'40'                              0228 00821000
         BE    @RF00228                                            0228 00822000
*               DO;                                                0229 00823000
*                 OUTMSGID=126;     /* ISSUE IMPROPER DSORG MSG      */ 00824000
         MVI   OUTMSGID(OCMTBPTR),X'7E'                            0230 00825000
*                 CALL IKJCT467(OUTCOMTB);/* ISSUE MSG               */ 00826000
         ST    OCMTBPTR,@AL00001                                   0231 00827000
         L     @15,@CV00338                                        0231 00828000
         LA    @01,@AL00001                                        0231 00829000
         BALR  @14,@15                                             0231 00830000
*                 IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS & TERM   0232 00831000
*                                      INPUT                         */ 00832000
         TM    ERROR(OCMTBPTR),B'00001000'                         0232 00833000
         BNZ   @RF00232                                            0232 00834000
         TM    NONTERM(OCMTBPTR),B'00100000'                       0232 00835000
         BNZ   @RF00232                                            0232 00836000
*                   NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME ERROR     0233 00837000
*                                      INDICATOR, BUT GIVE USER    0233 00838000
*                                      ANOTHER CHANCE IF SUBCMD MODE */ 00839000
         L     @14,STRCTNUM(,OCMTBPTR)                             0233 00840000
         MH    @14,@CH00300                                        0233 00841000
         ALR   @14,OCMTBPTR                                        0233 00842000
         OI    NOMEMNAM-20(@14),B'00000010'                        0233 00843000
*                 ELSE              /* ERROR OR CLIST INPUT          */ 00844000
*                   ERROR=YES;      /* INDICATE ERROR                */ 00845000
         B     @RC00232                                            0234 00846000
@RF00232 OI    ERROR(OCMTBPTR),B'00001000'                         0234 00847000
*                 UNALCALL=YES;     /* INDICATE UNALLOCATION NEEDED  */ 00848000
@RC00232 OI    UNALCALL(OCMTBPTR),B'00100000'                      0235 00849000
*                 ENTRY18=YES;      /* RETURN TO BEGINNING TO UNALLOC*/ 00850000
         OI    ENTRY18,B'00100000'                                 0236 00851000
*               END;                                               0237 00852000
*                                                                  0237 00853000
*             /*******************************************************/ 00854000
*             /*                                                     */ 00855000
*             /* CHECK IF MEMBER NAME PRESENT FOR PO DATASET - THIS  */ 00856000
*             /* CHECK CANNOT BE MADE AFTER DAIR ENTRY 04, UNLESS DS */ 00857000
*             /* WAS ALLOCATED                                       */ 00858000
*             /*                                                     */ 00859000
*             /*******************************************************/ 00860000
*                                                                  0238 00861000
*             ELSE                                                 0238 00862000
*               DO;                                                0238 00863000
         B     @RC00228                                            0238 00864000
@RF00228 DS    0H                                                  0239 00865000
*                 IF DA08DSO=PO&DSNFLG2^=DSM THEN/* PARTITIONED WITH    00866000
*                                      NO MEMBER NAME SUPPLIED       */ 00867000
         CLI   DA08DSO(DAIRPTR),X'02'                              0239 00868000
         BNE   @RF00239                                            0239 00869000
         CLI   DSNFLG2(PDEBASE),128                                0239 00870000
         BE    @RF00239                                            0239 00871000
*                   DO;                                            0240 00872000
*                     OUTMSGID=107; /* MISSING MEMBER, DEFAULT USED  */ 00873000
         MVI   OUTMSGID(OCMTBPTR),X'6B'                            0241 00874000
*                     CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER     */ 00875000
         ST    OCMTBPTR,@AL00001                                   0242 00876000
         L     @15,@CV00338                                        0242 00877000
         LA    @01,@AL00001                                        0242 00878000
         BALR  @14,@15                                             0242 00879000
*                     DSNFLG2=DSNFLG2|DSM;/* SET PDE BIT FOR MEMBER  */ 00880000
         LA    @14,128                                             0243 00881000
         MVC   @ZT00003+3(1),DSNFLG2(PDEBASE)                      0243 00882000
         O     @14,@ZT00003                                        0243 00883000
         STC   @14,DSNFLG2(,PDEBASE)                               0243 00884000
*                     DSNLTH2=8;    /* LENGTH MEMBERNAME             */ 00885000
         MVC   DSNLTH2(2,PDEBASE),@CH00045                         0244 00886000
*                     DSNMEMAD=ADDR(OUTEMPMN);/* PDE POINTS TO     0245 00887000
*                                      MEMBERNAME                    */ 00888000
         LA    @14,OUTEMPMN(,OCMTBPTR)                             0245 00889000
         ST    @14,DSNMEMAD(,PDEBASE)                              0245 00890000
*                     MEMNAME=DEFAULT;/* DEFAULT MEMBERNAME          */ 00891000
         MVC   MEMNAME(8,@14),@CC00335                             0246 00892000
*                     ENTRY18=YES;                                 0247 00893000
*                     ENTRY08=YES;                                 0248 00894000
         OI    ENTRY18,B'01100000'                                 0248 00895000
*                   END;                                           0249 00896000
*               END;                                               0250 00897000
@RF00239 DS    0H                                                  0251 00898000
*           END;                    /* END OF DSORG/MEMBER NAME CHECK*/ 00899000
@RC00228 DS    0H                                                  0252 00900000
*       END;                        /* END OF 08 ALLOCATE PROCESSING */ 00901000
@RC00214 DS    0H                                                  0253 00902000
*   END;                            /* END DOWHILE TO PROCESS DAIR 0253 00903000
*                                      REQUESTS                    0253 00904000
*                                                                    */ 00905000
@RF00194 DS    0H                                                  0253 00906000
@DE00058 TM    ENTRY04,B'11110000'                                 0253 00907000
         BNZ   @DL00058                                            0253 00908000
*                                                                  0254 00909000
*/********************************************************************/ 00910000
*/*                     RETURN TO CALLER                             */ 00911000
*/********************************************************************/ 00912000
*                                                                  0254 00913000
*ENDRETRN:                                                         0254 00914000
*   RETURN CODE(OUTRTCD);           /* RETURN TO CALLER              */ 00915000
ENDRETRN LH    @10,OUTRTCD(,OCMTBPTR)                              0254 00916000
         L     @13,4(,@13)                                         0254 00917000
         L     @00,@SIZDATD                                        0254 00918000
         LR    @01,@11                                             0254 00919000
         FREEMAIN R,LV=(0),A=(1)                                        00920000
         LR    @15,@10                                             0254 00921000
         L     @14,12(,@13)                                        0254 00922000
         LM    @00,@12,20(@13)                                     0254 00923000
         BR    @14                                                 0254 00924000
*   END IKJCT473                                                   0255 00925000
*                                                                  0255 00926000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00927000
*/*%INCLUDE SYSLIB  (IKJOCMTB)                                       */ 00928000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 00929000
*/*%INCLUDE SYSLIB  (IKJDAPL )                                       */ 00930000
*/*%INCLUDE SYSLIB  (IKJDAP04)                                       */ 00931000
*/*%INCLUDE SYSLIB  (IKJDAP08)                                       */ 00932000
*/*%INCLUDE SYSLIB  (IKJDAP1C)                                       */ 00933000
*/*%INCLUDE SYSLIB  (IKJDAP18)                                       */ 00934000
*                                                                  0255 00935000
*       ;                                                          0255 00936000
@DATA    DS    0H                                                       00937000
@CH00045 DC    H'8'                                                     00938000
@CH00134 DC    H'12'                                                    00939000
@CH00382 DC    H'36'                                                    00940000
@CH00358 DC    H'44'                                                    00941000
@CH00316 DC    XL2'0008'                                                00942000
@SM00407 MVC   QUALDSNM(0),NAME(@07)                                    00943000
@SM00410 MVC   DA08MNM(0,DAIRPTR),MEMNAME(@10)                          00944000
@DATD    DSECT                                                          00945000
         DS    0F                                                       00946000
@SA00001 DS    18F                                                      00947000
@PC00001 DS    1F                                                       00948000
@AL00001 DS    1A                                                       00949000
@TF00001 DS    F                                                        00950000
@ZTEMPS  DS    0F                                                       00951000
@ZT00003 DC    F'0'                                                     00952000
@ZTEMPND EQU   *                                                        00953000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00954000
IKJCT473 CSECT                                                          00955000
         DS    0F                                                       00956000
@CF00033 DC    F'1'                                                     00957000
@CF00300 DC    F'20'                                                    00958000
@CH00300 EQU   @CF00300+2                                               00959000
@CF00304 DC    F'3156'                                                  00960000
@DATD    DSECT                                                          00961000
         DS    0D                                                       00962000
DAIRAREA DS    CL84                                                     00963000
DAPBAREA DS    CL40                                                     00964000
DAPLSTRG DS    CL20                                                     00965000
QUALNAME DS    CL46                                                     00966000
         ORG   QUALNAME                                                 00967000
QUALDSNL DS    FL2                                                      00968000
QUALDSNM DS    CL44                                                     00969000
         ORG   QUALNAME+46                                              00970000
SWITCHES DS    BL1                                                      00971000
         ORG   SWITCHES                                                 00972000
ENTRY04  DS    BL1                                                      00973000
ENTRY08  EQU   SWITCHES+0                                               00974000
ENTRY18  EQU   SWITCHES+0                                               00975000
ENTRY1C  EQU   SWITCHES+0                                               00976000
@NM00068 EQU   SWITCHES+0                                               00977000
         ORG   SWITCHES+1                                               00978000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00979000
@ENDDATD EQU   *                                                        00980000
IKJCT473 CSECT                                                          00981000
         DS    0F                                                       00982000
@SIZDATD DC    AL1(1)                                                   00983000
         DC    AL3(@ENDDATD-@DATD)                                      00984000
@CV00338 DC    V(IKJCT467)                                              00985000
         DS    0D                                                       00986000
@CC00333 DC    C'.OUTLIST'                                              00987000
@CC00335 DC    C'TEMPNAME'                                              00988000
@CB00314 DC    X'0004'                                                  00989000
@CB00316 DC    X'0008'                                                  00990000
@CB00318 DC    X'0018'                                                  00991000
@CB00320 DC    X'001C'                                                  00992000
PATCH73  DS    CL100                                                    00993000
         ORG   PATCH73                                                  00994000
PTCHINIT DC    20CL5'ZAP73'                                             00995000
         ORG   PATCH73+100                                              00996000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00997000
@01      EQU   01                                                       00998000
@02      EQU   02                                                       00999000
@03      EQU   03                                                       01000000
@04      EQU   04                                                       01001000
@05      EQU   05                                                       01002000
@06      EQU   06                                                       01003000
@07      EQU   07                                                       01004000
@08      EQU   08                                                       01005000
@09      EQU   09                                                       01006000
@10      EQU   10                                                       01007000
@11      EQU   11                                                       01008000
@12      EQU   12                                                       01009000
@13      EQU   13                                                       01010000
@14      EQU   14                                                       01011000
@15      EQU   15                                                       01012000
PDEBASE  EQU   @04                                                      01013000
DAPB1PTR EQU   @06                                                      01014000
DAIRPTR  EQU   @02                                                      01015000
DAPLPTR  EQU   @05                                                      01016000
OCMTBPTR EQU   @03                                                      01017000
REG1     EQU   @01                                                      01018000
REG15    EQU   @15                                                      01019000
OUTCOMTB EQU   0                                                        01020000
OUTCPPL  EQU   OUTCOMTB                                                 01021000
OUTMSGID EQU   OUTCOMTB+4                                               01022000
OUTFLAGS EQU   OUTCOMTB+5                                               01023000
OUTRTCD  EQU   OUTCOMTB+6                                               01024000
OUTATTN  EQU   OUTCOMTB+24                                              01025000
OUTEMPMN EQU   OUTCOMTB+32                                              01026000
STRCTNUM EQU   OUTCOMTB+96                                              01027000
O73PARM  EQU   OUTCOMTB+100                                             01028000
PRINTDDN EQU   O73PARM+4                                                01029000
@NM00002 EQU   O73PARM+16                                               01030000
DSALLOC  EQU   @NM00002+1                                               01031000
NEWDS    EQU   @NM00002+1                                               01032000
NOMEMNAM EQU   @NM00002+1                                               01033000
OUTKEYWD EQU   OUTCOMTB+146                                             01034000
OUTSW    EQU   OUTCOMTB+148                                             01035000
SUBCMODE EQU   OUTSW                                                    01036000
UNALCALL EQU   OUTSW                                                    01037000
ERROR    EQU   OUTSW                                                    01038000
NONTERM  EQU   OUTSW+1                                                  01039000
OUTIDSSW EQU   OUTCOMTB+150                                             01040000
TERM     EQU   OUTIDSSW                                                 01041000
OUTDAIR  EQU   OUTCOMTB+156                                             01042000
OUTXMSG  EQU   OUTCOMTB+164                                             01043000
OUTPLIST EQU   OUTCOMTB+260                                             01044000
OPRDSPDE EQU   OUTPLIST+4                                               01045000
OSVDSPDE EQU   OUTCOMTB+284                                             01046000
CPPL     EQU   0                                                        01047000
CPPLUPT  EQU   CPPL+4                                                   01048000
CPPLPSCB EQU   CPPL+8                                                   01049000
CPPLECT  EQU   CPPL+12                                                  01050000
DAPL     EQU   0                                                        01051000
DAPLUPT  EQU   DAPL                                                     01052000
DAPLECT  EQU   DAPL+4                                                   01053000
DAPLECB  EQU   DAPL+8                                                   01054000
DAPLPSCB EQU   DAPL+12                                                  01055000
DAPLDAPB EQU   DAPL+16                                                  01056000
DAPB04   EQU   0                                                        01057000
DA04CD   EQU   DAPB04                                                   01058000
DA04FLG  EQU   DAPB04+2                                                 01059000
DA04CAT  EQU   DA04FLG                                                  01060000
DA04DSE  EQU   DA04FLG                                                  01061000
DA04PDSN EQU   DAPB04+8                                                 01062000
DA04CTL  EQU   DAPB04+12                                                01063000
DA04DSO  EQU   DAPB04+15                                                01064000
DAPB08   EQU   0                                                        01065000
DA08CD   EQU   DAPB08                                                   01066000
DA08FLG  EQU   DAPB08+2                                                 01067000
DA08DARC EQU   DAPB08+4                                                 01068000
DA08CTRC EQU   DAPB08+6                                                 01069000
DA08DDN  EQU   DAPB08+12                                                01070000
DA08UNIT EQU   DAPB08+20                                                01071000
DA08SER  EQU   DAPB08+28                                                01072000
DA08BLK  EQU   DAPB08+36                                                01073000
DA08PQTY EQU   DAPB08+40                                                01074000
DA08SQTY EQU   DAPB08+44                                                01075000
DA08DQTY EQU   DAPB08+48                                                01076000
DA08MNM  EQU   DAPB08+52                                                01077000
DA08PSWD EQU   DAPB08+60                                                01078000
DA08DSP1 EQU   DAPB08+68                                                01079000
DA08NEW  EQU   DA08DSP1                                                 01080000
DA08OLD  EQU   DA08DSP1                                                 01081000
DA08DPS2 EQU   DAPB08+69                                                01082000
DA08KEEP EQU   DA08DPS2                                                 01083000
DA08CAT  EQU   DA08DPS2                                                 01084000
DA08DPS3 EQU   DAPB08+70                                                01085000
DA08KEP  EQU   DA08DPS3                                                 01086000
DA08CATL EQU   DA08DPS3                                                 01087000
DA08CTL  EQU   DAPB08+71                                                01088000
DA08ABKL EQU   DA08CTL                                                  01089000
DA08RLSE EQU   DA08CTL                                                  01090000
DA08DSO  EQU   DAPB08+75                                                01091000
DAPB1C   EQU   0                                                        01092000
DA1CCD   EQU   DAPB1C                                                   01093000
DA1CCTL  EQU   DAPB1C+7                                                 01094000
DA1CDDN  EQU   DAPB1C+8                                                 01095000
DAPB18   EQU   0                                                        01096000
DA18CD   EQU   DAPB18                                                   01097000
DA18FLG  EQU   DAPB18+2                                                 01098000
DA18PDSN EQU   DAPB18+8                                                 01099000
DA18DDN  EQU   DAPB18+12                                                01100000
DA18DPS2 EQU   DAPB18+30                                                01101000
DA18CTL  EQU   DAPB18+31                                                01102000
DA18JBNM EQU   DAPB18+32                                                01103000
DSNPDE   EQU   0                                                        01104000
DSNAMEAD EQU   DSNPDE                                                   01105000
DSNLTH1  EQU   DSNPDE+4                                                 01106000
DSNFLG1  EQU   DSNPDE+6                                                 01107000
DSNMEMAD EQU   DSNPDE+8                                                 01108000
DSNLTH2  EQU   DSNPDE+12                                                01109000
DSNFLG2  EQU   DSNPDE+14                                                01110000
DSNPASAD EQU   DSNPDE+16                                                01111000
DSNLTH3  EQU   DSNPDE+20                                                01112000
NAME     EQU   0                                                        01113000
MEMNAME  EQU   0                                                        01114000
PASSWORD EQU   0                                                        01115000
OUTP     EQU   0                                                        01116000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01117000
@NM00067 EQU   DSNPDE+23                                                01118000
DSNFLG3  EQU   DSNPDE+22                                                01119000
@NM00066 EQU   DSNPDE+15                                                01120000
@NM00065 EQU   DSNPDE+7                                                 01121000
@NM00064 EQU   DA18CTL                                                  01122000
@NM00063 EQU   DA18CTL                                                  01123000
@NM00062 EQU   DA18CTL                                                  01124000
@NM00061 EQU   DA18CTL                                                  01125000
DA18PERM EQU   DA18CTL                                                  01126000
DA18UID  EQU   DA18CTL                                                  01127000
@NM00060 EQU   DA18CTL                                                  01128000
@NM00059 EQU   DA18CTL                                                  01129000
DA18UCAT EQU   DA18DPS2                                                 01130000
DA18CAT  EQU   DA18DPS2                                                 01131000
DA18DEL  EQU   DA18DPS2                                                 01132000
DA18KEEP EQU   DA18DPS2                                                 01133000
@NM00058 EQU   DA18DPS2                                                 01134000
@NM00057 EQU   DA18DPS2                                                 01135000
@NM00056 EQU   DA18DPS2                                                 01136000
@NM00055 EQU   DA18DPS2                                                 01137000
DA18SCLS EQU   DAPB18+28                                                01138000
DA18MNM  EQU   DAPB18+20                                                01139000
DA18CTRC EQU   DAPB18+6                                                 01140000
DA18DARC EQU   DAPB18+4                                                 01141000
@NM00054 EQU   DA18FLG                                                  01142000
@NM00053 EQU   DA18FLG                                                  01143000
@NM00052 EQU   DA18FLG                                                  01144000
@NM00051 EQU   DA18FLG                                                  01145000
@NM00050 EQU   DA18FLG                                                  01146000
@NM00049 EQU   DA18FLG                                                  01147000
@NM00048 EQU   DA18FLG                                                  01148000
DA18FPE  EQU   DA18FLG                                                  01149000
DA1CALN  EQU   DAPB1C+16                                                01150000
@NM00047 EQU   DA1CCTL                                                  01151000
DA1CATRL EQU   DA1CCTL                                                  01152000
@NM00046 EQU   DA1CCTL                                                  01153000
DA1CPERM EQU   DA1CCTL                                                  01154000
@NM00045 EQU   DA1CCTL                                                  01155000
@NM00044 EQU   DAPB1C+6                                                 01156000
DA1CDARC EQU   DAPB1C+4                                                 01157000
DA1CFLG  EQU   DAPB1C+2                                                 01158000
DA08ALN  EQU   DAPB08+76                                                01159000
@NM00043 EQU   DAPB08+72                                                01160000
@NM00042 EQU   DA08CTL                                                  01161000
DA08ATRL EQU   DA08CTL                                                  01162000
DA08DMMY EQU   DA08CTL                                                  01163000
DA08PERM EQU   DA08CTL                                                  01164000
DA08UID  EQU   DA08CTL                                                  01165000
DA08TRKS EQU   DA08CTL                                                  01166000
DA08UNCT EQU   DA08DPS3                                                 01167000
DA08DELE EQU   DA08DPS3                                                 01168000
@NM00041 EQU   DA08DPS3                                                 01169000
@NM00040 EQU   DA08DPS3                                                 01170000
@NM00039 EQU   DA08DPS3                                                 01171000
@NM00038 EQU   DA08DPS3                                                 01172000
DA08UCAT EQU   DA08DPS2                                                 01173000
DA08DEL  EQU   DA08DPS2                                                 01174000
@NM00037 EQU   DA08DPS2                                                 01175000
@NM00036 EQU   DA08DPS2                                                 01176000
@NM00035 EQU   DA08DPS2                                                 01177000
@NM00034 EQU   DA08DPS2                                                 01178000
DA08MOD  EQU   DA08DSP1                                                 01179000
DA08SHR  EQU   DA08DSP1                                                 01180000
@NM00033 EQU   DA08DSP1                                                 01181000
@NM00032 EQU   DA08DSP1                                                 01182000
@NM00031 EQU   DA08DSP1                                                 01183000
@NM00030 EQU   DA08DSP1                                                 01184000
DA08PDSN EQU   DAPB08+8                                                 01185000
@NM00029 EQU   DA08FLG                                                  01186000
@NM00028 EQU   DA08FLG                                                  01187000
@NM00027 EQU   DA08FLG                                                  01188000
@NM00026 EQU   DA08FLG                                                  01189000
@NM00025 EQU   DA08FLG                                                  01190000
@NM00024 EQU   DA08FLG                                                  01191000
@NM00023 EQU   DA08FLG                                                  01192000
DA08FPE  EQU   DA08FLG                                                  01193000
@NM00022 EQU   DAPB04+13                                                01194000
@NM00021 EQU   DA04CTL                                                  01195000
@NM00020 EQU   DA04CTL                                                  01196000
@NM00019 EQU   DA04CTL                                                  01197000
@NM00018 EQU   DA04CTL                                                  01198000
@NM00017 EQU   DA04CTL                                                  01199000
DA04UID  EQU   DA04CTL                                                  01200000
@NM00016 EQU   DA04CTL                                                  01201000
@NM00015 EQU   DA04CTL                                                  01202000
DA04CTRC EQU   DAPB04+6                                                 01203000
@NM00014 EQU   DAPB04+4                                                 01204000
@NM00013 EQU   DA04FLG                                                  01205000
@NM00012 EQU   DA04FLG                                                  01206000
@NM00011 EQU   DA04FLG                                                  01207000
@NM00010 EQU   DA04FLG                                                  01208000
@NM00009 EQU   DA04FLG                                                  01209000
@NM00008 EQU   DA04FLG                                                  01210000
CPPLCBUF EQU   CPPL                                                     01211000
IOPLAREA EQU   OUTCOMTB+296                                             01212000
IOPLPTR  EQU   OUTCOMTB+292                                             01213000
EWAPTR   EQU   OUTCOMTB+288                                             01214000
OUTCLPDE EQU   OUTCOMTB+280                                             01215000
OUTJBPDE EQU   OUTCOMTB+276                                             01216000
ODESTPDE EQU   OUTPLIST+12                                              01217000
ONEWCPDE EQU   OUTPLIST+8                                               01218000
OUTCPDE1 EQU   OUTPLIST                                                 01219000
OSYSODDN EQU   OUTCOMTB+252                                             01220000
CLASBUFF EQU   OUTCOMTB+244                                             01221000
OUTWORK  EQU   OUTCOMTB+196                                             01222000
OUTSTAE  EQU   OUTCOMTB+188                                             01223000
OUTSBBUF EQU   OUTCOMTB+184                                             01224000
OUTSBPDL EQU   OUTCOMTB+180                                             01225000
OHELPECB EQU   OUTCOMTB+176                                             01226000
OUTTCBH  EQU   OUTCOMTB+172                                             01227000
OUTXRPLY EQU   OUTCOMTB+168                                             01228000
OUTSYNMS EQU   OUTXMSG                                                  01229000
OUTPDL   EQU   OUTCOMTB+160                                             01230000
OUTDARB  EQU   OUTCOMTB+152                                             01231000
@NM00007 EQU   OUTIDSSW                                                 01232000
INTRPMSG EQU   OUTIDSSW                                                 01233000
ALLOC    EQU   OUTIDSSW                                                 01234000
EODSW    EQU   OUTIDSSW                                                 01235000
@NM00006 EQU   OUTIDSSW                                                 01236000
@NM00005 EQU   OUTIDSSW                                                 01237000
POINT    EQU   OUTIDSSW                                                 01238000
ENDLIST  EQU   OUTSW+1                                                  01239000
WORKDONE EQU   OUTSW+1                                                  01240000
OPENED   EQU   OUTSW+1                                                  01241000
SYNADERR EQU   OUTSW+1                                                  01242000
HASPABND EQU   OUTSW                                                    01243000
NOWORK   EQU   OUTSW                                                    01244000
ENDKEEP  EQU   OUTSW                                                    01245000
ENDSW    EQU   OUTSW                                                    01246000
SUBSYS   EQU   OUTSW                                                    01247000
SUBNEXT  EQU   OUTKEYWD+1                                               01248000
SUBBEGN  EQU   OUTKEYWD+1                                               01249000
SUBHERE  EQU   OUTKEYWD+1                                               01250000
SUBCONT  EQU   OUTKEYWD+1                                               01251000
DEST     EQU   OUTKEYWD+1                                               01252000
KEEP     EQU   OUTKEYWD+1                                               01253000
NEWCLASS EQU   OUTKEYWD                                                 01254000
PRINT    EQU   OUTKEYWD                                                 01255000
DELETE   EQU   OUTKEYWD                                                 01256000
NEXT     EQU   OUTKEYWD                                                 01257000
BEGIN    EQU   OUTKEYWD                                                 01258000
HERE     EQU   OUTKEYWD                                                 01259000
HOLD     EQU   OUTKEYWD                                                 01260000
PAUSE    EQU   OUTKEYWD                                                 01261000
OUTRECL  EQU   OUTCOMTB+144                                             01262000
OUTRECA  EQU   OUTCOMTB+140                                             01263000
OUTBUFL  EQU   @NM00002+2                                               01264000
OUTRECUN EQU   @NM00002+1                                               01265000
NEEDFREE EQU   @NM00002+1                                               01266000
OUTRECV  EQU   @NM00002+1                                               01267000
DSOPEN   EQU   @NM00002+1                                               01268000
@NM00004 EQU   @NM00002+1                                               01269000
@NM00003 EQU   @NM00002                                                 01270000
OUTBUFA  EQU   O73PARM+12                                               01271000
OUTDCB   EQU   O73PARM                                                  01272000
OUTBKCNT EQU   OUTCOMTB+92                                              01273000
OUTBKAPX EQU   OUTCOMTB+84                                              01274000
OUTBKNEW EQU   OUTCOMTB+76                                              01275000
OUTHOLD  EQU   OUTCOMTB+68                                              01276000
OUTEMPSB EQU   OUTCOMTB+64                                              01277000
OUTACBL  EQU   OUTCOMTB+60                                              01278000
OUTACB   EQU   OUTCOMTB+56                                              01279000
OUTRPLL  EQU   OUTCOMTB+52                                              01280000
OUTRPL   EQU   OUTCOMTB+48                                              01281000
OUTSOBSO EQU   OUTCOMTB+44                                              01282000
OUTSOBH  EQU   OUTCOMTB+40                                              01283000
OUTEXTRA EQU   OUTCOMTB+28                                              01284000
POSTED   EQU   OUTATTN                                                  01285000
@NM00001 EQU   OUTATTN                                                  01286000
OUTCMDNM EQU   OUTCOMTB+16                                              01287000
OUTMACN  EQU   OUTCOMTB+8                                               01288000
KEY1     EQU   OUTFLAGS                                                 01289000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01290000
@RC00110 EQU   @RC00105                                                 01291000
@RF00141 EQU   @RC00133                                                 01292000
@RF00155 EQU   @RC00133                                                 01293000
@RC00143 EQU   @RC00133                                                 01294000
@RC00218 EQU   @RC00214                                                 01295000
@RC00148 EQU   @RC00143                                                 01296000
@ENDDATA EQU   *                                                        01297000
         END   IKJCT473                                                 01298000
