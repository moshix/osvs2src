         TITLE 'IKJEBECH - CHANGE SUBCOMMAND - EDIT CP                 *00001000
                        '                                               00002000
IKJEBECH CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEBECH  77.241'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @06,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@06                                    0001 00014000
*                                                                  0084 00015000
*   /*****************************************************************/ 00016000
*   /*                                                               */ 00017000
*   /* GENERATE ENTRY LINKAGE AND PROGRAM ADDRESSABILITY             */ 00018000
*   /*                                                               */ 00019000
*   /*****************************************************************/ 00020000
*                                                                  0085 00021000
*   COMMREG=PARMREG1;               /* GET ADDR OF IKJEBECA          */ 00022000
         LR    COMMREG,PARMREG1                                    0085 00023000
*   RESPECIFY                                                      0086 00024000
*    (GPR13P,                                                      0086 00025000
*     GPR15P) RSTD;                                                0086 00026000
*   GPR15P=CANXTSVA;                /* SAVE AREA FOR THIS MODULE     */ 00027000
         L     GPR15P,CANXTSVA(,COMMREG)                           0087 00028000
*   EVAL(GPR15P+4)->CASAVPTR=GPR13P;/* SET THIS SAVEAREA BKWD PTR    */ 00029000
         LA    @14,4                                               0088 00030000
         ALR   @14,GPR15P                                          0088 00031000
         ST    GPR13P,CASAVPTR(,@14)                               0088 00032000
*   EVAL(GPR13P+8)->CASAVPTR=GPR15P;/* SET CALLER FWD PTR            */ 00033000
         LA    @14,8                                               0089 00034000
         ALR   @14,GPR13P                                          0089 00035000
         ST    GPR15P,CASAVPTR(,@14)                               0089 00036000
*   GPR13P=GPR15P;                  /* NEW SAVEAREA ADDR             */ 00037000
         LR    GPR13P,GPR15P                                       0090 00038000
*   CANXTSVA=GPR13P+72;             /* UPDATE NEX-SAVE-AREA PTR      */ 00039000
         LA    @14,72                                              0091 00040000
         ALR   @14,GPR13P                                          0091 00041000
         ST    @14,CANXTSVA(,COMMREG)                              0091 00042000
*   RESPECIFY                                                      0092 00043000
*    (GPR13P,                                                      0092 00044000
*     GPR15P) UNRSTD;                                              0092 00045000
*   DATAREG=ADDR(CASCWKA);          /* SET BASE REG FOR WORK AREA    */ 00046000
         LA    DATAREG,CASCWKA(,COMMREG)                           0093 00047000
*   GEN( USING @DATD,DATAREG);      /* SET ADDRESSABILITY TO CASCWKA */ 00048000
          USING @DATD,DATAREG                                           00049000
*   RFY                                                            0095 00050000
*    (GPR02P,                                                      0095 00051000
*     GPR03P,                                                      0095 00052000
*     GPR04P,                                                      0095 00053000
*     GPR05P) RSTD;                 /*                       @ZA06238*/ 00054000
*   GPR02P=DATAREG;                 /* INIT SUBCMD WORK      @ZA06238*/ 00055000
         LR    GPR02P,DATAREG                                      0096 00056000
*   GPR03P=CASCWKAL;                /* AREA TO ZERO'S        @ZA06238*/ 00057000
         LA    GPR03P,672                                          0097 00058000
*   GPR04P=DATAREG;                 /* BY ISSUEING MVCL      @ZA06238*/ 00059000
         LR    GPR04P,DATAREG                                      0098 00060000
*   GPR05P=''B;                     /* INSN WITH SOURCE      @ZA06238*/ 00061000
         SLR   GPR05P,GPR05P                                       0099 00062000
*   MVCL(GPR02P,GPR04P);            /* LENGTH+FILL ='00'X    @ZA06238*/ 00063000
         MVCL  GPR02P,GPR04P                                       0100 00064000
*   RFY                                                            0101 00065000
*    (GPR02P,                                                      0101 00066000
*     GPR03P,                                                      0101 00067000
*     GPR04P,                                                      0101 00068000
*     GPR05P) UNRSTD;               /*                       @ZA06238*/ 00069000
*   CHRETCD=0;                      /* INIT SUBCOMMAND RETURN CODE   */ 00070000
         SLR   @08,@08                                             0102 00071000
         ST    @08,CHRETCD                                         0102 00072000
*   PROMPTSW='0'B;                  /* INITIALIZE PROMPTSW OFF       */ 00073000
         NI    PROMPTSW,B'01111111'                                0103 00074000
*   DCBPTR=CAPTCDCB;                /* INIT IKJEBEUT PTR TO DCB      */ 00075000
         MVC   DCBPTR(3),CAPTCDCB+1(COMMREG)                       0104 00076000
*   UTCODE='04'X;                   /* SET CODE TO READ 1ST LINE     */ 00077000
         MVI   UTCODE,X'04'                                        0105 00078000
*   KEYPTR=0;                       /* SET PTR TO KEY TO ZERO        */ 00079000
         ST    @08,KEYPTR                                          0106 00080000
*   AREAPTR=ADDR(KEYFLD);           /* AREA TO READ INTO             */ 00081000
         LA    @08,KEYFLD(,COMMREG)                                0107 00082000
         ST    @08,AREAPTR                                         0107 00083000
*   PLISTEND='1'B;                  /* SET END OF LIST MARKER        */ 00084000
         OI    PLISTEND,B'10000000'                                0108 00085000
*   CALL RDWRTRTN;                  /* READ RECORD                   */ 00086000
*                                                                  0109 00087000
         BAL   @14,RDWRTRTN                                        0109 00088000
*   /*****************************************************************/ 00089000
*   /*                                                               */ 00090000
*   /* CHECK IF IKJEBEUT OPERATION SUCCESSFUL                        */ 00091000
*   /*                                                               */ 00092000
*   /*****************************************************************/ 00093000
*                                                                  0110 00094000
*   IF RETCODE^=0&RETCODE^=4 THEN   /* TERMINATE                     */ 00095000
         LTR   RETCODE,RETCODE                                     0110 00096000
         BZ    @RF00110                                            0110 00097000
         CH    RETCODE,@CH00602                                    0110 00098000
         BNE   @RT00110                                            0110 00099000
*     GO TO CHGEXIT2;               /* BEGIN END PROCESSING          */ 00100000
*                                                                  0111 00101000
*   /*****************************************************************/ 00102000
*   /*                                                               */ 00103000
*   /* CHECK IF RECORD EXISTS - IS DATA SET EMPTY                    */ 00104000
*   /*                                                               */ 00105000
*   /*****************************************************************/ 00106000
*                                                                  0112 00107000
*   IF RETCODE=4 THEN               /* IF NO, NOTIFY USER -EMPTY DS  */ 00108000
@RF00110 CH    RETCODE,@CH00602                                    0112 00109000
         BNE   @RF00112                                            0112 00110000
*     DO;                           /* SEND DATA SET EMPTY MSG       */ 00111000
*       RELMSG1=1287;               /* MSG IKJ52501I                 */ 00112000
         MVC   RELMSG1(2),@CH01318                                 0114 00113000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERT           */ 00114000
         SLR   LEV2INS,LEV2INS                                     0115 00115000
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERT           */ 00116000
         SLR   LEV1INS,LEV1INS                                     0116 00117000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 00118000
         SLR   @12,@12                                             0117 00119000
         STH   @12,RELMSG2                                         0117 00120000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 00121000
         BAL   @14,SENDMSG                                         0118 00122000
*       GO TO CHNGEXIT;             /* RETURN TO CALLER              */ 00123000
         B     CHNGEXIT                                            0119 00124000
*     END;                                                         0120 00125000
*   PPLPTR=ADDR(CATMPLST);          /* INIT IKJPARS PTR TO PARMLST   */ 00126000
*                                                                  0121 00127000
@RF00112 LA    @12,CATMPLST(,COMMREG)                              0121 00128000
         ST    @12,PPLPTR                                          0121 00129000
*   /*****************************************************************/ 00130000
*   /*                                                               */ 00131000
*   /* CHECK IF ANY OPERANDS SPECIFIED                               */ 00132000
*   /*                                                               */ 00133000
*   /*****************************************************************/ 00134000
*                                                                  0122 00135000
*   IF CAOPERND='1'B THEN           /* IF YES, NO PROMPT YET         */ 00136000
         TM    CAOPERND(COMMREG),B'10000000'                       0122 00137000
         BO    @RT00122                                            0122 00138000
*     GO TO CHKOPRND;               /* GO TO PARSE OPERANDS          */ 00139000
*                                                                  0124 00140000
*   /*****************************************************************/ 00141000
*   /*                                                               */ 00142000
*   /* ------------------------------------------------------- THIS  */ 00143000
*   /* SECTION ASSURES THAT ENOUGH INFORMATION IS OBTAINED TO PROCESS*/ 00144000
*   /* A CHANGE REQUEST AND ROUTES THE LOGIC THROUGH EITHER THE CODE */ 00145000
*   /* HANDLING SPECIFIC KEY REQUESTS OR THAT HANDLING DIRECT OR     */ 00146000
*   /* DEFAULTED REFERENCES TO '*' -- PROCESSING IS TERMINATED IF    */ 00147000
*   /* REQUIRED OPERANDS ARE MISSING AND THE USER IS IN NOPROMPT MODE*/ 00148000
*   /* -------------------------------------------------------       */ 00149000
*   /*                                                               */ 00150000
*   /*****************************************************************/ 00151000
*                                                                  0124 00152000
*PROMPT:                                                           0124 00153000
*   UPTPTR=CAPTUPT;                 /* PTR TO USER PROFILE TABLE     */ 00154000
*                                                                  0124 00155000
PROMPT   L     UPTPTR,CAPTUPT(,COMMREG)                            0124 00156000
*   /*****************************************************************/ 00157000
*   /*                                                               */ 00158000
*   /* CHECK IF NO PROMPT USER                                       */ 00159000
*   /*                                                               */ 00160000
*   /*****************************************************************/ 00161000
*                                                                  0125 00162000
*   IF UPTNPRM='1'B|CAINPROC='1'B THEN/* IF YES, NOTIFY USER THAT  0125 00163000
*                                      REQUIRED OPERAND MISSING      */ 00164000
         TM    UPTNPRM(UPTPTR),B'01000000'                         0125 00165000
         BO    @RT00125                                            0125 00166000
         TM    CAINPROC(COMMREG),B'00000100'                       0125 00167000
         BNO   @RF00125                                            0125 00168000
@RT00125 DS    0H                                                  0126 00169000
*     DO;                           /* SEND OPERANDS MISSING MSG     */ 00170000
*       RELMSG1=1033;               /* MSG IKJ52559I                 */ 00171000
         MVC   RELMSG1(2),@CH01323                                 0127 00172000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 00173000
         SLR   LEV2INS,LEV2INS                                     0128 00174000
*       LEV1INS=0;                  /* PTR TO INSERTION              */ 00175000
         SLR   LEV1INS,LEV1INS                                     0129 00176000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 00177000
         SLR   @12,@12                                             0130 00178000
         STH   @12,RELMSG2                                         0130 00179000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 00180000
         BAL   @14,SENDMSG                                         0131 00181000
*       CHRETCD=8;                  /* INDICATE FLUSH NECESSARY      */ 00182000
         MVC   CHRETCD(4),@CF00058                                 0132 00183000
*       GO TO CHNGEXIT;             /* RETURN TO CALLER              */ 00184000
         B     CHNGEXIT                                            0133 00185000
*     END;                                                         0134 00186000
*REPROMPT:                                                         0135 00187000
*   PTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO PUTLINE PARMBLOCK */ 00188000
@RF00125 DS    0H                                                  0135 00189000
REPROMPT LA    @08,PTGTLIST                                        0135 00190000
         ST    @08,PTPBPTR                                         0135 00191000
*   PRMPTNO=1;                      /* ONE MESSAGE SEGMENT           */ 00192000
         MVC   PRMPTNO(4),@CF00060                                 0136 00193000
*   PRMPTPTR=ADDR(PRMPTMSG);        /* PTR TO MESSAGE TEXT           */ 00194000
         LA    @07,PRMPTMSG                                        0137 00195000
         ST    @07,PRMPTPTR                                        0137 00196000
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO OUT PARMBLOCK            */ 00197000
         XC    PTGTLIST(20),PTGTLIST                               0138 00198000
*   PARMREG1=IOPLPTR;               /* PTR TO IKJPUTL PARMLIST       */ 00199000
         L     @07,IOPLPTR                                         0139 00200000
         LR    PARMREG1,@07                                        0139 00201000
*   IOPLIOPB=PTPBPTR;               /* PUTLINE PARM BLOCK PTR        */ 00202000
*                                                                  0140 00203000
         ST    @08,IOPLIOPB(,@07)                                  0140 00204000
*   /*****************************************************************/ 00205000
*   /*                                                               */ 00206000
*   /* SEND 'ENTER COUNT OR STRING' MESSAGE                          */ 00207000
*   /*                                                               */ 00208000
*   /*****************************************************************/ 00209000
*                                                                  0141 00210000
*   GENERATE;                                                      0141 00211000
         PUTLINE ,OUTPUT=(PRMPTNO,TERM,SINGLE,INFOR),                  X00212000
               TERMPUT=(EDIT,WAIT,NOHOLD,NOBREAK),MF=(E,(1))            00213000
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */ 00214000
*                                                                  0142 00215000
         LR    RETCODE,RETCDREG                                    0142 00216000
*   /*****************************************************************/ 00217000
*   /*                                                               */ 00218000
*   /* CHECK FOR SUCCESSFUL RETURN FROM PUTLINE                      */ 00219000
*   /*                                                               */ 00220000
*   /*****************************************************************/ 00221000
*                                                                  0143 00222000
*   IF RETCODE^=0 THEN              /* IF NO, TERMINAL ERROR         */ 00223000
         LTR   RETCODE,RETCODE                                     0143 00224000
         BNZ   @RT00143                                            0143 00225000
*     GO TO PUTERR;                 /* PROCESS ERROR                 */ 00226000
*   GTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO GETLINE PARMBLOCK */ 00227000
         LA    @08,PTGTLIST                                        0145 00228000
         ST    @08,GTPBPTR                                         0145 00229000
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO PARMBLOCK                */ 00230000
         XC    PTGTLIST(20),PTGTLIST                               0146 00231000
*   PARMREG1=IOPLPTR;               /* IKJGETL PARMLIST PTR          */ 00232000
         L     @07,IOPLPTR                                         0147 00233000
         LR    PARMREG1,@07                                        0147 00234000
*   IOPLIOPB=GTPBPTR;               /* GETLINE PARM BLOCK PTR        */ 00235000
*                                                                  0148 00236000
         ST    @08,IOPLIOPB(,@07)                                  0148 00237000
*   /*****************************************************************/ 00238000
*   /*                                                               */ 00239000
*   /* RECOVER USER RESPONSE TO PROMPT                               */ 00240000
*   /*                                                               */ 00241000
*   /*****************************************************************/ 00242000
*                                                                  0149 00243000
*   GENERATE;                                                      0149 00244000
         GETLINE ,INPUT=(TERM,LOGICAL),TERMGET=(EDIT,WAIT),            X00245000
               MF=(E,(1))                                               00246000
*   RETCODE=RETCDREG;               /* SAVE IKJGETL RETURN CODE      */ 00247000
*                                                                  0150 00248000
         LR    RETCODE,RETCDREG                                    0150 00249000
*   /*****************************************************************/ 00250000
*   /*                                                               */ 00251000
*   /* CHECK FOR SUCCESSFUL RETURN FROM GETLINE                      */ 00252000
*   /*                                                               */ 00253000
*   /*****************************************************************/ 00254000
*                                                                  0151 00255000
*   IF RETCODE^=0 THEN              /* IF NO, TERMINAL ERROR         */ 00256000
         SLR   @08,@08                                             0151 00257000
         CR    RETCODE,@08                                         0151 00258000
         BNE   @RT00151                                            0151 00259000
*     GO TO GETERR;                 /* PROCESS ERROR                 */ 00260000
*   PROMPTSW='1'B;                  /* INDICATE GETLINE BUFFER HELD  */ 00261000
         OI    PROMPTSW,B'10000000'                                0153 00262000
*   PPLPCL=ADDR(IKJEBCH2);          /* INIT IKJPARS PARMLIST         */ 00263000
         L     @12,PPLPTR                                          0154 00264000
         L     @07,@CV00513                                        0154 00265000
         ST    @07,PPLPCL(,@12)                                    0154 00266000
*   PPLANS=ADDR(TABPTR2);           /* PTR TO PDL                    */ 00267000
         LA    @07,TABPTR2                                         0155 00268000
         ST    @07,PPLANS(,@12)                                    0155 00269000
*   PPLCBUF=GTPBIBUF;               /* PTR TO INPUT BUFFER           */ 00270000
         L     @07,GTPBPTR                                         0156 00271000
         MVC   PPLCBUF(4,@12),GTPBIBUF(@07)                        0156 00272000
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT        */ 00273000
*                                                                  0157 00274000
         ST    @08,PPLUWA(,@12)                                    0157 00275000
*   /*****************************************************************/ 00276000
*   /*                                                               */ 00277000
*   /* PARSE USER RESPONSE                                           */ 00278000
*   /*                                                               */ 00279000
*   /*****************************************************************/ 00280000
*                                                                  0158 00281000
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */ 00282000
*     RESPECIFY                                                    0159 00283000
*       GPR01P RSTD;                                               0159 00284000
*     GPR01P=ADDR(PPL);                                            0160 00285000
         LR    GPR01P,@12                                          0160 00286000
*     IF CVTPARS=0 THEN                                            0161 00287000
         L     @12,CVTPTR                                          0161 00288000
         C     @08,CVTPARS(,@12)                                   0161 00289000
         BNE   @RF00161                                            0161 00290000
*       GEN(LINK EP=IKJPARS);                                      0162 00291000
         LINK EP=IKJPARS                                                00292000
*     ELSE                                                         0163 00293000
*       CALL CVTPARS;                                              0163 00294000
         B     @RC00161                                            0163 00295000
@RF00161 L     @12,CVTPTR                                          0163 00296000
         L     @15,CVTPARS(,@12)                                   0163 00297000
         BALR  @14,@15                                             0163 00298000
*     RESPECIFY                                                    0164 00299000
*       GPR01P UNRSTD;                                             0164 00300000
@RC00161 DS    0H                                                  0165 00301000
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/ 00302000
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */ 00303000
*                                                                  0166 00304000
         LR    RETCODE,RETCDREG                                    0166 00305000
*   /*****************************************************************/ 00306000
*   /*                                                               */ 00307000
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM PARSE                   */ 00308000
*   /*                                                               */ 00309000
*   /*****************************************************************/ 00310000
*                                                                  0167 00311000
*   IF RETCODE^=0 THEN              /* IF YES, ERROR CONDITION       */ 00312000
         LTR   RETCODE,RETCODE                                     0167 00313000
         BNZ   @RT00167                                            0167 00314000
*     GO TO PARSERR;                /* PROCESS ERROR                 */ 00315000
*   TABPTR1=TABPTR2-8-8;            /* OVERLAY DSECT                 */ 00316000
*                                                                  0169 00317000
         L     @12,TABPTR2                                         0169 00318000
         SH    @12,@CH00236                                        0169 00319000
         ST    @12,TABPTR1                                         0169 00320000
*   /*****************************************************************/ 00321000
*   /*                                                               */ 00322000
*   /* CHECK FOR SUCCESSFUL RETURN FROM PARSE                        */ 00323000
*   /*                                                               */ 00324000
*   /*****************************************************************/ 00325000
*                                                                  0170 00326000
*   IF LNCNTF='1'B|STR1F='1'B THEN  /* IF YES, CONTINUE PROCESSING   */ 00327000
         TM    LNCNTF(@12),B'10000000'                             0170 00328000
         BO    @RT00170                                            0170 00329000
         TM    STR1F(@12),B'10000000'                              0170 00330000
         BNO   @RF00170                                            0170 00331000
@RT00170 DS    0H                                                  0171 00332000
*     DO;                           /* PREPARE TO READ CURRENT LINE  */ 00333000
*       FIRSTCHG='1'B;              /* INDICATE PDL HELD             */ 00334000
         OI    FIRSTCHG,B'01000000'                                0172 00335000
*       GO TO NOCOUNT;              /* BRANCH TO READ '*' LINE       */ 00336000
         B     NOCOUNT                                             0173 00337000
*     END;                                                         0174 00338000
*   FREEAREA=GTPBIBUF;              /* PTR TO INPUT BUFFER           */ 00339000
@RF00170 L     @12,GTPBPTR                                         0175 00340000
         L     @12,GTPBIBUF(,@12)                                  0175 00341000
         ST    @12,FREEAREA                                        0175 00342000
*   FREELEN=BFRLEN;                 /* LENGTH OF BUFFER              */ 00343000
         LH    @12,BFRLEN(,@12)                                    0176 00344000
         ST    @12,FREELEN                                         0176 00345000
*   BINRYREG=ADDR(FREEAREA);        /* PTR TO AREA INFO              */ 00346000
         LA    BINRYREG,FREEAREA                                   0177 00347000
*   FREELIST=FREELIST&&FREELIST;    /* ZERO OUT LIST FORM            */ 00348000
         XC    FREELIST(12),FREELIST                               0178 00349000
*   PARMREG1=ADDR(FREELIST);        /* PTR TO LIST FORM              */ 00350000
*                                                                  0179 00351000
         LA    PARMREG1,FREELIST                                   0179 00352000
*   /*****************************************************************/ 00353000
*   /*                                                               */ 00354000
*   /* FREEMAIN INPUT BUFFER                                         */ 00355000
*   /*                                                               */ 00356000
*   /*****************************************************************/ 00357000
*                                                                  0180 00358000
*   GENERATE REFS(BINRYREG);                                       0180 00359000
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))                        00360000
*   PROMPTSW='0'B;                  /* INDICATE NO GETLINE BUFFER    */ 00361000
         NI    PROMPTSW,B'01111111'                                0181 00362000
*   PARMREG1=TABPTR2;               /* IKJPARS PDL POINTER           */ 00363000
         L     PARMREG1,TABPTR2                                    0182 00364000
*   GEN(IKJRLSA (1));               /* RELEASE IKJPARS PDL           */ 00365000
         IKJRLSA (1)                                                    00366000
*   GO TO REPROMPT;                 /* REPROMPT USER FOR COUNT       */ 00367000
         B     REPROMPT                                            0184 00368000
*CHKOPRND:                                                         0185 00369000
*   PPLPCL=ADDR(IKJEBCH1);          /* PTR TO MAIN PCL               */ 00370000
CHKOPRND L     @12,PPLPTR                                          0185 00371000
         L     @08,@CV00512                                        0185 00372000
         ST    @08,PPLPCL(,@12)                                    0185 00373000
*   PPLANS=ADDR(TABPTR1);           /* PTR TO ANSWER PLACE           */ 00374000
         LA    @08,TABPTR1                                         0186 00375000
         ST    @08,PPLANS(,@12)                                    0186 00376000
*   PPLCBUF=CAPTIBFR;               /* PTR TO INPUT BUFFER           */ 00377000
         MVC   PPLCBUF(4,@12),CAPTIBFR(COMMREG)                    0187 00378000
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT        */ 00379000
*                                                                  0188 00380000
         SLR   @08,@08                                             0188 00381000
         ST    @08,PPLUWA(,@12)                                    0188 00382000
*   /*****************************************************************/ 00383000
*   /*                                                               */ 00384000
*   /* PARSE OPERANDS                                                */ 00385000
*   /*                                                               */ 00386000
*   /*****************************************************************/ 00387000
*                                                                  0189 00388000
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */ 00389000
*     RESPECIFY                                                    0190 00390000
*       GPR01P RSTD;                                               0190 00391000
*     GPR01P=ADDR(PPL);                                            0191 00392000
         LR    GPR01P,@12                                          0191 00393000
*     IF CVTPARS=0 THEN                                            0192 00394000
         L     @12,CVTPTR                                          0192 00395000
         C     @08,CVTPARS(,@12)                                   0192 00396000
         BNE   @RF00192                                            0192 00397000
*       GEN(LINK EP=IKJPARS);                                      0193 00398000
         LINK EP=IKJPARS                                                00399000
*     ELSE                                                         0194 00400000
*       CALL CVTPARS;                                              0194 00401000
         B     @RC00192                                            0194 00402000
@RF00192 L     @12,CVTPTR                                          0194 00403000
         L     @15,CVTPARS(,@12)                                   0194 00404000
         BALR  @14,@15                                             0194 00405000
*     RESPECIFY                                                    0195 00406000
*       GPR01P UNRSTD;                                             0195 00407000
@RC00192 DS    0H                                                  0196 00408000
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/ 00409000
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */ 00410000
*                                                                  0197 00411000
         LR    RETCODE,RETCDREG                                    0197 00412000
*   /*****************************************************************/ 00413000
*   /*                                                               */ 00414000
*   /* CHECK FOR SUCCESSFUL RETURN FROM IKJPARS                      */ 00415000
*   /*                                                               */ 00416000
*   /*****************************************************************/ 00417000
*                                                                  0198 00418000
*   IF RETCODE^=0 THEN              /* IF NO, TERMINAL ERROR         */ 00419000
         LTR   RETCODE,RETCODE                                     0198 00420000
         BNZ   @RT00198                                            0198 00421000
*     GO TO PARSERR;                /* PROCESS ERROR                 */ 00422000
*   FIRSTCHG='1'B;                  /* INDICATE PDL HELD             */ 00423000
*                                                                  0200 00424000
         OI    FIRSTCHG,B'01000000'                                0200 00425000
*   /*****************************************************************/ 00426000
*   /*                                                               */ 00427000
*   /* CHECK IF ASTERISK SPECIFIED                                   */ 00428000
*   /*                                                               */ 00429000
*   /*****************************************************************/ 00430000
*                                                                  0201 00431000
*   IF LNSTART->LNUM(1)='*' THEN    /* IF YES, CONTINUE CHECK        */ 00432000
*                                                                  0201 00433000
         L     @12,TABPTR1                                         0201 00434000
         L     @08,LNSTART(,@12)                                   0201 00435000
         CLI   LNUM(@08),C'*'                                      0201 00436000
         BNE   @RF00201                                            0201 00437000
*     /***************************************************************/ 00438000
*     /*                                                             */ 00439000
*     /* CHECK IF NO OTHER OPERANDS SPECIFIED                        */ 00440000
*     /*                                                             */ 00441000
*     /***************************************************************/ 00442000
*                                                                  0202 00443000
*     IF LNENDF='0'B&LNCNTF='0'B&STR1F='0'B&STR2F='0'B THEN/* IF YES,   00444000
*                                      PROMPTING REQUIRED            */ 00445000
         TM    LNENDF(@12),B'10000000'                             0202 00446000
         BNZ   @RF00202                                            0202 00447000
         TM    LNCNTF(@12),B'10000000'                             0202 00448000
         BNZ   @RF00202                                            0202 00449000
         TM    STR1F(@12),B'10000000'                              0202 00450000
         BNZ   @RF00202                                            0202 00451000
         TM    STR2F(@12),B'10000000'                              0202 00452000
         BNZ   @RF00202                                            0202 00453000
*       DO;                         /* USER ENTERED ONLY ASTERISK    */ 00454000
*         PARMREG1=ADDR(TABPTR1);   /* PDL                           */ 00455000
         LA    PARMREG1,TABPTR1                                    0204 00456000
*         GEN(IKJRLSA (1));         /* FREE MAIN PDL                 */ 00457000
         IKJRLSA (1)                                                    00458000
*         FIRSTCHG='0'B;            /* NO PDL HELD                   */ 00459000
         NI    FIRSTCHG,B'10111111'                                0206 00460000
*         GO TO PROMPT;             /* PROMPT USER                   */ 00461000
         B     PROMPT                                              0207 00462000
*       END;                                                       0208 00463000
*     ELSE                          /* IF NO, PROCEED                */ 00464000
*       GO TO ASTSPEC;              /* '*' SPECIFIED                 */ 00465000
*                                                                  0209 00466000
*   /*****************************************************************/ 00467000
*   /*                                                               */ 00468000
*   /* CHECK IF NO OTHER OPERAND SPECIFIED                           */ 00469000
*   /*                                                               */ 00470000
*   /*****************************************************************/ 00471000
*                                                                  0210 00472000
*   IF LNENDF='0'B&STR1F='0'B THEN  /* IF YES, 1ST OPERAND COUNT     */ 00473000
@RF00201 L     @12,TABPTR1                                         0210 00474000
         TM    LNENDF(@12),B'10000000'                             0210 00475000
         BNZ   @RF00210                                            0210 00476000
         TM    STR1F(@12),B'10000000'                              0210 00477000
         BZ    @RT00210                                            0210 00478000
*     GO TO CNTONLY;                /* DEFAULT '*' ONLY              */ 00479000
*                                                                  0212 00480000
*   /*****************************************************************/ 00481000
*   /*                                                               */ 00482000
*   /* ------------------------------------------------------- THIS  */ 00483000
*   /* SECTION DETERMINES, IN THE CASE OF A KEY REFERENCE, THE NATURE*/ 00484000
*   /* AND VALUE OF THE FIRST TWO POSSIBLE OPERANDS, VALIDITY CHECKS */ 00485000
*   /* THE LINE RANGE, AND PROVIDES A DEFAULT LINE RANGE OF 1 --     */ 00486000
*   /* PROCESSING IS TERMINATED IF THE DATA SET IS NOT LINE-NUMBERED,*/ 00487000
*   /* OR IF AN INVALID RANGE IS SPECIFIED                           */ 00488000
*   /* ------------------------------------------------------- CHECK */ 00489000
*   /* IF LINE NUMBERED DATA SET                                     */ 00490000
*   /*                                                               */ 00491000
*   /*****************************************************************/ 00492000
*                                                                  0212 00493000
*   IF CANONUM='1'B THEN            /* IF NO, NOTIFY USER            */ 00494000
@RF00210 TM    CANONUM(COMMREG),B'00000001'                        0212 00495000
         BNO   @RF00212                                            0212 00496000
*     DO;                           /* SEND DATA SET NOT NUMBERED    */ 00497000
*       RELMSG1=1288;               /* MSG IKJ52502I                 */ 00498000
         MVC   RELMSG1(2),@CH01335                                 0214 00499000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 00500000
         SLR   LEV2INS,LEV2INS                                     0215 00501000
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERTION        */ 00502000
         SLR   LEV1INS,LEV1INS                                     0216 00503000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 00504000
         SLR   @12,@12                                             0217 00505000
         STH   @12,RELMSG2                                         0217 00506000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 00507000
         BAL   @14,SENDMSG                                         0218 00508000
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */ 00509000
         B     FLUSH                                               0219 00510000
*     END;                                                         0220 00511000
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */ 00512000
@RF00212 MVC   PACKAREA(8),@CC01337                                0221 00513000
*   PACKAREA(9-LNSTARTL:8)=LNSTART->LNUM;/* MOVE LINE NUMBER INTO  0222 00514000
*                                      AREA                          */ 00515000
         L     @12,TABPTR1                                         0222 00516000
         LA    @08,9                                               0222 00517000
         SH    @08,LNSTARTL(,@12)                                  0222 00518000
         LA    @07,PACKAREA-1(@08)                                 0222 00519000
         LCR   @08,@08                                             0222 00520000
         AL    @08,@CF00058                                        0222 00521000
         L     @12,LNSTART(,@12)                                   0222 00522000
         EX    @08,@SM01520                                        0222 00523000
*   CALL CONVERT;                   /* CONVERT TO BINARY             */ 00524000
         BAL   @14,CONVERT                                         0223 00525000
*   LNUM1=BINRYREG;                 /* SET STARTING KEY              */ 00526000
*                                                                  0224 00527000
         ST    BINRYREG,LNUM1                                      0224 00528000
*   /*****************************************************************/ 00529000
*   /*                                                               */ 00530000
*   /* CHECK IF SECOND OPERAND NOT SPECIFIED                         */ 00531000
*   /*                                                               */ 00532000
*   /*****************************************************************/ 00533000
*                                                                  0225 00534000
*   IF LNENDF='0'B THEN             /* IF YES, SKIP CONVERT          */ 00535000
         L     @12,TABPTR1                                         0225 00536000
         TM    LNENDF(@12),B'10000000'                             0225 00537000
         BZ    @RT00225                                            0225 00538000
*     GO TO NOSPAN;                 /* DEFAULT KEY RECORD ONLY       */ 00539000
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */ 00540000
         MVC   PACKAREA(8),@CC01337                                0227 00541000
*   PACKAREA(9-LNENDL:8)=LNEND->LNUM;/* MOVE LINE NUMBER INTO AREA   */ 00542000
         LA    @08,9                                               0228 00543000
         SH    @08,LNENDL(,@12)                                    0228 00544000
         LA    @07,PACKAREA-1(@08)                                 0228 00545000
         LCR   @08,@08                                             0228 00546000
         AL    @08,@CF00058                                        0228 00547000
         L     @12,LNEND(,@12)                                     0228 00548000
         EX    @08,@SM01520                                        0228 00549000
*   CALL CONVERT;                   /* CONVERT TO BINARY             */ 00550000
*                                                                  0229 00551000
         BAL   @14,CONVERT                                         0229 00552000
*   /*****************************************************************/ 00553000
*   /*                                                               */ 00554000
*   /* CHECK IF 3RD OR 4TH OPERANDS EXIST                            */ 00555000
*   /*                                                               */ 00556000
*   /*****************************************************************/ 00557000
*                                                                  0230 00558000
*   IF STR1F='1'B|LNCNTF='1'B THEN  /* 2ND OPERAND LAST KEY          */ 00559000
         L     @12,TABPTR1                                         0230 00560000
         TM    STR1F(@12),B'10000000'                              0230 00561000
         BO    @RT00230                                            0230 00562000
         TM    LNCNTF(@12),B'10000000'                             0230 00563000
         BNO   @RF00230                                            0230 00564000
@RT00230 DS    0H                                                  0231 00565000
*     DO;                           /* LINE NUMBER RANGE SPECIFIED   */ 00566000
*       LNUM2=BINRYREG;             /* SET LAST KEY                  */ 00567000
         ST    BINRYREG,LNUM2                                      0232 00568000
*       GO TO CHKSPAN;              /* PROCESS LINE SPAN             */ 00569000
         B     CHKSPAN                                             0233 00570000
*     END;                                                         0234 00571000
*   ELSE                            /* 2ND OPERAND CHARACTER COUNT   */ 00572000
*     DO;                           /* NO LINE RANGE SPECIFIED       */ 00573000
@RF00230 DS    0H                                                  0236 00574000
*       CHARCNT=BINRYREG;           /* SET CHARACTER COUNT           */ 00575000
         ST    BINRYREG,CHARCNT                                    0236 00576000
*       GO TO NOSPAN;               /* DEFAULT KEY LINE ONLY         */ 00577000
         B     NOSPAN                                              0237 00578000
*     END;                                                         0238 00579000
*CHKSPAN:                                                          0239 00580000
*   ;                               /* LINE RANGE VALIDITY CHECKING  */ 00581000
*                                                                  0239 00582000
CHKSPAN  DS    0H                                                  0240 00583000
*   /*****************************************************************/ 00584000
*   /*                                                               */ 00585000
*   /* CHECK IF 2ND LINE NUMBER LESS THAN 1ST                        */ 00586000
*   /*                                                               */ 00587000
*   /*****************************************************************/ 00588000
*                                                                  0240 00589000
*   IF LNUM2<LNUM1 THEN             /* IF YES, NOTIFY USER           */ 00590000
         L     @12,LNUM2                                           0240 00591000
         C     @12,LNUM1                                           0240 00592000
         BNL   @RF00240                                            0240 00593000
*     DO;                           /* SEND INVALID RANGE MSG        */ 00594000
*       RELMSG1=1289;               /* IKJ52503I                     */ 00595000
         MVC   RELMSG1(2),@CH01342                                 0242 00596000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 00597000
         SLR   LEV2INS,LEV2INS                                     0243 00598000
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERTION        */ 00599000
         SLR   LEV1INS,LEV1INS                                     0244 00600000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 00601000
         SLR   @12,@12                                             0245 00602000
         STH   @12,RELMSG2                                         0245 00603000
*       CALL SENDMSG;               /* SEND MESSAGE                  */ 00604000
         BAL   @14,SENDMSG                                         0246 00605000
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */ 00606000
         B     FLUSH                                               0247 00607000
*     END;                                                         0248 00608000
*   ELSE                            /* IF NO, CONTINUE PROCESSING    */ 00609000
*     GO TO READKEY;                /* READ KEY SPECIFIED            */ 00610000
*NOSPAN:                                                           0250 00611000
*   LNUM2=LNUM1;                    /* NO RANGE SPECIFIED            */ 00612000
NOSPAN   MVC   LNUM2(4),LNUM1                                      0250 00613000
*   LNCOUNT=1;                      /* DEFAULT LINE COUNT TO 1       */ 00614000
         MVC   LNCOUNT(4),@CF00060                                 0251 00615000
*READKEY:                                                          0252 00616000
*   SELNRNGE=ADDR(LNUM1);           /* INIT LINE RANGE FOR IKJEBESE  */ 00617000
READKEY  LA    @12,LNUM1                                           0252 00618000
         ST    @12,SELNRNGE                                        0252 00619000
*   KEYPTR=ADDR(LNUM1);             /* KEY REFERENCE                 */ 00620000
         ST    @12,KEYPTR                                          0253 00621000
*   GO TO READ;                     /* READ 'FIRST' RECORD           */ 00622000
         B     READ                                                0254 00623000
*                                                                  0255 00624000
*   /*****************************************************************/ 00625000
*   /*                                                               */ 00626000
*   /* ------------------------------------------------------- THIS  */ 00627000
*   /* SECTION DETERMINES, IN THE CASE OF A '*' REFERENCE, THE NATURE*/ 00628000
*   /* AND VALUE OF THE FIRST TWO POSSIBLE OPERANDS, AND PROVIDES A  */ 00629000
*   /* DEFAULT LINE COUNT OF 1 --IF AN INVALID LINE COUNT IS         */ 00630000
*   /* SPECIFIED, THE USER IS PROMPTED UNTIL HE ENTERS A LINE COUNT  */ 00631000
*   /* GREATER THAN 0                                                */ 00632000
*   /* -------------------------------------------------------       */ 00633000
*   /*                                                               */ 00634000
*   /*****************************************************************/ 00635000
*                                                                  0255 00636000
*ASTSPEC:                                                          0255 00637000
*   ;                               /* ASTERISK SPECIFIED OR DEFLTD  */ 00638000
*                                                                  0255 00639000
ASTSPEC  DS    0H                                                  0256 00640000
*   /*****************************************************************/ 00641000
*   /*                                                               */ 00642000
*   /* CHECK IF SECOND OPERAND SPECIFIED                             */ 00643000
*   /*                                                               */ 00644000
*   /*****************************************************************/ 00645000
*                                                                  0256 00646000
*   IF LNENDF='0'B THEN             /* IF NO, SKIP PROCESSING        */ 00647000
         L     @12,TABPTR1                                         0256 00648000
         TM    LNENDF(@12),B'10000000'                             0256 00649000
         BZ    @RT00256                                            0256 00650000
*     GO TO NOCOUNT;                /* '*' DEFAULTED                 */ 00651000
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */ 00652000
         MVC   PACKAREA(8),@CC01337                                0258 00653000
*   PACKAREA(9-LNENDL:8)=LNEND->LNUM;/* MOVE NUMBER INTO AREA        */ 00654000
         LA    @08,9                                               0259 00655000
         SH    @08,LNENDL(,@12)                                    0259 00656000
         LA    @07,PACKAREA-1(@08)                                 0259 00657000
         LCR   @08,@08                                             0259 00658000
         AL    @08,@CF00058                                        0259 00659000
         L     @12,LNEND(,@12)                                     0259 00660000
         EX    @08,@SM01520                                        0259 00661000
*   CALL CONVERT;                   /* CONVERT TO BINARY             */ 00662000
*                                                                  0260 00663000
         BAL   @14,CONVERT                                         0260 00664000
*   /*****************************************************************/ 00665000
*   /*                                                               */ 00666000
*   /* CHECK IF 3RD OR 4TH OPERANDS EXIST                            */ 00667000
*   /*                                                               */ 00668000
*   /*****************************************************************/ 00669000
*                                                                  0261 00670000
*   IF STR1F='1'B|LNCNTF='1'B THEN  /* 2ND OPERAND LINE COUNT        */ 00671000
         L     @12,TABPTR1                                         0261 00672000
         TM    STR1F(@12),B'10000000'                              0261 00673000
         BO    @RT00261                                            0261 00674000
         TM    LNCNTF(@12),B'10000000'                             0261 00675000
         BNO   @RF00261                                            0261 00676000
@RT00261 DS    0H                                                  0262 00677000
*     DO;                           /* LINE COUNT SPECIFIED          */ 00678000
*       LNCOUNT=BINRYREG;           /* SET LINE COUNT                */ 00679000
         ST    BINRYREG,LNCOUNT                                    0263 00680000
*       GO TO CHKLNCNT;             /* PROCESS COUNT                 */ 00681000
         B     CHKLNCNT                                            0264 00682000
*     END;                                                         0265 00683000
*   ELSE                            /* 2ND OPERAND CHARACTER COUNT   */ 00684000
*     DO;                           /* NO LINE COUNT SPECIFIED       */ 00685000
@RF00261 DS    0H                                                  0267 00686000
*       CHARCNT=BINRYREG;           /* SET CHARACTER COUNT           */ 00687000
         ST    BINRYREG,CHARCNT                                    0267 00688000
*       GO TO NOCOUNT;              /* DEFAULT '*' LINE ONLY         */ 00689000
         B     NOCOUNT                                             0268 00690000
*     END;                                                         0269 00691000
*CHKLNCNT:                                                         0270 00692000
*   ;                               /* LINE COUNT VALIDITY CHECKING  */ 00693000
*                                                                  0270 00694000
CHKLNCNT DS    0H                                                  0271 00695000
*   /*****************************************************************/ 00696000
*   /*                                                               */ 00697000
*   /* CHECK IF LINE COUNT IS GREATER THAN 0                         */ 00698000
*   /*                                                               */ 00699000
*   /*****************************************************************/ 00700000
*                                                                  0271 00701000
*   IF LNCOUNT>0 THEN               /* IF YES, DO NOT PROMPT         */ 00702000
         SLR   @12,@12                                             0271 00703000
         C     @12,LNCOUNT                                         0271 00704000
         BL    @RT00271                                            0271 00705000
*     GO TO READCUR;                /* READ CURRENT LINE             */ 00706000
*   PPLPCL=ADDR(IKJEBCH4);          /* INIT IKJPARS PARMLIST         */ 00707000
         L     @08,PPLPTR                                          0273 00708000
         L     @07,@CV00515                                        0273 00709000
         ST    @07,PPLPCL(,@08)                                    0273 00710000
*   PPLANS=ADDR(TABPTR3);           /* PTR TO PDL                    */ 00711000
         LA    @07,TABPTR3                                         0274 00712000
         ST    @07,PPLANS(,@08)                                    0274 00713000
*   PPLCBUF=ADDR(BLANKBFR);         /* PTR TO BLANK BUFFER           */ 00714000
         LA    @07,BLANKBFR(,COMMREG)                              0275 00715000
         ST    @07,PPLCBUF(,@08)                                   0275 00716000
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT USED   */ 00717000
         ST    @12,PPLUWA(,@08)                                    0276 00718000
*   BLANKOFF=0;                     /* OFFSET FOR SCANNING           */ 00719000
         STH   @12,BLANKOFF(,COMMREG)                              0277 00720000
*   BLANKTXT='';                    /* BLANK PROMPT BUFFER           */ 00721000
         MVI   BLANKTXT(COMMREG),C' '                              0278 00722000
         MVC   BLANKTXT+1(5,COMMREG),BLANKTXT(COMMREG)             0278 00723000
*   BLANKLEN=LENGTH(BLANKBFR);      /* LENGTH OF BUFFER              */ 00724000
*                                                                  0279 00725000
         MVC   BLANKLEN(2,COMMREG),@CH00541                        0279 00726000
*   /*****************************************************************/ 00727000
*   /*                                                               */ 00728000
*   /* PROMPT AND PARSE FOR VALID LINECOUNT                          */ 00729000
*   /*                                                               */ 00730000
*   /*****************************************************************/ 00731000
*                                                                  0280 00732000
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */ 00733000
*     RESPECIFY                                                    0281 00734000
*       GPR01P RSTD;                                               0281 00735000
*     GPR01P=ADDR(PPL);                                            0282 00736000
         LR    GPR01P,@08                                          0282 00737000
*     IF CVTPARS=0 THEN                                            0283 00738000
         L     @08,CVTPTR                                          0283 00739000
         C     @12,CVTPARS(,@08)                                   0283 00740000
         BNE   @RF00283                                            0283 00741000
*       GEN(LINK EP=IKJPARS);                                      0284 00742000
         LINK EP=IKJPARS                                                00743000
*     ELSE                                                         0285 00744000
*       CALL CVTPARS;                                              0285 00745000
         B     @RC00283                                            0285 00746000
@RF00283 L     @12,CVTPTR                                          0285 00747000
         L     @15,CVTPARS(,@12)                                   0285 00748000
         BALR  @14,@15                                             0285 00749000
*     RESPECIFY                                                    0286 00750000
*       GPR01P UNRSTD;                                             0286 00751000
@RC00283 DS    0H                                                  0287 00752000
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/ 00753000
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */ 00754000
*                                                                  0288 00755000
         LR    RETCODE,RETCDREG                                    0288 00756000
*   /*****************************************************************/ 00757000
*   /*                                                               */ 00758000
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM IKJPARS                 */ 00759000
*   /*                                                               */ 00760000
*   /*****************************************************************/ 00761000
*                                                                  0289 00762000
*   IF RETCODE^=0 THEN              /* IF NO, ERROR CONDITION        */ 00763000
         LTR   RETCODE,RETCODE                                     0289 00764000
         BNZ   @RT00289                                            0289 00765000
*     GO TO PARSERR;                /* PROCESS ERROR                 */ 00766000
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */ 00767000
         MVC   PACKAREA(8),@CC01337                                0291 00768000
*   PACKAREA(9-LNSTARTL:8)=LICNT->LNUM;/* MOVE COUNT INTO WORK AREA  */ 00769000
         LA    @12,9                                               0292 00770000
         L     @08,TABPTR1                                         0292 00771000
         SH    @12,LNSTARTL(,@08)                                  0292 00772000
         LA    @08,PACKAREA-1(@12)                                 0292 00773000
         LCR   @12,@12                                             0292 00774000
         AL    @12,@CF00058                                        0292 00775000
         L     @07,TABPTR3                                         0292 00776000
         L     @07,LICNT(,@07)                                     0292 00777000
         EX    @12,@SM01522                                        0292 00778000
*   CALL CONVERT;                   /* CONVERT TO BINARY             */ 00779000
         BAL   @14,CONVERT                                         0293 00780000
*   LNCOUNT=BINRYREG;               /* SAVE LINECOUNT                */ 00781000
         ST    BINRYREG,LNCOUNT                                    0294 00782000
*   PARMREG1=ADDR(TABPTR3);         /* PTR TO PROMPT PDL             */ 00783000
         LA    PARMREG1,TABPTR3                                    0295 00784000
*   GEN(IKJRLSA (1));               /* RELEASE PDL CORE              */ 00785000
         IKJRLSA (1)                                                    00786000
*   GO TO CHKLNCNT;                 /* CHECK LINECOUNT VALIDITY      */ 00787000
         B     CHKLNCNT                                            0297 00788000
*CNTONLY:                                                          0298 00789000
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */ 00790000
CNTONLY  MVC   PACKAREA(8),@CC01337                                0298 00791000
*   PACKAREA(9-LNSTARTL:8)=LNSTART->LNUM;/* MOVE NUMBER INTO AREA    */ 00792000
         L     @12,TABPTR1                                         0299 00793000
         LA    @08,9                                               0299 00794000
         SH    @08,LNSTARTL(,@12)                                  0299 00795000
         LA    @07,PACKAREA-1(@08)                                 0299 00796000
         LCR   @08,@08                                             0299 00797000
         AL    @08,@CF00058                                        0299 00798000
         L     @12,LNSTART(,@12)                                   0299 00799000
         EX    @08,@SM01520                                        0299 00800000
*   CALL CONVERT;                   /* CONVERT TO BINARY             */ 00801000
         BAL   @14,CONVERT                                         0300 00802000
*   CHARCNT=BINRYREG;               /* SET CHARACTER COUNT           */ 00803000
         ST    BINRYREG,CHARCNT                                    0301 00804000
*NOCOUNT:                                                          0302 00805000
*   LNCOUNT=1;                      /* SET LINE COUNT TO 1           */ 00806000
NOCOUNT  MVC   LNCOUNT(4),@CF00060                                 0302 00807000
*READCUR:                                                          0303 00808000
*   CURLN=-1;                       /* SET IKJEBESE CODE FOR '*'     */ 00809000
READCUR  SLR   @12,@12                                             0303 00810000
         BCTR  @12,0                                               0303 00811000
         ST    @12,CURLN                                           0303 00812000
*   SELNRNGE=ADDR(CURLN);           /* IKJEBESE PTR TO LINE RANGE    */ 00813000
         LA    @08,CURLN                                           0304 00814000
         ST    @08,SELNRNGE                                        0304 00815000
*   LNUM2=-1;                       /* LINECOUNT MEANINGFUL ONLY     */ 00816000
         ST    @12,LNUM2                                           0305 00817000
*   KEYPTR=ADDR(CACURNUM);          /* PTR TO CURRENT LINE KEY       */ 00818000
         LA    @12,CACURNUM(,COMMREG)                              0306 00819000
         ST    @12,KEYPTR                                          0306 00820000
*                                                                  0307 00821000
*   /*****************************************************************/ 00822000
*   /*                                                               */ 00823000
*   /* ------------------------------------------------------- THIS  */ 00824000
*   /* SECTION SECURES THE FIRST RECORD TO BE PROCESSED -- PROCESSING*/ 00825000
*   /* IS TERMINATED IF THERE ARE NO RECORDS WITHIN THE RANGE        */ 00826000
*   /* SPECIFIED OR DEFAULTED                                        */ 00827000
*   /* -------------------------------------------------------       */ 00828000
*   /*                                                               */ 00829000
*   /*****************************************************************/ 00830000
*                                                                  0307 00831000
*READ:                                                             0307 00832000
*   UTCODE='00'X;                   /* READ CURRENT LINE BY KEY      */ 00833000
READ     MVI   UTCODE,X'00'                                        0307 00834000
*   CALL RDWRTRTN;                  /* READ 'FIRST' LINE             */ 00835000
*                                                                  0308 00836000
         BAL   @14,RDWRTRTN                                        0308 00837000
*   /*****************************************************************/ 00838000
*   /*                                                               */ 00839000
*   /* CHECK IF IKJEBEUT OPERATION SUCCESSFUL                        */ 00840000
*   /*                                                               */ 00841000
*   /*****************************************************************/ 00842000
*                                                                  0309 00843000
*   IF RETCODE^=0&RETCODE^=4 THEN   /* TERMINATE                     */ 00844000
         LTR   RETCODE,RETCODE                                     0309 00845000
         BZ    @RF00309                                            0309 00846000
         CH    RETCODE,@CH00602                                    0309 00847000
         BNE   @RT00309                                            0309 00848000
*     GO TO CHGEXIT2;               /* BEGIN END PROCESSING          */ 00849000
*                                                                  0310 00850000
*   /*****************************************************************/ 00851000
*   /*                                                               */ 00852000
*   /* CHECK IF RECORD EXISTS                                        */ 00853000
*   /*                                                               */ 00854000
*   /*****************************************************************/ 00855000
*                                                                  0311 00856000
*   IF RETCODE=0 THEN               /* IF YES, BEGIN PROCESSING      */ 00857000
@RF00309 SLR   @08,@08                                             0311 00858000
         CR    RETCODE,@08                                         0311 00859000
         BE    @RT00311                                            0311 00860000
*     GO TO PROCESS;                /* BEGIN CHANGE OPERATION RECORD    00861000
*                                      SPECIFIED NOT FOUND           */ 00862000
*                                                                  0312 00863000
*   /*****************************************************************/ 00864000
*   /*                                                               */ 00865000
*   /* CHECK IF MORE LINES TO CHANGE                                 */ 00866000
*   /*                                                               */ 00867000
*   /*****************************************************************/ 00868000
*                                                                  0313 00869000
*   IF LNUM1=LNUM2|LNCOUNT=1&CACURNUM^=0 THEN/* IF NO, NOTIFY USER   */ 00870000
         CLC   LNUM1(4),LNUM2                                      0313 00871000
         BE    @RT00313                                            0313 00872000
         CLC   LNCOUNT(4),@CF00060                                 0313 00873000
         BNE   @RF00313                                            0313 00874000
         C     @08,CACURNUM(,COMMREG)                              0313 00875000
         BE    @RF00313                                            0313 00876000
@RT00313 DS    0H                                                  0314 00877000
*     DO;                           /* SEND LINE NOT FOUND MSG       */ 00878000
*NOLNMSG:                                                          0315 00879000
*       MSGPTR=0;                   /* NO 2ND 1ST LEVEL INSERTION    */ 00880000
*                                                                  0315 00881000
NOLNMSG  SLR   @12,@12                                             0315 00882000
         ST    @12,MSGPTR(,COMMREG)                                0315 00883000
*       /*************************************************************/ 00884000
*       /*                                                           */ 00885000
*       /* CHECK IF ASTERISK DEFAULTED OR SPECIFIED                  */ 00886000
*       /*                                                           */ 00887000
*       /*************************************************************/ 00888000
*                                                                  0316 00889000
*       IF LNUM2=-1 THEN            /* IF YES, TEXT = '*'            */ 00890000
         CLC   LNUM2(4),@CF01355                                   0316 00891000
         BNE   @RF00316                                            0316 00892000
*         DO;                       /* ASTERISK SPECIFIED OR DEFLTD  */ 00893000
*           MSGTEXT(1)='*';         /* INSERTION                     */ 00894000
         MVI   MSGTEXT(COMMREG),C'*'                               0318 00895000
*           MSGLEN=4--1;            /* LENGTH                        */ 00896000
         MVC   MSGLEN(2,COMMREG),@CH00132                          0319 00897000
*         END;                                                     0320 00898000
*       ELSE                        /* IF NO, TEXT = KEY VALUE       */ 00899000
*         DO;                       /* LINE NUMBER SPECIFIED         */ 00900000
         B     @RC00316                                            0321 00901000
@RF00316 DS    0H                                                  0322 00902000
*           MSGTEXT(1:LNSTARTL)=LNSTART->LNUM;/* INSERTION           */ 00903000
         L     @12,TABPTR1                                         0322 00904000
         LH    @08,LNSTARTL(,@12)                                  0322 00905000
         LR    @07,@08                                             0322 00906000
         BCTR  @07,0                                               0322 00907000
         L     @12,LNSTART(,@12)                                   0322 00908000
         EX    @07,@SM01524                                        0322 00909000
*           MSGLEN=LNSTARTL+4;      /* LENGTH                        */ 00910000
         AH    @08,@CH00602                                        0323 00911000
         STH   @08,MSGLEN(,COMMREG)                                0323 00912000
*         END;                                                     0324 00913000
*       MSGOFF=22;                  /* OFFSET FOR INSERTION          */ 00914000
@RC00316 MVC   MSGOFF(2,COMMREG),@CH01361                          0325 00915000
*       RELMSG1=1290;               /* MSG IKJ52504I                 */ 00916000
         MVC   RELMSG1(2),@CH01362                                 0326 00917000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 00918000
         SLR   LEV2INS,LEV2INS                                     0327 00919000
*       LEV1INS=ADDR(MSGAREA);      /* PTR TO INSERTION              */ 00920000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0328 00921000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 00922000
         SLR   @12,@12                                             0329 00923000
         STH   @12,RELMSG2                                         0329 00924000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 00925000
         BAL   @14,SENDMSG                                         0330 00926000
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */ 00927000
         B     FLUSH                                               0331 00928000
*     END;                                                         0332 00929000
*   UTCODE='02'X;                   /* SET CODE TO READ NEXT LINE    */ 00930000
@RF00313 MVI   UTCODE,X'02'                                        0333 00931000
*   CALL RDWRTRTN;                  /* READ NEXT LINE                */ 00932000
*                                                                  0334 00933000
         BAL   @14,RDWRTRTN                                        0334 00934000
*   /*****************************************************************/ 00935000
*   /*                                                               */ 00936000
*   /* CHECK IF IKJEBEUT OPERATION SUCCESSFUL                        */ 00937000
*   /*                                                               */ 00938000
*   /*****************************************************************/ 00939000
*                                                                  0335 00940000
*   IF RETCODE^=0&RETCODE^=4 THEN   /* TERMINATE                     */ 00941000
         LTR   RETCODE,RETCODE                                     0335 00942000
         BZ    @RF00335                                            0335 00943000
         CH    RETCODE,@CH00602                                    0335 00944000
         BNE   @RT00335                                            0335 00945000
*     GO TO CHGEXIT2;               /* BEGIN END PROCESSING          */ 00946000
*                                                                  0336 00947000
*   /*****************************************************************/ 00948000
*   /*                                                               */ 00949000
*   /* CHECK IF RECORD EXISTS                                        */ 00950000
*   /*                                                               */ 00951000
*   /*****************************************************************/ 00952000
*                                                                  0337 00953000
*   IF RETCODE=4 THEN               /* IF NO, END OF DATA REACHED    */ 00954000
@RF00335 LA    @08,4                                               0337 00955000
         CR    RETCODE,@08                                         0337 00956000
         BNE   @RF00337                                            0337 00957000
*     DO;                           /* SEND EOD OR LINE NOT FOUND    */ 00958000
*       MSGPTR=0;                   /* NO 2ND 1ST LEVEL INSERTION    */ 00959000
         SLR   @12,@12                                             0339 00960000
         ST    @12,MSGPTR(,COMMREG)                                0339 00961000
*       MSGLEN=LNSTARTL+4;          /* LENGTH OF INSERTION           */ 00962000
         L     @07,TABPTR1                                         0340 00963000
         LH    @05,LNSTARTL(,@07)                                  0340 00964000
         ALR   @08,@05                                             0340 00965000
         STH   @08,MSGLEN(,COMMREG)                                0340 00966000
*       MSGOFF=22;                  /* OFFSET FOR INSERTION          */ 00967000
         MVC   MSGOFF(2,COMMREG),@CH01361                          0341 00968000
*       MSGTEXT(1:LNSTARTL)=LNSTART->LNUM;/* INSERTION TEXT          */ 00969000
         BCTR  @05,0                                               0342 00970000
         L     @08,LNSTART(,@07)                                   0342 00971000
         EX    @05,@SM01526                                        0342 00972000
*       RELMSG1=1290;               /* MSG IKJ52504I                 */ 00973000
         MVC   RELMSG1(2),@CH01362                                 0343 00974000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 00975000
         SLR   LEV2INS,LEV2INS                                     0344 00976000
*       LEV1INS=ADDR(MSGAREA);      /* PTR TO INSERTION              */ 00977000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0345 00978000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 00979000
         STH   @12,RELMSG2                                         0346 00980000
*       CHRETCD=8;                  /* INDICATE FLUSH IS NECESSARY   */ 00981000
         MVC   CHRETCD(4),@CF00058                                 0347 00982000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 00983000
         BAL   @14,SENDMSG                                         0348 00984000
*       RELMSG1=1286;               /* MSG IKJ52500I                 */ 00985000
         MVC   RELMSG1(2),@CH01363                                 0349 00986000
*       LEV1INS=0;                  /* NO 1ST LEVEL INSERTION        */ 00987000
         SLR   LEV1INS,LEV1INS                                     0350 00988000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 00989000
         SLR   @12,@12                                             0351 00990000
         STH   @12,RELMSG2                                         0351 00991000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 00992000
         SLR   LEV2INS,LEV2INS                                     0352 00993000
*       CALL SENDMSG;               /* SEND EOD MESSAGE TO USER      */ 00994000
         BAL   @14,SENDMSG                                         0353 00995000
*       GO TO CHGEXIT2;             /* RETURN TO CALLER              */ 00996000
         B     CHGEXIT2                                            0354 00997000
*     END;                                                         0355 00998000
*                                                                  0355 00999000
*   /*****************************************************************/ 01000000
*   /*                                                               */ 01001000
*   /* CHECK IF LINE WITHIN RANGE SPECIFIED                          */ 01002000
*   /*                                                               */ 01003000
*   /*****************************************************************/ 01004000
*                                                                  0356 01005000
*   IF KEYFLD>LNUM2&LNUM2^=-1 THEN  /* IF NO, END PROCESSING         */ 01006000
@RF00337 L     @12,LNUM2                                           0356 01007000
         C     @12,KEYFLD(,COMMREG)                                0356 01008000
         BNL   @RF00356                                            0356 01009000
         CH    @12,@CH01355                                        0356 01010000
         BNE   @RT00356                                            0356 01011000
*     GO TO NOLNMSG;                /* NOTIFY USER                   */ 01012000
*                                                                  0358 01013000
*   /*****************************************************************/ 01014000
*   /*                                                               */ 01015000
*   /* ------------------------------------------------------- THIS  */ 01016000
*   /* SECTION COLLECTS INFORMATION ABOUT THE REMAINING OPERANDS AND */ 01017000
*   /* MAKES ANY NECESSARY CONVERSIONS, AND SEPARATES THE LOGIC FLOW */ 01018000
*   /* INTO STRING CASES AND CHARACTER COUNT CASES, DEFAULTING TO    */ 01019000
*   /* CHARACTER COUNT IF BOTH ARE SPECIFIED, AND CALLS THE          */ 01020000
*   /* APPROPRIATE SUBROUTINE -- IN THE CASE OF A CHARACTER COUNT    */ 01021000
*   /* OPERATION, VALIDITY CHECKING IS PERFORMED ON THE CHARACTER    */ 01022000
*   /* COUNT, AND ANY FREEABLE CORE IS RELEASED -- IF THE CHARACTER  */ 01023000
*   /* COUNT IS LARGER THAN THE DATA LINE LENGTH, THE USER IS        */ 01024000
*   /* PROMPTED UNTIL HE ENTERS A VALID CHARACTER COUNT              */ 01025000
*   /* -------------------------------------------------------       */ 01026000
*   /*                                                               */ 01027000
*   /*****************************************************************/ 01028000
*                                                                  0358 01029000
*PROCESS:                                                          0358 01030000
*   ;                               /* INIT VALUES FOR STRING CHG    */ 01031000
*                                                                  0358 01032000
@RF00356 DS    0H                                                  0358 01033000
PROCESS  DS    0H                                                  0359 01034000
*   /*****************************************************************/ 01035000
*   /*                                                               */ 01036000
*   /* CHECK IF THIRD OPERAND EXISTS                                 */ 01037000
*   /*                                                               */ 01038000
*   /*****************************************************************/ 01039000
*                                                                  0359 01040000
*   IF LNCNTF='1'B THEN             /* IF YES, RETRIEVE COUNT        */ 01041000
         L     @12,TABPTR1                                         0359 01042000
         TM    LNCNTF(@12),B'10000000'                             0359 01043000
         BNO   @RF00359                                            0359 01044000
*     DO;                           /* CHARACTER COUNT SPECIFIED     */ 01045000
*       PACKAREA='00000000';        /* SET TO ZONED ZEROES           */ 01046000
         MVC   PACKAREA(8),@CC01337                                0361 01047000
*       PACKAREA(9-LNCNTL:8)=LNCNT->LNUM;/* MOVE NUMBER INTO AREA    */ 01048000
         LA    @08,9                                               0362 01049000
         SH    @08,LNCNTL(,@12)                                    0362 01050000
         LA    @07,PACKAREA-1(@08)                                 0362 01051000
         LCR   @08,@08                                             0362 01052000
         AL    @08,@CF00058                                        0362 01053000
         L     @12,LNCNT(,@12)                                     0362 01054000
         EX    @08,@SM01520                                        0362 01055000
*       CALL CONVERT;               /* CONVERT TO BINARY             */ 01056000
         BAL   @14,CONVERT                                         0363 01057000
*       CHARCNT=BINRYREG;           /* SET CHARACTER COUNT           */ 01058000
         ST    BINRYREG,CHARCNT                                    0364 01059000
*       GO TO CNTCHK;               /* DEFAULT COUNT OPERATION       */ 01060000
         B     CNTCHK                                              0365 01061000
*     END;                                                         0366 01062000
*                                                                  0366 01063000
*   /*****************************************************************/ 01064000
*   /*                                                               */ 01065000
*   /* CHECK IF TEXT CHANGE SPECIFIED                                */ 01066000
*   /*                                                               */ 01067000
*   /*****************************************************************/ 01068000
*                                                                  0367 01069000
*   IF STR1F='0'B THEN              /* IF YES, COUNT OPERATION       */ 01070000
@RF00359 L     @12,TABPTR1                                         0367 01071000
         TM    STR1F(@12),B'10000000'                              0367 01072000
         BZ    @RT00367                                            0367 01073000
*     GO TO CNTCHK;                 /* VALIDITY CHECK COUNT          */ 01074000
*   STR1PTR=STR1;                   /* PTR TO 1ST STRING             */ 01075000
*                                                                  0369 01076000
         MVC   STR1PTR(4),STR1(@12)                                0369 01077000
*   /*****************************************************************/ 01078000
*   /*                                                               */ 01079000
*   /* CHECK IF FIRST STRING LENGTH TOO LARGE TO HANDLE              */ 01080000
*   /*                                                               */ 01081000
*   /*****************************************************************/ 01082000
*                                                                  0370 01083000
*   IF STR1L>256 THEN               /* IF YES, DEFAULT TO LARGEST    */ 01084000
         LA    @08,256                                             0370 01085000
         CH    @08,STR1L(,@12)                                     0370 01086000
         BNL   @RF00370                                            0370 01087000
*     STR1L=256;                    /* LENGTH SET TO 256             */ 01088000
*                                                                  0371 01089000
         STH   @08,STR1L(,@12)                                     0371 01090000
*   /*****************************************************************/ 01091000
*   /*                                                               */ 01092000
*   /* CHECK IF SECOND STRING LENGTH TOO LARGE TO HANDLE             */ 01093000
*   /*                                                               */ 01094000
*   /*****************************************************************/ 01095000
*                                                                  0372 01096000
*   IF STR2L>256 THEN               /* IF YES, DEFAULT TO LARGEST    */ 01097000
@RF00370 LA    @12,256                                             0372 01098000
         L     @08,TABPTR1                                         0372 01099000
         CH    @12,STR2L(,@08)                                     0372 01100000
         BNL   @RF00372                                            0372 01101000
*     STR2L=256;                    /* LENGTH SET TO 256             */ 01102000
         STH   @12,STR2L(,@08)                                     0373 01103000
*   STR2PTR=STR2;                   /* PTR TO 2ND STRING             */ 01104000
@RF00372 L     @12,TABPTR1                                         0374 01105000
         MVC   STR2PTR(4),STR2(@12)                                0374 01106000
*   SEDCBPTR=CAPTCDCB;              /* INIT DCB PTR IN IKJEBESE PLT  */ 01107000
         MVC   SEDCBPTR(4),CAPTCDCB(COMMREG)                       0375 01108000
*   SEBFRPTR=ADDR(CABFRPL);         /* INIT IKJEBESE PTR TO LIST     */ 01109000
         LA    @12,CABFRPL(,COMMREG)                               0376 01110000
         ST    @12,SEBFRPTR                                        0376 01111000
*   SEOFFS=0;                       /* INITIALIZE OFFSET TO ZERO     */ 01112000
         SLR   @12,@12                                             0377 01113000
         STH   @12,SEOFFS                                          0377 01114000
*   LECOMPTR=COMMREG;               /* INIT IKJEBELE COMMREG PTR     */ 01115000
         ST    COMMREG,LECOMPTR                                    0378 01116000
*   CALL STRNGRTN;                  /* CONTINUE CHANGE               */ 01117000
         BAL   @14,STRNGRTN                                        0379 01118000
*   GO TO CHNGEXIT;                 /* RETURN TO CALLER              */ 01119000
         B     CHNGEXIT                                            0380 01120000
*CNTCHK:                                                           0381 01121000
*   ;                               /* CHARACTER COUNT VALIDITY CHK  */ 01122000
*                                                                  0381 01123000
CNTCHK   DS    0H                                                  0382 01124000
*   /*****************************************************************/ 01125000
*   /*                                                               */ 01126000
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */ 01127000
*   /*                                                               */ 01128000
*   /*****************************************************************/ 01129000
*                                                                  0382 01130000
*   IF CANONUM='0'B THEN            /* IF YES, ADJUST FOR SEQ.FLD    */ 01131000
*                                                                  0382 01132000
         TM    CANONUM(COMMREG),B'00000001'                        0382 01133000
         BNZ   @RF00382                                            0382 01134000
*     /***************************************************************/ 01135000
*     /*                                                             */ 01136000
*     /* CHECK IF SEQUENCE FIELD STARTS IN COLUMN ONE                */ 01137000
*     /*                                                             */ 01138000
*     /***************************************************************/ 01139000
*                                                                  0383 01140000
*     IF CALINE='01'X THEN          /* IF YES, TEST BY FLD LENGTH    */ 01141000
*                                                                  0383 01142000
         CLI   CALINE(COMMREG),X'01'                               0383 01143000
         BNE   @RF00383                                            0383 01144000
*       /*************************************************************/ 01145000
*       /*                                                           */ 01146000
*       /* CHECK IF COUNT EXCEEDS LINE SIZE                          */ 01147000
*       /*                                                           */ 01148000
*       /*************************************************************/ 01149000
*                                                                  0384 01150000
*       IF CHARCNT<=CALRECL-CALENGTH-4 THEN/* IF NO, CONTINUE        */ 01151000
         LH    @12,CALRECL(,COMMREG)                               0384 01152000
         SLR   @08,@08                                             0384 01153000
         IC    @08,CALENGTH(,COMMREG)                              0384 01154000
         SLR   @12,@08                                             0384 01155000
         SH    @12,@CH00602                                        0384 01156000
         C     @12,CHARCNT                                         0384 01157000
         BNL   @RT00384                                            0384 01158000
*         GO TO CNTPRCS;            /* SKIP PROMPT                   */ 01159000
*       ELSE                                                       0386 01160000
*         ;                         /* IF YES, FALL THRU TO PROMPT   */ 01161000
*     ELSE                          /* IF NO, TEST BY FLD START COL  */ 01162000
*                                                                  0387 01163000
*       /*************************************************************/ 01164000
*       /*                                                           */ 01165000
*       /* CHECK IF COUNT EXCEEDS LINE SIZE                          */ 01166000
*       /*                                                           */ 01167000
*       /*************************************************************/ 01168000
*                                                                  0387 01169000
*       IF CHARCNT<CALINE THEN      /* IF NO, CONTINUE               */ 01170000
         B     @RC00383                                            0387 01171000
@RF00383 L     @12,CHARCNT                                         0387 01172000
         SLR   @08,@08                                             0387 01173000
         IC    @08,CALINE(,COMMREG)                                0387 01174000
         CR    @12,@08                                             0387 01175000
         BL    @RT00387                                            0387 01176000
*         GO TO CNTPRCS;            /* SKIP PROMPT                   */ 01177000
*       ELSE                                                       0389 01178000
*         ;                         /* IF YES, FALL THRU TO PROMPT   */ 01179000
*                                                                  0389 01180000
*   /*****************************************************************/ 01181000
*   /*                                                               */ 01182000
*   /* CHECK IF COUNT EXCEEDS LINE SIZE, NONUM DS                    */ 01183000
*   /*                                                               */ 01184000
*   /*****************************************************************/ 01185000
*                                                                  0390 01186000
*   IF CANONUM='1'B&CHARCNT<=CALRECL-4 THEN/* IF YES, CONTINUE       */ 01187000
@RC00383 DS    0H                                                  0390 01188000
@RF00382 TM    CANONUM(COMMREG),B'00000001'                        0390 01189000
         BNO   @RF00390                                            0390 01190000
         LH    @12,CALRECL(,COMMREG)                               0390 01191000
         SH    @12,@CH00602                                        0390 01192000
         C     @12,CHARCNT                                         0390 01193000
         BNL   @RT00390                                            0390 01194000
*     GO TO CNTPRCS;                /* SKIP PROMPT                   */ 01195000
*   PPLPCL=ADDR(IKJEBCH3);          /* INIT IKJPARS PARMLIST         */ 01196000
@RF00390 L     @12,PPLPTR                                          0392 01197000
         L     @08,@CV00514                                        0392 01198000
         ST    @08,PPLPCL(,@12)                                    0392 01199000
*   PPLANS=ADDR(TABPTR3);           /* PTR TO PDL                    */ 01200000
         LA    @08,TABPTR3                                         0393 01201000
         ST    @08,PPLANS(,@12)                                    0393 01202000
*   PPLCBUF=ADDR(BLANKBFR);         /* PTR TO BLANK BUFFER           */ 01203000
         LA    @08,BLANKBFR(,COMMREG)                              0394 01204000
         ST    @08,PPLCBUF(,@12)                                   0394 01205000
*   PPLUWA=0;                       /* NO VALIDITY CHECK EXIT USED   */ 01206000
         SLR   @08,@08                                             0395 01207000
         ST    @08,PPLUWA(,@12)                                    0395 01208000
*   BLANKOFF=0;                     /* OFFSET FOR SCANNING           */ 01209000
         STH   @08,BLANKOFF(,COMMREG)                              0396 01210000
*   BLANKTXT='';                    /* BLANK OUT BUFFER              */ 01211000
         MVI   BLANKTXT(COMMREG),C' '                              0397 01212000
         MVC   BLANKTXT+1(5,COMMREG),BLANKTXT(COMMREG)             0397 01213000
*   BLANKLEN=LENGTH(BLANKBFR);      /* LENGTH OF BUFFER              */ 01214000
*                                                                  0398 01215000
         MVC   BLANKLEN(2,COMMREG),@CH00541                        0398 01216000
*   /*****************************************************************/ 01217000
*   /*                                                               */ 01218000
*   /* PROMPT AND PARSE FOR VALID CHARACTER COUNT                    */ 01219000
*   /*                                                               */ 01220000
*   /*****************************************************************/ 01221000
*                                                                  0399 01222000
*   DO;                             /* CALLTSSR EP(IKJPARS)MF(E,PPL) */ 01223000
*     RESPECIFY                                                    0400 01224000
*       GPR01P RSTD;                                               0400 01225000
*     GPR01P=ADDR(PPL);                                            0401 01226000
         LR    GPR01P,@12                                          0401 01227000
*     IF CVTPARS=0 THEN                                            0402 01228000
         L     @12,CVTPTR                                          0402 01229000
         C     @08,CVTPARS(,@12)                                   0402 01230000
         BNE   @RF00402                                            0402 01231000
*       GEN(LINK EP=IKJPARS);                                      0403 01232000
         LINK EP=IKJPARS                                                01233000
*     ELSE                                                         0404 01234000
*       CALL CVTPARS;                                              0404 01235000
         B     @RC00402                                            0404 01236000
@RF00402 L     @12,CVTPTR                                          0404 01237000
         L     @15,CVTPARS(,@12)                                   0404 01238000
         BALR  @14,@15                                             0404 01239000
*     RESPECIFY                                                    0405 01240000
*       GPR01P UNRSTD;                                             0405 01241000
@RC00402 DS    0H                                                  0406 01242000
*   END;                            /* INVOKE IKJPARS SERVICE ROUTINE*/ 01243000
*   RETCODE=RETCDREG;               /* SAVE IKJPARS RETURN CODE      */ 01244000
*                                                                  0407 01245000
         LR    RETCODE,RETCDREG                                    0407 01246000
*   /*****************************************************************/ 01247000
*   /*                                                               */ 01248000
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM IKJPARS                 */ 01249000
*   /*                                                               */ 01250000
*   /*****************************************************************/ 01251000
*                                                                  0408 01252000
*   IF RETCODE^=0 THEN              /* IF NO, TERMINAL ERROR         */ 01253000
         LTR   RETCODE,RETCODE                                     0408 01254000
         BNZ   @RT00408                                            0408 01255000
*     GO TO PARSERR;                /* PROCESS ERROR                 */ 01256000
*   PACKAREA='00000000';            /* SET TO ZONED ZEROES           */ 01257000
         MVC   PACKAREA(8),@CC01337                                0410 01258000
*   PACKAREA(9-CHCNTL:8)=CHCNT->LNUM;/* MOVE COUNT INTO WORK AREA    */ 01259000
         L     @12,TABPTR3                                         0411 01260000
         LA    @08,9                                               0411 01261000
         SH    @08,CHCNTL(,@12)                                    0411 01262000
         LA    @07,PACKAREA-1(@08)                                 0411 01263000
         LCR   @08,@08                                             0411 01264000
         AL    @08,@CF00058                                        0411 01265000
         L     @12,CHCNT(,@12)                                     0411 01266000
         EX    @08,@SM01520                                        0411 01267000
*   CALL CONVERT;                   /* CONVERT TO BINARY             */ 01268000
         BAL   @14,CONVERT                                         0412 01269000
*   CHARCNT=BINRYREG;               /* SAVE CHARACTER COUNT          */ 01270000
         ST    BINRYREG,CHARCNT                                    0413 01271000
*   PARMREG1=ADDR(TABPTR3);         /* PTR TO PROMPT PDL             */ 01272000
         LA    PARMREG1,TABPTR3                                    0414 01273000
*   GEN(IKJRLSA (1));               /* RELEASE PDL CORE              */ 01274000
         IKJRLSA (1)                                                    01275000
*   GO TO CNTCHK;                   /* CONTINUE PROCESSING           */ 01276000
         B     CNTCHK                                              0416 01277000
*CNTPRCS:                                                          0417 01278000
*   CNTSW='1'B;                     /* INDICATE COUNT OPERATION      */ 01279000
CNTPRCS  OI    CNTSW,B'00100000'                                   0417 01280000
*   LECOMPTR=COMMREG;               /* INIT IKJEBELE COMMREG PTR     */ 01281000
         ST    COMMREG,LECOMPTR                                    0418 01282000
*   CHARCNT=BINRYREG;               /* SAVE CHARACTER COUNT          */ 01283000
         ST    BINRYREG,CHARCNT                                    0419 01284000
*   CALL CHARRTN;                   /* CONTINUE CHANGE               */ 01285000
         BAL   @14,CHARRTN                                         0420 01286000
*   GO TO CHNGEXIT;                 /* RETURN TO CALLER              */ 01287000
         B     CHNGEXIT                                            0421 01288000
*                                                                  0422 01289000
*   /*****************************************************************/ 01290000
*   /*                                                               */ 01291000
*   /* ------------------------------------------------------- THIS  */ 01292000
*   /* SECTION PROCESSES SYSTEM ORIENTED ERRORS AND CONTAINS THE     */ 01293000
*   /* GENERAL EXIT CODE (FREEMAIN OF INPUT BUFFER AND RELEASE OF PDL*/ 01294000
*   /* CORE IF REQUIRED) FOR UNSUCCESSFUL CHANGE OPERATIONS          */ 01295000
*   /* -------------------------------------------------------       */ 01296000
*   /*                                                               */ 01297000
*   /*****************************************************************/ 01298000
*                                                                  0422 01299000
*PUTERR:                                                           0422 01300000
*   ;                               /* PROCESS IKJPUTL ERROR RETURN  */ 01301000
*                                                                  0422 01302000
PUTERR   DS    0H                                                  0423 01303000
*   /*****************************************************************/ 01304000
*   /*                                                               */ 01305000
*   /* CHECK IF NO CORE AVAILABLE                                    */ 01306000
*   /*                                                               */ 01307000
*   /*****************************************************************/ 01308000
*                                                                  0423 01309000
*   IF RETCODE=16 THEN              /* IF YES, NOTIFY USER           */ 01310000
         CH    RETCODE,@CH00236                                    0423 01311000
         BNE   @RF00423                                            0423 01312000
*     DO;                           /* SEND NOT ENOUGH CORE MSG      */ 01313000
*NOCORMSG:                                                         0425 01314000
*       RELMSG1=270;                /* MSG IKJ52312I                 */ 01315000
NOCORMSG MVC   RELMSG1(2),@CH01371                                 0425 01316000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 01317000
         SLR   LEV2INS,LEV2INS                                     0426 01318000
*       MSGPTR=0;                   /* ONLY ONE INSERTION            */ 01319000
         SLR   @12,@12                                             0427 01320000
         ST    @12,MSGPTR(,COMMREG)                                0427 01321000
*       MSGLEN=CASCMDLN+4;          /* SET LENGTH                    */ 01322000
         LA    @08,4                                               0428 01323000
         AH    @08,CASCMDLN(,COMMREG)                              0428 01324000
         STH   @08,MSGLEN(,COMMREG)                                0428 01325000
*       MSGOFF=45;                  /* OFFSET FOR INSERT             */ 01326000
         MVC   MSGOFF(2,COMMREG),@CH01373                          0429 01327000
*       MSGTEXT=CAPTSCMD->LNUM;     /* MOVE INSERT INTO BFR          */ 01328000
         MVI   MSGTEXT+8(COMMREG),C' '                             0430 01329000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0430 01330000
         L     @08,CAPTSCMD(,COMMREG)                              0430 01331000
         MVC   MSGTEXT(8,COMMREG),LNUM(@08)                        0430 01332000
*       LEV1INS=ADDR(MSGPTR);       /* PTR TO INSERT                 */ 01333000
         LA    LEV1INS,MSGPTR(,COMMREG)                            0431 01334000
*       RELMSG2=0;                  /* NO 2ND LEVEL MESSAGE          */ 01335000
         STH   @12,RELMSG2                                         0432 01336000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 01337000
         BAL   @14,SENDMSG                                         0433 01338000
*       GO TO FLUSH;                /* BRANCH TO INDICATE FLUSH      */ 01339000
         B     FLUSH                                               0434 01340000
*     END;                                                         0435 01341000
*                                                                  0435 01342000
*   /*****************************************************************/ 01343000
*   /*                                                               */ 01344000
*   /* CHECK IF ATTENTION ISSUED                                     */ 01345000
*   /*                                                               */ 01346000
*   /*****************************************************************/ 01347000
*                                                                  0436 01348000
*   IF RETCODE=4 THEN               /* IF YES, ERROR TERMINAL        */ 01349000
@RF00423 CH    RETCODE,@CH00602                                    0436 01350000
         BE    @RT00436                                            0436 01351000
*     GO TO CHNGEXIT;               /* RETURN TO CALLER              */ 01352000
*   MSGTEXT='PUTLINE';              /* 'PUTLINE' INSERTION           */ 01353000
         MVI   MSGTEXT+7(COMMREG),C' '                             0438 01354000
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0438 01355000
         MVC   MSGTEXT(7,COMMREG),@CC01374                         0438 01356000
*   MSGLEN=LENGTH('PUTLINE')+4;     /* SET LENGTH OF INSERT          */ 01357000
         MVC   MSGLEN(2,COMMREG),@CH00033                          0439 01358000
*   GO TO SYSERR;                   /* PROCESS SYSTEM ERROR          */ 01359000
         B     SYSERR                                              0440 01360000
*GETERR:                                                           0441 01361000
*   ;                               /* PROCESS IKJGETL ERROR RETURN  */ 01362000
*                                                                  0441 01363000
GETERR   DS    0H                                                  0442 01364000
*   /*****************************************************************/ 01365000
*   /*                                                               */ 01366000
*   /* CHECK IF NO CORE AVAILABLE                                    */ 01367000
*   /*                                                               */ 01368000
*   /*****************************************************************/ 01369000
*                                                                  0442 01370000
*   IF RETCODE=24 THEN              /* IF YES, ERROR TERMINAL        */ 01371000
         CH    RETCODE,@CH00077                                    0442 01372000
         BE    @RT00442                                            0442 01373000
*     GO TO NOCORMSG;               /* NOTIFY USER                   */ 01374000
*                                                                  0443 01375000
*   /*****************************************************************/ 01376000
*   /*                                                               */ 01377000
*   /* CHECK IF ATTENTION ISSUED                                     */ 01378000
*   /*                                                               */ 01379000
*   /*****************************************************************/ 01380000
*                                                                  0444 01381000
*   IF RETCODE=8 THEN               /* IF YES, ERROR TERMINAL        */ 01382000
         CH    RETCODE,@CH00058                                    0444 01383000
         BE    @RT00444                                            0444 01384000
*     GO TO CHNGEXIT;               /* RETURN TO CALLER              */ 01385000
*   MSGTEXT='GETLINE';              /* 'GETLINE' INSERTION           */ 01386000
         MVI   MSGTEXT+7(COMMREG),C' '                             0446 01387000
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0446 01388000
         MVC   MSGTEXT(7,COMMREG),@CC01377                         0446 01389000
*   MSGLEN=LENGTH('GETLINE')+4;     /* SET LENGTH OF INSERT          */ 01390000
         MVC   MSGLEN(2,COMMREG),@CH00033                          0447 01391000
*   GO TO SYSERR;                   /* PROCESS SYSTEM ERROR          */ 01392000
         B     SYSERR                                              0448 01393000
*PARSERR:                                                          0449 01394000
*   ;                               /* PROCESS IKJPARS ERROR RETURN  */ 01395000
*                                                                  0449 01396000
PARSERR  DS    0H                                                  0450 01397000
*   /*****************************************************************/ 01398000
*   /*                                                               */ 01399000
*   /* CHECK IF NO CORE AVAILABLE FOR IKJPARS PDL                    */ 01400000
*   /*                                                               */ 01401000
*   /*****************************************************************/ 01402000
*                                                                  0450 01403000
*   IF RETCODE=16 THEN              /* IF YES, ERROR TERMINAL        */ 01404000
         CH    RETCODE,@CH00236                                    0450 01405000
         BE    @RT00450                                            0450 01406000
*     GO TO NOCORMSG;               /* NOTIFY USER                   */ 01407000
*                                                                  0451 01408000
*   /*****************************************************************/ 01409000
*   /*                                                               */ 01410000
*   /* CHECK IF SYSTEM ERROR ENCOUNTERED                             */ 01411000
*   /*                                                               */ 01412000
*   /*****************************************************************/ 01413000
*                                                                  0452 01414000
*   IF RETCODE=4 THEN               /* IF YES,FLUSH NECESSARY        */ 01415000
         CH    RETCODE,@CH00602                                    0452 01416000
         BE    @RT00452                                            0452 01417000
*     GO TO FLUSH;                  /* BRANCH TO INDICATE FLUSH      */ 01418000
*   IF RETCODE=8 THEN               /* IF NO, NO MESSAGE             */ 01419000
         CH    RETCODE,@CH00058                                    0454 01420000
         BE    @RT00454                                            0454 01421000
*     GO TO CHGEXIT2;               /* RETURN TO CALLER              */ 01422000
*   MSGTEXT='PARSE';                /* 'PARSE' INSERTION             */ 01423000
         MVI   MSGTEXT+5(COMMREG),C' '                             0456 01424000
         MVC   MSGTEXT+6(66,COMMREG),MSGTEXT+5(COMMREG)            0456 01425000
         MVC   MSGTEXT(5,COMMREG),@CC01379                         0456 01426000
*   MSGLEN=LENGTH('PARSE')+4;       /* SET INSERT LENGTH             */ 01427000
         MVC   MSGLEN(2,COMMREG),@CH01338                          0457 01428000
*SYSERR:                                                           0458 01429000
*   ;                               /* SEND CMD SYSTEM ERROR MSG     */ 01430000
*                                                                  0458 01431000
SYSERR   DS    0H                                                  0459 01432000
*   /*****************************************************************/ 01433000
*   /*                                                               */ 01434000
*   /* CONVERT RETURN CODE FROM REGISTER                             */ 01435000
*   /*                                                               */ 01436000
*   /*****************************************************************/ 01437000
*                                                                  0459 01438000
*   RETCDREG=RETCODE;               /* RECOVER RETURN CODE           */ 01439000
         LR    RETCDREG,RETCODE                                    0459 01440000
*   GENERATE REFS(RETCDREG,COMMREG,PACKAREA);                      0460 01441000
         CVD   RETCDREG,PACKAREA                CONVERT TO DECIMAL      01442000
         UNPK MSGTEXT2(3,COMMREG),PACKAREA+6(2)                         01443000
         MVN   MSGTEXT2(2,COMMREG),MSGTEXT2+1(COMMREG) MOVE             01444000
*   RELMSG1=271;                    /* MSG IKJ52313I                 */ 01445000
         MVC   RELMSG1(2),@CH01381                                 0461 01446000
*   LEV1INS=0;                      /* NO 1ST LEVEL INSERTION        */ 01447000
         SLR   LEV1INS,LEV1INS                                     0462 01448000
*   RELMSG2=1;                      /* 2ND LEVEL MESSAGE             */ 01449000
         MVC   RELMSG2(2),@CH00060                                 0463 01450000
*   MSGLEN2=2+4;                    /* SET LENGTH OF 2ND INSERT      */ 01451000
         MVC   MSGLEN2(2,COMMREG),@CH00510                         0464 01452000
*   MSGOFF=10;                      /* OFFSET FOR INSERT             */ 01453000
         MVC   MSGOFF(2,COMMREG),@CH00541                          0465 01454000
*   MSGPTR2=0;                      /* INDICATE LAST INSERTION       */ 01455000
         SLR   @12,@12                                             0466 01456000
         ST    @12,MSGPTR2(,COMMREG)                               0466 01457000
*   MSGPTR=ADDR(MSGPTR2);           /* CHAIN MESSAGES                */ 01458000
         LA    @12,MSGPTR2(,COMMREG)                               0467 01459000
         ST    @12,MSGPTR(,COMMREG)                                0467 01460000
*   MSGOFF2=22;                     /* OFFSET FOR INSERT             */ 01461000
         MVC   MSGOFF2(2,COMMREG),@CH01361                         0468 01462000
*   LEV2INS=ADDR(MSGPTR);           /* PTR TO INSERT                 */ 01463000
         LA    LEV2INS,MSGPTR(,COMMREG)                            0469 01464000
*   CALL SENDMSG;                   /* PRODUCE MESSAGE               */ 01465000
         BAL   @14,SENDMSG                                         0470 01466000
*FLUSH:                                                            0471 01467000
*   CHRETCD=8;                      /* INDICATE FLUSH IS NECESSARY   */ 01468000
FLUSH    MVC   CHRETCD(4),@CF00058                                 0471 01469000
*CHGEXIT2:                                                         0472 01470000
*   ;                               /* BEGIN EXIT PROCESSING         */ 01471000
*                                                                  0472 01472000
CHGEXIT2 DS    0H                                                  0473 01473000
*   /*****************************************************************/ 01474000
*   /*                                                               */ 01475000
*   /* CHECK IF PROMPTING PERFORMED                                  */ 01476000
*   /*                                                               */ 01477000
*   /*****************************************************************/ 01478000
*                                                                  0473 01479000
*   IF PROMPTSW='1'B THEN           /* IF YES, FREE BUFFER & PDL     */ 01480000
         TM    PROMPTSW,B'10000000'                                0473 01481000
         BNO   @RF00473                                            0473 01482000
*     DO;                           /* PREPARE TO FREE CORE          */ 01483000
*       FREEAREA=GTPBIBUF;          /* PTR TO INPUT PROMPT LINE      */ 01484000
         L     @12,GTPBPTR                                         0475 01485000
         L     @12,GTPBIBUF(,@12)                                  0475 01486000
         ST    @12,FREEAREA                                        0475 01487000
*       FREELEN=BFRLEN;             /* LENGTH OF BUFFER              */ 01488000
         LH    @12,BFRLEN(,@12)                                    0476 01489000
         ST    @12,FREELEN                                         0476 01490000
*       BINRYREG=ADDR(FREEAREA);    /* PTR TO AREA INFO              */ 01491000
         LA    BINRYREG,FREEAREA                                   0477 01492000
*       FREELIST=FREELIST&&FREELIST;/* ZERO LIST                     */ 01493000
         XC    FREELIST(12),FREELIST                               0478 01494000
*       PARMREG1=ADDR(FREELIST);    /* PTR TO LIST FORM              */ 01495000
*                                                                  0479 01496000
         LA    PARMREG1,FREELIST                                   0479 01497000
*       /*************************************************************/ 01498000
*       /*                                                           */ 01499000
*       /* FREEMAIN INPUT BUFFER                                     */ 01500000
*       /*                                                           */ 01501000
*       /*************************************************************/ 01502000
*                                                                  0480 01503000
*       GENERATE REFS(BINRYREG);                                   0480 01504000
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))                        01505000
*       PARMREG1=ADDR(TABPTR2);     /* PTR TO PROMPT PDL             */ 01506000
         LA    PARMREG1,TABPTR2                                    0481 01507000
*     END;                                                         0482 01508000
*   ELSE                            /* FREE MAIN PDL                 */ 01509000
*     PARMREG1=ADDR(TABPTR1);       /* PTR TO MAIN PDL               */ 01510000
*                                                                  0483 01511000
         B     @RC00473                                            0483 01512000
@RF00473 LA    PARMREG1,TABPTR1                                    0483 01513000
*   /*****************************************************************/ 01514000
*   /*                                                               */ 01515000
*   /* CHECK IF IKJPARS CALLED                                       */ 01516000
*   /*                                                               */ 01517000
*   /*****************************************************************/ 01518000
*                                                                  0484 01519000
*   IF FIRSTCHG='1'B THEN           /* IF YES, PDL TO FREE           */ 01520000
@RC00473 TM    FIRSTCHG,B'01000000'                                0484 01521000
         BNO   @RF00484                                            0484 01522000
*     GEN(IKJRLSA (1));             /* RELEASE PDL CORE              */ 01523000
         IKJRLSA (1)                                                    01524000
*CHNGEXIT:                                                         0486 01525000
*   ;                               /* ERROR EXIT                    */ 01526000
@RF00484 DS    0H                                                  0486 01527000
CHNGEXIT DS    0H                                                  0487 01528000
*   RETCDREG=CHRETCD;               /* SET RETURN CODE REGISTER      */ 01529000
         L     RETCDREG,CHRETCD                                    0487 01530000
*   RESPECIFY                                                      0488 01531000
*    (GPR12P,                                                      0488 01532000
*     GPR13P) RSTD;                                                0488 01533000
*   CANXTSVA=GPR13P;                /* UPDATE NEXT-SAVE-AREA PTR     */ 01534000
         ST    GPR13P,CANXTSVA(,COMMREG)                           0489 01535000
*   GPR12P=GPR13P;                  /* SAVE PRESENT SAVE-AREA ADDR   */ 01536000
         LR    GPR12P,GPR13P                                       0490 01537000
*   GPR13P=(GPR13P+4)->CASAVPTR;    /* GET BACKWARD SAVE-AREA PTR    */ 01538000
         L     @08,CASAVPTR+4(,GPR13P)                             0491 01539000
         LR    GPR13P,@08                                          0491 01540000
*   RESPECIFY                                                      0492 01541000
*     CASAVE BASED(GPR12P);         /* CHANGE BASE FOR SAVE-AREA     */ 01542000
*   CASAVE=CASAVE&&CASAVE;          /* ZERO OUT THIS SAVE-AREA       */ 01543000
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0493 01544000
*   RESPECIFY                                                      0494 01545000
*     CASAVE BASED;                                                0494 01546000
*   RETURN CODE(RETCDREG);          /* RETURN WITH RETURN CODE       */ 01547000
         L     @14,12(,@13)                                        0495 01548000
         LM    @00,@12,20(@13)                                     0495 01549000
         BR    @14                                                 0495 01550000
*   RESPECIFY                                                      0496 01551000
*    (GPR12P,                                                      0496 01552000
*     GPR13P) UNRSTD;               /* RETURN TO CALLER              */ 01553000
*                                                                  0497 01554000
*   /*****************************************************************/ 01555000
*   /*                                                               */ 01556000
*   /* PROMPT PCL LIST                                               */ 01557000
*   /*                                                               */ 01558000
*   /*****************************************************************/ 01559000
*                                                                  0497 01560000
*   GENERATE DATA DEFS(CHPCE);                                     0497 01561000
*                                                                  0498 01562000
*   /*****************************************************************/ 01563000
*   /*                                                               */ 01564000
*   /* THIS SUBROUTINE CONVERTS THE LINE NUMBER OR COUNT OPERANDS    */ 01565000
*   /* FROM ZONED DECIMAL TO BINARY. THE BINARY VALUE IS RETURNED TO */ 01566000
*   /* THE CALLER IN REGISTER 4.                                     */ 01567000
*   /*                                                               */ 01568000
*   /*****************************************************************/ 01569000
*                                                                  0498 01570000
*CONVERT:                                                          0498 01571000
*   PROC OPTIONS(NOSAVEAREA,SAVE(14));/* SUBRTN ENTRY POINT          */ 01572000
*                                                                  0498 01573000
@EL00001 DS    0H                                                  0498 01574000
@EF00001 DS    0H                                                  0498 01575000
@ER00001 LM    @14,@12,12(@13)                                     0498 01576000
         BR    @14                                                 0498 01577000
CONVERT  ST    @14,12(,@13)                                        0498 01578000
*   /*****************************************************************/ 01579000
*   /*                                                               */ 01580000
*   /* GENERATE CONVERSION                                           */ 01581000
*   /*                                                               */ 01582000
*   /*****************************************************************/ 01583000
*                                                                  0499 01584000
*   GENERATE REFS(BINRYREG,PACKAREA);                              0499 01585000
         PACK  PACKAREA(8),PACKAREA(8)                                  01586000
         CVB   BINRYREG,PACKAREA                CONVERT TO BINARY       01587000
*   RETURN;                         /* RETURN TO CALLER              */ 01588000
@EL00002 DS    0H                                                  0500 01589000
@EF00002 DS    0H                                                  0500 01590000
@ER00002 L     @14,12(,@13)                                        0500 01591000
         BR    @14                                                 0500 01592000
*   END CONVERT;                    /* END OF SUBROUTINE             */ 01593000
*                                                                  0502 01594000
*   /*****************************************************************/ 01595000
*   /*                                                               */ 01596000
*   /* THIS SUBROUTINE PERFORMS ALL THE READ OPERATIONS FROM THE EDIT*/ 01597000
*   /* DATA SET. THE IKJEBESH MACRO IS USED TO CALL IKJEBEUT(EDIT    */ 01598000
*   /* ACCESS METHOD INTERFACE) VIA THE SERVICE ROUTINE HANDLER. THE */ 01599000
*   /* PARAMETER LIST PASSED TO IKJEBEUT IS INITIATIZED BY THE CALLER*/ 01600000
*   /* AND THE RETURN CODE FROM IKJEBEUT IS SAVED IN AREA RETCODE.   */ 01601000
*   /*                                                               */ 01602000
*   /*****************************************************************/ 01603000
*                                                                  0502 01604000
*RDWRTRTN:                                                         0502 01605000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY POINT            */ 01606000
*                                                                  0502 01607000
RDWRTRTN DS    0H                                                  0503 01608000
*   /*****************************************************************/ 01609000
*   /*                                                               */ 01610000
*   /* RESTRICT USE OF REGISTERS USED BY PROGRAM                     */ 01611000
*   /*                                                               */ 01612000
*   /*****************************************************************/ 01613000
*                                                                  0503 01614000
*   RESPECIFY                                                      0503 01615000
*    (PARMREG1,                                                    0503 01616000
*     BINRYREG,                                                    0503 01617000
*     COMMREG,                                                     0503 01618000
*     BASEREG,                                                     0503 01619000
*     DATAREG) RSTD;                                               0503 01620000
*   RESPECIFY                                                      0504 01621000
*    (BASEREG2) RSTD;                                              0504 01622000
*   READPTR=RETREG;                 /* SAVE RETURN POINT ADDRESS     */ 01623000
*                                                                  0505 01624000
         LR    READPTR,RETREG                                      0505 01625000
*   /*****************************************************************/ 01626000
*   /*                                                               */ 01627000
*   /* READ RECORD                                                   */ 01628000
*   /*                                                               */ 01629000
*   /*****************************************************************/ 01630000
*                                                                  0506 01631000
*   GENERATE REFS(COMMREG,UTPLIST);                                0506 01632000
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        X01633000
               MF=(E,SRPLIST)                                           01634000
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */ 01635000
         LR    RETCODE,RETCDREG                                    0507 01636000
*   RCDPTR=PARMREG1;                /* SAVE PTR TO RECORD IN REG1    */ 01637000
*                                                                  0508 01638000
         ST    PARMREG1,RCDPTR                                     0508 01639000
*   /*****************************************************************/ 01640000
*   /*                                                               */ 01641000
*   /* CHECK IF I/O ERROR OCCURRED IN EDIT DATA SET                  */ 01642000
*   /*                                                               */ 01643000
*   /*****************************************************************/ 01644000
*                                                                  0509 01645000
*   IF RETCODE=8 THEN               /* IF YES, TERMINATE             */ 01646000
         CH    RETCODE,@CH00058                                    0509 01647000
         BNE   @RF00509                                            0509 01648000
*     CHRETCD=12;                   /* SET ERROR CODE                */ 01649000
         MVC   CHRETCD(4),@CF00145                                 0510 01650000
*   RETREG=READPTR;                 /* RESTORE RETURN POINT ADDRESS  */ 01651000
@RF00509 LR    RETREG,READPTR                                      0511 01652000
*   RETURN;                         /* SUCCESSFUL COMPLETION         */ 01653000
@EL00003 DS    0H                                                  0512 01654000
@EF00003 DS    0H                                                  0512 01655000
@ER00003 BR    @14                                                 0512 01656000
*   END RDWRTRTN;                   /* END OF SUBROUTINE             */ 01657000
*                                                                  0514 01658000
*   /*****************************************************************/ 01659000
*   /*                                                               */ 01660000
*   /* THIS SUBROUTINE USES THE EDIT MACRO IKJEBEML TO SEND MESSAGES */ 01661000
*   /* TO THE USER.                                                  */ 01662000
*   /*                                                               */ 01663000
*   /*****************************************************************/ 01664000
*                                                                  0514 01665000
*SENDMSG:                                                          0514 01666000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY PT               */ 01667000
*                                                                  0514 01668000
SENDMSG  DS    0H                                                  0515 01669000
*   /*****************************************************************/ 01670000
*   /*                                                               */ 01671000
*   /* RESTRICT USE OF REGISTERS USED BY PROGRAM                     */ 01672000
*   /*                                                               */ 01673000
*   /*****************************************************************/ 01674000
*                                                                  0515 01675000
*   RESPECIFY                                                      0515 01676000
*    (PARMREG1,                                                    0515 01677000
*     BINRYREG,                                                    0515 01678000
*     COMMREG,                                                     0515 01679000
*     BASEREG,                                                     0515 01680000
*     DATAREG,                                                     0515 01681000
*     BASEREG2,                                                    0515 01682000
*     LEV1INS,                                                     0515 01683000
*     LEV2INS) RSTD;                                               0515 01684000
*   SENDPTR=RETREG;                 /* SAVE RETURN POINT ADDRESS     */ 01685000
         LR    SENDPTR,RETREG                                      0516 01686000
*   GENERATE;                                                      0517 01687000
CALLBEMS  IKJEBEML  ,,(LEV1INS),(LEV2INS),MF=(E,SRPLIST)                01688000
*   RESPECIFY                                                      0518 01689000
*    (LEV1INS,                                                     0518 01690000
*     LEV2INS) UNRSTD;                                             0518 01691000
*   RETREG=SENDPTR;                 /* RESTORE RETURN POINT ADDRESS  */ 01692000
         LR    RETREG,SENDPTR                                      0519 01693000
*   RETURN;                         /* RETURN TO CALLER              */ 01694000
@EL00004 DS    0H                                                  0520 01695000
@EF00004 DS    0H                                                  0520 01696000
@ER00004 BR    @14                                                 0520 01697000
*   END SENDMSG;                    /* END OF SUBROUTINE             */ 01698000
*                                                                  0522 01699000
*/********************************************************************  01700000
*                                                                    */ 01701000
*/*                                                                  */ 01702000
*/*    THIS SUBROUTINE OF THE CHANGE SUBCOMMAND OF EDIT MODIFIES     */ 01703000
*/*    LINE(S) WITHIN THE EDIT DATA SET BY PRINTING THE LINE(S) TO   */ 01704000
*/*    THE TERMINAL AND ALLOWING THE USER TO COMPLETE THE LINE(S) AT */ 01705000
*/*    THE TERMINAL.  THIS OPERATION IS PERFORMED WHEN THE USER      */ 01706000
*/*    SPECIFIES EITHER A NUMERIC CHARACTER COUNT OR A STRING AT     */ 01707000
*/*    WHICH HE WANTS TO START MODIFYING THE LINE.  AFTER THE USER   */ 01708000
*/*    UPDATES THE LINE, IT IS WRITTEN BACK INTO THE DATA SET. IF THE*/ 01709000
*/*    DATA SET TYPE IS BASIC OR IPLI, THE REVERSE POLISH DATA SET IS*/ 01710000
*/*    UPDATED.  IF THE DATA SET TYPE IS NON-LINE NUMBERED TEXT,     */ 01711000
*/*    OVERFLOW LINES, IF ANY, ARE CREATED.  THE CURRENT LINE POINTER*/ 01712000
*/*    IS UPDATED TO THE LAST LINE CHANGED. CONTROL IS THEN RETURNED */ 01713000
*/*    TO IKJEBEMA VIA IKJEBECH WITH A RETURN CODE IN REG. FIFTEEN.  */ 01714000
*/*                                                                  */ 01715000
*/********************************************************************  01716000
*                                                                    */ 01717000
*                                                                  0522 01718000
*CHARRTN:                                                          0522 01719000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY PT               */ 01720000
*                                                                  0522 01721000
CHARRTN  DS    0H                                                  0523 01722000
*   /*****************************************************************/ 01723000
*   /*                                                               */ 01724000
*   /* REGISTERS WITH SPECIAL USE                                    */ 01725000
*   /*                                                               */ 01726000
*   /*****************************************************************/ 01727000
*                                                                  0523 01728000
*   RESPECIFY                                                      0523 01729000
*    (PARMREG1,                                                    0523 01730000
*     BINRYREG,                                                    0523 01731000
*     COMMREG,                                                     0523 01732000
*     BASEREG,                                                     0523 01733000
*     DATAREG) RSTD;                                               0523 01734000
*   RESPECIFY                                                      0524 01735000
*    (BASEREG2) RSTD;                                              0524 01736000
*   CHARPTR=RETREG;                 /* SAVE RETURN POINT             */ 01737000
         ST    RETREG,CHARPTR                                      0525 01738000
*   VERCNT=0;                       /* INITIALIZE VERIFY CT TO ZERO  */ 01739000
         SLR   @12,@12                                             0526 01740000
         ST    @12,VERCNT                                          0526 01741000
*   PTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO PUTLINE PARMBLK   */ 01742000
         LA    @12,PTGTLIST                                        0527 01743000
         ST    @12,PTPBPTR                                         0527 01744000
*   GTPBPTR=ADDR(PTGTLIST);         /* INIT PTR TO GETLINE PARMBLK   */ 01745000
         ST    @12,GTPBPTR                                         0528 01746000
*CNTPRCS2:                          /* START OF MAIN LOOP            */ 01747000
*                                                                  0529 01748000
*   /*****************************************************************/ 01749000
*   /*                                                               */ 01750000
*   /* CHECK IF PROMPT BUFFER TO BE FREED                            */ 01751000
*   /*                                                               */ 01752000
*   /*****************************************************************/ 01753000
*                                                                  0529 01754000
*   IF PROMPTSW='1'B THEN           /* IF YES, FREE PROMPT BUFFER    */ 01755000
CNTPRCS2 TM    PROMPTSW,B'10000000'                                0529 01756000
         BNO   @RF00529                                            0529 01757000
*     DO;                           /* INIT PARMLIST AND FREEMAIN    */ 01758000
*       FREEAREA=GTPBIBUF;          /* PTR TO PROMPT BFR             */ 01759000
         L     @12,GTPBPTR                                         0531 01760000
         L     @12,GTPBIBUF(,@12)                                  0531 01761000
         ST    @12,FREEAREA                                        0531 01762000
*       FREELEN=BFRLEN;             /* LENGTH OF BUFFER              */ 01763000
         LH    @12,BFRLEN(,@12)                                    0532 01764000
         ST    @12,FREELEN                                         0532 01765000
*       BINRYREG=ADDR(FREEAREA);    /* PTR TO AREA INFORMATION       */ 01766000
         LA    BINRYREG,FREEAREA                                   0533 01767000
*       FREELIST=FREELIST&&FREELIST;/* ZERO OUT LIST FORM            */ 01768000
         XC    FREELIST(12),FREELIST                               0534 01769000
*       PARMREG1=ADDR(FREELIST);    /* PTR TO LFORM                  */ 01770000
*                                                                  0535 01771000
         LA    PARMREG1,FREELIST                                   0535 01772000
*       /*************************************************************/ 01773000
*       /*                                                           */ 01774000
*       /* ISSUE FREEMAIN MACRO TO FREE BUFFER CORE                  */ 01775000
*       /*                                                           */ 01776000
*       /*************************************************************/ 01777000
*                                                                  0536 01778000
*       GENERATE REFS(BINRYREG);                                   0536 01779000
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))                        01780000
*     END;                                                         0537 01781000
*                                                                  0537 01782000
*   /*****************************************************************/ 01783000
*   /*                                                               */ 01784000
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */ 01785000
*   /*                                                               */ 01786000
*   /*****************************************************************/ 01787000
*                                                                  0538 01788000
*   IF CANONUM='0'B THEN            /* IF YES, STRIP SEQUENCE FIELD  */ 01789000
@RF00529 TM    CANONUM(COMMREG),B'00000001'                        0538 01790000
         BNZ   @RF00538                                            0538 01791000
*     DO;                           /* PREPARE LINE NUMBERED RCD     */ 01792000
*                                                                  0539 01793000
*       /*************************************************************/ 01794000
*       /*                                                           */ 01795000
*       /* CHECK IF SEQUENCE FIELD STARTS IN COL ONE                 */ 01796000
*       /*                                                           */ 01797000
*       /*************************************************************/ 01798000
*                                                                  0540 01799000
*       IF CALINE='01'X THEN        /* IF YES, REMOVE SEQ FIELD      */ 01800000
         CLI   CALINE(COMMREG),X'01'                               0540 01801000
         BNE   @RF00540                                            0540 01802000
*         DO;                                                      0541 01803000
*                                                                  0541 01804000
*           /*********************************************************/ 01805000
*           /*                                                       */ 01806000
*           /* SLIDE DATA OVER SEQ FIELD                             */ 01807000
*           /*                                                       */ 01808000
*           /*********************************************************/ 01809000
*                                                                  0542 01810000
*           MVC(RECTEXT(1:RECLEN-CALENGTH-4),RECTEXT(CALENGTH+1:RECLEN- 01811000
*               4));                                               0542 01812000
*                                                                  0542 01813000
         LH    @12,RECLEN(,COMMREG)                                0542 01814000
         SLR   @08,@08                                             0542 01815000
         IC    @08,CALENGTH(,COMMREG)                              0542 01816000
         SLR   @12,@08                                             0542 01817000
         SH    @12,@CH00132                                        0542 01818000
         SLR   @08,@08                                             0542 01819000
         IC    @08,CALENGTH(,COMMREG)                              0542 01820000
         ALR   @08,COMMREG                                         0542 01821000
         EX    @12,@SM01529                                        0542 01822000
*           /*********************************************************/ 01823000
*           /*                                                       */ 01824000
*           /* ADJUST LL FIELD FOR VAR. LINES                        */ 01825000
*           /*                                                       */ 01826000
*           /*********************************************************/ 01827000
*                                                                  0543 01828000
*           RECLEN=RECLEN-CALENGTH;                                0543 01829000
         SLR   @12,@12                                             0543 01830000
         IC    @12,CALENGTH(,COMMREG)                              0543 01831000
         LCR   @12,@12                                             0543 01832000
         AH    @12,RECLEN(,COMMREG)                                0543 01833000
         STH   @12,RECLEN(,COMMREG)                                0543 01834000
*         END;                                                     0544 01835000
*       ELSE                        /* IF NO, ADJUST FOR FIXED LNS   */ 01836000
*         RECLEN=CALINE+3;          /* ADJUST LL                     */ 01837000
         B     @RC00540                                            0545 01838000
@RF00540 LA    @12,3                                               0545 01839000
         SLR   @08,@08                                             0545 01840000
         IC    @08,CALINE(,COMMREG)                                0545 01841000
         ALR   @12,@08                                             0545 01842000
         STH   @12,RECLEN(,COMMREG)                                0545 01843000
*     END;                                                         0546 01844000
@RC00540 DS    0H                                                  0547 01845000
*   RECTEXT(RECLEN-3)=' ';          /* BLANK REST OF RECORD          */ 01846000
@RF00538 LH    @12,RECLEN(,COMMREG)                                0547 01847000
         ALR   @12,COMMREG                                         0547 01848000
         MVI   RECTEXT-4(@12),C' '                                 0547 01849000
*   MVC(RECTEXT(RECLEN-2:255),RECTEXT(RECLEN-3:254));              0548 01850000
         LH    @12,RECLEN(,COMMREG)                                0548 01851000
         ALR   @12,COMMREG                                         0548 01852000
         LA    @08,257                                             0548 01853000
         SH    @08,RECLEN(,COMMREG)                                0548 01854000
         LH    @07,RECLEN(,COMMREG)                                0548 01855000
         ALR   @07,COMMREG                                         0548 01856000
         EX    @08,@SM01531                                        0548 01857000
*   RECLEN=CHARCNT+4;               /* SET LENGTH FOR DATA           */ 01858000
*                                                                  0549 01859000
         L     @12,CHARCNT                                         0549 01860000
         LA    @08,4                                               0549 01861000
         ALR   @08,@12                                             0549 01862000
         STH   @08,RECLEN(,COMMREG)                                0549 01863000
*   /*****************************************************************/ 01864000
*   /*                                                               */ 01865000
*   /* CHECK IF CHARACTER COUNT EQUALS ZERO                          */ 01866000
*   /*                                                               */ 01867000
*   /*****************************************************************/ 01868000
*                                                                  0550 01869000
*   IF CHARCNT=0 THEN               /* IF YES, BY-PASS PUTLINE       */ 01870000
         LTR   @12,@12                                             0550 01871000
         BZ    @RT00550                                            0550 01872000
*     GO TO NOPUTLN;                /* PREPARE TO ISSUE GETLINE      */ 01873000
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO OUT PARM BLOCK           */ 01874000
         XC    PTGTLIST(20),PTGTLIST                               0552 01875000
*   BINRYREG=ADDR(RECLEN);          /* PTR TO PART TO LINE TO PRINT  */ 01876000
         LA    BINRYREG,RECLEN(,COMMREG)                           0553 01877000
*   PARMREG1=IOPLPTR;               /* PTR TO PUTLINE PARMLIST       */ 01878000
         L     @12,IOPLPTR                                         0554 01879000
         LR    PARMREG1,@12                                        0554 01880000
*   IOPLIOPB=PTPBPTR;               /* PTR TO PUTLINE PARM BLOCK     */ 01881000
*                                                                  0555 01882000
         MVC   IOPLIOPB(4,@12),PTPBPTR                             0555 01883000
*   /*****************************************************************/ 01884000
*   /*                                                               */ 01885000
*   /* ISSUE PUTLINE MACRO TO CALL IKJPUTL                           */ 01886000
*   /*                                                               */ 01887000
*   /*****************************************************************/ 01888000
*                                                                  0556 01889000
*   GENERATE REFS(BINRYREG);                                       0556 01890000
         PUTLINE ,OUTPUT=((BINRYREG),TERM,SINGLE,DATA),                X01891000
               TERMPUT=(ASIS,WAIT,NOHOLD,NOBREAK),MF=(E,(1))            01892000
*   RESPECIFY                                                      0557 01893000
*    (RETCDREG) RSTD;                                              0557 01894000
*                                                                  0557 01895000
*   /*****************************************************************/ 01896000
*   /*                                                               */ 01897000
*   /* CHECK FOR SUCCESSFUL RETURN CODE FROM PUTLINE                 */ 01898000
*   /*                                                               */ 01899000
*   /*****************************************************************/ 01900000
*                                                                  0558 01901000
*   IF RETCDREG=0 THEN              /* IF YES, CONTINUE PROCESSING   */ 01902000
         LTR   RETCDREG,RETCDREG                                   0558 01903000
         BZ    @RT00558                                            0558 01904000
*     GO TO NOPUTLN;                /* PREPARE TO ISSUE GETLINE      */ 01905000
*                                                                  0560 01906000
*   /*****************************************************************/ 01907000
*   /*                                                               */ 01908000
*   /* CHECK IF NO CORE AVAILABLE                                    */ 01909000
*   /*                                                               */ 01910000
*   /*****************************************************************/ 01911000
*                                                                  0560 01912000
*   IF RETCDREG=16 THEN             /* IF YES, NOTIFY USER           */ 01913000
         CH    RETCDREG,@CH00236                                   0560 01914000
         BNE   @RF00560                                            0560 01915000
*     DO;                           /* SEND MESSAGE TO USER          */ 01916000
*NOCORMS1:                                                         0562 01917000
*       RELMSG1=270;                /* MSG IKJ52312I                 */ 01918000
NOCORMS1 MVC   RELMSG1(2),@CH01371                                 0562 01919000
*       LEV2INS=0;                  /* NO 2ND LEVEL INSERTION        */ 01920000
*                                                                  0563 01921000
         SLR   LEV2INS,LEV2INS                                     0563 01922000
*       /*************************************************************/ 01923000
*       /*                                                           */ 01924000
*       /* USE REGS TO PASS PARAMETERS                               */ 01925000
*       /*                                                           */ 01926000
*       /*************************************************************/ 01927000
*                                                                  0564 01928000
*       MSGPTR=0;                   /* ONLY ONE INSERTION            */ 01929000
         SLR   @14,@14                                             0564 01930000
         ST    @14,MSGPTR(,COMMREG)                                0564 01931000
*       MSGLEN=CASCMDLN+4;          /* LENGTH                        */ 01932000
         LA    @12,4                                               0565 01933000
         AH    @12,CASCMDLN(,COMMREG)                              0565 01934000
         STH   @12,MSGLEN(,COMMREG)                                0565 01935000
*       MSGOFF=45;                  /* OFFSET FOR INSERTION          */ 01936000
         MVC   MSGOFF(2,COMMREG),@CH01373                          0566 01937000
*       MSGTEXT=CAPTSCMD->LNUM;     /* INSERTION TEXT                */ 01938000
         MVI   MSGTEXT+8(COMMREG),C' '                             0567 01939000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0567 01940000
         L     @12,CAPTSCMD(,COMMREG)                              0567 01941000
         MVC   MSGTEXT(8,COMMREG),LNUM(@12)                        0567 01942000
*       LEV1INS=ADDR(MSGPTR);       /* PTR TO INSERTION              */ 01943000
         LA    LEV1INS,MSGPTR(,COMMREG)                            0568 01944000
*       RELMSG2=0;                  /* NO SECOND LEVEL MSG           */ 01945000
         STH   @14,RELMSG2                                         0569 01946000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 01947000
         BAL   @14,SENDMSG                                         0570 01948000
*       CHRETCD=8;                  /* INDICATE FLUSH                */ 01949000
         MVC   CHRETCD(4),@CF00058                                 0571 01950000
*       GO TO CHGEXIT3;             /* RETURN TO CALLER              */ 01951000
         B     CHGEXIT3                                            0572 01952000
*     END;                                                         0573 01953000
*                                                                  0573 01954000
*   /*****************************************************************/ 01955000
*   /*                                                               */ 01956000
*   /* CHECK IF ATTENTION ISSUED                                     */ 01957000
*   /*                                                               */ 01958000
*   /*****************************************************************/ 01959000
*                                                                  0574 01960000
*   IF RETCDREG=4 THEN              /* IF YES, RETURN TO CALLER      */ 01961000
@RF00560 CH    RETCDREG,@CH00602                                   0574 01962000
         BE    @RT00574                                            0574 01963000
*     GO TO NOTEXT;                 /* BEGIN EXIT PROCESSING         */ 01964000
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */ 01965000
         LR    RETCODE,RETCDREG                                    0576 01966000
*   RESPECIFY                                                      0577 01967000
*    (RETCDREG) UNRSTD;                                            0577 01968000
*   MSGTEXT='PUTLINE';              /* INSERTION TEXT                */ 01969000
         MVI   MSGTEXT+7(COMMREG),C' '                             0578 01970000
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0578 01971000
         MVC   MSGTEXT(7,COMMREG),@CC01374                         0578 01972000
*   MSGLEN=LENGTH('PUTLINE')+4;     /* LENGTH OF INSERTION           */ 01973000
         MVC   MSGLEN(2,COMMREG),@CH00033                          0579 01974000
*SYSERR1:                                                          0580 01975000
*   ;                               /* FINISH INSERTION & ISSUE MSG  */ 01976000
*                                                                  0580 01977000
SYSERR1  DS    0H                                                  0581 01978000
*   /*****************************************************************/ 01979000
*   /*                                                               */ 01980000
*   /* CONVERT RETURN CODE TO PRINTABLE CHARACTER                    */ 01981000
*   /*                                                               */ 01982000
*   /*****************************************************************/ 01983000
*                                                                  0581 01984000
*   RETCDREG=RETCODE;               /* RESTORE RET CODE TO REG 15    */ 01985000
         LR    RETCDREG,RETCODE                                    0581 01986000
*   GENERATE REFS(RETCDREG,COMMREG,PACKAREA);                      0582 01987000
         CVD   RETCDREG,PACKAREA                CONVERT TO DECIMAL      01988000
         UNPK  MSGTEXT2(3,COMMREG),PACKAREA+6(2)   UNPK NUM             01989000
         MVN   MSGTEXT2(2,COMMREG),MSGTEXT2+1(COMMREG) SET SIGN         01990000
*   RELMSG1=271;                    /* RELATIVE MSG NUMBER           */ 01991000
         MVC   RELMSG1(2),@CH01381                                 0583 01992000
*   LEV1INS=0;                      /* NO FIRST LEVEL INSERTION      */ 01993000
         SLR   LEV1INS,LEV1INS                                     0584 01994000
*   RELMSG2=1;                      /* SECOND LEVEL MSG              */ 01995000
         MVC   RELMSG2(2),@CH00060                                 0585 01996000
*   MSGOFF=10;                      /* OFFSET FOR INSERTION TEXT     */ 01997000
         MVC   MSGOFF(2,COMMREG),@CH00541                          0586 01998000
*   MSGPTR=ADDR(MSGPTR2);           /* CHAIN MESSAGES                */ 01999000
         LA    @12,MSGPTR2(,COMMREG)                               0587 02000000
         ST    @12,MSGPTR(,COMMREG)                                0587 02001000
*   MSGPTR2=0;                      /* INDICATE LAST INSERTION       */ 02002000
         SLR   @12,@12                                             0588 02003000
         ST    @12,MSGPTR2(,COMMREG)                               0588 02004000
*   MSGLEN2=6;                      /* LENGTH OF INSERTION           */ 02005000
         MVC   MSGLEN2(2,COMMREG),@CH00510                         0589 02006000
*   MSGOFF2=22;                     /* OFFSET FOR INSERTION          */ 02007000
         MVC   MSGOFF2(2,COMMREG),@CH01361                         0590 02008000
*   LEV2INS=ADDR(MSGPTR);           /* PTR TO INSERTION              */ 02009000
         LA    LEV2INS,MSGPTR(,COMMREG)                            0591 02010000
*   CALL SENDMSG;                   /* SEND MESSAGE TO USER          */ 02011000
         BAL   @14,SENDMSG                                         0592 02012000
*   CHRETCD=8;                      /* INDICATE FLUSH                */ 02013000
         MVC   CHRETCD(4),@CF00058                                 0593 02014000
*   GO TO CHGEXIT3;                 /* RETURN TO CALLER              */ 02015000
*                                                                  0594 02016000
         B     CHGEXIT3                                            0594 02017000
*   /*****************************************************************/ 02018000
*   /*                                                               */ 02019000
*   /* INVOKE GETLINE SERVICE ROUTINE TO OBTAIN REPLACEMENT STRING   */ 02020000
*   /*                                                               */ 02021000
*   /*****************************************************************/ 02022000
*                                                                  0595 02023000
*NOPUTLN:                                                          0595 02024000
*   PTGTLIST=PTGTLIST&&PTGTLIST;    /* ZERO OUT PARM BLOCK           */ 02025000
NOPUTLN  XC    PTGTLIST(20),PTGTLIST                               0595 02026000
*   PARMREG1=IOPLPTR;               /* PTR TO GETLINE PARMLIST       */ 02027000
         L     @12,IOPLPTR                                         0596 02028000
         LR    PARMREG1,@12                                        0596 02029000
*   IOPLIOPB=GTPBPTR;               /* PTR TO GETLINE PARM BLOCK     */ 02030000
*                                                                  0597 02031000
         MVC   IOPLIOPB(4,@12),GTPBPTR                             0597 02032000
*   /*****************************************************************/ 02033000
*   /*                                                               */ 02034000
*   /* ISSUE GETLINE MACRO TO CALL IKJGETL                           */ 02035000
*   /*                                                               */ 02036000
*   /*****************************************************************/ 02037000
*                                                                  0598 02038000
*   GENERATE;                                                      0598 02039000
         GETLINE ,INPUT=(TERM,LOGICAL),                                X02040000
               TERMGET=(EDIT,WAIT),MF=(E,(1))                           02041000
*   RESPECIFY                                                      0599 02042000
*    (RETCDREG) RSTD;                                              0599 02043000
*                                                                  0599 02044000
*   /*****************************************************************/ 02045000
*   /*                                                               */ 02046000
*   /* CHECK FOR SUCCESSFUL RETURN FROM GETLINE                      */ 02047000
*   /*                                                               */ 02048000
*   /*****************************************************************/ 02049000
*                                                                  0600 02050000
*   IF RETCDREG=0 THEN              /* IF YES, CONTINUE PROCESSING   */ 02051000
         LTR   RETCDREG,RETCDREG                                   0600 02052000
         BZ    @RT00600                                            0600 02053000
*     GO TO SUCCGET;                /* PREPARE TO FORM CHANGED LINE  */ 02054000
*                                                                  0602 02055000
*   /*****************************************************************/ 02056000
*   /*                                                               */ 02057000
*   /* CHECK IF NO CORE AVAILABLE                                    */ 02058000
*   /*                                                               */ 02059000
*   /*****************************************************************/ 02060000
*                                                                  0602 02061000
*   IF RETCDREG=24 THEN             /* IF YES, NOTIFY USER           */ 02062000
         CH    RETCDREG,@CH00077                                   0602 02063000
         BE    @RT00602                                            0602 02064000
*     GO TO NOCORMS1;               /* SEND MESSAGE TO USER          */ 02065000
*                                                                  0603 02066000
*   /*****************************************************************/ 02067000
*   /*                                                               */ 02068000
*   /* CHECK IF ATTENTION ISSUED                                     */ 02069000
*   /*                                                               */ 02070000
*   /*****************************************************************/ 02071000
*                                                                  0604 02072000
*   IF RETCDREG=8 THEN              /* IF YES, EXIT-NO MSG           */ 02073000
         CH    RETCDREG,@CH00058                                   0604 02074000
         BE    @RT00604                                            0604 02075000
*     GO TO NOTEXT;                 /* BEGIN EXIT PROCESSING         */ 02076000
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */ 02077000
         LR    RETCODE,RETCDREG                                    0606 02078000
*   RESPECIFY                                                      0607 02079000
*    (RETCDREG) UNRSTD;                                            0607 02080000
*   MSGTEXT='GETLINE';              /* INSERTION TEXT                */ 02081000
         MVI   MSGTEXT+7(COMMREG),C' '                             0608 02082000
         MVC   MSGTEXT+8(64,COMMREG),MSGTEXT+7(COMMREG)            0608 02083000
         MVC   MSGTEXT(7,COMMREG),@CC01377                         0608 02084000
*   MSGLEN=LENGTH('GETLINE')+4;     /* LENGTH OF MSG INSERT          */ 02085000
         MVC   MSGLEN(2,COMMREG),@CH00033                          0609 02086000
*   GO TO SYSERR1;                  /* BRANCH TO NOTIFY USER         */ 02087000
*                                                                  0610 02088000
         B     SYSERR1                                             0610 02089000
*   /*****************************************************************/ 02090000
*   /*                                                               */ 02091000
*   /* GETLINE SUCCESSFUL -- OVERLAY ORIGINAL TEXT WITH TERMINAL     */ 02092000
*   /* INPUT AND UPDATE CONTROL PORTION OF RECORD                    */ 02093000
*   /*                                                               */ 02094000
*   /*****************************************************************/ 02095000
*                                                                  0611 02096000
*SUCCGET:                                                          0611 02097000
*   RECTEXT(RECLEN-3:RECLEN+BFRLEN-2*4)=BFRTXT;/* ADD CHANGED TO   0611 02098000
*                                      ORIGINAL TXT                  */ 02099000
SUCCGET  LH    @08,RECLEN(,COMMREG)                                0611 02100000
         ALR   @08,COMMREG                                         0611 02101000
         L     @07,GTPBPTR                                         0611 02102000
         L     @07,GTPBIBUF(,@07)                                  0611 02103000
         LH    @05,BFRLEN(,@07)                                    0611 02104000
         LR    @15,@05                                             0611 02105000
         SH    @15,@CH00132                                        0611 02106000
         EX    @15,@SM01533                                        0611 02107000
*   RECLEN=BFRLEN+RECLEN-4;         /* NEW LENGTH OF DATA            */ 02108000
         LH    @08,RECLEN(,COMMREG)                                0612 02109000
         ALR   @08,@05                                             0612 02110000
         SH    @08,@CH00602                                        0612 02111000
         STH   @08,RECLEN(,COMMREG)                                0612 02112000
*   FREEAREA=GTPBIBUF;              /* PTR TO BUFFER                 */ 02113000
         ST    @07,FREEAREA                                        0613 02114000
*   FREELEN=BFRLEN;                 /* LENGTH OF BUFFER              */ 02115000
         ST    @05,FREELEN                                         0614 02116000
*   BINRYREG=ADDR(FREEAREA);        /* PTR TO AREA INFO              */ 02117000
         LA    BINRYREG,FREEAREA                                   0615 02118000
*   FREELIST=FREELIST&&FREELIST;    /* ZERO OUT LIST FORM            */ 02119000
         XC    FREELIST(12),FREELIST                               0616 02120000
*   PARMREG1=ADDR(FREELIST);        /* PTR TO LIST FORM              */ 02121000
*                                                                  0617 02122000
         LA    PARMREG1,FREELIST                                   0617 02123000
*   /*****************************************************************/ 02124000
*   /*                                                               */ 02125000
*   /* ISSUE FREEMAIN MACRO TO FREE INPUT BUFFER AREA                */ 02126000
*   /*                                                               */ 02127000
*   /*****************************************************************/ 02128000
*                                                                  0618 02129000
*   GENERATE REFS(BINRYREG);                                       0618 02130000
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))                        02131000
*   LETXTPTR=ADDR(RECLEN);          /* PTR TO TEXT                   */ 02132000
         LA    @08,RECLEN(,COMMREG)                                0619 02133000
         ST    @08,LETXTPTR                                        0619 02134000
*   LECODE='00'X;                   /* NOT DELIMITED STRING CODE     */ 02135000
         MVI   LECODE,X'00'                                        0620 02136000
*   CALL LINEEDIT;                  /* LINE EDIT TEXT                */ 02137000
         BAL   @14,LINEEDIT                                        0621 02138000
*                                   /* PREPARE TO UPDATE DATA SET    */ 02139000
*                                                                  0622 02140000
*   /*****************************************************************/ 02141000
*   /*                                                               */ 02142000
*   /* CHECK IF ALL CHANGES COMPLETED ON PREVIOUS LINES AND THEIR    */ 02143000
*   /* ASSOCIATED OVERFLOW LINES                                     */ 02144000
*   /*                                                               */ 02145000
*   /*****************************************************************/ 02146000
*                                                                  0622 02147000
*   IF KEYFLD>VERKEY+VERCNT THEN    /* IF YES, RESET OVERFLOW CNTR   */ 02148000
         L     @08,VERKEY                                          0622 02149000
         AL    @08,VERCNT                                          0622 02150000
         C     @08,KEYFLD(,COMMREG)                                0622 02151000
         BNL   @RF00622                                            0622 02152000
*     VERCNT=0;                     /* SET COUNTER TO ZERO           */ 02153000
*                                                                  0623 02154000
         SLR   @08,@08                                             0623 02155000
         ST    @08,VERCNT                                          0623 02156000
*   /*****************************************************************/ 02157000
*   /*                                                               */ 02158000
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */ 02159000
*   /*                                                               */ 02160000
*   /*****************************************************************/ 02161000
*                                                                  0624 02162000
*   IF RETCODE=4 THEN               /* IF YES, PROCESS CONDITION     */ 02163000
@RF00622 CH    RETCODE,@CH00602                                    0624 02164000
         BNE   @RF00624                                            0624 02165000
*     DO;                           /* PROCESS LINE OVERFLOW         */ 02166000
*                                                                  0625 02167000
*       /*************************************************************/ 02168000
*       /*                                                           */ 02169000
*       /* CHECK IF NON-LINE NUMBERED TEXT DATA SET TYPE             */ 02170000
*       /*                                                           */ 02171000
*       /*************************************************************/ 02172000
*                                                                  0626 02173000
*       IF CANONUM='1'B&CADSCODE=CATEXT THEN/* IF YES, BRANCH TO   0626 02174000
*                                      PROCESS                       */ 02175000
         TM    CANONUM(COMMREG),B'00000001'                        0626 02176000
         BNO   @RF00626                                            0626 02177000
         CLI   CADSCODE(COMMREG),X'05'                             0626 02178000
         BNE   @RF00626                                            0626 02179000
*         DO;                       /* CREATE OVERFLOW LINE          */ 02180000
*           J=KEYFLD;               /* SAVE KEY OF CHANGED RECORD    */ 02181000
         L     J,KEYFLD(,COMMREG)                                  0628 02182000
*           GO TO LNOVRFL;          /* PROCESS OVERFLOW LINES        */ 02183000
         B     LNOVRFL                                             0629 02184000
*         END;                                                     0630 02185000
*       RELMSG1=1293;               /* MSG IKJ52507I                 */ 02186000
@RF00626 MVC   RELMSG1(2),@CH01419                                 0631 02187000
*       BINRYREG=CALRECL-4;         /* DATA SET LINE SIZE            */ 02188000
*                                                                  0632 02189000
         LH    BINRYREG,CALRECL(,COMMREG)                          0632 02190000
         SH    BINRYREG,@CH00602                                   0632 02191000
*       /*************************************************************/ 02192000
*       /*                                                           */ 02193000
*       /* ----------------------------------------- CONVERT TO      */ 02194000
*       /* DECIMAL, UNPACK AND SET ZONE SIGN FOR EBCDIC CHARATERS    */ 02195000
*       /* ----------------------------------------- CONVERT NUMBER  */ 02196000
*       /* TO DECIMAL AND UNPACK DECIMAL RESULT                      */ 02197000
*       /*                                                           */ 02198000
*       /*************************************************************/ 02199000
*                                                                  0633 02200000
*       GENERATE REFS(BINRYREG,PACKAREA);                          0633 02201000
*                                                                  0633 02202000
         CVD   BINRYREG,PACKAREA                                        02203000
         UNPK  PACKAREA(3),PACKAREA+6(2)                                02204000
*       /*************************************************************/ 02205000
*       /*                                                           */ 02206000
*       /* SET SIGN ZONE                                             */ 02207000
*       /*                                                           */ 02208000
*       /*************************************************************/ 02209000
*                                                                  0634 02210000
*       PACKAREA(3)=PACKAREA(3)|'F0'X;                             0634 02211000
         OI    PACKAREA+2,X'F0'                                    0634 02212000
*       MSGPTR2=0;                  /* NO 2ND INSERTION              */ 02213000
         SLR   @12,@12                                             0635 02214000
         ST    @12,MSGPTR2(,COMMREG)                               0635 02215000
*       MSGOFF2=25;                 /* OFFSET FOR INSERTION          */ 02216000
*                                                                  0636 02217000
         MVC   MSGOFF2(2,COMMREG),@CH01421                         0636 02218000
*       /*************************************************************/ 02219000
*       /*                                                           */ 02220000
*       /* REMOVE ALL LEADING ZEROES FROM MSG INSERT                 */ 02221000
*       /*                                                           */ 02222000
*       /*************************************************************/ 02223000
*                                                                  0637 02224000
*       DO I=1 TO 3;                                               0637 02225000
*                                                                  0637 02226000
         LA    I,1                                                 0637 02227000
@DL00637 DS    0H                                                  0638 02228000
*         /***********************************************************/ 02229000
*         /*                                                         */ 02230000
*         /* CHECK IF NON-ZERO CHARACTER FOUND                       */ 02231000
*         /*                                                         */ 02232000
*         /***********************************************************/ 02233000
*                                                                  0638 02234000
*         IF PACKAREA(I)^='0' THEN  /* IF YES, BRANCH OJT            */ 02235000
         LA    @12,PACKAREA-1(I)                                   0638 02236000
         CLI   0(@12),C'0'                                         0638 02237000
         BNE   @RT00638                                            0638 02238000
*           GO TO OUT;              /* FIRST NON-ZERO DIGIT          */ 02239000
*       END;                        /* END OF DO LOOP. NO FALL     0640 02240000
*                                      THROUGH, SINCE ALWAYS HAVE  0640 02241000
*                                      VALID NONZERO VALUE.          */ 02242000
         AL    I,@CF00060                                          0640 02243000
         CH    I,@CH00164                                          0640 02244000
         BNH   @DL00637                                            0640 02245000
*OUT:                                                              0641 02246000
*       MSGTEXT2=PACKAREA(I:3);     /* MOVE TEXT                     */ 02247000
OUT      MVI   MSGTEXT2+1(COMMREG),C' '                            0641 02248000
         MVC   MSGTEXT2+2(70,COMMREG),MSGTEXT2+1(COMMREG)          0641 02249000
         LA    @12,3                                               0641 02250000
         SLR   @12,I                                               0641 02251000
         LA    @08,PACKAREA-1(I)                                   0641 02252000
         EX    @12,@SM01535                                        0641 02253000
*       MSGLEN2=8-I;                /* LENGTH OF INSERTION           */ 02254000
         LA    @12,8                                               0642 02255000
         SLR   @12,I                                               0642 02256000
         STH   @12,MSGLEN2(,COMMREG)                               0642 02257000
*       RELMSG2=1;                  /* RELATIVE SECOND MESSAGE       */ 02258000
*                                                                  0643 02259000
         MVC   RELMSG2(2),@CH00060                                 0643 02260000
*       /*************************************************************/ 02261000
*       /*                                                           */ 02262000
*       /* CHECK IF DATA SET IS LINE NUMBERED                        */ 02263000
*       /*                                                           */ 02264000
*       /*************************************************************/ 02265000
*                                                                  0644 02266000
*       IF CANONUM='1'B THEN        /* IF NO, NO LINE NUMBER REFER   */ 02267000
         TM    CANONUM(COMMREG),B'00000001'                        0644 02268000
         BNO   @RF00644                                            0644 02269000
*         LEV1INS=0;                /* NO INSERTION TEXT             */ 02270000
         SLR   LEV1INS,LEV1INS                                     0645 02271000
*       ELSE                        /* IF YES, INSERT NUMBER IN MSG  */ 02272000
*         DO;                       /* PREPARE TRUNCATION MESSAGE    */ 02273000
         B     @RC00644                                            0646 02274000
@RF00644 DS    0H                                                  0647 02275000
*           BINRYREG=KEYFLD;        /* BINARY LNUMBR                 */ 02276000
*                                                                  0647 02277000
         L     BINRYREG,KEYFLD(,COMMREG)                           0647 02278000
*           /*********************************************************/ 02279000
*           /*                                                       */ 02280000
*           /* ------------------------------- CONVERT TO DECIMAL,   */ 02281000
*           /* UNPACK AND SET ZONE SIGN FOR EBCDIC                   */ 02282000
*           /* -------------------------------                       */ 02283000
*           /*                                                       */ 02284000
*           /*********************************************************/ 02285000
*                                                                  0648 02286000
*           GENERATE REFS(BINRYREG);                               0648 02287000
         CVD   BINRYREG,PACKTEMP               CONVERT TO DECIMAL       02288000
         UNPK  PACKAREA(8),PACKTEMP(8)  UNPK NUM                        02289000
*           PACKAREA(8)=PACKAREA(8)|'F0'X;                         0649 02290000
*                                                                  0649 02291000
         OI    PACKAREA+7,X'F0'                                    0649 02292000
*           /*********************************************************/ 02293000
*           /*                                                       */ 02294000
*           /* REMOVE ALL LEADING ZEROES                             */ 02295000
*           /*                                                       */ 02296000
*           /*********************************************************/ 02297000
*                                                                  0650 02298000
*           DO I=1 TO 7;                                           0650 02299000
*                                                                  0650 02300000
         LA    I,1                                                 0650 02301000
@DL00650 DS    0H                                                  0651 02302000
*             /*******************************************************/ 02303000
*             /*                                                     */ 02304000
*             /* CHECK IF FIRST SIGNIFICANT DIGIT FOUND              */ 02305000
*             /*                                                     */ 02306000
*             /*******************************************************/ 02307000
*                                                                  0651 02308000
*             IF PACKAREA(I)^='0' THEN/* IF YES, BRANCH OUT          */ 02309000
         LA    @12,PACKAREA-1(I)                                   0651 02310000
         CLI   0(@12),C'0'                                         0651 02311000
         BNE   @RT00651                                            0651 02312000
*               GO TO FOUND;        /* DGT FOUND                     */ 02313000
*           END;                    /* END OF DO LOOP. FALL THROUGH     02314000
*                                      ONLY IF VALUE IS ZERO. MINIMUM   02315000
*                                      OF ONE CHARACTER MUST BE SENT    02316000
*                                      AS LINE NUMBER.               */ 02317000
         AL    I,@CF00060                                          0653 02318000
         CH    I,@CH00126                                          0653 02319000
         BNH   @DL00650                                            0653 02320000
*           I=8;                    /* SET TO SIGNIF. POSITION       */ 02321000
         LA    I,8                                                 0654 02322000
*FOUND:                                                            0655 02323000
*           MSGTEXT=PACKAREA(I:8);  /* MOVE TEXT                     */ 02324000
FOUND    MVI   MSGTEXT+1(COMMREG),C' '                             0655 02325000
         MVC   MSGTEXT+2(70,COMMREG),MSGTEXT+1(COMMREG)            0655 02326000
         LA    @12,8                                               0655 02327000
         SLR   @12,I                                               0655 02328000
         LA    @08,PACKAREA-1(I)                                   0655 02329000
         EX    @12,@SM01537                                        0655 02330000
*           MSGOFF=15;              /* OFFSET FOR INS                */ 02331000
         MVC   MSGOFF(2,COMMREG),@CH00065                          0656 02332000
*           MSGLEN=13-I;            /* LENGTH OF TXT                 */ 02333000
         LA    @12,13                                              0657 02334000
         SLR   @12,I                                               0657 02335000
         STH   @12,MSGLEN(,COMMREG)                                0657 02336000
*           MSGPTR=0;               /* NO 2ND INSERTION              */ 02337000
         SLR   @12,@12                                             0658 02338000
         ST    @12,MSGPTR(,COMMREG)                                0658 02339000
*           LEV1INS=ADDR(MSGAREA);  /* PTR TO INSERT                 */ 02340000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0659 02341000
*         END;                                                     0660 02342000
*       LEV2INS=ADDR(MSGPTR2);      /* PTR TO MSG INSERT             */ 02343000
@RC00644 LA    LEV2INS,MSGPTR2(,COMMREG)                           0661 02344000
*       CALL SENDMSG;               /* SEND MESSAGE TO USER          */ 02345000
         BAL   @14,SENDMSG                                         0662 02346000
*     END;                                                         0663 02347000
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */ 02348000
@RF00624 MVI   UTCODE,X'20'                                        0664 02349000
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO RECORD TO BE WRITTEN   */ 02350000
         LA    @08,KEYFLD(,COMMREG)                                0665 02351000
         ST    @08,KEYPTR                                          0665 02352000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 02353000
         OI    PLISTEND,B'10000000'                                0666 02354000
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */ 02355000
         SLR   @08,@08                                             0667 02356000
         ST    @08,AREAPTR                                         0667 02357000
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */ 02358000
*                                                                  0668 02359000
         BAL   @14,RDWRTRTN                                        0668 02360000
*   /*****************************************************************/ 02361000
*   /*                                                               */ 02362000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 02363000
*   /*                                                               */ 02364000
*   /*****************************************************************/ 02365000
*                                                                  0669 02366000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 02367000
         CH    RETCODE,@CH00145                                    0669 02368000
         BE    @RT00669                                            0669 02369000
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */ 02370000
*   VERKEY=KEYFLD;                  /* SET * VALUE                   */ 02371000
         MVC   VERKEY(4),KEYFLD(COMMREG)                           0671 02372000
*                                                                  0672 02373000
*   /*****************************************************************/ 02374000
*   /*                                                               */ 02375000
*   /* CHECK IF DATA SET TYPE BASIC OR IPLI                          */ 02376000
*   /*                                                               */ 02377000
*   /*****************************************************************/ 02378000
*                                                                  0672 02379000
*   IF CADSCODE=CABASIC|CADSCODE=CAIPLI THEN/* IF YES, UPDATE REVERSE   02380000
*                                      POLISH DATA SET               */ 02381000
         CLI   CADSCODE(COMMREG),X'20'                             0672 02382000
         BE    @RT00672                                            0672 02383000
         CLI   CADSCODE(COMMREG),X'21'                             0672 02384000
         BNE   @RF00672                                            0672 02385000
@RT00672 DS    0H                                                  0673 02386000
*     DO;                           /* PREPARE PARAMETER LIST AND  0673 02387000
*                                      CALL PROCESSOR IF AVAILABLE   */ 02388000
*       I=KEYFLD;                   /* SAVE KEY FIELD                */ 02389000
         L     I,KEYFLD(,COMMREG)                                  0674 02390000
*       J=RECLEN;                   /* USE REG TO SAVE LL FIELD      */ 02391000
*                                                                  0675 02392000
         LH    J,RECLEN(,COMMREG)                                  0675 02393000
*       /*************************************************************/ 02394000
*       /*                                                           */ 02395000
*       /* CHECK IF FIXED RECORD FORMAT                              */ 02396000
*       /*                                                           */ 02397000
*       /*************************************************************/ 02398000
*                                                                  0676 02399000
*       IF CARECFM='1'B THEN        /* IF YES, REMOVE CONTROL WORD   */ 02400000
         TM    CARECFM(COMMREG),B'01000000'                        0676 02401000
         BNO   @RF00676                                            0676 02402000
*         DO;                       /* INIT BUFFER PASSED            */ 02403000
*           SCPTR2=0;               /* NO CHAINED BFRS               */ 02404000
         SLR   @12,@12                                             0678 02405000
         ST    @12,SCPTR2(,COMMREG)                                0678 02406000
*           SCCNT2=1;               /* ONE RECORD SENT               */ 02407000
         MVI   SCCNT2(COMMREG),X'01'                               0679 02408000
*           CASYNBFR=ADDR(SCPTR2);  /* BFR PTR                       */ 02409000
         LA    @12,SCPTR2(,COMMREG)                                0680 02410000
         ST    @12,CASYNBFR(,COMMREG)                              0680 02411000
*         END;                                                     0681 02412000
*       ELSE                        /* IF NO, VARIABLE FORMAT        */ 02413000
*         DO;                       /* INIT BUFFER PASSED            */ 02414000
         B     @RC00676                                            0682 02415000
@RF00676 DS    0H                                                  0683 02416000
*           SCPTR1=0;               /* NO CHAINED BFRS               */ 02417000
         SLR   @12,@12                                             0683 02418000
         ST    @12,SCPTR1(,COMMREG)                                0683 02419000
*           SCCNT1=1;               /* ONE RECORD SENT               */ 02420000
         MVI   SCCNT1(COMMREG),X'01'                               0684 02421000
*           CASYNBFR=ADDR(SCPTR1);  /* BFR PTR                       */ 02422000
         LA    @12,SCPTR1(,COMMREG)                                0685 02423000
         ST    @12,CASYNBFR(,COMMREG)                              0685 02424000
*         END;                                                     0686 02425000
*                                                                  0686 02426000
*       /*************************************************************/ 02427000
*       /*                                                           */ 02428000
*       /* CHECK IF SYNTAX CHECKER AVAILABLE                         */ 02429000
*       /*                                                           */ 02430000
*       /*************************************************************/ 02431000
*                                                                  0687 02432000
*       IF CAPTCHK^=0 THEN          /* IF YES, PASS LINE TO CHECKER  */ 02433000
@RC00676 L     @12,CAPTCHK(,COMMREG)                               0687 02434000
         LTR   @12,@12                                             0687 02435000
         BZ    @RF00687                                            0687 02436000
*         DO;                       /* CALL PROCESSOR                */ 02437000
*           ENTRYCD='10000'B;       /* ENTRY CODE FOR ITF            */ 02438000
         MVI   ENTRYCD(COMMREG),B'10000000'                        0689 02439000
*           PARMREG1=ADDR(CASYNLST);/* PTR TO PARMLIST               */ 02440000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0690 02441000
*           CALL CHECKER;           /* UPDATE ITF DATA SET           */ 02442000
         LR    @15,@12                                             0691 02443000
         BALR  @14,@15                                             0691 02444000
*           RESPECIFY                                              0692 02445000
*            (RETCDREG) RSTD;                                      0692 02446000
*           KEYFLD=I;               /* RESTORE KEY FIELD             */ 02447000
         ST    I,KEYFLD(,COMMREG)                                  0693 02448000
*           RECLEN=J;               /* RESTORE LL FIELD              */ 02449000
*                                                                  0694 02450000
         STH   J,RECLEN(,COMMREG)                                  0694 02451000
*           /*********************************************************/ 02452000
*           /*                                                       */ 02453000
*           /* CHECK FOR PROCESSOR ERROR MESSAGE                     */ 02454000
*           /*                                                       */ 02455000
*           /*********************************************************/ 02456000
*                                                                  0695 02457000
*           IF RETCDREG=4 THEN      /* YES, CHECK IF SCAN ON         */ 02458000
*                                                                  0695 02459000
         CH    RETCDREG,@CH00602                                   0695 02460000
         BNE   @RF00695                                            0695 02461000
*             /*******************************************************/ 02462000
*             /*                                                     */ 02463000
*             /* CHECK IF SCAN IS ON                                 */ 02464000
*             /*                                                     */ 02465000
*             /*******************************************************/ 02466000
*                                                                  0696 02467000
*             IF CASCANSW='1'B THEN /* YES,INDICATE FLUSH            */ 02468000
         TM    CASCANSW(COMMREG),B'00010000'                       0696 02469000
         BNO   @RF00696                                            0696 02470000
*               DO;                                                0697 02471000
*                 CHRETCD=8;        /* INDICATE FLUSH                */ 02472000
         MVC   CHRETCD(4),@CF00058                                 0698 02473000
*                 GO TO CHGEXIT3;   /* GO TO EXIT                    */ 02474000
         B     CHGEXIT3                                            0699 02475000
*               END;                                               0700 02476000
*             ELSE                  /* NO SCAN THEN CHECK ATTENTION  */ 02477000
*               GO TO CHKATTN;                                     0701 02478000
*           ELSE                                                   0702 02479000
*             ;                                                    0702 02480000
*                                                                  0702 02481000
@RF00695 DS    0H                                                  0703 02482000
*           /*********************************************************/ 02483000
*           /*                                                       */ 02484000
*           /* CHECK FOR SUCCESSFUL RETURN                           */ 02485000
*           /*                                                       */ 02486000
*           /*********************************************************/ 02487000
*                                                                  0703 02488000
*           IF RETCDREG=0 THEN      /* IF YES, CONTINUE PROCESSING   */ 02489000
         LTR   RETCDREG,RETCDREG                                   0703 02490000
         BZ    @RT00703                                            0703 02491000
*             GO TO CHKATTN;        /* BEGIN EXIT PRCSS              */ 02492000
*                                                                  0704 02493000
*           /*********************************************************/ 02494000
*           /*                                                       */ 02495000
*           /* CHECK IF NOT ENOUGH CORE AVAILABLE                    */ 02496000
*           /*                                                       */ 02497000
*           /*********************************************************/ 02498000
*                                                                  0705 02499000
*           IF RETCDREG=16 THEN     /* IF YES, NOTIFY USER           */ 02500000
         LA    @14,16                                              0705 02501000
         CR    RETCDREG,@14                                        0705 02502000
         BE    @RT00705                                            0705 02503000
*             GO TO NOCORMS1;       /* NOTIFY USER                   */ 02504000
*                                                                  0706 02505000
*           /*********************************************************/ 02506000
*           /*                                                       */ 02507000
*           /* CHECK IF PROCESSOR FAILED                             */ 02508000
*           /*                                                       */ 02509000
*           /*********************************************************/ 02510000
*                                                                  0707 02511000
*           IF RETCDREG=20 THEN     /* IF YES, TERMINATE             */ 02512000
         CH    RETCDREG,@CH00136                                   0707 02513000
         BNE   @RF00707                                            0707 02514000
*             DO;                   /* NOTIFY IKJEBEMA AND EXIT      */ 02515000
*               CHRETCD=16;         /* SET RETURN CD                 */ 02516000
         ST    @14,CHRETCD                                         0709 02517000
*               GO TO NOTEXT;       /* BEGIN EXIT PROCESS            */ 02518000
         B     NOTEXT                                              0710 02519000
*             END;                                                 0711 02520000
*           RETCODE=RETCDREG;       /* SAVE RETURN CODE              */ 02521000
@RF00707 LR    RETCODE,RETCDREG                                    0712 02522000
*           RESPECIFY                                              0713 02523000
*            (RETCDREG) UNRSTD;                                    0713 02524000
*           MSGTEXT(1:8)=CASYNAME;  /* INSERTION                     */ 02525000
*                                                                  0714 02526000
         MVC   MSGTEXT(8,COMMREG),CASYNAME(COMMREG)                0714 02527000
*           /*********************************************************/ 02528000
*           /*                                                       */ 02529000
*           /* REMOVE ALL TRAILING BLANKS                            */ 02530000
*           /*                                                       */ 02531000
*           /*********************************************************/ 02532000
*                                                                  0715 02533000
*           DO I=8 TO 1 BY-1;                                      0715 02534000
*                                                                  0715 02535000
         LA    I,8                                                 0715 02536000
@DL00715 DS    0H                                                  0716 02537000
*             /*******************************************************/ 02538000
*             /*                                                     */ 02539000
*             /* CHECK IF LAST NON-BLANK FOUND                       */ 02540000
*             /*                                                     */ 02541000
*             /*******************************************************/ 02542000
*                                                                  0716 02543000
*             IF MSGTEXT(I)^=' ' THEN/* IF YES, END OF INSERT FOUND  */ 02544000
         LR    @08,COMMREG                                         0716 02545000
         ALR   @08,I                                               0716 02546000
         CLI   MSGTEXT-1(@08),C' '                                 0716 02547000
         BNE   @RT00716                                            0716 02548000
*               GO TO LPOUT;        /* EXIT FROM LOOP                */ 02549000
*           END;                    /* END OF DO LOOP. NO FALL     0718 02550000
*                                      THROUGH, SINCE ALWAYS HAVE  0718 02551000
*                                      VALID MODULE NAME.            */ 02552000
         BCTR  I,0                                                 0718 02553000
         LTR   I,I                                                 0718 02554000
         BP    @DL00715                                            0718 02555000
*LPOUT:                                                            0719 02556000
*           MSGLEN=I+4;             /* LENGTH OF INSERTION           */ 02557000
LPOUT    LA    @08,4                                               0719 02558000
         ALR   @08,I                                               0719 02559000
         STH   @08,MSGLEN(,COMMREG)                                0719 02560000
*           GO TO SYSERR1;          /* BRANCH TO NOTIFY USER         */ 02561000
         B     SYSERR1                                             0720 02562000
*         END;                                                     0721 02563000
*       KEYFLD=I;                   /* RESTORE KEY FIELD             */ 02564000
@RF00687 ST    I,KEYFLD(,COMMREG)                                  0722 02565000
*       RECLEN=J;                   /* RESTORE LL FIELD              */ 02566000
         STH   J,RECLEN(,COMMREG)                                  0723 02567000
*     END;                                                         0724 02568000
*   GO TO CHKATTN;                  /* BRANCH TO ATTENTION CHECK     */ 02569000
         B     CHKATTN                                             0725 02570000
*LNOVRFL:                                                          0726 02571000
*   START=RECLEN-4;                 /* START BLANK SCAN AT LINE END  */ 02572000
*                                                                  0726 02573000
LNOVRFL  LH    START,RECLEN(,COMMREG)                              0726 02574000
         SH    START,@CH00602                                      0726 02575000
*   /*****************************************************************/ 02576000
*   /*                                                               */ 02577000
*   /* FIND LOGICAL BREAKPOINT IN LINE(I.E. LAST BLANK IN RECORD     */ 02578000
*   /*                                                               */ 02579000
*   /*****************************************************************/ 02580000
*                                                                  0727 02581000
*   DO I=START TO 1 BY-1;                                          0727 02582000
*                                                                  0727 02583000
         LR    I,START                                             0727 02584000
         B     @DE00727                                            0727 02585000
@DL00727 DS    0H                                                  0728 02586000
*     /***************************************************************/ 02587000
*     /*                                                             */ 02588000
*     /* CHECK IF LAST BLANK FOUND                                   */ 02589000
*     /*                                                             */ 02590000
*     /***************************************************************/ 02591000
*                                                                  0728 02592000
*     IF RECTEXT(I)=' ' THEN        /* IF YES, BREAK POINT IN LINE   */ 02593000
         LR    @12,COMMREG                                         0728 02594000
         ALR   @12,I                                               0728 02595000
         CLI   RECTEXT-1(@12),C' '                                 0728 02596000
         BE    @RT00728                                            0728 02597000
*       GO TO BREAKLN;              /* BUILD OVERFLOW LINE           */ 02598000
*   END;                            /* END OF DO LOOP. FALL THROUGH     02599000
*                                      ONLY IF NO BLANK IN LINE.     */ 02600000
         BCTR  I,0                                                 0730 02601000
@DE00727 LTR   I,I                                                 0730 02602000
         BP    @DL00727                                            0730 02603000
*   I=START;                        /* SET BREAKPOINT MARKER AT END     02604000
*                                      OF RECORD                     */ 02605000
         LR    I,START                                             0731 02606000
*BREAKLN:                           /*                               */ 02607000
*                                                                  0732 02608000
*   /*****************************************************************/ 02609000
*   /*                                                               */ 02610000
*   /* CHECK IF BLANK NOT LAST CHARACTER IN LINE                     */ 02611000
*   /*                                                               */ 02612000
*   /*****************************************************************/ 02613000
*                                                                  0732 02614000
*   IF I<START THEN                 /* IF YES, BREAK LINE AT BLANK   */ 02615000
BREAKLN  CR    I,START                                             0732 02616000
         BNL   @RF00732                                            0732 02617000
*     DO;                           /* FORM FROM MAIN LINE AND     0733 02618000
*                                      OVERFLOW DATA                 */ 02619000
*                                                                  0733 02620000
*       /*************************************************************/ 02621000
*       /*                                                           */ 02622000
*       /* MOVE DATA BEYOND BREAKPOINT INTO 2ND BFR                  */ 02623000
*       /*                                                           */ 02624000
*       /*************************************************************/ 02625000
*                                                                  0734 02626000
*       RECTEXT2=RECTEXT(I+1:START);                               0734 02627000
*                                                                  0734 02628000
         MVI   RECTEXT2+1(COMMREG),C' '                            0734 02629000
         MVC   RECTEXT2+2(253,COMMREG),RECTEXT2+1(COMMREG)         0734 02630000
         LR    @12,START                                           0734 02631000
         SLR   @12,I                                               0734 02632000
         LR    @08,@12                                             0734 02633000
         BCTR  @08,0                                               0734 02634000
         LR    @07,COMMREG                                         0734 02635000
         ALR   @07,I                                               0734 02636000
         EX    @08,@SM01539                                        0734 02637000
*       /*************************************************************/ 02638000
*       /*                                                           */ 02639000
*       /* ADD ON LINE OVERFLOW TO EXTRA DATA IN MAIN LINE           */ 02640000
*       /*                                                           */ 02641000
*       /*************************************************************/ 02642000
*                                                                  0735 02643000
*       RECTEXT2(START-I+1:START-I+EXTRALEN-4)=EXTRALN;            0735 02644000
*                                                                  0735 02645000
         ST    @12,@TF00001                                        0735 02646000
         ALR   @12,COMMREG                                         0735 02647000
         L     @08,LETXTPTR                                        0735 02648000
         LH    @07,EXTRALEN(,@08)                                  0735 02649000
         LR    @15,@07                                             0735 02650000
         SH    @15,@CH00132                                        0735 02651000
         EX    @15,@SM01541                                        0735 02652000
*       /*************************************************************/ 02653000
*       /*                                                           */ 02654000
*       /* CALCULATE LENGTH OF NEW LINE                              */ 02655000
*       /*                                                           */ 02656000
*       /*************************************************************/ 02657000
*                                                                  0736 02658000
*       RECLEN2=START-I+EXTRALEN;                                  0736 02659000
*                                                                  0736 02660000
         AL    @07,@TF00001                                        0736 02661000
         STH   @07,RECLEN2(,COMMREG)                               0736 02662000
*       /*************************************************************/ 02663000
*       /*                                                           */ 02664000
*       /* PROPAGATE BLANKS IN CHANGED LINE                          */ 02665000
*       /*                                                           */ 02666000
*       /*************************************************************/ 02667000
*                                                                  0737 02668000
*       MVC(RECTEXT(I+1:START),RECTEXT(I:START-1));                0737 02669000
         LR    @12,COMMREG                                         0737 02670000
         ALR   @12,I                                               0737 02671000
         LR    @08,START                                           0737 02672000
         SLR   @08,I                                               0737 02673000
         BCTR  @08,0                                               0737 02674000
         LR    @07,COMMREG                                         0737 02675000
         ALR   @07,I                                               0737 02676000
         EX    @08,@SM01543                                        0737 02677000
*     END;                                                         0738 02678000
*   ELSE                            /* IF NO, DO NOT CHANGE LINE     */ 02679000
*     DO;                           /* FORM ONLY FROM OVERFLOW DATA  */ 02680000
         B     @RC00732                                            0739 02681000
@RF00732 DS    0H                                                  0740 02682000
*       RECTEXT2=EXTRALN;           /* MOVE DATA PROTION             */ 02683000
         MVI   RECTEXT2+251(COMMREG),C' '                          0740 02684000
         MVC   RECTEXT2+252(3,COMMREG),RECTEXT2+251(COMMREG)       0740 02685000
         L     @12,LETXTPTR                                        0740 02686000
         MVC   RECTEXT2(251,COMMREG),EXTRALN(@12)                  0740 02687000
*       RECLEN2=EXTRALEN;           /* LENGTH OF NEW LINE            */ 02688000
         MVC   RECLEN2(2,COMMREG),EXTRALEN(@12)                    0741 02689000
*     END;                                                         0742 02690000
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */ 02691000
@RC00732 MVI   UTCODE,X'20'                                        0743 02692000
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO LINE TO BE WRITTEN     */ 02693000
         LA    @08,KEYFLD(,COMMREG)                                0744 02694000
         ST    @08,KEYPTR                                          0744 02695000
*   AREAPTR=0;                      /* NO READ AREA NECESSARY        */ 02696000
         SLR   @08,@08                                             0745 02697000
         ST    @08,AREAPTR                                         0745 02698000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 02699000
         OI    PLISTEND,B'10000000'                                0746 02700000
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */ 02701000
*                                                                  0747 02702000
         BAL   @14,RDWRTRTN                                        0747 02703000
*   /*****************************************************************/ 02704000
*   /*                                                               */ 02705000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 02706000
*   /*                                                               */ 02707000
*   /*****************************************************************/ 02708000
*                                                                  0748 02709000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 02710000
         CH    RETCODE,@CH00145                                    0748 02711000
         BE    @RT00748                                            0748 02712000
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */ 02713000
*   VERCNT=VERCNT+1;                /* UPDATE OVERFLOW CNT BY ONE    */ 02714000
         LA    @12,1                                               0750 02715000
         AL    @12,VERCNT                                          0750 02716000
         ST    @12,VERCNT                                          0750 02717000
*   RELMSG1=1032;                   /* MSG IKJ52558I                 */ 02718000
         MVC   RELMSG1(2),@CH01434                                 0751 02719000
*   LEV1INS=0;                      /* NO 1ST LEVEL INSERTION        */ 02720000
         SLR   LEV1INS,LEV1INS                                     0752 02721000
*   RELMSG2=0;                      /* NO 2ND LEVEL MESSAGE          */ 02722000
         SLR   @12,@12                                             0753 02723000
         STH   @12,RELMSG2                                         0753 02724000
*   LEV2INS=0;                      /* NO 2ND LEVEL INSERTION        */ 02725000
         SLR   LEV2INS,LEV2INS                                     0754 02726000
*   CALL SENDMSG;                   /* SEND MESSAGE TO USER          */ 02727000
         BAL   @14,SENDMSG                                         0755 02728000
*   KEYFLD2=KEYFLD+1;               /* KEY FOR OVERFLOW LINE         */ 02729000
         LA    @08,1                                               0756 02730000
         AL    @08,KEYFLD(,COMMREG)                                0756 02731000
         ST    @08,KEYFLD2(,COMMREG)                               0756 02732000
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT      */ 02733000
         MVI   UTCODE,X'00'                                        0757 02734000
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO READ    */ 02735000
         LA    @08,KEYFLD2(,COMMREG)                               0758 02736000
         ST    @08,KEYPTR                                          0758 02737000
*   AREAPTR=ADDR(KEYFLD3);          /* PTR TO READ BUFFER            */ 02738000
         LA    @08,KEYFLD3(,COMMREG)                               0759 02739000
         ST    @08,AREAPTR                                         0759 02740000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 02741000
         OI    PLISTEND,B'10000000'                                0760 02742000
*   CALL RDWRTRTN;                  /* READ RECORD FROM DATA SET     */ 02743000
*                                                                  0761 02744000
         BAL   @14,RDWRTRTN                                        0761 02745000
*   /*****************************************************************/ 02746000
*   /*                                                               */ 02747000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 02748000
*   /*                                                               */ 02749000
*   /*****************************************************************/ 02750000
*                                                                  0762 02751000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 02752000
         CH    RETCODE,@CH00145                                    0762 02753000
         BE    @RT00762                                            0762 02754000
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */ 02755000
*                                                                  0763 02756000
*   /*****************************************************************/ 02757000
*   /*                                                               */ 02758000
*   /* CHECK IF THERE IS ROOM FOR OVERFLOW LINE IN DATA SET          */ 02759000
*   /*                                                               */ 02760000
*   /*****************************************************************/ 02761000
*                                                                  0764 02762000
*   IF RETCODE^=4 THEN              /* IF NO, RIPPLE RECORDS         */ 02763000
         CH    RETCODE,@CH00602                                    0764 02764000
         BE    @RF00764                                            0764 02765000
*     CALL RIPPLELN;                /* MAKE SLOT FOR OVERFLOW LINE   */ 02766000
         BAL   @14,RIPPLELN                                        0765 02767000
*   LETXTPTR=ADDR(RECLEN2);         /* PTR TO TEXT                   */ 02768000
@RF00764 LA    @08,RECLEN2(,COMMREG)                               0766 02769000
         ST    @08,LETXTPTR                                        0766 02770000
*   LECODE='00'X;                   /* NOT DELINITED STRING CODE     */ 02771000
         MVI   LECODE,X'00'                                        0767 02772000
*   CALL LINEEDIT;                  /* LINE EDIT RECORD              */ 02773000
         BAL   @14,LINEEDIT                                        0768 02774000
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */ 02775000
         MVI   UTCODE,X'20'                                        0769 02776000
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO WRITE   */ 02777000
         LA    @08,KEYFLD2(,COMMREG)                               0770 02778000
         ST    @08,KEYPTR                                          0770 02779000
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */ 02780000
         SLR   @08,@08                                             0771 02781000
         ST    @08,AREAPTR                                         0771 02782000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 02783000
         OI    PLISTEND,B'10000000'                                0772 02784000
*   CALL RDWRTRTN;                  /* WRITE RECORD                  */ 02785000
*                                                                  0773 02786000
         BAL   @14,RDWRTRTN                                        0773 02787000
*   /*****************************************************************/ 02788000
*   /*                                                               */ 02789000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 02790000
*   /*                                                               */ 02791000
*   /*****************************************************************/ 02792000
*                                                                  0774 02793000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 02794000
         CH    RETCODE,@CH00145                                    0774 02795000
         BE    @RT00774                                            0774 02796000
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */ 02797000
*                                                                  0775 02798000
*   /*****************************************************************/ 02799000
*   /*                                                               */ 02800000
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */ 02801000
*   /*                                                               */ 02802000
*   /*****************************************************************/ 02803000
*                                                                  0776 02804000
*   IF RETCODE=4 THEN               /* IF YES, FIT NEW OVERFLOW LINE    02805000
*                                      INTO DATA SET                 */ 02806000
         CH    RETCODE,@CH00602                                    0776 02807000
         BNE   @RF00776                                            0776 02808000
*     DO;                           /* REPEAT PROCESS, TREATING OLD     02809000
*                                      OVERFLOW LINE AS MAIN LINE    */ 02810000
*       KEYFLD=KEYFLD2;             /* MOVE KEY INTO MAIN BFR        */ 02811000
         MVC   KEYFLD(4,COMMREG),KEYFLD2(COMMREG)                  0778 02812000
*       RECLEN=RECLEN2;             /* MOVE LL FIELD                 */ 02813000
         MVC   RECLEN(2,COMMREG),RECLEN2(COMMREG)                  0779 02814000
*       RECTEXT=RECTEXT2;           /* MOVE DATA INTO BFR            */ 02815000
         MVC   RECTEXT(255,COMMREG),RECTEXT2(COMMREG)              0780 02816000
*       GO TO LNOVRFL;              /* PROCESS NEXT LINE             */ 02817000
         B     LNOVRFL                                             0781 02818000
*     END;                                                         0782 02819000
*   KEYFLD2=J;                      /* RESTORE KEY OF CHANGED LINE   */ 02820000
@RF00776 ST    J,KEYFLD2(,COMMREG)                                 0783 02821000
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT LN   */ 02822000
         MVI   UTCODE,X'00'                                        0784 02823000
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF CHANGED LINE    */ 02824000
         LA    @08,KEYFLD2(,COMMREG)                               0785 02825000
         ST    @08,KEYPTR                                          0785 02826000
*   AREAPTR=ADDR(KEYFLD);           /* AREA TO READ INTO             */ 02827000
         LA    @08,KEYFLD(,COMMREG)                                0786 02828000
         ST    @08,AREAPTR                                         0786 02829000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARK      */ 02830000
         OI    PLISTEND,B'10000000'                                0787 02831000
*   CALL RDWRTRTN;                  /* READ CHANGED LINE             */ 02832000
*                                                                  0788 02833000
         BAL   @14,RDWRTRTN                                        0788 02834000
*   /*****************************************************************/ 02835000
*   /*                                                               */ 02836000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 02837000
*   /*                                                               */ 02838000
*   /*****************************************************************/ 02839000
*                                                                  0789 02840000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 02841000
         CH    RETCODE,@CH00145                                    0789 02842000
         BE    @RT00789                                            0789 02843000
*     GO TO CHGEXIT3;               /* BEGIN END PROCESSING          */ 02844000
*   VERKEY=KEYFLD;                  /* SAVE ASTERISK VALUE           */ 02845000
         MVC   VERKEY(4),KEYFLD(COMMREG)                           0791 02846000
*CHKATTN:                                                          0792 02847000
*   FIRSTCHG='0'B;                  /* SET SWITCH TO INDICATE LINE 0792 02848000
*                                      CHANGE ALREADY PERFORMED      */ 02849000
*                                                                  0792 02850000
CHKATTN  NI    FIRSTCHG,B'10111111'                                0792 02851000
*   /*****************************************************************/ 02852000
*   /*                                                               */ 02853000
*   /* CHECK IF ATTENTION ISSUED                                     */ 02854000
*   /*                                                               */ 02855000
*   /*****************************************************************/ 02856000
*                                                                  0793 02857000
*   IF CAATTNIS='1'B THEN           /* IF YES, RETURN TO CALLER      */ 02858000
         TM    CAATTNIS(COMMREG),B'01000000'                       0793 02859000
         BO    @RT00793                                            0793 02860000
*     GO TO NOTEXT;                 /* BEGIN END PROCESSING          */ 02861000
*                                                                  0794 02862000
*   /*****************************************************************/ 02863000
*   /*                                                               */ 02864000
*   /* CHECK IF MORE LINES TO CHANGE AND NOT STRING OPERATION        */ 02865000
*   /*                                                               */ 02866000
*   /*****************************************************************/ 02867000
*                                                                  0795 02868000
*   IF KEYFLD<LNUM2|LNCOUNT>1 THEN  /* IF YES, ONLY COUNT CASE VALID    02869000
*                                      FOR CONTINUING                */ 02870000
         L     @12,KEYFLD(,COMMREG)                                0795 02871000
         C     @12,LNUM2                                           0795 02872000
         BL    @RT00795                                            0795 02873000
         L     @12,LNCOUNT                                         0795 02874000
         CH    @12,@CH00060                                        0795 02875000
         BNH   @RF00795                                            0795 02876000
@RT00795 DS    0H                                                  0796 02877000
*     DO;                           /* READ NEXT LINE IF COUNT CASE  */ 02878000
*                                                                  0796 02879000
*       /*************************************************************/ 02880000
*       /*                                                           */ 02881000
*       /* CHECK IF NUMERIC CHARACTER COUNT SPECIFIED                */ 02882000
*       /*                                                           */ 02883000
*       /*************************************************************/ 02884000
*                                                                  0797 02885000
*       IF CNTSW='1'B THEN          /* IF YES, READ LINE             */ 02886000
         TM    CNTSW,B'00100000'                                   0797 02887000
         BNO   @RF00797                                            0797 02888000
*         DO;                       /* PREPARE PARMLIST FOR READ     */ 02889000
*           UTCODE='02'X;           /* SET CODE TO READ NEXT LINE    */ 02890000
         MVI   UTCODE,X'02'                                        0799 02891000
*           KEYFLD=VERKEY+VERCNT;   /* SET KEY TO NEWLN              */ 02892000
         L     @08,VERKEY                                          0800 02893000
         AL    @08,VERCNT                                          0800 02894000
         ST    @08,KEYFLD(,COMMREG)                                0800 02895000
*           KEYPTR=ADDR(KEYFLD);    /* PTR TO READ KEY               */ 02896000
         LA    @08,KEYFLD(,COMMREG)                                0801 02897000
         ST    @08,KEYPTR                                          0801 02898000
*           AREAPTR=ADDR(KEYFLD);   /* PTR TO READ BUFFER            */ 02899000
         ST    @08,AREAPTR                                         0802 02900000
*           PLISTEND='1'B;          /* SET END OF PLIST MARK         */ 02901000
         OI    PLISTEND,B'10000000'                                0803 02902000
*           CALL RDWRTRTN;          /* READ NEXT RECORD              */ 02903000
*                                                                  0804 02904000
         BAL   @14,RDWRTRTN                                        0804 02905000
*           /*********************************************************/ 02906000
*           /*                                                       */ 02907000
*           /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE         */ 02908000
*           /* OPERATION                                             */ 02909000
*           /*                                                       */ 02910000
*           /*********************************************************/ 02911000
*                                                                  0805 02912000
*           IF RETCODE=12 THEN      /* IF YES,TERMINAT               */ 02913000
         CH    RETCODE,@CH00145                                    0805 02914000
         BE    @RT00805                                            0805 02915000
*             GO TO CHGEXIT3;       /* ENG PROCESSING                */ 02916000
*                                                                  0806 02917000
*           /*********************************************************/ 02918000
*           /*                                                       */ 02919000
*           /* CHECK IF RECORD EXISTS                                */ 02920000
*           /*                                                       */ 02921000
*           /*********************************************************/ 02922000
*                                                                  0807 02923000
*           IF RETCODE=4 THEN       /* IF NO, NOTIFY USER            */ 02924000
         CH    RETCODE,@CH00602                                    0807 02925000
         BNE   @RF00807                                            0807 02926000
*             DO;                   /* SEND EOD MESSAGE TO USER      */ 02927000
*               RELMSG1=1286;       /* MSG IKJ52500I                 */ 02928000
         MVC   RELMSG1(2),@CH01363                                 0809 02929000
*               LEV1INS=0;          /* NO FIRST-LEVEL INSERTIONS     */ 02930000
         SLR   LEV1INS,LEV1INS                                     0810 02931000
*               RELMSG2=0;          /* NO SECOND-LEVEL MESSAGE       */ 02932000
         SLR   @12,@12                                             0811 02933000
         STH   @12,RELMSG2                                         0811 02934000
*               LEV2INS=0;          /* (OR INSERTIONS)               */ 02935000
         SLR   LEV2INS,LEV2INS                                     0812 02936000
*               CALL SENDMSG;       /* SEND EOD MESSAGE              */ 02937000
         BAL   @14,SENDMSG                                         0813 02938000
*               GO TO NOTEXT;       /* CONTINUE TO EXIT              */ 02939000
         B     NOTEXT                                              0814 02940000
*             END;                                                 0815 02941000
*           ELSE                    /* IF YES, CONTINUE PROCESSING   */ 02942000
*             DO;                   /* NEXT LINE EXISTS              */ 02943000
*                                                                  0816 02944000
@RF00807 DS    0H                                                  0817 02945000
*               /*****************************************************/ 02946000
*               /*                                                   */ 02947000
*               /* CHECK IF LINE WITHIN RANGE SPECIFIED              */ 02948000
*               /*                                                   */ 02949000
*               /*****************************************************/ 02950000
*                                                                  0817 02951000
*               IF KEYFLD<=LNUM2|LNCOUNT>1 THEN/* IF YES, CONTINUE 0817 02952000
*                                      PROCESSING                    */ 02953000
         L     @12,KEYFLD(,COMMREG)                                0817 02954000
         C     @12,LNUM2                                           0817 02955000
         BNH   @RT00817                                            0817 02956000
         L     @12,LNCOUNT                                         0817 02957000
         CH    @12,@CH00060                                        0817 02958000
         BNH   @RF00817                                            0817 02959000
@RT00817 DS    0H                                                  0818 02960000
*                 DO;               /* PREPARE TO CONTINUE CHANGING  */ 02961000
*                   LNCOUNT=LNCOUNT-1;/* DECREMENT LINE COUNT BY ONE */ 02962000
         L     @12,LNCOUNT                                         0819 02963000
         BCTR  @12,0                                               0819 02964000
         ST    @12,LNCOUNT                                         0819 02965000
*                   GO TO CNTPRCS2; /* REPEAT MAIN PROCSS            */ 02966000
         B     CNTPRCS2                                            0820 02967000
*                 END;                                             0821 02968000
*             END;                                                 0822 02969000
@RF00817 DS    0H                                                  0823 02970000
*         END;                                                     0823 02971000
*     END;                                                         0824 02972000
@RF00797 DS    0H                                                  0825 02973000
*NOTEXT:                            /*                               */ 02974000
*                                                                  0825 02975000
*   /*****************************************************************/ 02976000
*   /*                                                               */ 02977000
*   /* CHECK IF ANY LINE CHANGES PERFORMED                           */ 02978000
*   /*                                                               */ 02979000
*   /*****************************************************************/ 02980000
*                                                                  0825 02981000
*   IF FIRSTCHG='0'B THEN           /* IF YES, SET * VALUE           */ 02982000
@RF00795 DS    0H                                                  0825 02983000
NOTEXT   TM    FIRSTCHG,B'01000000'                                0825 02984000
         BNZ   @RF00825                                            0825 02985000
*     CACURNUM=VERKEY+VERCNT;       /* SET * VALUE                   */ 02986000
         L     @12,VERKEY                                          0826 02987000
         AL    @12,VERCNT                                          0826 02988000
         ST    @12,CACURNUM(,COMMREG)                              0826 02989000
*CHGEXIT3:                          /*                               */ 02990000
*                                                                  0827 02991000
*   /*****************************************************************/ 02992000
*   /*                                                               */ 02993000
*   /* CHECK IF PROMPTING PERFORMED                                  */ 02994000
*   /*                                                               */ 02995000
*   /*****************************************************************/ 02996000
*                                                                  0827 02997000
*   IF PROMPTSW='1'B THEN                                          0827 02998000
@RF00825 DS    0H                                                  0827 02999000
CHGEXIT3 TM    PROMPTSW,B'10000000'                                0827 03000000
         BNO   @RF00827                                            0827 03001000
*     DO;                           /* IF YES, FREEPROMPT PDL        */ 03002000
*       PARMREG1=ADDR(TABPTR2);     /* PTR TO PPMT PDL               */ 03003000
         LA    PARMREG1,TABPTR2                                    0829 03004000
*       PROMPTSW='0'B;              /* INDIC. PDL FREED              */ 03005000
         NI    PROMPTSW,B'01111111'                                0830 03006000
*     END;                                                         0831 03007000
*   ELSE                            /* IF NO, FREE MAIN PDL          */ 03008000
*     PARMREG1=ADDR(TABPTR1);       /* PTR TO MAIN PDL               */ 03009000
         B     @RC00827                                            0832 03010000
@RF00827 LA    PARMREG1,TABPTR1                                    0832 03011000
*   GEN(IKJRLSA (1));               /* RELEASE CORE FROM IKJPARS     */ 03012000
@RC00827 DS    0H                                                  0833 03013000
         IKJRLSA (1)                                                    03014000
*   RETCDREG=CHRETCD;               /* SET RETURN CODE IN REG 15     */ 03015000
         L     RETCDREG,CHRETCD                                    0834 03016000
*   RETREG=CHARPTR;                 /* RESTORE RETURN POINT          */ 03017000
         L     RETREG,CHARPTR                                      0835 03018000
*   RETURN;                         /* RETURN TO CALLER              */ 03019000
@EL00005 DS    0H                                                  0836 03020000
@EF00005 DS    0H                                                  0836 03021000
@ER00005 BR    @14                                                 0836 03022000
*   END CHARRTN;                    /* END OF IKJEBECN SUBROUTINE    */ 03023000
*                                                                  0838 03024000
*   /*****************************************************************/ 03025000
*   /*                                                               */ 03026000
*   /* THIS SUBROUTINE RIPPLES RECORDS IN THE EDIT DATA SET TO MAKE A*/ 03027000
*   /* SLOT AVAILABLE FOR THE TEXT OVERFLOW LINE. THE LINE THAT MUST */ 03028000
*   /* BE MOVED DOWN IN THE DATA SET IS IN THE FIRST BUFFER OF THE   */ 03029000
*   /* BFRAREA2 FIELD.                                               */ 03030000
*   /*                                                               */ 03031000
*   /*****************************************************************/ 03032000
*                                                                  0838 03033000
*RIPPLELN:                                                         0838 03034000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY          @ZA24614*/ 03035000
RIPPLELN DS    0H                                                  0839 03036000
*/*           REGISTERS WITH SPECIAL USE                             */ 03037000
*                                                                  0839 03038000
*   RESPECIFY                                                      0839 03039000
*    (PARMREG1,                                                    0839 03040000
*     BINRYREG,                                                    0839 03041000
*     COMMREG,                                                     0839 03042000
*     BASEREG,                                                     0839 03043000
*     DATAREG) RSTD;                                               0839 03044000
*   RESPECIFY                                                      0840 03045000
*    (BASEREG2) RSTD;                                              0840 03046000
*   RIPPLPTR=RETREG;                /* SAVE RETURN POINT ADDR      0841 03047000
*                                                            @ZA24614*/ 03048000
*                                                                  0841 03049000
         ST    RETREG,RIPPLPTR                                     0841 03050000
*   /*****************************************************************/ 03051000
*   /*                                                               */ 03052000
*   /* CHECK IF RIPPLE KEY EXCEEDS ACCESS METHOD LIMITS              */ 03053000
*   /*                                                               */ 03054000
*   /*****************************************************************/ 03055000
*                                                                  0842 03056000
*CONTRPPL:                                                         0842 03057000
*   IF KEYFLD3='7FFFFFFF'X THEN     /* IF YES, STOP RIPPLING LINES   */ 03058000
CONTRPPL L     @12,KEYFLD3(,COMMREG)                               0842 03059000
         C     @12,@CF01442                                        0842 03060000
         BE    @RT00842                                            0842 03061000
*     GO TO RPPLEXIT;               /* RETURN TO CALLER              */ 03062000
*   KEYFLD3=KEYFLD3+1;              /* INCREMENT KEY VALUE BY ONE    */ 03063000
         L     @08,KEYFLD3(,COMMREG)                               0844 03064000
         AL    @08,@CF00060                                        0844 03065000
         ST    @08,KEYFLD3(,COMMREG)                               0844 03066000
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT      */ 03067000
         MVI   UTCODE,X'00'                                        0845 03068000
*   KEYPTR=ADDR(KEYFLD3);           /* PTR TO KEY OF RECORD          */ 03069000
         LA    @08,KEYFLD3(,COMMREG)                               0846 03070000
         ST    @08,KEYPTR                                          0846 03071000
*   AREAPTR=ADDR(KEYFLD4);          /* PTR TO READ BUFFER AREA       */ 03072000
         LA    @08,KEYFLD4(,COMMREG)                               0847 03073000
         ST    @08,AREAPTR                                         0847 03074000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 03075000
         OI    PLISTEND,B'10000000'                                0848 03076000
*   CALL RDWRTRTN;                  /* READ KEY FOR NEXT SLOT        */ 03077000
*                                                                  0849 03078000
         BAL   @14,RDWRTRTN                                        0849 03079000
*   /*****************************************************************/ 03080000
*   /*                                                               */ 03081000
*   /* CHECK IF RECORD EXITS ALREADY IN THIS NEXT SLOT               */ 03082000
*   /*                                                               */ 03083000
*   /*****************************************************************/ 03084000
*                                                                  0850 03085000
*   IF RETCODE^=4 THEN              /* IF YES, CONTINUE TO RIPPLE    */ 03086000
         CH    RETCODE,@CH00602                                    0850 03087000
         BE    @RF00850                                            0850 03088000
*     DO;                           /* WRITE LINE WITH KEY 1 HIBHER  */ 03089000
*       UTCODE='20'X;               /* SET CODE TO WRITE RECORD      */ 03090000
         MVI   UTCODE,X'20'                                        0852 03091000
*       AREAPTR=0;                  /* NO READ BFR NECESSARY         */ 03092000
         SLR   @08,@08                                             0853 03093000
         ST    @08,AREAPTR                                         0853 03094000
*       PLISTEND='1'B;              /* SET END OF PARMLIST MARK      */ 03095000
         OI    PLISTEND,B'10000000'                                0854 03096000
*       CALL RDWRTRTN;              /* WRITE LINE INTO NEXT SLOT     */ 03097000
         BAL   @14,RDWRTRTN                                        0855 03098000
*       KEYFLD3=KEYFLD4;            /* MOVE KEY VALUE                */ 03099000
         MVC   KEYFLD3(4,COMMREG),KEYFLD4(COMMREG)                 0856 03100000
*       RECLEN3=RECLEN4;            /* MOVE LL FIELD                 */ 03101000
         MVC   RECLEN3(2,COMMREG),RECLEN4(COMMREG)                 0857 03102000
*       RECTEXT3=RECTEXT4;          /* MOVE DATA INTO WRITE BUFFER 0858 03103000
*                                      FOR NEXT RIPPL                */ 03104000
         MVC   RECTEXT3(255,COMMREG),RECTEXT4(COMMREG)             0858 03105000
*       GO TO CONTRPPL;             /* CONTINUE TO RIPPLE LINES      */ 03106000
         B     CONTRPPL                                            0859 03107000
*     END;                                                         0860 03108000
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */ 03109000
@RF00850 MVI   UTCODE,X'20'                                        0861 03110000
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */ 03111000
         SLR   @08,@08                                             0862 03112000
         ST    @08,AREAPTR                                         0862 03113000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 03114000
         OI    PLISTEND,B'10000000'                                0863 03115000
*   CALL RDWRTRTN;                  /* WRITE LAST RECORD INTO SLOT   */ 03116000
         BAL   @14,RDWRTRTN                                        0864 03117000
*RPPLEXIT:                                                         0865 03118000
*   ;                               /* SUBROUTINE EXIT               */ 03119000
RPPLEXIT DS    0H                                                  0866 03120000
*   RETREG=RIPPLPTR;                /* RESTORE RETURN ADDRESS      0866 03121000
*                                                            @ZA24614*/ 03122000
         L     RETREG,RIPPLPTR                                     0866 03123000
*   RETURN;                         /* RETURN TO CALLER              */ 03124000
@EL00006 DS    0H                                                  0867 03125000
@EF00006 DS    0H                                                  0867 03126000
@ER00006 BR    @14                                                 0867 03127000
*   END RIPPLELN;                   /* END OF SUBROUTINE             */ 03128000
*                                                                  0869 03129000
*   /*****************************************************************/ 03130000
*   /*                                                               */ 03131000
*   /* THIS SUBROUTINE PERFORMS ALL CALLS TO THE IKJEBELE SERVICE    */ 03132000
*   /* ROUTINE TO LINE EDIT ALL CHANGED RECORDS AND AND DELIMITED    */ 03133000
*   /* STRINGS. THE RETURN CODE FROM IKJEBELE IS SAVED BEFORE        */ 03134000
*   /* RETURNING TO THE MAIN LINE ROUTINE.                           */ 03135000
*   /*                                                               */ 03136000
*   /*****************************************************************/ 03137000
*                                                                  0869 03138000
*LINEEDIT:                                                         0869 03139000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/* SUBRTN ENTRY PT               */ 03140000
*                                                                  0869 03141000
LINEEDIT DS    0H                                                  0870 03142000
*   /*****************************************************************/ 03143000
*   /*                                                               */ 03144000
*   /* REGISTERS WITH SPECIAL USE                                    */ 03145000
*   /*                                                               */ 03146000
*   /*****************************************************************/ 03147000
*                                                                  0870 03148000
*   RESPECIFY                                                      0870 03149000
*    (PARMREG1,                                                    0870 03150000
*     BINRYREG,                                                    0870 03151000
*     COMMREG,                                                     0870 03152000
*     BASEREG,                                                     0870 03153000
*     DATAREG) RSTD;                                               0870 03154000
*   RESPECIFY                                                      0871 03155000
*    (BASEREG2) RSTD;                                              0871 03156000
*   LINEPTR=RETREG;                 /* SAVE RETURN POINT ADDRESS     */ 03157000
         LR    LINEPTR,RETREG                                      0872 03158000
*   GENERATE REFS(COMMREG,LEPLIST);                                0873 03159000
         IKJEBESH (COMMREG),IKJEBELE,PARAM=((COMMREG),LEPLIST),        X03160000
               MF=(E,SRPLIST)                                           03161000
*   RETCODE=RETCDREG;               /* SAVE RETURN CODE              */ 03162000
         LR    RETCODE,RETCDREG                                    0874 03163000
*   RETREG=LINEPTR;                 /* RESTORE RETURN POINT ADDRESS  */ 03164000
         LR    RETREG,LINEPTR                                      0875 03165000
*   RETURN;                         /* EXIT LINKAGE                  */ 03166000
@EL00007 DS    0H                                                  0876 03167000
@EF00007 DS    0H                                                  0876 03168000
@ER00007 BR    @14                                                 0876 03169000
*   END LINEEDIT;                   /* END OF SUBROUTINE             */ 03170000
*                                                                  0878 03171000
*/********************************************************************  03172000
*                                                                    */ 03173000
*/*                                                                  */ 03174000
*/*    THIS SUBROUTINE OF THE CHANGE SUBCOMMAND OF EDIT MODIFIES ANY */ 03175000
*/*    CHARACTER STRING WITHIN THE LINE(S) OF DATA SPECIFIED.  THIS  */ 03176000
*/*    OPERATION INCLUDES EITHER REPLACEMENT, DELETION, OR INSERTION */ 03177000
*/*    OF A CHARACTER STRING.  IF THE ALL KEYWORD IS SPECIFIED ON THE*/ 03178000
*/*    SUBCOMMAND, THIS OPERATION MODIFIES ALL REFERENCES TO THE     */ 03179000
*/*    STRING IN THE LINE RANGE SPECIFIED.  THE STRING(S) IS LINE    */ 03180000
*/*    EDITED AND THE OFFSET IN THE RECORD FOUND.  IF THE OPERATION  */ 03181000
*/*    IS OF THE FORM DELIMITER STRING, THIS MODULE CALLS CHARRTN    */ 03182000
*/*    WHICH PERFORMS THE CHARACTER COUNT OPERATIONS.  AFTER THE     */ 03183000
*/*    UPDATE TO THE RECORD IS MADE, IT IS WRITTEN BACK INTO THE DATA*/ 03184000
*/*    SET.  IF THE DATA SET TYPE IS BASIC OR IPLI, THE REVERSE      */ 03185000
*/*    POLISH DATA SET IS UPDATED.  IF THE DATA SET TYPE IS NON-     */ 03186000
*/*    LINE NUMBERED TEXT, OVERFLOW LINES, IF ANY, ARE CREATED.  THE */ 03187000
*/*    CURRENT LINE POINTER IS UPDATED TO THE LAST LINE CHANGED,     */ 03188000
*/*    AND LINE VERIFICATION OF THE CHANGED LINES IS PERFORMED, IF   */ 03189000
*/*    NECESSARY.  CONTROL IS THEN RETURNED TO IKJEBEMA VIA IKJEBECH */ 03190000
*/*    WITH A RETURN CODE IN REGISTER FIFTEEN.                       */ 03191000
*/*                                                                  */ 03192000
*/********************************************************************  03193000
*                                                                    */ 03194000
*                                                                  0878 03195000
*STRNGRTN:                                                         0878 03196000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0878 03197000
*                                                                  0878 03198000
STRNGRTN DS    0H                                                  0879 03199000
*   /*****************************************************************/ 03200000
*   /*                                                               */ 03201000
*   /* REGISTERS WITH SPECIAL USE                                    */ 03202000
*   /*                                                               */ 03203000
*   /*****************************************************************/ 03204000
*                                                                  0879 03205000
*   RESPECIFY                                                      0879 03206000
*    (PARMREG1,                                                    0879 03207000
*     BINRYREG,                                                    0879 03208000
*     COMMREG,                                                     0879 03209000
*     BASEREG,                                                     0879 03210000
*     DATAREG) RSTD;                                               0879 03211000
*   RESPECIFY                                                      0880 03212000
*    (BASEREG2) RSTD;                                              0880 03213000
*   STRNGPTR=RETREG;                /* SAVE RETURN POINT             */ 03214000
         ST    RETREG,STRNGPTR                                     0881 03215000
*   VERCNT=0;                       /* INITIALIZE VERIFY CT TO ZERO  */ 03216000
         SLR   @12,@12                                             0882 03217000
         ST    @12,VERCNT                                          0882 03218000
*   TRUNCKEY=-1;                    /* INIT LAST LINE TRUNCATED KEY  */ 03219000
*                                                                  0883 03220000
         MVC   TRUNCKEY(4),@CF01355                                0883 03221000
*   /*****************************************************************/ 03222000
*   /*                                                               */ 03223000
*   /* CHECK IF TEXT2 PRESENT AND NOT NULL                           */ 03224000
*   /*                                                               */ 03225000
*   /*****************************************************************/ 03226000
*                                                                  0884 03227000
*   IF STR2L>0 THEN                 /* IF YES, LINE EDIT STRING      */ 03228000
         L     @08,TABPTR1                                         0884 03229000
         LH    @08,STR2L(,@08)                                     0884 03230000
         CR    @08,@12                                             0884 03231000
         BNH   @RF00884                                            0884 03232000
*     DO;                           /* MOVE TEXT2 INTO WORK BUFFER   */ 03233000
*       RECLEN2=STR2L+4;            /* SET LL FIELD                  */ 03234000
         LA    @07,4                                               0886 03235000
         ALR   @07,@08                                             0886 03236000
         STH   @07,RECLEN2(,COMMREG)                               0886 03237000
*       RECOFF2=0;                  /* SET OFFSET FIELD TO ZERO      */ 03238000
         SLR   @07,@07                                             0887 03239000
         STH   @07,RECOFF2(,COMMREG)                               0887 03240000
*       RECTEXT2(1:STR2L)=STR2PTR->STRING;/* MOVE TEXT INTO BFR      */ 03241000
         BCTR  @08,0                                               0888 03242000
         L     @07,STR2PTR                                         0888 03243000
         EX    @08,@SM01545                                        0888 03244000
*       LETXTPTR=ADDR(RECLEN2);     /* PTR TO STRING                 */ 03245000
         LA    @08,RECLEN2(,COMMREG)                               0889 03246000
         ST    @08,LETXTPTR                                        0889 03247000
*       LECODE='80'X;               /* ENTRY CODE FOR IKJEBELE       */ 03248000
         MVI   LECODE,X'80'                                        0890 03249000
*       CALL LINEEDIT;              /* LINE EDIT STRING              */ 03250000
         BAL   @14,LINEEDIT                                        0891 03251000
*       STR2PTR->STRING(1:STR2L)=RECTEXT2;/* RETURN STRING TO ORIG.     03252000
*                                      BFR                           */ 03253000
         L     @12,STR2PTR                                         0892 03254000
         L     @08,TABPTR1                                         0892 03255000
         LH    @08,STR2L(,@08)                                     0892 03256000
         BCTR  @08,0                                               0892 03257000
         EX    @08,@SM01547                                        0892 03258000
*     END;                                                         0893 03259000
*                                                                  0893 03260000
*   /*****************************************************************/ 03261000
*   /*                                                               */ 03262000
*   /* CHECK IF TEXT1 PRESENT AND NOT NULL                           */ 03263000
*   /*                                                               */ 03264000
*   /*****************************************************************/ 03265000
*                                                                  0894 03266000
*   IF STR1L>0 THEN                 /* IF YES, LINE EDIT STRING AND     03267000
*                                      SCAN RECORD FOR STRING        */ 03268000
@RF00884 SLR   @12,@12                                             0894 03269000
         L     @08,TABPTR1                                         0894 03270000
         LH    @08,STR1L(,@08)                                     0894 03271000
         CR    @08,@12                                             0894 03272000
         BNH   @RF00894                                            0894 03273000
*     DO;                           /* MOVE TEXT1 INTO WORK BUFFER   */ 03274000
*       RECLEN2=STR1L+4;            /* SET LL FIELD                  */ 03275000
         LA    @07,4                                               0896 03276000
         ALR   @07,@08                                             0896 03277000
         STH   @07,RECLEN2(,COMMREG)                               0896 03278000
*       RECOFF2=0;                  /* SET OFFSET FIELD TO ZERO      */ 03279000
         SLR   @07,@07                                             0897 03280000
         STH   @07,RECOFF2(,COMMREG)                               0897 03281000
*       RECTEXT2(1:STR1L)=STR1PTR->STRING;/* MOVE TEXT INTO BFR      */ 03282000
         BCTR  @08,0                                               0898 03283000
         L     @07,STR1PTR                                         0898 03284000
         EX    @08,@SM01545                                        0898 03285000
*       LETXTPTR=ADDR(RECLEN2);     /* PTR TO STRING                 */ 03286000
         LA    @08,RECLEN2(,COMMREG)                               0899 03287000
         ST    @08,LETXTPTR                                        0899 03288000
*       LECODE='80'X;               /* ENTRY CODE FOR IKJEBELE       */ 03289000
         MVI   LECODE,X'80'                                        0900 03290000
*       CALL LINEEDIT;              /* LINE EDIT STRING              */ 03291000
         BAL   @14,LINEEDIT                                        0901 03292000
*       STR1PTR->STRING(1:STR1L)=RECTEXT2;/* RETURN STRING TO ORIG.     03293000
*                                      BFR                           */ 03294000
         L     @12,STR1PTR                                         0902 03295000
         L     @08,TABPTR1                                         0902 03296000
         LH    @08,STR1L(,@08)                                     0902 03297000
         LR    @07,@08                                             0902 03298000
         BCTR  @07,0                                               0902 03299000
         EX    @07,@SM01547                                        0902 03300000
*       SECHARCT=                   /* MAX NUMBER OF A45363          */ 03301000
*           RECLEN-4;               /* CHAR TO SCAN A45363           */ 03302000
         LH    @12,RECLEN(,COMMREG)                                0903 03303000
         SH    @12,@CH00602                                        0903 03304000
         STH   @12,SECHARCT                                        0903 03305000
*       STR1LENS=STR1L;             /* SAVE LENGTH OF YA01203 STRING    03306000
*                                      1 YA01203                     */ 03307000
         STH   @08,STR1LENS                                        0904 03308000
*STRGCHNG:                                                         0905 03309000
*       ;                           /* BEGINNING OF MAIN LOOP        */ 03310000
*                                                                  0905 03311000
STRGCHNG DS    0H                                                  0906 03312000
*       /*************************************************************/ 03313000
*       /*                                                           */ 03314000
*       /* ----------------------------------------- SCAN RECORD FOR */ 03315000
*       /* TEXT1 TO DETERMINE THE OFFSET AT WHICH TO PERFORM THE TEXT*/ 03316000
*       /* CHANGE -----------------------------------------          */ 03317000
*       /*                                                           */ 03318000
*       /*************************************************************/ 03319000
*                                                                  0906 03320000
*       STR1L=STR1LENS;             /* RESET LENGTH OFYA01203 STRING    03321000
*                                      1 YA01203                     */ 03322000
         LH    @12,STR1LENS                                        0906 03323000
         L     @08,TABPTR1                                         0906 03324000
         STH   @12,STR1L(,@08)                                     0906 03325000
*       SESTRLEN=STR1L;             /* LENGTH OF TEXT1               */ 03326000
         STH   @12,SESTRLEN                                        0907 03327000
*       SETXTPTR=STR1PTR;           /* PTR TO TEXT1                  */ 03328000
         MVC   SETXTPTR(4),STR1PTR                                 0908 03329000
*       PARMREG1=ADDR(SEPLIST);     /* PTR TO PARMLIST               */ 03330000
         LA    PARMREG1,SEPLIST                                    0909 03331000
*       PARMREG0=COMMREG;           /* PTR TO COMM. AREA             */ 03332000
         LR    PARMREG0,COMMREG                                    0910 03333000
*       CALL IKJEBESE;              /* SCAN RECORD(S)                */ 03334000
         L     @15,@CV00585                                        0911 03335000
         BALR  @14,@15                                             0911 03336000
*       SERTAREA=RETCDREG;          /* SAVE RETURN CODE AND TEXT1  0912 03337000
*                                      OFFSET IN RECORD              */ 03338000
*                                                                  0912 03339000
         ST    RETCDREG,SERTAREA                                   0912 03340000
*       /*************************************************************/ 03341000
*       /*                                                           */ 03342000
*       /* CHECK IF ATTENTION ISSUED                                 */ 03343000
*       /*                                                           */ 03344000
*       /*************************************************************/ 03345000
*                                                                  0913 03346000
*       IF CAATTNIS='1'B THEN       /* IF YES, TERMINATE PROCESS     */ 03347000
         TM    CAATTNIS(COMMREG),B'01000000'                       0913 03348000
         BO    @RT00913                                            0913 03349000
*         GO TO NOTEXT1;            /* RETURN TO CALLER              */ 03350000
*                                                                  0914 03351000
*       /*************************************************************/ 03352000
*       /*                                                           */ 03353000
*       /* CHECK IF I/O ERROR OCCURRED                               */ 03354000
*       /*                                                           */ 03355000
*       /*************************************************************/ 03356000
*                                                                  0915 03357000
*       IF SERTCD='0C'X THEN        /* IF YES, SET RETURN CODE AND 0915 03358000
*                                      TERMINATE PROCESS             */ 03359000
         CLI   SERTCD,X'0C'                                        0915 03360000
         BNE   @RF00915                                            0915 03361000
*         DO;                       /* PREPARE FOR ERROR EXIT        */ 03362000
*IOERRMSG:                                                         0917 03363000
*           CHRETCD=12;             /* SET RC FOR IKJEBEMA           */ 03364000
IOERRMSG MVC   CHRETCD(4),@CF00145                                 0917 03365000
*           GO TO CHGEXIT4;         /* RETURN TO CALLER              */ 03366000
         B     CHGEXIT4                                            0918 03367000
*         END;                                                     0919 03368000
*                                                                  0919 03369000
*       /*************************************************************/ 03370000
*       /*                                                           */ 03371000
*       /* CHECK IF TEXT NOT FOUND IN RECORD                         */ 03372000
*       /*                                                           */ 03373000
*       /*************************************************************/ 03374000
*                                                                  0920 03375000
*       IF SERTCD='08'X THEN        /* IF NOT, BEGIN END PROCESSING  */ 03376000
@RF00915 CLI   SERTCD,X'08'                                        0920 03377000
         BNE   @RF00920                                            0920 03378000
*         DO;                       /* DETERMINE IF MESSAGE TO SEND  */ 03379000
*NOTXT:                                                            0922 03380000
*           ;                       /* SEND TEXT NOT FOUND MSG       */ 03381000
*                                                                  0922 03382000
NOTXT    DS    0H                                                  0923 03383000
*           /*********************************************************/ 03384000
*           /*                                                       */ 03385000
*           /* CHECK IF THIS IS FIRST CHANGE                         */ 03386000
*           /*                                                       */ 03387000
*           /*********************************************************/ 03388000
*                                                                  0923 03389000
*           IF FIRSTCHG='1'B THEN   /* IF YES, NOTIFY USER           */ 03390000
         TM    FIRSTCHG,B'01000000'                                0923 03391000
         BNO   @RF00923                                            0923 03392000
*             DO;                   /* SEND MESSAGE RELATIVE MSG   0924 03393000
*                                      NUMBER                        */ 03394000
*               RELMSG1=1292;       /* NO 2ND LEVEL MESSAGE          */ 03395000
         MVC   RELMSG1(2),@CH01461                                 0925 03396000
*               RELMSG2=0;          /* NO 1ST LEVEL INSERTS          */ 03397000
         SLR   @12,@12                                             0926 03398000
         STH   @12,RELMSG2                                         0926 03399000
*               LEV1INS=0;          /* NO 2ND LEVEL INSERTS          */ 03400000
         SLR   LEV1INS,LEV1INS                                     0927 03401000
*               LEV2INS=0;          /* INDICATE FLUSH                */ 03402000
         SLR   LEV2INS,LEV2INS                                     0928 03403000
*               CHRETCD=8;          /* SEND MSG TO USER              */ 03404000
         MVC   CHRETCD(4),@CF00058                                 0929 03405000
*               CALL SENDMSG;                                      0930 03406000
         BAL   @14,SENDMSG                                         0930 03407000
*             END;                                                 0931 03408000
*           GO TO NOTEXT1;          /* RETURN TO CALLER              */ 03409000
         B     NOTEXT1                                             0932 03410000
*         END;                                                     0933 03411000
*                                                                  0933 03412000
*       /*************************************************************/ 03413000
*       /*                                                           */ 03414000
*       /* CHECK IF TEXT FOUND ACROSS RECORD BOUNDARIES              */ 03415000
*       /*                                                           */ 03416000
*       /*************************************************************/ 03417000
*                                                                  0934 03418000
*       IF SERTCD='04'X THEN        /* IF YES, REMOVE TEXT FOUND IN     03419000
*                                      SECOND RECORD                 */ 03420000
@RF00920 CLI   SERTCD,X'04'                                        0934 03421000
         BNE   @RF00934                                            0934 03422000
*         DO;                       /* CALL SUBRTN TO STRIP TEXT2    */ 03423000
*           SERTCD='00'X;           /* ZERO RETURN CODE              */ 03424000
         MVI   SERTCD,X'00'                                        0936 03425000
*           CALL BDYCHG;            /* REMOVE TEXT                   */ 03426000
         BAL   @14,BDYCHG                                          0937 03427000
*         END;                                                     0938 03428000
*     END;                                                         0939 03429000
*   ELSE                            /* IF NO, VALIDITY CHECK STRING  */ 03430000
*     DO;                           /* DETERMINE OPERATION WITH TEXT2   03431000
*                                      NULL AND PRESENT              */ 03432000
*                                                                  0940 03433000
         B     @RC00894                                            0940 03434000
@RF00894 DS    0H                                                  0941 03435000
*       /*************************************************************/ 03436000
*       /*                                                           */ 03437000
*       /* CHECK IF BOTH STRINGS NULL                                */ 03438000
*       /*                                                           */ 03439000
*       /*************************************************************/ 03440000
*                                                                  0941 03441000
*       IF STR2L=0 THEN             /* IF YES, INVALID OPERATION     */ 03442000
         L     @12,TABPTR1                                         0941 03443000
         ICM   @08,3,STR2L(@12)                                    0941 03444000
         BZ    @RT00941                                            0941 03445000
*         GO TO NOTXT;              /* NOTIFY USER                   */ 03446000
*       OFF1=1;                     /* SET OFFSET TO BEGINNING OF  0943 03447000
*                                      RECORD TO INSERT TEXT2        */ 03448000
         MVC   OFF1(4),@CF00060                                    0943 03449000
*     END;                                                         0944 03450000
*                                                                  0944 03451000
*   /*****************************************************************/ 03452000
*   /*                                                               */ 03453000
*   /* CHECK IF TEXT2 PRESENT                                        */ 03454000
*   /*                                                               */ 03455000
*   /*****************************************************************/ 03456000
*                                                                  0945 03457000
*   IF STR2F='0'B THEN              /* IF NO, STRING COUNT CASE      */ 03458000
@RC00894 L     @12,TABPTR1                                         0945 03459000
         TM    STR2F(@12),B'10000000'                              0945 03460000
         BNZ   @RF00945                                            0945 03461000
*     DO;                           /* PREPARE TO CALL IKJEBECN      */ 03462000
*       CHARCNT=OFF1-1;             /* SET COUNT TO ZERO ORG         */ 03463000
*                                                                  0947 03464000
         L     @12,OFF1                                            0947 03465000
         BCTR  @12,0                                               0947 03466000
         ST    @12,CHARCNT                                         0947 03467000
*       /*************************************************************/ 03468000
*       /*                                                           */ 03469000
*       /* CALL CHARATER COUNT PROCESSING RTN                        */ 03470000
*       /*                                                           */ 03471000
*       /*************************************************************/ 03472000
*                                                                  0948 03473000
*       CALL CHARRTN;                                              0948 03474000
         BAL   @14,CHARRTN                                         0948 03475000
*       GO TO CHGEXIT5;             /* RETURN TO CALLER              */ 03476000
         B     CHGEXIT5                                            0949 03477000
*     END;                                                         0950 03478000
*INSTXT:                                                           0951 03479000
*   CALL RECSHIFT;                  /* PREPARE LINE FOR CHANGE       */ 03480000
@RF00945 DS    0H                                                  0951 03481000
INSTXT   BAL   @14,RECSHIFT                                        0951 03482000
*   SECHARCT=SECHARCT               /* UPDATE CHAR COUNT BY A45363   */ 03483000
*       -STR1L+1;                   /* NUMBR CHAR REPLACED-1 A45363  */ 03484000
*                                                                  0952 03485000
         LH    @12,SECHARCT                                        0952 03486000
         L     @08,TABPTR1                                         0952 03487000
         SH    @12,STR1L(,@08)                                     0952 03488000
         AL    @12,@CF00060                                        0952 03489000
         STH   @12,SECHARCT                                        0952 03490000
*   /*****************************************************************/ 03491000
*   /*                                                               */ 03492000
*   /* ************************************************** A45363     */ 03493000
*   /* CHECK IF STRING SEARCH CHAR COUNT IS NEGATIVE A45363          */ 03494000
*   /* ************************************************** A45363     */ 03495000
*   /*                                                               */ 03496000
*   /*****************************************************************/ 03497000
*                                                                  0953 03498000
*   IF SECHARCT<0                   /* A45363                        */ 03499000
*     THEN                          /* A45363                        */ 03500000
         SLR   @08,@08                                             0953 03501000
         CR    @12,@08                                             0953 03502000
         BNL   @RF00953                                            0953 03503000
*     SECHARCT=0;                   /* IF YES, SET TO ZERO A45363    */ 03504000
         STH   @08,SECHARCT                                        0954 03505000
*   SEOFFS=OFF1+STR2L-1;            /* UPDATE TO NEW LINE OFFSET     */ 03506000
*                                                                  0955 03507000
@RF00953 L     @12,OFF1                                            0955 03508000
         L     @08,TABPTR1                                         0955 03509000
         LH    @08,STR2L(,@08)                                     0955 03510000
         ALR   @08,@12                                             0955 03511000
         BCTR  @08,0                                               0955 03512000
         STH   @08,SEOFFS                                          0955 03513000
*   /*****************************************************************/ 03514000
*   /*                                                               */ 03515000
*   /* CHECK IF TEXT1 BEGINS IN COLUMN ONE                           */ 03516000
*   /*                                                               */ 03517000
*   /*****************************************************************/ 03518000
*                                                                  0956 03519000
*   IF OFF1>1 THEN                  /* IF NO, MOVE DATA UPTO CHANGE  */ 03520000
         CH    @12,@CH00060                                        0956 03521000
         BNH   @RF00956                                            0956 03522000
*     TEXTBFR(1:OFF1-1)=RECTEXT;    /* MOVE TO TEMP BUFFER           */ 03523000
*                                                                  0957 03524000
         BCTR  @12,0                                               0957 03525000
         BCTR  @12,0                                               0957 03526000
         EX    @12,@SM01549                                        0957 03527000
*   /*****************************************************************/ 03528000
*   /*                                                               */ 03529000
*   /* CHECK IF NULL TEXT2 SPECIFIED                                 */ 03530000
*   /*                                                               */ 03531000
*   /*****************************************************************/ 03532000
*                                                                  0958 03533000
*   IF STR2L^=0 THEN                /* IF NO, REPLACE TEXT IN LINE   */ 03534000
*                                                                  0958 03535000
@RF00956 L     @12,TABPTR1                                         0958 03536000
         LH    @12,STR2L(,@12)                                     0958 03537000
         LTR   @12,@12                                             0958 03538000
         BZ    @RF00958                                            0958 03539000
*     /***************************************************************/ 03540000
*     /*                                                             */ 03541000
*     /* INSERT TEXT2 IN TEMPORARY BUFFER                            */ 03542000
*     /*                                                             */ 03543000
*     /***************************************************************/ 03544000
*                                                                  0959 03545000
*     TEXTBFR(OFF1:OFF1+STR2L-1)=STR2PTR->STRING;                  0959 03546000
*                                                                  0959 03547000
         LR    @08,COMMREG                                         0959 03548000
         AL    @08,OFF1                                            0959 03549000
         BCTR  @12,0                                               0959 03550000
         L     @07,STR2PTR                                         0959 03551000
         EX    @12,@SM01551                                        0959 03552000
*   /*****************************************************************/ 03553000
*   /*                                                               */ 03554000
*   /* CHECK IF MORE DATA AFTER CHANGE AREA IN RECORD                */ 03555000
*   /*                                                               */ 03556000
*   /*****************************************************************/ 03557000
*                                                                  0960 03558000
*   IF RECLEN>OFF1+STR1L+3 THEN     /* IF YES, MOVE REST OF DATA     */ 03559000
*                                                                  0960 03560000
@RF00958 LH    @12,RECLEN(,COMMREG)                                0960 03561000
         L     @08,OFF1                                            0960 03562000
         L     @07,TABPTR1                                         0960 03563000
         LH    @05,STR1L(,@07)                                     0960 03564000
         LR    @15,@08                                             0960 03565000
         ALR   @15,@05                                             0960 03566000
         LA    @00,3                                               0960 03567000
         ALR   @00,@15                                             0960 03568000
         CR    @12,@00                                             0960 03569000
         BNH   @RF00960                                            0960 03570000
*     /***************************************************************/ 03571000
*     /*                                                             */ 03572000
*     /* MOVE DATA BEYOND TEXT CHANGE INTO TEMP BFR                  */ 03573000
*     /*                                                             */ 03574000
*     /***************************************************************/ 03575000
*                                                                  0961 03576000
*     TEXTBFR(OFF1+STR2L:RECLEN+STR2L-STR1L-4)=RECTEXT(OFF1+STR1L: 0961 03577000
*         RECLEN-4);                                               0961 03578000
*                                                                  0961 03579000
         LH    @07,STR2L(,@07)                                     0961 03580000
         ALR   @08,@07                                             0961 03581000
         ST    @08,@TF00001                                        0961 03582000
         ALR   @08,COMMREG                                         0961 03583000
         ALR   @12,@07                                             0961 03584000
         SLR   @12,@05                                             0961 03585000
         SL    @12,@TF00001                                        0961 03586000
         SH    @12,@CH00602                                        0961 03587000
         ALR   @15,COMMREG                                         0961 03588000
         EX    @12,@SM01553                                        0961 03589000
*   /*****************************************************************/ 03590000
*   /*                                                               */ 03591000
*   /* CALCULATE NEW LENGTH OF DATA                                  */ 03592000
*   /*                                                               */ 03593000
*   /*****************************************************************/ 03594000
*                                                                  0962 03595000
*   ENDPTR=RECLEN+STR2L-STR1L-4;                                   0962 03596000
*                                                                  0962 03597000
@RF00960 L     @12,TABPTR1                                         0962 03598000
         LH    ENDPTR,RECLEN(,COMMREG)                             0962 03599000
         AH    ENDPTR,STR2L(,@12)                                  0962 03600000
         SH    ENDPTR,STR1L(,@12)                                  0962 03601000
         SH    ENDPTR,@CH00602                                     0962 03602000
*   /*****************************************************************/ 03603000
*   /*                                                               */ 03604000
*   /* CHECK IF LINE EMPTY AFTER CHANGE OPERATION                    */ 03605000
*   /*                                                               */ 03606000
*   /*****************************************************************/ 03607000
*                                                                  0963 03608000
*   IF ENDPTR=0 THEN                /* IF YES, GENERATE BLANK LINE   */ 03609000
         LTR   ENDPTR,ENDPTR                                       0963 03610000
         BNZ   @RF00963                                            0963 03611000
*     DO;                           /* PUT ONE BLANK IN LINE         */ 03612000
*       TEXTBFR(1)=' ';             /* BLANK 1ST CHARACTER           */ 03613000
         MVI   TEXTBFR(COMMREG),C' '                               0965 03614000
*       ENDPTR=1;                   /* SET NEW LENGTH TO ONE         */ 03615000
         LA    ENDPTR,1                                            0966 03616000
*     END;                                                         0967 03617000
*                                                                  0967 03618000
*   /*****************************************************************/ 03619000
*   /*                                                               */ 03620000
*   /* CHECK IF DATA PORTION OF NEW LINE EXCEEDS 256                 */ 03621000
*   /*                                                               */ 03622000
*   /*****************************************************************/ 03623000
*                                                                  0968 03624000
*   IF ENDPTR>256 THEN              /* IF YES, MOVE IN TWO PARTS     */ 03625000
@RF00963 CH    ENDPTR,@CH00571                                     0968 03626000
         BNH   @RF00968                                            0968 03627000
*     DO;                           /* USE DOUBLE BFR BASED ON DATA  */ 03628000
*       NEWTEXT(1:256)=             /* FIRST MOVE                    */ 03629000
*           TEXTBFR(1:256);                                        0970 03630000
         MVC   NEWTEXT(256,COMMREG),TEXTBFR(COMMREG)               0970 03631000
*       NEWTEXT(257:ENDPTR)=        /* SECOND MOVE                   */ 03632000
*           TEXTBFR(257:ENDPTR);                                   0971 03633000
         LR    @12,ENDPTR                                          0971 03634000
         SH    @12,@CH01465                                        0971 03635000
         EX    @12,@SM01555                                        0971 03636000
*     END;                                                         0972 03637000
*   ELSE                            /* IF NO, MOVE IN ONE PART       */ 03638000
*     RECTEXT(1:ENDPTR)=TEXTBFR(1:ENDPTR);                         0973 03639000
         B     @RC00968                                            0973 03640000
@RF00968 LR    @12,ENDPTR                                          0973 03641000
         BCTR  @12,0                                               0973 03642000
         EX    @12,@SM01557                                        0973 03643000
*   RECLEN=ENDPTR+4;                /* SET NEW LENGTH OF TEXT        */ 03644000
@RC00968 LA    @08,4                                               0974 03645000
         ALR   @08,ENDPTR                                          0974 03646000
         STH   @08,RECLEN(,COMMREG)                                0974 03647000
*   LETXTPTR=ADDR(RECLEN);          /* PTR TO TEXT                   */ 03648000
         LA    @08,RECLEN(,COMMREG)                                0975 03649000
         ST    @08,LETXTPTR                                        0975 03650000
*   LECODE='00'X;                   /* NOT DELIMITED STRING CODE     */ 03651000
         MVI   LECODE,X'00'                                        0976 03652000
*   CALL LINEEDIT;                  /* LINE EDIT TEXT                */ 03653000
         BAL   @14,LINEEDIT                                        0977 03654000
*CHKOVRFL:                                                         0978 03655000
*   ;                               /* OVERFLOW AND WRITE PROCESS    */ 03656000
*                                                                  0978 03657000
CHKOVRFL DS    0H                                                  0979 03658000
*   /*****************************************************************/ 03659000
*   /*                                                               */ 03660000
*   /* CHECK IF ALL CHANGES COMPLETED ON PREVIOUS LINES AND THEIR    */ 03661000
*   /* ASSOCIATED OVERFLOW LINES AND VERIFY IS NOT IN EFFECT         */ 03662000
*   /*                                                               */ 03663000
*   /*****************************************************************/ 03664000
*                                                                  0979 03665000
*   IF KEYFLD>VERKEY+VERCNT&CAVRFYSW='0'B THEN/* IF YES, RESET     0979 03666000
*                                      OVERFLOW CNTR                 */ 03667000
         L     @08,VERKEY                                          0979 03668000
         AL    @08,VERCNT                                          0979 03669000
         C     @08,KEYFLD(,COMMREG)                                0979 03670000
         BNL   @RF00979                                            0979 03671000
         TM    CAVRFYSW(COMMREG),B'01000000'                       0979 03672000
         BNZ   @RF00979                                            0979 03673000
*     VERCNT=0;                     /* SET COUNTER TO ZERO           */ 03674000
*                                                                  0980 03675000
         SLR   @08,@08                                             0980 03676000
         ST    @08,VERCNT                                          0980 03677000
*   /*****************************************************************/ 03678000
*   /*                                                               */ 03679000
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */ 03680000
*   /*                                                               */ 03681000
*   /*****************************************************************/ 03682000
*                                                                  0981 03683000
*   IF RETCODE=4 THEN               /* IF YES, PROCESS CONDITION     */ 03684000
@RF00979 CH    RETCODE,@CH00602                                    0981 03685000
         BNE   @RF00981                                            0981 03686000
*     DO;                           /* PROCESS OVERFLOW AND SEND   0982 03687000
*                                      APPROPRIATE MESSAGE           */ 03688000
*                                                                  0982 03689000
*       /*************************************************************/ 03690000
*       /*                                                           */ 03691000
*       /* CHECK IF NON-LINE NUMBERED TEXT DATA SET TYPE             */ 03692000
*       /*                                                           */ 03693000
*       /*************************************************************/ 03694000
*                                                                  0983 03695000
*       IF CANONUM='1'B&CADSCODE=CATEXT THEN/* IF YES, BRANCH TO   0983 03696000
*                                      PROCESS                       */ 03697000
         TM    CANONUM(COMMREG),B'00000001'                        0983 03698000
         BNO   @RF00983                                            0983 03699000
         CLI   CADSCODE(COMMREG),X'05'                             0983 03700000
         BNE   @RF00983                                            0983 03701000
*         DO;                       /* SPECIAL PROCESS FOR TEXT      */ 03702000
*           J=KEYFLD;               /* SAVE KEY OF CHANGED RECORD    */ 03703000
         L     J,KEYFLD(,COMMREG)                                  0985 03704000
*           GO TO LNOVRFL1;         /* PROCESS OVERFLOW LINES        */ 03705000
         B     LNOVRFL1                                            0986 03706000
*         END;                                                     0987 03707000
*                                                                  0987 03708000
*       /*************************************************************/ 03709000
*       /*                                                           */ 03710000
*       /* CHECK IF FIRST TIME LINE TRUNCATED                        */ 03711000
*       /*                                                           */ 03712000
*       /*************************************************************/ 03713000
*                                                                  0988 03714000
*       IF TRUNCKEY^=KEYFLD THEN    /* IF YES, ISSUE TRUNCATION MSG  */ 03715000
@RF00983 L     @12,KEYFLD(,COMMREG)                                0988 03716000
         C     @12,TRUNCKEY                                        0988 03717000
         BE    @RF00988                                            0988 03718000
*         DO;                                                      0989 03719000
*           TRUNCKEY=KEYFLD;        /* MARK AS LAST LINE TRUNC       */ 03720000
         ST    @12,TRUNCKEY                                        0990 03721000
*           RELMSG1=1293;           /* MSG IKJ52507I                 */ 03722000
         MVC   RELMSG1(2),@CH01419                                 0991 03723000
*           BINRYREG=CALRECL-4;     /* DATA SET LINE SIZE            */ 03724000
*                                                                  0992 03725000
         LH    BINRYREG,CALRECL(,COMMREG)                          0992 03726000
         SH    BINRYREG,@CH00602                                   0992 03727000
*           /*********************************************************/ 03728000
*           /*                                                       */ 03729000
*           /* ----------------------------------------- CONVERT TO  */ 03730000
*           /* DECIMAL, UNPACK AND SET ZONE SIGN FOR EBCDIC          */ 03731000
*           /* CHARACTERS -----------------------------------------  */ 03732000
*           /* CONVERT NUMBER TO DECIMAL                             */ 03733000
*           /*                                                       */ 03734000
*           /*********************************************************/ 03735000
*                                                                  0993 03736000
*           GEN(CVD BINRYREG,PACKAREA)                             0993 03737000
*           REFS(BINRYREG,PACKAREA);                               0993 03738000
*                                                                  0993 03739000
         CVD BINRYREG,PACKAREA                                          03740000
*           /*********************************************************/ 03741000
*           /*                                                       */ 03742000
*           /* UNPACK DECIMAL RESULT                                 */ 03743000
*           /*                                                       */ 03744000
*           /*********************************************************/ 03745000
*                                                                  0994 03746000
*           GENERATE REFS(PACKAREA);                               0994 03747000
*                                                                  0994 03748000
         UNPK  PACKAREA(3),PACKAREA+6(2)                                03749000
*           /*********************************************************/ 03750000
*           /*                                                       */ 03751000
*           /* SET ZONE SIGN                                         */ 03752000
*           /*                                                       */ 03753000
*           /*********************************************************/ 03754000
*                                                                  0995 03755000
*           PACKAREA(3)=PACKAREA(3)|'F0'X;                         0995 03756000
         OI    PACKAREA+2,X'F0'                                    0995 03757000
*           MSGPTR2=0;              /* NO 2ND INSERTION              */ 03758000
         SLR   @12,@12                                             0996 03759000
         ST    @12,MSGPTR2(,COMMREG)                               0996 03760000
*           MSGOFF2=25;             /* OFFSET FOR INSERTION          */ 03761000
*                                                                  0997 03762000
         MVC   MSGOFF2(2,COMMREG),@CH01421                         0997 03763000
*           /*********************************************************/ 03764000
*           /*                                                       */ 03765000
*           /* REMOVE ALL LEADING ZEROES FROM MSG INSERT             */ 03766000
*           /*                                                       */ 03767000
*           /*********************************************************/ 03768000
*                                                                  0998 03769000
*           DO I=1 TO 3;                                           0998 03770000
*                                                                  0998 03771000
         LA    I,1                                                 0998 03772000
@DL00998 DS    0H                                                  0999 03773000
*             /*******************************************************/ 03774000
*             /*                                                     */ 03775000
*             /* CHECK IF NON-ZERO CHARACTER FOUND                   */ 03776000
*             /*                                                     */ 03777000
*             /*******************************************************/ 03778000
*                                                                  0999 03779000
*             IF PACKAREA(I)^='0' THEN/* IF YES, BRANCH OJT          */ 03780000
         LA    @12,PACKAREA-1(I)                                   0999 03781000
         CLI   0(@12),C'0'                                         0999 03782000
         BNE   @RT00999                                            0999 03783000
*               GO TO OUT1;         /* FIRST NON-ZERO FOUND          */ 03784000
*           END;                    /* END OF DO LOOP. NO FALL     1001 03785000
*                                      THROUGH, SINCE ALWAYS HAVE  1001 03786000
*                                      VALID NONZERO VALUE.          */ 03787000
         AL    I,@CF00060                                          1001 03788000
         CH    I,@CH00164                                          1001 03789000
         BNH   @DL00998                                            1001 03790000
*OUT1:                                                             1002 03791000
*           MSGTEXT2=PACKAREA(I:3); /* MOVE TEXT                     */ 03792000
OUT1     MVI   MSGTEXT2+1(COMMREG),C' '                            1002 03793000
         MVC   MSGTEXT2+2(70,COMMREG),MSGTEXT2+1(COMMREG)          1002 03794000
         LA    @12,3                                               1002 03795000
         SLR   @12,I                                               1002 03796000
         LA    @08,PACKAREA-1(I)                                   1002 03797000
         EX    @12,@SM01535                                        1002 03798000
*           MSGLEN2=8-I;            /* LENGTH OF INSERTION           */ 03799000
         LA    @12,8                                               1003 03800000
         SLR   @12,I                                               1003 03801000
         STH   @12,MSGLEN2(,COMMREG)                               1003 03802000
*           RELMSG2=1;              /* NO 2ND LEVEL MESSAGE          */ 03803000
*                                                                  1004 03804000
         MVC   RELMSG2(2),@CH00060                                 1004 03805000
*           /*********************************************************/ 03806000
*           /*                                                       */ 03807000
*           /* CHECK IF DATA SET IS LINE NUMBERED                    */ 03808000
*           /*                                                       */ 03809000
*           /*********************************************************/ 03810000
*                                                                  1005 03811000
*           IF CANONUM='1'B THEN    /* IF NO, NO LINE NUMBER REFER   */ 03812000
         TM    CANONUM(COMMREG),B'00000001'                        1005 03813000
         BNO   @RF01005                                            1005 03814000
*             LEV1INS=0;            /* NO 1ST LEVEL INSRT            */ 03815000
         SLR   LEV1INS,LEV1INS                                     1006 03816000
*           ELSE                    /* IF YES, INSERT NUMBER IN MSG  */ 03817000
*             DO;                   /* DETERMINE MESSAGE INSERTION   */ 03818000
         B     @RC01005                                            1007 03819000
@RF01005 DS    0H                                                  1008 03820000
*               BINRYREG=KEYFLD;    /* BINARY LNUMBR                 */ 03821000
*                                                                  1008 03822000
         L     BINRYREG,KEYFLD(,COMMREG)                           1008 03823000
*               /*****************************************************/ 03824000
*               /*                                                   */ 03825000
*               /* ------------------------------- CONVERT TO        */ 03826000
*               /* DECIMAL, UNPACK AND SET ZONE SIGN FOR EBCDIC      */ 03827000
*               /* ------------------------------- CONVERT NUMBER TO */ 03828000
*               /* DECIMAL AND UNPACK DECIMAL RESULT                 */ 03829000
*               /*                                                   */ 03830000
*               /*****************************************************/ 03831000
*                                                                  1009 03832000
*               GENERATE REFS(BINRYREG);                           1009 03833000
*                                                                  1009 03834000
         CVD   BINRYREG,PACKTEMP                                        03835000
         UNPK  PACKAREA(8),PACKTEMP(8)                                  03836000
*               /*****************************************************/ 03837000
*               /*                                                   */ 03838000
*               /* SET ZONE SIGN                                     */ 03839000
*               /*                                                   */ 03840000
*               /*****************************************************/ 03841000
*                                                                  1010 03842000
*               PACKAREA(8)=PACKAREA(8)|'F0'X;                     1010 03843000
*                                                                  1010 03844000
         OI    PACKAREA+7,X'F0'                                    1010 03845000
*               /*****************************************************/ 03846000
*               /*                                                   */ 03847000
*               /* REMOVE ALL LEADING ZEROES                         */ 03848000
*               /*                                                   */ 03849000
*               /*****************************************************/ 03850000
*                                                                  1011 03851000
*               DO I=1 TO 7;                                       1011 03852000
*                                                                  1011 03853000
         LA    I,1                                                 1011 03854000
@DL01011 DS    0H                                                  1012 03855000
*                 /***************************************************/ 03856000
*                 /*                                                 */ 03857000
*                 /* CHECK IF FIRST SIGNIFICANT DIGIT FOUND          */ 03858000
*                 /*                                                 */ 03859000
*                 /***************************************************/ 03860000
*                                                                  1012 03861000
*                 IF PACKAREA(I)^='0' THEN/* IF YES, BRANCH OUT      */ 03862000
         LA    @12,PACKAREA-1(I)                                   1012 03863000
         CLI   0(@12),C'0'                                         1012 03864000
         BNE   @RT01012                                            1012 03865000
*                   GO TO FOUND1;   /* FIRST DGT                     */ 03866000
*               END;                /* END OF DO LOOP. FALL THROUGH     03867000
*                                      ONLY IF VALUE IS ZERO. MINIMUM   03868000
*                                      OF ONE CHARACTER MUST BE SENT    03869000
*                                      AS LINE NUMBER.               */ 03870000
         AL    I,@CF00060                                          1014 03871000
         CH    I,@CH00126                                          1014 03872000
         BNH   @DL01011                                            1014 03873000
*               I=8;                /* SET TO SIGNIF. POSITION       */ 03874000
         LA    I,8                                                 1015 03875000
*FOUND1:                                                           1016 03876000
*               MSGTEXT=PACKAREA(I:8);/* INSERT                      */ 03877000
FOUND1   MVI   MSGTEXT+1(COMMREG),C' '                             1016 03878000
         MVC   MSGTEXT+2(70,COMMREG),MSGTEXT+1(COMMREG)            1016 03879000
         LA    @12,8                                               1016 03880000
         SLR   @12,I                                               1016 03881000
         LA    @08,PACKAREA-1(I)                                   1016 03882000
         EX    @12,@SM01537                                        1016 03883000
*               MSGOFF=15;          /* OFFSET FOR INS                */ 03884000
         MVC   MSGOFF(2,COMMREG),@CH00065                          1017 03885000
*               MSGLEN=13-I;        /* LENGTH OF TXT                 */ 03886000
         LA    @12,13                                              1018 03887000
         SLR   @12,I                                               1018 03888000
         STH   @12,MSGLEN(,COMMREG)                                1018 03889000
*               MSGPTR=0;           /* NO 2ND INSERTION              */ 03890000
         SLR   @12,@12                                             1019 03891000
         ST    @12,MSGPTR(,COMMREG)                                1019 03892000
*               LEV1INS=ADDR(MSGAREA);/* PTR TO INSERT               */ 03893000
         LA    LEV1INS,MSGAREA(,COMMREG)                           1020 03894000
*             END;                                                 1021 03895000
*           LEV2INS=ADDR(MSGPTR2);  /* PTR TO INSERTION              */ 03896000
@RC01005 LA    LEV2INS,MSGPTR2(,COMMREG)                           1022 03897000
*           CALL SENDMSG;           /* SEND MESSAGE TO USER          */ 03898000
         BAL   @14,SENDMSG                                         1023 03899000
*         END;                                                     1024 03900000
*     END;                                                         1025 03901000
@RF00988 DS    0H                                                  1026 03902000
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */ 03903000
@RF00981 MVI   UTCODE,X'20'                                        1026 03904000
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO RECORD TO BE WRITTEN   */ 03905000
         LA    @08,KEYFLD(,COMMREG)                                1027 03906000
         ST    @08,KEYPTR                                          1027 03907000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 03908000
         OI    PLISTEND,B'10000000'                                1028 03909000
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */ 03910000
         SLR   @08,@08                                             1029 03911000
         ST    @08,AREAPTR                                         1029 03912000
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */ 03913000
*                                                                  1030 03914000
         BAL   @14,RDWRTRTN                                        1030 03915000
*   /*****************************************************************/ 03916000
*   /*                                                               */ 03917000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 03918000
*   /*                                                               */ 03919000
*   /*****************************************************************/ 03920000
*                                                                  1031 03921000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 03922000
         CH    RETCODE,@CH00145                                    1031 03923000
         BE    @RT01031                                            1031 03924000
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */ 03925000
*                                                                  1032 03926000
*   /*****************************************************************/ 03927000
*   /*                                                               */ 03928000
*   /* CHECK IF THIS IS FIRST CHANGE                                 */ 03929000
*   /*                                                               */ 03930000
*   /*****************************************************************/ 03931000
*                                                                  1033 03932000
*   IF FIRSTCHG='1'B THEN           /* IF YES, SET FIRST KEY VALUE   */ 03933000
         TM    FIRSTCHG,B'01000000'                                1033 03934000
         BNO   @RF01033                                            1033 03935000
*     VERKEY=KEYFLD;                /* FIRST LINE TO VERIFY          */ 03936000
         MVC   VERKEY(4),KEYFLD(COMMREG)                           1034 03937000
*   ELSE                            /* IF NO, VERIFY PREVIOUS LINE   */ 03938000
*     CALL VERFYRTN;                /* VERIFY LINE IF NECESSARY      */ 03939000
         B     @RC01033                                            1035 03940000
@RF01033 BAL   @14,VERFYRTN                                        1035 03941000
*                                                                  1036 03942000
*   /*****************************************************************/ 03943000
*   /*                                                               */ 03944000
*   /* CHECK IF DATA SET TYPE BASIC OR IPLI                          */ 03945000
*   /*                                                               */ 03946000
*   /*****************************************************************/ 03947000
*                                                                  1036 03948000
*   IF CADSCODE=CABASIC|CADSCODE=CAIPLI THEN/* IF YES, UPDATE REVERSE   03949000
*                                      POLISH DATA SET               */ 03950000
@RC01033 CLI   CADSCODE(COMMREG),X'20'                             1036 03951000
         BE    @RT01036                                            1036 03952000
         CLI   CADSCODE(COMMREG),X'21'                             1036 03953000
         BNE   @RF01036                                            1036 03954000
@RT01036 DS    0H                                                  1037 03955000
*     DO;                           /* PREPARE PARAMETER LIST AND  1037 03956000
*                                      CALL PROCESSOR IF AVAILABLE   */ 03957000
*       I=KEYFLD;                   /* SAVE KEY FIELD                */ 03958000
         L     I,KEYFLD(,COMMREG)                                  1038 03959000
*       J=RECLEN;                   /* USE REG TO SAVE LL FIELD      */ 03960000
*                                                                  1039 03961000
         LH    J,RECLEN(,COMMREG)                                  1039 03962000
*       /*************************************************************/ 03963000
*       /*                                                           */ 03964000
*       /* CHECK IF FIXED RECORD FORMAT                              */ 03965000
*       /*                                                           */ 03966000
*       /*************************************************************/ 03967000
*                                                                  1040 03968000
*       IF CARECFM='1'B THEN        /* IF YES, REMOVE CONTROL WORD   */ 03969000
         TM    CARECFM(COMMREG),B'01000000'                        1040 03970000
         BNO   @RF01040                                            1040 03971000
*         DO;                       /* INIT BUFFER PASSED            */ 03972000
*           SCPTR2=0;               /* NO CHAINED BFRS               */ 03973000
         SLR   @12,@12                                             1042 03974000
         ST    @12,SCPTR2(,COMMREG)                                1042 03975000
*           SCCNT2=1;               /* ONE RECORD SENT               */ 03976000
         MVI   SCCNT2(COMMREG),X'01'                               1043 03977000
*           CASYNBFR=ADDR(SCPTR2);  /* BFR PTR                       */ 03978000
         LA    @12,SCPTR2(,COMMREG)                                1044 03979000
         ST    @12,CASYNBFR(,COMMREG)                              1044 03980000
*         END;                                                     1045 03981000
*       ELSE                        /* IF NO, VARIABLE FORMAT        */ 03982000
*         DO;                       /* INIT BUFFER PASSED            */ 03983000
         B     @RC01040                                            1046 03984000
@RF01040 DS    0H                                                  1047 03985000
*           SCPTR1=0;               /* NO CHAINED BFRS               */ 03986000
         SLR   @12,@12                                             1047 03987000
         ST    @12,SCPTR1(,COMMREG)                                1047 03988000
*           SCCNT1=1;               /* ONE RECORD SENT               */ 03989000
         MVI   SCCNT1(COMMREG),X'01'                               1048 03990000
*           CASYNBFR=ADDR(SCPTR1);  /* BFR PTR                       */ 03991000
         LA    @12,SCPTR1(,COMMREG)                                1049 03992000
         ST    @12,CASYNBFR(,COMMREG)                              1049 03993000
*         END;                                                     1050 03994000
*                                                                  1050 03995000
*       /*************************************************************/ 03996000
*       /*                                                           */ 03997000
*       /* CHECK IF SYNTAX CHECKER AVAILABLE                         */ 03998000
*       /*                                                           */ 03999000
*       /*************************************************************/ 04000000
*                                                                  1051 04001000
*       IF CAPTCHK^=0 THEN          /* IF YES, PASS LINE TO CHECKER  */ 04002000
@RC01040 L     @12,CAPTCHK(,COMMREG)                               1051 04003000
         LTR   @12,@12                                             1051 04004000
         BZ    @RF01051                                            1051 04005000
*         DO;                       /* CALL CHECKER TO UPDATE LINE   */ 04006000
*           ENTRYCD='10000'B;       /* ENTRY CODE FOR ITF            */ 04007000
         MVI   ENTRYCD(COMMREG),B'10000000'                        1053 04008000
*           PARMREG1=ADDR(CASYNLST);/* PTR TO PARMLIST               */ 04009000
         LA    PARMREG1,CASYNLST(,COMMREG)                         1054 04010000
*           RFY                                                    1055 04011000
*             RETCDREG RSTD;                                       1055 04012000
*           CALL CHECKER;           /* UPDATE ITF DATA SET           */ 04013000
         LR    @15,@12                                             1056 04014000
         BALR  @14,@15                                             1056 04015000
*           KEYFLD=I;               /* RESTORE KEY FIELD             */ 04016000
         ST    I,KEYFLD(,COMMREG)                                  1057 04017000
*           RECLEN=J;               /* RESTORE LL FIELD              */ 04018000
*                                                                  1058 04019000
         STH   J,RECLEN(,COMMREG)                                  1058 04020000
*           /*********************************************************/ 04021000
*           /*                                                       */ 04022000
*           /* CHECK FOR PROCCESSOR MESSAGE                          */ 04023000
*           /*                                                       */ 04024000
*           /*********************************************************/ 04025000
*                                                                  1059 04026000
*           IF RETCDREG=4 THEN      /* YES, CHECK IF SCAN ON         */ 04027000
*                                                                  1059 04028000
         CH    RETCDREG,@CH00602                                   1059 04029000
         BNE   @RF01059                                            1059 04030000
*             /*******************************************************/ 04031000
*             /*                                                     */ 04032000
*             /* CHECK IF SCAN IS ON                                 */ 04033000
*             /*                                                     */ 04034000
*             /*******************************************************/ 04035000
*                                                                  1060 04036000
*             IF CASCANSW='1'B THEN /* YES,THEN FLUSH IS NEEDED      */ 04037000
         TM    CASCANSW(COMMREG),B'00010000'                       1060 04038000
         BO    @RT01060                                            1060 04039000
*               GO TO FLUSH1;       /* INDICATE FLUSH                */ 04040000
*             ELSE                  /* NO SCAN THEN:                 */ 04041000
*               GO TO CHKATTN1;     /* GO TO NEXT STEP               */ 04042000
         B     CHKATTN1                                            1062 04043000
*           ELSE                                                   1063 04044000
*             ;                                                    1063 04045000
*                                                                  1063 04046000
@RF01059 DS    0H                                                  1064 04047000
*           /*********************************************************/ 04048000
*           /*                                                       */ 04049000
*           /* CHECK FOR SUCCESSFUL RETURN                           */ 04050000
*           /*                                                       */ 04051000
*           /*********************************************************/ 04052000
*                                                                  1064 04053000
*           IF RETCDREG=0 THEN      /* IF YES, CONTINUE PROCESSING   */ 04054000
         SLR   @14,@14                                             1064 04055000
         CR    RETCDREG,@14                                        1064 04056000
         BE    @RT01064                                            1064 04057000
*             GO TO CHKATTN1;       /* NEXT STEP IN PRCS             */ 04058000
*                                                                  1065 04059000
*           /*********************************************************/ 04060000
*           /*                                                       */ 04061000
*           /* CHECK IF NOT ENOUGH CORE AVAILABLE                    */ 04062000
*           /*                                                       */ 04063000
*           /*********************************************************/ 04064000
*                                                                  1066 04065000
*           IF RETCDREG=16 THEN     /* IF YES, NOTIFY USER           */ 04066000
         CH    RETCDREG,@CH00236                                   1066 04067000
         BNE   @RF01066                                            1066 04068000
*             DO;                   /* SEND MESSAGE TO USER          */ 04069000
*               RELMSG1=270;        /* MSG IKJ52312I                 */ 04070000
         MVC   RELMSG1(2),@CH01371                                 1068 04071000
*               LEV2INS=0;          /* NO 2ND LEVEL INSERTION        */ 04072000
         SLR   LEV2INS,LEV2INS                                     1069 04073000
*               MSGPTR=0;           /* ONLY ONE INSERTION            */ 04074000
         ST    @14,MSGPTR(,COMMREG)                                1070 04075000
*               MSGLEN=CASCMDLN+4;  /* LENGTH                        */ 04076000
         LA    @12,4                                               1071 04077000
         AH    @12,CASCMDLN(,COMMREG)                              1071 04078000
         STH   @12,MSGLEN(,COMMREG)                                1071 04079000
*               MSGOFF=45;          /* OFFSET FOR INSERT             */ 04080000
         MVC   MSGOFF(2,COMMREG),@CH01373                          1072 04081000
*               MSGTEXT=CAPTSCMD->LNUM;/* INSERTION                  */ 04082000
         MVI   MSGTEXT+8(COMMREG),C' '                             1073 04083000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            1073 04084000
         L     @12,CAPTSCMD(,COMMREG)                              1073 04085000
         MVC   MSGTEXT(8,COMMREG),LNUM(@12)                        1073 04086000
*               LEV1INS=ADDR(MSGPTR);/* PTR TO INSERT                */ 04087000
         LA    LEV1INS,MSGPTR(,COMMREG)                            1074 04088000
*               RELMSG2=0;          /* NO SECOND LEVEL MSG           */ 04089000
         STH   @14,RELMSG2                                         1075 04090000
*               CALL SENDMSG;       /* SEND MESSAGE TO USER          */ 04091000
         BAL   @14,SENDMSG                                         1076 04092000
*               GO TO FLUSH1;       /* BRANCH TO INDICATE FL- USH    */ 04093000
         B     FLUSH1                                              1077 04094000
*             END;                                                 1078 04095000
*                                                                  1078 04096000
*           /*********************************************************/ 04097000
*           /*                                                       */ 04098000
*           /* CHECK IF PROCESSOR FAILED                             */ 04099000
*           /*                                                       */ 04100000
*           /*********************************************************/ 04101000
*                                                                  1079 04102000
*           IF RETCDREG=20 THEN     /* IF YES, TERMINATE             */ 04103000
@RF01066 CH    RETCDREG,@CH00136                                   1079 04104000
         BNE   @RF01079                                            1079 04105000
*             DO;                   /* NOTIFY IKJEBEMA AND EXIT      */ 04106000
*               CHRETCD=16;         /* SET RETURN CD                 */ 04107000
         MVC   CHRETCD(4),@CF00236                                 1081 04108000
*               GO TO NOTEXT1;      /* BEGIN EXIT PROCESS            */ 04109000
         B     NOTEXT1                                             1082 04110000
*             END;                                                 1083 04111000
*                                                                  1083 04112000
*           /*********************************************************/ 04113000
*           /*                                                       */ 04114000
*           /* CONVERT RETURN CODE TO PRINTABLE CHARACTER            */ 04115000
*           /*                                                       */ 04116000
*           /*********************************************************/ 04117000
*                                                                  1084 04118000
*           GENERATE REFS(PACKAREA);                               1084 04119000
@RF01079 DS    0H                                                  1084 04120000
         CVD   RETCDREG,PACKAREA                CONVERT TO DECIMAL      04121000
         UNPK  MSGTEXT2(3,COMMREG),PACKAREA+6(2)  UNPK NUM              04122000
         MVN   MSGTEXT2(2,COMMREG),MSGTEXT2+1(COMMREG) SET SIGN         04123000
*           RFY                                                    1085 04124000
*             RETCDREG UNRSTD;                                     1085 04125000
*           MSGTEXT(1:8)=CASYNAME;  /* INSERTION                     */ 04126000
*                                                                  1086 04127000
         MVC   MSGTEXT(8,COMMREG),CASYNAME(COMMREG)                1086 04128000
*           /*********************************************************/ 04129000
*           /*                                                       */ 04130000
*           /* REMOVE ALL TRAILING BLANKS                            */ 04131000
*           /*                                                       */ 04132000
*           /*********************************************************/ 04133000
*                                                                  1087 04134000
*           DO I=8 TO 1 BY-1;                                      1087 04135000
*                                                                  1087 04136000
         LA    I,8                                                 1087 04137000
@DL01087 DS    0H                                                  1088 04138000
*             /*******************************************************/ 04139000
*             /*                                                     */ 04140000
*             /* CHECK IF LAST NON-BLANK FOUND                       */ 04141000
*             /*                                                     */ 04142000
*             /*******************************************************/ 04143000
*                                                                  1088 04144000
*             IF MSGTEXT(I)^=' ' THEN/* IF YES, END OF INSERT FOUND  */ 04145000
         LR    @12,COMMREG                                         1088 04146000
         ALR   @12,I                                               1088 04147000
         CLI   MSGTEXT-1(@12),C' '                                 1088 04148000
         BNE   @RT01088                                            1088 04149000
*               GO TO LPOUT1;       /* EXIT FROM LOOP                */ 04150000
*           END;                    /* END OF DO LOOP. NO FALL     1090 04151000
*                                      THROUGH, SINCE ALWAYS HAVE  1090 04152000
*                                      VALID MODULE NAME.            */ 04153000
         BCTR  I,0                                                 1090 04154000
         LTR   I,I                                                 1090 04155000
         BP    @DL01087                                            1090 04156000
*LPOUT1:                                                           1091 04157000
*           MSGLEN=I+4;             /* LENGTH OF INSERTION           */ 04158000
LPOUT1   LA    @12,4                                               1091 04159000
         ALR   @12,I                                               1091 04160000
         STH   @12,MSGLEN(,COMMREG)                                1091 04161000
*           RELMSG1=271;            /* RELATIVE MSG NUMBER           */ 04162000
         MVC   RELMSG1(2),@CH01381                                 1092 04163000
*           LEV1INS=0;              /* NO FIRST LEVEL INSERTION      */ 04164000
         SLR   LEV1INS,LEV1INS                                     1093 04165000
*           RELMSG2=1;              /* SECOND LEVEL MSG              */ 04166000
         MVC   RELMSG2(2),@CH00060                                 1094 04167000
*           MSGOFF=10;              /* OFFSET FOR INSERTION          */ 04168000
         MVC   MSGOFF(2,COMMREG),@CH00541                          1095 04169000
*           MSGPTR=ADDR(MSGPTR2);   /* CHAIN INSERTIONS              */ 04170000
         LA    @12,MSGPTR2(,COMMREG)                               1096 04171000
         ST    @12,MSGPTR(,COMMREG)                                1096 04172000
*           MSGPTR2=0;              /* INDICATE LAST INSERTION       */ 04173000
         SLR   @12,@12                                             1097 04174000
         ST    @12,MSGPTR2(,COMMREG)                               1097 04175000
*           MSGLEN2=6;              /* LENGTH OF INSERTION           */ 04176000
         MVC   MSGLEN2(2,COMMREG),@CH00510                         1098 04177000
*           MSGOFF2=22;             /* OFFSET FOR INSERT             */ 04178000
         MVC   MSGOFF2(2,COMMREG),@CH01361                         1099 04179000
*           LEV2INS=ADDR(MSGPTR);   /* PTR TO INSERTS                */ 04180000
         LA    LEV2INS,MSGPTR(,COMMREG)                            1100 04181000
*           CALL SENDMSG;           /* SEND MESSAGE TO USER          */ 04182000
         BAL   @14,SENDMSG                                         1101 04183000
*FLUSH1:                                                           1102 04184000
*           CHRETCD=8;              /* INDICATE FLUSH NEEDED         */ 04185000
FLUSH1   MVC   CHRETCD(4),@CF00058                                 1102 04186000
*           GO TO CHGEXIT4;         /* RETURN TO CALLER              */ 04187000
         B     CHGEXIT4                                            1103 04188000
*         END;                                                     1104 04189000
*       KEYFLD=I;                   /* RESTORE KEY FIELD             */ 04190000
@RF01051 ST    I,KEYFLD(,COMMREG)                                  1105 04191000
*       RECLEN=J;                   /* RESTORE LL FIELD              */ 04192000
         STH   J,RECLEN(,COMMREG)                                  1106 04193000
*     END;                                                         1107 04194000
*   GO TO CHKATTN1;                 /* BRANCH TO ATTENTION CHECK     */ 04195000
         B     CHKATTN1                                            1108 04196000
*LNOVRFL1:                          /*                               */ 04197000
*                                                                  1109 04198000
*   /*****************************************************************/ 04199000
*   /*                                                               */ 04200000
*   /* CHECK IF THIS IS FIRST LINE CHANGE                            */ 04201000
*   /*                                                               */ 04202000
*   /*****************************************************************/ 04203000
*                                                                  1109 04204000
*   IF FIRSTCHG='1'B THEN           /* IF YES, SET KEY VALUE         */ 04205000
LNOVRFL1 TM    FIRSTCHG,B'01000000'                                1109 04206000
         BNO   @RF01109                                            1109 04207000
*     VERKEY=KEYFLD;                /* FIRST LINE TO VERIFY          */ 04208000
         MVC   VERKEY(4),KEYFLD(COMMREG)                           1110 04209000
*   ELSE                            /* IF NO, VERIFY LINE            */ 04210000
*     CALL VERFYRTN;                /* VERIFY LINE IF NECESSARY      */ 04211000
         B     @RC01109                                            1111 04212000
@RF01109 BAL   @14,VERFYRTN                                        1111 04213000
*NEXTLINE:                                                         1112 04214000
*   START=RECLEN-4;                 /* START BLANK SCAN AT LINE END  */ 04215000
*                                                                  1112 04216000
@RC01109 DS    0H                                                  1112 04217000
NEXTLINE LH    START,RECLEN(,COMMREG)                              1112 04218000
         SH    START,@CH00602                                      1112 04219000
*   /*****************************************************************/ 04220000
*   /*                                                               */ 04221000
*   /* FIND LOGICAL BREAKPOINT IN LINE(I.E. LAST BLANK IN RECORD     */ 04222000
*   /*                                                               */ 04223000
*   /*****************************************************************/ 04224000
*                                                                  1113 04225000
*   DO I=START TO 1 BY-1;                                          1113 04226000
*                                                                  1113 04227000
         LR    I,START                                             1113 04228000
         B     @DE01113                                            1113 04229000
@DL01113 DS    0H                                                  1114 04230000
*     /***************************************************************/ 04231000
*     /*                                                             */ 04232000
*     /* CHECK IF LAST BLANK FOUND                                   */ 04233000
*     /*                                                             */ 04234000
*     /***************************************************************/ 04235000
*                                                                  1114 04236000
*     IF RECTEXT(I)=' ' THEN        /* IF YES, BREAK POINT IN LINE   */ 04237000
         LR    @12,COMMREG                                         1114 04238000
         ALR   @12,I                                               1114 04239000
         CLI   RECTEXT-1(@12),C' '                                 1114 04240000
         BE    @RT01114                                            1114 04241000
*       GO TO BREAKLN1;             /* PREPARE TO BREAK LINE         */ 04242000
*   END;                            /* END OF DO LOOP. FALL THROUGH     04243000
*                                      ONLY IF NO BLANKS IN LINE     */ 04244000
         BCTR  I,0                                                 1116 04245000
@DE01113 LTR   I,I                                                 1116 04246000
         BP    @DL01113                                            1116 04247000
*   I=START;                        /* SET BREAKPOINT MARKER AT END     04248000
*                                      OF RECORD                     */ 04249000
         LR    I,START                                             1117 04250000
*BREAKLN1:                          /*                               */ 04251000
*                                                                  1118 04252000
*   /*****************************************************************/ 04253000
*   /*                                                               */ 04254000
*   /* CHECK IF BLANK NOT LAST CHARACTER IN LINE                     */ 04255000
*   /*                                                               */ 04256000
*   /*****************************************************************/ 04257000
*                                                                  1118 04258000
*   IF I<START THEN                 /* IF YES, BREAK LINE AT BLANK   */ 04259000
BREAKLN1 CR    I,START                                             1118 04260000
         BNL   @RF01118                                            1118 04261000
*     DO;                           /* FORM OVERFLOW LINE            */ 04262000
*                                                                  1119 04263000
*       /*************************************************************/ 04264000
*       /*                                                           */ 04265000
*       /* MOVE DATA BEYOND BREAKPOINT INTO 2ND BFR                  */ 04266000
*       /*                                                           */ 04267000
*       /*************************************************************/ 04268000
*                                                                  1120 04269000
*       RECTEXT2=RECTEXT(I+1:START);                               1120 04270000
*                                                                  1120 04271000
         MVI   RECTEXT2+1(COMMREG),C' '                            1120 04272000
         MVC   RECTEXT2+2(253,COMMREG),RECTEXT2+1(COMMREG)         1120 04273000
         LR    @12,START                                           1120 04274000
         SLR   @12,I                                               1120 04275000
         LR    @08,@12                                             1120 04276000
         BCTR  @08,0                                               1120 04277000
         LR    @07,COMMREG                                         1120 04278000
         ALR   @07,I                                               1120 04279000
         EX    @08,@SM01539                                        1120 04280000
*       /*************************************************************/ 04281000
*       /*                                                           */ 04282000
*       /* ADD ON LINE OVERFLOW TO EXTRA DATA IN MAIN LINE           */ 04283000
*       /*                                                           */ 04284000
*       /*************************************************************/ 04285000
*                                                                  1121 04286000
*       RECTEXT2(START-I+1:START-I+EXTRALEN-4)=EXTRALN;            1121 04287000
*                                                                  1121 04288000
         ST    @12,@TF00001                                        1121 04289000
         ALR   @12,COMMREG                                         1121 04290000
         L     @08,LETXTPTR                                        1121 04291000
         LH    @07,EXTRALEN(,@08)                                  1121 04292000
         LR    @15,@07                                             1121 04293000
         SH    @15,@CH00132                                        1121 04294000
         EX    @15,@SM01541                                        1121 04295000
*       /*************************************************************/ 04296000
*       /*                                                           */ 04297000
*       /* CALCULATE LENGTH OF NEW LINE                              */ 04298000
*       /*                                                           */ 04299000
*       /*************************************************************/ 04300000
*                                                                  1122 04301000
*       RECLEN2=START-I+EXTRALEN;                                  1122 04302000
*                                                                  1122 04303000
         AL    @07,@TF00001                                        1122 04304000
         STH   @07,RECLEN2(,COMMREG)                               1122 04305000
*       /*************************************************************/ 04306000
*       /*                                                           */ 04307000
*       /* PROPAGATE BLANKS IN CHANGED LINE                          */ 04308000
*       /*                                                           */ 04309000
*       /*************************************************************/ 04310000
*                                                                  1123 04311000
*       MVC(RECTEXT(I+1:START),RECTEXT(I:START-1));                1123 04312000
         LR    @12,COMMREG                                         1123 04313000
         ALR   @12,I                                               1123 04314000
         LR    @08,START                                           1123 04315000
         SLR   @08,I                                               1123 04316000
         BCTR  @08,0                                               1123 04317000
         LR    @07,COMMREG                                         1123 04318000
         ALR   @07,I                                               1123 04319000
         EX    @08,@SM01543                                        1123 04320000
*     END;                                                         1124 04321000
*   ELSE                            /* IF NO, DO NOT CHANGE LINE     */ 04322000
*     DO;                           /* FORM OVERFLOW LINE            */ 04323000
*                                                                  1125 04324000
         B     @RC01118                                            1125 04325000
@RF01118 DS    0H                                                  1126 04326000
*       /*************************************************************/ 04327000
*       /*                                                           */ 04328000
*       /* FORM NEW LINE ONLY FROM OVERFLOW                          */ 04329000
*       /*                                                           */ 04330000
*       /*************************************************************/ 04331000
*                                                                  1126 04332000
*       RECTEXT2=EXTRALN;                                          1126 04333000
         MVI   RECTEXT2+251(COMMREG),C' '                          1126 04334000
         MVC   RECTEXT2+252(3,COMMREG),RECTEXT2+251(COMMREG)       1126 04335000
         L     @12,LETXTPTR                                        1126 04336000
         MVC   RECTEXT2(251,COMMREG),EXTRALN(@12)                  1126 04337000
*       RECLEN2=EXTRALEN;           /* LENGTH OF NEW LINE            */ 04338000
         MVC   RECLEN2(2,COMMREG),EXTRALEN(@12)                    1127 04339000
*     END;                                                         1128 04340000
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */ 04341000
@RC01118 MVI   UTCODE,X'20'                                        1129 04342000
*   KEYPTR=ADDR(KEYFLD);            /* PTR TO LINE TO BE WRITTEN     */ 04343000
         LA    @08,KEYFLD(,COMMREG)                                1130 04344000
         ST    @08,KEYPTR                                          1130 04345000
*   AREAPTR=0;                      /* NO READ AREA NECESSARY        */ 04346000
         SLR   @08,@08                                             1131 04347000
         ST    @08,AREAPTR                                         1131 04348000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 04349000
         OI    PLISTEND,B'10000000'                                1132 04350000
*   CALL RDWRTRTN;                  /* WRITE RECORD INTO EDIT DS     */ 04351000
*                                                                  1133 04352000
         BAL   @14,RDWRTRTN                                        1133 04353000
*   /*****************************************************************/ 04354000
*   /*                                                               */ 04355000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 04356000
*   /*                                                               */ 04357000
*   /*****************************************************************/ 04358000
*                                                                  1134 04359000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 04360000
         CH    RETCODE,@CH00145                                    1134 04361000
         BE    @RT01134                                            1134 04362000
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */ 04363000
*   VERCNT=VERCNT+1;                /* UPDATE OVERFLOW CNT BY ONE    */ 04364000
         LA    @12,1                                               1136 04365000
         AL    @12,VERCNT                                          1136 04366000
         ST    @12,VERCNT                                          1136 04367000
*   RELMSG1=1032;                   /* MSG IKJ52558I                 */ 04368000
         MVC   RELMSG1(2),@CH01434                                 1137 04369000
*   LEV1INS=0;                      /* NO 1ST LEVEL INSERTION        */ 04370000
         SLR   LEV1INS,LEV1INS                                     1138 04371000
*   RELMSG2=0;                      /* NO 2ND LEVEL MESSAGE          */ 04372000
         SLR   @12,@12                                             1139 04373000
         STH   @12,RELMSG2                                         1139 04374000
*   LEV2INS=0;                      /* NO 2ND LEVEL INSERTION        */ 04375000
         SLR   LEV2INS,LEV2INS                                     1140 04376000
*   CALL SENDMSG;                   /* SEND MESSAGE TO USER          */ 04377000
         BAL   @14,SENDMSG                                         1141 04378000
*   KEYFLD2=KEYFLD+1;               /* KEY FOR OVERFLOW LINE         */ 04379000
         LA    @08,1                                               1142 04380000
         AL    @08,KEYFLD(,COMMREG)                                1142 04381000
         ST    @08,KEYFLD2(,COMMREG)                               1142 04382000
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT      */ 04383000
         MVI   UTCODE,X'00'                                        1143 04384000
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO READ    */ 04385000
         LA    @08,KEYFLD2(,COMMREG)                               1144 04386000
         ST    @08,KEYPTR                                          1144 04387000
*   AREAPTR=ADDR(KEYFLD3);          /* PTR TO READ BUFFER            */ 04388000
         LA    @08,KEYFLD3(,COMMREG)                               1145 04389000
         ST    @08,AREAPTR                                         1145 04390000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 04391000
         OI    PLISTEND,B'10000000'                                1146 04392000
*   CALL RDWRTRTN;                  /* READ RECORD FROM DATA SET     */ 04393000
*                                                                  1147 04394000
         BAL   @14,RDWRTRTN                                        1147 04395000
*   /*****************************************************************/ 04396000
*   /*                                                               */ 04397000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 04398000
*   /*                                                               */ 04399000
*   /*****************************************************************/ 04400000
*                                                                  1148 04401000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 04402000
         CH    RETCODE,@CH00145                                    1148 04403000
         BE    @RT01148                                            1148 04404000
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */ 04405000
*                                                                  1149 04406000
*   /*****************************************************************/ 04407000
*   /*                                                               */ 04408000
*   /* CHECK IF THERE IS ROOM FOR OVERFLOW LINE IN DATA SET          */ 04409000
*   /*                                                               */ 04410000
*   /*****************************************************************/ 04411000
*                                                                  1150 04412000
*   IF RETCODE^=4 THEN              /* IF NO, RIPPLE RECORDS         */ 04413000
         CH    RETCODE,@CH00602                                    1150 04414000
         BE    @RF01150                                            1150 04415000
*     CALL RIPPLELN;                /* FIND SLOT FOR OVERFLOW LINE   */ 04416000
         BAL   @14,RIPPLELN                                        1151 04417000
*   LETXTPTR=ADDR(RECLEN2);         /* PTR TO TEXT                   */ 04418000
@RF01150 LA    @08,RECLEN2(,COMMREG)                               1152 04419000
         ST    @08,LETXTPTR                                        1152 04420000
*   LECODE='00'X;                   /* NOT DELINITED STRING CODE     */ 04421000
         MVI   LECODE,X'00'                                        1153 04422000
*   CALL LINEEDIT;                  /* LINE EDIT RECORD              */ 04423000
         BAL   @14,LINEEDIT                                        1154 04424000
*   UTCODE='20'X;                   /* SET CODE TO WRITE RECORD      */ 04425000
         MVI   UTCODE,X'20'                                        1155 04426000
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF LINE TO WRITE   */ 04427000
         LA    @08,KEYFLD2(,COMMREG)                               1156 04428000
         ST    @08,KEYPTR                                          1156 04429000
*   AREAPTR=0;                      /* NO READ BUFFER NECESSARY      */ 04430000
         SLR   @08,@08                                             1157 04431000
         ST    @08,AREAPTR                                         1157 04432000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARKER    */ 04433000
         OI    PLISTEND,B'10000000'                                1158 04434000
*   CALL RDWRTRTN;                  /* WRITE RECORD                  */ 04435000
*                                                                  1159 04436000
         BAL   @14,RDWRTRTN                                        1159 04437000
*   /*****************************************************************/ 04438000
*   /*                                                               */ 04439000
*   /* CHECK IF KEY EXCEEDS DATA SET LIMITS ON WRITE OPERATION       */ 04440000
*   /*                                                               */ 04441000
*   /*****************************************************************/ 04442000
*                                                                  1160 04443000
*   IF RETCODE=12 THEN              /* IF YES, TERMINATE             */ 04444000
         CH    RETCODE,@CH00145                                    1160 04445000
         BE    @RT01160                                            1160 04446000
*     GO TO CHGEXIT4;               /* BEGIN END PROCESSING          */ 04447000
*                                                                  1161 04448000
*   /*****************************************************************/ 04449000
*   /*                                                               */ 04450000
*   /* CHECK IF LINE OVERFLOW OCCURRED                               */ 04451000
*   /*                                                               */ 04452000
*   /*****************************************************************/ 04453000
*                                                                  1162 04454000
*   IF RETCODE=4 THEN               /* IF YES, FIT NEW OVERFLOW LINE    04455000
*                                      INTO DATA SET                 */ 04456000
         CH    RETCODE,@CH00602                                    1162 04457000
         BNE   @RF01162                                            1162 04458000
*     DO;                           /* MORE THAN ONE OVERFLOW LINE   */ 04459000
*       KEYFLD=KEYFLD2;             /* MOVE KEY INTO MAIN BFR        */ 04460000
         MVC   KEYFLD(4,COMMREG),KEYFLD2(COMMREG)                  1164 04461000
*       RECLEN=RECLEN2;             /* MOVE LL FIELD                 */ 04462000
         MVC   RECLEN(2,COMMREG),RECLEN2(COMMREG)                  1165 04463000
*       RECTEXT=RECTEXT2;           /* MOVE DATA INTO BFR            */ 04464000
         MVC   RECTEXT(255,COMMREG),RECTEXT2(COMMREG)              1166 04465000
*       GO TO NEXTLINE;             /* PROCESS NEXT LINE             */ 04466000
         B     NEXTLINE                                            1167 04467000
*     END;                                                         1168 04468000
*   KEYFLD2=J;                      /* RESTORE KEY OF CHANGED LINE   */ 04469000
@RF01162 ST    J,KEYFLD2(,COMMREG)                                 1169 04470000
*   UTCODE='00'X;                   /* SET CODE TO READ CURRENT LN   */ 04471000
         MVI   UTCODE,X'00'                                        1170 04472000
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO KEY OF CHANGED LINE    */ 04473000
         LA    @08,KEYFLD2(,COMMREG)                               1171 04474000
         ST    @08,KEYPTR                                          1171 04475000
*   AREAPTR=ADDR(KEYFLD);           /* AREA TO READ INTO             */ 04476000
         LA    @08,KEYFLD(,COMMREG)                                1172 04477000
         ST    @08,AREAPTR                                         1172 04478000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARK      */ 04479000
         OI    PLISTEND,B'10000000'                                1173 04480000
*   CALL RDWRTRTN;                  /* READ CHANGED LINE             */ 04481000
         BAL   @14,RDWRTRTN                                        1174 04482000
*CHKATTN1:                                                         1175 04483000
*   FIRSTCHG='0'B;                  /* SET SWITCH TO INDICATE LINE 1175 04484000
*                                      CHANGE ALREADY MADE           */ 04485000
*                                                                  1175 04486000
CHKATTN1 NI    FIRSTCHG,B'10111111'                                1175 04487000
*   /*****************************************************************/ 04488000
*   /*                                                               */ 04489000
*   /* CHECK IF ATTENTION ISSUED                                     */ 04490000
*   /*                                                               */ 04491000
*   /*****************************************************************/ 04492000
*                                                                  1176 04493000
*   IF CAATTNIS='1'B THEN           /* IF YES, RETURN TO CALLER      */ 04494000
         TM    CAATTNIS(COMMREG),B'01000000'                       1176 04495000
         BO    @RT01176                                            1176 04496000
*     GO TO NOTEXT1;                /* BEGIN END PROCESSING          */ 04497000
*                                                                  1177 04498000
*   /*****************************************************************/ 04499000
*   /*                                                               */ 04500000
*   /* CHECK IF 'ALL' KEYWORD SPECIFIED                              */ 04501000
*   /*                                                               */ 04502000
*   /*****************************************************************/ 04503000
*                                                                  1178 04504000
*   IF ALLKYWD1=1 THEN              /* IF YES, CONTINUE PROCESS      */ 04505000
*                                                                  1178 04506000
         L     @12,TABPTR1                                         1178 04507000
         CLC   ALLKYWD1(2,@12),@CH00060                            1178 04508000
         BNE   @RF01178                                            1178 04509000
*     /***************************************************************/ 04510000
*     /*                                                             */ 04511000
*     /* CHECK IF STRING INSERTION SPECIFIED                         */ 04512000
*     /*                                                             */ 04513000
*     /***************************************************************/ 04514000
*                                                                  1179 04515000
*     IF STR1L^=0 THEN              /* IF NO, CONTINUE WITH CURRENT     04516000
*                                      LINE                          */ 04517000
         ICM   @08,3,STR1L(@12)                                    1179 04518000
         BZ    @RF01179                                            1179 04519000
*       DO;                         /* A45363                        */ 04520000
*         SEMODSW                   /* FLAG, LINE A45363             */ 04521000
*             ='1'B;                /* MODIFIED A45363               */ 04522000
         OI    SEMODSW,B'10000000'                                 1181 04523000
*         GO TO STRGCHNG;           /* REPEAT OPERATION              */ 04524000
         B     STRGCHNG                                            1182 04525000
*       END;                        /* A45363                        */ 04526000
*     ELSE                                                         1184 04527000
*       ;                           /* IF YES, READ NEXT RECORD      */ 04528000
@RF01179 DS    0H                                                  1185 04529000
*   ELSE                            /* IF NO, END PROCESSING         */ 04530000
*     GO TO NOTEXT1;                /* BEGIN END PROCESSING          */ 04531000
*                                                                  1185 04532000
*   /*****************************************************************/ 04533000
*   /*                                                               */ 04534000
*   /* CHECK IF MORE LINES TO CHANGE                                 */ 04535000
*   /*                                                               */ 04536000
*   /*****************************************************************/ 04537000
*                                                                  1186 04538000
*   IF KEYFLD<LNUM2|LNCOUNT>1 THEN  /* IF YES, PROCESS NEXT RECORD   */ 04539000
         L     @12,KEYFLD(,COMMREG)                                1186 04540000
         C     @12,LNUM2                                           1186 04541000
         BL    @RT01186                                            1186 04542000
         L     @12,LNCOUNT                                         1186 04543000
         CH    @12,@CH00060                                        1186 04544000
         BNH   @RF01186                                            1186 04545000
@RT01186 DS    0H                                                  1187 04546000
*     DO;                           /* PREPARE TO READ NEXT LINE     */ 04547000
*       UTCODE='02'X;               /* SET CODE TO READ NEXT LINE    */ 04548000
         MVI   UTCODE,X'02'                                        1188 04549000
*       KEYFLD=VERKEY+VERCNT;       /* SET KEY TO NEWLN              */ 04550000
         L     @08,VERKEY                                          1189 04551000
         AL    @08,VERCNT                                          1189 04552000
         ST    @08,KEYFLD(,COMMREG)                                1189 04553000
*       KEYPTR=ADDR(KEYFLD);        /* PTR TO READ KEY               */ 04554000
         LA    @08,KEYFLD(,COMMREG)                                1190 04555000
         ST    @08,KEYPTR                                          1190 04556000
*       AREAPTR=ADDR(KEYFLD);       /* PTR TO READ BUFFER            */ 04557000
         ST    @08,AREAPTR                                         1191 04558000
*       PLISTEND='1'B;              /* SET END OF PLIST MARK         */ 04559000
         OI    PLISTEND,B'10000000'                                1192 04560000
*       CALL RDWRTRTN;              /* READ NEXT RECORD              */ 04561000
*                                                                  1193 04562000
         BAL   @14,RDWRTRTN                                        1193 04563000
*       /*************************************************************/ 04564000
*       /*                                                           */ 04565000
*       /* CHECK IF RECORD EXISTS                                    */ 04566000
*       /*                                                           */ 04567000
*       /*************************************************************/ 04568000
*                                                                  1194 04569000
*       IF RETCDREG=4 THEN          /* IF NO, NOTIFY USER            */ 04570000
         CH    RETCDREG,@CH00602                                   1194 04571000
         BNE   @RF01194                                            1194 04572000
*         DO;                       /* SEND MESSAGE TO USER          */ 04573000
*           RELMSG1=1286;           /* MSG IKJ52500I                 */ 04574000
*                                                                  1196 04575000
         MVC   RELMSG1(2),@CH01363                                 1196 04576000
*           /*********************************************************/ 04577000
*           /*                                                       */ 04578000
*           /* NO LEVEL 1 INSERTIONS                                 */ 04579000
*           /*                                                       */ 04580000
*           /*********************************************************/ 04581000
*                                                                  1197 04582000
*           LEV1INS=0;                                             1197 04583000
*                                                                  1197 04584000
         SLR   LEV1INS,LEV1INS                                     1197 04585000
*           /*********************************************************/ 04586000
*           /*                                                       */ 04587000
*           /* NO LEVEL 2 MESSAGE                                    */ 04588000
*           /*                                                       */ 04589000
*           /*********************************************************/ 04590000
*                                                                  1198 04591000
*           RELMSG2=0;                                             1198 04592000
*                                                                  1198 04593000
         SLR   @12,@12                                             1198 04594000
         STH   @12,RELMSG2                                         1198 04595000
*           /*********************************************************/ 04596000
*           /*                                                       */ 04597000
*           /* NO LEVEL 2 INSERTIONS                                 */ 04598000
*           /*                                                       */ 04599000
*           /*********************************************************/ 04600000
*                                                                  1199 04601000
*           LEV2INS=0;                                             1199 04602000
         SLR   LEV2INS,LEV2INS                                     1199 04603000
*           CALL SENDMSG;           /* SEND MESSAGE                  */ 04604000
*                                                                  1200 04605000
         BAL   @14,SENDMSG                                         1200 04606000
*           /*********************************************************/ 04607000
*           /*                                                       */ 04608000
*           /* RELEASE REGS TO COMPILER                              */ 04609000
*           /*                                                       */ 04610000
*           /*********************************************************/ 04611000
*                                                                  1201 04612000
*           GO TO NOTEXT1;          /* RETURN TO CALLER              */ 04613000
         B     NOTEXT1                                             1201 04614000
*         END;                                                     1202 04615000
*       ELSE                        /* IF YES, CONTINUE PROCESSING   */ 04616000
*         DO;                       /* DETERMINE WHETHER TO CONT.    */ 04617000
*                                                                  1203 04618000
@RF01194 DS    0H                                                  1204 04619000
*           /*********************************************************/ 04620000
*           /*                                                       */ 04621000
*           /* CHECK IF LINE WITHIN RANGE SPECIFIED                  */ 04622000
*           /*                                                       */ 04623000
*           /*********************************************************/ 04624000
*                                                                  1204 04625000
*           IF KEYFLD<=LNUM2|LNCOUNT>1 THEN/* IF YES, CONTINUE     1204 04626000
*                                      PROCESSING                    */ 04627000
         L     @12,KEYFLD(,COMMREG)                                1204 04628000
         C     @12,LNUM2                                           1204 04629000
         BNH   @RT01204                                            1204 04630000
         L     @12,LNCOUNT                                         1204 04631000
         CH    @12,@CH00060                                        1204 04632000
         BNH   @RF01204                                            1204 04633000
@RT01204 DS    0H                                                  1205 04634000
*             DO;                   /* REPEAT OPERATION DECREMENT  1205 04635000
*                                      LINE COUNT BY ONE             */ 04636000
*               LNCOUNT=LNCOUNT-1;                                 1206 04637000
         L     @12,LNCOUNT                                         1206 04638000
         BCTR  @12,0                                               1206 04639000
         ST    @12,LNCOUNT                                         1206 04640000
*               GO TO INSTXT;       /* INSERT TEXT IN NEXT LINE      */ 04641000
         B     INSTXT                                              1207 04642000
*             END;                                                 1208 04643000
*         END;                                                     1209 04644000
@RF01204 DS    0H                                                  1210 04645000
*     END;                                                         1210 04646000
*NOTEXT1:                           /*                               */ 04647000
*                                                                  1211 04648000
*   /*****************************************************************/ 04649000
*   /*                                                               */ 04650000
*   /* CHECK IF ANY LINE CHANGES PERFORMED                           */ 04651000
*   /*                                                               */ 04652000
*   /*****************************************************************/ 04653000
*                                                                  1211 04654000
*   IF FIRSTCHG='0'B THEN           /* IF YES, SET * AND VERIFY LN   */ 04655000
@RF01186 DS    0H                                                  1211 04656000
NOTEXT1  TM    FIRSTCHG,B'01000000'                                1211 04657000
         BNZ   @RF01211                                            1211 04658000
*     DO;                           /* START END PROCESSING          */ 04659000
*       CACURNUM=VERKEY+VERCNT;     /* SET * VALUE                   */ 04660000
         L     @12,VERKEY                                          1213 04661000
         AL    @12,VERCNT                                          1213 04662000
         ST    @12,CACURNUM(,COMMREG)                              1213 04663000
*       KEYFLD='7FFFFFFF'X;         /* SET KEY TO MAX VALUE          */ 04664000
         MVC   KEYFLD(4,COMMREG),@CF01442                          1214 04665000
*       CALL VERFYRTN;              /* VERIFY LINE IF NECESSARY      */ 04666000
         BAL   @14,VERFYRTN                                        1215 04667000
*     END;                                                         1216 04668000
*CHGEXIT4:                          /*                               */ 04669000
*                                                                  1217 04670000
*   /*****************************************************************/ 04671000
*   /*                                                               */ 04672000
*   /* CHECK IF PROMPTING PERFORMED                                  */ 04673000
*   /*                                                               */ 04674000
*   /*****************************************************************/ 04675000
*                                                                  1217 04676000
*   IF PROMPTSW='1'B THEN           /* IF YES, FREE PROMPT BUFFER    */ 04677000
@RF01211 DS    0H                                                  1217 04678000
CHGEXIT4 TM    PROMPTSW,B'10000000'                                1217 04679000
         BNO   @RF01217                                            1217 04680000
*     DO;                           /* INIT PARMLIST AND FREEMAIN    */ 04681000
*       FREEAREA=GTPBIBUF;          /* PTR TO INPUT PRMPT BFR        */ 04682000
         L     @12,GTPBPTR                                         1219 04683000
         L     @12,GTPBIBUF(,@12)                                  1219 04684000
         ST    @12,FREEAREA                                        1219 04685000
*       FREELEN=BFRLEN;             /* LENGTH OF BUFFER              */ 04686000
         LH    @12,BFRLEN(,@12)                                    1220 04687000
         ST    @12,FREELEN                                         1220 04688000
*       BINRYREG=ADDR(FREEAREA);    /* PTR TO AREA INFORMATION       */ 04689000
         LA    BINRYREG,FREEAREA                                   1221 04690000
*       FREELIST=FREELIST&&FREELIST;/* ZERO OUT LIST FORM            */ 04691000
         XC    FREELIST(12),FREELIST                               1222 04692000
*       PARMREG1=ADDR(FREELIST);    /* PTR TO LFORM                  */ 04693000
*                                                                  1223 04694000
         LA    PARMREG1,FREELIST                                   1223 04695000
*       /*************************************************************/ 04696000
*       /*                                                           */ 04697000
*       /* ISSUE FREEMAIN MACRO TO FREE BUFFER CORE                  */ 04698000
*       /*                                                           */ 04699000
*       /*************************************************************/ 04700000
*                                                                  1224 04701000
*       GENERATE;                                                  1224 04702000
         FREEMAIN V,A=(BINRYREG),SP=1,MF=(E,(1))                        04703000
*       PROMPTSW='0'B;              /* IND. PDL FREED                */ 04704000
         NI    PROMPTSW,B'01111111'                                1225 04705000
*       PARMREG1=ADDR(TABPTR2);     /* PTR TO PRMT PDL               */ 04706000
         LA    PARMREG1,TABPTR2                                    1226 04707000
*     END;                                                         1227 04708000
*   ELSE                            /* IF NO, NO FREEMAIN NECESSARY  */ 04709000
*     PARMREG1=ADDR(TABPTR1);       /* PTR TO MAINPDL                */ 04710000
         B     @RC01217                                            1228 04711000
@RF01217 LA    PARMREG1,TABPTR1                                    1228 04712000
*   GEN(IKJRLSA (1));               /* RELEASE PDL BUILT BY IKJPARS  */ 04713000
@RC01217 DS    0H                                                  1229 04714000
         IKJRLSA (1)                                                    04715000
*CHGEXIT5:                                                         1230 04716000
*   RETCDREG=CHRETCD;               /* SET RETURN CODE IN REG 15     */ 04717000
CHGEXIT5 L     RETCDREG,CHRETCD                                    1230 04718000
*   RETREG=STRNGPTR;                /* RESTORE RETURN POINT          */ 04719000
         L     RETREG,STRNGPTR                                     1231 04720000
*   RETURN;                         /* RETURN TO CALLER              */ 04721000
@EL00008 DS    0H                                                  1232 04722000
@EF00008 DS    0H                                                  1232 04723000
@ER00008 BR    @14                                                 1232 04724000
*   END STRNGRTN;                                                  1233 04725000
*                                                                  1234 04726000
*   /*****************************************************************/ 04727000
*   /*                                                               */ 04728000
*   /* THIS SUBROUTINE PERFORMS ALL THE VERIFICATIONS OF LINE CHANGES*/ 04729000
*   /* BY CALLING IKJEBEMS SERVICE ROUTNE DIRECTLY THE REQUIRED      */ 04730000
*   /* NUMBER OF TIMES FOR EACH LINE CHANGED AND ITS ASSOCIATED      */ 04731000
*   /* OVERFLOW LINES. IKJEBEMA DOES NOT CALL IKJEBEMS TO VERIFY ANY */ 04732000
*   /* OF THE UPDATES DONE BY THIS PROGRAM.                          */ 04733000
*   /*                                                               */ 04734000
*   /*****************************************************************/ 04735000
*                                                                  1234 04736000
*VERFYRTN:                                                         1234 04737000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               1234 04738000
*                                                                  1234 04739000
VERFYRTN DS    0H                                                  1235 04740000
*   /*****************************************************************/ 04741000
*   /*                                                               */ 04742000
*   /* REGISTERS WITH SPECIAL USE                                    */ 04743000
*   /*                                                               */ 04744000
*   /*****************************************************************/ 04745000
*                                                                  1235 04746000
*   RESPECIFY                                                      1235 04747000
*    (PARMREG1,                                                    1235 04748000
*     BINRYREG,                                                    1235 04749000
*     COMMREG,                                                     1235 04750000
*     BASEREG,                                                     1235 04751000
*     DATAREG) RSTD;                                               1235 04752000
*   RESPECIFY                                                      1236 04753000
*    (BASEREG2) RSTD;                                              1236 04754000
*   VERFYPTR=RETREG;                /* SAVE RETURN POINT ADDRESS     */ 04755000
*                                                                  1237 04756000
         ST    RETREG,VERFYPTR                                     1237 04757000
*   /*****************************************************************/ 04758000
*   /*                                                               */ 04759000
*   /* CHECK IF ATTENTION ISSUED                                     */ 04760000
*   /*                                                               */ 04761000
*   /*****************************************************************/ 04762000
*                                                                  1238 04763000
*   IF CAATTNIS='1'B THEN           /* IF YES, BEGIN EXIT PROCESS    */ 04764000
         TM    CAATTNIS(COMMREG),B'01000000'                       1238 04765000
         BNO   @RF01238                                            1238 04766000
*     DO;                           /* CLEAN UP VERIFY PROCESSING    */ 04767000
*VERATTN:                                                          1240 04768000
*       VERKEY=KEYFLD;              /* SAVE LAST LINE CHANGED        */ 04769000
VERATTN  MVC   VERKEY(4),KEYFLD(COMMREG)                           1240 04770000
*       VERCNT=0;                   /* ZERO OVERFLOW LINE CTR        */ 04771000
         SLR   @12,@12                                             1241 04772000
         ST    @12,VERCNT                                          1241 04773000
*       GO TO VEREXIT;              /* RETURN TO CALLER IMMEDIATELY  */ 04774000
         B     VEREXIT                                             1242 04775000
*     END;                                                         1243 04776000
*                                                                  1243 04777000
*   /*****************************************************************/ 04778000
*   /*                                                               */ 04779000
*   /* CHECK IF VERIFY IN EFFECT AND STRING OPERATION                */ 04780000
*   /*                                                               */ 04781000
*   /*****************************************************************/ 04782000
*                                                                  1244 04783000
*   IF CAVRFYSW='1'B THEN           /* IF YES, VERIFICATION REQUIRD  */ 04784000
@RF01238 TM    CAVRFYSW(COMMREG),B'01000000'                       1244 04785000
         BNO   @RF01244                                            1244 04786000
*     DO;                           /* VERIFY LINE IF COMPLETED      */ 04787000
*                                                                  1245 04788000
*       /*************************************************************/ 04789000
*       /*                                                           */ 04790000
*       /* CHECK IF OPERATION ON LINE COMPLETED                      */ 04791000
*       /*                                                           */ 04792000
*       /*************************************************************/ 04793000
*                                                                  1246 04794000
*       IF KEYFLD>VERKEY+VERCNT THEN/* IF YES, READY TO VERIFY       */ 04795000
         L     @12,VERKEY                                          1246 04796000
         AL    @12,VERCNT                                          1246 04797000
         C     @12,KEYFLD(,COMMREG)                                1246 04798000
         BNL   @RF01246                                            1246 04799000
*         DO;                       /* PREPARE TO VERIFY LINE        */ 04800000
*           UTCODE='00'X;           /* SET CODE TO CURRENT           */ 04801000
         MVI   UTCODE,X'00'                                        1248 04802000
*           KEYPTR=ADDR(VERKEY);    /* LINE TO VERIFY                */ 04803000
         LA    @12,VERKEY                                          1249 04804000
         ST    @12,KEYPTR                                          1249 04805000
*           AREAPTR=ADDR(VERLINE);  /* PTR TO BUFFER                 */ 04806000
         LA    @12,VERLINE(,COMMREG)                               1250 04807000
         ST    @12,AREAPTR                                         1250 04808000
*           PLISTEND='1'B;          /* SET END OF PLIST MARK         */ 04809000
         OI    PLISTEND,B'10000000'                                1251 04810000
*RDLINE:                                                           1252 04811000
*           CALL RDWRTRTN;          /* READ LINE TO VERIFY           */ 04812000
RDLINE   BAL   @14,RDWRTRTN                                        1252 04813000
*           CATPUTVF='1'B;          /* SET SWITCH ON FOR EBEMS       */ 04814000
         OI    CATPUTVF(COMMREG),B'00100000'                       1253 04815000
*           RELMSG1=1280;           /* USE MSG ZERO                  */ 04816000
         MVC   RELMSG1(2),@CH01495                                 1254 04817000
*           LEV2INS=0;              /* NO 2ND LEVEL INSERTION        */ 04818000
         SLR   LEV2INS,LEV2INS                                     1255 04819000
*           LEV1INS=ADDR(CATEMPBF); /* PTR TO READ BFR               */ 04820000
         LA    LEV1INS,CATEMPBF(,COMMREG)                          1256 04821000
*           RELMSG2=1;              /* RELATIVE SECOND LEVEL         */ 04822000
         MVC   RELMSG2(2),@CH00060                                 1257 04823000
*           CALL SENDMSG;           /* VERIFY LINE                   */ 04824000
*                                                                  1258 04825000
         BAL   @14,SENDMSG                                         1258 04826000
*           /*********************************************************/ 04827000
*           /*                                                       */ 04828000
*           /* CHECK IF ATTENTION ISSUED WHILE VERIFYING             */ 04829000
*           /*                                                       */ 04830000
*           /*********************************************************/ 04831000
*                                                                  1259 04832000
*           IF CAATTNIS='1'B THEN   /* IF YES, TERMINATE PROCESS     */ 04833000
         TM    CAATTNIS(COMMREG),B'01000000'                       1259 04834000
         BO    @RT01259                                            1259 04835000
*             GO TO VERATTN;        /* CLEANUP AND EXIT              */ 04836000
*                                                                  1260 04837000
*           /*********************************************************/ 04838000
*           /*                                                       */ 04839000
*           /* CHECK IF OVERFLOW LINES EXIST                         */ 04840000
*           /*                                                       */ 04841000
*           /*********************************************************/ 04842000
*                                                                  1261 04843000
*           IF VERCNT>0 THEN        /* IF YES, OVERFLOW LINES EXIST  */ 04844000
         L     @12,VERCNT                                          1261 04845000
         LTR   @12,@12                                             1261 04846000
         BNP   @RF01261                                            1261 04847000
*             DO;                   /* PREPARE TO VERIFY OVERFLOW    */ 04848000
*               VERCNT=VERCNT-1;    /* DECREMENT OVERFLOW CTR BY ONE */ 04849000
         BCTR  @12,0                                               1263 04850000
         ST    @12,VERCNT                                          1263 04851000
*               VERKEY=VERKEY+1;    /* INCREMENT VERIFY KEY BY ONE   */ 04852000
         LA    @12,1                                               1264 04853000
         AL    @12,VERKEY                                          1264 04854000
         ST    @12,VERKEY                                          1264 04855000
*               GO TO RDLINE;       /* REPEAT OPERATION              */ 04856000
         B     RDLINE                                              1265 04857000
*             END;                                                 1266 04858000
*           CATPUTVF='0'B;          /* SET SWITCH OFF                */ 04859000
@RF01261 NI    CATPUTVF(COMMREG),B'11011111'                       1267 04860000
*           VERKEY=KEYFLD;          /* NEXT LINE TO VERIFY           */ 04861000
         MVC   VERKEY(4),KEYFLD(COMMREG)                           1268 04862000
*         END;                                                     1269 04863000
*     END;                                                         1270 04864000
*   ELSE                            /* IF NO, NO VERIFICATION        */ 04865000
*     VERKEY=KEYFLD;                /* LAST LINE CHANGED             */ 04866000
         B     @RC01244                                            1271 04867000
@RF01244 MVC   VERKEY(4),KEYFLD(COMMREG)                           1271 04868000
*VEREXIT:                                                          1272 04869000
*   ;                               /* SUBROUTINE EXIT               */ 04870000
@RC01244 DS    0H                                                  1272 04871000
VEREXIT  DS    0H                                                  1273 04872000
*   RETREG=VERFYPTR;                /* RESTORE RETURN POINT ADDRESS  */ 04873000
         L     RETREG,VERFYPTR                                     1273 04874000
*   RETURN;                         /* EXIT LINKAGE                  */ 04875000
@EL00009 DS    0H                                                  1274 04876000
@EF00009 DS    0H                                                  1274 04877000
@ER00009 BR    @14                                                 1274 04878000
*   END VERFYRTN;                   /* END OF SUBROUTINE             */ 04879000
*                                                                  1276 04880000
*   /*****************************************************************/ 04881000
*   /*                                                               */ 04882000
*   /* THIS SUBROUTINE STRIPS TEXT1 FROM THE SECOND LINE WHEN TEXT1  */ 04883000
*   /* IS FOUND ACROSS RECORD BOUNDARIES AND RE-WRITES THE SECOND    */ 04884000
*   /* LINE.                                                         */ 04885000
*   /*                                                               */ 04886000
*   /*****************************************************************/ 04887000
*                                                                  1276 04888000
*BDYCHG:                                                           1276 04889000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               1276 04890000
*                                                                  1276 04891000
BDYCHG   DS    0H                                                  1277 04892000
*   /*****************************************************************/ 04893000
*   /*                                                               */ 04894000
*   /* REGISTERS WITH SPECIAL USE                                    */ 04895000
*   /*                                                               */ 04896000
*   /*****************************************************************/ 04897000
*                                                                  1277 04898000
*   RESPECIFY                                                      1277 04899000
*    (PARMREG1,                                                    1277 04900000
*     BINRYREG,                                                    1277 04901000
*     COMMREG,                                                     1277 04902000
*     BASEREG,                                                     1277 04903000
*     DATAREG) RSTD;                                               1277 04904000
*   RESPECIFY                                                      1278 04905000
*    (BASEREG2) RSTD;                                              1278 04906000
*   BDYPTR=RETREG;                  /* SAVE RETURN POINT             */ 04907000
*                                                                  1279 04908000
         LR    BDYPTR,RETREG                                       1279 04909000
*   /*****************************************************************/ 04910000
*   /*                                                               */ 04911000
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */ 04912000
*   /*                                                               */ 04913000
*   /*****************************************************************/ 04914000
*                                                                  1280 04915000
*   IF CANONUM='0'B THEN            /* IF YES, ADJUST DATA PORTION   */ 04916000
         TM    CANONUM(COMMREG),B'00000001'                        1280 04917000
         BNZ   @RF01280                                            1280 04918000
*     DO;                           /* STRIP SEQUENCE FIELD          */ 04919000
*                                                                  1281 04920000
*       /*************************************************************/ 04921000
*       /*                                                           */ 04922000
*       /* CHECK IF SEQUENCE FIELD STARTS IN COL. ONE                */ 04923000
*       /*                                                           */ 04924000
*       /*************************************************************/ 04925000
*                                                                  1282 04926000
*       IF CALINE='01'X THEN        /* IF YES, REMOVE SEQ. FIELD     */ 04927000
         CLI   CALINE(COMMREG),X'01'                               1282 04928000
         BNE   @RF01282                                            1282 04929000
*         DO;                                                      1283 04930000
*                                                                  1283 04931000
*           /*********************************************************/ 04932000
*           /*                                                       */ 04933000
*           /* SLIDE DATA OVER SEQUENCE FIELD                        */ 04934000
*           /*                                                       */ 04935000
*           /*********************************************************/ 04936000
*                                                                  1284 04937000
*           MVC(RECTEXT2(1:RECLEN2-CALENGTH-4),RECTEXT2(CALENGTH+1:     04938000
*               RECLEN2-4));                                       1284 04939000
*                                                                  1284 04940000
         LH    @12,RECLEN2(,COMMREG)                               1284 04941000
         SLR   @08,@08                                             1284 04942000
         IC    @08,CALENGTH(,COMMREG)                              1284 04943000
         SLR   @12,@08                                             1284 04944000
         SH    @12,@CH00132                                        1284 04945000
         SLR   @08,@08                                             1284 04946000
         IC    @08,CALENGTH(,COMMREG)                              1284 04947000
         ALR   @08,COMMREG                                         1284 04948000
         EX    @12,@SM01560                                        1284 04949000
*           /*********************************************************/ 04950000
*           /*                                                       */ 04951000
*           /* ADJUST LL FIELD FOR VARIABLE LINES                    */ 04952000
*           /*                                                       */ 04953000
*           /*********************************************************/ 04954000
*                                                                  1285 04955000
*           RECLEN2=RECLEN2-CALENGTH;                              1285 04956000
         SLR   @12,@12                                             1285 04957000
         IC    @12,CALENGTH(,COMMREG)                              1285 04958000
         LCR   @12,@12                                             1285 04959000
         AH    @12,RECLEN2(,COMMREG)                               1285 04960000
         STH   @12,RECLEN2(,COMMREG)                               1285 04961000
*         END;                                                     1286 04962000
*       ELSE                        /* IF NO, ADJUST FOR FIXED LNS   */ 04963000
*         RECLEN2=CALINE+3;         /* SET LL FLD                    */ 04964000
         B     @RC01282                                            1287 04965000
@RF01282 LA    @12,3                                               1287 04966000
         SLR   @08,@08                                             1287 04967000
         IC    @08,CALINE(,COMMREG)                                1287 04968000
         ALR   @12,@08                                             1287 04969000
         STH   @12,RECLEN2(,COMMREG)                               1287 04970000
*     END;                                                         1288 04971000
@RC01282 DS    0H                                                  1289 04972000
*   I=STR1L+OFF1-RECLEN+3;          /* LENGTH OF TEXT1 IN RCD2       */ 04973000
*                                                                  1289 04974000
@RF01280 L     @12,TABPTR1                                         1289 04975000
         LH    I,STR1L(,@12)                                       1289 04976000
         AL    I,OFF1                                              1289 04977000
         SH    I,RECLEN(,COMMREG)                                  1289 04978000
         AH    I,@CH00164                                          1289 04979000
*   /*****************************************************************/ 04980000
*   /*                                                               */ 04981000
*   /* CHECK IF DATA SET LINE NUMBERED                               */ 04982000
*   /*                                                               */ 04983000
*   /*****************************************************************/ 04984000
*                                                                  1290 04985000
*   IF CANONUM='0'B THEN            /* IF YES, ACCOUNT FOR SEQ FLD   */ 04986000
         TM    CANONUM(COMMREG),B'00000001'                        1290 04987000
         BNZ   @RF01290                                            1290 04988000
*     I=I+CALENGTH;                 /* ADD ON SEQUENCE FLD LENGTH    */ 04989000
         SLR   @12,@12                                             1291 04990000
         IC    @12,CALENGTH(,COMMREG)                              1291 04991000
         ALR   I,@12                                               1291 04992000
*   STR1L=STR1L-I;                  /* LENGTH OF TEXT1 IN RECORD1    */ 04993000
*                                                                  1292 04994000
@RF01290 L     @08,TABPTR1                                         1292 04995000
         LH    @07,STR1L(,@08)                                     1292 04996000
         SLR   @07,I                                               1292 04997000
         STH   @07,STR1L(,@08)                                     1292 04998000
*   /*****************************************************************/ 04999000
*   /*                                                               */ 05000000
*   /* MOVE                                                          */ 05001000
*   /*                                                               */ 05002000
*   /*****************************************************************/ 05003000
*                                                                  1293 05004000
*   MVC(RECTEXT2(1:RECLEN2-I-4),RECTEXT2(I+1:RECLEN2-4));          1293 05005000
         LH    @08,RECLEN2(,COMMREG)                               1293 05006000
         SLR   @08,I                                               1293 05007000
         SH    @08,@CH00132                                        1293 05008000
         LR    @07,COMMREG                                         1293 05009000
         ALR   @07,I                                               1293 05010000
         EX    @08,@SM01562                                        1293 05011000
*   RECLEN2=RECLEN2-I;              /* ADJUST LENGTH FIELD           */ 05012000
         LH    @08,RECLEN2(,COMMREG)                               1294 05013000
         SLR   @08,I                                               1294 05014000
         STH   @08,RECLEN2(,COMMREG)                               1294 05015000
*   LETXTPTR=ADDR(RECLEN2);         /* PTR TO TEXT                   */ 05016000
         LA    @08,RECLEN2(,COMMREG)                               1295 05017000
         ST    @08,LETXTPTR                                        1295 05018000
*   LECODE='00'X;                   /* NOT DELIMITED STRING CODE     */ 05019000
         MVI   LECODE,X'00'                                        1296 05020000
*   CALL LINEEDIT;                  /* LINE EDIT TEXT                */ 05021000
         BAL   @14,LINEEDIT                                        1297 05022000
*   UTCODE='20'X;                   /* IKJEBEUT CODE TO WRITE LINE   */ 05023000
         MVI   UTCODE,X'20'                                        1298 05024000
*   KEYPTR=ADDR(KEYFLD2);           /* PTR TO RECORD TO BE WRITTEN   */ 05025000
         LA    @08,KEYFLD2(,COMMREG)                               1299 05026000
         ST    @08,KEYPTR                                          1299 05027000
*   AREAPTR=0;                      /* NO BUFFER NECESSARY           */ 05028000
         SLR   @08,@08                                             1300 05029000
         ST    @08,AREAPTR                                         1300 05030000
*   PLISTEND='1'B;                  /* SET END OF PARMLIST MARK      */ 05031000
         OI    PLISTEND,B'10000000'                                1301 05032000
*   CALL RDWRTRTN;                  /* WRITE UPDATED LINE            */ 05033000
         BAL   @14,RDWRTRTN                                        1302 05034000
*   RETREG=BDYPTR;                  /* RESTORE RETURN POINT          */ 05035000
         LR    RETREG,BDYPTR                                       1303 05036000
*   RETURN;                         /* EXIT LINKAGE                  */ 05037000
@EL00010 DS    0H                                                  1304 05038000
@EF00010 DS    0H                                                  1304 05039000
@ER00010 BR    @14                                                 1304 05040000
*   END BDYCHG;                     /* END OF SUBROUTINE             */ 05041000
*                                                                  1306 05042000
*   /*****************************************************************/ 05043000
*   /*                                                               */ 05044000
*   /* THIS SUBROUTINE WILL SHIFT RECORD WITH SEQUENCE FIELDS        */ 05045000
*   /* STARTING IN COLUMN ONE TO REMOVE THEM FROM THE DATA PORTION OF*/ 05046000
*   /* THE LINE. THE LL FIELD IS ADJUSTED TO ACCOUNT FOR THE REMOVAL */ 05047000
*   /* OF THE SEQUENCE FIELD. IF THE SEQUENCE FIELD IS AT THE END OF */ 05048000
*   /* THE RECORD, ONLY THE LATTER OPERATION IS PERFORMED.           */ 05049000
*   /*                                                               */ 05050000
*   /*****************************************************************/ 05051000
*                                                                  1306 05052000
*RECSHIFT:                                                         1306 05053000
*   PROC OPTIONS(NOSAVEAREA,SAVE(14));/* SUBROUTINE ENTRY POINT      */ 05054000
*                                                                  1306 05055000
RECSHIFT ST    @14,12(,@13)                                        1306 05056000
*   /*****************************************************************/ 05057000
*   /*                                                               */ 05058000
*   /* REGISTERS WITH SPECIAL USE                                    */ 05059000
*   /*                                                               */ 05060000
*   /*****************************************************************/ 05061000
*                                                                  1307 05062000
*   RESPECIFY                                                      1307 05063000
*    (PARMREG1,                                                    1307 05064000
*     BINRYREG,                                                    1307 05065000
*     COMMREG,                                                     1307 05066000
*     BASEREG,                                                     1307 05067000
*     DATAREG) RSTD;                                               1307 05068000
*   RESPECIFY                                                      1308 05069000
*    (BASEREG2) RSTD;                                              1308 05070000
*                                                                  1308 05071000
*   /*****************************************************************/ 05072000
*   /*                                                               */ 05073000
*   /* CHECK IF DATA SET IS LINE NUMBERED                            */ 05074000
*   /*                                                               */ 05075000
*   /*****************************************************************/ 05076000
*                                                                  1309 05077000
*   IF CANONUM='0'B THEN            /* IF YES, ADJUST RECORD         */ 05078000
         TM    CANONUM(COMMREG),B'00000001'                        1309 05079000
         BNZ   @RF01309                                            1309 05080000
*     DO;                           /* STRIP SEQUENCE FIELD          */ 05081000
*                                                                  1310 05082000
*       /*************************************************************/ 05083000
*       /*                                                           */ 05084000
*       /* CHECK IF SEQUENCE FIELD STARTS IN COLUMN ONE              */ 05085000
*       /*                                                           */ 05086000
*       /*************************************************************/ 05087000
*                                                                  1311 05088000
*       IF CALINE='01'X THEN        /* IF YES, MOVE DATA UP          */ 05089000
         CLI   CALINE(COMMREG),X'01'                               1311 05090000
         BNE   @RF01311                                            1311 05091000
*         DO;                                                      1312 05092000
*                                                                  1312 05093000
*           /*********************************************************/ 05094000
*           /*                                                       */ 05095000
*           /* SLIDE DATA OVER SEQUENCE FIELD                        */ 05096000
*           /*                                                       */ 05097000
*           /*********************************************************/ 05098000
*                                                                  1313 05099000
*           MVC(RECTEXT(1:RECLEN-CALENGTH-4),RECTEXT(CALENGTH+1:RECLEN- 05100000
*               4));                                               1313 05101000
*                                                                  1313 05102000
         LH    @12,RECLEN(,COMMREG)                                1313 05103000
         SLR   @08,@08                                             1313 05104000
         IC    @08,CALENGTH(,COMMREG)                              1313 05105000
         SLR   @12,@08                                             1313 05106000
         SH    @12,@CH00132                                        1313 05107000
         SLR   @08,@08                                             1313 05108000
         IC    @08,CALENGTH(,COMMREG)                              1313 05109000
         ALR   @08,COMMREG                                         1313 05110000
         EX    @12,@SM01529                                        1313 05111000
*           /*********************************************************/ 05112000
*           /*                                                       */ 05113000
*           /* ADJUST LL FIELD FOR VARIABLE LINES                    */ 05114000
*           /*                                                       */ 05115000
*           /*********************************************************/ 05116000
*                                                                  1314 05117000
*           RECLEN=RECLEN-CALENGTH;                                1314 05118000
         SLR   @12,@12                                             1314 05119000
         IC    @12,CALENGTH(,COMMREG)                              1314 05120000
         LCR   @12,@12                                             1314 05121000
         AH    @12,RECLEN(,COMMREG)                                1314 05122000
         STH   @12,RECLEN(,COMMREG)                                1314 05123000
*         END;                                                     1315 05124000
*       ELSE                        /* IF NO, ADJUST FOR FIXED LINE  */ 05125000
*         RECLEN=CALINE+3;          /* ADUST LL FLD                  */ 05126000
         B     @RC01311                                            1316 05127000
@RF01311 LA    @12,3                                               1316 05128000
         SLR   @08,@08                                             1316 05129000
         IC    @08,CALINE(,COMMREG)                                1316 05130000
         ALR   @12,@08                                             1316 05131000
         STH   @12,RECLEN(,COMMREG)                                1316 05132000
*     END;                                                         1317 05133000
*   RETURN;                         /* RETURN TO CALLER              */ 05134000
@EL00011 DS    0H                                                  1318 05135000
@EF00011 DS    0H                                                  1318 05136000
@ER00011 L     @14,12(,@13)                                        1318 05137000
         BR    @14                                                 1318 05138000
*   END RECSHIFT;                   /* END OF SUBROUTINE             */ 05139000
         B     @EL00011                                            1319 05140000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 05141000
*     GPR00P PTR(31) REG(0),                                       1320 05142000
*     GPR01P PTR(31) REG(1),                                       1320 05143000
*     GPR02P PTR(31) REG(2),                                       1320 05144000
*     GPR03P PTR(31) REG(3),                                       1320 05145000
*     GPR04P PTR(31) REG(4),                                       1320 05146000
*     GPR05P PTR(31) REG(5),                                       1320 05147000
*     GPR06P PTR(31) REG(6),                                       1320 05148000
*     GPR07P PTR(31) REG(7),                                       1320 05149000
*     GPR08P PTR(31) REG(8),                                       1320 05150000
*     GPR09P PTR(31) REG(9),                                       1320 05151000
*     GPR12P PTR(31) REG(12),                                      1320 05152000
*     GPR13P PTR(31) REG(13),                                      1320 05153000
*     GPR14P PTR(31) REG(14),                                      1320 05154000
*     GPR15P PTR(31) REG(15);                                      1320 05155000
*                                                                  1320 05156000
*   /*****************************************************************/ 05157000
*   /*                                                               */ 05158000
*   /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS                      */ 05159000
*   /*                                                               */ 05160000
*   /*****************************************************************/ 05161000
*                                                                  1321 05162000
*   DECLARE                                                        1321 05163000
*     CASAVPTR PTR(31) BASED;       /* SAVE AREA PTR FOR IKJEBESV    */ 05164000
*   DECLARE                                                        1322 05165000
*     COMMREG REG(9) PTR(31) RSTD;  /* POINTER TO EDIT COMMO AREA    */ 05166000
*   DECLARE                                                        1323 05167000
*     DATAREG REG(10) PTR(31) RSTD; /* BASEREG FOR EDIT SUBCOMMAND 1323 05168000
*                                      WORK AREA                     */ 05169000
*   DECLARE                                                        1324 05170000
*     CASAVE CHAR(72) BASED;        /* SAVE AREA EDIT MODULE         */ 05171000
*   DECLARE                         /* COMMON VARIABLES              */ 05172000
*     I256C CHAR(256) BASED,                                       1325 05173000
*     I031F FIXED(31) BASED,                                       1325 05174000
*     I031P PTR(31) BASED,                                         1325 05175000
*     I015F FIXED(15) BASED,                                       1325 05176000
*     I015P PTR(15) BASED,                                         1325 05177000
*     I008P PTR(8) BASED,                                          1325 05178000
*     I001C CHAR(1) BASED;                                         1325 05179000
*   END IKJEBECH                    /* END OF CHANGE COMMAND LOAD  1326 05180000
*                                      MODULE                        */ 05181000
*                                                                  1326 05182000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05183000
*/*%INCLUDE SYSLIB  (IKJEBECA)                                       */ 05184000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */ 05185000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */ 05186000
*/*%INCLUDE SYSLIB  (IKJPTPB )                                       */ 05187000
*/*%INCLUDE SYSLIB  (IKJGTPB )                                       */ 05188000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */ 05189000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 05190000
*/*%INCLUDE SYSLIB  (IKJEBEMJ)                                       */ 05191000
*                                                                  1326 05192000
*       ;                                                          1326 05193000
@DATA    DS    0H                                                       05194000
@CH00164 DC    H'3'                                                     05195000
@CH00602 DC    H'4'                                                     05196000
@CH00132 DC    H'5'                                                     05197000
@CH00510 DC    H'6'                                                     05198000
@CH00126 DC    H'7'                                                     05199000
@CH01338 DC    H'9'                                                     05200000
@CH00541 DC    H'10'                                                    05201000
@CH00033 DC    H'11'                                                    05202000
@CH00065 DC    H'15'                                                    05203000
@CH00136 DC    H'20'                                                    05204000
@CH01361 DC    H'22'                                                    05205000
@CH00077 DC    H'24'                                                    05206000
@CH01421 DC    H'25'                                                    05207000
@CH01373 DC    H'45'                                                    05208000
@CH00571 DC    H'256'                                                   05209000
@CH01465 DC    H'257'                                                   05210000
@CH01371 DC    H'270'                                                   05211000
@CH01381 DC    H'271'                                                   05212000
@CH01434 DC    H'1032'                                                  05213000
@CH01323 DC    H'1033'                                                  05214000
@CH01495 DC    H'1280'                                                  05215000
@CH01363 DC    H'1286'                                                  05216000
@CH01318 DC    H'1287'                                                  05217000
@CH01335 DC    H'1288'                                                  05218000
@CH01342 DC    H'1289'                                                  05219000
@CH01362 DC    H'1290'                                                  05220000
@CH01461 DC    H'1292'                                                  05221000
@CH01419 DC    H'1293'                                                  05222000
@SM01520 MVC   0(0,@07),LNUM(@12)                                       05223000
@SM01522 MVC   0(0,@08),LNUM(@07)                                       05224000
@SM01524 MVC   MSGTEXT(0,COMMREG),LNUM(@12)                             05225000
@SM01526 MVC   MSGTEXT(0,COMMREG),LNUM(@08)                             05226000
@SM01529 MVC   RECTEXT(0,COMMREG),RECTEXT(@08)                          05227000
@SM01531 MVC   RECTEXT-3(0,@12),RECTEXT-4(@07)                          05228000
@SM01533 MVC   RECTEXT-4(0,@08),BFRTXT(@07)                             05229000
@SM01535 MVC   MSGTEXT2(0,COMMREG),0(@08)                               05230000
@SM01537 MVC   MSGTEXT(0,COMMREG),0(@08)                                05231000
@SM01539 MVC   RECTEXT2(0,COMMREG),RECTEXT(@07)                         05232000
@SM01541 MVC   RECTEXT2(0,@12),EXTRALN(@08)                             05233000
@SM01543 MVC   RECTEXT(0,@12),RECTEXT-1(@07)                            05234000
@SM01545 MVC   RECTEXT2(0,COMMREG),STRING(@07)                          05235000
@SM01547 MVC   STRING(0,@12),RECTEXT2(COMMREG)                          05236000
@SM01549 MVC   TEXTBFR(0,COMMREG),RECTEXT(COMMREG)                      05237000
@SM01551 MVC   TEXTBFR-1(0,@08),STRING(@07)                             05238000
@SM01553 MVC   TEXTBFR-1(0,@08),RECTEXT-1(@15)                          05239000
@SM01555 MVC   NEWTEXT+256(0,COMMREG),TEXTBFR+256(COMMREG)              05240000
@SM01557 MVC   RECTEXT(0,COMMREG),TEXTBFR(COMMREG)                      05241000
@SM01560 MVC   RECTEXT2(0,COMMREG),RECTEXT2(@08)                        05242000
@SM01562 MVC   RECTEXT2(0,COMMREG),RECTEXT2(@07)                        05243000
@DATD    DSECT                                                          05244000
         DS    0F                                                       05245000
@TF00001 DS    F                                                        05246000
IKJEBECH CSECT                                                          05247000
         DS    0F                                                       05248000
@CF00060 DC    F'1'                                                     05249000
@CH00060 EQU   @CF00060+2                                               05250000
@CF00058 DC    F'8'                                                     05251000
@CH00058 EQU   @CF00058+2                                               05252000
@CF00145 DC    F'12'                                                    05253000
@CH00145 EQU   @CF00145+2                                               05254000
@CF00236 DC    F'16'                                                    05255000
@CH00236 EQU   @CF00236+2                                               05256000
@CF01355 DC    F'-1'                                                    05257000
@CH01355 EQU   @CF01355+2                                               05258000
@CF01442 DC    XL4'7FFFFFFF'                                            05259000
@DATD    DSECT                                                          05260000
         DS    0D                                                       05261000
STR1PTR  DS    A                                                        05262000
STR2PTR  DS    A                                                        05263000
SERTAREA DS    FL4                                                      05264000
         ORG   SERTAREA                                                 05265000
OFF1     DS    AL4                                                      05266000
         ORG   OFF1                                                     05267000
SERTCD   DS    CL1                                                      05268000
         ORG   SERTAREA+4                                               05269000
TABPTR1  DS    A                                                        05270000
TABPTR2  DS    A                                                        05271000
TABPTR3  DS    A                                                        05272000
CHRETCD  DS    F                                                        05273000
CURLN    DS    F                                                        05274000
LNCOUNT  DS    F                                                        05275000
CHARCNT  DS    F                                                        05276000
PPLPTR   DS    A                                                        05277000
STRNGPTR DS    A                                                        05278000
CHARPTR  DS    A                                                        05279000
VERFYPTR DS    A                                                        05280000
RIPPLPTR DS    A                                                        05281000
RCDPTR   DS    A                                                        05282000
PTPBPTR  DS    A                                                        05283000
GTPBPTR  DS    A                                                        05284000
LINKLIST DS    F                                                        05285000
LKLIBPTR DS    F                                                        05286000
STR1LENS DS    H                                                        05287000
STR1LEN  DS    H                                                        05288000
STR2LEN  DS    H                                                        05289000
PTGTLIST DS    CL20                                                     05290000
         DS    CL6                                                      05291000
PACKAREA DS    CL8                                                      05292000
SRPLIST  DS    CL40                                                     05293000
         ORG   SRPLIST                                                  05294000
RELMSG1  DS    FL2                                                      05295000
RELMSG2  DS    FL2                                                      05296000
SRPLST   DS    CL36                                                     05297000
         ORG   SRPLIST+40                                               05298000
UTPLIST  DS    CL12                                                     05299000
         ORG   UTPLIST                                                  05300000
UTCODE   DS    CL1                                                      05301000
DCBPTR   DS    AL3                                                      05302000
KEYPTR   DS    AL4                                                      05303000
AREAPTR  DS    AL4                                                      05304000
         ORG   AREAPTR                                                  05305000
PLISTEND DS    BL1                                                      05306000
         ORG   UTPLIST+12                                               05307000
LEPLIST  DS    CL8                                                      05308000
         ORG   LEPLIST                                                  05309000
LETXTPTR DS    AL4                                                      05310000
         ORG   LETXTPTR                                                 05311000
LECODE   DS    CL1                                                      05312000
         ORG   LEPLIST+4                                                05313000
LECOMPTR DS    AL4                                                      05314000
         ORG   LEPLIST+8                                                05315000
OTSWS    DS    CL1                                                      05316000
         ORG   OTSWS                                                    05317000
PROMPTSW DS    BL1                                                      05318000
FIRSTCHG EQU   OTSWS+0                                                  05319000
CNTSW    EQU   OTSWS+0                                                  05320000
INSSW    EQU   OTSWS+0                                                  05321000
@NM00023 EQU   OTSWS+0                                                  05322000
         ORG   OTSWS+1                                                  05323000
         DS    CL3                                                      05324000
@NM00024 DS    CL8                                                      05325000
         ORG   @NM00024                                                 05326000
PRMPTNO  DS    FL4                                                      05327000
PRMPTPTR DS    FL4                                                      05328000
         ORG   @NM00024+8                                               05329000
@NM00025 DS    CL20                                                     05330000
         ORG   @NM00025                                                 05331000
FREEAREA DS    FL4                                                      05332000
FREELEN  DS    FL4                                                      05333000
FREELIST DS    CL12                                                     05334000
         ORG   @NM00025+20                                              05335000
@NM00026 DS    CL8                                                      05336000
         ORG   @NM00026                                                 05337000
LNUM1    DS    FL4                                                      05338000
LNUM2    DS    FL4                                                      05339000
         ORG   @NM00026+8                                               05340000
@NM00027 DS    CL8                                                      05341000
         ORG   @NM00027                                                 05342000
VERCNT   DS    FL4                                                      05343000
VERKEY   DS    FL4                                                      05344000
         ORG   @NM00027+8                                               05345000
SEPLIST  DS    CL24                                                     05346000
         ORG   SEPLIST                                                  05347000
SEDCBPTR DS    AL4                                                      05348000
SEOFFS   DS    FL2                                                      05349000
SESTRLEN DS    FL2                                                      05350000
SETXTPTR DS    AL4                                                      05351000
SEBFRPTR DS    AL4                                                      05352000
SELNRNGE DS    AL4                                                      05353000
@NM00076 DS    CL1                                                      05354000
SEFLAGS  DS    CL1                                                      05355000
         ORG   SEFLAGS                                                  05356000
SEMODSW  DS    BL1                                                      05357000
         ORG   SEPLIST+22                                               05358000
SECHARCT DS    FL2                                                      05359000
         ORG   SEPLIST+24                                               05360000
         DS    CL4                                                      05361000
PACKTEMP DS    CL8                                                      05362000
IKJEBECH CSECT                                                          05363000
         NOPR  ((@ENDDATD-@DATD)/673*16)                                05364000
         DS    0F                                                       05365000
@SIZDATD DC    AL1(0)                                                   05366000
         DC    AL3(@ENDDATD-@DATD)                                      05367000
@CV00512 DC    V(IKJEBCH1)                                              05368000
@CV00513 DC    V(IKJEBCH2)                                              05369000
@CV00514 DC    V(IKJEBCH3)                                              05370000
@CV00515 DC    V(IKJEBCH4)                                              05371000
@CV00585 DC    V(IKJEBESE)                                              05372000
         DS    0D                                                       05373000
@CC01337 DC    C'00000000'                                              05374000
@CC01374 DC    C'PUTLINE'                                               05375000
@CC01377 DC    C'GETLINE'                                               05376000
@CC01379 DC    C'PARSE'                                                 05377000
         DS    CL1                                                      05378000
PRMPTMSG DS    CL37                                                     05379000
         ORG   PRMPTMSG                                                 05380000
@NM00072 DC    H'37'                                                    05381000
@NM00073 DC    H'0'                                                     05382000
@NM00074 DC    CL10'IKJ52564A '                                         05383000
@NM00075 DC    CL23'ENTER COUNT OR STRING -'                            05384000
         ORG   PRMPTMSG+37                                              05385000
IKJEBECH CSECT                                                          05386000
IKJEBCH1 IKJPARM DSECT=IKJPRMD1                                         05387000
LNUM11   IKJIDENT 'LINE NUMBER',ASTERISK,FIRST=NUMERIC,OTHER=NUMERIC,  X05388000
               MAXLNTH=8,DEFAULT='*'                                    05389000
LNUM22   IKJIDENT 'LINE RANGE/COUNT',FIRST=NUMERIC,OTHER=NUMERIC,      X05390000
               MAXLNTH=8                                                05391000
COUNT1   IKJIDENT 'CHARACTER COUNT',FIRST=NUMERIC,OTHER=NUMERIC,       X05392000
               MAXLNTH=3                                                05393000
DELM1    IKJPOSIT DELIMITER                                             05394000
STRING1  IKJPOSIT STRING,SQSTRING,ASIS                           S21004 05395000
STRING2  IKJPOSIT STRING,SQSTRING,ASIS                           S21004 05396000
KEYWD1   IKJKEYWD                                                       05397000
         IKJNAME 'ALL'                                                  05398000
         IKJENDP                                                        05399000
IKJEBCH2 IKJPARM DSECT=IKJPRMD2                                         05400000
COUNT2   IKJIDENT 'CHARACTER COUNT',FIRST=NUMERIC,OTHER=NUMERIC,       X05401000
               MAXLNTH=3                                                05402000
DELM2    IKJPOSIT DELIMITER                                             05403000
STRING3  IKJPOSIT STRING,SQSTRING,ASIS                           S21004 05404000
STRING4  IKJPOSIT STRING,SQSTRING,ASIS                           S21004 05405000
KEYWD2   IKJKEYWD                                                       05406000
         IKJNAME 'ALL'                                                  05407000
         IKJENDP                                                        05408000
IKJEBCH3 IKJPARM  DSECT=IKJPRMD3                                        05409000
CHRCOUNT IKJIDENT 'CHARACTER COUNT',FIRST=NUMERIC,OTHER=NUMERIC,       X05410000
               MAXLNTH=3,PROMPT='VALID CHARACTER COUNT',               X05411000
               HELP=('COUNT THAT DOES NOT EXCEED DATA PORTION OF LINE') 05412000
         IKJENDP                                                        05413000
IKJEBCH4 IKJPARM  DSECT=IKJPRMD4                                        05414000
LICOUNT  IKJIDENT 'LINE COUNT',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=8,  X05415000
               PROMPT='VALID LINE COUNT',                              X05416000
               HELP=('DECIMAL VALUE GREATER THAN 0')                    05417000
         IKJENDP                                                        05418000
@DATD    DSECT                                                          05419000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05420000
@ENDDATD EQU   *                                                        05421000
IKJEBECH CSECT                                                          05422000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05423000
@01      EQU   01                                                       05424000
@02      EQU   02                                                       05425000
@03      EQU   03                                                       05426000
@04      EQU   04                                                       05427000
@05      EQU   05                                                       05428000
@06      EQU   06                                                       05429000
@07      EQU   07                                                       05430000
@08      EQU   08                                                       05431000
@09      EQU   09                                                       05432000
@10      EQU   10                                                       05433000
@11      EQU   11                                                       05434000
@12      EQU   12                                                       05435000
@13      EQU   13                                                       05436000
@14      EQU   14                                                       05437000
@15      EQU   15                                                       05438000
J        EQU   @05                                                      05439000
I        EQU   @02                                                      05440000
START    EQU   @03                                                      05441000
SENDPTR  EQU   @12                                                      05442000
READPTR  EQU   @02                                                      05443000
LINEPTR  EQU   @02                                                      05444000
BDYPTR   EQU   @03                                                      05445000
UPTPTR   EQU   @02                                                      05446000
RETCODE  EQU   @12                                                      05447000
ENDPTR   EQU   @02                                                      05448000
BASEREG2 EQU   @06                                                      05449000
PARMREG0 EQU   @00                                                      05450000
PARMREG1 EQU   @01                                                      05451000
LEV1INS  EQU   @02                                                      05452000
LEV2INS  EQU   @03                                                      05453000
BINRYREG EQU   @04                                                      05454000
BASEREG  EQU   @11                                                      05455000
RETREG   EQU   @14                                                      05456000
RETCDREG EQU   @15                                                      05457000
COMMREG  EQU   @09                                                      05458000
DATAREG  EQU   @10                                                      05459000
GPR13P   EQU   @13                                                      05460000
GPR15P   EQU   @15                                                      05461000
GPR02P   EQU   @02                                                      05462000
GPR03P   EQU   @03                                                      05463000
GPR04P   EQU   @04                                                      05464000
GPR05P   EQU   @05                                                      05465000
GPR01P   EQU   @01                                                      05466000
GPR12P   EQU   @12                                                      05467000
GPR00P   EQU   @00                                                      05468000
GPR06P   EQU   @06                                                      05469000
GPR07P   EQU   @07                                                      05470000
GPR08P   EQU   @08                                                      05471000
GPR09P   EQU   @09                                                      05472000
GPR14P   EQU   @14                                                      05473000
SAVEREG  EQU   @13                                                      05474000
CVTPTR   EQU   16                                                       05475000
IKJEBECA EQU   0                                                        05476000
CAPTPRSD EQU   IKJEBECA+36                                              05477000
CAPRSPDL EQU   CAPTPRSD                                                 05478000
CAPTIBFR EQU   IKJEBECA+40                                              05479000
CAOPERND EQU   CAPTIBFR                                                 05480000
CAPTSCMD EQU   IKJEBECA+44                                              05481000
CASCMDLN EQU   IKJEBECA+48                                              05482000
CAPTCDCB EQU   IKJEBECA+52                                              05483000
CAPTCHK  EQU   IKJEBECA+72                                              05484000
CAATTN   EQU   IKJEBECA+120                                             05485000
CAATTNIS EQU   CAATTN                                                   05486000
CACFLAG  EQU   IKJEBECA+124                                             05487000
CACFLAG1 EQU   CACFLAG                                                  05488000
CAVRFYSW EQU   CACFLAG1                                                 05489000
CASCANSW EQU   CACFLAG1                                                 05490000
CANONUM  EQU   CACFLAG1                                                 05491000
CACFLAG2 EQU   CACFLAG+1                                                05492000
CARECFM  EQU   CACFLAG2                                                 05493000
CACFLAG3 EQU   CACFLAG+2                                                05494000
CAIMFLG  EQU   CACFLAG3                                                 05495000
CACFLAG4 EQU   CACFLAG+3                                                05496000
CATPUTVF EQU   CACFLAG4                                                 05497000
CAINPROC EQU   CACFLAG4                                                 05498000
CACFLAG5 EQU   CACFLAG+4                                                05499000
CACFLAG6 EQU   CACFLAG+5                                                05500000
CAPD     EQU   IKJEBECA+152                                             05501000
CALINE   EQU   CAPD+18                                                  05502000
CALENGTH EQU   CAPD+19                                                  05503000
CASYNAME EQU   CAPD+32                                                  05504000
CADSCODE EQU   CAPD+40                                                  05505000
CADSATTR EQU   CAPD+41                                                  05506000
CADSATR2 EQU   CAPD+42                                                  05507000
CAPTPDXT EQU   IKJEBECA+228                                             05508000
CALRECL  EQU   IKJEBECA+232                                             05509000
CAEDFLAG EQU   IKJEBECA+236                                             05510000
CAEDFLG2 EQU   IKJEBECA+237                                             05511000
CASAFLAG EQU   IKJEBECA+376                                             05512000
CASAFLG2 EQU   IKJEBECA+377                                             05513000
CACURNUM EQU   IKJEBECA+456                                             05514000
CASYNLST EQU   IKJEBECA+496                                             05515000
CASYNBFR EQU   CASYNLST                                                 05516000
CASYNWA  EQU   IKJEBECA+508                                             05517000
CASYNOPT EQU   IKJEBECA+524                                             05518000
CASYNCD2 EQU   CASYNOPT+1                                               05519000
CASYNSW  EQU   CASYNOPT+3                                               05520000
CATMPLST EQU   IKJEBECA+528                                             05521000
CAPTUPT  EQU   CATMPLST                                                 05522000
CAMAWKA  EQU   IKJEBECA+596                                             05523000
MACFLAGS EQU   CAMAWKA+28                                               05524000
MACFLAG2 EQU   CAMAWKA+29                                               05525000
CAMODEMG EQU   IKJEBECA+928                                             05526000
CASCWKA  EQU   IKJEBECA+1448                                            05527000
CABFRPL  EQU   IKJEBECA+2120                                            05528000
CATEMPBF EQU   IKJEBECA+2648                                            05529000
CANXTSVA EQU   IKJEBECA+3896                                            05530000
IKJEBECX EQU   0                                                        05531000
@NM00028 EQU   0                                                        05532000
@NM00031 EQU   @NM00028+8                                               05533000
LNSTART  EQU   @NM00031                                                 05534000
LNSTARTL EQU   @NM00031+4                                               05535000
@NM00032 EQU   @NM00031+6                                               05536000
@NM00034 EQU   @NM00028+16                                              05537000
LNEND    EQU   @NM00034                                                 05538000
LNENDL   EQU   @NM00034+4                                               05539000
@NM00035 EQU   @NM00034+6                                               05540000
LNENDF   EQU   @NM00035                                                 05541000
@NM00037 EQU   @NM00028+24                                              05542000
LNCNT    EQU   @NM00037                                                 05543000
LNCNTL   EQU   @NM00037+4                                               05544000
@NM00038 EQU   @NM00037+6                                               05545000
LNCNTF   EQU   @NM00038                                                 05546000
@NM00040 EQU   @NM00028+32                                              05547000
STR1     EQU   @NM00040                                                 05548000
STR1L    EQU   @NM00040+4                                               05549000
@NM00041 EQU   @NM00040+6                                               05550000
STR1F    EQU   @NM00041                                                 05551000
@NM00043 EQU   @NM00028+40                                              05552000
STR2     EQU   @NM00043                                                 05553000
STR2L    EQU   @NM00043+4                                               05554000
@NM00044 EQU   @NM00043+6                                               05555000
STR2F    EQU   @NM00044                                                 05556000
@NM00046 EQU   @NM00028+48                                              05557000
ALLKYWD1 EQU   @NM00046                                                 05558000
@NM00047 EQU   0                                                        05559000
@NM00050 EQU   @NM00047+8                                               05560000
@NM00051 EQU   @NM00050+6                                               05561000
@NM00053 EQU   @NM00047+16                                              05562000
@NM00054 EQU   @NM00053+6                                               05563000
@NM00056 EQU   @NM00047+24                                              05564000
@NM00057 EQU   @NM00056+6                                               05565000
@NM00059 EQU   @NM00047+32                                              05566000
@NM00060 EQU   0                                                        05567000
@NM00063 EQU   @NM00060+8                                               05568000
CHCNT    EQU   @NM00063                                                 05569000
CHCNTL   EQU   @NM00063+4                                               05570000
@NM00064 EQU   @NM00063+6                                               05571000
@NM00066 EQU   0                                                        05572000
@NM00069 EQU   @NM00066+8                                               05573000
LICNT    EQU   @NM00069                                                 05574000
@NM00070 EQU   @NM00069+6                                               05575000
PPL      EQU   0                                                        05576000
PPLPCL   EQU   PPL+12                                                   05577000
PPLANS   EQU   PPL+16                                                   05578000
PPLCBUF  EQU   PPL+20                                                   05579000
PPLUWA   EQU   PPL+24                                                   05580000
LNUM     EQU   0                                                        05581000
EXTRATXT EQU   0                                                        05582000
EXTRALEN EQU   EXTRATXT                                                 05583000
EXTRALN  EQU   EXTRATXT+4                                               05584000
@NM00077 EQU   0                                                        05585000
STRING   EQU   0                                                        05586000
CHECKER  EQU   0                                                        05587000
IOPL     EQU   0                                                        05588000
IOPLIOPB EQU   IOPL+12                                                  05589000
PTPB     EQU   0                                                        05590000
GTPB     EQU   0                                                        05591000
GTPBIBUF EQU   GTPB+4                                                   05592000
GETBUFF  EQU   0                                                        05593000
BFRLEN   EQU   GETBUFF                                                  05594000
BFRTXT   EQU   GETBUFF+4                                                05595000
UPT      EQU   0                                                        05596000
UPTSWS   EQU   UPT+12                                                   05597000
UPTNPRM  EQU   UPTSWS                                                   05598000
CVTMAP   EQU   0                                                        05599000
CVTDAR   EQU   CVTMAP+72                                                05600000
CVTFLGS1 EQU   CVTDAR                                                   05601000
CVTDCB   EQU   CVTMAP+116                                               05602000
CVTIOQET EQU   CVTMAP+120                                               05603000
CVTIERLC EQU   CVTMAP+144                                               05604000
CVTHEAD  EQU   CVTMAP+160                                               05605000
CVTSV76C EQU   CVTHEAD                                                  05606000
CVTOPTA  EQU   CVTMAP+182                                               05607000
CVTOPTB  EQU   CVTMAP+183                                               05608000
CVTGTF   EQU   CVTMAP+236                                               05609000
CVTGTFST EQU   CVTGTF                                                   05610000
CVTGTFS  EQU   CVTGTFST                                                 05611000
CVTSTATE EQU   CVTGTFST                                                 05612000
CVTTMODE EQU   CVTGTFST                                                 05613000
CVTFORM  EQU   CVTGTFST                                                 05614000
CVTAQAVT EQU   CVTMAP+240                                               05615000
CVTTCMFG EQU   CVTAQAVT                                                 05616000
CVTVOLM2 EQU   CVTMAP+244                                               05617000
CVTTATA  EQU   CVTVOLM2                                                 05618000
CVTTSKS  EQU   CVTTATA                                                  05619000
CVTVOLF2 EQU   CVTTSKS                                                  05620000
CVTTAT   EQU   CVTTATA+1                                                05621000
CVTATER  EQU   CVTMAP+248                                               05622000
CVTEXT1  EQU   CVTMAP+252                                               05623000
CVTPURG  EQU   CVTMAP+260                                               05624000
CVTQMSG  EQU   CVTMAP+268                                               05625000
CVTDMSR  EQU   CVTMAP+272                                               05626000
CVTRSV37 EQU   CVTDMSR                                                  05627000
CVTDMSRF EQU   CVTRSV37                                                 05628000
CVTERPV  EQU   CVTMAP+316                                               05629000
CVTINTLA EQU   CVTMAP+320                                               05630000
CVTAPF   EQU   CVTMAP+324                                               05631000
CVTEXT2  EQU   CVTMAP+328                                               05632000
CVTHJES  EQU   CVTMAP+332                                               05633000
CVTPGSIA EQU   CVTMAP+348                                               05634000
CVTA1F1  EQU   CVTMAP+356                                               05635000
CVTSYSK  EQU   CVTMAP+357                                               05636000
CVTVOLM1 EQU   CVTMAP+380                                               05637000
CVTVOLF1 EQU   CVTVOLM1                                                 05638000
CVTATMCT EQU   CVTMAP+388                                               05639000
CVTXTNT1 EQU   0                                                        05640000
CVTXTNT2 EQU   0                                                        05641000
CVTDSSV  EQU   CVTXTNT2                                                 05642000
CVTFLGBT EQU   CVTXTNT2+5                                               05643000
CVTQID   EQU   CVTXTNT2+24                                              05644000
CVTRV400 EQU   CVTXTNT2+52                                              05645000
CVTRV409 EQU   CVTXTNT2+53                                              05646000
CVTATCVT EQU   CVTXTNT2+64                                              05647000
CVTRV429 EQU   CVTXTNT2+84                                              05648000
CVTRV438 EQU   CVTXTNT2+85                                              05649000
CVTRV457 EQU   CVTXTNT2+112                                             05650000
CVTRV466 EQU   CVTXTNT2+113                                             05651000
CVTFIX   EQU   0                                                        05652000
CVTRELNO EQU   CVTFIX+252                                               05653000
CASAVPTR EQU   0                                                        05654000
CASAVE   EQU   0                                                        05655000
I001C    EQU   0                                                        05656000
I008P    EQU   0                                                        05657000
I015F    EQU   0                                                        05658000
I015P    EQU   0                                                        05659000
I031F    EQU   0                                                        05660000
I031P    EQU   0                                                        05661000
I256C    EQU   0                                                        05662000
BLANKBFR EQU   CATEMPBF                                                 05663000
BLANKLEN EQU   BLANKBFR                                                 05664000
BLANKOFF EQU   BLANKBFR+2                                               05665000
BLANKTXT EQU   BLANKBFR+4                                               05666000
MSGAREA  EQU   CABFRPL+260                                              05667000
MSGPTR   EQU   MSGAREA                                                  05668000
MSGLEN   EQU   MSGAREA+4                                                05669000
MSGOFF   EQU   MSGAREA+6                                                05670000
MSGTEXT  EQU   MSGAREA+8                                                05671000
MSGPTR2  EQU   MSGAREA+80                                               05672000
MSGLEN2  EQU   MSGAREA+84                                               05673000
MSGOFF2  EQU   MSGAREA+86                                               05674000
MSGTEXT2 EQU   MSGAREA+88                                               05675000
TEXTBFR  EQU   CATEMPBF                                                 05676000
TRUNCKEY EQU   CHARCNT                                                  05677000
VERLINE  EQU   CATEMPBF+12                                              05678000
BUFFAREA EQU   CABFRPL                                                  05679000
KEYFLD   EQU   BUFFAREA                                                 05680000
RECLEN   EQU   BUFFAREA+4                                               05681000
RECTEXT  EQU   BUFFAREA+8                                               05682000
KEYFLD2  EQU   BUFFAREA+264                                             05683000
RECLEN2  EQU   BUFFAREA+268                                             05684000
RECOFF2  EQU   BUFFAREA+270                                             05685000
RECTEXT2 EQU   BUFFAREA+272                                             05686000
NEWTEXT  EQU   RECTEXT                                                  05687000
ENTRYCD  EQU   CASYNCD2                                                 05688000
IOPLPTR  EQU   PPLPTR                                                   05689000
CVTS01   EQU   CVTPGSIA                                                 05690000
CVTLPDIA EQU   CVTS01+12                                                05691000
CVTDIRST EQU   CVTLPDIA                                                 05692000
CVTSLIDA EQU   CVTS01+24                                                05693000
CVTCTLFG EQU   CVTS01+50                                                05694000
CVTPARS  EQU   CVTS01+176                                               05695000
CVTRV210 EQU   CVTS01+424                                               05696000
CVTRV219 EQU   CVTS01+425                                               05697000
CVTRV228 EQU   CVTS01+426                                               05698000
CVTRV237 EQU   CVTS01+427                                               05699000
CVTMFRTR EQU   CVTS01+452                                               05700000
CVTRV262 EQU   CVTS01+468                                               05701000
CVTRV271 EQU   CVTS01+469                                               05702000
CVTRV280 EQU   CVTS01+470                                               05703000
CVTRV289 EQU   CVTS01+471                                               05704000
CVTGSDA  EQU   CVTS01+600                                               05705000
BFAREA2  EQU   CATEMPBF                                                 05706000
KEYFLD3  EQU   BFAREA2                                                  05707000
RECLEN3  EQU   BFAREA2+4                                                05708000
RECTEXT3 EQU   BFAREA2+8                                                05709000
KEYFLD4  EQU   BFAREA2+264                                              05710000
RECLEN4  EQU   BFAREA2+268                                              05711000
RECTEXT4 EQU   BFAREA2+272                                              05712000
@NM00086 EQU   KEYFLD                                                   05713000
SCPTR1   EQU   @NM00086                                                 05714000
SCCNT1   EQU   SCPTR1                                                   05715000
SCPTR2   EQU   @NM00086+4                                               05716000
SCCNT2   EQU   SCPTR2                                                   05717000
*                                      START UNREFERENCED COMPONENTS    05718000
RECOFF4  EQU   BFAREA2+270                                              05719000
@NM00085 EQU   BFAREA2+263                                              05720000
RECOFF3  EQU   BFAREA2+6                                                05721000
CVTRV628 EQU   CVTS01+728                                               05722000
CVTRV627 EQU   CVTS01+724                                               05723000
CVTRV626 EQU   CVTS01+720                                               05724000
CVTRV625 EQU   CVTS01+716                                               05725000
CVTRV624 EQU   CVTS01+712                                               05726000
CVTRV623 EQU   CVTS01+708                                               05727000
CVTRV622 EQU   CVTS01+704                                               05728000
CVTRV621 EQU   CVTS01+700                                               05729000
CVTIHASU EQU   CVTS01+696                                               05730000
CVTRV619 EQU   CVTS01+692                                               05731000
CVTRV618 EQU   CVTS01+688                                               05732000
CVTRV617 EQU   CVTS01+684                                               05733000
CVTRV616 EQU   CVTS01+680                                               05734000
CVTRV615 EQU   CVTS01+676                                               05735000
CVTRV614 EQU   CVTS01+672                                               05736000
CVTRV613 EQU   CVTS01+668                                               05737000
CVTTCASP EQU   CVTS01+664                                               05738000
CVT0PT03 EQU   CVTS01+660                                               05739000
CVT0PT0E EQU   CVTS01+656                                               05740000
CVTRV609 EQU   CVTS01+652                                               05741000
CVTCGK   EQU   CVTS01+648                                               05742000
CVTRAC   EQU   CVTS01+644                                               05743000
CVTRV606 EQU   CVTS01+640                                               05744000
CVTRV605 EQU   CVTS01+636                                               05745000
CVTRV604 EQU   CVTS01+632                                               05746000
CVTEFF02 EQU   CVTS01+628                                               05747000
CVTCBBR  EQU   CVTS01+624                                               05748000
CVTSSCR  EQU   CVTS01+620                                               05749000
CVTEVENT EQU   CVTS01+616                                               05750000
CVTCRCA  EQU   CVTS01+612                                               05751000
CVTTPIO  EQU   CVTS01+608                                               05752000
CVTADV   EQU   CVTS01+604                                               05753000
CVTGSDAB EQU   CVTGSDA                                                  05754000
CVTQV3   EQU   CVTS01+596                                               05755000
CVTQV2   EQU   CVTS01+592                                               05756000
CVTQV1   EQU   CVTS01+588                                               05757000
CVTRPT   EQU   CVTS01+584                                               05758000
CVTSSRB  EQU   CVTS01+580                                               05759000
CVTCSDRL EQU   CVTS01+576                                               05760000
CVTEXP1  EQU   CVTS01+572                                               05761000
CVTRMPMT EQU   CVTS01+568                                               05762000
CVTRMPTT EQU   CVTS01+564                                               05763000
CVTVPSA  EQU   CVTS01+560                                               05764000
CVTVSTOP EQU   CVTS01+556                                               05765000
CVTGTFR8 EQU   CVTS01+552                                               05766000
CVTQUIT  EQU   CVTS01+548                                               05767000
CVTVACR  EQU   CVTS01+544                                               05768000
CVTWTCB  EQU   CVTS01+540                                               05769000
CVTSTPRS EQU   CVTS01+536                                               05770000
CVT0PT02 EQU   CVTS01+532                                               05771000
CVTDARCM EQU   CVTS01+528                                               05772000
CVTIRECM EQU   CVTS01+524                                               05773000
CVTJRECM EQU   CVTS01+520                                               05774000
CVTVEMS0 EQU   CVTS01+516                                               05775000
CVTSPFRR EQU   CVTS01+512                                               05776000
CVTRLSTG EQU   CVTS01+508                                               05777000
CVT0TC0A EQU   CVTS01+504                                               05778000
CVTGMBR  EQU   CVTS01+500                                               05779000
CVTLFRM  EQU   CVTS01+496                                               05780000
CVTRMBR  EQU   CVTS01+492                                               05781000
CVTVIOP  EQU   CVTS01+488                                               05782000
CVTRV307 EQU   CVTS01+486                                               05783000
CVTRV306 EQU   CVTS01+484                                               05784000
CVTRV305 EQU   CVTS01+482                                               05785000
CVTRV304 EQU   CVTS01+480                                               05786000
CVTRV303 EQU   CVTS01+478                                               05787000
CVTRV302 EQU   CVTS01+476                                               05788000
CVTTRCA  EQU   CVTS01+472                                               05789000
CVTRV297 EQU   CVTRV289                                                 05790000
CVTRV296 EQU   CVTRV289                                                 05791000
CVTRV295 EQU   CVTRV289                                                 05792000
CVTRV294 EQU   CVTRV289                                                 05793000
CVTRV293 EQU   CVTRV289                                                 05794000
CVTRV292 EQU   CVTRV289                                                 05795000
CVTRV291 EQU   CVTRV289                                                 05796000
CVTRV290 EQU   CVTRV289                                                 05797000
CVTRV288 EQU   CVTRV280                                                 05798000
CVTRV287 EQU   CVTRV280                                                 05799000
CVTRV286 EQU   CVTRV280                                                 05800000
CVTRV285 EQU   CVTRV280                                                 05801000
CVTRV284 EQU   CVTRV280                                                 05802000
CVTRV283 EQU   CVTRV280                                                 05803000
CVTRV282 EQU   CVTRV280                                                 05804000
CVTRV281 EQU   CVTRV280                                                 05805000
CVTRV279 EQU   CVTRV271                                                 05806000
CVTRV278 EQU   CVTRV271                                                 05807000
CVTRV277 EQU   CVTRV271                                                 05808000
CVTRV276 EQU   CVTRV271                                                 05809000
CVTRV275 EQU   CVTRV271                                                 05810000
CVTRV274 EQU   CVTRV271                                                 05811000
CVTRV273 EQU   CVTRV271                                                 05812000
CVTRV272 EQU   CVTRV271                                                 05813000
CVTRV270 EQU   CVTRV262                                                 05814000
CVTRV269 EQU   CVTRV262                                                 05815000
CVTRV268 EQU   CVTRV262                                                 05816000
CVTRV267 EQU   CVTRV262                                                 05817000
CVTRV266 EQU   CVTRV262                                                 05818000
CVTRV265 EQU   CVTRV262                                                 05819000
CVTRV264 EQU   CVTRV262                                                 05820000
CVTRV263 EQU   CVTRV262                                                 05821000
CVTVFP   EQU   CVTS01+464                                               05822000
CVTVSI   EQU   CVTS01+460                                               05823000
CVTVPSIB EQU   CVTS01+456                                               05824000
CVTMFACT EQU   CVTMFRTR                                                 05825000
CVTMFCTL EQU   CVTS01+448                                               05826000
CVTPVBP  EQU   CVTS01+444                                               05827000
CVTPWI   EQU   CVTS01+440                                               05828000
CVTRV254 EQU   CVTS01+438                                               05829000
CVTRV253 EQU   CVTS01+436                                               05830000
CVTRV252 EQU   CVTS01+434                                               05831000
CVTRV251 EQU   CVTS01+433                                               05832000
CVTRV250 EQU   CVTS01+432                                               05833000
CVTRV249 EQU   CVTS01+431                                               05834000
CVTRV248 EQU   CVTS01+430                                               05835000
CVTRV247 EQU   CVTS01+429                                               05836000
CVTRV246 EQU   CVTS01+428                                               05837000
CVTRV245 EQU   CVTRV237                                                 05838000
CVTRV244 EQU   CVTRV237                                                 05839000
CVTRV243 EQU   CVTRV237                                                 05840000
CVTRV242 EQU   CVTRV237                                                 05841000
CVTRV241 EQU   CVTRV237                                                 05842000
CVTRV240 EQU   CVTRV237                                                 05843000
CVTRV239 EQU   CVTRV237                                                 05844000
CVTRV238 EQU   CVTRV237                                                 05845000
CVTRV236 EQU   CVTRV228                                                 05846000
CVTRV235 EQU   CVTRV228                                                 05847000
CVTRV234 EQU   CVTRV228                                                 05848000
CVTRV233 EQU   CVTRV228                                                 05849000
CVTRV232 EQU   CVTRV228                                                 05850000
CVTRV231 EQU   CVTRV228                                                 05851000
CVTRV230 EQU   CVTRV228                                                 05852000
CVTRV229 EQU   CVTRV228                                                 05853000
CVTRV227 EQU   CVTRV219                                                 05854000
CVTRV226 EQU   CVTRV219                                                 05855000
CVTRV225 EQU   CVTRV219                                                 05856000
CVTRV224 EQU   CVTRV219                                                 05857000
CVTRV223 EQU   CVTRV219                                                 05858000
CVTRV222 EQU   CVTRV219                                                 05859000
CVTRV221 EQU   CVTRV219                                                 05860000
CVTRV220 EQU   CVTRV219                                                 05861000
CVTRV218 EQU   CVTRV210                                                 05862000
CVTRV217 EQU   CVTRV210                                                 05863000
CVTRV216 EQU   CVTRV210                                                 05864000
CVTRV215 EQU   CVTRV210                                                 05865000
CVTRV214 EQU   CVTRV210                                                 05866000
CVTRV213 EQU   CVTRV210                                                 05867000
CVTRV212 EQU   CVTRV210                                                 05868000
CVTRV211 EQU   CVTRV210                                                 05869000
CVTLCCAT EQU   CVTS01+420                                               05870000
CVTPCCAT EQU   CVTS01+416                                               05871000
CVTIPCRP EQU   CVTS01+412                                               05872000
CVTIPCRI EQU   CVTS01+408                                               05873000
CVTIPCDS EQU   CVTS01+404                                               05874000
CVTAIDVT EQU   CVTS01+400                                               05875000
CVTSSAP  EQU   CVTS01+396                                               05876000
CVTEHCIR EQU   CVTS01+392                                               05877000
CVTEHDEF EQU   CVTS01+388                                               05878000
CVTDAIR  EQU   CVTS01+384                                               05879000
CVTPERFM EQU   CVTS01+380                                               05880000
CVT044R2 EQU   CVTS01+376                                               05881000
CVTFETCH EQU   CVTS01+372                                               05882000
CVTRSTWD EQU   CVTS01+368                                               05883000
CVTSPOST EQU   CVTS01+364                                               05884000
CVTIOBP  EQU   CVTS01+360                                               05885000
CVTASMVT EQU   CVTS01+356                                               05886000
CVTRECRQ EQU   CVTS01+352                                               05887000
CVTWSAC  EQU   CVTS01+348                                               05888000
CVTRV149 EQU   CVTS01+344                                               05889000
CVTWSAL  EQU   CVTS01+340                                               05890000
CVTSPSA  EQU   CVTS01+336                                               05891000
CVTGLMN  EQU   CVTS01+332                                               05892000
CVTVEAC0 EQU   CVTS01+328                                               05893000
CVT062R1 EQU   CVTS01+324                                               05894000
CVTRPOST EQU   CVTS01+320                                               05895000
CVTDQIQE EQU   CVTS01+316                                               05896000
CVTCSD   EQU   CVTS01+312                                               05897000
CVTLKRMA EQU   CVTS01+308                                               05898000
CVTRSPIE EQU   CVTS01+304                                               05899000
CVTRENQ  EQU   CVTS01+300                                               05900000
CVTLQCB  EQU   CVTS01+296                                               05901000
CVTFQCB  EQU   CVTS01+292                                               05902000
CVTQCS01 EQU   CVTS01+288                                               05903000
CVTAPFT  EQU   CVTS01+284                                               05904000
CVTPARRL EQU   CVTS01+280                                               05905000
CVTVWAIT EQU   CVTS01+276                                               05906000
CVTGSPL  EQU   CVTS01+272                                               05907000
CVTLSMQ  EQU   CVTS01+268                                               05908000
CVTGSMQ  EQU   CVTS01+264                                               05909000
CVTEXPRO EQU   CVTS01+260                                               05910000
CVTOPCTP EQU   CVTS01+256                                               05911000
CVTSIC   EQU   CVTS01+252                                               05912000
CVTTPIOS EQU   CVTS01+248                                               05913000
CVTRTMS  EQU   CVTS01+244                                               05914000
CVTSDBF  EQU   CVTS01+240                                               05915000
CVTSCBP  EQU   CVTS01+236                                               05916000
CVTSDMP  EQU   CVTS01+232                                               05917000
CVTSV60  EQU   CVTS01+228                                               05918000
CVTRTMCT EQU   CVTS01+224                                               05919000
CVTASCBL EQU   CVTS01+220                                               05920000
CVTASCBH EQU   CVTS01+216                                               05921000
CVTGDA   EQU   CVTS01+212                                               05922000
CVTASVT  EQU   CVTS01+208                                               05923000
CVTVVMDI EQU   CVTS01+204                                               05924000
CVTAQTOP EQU   CVTS01+200                                               05925000
CVTIOSCS EQU   CVTS01+196                                               05926000
CVTSDRM  EQU   CVTS01+192                                               05927000
CVTOPTE  EQU   CVTS01+188                                               05928000
CVTSTXU  EQU   CVTS01+184                                               05929000
CVTQUIS  EQU   CVTS01+180                                               05930000
CVTS1EE  EQU   CVTS01+172                                               05931000
CVTFRAS  EQU   CVTS01+168                                               05932000
CVTQSAS  EQU   CVTS01+164                                               05933000
CVTCRAS  EQU   CVTS01+160                                               05934000
CVTCRMN  EQU   CVTS01+156                                               05935000
CVTDELCP EQU   CVTS01+152                                               05936000
CVTFRECL EQU   CVTS01+148                                               05937000
CVTGETCL EQU   CVTS01+144                                               05938000
CVTBLDCP EQU   CVTS01+140                                               05939000
CVTAUTHL EQU   CVTS01+136                                               05940000
CVTSCAN  EQU   CVTS01+132                                               05941000
CVTRV144 EQU   CVTS01+130                                               05942000
CVTMAXMP EQU   CVTS01+128                                               05943000
CVTSTCK  EQU   CVTS01+124                                               05944000
CVTRV139 EQU   CVTS01+123                                               05945000
CVTDSSAC EQU   CVTS01+122                                               05946000
CVTRV513 EQU   CVTS01+121                                               05947000
CVTIOSPL EQU   CVTS01+120                                               05948000
CVTPTGT  EQU   CVTS01+116                                               05949000
CVTCSPIE EQU   CVTS01+112                                               05950000
CVTSMFEX EQU   CVTS01+108                                               05951000
CVTOLT0A EQU   CVTS01+104                                               05952000
CVTSRBRT EQU   CVTS01+100                                               05953000
CVTPUTL  EQU   CVTS01+96                                                05954000
CVTASCRL EQU   CVTS01+92                                                05955000
CVTASCRF EQU   CVTS01+88                                                05956000
CVTRV326 EQU   CVTS01+84                                                05957000
CVTRV325 EQU   CVTS01+80                                                05958000
CVTRV324 EQU   CVTS01+76                                                05959000
CVT0VL01 EQU   CVTS01+72                                                05960000
CVTSHRVM EQU   CVTS01+68                                                05961000
CVTRV332 EQU   CVTS01+64                                                05962000
CVTTAS   EQU   CVTS01+60                                                05963000
CVTRSCN  EQU   CVTS01+56                                                05964000
CVTTRAC2 EQU   CVTS01+54                                                05965000
CVTTRACE EQU   CVTS01+52                                                05966000
CVTAPG   EQU   CVTS01+51                                                05967000
CVTSDTRC EQU   CVTCTLFG                                                 05968000
CVTGTRCE EQU   CVTCTLFG                                                 05969000
CVTNOMP  EQU   CVTCTLFG                                                 05970000
CVTRSV79 EQU   CVTCTLFG                                                 05971000
CVTDSTAT EQU   CVTCTLFG                                                 05972000
CVTRSV78 EQU   CVTCTLFG                                                 05973000
CVTRV333 EQU   CVTCTLFG                                                 05974000
CVTRV323 EQU   CVTCTLFG                                                 05975000
CVTSPVLK EQU   CVTS01+49                                                05976000
CVTRSV77 EQU   CVTS01+48                                                05977000
CVTRV331 EQU   CVTS01+44                                                05978000
CVTRV330 EQU   CVTS01+40                                                05979000
CVTRV329 EQU   CVTS01+36                                                05980000
CVTRV328 EQU   CVTS01+32                                                05981000
CVTRV322 EQU   CVTS01+28                                                05982000
CVTSLID  EQU   CVTSLIDA+1                                               05983000
CVTSYLK  EQU   CVTSLIDA                                                 05984000
CVTRV321 EQU   CVTS01+20                                                05985000
CVTRV320 EQU   CVTS01+16                                                05986000
CVTLPDIR EQU   CVTLPDIA+1                                               05987000
CVTRSV69 EQU   CVTDIRST                                                 05988000
CVTRSV68 EQU   CVTDIRST                                                 05989000
CVTRSV67 EQU   CVTDIRST                                                 05990000
CVTRSV66 EQU   CVTDIRST                                                 05991000
CVTRSV65 EQU   CVTDIRST                                                 05992000
CVTRSV64 EQU   CVTDIRST                                                 05993000
CVTRSV63 EQU   CVTDIRST                                                 05994000
CVTDICOM EQU   CVTDIRST                                                 05995000
CVTPVTP  EQU   CVTS01+8                                                 05996000
CVTLPDSR EQU   CVTS01+4                                                 05997000
CVTGETL  EQU   CVTS01                                                   05998000
@NM00084 EQU   BUFFAREA+263                                             05999000
RECOFF   EQU   BUFFAREA+6                                               06000000
CVTLEVL  EQU   CVTRELNO+2                                               06001000
CVTNUMB  EQU   CVTRELNO                                                 06002000
CVTMDL   EQU   CVTFIX+250                                               06003000
@NM00083 EQU   CVTFIX+248                                               06004000
@NM00082 EQU   CVTFIX                                                   06005000
CVTRV482 EQU   CVTXTNT2+128                                             06006000
CVTRV481 EQU   CVTXTNT2+124                                             06007000
CVTRV480 EQU   CVTXTNT2+120                                             06008000
CVTRV479 EQU   CVTXTNT2+118                                             06009000
CVTRV478 EQU   CVTXTNT2+117                                             06010000
CVTRV477 EQU   CVTXTNT2+116                                             06011000
CVTRV476 EQU   CVTXTNT2+115                                             06012000
CVTRV475 EQU   CVTXTNT2+114                                             06013000
CVTRV474 EQU   CVTRV466                                                 06014000
CVTRV473 EQU   CVTRV466                                                 06015000
CVTRV472 EQU   CVTRV466                                                 06016000
CVTRV471 EQU   CVTRV466                                                 06017000
CVTRV470 EQU   CVTRV466                                                 06018000
CVTRV469 EQU   CVTRV466                                                 06019000
CVTRV468 EQU   CVTRV466                                                 06020000
CVTRV467 EQU   CVTRV466                                                 06021000
CVTRV465 EQU   CVTRV457                                                 06022000
CVTRV464 EQU   CVTRV457                                                 06023000
CVTRV463 EQU   CVTRV457                                                 06024000
CVTRV462 EQU   CVTRV457                                                 06025000
CVTRV461 EQU   CVTRV457                                                 06026000
CVTRV460 EQU   CVTRV457                                                 06027000
CVTRV459 EQU   CVTRV457                                                 06028000
CVTRV458 EQU   CVTRV457                                                 06029000
CVTRV456 EQU   CVTXTNT2+108                                             06030000
CVTRV455 EQU   CVTXTNT2+104                                             06031000
CVTRV454 EQU   CVTXTNT2+100                                             06032000
CVTRV453 EQU   CVTXTNT2+96                                              06033000
CVTRV452 EQU   CVTXTNT2+94                                              06034000
CVTRV451 EQU   CVTXTNT2+92                                              06035000
CVTRV450 EQU   CVTXTNT2+90                                              06036000
CVTRV449 EQU   CVTXTNT2+88                                              06037000
CVTRV448 EQU   CVTXTNT2+87                                              06038000
CVTRV447 EQU   CVTXTNT2+86                                              06039000
CVTRV446 EQU   CVTRV438                                                 06040000
CVTRV445 EQU   CVTRV438                                                 06041000
CVTRV444 EQU   CVTRV438                                                 06042000
CVTRV443 EQU   CVTRV438                                                 06043000
CVTRV442 EQU   CVTRV438                                                 06044000
CVTRV441 EQU   CVTRV438                                                 06045000
CVTRV440 EQU   CVTRV438                                                 06046000
CVTRV439 EQU   CVTRV438                                                 06047000
CVTRV437 EQU   CVTRV429                                                 06048000
CVTRV436 EQU   CVTRV429                                                 06049000
CVTRV435 EQU   CVTRV429                                                 06050000
CVTRV434 EQU   CVTRV429                                                 06051000
CVTRV433 EQU   CVTRV429                                                 06052000
CVTRV432 EQU   CVTRV429                                                 06053000
CVTRV431 EQU   CVTRV429                                                 06054000
CVTRV430 EQU   CVTRV429                                                 06055000
CVTRV428 EQU   CVTXTNT2+80                                              06056000
CVTRV427 EQU   CVTXTNT2+76                                              06057000
CVTRV426 EQU   CVTXTNT2+72                                              06058000
CVTRV425 EQU   CVTXTNT2+68                                              06059000
CVTATACT EQU   CVTATCVT                                                 06060000
CVTRV423 EQU   CVTXTNT2+62                                              06061000
CVTRV422 EQU   CVTXTNT2+60                                              06062000
CVTRV421 EQU   CVTXTNT2+58                                              06063000
CVTRV420 EQU   CVTXTNT2+56                                              06064000
CVTRV419 EQU   CVTXTNT2+55                                              06065000
CVTRV418 EQU   CVTXTNT2+54                                              06066000
CVTRV417 EQU   CVTRV409                                                 06067000
CVTRV416 EQU   CVTRV409                                                 06068000
CVTRV415 EQU   CVTRV409                                                 06069000
CVTRV414 EQU   CVTRV409                                                 06070000
CVTRV413 EQU   CVTRV409                                                 06071000
CVTRV412 EQU   CVTRV409                                                 06072000
CVTRV411 EQU   CVTRV409                                                 06073000
CVTRV410 EQU   CVTRV409                                                 06074000
CVTRV408 EQU   CVTRV400                                                 06075000
CVTRV407 EQU   CVTRV400                                                 06076000
CVTRV406 EQU   CVTRV400                                                 06077000
CVTRV405 EQU   CVTRV400                                                 06078000
CVTRV404 EQU   CVTRV400                                                 06079000
CVTRV403 EQU   CVTRV400                                                 06080000
CVTRV402 EQU   CVTRV400                                                 06081000
CVTRV401 EQU   CVTRV400                                                 06082000
CVTICB   EQU   CVTXTNT2+48                                              06083000
CVTSKTA  EQU   CVTXTNT2+44                                              06084000
CVTRSV99 EQU   CVTXTNT2+40                                              06085000
CVTRSV98 EQU   CVTXTNT2+36                                              06086000
CVTRSV97 EQU   CVTXTNT2+34                                              06087000
CVTRSV96 EQU   CVTXTNT2+32                                              06088000
CVTOLTEP EQU   CVTXTNT2+28                                              06089000
CVTQIDA  EQU   CVTQID+1                                                 06090000
CVTRSV95 EQU   CVTQID                                                   06091000
CVTRSV94 EQU   CVTXTNT2+20                                              06092000
CVTRSV93 EQU   CVTXTNT2+16                                              06093000
CVTRSV92 EQU   CVTXTNT2+12                                              06094000
CVTDEBVR EQU   CVTXTNT2+8                                               06095000
CVTRSV91 EQU   CVTXTNT2+6                                               06096000
CVTRSV9H EQU   CVTFLGBT                                                 06097000
CVTRSV9G EQU   CVTFLGBT                                                 06098000
CVTRSV9F EQU   CVTFLGBT                                                 06099000
CVTRSV9E EQU   CVTFLGBT                                                 06100000
CVTRSV9D EQU   CVTFLGBT                                                 06101000
CVTRSV9C EQU   CVTFLGBT                                                 06102000
CVTVME   EQU   CVTFLGBT                                                 06103000
CVTNPE   EQU   CVTFLGBT                                                 06104000
CVTNUCLS EQU   CVTXTNT2+4                                               06105000
CVTDSSVA EQU   CVTDSSV+1                                                06106000
CVTRSV89 EQU   CVTDSSV                                                  06107000
CVTRSV88 EQU   CVTXTNT1+8                                               06108000
CVTRSV87 EQU   CVTXTNT1+4                                               06109000
CVTFACHN EQU   CVTXTNT1                                                 06110000
CVTRV488 EQU   CVTMAP+412                                               06111000
CVTRV487 EQU   CVTMAP+408                                               06112000
CVTRV486 EQU   CVTMAP+404                                               06113000
CVTRV485 EQU   CVTMAP+400                                               06114000
CVTACTAP EQU   CVTMAP+396                                               06115000
CVTAUTH  EQU   CVTMAP+392                                               06116000
CVTATMCA EQU   CVTATMCT+1                                               06117000
CVTATMST EQU   CVTATMCT                                                 06118000
CVTRSV61 EQU   CVTMAP+384                                               06119000
CVTVOLT1 EQU   CVTVOLM1+1                                               06120000
CVTVOLI1 EQU   CVTVOLF1                                                 06121000
CVTSTOA  EQU   CVTMAP+376                                               06122000
CVTRSV58 EQU   CVTMAP+374                                               06123000
CVTRSV57 EQU   CVTMAP+372                                               06124000
CVTDDCE  EQU   CVTMAP+368                                               06125000
CVTPNWFR EQU   CVTMAP+364                                               06126000
CVTSMF   EQU   CVTMAP+360                                               06127000
CVTSULK  EQU   CVTMAP+358                                               06128000
CVTSLKO  EQU   CVTSYSK                                                  06129000
CVTSLKP  EQU   CVTSYSK                                                  06130000
CVTSLKQ  EQU   CVTSYSK                                                  06131000
CVTSLKR  EQU   CVTSYSK                                                  06132000
CVTRSV56 EQU   CVTSYSK                                                  06133000
CVTRSV55 EQU   CVTSYSK                                                  06134000
CVTRSV54 EQU   CVTSYSK                                                  06135000
CVTRSV53 EQU   CVTSYSK                                                  06136000
CVTRSV52 EQU   CVTA1F1                                                  06137000
CVTRSV51 EQU   CVTA1F1                                                  06138000
CVTRSV50 EQU   CVTA1F1                                                  06139000
CVTRSV49 EQU   CVTA1F1                                                  06140000
CVTRSV48 EQU   CVTA1F1                                                  06141000
CVTRSV47 EQU   CVTA1F1                                                  06142000
CVTSRSW  EQU   CVTA1F1                                                  06143000
CVTPFSW  EQU   CVTA1F1                                                  06144000
CVTPCVT  EQU   CVTMAP+352                                               06145000
CVTRSV46 EQU   CVTMAP+344                                               06146000
CVTRSV45 EQU   CVTMAP+340                                               06147000
CVTRSV44 EQU   CVTMAP+338                                               06148000
CVTRSV43 EQU   CVTMAP+336                                               06149000
CVTHJESA EQU   CVTHJES+1                                                06150000
CVTRSV42 EQU   CVTHJES                                                  06151000
CVTEXT2A EQU   CVTEXT2+1                                                06152000
CVTRSV41 EQU   CVTEXT2                                                  06153000
CVTAPFA  EQU   CVTAPF+1                                                 06154000
CVTRSV40 EQU   CVTAPF                                                   06155000
CVTRV518 EQU   CVTINTLA                                                 06156000
CVTRV517 EQU   CVTERPV                                                  06157000
CVTEORM  EQU   CVTMAP+312                                               06158000
CVTMCHPR EQU   CVTMAP+308                                               06159000
CVTTZ    EQU   CVTMAP+304                                               06160000
CVTJEPS  EQU   CVTMAP+300                                               06161000
CVTJESCT EQU   CVTMAP+296                                               06162000
CVTMODE  EQU   CVTMAP+292                                               06163000
CVTPTRV  EQU   CVTMAP+288                                               06164000
CVTREAL  EQU   CVTMAP+284                                               06165000
CVTRSV39 EQU   CVTMAP+280                                               06166000
CVTRSV38 EQU   CVTMAP+276                                               06167000
CVTDMSRA EQU   CVTDMSR+1                                                06168000
CVTRV634 EQU   CVTDMSRF                                                 06169000
CVTRV633 EQU   CVTDMSRF                                                 06170000
CVTRV632 EQU   CVTDMSRF                                                 06171000
CVTRV631 EQU   CVTDMSRF                                                 06172000
CVTRV630 EQU   CVTDMSRF                                                 06173000
CVTRV629 EQU   CVTDMSRF                                                 06174000
CVTUDUMP EQU   CVTDMSRF                                                 06175000
CVTSDUMP EQU   CVTDMSRF                                                 06176000
CVTQMSGA EQU   CVTQMSG+1                                                06177000
CVTRSV36 EQU   CVTQMSG                                                  06178000
CVTAMFF  EQU   CVTMAP+264                                               06179000
CVTPURGA EQU   CVTPURG+1                                                06180000
CVTRSV35 EQU   CVTPURG                                                  06181000
CVTCBSP  EQU   CVTMAP+256                                               06182000
CVTATERA EQU   CVTATER+1                                                06183000
CVTSYST  EQU   CVTATER                                                  06184000
CVTVOLT2 EQU   CVTTAT                                                   06185000
CVTVOLI2 EQU   CVTVOLF2                                                 06186000
CVTAQAVB EQU   CVTAQAVT+1                                               06187000
CVTRSV34 EQU   CVTTCMFG                                                 06188000
CVTRSV33 EQU   CVTTCMFG                                                 06189000
CVTRSV32 EQU   CVTTCMFG                                                 06190000
CVTRSV31 EQU   CVTTCMFG                                                 06191000
CVTRSV30 EQU   CVTTCMFG                                                 06192000
CVTRSV29 EQU   CVTTCMFG                                                 06193000
CVTRSV28 EQU   CVTTCMFG                                                 06194000
CVTTCRDY EQU   CVTTCMFG                                                 06195000
CVTGTFA  EQU   CVTGTF+1                                                 06196000
CVTRSV27 EQU   CVTGTFST                                                 06197000
CVTRNIO  EQU   CVTGTFST                                                 06198000
CVTUSR   EQU   CVTGTFST                                                 06199000
CVTRV318 EQU   CVTFORM                                                  06200000
CVTRV317 EQU   CVTTMODE                                                 06201000
CVTRV316 EQU   CVTSTATE                                                 06202000
CVTRV315 EQU   CVTGTFS                                                  06203000
CVTGTFAV EQU   CVTGTFS                                                  06204000
CVT0SCR1 EQU   CVTMAP+232                                               06205000
CVTRV515 EQU   CVTMAP+228                                               06206000
CVTRMS   EQU   CVTMAP+224                                               06207000
CVTPATCH EQU   CVTMAP+220                                               06208000
CVTTSCE  EQU   CVTMAP+216                                               06209000
CVTLNKSC EQU   CVTMAP+214                                               06210000
CVTQABST EQU   CVTMAP+212                                               06211000
CVTMDLDS EQU   CVTMAP+208                                               06212000
CVTUSER  EQU   CVTMAP+204                                               06213000
CVTABEND EQU   CVTMAP+200                                               06214000
CVTSMCA  EQU   CVTMAP+196                                               06215000
CVTRSV18 EQU   CVTMAP+192                                               06216000
CVTQLPAQ EQU   CVTMAP+188                                               06217000
CVTQCDSR EQU   CVTMAP+184                                               06218000
CVTRSV17 EQU   CVTOPTB                                                  06219000
CVTRSV16 EQU   CVTOPTB                                                  06220000
CVTFP    EQU   CVTOPTB                                                  06221000
CVTAPTHR EQU   CVTOPTB                                                  06222000
CVTNLOG  EQU   CVTOPTB                                                  06223000
CVTTOD   EQU   CVTOPTB                                                  06224000
CVTCTIMS EQU   CVTOPTB                                                  06225000
CVTPROT  EQU   CVTOPTB                                                  06226000
CVTXPFP  EQU   CVTOPTA                                                  06227000
CVTASCII EQU   CVTOPTA                                                  06228000
CVTRSV13 EQU   CVTOPTA                                                  06229000
CVTRSV12 EQU   CVTOPTA                                                  06230000
CVTNIP   EQU   CVTOPTA                                                  06231000
CVTDDR   EQU   CVTOPTA                                                  06232000
CVTAPR   EQU   CVTOPTA                                                  06233000
CVTCCH   EQU   CVTOPTA                                                  06234000
CVTSNCTR EQU   CVTMAP+180                                               06235000
CVTQMWR  EQU   CVTMAP+176                                               06236000
CVTQOCR  EQU   CVTMAP+172                                               06237000
CVT1EF00 EQU   CVTMAP+168                                               06238000
CVTMZ00  EQU   CVTMAP+164                                               06239000
CVTSV76Q EQU   CVTSV76C                                                 06240000
CVTRSV11 EQU   CVTMAP+156                                               06241000
CVT0PT01 EQU   CVTMAP+152                                               06242000
CVTMSER  EQU   CVTMAP+148                                               06243000
CVTRV516 EQU   CVTIERLC                                                 06244000
CVTILCH  EQU   CVTMAP+140                                               06245000
CVT0DS   EQU   CVTMAP+136                                               06246000
CVTFBOSV EQU   CVTMAP+132                                               06247000
CVTNUCB  EQU   CVTMAP+128                                               06248000
CVTIXAVL EQU   CVTMAP+124                                               06249000
CVTSV76M EQU   CVTIOQET                                                 06250000
CVTDCBA  EQU   CVTMAP+117                                               06251000
CVTMVS2  EQU   CVTDCB                                                   06252000
CVT6DAT  EQU   CVTDCB                                                   06253000
CVT4MPS  EQU   CVTDCB                                                   06254000
CVTRSV09 EQU   CVTDCB                                                   06255000
CVT4MS1  EQU   CVTDCB                                                   06256000
CVT2SPS  EQU   CVTDCB                                                   06257000
CVT1SSS  EQU   CVTDCB                                                   06258000
CVTRSV08 EQU   CVTDCB                                                   06259000
CVTSTB   EQU   CVTMAP+112                                               06260000
CVTQTD00 EQU   CVTMAP+108                                               06261000
CVTQTE00 EQU   CVTMAP+104                                               06262000
CVTCUCB  EQU   CVTMAP+100                                               06263000
CVTSJQ   EQU   CVTMAP+96                                                06264000
CVTPBLDL EQU   CVTMAP+92                                                06265000
CVTTPC   EQU   CVTMAP+88                                                06266000
CVTSVDCB EQU   CVTMAP+84                                                06267000
CVTBRET  EQU   CVTMAP+82                                                06268000
CVTEXIT  EQU   CVTMAP+80                                                06269000
CVT0FN00 EQU   CVTMAP+76                                                06270000
CVTDARA  EQU   CVTDAR+1                                                 06271000
CVTRSV07 EQU   CVTFLGS1                                                 06272000
CVTRSV06 EQU   CVTFLGS1                                                 06273000
CVTRSV05 EQU   CVTFLGS1                                                 06274000
CVTRSV04 EQU   CVTFLGS1                                                 06275000
CVTRSV03 EQU   CVTFLGS1                                                 06276000
CVTRSV02 EQU   CVTFLGS1                                                 06277000
CVTRSV01 EQU   CVTFLGS1                                                 06278000
CVTDMPLK EQU   CVTFLGS1                                                 06279000
CVTXITP  EQU   CVTMAP+68                                                06280000
CVTZDTAB EQU   CVTMAP+64                                                06281000
CVTMSLT  EQU   CVTMAP+60                                                06282000
CVTDATE  EQU   CVTMAP+56                                                06283000
CVTBTERM EQU   CVTMAP+52                                                06284000
CVTSYSAD EQU   CVTMAP+48                                                06285000
CVTXTLER EQU   CVTMAP+44                                                06286000
CVTILK2  EQU   CVTMAP+40                                                06287000
CVTILK1  EQU   CVTMAP+36                                                06288000
CVTPRLTV EQU   CVTMAP+32                                                06289000
CVTPCNVT EQU   CVTMAP+28                                                06290000
CVT0VL00 EQU   CVTMAP+24                                                06291000
CVTXAPG  EQU   CVTMAP+20                                                06292000
CVTBUF   EQU   CVTMAP+16                                                06293000
CVTJOB   EQU   CVTMAP+12                                                06294000
CVTLINK  EQU   CVTMAP+8                                                 06295000
CVT0EF00 EQU   CVTMAP+4                                                 06296000
CVTTCBP  EQU   CVTMAP                                                   06297000
CVT      EQU   CVTMAP                                                   06298000
UPTPREFL EQU   UPT+23                                                   06299000
UPTPREFX EQU   UPT+16                                                   06300000
@NM00081 EQU   UPT+15                                                   06301000
UPTLDEL  EQU   UPT+14                                                   06302000
UPTCDEL  EQU   UPT+13                                                   06303000
UPTWTP   EQU   UPTSWS                                                   06304000
UPTMODE  EQU   UPTSWS                                                   06305000
UPTALD   EQU   UPTSWS                                                   06306000
UPTPAUS  EQU   UPTSWS                                                   06307000
UPTNCOM  EQU   UPTSWS                                                   06308000
UPTMID   EQU   UPTSWS                                                   06309000
UPTRCVR  EQU   UPTSWS                                                   06310000
UPTUSER  EQU   UPT+2                                                    06311000
@NM00080 EQU   UPT                                                      06312000
BFROFF   EQU   GETBUFF+2                                                06313000
@NM00079 EQU   GTPB                                                     06314000
PTPBFLN  EQU   PTPB+8                                                   06315000
PTPBOPUT EQU   PTPB+4                                                   06316000
@NM00078 EQU   PTPB                                                     06317000
IOPLECB  EQU   IOPL+8                                                   06318000
IOPLECT  EQU   IOPL+4                                                   06319000
IOPLUPT  EQU   IOPL                                                     06320000
INSTEXT  EQU   @NM00077+8                                               06321000
INSOFF   EQU   @NM00077+6                                               06322000
INSLEN   EQU   @NM00077+4                                               06323000
INSKEY   EQU   @NM00077                                                 06324000
EXTRAOFF EQU   EXTRATXT+2                                               06325000
PPLECB   EQU   PPL+8                                                    06326000
PPLECT   EQU   PPL+4                                                    06327000
PPLUPT   EQU   PPL                                                      06328000
@NM00071 EQU   @NM00069+7                                               06329000
LICNTF   EQU   @NM00070                                                 06330000
LICNTL   EQU   @NM00069+4                                               06331000
@NM00068 EQU   @NM00066+4                                               06332000
@NM00067 EQU   @NM00066                                                 06333000
@NM00065 EQU   @NM00063+7                                               06334000
CHCNTF   EQU   @NM00064                                                 06335000
@NM00062 EQU   @NM00060+4                                               06336000
@NM00061 EQU   @NM00060                                                 06337000
ALLKYWD2 EQU   @NM00059                                                 06338000
@NM00058 EQU   @NM00056+7                                               06339000
STR4F    EQU   @NM00057                                                 06340000
STR4L    EQU   @NM00056+4                                               06341000
STR4     EQU   @NM00056                                                 06342000
@NM00055 EQU   @NM00053+7                                               06343000
STR3F    EQU   @NM00054                                                 06344000
STR3L    EQU   @NM00053+4                                               06345000
STR3     EQU   @NM00053                                                 06346000
@NM00052 EQU   @NM00050+7                                               06347000
PRCNTF   EQU   @NM00051                                                 06348000
PRCNTL   EQU   @NM00050+4                                               06349000
PRCNT    EQU   @NM00050                                                 06350000
@NM00049 EQU   @NM00047+4                                               06351000
@NM00048 EQU   @NM00047                                                 06352000
@NM00045 EQU   @NM00043+7                                               06353000
@NM00042 EQU   @NM00040+7                                               06354000
@NM00039 EQU   @NM00037+7                                               06355000
@NM00036 EQU   @NM00034+7                                               06356000
@NM00033 EQU   @NM00031+7                                               06357000
LNSTARTF EQU   @NM00032                                                 06358000
@NM00030 EQU   @NM00028+4                                               06359000
@NM00029 EQU   @NM00028                                                 06360000
CXDATEXT EQU   IKJEBECX                                                 06361000
CAPDEXT  EQU   IKJEBECA+3984                                            06362000
CADSNRC2 EQU   IKJEBECA+3928                                            06363000
CADSNOF2 EQU   IKJEBECA+3926                                            06364000
CADSNLN2 EQU   IKJEBECA+3924                                            06365000
CADSNPT2 EQU   IKJEBECA+3920                                            06366000
@NM00022 EQU   IKJEBECA+3900                                            06367000
CASVAREA EQU   IKJEBECA+3176                                            06368000
CAFIBFR  EQU   IKJEBECA+1188                                            06369000
CAAEDCB  EQU   IKJEBECA+1096                                            06370000
CALDROP  EQU   IKJEBECA+1064                                            06371000
CAATNWKA EQU   IKJEBECA+956                                             06372000
CAATNBUF EQU   IKJEBECA+952                                             06373000
CAMODETX EQU   CAMODEMG+12                                              06374000
CAMODEOF EQU   CAMODEMG+10                                              06375000
CAMODELN EQU   CAMODEMG+8                                               06376000
CAMODEPT EQU   CAMODEMG+4                                               06377000
CAMODEIS EQU   CAMODEMG                                                 06378000
CASRWKA  EQU   IKJEBECA+728                                             06379000
CAMSWKA  EQU   IKJEBECA+628                                             06380000
@NM00021 EQU   CAMAWKA+30                                               06381000
@NM00020 EQU   MACFLAG2                                                 06382000
MATABLE1 EQU   MACFLAG2                                                 06383000
@NM00019 EQU   MACFLAGS                                                 06384000
MAENDPRC EQU   MACFLAGS                                                 06385000
MAABBREV EQU   MACFLAGS                                                 06386000
MAECTMOD EQU   MACFLAGS                                                 06387000
@NM00018 EQU   CAMAWKA                                                  06388000
CASTAEPL EQU   IKJEBECA+576                                             06389000
CASTAXPL EQU   IKJEBECA+556                                             06390000
CASRPLST EQU   CATMPLST+12                                              06391000
CAPTECB  EQU   CATMPLST+8                                               06392000
CAPTECT  EQU   CATMPLST+4                                               06393000
CASYNSCN EQU   CASYNSW                                                  06394000
CASYNML  EQU   CASYNSW                                                  06395000
CASYNSF  EQU   CASYNSW                                                  06396000
CASYNRFM EQU   CASYNSW                                                  06397000
CASYNIS  EQU   CASYNSW                                                  06398000
@NM00017 EQU   CASYNSW                                                  06399000
CASYNLN  EQU   CASYNSW                                                  06400000
@NM00016 EQU   CASYNSW                                                  06401000
CASYNRCL EQU   CASYNOPT+2                                               06402000
CASYNCD1 EQU   CASYNOPT                                                 06403000
CASYNTEM EQU   CASYNWA+12                                               06404000
CASYNMS2 EQU   CASYNWA+8                                                06405000
CASYNMS1 EQU   CASYNWA+4                                                06406000
CASYNWAP EQU   CASYNWA+1                                                06407000
CASYNECD EQU   CASYNWA                                                  06408000
CASYNPTO EQU   CASYNLST+8                                               06409000
CASYNPWA EQU   CASYNLST+4                                               06410000
@NM00015 EQU   IKJEBECA+484                                             06411000
CARECNO  EQU   IKJEBECA+480                                             06412000
CAINSAVE EQU   IKJEBECA+476                                             06413000
@NM00014 EQU   IKJEBECA+472                                             06414000
CAIMLINC EQU   IKJEBECA+468                                             06415000
CAIMLLNO EQU   IKJEBECA+464                                             06416000
CAINCRE  EQU   IKJEBECA+460                                             06417000
CANXTREC EQU   IKJEBECA+452                                             06418000
CASTNUM  EQU   IKJEBECA+448                                             06419000
CASAPSWD EQU   IKJEBECA+440                                             06420000
CASADDN  EQU   IKJEBECA+432                                             06421000
CASAMEMB EQU   IKJEBECA+424                                             06422000
CASADSN  EQU   IKJEBECA+380                                             06423000
CASADSNL EQU   IKJEBECA+378                                             06424000
CASADQTY EQU   CASAFLG2                                                 06425000
CASANCTG EQU   CASAFLG2                                                 06426000
CASAALOC EQU   CASAFLAG                                                 06427000
CASAUNCG EQU   CASAFLAG                                                 06428000
CASADSOR EQU   CASAFLAG                                                 06429000
CASAMEM  EQU   CASAFLAG                                                 06430000
CASADISP EQU   CASAFLAG                                                 06431000
CASAINCP EQU   CASAFLAG                                                 06432000
CASAFNCP EQU   CASAFLAG                                                 06433000
CASAVEDS EQU   CASAFLAG                                                 06434000
CADSNREC EQU   IKJEBECA+320                                             06435000
CADSNOFF EQU   IKJEBECA+318                                             06436000
CADSNLEN EQU   IKJEBECA+316                                             06437000
CADSNPTR EQU   IKJEBECA+312                                             06438000
CAEDTSIZ EQU   IKJEBECA+308                                             06439000
CAEDPSWD EQU   IKJEBECA+300                                             06440000
CAEDDDN  EQU   IKJEBECA+292                                             06441000
CAEDMEMB EQU   IKJEBECA+284                                             06442000
CAEDDSN  EQU   IKJEBECA+240                                             06443000
CAEDDSNL EQU   IKJEBECA+238                                             06444000
CAEDPRTC EQU   CAEDFLG2                                                 06445000
CAEDALOC EQU   CAEDFLAG                                                 06446000
CAEDUNCG EQU   CAEDFLAG                                                 06447000
CAEDDSOR EQU   CAEDFLAG                                                 06448000
CAEDMEM  EQU   CAEDFLAG                                                 06449000
CAEDDISP EQU   CAEDFLAG                                                 06450000
CAEDINCP EQU   CAEDFLAG                                                 06451000
CAEDFNCP EQU   CAEDFLAG                                                 06452000
CAEDITDS EQU   CAEDFLAG                                                 06453000
CABLK2   EQU   IKJEBECA+234                                             06454000
@NM00013 EQU   IKJEBECA+226                                             06455000
CAPDEND  EQU   CAPD+82                                                  06456000
CADATEXT EQU   CAPD+74                                                  06457000
CAEXTNAM EQU   CAPD+66                                                  06458000
CAPRNAME EQU   CAPD+58                                                  06459000
CACHKOPT EQU   CAPD+56                                                  06460000
CAULRLMX EQU   CAPD+54                                                  06461000
CAULRLDF EQU   CAPD+52                                                  06462000
CAVLRLMX EQU   CAPD+50                                                  06463000
CAVLRLDF EQU   CAPD+48                                                  06464000
CAFLRLMX EQU   CAPD+46                                                  06465000
CAFLRLDF EQU   CAPD+44                                                  06466000
CARECFMD EQU   CAPD+43                                                  06467000
@NM00012 EQU   CADSATR2                                                 06468000
CAINLIST EQU   CADSATR2                                                 06469000
CARUNDS  EQU   CADSATR2                                                 06470000
CAOBJGEN EQU   CADSATR2                                                 06471000
CADSNDEF EQU   CADSATR2                                                 06472000
CALINTAB EQU   CADSATR2                                                 06473000
@NM00011 EQU   CADSATTR                                                 06474000
CALRECLX EQU   CADSATTR                                                 06475000
CALNNUM  EQU   CADSATTR                                                 06476000
CADSCONT EQU   CADSATTR                                                 06477000
CACAPSDF EQU   CADSATTR                                                 06478000
CACAPSRQ EQU   CADSATTR                                                 06479000
CASCAN   EQU   CADSATTR                                                 06480000
CARUN    EQU   CADSATTR                                                 06481000
CATABS   EQU   CAPD+20                                                  06482000
CABLKS   EQU   CAPD+16                                                  06483000
CADSQUAL EQU   CAPD+8                                                   06484000
CADSTYPE EQU   CAPD                                                     06485000
@NM00010 EQU   CACFLAG+8                                                06486000
CAPLIRTM EQU   CACFLAG+7                                                06487000
CAPLILFM EQU   CACFLAG+6                                                06488000
@NM00009 EQU   CACFLAG6                                                 06489000
CACHAR60 EQU   CACFLAG6                                                 06490000
CACHAR48 EQU   CACFLAG6                                                 06491000
CAFREE   EQU   CACFLAG6                                                 06492000
@NM00008 EQU   CACFLAG5                                                 06493000
CAEDLNDP EQU   CACFLAG5                                                 06494000
CADSUSED EQU   CACFLAG4                                                 06495000
CARECURS EQU   CACFLAG4                                                 06496000
CASCRC20 EQU   CACFLAG4                                                 06497000
CAABEND  EQU   CACFLAG4                                                 06498000
CAPTGTBF EQU   CACFLAG4                                                 06499000
CAFINDIS EQU   CACFLAG4                                                 06500000
@NM00007 EQU   CAIMFLG                                                  06501000
CAIMINPT EQU   CAIMFLG                                                  06502000
CAIMSFPT EQU   CAIMFLG                                                  06503000
CAIMCIN  EQU   CAIMFLG                                                  06504000
CAIMIR   EQU   CAIMFLG                                                  06505000
CAIMSC   EQU   CAIMFLG                                                  06506000
CAIMINS  EQU   CAIMFLG                                                  06507000
CAIMPT   EQU   CAIMFLG                                                  06508000
@NM00006 EQU   CACFLAG2                                                 06509000
CAX37ABN EQU   CACFLAG2                                                 06510000
CASEQCOL EQU   CACFLAG2                                                 06511000
CAMODMSG EQU   CACFLAG2                                                 06512000
CASCANON EQU   CACFLAG2                                                 06513000
CADSMODS EQU   CACFLAG2                                                 06514000
CACAPS   EQU   CACFLAG1                                                 06515000
CAENDSC  EQU   CACFLAG1                                                 06516000
CAINITSC EQU   CACFLAG1                                                 06517000
CAPROMPT EQU   CACFLAG1                                                 06518000
CALNTOVF EQU   CACFLAG1                                                 06519000
@NM00005 EQU   CAATTN                                                   06520000
@NM00004 EQU   IKJEBECA+118                                             06521000
CAMAXBLK EQU   IKJEBECA+116                                             06522000
CAESDSPL EQU   IKJEBECA+112                                             06523000
@NM00003 EQU   IKJEBECA+88                                              06524000
CAPTICLN EQU   IKJEBECA+84                                              06525000
CAPTICDS EQU   IKJEBECA+80                                              06526000
CAPTNBFR EQU   IKJEBECA+76                                              06527000
CACORELN EQU   IKJEBECA+68                                              06528000
CAPTCORE EQU   IKJEBECA+64                                              06529000
CAUTILNO EQU   IKJEBECA+60                                              06530000
CAPTPDCB EQU   IKJEBECA+56                                              06531000
@NM00002 EQU   IKJEBECA+50                                              06532000
CAFREEDL EQU   CAPRSPDL                                                 06533000
CAPTRTRY EQU   IKJEBECA+32                                              06534000
CAPTMSGM EQU   IKJEBECA+28                                              06535000
CAPTUT   EQU   IKJEBECA+24                                              06536000
CAPTMS   EQU   IKJEBECA+20                                              06537000
CAPTLE   EQU   IKJEBECA+16                                              06538000
CAPTAT   EQU   IKJEBECA+12                                              06539000
CAPTAE   EQU   IKJEBECA+8                                               06540000
@NM00001 EQU   IKJEBECA+4                                               06541000
CAPTTMP  EQU   IKJEBECA                                                 06542000
*                                      END UNREFERENCED COMPONENTS      06543000
@RT00110 EQU   CHGEXIT2                                                 06544000
@RT00122 EQU   CHKOPRND                                                 06545000
@RT00143 EQU   PUTERR                                                   06546000
@RT00151 EQU   GETERR                                                   06547000
@RT00167 EQU   PARSERR                                                  06548000
@RT00198 EQU   PARSERR                                                  06549000
@RF00202 EQU   ASTSPEC                                                  06550000
@RT00210 EQU   CNTONLY                                                  06551000
@RT00225 EQU   NOSPAN                                                   06552000
@RF00240 EQU   READKEY                                                  06553000
@RT00256 EQU   NOCOUNT                                                  06554000
@RT00271 EQU   READCUR                                                  06555000
@RT00289 EQU   PARSERR                                                  06556000
@RT00309 EQU   CHGEXIT2                                                 06557000
@RT00311 EQU   PROCESS                                                  06558000
@RT00335 EQU   CHGEXIT2                                                 06559000
@RT00356 EQU   NOLNMSG                                                  06560000
@RT00367 EQU   CNTCHK                                                   06561000
@RT00384 EQU   CNTPRCS                                                  06562000
@RT00387 EQU   CNTPRCS                                                  06563000
@RT00390 EQU   CNTPRCS                                                  06564000
@RT00408 EQU   PARSERR                                                  06565000
@RT00436 EQU   CHNGEXIT                                                 06566000
@RT00442 EQU   NOCORMSG                                                 06567000
@RT00444 EQU   CHNGEXIT                                                 06568000
@RT00450 EQU   NOCORMSG                                                 06569000
@RT00452 EQU   FLUSH                                                    06570000
@RT00454 EQU   CHGEXIT2                                                 06571000
@RT00550 EQU   NOPUTLN                                                  06572000
@RT00558 EQU   NOPUTLN                                                  06573000
@RT00574 EQU   NOTEXT                                                   06574000
@RT00600 EQU   SUCCGET                                                  06575000
@RT00602 EQU   NOCORMS1                                                 06576000
@RT00604 EQU   NOTEXT                                                   06577000
@RT00638 EQU   OUT                                                      06578000
@RT00651 EQU   FOUND                                                    06579000
@RT00669 EQU   CHGEXIT3                                                 06580000
@RF00696 EQU   CHKATTN                                                  06581000
@RT00703 EQU   CHKATTN                                                  06582000
@RT00705 EQU   NOCORMS1                                                 06583000
@RT00716 EQU   LPOUT                                                    06584000
@RF00672 EQU   CHKATTN                                                  06585000
@RT00728 EQU   BREAKLN                                                  06586000
@RT00748 EQU   CHGEXIT3                                                 06587000
@RT00762 EQU   CHGEXIT3                                                 06588000
@RT00774 EQU   CHGEXIT3                                                 06589000
@RT00789 EQU   CHGEXIT3                                                 06590000
@RT00793 EQU   NOTEXT                                                   06591000
@RT00805 EQU   CHGEXIT3                                                 06592000
@RT00842 EQU   RPPLEXIT                                                 06593000
@RT00913 EQU   NOTEXT1                                                  06594000
@RF00923 EQU   NOTEXT1                                                  06595000
@RF00934 EQU   @RC00894                                                 06596000
@RT00941 EQU   NOTXT                                                    06597000
@RT00999 EQU   OUT1                                                     06598000
@RT01012 EQU   FOUND1                                                   06599000
@RT01031 EQU   CHGEXIT4                                                 06600000
@RT01060 EQU   FLUSH1                                                   06601000
@RF01060 EQU   CHKATTN1                                                 06602000
@RT01064 EQU   CHKATTN1                                                 06603000
@RT01088 EQU   LPOUT1                                                   06604000
@RF01036 EQU   CHKATTN1                                                 06605000
@RT01114 EQU   BREAKLN1                                                 06606000
@RT01134 EQU   CHGEXIT4                                                 06607000
@RT01148 EQU   CHGEXIT4                                                 06608000
@RT01160 EQU   CHGEXIT4                                                 06609000
@RT01176 EQU   NOTEXT1                                                  06610000
@RF01178 EQU   NOTEXT1                                                  06611000
@RT01259 EQU   VERATTN                                                  06612000
@RF01246 EQU   @RC01244                                                 06613000
@RF01309 EQU   @EL00011                                                 06614000
@RC01311 EQU   @EL00011                                                 06615000
@PB00011 EQU   @EL00001                                                 06616000
@PB00010 EQU   @PB00011                                                 06617000
@PB00009 EQU   @PB00010                                                 06618000
@PB00008 EQU   @PB00009                                                 06619000
@PB00007 EQU   @PB00008                                                 06620000
@PB00006 EQU   @PB00007                                                 06621000
@PB00005 EQU   @PB00006                                                 06622000
@PB00004 EQU   @PB00005                                                 06623000
@PB00003 EQU   @PB00004                                                 06624000
@PB00002 EQU   @PB00003                                                 06625000
@ENDDATA EQU   *                                                        06626000
         END   IKJEBECH,(C'PLS1723',0701,77241)                         06627000
