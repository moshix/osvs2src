         TITLE 'IKJEBEIP - EDIT COMMAND INPUT SUBCOMMAND               *00001000
                        '                                               00002000
IKJEBEIP CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEBEIP  78.121'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @06,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@06                                    0001 00014000
*           COMMREG = PARMREG1;      /* GET ADDR OF IKJEBECA         */ 00015000
*                                                                  0110 00016000
         LR    COMMREG,PARMREG1                                    0110 00017000
*           RESPECIFY (GPR13P,GPR15P) RSTD;                        0111 00018000
*           GPR15P = CANXTSVA;       /* SAVE AREA FOR THIS MODULE    */ 00019000
         L     GPR15P,CANXTSVA(,COMMREG)                           0112 00020000
*           EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS     */ 00021000
         LA    @14,4                                               0113 00022000
         ALR   @14,GPR15P                                          0113 00023000
         ST    GPR13P,CASAVPTR(,@14)                               0113 00024000
*                                    /* SAVEAREA BKWD PTR            */ 00025000
*           EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER   */ 00026000
         LA    @14,8                                               0114 00027000
         ALR   @14,GPR13P                                          0114 00028000
         ST    GPR15P,CASAVPTR(,@14)                               0114 00029000
*                                    /* FWD PTR                      */ 00030000
*           GPR13P = GPR15P;         /* NEW SAVEAREA ADDR            */ 00031000
         LR    GPR13P,GPR15P                                       0115 00032000
*           CANXTSVA = GPR13P + 72;   /* UPDATE NEX-SAVE-AREA PTR    */ 00033000
         LA    @14,72                                              0116 00034000
         ALR   @14,GPR13P                                          0116 00035000
         ST    @14,CANXTSVA(,COMMREG)                              0116 00036000
*           RESPECIFY (GPR13P,GPR15P) UNRSTD;                      0117 00037000
*                                                                  0117 00038000
*           DATAREG = ADDR(CASCWKA);   /* SET BASE REG FOR WORK AREA */ 00039000
         LA    DATAREG,CASCWKA(,COMMREG)                           0118 00040000
*           GEN( USING @DATD,DATAREG);   /* SET ADDRESSABILITY TO    */ 00041000
          USING @DATD,DATAREG                                           00042000
*                                    /* CASCWKA                      */ 00043000
*        CCODE = 0;                    /* INIT RETURN CODE            * 00044000
         SLR   @12,@12                                             0120 00045000
         STH   @12,CCODE                                           0120 00046000
*        FLAGS = FLAGS && FLAGS;       /* TURN OFF SWITCHES           * 00047000
         XC    FLAGS(1),FLAGS                                      0121 00048000
*        UTDCBPTR = CAPTCDCB;          /* SET UTIL DCB PTR            * 00049000
         MVC   UTDCBPTR(4),CAPTCDCB(COMMREG)                       0122 00050000
*        CAPROMPT = '0'B;              /* INIT AUTO PROMPT SWITCH OFF * 00051000
         NI    CAPROMPT(COMMREG),B'11011111'                       0123 00052000
*        CAIMIR = '1'B;                /* INDICATE I OPERATION        * 00053000
         OI    CAIMIR(COMMREG),B'00010000'                         0124 00054000
*        NUMBXXX = 0;                  /* INITIALIZE AREA TO ZERO     * 00055000
*                                                                  0125 00056000
         STH   @12,NUMBXXX                                         0125 00057000
*        /* WAS ENTRY FROM INSERT                                     * 00058000
*        IF CAIMINS = '1'B                                         0126 00059000
*          THEN                        /* YES, ENTRY FROM INSERT      * 00060000
         TM    CAIMINS(COMMREG),B'01000000'                        0126 00061000
         BNO   @RF00126                                            0126 00062000
*            DO;                                                   0127 00063000
*              SAVEINCR = CAIMLINC;    /* SAVE INCREMENT              * 00064000
         MVC   SAVEINCR(4,COMMREG),CAIMLINC(COMMREG)               0128 00065000
*              CAIMLINC = 1;           /* SET NEW TEMP INCREMENT      * 00066000
         LA    @12,1                                               0129 00067000
         ST    @12,CAIMLINC(,COMMREG)                              0129 00068000
*              READKEY = CACURNUM;     /* SET FIRST RECORD VALUE      * 00069000
         L     @08,CACURNUM(,COMMREG)                              0130 00070000
         ST    @08,READKEY                                         0130 00071000
*              FIRSTLN = READKEY + CAIMLINC; /* SET FIRST INPUTYA10479  00072000
*                                         RECORD KEY TO        YA01479  00073000
*                                         CURRENT LINE+1       YA01479* 00074000
         ALR   @08,@12                                             0131 00075000
         ST    @08,FIRSTLN(,COMMREG)                               0131 00076000
*              GOTO RDNEXT;            /* CONTINUE             YA01479* 00077000
         B     RDNEXT                                              0132 00078000
*            END;                                                  0133 00079000
*          ELSE;                       /* NO, ENTRY NOT FROM INSERT   * 00080000
*                                                                  0134 00081000
@RF00126 DS    0H                                                  0135 00082000
*        /* WAS ENTRY FROM INPUT SUBCOMMAND                           * 00083000
*        IF CAIMSC = '1'B                                          0135 00084000
*          THEN                        /* NO ENTRY NOT FROM SUBCMD    * 00085000
         TM    CAIMSC(COMMREG),B'00100000'                         0135 00086000
         BNO   @RF00135                                            0135 00087000
*          /* DETERMINE WHERE INPUT LINES ARE TO BE WRITTEN           * 00088000
*            DO;                                                   0136 00089000
*                                                                  0136 00090000
*              /* CHECK FOR PREVIOUS LINE NUMBER                      * 00091000
*              IF CAIMINPT = '0'B      /*                      YA00040* 00092000
*              THEN                    /* WAS INP ENTERED BEFORE   0137 00093000
*                                         NO-INPUT IS FROM CARRIAGE     00094000
*                                         RETURN OR INPUT DATA SET IS   00095000
*                                         EMPTY                       * 00096000
         TM    CAIMINPT(COMMREG),B'00000010'                       0137 00097000
         BNZ   @RF00137                                            0137 00098000
*              /* INPUT LINES TO BE WRITTEN AT END OF DATA SET        * 00099000
*              DO;                                                 0138 00100000
*BTMPRMT: ;                            /* LINES TO BE WRITTEN AT END    00101000
*                                         OF DATA SET                 * 00102000
BTMPRMT  DS    0H                                                  0140 00103000
*BOTTOM: ;                             /* PREPARE TO 'READ BOTTOM' ON   00104000
*                                         THE UTILITY DATA SET        * 00105000
BOTTOM   DS    0H                                                  0141 00106000
*              UTOPTCD = '85'X;        /* INDICATE READ BOTTOM        * 00107000
         MVI   UTOPTCD,X'85'                                       0141 00108000
*              CALL IORTN;             /* CALL UTILITY DS ACCESS   0142 00109000
*                                         METHOD                      * 00110000
*                                                                  0142 00111000
         BAL   @14,IORTN                                           0142 00112000
*              /* CHECK RETURN CODE FROM UTILITY ACCESS METHOD        * 00113000
*              IF RCODEREG = 0                                     0143 00114000
*                THEN                  /* YES, RET CODE 0             * 00115000
         LTR   RCODEREG,RCODEREG                                   0143 00116000
         BNZ   @RF00143                                            0143 00117000
*                  FIRSTLN = INKEY + CAINCRE; /* IF READ BOTTOM IS 0144 00118000
*                                                SUCCESSFUL SET FIRST   00119000
*                                                LINE NUMBER TO KEY OF  00120000
*                                                LAST RECORD + DEFAULT  00121000
*                                                INCR                 * 00122000
         L     @12,INKEY(,UTPREG1)                                 0144 00123000
         AL    @12,CAINCRE(,COMMREG)                               0144 00124000
         ST    @12,FIRSTLN(,COMMREG)                               0144 00125000
*                ELSE                  /* RET CODE NOT 0              * 00126000
*                /* DATA SET IS EMPTY, INPUT LINES BASED ON INCREMENT * 00127000
*                  DO;                 /* FALLING THROUGH HERE MEANS    00128000
*                                         THE DATA SET IS EMPTY       * 00129000
         B     @RC00143                                            0145 00130000
@RF00143 DS    0H                                                  0146 00131000
*                    FIRSTLN = CAINCRE; /* SET FIRST LINE NUM =    0146 00132000
*                                          INCREMENT                  * 00133000
         MVC   FIRSTLN(4,COMMREG),CAINCRE(COMMREG)                 0146 00134000
*                  END;                                            0147 00135000
*              EODSW = '1'B;           /* INDICATE NO FOURTHER READ     00136000
*                                         NEXTS                       * 00137000
@RC00143 OI    EODSW,B'00100000'                                   0148 00138000
*              NEXTREC = MAXREC;       /* SET MAXIMUM AS NEXT RECORD    00139000
*                                         NUMBER                      * 00140000
         MVC   NEXTREC(4,COMMREG),MAXREC                           0149 00141000
*              GOTO AUTOLNPT;          /* GO TO SUBRTN                * 00142000
         B     AUTOLNPT                                            0150 00143000
*            END;                                                  0151 00144000
*          ELSE                        /* CONTINUE                    * 00145000
*          /* INPUT LINES BASED ON LAST INPUT MODE SESSION            * 00146000
*            DO;                       /* ENTER HERE IF INPUT MODE WAS  00147000
*                                         ENTERED BEFORE              * 00148000
@RF00137 DS    0H                                                  0153 00149000
*              READKEY = CAIMLLNO;     /* KEY VALUE FOR READ   YA01479  00150000
*                                         NEXT OPERATION (TO   YA01479  00151000
*                                         CHECK IF NEW LINE    YA01479  00152000
*                                         WILL FIT IN D.S.)    YA01479* 00153000
         L     @12,CAIMLLNO(,COMMREG)                              0153 00154000
         ST    @12,READKEY                                         0153 00155000
*              FIRSTLN = READKEY + CAIMLINC; /* APPLY INCR. TO YA01479  00156000
*                                         DETERMINE KEY VALUE  YA01479  00157000
*                                         FOR FIRST INPUT      YA01479  00158000
*                                         LINE                 YA01479* 00159000
         AL    @12,CAIMLINC(,COMMREG)                              0154 00160000
         ST    @12,FIRSTLN(,COMMREG)                               0154 00161000
*              GOTO RDNEXT;            /* DETERMINE IF RECORDS YA01479  00162000
*                                         EXIST IN DATA SET    YA01479  00163000
*                                         BEYOND LAST LINE     YA01479  00164000
*                                         ENTERED IN INPUT MODEYA01479* 00165000
         B     RDNEXT                                              0155 00166000
*            END;                                                  0156 00167000
*        END;                                                      0157 00168000
*                                                                  0157 00169000
*        /* FALLING THROUGH HERE MEANS THAT ENTRY WAS TO PROCESS AN   * 00170000
*        /* INPUT SUBCOMMAND CHECK IF SUBCOMMAND HAS ANY OPERANDS     * 00171000
*        IF CAOPERND = '1'B                                        0158 00172000
*          THEN                        /* YES, OPERANDS PRESENT       * 00173000
@RF00135 TM    CAOPERND(COMMREG),B'10000000'                       0158 00174000
         BNO   @RF00158                                            0158 00175000
*          /* SUBCOMMAND OPERANDS TO BE SCANNED BY PARSE SERVICE RTN  * 00176000
*            DO;                       /* YES OPERANDS ARE PRESENT,     00177000
*                                         CALL IKJPARSE OT SCAN AND     00178000
*                                         VALIDATE THEM               * 00179000
*              PPLPTR = ADDR (CATMPLST); /* SET PARSE PARM LIST PTR   * 00180000
         LA    PPLPTR,CATMPLST(,COMMREG)                           0160 00181000
*              PPLANS = ADDR (PDLPTR ); /* SET ANSWER PTR             * 00182000
         LA    @12,PDLPTR(,COMMREG)                                0161 00183000
         ST    @12,PPLANS(,PPLPTR)                                 0161 00184000
*              PPLPCL = ADDR (IKJEBIP1); /* SET PCL PTR               * 00185000
         L     @12,@CV01140                                        0162 00186000
         ST    @12,PPLPCL(,PPLPTR)                                 0162 00187000
*              PPLCBUF = CAPTIBFR;     /* POINT TO COMMAND BUFFER     * 00188000
         MVC   PPLCBUF(4,PPLPTR),CAPTIBFR(COMMREG)                 0163 00189000
*              PPLUWA = 0;             /* INDICATE NO SAVE AREA       * 00190000
         SLR   @12,@12                                             0164 00191000
         ST    @12,PPLUWA(,PPLPTR)                                 0164 00192000
*              DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/               0165 00193000
*                RESPECIFY GPR01P RSTD;                            0166 00194000
*                GPR01P = ADDR(PPL);                               0167 00195000
         LR    GPR01P,PPLPTR                                       0167 00196000
*                IF CVTPARS = 0                                    0168 00197000
*                  THEN                                            0168 00198000
         L     @08,CVTPTR                                          0168 00199000
         C     @12,CVTPARS(,@08)                                   0168 00200000
         BNE   @RF00168                                            0168 00201000
*                    GEN(LINK EP=IKJPARS);                         0169 00202000
         LINK EP=IKJPARS                                                00203000
*                  ELSE                                            0170 00204000
*                    CALL CVTPARS;                                 0170 00205000
         B     @RC00168                                            0170 00206000
@RF00168 L     @12,CVTPTR                                          0170 00207000
         L     @15,CVTPARS(,@12)                                   0170 00208000
         BALR  @14,@15                                             0170 00209000
*                RESPECIFY GPR01P UNRSTD;                          0171 00210000
@RC00168 DS    0H                                                  0172 00211000
*              END; /* INVOKE IKJPARS                              0172 00212000
*                      SERVICE ROUTINE     */                      0172 00213000
*              RESPECIFY (RCODEREG) RSTD;                          0173 00214000
*              PRSSW = '1'B;           /* INDICATE PARSE WAS CALLED   * 00215000
*                                                                  0174 00216000
         OI    PRSSW,B'10000000'                                   0174 00217000
*              /* CHECK FOR SUCCESSFUL COMPLETION OF PARSE            * 00218000
*              IF RCODEREG = 0                                     0175 00219000
*                THEN;                 /* RETURN NORMAL - CONTINUE    * 00220000
         LTR   RCODEREG,RCODEREG                                   0175 00221000
         BZ    @RT00175                                            0175 00222000
*                ELSE                  /* RETURN NOT 0                * 00223000
*                  DO;                                             0177 00224000
*                    CODESAVE = RCODEREG; /* SAVE RETURN CODE         * 00225000
*                                                                  0178 00226000
         LR    CODESAVE,RCODEREG                                   0178 00227000
*                    RESPECIFY (RCODEREG) UNRSTD;                  0179 00228000
*                    /* RETURN CODE 16                                * 00229000
*                    IF CODESAVE = 16                              0180 00230000
*                      THEN            /* YES CODE WAS 16             * 00231000
         CH    CODESAVE,@CH00228                                   0180 00232000
         BNE   @RF00180                                            0180 00233000
*                        DO;                                       0181 00234000
*                        /* NOTIFY USER THAT GETMAIN FAILED           * 00235000
*                                                                  0182 00236000
*                          RELMSG1 = 270;  /* LOAD MSG NUMBER         * 00237000
         MVC   RELMSG1(2),@CH01250                                 0182 00238000
*                          RELMSG2 = 0;    /* LOAD RELATIVE LEV-2 NUM * 00239000
*                                                                  0183 00240000
         SLR   @12,@12                                             0183 00241000
         STH   @12,RELMSG2                                         0183 00242000
*                          /* POINT TO INSERT                         * 00243000
*                          LEV1INS = ADDR (INSM25);                0184 00244000
         LA    LEV1INS,INSM25                                      0184 00245000
*                          LEV2INS = 0;    /* NO LEV-2 INSERTION      * 00246000
         SLR   LEV2INS,LEV2INS                                     0185 00247000
*                          CALL MSGRTN; /* PUT OUT MESSAGE            * 00248000
         BAL   @14,MSGRTN                                          0186 00249000
*                          CCODE=8;    /* INDICATE FLUSH NEEDED       * 00250000
*                                                                  0187 00251000
         MVC   CCODE(2),@CH00049                                   0187 00252000
*                        END;                                      0188 00253000
*                      ELSE            /* CODE NOT 16                 * 00254000
*                        DO;           /* CHECK NEXT RETURN CODE      * 00255000
*                                                                  0189 00256000
         B     @RC00180                                            0189 00257000
@RF00180 DS    0H                                                  0190 00258000
*                          /* CHECK FOR RETURN CODE 12                * 00259000
*                          IF CODESAVE = 12                        0190 00260000
*                            THEN      /* YES, CODE IS 12             * 00261000
         CH    CODESAVE,@CH00137                                   0190 00262000
         BNE   @RF00190                                            0190 00263000
*                              DO;     /* PREPARE TO CALL MSGRTN      * 00264000
*                                                                  0191 00265000
*                                /* MOVE MODEL INTO WORK AREA         * 00266000
*                                /* -PARSE                            * 00267000
*                                INSREC = M313INS1;                0192 00268000
*                                                                  0192 00269000
         MVC   INSREC(16),M313INS1                                 0192 00270000
*                                /* GET RETURN CODE                   * 00271000
*                                SAVERC = CODESAVE;                0193 00272000
         ST    CODESAVE,SAVERC                                     0193 00273000
*                                CALL SRVERRTN; /* GO PUT OUT MESSAGE * 00274000
         BAL   @14,SRVERRTN                                        0194 00275000
*                              END;                                0195 00276000
*                            ELSE      /* NO, CODE IS 4 OR 8          * 00277000
*                              /* DETERMINE IF UNSTACK/TCLEARQ REQ.   * 00278000
*                              IF CODESAVE=4                       0196 00279000
*                                THEN  /* INDICATE FLUSH NEEDED       * 00280000
         B     @RC00190                                            0196 00281000
@RF00190 CH    CODESAVE,@CH00389                                   0196 00282000
         BNE   @RF00196                                            0196 00283000
*                                  CCODE=8;  /* SET RETURN CODE       * 00284000
         MVC   CCODE(2),@CH00049                                   0197 00285000
*                                ELSE; /* RETURN CODE IS 8            * 00286000
@RF00196 DS    0H                                                  0199 00287000
*                        END;                                      0199 00288000
*                    GOTO EXIT;        /* GO RETURN TO COMMAND MODE   * 00289000
         B     EXIT                                                0200 00290000
*                  END;                                            0201 00291000
*            END;                                                  0202 00292000
*          ELSE                        /* CONTINUE                    * 00293000
*            GOTO BTMPRMT;             /* IF ALL OPERANDS OMITTED, 0203 00294000
*                                         INPUT WILL BEGIN AT THE  0203 00295000
*                                         BOTTOM OF THE DATA SET      * 00296000
*                                                                  0203 00297000
*        /* CHECK FOR 'R' SPECIFIED                                   * 00298000
*        IF PRSIRFLG = 2                                           0204 00299000
*          THEN                        /* YES, R SPECIFIED            * 00300000
@RC00158 L     @12,PDLPTR(,COMMREG)                                0204 00301000
         CLC   PRSIRFLG(2,@12),@CH00072                            0204 00302000
         BNE   @RF00204                                            0204 00303000
*            CAIMIR = '0'B;            /* SET FLAG IN COMM AREA       * 00304000
         NI    CAIMIR(COMMREG),B'11101111'                         0205 00305000
*          ELSE;                       /* NO, I SPEC OR DEFAULT       * 00306000
*                                                                  0206 00307000
@RF00204 DS    0H                                                  0207 00308000
*        /* CHECK FOR LINE NUMBER OPERAND IN SUBCOMMAND               * 00309000
*        IF PRSNMOM = '1'B                                         0207 00310000
*          THEN                        /* PROCESS LINE NUMBER         * 00311000
         L     @12,PDLPTR(,COMMREG)                                0207 00312000
         TM    PRSNMOM(@12),B'10000000'                            0207 00313000
         BNO   @RF00207                                            0207 00314000
*          /* LINE NUMBER OPERAND VALIDATION                          * 00315000
*            DO;                       /* DO IF OPERAND PRESENT       * 00316000
*                                                                  0208 00317000
*              /* CHECK FOR * AS LINE NUMBER                          * 00318000
*              IF NUMBER (1) = '*'                                 0209 00319000
*                THEN                  /* '*' SPECIFIED,TREAT AS IF     00320000
*                                         CURRENT LINE NUMBER WERE 0209 00321000
*                                         SPECIFIED                   * 00322000
         L     @12,PRSNMPTR(,@12)                                  0209 00323000
         CLI   NUMBER(@12),C'*'                                    0209 00324000
         BNE   @RF00209                                            0209 00325000
*                  DO;                                             0210 00326000
*                    READKEY = CACURNUM; /* OBTAIN CURRENT LINE PTR     00327000
*                                           FROM COMMAREA AND STORE AS  00328000
*                                           KEY FOR NEXT READ         * 00329000
         MVC   READKEY(4),CACURNUM(COMMREG)                        0211 00330000
*                    GOTO CHKPRMT;     /* GO CONTINUE PROCESSING      * 00331000
         B     CHKPRMT                                             0212 00332000
*                  END;                                            0213 00333000
*                ELSE;                 /* IF A NUMBER WAS SPECIFIED,    00334000
*                                         CONTINUE                    * 00335000
*                                                                  0214 00336000
@RF00209 DS    0H                                                  0215 00337000
*              /* CHECK TO SEE IF DATA SET IS LINE NUMBERED           * 00338000
*              IF CANONUM = '1'B                                   0215 00339000
*                THEN                  /* DATA SET IS NOT NUMBERED,     00340000
*                                         PUT OUT MESSAGE             * 00341000
         TM    CANONUM(COMMREG),B'00000001'                        0215 00342000
         BNO   @RF00215                                            0215 00343000
*                  DO;                                             0216 00344000
*                    RELMSG1 = 1288;   /* LOAD MESSAGE NUMBER         * 00345000
         MVC   RELMSG1(2),@CH01254                                 0217 00346000
*                    RELMSG2 = 0;      /* INDICATE NO LEVEL 2 MSG     * 00347000
         SLR   @12,@12                                             0218 00348000
         STH   @12,RELMSG2                                         0218 00349000
*                    LEV1INS = 0;      /* POINT TO LEV-1 INSERTION    * 00350000
         SLR   LEV1INS,LEV1INS                                     0219 00351000
*                    LEV2INS = 0;      /* INDICATE NO LEV-2 INSERT    * 00352000
         SLR   LEV2INS,LEV2INS                                     0220 00353000
*                    CALL MSGRTN;      /* PUT OUT MESSAGE             * 00354000
         BAL   @14,MSGRTN                                          0221 00355000
*                    CCODE=8;          /*INDICATE FLUSH NEEDED        * 00356000
         MVC   CCODE(2),@CH00049                                   0222 00357000
*                    GOTO EXIT;        /* TERMINATE SUBCOMMAND        * 00358000
         B     EXIT                                                0223 00359000
*                  END;                                            0224 00360000
*                ELSE;                 /* OS IS NUMBERED,CONTINUE     * 00361000
@RF00215 DS    0H                                                  0226 00362000
*        END;                                                      0226 00363000
*          ELSE                        /* THIS PATH IS FOR INPUT WITH   00364000
*                                         NO LINENUM BUT WITH PROMPT/   00365000
*                                         NOPROMPT KEYWORD. I OR R IS   00366000
*                                         IGNORED                     * 00367000
*            DO;                                                   0227 00368000
*                                                                  0227 00369000
         B     @RC00207                                            0227 00370000
@RF00207 DS    0H                                                  0228 00371000
*              /* CHECK FOR PROMPT OPTION OMITTED                     * 00372000
*              IF PRSPFLG = 0                                      0228 00373000
*                THEN                  /* YES, OPTION OMITTED         * 00374000
         L     @12,PDLPTR(,COMMREG)                                0228 00375000
         LH    @12,PRSPFLG(,@12)                                   0228 00376000
         LTR   @12,@12                                             0228 00377000
         BZ    @RT00228                                            0228 00378000
*                  GOTO BTMPRMT;       /* GO SET DEFAULTS             * 00379000
*                ELSE;                 /* NO, PROMPT/NOPROMPT SPEC    * 00380000
*                                                                  0230 00381000
*              /* CHECK FOR PROMPT OPTION                             * 00382000
*              IF PRSPFLG = 2                                      0231 00383000
*                THEN                  /* NOPROMPT SPECIFIED          * 00384000
         CH    @12,@CH00072                                        0231 00385000
         BNE   @RF00231                                            0231 00386000
*                  CAIMPT = '0'B;      /* SET FLAG TO INDICATE     0232 00387000
*                                         NOPROMPT                    * 00388000
         NI    CAIMPT(COMMREG),B'01111111'                         0232 00389000
*                ELSE                  /* PROMPT SPECIFIED            * 00390000
*                  CAIMPT = '1'B;      /* INDICATE PROMPT             * 00391000
         B     @RC00231                                            0233 00392000
@RF00231 OI    CAIMPT(COMMREG),B'10000000'                         0233 00393000
*              GOTO BOTTOM;            /* GO PROCESS AS NO OPERANDS     00394000
*                                         AND FIRST TIME IN INPUT     * 00395000
         B     BOTTOM                                              0234 00396000
*            END;                                                  0235 00397000
*        WREG1 = PRSNMLEN;             /* GET LENGTH FOR CONVERT      * 00398000
@RC00207 L     @12,PDLPTR(,COMMREG)                                0236 00399000
         LH    WREG1,PRSNMLEN(,@12)                                0236 00400000
*        WREG2 = PRSNMPTR;             /* GET ADDR OF STRING TO BE 0237 00401000
*                                         CONVERTED                   * 00402000
         L     WREG2,PRSNMPTR(,@12)                                0237 00403000
*        CALL CONVERT;                 /* GO CONVERT THE LINE NUMBER    00404000
*                                         TO BINARY                   * 00405000
         BAL   @14,CONVERT                                         0238 00406000
*        READKEY = WREG1;              /* STORE CONVERTED VALUE       * 00407000
*                                                                  0239 00408000
         ST    WREG1,READKEY                                       0239 00409000
*CHKPRMT:  /* CHECK TO SEE IF INCREMENT WAS SPECIFIED          A50478 * 00410000
*        IF PRSINOM = '1'B                                         0240 00411000
*          THEN                        /* IF INCREMENT WAS PRESENT    * 00412000
CHKPRMT  L     @12,PDLPTR(,COMMREG)                                0240 00413000
         TM    PRSINOM(@12),B'10000000'                            0240 00414000
         BNO   @RF00240                                            0240 00415000
*            DO;                       /* OCNVERT TO BINARY AND STORE   00416000
*                                         AS LAST INCR USED IN INPUT  * 00417000
*              WREG1 = PRSINLEN;       /* GET LENGTH OF INCEMENT      * 00418000
         LH    WREG1,PRSINLEN(,@12)                                0242 00419000
*              WREG2 = PRSINPTR;       /* POINT TO INCREMENT          * 00420000
         L     WREG2,PRSINPTR(,@12)                                0243 00421000
*              CALL CONVERT;           /* GO CONVERT THE INCR TO BIN  * 00422000
         BAL   @14,CONVERT                                         0244 00423000
*              CAIMCIN = '1'B;         /* INDIC INCREMENT SPECIFIED   * 00424000
         OI    CAIMCIN(COMMREG),B'00001000'                        0245 00425000
*              CAIMLINC = WREG1;       /* SAVE CONVERTED VALUE        * 00426000
         ST    WREG1,CAIMLINC(,COMMREG)                            0246 00427000
*            END;                                                  0247 00428000
*          ELSE;                       /* NO INCR SPECIFIED, CONTINUE   00429000
*                                         PROCESSING                  * 00430000
@RF00240 DS    0H                                                  0249 00431000
*          /* CHECK IF PROMPT/NOPROMPT KEYWORD OMITTED         A50478 * 00432000
*        IF PRSPFLG = 0                                            0249 00433000
*          THEN;                       /* YES, OPERAND OMITTED        * 00434000
         L     @12,PDLPTR(,COMMREG)                                0249 00435000
         ICM   @08,3,PRSPFLG(@12)                                  0249 00436000
         BZ    @RT00249                                            0249 00437000
*          ELSE                        /* NO OPERAND SPECIFIED        * 00438000
*            DO;                                                   0251 00439000
*                                                                  0251 00440000
*              /* CHECK FOR PROMPT OPTION SPECIFIED                   * 00441000
*              IF PRSPFLG = 2                                      0252 00442000
*                THEN                  /* NOPROMPT WAS SPECIFIED      * 00443000
         L     @12,PDLPTR(,COMMREG)                                0252 00444000
         CLC   PRSPFLG(2,@12),@CH00072                             0252 00445000
         BNE   @RF00252                                            0252 00446000
*                  CAIMPT = '0'B;      /* SET FLAG TO INDICATE     0253 00447000
*                                         NOPROMPT                    * 00448000
         NI    CAIMPT(COMMREG),B'01111111'                         0253 00449000
*                ELSE                  /* PROMPT WAS SPECIFIED        * 00450000
*                  CAIMPT = '1'B;      /* (DEFAULT) INDICATE PROMPT   * 00451000
         B     @RC00252                                            0254 00452000
@RF00252 OI    CAIMPT(COMMREG),B'10000000'                         0254 00453000
*            END;                                                  0255 00454000
@RC00252 DS    0H                                                  0256 00455000
*        /* DETERMINE KEY VALUE FOR FIRST INPUT LINE           YA01479* 00456000
*        IF CAIMIR = '0'B                                          0256 00457000
*          THEN                        /* R-FORM OF INPUT MODE YA01479  00458000
*                                         WAS SPECIFIED        YA01479* 00459000
@RT00249 TM    CAIMIR(COMMREG),B'00010000'                         0256 00460000
         BNZ   @RF00256                                            0256 00461000
*            FIRSTLN = READKEY;        /*USE KEY VALUE ENTERED YA01479  00462000
*                                         (OR DEFAULTED) FOR   YA01479  00463000
*                                         FIRST INPUT LINE KEY YA01479* 00464000
         MVC   FIRSTLN(4,COMMREG),READKEY                          0257 00465000
*          ELSE                        /* I-FORM OF INPUT MODE YA01479* 00466000
*            DO;                       /* READ 'READKEY' LINE  YA01479  00467000
*                                         TO DETERMINE CORRECT YA01479  00468000
*                                         ACTION               YA01479* 00469000
         B     @RC00256                                            0258 00470000
@RF00256 DS    0H                                                  0259 00471000
*              UTOPTCD = '00'X;        /* INITIALIZE PARAMETERSYA01479  00472000
*                                         FOR CALLING IKJEBEUT YA01479  00473000
*                                         INDICATE READ CURRENTYA01479* 00474000
         MVI   UTOPTCD,X'00'                                       0259 00475000
*              UTKEYPTR = ADDR(READKEY); /* ADDR. OF READ KEY  YA01479* 00476000
         LA    @12,READKEY                                         0260 00477000
         ST    @12,UTKEYPTR                                        0260 00478000
*              LBIT2 = '1'B;           /* SET END-OF-PARM MARK YA01479* 00479000
         OI    LBIT2,B'10000000'                                   0261 00480000
*              CALL IORTN;             /* CALL IO SUBRTN TO    YA01479  00481000
*                                         DO READ OPERATION    YA01479* 00482000
         BAL   @14,IORTN                                           0262 00483000
*              IF RCODEREG = 0                                     0263 00484000
*                THEN                  /* 'READKEY' LINE FOUND YA01479* 00485000
         LTR   RCODEREG,RCODEREG                                   0263 00486000
         BNZ   @RF00263                                            0263 00487000
*                  FIRSTLN= READKEY + CAIMLINC; /* APPLY INCR. YA01479  00488000
*                                         TO KEY OBTAIN        YA01479  00489000
*                                         FIRST INPUT LINE KEY YA01479* 00490000
         L     @12,READKEY                                         0264 00491000
         AL    @12,CAIMLINC(,COMMREG)                              0264 00492000
         ST    @12,FIRSTLN(,COMMREG)                               0264 00493000
*                ELSE                  /* LINE NOT IN DATA SET YA01479* 00494000
*                  FIRSTLN= READKEY;   /* USE 'READKEY' AS KEY YA01479  00495000
*                                         FOR FIRST INPUT LINE YA01479* 00496000
         B     @RC00263                                            0265 00497000
@RF00263 MVC   FIRSTLN(4,COMMREG),READKEY                          0265 00498000
*            END;                      /* END DETERMINATION OF YA01479  00499000
*                                         FIRST INPUT KEY VALUEYA01479* 00500000
@RC00263 DS    0H                                                  0267 00501000
*RDNEXT: /* A 'READ-NEXT' OPERATION IS REQUIRED ON UTILITY DATA SET   * 00502000
*        UTOPTCD = '02'X;              /* PREPARE FOR A READ NEXT TO    00503000
*                                         DETERMINE THE UPPER LIMITS    00504000
*                                         OF INPUT MODE               * 00505000
@RC00256 DS    0H                                                  0267 00506000
RDNEXT   MVI   UTOPTCD,X'02'                                       0267 00507000
*        UTKEYPTR = ADDR (READKEY);    /* SET KEY TO BE USED BY READ  * 00508000
         LA    @12,READKEY                                         0268 00509000
         ST    @12,UTKEYPTR                                        0268 00510000
*        LBIT2 = '1'B;                 /* SET END-OF-PARM INDICATION  * 00511000
         OI    LBIT2,B'10000000'                                   0269 00512000
*        CALL IORTN;                   /* GO ISSUE READ NEXT          * 00513000
*                                                                  0270 00514000
         BAL   @14,IORTN                                           0270 00515000
*        /* CHECK RETURN CODES FROM IKJEBEUT                          * 00516000
*        IF RCODEREG = 0                                           0271 00517000
*          THEN                        /* IF RETURN CODE IS 0, SAVE   * 00518000
         LTR   RCODEREG,RCODEREG                                   0271 00519000
         BNZ   @RF00271                                            0271 00520000
*            NEXTREC = INKEY;          /* LINE NUMBER(KEY) AS NEXT 0272 00521000
*                                         RECORD                      * 00522000
         MVC   NEXTREC(4,COMMREG),INKEY(UTPREG1)                   0272 00523000
*          ELSE;                       /* RETURN CODE IS 4 - END-OF     00524000
*                                         DATA SET WAS REACHED        * 00525000
@RF00271 DS    0H                                                  0274 00526000
*AUTOLNPT:                             /* AT THIS POINT, THE FIRST    * 00527000
*                                      /* LINE NUMBER TO BE ISSUED IN * 00528000
*                                      /* INPUT MODE HAS BEEN ESTAB-  * 00529000
*                                      /* LISHED AND IS STORED IN     * 00530000
*                                      /* 'FIRSTLN'.  THE LIMIT VALUE * 00531000
*                                      /* FOR 1-FORM OR THE NEXT      * 00532000
*                                      /* RECORD NUMBER FOR THE       * 00533000
*                                      /* R-FORM (WITHOUT AN INCRE-   * 00534000
*                                      /* MENT) HAS BEEN STORED IN    * 00535000
*                                      /* 'NEXTREC'.  IF AN INCREMENT * 00536000
*                                      /* WAS SPECIFIED, IT HAS BEEN  * 00537000
*                                      /* 'CAIMLINC'.  CHECK TO SEE   * 00538000
*                                      /* IF A NEW RECORD WILL FIT IN * 00539000
*                                      /* IN DATA SET.  CHECK FOR     * 00540000
*                                      /* 'PROMPT' OPTION.            * 00541000
*        WREG2 = ADDR (PTLPBLK);       /* PUT THE 'INPUT' MESSAGE TO    00542000
*                                         THE TERMINAL POINT TO PARM    00543000
*                                         LIST                        * 00544000
AUTOLNPT LA    WREG2,PTLPBLK                                       0274 00545000
*        PARMREG1 = ADDR (CATMPLST);   /* POINT TO SRVC RTN PARM LIST * 00546000
         LA    PARMREG1,CATMPLST(,COMMREG)                         0275 00547000
*        PTLPBLK = PTLINE;             /* MOVE IN PUTLINE L-FORM      * 00548000
*                                                                  0276 00549000
         MVC   PTLPBLK(20),PTLINE                                  0276 00550000
*        /* PUT INPUT MESSAGE TO TERMINAL                             * 00551000
*        GEN REFS(WREG2);                                          0277 00552000
*                                                                  0277 00553000
         PUTLINE PARM=(WREG2),OUTPUT=(INPMSG,TERM,SINGLE,DATA),        X00554000
               TERMPUT=(EDIT),MF=(E,(1))                                00555000
*        /* CHECK PROMPT SWITCH                                       * 00556000
*        IF CAIMPT = '1'B                                          0278 00557000
*          THEN                        /* YES, PROMPT SPECIFIED OR 0278 00558000
*                                         DEFAULTED                   * 00559000
         TM    CAIMPT(COMMREG),B'10000000'                         0278 00560000
         BNO   @RF00278                                            0278 00561000
*          /* DETERMINE IF AUTOMATIC LINE PROMPTING IS TO BE USED     * 00562000
*          DO;                                                     0279 00563000
*                                                                  0279 00564000
*        /* CHECK FOR SYNTAX CHECKING IN EFFECT                       * 00565000
*        IF CASCANSW = '1'B                                        0280 00566000
*          THEN                        /* YES CHECKING IN EFFECT      * 00567000
         TM    CASCANSW(COMMREG),B'00010000'                       0280 00568000
         BO    @RT00280                                            0280 00569000
*            GOTO INDSFPT;             /* GO SET UP PROMPTING         * 00570000
*          ELSE;                       /* NO, CHECKING NOT ACTIVE     * 00571000
*                                                                  0282 00572000
*        /* CHECK FOR PRESENCE OF LINE NUMBERS                        * 00573000
*        IF CANONUM = '0'B                                         0283 00574000
*          THEN                        /* YES DATA SET IS LINE     0283 00575000
*                                         NUMBERED                    * 00576000
*                                                                  0283 00577000
         TM    CANONUM(COMMREG),B'00000001'                        0283 00578000
         BNZ   @RF00283                                            0283 00579000
*            /* IF INPUT IS FOR A LINE NUMBERED DATA SET AND IS       * 00580000
*            /* R-FORM WITH NO INCREMENT, THEN PROMPTING IS DONE BY   * 00581000
*            /* INPUT DIRECTLY                                        * 00582000
*            IF CAIMIR = '0'B & CAIMCIN = '0'B & CAIMPT = '1'B     0284 00583000
*              THEN                    /* SELF PROMPTING TO BE DONE   * 00584000
         TM    CAIMPT(COMMREG),B'10000000'                         0284 00585000
         BNO   @RF00284                                            0284 00586000
         TM    CAIMIR(COMMREG),B'00011000'                         0284 00587000
         BNZ   @RF00284                                            0284 00588000
*                DO;                                               0285 00589000
*INDSFPT:    /* SELF-PROMPTING IS TO BE USED                          * 00590000
*                  CAIMSFPT = '1'B;    /* SET SELF-PROMPTING SWITCH     00591000
*                                         FOR NEXT PHASE              * 00592000
INDSFPT  OI    CAIMSFPT(COMMREG),B'00000100'                       0286 00593000
*                END;                                              0287 00594000
*              ELSE                    /* AUTOMATIC PROMPT MAY BE USED* 00595000
*                DO;                                               0288 00596000
         B     @RC00284                                            0288 00597000
@RF00284 DS    0H                                                  0289 00598000
*                  WREG1 = ADDR (FIRSTLN); /* POINT TO FIRST LINE  0289 00599000
*                                             NUMBER FOLLOWED BY BLANK* 00600000
         LA    WREG1,FIRSTLN(,COMMREG)                             0289 00601000
*                  WREG2 = ADDR (CAIMLINC); /* POINT TO INCREMENT     * 00602000
*                                                                  0290 00603000
         LA    WREG2,CAIMLINC(,COMMREG)                            0290 00604000
*                  /* ISSUE AUTOMATIC PROMPT BY LINE NUMBER           * 00605000
*                  GEN(STAUTOLN S=(WREG1),I=(WREG2))               0291 00606000
*                       REFS(WREG1,WREG2);                         0291 00607000
         STAUTOLN S=(WREG1),I=(WREG2)                                   00608000
*                  CAPROMPT = '1'B;    /* INDICATE AUTO PROMPT STARTED* 00609000
         OI    CAPROMPT(COMMREG),B'00100000'                       0292 00610000
*                END;                                              0293 00611000
*          ELSE                        /* DATA SET IS NOT NUMBERED    * 00612000
*            DO;                       /* START AUTO PROMPT           * 00613000
         B     @RC00283                                            0294 00614000
@RF00283 DS    0H                                                  0295 00615000
*            GEN (STAUTOCP);           /* ISSUE AUTOMATIC CHARACTER     00616000
*                                         PROMPT                      * 00617000
         STAUTOCP                                                       00618000
*            CAPROMPT = '1'B;          /* INDICATE AUTO PROMPT STARTED* 00619000
         OI    CAPROMPT(COMMREG),B'00100000'                       0296 00620000
*            END;                                                  0297 00621000
*        END;                                                      0298 00622000
*                                                                  0298 00623000
@RC00283 DS    0H                                                  0299 00624000
*        /* CHECK WHETHER OR NOT PARSE WAS CALLED                     * 00625000
*        IF PRSSW = '1'B                                           0299 00626000
*          THEN                        /* YES PARSE WAS CALLED        * 00627000
@RF00278 TM    PRSSW,B'10000000'                                   0299 00628000
         BNO   @RF00299                                            0299 00629000
*            DO;                                                   0300 00630000
*              WREG2 = ADDR(PDLPTR);   /* POINT TO PARSE PDL ANS PLACE* 00631000
         LA    WREG2,PDLPTR(,COMMREG)                              0301 00632000
*              CAFREEDL = '1'B;        /* INDICATE NO PDL TO FREE     * 00633000
         OI    CAFREEDL(COMMREG),B'10000000'                       0302 00634000
*              GEN (IKJRLSA (WREG2))   /* FREE PARSE CORE             * 00635000
*                   REFS(WREG2);                                   0303 00636000
         IKJRLSA (WREG2)                                                00637000
*            END;                                                  0304 00638000
*          ELSE;                       /* NO PARSE WAS NOT CALLED     * 00639000
*                                                                  0305 00640000
@RF00299 DS    0H                                                  0306 00641000
*        /* CALL SUBROUTINE IKJEBEIM TO CONTINUE INPUT MODE           * 00642000
*        CALL CONTRTN;                 /*  GO CONTINUE INPUT          * 00643000
         BAL   @14,CONTRTN                                         0306 00644000
*EXIT:   /* RETURN TO EDIT MAIN CONTROLLER                            * 00645000
*                                                                  0307 00646000
*        /* CHECK WHETHER OR NOT PARSE WAS CALLED                     * 00647000
*        IF PRSSW = '1'B                                           0307 00648000
*          THEN                        /* YES PARSE WAS CALLED        * 00649000
EXIT     TM    PRSSW,B'10000000'                                   0307 00650000
         BNO   @RF00307                                            0307 00651000
*            DO;                                                   0308 00652000
*              WREG2 = ADDR(PDLPTR);   /* POINT TO PARSE PDL ANS PLACE* 00653000
         LA    WREG2,PDLPTR(,COMMREG)                              0309 00654000
*              CAFREEDL = '1'B;        /* INDICATE NO PDL TO FREE     * 00655000
         OI    CAFREEDL(COMMREG),B'10000000'                       0310 00656000
*              GEN (IKJRLSA (WREG2))   /* FREE PARSE CORE             * 00657000
*                 REFS(WREG2);                                     0311 00658000
         IKJRLSA (WREG2)                                                00659000
*            END;                                                  0312 00660000
*          ELSE;                       /* NO PARSE WAS NOT CALLED     * 00661000
@RF00307 DS    0H                                                  0314 00662000
*        CAIMSC = '0'B;                /* TURN OFF SUBCMD SWITCH      * 00663000
*                                                                  0314 00664000
         NI    CAIMSC(COMMREG),B'11011111'                         0314 00665000
*        /* CHECK FOR ENTRY FROM INSERT SUBCOMMAND                    * 00666000
*        IF CAIMINS = '1'B                                         0315 00667000
*          THEN                        /* YES, ENTRY FROM INSERT      * 00668000
         TM    CAIMINS(COMMREG),B'01000000'                        0315 00669000
         BNO   @RF00315                                            0315 00670000
*            CAIMLINC = SAVEINCR;      /* RESTORE LAST USED INCRMNT   * 00671000
         MVC   CAIMLINC(4,COMMREG),SAVEINCR(COMMREG)               0316 00672000
*          ELSE;                       /* NO, ENTRY NOT FROM INSERT   * 00673000
@RF00315 DS    0H                                                  0318 00674000
*        CAIMFLG (2:6) = '0000000'B;   /* TURN OFF FLAGS       YA00040* 00675000
         NI    CAIMFLG(COMMREG),B'10000011'                        0318 00676000
*        CAMODMSG = '1'B;              /* INDICATE MODE MESSAGE IS TO   00677000
*                                         GO TO THE TERMINAL FROM MA  * 00678000
         OI    CAMODMSG(COMMREG),B'00010000'                       0319 00679000
*        RCODEREG = CCODE;             /* SET RETURN CODE             * 00680000
*                                                                  0320 00681000
         LH    RCODEREG,CCODE                                      0320 00682000
*        RESPECIFY (GPR12P,GPR13P) RSTD;                           0321 00683000
*        CANXTSVA = GPR13P;          /* UPDATE NEXT-SAVE-AREA PTR    */ 00684000
         ST    GPR13P,CANXTSVA(,COMMREG)                           0322 00685000
*        GPR12P = GPR13P;            /* SAVE PRESENT SAVE-AREA ADDR  */ 00686000
         LR    GPR12P,GPR13P                                       0323 00687000
*        GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD          */ 00688000
         L     @08,CASAVPTR+4(,GPR13P)                             0324 00689000
         LR    GPR13P,@08                                          0324 00690000
*                                    /* SAVE-AREA PTR                */ 00691000
*        RESPECIFY CASAVE BASED(GPR12P); /* CHANGE BASE FOR          */ 00692000
*                                    /* SAVE-AREA                    */ 00693000
*        CASAVE = CASAVE && CASAVE;  /* ZERO OUT THIS SAVE-AREA      */ 00694000
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0326 00695000
*        RESPECIFY CASAVE BASED;                                   0327 00696000
*        RETURN CODE(RCODEREG);      /* RETURN WITH RETURN CODE      */ 00697000
         L     @14,12(,@13)                                        0328 00698000
         LM    @00,@12,20(@13)                                     0328 00699000
         BR    @14                                                 0328 00700000
*        RESPECIFY (GPR12P,GPR13P) UNRSTD;                         0329 00701000
*                                            /* RETURN TO CMD MODE 0330 00702000
*    */                                                            0330 00703000
*                                                                  0330 00704000
*        /* THE FOLLOWING CODE GENERATES A CONTROL SECTION WHICH      * 00705000
*        /* CONTAINS THE VALIDITY CHECK EXIT FOR AN INCREMENT IF      * 00706000
*        /* SPECIFIED ON THE INPUT SUBCOMMAND. IT IS ENTERED          * 00707000
*        /* DIRECTLY FROM AND RETURNS TO IKJPARS                      * 00708000
*        GEN DATA DEFS(VALCHECK);                                  0330 00709000
*                                                                  0331 00710000
*        /* THE FOLLOWING STATEMENTS ARE THE MACROS FOR IKJPARS TO    * 00711000
*        /* USE IN SCANNING THE INPUT SUBCOMMAND. THERE ARE ALSO      * 00712000
*        /* MESSAGE INSERTIONS AND MACRO LIST FORMS.                  * 00713000
*        GEN DATA DEFS(IPPCE);                                     0331 00714000
*        /************************************************************* 00715000
*        /* THIS ROUTINE IS CALLED TO PUT OUT THE ERROR MESSAGE       * 00716000
*        /* WHICH DIAGNOSES THAT AN UNUSUAL RETURN CODE WAS RECEIVED  * 00717000
*        /* FROM A SYSTEM SERVICE ROUTINE.                            * 00718000
*        /*                                                           * 00719000
*        /* INPUT  - SAVERC CONTAINS THE RETURN CODE FROM THE SERVICE * 00720000
*        /* ROUTINE.                                                  * 00721000
*        /************************************************************* 00722000
*SRVERRTN:                                                         0332 00723000
*        PROC OPTIONS (NOSAVE,NOSAVEAREA);                         0332 00724000
*                                                                  0332 00725000
@EL00001 DS    0H                                                  0332 00726000
@EF00001 DS    0H                                                  0332 00727000
@ER00001 LM    @14,@12,12(@13)                                     0332 00728000
         BR    @14                                                 0332 00729000
SRVERRTN DS    0H                                                  0333 00730000
*        /* THE FOLLOWING REGISTERS ARE RESTRICTED FOR THE DURATION   * 00731000
*        /* OF INPUT                                                  * 00732000
*        RESPECIFY (PARMREG1, WREG1, WREG2, COMMREG, SAVEREG, DATAREG,  00733000
*            BASEREG,BASEREG2) RSTD;                               0333 00734000
*                                                                  0333 00735000
*        SRVPTR = RETREG;              /* SAVE RETURN POINT           * 00736000
         ST    RETREG,SRVPTR                                       0334 00737000
*        CVDREG = SAVERC;              /* GET RETURN CODE TO CONVERT  * 00738000
         L     CVDREG,SAVERC                                       0335 00739000
*        CALL CVDRTN;                  /* CONVERT RETURN CODE TO DEC  * 00740000
         BAL   @14,CVDRTN                                          0336 00741000
*        INSREC1 = M313INS4;           /* MOVE SECOND INSERTION MODEL   00742000
*                                         TO WORK AREA                * 00743000
         MVC   INSREC1(11),M313INS4                                0337 00744000
*        INSNUM1 (1:2) = NUMTEMP (7:8); /* MOVE RETURN CODE TO MODEL  * 00745000
         MVC   INSNUM1(2),NUMTEMP+6                                0338 00746000
*        INS2PTR = ADDR(INSREC1);  /* CHAIN UP 2ND INSERT    @ZM30991*/ 00747000
         LA    @12,INSREC1                                         0339 00748000
         ST    @12,INS2PTR                                         0339 00749000
*        RELMSG1 = 271;                 /* GET MESSAGE NUMBER         * 00750000
         MVC   RELMSG1(2),@CH01272                                 0340 00751000
*        RELMSG2 = 1;                  /* LOAD RELATIVE LEV-2 NUMBER  * 00752000
         MVC   RELMSG2(2),@CH00051                                 0341 00753000
*        LEV1INS = 0;                  /* INDICATE NO LEV-1 INSERTION * 00754000
         SLR   LEV1INS,LEV1INS                                     0342 00755000
*        LEV2INS = ADDR (INSREC);      /* POINT TO INSERTION FOR   0343 00756000
*                                         LEVEL-2 MESSAGE             * 00757000
         LA    LEV2INS,INSREC                                      0343 00758000
*        CALL MSGRTN;                  /* GO PUT OUT MESSAGE          * 00759000
         BAL   @14,MSGRTN                                          0344 00760000
*        CCODE=8;                      /* INDICATE FLUSH NEEDED       * 00761000
         MVC   CCODE(2),@CH00049                                   0345 00762000
*        RETREG = SRVPTR;              /* RESTORE RETURN POINT PTR    * 00763000
         L     RETREG,SRVPTR                                       0346 00764000
*        RETURN;                       /* RETURN FINISH INPUT         * 00765000
@EL00002 DS    0H                                                  0347 00766000
@EF00002 DS    0H                                                  0347 00767000
@ER00002 BR    @14                                                 0347 00768000
*        END SRVERRTN;                                             0348 00769000
*                                                                  0349 00770000
*                                                                  0349 00771000
*        /************************************************************* 00772000
*        /* THIS ROUTINE PERFORMS ALL I/O REQUESTS ON THE UTILITY     * 00773000
*        /* DATA SET. UPON ENTRY, ALL PARAMETERS IN UTPRMLST MUST     * 00774000
*        /* BE INITIALIZED BY THE CALLER FOR THE DESIRED OPERATION.   * 00775000
*        /* THIS ROUTINE ALSO CHECKS END-OF-DATA FROM A READ NEXT     * 00776000
*        /* (RC=4) AND INITIALIZES EODSW TO 1 WHEN IT OCCURS. THIS    * 00777000
*        /* CONDITION ALSO CAUSES 'NEXTREC' TO BE INITIALIZED TO      * 00778000
*        /* 99999999 FOR A NUMBERED DATA SET OR 2,147,483,648         * 00779000
*        /* (2**31-1) FOR A NON-LINENUMBERED DATA SET. IF AN I/O      * 00780000
*        /* ERROR IS ENCOUNTERED, 'CCODE' IS SET TO 12 AND THIS       * 00781000
*        /* ROUTINE GOES DIRECTLY TO 'EXIT'. RETURN CODES FOR         * 00782000
*        /* CALLER ARE: FOR OP CODES 00-20 THE RETURN CODE IS 0 OR    * 00783000
*        /* 4 FOR OP CODE 20 A RETURN CODE OF 12 IS ADDED THESE       * 00784000
*        /* RETURN CODES ARE AS DESCRIBED FOR IKJEBEUT REGISTER 1     * 00785000
*        /* WILL BE LEFT INTACT FOLLOWING A READ                      * 00786000
*        /************************************************************* 00787000
*IORTN:                                                            0349 00788000
*        PROC OPTIONS (NOSAVE, NOSAVEAREA);                        0349 00789000
*                                                                  0349 00790000
IORTN    DS    0H                                                  0350 00791000
*        /* THE FOLLOWING REGISTERS ARE RESTRICTED FOR THE DURATION   * 00792000
*        /* OF INPUT                                                  * 00793000
*        RESPECIFY (PARMREG1, WREG1, WREG2, COMMREG, SAVEREG, DATAREG,  00794000
*            BASEREG,BASEREG2) RSTD;                               0350 00795000
*        IORTNPTR = RETREG;            /* SAVE RETURN POINT PTR       * 00796000
         ST    RETREG,IORTNPTR                                     0351 00797000
*        CODESAVE = 0;                 /* INIT RETURN CODE            * 00798000
         SLR   CODESAVE,CODESAVE                                   0352 00799000
*        RESPECIFY (RCODEREG) RSTD;                                0353 00800000
*        /* CHECK FOR EOD ON PREVIOUS READ NEXT                       * 00801000
*        IF EODSW = '1'B                                           0354 00802000
*          THEN                        /* YES EOD HAS BEEN REACHED    * 00803000
         TM    EODSW,B'00100000'                                   0354 00804000
         BNO   @RF00354                                            0354 00805000
*            DO;                                                   0355 00806000
*                                                                  0355 00807000
*              /* IGNORE IF OPERATION WAS A WRITE                     * 00808000
*              IF UTOPTCD ^= '20'X                                 0356 00809000
*                THEN                  /* NO, OPERATION NOT WRITE     * 00810000
         CLI   UTOPTCD,X'20'                                       0356 00811000
         BE    @RF00356                                            0356 00812000
*                  DO;                                             0357 00813000
*                    RCODEREG = 0;       /* SET NORMAL RETURN CODE    * 00814000
         SLR   RCODEREG,RCODEREG                                   0358 00815000
*                    GOTO IORET;       /* RETURN TO CALLER            * 00816000
         B     IORET                                               0359 00817000
*                  END;                                            0360 00818000
*            END;                                                  0361 00819000
*          ELSE;                       /* NO PREVIOUS EOD - ISSUE I/O   00820000
*                                         REQUEST                     * 00821000
*                                                                  0362 00822000
@RF00354 DS    0H                                                  0363 00823000
*        /* PERFORM I/O OPERATION BY CALLING IKJEBEUT                 * 00824000
*        GEN REFS(COMMREG);                                        0363 00825000
*                                                                  0363 00826000
@RC00354 DS    0H                                                  0363 00827000
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPRMLST),       X00828000
               MF=(E,SRWORK)                                            00829000
*        /* CHECK RETURN CODE                                         * 00830000
*        IF RCODEREG = 0                                           0364 00831000
*          THEN                        /* OPERATION SUCCESSFUL        * 00832000
         LTR   RCODEREG,RCODEREG                                   0364 00833000
         BZ    @RT00364                                            0364 00834000
*            GOTO IORET;               /* RETURN TO CALLER            * 00835000
*          ELSE;                       /* OPERATION UNSUCCESSFUL      * 00836000
*        CODESAVE = RCODEREG;          /* SAVE RETURN CODE            * 00837000
*                                                                  0367 00838000
         LR    CODESAVE,RCODEREG                                   0367 00839000
*        /* CHECK FOR RETURN CODE OF 4                                * 00840000
*        IF CODESAVE = 4                                           0368 00841000
*          THEN                        /* R.C. = 4                    * 00842000
         CH    CODESAVE,@CH00389                                   0368 00843000
         BNE   @RF00368                                            0368 00844000
*          /* IKJEBEUT RETURN CODE 4 IS VALID ONLY FOR READ FUNCTIONS * 00845000
*            DO;                                                   0369 00846000
*                                                                  0369 00847000
*              /* IF I/O WAS NOT READ NEXT, RETURN                    * 00848000
*              IF UTOPTCD = '02'X                                  0370 00849000
*                THEN                  /* I/O WAS READ NEXT           * 00850000
         CLI   UTOPTCD,X'02'                                       0370 00851000
         BNE   @RF00370                                            0370 00852000
*                /* END OF DATA SET HAS BEE REACHED                   * 00853000
*                  DO;                                             0371 00854000
*                    EODSW = '1'B;     /* INDICATE END-OF-DATA        * 00855000
*                                                                  0372 00856000
         OI    EODSW,B'00100000'                                   0372 00857000
*                    /* SET 'NEXTREC'BASED ON WHETHER OR NOT DATA     * 00858000
*                    /* SET IS NUMBERED                               * 00859000
*                    IF CANONUM = '1'B                             0373 00860000
*                      THEN            /* DATA SET NOT NUMBERED       * 00861000
         TM    CANONUM(COMMREG),B'00000001'                        0373 00862000
         BNO   @RF00373                                            0373 00863000
*                        NEXTREC = MAXRECU; /* SET NEXTREC TO MAX  0374 00864000
*                                              VALUE                  * 00865000
         MVC   NEXTREC(4,COMMREG),MAXRECU                          0374 00866000
*                      ELSE            /* DATA SET IS NUMBERED        * 00867000
*                        NEXTREC = MAXREC; /* SET NEXTREC TO MAX VALUE* 00868000
         B     @RC00373                                            0375 00869000
@RF00373 MVC   NEXTREC(4,COMMREG),MAXREC                           0375 00870000
*                    GOTO IORET;       /* RETURN TO CALLER            * 00871000
         B     IORET                                               0376 00872000
*                  END;                                            0377 00873000
*                ELSE;                 /* CONTINUE CHECKING RET CODE  * 00874000
@RF00370 DS    0H                                                  0379 00875000
*            END;                                                  0379 00876000
*          ELSE;                       /* CONTINUE CHECKING RET CODE  * 00877000
*                                                                  0380 00878000
@RF00368 DS    0H                                                  0381 00879000
*        /* CHECK FOR I/O ERROR ON UTILITY DATA SET                   * 00880000
*        IF CODESAVE = 8                                           0381 00881000
*          THEN                        /* YES I/O ERROR OCCURRED      * 00882000
         CH    CODESAVE,@CH00049                                   0381 00883000
         BNE   @RF00381                                            0381 00884000
*            DO;                                                   0382 00885000
*              CCODE = 12;             /* SET RETURN CODE             * 00886000
         MVC   CCODE(2),@CH00137                                   0383 00887000
*              RETREG = ADDR (EXIT);   /* RTURN TO COMMAND MODE       * 00888000
         LA    RETREG,EXIT                                         0384 00889000
*              RETURN;                 /* RETURN                      * 00890000
@EL00003 DS    0H                                                  0385 00891000
@EF00003 DS    0H                                                  0385 00892000
@ER00003 BR    @14                                                 0385 00893000
*            END;                                                  0386 00894000
*          ELSE;                       /* RETURN CODE IS NOT 8        * 00895000
@RF00381 DS    0H                                                  0388 00896000
*IORET:    /* RESET IKJEBEUT RETURN CODE AND RETURN                   * 00897000
*        RCODEREG = CODESAVE;          /* FALLING THROUGH HERE ASSUMES  00898000
*                                         A RETURN CODE OF 12 RESTORE   00899000
*                                         RETURN CODE                 * 00900000
IORET    LR    RCODEREG,CODESAVE                                   0388 00901000
*        IOPTR = PARMREG1;             /* SET RECORD PTR IN REG 1     * 00902000
         L     @14,BACKREG(,SAVEREG)                               0389 00903000
         ST    PARMREG1,IOPTR(,@14)                                0389 00904000
*        RETREG = IORTNPTR;          /* RESTORE RETURN POINT PTR    */  00905000
         L     RETREG,IORTNPTR                                     0390 00906000
*        RESPECIFY (RCODEREG) UNRSTD;                              0391 00907000
*        RETURN;                                                   0392 00908000
         B     @EL00003                                            0392 00909000
*        END IORTN;                                                0393 00910000
*                                                                  0394 00911000
*                                                                  0394 00912000
*        /************************************************************* 00913000
*        /* THIS ROUTINE IS USED TO PUT OUT MESSAGES WHICH REQUIRE    * 00914000
*        /* FIRST AND OR SECOND LEVEL MESSAGES WITH NO INSERTIONS     * 00915000
*        /* RELMSG1 CONTAINS THE MESSAGE NUMBER. RELMSG2 CONTAINS     * 00916000
*        /* THE RELATIVE SECOND LEVEL NUMBER. 0 IF NONE. LEV1INS      * 00917000
*        /* POINTS TO THE FIRST INSERTION FOR THE FIRST LEVEL MSG     * 00918000
*        /* . LEV2INS POINTS TO THE FIRST INSERTION FOR THE           * 00919000
*        /* SECOND-LEVEL MSG.                                         * 00920000
*        /************************************************************* 00921000
*MSGRTN:                                                           0394 00922000
*        PROC OPTIONS (NOSAVE, NOSAVEAREA);                        0394 00923000
MSGRTN   DS    0H                                                  0395 00924000
*        RESPECIFY (DATAREG,BASEREG,BASEREG2,PARMREG1,WREG1,WREG2, 0395 00925000
*             COMMREG,SAVEREG) RSTD;                               0395 00926000
*        MSGPTR = RETREG;           /* SAVE RETURN PT PTR             * 00927000
         LR    MSGPTR,RETREG                                       0396 00928000
*        GENERATE REFS(LEV1INS,LEV2INS);                           0397 00929000
         IKJEBEML ,,(LEV1INS),(LEV2INS),MF=(E,SRWORK)                   00930000
*        RETREG = MSGPTR;           /* RESTORE RETURN PT PTR          * 00931000
         LR    RETREG,MSGPTR                                       0398 00932000
*        RETURN;                                                   0399 00933000
@EL00004 DS    0H                                                  0399 00934000
@EF00004 DS    0H                                                  0399 00935000
@ER00004 BR    @14                                                 0399 00936000
*        END MSGRTN;                                               0400 00937000
*                                                                  0401 00938000
*        /************************************************************* 00939000
*         /* THIS ROUTINE CONVERTS AN UNPACKED DECIMAL STRING TO      * 00940000
*         /* BINARY.                                                  * 00941000
*         /*                                                          * 00942000
*         /* INPUT                                                    * 00943000
*         /*    WREG1 CONTAINS THE LENGTH OF THE STRING               * 00944000
*         /*    WREG2 CONTAINS A POINTER TO THE STRING                * 00945000
*         /*                                                          * 00946000
*         /* OUTPUT - WREG 1 CONTAINS THE CONVERTED VALUE             * 00947000
*        /************************************************************* 00948000
*CONVERT:                                                          0401 00949000
*        PROC OPTIONS (SAVE(14),NOSAVEAREA);                       0401 00950000
*                                                                  0401 00951000
CONVERT  ST    @14,12(,@13)                                        0401 00952000
*        /* GENERATE REQUIRED ASSEMBLER STATEMENTS                    * 00953000
*        GEN REFS(WREG1);                                          0402 00954000
*                                                                  0402 00955000
         BCTR  WREG1,0                 REDUCE LENGTH BY 1               00956000
         EX    WREG1,PACK              PACK STRING                      00957000
         CVB   WREG1,PACKTMP           CONVERT TO BINARY                00958000
*        /* GENERATE PACK INSTRUCTION                                 * 00959000
*        GEN;                                                      0403 00960000
LPACKTMP EQU   8                       LENGTH OF PACKTMP                00961000
OFFSET0  EQU   0                       0 OFFSET                         00962000
PACK     PACK  PACKTMP(LPACKTMP),OFFSET0(,WREG2)                        00963000
*        RETURN;                                                   0404 00964000
@EL00005 DS    0H                                                  0404 00965000
@EF00005 DS    0H                                                  0404 00966000
@ER00005 L     @14,12(,@13)                                        0404 00967000
         BR    @14                                                 0404 00968000
*        END CONVERT;                                              0405 00969000
*                                                                  0406 00970000
*                                                                  0406 00971000
*        /************************************************************* 00972000
*        /* THIS ROUTINE CONVERTS A BINARY NUMBER TO ZONED DECIMAL    * 00973000
*        /* AND PUTS IT IN 'NUMTEMP'. THE NUMBER TO BE CONVERTED IS   * 00974000
*        /* ASSUMED TO BE IN CVDREG. THE FOLLOWING REGISTERS ARE      * 00975000
*        /* RESTRICTED FOR THE DURATION OF INPUT                      * 00976000
*        /************************************************************* 00977000
*CVDRTN:                                                           0406 00978000
*        PROC OPTIONS (SAVE(14),NOSAVEAREA);                       0406 00979000
CVDRTN   ST    @14,12(,@13)                                        0406 00980000
*       RESPECIFY (PARMREG1, WREG1, WREG2, COMMREG, SAVEREG, DATAREG)   00981000
*       RSTD;                                                      0407 00982000
*                                                                  0407 00983000
*        /* CONVERT TO DECIMAL                                        * 00984000
*        GEN (CVD   CVDREG,PACKTMP  CONVERT NUM TO PACKED DECIMAL) 0408 00985000
*        REFS(CVDREG);                                             0408 00986000
         CVD   CVDREG,PACKTMP  CONVERT NUM TO PACKED DECIMAL            00987000
*        /* GENERATE REQUIRED ASSEMBLER INSTRUCTIONS                  * 00988000
*        GEN;                                                      0409 00989000
LNUMTMP  EQU   8                       LENGTH OF NUMTEMP                00990000
         UNPK  NUMTEMP(LNUMTMP),PACKTMP(LPACKTMP) UNPACK NUMBER         00991000
SEVEN    EQU   7                       OFFSET OF SIGN FIELD IN NUMTEMP  00992000
         OI    NUMTEMP+SEVEN,C'0'      CHANGE SIGN TO DEC ZONE          00993000
*        RETURN;                       /* RETURN TO CALLER            * 00994000
@EL00006 DS    0H                                                  0410 00995000
@EF00006 DS    0H                                                  0410 00996000
@ER00006 L     @14,12(,@13)                                        0410 00997000
         BR    @14                                                 0410 00998000
*        END CVDRTN;                                               0411 00999000
*/********************************************************************* 01000000
*/*                                                                   * 01001000
*/* THIS SUBROUTINE OF THE INPUT SUBCOMMAND OF EDIT ALLOWS CONTINUAL  * 01002000
*/* INPUT LINES TO BE ENTERED INTO A DATA SET.  THE TERMINAL USER IS  * 01003000
*/* PROMPTED FOR EACH NEW LINE IF DESIRED. THE INPUT STATEMENTS ARE   * 01004000
*/* PASSED TO A SYNTAX CHECKER IF SCAN IS SPECIFIED AND A SYNTAX      * 01005000
*/* CHECKER IS AVAILABLE IN THE SYSTEM. THE NEW LINES ARE ADDED TO    * 01006000
*/* THE DATA SET UNLESS THE KEYWORD 'R' IS SPECIFIED, IN WHICH CASE   * 01007000
*/* EXISTING LINES IN THE DATA SET STARTING AT THE SPECIFIED LOCATION * 01008000
*/* ARE REPLACED.  INPUT MODE IS NORMALLY TERMINATED BY HITTING       * 01009000
*/* CARRIAGE RETURN ON A NULL LINE.  IN ADDITION, IT IS TERMINATED    * 01010000
*/* AFTER DETECTING AN ERROR OR ISSUING A SYNTACTIC DIAGNOSTIC MESSAGE* 01011000
*/* IF SCAN IS SPECIFIED.                                             * 01012000
*/*                                                                   * 01013000
*/********************************************************************* 01014000
*CONTRTN:                              /* SUBROUTINE ENTRY POINT      * 01015000
*    PROC OPTIONS (NOSAVE,NOSAVEAREA);                             0412 01016000
CONTRTN  DS    0H                                                  0413 01017000
*        RESPECIFY (PARMREG1, WREG1, WREG2, COMMREG, SAVEREG, DATAREG,  01018000
*            BASEREG,BASEREG2) RSTD;                               0413 01019000
*        CONTPTR = RETREG;           /* SAVE RETURN POINT PTR        */ 01020000
         ST    RETREG,CONTPTR                                      0414 01021000
*        BFCTLBLK = BFCTLBLK && BFCTLBLK; /* CLEAR SYNTAX CHECKER  0415 01022000
*                                            BUFFER POINTERS FOR   0415 01023000
*                                            SYNCHK                   * 01024000
         XC    BFCTLBLK(12),BFCTLBLK                               0415 01025000
*        CASYNECD = '1000'B;           /* INIT SYNTAX CHECKER ENTRY     01026000
*                                         CODE                        * 01027000
         MVI   CASYNECD(COMMREG),B'10000000'                       0416 01028000
*        CCODE = CCODE && CCODE;       /* INIT RETURN CODE            * 01029000
         LH    @12,CCODE                                           0417 01030000
         LR    @08,@12                                             0417 01031000
         XR    @08,@12                                             0417 01032000
         STH   @08,CCODE                                           0417 01033000
*        SYNSW = SYNSW && SYNSW;       /* CLEAR SYNTAX CHKR SWITCHES  * 01034000
         XC    SYNSW(1),SYNSW                                      0418 01035000
*        GMPARM = GMPARMX;             /* MOVE SIZE LIST FOR GETMAIN    01036000
*                                         TO DYNAMIC AREA             * 01037000
*                                                                  0419 01038000
         MVC   GMPARM(8),GMPARMX                                   0419 01039000
*        /* CHECK DATA SET TYPE FOR PARAMETER INITIALIZATION          * 01040000
*        IF CATYPE = CABASIC | CATYPE = CAIPLI                     0420 01041000
*          THEN                        /* YES TYPE IS BASIC OR IPLI   * 01042000
         CLI   CATYPE(COMMREG),X'20'                               0420 01043000
         BE    @RT00420                                            0420 01044000
         CLI   CATYPE(COMMREG),X'21'                               0420 01045000
         BNE   @RF00420                                            0420 01046000
@RT00420 DS    0H                                                  0421 01047000
*            CASYNCD2 = '10000'B;      /* INIT SYNTAX CHECKER      0421 01048000
*                                         INTERFACE                   * 01049000
         MVI   CASYNCD2(COMMREG),B'10000000'                       0421 01050000
*          ELSE;                       /* NO, TYPE NOT BASIC OR IPLI  * 01051000
@RF00420 DS    0H                                                  0423 01052000
*        FLAGS = FLAGS && FLAGS;       /* TURN OFF SWITCHES           * 01053000
         XC    FLAGS(1),FLAGS                                      0423 01054000
*        UTDCBPTR = CAPTCDCB;          /* SET UTIL DCB PTR            * 01055000
         MVC   UTDCBPTR(4),CAPTCDCB(COMMREG)                       0424 01056000
*        PTLPBLK = PTLINE;             /* MOVE L-FORM PUTLINE TO WORK   01057000
*                                         AREA                        * 01058000
*                                                                  0425 01059000
         MVC   PTLPBLK(20),PTLINE                                  0425 01060000
*MAINLP: ;                             /* MAIN LOOP PROCESSING        * 01061000
MAINLP   DS    0H                                                  0427 01062000
*        /* CHECK IF NEW LINE WILL FIT IN DATA SET                    * 01063000
*        IF NEXTREC > FIRSTLN                                      0427 01064000
*          THEN;                       /* NEW LINE WILL FIT IN DATA     01065000
*                                         SET - CONTINUE PROCESSING AT  01066000
*                                         'SETPRMPT'                  * 01067000
         L     @12,NEXTREC(,COMMREG)                               0427 01068000
         C     @12,FIRSTLN(,COMMREG)                               0427 01069000
         BH    @RT00427                                            0427 01070000
*          ELSE                        /* LINE WILL NOT FIT IN DS     * 01071000
*                                      /* NO ROOM ROUTINE             * 01072000
*            DO;                       /* THERE IS NO ROOM TO PUT THE   01073000
*                                         NEW RECORD IN THE DATA SET  * 01074000
*                                                                  0429 01075000
*              /* CHECK FOR LINE-NUMBERED DATA SET                    * 01076000
*              IF CANONUM = '1'B                                   0430 01077000
*                THEN                  /* DATA SET NOT NUMBERED       * 01078000
         TM    CANONUM(COMMREG),B'00000001'                        0430 01079000
         BNO   @RF00430                                            0430 01080000
*                                      /* SEQUENCE NUMBER ROUTINE     * 01081000
*                  DO;                                             0431 01082000
*                                                                  0431 01083000
*                    /* CHECK FOR NEW SEQUENCE NUMBER AT MAX VALUE    * 01084000
*                    IF MAXRECU <= FIRSTLN                         0432 01085000
*                      THEN            /* YES - LINE NUMBER EXCEEDS     01086000
*                                         PHYSICAL MAXIMUM            * 01087000
         L     @12,MAXRECU                                         0432 01088000
         C     @12,FIRSTLN(,COMMREG)                               0432 01089000
         BH    @RF00432                                            0432 01090000
*                        DO;                                       0433 01091000
*                                                                  0433 01092000
*                          LEV1INS = 0;    /* INDICATE NO LEV1 INSERT-  01093000
*                                             ION                     * 01094000
         SLR   LEV1INS,LEV1INS                                     0434 01095000
*RENUMMSG:                             /* DATA SET MUST BE RENUMBERED * 01096000
*                          RELMSG1 = 776;  /* SET MESSAGE NUMBER      * 01097000
RENUMMSG MVC   RELMSG1(2),@CH01296                                 0435 01098000
*                          RELMSG2 = 0;    /* INDICATE NO LEVEL-2 MSG * 01099000
         SLR   @12,@12                                             0436 01100000
         STH   @12,RELMSG2                                         0436 01101000
*                          LEV2INS = 0;    /* INDICATE NO LEV-2 INSERT- 01102000
*                                             ION                     * 01103000
         SLR   LEV2INS,LEV2INS                                     0437 01104000
*                          CALL MSGRTN;/* PUT OUT MESSAGE             * 01105000
*                                                                  0438 01106000
         BAL   @14,MSGRTN                                          0438 01107000
*                          CCODE=8;    /* INDICATE FLUSH NEEDED       * 01108000
         MVC   CCODE(2),@CH00049                                   0439 01109000
*                          GOTO EXIT2; /* ISSUE ERROR MESSAGE - DATA    01110000
*                                         SET MUST BE RENUMBERED   0440 01111000
*                                         RETURN TO EDIT MODE         * 01112000
         B     EXIT2                                               0440 01113000
*                        END;                                      0441 01114000
*                      ELSE            /* NO - NEW SEQUENCE NUMBER 0442 01115000
*                                         DOES NOT EXCEED MAX         * 01116000
*                                      /* UPDATE NEXT RECORD          * 01117000
*                        DO;                                       0442 01118000
@RF00432 DS    0H                                                  0443 01119000
*                          FIRSTLN = NEXTREC; /* UPDATE RECORD KEY    * 01120000
         MVC   FIRSTLN(4,COMMREG),NEXTREC(COMMREG)                 0443 01121000
*                          UTOPTCD = '00'X; /* READ CURRENT           * 01122000
*                                                                  0444 01123000
         MVI   UTOPTCD,X'00'                                       0444 01124000
*                          /* BFR ADDR                                * 01125000
*                          UTADPTR = ADDR (CLNBFR (1));            0445 01126000
*                                                                  0445 01127000
         LA    @12,CLNBFR(,COMMREG)                                0445 01128000
         ST    @12,UTADPTR                                         0445 01129000
*                          /* POINT TO KEY                            * 01130000
*                          UTKEYPTR = ADDR (NEXTREC);              0446 01131000
         LA    @12,NEXTREC(,COMMREG)                               0446 01132000
         ST    @12,UTKEYPTR                                        0446 01133000
*                          LBIT2 = '0'B; /* TURN OFF FLAG             * 01134000
         NI    LBIT2,B'01111111'                                   0447 01135000
*                          LBIT3 = '1'B; /* TURN ON END-OF-PARM       * 01136000
         OI    LBIT3,B'10000000'                                   0448 01137000
*                          CALL IORTN; /* READ CURRENT RECORD FOR  0449 01138000
*                                         CLNSAVE ROUTINE             * 01139000
         BAL   @14,IORTN                                           0449 01140000
*                          UTOPTCD = '10'X; /* SET CODE FOR DELETE    * 01141000
         MVI   UTOPTCD,X'10'                                       0450 01142000
*                          CALL IORTN; /* DELETE RECORD TO BE RIPPLED * 01143000
         BAL   @14,IORTN                                           0451 01144000
*                          CALL CLNSAVE; /* GO MAKE ROOM IN THE DATA    01145000
*                                           SET FOR NEW RECORD        * 01146000
         BAL   @14,CLNSAVE                                         0452 01147000
*GETNEXT:                  GOTO MAINLP;/* UPON RETURN FROM CLNSAVE,     01148000
*                                         'NEXTREC' WILL HAVE BEEN 0453 01149000
*                                         UPDATED TO REFLECT THE NEW    01150000
*                                         SEQUENCE NUMBER GIVEN TO 0453 01151000
*                                         THE EXISTING NEXT RECORD.  GO 01152000
*                                         GET THE NEXT INPUT RECORD   * 01153000
         B     MAINLP                                              0453 01154000
*                        END;                                      0454 01155000
*                  END;                                            0455 01156000
*                ELSE                  /* DATA SET IS NUMBERED        * 01157000
*                                      /* CHECK FOR RECORD NUMBER MAX * 01158000
*                  DO;                                             0456 01159000
*                                                                  0456 01160000
@RF00430 DS    0H                                                  0457 01161000
*                    /* CHECK FOR RECORD NUMBER EXCEEDING PHYSICAL    * 01162000
*                    /* MAXIMUM                                       * 01163000
*                    IF MAXREC <= NEXTREC                          0457 01164000
*                      THEN            /* YES, MAX NUMBER EXCEEDED    * 01165000
         L     @12,MAXREC                                          0457 01166000
         C     @12,NEXTREC(,COMMREG)                               0457 01167000
         BH    @RF00457                                            0457 01168000
*                        DO;                                       0458 01169000
*                          /* LOAD INSERT NUM                         * 01170000
*                          LEV1INS = ADDR (INSM402);               0459 01171000
         LA    LEV1INS,INSM402                                     0459 01172000
*                          GOTO RENUMMSG; /* GO PUT OUT MESSAGE       * 01173000
         B     RENUMMSG                                            0460 01174000
*                        END;                                      0461 01175000
*                      ELSE;           /* NO MAX NOT EXCEEDED         * 01176000
*                                                                  0462 01177000
@RF00457 DS    0H                                                  0463 01178000
*                    /* CHECK IF R-FORM SPECIFIED                     * 01179000
*                    IF CAIMIR = '0'B                              0463 01180000
*                      THEN            /* R-FORM WAS SPECIFIED        * 01181000
         TM    CAIMIR(COMMREG),B'00010000'                         0463 01182000
         BZ    @RT00463                                            0463 01183000
*                        GO TO SETPRMPT; /* GET NEXT INPUT LINE       * 01184000
*                      ELSE            /* R-FORM WAS NOT SPECIFIED THE  01185000
*                                         RECORD CANNOT BE DELETED    * 01186000
*                        DO;                                       0465 01187000
*                                      /* TERMINATE INPUT MODE        * 01188000
*                          CVDREG = NEXTREC; /* GET NUMBER TO BE   0466 01189000
*                                               CONVERTED             * 01190000
         L     CVDREG,NEXTREC(,COMMREG)                            0466 01191000
*                          CALL CVDRTN;/* CONVERT NUMBER TO DECIMAL   * 01192000
         BAL   @14,CVDRTN                                          0467 01193000
*                          INSREC = INSM400; /* MOVE MODEL TO WORKAREA* 01194000
*                                                                  0468 01195000
         MVC   INSREC(16),INSM400                                  0468 01196000
*                          /* THIS DO LOOP LOCATES THE FIRST          * 01197000
*                          /* NON-ZERO BYTE OF THE NUMBER TO BE       * 01198000
*                          /* SENT TO THE TERMINAL. IT SCANS FROM     * 01199000
*                          /* LEFT TO RIGHT.                          * 01200000
*                          DO WREG2 = 1 TO LENGTH (INSNUM) BY 1;   0469 01201000
*                                                                  0469 01202000
         LA    WREG2,1                                             0469 01203000
@DL00469 DS    0H                                                  0470 01204000
*                            /* CHECK CURRENT CHAR FOR DECIMAL ZERO   * 01205000
*                            IF NUMTEMP (WREG2) = '0'              0470 01206000
*                              THEN;   /* ZERO, CONTINUE LOOP         * 01207000
         LA    @12,NUMTEMP-1(WREG2)                                0470 01208000
         CLI   0(@12),C'0'                                         0470 01209000
         BNE   @RF00470                                            0470 01210000
*                              ELSE    /* NOT ZERO - EXIT             * 01211000
*                                GOTO LPOUT1; /* EXIT FROM LOOP       * 01212000
*                          END;        /* WREG2 CONTAINS THE OFFSET   * 01213000
*                                                                  0473 01214000
         AH    WREG2,@CH00051                                      0473 01215000
         CH    WREG2,@CH00049                                      0473 01216000
         BNH   @DL00469                                            0473 01217000
*                          /* RESET TO MAX LENGTH                     * 01218000
*                          WREG2 = LENGTH (INSNUM);                0474 01219000
         LA    WREG2,8                                             0474 01220000
*LPOUT1: ;                             /* CONTINUE                    * 01221000
*                                                                  0475 01222000
LPOUT1   DS    0H                                                  0476 01223000
*                          /* FIND LENGTH OF THE NUMBER               * 01224000
*                          WREG1 = LENGTH (INSNUM) + 1 - WREG2;    0476 01225000
*                                                                  0476 01226000
         LA    WREG1,9                                             0476 01227000
         SLR   WREG1,WREG2                                         0476 01228000
*                          /* MOVE NON-ZERO PORTION TO INSERTION      * 01229000
*                          /* RECORD                                  * 01230000
*                          INSNUM (1:WREG1) =                      0477 01231000
*                                NUMTEMP(WREG2:WREG2+WREG1-1);     0477 01232000
         LR    @12,WREG1                                           0477 01233000
         BCTR  @12,0                                               0477 01234000
         LA    @08,NUMTEMP-1(WREG2)                                0477 01235000
         EX    @12,@SM01400                                        0477 01236000
*                          /* FIND INSERT LENGTH                      * 01237000
*                          INSLEN = WREG1 + 4;                     0478 01238000
*                                                                  0478 01239000
         LA    @12,4(,WREG1)                                       0478 01240000
         STH   @12,INSLEN                                          0478 01241000
*                          RELMSG1 = 774;  /* LOAD MSG NUMBER         * 01242000
         MVC   RELMSG1(2),@CH01306                                 0479 01243000
*                          RELMSG2 = 0;    /* INDICATE NO LEVEL-2 MSG * 01244000
*                                                                  0480 01245000
         SLR   @12,@12                                             0480 01246000
         STH   @12,RELMSG2                                         0480 01247000
*                          /* POINT TO INSERTION                      * 01248000
*                          LEV1INS = ADDR (INSREC);                0481 01249000
         LA    LEV1INS,INSREC                                      0481 01250000
*                          LEV2INS = 0;    /* NO LEVEL-2 INSERTION    * 01251000
         SLR   LEV2INS,LEV2INS                                     0482 01252000
*                          CALL MSGRTN;/* PUT OUT MESSAGE             * 01253000
*                                                                  0483 01254000
         BAL   @14,MSGRTN                                          0483 01255000
*                          GOTO EXIT2; /* RETURN TO COMMAND MODE      * 01256000
         B     EXIT2                                               0484 01257000
*                        END;                                      0485 01258000
*                  END;                                            0486 01259000
*            END;                      /* PROCESSING CONTINUES HERE IF  01260000
*                                         THERE IS ROOM TO WRITE THE    01261000
*                                         NEXT RECORD FROM THE     0487 01262000
*                                         TERMINAL INTO THE DATA SET  * 01263000
*SETPRMPT: ;                           /* CONTINUE, LINE FITS         * 01264000
*                                                                  0488 01265000
@RT00427 DS    0H                                                  0488 01266000
SETPRMPT DS    0H                                                  0489 01267000
*        /* CHECK FOR SELF PROMPTING                                  * 01268000
*        IF CAIMSFPT = '1'B                                        0489 01269000
*          THEN                        /* YES, INPUT DOES PROMPTING   * 01270000
         TM    CAIMSFPT(COMMREG),B'00000100'                       0489 01271000
         BNO   @RF00489                                            0489 01272000
*                                      /* NUMBERED DATA SET ROUTINE   * 01273000
*            DO;                                                   0490 01274000
*                                                                  0490 01275000
*              /* CHECK FOR A NUMBERED DATA SET                       * 01276000
*              IF CANONUM = '0'B                                   0491 01277000
*                THEN;                 /* DATA SET IS NUMBERED        * 01278000
         TM    CANONUM(COMMREG),B'00000001'                        0491 01279000
         BZ    @RT00491                                            0491 01280000
*                ELSE                  /* NO, NOT NUMBERED            * 01281000
*                  DO;                                             0493 01282000
*                    NUMTEMP (1:2) = 'I ';     /* SET PROMPT CHAR     * 01283000
         MVC   NUMTEMP(2),@CC01308                                 0494 01284000
*                    LNUMTEMP = 6;     /* SET LENGTH FOR PROMPT       * 01285000
         LA    @12,6                                               0495 01286000
         STH   @12,LNUMTEMP                                        0495 01287000
*                    LTEMPNUM = 6;     /* RESET LENGTH FOR PROMPT     * 01288000
         STH   @12,LTEMPNUM                                        0496 01289000
*                    NUMBTMP(1:2) = NUMTEMP(1:2);/* RESET PROMPT CHAR * 01290000
         MVC   NUMBTMP(2),NUMTEMP                                  0497 01291000
*                    GOTO SETLKPRM;    /* GO PUT PROMPT TO TERM       * 01292000
         B     SETLKPRM                                            0498 01293000
*                  END;                                            0499 01294000
*                                      /* PREPARE PROMPT LINE NUMBER  * 01295000
*              CVDREG = FIRSTLN;       /* GET NUMBER OF NEXT LINE     * 01296000
@RT00491 L     CVDREG,FIRSTLN(,COMMREG)                            0500 01297000
*              CALL CVDRTN;            /* CONVERT NUMBER TO DECIMAL   * 01298000
         BAL   @14,CVDRTN                                          0501 01299000
*              WREG2 = ADDR (NUMTEMP); /* THE FOLLOWING CODE       0502 01300000
*                                         ELIMINATES UP TO 3 LEADING    01301000
*                                         ZEROS FROM THE NUMBER THAT    01302000
*                                         WILL BE SENT TO THE TERMINAL  01303000
*                                         AS A PROMPT.  GET ADDR OF     01304000
*                                         CONVERTED NUM               * 01305000
*                                                                  0502 01306000
         LA    WREG2,NUMTEMP                                       0502 01307000
*              /* SET LOOP                                            * 01308000
*              DO WREG1 = 3 TO 1 BY -1;                            0503 01309000
*                                                                  0503 01310000
         LA    WREG1,3                                             0503 01311000
@DL00503 DS    0H                                                  0504 01312000
*                /* CHECK FOR 0                                       * 01313000
*                IF WREG2 -> NUMSCAN(1) = '0'                      0504 01314000
*                  THEN;               /* CHARACTER IS ZERO           * 01315000
         CLI   NUMSCAN(WREG2),C'0'                                 0504 01316000
         BNE   @RF00504                                            0504 01317000
*                  ELSE                /* NO, NOT ZERO, END LOOP      * 01318000
*                    GOTO MVNUM;       /* GO ADJUST NUMBER            * 01319000
*                WREG2 = WREG2 + 1;    /* POINT TO NEXT CHAR          * 01320000
         AH    WREG2,@CH00051                                      0507 01321000
*              END;                    /* CONTINUE LOOP               * 01322000
         BCTR  WREG1,0                                             0508 01323000
         LTR   WREG1,WREG1                                         0508 01324000
         BP    @DL00503                                            0508 01325000
*MVNUM: ;                              /* ADJUST NUMBER FOR PRINT OUT * 01326000
MVNUM    DS    0H                                                  0510 01327000
*              WREG1 = ADDR (NUMTEMP) + 8 - WREG2;    /* FIND LENGTH OF 01328000
*                                                        NUM          * 01329000
*                                                                  0510 01330000
         LA    WREG1,NUMTEMP                                       0510 01331000
         AH    WREG1,@CH00049                                      0510 01332000
         SLR   WREG1,WREG2                                         0510 01333000
*              /* LEFT-ADJUST NUMBER                                  * 01334000
*              NUMTEMP (1:WREG1) = WREG2 -> NUMADJ (1:WREG1);      0511 01335000
         LR    @12,WREG1                                           0511 01336000
         BCTR  @12,0                                               0511 01337000
         EX    @12,@SM01402                                        0511 01338000
*              LNUMTEMP = WREG1 + 4;   /* STORE LENGTH OF NUMBER      * 01339000
         LR    @08,WREG1                                           0512 01340000
         AH    @08,@CH00389                                        0512 01341000
         STH   @08,LNUMTEMP                                        0512 01342000
*              LTEMPNUM = LNUMTEMP + 1;  /* ADD ONE FOR ENDING BLANK  * 01343000
         LA    @08,1(,@08)                                         0513 01344000
         STH   @08,LTEMPNUM                                        0513 01345000
*              NUMBTMP(1:WREG1) = NUMTEMP(1:WREG1); /*PUT NUMBER   0514 01346000
*                                                   IN TEMP BUFFER    * 01347000
         EX    @12,@SM01404                                        0514 01348000
*              NUMBTMP(WREG1+1) = ' ';   /* PLACE BLANK AFTER NUMBER  * 01349000
         LA    @12,NUMBTMP(WREG1)                                  0515 01350000
         MVI   0(@12),C' '                                         0515 01351000
*SETLKPRM: ;                           /* PREPARE TO ISSUE LINE OR CHAR 01352000
*                                         PROMPT FOR USER             * 01353000
SETLKPRM DS    0H                                                  0517 01354000
*              WREG2 = ADDR (PTLPBLK); /* GET ADDR OF PUT/GET PARMS   * 01355000
         LA    WREG2,PTLPBLK                                       0517 01356000
*              PARMREG1 = ADDR (CATMPLST); /* POINT TO PARM LIST      * 01357000
*                                                                  0518 01358000
         LA    PARMREG1,CATMPLST(,COMMREG)                         0518 01359000
*              /* PROMPT TERMINAL AND GET NEXT LINE                   * 01360000
*              GEN REFS(WREG2);                                    0519 01361000
         PUTLINE PARM=(WREG2),OUTPUT=(LTEMPNUM,TERM,SINGLE,DATA),      X01362000
               MF=(E,(1))                                               01363000
*              RESPECIFY(RCODEREG) RSTD;                           0520 01364000
*              /* CHECK FOR RETURN CODE OF 0                          * 01365000
*              IF RCODEREG = 0                                     0521 01366000
*                THEN                  /* YES, RETURN CODE IS 0       * 01367000
         LTR   RCODEREG,RCODEREG                                   0521 01368000
         BZ    @RT00521                                            0521 01369000
*                  GOTO RDTERM;        /* CONTINUE PROCESSING         * 01370000
*                ELSE                  /* NO, RETURN CODE NOT 0       * 01371000
*                  CODESAVE = RCODEREG;/* SAVE RETURN CODE           */ 01372000
         LR    CODESAVE,RCODEREG                                   0523 01373000
*              RESPECIFY(RCODEREG) UNRSTD;                         0524 01374000
*              /* CHECK FOR RETURN CODE OF 16                         * 01375000
*              IF CODESAVE = 16                                    0525 01376000
*                THEN                  /* YES, GETMAIN FAILURE        * 01377000
         CH    CODESAVE,@CH00228                                   0525 01378000
         BNE   @RF00525                                            0525 01379000
*                  DO;                                             0526 01380000
*NOCORE: ;                             /* CORE NOT AVAILABLE          * 01381000
NOCORE   DS    0H                                                  0528 01382000
*                    RELMSG1 = 270;    /* LOAD MESSAGE NUMBER         * 01383000
         MVC   RELMSG1(2),@CH01250                                 0528 01384000
*                    RELMSG2 = 0;      /* INDICATE NO LEVEL 2         * 01385000
         SLR   @12,@12                                             0529 01386000
         STH   @12,RELMSG2                                         0529 01387000
*                    LEV1INS = ADDR (INSM25); /* POINT TO INSERT      * 01388000
         LA    LEV1INS,INSM25                                      0530 01389000
*                    LEV2INS = 0;      /* INDICATE NO LEV-2 INSERTION * 01390000
         SLR   LEV2INS,LEV2INS                                     0531 01391000
*                    CALL MSGRTN;      /* PUT OUT MESSAGE             * 01392000
*                                                                  0532 01393000
         BAL   @14,MSGRTN                                          0532 01394000
*                    CCODE=8;          /* INDICATE FLUSH NEEDED       * 01395000
         MVC   CCODE(2),@CH00049                                   0533 01396000
*                    GOTO EXIT2;       /* RETURN TO EDIT MODE         * 01397000
         B     EXIT2                                               0534 01398000
*                  END;                                            0535 01399000
*                ELSE;                 /* NOT GETMAIN FAILURE         * 01400000
*                                                                  0536 01401000
@RF00525 DS    0H                                                  0537 01402000
*              /* CHECK FOR RETURN CODE 8 OR 12                       * 01403000
*              IF CODESAVE = 12 | CODESAVE = 8                     0537 01404000
*                THEN                  /* YES RETURN CODE IS 12       * 01405000
         CH    CODESAVE,@CH00137                                   0537 01406000
         BE    @RT00537                                            0537 01407000
         CH    CODESAVE,@CH00049                                   0537 01408000
         BNE   @RF00537                                            0537 01409000
@RT00537 DS    0H                                                  0538 01410000
*                  DO;                                             0538 01411000
*                    INSREC = M313INS2;/* MOVE MODEL TO WORK AREA -     01412000
*                                         PUTLINE                     * 01413000
         MVC   INSREC(16),M313INS2                                 0539 01414000
*                    DO;                                           0540 01415000
*SRVERR: ;                             /* INVALID RETURN CODE         * 01416000
SRVERR   DS    0H                                                  0542 01417000
*                      SRVREG2 = CODESAVE; /* GET RETURN CODE         * 01418000
         LR    SRVREG2,CODESAVE                                    0542 01419000
*                      CALL SRVERRTN;  /* DIAGNOSE CMD SYS ERROR      * 01420000
         BAL   @14,SRVERRTN                                        0543 01421000
*                      GOTO EXIT2;     /* GO RETURN TO EDIT MODE      * 01422000
         B     EXIT2                                               0544 01423000
*                    END;                                          0545 01424000
*                  END;                                            0546 01425000
*                ELSE                  /* RETURN CODE NOT 8 OR 12     * 01426000
*                  GOTO EXIT2;         /* GO RETURN TO EDIT MODE      * 01427000
*            END;                                                  0548 01428000
*          ELSE;                       /* NO, PROMPT ISNONE OR AUTO   * 01429000
@RF00489 DS    0H                                                  0550 01430000
*RDTERM: ;                             /* GET INPUT FROM USER         * 01431000
RDTERM   DS    0H                                                  0551 01432000
*        GTPBPTR = ADDR (GLPBLK);      /* SET PARM LIST PTR           * 01433000
         LA    GTPBPTR,GLPBLK                                      0551 01434000
*        WREG2 = GTPBPTR;              /* POINT TO GETL PARMS         * 01435000
         LR    WREG2,GTPBPTR                                       0552 01436000
*        PARMREG1 = ADDR (CATMPLST);   /* SET PARM REG                * 01437000
*                                                                  0553 01438000
         LA    PARMREG1,CATMPLST(,COMMREG)                         0553 01439000
*        /* GET LINE FROM TERMINAL                                    * 01440000
*        GEN REFS(WREG2);                                          0554 01441000
        GETLINE PARM=(WREG2),INPUT=(TERM,PHYSICAL),TERMGET=(EDIT,WAIT),X01442000
               MF=(E,(1))                                               01443000
*                                      /* INTERROGATE RETURN CODE     * 01444000
*        WREG2 = RCODEREG;             /* SAVE RETURN CODE REG        * 01445000
*                                                                  0555 01446000
         LR    WREG2,RCODEREG                                      0555 01447000
*        /* CHECK RETURN CODE FROM GETLINE                            * 01448000
*        IF WREG2 = 0                                              0556 01449000
*          THEN;                       /* OK, CONTINUE                * 01450000
         LTR   WREG2,WREG2                                         0556 01451000
         BZ    @RT00556                                            0556 01452000
*          ELSE                        /* ERROR, NO LINE RETURNED     * 01453000
*            DO;                                                   0558 01454000
*                                                                  0558 01455000
*              /* DID GETMAIN FAIL                                    * 01456000
*              IF WREG2 = 24                                       0559 01457000
*                THEN                  /* YES GETMAIN FAILED          * 01458000
         CH    WREG2,@CH00068                                      0559 01459000
         BE    @RT00559                                            0559 01460000
*                  GOTO NOCORE;        /* GO PUT OUT MESSAGE          * 01461000
*                ELSE                  /* NO, OTHER FAILURE           * 01462000
*                  DO;                                             0561 01463000
*                                                                  0561 01464000
*                    /* CHECK FOR RETURN CODE 8                       * 01465000
*                    IF WREG2 = 8                                  0562 01466000
*                      THEN            /* ATTN WAS ENTERED            * 01467000
         CH    WREG2,@CH00049                                      0562 01468000
         BE    @RT00562                                            0562 01469000
*                        GOTO EXIT2;   /* GO RETURN TO EDIT MODE      * 01470000
*                      ELSE            /* RETURN CODE IS NOT 8        * 01471000
*                        DO;                                       0564 01472000
*                                                                  0564 01473000
*                          /* MOVE MODEL TO WORK AREA - GETLINE       * 01474000
*                          INSREC (1:16) = M313INS3;               0565 01475000
         MVC   INSREC(16),M313INS3                                 0565 01476000
*                          GOTO SRVERR;/* GO PUT OUT MESSAGE          * 01477000
         B     SRVERR                                              0566 01478000
*                        END;                                      0567 01479000
*                  END;                                            0568 01480000
*            END;                                                  0569 01481000
*                                                                  0569 01482000
*        /* CHECK FOR RECORD FROM TERMINAL BEING LONGER THAN MAX      * 01483000
*        /* ALLOWABLE FOR DATA SET                                    * 01484000
*        IF INLEN <= 259                                           0570 01485000
*          THEN                        /* RECORD IS LESS THAN MAX     * 01486000
@RT00556 L     @08,INBUFPTR(,GTPBPTR)                              0570 01487000
         LH    @08,INLEN(,@08)                                     0570 01488000
         CH    @08,@CH01321                                        0570 01489000
         BH    @RF00570                                            0570 01490000
*            DO;                                                   0571 01491000
*              WREG1 = INLEN;          /* SET LENGTH OF INPUT LINE FOR  01492000
*                                         MOVE                        * 01493000
         LR    WREG1,@08                                           0572 01494000
*            END;                                                  0573 01495000
*          ELSE                        /* RECORD IS TOO LARGE         * 01496000
*            DO;                                                   0574 01497000
         B     @RC00570                                            0574 01498000
@RF00570 DS    0H                                                  0575 01499000
*              MSGSW1 = '1'B;          /* SET SWITCH TO PUT OUT MSG   * 01500000
         OI    MSGSW1,B'01000000'                                  0575 01501000
*              WREG1 = 259;            /* STORE LENGTH FOR DATA MOVE    01502000
*                                         -4 FOR HEADER               * 01503000
         LA    WREG1,259                                           0576 01504000
*            END;                                                  0577 01505000
*        /* CHECK FOR CARRIAGE RETURN ONLY IN INPUT                   * 01506000
*        IF WREG1 = 4                                              0578 01507000
*          THEN                        /* YES, NEXT LINE IS CR        * 01508000
@RC00570 CH    WREG1,@CH00389                                      0578 01509000
         BE    @RT00578                                            0578 01510000
*                                      /* RETURN TO COMMAND MODE      * 01511000
*              GOTO EXIT1;             /* RETURN TO CMD MODE  @ZM30965* 01512000
*                                                                  0579 01513000
*        /* MOVE NEW REC TO WORK AREA                                 * 01514000
*        OUTDATA (1:WREG1 - 4) = INLINE (5:WREG1);                 0580 01515000
         LR    @08,WREG1                                           0580 01516000
         SH    @08,@CH00124                                        0580 01517000
         L     @07,INBUFPTR(,GTPBPTR)                              0580 01518000
         EX    @08,@SM01407                                        0580 01519000
*        OUTLEN = WREG1;               /* STORE RECORD LENGTH         * 01520000
         STH   WREG1,OUTLEN(,COMMREG)                              0581 01521000
*        OUTRESV = 0;                  /* CLEAR UNUSED FIELD          * 01522000
         SLR   @08,@08                                             0582 01523000
         STH   @08,OUTRESV(,COMMREG)                               0582 01524000
*        FMADDR = INBUFPTR;            /* LINE HAS BEEN RECEIVED FROM   01525000
*                                         THE TERMINAL AND MUST NOW BE  01526000
*                                         EDITED FOR TABS AND      0583 01527000
*                                         CONVERTED TO UPPER CASE IF    01528000
*                                         NECESSARY.  THE BUFFER   0583 01529000
*                                         OBTAINED BY GETLINE      0583 01530000
*                                         MUST BE FREED.  POINT TO INPU 01531000
*                                         BUFFER                      * 01532000
         ST    @07,FMADDR                                          0583 01533000
*        FMLEN = INLEN;                /* GET LENGTH OF BUFFER        * 01534000
         LH    @08,INLEN(,@07)                                     0584 01535000
         ST    @08,FMLEN                                           0584 01536000
*        FMLIST = FMPRMLST;            /* MOVE L-FORM OF FREEMAIN TO    01537000
*                                         WORK AREA                   * 01538000
         MVC   FMLIST(10),FMPRMLST                                 0585 01539000
*        GEN (FREEMAIN A=FMPARM,MF=(E,FMLIST)); /* FREE GETL BFR      * 01540000
         FREEMAIN A=FMPARM,MF=(E,FMLIST)                                01541000
*        /* CHECK IF R-FORM AND INCREMENT SPECIFIED                   * 01542000
*        IF CAIMIR = '0'B & CAIMCIN = '1'B                         0587 01543000
*          THEN                        /* YES, R-FORM INCRE SPECIFIED * 01544000
         TM    CAIMCIN(COMMREG),B'00001000'                        0587 01545000
         BNO   @RF00587                                            0587 01546000
         TM    CAIMIR(COMMREG),B'00010000'                         0587 01547000
         BNZ   @RF00587                                            0587 01548000
*            DO;                                                   0588 01549000
*                                                                  0588 01550000
*            /* CHECK IF NEW LINE WILL FIT IN DATA SET                * 01551000
*RFORMLP:    IF NEXTREC < FIRSTLN                                  0589 01552000
*              THEN                    /* NO, DELETE 'NEXTREC'        * 01553000
RFORMLP  L     @12,NEXTREC(,COMMREG)                               0589 01554000
         C     @12,FIRSTLN(,COMMREG)                               0589 01555000
         BNL   @RF00589                                            0589 01556000
*                DO;                                               0590 01557000
*                  UTOPTCD = '10'X;    /* GO TO IKJEBEUT TO DELETE THE  01558000
*                                         CURRENT 'NEXTREC' RECORD.     01559000
*                                         SET DELETE CODE.            * 01560000
*                                                                  0591 01561000
         MVI   UTOPTCD,X'10'                                       0591 01562000
*                  /* POINT TO RECORD TO BE DELETED                   * 01563000
*                  UTKEYPTR = ADDR (NEXTREC);                      0592 01564000
         LA    @12,NEXTREC(,COMMREG)                               0592 01565000
         ST    @12,UTKEYPTR                                        0592 01566000
*                  LBIT2 = '1'B;       /* SET END-OF-PARM INDICATOR   * 01567000
         OI    LBIT2,B'10000000'                                   0593 01568000
*                  CALL IORTN;         /* DELETE CURRENT 'NEXTREC'    * 01569000
*                                                                  0594 01570000
         BAL   @14,IORTN                                           0594 01571000
*                  /* IF TYPE IS IPLI OR BASIC, THE DELETION MUST BE  * 01572000
*                  /* PASSED TO THE SYNTAX CHECKER                    * 01573000
*                  IF CADSCODE = CAIPLI | CADSCODE = CABASIC       0595 01574000
*                    THEN              /* TYPE IS BASIC OR IPLI       * 01575000
         CLI   CADSCODE(COMMREG),X'21'                             0595 01576000
         BE    @RT00595                                            0595 01577000
         CLI   CADSCODE(COMMREG),X'20'                             0595 01578000
         BNE   @RF00595                                            0595 01579000
@RT00595 DS    0H                                                  0596 01580000
*                      DO;                                         0596 01581000
*                                                                  0596 01582000
*                      /* SEE IF SYNTAX CHECKER IS AVAILABLE          * 01583000
*                        IF CAPTCHK = 0 | SYNCKOFF = '1'B          0597 01584000
*                          THEN;       /* NO, CHECKER UNAVAILABLE     * 01585000
         ICM   @12,15,CAPTCHK(COMMREG)                             0597 01586000
         BZ    @RT00597                                            0597 01587000
         TM    SYNCKOFF,B'00001000'                                0597 01588000
         BO    @RT00597                                            0597 01589000
*                          ELSE        /* YES, CHECKER AVAILABLE      * 01590000
*                            DO;                                   0599 01591000
*                              STARTV = NEXTREC; /* STORE LINE NUM TO   01592000
*                                                   BE DELETED        * 01593000
         L     @12,NEXTREC(,COMMREG)                               0600 01594000
         ST    @12,STARTV                                          0600 01595000
*                              STOPV = NEXTREC; /* LAST LINE TO BE DLT* 01596000
         ST    @12,STOPV                                           0601 01597000
*                              /* POINT TO DELETE LIST                * 01598000
*                              CASYNBFR = ADDR (SNCHKDLT);         0602 01599000
         LA    @12,SNCHKDLT                                        0602 01600000
         ST    @12,CASYNBFR(,COMMREG)                              0602 01601000
*                              CASYNECD = '1000'B; /* SET ENTRY CODE  * 01602000
         MVI   CASYNECD(COMMREG),B'10000000'                       0603 01603000
*                              CASYNCD2 = '01000'B;/* INDICATE DELETE * 01604000
         MVI   CASYNCD2(COMMREG),B'01000000'                       0604 01605000
*                              /* POINT TO PARMLIST IN REG ONE        * 01606000
*                              PARMREG1 = ADDR (CASYNLST);         0605 01607000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0605 01608000
*                              CALL CHECKER; /* DELETE RECORD FROM 0606 01609000
*                                               POLISH DATA SET       * 01610000
         L     @15,CAPTCHK(,COMMREG)                               0606 01611000
         BALR  @14,@15                                             0606 01612000
*                              CASYNCD2 = '10000'B;/* RESET INTERFACE * 01613000
         MVI   CASYNCD2(COMMREG),B'10000000'                       0607 01614000
*                            END;                                  0608 01615000
*                      END;                                        0609 01616000
*                    ELSE;             /* TYPE IS NOT IPLI OR BASIC   * 01617000
@RF00595 DS    0H                                                  0611 01618000
*                  UTOPTCD = '02'X;    /* SET FOR READ NEXT           * 01619000
@RC00595 MVI   UTOPTCD,X'02'                                       0611 01620000
*                  LBIT1 = '1'B;       /* SET END-OF-PARM INDICATOR   * 01621000
         OI    LBIT1,B'10000000'                                   0612 01622000
*                  CALL IORTN;         /* GO READ NEXT                * 01623000
*                                                                  0613 01624000
         BAL   @14,IORTN                                           0613 01625000
*                  /* CHECK FOR SUCCESSFUL READ                       * 01626000
*                  IF RCODEREG = 0                                 0614 01627000
*                    THEN              /* YES, RECORD FOUND           * 01628000
         LTR   RCODEREG,RCODEREG                                   0614 01629000
         BNZ   @RF00614                                            0614 01630000
*                      NEXTREC = INKEY; /* UPDATE NEXT RECORD PTR     * 01631000
         MVC   NEXTREC(4,COMMREG),INKEY(UTPREG1)                   0615 01632000
*                  GO TO RFORMLP;      /* CONTINUE TO CHECK           * 01633000
         B     RFORMLP                                             0616 01634000
*                END;                                              0617 01635000
*            END;                                                  0618 01636000
*                                                                  0618 01637000
@RF00589 DS    0H                                                  0619 01638000
*        /* CHECK FOR TRAILING CONTINUATION CHARACTER                 * 01639000
*        IF OUTDATA (OUTLEN - 4) = '-'                             0619 01640000
*          THEN                        /* YES, CONT CHAR PRESENT      * 01641000
@RF00587 LH    @12,OUTLEN(,COMMREG)                                0619 01642000
         ALR   @12,COMMREG                                         0619 01643000
         CLI   OUTDATA-5(@12),C'-'                                 0619 01644000
         BNE   @RF00619                                            0619 01645000
*            DO;                                                   0620 01646000
*                                                                  0620 01647000
*              /* IF TYPE IS BASIC OR IPLI, CONTINUATIONS ARE NOT     * 01648000
*              /* LEGAL                                               * 01649000
*              IF CADSCODE = CABASIC | CADSCODE = CAIPLI           0621 01650000
*                THEN;                 /* TYPE IS BASIC OR IPLI       * 01651000
         CLI   CADSCODE(COMMREG),X'20'                             0621 01652000
         BE    @RT00621                                            0621 01653000
         CLI   CADSCODE(COMMREG),X'21'                             0621 01654000
         BE    @RT00621                                            0621 01655000
*                ELSE                  /* NOT BASIC OR IPLI           * 01656000
*                  CONTSW = '1'B;      /* INDICATE CONT FOLLOWS       * 01657000
*                                                                  0623 01658000
         OI    CONTSW,B'00010000'                                  0623 01659000
*              /* CHECK WHETHER OR NOT TO REMOVE CONTINUATION         * 01660000
*              /* CHARACTER                                           * 01661000
*              IF CADSCONT = '1'B & CARECFM = '0'B                 0624 01662000
*                THEN;                 /* CONT CHAR REMAINS           * 01663000
@RT00621 TM    CADSCONT(COMMREG),B'00001000'                       0624 01664000
         BNO   @RF00624                                            0624 01665000
         TM    CARECFM(COMMREG),B'01000000'                        0624 01666000
         BZ    @RT00624                                            0624 01667000
*                ELSE                  /* REMOVE CONT CHAR            * 01668000
*                  OUTLEN = OUTLEN - 1;  /* BACK UP LENGTH FOR LE     * 01669000
@RF00624 LH    @12,OUTLEN(,COMMREG)                                0626 01670000
         BCTR  @12,0                                               0626 01671000
         STH   @12,OUTLEN(,COMMREG)                                0626 01672000
*            END;                                                  0627 01673000
*          ELSE                        /* NO, CONT CHAR NOT PRESENT   * 01674000
*            CONTSW = '0'B;            /* TURN OFF CONT SWITCH        * 01675000
         B     @RC00619                                            0628 01676000
@RF00619 NI    CONTSW,B'11101111'                                  0628 01677000
*        LETXTPTR = ADDR (OUTLEN);     /* BUILD PARAMETER LIST FOR 0629 01678000
*                                         IKJEBELE POINT TO LINE TO BE  01679000
*                                         EDITED                      * 01680000
@RC00619 LA    @12,OUTLEN(,COMMREG)                                0629 01681000
         ST    @12,LETXTPTR                                        0629 01682000
*        OUTRESV = 0;                  /* ALWAYS ZERO                 * 01683000
         SLR   @12,@12                                             0630 01684000
         STH   @12,OUTRESV(,COMMREG)                               0630 01685000
*        LEFLAG = '00'X;               /* INIT FLAGS FOR IKJEBELE     * 01686000
         MVI   LEFLAG,X'00'                                        0631 01687000
*        LECAREA = COMMREG;            /* SET COMM AREA PTR FOR LE    * 01688000
*                                                                  0632 01689000
         ST    COMMREG,LECAREA                                     0632 01690000
*        /* CALL LINE EDITING ROUTINE                                 * 01691000
*        GENERATE REFS(COMMREG);                                   0633 01692000
         IKJEBESH (COMMREG),IKJEBELE,PARAM=((COMMREG),LEPARM),         X01693000
               MF=(E,SRWORK)                                            01694000
*        /* CHECK RETURN CODE FROM IKJEBELE                           * 01695000
*        IF RCODEREG = 0                                           0634 01696000
*          THEN;                       /* CODE 0, SUCCESSFUL          * 01697000
         LTR   RCODEREG,RCODEREG                                   0634 01698000
         BZ    @RT00634                                            0634 01699000
*          ELSE                        /* CODE 4 - LINE OVERFLOW      * 01700000
*            MSGSW1 = '1'B;            /* SET SW TO PUT OUT 'LINE  0636 01701000
*                                         TRUNCATED' MSG              * 01702000
         OI    MSGSW1,B'01000000'                                  0636 01703000
*        OUTKEY = FIRSTLN;             /* AT THIS POINT THE LINE IS     01704000
*                                         READY TO BE WRITTEN INTO THE  01705000
*                                         UTILITY DATA SET UPDATE  0637 01706000
*                                         RECORD KEY                  * 01707000
@RT00634 MVC   OUTKEY(4,COMMREG),FIRSTLN(COMMREG)                  0637 01708000
*        UTKEYPTR = ADDR (OUTLINE);    /* POINT TO OUTPUT RECORD      * 01709000
         LA    @12,OUTLINE(,COMMREG)                               0638 01710000
         ST    @12,UTKEYPTR                                        0638 01711000
*        UTOPTCD = '20'X;              /* SET WRITE OP CODE           * 01712000
         MVI   UTOPTCD,X'20'                                       0639 01713000
*        LBIT2 = '1'B;                 /* SET END-OF-PARMLIST         * 01714000
         OI    LBIT2,B'10000000'                                   0640 01715000
*        CALL IORTN;                   /* GO WRITE RECORD INTO UTIL     01716000
*                                         DATA SET                    * 01717000
*                                                                  0641 01718000
         BAL   @14,IORTN                                           0641 01719000
*        /* CHECK FOR SUCCESSFUL COMPLETION OF WRITE                  * 01720000
*        IF RCODEREG = 0                                           0642 01721000
*          THEN;                       /* I/O OK - CONTINUE           * 01722000
         LTR   RCODEREG,RCODEREG                                   0642 01723000
         BZ    @RT00642                                            0642 01724000
*          ELSE                        /* ERROR - RECORD NOT WRITTEN  * 01725000
*            DO;                                                   0644 01726000
*              GOTO EXIT2;             /* GO RETURN TO COMMAND MODE   * 01727000
         B     EXIT2                                               0645 01728000
*            END;                                                  0646 01729000
*        CACURNUM = OUTKEY;            /* CONTINUE PROCESSING HERE FOR  01730000
*                                         RET CODE=0 UPDATE CURRENT     01731000
*                                         LINE PTR                    * 01732000
@RT00642 L     @12,OUTKEY(,COMMREG)                                0647 01733000
         ST    @12,CACURNUM(,COMMREG)                              0647 01734000
*        CAIMLLNO = OUTKEY;            /* SAVE LAST LINE NUM IN COMM    01735000
*                                         AREA                        * 01736000
         ST    @12,CAIMLLNO(,COMMREG)                              0648 01737000
*        CAIMINPT = '1'B;              /*INDICATE LINE WRITTEN YA00040* 01738000
*                                                                  0649 01739000
         OI    CAIMINPT(COMMREG),B'00000010'                       0649 01740000
*        /* FOR TYPES IPLI OR BASIC OR IF THE SCAN SWITCH IS ON,      * 01741000
*        /* SYNTAX CHECKING MUST BE PERFORMED ON THE NEW INPUT LINE   * 01742000
*        IF CASCANSW = '1'B                                        0650 01743000
*          THEN                        /* SCAN SWITCH IS ON           * 01744000
         TM    CASCANSW(COMMREG),B'00010000'                       0650 01745000
         BO    @RT00650                                            0650 01746000
*            GOTO SYNSCAN;             /* GO SYNTAX CHECK THE LINE    * 01747000
*          ELSE                        /* SCAN NOT IN EFFECT          * 01748000
*                                                                  0652 01749000
*            /* SCAN NOT SPECIFIED CHECK FOR BASIC OR IPLI            * 01750000
*            IF CADSCODE = CABASIC | CADSCODE = CAIPLI             0652 01751000
*              THEN                    /* TYPE IS IPLI OR BASIC       * 01752000
         CLI   CADSCODE(COMMREG),X'20'                             0652 01753000
         BE    @RT00652                                            0652 01754000
         CLI   CADSCODE(COMMREG),X'21'                             0652 01755000
         BNE   @RF00652                                            0652 01756000
@RT00652 DS    0H                                                  0653 01757000
*                DO;                                               0653 01758000
*SYNSCAN:                              /* SYNTAX CHECKING ROTINE      * 01759000
*                                      /* PREPARE FOR SYNTAX CHECKING * 01760000
*                                                                  0654 01761000
*                  /* CHECK TO SEE IF CHECKER AVAILABLE               * 01762000
*                  IF CAPTCHK = 0 | SYNCKOFF = '1'B                0654 01763000
*                    THEN              /* CHECKER NOT AVAILABLE       * 01764000
SYNSCAN  ICM   @12,15,CAPTCHK(COMMREG)                             0654 01765000
         BZ    @RT00654                                            0654 01766000
         TM    SYNCKOFF,B'00001000'                                0654 01767000
         BO    @RT00654                                            0654 01768000
*                      GOTO NOCHKR;    /* SKIP SYNTAX CHECKING        * 01769000
*                    ELSE;             /* CHECKER IS AVAILABLE        * 01770000
*                  PARMREG1 = ADDR (OUTLINE); /* POINT TO LINE TO BE    01771000
*                                                SYNTAX CHECKED       * 01772000
         LA    PARMREG1,OUTLINE(,COMMREG)                          0657 01773000
*                  SYNCKSW = '1'B;     /* INDICATE SYN CHKR CALLED    * 01774000
         OI    SYNCKSW,B'10000000'                                 0658 01775000
*                  CALL SYNCHK;        /* GO SYNTAX SCAN THE LINE     * 01776000
         BAL   @14,SYNCHK                                          0659 01777000
*                END;                                              0660 01778000
*              ELSE;                   /* TYPE IS NOT IPLI OB BASIC   * 01779000
@RF00652 DS    0H                                                  0662 01780000
*NOCHKR:                               /* SYNTAX CHECKER NOT AVABLE   * 01781000
*                                                                  0662 01782000
*        /* CHECK FOR LINE OVERFLO  MSG                               * 01783000
*        IF MSGSW1 = '1'B                                          0662 01784000
*          THEN                        /* YES A MSG IS TO BE SENT     * 01785000
NOCHKR   TM    MSGSW1,B'01000000'                                  0662 01786000
         BNO   @RF00662                                            0662 01787000
*                                      /* MESSAGE TO BE SENT          * 01788000
*            DO;                                                   0663 01789000
*              MSGSW1 = '0'B;          /* TURN OFF MSG SWITCH         * 01790000
         NI    MSGSW1,B'10111111'                                  0664 01791000
*              INSREC1 = MSGNUM2;      /* MOVE MODEL TO WORKAREA      * 01792000
*                                                                  0665 01793000
         MVC   INSREC1(11),MSGNUM2                                 0665 01794000
*              /* CHECK IF DATA SET IS LINE NUMBERED                  * 01795000
*              IF CANONUM = '0'B                                   0666 01796000
*                THEN                  /* DATA SET IS LINE NUMBERED   * 01797000
         TM    CANONUM(COMMREG),B'00000001'                        0666 01798000
         BNZ   @RF00666                                            0666 01799000
*                                      /* CONVERT LINE NUMBER         * 01800000
*                  DO;                                             0667 01801000
*                    CVDREG = OUTKEY;  /* LOAD NUMBER TO BE CONVERT   * 01802000
         L     CVDREG,OUTKEY(,COMMREG)                             0668 01803000
*                    CALL CVDRTN;      /* GO CONVERT LINE NUM         * 01804000
         BAL   @14,CVDRTN                                          0669 01805000
*                    INSREC = MSGNUM1; /* MOVE EXPANDED INSERTION  0670 01806000
*                                         RECORD TO DYNAMIC CORE      * 01807000
*                                                                  0670 01808000
         MVC   INSREC(16),MSGNUM1                                  0670 01809000
*                    /* THIS DO LOOP LOCATES THE FIRST NON-ZERO       * 01810000
*                    /* BYTE OF THE NUMBER TO BE SENT TO THE          * 01811000
*                    /* TERMINAL. IT SCANS FROM LEFT TO RIGHT         * 01812000
*                    DO WREG2 = 1 TO LENGTH (NUMTEMP1) BY 1;    /*9178* 01813000
         LA    WREG2,1                                             0671 01814000
@DL00671 DS    0H                                                  0672 01815000
*                      /* CHECK CURRENT CHAR. FOR DECIMAL ZERO        * 01816000
*                      IF NUMTEMP1 (WREG2) = '0'        /*     ZA29178* 01817000
*                        THEN;         /* ZERO - CONTINUE LOOP        * 01818000
         LA    @12,NUMTEMP1-1(WREG2)                               0672 01819000
         CLI   0(@12),C'0'                                         0672 01820000
         BNE   @RF00672                                            0672 01821000
*                        ELSE          /* NOT ZERO - EXIT             * 01822000
*                          GOTO LPOUT; /* EXIT FROM LOOP              * 01823000
*                    END;              /* WREG2 CONTAINS THE OFFSET   * 01824000
         AH    WREG2,@CH00051                                      0675 01825000
         CH    WREG2,@CH00049                                      0675 01826000
         BNH   @DL00671                                            0675 01827000
*                    WREG2 = LENGTH (NUMTEMP1); /* RESET VALUE ZA29178  01828000
*                                          TO MAX LENGTH       ZA29178* 01829000
*                                                                  0676 01830000
         LA    WREG2,8                                             0676 01831000
*LPOUT: ;                              /* CONTINUE                    * 01832000
LPOUT    DS    0H                                                  0678 01833000
*                    /* FIND LENGTH OF NUMBER                         * 01834000
*                    WREG1 = LENGTH (INSNUM) + 1 - WREG2;          0678 01835000
*                                                                  0678 01836000
         LA    WREG1,9                                             0678 01837000
         SLR   WREG1,WREG2                                         0678 01838000
*                    /* MOVE NONZERO PORTION OF NUMBER TO INSERTION   * 01839000
*                    /* RECORD                                        * 01840000
*                    INSNUM (1:WREG1) =                            0679 01841000
*                        NUMTEMP (WREG2:LENGTH (NUMTEMP));         0679 01842000
         LR    @12,WREG1                                           0679 01843000
         BCTR  @12,0                                               0679 01844000
         LA    @08,NUMTEMP-1(WREG2)                                0679 01845000
         EX    @12,@SM01400                                        0679 01846000
*                    INSLEN = WREG1 + 4;      /* FIND LENGTH FOR   0680 01847000
*                                                INSERTION            * 01848000
         LA    @12,4(,WREG1)                                       0680 01849000
         STH   @12,INSLEN                                          0680 01850000
*                    WREG2 = ADDR (INSREC); /* POINT TO LEVEL-1 INSERT* 01851000
         LA    WREG2,INSREC                                        0681 01852000
*LNTRMSG:                              /* LENGTH MESSAGE              * 01853000
*                    CVDREG = CALRECL - 4;    /* LOAD MAX REC LENGTH TO 01854000
*                                             INSERT IN LEVEL-2 MSG   * 01855000
LNTRMSG  LH    CVDREG,CALRECL(,COMMREG)                            0682 01856000
         SH    CVDREG,@CH00389                                     0682 01857000
*                    CALL CVDRTN;      /* CONVERT REG LENGTH TO DEC   * 01858000
*                                                                  0683 01859000
         BAL   @14,CVDRTN                                          0683 01860000
*                    /* MOVE MAX RECORD LEN LEVEL 2 INSERTION         * 01861000
*                    INSNUM1 (1:3) = NUMTEMP (6:8);                0684 01862000
         MVC   INSNUM1(3),NUMTEMP+5                                0684 01863000
*                    LEV1INS = WREG2;  /* POINT TO LEVEL-1 INSERTION  * 01864000
         LR    LEV1INS,WREG2                                       0685 01865000
*                    RELMSG1 = 1293;   /* LOAD MESSAGE NUMBER         * 01866000
         MVC   RELMSG1(2),@CH01335                                 0686 01867000
*                    RELMSG2 = 1;      /* LOAD REL SECOND LEVEL NUM   * 01868000
         MVC   RELMSG2(2),@CH00051                                 0687 01869000
*                    LEV2INS = ADDR (INSREC1); /* POINT TO LEV-2 INS  * 01870000
         LA    LEV2INS,INSREC1                                     0688 01871000
*                    CALL MSGRTN;      /* PUT OUT MSG                 * 01872000
         BAL   @14,MSGRTN                                          0689 01873000
*                  END;                /* PUT ERROR MSG OUT TO     0690 01874000
*                                         TERMINAL - LINE TRUNCATED   * 01875000
*                ELSE                  /* DATA SET IS NOT LINE NUMRD    01876000
*                                         PUT OUT SAME MSGS AS ABOVE    01877000
*                                         BUT WITHOUT LINE NUMBER     * 01878000
*                                      /* NO LINE NUMBERS             * 01879000
*                  DO;                                             0691 01880000
         B     @RC00666                                            0691 01881000
@RF00666 DS    0H                                                  0692 01882000
*                    WREG2 = 0;        /* INDICATE NO LINE NUMBER     * 01883000
         SLR   WREG2,WREG2                                         0692 01884000
*                    GOTO LNTRMSG;     /* GO PUT OUT MESSAGE          * 01885000
         B     LNTRMSG                                             0693 01886000
*                  END;                                            0694 01887000
*            END;                                                  0695 01888000
*                                                                  0695 01889000
@RC00666 DS    0H                                                  0696 01890000
*        /* CHECK FOR ATTENTION ENTERED FROM TERMINAL                 * 01891000
*        IF CAATTNIS = '1'B                                        0696 01892000
*          THEN                        /* YES - ATTN WAS ENTERED      * 01893000
@RF00662 TM    CAATTNIS(COMMREG),B'01000000'                       0696 01894000
         BO    @RT00696                                            0696 01895000
*            GOTO EXIT2;               /* TERMINATE INPUT             * 01896000
*          ELSE;                       /* NO - CONTINUE PROCESSING    * 01897000
*                                                                  0698 01898000
*        /* THE FOLLOWING CODE COMPUTES THE LINE NUMBER FOR THE       * 01899000
*        /* NEXT INPUT LINE AND STORES IT IN 'FIRSTLN'.  CHECK FOR    * 01900000
*        /* R-FORM                                                    * 01901000
*        IF CAIMIR = '1'B                                          0699 01902000
*          THEN                        /* NO R-FORM NOT SPECIFIED     * 01903000
         TM    CAIMIR(COMMREG),B'00010000'                         0699 01904000
         BNO   @RF00699                                            0699 01905000
*            DO;                                                   0700 01906000
*                                      /* CUMPUTE NEXT RECORD NUMBER  * 01907000
*              FIRSTLN = FIRSTLN + CAIMLINC; /* COMPUTE NEXT RECORD     01908000
*                                               NUM                   * 01909000
         L     @12,FIRSTLN(,COMMREG)                               0701 01910000
         AL    @12,CAIMLINC(,COMMREG)                              0701 01911000
         ST    @12,FIRSTLN(,COMMREG)                               0701 01912000
*              GOTO MAINLP;            /* GO BACK TO GET NEXT RECORD  * 01913000
         B     MAINLP                                              0702 01914000
*            END;                                                  0703 01915000
*          ELSE;                       /* YES R-FORM SPECIFIED        * 01916000
*                                                                  0704 01917000
@RF00699 DS    0H                                                  0705 01918000
*        /* CHECK FOR INCREMENT SPECIFIED                             * 01919000
*        IF CAIMCIN = '1'B                                         0705 01920000
*          THEN                        /* YES INCREMENT SPECIFIED     * 01921000
         TM    CAIMCIN(COMMREG),B'00001000'                        0705 01922000
         BNO   @RF00705                                            0705 01923000
*            DO;                                                   0706 01924000
*              UTOPTCD = '02'X;        /* SET FOR READ NEXT           * 01925000
         MVI   UTOPTCD,X'02'                                       0707 01926000
*              UTKEYPTR = ADDR( FIRSTLN); /* POINT TO CURRENT LINE    * 01927000
         LA    @12,FIRSTLN(,COMMREG)                               0708 01928000
         ST    @12,UTKEYPTR                                        0708 01929000
*              LBIT2 = '1'B;           /* SET END-OF-PARM INDICATOR   * 01930000
         OI    LBIT2,B'10000000'                                   0709 01931000
*              CALL IORTN;             /* READ NEXT RECORD            * 01932000
*                                                                  0710 01933000
         BAL   @14,IORTN                                           0710 01934000
*              /* CHECK IF END OF DATA REACHED                        * 01935000
*              IF EODSW = '0'B                                     0711 01936000
*                THEN                  /* NO, SET NEW 'NEXTREC'       * 01937000
         TM    EODSW,B'00100000'                                   0711 01938000
         BNZ   @RF00711                                            0711 01939000
*                  NEXTREC = INKEY;    /* SET NEW NEXT RECORD KEY     * 01940000
         MVC   NEXTREC(4,COMMREG),INKEY(UTPREG1)                   0712 01941000
*              FIRSTLN = FIRSTLN + CAIMLINC; /* UPDATE NEW CURRENT REC* 01942000
@RF00711 L     @12,FIRSTLN(,COMMREG)                               0713 01943000
         AL    @12,CAIMLINC(,COMMREG)                              0713 01944000
         ST    @12,FIRSTLN(,COMMREG)                               0713 01945000
*              GO TO MAINLP;           /* CONTINUE PROCESSING         * 01946000
         B     MAINLP                                              0714 01947000
*            END;                                                  0715 01948000
*          ELSE;                       /* NO INCREMENT NOT SPECIFIED  * 01949000
@RF00705 DS    0H                                                  0717 01950000
*        UTOPTCD = '02'X;              /* AT THIS POINT INPUT IS   0717 01951000
*                                         REPLACING THE EXISTING LINES  01952000
*                                         IN THE DATA SET          0717 01953000
*                                         LINE-BY-LINE.  THE NEXT LINE  01954000
*                                         NUMBER IS FOUND BY ISSUING A  01955000
*                                         READ NEXT.  SET OP CODE FOR   01956000
*                                         IKJEBEUT TO READ NEXT       * 01957000
         MVI   UTOPTCD,X'02'                                       0717 01958000
*        UTKEYPTR = ADDR (FIRSTLN);    /* POINT TO KEY OF CURRENT  0718 01959000
*                                         RECORD                      * 01960000
         LA    @12,FIRSTLN(,COMMREG)                               0718 01961000
         ST    @12,UTKEYPTR                                        0718 01962000
*        LBIT2 = '1'B;                 /* SET END-OF-PARMLIST         * 01963000
         OI    LBIT2,B'10000000'                                   0719 01964000
*        CALL IORTN;                   /* GO GET NEXT RECORD FROM  0720 01965000
*                                         UTILITY DATA SET            * 01966000
*                                                                  0720 01967000
         BAL   @14,IORTN                                           0720 01968000
*        /* CHECK FOR END-OF-DATA                                     * 01969000
*        IF EODSW = '1'B                                           0721 01970000
*          THEN                        /* EOD REACHED ON UTIL DS      * 01971000
         TM    EODSW,B'00100000'                                   0721 01972000
         BNO   @RF00721                                            0721 01973000
*            DO;                                                   0722 01974000
*              CAIMIR = '1'B;          /* TURN OFF R SWITCH           * 01975000
         OI    CAIMIR(COMMREG),B'00010000'                         0723 01976000
*              FIRSTLN = FIRSTLN + CAIMLINC; /* COMPUTE NEXT LINE NUM * 01977000
         L     @12,FIRSTLN(,COMMREG)                               0724 01978000
         AL    @12,CAIMLINC(,COMMREG)                              0724 01979000
         ST    @12,FIRSTLN(,COMMREG)                               0724 01980000
*              GOTO MAINLP;            /* GO BEGIN AUTO LINE PROMPT   * 01981000
         B     MAINLP                                              0725 01982000
*            END;                                                  0726 01983000
*          ELSE;                       /* EOD NOT REACHED ON UTIL DS  * 01984000
@RF00721 DS    0H                                                  0728 01985000
*        DO;                                                       0728 01986000
*          FIRSTLN = INKEY;            /* SET FIRST LINE NUMBER       * 01987000
         MVC   FIRSTLN(4,COMMREG),INKEY(UTPREG1)                   0729 01988000
*          GOTO MAINLP;                /* SEND NEXT LINE NUMBER       * 01989000
         B     MAINLP                                              0730 01990000
*        END;                                                      0731 01991000
*EXIT2:                                /* EXIT ROUTINE                * 01992000
*        IF CAATTNIS = '0'B            /* ISSUE TCLEARQ ONLY IFYA02023* 01993000
*          THEN IF CCODE = 16 |        /* NO ATTENTION AND     YA02023* 01994000
EXIT2    TM    CAATTNIS(COMMREG),B'01000000'                       0732 01995000
         BNZ   @RF00732                                            0732 01996000
*                  CCODE = 0           /* RETURN CODE=0 OR 16  YA02023* 01997000
*          THEN GEN (TCLEARQ INPUT);   /* CLEAR INPUT LINES    YA02023* 01998000
         LH    @12,CCODE                                           0733 01999000
         CH    @12,@CH00228                                        0733 02000000
         BE    @RT00733                                            0733 02001000
         LTR   @12,@12                                             0733 02002000
         BNZ   @RF00733                                            0733 02003000
@RT00733 DS    0H                                                  0734 02004000
         TCLEARQ INPUT                                                  02005000
*          ELSE;                       /*                      YA02023* 02006000
@RF00733 DS    0H                                                  0736 02007000
*          ELSE;                       /*                      YA02023* 02008000
@RF00732 DS    0H                                                  0737 02009000
*EXIT1:                                /*                      YA02023* 02010000
*        CAIMSC = '0'B;                /* TURN OFF SUBCMD SWITCH      * 02011000
*                                                                  0737 02012000
EXIT1    NI    CAIMSC(COMMREG),B'11011111'                         0737 02013000
*        /* CHECK FOR SYNCHK ROUTINE BEING CALLED                     * 02014000
*        IF SYNCKSW = '1'B                                         0738 02015000
*          THEN                        /* YES IT WAS CALLED           * 02016000
         TM    SYNCKSW,B'10000000'                                 0738 02017000
         BNO   @RF00738                                            0738 02018000
*                                      /* CHECK FOR REMAINING RECORDS * 02019000
*            DO;                                                   0739 02020000
*                                                                  0739 02021000
*              /* CHECK FOR REMAINING RECORDS TO BE SENT TO THE       * 02022000
*              /* SYNTAX CHECKER                                      * 02023000
*              IF CONTSW = '1'B                                    0740 02024000
*                THEN                  /* YES CLEAN-UP NEEDED         * 02025000
         TM    CONTSW,B'00010000'                                  0740 02026000
         BNO   @RF00740                                            0740 02027000
*                  DO;                                             0741 02028000
*                    PARMREG1 = 0;     /* INDICATE CLEAN-UP           * 02029000
         SLR   PARMREG1,PARMREG1                                   0742 02030000
*                    CALL SYNCHK;      /* GO TO SYNTAX CHECKER        * 02031000
         BAL   @14,SYNCHK                                          0743 02032000
*                  END;                                            0744 02033000
*                ELSE;                 /* NO, CLEAN-UP NOT NEEDED     * 02034000
@RF00740 DS    0H                                                  0746 02035000
*              FMLIST = FMPRMLST;      /* MOVE L-FORM OF FREEMAIN     * 02036000
         MVC   FMLIST(10),FMPRMLST                                 0746 02037000
*              FMADDR = SNBFRPT;       /* POINT TO LAST SYNCHK BFR    * 02038000
         L     @12,SNBFRPT                                         0747 02039000
         ST    @12,FMADDR                                          0747 02040000
*              FMLEN = SNBFRPT -> BUFLEN; /* GET BUFFER LENGTH        * 02041000
*                                                                  0748 02042000
         LH    @12,BUFLEN(,@12)                                    0748 02043000
         ST    @12,FMLEN                                           0748 02044000
*              /* FREE CHECKER BUFFER                                 * 02045000
*              GEN (FREEMAIN A=FMPARM,MF=(E,FMLIST));              0749 02046000
         FREEMAIN A=FMPARM,MF=(E,FMLIST)                                02047000
*            END;                                                  0750 02048000
*          ELSE;                       /* NO, CONTIN NOT EXPECTED     * 02049000
*                                                                  0751 02050000
@RF00738 DS    0H                                                  0752 02051000
*        /* CHECK FOR ENTRY FROM INSERT SUBCOMMAND                    * 02052000
*        IF CAIMINS = '1'B                                         0752 02053000
*          THEN                        /* YES, ENTRY FROM INSERT      * 02054000
         TM    CAIMINS(COMMREG),B'01000000'                        0752 02055000
         BNO   @RF00752                                            0752 02056000
*            CAIMLINC = SAVEINCR;      /* RESTORE LAST USED INCRMNT   * 02057000
         MVC   CAIMLINC(4,COMMREG),SAVEINCR(COMMREG)               0753 02058000
*          ELSE;                       /* NO, ENTRY NOT FROM INSERT   * 02059000
@RF00752 DS    0H                                                  0755 02060000
*        CAIMFLG (2:6) = '0000000'B;   /* TURN OFF FLAGS       YA00040* 02061000
*                                                                  0755 02062000
         NI    CAIMFLG(COMMREG),B'10000011'                        0755 02063000
*        /* CHECK IF AUTOMATIC LINE PROMPTING IN EFFECT               * 02064000
*        IF CAPROMPT = '1'B                                        0756 02065000
*          THEN                        /* YES, STOP AUTO PROMPTING    * 02066000
         TM    CAPROMPT(COMMREG),B'00100000'                       0756 02067000
         BNO   @RF00756                                            0756 02068000
*            GEN (SPAUTOPT);           /* ISSUE STOP PROMPTING MACRO  * 02069000
*                                                                  0757 02070000
         SPAUTOPT                                                       02071000
*        /* CHECK IF ATTENTION WAS ISSUED                             * 02072000
*        IF CAATTNIS = '0'B                                        0758 02073000
*          THEN                        /* NO, MODE MSG NOT ALREADY OUT* 02074000
@RF00756 TM    CAATTNIS(COMMREG),B'01000000'                       0758 02075000
         BNZ   @RF00758                                            0758 02076000
*            CAMODMSG = '1'B;          /* INDICATE MODE MESSAGE IS TO   02077000
*                                         GO TO THE TERMINAL FROM MA  * 02078000
         OI    CAMODMSG(COMMREG),B'00010000'                       0759 02079000
*        RCODEREG = CCODE;             /* SET RETURN CODE             * 02080000
@RF00758 LH    RCODEREG,CCODE                                      0760 02081000
*        RETREG = CONTPTR;             /* RESTORE RETURN POINT PTR    * 02082000
         L     RETREG,CONTPTR                                      0761 02083000
*        RETURN;                       /* RETURN TO COMMAND MODE      * 02084000
@EL00007 DS    0H                                                  0762 02085000
@EF00007 DS    0H                                                  0762 02086000
@ER00007 BR    @14                                                 0762 02087000
*        END CONTRTN;                      /*       END OF CONTRTN    * 02088000
*SYNCHK:                                                           0764 02089000
*        /* ********************************************************* * 02090000
*        /* THIS ROUTINE TAKES A NEW INPUT LINE AND PASSES IT ALONG   * 02091000
*        /* WITH ANY CONTINUATION LINES TO THE APPROPRIATE SYNTAX     * 02092000
*        /* CHECKER. IT GETS CORE FOR ALL REQUIRED BUFFERS AND        * 02093000
*        /* CHAINS THE BUFFERS TOGETHER. IT ALSO EXAMINES THE         * 02094000
*        /* RETURN CODE FROM THE SYNTAX CHECKER AND HANDLES ANY       * 02095000
*        /* NON-ZERO CONDITIONS. INPUT PARMREG1 POINTS TO NEW INPUT   * 02096000
*        /* LINE (INCLUDING THE KEY) IT IS SET TO ZERO TO TELL        * 02097000
*        /* SYNCHK TO PASS ANY LINES IT CURRENTLY HAS IN A BUFFER     * 02098000
*        /* TO THE SYNTAX CHECKER. NO RETURN CODE IS PASSED BACK TO   * 02099000
*        /* THE CALLING ROUTINE AS ALL ERROR CONDITIONS ARE HANDLED   * 02100000
*        /* LOCALLY.                                                  * 02101000
*        /* ********************************************************* * 02102000
*        PROC (Q) OPTIONS (NOSAVE, NOSAVEAREA);                    0764 02103000
SYNCHK   MVC   @PC00008(4),0(@01)                                  0764 02104000
*        /* THE FOLLOWING REGISTERS ARE RESTRICTED FOR THE DURATION   * 02105000
*        /* OF INPUT                                                  * 02106000
*        RESPECIFY (PARMREG1, WREG1, WREG2, COMMREG, SAVEREG, DATAREG,  02107000
*            BASEREG) RSTD;                                        0765 02108000
*        SYNPTR = RETREG;             /* SAVE RETURN POINT PTR        * 02109000
*                                                                  0766 02110000
         ST    RETREG,SYNPTR                                       0766 02111000
*        /* CHECK THE PARM REG TO SEE IF A NEW LINE IS PRESENT        * 02112000
*        IF PARMREG1 = 0                                           0767 02113000
*          THEN                        /* NO, NEW LINE NOT PRESENT.     02114000
*                                         PASS ANY COLLECTED LINES TO   02115000
*                                         SYNTAX CHECKER              * 02116000
         SLR   @12,@12                                             0767 02117000
         CR    PARMREG1,@12                                        0767 02118000
         BE    @RT00767                                            0767 02119000
*            GOTO NOLINE;              /* GO CLEAN UP                 * 02120000
*          ELSE;                       /* YES, NEW LINE IS PRESENT    * 02121000
*        INPTR = PARMREG1;             /* SAVE PTR TO LINE            * 02122000
         LR    INPTR,PARMREG1                                      0770 02123000
*        CODE8SW = '0'B;               /* TURN OFF RET CODE 8 SWITCH  * 02124000
*                                                                  0771 02125000
         NI    CODE8SW,B'10111111'                                 0771 02126000
*        /* SEE IF BUFFERS WERE PREVIOUSLY ACQUIRED                   * 02127000
*        IF SNBFRPT = 0                                            0772 02128000
*          THEN                        /* NO, BUFFER HAS NOT BEEN  0772 02129000
*                                         ACQUIRED                    * 02130000
         SLR   @08,@08                                             0772 02131000
         C     @08,SNBFRPT                                         0772 02132000
         BNE   @RF00772                                            0772 02133000
*                                      /* GET CORE                    * 02134000
*            DO;                                                   0773 02135000
*              LENPTR = ADDR (GMPARM); /* INIT PARM LIST FOR GETMAIN  * 02136000
         LA    @08,GMPARM                                          0774 02137000
         ST    @08,LENPTR                                          0774 02138000
*              ADDRPTR = ADDR (GMDATA);/* POINT TO ADDR LIST          * 02139000
*                                                                  0775 02140000
         LA    @08,GMDATA                                          0775 02141000
         ST    @08,ADDRPTR                                         0775 02142000
*              /* ISSUE GETMAIN FOR FIRST BUFFER                      * 02143000
*              GEN (GETMAIN VC,SP=1,MF=(E,GMPRMLST));              0776 02144000
*                                                                  0776 02145000
         GETMAIN VC,SP=1,MF=(E,GMPRMLST)                                02146000
*              /* CHECK FOR SUCCESSFUL COMPLETION                     * 02147000
*              IF RCODEREG = 0                                     0777 02148000
*                THEN;                 /* SUCCESSFUL CONTINUE         * 02149000
         LTR   RCODEREG,RCODEREG                                   0777 02150000
         BZ    @RT00777                                            0777 02151000
*                ELSE                  /* UNSUCCESSFUL, DIAGNOSE      * 02152000
*                  DO;                                             0779 02153000
*NOCOREMG:                             /* ISSUE NO CORE AVAILABLE MSG * 02154000
*                    RELMSG1 = 270;    /* LOAD MSG NUMBER             * 02155000
NOCOREMG MVC   RELMSG1(2),@CH01250                                 0780 02156000
*                    RELMSG2 = 0;      /* LOAD REL LEV-2 NUMBER       * 02157000
         SLR   @12,@12                                             0781 02158000
         STH   @12,RELMSG2                                         0781 02159000
*                    LEV1INS = ADDR (INSM25); /* POINT TO LEV-1 INSERT* 02160000
         LA    LEV1INS,INSM25                                      0782 02161000
*                    LEV2INS = 0;      /* INDICATE NO LEV-2 INSERT    * 02162000
         SLR   LEV2INS,LEV2INS                                     0783 02163000
*                    CALL MSGRTN;      /* PUT OUT MSG                 * 02164000
         BAL   @14,MSGRTN                                          0784 02165000
*                    CCODE=8;          /* INDICATE FLUSH NEEDED       * 02166000
         MVC   CCODE(2),@CH00049                                   0785 02167000
*                    SYNCKOFF = '1'B;  /* STOP FURTHER SYNTX CHKING   * 02168000
         OI    SYNCKOFF,B'00001000'                                0786 02169000
*                    SYNCKSW = '0'B;   /* SUPPRESS FINAL FREEMAIN     * 02170000
         NI    SYNCKSW,B'01111111'                                 0787 02171000
*                    GOTO SNEXIT;      /* RETURN TO COMMAND MODE      * 02172000
         B     SNEXIT                                              0788 02173000
*                  END;                                            0789 02174000
*              SNBFRPT = GMADDR;       /* THIS CODE INITIALIZES FOR     02175000
*                                         THE FIRST BUFFER.  SAVE ADDR  02176000
*                                         OF BUFFER                   * 02177000
@RT00777 L     @08,GMADDR                                          0790 02178000
         ST    @08,SNBFRPT                                         0790 02179000
*              SNCURBF = GMADDR;       /* POINT TO CURRENT BUFFER     * 02180000
         ST    @08,SNCURBF                                         0791 02181000
*              SNCURPOS = 8 + GMADDR;     /* PT TO FIRST AVAIL BYTE   * 02182000
         LA    @00,8                                               0792 02183000
         ALR   @00,@08                                             0792 02184000
         ST    @00,SNCURPOS                                        0792 02185000
*              BUFLEN = GMLEN;         /* SAVE LENGTH WITH BUFFER     * 02186000
         MVC   BUFLEN(2,@08),GMLEN+2                               0793 02187000
*              RECNUM = 0;             /* RESET RECORD COUNT          * 02188000
         MVI   RECNUM(@08),X'00'                                   0794 02189000
*              NEXTBFR = 0;            /* INDICATE LAST BUFFER        * 02190000
         SLR   @00,@00                                             0795 02191000
         STCM  @00,7,NEXTBFR(@08)                                  0795 02192000
*            END;                                                  0796 02193000
*          ELSE;                       /* YES,BUFFER WAS ACQUIRED     * 02194000
*                                                                  0797 02195000
@RF00772 DS    0H                                                  0798 02196000
*        /* CHECK TO SEE IF NEW RECORD CAN FIT IN CURRENT BUFFER      * 02197000
*        IF SNCURBF + BUFLEN - SNCURPOS < NEWLEN                   0798 02198000
*          THEN                        /* LINE WILL NOT FIT IN BFR    * 02199000
         L     @08,SNCURBF                                         0798 02200000
         LH    @00,BUFLEN(,@08)                                    0798 02201000
         ALR   @00,@08                                             0798 02202000
         SL    @00,SNCURPOS                                        0798 02203000
         CH    @00,NEWLEN(,INPTR)                                  0798 02204000
         BNL   @RF00798                                            0798 02205000
*                                      /* LINE TOO LARGE              * 02206000
*            DO;                                                   0799 02207000
*              LENPTR = ADDR (GMPARM); /* POINT TO RANGE LIST         * 02208000
         LA    @08,GMPARM                                          0800 02209000
         ST    @08,LENPTR                                          0800 02210000
*              ADDRPTR = ADDR (GMDATA);/* POINT TO ADDR LIST          * 02211000
*                                                                  0801 02212000
         LA    @08,GMDATA                                          0801 02213000
         ST    @08,ADDRPTR                                         0801 02214000
*              /* GET CORE FOR NEW BUFFER                             * 02215000
*              GEN (GETMAIN VC,SP=1,MF=(E,GMPRMLST));              0802 02216000
*                                                                  0802 02217000
         GETMAIN VC,SP=1,MF=(E,GMPRMLST)                                02218000
*              /* CHECK RETURN CODE  FROM GETMAIN                     * 02219000
*              IF RCODEREG = 0                                     0803 02220000
*                THEN;                 /* SUCCESSFUL, CONTINUE        * 02221000
         SLR   @14,@14                                             0803 02222000
         CR    RCODEREG,@14                                        0803 02223000
         BNE   @RF00803                                            0803 02224000
*                ELSE                  /* UNSUCESSFUL GETMAIN         * 02225000
*                  GOTO NOCOREMG;      /* GO PUT OUT ERROR MSG        * 02226000
*              SNCURPOS = GMADDR + 8;   /* SET CURRENT LINE PTR       * 02227000
         L     @08,GMADDR                                          0806 02228000
         LA    @15,8                                               0806 02229000
         LR    @00,@08                                             0806 02230000
         ALR   @00,@15                                             0806 02231000
         ST    @00,SNCURPOS                                        0806 02232000
*              SNCURBF -> NEXTBFR = GMADDR + 4;   /* CHAIN PREVIOUS     02233000
*                                                    BUFFER TO CURRENT  02234000
*                                                    ONE              * 02235000
         LA    @00,4                                               0807 02236000
         ALR   @00,@08                                             0807 02237000
         L     @05,SNCURBF                                         0807 02238000
         STCM  @00,7,NEXTBFR(@05)                                  0807 02239000
*              SNCURBF = GMADDR;       /* UPDATE CURRENT BFR PTR      * 02240000
         ST    @08,SNCURBF                                         0808 02241000
*              BUFLEN = GMLEN;         /* STORE BUFFER LENGTH         * 02242000
         L     @00,GMLEN                                           0809 02243000
         STH   @00,BUFLEN(,@08)                                    0809 02244000
*              RECNUM = 0;             /* INIT RECORD COUNT           * 02245000
         MVI   RECNUM(@08),X'00'                                   0810 02246000
*              NEXTBFR = 0;            /* INDICATE LAST BUFFER        * 02247000
*                                                                  0811 02248000
         STCM  @14,7,NEXTBFR(@08)                                  0811 02249000
*              /* FIND OUT IF NEXT INPUT LINE WILL FIT IN NEW         * 02250000
*              /* BUFFER                                              * 02251000
*              IF NEWLEN > BUFLEN - 8                              0812 02252000
*                THEN                  /* NO, LINE WILL NOT FIT       * 02253000
         SLR   @00,@15                                             0812 02254000
         CH    @00,NEWLEN(,INPTR)                                  0812 02255000
         BL    @RT00812                                            0812 02256000
*                  GOTO NOCOREMG;      /* GO PUT OUT MSG              * 02257000
*                ELSE;                 /* YES, LINE WILL FIT          * 02258000
*            END;                                                  0815 02259000
*          ELSE;                       /* YES LINE WILL FIT IN CURRENT  02260000
*                                         BUFFER                      * 02261000
*                                                                  0816 02262000
@RF00798 DS    0H                                                  0817 02263000
*        /* AT THIS POINT THE NEW LINE CAN BE PUT IN THE BUFFER FOR   * 02264000
*        /* FIXED LENGTH RECORDS, DO NOT INCLUDE THE LL00 FIELD       * 02265000
*        IF CARECFM = '1'B                                         0817 02266000
*          THEN                        /* FORMAT IS FIXED             * 02267000
         TM    CARECFM(COMMREG),B'01000000'                        0817 02268000
         BNO   @RF00817                                            0817 02269000
*            DO;                                                   0818 02270000
*              BUFLINE (1:NEWLEN - 4) = NEWDATA;    /* MOVE NEWLINE INT 02271000
*                                                      BUFFER         * 02272000
         L     @08,SNCURPOS                                        0819 02273000
         LH    @15,NEWLEN(,INPTR)                                  0819 02274000
         LR    @14,@15                                             0819 02275000
         SH    @14,@CH00124                                        0819 02276000
         EX    @14,@SM01411                                        0819 02277000
*              SNCURPOS = SNCURPOS + NEWLEN - 4;    /* UPDATE POSITION  02278000
*                                                      PTR            * 02279000
         ALR   @08,@15                                             0820 02280000
         SH    @08,@CH00389                                        0820 02281000
         ST    @08,SNCURPOS                                        0820 02282000
*            END;                                                  0821 02283000
*          ELSE                        /* FORMAT IS VARIABLE          * 02284000
*            DO;                                                   0822 02285000
         B     @RC00817                                            0822 02286000
@RF00817 DS    0H                                                  0823 02287000
*              BUFLINE (1:NEWLEN) = NEWLINE (5:4+NEWLEN); /* MOVE NEW   02288000
*                                                   LINE TO BFR       * 02289000
         L     @08,SNCURPOS                                        0823 02290000
         LH    @15,NEWLEN(,INPTR)                                  0823 02291000
         LR    @14,@15                                             0823 02292000
         BCTR  @14,0                                               0823 02293000
         EX    @14,@SM01413                                        0823 02294000
*              SNCURPOS = SNCURPOS + NEWLEN; /* UPDATE POSTION PTR    * 02295000
         ALR   @08,@15                                             0824 02296000
         ST    @08,SNCURPOS                                        0824 02297000
*            END;                                                  0825 02298000
*        RECNUM = RECNUM + 1;          /* INCREMENT RECORD COUNT      * 02299000
*                                                                  0826 02300000
@RC00817 L     @12,SNCURBF                                         0826 02301000
         LA    @08,1                                               0826 02302000
         SLR   @00,@00                                             0826 02303000
         IC    @00,RECNUM(,@12)                                    0826 02304000
         ALR   @08,@00                                             0826 02305000
         STC   @08,RECNUM(,@12)                                    0826 02306000
*        /* CHECK FOR CONTINUATION POSSIBILITY AT THIS POINT          * 02307000
*        IF CONTSW = '1'B                                          0827 02308000
*          THEN                        /* YES CONT INDICATED          * 02309000
         TM    CONTSW,B'00010000'                                  0827 02310000
         BO    @RT00827                                            0827 02311000
*            GOTO SYNEXIT;             /* GET NEXT RECORD             * 02312000
*          ELSE;                       /* NO CONT RECORD              * 02313000
*NOLINE:                               /* NO MORE LINES            0830 02314000
*                                         AT THIS POINT THE        0830 02315000
*                                         ACCUMULATED RECORDS MUST BE   02316000
*                                         SENT TO THE CHECKER         * 02317000
*        CASYNECD = '1000'B;           /* ENTRY AT THIS POINT IS WHEN   02318000
*                                         THERE IS NO INPUT RECORD TO   02319000
*                                         SYNCHK BUT INPUT MODE IS 0830 02320000
*                                         BEING TERMINATED. ANY    0830 02321000
*                                         ACCUMULATED RECORDS MUST BE   02322000
*                                         SENT TO THE SYNTAX CHECKER    02323000
*                                         BEFORE CLEANUP. INDICATE 0830 02324000
*                                         NORMAL ENTRY TO SYNTAX   0830 02325000
*                                         CHECKER                     * 02326000
*                                                                  0830 02327000
NOLINE   MVI   CASYNECD(COMMREG),B'10000000'                       0830 02328000
*        /* CHECK TYPE FOR BASIC OR IPLI                              * 02329000
*        IF CATYPE = CABASIC | CATYPE = CAIPLI                     0831 02330000
*          THEN                        /* YES, TYPE IS BASIC OR IPLI  * 02331000
         CLI   CATYPE(COMMREG),X'20'                               0831 02332000
         BE    @RT00831                                            0831 02333000
         CLI   CATYPE(COMMREG),X'21'                               0831 02334000
         BNE   @RF00831                                            0831 02335000
@RT00831 DS    0H                                                  0832 02336000
*            DO;                                                   0832 02337000
*              CASYNCD2 = '10000'B;    /* SET SPECIAL OPTION CODE     * 02338000
         MVI   CASYNCD2(COMMREG),B'10000000'                       0833 02339000
*            END;                                                  0834 02340000
*          ELSE;                       /* NO, TYPE IS NOT BASIC OR 0835 02341000
*                                         IPLI                        * 02342000
@RF00831 DS    0H                                                  0836 02343000
*        CASYNIS = '0'B;               /* SUPPRESS RETURN CODE 12     * 02344000
         NI    CASYNIS(COMMREG),B'11101111'                        0836 02345000
*        CONTSW = '0'B;                /* TURN OFF CONTIN INDICATOR   * 02346000
         NI    CONTSW,B'11101111'                                  0837 02347000
*CALLCKR:                              /* INVOKE SYNTAX CHECKER       * 02348000
*        PARMREG1 = ADDR (CASYNLST);   /* POINT TO CHECKER PARM LIST  * 02349000
CALLCKR  LA    PARMREG1,CASYNLST(,COMMREG)                         0838 02350000
*        CASYNBFR = SNBFRPT + 4;       /* SET FIRST BFR PTR           * 02351000
         LA    @12,4                                               0839 02352000
         AL    @12,SNBFRPT                                         0839 02353000
         ST    @12,CASYNBFR(,COMMREG)                              0839 02354000
*        CALL CHECKER;                 /* PASS BUFFER(S) TO SYNTAX 0840 02355000
*                                         CHECKER                     * 02356000
         L     @15,CAPTCHK(,COMMREG)                               0840 02357000
         BALR  @14,@15                                             0840 02358000
*        RESPECIFY (RCODEREG) RSTD;                                0841 02359000
*        /* CHECK RETURN CODE FROM SYNTAX CHECKER                     * 02360000
*        IF RCODEREG = 0                                           0842 02361000
*          THEN                        /* NORMAL RETURN - CONTINUE 0842 02362000
*                                         PROCESSING                  * 02363000
*                                                                  0842 02364000
         LTR   RCODEREG,RCODEREG                                   0842 02365000
         BNZ   @RF00842                                            0842 02366000
*            /* CHECK FOR ANY ERROR DETECTED PREVIOUSLY               * 02367000
*            IF SYNERSW = '0'B                                     0843 02368000
*              THEN;                   /* NO ERROR-NORMAL EXIT        * 02369000
         TM    SYNERSW,B'00000100'                                 0843 02370000
         BNZ   @RF00843                                            0843 02371000
*              ELSE                    /* PREVIOUS ERRORS             * 02372000
*                GOTO EXITCK;          /* RETURN TO COMMAND MODE      * 02373000
*          ELSE                        /* ERROR RETURN                * 02374000
*                                      /* ERROR RETURN                * 02375000
*            DO;                                                   0846 02376000
         B     @RC00842                                            0846 02377000
@RF00842 DS    0H                                                  0847 02378000
*              CODESAVE = RCODEREG;    /* THE FOLLOWING CODE TO THE     02379000
*                                         END OF DO66 PROCESSES ALL     02380000
*                                         NONE-ZERO RETURN CODES.  SAVE 02381000
*                                         RETURN CODE                 * 02382000
         LR    CODESAVE,RCODEREG                                   0847 02383000
*              RESPECIFY (RCODEREG) UNRSTD;                        0848 02384000
*                                                                  0848 02385000
*              /* RETURN CODE 4                                       * 02386000
*              IF CODESAVE = 4                                     0849 02387000
*                THEN                  /* RETURN CODE IS 4            * 02388000
         CH    CODESAVE,@CH00389                                   0849 02389000
         BNE   @RF00849                                            0849 02390000
*                  DO;                                             0850 02391000
*                                                                  0850 02392000
*                  /* CHECK IF DATA SET TYPE IS BASIC OR IPLI         * 02393000
*                  IF CATYPE ^= CABASIC & CATYPE ^= CAIPLI         0851 02394000
*                  THEN                /* NO, ISSUE MESSAGE TO USER   * 02395000
         CLI   CATYPE(COMMREG),X'20'                               0851 02396000
         BE    @RF00851                                            0851 02397000
         CLI   CATYPE(COMMREG),X'21'                               0851 02398000
         BE    @RF00851                                            0851 02399000
*DO68:                                                             0852 02400000
*                  DO;                                             0852 02401000
DO68     DS    0H                                                  0853 02402000
*                    SYNERRTX = SYNMSG;/* MOVE ERROR MSG TO BUFFER    * 02403000
         L     @12,CASYNMS1(,COMMREG)                              0853 02404000
         MVC   SYNERRTX(72),SYNMSG(@12)                            0853 02405000
*                    SYNERRM2 = 0;     /* CLEAR SECOND INSERT PTR     * 02406000
         SLR   @12,@12                                             0854 02407000
         ST    @12,SYNERRM2                                        0854 02408000
*                    SYNERRLN = 76;    /* SET LENGTH FIELD IN MSG  0855 02409000
*                                         HEADER                      * 02410000
         MVC   SYNERRLN(2),@CH01354                                0855 02411000
*                    SYNERROF = 0;       /* SET INSERTION POINT       * 02412000
*                                                                  0856 02413000
         STH   @12,SYNERROF                                        0856 02414000
*                    WREG1 = 0;        /* INDICATE NO LEV-2 MSG       * 02415000
         SLR   WREG1,WREG1                                         0857 02416000
*                    WREG2 = 0;        /* INDICATE NO LEV-2 INSERTION * 02417000
         SLR   WREG2,WREG2                                         0858 02418000
*                    LEV2INS = WREG2;  /* THE NEXT 4 STATEMENTS MUST    02419000
*                                         BE KEPT IN THIS EXACT ORDER   02420000
*                                         POINT TO LEV-2 INSERTION    * 02421000
*                    LEV1INS = ADDR (SYNERMG1); /* POINT TO LEV-1  0860 02422000
*                                                  INSERT             * 02423000
         LA    LEV1INS,SYNERMG1                                    0860 02424000
*                    RELMSG2 = WREG2;  /* LOAD REL LEV-2 NUMBER       * 02425000
         STH   WREG2,RELMSG2                                       0861 02426000
*                    RELMSG1 = 1280;   /* LOAD MESSAGE NUMBER         * 02427000
*                                                                  0862 02428000
         MVC   RELMSG1(2),@CH01355                                 0862 02429000
*                    /* CHECK WHETHER OR NOT TO PUT OUT MESSAGE       * 02430000
*                    IF CASCANSW = '1'B                            0863 02431000
*                      THEN            /* YES PUT OUT MESSAGE         * 02432000
         TM    CASCANSW(COMMREG),B'00010000'                       0863 02433000
         BNO   @RF00863                                            0863 02434000
*                        CALL MSGRTN;  /* PUT OUT MESSAGE             * 02435000
*                                                                  0864 02436000
         BAL   @14,MSGRTN                                          0864 02437000
*                    /* CHECK IF THIS CODE WAS EXECUTED BECAUSE OF    * 02438000
*                    /* RETURN CODE 8                                 * 02439000
*                    IF CODE8SW = '1'B                             0865 02440000
*                      THEN            /* YES, PROCESSING WAS FOR  0865 02441000
*                                         RETURN CODE 8               * 02442000
@RF00863 TM    CODE8SW,B'01000000'                                 0865 02443000
         BNO   @RF00865                                            0865 02444000
*                        DO;                                       0866 02445000
*                          CODE8SW = '0'B; /* TURN OFF REPEATE SW     * 02446000
         NI    CODE8SW,B'10111111'                                 0867 02447000
*                          SYNERSW = '1'B; /* INDICATE AN ERROR FOUND * 02448000
         OI    SYNERSW,B'00000100'                                 0868 02449000
*                          GOTO CALLCKR; /* GO CONTINUE PROCESSING 0869 02450000
*                                           BUFFER                    * 02451000
         B     CALLCKR                                             0869 02452000
*                        END;                                      0870 02453000
*                      ELSE            /* NO ENTRY NOT FROM RET 8     * 02454000
*                        DO;                                       0871 02455000
*                                                                  0871 02456000
@RF00865 DS    0H                                                  0872 02457000
*EXITCK: ;                             /* DETERMINE TYPE OF EXIT      * 02458000
*                                                                  0872 02459000
EXITCK   DS    0H                                                  0873 02460000
*                          /* CHECK WHETHER OR NOT TO TERMINATE       * 02461000
*                          /* INPUT MODE                              * 02462000
*                          IF CASCANSW = '0'B                      0873 02463000
*                            THEN      /* DO NOT TERMINATE INPUT MODE * 02464000
         TM    CASCANSW(COMMREG),B'00010000'                       0873 02465000
         BZ    @RT00873                                            0873 02466000
*                              GO TO SNEREXIT; /* RETURN TO INPUT MODE* 02467000
*                ELSE                  /* TERMINATE INPUT MODE        * 02468000
*                  DO;                                             0875 02469000
*                    CCODE=8;          /* INDICATE FLUSH NEEDED       * 02470000
         MVC   CCODE(2),@CH00049                                   0876 02471000
*                    GOTO SNEXIT;      /* RETURN TO COMMAND MODE      * 02472000
         B     SNEXIT                                              0877 02473000
*                  END;                                            0878 02474000
*            END;                                                  0879 02475000
*        END DO68;                     /* END OF RET CODE 4           * 02476000
*        GO TO EXITCK;                 /* DETERMINE MODE              * 02477000
         B     EXITCK                                              0881 02478000
*        END;                                                      0882 02479000
*        ELSE                          /* NOT RETURN CODE 4           * 02480000
*                                                                  0883 02481000
*        /* CHECK IF RETURN CODE IS 8 AND DATA SET NOT BASIC OR IPLI  * 02482000
*        IF CODESAVE = 8 & CATYPE ^= CABASIC & CATYPE ^= CAIPLI    0883 02483000
*            THEN                      /* YES RETURN CODE IS 8        * 02484000
@RF00849 LA    @12,8                                               0883 02485000
         CR    CODESAVE,@12                                        0883 02486000
         BNE   @RF00883                                            0883 02487000
         CLI   CATYPE(COMMREG),X'20'                               0883 02488000
         BE    @RF00883                                            0883 02489000
         CLI   CATYPE(COMMREG),X'21'                               0883 02490000
         BE    @RF00883                                            0883 02491000
*              DO;                                                 0884 02492000
*                CODE8SW = '1'B;       /* INDICATE RETURN CODE WAS 8  * 02493000
         OI    CODE8SW,B'01000000'                                 0885 02494000
*                CASYNECD = '1100'B;   /* INDICATE SYNTAX CHECKER IS    02495000
*                                         BEING CALLED AFTER RETURN     02496000
*                                         CODE OF 8                   * 02497000
         MVI   CASYNECD(COMMREG),B'11000000'                       0886 02498000
*                CCODE=8;              /* INDICATE FLUSH NEEDED       * 02499000
         STH   @12,CCODE                                           0887 02500000
*                GOTO DO68;            /* GO PROCESS AS RET CODE 4    * 02501000
         B     DO68                                                0888 02502000
*              END;                                                0889 02503000
*                                                                  0889 02504000
*        /* CHECK IF PROCESSOR OR CHECKER OPERATIONAL                 * 02505000
*        IF CODESAVE = 20                                          0890 02506000
*          THEN                        /* NOT 16                      * 02507000
@RF00883 CH    CODESAVE,@CH00128                                   0890 02508000
         BNE   @RF00890                                            0890 02509000
*            DO;                                                   0891 02510000
*              SYNCKOFF = '1'B;        /* SUPPRESS SYNTAX CHECKING    * 02511000
         OI    SYNCKOFF,B'00001000'                                0892 02512000
*              CCODE = 16;             /* SET RETURN CODE FOR MA      * 02513000
         MVC   CCODE(2),@CH00228                                   0893 02514000
*              GOTO SNEXIT;            /* GO RETURN TO EDIT MODE      * 02515000
         B     SNEXIT                                              0894 02516000
*            END;                                                  0895 02517000
*                                                                  0895 02518000
*        /* CHECK IF NOT ENOUGH CORE AVAILABLE                        * 02519000
*        IF CODESAVE = 16                                          0896 02520000
*          THEN                        /* YES, NOTIFY USER AND EXIT   * 02521000
@RF00890 CH    CODESAVE,@CH00228                                   0896 02522000
         BE    @RT00896                                            0896 02523000
*            GO TO NOCOREMG;           /* BRANCH TO ISSUE MSG         * 02524000
*                                                                  0897 02525000
*        /* IF FALL THROUGH HERE RETURN CODE INVALID                  * 02526000
*        INSLEN = 12;                  /* LENGTH OF MODULE NAME INSERT* 02527000
         MVC   INSLEN(2),@CH00137                                  0898 02528000
*        INSCTL = 10;                  /* OFFSET FOR INSERTION        * 02529000
         MVC   INSCTL(2),@CH01146                                  0899 02530000
*        INSNUM = CASYNAME;            /* NAME OF CHECKER OR PROCESSOR* 02531000
         MVC   INSNUM(8),CASYNAME(COMMREG)                         0900 02532000
*        SRVREG2 = CODESAVE;           /* SAVE RETURN CODE FOR MSG    * 02533000
         LR    SRVREG2,CODESAVE                                    0901 02534000
*        CALL SRVERRTN;                /* ISSUE CMD SYSTEM ERROR MSG  * 02535000
         BAL   @14,SRVERRTN                                        0902 02536000
*        GO TO SNEXIT;                 /* RETURN TO EDIT MODE         * 02537000
         B     SNEXIT                                              0903 02538000
*        END;                          /* END OF ERROR PROCESSING     * 02539000
*        GOTO SNEREXIT;                /* EXIT                        * 02540000
         B     SNEREXIT                                            0905 02541000
*SNEXIT:                               /* COMMAND MODE EXIT           * 02542000
*        SYNPTR = ADDR (EXIT);         /* SET RTURN TO GO TO CMD MODE * 02543000
SNEXIT   LA    @12,EXIT                                            0906 02544000
         ST    @12,SYNPTR                                          0906 02545000
*SNEREXIT:                             /* PRIMARY EXIT                * 02546000
*                                      /* PROCESSING CONTINUES HERE IF  02547000
*                                         RETURN CODE WAS 0           * 02548000
*                                                                  0907 02549000
*        /* CHECK FOR BUFFERS TO BE FREED                             * 02550000
*        IF SNBFRPT = SNCURBF                                      0907 02551000
*          THEN;                       /* NO NEW BUFFERS              * 02552000
SNEREXIT CLC   SNBFRPT(4),SNCURBF                                  0907 02553000
         BE    @RT00907                                            0907 02554000
*          ELSE                        /* YES BUFFERS TO BE FREE'D    * 02555000
*            DO;                                                   0909 02556000
*              FMPTR = SNBFRPT -> NEXTBFR - 4;    /* INIT PTR FOR  0910 02557000
*                                                    FREEMAIN LOOP    * 02558000
         L     @12,SNBFRPT                                         0910 02559000
         SLR   FMPTR,FMPTR                                         0910 02560000
         ICM   FMPTR,7,NEXTBFR(@12)                                0910 02561000
         SH    FMPTR,@CH00389                                      0910 02562000
*SNFMLP:                               /* CLEAN UP                    * 02563000
*              WREG2 = FMPTR -> NEXTBFR; /* SAVE NEXT BUFFER PTR      * 02564000
SNFMLP   SLR   WREG2,WREG2                                         0911 02565000
         ICM   WREG2,7,NEXTBFR(FMPTR)                              0911 02566000
*              GMADDR = FMPTR;         /* ADDR OF BFR TO BE FREE'D    * 02567000
         ST    FMPTR,GMADDR                                        0912 02568000
*              GMLEN = FMPTR -> BUFLEN;/* LENGTH OF BFR TO FREE       * 02569000
         LH    @12,BUFLEN(,FMPTR)                                  0913 02570000
         ST    @12,GMLEN                                           0913 02571000
*              FMLIST = FMPRMLST;      /* MOVE L-FORM OF FREEMAIN TO  * 02572000
*                                                                  0914 02573000
         MVC   FMLIST(10),FMPRMLST                                 0914 02574000
*              /* ISSUE FREEMAIN FOR BUFFERS                          * 02575000
*/*         IKJENDP  - ENDS THE PARSE PCL.                            * 02576000
*              GEN (FREEMAIN A=GMDATA,MF=(E,FMLIST));              0915 02577000
         FREEMAIN A=GMDATA,MF=(E,FMLIST)                                02578000
*              FMPTR = WREG2;          /* GET NEXT ADDR TO BE FREE'D  * 02579000
*                                                                  0916 02580000
         LR    FMPTR,WREG2                                         0916 02581000
*              /* SEE IF MORE BUFFERS TO BE FREE'D                    * 02582000
*              IF FMPTR = 0                                        0917 02583000
*                THEN                  /* NO, ALL BFRS FREE'D         * 02584000
         LTR   FMPTR,FMPTR                                         0917 02585000
         BNZ   @RF00917                                            0917 02586000
*                  SNCURBF = SNBFRPT;  /* REINITIALISE BFR PTR TO     * 02587000
         MVC   SNCURBF(4),SNBFRPT                                  0918 02588000
*                ELSE                  /* YES, MORE TO FREE           * 02589000
*                  DO;                                             0919 02590000
         B     @RC00917                                            0919 02591000
@RF00917 DS    0H                                                  0920 02592000
*                    WREG2 = WREG2 - 4;   /* POINT TO BEG OF BUFFER   * 02593000
         SH    WREG2,@CH00389                                      0920 02594000
*                    GOTO SNFMLP;      /* GO FREE NEXT BUFFER         * 02595000
         B     SNFMLP                                              0921 02596000
*                  END;                                            0922 02597000
*            END;                                                  0923 02598000
*                                                                  0923 02599000
@RC00917 DS    0H                                                  0924 02600000
*        /* CHECK FOR GETMAIN FAILURE                                 * 02601000
*        IF SYNCKSW = '1'B                                         0924 02602000
*          THEN                        /* IF NO, REINIT BUFER CONTROLS* 02603000
@RT00907 TM    SYNCKSW,B'10000000'                                 0924 02604000
         BNO   @RF00924                                            0924 02605000
*            DO;                                                   0925 02606000
*              SNCURPOS = SNCURBF + 8;    /* INIT CURRENT POS PTR     * 02607000
         L     @12,SNCURBF                                         0926 02608000
         LA    @08,8                                               0926 02609000
         ALR   @08,@12                                             0926 02610000
         ST    @08,SNCURPOS                                        0926 02611000
*              RECNUM = 0;             /* RESET RECORD COUNT          * 02612000
         MVI   RECNUM(@12),X'00'                                   0927 02613000
*            END;                                                  0928 02614000
*        CASYNIS = '1'B;               /* RESET CHKR INTERFACE        * 02615000
@RF00924 OI    CASYNIS(COMMREG),B'00010000'                        0929 02616000
*SYNEXIT: ;                            /* EXIT FROM SUBROUTINE        * 02617000
SYNEXIT  DS    0H                                                  0931 02618000
*        RETREG = SYNPTR;              /* RESTORE RETURN POINT        * 02619000
         L     RETREG,SYNPTR                                       0931 02620000
*        RETURN;                       /* RETURN TO CALLER            * 02621000
@EL00008 DS    0H                                                  0932 02622000
@EF00008 DS    0H                                                  0932 02623000
@ER00008 BR    @14                                                 0932 02624000
*        END SYNCHK;                   /* END OF SYNCHK               * 02625000
*                                                                  0934 02626000
*CLNSAVE:                                                          0934 02627000
*        /* ********************************************************* * 02628000
*        /* THIS ROUTINE ASSUMES THAT THE RECORD         CONTAINED    * 02629000
*        /* ENTRY IS TO BE MADE AVAILABLE IN THAT SLOT. TO DO THIS,   * 02630000
*        /* THE EXISTING RECORD WILL BE RE-WRITTEN WITH A KEY 1       * 02631000
*        /* LARGER THAN IT THEN HAS. IF A RECORD EXISTS AT THE NEW    * 02632000
*        /* KEY THEN IT WILL BE RE-WRITTEN THE SAME WAY. WHEN ALL     * 02633000
*        /* DISPLACED RECORDS HAVE BEEN WRITTEN BACK INTO THE DATA    * 02634000
*        /* SET THIS ROUTINE RETURNS INPUTNONE OUTPUT - IF            * 02635000
*        /* OPERATION IS SUCCESSFUL, CONTROL IS RETURNED TO CALLER.   * 02636000
*        /* IN 'CLNBFR(1)' EXISTS IN THE UTILITY DATA SET AND AN      * 02637000
*        /* IF  UNSUCCESSFUL, A BRANCH IS MADE DIRECTLY TO 'EDIT'     * 02638000
*        /* AFTER PUTTING OUT A MESSAGE.                              * 02639000
*        /* ********************************************************* * 02640000
*        PROC OPTIONS (NOSAVE, NOSAVEAREA);                        0934 02641000
CLNSAVE  DS    0H                                                  0935 02642000
*        /* THE FOLLOWING REGISTERS ARE RESTRICTED FOR THE DURATION   * 02643000
*        /* OF INPUT.                                                 * 02644000
*        RESPECIFY (PARMREG1, WREG1, WREG2, COMMREG, SAVEREG, DATAREG,  02645000
*                  BASEREG) RSTD;                                  0935 02646000
*                                                                  0935 02647000
*        CLNPTR = RETREG;              /* SAVE RETURN POINT PTR       * 02648000
         LR    CLNPTR,RETREG                                       0936 02649000
*        WREG1 = ADDR (CLNBFR (1));    /* INIT FOR FIRST BUFFER       * 02650000
         LA    WREG1,CLNBFR(,COMMREG)                              0937 02651000
*        WREG2 = ADDR (CLNBFR (2));    /* INIT FOR SECOND BUFFER      * 02652000
         LA    WREG2,CLNBFR+264(,COMMREG)                          0938 02653000
*        NEXTREC = CLNKEY + 1;         /* UPDATE NEXT RECORD PTR      * 02654000
         LA    @08,1                                               0939 02655000
         AL    @08,CLNKEY(,WREG1)                                  0939 02656000
         ST    @08,NEXTREC(,COMMREG)                               0939 02657000
*CLNLP:                                /* DO THE READ                 * 02658000
*        CLNKEY = CLNKEY + 1;          /* INCREMENT KEY TO NEXT KEY   * 02659000
CLNLP    LA    @08,1                                               0940 02660000
         AL    @08,CLNKEY(,WREG1)                                  0940 02661000
         ST    @08,CLNKEY(,WREG1)                                  0940 02662000
*        UTOPTCD = '00'X;              /* SET OP CODE FOR READ        * 02663000
         MVI   UTOPTCD,X'00'                                       0941 02664000
*        UTKEYPTR = ADDR (CLNKEY);     /* POINT TO KEY FOR READ       * 02665000
         ST    WREG1,UTKEYPTR                                      0942 02666000
*        UTADPTR = WREG2;              /* POINT TO BUFFER FOR READ    * 02667000
         ST    WREG2,UTADPTR                                       0943 02668000
*        LBIT2 = '0'B;                 /* TURN OFF 2-WORD LIST IND    * 02669000
         NI    LBIT2,B'01111111'                                   0944 02670000
*        LBIT3 = '1'B;                 /* TURN ON 3-WORD LIST INDIC   * 02671000
         OI    LBIT3,B'10000000'                                   0945 02672000
*        CALL IORTN;                   /* GO PERFORM READ             * 02673000
*                                                                  0946 02674000
         BAL   @14,IORTN                                           0946 02675000
*        /* CHECK RETURN CODE FROM IKJEBEUT                           * 02676000
*        IF RCODEREG = 0                                           0947 02677000
*          THEN;                       /* RECORD EXISTS, NEXT SLOT IS   02678000
*                                         NOT EMPTY                   * 02679000
         LTR   RCODEREG,RCODEREG                                   0947 02680000
         BZ    @RT00947                                            0947 02681000
*          ELSE                        /* RECORD DOES NOT EXIST, NEXT   02682000
*                                         SLOT IS EMPTY               * 02683000
*            WREG2 = 0;                /* SET END-OF-LOOP INDICATION  * 02684000
         SLR   WREG2,WREG2                                         0949 02685000
*        UTOPTCD = '20'X;              /* SET WRITE OP CODE           * 02686000
@RT00947 MVI   UTOPTCD,X'20'                                       0950 02687000
*        UTKEYPTR = WREG1;             /* POINT TO RECORD TO BE    0951 02688000
*                                         WRITTEN                     * 02689000
         ST    WREG1,UTKEYPTR                                      0951 02690000
*        LBIT2 = '1'B;                 /* INDICATE 2-WORD LIST        * 02691000
         OI    LBIT2,B'10000000'                                   0952 02692000
*        CALL IORTN;                   /* GO WRITE RECORD IN DS       * 02693000
*                                                                  0953 02694000
         BAL   @14,IORTN                                           0953 02695000
*        /* CHECK RETURN CODE FROM IKJEBEUT                           * 02696000
*        IF RCODEREG ^= 0                                          0954 02697000
*          THEN                        /* WRITE WAS UNSUCCESSFUL ,    * 02698000
         SLR   @14,@14                                             0954 02699000
         CR    RCODEREG,@14                                        0954 02700000
         BE    @RF00954                                            0954 02701000
*            DO;                       /* DIAGNOSE ERROR (CODE=12)    * 02702000
*              RELMSG1 = 776;          /* LOAD MSG NUMBER             * 02703000
         MVC   RELMSG1(2),@CH01296                                 0956 02704000
*              RELMSG2 = 0;            /* INDICATE NO LEVEL 2         * 02705000
         STH   @14,RELMSG2                                         0957 02706000
*              LEV1INS = 0;            /* INDICATE NO LEV 1 INS       * 02707000
         SLR   LEV1INS,LEV1INS                                     0958 02708000
*              LEV2INS = 0;            /* INDICATE NO LEV 2 INS       * 02709000
         SLR   LEV2INS,LEV2INS                                     0959 02710000
*              CALL MSGRTN;            /* GO PUT OUT MSG              * 02711000
         BAL   @14,MSGRTN                                          0960 02712000
*              RETREG = ADDR ( EXIT);  /* SET RTURN ADDR              * 02713000
         LA    RETREG,EXIT                                         0961 02714000
*              RETURN;                 /* RETURN TO COMMAND MODE      * 02715000
@EL00009 DS    0H                                                  0962 02716000
@EF00009 DS    0H                                                  0962 02717000
@ER00009 BR    @14                                                 0962 02718000
*            END;                                                  0963 02719000
*          ELSE;                       /* WRITE WAS SUCCESSFUL        * 02720000
*                                                                  0964 02721000
@RF00954 DS    0H                                                  0965 02722000
*        /* CHECK FOR END-OF-LOOP                                     * 02723000
*        IF WREG2 = 0                                              0965 02724000
*          THEN DO;                    /* YES, FINISHED               * 02725000
         LTR   WREG2,WREG2                                         0965 02726000
         BNZ   @RF00965                                            0965 02727000
*CLNRET:                               /* EXIT CODE                   * 02728000
*            RETREG = CLNPTR;          /* RESTORE RETURN POINT PTR    * 02729000
CLNRET   LR    RETREG,CLNPTR                                       0967 02730000
*            RETURN;                   /* RETURN TO CALLER            * 02731000
         B     @EL00009                                            0968 02732000
*               END;                                               0969 02733000
*          ELSE;                       /* NO, SLOT WAS NOT FOUND      * 02734000
*                                                                  0970 02735000
@RF00965 DS    0H                                                  0971 02736000
*        /* THE NEXT 3 INSTRUCTIONS SWAP THE BUFFER PTRS              * 02737000
*        GEN REFS(WREG1,WREG2);                                    0971 02738000
         XR    WREG1,WREG2                                              02739000
         XR    WREG2,WREG1                                              02740000
         XR    WREG1,WREG2                                              02741000
*        GOTO CLNLP;                   /* CONTINUE LOOPING            * 02742000
         B     CLNLP                                               0972 02743000
*        END CLNSAVE;                  /* END OF CLNSAVE              * 02744000
*                                                                  0973 02745000
*                                                                  0973 02746000
*  DECLARE /*GENERAL PURPOSE REGISTERS */                          0974 02747000
*    GPR00P PTR(31) REG(0),                                        0974 02748000
*    GPR01P PTR(31) REG(1),                                        0974 02749000
*    GPR02P PTR(31) REG(2),                                        0974 02750000
*    GPR03P PTR(31) REG(3),                                        0974 02751000
*    GPR04P PTR(31) REG(4),                                        0974 02752000
*    GPR05P PTR(31) REG(5),                                        0974 02753000
*    GPR06P PTR(31) REG(6),                                        0974 02754000
*    GPR07P PTR(31) REG(7),                                        0974 02755000
*    GPR08P PTR(31) REG(8),                                        0974 02756000
*    GPR09P PTR(31) REG(9),                                        0974 02757000
*    GPR12P PTR(31) REG(12),                                       0974 02758000
*    GPR13P PTR(31) REG(13),                                       0974 02759000
*    GPR14P PTR(31) REG(14),                                       0974 02760000
*    GPR15P PTR(31) REG(15);                                       0974 02761000
*                                                                  0974 02762000
*  /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS */                  0975 02763000
*    DECLARE CASAVPTR PTR(31) BASED;/*SAVE AREA PTR FOR IKJEBESV*/ 0975 02764000
*    DECLARE COMMREG REG(9) PTR(31) RSTD;/*POINTER TO EDIT COMMO AREA*/ 02765000
*    DECLARE DATAREG REG(10) PTR(31) RSTD;/*BASEREG FOR EDIT SUBCOMMAND 02766000
*WORK AREA*/                                                       0977 02767000
*    DECLARE CASAVE CHAR(72) BASED;/*SAVE AREA EDIT MODULE*/       0978 02768000
*                                                                  0978 02769000
*  DECLARE /* COMMON VARIABLES */                                  0979 02770000
*    I256C CHAR(256) BASED,                                        0979 02771000
*    I031F FIXED(31) BASED,                                        0979 02772000
*    I031P PTR(31)   BASED,                                        0979 02773000
*    I015F FIXED(15) BASED,                                        0979 02774000
*    I015P PTR(15)   BASED,                                        0979 02775000
*    I008P PTR(8)    BASED,                                        0979 02776000
*    I001C CHAR(1)   BASED;                                        0979 02777000
*        END IKJEBEIP                                              0980 02778000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02779000
*/*%INCLUDE SYSLIB  (IKJEBECA)                                        * 02780000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 02781000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 02782000
*/*%INCLUDE SYSLIB  (IKJEBEMJ)                                        * 02783000
*/*%INCLUDE SYSLIB  (IKJGTPB )                                        * 02784000
*;                                                                 0980 02785000
@DATA    DS    0H                                                       02786000
@CH00051 DC    H'1'                                                     02787000
@CH00072 DC    H'2'                                                     02788000
@CH00389 DC    H'4'                                                     02789000
@CH00124 DC    H'5'                                                     02790000
@CH00049 DC    H'8'                                                     02791000
@CH01146 DC    H'10'                                                    02792000
@CH00137 DC    H'12'                                                    02793000
@CH00228 DC    H'16'                                                    02794000
@CH00128 DC    H'20'                                                    02795000
@CH00068 DC    H'24'                                                    02796000
@CH01354 DC    H'76'                                                    02797000
@CH01321 DC    H'259'                                                   02798000
@CH01250 DC    H'270'                                                   02799000
@CH01272 DC    H'271'                                                   02800000
@CH01306 DC    H'774'                                                   02801000
@CH01296 DC    H'776'                                                   02802000
@CH01355 DC    H'1280'                                                  02803000
@CH01254 DC    H'1288'                                                  02804000
@CH01335 DC    H'1293'                                                  02805000
@SM01400 MVC   INSNUM(0),0(@08)                                         02806000
@SM01402 MVC   NUMTEMP(0),NUMADJ(WREG2)                                 02807000
@SM01404 MVC   NUMBTMP(0),NUMTEMP                                       02808000
@SM01407 MVC   OUTDATA(0,COMMREG),INLINE+4(@07)                         02809000
@SM01411 MVC   BUFLINE(0,@08),NEWDATA(INPTR)                            02810000
@SM01413 MVC   BUFLINE(0,@08),NEWLINE+4(INPTR)                          02811000
@DATD    DSECT                                                          02812000
         DS    0F                                                       02813000
@PC00008 DS    1F                                                       02814000
IKJEBEIP CSECT                                                          02815000
         DS    0F                                                       02816000
@DATD    DSECT                                                          02817000
         DS    0D                                                       02818000
READKEY  DS    F                                                        02819000
SAVERC   DS    F                                                        02820000
CONTPTR  DS    A                                                        02821000
IORTNPTR DS    A                                                        02822000
SRVPTR   DS    A                                                        02823000
SYNPTR   DS    A                                                        02824000
CLNCUR   DS    A                                                        02825000
CCODE    DS    H                                                        02826000
         DS    CL2                                                      02827000
PTLPBLK  DS    CL20                                                     02828000
SRWORK   DS    CL40                                                     02829000
         ORG   SRWORK                                                   02830000
RELMSG1  DS    FL2                                                      02831000
RELMSG2  DS    FL2                                                      02832000
SRWORK2  DS    CL36                                                     02833000
         ORG   SRWORK+40                                                02834000
INSREC   DS    CL16                                                     02835000
         ORG   INSREC                                                   02836000
INS2PTR  DS    CL4                                                      02837000
INSLEN   DS    FL2                                                      02838000
INSCTL   DS    CL2                                                      02839000
INSNUM   DS    CL8                                                      02840000
         ORG   INSREC+16                                                02841000
TEMPBUFF DS    CL13                                                     02842000
         ORG   TEMPBUFF                                                 02843000
LTEMPNUM DS    FL2                                                      02844000
NUMBXXX  DS    FL2                                                      02845000
NUMBTMP  DS    CL9                                                      02846000
         ORG   TEMPBUFF+13                                              02847000
         DS    CL3                                                      02848000
NUMBFR   DS    CL21                                                     02849000
         ORG   NUMBFR                                                   02850000
NUMSEG   DS    FL4                                                      02851000
NUMPTR   DS    AL4                                                      02852000
         ORG   NUMPTR                                                   02853000
NUMEOL   DS    CL1                                                      02854000
         ORG   NUMBFR+8                                                 02855000
LNUMTEMP DS    FL2                                                      02856000
NUMXXX   DS    FL2                                                      02857000
NUMTEMP  DS    CL9                                                      02858000
         ORG   NUMTEMP                                                  02859000
NUMTEMP1 DS    CL8                                                      02860000
         ORG   NUMBFR+21                                                02861000
         DS    CL3                                                      02862000
INSREC1  DS    CL11                                                     02863000
         ORG   INSREC1                                                  02864000
@NM00033 DS    CL8                                                      02865000
INSNUM1  DS    CL3                                                      02866000
         ORG   INSREC1+11                                               02867000
         DS    CL1                                                      02868000
UTPRMLST DS    CL12                                                     02869000
         ORG   UTPRMLST                                                 02870000
UTDCBPTR DS    AL4                                                      02871000
         ORG   UTDCBPTR                                                 02872000
UTOPTCD  DS    CL1                                                      02873000
         ORG   UTOPTCD                                                  02874000
LBIT1    DS    BL1                                                      02875000
         ORG   UTPRMLST+4                                               02876000
UTKEYPTR DS    AL4                                                      02877000
         ORG   UTKEYPTR                                                 02878000
LBIT2    DS    BL1                                                      02879000
         ORG   UTPRMLST+8                                               02880000
UTADPTR  DS    AL4                                                      02881000
         ORG   UTADPTR                                                  02882000
LBIT3    DS    BL1                                                      02883000
         ORG   UTPRMLST+12                                              02884000
FLAGS    DS    BL1                                                      02885000
         ORG   FLAGS                                                    02886000
PRSSW    DS    BL1                                                      02887000
MSGSW1   EQU   FLAGS+0                                                  02888000
EODSW    EQU   FLAGS+0                                                  02889000
CONTSW   EQU   FLAGS+0                                                  02890000
SYNCKOFF EQU   FLAGS+0                                                  02891000
SYNERSW  EQU   FLAGS+0                                                  02892000
BFRFREE  EQU   FLAGS+0                                                  02893000
         ORG   FLAGS+1                                                  02894000
         DS    CL3                                                      02895000
LEPARM   DS    CL8                                                      02896000
         ORG   LEPARM                                                   02897000
LETXTPTR DS    AL4                                                      02898000
         ORG   LETXTPTR                                                 02899000
LEFLAG   DS    BL1                                                      02900000
         ORG   LEPARM+4                                                 02901000
LECAREA  DS    AL4                                                      02902000
         ORG   LEPARM+8                                                 02903000
FMPARM   DS    CL8                                                      02904000
         ORG   FMPARM                                                   02905000
FMADDR   DS    AL4                                                      02906000
FMLEN    DS    AL4                                                      02907000
         ORG   FMPARM+8                                                 02908000
GLPBLK   DS    CL20                                                     02909000
SNCHKDLT DS    CL12                                                     02910000
         ORG   SNCHKDLT                                                 02911000
@NM00036 DS    FL4                                                      02912000
STARTV   DS    FL4                                                      02913000
STOPV    DS    FL4                                                      02914000
         ORG   SNCHKDLT+12                                              02915000
FMLIST   DS    CL10                                                     02916000
         DS    CL2                                                      02917000
BFCTLBLK DS    CL12                                                     02918000
         ORG   BFCTLBLK                                                 02919000
SNBFRPT  DS    AL4                                                      02920000
SNCURPOS DS    AL4                                                      02921000
SNCURBF  DS    AL4                                                      02922000
         ORG   BFCTLBLK+12                                              02923000
GMDATA   DS    CL8                                                      02924000
         ORG   GMDATA                                                   02925000
GMADDR   DS    AL4                                                      02926000
GMLEN    DS    FL4                                                      02927000
         ORG   GMDATA+8                                                 02928000
GMPARM   DS    CL8                                                      02929000
GMPRMLST DS    CL12                                                     02930000
         ORG   GMPRMLST                                                 02931000
LENPTR   DS    AL4                                                      02932000
ADDRPTR  DS    AL4                                                      02933000
@NM00039 DS    FL4                                                      02934000
         ORG   GMPRMLST+12                                              02935000
SYNERMG1 DS    CL80                                                     02936000
         ORG   SYNERMG1                                                 02937000
SYNERRM2 DS    FL4                                                      02938000
SYNERRLN DS    FL2                                                      02939000
SYNERROF DS    FL2                                                      02940000
SYNERRTX DS    CL72                                                     02941000
         ORG   SYNERMG1+80                                              02942000
SYNERNG2 DS    CL80                                                     02943000
         ORG   SYNERNG2                                                 02944000
SYNERRM3 DS    FL4                                                      02945000
SYNERLN2 DS    FL2                                                      02946000
SYNEROF2 DS    FL2                                                      02947000
SYNERTX2 DS    CL72                                                     02948000
         ORG   SYNERNG2+80                                              02949000
SYNSW    DS    BL1                                                      02950000
         ORG   SYNSW                                                    02951000
SYNCKSW  DS    BL1                                                      02952000
CODE8SW  EQU   SYNSW+0                                                  02953000
         ORG   SYNSW+1                                                  02954000
         DS    CL3                                                      02955000
PACKTMP  DS    CL8                                                      02956000
IKJEBEIP CSECT                                                          02957000
         NOPR  ((@ENDDATD-@DATD)/673*16)                                02958000
         DS    0F                                                       02959000
@SIZDATD DC    AL1(0)                                                   02960000
         DC    AL3(@ENDDATD-@DATD)                                      02961000
@CV01140 DC    V(IKJEBIP1)                                              02962000
         DS    0D                                                       02963000
MAXREC   DC    F'100000000'                                             02964000
MAXRECU  DC    F'2147483647'                                            02965000
@CC01308 DC    C'I '                                                    02966000
         DS    CL2                                                      02967000
INPMSG   DS    CL9                                                      02968000
         ORG   INPMSG                                                   02969000
@NM00030 DC    H'9'                                                     02970000
@NM00031 DC    H'0'                                                     02971000
@NM00032 DC    CL5'INPUT'                                               02972000
         ORG   INPMSG+9                                                 02973000
         DS    CL3                                                      02974000
GMPARMX  DS    CL8                                                      02975000
         ORG   GMPARMX                                                  02976000
@NM00037 DC    F'264'                                                   02977000
@NM00038 DC    F'2048'                                                  02978000
         ORG   GMPARMX+8                                                02979000
IKJEBEIP CSECT                                                          02980000
IKJEBXT1 CSECT                                                          02981000
XTR5     EQU   5                                                        02982000
XTR6     EQU   6                       WORK REGISTER                    02983000
XT12     EQU   12                      LAST REG TO BE SAVED             02984000
XTRCODE4 EQU   4                       RETURN CODE FOR BAD PARM         02985000
XTRET    EQU   14                      RETURN REGISTER                  02986000
XTRCODE  EQU   15                      RETURN CODE REGISTER             02987000
XTBASE   EQU   15                      BASE REG FOR EXIT ROUTINE        02988000
RECBASE  EQU   1                       POINTS TO PDE FROM PARSE         02989000
OFF0     EQU   0                       USED FOR 0 FIELDS OF             02990000
*                                      INSTRUCTIONS                     02991000
IKJEBXT1 CSECT                                                          02992000
         USING *,XTBASE                ESTABLISH ADDRESSABILITY         02993000
         SAVE  (14,12),,*              SAVE PARSE REGISTERS             02994000
         USING IKJEBXT2,RECBASE        EST ADDRESSABILITY FOR INPUT     02995000
*                                      RECORD                           02996000
         L     RECBASE,OFF0(,RECBASE)  GET PTR TO PDE FROM PARSE        02997000
         L     XTR5,XTPTR              GET POINTER TO NUMBER FROM PDE   02998000
         LH    XTR6,XTLEN              GET LENGTH OF NUMBER FROM PDE    02999000
         BCTR  XTR6,0                  REDUCE LENGTH FOR COMPARE        03000000
         EX    XTR6,XTCLC              COMPARE NUMBER TO 0(DECIMAL)     03001000
         BE    XTBADINC                BRANCH IF 0, VALUE NO GOOD       03002000
         SR    XTRCODE,XTRCODE         SET RETURN CODE 0 - OK           03003000
         RETURN (14,12),RC=(15)        RETURN TO PARSE                  03004000
XTBADINC EQU   *                                                        03005000
         LA    XTRCODE,XTRCODE4        SET RETURN CODE FOR PARSE        03006000
         RETURN (14,12),RC=(15)        RETURN TO PARSE                  03007000
XTCLC    CLC   OFF0(OFF0,XTR5),ZEROS   EXECUTED TO COMPARE NUMBER TO    03008000
*                                      0                                03009000
ZEROS    DC    C'00000000'             COMPARAND FOR INPUT NUMBER       03010000
IKJEBXT2 DSECT                                                          03011000
* THIS DSECT DEFINES THE PDE FORMAT FROM PARSE                          03012000
*                                                                       03013000
*                                                                       03014000
XTPTR    DS    F                       POINTER TO NUMBER TO VERIFY      03015000
XTLEN    DS    H                       LENGTH OF NUMBER TO BE VERIFIED  03016000
         DROP  XTBASE                                                   03017000
         DROP  RECBASE                                                  03018000
IKJEBEIP CSECT ,                       RESUME MAIN CSECT                03019000
IKJEBEIP CSECT                                                          03020000
IKJEBIP1 IKJPARM                                                        03021000
PA       IKJIDENT 'LINE NUMBER OPERAND',ASTERISK,FIRST=NUMERIC,        X03022000
               OTHER=NUMERIC,MAXLNTH=8                                  03023000
PB       IKJIDENT 'INCREMENT',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=8,   X03024000
               VALIDCK=IKJEBXT1                                         03025000
PRMT     IKJKEYWD                                                       03026000
PC       IKJNAME 'PROMPT'                                               03027000
PD       IKJNAME 'NOPROMPT'                                             03028000
RI       IKJKEYWD DEFAULT='I'                                           03029000
PE       IKJNAME 'I'                                                    03030000
PF       IKJNAME 'R'                                                    03031000
PG       IKJENDP                                                        03032000
INSOFF1  EQU   15                                                       03033000
MSGNUM1  IKJEBEMG ,INSOFF1,'        '  INSERT FOR LINE TRUNC MSG        03034000
INSOFF2  EQU   25                                                       03035000
MSGNUM2  IKJEBEMG ,INSOFF2,'   '       INSERT FOR LEV 2 OF LINE TRUNC   03036000
*                                      MSG                     @ZM30991 03037000
INSOFF3  EQU   28                                                       03038000
INSM402  IKJEBEMG ,INSOFF3,'99999999'                                   03039000
INSOFF   EQU   45                                                       03040000
INSM25   IKJEBEMG ,INSOFF,'INPUT'      SECOND LEVEL MSG FOR MSG25       03041000
M313INS1 IKJEBEMG M313INS4,10,'PARSE'                                   03042000
M313INS2 IKJEBEMG M313INS4,10,'PUTLINE'                                 03043000
M313INS4 IKJEBEMG ,22,'00'       INSERTION FOR SRV RTN FAILURE          03044000
INSOFF4  EQU   48                                                       03045000
INSM400  IKJEBEMG ,INSOFF4,'        '                                   03046000
M313INS3 IKJEBEMG M313INS4,10,'GETLINE'                                 03047000
FMPRMLST FREEMAIN V,SP=1,MF=L                                           03048000
PTLINE   PUTLINE OUTPUT=(0,TERM,SINGLE,DATA),TERMPUT=ASIS,MF=L          03049000
@DATD    DSECT                                                          03050000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03051000
@ENDDATD EQU   *                                                        03052000
IKJEBEIP CSECT                                                          03053000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03054000
@01      EQU   01                                                       03055000
@02      EQU   02                                                       03056000
@03      EQU   03                                                       03057000
@04      EQU   04                                                       03058000
@05      EQU   05                                                       03059000
@06      EQU   06                                                       03060000
@07      EQU   07                                                       03061000
@08      EQU   08                                                       03062000
@09      EQU   09                                                       03063000
@10      EQU   10                                                       03064000
@11      EQU   11                                                       03065000
@12      EQU   12                                                       03066000
@13      EQU   13                                                       03067000
@14      EQU   14                                                       03068000
@15      EQU   15                                                       03069000
FMPTR    EQU   @04                                                      03070000
INPTR    EQU   @12                                                      03071000
GTPBPTR  EQU   @12                                                      03072000
MSGPTR   EQU   @12                                                      03073000
CLNPTR   EQU   @12                                                      03074000
CODESAVE EQU   @07                                                      03075000
PPLPTR   EQU   @04                                                      03076000
BASEREG2 EQU   @06                                                      03077000
COMMREG  EQU   @09                                                      03078000
SAVEREG  EQU   @13                                                      03079000
BASEREG  EQU   @11                                                      03080000
RCODEREG EQU   @15                                                      03081000
PARMREG1 EQU   @01                                                      03082000
WREG1    EQU   @02                                                      03083000
WREG2    EQU   @03                                                      03084000
LEV1INS  EQU   @02                                                      03085000
LEV2INS  EQU   @03                                                      03086000
SRVREG2  EQU   @03                                                      03087000
RETREG   EQU   @14                                                      03088000
CVDREG   EQU   @02                                                      03089000
UTPREG1  EQU   @01                                                      03090000
DATAREG  EQU   @10                                                      03091000
GPR13P   EQU   @13                                                      03092000
GPR15P   EQU   @15                                                      03093000
GPR01P   EQU   @01                                                      03094000
GPR12P   EQU   @12                                                      03095000
EPREG    EQU   @15                                                      03096000
GPR00P   EQU   @00                                                      03097000
GPR02P   EQU   @02                                                      03098000
GPR03P   EQU   @03                                                      03099000
GPR04P   EQU   @04                                                      03100000
GPR05P   EQU   @05                                                      03101000
GPR06P   EQU   @06                                                      03102000
GPR07P   EQU   @07                                                      03103000
GPR08P   EQU   @08                                                      03104000
GPR09P   EQU   @09                                                      03105000
GPR14P   EQU   @14                                                      03106000
PARMREG0 EQU   @00                                                      03107000
RETCDREG EQU   @15                                                      03108000
CVTPTR   EQU   16                                                       03109000
IKJEBECA EQU   0                                                        03110000
CAPTPRSD EQU   IKJEBECA+36                                              03111000
CAPRSPDL EQU   CAPTPRSD                                                 03112000
CAFREEDL EQU   CAPRSPDL                                                 03113000
CAPTIBFR EQU   IKJEBECA+40                                              03114000
CAOPERND EQU   CAPTIBFR                                                 03115000
CAPTCDCB EQU   IKJEBECA+52                                              03116000
CAPTCHK  EQU   IKJEBECA+72                                              03117000
CAATTN   EQU   IKJEBECA+120                                             03118000
CAATTNIS EQU   CAATTN                                                   03119000
CACFLAG  EQU   IKJEBECA+124                                             03120000
CACFLAG1 EQU   CACFLAG                                                  03121000
CAPROMPT EQU   CACFLAG1                                                 03122000
CASCANSW EQU   CACFLAG1                                                 03123000
CANONUM  EQU   CACFLAG1                                                 03124000
CACFLAG2 EQU   CACFLAG+1                                                03125000
CARECFM  EQU   CACFLAG2                                                 03126000
CAMODMSG EQU   CACFLAG2                                                 03127000
CACFLAG3 EQU   CACFLAG+2                                                03128000
CAIMFLG  EQU   CACFLAG3                                                 03129000
CAIMPT   EQU   CAIMFLG                                                  03130000
CAIMINS  EQU   CAIMFLG                                                  03131000
CAIMSC   EQU   CAIMFLG                                                  03132000
CAIMIR   EQU   CAIMFLG                                                  03133000
CAIMCIN  EQU   CAIMFLG                                                  03134000
CAIMSFPT EQU   CAIMFLG                                                  03135000
CAIMINPT EQU   CAIMFLG                                                  03136000
CACFLAG4 EQU   CACFLAG+3                                                03137000
CACFLAG5 EQU   CACFLAG+4                                                03138000
CACFLAG6 EQU   CACFLAG+5                                                03139000
CAPD     EQU   IKJEBECA+152                                             03140000
CASYNAME EQU   CAPD+32                                                  03141000
CADSCODE EQU   CAPD+40                                                  03142000
CADSATTR EQU   CAPD+41                                                  03143000
CADSCONT EQU   CADSATTR                                                 03144000
CADSATR2 EQU   CAPD+42                                                  03145000
CAPTPDXT EQU   IKJEBECA+228                                             03146000
CALRECL  EQU   IKJEBECA+232                                             03147000
CAEDFLAG EQU   IKJEBECA+236                                             03148000
CAEDFLG2 EQU   IKJEBECA+237                                             03149000
CASAFLAG EQU   IKJEBECA+376                                             03150000
CASAFLG2 EQU   IKJEBECA+377                                             03151000
CASTNUM  EQU   IKJEBECA+448                                             03152000
CANXTREC EQU   IKJEBECA+452                                             03153000
CACURNUM EQU   IKJEBECA+456                                             03154000
CAINCRE  EQU   IKJEBECA+460                                             03155000
CAIMLLNO EQU   IKJEBECA+464                                             03156000
CAIMLINC EQU   IKJEBECA+468                                             03157000
CAINSAVE EQU   IKJEBECA+476                                             03158000
CASYNLST EQU   IKJEBECA+496                                             03159000
CASYNBFR EQU   CASYNLST                                                 03160000
CASYNWA  EQU   IKJEBECA+508                                             03161000
CASYNECD EQU   CASYNWA                                                  03162000
CASYNMS1 EQU   CASYNWA+4                                                03163000
CASYNOPT EQU   IKJEBECA+524                                             03164000
CASYNCD2 EQU   CASYNOPT+1                                               03165000
CASYNSW  EQU   CASYNOPT+3                                               03166000
CASYNIS  EQU   CASYNSW                                                  03167000
CATMPLST EQU   IKJEBECA+528                                             03168000
CAMAWKA  EQU   IKJEBECA+596                                             03169000
MACFLAGS EQU   CAMAWKA+28                                               03170000
MACFLAG2 EQU   CAMAWKA+29                                               03171000
CAMODEMG EQU   IKJEBECA+928                                             03172000
CASCWKA  EQU   IKJEBECA+1448                                            03173000
CABFRPL  EQU   IKJEBECA+2120                                            03174000
CATEMPBF EQU   IKJEBECA+2648                                            03175000
CANXTSVA EQU   IKJEBECA+3896                                            03176000
IKJEBECX EQU   0                                                        03177000
BACKREG  EQU   4                                                        03178000
CVTMAP   EQU   0                                                        03179000
CVTDAR   EQU   CVTMAP+72                                                03180000
CVTFLGS1 EQU   CVTDAR                                                   03181000
CVTDCB   EQU   CVTMAP+116                                               03182000
CVTIOQET EQU   CVTMAP+120                                               03183000
CVTIERLC EQU   CVTMAP+144                                               03184000
CVTHEAD  EQU   CVTMAP+160                                               03185000
CVTSV76C EQU   CVTHEAD                                                  03186000
CVTOPTA  EQU   CVTMAP+182                                               03187000
CVTOPTB  EQU   CVTMAP+183                                               03188000
CVTGTF   EQU   CVTMAP+236                                               03189000
CVTGTFST EQU   CVTGTF                                                   03190000
CVTGTFS  EQU   CVTGTFST                                                 03191000
CVTSTATE EQU   CVTGTFST                                                 03192000
CVTTMODE EQU   CVTGTFST                                                 03193000
CVTFORM  EQU   CVTGTFST                                                 03194000
CVTAQAVT EQU   CVTMAP+240                                               03195000
CVTTCMFG EQU   CVTAQAVT                                                 03196000
CVTVOLM2 EQU   CVTMAP+244                                               03197000
CVTTATA  EQU   CVTVOLM2                                                 03198000
CVTTSKS  EQU   CVTTATA                                                  03199000
CVTVOLF2 EQU   CVTTSKS                                                  03200000
CVTTAT   EQU   CVTTATA+1                                                03201000
CVTATER  EQU   CVTMAP+248                                               03202000
CVTEXT1  EQU   CVTMAP+252                                               03203000
CVTPURG  EQU   CVTMAP+260                                               03204000
CVTQMSG  EQU   CVTMAP+268                                               03205000
CVTDMSR  EQU   CVTMAP+272                                               03206000
CVTRSV37 EQU   CVTDMSR                                                  03207000
CVTDMSRF EQU   CVTRSV37                                                 03208000
CVTERPV  EQU   CVTMAP+316                                               03209000
CVTINTLA EQU   CVTMAP+320                                               03210000
CVTAPF   EQU   CVTMAP+324                                               03211000
CVTEXT2  EQU   CVTMAP+328                                               03212000
CVTHJES  EQU   CVTMAP+332                                               03213000
CVTPGSIA EQU   CVTMAP+348                                               03214000
CVTA1F1  EQU   CVTMAP+356                                               03215000
CVTSYSK  EQU   CVTMAP+357                                               03216000
CVTVOLM1 EQU   CVTMAP+380                                               03217000
CVTVOLF1 EQU   CVTVOLM1                                                 03218000
CVTATMCT EQU   CVTMAP+388                                               03219000
CVTXTNT1 EQU   0                                                        03220000
CVTXTNT2 EQU   0                                                        03221000
CVTDSSV  EQU   CVTXTNT2                                                 03222000
CVTFLGBT EQU   CVTXTNT2+5                                               03223000
CVTQID   EQU   CVTXTNT2+24                                              03224000
CVTRV400 EQU   CVTXTNT2+52                                              03225000
CVTRV409 EQU   CVTXTNT2+53                                              03226000
CVTATCVT EQU   CVTXTNT2+64                                              03227000
CVTRV429 EQU   CVTXTNT2+84                                              03228000
CVTRV438 EQU   CVTXTNT2+85                                              03229000
CVTRV457 EQU   CVTXTNT2+112                                             03230000
CVTRV466 EQU   CVTXTNT2+113                                             03231000
CVTFIX   EQU   0                                                        03232000
CVTRELNO EQU   CVTFIX+252                                               03233000
PPL      EQU   0                                                        03234000
PPLPCL   EQU   PPL+12                                                   03235000
PPLANS   EQU   PPL+16                                                   03236000
PPLCBUF  EQU   PPL+20                                                   03237000
PPLUWA   EQU   PPL+24                                                   03238000
PRSPDE   EQU   0                                                        03239000
PRSNMPTR EQU   PRSPDE+8                                                 03240000
@NM00026 EQU   PRSPDE+12                                                03241000
PRSNMLEN EQU   @NM00026                                                 03242000
PRSNMFLG EQU   @NM00026+2                                               03243000
PRSNMOM  EQU   PRSNMFLG                                                 03244000
PRSINPTR EQU   PRSPDE+16                                                03245000
@NM00028 EQU   PRSPDE+20                                                03246000
PRSINLEN EQU   @NM00028                                                 03247000
PRSINFLG EQU   @NM00028+2                                               03248000
PRSINOM  EQU   PRSINFLG                                                 03249000
PRSPFLG  EQU   PRSPDE+24                                                03250000
PRSIRFLG EQU   PRSPDE+26                                                03251000
NUMBER   EQU   0                                                        03252000
IOPTR    EQU   24                                                       03253000
INKEY    EQU   0                                                        03254000
NUMSCAN  EQU   0                                                        03255000
NUMADJ   EQU   0                                                        03256000
GTPB     EQU   0                                                        03257000
GTPBIBUF EQU   GTPB+4                                                   03258000
INLINE   EQU   0                                                        03259000
INLEN    EQU   INLINE                                                   03260000
BUFCTL   EQU   0                                                        03261000
BUFLEN   EQU   BUFCTL                                                   03262000
RECNUM   EQU   BUFCTL+4                                                 03263000
NEXTBFR  EQU   BUFCTL+5                                                 03264000
BUFLINE  EQU   0                                                        03265000
NEWLINE  EQU   0                                                        03266000
NEWLEN   EQU   NEWLINE+4                                                03267000
NEWDATA  EQU   NEWLINE+8                                                03268000
SYNMSG   EQU   0                                                        03269000
CLNREC   EQU   0                                                        03270000
CLNKEY   EQU   CLNREC                                                   03271000
CHECKER  EQU   0                                                        03272000
CASAVPTR EQU   0                                                        03273000
CASAVE   EQU   0                                                        03274000
CLNREC1  EQU   0                                                        03275000
I001C    EQU   0                                                        03276000
I008P    EQU   0                                                        03277000
I015F    EQU   0                                                        03278000
I015P    EQU   0                                                        03279000
I031F    EQU   0                                                        03280000
I031P    EQU   0                                                        03281000
I256C    EQU   0                                                        03282000
RTREG    EQU   12                                                       03283000
Q        EQU   0                                                        03284000
CVTS01   EQU   CVTPGSIA                                                 03285000
CVTLPDIA EQU   CVTS01+12                                                03286000
CVTDIRST EQU   CVTLPDIA                                                 03287000
CVTSLIDA EQU   CVTS01+24                                                03288000
CVTCTLFG EQU   CVTS01+50                                                03289000
CVTPARS  EQU   CVTS01+176                                               03290000
CVTRV210 EQU   CVTS01+424                                               03291000
CVTRV219 EQU   CVTS01+425                                               03292000
CVTRV228 EQU   CVTS01+426                                               03293000
CVTRV237 EQU   CVTS01+427                                               03294000
CVTMFRTR EQU   CVTS01+452                                               03295000
CVTRV262 EQU   CVTS01+468                                               03296000
CVTRV271 EQU   CVTS01+469                                               03297000
CVTRV280 EQU   CVTS01+470                                               03298000
CVTRV289 EQU   CVTS01+471                                               03299000
CVTGSDA  EQU   CVTS01+600                                               03300000
PDLPTR   EQU   CAPTPRSD                                                 03301000
M44IN1   EQU   CATEMPBF                                                 03302000
FIRSTLN  EQU   CASTNUM                                                  03303000
NEXTREC  EQU   CANXTREC                                                 03304000
SAVEINCR EQU   CAINSAVE                                                 03305000
CATYPE   EQU   CADSCODE                                                 03306000
OUTLINE  EQU   CABFRPL                                                  03307000
OUTKEY   EQU   OUTLINE                                                  03308000
OUTLEN   EQU   OUTLINE+4                                                03309000
OUTRESV  EQU   OUTLINE+6                                                03310000
OUTDATA  EQU   OUTLINE+8                                                03311000
DATA1    EQU   OUTDATA                                                  03312000
INBUFPTR EQU   GTPBIBUF                                                 03313000
CLNBFR   EQU   CATEMPBF                                                 03314000
DATAF    EQU   OUTDATA                                                  03315000
DATAVNS  EQU   OUTDATA                                                  03316000
OUTREC   EQU   OUTLEN                                                   03317000
*                                      START UNREFERENCED COMPONENTS    03318000
DATAVS   EQU   DATA1+8                                                  03319000
SEQVS    EQU   DATA1                                                    03320000
M44INTXT EQU   M44IN1+8                                                 03321000
M44INX   EQU   M44IN1+6                                                 03322000
M44INLN  EQU   M44IN1+4                                                 03323000
M44IN2PT EQU   M44IN1                                                   03324000
CVTRV628 EQU   CVTS01+728                                               03325000
CVTRV627 EQU   CVTS01+724                                               03326000
CVTRV626 EQU   CVTS01+720                                               03327000
CVTRV625 EQU   CVTS01+716                                               03328000
CVTRV624 EQU   CVTS01+712                                               03329000
CVTRV623 EQU   CVTS01+708                                               03330000
CVTRV622 EQU   CVTS01+704                                               03331000
CVTRV621 EQU   CVTS01+700                                               03332000
CVTIHASU EQU   CVTS01+696                                               03333000
CVTRV619 EQU   CVTS01+692                                               03334000
CVTRV618 EQU   CVTS01+688                                               03335000
CVTRV617 EQU   CVTS01+684                                               03336000
CVTRV616 EQU   CVTS01+680                                               03337000
CVTRV615 EQU   CVTS01+676                                               03338000
CVTRV614 EQU   CVTS01+672                                               03339000
CVTRV613 EQU   CVTS01+668                                               03340000
CVTTCASP EQU   CVTS01+664                                               03341000
CVT0PT03 EQU   CVTS01+660                                               03342000
CVT0PT0E EQU   CVTS01+656                                               03343000
CVTRV609 EQU   CVTS01+652                                               03344000
CVTCGK   EQU   CVTS01+648                                               03345000
CVTRAC   EQU   CVTS01+644                                               03346000
CVTHSM   EQU   CVTS01+640                                               03347000
CVTRV605 EQU   CVTS01+636                                               03348000
CVTRV604 EQU   CVTS01+632                                               03349000
CVTEFF02 EQU   CVTS01+628                                               03350000
CVTCBBR  EQU   CVTS01+624                                               03351000
CVTSSCR  EQU   CVTS01+620                                               03352000
CVTEVENT EQU   CVTS01+616                                               03353000
CVTCRCA  EQU   CVTS01+612                                               03354000
CVTTPIO  EQU   CVTS01+608                                               03355000
CVTADV   EQU   CVTS01+604                                               03356000
CVTGSDAB EQU   CVTGSDA                                                  03357000
CVTQV3   EQU   CVTS01+596                                               03358000
CVTQV2   EQU   CVTS01+592                                               03359000
CVTQV1   EQU   CVTS01+588                                               03360000
CVTRPT   EQU   CVTS01+584                                               03361000
CVTSSRB  EQU   CVTS01+580                                               03362000
CVTCSDRL EQU   CVTS01+576                                               03363000
CVTEXP1  EQU   CVTS01+572                                               03364000
CVTRMPMT EQU   CVTS01+568                                               03365000
CVTRMPTT EQU   CVTS01+564                                               03366000
CVTVPSA  EQU   CVTS01+560                                               03367000
CVTVSTOP EQU   CVTS01+556                                               03368000
CVTGTFR8 EQU   CVTS01+552                                               03369000
CVTQUIT  EQU   CVTS01+548                                               03370000
CVTVACR  EQU   CVTS01+544                                               03371000
CVTWTCB  EQU   CVTS01+540                                               03372000
CVTSTPRS EQU   CVTS01+536                                               03373000
CVT0PT02 EQU   CVTS01+532                                               03374000
CVTDARCM EQU   CVTS01+528                                               03375000
CVTIRECM EQU   CVTS01+524                                               03376000
CVTJRECM EQU   CVTS01+520                                               03377000
CVTVEMS0 EQU   CVTS01+516                                               03378000
CVTSPFRR EQU   CVTS01+512                                               03379000
CVTRLSTG EQU   CVTS01+508                                               03380000
CVT0TC0A EQU   CVTS01+504                                               03381000
CVTGMBR  EQU   CVTS01+500                                               03382000
CVTLFRM  EQU   CVTS01+496                                               03383000
CVTRMBR  EQU   CVTS01+492                                               03384000
CVTVIOP  EQU   CVTS01+488                                               03385000
CVTRV307 EQU   CVTS01+486                                               03386000
CVTRV306 EQU   CVTS01+484                                               03387000
CVTRV305 EQU   CVTS01+482                                               03388000
CVTRV304 EQU   CVTS01+480                                               03389000
CVTRV303 EQU   CVTS01+478                                               03390000
CVTRV302 EQU   CVTS01+476                                               03391000
CVTTRCA  EQU   CVTS01+472                                               03392000
CVTRV297 EQU   CVTRV289                                                 03393000
CVTRV296 EQU   CVTRV289                                                 03394000
CVTRV295 EQU   CVTRV289                                                 03395000
CVTRV294 EQU   CVTRV289                                                 03396000
CVTRV293 EQU   CVTRV289                                                 03397000
CVTRV292 EQU   CVTRV289                                                 03398000
CVTRV291 EQU   CVTRV289                                                 03399000
CVTRV290 EQU   CVTRV289                                                 03400000
CVTRV288 EQU   CVTRV280                                                 03401000
CVTRV287 EQU   CVTRV280                                                 03402000
CVTRV286 EQU   CVTRV280                                                 03403000
CVTRV285 EQU   CVTRV280                                                 03404000
CVTRV284 EQU   CVTRV280                                                 03405000
CVTRV283 EQU   CVTRV280                                                 03406000
CVTRV282 EQU   CVTRV280                                                 03407000
CVTRV281 EQU   CVTRV280                                                 03408000
CVTRV279 EQU   CVTRV271                                                 03409000
CVTRV278 EQU   CVTRV271                                                 03410000
CVTRV277 EQU   CVTRV271                                                 03411000
CVTRV276 EQU   CVTRV271                                                 03412000
CVTRV275 EQU   CVTRV271                                                 03413000
CVTRV274 EQU   CVTRV271                                                 03414000
CVTRV273 EQU   CVTRV271                                                 03415000
CVTRV272 EQU   CVTRV271                                                 03416000
CVTRV270 EQU   CVTRV262                                                 03417000
CVTRV269 EQU   CVTRV262                                                 03418000
CVTRV268 EQU   CVTRV262                                                 03419000
CVTRV267 EQU   CVTRV262                                                 03420000
CVTRV266 EQU   CVTRV262                                                 03421000
CVTRV265 EQU   CVTRV262                                                 03422000
CVTRV264 EQU   CVTRV262                                                 03423000
CVTRV263 EQU   CVTRV262                                                 03424000
CVTVFP   EQU   CVTS01+464                                               03425000
CVTVSI   EQU   CVTS01+460                                               03426000
CVTVPSIB EQU   CVTS01+456                                               03427000
CVTMFACT EQU   CVTMFRTR                                                 03428000
CVTMFCTL EQU   CVTS01+448                                               03429000
CVTPVBP  EQU   CVTS01+444                                               03430000
CVTPWI   EQU   CVTS01+440                                               03431000
CVTRV254 EQU   CVTS01+438                                               03432000
CVTRV253 EQU   CVTS01+436                                               03433000
CVTRV252 EQU   CVTS01+434                                               03434000
CVTRV251 EQU   CVTS01+433                                               03435000
CVTRV250 EQU   CVTS01+432                                               03436000
CVTRV249 EQU   CVTS01+431                                               03437000
CVTRV248 EQU   CVTS01+430                                               03438000
CVTRV247 EQU   CVTS01+429                                               03439000
CVTRV246 EQU   CVTS01+428                                               03440000
CVTRV245 EQU   CVTRV237                                                 03441000
CVTRV244 EQU   CVTRV237                                                 03442000
CVTRV243 EQU   CVTRV237                                                 03443000
CVTRV242 EQU   CVTRV237                                                 03444000
CVTRV241 EQU   CVTRV237                                                 03445000
CVTRV240 EQU   CVTRV237                                                 03446000
CVTRV239 EQU   CVTRV237                                                 03447000
CVTRV238 EQU   CVTRV237                                                 03448000
CVTRV236 EQU   CVTRV228                                                 03449000
CVTRV235 EQU   CVTRV228                                                 03450000
CVTRV234 EQU   CVTRV228                                                 03451000
CVTRV233 EQU   CVTRV228                                                 03452000
CVTRV232 EQU   CVTRV228                                                 03453000
CVTRV231 EQU   CVTRV228                                                 03454000
CVTRV230 EQU   CVTRV228                                                 03455000
CVTRV229 EQU   CVTRV228                                                 03456000
CVTRV227 EQU   CVTRV219                                                 03457000
CVTRV226 EQU   CVTRV219                                                 03458000
CVTRV225 EQU   CVTRV219                                                 03459000
CVTRV224 EQU   CVTRV219                                                 03460000
CVTRV223 EQU   CVTRV219                                                 03461000
CVTRV222 EQU   CVTRV219                                                 03462000
CVTRV221 EQU   CVTRV219                                                 03463000
CVTRV220 EQU   CVTRV219                                                 03464000
CVTRV218 EQU   CVTRV210                                                 03465000
CVTRV217 EQU   CVTRV210                                                 03466000
CVTRV216 EQU   CVTRV210                                                 03467000
CVTRV215 EQU   CVTRV210                                                 03468000
CVTRV214 EQU   CVTRV210                                                 03469000
CVTRV213 EQU   CVTRV210                                                 03470000
CVTRV212 EQU   CVTRV210                                                 03471000
CVTRV211 EQU   CVTRV210                                                 03472000
CVTLCCAT EQU   CVTS01+420                                               03473000
CVTPCCAT EQU   CVTS01+416                                               03474000
CVTIPCRP EQU   CVTS01+412                                               03475000
CVTIPCRI EQU   CVTS01+408                                               03476000
CVTIPCDS EQU   CVTS01+404                                               03477000
CVTAIDVT EQU   CVTS01+400                                               03478000
CVTSSAP  EQU   CVTS01+396                                               03479000
CVTEHCIR EQU   CVTS01+392                                               03480000
CVTEHDEF EQU   CVTS01+388                                               03481000
CVTDAIR  EQU   CVTS01+384                                               03482000
CVTPERFM EQU   CVTS01+380                                               03483000
CVT044R2 EQU   CVTS01+376                                               03484000
CVTFETCH EQU   CVTS01+372                                               03485000
CVTRSTWD EQU   CVTS01+368                                               03486000
CVTSPOST EQU   CVTS01+364                                               03487000
CVTIOBP  EQU   CVTS01+360                                               03488000
CVTASMVT EQU   CVTS01+356                                               03489000
CVTRECRQ EQU   CVTS01+352                                               03490000
CVTWSAC  EQU   CVTS01+348                                               03491000
CVTRV149 EQU   CVTS01+344                                               03492000
CVTWSAL  EQU   CVTS01+340                                               03493000
CVTSPSA  EQU   CVTS01+336                                               03494000
CVTGLMN  EQU   CVTS01+332                                               03495000
CVTVEAC0 EQU   CVTS01+328                                               03496000
CVT062R1 EQU   CVTS01+324                                               03497000
CVTRPOST EQU   CVTS01+320                                               03498000
CVTDQIQE EQU   CVTS01+316                                               03499000
CVTCSD   EQU   CVTS01+312                                               03500000
CVTLKRMA EQU   CVTS01+308                                               03501000
CVTRSPIE EQU   CVTS01+304                                               03502000
CVTRENQ  EQU   CVTS01+300                                               03503000
CVTLQCB  EQU   CVTS01+296                                               03504000
CVTFQCB  EQU   CVTS01+292                                               03505000
CVTQCS01 EQU   CVTS01+288                                               03506000
CVTAPFT  EQU   CVTS01+284                                               03507000
CVTPARRL EQU   CVTS01+280                                               03508000
CVTVWAIT EQU   CVTS01+276                                               03509000
CVTGSPL  EQU   CVTS01+272                                               03510000
CVTLSMQ  EQU   CVTS01+268                                               03511000
CVTGSMQ  EQU   CVTS01+264                                               03512000
CVTEXPRO EQU   CVTS01+260                                               03513000
CVTOPCTP EQU   CVTS01+256                                               03514000
CVTSIC   EQU   CVTS01+252                                               03515000
CVTTPIOS EQU   CVTS01+248                                               03516000
CVTRTMS  EQU   CVTS01+244                                               03517000
CVTSDBF  EQU   CVTS01+240                                               03518000
CVTSCBP  EQU   CVTS01+236                                               03519000
CVTSDMP  EQU   CVTS01+232                                               03520000
CVTSV60  EQU   CVTS01+228                                               03521000
CVTRTMCT EQU   CVTS01+224                                               03522000
CVTASCBL EQU   CVTS01+220                                               03523000
CVTASCBH EQU   CVTS01+216                                               03524000
CVTGDA   EQU   CVTS01+212                                               03525000
CVTASVT  EQU   CVTS01+208                                               03526000
CVTVVMDI EQU   CVTS01+204                                               03527000
CVTAQTOP EQU   CVTS01+200                                               03528000
CVTIOSCS EQU   CVTS01+196                                               03529000
CVTSDRM  EQU   CVTS01+192                                               03530000
CVTOPTE  EQU   CVTS01+188                                               03531000
CVTSTXU  EQU   CVTS01+184                                               03532000
CVTQUIS  EQU   CVTS01+180                                               03533000
CVTS1EE  EQU   CVTS01+172                                               03534000
CVTFRAS  EQU   CVTS01+168                                               03535000
CVTQSAS  EQU   CVTS01+164                                               03536000
CVTCRAS  EQU   CVTS01+160                                               03537000
CVTCRMN  EQU   CVTS01+156                                               03538000
CVTDELCP EQU   CVTS01+152                                               03539000
CVTFRECL EQU   CVTS01+148                                               03540000
CVTGETCL EQU   CVTS01+144                                               03541000
CVTBLDCP EQU   CVTS01+140                                               03542000
CVTAUTHL EQU   CVTS01+136                                               03543000
CVTSCAN  EQU   CVTS01+132                                               03544000
CVTRV144 EQU   CVTS01+130                                               03545000
CVTMAXMP EQU   CVTS01+128                                               03546000
CVTSTCK  EQU   CVTS01+124                                               03547000
CVTRV139 EQU   CVTS01+123                                               03548000
CVTDSSAC EQU   CVTS01+122                                               03549000
CVTRV513 EQU   CVTS01+121                                               03550000
CVTIOSPL EQU   CVTS01+120                                               03551000
CVTPTGT  EQU   CVTS01+116                                               03552000
CVTCSPIE EQU   CVTS01+112                                               03553000
CVTSMFEX EQU   CVTS01+108                                               03554000
CVTOLT0A EQU   CVTS01+104                                               03555000
CVTSRBRT EQU   CVTS01+100                                               03556000
CVTPUTL  EQU   CVTS01+96                                                03557000
CVTASCRL EQU   CVTS01+92                                                03558000
CVTASCRF EQU   CVTS01+88                                                03559000
CVTRV326 EQU   CVTS01+84                                                03560000
CVTRV325 EQU   CVTS01+80                                                03561000
CVTRV324 EQU   CVTS01+76                                                03562000
CVT0VL01 EQU   CVTS01+72                                                03563000
CVTSHRVM EQU   CVTS01+68                                                03564000
CVTRV332 EQU   CVTS01+64                                                03565000
CVTTAS   EQU   CVTS01+60                                                03566000
CVTRSCN  EQU   CVTS01+56                                                03567000
CVTTRAC2 EQU   CVTS01+54                                                03568000
CVTTRACE EQU   CVTS01+52                                                03569000
CVTAPG   EQU   CVTS01+51                                                03570000
CVTSDTRC EQU   CVTCTLFG                                                 03571000
CVTGTRCE EQU   CVTCTLFG                                                 03572000
CVTNOMP  EQU   CVTCTLFG                                                 03573000
CVTRSV79 EQU   CVTCTLFG                                                 03574000
CVTDSTAT EQU   CVTCTLFG                                                 03575000
CVTRSV78 EQU   CVTCTLFG                                                 03576000
CVTRV333 EQU   CVTCTLFG                                                 03577000
CVTRV323 EQU   CVTCTLFG                                                 03578000
CVTSPVLK EQU   CVTS01+49                                                03579000
CVTRSV77 EQU   CVTS01+48                                                03580000
CVTRV331 EQU   CVTS01+44                                                03581000
CVTRV330 EQU   CVTS01+40                                                03582000
CVTRV329 EQU   CVTS01+36                                                03583000
CVTRV328 EQU   CVTS01+32                                                03584000
CVTRV322 EQU   CVTS01+28                                                03585000
CVTSLID  EQU   CVTSLIDA+1                                               03586000
CVTSYLK  EQU   CVTSLIDA                                                 03587000
CVTRV321 EQU   CVTS01+20                                                03588000
CVTRV320 EQU   CVTS01+16                                                03589000
CVTLPDIR EQU   CVTLPDIA+1                                               03590000
CVTRSV69 EQU   CVTDIRST                                                 03591000
CVTRSV68 EQU   CVTDIRST                                                 03592000
CVTRSV67 EQU   CVTDIRST                                                 03593000
CVTRSV66 EQU   CVTDIRST                                                 03594000
CVTRSV65 EQU   CVTDIRST                                                 03595000
CVTRSV64 EQU   CVTDIRST                                                 03596000
CVTRSV63 EQU   CVTDIRST                                                 03597000
CVTDICOM EQU   CVTDIRST                                                 03598000
CVTPVTP  EQU   CVTS01+8                                                 03599000
CVTLPDSR EQU   CVTS01+4                                                 03600000
CVTGETL  EQU   CVTS01                                                   03601000
CLNLEN   EQU   CLNREC+4                                                 03602000
@NM00042 EQU   NEWLINE+6                                                03603000
@NM00041 EQU   NEWLINE                                                  03604000
@NM00040 EQU   BUFCTL+2                                                 03605000
INDATA   EQU   INLINE+4                                                 03606000
@NM00035 EQU   INLINE+2                                                 03607000
@NM00034 EQU   GTPB                                                     03608000
@NM00029 EQU   @NM00028+3                                               03609000
@NM00027 EQU   @NM00026+3                                               03610000
@NM00025 EQU   PRSPDE                                                   03611000
PPLECB   EQU   PPL+8                                                    03612000
PPLECT   EQU   PPL+4                                                    03613000
PPLUPT   EQU   PPL                                                      03614000
CVTLEVL  EQU   CVTRELNO+2                                               03615000
CVTNUMB  EQU   CVTRELNO                                                 03616000
CVTMDL   EQU   CVTFIX+250                                               03617000
@NM00024 EQU   CVTFIX+248                                               03618000
@NM00023 EQU   CVTFIX                                                   03619000
CVTRV482 EQU   CVTXTNT2+128                                             03620000
CVTRV481 EQU   CVTXTNT2+124                                             03621000
CVTRV480 EQU   CVTXTNT2+120                                             03622000
CVTRV479 EQU   CVTXTNT2+118                                             03623000
CVTRV478 EQU   CVTXTNT2+117                                             03624000
CVTRV477 EQU   CVTXTNT2+116                                             03625000
CVTRV476 EQU   CVTXTNT2+115                                             03626000
CVTRV475 EQU   CVTXTNT2+114                                             03627000
CVTRV474 EQU   CVTRV466                                                 03628000
CVTRV473 EQU   CVTRV466                                                 03629000
CVTRV472 EQU   CVTRV466                                                 03630000
CVTRV471 EQU   CVTRV466                                                 03631000
CVTRV470 EQU   CVTRV466                                                 03632000
CVTRV469 EQU   CVTRV466                                                 03633000
CVTRV468 EQU   CVTRV466                                                 03634000
CVTRV467 EQU   CVTRV466                                                 03635000
CVTRV465 EQU   CVTRV457                                                 03636000
CVTRV464 EQU   CVTRV457                                                 03637000
CVTRV463 EQU   CVTRV457                                                 03638000
CVTRV462 EQU   CVTRV457                                                 03639000
CVTRV461 EQU   CVTRV457                                                 03640000
CVTRV460 EQU   CVTRV457                                                 03641000
CVTRV459 EQU   CVTRV457                                                 03642000
CVTRV458 EQU   CVTRV457                                                 03643000
CVTRV456 EQU   CVTXTNT2+108                                             03644000
CVTRV455 EQU   CVTXTNT2+104                                             03645000
CVTRV454 EQU   CVTXTNT2+100                                             03646000
CVTRV453 EQU   CVTXTNT2+96                                              03647000
CVTRV452 EQU   CVTXTNT2+94                                              03648000
CVTRV451 EQU   CVTXTNT2+92                                              03649000
CVTRV450 EQU   CVTXTNT2+90                                              03650000
CVTRV449 EQU   CVTXTNT2+88                                              03651000
CVTRV448 EQU   CVTXTNT2+87                                              03652000
CVTRV447 EQU   CVTXTNT2+86                                              03653000
CVTRV446 EQU   CVTRV438                                                 03654000
CVTRV445 EQU   CVTRV438                                                 03655000
CVTRV444 EQU   CVTRV438                                                 03656000
CVTRV443 EQU   CVTRV438                                                 03657000
CVTRV442 EQU   CVTRV438                                                 03658000
CVTRV441 EQU   CVTRV438                                                 03659000
CVTRV440 EQU   CVTRV438                                                 03660000
CVTRV439 EQU   CVTRV438                                                 03661000
CVTRV437 EQU   CVTRV429                                                 03662000
CVTRV436 EQU   CVTRV429                                                 03663000
CVTRV435 EQU   CVTRV429                                                 03664000
CVTRV434 EQU   CVTRV429                                                 03665000
CVTRV433 EQU   CVTRV429                                                 03666000
CVTRV432 EQU   CVTRV429                                                 03667000
CVTRV431 EQU   CVTRV429                                                 03668000
CVTRV430 EQU   CVTRV429                                                 03669000
CVTRV428 EQU   CVTXTNT2+80                                              03670000
CVTRV427 EQU   CVTXTNT2+76                                              03671000
CVTRV426 EQU   CVTXTNT2+72                                              03672000
CVTRV425 EQU   CVTXTNT2+68                                              03673000
CVTATACT EQU   CVTATCVT                                                 03674000
CVTRV423 EQU   CVTXTNT2+62                                              03675000
CVTRV422 EQU   CVTXTNT2+60                                              03676000
CVTRV421 EQU   CVTXTNT2+58                                              03677000
CVTRV420 EQU   CVTXTNT2+56                                              03678000
CVTRV419 EQU   CVTXTNT2+55                                              03679000
CVTRV418 EQU   CVTXTNT2+54                                              03680000
CVTRV417 EQU   CVTRV409                                                 03681000
CVTRV416 EQU   CVTRV409                                                 03682000
CVTRV415 EQU   CVTRV409                                                 03683000
CVTRV414 EQU   CVTRV409                                                 03684000
CVTRV413 EQU   CVTRV409                                                 03685000
CVTRV412 EQU   CVTRV409                                                 03686000
CVTRV411 EQU   CVTRV409                                                 03687000
CVTRV410 EQU   CVTRV409                                                 03688000
CVTRV408 EQU   CVTRV400                                                 03689000
CVTRV407 EQU   CVTRV400                                                 03690000
CVTRV406 EQU   CVTRV400                                                 03691000
CVTRV405 EQU   CVTRV400                                                 03692000
CVTRV404 EQU   CVTRV400                                                 03693000
CVTRV403 EQU   CVTRV400                                                 03694000
CVTRV402 EQU   CVTRV400                                                 03695000
CVTRV401 EQU   CVTRV400                                                 03696000
CVTICB   EQU   CVTXTNT2+48                                              03697000
CVTSKTA  EQU   CVTXTNT2+44                                              03698000
CVTCCVT  EQU   CVTXTNT2+40                                              03699000
CVTRSV98 EQU   CVTXTNT2+36                                              03700000
CVTRSV97 EQU   CVTXTNT2+34                                              03701000
CVTRSV96 EQU   CVTXTNT2+32                                              03702000
CVTOLTEP EQU   CVTXTNT2+28                                              03703000
CVTQIDA  EQU   CVTQID+1                                                 03704000
CVTRSV95 EQU   CVTQID                                                   03705000
CVTRSV94 EQU   CVTXTNT2+20                                              03706000
CVTRSV93 EQU   CVTXTNT2+16                                              03707000
CVTRSV92 EQU   CVTXTNT2+12                                              03708000
CVTDEBVR EQU   CVTXTNT2+8                                               03709000
CVTRSV91 EQU   CVTXTNT2+6                                               03710000
CVTRSV9H EQU   CVTFLGBT                                                 03711000
CVTRSV9G EQU   CVTFLGBT                                                 03712000
CVTRSV9F EQU   CVTFLGBT                                                 03713000
CVTRSV9E EQU   CVTFLGBT                                                 03714000
CVTRSV9D EQU   CVTFLGBT                                                 03715000
CVTRSV9C EQU   CVTFLGBT                                                 03716000
CVTVME   EQU   CVTFLGBT                                                 03717000
CVTNPE   EQU   CVTFLGBT                                                 03718000
CVTNUCLS EQU   CVTXTNT2+4                                               03719000
CVTDSSVA EQU   CVTDSSV+1                                                03720000
CVTRSV89 EQU   CVTDSSV                                                  03721000
CVTRSV88 EQU   CVTXTNT1+8                                               03722000
CVTRSV87 EQU   CVTXTNT1+4                                               03723000
CVTFACHN EQU   CVTXTNT1                                                 03724000
CVTRV488 EQU   CVTMAP+412                                               03725000
CVTRV487 EQU   CVTMAP+408                                               03726000
CVTRV486 EQU   CVTMAP+404                                               03727000
CVTRV485 EQU   CVTMAP+400                                               03728000
CVTACTAP EQU   CVTMAP+396                                               03729000
CVTAUTH  EQU   CVTMAP+392                                               03730000
CVTATMCA EQU   CVTATMCT+1                                               03731000
CVTATMST EQU   CVTATMCT                                                 03732000
CVTRSV61 EQU   CVTMAP+384                                               03733000
CVTVOLT1 EQU   CVTVOLM1+1                                               03734000
CVTVOLI1 EQU   CVTVOLF1                                                 03735000
CVTSTOA  EQU   CVTMAP+376                                               03736000
CVTRSV58 EQU   CVTMAP+374                                               03737000
CVTRSV57 EQU   CVTMAP+372                                               03738000
CVTDDCE  EQU   CVTMAP+368                                               03739000
CVTPNWFR EQU   CVTMAP+364                                               03740000
CVTSMF   EQU   CVTMAP+360                                               03741000
CVTSULK  EQU   CVTMAP+358                                               03742000
CVTSLKO  EQU   CVTSYSK                                                  03743000
CVTSLKP  EQU   CVTSYSK                                                  03744000
CVTSLKQ  EQU   CVTSYSK                                                  03745000
CVTSLKR  EQU   CVTSYSK                                                  03746000
CVTRSV56 EQU   CVTSYSK                                                  03747000
CVTRSV55 EQU   CVTSYSK                                                  03748000
CVTRSV54 EQU   CVTSYSK                                                  03749000
CVTRSV53 EQU   CVTSYSK                                                  03750000
CVTRSV52 EQU   CVTA1F1                                                  03751000
CVTRSV51 EQU   CVTA1F1                                                  03752000
CVTRSV50 EQU   CVTA1F1                                                  03753000
CVTRSV49 EQU   CVTA1F1                                                  03754000
CVTRSV48 EQU   CVTA1F1                                                  03755000
CVTRSV47 EQU   CVTA1F1                                                  03756000
CVTSRSW  EQU   CVTA1F1                                                  03757000
CVTPFSW  EQU   CVTA1F1                                                  03758000
CVTPCVT  EQU   CVTMAP+352                                               03759000
CVTRSV46 EQU   CVTMAP+344                                               03760000
CVTRSV45 EQU   CVTMAP+340                                               03761000
CVTRSV44 EQU   CVTMAP+338                                               03762000
CVTRSV43 EQU   CVTMAP+336                                               03763000
CVTHJESA EQU   CVTHJES+1                                                03764000
CVTRSV42 EQU   CVTHJES                                                  03765000
CVTEXT2A EQU   CVTEXT2+1                                                03766000
CVTRSV41 EQU   CVTEXT2                                                  03767000
CVTAPFA  EQU   CVTAPF+1                                                 03768000
CVTRSV40 EQU   CVTAPF                                                   03769000
CVTRV518 EQU   CVTINTLA                                                 03770000
CVTRV517 EQU   CVTERPV                                                  03771000
CVTEORM  EQU   CVTMAP+312                                               03772000
CVTMCHPR EQU   CVTMAP+308                                               03773000
CVTTZ    EQU   CVTMAP+304                                               03774000
CVTJEPS  EQU   CVTMAP+300                                               03775000
CVTJESCT EQU   CVTMAP+296                                               03776000
CVTMODE  EQU   CVTMAP+292                                               03777000
CVTPTRV  EQU   CVTMAP+288                                               03778000
CVTREAL  EQU   CVTMAP+284                                               03779000
CVTRSV39 EQU   CVTMAP+280                                               03780000
CVTRSV38 EQU   CVTMAP+276                                               03781000
CVTDMSRA EQU   CVTDMSR+1                                                03782000
CVTRV634 EQU   CVTDMSRF                                                 03783000
CVTRV633 EQU   CVTDMSRF                                                 03784000
CVTRV632 EQU   CVTDMSRF                                                 03785000
CVTRV631 EQU   CVTDMSRF                                                 03786000
CVTRV630 EQU   CVTDMSRF                                                 03787000
CVTRV629 EQU   CVTDMSRF                                                 03788000
CVTUDUMP EQU   CVTDMSRF                                                 03789000
CVTSDUMP EQU   CVTDMSRF                                                 03790000
CVTQMSGA EQU   CVTQMSG+1                                                03791000
CVTRSV36 EQU   CVTQMSG                                                  03792000
CVTAMFF  EQU   CVTMAP+264                                               03793000
CVTPURGA EQU   CVTPURG+1                                                03794000
CVTRSV35 EQU   CVTPURG                                                  03795000
CVTCBSP  EQU   CVTMAP+256                                               03796000
CVTATERA EQU   CVTATER+1                                                03797000
CVTSYST  EQU   CVTATER                                                  03798000
CVTVOLT2 EQU   CVTTAT                                                   03799000
CVTVOLI2 EQU   CVTVOLF2                                                 03800000
CVTAQAVB EQU   CVTAQAVT+1                                               03801000
CVTRSV34 EQU   CVTTCMFG                                                 03802000
CVTRSV33 EQU   CVTTCMFG                                                 03803000
CVTRSV32 EQU   CVTTCMFG                                                 03804000
CVTRSV31 EQU   CVTTCMFG                                                 03805000
CVTRSV30 EQU   CVTTCMFG                                                 03806000
CVTRSV29 EQU   CVTTCMFG                                                 03807000
CVTRSV28 EQU   CVTTCMFG                                                 03808000
CVTTCRDY EQU   CVTTCMFG                                                 03809000
CVTGTFA  EQU   CVTGTF+1                                                 03810000
CVTRSV27 EQU   CVTGTFST                                                 03811000
CVTRNIO  EQU   CVTGTFST                                                 03812000
CVTUSR   EQU   CVTGTFST                                                 03813000
CVTRV318 EQU   CVTFORM                                                  03814000
CVTRV317 EQU   CVTTMODE                                                 03815000
CVTRV316 EQU   CVTSTATE                                                 03816000
CVTRV315 EQU   CVTGTFS                                                  03817000
CVTGTFAV EQU   CVTGTFS                                                  03818000
CVT0SCR1 EQU   CVTMAP+232                                               03819000
CVTRV515 EQU   CVTMAP+228                                               03820000
CVTRMS   EQU   CVTMAP+224                                               03821000
CVTPATCH EQU   CVTMAP+220                                               03822000
CVTTSCE  EQU   CVTMAP+216                                               03823000
CVTLNKSC EQU   CVTMAP+214                                               03824000
CVTQABST EQU   CVTMAP+212                                               03825000
CVTMDLDS EQU   CVTMAP+208                                               03826000
CVTUSER  EQU   CVTMAP+204                                               03827000
CVTABEND EQU   CVTMAP+200                                               03828000
CVTSMCA  EQU   CVTMAP+196                                               03829000
CVTRSV18 EQU   CVTMAP+192                                               03830000
CVTQLPAQ EQU   CVTMAP+188                                               03831000
CVTQCDSR EQU   CVTMAP+184                                               03832000
CVTRSV17 EQU   CVTOPTB                                                  03833000
CVTRSV16 EQU   CVTOPTB                                                  03834000
CVTFP    EQU   CVTOPTB                                                  03835000
CVTAPTHR EQU   CVTOPTB                                                  03836000
CVTNLOG  EQU   CVTOPTB                                                  03837000
CVTTOD   EQU   CVTOPTB                                                  03838000
CVTCTIMS EQU   CVTOPTB                                                  03839000
CVTPROT  EQU   CVTOPTB                                                  03840000
CVTXPFP  EQU   CVTOPTA                                                  03841000
CVTASCII EQU   CVTOPTA                                                  03842000
CVTRSV13 EQU   CVTOPTA                                                  03843000
CVTRSV12 EQU   CVTOPTA                                                  03844000
CVTNIP   EQU   CVTOPTA                                                  03845000
CVTDDR   EQU   CVTOPTA                                                  03846000
CVTAPR   EQU   CVTOPTA                                                  03847000
CVTCCH   EQU   CVTOPTA                                                  03848000
CVTSNCTR EQU   CVTMAP+180                                               03849000
CVTQMWR  EQU   CVTMAP+176                                               03850000
CVTQOCR  EQU   CVTMAP+172                                               03851000
CVT1EF00 EQU   CVTMAP+168                                               03852000
CVTMZ00  EQU   CVTMAP+164                                               03853000
CVTSV76Q EQU   CVTSV76C                                                 03854000
CVTRSV11 EQU   CVTMAP+156                                               03855000
CVT0PT01 EQU   CVTMAP+152                                               03856000
CVTMSER  EQU   CVTMAP+148                                               03857000
CVTRV516 EQU   CVTIERLC                                                 03858000
CVTILCH  EQU   CVTMAP+140                                               03859000
CVT0DS   EQU   CVTMAP+136                                               03860000
CVTFBOSV EQU   CVTMAP+132                                               03861000
CVTNUCB  EQU   CVTMAP+128                                               03862000
CVTIXAVL EQU   CVTMAP+124                                               03863000
CVTSV76M EQU   CVTIOQET                                                 03864000
CVTDCBA  EQU   CVTMAP+117                                               03865000
CVTMVS2  EQU   CVTDCB                                                   03866000
CVT6DAT  EQU   CVTDCB                                                   03867000
CVT4MPS  EQU   CVTDCB                                                   03868000
CVTRSV09 EQU   CVTDCB                                                   03869000
CVT4MS1  EQU   CVTDCB                                                   03870000
CVT2SPS  EQU   CVTDCB                                                   03871000
CVT1SSS  EQU   CVTDCB                                                   03872000
CVTRSV08 EQU   CVTDCB                                                   03873000
CVTSTB   EQU   CVTMAP+112                                               03874000
CVTQTD00 EQU   CVTMAP+108                                               03875000
CVTQTE00 EQU   CVTMAP+104                                               03876000
CVTCUCB  EQU   CVTMAP+100                                               03877000
CVTSJQ   EQU   CVTMAP+96                                                03878000
CVTPBLDL EQU   CVTMAP+92                                                03879000
CVTTPC   EQU   CVTMAP+88                                                03880000
CVTSVDCB EQU   CVTMAP+84                                                03881000
CVTBRET  EQU   CVTMAP+82                                                03882000
CVTEXIT  EQU   CVTMAP+80                                                03883000
CVT0FN00 EQU   CVTMAP+76                                                03884000
CVTDARA  EQU   CVTDAR+1                                                 03885000
CVTRSV07 EQU   CVTFLGS1                                                 03886000
CVTRSV06 EQU   CVTFLGS1                                                 03887000
CVTRSV05 EQU   CVTFLGS1                                                 03888000
CVTRSV04 EQU   CVTFLGS1                                                 03889000
CVTRSV03 EQU   CVTFLGS1                                                 03890000
CVTRSV02 EQU   CVTFLGS1                                                 03891000
CVTRSV01 EQU   CVTFLGS1                                                 03892000
CVTDMPLK EQU   CVTFLGS1                                                 03893000
CVTXITP  EQU   CVTMAP+68                                                03894000
CVTZDTAB EQU   CVTMAP+64                                                03895000
CVTMSLT  EQU   CVTMAP+60                                                03896000
CVTDATE  EQU   CVTMAP+56                                                03897000
CVTBTERM EQU   CVTMAP+52                                                03898000
CVTSYSAD EQU   CVTMAP+48                                                03899000
CVTXTLER EQU   CVTMAP+44                                                03900000
CVTILK2  EQU   CVTMAP+40                                                03901000
CVTILK1  EQU   CVTMAP+36                                                03902000
CVTPRLTV EQU   CVTMAP+32                                                03903000
CVTPCNVT EQU   CVTMAP+28                                                03904000
CVT0VL00 EQU   CVTMAP+24                                                03905000
CVTXAPG  EQU   CVTMAP+20                                                03906000
CVTBUF   EQU   CVTMAP+16                                                03907000
CVTJOB   EQU   CVTMAP+12                                                03908000
CVTLINK  EQU   CVTMAP+8                                                 03909000
CVT0EF00 EQU   CVTMAP+4                                                 03910000
CVTTCBP  EQU   CVTMAP                                                   03911000
CVT      EQU   CVTMAP                                                   03912000
CXDATEXT EQU   IKJEBECX                                                 03913000
CAPDEXT  EQU   IKJEBECA+3984                                            03914000
CADSNRC2 EQU   IKJEBECA+3928                                            03915000
CADSNOF2 EQU   IKJEBECA+3926                                            03916000
CADSNLN2 EQU   IKJEBECA+3924                                            03917000
CADSNPT2 EQU   IKJEBECA+3920                                            03918000
@NM00022 EQU   IKJEBECA+3900                                            03919000
CASVAREA EQU   IKJEBECA+3176                                            03920000
CAFIBFR  EQU   IKJEBECA+1188                                            03921000
CAAEDCB  EQU   IKJEBECA+1096                                            03922000
CALDROP  EQU   IKJEBECA+1064                                            03923000
CAATNWKA EQU   IKJEBECA+956                                             03924000
CAATNBUF EQU   IKJEBECA+952                                             03925000
CAMODETX EQU   CAMODEMG+12                                              03926000
CAMODEOF EQU   CAMODEMG+10                                              03927000
CAMODELN EQU   CAMODEMG+8                                               03928000
CAMODEPT EQU   CAMODEMG+4                                               03929000
CAMODEIS EQU   CAMODEMG                                                 03930000
CASRWKA  EQU   IKJEBECA+728                                             03931000
CAMSWKA  EQU   IKJEBECA+628                                             03932000
@NM00021 EQU   CAMAWKA+30                                               03933000
@NM00020 EQU   MACFLAG2                                                 03934000
MATABLE1 EQU   MACFLAG2                                                 03935000
@NM00019 EQU   MACFLAGS                                                 03936000
MAENDPRC EQU   MACFLAGS                                                 03937000
MAABBREV EQU   MACFLAGS                                                 03938000
MAECTMOD EQU   MACFLAGS                                                 03939000
@NM00018 EQU   CAMAWKA                                                  03940000
CASTAEPL EQU   IKJEBECA+576                                             03941000
CASTAXPL EQU   IKJEBECA+556                                             03942000
CASRPLST EQU   CATMPLST+12                                              03943000
CAPTECB  EQU   CATMPLST+8                                               03944000
CAPTECT  EQU   CATMPLST+4                                               03945000
CAPTUPT  EQU   CATMPLST                                                 03946000
CASYNSCN EQU   CASYNSW                                                  03947000
CASYNML  EQU   CASYNSW                                                  03948000
CASYNSF  EQU   CASYNSW                                                  03949000
CASYNRFM EQU   CASYNSW                                                  03950000
@NM00017 EQU   CASYNSW                                                  03951000
CASYNLN  EQU   CASYNSW                                                  03952000
@NM00016 EQU   CASYNSW                                                  03953000
CASYNRCL EQU   CASYNOPT+2                                               03954000
CASYNCD1 EQU   CASYNOPT                                                 03955000
CASYNTEM EQU   CASYNWA+12                                               03956000
CASYNMS2 EQU   CASYNWA+8                                                03957000
CASYNWAP EQU   CASYNWA+1                                                03958000
CASYNPTO EQU   CASYNLST+8                                               03959000
CASYNPWA EQU   CASYNLST+4                                               03960000
@NM00015 EQU   IKJEBECA+484                                             03961000
CARECNO  EQU   IKJEBECA+480                                             03962000
@NM00014 EQU   IKJEBECA+472                                             03963000
CASAPSWD EQU   IKJEBECA+440                                             03964000
CASADDN  EQU   IKJEBECA+432                                             03965000
CASAMEMB EQU   IKJEBECA+424                                             03966000
CASADSN  EQU   IKJEBECA+380                                             03967000
CASADSNL EQU   IKJEBECA+378                                             03968000
CASADQTY EQU   CASAFLG2                                                 03969000
CASANCTG EQU   CASAFLG2                                                 03970000
CASAALOC EQU   CASAFLAG                                                 03971000
CASAUNCG EQU   CASAFLAG                                                 03972000
CASADSOR EQU   CASAFLAG                                                 03973000
CASAMEM  EQU   CASAFLAG                                                 03974000
CASADISP EQU   CASAFLAG                                                 03975000
CASAINCP EQU   CASAFLAG                                                 03976000
CASAFNCP EQU   CASAFLAG                                                 03977000
CASAVEDS EQU   CASAFLAG                                                 03978000
CADSNREC EQU   IKJEBECA+320                                             03979000
CADSNOFF EQU   IKJEBECA+318                                             03980000
CADSNLEN EQU   IKJEBECA+316                                             03981000
CADSNPTR EQU   IKJEBECA+312                                             03982000
CAEDTSIZ EQU   IKJEBECA+308                                             03983000
CAEDPSWD EQU   IKJEBECA+300                                             03984000
CAEDDDN  EQU   IKJEBECA+292                                             03985000
CAEDMEMB EQU   IKJEBECA+284                                             03986000
CAEDDSN  EQU   IKJEBECA+240                                             03987000
CAEDDSNL EQU   IKJEBECA+238                                             03988000
CAEDPRTC EQU   CAEDFLG2                                                 03989000
CAEDALOC EQU   CAEDFLAG                                                 03990000
CAEDUNCG EQU   CAEDFLAG                                                 03991000
CAEDDSOR EQU   CAEDFLAG                                                 03992000
CAEDMEM  EQU   CAEDFLAG                                                 03993000
CAEDDISP EQU   CAEDFLAG                                                 03994000
CAEDINCP EQU   CAEDFLAG                                                 03995000
CAEDFNCP EQU   CAEDFLAG                                                 03996000
CAEDITDS EQU   CAEDFLAG                                                 03997000
CABLK2   EQU   IKJEBECA+234                                             03998000
@NM00013 EQU   IKJEBECA+226                                             03999000
CAPDEND  EQU   CAPD+82                                                  04000000
CADATEXT EQU   CAPD+74                                                  04001000
CAEXTNAM EQU   CAPD+66                                                  04002000
CAPRNAME EQU   CAPD+58                                                  04003000
CACHKOPT EQU   CAPD+56                                                  04004000
CAULRLMX EQU   CAPD+54                                                  04005000
CAULRLDF EQU   CAPD+52                                                  04006000
CAVLRLMX EQU   CAPD+50                                                  04007000
CAVLRLDF EQU   CAPD+48                                                  04008000
CAFLRLMX EQU   CAPD+46                                                  04009000
CAFLRLDF EQU   CAPD+44                                                  04010000
CARECFMD EQU   CAPD+43                                                  04011000
@NM00012 EQU   CADSATR2                                                 04012000
CAINLIST EQU   CADSATR2                                                 04013000
CARUNDS  EQU   CADSATR2                                                 04014000
CAOBJGEN EQU   CADSATR2                                                 04015000
CADSNDEF EQU   CADSATR2                                                 04016000
CALINTAB EQU   CADSATR2                                                 04017000
@NM00011 EQU   CADSATTR                                                 04018000
CALRECLX EQU   CADSATTR                                                 04019000
CALNNUM  EQU   CADSATTR                                                 04020000
CACAPSDF EQU   CADSATTR                                                 04021000
CACAPSRQ EQU   CADSATTR                                                 04022000
CASCAN   EQU   CADSATTR                                                 04023000
CARUN    EQU   CADSATTR                                                 04024000
CATABS   EQU   CAPD+20                                                  04025000
CALENGTH EQU   CAPD+19                                                  04026000
CALINE   EQU   CAPD+18                                                  04027000
CABLKS   EQU   CAPD+16                                                  04028000
CADSQUAL EQU   CAPD+8                                                   04029000
CADSTYPE EQU   CAPD                                                     04030000
@NM00010 EQU   CACFLAG+8                                                04031000
CAPLIRTM EQU   CACFLAG+7                                                04032000
CAPLILFM EQU   CACFLAG+6                                                04033000
@NM00009 EQU   CACFLAG6                                                 04034000
CACHAR60 EQU   CACFLAG6                                                 04035000
CACHAR48 EQU   CACFLAG6                                                 04036000
CAFREE   EQU   CACFLAG6                                                 04037000
@NM00008 EQU   CACFLAG5                                                 04038000
CAEDLNDP EQU   CACFLAG5                                                 04039000
CADSUSED EQU   CACFLAG4                                                 04040000
CARECURS EQU   CACFLAG4                                                 04041000
CAINPROC EQU   CACFLAG4                                                 04042000
CASCRC20 EQU   CACFLAG4                                                 04043000
CAABEND  EQU   CACFLAG4                                                 04044000
CATPUTVF EQU   CACFLAG4                                                 04045000
CAPTGTBF EQU   CACFLAG4                                                 04046000
CAFINDIS EQU   CACFLAG4                                                 04047000
@NM00007 EQU   CAIMFLG                                                  04048000
@NM00006 EQU   CACFLAG2                                                 04049000
CAX22ABN EQU   CACFLAG2                                                 04050000
CAX37ABN EQU   CACFLAG2                                                 04051000
CASEQCOL EQU   CACFLAG2                                                 04052000
CASCANON EQU   CACFLAG2                                                 04053000
CADSMODS EQU   CACFLAG2                                                 04054000
CACAPS   EQU   CACFLAG1                                                 04055000
CAENDSC  EQU   CACFLAG1                                                 04056000
CAINITSC EQU   CACFLAG1                                                 04057000
CAVRFYSW EQU   CACFLAG1                                                 04058000
CALNTOVF EQU   CACFLAG1                                                 04059000
@NM00005 EQU   CAATTN                                                   04060000
@NM00004 EQU   IKJEBECA+118                                             04061000
CAMAXBLK EQU   IKJEBECA+116                                             04062000
CAESDSPL EQU   IKJEBECA+112                                             04063000
@NM00003 EQU   IKJEBECA+88                                              04064000
CAPTICLN EQU   IKJEBECA+84                                              04065000
CAPTICDS EQU   IKJEBECA+80                                              04066000
CAPTNBFR EQU   IKJEBECA+76                                              04067000
CACORELN EQU   IKJEBECA+68                                              04068000
CAPTCORE EQU   IKJEBECA+64                                              04069000
CAUTILNO EQU   IKJEBECA+60                                              04070000
CAPTPDCB EQU   IKJEBECA+56                                              04071000
@NM00002 EQU   IKJEBECA+50                                              04072000
CASCMDLN EQU   IKJEBECA+48                                              04073000
CAPTSCMD EQU   IKJEBECA+44                                              04074000
CAPTRTRY EQU   IKJEBECA+32                                              04075000
CAPTMSGM EQU   IKJEBECA+28                                              04076000
CAPTUT   EQU   IKJEBECA+24                                              04077000
CAPTMS   EQU   IKJEBECA+20                                              04078000
CAPTLE   EQU   IKJEBECA+16                                              04079000
CAPTAT   EQU   IKJEBECA+12                                              04080000
CAPTAE   EQU   IKJEBECA+8                                               04081000
@NM00001 EQU   IKJEBECA+4                                               04082000
CAPTTMP  EQU   IKJEBECA                                                 04083000
*                                      END UNREFERENCED COMPONENTS      04084000
@RC00180 EQU   EXIT                                                     04085000
@RC00190 EQU   EXIT                                                     04086000
@RT00175 EQU   @RC00158                                                 04087000
@RF00158 EQU   BTMPRMT                                                  04088000
@RT00228 EQU   BTMPRMT                                                  04089000
@RC00231 EQU   BOTTOM                                                   04090000
@RT00280 EQU   INDSFPT                                                  04091000
@RC00284 EQU   @RC00283                                                 04092000
@RF00356 EQU   @RC00354                                                 04093000
@RT00364 EQU   IORET                                                    04094000
@RC00373 EQU   IORET                                                    04095000
GETNEXT  EQU   MAINLP                                                   04096000
@RT00463 EQU   SETPRMPT                                                 04097000
@RF00470 EQU   LPOUT1                                                   04098000
@RF00504 EQU   MVNUM                                                    04099000
@RT00521 EQU   RDTERM                                                   04100000
@RF00537 EQU   EXIT2                                                    04101000
@RT00559 EQU   NOCORE                                                   04102000
@RT00562 EQU   EXIT2                                                    04103000
@RT00578 EQU   EXIT1                                                    04104000
@RT00597 EQU   @RC00595                                                 04105000
@RF00614 EQU   RFORMLP                                                  04106000
@RT00624 EQU   @RC00619                                                 04107000
@RT00650 EQU   SYNSCAN                                                  04108000
@RT00654 EQU   NOCHKR                                                   04109000
@RF00672 EQU   LPOUT                                                    04110000
@RT00696 EQU   EXIT2                                                    04111000
@RT00767 EQU   NOLINE                                                   04112000
@RF00803 EQU   NOCOREMG                                                 04113000
@RT00812 EQU   NOCOREMG                                                 04114000
@RT00827 EQU   SYNEXIT                                                  04115000
@RF00843 EQU   EXITCK                                                   04116000
@RT00873 EQU   SNEREXIT                                                 04117000
@RF00851 EQU   EXITCK                                                   04118000
@RT00896 EQU   NOCOREMG                                                 04119000
@RC00842 EQU   SNEREXIT                                                 04120000
@PB00009 EQU   @EL00001                                                 04121000
@PB00008 EQU   @PB00009                                                 04122000
@PB00007 EQU   @PB00008                                                 04123000
@PB00006 EQU   @PB00007                                                 04124000
@PB00005 EQU   @PB00006                                                 04125000
@PB00004 EQU   @PB00005                                                 04126000
@PB00003 EQU   @PB00004                                                 04127000
@PB00002 EQU   @PB00003                                                 04128000
@ENDDATA EQU   *                                                        04129000
         END   IKJEBEIP,(C'PLS1515',0701,78121)                         04130000
