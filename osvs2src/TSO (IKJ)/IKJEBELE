         TITLE 'IKJEBELE - LINE EDIT SERVICE RTN - TSO EDIT COMMAND    *00001000
                        '                                               00002000
IKJEBELE CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEBELE  76.027'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
*                                                                  0018 00014000
*           COMMREG = PARMREG0;      /* GET ADDR OF IKJEBECA         */ 00015000
*                                                                  0018 00016000
         LR    COMMREG,PARMREG0                                    0018 00017000
*           RESPECIFY (GPR13P,GPR15P) RSTD;                        0019 00018000
*           GPR15P = CANXTSVA;       /* SAVE AREA FOR THIS MODULE    */ 00019000
         L     GPR15P,CANXTSVA(,COMMREG)                           0020 00020000
*           EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS     */ 00021000
         LA    @14,4                                               0021 00022000
         ALR   @14,GPR15P                                          0021 00023000
         ST    GPR13P,CASAVPTR(,@14)                               0021 00024000
*                                    /* SAVEAREA BKWD PTR            */ 00025000
*           EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER   */ 00026000
         LA    @14,8                                               0022 00027000
         ALR   @14,GPR13P                                          0022 00028000
         ST    GPR15P,CASAVPTR(,@14)                               0022 00029000
*                                    /* FWD PTR                      */ 00030000
*           GPR13P = GPR15P;         /* NEW SAVEAREA ADDR            */ 00031000
         LR    GPR13P,GPR15P                                       0023 00032000
*           CANXTSVA = GPR13P + 72;   /* UPDATE NEX-SAVE-AREA PTR    */ 00033000
         LA    @14,72                                              0024 00034000
         ALR   @14,GPR13P                                          0024 00035000
         ST    @14,CANXTSVA(,COMMREG)                              0024 00036000
*           RESPECIFY (GPR13P,GPR15P) UNRSTD;                      0025 00037000
*                                                                  0025 00038000
*           DATAREG = ADDR(CASRWKA);   /* SET BASE REG FOR WORK AREA */ 00039000
         LA    DATAREG,CASRWKA(,COMMREG)                           0026 00040000
*           GEN( USING @DATD,DATAREG);   /* SET ADDRESSABILITY TO    */ 00041000
          USING @DATD,DATAREG                                           00042000
*                                    /* CASCWKA                      */ 00043000
*     /*       THESE REGISTERS REMAIN RESTRICTED                      * 00044000
*        RESPECIFY (DATAREG,COMMREG) RSTD;                         0028 00045000
*        RETCODE = 0;                  /* INIT RETURN CODE TO 0       * 00046000
         SLR   RETCODE,RETCODE                                     0029 00047000
*        RETCODX = 0;                  /* INIT OVERFLOW RET CODE TO 0 * 00048000
         SLR   @12,@12                                             0030 00049000
         ST    @12,RETCODX                                         0030 00050000
*        GETOF = 0;                    /* INIT GETMAIN PTR TO ZERO    * 00051000
*                                                                  0031 00052000
         ST    @12,GETOF                                           0031 00053000
*        /* CHECK IF NULL LINE PASSED                                 * 00054000
*        IF TEXTLEN <= 4                                           0032 00055000
*          THEN                        /* IF YES, GENERATE BLANK LINE * 00056000
         SLR   @12,@12                                             0032 00057000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0032 00058000
         LH    @06,TEXTLEN(,@12)                                   0032 00059000
         CH    @06,@CH00398                                        0032 00060000
         BH    @RF00032                                            0032 00061000
*            DO;                       /* GEN BLANK LINE              * 00062000
*              TEXTLEN = 5;            /* SET LENGTH TO MINIMUM       * 00063000
         MVC   TEXTLEN(2,@12),@CH00127                             0034 00064000
*              TEXTBFR (1) = ' ';      /* INSERT BLANK IN LINE        * 00065000
         MVI   TEXTBFR(@12),C' '                                   0035 00066000
*            END;                                                  0036 00067000
*                                                                  0036 00068000
*        /* CHECK IF INPUT TEXT IS NOT A DELIMITED STRING             * 00069000
*        IF ENTRYCD ^= '80'X                                       0037 00070000
*          THEN                        /* IF YES,STRIP TRAILING BLANKS* 00071000
@RF00032 CLI   ENTRYCD(PARMREG1),X'80'                             0037 00072000
         BE    @RF00037                                            0037 00073000
*            DO;                       /* STRIP BLANKS                * 00074000
*                                                                  0038 00075000
*              /* LOOP BACKWARDS TO FIND LAST BLANK                   * 00076000
*              DO A = TEXTLEN - 4 TO 1 BY - 1;                     0039 00077000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0039 00078000
         LH    @12,TEXTLEN(,@12)                                   0039 00079000
         SH    @12,@CH00398                                        0039 00080000
         STH   @12,A                                               0039 00081000
         B     @DE00039                                            0039 00082000
@DL00039 DS    0H                                                  0040 00083000
*                CURPTR = A;           /* PTR TO LAST BYTE OF TEXT    * 00084000
*                                                                  0040 00085000
         LR    CURPTR,@12                                          0040 00086000
*                /* CHECK IF LAST NON-BLANK IN TEXT FOUND             * 00087000
*                IF TEXTBFR (CURPTR) ^= ' '                        0041 00088000
*                  THEN                /* IF YES, RESET BUFFER LENGTH * 00089000
         SLR   @12,@12                                             0041 00090000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0041 00091000
         LR    @06,@12                                             0041 00092000
         ALR   @06,CURPTR                                          0041 00093000
         CLI   TEXTBFR-1(@06),C' '                                 0041 00094000
         BE    @RF00041                                            0041 00095000
*                    DO;               /* RESET BFR LENGTH            * 00096000
*                      TEXTLEN = CURPTR + 4;    /* SET NEW LENGTH     * 00097000
         LA    @06,4                                               0043 00098000
         ALR   @06,CURPTR                                          0043 00099000
         STH   @06,TEXTLEN(,@12)                                   0043 00100000
*                      GO TO OUT;      /* BRANCH OUT OF LOOP          * 00101000
         B     OUT                                                 0044 00102000
*                    END;                                          0045 00103000
*              END;                    /* END OF SEARCH LOOP          * 00104000
@RF00041 SLR   @12,@12                                             0046 00105000
         BCTR  @12,0                                               0046 00106000
         AH    @12,A                                               0046 00107000
         STH   @12,A                                               0046 00108000
@DE00039 LTR   @12,@12                                             0046 00109000
         BP    @DL00039                                            0046 00110000
*              TEXTLEN = CURPTR + 4;   /* SET NEW LENGTH     @ZA08706*/ 00111000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0047 00112000
         LA    @06,4                                               0047 00113000
         ALR   @06,CURPTR                                          0047 00114000
         STH   @06,TEXTLEN(,@12)                                   0047 00115000
*            END;                                                  0048 00116000
*                                                                  0048 00117000
*OUT:                                  /* EXIT FROM LOOP              * 00118000
*        /* CHECK IF INPUT LINE EXCEEDS MAX MOVE LENGTH         A42945* 00119000
*        IF TEXTLEN > 260              /*                       A42945* 00120000
*          THEN                        /* IF YES, REDUCE LENGTH A42945* 00121000
@RF00037 DS    0H                                                  0049 00122000
OUT      ICM   @12,7,TEXTPTR(PARMREG1)                             0049 00123000
         LH    @12,TEXTLEN(,@12)                                   0049 00124000
         CH    @12,@CH00286                                        0049 00125000
         BNH   @RF00049                                            0049 00126000
*            DO;                       /* BEGIN REDUCING LENGTH A42945* 00127000
         ST    @12,@TF00001                                        0050 00128000
*              LNGTHREG = TEXTLEN - 260 + 4;    /* LEN OF OFLOW A42945* 00129000
         LH    LNGTHREG,@CH00450                                   0051 00130000
         AL    LNGTHREG,@TF00001                                   0051 00131000
*              SREG0 = PARMREG0;       /* SAVE REG ZERO         A42945* 00132000
         LR    SREG0,PARMREG0                                      0052 00133000
*              SREG1 = PARMREG1;       /* SAVE REG ONE          A42945* 00134000
         LR    SREG1,PARMREG1                                      0053 00135000
*    GENERATE REFS(LNGTHREG,GETOF);/* GET CORE FOR OVERFLOW  @ZM30978*/ 00136000
         GETMAIN EC,LV=(LNGTHREG),A=GETOF,SP=1,MF=(E,GETAREA)    A42945 00137000
*              RESPECIFY (RETCDREG) RSTD;                          0055 00138000
*              PARMREG0 = SREG0;       /* RESTORE REG ZERO      A42945* 00139000
         LR    PARMREG0,SREG0                                      0056 00140000
*              PARMREG1 = SREG1;       /* RESTORE REG ONE       A42945* 00141000
         LR    PARMREG1,SREG1                                      0057 00142000
*                                      /*                       A42945* 00143000
*              /* IF GETMAIN FAILED                             A42945* 00144000
*              IF RETCDREG ^= 0        /*                       A42945* 00145000
*                THEN                  /* THEN                  A42945* 00146000
         SLR   @14,@14                                             0058 00147000
         CR    RETCDREG,@14                                        0058 00148000
         BE    @RF00058                                            0058 00149000
*                  DO;                 /* SET                   A42945* 00150000
*                    RESPECIFY (RETCDREG) UNRSTD;                  0060 00151000
*                    RETCODX = 8;      /* RET. CODE FOR NO CORE A42945* 00152000
         MVC   RETCODX(4),@CF00055                                 0061 00153000
*                    GETOF = 0;        /* ZERO GOTTEN CORE PTR  A42945* 00154000
         ST    @14,GETOF                                           0062 00155000
*                    GO TO NOCORS;     /* BYPASS LENGTH SETTING A42945* 00156000
         B     NOCORS                                              0063 00157000
*                  END;                /*                       A42945* 00158000
*              GETLEN = TEXTLEN - 260 + 4;    /* UPDTE OVERFLOW A42945* 00159000
@RF00058 L     @12,GETOF                                           0065 00160000
         SLR   @08,@08                                             0065 00161000
         ICM   @08,7,TEXTPTR(PARMREG1)                             0065 00162000
         LH    @06,@CH00450                                        0065 00163000
         AH    @06,TEXTLEN(,@08)                                   0065 00164000
         STH   @06,GETLEN(,@12)                                    0065 00165000
*              GETOFFS = 0;            /* ZERO THE OFFSET       A42945* 00166000
         SLR   @15,@15                                             0066 00167000
         STH   @15,GETOFFS(,@12)                                   0066 00168000
*              GETTXT (1:GETLEN - 4) =      /*                  A42945* 00169000
*                INPUTBFR (260 + 1:TEXTLEN);   /* MOVE TEXT     A42945* 00170000
         SH    @06,@CH00127                                        0067 00171000
         EX    @06,@SM00452                                        0067 00172000
*NOCORS:       RETCODE = 4;            /* SET RETCDE FOR OVERFL A42945* 00173000
NOCORS   LA    RETCODE,4                                           0068 00174000
*              TEXTLEN = 260;          /* RESET MAX MOVE LENGTH A42945* 00175000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0069 00176000
         MVC   TEXTLEN(2,@12),@CH00286                             0069 00177000
*            END;                      /*                       A42945* 00178000
*                                      /*                       A42945* 00179000
*        /* CHECK IF 'CAPS' SPECIFIED ON EDIT COMMAND           A42945* 00180000
*        IF CACAPS = '1'B              /*                       A42945* 00181000
*          THEN                        /* IF YES, CONVERT TEXT  A42945  00182000
*                                         TO UPPER CASE CHARS   A42945* 00183000
@RF00049 TM    CACAPS(COMMREG),B'00000010'                         0071 00184000
         BNO   @RF00071                                            0071 00185000
*            DO;                       /* CONVERT TO UPPER CASE A42945* 00186000
*              LNGTHREG = TEXTLEN - 5;   /* LENGTH OF TRANSLATE A42945* 00187000
         SLR   @12,@12                                             0073 00188000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0073 00189000
         LH    LNGTHREG,TEXTLEN(,@12)                              0073 00190000
         SH    LNGTHREG,@CH00127                                   0073 00191000
*              TXTPTREG = ADDR (TEXTBFR);/* EXECUTE TRANSLATION F42945* 00192000
         LA    TXTPTREG,TEXTBFR(,@12)                              0074 00193000
*              GEN (EX    LNGTHREG,TRNSLATE)  /* TRANSLATE      A42945* 00194000
*                REFS(LNGTHREG);       /*                       A42945* 00195000
         EX    LNGTHREG,TRNSLATE                                        00196000
*              /* CHECK IF ADDITIONAL TEXT TO TRANSLATE         A42945* 00197000
*              IF RETCODE = 4          /*                       A42945* 00198000
*                THEN                  /* IF YES, PREPARE TRANS A42945* 00199000
         CH    RETCODE,@CH00398                                    0076 00200000
         BNE   @RF00076                                            0076 00201000
*                  DO;                 /* CONVERT TO UPPER CASE A42945* 00202000
*                    LNGTHREG = GETLEN - 5;   /* LEN OF TRANS   A42945* 00203000
         L     @12,GETOF                                           0078 00204000
         LH    LNGTHREG,GETLEN(,@12)                               0078 00205000
         SH    LNGTHREG,@CH00127                                   0078 00206000
*                    TXTPTREG = ADDR(GETTXT); /* PTR TO TEXT    A42945* 00207000
         LA    TXTPTREG,GETTXT(,@12)                               0079 00208000
*                    GEN (EX    LNGTHREG,TRNSLATE)  /* EXEC TR  A42945* 00209000
*                      REFS(LNGTHREG);                             0080 00210000
         EX    LNGTHREG,TRNSLATE                                        00211000
*                  END;                /*                       A42945* 00212000
*            END;                      /*                       A42945* 00213000
@RF00076 DS    0H                                                  0083 00214000
*        LENGTH = TEXTLEN;             /* PICK UP BUFFER LENGTH A42945* 00215000
@RF00071 SLR   @12,@12                                             0083 00216000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0083 00217000
         LH    LENGTH,TEXTLEN(,@12)                                0083 00218000
*                                      /*                       A42945* 00219000
*        /* CHECK IF LINE TO BE ADJUSTED FOR SEQ FIELD          A42945* 00220000
*        IF CANONUM = '0'B & CALINTAB = '1'B & ENTRYCD ^= '80'X    0084 00221000
*          THEN                        /* IF YES, SLIDE LINE OVER     * 00222000
         TM    CANONUM(COMMREG),B'00000001'                        0084 00223000
         BNZ   @RF00084                                            0084 00224000
         TM    CALINTAB(COMMREG),B'10000000'                       0084 00225000
         BNO   @RF00084                                            0084 00226000
         CLI   ENTRYCD(PARMREG1),X'80'                             0084 00227000
         BE    @RF00084                                            0084 00228000
*            DO;                       /* SLIDE LINE OVER             * 00229000
*                                                                  0085 00230000
*              /* MOVE INTO TM                                        * 00231000
*              TEMPBFR (1:LENGTH - 4) = TEXTBFR;                   0086 00232000
         LR    @06,LENGTH                                          0086 00233000
         SH    @06,@CH00127                                        0086 00234000
         EX    @06,@SM00454                                        0086 00235000
*              TEXTBFR = '';           /* BLANK OUT LINE              * 00236000
*                                                                  0087 00237000
         MVI   TEXTBFR(@12),C' '                                   0087 00238000
         MVC   TEXTBFR+1(255,@12),TEXTBFR(@12)                     0087 00239000
*              /* MOVE LINE BACK OFFSET BY LENGTH OF SEQUENCE FIELD   * 00240000
*              /* MOVE LINE                                           * 00241000
*              TEXTBFR (CALINE + CALENGTH:LENGTH + CALENGTH - 4) = 0088 00242000
*                  TEMPBFR(1:LENGTH-CALINE-3);                     0088 00243000
         SLR   @06,@06                                             0088 00244000
         IC    @06,CALENGTH(,COMMREG)                              0088 00245000
         SLR   @02,@02                                             0088 00246000
         IC    @02,CALINE(,COMMREG)                                0088 00247000
         ALR   @02,@06                                             0088 00248000
         ALR   @12,@02                                             0088 00249000
         LR    @15,LENGTH                                          0088 00250000
         ALR   @15,@06                                             0088 00251000
         SLR   @15,@02                                             0088 00252000
         SH    @15,@CH00398                                        0088 00253000
         EX    @15,@SM00456                                        0088 00254000
*              LENGTH = LENGTH + CALENGTH; /* ADJUST  LL FIELD        * 00255000
         ALR   LENGTH,@06                                          0089 00256000
*            END;                                                  0090 00257000
*                                                                  0090 00258000
*        /* CHECK IF TABULATION SPECIFIED                             * 00259000
*        IF CATABS (1) = 'FF'X                                     0091 00260000
*          THEN                        /* IF YES, CHECK TEXT TYPE CODE* 00261000
@RF00084 CLI   CATABS(COMMREG),X'FF'                               0091 00262000
         BNE   @RF00091                                            0091 00263000
*            DO;                       /* CHECK CODE                  * 00264000
*                                                                  0092 00265000
*              /* CHECK IF DELIMITTED STRING                          * 00266000
*              IF ENTRYCD = '80'X                                  0093 00267000
*                THEN                  /* IF YES, IGNORE TAB SWITCH   * 00268000
         CLI   ENTRYCD(PARMREG1),X'80'                             0093 00269000
         BE    @RT00093                                            0093 00270000
*                  GO TO NOTABS;       /* AND BR TO TURN OFF SW       * 00271000
*              TABSW = 'FF'X;          /* SET PGM TAB SWITCH ON       * 00272000
         MVI   TABSW,X'FF'                                         0095 00273000
*              GO TO TABSCAN;          /* BRANCH TO BEGIN TEXT SCAN   * 00274000
         B     TABSCAN                                             0096 00275000
*            END;                      /* END OF DELIM STRING GRP     * 00276000
*NOTABS:                               /* NO TABS SET                 * 00277000
*        TABSW = '00'X;                /* RTN FOR NO TABS SET SET PGM   00278000
*                                         TAB SWITCH OFF              * 00279000
*                                                                  0098 00280000
@RF00091 DS    0H                                                  0098 00281000
NOTABS   MVI   TABSW,X'00'                                         0098 00282000
*TABSCAN:                              /* SCAN TABS IF TO BE          * 00283000
*                                                                  0099 00284000
*        /* BLANKED OUT ONLY                                          * 00285000
*        IF TABSW = '00'X                                          0099 00286000
*          THEN                        /* IF YES, SCAN FOR TABS       * 00287000
TABSCAN  CLI   TABSW,X'00'                                         0099 00288000
         BNE   @RF00099                                            0099 00289000
*            DO;                       /* SCAN FOR TABS               * 00290000
*                                                                  0100 00291000
*              /* SEARCH FOR TAB CHARACTERS                           * 00292000
*              DO A = 1 TO LENGTH - 4;                             0101 00293000
         LA    @12,1                                               0101 00294000
         B     @DE00101                                            0101 00295000
@DL00101 DS    0H                                                  0102 00296000
*                CURTAB = A;           /* PTR TO SEARCH BYTE          * 00297000
*                                                                  0102 00298000
         STH   @12,CURTAB                                          0102 00299000
*                /* CHECK IF TABULATION CHARACTER                     * 00300000
*                IF TEXTBFR (CURTAB) = '05'X                       0103 00301000
*                  THEN                /* IF YES, BLANK OUT TAB       * 00302000
         SLR   @06,@06                                             0103 00303000
         ICM   @06,7,TEXTPTR(PARMREG1)                             0103 00304000
         ALR   @12,@06                                             0103 00305000
         CLI   TEXTBFR-1(@12),X'05'                                0103 00306000
         BNE   @RF00103                                            0103 00307000
*                    TEXTBFR (CURTAB) = ' ';   /* BLANK OUT TAB       * 00308000
         LH    @12,CURTAB                                          0104 00309000
         ALR   @06,@12                                             0104 00310000
         MVI   TEXTBFR-1(@06),C' '                                 0104 00311000
*              END;                    /* END OF SEARCH LOOP          * 00312000
*                                                                  0105 00313000
@RF00103 LA    @12,1                                               0105 00314000
         AH    @12,A                                               0105 00315000
@DE00101 STH   @12,A                                               0105 00316000
         LR    @06,LENGTH                                          0105 00317000
         SH    @06,@CH00398                                        0105 00318000
         CR    @12,@06                                             0105 00319000
         BNH   @DL00101                                            0105 00320000
*              /* CHECK IF DELIMITED STRING                           * 00321000
*              IF ENTRYCD = '80'X                                  0106 00322000
*                THEN                  /* IF YES, EXIT                * 00323000
         CLI   ENTRYCD(PARMREG1),X'80'                             0106 00324000
         BE    @RT00106                                            0106 00325000
*                  GO TO ENDSCAN;      /* EXIT FROM SCAN RTN          * 00326000
*                ELSE                  /* IF NO, FORMAT DATA AS RECORD* 00327000
*                  DO;                 /* FMT DATA                    * 00328000
*                    TABINDEX = 2;     /* SET INDEX                   * 00329000
         MVI   TABINDEX,X'02'                                      0109 00330000
*                    GO TO TABEXIT;    /* EXIT RTN                    * 00331000
         B     TABEXIT                                             0110 00332000
*                  END;                                            0111 00333000
*            END;                                                  0112 00334000
*        CURPTR = 1;                   /* SCAN TEXT TO SHIFT          * 00335000
@RF00099 LA    @12,1                                               0113 00336000
         LR    CURPTR,@12                                          0113 00337000
*        TABINDEX = 2;                 /* SET A TAB INDEX             * 00338000
         MVI   TABINDEX,X'02'                                      0114 00339000
*        LASTTAB = 0;                  /* INIT TO ZERO                * 00340000
*                                                                  0115 00341000
         SLR   @06,@06                                             0115 00342000
         STH   @06,LASTTAB                                         0115 00343000
*        /* SCAN WHOLE BUFFER                                         * 00344000
*        DO A = 1 TO LENGTH - 4;                                   0116 00345000
         B     @DE00116                                            0116 00346000
@DL00116 DS    0H                                                  0117 00347000
*          CURTAB = A;                 /* PTR TO SEARCH BYTE          * 00348000
*                                                                  0117 00349000
         STH   @12,CURTAB                                          0117 00350000
*          /* CHECK IF TABULATION CHARACTER FOUND                     * 00351000
*          IF TEXTBFR (CURTAB) = '05'X                             0118 00352000
*            THEN                      /* IF YES, PROCESS TAB         * 00353000
         ICM   @06,7,TEXTPTR(PARMREG1)                             0118 00354000
         ALR   @06,@12                                             0118 00355000
         CLI   TEXTBFR-1(@06),X'05'                                0118 00356000
         BNE   @RF00118                                            0118 00357000
*              DO;                     /* PROCESS TAB                 * 00358000
*                                                                  0119 00359000
*                /* CHECK IF END OF TABULATION TABLE REACHED          * 00360000
*                IF CATABS (TABINDEX) = '00'X                      0120 00361000
*                  THEN                /* IF YES, BLANK OUT TAB CHAR  * 00362000
         SLR   @12,@12                                             0120 00363000
         IC    @12,TABINDEX                                        0120 00364000
         ALR   @12,COMMREG                                         0120 00365000
         CLI   CATABS-1(@12),X'00'                                 0120 00366000
         BNE   @RF00120                                            0120 00367000
*                    DO;               /* BLANK TAB                   * 00368000
*                      CALL BLANKTAB;  /* BLANK OUT REST OF TABS      * 00369000
         BAL   @14,BLANKTAB                                        0122 00370000
*                      GO TO TABEXIT;  /* TEXT SCAN COMPLETED         * 00371000
         B     TABEXIT                                             0123 00372000
*                    END;                                          0124 00373000
*                                                                  0124 00374000
*                /* CHECK IF THIS IS FIRST TAB FOUND                  * 00375000
*                IF LASTTAB = 0                                    0125 00376000
*                  THEN                /* IF YES, FIRST TAB FOUND     * 00377000
@RF00120 ICM   @12,3,LASTTAB                                       0125 00378000
         BNZ   @RF00125                                            0125 00379000
*                    DO;               /* CHECK TAB                   * 00380000
*                                                                  0126 00381000
*                      /* CHECK IF TABULATION CHARACTER IS FIRST IN   * 00382000
*                      /* LINE                                        * 00383000
*                      IF CURTAB > 1                               0127 00384000
*                        THEN          /* IF NO, MOVE DATA UPTO TAB   * 00385000
*                                                                  0127 00386000
         LH    @12,CURTAB                                          0127 00387000
         CH    @12,@CH00057                                        0127 00388000
         BNH   @RF00127                                            0127 00389000
*                          /* MOVE DATA INTO TEMP BFR                 * 00390000
*                          TEMPBFR (1:CURTAB - 1) = TEXTBFR;       0128 00391000
         BCTR  @12,0                                               0128 00392000
         BCTR  @12,0                                               0128 00393000
         ICM   @02,7,TEXTPTR(PARMREG1)                             0128 00394000
         EX    @12,@SM00458                                        0128 00395000
*                      LASTTAB = CURTAB; /* SET LAST TAB TO CURRENT   * 00396000
@RF00127 LH    @12,CURTAB                                          0129 00397000
         STH   @12,LASTTAB                                         0129 00398000
*                      CURPTR = CURTAB;/* SET PTR TO CURRENT          * 00399000
         LR    CURPTR,@12                                          0130 00400000
*                      GO TO CONTSCAN; /* BR TO CONTINUE SCAN         * 00401000
         B     CONTSCAN                                            0131 00402000
*                    END;                                          0132 00403000
*                CALL TABRTN;          /* FIND TAB OFFSET & MOVE DATA * 00404000
@RF00125 BAL   @14,TABRTN                                          0133 00405000
*              END;                                                0134 00406000
*CONTSCAN:                             /* CONTINUE SCAN               * 00407000
*        END;                          /* CONTINUE SCAN END OF SCAN     00408000
*                                         ROUTINE                     * 00409000
*                                                                  0135 00410000
@RF00118 DS    0H                                                  0135 00411000
CONTSCAN LA    @12,1                                               0135 00412000
         AH    @12,A                                               0135 00413000
@DE00116 STH   @12,A                                               0135 00414000
         LR    @06,LENGTH                                          0135 00415000
         SH    @06,@CH00398                                        0135 00416000
         CR    @12,@06                                             0135 00417000
         BNH   @DL00116                                            0135 00418000
*        /* CHECK IF ONE MORE TABULATION CHARACTER TO PROCESS         * 00419000
*        IF LASTTAB ^= 0                                           0136 00420000
*          THEN                        /* IF YES, PROCESS TAB         * 00421000
         ICM   @12,3,LASTTAB                                       0136 00422000
         BZ    @RF00136                                            0136 00423000
*            DO;                       /* PROCESS TAB                 * 00424000
*              CALL TABRTN;            /* ROUTINE TO PROCESS TAB      * 00425000
         BAL   @14,TABRTN                                          0138 00426000
*            END;                                                  0139 00427000
*TABEXIT:                              /* TAB EXIT                    * 00428000
*        CURPTR = CURPTR + 1;          /* EXIT FROM TAB ROUTINES   0140 00429000
*                                         UPDATE POINTER              * 00430000
*                                                                  0140 00431000
@RF00136 DS    0H                                                  0140 00432000
TABEXIT  AH    CURPTR,@CH00057                                     0140 00433000
*        /* CHECK IF ANY TABULATION CHARACTERS FOUND                  * 00434000
*        IF TABINDEX = 2                                           0141 00435000
*          THEN                        /* IF NO, MOVE TEXT INTO TEMP. * 00436000
         CLI   TABINDEX,2                                          0141 00437000
         BNE   @RF00141                                            0141 00438000
*            DO;                       /* MOVE TEXT                   * 00439000
*                                                                  0142 00440000
*              /* MOVE INTO TM                                        * 00441000
*              TEMPBFR (1:LENGTH - 4) = TEXTBFR;                   0143 00442000
         LR    @12,LENGTH                                          0143 00443000
         SH    @12,@CH00127                                        0143 00444000
         ICM   @06,7,TEXTPTR(PARMREG1)                             0143 00445000
         EX    @12,@SM00460                                        0143 00446000
*              CURPTR = LENGTH - 3;    /* SET CURRENT PTR             * 00447000
         LR    CURPTR,LENGTH                                       0144 00448000
         SH    CURPTR,@CH00098                                     0144 00449000
*            END;                                                  0145 00450000
*                                                                  0145 00451000
*        /* CHECK IF VARIABLE LINE NUMBERED RECORD FORMAT             * 00452000
*        IF CARECFM='0'B & CANONUM='0'B & CALINTAB='0'B     /*@YM04732* 00453000
*          THEN                        /* IF YES, MOVE BACK LEAVING     00454000
*                                         ROOM FOR SEQUENCE FIELD     * 00455000
@RF00141 TM    CARECFM(COMMREG),B'01000000'                        0146 00456000
         BNZ   @RF00146                                            0146 00457000
         TM    CANONUM(COMMREG),B'00000001'                        0146 00458000
         BNZ   @RF00146                                            0146 00459000
         TM    CALINTAB(COMMREG),B'10000000'                       0146 00460000
         BNZ   @RF00146                                            0146 00461000
*            DO;                       /* MOVE NUMBER SPACE           * 00462000
*                                                                  0147 00463000
*              /* CHECK IF VARIABLE LENGTH LINE OVERFLOW              * 00464000
*              IF CURPTR > CALRECL - CALENGTH - 3                  0148 00465000
*                THEN                  /* IF YES, LINE OVERFLOW       * 00466000
         LH    @12,CALRECL(,COMMREG)                               0148 00467000
         SLR   @06,@06                                             0148 00468000
         IC    @06,CALENGTH(,COMMREG)                              0148 00469000
         LR    @15,@12                                             0148 00470000
         SLR   @15,@06                                             0148 00471000
         LR    @14,@15                                             0148 00472000
         SH    @14,@CH00098                                        0148 00473000
         CR    CURPTR,@14                                          0148 00474000
         BNH   @RF00148                                            0148 00475000
*                  DO;                 /* SET RC                      * 00476000
*                    RETCODE = 4;        /* SET RC=4                  * 00477000
         LA    RETCODE,4                                           0150 00478000
*                    TEXTBFR = '';     /* BLANK OUT BUFFER            * 00479000
*                                                                  0151 00480000
         SLR   @03,@03                                             0151 00481000
         ICM   @03,7,TEXTPTR(PARMREG1)                             0151 00482000
         MVI   TEXTBFR(@03),C' '                                   0151 00483000
         MVC   TEXTBFR+1(255,@03),TEXTBFR(@03)                     0151 00484000
*                    /* MOVE TEXT FROM TEMP                           * 00485000
*                    TEXTBFR (CALENGTH + 1:CALRECL - 4) =          0152 00486000
*                        TEMPBFR(1:CALRECL-CALENGTH-4);            0152 00487000
         ALR   @06,@03                                             0152 00488000
         LR    @14,@15                                             0152 00489000
         SH    @14,@CH00127                                        0152 00490000
         EX    @14,@SM00462                                        0152 00491000
*                    /* RESET LENGTH                                  * 00492000
*                    TEMPLEN = CURPTR - CALRECL + CALENGTH + 6;    0153 00493000
         LR    TEMPLEN,CURPTR                                      0153 00494000
         SLR   TEMPLEN,@12                                         0153 00495000
         SLR   @06,@06                                             0153 00496000
         IC    @06,CALENGTH(,COMMREG)                              0153 00497000
         ALR   TEMPLEN,@06                                         0153 00498000
         AH    TEMPLEN,@CH00423                                    0153 00499000
*                    NEWLEN = TEMPLEN; /* LENGTH OF OVERFLOW LINE     * 00500000
         STH   TEMPLEN,NEWLEN(,COMMREG)                            0154 00501000
*                    NEWOFF = 0;       /* SET OFFSET TO ZERO          * 00502000
*                                                                  0155 00503000
         SLR   @14,@14                                             0155 00504000
         STH   @14,NEWOFF(,COMMREG)                                0155 00505000
*                    /* COMPLETE TEMP BUFFER                          * 00506000
*                    MVC(TEMPBFR (5:TEMPLEN),                      0156 00507000
*                        TEMPBFR (CALRECL - CALENGTH - 3:          0156 00508000
*                                CALRECL-CALENGTH+TEMPLEN-8));     0156 00509000
         LR    @14,TEMPLEN                                         0156 00510000
         SH    @14,@CH00127                                        0156 00511000
         ALR   @15,COMMREG                                         0156 00512000
         EX    @14,@SM00464                                        0156 00513000
*                    TEXTLEN = CALRECL;/* LENGTH SET TO LRECL         * 00514000
         STH   @12,TEXTLEN(,@03)                                   0157 00515000
*                    TEXTPTR = ADDR (TEMPBFR); /* PTR TO TEMP BUFFER  * 00516000
         LA    @12,TEMPBFR(,COMMREG)                               0158 00517000
         STCM  @12,7,TEXTPTR(PARMREG1)                             0158 00518000
*                  END;                                            0159 00519000
*                ELSE                  /* IF NO, NO LINE OVERFLOW     * 00520000
*                  DO;                 /* BLANK BFR                   * 00521000
         B     @RC00148                                            0160 00522000
@RF00148 DS    0H                                                  0161 00523000
*                    TEXTBFR = '';     /* BLANK OUT BUFFER            * 00524000
         SLR   @12,@12                                             0161 00525000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0161 00526000
         MVI   TEXTBFR(@12),C' '                                   0161 00527000
         MVC   TEXTBFR+1(255,@12),TEXTBFR(@12)                     0161 00528000
*                    TEMPLEN = CURPTR - 1;   /* SET TEMP LENGTH       * 00529000
*                                                                  0162 00530000
         LR    TEMPLEN,CURPTR                                      0162 00531000
         BCTR  TEMPLEN,0                                           0162 00532000
*                    /* COMPLETE TEXT BUFFER                          * 00533000
*                    TEXTBFR (CALENGTH + 1:CALENGTH + TEMPLEN) =   0163 00534000
*                        TEMPBFR(1:TEMPLEN);                       0163 00535000
*                                                                  0163 00536000
         SLR   @06,@06                                             0163 00537000
         IC    @06,CALENGTH(,COMMREG)                              0163 00538000
         ALR   @06,@12                                             0163 00539000
         LR    @03,TEMPLEN                                         0163 00540000
         BCTR  @03,0                                               0163 00541000
         EX    @03,@SM00462                                        0163 00542000
*                    /* SET LENGTH                                    * 00543000
*                    TEXTLEN = CURPTR + CALENGTH + 3;              0164 00544000
         SLR   @06,@06                                             0164 00545000
         IC    @06,CALENGTH(,COMMREG)                              0164 00546000
         ALR   @06,CURPTR                                          0164 00547000
         AH    @06,@CH00098                                        0164 00548000
         STH   @06,TEXTLEN(,@12)                                   0164 00549000
*                  END;                                            0165 00550000
*              GO TO ENDSCAN;          /* EXIT TO END OF SCAN RTN     * 00551000
         B     ENDSCAN                                             0166 00552000
*            END;                                                  0167 00553000
*                                                                  0167 00554000
*        /* CHECK IF SEQUENCE FIELD ALREADY ACCOUNTED FOR             * 00555000
*        IF CANONUM = '0'B & CALINTAB = '1'B                       0168 00556000
*          THEN                        /* IF YES, TREAT AS NOT LNUMBD * 00557000
@RF00146 TM    CANONUM(COMMREG),B'00000001'                        0168 00558000
         BNZ   @RF00168                                            0168 00559000
         TM    CALINTAB(COMMREG),B'10000000'                       0168 00560000
         BO    @RT00168                                            0168 00561000
*            GO TO NOLNUM;             /* BR TO NONUM RTN             * 00562000
*                                                                  0169 00563000
*        /* CHECK IF FIXED LINE NUMBERED RECORD FORMAT                * 00564000
*        IF CARECFM = '1'B & CANONUM = '0'B                        0170 00565000
*          THEN                        /* IF YES, PROCESS FOR SEQUENCE  00566000
*                                         FIELDS                      * 00567000
@RF00168 TM    CARECFM(COMMREG),B'01000000'                        0170 00568000
         BNO   @RF00170                                            0170 00569000
         TM    CANONUM(COMMREG),B'00000001'                        0170 00570000
         BNZ   @RF00170                                            0170 00571000
*            DO;                       /* CHECK FOR OVERFLOW          * 00572000
*                                                                  0171 00573000
*              /* CHECK IF FIXED LENGTH LINE OVERFLOW                 * 00574000
*              IF CURPTR > CALINE                                  0172 00575000
*                THEN                  /* IF YES, LINE OVERFLOW       * 00576000
         SLR   @12,@12                                             0172 00577000
         IC    @12,CALINE(,COMMREG)                                0172 00578000
         CR    CURPTR,@12                                          0172 00579000
         BNH   @RF00172                                            0172 00580000
*                  DO;                 /* SET RC                      * 00581000
*                    RETCODE = 4;        /* SET RC=4                  * 00582000
         LA    @06,4                                               0174 00583000
         LR    RETCODE,@06                                         0174 00584000
*                    TEXTBFR = '';     /* BLANK OUT BUFFER            * 00585000
         SLR   @03,@03                                             0175 00586000
         ICM   @03,7,TEXTPTR(PARMREG1)                             0175 00587000
         MVI   TEXTBFR(@03),C' '                                   0175 00588000
         MVC   TEXTBFR+1(255,@03),TEXTBFR(@03)                     0175 00589000
*                    /* RESET TEXT BUFFER                             * 00590000
*                    TEXTBFR (1:CALINE - 1) = TEMPBFR(1:CALINE-1); 0176 00591000
         LR    @15,@12                                             0176 00592000
         BCTR  @15,0                                               0176 00593000
         BCTR  @15,0                                               0176 00594000
         EX    @15,@SM00466                                        0176 00595000
*                    TEXTLEN = CALRECL;/* SET LENGTH TO LRECL         * 00596000
         MVC   TEXTLEN(2,@03),CALRECL(COMMREG)                     0177 00597000
*                    TEMPLEN = CURPTR - CALINE; /* SET TEMP LENGTH    * 00598000
         LR    TEMPLEN,CURPTR                                      0178 00599000
         SLR   TEMPLEN,@12                                         0178 00600000
*                    NEWLEN = TEMPLEN + 4;    /* LN OF OVERFLOW       * 00601000
         ALR   @06,TEMPLEN                                         0179 00602000
         STH   @06,NEWLEN(,COMMREG)                                0179 00603000
*                    NEWOFF = 0;       /* SET OFFSET TO ZERO          * 00604000
*                                                                  0180 00605000
         SLR   @03,@03                                             0180 00606000
         STH   @03,NEWOFF(,COMMREG)                                0180 00607000
*                    /* MOVE TEXT IN TEMP BFR                         * 00608000
*                    MVC(TEMPBFR (5:TEMPLEN + 4),TEMPBFR (CALINE:  0181 00609000
*                                                 CALINE+TEMPLEN-1));   00610000
         LR    @03,TEMPLEN                                         0181 00611000
         BCTR  @03,0                                               0181 00612000
         ALR   @12,COMMREG                                         0181 00613000
         EX    @03,@SM00468                                        0181 00614000
*                    TEXTPTR = ADDR (TEMPBFR); /* POINT TO TEMP BFR   * 00615000
         LA    @12,TEMPBFR(,COMMREG)                               0182 00616000
         STCM  @12,7,TEXTPTR(PARMREG1)                             0182 00617000
*                  END;                                            0183 00618000
*                ELSE                  /* IF NO, NO LINE OVERFLOW     * 00619000
*                  DO;                 /* RESET                       * 00620000
*                                                                  0184 00621000
         B     @RC00172                                            0184 00622000
@RF00172 DS    0H                                                  0185 00623000
*                    /* RESET TEXT BUFFER                             * 00624000
*                    TEXTBFR = TEMPBFR (1:CURPTR - 1);             0185 00625000
         SLR   @12,@12                                             0185 00626000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0185 00627000
         MVI   TEXTBFR+1(@12),C' '                                 0185 00628000
         MVC   TEXTBFR+2(254,@12),TEXTBFR+1(@12)                   0185 00629000
         LR    @06,CURPTR                                          0185 00630000
         BCTR  @06,0                                               0185 00631000
         BCTR  @06,0                                               0185 00632000
         EX    @06,@SM00470                                        0185 00633000
*                    TEXTLEN = CALRECL; /* SET LENGTH TO LRECL        * 00634000
         MVC   TEXTLEN(2,@12),CALRECL(COMMREG)                     0186 00635000
*                  END;                                            0187 00636000
*              GO TO ENDSCAN;          /* BRANCH TO END OF SCAN RTN   * 00637000
         B     ENDSCAN                                             0188 00638000
*            END;                                                  0189 00639000
*                                                                  0189 00640000
*NOLNUM:                               /* CHECK OVERFLOW              * 00641000
*                                                                  0190 00642000
*        /* CURPTR GT DATA LEN                                        * 00643000
*        IF CURPTR > CALRECL - 3                                   0190 00644000
*          THEN                        /* IF YES                      * 00645000
@RF00170 DS    0H                                                  0190 00646000
NOLNUM   LA    @12,3                                               0190 00647000
         LH    @06,CALRECL(,COMMREG)                               0190 00648000
         LR    @15,@06                                             0190 00649000
         SLR   @15,@12                                             0190 00650000
         CR    CURPTR,@15                                          0190 00651000
         BNH   @RF00190                                            0190 00652000
*            DO;                       /* RESET TEXT BUFFER           * 00653000
*              RETCODE = 4;            /* SET RC = 4                  * 00654000
         LA    @03,4                                               0192 00655000
         LR    RETCODE,@03                                         0192 00656000
*              TEXTBFR = '';           /* BLANK OUT BUFFER            * 00657000
         SLR   @15,@15                                             0193 00658000
         ICM   @15,7,TEXTPTR(PARMREG1)                             0193 00659000
         MVI   TEXTBFR(@15),C' '                                   0193 00660000
         MVC   TEXTBFR+1(255,@15),TEXTBFR(@15)                     0193 00661000
*              TEXTBFR (1:CALRECL - 4) = TEMPBFR(1:CALRECL-4);     0194 00662000
         LR    @14,@06                                             0194 00663000
         SH    @14,@CH00127                                        0194 00664000
         EX    @14,@SM00472                                        0194 00665000
*                                      /* MOVE DATA                   * 00666000
*              TEXTLEN = CALRECL;      /* SET DATA LENGTH             * 00667000
         STH   @06,TEXTLEN(,@15)                                   0195 00668000
*              TEMPLEN = CURPTR - CALRECL + 3;     /* SET TEMP LEN    * 00669000
         LR    TEMPLEN,CURPTR                                      0196 00670000
         SLR   TEMPLEN,@06                                         0196 00671000
         ALR   TEMPLEN,@12                                         0196 00672000
*              NEWLEN = TEMPLEN + 4;   /* LENGTH OF OVERFLOW          * 00673000
         ALR   @03,TEMPLEN                                         0197 00674000
         STH   @03,NEWLEN(,COMMREG)                                0197 00675000
*              NEWOFF = 0;             /* SET OFFSET TO ZERO          * 00676000
         SLR   @12,@12                                             0198 00677000
         STH   @12,NEWOFF(,COMMREG)                                0198 00678000
*              /* MOVE DATA IN TEMP BFR                               * 00679000
*              MVC(TEMPBFR(5:TEMPLEN + 4),TEMPBFR(CALRECL - 3:     0199 00680000
*                                             CALRECL+TEMPLEN-4)); 0199 00681000
         LR    @12,TEMPLEN                                         0199 00682000
         BCTR  @12,0                                               0199 00683000
         ALR   @06,COMMREG                                         0199 00684000
         EX    @12,@SM00474                                        0199 00685000
*              TEXTPTR = ADDR (TEMPBFR); /* POINT TO TEMP BFR         * 00686000
         LA    @12,TEMPBFR(,COMMREG)                               0200 00687000
         STCM  @12,7,TEXTPTR(PARMREG1)                             0200 00688000
*            END;                      /* END OF GROUP                * 00689000
*          ELSE                        /* IF NO, NO LINE OVERFLOW     * 00690000
*            DO;                       /* MOVE DATA                   * 00691000
*                                                                  0202 00692000
         B     @RC00190                                            0202 00693000
@RF00190 DS    0H                                                  0203 00694000
*              /* MOVE DATA                                           * 00695000
*              TEXTBFR = TEMPBFR (1:CURPTR - 1);                   0203 00696000
*                                                                  0203 00697000
         SLR   @12,@12                                             0203 00698000
         ICM   @12,7,TEXTPTR(PARMREG1)                             0203 00699000
         MVI   TEXTBFR+1(@12),C' '                                 0203 00700000
         MVC   TEXTBFR+2(254,@12),TEXTBFR+1(@12)                   0203 00701000
         LR    @06,CURPTR                                          0203 00702000
         BCTR  @06,0                                               0203 00703000
         BCTR  @06,0                                               0203 00704000
         EX    @06,@SM00470                                        0203 00705000
*              /* CHECK IF FIXED LENGTH RECORD FORMAT                 * 00706000
*              IF CARECFM = '1'B                                   0204 00707000
*                THEN                  /* IF YES, SET LL TO LRECL     * 00708000
         TM    CARECFM(COMMREG),B'01000000'                        0204 00709000
         BNO   @RF00204                                            0204 00710000
*                  TEXTLEN = CALRECL;  /* SET LENGTH TO LRECL         * 00711000
         MVC   TEXTLEN(2,@12),CALRECL(COMMREG)                     0205 00712000
*                ELSE                  /* IF NO, SET LL TO DATA LEN.    00713000
*                                         PLUS 4                      * 00714000
*                  TEXTLEN = CURPTR + 3;     /* SET LEN TO DATA + 4   * 00715000
         B     @RC00204                                            0206 00716000
@RF00204 ICM   @12,7,TEXTPTR(PARMREG1)                             0206 00717000
         LA    @06,3                                               0206 00718000
         ALR   @06,CURPTR                                          0206 00719000
         STH   @06,TEXTLEN(,@12)                                   0206 00720000
*            END;                                                  0207 00721000
@RC00204 DS    0H                                                  0208 00722000
*ENDSCAN:                              /* END SCANNING PROCESS        * 00723000
*                                                                  0208 00724000
*        /* IF GOTTEN OVERFLOW EXISTS                                 * 00725000
*        IF GETOF ^= 0                                             0208 00726000
*          THEN                        /* THEN                        * 00727000
@RC00190 DS    0H                                                  0208 00728000
ENDSCAN  ICM   @12,15,GETOF                                        0208 00729000
         BZ    @RF00208                                            0208 00730000
*            DO;                       /* PREPARE LINE                * 00731000
*                                                                  0209 00732000
*              /* CLEAR OUT TABS                                      * 00733000
*              DO B = 1 TO GETLEN - 4;                             0210 00734000
         LA    @12,1                                               0210 00735000
         B     @DE00210                                            0210 00736000
@DL00210 DS    0H                                                  0211 00737000
*                INDX = B;             /* USE DUMMY VARIABLE          * 00738000
*                                                                  0211 00739000
         STC   @12,INDX                                            0211 00740000
*                /* IF A TAB                                          * 00741000
*                IF GETTXT (INDX) = '05'X                          0212 00742000
*                  THEN                /* THEN                        * 00743000
         L     @15,GETOF                                           0212 00744000
         ALR   @12,@15                                             0212 00745000
         CLI   GETTXT-1(@12),X'05'                                 0212 00746000
         BNE   @RF00212                                            0212 00747000
*                    GETTXT (INDX) = ' ';   /* BLANK IT               * 00748000
         SLR   @12,@12                                             0213 00749000
         IC    @12,INDX                                            0213 00750000
         ALR   @15,@12                                             0213 00751000
         MVI   GETTXT-1(@15),C' '                                  0213 00752000
*              END;                                                0214 00753000
*                                                                  0214 00754000
@RF00212 LA    @12,1                                               0214 00755000
         AH    @12,B                                               0214 00756000
@DE00210 STH   @12,B                                               0214 00757000
         L     @01,GETOF                                           0214 00758000
         LH    @15,GETLEN(,@01)                                    0214 00759000
         SH    @15,@CH00398                                        0214 00760000
         CR    @12,@15                                             0214 00761000
         BNH   @DL00210                                            0214 00762000
*              /* IF OVERFLOW EXISTS                                  * 00763000
*              IF TEXTPTR = ADDR (TEMPBFR)                         0215 00764000
*                THEN                  /* THEN                        * 00765000
         LA    @12,TEMPBFR(,COMMREG)                               0215 00766000
         SLR   @00,@00                                             0215 00767000
         ICM   @00,7,TEXTPTR(PARMREG1)                             0215 00768000
         CR    @12,@00                                             0215 00769000
         BNE   @RF00215                                            0215 00770000
*                  DO;                 /* MOVE DATA                   * 00771000
*                    TEMPBFR (NEWLEN + 1:NEWLEN + GETLEN - 4) =    0217 00772000
*                      GETTXT;         /* MOVE TEXT                   * 00773000
         LH    @12,NEWLEN(,COMMREG)                                0217 00774000
         ALR   @12,COMMREG                                         0217 00775000
         L     @15,GETOF                                           0217 00776000
         LH    @14,GETLEN(,@15)                                    0217 00777000
         LR    @07,@14                                             0217 00778000
         SH    @07,@CH00127                                        0217 00779000
         EX    @07,@SM00476                                        0217 00780000
*                    NEWLEN = NEWLEN + GETLEN - 4;    /* NEW LENGTH   * 00781000
         AH    @14,NEWLEN(,COMMREG)                                0218 00782000
         SH    @14,@CH00398                                        0218 00783000
         STH   @14,NEWLEN(,COMMREG)                                0218 00784000
*                  END;                                            0219 00785000
*                ELSE                  /* CREATE OVERFLOW RECORD      * 00786000
*                  DO;                 /* CREATE RECORD               * 00787000
         B     @RC00215                                            0220 00788000
@RF00215 DS    0H                                                  0221 00789000
*                    TEXTPTR = ADDR (TEMPBFR); /* SET PTR             * 00790000
         LA    @12,TEMPBFR(,COMMREG)                               0221 00791000
         STCM  @12,7,TEXTPTR(PARMREG1)                             0221 00792000
*                    NEWLEN = GETLEN;  /* SET LENGTH                  * 00793000
         L     @12,GETOF                                           0222 00794000
         LH    @15,GETLEN(,@12)                                    0222 00795000
         STH   @15,NEWLEN(,COMMREG)                                0222 00796000
*                    NEWOFF = 0;       /* SET OFFSET                  * 00797000
         SLR   @14,@14                                             0223 00798000
         STH   @14,NEWOFF(,COMMREG)                                0223 00799000
*                    TEMPBFR (5:GETLEN) = GETTXT;   /* MOVE TEXT      * 00800000
         SH    @15,@CH00127                                        0224 00801000
         EX    @15,@SM00478                                        0224 00802000
*                  END;                                            0225 00803000
*              LNGTHREG = GETLEN;      /* LENGTH OF GETMAINED CORE    * 00804000
@RC00215 L     @01,GETOF                                           0226 00805000
         LH    LNGTHREG,GETLEN(,@01)                               0226 00806000
*              SREG0 = PARMREG0;       /* SAVE REG ZERO               * 00807000
         LR    SREG0,PARMREG0                                      0227 00808000
*              SREG1 = PARMREG1;       /* SAVE REG ONE                * 00809000
         LR    SREG1,PARMREG1                                      0228 00810000
*              GENERATE REFS(LNGTHREG,GETOF);/*FREE CORE HERE @ZM30978* 00811000
         FREEMAIN  E,LV=(LNGTHREG),A=GETOF,SP=1,MF=(E,GETAREA)          00812000
*              PARMREG0 = SREG0;       /* RESTORE REG ZERO            * 00813000
         LR    PARMREG0,SREG0                                      0230 00814000
*              PARMREG1 = SREG1;       /* RESTORE REG ONE             * 00815000
         LR    PARMREG1,SREG1                                      0231 00816000
*            END;                                                  0232 00817000
*                                                                  0232 00818000
*        /* IF NO CORE WAS AVAILABLE                                  * 00819000
*        IF RETCODX ^= 0                                           0233 00820000
*          THEN                        /* SET                         * 00821000
@RF00208 ICM   @12,15,RETCODX                                      0233 00822000
         BZ    @RF00233                                            0233 00823000
*            RETCODE = 8;              /* RETURN CODE                 * 00824000
         LA    RETCODE,8                                           0234 00825000
*        RETCDREG = RETCODE;           /* END OF SCAN MOVE RETURN CODE  00826000
*                                         INTO REG 15                 * 00827000
*                                                                  0235 00828000
@RF00233 LR    RETCDREG,RETCODE                                    0235 00829000
*         RESPECIFY (GPR12P,GPR13P) RSTD;                          0236 00830000
*         CANXTSVA = GPR13P;         /* UPDATE NEXT-SAVE-AREA PTR    */ 00831000
         ST    GPR13P,CANXTSVA(,COMMREG)                           0237 00832000
*         GPR12P = GPR13P;           /* SAVE PRESENT SAVE-AREA ADDR  */ 00833000
         LR    GPR12P,GPR13P                                       0238 00834000
*         GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD         */ 00835000
         L     @08,CASAVPTR+4(,GPR13P)                             0239 00836000
         LR    GPR13P,@08                                          0239 00837000
*                                    /* SAVE-AREA PTR                */ 00838000
*         RESPECIFY CASAVE BASED(GPR12P); /* CHANGE BASE FOR         */ 00839000
*                                    /* SAVE-AREA                    */ 00840000
*         CASAVE = CASAVE && CASAVE; /* ZERO OUT THIS SAVE-AREA      */ 00841000
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0241 00842000
*         RESPECIFY CASAVE BASED;                                  0242 00843000
*         RETURN CODE(RETCDREG);     /* RETURN WITH RETURN CODE      */ 00844000
         L     @14,12(,@13)                                        0243 00845000
         LM    @00,@12,20(@13)                                     0243 00846000
         BR    @14                                                 0243 00847000
*         RESPECIFY (GPR12P,GPR13P) UNRSTD;                        0244 00848000
*                                                                  0244 00849000
*                                                                  0244 00850000
*        /* GENERATE TRANSLATE TABLE                                  * 00851000
*        GENERATE DATA REFS(TXTPTREG) DEFS(TRNSTAB);               0245 00852000
*                                                                  0245 00853000
*/* THIS SUBROUTINE SEARCHES THE TAB TABLE FOR THE CORRECT OFFSET     * 00854000
*/* FOR THE TAB CHARACTER BEING OPERATED ON.  IF THE END OF THE       * 00855000
*/* TABLE IS REACHED BEFORE THIS VALUE IS FOUND, CONTROL IS PASSED TO * 00856000
*/* THE BLANKTAB SUBROUTINE.  THE TEXT IS SHIFTED AND PADDED          * 00857000
*TABRTN:                               /* TAB SEARCH ROUTINE          * 00858000
*        PROC OPTIONS (NOSAVE (4, 5));                             0246 00859000
*                                                                  0246 00860000
@EL00001 DS    0H                                                  0246 00861000
@EF00001 DS    0H                                                  0246 00862000
@ER00001 LM    @14,@12,12(@13)                                     0246 00863000
         BR    @14                                                 0246 00864000
TABRTN   STM   @14,@03,@SA00002                                    0246 00865000
         ST    @06,@SA00002+24                                     0246 00866000
         STM   @08,@12,@SA00002+28                                 0246 00867000
*        /* RESTRICTIONS                                              * 00868000
*        RESPECIFY (PARMREG1, LNGTHREG, COMMREG,                   0247 00869000
*                      BASEREG, DATAREG) RSTD;                     0247 00870000
*                                                                  0247 00871000
*        /* SCAN TABLE FOR PROPER TAB                                 * 00872000
*        DO B = TABINDEX TO 12;                                    0248 00873000
         SLR   @12,@12                                             0248 00874000
         IC    @12,TABINDEX                                        0248 00875000
         B     @DE00248                                            0248 00876000
@DL00248 DS    0H                                                  0249 00877000
*          INDX = B;                   /* SET INDEX TO TAB INDEX      * 00878000
*                                                                  0249 00879000
         STC   @12,INDX                                            0249 00880000
*          /* CHECK IF END OF TAB TABLE REACHED                       * 00881000
*          IF CATABS (INDX) = '00'X                                0250 00882000
*            THEN                      /* IF YES, TAB GT TABLE VALS   * 00883000
         ALR   @12,COMMREG                                         0250 00884000
         CLI   CATABS-1(@12),X'00'                                 0250 00885000
         BNE   @RF00250                                            0250 00886000
*              DO;                                                 0251 00887000
*                TABINDEX = INDX;      /* SET TAB INDEX               * 00888000
         SLR   @12,@12                                             0252 00889000
         IC    @12,INDX                                            0252 00890000
         STC   @12,TABINDEX                                        0252 00891000
*                CALL BLANKTAB;        /* BLANK REST OF TABS          * 00892000
         BAL   @14,BLANKTAB                                        0253 00893000
*                RETURN;               /* RETURN TO MAILINE CODE      * 00894000
@EL00002 DS    0H                                                  0254 00895000
@EF00002 DS    0H                                                  0254 00896000
@ER00002 LM    @14,@03,@SA00002                                    0254 00897000
         L     @06,@SA00002+24                                     0254 00898000
         LM    @08,@12,@SA00002+28                                 0254 00899000
         BR    @14                                                 0254 00900000
*              END;                                                0255 00901000
*          TEMPLEN = CATABS (INDX);    /* CHECK IF PROPER TABULATION    00902000
*                                         VALUE FOUND PICK UP PROPER    00903000
*                                         TAB OFFSET                  * 00904000
*                                                                  0256 00905000
@RF00250 SLR   @12,@12                                             0256 00906000
         IC    @12,INDX                                            0256 00907000
         SLR   TEMPLEN,TEMPLEN                                     0256 00908000
         IC    TEMPLEN,CATABS-1(@12,COMMREG)                       0256 00909000
*          /* CHECK IF TAB FOUND                                      * 00910000
*          IF TEMPLEN > CURPTR         /*                       A42957* 00911000
*            THEN                      /* IF YES, PROCESS TAB         * 00912000
         CR    TEMPLEN,CURPTR                                      0257 00913000
         BH    @RT00257                                            0257 00914000
*              GO TO FOUND;            /* BR TO FOUND RTN             * 00915000
*        END;                          /* END OF SEARCH               * 00916000
         LA    @12,1                                               0259 00917000
         AH    @12,B                                               0259 00918000
@DE00248 STH   @12,B                                               0259 00919000
         CH    @12,@CH00140                                        0259 00920000
         BNH   @DL00248                                            0259 00921000
*FOUND:                                /* TAB FOUND                   * 00922000
*        SHIFT = CATABS (INDX);        /* TAB FOUND SAVE TAB POSITION * 00923000
FOUND    SLR   @12,@12                                             0260 00924000
         IC    @12,INDX                                            0260 00925000
         SLR   @06,@06                                             0260 00926000
         IC    @06,CATABS-1(@12,COMMREG)                           0260 00927000
         STC   @06,SHIFT                                           0260 00928000
*        TABINDEX = INDX + 1;          /* UPDATE TO NEXT TAB VALUE    * 00929000
         LA    @12,1(,@12)                                         0261 00930000
         STC   @12,TABINDEX                                        0261 00931000
*        TEMPBFR (CURPTR) = ' ';       /* INSERT BLANK IN BUFFER      * 00932000
*                                                                  0262 00933000
         LR    @12,COMMREG                                         0262 00934000
         ALR   @12,CURPTR                                          0262 00935000
         MVI   TEMPBFR-1(@12),C' '                                 0262 00936000
*        /* BLANK AREA UPTO TAB POSITION                              * 00937000
*        MVC(TEMPBFR (CURPTR + 1:CURPTR + SHIFT - 1),              0263 00938000
*            TEMPBFR (CURPTR:CURPTR + SHIFT - 2));                 0263 00939000
         LR    @12,COMMREG                                         0263 00940000
         ALR   @12,CURPTR                                          0263 00941000
         SLR   @05,@05                                             0263 00942000
         IC    @05,SHIFT                                           0263 00943000
         BCTR  @05,0                                               0263 00944000
         BCTR  @05,0                                               0263 00945000
         LR    @15,COMMREG                                         0263 00946000
         ALR   @15,CURPTR                                          0263 00947000
         EX    @05,@SM00480                                        0263 00948000
*        TEMPLEN = CURTAB - LASTTAB - 1;   /* DET TEXT TO BE MOVED    * 00949000
*                                                                  0264 00950000
         LH    @12,CURTAB                                          0264 00951000
         LH    @05,LASTTAB                                         0264 00952000
         LR    TEMPLEN,@12                                         0264 00953000
         SLR   TEMPLEN,@05                                         0264 00954000
         BCTR  TEMPLEN,0                                           0264 00955000
*        /* RESET TEMP BUFFER                                         * 00956000
*        TEMPBFR (SHIFT:SHIFT + TEMPLEN) = TEXTBFR (LASTTAB + 1:   0265 00957000
*                                          LASTTAB+TEMPLEN+1);     0265 00958000
         ALR   @06,COMMREG                                         0265 00959000
         ICM   @15,7,TEXTPTR(PARMREG1)                             0265 00960000
         ALR   @15,@05                                             0265 00961000
         EX    TEMPLEN,@SM00482                                    0265 00962000
*        CURPTR = SHIFT + TEMPLEN;     /* CURRENT POSITION IN TEMPAREA* 00963000
         SLR   @05,@05                                             0266 00964000
         IC    @05,SHIFT                                           0266 00965000
         ALR   @05,TEMPLEN                                         0266 00966000
         LR    CURPTR,@05                                          0266 00967000
*        LASTTAB = CURTAB;             /* CURRENT TAB NOW LAST TAB 0267 00968000
*                                         UNPROCESSED                 * 00969000
         STH   @12,LASTTAB                                         0267 00970000
*        RETURN;                       /* RETURN TO MAINLINE CODE     * 00971000
         B     @EL00002                                            0268 00972000
*        END TABRTN;                   /* END OF TAB ROUTINE          * 00973000
*                                                                  0269 00974000
*/* ROUTINE TO BLANK OUT TABS                                         * 00975000
*BLANKTAB:                             /* RTN TO BLANK TABS           * 00976000
*        /* PROC STATEMENT                                            * 00977000
*        PROC OPTIONS (NOSAVEAREA, NOSAVE (4, 5));                 0270 00978000
*                                                                  0270 00979000
BLANKTAB STM   @14,@03,12(@13)                                     0270 00980000
         ST    @06,44(,@13)                                        0270 00981000
         STM   @08,@12,52(@13)                                     0270 00982000
*        /* RESTRICTIONS THIS SUBROUTINE BLANKS OUT TABULATION        * 00983000
*        /* CHARACTERS FROM THE TEXT STARTING AT THE POSITION         * 00984000
*        /* REQUESTED BY THE CALLER AND MOVES THE REMAINING TEXT      * 00985000
*        /* INTO THE TEMPPORARY BUFFER AREA FOR RECORD FORMATING.     * 00986000
*        /* RESTRICT BASE AND WORK REGS                               * 00987000
*        RESPECIFY (PARMREG1, LNGTHREG, COMMREG,                   0271 00988000
*                      BASEREG, DATAREG) RSTD;                     0271 00989000
*        TEXTBFR (LASTTAB) = ' ';      /* BLANK OUT LAST TAB UNPRCSSD * 00990000
*                                                                  0272 00991000
         LH    @12,LASTTAB                                         0272 00992000
         ICM   @06,7,TEXTPTR(PARMREG1)                             0272 00993000
         ALR   @06,@12                                             0272 00994000
         MVI   TEXTBFR-1(@06),C' '                                 0272 00995000
*        /* CHECK IF END OF BUFFER ALREADY REACHED                    * 00996000
*        IF CURTAB >= LENGTH - 4                                   0273 00997000
*          THEN                        /* IF YES, BYPASS SCAN         * 00998000
         LH    @12,CURTAB                                          0273 00999000
         LR    @06,LENGTH                                          0273 01000000
         SH    @06,@CH00398                                        0273 01001000
         CR    @12,@06                                             0273 01002000
         BNL   @RT00273                                            0273 01003000
*            GO TO SKIPSCAN;           /* BR TO BYPASS SCAN           * 01004000
*                                                                  0274 01005000
*        /* BLANK OUT REMAINING TABS                                  * 01006000
*        DO B = CURTAB TO LENGTH - 4;                              0275 01007000
         B     @DE00275                                            0275 01008000
@DL00275 DS    0H                                                  0276 01009000
*          NEXTCHAR = B;               /* SET NEXT CHAR PTR TO INDEX  * 01010000
*                                                                  0276 01011000
         STH   @12,NEXTCHAR                                        0276 01012000
*          /* CHECK IF TABULATION CHARACTER FOUND                     * 01013000
*          IF TEXTBFR (NEXTCHAR) = '05'X                           0277 01014000
*            THEN                      /* IF YES, BLANK OUT TAB CHAR  * 01015000
         SLR   @06,@06                                             0277 01016000
         ICM   @06,7,TEXTPTR(PARMREG1)                             0277 01017000
         ALR   @12,@06                                             0277 01018000
         CLI   TEXTBFR-1(@12),X'05'                                0277 01019000
         BNE   @RF00277                                            0277 01020000
*              TEXTBFR (NEXTCHAR) = ' ';   /* INSERT BLANK INTO BFR   * 01021000
         LH    @12,NEXTCHAR                                        0278 01022000
         ALR   @06,@12                                             0278 01023000
         MVI   TEXTBFR-1(@06),C' '                                 0278 01024000
*        END;                          /* END OF BLANKING             * 01025000
@RF00277 LA    @12,1                                               0279 01026000
         AH    @12,B                                               0279 01027000
@DE00275 STH   @12,B                                               0279 01028000
         LR    @06,LENGTH                                          0279 01029000
         SH    @06,@CH00398                                        0279 01030000
         CR    @12,@06                                             0279 01031000
         BNH   @DL00275                                            0279 01032000
*SKIPSCAN:                             /* SKIP SCAN                   * 01033000
*        TEMPLEN = (LENGTH - 4) - LASTTAB;    /* SET LEN TO LAST TAB  * 01034000
*                                                                  0280 01035000
SKIPSCAN LH    @12,LASTTAB                                         0280 01036000
         LR    TEMPLEN,LENGTH                                      0280 01037000
         SH    TEMPLEN,@CH00398                                    0280 01038000
         SLR   TEMPLEN,@12                                         0280 01039000
*        /* COMPLETE MOVE INTO TEMP BFR                               * 01040000
*        TEMPBFR (CURPTR:CURPTR + TEMPLEN) = TEXTBFR (LASTTAB:     0281 01041000
*                                            LASTTAB+TEMPLEN);     0281 01042000
         LR    @06,COMMREG                                         0281 01043000
         ALR   @06,CURPTR                                          0281 01044000
         ICM   @05,7,TEXTPTR(PARMREG1)                             0281 01045000
         ALR   @05,@12                                             0281 01046000
         EX    TEMPLEN,@SM00484                                    0281 01047000
*        CURPTR = CURPTR + TEMPLEN;    /* INC CURRENT PTR BY LENGTH   * 01048000
         ALR   CURPTR,TEMPLEN                                      0282 01049000
*        RETURN;                       /* RETURN TO MAINLINE CODE     * 01050000
@EL00003 DS    0H                                                  0283 01051000
@EF00003 DS    0H                                                  0283 01052000
@ER00003 LM    @14,@03,12(@13)                                     0283 01053000
         L     @06,44(,@13)                                        0283 01054000
         LM    @08,@12,52(@13)                                     0283 01055000
         BR    @14                                                 0283 01056000
*        END BLANKTAB;                 /* END OF BLANK TAB RTN        * 01057000
*                                                                  0284 01058000
*                                                                  0284 01059000
*         DECLARE /*GENERAL PURPOSE REGISTERS */                   0285 01060000
*           GPR12P PTR(31) REG(12),                                0285 01061000
*           GPR13P PTR(31) REG(13),                                0285 01062000
*           GPR15P PTR(31) REG(15);                                0285 01063000
*                                                                  0285 01064000
*         /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS */           0286 01065000
*           DECLARE CASAVPTR PTR(31) BASED;/*SAVE AREA PTR FOR IKJEBESV 01066000
*/          DECLARE COMMREG REG(9) PTR(31) RSTD;/*POINTER TO EDIT COMMO 01067000
*AREA*/     DECLARE DATAREG REG(10) PTR(31) RSTD;/*BASEREG FOR EDIT SUB 01068000
*OMMAND WORK AREA*/                                                0286 01069000
*           DECLARE CASAVE CHAR(72) BASED;/*SAVE AREA EDIT MODULE*/     01070000
*                                                                  0289 01071000
*         DECLARE /* COMMON VARIABLES */                           0290 01072000
*           I256C CHAR(256) BASED,                                 0290 01073000
*           I031F FIXED(31) BASED,                                 0290 01074000
*           I031P PTR(31)   BASED,                                 0290 01075000
*           I015F FIXED(15) BASED,                                 0290 01076000
*           I015P PTR(15)   BASED,                                 0290 01077000
*           I008P PTR(8)    BASED,                                 0290 01078000
*           I001C CHAR(1)   BASED;                                 0290 01079000
*        END IKJEBELE                  /* END OF LINE EDIT ROUTINE    * 01080000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01081000
*/*%INCLUDE SYSLIB  (IKJEBECA)                                        * 01082000
*;                                                                 0291 01083000
@DATA    DS    0H                                                       01084000
@CH00057 DC    H'1'                                                     01085000
@CH00098 DC    H'3'                                                     01086000
@CH00398 DC    H'4'                                                     01087000
@CH00127 DC    H'5'                                                     01088000
@CH00423 DC    H'6'                                                     01089000
@CH00140 DC    H'12'                                                    01090000
@CH00286 DC    H'260'                                                   01091000
@CH00450 DC    H'-256'                                                  01092000
@SM00452 MVC   GETTXT(0,@12),INPUTBFR+260(@08)                          01093000
@SM00454 MVC   TEMPBFR(0,COMMREG),TEXTBFR(@12)                          01094000
@SM00456 MVC   TEXTBFR-1(0,@12),TEMPBFR(COMMREG)                        01095000
@SM00458 MVC   TEMPBFR(0,COMMREG),TEXTBFR(@02)                          01096000
@SM00460 MVC   TEMPBFR(0,COMMREG),TEXTBFR(@06)                          01097000
@SM00462 MVC   TEXTBFR(0,@06),TEMPBFR(COMMREG)                          01098000
@SM00464 MVC   TEMPBFR+4(0,COMMREG),TEMPBFR-4(@15)                      01099000
@SM00466 MVC   TEXTBFR(0,@03),TEMPBFR(COMMREG)                          01100000
@SM00468 MVC   TEMPBFR+4(0,COMMREG),TEMPBFR-1(@12)                      01101000
@SM00470 MVC   TEXTBFR(0,@12),TEMPBFR(COMMREG)                          01102000
@SM00472 MVC   TEXTBFR(0,@15),TEMPBFR(COMMREG)                          01103000
@SM00474 MVC   TEMPBFR+4(0,COMMREG),TEMPBFR-4(@06)                      01104000
@SM00476 MVC   TEMPBFR(0,@12),GETTXT(@15)                               01105000
@SM00478 MVC   TEMPBFR+4(0,COMMREG),GETTXT(@12)                         01106000
@SM00480 MVC   TEMPBFR(0,@12),TEMPBFR-1(@15)                            01107000
@SM00482 MVC   TEMPBFR-1(0,@06),TEXTBFR(@15)                            01108000
@SM00484 MVC   TEMPBFR-1(0,@06),TEXTBFR-1(@05)                          01109000
@DATD    DSECT                                                          01110000
         DS    0F                                                       01111000
@SA00002 DS    12F                                                      01112000
@TF00001 DS    F                                                        01113000
IKJEBELE CSECT                                                          01114000
         DS    0F                                                       01115000
@CF00055 DC    F'8'                                                     01116000
@DATD    DSECT                                                          01117000
         DS    0D                                                       01118000
GETOF    DS    A                                                        01119000
RETCODX  DS    F                                                        01120000
LEWKAREA DS    CL24                                                     01121000
         ORG   LEWKAREA                                                 01122000
A        DS    FL2                                                      01123000
B        DS    FL2                                                      01124000
CURTAB   DS    FL2                                                      01125000
LASTTAB  DS    FL2                                                      01126000
NEXTCHAR DS    FL2                                                      01127000
TABSW    DS    CL1                                                      01128000
TABINDEX DS    AL1                                                      01129000
GETAREA  DS    CL10                                                     01130000
INDX     DS    AL1                                                      01131000
SHIFT    DS    AL1                                                      01132000
         ORG   LEWKAREA+24                                              01133000
IKJEBELE CSECT                                                          01134000
         NOPR  ((@ENDDATD-@DATD)/201*16)                                01135000
         DS    0F                                                       01136000
@SIZDATD DC    AL1(0)                                                   01137000
         DC    AL3(@ENDDATD-@DATD)                                      01138000
         DS    0D                                                       01139000
IKJEBELE CSECT                                                          01140000
TRNSLATE TR    0(*-*,TXTPTREG),TRNSTAB TRANSLATE TEXT                   01141000
         SPACE 2                                                        01142000
TRNSTAB  DC    256AL1(*-TRNSTAB)       TRANSLATE  TABLE                 01143000
         ORG   TRNSTAB+C'a'            RESET TO SMALL A                 01144000
         DC    C'ABCDEFGHI'            REPLACE WITH LARGE LETTERS       01145000
         ORG   TRNSTAB+C'j'            RESET TO SMALL J                 01146000
         DC    C'JKLMNOPQR'            REPLACE WITH LARGE LETTERS       01147000
         ORG   TRNSTAB+C's'            RESET TO SMALL S                 01148000
         DC    C'STUVWXYZ'             REPLACE WITH LARGE LETTERS       01149000
         ORG   ,                       RESET COUNTER                    01150000
@DATD    DSECT                                                          01151000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01152000
@ENDDATD EQU   *                                                        01153000
IKJEBELE CSECT                                                          01154000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01155000
@01      EQU   01                                                       01156000
@02      EQU   02                                                       01157000
@03      EQU   03                                                       01158000
@04      EQU   04                                                       01159000
@05      EQU   05                                                       01160000
@06      EQU   06                                                       01161000
@07      EQU   07                                                       01162000
@08      EQU   08                                                       01163000
@09      EQU   09                                                       01164000
@10      EQU   10                                                       01165000
@11      EQU   11                                                       01166000
@12      EQU   12                                                       01167000
@13      EQU   13                                                       01168000
@14      EQU   14                                                       01169000
@15      EQU   15                                                       01170000
TEMPLEN  EQU   @02                                                      01171000
LENGTH   EQU   @03                                                      01172000
CURPTR   EQU   @07                                                      01173000
SREG1    EQU   @12                                                      01174000
SREG0    EQU   @05                                                      01175000
RETCODE  EQU   @08                                                      01176000
PARMREG0 EQU   @00                                                      01177000
PARMREG1 EQU   @01                                                      01178000
LNGTHREG EQU   @04                                                      01179000
TXTPTREG EQU   @05                                                      01180000
BASEREG  EQU   @11                                                      01181000
RETCDREG EQU   @15                                                      01182000
COMMREG  EQU   @09                                                      01183000
GPR13P   EQU   @13                                                      01184000
GPR15P   EQU   @15                                                      01185000
DATAREG  EQU   @10                                                      01186000
GPR12P   EQU   @12                                                      01187000
RETREG   EQU   @14                                                      01188000
IKJEBECA EQU   0                                                        01189000
CAPTPRSD EQU   IKJEBECA+36                                              01190000
CAPRSPDL EQU   CAPTPRSD                                                 01191000
CAPTIBFR EQU   IKJEBECA+40                                              01192000
CAATTN   EQU   IKJEBECA+120                                             01193000
CACFLAG  EQU   IKJEBECA+124                                             01194000
CACFLAG1 EQU   CACFLAG                                                  01195000
CACAPS   EQU   CACFLAG1                                                 01196000
CANONUM  EQU   CACFLAG1                                                 01197000
CACFLAG2 EQU   CACFLAG+1                                                01198000
CARECFM  EQU   CACFLAG2                                                 01199000
CACFLAG3 EQU   CACFLAG+2                                                01200000
CAIMFLG  EQU   CACFLAG3                                                 01201000
CACFLAG4 EQU   CACFLAG+3                                                01202000
CACFLAG5 EQU   CACFLAG+4                                                01203000
CACFLAG6 EQU   CACFLAG+5                                                01204000
CAPD     EQU   IKJEBECA+152                                             01205000
CALINE   EQU   CAPD+18                                                  01206000
CALENGTH EQU   CAPD+19                                                  01207000
CATABS   EQU   CAPD+20                                                  01208000
CADSATTR EQU   CAPD+41                                                  01209000
CADSATR2 EQU   CAPD+42                                                  01210000
CALINTAB EQU   CADSATR2                                                 01211000
CAPTPDXT EQU   IKJEBECA+228                                             01212000
CALRECL  EQU   IKJEBECA+232                                             01213000
CAEDFLAG EQU   IKJEBECA+236                                             01214000
CAEDFLG2 EQU   IKJEBECA+237                                             01215000
CASAFLAG EQU   IKJEBECA+376                                             01216000
CASAFLG2 EQU   IKJEBECA+377                                             01217000
CASYNLST EQU   IKJEBECA+496                                             01218000
CASYNWA  EQU   IKJEBECA+508                                             01219000
CASYNOPT EQU   IKJEBECA+524                                             01220000
CASYNSW  EQU   CASYNOPT+3                                               01221000
CATMPLST EQU   IKJEBECA+528                                             01222000
CAMAWKA  EQU   IKJEBECA+596                                             01223000
MACFLAGS EQU   CAMAWKA+28                                               01224000
MACFLAG2 EQU   CAMAWKA+29                                               01225000
CASRWKA  EQU   IKJEBECA+728                                             01226000
CAMODEMG EQU   IKJEBECA+928                                             01227000
CATEMPBF EQU   IKJEBECA+2648                                            01228000
CANXTSVA EQU   IKJEBECA+3896                                            01229000
IKJEBECX EQU   0                                                        01230000
PARMLIST EQU   0                                                        01231000
ENTRYCD  EQU   PARMLIST                                                 01232000
TEXTPTR  EQU   PARMLIST+1                                               01233000
INPUTBFR EQU   0                                                        01234000
TEXTLEN  EQU   INPUTBFR                                                 01235000
TEXTBFR  EQU   INPUTBFR+4                                               01236000
@NM00025 EQU   0                                                        01237000
GETLEN   EQU   @NM00025                                                 01238000
GETOFFS  EQU   @NM00025+2                                               01239000
GETTXT   EQU   @NM00025+4                                               01240000
CASAVPTR EQU   0                                                        01241000
CASAVE   EQU   0                                                        01242000
I001C    EQU   0                                                        01243000
I008P    EQU   0                                                        01244000
I015F    EQU   0                                                        01245000
I015P    EQU   0                                                        01246000
I031F    EQU   0                                                        01247000
I031P    EQU   0                                                        01248000
I256C    EQU   0                                                        01249000
TEMPBFR  EQU   CATEMPBF                                                 01250000
@NM00024 EQU   CATEMPBF                                                 01251000
NEWLEN   EQU   @NM00024                                                 01252000
NEWOFF   EQU   @NM00024+2                                               01253000
*                                      START UNREFERENCED COMPONENTS    01254000
@NM00023 EQU   INPUTBFR+2                                               01255000
COMMPTR  EQU   PARMLIST+4                                               01256000
CXDATEXT EQU   IKJEBECX                                                 01257000
CAPDEXT  EQU   IKJEBECA+3984                                            01258000
CADSNRC2 EQU   IKJEBECA+3928                                            01259000
CADSNOF2 EQU   IKJEBECA+3926                                            01260000
CADSNLN2 EQU   IKJEBECA+3924                                            01261000
CADSNPT2 EQU   IKJEBECA+3920                                            01262000
@NM00022 EQU   IKJEBECA+3900                                            01263000
CASVAREA EQU   IKJEBECA+3176                                            01264000
CABFRPL  EQU   IKJEBECA+2120                                            01265000
CASCWKA  EQU   IKJEBECA+1448                                            01266000
CAFIBFR  EQU   IKJEBECA+1188                                            01267000
CAAEDCB  EQU   IKJEBECA+1096                                            01268000
CALDROP  EQU   IKJEBECA+1064                                            01269000
CAATNWKA EQU   IKJEBECA+956                                             01270000
CAATNBUF EQU   IKJEBECA+952                                             01271000
CAMODETX EQU   CAMODEMG+12                                              01272000
CAMODEOF EQU   CAMODEMG+10                                              01273000
CAMODELN EQU   CAMODEMG+8                                               01274000
CAMODEPT EQU   CAMODEMG+4                                               01275000
CAMODEIS EQU   CAMODEMG                                                 01276000
CAMSWKA  EQU   IKJEBECA+628                                             01277000
@NM00021 EQU   CAMAWKA+30                                               01278000
@NM00020 EQU   MACFLAG2                                                 01279000
MATABLE1 EQU   MACFLAG2                                                 01280000
@NM00019 EQU   MACFLAGS                                                 01281000
MAENDPRC EQU   MACFLAGS                                                 01282000
MAABBREV EQU   MACFLAGS                                                 01283000
MAECTMOD EQU   MACFLAGS                                                 01284000
@NM00018 EQU   CAMAWKA                                                  01285000
CASTAEPL EQU   IKJEBECA+576                                             01286000
CASTAXPL EQU   IKJEBECA+556                                             01287000
CASRPLST EQU   CATMPLST+12                                              01288000
CAPTECB  EQU   CATMPLST+8                                               01289000
CAPTECT  EQU   CATMPLST+4                                               01290000
CAPTUPT  EQU   CATMPLST                                                 01291000
CASYNSCN EQU   CASYNSW                                                  01292000
CASYNML  EQU   CASYNSW                                                  01293000
CASYNSF  EQU   CASYNSW                                                  01294000
CASYNRFM EQU   CASYNSW                                                  01295000
CASYNIS  EQU   CASYNSW                                                  01296000
@NM00017 EQU   CASYNSW                                                  01297000
CASYNLN  EQU   CASYNSW                                                  01298000
@NM00016 EQU   CASYNSW                                                  01299000
CASYNRCL EQU   CASYNOPT+2                                               01300000
CASYNCD2 EQU   CASYNOPT+1                                               01301000
CASYNCD1 EQU   CASYNOPT                                                 01302000
CASYNTEM EQU   CASYNWA+12                                               01303000
CASYNMS2 EQU   CASYNWA+8                                                01304000
CASYNMS1 EQU   CASYNWA+4                                                01305000
CASYNWAP EQU   CASYNWA+1                                                01306000
CASYNECD EQU   CASYNWA                                                  01307000
CASYNPTO EQU   CASYNLST+8                                               01308000
CASYNPWA EQU   CASYNLST+4                                               01309000
CASYNBFR EQU   CASYNLST                                                 01310000
@NM00015 EQU   IKJEBECA+484                                             01311000
CARECNO  EQU   IKJEBECA+480                                             01312000
CAINSAVE EQU   IKJEBECA+476                                             01313000
@NM00014 EQU   IKJEBECA+472                                             01314000
CAIMLINC EQU   IKJEBECA+468                                             01315000
CAIMLLNO EQU   IKJEBECA+464                                             01316000
CAINCRE  EQU   IKJEBECA+460                                             01317000
CACURNUM EQU   IKJEBECA+456                                             01318000
CANXTREC EQU   IKJEBECA+452                                             01319000
CASTNUM  EQU   IKJEBECA+448                                             01320000
CASAPSWD EQU   IKJEBECA+440                                             01321000
CASADDN  EQU   IKJEBECA+432                                             01322000
CASAMEMB EQU   IKJEBECA+424                                             01323000
CASADSN  EQU   IKJEBECA+380                                             01324000
CASADSNL EQU   IKJEBECA+378                                             01325000
CASADQTY EQU   CASAFLG2                                                 01326000
CASANCTG EQU   CASAFLG2                                                 01327000
CASAALOC EQU   CASAFLAG                                                 01328000
CASAUNCG EQU   CASAFLAG                                                 01329000
CASADSOR EQU   CASAFLAG                                                 01330000
CASAMEM  EQU   CASAFLAG                                                 01331000
CASADISP EQU   CASAFLAG                                                 01332000
CASAINCP EQU   CASAFLAG                                                 01333000
CASAFNCP EQU   CASAFLAG                                                 01334000
CASAVEDS EQU   CASAFLAG                                                 01335000
CADSNREC EQU   IKJEBECA+320                                             01336000
CADSNOFF EQU   IKJEBECA+318                                             01337000
CADSNLEN EQU   IKJEBECA+316                                             01338000
CADSNPTR EQU   IKJEBECA+312                                             01339000
CAEDTSIZ EQU   IKJEBECA+308                                             01340000
CAEDPSWD EQU   IKJEBECA+300                                             01341000
CAEDDDN  EQU   IKJEBECA+292                                             01342000
CAEDMEMB EQU   IKJEBECA+284                                             01343000
CAEDDSN  EQU   IKJEBECA+240                                             01344000
CAEDDSNL EQU   IKJEBECA+238                                             01345000
CAEDPRTC EQU   CAEDFLG2                                                 01346000
CAEDALOC EQU   CAEDFLAG                                                 01347000
CAEDUNCG EQU   CAEDFLAG                                                 01348000
CAEDDSOR EQU   CAEDFLAG                                                 01349000
CAEDMEM  EQU   CAEDFLAG                                                 01350000
CAEDDISP EQU   CAEDFLAG                                                 01351000
CAEDINCP EQU   CAEDFLAG                                                 01352000
CAEDFNCP EQU   CAEDFLAG                                                 01353000
CAEDITDS EQU   CAEDFLAG                                                 01354000
CABLK2   EQU   IKJEBECA+234                                             01355000
@NM00013 EQU   IKJEBECA+226                                             01356000
CAPDEND  EQU   CAPD+82                                                  01357000
CADATEXT EQU   CAPD+74                                                  01358000
CAEXTNAM EQU   CAPD+66                                                  01359000
CAPRNAME EQU   CAPD+58                                                  01360000
CACHKOPT EQU   CAPD+56                                                  01361000
CAULRLMX EQU   CAPD+54                                                  01362000
CAULRLDF EQU   CAPD+52                                                  01363000
CAVLRLMX EQU   CAPD+50                                                  01364000
CAVLRLDF EQU   CAPD+48                                                  01365000
CAFLRLMX EQU   CAPD+46                                                  01366000
CAFLRLDF EQU   CAPD+44                                                  01367000
CARECFMD EQU   CAPD+43                                                  01368000
@NM00012 EQU   CADSATR2                                                 01369000
CAINLIST EQU   CADSATR2                                                 01370000
CARUNDS  EQU   CADSATR2                                                 01371000
CAOBJGEN EQU   CADSATR2                                                 01372000
CADSNDEF EQU   CADSATR2                                                 01373000
@NM00011 EQU   CADSATTR                                                 01374000
CALRECLX EQU   CADSATTR                                                 01375000
CALNNUM  EQU   CADSATTR                                                 01376000
CADSCONT EQU   CADSATTR                                                 01377000
CACAPSDF EQU   CADSATTR                                                 01378000
CACAPSRQ EQU   CADSATTR                                                 01379000
CASCAN   EQU   CADSATTR                                                 01380000
CARUN    EQU   CADSATTR                                                 01381000
CADSCODE EQU   CAPD+40                                                  01382000
CASYNAME EQU   CAPD+32                                                  01383000
CABLKS   EQU   CAPD+16                                                  01384000
CADSQUAL EQU   CAPD+8                                                   01385000
CADSTYPE EQU   CAPD                                                     01386000
@NM00010 EQU   CACFLAG+8                                                01387000
CAPLIRTM EQU   CACFLAG+7                                                01388000
CAPLILFM EQU   CACFLAG+6                                                01389000
@NM00009 EQU   CACFLAG6                                                 01390000
CACHAR60 EQU   CACFLAG6                                                 01391000
CACHAR48 EQU   CACFLAG6                                                 01392000
CAFREE   EQU   CACFLAG6                                                 01393000
@NM00008 EQU   CACFLAG5                                                 01394000
CAEDLNDP EQU   CACFLAG5                                                 01395000
CADSUSED EQU   CACFLAG4                                                 01396000
CARECURS EQU   CACFLAG4                                                 01397000
CAINPROC EQU   CACFLAG4                                                 01398000
CASCRC20 EQU   CACFLAG4                                                 01399000
CAABEND  EQU   CACFLAG4                                                 01400000
CATPUTVF EQU   CACFLAG4                                                 01401000
CAPTGTBF EQU   CACFLAG4                                                 01402000
CAFINDIS EQU   CACFLAG4                                                 01403000
@NM00007 EQU   CAIMFLG                                                  01404000
CAIMINPT EQU   CAIMFLG                                                  01405000
CAIMSFPT EQU   CAIMFLG                                                  01406000
CAIMCIN  EQU   CAIMFLG                                                  01407000
CAIMIR   EQU   CAIMFLG                                                  01408000
CAIMSC   EQU   CAIMFLG                                                  01409000
CAIMINS  EQU   CAIMFLG                                                  01410000
CAIMPT   EQU   CAIMFLG                                                  01411000
@NM00006 EQU   CACFLAG2                                                 01412000
CASEQCOL EQU   CACFLAG2                                                 01413000
CAMODMSG EQU   CACFLAG2                                                 01414000
CASCANON EQU   CACFLAG2                                                 01415000
CADSMODS EQU   CACFLAG2                                                 01416000
CAENDSC  EQU   CACFLAG1                                                 01417000
CAINITSC EQU   CACFLAG1                                                 01418000
CASCANSW EQU   CACFLAG1                                                 01419000
CAPROMPT EQU   CACFLAG1                                                 01420000
CAVRFYSW EQU   CACFLAG1                                                 01421000
CALNTOVF EQU   CACFLAG1                                                 01422000
CAATTNIS EQU   CAATTN                                                   01423000
@NM00005 EQU   CAATTN                                                   01424000
@NM00004 EQU   IKJEBECA+118                                             01425000
CAMAXBLK EQU   IKJEBECA+116                                             01426000
@NM00003 EQU   IKJEBECA+88                                              01427000
CAPTICLN EQU   IKJEBECA+84                                              01428000
CAPTICDS EQU   IKJEBECA+80                                              01429000
CAPTNBFR EQU   IKJEBECA+76                                              01430000
CAPTCHK  EQU   IKJEBECA+72                                              01431000
CACORELN EQU   IKJEBECA+68                                              01432000
CAPTCORE EQU   IKJEBECA+64                                              01433000
CAUTILNO EQU   IKJEBECA+60                                              01434000
CAPTPDCB EQU   IKJEBECA+56                                              01435000
CAPTCDCB EQU   IKJEBECA+52                                              01436000
@NM00002 EQU   IKJEBECA+50                                              01437000
CASCMDLN EQU   IKJEBECA+48                                              01438000
CAPTSCMD EQU   IKJEBECA+44                                              01439000
CAOPERND EQU   CAPTIBFR                                                 01440000
CAFREEDL EQU   CAPRSPDL                                                 01441000
CAPTRTRY EQU   IKJEBECA+32                                              01442000
CAPTMSGM EQU   IKJEBECA+28                                              01443000
CAPTUT   EQU   IKJEBECA+24                                              01444000
CAPTMS   EQU   IKJEBECA+20                                              01445000
CAPTLE   EQU   IKJEBECA+16                                              01446000
CAPTAT   EQU   IKJEBECA+12                                              01447000
CAPTAE   EQU   IKJEBECA+8                                               01448000
@NM00001 EQU   IKJEBECA+4                                               01449000
CAPTTMP  EQU   IKJEBECA                                                 01450000
*                                      END UNREFERENCED COMPONENTS      01451000
@RT00093 EQU   NOTABS                                                   01452000
@RT00106 EQU   ENDSCAN                                                  01453000
@RC00148 EQU   ENDSCAN                                                  01454000
@RT00168 EQU   NOLNUM                                                   01455000
@RC00172 EQU   ENDSCAN                                                  01456000
@RT00257 EQU   FOUND                                                    01457000
@RT00273 EQU   SKIPSCAN                                                 01458000
@PB00003 EQU   @EL00001                                                 01459000
@PB00002 EQU   @PB00003                                                 01460000
@ENDDATA EQU   *                                                        01461000
         END   IKJEBELE,(C'PLS2047',0701,76027)                         01462000
