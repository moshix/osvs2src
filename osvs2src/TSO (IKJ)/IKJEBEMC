         TITLE 'IKJEBEMC - MOVE/COPY SUBCOMMAND OF EDIT                *00001000
                        '                                               00002000
IKJEBEMC CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'IKJEBEMC  75.328'                                 0001 00009000
IKJEBEMM DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00059-IKJEBEMM)                                   00013000
         ENTRY IKJEBEMM                                                 00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00016000
         BALR  @11,0                                               0001 00017000
@PSTART  LA    @12,4095(,@11)                                      0001 00018000
         USING @PSTART,@11                                         0001 00019000
         USING @PSTART+4095,@12                                    0001 00020000
         AH    @15,4(,@15)                                         0001 00021000
         BR    @15                                                 0001 00022000
@EP00001 DS    0H                                                  0002 00023000
*   COMMREG = GPR01P;                /* GET ADDR OF IKJEBECA         */ 00024000
         LR    COMMREG,GPR01P                                      0036 00025000
*   RESPECIFY (GPR01P) UNRSTD;                                     0037 00026000
*                                                                  0037 00027000
*   RESPECIFY (GPR13P,GPR15P) RSTD;                                0038 00028000
*   GPR15P = CANXTSVA;               /* SAVE AREA FOR THIS MODULE    */ 00029000
         L     GPR15P,CANXTSVA(,COMMREG)                           0039 00030000
*   EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS SAVEAREA    */ 00031000
         LA    @14,4                                               0040 00032000
         ALR   @14,GPR15P                                          0040 00033000
         ST    GPR13P,CASAVPTR(,@14)                               0040 00034000
*                                    /* BKWD PTR                     */ 00035000
*   EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER FWD PTR   */ 00036000
         LA    @14,8                                               0041 00037000
         ALR   @14,GPR13P                                          0041 00038000
         ST    GPR15P,CASAVPTR(,@14)                               0041 00039000
*   GPR13P = GPR15P;                 /* NEW SAVEAREA ADDR            */ 00040000
         LR    GPR13P,GPR15P                                       0042 00041000
*   CANXTSVA = GPR13P + 72;          /* UPDATE NEX-SAVE-AREA PTR     */ 00042000
         LA    @14,72                                              0043 00043000
         ALR   @14,GPR13P                                          0043 00044000
         ST    @14,CANXTSVA(,COMMREG)                              0043 00045000
*   RESPECIFY (GPR13P,GPR15P) UNRSTD;                              0044 00046000
*                                                                  0044 00047000
*   DATDREG = ADDR(CASCWKA);         /* SET BASE REG FOR WORK AREA   */ 00048000
         LA    DATDREG,CASCWKA(,COMMREG)                           0045 00049000
*   GEN( USING @DATD,DATDREG);       /* SET ADDRESSABILITY TO        */ 00050000
          USING @DATD,DATDREG                                           00051000
*                                    /* CASCWKA                      */ 00052000
*                                                                  0047 00053000
*                                                                  0047 00054000
*                                                                  0047 00055000
*                                                                  0047 00056000
*                                                                  0047 00057000
*   STATUS = CONTINUE;              /* INITIAL CONTINUE STATUS       */ 00058000
         SLR   STATUS,STATUS                                       0047 00059000
*   COMMAND = COPY;                 /* INDICATE COPY                 */ 00060000
*                                                                  0048 00061000
         MVI   COMMAND,X'02'                                       0048 00062000
*   CALL MAINLINE;                  /* CALL THE MAINLINE             */ 00063000
*                                                                  0049 00064000
*                                                                  0049 00065000
*                                                                  0049 00066000
*                                                                  0049 00067000
*                                                                  0049 00068000
*                                                                  0049 00069000
         BAL   @14,MAINLINE                                        0049 00070000
*   RESPECIFY (GPR12P,GPR13P) RSTD;                                0050 00071000
*   CANXTSVA = GPR13P;               /* UPDATE NEXT-SAVE-AREA PTR    */ 00072000
         ST    GPR13P,CANXTSVA(,COMMREG)                           0051 00073000
*   GPR12P = GPR13P;                 /* SAVE PRESENT SAVE-AREA ADDR  */ 00074000
         LR    GPR12P,GPR13P                                       0052 00075000
*   GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD SAVE-AREA PTR */ 00076000
         L     @08,CASAVPTR+4(,GPR13P)                             0053 00077000
         LR    GPR13P,@08                                          0053 00078000
*   RESPECIFY CASAVE BASED(GPR12P);  /* CHANGE BASE FOR SAVE-AREA    */ 00079000
*   CASAVE = CASAVE && CASAVE;       /* ZERO OUT THIS SAVE-AREA      */ 00080000
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0055 00081000
*   RESPECIFY CASAVE BASED;                                        0056 00082000
*   RETURN CODE(RETCODE);            /* RETURN WITH RETURN CODE      */ 00083000
         L     @15,RETCODE                                         0057 00084000
         L     @14,12(,@13)                                        0057 00085000
         LM    @00,@12,20(@13)                                     0057 00086000
         BR    @14                                                 0057 00087000
*   RESPECIFY (GPR12P,GPR13P) UNRSTD;                              0058 00088000
*                                                                  0058 00089000
*/********************************************************************/ 00090000
*/*                                                                  */ 00091000
*/*ENTRY POINT-                                                      */ 00092000
*/*          FOR MOVE                                                */ 00093000
*/*                                                                  */ 00094000
*/*FUNCTION-                                                         */ 00095000
*/*          INDICATE THAT THE COMMAND IS A MOVE AND CALL MAINLINE   */ 00096000
*/*                                                                  */ 00097000
*/********************************************************************/ 00098000
*                                                                  0059 00099000
*IKJEBEMM:                                                         0059 00100000
*   ENTRY;                                                         0059 00101000
@EP00059 DS    0H                                                  0060 00102000
*   RESPECIFY (GPR01P) RSTD;                                       0060 00103000
*   COMMREG = GPR01P;                /* GET ADDR OF IKJEBECA         */ 00104000
         LR    COMMREG,GPR01P                                      0061 00105000
*   RESPECIFY (GPR01P) UNRSTD;                                     0062 00106000
*                                                                  0062 00107000
*   RESPECIFY (GPR13P,GPR15P) RSTD;                                0063 00108000
*   GPR15P = CANXTSVA;               /* SAVE AREA FOR THIS MODULE    */ 00109000
         L     GPR15P,CANXTSVA(,COMMREG)                           0064 00110000
*   EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS SAVEAREA    */ 00111000
         LA    @14,4                                               0065 00112000
         ALR   @14,GPR15P                                          0065 00113000
         ST    GPR13P,CASAVPTR(,@14)                               0065 00114000
*                                    /* BKWD PTR                     */ 00115000
*   EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER FWD PTR   */ 00116000
         LA    @14,8                                               0066 00117000
         ALR   @14,GPR13P                                          0066 00118000
         ST    GPR15P,CASAVPTR(,@14)                               0066 00119000
*   GPR13P = GPR15P;                 /* NEW SAVEAREA ADDR            */ 00120000
         LR    GPR13P,GPR15P                                       0067 00121000
*   CANXTSVA = GPR13P + 72;          /* UPDATE NEX-SAVE-AREA PTR     */ 00122000
         LA    @14,72                                              0068 00123000
         ALR   @14,GPR13P                                          0068 00124000
         ST    @14,CANXTSVA(,COMMREG)                              0068 00125000
*   RESPECIFY (GPR13P,GPR15P) UNRSTD;                              0069 00126000
*                                                                  0069 00127000
*   DATDREG = ADDR(CASCWKA);         /* SET BASE REG FOR WORK AREA   */ 00128000
         LA    DATDREG,CASCWKA(,COMMREG)                           0070 00129000
*   GEN( USING @DATD,DATDREG);       /* SET ADDRESSABILITY TO        */ 00130000
          USING @DATD,DATDREG                                           00131000
*                                    /* CASCWKA                      */ 00132000
*                                                                  0072 00133000
*                                                                  0072 00134000
*                                                                  0072 00135000
*                                                                  0072 00136000
*                                                                  0072 00137000
*   STATUS = CONTINUE;              /* INITIAL CONTINUE STATUS       */ 00138000
         SLR   STATUS,STATUS                                       0072 00139000
*   COMMAND = MOVE;                 /* INDICATE MOVE                 */ 00140000
*                                                                  0073 00141000
         MVI   COMMAND,X'01'                                       0073 00142000
*   CALL MAINLINE;                  /* START MOVE PROCESSING         */ 00143000
*                                                                  0074 00144000
*                                                                  0074 00145000
*                                                                  0074 00146000
*                                                                  0074 00147000
*                                                                  0074 00148000
*                                                                  0074 00149000
         BAL   @14,MAINLINE                                        0074 00150000
*   RESPECIFY (GPR12P,GPR13P) RSTD;                                0075 00151000
*   CANXTSVA = GPR13P;               /* UPDATE NEXT-SAVE-AREA PTR    */ 00152000
         ST    GPR13P,CANXTSVA(,COMMREG)                           0076 00153000
*   GPR12P = GPR13P;                 /* SAVE PRESENT SAVE-AREA ADDR  */ 00154000
         LR    GPR12P,GPR13P                                       0077 00155000
*   GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD SAVE-AREA PTR */ 00156000
         L     @08,CASAVPTR+4(,GPR13P)                             0078 00157000
         LR    GPR13P,@08                                          0078 00158000
*   RESPECIFY CASAVE BASED(GPR12P);  /* CHANGE BASE FOR SAVE-AREA    */ 00159000
*   CASAVE = CASAVE && CASAVE;       /* ZERO OUT THIS SAVE-AREA      */ 00160000
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0080 00161000
*   RESPECIFY CASAVE BASED;                                        0081 00162000
*   RETURN CODE(RETCODE);            /* RETURN WITH RETURN CODE      */ 00163000
         L     @15,RETCODE                                         0082 00164000
         L     @14,12(,@13)                                        0082 00165000
         LM    @00,@12,20(@13)                                     0082 00166000
         BR    @14                                                 0082 00167000
*   RESPECIFY (GPR12P,GPR13P) UNRSTD;                              0083 00168000
*                                                                  0083 00169000
*/********************************************************************/ 00170000
*/*                                                                  */ 00171000
*/*MAINLINE-                                                         */ 00172000
*/*          FOR MOVE/COPY                                           */ 00173000
*/*                                                                  */ 00174000
*/*      INIT-                                                       */ 00175000
*/*          INITIALIZE THE REQUIRED ITEMS                           */ 00176000
*/*                                                                  */ 00177000
*/*      CHECK-                                                      */ 00178000
*/*          CHECK FOR THOSE SPECIFIC CASES THAT WILL CAUSE          */ 00179000
*/*          TERMINATION IMMEDIATELY                                 */ 00180000
*/*                                                                  */ 00181000
*/*      OPERANDS-                                                   */ 00182000
*/*          OBTAIN THE VALUES FROM THE INPUT LINE REQUIRED TO DO    */ 00183000
*/*          THE MOVE/COPY                                           */ 00184000
*/*                                                                  */ 00185000
*/*      DATAEXIT-                                                   */ 00186000
*/*          INVOKE THE INSTALLATION EXIT IF THERE IS ONE            */ 00187000
*/*                                                                  */ 00188000
*/*      MOVECOPY-                                                   */ 00189000
*/*          PERFORM THE ACTUAL MOVE/COPY                            */ 00190000
*/*                                                                  */ 00191000
*/*      IPLIEXIT-                                                   */ 00192000
*/*          HANDLE IPLI DATA SETS                                   */ 00193000
*/*                                                                  */ 00194000
*/*      CLEANUP-                                                    */ 00195000
*/*          FREE PDL AND UTILITY DATASET IF GOTTEN                  */ 00196000
*/*                                                                  */ 00197000
*/*      HANDLERR-                                                   */ 00198000
*/*          HANDLE ANY ERRORS THAT MAY HAVE OCCURRED                */ 00199000
*/*                                                                  */ 00200000
*/********************************************************************/ 00201000
*MAINLINE:                                                         0084 00202000
*        PROC OPTIONS(NOSAVE);                                     0084 00203000
*                                                                  0084 00204000
MAINLINE DS    0H                                                  0085 00205000
*    RESPECIFY (GPR14P) RSTD;                                      0085 00206000
*    MAINLI14 = GPR14P;              /* SAVE REG 14                  */ 00207000
         ST    GPR14P,MAINLI14                                     0086 00208000
*    RESPECIFY (GPR14P) UNRSTD;                                    0087 00209000
*                                                                  0087 00210000
*    CALL INIT;                      /*DO INITIALIZATION             */ 00211000
*                                                                  0088 00212000
         BAL   @14,INIT                                            0088 00213000
*    CALL CHECK;                     /* LOOK FOR TERMINATING CASES   */ 00214000
*                                                                  0089 00215000
         BAL   @14,CHECK                                           0089 00216000
*    IF STATUS = CONTINUE            /* CONTINUE FROM CHECK          */ 00217000
*      THEN DO;                      /*   YES - CONTINUE FROM CHECK  */ 00218000
*                                                                  0090 00219000
         LTR   STATUS,STATUS                                       0090 00220000
         BNZ   @RF00090                                            0090 00221000
*        CALL OPERANDS;              /* HANDLE OPERANDS              */ 00222000
*                                                                  0092 00223000
         BAL   @14,OPERANDS                                        0092 00224000
*        IF STATUS = CONTINUE        /* CONTINUE FROM OPERANDS       */ 00225000
*          THEN DO;                  /*   YES - DO MOVE OR COPY      */ 00226000
         LTR   STATUS,STATUS                                       0093 00227000
         BNZ   @RF00093                                            0093 00228000
*            IF CXDATEXT ^= NODAEXIT  & /* IF THERE IS A DATA EXIT   */ 00229000
*               CADSCODE = CAVBASIC     /* AND ARE EDITTING VSBASIC  */ 00230000
*              THEN                  /* THEN GO TO USERS DATA EXIT   */ 00231000
         L     @08,CAPTPDXT(,COMMREG)                              0095 00232000
         CLC   CXDATEXT(8,@08),@CB01330                            0095 00233000
         BE    @RF00095                                            0095 00234000
         CLI   CADSCODE(COMMREG),X'1E'                             0095 00235000
         BNE   @RF00095                                            0095 00236000
*                CALL DATAEXIT;      /* INVOKE USERS DATA EXIT       */ 00237000
*                                                                  0096 00238000
         BAL   @14,DATAEXIT                                        0096 00239000
*            IF STATUS = CONTINUE    /* CAN MOVE/COPY CONTINUE       */ 00240000
*              THEN DO;              /* THEN CONTINUE WITH MOVE/COPY */ 00241000
@RF00095 LTR   STATUS,STATUS                                       0097 00242000
         BNZ   @RF00097                                            0097 00243000
*                CALL MOVECOPY;      /* PERFORM THE MOVE/COPY        */ 00244000
*                                                                  0099 00245000
         BAL   @14,MOVECOPY                                        0099 00246000
*                IF STATUS = CONTINUE &     /*TCONTINUE FROM M/C ... */ 00247000
*                   CADSCODE = CAIPLI       /* ... & IS IT IPLI DS   */ 00248000
*                  THEN                     /* THEN HANDLE IPLI DS   */ 00249000
         LTR   STATUS,STATUS                                       0100 00250000
         BNZ   @RF00100                                            0100 00251000
         CLI   CADSCODE(COMMREG),X'21'                             0100 00252000
         BNE   @RF00100                                            0100 00253000
*                    CALL IPLIEXIT;         /* INVOKE IPLI INTEFFACE */ 00254000
         BAL   @14,IPLIEXIT                                        0101 00255000
*                END;                                              0102 00256000
@RF00100 DS    0H                                                  0103 00257000
*            END;                                                  0103 00258000
@RF00097 DS    0H                                                  0104 00259000
*        END;                                                      0104 00260000
*                                                                  0104 00261000
@RF00093 DS    0H                                                  0105 00262000
*    CALL CLEANUP;                   /* PERFORM CLEAN UP             */ 00263000
*                                                                  0105 00264000
@RF00090 BAL   @14,CLEANUP                                         0105 00265000
*    IF STATUS ^= CONTINUE &         /* WERE THERE ANY ERRORS        */ 00266000
*       STATUS ^= TERMNOER           /* DO THEY HAVE ERROR MSGS      */ 00267000
*      THEN                          /*   YES - THERE WERE ERRORS    */ 00268000
         LTR   STATUS,STATUS                                       0106 00269000
         BZ    @RF00106                                            0106 00270000
         C     STATUS,@CF00890                                     0106 00271000
         BE    @RF00106                                            0106 00272000
*        CALL HANDLERR;              /* HANDLE ANY ERRORS            */ 00273000
*                                                                  0107 00274000
         BAL   @14,HANDLERR                                        0107 00275000
*    RESPECIFY (GPR14P) RSTD;        /* RESTORE REG 14               */ 00276000
@RF00106 DS    0H                                                  0109 00277000
*    GPR14P = MAINLI14;                                            0109 00278000
         L     GPR14P,MAINLI14                                     0109 00279000
*    RESPECIFY (GPR14P) UNRSTD;                                    0110 00280000
*                                                                  0110 00281000
*END MAINLINE;                                                     0111 00282000
@EL00002 DS    0H                                                  0111 00283000
@EF00002 DS    0H                                                  0111 00284000
@ER00002 BR    @14                                                 0111 00285000
*/********************************************************************/ 00286000
*/*                                                                  */ 00287000
*/*SEGMENT-                                                          */ 00288000
*/*          INIT PART 1                                             */ 00289000
*/*                                                                  */ 00290000
*/*FUNCTION-                                                         */ 00291000
*/*          INITIALIZE VARIALBLES                                   */ 00292000
*/*                                                                  */ 00293000
*/*OPERATION-                                                        */ 00294000
*/*          SET DEFAULT VALUES FOR VARIABLES AND BITS               */ 00295000
*/*                                                                  */ 00296000
*/********************************************************************/ 00297000
*                                                                  0112 00298000
*INIT:                                                             0112 00299000
*        PROC OPTIONS(NOSAVE);                                     0112 00300000
*                                                                  0112 00301000
INIT     DS    0H                                                  0113 00302000
*    RESPECIFY (GPR14P) RSTD;                                      0113 00303000
*    INIT14 = GPR14P;                /* SAVE REG 14                  */ 00304000
         LR    INIT14,GPR14P                                       0114 00305000
*    RESPECIFY (GPR14P) UNRSTD;                                    0115 00306000
*                                                                  0115 00307000
*    CAPTPRSD = ZERO;                /* INDICATE NO PDL              */ 00308000
         SLR   @08,@08                                             0116 00309000
         ST    @08,CAPTPRSD(,COMMREG)                              0116 00310000
*    THECOUNT = ZERO;                /* TENTATIVE NUMBER OF LINES    */ 00311000
         ST    @08,THECOUNT                                        0117 00312000
*    FIRSTREC = ZERO;                /* TENTATIVE KEY OF FIRST REC   */ 00313000
         ST    @08,FIRSTREC                                        0118 00314000
*    VERIFY = ZERO;                  /* LINE TO VERIFY IS LINE 0     */ 00315000
         ST    @08,VERIFY                                          0119 00316000
*    RETCODE = ZERO;                 /* RETURN CODE IS ZERO          */ 00317000
         ST    @08,RETCODE                                         0120 00318000
*    INSRTKEY = ZERO;                /* DEFAULT VALUE FOR INSERT PT  */ 00319000
         ST    @08,INSRTKEY                                        0121 00320000
*    LIMITKEY = ZERO;                /* DEFAULT FOR LIMIT OF MOVE    */ 00321000
*                                                                  0122 00322000
         ST    @08,LIMITKEY                                        0122 00323000
*    THEBITS = ''B;                  /* ZERO THE CONTROL BITS        */ 00324000
*                                                                  0123 00325000
         MVI   THEBITS,X'00'                                       0123 00326000
*    THEINCR = CAINCRE;              /* DEFAULT IF NOT SET ON COMMAND*/ 00327000
*                                                                  0124 00328000
         L     @08,CAINCRE(,COMMREG)                               0124 00329000
         ST    @08,THEINCR                                         0124 00330000
*    FIRSTKEY = CACURNUM;            /* DEFAULT FOR FIRST LINE MOVED */ 00331000
         L     @08,CACURNUM(,COMMREG)                              0125 00332000
         ST    @08,FIRSTKEY                                        0125 00333000
*    ORIGFRST = CACURNUM;            /* FIRST LINE AS ENTERED ON CMND*/ 00334000
         ST    @08,ORIGFRST                                        0126 00335000
*    LASTKEY = CACURNUM;             /* DEFAULT VALUE FOR LAST KEY   */ 00336000
         ST    @08,LASTKEY                                         0127 00337000
*    NEWKEY = CACURNUM;              /* DEFAULT NEW KEY FOR FIRST LIN*/ 00338000
*                                                                  0128 00339000
         LR    NEWKEY,@08                                          0128 00340000
*    TYPE = STRING;                  /* DEFAULT TYPE OF STRING       */ 00341000
         MVI   TYPE,X'03'                                          0129 00342000
*/********************************************************************/ 00343000
*/*                                                                  */ 00344000
*/*SEGMENT-                                                          */ 00345000
*/*          INIT PART 2                                             */ 00346000
*/*                                                                  */ 00347000
*/*OPERATION CONTINUED-                                              */ 00348000
*/*          INITIALIZE THE VARIOUS PARAMETER LISTS THAT WILL BE     */ 00349000
*/*          USED BY IKJEBEUT                                        */ 00350000
*/*                                                                  */ 00351000
*/********************************************************************/ 00352000
*                                                                  0130 00353000
*    UTPARMP = ADDR(READPARM);       /* PARMS  TO READ                * 00354000
         LA    UTPARMP,READPARM                                    0130 00355000
*    UTCODE = CAUTREAD;              /* CODE TO READ A SPECIFIC KEY  */ 00356000
         MVI   UTCODE(UTPARMP),X'00'                               0131 00357000
*    UTDCBPTR = CAPTCDCB;            /* CURREND DATA SET DCB         */ 00358000
         L     @08,CAPTCDCB(,COMMREG)                              0132 00359000
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0132 00360000
*    UTKEYPTR = ADDR(THEKEY);        /* READ REC WITH KEY = THEKEY   */ 00361000
         LA    @06,THEKEY(,COMMREG)                                0133 00362000
         ST    @06,UTKEYPTR(,UTPARMP)                              0133 00363000
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */ 00364000
         LA    @05,THEBUFFR(,COMMREG)                              0134 00365000
         ST    @05,UTBUFPTR(,UTPARMP)                              0134 00366000
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */ 00367000
*                                                                  0135 00368000
         OI    UTEOL3(UTPARMP),B'10000000'                         0135 00369000
*    UTPARMP = ADDR(READFRST);       /* PARMS TO READ FIRST RECORD   */ 00370000
         LA    UTPARMP,READFRST                                    0136 00371000
*    UTCODE = CAUTFRST;              /* CODE TO READ FIRST           */ 00372000
         MVI   UTCODE(UTPARMP),X'04'                               0137 00373000
*    UTDCBPTR = CAPTCDCB;            /* CURREND DATA SET DCB         */ 00374000
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0138 00375000
*    UTKEYPTR = ADDR(THEKEY);        /* NO KEY REQUIRED              */ 00376000
         ST    @06,UTKEYPTR(,UTPARMP)                              0139 00377000
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */ 00378000
         ST    @05,UTBUFPTR(,UTPARMP)                              0140 00379000
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */ 00380000
*                                                                  0141 00381000
         OI    UTEOL3(UTPARMP),B'10000000'                         0141 00382000
*    UTPARMP = ADDR(READNEXT);       /* PARMS TO READ NEXT  RECORD   */ 00383000
         LA    UTPARMP,READNEXT                                    0142 00384000
*    UTCODE = CAUTNEXT;              /* CODE TO READ FIRST           */ 00385000
         MVI   UTCODE(UTPARMP),X'02'                               0143 00386000
*    UTDCBPTR = CAPTCDCB;            /* CURREND DATA SET DCB         */ 00387000
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0144 00388000
*    UTKEYPTR = ADDR(THEKEY);        /* READ NEXT AFTER THEKEY       */ 00389000
         ST    @06,UTKEYPTR(,UTPARMP)                              0145 00390000
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */ 00391000
         ST    @05,UTBUFPTR(,UTPARMP)                              0146 00392000
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */ 00393000
*                                                                  0147 00394000
         OI    UTEOL3(UTPARMP),B'10000000'                         0147 00395000
*    UTPARMP = ADDR(READPREV);       /* PARMS TO READ PREVIOUS REC   */ 00396000
         LA    UTPARMP,READPREV                                    0148 00397000
*    UTCODE = CAUTPREV;              /* CODE TO READ PREVIOUS RECORD */ 00398000
         MVI   UTCODE(UTPARMP),X'01'                               0149 00399000
*    UTDCBPTR = CAPTCDCB;            /* CURRENT DATA SET DCB         */ 00400000
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0150 00401000
*    UTKEYPTR = ADDR(THEKEY);        /* READ RECORD BEFORE THEKEY    */ 00402000
         ST    @06,UTKEYPTR(,UTPARMP)                              0151 00403000
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */ 00404000
         ST    @05,UTBUFPTR(,UTPARMP)                              0152 00405000
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */ 00406000
*                                                                  0153 00407000
         OI    UTEOL3(UTPARMP),B'10000000'                         0153 00408000
*    UTPARMP = ADDR(WRITEREC);       /* PARMS TO WRITE THEKEY        */ 00409000
         LA    UTPARMP,WRITEREC                                    0154 00410000
*    UTCODE = CAUTWRT;               /* CODE TO WRITE THEKEY         */ 00411000
         MVI   UTCODE(UTPARMP),X'20'                               0155 00412000
*    UTDCBPTR = CAPTCDCB;            /* CURRENT DATA SET DCB         */ 00413000
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0156 00414000
*    UTKEYPTR = ADDR(THEBUFFR);      /* THIS POINTS TO BUFFER NOT KEY*/ 00415000
         ST    @05,UTKEYPTR(,UTPARMP)                              0157 00416000
*    UTEOL2 = YES;                   /* INDICATE END OF LIST         */ 00417000
*                                                                  0158 00418000
         OI    UTEOL2(UTPARMP),B'10000000'                         0158 00419000
*    UTPARMP = ADDR(DELETKEY);       /* PARMS TO DELETE THEKEY       */ 00420000
         LA    UTPARMP,DELETKEY                                    0159 00421000
*    UTCODE = CAUTDELT;              /* CODE TO DELETE THEKEY        */ 00422000
         MVI   UTCODE(UTPARMP),X'10'                               0160 00423000
*    UTDCBPTR = CAPTCDCB;            /* CURRENT DATA SET DCB         */ 00424000
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0161 00425000
*    UTKEYPTR = ADDR(THEKEY);        /* THEKEY TO DELETE             */ 00426000
         ST    @06,UTKEYPTR(,UTPARMP)                              0162 00427000
*    UTEOL2 = YES;                   /* INDICATE END OF LIST         */ 00428000
*                                                                  0163 00429000
         OI    UTEOL2(UTPARMP),B'10000000'                         0163 00430000
*    RESPECIFY (GPR14P) RSTD;                                      0164 00431000
*    GPR14P = INIT14;                /* RESTORE REG 14               */ 00432000
         LR    GPR14P,INIT14                                       0165 00433000
*    RESPECIFY (GPR14P) UNRSTD;                                    0166 00434000
*                                                                  0166 00435000
*END INIT;                                                         0167 00436000
@EL00003 DS    0H                                                  0167 00437000
@EF00003 DS    0H                                                  0167 00438000
@ER00003 BR    @14                                                 0167 00439000
*/********************************************************************/ 00440000
*/*                                                                  */ 00441000
*/*SEGMENT-                                                          */ 00442000
*/*          CHECK                                                   */ 00443000
*/*                                                                  */ 00444000
*/*FUNTCTION-                                                        */ 00445000
*/*          CHECK FOR SPECIFIC CASES WHICH WILL REQUIRE IMMEDIATE   */ 00446000
*/*          TERMINATION OF MOVE/COPY                                */ 00447000
*/*                                                                  */ 00448000
*/*OPERATION-                                                        */ 00449000
*/*          IF THE DATASET TYPE IS BASIC THEN WE HAVE EN ERROR      */ 00450000
*/*                                                                  */ 00451000
*/*          IF THE COMMAND WAS A MOVE WITHOUT ANY OPERANDS THEN DO  */ 00452000
*/*          NOTHING BECAUSE WE WILL ONLY RENUMBER THE LINE.         */ 00453000
*/*                                                                  */ 00454000
*/*          IF THERE ARE NO RECORDS IN THE DATASET THEN WE HAVE     */ 00455000
*/*          AND ERROR.                                              */ 00456000
*/*                                                                  */ 00457000
*/*ERRORS-                                                           */ 00458000
*/*          MSG52580---CANNOT HANDLE BASIC TYPE DATA SETS           */ 00459000
*/*          TERMNOER---A MOVE WITH NO OPERANDS WILL DO NOTHING      */ 00460000
*/*          MSG52501---THE DATA SET IS EMPTY                        */ 00461000
*/*                                                                  */ 00462000
*/********************************************************************/ 00463000
*CHECK:                                                            0168 00464000
*        PROC OPTIONS(NOSAVE);                                     0168 00465000
*                                                                  0168 00466000
CHECK    DS    0H                                                  0169 00467000
*    RESPECIFY (GPR14P) RSTD;                                      0169 00468000
*    CHECK14 = GPR14P;               /* SAVE REG 14                  */ 00469000
         ST    GPR14P,CHECK14                                      0170 00470000
*    RESPECIFY (GPR14P) UNRSTD;                                    0171 00471000
*                                                                  0171 00472000
*    STATUS = CONTINUE;              /* TENTATIVE CONTINUE STATUS    */ 00473000
*                                                                  0172 00474000
         SLR   STATUS,STATUS                                       0172 00475000
*    IF CADSCODE = CABASIC           /* IF A BASIC DATA SET          */ 00476000
*      THEN STATUS = MSG52580;       /* INDICATE BASIC ERROR IN STATUS* 00477000
*                                                                  0173 00478000
*                                                                  0173 00479000
         CLI   CADSCODE(COMMREG),X'20'                             0173 00480000
         BNE   @RF00173                                            0173 00481000
         LH    STATUS,MSG52580                                     0174 00482000
*      ELSE                          /* NOT A BASIC DATA SET         */ 00483000
*        IF COMMAND = MOVE &         /* IF IT IS A MOVE AND ...      */ 00484000
*           CAOPERND = NO            /* ... WITHOUT OPERANDS         */ 00485000
*          THEN STATUS = TERMNOER;   /* TERMINATE WITHOUT MESSAGE    */ 00486000
*                                                                  0175 00487000
*                                                                  0175 00488000
         B     @RC00173                                            0175 00489000
@RF00173 CLI   COMMAND,1                                           0175 00490000
         BNE   @RF00175                                            0175 00491000
         TM    CAOPERND(COMMREG),B'10000000'                       0175 00492000
         BNZ   @RF00175                                            0175 00493000
         LA    STATUS,32                                           0176 00494000
*          ELSE DO;                  /* NOT A NULL MOVE              */ 00495000
         B     @RC00175                                            0177 00496000
@RF00175 DS    0H                                                  0178 00497000
*            UTPARMP = ADDR(READFRST); /* WANT TO READ FIRST REC     */ 00498000
         LA    UTPARMP,READFRST                                    0178 00499000
*            CALL READ;              /* READ THE FIRST RECORD        */ 00500000
*                                                                  0179 00501000
         BAL   @14,READ                                            0179 00502000
*            FIRSTREC = THEKEY;      /* SAVE KEY OF FIRST RECORD     */ 00503000
*                                                                  0180 00504000
         L     @08,THEKEY(,COMMREG)                                0180 00505000
         ST    @08,FIRSTREC                                        0180 00506000
*            IF STATUS = NORECORD    /* IF NO REC FOUND FOR FIRST REC*/ 00507000
*              THEN STATUS = MSG52501; /* THEN WE HAVE  EMPTY DATASET*/ 00508000
         C     STATUS,@CF00055                                     0181 00509000
         BNE   @RF00181                                            0181 00510000
         LH    STATUS,MSG52501                                     0182 00511000
*            END;                                                  0183 00512000
*                                                                  0183 00513000
@RF00181 DS    0H                                                  0184 00514000
*    RESPECIFY (GPR14P) RSTD;                                      0184 00515000
@RC00175 DS    0H                                                  0184 00516000
@RC00173 DS    0H                                                  0185 00517000
*    GPR14P = CHECK14;               /* RESTORE REG 14               */ 00518000
         L     GPR14P,CHECK14                                      0185 00519000
*    RESPECIFY (GPR14P) UNRSTD;                                    0186 00520000
*                                                                  0186 00521000
*END CHECK;                                                        0187 00522000
@EL00004 DS    0H                                                  0187 00523000
@EF00004 DS    0H                                                  0187 00524000
@ER00004 BR    @14                                                 0187 00525000
*/********************************************************************/ 00526000
*/*                                                                  */ 00527000
*/*SEGMENT-                                                          */ 00528000
*/*          OPERANDS                                                */ 00529000
*/*                                                                  */ 00530000
*/*FUNCTION-                                                         */ 00531000
*/*          TO SET THE VALUES REQUIRED TO DO THE MOVE/COPY          */ 00532000
*/*                                                                  */ 00533000
*/*OPERATION-                                                        */ 00534000
*/*          DEFAULT VALUES WERE SET IN INIT                         */ 00535000
*/*                                                                  */ 00536000
*/*      PARSE-                                                      */ 00537000
*/*          IF THERE ARE OPERANDS THEN INVOKE PARSE TO PARSE THE    */ 00538000
*/*          SUBCOMMAND                                              */ 00539000
*/*                                                                  */ 00540000
*/*      SETTYPE-                                                    */ 00541000
*/*          DO WE HAVE A STRING AND COUNT TYPE OR A LINE NUMBER     */ 00542000
*/*          TYPE OF MOVE COPY                                       */ 00543000
*/*                                                                  */ 00544000
*/*      SETFIRST-                                                   */ 00545000
*/*          DETERMINE THE KEY OF THE FIRST RECORD TO BE MOVE/COPIED */ 00546000
*/*                                                                  */ 00547000
*/*      SETLAST-                                                    */ 00548000
*/*          DETERMINE THE KEY OF THE LAST RECORD TO BE MOVE/COPIED  */ 00549000
*/*                                                                  */ 00550000
*/*      SETNEW-                                                     */ 00551000
*/*          DETERMINE THE NEW KEY OF THE FIRST RECORD THAT IS TO    */ 00552000
*/*          BE MOVE/COPIED                                          */ 00553000
*/*                                                                  */ 00554000
*/*ERRORS-                                                           */ 00555000
*/*          TERMNOER---TERMINATE W/O ERR MSG WHEN ATTN IS ISSUED    */ 00556000
*/*                                                                  */ 00557000
*/********************************************************************/ 00558000
*OPERANDS:                                                         0188 00559000
*        PROC OPTIONS(NOSAVE);                                     0188 00560000
*                                                                  0188 00561000
OPERANDS DS    0H                                                  0189 00562000
*    RESPECIFY (GPR14P) RSTD;                                      0189 00563000
*    OPERAN14=GPR14P;               /* SAVE REGISTER 14              */ 00564000
         ST    GPR14P,OPERAN14                                     0190 00565000
*    RESPECIFY (GPR14P) UNRSTD;                                    0191 00566000
*    IF CAOPERND = YES              /* ARE THERE OPERANDS TO PARSE   */ 00567000
*      THEN                         /*   YES - WE HAVE OPERANDS      */ 00568000
         TM    CAOPERND(COMMREG),B'10000000'                       0192 00569000
         BNO   @RF00192                                            0192 00570000
*        CALL PARSE;                /* PARSE THE OPERANDS            */ 00571000
*                                                                  0193 00572000
         BAL   @14,PARSE                                           0193 00573000
*    IF STATUS = CONTINUE &         /* IF PARSE EXECUTED OK          */ 00574000
*       CAATTNIS = YES              /* AND ATTENTION WAS HIT         */ 00575000
*      THEN STATUS = TERMNOER;      /* TERMINATE WITHOUT MESSAGE     */ 00576000
*                                                                  0194 00577000
@RF00192 LTR   STATUS,STATUS                                       0194 00578000
         BNZ   @RF00194                                            0194 00579000
         TM    CAATTNIS(COMMREG),B'01000000'                       0194 00580000
         BNO   @RF00194                                            0194 00581000
         LA    STATUS,32                                           0195 00582000
*    IF STATUS = CONTINUE           /* CAN WE CONTINUE FROM PARSE    */ 00583000
*      THEN DO;                     /* GET VALUES FROM OPERANDS      */ 00584000
@RF00194 LTR   STATUS,STATUS                                       0196 00585000
         BNZ   @RF00196                                            0196 00586000
*        CALL SETTYPE;              /* STRING OR LINENUM MOVE/COPY   */ 00587000
*                                                                  0198 00588000
*                                                                  0198 00589000
         BAL   @14,SETTYPE                                         0198 00590000
*        IF STATUS = CONTINUE       /* CAN WE CONTINUE FROM SETTYPE  */ 00591000
*          THEN DO;                 /* YES - GET FIRST, LAST AND NEW*/  00592000
         LTR   STATUS,STATUS                                       0199 00593000
         BNZ   @RF00199                                            0199 00594000
*            CALL SETFIRST;         /* GET VALUE FOR FIRST           */ 00595000
*                                                                  0201 00596000
*                                                                  0201 00597000
         BAL   @14,SETFIRST                                        0201 00598000
*            IF STATUS = CONTINUE   /* CAN WE CONTINUE FROM SETFIRST */ 00599000
*              THEN DO;             /* YES - GET LAST AND NEW        */ 00600000
         LTR   STATUS,STATUS                                       0202 00601000
         BNZ   @RF00202                                            0202 00602000
*                CALL SETLAST;      /* GET VALUE FOR LAST            */ 00603000
*                                                                  0204 00604000
*                                                                  0204 00605000
         BAL   @14,SETLAST                                         0204 00606000
*                IF STATUS = CONTINUE  /* CAN WE CONTINUE            */ 00607000
*                  THEN             /* YES - WE CAN GET NEW          */ 00608000
         LTR   STATUS,STATUS                                       0205 00609000
         BNZ   @RF00205                                            0205 00610000
*                    CALL SETNEW;   /* GET VALUE FOR NEW             */ 00611000
         BAL   @14,SETNEW                                          0206 00612000
*                END;                                              0207 00613000
@RF00205 DS    0H                                                  0208 00614000
*            END;                                                  0208 00615000
@RF00202 DS    0H                                                  0209 00616000
*        END;                                                      0209 00617000
*                                                                  0209 00618000
@RF00199 DS    0H                                                  0210 00619000
*   RESPECIFY GPR14P RSTD;                                         0210 00620000
@RF00196 DS    0H                                                  0211 00621000
*   GPR14P=OPERAN14;                                               0211 00622000
         L     GPR14P,OPERAN14                                     0211 00623000
*   RESPECIFY (GPR14P) UNRSTD;                                     0212 00624000
*                                                                  0212 00625000
*END OPERANDS;                                                     0213 00626000
@EL00005 DS    0H                                                  0213 00627000
@EF00005 DS    0H                                                  0213 00628000
@ER00005 BR    @14                                                 0213 00629000
*/********************************************************************/ 00630000
*/*                                                                  */ 00631000
*/*SEGMENT-                                                          */ 00632000
*/*          PARSE                                                   */ 00633000
*/*                                                                  */ 00634000
*/*FUNCTION-                                                         */ 00635000
*/*          INVOKE PARSE TO SYNTAX CHECK THE OPERANDS               */ 00636000
*/*                                                                  */ 00637000
*/*OPERATION-                                                        */ 00638000
*/*          SET UP THE PARSE PARAMETERS,INCLUDING THE VALIDITY      */ 00639000
*/*          CHECK EXIT AND THEN USE CALLTSSR TO INVOKE PARSE.       */ 00640000
*/*                                                                  */ 00641000
*/*          IF ONLY TWO OPERANDS WERE ENTERED THEN THERE IS NO      */ 00642000
*/*          THIRD PCE.IN THE 2-OPERAND CASE WE COPY PCE-2 TO PCE-3  */ 00643000
*/*          AND THEN INDICATE THAT PCE-2 IS NOT PRESENT,I.E.NO      */ 00644000
*/*          SECOND OPERAND BUT A THIRD OPERAND IS PRESENT.          */ 00645000
*/*                                                                  */ 00646000
*/*ERRORS-                                                           */ 00647000
*/*          LINESTRG---BOTH LINE AND STRING VALUES WERE ENTERED     */ 00648000
*/*          TERMNOER---RC=4=NOPROMPT,TERMINATE WITHOUT ERR MSG      */ 00649000
*/*          PARSERR---RC>4 FROM PARSE.                              */ 00650000
*/*                                                                  */ 00651000
*/********************************************************************/ 00652000
*PARSE:                                                            0214 00653000
*        PROC OPTIONS(NOSAVE);                                     0214 00654000
*                                                                  0214 00655000
PARSE    DS    0H                                                  0215 00656000
*    RESPECIFY (GPR14P) RSTD;                                      0215 00657000
*    PARSE14 = GPR14P;               /* SAVE REG 14                  */ 00658000
         LR    PARSE14,GPR14P                                      0216 00659000
*    RESPECIFY (GPR14P) UNRSTD;                                    0217 00660000
*                                                                  0217 00661000
*    PPLPTR=ADDR(CATMPLST);         /* INITIALIZE PARSE PARMS        */ 00662000
         LA    PPLPTR,CATMPLST(,COMMREG)                           0218 00663000
*    PPLPCL=ADDR(IKJEBE1);          /* ADDR OF MACRO CREATED PCL     */ 00664000
         L     @06,@CV01317                                        0219 00665000
         ST    @06,PPLPCL(,PPLPTR)                                 0219 00666000
*    PPLANS=ADDR(CAPTPRSD);         /* PTR TO PTR OF PARSE RETURN PDL*/ 00667000
         LA    @06,CAPTPRSD(,COMMREG)                              0220 00668000
         ST    @06,PPLANS(,PPLPTR)                                 0220 00669000
*    PPLCBUF=CAPTIBFR;              /* PTR TO INPUT BUFFER           */ 00670000
         L     @06,CAPTIBFR(,COMMREG)                              0221 00671000
         ST    @06,PPLCBUF(,PPLPTR)                                0221 00672000
*    PPLUWA=ADDR(VALPARMS);         /* ADDR OF VALIDITY CK EXIT      */ 00673000
*                                                                  0222 00674000
         LA    @06,VALPARMS                                        0222 00675000
         ST    @06,PPLUWA(,PPLPTR)                                 0222 00676000
*    RESPECIFY (GPR02P,GPR12P) RSTD;                               0223 00677000
*    STM(GPR02P,GPR12P,VALPARMS);   /* SAVE REGS FOR INCRCK          */ 00678000
         STM   GPR02P,GPR12P,VALPARMS                              0224 00679000
*    RESPECIFY (GPR02P,GPR12P) UNRSTD;                             0225 00680000
*                                                                  0225 00681000
*    RESPECIFY (GPR15P) RSTD;                                      0226 00682000
*    DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                         0227 00683000
*      RESPECIFY GPR01P RSTD;                                      0228 00684000
*      GPR01P = ADDR(PPL);                                         0229 00685000
         LR    GPR01P,PPLPTR                                       0229 00686000
*      IF CVTPARS = 0                                              0230 00687000
*        THEN                                                      0230 00688000
         L     @14,CVTPTR                                          0230 00689000
         L     @14,CVTPARS(,@14)                                   0230 00690000
         LTR   @14,@14                                             0230 00691000
         BNZ   @RF00230                                            0230 00692000
*          GEN(LINK EP=IKJPARS);                                   0231 00693000
         LINK EP=IKJPARS                                                00694000
*        ELSE                                                      0232 00695000
*          CALL CVTPARS;                                           0232 00696000
         B     @RC00230                                            0232 00697000
@RF00230 L     @06,CVTPTR                                          0232 00698000
         L     @15,CVTPARS(,@06)                                   0232 00699000
         BALR  @14,@15                                             0232 00700000
*      RESPECIFY GPR01P UNRSTD;                                    0233 00701000
@RC00230 DS    0H                                                  0234 00702000
*    END;                                                          0234 00703000
*    STATUS = GPR15P;                /* SAVE PARSE EXECUTION STATUS  */ 00704000
         LR    STATUS,GPR15P                                       0235 00705000
*    RESPECIFY (GPR15P) UNRSTD;                                    0236 00706000
*                                                                  0236 00707000
*    IF STATUS = CONTINUE            /* PARSE FINISH OK              */ 00708000
*      THEN DO;                      /*   YES- PARSE FINISHED OK     */ 00709000
         LTR   STATUS,STATUS                                       0237 00710000
         BNZ   @RF00237                                            0237 00711000
*        PDLPTR = CAPTPRSD;          /* GET ADDR OF PDL              */ 00712000
         L     PDLPTR,CAPTPRSD(,COMMREG)                           0239 00713000
*        GEN REFS(PDLPTR) (USING IKJPRMD1,PDLPTR); /* PDL ADDRESSING */ 00714000
         USING IKJPRMD1,PDLPTR                                          00715000
*        IF FIRSTLF = YES &          /* LINE MOVE/COPY ...           */ 00716000
*           FIRSTSF = YES            /* ... AND STRING MOVE/COPY     */ 00717000
*          THEN STATUS = LINESTRG;   /* LINE & STRING MOVE/COPY      */ 00718000
         TM    FIRSTLF,B'10000000'                                 0241 00719000
         BNO   @RF00241                                            0241 00720000
         TM    FIRSTSF,B'10000000'                                 0241 00721000
         BNO   @RF00241                                            0241 00722000
         L     STATUS,LINESTRG                                     0242 00723000
*          ELSE                      /* EVERYTHING IS STILL OK       */ 00724000
*            IF LASTF = YES &        /* LAST VALUE ENTERED ...       */ 00725000
*               NEWF = NO           /* ... NO NEW VALUE ENTERED    */   00726000
*              THEN DO;              /*   YES - BOTH NOT ENTERED     */ 00727000
         B     @RC00241                                            0243 00728000
@RF00241 TM    LASTF,B'10000000'                                   0243 00729000
         BNO   @RF00243                                            0243 00730000
         TM    NEWF,B'10000000'                                    0243 00731000
         BNZ   @RF00243                                            0243 00732000
*                NEW = LAST;        /* NEW BECOMES LAST            */   00733000
         MVC   NEW(8),LAST                                         0245 00734000
*                LASTF = NO;         /* FORCE DEFAULT FOR LAST       */ 00735000
         NI    LASTF,B'01111111'                                   0246 00736000
*                END;                                              0247 00737000
*        END;                                                      0248 00738000
*      ELSE                          /* NON ZERO CODE FROM PARSE     */ 00739000
*        IF STATUS = NOPROMPT        /* TERM IN NO PROMPT MODE       */ 00740000
*          THEN STATUS = TERMNOER;   /* TERMINATE WITHOUT ERR MSGS   */ 00741000
         B     @RC00237                                            0249 00742000
@RF00237 C     STATUS,@CF00055                                     0249 00743000
         BNE   @RF00249                                            0249 00744000
         LA    STATUS,32                                           0250 00745000
*          ELSE PARSERR = YES;       /* INDICATE A PARSE ERROR       */ 00746000
*                                                                  0251 00747000
         B     @RC00249                                            0251 00748000
@RF00249 OI    PARSERR,B'01000000'                                 0251 00749000
*    RESPECIFY (GPR14P) RSTD;                                      0252 00750000
@RC00249 DS    0H                                                  0252 00751000
@RC00237 DS    0H                                                  0253 00752000
*    GPR14P = PARSE14;               /* RESTORE REG 14               */ 00753000
         LR    GPR14P,PARSE14                                      0253 00754000
*    RESPECIFY (GPR01P,GPR14P) UNRSTD;                             0254 00755000
*                                                                  0254 00756000
*END PARSE;                                                        0255 00757000
@EL00006 DS    0H                                                  0255 00758000
@EF00006 DS    0H                                                  0255 00759000
@ER00006 BR    @14                                                 0255 00760000
*/********************************************************************/ 00761000
*/*                                                                  */ 00762000
*/*SEGMENT-                                                          */ 00763000
*/*          SETTYPE                                                 */ 00764000
*/*                                                                  */ 00765000
*/*FUNCTION-                                                         */ 00766000
*/*          DETERMINE WETHER WE HAVE A STRING OR LINENUM MOVE/COPY  */ 00767000
*/*                                                                  */ 00768000
*/*OPERATION-                                                        */ 00769000
*/*      TYPE=STRING-                                                */ 00770000
*/*          COPY WITH NO OPERANDS                                   */ 00771000
*/*          FIRST OPERAND=ASTERISK                                  */ 00772000
*/*          FIRST OPERAND=A STRING                                  */ 00773000
*/*                                                                  */ 00774000
*/*      TYPE=LINENUM-                                               */ 00775000
*/*          WHEN THE FIRST OPERAND IS A NUMBER                      */ 00776000
*/*                                                                  */ 00777000
*/*ERRORS-                                                           */ 00778000
*/*          MSG52502--LINE NUMBER MOVE/COPY WITH NONUM DATA SET     */ 00779000
*/*                                                                  */ 00780000
*/********************************************************************/ 00781000
*                                                                  0256 00782000
*SETTYPE:                                                          0256 00783000
*        PROC OPTIONS(NOSAVE);                                     0256 00784000
*                                                                  0256 00785000
SETTYPE  DS    0H                                                  0257 00786000
*    RESPECIFY (GPR14P) RSTD;                                      0257 00787000
*    SETTYP14 = GPR14P;              /* SAVE REG 14                  */ 00788000
         LR    SETTYP14,GPR14P                                     0258 00789000
*    RESPECIFY (GPR14P) UNRSTD;                                    0259 00790000
*                                                                  0259 00791000
*    STATUS = CONTINUE;              /* TENTATIVE CONTINUE STATUS    */ 00792000
*                                                                  0260 00793000
         SLR   STATUS,STATUS                                       0260 00794000
*    IF CAOPERND = NO |              /* COPY WITH NO OPERANDS        */ 00795000
*                                                                  0261 00796000
*      (CAOPERND = YES &             /* DOES OPERANDS EXIST          */ 00797000
*       FIRSTLF = YES &              /* IS FIRST A LINE              */ 00798000
*       FIRSTVAL(1) = STAR) |        /* IS VALUE FOR LINE A STAR     */ 00799000
*                                                                  0261 00800000
*       FIRSTSF = YES                /* IS STRING ENTERED FOR 1ST OP */ 00801000
*                                                                  0261 00802000
*      THEN                          /*   YES - STRING MOVE/COPY     */ 00803000
         TM    CAOPERND(COMMREG),B'10000000'                       0261 00804000
         BZ    @RT00261                                            0261 00805000
         TM    CAOPERND(COMMREG),B'10000000'                       0261 00806000
         BNO   @GL00008                                            0261 00807000
         TM    FIRSTLF,B'10000000'                                 0261 00808000
         BNO   @GL00008                                            0261 00809000
         L     @08,FIRSTLP                                         0261 00810000
         CLI   FIRSTVAL(@08),C'*'                                  0261 00811000
         BE    @RT00261                                            0261 00812000
@GL00008 TM    FIRSTSF,B'10000000'                                 0261 00813000
         BNO   @RF00261                                            0261 00814000
@RT00261 DS    0H                                                  0262 00815000
*        TYPE = STRING;              /* THEN TYPE IS STRING          */ 00816000
*                                                                  0262 00817000
         MVI   TYPE,X'03'                                          0262 00818000
*      ELSE                          /* NOT A STRING, MUST BE LINE   */ 00819000
*        IF CANONUM = YES            /* IS IT A NONUM TYPE DATA SET  */ 00820000
*          THEN                      /*   YES - LINENUM WITH NONUM   */ 00821000
         B     @RC00261                                            0263 00822000
@RF00261 TM    CANONUM(COMMREG),B'00000001'                        0263 00823000
         BNO   @RF00263                                            0263 00824000
*            STATUS = MSG52502;      /* INDICATE ERROR IN STATUS     */ 00825000
*                                                                  0264 00826000
         LH    STATUS,MSG52502                                     0264 00827000
*          ELSE                      /* WE HAVE A LINENUM MOVE/COPY  */ 00828000
*            TYPE = LINENUM;         /* SET THE TYPE TO LINENUM      */ 00829000
*                                                                  0265 00830000
         B     @RC00263                                            0265 00831000
@RF00263 MVI   TYPE,X'04'                                          0265 00832000
*    RESPECIFY (GPR14P) RSTD;                                      0266 00833000
@RC00263 DS    0H                                                  0266 00834000
@RC00261 DS    0H                                                  0267 00835000
*    GPR14P = SETTYP14;              /* RESTORE REG 14               */ 00836000
         LR    GPR14P,SETTYP14                                     0267 00837000
*    RESPECIFY (GPR14P) UNRSTD;                                    0268 00838000
*                                                                  0268 00839000
*END SETTYPE;                                                      0269 00840000
@EL00007 DS    0H                                                  0269 00841000
@EF00007 DS    0H                                                  0269 00842000
@ER00007 BR    @14                                                 0269 00843000
*/********************************************************************/ 00844000
*/*                                                                  */ 00845000
*/*SEGMENT-                                                          */ 00846000
*/*          SETFIRST                                                */ 00847000
*/*                                                                  */ 00848000
*/*FUNCTION-                                                         */ 00849000
*/*          GET VALUE FOR THE FIRST LINE TO BE MOVE/COPIED          */ 00850000
*/*                                                                  */ 00851000
*/*OPERATION-                                                        */ 00852000
*/*      NO FIRST OPERAND-                                           */ 00853000
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */ 00854000
*/*                                                                  */ 00855000
*/*      STRING ENTERED-                                             */ 00856000
*/*          CALL IKJEBESE TO FIND THE STRING                        */ 00857000
*/*                                                                  */ 00858000
*/*      ASTERISK ENTERED-                                           */ 00859000
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */ 00860000
*/*                                                                  */ 00861000
*/*      NUMBER ENTERED-                                             */ 00862000
*/*          USE THE NUMBER ENTERED AS THE FIRST OPERAND             */ 00863000
*/*                                                                  */ 00864000
*/*          THE LINE ENTERED DOES NOT HAVE TO EXIST,IF IT DOES NOT  */ 00865000
*/*          EXIST THEN USE THE NEXT GREATER KEY THAT DOES EXIST AS  */ 00866000
*/*          THE FIRST LINE TO BE MOVED OR COPIED.                   */ 00867000
*/*                                                                  */ 00868000
*/*NOTES-                                                            */ 00869000
*/*          DEFAULT IS SET IN INIT                                  */ 00870000
*/*                                                                  */ 00871000
*/*ERRORS-                                                           */ 00872000
*/*          NOFIRST---NO RECORDS WITH KEY>=FIRSTKEY.                */ 00873000
*/*          EUTERR---I/O ERROR INDICATIONS FROM IKJEBEUT.           */ 00874000
*/*                                                                  */ 00875000
*/********************************************************************/ 00876000
*SETFIRST:                                                         0270 00877000
*        PROC OPTIONS(NOSAVE);                                     0270 00878000
*                                                                  0270 00879000
SETFIRST DS    0H                                                  0271 00880000
*   RESPECIFY (GPR14P) RSTD;                                       0271 00881000
*   SETFIR14 = GPR14P;               /* SAVE REG 14                  */ 00882000
         ST    GPR14P,SETFIR14                                     0272 00883000
*   RESPECIFY (GPR14P) UNRSTD;                                     0273 00884000
*                                                                  0273 00885000
*   STATUS = CONTINUE;               /* INDICATE TENTATIVE CONTINUE  */ 00886000
*                                                                  0274 00887000
         SLR   STATUS,STATUS                                       0274 00888000
*   IF CAOPERND = YES                /* ARE THERE OPERANDS           */ 00889000
*     THEN                           /* YES: COULD BE LINE OR STRING */ 00890000
         TM    CAOPERND(COMMREG),B'10000000'                       0275 00891000
         BNO   @RF00275                                            0275 00892000
*     IF FIRSTSF = YES               /* AND IS IT A STRING           */ 00893000
*       THEN CALL IKJEBESE;          /* GET LINE NUMBER FROM EBESE   */ 00894000
*                                                                  0276 00895000
         TM    FIRSTSF,B'10000000'                                 0276 00896000
         BNO   @RF00276                                            0276 00897000
         BAL   @14,IKJEBESE                                        0277 00898000
*       ELSE                         /* NO STRING ENTERED            */ 00899000
*         IF FIRSTLF = YES &         /* IS THE FIRST ENTERED         */ 00900000
*            FIRSTVAL(1) ^= STAR     /* AND VALUE IS A NUMBER        */ 00901000
*           THEN DO;                 /* USE NUMBER ENTERED           */ 00902000
         B     @RC00276                                            0278 00903000
@RF00276 TM    FIRSTLF,B'10000000'                                 0278 00904000
         BNO   @RF00278                                            0278 00905000
         L     @08,FIRSTLP                                         0278 00906000
         CLI   FIRSTVAL(@08),C'*'                                  0278 00907000
         BE    @RF00278                                            0278 00908000
*             PACKAREA = FOXZERO;    /* ZERO OUT THE FIELD           */ 00909000
         MVC   PACKAREA(8),FOXZERO                                 0280 00910000
*             PACKAREA(9-FIRSTLL:8) =  /* MOVE INTO THE RIGHT SIDE...*/ 00911000
*                 FIRSTVAL;          /* ...THE VALUE ENTERED         */ 00912000
         LA    @03,9                                               0281 00913000
         SH    @03,FIRSTLL                                         0281 00914000
         LA    @01,PACKAREA-1(@03)                                 0281 00915000
         LCR   @03,@03                                             0281 00916000
         AL    @03,@CF00061                                        0281 00917000
         EX    @03,@SM01522                                        0281 00918000
*             PACK(PACKAREA,PACKAREA); /* CONVERT: ZONED TO PACKED   */ 00919000
         PACK  PACKAREA(8),PACKAREA(8)                             0282 00920000
*             CVB(FIRSTKEY,PACKAREA);  /* CONVERT: PACKED TO BINARY  */ 00921000
         CVB   @08,PACKAREA                                        0283 00922000
         ST    @08,FIRSTKEY                                        0283 00923000
*             END;                                                 0284 00924000
*                                                                  0284 00925000
*    ORIGFRST = FIRSTKEY;            /* ORIGINAL VALUE AS ENTERED    */ 00926000
*                                                                  0285 00927000
@RF00278 DS    0H                                                  0285 00928000
@RC00276 DS    0H                                                  0285 00929000
@RF00275 L     @08,FIRSTKEY                                        0285 00930000
         ST    @08,ORIGFRST                                        0285 00931000
*    IF CAOPERND = NO |              /* IF NO OPERANDS WERE ENTERED  */ 00932000
*       FIRSTSF = NO                 /* OR IF NO STRING WERE ENTERED */ 00933000
*      THEN DO;                      /* SEE IF LINE EXISTS           */ 00934000
         TM    CAOPERND(COMMREG),B'10000000'                       0286 00935000
         BZ    @RT00286                                            0286 00936000
         TM    FIRSTSF,B'10000000'                                 0286 00937000
         BNZ   @RF00286                                            0286 00938000
@RT00286 DS    0H                                                  0287 00939000
*        UTPARMP = ADDR(READPARM);   /* PARMS TO READ A KEY          */ 00940000
         LA    UTPARMP,READPARM                                    0288 00941000
*        THEKEY = FIRSTKEY;          /* WANT TO READ KEY = FIRSTKEY  */ 00942000
         L     @08,FIRSTKEY                                        0289 00943000
         ST    @08,THEKEY(,COMMREG)                                0289 00944000
*        CALL READ;                  /* SEE IF THE RECORD EXISTS     */ 00945000
*                                                                  0290 00946000
         BAL   @14,READ                                            0290 00947000
*        IF STATUS = NORECORD        /* IF RECORD NOT FOUND          */ 00948000
*          THEN DO;                  /* TRY READING THE NEXT ONE     */ 00949000
         C     STATUS,@CF00055                                     0291 00950000
         BNE   @RF00291                                            0291 00951000
*            STATUS = CONTINUE;      /* RESET STATUS SO WE CAN GO ON */ 00952000
         SLR   STATUS,STATUS                                       0293 00953000
*            UTPARMP = ADDR(READNEXT); /* PARMS TO READ NEXT RECORD  */ 00954000
         LA    UTPARMP,READNEXT                                    0294 00955000
*            CALL READ;              /* READ NEXT RECORD             */ 00956000
*                                                                  0295 00957000
         BAL   @14,READ                                            0295 00958000
*            IF STATUS = CONTINUE    /* DID WE GET NEXT RECORD       */ 00959000
*              THEN FIRSTKEY = THEKEY; /* THEKEY = KEY OF NEXT REC   */ 00960000
         LTR   STATUS,STATUS                                       0296 00961000
         BNZ   @RF00296                                            0296 00962000
         L     @08,THEKEY(,COMMREG)                                0297 00963000
         ST    @08,FIRSTKEY                                        0297 00964000
*              ELSE                  /* CHECK FOR NO RECORD FOUND    */ 00965000
*                IF STATUS = NORECORD /* IF NO RECORD FOUND          */ 00966000
*                  THEN STATUS = NOFIRST; /* NO-FIRST-RECORD ERROR   */ 00967000
         B     @RC00296                                            0298 00968000
@RF00296 C     STATUS,@CF00055                                     0298 00969000
         BNE   @RF00298                                            0298 00970000
         L     STATUS,NOFIRST                                      0299 00971000
*            END;                                                  0300 00972000
@RF00298 DS    0H                                                  0300 00973000
@RC00296 DS    0H                                                  0301 00974000
*       END;                                                       0301 00975000
@RF00291 DS    0H                                                  0302 00976000
*   RESPECIFY GPR14P RSTD;                                         0302 00977000
@RF00286 DS    0H                                                  0303 00978000
*   GPR14P = SETFIR14;               /* RESTORE REG 14               */ 00979000
         L     GPR14P,SETFIR14                                     0303 00980000
*   RESPECIFY (GPR14P) UNRSTD;                                     0304 00981000
*                                                                  0304 00982000
*END SETFIRST;                                                     0305 00983000
@EL00008 DS    0H                                                  0305 00984000
@EF00008 DS    0H                                                  0305 00985000
@ER00008 BR    @14                                                 0305 00986000
*/********************************************************************/ 00987000
*/*                                                                  */ 00988000
*/*SEGMENT-                                                          */ 00989000
*/*          SETLAST                                                 */ 00990000
*/*                                                                  */ 00991000
*/*FUNCTION-                                                         */ 00992000
*/*          GET VALUE FOR THE LAST LINE TO BE MOVE/COPIED           */ 00993000
*/*                                                                  */ 00994000
*/*OPERATION-                                                        */ 00995000
*/*      NO SECOND OPERAND-                                          */ 00996000
*/*          STRING TYPE---USE VALUE OF 1                            */ 00997000
*/*          LINENUM TYPE---USE VALUE OF FIRSTKEY                    */ 00998000
*/*                                                                  */ 00999000
*/*      STRING TYPE-                                                */ 01000000
*/*          SECOND OPERAND IS A COUNT OF N RECORDS TO BE            */ 01001000
*/*          MOVE/COPIED.USE THE KEY OF THE NTH RECORD               */ 01002000
*/*                                                                  */ 01003000
*/*      LINENUM TYPE-                                               */ 01004000
*/*          USE THE NUMBER ENTERED AS THE SECOND OPERAND            */ 01005000
*/*                                                                  */ 01006000
*/*ERRORS-                                                           */ 01007000
*/*          BADLAST---ASTERISK IS NOT ALLOWED                       */ 01008000
*/*          BADLAST---0 WITH A STRING MOVE/COPY IS NOT ALLOWED      */ 01009000
*/*                                                                  */ 01010000
*/********************************************************************/ 01011000
*SETLAST:                                                          0306 01012000
*        PROC OPTIONS(NOSAVE);                                     0306 01013000
*                                                                  0306 01014000
SETLAST  DS    0H                                                  0307 01015000
*    RESPECIFY (GPR14P) RSTD;                                      0307 01016000
*    SETLAS14 = GPR14P;              /* SAVE REG 14                  */ 01017000
         ST    GPR14P,SETLAS14                                     0308 01018000
*    RESPECIFY (GPR14P) UNRSTD;                                    0309 01019000
*                                                                  0309 01020000
*    IF TYPE = STRING               /* IF THIS IS A STRING MOVE/COPY */ 01021000
*      THEN LASTKEY = ONE;          /* THEN DEFAULT COUNT IS ONE     */ 01022000
         CLI   TYPE,3                                              0310 01023000
         BNE   @RF00310                                            0310 01024000
         MVC   LASTKEY(4),@CF00063                                 0311 01025000
*      ELSE LASTKEY = FIRSTKEY;     /* DEFAULT FOR LAST LINE MOVED   */ 01026000
*                                                                  0312 01027000
         B     @RC00310                                            0312 01028000
@RF00310 L     @08,FIRSTKEY                                        0312 01029000
         ST    @08,LASTKEY                                         0312 01030000
*    IF CAOPERND = YES &             /* ARE THERE OPERANDS           */ 01031000
*       LASTF = YES                  /* AND WAS THE LAST ONE ENTERED */ 01032000
*      THEN                          /*   YES - HAVE VALUE FOR LAST  */ 01033000
@RC00310 TM    CAOPERND(COMMREG),B'10000000'                       0313 01034000
         BNO   @RF00313                                            0313 01035000
         TM    LASTF,B'10000000'                                   0313 01036000
         BNO   @RF00313                                            0313 01037000
*        IF LASTVAL(1) ^= STAR       /* IF VALUE IS A NUMBER         */ 01038000
*          THEN DO;                  /* USE NUMBER ENTERED           */ 01039000
         L     @08,LASTP                                           0314 01040000
         CLI   LASTVAL(@08),C'*'                                   0314 01041000
         BE    @RF00314                                            0314 01042000
*            PACKAREA = FOXZERO;     /* ZERO OUT THE FIELD           */ 01043000
         MVC   PACKAREA(8),FOXZERO                                 0316 01044000
*            PACKAREA(9-LASTL:8) =   /* MOVE   INTO THE RIGHT SIDE...*/ 01045000
*                LASTVAL;            /* ...THE VALUE ENTERED         */ 01046000
         LA    @03,9                                               0317 01047000
         SH    @03,LASTL                                           0317 01048000
         LA    @01,PACKAREA-1(@03)                                 0317 01049000
         LCR   @03,@03                                             0317 01050000
         AL    @03,@CF00061                                        0317 01051000
         EX    @03,@SM01524                                        0317 01052000
*            PACK(PACKAREA,PACKAREA); /* CONVERT: ZONED TO PACKED    */ 01053000
         PACK  PACKAREA(8),PACKAREA(8)                             0318 01054000
*            CVB(LASTKEY,PACKAREA);    /* CONVERT: PACKED TO BINARY  */ 01055000
         CVB   @08,PACKAREA                                        0319 01056000
         ST    @08,LASTKEY                                         0319 01057000
*            END;                                                  0320 01058000
*                                                                  0320 01059000
*          ELSE                      /* THE VALUE IS AN ASTERISK     */ 01060000
*            STATUS = BADLAST2;      /* INDICATE AN ERROR            */ 01061000
*                                                                  0321 01062000
         B     @RC00314                                            0321 01063000
@RF00314 L     STATUS,BADLAST2                                     0321 01064000
*    IF TYPE = STRING                /* IF STRING MOVE/COPY          */ 01065000
*      THEN                          /*   YES - LASTKEY = A COUNT    */ 01066000
@RC00314 DS    0H                                                  0322 01067000
@RF00313 CLI   TYPE,3                                              0322 01068000
         BNE   @RF00322                                            0322 01069000
*        IF LASTKEY > ONE            /* IS COUNT GREATER THAN ONE    */ 01070000
*          THEN DO;                  /*   YES - GET KEY OF NTH LINE  */ 01071000
         L     @08,LASTKEY                                         0323 01072000
         C     @08,@CF00063                                        0323 01073000
         BNH   @RF00323                                            0323 01074000
*            COUNT = LASTKEY;        /* SET COUNT FOR RELINENM       */ 01075000
         ST    @08,COUNT                                           0325 01076000
*            THECOUNT = LASTKEY;     /* SAVE COUNT FOR NEWUTIL       */ 01077000
         ST    @08,THECOUNT                                        0326 01078000
*            THEKEY = FIRSTKEY;      /* START FROM KEY = FIRSTKEY    */ 01079000
*                                                                  0327 01080000
         L     @08,FIRSTKEY                                        0327 01081000
         ST    @08,THEKEY(,COMMREG)                                0327 01082000
*            CALL RELINENM;          /* FIND RELATIVE LINE NUMBER    */ 01083000
*                                                                  0328 01084000
         BAL   @14,RELINENM                                        0328 01085000
*            IF STATUS = CONTINUE    /* IF STATUS IS OK              */ 01086000
*              THEN LASTKEY = THEKEY;/* GET KEY OF NTH LINE          */ 01087000
         LTR   STATUS,STATUS                                       0329 01088000
         BNZ   @RF00329                                            0329 01089000
         L     @08,THEKEY(,COMMREG)                                0330 01090000
         ST    @08,LASTKEY                                         0330 01091000
*            END;                                                  0331 01092000
*                                                                  0331 01093000
*          ELSE                      /* VALUE IS ONE OR ZERO         */ 01094000
*            IF LASTKEY = ONE        /* RELATIVE LINE NUM OF ONE     */ 01095000
*              THEN LASTKEY = FIRSTKEY; /* MOVE/COPY ONLY ONE LINE   */ 01096000
         B     @RC00323                                            0332 01097000
@RF00323 CLC   LASTKEY(4),@CF00063                                 0332 01098000
         BNE   @RF00332                                            0332 01099000
         L     @08,FIRSTKEY                                        0333 01100000
         ST    @08,LASTKEY                                         0333 01101000
*              ELSE STATUS = BADLAST1; /* INDICATE BAD VALUE         */ 01102000
*                                                                  0334 01103000
         B     @RC00332                                            0334 01104000
@RF00332 L     STATUS,BADLAST1                                     0334 01105000
*    RESPECIFY GPR14P RSTD;                                        0335 01106000
@RC00332 DS    0H                                                  0335 01107000
@RC00323 DS    0H                                                  0335 01108000
@RF00322 DS    0H                                                  0336 01109000
*    GPR14P = SETLAS14;              /* RESTORE REG 14               */ 01110000
         L     GPR14P,SETLAS14                                     0336 01111000
*    RESPECIFY (GPR14P) UNRSTD;                                    0337 01112000
*                                                                  0337 01113000
*END SETLAST;                                                      0338 01114000
@EL00009 DS    0H                                                  0338 01115000
@EF00009 DS    0H                                                  0338 01116000
@ER00009 BR    @14                                                 0338 01117000
*/********************************************************************/ 01118000
*/*                                                                  */ 01119000
*/*SEGMENT-                                                          */ 01120000
*/*          SETNEW PART 1                                           */ 01121000
*/*                                                                  */ 01122000
*/*FUNCTION-                                                         */ 01123000
*/*          NEWKEY IS WHERE THE LINES FROM FIRSTKEY TO LASTKEY      */ 01124000
*/*          WILL BE MOVE/COPIED TO                                  */ 01125000
*/*                                                                  */ 01126000
*/*OPERATION-                                                        */ 01127000
*/*      NO THIRD OPERAND-                                           */ 01128000
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */ 01129000
*/*                                                                  */ 01130000
*/*      NUMBER ENTERED-                                             */ 01131000
*/*          FOR NONUM DS---THIRD OPERAND IS A COUNT OF N RECORDS    */ 01132000
*/*          FROM THE BEGINNING OF THE DATASET.USE THE KEY OF THE    */ 01133000
*/*          NTH RECORD.                                             */ 01134000
*/*          FOR NUM DS---US THE NUMBER ENTERED                      */ 01135000
*/*                                                                  */ 01136000
*/*      ASTERISK ENTERED-                                           */ 01137000
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */ 01138000
*/*                                                                  */ 01139000
*/*NOTES-                                                            */ 01140000
*/*          DEFAULTS ARE SET IN INIT                                */ 01141000
*/*                                                                  */ 01142000
*/*ERRORS-                                                           */ 01143000
*/*          LINERNG---THE NEW LINE IS BEWTEEN FIRST AND LAST LINES  */ 01144000
*/*          EUTERR----I/O ERRORS PASSED ON FROM IKJEBEUT            */ 01145000
*/*                                                                  */ 01146000
*/********************************************************************/ 01147000
*SETNEW:                                                           0339 01148000
*        PROC OPTIONS(NOSAVE);                                     0339 01149000
*                                                                  0339 01150000
SETNEW   DS    0H                                                  0340 01151000
*    RESPECIFY (GPR14P) RSTD;                                      0340 01152000
*    SETNEW14 = GPR14P;              /* SAVE REG 14                  */ 01153000
         ST    GPR14P,SETNEW14                                     0341 01154000
*    RESPECIFY (GPR14P) UNRSTD;                                    0342 01155000
*                                                                  0342 01156000
*    IF CAOPERND = YES   &           /* IF THERE ARE OPERANDS        */ 01157000
*       NEWF = YES                  /* AND NEW WAS ENTERED  */     0343 01158000
*      THEN                                                        0343 01159000
         TM    CAOPERND(COMMREG),B'10000000'                       0343 01160000
         BNO   @RF00343                                            0343 01161000
         TM    NEWF,B'10000000'                                    0343 01162000
         BNO   @RF00343                                            0343 01163000
*        IF NEWVAL(1) ^= STAR       /* IF ASTERISK NOT ENTERED      */  01164000
*          THEN DO;                  /* GET VALUE ENTERED            */ 01165000
         L     @08,NEWP                                            0344 01166000
         CLI   NEWVAL(@08),C'*'                                    0344 01167000
         BE    @RF00344                                            0344 01168000
*            PACKAREA = FOXZERO;     /* ZERO OUT THE FIELD           */ 01169000
         MVC   PACKAREA(8),FOXZERO                                 0346 01170000
*            PACKAREA(9-NEWL:8) =    /* MOVE   INTO THE RIGHT SIDE...*/ 01171000
*                NEWVAL;             /* ...THE VALUE ENTERED         */ 01172000
         LA    @03,9                                               0347 01173000
         SH    @03,NEWL                                            0347 01174000
         LA    @01,PACKAREA-1(@03)                                 0347 01175000
         LCR   @03,@03                                             0347 01176000
         AL    @03,@CF00061                                        0347 01177000
         EX    @03,@SM01526                                        0347 01178000
*            PACK(PACKAREA,PACKAREA); /* CONVERT: ZONED TO PACKED    */ 01179000
         PACK  PACKAREA(8),PACKAREA(8)                             0348 01180000
*            CVB(NEWKEY,PACKAREA);     /* CONVERT: PACKED TO BINARY  */ 01181000
*                                                                  0349 01182000
         CVB   NEWKEY,PACKAREA                                     0349 01183000
*            IF CANONUM = YES &      /* IF NO LINE NUMBERS FOR DS    */ 01184000
*               NEWKEY > ONE         /* AND NUMBER IS GREATER THAN 1 */ 01185000
*              THEN DO;              /* GET KEY OF NTH LINE          */ 01186000
         TM    CANONUM(COMMREG),B'00000001'                        0350 01187000
         BNO   @RF00350                                            0350 01188000
         C     NEWKEY,@CF00063                                     0350 01189000
         BNH   @RF00350                                            0350 01190000
*                COUNT = NEWKEY ;    /* N = NEWKEY                   */ 01191000
         ST    NEWKEY,COUNT                                        0352 01192000
*                THEKEY = FIRSTREC;  /* NTH LINE AFTER FIRST RECORD  */ 01193000
         L     @08,FIRSTREC                                        0353 01194000
         ST    @08,THEKEY(,COMMREG)                                0353 01195000
*                CALL RELINENM;      /* GET RELATIVE LINE NUMBER     */ 01196000
*                                                                  0354 01197000
         BAL   @14,RELINENM                                        0354 01198000
*                IF STATUS = CONTINUE /* IF THE COUNTING WENT OK */     01199000
*                  THEN NEWKEY = THEKEY;/* USE KEY OF THE NTH LINE   */ 01200000
         LTR   STATUS,STATUS                                       0355 01201000
         BNZ   @RF00355                                            0355 01202000
         L     NEWKEY,THEKEY(,COMMREG)                             0356 01203000
*                END;                                              0357 01204000
*                                                                  0357 01205000
*              ELSE                  /* VALUE IS ZERO OR ONE         */ 01206000
*                IF CANONUM = YES &  /* IF NO LINE NUMBERS FOR DS    */ 01207000
*                   NEWKEY = ONE     /* IS THE VALUE ONE             */ 01208000
*                  THEN NEWKEY = FIRSTREC; /* MOVE AFTER FIRST LINE  */ 01209000
         B     @RC00350                                            0358 01210000
@RF00350 TM    CANONUM(COMMREG),B'00000001'                        0358 01211000
         BNO   @RF00358                                            0358 01212000
         C     NEWKEY,@CF00063                                     0358 01213000
         BNE   @RF00358                                            0358 01214000
         L     NEWKEY,FIRSTREC                                     0359 01215000
*            END;                                                  0360 01216000
*                                                                  0360 01217000
*          ELSE                                                    0361 01218000
*            IF NEWKEY = ZERO  &     /* = 0 = CACURNUM               */ 01219000
*               FIRSTLF = YES &      /* AND WAS LINE NUMBER ENTERED  */ 01220000
*               FIRSTVAL(1) = STAR   /* BUT ENTERED AS ASTERISK      */ 01221000
*              THEN NEWKEY = FIRSTREC; /* MOVE/COPY AFTER FIRST REC  */ 01222000
         B     @RC00344                                            0361 01223000
@RF00344 LTR   NEWKEY,NEWKEY                                       0361 01224000
         BNZ   @RF00361                                            0361 01225000
         TM    FIRSTLF,B'10000000'                                 0361 01226000
         BNO   @RF00361                                            0361 01227000
         L     @08,FIRSTLP                                         0361 01228000
         CLI   FIRSTVAL(@08),C'*'                                  0361 01229000
         BNE   @RF00361                                            0361 01230000
         L     NEWKEY,FIRSTREC                                     0362 01231000
*              ELSE;                 /* NULL ELSE FOR THIS IF        */ 01232000
@RF00361 DS    0H                                                  0364 01233000
*      ELSE                          /* NO OPERANDS OR NO NEW KEY    */ 01234000
*        IF NEWKEY = ZERO            /* AND CACURNUM = ZERO = NEWKEY */ 01235000
*          THEN NEWKEY = FIRSTREC;   /* MOVE/COPY AFTER FIRST LINE   */ 01236000
         B     @RC00343                                            0364 01237000
@RF00343 LTR   NEWKEY,NEWKEY                                       0364 01238000
         BNZ   @RF00364                                            0364 01239000
         L     NEWKEY,FIRSTREC                                     0365 01240000
*          ELSE;                     /* JUST A NULL ELSE             */ 01241000
@RF00364 DS    0H                                                  0367 01242000
*/********************************************************************/ 01243000
*/*                                                                  */ 01244000
*/*SEGMENT-                                                          */ 01245000
*/*          SETNEW PART 2                                           */ 01246000
*/*                                                                  */ 01247000
*/*OPERATION-                                                        */ 01248000
*/*          CALL SETLIMIT TO GET A VALUE FOR THE LIMIT OF THE       */ 01249000
*/*          MOVE/COPY                                               */ 01250000
*/*                                                                  */ 01251000
*/*          IF THERE IS A RECORD WITH KEY=NEWKEY THEN THE VALUE     */ 01252000
*/*          FOR INSRTKEY IS NEWKEY AND NEWKEY IS INCREMENTED BY     */ 01253000
*/*          THEINCR.                                                */ 01254000
*/*                                                                  */ 01255000
*/*          IF THE RECORD DOES NOT EXIST THEN WE CAN USE NEWKEY AS  */ 01256000
*/*          THE KEY OF THE FIRST LINE MOVE/COPIED AND THE VALUE     */ 01257000
*/*          FOR INSRTKEY IS THE KEY OF THE RECORD PREVIOUS TO THE   */ 01258000
*/*          KEY OF NEWKEY                                           */ 01259000
*/*                                                                  */ 01260000
*/********************************************************************/ 01261000
*                                                                  0367 01262000
*    IF STATUS = CONTINUE &          /* IF NO ERRORS SO FAR          */ 01263000
*       FIRSTKEY =< NEWKEY  &        /* IS NEW BETWEEN FIRST */    0367 01264000
*       NEWKEY  < LASTKEY            /* AND LAST RECORD              */ 01265000
*      THEN STATUS = LINERNG;        /* THEN WE HAVE LINE RANGE ERROR*/ 01266000
*                                                                  0367 01267000
@RC00343 LTR   STATUS,STATUS                                       0367 01268000
         BNZ   @RF00367                                            0367 01269000
         C     NEWKEY,FIRSTKEY                                     0367 01270000
         BL    @RF00367                                            0367 01271000
         C     NEWKEY,LASTKEY                                      0367 01272000
         BNL   @RF00367                                            0367 01273000
         L     STATUS,LINERNG                                      0368 01274000
*      ELSE DO;                      /* NOT MOVING WITHIN THE RANGE  */ 01275000
         B     @RC00367                                            0369 01276000
@RF00367 DS    0H                                                  0370 01277000
*        CALL SETLIMIT;              /* SET LIMIT FOR MOVE/COPY      */ 01278000
*                                                                  0370 01279000
         BAL   @14,SETLIMIT                                        0370 01280000
*        UTPARMP = ADDR(READPARM);   /*  WANT TO READ SPECIFIC KEY   */ 01281000
         LA    UTPARMP,READPARM                                    0371 01282000
*        THEKEY = NEWKEY ;           /* THEKEY = NEWKEY              */ 01283000
         ST    NEWKEY,THEKEY(,COMMREG)                             0372 01284000
*        CALL READ;                  /* READ THE KEY                 */ 01285000
*                                                                  0373 01286000
         BAL   @14,READ                                            0373 01287000
*        IF STATUS = CONTINUE        /* IF THE RECORD EXISTS         */ 01288000
*          THEN DO;                  /* THERE IS RECORD WITH THE KEY */ 01289000
         LTR   STATUS,STATUS                                       0374 01290000
         BNZ   @RF00374                                            0374 01291000
*            INSRTKEY = NEWKEY;      /* FOR DATAEXIT, INSERT AFTER   */ 01292000
         ST    NEWKEY,INSRTKEY                                     0376 01293000
*            NEWKEY = NEWKEY + THEINCR; /* CALCULATE NEW NEWKEY      */ 01294000
         AL    NEWKEY,THEINCR                                      0377 01295000
*            END;                                                  0378 01296000
*                                                                  0378 01297000
*          ELSE                      /* MAYBE I/O ERROR OR NO RECORD */ 01298000
*            IF STATUS = NORECORD    /* IF THE RECORD DOESN'T EXIST  */ 01299000
*              THEN DO;              /* NO RECORD WITH KEY=NEWKEY    */ 01300000
         B     @RC00374                                            0379 01301000
@RF00374 C     STATUS,@CF00055                                     0379 01302000
         BNE   @RF00379                                            0379 01303000
*                STATUS = CONTINUE;  /* RESET STATUS TO CONTINUE     */ 01304000
*                                                                  0381 01305000
         SLR   STATUS,STATUS                                       0381 01306000
*                UTPARMP = ADDR(READPREV); /* WANT TO GET PREVIOUS   */ 01307000
         LA    UTPARMP,READPREV                                    0382 01308000
*                THEKEY = NEWKEY;          /* PREVIOUS TO NEWKEY     */ 01309000
         ST    NEWKEY,THEKEY(,COMMREG)                             0383 01310000
*                CALL READ;                /* GET PREVIOUS RECORD    */ 01311000
         BAL   @14,READ                                            0384 01312000
*                INSRTKEY = THEKEY;        /* FOR DATAEXIT, INSERT PT*/ 01313000
*                                                                  0385 01314000
         L     @08,THEKEY(,COMMREG)                                0385 01315000
         ST    @08,INSRTKEY                                        0385 01316000
*                IF STATUS = NORECORD      /* NO PREVIOUS RECORD     */ 01317000
*                  THEN DO;                /* I.E. AT TOP OF DS      */ 01318000
         C     STATUS,@CF00055                                     0386 01319000
         BNE   @RF00386                                            0386 01320000
*                    STATUS = CONTINUE;    /* RESET CONTINUE STATUS  */ 01321000
         SLR   STATUS,STATUS                                       0388 01322000
*                    INSRTKEY = ZERO;      /* INDICATE TOP OF DS     */ 01323000
         SLR   @08,@08                                             0389 01324000
         ST    @08,INSRTKEY                                        0389 01325000
*                    END;                                          0390 01326000
*               END;                                               0391 01327000
@RF00386 DS    0H                                                  0392 01328000
*        END;                                                      0392 01329000
*                                                                  0392 01330000
@RF00379 DS    0H                                                  0392 01331000
@RC00374 DS    0H                                                  0393 01332000
*   RESPECIFY GPR14P RSTD;                                         0393 01333000
@RC00367 DS    0H                                                  0394 01334000
*   GPR14P = SETNEW14;               /* RESTORE REG 14               */ 01335000
         L     GPR14P,SETNEW14                                     0394 01336000
*   RESPECIFY (GPR14P) UNRSTD;                                     0395 01337000
*                                                                  0395 01338000
*END SETNEW;                                                       0396 01339000
@EL00010 DS    0H                                                  0396 01340000
@EF00010 DS    0H                                                  0396 01341000
@ER00010 BR    @14                                                 0396 01342000
*/********************************************************************/ 01343000
*/*                                                                  */ 01344000
*/*SETLIMIT-                                                         */ 01345000
*/*          SETLIMIT                                                */ 01346000
*/*                                                                  */ 01347000
*/*FUNCTION-                                                         */ 01348000
*/*          DETERMINE THE LIMIT FOR THE MOVE/COPY.IN OTHER WORDS    */ 01349000
*/*          FIND THE KEY FOR THE RECORD BEFORE WHICH ALL LINES ARE  */ 01350000
*/*          TO BE MOVE/COPIED.                                      */ 01351000
*/*                                                                  */ 01352000
*/*OPERATION-                                                        */ 01353000
*/*          IF A LINENUMBER WAS ENTERED FOR THE FIRST LINE TO BE    */ 01354000
*/*          MOVE/COPIED AND WE ARE TRYING TO MOVE/COPY TO THE THE   */ 01355000
*/*          TOP OF THE DATASET THEN THE LIMIT IS LINE ZERO.THE TOP  */ 01356000
*/*          OF THE DATASET,I.E.BEFORE THE FIRST LINE,IS WHEN AN     */ 01357000
*/*          ASTERISK WAS ENTERED AND THE CURRENT LINE POINTER IS    */ 01358000
*/*          ZERO.                                                   */ 01359000
*/*                                                                  */ 01360000
*/*          IF A RECORD EXISTS AFTER THE RECORD WHOSE KEY=NEWKEY    */ 01361000
*/*          THEN THE KEY OF THE THAT RECORD IS THE LIMIT FOR THE    */ 01362000
*/*          MOVE/COPY:                                              */ 01363000
*/*                                                                  */ 01364000
*/*          IF THERE ARE NO RECORDS AFTER THE RECORD WHOSE          */ 01365000
*/*          KEY=NEWKEY THEN THE LIMIT IS END OF FILE,I.E.THERE IS   */ 01366000
*/*          NO LIMIT.                                               */ 01367000
*/*                                                                  */ 01368000
*/*ERRORS-                                                           */ 01369000
*/*          THERE ARE NO ERRORS SET IN SETLIMIT BUT SOME MAY BE     */ 01370000
*/*          PASSED ON FROM IKJEBEUT TO SETNEW                       */ 01371000
*/*                                                                  */ 01372000
*/********************************************************************/ 01373000
*SETLIMIT:                                                         0397 01374000
*        PROC OPTIONS(NOSAVE);                                     0397 01375000
*                                                                  0397 01376000
SETLIMIT DS    0H                                                  0398 01377000
*    RESPECIFY (GPR14P) RSTD;                                      0398 01378000
*    SETLIM14 = GPR14P;              /* SAVE REG 14                  */ 01379000
         ST    GPR14P,SETLIM14                                     0399 01380000
*    RESPECIFY (GPR14P) UNRSTD;                                    0400 01381000
*                                                                  0400 01382000
*    IF (CANONUM = YES &             /* IF NON LINE NUMBERED DS      */ 01383000
*        NEWKEY = ZERO)   |          /* RELATIVE LINE # IS ZERP      */ 01384000
*                                                                  0401 01385000
*       (CAOPERND = YES &            /* IF THERE ARE OPERANDS        */ 01386000
*       NEWKEY      = ZERO &         /* MOVE/COPY TO LINE 0          */ 01387000
*       NEWF = YES &                 /* AND VALUE WAS ENTERED        */ 01388000
*       NEWVAL(1) = STAR&            /* '*' = CACURNUM = 0           */ 01389000
*       FIRSTLF = YES &              /* AND LINE VALUE WAS ENTERED   */ 01390000
*       FIRSTVAL(1) ^= '*')          /* AND NOT MOVE/COPY FROM STAR  */ 01391000
*     THEN LIMITKEY = FIRSTREC;      /* WILL MOVE/COPY BEFORE FIRST  */ 01392000
*                                                                  0401 01393000
         TM    CANONUM(COMMREG),B'00000001'                        0401 01394000
         BNO   @GL00022                                            0401 01395000
         LTR   NEWKEY,NEWKEY                                       0401 01396000
         BZ    @RT00401                                            0401 01397000
@GL00022 TM    CAOPERND(COMMREG),B'10000000'                       0401 01398000
         BNO   @RF00401                                            0401 01399000
         LTR   NEWKEY,NEWKEY                                       0401 01400000
         BNZ   @RF00401                                            0401 01401000
         TM    NEWF,B'10000000'                                    0401 01402000
         BNO   @RF00401                                            0401 01403000
         L     @08,NEWP                                            0401 01404000
         CLI   NEWVAL(@08),C'*'                                    0401 01405000
         BNE   @RF00401                                            0401 01406000
         TM    FIRSTLF,B'10000000'                                 0401 01407000
         BNO   @RF00401                                            0401 01408000
         L     @08,FIRSTLP                                         0401 01409000
         CLI   FIRSTVAL(@08),C'*'                                  0401 01410000
         BE    @RF00401                                            0401 01411000
@RT00401 DS    0H                                                  0402 01412000
         L     @08,FIRSTREC                                        0402 01413000
         ST    @08,LIMITKEY                                        0402 01414000
*     ELSE DO;                       /* FIND NEXT AFTER NEWKEY       */ 01415000
         B     @RC00401                                            0403 01416000
@RF00401 DS    0H                                                  0404 01417000
*       UTPARMP = ADDR(READNEXT);    /* READ NEXT AFTER NEWKEY       */ 01418000
         LA    UTPARMP,READNEXT                                    0404 01419000
*       THEKEY = NEWKEY ;            /* WANT KEY AFTER KEY = NEWKEY  */ 01420000
         ST    NEWKEY,THEKEY(,COMMREG)                             0405 01421000
*       CALL READ;                   /* READ THE NEXT RECORD         */ 01422000
*                                                                  0406 01423000
         BAL   @14,READ                                            0406 01424000
*       IF STATUS = CONTINUE         /* IF WE FOUND REC AFTER NEWKEY */ 01425000
*         THEN LIMITKEY = THEKEY;    /* THEN THIS IS KEY IS NEW LIMIT*/ 01426000
*                                                                  0407 01427000
         LTR   STATUS,STATUS                                       0407 01428000
         BNZ   @RF00407                                            0407 01429000
         L     @08,THEKEY(,COMMREG)                                0408 01430000
         ST    @08,LIMITKEY                                        0408 01431000
*         ELSE                       /* NON CONTINUE FROM IKJEBEUT   */ 01432000
*           IF STATUS = NORECORD     /* IF NO RECORD I.E. EOF        */ 01433000
*             THEN DO;               /* LIMIT WILL BE END OF FILE    */ 01434000
         B     @RC00407                                            0409 01435000
@RF00407 C     STATUS,@CF00055                                     0409 01436000
         BNE   @RF00409                                            0409 01437000
*               STATUS = CONTINUE;   /* WE CAN CONTINUE              */ 01438000
         SLR   STATUS,STATUS                                       0411 01439000
*               LIMITKEY = EOF;      /* LIMIT IS END OF FILE         */ 01440000
         MVC   LIMITKEY(4),@CF01325                                0412 01441000
*               END;                                               0413 01442000
*         END;                                                     0414 01443000
*                                                                  0414 01444000
@RF00409 DS    0H                                                  0414 01445000
@RC00407 DS    0H                                                  0415 01446000
*    RESPECIFY (GPR14P) RSTD;                                      0415 01447000
@RC00401 DS    0H                                                  0416 01448000
*    GPR14P = SETLIM14;              /* RESTORE REG 14               */ 01449000
         L     GPR14P,SETLIM14                                     0416 01450000
*    RESPECIFY (GPR14P) UNRSTD;                                    0417 01451000
*                                                                  0417 01452000
*END SETLIMIT;                                                     0418 01453000
@EL00011 DS    0H                                                  0418 01454000
@EF00011 DS    0H                                                  0418 01455000
@ER00011 BR    @14                                                 0418 01456000
*/********************************************************************/ 01457000
*/*                                                                  */ 01458000
*/*SEGMENT-                                                          */ 01459000
*/*          MOVE/COPY PART 1                                        */ 01460000
*/*                                                                  */ 01461000
*/*FUNCTION-                                                         */ 01462000
*/*          DO THE MOVE OR COPY                                     */ 01463000
*/*                                                                  */ 01464000
*/*OPERATION-                                                        */ 01465000
*/*          READ THE FIRST LINE TO BE MOVED OR COPIED.IT HAS A KEY  */ 01466000
*/*          OF OLDKEY.ENTER THE WRITE-DELETE-READ LOOP              */ 01467000
*/*                                                                  */ 01468000
*/*          WRITE THE LINE WITH A KEY OF NEWKEY.FOR A MOVE DELETE   */ 01469000
*/*          THE LINE WITH THE KEY OF OLDKEY.READ THE NEXT LINE      */ 01470000
*/*          AFTER THE LINE WITH THE KEY OF OLDKEY.UPDATE THE        */ 01471000
*/*          VARIABLE OF OLDKEY WITH THEKEY OF THE NEXT RECORD.      */ 01472000
*/*          UPDATE NEWKEY BY THEINCR.                               */ 01473000
*/*                                                                  */ 01474000
*/*          AFTER THE LOOP THE KEY TO BE VERIFIED IS THE NEWKEY     */ 01475000
*/*          DECREMENTED BY THEINCR BECAUSE THE VARIABLE OF NEWKEY   */ 01476000
*/*          IS INCREMENTED AND EXTRA TIME.                          */ 01477000
*/*                                                                  */ 01478000
*/*LOOP TERMINATION-                                                 */ 01479000
*/*          NORMAL END---CONTINUE STATUS                            */ 01480000
*/*          NEWUTIL----WANTED TO MOVE PAST THE LIMIT                */ 01481000
*/*          NON-CONTINUE----BAD RETURN CODE FROM IKJEBEUT           */ 01482000
*/*          CAATTNIS----ATTENTION IS ISSUED                         */ 01483000
*/*                                                                  */ 01484000
*/********************************************************************/ 01485000
*MOVECOPY:                                                         0419 01486000
*        PROC;                                                     0419 01487000
*                                                                  0419 01488000
MOVECOPY STM   @14,@05,@SA00012                                    0419 01489000
         STM   @07,@12,@SA00012+32                                 0419 01490000
*    OLDKEY = FIRSTKEY;              /* KEY TO BE MOVE/COPIED        */ 01491000
         L     OLDKEY,FIRSTKEY                                     0420 01492000
*    UTPARMP = ADDR(READPARM);       /* READ A SPECIFIC KEY          */ 01493000
         LA    UTPARMP,READPARM                                    0421 01494000
*    THEKEY = OLDKEY;                /* THE KEY WE WANT TO READ      */ 01495000
         ST    OLDKEY,THEKEY(,COMMREG)                             0422 01496000
*    CALL READ;                      /* READ THE FIRST RECORD        */ 01497000
*                                                                  0423 01498000
         BAL   @14,READ                                            0423 01499000
*    DO WHILE STATUS = CONTINUE &    /* AS LONG AS WE CAN CONTINUE   */ 01500000
*             NEWKEY  < LIMITKEY &   /* AND HAVE NOT PASSED OUR LIMIT*/ 01501000
*             OLDKEY =< LASTKEY &    /* THEKEY STILL IN THE RANGE    */ 01502000
*             CAATTNIS = NO;         /* ATTENTION NOT ISSUED         */ 01503000
*                                                                  0424 01504000
         B     @DE00424                                            0424 01505000
@DL00424 DS    0H                                                  0425 01506000
*      UTPARMP = ADDR(WRITEREC);     /* WRITE TOTHEKEY = NEWKEY      */ 01507000
         LA    UTPARMP,WRITEREC                                    0425 01508000
*      THEKEY = NEWKEY;              /* WRITE WITH A NEW KEY         */ 01509000
         ST    NEWKEY,THEKEY(,COMMREG)                             0426 01510000
*      CALL WRITE;                   /* CALL IKJEBEUT FOR THE WRITE  */ 01511000
*                                                                  0427 01512000
         BAL   @14,WRITE                                           0427 01513000
*      IF COMMAND = MOVE             /* IS THIS A MOVE               */ 01514000
*        THEN                        /*   YES - MOVE IMPLIES DELETE  */ 01515000
         CLI   COMMAND,1                                           0428 01516000
         BNE   @RF00428                                            0428 01517000
*          CALL DELETREC;            /* THEN DELETE THE OLD KEY      */ 01518000
*                                                                  0429 01519000
         BAL   @14,DELETREC                                        0429 01520000
*      UTPARMP = ADDR(READNEXT);     /* READNEXT AFTER FIRSTKEY      */ 01521000
@RF00428 LA    UTPARMP,READNEXT                                    0430 01522000
*      THEKEY = OLDKEY;              /* READ NEXT AFTER THE OLD KEY  */ 01523000
         ST    OLDKEY,THEKEY(,COMMREG)                             0431 01524000
*      CALL READ;                    /* READ THE NEXT RECORD         */ 01525000
         BAL   @14,READ                                            0432 01526000
*      OLDKEY = THEKEY;              /* THE NEXT KEY FOR MOVE/COPY   */ 01527000
*                                                                  0433 01528000
         L     OLDKEY,THEKEY(,COMMREG)                             0433 01529000
*      NEWKEY  = NEWKEY  + THEINCR;  /* NEW KEY FOR RECORD JUST READ */ 01530000
         AL    NEWKEY,THEINCR                                      0434 01531000
*    END;                                                          0435 01532000
*                                                                  0435 01533000
@DE00424 LTR   STATUS,STATUS                                       0435 01534000
         BNZ   @DC00424                                            0435 01535000
         C     NEWKEY,LIMITKEY                                     0435 01536000
         BNL   @DC00424                                            0435 01537000
         C     OLDKEY,LASTKEY                                      0435 01538000
         BH    @DC00424                                            0435 01539000
         TM    CAATTNIS(COMMREG),B'01000000'                       0435 01540000
         BZ    @DL00424                                            0435 01541000
@DC00424 DS    0H                                                  0436 01542000
*    VERIFY = NEWKEY  - THEINCR;     /* VERIFY LAST LINE WRITTEN     */ 01543000
         LR    @03,NEWKEY                                          0436 01544000
         SL    @03,THEINCR                                         0436 01545000
         ST    @03,VERIFY                                          0436 01546000
*/********************************************************************/ 01547000
*/*                                                                  */ 01548000
*/*SEGMENT-                                                          */ 01549000
*/*          MOVE/COPY PART 2                                        */ 01550000
*/*                                                                  */ 01551000
*/*FUNCTION-                                                         */ 01552000
*/*          CHECK FOR ERRORS                                        */ 01553000
*/*                                                                  */ 01554000
*/*OPERATION-                                                        */ 01555000
*/*          IF ATTENTION WAS ISSUED THEN TERMINATE WITHOUT AN       */ 01556000
*/*          ERROR MSG                                               */ 01557000
*/*                                                                  */ 01558000
*/*          IF THERE ARE STILL MORE LINES TO MOVE/COPY BUT WE HAVE  */ 01559000
*/*          PASSED OUR LIMIT THEN WE HAVE TO BUILD A NEW UTILITY    */ 01560000
*/*          DATASET                                                 */ 01561000
*/*                                                                  */ 01562000
*/*          IF THE LAST KEY FOR THE MOVE/COPY IS LESS THAN THE      */ 01563000
*/*          ORIGINAL VALUE FOR THE FIRST KEY WE HAVE AN ERROR       */ 01564000
*/*                                                                  */ 01565000
*/*          IF THE ORIGINAL VALUE FOR THE FIRST KEY DID NOT EXIST   */ 01566000
*/*          BUT FALLS BEFORE AN EXISTING KEY=X,THEN IF THE LAST     */ 01567000
*/*          KEY IS LESS THAN THIS NEW FIRSTKEY=X THEN WE HAVE AN    */ 01568000
*/*          ERROR.                                                  */ 01569000
*/*                                                                  */ 01570000
*/*          IF STATUS=NORECORD THEN WE GOT A NO RECORD FOUND        */ 01571000
*/*          INDICATION FROM IKJEBEUT.WE ARE THERE FORE FINISHED,I.  */ 01572000
*/*          E.THERE WAS NO RECORD AFTER THE LAST RECORD TO BE       */ 01573000
*/*          MOVE/COPIED.                                            */ 01574000
*/*                                                                  */ 01575000
*/********************************************************************/ 01576000
*                                                                  0437 01577000
*   IF CAATTNIS = YES                /* WAS ATTENTION ISSUED         */ 01578000
*     THEN STATUS = TERMNOER;        /* TERMINATE W/O ERR MSG        */ 01579000
*                                                                  0437 01580000
         TM    CAATTNIS(COMMREG),B'01000000'                       0437 01581000
         BNO   @RF00437                                            0437 01582000
         LA    STATUS,32                                           0438 01583000
*     ELSE                           /* CHECK FOR ANY ERRORS         */ 01584000
*     IF STATUS = CONTINUE           /* IKJEBEUT EXECUTE OK AND ...  */ 01585000
*       THEN                                                       0439 01586000
         B     @RC00437                                            0439 01587000
@RF00437 LTR   STATUS,STATUS                                       0439 01588000
         BNZ   @RF00439                                            0439 01589000
*       IF OLDKEY =< LASTKEY &       /* STILL HAVE MORE TO MOVE/COPY */ 01590000
*          NEWKEY >= LIMITKEY        /* ... WE HAVE GONE PAST LIMIT  */ 01591000
*         THEN                       /* HAVE TO BUILD A NEW UTILITY DS* 01592000
         C     OLDKEY,LASTKEY                                      0440 01593000
         BH    @RF00440                                            0440 01594000
         C     NEWKEY,LIMITKEY                                     0440 01595000
         BL    @RF00440                                            0440 01596000
*           CALL NEWUTIL;            /* BUILD THE NEW UTILITY DS     */ 01597000
*                                                                  0441 01598000
         BAL   @14,NEWUTIL                                         0441 01599000
*         ELSE                       /* CHECK FOR SOME ERRORS        */ 01600000
*         IF LASTKEY < ORIGFRST      /* LAST < FIRST AS ENTERED      */ 01601000
*           THEN STATUS = BADEND;    /* INDICATE LASTKEY < FIRSTKEY  */ 01602000
*                                                                  0442 01603000
         B     @RC00440                                            0442 01604000
@RF00440 CLC   LASTKEY(4),ORIGFRST                                 0442 01605000
         BNL   @RF00442                                            0442 01606000
         L     STATUS,BADEND                                       0443 01607000
*           ELSE                     /* CHECK FOR NO LINES IN RANGE  */ 01608000
*           IF LASTKEY < FIRSTKEY    /* LAST < ACTUAL FIRST LINE     */ 01609000
*             THEN STATUS = MSG52578; /* NO LINES IN RANGE MESSAGE   */ 01610000
         B     @RC00442                                            0444 01611000
@RF00442 CLC   LASTKEY(4),FIRSTKEY                                 0444 01612000
         BNL   @RF00444                                            0444 01613000
         LH    STATUS,MSG52578                                     0445 01614000
*             ELSE;                  /* A NECESSAR NULL ELSE         */ 01615000
*                                                                  0446 01616000
@RF00444 DS    0H                                                  0447 01617000
*       ELSE                         /* WE DID NOT BYPASS OUR LIMIT  */ 01618000
*       IF STATUS = NORECORD         /* NO RECORD FOUND VIA READ NEXT*/ 01619000
*         THEN STATUS = CONTINUE;    /* THEN RESET TO CONTINUE STATUS*/ 01620000
*                                                                  0447 01621000
*                                                                  0447 01622000
         B     @RC00439                                            0447 01623000
@RF00439 C     STATUS,@CF00055                                     0447 01624000
         BNE   @RF00447                                            0447 01625000
         SLR   STATUS,STATUS                                       0448 01626000
*END MOVECOPY;                                                     0449 01627000
@EL00012 DS    0H                                                  0449 01628000
@EF00012 DS    0H                                                  0449 01629000
@ER00012 LM    @14,@05,@SA00012                                    0449 01630000
         LM    @07,@12,@SA00012+32                                 0449 01631000
         BR    @14                                                 0449 01632000
*/********************************************************************/ 01633000
*/*                                                                  */ 01634000
*/*SEGMENT-                                                          */ 01635000
*/*          DELETREC                                                */ 01636000
*/*                                                                  */ 01637000
*/*FUNCTION-                                                         */ 01638000
*/*          FOR THE MOVE COMMAND TO DELETE THE RECORD FROM ITS      */ 01639000
*/*          ORIGINAL LOCATION                                       */ 01640000
*/*                                                                  */ 01641000
*/*OPERATION-                                                        */ 01642000
*/*          WE WILL DELETE THE OLD KEY BY CALLING DELETE.           */ 01643000
*/*          IF THE KEY WE DELETE WAS OUR LIMIT KEY THEN WE WILL     */ 01644000
*/*          GET A NEW LIMIT KEY.                                    */ 01645000
*/*                                                                  */ 01646000
*/*ERRORS-                                                           */ 01647000
*/*          EUTERR----I/O ERRORS PASSED ON FROM IKJEBEUT            */ 01648000
*/*                                                                  */ 01649000
*/********************************************************************/ 01650000
*                                                                  0450 01651000
*DELETREC:                                                         0450 01652000
*        PROC OPTIONS(NOSAVE);                                     0450 01653000
*                                                                  0450 01654000
DELETREC DS    0H                                                  0451 01655000
*    RESPECIFY (GPR14P) RSTD;                                      0451 01656000
*    DELETR14 = GPR14P;              /* SAVE REG 14                  */ 01657000
         ST    GPR14P,DELETR14                                     0452 01658000
*    RESPECIFY (GPR14P) UNRSTD;                                    0453 01659000
*                                                                  0453 01660000
*    UTPARMP = ADDR(DELETKEY);       /* PARMS TO DELETE A KEY        */ 01661000
         LA    UTPARMP,DELETKEY                                    0454 01662000
*    THEKEY = OLDKEY;                /* THE KEY TO BE DELETED        */ 01663000
         ST    OLDKEY,THEKEY(,COMMREG)                             0455 01664000
*    CALL DELETE;                    /* DELETE THE KEY               */ 01665000
*                                                                  0456 01666000
         BAL   @14,DELETE                                          0456 01667000
*    IF STATUS = CONTINUE &          /* CAN WE CONTINUE              */ 01668000
*       OLDKEY = LIMITKEY            /* AND WAS LIMITKEY DELETED     */ 01669000
*      THEN DO;                      /* GET NEW LIMIT KEY            */ 01670000
         LTR   STATUS,STATUS                                       0457 01671000
         BNZ   @RF00457                                            0457 01672000
         L     @03,LIMITKEY                                        0457 01673000
         CR    OLDKEY,@03                                          0457 01674000
         BNE   @RF00457                                            0457 01675000
*        UTPARMP = ADDR(READNEXT);   /* PARMS TO READ NEXT RECORD    */ 01676000
         LA    UTPARMP,READNEXT                                    0459 01677000
*        THEKEY = LIMITKEY;          /* READ NEXT AFTEROLD LIMIT     */ 01678000
         ST    @03,THEKEY(,COMMREG)                                0460 01679000
*        CALL READ;                  /* READ NEW LIMIT               */ 01680000
*                                                                  0461 01681000
         BAL   @14,READ                                            0461 01682000
*        IF STATUS = CONTINUE        /* IF STATUS IS OK              */ 01683000
*          THEN LIMITKEY = THEKEY;   /* SET NEW VALUE FRO LIMIT      */ 01684000
*                                                                  0462 01685000
         LTR   STATUS,STATUS                                       0462 01686000
         BNZ   @RF00462                                            0462 01687000
         L     @03,THEKEY(,COMMREG)                                0463 01688000
         ST    @03,LIMITKEY                                        0463 01689000
*          ELSE                      /* MAYBE ITS END OF FILE        */ 01690000
*            IF STATUS = NORECORD    /* IF NO RECORD AFTER OLD LIMIT */ 01691000
*              THEN DO;              /* THEN LIMIT WILL BE EOF       */ 01692000
         B     @RC00462                                            0464 01693000
@RF00462 C     STATUS,@CF00055                                     0464 01694000
         BNE   @RF00464                                            0464 01695000
*                STATUS = CONTINUE;  /* RESET A CONTINUE STATUS      */ 01696000
         SLR   STATUS,STATUS                                       0466 01697000
*                LIMITKEY = EOF;     /* INDICATE END OF FILE         */ 01698000
         MVC   LIMITKEY(4),@CF01325                                0467 01699000
*                END;                                              0468 01700000
*        END;                                                      0469 01701000
*                                                                  0469 01702000
@RF00464 DS    0H                                                  0469 01703000
@RC00462 DS    0H                                                  0470 01704000
*    RESPECIFY (GPR14P) RSTD;                                      0470 01705000
@RF00457 DS    0H                                                  0471 01706000
*    GPR14P = DELETR14;              /* RESTORE REG 14               */ 01707000
         L     GPR14P,DELETR14                                     0471 01708000
*    RESPECIFY (GPR14P) UNRSTD;                                    0472 01709000
*                                                                  0472 01710000
*END DELETREC;                                                     0473 01711000
@EL00013 DS    0H                                                  0473 01712000
@EF00013 DS    0H                                                  0473 01713000
@ER00013 BR    @14                                                 0473 01714000
*/********************************************************************/ 01715000
*/*                                                                  */ 01716000
*/*SEGMENT-                                                          */ 01717000
*/*          NEWUTIL                                                 */ 01718000
*/*                                                                  */ 01719000
*/*FUNCTION-                                                         */ 01720000
*/*          ALLOCATE A SECONDARY DATASET SO MOVE/COPY CAN REBUILD   */ 01721000
*/*          THE CURRENT DATASET BECAUSE THE RANGE OF LINES WOULD    */ 01722000
*/*          NOT FIT BEFORE THE LIMITKEY                             */ 01723000
*/*                                                                  */ 01724000
*/*OPERATION-                                                        */ 01725000
*/*          CALCULATE THE NUMBER OF ADDITIONAL RECORDS NEEDED FOR   */ 01726000
*/*          THE SECONDARY DATASET.INVOKE IKJEBEUI TO ALLOCATE THE   */ 01727000
*/*          SECONDARY DATASET                                       */ 01728000
*/*                                                                  */ 01729000
*/*          INITIALIZE THE PARAMETER LIST FOR IKJEBEUT THAT WILL    */ 01730000
*/*          BE USED TO WRITE SEQUENTIALLY TO THE SECONDARY DATASET. */ 01731000
*/*                                                                  */ 01732000
*/*          STEPS 1 THRU 3 ARE USED IN REBUILDING THE CURRENT DATA  */ 01733000
*/*          SET AND PERFORMING THE MOVE/COPY IN THE SECONDARY       */ 01734000
*/*          DATASET                                                 */ 01735000
*/*                                                                  */ 01736000
*/*ERRORS-                                                           */ 01737000
*/*          TERMNOER---NON ZERO RETURN CODE FROM IKJEBEUI           */ 01738000
*/*                                                                  */ 01739000
*/********************************************************************/ 01740000
*NEWUTIL:                                                          0474 01741000
*        PROC OPTIONS(NOSAVE);                                     0474 01742000
*                                                                  0474 01743000
NEWUTIL  DS    0H                                                  0475 01744000
*    RESPECIFY GPR14P RSTD;                                        0475 01745000
*    NEWUTI14=GPR14P;               /* UIPLIST IS A DUMMY FIELD NOT  */ 01746000
         ST    GPR14P,NEWUTI14                                     0476 01747000
*    RESPECIFY GPR14P UNRSTD;                                      0477 01748000
*                                                                  0477 01749000
*    IF TYPE = STRING                /* IF TYPE IS STRING MOVE/COPY  */ 01750000
*     THEN CARECNO = THECOUNT;       /* THE NUMBER OF ADDITIONAL RECS*/ 01751000
*                                                                  0478 01752000
         CLI   TYPE,3                                              0478 01753000
         BNE   @RF00478                                            0478 01754000
         L     @06,THECOUNT                                        0479 01755000
         ST    @06,CARECNO(,COMMREG)                               0479 01756000
*     ELSE                           /* TYPE IS A LINENUM MOVE/COPY  */ 01757000
*       IF CAUTILNO <                /* PRESENT SIZE OF UTILITY DS   */ 01758000
*             (LASTKEY - FIRSTKEY)   /* COMPARED WITH LAST-FIRST     */ 01759000
*         THEN CARECNO = CAUTILNO;   /* WILL TAKE WHICH EVER VALUE...*/ 01760000
         B     @RC00478                                            0480 01761000
@RF00478 L     @06,CAUTILNO(,COMMREG)                              0480 01762000
         L     @03,LASTKEY                                         0480 01763000
         SL    @03,FIRSTKEY                                        0480 01764000
         CR    @06,@03                                             0480 01765000
         BNL   @RF00480                                            0480 01766000
         ST    @06,CARECNO(,COMMREG)                               0481 01767000
*         ELSE CARECNO = LASTKEY - FIRSTKEY; /* ... IS THE SMALLEST  */ 01768000
*                                                                  0482 01769000
         B     @RC00480                                            0482 01770000
@RF00480 L     @06,LASTKEY                                         0482 01771000
         SL    @06,FIRSTKEY                                        0482 01772000
         ST    @06,CARECNO(,COMMREG)                               0482 01773000
*    RESPECIFY (GPR00P,GPR15P) RSTD;                               0483 01774000
@RC00480 DS    0H                                                  0483 01775000
@RC00478 DS    0H                                                  0484 01776000
*    GEN REFS(COMMREG)                                             0484 01777000
*      (IKJEBESH (COMMREG),IKJEBEUI,PARAM=((COMMREG)),MF=(E,A));   0484 01778000
         IKJEBESH (COMMREG),IKJEBEUI,PARAM=((COMMREG)),MF=(E,A)         01779000
*    STATUS = GPR15P;                /* GET ALLOC STATUS             */ 01780000
         LR    STATUS,GPR15P                                       0485 01781000
*    CAPTPDCB = GPR00P;              /* GET NEW DCB ADDRESS          */ 01782000
         ST    GPR00P,CAPTPDCB(,COMMREG)                           0486 01783000
*    RESPECIFY (GPR00P,GPR15P) UNRSTD;                             0487 01784000
*                                                                  0487 01785000
*    UTPARMP = ADDR(WRITESEQ);       /* PARMS TO WRITE SEQUENTIALLY  */ 01786000
         LA    UTPARMP,WRITESEQ                                    0488 01787000
*    UTCODE = CAUTWRTS;              /* CODE TO WRITE SEQUENTIALLY   */ 01788000
         MVI   UTCODE(UTPARMP),X'21'                               0489 01789000
*    UTDCBPTR = CAPTPDCB;            /* NEW DATASET DCB              */ 01790000
         L     @05,CAPTPDCB(,COMMREG)                              0490 01791000
         STCM  @05,7,UTDCBPTR(UTPARMP)                             0490 01792000
*    UTKEYPTR = ADDR(THEBUFFR);      /* WRITE THEBUFFR WITH THIS KEY */ 01793000
         LA    @05,THEBUFFR(,COMMREG)                              0491 01794000
         ST    @05,UTKEYPTR(,UTPARMP)                              0491 01795000
*    UTEOL2 = YES;                   /* INDICATE END OF LIST         */ 01796000
*                                                                  0492 01797000
         OI    UTEOL2(UTPARMP),B'10000000'                         0492 01798000
*    IF STATUS = CONTINUE            /* CAN WE CONTINUE TO STEP1     */ 01799000
*      THEN DO;                      /* PROCEED TO STEP 1            */ 01800000
         LTR   STATUS,STATUS                                       0493 01801000
         BNZ   @RF00493                                            0493 01802000
*        SECONDDS = YES;             /* SECOND DATA SET ALLOCATED    */ 01803000
*                                                                  0495 01804000
         OI    SECONDDS,B'10000000'                                0495 01805000
*        CALL STEP1;                 /* COPY 0 THRU LIMIT            */ 01806000
*                                                                  0496 01807000
         BAL   @14,STEP1                                           0496 01808000
*        IF STATUS = CONTINUE        /* CAN WE CONTINUE TO STEP2     */ 01809000
*          THEN DO;                  /* PROCEED TO STEP 2            */ 01810000
         LTR   STATUS,STATUS                                       0497 01811000
         BNZ   @RF00497                                            0497 01812000
*            CALL STEP2;             /* COPY FIRST THRU LAST         */ 01813000
*                                                                  0499 01814000
         BAL   @14,STEP2                                           0499 01815000
*            IF STATUS = CONTINUE    /* CAN WE CONTINUE TO STEP 3    */ 01816000
*              THEN CALL STEP3;      /* THEN PROCEED TO STEP 3       */ 01817000
         LTR   STATUS,STATUS                                       0500 01818000
         BNZ   @RF00500                                            0500 01819000
         BAL   @14,STEP3                                           0501 01820000
*            END;                                                  0502 01821000
*        END;                                                      0503 01822000
*                                                                  0503 01823000
*      ELSE                          /* BAD ALLOCATION ERROR         */ 01824000
*        STATUS = TERMNOER;          /* TERMINATE WITHOUT ERR MSG    */ 01825000
*                                                                  0504 01826000
         B     @RC00493                                            0504 01827000
@RF00493 LA    STATUS,32                                           0504 01828000
*    RESPECIFY (GPR14P) RSTD;                                      0505 01829000
@RC00493 DS    0H                                                  0506 01830000
*    GPR14P = NEWUTI14;              /* RESTORE REG 14               */ 01831000
         L     GPR14P,NEWUTI14                                     0506 01832000
*    RESPECIFY (GPR14P) UNRSTD;                                    0507 01833000
*                                                                  0507 01834000
*END NEWUTIL;                                                      0508 01835000
@EL00014 DS    0H                                                  0508 01836000
@EF00014 DS    0H                                                  0508 01837000
@ER00014 BR    @14                                                 0508 01838000
*/********************************************************************/ 01839000
*/*                                                                  */ 01840000
*/*SEGMENT-                                                          */ 01841000
*/*          STEP1                                                   */ 01842000
*/*                                                                  */ 01843000
*/*FUNCTION-                                                         */ 01844000
*/*          COPY THE LINES FROM THE BEGINNING OF THE DATASET UP TO  */ 01845000
*/*          LIMITKEY.                                               */ 01846000
*/*                                                                  */ 01847000
*/*OPERATION-                                                        */ 01848000
*/*          COPY FROM THE CURRENT DATASET TO THE SECONDARY DATASET. */ 01849000
*/*          START WITH THE BEGINNING OF THE CURRENT DATASET AND     */ 01850000
*/*          COPY UP TO BUT NOT INCLUDING THE RECORD WHOSE           */ 01851000
*/*          KEY=LIMITKEY.                                           */ 01852000
*/*                                                                  */ 01853000
*/*          IF THE COMMAND IS A MOVE AND THE RANGE OF LINES FALLS   */ 01854000
*/*          BETWEEN THE BEGINNING OF THE CURRENT DATASET AND THE    */ 01855000
*/*          LIMITKEY THEN BYPASS COPYING THE RANGE OF LINES TO THE  */ 01856000
*/*          SECONDARY DATASET.                                      */ 01857000
*/*                                                                  */ 01858000
*/*ERRORS-                                                           */ 01859000
*/*          EUTERR---ANY ERRORS DETECTED IN IKJEBEUT                */ 01860000
*/*                                                                  */ 01861000
*/********************************************************************/ 01862000
*STEP1:                                                            0509 01863000
*        PROC OPTIONS(NOSAVE);                                     0509 01864000
*                                                                  0509 01865000
STEP1    DS    0H                                                  0510 01866000
*    RESPECIFY (GPR14P) RSTD;                                      0510 01867000
*    STEP114 = GPR14P;               /* SAVE REG 14                  */ 01868000
         ST    GPR14P,STEP114                                      0511 01869000
*    RESPECIFY (GPR14P) UNRSTD;                                    0512 01870000
*                                                                  0512 01871000
*    UTPARMP = ADDR(READFRST);       /* WE WILL READ THE FIRST RECORD*/ 01872000
         LA    UTPARMP,READFRST                                    0513 01873000
*    CALL READ;                      /* READ THE FIRST RECORD        */ 01874000
*                                                                  0514 01875000
         BAL   @14,READ                                            0514 01876000
*    DO WHILE STATUS = CONTINUE &    /* LOOP WHILE STATUS IS CONTINUE*/ 01877000
*             THEKEY < LIMITKEY &    /* AND WE HAVE NOT PASSED LIMIT */ 01878000
*             CAATTNIS = NO;         /* AND NO ATTENTION IS ISSUED   */ 01879000
*                                                                  0515 01880000
         B     @DE00515                                            0515 01881000
@DL00515 DS    0H                                                  0516 01882000
*      IF FIRSTKEY =< THEKEY  &      /* IS RECORD WITHIN THE RANGE...*/ 01883000
*         THEKEY =< LASTKEY   &      /* ... OF MOVE/COPY             */ 01884000
*         COMMAND = MOVE             /* ... TO MOVE                  */ 01885000
*        THEN DO;                    /* THEN DO NOT COPY TO NEW DS   */ 01886000
         L     @03,THEKEY(,COMMREG)                                0516 01887000
         C     @03,FIRSTKEY                                        0516 01888000
         BL    @RF00516                                            0516 01889000
         L     @15,LASTKEY                                         0516 01890000
         CR    @03,@15                                             0516 01891000
         BH    @RF00516                                            0516 01892000
         CLI   COMMAND,1                                           0516 01893000
         BNE   @RF00516                                            0516 01894000
*          UTPARMP = ADDR(READNEXT); /* WILL SKIP TO NEXT AFTER LAST */ 01895000
         LA    UTPARMP,READNEXT                                    0518 01896000
*          THEKEY = LASTKEY;         /* READ-NEXT-AFTER LASTKEY      */ 01897000
         ST    @15,THEKEY(,COMMREG)                                0519 01898000
*          CALL READ;                /* READ THE RECORD AFTER LAST   */ 01899000
         BAL   @14,READ                                            0520 01900000
*                                    /* THIS NEW KEY IS IN THEKEY    */ 01901000
*          END;                                                    0521 01902000
*                                                                  0521 01903000
*        ELSE DO;                    /* WE CAN COPY THE LINE         */ 01904000
         B     @RC00516                                            0522 01905000
@RF00516 DS    0H                                                  0523 01906000
*          UTPARMP = ADDR(WRITESEQ); /* WRITE RECORDS SEQUENTIALLY   */ 01907000
         LA    UTPARMP,WRITESEQ                                    0523 01908000
*          CALL WRITE;               /* WRITE THE RECORD             */ 01909000
*                                                                  0524 01910000
         BAL   @14,WRITE                                           0524 01911000
*          UTPARMP = ADDR(READNEXT); /* WILL GET NEXT RECORD         */ 01912000
         LA    UTPARMP,READNEXT                                    0525 01913000
*          CALL READ;                /* READ THE NEXT RECORD         */ 01914000
         BAL   @14,READ                                            0526 01915000
*          END;                                                    0527 01916000
*    END;                                                          0528 01917000
*                                                                  0528 01918000
@RC00516 DS    0H                                                  0528 01919000
@DE00515 LTR   STATUS,STATUS                                       0528 01920000
         BNZ   @DC00515                                            0528 01921000
         CLC   THEKEY(4,COMMREG),LIMITKEY                          0528 01922000
         BNL   @DC00515                                            0528 01923000
         TM    CAATTNIS(COMMREG),B'01000000'                       0528 01924000
         BZ    @DL00515                                            0528 01925000
@DC00515 DS    0H                                                  0529 01926000
*    IF CAATTNIS = YES               /* WAS ATTENTION ISSUED         */ 01927000
*      THEN STATUS = TERMNOER;       /* TERMINATE WITHOUT ERR MSG    */ 01928000
*                                                                  0529 01929000
         TM    CAATTNIS(COMMREG),B'01000000'                       0529 01930000
         BNO   @RF00529                                            0529 01931000
         LA    STATUS,32                                           0530 01932000
*      ELSE                          /* LOOK FOR END OF FILE         */ 01933000
*      IF STATUS = NORECORD          /* IF LIMIT IS EOF              */ 01934000
*        THEN STATUS = CONTINUE;     /* THEN INDICATE WE CAN CONTINUE*/ 01935000
*                                                                  0531 01936000
         B     @RC00529                                            0531 01937000
@RF00529 C     STATUS,@CF00055                                     0531 01938000
         BNE   @RF00531                                            0531 01939000
         SLR   STATUS,STATUS                                       0532 01940000
*    RESPECIFY (GPR14P) RSTD;                                      0533 01941000
@RF00531 DS    0H                                                  0533 01942000
@RC00529 DS    0H                                                  0534 01943000
*    GPR14P = STEP114;               /* RESTPRE REG 14               */ 01944000
         L     GPR14P,STEP114                                      0534 01945000
*    RESPECIFY (GPR14P) UNRSTD;                                    0535 01946000
*                                                                  0535 01947000
*END STEP1;                                                        0536 01948000
@EL00015 DS    0H                                                  0536 01949000
@EF00015 DS    0H                                                  0536 01950000
@ER00015 BR    @14                                                 0536 01951000
*/********************************************************************/ 01952000
*/*                                                                  */ 01953000
*/*SEGMENT-                                                          */ 01954000
*/*          STEP2                                                   */ 01955000
*/*                                                                  */ 01956000
*/*FUNCTION-                                                         */ 01957000
*/*          COPY THE RANGE OF LINES TO THE SECONDARY DATASET        */ 01958000
*/*                                                                  */ 01959000
*/*OPERATION-                                                        */ 01960000
*/*          SIMPLY COPY THOSE RECORDS BEGINNING WITH FIRSTKEY AND   */ 01961000
*/*          ENDING WITH LASTKEY TO THE NEW DATASET.THEY WILL NOT    */ 01962000
*/*          HAVE TO BE DELETED FROM THE SECONDARY DATASET IF THE    */ 01963000
*/*          COMMAND IS A MOVE BECAUSE THEY WERE NOT COPIED TO IT.   */ 01964000
*/*                                                                  */ 01965000
*/*ERRORS-                                                           */ 01966000
*/*          EUTERR---ANY ERRORS DETECTED IN IKJEBEUT                */ 01967000
*/*                                                                  */ 01968000
*/********************************************************************/ 01969000
*STEP2:                                                            0537 01970000
*        PROC OPTIONS(NOSAVE);                                     0537 01971000
*                                                                  0537 01972000
STEP2    DS    0H                                                  0538 01973000
*    RESPECIFY (GPR14P) RSTD;                                      0538 01974000
*    STEP214 = GPR14P;               /* SAVE REG 14                  */ 01975000
         ST    GPR14P,STEP214                                      0539 01976000
*    RESPECIFY (GPR14P) UNRSTD;                                    0540 01977000
*                                                                  0540 01978000
*    UTPARMP = ADDR(READPARM);        /* READ FIRST REC FOR MOVE/COPY * 01979000
         LA    UTPARMP,READPARM                                    0541 01980000
*    THEKEY = OLDKEY;                /* NEXT LINE TO BE MOVE/COPIED  */ 01981000
         ST    OLDKEY,THEKEY(,COMMREG)                             0542 01982000
*    CALL READ;                      /* READ THE FIRST KEY           */ 01983000
*                                                                  0543 01984000
         BAL   @14,READ                                            0543 01985000
*    DO WHILE STATUS = CONTINUE &    /* AS LONG AS WE CAN CONTINUE   */ 01986000
*             OLDKEY =< LASTKEY &    /* THEKEY STILL IN THE RANGE    */ 01987000
*             CAATTNIS = NO;         /* AND NO ATTENTION ISSUED      */ 01988000
*                                                                  0544 01989000
         B     @DE00544                                            0544 01990000
@DL00544 DS    0H                                                  0545 01991000
*      UTPARMP = ADDR(WRITESEQ);     /* WRITE THE RECORD             */ 01992000
         LA    UTPARMP,WRITESEQ                                    0545 01993000
*      THEKEY = NEWKEY;              /* WRITE WITH A NEW KEY         */ 01994000
         ST    NEWKEY,THEKEY(,COMMREG)                             0546 01995000
*      CALL WRITE;                   /* WRITE THE RECORD             */ 01996000
*                                                                  0547 01997000
         BAL   @14,WRITE                                           0547 01998000
*      UTPARMP = ADDR(READNEXT);     /* WILL READ THE NEXT RECORD    */ 01999000
         LA    UTPARMP,READNEXT                                    0548 02000000
*      THEKEY = OLDKEY;              /* READ NEXT AFTER THE OLD KEY  */ 02001000
         ST    OLDKEY,THEKEY(,COMMREG)                             0549 02002000
*      CALL READ;                    /* READ THE RECORD              */ 02003000
         BAL   @14,READ                                            0550 02004000
*      OLDKEY = THEKEY;              /* THE NEXT OLD KEY             */ 02005000
*                                                                  0551 02006000
         L     OLDKEY,THEKEY(,COMMREG)                             0551 02007000
*      NEWKEY  = NEWKEY  + THEINCR;  /* WHERE THE REC WILL GO        */ 02008000
         AL    NEWKEY,THEINCR                                      0552 02009000
*    END;                                                          0553 02010000
*                                                                  0553 02011000
@DE00544 LTR   STATUS,STATUS                                       0553 02012000
         BNZ   @DC00544                                            0553 02013000
         C     OLDKEY,LASTKEY                                      0553 02014000
         BH    @DC00544                                            0553 02015000
         TM    CAATTNIS(COMMREG),B'01000000'                       0553 02016000
         BZ    @DL00544                                            0553 02017000
@DC00544 DS    0H                                                  0554 02018000
*    VERIFY = NEWKEY  - THEINCR;     /* VERIFY LAST LINE WRITTEN     */ 02019000
*                                                                  0554 02020000
         LR    @08,NEWKEY                                          0554 02021000
         SL    @08,THEINCR                                         0554 02022000
         ST    @08,VERIFY                                          0554 02023000
*    IF CAATTNIS = YES               /* WAS ATTENTION ISSUED         */ 02024000
*      THEN STATUS = TERMNOER;       /* TERMINATE WITHOUT ERR MSG    */ 02025000
*                                                                  0555 02026000
         TM    CAATTNIS(COMMREG),B'01000000'                       0555 02027000
         BNO   @RF00555                                            0555 02028000
         LA    STATUS,32                                           0556 02029000
*      ELSE                          /* LOOK FOR END OF FILE         */ 02030000
*      IF STATUS = NORECORD          /* IF NOTHEING AFTER LAST REC   */ 02031000
*        THEN STATUS = CONTINUE;     /* INDICATE WE CAN CONTINUE     */ 02032000
*                                                                  0557 02033000
         B     @RC00555                                            0557 02034000
@RF00555 C     STATUS,@CF00055                                     0557 02035000
         BNE   @RF00557                                            0557 02036000
         SLR   STATUS,STATUS                                       0558 02037000
*    RESPECIFY (GPR14P) RSTD;                                      0559 02038000
@RF00557 DS    0H                                                  0559 02039000
@RC00555 DS    0H                                                  0560 02040000
*    GPR14P = STEP214;               /* RESTORE REG 14               */ 02041000
         L     GPR14P,STEP214                                      0560 02042000
*    RESPECIFY (GPR14P) UNRSTD;                                    0561 02043000
*                                                                  0561 02044000
*END STEP2;                                                        0562 02045000
@EL00016 DS    0H                                                  0562 02046000
@EF00016 DS    0H                                                  0562 02047000
@ER00016 BR    @14                                                 0562 02048000
*/********************************************************************/ 02049000
*/*                                                                  */ 02050000
*/*SEGMENT-                                                          */ 02051000
*/*          STEP3                                                   */ 02052000
*/*                                                                  */ 02053000
*/*FUNCTION-                                                         */ 02054000
*/*          COPY FROM LIMITKEY TO THE END OF THE DATASET.           */ 02055000
*/*                                                                  */ 02056000
*/*OPERATION-                                                        */ 02057000
*/*          COPY THE REST OF THE CURRENT DATASET FROM KEY=LIMITKEY  */ 02058000
*/*          TO EOF.WE HAVE TO DO OUR RENUMBERING HERE OF THE THOSE  */ 02059000
*/*          LINES WITH KEYS>=LIMITKEY AND KEYS=<THEKEY OF THE LAST  */ 02060000
*/*          LINE WRITTEN TO THE SECONDARY DATASET                   */ 02061000
*/*                                                                  */ 02062000
*/*          IF THE KEY OF THE RECORD READ FROM THE CURRENT DATASET  */ 02063000
*/*          IS LESS THAN THE KEY OF THE LAST RECORD WRITTEN TO THE  */ 02064000
*/*          SECONDARY DATASET,THE KEY FOR THE RECORD OF THE         */ 02065000
*/*          CURRENT DATASET HAS TO BE RENUMBERED.                   */ 02066000
*/*                                                                  */ 02067000
*/*          RECORDS WILL CONTINUE TO BE RENUMBERED UNTIL THE KEYS   */ 02068000
*/*          OF THE CURRENT DATASET CATCH UP TO AND BECOME GREATER   */ 02069000
*/*          THAN THE KEY=NEWKEY OF THE LAST REC WRITTEN TO THE      */ 02070000
*/*          SECONDARY DATASET.THIS IS WHEN THE RENUMBERING STOPS.   */ 02071000
*/*                                                                  */ 02072000
*/********************************************************************/ 02073000
*STEP3:                                                            0563 02074000
*        PROC OPTIONS(NOSAVE);                                     0563 02075000
*                                                                  0563 02076000
STEP3    DS    0H                                                  0564 02077000
*    RESPECIFY (GPR14P) RSTD;                                      0564 02078000
*    STEP314 = GPR14P;               /* SAVE REG 14                  */ 02079000
         ST    GPR14P,STEP314                                      0565 02080000
*    RESPECIFY (GPR14P) UNRSTD;                                    0566 02081000
*                                                                  0566 02082000
*    NEWKEY  = NEWKEY  - THEINCR;    /* RESET TO LAST LINE # WRITTEN */ 02083000
         SL    NEWKEY,THEINCR                                      0567 02084000
*                                    /* AND ADD THE MIN INCR OF 1    */ 02085000
*    OLDKEY = LIMITKEY;              /* WE MAY RENUMBER THIS KEY     */ 02086000
         L     @05,LIMITKEY                                        0568 02087000
         LR    OLDKEY,@05                                          0568 02088000
*    UTPARMP = ADDR(READPARM);       /* WANT TO READ SPECIFIC KEY    */ 02089000
         LA    UTPARMP,READPARM                                    0569 02090000
*    THEKEY = LIMITKEY;              /* READ FROM LIMIT TO EOF       */ 02091000
         ST    @05,THEKEY(,COMMREG)                                0570 02092000
*    CALL READ;                      /* READ KEY=LIMITKEY            */ 02093000
*                                                                  0571 02094000
         BAL   @14,READ                                            0571 02095000
*    DO WHILE STATUS = CONTINUE &    /* LOOP TILL END OF FILE        */ 02096000
*             CAATTNIS = NO;         /* AND NO ATTENTION ISSUED      */ 02097000
*                                                                  0572 02098000
         B     @DE00572                                            0572 02099000
@DL00572 DS    0H                                                  0573 02100000
*      IF FIRSTKEY =< OLDKEY &       /* IS RECORD WITHIN THE RANGE...*/ 02101000
*         OLDKEY =< LASTKEY  &       /* ... OF THE MOVE/COPY...      */ 02102000
*         COMMAND = MOVE             /* ... TO BE MOVED              */ 02103000
*        THEN DO;                    /* THEN SKIP TO LINE AFTER LAST */ 02104000
         C     OLDKEY,FIRSTKEY                                     0573 02105000
         BL    @RF00573                                            0573 02106000
         L     @03,LASTKEY                                         0573 02107000
         CR    OLDKEY,@03                                          0573 02108000
         BH    @RF00573                                            0573 02109000
         CLI   COMMAND,1                                           0573 02110000
         BNE   @RF00573                                            0573 02111000
*          UTPARMP = ADDR(READNEXT); /* WANT LINE AFTER KEY=LASTKEY  */ 02112000
         LA    UTPARMP,READNEXT                                    0575 02113000
*          THEKEY = LASTKEY;         /* GET LINE AFTER KEY = LASTKEY */ 02114000
         ST    @03,THEKEY(,COMMREG)                                0576 02115000
*          CALL READ;                /* READ THE LINE AFTER LASTKEY  */ 02116000
         BAL   @14,READ                                            0577 02117000
*          OLDKEY = THEKEY;          /* SAVE NEXT KEY AFTER LAST     */ 02118000
         L     OLDKEY,THEKEY(,COMMREG)                             0578 02119000
*          END;                                                    0579 02120000
*                                                                  0579 02121000
*        ELSE DO;                    /* WE CAN COPY THIS LINE        */ 02122000
         B     @RC00573                                            0580 02123000
@RF00573 DS    0H                                                  0581 02124000
*          IF OLDKEY =< NEWKEY       /* IS KEY < LAST REC WRITTEN    */ 02125000
*            THEN DO;                /* WILL RENUMBER BY MININCR     */ 02126000
         CR    OLDKEY,NEWKEY                                       0581 02127000
         BH    @RF00581                                            0581 02128000
*              NEWKEY  = NEWKEY  + MININCR; /* INCR BY MININCR       */ 02129000
         AL    NEWKEY,@CF00063                                     0583 02130000
*              THEKEY  = NEWKEY;     /* AND CHANGE THE KEY           */ 02131000
         ST    NEWKEY,THEKEY(,COMMREG)                             0584 02132000
*              END;                                                0585 02133000
*                                                                  0585 02134000
*          UTPARMP = ADDR(WRITESEQ); /* WRITE THE RECORD             */ 02135000
@RF00581 LA    UTPARMP,WRITESEQ                                    0586 02136000
*          CALL WRITE;               /* WRITE THE RECORD             */ 02137000
*                                                                  0587 02138000
         BAL   @14,WRITE                                           0587 02139000
*          UTPARMP = ADDR(READNEXT); /* WILL READ THE NEXT RECORD... */ 02140000
         LA    UTPARMP,READNEXT                                    0588 02141000
*          THEKEY = OLDKEY;          /* AFTER THE LAST REC READ      */ 02142000
         ST    OLDKEY,THEKEY(,COMMREG)                             0589 02143000
*          CALL READ;                /* READ THE NEXT RECORD         */ 02144000
         BAL   @14,READ                                            0590 02145000
*          OLDKEY = THEKEY;          /* SAVE THE NEXT KEY            */ 02146000
         L     OLDKEY,THEKEY(,COMMREG)                             0591 02147000
*          END;                                                    0592 02148000
*    END;                                                          0593 02149000
*                                                                  0593 02150000
@RC00573 DS    0H                                                  0593 02151000
@DE00572 LTR   STATUS,STATUS                                       0593 02152000
         BNZ   @DC00572                                            0593 02153000
         TM    CAATTNIS(COMMREG),B'01000000'                       0593 02154000
         BZ    @DL00572                                            0593 02155000
@DC00572 DS    0H                                                  0594 02156000
*    IF CAATTNIS = YES               /* WAS ATTENTION ISSUED         */ 02157000
*      THEN STATUS = TERMNOER;       /* TERMINATE WITHOUT ERR MSG    */ 02158000
*                                                                  0594 02159000
         TM    CAATTNIS(COMMREG),B'01000000'                       0594 02160000
         BNO   @RF00594                                            0594 02161000
         LA    STATUS,32                                           0595 02162000
*      ELSE                          /* LOOK FOR END OF FILE         */ 02163000
*      IF STATUS = NORECORD          /* IF END OF FILE               */ 02164000
*        THEN STATUS = CONTINUE;     /* THEN CONTINUE, I.E. NO ERR   */ 02165000
*                                                                  0596 02166000
         B     @RC00594                                            0596 02167000
@RF00594 C     STATUS,@CF00055                                     0596 02168000
         BNE   @RF00596                                            0596 02169000
         SLR   STATUS,STATUS                                       0597 02170000
*    RESPECIFY (GPR14P) RSTD;                                      0598 02171000
@RF00596 DS    0H                                                  0598 02172000
@RC00594 DS    0H                                                  0599 02173000
*    GPR14P = STEP314;               /* RESTORE REG 14               */ 02174000
         L     GPR14P,STEP314                                      0599 02175000
*    RESPECIFY (GPR14P) UNRSTD;                                    0600 02176000
*                                                                  0600 02177000
*END STEP3;                                                        0601 02178000
@EL00017 DS    0H                                                  0601 02179000
@EF00017 DS    0H                                                  0601 02180000
@ER00017 BR    @14                                                 0601 02181000
*/********************************************************************/ 02182000
*/*                                                                  */ 02183000
*/*SEGMENT-                                                          */ 02184000
*/*          IKJEBEUT                                                */ 02185000
*/*                                                                  */ 02186000
*/*FUNCTION-                                                         */ 02187000
*/*          PERFORM THE READ/WRITE/DELETE OPERATIONS FOR MOVE/COPY  */ 02188000
*/*                                                                  */ 02189000
*/*OPERATION-                                                        */ 02190000
*/*          NO I/O OPERATIONS WILL BE PERFORMED IF THE STATUS IS    */ 02191000
*/*          OTHER THAN CONTINUE                                     */ 02192000
*/*                                                                  */ 02193000
*/*          GET THE ADDRESS OF THE I/O PARAMETER LIST THAT WILL BE  */ 02194000
*/*          USED BY IKJEBEUT                                        */ 02195000
*/*                                                                  */ 02196000
*/*          CALL IKJEBEUT TO PERFORM THE I/O OPERATION              */ 02197000
*/*                                                                  */ 02198000
*/*ERRORS-                                                           */ 02199000
*/*          TERMNOER--WHEN OTHER THAN CONTINUE OR NO RECORD FOUND   */ 02200000
*/*          STATUS                                                  */ 02201000
*/*                                                                  */ 02202000
*/********************************************************************/ 02203000
*                                                                  0602 02204000
*IKJEBEUT:READ:WRITE:DELETE:                                       0602 02205000
*        PROC OPTIONS(NOSAVE);                                     0602 02206000
*                                                                  0602 02207000
IKJEBEUT DS    0H                                                  0602 02208000
READ     DS    0H                                                  0602 02209000
WRITE    DS    0H                                                  0602 02210000
DELETE   DS    0H                                                  0603 02211000
*   RESPECIFY (GPR01P,GPR14P) RSTD;                                0603 02212000
*   EBEUT14 =GPR14P;                 /* SAVE REG 14                  */ 02213000
         ST    GPR14P,EBEUT14                                      0604 02214000
*   RESPECIFY (GPR14P) UNRSTD;                                     0605 02215000
*                                                                  0605 02216000
*    IF STATUS = CONTINUE            /* CAN WE CONTINUE WITH IKJEBEUT*/ 02217000
*      THEN DO;                                                    0606 02218000
         LTR   STATUS,STATUS                                       0606 02219000
         BNZ   @RF00606                                            0606 02220000
*        RESPECIFY (GPR15P,GPR01P) RSTD;                           0608 02221000
*        GPR01P = UTPARMP;           /* GET ADDR OF PARAMETER LIST   */ 02222000
*                                                                  0609 02223000
         LR    GPR01P,UTPARMP                                      0609 02224000
*        GENERATE REFS(COMMREG,CAPTUT)                             0610 02225000
*          (IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),(1)),MF=(E,A)) 02226000
*                                                                  0610 02227000
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),(1)),MF=(E,A)     02228000
*        STATUS = GPR15P;                                          0611 02229000
         LR    STATUS,GPR15P                                       0611 02230000
*        RESPECIFY (GPR15P,GPR01P) UNRSTD;                         0612 02231000
*                                                                  0612 02232000
*        IF STATUS ^= CONTINUE &     /* WAS THERE AN ERROR IN EBEUT  */ 02233000
*           STATUS ^= NORECORD       /* OTHER THAN NO RECORD FOUND   */ 02234000
*         THEN                       /*   YES - THERE WAS AN ERROR   */ 02235000
         LTR   STATUS,STATUS                                       0613 02236000
         BZ    @RF00613                                            0613 02237000
         C     STATUS,@CF00055                                     0613 02238000
         BE    @RF00613                                            0613 02239000
*           STATUS = TERMNOER;       /* IKJEBEUT PUT OUT THE MESSAGES*/ 02240000
         LA    STATUS,32                                           0614 02241000
*        END;                                                      0615 02242000
*                                                                  0615 02243000
@RF00613 DS    0H                                                  0616 02244000
*    RESPECIFY (GPR14P) RSTD;                                      0616 02245000
@RF00606 DS    0H                                                  0617 02246000
*    GPR14P=EBEUT14;                 /* RESTORE REG 14               */ 02247000
         L     GPR14P,EBEUT14                                      0617 02248000
*    RESPECIFY (GPR14P,GPR01P) UNRSTD;                             0618 02249000
*END IKJEBEUT;                                                     0619 02250000
@EL00018 DS    0H                                                  0619 02251000
@EF00018 DS    0H                                                  0619 02252000
@ER00018 BR    @14                                                 0619 02253000
*/********************************************************************/ 02254000
*/*                                                                  */ 02255000
*/*SEGMENT-                                                          */ 02256000
*/*          RELINENM                                                */ 02257000
*/*                                                                  */ 02258000
*/*FUNCTION-                                                         */ 02259000
*/*          FIND RELATIVE LINE NUMBER FOR NTH LINE                  */ 02260000
*/*                                                                  */ 02261000
*/*OPERATION-                                                        */ 02262000
*/*          THE VARIABLE COUNT CONTAINS THE NUMBER OF RECORDS THAT  */ 02263000
*/*          WE WANT TO MOVE/COPY                                    */ 02264000
*/*                                                                  */ 02265000
*/*          WHEN WE HAVE READ THAT NUMBER OF RECORDS THE VARIABLE   */ 02266000
*/*          THEKEY CONTAINS THE KEY OF THE LAST LINE THAT WILL BE   */ 02267000
*/*          MOVE/COPIED                                             */ 02268000
*/*                                                                  */ 02269000
*/*          IF EOF IS REACHED BEFORE ALL THE RECORDS HAVE BEEN      */ 02270000
*/*          READ THEN THE VARIABLE THEKEY CONTAINS THE KEY OF THE   */ 02271000
*/*          LAST RECORD IN THE DATASET AND THAT KEY IS USED FOR     */ 02272000
*/*          THE KEY OF THE LAST LINE TO BE MOVE/COPIED              */ 02273000
*/*                                                                  */ 02274000
*/*ERRORS-                                                           */ 02275000
*/*          EUTERR---ANY I/O ERRORS DETECTED IN IKJEBEUT            */ 02276000
*/*                                                                  */ 02277000
*/********************************************************************/ 02278000
*                                                                  0620 02279000
*RELINENM:                                                         0620 02280000
*        PROC OPTIONS(NOSAVE);                                     0620 02281000
*                                                                  0620 02282000
RELINENM DS    0H                                                  0621 02283000
*   RESPECIFY GPR14P RSTD;                                         0621 02284000
*   RELINE14 = GPR14P;               /* SAVE REG 14                  */ 02285000
         ST    GPR14P,RELINE14                                     0622 02286000
*   RESPECIFY GPR14P UNRSTD;                                       0623 02287000
*                                                                  0623 02288000
*   UTPARMP = ADDR(READNEXT);        /* READ RECORD AFTER KEY = THEKEY* 02289000
*                                                                  0624 02290000
         LA    UTPARMP,READNEXT                                    0624 02291000
*   DO LOOPCNT = COUNT - ONE TO ONE BY - ONE  /* READ N RECORDS      */ 02292000
*      WHILE (STATUS = CONTINUE); /* WHILE READS ARE SUCCESSFUL      */ 02293000
         L     @08,COUNT                                           0625 02294000
         BCTR  @08,0                                               0625 02295000
         ST    @08,LOOPCNT                                         0625 02296000
         B     @DE00625                                            0625 02297000
@DL00625 LTR   STATUS,STATUS                                       0625 02298000
         BNZ   @DC00625                                            0625 02299000
*                                    /* ... UPPER LIMIT OF MOVE/COPY */ 02300000
*     CALL READ;                    /* READ A RECORD                 */ 02301000
         BAL   @14,READ                                            0626 02302000
*   END;                                                           0627 02303000
*                                                                  0627 02304000
         SLR   @08,@08                                             0627 02305000
         BCTR  @08,0                                               0627 02306000
         AL    @08,LOOPCNT                                         0627 02307000
         ST    @08,LOOPCNT                                         0627 02308000
@DE00625 LTR   @08,@08                                             0627 02309000
         BP    @DL00625                                            0627 02310000
@DC00625 DS    0H                                                  0628 02311000
*   IF STATUS = NORECORD             /* IF NO RECORD FOUND           */ 02312000
*     THEN STATUS = CONTINUE;        /* SET STATUS TO CONTINUE       */ 02313000
*                                                                  0628 02314000
         C     STATUS,@CF00055                                     0628 02315000
         BNE   @RF00628                                            0628 02316000
         SLR   STATUS,STATUS                                       0629 02317000
*   RESPECIFY (GPR14P) RSTD;                                       0630 02318000
@RF00628 DS    0H                                                  0631 02319000
*   GPR14P = RELINE14;               /* RESTORE REG 14               */ 02320000
         L     GPR14P,RELINE14                                     0631 02321000
*   RESPECIFY (GPR14P) UNRSTD;                                     0632 02322000
*                                                                  0632 02323000
*END RELINENM;                                                     0633 02324000
@EL00019 DS    0H                                                  0633 02325000
@EF00019 DS    0H                                                  0633 02326000
@ER00019 BR    @14                                                 0633 02327000
*/********************************************************************/ 02328000
*/*                                                                  */ 02329000
*/*SEGMENT-                                                          */ 02330000
*/*          INCRCHCK                                                */ 02331000
*/*                                                                  */ 02332000
*/*FUNCTION-                                                         */ 02333000
*/*          PARSE VALIDITY CHECK ROUTINE                            */ 02334000
*/*                                                                  */ 02335000
*/*OPERATION-                                                        */ 02336000
*/*          IF NO VALUE WAS ENTERED FOR THE KEYWORD REQUEST THAT    */ 02337000
*/*          PARSE PROMPT THE USER FOR A VALUE                       */ 02338000
*/*                                                                  */ 02339000
*/*          IF THE VALUE THAT WAS ENTERED IS ZERO THEN REQUEST      */ 02340000
*/*          THAT PARSE PROMPT THE USER FOR A NON ZERO VALUE         */ 02341000
*/*                                                                  */ 02342000
*/*          OTHERWISE ACCEPT THE VALUE THAT WAS ENTERED             */ 02343000
*/*                                                                  */ 02344000
*/*ERRORS-                                                           */ 02345000
*/*          N/A                                                     */ 02346000
*/*                                                                  */ 02347000
*/********************************************************************/ 02348000
*                                                                  0634 02349000
*INCRCHCK:                                                         0634 02350000
*        PROC OPTIONS(NOSAVEAREA);                                 0634 02351000
*                                                                  0634 02352000
INCRCHCK STM   @14,@12,12(@13)                                     0634 02353000
*   RESPECIFY (GPR01P,GPR15P) RSTD;                                0635 02354000
*   GPR15P  =GPR01P  ->IWK;         /* GET PTR TO REGS               */ 02355000
         L     GPR15P,IWK(,GPR01P)                                 0636 02356000
*   GEN( LM 2,12,0(15));            /* SET UP REGS FOR VALCK         */ 02357000
*                                                                  0637 02358000
          LM 2,12,0(15)                                                 02359000
*   IF IHERE = NO  |                /* IF NO VALUE ENTERED FOR INCR  */ 02360000
*      VALINCR(1:ILENGTH) =         /* OR THE VALUE IS ZERO          */ 02361000
*          FOXZERO(1:ILENGTH)                                      0638 02362000
*     THEN GPR15P = FOUR;           /* SET RC=4 TO MAKE PARSE PROMPT */ 02363000
*                                                                  0638 02364000
         L     @14,IPDE(,GPR01P)                                   0638 02365000
         TM    IHERE(@14),B'10000000'                              0638 02366000
         BZ    @RT00638                                            0638 02367000
         L     @08,ICHARPTR(,@14)                                  0638 02368000
         LH    @14,ILENGTH(,@14)                                   0638 02369000
         BCTR  @14,0                                               0638 02370000
         EX    @14,@SC01528                                        0638 02371000
         BNE   @RF00638                                            0638 02372000
@RT00638 DS    0H                                                  0639 02373000
         LA    GPR15P,4                                            0639 02374000
*     ELSE DO;                                                     0640 02375000
         B     @RC00638                                            0640 02376000
@RF00638 DS    0H                                                  0641 02377000
*       PACKAREA = FOXZERO;          /* ZERO OUT THE FIELD           */ 02378000
         MVC   PACKAREA(8),FOXZERO                                 0641 02379000
*       PACKAREA(9-ILENGTH:8) =      /* MOVE   INTO THE RIGHT SIDE...*/ 02380000
*           ICHARPTR->VALINCR;       /* ...THE VALUE ENTERED         */ 02381000
         L     @14,IPDE(,GPR01P)                                   0642 02382000
         LA    @08,9                                               0642 02383000
         SH    @08,ILENGTH(,@14)                                   0642 02384000
         LA    @03,PACKAREA-1(@08)                                 0642 02385000
         LCR   @08,@08                                             0642 02386000
         AL    @08,@CF00061                                        0642 02387000
         L     @14,ICHARPTR(,@14)                                  0642 02388000
         EX    @08,@SM01530                                        0642 02389000
*       PACK(PACKAREA,PACKAREA);     /* CONVERT: ZONED TO PACKED     */ 02390000
         PACK  PACKAREA(8),PACKAREA(8)                             0643 02391000
*       CVB(THEINCR,PACKAREA);       /* CONVERT: PACKED TO BINARY    */ 02392000
         CVB   @14,PACKAREA                                        0644 02393000
         ST    @14,THEINCR                                         0644 02394000
*       GPR15P  = ZERO;              /* INDICATE NO PROMPTING NEEDED */ 02395000
         SLR   GPR15P,GPR15P                                       0645 02396000
*       END;                                                       0646 02397000
*                                                                  0646 02398000
*   RETURN CODE(GPR15P  );                                         0647 02399000
@RC00638 L     @14,12(,@13)                                        0647 02400000
         LM    @00,@12,20(@13)                                     0647 02401000
         BR    @14                                                 0647 02402000
*   RESPECIFY (GPR01P,GPR15P) UNRSTD;                              0648 02403000
*                                                                  0648 02404000
*END INCRCHCK;                                                     0649 02405000
*/********************************************************************/ 02406000
*/*                                                                  */ 02407000
*/*SEGMENT-                                                          */ 02408000
*/*          IKJEBESE                                                */ 02409000
*/*                                                                  */ 02410000
*/*FUNCTION-                                                         */ 02411000
*/*          FIND THE RECORD WHICH CONTAINS THE FIRST OCCURANCE OF   */ 02412000
*/*          THE STRING ENTERED AS THE FIRST OPERAND ON THE          */ 02413000
*/*          MOVE/COPY COMMAND.THE SEARCH BEGINS WITH THE CURRENT    */ 02414000
*/*          LINE NUMBER.                                            */ 02415000
*/*                                                                  */ 02416000
*/*OPERATION-                                                        */ 02417000
*/*          PASS THE STRING TO IKJEBELE WHICH IS LINE-EDIT SO IT    */ 02418000
*/*          CAN FOLD THE STRING TO UPPERCASE IF NECESSARY           */ 02419000
*/*                                                                  */ 02420000
*/*          WE HAVE TO PASS THE CURRENT LINE TO IKJEBESE.WE KNOW    */ 02421000
*/*          WHAT THE KEY OF THE FIRST RECORD IN THE DATA SET IS.IF  */ 02422000
*/*          THE CURRENT LINE POINTER IS LESS THAN THE FIRST RECORD  */ 02423000
*/*          THEN WE WILL PASS THE FIRST RECORD IN THE DATA SET TO   */ 02424000
*/*          IKJEBESE.THE CURRENT LINE POINTER CAN BE LESS THAN THE  */ 02425000
*/*          KEY OF THE FIRST RECORD WHEN THE KEY OF THE FIRST       */ 02426000
*/*          RECORD IS GREATER THAN ZERO AND TOP WAS ENTERED WHICH   */ 02427000
*/*          GIVES A CURRENT LINE POINTER OF ZERO.                   */ 02428000
*/*                                                                  */ 02429000
*/*          AFTER OBTAINING THE CURRENT LINE AND INITIALIZING THE   */ 02430000
*/*          PARAMETER LIST FOR IKJEBESE WE CALL IKJEBESE TO FIND    */ 02431000
*/*          THE RECORD WHICH CONTAINS THE STRING THAT WAS ENTERED   */ 02432000
*/*          ON THE MOVE/COPY COMMAND:                               */ 02433000
*/*                                                                  */ 02434000
*/*ERRORS-                                                           */ 02435000
*/*          NOTEXT---QUOTED STRING NOT FOUND                        */ 02436000
*/*          EUTERR---ANY I/O ERRORS DETECTED IN IKJEBEUT            */ 02437000
*/*                                                                  */ 02438000
*/********************************************************************/ 02439000
*IKJEBESE:                                                         0650 02440000
*        PROC;                                                     0650 02441000
*                                                                  0650 02442000
IKJEBESE STM   @14,@05,@SA00021                                    0650 02443000
         STM   @07,@12,@SA00021+32                                 0650 02444000
*    LECODE = DELIMSTR;              /* A DELIMITED STRING           */ 02445000
         MVI   LECODE,X'80'                                        0651 02446000
*    LETXTPTR = ADDR(LETXT);         /*ADDRESS OF THE TEXT           */ 02447000
         LA    @08,LETXT(,COMMREG)                                 0652 02448000
         STCM  @08,7,LETXTPTR                                      0652 02449000
*    LECAPTR = COMMREG;              /*POINTER TO IKJEBECA           */ 02450000
*                                                                  0653 02451000
         ST    COMMREG,LECAPTR                                     0653 02452000
*    LETXTLEN = FIRSTSL + FOUR;      /*LENGTH OF THE STRING + HEADER */ 02453000
         LH    @08,FIRSTSL                                         0654 02454000
         LA    @07,4                                               0654 02455000
         ALR   @07,@08                                             0654 02456000
         STH   @07,LETXTLEN(,COMMREG)                              0654 02457000
*    LETXTTXT(1:FIRSTSL) =           /*MOVE THE STRING TO...         */ 02458000
*        STRNGVAL(1:FIRSTSL);        /*... BE EDITTED                */ 02459000
*                                                                  0655 02460000
         BCTR  @08,0                                               0655 02461000
         L     @07,FIRSTSP                                         0655 02462000
         EX    @08,@SM01532                                        0655 02463000
*    GEN REFS(CAPTLE,LEPLIST)                                      0656 02464000
*     (IKJEBESH (COMMREG),IKJEBELE,PARAM=((COMMREG),LEPLIST),MF=(E,A)); 02465000
*                                                                  0656 02466000
         IKJEBESH (COMMREG),IKJEBELE,PARAM=((COMMREG),LEPLIST),MF=(E,A) 02467000
*    STRNGVAL(1:FIRSTSL) =           /* MOVE EDITTED STRING BACK...  */ 02468000
*        LETXTTXT(1:FIRSTSL);        /*... TO AREA GOTTEN BY PARSE   */ 02469000
*                                                                  0657 02470000
         L     @08,FIRSTSP                                         0657 02471000
         LH    @07,FIRSTSL                                         0657 02472000
         BCTR  @07,0                                               0657 02473000
         EX    @07,@SM01534                                        0657 02474000
*    UTPARMP = ADDR(READPARM);       /* WANT TO READ FROM THE DS     */ 02475000
         LA    UTPARMP,READPARM                                    0658 02476000
*    THEKEY = CACURNUM;              /* WANT TO READ THE CURRENT LINE*/ 02477000
*                                                                  0659 02478000
         L     @08,CACURNUM(,COMMREG)                              0659 02479000
         ST    @08,THEKEY(,COMMREG)                                0659 02480000
*    IF THEKEY < FIRSTREC            /* 0 = CACURNUM < FIRST REC NUM */ 02481000
*      THEN THEKEY = FIRSTREC;       /* WILL REALLY READ FIRST RECRD */ 02482000
*                                                                  0660 02483000
         L     @07,FIRSTREC                                        0660 02484000
         CR    @08,@07                                             0660 02485000
         BNL   @RF00660                                            0660 02486000
         ST    @07,THEKEY(,COMMREG)                                0661 02487000
*    CALL READ;                      /* READ THE CURRENT LINE        */ 02488000
*                                                                  0662 02489000
@RF00660 BAL   @14,READ                                            0662 02490000
*    IF STATUS = CONTINUE |          /* IF READ WAS SUCCESSFUL       */ 02491000
*       STATUS = NORECORD            /* OR RECORD NOT FOUND          */ 02492000
*      THEN DO;                      /* THEN CALL IKJEBESE           */ 02493000
         LTR   STATUS,STATUS                                       0663 02494000
         BZ    @RT00663                                            0663 02495000
         C     STATUS,@CF00055                                     0663 02496000
         BNE   @RF00663                                            0663 02497000
@RT00663 DS    0H                                                  0664 02498000
*        STATUS = CONTINUE;          /* RESET A CONTINUE STATUS      */ 02499000
         SLR   STATUS,STATUS                                       0665 02500000
*        SEDCBPTR=CAPTCDCB;          /*SET PTR TO CURRENT DCB        */ 02501000
         L     @08,CAPTCDCB(,COMMREG)                              0666 02502000
         ST    @08,SEDCBPTR                                        0666 02503000
*        SEOFFS=ZERO;                /*STARTING OFFSET EQUAL ZERO    */ 02504000
         SLR   @08,@08                                             0667 02505000
         STH   @08,SEOFFS                                          0667 02506000
*        SESTRLEN=FIRSTSL;           /*LENGTH OF STRING FROM PARSE   */ 02507000
         LH    @08,FIRSTSL                                         0668 02508000
         STH   @08,SESTRLEN                                        0668 02509000
*        SETXTPTR=ADDR(STRNGVAL);    /* POINT TO EDITTED STRING      */ 02510000
         L     @08,FIRSTSP                                         0669 02511000
         ST    @08,SETXTPTR                                        0669 02512000
*        SEBFRPTR=ADDR(THEBUFFR);    /* BUFFER WITH FIRST RECORD     */ 02513000
         LA    @08,THEBUFFR(,COMMREG)                              0670 02514000
         ST    @08,SEBFRPTR                                        0670 02515000
*        SELNRNGE=ADDR(SEPLISTD);    /* POINT TO RANGE OF LINES      */ 02516000
         LA    @08,SEPLISTD                                        0671 02517000
         ST    @08,SELNRNGE                                        0671 02518000
*        SESTART=CACURNUM;           /*STARTING LINE NUM             */ 02519000
         L     @08,CACURNUM(,COMMREG)                              0672 02520000
         ST    @08,SESTART                                         0672 02521000
*        SEEND= EOF;                 /*MAXIMUM LINE NUMBER           */ 02522000
         MVC   SEEND(4),@CF01325                                   0673 02523000
*        SECHARCT=CALRECL-FOUR;      /* WILL SCAN ENTIRE RECORD      */ 02524000
*                                                                  0674 02525000
         LH    @08,CALRECL(,COMMREG)                               0674 02526000
         SL    @08,@CF00055                                        0674 02527000
         STH   @08,SECHARCT                                        0674 02528000
*        RESPECIFY (GPR15P) RSTD;                                  0675 02529000
*        GENERATE REFS(COMMREG)                                    0676 02530000
*        (IKJEBESH ,IKJEBESE,PARAM=((COMMREG),SEPLIST),MF=(E,SEPLIST)); 02531000
         IKJEBESH ,IKJEBESE,PARAM=((COMMREG),SEPLIST),MF=(E,SEPLIST)    02532000
*        SERETCD = GPR15P;           /* SAVE IKJEBESE RET CODE       */ 02533000
         ST    GPR15P,SERETCD                                      0677 02534000
*        RESPECIFY (GPR15P) UNRSTD;                                0678 02535000
*                                                                  0678 02536000
*        IF SECODE = ZERO |          /* IF ZERO CODE FROM SE OR ...  */ 02537000
*           SECODE = FOUR            /* ... CODE OF FOUR             */ 02538000
*         THEN FIRSTKEY = THEKEY; /* USE KEY OF REC FOR FIRST        */ 02539000
         CLI   SECODE,0                                            0679 02540000
         BE    @RT00679                                            0679 02541000
         CLI   SECODE,4                                            0679 02542000
         BNE   @RF00679                                            0679 02543000
@RT00679 DS    0H                                                  0680 02544000
         L     @08,THEKEY(,COMMREG)                                0680 02545000
         ST    @08,FIRSTKEY                                        0680 02546000
*         ELSE STATUS = NOTEXT;  /* INDICATE TEXT NOT FOUND          */ 02547000
         B     @RC00679                                            0681 02548000
@RF00679 L     STATUS,NOTEXT                                       0681 02549000
*       END;                                                       0682 02550000
*                                                                  0682 02551000
*END IKJEBESE;                                                     0683 02552000
@EL00021 DS    0H                                                  0683 02553000
@EF00021 DS    0H                                                  0683 02554000
@ER00021 LM    @14,@05,@SA00021                                    0683 02555000
         LM    @07,@12,@SA00021+32                                 0683 02556000
         BR    @14                                                 0683 02557000
*/********************************************************************/ 02558000
*/*                                                                  */ 02559000
*/*SEGMENT-                                                          */ 02560000
*/*          CLEANUP                                                 */ 02561000
*/*                                                                  */ 02562000
*/*FUNCTION-                                                         */ 02563000
*/*          FREE CORE AND DATASETS,ETC.                             */ 02564000
*/*                                                                  */ 02565000
*/*OPERATION-                                                        */ 02566000
*/*          FREE THE PARSE DESCRIPTOR LIST IF GOTTEN.THE POINTER    */ 02567000
*/*          TO THE PDL WAS INITIALIZED TO ZERO IN INIT.             */ 02568000
*/*                                                                  */ 02569000
*/*          IF WE GOT A SECOND UTILITY DATA SET THEN WE HAVE AN     */ 02570000
*/*          EXTRA DCB THAT NEEDS TO BE DELETED.IF THERE ARE NO      */ 02571000
*/*          ERRORS THEN WE WILL SWITCH THE DCB POINTERS SO THAT     */ 02572000
*/*          IKJEBEEX CAN DELETE THE CURRENT DATASET AND WE CAN      */ 02573000
*/*          KEEP THE SECONDARY DATASET                              */ 02574000
*/*                                                                  */ 02575000
*/*          IF THERE ARE NO ERRORS AND THE VERIFY SWITCH IS ON      */ 02576000
*/*          THEN GET THE LINE TO BE VERIFIED.                       */ 02577000
*/*                                                                  */ 02578000
*/*ERRORS-                                                           */ 02579000
*/*          VERERROR---THIS ERROR SHOULD NOT OCCUR,IT MEANS TROUBLE */ 02580000
*/*                                                                  */ 02581000
*/********************************************************************/ 02582000
*CLEANUP:                                                          0684 02583000
*        PROC OPTIONS(NOSAVE);                                     0684 02584000
*                                                                  0684 02585000
CLEANUP  DS    0H                                                  0685 02586000
*    RESPECIFY (GPR14P) RSTD;                                      0685 02587000
*    CLEANU14 = GPR14P;              /* SAVE REG 14                  */ 02588000
         ST    GPR14P,CLEANU14                                     0686 02589000
*    RESPECIFY (GPR14P) UNRSTD;                                    0687 02590000
*                                                                  0687 02591000
*    RESPECIFY (GPR01P) RSTD;                                      0688 02592000
*    GPR01P = ADDR(CAPTPRSD);        /* GET ADDR OF PDL POINTER      */ 02593000
         LA    GPR01P,CAPTPRSD(,COMMREG)                           0689 02594000
*    GEN REFS(GPR01P) (IKJRLSA (1)); /* FREE THE PDL                 */ 02595000
         IKJRLSA (1)                                                    02596000
*    RESPECIFY (GPR01P) UNRSTD;                                    0691 02597000
*                                                                  0691 02598000
*    CAFREEDL = FREED;               /* INDICATE PDL IS FREED        */ 02599000
*                                                                  0692 02600000
         OI    CAFREEDL(COMMREG),B'10000000'                       0692 02601000
*    IF SECONDDS = YES               /* DID WE GET A SECOND UTIL DS  */ 02602000
*      THEN DO;                      /*   YES - WE HAVE TWO UTIL DS  */ 02603000
         TM    SECONDDS,B'10000000'                                0693 02604000
         BNO   @RF00693                                            0693 02605000
*        IF STATUS = CONTINUE        /* IF EVERYTHING GONE OK        */ 02606000
*          THEN DO;                  /* THEN SWITCH THE DCB POINTERS */ 02607000
         LTR   STATUS,STATUS                                       0695 02608000
         BNZ   @RF00695                                            0695 02609000
*            TEMP = CAPTCDCB;        /* SAVE OLD DCB PTR             */ 02610000
         L     TEMP,CAPTCDCB(,COMMREG)                             0697 02611000
*            CAPTCDCB = CAPTPDCB;    /* SET OLD TO NEW               */ 02612000
         L     @08,CAPTPDCB(,COMMREG)                              0698 02613000
         ST    @08,CAPTCDCB(,COMMREG)                              0698 02614000
*            CAPTPDCB = TEMP;        /* NOW WE CAN DELETE THE OLD    */ 02615000
         ST    TEMP,CAPTPDCB(,COMMREG)                             0699 02616000
*            END;                                                  0700 02617000
*                                                                  0700 02618000
*        RESPECIFY (GPR00P) RSTD;                                  0701 02619000
@RF00695 DS    0H                                                  0702 02620000
*        GPR00P = CAPTPDCB;          /* FREE THE THE DCB''S DATA SET */ 02621000
         L     GPR00P,CAPTPDCB(,COMMREG)                           0702 02622000
*        GEN REFS(COMMREG)           /* DELETE A UTILITY DATA SET    */ 02623000
*          (IKJEBESH (COMMREG),IKJEBEEX,PARAM=((COMMREG)),MF=(E,X));    02624000
         IKJEBESH (COMMREG),IKJEBEEX,PARAM=((COMMREG)),MF=(E,X)         02625000
*        RESPECIFY (GPR00P) UNRSTD;                                0704 02626000
*        END;                                                      0705 02627000
*                                                                  0705 02628000
*    IF STATUS = CONTINUE            /* EVERYTHING OK THIS FAR       */ 02629000
*      THEN DO;                      /* EVERYTHING IS OK SO FAR      */ 02630000
@RF00693 LTR   STATUS,STATUS                                       0706 02631000
         BNZ   @RF00706                                            0706 02632000
*        CACURNUM = VERIFY;          /* CHANGE THE CURRENT LINE PTR  */ 02633000
         L     @08,VERIFY                                          0708 02634000
         ST    @08,CACURNUM(,COMMREG)                              0708 02635000
*        IF CAVRFYSW = YES           /* AND WE WANT TO VERIFY LINE   */ 02636000
*          THEN DO;                  /* GET LINE TO BE VARIFIED      */ 02637000
         TM    CAVRFYSW(COMMREG),B'01000000'                       0709 02638000
         BNO   @RF00709                                            0709 02639000
*          CALNTOVF = YES;           /* TURN ON LINE TO VERIFY SW    */ 02640000
         OI    CALNTOVF(COMMREG),B'10000000'                       0711 02641000
*          UTPARMP = ADDR(READPARM);  /* WANT TO READ A SPECIFIC KEY  * 02642000
         LA    UTPARMP,READPARM                                    0712 02643000
*          THEKEY = VERIFY;          /* USE THIS KEY FOR VERIFIED LN */ 02644000
         ST    @08,THEKEY(,COMMREG)                                0713 02645000
*          UTDCBPTR = CAPTCDCB;      /* WE MAY A NEW DCB POINTER     */ 02646000
         MVC   UTDCBPTR(3,UTPARMP),CAPTCDCB+1(COMMREG)             0714 02647000
*          UTBUFPTR = ADDR(CATEMPBF) + /* THE BUFFER TO GET THE LINE */ 02648000
*                     12;            /* PLUS THIS MAGIC NUMBER       */ 02649000
         LA    @08,CATEMPBF(,COMMREG)                              0715 02650000
         AL    @08,@CF00034                                        0715 02651000
         ST    @08,UTBUFPTR(,UTPARMP)                              0715 02652000
*          UTEOL3 = YES;             /* INDICATE END OF LIST         */ 02653000
         OI    UTEOL3(UTPARMP),B'10000000'                         0716 02654000
*          CALL READ;                /* READ THE LINE                */ 02655000
*                                                                  0717 02656000
         BAL   @14,READ                                            0717 02657000
*          IF STATUS ^= CONTINUE     /* IF READ IS BAD               */ 02658000
*            THEN DO;                /* HANDLE VERIFY ERROR          */ 02659000
         LTR   STATUS,STATUS                                       0718 02660000
         BZ    @RF00718                                            0718 02661000
*              STATUS = VERERROR;    /* INDICATE VERIFY ERROR        */ 02662000
         L     STATUS,VERERROR                                     0720 02663000
*              CALNTOVF = NO;        /* INDICATE DON''T VERIFY       */ 02664000
         NI    CALNTOVF(COMMREG),B'01111111'                       0721 02665000
*              END;                                                0722 02666000
*          END;                                                    0723 02667000
@RF00718 DS    0H                                                  0724 02668000
*        END;                                                      0724 02669000
*                                                                  0724 02670000
@RF00709 DS    0H                                                  0725 02671000
*    RESPECIFY (GPR14P) RSTD;                                      0725 02672000
@RF00706 DS    0H                                                  0726 02673000
*    GPR14P = CLEANU14;              /* RESTORE REG 14               */ 02674000
         L     GPR14P,CLEANU14                                     0726 02675000
*    RESPECIFY (GPR14P) UNRSTD;                                    0727 02676000
*                                                                  0727 02677000
*END CLEANUP;                                                      0728 02678000
@EL00022 DS    0H                                                  0728 02679000
@EF00022 DS    0H                                                  0728 02680000
@ER00022 BR    @14                                                 0728 02681000
*/********************************************************************/ 02682000
*/*                                                                  */ 02683000
*/*SEGMENT-                                                          */ 02684000
*/*          HANDLERR                                                */ 02685000
*/*                                                                  */ 02686000
*/*FUNCTION-                                                         */ 02687000
*/*          HANDLE THE MOVE/COPY ERROR THAT MAY HAVE OCCURRED       */ 02688000
*/*                                                                  */ 02689000
*/*OPERATION-                                                        */ 02690000
*/*      STATUS<ZERO-                                                */ 02691000
*/*          IMPLIES STATUS=MSG W/O ASSOCIATED INSERTIONS            */ 02692000
*/*                                                                  */ 02693000
*/*      STATUS=ZERO-                                                */ 02694000
*/*          HANDLERR DOES NOT GET CONTROL                           */ 02695000
*/*                                                                  */ 02696000
*/*      STATUS>ZERO-                                                */ 02697000
*/*           PARSE ERROR-                                           */ 02698000
*/*               STATUS=GETMERR=MSG52312                            */ 02699000
*/*               STATUS=NOT ZERO AND NOT 4=MSG52313                 */ 02700000
*/*                                                                  */ 02701000
*/********************************************************************/ 02702000
*HANDLERR:                                                         0729 02703000
*        PROC OPTIONS(NOSAVE);                                     0729 02704000
*                                                                  0729 02705000
HANDLERR DS    0H                                                  0730 02706000
*    RESPECIFY (GPR14P) RSTD;                                      0730 02707000
*    HANDLE14 = GPR14P;              /* SAVE REG 14                  */ 02708000
         LR    HANDLE14,GPR14P                                     0731 02709000
*    RESPECIFY (GPR14P) UNRSTD;                                    0732 02710000
*                                                                  0732 02711000
*    EMSPARMS = EMSPARMS && EMSPARMS;/* ZERO OUT PARM LIST FOR EBESE */ 02712000
*                                                                  0733 02713000
         XC    EMSPARMS(12),EMSPARMS                               0733 02714000
*    IF STATUS < ZERO                /* STATUS = A MESSAGE NUMBER    */ 02715000
*      THEN EMSMSG1 = ZERO - STATUS; /* MAKE NUMBER POSITIVE         */ 02716000
*                                                                  0734 02717000
*                                                                  0734 02718000
         SLR   @08,@08                                             0734 02719000
         CR    STATUS,@08                                          0734 02720000
         BNL   @RF00734                                            0734 02721000
         SLR   @08,STATUS                                          0735 02722000
         STH   @08,EMSMSG1                                         0735 02723000
*      ELSE                          /* STATUS NOT EQUAL MSG NUMBER  */ 02724000
*      IF PARSERR = YES              /* WAS IT A PARSE ERROR         */ 02725000
*        THEN                        /* YES A PARSE ERROR            */ 02726000
         B     @RC00734                                            0736 02727000
@RF00734 TM    PARSERR,B'01000000'                                 0736 02728000
         BNO   @RF00736                                            0736 02729000
*        IF STATUS = GETMERR         /* IS IT A GETMAIN ERROR        */ 02730000
*          THEN DO;                  /* SET UP FOR GETMAIN ERROR     */ 02731000
         C     STATUS,@CF00863                                     0737 02732000
         BNE   @RF00737                                            0737 02733000
*            EMSMSG1 = MSG52312;     /* SET THE ERROR MESSAGE NUMBER */ 02734000
         LH    @08,MSG52312                                        0739 02735000
         STH   @08,EMSMSG1                                         0739 02736000
*            EMSINS1 = ADDR(TXTCMND);/* POINT  TO TEXT INSERTION */     02737000
         LA    @08,TXTCMND                                         0740 02738000
         ST    @08,EMSINS1                                         0740 02739000
*            END;                                                  0741 02740000
*                                                                  0741 02741000
*                                                                  0741 02742000
*          ELSE DO;                  /* HANDLE OTHER PARSE ERRORS    */ 02743000
         B     @RC00737                                            0742 02744000
@RF00737 DS    0H                                                  0743 02745000
*            EMSMSG1 = MSG52313;     /* SET THE MSG NUMBER           */ 02746000
         LH    @08,MSG52313                                        0743 02747000
         STH   @08,EMSMSG1                                         0743 02748000
*            EMSMSG2 = ONE;          /* SECOND LEVEL MSG EXISTS      */ 02749000
         MVC   EMSMSG2(2),@CH00063                                 0744 02750000
*            EMSINS2 = ADDR(EMSTXT1);/* POINT  TO TXT INSERTIONS */     02751000
*                                                                  0745 02752000
         LA    @08,EMSTXT1                                         0745 02753000
         ST    @08,EMSINS2                                         0745 02754000
*            RESPECIFY TXTMAP BASED(ADDR(EMSTXT1));                0746 02755000
*            TXTMAP = TXTPARS;       /* INIT PARSE TEXT INSERTION    */ 02756000
         MVI   TXTMAP+13(@08),C' '                                 0747 02757000
         MVC   TXTMAP+14(242,@08),TXTMAP+13(@08)                   0747 02758000
         MVC   TXTMAP(13,@08),TXTPARS                              0747 02759000
*            TXTNEXT = ADDR(EMSTXT2);/* THE  NEXT TEXT INSERTION */     02760000
*                                                                  0748 02761000
         LA    @07,EMSTXT2                                         0748 02762000
         ST    @07,TXTNEXT(,@08)                                   0748 02763000
*            RESPECIFY TXTMAP BASED(ADDR(EMSTXT2));                0749 02764000
*            TXTMAP(1:LENGTH(TXTRC)) = TXTRC; /* RC TXT INSERT       */ 02765000
         MVC   TXTMAP(10,@07),TXTRC                                0750 02766000
*            CVD(STATUS,PACKAREA);            /* BINARY -> PACKED    */ 02767000
         CVD   STATUS,PACKAREA                                     0751 02768000
*            UNPK(TXTTXT(1:2),PACKAREA);      /* PACKED TO ZONED     */ 02769000
         UNPK  TXTTXT(2,@07),PACKAREA(8)                           0752 02770000
*            TXTTXT(2) = TXTTXT(2) | FOXZERO(1); /*'C4'X -> 'F4'X*/     02771000
         OC    TXTTXT+1(1,@07),FOXZERO                             0753 02772000
*            RESPECIFY TXTMAP BASED;                               0754 02773000
*            END;                                                  0755 02774000
*/********************************************************************/ 02775000
*/*                                                                  */ 02776000
*/*SEGMENT-                                                          */ 02777000
*/*          HANDLERR PART 2                                         */ 02778000
*/*                                                                  */ 02779000
*/*      STATUS>ZERO CONTINUED-                                      */ 02780000
*/*           IKJEBEDC ERROR-                                        */ 02781000
*/*               STATUS=FOUR=MSG52501                               */ 02782000
*/*               STATUS^=FOUR=TERMINATE W/O ERROR MSG               */ 02783000
*/*                                                                  */ 02784000
*/*           IKJEBEMR ERROR-                                        */ 02785000
*/*               STATUS=8,THEN RETCODE=16,NO MSG                    */ 02786000
*/*               STATUS^=8 AND RETCODE=0,THEN RETCODE=8,NO MSG      */ 02787000
*/*                                                                  */ 02788000
*/*      STATUS=PTR TO TEXT INSERTION-                               */ 02789000
*/*          FOR MSG52579                                            */ 02790000
*/*                                                                  */ 02791000
*/********************************************************************/ 02792000
*                                                                  0756 02793000
*      ELSE                          /* CHECK FOR OTHER ERRORS       */ 02794000
*      IF DCERROR = YES              /* CHECK FOR ERRORS IN IKJEBEDC */ 02795000
*        THEN                        /* YES ERRORS IN IKJEBEDC       */ 02796000
         B     @RC00736                                            0756 02797000
@RF00736 TM    DCERROR,B'00100000'                                 0756 02798000
         BNO   @RF00756                                            0756 02799000
*        IF STATUS = FOUR            /* IF IKJEBEDC RC = 4           */ 02800000
*          THEN DO;                  /* HANDLE RC 4 ERROR IN IKJEBEDC*/ 02801000
         C     STATUS,@CF00055                                     0757 02802000
         BNE   @RF00757                                            0757 02803000
*            RETCODE = EIGHT;        /* SET RETURN CODE TO 8         */ 02804000
         MVC   RETCODE(4),@CF00061                                 0759 02805000
*            EMSMSG1 = - MSG52501;   /* EMPTY DATASET MESSAGE        */ 02806000
         LH    @08,MSG52501                                        0760 02807000
         LCR   @08,@08                                             0760 02808000
         STH   @08,EMSMSG1                                         0760 02809000
*            END;                                                  0761 02810000
*                                                                  0761 02811000
*          ELSE STATUS = TERMNOER;   /* TERMINATE W/O ERR MSG        */ 02812000
*                                                                  0762 02813000
         B     @RC00757                                            0762 02814000
@RF00757 LA    STATUS,32                                           0762 02815000
*        ELSE                        /* CHECK FOR ERROR IN IKJEBEMR  */ 02816000
*        IF MRERROR = YES            /* IS THERE ERROR IN IKJEBEMR   */ 02817000
*          THEN DO;                  /* YES ERROR IN IKJEBEMR        */ 02818000
         B     @RC00756                                            0763 02819000
@RF00756 TM    MRERROR,B'00010000'                                 0763 02820000
         BNO   @RF00763                                            0763 02821000
*            IF STATUS = EIGHT       /* WAS RC FROM IKJEBEMR = 8     */ 02822000
*              THEN RETCODE = SIXTEEN; /* SET RETURN CODE TO 16      */ 02823000
*                                                                  0765 02824000
         C     STATUS,@CF00061                                     0765 02825000
         BNE   @RF00765                                            0765 02826000
         MVC   RETCODE(4),@CF00863                                 0766 02827000
*              ELSE                                                0767 02828000
*              IF RETCODE = ZERO     /* IF NO PREVIOUS BAD RETCODES  */ 02829000
*                THEN RETCODE = EIGHT;  /* THEN SET RETURN CODE = 8  */ 02830000
*                                                                  0767 02831000
         B     @RC00765                                            0767 02832000
@RF00765 L     @08,RETCODE                                         0767 02833000
         LTR   @08,@08                                             0767 02834000
         BNZ   @RF00767                                            0767 02835000
         MVC   RETCODE(4),@CF00061                                 0768 02836000
*            STATUS = TERMNOER;         /* TERM W/O ERROR MSG        */ 02837000
@RF00767 DS    0H                                                  0769 02838000
@RC00765 LA    STATUS,32                                           0769 02839000
*            END;                                                  0770 02840000
*                                                                  0770 02841000
*        ELSE DO;                    /* MUST BE MESSAGE IKJ52579     */ 02842000
         B     @RC00763                                            0771 02843000
@RF00763 DS    0H                                                  0772 02844000
*          EMSMSG1 = MSG52579;       /* SET  MESSAGE NUMBER          */ 02845000
         LH    @08,MSG52579                                        0772 02846000
         STH   @08,EMSMSG1                                         0772 02847000
*          EMSINS1 = STATUS;         /* GET ADDR OF TEXT INSERTION   */ 02848000
         ST    STATUS,EMSINS1                                      0773 02849000
*          END;                                                    0774 02850000
*                                                                  0774 02851000
*    IF STATUS ^= TERMNOER           /* IF WE SHOULD SEND MSG        */ 02852000
*      THEN DO;                      /* SEND ERR MSG VIA IKJEBEMS    */ 02853000
@RC00763 DS    0H                                                  0775 02854000
@RC00756 DS    0H                                                  0775 02855000
@RC00736 DS    0H                                                  0775 02856000
@RC00734 C     STATUS,@CF00890                                     0775 02857000
         BE    @RF00775                                            0775 02858000
*        GENERATE REFS(CAPTMS,EMSPARMS) (IKJEBEML ,,,,MF=(E,EMSPARMS)); 02859000
         IKJEBEML ,,,,MF=(E,EMSPARMS)                                   02860000
*        STATUS = CONTINUE;          /* INDICATE CONTINUE STATUS     */ 02861000
         SLR   STATUS,STATUS                                       0778 02862000
*        END;                                                      0779 02863000
*                                                                  0779 02864000
*    RESPECIFY (GPR14P) RSTD;                                      0780 02865000
@RF00775 DS    0H                                                  0781 02866000
*    GPR14P = HANDLE14;              /* RESTORE REG 14               */ 02867000
         LR    GPR14P,HANDLE14                                     0781 02868000
*    RESPECIFY (GPR14P) UNRSTD;                                    0782 02869000
*                                                                  0782 02870000
*END HANDLERR;                                                     0783 02871000
@EL00023 DS    0H                                                  0783 02872000
@EF00023 DS    0H                                                  0783 02873000
@ER00023 BR    @14                                                 0783 02874000
*/********************************************************************/ 02875000
*/*                                                                  */ 02876000
*/*SEGMENT-                                                          */ 02877000
*/*          IPLI EXIT                                               */ 02878000
*/*                                                                  */ 02879000
*/*FUNCTION-                                                         */ 02880000
*/*          INVOKE IKJEBEMR TO ELETE THE OLD POLISH DATSET AND      */ 02881000
*/*          BUILD A NEW ONE                                         */ 02882000
*/*                                                                  */ 02883000
*/*OPERATION-                                                        */ 02884000
*/*          IF A SECOND DATASET WAS BUILT THEN SWITCH THE DCB       */ 02885000
*/*          POINTERS SO IKJEBEMR WILL PROCESS THE SECOND ONE.       */ 02886000
*/*          IKJEBEMR WILL USE CAPTCDCB TO IDENTIFY THE DATASET.     */ 02887000
*/*                                                                  */ 02888000
*/*          INVOKE IKJEBEMR TO BUILD A NEW POLISH DATASET           */ 02889000
*/*                                                                  */ 02890000
*/*          IF A SECOND DATASET WAS BUILT THEN SWITCH THE DCB PTRS  */ 02891000
*/*          BACK TO THERE ORIGINAL VALUES                           */ 02892000
*/*                                                                  */ 02893000
*/*ERRORS-                                                           */ 02894000
*/*          MRERROR---AN ERROR OCCURRED IN IKJEBEMR                 */ 02895000
*/*                                                                  */ 02896000
*/********************************************************************/ 02897000
*                                                                  0784 02898000
*IPLIEXIT:                                                         0784 02899000
*        PROC OPTIONS(NOSAVE);                                     0784 02900000
*                                                                  0784 02901000
IPLIEXIT DS    0H                                                  0785 02902000
*   RESPECIFY (GPR14P) RSTD;                                       0785 02903000
*   IPLIEX14 = GPR14P;               /* SAVE REG 14                  */ 02904000
         LR    IPLIEX14,GPR14P                                     0786 02905000
*   RESPECIFY (GPR14P) UNRSTD;                                     0787 02906000
*                                                                  0787 02907000
*   IF SECONDDS = YES                /* IS THERE SECOND UTILITY DS   */ 02908000
*     THEN DO;                       /* SWITCH DCB POINTERS          */ 02909000
         TM    SECONDDS,B'10000000'                                0788 02910000
         BNO   @RF00788                                            0788 02911000
*       TEMP = CAPTCDCB;             /* SAVE CURRENT DCB POINTER     */ 02912000
         L     TEMP,CAPTCDCB(,COMMREG)                             0790 02913000
*       CAPTCDCB = CAPTPDCB;         /* CHANGE CURRENT DCB POINTER   */ 02914000
         L     @08,CAPTPDCB(,COMMREG)                              0791 02915000
         ST    @08,CAPTCDCB(,COMMREG)                              0791 02916000
*       CAPTPDCB = TEMP;             /* SAVE CURRENT DCB POINTER     */ 02917000
         ST    TEMP,CAPTPDCB(,COMMREG)                             0792 02918000
*       END;                                                       0793 02919000
*                                                                  0793 02920000
*   RESPECIFY (GPR15P) RSTD;                                       0794 02921000
@RF00788 DS    0H                                                  0795 02922000
*   GEN(IKJEBESH (COMMREG),IKJEBEMR,PARAM=((COMMREG)),MF=(E,X));   0795 02923000
         IKJEBESH (COMMREG),IKJEBEMR,PARAM=((COMMREG)),MF=(E,X)         02924000
*   STATUS = GPR15P;                 /* SAVE IKJEBEMR RETURN CODE    */ 02925000
         LR    STATUS,GPR15P                                       0796 02926000
*   RESPECIFY (GPR15P) UNRSTD;                                     0797 02927000
*                                                                  0797 02928000
*   IF SECONDDS = YES                /* IS THERE SECOND UTILITY DS   */ 02929000
*     THEN DO;                       /* SWITCH DCB POINTERS BACK     */ 02930000
         TM    SECONDDS,B'10000000'                                0798 02931000
         BNO   @RF00798                                            0798 02932000
*       TEMP = CAPTCDCB;             /* SAVE CURRENT DCB POINTER     */ 02933000
         L     TEMP,CAPTCDCB(,COMMREG)                             0800 02934000
*       CAPTCDCB = CAPTPDCB;         /* CHANGE CURRENT DCB POINTER   */ 02935000
         L     @08,CAPTPDCB(,COMMREG)                              0801 02936000
         ST    @08,CAPTCDCB(,COMMREG)                              0801 02937000
*       CAPTPDCB = TEMP;             /* SAVE CURRENT DCB POINTER     */ 02938000
         ST    TEMP,CAPTPDCB(,COMMREG)                             0802 02939000
*       END;                                                       0803 02940000
*                                                                  0803 02941000
*   IF STATUS ^= CONTINUE            /* IF ERROR IN IKJEBEMR         */ 02942000
*     THEN MRERROR = YES;            /* INDICATE ERROR IN IKJEBEMR   */ 02943000
*                                                                  0804 02944000
@RF00798 LTR   STATUS,STATUS                                       0804 02945000
         BZ    @RF00804                                            0804 02946000
         OI    MRERROR,B'00010000'                                 0805 02947000
*   RESPECIFY (GPR14P) RSTD;                                       0806 02948000
@RF00804 DS    0H                                                  0807 02949000
*   GPR14P = IPLIEX14;               /* RESTORE REG 14               */ 02950000
         LR    GPR14P,IPLIEX14                                     0807 02951000
*   RESPECIFY (GPR14P) UNRSTD;                                     0808 02952000
*                                                                  0808 02953000
*END IPLIEXIT;                                                     0809 02954000
@EL00024 DS    0H                                                  0809 02955000
@EF00024 DS    0H                                                  0809 02956000
@ER00024 BR    @14                                                 0809 02957000
*/********************************************************************/ 02958000
*/*                                                                  */ 02959000
*/*SEGMENT-                                                          */ 02960000
*/*          DATAEXIT PART 1                                         */ 02961000
*/*                                                                  */ 02962000
*/*FUNCTION-                                                         */ 02963000
*/*          SET UP THE PARAMETERS THAT WILL BE USED BY THE          */ 02964000
*/*          INSTALLATION DATA EXIT                                  */ 02965000
*/*                                                                  */ 02966000
*/*OPERATION-                                                        */ 02967000
*/*          INVOKE IKJEBEDC TO BUILD AN INCORE DATASET AND TO INIT  */ 02968000
*/*          A PARM LIST DESCRIBING THE INCORE DATASET.              */ 02969000
*/*                                                                  */ 02970000
*/********************************************************************/ 02971000
*                                                                  0810 02972000
*DATAEXIT:                                                         0810 02973000
*        PROC OPTIONS(NOSAVE);                                     0810 02974000
*                                                                  0810 02975000
DATAEXIT DS    0H                                                  0811 02976000
*   RESPECIFY (GPR14P) RSTD;                                       0811 02977000
*   DATAEX14 = GPR14P;               /* SAVE REG 14                  */ 02978000
         LR    DATAEX14,GPR14P                                     0812 02979000
*   RESPECIFY (GPR14P) UNRSTD;                                     0813 02980000
*                                                                  0813 02981000
*   DCCAPTR = COMMREG;               /* SET POINTER TO IKJEBECA      */ 02982000
         ST    COMMREG,DCCAPTR                                     0814 02983000
*   DCOUTPTR = ADDR(DSINFO);         /* POINT TO IKJEBEDC OUTPUT AREA*/ 02984000
*                                                                  0815 02985000
         LA    @06,DSINFO                                          0815 02986000
         ST    @06,DCOUTPTR                                        0815 02987000
*   RESPECIFY (GPR00P,GPR01P) RSTD;                                0816 02988000
*   GPR00P = FOUR;                   /* ENTRY CODE FOR IKJEBEDC      */ 02989000
         LA    GPR00P,4                                            0817 02990000
*   GPR01P = ADDR(DCPARMS);          /* POINT TO IKJEBEDC PARM LIST  */ 02991000
         LA    GPR01P,DCPARMS                                      0818 02992000
*   DO; /* LINK  EP('IKJEBEDC') */                                 0819 02993000
*   I00601 ='00'X; /*EP/DE FLAG*/                                  0820 02994000
         MVI   I00601,X'00'                                        0820 02995000
*   I00602 =ADDR('IKJEBEDC');/*ADDR OF EP/DE*/                     0821 02996000
         LA    @03,@CC01494                                        0821 02997000
         STCM  @03,7,I00602                                        0821 02998000
*   I00604 = 0;/*DCB PTR*/                                         0822 02999000
         SLR   @03,@03                                             0822 03000000
         STCM  @03,7,I00604                                        0822 03001000
*   I00603 = '00'X;/*ERRET FLAG*/                                  0823 03002000
         MVI   I00603,X'00'                                        0823 03003000
*   RESPECIFY(GPR15P) RESTRICTED;                                  0824 03004000
*   GPR15P=ADDR(I006);/*ADDR OF LINK LIST*/                        0825 03005000
         LA    GPR15P,I006                                         0825 03006000
*   SVC (6);/*ISSUE LINK SVC*/                                     0826 03007000
         SVC   6                                                   0826 03008000
*   RESPECIFY(GPR15P) UNRESTRICTED;                                0827 03009000
*   END; /* LINK  EP('IKJEBEDC') */                                0828 03010000
*   RESPECIFY (GPR15P) RSTD;                                       0829 03011000
*                                                                  0829 03012000
*   STATUS = GPR15P;                 /* SAVE RET CODE FROM IKJEBEDC  */ 03013000
         LR    STATUS,GPR15P                                       0830 03014000
*   RESPECIFY (GPR00P,GPR01P,GPR15P) UNRSTD;                       0831 03015000
*/********************************************************************/ 03016000
*/*                                                                  */ 03017000
*/*SEGMENT-                                                          */ 03018000
*/*          DATAEXIT PART 2                                         */ 03019000
*/*                                                                  */ 03020000
*/*OPERATION CONTINUED-                                              */ 03021000
*/*          BUILD THE PARAMETER LIST FOR IKJEBEDX AND INVOKE        */ 03022000
*/*          IKJEBEDX WHICH WILL INTUN INVOKE THE INSTALLATION       */ 03023000
*/*          DATAEXT ROUTINE.                                        */ 03024000
*/*                                                                  */ 03025000
*/********************************************************************/ 03026000
*                                                                  0832 03027000
*   IF STATUS ^= CONTINUE            /* IF AN ERROR IN IKJEBEDC      */ 03028000
*     THEN DCERROR = YES;            /* INDICATE ERROR IN IKJEBEDC   */ 03029000
*                                                                  0832 03030000
         LTR   STATUS,STATUS                                       0832 03031000
         BZ    @RF00832                                            0832 03032000
         OI    DCERROR,B'00100000'                                 0833 03033000
*     ELSE DO;                       /* INVOKE DATA EXIT             */ 03034000
         B     @RC00832                                            0834 03035000
@RF00832 DS    0H                                                  0835 03036000
*       EXUPTPTR=CAPTUPT;            /* PT TO UPT                    */ 03037000
         L     @06,CAPTUPT(,COMMREG)                               0835 03038000
         ST    @06,EXUPTPTR                                        0835 03039000
*       EXECTPTR=CAPTECT;            /* PT TO ECT                    */ 03040000
         L     @06,CAPTECT(,COMMREG)                               0836 03041000
         ST    @06,EXECTPTR                                        0836 03042000
*       EXEDAECB=CAPTECB;            /* PT TO ATTN ECB               */ 03043000
         L     @06,CAPTECB(,COMMREG)                               0837 03044000
         ST    @06,EXEDAECB                                        0837 03045000
*       EXFLAGS(1) = ZERO;           /* DEFAULT FLAGS TO ZERO        */ 03046000
*                                                                  0838 03047000
         MVI   EXFLAGS,X'00'                                       0838 03048000
*       IF CASEQCOL = YES            /* NON STD LINE NUMBERS         */ 03049000
*         THEN EXBIT0 = YES;         /* INDICATE NON STD LINE #S     */ 03050000
*                                                                  0839 03051000
         TM    CASEQCOL(COMMREG),B'00001000'                       0839 03052000
         BNO   @RF00839                                            0839 03053000
         OI    EXBIT0,B'10000000'                                  0840 03054000
*       IF COMMAND = MOVE            /* IF THIS IS MOVE              */ 03055000
*         THEN EXBIT2 = YES;         /* THEN TURN ON THE MOVE BIT    */ 03056000
@RF00839 CLI   COMMAND,1                                           0841 03057000
         BNE   @RF00841                                            0841 03058000
         OI    EXBIT2,B'00100000'                                  0842 03059000
*         ELSE EXBIT3 = YES;         /* ELSE TURN ON COPY BIT        */ 03060000
*                                                                  0843 03061000
         B     @RC00841                                            0843 03062000
@RF00841 OI    EXBIT3,B'00010000'                                  0843 03063000
*       IF CARECFM = NO              /* IF RECORDS ARE VARIABLE      */ 03064000
*         THEN EXBIT5 = YES;         /* INDICATE RECS ARE VARIABLE   */ 03065000
*                                                                  0844 03066000
@RC00841 TM    CARECFM(COMMREG),B'01000000'                        0844 03067000
         BNZ   @RF00844                                            0844 03068000
         OI    EXBIT5,B'00000100'                                  0845 03069000
*       EXDSADDR = DSPTR;            /* POINT TO INCORE DATA SET     */ 03070000
@RF00844 MVC   EXDSADDR(3),DSPTR+1                                 0846 03071000
*       EXSUBCIN=ADDR(DATEXSIA);     /* PT TO SUBCOMMAND INTERFACE   */ 03072000
         LA    @06,DATEXSIA                                        0847 03073000
         ST    @06,EXSUBCIN                                        0847 03074000
*       EXDAATRB = ADDR(EXATTRB);    /* ADDR OF DATA SET ATTRIBUTES  */ 03075000
*                                                                  0848 03076000
         LA    @06,EXATTRB                                         0848 03077000
         ST    @06,EXDAATRB                                        0848 03078000
*       EXSEQPOS = CALINE;           /* SEQUENCE NUMBER POSITION     */ 03079000
         SLR   @06,@06                                             0849 03080000
         IC    @06,CALINE(,COMMREG)                                0849 03081000
         ST    @06,EXSEQPOS                                        0849 03082000
*       EXLNSEQN = CALENGTH;         /* LENGTH OF SEQUENCE NUMBER    */ 03083000
         SLR   @06,@06                                             0850 03084000
         IC    @06,CALENGTH(,COMMREG)                              0850 03085000
         ST    @06,EXLNSEQN                                        0850 03086000
*       EXFIRST = FIRSTKEY;          /* FIRST LINE OF MOVE OR COPY   */ 03087000
         L     @06,FIRSTKEY                                        0851 03088000
         ST    @06,EXFIRST                                         0851 03089000
*       EXLAST = LASTKEY;            /* LAST LINE OF MOVE OR COPY    */ 03090000
         L     @06,LASTKEY                                         0852 03091000
         ST    @06,EXLAST                                          0852 03092000
*       EXFSTLN = INSRTKEY;          /* LINE INSERTED AFTER          */ 03093000
         L     @06,INSRTKEY                                        0853 03094000
         ST    @06,EXFSTLN                                         0853 03095000
*       EXINCRE = THEINCR;           /* THE INCREMENT                */ 03096000
         L     @06,THEINCR                                         0854 03097000
         ST    @06,EXINCRE                                         0854 03098000
*       EXCURLNP = DSCURLIN;         /* POINT TO THE CURRENT LINE    */ 03099000
*                                                                  0855 03100000
         L     @06,DSCURLIN                                        0855 03101000
         ST    @06,EXCURLNP                                        0855 03102000
*       EXLRCL = DSLRECL;            /* LRECL FOR INCORE DATA SET    */ 03103000
         L     @06,DSLRECL                                         0856 03104000
         ST    @06,EXLRCL                                          0856 03105000
*       EXLGNIDS = DSLEN;            /* LENGTH OF INCORE DATA SET    */ 03106000
*                                                                  0857 03107000
         L     @06,DSLEN                                           0857 03108000
         ST    @06,EXLGNIDS                                        0857 03109000
*       DXDATAPT = ADDR(DATEXTPL);   /* POINT TO DATA EXIT PARMS     */ 03110000
         LA    @06,DATEXTPL                                        0858 03111000
         ST    @06,DXDATAPT                                        0858 03112000
*       DXCAPT = COMMREG;            /* POINT TO IKJEBECA            */ 03113000
*                                                                  0859 03114000
         ST    COMMREG,DXCAPT                                      0859 03115000
*       RESPECIFY (GPR01P) RSTD;                                   0860 03116000
*       GPR01P = ADDR(DXPARMS);      /* POINT TO INVOKER PARMS       */ 03117000
         LA    GPR01P,DXPARMS                                      0861 03118000
*       DO; /* LINK  EP('IKJEBEDX') */                             0862 03119000
*       I00601 ='00'X; /*EP/DE FLAG*/                              0863 03120000
         MVI   I00601,X'00'                                        0863 03121000
*       I00602 =ADDR('IKJEBEDX');/*ADDR OF EP/DE*/                 0864 03122000
         LA    @03,@CC01499                                        0864 03123000
         STCM  @03,7,I00602                                        0864 03124000
*       I00604 = 0;/*DCB PTR*/                                     0865 03125000
         SLR   @03,@03                                             0865 03126000
         STCM  @03,7,I00604                                        0865 03127000
*       I00603 = '00'X;/*ERRET FLAG*/                              0866 03128000
         MVI   I00603,X'00'                                        0866 03129000
*       RESPECIFY(GPR15P) RESTRICTED;                              0867 03130000
*       GPR15P=ADDR(I006);/*ADDR OF LINK LIST*/                    0868 03131000
         LA    GPR15P,I006                                         0868 03132000
*       SVC (6);/*ISSUE LINK SVC*/                                 0869 03133000
         SVC   6                                                   0869 03134000
*       RESPECIFY(GPR15P) UNRESTRICTED;                            0870 03135000
*       END; /* LINK  EP('IKJEBEDX') */                            0871 03136000
*       RESPECIFY (GPR15P) RSTD;                                   0872 03137000
*       STATUS = GPR15P;             /* SAVE IKJEBEDX RET CODE       */ 03138000
         LR    STATUS,GPR15P                                       0873 03139000
*       RESPECIFY (GPR01P,GPR15P) UNRSTD;                          0874 03140000
*                                                                  0874 03141000
*       IF STATUS = FOUR             /* RC = 4 FROM DATA EXIT        */ 03142000
*         THEN STATUS = CONTINUE;    /* THEN ACTUALLY A CONTINUE     */ 03143000
         C     STATUS,@CF00055                                     0875 03144000
         BNE   @RF00875                                            0875 03145000
         SLR   STATUS,STATUS                                       0876 03146000
*         ELSE STATUS = TERMNOER;    /* ELSE TERMINATE W/O ERR MSG   */ 03147000
         B     @RC00875                                            0877 03148000
@RF00875 LA    STATUS,32                                           0877 03149000
*       END;                                                       0878 03150000
*                                                                  0878 03151000
@RC00875 DS    0H                                                  0879 03152000
*   RESPECIFY (GPR14P) RSTD;                                       0879 03153000
@RC00832 DS    0H                                                  0880 03154000
*   GPR14P = DATAEX14;               /* RESTORE REG 14               */ 03155000
         LR    GPR14P,DATAEX14                                     0880 03156000
*   RESPECIFY (GPR14P) UNRSTD;                                     0881 03157000
*                                                                  0881 03158000
*END DATAEXIT;                                                     0882 03159000
@EL00025 DS    0H                                                  0882 03160000
@EF00025 DS    0H                                                  0882 03161000
@ER00025 BR    @14                                                 0882 03162000
*/********************************************************************/ 03163000
*/*                                                                  */ 03164000
*/*                              EPILOG                              */ 03165000
*/*                                                                  */ 03166000
*/********************************************************************/ 03167000
*                                                                  0883 03168000
*                                                                  0883 03169000
*    DECLARE /*GENERAL PURPOSE REGISTERS */                        0883 03170000
*      GPR00P PTR(31) REG(0),                                      0883 03171000
*      GPR01P PTR(31) REG(1),                                      0883 03172000
*      GPR02P PTR(31) REG(2),                                      0883 03173000
*      GPR03P PTR(31) REG(3),                                      0883 03174000
*      GPR04P PTR(31) REG(4),                                      0883 03175000
*      GPR05P PTR(31) REG(5),                                      0883 03176000
*      GPR06P PTR(31) REG(6),                                      0883 03177000
*      GPR07P PTR(31) REG(7),                                      0883 03178000
*      GPR08P PTR(31) REG(8),                                      0883 03179000
*      GPR09P PTR(31) REG(9),                                      0883 03180000
*      GPR12P PTR(31) REG(12),                                     0883 03181000
*      GPR13P PTR(31) REG(13),                                     0883 03182000
*      GPR14P PTR(31) REG(14),                                     0883 03183000
*      GPR15P PTR(31) REG(15);                                     0883 03184000
*                                                                  0883 03185000
*    /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS */                0884 03186000
*      DECLARE CASAVPTR PTR(31) BASED;/*SAVE AREA PTR FOR IKJEBESV*/    03187000
*      DECLARE COMMREG REG(9) PTR(31) RSTD;/*POINTER TO EDIT COMMO AREA 03188000
*/     DECLARE DATDREG REG(10) PTR(31) RSTD;/*BASEREG FOR EDIT SUBCOMMA 03189000
*D WORK AREA*/                                                     0885 03190000
*      DECLARE CASAVE CHAR(72) BASED;/*SAVE AREA EDIT MODULE*/     0887 03191000
*    DCL 1 I006 DEF(ILIST),/*DEFINE LIST*/                         0888 03192000
*          2 I00601 CHAR(1),/*EP/DE FLAG*/                         0888 03193000
*          2 I00602 PTR(24),/*EP/DE PTR*/                          0888 03194000
*          2 I00603 CHAR(1),/*ERRET FLAG*/                         0888 03195000
*          2 I00604 PTR(24),/*DCB PTR*/                            0888 03196000
*          2 I00605 PTR(31);/*ERRET PTR*/                          0888 03197000
*                                                                  0888 03198000
*    DECLARE ILIST CHAR(12) BDY(DWORD); /*STANDARD LIST*/          0889 03199000
*                                                                  0889 03200000
*    DECLARE /* COMMON VARIABLES */                                0890 03201000
*      I256C CHAR(256) BASED,                                      0890 03202000
*      I031F FIXED(31) BASED,                                      0890 03203000
*      I031P PTR(31)   BASED,                                      0890 03204000
*      I015F FIXED(15) BASED,                                      0890 03205000
*      I015P PTR(15)   BASED,                                      0890 03206000
*      I008P PTR(8)    BASED,                                      0890 03207000
*      I001C CHAR(1)   BASED;                                      0890 03208000
*/********************************************************************/ 03209000
*/*                                                                  */ 03210000
*/*                            PATCH AREA                            */ 03211000
*/*                                                                  */ 03212000
*/********************************************************************/ 03213000
*      DCL PATCHLOC FIXED(31) STATIC;                              0891 03214000
*     GEN DATA DEFS(PATCHLOC);                                     0892 03215000
*   END IKJEBEMC                                                   0893 03216000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 03217000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 03218000
*/*%INCLUDE SYSLIB  (IKJEBECA)                                        * 03219000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 03220000
*/*%INCLUDE SYSLIB  (IKJEBEMJ)                                        * 03221000
*;                                                                 0893 03222000
@EL00001 DS    0H                                                  0893 03223000
@EF00001 DS    0H                                                  0893 03224000
@ER00001 LM    @14,@12,12(@13)                                     0893 03225000
         BR    @14                                                 0893 03226000
@DATA    DS    0H                                                       03227000
@SM01522 MVC   0(0,@01),FIRSTVAL(@08)                                   03228000
@SM01524 MVC   0(0,@01),LASTVAL(@08)                                    03229000
@SM01526 MVC   0(0,@01),NEWVAL(@08)                                     03230000
@SC01528 CLC   VALINCR(0,@08),FOXZERO                                   03231000
@SM01530 MVC   0(0,@03),VALINCR(@14)                                    03232000
@SM01532 MVC   LETXTTXT(0,COMMREG),STRNGVAL(@07)                        03233000
@SM01534 MVC   STRNGVAL(0,@08),LETXTTXT(COMMREG)                        03234000
@DATD    DSECT                                                          03235000
         DS    0F                                                       03236000
@SA00012 DS    14F                                                      03237000
@SA00021 DS    14F                                                      03238000
IKJEBEMC CSECT                                                          03239000
         DS    0F                                                       03240000
@CF00063 DC    F'1'                                                     03241000
@CH00063 EQU   @CF00063+2                                               03242000
@CF00055 DC    F'4'                                                     03243000
@CF00061 DC    F'8'                                                     03244000
@CF00034 DC    F'12'                                                    03245000
@CF00863 DC    F'16'                                                    03246000
@CF00890 DC    F'32'                                                    03247000
@CF01325 DC    F'100000000'                                             03248000
@DATD    DSECT                                                          03249000
         DS    0D                                                       03250000
MAINLI14 DS    A                                                        03251000
CLEANU14 DS    A                                                        03252000
SETLAS14 DS    A                                                        03253000
SETFIR14 DS    A                                                        03254000
SETNEW14 DS    A                                                        03255000
OPERAN14 DS    A                                                        03256000
CHECK14  DS    A                                                        03257000
EBEUT14  DS    A                                                        03258000
NEWUTI14 DS    A                                                        03259000
RELINE14 DS    A                                                        03260000
STEP114  DS    A                                                        03261000
STEP214  DS    A                                                        03262000
STEP314  DS    A                                                        03263000
SETLIM14 DS    A                                                        03264000
DELETR14 DS    A                                                        03265000
RETCODE  DS    A                                                        03266000
FIRSTKEY DS    A                                                        03267000
LASTKEY  DS    A                                                        03268000
INSRTKEY DS    A                                                        03269000
LIMITKEY DS    A                                                        03270000
THECOUNT DS    A                                                        03271000
VERIFY   DS    A                                                        03272000
THEINCR  DS    A                                                        03273000
LOOPCNT  DS    A                                                        03274000
FIRSTREC DS    A                                                        03275000
ORIGFRST DS    A                                                        03276000
COUNT    DS    A                                                        03277000
COMMAND  DS    FL1                                                      03278000
TYPE     DS    FL1                                                      03279000
         DS    CL2                                                      03280000
SERETCD  DS    CL4                                                      03281000
         ORG   SERETCD                                                  03282000
SECODE   DS    CL1                                                      03283000
SEOFFSET DS    AL3                                                      03284000
         ORG   SERETCD+4                                                03285000
SEPLIST  DS    CL24                                                     03286000
         ORG   SEPLIST                                                  03287000
SEDCBPTR DS    AL4                                                      03288000
SEOFFS   DS    FL2                                                      03289000
SESTRLEN DS    FL2                                                      03290000
SETXTPTR DS    AL4                                                      03291000
SEBFRPTR DS    AL4                                                      03292000
SELNRNGE DS    AL4                                                      03293000
@NM00025 DS    CL1                                                      03294000
SEFLAGS  DS    CL1                                                      03295000
         ORG   SEFLAGS                                                  03296000
SEMODSW  DS    BL1                                                      03297000
         ORG   SEPLIST+22                                               03298000
SECHARCT DS    FL2                                                      03299000
         ORG   SEPLIST+24                                               03300000
         DS    CL4                                                      03301000
SEPLISTD DS    CL8                                                      03302000
         ORG   SEPLISTD                                                 03303000
SESTART  DS    AL4                                                      03304000
SEEND    DS    AL4                                                      03305000
         ORG   SEPLISTD+8                                               03306000
LEPLIST  DS    CL8                                                      03307000
         ORG   LEPLIST                                                  03308000
LECODE   DS    CL1                                                      03309000
LETXTPTR DS    AL3                                                      03310000
LECAPTR  DS    AL4                                                      03311000
         ORG   LEPLIST+8                                                03312000
READPARM DS    CL12                                                     03313000
READFRST DS    CL12                                                     03314000
READNEXT DS    CL12                                                     03315000
READPREV DS    CL12                                                     03316000
WRITESEQ DS    CL12                                                     03317000
WRITEREC DS    CL12                                                     03318000
DELETKEY DS    CL12                                                     03319000
DATEXTPL DS    CL24                                                     03320000
         ORG   DATEXTPL                                                 03321000
EXUPTPTR DS    AL4                                                      03322000
EXECTPTR DS    AL4                                                      03323000
EXEDAECB DS    AL4                                                      03324000
EXFLAGS  DS    CL1                                                      03325000
         ORG   EXFLAGS                                                  03326000
EXBIT0   DS    BL1                                                      03327000
EXBIT1   EQU   EXFLAGS+0                                                03328000
EXBIT2   EQU   EXFLAGS+0                                                03329000
EXBIT3   EQU   EXFLAGS+0                                                03330000
EXBIT4   EQU   EXFLAGS+0                                                03331000
EXBIT5   EQU   EXFLAGS+0                                                03332000
         ORG   DATEXTPL+13                                              03333000
EXDSADDR DS    AL3                                                      03334000
EXSUBCIN DS    AL4                                                      03335000
EXDAATRB DS    AL4                                                      03336000
         ORG   DATEXTPL+24                                              03337000
DATEXSIA DS    CL28                                                     03338000
         ORG   DATEXSIA                                                 03339000
EXSEQPOS DS    AL4                                                      03340000
EXLNSEQN DS    FL4                                                      03341000
EXFIRST  DS    FL4                                                      03342000
EXLAST   DS    FL4                                                      03343000
EXFSTLN  DS    FL4                                                      03344000
EXINCRE  DS    FL4                                                      03345000
EXCURLNP DS    FL4                                                      03346000
         ORG   DATEXSIA+28                                              03347000
EXATTRB  DS    CL8                                                      03348000
         ORG   EXATTRB                                                  03349000
EXLRCL   DS    AL4                                                      03350000
EXLGNIDS DS    AL4                                                      03351000
         ORG   EXATTRB+8                                                03352000
DXPARMS  DS    CL8                                                      03353000
         ORG   DXPARMS                                                  03354000
DXDATAPT DS    AL4                                                      03355000
DXCAPT   DS    AL4                                                      03356000
         ORG   DXPARMS+8                                                03357000
DCPARMS  DS    CL8                                                      03358000
         ORG   DCPARMS                                                  03359000
DCCAPTR  DS    AL4                                                      03360000
DCOUTPTR DS    AL4                                                      03361000
         ORG   DCPARMS+8                                                03362000
DSINFO   DS    CL16                                                     03363000
         ORG   DSINFO                                                   03364000
DSPTR    DS    AL4                                                      03365000
DSLEN    DS    AL4                                                      03366000
DSLRECL  DS    AL4                                                      03367000
DSCURLIN DS    AL4                                                      03368000
         ORG   DSINFO+16                                                03369000
EMSPARMS DS    CL12                                                     03370000
         ORG   EMSPARMS                                                 03371000
EMSMSG1  DS    AL2                                                      03372000
EMSMSG2  DS    AL2                                                      03373000
EMSINS1  DS    AL4                                                      03374000
EMSINS2  DS    AL4                                                      03375000
         ORG   EMSPARMS+12                                              03376000
EMSTXT1  DS    CL13                                                     03377000
         DS    CL3                                                      03378000
EMSTXT2  DS    CL13                                                     03379000
         DS    CL3                                                      03380000
VALPARMS DS    CL44                                                     03381000
PACKAREA DS    CL8                                                      03382000
THEBITS  DS    CL1                                                      03383000
         ORG   THEBITS                                                  03384000
SECONDDS DS    BL1                                                      03385000
PARSERR  EQU   THEBITS+0                                                03386000
DCERROR  EQU   THEBITS+0                                                03387000
MRERROR  EQU   THEBITS+0                                                03388000
         ORG   THEBITS+1                                                03389000
         DS    CL7                                                      03390000
ILIST    DS    CL12                                                     03391000
IKJEBEMC CSECT                                                          03392000
         NOPR  ((@ENDDATD-@DATD)/673*16)                                03393000
         DS    0F                                                       03394000
@SIZDATD DC    AL1(0)                                                   03395000
         DC    AL3(@ENDDATD-@DATD)                                      03396000
@CV01317 DC    V(IKJEBE1)                                               03397000
         DS    0D                                                       03398000
VERERROR DC    AL4(TXTVER)                                              03399000
ESERROR  DC    AL4(TXTEBESE)                                            03400000
ELERROR  DC    AL4(TXTEBELE)                                            03401000
NOFIRST  DC    AL4(TXTBAD1)                                             03402000
LINESTRG DC    AL4(TXTLINST)                                            03403000
BADLAST1 DC    AL4(TXTNO0)                                              03404000
BADLAST2 DC    AL4(TXTNOSTR)                                            03405000
LINERNG  DC    AL4(TXTRANGE)                                            03406000
NOTEXT   DC    AL4(TXTNOTXT)                                            03407000
BADEND   DC    AL4(TXTEND)                                              03408000
MSG52312 DC    H'270'                                                   03409000
MSG52313 DC    H'271'                                                   03410000
MSG52501 DC    AL2(0-1287)                                              03411000
MSG52502 DC    AL2(0-1288)                                              03412000
MSG52578 DC    AL2(0-1544)                                              03413000
MSG52579 DC    H'1545'                                                  03414000
MSG52580 DC    AL2(0-1546)                                              03415000
@CC01494 DC    C'IKJEBEDC'                                              03416000
@CC01499 DC    C'IKJEBEDX'                                              03417000
@CB01330 DC    X'0000000000000000'                                      03418000
         DS    CL2                                                      03419000
TXTCMND  DS    CL17                                                     03420000
         ORG   TXTCMND                                                  03421000
@NM00027 DC    A(0)                                                     03422000
@NM00028 DC    AL2(13)                                                  03423000
@NM00029 DC    AL2(45)                                                  03424000
@NM00030 DC    CL9'MOVE/COPY'                                           03425000
         ORG   TXTCMND+17                                               03426000
         DS    CL3                                                      03427000
TXTPARS  DS    CL13                                                     03428000
         ORG   TXTPARS                                                  03429000
@NM00031 DC    A(0)                                                     03430000
@NM00032 DC    AL2(9)                                                   03431000
@NM00033 DC    AL2(10)                                                  03432000
@NM00034 DC    CL5'PARSE'                                               03433000
         ORG   TXTPARS+13                                               03434000
         DS    CL3                                                      03435000
TXTRC    DS    CL10                                                     03436000
         ORG   TXTRC                                                    03437000
@NM00035 DC    A(0)                                                     03438000
@NM00036 DC    AL2(6)                                                   03439000
@NM00037 DC    AL2(22)                                                  03440000
@NM00038 DC    CL2'  '                                                  03441000
         ORG   TXTRC+10                                                 03442000
         DS    CL2                                                      03443000
TXTLINST DS    CL53                                                     03444000
         ORG   TXTLINST                                                 03445000
@NM00039 DC    A(0)                                                     03446000
@NM00040 DC    AL2(49)                                                  03447000
@NM00041 DC    AL2(27)                                                  03448000
@NM00042 DC    CL45'STRING INVALID FOR END OF RANGE SPECIFICATION'      03449000
         ORG   TXTLINST+53                                              03450000
         DS    CL3                                                      03451000
TXTNO0   DS    CL30                                                     03452000
         ORG   TXTNO0                                                   03453000
@NM00043 DC    A(0)                                                     03454000
@NM00044 DC    AL2(26)                                                  03455000
@NM00045 DC    AL2(27)                                                  03456000
@NM00046 DC    CL22'0 IS INVALID FOR COUNT'                             03457000
         ORG   TXTNO0+30                                                03458000
         DS    CL2                                                      03459000
TXTNOSTR DS    CL57                                                     03460000
         ORG   TXTNOSTR                                                 03461000
@NM00047 DC    A(0)                                                     03462000
@NM00048 DC    AL2(53)                                                  03463000
@NM00049 DC    AL2(27)                                                  03464000
@NM00050 DC    CL49'* INVALID FOR COUNT OR END OF RANGE SPECIFICATION'  03465000
         ORG   TXTNOSTR+57                                              03466000
         DS    CL3                                                      03467000
TXTRANGE DS    CL43                                                     03468000
         ORG   TXTRANGE                                                 03469000
@NM00051 DC    A(0)                                                     03470000
@NM00052 DC    AL2(39)                                                  03471000
@NM00053 DC    AL2(27)                                                  03472000
@NM00054 DC    CL35'TRYING TO MOVE/COPY INTO LINE RANGE'                03473000
         ORG   TXTRANGE+43                                              03474000
         DS    CL1                                                      03475000
TXTBAD1  DS    CL51                                                     03476000
         ORG   TXTBAD1                                                  03477000
@NM00055 DC    A(0)                                                     03478000
@NM00056 DC    AL2(47)                                                  03479000
@NM00057 DC    AL2(27)                                                  03480000
@NM00058 DC    CL43'FIRST LINE TO BE MOVE/COPIED DOES NOT EXIST'        03481000
         ORG   TXTBAD1+51                                               03482000
         DS    CL1                                                      03483000
TXTNOTXT DS    CL31                                                     03484000
         ORG   TXTNOTXT                                                 03485000
@NM00059 DC    A(0)                                                     03486000
@NM00060 DC    AL2(27)                                                  03487000
@NM00061 DC    AL2(27)                                                  03488000
@NM00062 DC    CL23'QUOTED STRING NOT FOUND'                            03489000
         ORG   TXTNOTXT+31                                              03490000
         DS    CL1                                                      03491000
TXTEBESE DS    CL25                                                     03492000
         ORG   TXTEBESE                                                 03493000
@NM00063 DC    A(0)                                                     03494000
@NM00064 DC    AL2(21)                                                  03495000
@NM00065 DC    AL2(27)                                                  03496000
@NM00066 DC    CL17'ERROR IN IKJEBESE'                                  03497000
         ORG   TXTEBESE+25                                              03498000
         DS    CL3                                                      03499000
TXTEBELE DS    CL25                                                     03500000
         ORG   TXTEBELE                                                 03501000
@NM00067 DC    A(0)                                                     03502000
@NM00068 DC    AL2(21)                                                  03503000
@NM00069 DC    AL2(27)                                                  03504000
@NM00070 DC    CL17'ERROR IN IKJEBELE'                                  03505000
         ORG   TXTEBELE+25                                              03506000
         DS    CL3                                                      03507000
TXTVER   DS    CL37                                                     03508000
         ORG   TXTVER                                                   03509000
@NM00071 DC    A(0)                                                     03510000
@NM00072 DC    AL2(33)                                                  03511000
@NM00073 DC    AL2(27)                                                  03512000
@NM00074 DC    CL29'LINE TO BE VERIFIED NOT FOUND'                      03513000
         ORG   TXTVER+37                                                03514000
         DS    CL3                                                      03515000
TXTEND   DS    CL80                                                     03516000
         ORG   TXTEND                                                   03517000
@NM00075 DC    A(0)                                                     03518000
@NM00076 DC    AL2(76)                                                  03519000
@NM00077 DC    AL2(27)                                                  03520000
@NM00078 DC    CL72'END OF RANGE MUST BE GREATER THAN OR EQUAL TO THE BC03521000
               EGINNING OF THE RANGE'                                   03522000
         ORG   TXTEND+80                                                03523000
FOXZERO  DC    CL8'00000000'                                            03524000
IKJEBEMC CSECT                                                          03525000
IKJEBE1  IKJPARM DSECT=IKJPRMD1                                         03526000
FIRSTL   IKJIDENT 'LINE1',ASTERISK,MAXLNTH=8,                         **03527000
               FIRST=NUMERIC,OTHER=NUMERIC                              03528000
FIRSTS   IKJPOSIT QSTRING,ASIS                                          03529000
LAST     IKJIDENT 'LINE2 OR COUNT',MAXLNTH=8,ASTERISK,                **03530000
               FIRST=NUMERIC,OTHER=NUMERIC                              03531000
NEW      IKJIDENT 'LINE3 OR LINE4',ASTERISK,MAXLNTH=8,                **03532000
               FIRST=NUMERIC,OTHER=NUMERIC                              03533000
*                                                                       03534000
INCR     IKJKEYWD                                                       03535000
         IKJNAME  'INCR',SUBFLD=INCRNUM                                 03536000
INCRNUM  IKJSUBF                                                        03537000
INCRNO   IKJIDENT 'INCREMENT NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,     XX03538000
               PROMPT='INCREMENT FROM 1 TO MAXIMUM LINE NUMBER',      XX03539000
               HELP=('THIS IS THE INCREMENT FOR THE MOVE OR COPY'),   XX03540000
               VALIDCK=INCRCHCK,MAXLNTH=8                               03541000
         IKJENDP                                                        03542000
*                                                                       03543000
* EQUATES REQUIRED BY GENERATED EDIT MACROS                             03544000
*                                                                       03545000
RETREG    EQU   14                      REGISTER 14                     03546000
RETCDREG  EQU   15                      REGISTER 15                     03547000
PARMREG0  EQU   0                       REGISTER 0                      03548000
PARMREG1  EQU   1                       REGISTER 1                      03549000
IKJEBEMC CSECT                                                          03550000
         DS   0H                                                        03551000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   03552000
@DATD    DSECT                                                          03553000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03554000
@ENDDATD EQU   *                                                        03555000
IKJEBEMC CSECT                                                          03556000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03557000
@01      EQU   01                                                       03558000
@02      EQU   02                                                       03559000
@03      EQU   03                                                       03560000
@04      EQU   04                                                       03561000
@05      EQU   05                                                       03562000
@06      EQU   06                                                       03563000
@07      EQU   07                                                       03564000
@08      EQU   08                                                       03565000
@09      EQU   09                                                       03566000
@10      EQU   10                                                       03567000
@11      EQU   11                                                       03568000
@12      EQU   12                                                       03569000
@13      EQU   13                                                       03570000
@14      EQU   14                                                       03571000
@15      EQU   15                                                       03572000
UTPARMP  EQU   @04                                                      03573000
TEMP     EQU   @03                                                      03574000
OLDKEY   EQU   @08                                                      03575000
NEWKEY   EQU   @07                                                      03576000
STATUS   EQU   @06                                                      03577000
IPLIEX14 EQU   @04                                                      03578000
DATAEX14 EQU   @08                                                      03579000
HANDLE14 EQU   @03                                                      03580000
SETTYP14 EQU   @03                                                      03581000
INIT14   EQU   @03                                                      03582000
PARSE14  EQU   @08                                                      03583000
PPLPTR   EQU   @04                                                      03584000
COMMREG  EQU   @09                                                      03585000
PDLPTR   EQU   @02                                                      03586000
GPR01P   EQU   @01                                                      03587000
GPR13P   EQU   @13                                                      03588000
GPR15P   EQU   @15                                                      03589000
DATDREG  EQU   @10                                                      03590000
GPR12P   EQU   @12                                                      03591000
GPR14P   EQU   @14                                                      03592000
GPR02P   EQU   @02                                                      03593000
GPR00P   EQU   @00                                                      03594000
GPR03P   EQU   @03                                                      03595000
GPR04P   EQU   @04                                                      03596000
GPR05P   EQU   @05                                                      03597000
GPR06P   EQU   @06                                                      03598000
GPR07P   EQU   @07                                                      03599000
GPR08P   EQU   @08                                                      03600000
GPR09P   EQU   @09                                                      03601000
CVTPTR   EQU   16                                                       03602000
CVTMAP   EQU   0                                                        03603000
CVTDAR   EQU   CVTMAP+72                                                03604000
CVTFLGS1 EQU   CVTDAR                                                   03605000
CVTDCB   EQU   CVTMAP+116                                               03606000
CVTIERLC EQU   CVTMAP+144                                               03607000
CVTOPTA  EQU   CVTMAP+182                                               03608000
CVTOPTB  EQU   CVTMAP+183                                               03609000
CVTGTF   EQU   CVTMAP+236                                               03610000
CVTGTFST EQU   CVTGTF                                                   03611000
CVTGTFS  EQU   CVTGTFST                                                 03612000
CVTSTATE EQU   CVTGTFST                                                 03613000
CVTTMODE EQU   CVTGTFST                                                 03614000
CVTFORM  EQU   CVTGTFST                                                 03615000
CVTAQAVT EQU   CVTMAP+240                                               03616000
CVTTCMFG EQU   CVTAQAVT                                                 03617000
CVTVOLM2 EQU   CVTMAP+244                                               03618000
CVTTATA  EQU   CVTVOLM2                                                 03619000
CVTTSKS  EQU   CVTTATA                                                  03620000
CVTVOLF2 EQU   CVTTSKS                                                  03621000
CVTTAT   EQU   CVTTATA+1                                                03622000
CVTATER  EQU   CVTMAP+248                                               03623000
CVTEXT1  EQU   CVTMAP+252                                               03624000
CVTPURG  EQU   CVTMAP+260                                               03625000
CVTQMSG  EQU   CVTMAP+268                                               03626000
CVTDMSR  EQU   CVTMAP+272                                               03627000
CVTERPV  EQU   CVTMAP+316                                               03628000
CVTINTLA EQU   CVTMAP+320                                               03629000
CVTAPF   EQU   CVTMAP+324                                               03630000
CVTEXT2  EQU   CVTMAP+328                                               03631000
CVTHJES  EQU   CVTMAP+332                                               03632000
CVTPGSIA EQU   CVTMAP+348                                               03633000
CVTA1F1  EQU   CVTMAP+356                                               03634000
CVTSYSK  EQU   CVTMAP+357                                               03635000
CVTVOLM1 EQU   CVTMAP+380                                               03636000
CVTVOLF1 EQU   CVTVOLM1                                                 03637000
CVTATMCT EQU   CVTMAP+388                                               03638000
CVTXTNT1 EQU   0                                                        03639000
CVTXTNT2 EQU   0                                                        03640000
CVTDSSV  EQU   CVTXTNT2                                                 03641000
CVTFLGBT EQU   CVTXTNT2+5                                               03642000
CVTQID   EQU   CVTXTNT2+24                                              03643000
CVTRV400 EQU   CVTXTNT2+52                                              03644000
CVTRV409 EQU   CVTXTNT2+53                                              03645000
CVTATCVT EQU   CVTXTNT2+64                                              03646000
CVTRV429 EQU   CVTXTNT2+84                                              03647000
CVTRV438 EQU   CVTXTNT2+85                                              03648000
CVTRV457 EQU   CVTXTNT2+112                                             03649000
CVTRV466 EQU   CVTXTNT2+113                                             03650000
CVTFIX   EQU   0                                                        03651000
CVTRELNO EQU   CVTFIX+252                                               03652000
IKJEBECA EQU   0                                                        03653000
CAPTLE   EQU   IKJEBECA+16                                              03654000
CAPTMS   EQU   IKJEBECA+20                                              03655000
CAPTUT   EQU   IKJEBECA+24                                              03656000
CAPTPRSD EQU   IKJEBECA+36                                              03657000
CAPRSPDL EQU   CAPTPRSD                                                 03658000
CAFREEDL EQU   CAPRSPDL                                                 03659000
CAPTIBFR EQU   IKJEBECA+40                                              03660000
CAOPERND EQU   CAPTIBFR                                                 03661000
CAPTCDCB EQU   IKJEBECA+52                                              03662000
CAPTPDCB EQU   IKJEBECA+56                                              03663000
CAUTILNO EQU   IKJEBECA+60                                              03664000
CAATTN   EQU   IKJEBECA+120                                             03665000
CAATTNIS EQU   CAATTN                                                   03666000
CACFLAG  EQU   IKJEBECA+124                                             03667000
CACFLAG1 EQU   CACFLAG                                                  03668000
CALNTOVF EQU   CACFLAG1                                                 03669000
CAVRFYSW EQU   CACFLAG1                                                 03670000
CANONUM  EQU   CACFLAG1                                                 03671000
CACFLAG2 EQU   CACFLAG+1                                                03672000
CARECFM  EQU   CACFLAG2                                                 03673000
CASEQCOL EQU   CACFLAG2                                                 03674000
CACFLAG3 EQU   CACFLAG+2                                                03675000
CAIMFLG  EQU   CACFLAG3                                                 03676000
CACFLAG4 EQU   CACFLAG+3                                                03677000
CACFLAG5 EQU   CACFLAG+4                                                03678000
CACFLAG6 EQU   CACFLAG+5                                                03679000
CAPD     EQU   IKJEBECA+152                                             03680000
CALINE   EQU   CAPD+18                                                  03681000
CALENGTH EQU   CAPD+19                                                  03682000
CADSCODE EQU   CAPD+40                                                  03683000
CADSATTR EQU   CAPD+41                                                  03684000
CADSATR2 EQU   CAPD+42                                                  03685000
CAPTPDXT EQU   IKJEBECA+228                                             03686000
CALRECL  EQU   IKJEBECA+232                                             03687000
CAEDFLAG EQU   IKJEBECA+236                                             03688000
CAEDFLG2 EQU   IKJEBECA+237                                             03689000
CASAFLAG EQU   IKJEBECA+376                                             03690000
CASAFLG2 EQU   IKJEBECA+377                                             03691000
CACURNUM EQU   IKJEBECA+456                                             03692000
CAINCRE  EQU   IKJEBECA+460                                             03693000
CARECNO  EQU   IKJEBECA+480                                             03694000
CASYNLST EQU   IKJEBECA+496                                             03695000
CASYNWA  EQU   IKJEBECA+508                                             03696000
CASYNOPT EQU   IKJEBECA+524                                             03697000
CASYNSW  EQU   CASYNOPT+3                                               03698000
CATMPLST EQU   IKJEBECA+528                                             03699000
CAPTUPT  EQU   CATMPLST                                                 03700000
CAPTECT  EQU   CATMPLST+4                                               03701000
CAPTECB  EQU   CATMPLST+8                                               03702000
CAMAWKA  EQU   IKJEBECA+596                                             03703000
MACFLAGS EQU   CAMAWKA+28                                               03704000
MACFLAG2 EQU   CAMAWKA+29                                               03705000
CAMODEMG EQU   IKJEBECA+928                                             03706000
CASCWKA  EQU   IKJEBECA+1448                                            03707000
CABFRPL  EQU   IKJEBECA+2120                                            03708000
CATEMPBF EQU   IKJEBECA+2648                                            03709000
CANXTSVA EQU   IKJEBECA+3896                                            03710000
IKJEBECX EQU   0                                                        03711000
CXDATEXT EQU   IKJEBECX                                                 03712000
PPL      EQU   0                                                        03713000
PPLPCL   EQU   PPL+12                                                   03714000
PPLANS   EQU   PPL+16                                                   03715000
PPLCBUF  EQU   PPL+20                                                   03716000
PPLUWA   EQU   PPL+24                                                   03717000
UTPARMS  EQU   0                                                        03718000
UTCODE   EQU   UTPARMS                                                  03719000
UTDCBPTR EQU   UTPARMS+1                                                03720000
UTKEYPTR EQU   UTPARMS+4                                                03721000
UTEOL2   EQU   UTKEYPTR                                                 03722000
UTBUFPTR EQU   UTPARMS+8                                                03723000
UTEOL3   EQU   UTBUFPTR                                                 03724000
TXTMAP   EQU   0                                                        03725000
TXTNEXT  EQU   TXTMAP                                                   03726000
TXTTXT   EQU   TXTMAP+8                                                 03727000
VALCK    EQU   0                                                        03728000
IPDE     EQU   VALCK                                                    03729000
IWK      EQU   VALCK+4                                                  03730000
INCRPDE  EQU   0                                                        03731000
ICHARPTR EQU   INCRPDE                                                  03732000
IWORD2   EQU   INCRPDE+4                                                03733000
ILENGTH  EQU   IWORD2                                                   03734000
IFLAGS   EQU   IWORD2+2                                                 03735000
IHERE    EQU   IFLAGS                                                   03736000
FIRSTVAL EQU   0                                                        03737000
STRNGVAL EQU   0                                                        03738000
LASTVAL  EQU   0                                                        03739000
NEWVAL   EQU   0                                                        03740000
VALINCR  EQU   0                                                        03741000
CASAVPTR EQU   0                                                        03742000
CASAVE   EQU   0                                                        03743000
INCRVAL  EQU   0                                                        03744000
I001C    EQU   0                                                        03745000
I008P    EQU   0                                                        03746000
I015F    EQU   0                                                        03747000
I015P    EQU   0                                                        03748000
I031F    EQU   0                                                        03749000
I031P    EQU   0                                                        03750000
I256C    EQU   0                                                        03751000
FIRSTLP  EQU   FIRSTL                                                   03752000
FIRSTLL  EQU   FIRSTL+4                                                 03753000
@NM00079 EQU   FIRSTL+6                                                 03754000
FIRSTLF  EQU   @NM00079                                                 03755000
FIRSTSP  EQU   FIRSTS                                                   03756000
FIRSTSL  EQU   FIRSTS+4                                                 03757000
@NM00080 EQU   FIRSTS+6                                                 03758000
FIRSTSF  EQU   @NM00080                                                 03759000
LASTP    EQU   LAST                                                     03760000
LASTL    EQU   LAST+4                                                   03761000
@NM00081 EQU   LAST+6                                                   03762000
LASTF    EQU   @NM00081                                                 03763000
NEWP     EQU   NEW                                                      03764000
NEWL     EQU   NEW+4                                                    03765000
@NM00082 EQU   NEW+6                                                    03766000
NEWF     EQU   @NM00082                                                 03767000
INCRP    EQU   INCR                                                     03768000
@NM00083 EQU   INCR+6                                                   03769000
CVTS01   EQU   CVTPGSIA                                                 03770000
CVTLPDIA EQU   CVTS01+12                                                03771000
CVTDIRST EQU   CVTLPDIA                                                 03772000
CVTSLIDA EQU   CVTS01+24                                                03773000
CVTCTLFG EQU   CVTS01+50                                                03774000
CVTPARS  EQU   CVTS01+176                                               03775000
CVTRV210 EQU   CVTS01+424                                               03776000
CVTRV219 EQU   CVTS01+425                                               03777000
CVTRV228 EQU   CVTS01+426                                               03778000
CVTRV237 EQU   CVTS01+427                                               03779000
CVTMFRTR EQU   CVTS01+452                                               03780000
CVTRV262 EQU   CVTS01+468                                               03781000
CVTRV271 EQU   CVTS01+469                                               03782000
CVTRV280 EQU   CVTS01+470                                               03783000
CVTRV289 EQU   CVTS01+471                                               03784000
CVTGSDA  EQU   CVTS01+600                                               03785000
LETXT    EQU   CABFRPL                                                  03786000
LETXTLEN EQU   LETXT                                                    03787000
LETXTTXT EQU   LETXT+4                                                  03788000
THEBUFFR EQU   CABFRPL                                                  03789000
THEKEY   EQU   THEBUFFR                                                 03790000
I006     EQU   ILIST                                                    03791000
I00601   EQU   I006                                                     03792000
I00602   EQU   I006+1                                                   03793000
I00603   EQU   I006+4                                                   03794000
I00604   EQU   I006+5                                                   03795000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03796000
I00605   EQU   I006+8                                                   03797000
@NM00026 EQU   LETXT+2                                                  03798000
CVTRV628 EQU   CVTS01+728                                               03799000
CVTRV627 EQU   CVTS01+724                                               03800000
CVTRV626 EQU   CVTS01+720                                               03801000
CVTRV625 EQU   CVTS01+716                                               03802000
CVTRV624 EQU   CVTS01+712                                               03803000
CVTRV623 EQU   CVTS01+708                                               03804000
CVTRV622 EQU   CVTS01+704                                               03805000
CVTRV621 EQU   CVTS01+700                                               03806000
CVTRV620 EQU   CVTS01+696                                               03807000
CVTRV619 EQU   CVTS01+692                                               03808000
CVTRV618 EQU   CVTS01+688                                               03809000
CVTRV617 EQU   CVTS01+684                                               03810000
CVTRV616 EQU   CVTS01+680                                               03811000
CVTRV615 EQU   CVTS01+676                                               03812000
CVTRV614 EQU   CVTS01+672                                               03813000
CVTRV613 EQU   CVTS01+668                                               03814000
CVTRV612 EQU   CVTS01+664                                               03815000
CVTRV611 EQU   CVTS01+660                                               03816000
CVTRV610 EQU   CVTS01+656                                               03817000
CVTRV609 EQU   CVTS01+652                                               03818000
CVTRV608 EQU   CVTS01+648                                               03819000
CVTRV607 EQU   CVTS01+644                                               03820000
CVTRV606 EQU   CVTS01+640                                               03821000
CVTRV605 EQU   CVTS01+636                                               03822000
CVTRV604 EQU   CVTS01+632                                               03823000
CVTEFF02 EQU   CVTS01+628                                               03824000
CVTCBBR  EQU   CVTS01+624                                               03825000
CVTSSCR  EQU   CVTS01+620                                               03826000
CVTEVENT EQU   CVTS01+616                                               03827000
CVTCRCA  EQU   CVTS01+612                                               03828000
CVTTPIO  EQU   CVTS01+608                                               03829000
CVTADV   EQU   CVTS01+604                                               03830000
CVTGSDAB EQU   CVTGSDA                                                  03831000
CVTQV3   EQU   CVTS01+596                                               03832000
CVTQV2   EQU   CVTS01+592                                               03833000
CVTQV1   EQU   CVTS01+588                                               03834000
CVTRPT   EQU   CVTS01+584                                               03835000
CVTSSRB  EQU   CVTS01+580                                               03836000
CVTCSDRL EQU   CVTS01+576                                               03837000
CVTEXP1  EQU   CVTS01+572                                               03838000
CVTRMPMT EQU   CVTS01+568                                               03839000
CVTRMPTT EQU   CVTS01+564                                               03840000
CVTVPSA  EQU   CVTS01+560                                               03841000
CVTVSTOP EQU   CVTS01+556                                               03842000
CVTGTFR8 EQU   CVTS01+552                                               03843000
CVTQUIT  EQU   CVTS01+548                                               03844000
CVTVACR  EQU   CVTS01+544                                               03845000
CVTWTCB  EQU   CVTS01+540                                               03846000
CVTSTPRS EQU   CVTS01+536                                               03847000
CVT0PT02 EQU   CVTS01+532                                               03848000
CVTDARCM EQU   CVTS01+528                                               03849000
CVTIRECM EQU   CVTS01+524                                               03850000
CVTJRECM EQU   CVTS01+520                                               03851000
CVTVEMS0 EQU   CVTS01+516                                               03852000
CVTSPFRR EQU   CVTS01+512                                               03853000
CVTRLSTG EQU   CVTS01+508                                               03854000
CVT0TC0A EQU   CVTS01+504                                               03855000
CVTGMBR  EQU   CVTS01+500                                               03856000
CVTLFRM  EQU   CVTS01+496                                               03857000
CVTRMBR  EQU   CVTS01+492                                               03858000
CVTVIOP  EQU   CVTS01+488                                               03859000
CVTRV307 EQU   CVTS01+486                                               03860000
CVTRV306 EQU   CVTS01+484                                               03861000
CVTRV305 EQU   CVTS01+482                                               03862000
CVTRV304 EQU   CVTS01+480                                               03863000
CVTRV303 EQU   CVTS01+478                                               03864000
CVTRV302 EQU   CVTS01+476                                               03865000
CVTTRCA  EQU   CVTS01+472                                               03866000
CVTRV297 EQU   CVTRV289                                                 03867000
CVTRV296 EQU   CVTRV289                                                 03868000
CVTRV295 EQU   CVTRV289                                                 03869000
CVTRV294 EQU   CVTRV289                                                 03870000
CVTRV293 EQU   CVTRV289                                                 03871000
CVTRV292 EQU   CVTRV289                                                 03872000
CVTRV291 EQU   CVTRV289                                                 03873000
CVTRV290 EQU   CVTRV289                                                 03874000
CVTRV288 EQU   CVTRV280                                                 03875000
CVTRV287 EQU   CVTRV280                                                 03876000
CVTRV286 EQU   CVTRV280                                                 03877000
CVTRV285 EQU   CVTRV280                                                 03878000
CVTRV284 EQU   CVTRV280                                                 03879000
CVTRV283 EQU   CVTRV280                                                 03880000
CVTRV282 EQU   CVTRV280                                                 03881000
CVTRV281 EQU   CVTRV280                                                 03882000
CVTRV279 EQU   CVTRV271                                                 03883000
CVTRV278 EQU   CVTRV271                                                 03884000
CVTRV277 EQU   CVTRV271                                                 03885000
CVTRV276 EQU   CVTRV271                                                 03886000
CVTRV275 EQU   CVTRV271                                                 03887000
CVTRV274 EQU   CVTRV271                                                 03888000
CVTRV273 EQU   CVTRV271                                                 03889000
CVTRV272 EQU   CVTRV271                                                 03890000
CVTRV270 EQU   CVTRV262                                                 03891000
CVTRV269 EQU   CVTRV262                                                 03892000
CVTRV268 EQU   CVTRV262                                                 03893000
CVTRV267 EQU   CVTRV262                                                 03894000
CVTRV266 EQU   CVTRV262                                                 03895000
CVTRV265 EQU   CVTRV262                                                 03896000
CVTRV264 EQU   CVTRV262                                                 03897000
CVTRV263 EQU   CVTRV262                                                 03898000
CVTVFP   EQU   CVTS01+464                                               03899000
CVTVSI   EQU   CVTS01+460                                               03900000
CVTVPSIB EQU   CVTS01+456                                               03901000
CVTMFACT EQU   CVTMFRTR                                                 03902000
CVTMFCTL EQU   CVTS01+448                                               03903000
CVTPVBP  EQU   CVTS01+444                                               03904000
CVTPWI   EQU   CVTS01+440                                               03905000
CVTRV254 EQU   CVTS01+438                                               03906000
CVTRV253 EQU   CVTS01+436                                               03907000
CVTRV252 EQU   CVTS01+434                                               03908000
CVTRV251 EQU   CVTS01+433                                               03909000
CVTRV250 EQU   CVTS01+432                                               03910000
CVTRV249 EQU   CVTS01+431                                               03911000
CVTRV248 EQU   CVTS01+430                                               03912000
CVTRV247 EQU   CVTS01+429                                               03913000
CVTRV246 EQU   CVTS01+428                                               03914000
CVTRV245 EQU   CVTRV237                                                 03915000
CVTRV244 EQU   CVTRV237                                                 03916000
CVTRV243 EQU   CVTRV237                                                 03917000
CVTRV242 EQU   CVTRV237                                                 03918000
CVTRV241 EQU   CVTRV237                                                 03919000
CVTRV240 EQU   CVTRV237                                                 03920000
CVTRV239 EQU   CVTRV237                                                 03921000
CVTRV238 EQU   CVTRV237                                                 03922000
CVTRV236 EQU   CVTRV228                                                 03923000
CVTRV235 EQU   CVTRV228                                                 03924000
CVTRV234 EQU   CVTRV228                                                 03925000
CVTRV233 EQU   CVTRV228                                                 03926000
CVTRV232 EQU   CVTRV228                                                 03927000
CVTRV231 EQU   CVTRV228                                                 03928000
CVTRV230 EQU   CVTRV228                                                 03929000
CVTRV229 EQU   CVTRV228                                                 03930000
CVTRV227 EQU   CVTRV219                                                 03931000
CVTRV226 EQU   CVTRV219                                                 03932000
CVTRV225 EQU   CVTRV219                                                 03933000
CVTRV224 EQU   CVTRV219                                                 03934000
CVTRV223 EQU   CVTRV219                                                 03935000
CVTRV222 EQU   CVTRV219                                                 03936000
CVTRV221 EQU   CVTRV219                                                 03937000
CVTRV220 EQU   CVTRV219                                                 03938000
CVTRV218 EQU   CVTRV210                                                 03939000
CVTRV217 EQU   CVTRV210                                                 03940000
CVTRV216 EQU   CVTRV210                                                 03941000
CVTRV215 EQU   CVTRV210                                                 03942000
CVTRV214 EQU   CVTRV210                                                 03943000
CVTRV213 EQU   CVTRV210                                                 03944000
CVTRV212 EQU   CVTRV210                                                 03945000
CVTRV211 EQU   CVTRV210                                                 03946000
CVTLCCAT EQU   CVTS01+420                                               03947000
CVTPCCAT EQU   CVTS01+416                                               03948000
CVTIPCRP EQU   CVTS01+412                                               03949000
CVTIPCRI EQU   CVTS01+408                                               03950000
CVTIPCDS EQU   CVTS01+404                                               03951000
CVTAIDVT EQU   CVTS01+400                                               03952000
CVTSSAP  EQU   CVTS01+396                                               03953000
CVTEHCIR EQU   CVTS01+392                                               03954000
CVTEHDEF EQU   CVTS01+388                                               03955000
CVTDAIR  EQU   CVTS01+384                                               03956000
CVTPERFM EQU   CVTS01+380                                               03957000
CVT044R2 EQU   CVTS01+376                                               03958000
CVTFETCH EQU   CVTS01+372                                               03959000
CVTRSTWD EQU   CVTS01+368                                               03960000
CVTSPOST EQU   CVTS01+364                                               03961000
CVTIOBP  EQU   CVTS01+360                                               03962000
CVTASMVT EQU   CVTS01+356                                               03963000
CVTRECRQ EQU   CVTS01+352                                               03964000
CVTWSAC  EQU   CVTS01+348                                               03965000
CVTRV149 EQU   CVTS01+344                                               03966000
CVTWSAL  EQU   CVTS01+340                                               03967000
CVTSPSA  EQU   CVTS01+336                                               03968000
CVTGLMN  EQU   CVTS01+332                                               03969000
CVTVEAC0 EQU   CVTS01+328                                               03970000
CVT062R1 EQU   CVTS01+324                                               03971000
CVTRPOST EQU   CVTS01+320                                               03972000
CVTDQIQE EQU   CVTS01+316                                               03973000
CVTCSD   EQU   CVTS01+312                                               03974000
CVTLKRMA EQU   CVTS01+308                                               03975000
CVTRSPIE EQU   CVTS01+304                                               03976000
CVTRENQ  EQU   CVTS01+300                                               03977000
CVTLQCB  EQU   CVTS01+296                                               03978000
CVTFQCB  EQU   CVTS01+292                                               03979000
CVTQCS01 EQU   CVTS01+288                                               03980000
CVTAPFT  EQU   CVTS01+284                                               03981000
CVTPARRL EQU   CVTS01+280                                               03982000
CVTVWAIT EQU   CVTS01+276                                               03983000
CVTGSPL  EQU   CVTS01+272                                               03984000
CVTLSMQ  EQU   CVTS01+268                                               03985000
CVTGSMQ  EQU   CVTS01+264                                               03986000
CVTEXPRO EQU   CVTS01+260                                               03987000
CVTOPCTP EQU   CVTS01+256                                               03988000
CVTSIC   EQU   CVTS01+252                                               03989000
CVTTPIOS EQU   CVTS01+248                                               03990000
CVTRTMS  EQU   CVTS01+244                                               03991000
CVTSDBF  EQU   CVTS01+240                                               03992000
CVTSCBP  EQU   CVTS01+236                                               03993000
CVTSDMP  EQU   CVTS01+232                                               03994000
CVTSV60  EQU   CVTS01+228                                               03995000
CVTRTMCT EQU   CVTS01+224                                               03996000
CVTASCBL EQU   CVTS01+220                                               03997000
CVTASCBH EQU   CVTS01+216                                               03998000
CVTGDA   EQU   CVTS01+212                                               03999000
CVTASVT  EQU   CVTS01+208                                               04000000
CVTVVMDI EQU   CVTS01+204                                               04001000
CVTAQTOP EQU   CVTS01+200                                               04002000
CVTIOSCS EQU   CVTS01+196                                               04003000
CVTSDRM  EQU   CVTS01+192                                               04004000
CVTOPTE  EQU   CVTS01+188                                               04005000
CVTSTXU  EQU   CVTS01+184                                               04006000
CVTQUIS  EQU   CVTS01+180                                               04007000
CVTS1EE  EQU   CVTS01+172                                               04008000
CVTFRAS  EQU   CVTS01+168                                               04009000
CVTQSAS  EQU   CVTS01+164                                               04010000
CVTCRAS  EQU   CVTS01+160                                               04011000
CVTCRMN  EQU   CVTS01+156                                               04012000
CVTDELCP EQU   CVTS01+152                                               04013000
CVTFRECL EQU   CVTS01+148                                               04014000
CVTGETCL EQU   CVTS01+144                                               04015000
CVTBLDCP EQU   CVTS01+140                                               04016000
CVTAUTHL EQU   CVTS01+136                                               04017000
CVTSCAN  EQU   CVTS01+132                                               04018000
CVTRV144 EQU   CVTS01+130                                               04019000
CVTMAXMP EQU   CVTS01+128                                               04020000
CVTSTCK  EQU   CVTS01+124                                               04021000
CVTRV139 EQU   CVTS01+123                                               04022000
CVTDSSAC EQU   CVTS01+122                                               04023000
CVTRV513 EQU   CVTS01+121                                               04024000
CVTIOSPL EQU   CVTS01+120                                               04025000
CVTPTGT  EQU   CVTS01+116                                               04026000
CVTCSPIE EQU   CVTS01+112                                               04027000
CVTSMFEX EQU   CVTS01+108                                               04028000
CVTOLT0A EQU   CVTS01+104                                               04029000
CVTSRBRT EQU   CVTS01+100                                               04030000
CVTPUTL  EQU   CVTS01+96                                                04031000
CVTRV519 EQU   CVTS01+92                                                04032000
CVTRV327 EQU   CVTS01+88                                                04033000
CVTRV326 EQU   CVTS01+84                                                04034000
CVTRV325 EQU   CVTS01+80                                                04035000
CVTRV324 EQU   CVTS01+76                                                04036000
CVT0VL01 EQU   CVTS01+72                                                04037000
CVTSHRVM EQU   CVTS01+68                                                04038000
CVTRV332 EQU   CVTS01+64                                                04039000
CVTTAS   EQU   CVTS01+60                                                04040000
CVTRSCN  EQU   CVTS01+56                                                04041000
CVTTRAC2 EQU   CVTS01+54                                                04042000
CVTTRACE EQU   CVTS01+52                                                04043000
CVTAPG   EQU   CVTS01+51                                                04044000
CVTSDTRC EQU   CVTCTLFG                                                 04045000
CVTGTRCE EQU   CVTCTLFG                                                 04046000
CVTNOMP  EQU   CVTCTLFG                                                 04047000
CVTRSV79 EQU   CVTCTLFG                                                 04048000
CVTDSTAT EQU   CVTCTLFG                                                 04049000
CVTRSV78 EQU   CVTCTLFG                                                 04050000
CVTRV333 EQU   CVTCTLFG                                                 04051000
CVTRV323 EQU   CVTCTLFG                                                 04052000
CVTSPVLK EQU   CVTS01+49                                                04053000
CVTRSV77 EQU   CVTS01+48                                                04054000
CVTRV331 EQU   CVTS01+44                                                04055000
CVTRV330 EQU   CVTS01+40                                                04056000
CVTRV329 EQU   CVTS01+36                                                04057000
CVTRV328 EQU   CVTS01+32                                                04058000
CVTRV322 EQU   CVTS01+28                                                04059000
CVTSLID  EQU   CVTSLIDA+1                                               04060000
CVTSYLK  EQU   CVTSLIDA                                                 04061000
CVTRV321 EQU   CVTS01+20                                                04062000
CVTRV320 EQU   CVTS01+16                                                04063000
CVTLPDIR EQU   CVTLPDIA+1                                               04064000
CVTRSV69 EQU   CVTDIRST                                                 04065000
CVTRSV68 EQU   CVTDIRST                                                 04066000
CVTRSV67 EQU   CVTDIRST                                                 04067000
CVTRSV66 EQU   CVTDIRST                                                 04068000
CVTRSV65 EQU   CVTDIRST                                                 04069000
CVTRSV64 EQU   CVTDIRST                                                 04070000
CVTRSV63 EQU   CVTDIRST                                                 04071000
CVTDICOM EQU   CVTDIRST                                                 04072000
CVTPVTP  EQU   CVTS01+8                                                 04073000
CVTLPDSR EQU   CVTS01+4                                                 04074000
CVTGETL  EQU   CVTS01                                                   04075000
INCRF    EQU   @NM00083                                                 04076000
INCRL    EQU   INCR+4                                                   04077000
IVALMSG  EQU   VALCK+8                                                  04078000
TXTOFFST EQU   TXTMAP+6                                                 04079000
TXTLEN   EQU   TXTMAP+4                                                 04080000
PPLECB   EQU   PPL+8                                                    04081000
PPLECT   EQU   PPL+4                                                    04082000
PPLUPT   EQU   PPL                                                      04083000
CAPDEXT  EQU   IKJEBECA+3984                                            04084000
CADSNRC2 EQU   IKJEBECA+3928                                            04085000
CADSNOF2 EQU   IKJEBECA+3926                                            04086000
CADSNLN2 EQU   IKJEBECA+3924                                            04087000
CADSNPT2 EQU   IKJEBECA+3920                                            04088000
@NM00024 EQU   IKJEBECA+3900                                            04089000
CASVAREA EQU   IKJEBECA+3176                                            04090000
CAFIBFR  EQU   IKJEBECA+1188                                            04091000
CAAEDCB  EQU   IKJEBECA+1096                                            04092000
CALDROP  EQU   IKJEBECA+1064                                            04093000
CAATNWKA EQU   IKJEBECA+956                                             04094000
CAATNBUF EQU   IKJEBECA+952                                             04095000
CAMODETX EQU   CAMODEMG+12                                              04096000
CAMODEOF EQU   CAMODEMG+10                                              04097000
CAMODELN EQU   CAMODEMG+8                                               04098000
CAMODEPT EQU   CAMODEMG+4                                               04099000
CAMODEIS EQU   CAMODEMG                                                 04100000
CASRWKA  EQU   IKJEBECA+728                                             04101000
CAMSWKA  EQU   IKJEBECA+628                                             04102000
@NM00023 EQU   CAMAWKA+30                                               04103000
@NM00022 EQU   MACFLAG2                                                 04104000
MATABLE1 EQU   MACFLAG2                                                 04105000
@NM00021 EQU   MACFLAGS                                                 04106000
MAENDPRC EQU   MACFLAGS                                                 04107000
MAABBREV EQU   MACFLAGS                                                 04108000
MAECTMOD EQU   MACFLAGS                                                 04109000
@NM00020 EQU   CAMAWKA                                                  04110000
CASTAEPL EQU   IKJEBECA+576                                             04111000
CASTAXPL EQU   IKJEBECA+556                                             04112000
CASRPLST EQU   CATMPLST+12                                              04113000
CASYNSCN EQU   CASYNSW                                                  04114000
CASYNML  EQU   CASYNSW                                                  04115000
CASYNSF  EQU   CASYNSW                                                  04116000
CASYNRFM EQU   CASYNSW                                                  04117000
CASYNIS  EQU   CASYNSW                                                  04118000
@NM00019 EQU   CASYNSW                                                  04119000
CASYNLN  EQU   CASYNSW                                                  04120000
@NM00018 EQU   CASYNSW                                                  04121000
CASYNRCL EQU   CASYNOPT+2                                               04122000
CASYNCD2 EQU   CASYNOPT+1                                               04123000
CASYNCD1 EQU   CASYNOPT                                                 04124000
CASYNTEM EQU   CASYNWA+12                                               04125000
CASYNMS2 EQU   CASYNWA+8                                                04126000
CASYNMS1 EQU   CASYNWA+4                                                04127000
CASYNWAP EQU   CASYNWA+1                                                04128000
CASYNECD EQU   CASYNWA                                                  04129000
CASYNPTO EQU   CASYNLST+8                                               04130000
CASYNPWA EQU   CASYNLST+4                                               04131000
CASYNBFR EQU   CASYNLST                                                 04132000
@NM00017 EQU   IKJEBECA+484                                             04133000
CAINSAVE EQU   IKJEBECA+476                                             04134000
@NM00016 EQU   IKJEBECA+472                                             04135000
CAIMLINC EQU   IKJEBECA+468                                             04136000
CAIMLLNO EQU   IKJEBECA+464                                             04137000
CANXTREC EQU   IKJEBECA+452                                             04138000
CASTNUM  EQU   IKJEBECA+448                                             04139000
CASAPSWD EQU   IKJEBECA+440                                             04140000
CASADDN  EQU   IKJEBECA+432                                             04141000
CASAMEMB EQU   IKJEBECA+424                                             04142000
CASADSN  EQU   IKJEBECA+380                                             04143000
CASADSNL EQU   IKJEBECA+378                                             04144000
CASADQTY EQU   CASAFLG2                                                 04145000
CASANCTG EQU   CASAFLG2                                                 04146000
CASAALOC EQU   CASAFLAG                                                 04147000
CASAUNCG EQU   CASAFLAG                                                 04148000
CASADSOR EQU   CASAFLAG                                                 04149000
CASAMEM  EQU   CASAFLAG                                                 04150000
CASADISP EQU   CASAFLAG                                                 04151000
CASAINCP EQU   CASAFLAG                                                 04152000
CASAFNCP EQU   CASAFLAG                                                 04153000
CASAVEDS EQU   CASAFLAG                                                 04154000
CADSNREC EQU   IKJEBECA+320                                             04155000
CADSNOFF EQU   IKJEBECA+318                                             04156000
CADSNLEN EQU   IKJEBECA+316                                             04157000
CADSNPTR EQU   IKJEBECA+312                                             04158000
CAEDTSIZ EQU   IKJEBECA+308                                             04159000
CAEDPSWD EQU   IKJEBECA+300                                             04160000
CAEDDDN  EQU   IKJEBECA+292                                             04161000
CAEDMEMB EQU   IKJEBECA+284                                             04162000
CAEDDSN  EQU   IKJEBECA+240                                             04163000
CAEDDSNL EQU   IKJEBECA+238                                             04164000
CAEDPRTC EQU   CAEDFLG2                                                 04165000
CAEDALOC EQU   CAEDFLAG                                                 04166000
CAEDUNCG EQU   CAEDFLAG                                                 04167000
CAEDDSOR EQU   CAEDFLAG                                                 04168000
CAEDMEM  EQU   CAEDFLAG                                                 04169000
CAEDDISP EQU   CAEDFLAG                                                 04170000
CAEDINCP EQU   CAEDFLAG                                                 04171000
CAEDFNCP EQU   CAEDFLAG                                                 04172000
CAEDITDS EQU   CAEDFLAG                                                 04173000
CABLK2   EQU   IKJEBECA+234                                             04174000
@NM00015 EQU   IKJEBECA+226                                             04175000
CAPDEND  EQU   CAPD+82                                                  04176000
CADATEXT EQU   CAPD+74                                                  04177000
CAEXTNAM EQU   CAPD+66                                                  04178000
CAPRNAME EQU   CAPD+58                                                  04179000
CACHKOPT EQU   CAPD+56                                                  04180000
CAULRLMX EQU   CAPD+54                                                  04181000
CAULRLDF EQU   CAPD+52                                                  04182000
CAVLRLMX EQU   CAPD+50                                                  04183000
CAVLRLDF EQU   CAPD+48                                                  04184000
CAFLRLMX EQU   CAPD+46                                                  04185000
CAFLRLDF EQU   CAPD+44                                                  04186000
CARECFMD EQU   CAPD+43                                                  04187000
@NM00014 EQU   CADSATR2                                                 04188000
CAINLIST EQU   CADSATR2                                                 04189000
CARUNDS  EQU   CADSATR2                                                 04190000
CAOBJGEN EQU   CADSATR2                                                 04191000
CADSNDEF EQU   CADSATR2                                                 04192000
CALINTAB EQU   CADSATR2                                                 04193000
@NM00013 EQU   CADSATTR                                                 04194000
CALRECLX EQU   CADSATTR                                                 04195000
CALNNUM  EQU   CADSATTR                                                 04196000
CADSCONT EQU   CADSATTR                                                 04197000
CACAPSDF EQU   CADSATTR                                                 04198000
CACAPSRQ EQU   CADSATTR                                                 04199000
CASCAN   EQU   CADSATTR                                                 04200000
CARUN    EQU   CADSATTR                                                 04201000
CASYNAME EQU   CAPD+32                                                  04202000
CATABS   EQU   CAPD+20                                                  04203000
CABLKS   EQU   CAPD+16                                                  04204000
CADSQUAL EQU   CAPD+8                                                   04205000
CADSTYPE EQU   CAPD                                                     04206000
@NM00012 EQU   CACFLAG+8                                                04207000
CAPLIRTM EQU   CACFLAG+7                                                04208000
CAPLILFM EQU   CACFLAG+6                                                04209000
@NM00011 EQU   CACFLAG6                                                 04210000
CACHAR60 EQU   CACFLAG6                                                 04211000
CACHAR48 EQU   CACFLAG6                                                 04212000
CAFREE   EQU   CACFLAG6                                                 04213000
@NM00010 EQU   CACFLAG5                                                 04214000
CAEDLNDP EQU   CACFLAG5                                                 04215000
CADSUSED EQU   CACFLAG4                                                 04216000
CARECURS EQU   CACFLAG4                                                 04217000
CAINPROC EQU   CACFLAG4                                                 04218000
CASCRC20 EQU   CACFLAG4                                                 04219000
CAABEND  EQU   CACFLAG4                                                 04220000
CATPUTVF EQU   CACFLAG4                                                 04221000
CAPTGTBF EQU   CACFLAG4                                                 04222000
CAFINDIS EQU   CACFLAG4                                                 04223000
@NM00009 EQU   CAIMFLG                                                  04224000
CAIMINPT EQU   CAIMFLG                                                  04225000
CAIMSFPT EQU   CAIMFLG                                                  04226000
CAIMCIN  EQU   CAIMFLG                                                  04227000
CAIMIR   EQU   CAIMFLG                                                  04228000
CAIMSC   EQU   CAIMFLG                                                  04229000
CAIMINS  EQU   CAIMFLG                                                  04230000
CAIMPT   EQU   CAIMFLG                                                  04231000
@NM00008 EQU   CACFLAG2                                                 04232000
CAMODMSG EQU   CACFLAG2                                                 04233000
CASCANON EQU   CACFLAG2                                                 04234000
CADSMODS EQU   CACFLAG2                                                 04235000
CACAPS   EQU   CACFLAG1                                                 04236000
CAENDSC  EQU   CACFLAG1                                                 04237000
CAINITSC EQU   CACFLAG1                                                 04238000
CASCANSW EQU   CACFLAG1                                                 04239000
CAPROMPT EQU   CACFLAG1                                                 04240000
@NM00007 EQU   CAATTN                                                   04241000
@NM00006 EQU   IKJEBECA+118                                             04242000
CAMAXBLK EQU   IKJEBECA+116                                             04243000
@NM00005 EQU   IKJEBECA+88                                              04244000
CAPTICLN EQU   IKJEBECA+84                                              04245000
CAPTICDS EQU   IKJEBECA+80                                              04246000
CAPTNBFR EQU   IKJEBECA+76                                              04247000
CAPTCHK  EQU   IKJEBECA+72                                              04248000
CACORELN EQU   IKJEBECA+68                                              04249000
CAPTCORE EQU   IKJEBECA+64                                              04250000
@NM00004 EQU   IKJEBECA+50                                              04251000
CASCMDLN EQU   IKJEBECA+48                                              04252000
CAPTSCMD EQU   IKJEBECA+44                                              04253000
CAPTRTRY EQU   IKJEBECA+32                                              04254000
CAPTMSGM EQU   IKJEBECA+28                                              04255000
CAPTAT   EQU   IKJEBECA+12                                              04256000
CAPTAE   EQU   IKJEBECA+8                                               04257000
@NM00003 EQU   IKJEBECA+4                                               04258000
CAPTTMP  EQU   IKJEBECA                                                 04259000
CVTLEVL  EQU   CVTRELNO+2                                               04260000
CVTNUMB  EQU   CVTRELNO                                                 04261000
CVTMDL   EQU   CVTFIX+250                                               04262000
@NM00002 EQU   CVTFIX+248                                               04263000
@NM00001 EQU   CVTFIX                                                   04264000
CVTRV482 EQU   CVTXTNT2+128                                             04265000
CVTRV481 EQU   CVTXTNT2+124                                             04266000
CVTRV480 EQU   CVTXTNT2+120                                             04267000
CVTRV479 EQU   CVTXTNT2+118                                             04268000
CVTRV478 EQU   CVTXTNT2+117                                             04269000
CVTRV477 EQU   CVTXTNT2+116                                             04270000
CVTRV476 EQU   CVTXTNT2+115                                             04271000
CVTRV475 EQU   CVTXTNT2+114                                             04272000
CVTRV474 EQU   CVTRV466                                                 04273000
CVTRV473 EQU   CVTRV466                                                 04274000
CVTRV472 EQU   CVTRV466                                                 04275000
CVTRV471 EQU   CVTRV466                                                 04276000
CVTRV470 EQU   CVTRV466                                                 04277000
CVTRV469 EQU   CVTRV466                                                 04278000
CVTRV468 EQU   CVTRV466                                                 04279000
CVTRV467 EQU   CVTRV466                                                 04280000
CVTRV465 EQU   CVTRV457                                                 04281000
CVTRV464 EQU   CVTRV457                                                 04282000
CVTRV463 EQU   CVTRV457                                                 04283000
CVTRV462 EQU   CVTRV457                                                 04284000
CVTRV461 EQU   CVTRV457                                                 04285000
CVTRV460 EQU   CVTRV457                                                 04286000
CVTRV459 EQU   CVTRV457                                                 04287000
CVTRV458 EQU   CVTRV457                                                 04288000
CVTRV456 EQU   CVTXTNT2+108                                             04289000
CVTRV455 EQU   CVTXTNT2+104                                             04290000
CVTRV454 EQU   CVTXTNT2+100                                             04291000
CVTRV453 EQU   CVTXTNT2+96                                              04292000
CVTRV452 EQU   CVTXTNT2+94                                              04293000
CVTRV451 EQU   CVTXTNT2+92                                              04294000
CVTRV450 EQU   CVTXTNT2+90                                              04295000
CVTRV449 EQU   CVTXTNT2+88                                              04296000
CVTRV448 EQU   CVTXTNT2+87                                              04297000
CVTRV447 EQU   CVTXTNT2+86                                              04298000
CVTRV446 EQU   CVTRV438                                                 04299000
CVTRV445 EQU   CVTRV438                                                 04300000
CVTRV444 EQU   CVTRV438                                                 04301000
CVTRV443 EQU   CVTRV438                                                 04302000
CVTRV442 EQU   CVTRV438                                                 04303000
CVTRV441 EQU   CVTRV438                                                 04304000
CVTRV440 EQU   CVTRV438                                                 04305000
CVTRV439 EQU   CVTRV438                                                 04306000
CVTRV437 EQU   CVTRV429                                                 04307000
CVTRV436 EQU   CVTRV429                                                 04308000
CVTRV435 EQU   CVTRV429                                                 04309000
CVTRV434 EQU   CVTRV429                                                 04310000
CVTRV433 EQU   CVTRV429                                                 04311000
CVTRV432 EQU   CVTRV429                                                 04312000
CVTRV431 EQU   CVTRV429                                                 04313000
CVTRV430 EQU   CVTRV429                                                 04314000
CVTRV428 EQU   CVTXTNT2+80                                              04315000
CVTRV427 EQU   CVTXTNT2+76                                              04316000
CVTRV426 EQU   CVTXTNT2+72                                              04317000
CVTRV425 EQU   CVTXTNT2+68                                              04318000
CVTATACT EQU   CVTATCVT                                                 04319000
CVTRV423 EQU   CVTXTNT2+62                                              04320000
CVTRV422 EQU   CVTXTNT2+60                                              04321000
CVTRV421 EQU   CVTXTNT2+58                                              04322000
CVTRV420 EQU   CVTXTNT2+56                                              04323000
CVTRV419 EQU   CVTXTNT2+55                                              04324000
CVTRV418 EQU   CVTXTNT2+54                                              04325000
CVTRV417 EQU   CVTRV409                                                 04326000
CVTRV416 EQU   CVTRV409                                                 04327000
CVTRV415 EQU   CVTRV409                                                 04328000
CVTRV414 EQU   CVTRV409                                                 04329000
CVTRV413 EQU   CVTRV409                                                 04330000
CVTRV412 EQU   CVTRV409                                                 04331000
CVTRV411 EQU   CVTRV409                                                 04332000
CVTRV410 EQU   CVTRV409                                                 04333000
CVTRV408 EQU   CVTRV400                                                 04334000
CVTRV407 EQU   CVTRV400                                                 04335000
CVTRV406 EQU   CVTRV400                                                 04336000
CVTRV405 EQU   CVTRV400                                                 04337000
CVTRV404 EQU   CVTRV400                                                 04338000
CVTRV403 EQU   CVTRV400                                                 04339000
CVTRV402 EQU   CVTRV400                                                 04340000
CVTRV401 EQU   CVTRV400                                                 04341000
CVTICB   EQU   CVTXTNT2+48                                              04342000
CVTSKTA  EQU   CVTXTNT2+44                                              04343000
CVTRSV99 EQU   CVTXTNT2+40                                              04344000
CVTRSV98 EQU   CVTXTNT2+36                                              04345000
CVTRSV97 EQU   CVTXTNT2+34                                              04346000
CVTRSV96 EQU   CVTXTNT2+32                                              04347000
CVTOLTEP EQU   CVTXTNT2+28                                              04348000
CVTQIDA  EQU   CVTQID+1                                                 04349000
CVTRSV95 EQU   CVTQID                                                   04350000
CVTRSV94 EQU   CVTXTNT2+20                                              04351000
CVTRSV93 EQU   CVTXTNT2+16                                              04352000
CVTRSV92 EQU   CVTXTNT2+12                                              04353000
CVTDEBVR EQU   CVTXTNT2+8                                               04354000
CVTRSV91 EQU   CVTXTNT2+6                                               04355000
CVTRSV9H EQU   CVTFLGBT                                                 04356000
CVTRSV9G EQU   CVTFLGBT                                                 04357000
CVTRSV9F EQU   CVTFLGBT                                                 04358000
CVTRSV9E EQU   CVTFLGBT                                                 04359000
CVTRSV9D EQU   CVTFLGBT                                                 04360000
CVTRSV9C EQU   CVTFLGBT                                                 04361000
CVTVME   EQU   CVTFLGBT                                                 04362000
CVTNPE   EQU   CVTFLGBT                                                 04363000
CVTNUCLS EQU   CVTXTNT2+4                                               04364000
CVTDSSVA EQU   CVTDSSV+1                                                04365000
CVTRSV89 EQU   CVTDSSV                                                  04366000
CVTRSV88 EQU   CVTXTNT1+8                                               04367000
CVTRSV87 EQU   CVTXTNT1+4                                               04368000
CVTFACHN EQU   CVTXTNT1                                                 04369000
CVTRV488 EQU   CVTMAP+412                                               04370000
CVTRV487 EQU   CVTMAP+408                                               04371000
CVTRV486 EQU   CVTMAP+404                                               04372000
CVTRV485 EQU   CVTMAP+400                                               04373000
CVTACTAP EQU   CVTMAP+396                                               04374000
CVTAUTH  EQU   CVTMAP+392                                               04375000
CVTATMCA EQU   CVTATMCT+1                                               04376000
CVTATMST EQU   CVTATMCT                                                 04377000
CVTRSV61 EQU   CVTMAP+384                                               04378000
CVTVOLT1 EQU   CVTVOLM1+1                                               04379000
CVTVOLI1 EQU   CVTVOLF1                                                 04380000
CVTSTOA  EQU   CVTMAP+376                                               04381000
CVTRSV58 EQU   CVTMAP+374                                               04382000
CVTRSV57 EQU   CVTMAP+372                                               04383000
CVTDDCE  EQU   CVTMAP+368                                               04384000
CVTPNWFR EQU   CVTMAP+364                                               04385000
CVTSMF   EQU   CVTMAP+360                                               04386000
CVTSULK  EQU   CVTMAP+358                                               04387000
CVTSLKO  EQU   CVTSYSK                                                  04388000
CVTSLKP  EQU   CVTSYSK                                                  04389000
CVTSLKQ  EQU   CVTSYSK                                                  04390000
CVTSLKR  EQU   CVTSYSK                                                  04391000
CVTRSV56 EQU   CVTSYSK                                                  04392000
CVTRSV55 EQU   CVTSYSK                                                  04393000
CVTRSV54 EQU   CVTSYSK                                                  04394000
CVTRSV53 EQU   CVTSYSK                                                  04395000
CVTRSV52 EQU   CVTA1F1                                                  04396000
CVTRSV51 EQU   CVTA1F1                                                  04397000
CVTRSV50 EQU   CVTA1F1                                                  04398000
CVTRSV49 EQU   CVTA1F1                                                  04399000
CVTRSV48 EQU   CVTA1F1                                                  04400000
CVTRSV47 EQU   CVTA1F1                                                  04401000
CVTSRSW  EQU   CVTA1F1                                                  04402000
CVTPFSW  EQU   CVTA1F1                                                  04403000
CVTPCVT  EQU   CVTMAP+352                                               04404000
CVTRSV46 EQU   CVTMAP+344                                               04405000
CVTRSV45 EQU   CVTMAP+340                                               04406000
CVTRSV44 EQU   CVTMAP+338                                               04407000
CVTRSV43 EQU   CVTMAP+336                                               04408000
CVTHJESA EQU   CVTHJES+1                                                04409000
CVTRSV42 EQU   CVTHJES                                                  04410000
CVTEXT2A EQU   CVTEXT2+1                                                04411000
CVTRSV41 EQU   CVTEXT2                                                  04412000
CVTAPFA  EQU   CVTAPF+1                                                 04413000
CVTRSV40 EQU   CVTAPF                                                   04414000
CVTRV518 EQU   CVTINTLA                                                 04415000
CVTRV517 EQU   CVTERPV                                                  04416000
CVTEORM  EQU   CVTMAP+312                                               04417000
CVTMCHPR EQU   CVTMAP+308                                               04418000
CVTTZ    EQU   CVTMAP+304                                               04419000
CVTJEPS  EQU   CVTMAP+300                                               04420000
CVTJESCT EQU   CVTMAP+296                                               04421000
CVTMODE  EQU   CVTMAP+292                                               04422000
CVTPTRV  EQU   CVTMAP+288                                               04423000
CVTREAL  EQU   CVTMAP+284                                               04424000
CVTRSV39 EQU   CVTMAP+280                                               04425000
CVTRSV38 EQU   CVTMAP+276                                               04426000
CVTDMSRA EQU   CVTDMSR+1                                                04427000
CVTRSV37 EQU   CVTDMSR                                                  04428000
CVTQMSGA EQU   CVTQMSG+1                                                04429000
CVTRSV36 EQU   CVTQMSG                                                  04430000
CVTAMFF  EQU   CVTMAP+264                                               04431000
CVTPURGA EQU   CVTPURG+1                                                04432000
CVTRSV35 EQU   CVTPURG                                                  04433000
CVTCBSP  EQU   CVTMAP+256                                               04434000
CVTATERA EQU   CVTATER+1                                                04435000
CVTSYST  EQU   CVTATER                                                  04436000
CVTVOLT2 EQU   CVTTAT                                                   04437000
CVTVOLI2 EQU   CVTVOLF2                                                 04438000
CVTAQAVB EQU   CVTAQAVT+1                                               04439000
CVTRSV34 EQU   CVTTCMFG                                                 04440000
CVTRSV33 EQU   CVTTCMFG                                                 04441000
CVTRSV32 EQU   CVTTCMFG                                                 04442000
CVTRSV31 EQU   CVTTCMFG                                                 04443000
CVTRSV30 EQU   CVTTCMFG                                                 04444000
CVTRSV29 EQU   CVTTCMFG                                                 04445000
CVTRSV28 EQU   CVTTCMFG                                                 04446000
CVTTCRDY EQU   CVTTCMFG                                                 04447000
CVTGTFA  EQU   CVTGTF+1                                                 04448000
CVTRSV27 EQU   CVTGTFST                                                 04449000
CVTRNIO  EQU   CVTGTFST                                                 04450000
CVTUSR   EQU   CVTGTFST                                                 04451000
CVTRV318 EQU   CVTFORM                                                  04452000
CVTRV317 EQU   CVTTMODE                                                 04453000
CVTRV316 EQU   CVTSTATE                                                 04454000
CVTRV315 EQU   CVTGTFS                                                  04455000
CVTGTFAV EQU   CVTGTFS                                                  04456000
CVT0SCR1 EQU   CVTMAP+232                                               04457000
CVTRV515 EQU   CVTMAP+228                                               04458000
CVTRMS   EQU   CVTMAP+224                                               04459000
CVTPATCH EQU   CVTMAP+220                                               04460000
CVTTSCE  EQU   CVTMAP+216                                               04461000
CVTLNKSC EQU   CVTMAP+214                                               04462000
CVTQABST EQU   CVTMAP+212                                               04463000
CVTMDLDS EQU   CVTMAP+208                                               04464000
CVTUSER  EQU   CVTMAP+204                                               04465000
CVTABEND EQU   CVTMAP+200                                               04466000
CVTSMCA  EQU   CVTMAP+196                                               04467000
CVTRSV18 EQU   CVTMAP+192                                               04468000
CVTQLPAQ EQU   CVTMAP+188                                               04469000
CVTQCDSR EQU   CVTMAP+184                                               04470000
CVTRSV17 EQU   CVTOPTB                                                  04471000
CVTRSV16 EQU   CVTOPTB                                                  04472000
CVTFP    EQU   CVTOPTB                                                  04473000
CVTAPTHR EQU   CVTOPTB                                                  04474000
CVTNLOG  EQU   CVTOPTB                                                  04475000
CVTTOD   EQU   CVTOPTB                                                  04476000
CVTCTIMS EQU   CVTOPTB                                                  04477000
CVTPROT  EQU   CVTOPTB                                                  04478000
CVTXPFP  EQU   CVTOPTA                                                  04479000
CVTASCII EQU   CVTOPTA                                                  04480000
CVTRSV13 EQU   CVTOPTA                                                  04481000
CVTRSV12 EQU   CVTOPTA                                                  04482000
CVTNIP   EQU   CVTOPTA                                                  04483000
CVTDDR   EQU   CVTOPTA                                                  04484000
CVTAPR   EQU   CVTOPTA                                                  04485000
CVTCCH   EQU   CVTOPTA                                                  04486000
CVTSNCTR EQU   CVTMAP+180                                               04487000
CVTQMWR  EQU   CVTMAP+176                                               04488000
CVTQOCR  EQU   CVTMAP+172                                               04489000
CVT1EF00 EQU   CVTMAP+168                                               04490000
CVTMZ00  EQU   CVTMAP+164                                               04491000
CVTHEAD  EQU   CVTMAP+160                                               04492000
CVTRSV11 EQU   CVTMAP+156                                               04493000
CVT0PT01 EQU   CVTMAP+152                                               04494000
CVTMSER  EQU   CVTMAP+148                                               04495000
CVTRV516 EQU   CVTIERLC                                                 04496000
CVTILCH  EQU   CVTMAP+140                                               04497000
CVT0DS   EQU   CVTMAP+136                                               04498000
CVTFBOSV EQU   CVTMAP+132                                               04499000
CVTNUCB  EQU   CVTMAP+128                                               04500000
CVTIXAVL EQU   CVTMAP+124                                               04501000
CVTIOQET EQU   CVTMAP+120                                               04502000
CVTDCBA  EQU   CVTMAP+117                                               04503000
CVTMVS2  EQU   CVTDCB                                                   04504000
CVT6DAT  EQU   CVTDCB                                                   04505000
CVT4MPS  EQU   CVTDCB                                                   04506000
CVTRSV09 EQU   CVTDCB                                                   04507000
CVT4MS1  EQU   CVTDCB                                                   04508000
CVT2SPS  EQU   CVTDCB                                                   04509000
CVT1SSS  EQU   CVTDCB                                                   04510000
CVTRSV08 EQU   CVTDCB                                                   04511000
CVTSTB   EQU   CVTMAP+112                                               04512000
CVTQTD00 EQU   CVTMAP+108                                               04513000
CVTQTE00 EQU   CVTMAP+104                                               04514000
CVTCUCB  EQU   CVTMAP+100                                               04515000
CVTSJQ   EQU   CVTMAP+96                                                04516000
CVTPBLDL EQU   CVTMAP+92                                                04517000
CVTTPC   EQU   CVTMAP+88                                                04518000
CVTSVDCB EQU   CVTMAP+84                                                04519000
CVTBRET  EQU   CVTMAP+82                                                04520000
CVTEXIT  EQU   CVTMAP+80                                                04521000
CVT0FN00 EQU   CVTMAP+76                                                04522000
CVTDARA  EQU   CVTDAR+1                                                 04523000
CVTRSV07 EQU   CVTFLGS1                                                 04524000
CVTRSV06 EQU   CVTFLGS1                                                 04525000
CVTRSV05 EQU   CVTFLGS1                                                 04526000
CVTRSV04 EQU   CVTFLGS1                                                 04527000
CVTRSV03 EQU   CVTFLGS1                                                 04528000
CVTRSV02 EQU   CVTFLGS1                                                 04529000
CVTRSV01 EQU   CVTFLGS1                                                 04530000
CVTDMPLK EQU   CVTFLGS1                                                 04531000
CVTXITP  EQU   CVTMAP+68                                                04532000
CVTZDTAB EQU   CVTMAP+64                                                04533000
CVTMSLT  EQU   CVTMAP+60                                                04534000
CVTDATE  EQU   CVTMAP+56                                                04535000
CVTBTERM EQU   CVTMAP+52                                                04536000
CVTSYSAD EQU   CVTMAP+48                                                04537000
CVTXTLER EQU   CVTMAP+44                                                04538000
CVTILK2  EQU   CVTMAP+40                                                04539000
CVTILK1  EQU   CVTMAP+36                                                04540000
CVTPRLTV EQU   CVTMAP+32                                                04541000
CVTPCNVT EQU   CVTMAP+28                                                04542000
CVT0VL00 EQU   CVTMAP+24                                                04543000
CVTXAPG  EQU   CVTMAP+20                                                04544000
CVTBUF   EQU   CVTMAP+16                                                04545000
CVTJOB   EQU   CVTMAP+12                                                04546000
CVTLINK  EQU   CVTMAP+8                                                 04547000
CVT0EF00 EQU   CVTMAP+4                                                 04548000
CVTTCBP  EQU   CVTMAP                                                   04549000
CVT      EQU   CVTMAP                                                   04550000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04551000
@RF00243 EQU   @RC00237                                                 04552000
@RC00241 EQU   @RC00237                                                 04553000
@RF00329 EQU   @RC00323                                                 04554000
@RC00344 EQU   @RC00343                                                 04555000
@RF00447 EQU   @EL00012                                                 04556000
@RC00439 EQU   @EL00012                                                 04557000
@RC00437 EQU   @EL00012                                                 04558000
@RF00497 EQU   @RC00493                                                 04559000
@RF00500 EQU   @RC00493                                                 04560000
@RF00663 EQU   @EL00021                                                 04561000
@RC00679 EQU   @EL00021                                                 04562000
@RC00737 EQU   @RC00736                                                 04563000
@RC00757 EQU   @RC00756                                                 04564000
@RF00358 EQU   @RC00344                                                 04565000
@RC00350 EQU   @RC00344                                                 04566000
@RC00442 EQU   @RC00439                                                 04567000
@RC00440 EQU   @RC00439                                                 04568000
@RF00355 EQU   @RC00350                                                 04569000
@ENDDATA EQU   *                                                        04570000
         END   IKJEBEMC,(C'PLS1616',0701,75328)                         04571000
