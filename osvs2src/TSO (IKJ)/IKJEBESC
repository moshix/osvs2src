         TITLE 'IKJEBESC - SCAN SUBCMD OF EDIT COMMAND - FIRST LOAD    *00001000
                        '                                               00002000
IKJEBESC CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEBESC  74.207'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @06,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@06                                    0001 00014000
*                                                                  0072 00015000
* /*                   END OF CVT MACRO                              */ 00016000
*                                                                  0073 00017000
*          /*********************************************************** 00018000
*          /* RESTRICT COMPILER'S USE OF REGISTERS.                   * 00019000
*          /*********************************************************** 00020000
*                                                                  0073 00021000
*           COMMREG = PARMREG1;      /* GET ADDR OF IKJEBECA         */ 00022000
*                                                                  0073 00023000
         LR    COMMREG,PARMREG1                                    0073 00024000
*           RESPECIFY (GPR13P,GPR15P) RSTD;                        0074 00025000
*           GPR15P = CANXTSVA;       /* SAVE AREA FOR THIS MODULE    */ 00026000
         L     GPR15P,CANXTSVA(,COMMREG)                           0075 00027000
*           EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS     */ 00028000
         LA    @14,4                                               0076 00029000
         ALR   @14,GPR15P                                          0076 00030000
         ST    GPR13P,CASAVPTR(,@14)                               0076 00031000
*                                    /* SAVEAREA BKWD PTR            */ 00032000
*           EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER   */ 00033000
         LA    @14,8                                               0077 00034000
         ALR   @14,GPR13P                                          0077 00035000
         ST    GPR15P,CASAVPTR(,@14)                               0077 00036000
*                                    /* FWD PTR                      */ 00037000
*           GPR13P = GPR15P;         /* NEW SAVEAREA ADDR            */ 00038000
         LR    GPR13P,GPR15P                                       0078 00039000
*           CANXTSVA = GPR13P + 72;   /* UPDATE NEX-SAVE-AREA PTR    */ 00040000
         LA    @14,72                                              0079 00041000
         ALR   @14,GPR13P                                          0079 00042000
         ST    @14,CANXTSVA(,COMMREG)                              0079 00043000
*           RESPECIFY (GPR13P,GPR15P) UNRSTD;                      0080 00044000
*                                                                  0080 00045000
*           DATAREG = ADDR(CASCWKA);   /* SET BASE REG FOR WORK AREA */ 00046000
         LA    DATAREG,CASCWKA(,COMMREG)                           0081 00047000
*           GEN( USING @DATD,DATAREG);   /* SET ADDRESSABILITY TO    */ 00048000
          USING @DATD,DATAREG                                           00049000
*                                    /* CASCWKA                      */ 00050000
*          RESPECIFY (PARMREG1,        /* PT TO PARAMETER LIST.       * 00051000
*                    BINRYREG,         /* BINARY VALUE.               * 00052000
*                    COMMREG,          /* PT TO COMMUNICATION AREA.   * 00053000
*                    BASEREG,          /* PROGRAM BASE REGISTER.      * 00054000
*                    BASEREG2,         /* 2ND PROGRAM BASE REGISTER   * 00055000
*                    DATAREG) RSTD;    /* WORK AREA BASE REGISTER.    * 00056000
*                                                                  0083 00057000
*          SCRETCD=0;                  /* INITLZ NORMAL RETURN CODE.  * 00058000
         SLR   @12,@12                                             0084 00059000
         ST    @12,SCRETCD                                         0084 00060000
*                                                                  0085 00061000
*          /*********************************************************** 00062000
*          /* OPERAND PROCESSING.                                     * 00063000
*          /*********************************************************** 00064000
*                                                                  0085 00065000
*          /* IS DATA SET TYPE A VALID ONE FOR SCANNING -             * 00066000
*                                                                  0085 00067000
*          IF CASCAN^='1'B THEN        /* DSTYPE CAN'T BE SCANNED.    * 00068000
         TM    CASCAN(COMMREG),B'01000000'                         0085 00069000
         BO    @RF00085                                            0085 00070000
*            DO;                       /* PREPARE AND ISSUE MESSAGE.  * 00071000
*              MSGPTR=0;               /* NO 2ND LEVEL INSERTIONS.    * 00072000
         ST    @12,MSGPTR(,COMMREG)                                0087 00073000
*              MSGLEN=LENGTH(CADSTYPE) /* LNG OF 2ND 1ST-LEVEL INSERT.* 00074000
*                +LENGTH(MSGLEN)                                   0088 00075000
*                +LENGTH(MSGOFF);                                  0088 00076000
         MVC   MSGLEN(2,COMMREG),@CH00151                          0088 00077000
*              MSGOFF=23;              /* OFFSET TO INSERTION.        * 00078000
         MVC   MSGOFF(2,COMMREG),@CH01192                          0089 00079000
*              MSGTEXT=CADSTYPE;       /* TEXT OF INSERTION.          * 00080000
         MVI   MSGTEXT+8(COMMREG),C' '                             0090 00081000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0090 00082000
         MVC   MSGTEXT(8,COMMREG),CADSTYPE(COMMREG)                0090 00083000
*              MSGPTR2=ADDR(MSGAREA);  /* PT TO 2ND INSERT INTO HEADER  00084000
*                                         OF 1ST INSERT.              * 00085000
         LA    @08,MSGAREA(,COMMREG)                               0091 00086000
         ST    @08,MSGPTR2                                         0091 00087000
*              MSGLEN2=LENGTH('SCAN')   /* LNG OF 1ST INSERTION.      * 00088000
*                +LENGTH(MSGLEN2)                                  0092 00089000
*                +LENGTH(MSGOFF2);                                 0092 00090000
         LA    MSGLEN2,8                                           0092 00091000
*              MSGOFF2=10;             /* OFFSET TO INSERTION.        * 00092000
         LA    MSGOFF2,10                                          0093 00093000
*              MSGTEXT2='SCAN';        /* TEXT OF INSERTION.          * 00094000
         MVC   MSGTEXT2(4),@CC01193                                0094 00095000
*              RELMSG1 =1796;          /* RELATIVE MSG NO.            * 00096000
         MVC   RELMSG1(2),@CH01194                                 0095 00097000
*              RELMSG2 =0;             /* NO 2ND-LEVEL MSG.           * 00098000
         STH   @12,RELMSG2                                         0096 00099000
*              LEV1INS =ADDR(MSGPTR2); /* PT TO UST-LEVEL INSERTION.  * 00100000
         LA    LEV1INS,MSGPTR2                                     0097 00101000
*              LEV2INS =0;             /* NO 2ND-LEVEL INSERTION.     * 00102000
         LR    LEV2INS,@12                                         0098 00103000
*              RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SENDING ROUTINE.  * 00104000
         LA    RETCDREG,SENDMSG                                    0099 00105000
*              CALL SENDMSG;           /* GO TO ISSUE IKJEBEML MACRO. * 00106000
         BAL   @14,SENDMSG                                         0100 00107000
*              GOTO FCNINCMP;          /* INDICATE FUNCTION INCOMPLETE  00108000
*                                         AND RETURN TO CALLER.       * 00109000
         B     FCNINCMP                                            0101 00110000
*            END;                      /* END MESSAGE ISSUANCE.       * 00111000
*          ELSE;                       /* DSTYPE CAN BE SCANNED.      * 00112000
*                                                                  0103 00113000
@RF00085 DS    0H                                                  0104 00114000
*          /* IS SYNTAX CHECKER RECOVERY IN PROGRESS.                 * 00115000
*                                                                  0104 00116000
*          IF CASCRC20='0'B THEN       /* NOT SYNTAX CHECKER RECOVERY.* 00117000
         TM    CASCRC20(COMMREG),B'00001000'                       0104 00118000
         BNZ   @RF00104                                            0104 00119000
*            DO;                       /* BEGIN STATUS-CHECKING.      * 00120000
*              CALL CHKNAME;           /* GO TO EXAMINE CHECKER NAME. * 00121000
*                                                                  0106 00122000
         BAL   @14,CHKNAME                                         0106 00123000
*              /* WAS SYNTAX CHECKER FOUND TO BE OPERATIONAL -        * 00124000
*                                                                  0107 00125000
*              IF RETCDREG^=0 THEN       /* CHECKER INOPERATIVE.      * 00126000
         LTR   RETCDREG,RETCDREG                                   0107 00127000
         BNZ   @RT00107                                            0107 00128000
*                GOTO NOSCNEXT;        /* RETURN TO CALLER.           * 00129000
*              ELSE;                   /* CHECKER OPERATIONAL.        * 00130000
*            END;                      /* END OF STATUS-CHECKING.     * 00131000
*          ELSE;                       /* SYNTAX CHECKER RECOVERY.    * 00132000
@RF00104 DS    0H                                                  0112 00133000
*          ENDSW='0'B;                 /* SET INTERNAL SW TO IND THAT   00134000
*                                         NO END OF ANY LINE RANGE HAS  00135000
*                                         BEEN ENCOUNTERED.           * 00136000
*                                                                  0112 00137000
         NI    ENDSW,B'10111111'                                   0112 00138000
*          /* IS THIS A SPECIAL CALL FROM THE CONTROLLER BECAUSE      * 00139000
*          /* 'SCAN' WAS ENTERED ON THE EDIT COMMAND,OR BECAUSE THE   * 00140000
*          /* DATA SET TYPE REQUIRES A RUN-TIME DATA SET,OR BECAUSE   * 00141000
*          /* A SYNTAX CHECKER FAILED AND IS TO BE RECOVERED -        * 00142000
*                                                                  0113 00143000
*          IF CAINITSC='1'B THEN       /* SPECIAL CALL FR CONTROLLER. * 00144000
         TM    CAINITSC(COMMREG),B'00001000'                       0113 00145000
         BO    @RT00113                                            0113 00146000
*            GOTO ONSPEC;              /* PROCEED AS IF 'SCAN ON' WERE  00147000
*                                         SPECIFIED.                  * 00148000
*          ELSE                        /* NOT A SPECIAL CALL FROM  0115 00149000
*                                         CONTROLLER.                 * 00150000
*                                                                  0115 00151000
*            /* IS THIS A SPECIAL CALL FOR END PROCESSING -           * 00152000
*                                                                  0115 00153000
*            IF CAENDSC='1'B THEN      /* SPECIAL CALL FOR CLEANUP.   * 00154000
         TM    CAENDSC(COMMREG),B'00000100'                        0115 00155000
         BO    @RT00115                                            0115 00156000
*              GOTO OFFSPEC;           /* PROCEED AS IF 'SCAN OFF' WERE 00157000
*                                         SPECIFIED.                  * 00158000
*            ELSE;                     /* NOT A SPECIAL CALL FOR   0117 00159000
*                                         CLEANUP.                    * 00160000
*                                                                  0117 00161000
*          /* WERE ANY OPERANDS SPECIFIED ON THE SUBCOMMAND -         * 00162000
*                                                                  0118 00163000
*          IF CAOPERND='1'B THEN       /* OPERAND(S) SPECIFIED.       * 00164000
         TM    CAOPERND(COMMREG),B'10000000'                       0118 00165000
         BNO   @RF00118                                            0118 00166000
*            DO;                       /* BEGIN PREPARATION OF PARSE    00167000
*                                         PARAMETER LIST, CALL OF  0119 00168000
*                                         PARSE, AND DIAGNOSIS OF  0119 00169000
*                                         RETURN CODE.                * 00170000
*              PPLPTR=ADDR(CATMPLST);  /* SET PT TO PARAMETER LIST.   * 00171000
         LA    @12,CATMPLST(,COMMREG)                              0120 00172000
         LR    PPLPTR,@12                                          0120 00173000
*              PPLPCL=ADDR(IKJEBSC1);  /* SET PT TO PARAMETER CONTROL   00174000
*                                         LIST.                       * 00175000
         L     @07,@CV00525                                        0121 00176000
         ST    @07,PPLPCL(,PPLPTR)                                 0121 00177000
*              PPLANS=ADDR(CAPTPRSD);  /* SET PT TO ANSWER PLACE.     * 00178000
         LA    @07,CAPTPRSD(,COMMREG)                              0122 00179000
         ST    @07,PPLANS(,PPLPTR)                                 0122 00180000
*              PPLCBUF=CAPTIBFR;       /* SET PT TO SUBCOMMAND BUFFER.* 00181000
         MVC   PPLCBUF(4,PPLPTR),CAPTIBFR(COMMREG)                 0123 00182000
*              PPLUWA=0;               /* NO VALIDITY EXIT ROUTINE.   * 00183000
         SLR   @07,@07                                             0124 00184000
         ST    @07,PPLUWA(,PPLPTR)                                 0124 00185000
*              RFY (PARMREG0,RETCDREG) RSTD;                       0125 00186000
*              LKLIBPTR=0;             /* NO  DCB ADDRESS SPECIFIED.  * 00187000
         LR    LKLIBPTR,@07                                        0126 00188000
*              DO; /*CALLTSSR EP(IKJPARS)MF(E,CATMPLST)*/          0127 00189000
*                RESPECIFY GPR01P RSTD;                            0128 00190000
*                GPR01P = ADDR(CATMPLST);                          0129 00191000
         LR    GPR01P,@12                                          0129 00192000
*                IF CVTPARS = 0                                    0130 00193000
*                  THEN                                            0130 00194000
         L     @14,CVTPTR                                          0130 00195000
         C     @07,CVTPARS(,@14)                                   0130 00196000
         BNE   @RF00130                                            0130 00197000
*                    GEN(LINK EP=IKJPARS);                         0131 00198000
         LINK EP=IKJPARS                                                00199000
*                  ELSE                                            0132 00200000
*                    CALL CVTPARS;                                 0132 00201000
         B     @RC00130                                            0132 00202000
@RF00130 L     @12,CVTPTR                                          0132 00203000
         L     @15,CVTPARS(,@12)                                   0132 00204000
         BALR  @14,@15                                             0132 00205000
*                RESPECIFY GPR01P UNRSTD;                          0133 00206000
@RC00130 DS    0H                                                  0134 00207000
*              END;                                                0134 00208000
*              RFY (PARMREG0,RETCDREG) UNRSTD;                     0135 00209000
*              RETCODE=RETCDREG;       /* PRESERVE RETURN CODE.       * 00210000
*                                                                  0136 00211000
         LR    RETCODE,RETCDREG                                    0136 00212000
*              /* WAS PARSING SUCCESSFUL -                            * 00213000
*                                                                  0137 00214000
*              IF RETCODE=0 THEN       /* PARSING SUCCESSFUL.         * 00215000
         SLR   @08,@08                                             0137 00216000
         CR    RETCODE,@08                                         0137 00217000
         BE    @RT00137                                            0137 00218000
*                GOTO ONTEST;          /* TEST FOR 'ON' OPERAND.      * 00219000
*              ELSE;                   /* PARSING UNSUCCESSFUL.       * 00220000
*                                                                  0139 00221000
*              /* WERE INVALID PARAMETERS SENT TO THE PARSING ROUTINE-* 00222000
*                                                                  0140 00223000
*              IF RETCODE=12 THEN       /* BAD PARAMETERS.            * 00224000
         CH    RETCODE,@CH00151                                    0140 00225000
         BNE   @RF00140                                            0140 00226000
*                DO;                   /* PREPARE AND ISSUE MESSAGE.  * 00227000
*                  RELMSG1 =271;       /* 1ST-LEVEL MSG NO.           * 00228000
         MVC   RELMSG1(2),@CH01202                                 0142 00229000
*                  RELMSG2 =1;         /* 2ND-LEVEL MSG NO.           * 00230000
         MVC   RELMSG2(2),@CH00039                                 0143 00231000
*                  LEV1INS =0;         /* NO 1ST-LEVEL INSERTION.     * 00232000
         LR    LEV1INS,@08                                         0144 00233000
*                  LEV2INS =ADDR(MSGAREA); /* PT TO 1ST 2ND-LEVEL  0145 00234000
*                                             INSERTION.              * 00235000
         LA    LEV2INS,MSGAREA(,COMMREG)                           0145 00236000
*                  MSGPTR=ADDR(MSGPTR2); /* PT TO 2ND 2ND-LEVEL    0146 00237000
*                                           INSERTION.                * 00238000
         LA    @12,MSGPTR2                                         0146 00239000
         ST    @12,MSGPTR(,COMMREG)                                0146 00240000
*                  MSGOFF=10;          /* OFFSET TO UST INSERTION.    * 00241000
         MVC   MSGOFF(2,COMMREG),@CH00387                          0147 00242000
*                  MSGLEN=LENGTH('PARSE')/*                        0148 00243000
*                                         LNG OF 1ST INSERTION.       * 00244000
*                    +LENGTH(MSGLEN)                               0148 00245000
*                    +LENGTH(MSGOFF);                              0148 00246000
         MVC   MSGLEN(2,COMMREG),@CH01286                          0148 00247000
*                  MSGTEXT='PARSE';    /* TEXT OF 1ST INSERTION.      * 00248000
         MVI   MSGTEXT+5(COMMREG),C' '                             0149 00249000
         MVC   MSGTEXT+6(66,COMMREG),MSGTEXT+5(COMMREG)            0149 00250000
         MVC   MSGTEXT(5,COMMREG),@CC01203                         0149 00251000
*                  MSGPTR2=0;          /* NO 3RD INSERTION.           * 00252000
         ST    @08,MSGPTR2                                         0150 00253000
*                  MSGOFF2=22;         /* OFFSET TO 2ND INSERTION.    * 00254000
         LA    MSGOFF2,22                                          0151 00255000
*                  MSGLEN2=LENGTH('12')     /* LNG OF  2ND INSERTION. * 00256000
*                    +LENGTH(MSGLEN2)                              0152 00257000
*                    +LENGTH(MSGOFF2);                             0152 00258000
         LA    MSGLEN2,6                                           0152 00259000
*                  MSGTEXT2='12';      /* TEXT OF 2ND INSERTION.      * 00260000
         MVI   MSGTEXT2+2,C' '                                     0153 00261000
         MVI   MSGTEXT2+3,C' '                                     0153 00262000
         MVC   MSGTEXT2(2),@CC01205                                0153 00263000
*                  RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SEND ROUTINE. * 00264000
         LA    RETCDREG,SENDMSG                                    0154 00265000
*                  CALL SENDMSG;       /* GO TO ISSUE IKJEBEML MACRO. * 00266000
         BAL   @14,SENDMSG                                         0155 00267000
*                  GOTO FCNINCMP;      /* INDICATE FUNCTION INCOMPLETE  00268000
*                                         AND RETURN TO CALLER.       * 00269000
         B     FCNINCMP                                            0156 00270000
*                END;                  /* END OF MESSAGE-ISSUANCE.    * 00271000
*              ELSE;                   /* NOT BAD PARAMETERS.         * 00272000
*                                                                  0158 00273000
@RF00140 DS    0H                                                  0159 00274000
*              /* WAS NOT ENOUGH STORAGE AVAILABLE FOR PARSING.       * 00275000
*                                                                  0159 00276000
*              IF RETCODE=16 THEN       /* NOT ENOUGH CORE.           * 00277000
*                                                                  0159 00278000
         CH    RETCODE,@CH00241                                    0159 00279000
         BNE   @RF00159                                            0159 00280000
*                /* CONTROL BRANCHES HERE WHEN RETURN CODES ARE       * 00281000
*                /* RECEIVED INDICATING INSUFFICIENT STORAGE.         * 00282000
*                                                                  0160 00283000
*                DO;                   /* PREPARE AND ISSUE MESSAGE.  * 00284000
*                  MSGPTR=0;           /* ONLY 1 INSERTION.           * 00285000
         SLR   @12,@12                                             0161 00286000
         ST    @12,MSGPTR(,COMMREG)                                0161 00287000
*                  MSGLEN=CASCMDLN     /* LNG OF INSERTION.           * 00288000
*                    +LENGTH(MSGLEN)                               0162 00289000
*                    +LENGTH(MSGOFF);                              0162 00290000
         LA    @08,4                                               0162 00291000
         AH    @08,CASCMDLN(,COMMREG)                              0162 00292000
         STH   @08,MSGLEN(,COMMREG)                                0162 00293000
*                  MSGOFF=45;          /* OFFSET TO INSERTION.        * 00294000
         MVC   MSGOFF(2,COMMREG),@CH01206                          0163 00295000
*                  MSGTEXT=            /* TEXT OF INSERTION.          * 00296000
*                    CAPTSCMD->LINENUM;                            0164 00297000
         MVI   MSGTEXT+8(COMMREG),C' '                             0164 00298000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0164 00299000
         L     @08,CAPTSCMD(,COMMREG)                              0164 00300000
         MVC   MSGTEXT(8,COMMREG),LINENUM(@08)                     0164 00301000
*                  RELMSG1 =270;       /* RELATIVE MSG NO.            * 00302000
         MVC   RELMSG1(2),@CH01207                                 0165 00303000
*                  RELMSG2 =0;         /* NO 2ND-LEVEL MSG.           * 00304000
         STH   @12,RELMSG2                                         0166 00305000
*                  LEV1INS =ADDR(MSGAREA); /* PT TO INSERT.           * 00306000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0167 00307000
*                  LEV2INS =0;         /* NO 2ND-LEVEL INSERT.        * 00308000
         LR    LEV2INS,@12                                         0168 00309000
*                  RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SNEDING RTN.  * 00310000
         LA    RETCDREG,SENDMSG                                    0169 00311000
*                  CALL SENDMSG;       /* GO TO ISSUE IKJEBEML MACRO. * 00312000
         BAL   @14,SENDMSG                                         0170 00313000
*                  GOTO FCNINCMP;      /* INDICATE FUNCTION INCOMPLETE  00314000
*                                         AND RETURN TO CALLER.       * 00315000
         B     FCNINCMP                                            0171 00316000
*                END;                  /* END MESSAGE-ISSUANCE.       * 00317000
*              ELSE;                   /* NOT INSUFFICIENT CORE, BUT    00318000
*                                         ATTN ISSUED OR UNABLE TO 0173 00319000
*                                         PROMPT USER.                * 00320000
*                                                                  0173 00321000
@RF00159 DS    0H                                                  0174 00322000
*              /* WAS PARSE UNABLE TO PROMPT USER -                   * 00323000
*                                                                  0174 00324000
*              IF RETCODE=4 THEN        /* UNABLE TO PROMPT.          * 00325000
         CH    RETCODE,@CH00452                                    0174 00326000
         BE    @RT00174                                            0174 00327000
*                GOTO FCNINCMP;        /* INDICATE FUNCTION INCOMPLETE  00328000
*                                         AND RETURN TO CALLER.       * 00329000
*              ELSE                    /* ATTN WAS ISSUED.            * 00330000
*                GOTO SCANEXIT;        /* CLEANUP AND RETURN.         * 00331000
         B     SCANEXIT                                            0176 00332000
*            END;                      /* END PARSING AND RETURN   0177 00333000
*                                         CODE DIAGNOSIS.             * 00334000
*          ELSE                        /* NO SUBCOMMAND OPERAND(S).   * 00335000
*            GOTO TOTLSCAN;            /* TRANSFER CONTROL TO 2ND LOAD  00336000
*                                         MODULE TO SCAN ENTIRE DATA    00337000
*                                         SET.                        * 00338000
*                                                                  0178 00339000
*ONTEST:   /* PARSING OF SUBCOMMAND OPERAND(S) SUCCESSFUL.  WAS THE   * 00340000
*          /* 'ON' KEYWORD SPECIFIED -                                * 00341000
*                                                                  0179 00342000
*          IF KEYWD=1 THEN             /* 'SCAN ON' SPECIFIED.        * 00343000
ONTEST   L     @12,CAPTPRSD(,COMMREG)                              0179 00344000
         CLC   KEYWD(2,@12),@CH00039                               0179 00345000
         BNE   @RF00179                                            0179 00346000
*                                                                  0180 00347000
*          /*********************************************************** 00348000
*          /* 'SCAN ON' PROCESSING.                                   * 00349000
*          /*********************************************************** 00350000
*                                                                  0180 00351000
*ONSPEC:   /* A SPECIAL CALL FROM THE CONTROLLER FOR INITIAL SYNTAX   * 00352000
*          /* CHECKER PROCESSING OR FOR SYNTAX CHECKER RECOVERY       * 00353000
*          /* RESULTS IN 'SCAN ON' PROCESSING.                        * 00354000
*                                                                  0180 00355000
*            DO;                       /* BEGIN 'SCAN ON' PROCESSING. * 00356000
*                                                                  0180 00357000
ONSPEC   DS    0H                                                  0181 00358000
*              /* IS SYNTAX CHECKER RECOVERY IN PROGRESS -            * 00359000
*                                                                  0181 00360000
*              IF CASCRC20='1'B THEN   /* SYNTAX CHECKER RECOVERY.    * 00361000
         TM    CASCRC20(COMMREG),B'00001000'                       0181 00362000
         BO    @RT00181                                            0181 00363000
*                GOTO FNLENTRY;        /* CLEAN UP AND DELETE SYNTAX    00364000
*                                         CHECKER BEFORE RELOADING AND  00365000
*                                         INITIALIZING IT.            * 00366000
*              ELSE;                   /* NOT SYNTAX CHECKER RECOVERY.* 00367000
*                                                                  0183 00368000
*RECOVER:      /* DURING SYNTAX CHECKER RECOVERY CONTROL RETURNS HERE * 00369000
*              /* AFTER CLEAN UP AND DELETION OF CHECKER.             * 00370000
*                                                                  0184 00371000
*              /* IS THIS AN ITF(INTERACTIVE TERMINAL FACILITY) DATA  * 00372000
*              /* SET, REQUIRING A RUN-TIME DATA SET IN PARALLEL WITH * 00373000
*              /* THE UTILITY DATA SET -                              * 00374000
*                                                                  0184 00375000
*              IF CADSCODE^=CABASIC                                0184 00376000
*                & CADSCODE^=CAIPLI THEN /* NOT AN ITF DATA SET.      * 00377000
RECOVER  CLI   CADSCODE(COMMREG),X'20'                             0184 00378000
         BE    @RF00184                                            0184 00379000
         CLI   CADSCODE(COMMREG),X'21'                             0184 00380000
         BE    @RF00184                                            0184 00381000
*                DO;                   /* BEGIN NON-ITF 'SCAN ON'  0185 00382000
*                                         PROCESSING.                 * 00383000
*                                                                  0185 00384000
*                  /* IS SCANNING ALREADY IN EFFECT, AND IS SYNTAX    * 00385000
*                  /* CHECKER RECOVERY NOT IN PROGRESS -              * 00386000
*                                                                  0186 00387000
*                  IF CASCANSW='1'B                                0186 00388000
*                    &CASCRC20='0'B THEN   /* SCAN ALREADY ON AND NOT   00389000
*                                             RECOVERY.               * 00390000
         TM    CASCANSW(COMMREG),B'00010000'                       0186 00391000
         BNO   @RF00186                                            0186 00392000
         TM    CASCRC20(COMMREG),B'00001000'                       0186 00393000
         BZ    @RT00186                                            0186 00394000
*                    GOTO SCANEXIT;    /* CLEAN UP AND RETURN.        * 00395000
*                  ELSE;               /* SCAN NOT YET ON, OR RECOVERY  00396000
*                                         IN PROGRESS.                * 00397000
*                                                                  0188 00398000
@RF00186 DS    0H                                                  0189 00399000
*                  /* IS THIS CALL DUE TO A 'SCAN ON' SUBCOMMAND, OR  * 00400000
*                  /* IS THIS SYNTAX CHECKER RECOVERY -               * 00401000
*                                                                  0189 00402000
*                  IF CAINITSC='0'B                                0189 00403000
*                    |CASCRC20='1'B THEN  /* NOT A SPECIAL CALL FROM    00404000
*                                            CONTROLLER, OR RECOVERY    00405000
*                                            IN PROGRESS.             * 00406000
         TM    CAINITSC(COMMREG),B'00001000'                       0189 00407000
         BZ    @RT00189                                            0189 00408000
         TM    CASCRC20(COMMREG),B'00001000'                       0189 00409000
         BNO   @RF00189                                            0189 00410000
@RT00189 DS    0H                                                  0190 00411000
*                    DO;               /* BEGIN LOADING OF SYNTAX  0190 00412000
*                                         CHECKER IF NECESSARY.       * 00413000
*                                                                  0190 00414000
*                      /* IS THE CHECKER ALREADY LOADED AND INITIA-   * 00415000
*                      /* LIZED FROM A PREVIOUS RECOVERY(THIS IS      * 00416000
*                      /* POSSIBLE ONLY WHEN 'SCAN ON' SUBCOMMAND HAS * 00417000
*                      /* BEEN ENTERED, FOR IF RECOVERY IS NOW IN     * 00418000
*                      /* PROGRESS THE CHECKER HAS JUST BEEN DELETED)-* 00419000
*                                                                  0191 00420000
*                      IF CAPTCHK^=0 THEN /* CHECKER ALREADY LOADED.  * 00421000
         ICM   @12,15,CAPTCHK(COMMREG)                             0191 00422000
         BNZ   @RT00191                                            0191 00423000
*                        GOTO SETON;   /* SET SWITCHES AND RETURN.    * 00424000
*                      ELSE;           /* CHECKER NOT YET LOADED.     * 00425000
*                      RFY PARMREG0 RSTD;                          0194 00426000
*                      PARMREG0=                                   0195 00427000
*                        ADDR(CASYNAME); /* SET PT TO ENTRY NAME.     * 00428000
         LA    PARMREG0,CASYNAME(,COMMREG)                         0195 00429000
*                      GEN (LOAD EPLOC=(0));/* GET USABLE COPY OF  0196 00430000
*                                              SYNTAX CHECKER.        * 00431000
         LOAD EPLOC=(0)                                                 00432000
*                      CAPTCHK=PARMREG0; /* SAVE PT TO ENTRY POINT.   * 00433000
         ST    PARMREG0,CAPTCHK(,COMMREG)                          0197 00434000
*                      RFY PARMREG0 UNRSTD;                        0198 00435000
*                    END;              /* END SYNTAX CHECKER LOADING. * 00436000
*                  ELSE;               /* THIS IS A SPECIAL CALL FROM   00437000
*                                         THE CONTROLLER BUT RECOVERY   00438000
*                                         IS NOT IN PROGRESS.  I.E.,    00439000
*                                         THE CONTROLLER HAS LOADED     00440000
*                                         THE CHECKER BECAUSE 'SCAN'    00441000
*                                         WAS SPECIFIED ON THE EDIT     00442000
*                                         COMMAND, BUT AN INITIAL ENTRY 00443000
*                                         OF THE CHECKER MUST BE MADE.* 00444000
@RF00189 DS    0H                                                  0201 00445000
*                  CALL INITPLST;      /* INITIALIZE INTERFACE.       * 00446000
         BAL   @14,INITPLST                                        0201 00447000
*                  PARMREG1=ADDR(CASYNLST); /* SET PT TO ADDRESS LIST.* 00448000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0202 00449000
*                  CALL CHECKER;       /* INITIAL ENTRY TO SYNTAX  0203 00450000
*                                         CHECKER, NO LINES FURNISHED   00451000
*                                         FOR SCANNING.               * 00452000
         L     @15,CAPTCHK(,COMMREG)                               0203 00453000
         BALR  @14,@15                                             0203 00454000
*                  RETCODE=RETCDREG;   /* PRESERVE RETURN CODE.       * 00455000
         LR    RETCODE,RETCDREG                                    0204 00456000
*                  CASYNMS1=0;         /* REINITLZ 1ST-LEVEL MSG PT.  * 00457000
         SLR   @08,@08                                             0205 00458000
         ST    @08,CASYNMS1(,COMMREG)                              0205 00459000
*                  CASYNMS2=0;         /* REINITLZ 2ND-LEVEL MSG PT.  * 00460000
*                                                                  0206 00461000
         ST    @08,CASYNMS2(,COMMREG)                              0206 00462000
*                  /* WAS INITIAL CALL OF SYNTAX CHECKER SUCCESSFUL - * 00463000
*                                                                  0207 00464000
*                  IF RETCODE^=0 THEN       /* ERROR DURING INIT CALL.* 00465000
*                                                                  0207 00466000
         CR    RETCODE,@08                                         0207 00467000
         BE    @RF00207                                            0207 00468000
*                    /* WAS NOT ENOUGH STORAGE AVAILABLE -            * 00469000
*                                                                  0208 00470000
*                    IF RETCODE=16 THEN       /* NOT ENOUGH CORE.     * 00471000
         CH    RETCODE,@CH00241                                    0208 00472000
         BE    @RT00208                                            0208 00473000
*                      GOTO INITERR;   /* BRANCH TO TREAT INOPERATIVE   00474000
*                                         SYNTAX CHECKER (CONTROL USED  00475000
*                                         TO BRANCH TO 'NOCORMSG', BUT  00476000
*                                         THIS CAUSED A NON-INITIALIZED 00477000
*                                         COPY OF THE SYNTAX CHECKER TO 00478000
*                                         REMAIN IN CORE).            * 00479000
*                    ELSE              /* ERROR NOT INSUFFICIENT CORE.* 00480000
*                                                                  0210 00481000
*INITERR:              /* CONTROL COMES HERE WHENEVER A SYNTAX CHECKER* 00482000
*                      /* BECOMES INOPERATIVE DURING AN INITIAL ENTRY.* 00483000
*                                                                  0210 00484000
*                      DO;             /* BEGIN CLEAN UP AND DELETION   00485000
*                                         OF SYNTAX CHECKER.          * 00486000
INITERR  DS    0H                                                  0211 00487000
*                        FIRSTENT='1'B; /* SET BIT IN SYNTAX CHECKER    00488000
*                                          COMMUNICATION AREA TO INDI-  00489000
*                                          CATE NOT FIRST ENTRY.      * 00490000
*                        LASTENT='1'B;  /* SET BIT IN SYNTAX CHECKER    00491000
*                                          COMMUNICATION AREA TO INDI-  00492000
*                                          CATE FINAL ENTRY.          * 00493000
         OI    FIRSTENT(COMMREG),B'10100000'                       0212 00494000
*                        CASYNBFR=0;   /* NO LINES TO BE SCANNED.     * 00495000
         SLR   @12,@12                                             0213 00496000
         ST    @12,CASYNBFR(,COMMREG)                              0213 00497000
*                        PARMREG1=                                 0214 00498000
*                          ADDR(CASYNLST); /* SET PT TO ADDRESS LIST. * 00499000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0214 00500000
*                        RETCDREG=CAPTCHK; /* SET PT TO ENTRY POINT.  * 00501000
         L     @12,CAPTCHK(,COMMREG)                               0215 00502000
         LR    RETCDREG,@12                                        0215 00503000
*                        CALL CHECKER; /* FINAL ENTRY TO SYNTAX CHECKER 00504000
*                                         NO LINES TO BE SCANNED.     * 00505000
         LR    @15,@12                                             0216 00506000
         BALR  @14,@15                                             0216 00507000
*                        PARMREG0=                                 0217 00508000
*                          ADDR(CASYNAME); /* SET PT TO ENTRY NAME.   * 00509000
         LA    PARMREG0,CASYNAME(,COMMREG)                         0217 00510000
*                        GEN (DELETE EPLOC=(PARMREG0)); /* FREE CORE. * 00511000
         DELETE EPLOC=(PARMREG0)                                        00512000
*                        CAPTCHK=0;    /* INDICATE NO CHECKER LOADED. * 00513000
         SLR   @12,@12                                             0219 00514000
         ST    @12,CAPTCHK(,COMMREG)                               0219 00515000
*                        CASYNAME=                                 0220 00516000
*                          'FFFFFFFFFFFFFFFF'X;/*                  0220 00517000
*                                         INDICATE CHECKER NOT OPERA-   00518000
*                                         TIVE(AS OPPOSED TO NOT IN     00519000
*                                         SYSTEM) BY SETTING ITS NAME   00520000
*                                         TO BINARY ONES.             * 00521000
         MVC   CASYNAME(8,COMMREG),@CB01218                        0220 00522000
*                        CASCANSW='0'B;   /* TURN OFF SCAN SWITCH.    * 00523000
*                        CAPROMPT='0'B;   /* TURN OFF PORMPT SWITCH.  * 00524000
         NI    CASCANSW(COMMREG),B'11001111'                       0222 00525000
*                        CASCRC20='1'B;  /* SET RECOVERY SWITCH ON,     00526000
*                                           BECAUSE CONTROLLER WILL     00527000
*                                           REVERSE IT SETTING AND RE-  00528000
*                                           CALL THIS MODULE, AND THIS  00529000
*                                           MODULE WILL THEN CHECK THE  00530000
*                                           SYNTAX CHECKER NAME AND     00531000
*                                           ISSUE A DIAGNOSTIC.       * 00532000
         OI    CASCRC20(COMMREG),B'00001000'                       0223 00533000
*                        SCRETCD=16;      /* SET RET CODE TO INDICATE   00534000
*                                            CHECKER MALFUNCTION.     * 00535000
         MVC   SCRETCD(4),@CF00241                                 0224 00536000
*                        GOTO SCANEXIT; /* CLEAN UP AND RETURN.       * 00537000
         B     SCANEXIT                                            0225 00538000
*                      END;            /* END SYNTAX CHECKER DELETION.* 00539000
*                  ELSE                /* NO ERROR DURING INITIAL CALL  00540000
*                                         OF SYNTAX CHECKER.          * 00541000
*                    DO;               /* INITIALIZATION OR RECOVERY OF 00542000
*                                         CHECKER IS COMPLETE, SO BEGIN 00543000
*                                         SETTING SWITCHES.           * 00544000
@RF00207 DS    0H                                                  0228 00545000
*                      FIRSTENT='1'B;  /* SET BIT IN SYNTAX CHECKER COM 00546000
*                                         AREA TO IND FUTURE ENTRIES    00547000
*                                         ARE NOT INITIAL ONES.       * 00548000
*                      INCOMPST='0'B;  /* SET BIT IN SYNTAX CKR COMM    00549000
*                                         AREA TO REQUEST THAT ANY 0229 00550000
*                                         POTENTIALLY INCOMPLETE STATE- 00551000
*                                         MENTS BE DIAGNOSED AS THEY    00552000
*                                         STAND.                      * 00553000
*                                                                  0229 00554000
         OI    FIRSTENT(COMMREG),B'10000000'                       0229 00555000
         NI    INCOMPST(COMMREG),B'11101111'                       0229 00556000
*                      /* IS SYNTAX CHECKER RECOVERY IN PROGRESS -    * 00557000
*                                                                  0230 00558000
*                      IF CASCRC20='0'B THEN   /* NOT RECOVERY.       * 00559000
         TM    CASCRC20(COMMREG),B'00001000'                       0230 00560000
         BZ    @RT00230                                            0230 00561000
*                        GOTO SETON;   /* SET SWS TO IND SCAN IN   0231 00562000
*                                         EFFECT.                     * 00563000
*                      ELSE            /* RECOVERY IN PROGRESS.       * 00564000
*                        GOTO SWITCHON;/* SET SWS TO IND SCAN IN EFFECT 00565000
*                                         IF IT WAS IN EFFECT BEFORE A  00566000
*                                         SYNTAX CHECKER FAILURE   0232 00567000
*                                         CAUSED RECOVERY TO BE    0232 00568000
*                                         UNDERTAKEN.                 * 00569000
         B     SWITCHON                                            0232 00570000
*                    END;              /* END SWITCH-SETTING WHICH 0233 00571000
*                                         FOLLOWS SYNTAX CHECKER   0233 00572000
*                                         INITIALIZATION OR RECOVERY. * 00573000
*                END;                  /* END OF NON-ITF 'SCAN ON' 0234 00574000
*                                         PROCESSING.                 * 00575000
*              ELSE                    /* ITF DATA SET TYPE, REQUIRING  00576000
*                                         A RUN-TIME DATA SET.        * 00577000
*                DO;                   /* BEGIN ITF 'SCAN ON'      0235 00578000
*                                         PROCESSING.                 * 00579000
*                                                                  0235 00580000
@RF00184 DS    0H                                                  0236 00581000
*                  /* IS THIS SPECIAL CALL FROM THE CONTROLLER TO     * 00582000
*                  /* INITLZ THE CHECKER FOR AN ITF DATA SET, OR TO   * 00583000
*                  /* LOAD AND INITLZ THE CHECKER FOR RECOVERY -      * 00584000
*                                                                  0236 00585000
*                  IF CAINITSC='0'B THEN   /* NOT A SPECIAL CALL.     * 00586000
         TM    CAINITSC(COMMREG),B'00001000'                       0236 00587000
         BZ    @RT00236                                            0236 00588000
*                    GOTO SETON;       /* SIMPLY SET SWS TO IND SCAN IN 00589000
*                                         EFFECT, SINCE CHECKER HAS     00590000
*                                         ALREADY BEEN LOADED AND  0237 00591000
*                                         INITLZD DURING COMMAND   0237 00592000
*                                         PROCESSING.                 * 00593000
*                  ELSE;               /* SPECIAL CALL FR CONTROLLER. * 00594000
*                                                                  0238 00595000
*                  /* IS THE CHECKER ALREADY LOADED (THIS WILL BE THE * 00596000
*                  /* CASE WHEN, AND ONLY WHEN, THIS IS A SPECIAL     * 00597000
*                  /* CALL FROM THE CONTROLLER FOR INITIAL SYNTAX     * 00598000
*                  /* CHECKER PROCESSING, FOR IF RECOVERY IS NOW IN   * 00599000
*                  /* PROGRESS THE CHECKER HAS BEEN DELETED.) -       * 00600000
*                                                                  0239 00601000
*                  IF CAPTCHK=0 THEN   /* ITF CHECKER NOT LOADED.     * 00602000
         ICM   @12,15,CAPTCHK(COMMREG)                             0239 00603000
         BNZ   @RF00239                                            0239 00604000
*                    DO;               /* BEGIN ITF CHECKER LOADING.  * 00605000
*                      RFY PARMREG0 RSTD;                          0241 00606000
*                      PARMREG0=                                   0242 00607000
*                        ADDR(CASYNAME); /* SET PT TO ENTRY NAME.     * 00608000
         LA    PARMREG0,CASYNAME(,COMMREG)                         0242 00609000
*                      GEN (LOAD EPLOC=(0));/* LOAD CHECKER.          * 00610000
         LOAD EPLOC=(0)                                                 00611000
*                      CAPTCHK=PARMREG0; /* SAVE ENTRY POINT ADDRESS. * 00612000
         ST    PARMREG0,CAPTCHK(,COMMREG)                          0244 00613000
*                      RFY PARMREG0 UNRSTD;                        0245 00614000
*                    END;              /* END ITF CHECKER LOADING.    * 00615000
*                  ELSE;               /* ITF CHECKER ALREADY LOADED. * 00616000
@RF00239 DS    0H                                                  0248 00617000
*                  CALL INITPLST;      /* INITIALIZE INTERFACE.       * 00618000
         BAL   @14,INITPLST                                        0248 00619000
*                  PARMREG1=ADDR(CASYNLST); /* SET PT TO ADDRESS LIST.* 00620000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0249 00621000
*                  CALL CHECKER;       /* INITIAL ENTRY OF ITF SYNTAX   00622000
*                                         CHECKER, NO LINES FURNISHED   00623000
*                                         FOR SCANNING.               * 00624000
         L     @15,CAPTCHK(,COMMREG)                               0250 00625000
         BALR  @14,@15                                             0250 00626000
*                  RETCODE=RETCDREG;   /* PRESERVE RETURN CODE.       * 00627000
         LR    RETCODE,RETCDREG                                    0251 00628000
*                  CASYNMS1=0;         /* RE-INITLZ 1ST-LEVEL MSG PT. * 00629000
         SLR   @08,@08                                             0252 00630000
         ST    @08,CASYNMS1(,COMMREG)                              0252 00631000
*                  CASYNMS2=0;         /* RE-INITLZ 2ND-LEVEL MSG PT. * 00632000
*                                                                  0253 00633000
         ST    @08,CASYNMS2(,COMMREG)                              0253 00634000
*                  /* WAS INITIAL CALL TO ITF SUCCESSFUL -            * 00635000
*                                                                  0254 00636000
*                  IF RETCODE^=0 THEN       /* ERROR IN INITIAL CALL. * 00637000
         CR    RETCODE,@08                                         0254 00638000
         BNE   @RT00254                                            0254 00639000
*                    GOTO INITERR;     /* CLEAN UP AND DELETE ITF  0255 00640000
*                                         SYNTAX CHECKER.             * 00641000
*                  ELSE                /* INITIAL CALL TO ITF OK.     * 00642000
*                    DO;               /* BEGIN UPDATING  INTERFACE.  * 00643000
*                      FIRSTENT='1'B;  /* SET BIT IN SYNTAX CKR COMM    00644000
*                                         AREA TO IND THAT FUTURE CALLS 00645000
*                                         ARE NOT INITIAL ONES.       * 00646000
*                      INCOMPST='0'B;  /* SET BIT IN SYNTAX CKR COMM    00647000
*                                         AREA TO IND THAT NEXT CALL    00648000
*                                         DOESN'T FOLLOW RET CODE 12. * 00649000
         OI    FIRSTENT(COMMREG),B'10000000'                       0258 00650000
         NI    INCOMPST(COMMREG),B'11101111'                       0258 00651000
*                    END;              /* END UPDATING OF INTERFACE.  * 00652000
*                                                                  0260 00653000
*          /*********************************************************** 00654000
*          /* TRANSLATION OF LINES INTO RUN-TIME FORM.                * 00655000
*          /*********************************************************** 00656000
*                                                                  0260 00657000
*                  /* LINES MUST BE SENT TO SYNTAX CHECKER ONE AT A   * 00658000
*                  /* TIME FOR TRANSLATION INTO RUN-TIME FORM.        * 00659000
*                                                                  0260 00660000
*                  KEYPTR=0;           /* NO KEY SPEC FOR READ-1ST.   * 00661000
         ST    @08,KEYPTR                                          0260 00662000
*                  UTCODE='04'X;       /* OPTION CODE FOR 'READ 1ST'. * 00663000
         MVI   UTCODE,X'04'                                        0261 00664000
*                  DCBPTR=CAPTCDCB;    /* PT TO CURRENT UTILITY DCB.  * 00665000
         MVC   DCBPTR(3),CAPTCDCB+1(COMMREG)                       0262 00666000
*                  AREAPTR=                                        0263 00667000
*                    ADDR(UTBUFFER);   /* PT TO INPUT BUFFER.         * 00668000
         LA    @08,UTBUFFER(,COMMREG)                              0263 00669000
         ST    @08,AREAPTR                                         0263 00670000
*                  PLISTEND='1'B;      /* MARK END OF PARAMETER LIST. * 00671000
         OI    PLISTEND,B'10000000'                                0264 00672000
*                  GEN;                /* CALL ACCESS METHOD FOR READ.* 00673000
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        C00674000
               MF=(E,SRPLIST)          INVOKE ACCESS METHOD FOR READ.   00675000
*                  RETCODE=RETCDREG;   /* PRESERVE RETURN CODE.       * 00676000
*                                                                  0266 00677000
         LR    RETCODE,RETCDREG                                    0266 00678000
*                  /* CHECK   FOR I/O ERROR.                          * 00679000
*                                                                  0267 00680000
*                  IF RETCODE=8 THEN        /* I/O ERROR ON UTILITY.  * 00681000
*                                                                  0267 00682000
         CH    RETCODE,@CH00044                                    0267 00683000
         BNE   @RF00267                                            0267 00684000
*IOERROR:            /* CONTROL COMES HERE AFTER ANY UTILITY I/O ERR. * 00685000
*                                                                  0268 00686000
*                    DO;               /* BEGIN I/O ERROR CLEANUP.    * 00687000
IOERROR  DS    0H                                                  0269 00688000
*                      SCRETCD=12;     /* SET RET CODE FOR CONTROLLER.* 00689000
         MVC   SCRETCD(4),@CF00151                                 0269 00690000
*                      INPUTCD='0'B;   /* RESET OPTION WORD BIT TO IND  00691000
*                                         NOT INPUT LINES.            * 00692000
         NI    INPUTCD(COMMREG),B'01111111'                        0270 00693000
*                      GOTO SCANEXIT;  /* CLEAN UP AND EXIT.          * 00694000
         B     SCANEXIT                                            0271 00695000
*                    END;              /* END CLEANUP AFTER I/O ERROR.* 00696000
*                  ELSE                /* NO I/O ERROR ON UTILITY.    * 00697000
*                                                                  0273 00698000
*                    /* ARE THERE NO RECORDS IN DATA SET -            * 00699000
*                                                                  0273 00700000
*                    IF RETCODE=4 THEN        /* EMPTY DATA SET.      * 00701000
@RF00267 CH    RETCODE,@CH00452                                    0273 00702000
         BE    @RT00273                                            0273 00703000
*                      GOTO SWITCHON;  /* SET SWITCHES CONDITIONALLY. * 00704000
*                    ELSE;             /* 1ST RECORD FOUND.           * 00705000
*                  INPUTCD='1'B;       /* SET OPTION WORD BIT TO IND    00706000
*                                         THAT AN INPUT LINE IS TO BE   00707000
*                                         TRANSLATED.                 * 00708000
*                                                                  0276 00709000
         OI    INPUTCD(COMMREG),B'10000000'                        0276 00710000
*                  /* WAS 'SCAN' KEYWORD ON EDIT COMMAND -            * 00711000
*                                                                  0277 00712000
*                  IF CASCANON='1'B THEN  /* 'SCAN' SPECIFIED.        * 00713000
         TM    CASCANON(COMMREG),B'00100000'                       0277 00714000
         BNO   @RF00277                                            0277 00715000
*                    SCANOPT='0'B;     /* SET OPTION WORD BIT TO IND    00716000
*                                         SCANNING IN EFFECT, ANY MSGS  00717000
*                                         SHOULD BE ISSUED.           * 00718000
         NI    SCANOPT(COMMREG),B'11111110'                        0278 00719000
*                  ELSE                /* 'NOSCAN' SPECIFIED OR    0279 00720000
*                                         DEFAULTED.                  * 00721000
*                    SCANOPT='1'B;     /* SET OPTION WORD BIT TO IND    00722000
*                                         SCANNING NOT IN EFFECT, ANY   00723000
*                                         MSGS SHOULD BE QUEUED FOR     00724000
*                                         ISSUANCE AT RUN TIME.       * 00725000
         B     @RC00277                                            0279 00726000
@RF00277 OI    SCANOPT(COMMREG),B'00000001'                        0279 00727000
*                  CASYNBFR=ADDR(SYNBUFFR);/* SET PT TO BUFFER.       * 00728000
*                                                                  0280 00729000
@RC00277 LA    @12,SYNBUFFR(,COMMREG)                              0280 00730000
         ST    @12,CASYNBFR(,COMMREG)                              0280 00731000
*CALLCHKR:         /* CONTROL REPEATEDLY LOOPS BACK TO THIS POINT TO  * 00732000
*                  /* SEND SINGLE LINES TO ITF PROCESSOR FOR          * 00733000
*                  /* TRANSLATION.                                    * 00734000
*                                                                  0281 00735000
*                  RECNO=1;            /* SET NO. OF RCDS IN BUFFER.  * 00736000
CALLCHKR MVI   RECNO(COMMREG),X'01'                                0281 00737000
*                  CHAINPTR=0;         /* NO BUFFERS CHAINED TO THIS    00738000
*                                         ONE.                        * 00739000
*                                                                  0282 00740000
         SLR   @12,@12                                             0282 00741000
         STCM  @12,7,CHAINPTR(COMMREG)                             0282 00742000
*                  /* TEST RECORD FORMAT.                             * 00743000
*                                                                  0283 00744000
*                  IF CARECFM='0'B THEN   /* RECFM=VB.                * 00745000
         TM    CARECFM(COMMREG),B'01000000'                        0283 00746000
         BNZ   @RF00283                                            0283 00747000
*                    RECORD(1:LL)=     /* MOVE DATA,HEADER INTO BFR.  * 00748000
*                      UTBUFFER(1+LENGTH(KEY):LL);                 0284 00749000
         SLR   @12,@12                                             0284 00750000
         ICM   @12,3,LL(COMMREG)                                   0284 00751000
         BCTR  @12,0                                               0284 00752000
         EX    @12,@SM01386                                        0284 00753000
*                  ELSE                /* RECFM=FB.                   * 00754000
*                    RECORD(1:LL-4)=                               0285 00755000
*                      LINE;           /* MOVE ONLY DATA INTO BUFFER. * 00756000
         B     @RC00283                                            0285 00757000
@RF00283 SLR   @12,@12                                             0285 00758000
         ICM   @12,3,LL(COMMREG)                                   0285 00759000
         SH    @12,@CH00138                                        0285 00760000
         EX    @12,@SM01388                                        0285 00761000
*                  PARMREG1=ADDR(CASYNLST);/* SET PT TO ADDRESS LIST. * 00762000
@RC00283 LA    PARMREG1,CASYNLST(,COMMREG)                         0286 00763000
*                  CALL CHECKER;       /* INVOKE ITF PROCESSOR FOR 0287 00764000
*                                         TRANSLATION OF A LINE.      * 00765000
         L     @15,CAPTCHK(,COMMREG)                               0287 00766000
         BALR  @14,@15                                             0287 00767000
*                  RETCODE=RETCDREG;   /* PRESERVE RET CODE FOR TESTS.* 00768000
*                                                                  0288 00769000
         LR    RETCODE,RETCDREG                                    0288 00770000
*                  /* HAS ITF PROCESSOR BECOME INOPERATIVE (DUE TO    * 00771000
*                  /* NOT ENOUGH CORE OR CHECKER FAILURE) -           * 00772000
*                                                                  0289 00773000
*                  IF RETCODE>=16 THEN       /* PROCESSOR INOPERATIVE.* 00774000
         CH    RETCODE,@CH00241                                    0289 00775000
         BNL   @RT00289                                            0289 00776000
*                    GOTO INITERR;     /* CLEAN UP AND DELETE ITF  0290 00777000
*                                         PROCESSOR.                  * 00778000
*                  ELSE                /* PROCESSOR STILL OPERATIVE.  * 00779000
*                    UTCODE='02'X;     /* SET ACCESS METHOD OPTION CODE 00780000
*                                        TO READ NEXT RECORD.         * 00781000
         MVI   UTCODE,X'02'                                        0291 00782000
*                  GEN;                /* ISSUE MACRO TO READ NEXT.   * 00783000
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        C00784000
               MF=(E,SRPLIST)          INVOKE ACCESS METHOD.            00785000
*                  RETCODE=RETCDREG;   /* PRESERVE RET CODE.          * 00786000
*                                                                  0293 00787000
         LR    RETCODE,RETCDREG                                    0293 00788000
*                  /* CHECK FOR I/O ERROR ON UTILITY DATA SET.        * 00789000
*                                                                  0294 00790000
*                  IF RETCODE=8 THEN        /* I/O ERROR.             * 00791000
         CH    RETCODE,@CH00044                                    0294 00792000
         BE    @RT00294                                            0294 00793000
*                    GOTO IOERROR;     /* SET RET CODE AND CLEAN UP.  * 00794000
*                  ELSE;               /* NO I/O ERROR ENCOUNTERED.   * 00795000
*                                                                  0296 00796000
*                  /* WERE NO MORE RECORDS FOUND -                    * 00797000
*                                                                  0297 00798000
*                  IF RETCODE=4 THEN        /* END OF DATA,        0297 00799000
*                                              TRANSLATION COMPLETE.  * 00800000
         CH    RETCODE,@CH00452                                    0297 00801000
         BNE   @RF00297                                            0297 00802000
*                    DO;               /* DECIDE FINAL ACTION.        * 00803000
*                      INPUTCD='0'B;   /* SET BIT IN OPTION WORD TO IND 00804000
*                                         NEXT CALL NOT FOR INPUT  0299 00805000
*                                         TRANSLATION.                * 00806000
*                                                                  0299 00807000
         NI    INPUTCD(COMMREG),B'01111111'                        0299 00808000
*SWITCHON:             /* CONTROL COMES HERE WHENEVER 'SCAN ON'       * 00809000
*                      /* PROCESSING IS COMPLETE, TO CONDITIONALLY    * 00810000
*                      /* SET THE SCAN AND PROMPT SWITCHES IN EDIT'S  * 00811000
*                      /* COMMUNICATION AREA.                         * 00812000
*                                                                  0300 00813000
*                      /* WAS THE 'SCAN' KEYWORD SPEC ON THE EDIT     * 00814000
*                      /* COMMAND, OR WAS SCAN 'ON' BEFORE SYNTAX     * 00815000
*                      /* CHECKER RECOVERY -                          * 00816000
*                                                                  0300 00817000
*                      IF CASCANON='1'B THEN  /* SCAN IS TO BE 'ON'.  * 00818000
SWITCHON TM    CASCANON(COMMREG),B'00100000'                       0300 00819000
         BO    @RT00300                                            0300 00820000
*                        GOTO SETON;   /* TURN ON SCANNING.           * 00821000
*                      ELSE            /* SCAN IS TO BE 'OFF'.        * 00822000
*                        GOTO RECOVMSG;/* ISSUE RECOVERY MESSAGE IF     00823000
*                                         THIS WAS RECOVERY.          * 00824000
         B     RECOVMSG                                            0302 00825000
*                    END;              /* FINAL ACTION DECIDED.       * 00826000
*                  ELSE                /* ANOTHER RECORD TO BE     0304 00827000
*                                         TRANSLATED.                 * 00828000
*                    GOTO CALLCHKR;    /* LOOP BACK TO SEND A LINE.   * 00829000
*                END;                  /* END OF ITF 'SCAN ON'     0305 00830000
*                                         PROCESSING.                 * 00831000
*                                                                  0305 00832000
*SETON:        /* CONTROL COMES HERE WHENEVER SCANNING OF INPUT LINES * 00833000
*              /* IS TO BE PUT INTO EFFECT.                           * 00834000
*                                                                  0306 00835000
*              CASCANSW='1'B;          /* SET SW IN COMMUNICATION AREA  00836000
*                                         TO IND THAT SCANNING OF  0306 00837000
*                                         INPUT IS IN EFFECT.         * 00838000
SETON    DS    0H                                                  0307 00839000
*              CAPROMPT='1'B;          /* TURN ON PROMPT SW FOR INPUT.* 00840000
         OI    CASCANSW(COMMREG),B'00110000'                       0307 00841000
*              CASCANON='1'B;          /* SET SW TO REMEMBER SCANNING   00842000
*                                         IN EFFECT, IN CASE OF SYNTAX  00843000
*                                         CHECKER FAILURE, RECOVERY.  * 00844000
         OI    CASCANON(COMMREG),B'00100000'                       0308 00845000
*              SCANOPT='0'B;           /* SET OPTION WORD BIT TO IND    00846000
*                                         SCAN 'ON'.                  * 00847000
         NI    SCANOPT(COMMREG),B'11111110'                        0309 00848000
*              GOTO RECOVMSG;          /* ISSUE MESSAGE IF THIS IS 0310 00849000
*                                         SUCCESSFUL RECOVERY.        * 00850000
         B     RECOVMSG                                            0310 00851000
*            END;                      /* END OF 'SCAN ON' PROCESSING.* 00852000
*          ELSE;                       /* 'SCAN ON' NOT SPECIFIED.    * 00853000
*                                                                  0312 00854000
@RF00179 DS    0H                                                  0313 00855000
*          /* WAS THE 'OFF' KEYWORD SPECIFIED -                       * 00856000
*                                                                  0313 00857000
*          IF KEYWD=2 THEN             /* 'SCAN OFF SPECIFIED.        * 00858000
         L     @12,CAPTPRSD(,COMMREG)                              0313 00859000
         CLC   KEYWD(2,@12),@CH00088                               0313 00860000
         BNE   @RF00313                                            0313 00861000
*          /*********************************************************** 00862000
*          /* 'SCAN OFF' PROCESSING.                                  * 00863000
*          /*********************************************************** 00864000
*                                                                  0314 00865000
*OFFSPEC:    /* A SPECIAL CALL FOR END PORCESSING FOR SYNTAX CHECKER  * 00866000
*            /* CLEANUP AND DELETION RESULTS IN 'SCAN OFF' PROCESSING.* 00867000
*                                                                  0314 00868000
*            DO;                       /* BEGIN 'SCAN OFF' PROCESSING.* 00869000
*                                                                  0314 00870000
OFFSPEC  DS    0H                                                  0315 00871000
*              /* IS THIS AN ITF DATA SET, REQUIRING THE PROCESSOR'S  * 00872000
*              /* PRESENCE FOR MAINTENANCE OF A RUN-TIME DATA SET -   * 00873000
*                                                                  0315 00874000
*              IF CADSCODE=CABASIC                                 0315 00875000
*                |CADSCODE=CAIPLI THEN /* ITF DATA SET TYPE.          * 00876000
*                                                                  0315 00877000
         CLI   CADSCODE(COMMREG),X'20'                             0315 00878000
         BE    @RT00315                                            0315 00879000
         CLI   CADSCODE(COMMREG),X'21'                             0315 00880000
         BNE   @RF00315                                            0315 00881000
@RT00315 DS    0H                                                  0316 00882000
*                /* IS THIS A SPECIAL CALL FOR END PROCESSING -       * 00883000
*                                                                  0316 00884000
*                IF CAENDSC='0'B THEN   /* NOT END PROCESSING.        * 00885000
         TM    CAENDSC(COMMREG),B'00000100'                        0316 00886000
         BZ    @RT00316                                            0316 00887000
*                  GOTO SETOFF;        /* ONLY TURN OFF SWITCHES, FOR   00888000
*                                         PROCESSOR IS NEEDED TO KEEP   00889000
*                                         RUN-TIME DATA SET CURRENT.  * 00890000
*                ELSE                  /* END PROCESSING. FREE CORE     00891000
*                                         TAKEN BY PROCESSOR IF IT IS   00892000
*                                         LOADED.                     * 00893000
*                  GOTO PREFINAL;      /* TEST FOR CHECKER LOADED.    * 00894000
         B     PREFINAL                                            0318 00895000
*              ELSE                    /* NOT ITF DATA SET TYPE.      * 00896000
*                DO;                   /* BEGIN NON-ITS 'SCAN OFF' 0319 00897000
*                                         PROCESSING.                 * 00898000
*                                                                  0319 00899000
@RF00315 DS    0H                                                  0320 00900000
*                  /* IS SCANNING ALREADY 'OFF' -                     * 00901000
*                                                                  0320 00902000
*                  IF CASCANSW='0'B THEN   /* SCAN IS 'OFF'.          * 00903000
         TM    CASCANSW(COMMREG),B'00010000'                       0320 00904000
         BZ    @RT00320                                            0320 00905000
*                    GOTO SCANEXIT;    /* CLEAN UP AND RETURN.        * 00906000
*                  ELSE;               /* SCAN IS NOT YET 'OFF'.      * 00907000
*                                                                  0322 00908000
*PREFINAL:         /* FIND OUT IF CHECKER IS LOADED BEFORE TRYING TO  * 00909000
*                  /* DELETE IT.                                      * 00910000
*                                                                  0323 00911000
*                 IF CAPTCHK^=0 THEN   /* CHECKER IS LOADED.          * 00912000
*                                                                  0323 00913000
PREFINAL ICM   @12,15,CAPTCHK(COMMREG)                             0323 00914000
         BZ    @RF00323                                            0323 00915000
*FNLENTRY:           /* CONTROL COMES HERE DURING SYNTAX CHECKER      * 00916000
*                    /* RECOVERY FOR CLEAN UP AND DELETION OF CHECKER * 00917000
*                    /* PRIOR TO RELOADING.                           * 00918000
*                                                                  0324 00919000
*                    DO;               /* BEGIN FINAL CALL, DELETION. * 00920000
FNLENTRY DS    0H                                                  0325 00921000
*                      CASYNBFR=0;     /* NO LINES SENT FOR CHECKING. * 00922000
         SLR   @12,@12                                             0325 00923000
         ST    @12,CASYNBFR(,COMMREG)                              0325 00924000
*                      FIRSTENT='1'B;  /* SET BIT IN SYNTAX CKR COMM    00925000
*                                         AREA TO IND NOT A 1ST ENTRY.* 00926000
*                      LASTENT='1'B;   /* SET BIT TO IND FINAL ENTRY. * 00927000
         OI    FIRSTENT(COMMREG),B'10100000'                       0327 00928000
*                      PARMREG1=                                   0328 00929000
*                        ADDR(CASYNLST);/* SET PT TO ADDRESS LIST.    * 00930000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0328 00931000
*                      CALL CHECKER;   /* INVOKE SYNTAX CHECKER FOR     00932000
*                                         FINAL ENTRY.                * 00933000
         L     @15,CAPTCHK(,COMMREG)                               0329 00934000
         BALR  @14,@15                                             0329 00935000
*                      PARMREG0=                                   0330 00936000
*                        ADDR(CASYNAME);/* SET PT TO ENTRY NAME.      * 00937000
         LA    PARMREG0,CASYNAME(,COMMREG)                         0330 00938000
*                      GEN (DELETE EPLOC=(PARMREG0));/* DELETE CKR.   * 00939000
         DELETE EPLOC=(PARMREG0)                                        00940000
*                      CAPTCHK=0;      /* IND CHECKER NOT LOADED.     * 00941000
         SLR   @12,@12                                             0332 00942000
         ST    @12,CAPTCHK(,COMMREG)                               0332 00943000
*                    END;              /* FINAL CALL AND DELETION ARE   00944000
*                                         COMPLEAT.                   * 00945000
*                  ELSE;               /* CHECKER WAS NOT LOADED, SO    00946000
*                                         DELETION WAS SKIPPED.       * 00947000
*                                                                  0334 00948000
@RF00323 DS    0H                                                  0335 00949000
*                  /* IS RECOVERY IN PROGRESS -                       * 00950000
*                                                                  0335 00951000
*                  IF CASCRC20='1'B THEN  /* RECOVERY GOING ON.       * 00952000
         TM    CASCRC20(COMMREG),B'00001000'                       0335 00953000
         BO    @RT00335                                            0335 00954000
*                    GOTO RECOVER;     /* RELOAD AND REINITLZ CHECKER.* 00955000
*                  ELSE;               /* THIS IS NOT RECOVERY.       * 00956000
*                                                                  0337 00957000
*SETOFF:           /* CONTROL COMES HERE TO TURN OFF SCANNING.        * 00958000
*                                                                  0338 00959000
*                  CASCANSW='0'B;      /* SET SW IN EDIT COMMUNICATION  00960000
*                                         AREA TO IND SCANNING IN  0338 00961000
*                                         EFFECT.                     * 00962000
SETOFF   DS    0H                                                  0339 00963000
*                  CAPROMPT='0'B;      /* TURN OFF PROMPT SWITCH FOR    00964000
*                                         INPUT.                      * 00965000
         NI    CASCANSW(COMMREG),B'11001111'                       0339 00966000
*                  CASCANON='0'B;      /* SET SW TO REMEMBER SCAN OFF   00967000
*                                         IN CASE OF SYNTAX CHECKER     00968000
*                                         FAILURE AND RECOVERY.       * 00969000
         NI    CASCANON(COMMREG),B'11011111'                       0340 00970000
*                  SCANOPT='1'B;       /* SET OPTION WORD BIT TO IND    00971000
*                                         SCANNING NOT IN EFFECT.     * 00972000
         OI    SCANOPT(COMMREG),B'00000001'                        0341 00973000
*                  GOTO SCANEXIT;      /* CLEAN UP AND RETURN.        * 00974000
         B     SCANEXIT                                            0342 00975000
*                END;                  /* NON-ITF 'SCAN OFF'       0343 00976000
*                                         PROCESSING COMPLEAT.        * 00977000
*            END;                      /* END 'SCAN OFF' PROCESSING.  * 00978000
*          ELSE;                       /* NEITHER 'ON' NOR 'OFF' WAS    00979000
*                                         SPECIFIED.                  * 00980000
@RF00313 DS    0H                                                  0346 00981000
*          /*********************************************************** 00982000
*          /* PROCESSING FOR NO KEYWORD SPECIFIED.                    * 00983000
*          /*********************************************************** 00984000
*                                                                  0346 00985000
*          /* WAS A LINE NO. SPECIFIED BUT DATA SET NOT LINE-NUMBERED-* 00986000
*                                                                  0346 00987000
*          IF CANONUM='1'B                                         0346 00988000
*            &LNSTART->LINENUM(1)                                  0346 00989000
*            ^='*' THEN                /* INVALID REFERENCE BY     0346 00990000
*                                         LINE NUMBER.                * 00991000
         TM    CANONUM(COMMREG),B'00000001'                        0346 00992000
         BNO   @RF00346                                            0346 00993000
         L     @12,CAPTPRSD(,COMMREG)                              0346 00994000
         L     @12,LNSTART(,@12)                                   0346 00995000
         CLI   LINENUM(@12),C'*'                                   0346 00996000
         BE    @RF00346                                            0346 00997000
*            DO;                       /* BEGIN MESSAGE SET-UP.       * 00998000
*              RELMSG1 =1288;          /* SET 1ST-LEVEL MSG NO.       * 00999000
         MVC   RELMSG1(2),@CH01235                                 0348 01000000
*              RELMSG2 =0;             /* NO 2ND LEVEL MSG.           * 01001000
         SLR   @12,@12                                             0349 01002000
         STH   @12,RELMSG2                                         0349 01003000
*              LEV1INS =0;             /* NO INSERTIONS.              * 01004000
         LR    LEV1INS,@12                                         0350 01005000
*              LEV2INS =0;             /* DITTO.                      * 01006000
         LR    LEV2INS,@12                                         0351 01007000
*              RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SENDING ROUTINE.  * 01008000
         LA    RETCDREG,SENDMSG                                    0352 01009000
*              CALL SENDMSG;           /* INVOKE MSG-SENDING ROUTINE. * 01010000
         BAL   @14,SENDMSG                                         0353 01011000
*              GOTO FCNINCMP;          /* INDICATE FUNCTION INCOMPLETE  01012000
*                                         AND RETURN TO CALLER.       * 01013000
         B     FCNINCMP                                            0354 01014000
*            END;                      /* END OF MESSAGE SET-UP.      * 01015000
*          ELSE;                       /* NO INVALID REFERENCE BY LINE  01016000
*                                         NUMBER.                     * 01017000
*                                                                  0356 01018000
@RF00346 DS    0H                                                  0357 01019000
*TOTLSCAN:;/* CONTROL COMES HERE WHEN NO OPERANDS ARE SPECIFIED (I.E.,* 01020000
TOTLSCAN DS    0H                                                  0358 01021000
*          /* THE WHOLE DATA SET IS TO BE SCANNED.                    * 01022000
*                                                                  0358 01023000
*          CALL WHOLSCAN;                                          0358 01024000
         BAL   @14,WHOLSCAN                                        0358 01025000
*          GOTO SCANEXIT;             /*  RETURN TO CALLER            * 01026000
*                                                                  0359 01027000
         B     SCANEXIT                                            0359 01028000
*RECOVMSG: /* CONTROL COMES HERE AFTER 'SCAN ON' PROCESSING TO ISSUE  * 01029000
*          /* THE RECOVERY MESSAGE IS NECESSARY.                      * 01030000
*                                                                  0360 01031000
*          /* IS RECOVERY IN PROGRESS -                               * 01032000
*                                                                  0360 01033000
*          IF CASCRC20='1'B THEN       /* RECOVERY.                   * 01034000
RECOVMSG TM    CASCRC20(COMMREG),B'00001000'                       0360 01035000
         BNO   @RF00360                                            0360 01036000
*            DO;                       /* BEGIN RECOVERY NOTIFICATION.* 01037000
*              CASCRC20='0'B;          /* IND RECOVERY IS OVER.       * 01038000
         NI    CASCRC20(COMMREG),B'11110111'                       0362 01039000
*              IF CADSCODE=CAIPLI|CADSCODE=CABASIC THEN /*      A50466* 01040000
         CLI   CADSCODE(COMMREG),X'21'                             0363 01041000
         BE    @RT00363                                            0363 01042000
         CLI   CADSCODE(COMMREG),X'20'                             0363 01043000
         BNE   @RF00363                                            0363 01044000
@RT00363 DS    0H                                                  0364 01045000
*                DO;                   /* IF ITF SEND MSG       A50466* 01046000
*                                      /* IKJ52368I             A50466* 01047000
*                RELMSG1 =1801;        /* SET FIRST-LVL MSG NO. A50466* 01048000
         MVC   RELMSG1(2),@CH01238                                 0365 01049000
*                RELMSG2 =0;           /* NO SECOND-LEVEL MSG   A50466* 01050000
         SLR   @12,@12                                             0366 01051000
         STH   @12,RELMSG2                                         0366 01052000
*                LEV1INS =0;           /* NO INSERTIONS         A50466* 01053000
         LR    LEV1INS,@12                                         0367 01054000
*                LEV2INS =0;           /* NO INSERTIONS         A50466* 01055000
         LR    LEV2INS,@12                                         0368 01056000
*                RETCDREG=ADDR(SENDMSG); /* ADDRESS OF MSG RTN  A50466* 01057000
         LA    RETCDREG,SENDMSG                                    0369 01058000
*                CALL SENDMSG;         /* INVOKE MSG ROUTINE    A50466* 01059000
         BAL   @14,SENDMSG                                         0370 01060000
*                END;                  /* END IKJ52368 PROCESS  A50466* 01061000
*              ELSE DO;                /* IF NOT ITF, SEND MSG  A50466* 01062000
         B     @RC00363                                            0372 01063000
@RF00363 DS    0H                                                  0373 01064000
*                                      /* IKJ52367I             A50466* 01065000
*              MSGPTR=0;               /* ONLY 1 INSERT.              * 01066000
         SLR   @12,@12                                             0373 01067000
         ST    @12,MSGPTR(,COMMREG)                                0373 01068000
*              MSGOFF=10;              /* OFFSET TO INSERT.           * 01069000
         MVC   MSGOFF(2,COMMREG),@CH00387                          0374 01070000
*              MSGTEXT=CADSTYPE;       /* INSERTION TEXT.             * 01071000
         MVI   MSGTEXT+8(COMMREG),C' '                             0375 01072000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0375 01073000
         MVC   MSGTEXT(8,COMMREG),CADSTYPE(COMMREG)                0375 01074000
*              /* REMOVE TRAILING BLANKS FROM DATA SET TYPE NAME.     * 01075000
*              DO I=LENGTH(CADSTYPE)                               0376 01076000
*                TO 1 BY -1;           /* REMOVE TRAILING BLANKS.     * 01077000
*                                                                  0376 01078000
         LA    I,8                                                 0376 01079000
@DL00376 DS    0H                                                  0377 01080000
*                /* IS THIS CHARACTER A BLANK -                       * 01081000
*                                                                  0377 01082000
*                IF MSGTEXT(I)                                     0377 01083000
*                  ^=' ' THEN          /* LAST NON-BLANK FOUND.       * 01084000
         LR    @12,COMMREG                                         0377 01085000
         ALR   @12,I                                               0377 01086000
         CLI   MSGTEXT-1(@12),C' '                                 0377 01087000
         BNE   @RT00377                                            0377 01088000
*                  GOTO CALC;          /* COMPUTE LNG OF INSERTION.   * 01089000
*                ELSE;                 /* CHARACTER IS A BLANK. CON-    01090000
*                                         TINUE SEARCHING.            * 01091000
*              END;                    /* END OF TRAILING BLANK    0380 01092000
*                                         REMOVAL.                    * 01093000
*                                                                  0380 01094000
         BCTR  I,0                                                 0380 01095000
         LTR   I,I                                                 0380 01096000
         BP    @DL00376                                            0380 01097000
*CALC:         /* CONTROL COMES HERE AFTER LAST NON-BLANK IN MESSAGE  * 01098000
*              /* INSERTION IS FOUND.                                 * 01099000
*                                                                  0381 01100000
*              MSGLEN=I+LENGTH(MSGLEN)+LENGTH(MSGOFF);/* SET LENGTH.  * 01101000
CALC     LA    @12,4                                               0381 01102000
         ALR   @12,I                                               0381 01103000
         STH   @12,MSGLEN(,COMMREG)                                0381 01104000
*              RELMSG1 =1792;          /* SET 1ST-LEVEL MSG NO.       * 01105000
         MVC   RELMSG1(2),@CH01243                                 0382 01106000
*              RELMSG2 =1;             /* SET 2ND-LEVEL MSG NO.       * 01107000
         MVC   RELMSG2(2),@CH00039                                 0383 01108000
*              LEV1INS =0;             /* NO 1ST-LEVEL INSERTION.     * 01109000
         SLR   LEV1INS,LEV1INS                                     0384 01110000
*              LEV2INS =ADDR(MSGPTR);  /* SET PT TO 2ND-LEVEL INSERT. * 01111000
         LA    LEV2INS,MSGPTR(,COMMREG)                            0385 01112000
*              RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SENDING ROUTINE.  * 01113000
         LA    RETCDREG,SENDMSG                                    0386 01114000
*              CALL SENDMSG;           /* INVOKE MSG-SENDING ROUTINE. * 01115000
         BAL   @14,SENDMSG                                         0387 01116000
*              END;                    /* END IKJ52367I PROCESS A50466* 01117000
*            END;                      /* END RECOVERY NOTIFICATION.  * 01118000
*          ELSE;                       /* NOT RECOVERY.               * 01119000
*                                                                  0390 01120000
@RF00360 DS    0H                                                  0391 01121000
*SCANEXIT: /* CONTROL COMES HERE BEFORE RETURNING TO CALLER WHENEVER  * 01122000
*          /* THERE MAY BE A PARSE PDL TO BE FREED.                   * 01123000
*                                                                  0391 01124000
*          IF CAFREEDL='1'B THEN       /* NO PDL TO BE FREED.         * 01125000
@RC00360 DS    0H                                                  0391 01126000
SCANEXIT TM    CAFREEDL(COMMREG),B'10000000'                       0391 01127000
         BO    @RT00391                                            0391 01128000
*            GOTO NOSCNEXT;            /* RETURN TO CALLER WITH R.C.  * 01129000
*          ELSE                        /* PDL MUST BE FREED.          * 01130000
*            PARMREG1=ADDR(CAPTPRSD);  /* SET ADDRESS OF ANSWER PLACE.* 01131000
         LA    PARMREG1,CAPTPRSD(,COMMREG)                         0393 01132000
*          GEN ( IKJRLSA (PARMREG1));  /* FREE PDL CORE.              * 01133000
*                                                                  0394 01134000
          IKJRLSA (PARMREG1)                                            01135000
*NOSCNEXT: /* CONTROL COMES HERE WHENEVER CONTROL IS TO BE RETURNED   * 01136000
*          /* TO THE CALLER BUT NO PDL NEEDS TO BE FREED.             * 01137000
*                                                                  0395 01138000
*          CAFREEDL='1'B;              /* IND NO PDL TO BE FREED.     * 01139000
NOSCNEXT OI    CAFREEDL(COMMREG),B'10000000'                       0395 01140000
*          RETCDREG=SCRETCD;           /* PUT RET CODE IN REGISTER.   * 01141000
*                                                                  0396 01142000
         L     RETCDREG,SCRETCD                                    0396 01143000
*           RESPECIFY (GPR12P,GPR13P) RSTD;                        0397 01144000
*           CANXTSVA = GPR13P;       /* UPDATE NEXT-SAVE-AREA PTR    */ 01145000
         ST    GPR13P,CANXTSVA(,COMMREG)                           0398 01146000
*           GPR12P = GPR13P;         /* SAVE PRESENT SAVE-AREA ADDR  */ 01147000
         LR    GPR12P,GPR13P                                       0399 01148000
*           GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD       */ 01149000
         L     @08,CASAVPTR+4(,GPR13P)                             0400 01150000
         LR    GPR13P,@08                                          0400 01151000
*                                    /* SAVE-AREA PTR                */ 01152000
*           RESPECIFY CASAVE BASED(GPR12P); /* CHANGE BASE FOR       */ 01153000
*                                    /* SAVE-AREA                    */ 01154000
*           CASAVE = CASAVE && CASAVE; /* ZERO OUT THIS SAVE-AREA    */ 01155000
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0402 01156000
*           RESPECIFY CASAVE BASED;                                0403 01157000
*           RETURN CODE(RETCDREG);   /* RETURN WITH RETURN CODE      */ 01158000
         L     @14,12(,@13)                                        0404 01159000
         LM    @00,@12,20(@13)                                     0404 01160000
         BR    @14                                                 0404 01161000
*           RESPECIFY (GPR12P,GPR13P) UNRSTD;                      0405 01162000
*                                         /*   RETURN TO CALLER.   0406 01163000
* */                                                               0406 01164000
*                                                                  0406 01165000
*FCNINCMP: /* CONTROL COMES HERE WHEN THIS MODULE'S FUNCTION HAS NOT  * 01166000
*          /* BEEN COMPLETED (DUE TO PARSE UNABLE                     * 01167000
*          /* TO PROMPT, OR OTHER MALFUNCTION.)                       * 01168000
*                                                                  0406 01169000
*          SCRETCD=8;                  /* IND FUNCTION INCOMPLETE.    * 01170000
FCNINCMP MVC   SCRETCD(4),@CF00044                                 0406 01171000
*          GOTO SCANEXIT;              /* FREE PDL IF NECESSARY AND     01172000
*                                         RETURN TO CALLER.           * 01173000
         B     SCANEXIT                                            0407 01174000
*          /*********************************************************** 01175000
*          /* PARAMETER CONTROL LIST(PCL) FOR PARSING OPERANDS.       * 01176000
*          /*********************************************************** 01177000
*                                                                  0408 01178000
*          GEN DATA DEFS(SCANPCE);                                 0408 01179000
*CHKNAME:  /*********************************************************** 01180000
*          /*                                                         * 01181000
*          /* THIS SUBROUTINE CHECKS THE STATUS OF THE APPROPRIATE    * 01182000
*          /* SYNTAX CHECKER OR PREPROCESSOR AS FOLLOWS:              * 01183000
*          /*                                                         * 01184000
*          /*      1.  CHECKER OPERATIONAL - SET RETURN CODE OF 0.    * 01185000
*          /*                                                         * 01186000
*          /*      2.  CHECKER NOT IN SYSTEM - NOTIFY USER AND SET    * 01187000
*          /*          RETURN CODE OF 4.                              * 01188000
*          /*                                                         * 01189000
*          /*      3.  CHECKER NOT OPERATIONAL - NOTIFY USER AND SET  * 01190000
*          /*          RETURN CODE OF 4.                              * 01191000
*          /*                                                         * 01192000
*          /*********************************************************** 01193000
*                                                                  0409 01194000
*          PROC OPTIONS(NOSAVEAREA,NOSAVE);                        0409 01195000
*                                                                  0409 01196000
@EL00001 DS    0H                                                  0409 01197000
@EF00001 DS    0H                                                  0409 01198000
@ER00001 LM    @14,@12,12(@13)                                     0409 01199000
         BR    @14                                                 0409 01200000
CHKNAME  DS    0H                                                  0410 01201000
*       RESPECIFY (COMMREG,            /* COMMUNICATION AREA ADDRESS. * 01202000
*                  BASEREG,            /* PROGRAM BASE REGISTER.      * 01203000
*                  BASEREG2,           /* 2ND PROGRAM BASE REGISTER.  * 01204000
*                  DATAREG) RSTD;      /* WORK AREA BASE REGISTER.    * 01205000
*          CHKPTR = RETREG;            /* SAVE RETURN POINT           * 01206000
         ST    RETREG,CHKPTR                                       0411 01207000
*          RETCODE=0;                  /* INITLZ NORMAL RETURN CODE.  * 01208000
*                                                                  0412 01209000
         SLR   RETCODE,RETCODE                                     0412 01210000
*          /* IS SYNTAX CHECKER IN SYSTEM AND OPERATIVE -             * 01211000
*                                                                  0413 01212000
*          IF CASYNAME='0000000000000000'X                         0413 01213000
*            |CASYNAME='FFFFFFFFFFFFFFFF'X THEN/*                  0413 01214000
*                                         NOT IN SYSTEM AND OPERATIVE.* 01215000
         CLC   CASYNAME(8,COMMREG),@CB01255                        0413 01216000
         BE    @RT00413                                            0413 01217000
         CLC   CASYNAME(8,COMMREG),@CB01218                        0413 01218000
         BNE   @RF00413                                            0413 01219000
@RT00413 DS    0H                                                  0414 01220000
*            DO;                       /* BEGIN DIAGNOSIS.            * 01221000
*              RELMSG1 =1797;          /* RELATIVE MESSAGE NUMBER.    * 01222000
         MVC   RELMSG1(2),@CH01257                                 0415 01223000
*              LEV2INS =0;             /* NO 2ND-LEVEL INSERTION.     * 01224000
         SLR   @12,@12                                             0416 01225000
         LR    LEV2INS,@12                                         0416 01226000
*              MSGPTR=0;               /* NO THIRD INSERTION.         * 01227000
         ST    @12,MSGPTR(,COMMREG)                                0417 01228000
*              MSGOFF=29;              /* OFFSET TO INSERTION.        * 01229000
         MVC   MSGOFF(2,COMMREG),@CH01258                          0418 01230000
*              MSGTEXT=CADSTYPE;       /* INSERTION TEXT FOR MESSAGE. * 01231000
         MVI   MSGTEXT+8(COMMREG),C' '                             0419 01232000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0419 01233000
         MVC   MSGTEXT(8,COMMREG),CADSTYPE(COMMREG)                0419 01234000
*              /* REMOVE TRAILING BLANKS FROM DATA SET TYPE NAME.     * 01235000
*              DO I=LENGTH(CADSTYPE)                               0420 01236000
*                TO 1 BY -1;           /* REMOVE TRAILING BLANKS.     * 01237000
*                                                                  0420 01238000
         LA    I,8                                                 0420 01239000
@DL00420 DS    0H                                                  0421 01240000
*                /* CHECK IF LAST NON-BLANK CHARACTER FOUND.          * 01241000
*                                                                  0421 01242000
*                IF MSGTEXT(I)^=' ' THEN   /* FOUND.                  * 01243000
         LR    @12,COMMREG                                         0421 01244000
         ALR   @12,I                                               0421 01245000
         CLI   MSGTEXT-1(@12),C' '                                 0421 01246000
         BNE   @RT00421                                            0421 01247000
*                  GOTO OUT;           /* CALC LNG OF INSERT FOR MSG. * 01248000
*                ELSE;                 /* NOT FOUND.                  * 01249000
*              END;                    /* END BLANK-REMOVAL LOOP.     * 01250000
*                                                                  0424 01251000
         BCTR  I,0                                                 0424 01252000
         LTR   I,I                                                 0424 01253000
         BP    @DL00420                                            0424 01254000
*OUT:          /* CONTROL COMES HERE WHEN LAST NON-BLANK CHARACTER IN * 01255000
*              /* DATA SET TYPE MESSAGE INSERTION IS FOUND.           * 01256000
*                                                                  0425 01257000
*              MSGLEN=I+4;             /* LNG OF MESSAGE INSERTION.   * 01258000
OUT      LA    @12,4                                               0425 01259000
         ALR   @12,I                                               0425 01260000
         STH   @12,MSGLEN(,COMMREG)                                0425 01261000
*              MSGPTR2=ADDR(MSGAREA);  /* CHAIN INSERTIONS.           * 01262000
         LA    @12,MSGAREA(,COMMREG)                               0426 01263000
         ST    @12,MSGPTR2                                         0426 01264000
*              MSGLEN2=LENGTH('SCAN')+4;         /* LNG OF 1ST INSERT.* 01265000
         LA    MSGLEN2,8                                           0427 01266000
*              MSGOFF2=10;             /* OFFSET TO INSERTION.        * 01267000
         LA    MSGOFF2,10                                          0428 01268000
*              MSGTEXT2='SCAN';        /* TEXT OF MSG INSERTION.      * 01269000
         MVC   MSGTEXT2(4),@CC01193                                0429 01270000
*              LEV1INS =ADDR(MSGPTR2); /* PT TO INSERTION CHAIN.      * 01271000
*                                                                  0430 01272000
         LA    LEV1INS,MSGPTR2                                     0430 01273000
*              /* CHECK IF SYNTAX CHECKER NOT IN SYSTEM.              * 01274000
*                                                                  0431 01275000
*              IF CASYNAME='0000000000000000'X THEN/*              0431 01276000
*                                           YES.                      * 01277000
         CLC   CASYNAME(8,COMMREG),@CB01255                        0431 01278000
         BNE   @RF00431                                            0431 01279000
*                RELMSG2 =1;           /* SELECT 2ND-LEVEL MESSAGE.   * 01280000
         MVC   RELMSG2(2),@CH00039                                 0432 01281000
*              ELSE                    /* NO.                         * 01282000
*                RELMSG2 =2;           /* CHECKER NOT OPERATIONAL.    * 01283000
*                                                                  0433 01284000
         B     @RC00431                                            0433 01285000
@RF00431 MVC   RELMSG2(2),@CH00088                                 0433 01286000
*              /* CHECK IF THIS IS FINAL ENTRY FOR EDIT.              * 01287000
*                                                                  0434 01288000
*              IF CAENDSC='0'B THEN    /* NO, NOT FINAL ENTRY.        * 01289000
@RC00431 TM    CAENDSC(COMMREG),B'00000100'                        0434 01290000
         BNZ   @RF00434                                            0434 01291000
*                DO;                   /* ISSUE MESSAGE.              * 01292000
*                  RETCDREG=ADDR(SENDMSG);/* PT TO MSG-SENDING RTN.   * 01293000
         LA    RETCDREG,SENDMSG                                    0436 01294000
*                  CALL SENDMSG;       /* GO TO SEND MSG TO USER.     * 01295000
         BAL   @14,SENDMSG                                         0437 01296000
*                  CAPTCHK=0;          /* INITLZ PT TO CHECKER TO 0.  * 01297000
*                                                                  0438 01298000
         SLR   @12,@12                                             0438 01299000
         ST    @12,CAPTCHK(,COMMREG)                               0438 01300000
*                  /* CHECK IF INPUT SOURCE IS AN IN-CORE PROCEDURE.  * 01301000
*                                                                  0439 01302000
*                  IF CAINPROC='1'B THEN  /* IN A PROCEDURE.          * 01303000
         TM    CAINPROC(COMMREG),B'00000100'                       0439 01304000
         BNO   @RF00439                                            0439 01305000
*                    SCRETCD=12;       /* SET RET CODE FOR CONTROLLER   01306000
*                                         WHICH WILL FORCE CLEARING OF  01307000
*                                         INPUT QUEUE.                * 01308000
         MVC   SCRETCD(4),@CF00151                                 0440 01309000
*                  ELSE                /* NOT IN A PROCEDURE, OR, IT IS 01310000
*                                         NOT YET KNOWN WHETHER IN A    01311000
*                                         PROCEDURE.                  * 01312000
*                    /* CLEAR INPUT QUEUE.  CONTROLLER CANNOT CLEAR   * 01313000
*                    /* QUEUE BECAUSE THIS MODULE IS GOING TO SEND A  * 01314000
*                    /* RET CODE ZERO TO CONTROLLER.                  * 01315000
*                    GEN (TCLEARQ INPUT);                          0441 01316000
         B     @RC00439                                            0441 01317000
@RF00439 DS    0H                                                  0441 01318000
         TCLEARQ INPUT                                                  01319000
*                END;                  /* MESSAGE ISSUED.             * 01320000
*              ELSE;                   /* YES, FINAL ENTRY.           * 01321000
@RF00434 DS    0H                                                  0444 01322000
*              RETCODE=4;              /* SET UNNATURAL RETURN CODE.  * 01323000
@RC00434 LA    RETCODE,4                                           0444 01324000
*            END;                      /* END OF DIAGNOSIS.           * 01325000
*          ELSE;                       /* IN SYSTEM AND OPERATIVE.    * 01326000
@RF00413 DS    0H                                                  0447 01327000
*          RETCDREG=RETCODE;           /* MOVE RET CODE TO REGISTER.  * 01328000
         LR    RETCDREG,RETCODE                                    0447 01329000
*          RETREG = CHKPTR;            /* RESTORE RETURN POINT        * 01330000
         L     RETREG,CHKPTR                                       0448 01331000
*          RETURN;                     /* RETURN TO CALLING POINT     * 01332000
@EL00002 DS    0H                                                  0449 01333000
@EF00002 DS    0H                                                  0449 01334000
@ER00002 BR    @14                                                 0449 01335000
*          END CHKNAME;                /* STATUS-CHECKING COMPLETE.   * 01336000
*SENDMSG:  /*********************************************************** 01337000
*          /*                                                         * 01338000
*          /* THIS SUBROUTINE USES THE EDIT MACRO IKJEBEML TO SEND    * 01339000
*          /* MESSAGES TO THE USER.  ALL POINTERS AND VALUES ARE      * 01340000
*          /* PASSED TO THIS SUBROUTINE IN REGISTERS 3, 4, 5, AND 6.  * 01341000
*          /* THE FORM OF THE MACRO IS AS FOLLOWS:                    * 01342000
*          /*       IKJEBEML LEV1MSG#,LEV2MSG#,LEV1INSERT,LEV2INSERT, * 01343000
*          /*                MF=(E,PARMLISTAREA)                      * 01344000
*          /*                                                         * 01345000
*          /*********************************************************** 01346000
*                                                                  0451 01347000
*          PROC OPTIONS(NOSAVEAREA,NOSAVE);                        0451 01348000
*                                                                  0451 01349000
SENDMSG  DS    0H                                                  0452 01350000
*          RESPECIFY (LEV1INS,LEV2INS) RSTD;                       0452 01351000
*          SENDPTR = RETREG;           /* SAVE RETURN POINT ADDRESS   * 01352000
         LR    SENDPTR,RETREG                                      0453 01353000
*          GEN REFS(LEV1INS,LEV2INS);  /* CALL MESSAGE-SELECT ROUTINE.* 01354000
CALLBEMS IKJEBEML ,,(LEV1INS),(LEV2INS),MF=(E,SRPLIST)                  01355000
*          RESPECIFY (LEV1INS,LEV2INS) UNRSTD;                     0455 01356000
*          RETREG = SENDPTR;           /* RESTORE RETURN POINT ADDRESS* 01357000
         LR    RETREG,SENDPTR                                      0456 01358000
*          RETURN;                     /* RETURN TO CALLER            * 01359000
@EL00003 DS    0H                                                  0457 01360000
@EF00003 DS    0H                                                  0457 01361000
@ER00003 BR    @14                                                 0457 01362000
*          END SENDMSG;                /* MESSAGE HAS BEEN SENT       * 01363000
*                                                                  0458 01364000
*/********************************************************************* 01365000
*/* THIS SUBROUTINE INTERFACES WITH THE APPROPRIATE SYNTAX CHECKER,   * 01366000
*/* WHICH SCANS THE LINES PASSED FOR SYNTAX ERRORS AND, IF ONE IS     * 01367000
*/* FOUND, RETURNS A POINTER TO THE PROPER ERROR MESSAGE, WHICH       * 01368000
*/* THIS SUBROUTINE IN TURN SENDS TO THE USER VIA IKJEBEMS (MESSAGE   * 01369000
*/* SELECTION SERVICE ROUTINE) USING RELATIVE MESSAGE NUMBER ZERO.    * 01370000
*/* THIS SUBROUTINE LOADS AND INITIALIZES THE APPROPRIATE SYNTAX      * 01371000
*/* CHECKER, IF NECESSARY, AND PERFORMS A CONDITIONAL VARIABLE        * 01372000
*/* LENGTH GETMAIN FOR BUFFERS TO BE PASSED TO THE CHECKER.  THIS     * 01373000
*/* BUFFER IS REFILLED (OR ANOTHER BUFFER IS CHAINED TO IT) AFTER     * 01374000
*/* EACH CALL TO THE CHECKER UNTIL THE LINE RANGE IS EXHAUSTED.       * 01375000
*/* AFTER COMPLETION OF THE SCANNING OPERATION, THE CHECKER IS        * 01376000
*/* DELETED IF NECESSARY AND ANY BUFFER(S) FOTTEN IS/ARE FREED.       * 01377000
*/* IF THERE IS A PARAMETER DESCRIPTOR LIST IT IS RELEASED AND        * 01378000
*/* CONTROL IS RETURNED TO THE CALLER VIA IKJEBESC.                   * 01379000
*/********************************************************************* 01380000
*WHOLSCAN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                        0459 01381000
WHOLSCAN DS    0H                                                  0460 01382000
*          /*********************************************************** 01383000
*          /* RESTRICT COMPILER'S USE OF REGISTERS.                   * 01384000
*          /*********************************************************** 01385000
*                                                                  0460 01386000
*          RESPECIFY (PARMREG1,        /* PT TO PARAMETER LIST.       * 01387000
*                    BINRYREG,         /* BINARY VALUE.               * 01388000
*                    COMMREG,          /* PT TO COMMUNICATION AREA.   * 01389000
*                    BASEREG,          /* PROGRAM BASE REGISTER.      * 01390000
*                    BASEREG2,         /* PROGRAM 2ND BASE REGISTER   * 01391000
*                    DATAREG) RSTD;    /* WORK AREA BASE REGISTER.    * 01392000
*                                                                  0460 01393000
*          WHOLPTR = RETREG;           /* SAVE RETURN POINT           * 01394000
         ST    RETREG,WHOLPTR                                      0461 01395000
*          RC12SW = '0'B;              /* INIT BUFFER CONTROL SWITCH  * 01396000
         NI    RC12SW,B'01111111'                                  0462 01397000
*          /*********************************************************** 01398000
*          /* CHECK IF SYNTAX CHECKER ALREADY LOADED                  * 01399000
*          /*********************************************************** 01400000
*          IF CAPTCHK = 0 THEN         /* IF NO, LOAD AND INITLZ IT.  * 01401000
         ICM   @12,15,CAPTCHK(COMMREG)                             0463 01402000
         BNZ   @RF00463                                            0463 01403000
*            DO;                       /* BEGIN LOADING AND INITLZTN. * 01404000
*              RFY PARMREG0 RSTD;                                  0465 01405000
*              PARMREG0 = ADDR(CASYNAME);/*SET PT TO ENTRY NAME.      * 01406000
         LA    PARMREG0,CASYNAME(,COMMREG)                         0466 01407000
*              /* LOAD CHECKER.                                       * 01408000
*              GEN (LOAD EPLOC=(0));                               0467 01409000
         LOAD EPLOC=(0)                                                 01410000
*              CAPTCHK = PARMREG0;     /* SAVE ENTRY PT ADDRESS.      * 01411000
         ST    PARMREG0,CAPTCHK(,COMMREG)                          0468 01412000
*              CALL INITPLST;          /* INITLZ INTERFACE.           * 01413000
         BAL   @14,INITPLST                                        0469 01414000
*              PARMREG1 = ADDR(CASYNLST);/* SET PT TO PARM LIST.      * 01415000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0470 01416000
*              CALL CHECKER;           /* INITIAL CALL.               * 01417000
         L     @15,CAPTCHK(,COMMREG)                               0471 01418000
         BALR  @14,@15                                             0471 01419000
*              RETCODE = RETCDREG;     /* SAVE RETURN CODE.           * 01420000
         LR    RETCODE,RETCDREG                                    0472 01421000
*              CASYNMS1 = 0;           /* RESET MESSAGE               * 01422000
         SLR   @08,@08                                             0473 01423000
         ST    @08,CASYNMS1(,COMMREG)                              0473 01424000
*              CASYNMS2 = 0;           /*  POINTERS TO ZERO.          * 01425000
         ST    @08,CASYNMS2(,COMMREG)                              0474 01426000
*              RFY PARMREG0 UNRSTD;                                0475 01427000
*              /******************************************************* 01428000
*              /* CHECK FOR SUCCESSFUL INITIAL CALL.                  * 01429000
*              /******************************************************* 01430000
*              IF RETCODE ^= 0 THEN       /* UNSUCCESSFUL INIT CALL.  * 01431000
         CR    RETCODE,@08                                         0476 01432000
         BE    @RF00476                                            0476 01433000
*                DO;                   /* INDICATE RECOVERY NECESSARY.* 01434000
*                  SCRETCD = 16;       /* CHECKER BECAME INOPERATIVE. * 01435000
         MVC   SCRETCD(4),@CF00241                                 0478 01436000
*                  GO TO SCNEXIT;      /* RETURN FOR RECOVERY.        * 01437000
         B     SCNEXIT                                             0479 01438000
*                END;                  /* RECOVERY INDICATED.         * 01439000
*            END;                      /* INITIALIZATION COMPLETE.    * 01440000
@RF00476 DS    0H                                                  0482 01441000
*          /*********************************************************** 01442000
*          /* GETMAIN TWO K BYTES FOR SYNTAX CHECKER BUFFER           * 01443000
*          /*********************************************************** 01444000
*          GETMNLO = 260;              /* MINIMUM BUFFER REQUIRED.    * 01445000
@RF00463 MVC   GETMNLO(4),@CF00296                                 0482 01446000
*          GETMNHI = 2048;             /* MAXIMUM BUFFER DESIRED.     * 01447000
         MVC   GETMNHI(4),@CF01268                                 0483 01448000
*          GETLST01 = ADDR(GETMNLO);   /* SET PT TO SIZE REQUEST.     * 01449000
*                                                                  0484 01450000
*                                                                  0484 01451000
*                                                                  0484 01452000
         LA    @12,GETMNLO                                         0484 01453000
         ST    @12,GETLST01                                        0484 01454000
*          SUBPOOL = 1;                /* SET SUBPOOL NUMBER.         * 01455000
         MVI   SUBPOOL,X'01'                                       0485 01456000
*          /* ISSUE VARIABLE CONDITIONAL GETMAIN FOR BUFFERS          * 01457000
*          DO; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF(E 01458000
*GETLST) RTCD(RETCDREG)*/                                          0486 01459000
*          RESPECIFY (GPR01P,GPR15F) RESTRICTED;                   0487 01460000
*          GETLST04 = 'E0'X; /* TYPE */                            0488 01461000
         MVI   GETLST04,X'E0'                                      0488 01462000
*          GETLST03 = ADDR(GETBUFF); /* ADDR OF ADDR LIST */       0489 01463000
         LA    @14,GETBUFF                                         0489 01464000
         STCM  @14,7,GETLST03                                      0489 01465000
*          GETLST05 = SUBPOOL; /* SUBPOOL VALUE */                 0490 01466000
         MVC   GETLST05(1),SUBPOOL                                 0490 01467000
*          GPR01P = ADDR(GETLST); /* REG1 POINTS TO LIST */        0491 01468000
         LA    GPR01P,GETLST                                       0491 01469000
*          SVC(4);/* STANDARD-FORM OF GETMAIN*/                    0492 01470000
         SVC   4                                                   0492 01471000
*          RETCDREG = GPR15F; /* SET RETURN CODE */                0493 01472000
*          RESPECIFY (GPR01P,GPR15F) UNRESTRICTED;                 0494 01473000
*          END; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF( 01474000
*,GETLST) RTCD(RETCDREG)*/                                         0495 01475000
*          RETCODE = RETCDREG;         /* SAVE RETURN CODE.           * 01476000
         LR    RETCODE,RETCDREG                                    0496 01477000
*          /*********************************************************** 01478000
*          /* CHECK IF GETMAIN AREA OBTAINED                          * 01479000
*          /*********************************************************** 01480000
*          IF RETCODE ^= 0 THEN        /* BUFFER NOT OBTAINED.        * 01481000
         LTR   RETCODE,RETCODE                                     0497 01482000
         BZ    @RF00497                                            0497 01483000
*            DO;                       /* BEGIN USER NOTIFICATION.    * 01484000
*NOCORE:       /* CONTROL COMES HERE TO ISSUE 'NOT ENOUGH MAIN STORGE'* 01485000
*              MSGPTR = 0;             /* NO 2ND INSERTION.           * 01486000
NOCORE   SLR   @12,@12                                             0499 01487000
         ST    @12,MSGPTR(,COMMREG)                                0499 01488000
*              MSGLEN = CASCMDLN + 4;       /* INSERTION LENGTH.      * 01489000
         LA    @08,4                                               0500 01490000
         AH    @08,CASCMDLN(,COMMREG)                              0500 01491000
         STH   @08,MSGLEN(,COMMREG)                                0500 01492000
*              MSGOFF = 45;            /* INSERTION OFFSET.           * 01493000
         MVC   MSGOFF(2,COMMREG),@CH01206                          0501 01494000
*              MSGTEXT = CAPTSCMD->LINENUM;/* INSERTION TEXT.         * 01495000
         MVI   MSGTEXT+8(COMMREG),C' '                             0502 01496000
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0502 01497000
         L     @08,CAPTSCMD(,COMMREG)                              0502 01498000
         MVC   MSGTEXT(8,COMMREG),LINENUM(@08)                     0502 01499000
*              RELMSG1  = 270;         /* MSG NO.                     * 01500000
         MVC   RELMSG1(2),@CH01207                                 0503 01501000
*              RELMSG2  = 0;           /* NO 2ND LEVEL MSG.           * 01502000
         STH   @12,RELMSG2                                         0504 01503000
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERT.              * 01504000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0505 01505000
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERT.        * 01506000
         LR    LEV2INS,@12                                         0506 01507000
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     * 01508000
         LA    RETCDREG,SENDMSG                                    0507 01509000
*              CALL SENDMSG;           /* GOTO ISSUE MSG.             * 01510000
         BAL   @14,SENDMSG                                         0508 01511000
*              SCRETCD=8;              /* IND FUNCTION INCOMPLETE.    * 01512000
         MVC   SCRETCD(4),@CF00044                                 0509 01513000
*              GO TO DELTMOD;          /* GOTO DELETE CHECKER.        * 01514000
         B     DELTMOD                                             0510 01515000
*            END;                      /* USER NOTIFIED.              * 01516000
*          DCBPTR = CAPTCDCB;          /* INIT DCB PTR FOR IKJEBEUT   * 01517000
@RF00497 MVC   DCBPTR(3),CAPTCDCB+1(COMMREG)                       0512 01518000
*          AREAPTR = ADDR(UTBUFFER);   /* INIT BUFFER PTR FOR IKJEBEUT* 01519000
         LA    @12,UTBUFFER(,COMMREG)                              0513 01520000
         ST    @12,AREAPTR                                         0513 01521000
*          PLISTEND = '1'B;            /* MARK END OF PARAMETER LIST  * 01522000
         OI    PLISTEND,B'10000000'                                0514 01523000
*          RECRDKEY = CACURNUM;        /* SAVE CURRENT REFERENCE LINE * 01524000
         MVC   RECRDKEY(4),CACURNUM(COMMREG)                       0515 01525000
*          TOTALINE = 0;               /* INITLZ NO. OF LINES PASSED. * 01526000
         SLR   @12,@12                                             0516 01527000
         LR    TOTALINE,@12                                        0516 01528000
*          TOTALINX = 0;               /* INITLZ PREVIOUS NO. PASSED. * 01529000
         ST    @12,TOTALINX                                        0517 01530000
*          RECRDNO = 0;                /* NO LINES IN BUFFER YET.     * 01531000
         SLR   @07,@07                                             0518 01532000
         ICM   @07,7,BUFFPTR                                       0518 01533000
         MVI   RECRDNO(@07),X'00'                                  0518 01534000
*          FORWDPTR = 0;               /* NO BUFFERS CHAINED YET.     * 01535000
         STCM  @12,7,FORWDPTR(@07)                                 0519 01536000
*          CASYNBFR = BUFFPTR;         /**SET PT TO BUFFER CHAIN     ** 01537000
         ST    @07,CASYNBFR(,COMMREG)                              0520 01538000
*          SNSYNBFR = CASYNBFR;        /* SAVE CASYNBFR               * 01539000
         ST    @07,SNSYNBFR                                        0521 01540000
*          CURBFPTR = BUFFPTR;         /* SET CURRENT BUFFER POSITION   01541000
*                                         PTR TO BEGINNING OF BUFFER  * 01542000
         LR    CURBFPTR,@07                                        0522 01543000
*          ENDBFPTR = BUFFPTR + GETMNLEN; /* INIT END PTR OF BUFFER   * 01544000
         L     @05,GETMNLEN                                        0523 01545000
         ALR   @07,@05                                             0523 01546000
         STCM  @07,7,ENDBFPTR                                      0523 01547000
*          FREEAREA(1:4) = GETBUFF;    /* INIT FREEMAIN AREA PTR      * 01548000
         MVC   FREEAREA(4,COMMREG),GETBUFF                         0524 01549000
*          FREELEN(1:4) = GETMNLEN;    /* INIT FREEMAIN LENGTH        * 01550000
         ST    @05,FREELEN(,COMMREG)                               0525 01551000
*          FREEPTR = ADDR(FREEAREA);   /* INIT PTR TO CURRENT BUFFAREA* 01552000
         LA    @07,FREEAREA(,COMMREG)                              0526 01553000
         STCM  @07,7,FREEPTR                                       0526 01554000
*          FREELNPT = ADDR(FREELEN);   /* INIT PTR TO CURRENT LENGTH  * 01555000
         LA    @07,FREELEN(,COMMREG)                               0527 01556000
         STCM  @07,7,FREELNPT                                      0527 01557000
*          FREELNPT->HIORDBIT = '1'B;  /* SET END OF LIST MARKER      * 01558000
         OI    HIORDBIT(@07),B'10000000'                           0528 01559000
*          /*********************************************************** 01560000
*          /* CHECK IF SCAN OF WHOLE DATA SET SPECIFIED               * 01561000
*          /*********************************************************** 01562000
*          IF CAOPERND = '1'B THEN     /* LINE RANGE SPECIFIED.       * 01563000
         TM    CAOPERND(COMMREG),B'10000000'                       0529 01564000
         BO    @RT00529                                            0529 01565000
*            GO TO PARTLSCN;           /* GOTO SCAN LINE RANGE.       * 01566000
*          /* READ FIRST RECORD IN DATA SET                           * 01567000
*          KEYPTR = 0;                 /* NO KEY REQUIRED.            * 01568000
         SLR   @07,@07                                             0531 01569000
         ST    @07,KEYPTR                                          0531 01570000
*          UTCODE = '04'X;             /* SET CODE TO READ FIRST LINE * 01571000
         MVI   UTCODE,X'04'                                        0532 01572000
*          RETCDREG = ADDR(READRTN);   /* SET PT TO READ ROUTINE.     * 01573000
         LA    RETCDREG,READRTN                                    0533 01574000
*          CALL READRTN;               /* CALL IKJEBEUT TO READ LINE  * 01575000
         BAL   @14,READRTN                                         0534 01576000
*          /*********************************************************** 01577000
*          /* CHECK IF I/O ERROR OCCURRED IN EDIT DATA SET            * 01578000
*          /*********************************************************** 01579000
*          IF RETCODE = 8 THEN         /* I/O ERROR ON UTILITY.       * 01580000
         CH    RETCODE,@CH00044                                    0535 01581000
         BNE   @RF00535                                            0535 01582000
*            DO;                       /* NOTIFY CALLER.              * 01583000
*IOERR:        /* CONTROL COMES HERE TO SET I/O ERROR RET CODE.       * 01584000
*              SCRETCD = 12;           /* SET RET CODE.               * 01585000
IOERR    MVC   SCRETCD(4),@CF00151                                 0537 01586000
*              GO TO CLEANUP;          /* RETURN TO CALLER.           * 01587000
         B     CLEANUP                                             0538 01588000
*            END;                      /* CALLER NOTIFIED.            * 01589000
*          /*********************************************************** 01590000
*          /* CHECK IF RECORD EXISTS(WITH READ BEGIN IMPLIES EMPTY DS)* 01591000
*          /*********************************************************** 01592000
*          IF RETCODE = 4 THEN         /* NO LINES IN DATA SET.       * 01593000
@RF00535 CH    RETCODE,@CH00452                                    0540 01594000
         BNE   @RF00540                                            0540 01595000
*            DO;                       /* NOTIFY USER.                * 01596000
*EMPTY: ;      /* CONTROL COMES HERE TO ISSUE 'NO LINES IN DATA SET'. * 01597000
EMPTY    DS    0H                                                  0543 01598000
*              RELMSG1  = 1287;        /* MSG NO.                     * 01599000
         MVC   RELMSG1(2),@CH01281                                 0543 01600000
*              RELMSG2  = 0;           /* NO 2ND LEVEL.               * 01601000
         SLR   @12,@12                                             0544 01602000
         STH   @12,RELMSG2                                         0544 01603000
*              LEV2INS  = 0;           /* NO                          * 01604000
         LR    LEV2INS,@12                                         0545 01605000
*              LEV1INS  = 0;           /*  INSERTIONS.                * 01606000
         LR    LEV1INS,@12                                         0546 01607000
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     * 01608000
         LA    RETCDREG,SENDMSG                                    0547 01609000
*              CALL SENDMSG;           /* GO TO ISSUE MSG.            * 01610000
         BAL   @14,SENDMSG                                         0548 01611000
*              GO TO CLEANUP;          /* RETURN TO CALLER.           * 01612000
         B     CLEANUP                                             0549 01613000
*            END;                      /* USER NOTIFIED.              * 01614000
*          COUNT = '7FFFFFFF'X;        /* INIT COUNT TO MAXIMUM VALUE * 01615000
@RF00540 L     @12,@CF01282                                        0551 01616000
         ST    @12,COUNT                                           0551 01617000
*          LNUMBER2 = '7FFFFFFF'X;     /* INIT LINENUM RANGE TO MAX   * 01618000
         ST    @12,LNUMBER2                                        0552 01619000
*          GO TO MOVEREC;              /* BRANCH TO MOVE LINE INTO BFR* 01620000
         B     MOVEREC                                             0553 01621000
*PARTLSCN: /*********************************************************** 01622000
*          /* CHECK IF LINE NUMBER(S) SPECIFIED                       * 01623000
*          /*********************************************************** 01624000
*          IF LNSTART->LINENUM(1)^='*' THEN          /* NUMBER(S) SPEC* 01625000
PARTLSCN L     @12,CAPTPRSD(,COMMREG)                              0554 01626000
         L     @07,LNSTART(,@12)                                   0554 01627000
         CLI   LINENUM(@07),C'*'                                   0554 01628000
         BE    @RF00554                                            0554 01629000
*            DO;                       /* BEGIN CONVERSION AND READ.  * 01630000
*              PACKAREA = '00000000';  /* INITLZ AREA TO C'00000000'. * 01631000
         MVC   PACKAREA(8),@CC01285                                0556 01632000
*              /* PUT CHARACTER NO. IN PACK AREA.                     * 01633000
*              PACKAREA(9-LNSTARTL:8) = LNSTART->LINENUM;          0557 01634000
         LA    @05,9                                               0557 01635000
         SH    @05,LNSTARTL(,@12)                                  0557 01636000
         LA    @12,PACKAREA-1(@05)                                 0557 01637000
         LCR   @05,@05                                             0557 01638000
         AH    @05,@CH00044                                        0557 01639000
         EX    @05,@SM01393                                        0557 01640000
*              CALL CONVERT;           /* GO TO CONVERT TO BINARY.    * 01641000
         BAL   @14,CONVERT                                         0558 01642000
*              LNUMBER1 = BINRYREG;    /* SAVE LINENUM1.              * 01643000
         ST    BINRYREG,LNUMBER1                                   0559 01644000
*              COUNT = '7FFFFFFF'X;    /* SET COUNT GT 99999999.      * 01645000
         MVC   COUNT(4),@CF01282                                   0560 01646000
*              /******************************************************* 01647000
*              /* CHECK IF LINE NO. RANGE SPECIFIED.                  * 01648000
*              /******************************************************* 01649000
*              IF LNENDF = '0'B THEN   /* 2ND NO. NOT SPEC.           * 01650000
         L     @12,CAPTPRSD(,COMMREG)                              0561 01651000
         TM    LNENDF(@12),B'10000000'                             0561 01652000
         BNZ   @RF00561                                            0561 01653000
*                DO;                   /* SET RANGE TO 1ST LINE NO.   * 01654000
*                  LNUMBER2 = LNUMBER1;/* SINGLE LINE RANGE.          * 01655000
         L     @12,LNUMBER1                                        0563 01656000
         ST    @12,LNUMBER2                                        0563 01657000
*                  GO TO READKEY;      /* GOTO BEGIN READING RECORDS. * 01658000
         B     READKEY                                             0564 01659000
*                END;                  /* RANGE SET TO 1 LINE.        * 01660000
*              PACKAREA = '00000000';  /* INITLZ 2ND LINE NO. TO C'0'.* 01661000
@RF00561 MVC   PACKAREA(8),@CC01285                                0566 01662000
*              /* PUT CHARACTER NO. IN PACKAREA.                      * 01663000
*              PACKAREA(9-LNENDL:8) = LNEND->LINENUM;              0567 01664000
         L     @12,CAPTPRSD(,COMMREG)                              0567 01665000
         LA    @07,9                                               0567 01666000
         SH    @07,LNENDL(,@12)                                    0567 01667000
         LA    @05,PACKAREA-1(@07)                                 0567 01668000
         LCR   @07,@07                                             0567 01669000
         AH    @07,@CH00044                                        0567 01670000
         L     @12,LNEND(,@12)                                     0567 01671000
         EX    @07,@SM01395                                        0567 01672000
*              CALL CONVERT;           /* GOTO CONVERT TO BINARY.     * 01673000
         BAL   @14,CONVERT                                         0568 01674000
*              LNUMBER2 = BINRYREG;    /* SAVE LINENUM2.              * 01675000
         ST    BINRYREG,LNUMBER2                                   0569 01676000
*              /******************************************************* 01677000
*              /* CHECK IF LINE NO. RANGE IS VALID.                   * 01678000
*              /******************************************************* 01679000
*              IF LNUMBER2 < LNUMBER1 THEN /* INVALID RANGE.          * 01680000
         L     @12,LNUMBER2                                        0570 01681000
         C     @12,LNUMBER1                                        0570 01682000
         BNL   @RF00570                                            0570 01683000
*                DO;                   /* NOTIFY USER.                * 01684000
*                  RELMSG1  = 1289;    /* MSG NO.                     * 01685000
         MVC   RELMSG1(2),@CH01288                                 0572 01686000
*                  RELMSG2  = 0;       /* NO 2ND LEVEL.               * 01687000
         SLR   @12,@12                                             0573 01688000
         STH   @12,RELMSG2                                         0573 01689000
*                  LEV1INS  = 0;       /* NO                          * 01690000
         LR    LEV1INS,@12                                         0574 01691000
*                  LEV2INS  = 0;       /*  INSERTIONS.                * 01692000
         LR    LEV2INS,@12                                         0575 01693000
*                  RETCDREG =ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.  * 01694000
         LA    RETCDREG,SENDMSG                                    0576 01695000
*                  CALL SENDMSG;       /* ISSUE MSG.                  * 01696000
         BAL   @14,SENDMSG                                         0577 01697000
*                  GOTO FNINCMP;       /* INDICATE FUNCTION INCOMPLETE  01698000
*                                         AND RETURN TO CALLER.       * 01699000
         B     FNINCMP                                             0578 01700000
*                END;                  /* USER NOTIFIED.              * 01701000
*READKEY:      /******************************************************* 01702000
*              /* READ RECORD BY LINE NUMBER KEY.                     * 01703000
*              /******************************************************* 01704000
*              KEYPTR = ADDR(LNUMBER1);/* SET PT TO KEY.              * 01705000
@RF00570 DS    0H                                                  0580 01706000
READKEY  LA    @07,LNUMBER1                                        0580 01707000
         ST    @07,KEYPTR                                          0580 01708000
*              UTCODE = '00'X;         /* READ CURRENT OPTION.        * 01709000
         MVI   UTCODE,X'00'                                        0581 01710000
*              RETCDREG = ADDR(READRTN);/* SET PT TO READ ROUTINE.    * 01711000
         LA    RETCDREG,READRTN                                    0582 01712000
*              CALL READRTN;           /* GO TO READ RCD.             * 01713000
         BAL   @14,READRTN                                         0583 01714000
*              GO TO CHKRETCD;         /* GOTO CHECK RETURN CODE.     * 01715000
         B     CHKRETCD                                            0584 01716000
*            END;                      /* END OF CONVERSION AND READ. * 01717000
*          /*********************************************************** 01718000
*          /* CHECK IF COUNT SPECIFIED ON SCAN SUBCOMMAND             * 01719000
*          /*********************************************************** 01720000
*          IF LNENDF = '0'B THEN       /* NO COUNT SPECIFIED.         * 01721000
@RF00554 L     @12,CAPTPRSD(,COMMREG)                              0586 01722000
         TM    LNENDF(@12),B'10000000'                             0586 01723000
         BNZ   @RF00586                                            0586 01724000
*            COUNT = 1;                /* SET COUNT TO 1.             * 01725000
         MVC   COUNT(4),@CF00039                                   0587 01726000
*          ELSE                        /* COUNT SPECIFIED.            * 01727000
*            DO;                       /* BEGIN CONVERSION.           * 01728000
         B     @RC00586                                            0588 01729000
@RF00586 DS    0H                                                  0589 01730000
*              PACKAREA = '00000000';  /* SET PACK AREA TO C'0'.      * 01731000
         MVC   PACKAREA(8),@CC01285                                0589 01732000
*              /* PUT CHARACTER COINT VALUE IN PACKAREA.              * 01733000
*              PACKAREA(9-LNENDL:8) = LNEND->LINENUM;              0590 01734000
         L     @12,CAPTPRSD(,COMMREG)                              0590 01735000
         LA    @07,9                                               0590 01736000
         SH    @07,LNENDL(,@12)                                    0590 01737000
         LA    @05,PACKAREA-1(@07)                                 0590 01738000
         LCR   @07,@07                                             0590 01739000
         AH    @07,@CH00044                                        0590 01740000
         L     @12,LNEND(,@12)                                     0590 01741000
         EX    @07,@SM01395                                        0590 01742000
*              CALL CONVERT;           /* GOTO CONVERT TO BINARY.     * 01743000
         BAL   @14,CONVERT                                         0591 01744000
*              COUNT = BINRYREG;       /* SAVE COINT.                 * 01745000
         ST    BINRYREG,COUNT                                      0592 01746000
*            END;                      /* CONVERSION DONE.            * 01747000
*          LNUMBER2 = '7FFFFFFF'X;     /* SET LINENUM1                * 01748000
@RC00586 L     @12,@CF01282                                        0594 01749000
         ST    @12,LNUMBER2                                        0594 01750000
*          LNUMBER1 = LNUMBER2 - 1;    /*  AND LINENUM2               * 01751000
         LR    @07,@12                                             0595 01752000
         BCTR  @07,0                                               0595 01753000
         ST    @07,LNUMBER1                                        0595 01754000
*          LNUMBER2 = '7FFFFFFF'X;     /*   GREATER THAN 99999999.    * 01755000
         ST    @12,LNUMBER2                                        0596 01756000
*          /*********************************************************** 01757000
*          /* CHECK IF CURRENT REFERENCE LINE SET TO ZERO             * 01758000
*          /*********************************************************** 01759000
*          IF CACURNUM = 0 THEN        /*      *=0.                   * 01760000
         SLR   @12,@12                                             0597 01761000
         C     @12,CACURNUM(,COMMREG)                              0597 01762000
         BNE   @RF00597                                            0597 01763000
*            DO;                       /* BEGIN READ 1ST RCD.         * 01764000
*              KEYPTR = 0;             /* NO KEY NEEDED.              * 01765000
         SLR   @07,@07                                             0599 01766000
         ST    @07,KEYPTR                                          0599 01767000
*              UTCODE = '04'X;         /* READ 1ST OPTION.            * 01768000
         MVI   UTCODE,X'04'                                        0600 01769000
*              RETCDREG = ADDR(READRTN);/* SET PT TO READ ROUTINE.    * 01770000
         LA    RETCDREG,READRTN                                    0601 01771000
*              CALL READRTN;           /* GOTO READ 1ST RCD.          * 01772000
         BAL   @14,READRTN                                         0602 01773000
*              /******************************************************* 01774000
*              /* CHECK FOR I/O ERROR ON UTILITY.                     * 01775000
*              /******************************************************* 01776000
*              IF RETCODE = 8 THEN        /* I/O ERROR                * 01777000
         CH    RETCODE,@CH00044                                    0603 01778000
         BE    @RT00603                                            0603 01779000
*                GO TO IOERR;          /* GOTO ISSUE MSG.             * 01780000
*              /******************************************************* 01781000
*              /* CHECK IF RCD EXISTS(W/ READ 1ST IMPLIES EMPTY D.S.  * 01782000
*              /******************************************************* 01783000
*              IF RETCODE = 4 THEN        /* NO RCDS IN DATA SET.     * 01784000
         CH    RETCODE,@CH00452                                    0605 01785000
         BE    @RT00605                                            0605 01786000
*                GO TO EMPTY;          /* GOTO ISSUE 'NO LINES' MSG.  * 01787000
*              GO TO MOVEREC;          /* GOTO SET UP BUFFER.         * 01788000
         B     MOVEREC                                             0607 01789000
*            END;                      /* 1ST RCD READ.               * 01790000
*          /* READ CURRENT REFERENCE RECORD.                          * 01791000
*          KEYPTR = ADDR(CACURNUM);    /* INIT PTR TO KEY             * 01792000
@RF00597 LA    @07,CACURNUM(,COMMREG)                              0609 01793000
         ST    @07,KEYPTR                                          0609 01794000
*          UTCODE = '00'X;             /* SET CODE TO READ BY KEY     * 01795000
         MVI   UTCODE,X'00'                                        0610 01796000
*          RETCDREG = ADDR(READRTN);   /* SET ADDR OF ENTRY POINT.    * 01797000
         LA    RETCDREG,READRTN                                    0611 01798000
*          CALL READRTN;               /* READ CURR REFERENCE RCD.    * 01799000
         BAL   @14,READRTN                                         0612 01800000
*CHKRETCD: /*********************************************************** 01801000
*          /* CHECK FOR I/O ERROR IN EDIT DATA SET                    * 01802000
*          /*********************************************************** 01803000
*          IF RETCODE = 8 THEN         /* I/O ERROR.                  * 01804000
CHKRETCD CH    RETCODE,@CH00044                                    0613 01805000
         BE    @RT00613                                            0613 01806000
*            GO TO IOERR;              /* GOTO INFORM CALLER.         * 01807000
*          /*********************************************************** 01808000
*          /* CHECK IF RECORD EXISTS                                  * 01809000
*          /*********************************************************** 01810000
*          IF RETCODE = 4 THEN         /* RCD NOT FOUND.              * 01811000
         CH    RETCODE,@CH00452                                    0615 01812000
         BE    @RT00615                                            0615 01813000
*            GO TO MORESCN;            /* GOTO TEST IF MSG NECESSARY. * 01814000
*MOVEREC:  /* CONTROL COMES HERE TO MOVE A RCD INTO THE BUFFER.       * 01815000
*          RECRDKEY = KEY;             /* SAVE NEW CURRENT LINE VALUE.* 01816000
MOVEREC  MVC   RECRDKEY(4),KEY(COMMREG)                            0617 01817000
*          /*********************************************************** 01818000
*          /* CHECK IF FIXED LENGTH RECORD FORMAT                     * 01819000
*          /*********************************************************** 01820000
*          IF CARECFM = '1'B THEN      /* RECFM = F.                  * 01821000
         TM    CARECFM(COMMREG),B'01000000'                        0618 01822000
         BNO   @RF00618                                            0618 01823000
*            DO;                       /* MOVE FIXED LNG RCD (DATA    * 01824000
*              CURBFPTR->RECRD(1:LL-4) = LINE;               /* ONLY).* 01825000
         SLR   @12,@12                                             0620 01826000
         ICM   @12,3,LL(COMMREG)                                   0620 01827000
         LR    @07,@12                                             0620 01828000
         SH    @07,@CH00138                                        0620 01829000
         EX    @07,@SM01397                                        0620 01830000
*              LL = LL - 4;            /* UPDATE LL FIELD.            * 01831000
         SH    @12,@CH00452                                        0621 01832000
         STH   @12,LL(,COMMREG)                                    0621 01833000
*            END;                      /* FIXED LNG RCD MOVED.        * 01834000
*          ELSE                        /* RECFM = V. MOVE DATA AND    * 01835000
*            CURBFPTR->RECRD(1:LL) = LL;          /*   CONTROL WORD.  * 01836000
         B     @RC00618                                            0623 01837000
@RF00618 SLR   @12,@12                                             0623 01838000
         ICM   @12,3,LL(COMMREG)                                   0623 01839000
         BCTR  @12,0                                               0623 01840000
         EX    @12,@SM01399                                        0623 01841000
*          /* CONTROL COMES HERE TO CONTINUE FILLING BUFFER.          * 01842000
*          CURBFPTR = CURBFPTR + LL;    /* UPDATE PT TO NEXT AVAILABLE  01843000
*                                          SPACE IN BUFFER.           * 01844000
@RC00618 SLR   @12,@12                                             0624 01845000
         ICM   @12,3,LL(COMMREG)                                   0624 01846000
         ALR   CURBFPTR,@12                                        0624 01847000
*          RECRDNO = RECRDNO + 1;       /* UPDATE LINE COUNT BY 1.    * 01848000
         SLR   @12,@12                                             0625 01849000
         ICM   @12,7,BUFFPTR                                       0625 01850000
         LA    @07,1                                               0625 01851000
         SLR   @05,@05                                             0625 01852000
         IC    @05,RECRDNO(,@12)                                   0625 01853000
         ALR   @07,@05                                             0625 01854000
         STC   @07,RECRDNO(,@12)                                   0625 01855000
*          /*********************************************************** 01856000
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     * 01857000
*          /*********************************************************** 01858000
*          IF KEY = LNUMBER2 | COUNT = TOTALINE + RECRDNO THEN /*NO MOR 01859000
*                                                                LINES* 01860000
         CLC   KEY(4,COMMREG),LNUMBER2                             0626 01861000
         BE    @RT00626                                            0626 01862000
         ALR   @07,TOTALINE                                        0626 01863000
         C     @07,COUNT                                           0626 01864000
         BNE   @RF00626                                            0626 01865000
@RT00626 DS    0H                                                  0627 01866000
*            DO;                       /* BEGIN CHECKING.             * 01867000
*              ENDSW = '1'B;           /* IND NO MORE LINES TO CHECK. * 01868000
         OI    ENDSW,B'01000000'                                   0628 01869000
*              GO TO SYNCHK;           /* GOTO CALL CHECKER.          * 01870000
         B     SYNCHK                                              0629 01871000
*            END;                      /* LINE(S) CHECKED.            * 01872000
*          KEYPTR = 0;                 /* PREPARE TO READ NEXT LINE.  * 01873000
@RF00626 SLR   @07,@07                                             0631 01874000
         ST    @07,KEYPTR                                          0631 01875000
*          UTCODE = '02'X;             /* OPTION CODE.                * 01876000
         MVI   UTCODE,X'02'                                        0632 01877000
*          RETCDREG = ADDR(READRTN);   /* ADDRESS OF ENTRY POINT.     * 01878000
         LA    RETCDREG,READRTN                                    0633 01879000
*          CALL READRTN;               /* READ NEXT RECORD            * 01880000
         BAL   @14,READRTN                                         0634 01881000
*          /*********************************************************** 01882000
*          /* CHECK FOR I/O ERROR IN EDIT DATA SET                    * 01883000
*          /*********************************************************** 01884000
*          IF RETCODE = 8 THEN         /* I/O ERROR ON UTILITY.       * 01885000
         CH    RETCODE,@CH00044                                    0635 01886000
         BE    @RT00635                                            0635 01887000
*            GO TO IOERR;              /* GOTO NOTIFY CALLER.         * 01888000
*          /*********************************************************** 01889000
*          /* CHECK IF RECORD EXISTS(WITH READ NEXT IMPLIES EOD)      * 01890000
*          /*********************************************************** 01891000
*          IF RETCODE = 4 THEN         /* NO MORE RCDS ON DATA SET.   * 01892000
         CH    RETCODE,@CH00452                                    0637 01893000
         BNE   @RF00637                                            0637 01894000
*            DO;                       /* BEGIN CHECKING.             * 01895000
*ENDDATA:      /* CONTROL COMES HERE TO SET INTERNAL SWITCH.          * 01896000
*              ENDSW = '1'B;           /* IND NO MORE LINES TO CHECK. * 01897000
ENDDATA  OI    ENDSW,B'01000000'                                   0639 01898000
*              GO TO SYNCHK;           /* GOTO CALL CHECKER.          * 01899000
         B     SYNCHK                                              0640 01900000
*            END;                      /* LINE(S) CHECKED.            * 01901000
*          /*********************************************************** 01902000
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     * 01903000
*          /*********************************************************** 01904000
*SCNMORE:  /* CONTROL COMES HERE TO SEE IF THERE IS MORE TO BE SCANNED* 01905000
*          IF KEY > LNUMBER2 | COUNT = TOTALINE + RECRDNO THEN /*NO MOR 01906000
*                                                                LINES* 01907000
@RF00637 DS    0H                                                  0642 01908000
SCNMORE  L     @12,KEY(,COMMREG)                                   0642 01909000
         C     @12,LNUMBER2                                        0642 01910000
         BH    @RT00642                                            0642 01911000
         SLR   @12,@12                                             0642 01912000
         ICM   @12,7,BUFFPTR                                       0642 01913000
         LR    @07,TOTALINE                                        0642 01914000
         SLR   @05,@05                                             0642 01915000
         IC    @05,RECRDNO(,@12)                                   0642 01916000
         ALR   @07,@05                                             0642 01917000
         C     @07,COUNT                                           0642 01918000
         BE    @RT00642                                            0642 01919000
*            GO TO ENDDATA;            /* GO TO SET SWITCH.           * 01920000
*          /*********************************************************** 01921000
*          /* CHECK IF BUFFER AREA FILLED                             * 01922000
*          /*********************************************************** 01923000
*          IF ENDBFPTR > CURBFPTR + CALRECL + 4 THEN        /*NOT FULL* 01924000
         LR    @12,CURBFPTR                                        0644 01925000
         AH    @12,CALRECL(,COMMREG)                               0644 01926000
         AH    @12,@CH00452                                        0644 01927000
         SLR   @07,@07                                             0644 01928000
         ICM   @07,7,ENDBFPTR                                      0644 01929000
         CR    @12,@07                                             0644 01930000
         BL    @RT00644                                            0644 01931000
*            GO TO MOVEREC;            /* GO TO BRING IN NEXT RCD.    * 01932000
*          ELSE                        /* BUFFER FULL.                * 01933000
*            GO TO SYNCHK;             /* GOTO CALL CHECKER.          * 01934000
         B     SYNCHK                                              0646 01935000
*MORESCN:  /*********************************************************** 01936000
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     * 01937000
*          /*********************************************************** 01938000
*          IF LNUMBER1 = LNUMBER2 | COUNT = 1 THEN     /* NO  MORE    * 01939000
MORESCN  CLC   LNUMBER1(4),LNUMBER2                                0647 01940000
         BE    @RT00647                                            0647 01941000
         CLC   COUNT(4),@CF00039                                   0647 01942000
         BNE   @RF00647                                            0647 01943000
@RT00647 DS    0H                                                  0648 01944000
*            DO;                       /* TELL USER 'LINE NOT FOUND'. * 01945000
*NOLINE:       /* CONTROL COMES HERE TO ISSUE 'LINE NOT FOUND' MSG.   * 01946000
*              MSGPTR = 0;             /* ONLY 1 INSERT.              * 01947000
NOLINE   SLR   @12,@12                                             0649 01948000
         ST    @12,MSGPTR(,COMMREG)                                0649 01949000
*              MSGLEN = LNSTARTL + 4;       /* LNG OF INSERT.         * 01950000
         L     @08,CAPTPRSD(,COMMREG)                              0650 01951000
         LH    @07,LNSTARTL(,@08)                                  0650 01952000
         LA    @05,4                                               0650 01953000
         ALR   @05,@07                                             0650 01954000
         STH   @05,MSGLEN(,COMMREG)                                0650 01955000
*              MSGOFF = 22;            /* OFFSET TO INSERT.           * 01956000
         MVC   MSGOFF(2,COMMREG),@CH01204                          0651 01957000
*              MSGTEXT(1:LNSTARTL) = LNSTART->LINENUM;    /*MSG TEXT. * 01958000
         BCTR  @07,0                                               0652 01959000
         L     @08,LNSTART(,@08)                                   0652 01960000
         EX    @07,@SM01402                                        0652 01961000
*              RELMSG1  = 1290;        /* MSG NO.                     * 01962000
         MVC   RELMSG1(2),@CH01303                                 0653 01963000
*              RELMSG2  = 0;           /* NO 2ND LEVEL.               * 01964000
         STH   @12,RELMSG2                                         0654 01965000
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERT.              * 01966000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0655 01967000
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERT.        * 01968000
         LR    LEV2INS,@12                                         0656 01969000
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     * 01970000
         LA    RETCDREG,SENDMSG                                    0657 01971000
*              CALL SENDMSG;           /* GOTO ISSUE MESSAGE.         * 01972000
         BAL   @14,SENDMSG                                         0658 01973000
*              GOTO FNINCMP;           /* INDICATE FUNCTION INCOMPLETE  01974000
*                                         AND RETURN TO CALLER.       * 01975000
         B     FNINCMP                                             0659 01976000
*            END;                      /* USER TOLD.                  * 01977000
*          UTCODE = '02'X;             /* SET CODE TO READ NEXT LINE  * 01978000
@RF00647 MVI   UTCODE,X'02'                                        0661 01979000
*          RETCDREG = ADDR(READRTN);   /* ADDRESS OF ENTRY POINT.     * 01980000
         LA    RETCDREG,READRTN                                    0662 01981000
*          CALL READRTN;               /* READ NEXT RECORD            * 01982000
         BAL   @14,READRTN                                         0663 01983000
*          /*********************************************************** 01984000
*          /* CHECK FOR I/O ERROR IN EDIT DATA SET                    * 01985000
*          /*********************************************************** 01986000
*          IF RETCODE = 8 THEN         /* I/O ERROR ON UTILITY.       * 01987000
         CH    RETCODE,@CH00044                                    0664 01988000
         BE    @RT00664                                            0664 01989000
*            GO TO IOERR;              /* GOTO NOTIFY CALLER.         * 01990000
*          /*********************************************************** 01991000
*          /* CHECK IF RECORD EXISTS(HERE IMPLIES NO LINES IN RANGE)  * 01992000
*          /*********************************************************** 01993000
*          IF RETCODE = 4 THEN         /* NO LINES IN RANGE.          * 01994000
         CH    RETCODE,@CH00452                                    0666 01995000
         BE    @RT00666                                            0666 01996000
*            GOTO NOLINE;              /* GOTO ISSUE MESSAGE.         * 01997000
*          ELSE                        /* A RCD WAS FOUND.            * 01998000
*            GO TO SCNMORE;            /*GOTO SEE IF SCAN SHOULD CONT.* 01999000
         B     SCNMORE                                             0668 02000000
*          /* ******************************************************* * 02001000
*          /** SEE WHETHER THIS ENTRY FOLLOWS A RETURN CODE 12       ** 02002000
*          /* ******************************************************* * 02003000
*SYNCHK:   /* CONTROL COMES HERE TO PREPARE TO CALL CHECKER.          * 02004000
*          IF RC12SW = '1'B THEN       /* R.C. 12 WAS JUST RECEIVED.  * 02005000
SYNCHK   TM    RC12SW,B'10000000'                                  0669 02006000
         BNO   @RF00669                                            0669 02007000
*            ENTRYCD(1:4)='1001'B;           /*SET ENTRY CODE BIT 3.  * 02008000
         NI    ENTRYCD(COMMREG),B'10011111'                        0670 02009000
         OI    ENTRYCD(COMMREG),B'10010000'                        0670 02010000
*          ELSE                        /* NORMAL ENTRY.               * 02011000
*            ENTRYCD(1:4)='1000'B;           /*SET NORMAL ENTRY CODE. * 02012000
         B     @RC00669                                            0671 02013000
@RF00669 NI    ENTRYCD(COMMREG),B'10001111'                        0671 02014000
         OI    ENTRYCD(COMMREG),B'10000000'                        0671 02015000
*          INCOMP = '1'B;              /* SET BIT TO RETURN RC = 12   * 02016000
@RC00669 OI    INCOMP(COMMREG),B'00010000'                         0672 02017000
*          /*********************************************************** 02018000
*          /* CHECK IF DATA SET TYPE IS BASIC OR IPLI                 * 02019000
*          /*********************************************************** 02020000
*          IF CADSCODE = CABASIC | CADSCODE = CAIPLI THEN /* ITF.     * 02021000
         CLI   CADSCODE(COMMREG),X'20'                             0673 02022000
         BE    @RT00673                                            0673 02023000
         CLI   CADSCODE(COMMREG),X'21'                             0673 02024000
         BNE   @RF00673                                            0673 02025000
@RT00673 DS    0H                                                  0674 02026000
*            DO;                       /* SET ITF OPTIONS.            * 02027000
*              CODE2(1:5) = '00010'B;     /* IND THAT RCDS HAVE ALREADY 02028000
*                                            BEEN TRANSLATED.         * 02029000
         NI    CODE2(COMMREG),B'00010111'                          0675 02030000
         OI    CODE2(COMMREG),B'00010000'                          0675 02031000
*              SCANOPT = '0'B;         /* IND SCAN IN EFFECT.         * 02032000
         NI    SCANOPT(COMMREG),B'11111110'                        0676 02033000
*            END;                      /* OPTIONS SET.                * 02034000
*          /*********************************************************** 02035000
*          /* ARE WE CONTINUING AFTER A RETURN CODE 12 -              * 02036000
*          /*********************************************************** 02037000
*          IF RC12SW ^= '1'B THEN      /* NOT AFTER R.C. 12.          * 02038000
@RF00673 TM    RC12SW,B'10000000'                                  0678 02039000
         BO    @RF00678                                            0678 02040000
*            DO;                       /* FINISH BUFFER SETUP.        * 02041000
*              FORWDPTR = 0;           /* NO CHAINED BUFFERS.         * 02042000
         SLR   @12,@12                                             0680 02043000
         ICM   @12,7,BUFFPTR                                       0680 02044000
         SLR   @07,@07                                             0680 02045000
         STCM  @07,7,FORWDPTR(@12)                                 0680 02046000
*              BUFFBYTE = '00'X;       /* ZERO HI-ORDER BYTE.         * 02047000
         MVI   BUFFBYTE,X'00'                                      0681 02048000
*              CASYNBFR = GETBUFF;     /* INITLZ BFR PT IN PARM LIST. * 02049000
         L     @12,GETBUFF                                         0682 02050000
         ST    @12,CASYNBFR(,COMMREG)                              0682 02051000
*              SNSYNBFR = CASYNBFR;    /* SAVE CASYNBFR.              * 02052000
         ST    @12,SNSYNBFR                                        0683 02053000
*            END;                      /* BUFFER SETUP COMPLETED.     * 02054000
*CHKRCALL: /* CONTROL COMES HERE FOR THE ACTUAL CALL OF THE CHECKER.  * 02055000
*          PARMREG1 = ADDR(CASYNLST);  /* SET PT TO PARM LIST.        * 02056000
@RF00678 DS    0H                                                  0685 02057000
CHKRCALL LA    PARMREG1,CASYNLST(,COMMREG)                         0685 02058000
*          CALL CHECKER;               /* CALL SYNTX CHECKER          * 02059000
         L     @15,CAPTCHK(,COMMREG)                               0686 02060000
         BALR  @14,@15                                             0686 02061000
*          RETCODE = RETCDREG;         /* SAVE CHECKER RETURN CODE    * 02062000
         LR    RETCODE,RETCDREG                                    0687 02063000
*          /*********************************************************** 02064000
*          /* CHECK IF SYNTAX ERROR FOUND - BUFFER CHECKING INCOMPLETE* 02065000
*          /*********************************************************** 02066000
*          IF RETCODE = 8 THEN         /* ERROR.                      * 02067000
         CH    RETCODE,@CH00044                                    0688 02068000
         BNE   @RF00688                                            0688 02069000
*            DO;                       /* BEGIN MSG PROCESSING.       * 02070000
*              /* CHECK IF ERROR MSG SENT BY SYNTAX CHECKER -         * 02071000
*              IF CASYNMS1 = 0 THEN    /* MSG ALREADY SENT.           * 02072000
         SLR   @12,@12                                             0690 02073000
         C     @12,CASYNMS1(,COMMREG)                              0690 02074000
         BE    @RT00690                                            0690 02075000
*                GO TO SKIPMSG8;       /* SKIP FURTHER MSG PROCESSING.* 02076000
*              MSGPTR = 0;             /* ONLY 1 INSERTION.           * 02077000
         ST    @12,MSGPTR(,COMMREG)                                0692 02078000
*              MSGLEN = 76;            /* LNG OF INSERT.              * 02079000
         MVC   MSGLEN(2,COMMREG),@CH01311                          0693 02080000
*              MSGOFF = 0;             /* OFFSET TO INSERT.           * 02081000
         STH   @12,MSGOFF(,COMMREG)                                0694 02082000
*              MSGTEXT = SYNMSG1 -> ERRORMSG;/* TEXT OF MESSAGE.      * 02083000
         L     @12,SYNMSG1(,COMMREG)                               0695 02084000
         MVC   MSGTEXT(72,COMMREG),ERRORMSG(@12)                   0695 02085000
*              /* ARE RCDS 'NONUM' -                                  * 02086000
*              IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.            * 02087000
         TM    CANONUM(COMMREG),B'00000001'                        0696 02088000
         BNO   @RF00696                                            0696 02089000
*                DO;                   /* FIX LINE NO. IN MSG.        * 02090000
*                  PARMREG1 = ADDR(MSGTEXT);/* SET PT TO TEXT.        * 02091000
         LA    PARMREG1,MSGTEXT(,COMMREG)                          0698 02092000
*                  CALL FIXLINO;       /* GOTO FIXING ROUTINE.        * 02093000
         BAL   @14,FIXLINO                                         0699 02094000
*                END;                  /* FIXED.                      * 02095000
*              RELMSG1  = 1280;        /* MSG NO.                     * 02096000
@RF00696 MVC   RELMSG1(2),@CH01312                                 0701 02097000
*              RELMSG2  = 0;           /* NO 2ND LEVEL MSG.           * 02098000
         SLR   @12,@12                                             0702 02099000
         STH   @12,RELMSG2                                         0702 02100000
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERTION.           * 02101000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0703 02102000
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERTION.     * 02103000
         LR    LEV2INS,@12                                         0704 02104000
*              /* IS THERE A 2ND LEVEL MSG PRESENT -                  * 02105000
*              IF CASYNMS2 ^= 0 THEN   /* 2ND LEVEL MSG EXISTS.       * 02106000
         C     @12,CASYNMS2(,COMMREG)                              0705 02107000
         BE    @RF00705                                            0705 02108000
*                DO;                   /* BEGIN 2ND LEVEL SETUP.      * 02109000
*                  LEV2PTR = 0;        /* ONLY 1 INSERTION.           * 02110000
         ST    @12,LEV2PTR(,COMMREG)                               0707 02111000
*                  LEV2LEN = 76;       /* MSG LNG.                    * 02112000
         MVC   LEV2LEN(2,COMMREG),@CH01311                         0708 02113000
*                  LEV2OFF = 0;        /* OFFSET TO INSERT.           * 02114000
         STH   @12,LEV2OFF(,COMMREG)                               0709 02115000
*                  LEV2TEXT = SYNMSG2 -> ERRORMSG;/* MSG TEXT.        * 02116000
         L     @12,SYNMSG2(,COMMREG)                               0710 02117000
         MVC   LEV2TEXT(72,COMMREG),ERRORMSG(@12)                  0710 02118000
*                  /* ARE RCDS 'NONUM' -                              * 02119000
*                  IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.        * 02120000
         TM    CANONUM(COMMREG),B'00000001'                        0711 02121000
         BNO   @RF00711                                            0711 02122000
*                    DO;               /* FIX LINE NO. IN MSG.        * 02123000
*                      PARMREG1 = ADDR(LEV2TEXT);/* SET PT TO TEXT.   * 02124000
         LA    PARMREG1,LEV2TEXT(,COMMREG)                         0713 02125000
*                      CALL FIXLINO;   /* CALL FIXING ROUTINE.        * 02126000
         BAL   @14,FIXLINO                                         0714 02127000
*                    END;              /* FIXED.                      * 02128000
*                  RELMSG2  = 1;       /* 2ND LEVEL MSG NO.           * 02129000
@RF00711 MVC   RELMSG2(2),@CH00039                                 0716 02130000
*                  LEV2INS  = ADDR(LEV2MSG);/* PT TO 2ND LEVEL INSERT.* 02131000
         LA    LEV2INS,LEV2MSG(,COMMREG)                           0717 02132000
*                END;                  /* 2ND LEVEL SETUP DONE.       * 02133000
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     * 02134000
@RF00705 LA    RETCDREG,SENDMSG                                    0719 02135000
*              CALL SENDMSG;           /* GOTO ISSUE MSG.             * 02136000
         BAL   @14,SENDMSG                                         0720 02137000
*SKIPMSG8: ;   /******************************************************* 02138000
SKIPMSG8 DS    0H                                                  0722 02139000
*              /* CHECK IF ATTENTION HAS BEEN ISSUED.                 * 02140000
*              /******************************************************* 02141000
*              IF CAATTNIS = '1'B THEN  /* ATTN HIT.                  * 02142000
         TM    CAATTNIS(COMMREG),B'01000000'                       0722 02143000
         BO    @RT00722                                            0722 02144000
*                GO TO CLEANUP;        /* RETURN TO CALLER.           * 02145000
*              CONTCHK = '1'B;         /* IND CONTINUE SCANNING.      * 02146000
         OI    CONTCHK(COMMREG),B'01000000'                        0724 02147000
*              SYNMSG2 = 0;            /* RESET MSG PT TO 0.          * 02148000
         SLR   @12,@12                                             0725 02149000
         ST    @12,SYNMSG2(,COMMREG)                               0725 02150000
*              GO TO CHKRCALL;         /* RECALL CHECKER.             * 02151000
         B     CHKRCALL                                            0726 02152000
*            END;                      /* MSG PROCESSING COMPLETE.    * 02153000
*          /*********************************************************** 02154000
*          /* CHECK IF SYNTAX ERROR FOUND - BUFFER CHECKING COMPLETE  * 02155000
*          /*********************************************************** 02156000
*          IF RETCODE = 4 THEN         /* ERROR.                      * 02157000
@RF00688 CH    RETCODE,@CH00452                                    0728 02158000
         BNE   @RF00728                                            0728 02159000
*            DO;                       /* BEGIN MSG PROCESSING.       * 02160000
*              /* CHECK IF ERROR MSG SENT BY SYNTAX CHECKER -         * 02161000
*              IF CASYNMS1 = 0 THEN    /* MSG ALREADY SENT.           * 02162000
         SLR   @12,@12                                             0730 02163000
         C     @12,CASYNMS1(,COMMREG)                              0730 02164000
         BE    @RT00730                                            0730 02165000
*                GO TO CHKATTN;        /* SKIP FURTHER MSG PROCESSING.* 02166000
*              MSGPTR = 0;             /* ONLY 1 INSERTION.           * 02167000
         ST    @12,MSGPTR(,COMMREG)                                0732 02168000
*              MSGLEN = 76;            /* LNG OF INSERT.              * 02169000
         MVC   MSGLEN(2,COMMREG),@CH01311                          0733 02170000
*              MSGOFF = 0;             /* OFFSET TO INSERT.           * 02171000
         STH   @12,MSGOFF(,COMMREG)                                0734 02172000
*              MSGTEXT = SYNMSG1 -> ERRORMSG;/* TEXT OF MESSAGE.      * 02173000
         L     @12,SYNMSG1(,COMMREG)                               0735 02174000
         MVC   MSGTEXT(72,COMMREG),ERRORMSG(@12)                   0735 02175000
*              /* ARE RCDS 'NONUM' -                                  * 02176000
*              IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.            * 02177000
         TM    CANONUM(COMMREG),B'00000001'                        0736 02178000
         BNO   @RF00736                                            0736 02179000
*                DO;                   /* FIX LINE NO. IN MSG.        * 02180000
*                  PARMREG1 = ADDR(MSGTEXT);/* SET PT TO TEXT.        * 02181000
         LA    PARMREG1,MSGTEXT(,COMMREG)                          0738 02182000
*                  CALL FIXLINO;       /* GOTO FIXING ROUTINE.        * 02183000
         BAL   @14,FIXLINO                                         0739 02184000
*                END;                  /* FIXED.                      * 02185000
*              RELMSG1  = 1280;        /* MSG NO.                     * 02186000
@RF00736 MVC   RELMSG1(2),@CH01312                                 0741 02187000
*              RELMSG2  = 0;           /* NO 2ND LEVEL MSG.           * 02188000
         SLR   @12,@12                                             0742 02189000
         STH   @12,RELMSG2                                         0742 02190000
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERTION.           * 02191000
         LA    LEV1INS,MSGAREA(,COMMREG)                           0743 02192000
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERTION.     * 02193000
         LR    LEV2INS,@12                                         0744 02194000
*              /* IS THERE A 2ND LEVEL MSG PRESENT -                  * 02195000
*              IF CASYNMS2 ^= 0 THEN   /* 2ND LEVEL MSG EXISTS.       * 02196000
         C     @12,CASYNMS2(,COMMREG)                              0745 02197000
         BE    @RF00745                                            0745 02198000
*                DO;                   /* BEGIN 2ND LEVEL SETUP.      * 02199000
*                  LEV2PTR = 0;        /* ONLY 1 INSERTION.           * 02200000
         ST    @12,LEV2PTR(,COMMREG)                               0747 02201000
*                  LEV2LEN = 76;       /* MSG LNG.                    * 02202000
         MVC   LEV2LEN(2,COMMREG),@CH01311                         0748 02203000
*                  LEV2OFF = 0;        /* OFFSET TO INSERT.           * 02204000
         STH   @12,LEV2OFF(,COMMREG)                               0749 02205000
*                  LEV2TEXT = SYNMSG2 -> ERRORMSG;/* MSG TEXT.        * 02206000
         L     @12,SYNMSG2(,COMMREG)                               0750 02207000
         MVC   LEV2TEXT(72,COMMREG),ERRORMSG(@12)                  0750 02208000
*                  /* ARE RCDS 'NONUM' -                              * 02209000
*                  IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.        * 02210000
         TM    CANONUM(COMMREG),B'00000001'                        0751 02211000
         BNO   @RF00751                                            0751 02212000
*                    DO;               /* FIX LINE NO. IN MSG.        * 02213000
*                      PARMREG1 = ADDR(LEV2TEXT);/* SET PT TO TEXT.   * 02214000
         LA    PARMREG1,LEV2TEXT(,COMMREG)                         0753 02215000
*                      CALL FIXLINO;   /* CALL FIXING ROUTINE.        * 02216000
         BAL   @14,FIXLINO                                         0754 02217000
*                    END;              /* FIXED.                      * 02218000
*                  RELMSG2  = 1;       /* 2ND LEVEL MSG NO.           * 02219000
@RF00751 MVC   RELMSG2(2),@CH00039                                 0756 02220000
*                  LEV2INS  = ADDR(LEV2MSG);/* PT TO 2ND LEVEL INSERT.* 02221000
         LA    LEV2INS,LEV2MSG(,COMMREG)                           0757 02222000
*                END;                  /* 2ND LEVEL SETUP DONE.       * 02223000
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     * 02224000
@RF00745 LA    RETCDREG,SENDMSG                                    0759 02225000
*              CALL SENDMSG;           /* GOTO ISSUE MSG.             * 02226000
         BAL   @14,SENDMSG                                         0760 02227000
*              GO TO CHKATTN;          /* TEST ATTN BIT.              * 02228000
         B     CHKATTN                                             0761 02229000
*            END;                      /* MSG PROCESSING COMPLETE.    * 02230000
*          /*********************************************************** 02231000
*          /* CHECK IF LAST STATEMENT IN BUFFER SENT IS INCOMPLETE    * 02232000
*          /*********************************************************** 02233000
*          IF RETCODE = 12 THEN        /* LAST STMT POTENTIALLY       * 02234000
@RF00728 CH    RETCODE,@CH00151                                    0763 02235000
         BNE   @RF00763                                            0763 02236000
*            DO;                       /* INCOMPLETE.                 * 02237000
*              /* DO MORE LINES REMAIN TO BE SYNTAX-CHECKED -         * 02238000
*              IF ENDSW = '1'B THEN    /* NO MORE LINES, CALL CHECKER * 02239000
         TM    ENDSW,B'01000000'                                   0765 02240000
         BNO   @RF00765                                            0765 02241000
*                DO;                   /* TO DIAGNOSE LAST STMT.      * 02242000
*                  CONTCHK = '0'B;     /* NO FURTHER CHECKING.        * 02243000
*                  INCOMPST = '1'B;    /* DIAGNOSE INCOMPLETE STMT.   * 02244000
         OI    INCOMPST(COMMREG),B'00010000'                       0768 02245000
         NI    CONTCHK(COMMREG),B'10111111'                        0768 02246000
*                  GO TO CHKRCALL;     /* GOTO RECALL CHECKER.        * 02247000
         B     CHKRCALL                                            0769 02248000
*                END;                  /* END OF DIAGNOSIS.           * 02249000
*              ELSE                    /* MORE LINES TO CHECK.        * 02250000
*                DO;                   /* GET OR CHAIN A NEW BUFFER.  * 02251000
@RF00765 DS    0H                                                  0772 02252000
*                  TOTALINE = TOTALINE + RECRDNO;/* INCR NO. LL PASSED* 02253000
         SLR   @12,@12                                             0772 02254000
         ICM   @12,7,BUFFPTR                                       0772 02255000
         SLR   @07,@07                                             0772 02256000
         IC    @07,RECRDNO(,@12)                                   0772 02257000
         ALR   TOTALINE,@07                                        0772 02258000
*                  /* IF HI-ORDER BIT OF STMT COUNT IS ON, ADJUST     * 02259000
*                  /* TOTALINE TO CORRECT VALUE.                      * 02260000
*                  IF FREEBIT = '1'B THEN  /* 'FREEABLE' BIT IS ON.   * 02261000
         TM    FREEBIT(@12),B'10000000'                            0773 02262000
         BNO   @RF00773                                            0773 02263000
*                    TOTALINE = TOTALINE - 128;     /* ADDED TOO MUCH.* 02264000
         SH    TOTALINE,@CH01315                                   0774 02265000
*                  CALL MOREBFRS;      /* GO GET MORE BUFFER AREA.    * 02266000
@RF00773 BAL   @14,MOREBFRS                                        0775 02267000
*                  GO TO MOVEREC;      /* GOTO BRING IN MORE RCDS.    * 02268000
         B     MOVEREC                                             0776 02269000
*                END;                  /* BUFFER HANDLING COMPLETE.   * 02270000
*            END;                      /* INCOMPLETE STMT HANDLED.    * 02271000
*          /* ******************************************************* * 02272000
*          /** CHECK IF SYNTAX CHECKER IS OPERATIONAL.               ** 02273000
*          /* ******************************************************* * 02274000
*          IF RETCODE = 20 THEN        /* INOPERATIVE.                * 02275000
@RF00763 CH    RETCODE,@CH00142                                    0779 02276000
         BNE   @RF00779                                            0779 02277000
*            DO;                       /* SET UP FOR RECOVERY.        * 02278000
*              SCRETCD = 16;           /* IND RECOVERY TO BE TRIED.   * 02279000
         MVC   SCRETCD(4),@CF00241                                 0781 02280000
*              GO TO CLEANUP;          /* RETURN TO CALLER.           * 02281000
         B     CLEANUP                                             0782 02282000
*            END;                      /* READY FOR RECOVERY.         * 02283000
*          /*********************************************************** 02284000
*          /* CHECK IF ATTENTION HAS BEEN ISSUED                      * 02285000
*          /*********************************************************** 02286000
*CHKATTN:  /* CONTROL COMES HERE TO CHECK FOR ATTN.                   * 02287000
*          IF CAATTNIS = '1'B THEN     /* ATTN ISSUED.                * 02288000
@RF00779 DS    0H                                                  0784 02289000
CHKATTN  TM    CAATTNIS(COMMREG),B'01000000'                       0784 02290000
         BO    @RT00784                                            0784 02291000
*            GO TO CLEANUP;            /* CLEAN UP AND RETURN.        * 02292000
*          /*********************************************************** 02293000
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     * 02294000
*          /*********************************************************** 02295000
*          IF ENDSW = '0'B THEN        /* MORE LINES TO BE CHECKED.   * 02296000
         TM    ENDSW,B'01000000'                                   0786 02297000
         BNZ   @RF00786                                            0786 02298000
*            DO;                       /* RESET BUFFER POINTERS.      * 02299000
*              TOTALINE = TOTALINE + RECRDNO;/*INCR NO. LINES SENT.   * 02300000
         SLR   @12,@12                                             0788 02301000
         ICM   @12,7,BUFFPTR                                       0788 02302000
         SLR   @07,@07                                             0788 02303000
         IC    @07,RECRDNO(,@12)                                   0788 02304000
         ALR   TOTALINE,@07                                        0788 02305000
*              /* IF HI-ORDER BIT OF STMT COUNT IS ON,ADJUST TOTALINE.* 02306000
*              IF FREEBIT = '1'B THEN  /* ADDED 128 TOO MUCH,         * 02307000
         TM    FREEBIT(@12),B'10000000'                            0789 02308000
         BNO   @RF00789                                            0789 02309000
*                TOTALINE = TOTALINE - 128;     /* COMPENSATE FOR IT. * 02310000
         SH    TOTALINE,@CH01315                                   0790 02311000
*              TOTALINX = TOTALINE;    /* UPDATE LAST NO. LINES SENT. * 02312000
@RF00789 ST    TOTALINE,TOTALINX                                   0791 02313000
*              /* CHECK IF THIS IS AFTER A R.C. 12.                   * 02314000
*              IF RC12SW = '1'B THEN   /* FOLLOWS RET CODE 12.        * 02315000
         TM    RC12SW,B'10000000'                                  0792 02316000
         BNO   @RF00792                                            0792 02317000
*                DO;                   /* RESET POINTERS AND SWITCH.  * 02318000
*                  BUFFPTR = FREEAREA(1:4);           /*RESET PT TO 1ST 02319000
*                                                       BUFFER GOTTEN.* 02320000
         MVC   BUFFPTR(3),FREEAREA+1(COMMREG)                      0794 02321000
*                  GETMNLEN = FREELEN(1:4);           /*RESET BFR LNG.* 02322000
         MVC   GETMNLEN(4),FREELEN(COMMREG)                        0795 02323000
*                  RC12SW = '0'B;      /* R.C. 12 PROCESSING DONE.    * 02324000
         NI    RC12SW,B'01111111'                                  0796 02325000
*                END;                  /* POINTERS AND SWITCH RESET.  * 02326000
*              CURBFPTR = BUFFPTR;     /* SET WORKING PT TO BFR BEGNG.* 02327000
@RF00792 SLR   @12,@12                                             0798 02328000
         ICM   @12,7,BUFFPTR                                       0798 02329000
         LR    CURBFPTR,@12                                        0798 02330000
*              ENDBFPTR = BUFFPTR + GETMNLEN;/* SET PT TO END OF BFR. * 02331000
         LR    @07,@12                                             0799 02332000
         AL    @07,GETMNLEN                                        0799 02333000
         STCM  @07,7,ENDBFPTR                                      0799 02334000
*              RECRDNO = 0;            /* NO LINES SENT YET.          * 02335000
         MVI   RECRDNO(@12),X'00'                                  0800 02336000
*              CASYNBFR = BUFFPTR;     /* SET PT TO BFR CHAIN.        * 02337000
         ST    @12,CASYNBFR(,COMMREG)                              0801 02338000
*              SNSYNBFR = CASYNBFR;    /* SAVE THIS POINTER.          * 02339000
         ST    @12,SNSYNBFR                                        0802 02340000
*              GO TO MOVEREC;          /* GO BRING RCD INTO BFR.      * 02341000
         B     MOVEREC                                             0803 02342000
*            END;                      /* BUFFER POINTERS RESET.      * 02343000
*CLEANUP:  /*********************************************************** 02344000
*          /* SCAN COMPETED - CLEAN UP AND EXIT PROCESSING            * 02345000
*          /*********************************************************** 02346000
*          CACURNUM = RECRDKEY;        /* SET NEW CURRENT REF. LINE   * 02347000
@RF00786 DS    0H                                                  0805 02348000
CLEANUP  MVC   CACURNUM(4,COMMREG),RECRDKEY                        0805 02349000
*          SYNMSG2 = 0;                /* RE-INIT MESSAGE PTR TO ZERO.* 02350000
         SLR   @12,@12                                             0806 02351000
         ST    @12,SYNMSG2(,COMMREG)                               0806 02352000
*          BINRYREG = ADDR(FREEAREA);  /* FREEMAIN BUFFER AREAS       * 02353000
         LA    BINRYREG,FREEAREA(,COMMREG)                         0807 02354000
*          PARMREG0 = ADDR(FREELEN);   /* ADDRESS OF LIST OF LENGTHS. * 02355000
         LA    PARMREG0,FREELEN(,COMMREG)                          0808 02356000
*          PARMREG1 = ADDR(GETLST);    /* ADDRESS OF PARAMETER LIST.  * 02357000
         LA    PARMREG1,GETLST                                     0809 02358000
*          /* FREE THE BUFFERS.                                       * 02359000
*          GEN (FREEMAIN L,LA=(0),A=(4),SP=1,MF=(E,(1)));          0810 02360000
         FREEMAIN L,LA=(0),A=(4),SP=1,MF=(E,(1))                        02361000
*          /*********************************************************** 02362000
*          /* CHECK IF 'NOSCAN' SPECIFIED ON EDIT COMMAND             * 02363000
*          /*********************************************************** 02364000
*          IF CASCANON = '0'B THEN     /* SCANNING IS NOT IN EFFECT.  * 02365000
         TM    CASCANON(COMMREG),B'00100000'                       0811 02366000
         BNZ   @RF00811                                            0811 02367000
*            SCANOPT = '1'B;           /* SET NOSCAN OPTION.          * 02368000
         OI    SCANOPT(COMMREG),B'00000001'                        0812 02369000
*DELTMOD:  /*********************************************************** 02370000
*          /* CHECK IF SYNTAX CHECKER MODULE MUST BE DELETED          * 02371000
*          /*********************************************************** 02372000
*          IF CASCANSW = '0'B                                      0813 02373000
*             & CADSCODE ^= CABASIC                                0813 02374000
*             & CADSCODE ^= CAIPLI                                 0813 02375000
*             & SCRETCD ^= 16 THEN       /* CHECKER MUST BE DELETED.  * 02376000
@RF00811 DS    0H                                                  0813 02377000
DELTMOD  TM    CASCANSW(COMMREG),B'00010000'                       0813 02378000
         BNZ   @RF00813                                            0813 02379000
         CLI   CADSCODE(COMMREG),X'20'                             0813 02380000
         BE    @RF00813                                            0813 02381000
         CLI   CADSCODE(COMMREG),X'21'                             0813 02382000
         BE    @RF00813                                            0813 02383000
         CLC   SCRETCD(4),@CF00241                                 0813 02384000
         BE    @RF00813                                            0813 02385000
*            DO;                       /* PERFORM FINAL ENTRY,DELETE. * 02386000
*              LASTENT = '1'B;         /* FINAL ENTRY CODE.           * 02387000
         OI    LASTENT(COMMREG),B'00100000'                        0815 02388000
*              CASYNBFR = 0;           /* NO SCANNING TO BE DONE.     * 02389000
         SLR   @12,@12                                             0816 02390000
         ST    @12,CASYNBFR(,COMMREG)                              0816 02391000
*              PARMREG1 = ADDR(CASYNLST);/* SET PT TO PARM LIDT.      * 02392000
         LA    PARMREG1,CASYNLST(,COMMREG)                         0817 02393000
*              RFY (PARMREG0,RETCDREG) RSTD;                       0818 02394000
*              RETCDREG = CAPTCHK;     /* SET PT TO CHECKER.          * 02395000
         L     @12,CAPTCHK(,COMMREG)                               0819 02396000
         LR    RETCDREG,@12                                        0819 02397000
*              CALL CHECKER;           /* FINAL ENTRY.                * 02398000
         LR    @15,@12                                             0820 02399000
         BALR  @14,@15                                             0820 02400000
*              PARMREG0 = ADDR(CASYNAME);/* SET PT TO ENTRY NAME.     * 02401000
         LA    PARMREG0,CASYNAME(,COMMREG)                         0821 02402000
*              /* DELETE THE SYNTAX CHECKER.                          * 02403000
*              GEN (DELETE EPLOC=(0));                             0822 02404000
         DELETE EPLOC=(0)                                               02405000
*              CAPTCHK = 0;            /* ZERO CHECKER POINTER.       * 02406000
         SLR   @14,@14                                             0823 02407000
         ST    @14,CAPTCHK(,COMMREG)                               0823 02408000
*              RFY (PARMREG0,RETCDREG) UNRSTD;                     0824 02409000
*            END;                      /* FINAL ENTRY,DELETION DONE.  * 02410000
*SCNEXIT:  /*********************************************************** 02411000
*          /* CHECK IF IKJPARS CALLED TO SCAN OPERANDS                * 02412000
*          /*********************************************************** 02413000
*          IF CAFREEDL = '0'B THEN     /* PDL EXISTS.                 * 02414000
@RF00813 DS    0H                                                  0826 02415000
SCNEXIT  TM    CAFREEDL(COMMREG),B'10000000'                       0826 02416000
         BNZ   @RF00826                                            0826 02417000
*            DO;                       /* FREE PDL.                   * 02418000
*              PARMREG1 = ADDR(CAPTPRSD);/* SET PT TO ANSWER PLACE.   * 02419000
         LA    PARMREG1,CAPTPRSD(,COMMREG)                         0828 02420000
*              CAFREEDL = '1'B;        /* IND PDL FREED.              * 02421000
         OI    CAFREEDL(COMMREG),B'10000000'                       0829 02422000
*              /* RELEASE THE PARAMETER DESCRIPTOR LIST.              * 02423000
*              GEN (IKJRLSA (1));                                  0830 02424000
         IKJRLSA (1)                                                    02425000
*            END;                      /* PDL NOW FREED.              * 02426000
*          /*********************************************************** 02427000
*          /* CHECK IF VERIFY SWITCH IS ON.                           * 02428000
*          /*********************************************************** 02429000
*          IF CAVRFYSW = '1'B THEN     /* VERIFICATION IN EFFECT      * 02430000
@RF00826 TM    CAVRFYSW(COMMREG),B'01000000'                       0832 02431000
         BNO   @RF00832                                            0832 02432000
*            DO;                       /* PREPARE VERIFY LONE.        * 02433000
*              AREAPTR = ADDR(CATEMPBF);/* SET PT TO                  * 02434000
         LA    @08,CATEMPBF(,COMMREG)                              0834 02435000
         ST    @08,AREAPTR                                         0834 02436000
*              AREAPTR = AREAPTR + 12;      /* INPUT BFR.             * 02437000
         AH    @08,@CH00151                                        0835 02438000
         ST    @08,AREAPTR                                         0835 02439000
*              PLISTEND = '1'B;        /* MARK END OF PARM LIST.      * 02440000
         OI    PLISTEND,B'10000000'                                0836 02441000
*              KEYPTR = ADDR(CACURNUM);/* SET PT TO KEY.              * 02442000
         LA    @08,CACURNUM(,COMMREG)                              0837 02443000
         ST    @08,KEYPTR                                          0837 02444000
*              UTCODE = '00'X;         /* 'READ CURRENT' OPTION.      * 02445000
         MVI   UTCODE,X'00'                                        0838 02446000
*              RETCDREG = ADDR(READRTN);/* SET PT TO READ ROUTINE.    * 02447000
         LA    RETCDREG,READRTN                                    0839 02448000
*              CALL READRTN;           /* GOTO READ RCD.              * 02449000
         BAL   @14,READRTN                                         0840 02450000
*              /* WAS READ SUCCESSFUL -                               * 02451000
*              IF RETCODE ^= 0 THEN        /* RCD NOT FOUND.          * 02452000
         LTR   RETCODE,RETCODE                                     0841 02453000
         BNZ   @RT00841                                            0841 02454000
*                GO TO NOSCEXT;        /* RETURN TO CALLER.           * 02455000
*              CALNTOVF = '1'B;        /* IND LINE TO BE VERIFIED.    * 02456000
         OI    CALNTOVF(COMMREG),B'10000000'                       0843 02457000
*            END;                      /* LINE READY FOR VERIFICATION.* 02458000
*NOSCEXT:  RETCDREG = SCRETCD;         /* SET RETURN CODE IN REG 15   * 02459000
@RF00832 DS    0H                                                  0845 02460000
NOSCEXT  L     RETCDREG,SCRETCD                                    0845 02461000
*          GOTO RETCNTL;                                           0846 02462000
         B     RETCNTL                                             0846 02463000
*FNINCMP:  /* CONTROL COMES HERE WHEN THIS MODULE'S FUNCTION CANNOT   * 02464000
*          /* BE COMPLETED AND A SPECIAL RETURN CODE MUST BE SET.     * 02465000
*                                                                  0847 02466000
*          SCRETCD=8;                  /* IND FUNCTION INCOMPLETE.    * 02467000
FNINCMP  MVC   SCRETCD(4),@CF00044                                 0847 02468000
*          GOTO CLEANUP;               /* GOTO EXIT PROCESSING.       * 02469000
         B     CLEANUP                                             0848 02470000
*RETCNTL:  RETREG = WHOLPTR;           /* RESTORE RETURN POINT        * 02471000
RETCNTL  L     RETREG,WHOLPTR                                      0849 02472000
*          RETURN;                                                 0850 02473000
@EL00004 DS    0H                                                  0850 02474000
@EF00004 DS    0H                                                  0850 02475000
@ER00004 BR    @14                                                 0850 02476000
*          END WHOLSCAN;                                           0851 02477000
*CONVERT:  PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0852 02478000
CONVERT  ST    @14,12(,@13)                                        0852 02479000
*          /*********************************************************** 02480000
*          /*                                                         * 02481000
*          /* THIS SUBROUTINE CONVERTS THE LINE NUMBER OR COUNT       * 02482000
*          /* OPERANDS FROM ZONED DECIMAL TO BINARY.  THE BINARY      * 02483000
*          /* VALUE IS RETURNED TO THE CALLER IN REGISTER 4.          * 02484000
*          /*                                                         * 02485000
*          /*********************************************************** 02486000
*          GENERATE;                                               0853 02487000
         PACK  PACKAREA(8),PACKAREA(8) PACK LINE                        02488000
*                                      NUMBER OR COINT.                 02489000
         CVB   BINRYREG,PACKAREA       CONVERT LINE NUM OR COUNT        02490000
*                                      TO BINARY                        02491000
*          RETURN;                     /* GO BACK TO MAIN PROGRAM.    * 02492000
@EL00005 DS    0H                                                  0854 02493000
@EF00005 DS    0H                                                  0854 02494000
@ER00005 L     @14,12(,@13)                                        0854 02495000
         BR    @14                                                 0854 02496000
*          END CONVERT;                /* END OF CONVERSION.          * 02497000
*FIXLINO:  PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0856 02498000
FIXLINO  ST    @14,12(,@13)                                        0856 02499000
*          /*********************************************************** 02500000
*          /* THIS SUBROUTINE CHANGES THE LINE IDENTIFIER IN A SYNTAX * 02501000
*          /* CHECKER ERROR MESSAGE FOR A NON-LINE-NUMBERED DATA SET  * 02502000
*          /* TO A TRUE RELATIVE LINE NUMBER.                         * 02503000
*          /*********************************************************** 02504000
*          GENERATE;                                               0857 02505000
         PACK  PACKAREA(8),8(8,PARMREG1) PACK                           02506000
*                                      SEQUENCE NUMBER FROM MSG.        02507000
         CVB   BINRYREG,PACKAREA                                        02508000
*        BINRYREG = BINRYREG + TOTALINX;                           0858 02509000
         AL    BINRYREG,TOTALINX                                   0858 02510000
*        GEN;                                                      0859 02511000
         CVD   BINRYREG,PACKAREA                                        02512000
         UNPK  8(8,PARMREG1),PACKAREA(8) UNPACK                         02513000
*                                      SEQUENCE NUMBER INTO MSG.        02514000
         OI    8+8-1(PARMREG1),C'0'                                     02515000
*          RETURN;                     /* GO BACK TO MAIN PROGRAM.    * 02516000
@EL00006 DS    0H                                                  0860 02517000
@EF00006 DS    0H                                                  0860 02518000
@ER00006 L     @14,12(,@13)                                        0860 02519000
         BR    @14                                                 0860 02520000
*          END FIXLINO;                /* END OF CONVERSION.          * 02521000
*INITPLST: PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0862 02522000
INITPLST ST    @14,12(,@13)                                        0862 02523000
*          /*********************************************************** 02524000
*          /*                                                         * 02525000
*          /* THIS SUBROUTINE INITIALIZES THE SYNTAX CHECKER          * 02526000
*          /* PARAMETER LIST FOR INITIAL ENTRY.  WORDS TWO AND THREE  * 02527000
*          /* OF THE LIST ARE PERMANENTLY INITIALIZED TO POINT TO THE * 02528000
*          /* SYNTAX CHECKER WORK AREA AND OPTION WORD.  THE MESSAGE  * 02529000
*          /* POINTERS IN THE WORK AREA ARE INITIALIZED TO ZERO AND   * 02530000
*          /* THE OPTIONS WORD IS COMPLETELY INITIALIZED FOR THE      * 02531000
*          /* SPECIFIED DATA SET TYPE.  WORD ONE OF THE PARAMETER LIST* 02532000
*          /* IS INITIALIZED TO ZERO FOR FIRST ENTRY, BUT WILL CHANGE * 02533000
*          /* WITH EACH SUBSEQUENT CALL TO THE SYNTAX CHECKER.        * 02534000
*          /*                                                         * 02535000
*          /*********************************************************** 02536000
*          /* RESTRICT COMPILER USE OF PTRS TO IKJEBECA AND WORK AREA * 02537000
*          /* AND TO PROGRAM BASE REGISTER                            * 02538000
*          RESPECIFY(COMMREG,          /* PT TO COMM AREA.            * 02539000
*                    BASEREG,          /* PROGRAM BASE REG.           * 02540000
*                    DATAREG) RSTD;    /* WORKAREA BASE REG.          * 02541000
*          CASYNBFR = 0;               /* ZERO BUFFER POINTER.        * 02542000
         SLR   @12,@12                                             0864 02543000
         ST    @12,CASYNBFR(,COMMREG)                              0864 02544000
*          CASYNPWA = ADDR(CASYNWA);   /* INIT PTR TO WORK AREA       * 02545000
         LA    @08,CASYNWA(,COMMREG)                               0865 02546000
         ST    @08,CASYNPWA(,COMMREG)                              0865 02547000
*          CASYNPTO = ADDR(CASYNOPT);  /* INIT PTR TO OPTION WORD     * 02548000
         LA    @08,CASYNOPT(,COMMREG)                              0866 02549000
         ST    @08,CASYNPTO(,COMMREG)                              0866 02550000
*          BYTE = '80'X;               /* MARK END OF PARM LIST.      * 02551000
         MVI   BYTE(COMMREG),X'80'                                 0867 02552000
*          FIRSTENT = '0'B;            /* MARK AS FIRST ENTRY         * 02553000
*          CONTCHK = '0'B;             /* SET FOR NO CONTINUE CHECKING* 02554000
*          LASTENT = '0'B;             /* MARK AS NOT LAST ENTRY      * 02555000
         NI    FIRSTENT(COMMREG),B'00011111'                       0870 02556000
*          CASYNMS1 = 0;               /* ZERO 1ST LEVEL MESSAGE PTR. * 02557000
         ST    @12,CASYNMS1(,COMMREG)                              0871 02558000
*          CASYNMS2 = 0;               /* ZERO 2ND LEVEL MESSAGE PTR. * 02559000
         ST    @12,CASYNMS2(,COMMREG)                              0872 02560000
*          CODE1AN2 = CACHKOPT;        /* SET DATA-SET-TYPE-DEPENDENT   02561000
*                                         VALUES IN OPT WORD.   A45714* 02562000
         MVC   CODE1AN2(2,COMMREG),CACHKOPT(COMMREG)               0873 02563000
*          /*********************************************************** 02564000
*          /* CHECK IF LOGICAL RECORD LENGTH FIXED                    * 02565000
*          /*********************************************************** 02566000
*          IF CARECFM = '1'B THEN      /* RECFM = F.                  * 02567000
         TM    CARECFM(COMMREG),B'01000000'                        0874 02568000
         BNO   @RF00874                                            0874 02569000
*            DO;                       /* IND LRECL,RECFM IN OPT. WD. * 02570000
*              RECORDLN = CALRECL - 4;       /* SUBTRACT CNTL WD LNG. * 02571000
         LH    @12,CALRECL(,COMMREG)                               0876 02572000
         SH    @12,@CH00452                                        0876 02573000
         STC   @12,RECORDLN(,COMMREG)                              0876 02574000
*              RECLN = '0'B;           /* FIXED LNG OPTION.           * 02575000
         NI    RECLN(COMMREG),B'11110111'                          0877 02576000
*            END;                      /* LRECL,RECFM SET.            * 02577000
*          ELSE                        /* RECFM = V.                  * 02578000
*            DO;                       /* IND RECFM IN OPTION WORD.   * 02579000
         B     @RC00874                                            0879 02580000
@RF00874 DS    0H                                                  0880 02581000
*              RECORDLN = '00'X;       /* NO LRECL SPECIFIED(VAR LNG).* 02582000
         MVI   RECORDLN(COMMREG),X'00'                             0880 02583000
*              RECLN = '1'B;           /* VARIABLE LNG OPTION.        * 02584000
         OI    RECLN(COMMREG),B'00001000'                          0881 02585000
*            END;                      /* RECFM SET.                  * 02586000
*          /****************************************************A45714* 02587000
*          /* CHECK IF 'CHAR48' WAS SPECIFIED ON THE EDIT CMD.  A45714* 02588000
*          /****************************************************A45714* 02589000
*          IF CACHAR48 = '1'B THEN     /* 'CHAR48' SPECIFIED.   A45714* 02590000
@RC00874 TM    CACHAR48(COMMREG),B'01000000'                       0883 02591000
         BNO   @RF00883                                            0883 02592000
*            CHAR4860 = '1'B;          /* SET SWITCH IN OPTION WORD TO  02593000
*                                         INDICATE 'CHAR48'.    A45714* 02594000
         OI    CHAR4860(COMMREG),B'10000000'                       0884 02595000
*          /*********************************************************** 02596000
*          /* CHECK IF DATA SET IS LINE NUMBERED                      * 02597000
*          /*********************************************************** 02598000
*          IF CANONUM = '1'B THEN      /* NONUM DATA.                 * 02599000
@RF00883 TM    CANONUM(COMMREG),B'00000001'                        0885 02600000
         BNO   @RF00885                                            0885 02601000
*            LNUM = '1'B;              /* SET NONUM OPTION.           * 02602000
         OI    LNUM(COMMREG),B'01000000'                           0886 02603000
*          ELSE                        /* NUM DATA.                   * 02604000
*            LNUM = '0'B;              /* SET NUM OPTION.             * 02605000
         B     @RC00885                                            0887 02606000
@RF00885 NI    LNUM(COMMREG),B'10111111'                           0887 02607000
*          INCOMP = '1'B;              /* SET BIT FOR CHECKER TO RETURN 02608000
*                                         WITH RC=12 IF LAST STATEMENT  02609000
*                                         IN BUFFER INCOMPLETE        * 02610000
@RC00885 OI    INCOMP(COMMREG),B'00010000'                         0888 02611000
*          /*********************************************************** 02612000
*          /* CHECK IF 'FREE' SPECIFIED ON EDIT COMMAND               * 02613000
*          /*********************************************************** 02614000
*          IF CAFREE = '1'B THEN       /* FREE-FORM SOURCE.           * 02615000
         TM    CAFREE(COMMREG),B'10000000'                         0889 02616000
         BNO   @RF00889                                            0889 02617000
*            RECFORM = '1'B;           /* SET FREE OPTION.            * 02618000
         OI    RECFORM(COMMREG),B'00000100'                        0890 02619000
*          ELSE                        /* STANDARD FORM SOURCE.       * 02620000
*            RECFORM = '0'B;           /* SET FIXED OPTION.           * 02621000
         B     @RC00889                                            0891 02622000
@RF00889 NI    RECFORM(COMMREG),B'11111011'                        0891 02623000
*          MSGLN = '1'B;               /* SET BIT FOR SHORT MESSAGES  * 02624000
@RC00889 OI    MSGLN(COMMREG),B'00000010'                          0892 02625000
*          /*********************************************************** 02626000
*          /* CHECK IF 'NOSCAN' SPECIFIED ON EDIT COMMAND             * 02627000
*          /*********************************************************** 02628000
*          IF CASCANON = '0'B THEN     /* SCANNING NOT IN EFFECT.     * 02629000
         TM    CASCANON(COMMREG),B'00100000'                       0893 02630000
         BNZ   @RF00893                                            0893 02631000
*            SCANOPT = '1'B;           /* SET NOSCAN OPTION.          * 02632000
         OI    SCANOPT(COMMREG),B'00000001'                        0894 02633000
*          ELSE                        /* SCANNING IS IN EFFECT.      * 02634000
*            SCANOPT = '0'B;           /* SET SCAN OPTION.            * 02635000
         B     @RC00893                                            0895 02636000
@RF00893 NI    SCANOPT(COMMREG),B'11111110'                        0895 02637000
*          RETURN;                     /* GO BACK TO MAIN PROGRAM.    * 02638000
@EL00007 DS    0H                                                  0896 02639000
@EF00007 DS    0H                                                  0896 02640000
@ER00007 L     @14,12(,@13)                                        0896 02641000
         BR    @14                                                 0896 02642000
*          END INITPLST;               /* END OF INITIAL PLIST SETUP. * 02643000
         B     @EL00007                                            0897 02644000
*MOREBFRS: PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0898 02645000
MOREBFRS ST    @14,12(,@13)                                        0898 02646000
*          /*********************************************************** 02647000
*          /**      THIS SUBROUTINE IS ENTERED WHEN LINES REMAIN TO  ** 02648000
*          /** BE SCANNED AFTER RET CODE 12 IS RETURNED BY A SYNTAX  ** 02649000
*          /** CHECKER, TO ADD A BUFFER TO THE EXISTING CHAIN OR TO  ** 02650000
*          /** FORM A NEW BUFFER CHAIN.                              ** 02651000
*          /** THE PROCEDURE -                                       ** 02652000
*          /**      MOVE THE BUFFER POINTER ALONG THE CHAIN UNTIL    ** 02653000
*          /** THE FIRST NON-FREEABLE BUFFER IS ENCOUNTERED, OR, IF  ** 02654000
*          /** THE WHOLE CHAIN IS FREEABLE, TO THE LAST BUFFER IN    ** 02655000
*          /** THE CHAIN.  IF THE WHOLE CHAIN WAS FREEABLE RESET THE ** 02656000
*          /** CURRENT BUFFER POINTER TO THE BEGINNING OF THE LAST   ** 02657000
*          /** BUFFER, SET T0 ZERO THE NO. OF LINES IN THE BUFFER,   ** 02658000
*          /** SET THE SWITCH INDICATING RECOVERY FROM RET CODE 12,  ** 02659000
*          /** AND RETURN.                                           ** 02660000
*          /**      IF THE WHOLE CHAIN WAS NOT FREEABLE, SEARCH      ** 02661000
*          /** AMONGST THE BUFFERS GOTTEN SO FAR FOR A FREEABLE      ** 02662000
*          /** BUFFER.  IF NONE IS FOUND GETMAIN A NEW ONE AND ADD   ** 02663000
*          /** ITS ADDRESS & LENGTH TO THE APPROPRIATE LISTS.        ** 02664000
*          /**      ONCE A BUFFER IS FOUND OR OBTAINED, TURN OFF ITS ** 02665000
*          /** FREEABLE BIT, SET NO. OF LINES IN IT TO ZERO, ZERO    ** 02666000
*          /** ITS FORWARD POINTER, ADD IT TO THE END OF THE EXIST-  ** 02667000
*          /** ING CHAIN, UPDATE WORKING BUFFER POINTERS, INDICATE   ** 02668000
*          /** RETURN CODE 12 RECOVERY, AND RETURN.                  ** 02669000
*          /* ******************************************************* * 02670000
*          RESPECIFY(COMMREG,          /* PT TO COMM AREA.            * 02671000
*                    BASEREG,          /* PROGRAM BASE REG.           * 02672000
*                    BASEREG2,         /* PROGRAM 2ND BASE REGISTER   * 02673000
*                    DATAREG) RSTD;    /* WORKAREA BASE REG.          * 02674000
*          /* ******************************************************* * 02675000
*          /** SEE IF CASYNBFR POINTS TO A FREEABLE BUFFER.          ** 02676000
*          /* ******************************************************* * 02677000
*          CASYNBFR = SNSYNBFR;        /* RESTORE CASYNBFR.     A50469* 02678000
         MVC   CASYNBFR(4,COMMREG),SNSYNBFR                        0900 02679000
*          /* THEN PERFORM THE TEST.                                  * 02680000
*CUTLINKS: IF CASYNBFR->FREEBIT='1'B THEN  /* BFR REUSABLE.     A50469* 02681000
CUTLINKS L     @12,CASYNBFR(,COMMREG)                              0901 02682000
         TM    FREEBIT(@12),B'10000000'                            0901 02683000
         BNO   @RF00901                                            0901 02684000
*            DO;                       /* RESET PT TO BUFFER CHAIN TO   02685000
*                                         NEAREST NON-FREEABLE BFR OR   02686000
*                                         TO END OF CHAIN.            * 02687000
*              TEMPTR=CASYNBFR->FORWDPTR;/* GET FORWARD PT FR CURR BFR* 02688000
         MVC   TEMPTR(3),FORWDPTR(@12)                             0903 02689000
*              TEMPBYTE='00'X;         /* ZERO HI-ORDER BYTE.         * 02690000
         MVI   TEMPBYTE,X'00'                                      0904 02691000
*              /* SEE IF END-OF-CHAIN HAS BEEN REACHED.               * 02692000
*              IF TEMPWORD='00000000'X THEN/*                      0905 02693000
*                                           END OF CHAIN.             * 02694000
         CLC   TEMPWORD(4),@CB01340                                0905 02695000
         BNE   @RF00905                                            0905 02696000
*                DO;                   /* REUSE THIS BUFFER,          * 02697000
*                  CURBFPTR=CASYNBFR;  /* RESET CURR BFR PT.          * 02698000
         LR    CURBFPTR,@12                                        0907 02699000
*                  RECRDNO=0;          /* NO LINES IN BUFFER YET.     * 02700000
         SLR   @12,@12                                             0908 02701000
         ICM   @12,7,BUFFPTR                                       0908 02702000
         MVI   RECRDNO(@12),X'00'                                  0908 02703000
*                  GO TO RECOVER1;     /* GO TO CONTINUE.             * 02704000
         B     RECOVER1                                            0909 02705000
*                END;                  /* BUFFER REUSED.              * 02706000
*              ELSE                    /* THERE ARE MORE BFRS IN CHAIN* 02707000
*                DO;                   /* TRY NEXT BUFFER.            * 02708000
@RF00905 DS    0H                                                  0912 02709000
*                  CASYNBFR=CASYNBFR->FORWDPTR;/* ADVANCE POINTER.    * 02710000
         L     @12,CASYNBFR(,COMMREG)                              0912 02711000
         SLR   @07,@07                                             0912 02712000
         ICM   @07,7,FORWDPTR(@12)                                 0912 02713000
         ST    @07,CASYNBFR(,COMMREG)                              0912 02714000
*                  TEMPWORD=CASYNBFR;  /* ZERO                        * 02715000
         ST    @07,TEMPWORD                                        0913 02716000
*                  TEMPBYTE='00'X;     /*  HI-ORDER                   * 02717000
         MVI   TEMPBYTE,X'00'                                      0914 02718000
*                  CASYNBFR=TEMPWORD;  /*   BYTE.                     * 02719000
         MVC   CASYNBFR(4,COMMREG),TEMPWORD                        0915 02720000
*                  GO TO CUTLINKS;     /* LOOP TO TEST NEXT 'FREE' BIT* 02721000
         B     CUTLINKS                                            0916 02722000
*                END;                  /* NEXT BFR TRIED.             * 02723000
*            END;                      /* PT TO BFR CHAIN NOW RESET.  * 02724000
*          ELSE;                       /* BUFFER NOT REUSABLE. FALL     02725000
*                                         THRU TO FIND A FREE BUFFER. * 02726000
@RF00901 DS    0H                                                  0920 02727000
*          TEMPTR='00000000'X;         /* INITLZ SUBSCRIPT TO ZERO.   * 02728000
         SLR   @12,@12                                             0920 02729000
         STCM  @12,7,TEMPTR                                        0920 02730000
*CHAINTRY: /* CONTROL LOOPS BACK TO HERE DURING SEARCH FOR A FREE BFR.* 02731000
*          FORWDPTR=FREEAREA(TEMPTR+2:TEMPTR+4);           /*TRY A BFR* 02732000
CHAINTRY SLR   @12,@12                                             0921 02733000
         ICM   @12,7,BUFFPTR                                       0921 02734000
         SLR   @07,@07                                             0921 02735000
         ICM   @07,7,TEMPTR                                        0921 02736000
         L     @07,FREEAREA(@07,COMMREG)                           0921 02737000
         LA    @07,0(,@07)                                         0921 02738000
         STCM  @07,7,FORWDPTR(@12)                                 0921 02739000
*          /* ******************************************************* * 02740000
*          /** SEE IF THIS BUFFER IS FREE TO BE USED.                ** 02741000
*          /* ******************************************************* * 02742000
*          IF FORWDPTR->FREEBIT='1'B THEN  /* THIS BFR IS FREE.       * 02743000
         TM    FREEBIT(@07),B'10000000'                            0922 02744000
         BO    @RT00922                                            0922 02745000
*            GO TO FOUNDONE;           /* GO TO ADD IT TO CHAIN.      * 02746000
*          ELSE                        /* THIS BFR IS NOT FREE.       * 02747000
*FLAGTEST:   /* SEE IF END OF LIST OF BFRS HAS BEEN REACHED.          * 02748000
*            IF FREELEN(TEMPTR+1)>='80'X THEN        /* END OF LIST.  * 02749000
FLAGTEST SLR   @12,@12                                             0924 02750000
         ICM   @12,7,TEMPTR                                        0924 02751000
         ALR   @12,COMMREG                                         0924 02752000
         CLI   FREELEN(@12),X'80'                                  0924 02753000
         BNL   @RT00924                                            0924 02754000
*              GO TO GETNEW;           /* MUST OBTAIN A NEW BFR.      * 02755000
*            ELSE                      /* LIST NOT YET EXHAUSTED.     * 02756000
*              DO;                     /* MOVE ON TO NEXT BFR IN LIST.* 02757000
*                TEMPTR=TEMPTR+4;       /* BUMP PT BY A WORD.        .* 02758000
         SLR   @12,@12                                             0927 02759000
         ICM   @12,7,TEMPTR                                        0927 02760000
         AH    @12,@CH00452                                        0927 02761000
         STCM  @12,7,TEMPTR                                        0927 02762000
*                GO TO CHAINTRY;       /* GO SEE IF NEXT BFR IS FREE. * 02763000
         B     CHAINTRY                                            0928 02764000
*              END;                    /* NEXT BFR TRIED.             * 02765000
*FOUNDONE: /* CONTROL COMES HERE WHEN A BFR IS FOUND TO ADD TO CHAIN. * 02766000
*          FORWDPTR->RECRDNO=0;        /* NO LINES IN BFR YET (THIS     02767000
*                                         ALSO TURNS OFF FREEABLE BIT.* 02768000
FOUNDONE SLR   @12,@12                                             0930 02769000
         ICM   @12,7,BUFFPTR                                       0930 02770000
         SLR   @07,@07                                             0930 02771000
         ICM   @07,7,FORWDPTR(@12)                                 0930 02772000
         MVI   RECRDNO(@07),X'00'                                  0930 02773000
*          FORWDPTR->FORWDPTR='00000000'X;/*                       0931 02774000
*                                         IND END-OF-CHAIN.           * 02775000
         SLR   @12,@12                                             0931 02776000
         STCM  @12,7,FORWDPTR(@07)                                 0931 02777000
*          GETBUFF=FORWDPTR;           /* UPDATE CURR BFR POINTER.    * 02778000
         ST    @07,GETBUFF                                         0932 02779000
*          CURBFPTR=BUFFPTR;           /* SET PT TO BEGNG OF BFR.     * 02780000
         SLR   CURBFPTR,CURBFPTR                                   0933 02781000
         ICM   CURBFPTR,7,BUFFPTR                                  0933 02782000
*          ENDBFPTR=CURBFPTR+FREELEN(TEMPTR+2:TEMPTR+4);           0934 02783000
         SLR   @12,@12                                             0934 02784000
         ICM   @12,7,TEMPTR                                        0934 02785000
         LR    @07,CURBFPTR                                        0934 02786000
         L     @12,FREELEN(@12,COMMREG)                            0934 02787000
         LA    @12,0(,@12)                                         0934 02788000
         ALR   @07,@12                                             0934 02789000
         STCM  @07,7,ENDBFPTR                                      0934 02790000
*          GO TO RECOVER1;             /* GO TO CONTINUE.             * 02791000
         B     RECOVER1                                            0935 02792000
*GETNEW:   /* CONTROL COMES HERE WHEN A NEW BUFFER MUST BE OBTAINED.  * 02793000
*          FREELNPT->HIORDBIT='0'B;    /* ERASE OLD END-OF-LIST MARKER* 02794000
GETNEW   SLR   @12,@12                                             0936 02795000
         ICM   @12,7,FREELNPT                                      0936 02796000
         NI    HIORDBIT(@12),B'01111111'                           0936 02797000
*          FREELNPT=FREELNPT+4;        /* ADD A WORD TO END OF LIST.  * 02798000
         LA    @07,4                                               0937 02799000
         ALR   @12,@07                                             0937 02800000
         STCM  @12,7,FREELNPT                                      0937 02801000
*          FREEPTR=FREEPTR+4;          /* ADD A WORD TO END OF LIST.  * 02802000
         SLR   @12,@12                                             0938 02803000
         ICM   @12,7,FREEPTR                                       0938 02804000
         ALR   @07,@12                                             0938 02805000
         STCM  @07,7,FREEPTR                                       0938 02806000
*          GETMNLO=260;                /* MINIMUM BFR AREA FOR SCAN.  * 02807000
         MVC   GETMNLO(4),@CF00296                                 0939 02808000
*          GETMNHI=4096;               /* MAXIMUM BFR AREA FOR SCAN.  * 02809000
         MVC   GETMNHI(4),@CF01350                                 0940 02810000
*          LOAMTPTR=ADDR(GETMNLO);     /* SET PT TO SIZE REQUEST.     * 02811000
         LA    @12,GETMNLO                                         0941 02812000
         ST    @12,LOAMTPTR                                        0941 02813000
*          LOCTNPTR=ADDR(GETBUFF);     /* SET PT TO ADDRESS PLACE.    * 02814000
         LA    @12,GETBUFF                                         0942 02815000
         ST    @12,LOCTNPTR                                        0942 02816000
*          TEMPTR=BUFFPTR;             /* SAVE BUFFER POINTER.        * 02817000
         MVC   TEMPTR(3),BUFFPTR                                   0943 02818000
*          SUBPOOL=1;                  /* SUBPOOL REQUEST.            * 02819000
         MVI   SUBPOOL,X'01'                                       0944 02820000
*           DO; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF( 02821000
*,GETLST) RTCD(RETCDREG)*/                                         0945 02822000
*           RESPECIFY (GPR01P,GPR15F) RESTRICTED;                  0946 02823000
*           GETLST04 = 'E0'X; /* TYPE */                           0947 02824000
         MVI   GETLST04,X'E0'                                      0947 02825000
*           GETLST03 = ADDR(GETBUFF); /* ADDR OF ADDR LIST */      0948 02826000
         LA    @14,GETBUFF                                         0948 02827000
         STCM  @14,7,GETLST03                                      0948 02828000
*           GETLST05 = SUBPOOL; /* SUBPOOL VALUE */                0949 02829000
         MVC   GETLST05(1),SUBPOOL                                 0949 02830000
*           GPR01P = ADDR(GETLST); /* REG1 POINTS TO LIST */       0950 02831000
         LA    GPR01P,GETLST                                       0950 02832000
*           SVC(4);/* STANDARD-FORM OF GETMAIN*/                   0951 02833000
         SVC   4                                                   0951 02834000
*           RETCDREG = GPR15F; /* SET RETURN CODE */               0952 02835000
*           RESPECIFY (GPR01P,GPR15F) UNRESTRICTED;                0953 02836000
*           END; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF 02837000
*E,GETLST) RTCD(RETCDREG)*/                                        0954 02838000
*          RETCODE=RETCDREG;           /* SAVE RET CODE.              * 02839000
         LR    RETCODE,RETCDREG                                    0955 02840000
*          /* CHECK IF AREA OBTAINED.                                 * 02841000
*          IF RETCODE=4 THEN           /* CORE NOT GOTTEN.            * 02842000
         LA    @07,4                                               0956 02843000
         CR    RETCODE,@07                                         0956 02844000
         BNE   @RF00956                                            0956 02845000
*            DO;                       /* RESTORE LIST.               * 02846000
*              FREELNPT=FREELNPT-4;       /* REMOVE LAST WORD.        * 02847000
         LCR   @07,@07                                             0958 02848000
         SLR   @12,@12                                             0958 02849000
         ICM   @12,7,FREELNPT                                      0958 02850000
         ALR   @07,@12                                             0958 02851000
         STCM  @07,7,FREELNPT                                      0958 02852000
*              FREELNPT->HIORDBIT='1'B; /* MARK END OF LIST.          * 02853000
         OI    HIORDBIT(@07),B'10000000'                           0959 02854000
*              RETURN TO NOCORE;       /* GO TO ISSUE MSG.            * 02855000
         LA    @14,NOCORE                                          0960 02856000
         BR    @14                                                 0960 02857000
*            END;                      /* LIST RESTORED.              * 02858000
*          ELSE;                       /* CORE GOTTEN.                * 02859000
@RF00956 DS    0H                                                  0963 02860000
*          TEMPTR->FORWDPTR=BUFFPTR;   /* ADD NEW BFR TO CHAIN.       * 02861000
         SLR   @12,@12                                             0963 02862000
         ICM   @12,7,BUFFPTR                                       0963 02863000
         SLR   @07,@07                                             0963 02864000
         ICM   @07,7,TEMPTR                                        0963 02865000
         STCM  @12,7,FORWDPTR(@07)                                 0963 02866000
*          CURBFPTR=BUFFPTR;           /* UPDATE PT TO CURR BFR.      * 02867000
         LR    CURBFPTR,@12                                        0964 02868000
*          RECRDNO=0;                  /* NO LINES IN BFR YET.        * 02869000
         MVI   RECRDNO(@12),X'00'                                  0965 02870000
*          FORWDPTR='00000000'X;       /* IND END OF CHAIN.           * 02871000
         SLR   @07,@07                                             0966 02872000
         STCM  @07,7,FORWDPTR(@12)                                 0966 02873000
*          ENDBFPTR=BUFFPTR+GETMNLEN;  /* SET PT TO END OF BFR.       * 02874000
         L     @07,GETMNLEN                                        0967 02875000
         ALR   @12,@07                                             0967 02876000
         STCM  @12,7,ENDBFPTR                                      0967 02877000
*          FREEPTR->AREA=GETBUFF;      /* ADD ADDRESS AND LNG OF NEW  * 02878000
         SLR   @12,@12                                             0968 02879000
         ICM   @12,7,FREEPTR                                       0968 02880000
         MVC   AREA(4,@12),GETBUFF                                 0968 02881000
*          FREELNPT->AREA=GETMNLEN;    /*  BFR TO LISTS.              * 02882000
         SLR   @12,@12                                             0969 02883000
         ICM   @12,7,FREELNPT                                      0969 02884000
         ST    @07,AREA(,@12)                                      0969 02885000
*          FREELNPT->HIORDBIT='1'B;    /* MARK END OF LIST.           * 02886000
         OI    HIORDBIT(@12),B'10000000'                           0970 02887000
*RECOVER1: /* CONTROL COMES HERE JUST BEFORE CONTINUING AFTER R.C. 12.* 02888000
*          RC12SW='1'B;                /* IND R.C. 12 WAS ISSUED.     * 02889000
RECOVER1 OI    RC12SW,B'10000000'                                  0971 02890000
*          RETURN;                     /* CONTINUE CHECKING.          * 02891000
@EL00008 DS    0H                                                  0972 02892000
@EF00008 DS    0H                                                  0972 02893000
@ER00008 L     @14,12(,@13)                                        0972 02894000
         BR    @14                                                 0972 02895000
*          END MOREBFRS;               /* RETURN TO CALLING POINT.    * 02896000
*READRTN:  PROC OPTIONS(NOSAVEAREA,NOSAVE);                        0974 02897000
READRTN  DS    0H                                                  0975 02898000
*          /*********************************************************** 02899000
*          /*                                                         * 02900000
*          /* THIS SUBROUTINE PERFORMS ALL THE READ OPERATIONS FROM   * 02901000
*          /* THE EDIT DATA SET.   THE IKJEBESH MACRO IS USED TO CALL * 02902000
*          /* IKJEBEUT(EDIT ACCESS METHOD INTERFACE) VIA THE SERVICE  * 02903000
*          /* ROUTINE HANDLER.  THE PARAMETER LIST PASSED TO IKJEBEUT * 02904000
*          /* IS INITIATIZED BY THE CALLER AND THE RETURN CODE FROM   * 02905000
*          /* IKJEBEUT IS SAVED IN AREA RETCODE.                      * 02906000
*          /*                                                         * 02907000
*          /*********************************************************** 02908000
*          READPTR = RETREG;           /* SAVE RETURN POINT ADDRESS   * 02909000
         LR    READPTR,RETREG                                      0975 02910000
*          GENERATE;                                               0976 02911000
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        X02912000
               MF=(E,SRPLIST)                                           02913000
*          RETCODE = RETCDREG;         /* PRESERVE RETURN CODE.       * 02914000
         LR    RETCODE,RETCDREG                                    0977 02915000
*          RETREG = READPTR;           /* RESTORE RETURN POINT ADDRESS* 02916000
         LR    RETREG,READPTR                                      0978 02917000
*          RETURN;                     /* RETURN TO CALLER            * 02918000
@EL00009 DS    0H                                                  0979 02919000
@EF00009 DS    0H                                                  0979 02920000
@ER00009 BR    @14                                                 0979 02921000
*          END READRTN;                /* END OF IKJEBEUT INVOKATION. * 02922000
*                                                                  0980 02923000
*                                                                  0980 02924000
*           DECLARE /*GENERAL PURPOSE REGISTERS */                 0981 02925000
*             GPR15F FIXED(31) REG(15),                            0981 02926000
*             GPR00P PTR(31) REG(0),                               0981 02927000
*             GPR01P PTR(31) REG(1),                               0981 02928000
*             GPR02P PTR(31) REG(2),                               0981 02929000
*             GPR03P PTR(31) REG(3),                               0981 02930000
*             GPR04P PTR(31) REG(4),                               0981 02931000
*             GPR05P PTR(31) REG(5),                               0981 02932000
*             GPR06P PTR(31) REG(6),                               0981 02933000
*             GPR07P PTR(31) REG(7),                               0981 02934000
*             GPR08P PTR(31) REG(8),                               0981 02935000
*             GPR09P PTR(31) REG(9),                               0981 02936000
*             GPR12P PTR(31) REG(12),                              0981 02937000
*             GPR13P PTR(31) REG(13),                              0981 02938000
*             GPR14P PTR(31) REG(14),                              0981 02939000
*             GPR15P PTR(31) REG(15);                              0981 02940000
*                                                                  0981 02941000
*           /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS */         0982 02942000
*             DECLARE CASAVPTR PTR(31) BASED;/*SAVE AREA PTR FOR IKJEBE 02943000
*V*/          DECLARE COMMREG REG(9) PTR(31) RSTD;/*POINTER TO EDIT COM 02944000
*O AREA*/     DECLARE DATAREG REG(10) PTR(31) RSTD;/*BASEREG FOR EDIT S 02945000
*BCOMMAND WORK AREA*/                                              0982 02946000
*             DECLARE CASAVE CHAR(72) BASED;/*SAVE AREA EDIT MODULE*/   02947000
*                                                                  0985 02948000
*           DECLARE /* COMMON VARIABLES */                         0986 02949000
*             I256C CHAR(256) BASED,                               0986 02950000
*             I031F FIXED(31) BASED,                               0986 02951000
*             I031P PTR(31)   BASED,                               0986 02952000
*             I015F FIXED(15) BASED,                               0986 02953000
*             I015P PTR(15)   BASED,                               0986 02954000
*             I008P PTR(8)    BASED,                               0986 02955000
*             I001C CHAR(1)   BASED;                               0986 02956000
*          END IKJEBESC                                            0987 02957000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02958000
*/*%INCLUDE SYSLIB  (IKJEBECA)                                        * 02959000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 02960000
*/*%INCLUDE SYSLIB  (IKJEBEMJ)                                        * 02961000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 02962000
*;                                                                 0987 02963000
@DATA    DS    0H                                                       02964000
@CH00088 DC    H'2'                                                     02965000
@CH00452 DC    H'4'                                                     02966000
@CH00138 DC    H'5'                                                     02967000
@CH01286 DC    H'9'                                                     02968000
@CH00387 DC    H'10'                                                    02969000
@CH00142 DC    H'20'                                                    02970000
@CH01204 DC    H'22'                                                    02971000
@CH01192 DC    H'23'                                                    02972000
@CH01258 DC    H'29'                                                    02973000
@CH01206 DC    H'45'                                                    02974000
@CH01311 DC    H'76'                                                    02975000
@CH01315 DC    H'128'                                                   02976000
@CH01207 DC    H'270'                                                   02977000
@CH01202 DC    H'271'                                                   02978000
@CH01312 DC    H'1280'                                                  02979000
@CH01281 DC    H'1287'                                                  02980000
@CH01235 DC    H'1288'                                                  02981000
@CH01288 DC    H'1289'                                                  02982000
@CH01303 DC    H'1290'                                                  02983000
@CH01243 DC    H'1792'                                                  02984000
@CH01194 DC    H'1796'                                                  02985000
@CH01257 DC    H'1797'                                                  02986000
@CH01238 DC    H'1801'                                                  02987000
@SM01386 MVC   RECORD(0,COMMREG),UTBUFFER+4(COMMREG)                    02988000
@SM01388 MVC   RECORD(0,COMMREG),LINE(COMMREG)                          02989000
@SM01393 MVC   0(0,@12),LINENUM(@07)                                    02990000
@SM01395 MVC   0(0,@05),LINENUM(@12)                                    02991000
@SM01397 MVC   RECRD(0,CURBFPTR),LINE(COMMREG)                          02992000
@SM01399 MVC   RECRD(0,CURBFPTR),LL(COMMREG)                            02993000
@SM01402 MVC   MSGTEXT(0,COMMREG),LINENUM(@08)                          02994000
@DATD    DSECT                                                          02995000
         DS    0F                                                       02996000
IKJEBESC CSECT                                                          02997000
         DS    0F                                                       02998000
@CF00039 DC    F'1'                                                     02999000
@CH00039 EQU   @CF00039+2                                               03000000
@CF00044 DC    F'8'                                                     03001000
@CH00044 EQU   @CF00044+2                                               03002000
@CF00151 DC    F'12'                                                    03003000
@CH00151 EQU   @CF00151+2                                               03004000
@CF00241 DC    F'16'                                                    03005000
@CH00241 EQU   @CF00241+2                                               03006000
@CF00296 DC    F'260'                                                   03007000
@CF01268 DC    F'2048'                                                  03008000
@CF01350 DC    F'4096'                                                  03009000
@CF01282 DC    XL4'7FFFFFFF'                                            03010000
@DATD    DSECT                                                          03011000
         DS    0D                                                       03012000
SNSYNBFR DS    A                                                        03013000
CHKPTR   DS    A                                                        03014000
WHOLPTR  DS    A                                                        03015000
SCRETCD  DS    F                                                        03016000
RECRDKEY DS    F                                                        03017000
TOTALINX DS    F                                                        03018000
LNUMBER1 DS    F                                                        03019000
LNUMBER2 DS    F                                                        03020000
COUNT    DS    F                                                        03021000
MSGPTR2  DS    A                                                        03022000
PARSEPTR DS    A                                                        03023000
         DS    CL1                                                      03024000
ENDBFPTR DS    AL3                                                      03025000
         DS    CL1                                                      03026000
FREEPTR  DS    AL3                                                      03027000
         DS    CL1                                                      03028000
FREELNPT DS    AL3                                                      03029000
TEMPCOD2 DS    AL1                                                      03030000
         DS    CL3                                                      03031000
GETLST   DS    CL10                                                     03032000
         ORG   GETLST                                                   03033000
GETLST01 DS    AL4                                                      03034000
GETLST02 DS    CL1                                                      03035000
GETLST03 DS    AL3                                                      03036000
GETLST04 DS    CL1                                                      03037000
GETLST05 DS    AL1                                                      03038000
         ORG   GETLST+10                                                03039000
         DS    CL2                                                      03040000
PACKAREA DS    CL8                                                      03041000
UTPLIST  DS    CL12                                                     03042000
         ORG   UTPLIST                                                  03043000
UTCODE   DS    CL1                                                      03044000
DCBPTR   DS    AL3                                                      03045000
KEYPTR   DS    AL4                                                      03046000
AREAPTR  DS    AL4                                                      03047000
         ORG   AREAPTR                                                  03048000
PLISTEND DS    BL1                                                      03049000
         ORG   UTPLIST+12                                               03050000
SRPLIST  DS    CL40                                                     03051000
         ORG   SRPLIST                                                  03052000
RELMSG1  DS    FL2                                                      03053000
RELMSG2  DS    FL2                                                      03054000
SRPLIST2 DS    CL36                                                     03055000
         ORG   SRPLIST+40                                               03056000
@NM00023 DS    CL8                                                      03057000
         ORG   @NM00023                                                 03058000
GETMNLO  DS    FL4                                                      03059000
GETMNHI  DS    FL4                                                      03060000
         ORG   @NM00023+8                                               03061000
@NM00024 DS    CL8                                                      03062000
         ORG   @NM00024                                                 03063000
GETBUFF  DS    AL4                                                      03064000
         ORG   GETBUFF                                                  03065000
BUFFBYTE DS    CL1                                                      03066000
BUFFPTR  DS    AL3                                                      03067000
         ORG   @NM00024+4                                               03068000
GETMNLEN DS    FL4                                                      03069000
         ORG   @NM00024+8                                               03070000
GETMNLST DS    CL10                                                     03071000
         ORG   GETMNLST                                                 03072000
LOAMTPTR DS    AL4                                                      03073000
LOCTNPTR DS    AL4                                                      03074000
GETMNCD  DS    CL1                                                      03075000
SUBPOOL  DS    AL1                                                      03076000
         ORG   GETMNLST+10                                              03077000
         DS    CL2                                                      03078000
TEMPWORD DS    CL4                                                      03079000
         ORG   TEMPWORD                                                 03080000
TEMPBYTE DS    CL1                                                      03081000
TEMPTR   DS    AL3                                                      03082000
         ORG   TEMPWORD+4                                               03083000
@NM00025 DS    CL1                                                      03084000
         ORG   @NM00025                                                 03085000
RC12SW   DS    BL1                                                      03086000
ENDSW    EQU   @NM00025+0                                               03087000
         ORG   @NM00025+1                                               03088000
MSGTEXT2 DS    CL4                                                      03089000
         DS    CL3                                                      03090000
XCTLLIST DS    CL8                                                      03091000
IKJEBESC CSECT                                                          03092000
         NOPR  ((@ENDDATD-@DATD)/673*16)                                03093000
         DS    0F                                                       03094000
@SIZDATD DC    AL1(0)                                                   03095000
         DC    AL3(@ENDDATD-@DATD)                                      03096000
@CV00525 DC    V(IKJEBSC1)                                              03097000
         DS    0D                                                       03098000
@CC01285 DC    C'00000000'                                              03099000
@CC01203 DC    C'PARSE'                                                 03100000
@CC01193 DC    C'SCAN'                                                  03101000
@CC01205 DC    C'12'                                                    03102000
@CB01218 DC    X'FFFFFFFFFFFFFFFF'                                      03103000
@CB01255 DC    X'0000000000000000'                                      03104000
@CB01340 EQU   @CB01255                                                 03105000
SCPARSNM DC    CL8'IKJPARS '                                            03106000
IKJEBESC CSECT                                                          03107000
IKJEBSC1 IKJPARM                                                        03108000
LINENUMB IKJIDENT 'LINE NUMBER',ASTERISK,MAXLNTH=8,FIRST=NUMERIC,      X03109000
               OTHER=NUMERIC                                            03110000
LINECT   IKJIDENT 'LINE NUMBER OR COUNT',MAXLNTH=8,FIRST=NUMERIC,      X03111000
               OTHER=NUMERIC                                            03112000
KEYWORD  IKJKEYWD                                                       03113000
         IKJNAME 'ON'                                                   03114000
         IKJNAME 'OFF'                                                  03115000
         IKJENDP                                                        03116000
@DATD    DSECT                                                          03117000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03118000
@ENDDATD EQU   *                                                        03119000
IKJEBESC CSECT                                                          03120000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03121000
@01      EQU   01                                                       03122000
@02      EQU   02                                                       03123000
@03      EQU   03                                                       03124000
@04      EQU   04                                                       03125000
@05      EQU   05                                                       03126000
@06      EQU   06                                                       03127000
@07      EQU   07                                                       03128000
@08      EQU   08                                                       03129000
@09      EQU   09                                                       03130000
@10      EQU   10                                                       03131000
@11      EQU   11                                                       03132000
@12      EQU   12                                                       03133000
@13      EQU   13                                                       03134000
@14      EQU   14                                                       03135000
@15      EQU   15                                                       03136000
MSGOFF2  EQU   @05                                                      03137000
MSGLEN2  EQU   @05                                                      03138000
TOTALINE EQU   @08                                                      03139000
RETCODE  EQU   @12                                                      03140000
SENDPTR  EQU   @12                                                      03141000
READPTR  EQU   @03                                                      03142000
LKLIBPTR EQU   @08                                                      03143000
PPLPTR   EQU   @05                                                      03144000
CURBFPTR EQU   @02                                                      03145000
I        EQU   @05                                                      03146000
BASEREG2 EQU   @06                                                      03147000
PARMREG0 EQU   @00                                                      03148000
PARMREG1 EQU   @01                                                      03149000
BINRYREG EQU   @04                                                      03150000
BASEREG  EQU   @11                                                      03151000
LEV1INS  EQU   @02                                                      03152000
LEV2INS  EQU   @03                                                      03153000
RETREG   EQU   @14                                                      03154000
RETCDREG EQU   @15                                                      03155000
COMMREG  EQU   @09                                                      03156000
GPR13P   EQU   @13                                                      03157000
GPR15P   EQU   @15                                                      03158000
DATAREG  EQU   @10                                                      03159000
GPR01P   EQU   @01                                                      03160000
GPR12P   EQU   @12                                                      03161000
GPR15F   EQU   @15                                                      03162000
GPR00P   EQU   @00                                                      03163000
GPR02P   EQU   @02                                                      03164000
GPR03P   EQU   @03                                                      03165000
GPR04P   EQU   @04                                                      03166000
GPR05P   EQU   @05                                                      03167000
GPR06P   EQU   @06                                                      03168000
GPR07P   EQU   @07                                                      03169000
GPR08P   EQU   @08                                                      03170000
GPR09P   EQU   @09                                                      03171000
GPR14P   EQU   @14                                                      03172000
SAVEREG  EQU   @13                                                      03173000
CVTPTR   EQU   16                                                       03174000
IKJEBECA EQU   0                                                        03175000
CAPTPRSD EQU   IKJEBECA+36                                              03176000
CAPRSPDL EQU   CAPTPRSD                                                 03177000
CAFREEDL EQU   CAPRSPDL                                                 03178000
CAPTIBFR EQU   IKJEBECA+40                                              03179000
CAOPERND EQU   CAPTIBFR                                                 03180000
CAPTSCMD EQU   IKJEBECA+44                                              03181000
CASCMDLN EQU   IKJEBECA+48                                              03182000
CAPTCDCB EQU   IKJEBECA+52                                              03183000
CAPTCHK  EQU   IKJEBECA+72                                              03184000
CAATTN   EQU   IKJEBECA+120                                             03185000
CAATTNIS EQU   CAATTN                                                   03186000
CACFLAG  EQU   IKJEBECA+124                                             03187000
CACFLAG1 EQU   CACFLAG                                                  03188000
CALNTOVF EQU   CACFLAG1                                                 03189000
CAVRFYSW EQU   CACFLAG1                                                 03190000
CAPROMPT EQU   CACFLAG1                                                 03191000
CASCANSW EQU   CACFLAG1                                                 03192000
CAINITSC EQU   CACFLAG1                                                 03193000
CAENDSC  EQU   CACFLAG1                                                 03194000
CANONUM  EQU   CACFLAG1                                                 03195000
CACFLAG2 EQU   CACFLAG+1                                                03196000
CARECFM  EQU   CACFLAG2                                                 03197000
CASCANON EQU   CACFLAG2                                                 03198000
CACFLAG3 EQU   CACFLAG+2                                                03199000
CAIMFLG  EQU   CACFLAG3                                                 03200000
CACFLAG4 EQU   CACFLAG+3                                                03201000
CASCRC20 EQU   CACFLAG4                                                 03202000
CAINPROC EQU   CACFLAG4                                                 03203000
CACFLAG5 EQU   CACFLAG+4                                                03204000
CACFLAG6 EQU   CACFLAG+5                                                03205000
CAFREE   EQU   CACFLAG6                                                 03206000
CACHAR48 EQU   CACFLAG6                                                 03207000
CAPD     EQU   IKJEBECA+152                                             03208000
CADSTYPE EQU   CAPD                                                     03209000
CASYNAME EQU   CAPD+32                                                  03210000
CADSCODE EQU   CAPD+40                                                  03211000
CADSATTR EQU   CAPD+41                                                  03212000
CASCAN   EQU   CADSATTR                                                 03213000
CADSATR2 EQU   CAPD+42                                                  03214000
CACHKOPT EQU   CAPD+56                                                  03215000
CAPTPDXT EQU   IKJEBECA+228                                             03216000
CALRECL  EQU   IKJEBECA+232                                             03217000
CAEDFLAG EQU   IKJEBECA+236                                             03218000
CAEDFLG2 EQU   IKJEBECA+237                                             03219000
CASAFLAG EQU   IKJEBECA+376                                             03220000
CASAFLG2 EQU   IKJEBECA+377                                             03221000
CACURNUM EQU   IKJEBECA+456                                             03222000
CASYNLST EQU   IKJEBECA+496                                             03223000
CASYNBFR EQU   CASYNLST                                                 03224000
CASYNPWA EQU   CASYNLST+4                                               03225000
CASYNPTO EQU   CASYNLST+8                                               03226000
CASYNWA  EQU   IKJEBECA+508                                             03227000
CASYNMS1 EQU   CASYNWA+4                                                03228000
CASYNMS2 EQU   CASYNWA+8                                                03229000
CASYNOPT EQU   IKJEBECA+524                                             03230000
CASYNSW  EQU   CASYNOPT+3                                               03231000
CATMPLST EQU   IKJEBECA+528                                             03232000
CAMAWKA  EQU   IKJEBECA+596                                             03233000
MACFLAGS EQU   CAMAWKA+28                                               03234000
MACFLAG2 EQU   CAMAWKA+29                                               03235000
CAMODEMG EQU   IKJEBECA+928                                             03236000
CASCWKA  EQU   IKJEBECA+1448                                            03237000
CABFRPL  EQU   IKJEBECA+2120                                            03238000
CATEMPBF EQU   IKJEBECA+2648                                            03239000
CANXTSVA EQU   IKJEBECA+3896                                            03240000
IKJEBECX EQU   0                                                        03241000
PARSEPDL EQU   0                                                        03242000
@NM00028 EQU   PARSEPDL+8                                               03243000
LNSTART  EQU   @NM00028                                                 03244000
LNSTARTL EQU   @NM00028+4                                               03245000
@NM00029 EQU   @NM00028+6                                               03246000
@NM00031 EQU   PARSEPDL+16                                              03247000
LNEND    EQU   @NM00031                                                 03248000
LNENDL   EQU   @NM00031+4                                               03249000
@NM00032 EQU   @NM00031+6                                               03250000
LNENDF   EQU   @NM00032                                                 03251000
@NM00034 EQU   PARSEPDL+24                                              03252000
KEYWD    EQU   @NM00034                                                 03253000
LINENUM  EQU   0                                                        03254000
AREA     EQU   0                                                        03255000
HIORDBIT EQU   AREA                                                     03256000
ERRORMSG EQU   0                                                        03257000
FIRSTBFR EQU   0                                                        03258000
RECRDNO  EQU   FIRSTBFR                                                 03259000
FREEBIT  EQU   RECRDNO                                                  03260000
FORWDPTR EQU   FIRSTBFR+1                                               03261000
RECRD    EQU   FIRSTBFR+4                                               03262000
CHECKER  EQU   0                                                        03263000
PPL      EQU   0                                                        03264000
PPLPCL   EQU   PPL+12                                                   03265000
PPLANS   EQU   PPL+16                                                   03266000
PPLCBUF  EQU   PPL+20                                                   03267000
PPLUWA   EQU   PPL+24                                                   03268000
CVTMAP   EQU   0                                                        03269000
CVTDAR   EQU   CVTMAP+72                                                03270000
CVTFLGS1 EQU   CVTDAR                                                   03271000
CVTDCB   EQU   CVTMAP+116                                               03272000
CVTIERLC EQU   CVTMAP+144                                               03273000
CVTOPTA  EQU   CVTMAP+182                                               03274000
CVTOPTB  EQU   CVTMAP+183                                               03275000
CVTGTF   EQU   CVTMAP+236                                               03276000
CVTGTFST EQU   CVTGTF                                                   03277000
CVTGTFS  EQU   CVTGTFST                                                 03278000
CVTSTATE EQU   CVTGTFST                                                 03279000
CVTTMODE EQU   CVTGTFST                                                 03280000
CVTFORM  EQU   CVTGTFST                                                 03281000
CVTAQAVT EQU   CVTMAP+240                                               03282000
CVTTCMFG EQU   CVTAQAVT                                                 03283000
CVTVOLM2 EQU   CVTMAP+244                                               03284000
CVTTATA  EQU   CVTVOLM2                                                 03285000
CVTTSKS  EQU   CVTTATA                                                  03286000
CVTVOLF2 EQU   CVTTSKS                                                  03287000
CVTTAT   EQU   CVTTATA+1                                                03288000
CVTATER  EQU   CVTMAP+248                                               03289000
CVTEXT1  EQU   CVTMAP+252                                               03290000
CVTPURG  EQU   CVTMAP+260                                               03291000
CVTQMSG  EQU   CVTMAP+268                                               03292000
CVTDMSR  EQU   CVTMAP+272                                               03293000
CVTERPV  EQU   CVTMAP+316                                               03294000
CVTINTLA EQU   CVTMAP+320                                               03295000
CVTAPF   EQU   CVTMAP+324                                               03296000
CVTEXT2  EQU   CVTMAP+328                                               03297000
CVTHJES  EQU   CVTMAP+332                                               03298000
CVTPGSIA EQU   CVTMAP+348                                               03299000
CVTA1F1  EQU   CVTMAP+356                                               03300000
CVTSYSK  EQU   CVTMAP+357                                               03301000
CVTVOLM1 EQU   CVTMAP+380                                               03302000
CVTVOLF1 EQU   CVTVOLM1                                                 03303000
CVTATMCT EQU   CVTMAP+388                                               03304000
CVTXTNT1 EQU   0                                                        03305000
CVTXTNT2 EQU   0                                                        03306000
CVTDSSV  EQU   CVTXTNT2                                                 03307000
CVTFLGBT EQU   CVTXTNT2+5                                               03308000
CVTQID   EQU   CVTXTNT2+24                                              03309000
CVTRV400 EQU   CVTXTNT2+52                                              03310000
CVTRV409 EQU   CVTXTNT2+53                                              03311000
CVTATCVT EQU   CVTXTNT2+64                                              03312000
CVTRV429 EQU   CVTXTNT2+84                                              03313000
CVTRV438 EQU   CVTXTNT2+85                                              03314000
CVTRV457 EQU   CVTXTNT2+112                                             03315000
CVTRV466 EQU   CVTXTNT2+113                                             03316000
CVTFIX   EQU   0                                                        03317000
CVTRELNO EQU   CVTFIX+252                                               03318000
CASAVPTR EQU   0                                                        03319000
CASAVE   EQU   0                                                        03320000
DSNAME   EQU   0                                                        03321000
I001C    EQU   0                                                        03322000
I008P    EQU   0                                                        03323000
I015F    EQU   0                                                        03324000
I015P    EQU   0                                                        03325000
I031F    EQU   0                                                        03326000
I031P    EQU   0                                                        03327000
I256C    EQU   0                                                        03328000
BYTE     EQU   CASYNPTO                                                 03329000
CHKWORKA EQU   CASYNWA                                                  03330000
@NM00035 EQU   CHKWORKA                                                 03331000
ENTRYCD  EQU   @NM00035                                                 03332000
FIRSTENT EQU   ENTRYCD                                                  03333000
CONTCHK  EQU   ENTRYCD                                                  03334000
LASTENT  EQU   ENTRYCD                                                  03335000
INCOMPST EQU   ENTRYCD                                                  03336000
SYNMSG1  EQU   CHKWORKA+4                                               03337000
SYNMSG2  EQU   CHKWORKA+8                                               03338000
OPTIONWD EQU   CASYNOPT                                                 03339000
CODE1AN2 EQU   OPTIONWD                                                 03340000
INPUTCD  EQU   CODE1AN2+1                                               03341000
RECORDLN EQU   OPTIONWD+2                                               03342000
SWITCHES EQU   OPTIONWD+3                                               03343000
CHAR4860 EQU   SWITCHES                                                 03344000
LNUM     EQU   SWITCHES                                                 03345000
INCOMP   EQU   SWITCHES                                                 03346000
RECLN    EQU   SWITCHES                                                 03347000
RECFORM  EQU   SWITCHES                                                 03348000
MSGLN    EQU   SWITCHES                                                 03349000
SCANOPT  EQU   SWITCHES                                                 03350000
MRGCODE  EQU   INPUTCD                                                  03351000
CODE2    EQU   MRGCODE                                                  03352000
BUFFAREA EQU   CABFRPL                                                  03353000
UTBUFFER EQU   BUFFAREA                                                 03354000
KEY      EQU   UTBUFFER                                                 03355000
LL       EQU   UTBUFFER+4                                               03356000
LINE     EQU   UTBUFFER+8                                               03357000
SYNBUFFR EQU   BUFFAREA+264                                             03358000
RECNO    EQU   SYNBUFFR                                                 03359000
CHAINPTR EQU   SYNBUFFR+1                                               03360000
RECORD   EQU   SYNBUFFR+4                                               03361000
FREEAREA EQU   BUFFAREA+524                                             03362000
FREELEN  EQU   BUFFAREA+624                                             03363000
MSGAREA  EQU   SYNBUFFR                                                 03364000
MSGPTR   EQU   MSGAREA                                                  03365000
MSGLEN   EQU   MSGAREA+4                                                03366000
MSGOFF   EQU   MSGAREA+6                                                03367000
MSGTEXT  EQU   MSGAREA+8                                                03368000
LEV2MSG  EQU   MSGAREA+84                                               03369000
LEV2PTR  EQU   LEV2MSG                                                  03370000
LEV2LEN  EQU   LEV2MSG+4                                                03371000
LEV2OFF  EQU   LEV2MSG+6                                                03372000
LEV2TEXT EQU   LEV2MSG+8                                                03373000
CVTS01   EQU   CVTPGSIA                                                 03374000
CVTLPDIA EQU   CVTS01+12                                                03375000
CVTDIRST EQU   CVTLPDIA                                                 03376000
CVTSLIDA EQU   CVTS01+24                                                03377000
CVTCTLFG EQU   CVTS01+50                                                03378000
CVTPARS  EQU   CVTS01+176                                               03379000
CVTRV210 EQU   CVTS01+424                                               03380000
CVTRV219 EQU   CVTS01+425                                               03381000
CVTRV228 EQU   CVTS01+426                                               03382000
CVTRV237 EQU   CVTS01+427                                               03383000
CVTMFRTR EQU   CVTS01+452                                               03384000
CVTRV262 EQU   CVTS01+468                                               03385000
CVTRV271 EQU   CVTS01+469                                               03386000
CVTRV280 EQU   CVTS01+470                                               03387000
CVTRV289 EQU   CVTS01+471                                               03388000
CVTGSDA  EQU   CVTS01+600                                               03389000
*                                      START UNREFERENCED COMPONENTS    03390000
CVTRV628 EQU   CVTS01+728                                               03391000
CVTRV627 EQU   CVTS01+724                                               03392000
CVTRV626 EQU   CVTS01+720                                               03393000
CVTRV625 EQU   CVTS01+716                                               03394000
CVTRV624 EQU   CVTS01+712                                               03395000
CVTRV623 EQU   CVTS01+708                                               03396000
CVTRV622 EQU   CVTS01+704                                               03397000
CVTRV621 EQU   CVTS01+700                                               03398000
CVTRV620 EQU   CVTS01+696                                               03399000
CVTRV619 EQU   CVTS01+692                                               03400000
CVTRV618 EQU   CVTS01+688                                               03401000
CVTRV617 EQU   CVTS01+684                                               03402000
CVTRV616 EQU   CVTS01+680                                               03403000
CVTRV615 EQU   CVTS01+676                                               03404000
CVTRV614 EQU   CVTS01+672                                               03405000
CVTRV613 EQU   CVTS01+668                                               03406000
CVTRV612 EQU   CVTS01+664                                               03407000
CVTRV611 EQU   CVTS01+660                                               03408000
CVTRV610 EQU   CVTS01+656                                               03409000
CVTRV609 EQU   CVTS01+652                                               03410000
CVTRV608 EQU   CVTS01+648                                               03411000
CVTRV607 EQU   CVTS01+644                                               03412000
CVTRV606 EQU   CVTS01+640                                               03413000
CVTRV605 EQU   CVTS01+636                                               03414000
CVTRV604 EQU   CVTS01+632                                               03415000
CVTRV603 EQU   CVTS01+628                                               03416000
CVTRV602 EQU   CVTS01+624                                               03417000
CVTSSCR  EQU   CVTS01+620                                               03418000
CVTEVENT EQU   CVTS01+616                                               03419000
CVTCRCA  EQU   CVTS01+612                                               03420000
CVTTPIO  EQU   CVTS01+608                                               03421000
CVTADV   EQU   CVTS01+604                                               03422000
CVTGSDAB EQU   CVTGSDA                                                  03423000
CVTQV3   EQU   CVTS01+596                                               03424000
CVTQV2   EQU   CVTS01+592                                               03425000
CVTQV1   EQU   CVTS01+588                                               03426000
CVTRPT   EQU   CVTS01+584                                               03427000
CVTSSRB  EQU   CVTS01+580                                               03428000
CVTCSDRL EQU   CVTS01+576                                               03429000
CVTEXP1  EQU   CVTS01+572                                               03430000
CVTRMPMT EQU   CVTS01+568                                               03431000
CVTRMPTT EQU   CVTS01+564                                               03432000
CVTVPSA  EQU   CVTS01+560                                               03433000
CVTVSTOP EQU   CVTS01+556                                               03434000
CVTGTFR8 EQU   CVTS01+552                                               03435000
CVTQUIT  EQU   CVTS01+548                                               03436000
CVTVACR  EQU   CVTS01+544                                               03437000
CVTWTCB  EQU   CVTS01+540                                               03438000
CVTSTPRS EQU   CVTS01+536                                               03439000
CVT0PT02 EQU   CVTS01+532                                               03440000
CVTDARCM EQU   CVTS01+528                                               03441000
CVTIRECM EQU   CVTS01+524                                               03442000
CVTJRECM EQU   CVTS01+520                                               03443000
CVTVEMS0 EQU   CVTS01+516                                               03444000
CVTSPFRR EQU   CVTS01+512                                               03445000
CVTRLSTG EQU   CVTS01+508                                               03446000
CVT0TC0A EQU   CVTS01+504                                               03447000
CVTGMBR  EQU   CVTS01+500                                               03448000
CVTLFRM  EQU   CVTS01+496                                               03449000
CVTRMBR  EQU   CVTS01+492                                               03450000
CVTVIOP  EQU   CVTS01+488                                               03451000
CVTRV307 EQU   CVTS01+486                                               03452000
CVTRV306 EQU   CVTS01+484                                               03453000
CVTRV305 EQU   CVTS01+482                                               03454000
CVTRV304 EQU   CVTS01+480                                               03455000
CVTRV303 EQU   CVTS01+478                                               03456000
CVTRV302 EQU   CVTS01+476                                               03457000
CVTRV301 EQU   CVTS01+475                                               03458000
CVTRV300 EQU   CVTS01+474                                               03459000
CVTRV299 EQU   CVTS01+473                                               03460000
CVTRV298 EQU   CVTS01+472                                               03461000
CVTRV297 EQU   CVTRV289                                                 03462000
CVTRV296 EQU   CVTRV289                                                 03463000
CVTRV295 EQU   CVTRV289                                                 03464000
CVTRV294 EQU   CVTRV289                                                 03465000
CVTRV293 EQU   CVTRV289                                                 03466000
CVTRV292 EQU   CVTRV289                                                 03467000
CVTRV291 EQU   CVTRV289                                                 03468000
CVTRV290 EQU   CVTRV289                                                 03469000
CVTRV288 EQU   CVTRV280                                                 03470000
CVTRV287 EQU   CVTRV280                                                 03471000
CVTRV286 EQU   CVTRV280                                                 03472000
CVTRV285 EQU   CVTRV280                                                 03473000
CVTRV284 EQU   CVTRV280                                                 03474000
CVTRV283 EQU   CVTRV280                                                 03475000
CVTRV282 EQU   CVTRV280                                                 03476000
CVTRV281 EQU   CVTRV280                                                 03477000
CVTRV279 EQU   CVTRV271                                                 03478000
CVTRV278 EQU   CVTRV271                                                 03479000
CVTRV277 EQU   CVTRV271                                                 03480000
CVTRV276 EQU   CVTRV271                                                 03481000
CVTRV275 EQU   CVTRV271                                                 03482000
CVTRV274 EQU   CVTRV271                                                 03483000
CVTRV273 EQU   CVTRV271                                                 03484000
CVTRV272 EQU   CVTRV271                                                 03485000
CVTRV270 EQU   CVTRV262                                                 03486000
CVTRV269 EQU   CVTRV262                                                 03487000
CVTRV268 EQU   CVTRV262                                                 03488000
CVTRV267 EQU   CVTRV262                                                 03489000
CVTRV266 EQU   CVTRV262                                                 03490000
CVTRV265 EQU   CVTRV262                                                 03491000
CVTRV264 EQU   CVTRV262                                                 03492000
CVTRV263 EQU   CVTRV262                                                 03493000
CVTVFP   EQU   CVTS01+464                                               03494000
CVTVSI   EQU   CVTS01+460                                               03495000
CVTVPSIB EQU   CVTS01+456                                               03496000
CVTMFACT EQU   CVTMFRTR                                                 03497000
CVTMFCTL EQU   CVTS01+448                                               03498000
CVTPVBP  EQU   CVTS01+444                                               03499000
CVTPWI   EQU   CVTS01+440                                               03500000
CVTRV254 EQU   CVTS01+438                                               03501000
CVTRV253 EQU   CVTS01+436                                               03502000
CVTRV252 EQU   CVTS01+434                                               03503000
CVTRV251 EQU   CVTS01+433                                               03504000
CVTRV250 EQU   CVTS01+432                                               03505000
CVTRV249 EQU   CVTS01+431                                               03506000
CVTRV248 EQU   CVTS01+430                                               03507000
CVTRV247 EQU   CVTS01+429                                               03508000
CVTRV246 EQU   CVTS01+428                                               03509000
CVTRV245 EQU   CVTRV237                                                 03510000
CVTRV244 EQU   CVTRV237                                                 03511000
CVTRV243 EQU   CVTRV237                                                 03512000
CVTRV242 EQU   CVTRV237                                                 03513000
CVTRV241 EQU   CVTRV237                                                 03514000
CVTRV240 EQU   CVTRV237                                                 03515000
CVTRV239 EQU   CVTRV237                                                 03516000
CVTRV238 EQU   CVTRV237                                                 03517000
CVTRV236 EQU   CVTRV228                                                 03518000
CVTRV235 EQU   CVTRV228                                                 03519000
CVTRV234 EQU   CVTRV228                                                 03520000
CVTRV233 EQU   CVTRV228                                                 03521000
CVTRV232 EQU   CVTRV228                                                 03522000
CVTRV231 EQU   CVTRV228                                                 03523000
CVTRV230 EQU   CVTRV228                                                 03524000
CVTRV229 EQU   CVTRV228                                                 03525000
CVTRV227 EQU   CVTRV219                                                 03526000
CVTRV226 EQU   CVTRV219                                                 03527000
CVTRV225 EQU   CVTRV219                                                 03528000
CVTRV224 EQU   CVTRV219                                                 03529000
CVTRV223 EQU   CVTRV219                                                 03530000
CVTRV222 EQU   CVTRV219                                                 03531000
CVTRV221 EQU   CVTRV219                                                 03532000
CVTRV220 EQU   CVTRV219                                                 03533000
CVTRV218 EQU   CVTRV210                                                 03534000
CVTRV217 EQU   CVTRV210                                                 03535000
CVTRV216 EQU   CVTRV210                                                 03536000
CVTRV215 EQU   CVTRV210                                                 03537000
CVTRV214 EQU   CVTRV210                                                 03538000
CVTRV213 EQU   CVTRV210                                                 03539000
CVTRV212 EQU   CVTRV210                                                 03540000
CVTRV211 EQU   CVTRV210                                                 03541000
CVTLCCAT EQU   CVTS01+420                                               03542000
CVTPCCAT EQU   CVTS01+416                                               03543000
CVTIPCRP EQU   CVTS01+412                                               03544000
CVTIPCRI EQU   CVTS01+408                                               03545000
CVTIPCDS EQU   CVTS01+404                                               03546000
CVTAIDVT EQU   CVTS01+400                                               03547000
CVTSSAP  EQU   CVTS01+396                                               03548000
CVTEHCIR EQU   CVTS01+392                                               03549000
CVTEHDEF EQU   CVTS01+388                                               03550000
CVTDAIR  EQU   CVTS01+384                                               03551000
CVTPERFM EQU   CVTS01+380                                               03552000
CVT044R2 EQU   CVTS01+376                                               03553000
CVTFETCH EQU   CVTS01+372                                               03554000
CVTRSTWD EQU   CVTS01+368                                               03555000
CVTSPOST EQU   CVTS01+364                                               03556000
CVTIOBP  EQU   CVTS01+360                                               03557000
CVTASMVT EQU   CVTS01+356                                               03558000
CVTRECRQ EQU   CVTS01+352                                               03559000
CVTWSAC  EQU   CVTS01+348                                               03560000
CVTRV149 EQU   CVTS01+344                                               03561000
CVTWSAL  EQU   CVTS01+340                                               03562000
CVTSPSA  EQU   CVTS01+336                                               03563000
CVTGLMN  EQU   CVTS01+332                                               03564000
CVTVEAC0 EQU   CVTS01+328                                               03565000
CVT062R1 EQU   CVTS01+324                                               03566000
CVTRPOST EQU   CVTS01+320                                               03567000
CVTDQIQE EQU   CVTS01+316                                               03568000
CVTCSD   EQU   CVTS01+312                                               03569000
CVTLKRMA EQU   CVTS01+308                                               03570000
CVTRSPIE EQU   CVTS01+304                                               03571000
CVTRENQ  EQU   CVTS01+300                                               03572000
CVTLQCB  EQU   CVTS01+296                                               03573000
CVTFQCB  EQU   CVTS01+292                                               03574000
CVTQCS01 EQU   CVTS01+288                                               03575000
CVTAPFT  EQU   CVTS01+284                                               03576000
CVTPARRL EQU   CVTS01+280                                               03577000
CVTVWAIT EQU   CVTS01+276                                               03578000
CVTGSPL  EQU   CVTS01+272                                               03579000
CVTLSMQ  EQU   CVTS01+268                                               03580000
CVTGSMQ  EQU   CVTS01+264                                               03581000
CVTEXPRO EQU   CVTS01+260                                               03582000
CVTOPCTP EQU   CVTS01+256                                               03583000
CVTSIC   EQU   CVTS01+252                                               03584000
CVTTPIOS EQU   CVTS01+248                                               03585000
CVTRTMS  EQU   CVTS01+244                                               03586000
CVTSDBF  EQU   CVTS01+240                                               03587000
CVTSCBP  EQU   CVTS01+236                                               03588000
CVTSDMP  EQU   CVTS01+232                                               03589000
CVTSV60  EQU   CVTS01+228                                               03590000
CVTRTMCT EQU   CVTS01+224                                               03591000
CVTASCBL EQU   CVTS01+220                                               03592000
CVTASCBH EQU   CVTS01+216                                               03593000
CVTGDA   EQU   CVTS01+212                                               03594000
CVTASVT  EQU   CVTS01+208                                               03595000
CVTVVMDI EQU   CVTS01+204                                               03596000
CVTAQTOP EQU   CVTS01+200                                               03597000
CVTIOSCS EQU   CVTS01+196                                               03598000
CVTSDRM  EQU   CVTS01+192                                               03599000
CVTOPTE  EQU   CVTS01+188                                               03600000
CVTSTXU  EQU   CVTS01+184                                               03601000
CVTQUIS  EQU   CVTS01+180                                               03602000
CVTS1EE  EQU   CVTS01+172                                               03603000
CVTFRAS  EQU   CVTS01+168                                               03604000
CVTQSAS  EQU   CVTS01+164                                               03605000
CVTCRAS  EQU   CVTS01+160                                               03606000
CVTCRMN  EQU   CVTS01+156                                               03607000
CVTDELCP EQU   CVTS01+152                                               03608000
CVTFRECL EQU   CVTS01+148                                               03609000
CVTGETCL EQU   CVTS01+144                                               03610000
CVTBLDCP EQU   CVTS01+140                                               03611000
CVTAUTHL EQU   CVTS01+136                                               03612000
CVTSCAN  EQU   CVTS01+132                                               03613000
CVTRV144 EQU   CVTS01+130                                               03614000
CVTMAXMP EQU   CVTS01+128                                               03615000
CVTSTCK  EQU   CVTS01+124                                               03616000
CVTRV139 EQU   CVTS01+123                                               03617000
CVTDSSAC EQU   CVTS01+122                                               03618000
CVTRV513 EQU   CVTS01+121                                               03619000
CVTIOSPL EQU   CVTS01+120                                               03620000
CVTPTGT  EQU   CVTS01+116                                               03621000
CVTCSPIE EQU   CVTS01+112                                               03622000
CVTSMFEX EQU   CVTS01+108                                               03623000
CVTOLT0A EQU   CVTS01+104                                               03624000
CVTSRBRT EQU   CVTS01+100                                               03625000
CVTPUTL  EQU   CVTS01+96                                                03626000
CVTRV519 EQU   CVTS01+92                                                03627000
CVTRV327 EQU   CVTS01+88                                                03628000
CVTRV326 EQU   CVTS01+84                                                03629000
CVTRV325 EQU   CVTS01+80                                                03630000
CVTRV324 EQU   CVTS01+76                                                03631000
CVT0VL01 EQU   CVTS01+72                                                03632000
CVTSHRVM EQU   CVTS01+68                                                03633000
CVTRV332 EQU   CVTS01+64                                                03634000
CVTTAS   EQU   CVTS01+60                                                03635000
CVTRSCN  EQU   CVTS01+56                                                03636000
CVTTRAC2 EQU   CVTS01+54                                                03637000
CVTTRACE EQU   CVTS01+52                                                03638000
CVTAPG   EQU   CVTS01+51                                                03639000
CVTSDTRC EQU   CVTCTLFG                                                 03640000
CVTGTRCE EQU   CVTCTLFG                                                 03641000
CVTNOMP  EQU   CVTCTLFG                                                 03642000
CVTRSV79 EQU   CVTCTLFG                                                 03643000
CVTDSTAT EQU   CVTCTLFG                                                 03644000
CVTRSV78 EQU   CVTCTLFG                                                 03645000
CVTRV333 EQU   CVTCTLFG                                                 03646000
CVTRV323 EQU   CVTCTLFG                                                 03647000
CVTSPVLK EQU   CVTS01+49                                                03648000
CVTRSV77 EQU   CVTS01+48                                                03649000
CVTRV331 EQU   CVTS01+44                                                03650000
CVTRV330 EQU   CVTS01+40                                                03651000
CVTRV329 EQU   CVTS01+36                                                03652000
CVTRV328 EQU   CVTS01+32                                                03653000
CVTRV322 EQU   CVTS01+28                                                03654000
CVTSLID  EQU   CVTSLIDA+1                                               03655000
CVTSYLK  EQU   CVTSLIDA                                                 03656000
CVTRV321 EQU   CVTS01+20                                                03657000
CVTRV320 EQU   CVTS01+16                                                03658000
CVTLPDIR EQU   CVTLPDIA+1                                               03659000
CVTRSV69 EQU   CVTDIRST                                                 03660000
CVTRSV68 EQU   CVTDIRST                                                 03661000
CVTRSV67 EQU   CVTDIRST                                                 03662000
CVTRSV66 EQU   CVTDIRST                                                 03663000
CVTRSV65 EQU   CVTDIRST                                                 03664000
CVTRSV64 EQU   CVTDIRST                                                 03665000
CVTRSV63 EQU   CVTDIRST                                                 03666000
CVTDICOM EQU   CVTDIRST                                                 03667000
CVTPVTP  EQU   CVTS01+8                                                 03668000
CVTLPDSR EQU   CVTS01+4                                                 03669000
CVTGETL  EQU   CVTS01                                                   03670000
@NM00043 EQU   BUFFAREA+523                                             03671000
DATA     EQU   RECORD+4                                                 03672000
OFFST    EQU   RECORD+2                                                 03673000
LNGTH    EQU   RECORD                                                   03674000
@NM00042 EQU   BUFFAREA+263                                             03675000
OFFSET   EQU   UTBUFFER+6                                               03676000
@NM00041 EQU   SWITCHES                                                 03677000
@NM00040 EQU   CODE1AN2+1                                               03678000
RUNCD    EQU   CODE1AN2+1                                               03679000
RENUMCB  EQU   CODE1AN2+1                                               03680000
@NM00039 EQU   CODE1AN2+1                                               03681000
DELTCD   EQU   CODE1AN2+1                                               03682000
CODE1    EQU   CODE1AN2                                                 03683000
@NM00038 EQU   CHKWORKA+12                                              03684000
@NM00037 EQU   @NM00035+1                                               03685000
@NM00036 EQU   ENTRYCD                                                  03686000
CVTLEVL  EQU   CVTRELNO+2                                               03687000
CVTNUMB  EQU   CVTRELNO                                                 03688000
CVTMDL   EQU   CVTFIX+250                                               03689000
@NM00045 EQU   CVTFIX+248                                               03690000
@NM00044 EQU   CVTFIX                                                   03691000
CVTRV482 EQU   CVTXTNT2+128                                             03692000
CVTRV481 EQU   CVTXTNT2+124                                             03693000
CVTRV480 EQU   CVTXTNT2+120                                             03694000
CVTRV479 EQU   CVTXTNT2+118                                             03695000
CVTRV478 EQU   CVTXTNT2+117                                             03696000
CVTRV477 EQU   CVTXTNT2+116                                             03697000
CVTRV476 EQU   CVTXTNT2+115                                             03698000
CVTRV475 EQU   CVTXTNT2+114                                             03699000
CVTRV474 EQU   CVTRV466                                                 03700000
CVTRV473 EQU   CVTRV466                                                 03701000
CVTRV472 EQU   CVTRV466                                                 03702000
CVTRV471 EQU   CVTRV466                                                 03703000
CVTRV470 EQU   CVTRV466                                                 03704000
CVTRV469 EQU   CVTRV466                                                 03705000
CVTRV468 EQU   CVTRV466                                                 03706000
CVTRV467 EQU   CVTRV466                                                 03707000
CVTRV465 EQU   CVTRV457                                                 03708000
CVTRV464 EQU   CVTRV457                                                 03709000
CVTRV463 EQU   CVTRV457                                                 03710000
CVTRV462 EQU   CVTRV457                                                 03711000
CVTRV461 EQU   CVTRV457                                                 03712000
CVTRV460 EQU   CVTRV457                                                 03713000
CVTRV459 EQU   CVTRV457                                                 03714000
CVTRV458 EQU   CVTRV457                                                 03715000
CVTRV456 EQU   CVTXTNT2+108                                             03716000
CVTRV455 EQU   CVTXTNT2+104                                             03717000
CVTRV454 EQU   CVTXTNT2+100                                             03718000
CVTRV453 EQU   CVTXTNT2+96                                              03719000
CVTRV452 EQU   CVTXTNT2+94                                              03720000
CVTRV451 EQU   CVTXTNT2+92                                              03721000
CVTRV450 EQU   CVTXTNT2+90                                              03722000
CVTRV449 EQU   CVTXTNT2+88                                              03723000
CVTRV448 EQU   CVTXTNT2+87                                              03724000
CVTRV447 EQU   CVTXTNT2+86                                              03725000
CVTRV446 EQU   CVTRV438                                                 03726000
CVTRV445 EQU   CVTRV438                                                 03727000
CVTRV444 EQU   CVTRV438                                                 03728000
CVTRV443 EQU   CVTRV438                                                 03729000
CVTRV442 EQU   CVTRV438                                                 03730000
CVTRV441 EQU   CVTRV438                                                 03731000
CVTRV440 EQU   CVTRV438                                                 03732000
CVTRV439 EQU   CVTRV438                                                 03733000
CVTRV437 EQU   CVTRV429                                                 03734000
CVTRV436 EQU   CVTRV429                                                 03735000
CVTRV435 EQU   CVTRV429                                                 03736000
CVTRV434 EQU   CVTRV429                                                 03737000
CVTRV433 EQU   CVTRV429                                                 03738000
CVTRV432 EQU   CVTRV429                                                 03739000
CVTRV431 EQU   CVTRV429                                                 03740000
CVTRV430 EQU   CVTRV429                                                 03741000
CVTRV428 EQU   CVTXTNT2+80                                              03742000
CVTRV427 EQU   CVTXTNT2+76                                              03743000
CVTRV426 EQU   CVTXTNT2+72                                              03744000
CVTRV425 EQU   CVTXTNT2+68                                              03745000
CVTATACT EQU   CVTATCVT                                                 03746000
CVTRV423 EQU   CVTXTNT2+62                                              03747000
CVTRV422 EQU   CVTXTNT2+60                                              03748000
CVTRV421 EQU   CVTXTNT2+58                                              03749000
CVTRV420 EQU   CVTXTNT2+56                                              03750000
CVTRV419 EQU   CVTXTNT2+55                                              03751000
CVTRV418 EQU   CVTXTNT2+54                                              03752000
CVTRV417 EQU   CVTRV409                                                 03753000
CVTRV416 EQU   CVTRV409                                                 03754000
CVTRV415 EQU   CVTRV409                                                 03755000
CVTRV414 EQU   CVTRV409                                                 03756000
CVTRV413 EQU   CVTRV409                                                 03757000
CVTRV412 EQU   CVTRV409                                                 03758000
CVTRV411 EQU   CVTRV409                                                 03759000
CVTRV410 EQU   CVTRV409                                                 03760000
CVTRV408 EQU   CVTRV400                                                 03761000
CVTRV407 EQU   CVTRV400                                                 03762000
CVTRV406 EQU   CVTRV400                                                 03763000
CVTRV405 EQU   CVTRV400                                                 03764000
CVTRV404 EQU   CVTRV400                                                 03765000
CVTRV403 EQU   CVTRV400                                                 03766000
CVTRV402 EQU   CVTRV400                                                 03767000
CVTRV401 EQU   CVTRV400                                                 03768000
CVTICB   EQU   CVTXTNT2+48                                              03769000
CVTSKTA  EQU   CVTXTNT2+44                                              03770000
CVTRSV99 EQU   CVTXTNT2+40                                              03771000
CVTRSV98 EQU   CVTXTNT2+36                                              03772000
CVTRSV97 EQU   CVTXTNT2+34                                              03773000
CVTRSV96 EQU   CVTXTNT2+32                                              03774000
CVTOLTEP EQU   CVTXTNT2+28                                              03775000
CVTQIDA  EQU   CVTQID+1                                                 03776000
CVTRSV95 EQU   CVTQID                                                   03777000
CVTRSV94 EQU   CVTXTNT2+20                                              03778000
CVTRSV93 EQU   CVTXTNT2+16                                              03779000
CVTRSV92 EQU   CVTXTNT2+12                                              03780000
CVTDEBVR EQU   CVTXTNT2+8                                               03781000
CVTRSV91 EQU   CVTXTNT2+6                                               03782000
CVTRSV9H EQU   CVTFLGBT                                                 03783000
CVTRSV9G EQU   CVTFLGBT                                                 03784000
CVTRSV9F EQU   CVTFLGBT                                                 03785000
CVTRSV9E EQU   CVTFLGBT                                                 03786000
CVTRSV9D EQU   CVTFLGBT                                                 03787000
CVTRSV9C EQU   CVTFLGBT                                                 03788000
CVTVME   EQU   CVTFLGBT                                                 03789000
CVTNPE   EQU   CVTFLGBT                                                 03790000
CVTNUCLS EQU   CVTXTNT2+4                                               03791000
CVTDSSVA EQU   CVTDSSV+1                                                03792000
CVTRSV89 EQU   CVTDSSV                                                  03793000
CVTRSV88 EQU   CVTXTNT1+8                                               03794000
CVTRSV87 EQU   CVTXTNT1+4                                               03795000
CVTFACHN EQU   CVTXTNT1                                                 03796000
CVTRV488 EQU   CVTMAP+412                                               03797000
CVTRV487 EQU   CVTMAP+408                                               03798000
CVTRV486 EQU   CVTMAP+404                                               03799000
CVTRV485 EQU   CVTMAP+400                                               03800000
CVTACTAP EQU   CVTMAP+396                                               03801000
CVTAUTH  EQU   CVTMAP+392                                               03802000
CVTATMCA EQU   CVTATMCT+1                                               03803000
CVTATMST EQU   CVTATMCT                                                 03804000
CVTRSV61 EQU   CVTMAP+384                                               03805000
CVTVOLT1 EQU   CVTVOLM1+1                                               03806000
CVTVOLI1 EQU   CVTVOLF1                                                 03807000
CVTSTOA  EQU   CVTMAP+376                                               03808000
CVTRSV58 EQU   CVTMAP+374                                               03809000
CVTRSV57 EQU   CVTMAP+372                                               03810000
CVTDDCE  EQU   CVTMAP+368                                               03811000
CVTPNWFR EQU   CVTMAP+364                                               03812000
CVTSMF   EQU   CVTMAP+360                                               03813000
CVTSULK  EQU   CVTMAP+358                                               03814000
CVTSLKO  EQU   CVTSYSK                                                  03815000
CVTSLKP  EQU   CVTSYSK                                                  03816000
CVTSLKQ  EQU   CVTSYSK                                                  03817000
CVTSLKR  EQU   CVTSYSK                                                  03818000
CVTRSV56 EQU   CVTSYSK                                                  03819000
CVTRSV55 EQU   CVTSYSK                                                  03820000
CVTRSV54 EQU   CVTSYSK                                                  03821000
CVTRSV53 EQU   CVTSYSK                                                  03822000
CVTRSV52 EQU   CVTA1F1                                                  03823000
CVTRSV51 EQU   CVTA1F1                                                  03824000
CVTRSV50 EQU   CVTA1F1                                                  03825000
CVTRSV49 EQU   CVTA1F1                                                  03826000
CVTRSV48 EQU   CVTA1F1                                                  03827000
CVTRSV47 EQU   CVTA1F1                                                  03828000
CVTSRSW  EQU   CVTA1F1                                                  03829000
CVTPFSW  EQU   CVTA1F1                                                  03830000
CVTPCVT  EQU   CVTMAP+352                                               03831000
CVTRSV46 EQU   CVTMAP+344                                               03832000
CVTRSV45 EQU   CVTMAP+340                                               03833000
CVTRSV44 EQU   CVTMAP+338                                               03834000
CVTRSV43 EQU   CVTMAP+336                                               03835000
CVTHJESA EQU   CVTHJES+1                                                03836000
CVTRSV42 EQU   CVTHJES                                                  03837000
CVTEXT2A EQU   CVTEXT2+1                                                03838000
CVTRSV41 EQU   CVTEXT2                                                  03839000
CVTAPFA  EQU   CVTAPF+1                                                 03840000
CVTRSV40 EQU   CVTAPF                                                   03841000
CVTRV518 EQU   CVTINTLA                                                 03842000
CVTRV517 EQU   CVTERPV                                                  03843000
CVTEORM  EQU   CVTMAP+312                                               03844000
CVTMCHPR EQU   CVTMAP+308                                               03845000
CVTTZ    EQU   CVTMAP+304                                               03846000
CVTJEPS  EQU   CVTMAP+300                                               03847000
CVTJESCT EQU   CVTMAP+296                                               03848000
CVTMODE  EQU   CVTMAP+292                                               03849000
CVTPTRV  EQU   CVTMAP+288                                               03850000
CVTREAL  EQU   CVTMAP+284                                               03851000
CVTRSV39 EQU   CVTMAP+280                                               03852000
CVTRSV38 EQU   CVTMAP+276                                               03853000
CVTDMSRA EQU   CVTDMSR+1                                                03854000
CVTRSV37 EQU   CVTDMSR                                                  03855000
CVTQMSGA EQU   CVTQMSG+1                                                03856000
CVTRSV36 EQU   CVTQMSG                                                  03857000
CVTAMFF  EQU   CVTMAP+264                                               03858000
CVTPURGA EQU   CVTPURG+1                                                03859000
CVTRSV35 EQU   CVTPURG                                                  03860000
CVTCBSP  EQU   CVTMAP+256                                               03861000
CVTATERA EQU   CVTATER+1                                                03862000
CVTSYST  EQU   CVTATER                                                  03863000
CVTVOLT2 EQU   CVTTAT                                                   03864000
CVTVOLI2 EQU   CVTVOLF2                                                 03865000
CVTAQAVB EQU   CVTAQAVT+1                                               03866000
CVTRSV34 EQU   CVTTCMFG                                                 03867000
CVTRSV33 EQU   CVTTCMFG                                                 03868000
CVTRSV32 EQU   CVTTCMFG                                                 03869000
CVTRSV31 EQU   CVTTCMFG                                                 03870000
CVTRSV30 EQU   CVTTCMFG                                                 03871000
CVTRSV29 EQU   CVTTCMFG                                                 03872000
CVTRSV28 EQU   CVTTCMFG                                                 03873000
CVTTCRDY EQU   CVTTCMFG                                                 03874000
CVTGTFA  EQU   CVTGTF+1                                                 03875000
CVTRSV27 EQU   CVTGTFST                                                 03876000
CVTRNIO  EQU   CVTGTFST                                                 03877000
CVTUSR   EQU   CVTGTFST                                                 03878000
CVTRV318 EQU   CVTFORM                                                  03879000
CVTRV317 EQU   CVTTMODE                                                 03880000
CVTRV316 EQU   CVTSTATE                                                 03881000
CVTRV315 EQU   CVTGTFS                                                  03882000
CVTGTFAV EQU   CVTGTFS                                                  03883000
CVT0SCR1 EQU   CVTMAP+232                                               03884000
CVTRV515 EQU   CVTMAP+228                                               03885000
CVTRMS   EQU   CVTMAP+224                                               03886000
CVTPATCH EQU   CVTMAP+220                                               03887000
CVTTSCE  EQU   CVTMAP+216                                               03888000
CVTLNKSC EQU   CVTMAP+214                                               03889000
CVTQABST EQU   CVTMAP+212                                               03890000
CVTMDLDS EQU   CVTMAP+208                                               03891000
CVTUSER  EQU   CVTMAP+204                                               03892000
CVTABEND EQU   CVTMAP+200                                               03893000
CVTSMCA  EQU   CVTMAP+196                                               03894000
CVTRSV18 EQU   CVTMAP+192                                               03895000
CVTQLPAQ EQU   CVTMAP+188                                               03896000
CVTQCDSR EQU   CVTMAP+184                                               03897000
CVTRSV17 EQU   CVTOPTB                                                  03898000
CVTRSV16 EQU   CVTOPTB                                                  03899000
CVTFP    EQU   CVTOPTB                                                  03900000
CVTAPTHR EQU   CVTOPTB                                                  03901000
CVTNLOG  EQU   CVTOPTB                                                  03902000
CVTTOD   EQU   CVTOPTB                                                  03903000
CVTCTIMS EQU   CVTOPTB                                                  03904000
CVTPROT  EQU   CVTOPTB                                                  03905000
CVTXPFP  EQU   CVTOPTA                                                  03906000
CVTASCII EQU   CVTOPTA                                                  03907000
CVTRSV13 EQU   CVTOPTA                                                  03908000
CVTRSV12 EQU   CVTOPTA                                                  03909000
CVTNIP   EQU   CVTOPTA                                                  03910000
CVTDDR   EQU   CVTOPTA                                                  03911000
CVTAPR   EQU   CVTOPTA                                                  03912000
CVTCCH   EQU   CVTOPTA                                                  03913000
CVTSNCTR EQU   CVTMAP+180                                               03914000
CVTQMWR  EQU   CVTMAP+176                                               03915000
CVTQOCR  EQU   CVTMAP+172                                               03916000
CVT1EF00 EQU   CVTMAP+168                                               03917000
CVTMZ00  EQU   CVTMAP+164                                               03918000
CVTHEAD  EQU   CVTMAP+160                                               03919000
CVTRSV11 EQU   CVTMAP+156                                               03920000
CVT0PT01 EQU   CVTMAP+152                                               03921000
CVTMSER  EQU   CVTMAP+148                                               03922000
CVTRV516 EQU   CVTIERLC                                                 03923000
CVTILCH  EQU   CVTMAP+140                                               03924000
CVT0DS   EQU   CVTMAP+136                                               03925000
CVTFBOSV EQU   CVTMAP+132                                               03926000
CVTNUCB  EQU   CVTMAP+128                                               03927000
CVTIXAVL EQU   CVTMAP+124                                               03928000
CVTIOQET EQU   CVTMAP+120                                               03929000
CVTDCBA  EQU   CVTMAP+117                                               03930000
CVTMVS2  EQU   CVTDCB                                                   03931000
CVT6DAT  EQU   CVTDCB                                                   03932000
CVT4MPS  EQU   CVTDCB                                                   03933000
CVTRSV09 EQU   CVTDCB                                                   03934000
CVT4MS1  EQU   CVTDCB                                                   03935000
CVT2SPS  EQU   CVTDCB                                                   03936000
CVT1SSS  EQU   CVTDCB                                                   03937000
CVTRSV08 EQU   CVTDCB                                                   03938000
CVTSTB   EQU   CVTMAP+112                                               03939000
CVTQTD00 EQU   CVTMAP+108                                               03940000
CVTQTE00 EQU   CVTMAP+104                                               03941000
CVTCUCB  EQU   CVTMAP+100                                               03942000
CVTSJQ   EQU   CVTMAP+96                                                03943000
CVTPBLDL EQU   CVTMAP+92                                                03944000
CVTTPC   EQU   CVTMAP+88                                                03945000
CVTSVDCB EQU   CVTMAP+84                                                03946000
CVTBRET  EQU   CVTMAP+82                                                03947000
CVTEXIT  EQU   CVTMAP+80                                                03948000
CVT0FN00 EQU   CVTMAP+76                                                03949000
CVTDARA  EQU   CVTDAR+1                                                 03950000
CVTRSV07 EQU   CVTFLGS1                                                 03951000
CVTRSV06 EQU   CVTFLGS1                                                 03952000
CVTRSV05 EQU   CVTFLGS1                                                 03953000
CVTRSV04 EQU   CVTFLGS1                                                 03954000
CVTRSV03 EQU   CVTFLGS1                                                 03955000
CVTRSV02 EQU   CVTFLGS1                                                 03956000
CVTRSV01 EQU   CVTFLGS1                                                 03957000
CVTDMPLK EQU   CVTFLGS1                                                 03958000
CVTXITP  EQU   CVTMAP+68                                                03959000
CVTZDTAB EQU   CVTMAP+64                                                03960000
CVTMSLT  EQU   CVTMAP+60                                                03961000
CVTDATE  EQU   CVTMAP+56                                                03962000
CVTBTERM EQU   CVTMAP+52                                                03963000
CVTSYSAD EQU   CVTMAP+48                                                03964000
CVTXTLER EQU   CVTMAP+44                                                03965000
CVTILK2  EQU   CVTMAP+40                                                03966000
CVTILK1  EQU   CVTMAP+36                                                03967000
CVTPRLTV EQU   CVTMAP+32                                                03968000
CVTPCNVT EQU   CVTMAP+28                                                03969000
CVT0VL00 EQU   CVTMAP+24                                                03970000
CVTXAPG  EQU   CVTMAP+20                                                03971000
CVTBUF   EQU   CVTMAP+16                                                03972000
CVTJOB   EQU   CVTMAP+12                                                03973000
CVTLINK  EQU   CVTMAP+8                                                 03974000
CVT0EF00 EQU   CVTMAP+4                                                 03975000
CVTTCBP  EQU   CVTMAP                                                   03976000
CVT      EQU   CVTMAP                                                   03977000
PPLECB   EQU   PPL+8                                                    03978000
PPLECT   EQU   PPL+4                                                    03979000
PPLUPT   EQU   PPL                                                      03980000
RECDATA  EQU   RECRD+4                                                  03981000
OFFSETV  EQU   RECRD+2                                                  03982000
LEN      EQU   RECRD                                                    03983000
@NM00033 EQU   @NM00031+7                                               03984000
@NM00030 EQU   @NM00028+7                                               03985000
LNSTARTF EQU   @NM00029                                                 03986000
@NM00027 EQU   PARSEPDL+4                                               03987000
@NM00026 EQU   PARSEPDL                                                 03988000
CXDATEXT EQU   IKJEBECX                                                 03989000
CAPDEXT  EQU   IKJEBECA+3984                                            03990000
CADSNRC2 EQU   IKJEBECA+3928                                            03991000
CADSNOF2 EQU   IKJEBECA+3926                                            03992000
CADSNLN2 EQU   IKJEBECA+3924                                            03993000
CADSNPT2 EQU   IKJEBECA+3920                                            03994000
@NM00022 EQU   IKJEBECA+3900                                            03995000
CASVAREA EQU   IKJEBECA+3176                                            03996000
CAFIBFR  EQU   IKJEBECA+1188                                            03997000
CAAEDCB  EQU   IKJEBECA+1096                                            03998000
CALDROP  EQU   IKJEBECA+1064                                            03999000
CAATNWKA EQU   IKJEBECA+956                                             04000000
CAATNBUF EQU   IKJEBECA+952                                             04001000
CAMODETX EQU   CAMODEMG+12                                              04002000
CAMODEOF EQU   CAMODEMG+10                                              04003000
CAMODELN EQU   CAMODEMG+8                                               04004000
CAMODEPT EQU   CAMODEMG+4                                               04005000
CAMODEIS EQU   CAMODEMG                                                 04006000
CASRWKA  EQU   IKJEBECA+728                                             04007000
CAMSWKA  EQU   IKJEBECA+628                                             04008000
@NM00021 EQU   CAMAWKA+30                                               04009000
@NM00020 EQU   MACFLAG2                                                 04010000
MATABLE1 EQU   MACFLAG2                                                 04011000
@NM00019 EQU   MACFLAGS                                                 04012000
MAENDPRC EQU   MACFLAGS                                                 04013000
MAABBREV EQU   MACFLAGS                                                 04014000
MAECTMOD EQU   MACFLAGS                                                 04015000
@NM00018 EQU   CAMAWKA                                                  04016000
CASTAEPL EQU   IKJEBECA+576                                             04017000
CASTAXPL EQU   IKJEBECA+556                                             04018000
CASRPLST EQU   CATMPLST+12                                              04019000
CAPTECB  EQU   CATMPLST+8                                               04020000
CAPTECT  EQU   CATMPLST+4                                               04021000
CAPTUPT  EQU   CATMPLST                                                 04022000
CASYNSCN EQU   CASYNSW                                                  04023000
CASYNML  EQU   CASYNSW                                                  04024000
CASYNSF  EQU   CASYNSW                                                  04025000
CASYNRFM EQU   CASYNSW                                                  04026000
CASYNIS  EQU   CASYNSW                                                  04027000
@NM00017 EQU   CASYNSW                                                  04028000
CASYNLN  EQU   CASYNSW                                                  04029000
@NM00016 EQU   CASYNSW                                                  04030000
CASYNRCL EQU   CASYNOPT+2                                               04031000
CASYNCD2 EQU   CASYNOPT+1                                               04032000
CASYNCD1 EQU   CASYNOPT                                                 04033000
CASYNTEM EQU   CASYNWA+12                                               04034000
CASYNWAP EQU   CASYNWA+1                                                04035000
CASYNECD EQU   CASYNWA                                                  04036000
@NM00015 EQU   IKJEBECA+484                                             04037000
CARECNO  EQU   IKJEBECA+480                                             04038000
CAINSAVE EQU   IKJEBECA+476                                             04039000
@NM00014 EQU   IKJEBECA+472                                             04040000
CAIMLINC EQU   IKJEBECA+468                                             04041000
CAIMLLNO EQU   IKJEBECA+464                                             04042000
CAINCRE  EQU   IKJEBECA+460                                             04043000
CANXTREC EQU   IKJEBECA+452                                             04044000
CASTNUM  EQU   IKJEBECA+448                                             04045000
CASAPSWD EQU   IKJEBECA+440                                             04046000
CASADDN  EQU   IKJEBECA+432                                             04047000
CASAMEMB EQU   IKJEBECA+424                                             04048000
CASADSN  EQU   IKJEBECA+380                                             04049000
CASADSNL EQU   IKJEBECA+378                                             04050000
CASADQTY EQU   CASAFLG2                                                 04051000
CASANCTG EQU   CASAFLG2                                                 04052000
CASAALOC EQU   CASAFLAG                                                 04053000
CASAUNCG EQU   CASAFLAG                                                 04054000
CASADSOR EQU   CASAFLAG                                                 04055000
CASAMEM  EQU   CASAFLAG                                                 04056000
CASADISP EQU   CASAFLAG                                                 04057000
CASAINCP EQU   CASAFLAG                                                 04058000
CASAFNCP EQU   CASAFLAG                                                 04059000
CASAVEDS EQU   CASAFLAG                                                 04060000
CADSNREC EQU   IKJEBECA+320                                             04061000
CADSNOFF EQU   IKJEBECA+318                                             04062000
CADSNLEN EQU   IKJEBECA+316                                             04063000
CADSNPTR EQU   IKJEBECA+312                                             04064000
CAEDTSIZ EQU   IKJEBECA+308                                             04065000
CAEDPSWD EQU   IKJEBECA+300                                             04066000
CAEDDDN  EQU   IKJEBECA+292                                             04067000
CAEDMEMB EQU   IKJEBECA+284                                             04068000
CAEDDSN  EQU   IKJEBECA+240                                             04069000
CAEDDSNL EQU   IKJEBECA+238                                             04070000
CAEDPRTC EQU   CAEDFLG2                                                 04071000
CAEDALOC EQU   CAEDFLAG                                                 04072000
CAEDUNCG EQU   CAEDFLAG                                                 04073000
CAEDDSOR EQU   CAEDFLAG                                                 04074000
CAEDMEM  EQU   CAEDFLAG                                                 04075000
CAEDDISP EQU   CAEDFLAG                                                 04076000
CAEDINCP EQU   CAEDFLAG                                                 04077000
CAEDFNCP EQU   CAEDFLAG                                                 04078000
CAEDITDS EQU   CAEDFLAG                                                 04079000
CABLK2   EQU   IKJEBECA+234                                             04080000
@NM00013 EQU   IKJEBECA+226                                             04081000
CAPDEND  EQU   CAPD+82                                                  04082000
CADATEXT EQU   CAPD+74                                                  04083000
CAEXTNAM EQU   CAPD+66                                                  04084000
CAPRNAME EQU   CAPD+58                                                  04085000
CAULRLMX EQU   CAPD+54                                                  04086000
CAULRLDF EQU   CAPD+52                                                  04087000
CAVLRLMX EQU   CAPD+50                                                  04088000
CAVLRLDF EQU   CAPD+48                                                  04089000
CAFLRLMX EQU   CAPD+46                                                  04090000
CAFLRLDF EQU   CAPD+44                                                  04091000
CARECFMD EQU   CAPD+43                                                  04092000
@NM00012 EQU   CADSATR2                                                 04093000
CAINLIST EQU   CADSATR2                                                 04094000
CARUNDS  EQU   CADSATR2                                                 04095000
CAOBJGEN EQU   CADSATR2                                                 04096000
CADSNDEF EQU   CADSATR2                                                 04097000
CALINTAB EQU   CADSATR2                                                 04098000
@NM00011 EQU   CADSATTR                                                 04099000
CALRECLX EQU   CADSATTR                                                 04100000
CALNNUM  EQU   CADSATTR                                                 04101000
CADSCONT EQU   CADSATTR                                                 04102000
CACAPSDF EQU   CADSATTR                                                 04103000
CACAPSRQ EQU   CADSATTR                                                 04104000
CARUN    EQU   CADSATTR                                                 04105000
CATABS   EQU   CAPD+20                                                  04106000
CALENGTH EQU   CAPD+19                                                  04107000
CALINE   EQU   CAPD+18                                                  04108000
CABLKS   EQU   CAPD+16                                                  04109000
CADSQUAL EQU   CAPD+8                                                   04110000
@NM00010 EQU   CACFLAG+8                                                04111000
CAPLIRTM EQU   CACFLAG+7                                                04112000
CAPLILFM EQU   CACFLAG+6                                                04113000
@NM00009 EQU   CACFLAG6                                                 04114000
CACHAR60 EQU   CACFLAG6                                                 04115000
@NM00008 EQU   CACFLAG5                                                 04116000
CAEDLNDP EQU   CACFLAG5                                                 04117000
CADSUSED EQU   CACFLAG4                                                 04118000
CARECURS EQU   CACFLAG4                                                 04119000
CAABEND  EQU   CACFLAG4                                                 04120000
CATPUTVF EQU   CACFLAG4                                                 04121000
CAPTGTBF EQU   CACFLAG4                                                 04122000
CAFINDIS EQU   CACFLAG4                                                 04123000
@NM00007 EQU   CAIMFLG                                                  04124000
CAIMINPT EQU   CAIMFLG                                                  04125000
CAIMSFPT EQU   CAIMFLG                                                  04126000
CAIMCIN  EQU   CAIMFLG                                                  04127000
CAIMIR   EQU   CAIMFLG                                                  04128000
CAIMSC   EQU   CAIMFLG                                                  04129000
CAIMINS  EQU   CAIMFLG                                                  04130000
CAIMPT   EQU   CAIMFLG                                                  04131000
@NM00006 EQU   CACFLAG2                                                 04132000
CASEQCOL EQU   CACFLAG2                                                 04133000
CAMODMSG EQU   CACFLAG2                                                 04134000
CADSMODS EQU   CACFLAG2                                                 04135000
CACAPS   EQU   CACFLAG1                                                 04136000
@NM00005 EQU   CAATTN                                                   04137000
@NM00004 EQU   IKJEBECA+118                                             04138000
CAMAXBLK EQU   IKJEBECA+116                                             04139000
@NM00003 EQU   IKJEBECA+88                                              04140000
CAPTICLN EQU   IKJEBECA+84                                              04141000
CAPTICDS EQU   IKJEBECA+80                                              04142000
CAPTNBFR EQU   IKJEBECA+76                                              04143000
CACORELN EQU   IKJEBECA+68                                              04144000
CAPTCORE EQU   IKJEBECA+64                                              04145000
CAUTILNO EQU   IKJEBECA+60                                              04146000
CAPTPDCB EQU   IKJEBECA+56                                              04147000
@NM00002 EQU   IKJEBECA+50                                              04148000
CAPTRTRY EQU   IKJEBECA+32                                              04149000
CAPTMSGM EQU   IKJEBECA+28                                              04150000
CAPTUT   EQU   IKJEBECA+24                                              04151000
CAPTMS   EQU   IKJEBECA+20                                              04152000
CAPTLE   EQU   IKJEBECA+16                                              04153000
CAPTAT   EQU   IKJEBECA+12                                              04154000
CAPTAE   EQU   IKJEBECA+8                                               04155000
@NM00001 EQU   IKJEBECA+4                                               04156000
CAPTTMP  EQU   IKJEBECA                                                 04157000
*                                      END UNREFERENCED COMPONENTS      04158000
@RT00107 EQU   NOSCNEXT                                                 04159000
@RT00113 EQU   ONSPEC                                                   04160000
@RT00115 EQU   OFFSPEC                                                  04161000
@RT00137 EQU   ONTEST                                                   04162000
@RT00174 EQU   FCNINCMP                                                 04163000
@RF00174 EQU   SCANEXIT                                                 04164000
@RF00118 EQU   TOTLSCAN                                                 04165000
@RT00181 EQU   FNLENTRY                                                 04166000
@RT00186 EQU   SCANEXIT                                                 04167000
@RT00191 EQU   SETON                                                    04168000
@RT00208 EQU   INITERR                                                  04169000
@RT00230 EQU   SETON                                                    04170000
@RF00230 EQU   SWITCHON                                                 04171000
@RT00236 EQU   SETON                                                    04172000
@RT00254 EQU   INITERR                                                  04173000
@RT00273 EQU   SWITCHON                                                 04174000
@RT00289 EQU   INITERR                                                  04175000
@RT00294 EQU   IOERROR                                                  04176000
@RT00300 EQU   SETON                                                    04177000
@RF00300 EQU   RECOVMSG                                                 04178000
@RF00297 EQU   CALLCHKR                                                 04179000
@RT00316 EQU   SETOFF                                                   04180000
@RF00316 EQU   PREFINAL                                                 04181000
@RT00320 EQU   SCANEXIT                                                 04182000
@RT00335 EQU   RECOVER                                                  04183000
@RT00377 EQU   CALC                                                     04184000
@RC00363 EQU   @RC00360                                                 04185000
@RT00391 EQU   NOSCNEXT                                                 04186000
@RT00421 EQU   OUT                                                      04187000
@RC00439 EQU   @RC00434                                                 04188000
@RT00529 EQU   PARTLSCN                                                 04189000
@RT00603 EQU   IOERR                                                    04190000
@RT00605 EQU   EMPTY                                                    04191000
@RT00613 EQU   IOERR                                                    04192000
@RT00615 EQU   MORESCN                                                  04193000
@RT00635 EQU   IOERR                                                    04194000
@RT00642 EQU   ENDDATA                                                  04195000
@RT00644 EQU   MOVEREC                                                  04196000
@RF00644 EQU   SYNCHK                                                   04197000
@RT00664 EQU   IOERR                                                    04198000
@RT00666 EQU   NOLINE                                                   04199000
@RF00666 EQU   SCNMORE                                                  04200000
@RT00690 EQU   SKIPMSG8                                                 04201000
@RT00722 EQU   CLEANUP                                                  04202000
@RT00730 EQU   CHKATTN                                                  04203000
@RT00784 EQU   CLEANUP                                                  04204000
@RT00841 EQU   NOSCEXT                                                  04205000
@RC00893 EQU   @EL00007                                                 04206000
@RT00922 EQU   FOUNDONE                                                 04207000
@RT00924 EQU   GETNEW                                                   04208000
@PB00009 EQU   @EL00001                                                 04209000
@PB00008 EQU   @PB00009                                                 04210000
@PB00007 EQU   @PB00008                                                 04211000
@PB00006 EQU   @PB00007                                                 04212000
@PB00005 EQU   @PB00006                                                 04213000
@PB00004 EQU   @PB00005                                                 04214000
@PB00003 EQU   @PB00004                                                 04215000
@PB00002 EQU   @PB00003                                                 04216000
@ENDDATA EQU   *                                                        04217000
         END   IKJEBESC,(C'PLS0016',0603,74207)                         04218000
