BEUI TITLE 'EDIT COMMAND ACCESS METHOD-UTILITY INITIALIZATION-IKJEBEUI' 00050003
IKJEBEUI CSECT                                                          00200003
*C0-999999                                                     @Y30NQKG 00210003
*A033350                                                       @ZA08090 00220003
*A031850-031870,052350                                         @ZA26934 00250003
*********************************************************************** 00260003
*                                                                     * 00300003
*STATUS -- VERSION NO. 02, VS2    RELEASE NO 03                       * 00310003
*                                                                     * 00320003
*COPYRIGHT N/A                                                        * 00350003
*FUNCTION -- THIS ROUTINE PREPARES THE EDIT UTILITY DATA SET FOR      * 00360003
*   PROCESSING BY PERFORMING THE FOLLOWING-                           * 00400003
*      -OBTAINS CORE STORAGE FOR A WORKAREA, CALLED UTILWORK. THIS    * 00430003
*       AREA IS CLEARED TO ZERO.                                      * 00460003
*       THIS WORKAREA CONTAINS THE DATA SET DIRECTORY                   00550003
*       BLOCK(DSDB) AND THE BUFFER CONTROL FIELDS.                      00610003
*      -THAT PORTION OF THE WORKAREA RESERVED FOR SAVEAREAS IS        * 00620003
*       INITIALIZED BY PRE-CHAINING EACH OF THE AREAS.                * 00630003
*      -THE DCB FOR THE UTILITY DATA SET IS PLACED IN THE WORKAREA.   * 00640003
*      -A UTILITY DATA SET IS ALLOCATED BY USING THE IKJDAIR ROUTINE  * 00650003
*      -THE UTILITY DATA SET IS OPENED.                               * 00660003
*      -OBTAINS CORE STORAGE FOR BUFFERS WHEN ACCESSING THE UTILITY   * 00670003
*       DATA SET.                                                     * 00680003
*      -INITIALIZES ADDITIONAL FIELDS IN THE WORKAREA, SUCH AS THE    * 00690003
*       LIST FORMS OF THE READ, WRITE, AND XDAP MACROS.               * 00700003
*      -LOADS IN THE ACCESSING LOAD MODULE (IKJEBEAA) AND SAVES       * 00710003
*       ITS ADDRESS IN THE UTILITY WORKAREA                           * 00720003
*                                                                     * 00730003
*ENTRY POINTS --                                                      * 00740003
*       IKJEBEUI             -VIA A LINK OR LOAD-CALL                 * 00750003
*                                                                     * 00760003
*INPUT --  REGISTER 1 CONTAINS THE ADDRESS OF THE EDIT COMMUNICATION  * 00770003
*   AREA, IKJEBECA                                                    * 00780003
*                                                                     * 00790003
*OUTPUT -- PERFORMS THE OPERATIONS DESCRIBED UNDER 'FUNCTION' ABOVE.  * 00800003
*   REGISTERS ARE AS DESCRIBED UNDER 'EXIT' BELOW.                    * 00810003
*                                                                     * 00820003
*EXTERNAL REFERENCES --                                               * 00830003
*       IKJDAIR              -ALLOCATES THE UTILITY DATA SET          * 00840003
*       MACROS USED                                                   * 00850003
*         GETMAIN            -CORE FOR WORKAREA AND BUFFERS           * 00860003
*         FREEMAIN           -RELEASE CORE ON ERROR CONDITIONS        * 00870003
*         OPEN               -OPENS UTILITY DATA SET                  * 00880003
*         CLOSE              -CLOSE DATA SET ON ERROR CONDITIONS      * 00890003
*         LOAD               -ACCESS LOAD MODULE, IKJEBEAA            * 00900003
*                                                                     * 00910003
*EXITS,NORMAL -- RETURNS ON REGISTER 14                               * 00920003
*   REGISTER 15 CONTAINS A RETURN CODE OF ZERO.                       * 00930003
*   REGISTER 0  CONTAIN S THE ADDRESS OF THE UTILITY WORKAREA/DCB.    * 00940003
*                                                                     * 00950003
*EXITS,ERROR--                                                        * 01000003
*   REGISTER 15 CONTAINS A RETURN CODE AS FOLLOWS-                    * 01009003
*     4- NOT ENOUGH CORE AVAILABLE                                    * 01018003
*     8- UTILITY DATA SET NOT AVAILABLE                               * 01027003
*    12 - UNABLE TO OPEN DATA SET                                     * 01036003
*                                                                     * 01045003
*TABLES/WORK AREAS --                                                 * 01054003
*       DEPENDENT ON THE EDIT COMMUNICATIONS AREA (IKJEBECA) FOR-     * 01063003
*         -INVOCATION OF IKJDAIR                                      * 01072003
*         -WRITING OUT MESSAGES                                       * 01081003
*       BUILDS AND INITIALIZES THE UTILITY WORKAREA (UTILWORK) AS     * 01090003
*       DESCRIBED ABOVE                                               * 01099003
*                                                                     * 01108003
*ATRRIBUTES -- REFRESHABLE,ENABLED,NON-PRIVILEGED                     * 01117003
*                                                                     * 01126003
*NOTES -- REGISTER DEFINITIONS AS DEFINED BELOW.                      * 01135003
*                                                                     * 01144003
*   THIS ROUTINE IS CHARACTER CODE INDEPENDENT                        * 01153003
*                                                                     * 01162003
*********************************************************************** 01171003
       EJECT                                                            01200003
*   THE FOLLOWING ARE REGISTER ASSIGNMENTS                              01209003
PARMREG0 EQU   0                       PARM POINTER                     01218003
PARMREG1 EQU   1                       PARM POINTER                     01227003
WORK2    EQU   2                       WORK REGISTER                    01236003
LINK5    EQU   5                        LINK REGISTER FOR MESSAGES      01245003
WORK3    EQU   3                       WORK REGISTER                    01254003
WORK4    EQU   4                       WORK REGISTER                    01263003
WORK5    EQU   5                       WORK REGISTER                    01272003
WORK6    EQU   6                       WORK REGISTER                    01281003
WORK7    EQU   7                       WORK REGISTER                    01290003
WORK8    EQU   8                       TEMPORARY WORKAREA ADDRESSING    01299003
LINK9    EQU   10                      SUBROUTINE LINK REGISTER         01308003
COMMREG  EQU   9                       EDIT COMMUNICATIONS AREA         01317003
BASEREG  EQU   11                      BASE REGISTER                    01326003
DATAREG  EQU   12                      UTILITY WORK AREA ADDRESSING     01335003
SAVEREG  EQU   13                      SAVE AREA ADDRESSING             01344003
RETREG   EQU   14                      RETURN REGISTER                  01353003
RETCDREG EQU   15                      RETURN CODE                      01362003
ENTRY    EQU   15                      ENTRY POINT ADDRESS              01371003
         SPACE                                                          01400003
*   DEFINITIONS                                                         01409003
OPEN     EQU   X'10'                   OPEN TEST FLAG                   01418003
SAVENO   EQU   6                       NO. OF STACKED SAVE AREAS        01427003
SAVEL    EQU   72                      SAVE AREA LENGTH                 01436003
K255     EQU   255                     CONSTANT OF 255                  01445003
EIGHT    EQU   8                       CONSTANT OF EIGHT                01454003
FOUR     EQU   4                       CONSTANT OF FOUR                 01463003
X2       EQU   2                       OFFSET OF TWO                    01472003
X8       EQU   8                       OFFSET OF EIGHT                  01481003
X4       EQU   4                       OFFSET OF FOUR                   01490003
X12      EQU   12                      OFFSET OF TWELVE                 01499003
X48      EQU   48                      OFFSET OF FORTY-EIGHT            01508003
X66      EQU   66                      OFFSET OF SIXTY-SIX              01517003
SPONE    EQU   1                       SUBPOOL NUMBER                   01526003
OPENERR  EQU   12                      RETURN CODE //OPEN ERROR         01535003
SID      EQU   X'31'                   OPERATION CODE//SEARCH ID        01544003
TIC      EQU   8                       OFFSET TO TIC CCW                01553003
TICCODE  EQU   X'08'                   OPERATION CODE//TRANSFER         01562003
IOBFIRST EQU   X'01'                   FIRST AND LOWEST IOB             01571003
ONE      EQU   1                       CONSTANT OF ONE                  01600003
ZERO     EQU   0                       CONSTANT OF ZERO                 01609003
X20      EQU   20                      OFFSET OF TWENTY                 01618003
THREE    EQU   3                       CONSTANT OF 3                    01627003
FIVE     EQU   5                       CONSTANT OF 5                    01636003
SIX      EQU   6                       CONSTANT OF SIX                  01645003
LENGTH4  EQU   X'04'                   FOR LENGTH OF MESSAGE OPEN ERROR 01654003
X26      EQU   26                       USED TO CLEAR MESSAGE AREA      01663003
X240     EQU   240                      FOR START OF TRANSLATE TABLE    01672003
X4095    EQU   4095                    CONSTANT OF 4095                 01681003
MGCOREB  EQU   40                      OFFSET TO MESSAGE BLOCK          01690003
MGCOREBO EQU   MGCOREB+6               OFFSET IN MESSAGE BLOCK          01699003
MGCOREBL EQU   MGCOREB+5               OFFSET TO LENGTH FIELD           01708003
MGCOREBM EQU   MGCOREB+8               OFFSET TO MESSAGE INSERTION      01717003
         EJECT                                                          01726003
*   ALLOCATION ERROR CODES                                              01735003
CTRC0028 EQU   X'0028'                 CATALOG I/O ERROR CODE           01744003
DARC0214 EQU   X'0214'                 DYNAMIC ALLOCATION ERROR CODE    01753003
DARC021C EQU   X'021C'                 DYNAMIC ALLOCATION ERROR CODE    01762003
DARC0220 EQU   X'0220'                 DYNAMIC ALLOCATION ERROR CODE    01771003
         SPACE 2                                                        01800003
*   MESSAGE REFERENCES                                                  01810003
         SPACE                                                          01820003
         SPACE                                                          01830003
         IKJEBEMI (301,304,305,309,312,313,318)                         01840003
         EJECT                                                          01850003
*   PERFORM THE INITIALIZATION OPERATIONS HERE                          01860003
         IKJEBESV  (14,12),T,*             SAVE THE REGISTERS           01870003
         USING IKJEBECA,COMMREG                                         01880003
         SPACE 2                                                        01890003
*   OBTAIN A WORKAREA FOR ALL UTILITY ROUTINES AND MACROS               01900003
         SR    DATAREG,DATAREG         INDICATE NO WORKAREA             01910003
         MVC   GMLIST(GMEND-GM),GM     LIST FORM TO WORKAREA            01920003
         LA    PARMREG1,GMLIST         ADDRESS OF LIST FORM             01930003
         L     WORK3,BLOCKSZ           MAXIMUM AND DEFAULT              01940003
*                                        SIZE OF DSDB                   01950003
         LA    WORK3,UTILSIZE+BUFEND(,WORK3) TOTAL SIZE                 01960003
         GETMAIN EC,A=GMADDR,LV=(WORK3),BNDRY=PAGE,MF=(E,(1))           01970003
         LTR   RETCDREG,RETCDREG       WAS CORE AVAILABLE               01980003
         BNZ   UI3                     NO--GO GIVE A MESSAGE            02000003
         L     DATAREG,GMADDR          ADDRESS OF WORKAREA              02009003
         USING UTILWORK,DATAREG                                         02018003
         LA    WORK8,TEMPAREA          SERVICE ROUTINE WORKAREA         02027003
         USING UIWORK,WORK8                                             02036003
         SPACE 2                                                        02045003
*   CLEAR DCB AND WORKAREA CORE TO ZERO                                 02054003
*   CLEAR WORKAREA AND BUFFER CORE TO ZERO                              02063003
         LR    WORK2,DATAREG            STARTING ADDRESS                02072003
         LA    PARMREG0,UTILSIZE+BUFEND-ONE  SIZE TO CLEAR              02081003
UICLR1   LA    PARMREG1,K255           MAXIMUM AMOUNT PER PASS(256)     02090003
         CR    PARMREG0,PARMREG1       COMPARE ACTUAL TO MAXIMUM        02099003
         BNL   UICLR2                  BRANCH TO CLEAR 256 BYTES        02108003
         LR    PARMREG1,PARMREG0       USE ACTUAL, LESS THAN 256        02117003
UICLR2   EX    PARMREG1,UICLEAR        CLEAR SPECIFIED AMOUNT           02126003
         LA    PARMREG1,ONE(PARMREG1)  AMOUNT OF BYTES CLEARED          02135003
         AR    WORK2,PARMREG1          NEW STARTING ADDRESS             02144003
         SR    PARMREG0,PARMREG1       ANY MORE BYTES LEFT TO CLEAR     02153003
         BNM   UICLR1                  YES-MAKE ANOTHER PASS            02162003
         SPACE 2                                                        02171003
*   SET UP FIRST SAVE AREA AND CHAIN ALL SAVE AREAS.                  * 02180003
         LA    PARMREG1,SAVEAREA-SAVEL START OF SAVE AREA.              02200003
         LA    WORK2,SAVENO            NUMBER OF SAVE AREAS             02208003
         LR    WORK4,SAVEREG           CALLING PROGRAMS SAVE AREA       02216003
UICHAIN  LA    PARMREG1,SAVEL(PARMREG1)  NEXT SAVEAREA                  02224003
         ST    WORK4,FOUR(PARMREG1)     BACK CHAIN TO LAST              02232003
         ST    PARMREG1,EIGHT(WORK4)    FORWARD CHAIN LAST TO CURRENT   02240003
         LR    WORK4,PARMREG1          LAST IN CHAIN                    02248003
         BCT   WORK2,UICHAIN           REPEAT UNTIL ALL CHAINED         02256003
         SR    PARMREG1,PARMREG1       SET LAST FORWARD                 02264003
         ST    PARMREG1,EIGHT(WORK4)      CHAIN TO ZERO                 02272003
         SPACE 2                                                        02280003
         STH   WORK3,UWSIZE            SAVE SIZE OF TOTAL AREA          02288003
*                                        FOR LATER PROCESSING           02296003
         SPACE 2                                                        02304003
*   MOVE DCB TO WORKAREA AND SET IT UP HERE                             02312003
         MVC   UTILDCB(DCBEND-BSAMDCB),BSAMDCB  DCB TO WORK AREA        02320003
         SPACE 2                                                        02328003
*   OBTAIN A UTILITY DATA SET AND PLACE DDNAME IN THE DCB               02336003
         MVC   UIDAIR(DAIRSIZE),DAIRCODE  PARM LIST FOR DAIR            02344003
         MVC   UIDAIR+DA08BLK-DAPB08(FOUR),BLOCKSZ PUT DEFAULT          02352003
*                                          BLOCKSIZE IN DAIR PARMS      02360003
         SPACE 2                                                        02368003
*   SET UP DAIR PARM BLOCK FOR ATTEMPT TO GET EITHER                    02400003
*   A PRIMARY OR SECONDARY UTILITY HERE                                 02410003
         TM    CACFLAG4,CADSUSED       USING PRIMARY BEFORE             02420003
         BZ    UIDS                    IF OFF, USE &EDIT                02430003
         LA    WORK3,DSNAME1           USE &EDIT2                       02440003
         ST    WORK3,UIDAIR+DA08PDSN-DAPB08 NEW DSN POINTER             02450003
UIDS     XI    CACFLAG4,CADSUSED       FLIP/RESET SWITCH                02460003
           EJECT                                                        02470003
         SPACE 2                                                        02480003
**********************************************************************  02490003
*   HERE WE FIGURE OUT HOW MUCH SPACE WILL BE NEEDED FOR THE UTILITY    02500003
*   DATA SET--- IF THE DATASET WAS OLD THE DEFAULTED SPACE ALLOCATION   02510003
*                                                                       02520003
*    SPACE ALGORITHM FOR AN OLD DATASET IS:                             02530003
*                                                                       02540003
*                                                                       02550003
*   PRIMARY SPACE -  P=PRIMARY SPACE                                    02560003
*                    CAUTILNO=NUMBER OF RECORDS IN THE DATASET          02570003
*                    CALRECL=NUMBER OF CHARACTERS IN THE                02600003
*                                  LOGICAL LINE SIZE                    02609003
*                    BLOCKSZ=DEFAULT DSB SIZE (4096)                    02618003
*                    CARECNO=ADDITIONAL RECORDS TO BE ADDED-            02627003
*                           AS REQUESTED BY THE CALLING ROUTINE         02636003
*                    BUFPAD2=A PADDING OF TWO BLOCKS                    02645003
*                    TOTREC=CAUITLNO+CARECNO                            02654003
*                                                                       02663003
*   P=2(((TOTREC*CALRECL)/BLOCKSZ)+BUFPAD2)                             02672003
*                                                                       02681003
*   SECONDARY SPACE:                                                    02690003
*                                                                       02699003
*                   THE SECONDARY ALLOCATION REQUEST IS ONE HALF        02708003
*                   OF THE PRIMARY ALLOCATION                           02717003
*                                                                       02726003
*                                                                       02735003
*    THE SPACE ALGORITHM FOR A NEW DATASET IS:                          02744003
*    PRIMARY SPACE -                                                    02753003
*                                                                       02762003
*                     P=4(BLOCKSZ)                                      02771003
*                                                                       02800003
*    SECONDARY SPACE -                                                  02809003
*                      ONE HALF OF THE PRIMARY SPACE                    02818003
***************************************************************         02827003
          SPACE 2                                                       02836003
          L     WORK4,CARECNO          PICK UP ANY EXTRA RECORDS        02845003
          LTR   WORK4,WORK4            IF THERE ARE THEN IT IS A        02854003
*                                      SECONDARY DATASET BEING USED     02863003
         BNZ    UICALC                 PROCESS AS &EDIT DSN             02872003
         TM    CAEDFLAG,CAEDDISP       IS DATA SET OLD OR NEW           02881003
         BZ    UINEW                   NEW - USE DEFAULTS               02890003
         L     WORK4,CARECNO           PICK UP EXTRA RECORDS NEEDED     02899003
         A     WORK4,CAUTILNO          ADD CURRENT NO. OF RECORDS       02908003
UICALC   EQU    *                                                       02917003
         LH    WORK3,CALRECL           GET LRECL FOR DATA SET           02926003
         LA    WORK3,SIX(WORK3)        ACCOUNT FOR LOCATORS AND KEY     02935003
         M     WORK2,CAUTILNO          GET US TOTAL BYTES IN DATA SET   02944003
         D     WORK2,BLOCKSZ           NUMBER OF DBS NEEDED             02953003
*                                      BASED ON DEFAULT BLKSIZE         02962003
         AH    WORK3,BUFPAD2         PAD THE ALLOCATION WITH 2 BUFFERS  02971003
         ST    WORK3,UIDAIR+DA08SQTY-DAPB08 STORE SECONDARY             03000003
*                                           SPACE QUANTY                03003003
         AR    WORK3,WORK3        DOUBLE 2ND QNTY AS PRIMARY            03009003
         ST    WORK3,UIDAIR+DA08PQTY-DAPB08   STORE PRIMARY SPACE FOR   03018003
*                                       DAIR SERVICE ROUTINE            03027003
UINEW    EQU   *                                                        03036003
         XC    CARECNO,CARECNO           CLEAR FOR NEXT USER            03045003
         LA    PARMREG1,UIDAIR         ADDRESS OF LIST                  03054003
         ST    PARMREG1,CATMPLST+DAPLDAPB-DAPL BLOCK ADDRESS TO LIST    03063003
         L     PARMREG1,CAPTTMP        TMP TO CP ADDRESS LIST           03072003
         USING CPPL,PARMREG1                                            03075003
         MVC   CATMPLST+DAPLPSCB-DAPL(L'CPPLPSCB),CPPLPSCB PSCB ADDRESS 03081003
         DROP  PARMREG1                                                 03090003
         LA    PARMREG1,CATMPLST       TOTAL PARM LIST                  03099003
         CALLTSSR  EP=IKJDAIR           OBTAIN A UTILITY DATA           03108003
*                                       SET                             03117003
          CH     RETCDREG,UIDAIR48       CHECK FOR AN ABEND IN DAIR     03126003
          BE     UIFREE                  CLEAN-UP AND RETURN            03135003
         CH    RETCDREG,UIDAIRXX        IS RC > X'14' ?        @ZA26934 03144003
         BH    UISYSER                  GO ISSUE SYERR MSG     @ZA26934 03147003
         B     UIBTAB1(RETCDREG)        START OF BRANCH TABLE           03153003
UIBTAB1  B     UIALOCOK                 RC=0  OK                        03162003
         B     UISYSER                  RC=4  INVALID PARAMETER         03171003
         B     UICTLGER                 RC=8 ERROR IN CATALOG           03209003
         B     UIALOCER                 RC=12  ERROR IN ALLOCATION      03218003
         B     UINOTIOT                 RC=16  NO TIOT ENTRIES          03227003
         B     UISYSER                  RC=20  DDNAME IN USE            03236003
UIALOCOK EQU   *                                                        03245003
         MVC   DCBDDNAM(EIGHT),UIDAIR+DA08DDN-DAPB08 DDNAME TO DCB      03254003
         SPACE 2                                                        03263003
*   OPEN THE DCB HERE.                                                  03272003
         MVC   UIOPEN(OPENLEND-OPENL),OPENL  LIST FORM TO WORKAREA      03281003
         LA    PARMREG1,UIOPEN               ADDRESS OF LIST FORM       03290003
         LA    WORK2,UTILDCB           DCB ADDRESS                      03299003
         OPEN  ((WORK2)),MF=(E,(1))    OPEN THE UTILITY DCB             03308003
         XC    DCBEXLST+1(3),DCBEXLST+1 REMOVE PTR TO OPEN EXIT@ZA08090 03317003
         TM    DCBOFLGS,OPEN           WAS OPEN SUCCESSFUL              03326003
         BZ    UI12                    NO--                             03335003
         SPACE 2                                                        03344003
*   COMPUTE SIZE OF WORKAREA/BUFFER CONTROL/DSDB CORE HERE              03353003
         LH    WORK3,DCBBFNO           TOTAL BUFFERS                    03362003
         LA    WORK5,L'BUF1            LENGTH OF BUFFER                 03371003
         MR    WORK4,WORK3             TOTAL BUFFER CORE                03380003
         LH    WORK3,DCBBLKSI          BLOCKSIZE                        03400003
         AR    WORK5,WORK3             PLUS BUFFER CORE                 03409003
         LA    WORK5,UTILSIZE(,WORK5)  PLUS WORKAREA                    03418003
         LH    WORK3,UWSIZE            ORIGINAL CORE SIZE               03427003
         SR    WORK3,WORK5             ANY DIFFERENCE                   03436003
         BZ    UI60                    NO--CONTINUE                     03445003
         SPACE 2                                                        03454003
*   RETURN SOME OF CORE// MAXIMUM VALUES NOT USED.                      03463003
         LA    PARMREG1,ZERO(WORK5,DATAREG) AREA ADDR. TO FREE          03472003
         FREEMAIN R,LV=(WORK3),A=(1),SP=SPONE FREE EXTRA CORE           03481003
UI60     SH    WORK5,DCBBLKSI          LESS SIZE OF DSDB                03490003
         STH   WORK5,UWSIZE            SAVE SIZE OF WORKAREA            03499003
*                                      DCB,BUFFER CONTROL               03508003
         MVC   DSDBSIZE,DCBBLKSI       INITIAL DIRECTORY SIZE           03517003
         SPACE 2                                                        03526003
*   SET UP THE DSDB HERE                                                03535003
*   REGISTER WORK5 CONTAINS THE SIZE OF THE DCB AND WORKAREA            03544003
         LA    WORK7,ZERO(WORK5,DATAREG) ADDRESS OF BLOCK               03553003
         USING DATA,WORK7              ADDRESSABILITY                   03562003
         ST    WORK7,DBUFBLCK          STORE BLOCK ADDRESS              03571003
         SPACE 2                                                        03600003
*    GET CORE FOR EACH BUFFER BLOCK HERE                                03610003
         LH    WORK4,DCBBFNO           TOTAL BUFFERS                    03620003
         LH    WORK3,DCBBLKSI          SIZE OF EACH BLOCK               03630003
         LA    WORK6,BUF1              1ST BUFFER CNTRL.FIELD           03640003
         USING BUFFER,WORK6                                             03650003
         MVC   GMLIST(GMEND-GM),GM     LIST FORM                        03660003
CORE     LA    PARMREG1,GMLIST         ADDR. OF LIST FORM               03670003
         LA    WORK5,X4095             CONSTANT OF 4095                 03680003
         NR    WORK5,WORK3             CHECK 4K MULTIPLE                03690003
         BZ    CORE1                   YES-4K MULTIPLE                  03700003
         GETMAIN EC,A=GMADDR,LV=(WORK3),MF=(E,(1)) GET BLOCK            03710003
         B     CORE2                   CHECK RETURN CODES               03720003
CORE1    EQU   *                       PAGE ALIGNED HERE                03730003
         GETMAIN EC,A=GMADDR,LV=(WORK3),BNDRY=PAGE,MF=(E,(1))           03740003
CORE2    EQU   *                       CHECK RETURN CODES               03750003
         LTR   RETCDREG,RETCDREG       IS CORE AVAILABLE                03760003
         BNZ   UI1                     NO----                           03770003
         L     WORK7,GMADDR            ADDRESS OF BLOCK                 03780003
         ST    WORK7,BUFBLOCK          SAVE ADDR. IN CONTROL AREA       03800003
         LA    WORK6,L'BUF1(,WORK6)    NEXT CONTROL AREA                03809003
         BCT   WORK4,CORE              GET CORE FOR EACH BLOCK          03818003
         DROP  WORK6,WORK7             RELEASE                          03827003
         SPACE 2                                                        03836003
*    CHAIN THE BUFFER CONTROL FIELDS                                    03845003
*        WORK3                         PREVIOUS BUFFER                  03854003
*        WORK7                         NEXT BUFFER                      03863003
         USING BUFFER,WORK6            CURRENT BUFFER                   03872003
         LH    WORK4,DCBBFNO           TOTAL BUFFER BLOCKS              03881003
         BCTR  WORK4,ZERO              LESS ONE FOR LOOP CNTRL          03890003
         L     WORK6,DBUFBLCK          DSDB BLOCK ADDRESS               03899003
         LA    WORK7,L'BUF1            SIZE OF BUFFER CONTROL           03908003
         SR    WORK6,WORK7             START OF LAST BUFFER             03917003
         LR    WORK3,WORK6             LAST BUFFER CNTRL ADDR.          03926003
         LA    WORK6,BUF1              1ST BUFFER AREA                  03935003
         LA    WORK7,BUF2              2ND OR NEXT AREA                 03944003
         LA    WORK5,L'BUF1            LENGTH OF AREA                   03953003
CHAIN    ST    WORK7,BUFCHAIN          ADDR. OF NEXT AREA               03962003
         ST    WORK3,BBKCHAIN          ADDR. OF PREVIOUS                03971003
         LR    WORK3,WORK6             CURRENT BECOMES PREVIOUS         04000003
         LR    WORK6,WORK7             NEXT BECOMES CURRENT             04009003
         AR    WORK7,WORK5             NEW NEXT AREA                    04018003
         BCT   WORK4,CHAIN             REPEAT UNTIL FINISHED            04027003
         SPACE 1                                                        04036003
         ST    WORK3,BBKCHAIN          LAST BACKCHAIN                   04045003
         LA    WORK7,BUF1              NEXT                             04054003
         ST    WORK7,BUFCHAIN          NEXT TO CURRENT LAST             04063003
         DROP  WORK6                   RELEASE                          04072003
         SPACE 2                                                        04081003
*   LOAD IN THE ACCESSING ROUTINES HERE                                 04090003
         LOAD   EP=IKJEBEAA            BRING IN EDIT ACCESS METHOD      04099003
         SPACE 2                                                        04108003
*   SAVE ADDRESS OF ACCESS METHOD HERE                                  04117003
         LR    PARMREG1,PARMREG0       ADDRESS OF LOADED ROUTINE        04126003
         USING VECTABLE,PARMREG1                                        04135003
         ST    PARMREG1,VTABLE         SAVE IN WORKAREA                 04144003
         MVC   DCBSYNAD(FOUR),SY       SYNAD ADDRESS TO DCB             04153003
         DROP  PARMREG1                                                 04162003
         SPACE 2                                                        04171003
*   INITIALIZE THE DIRECTORY BLOCK HERE                                 04200003
         L     WORK7,DBUFBLCK          BLOCK ADDRESS                    04209003
         USING DATA,WORK7              ADDRESSABILITY                   04218003
         OI    DCBSTATS,DSEMPTY        INDICATE EMPTY                   04227003
         XC    NUMINDEX,NUMINDEX       NO ENTRIES                       04236003
         DROP  WORK7                   RELEASE                          04245003
         SPACE 2                                                        04254003
*   SET UP THE LIST FORMS OF THE XDAP, READ, AND WRITE MACROS           04263003
         USING BUFFER,WORK6            ADDRESSABILITY                   04272003
         LA    WORK6,BUF1              1ST AREA                         04281003
         LH    WORK5,DCBBFNO           TOTAL BUFFERS                    04290003
CCWS     MVC   BXDAPW(READEND-XDAPW),XDAPW LIST FORMS                   04299003
         LA    WORK4,XWECB             ECB ADDRESS                      04308003
         ST    WORK4,XWIOB+FOUR        STORE IN IOB                     04317003
         LA    WORK4,XWCCWS            ADDRESS OF CCWS                  04326003
         ST    WORK4,XWCCWAD           STORE IN IOB                     04335003
         ST    WORK4,XWCCWS+TIC        STORE IN TIC CCW                 04344003
         MVI   XWCCWS+TIC,TICCODE      RESTORE OPERATION CODE           04353003
         LA    WORK4,WCCHHR            SEARCH ADDRESS                   04362003
         ST    WORK4,XWCCWS            STORE IN SEARCH CCW              04371003
         MVI   XWCCWS,SID              RESTORE OPERATION CODE           04400003
         LH    WORK4,DCBBLKSI          BLOCK SIZE                       04409003
         STH   WORK4,XWBLKSIZ          UPDATE CCW                       04418003
         LA    WORK4,BXDAPW            IOB ADDRESS                      04427003
         ST    WORK4,BXDAPW            TO IOB PREFIX                    04436003
         MVI   BXDAPW,IOBFIRST         SET INDICATOR                    04445003
         SPACE 2                                                        04454003
*   SET UP XDAP READ FORM CCWS                                          04463003
         LA    WORK4,XRECB             ECB ADDRESS                      04472003
         ST    WORK4,XRIOB+FOUR        STORE IN IOB                     04481003
         LA    WORK4,XRCCWS            ADDRESS OF CCWS                  04490003
         ST    WORK4,XRCCWAD           STORE IN IOB                     04499003
         ST    WORK4,XRCCWS+TIC        STORE IN TIC CCW                 04508003
         MVI   XRCCWS+TIC,TICCODE      RESTORE OPERATION CODE           04517003
         LA    WORK4,RCCHHR            SEARCH ADDRESS                   04526003
         ST    WORK4,XRCCWS            STORE IN SEARCH CCW              04535003
         MVI   XRCCWS,SID              RESTORE OPERATION CODE           04544003
         LH    WORK4,DCBBLKSI          BLOCK SIZE                       04553003
         STH   WORK4,XRBLKSIZ          UPDATE READ CCW                  04562003
         LA    WORK4,BXDAPR            IOB PREFIX                       04571003
         ST    WORK4,BXDAPR            TO IOB PREFIX                    04580003
         MVI   BXDAPR,IOBFIRST         SET INDICATOR                    04600003
         LA    WORK6,L'BUF1(WORK6)     NEXT AREA ADDRRESS               04609003
         BCT   WORK5,CCWS              REPEAT UNTIL FINISHED            04618003
         DROP  WORK6                   RELEASE                          04627003
         SPACE 2                                                        04636003
*   EXIT HERE IF EVERYTHING IS OKAY.                                    04645003
UI0      SR    RETCDREG,RETCDREG       SET RETURN CODE  = 0             04654003
         L     WORK4,FOUR(SAVEREG)     PREVIOUS SAVE AREA               04663003
         ST    DATAREG,X20(WORK4)      SET UP RETURN REGISTER 0         04672003
UI00     EQU   *                       ALL RETURNS THRU HERE            04681003
         IKJEBERT (14,12),T,RC=(15)    RESTORE THE REGISTERS            04690003
         EJECT                                                          04699003
*****************************************************************       04708003
*                                                                       04717003
*   OPEN EXIT ROUTINE                                                   04726003
*   CONTROLS BLOCKSIZE AND # OF BUFFERS FOR UTILITY DATA SET            04735003
*                                                                       04744003
*        REG   1     DCB ADDRESS                                        04753003
*        REGS  2-12  (SAME CONTENTS PRIOR TO OPEN)                      04762003
*          REG  9     COMMUNICATIONS AREA ADDRESS                       04771003
*          REG 11     BASE REGISTER                                     04800003
*          REG 12     DCB ADDRESS                                       04810003
*        REG  14    RETURN ADDRESS                                      04820003
*        REG  15    ENTRY POINT                                         04830003
*                                                                       04840003
*****************************************************************       04850003
         SPACE 3                                                        04860003
OPENEXIT EQU   *                       ENTER HERE                       04870003
*   SET THE BLOCK SIZE HERE                                             04880003
         L     WORK3,BLOCKSZ           DEFAULT BLOCKSIZE                04890003
UI200    EQU   *                       EXIT                             04900003
         STH   WORK3,DCBBLKSI          INSURE CORRECT BLOCKSIZE         05000003
         SPACE 2                                                        05010003
*   SET UP THE NO. OF BUFFERS HERE                                      05020003
         LH    WORK3,BUFNO             DEFAULT # OF BUFFERS             05030003
UI201    STH   WORK3,DCBBFNO           SAVE # OF BUFFERS                05040003
         XC    DCBBUFNO,DCBBUFNO       INSURE =0 SO THAT BSAM           05050003
*                                      WILL NOT GET BUFFERS             05060003
         BR    RETREG                  RETURN                           05070003
         SPACE 3                                                        05080003
*****************************************************************       05090003
BUFPAD2  DC    H'2'                A TWO BUFFER PADDING FOR             05200003
*                                  THE ALLOC OF AN OLD DS               05203003
UIDAIR48 DC    H'48'               THE DAIR RETURN CODE WHEN ABEND      05209003
*                                                                       05218003
UIDAIRXX DC    H'20'               RETURN CODES NOT IN TABLE   @ZA26934 05227003
*                                                                       05236003
MINIMUM DC     F'1688'                 MINIMUM BLOCKSIZE                05245003
BLOCKSZ  DC    F'4096'                 MAXIMUM/DEFAULT BLOCKSIZE        05254003
BUFNO    DC    H'3'                    MINIMUM/DEFAULT #BUFFERS         05263003
BUFMAX   DC    H'10'                   MAXIMUM NO. OF BUFFERS           05272003
BMASK    DC    X'00007FF8'             MASK TO INSURE BLKSIZE IS        05275003
*                                        A DOUBLE WORD MULTIPLE.        05281003
*****************************************************************       05290003
         EJECT                                                          05299003
         SPACE 2                                                        05308003
*********************************************************************** 05317003
*   CATALOG ERROR IN ALLOCATION                                         05326003
UICTLGER EQU   *                                                        05335003
         LH    WORK2,UIDAIR+DA08CTRC-DAPB08  CATALOG ERROR CODE         05344003
         XC    MSGAREA(X48),MSGAREA    CLEAR MESSAGE AREA               05347003
         LA    PARMREG1,CTRC0028       WAS CATALOG ERROR                05353003
         CR    PARMREG1,WORK2            CODE X'0028'                   05362003
         BE    UICTIOER                YES,GO SET UP I/O ERROR MSG      05371003
*                                      NO,ISSUE MSG WITH ERROR CODE     05409003
         LA    PARMREG1,M3042IN1       INITIALIZE OFFSET IN LEVEL       05418003
         STH   PARMREG1,MGBUILDO         2 INSERTION BLOCK              05427003
         L     PARMREG1,CTLGERPB       RELATIVE MESSAGE NUMBERS         05436003
         BAL   LINK5,UIDAIRCD          GO ISSUE MSG WITH ERROR CODE     05445003
         B     UIFREE                  GO CLEAN UP                      05454003
         SPACE 2                                                        05463003
*   CATALOG I/O ERROR MESSAGE                                           05472003
UICTIOER EQU   *                                                        05481003
         L     PARMREG1,CTIOERPB       RELATIVE MESSAGE NUMBERS         05490003
UIALOCMG EQU   *                                                        05499003
         ST    PARMREG1,MSGAREA        MSG PARM LIST, NO INSERTIONS     05508003
         BAL   LINK5,MSG               GO ISSUE MESSAGE                 05517003
         B     UIFREE                  GO CLEAN UP                      05526003
         SPACE 2                                                        05535003
*********************************************************************** 05544003
*   UNABLE TO ALLOCATE UTILITY DATA SET                                 05553003
UIALOCER EQU   *                                                        05562003
         LH    WORK2,UIDAIR+DA08DARC-DAPB08 DYNAMIC ALLOC ERROR CODE    05571003
         XC    MSGAREA(X48),MSGAREA    CLEAR MESSAGE AREA               05600003
         LA    PARMREG1,DARC0220       WAS DYNAMIC ALLOCATION           05609003
         CR    PARMREG1,WORK2            ERROR CODE X'0220'             05618003
         BE    UIDC0220                YES,ISSUE MSG                    05627003
         LA    PARMREG1,DARC0214       WAS DYNAMIC ALLOCATION           05636003
         CR    PARMREG1,WORK2            ERROR CODE X'0214'             05645003
         BE    UIDC0214                YES,ISSUE MSG                    05654003
         LA    PARMREG1,DARC021C       WAS DYNAMIC ALLOCATION           05663003
         CR    PARMREG1,WORK2            ERROR CODE X'021C'             05672003
         BE    UIDC021C                YES,ISSUE MSG                    05681003
*                                      NO,ISSUE MESSAGE WITH ERROR CODE 05690003
         LA    PARMREG1,M3041IN1       INITIALIZE OFFSET IN LEVEL       05699003
         STH   PARMREG1,MGBUILDO         2 INSERTION BLOCK              05708003
         L     PARMREG1,ALOCERPB       RELATIVE MESSAGE NUMBERS         05717003
         BAL   LINK5,UIDAIRCD          GO ISSUE MESSAGE WITH ERROR CODE 05726003
         B     UIFREE                  GO CLEAN UP                      05735003
         SPACE 2                                                        05744003
*   INSUFFICIENT SPACE ON VOLUMES MESSAGE                               05753003
UIDC0220 EQU   *                                                        05762003
         L     PARMREG1,DC0220PB       RELATIVE MESSAGE NUMBERS         05771003
         B     UIALOCMG                GO ISSUE MESSAGE                 05800003
         SPACE 2                                                        05809003
*   INVALID UNIT IN USER ATTRIBUTE DATA SET MESSAGE                     05818003
UIDC0214 EQU   *                                                        05827003
         L     PARMREG1,DC0214PB       RELATIVE MESSAGE NUMBERS         05836003
         B     UIALOCMG                GO ISSUE MESSAGE                 05845003
         SPACE 2                                                        05854003
*   NO UNIT AVAILABLE MESSAGE                                           05863003
UIDC021C EQU   *                                                        05872003
         L     PARMREG1,DC021CPB       RELATIVE MESSAGE NUMBERS         05881003
         B     UIALOCMG                GO ISSUE MESSAGE                 05890003
         SPACE 3                                                        05899003
UINOTIOT EQU   *                                                        05908003
         XC    MSGAREA(X12),MSGAREA    CLEAR MSG AREA                   05917003
         L     PARMREG1,NOTIOTPB       RELATIVE MESSAGE NUMBERS         05926003
         B     UIALOCMG                GO ISSUE MESSAGE                 05935003
         SPACE 3                                                        05944003
UIFREE   BAL   LINK9,UI40               GO PERFORM CLEAN UP             05953003
         LA    RETCDREG,EIGHT          SET RETURN CODE                  05962003
         B     UI00                    RETURN TO CALLER                 05971003
         SPACE 3                                                        06000003
*********************************************************************** 06009003
*   SYSTEM ERROR, ISSUE MSG WITH RETURN CODE FROM DAIR                  06018003
UISYSER  EQU   *                                                        06027003
         XC    MSGAREA(X66),MSGAREA    CLEAR MESSAGE AREA               06036003
         MVC   MSGAREA(X4),SYSERRPB    RELATIVE MSG NUMBERS             06045003
         LA    WORK2,MGBUILD            GET ADDRESS OF 2ND LEVEL        06054003
         ST    WORK2,MSGAREA+EIGHT      INITIALIZE AREA                 06063003
         LA    WORK2,MGBUILD2           SET UP 2ND 2ND LEVEL            06072003
         ST    WORK2,MGBUILD            POINT TO NEXT INSERTION         06081003
         MVI   MGBUILDL,L'IKJDAIR+FOUR  SET LENGTH FIELD                06090003
         LA    WORK2,M3131IN1           GET RELATIVE OFFSET             06099003
         STH   WORK2,MGBUILDO           STORE IN MESSAGE BLOCK          06108003
         MVC   IOMSG(L'IKJDAIR),IKJDAIR MOVE INSERTION INTO BLOCK       06117003
         LA    WORK2,M3131IN2           GET 2ND RELATIVE OFFSET         06126003
         STH   WORK2,MGBLD2O2           STORE IN MESSAGE BLOCK          06135003
         SRL   RETCDREG,ONE            SET UP FOR INSERTION PICK UP     06144003
         LH    WORK2,CODETAB-X2(RETCDREG) GET CODE IN REG               06153003
         STH   WORK2,IOMSG2             STORE 2ND INSERTION             06162003
         MVI   MGBLD2L,SIX             MOVE LENGTH INTO BLOCK           06171003
         BAL   LINK5,MSG                GO PUT OUT MESSAGE              06200003
         B     UIFREE                   GO TO CLEAN UP                  06208003
         SPACE 2                                                        06216003
*********************************************************************** 06224003
*   DATA SET NOT USABLE// OPEN ERROR                                    06232003
UI12     EQU   *                                                        06250003
         XC    MSGAREA(X48),MSGAREA    CLEAR MESSAGE AREA               06258003
         MVC   MSGAREA(X4),OPENERPB    RELATIVE MSG NUMBERS             06266003
         BAL   LINK5,MSG               PUT OUT MESSAGE                  06274003
         BAL   LINK9,UI50              PERFORM CLEANUP                  06282003
         LA    RETCDREG,OPENERR        SET RETURN CODE                  06300003
         B     UI00                    RETURN TO CALLER                 06308003
         SPACE 2                                                        06316003
*   CONVERT ALLOCATION ERROR CODE TO EBCDIC HEX AND ISSUE MESSAGE       06324003
UIDAIRCD EQU   *                                                        06332003
         STH   WORK2,SAVEAREA          ERROR CODE                       06350003
         ST    PARMREG1,MSGAREA        RELATIVE MSG NUMBERS INTO LIST   06358003
         LA    PARMREG1,MGBUILD        INITIALIZE POINTER TO LEVEL      06366003
         ST    PARMREG1,MSGAREA+EIGHT    2 INSERTION BLOCK              06374003
         MVI   MGBUILDL,EIGHT          MSG TEXT LENGTH + FOUR           06382003
         UNPK  IOMSG(FIVE),SAVEAREA(THREE) TRANSLATE ERROR CODE INTO    06400003
         TR    IOMSG(FOUR),TRANTAB-X240      HEX CHARACTERS             06409003
MSG      EQU   *                                                        06418003
         IKJEBEML ,,,,MF=(E,MSGAREA)                                    06427003
         BR    LINK5                   RETURN                           06436003
MSGCORE  EQU   MSG+4                   USE CA FOR MESSAGE               06445003
         SPACE 3                                                        06454003
**********************************************************************  06463003
         SPACE 2                                                        06472003
*   FREE ANY DATA BLOCKS THAT WERE ALREADY OBTIANED                     06481003
UI1      LH    WORK5,DCBBFNO           # OF BLOCKS POSSIBLE             06490003
         LA    WORK6,BUF1              1ST BUFFER ADDRESS               06499003
         USING BUFFER,WORK6            ADDRESSABILITY                   06508003
         LH    WORK3,DCBBLKSI          BLOCK SIZE                       06517003
UI10     L     WORK4,BUFBLOCK          BLOCK ADDRESS                    06526003
         DROP  WORK6                   RELEASE                          06535003
         LTR   WORK4,WORK4             IS THERE A BLOCK                 06544003
         BZ    UI3                     NO--CONTINUE CLEANUP             06553003
         FREEMAIN R,LV=(WORK3),A=(WORK4),SP=SPONE FREE BLOCK            06562003
         LA    WORK6,L'BUF1(,WORK6)    NEXT CONTROL FIELD               06571003
         BCT   WORK5,UI10              REPEAT UNTIL ALL CHECKED         06600003
         SPACE 2                                                        06609003
*   NOT ENOUGH MAIN STORAGE TO EXECUTE ---------                        06618003
UI3      EQU   *                                                        06627003
         XC    CASRWKA(X48),CASRWKA    CLEAR MESSAGE AREA               06636003
         MVC   CASRWKA(X2),NOCOREPB    RELATIVE MSG NUMBER              06645003
         LA    WORK2,CASRWKA+MGCOREB   SET UP INSERTION BLOCK           06654003
         ST    WORK2,CASRWKA+FOUR      POINT TO INSERTION BLOCK         06663003
         LA    PARMREG1,M312IN1        INITIALIZE OFFSET IN LEVEL 1     06672003
         STH   PARMREG1,CASRWKA+MGCOREBO INSERTION BLOCK                06681003
         MVI   CASRWKA+MGCOREBL,L'COMMAND+FOUR  SET UP LENGTH           06690003
         MVC   CASRWKA+MGCOREBM(L'COMMAND),COMMAND MOVE TEXT TO BLOCK   06699003
         OC    CAPTCDCB+ONE(THREE),CAPTCDCB+ONE ANY SUBCOMMANDS YET     06708003
         BZ    UI31                    NO,GO ISSUE MSG TEXT 'COMMAND'   06717003
         L     PARMREG1,CAPTTMP        ADDRESS OF CPPL                  06726003
         L     PARMREG1,CPPLECT-CPPL(PARMREG1) GET ECT ADDRESS          06735003
         MVC   CASRWKA+MGCOREBM(EIGHT),ECTSCMD-ECT(PARMREG1)            06744003
UI31     LA    PARMREG1,CASRWKA        SET UP ADDRESS FOR MESSAGE       06753003
         BAL   LINK5,MSGCORE           GO PUT MESSAGE                   06762003
         LTR   DATAREG,DATAREG         IS THERE A WORKAREA              06771003
         BZ    UI4                     NO--SET CODE//EXIT               06800003
         BAL   LINK9,UI50              YES-NEED TO UNALLOC DATA         06809003
*                                        SET AND FREE WORKAREA.         06818003
UI4      LA    RETCDREG,FOUR           SET RETURN CODE                  06827003
         B     UI00                    RETURN TO CALLER                 06836003
         EJECT                                                          06845003
*   ENTER THIS SECTION ON ERROR CONDITIONS FOR CLEANUP                  06854003
         SPACE 2                                                        06863003
*   UNALLOCATE THE UTILITY DATA SET HERE                                06872003
UI50     MVC   UIDAIR(DDSIZE),DCODE    PARM LIST FOR DAIR               06881003
         MVC   UIDAIR+DA18DDN-DAPB18(L'DCBDDNAM),DCBDDNAM DDNAME        06890003
         LA    PARMREG1,UIDAIR         ADDRESS OF LIST                  06899003
         ST    PARMREG1,CATMPLST+DAPLDAPB-DAPL BLOCK ADDRESS TO LIST    06908003
         L     PARMREG1,CAPTTMP        ADDRESS OF CPPL LIST             06917003
         USING CPPL,PARMREG1                                            06926003
         MVC   CATMPLST+DAPLPSCB-DAPL(L'CPPLPSCB),CPPLPSCB PSCB ADDRESS 06935003
         DROP  PARMREG1                                                 06944003
         LA    PARMREG1,CATMPLST       TOTAL PARM LIST FOR DAIR         06953003
         CALLTSSR  EP=IKJDAIR          UNALLOCATE THE DATA SET          06962003
         XI    CACFLAG4,CADSUSED       DID NOT USE DATA SET             06971003
         SPACE 2                                                        07000003
*   FREE THE WORKAREA CORE HERE                                         07009003
UI40     LR    PARMREG1,DATAREG        WORKAREA ADDRESS                 07018003
         FREEMAIN R,LV=UTILSIZE,A=(1),SP=SPONE  FREE WORKAREA           07027003
         BR    LINK9                   RETURN TO CALLER                 07036003
         EJECT                                                          07045003
         SPACE 2                                                        07054003
PATCH    DC    8D'0'                   PATCH AREA                       07063003
         SPACE 2                                                        07072003
         DROP  BASEREG,COMMREG,DATAREG,WORK8                            07081003
         SPACE                                                          07090003
*   CONSTANT AREA FOR IKJEBEUI                                          07099003
UICLEAR  XC    ZERO(ONE,WORK2),ZERO(WORK2)  CLEARS CORE                 07108003
CODETAB  DS    0H                                                       07117003
         DC    C'0408121620'           MSG INSERTION TABLE              07126003
TRANTAB  DC    C'0123456789ABCDEF'     TRANSLATE TABLE                  07135003
IKJDAIR  DC    C'DAIR'                 MESSAGE INSERTION                07144003
COMMAND  DC    C'COMMAND '             INSERTION FOR INSUFFICIENT       07153003
*                                      CORE MSG, SHOULD BE EIGHT        07162003
*                                      CHARACTERS LONG                  07171003
         SPACE                                                          07200003
*   PARAMETER LIST FOR DAIR --- UTILITY DATA SET ALLOCATION             07210003
         DS    0D                                                       07220003
DAIRCODE DC    H'08'                   ENTRY CODE                       07230003
FLAGS    DC    H'0'                    RETURN SETTINGS                  07240003
DARC     DC    H'0'                    ERROR CODE---DYNAMIC ALLOCATION  07250003
CTRC     DC    H'0'                    ERROR CODE---CATALOG             07260003
DSNAMPTR DC    A(DSNAME)               POINTER TO DSNAME                07270003
DDNAME   DC    8C' '                   DDNAME RETURNED                  07280003
UNITNAME DC    8C' '                   UNIT NAME                        07290003
SERIALNO DC    8C' '                   VOLUME SERIAL NO.                07300003
BLCKSIZE DC    F'0'                    AVERAGE BLOCKSIZE                07310003
PRIMARY  DC    F'4'                      PRIMARY SPACE                  07320003
SECOND   DC    F'2'                      SECONDARY SPACE                07330003
DIRECT   DC    F'0'                    DIRECTORY SPACE                  07340003
MEMBER   DC    8C' '                   MEMBER NAME                      07350003
PASSWORD DC    8C' '                   PASSWORD                         07360003
DISP1    DC    X'04'                   DATA SET STATUS//NEW             07370003
DISP2    DC    X'04'                   NORMAL DISPOSITION//DELETE       07380003
DISP3    DC    X'04'                   CONDITIONAL DISPOSITION//DELETE  07400003
CONTROL  DC    X'40'                   DAIR CONTROL                     07409003
RESERVED DC    AL3(0)                  NOT USED                         07418003
DSORG    DC    X'00'                   DSORG TYPE RETURNED              07427003
DAIRSIZE EQU   *-DAIRCODE              LENGTH OF PARM LIST              07436003
         SPACE 2                                                        07445003
*   DATA SET NAME FOR PERMANENTLY ALLOCATED UTILITY DATA SET            07454003
         DS    0H                                                       07463003
DSNAME   DC    X'0005'                 LENGTH OF DSNAME                 07472003
         DC    C'&&EDIT'               DSNAME                           07481003
DSNAME1  DC    X'0006'                 LENGTH OF DSNAME                 07490003
         DC    C'&&EDIT2'              SECONDARY UTILITY                07499003
*   PARAMETER LIST FOR DAIR --- UTILITY DATA SET UNALLOCATION           07508003
         DS    0D                                                       07517003
DCODE    DC    H'24'                   ENTRY CODE                       07526003
DFLAGS   DC    H'0'                    RETURN SETTINGS                  07535003
DDARC    DC    H'0'                    ERROR CODE ---DYNAMIC ALLOCATION 07544003
DCTRC    DC    H'0'                    ERROR CODE ---CATALOG            07553003
DDSPTR   DC    F'0'                    DATA SET NAME POINTER            07562003
DDDNAME  DC    8C' '                   DDNAME                           07571003
DMEMBER  DC    8C' '                   MEMBER NAME                      07600003
DSYSCLS  DC    H'0'                    FOR SYSOUT DS USE                07609003
DDISP2   DC    X'40'                   NORMAL DISPOSITION//DELETE       07618003
DCONTROL DC    X'00'                   DAIR CONTROL                     07627003
DDSIZE   EQU   *-DCODE                 LENGTH OF PARM LIST              07636003
         EJECT                                                          07645003
*********************************************************************** 07654003
*   RELATIVE MESSAGE NUMBERS FOR MESSAGE PARAMETER LISTS                07663003
         DS    0F                                                       07672003
         SPACE                                                          07681003
CTLGERPB DC    AL2(M304U)              UTILITY DS NOT ALLOCATED         07690003
         DC    AL2(M3042)              CATALOG ERROR CODE ( )           07699003
         SPACE                                                          07708003
CTIOERPB DC    AL2(M304U)              UTILITY DS NOT ALLOCATED         07717003
         DC    AL2(M3043)              CATALOG I/O ERROR                07726003
         SPACE                                                          07735003
ALOCERPB DC    AL2(M304U)              UTILITY DS NOT ALLOCATED         07744003
         DC    AL2(M3041)              DYNAMIC ALLOC ERROR CODE ( )     07753003
         SPACE                                                          07762003
DC0214PB DC    AL2(M318U)              UTILITY DS NOT ALLOCATED         07771003
         DC    AL2(M3181)              INVALID UNIT IN USER ATTRIB DS   07800003
         SPACE                                                          07809003
DC021CPB DC    AL2(M318U)              UTILITY DS NOT ALLOCATED         07818003
         DC    AL2(M3182)              NO UNIT AVAILABLE                07827003
         SPACE                                                          07836003
DC0220PB DC    AL2(M305U)              UTILITY DS NOT ALLOCATED         07845003
         DC    AL2(M3051)              NO SPACE ON VOLUMES              07854003
         SPACE                                                          07863003
NOTIOTPB DC    AL2(M301U)              TOO MANY DATA SETS               07872003
         DC    AL2(M3011)              USE FREE COMMAND                 07881003
         SPACE                                                          07890003
SYSERRPB DC    AL2(M313)               COMMAND SYSTEM ERROR             07899003
         DC    AL2(M3131)              (DAIR) ERROR CODE ( )            07908003
         SPACE                                                          07917003
OPENERPB DC    AL2(M309U)              UTILITY DS NOT USABLE            07926003
         DC    AL2(M3093)              CANNOT OPEN DATA SET             07935003
         SPACE                                                          07944003
NOCOREPB DC    AL2(M312)               NOT ENOUGH CORE TO EXECUTE ( )   07953003
         SPACE 2                                                        07962003
         EJECT                                                          07971003
*********************************************************************** 08000003
BSAMDCB DCB    DSORG=PS,RECFM=FS,MACRF=(WP),EXLST=LIST                  08009003
DCBEND   EQU   *                       END OF DCB                       08018003
*********************************************************************** 08027003
         SPACE 1                                                        08036003
*****************************************************************       08045003
LIST     DC    0F'0',X'85',AL3(OPENEXIT) CONNECTS DCB/OPENEXIT          08054003
         SPACE 2                                                        08063003
GM       GETMAIN EC,LV=0,A=0,SP=SPONE,MF=L   GETMAIN LIST               08072003
GMEND    EQU   *                       END OF GETMAIN LIST              08081003
OPENL    OPEN  (,(OUTPUT)),MF=L        LIST FORM                        08090003
OPENLEND EQU   *                       END OF LIST FORM                 08099003
         SPACE 2                                                        08108003
*********************************************************************** 08117003
*   THE FOLLOWING SECTION (XDAP, READ, AND WRITE FORMS) IS MOVED TO     08126003
*     THE WORKAREA WITH ONE INSTRUCTION AND SHOULD NOT BE ALTERED.      08135003
         CNOP  0,8                                                      08144003
XDAPW    DC    F'0'                    IOB PREFIX                       08153003
XDAP     XDAP  ECB,WI,0,0,0,MF=L       WRITE LIST FORM                  08162003
XDAPEND  EQU   *                       END OF XDAP LIST FORM            08171003
WRITEB   WRITE WDECB,SF,MF=L           BSAM WRITE//LIST FORM            08200003
WRITEEND EQU   *                       END OF WRITE LIST FORM           08209003
         CNOP  0,8                                                      08218003
         DC    F'0'                    IOB PREFIX                       08227003
READ     XDAP  RDECB,RI,0,0,0,MF=L     READ LIST FORM                   08236003
READEND  EQU   *                       END OF READ LIST FORM            08245003
*********************************************************************** 08254003
         EJECT                                                          08263003
UIWORK   DSECT                                                          08272003
*   DESCRIPTIONS ON THE USE OF THE TEMPORARY WORK SPACE USED BY         08281003
*     THIS ROUTINE IN THE 'TEMPAREA' FIELD OF UTILWORK.                 08290003
         SPACE                                                          08299003
UIALL    EQU   *                       GENERAL LIST FORM AREA           08308003
UIDAIR   EQU   *                       DAIR CONTROL LIST                08317003
         SPACE                                                          08326003
         ORG   UIALL                   USE SAME AREA                    08335003
UIOPEN   OPEN  (,(OUTPUT)),MF=L        OPEN MACRO,  LIST FORM           08344003
         SPACE                                                          08353003
         SPACE                                                          08362003
UIEND    EQU   *                                                        08371003
*********************************************************************** 08400003
         IKJDAP08                                                       08409003
*********************************************************************** 08418003
         IKJDAP18                                                       08427003
*********************************************************************** 08436003
         SPACE 2                                                        08445003
         IKJCPPL                                                        08454003
*********************************************************************** 08463003
         SPACE 2                                                        08472003
         IKJDAPL                                                        08481003
         SPACE 2                                                        08490003
         IKJECT                                                         08499003
         IKJEBEUW                                                       08508003
         EJECT                                                          08517003
*********************************************************************** 08526003
         IKJEBECA                                                       08535003
         SPACE 2                                                        08544003
*********************************************************************** 08553003
         ORG   CATEMPBF                TEMPORARY WORKAREA               08562003
GMLIST   GETMAIN EC,LV=0,A=0,SP=SPONE,MF=L  GETMAIN LIST                08571003
GMADDR   DS    1F                      GETMAIN ADDRESS                  08600003
         CVT                                                            08650003
*********************************************************************** 08800003
          END                                                           09000003
